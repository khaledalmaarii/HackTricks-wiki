# WWW2Exec - GOT/PLT

{% hint style="success" %}
AWS Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlanmÄ±ÅŸ ikili dosyalarda **harici iÅŸlevlerin adreslerini yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r**. Bu adresler **Ã§alÄ±ÅŸma zamanÄ±nda bilinmediÄŸi iÃ§in** (dinamik baÄŸlantÄ± nedeniyle), GOT, bu harici sembollerin adreslerinin **Ã§Ã¶zÃ¼ldÃ¼kten sonra bu adresleri dinamik olarak gÃ¼ncellemek iÃ§in bir yol saÄŸlar**.

GOT'taki her giriÅŸ, ikili dosyanÄ±n Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. Bir **iÅŸlev ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan gerÃ§ek adresi Ã§Ã¶zÃ¼lÃ¼r ve GOT'ta depolanÄ±r**. AynÄ± iÅŸlevin sonraki Ã§aÄŸrÄ±larÄ±, GOT'ta depolanan adresi kullanÄ±r, bÃ¶ylece adresi tekrar Ã§Ã¶zme gereksiniminden kaÃ§Ä±nÄ±lÄ±r.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici iÅŸlevlere yapÄ±lan Ã§aÄŸrÄ±larÄ± iÅŸlemek iÃ§in bir trambolin gÃ¶revi gÃ¶rÃ¼r. Bir ikili **bir harici iÅŸlevi ilk kez Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol, o iÅŸlevle iliÅŸkili PLT giriÅŸine geÃ§er**. Bu PLT giriÅŸi, iÅŸlevin adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur eÄŸer daha Ã¶nce Ã§Ã¶zÃ¼lmemiÅŸse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra, GOT'ta depolanÄ±r.

**Bu nedenle,** harici bir iÅŸlevin veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde GOT giriÅŸleri doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin baÅŸlangÄ±Ã§ta Ã§Ã¶zÃ¼lmesini** dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla kolaylaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.

## YÃ¼rÃ¼tme Al

### GOT'u Kontrol Et

**`objdump -s -j .got ./exec`** komutu ile GOT tablosunun adresini alÄ±n.

![](<../../.gitbook/assets/image (121).png>)

GEF ile **yÃ¼rÃ¼tÃ¼lebilir** dosyayÄ± **yÃ¼kledikten** sonra GOT'ta **bulunan** **iÅŸlevleri gÃ¶rebilirsiniz**: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEF kullanarak **hata ayÄ±klama** oturumu baÅŸlatabilir ve GOT tablosunu gÃ¶rmek iÃ§in **`got`** komutunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

Bir ikili dosyada GOT, **iÅŸlevlerin adreslerine veya** iÅŸlev adresini yÃ¼kleyecek olan **PLT** bÃ¶lÃ¼mÃ¼ne sahiptir. Bu keyfi yazma iÅŸleminin amacÄ±, daha sonra **`system`** **iÅŸlevinin PLT'sinin adresiyle** deÄŸiÅŸtirilecek bir iÅŸlevin GOT giriÅŸini **geÃ§ersiz kÄ±lmaktÄ±r**.

Ä°deal olarak, **kontrolÃ¼nÃ¼ saÄŸladÄ±ÄŸÄ±nÄ±z parametrelerle Ã§aÄŸrÄ±lacak bir iÅŸlevin GOT'unu geÃ§ersiz kÄ±lacaksÄ±nÄ±z** (bu sayede sistem iÅŸlevine gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer ikili tarafÄ±ndan **`system`** **kullanÄ±lmÄ±yorsa**, sistem iÅŸlevinin **PLT'de bir giriÅŸi olmayacak**. Bu senaryoda, Ã¶nce `system` iÅŸlevinin adresini sÄ±zdÄ±rmanÄ±z ve ardÄ±ndan GOT'u bu adrese iÅŸaretleyecek ÅŸekilde Ã¼zerine yazmanÄ±z gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** komutu ile gÃ¶rebilirsiniz.

## libc GOT giriÅŸleri

**Libc GOT**'un **partial RELRO** ile derlenmesi genellikle mÃ¼mkÃ¼nse adresini bulmak iÃ§in gÃ¼zel bir hedef oluÅŸturur ([**ASLR**](../common-binary-protections-and-bypasses/aslr/)).

Libc'nin yaygÄ±n iÅŸlevleri, **baÅŸka dahili iÅŸlevleri Ã§aÄŸÄ±racaklar** ve bu iÅŸlevlerin GOT'u geÃ§ersiz kÄ±lÄ±narak kod yÃ¼rÃ¼tme elde edilebilir.

Bu tekniÄŸe iliÅŸkin [**daha fazla bilgiyi burada bulabilirsiniz**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries).

### **Free2system**

Heap istismarÄ± CTF'lerinde genellikle parÃ§alarÄ±n iÃ§eriÄŸini kontrol edebilmek ve GOT tablosunu hatta bazen Ã¼zerine yazabilmek mÃ¼mkÃ¼ndÃ¼r. EÄŸer bir gadget mevcut deÄŸilse RCE elde etmek iÃ§in basit bir hile, `free` GOT adresini `system`'e iÅŸaret etmek ve bir parÃ§aya `"/bin/sh"` yazmaktÄ±r. Bu ÅŸekilde bu parÃ§a serbest bÄ±rakÄ±ldÄ±ÄŸÄ±nda `system("/bin/sh")` Ã§alÄ±ÅŸtÄ±rÄ±lacaktÄ±r.

### **Strlen2system**

BaÅŸka yaygÄ±n bir teknik, **`strlen`** GOT adresini **`system`'e iÅŸaret etmek**tir, bÃ¶ylece bu iÅŸlev kullanÄ±cÄ± girdisiyle Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda `"/bin/sh"` dizesini geÃ§mek ve bir kabuk almak mÃ¼mkÃ¼n olacaktÄ±r.

AyrÄ±ca, eÄŸer `puts` kullanÄ±cÄ± girdisiyle kullanÄ±lÄ±yorsa, `strlen` GOT adresini `system`'e iÅŸaret etmek ve dize `"/bin/sh"`'yi geÃ§mek mÃ¼mkÃ¼n olacaktÄ±r Ã§Ã¼nkÃ¼ **`puts`, kullanÄ±cÄ± girdisiyle `strlen`'i Ã§aÄŸÄ±racaktÄ±r**.

## **One Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **Heap'ten GOT'un KÃ¶tÃ¼ye KullanÄ±mÄ±**

Bir heap zafiyetinden RCE elde etmenin yaygÄ±n bir yolu, bir fastbin'i kÃ¶tÃ¼ye kullanmak ve GOT tablosunun bir kÄ±smÄ±nÄ± hÄ±zlÄ± bin iÃ§ine eklemek, bÃ¶ylece o parÃ§a tahsis edildiÄŸinde genellikle `free` iÅŸlevinin iÅŸaretÃ§isini **Ã¼zerine yazmak mÃ¼mkÃ¼n olacaktÄ±r**.\
ArdÄ±ndan, `free`'yi `system`'e iÅŸaret etmek ve `/bin/sh\x00` yazÄ±lmÄ±ÅŸ bir parÃ§ayÄ± serbest bÄ±rakmak, bir kabuk yÃ¼rÃ¼tmek mÃ¼mkÃ¼n olacaktÄ±r.

Bir [**Ã¶rneÄŸi burada bulabilirsiniz**](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/chunk\_extend\_overlapping/#hitcon-trainging-lab13)**.**
## **Koruma**

**Tam RELRO** korumasÄ±, ikili baÅŸlatÄ±ldÄ±ÄŸÄ±nda tÃ¼m iÅŸlevlerin adreslerini Ã§Ã¶zerek ve ardÄ±ndan **GOT tablosunu salt okunur** hale getirerek bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlamayÄ± amaÃ§lar:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referanslar

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)
