# WWW2Exec - GOT/PLT

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.**

</details>

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlanmÄ±ÅŸ ikili dosyalarda **harici fonksiyonlarÄ±n adreslerini yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r**. Bu **adresler Ã§alÄ±ÅŸma zamanÄ±nda bilinmediÄŸi iÃ§in** (dinamik baÄŸlantÄ± nedeniyle), GOT, bu harici sembollerin adreslerini **Ã§Ã¶zÃ¼ldÃ¼kten sonra dinamik olarak gÃ¼ncellemek iÃ§in bir yol saÄŸlar**.

GOT'taki her giriÅŸ, ikili dosyanÄ±n Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. Bir **fonksiyon ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan gerÃ§ek adresi Ã§Ã¶zÃ¼lÃ¼r ve GOT'ta depolanÄ±r**. AynÄ± fonksiyona yapÄ±lan sonraki Ã§aÄŸrÄ±lar, GOT'ta depolanan adresi kullanÄ±r, bÃ¶ylece adresi tekrar Ã§Ã¶zme iÅŸleminden kaÃ§Ä±nÄ±lÄ±r.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici fonksiyonlara yapÄ±lan Ã§aÄŸrÄ±larÄ± iÅŸlemek iÃ§in bir trambolin olarak hizmet eder. Bir ikili **harici bir fonksiyonu ilk kez Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol o fonksiyonla iliÅŸkili PLT giriÅŸine geÃ§er**. Bu PLT giriÅŸi, fonksiyonun adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur eÄŸer daha Ã¶nce Ã§Ã¶zÃ¼lmediyse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra, GOT'ta depolanÄ±r.

**Bu nedenle,** harici bir fonksiyonun veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde GOT giriÅŸleri doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin baÅŸlangÄ±Ã§ta Ã§Ã¶zÃ¼lmesini kolaylaÅŸtÄ±rmak iÃ§in** dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla kullanÄ±lÄ±r.

## YÃ¼rÃ¼tme Al

### GOT'u Kontrol Et

**GOT tablosunun adresini almak iÃ§in:** **`objdump -s -j .got ./exec`**

![](<../../.gitbook/assets/image (121).png>)

**GEF** iÃ§inde **yÃ¼rÃ¼tÃ¼lebilir** dosyayÄ± **yÃ¼kledikten** sonra GOT'ta **bulunan fonksiyonlarÄ± gÃ¶rebilirsiniz**: `gefâ¤ x/20x 0xDIR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEF kullanarak **hata ayÄ±klama** oturumu baÅŸlatabilir ve GOT tablosunu gÃ¶rmek iÃ§in **`got`** komutunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

Bir ikili dosyada GOT, **fonksiyonlarÄ±n adreslerine veya** **fonksiyon adresini yÃ¼kleyecek PLT** bÃ¶lÃ¼mÃ¼ne sahiptir. Bu keyfi yazmanÄ±n amacÄ±, daha sonra **yÃ¼rÃ¼tÃ¼lecek bir fonksiyonun GOT giriÅŸini** deÄŸiÅŸtirmektir **Ã¶rneÄŸin** **`system`** **fonksiyonunun PLT adresiyle**.

Ä°deal olarak, **kontrolÃ¼nÃ¼ saÄŸladÄ±ÄŸÄ±nÄ±z parametrelerle Ã§aÄŸrÄ±lacak bir fonksiyonun GOT'unu** **Ã¼zerine yazacaksÄ±nÄ±z** (bÃ¶ylece sistem fonksiyonuna gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer **`system`** **betiÄŸin iÃ§inde kullanÄ±lmÄ±yorsa**, sistem fonksiyonunun **PLT'de bir giriÅŸi olmayacak**. Bu senaryoda, Ã¶nce `system` fonksiyonunun adresini sÄ±zdÄ±rmanÄ±z ve ardÄ±ndan GOT'u bu adrese iÅŸaret etmek iÃ§in Ã¼zerine yazmanÄ±z gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** ile gÃ¶rebilirsiniz.

## libc GOT giriÅŸleri

**Libc GOT'u**, adresini belirlemek mÃ¼mkÃ¼nse ([**ASLR**](../common-binary-protections-and-bypasses/aslr/)) hedef almak iÃ§in gÃ¼zel bir hedef olacak ÅŸekilde genellikle **kÄ±smi RELRO** ile derlenir.

Libc'in yaygÄ±n fonksiyonlarÄ±, kod yÃ¼rÃ¼tme elde etmek iÃ§in Ã¼zerine yazÄ±labilecek **diÄŸer dahili fonksiyonlarÄ± Ã§aÄŸÄ±racaktÄ±r**.

Bu tekniÄŸe iliÅŸkin [**daha fazla bilgiyi burada bulabilirsiniz**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries).

## **Tek Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **Korunmalar**

**Tam RELRO** korumasÄ±, ikili baÅŸlatÄ±ldÄ±ÄŸÄ±nda tÃ¼m fonksiyonlarÄ±n adreslerini Ã§Ã¶zerek ve **GOT tablosunu salt okunur hale getirerek** bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlamayÄ± amaÃ§lar:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referanslar

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.**

</details>
