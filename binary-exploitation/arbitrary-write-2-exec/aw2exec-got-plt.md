# WWW2Exec - GOT/PLT

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na (https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlanmÄ±ÅŸ ikili dosyalarda **harici fonksiyonlarÄ±n adreslerini yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r**. Bu adresler **Ã§alÄ±ÅŸma zamanÄ±nda bilinmediÄŸi iÃ§in** (dinamik baÄŸlantÄ± nedeniyle), GOT, bu harici sembollerin adreslerinin **Ã§Ã¶zÃ¼ldÃ¼kten sonra bu adresleri dinamik olarak gÃ¼ncellemek iÃ§in bir yol saÄŸlar**.

GOT'taki her giriÅŸ, ikili dosyanÄ±n Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. Bir **fonksiyon ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan gerÃ§ek adresi Ã§Ã¶zÃ¼lÃ¼r ve GOT'ta depolanÄ±r**. AynÄ± fonksiyona yapÄ±lan sonraki Ã§aÄŸrÄ±lar, GOT'ta depolanan adresi kullanÄ±r, bÃ¶ylece adresi tekrar Ã§Ã¶zme iÅŸleminin Ã¼stesinden gelinir.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici fonksiyonlara yapÄ±lan Ã§aÄŸrÄ±larÄ± iÅŸlemek iÃ§in bir trambolin gÃ¶revi gÃ¶rÃ¼r. Bir ikili **harici bir fonksiyonu ilk kez Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol bu fonksiyonla iliÅŸkili PLT giriÅŸine geÃ§er**. Bu PLT giriÅŸi, fonksiyonun adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur eÄŸer daha Ã¶nce Ã§Ã¶zÃ¼lmediyse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra, **GOT'ta** depolanÄ±r.

**Bu nedenle,** harici bir fonksiyonun veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde GOT giriÅŸleri doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin baÅŸlangÄ±Ã§ta Ã§Ã¶zÃ¼lmesini** dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla kolaylaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.

## YÃ¼rÃ¼tme Al

### GOT'u Kontrol Et

GOT tablosunun adresini almak iÃ§in: **`objdump -s -j .got ./exec`**

![](<../../.gitbook/assets/image (121).png>)

GEF'de **yÃ¼rÃ¼tÃ¼lebilir** dosyayÄ± **yÃ¼kledikten** sonra GOT'ta **bulunan fonksiyonlarÄ± gÃ¶rebilirsiniz**: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEF kullanarak **hata ayÄ±klama** oturumu baÅŸlatabilir ve GOT tablosunu gÃ¶rmek iÃ§in **`got`** komutunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

Bir ikili dosyada GOT, **fonksiyonlarÄ±n adreslerine veya** **fonksiyon adresini yÃ¼kleyecek olan PLT** bÃ¶lÃ¼mÃ¼ne sahiptir. Bu keyfi yazmanÄ±n amacÄ±, daha sonra **yÃ¼rÃ¼tÃ¼lecek bir fonksiyonun GOT giriÅŸini** deÄŸiÅŸtirmektir **Ã¶rneÄŸin** `system` **fonksiyonunun PLT adresiyle**.

Ä°deal olarak, **kontrolÃ¼nÃ¼ saÄŸladÄ±ÄŸÄ±nÄ±z parametrelerle Ã§aÄŸrÄ±lacak bir fonksiyonun GOT'unu** **deÄŸiÅŸtireceksiniz** (bÃ¶ylece sistem fonksiyonuna gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer ikili dosya **`system`** **kullanmÄ±yorsa**, sistem fonksiyonunun **PLT'de bir giriÅŸi olmayacak**. Bu senaryoda, Ã¶nce `system` fonksiyonunun adresini sÄ±zdÄ±rmanÄ±z ve ardÄ±ndan GOT'u bu adrese yÃ¶nlendirmeniz gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** ile gÃ¶rebilirsiniz.

## libc GOT giriÅŸleri

**Libc GOT**'un **genellikle kÄ±smi RELRO** ile derlendiÄŸi ve adresinin belirlenebilmesi durumunda (ASLR) bu iÃ§in gÃ¼zel bir hedef olduÄŸu varsayÄ±lÄ±rsa, bu teknik iÃ§in gÃ¼zel bir hedef olabilir.

Libc'nin yaygÄ±n fonksiyonlarÄ±, **diÄŸer dahili fonksiyonlarÄ± Ã§aÄŸÄ±racaklar** ve bu fonksiyonlarÄ±n GOT'u Ã¼zerine yazarak kod yÃ¼rÃ¼tme elde edilebilir.

Bu tekniÄŸe iliÅŸkin [**daha fazla bilgiyi burada bulabilirsiniz**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries).

## **Free2system**

Heap istismarÄ± CTF'lerinde, parÃ§alarÄ±n iÃ§eriÄŸini kontrol edebilmek ve GOT tablosunu hatta bazen Ã¼zerine yazabilmek yaygÄ±ndÄ±r. Bir gadget mevcut deÄŸilse RCE elde etmenin basit bir yolu, `free` GOT adresini `system`'e yÃ¶nlendirmek ve bir parÃ§aya `"/bin/sh"` yazmak olabilir. Bu ÅŸekilde bu parÃ§a serbest bÄ±rakÄ±ldÄ±ÄŸÄ±nda `system("/bin/sh")` Ã§alÄ±ÅŸtÄ±rÄ±lacaktÄ±r.

## **Strlen2system**

BaÅŸka yaygÄ±n bir teknik, **`strlen`** GOT adresini **`system`'e** yÃ¶nlendirmektir, bÃ¶ylece bu fonksiyon kullanÄ±cÄ± girdisiyle Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda `"/bin/sh"` dizesini geÃ§mek ve bir kabuk almak mÃ¼mkÃ¼n olabilir.

AyrÄ±ca, kullanÄ±cÄ± girdisiyle `puts` kullanÄ±lÄ±yorsa, `puts` GOT adresini `system`'e yÃ¶nlendirmek ve dize `"/bin/sh"`'yi geÃ§mek mÃ¼mkÃ¼n olabilir Ã§Ã¼nkÃ¼ **`puts` kullanÄ±cÄ± girdisiyle `strlen`'Ä± Ã§aÄŸÄ±racaktÄ±r**.

## **One Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **Heap'ten GOT'un KÃ¶tÃ¼ye KullanÄ±mÄ±**

Bir heap zafiyetinden RCE elde etmenin yaygÄ±n bir yolu, bir fastbin'i kÃ¶tÃ¼ye kullanmak ve GOT tablosunun bir kÄ±smÄ±nÄ± fast bin iÃ§ine eklemek olabilir, bÃ¶ylece o parÃ§a tahsis edildiÄŸinde genellikle `free` fonksiyonunun iÅŸaretÃ§isini Ã¼zerine yazmak mÃ¼mkÃ¼n olabilir.\
Sonra, `free`'yi `system`'e yÃ¶nlendirerek ve `/bin/sh\x00` yazÄ±lmÄ±ÅŸ bir parÃ§ayÄ± serbest bÄ±rakarak bir kabuk Ã§alÄ±ÅŸtÄ±rmak mÃ¼mkÃ¼n olacaktÄ±r.

Bir [**Ã¶rneÄŸi burada bulabilirsiniz**](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/chunk\_extend\_overlapping/#hitcon-trainging-lab13)**.**
## **Koruma**

**Tam RELRO** korumasÄ±, ikili baÅŸlatÄ±ldÄ±ÄŸÄ±nda tÃ¼m iÅŸlevlerin adreslerini Ã§Ã¶zerek ve ardÄ±ndan **GOT tablosunu salt okunur** yaparak bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlar:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referanslar

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
