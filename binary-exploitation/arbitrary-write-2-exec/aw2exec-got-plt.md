# WWW2Exec - GOT/PLT

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJE**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## **Osnovne informacije**

### **GOT: Globalna tabela ofseta**

**Globalna tabela ofseta (GOT)** je mehanizam koji se koristi u dinamiÄki povezanim binarnim fajlovima za upravljanje **adresama spoljnih funkcija**. PoÅ¡to ove **adrese nisu poznate do vremena izvrÅ¡avanja** (zbog dinamiÄkog povezivanja), GOT pruÅ¾a naÄin da se **dinamiÄki aÅ¾uriraju adrese ovih spoljnih simbola** nakon Å¡to budu reÅ¡ene.

Svaki unos u GOT-u odgovara simbolu u spoljnim bibliotekama koje binarni fajl moÅ¾e pozvati. Kada se **funkcija prvi put pozove, njena stvarna adresa se reÅ¡ava dinamiÄkim povezivaÄem i Äuva u GOT-u**. Naknadni pozivi iste funkcije koriste adresu saÄuvanu u GOT-u, Äime se izbegava troÅ¡ak ponovnog reÅ¡avanja adrese.

### **PLT: Tabela vezivanja postupka**

**Tabela vezivanja postupka (PLT)** tesno saraÄ‘uje sa GOT-om i sluÅ¾i kao trambolina za rukovanje pozivima spoljnih funkcija. Kada binarni fajl **pozove spoljnu funkciju prvi put, kontrola se prenosi na unos u PLT-u koji je povezan sa tom funkcijom**. Ovaj unos PLT-a je odgovoran za pozivanje dinamiÄkog povezivaÄa da reÅ¡i adresu funkcije ako veÄ‡ nije reÅ¡ena. Nakon Å¡to se adresa reÅ¡i, Äuva se u GOT-u.

**Stoga,** unosi u GOT-u se direktno koriste kada se adresa spoljne funkcije ili promenljive reÅ¡i. **Unosi u PLT-u se koriste za olakÅ¡avanje poÄetne rezolucije** ovih adresa putem dinamiÄkog povezivaÄa.

## IzvrÅ¡enje

### Provera GOT-a

Dobijte adresu tabele GOT sa: **`objdump -s -j .got ./exec`**

![](<../../.gitbook/assets/image (118).png>)

Primetite kako nakon **uÄitavanja** **izvrÅ¡nog** fajla u GEF-u moÅ¾ete **videti** **funkcije** koje su u **GOT-u**: `gefâ¤ x/20x 0xDIR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

KoriÅ¡Ä‡enjem GEF-a moÅ¾ete **zapoceti** **debugging** sesiju i izvrÅ¡iti **`got`** da biste videli tabelu GOT:

![](<../../.gitbook/assets/image (493).png>)

### GOT2Exec

U binarnom fajlu, GOT ima **adrese funkcija ili** odeljak **PLT-a** koji Ä‡e uÄitati adresu funkcije. Cilj ovog proizvoljnog pisanja je da se **prepiÅ¡e unos u GOT-u** funkcije koja Ä‡e biti izvrÅ¡ena kasnije **sa** **adresom** PLT-a **`system`** **funkcije** na primer.

Idealno, **prepisati Ä‡ete** **GOT** neke **funkcije** koja Ä‡e biti **pozvana sa parametrima koje kontroliÅ¡ete** (tako da Ä‡ete moÄ‡i da kontroliÅ¡ete parametre poslate funkciji sistema).

Ako **`system`** **nije koriÅ¡Ä‡en** u skripti, funkcija sistema **neÄ‡e** imati unos u PLT-u. U ovom scenariju, moraÄ‡ete **prvo procureti adresu** funkcije `system` a zatim prebrisati GOT da pokazuje na ovu adresu.

MoÅ¾ete videti adrese PLT-a sa **`objdump -j .plt -d ./vuln_binary`**

## **Jedan Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **ZaÅ¡tite**

ZaÅ¡tita **FullRELRO** je namenjena zaÅ¡titi od ovakvih tehnika tako Å¡to reÅ¡ava sve adrese funkcija kada se binarni fajl pokrene i Äini **tabelu GOT samo za Äitanje** nakon toga:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Reference

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJE**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
