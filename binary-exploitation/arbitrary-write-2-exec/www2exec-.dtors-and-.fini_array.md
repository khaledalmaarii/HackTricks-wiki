# WWW2Exec - .dtors & .fini\_array

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## .dtors

{% hint style="danger" %}
ç°åœ¨å¾ˆ**å¥‡æ€ªæ‰¾åˆ°ä¸€ä¸ªå¸¦æœ‰.dtorséƒ¨åˆ†çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼**
{% endhint %}

ææ„å‡½æ•°æ˜¯åœ¨ç¨‹åºç»“æŸä¹‹å‰ï¼ˆåœ¨`main`å‡½æ•°è¿”å›åï¼‰æ‰§è¡Œçš„å‡½æ•°ã€‚\
è¿™äº›å‡½æ•°çš„åœ°å€å­˜å‚¨åœ¨äºŒè¿›åˆ¶æ–‡ä»¶çš„**`.dtors`**éƒ¨åˆ†ä¸­ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨è®¾æ³•**å†™å…¥**ä¸€ä¸ª**shellcode**çš„**åœ°å€**åˆ°**`__DTOR_END__`**ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç¨‹åºç»“æŸä¹‹å‰è¢«**æ‰§è¡Œ**ã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–æ­¤éƒ¨åˆ†çš„åœ°å€ï¼š
```bash
objdump -s -j .dtors /exec
rabin -s /exec | grep â€œ__DTORâ€
```
é€šå¸¸ä½ ä¼šåœ¨å€¼`ffffffff`å’Œ`00000000`ä¹‹é—´æ‰¾åˆ°**DTOR**æ ‡è®°ã€‚æ‰€ä»¥å¦‚æœä½ åªçœ‹åˆ°è¿™äº›å€¼ï¼Œæ„å‘³ç€**æ²¡æœ‰ä»»ä½•å‡½æ•°æ³¨å†Œ**ã€‚å› æ­¤ï¼Œ**è¦†ç›–**`00000000`çš„**åœ°å€**ä¸º**shellcode**çš„åœ°å€ä»¥æ‰§è¡Œå®ƒã€‚

{% hint style="warning" %}
å½“ç„¶ï¼Œä½ é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ª**å­˜å‚¨shellcodeçš„ä½ç½®**ï¼Œä»¥ä¾¿ç¨åè°ƒç”¨å®ƒã€‚
{% endhint %}

## **.fini\_array**

æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«åœ¨ç¨‹åºå®Œæˆä¹‹å‰å°†è¢«è°ƒç”¨çš„**å‡½æ•°çš„ç»“æ„**ï¼Œå°±åƒ**`.dtors`**ä¸€æ ·ã€‚å¦‚æœä½ å¯ä»¥é€šè¿‡**è·³è½¬åˆ°ä¸€ä¸ªåœ°å€è°ƒç”¨ä½ çš„shellcode**ï¼Œæˆ–è€…åœ¨éœ€è¦**è¿”å›åˆ°`main`**ä»¥**ç¬¬äºŒæ¬¡åˆ©ç”¨æ¼æ´**çš„æƒ…å†µä¸‹ï¼Œè¿™å°±å˜å¾—å¾ˆæœ‰è¶£ã€‚
```bash
objdump -s -j .fini_array ./greeting

./greeting:     file format elf32-i386

Contents of section .fini_array:
8049934 a0850408

#Put your address in 0x8049934
```
è¯·æ³¨æ„ï¼Œå½“ä» **`.fini_array`** ä¸­çš„ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤ä¸ä¼šè¢«å¤šæ¬¡æ‰§è¡Œï¼ˆé˜²æ­¢æ— é™å¾ªç¯ï¼‰ï¼Œä½†å®ƒä¹Ÿåªä¼šç»™ä½ æä¾›ä¸€ä¸ªåœ¨è¿™é‡Œæ”¾ç½®çš„ **å‡½æ•°æ‰§è¡Œ**ã€‚

è¯·æ³¨æ„ï¼Œ`.fini_array` ä¸­çš„æ¡ç›®æŒ‰**ç›¸å**é¡ºåºè°ƒç”¨ï¼Œå› æ­¤æ‚¨å¯èƒ½å¸Œæœ›ä»æœ€åä¸€ä¸ªå¼€å§‹ç¼–å†™ã€‚

#### æ— é™å¾ªç¯

ä¸ºäº†æ»¥ç”¨ **`.fini_array`** ä»¥è·å¾—æ— é™å¾ªç¯ï¼Œæ‚¨å¯ä»¥[**æ£€æŸ¥è¿™é‡Œåšäº†ä»€ä¹ˆ**](https://guyinatuxedo.github.io/17-stack\_pivot/insomnihack18\_onewrite/index.html)**ï¼š** å¦‚æœ **`.fini_array`** ä¸­è‡³å°‘æœ‰2ä¸ªæ¡ç›®ï¼Œæ‚¨å¯ä»¥ï¼š

* ä½¿ç”¨ç¬¬ä¸€ä¸ªå†™å…¥æ¥å†æ¬¡è°ƒç”¨**æ˜“å—æ”»å‡»çš„ä»»æ„å†™å…¥å‡½æ•°**
* ç„¶åï¼Œåœ¨ç”± **`__libc_csu_fini`** å­˜å‚¨çš„å †æ ˆä¸­è®¡ç®— **è¿”å›åœ°å€**ï¼Œå¹¶å°† **`__libc_csu_fini`** çš„åœ°å€æ”¾åœ¨é‚£é‡Œ
* è¿™å°†ä½¿ **`__libc_csu_fini`** å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œæ‰§è¡Œ **`.fini_array`** å‡½æ•°ï¼Œå†æ¬¡è°ƒç”¨æ˜“å—æ”»å‡»çš„ WWW å‡½æ•°2æ¬¡ï¼šä¸€æ¬¡ç”¨äº**ä»»æ„å†™å…¥**ï¼Œå¦ä¸€æ¬¡ç”¨äºå†æ¬¡è¦†ç›–å †æ ˆä¸Š **`__libc_csu_fini`** çš„**è¿”å›åœ°å€**ï¼Œä»¥å†æ¬¡è°ƒç”¨è‡ªèº«ã€‚

{% hint style="danger" %}
è¯·æ³¨æ„ï¼Œä½¿ç”¨[**Full RELRO**](../common-binary-protections-and-bypasses/relro.md)**ï¼Œ** **`.fini_array`** éƒ¨åˆ†è¢«è®¾ç½®ä¸º**åªè¯»**ã€‚
{% endhint %}

## link\_map

å¦‚[**æ­¤å¸–å­**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#2---targetting-ldso-link\_map-structure)ä¸­æ‰€è§£é‡Šçš„ï¼Œå¦‚æœç¨‹åºä½¿ç”¨ `return` æˆ– `exit()` é€€å‡ºï¼Œå®ƒå°†è¿è¡Œ `__run_exit_handlers()`ï¼Œè¯¥å‡½æ•°å°†è°ƒç”¨å·²æ³¨å†Œçš„ææ„å‡½æ•°ã€‚

{% hint style="danger" %}
å¦‚æœç¨‹åºé€šè¿‡ **`_exit()`** å‡½æ•°é€€å‡ºï¼Œå®ƒå°†è°ƒç”¨ **`exit` ç³»ç»Ÿè°ƒç”¨**ï¼Œé€€å‡ºå¤„ç†ç¨‹åºå°†ä¸ä¼šè¢«æ‰§è¡Œã€‚å› æ­¤ï¼Œè¦ç¡®è®¤ `__run_exit_handlers()` æ˜¯å¦è¢«æ‰§è¡Œï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸Šè®¾ç½®æ–­ç‚¹ã€‚
{% endhint %}

é‡è¦ä»£ç ä¸ºï¼ˆ[æºä»£ç ](https://elixir.bootlin.com/glibc/glibc-2.32/source/elf/dl-fini.c#L131)ï¼‰:
```c
ElfW(Dyn) *fini_array = map->l_info[DT_FINI_ARRAY];
if (fini_array != NULL)
{
ElfW(Addr) *array = (ElfW(Addr) *) (map->l_addr + fini_array->d_un.d_ptr);
size_t sz = (map->l_info[DT_FINI_ARRAYSZ]->d_un.d_val / sizeof (ElfW(Addr)));

while (sz-- > 0)
((fini_t) array[sz]) ();
}
[...]




// This is the d_un structure
ptype l->l_info[DT_FINI_ARRAY]->d_un
type = union {
Elf64_Xword d_val;	// address of function that will be called, we put our onegadget here
Elf64_Addr d_ptr;	// offset from l->l_addr of our structure
}
```
æ³¨æ„`map -> l_addr + fini_array -> d_un.d_ptr`æ˜¯ç”¨æ¥**è®¡ç®—** **è¦è°ƒç”¨çš„å‡½æ•°æ•°ç»„** çš„ä½ç½®ã€‚

æœ‰**å‡ ç§é€‰æ‹©**ï¼š

* è¦†ç›–`map->l_addr`çš„å€¼ï¼Œä½¿å…¶æŒ‡å‘ä¸€ä¸ªå¸¦æœ‰æ‰§è¡Œä»»æ„ä»£ç æŒ‡ä»¤çš„**ä¼ªé€ `fini_array`**ã€‚
* è¦†ç›–`l_info[DT_FINI_ARRAY]`å’Œ`l_info[DT_FINI_ARRAYSZ]`æ¡ç›®ï¼ˆåœ¨å†…å­˜ä¸­æ›´æˆ–å¤šå°‘æ˜¯è¿ç»­çš„ï¼‰ï¼Œä½¿å®ƒä»¬æŒ‡å‘ä¸€ä¸ªä¼ªé€ çš„`Elf64_Dyn`ç»“æ„ï¼Œå†æ¬¡ä½¿**`array`æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„å†…å­˜åŒºåŸŸ**ã€‚
* [**è¿™ç¯‡æ–‡ç« **](https://github.com/nobodyisnobody/write-ups/tree/main/DanteCTF.2023/pwn/Sentence.To.Hell)ç”¨å—æ§å†…å­˜ä¸­`.bss`ä¸­çš„åœ°å€è¦†ç›–äº†`l_info[DT_FINI_ARRAY]`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªä¼ªé€ çš„`fini_array`ã€‚è¿™ä¸ªä¼ªé€ æ•°ç»„é¦–å…ˆåŒ…å«ä¸€ä¸ª[**one gadget**](../rop-return-oriented-programing/ret2lib/one-gadget.md)çš„åœ°å€ï¼Œç„¶åæ˜¯è¿™ä¸ª**ä¼ªé€ æ•°ç»„**åœ°å€ä¸`map->l_addr`å€¼ä¹‹é—´çš„**å·®å¼‚**ï¼Œä»¥ä¾¿`*array`æŒ‡å‘ä¼ªé€ æ•°ç»„ã€‚
* æ ¹æ®è¿™ç§æŠ€æœ¯çš„ä¸»è¦å¸–å­å’Œ[**è¿™ç¯‡æ–‡ç« **](https://activities.tjhsst.edu/csc/writeups/angstromctf-2021-wallstreet)ï¼Œld.soåœ¨æ ˆä¸Šç•™ä¸‹ä¸€ä¸ªæŒ‡å‘ld.soä¸­çš„äºŒè¿›åˆ¶`link_map`çš„æŒ‡é’ˆã€‚é€šè¿‡ä»»æ„å†™å…¥ï¼Œå¯ä»¥è¦†ç›–å®ƒå¹¶ä½¿å…¶æŒ‡å‘ç”±æ”»å‡»è€…æ§åˆ¶çš„ä¼ªé€ `fini_array`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª[**one gadget**](../rop-return-oriented-programing/ret2lib/one-gadget.md)çš„åœ°å€ï¼Œä¾‹å¦‚ã€‚

åœ¨å‰é¢çš„ä»£ç ä¹‹åï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¦ä¸€ä¸ªæœ‰è¶£çš„éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹ä»£ç ï¼š
```c
/* Next try the old-style destructor.  */
ElfW(Dyn) *fini = map->l_info[DT_FINI];
if (fini != NULL)
DL_CALL_DT_FINI (map, ((void *) map->l_addr + fini->d_un.d_ptr));
}
```
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è¦†ç›–`map->l_info[DT_FINI]`çš„å€¼ï¼ŒæŒ‡å‘ä¸€ä¸ªä¼ªé€ çš„`ElfW(Dyn)`ç»“æ„ã€‚åœ¨[**è¿™é‡Œæ‰¾åˆ°æ›´å¤šä¿¡æ¯**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#2---targetting-ldso-link_map-structure)ã€‚

## åœ¨**`__run_exit_handlers`**ä¸­è¦†ç›–TLSå­˜å‚¨dtor_list

å¦‚[**è¿™é‡Œè§£é‡Šçš„**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#5---code-execution-via-tls-storage-dtor_list-overwrite)ï¼Œå¦‚æœç¨‹åºé€šè¿‡`return`æˆ–`exit()`é€€å‡ºï¼Œå®ƒå°†æ‰§è¡Œ**`__run_exit_handlers()`**ï¼Œè¯¥å‡½æ•°å°†è°ƒç”¨ä»»ä½•å·²æ³¨å†Œçš„ææ„å‡½æ•°ã€‚

æ¥è‡ª`_run_exit_handlers()`çš„ä»£ç ï¼š
```c
/* Call all functions registered with `atexit' and `on_exit',
in the reverse of the order in which they were registered
perform stdio cleanup, and terminate program execution with STATUS.  */
void
attribute_hidden
__run_exit_handlers (int status, struct exit_function_list **listp,
bool run_list_atexit, bool run_dtors)
{
/* First, call the TLS destructors.  */
#ifndef SHARED
if (&__call_tls_dtors != NULL)
#endif
if (run_dtors)
__call_tls_dtors ();
```
**`__call_tls_dtors()`** å‡½æ•°çš„ä»£ç ï¼š
```c
typedef void (*dtor_func) (void *);
struct dtor_list //struct added
{
dtor_func func;
void *obj;
struct link_map *map;
struct dtor_list *next;
};

[...]
/* Call the destructors.  This is called either when a thread returns from the
initial function or when the process exits via the exit function.  */
void
__call_tls_dtors (void)
{
while (tls_dtor_list)		// parse the dtor_list chained structures
{
struct dtor_list *cur = tls_dtor_list;		// cur point to tls-storage dtor_list
dtor_func func = cur->func;
PTR_DEMANGLE (func);						// demangle the function ptr

tls_dtor_list = tls_dtor_list->next;		// next dtor_list structure
func (cur->obj);
[...]
}
}
```
å¯¹äº**`tls_dtor_list`**ä¸­çš„æ¯ä¸ªæ³¨å†Œå‡½æ•°ï¼Œå®ƒå°†ä»**`cur->func`**ä¸­è§£ç æŒ‡é’ˆå¹¶ä½¿ç”¨å‚æ•°**`cur->obj`**è°ƒç”¨å®ƒã€‚

ä½¿ç”¨æ¥è‡ª[**GEFçš„è¿™ä¸ªåˆ†æ”¯**](https://github.com/bata24/gef)ä¸­çš„**`tls`**å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°**`dtor_list`**å®é™…ä¸Šéå¸¸**æ¥è¿‘****æ ˆä¿æŠ¤**å’Œ**PTR\_MANGLE cookie**ã€‚å› æ­¤ï¼Œé€šè¿‡å¯¹å…¶è¿›è¡Œæº¢å‡ºï¼Œå¯ä»¥**è¦†ç›–****cookie**å’Œ**æ ˆä¿æŠ¤**ã€‚\
è¦†ç›–PTR\_MANGLE cookieï¼Œå°†æœ‰å¯èƒ½**ç»•è¿‡`PTR_DEMANLE`å‡½æ•°**ï¼Œå› ä¸ºå°†å…¶è®¾ç½®ä¸º0x00ï¼Œå°†æ„å‘³ç€ç”¨äºè·å–çœŸå®åœ°å€çš„**`xor`**ä»…æ˜¯é…ç½®çš„åœ°å€ã€‚ç„¶åï¼Œåœ¨**`dtor_list`**ä¸Šå†™å…¥ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°**åœ°å€**åŠå…¶**å‚æ•°**æ¥**é“¾æ¥å¤šä¸ªå‡½æ•°**ã€‚

æœ€åè¯·æ³¨æ„ï¼Œå­˜å‚¨çš„æŒ‡é’ˆä¸ä»…ä¼šä¸cookieè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿˜ä¼šæ—‹è½¬17ä½ï¼š
```armasm
0x00007fc390444dd4 <+36>:	mov    rax,QWORD PTR [rbx]      --> mangled ptr
0x00007fc390444dd7 <+39>:	ror    rax,0x11		        --> rotate of 17 bits
0x00007fc390444ddb <+43>:	xor    rax,QWORD PTR fs:0x30	--> xor with PTR_MANGLE
```
åœ¨æ·»åŠ æ–°åœ°å€ä¹‹å‰ï¼Œæ‚¨éœ€è¦è€ƒè™‘è¿™ä¸€ç‚¹ã€‚

åœ¨[**åŸå§‹å¸–å­**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#5---code-execution-via-tls-storage-dtor\_list-overwrite)ä¸­æ‰¾ä¸€ä¸ªä¾‹å­ã€‚

## **`__run_exit_handlers`** ä¸­çš„å…¶ä»–æ··æ·†æŒ‡é’ˆ

è¿™ç§æŠ€æœ¯åœ¨[**è¿™é‡Œè§£é‡Š**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#5---code-execution-via-tls-storage-dtor\_list-overwrite)ï¼Œå†æ¬¡å–å†³äºç¨‹åº**é€šè¿‡è°ƒç”¨ `return` æˆ– `exit()` é€€å‡º**ï¼Œä»è€Œè°ƒç”¨ **`__run_exit_handlers()`**ã€‚

è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„æ›´å¤šä»£ç ï¼š
```c
while (true)
{
struct exit_function_list *cur;

restart:
cur = *listp;

if (cur == NULL)
{
/* Exit processing complete.  We will not allow any more
atexit/on_exit registrations.  */
__exit_funcs_done = true;
break;
}

while (cur->idx > 0)
{
struct exit_function *const f = &cur->fns[--cur->idx];
const uint64_t new_exitfn_called = __new_exitfn_called;

switch (f->flavor)
{
void (*atfct) (void);
void (*onfct) (int status, void *arg);
void (*cxafct) (void *arg, int status);
void *arg;

case ef_free:
case ef_us:
break;
case ef_on:
onfct = f->func.on.fn;
arg = f->func.on.arg;
PTR_DEMANGLE (onfct);

/* Unlock the list while we call a foreign function.  */
__libc_lock_unlock (__exit_funcs_lock);
onfct (status, arg);
__libc_lock_lock (__exit_funcs_lock);
break;
case ef_at:
atfct = f->func.at;
PTR_DEMANGLE (atfct);

/* Unlock the list while we call a foreign function.  */
__libc_lock_unlock (__exit_funcs_lock);
atfct ();
__libc_lock_lock (__exit_funcs_lock);
break;
case ef_cxa:
/* To avoid dlclose/exit race calling cxafct twice (BZ 22180),
we must mark this function as ef_free.  */
f->flavor = ef_free;
cxafct = f->func.cxa.fn;
arg = f->func.cxa.arg;
PTR_DEMANGLE (cxafct);

/* Unlock the list while we call a foreign function.  */
__libc_lock_unlock (__exit_funcs_lock);
cxafct (arg, status);
__libc_lock_lock (__exit_funcs_lock);
break;
}

if (__glibc_unlikely (new_exitfn_called != __new_exitfn_called))
/* The last exit function, or another thread, has registered
more exit functions.  Start the loop over.  */
goto restart;
}

*listp = cur->next;
if (*listp != NULL)
/* Don't free the last element in the chain, this is the statically
allocate element.  */
free (cur);
}

__libc_lock_unlock (__exit_funcs_lock);
```
å˜é‡`f`æŒ‡å‘**`initial`**ç»“æ„ï¼Œæ ¹æ®`f->flavor`çš„å€¼ä¸åŒï¼Œå°†è°ƒç”¨ä¸åŒçš„å‡½æ•°ã€‚\
æ ¹æ®æ•°å€¼ä¸åŒï¼Œè¦è°ƒç”¨çš„å‡½æ•°åœ°å€ä¼šåœ¨ä¸åŒçš„ä½ç½®ï¼Œä½†å®ƒä»¬å§‹ç»ˆä¼šè¢«**è§£ç **ã€‚

æ­¤å¤–ï¼Œåœ¨é€‰é¡¹**`ef_on`**å’Œ**`ef_cxa`**ä¸­ï¼Œè¿˜å¯ä»¥æ§åˆ¶ä¸€ä¸ª**å‚æ•°**ã€‚

å¯ä»¥åœ¨ä½¿ç”¨GEFè¿è¡Œ**`gef> p initial`**çš„è°ƒè¯•ä¼šè¯ä¸­æ£€æŸ¥**`initial`ç»“æ„**ã€‚

è¦åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæ‚¨éœ€è¦**æ³„æ¼æˆ–æ“¦é™¤`PTR_MANGLE`cookie**ï¼Œç„¶åç”¨`system('/bin/sh')`è¦†ç›–`initial`ä¸­çš„`cxa`æ¡ç›®ã€‚\
æ‚¨å¯ä»¥åœ¨[**æœ‰å…³è¯¥æŠ€æœ¯çš„åŸå§‹åšå®¢æ–‡ç« **](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#6---code-execution-via-other-mangled-pointers-in-initial-structure)ä¸­æ‰¾åˆ°ä¸€ä¸ªç¤ºä¾‹ã€‚

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
