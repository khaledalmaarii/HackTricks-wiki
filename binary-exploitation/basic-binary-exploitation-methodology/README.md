# Temel Ä°kili SÃ¶mÃ¼rÃ¼ Metodolojisi

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nleri**](https://peass.creator-spring.com)'ni edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

## ELF Temel Bilgileri

Herhangi bir ÅŸeyi sÃ¶mÃ¼rmeye baÅŸlamadan Ã¶nce bir **ELF ikilisinin** yapÄ±sÄ±nÄ±n bir kÄ±smÄ±nÄ± anlamak ilginÃ§ olabilir:

{% content-ref url="elf-tricks.md" %}
[elf-tricks.md](elf-tricks.md)
{% endcontent-ref %}

## SÃ¶mÃ¼rÃ¼ AraÃ§larÄ±

{% content-ref url="tools/" %}
[tools](tools/)
{% endcontent-ref %}

## YÄ±ÄŸÄ±n TaÅŸmasÄ± Metodolojisi

Bu kadar teknikle birlikte her teknik ne zaman kullanÄ±ÅŸlÄ± olacak bir ÅŸema olmasÄ± iyidir. AynÄ± korumalar farklÄ± teknikleri etkileyecektir. KorumalarÄ± atlatma yollarÄ±nÄ± her koruma bÃ¶lÃ¼mÃ¼nde bulabilirsiniz ancak bu metodolojide deÄŸil.

## AkÄ±ÅŸÄ± Kontrol Etme

Bir programÄ±n akÄ±ÅŸÄ±nÄ± kontrol etmenin farklÄ± yollarÄ± olabilir:

* [**YÄ±ÄŸÄ±n TaÅŸmalarÄ±**](../stack-overflow/): YÄ±ÄŸÄ±ndan dÃ¶nÃ¼ÅŸ iÅŸaretÃ§isini veya EBP -> ESP -> EIP'yi Ã¼zerine yazarak.
* TaÅŸmayÄ± tetiklemek iÃ§in bir [**TamsayÄ± TaÅŸmalarÄ±**](../integer-overflow.md) kullanmanÄ±z gerekebilir
* Veya **Keyfi Yazma + Ne Nerede Yazma YÃ¼rÃ¼tme** yoluyla
* [**BiÃ§im dizeleri**](../format-strings/)**:** `printf`'i kÃ¶tÃ¼ye kullanarak keyfi iÃ§eriÄŸi keyfi adreslere yazmak.
* [**Dizi Ä°ndeksleme**](../array-indexing.md): KÃ¶tÃ¼ tasarlanmÄ±ÅŸ bir dizinlemeyi kÃ¶tÃ¼ye kullanarak bazÄ± dizileri kontrol edebilir ve keyfi yazma alabilirsiniz.
* TaÅŸmayÄ± tetiklemek iÃ§in bir [**TamsayÄ± TaÅŸmalarÄ±**](../integer-overflow.md) kullanmanÄ±z gerekebilir
* **bof to WWW via ROP**: Bir tampon taÅŸmasÄ±nÄ± kÃ¶tÃ¼ye kullanarak bir ROP oluÅŸturmak ve bir WWW almak iÃ§in.

**Ne Nerede Yazma YÃ¼rÃ¼tme** tekniklerini ÅŸurada bulabilirsiniz:

{% content-ref url="../arbitrary-write-2-exec/" %}
[arbitrary-write-2-exec](../arbitrary-write-2-exec/)
{% endcontent-ref %}

## Sonsuz DÃ¶ngÃ¼ler

Dikkate alÄ±nmasÄ± gereken bir ÅŸey genellikle **bir zafiyetin sadece bir kez sÃ¶mÃ¼rÃ¼lmesinin yeterli olmayabileceÄŸidir**, Ã¶zellikle bazÄ± korumalarÄ±n atlatÄ±lmasÄ± gerekebilir. Bu nedenle, aynÄ± yÃ¼rÃ¼tmede **bir zafiyeti birden fazla kez sÃ¶mÃ¼rÃ¼lebilir hale getirmek iÃ§in bazÄ± seÃ§enekleri** tartÄ±ÅŸmak ilginÃ§tir:

* Bir **ROP** zincirine **`main` iÅŸlevinin adresini** veya **zafiyetin meydana geldiÄŸi adrese** yazÄ±n.
* Uygun bir ROP zincirini kontrol ederek o zincirdeki tÃ¼m iÅŸlemleri gerÃ§ekleÅŸtirebilirsiniz
* **`exit` adresini GOT'a yazÄ±n** (veya bitmeden Ã¶nce kullanÄ±lan baÅŸka bir iÅŸlev) **zafiyete geri dÃ¶nmek iÃ§in** adresi
* [**.fini\_array**](../arbitrary-write-2-exec/www2exec-.dtors-and-.fini\_array.md#eternal-loop)** aÃ§Ä±klamasÄ±nda belirtildiÄŸi gibi**, buraya 2 iÅŸlev saklayÄ±n, biri zafiyeti tekrar Ã§aÄŸÄ±rmak iÃ§in diÄŸeri `.fini_array` iÅŸlevini tekrar Ã§aÄŸÄ±racak olan**`__libc_csu_fini`** iÅŸlevini Ã§aÄŸÄ±rmak iÃ§in.

## SÃ¶mÃ¼rÃ¼ Hedefleri

### Hedef: Varolan bir iÅŸlevi Ã‡aÄŸÄ±rmak

* [**ret2win**](./#ret2win): Ã‡aÄŸÄ±rmanÄ±z gereken bir iÅŸlev (belki belirli parametrelerle) varsa bayraÄŸÄ± almak iÃ§in.
* [**PIE**](../common-binary-protections-and-bypasses/pie/) **olmadan** ve [**canary**](../common-binary-protections-and-bypasses/stack-canaries/) ile birlikte dÃ¼zenli bir bof'ta, yÄ±ÄŸÄ±nda depolanan dÃ¶nÃ¼ÅŸ adresine adresi yazmanÄ±z yeterli olacaktÄ±r.
* [**PIE**](../common-binary-protections-and-bypasses/pie/) ile bir bof'ta, bunu atlatmanÄ±z gerekecektir
* [**canary**](../common-binary-protections-and-bypasses/stack-canaries/) ile bir bof'ta, bunu atlatmanÄ±z gerekecektir
* **ret2win** iÅŸlevini doÄŸru ÅŸekilde Ã§aÄŸÄ±rmak iÃ§in birden fazla parametre ayarlamanÄ±z gerekiyorsa ÅŸunlarÄ± kullanabilirsiniz:
* **Yeterli sayÄ±da** kÄ±sayol varsa [**ROP**](./#rop-and-ret2...-techniques) **zinciri tÃ¼m parametreleri hazÄ±rlamak iÃ§in**
* [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) (bu sistem Ã§aÄŸrÄ±sÄ±nÄ± yapabiliyorsanÄ±z) birÃ§ok kaydÄ± kontrol etmek iÃ§in
* [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) ve [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) 'dan kÄ±sayollarÄ± kontrol etmek iÃ§in
* Bir [**Ne Nerede Yazma**](../arbitrary-write-2-exec/) kullanarak diÄŸer zafiyetleri (bof olmayanlar) kÃ¶tÃ¼ye kullanarak **`win`** iÅŸlevini Ã§aÄŸÄ±rabilirsiniz.
* [**Ä°ÅŸaretÃ§ileri YÃ¶nlendirme**](../stack-overflow/pointer-redirecting.md): YÄ±ÄŸÄ±nda, Ã§aÄŸrÄ±lacak bir iÅŸlevin iÅŸaretÃ§ilerini veya bir iÅŸlev tarafÄ±ndan kullanÄ±lacak bir dizeye iÅŸaretÃ§iler varsa, o adresi Ã¼zerine yazabilirsiniz.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) adresleri etkileyebilir.
* [**Ä°lklenmemiÅŸ deÄŸiÅŸkenler**](../stack-overflow/uninitialized-variables.md): Asla bilemezsiniz.

### Hedef: Uzaktan Kod YÃ¼rÃ¼tme (RCE)

#### Nx devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸsa veya shellcode ile ROP karÄ±ÅŸtÄ±rÄ±lÄ±yorsa:

* [**(YÄ±ÄŸÄ±n) Shellcode**](./#stack-shellcode): Bu, bir shellcode'u yÄ±ÄŸÄ±nda depolamak ve ardÄ±ndan dÃ¶nÃ¼ÅŸ iÅŸaretÃ§isini Ã¼zerine yazarak ona atlamak ve Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r:
* **Her durumda, bir** [**canary**](../common-binary-protections-and-bypasses/stack-canaries/)** varsa**, dÃ¼zenli bir bof'ta bunu atlatmanÄ±z gerekecektir
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **ve** [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) **olmadan** yÄ±ÄŸÄ±nÄ±n adresine atlamak mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼ asla deÄŸiÅŸmeyecektir
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) ile, ona atlamak iÃ§in [**ret2esp/ret2reg**](../rop-return-oriented-programing/ret2esp-ret2reg.md) gibi teknikler gerekecektir
* [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) **ile**, bir [**ROP**](../rop-return-oriented-programing/) kullanarak **`memprotect`'i Ã§aÄŸÄ±rmak** ve bazÄ± sayfalarÄ± `rwx` yapmak iÃ§in gerekecektir, ardÄ±ndan oraya **shellcode'u depolamak** (Ã¶rneÄŸin okuma Ã§aÄŸÄ±rarak) ve ardÄ±ndan oraya atlamak.
* Bu, shellcode'u bir ROP zinciri ile karÄ±ÅŸtÄ±racaktÄ±r.
#### Syscall Yoluyla

* [**Ret2syscall**](../rop-return-oriented-programing/rop-syscall-execv/): Herhangi bir komutu Ã§alÄ±ÅŸtÄ±rmak iÃ§in `execve`'yi Ã§aÄŸÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r. **Belirli bir syscall'Ä± parametrelerle Ã§aÄŸÄ±rmak iÃ§in gerekli olan gadget'larÄ± bulabilmelisiniz**.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) etkinse, ROP gadget'larÄ±nÄ± kullanabilmek iÃ§in bunlarÄ± **geÃ§mek gerekecek**.
* [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) **ret2execve'yi hazÄ±rlamak iÃ§in** faydalÄ± olabilir
* Ã‡eÅŸitli register'larÄ± kontrol etmek iÃ§in [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) ve [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) gadget'larÄ±

#### Libc AracÄ±lÄ±ÄŸÄ±yla

* [**Ret2lib**](../rop-return-oriented-programing/ret2lib/): Genellikle **`libc`** gibi bir kÃ¼tÃ¼phaneden bir fonksiyonu (genellikle **`system`**) Ã§aÄŸÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r ve bazÄ± hazÄ±rlanmÄ±ÅŸ argÃ¼manlarla (Ã¶r. `'/bin/sh'`). Ã‡aÄŸÄ±rmak istediÄŸiniz fonksiyonun kÃ¼tÃ¼phaneyi **yÃ¼klemesi gerekmektedir** (genellikle libc).
* **Statik olarak derlenmiÅŸ ve** [**PIE**](../common-binary-protections-and-bypasses/pie/) **etkin deÄŸilse**, `system` ve `/bin/sh`'nin **adresleri deÄŸiÅŸmeyecek**, bu yÃ¼zden bunlarÄ± statik olarak kullanmak mÃ¼mkÃ¼n olacaktÄ±r.
* **ASLR olmadan ve yÃ¼klÃ¼ libc sÃ¼rÃ¼mÃ¼nÃ¼ bildiÄŸinizde**, `system` ve `/bin/sh`'nin **adresleri deÄŸiÅŸmeyecek**, bu yÃ¼zden bunlarÄ± statik olarak kullanmak mÃ¼mkÃ¼n olacaktÄ±r.
* [ASLR](../common-binary-protections-and-bypasses/aslr/) **ancak** [PIE](../common-binary-protections-and-bypasses/pie/)** etkin deÄŸilse**, libc'yi bildiÄŸiniz ve binary'nin `system` fonksiyonunu kullandÄ±ÄŸÄ± durumda, `'/bin/sh'` adresiyle birlikte **GOT'taki system adresine `ret` yapmak** mÃ¼mkÃ¼n olacaktÄ±r (bunu Ã§Ã¶zmeniz gerekecektir).
* [ASLR](../common-binary-protections-and-bypasses/aslr/) **ancak** [PIE](../common-binary-protections-and-bypasses/pie/)** etkin deÄŸilse**, libc'yi bildiÄŸiniz ve **binary'nin `system`'i kullanmadÄ±ÄŸÄ± durumda**:
* **`ret2dlresolve`**'yi kullanarak `system`'in adresini Ã§Ã¶zÃ¼mlemek ve Ã§aÄŸÄ±rmak iÃ§in
* [ASLR](../common-binary-protections-and-bypasses/aslr/) **geÃ§mek ve bellekteki `system` ve `'/bin/sh'` adreslerini hesaplamak**.
* [ASLR](../common-binary-protections-and-bypasses/aslr/) **ve** [PIE](../common-binary-protections-and-bypasses/pie/) **etkin ve libc bilinmiyorsa**: ÅunlarÄ± yapmanÄ±z gerekecek:
* [PIE](../common-binary-protections-and-bypasses/pie/) **geÃ§mek**
* KullanÄ±lan **`libc` sÃ¼rÃ¼mÃ¼nÃ¼** bulmak (birkaÃ§ fonksiyon adresini sÄ±zdÄ±rmak)
* Devam etmek iÃ§in **ASLR ile Ã¶nceki senaryolarÄ± kontrol etmek**.

#### EBP/RBP AracÄ±lÄ±ÄŸÄ±yla

* [**Stack Pivoting / EBP2Ret / EBP Chaining**](../stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.md): ESP'yi kontrol ederek stack'teki depolanan EBP aracÄ±lÄ±ÄŸÄ±yla RET'i kontrol etmek.
* **Off-by-one** stack taÅŸmalarÄ± iÃ§in kullanÄ±ÅŸlÄ±
* EIP'yi kontrol etmeyi sonlandÄ±rmak iÃ§in alternatif bir yol olarak kullanÄ±ÅŸlÄ±dÄ±r, EIP'yi hafÄ±zada payload oluÅŸturmak iÃ§in kÃ¶tÃ¼ye kullanarak ve ardÄ±ndan EBP aracÄ±lÄ±ÄŸÄ±yla ona atlayarak.

#### Ã‡eÅŸitli

* [**Pointers Redirecting**](../stack-overflow/pointer-redirecting.md): Stack'te Ã§aÄŸrÄ±lacak bir fonksiyonun veya ilginÃ§ bir fonksiyon tarafÄ±ndan kullanÄ±lacak bir dizeye iÅŸaret eden iÅŸaretÃ§iler varsa, o adresi Ã¼zerine yazmak mÃ¼mkÃ¼ndÃ¼r.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) adresleri etkileyebilir.
* [**Ä°lklenmemiÅŸ deÄŸiÅŸkenler**](../stack-overflow/uninitialized-variables.md): Asla bilemezsiniz
