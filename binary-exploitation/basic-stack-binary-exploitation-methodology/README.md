# Temel Ä°kili SÃ¶mÃ¼rÃ¼ Metodolojisi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.**

</details>
{% endhint %}

## ELF Temel Bilgileri

Herhangi bir ÅŸeyi sÃ¶mÃ¼rmeye baÅŸlamadan Ã¶nce bir **ELF ikilisinin** yapÄ±sÄ±nÄ±n bir kÄ±smÄ±nÄ± anlamak ilginÃ§ olabilir:

{% content-ref url="elf-tricks.md" %}
[elf-tricks.md](elf-tricks.md)
{% endcontent-ref %}

## SÃ¶mÃ¼rÃ¼ AraÃ§larÄ±

{% content-ref url="tools/" %}
[tools](tools/)
{% endcontent-ref %}

## YÄ±ÄŸÄ±n TaÅŸmasÄ± Metodolojisi

Bu kadar teknikle, her tekniÄŸin ne zaman kullanÄ±ÅŸlÄ± olacaÄŸÄ±nÄ± belirlemek iÃ§in bir plana sahip olmak iyidir. AynÄ± korumalarÄ±n farklÄ± teknikleri etkileyeceÄŸini unutmayÄ±n. Her koruma bÃ¶lÃ¼mÃ¼nde korumalarÄ± atlatma yollarÄ±nÄ± bulabilirsiniz, ancak bu metodolojide deÄŸil.

## AkÄ±ÅŸÄ± Kontrol Etme

Bir programÄ±n akÄ±ÅŸÄ±nÄ± kontrol etmenin farklÄ± yollarÄ± olabilir:

* [**YÄ±ÄŸÄ±n TaÅŸmalarÄ±**](../stack-overflow/): YÄ±ÄŸÄ±ndan dÃ¶nÃ¼ÅŸ iÅŸaretÃ§isini veya EBP -> ESP -> EIP'yi Ã¼zerine yazarak.
* TaÅŸmayÄ± tetiklemek iÃ§in bir [**TamsayÄ± TaÅŸmalarÄ±**](../integer-overflow.md) kullanmanÄ±z gerekebilir
* Veya **Keyfi Yazma + Ne Nerede Yazma ile YÃ¼rÃ¼tme**
* [**BiÃ§im Dizileri**](../format-strings/)**:** `printf`'i kÃ¶tÃ¼ye kullanarak keyfi iÃ§eriÄŸi keyfi adreslere yazmak.
* [**Dizi Ä°ndeksleme**](../array-indexing.md): KÃ¶tÃ¼ tasarlanmÄ±ÅŸ bir dizinlemeyi kÃ¶tÃ¼ye kullanarak bazÄ± dizileri kontrol edebilir ve keyfi yazma alabilirsiniz.
* TaÅŸmayÄ± tetiklemek iÃ§in bir [**TamsayÄ± TaÅŸmalarÄ±**](../integer-overflow.md) kullanmanÄ±z gerekebilir
* **bof to WWW via ROP**: Bir tampon taÅŸmasÄ±nÄ± kÃ¶tÃ¼ye kullanarak bir ROP oluÅŸturmak ve bir WWW almak iÃ§in.

**Ne Nerede Yazma ile YÃ¼rÃ¼tme** tekniklerini ÅŸurada bulabilirsiniz:

{% content-ref url="../arbitrary-write-2-exec/" %}
[arbitrary-write-2-exec](../arbitrary-write-2-exec/)
{% endcontent-ref %}

## Sonsuz DÃ¶ngÃ¼ler

Dikkate alÄ±nmasÄ± gereken bir ÅŸey genellikle **bir zafiyetin sadece bir kez sÃ¶mÃ¼rÃ¼lmesinin yeterli olmayabileceÄŸidir**, Ã¶zellikle bazÄ± korumalarÄ±n atlatÄ±lmasÄ± gerekebilir. Bu nedenle, **bir zafiyeti aynÄ± ikili Ã§alÄ±ÅŸtÄ±rmada birkaÃ§ kez sÃ¶mÃ¼rÃ¼lebilir hale getirmek iÃ§in bazÄ± seÃ§enekleri** tartÄ±ÅŸmak ilginÃ§tir:

* Bir **ROP** zincirine **`main` iÅŸlevinin adresini** veya **zafiyetin meydana geldiÄŸi adrese** yazÄ±n.
* Uygun bir ROP zincirini kontrol ederek o zincirdeki tÃ¼m iÅŸlemleri gerÃ§ekleÅŸtirebilirsiniz
* **`exit` adresini GOT'a** (veya bitmeden Ã¶nce ikili tarafÄ±ndan kullanÄ±lan baÅŸka bir iÅŸlev) **zafiyete geri dÃ¶nmek iÃ§in adresi yazÄ±n**
* [**.fini\_array**](../arbitrary-write-2-exec/www2exec-.dtors-and-.fini\_array.md#eternal-loop)**'de aÃ§Ä±klandÄ±ÄŸÄ± gibi,** buraya 2 iÅŸlev saklayÄ±n, biri zafiyeti tekrar Ã§aÄŸÄ±rmak iÃ§in diÄŸeri ise `.fini_array`'dan iÅŸlevi tekrar Ã§aÄŸÄ±racak olan**`__libc_csu_fini`**'yi Ã§aÄŸÄ±rmak iÃ§in.

## SÃ¶mÃ¼rÃ¼ Hedefleri

### Hedef: Varolan bir iÅŸlevi Ã‡aÄŸÄ±rmak

* [**ret2win**](./#ret2win): Ã‡aÄŸÄ±rmanÄ±z gereken bir iÅŸlev var (belki belirli parametrelerle) bayraÄŸÄ± almak iÃ§in.
* [**PIE**](../common-binary-protections-and-bypasses/pie/) olmadan ve [**canary**](../common-binary-protections-and-bypasses/stack-canaries/) olmadan dÃ¼zenli bir bof'ta, yÄ±ÄŸÄ±nda depolanan dÃ¶nÃ¼ÅŸ adresine adresi yazmanÄ±z yeterli olacaktÄ±r.
* [**PIE**](../common-binary-protections-and-bypasses/pie/) ile bir bof'ta, bunu atlatmanÄ±z gerekecektir
* [**canary**](../common-binary-protections-and-bypasses/stack-canaries/) ile bir bof'ta, bunu atlatmanÄ±z gerekecektir
* **ret2win** iÅŸlevini doÄŸru ÅŸekilde Ã§aÄŸÄ±rmak iÃ§in birden fazla parametre ayarlamanÄ±z gerekiyorsa ÅŸunlarÄ± kullanabilirsiniz:
* **Yeterli sayÄ±da** kÄ±sayol varsa [**ROP**](./#rop-and-ret2...-techniques) **zinciri tÃ¼m parametreleri hazÄ±rlamak iÃ§in**
* [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) (bu sistem Ã§aÄŸrÄ±sÄ±nÄ± yapabiliyorsanÄ±z) birÃ§ok kaydÄ± kontrol etmek iÃ§in
* [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) ve [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) 'dan kÄ±sayollarÄ± kontrol etmek iÃ§in
* Bir [**Ne Nerede Yazma**](../arbitrary-write-2-exec/) ile baÅŸka zafiyetleri (bof olmayanlar) kÃ¶tÃ¼ye kullanarak **`win`** iÅŸlevini Ã§aÄŸÄ±rabilirsiniz.
* [**Ä°ÅŸaretÃ§ileri YÃ¶nlendirme**](../stack-overflow/pointer-redirecting.md): YÄ±ÄŸÄ±n, Ã§aÄŸrÄ±lacak bir iÅŸlevin iÅŸaretÃ§ilerini veya bir iÅŸlev tarafÄ±ndan kullanÄ±lacak bir dizeye iÅŸaret ediyorsa (system veya printf gibi), o adresi Ã¼zerine yazabilirsiniz.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) adresleri etkileyebilir.
* [**Ä°lklenmemiÅŸ deÄŸiÅŸkenler**](../stack-overflow/uninitialized-variables.md): Asla bilemezsiniz.

### Hedef: Uzaktan Kod YÃ¼rÃ¼tme (RCE)

#### Nx devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸsa veya kodu karÄ±ÅŸtÄ±rarak shellcode ile:

* [**(YÄ±ÄŸÄ±n) Shellcode**](./#stack-shellcode): Bu, bir shellcode'u yÄ±ÄŸÄ±nda depolamak ve ardÄ±ndan dÃ¶nÃ¼ÅŸ iÅŸaretÃ§isini Ã¼zerine yazdÄ±ktan sonra ona atlamak ve Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r:
* **Her durumda, bir** [**canary**](../common-binary-protections-and-bypasses/stack-canaries/)** varsa,** dÃ¼zenli bir bof'ta bunu atlatmanÄ±z (sÄ±zdÄ±rmanÄ±z) gerekecektir
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **ve** [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) olmadan, yÄ±ÄŸÄ±nÄ±n adresine atlamak mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼ asla deÄŸiÅŸmeyecektir
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) ile, ona atlamak iÃ§in [**ret2esp/ret2reg**](../rop-return-oriented-programing/ret2esp-ret2reg.md) gibi tekniklere ihtiyacÄ±nÄ±z olacaktÄ±r
* [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) ile, birkaÃ§ [**ROP**](../rop-return-oriented-programing/) kullanmanÄ±z gerekecektir **`memprotect`'Ä± Ã§aÄŸÄ±rmak** ve bazÄ± sayfalarÄ± `rwx` yapmak iÃ§in, ardÄ±ndan oraya **shellcode'u depolamak** (Ã¶rneÄŸin okuma Ã§aÄŸÄ±rarak) ve ardÄ±ndan oraya atlamak iÃ§in.
* Bu, shellcode'u bir ROP zinciri ile karÄ±ÅŸtÄ±racaktÄ±r.
#### Syscall ile

* [**Ret2syscall**](../rop-return-oriented-programing/rop-syscall-execv/): Herhangi bir komutu Ã§alÄ±ÅŸtÄ±rmak iÃ§in `execve`'yi Ã§aÄŸÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r. **Belirli bir syscall'Ä± parametrelerle Ã§aÄŸÄ±rmak iÃ§in gerekli olan gadget'larÄ± bulabilmelisiniz**.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) etkinse, ROP gadget'larÄ±nÄ± kullanabilmek iÃ§in bunlarÄ± **geÃ§mek gerekecek**.
* [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) **ret2execve'yi hazÄ±rlamak iÃ§in** kullanÄ±ÅŸlÄ± olabilir
* [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) ve [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) ile Ã§eÅŸitli register'larÄ± kontrol etmek iÃ§in gadget'lar

#### Libc ile

* [**Ret2lib**](../rop-return-oriented-programing/ret2lib/): Genellikle **`libc`** gibi bir kÃ¼tÃ¼phaneden bir fonksiyonu (genellikle **`system`**) Ã§aÄŸÄ±rmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r ve bazÄ± hazÄ±rlanmÄ±ÅŸ argÃ¼manlarla (Ã¶r. `'/bin/sh'`). Ã‡aÄŸÄ±rmak istediÄŸiniz fonksiyonu iÃ§eren kÃ¼tÃ¼phanenin **yÃ¼klenmiÅŸ olmasÄ± gerekmektedir**.
* **Statik olarak derlenmiÅŸ ve** [**PIE**](../common-binary-protections-and-bypasses/pie/) **olmayan durumlarda**, `system` ve `/bin/sh`'nin **adresleri deÄŸiÅŸmeyecek**, bu yÃ¼zden bunlarÄ± statik olarak kullanmak mÃ¼mkÃ¼n olacaktÄ±r.
* **ASLR olmadan** [**ve yÃ¼klÃ¼ olan libc sÃ¼rÃ¼mÃ¼nÃ¼** bilerek, `system` ve `/bin/sh`'nin **adresleri deÄŸiÅŸmeyecek**, bu yÃ¼zden bunlarÄ± statik olarak kullanmak mÃ¼mkÃ¼n olacaktÄ±r.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **var ancak** [**PIE**](../common-binary-protections-and-bypasses/pie/) **yoksa, libc bilinir ve binary `system`** fonksiyonunu kullandÄ±ÄŸÄ±nda, `'/bin/sh'` adresine **GOT'taki system adresine** `ret` yapmak mÃ¼mkÃ¼n olacaktÄ±r (bunu Ã§Ã¶zmeniz gerekecek).
* [ASLR](../common-binary-protections-and-bypasses/aslr/) **var ancak** [PIE](../common-binary-protections-and-bypasses/pie/) **yoksa, libc bilinir ve binary `system`'i kullanmadÄ±ÄŸÄ±nda**:
* **`ret2dlresolve`**'yi kullanarak `system`'in adresini Ã§Ã¶zÃ¼mlemek ve Ã§aÄŸÄ±rmak mÃ¼mkÃ¼ndÃ¼r.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **geÃ§mek ve `system` ve `'/bin/sh'`'nin adresini hesaplamak** iÃ§in
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **ve** [**PIE**](../common-binary-protections-and-bypasses/pie/) **var ve libc bilinmiyorsa**: 
* [**PIE**](../common-binary-protections-and-bypasses/pie/) **geÃ§mek**
* KullanÄ±lan **`libc` sÃ¼rÃ¼mÃ¼nÃ¼** bulmak (birkaÃ§ fonksiyon adresini sÄ±zdÄ±rmak)
* Devam etmek iÃ§in **ASLR ile Ã¶nceki senaryolarÄ± kontrol etmek** gerekecek.

#### EBP/RBP ile

* [**Stack Pivoting / EBP2Ret / EBP Chaining**](../stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.md): ESP'yi kontrol ederek stack'te depolanan EBP aracÄ±lÄ±ÄŸÄ±yla RET'i kontrol etmek.
* **Off-by-one** stack overflow'lar iÃ§in kullanÄ±ÅŸlÄ±dÄ±r
* EIP'yi kontrol etmeyi sonlandÄ±rmanÄ±n alternatif bir yol olarak kullanÄ±ÅŸlÄ±dÄ±r, EIP'yi kontrol ederken bellekte payload'Ä± oluÅŸturmak ve ardÄ±ndan EBP aracÄ±lÄ±ÄŸÄ±yla ona atlamak iÃ§in

#### Ã‡eÅŸitli

* [**Pointers Redirecting**](../stack-overflow/pointer-redirecting.md): Stack'te Ã§aÄŸrÄ±lacak bir fonksiyonun adreslerini veya bir dizeyi iÃ§eren iÅŸlevin (system veya printf gibi) kullanÄ±lacaÄŸÄ±na dair iÅŸaretÃ§iler varsa, o adresi Ã¼zerine yazmak mÃ¼mkÃ¼ndÃ¼r.
* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) veya [**PIE**](../common-binary-protections-and-bypasses/pie/) adresleri etkileyebilir.
* [**Ä°lklenmemiÅŸ deÄŸiÅŸkenler**](../stack-overflow/uninitialized-variables.md): Asla bilemezsiniz
