# Ret2ret & Ret2pop

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶nderin.

</details>

## Ret2ret

Bu teknikteki ana **amaÃ§**, **ASLR'yi atlayarak yÄ±ÄŸÄ±n iÃ§indeki mevcut bir iÅŸaretÃ§iyi kÃ¶tÃ¼ye kullanmaktÄ±r**.

Temelde, yÄ±ÄŸÄ±n taÅŸmalarÄ± genellikle dizilerden kaynaklanÄ±r ve bellekte **diziler sonunda bir nul bayt ile biter**. Bu, yÄ±ÄŸÄ±nda zaten var olan bir iÅŸaretÃ§inin iÅŸaret ettiÄŸi yeri azaltmaya Ã§alÄ±ÅŸma olanaÄŸÄ± saÄŸlar. DolayÄ±sÄ±yla, eÄŸer yÄ±ÄŸÄ±n `0xbfffffdd` iÃ§eriyorsa, bu taÅŸma onu `0xbfffff00`'e dÃ¶nÃ¼ÅŸtÃ¼rebilir (son sÄ±fÄ±r baytÄ±na dikkat edin).

EÄŸer bu adres yÄ±ÄŸÄ±ndaki shellcode'umuza iÅŸaret ediyorsa, akÄ±ÅŸÄ±n bu adrese ulaÅŸmasÄ±nÄ± saÄŸlamak iÃ§in **`ret` komutuna adresler ekleyerek** bu adrese ulaÅŸÄ±labilir.

Bu nedenle saldÄ±rÄ± ÅŸu ÅŸekilde olacaktÄ±r:

* NOP kaydÄ±rÄ±cÄ±
* Shellcode
* YÄ±ÄŸÄ±nÄ± EIP'den **`ret` adreslerine (RET kaydÄ±rÄ±cÄ±) kadar Ã¼zerine yazÄ±n**
* YÄ±ÄŸÄ±nÄ± deÄŸiÅŸtirerek bir adresi **NOP kaydÄ±rÄ±cÄ±sÄ±na iÅŸaret edecek ÅŸekilde 0x00 ekleyin**

[**Bu baÄŸlantÄ±yÄ±**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) tÄ±klayarak savunmasÄ±z bir ikili Ã¶rneÄŸini ve [**bu baÄŸlantÄ±da**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) saldÄ±rÄ±yÄ± gÃ¶rebilirsiniz.

## Ret2pop

EÄŸer **deÄŸiÅŸtirmek istemediÄŸiniz yÄ±ÄŸÄ±ndaki mÃ¼kemmel bir iÅŸaretÃ§i bulabilirseniz** (`ret2ret`te en dÃ¼ÅŸÃ¼k baytÄ± `0x00` ile deÄŸiÅŸtirdik), aynÄ± `ret2ret` saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirebilirsiniz, ancak **RET kaydÄ±rÄ±cÄ±nÄ±n uzunluÄŸu 1 azaltÄ±lmalÄ±dÄ±r** (bÃ¶ylece son `0x00` veriye iÅŸaret eden mÃ¼kemmel iÅŸaretÃ§iden Ã¶nceki veriyi Ã¼zerine yazar), ve **RET kaydÄ±rÄ±cÄ±nÄ±n son** adresi **`pop <reg>; ret`'ye iÅŸaret etmelidir**.\
Bu ÅŸekilde, **mÃ¼kemmel iÅŸaretÃ§iden Ã¶nceki veri** yÄ±ÄŸÄ±ndan kaldÄ±rÄ±lacaktÄ±r (bu, `0x00` tarafÄ±ndan etkilenen veridir) ve **son `ret` mÃ¼kemmel adrese iÅŸaret edecektir** ve yÄ±ÄŸÄ±nda herhangi bir deÄŸiÅŸiklik olmadan.

[**Bu baÄŸlantÄ±yÄ±**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) tÄ±klayarak savunmasÄ±z bir ikili Ã¶rneÄŸini ve [**bu baÄŸlantÄ±da**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c) saldÄ±rÄ±yÄ± gÃ¶rebilirsiniz.

## Referanslar

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶nderin.

</details>
