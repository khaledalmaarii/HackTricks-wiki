# Ret2ret & Ret2pop

{% hint style="success" %}
AWS Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}

## Ret2ret

Bu teknikteki ana **amaÃ§**, **mevcut bir iÅŸaretÃ§iyi kÃ¶tÃ¼ye kullanarak ASLR'yi atlamaya Ã§alÄ±ÅŸmaktÄ±r**.

Temelde, yÄ±ÄŸÄ±n taÅŸmalarÄ± genellikle dizilerden kaynaklanÄ±r ve **diziler bellekte sonunda bir nul bayt ile biter**. Bu, yÄ±ÄŸÄ±nda zaten mevcut olan bir iÅŸaretÃ§inin gÃ¶sterdiÄŸi yeri azaltmaya Ã§alÄ±ÅŸma olanaÄŸÄ± saÄŸlar. DolayÄ±sÄ±yla, eÄŸer yÄ±ÄŸÄ±n `0xbfffffdd` iÃ§eriyorsa, bu taÅŸma onu `0xbfffff00`'e dÃ¶nÃ¼ÅŸtÃ¼rebilir (son sÄ±fÄ±r baytÄ±na dikkat edin).

EÄŸer o adres yÄ±ÄŸÄ±nda shellcode'umuza iÅŸaret ediyorsa, akÄ±ÅŸÄ±n o adrese ulaÅŸmasÄ±nÄ± saÄŸlamak iÃ§in **`ret` komutuna adresler ekleyerek** bu adrese ulaÅŸÄ±labilir.

Bu nedenle saldÄ±rÄ± ÅŸu ÅŸekilde olacaktÄ±r:

* NOP kaydÄ±rÄ±cÄ±sÄ±
* Shellcode
* YÄ±ÄŸÄ±nÄ± EIP'den **`ret` adreslerine kadar Ã¼zerine yazÄ±n** (RET kaydÄ±rÄ±cÄ±sÄ±)
* YÄ±ÄŸÄ±nÄ± deÄŸiÅŸtirerek bir adresi **0x00** ile ekleyerek (yÄ±ÄŸÄ±nÄ±ndaki bir adresi NOP kaydÄ±rÄ±cÄ±sÄ±na iÅŸaret edecek ÅŸekilde deÄŸiÅŸtirerek)

[**Bu baÄŸlantÄ±yÄ± takip ederek**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) savunmasÄ±z bir ikili Ã¶rneÄŸini ve [**bu baÄŸlantÄ±daki**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) saldÄ±rÄ±yÄ± gÃ¶rebilirsiniz.

## Ret2pop

EÄŸer **deÄŸiÅŸtirmek istemediÄŸiniz yÄ±ÄŸÄ±nda mÃ¼kemmel bir iÅŸaretÃ§i bulabilirseniz** (`ret2ret`te en dÃ¼ÅŸÃ¼k baytÄ± `0x00` ile deÄŸiÅŸtirdik), aynÄ± `ret2ret` saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirebilirsiniz, ancak **RET kaydÄ±rÄ±cÄ±sÄ±nÄ±n uzunluÄŸu 1 azaltÄ±lmalÄ±dÄ±r** (bÃ¶ylece son `0x00` mÃ¼kemmel iÅŸaretÃ§iden Ã¶nceki veriyi Ã¼zerine yazar), ve **RET kaydÄ±rÄ±cÄ±sÄ±nÄ±n son** adresi **`pop <reg>; ret`'ye iÅŸaret etmelidir**.\
Bu ÅŸekilde, **mÃ¼kemmel iÅŸaretÃ§iden Ã¶nceki veri** yÄ±ÄŸÄ±ndan kaldÄ±rÄ±lacaktÄ±r (bu, `0x00` tarafÄ±ndan etkilenen veridir) ve **son `ret` mÃ¼kemmel adrese iÅŸaret edecektir** ve yÄ±ÄŸÄ±nda herhangi bir deÄŸiÅŸiklik olmadan.

[**Bu baÄŸlantÄ±yÄ± takip ederek**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) savunmasÄ±z bir ikili Ã¶rneÄŸini ve [**bu baÄŸlantÄ±daki**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c) saldÄ±rÄ±yÄ± gÃ¶rebilirsiniz.

## Referanslar

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

{% hint style="success" %}
AWS Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}
