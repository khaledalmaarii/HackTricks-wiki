# CET & Shadow Stack

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Control Flow Enforcement Technology (CET)

**CET** je bezbednosna funkcija implementirana na nivou hardvera, dizajnirana da spre캜i uobi캜ajene napade na kontrolu toka kao 코to su **Return-Oriented Programming (ROP)** i **Jump-Oriented Programming (JOP)**. Ovi tipovi napada manipuli코u izvr코nim tokom programa kako bi izvr코ili zlonamerni kod ili povezali delove benignog koda na na캜in koji izvr코ava zlonamernu radnju.

CET uvodi dve glavne funkcije: **Indirect Branch Tracking (IBT)** i **Shadow Stack**.

* **IBT** osigurava da se indirektni skokovi i pozivi vr코e ka validnim metama, koje su eksplicitno ozna캜ene kao legalne destinacije za indirektne grane. Ovo se posti쬰 kori코캖enjem novog skupa instrukcija koji ozna캜ava validne mete, 캜ime se spre캜ava napada캜e da preusmere kontrolu toka ka proizvoljnim lokacijama.
* **Shadow Stack** je mehanizam koji pru쬬 integritet za povratne adrese. 캛uva bezbednu, skrivenu kopiju povratnih adresa odvojeno od redovnog steka poziva. Kada funkcija vrati vrednost, povratna adresa se validira protiv shadow steka, spre캜avaju캖i napada캜e da prepisuju povratne adrese na steku kako bi preuzeli kontrolu toka.

## Shadow Stack

**Shadow stack** je **poseban stek koji se koristi isklju캜ivo za 캜uvanje povratnih adresa**. Radi zajedno sa redovnim stekom, ali je za코ti캖en i skriven od normalnog izvr코avanja programa, 캜ime se ote쬬va napada캜ima da manipuli코u njime. Osnovni cilj shadow steka je da se osigura da se bilo kakve modifikacije povratnih adresa na konvencionalnom steku detektuju pre nego 코to mogu biti kori코캖ene, efikasno umanjuju캖i ROP napade.

## Kako CET i Shadow Stack Spre캜avaju Napade

**ROP i JOP napadi** se oslanjaju na sposobnost preuzimanja kontrole toka aplikacije iskori코캖avanjem ranjivosti koje im omogu캖avaju da prepisuju pokaziva캜e ili povratne adrese na steku. Usmeravanjem toka ka sekvencama postoje캖ih koda ili koda orijentisanog na povratne adrese, napada캜i mogu izvr코iti proizvoljni kod.

* Funkcija **IBT CET-a** zna캜ajno ote쬬va ove napade osiguravaju캖i da indirektni skokovi mogu skakati samo na adrese koje su eksplicitno ozna캜ene kao validne mete. Ovo 캜ini nemogu캖im za napada캜e da izvr코e proizvoljne ged쬰te raspore캠ene 코irom binarnog koda.
* Sa druge strane, **shadow stek** osigurava da 캜ak i ako napada캜 mo쬰 da prepisuje povratnu adresu na normalnom steku, **diskrepancija 캖e biti detektovana** prilikom pore캠enja korumpirane adrese sa sigurnom kopijom sme코tenom u shadow steku prilikom povratka iz funkcije. Ako se adrese ne poklapaju, program mo쬰 da se zaustavi ili preduzme druge sigurnosne mere, spre캜avaju캖i napad da uspe. 

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
