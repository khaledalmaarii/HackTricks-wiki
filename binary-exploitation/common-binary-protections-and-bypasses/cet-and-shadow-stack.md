# CET & Shadow Stack

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** ğŸ’¬ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Beheer Vloei Handhawingstegnologie (CET)

**CET** is 'n sekuriteitskenmerk wat op hardewarevlak geÃ¯mplementeer is, ontwerp om algemene beheer-vloei-hyjacking-aanvalle soos **Return-Oriented Programming (ROP)** en **Jump-Oriented Programming (JOP)** te dwarsboom. Hierdie tipes aanvalle manipuleer die uitvoervloei van 'n program om skadelike kode uit te voer of om stukke benigne kode aan mekaar te koppel op 'n manier wat 'n skadelike aksie uitvoer.

CET stel twee hoofkenmerke bekend: **Indirect Branch Tracking (IBT)** en **Shadow Stack**.

* **IBT** verseker dat indirekte spronge en oproepe na geldige teikens gemaak word, wat uitdruklik gemerk is as wettige bestemmings vir indirekte takke. Dit word bereik deur die gebruik van 'n nuwe instruksiestel wat geldige teikens merk, wat aanvalle voorkom deur die beheervloei na willekeurige plekke te verhoed.
* **Shadow Stack** is 'n meganisme wat integriteit vir terugkeeradressse bied. Dit hou 'n beveiligde, verborge kopie van terugkeeradressse apart van die gewone oproepstapel. Wanneer 'n funksie terugkeer, word die terugkeeradres gevalideer teen die skadustapel, wat aanvalle voorkom deur terugkeeradressse op die stapel te oorskryf om die beheervloei te kap.

## Shadow Stack

Die **shadow stack** is 'n **toegewyde stapel wat uitsluitlik gebruik word vir die stoor van terugkeeradressse**. Dit werk saam met die gewone stapel maar is beskerm en weggesteek van normale programuitvoering, wat dit moeilik maak vir aanvallers om daarmee te knoei. Die primÃªre doel van die shadow stack is om te verseker dat enige wysigings aan terugkeeradressse op die konvensionele stapel opgespoor word voordat hulle gebruik kan word, wat ROP-aanvalle effektief verminder.

## Hoe CET en Shadow Stack Aanvalle Voorkom

**ROP- en JOP-aanvalle** steun op die vermoÃ« om die beheervloei van 'n aansoek te kap met behulp van kwesbaarhede wat hulle toelaat om wysers of terugkeeradressse op die stapel te oorskryf. Deur die vloei te rig na bestaande kodesnippets of terugkeer-georiÃ«nteerde programmeringsnippels, kan aanvallers arbitrÃªre kode uitvoer.

* **CET se IBT**-kenmerk maak hierdie aanvalle aansienlik moeiliker deur te verseker dat indirekte takke slegs na adresse kan spring wat uitdruklik gemerk is as geldige teikens. Dit maak dit onmoontlik vir aanvallers om arbitrÃªre snippels versprei oor die binÃªre uit te voer.
* Die **shadow stack** verseker daarenteen dat selfs as 'n aanvaller 'n terugkeeradres op die normale stapel kan oorskryf, die diskrepansie opgespoor sal word wanneer die gekorrigeerde adres vergelyk word met die veilige kopie wat in die shadow stack gestoor word wanneer 'n funksie terugkeer. As die adresse nie ooreenstem nie, kan die program beÃ«indig word of ander sekuriteitsmaatreÃ«ls neem om te voorkom dat die aanval slaag.
