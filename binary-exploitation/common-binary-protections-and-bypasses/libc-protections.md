# Libc λ³΄νΈ κΈ°λ¥

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>μ—μ„ **μ λ΅λ¶€ν„° μμ›…κΉμ§€ AWS ν•΄ν‚Ή λ°°μ°κΈ°**!</summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•κ³  μ‹¶λ‹¤λ©΄ [**κµ¬λ… μ”κΈμ **](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ™κ·Έ**](https://peass.creator-spring.com)λ¥Ό κµ¬μ…ν•μ„Έμ”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”, λ‹Ήμ‚¬μ λ…μ  [**NFTs**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…
* **π’¬ [Discord κ·Έλ£Ή](https://discord.gg/hRep4RUj7f)** λλ” [ν…”λ κ·Έλ¨ κ·Έλ£Ή](https://t.me/peass)μ— **κ°€μ…**ν•κ±°λ‚ **νΈμ„ν„°** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**λ¥Ό ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks** λ° **HackTricks Cloud** κΉƒν—λΈ μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ **ν•μ„Έμ”.

</details>

## μ²­ν¬ μ •λ ¬ κ°•μ 

**Malloc**μ€ λ©”λ¨λ¦¬λ¥Ό **8λ°”μ΄νΈ(32λΉ„νΈ) λλ” 16λ°”μ΄νΈ(64λΉ„νΈ) κ·Έλ£Ή**μΌλ΅ ν• λ‹Ήν•©λ‹λ‹¤. μ΄λ” 32λΉ„νΈ μ‹μ¤ν…μ—μ„ μ²­ν¬μ λμ΄ **0x8**μ— λ§μ¶°μ§€κ³ , 64λΉ„νΈ μ‹μ¤ν…μ—μ„λ” **0x0**μ— λ§μ¶°μ Έμ•Ό ν•¨μ„ μλ―Έν•©λ‹λ‹¤. μ΄ λ³΄μ• κΈ°λ¥μ€ κ° μ²­ν¬κ°€ νΉμ • μ„μΉμ—μ„ μ¬λ°”λ¥΄κ² **μ •λ ¬**λμ–΄ μλ”μ§€ ν™•μΈν•κ³  λ‚μ„ ν•΄λ‹Ή μ„μΉμ—μ„ ν¬μΈν„°λ¥Ό μ‚¬μ©ν•κΈ° μ „μ— μ²΄ν¬ν•©λ‹λ‹¤.

### λ³΄μ• μ΄μ 

64λΉ„νΈ μ‹μ¤ν…μ—μ„ μ²­ν¬ μ •λ ¬μ„ κ°•μ ν•¨μΌλ΅μ¨ Mallocμ λ³΄μ•μ΄ ν¬κ² ν–¥μƒλ©λ‹λ‹¤. μ΄λ” κ°€μ§ μ²­ν¬λ¥Ό λ°°μΉν•  μ μλ” μ„μΉκ°€ **16κ° μ¤‘ 1κ°λ΅ μ ν•**λκΈ° λ•λ¬Έμ— κ³µκ²©μ„ λ³µμ΅ν•κ³  μ„±κ³µμ μΌλ΅ μ‹¤ν–‰ν•κΈ° μ–΄λ µκ² λ§λ“­λ‹λ‹¤. νΉν μ‚¬μ©μκ°€ μ…λ ¥ κ°’μ„ μ μ–΄ν•  μ μλ” μƒν™©μ—μ„ κ³µκ²©μ„ λ” λ³µμ΅ν•κ³  μ„±κ³µν•κΈ° μ–΄λ µκ² λ§λ“­λ‹λ‹¤.

* **\_\_malloc\_hookμ— λ€ν• Fastbin κ³µκ²©**

Mallocμ μƒλ΅μ΄ μ •λ ¬ κ·μΉ™μ€ `__malloc_hook`μ„ μ΄μ©ν• κ³ μ „μ μΈ κ³µκ²©μ„ λ°©μ§€ν•©λ‹λ‹¤. μ΄μ „μ— κ³µκ²©μλ” μ²­ν¬ ν¬κΈ°λ¥Ό μ΅°μ‘ν•μ—¬ **μ΄ ν•¨μ ν¬μΈν„°λ¥Ό λ®μ–΄μ“°κ³ ** **μ½”λ“ μ‹¤ν–‰**μ„ μ–»μ„ μ μμ—μµλ‹λ‹¤. μ΄μ  μ—„κ²©ν• μ •λ ¬ μ”κµ¬ μ‚¬ν•­μΌλ΅ μΈν•΄ μ΄λ¬ν• μ΅°μ‘μ΄ λ” μ΄μƒ μ ν¨ν•μ§€ μ•μ•„μ Έμ„ μΌλ°μ μΈ κ³µκ²© κ²½λ΅λ¥Ό μ°¨λ‹¨ν•κ³  μ „λ°μ μΈ λ³΄μ•μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.

## fastbins λ° tcacheμ—μ„μ ν¬μΈν„° Mangling

**ν¬μΈν„° Mangling**μ€ λ©”λ¨λ¦¬ κ΄€λ¦¬ μ‘μ—…μ—μ„ **fastbin λ° tcache Fd ν¬μΈν„°**λ¥Ό λ³΄νΈν•λ” λ³΄μ• κ°•ν™” κΈ°λ¥μ…λ‹λ‹¤. μ΄ κΈ°μ μ€ λ©”λ¨λ¦¬ μ •λ³΄ λ„μ¶μ΄ ν•„μ” μ—†κ±°λ‚ μ•λ ¤μ§„ μ„μΉμ— μ§μ ‘μ μΌλ΅ λ©”λ¨λ¦¬ μ„μΉλ¥Ό μ΅°μ‘ν•λ” μΌλ¶€ λ©”λ¨λ¦¬ μ•…μ© μ „μ μ„ λ°©μ§€ν•λ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤.

μ΄ κΈ°μ μ ν•µμ‹¬μ€ λ‚λ…ν™” κ³µμ‹μ…λ‹λ‹¤:

**`New_Ptr = (L >> 12) XOR P`**

* **L**μ€ ν¬μΈν„°μ **μ €μ¥ μ„μΉ**μ…λ‹λ‹¤.
* **P**λ” μ‹¤μ  **fastbin/tcache Fd ν¬μΈν„°**μ…λ‹λ‹¤.

μ €μ¥ μ„μΉ(L)λ¥Ό XOR μ—°μ‚° μ „μ— μ¤λ¥Έμ½μΌλ΅ 12λΉ„νΈ μ΄λ™μ‹ν‚¤λ” μ΄μ λ” μ¤‘μ”ν•©λ‹λ‹¤. μ΄ μ΅°μ‘μ€ μΌλ°μ μΌλ΅ μ‹μ¤ν… μ•„ν‚¤ν…μ² μ μ•½μΌλ΅ μΈν•΄ μμΈ΅ κ°€λ¥ν• λ©”λ¨λ¦¬ μ£Όμ†μ κ°€μ¥ λ‚®μ€ 12λΉ„νΈμ— λ‚΄μ¬λ μ·¨μ•½μ„±μ„ ν•΄κ²°ν•©λ‹λ‹¤. λΉ„νΈλ¥Ό μ΄λ™ν•¨μΌλ΅μ¨ μμΈ΅ κ°€λ¥ν• λ¶€λ¶„μ„ μ κ±°ν•μ—¬ μƒλ΅μ΄, λ‚λ…ν™”λ ν¬μΈν„°μ λ¬΄μ‘μ„μ„±μ„ ν–¥μƒμ‹ν‚¤κ³  μ΄λ¬ν• λΉ„νΈμ μμΈ΅ κ°€λ¥μ„±μ— μμ΅΄ν•λ” μ•…μ©μ— λ€λΉ„ν•©λ‹λ‹¤.

μ΄ λ‚λ…ν™”λ ν¬μΈν„°λ” ν”„λ΅κ·Έλ¨μ΄ μ‚¬μ©ν•λ” μ£Όμ†λ¥Ό λ¬΄μ‘μ„λ΅ λ°”κΎΈλ” **μ£Όμ† κ³µκ°„ λ μ΄μ•„μ›ƒ λ¬΄μ‘μ„ν™” (ASLR)**μ—μ„ μ κ³µλλ” κΈ°μ΅΄μ λ¬΄μ‘μ„μ„±μ„ ν™μ©ν•©λ‹λ‹¤. μ΄λ” κ³µκ²©μκ°€ ν”„λ΅μ„Έμ¤μ λ©”λ¨λ¦¬ λ μ΄μ•„μ›ƒμ„ μμΈ΅ν•κΈ° μ–΄λ µκ² λ§λ“¤κΈ° μ„ν•΄ ν”„λ΅κ·Έλ¨μ΄ μ‚¬μ©ν•λ” μ£Όμ†λ¥Ό λ¬΄μ‘μ„λ΅ λ°”κΎΈλ” κΈ°μ μ…λ‹λ‹¤.

**λ‚λ…ν™”λ ν¬μΈν„°λ¥Ό ν•΄μ ν•μ—¬ μ›λ μ£Όμ†λ¥Ό κ²€μƒ‰ν•λ” κ²ƒμ€** λ™μΌν• XOR μ—°μ‚°μ„ μ‚¬μ©ν•μ—¬ μν–‰λ©λ‹λ‹¤. μ—¬κΈ°μ„ λ‚λ…ν™”λ ν¬μΈν„°λ” κ³µμ‹μ—μ„ Pλ΅ μ·¨κΈ‰λλ©° λ³€κ²½λμ§€ μ•μ€ μ €μ¥ μ„μΉ(L)μ™€ XOR μ—°μ‚°μ„ μν–‰ν•λ©΄ μ›λ ν¬μΈν„°κ°€ κ³µκ°λ©λ‹λ‹¤. μ΄ λ‚λ…ν™” λ° ν•΄λ…μ λ€μΉ­μ„±μ€ μ‹μ¤ν…μ΄ λ©”λ¨λ¦¬ ν¬μΈν„°λ¥Ό ν¨μ¨μ μΌλ΅ μΈμ½”λ”©ν•κ³  λ””μ½”λ”©ν•  μ μλ„λ΅ ν•λ©΄μ„ λ©”λ¨λ¦¬ ν¬μΈν„°λ¥Ό μ΅°μ‘ν•λ” κ³µκ²©μ— λ€ν• λ³΄μ•μ„ ν¬κ² ν–¥μƒμ‹ν‚µλ‹λ‹¤.

### λ³΄μ• μ΄μ 

ν¬μΈν„° λ‚λ…ν™”λ” ν™ κ΄€λ¦¬μ—μ„μ **λ¶€λ¶„ λ° μ „μ²΄ ν¬μΈν„° λ®μ–΄μ“°κΈ°λ¥Ό λ°©μ§€**ν•κ³  λ³΄μ•μ„ ν¬κ² ν–¥μƒμ‹ν‚µλ‹λ‹¤. μ΄ κΈ°λ¥μ€ μ—¬λ¬ κ°€μ§€ λ°©λ²•μΌλ΅ μ•…μ© κΈ°μ μ— μν–¥μ„ λ―ΈμΉ©λ‹λ‹¤:

1. **λ°”μ΄νΈ λ°”μ΄νΈ μƒλ€μ  λ®μ–΄μ“°κΈ° λ°©μ§€**: μ΄μ „μ— κ³µκ²©μλ” μ •ν™•ν• μ£Όμ†λ¥Ό μ•μ§€ λ»ν•΄λ„ **ν™ μ²­ν¬λ¥Ό λ‹¤λ¥Έ μ„μΉλ΅ λ¦¬λ””λ ‰μ…**ν•  μ μλ” μΌλ¶€ ν¬μΈν„°μ μΌλ¶€λ¥Ό λ³€κ²½ν•  μ μμ—μµλ‹λ‹¤. μ΄λ¬ν• μƒλ€μ  λ®μ–΄μ“°κΈ°λ” λ” μ΄μƒ ν™ λ„μ¶ μ—†μ΄λ” **λΈλ£¨νΈ ν¬μ‹±μ΄ ν•„μ”**ν•λ©°, μ΄λ” μ„±κ³µ κ°€λ¥μ„±μ„ ν¬κ² μ¤„μ…λ‹λ‹¤.
2. **Tcache Bin/Fastbin κ³µκ²©μ μ–΄λ ¤μ›€ μ¦κ°€**: fastbin λλ” tcache ν•­λ©μ„ μ΅°μ‘ν•μ—¬ ν•¨μ ν¬μΈν„°(μ: `__malloc_hook`)λ¥Ό λ®μ–΄μ“°λ” μΌλ°μ μΈ κ³µκ²©μ΄ λ°©ν•΄λ©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, κ³µκ²©μ€ LibC μ£Όμ†λ¥Ό λ„μ¶ν•κ³  tcache binμ— μ²­ν¬λ¥Ό ν•΄μ ν• λ‹¤μ Fd ν¬μΈν„°λ¥Ό `__malloc_hook`λ΅ λ¦¬λ””λ ‰μ…ν•μ—¬ μ„μμ μ½”λ“ μ‹¤ν–‰μ„ μν–‰ν•  μ μμµλ‹λ‹¤. ν¬μΈν„° λ‚λ…ν™”λ΅ μΈν•΄ μ΄λ¬ν• ν¬μΈν„°λ” μ¬λ°”λ¥΄κ² λ‚λ…ν™”λμ–΄μ•Ό ν•λ―€λ΅ **μ •ν™•ν• μ΅°μ‘μ„ μ„ν•΄ ν™ λ„μ¶μ΄ ν•„μ”**ν•λ©°, μ΄λ΅μ¨ μ•…μ© μ¥λ²½μ΄ λ†’μ•„μ§‘λ‹λ‹¤.
3. **λΉ„ν™ μ„μΉμ—μ„μ ν™ λ„μ¶ μ”κµ¬**: λΉ„ν™ μμ—­(μ¤νƒ, .bss μ„Ήμ… λλ” PLT/GOT)μ— κ°€μ§ μ²­ν¬λ¥Ό λ§λ“λ” κ²ƒμ€ μ΄μ  ν¬μΈν„° λ‚λ…ν™”κ°€ ν•„μ”ν•κΈ° λ•λ¬Έμ— μ΄μ  **ν™ λ„μ¶μ΄ ν•„μ”**ν•©λ‹λ‹¤. μ΄λ” LibC μ£Όμ†λ¥Ό μ΅°μ‘ν•λ” κ²ƒκ³Ό μ μ‚¬ν•κ² μ΄λ¬ν• μμ—­μ„ μ•…μ©ν•λ” λ³µμ΅μ„±μ„ μ¦κ°€μ‹ν‚µλ‹λ‹¤.
4. **ν™ μ£Όμ† λ„μ¶μ΄ λ” μ–΄λ ¤μ›μ§**: ν¬μΈν„° λ‚λ…ν™”λ” fastbin λ° tcache binμ Fd ν¬μΈν„°λ¥Ό ν™ μ£Όμ† λ„μ¶ μ†μ¤λ΅ μ‚¬μ©ν•λ” μ μ©μ„±μ„ μ ν•ν•©λ‹λ‹¤. κ·Έλ¬λ‚ μ •λ ¬λμ§€ μ•μ€, μ‘μ€ λ° ν° binμ ν¬μΈν„°λ” μ—¬μ „ν λ‚λ…ν™”λμ§€ μ•μ•μΌλ―€λ΅ μ£Όμ† λ„μ¶μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤. μ΄ λ³€ν™”λ΅ μΈν•΄ κ³µκ²©μλ” μ΄λ¬ν• binμ„ νƒμƒ‰ν•μ—¬ μ•…μ© κ°€λ¥ν• μ •λ³΄λ¥Ό μ°Ύμ•„μ•Ό ν•μ§€λ§ μΌλ¶€ κΈ°μ μ€ μ—¬μ „ν λ„μ¶ μ „μ— ν¬μΈν„°λ¥Ό ν•΄λ…ν•  μ μμ„ μ μμ§€λ§ μ μ•½μ΄ λ”°λ¦…λ‹λ‹¤.

### **ν™ λ„μ¶λ΅ ν¬μΈν„° ν•΄λ…**

{% hint style="danger" %}
ν”„λ΅μ„Έμ¤μ— λ€ν• μμ„Έν• μ„¤λ…μ„ λ³΄λ ¤λ©΄ [**μ—¬κΈ°μ—μ„ μ›λ³Έ κ²μ‹λ¬Όμ„ ν™•μΈ**](https://maxwelldulin.com/BlogPost?post=5445977088)ν•μ„Έμ”.
{% endhint %}

### μ•κ³ λ¦¬μ¦ κ°μ”

ν¬μΈν„°λ¥Ό λ‚λ…ν™”ν•κ³  ν•΄λ…ν•λ” λ° μ‚¬μ©λλ” κ³µμ‹μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:&#x20;

**`New_Ptr = (L >> 12) XOR P`**

μ—¬κΈ°μ„ **L**μ€ μ €μ¥ μ„μΉμ΄κ³  **P**λ” Fd ν¬μΈν„°μ…λ‹λ‹¤. **L**μ„ μ¤λ¥Έμ½μΌλ΅ 12λΉ„νΈ μ΄λ™ν•μ—¬ XOR μ—°μ‚°μ„ μν–‰ν•λ©΄ **P**μ κ°€μ¥ μƒμ„ 12λΉ„νΈλ¥Ό νλ“ν•κ² λ©λ‹λ‹¤. μ΄λ” **XOR**μ νΉμ„± λ•λ¬Έμ— λΉ„νΈκ°€ μμ‹ κ³Ό XORλλ©΄ 0μ΄ μ¶λ ¥λκΈ° λ•λ¬Έμ…λ‹λ‹¤.

**μ•κ³ λ¦¬μ¦μ μ£Όμ” λ‹¨κ³„:**

1. **κ°€μ¥ μƒμ„ λΉ„νΈμ μ΄κΈ° λ„μ¶**: μ΄λ™λ **L**μ„ **P**μ™€ XORν•μ—¬ **P**μ μƒμ„ 12λΉ„νΈλ¥Ό νλ“ν•©λ‹λ‹¤. μ΄λ™λ **L**μ λ¶€λ¶„μ€ 0μ΄ λλ―€λ΅ **P**μ ν•΄λ‹Ή λΉ„νΈλ” λ³€κ²½λμ§€ μ•μµλ‹λ‹¤.
2. **ν¬μΈν„° λΉ„νΈ λ³µκµ¬**: XORκ°€ μ—­μΌλ΅ κ°€λ¥ν•λ―€λ΅ κ²°κ³Όμ™€ ν•λ‚μ ν”Όμ—°μ‚°μλ¥Ό μ•λ©΄ λ‹¤λ¥Έ ν”Όμ—°μ‚°μλ¥Ό κ³„μ‚°ν•  μ μμµλ‹λ‹¤. μ΄ μ†μ„±μ€ μ•λ ¤μ§„ λΉ„νΈ μ„ΈνΈλ¥Ό μ•κ³  μλ” μƒνƒμ—μ„ λ‚λ…ν™”λ ν¬μΈν„°μ μΌλ¶€μ™€ μ—°μ†μ μΌλ΅ XORν•μ—¬ **P**μ μ „μ²΄ λΉ„νΈ μ„ΈνΈλ¥Ό μ¶”λ΅ ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
3. **λ°λ³µμ μΈ ν•΄λ…**: μ΄ κ³Όμ •μ€ μ΄μ „ λ‹¨κ³„μ—μ„ λ°κ²¬λ **P**μ λΉ„νΈλ¥Ό μ‚¬μ©ν•μ—¬ λ‚λ…ν™”λ ν¬μΈν„°μ λ‹¤μ μ„Έκ·Έλ¨ΌνΈλ¥Ό ν•΄λ…ν•λ” λ° λ°λ³µλ©λ‹λ‹¤. λ¨λ“  λΉ„νΈκ°€ λ³µκµ¬λ  λ•κΉμ§€ μ΄ κ³Όμ •μ„ λ°λ³µν•©λ‹λ‹¤.
4. **κ²°μ •λ΅ μ  λΉ„νΈ μ²λ¦¬**: μ΄λ™μΌλ΅ μΈν•΄ **L**μ λ§μ§€λ§‰ 12λΉ„νΈλ” μ†μ‹¤λμ§€λ§ κ²°μ •λ΅ μ μ΄λ©° ν›„μ²λ¦¬λ΅ λ³µμ›ν•  μ μμµλ‹λ‹¤.

μ΄ μ•κ³ λ¦¬μ¦μ κµ¬ν„μ€ μ—¬κΈ°μ—μ„ μ°Ύμ„ μ μμµλ‹λ‹¤: [https://github.com/mdulin2/mangle](https://github.com/mdulin2/mangle)
## ν¬μΈν„° κ°€λ“

ν¬μΈν„° κ°€λ“λ” glibcμ—μ„ μ‚¬μ©λλ” μµμ¤ν”λ΅μ‡ λ°©μ§€ κΈ°μ λ΅, νΉν `atexit()`μ™€ κ°™μ€ λΌμ΄λΈλ¬λ¦¬ νΈμ¶μ— μν•΄ λ“±λ΅λ ν•¨μ ν¬μΈν„°λ¥Ό λ³΄νΈν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤. μ΄ λ³΄νΈλ” ν¬μΈν„°λ¥Ό μ¤λ λ“ λ°μ΄ν„°(`fs:0x30`)μ— μ €μ¥λ λΉ„λ°€κ³Ό XOR μ—°μ‚° λ° λΉ„νΈ νμ „μ„ μ μ©ν•μ—¬ ν¬μΈν„°λ¥Ό μ„λ” κ²ƒμ„ ν¬ν•¨ν•©λ‹λ‹¤. μ΄ λ©”μ»¤λ‹μ¦μ€ ν•¨μ ν¬μΈν„°λ¥Ό λ®μ–΄μ“°λ” κ³µκ²©μλ΅λ¶€ν„° μ μ–΄ νλ¦„μ„ νƒμ·¨ν•λ” κ²ƒμ„ λ°©μ§€ν•κΈ° μ„ν• κ²ƒμ…λ‹λ‹¤.

### **λ¦¬ν¬λ¥Ό μ‚¬μ©ν• ν¬μΈν„° κ°€λ“ μ°ν**

1. **ν¬μΈν„° κ°€λ“ μ‘μ—… μ΄ν•΄:** ν¬μΈν„°μ μ„κΈ° μ‘μ—…μ€ `PTR_MANGLE` λ§¤ν¬λ΅λ¥Ό μ‚¬μ©ν•μ—¬ μν–‰λλ©°, μ΄ λ§¤ν¬λ΅λ” ν¬μΈν„°λ¥Ό 64λΉ„νΈ λΉ„λ°€λ΅ XOR μ—°μ‚°ν• λ‹¤μ 0x11 λΉ„νΈλ¥Ό μ™Όμ½μΌλ΅ νμ „μ‹ν‚µλ‹λ‹¤. μ›λ ν¬μΈν„°λ¥Ό λ³µκµ¬ν•κΈ° μ„ν• μ—­ μ—°μ‚°μ€ `PTR_DEMANGLE`μ—μ„ μ²λ¦¬λ©λ‹λ‹¤.
2. **κ³µκ²© μ „λµ:** μ΄ κ³µκ²©μ€ μ•λ ¤μ§„ ν‰λ¬Έ μ ‘κ·Ό λ°©μ‹μ— κΈ°λ°ν•λ©°, κ³µκ²©μλ” μ„μΈ ν¬μΈν„°μ μ›λ³Έκ³Ό μ„μΈ λ²„μ „μ„ μ•μ•„μ•Όλ§ μ„λ” λ° μ‚¬μ©λ λΉ„λ°€μ„ μ¶”λ΅ ν•  μ μμµλ‹λ‹¤.
3. **μ•λ ¤μ§„ ν‰λ¬Έ ν™μ©:**
* **κ³ μ • ν•¨μ ν¬μΈν„° μ‹λ³„:** glibc μ†μ¤ μ½”λ“λ¥Ό μ΅°μ‚¬ν•κ±°λ‚ `__libc_pthread_functions`μ™€ κ°™μ€ μ΄κΈ°ν™”λ ν•¨μ ν¬μΈν„° ν…μ΄λΈ”μ„ μ‚΄ν΄λ΄„μΌλ΅μ¨ κ³µκ²©μλ” μμΈ΅ κ°€λ¥ν• ν•¨μ ν¬μΈν„°λ¥Ό μ°Ύμ„ μ μμµλ‹λ‹¤.
* **λΉ„λ°€ κ³„μ‚°:** `__pthread_attr_destroy`μ™€ κ°™μ€ μ•λ ¤μ§„ ν•¨μ ν¬μΈν„°μ™€ ν•΄λ‹Ή ν•¨μ ν¬μΈν„° ν…μ΄λΈ”μ—μ„μ μ„μΈ λ²„μ „μ„ μ‚¬μ©ν•μ—¬, μ„μΈ ν¬μΈν„°λ¥Ό μ—­ νμ „(μ¤λ¥Έμ½ νμ „)ν•κ³  κ·Έ ν¬μΈν„°μ μ£Όμ†μ™€ XOR μ—°μ‚°ν•μ—¬ λΉ„λ°€μ„ κ³„μ‚°ν•  μ μμµλ‹λ‹¤.
4. **λ€μ²΄ ν‰λ¬Έ:** κ³µκ²©μλ” μ•λ ¤μ§„ κ°’(μ: 0 λλ” -1)μΌλ΅ ν¬μΈν„°λ¥Ό μ„μ–΄μ„ λ©”λ¨λ¦¬μ—μ„ μ‹λ³„ κ°€λ¥ν• ν¨ν„΄μ„ μƒμ„±ν•λ”μ§€ ν™•μΈν•μ—¬, μ΄λ¬ν• ν¨ν„΄μ΄ λ©”λ¨λ¦¬ λ¤ν”„μ—μ„ λ°κ²¬λ  λ• λΉ„λ°€μ„ λ…Έμ¶μ‹ν‚¬ μ μμµλ‹λ‹¤.
5. **μ‹¤μ  μ μ©:** λΉ„λ°€μ„ κ³„μ‚°ν• ν›„, κ³µκ²©μλ” libc κΈ°λ³Έ μ£Όμ†λ¥Ό μ•κ³  μ„μμ λ©”λ¨λ¦¬ μ„μΉλ¥Ό μ½μ„ μ μλ” λ‹¤μ¤‘ μ¤λ λ“ μ‘μ© ν”„λ΅κ·Έλ¨μ—μ„ ν¬μΈν„°λ¥Ό μ μ–΄μ μΌλ΅ μ΅°μ‘ν•μ—¬ ν¬μΈν„° κ°€λ“ λ³΄νΈλ¥Ό μ°νν•  μ μμµλ‹λ‹¤.

## μ°Έκ³  μλ£

* [https://maxwelldulin.com/BlogPost?post=5445977088](https://maxwelldulin.com/BlogPost?post=5445977088)
* [https://blog.infosectcbr.com.au/2020/04/bypassing-pointer-guard-in-linuxs-glibc.html?m=1](https://blog.infosectcbr.com.au/2020/04/bypassing-pointer-guard-in-linuxs-glibc.html?m=1)
