# Relro

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Relro

**RELRO** oznacza **Relocation Read-Only** i jest funkcj zabezpiecze stosowan w plikach binarnych w celu zagodzenia ryzyka zwizanego z nadpisywaniem **GOT (Global Offset Table)**. Istniej dwa rodzaje ochrony **RELRO**: (1) **Partial RELRO** i (2) **Full RELRO**. Oba rodzaje reorganizuj **GOT** i **BSS** z plik贸w ELF, ale z r贸偶nymi wynikami i implikacjami. Konkretnie, umieszczaj sekcj **GOT** *przed* **BSS**. To znaczy, 偶e **GOT** znajduje si pod ni偶szymi adresami ni偶 **BSS**, co uniemo偶liwia nadpisywanie wpis贸w **GOT** przez przepenianie zmiennych w **BSS** (pamitaj, 偶e zapis do pamici odbywa si od ni偶szych do wy偶szych adres贸w).

Roz贸偶my koncepcj na dwa odrbne typy dla jasnoci.

### **Partial RELRO**

**Partial RELRO** przyjmuje prostsze podejcie do zwikszenia bezpieczestwa bez znaczcego wpywu na wydajno binari贸w. Partial RELRO sprawia, 偶e **.got jest tylko do odczytu (cz nie-PLT sekcji GOT)**. Pamitaj, 偶e reszta sekcji (jak .got.plt) jest nadal zapisywalna i, w zwizku z tym, podatna na ataki. To **nie zapobiega nadu偶ywaniu GOT** z **wra偶liwoci na dowolne zapisy**.

Uwaga: Domylnie GCC kompiluje pliki binarne z Partial RELRO.

### **Full RELRO**

**Full RELRO** zwiksza ochron, **czynic ca GOT (zar贸wno .got, jak i .got.plt) oraz sekcj .fini\_array** cakowicie **tylko do odczytu.** Gdy plik binarny si uruchamia, wszystkie adresy funkcji s rozwizywane i adowane w GOT, a nastpnie GOT jest oznaczany jako tylko do odczytu, co skutecznie zapobiega jakimkolwiek modyfikacjom w czasie wykonywania.

Jednak kompromis zwizany z Full RELRO dotyczy wydajnoci i czasu uruchamiania. Poniewa偶 musi rozwiza wszystkie dynamiczne symbole podczas uruchamiania przed oznaczeniem GOT jako tylko do odczytu, **pliki binarne z wczonym Full RELRO mog dowiadcza du偶szych czas贸w adowania**. Ten dodatkowy narzut przy uruchamianiu to pow贸d, dla kt贸rego Full RELRO nie jest domylnie wczony we wszystkich plikach binarnych.

Mo偶na sprawdzi, czy Full RELRO jest **wczony** w pliku binarnym za pomoc:
```bash
readelf -l /proc/ID_PROC/exe | grep BIND_NOW
```
## Bypass

Jeli Full RELRO jest wczony, jedynym sposobem na obejcie go jest znalezienie innej metody, kt贸ra nie wymaga zapisu w tabeli GOT, aby uzyska dowolne wykonanie.

Zauwa偶, 偶e **GOT LIBC jest zazwyczaj Partial RELRO**, wic mo偶e by modyfikowany za pomoc dowolnego zapisu. Wicej informacji w [Targetting libc GOT entries](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries)**.**

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
