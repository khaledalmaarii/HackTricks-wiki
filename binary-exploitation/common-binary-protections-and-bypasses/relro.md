# Relro

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Relro

**RELRO** significa **Relocation Read-Only**, e √© um recurso de seguran√ßa usado em bin√°rios para mitigar os riscos associados a **GOT (Global Offset Table)** sobrescritas. Existem dois tipos de prote√ß√µes **RELRO**: (1) **Partial RELRO** e (2) **Full RELRO**. Ambos reordenam a **GOT** e **BSS** de arquivos ELF, mas com resultados e implica√ß√µes diferentes. Especificamente, eles colocam a se√ß√£o **GOT** *antes* da **BSS**. Ou seja, **GOT** est√° em endere√ßos mais baixos do que **BSS**, tornando imposs√≠vel sobrescrever entradas de **GOT** ao transbordar vari√°veis na **BSS** (lembre-se de que a escrita na mem√≥ria acontece de endere√ßos mais baixos para mais altos).

Vamos dividir o conceito em seus dois tipos distintos para clareza.

### **Partial RELRO**

**Partial RELRO** adota uma abordagem mais simples para aumentar a seguran√ßa sem impactar significativamente o desempenho do bin√°rio. Partial RELRO torna **a .got somente leitura (a parte n√£o-PLT da se√ß√£o GOT)**. Tenha em mente que o restante da se√ß√£o (como a .got.plt) ainda √© grav√°vel e, portanto, sujeito a ataques. Isso **n√£o impede que a GOT** seja abusada **por vulnerabilidades de escrita arbitr√°ria**.

Nota: Por padr√£o, o GCC compila bin√°rios com Partial RELRO.

### **Full RELRO**

**Full RELRO** aumenta a prote√ß√£o ao **tornar toda a GOT (tanto .got quanto .got.plt) e a se√ß√£o .fini\_array** completamente **somente leitura.** Uma vez que o bin√°rio √© iniciado, todos os endere√ßos de fun√ß√£o s√£o resolvidos e carregados na GOT, ent√£o, a GOT √© marcada como somente leitura, efetivamente impedindo quaisquer modifica√ß√µes durante a execu√ß√£o.

No entanto, a desvantagem do Full RELRO est√° em termos de desempenho e tempo de inicializa√ß√£o. Como precisa resolver todos os s√≠mbolos din√¢micos na inicializa√ß√£o antes de marcar a GOT como somente leitura, **bin√°rios com Full RELRO habilitado podem experimentar tempos de carregamento mais longos**. Essa sobrecarga adicional na inicializa√ß√£o √© a raz√£o pela qual o Full RELRO n√£o √© habilitado por padr√£o em todos os bin√°rios.

√â poss√≠vel verificar se o Full RELRO est√° **habilitado** em um bin√°rio com:
```bash
readelf -l /proc/ID_PROC/exe | grep BIND_NOW
```
## Bypass

Se o Full RELRO estiver habilitado, a √∫nica maneira de contorn√°-lo √© encontrar outra forma que n√£o precise escrever na tabela GOT para obter execu√ß√£o arbitr√°ria.

Note que **o GOT da LIBC geralmente √© Partial RELRO**, ent√£o pode ser modificado com uma escrita arbitr√°ria. Mais informa√ß√µes em [Targetting libc GOT entries](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries)**.**

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
