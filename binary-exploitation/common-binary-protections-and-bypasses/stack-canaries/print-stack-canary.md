# Ispisivanje Stack Canary-ja

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Pove캖anje ispisivanja stack-a

Zamislite situaciju gde **program podlo쬬n** prelivanju stack-a mo쬰 izvr코iti funkciju **puts** koja **ukazuje** na **deo** prelivanja stack-a. Napada캜 zna da je **prvi bajt canary-ja nula bajt** (`\x00`) i da su ostali bajtovi canary-ja **nasumi캜ni** bajtovi. Zatim, napada캜 mo쬰 stvoriti prelivanje koje **prepisuje stack sve do samo prvog bajta canary-ja**.

Zatim, napada캜 **poziva funkcionalnost puts** na sredini payload-a koja 캖e **ispisati ceo canary** (osim prvog nula bajta).

Sa ovim informacijama, napada캜 mo쬰 **kreirati i poslati novi napad** znaju캖i canary-ja (u istoj sesiji programa).

O캜igledno, ova taktika je veoma **ograni캜ena** jer napada캜 mora biti u mogu캖nosti da **ispisuje** **sadr쬬j** svog **payload-a** da bi **izvukao** **canary** i zatim bio u mogu캖nosti da kreira novi payload (u **istoj sesiji programa**) i **po코alje** **pravi buffer overflow**.

**CTF primeri:**&#x20;

* [**https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html**](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 bit, ASLR omogu캖en ali bez PIE-a, prvi korak je popuniti prelivanje sve do bajta 0x00 canary-ja, zatim pozvati puts i procuriti ga. Sa canary-jem se kreira ROP ged쬰t koji poziva puts da procuri adresu puts-a iz GOT-a i ROP ged쬰t da pozove `system('/bin/sh')`
* [**https://guyinatuxedo.github.io/14-ret\_2\_system/hxp18\_poorCanary/index.html**](https://guyinatuxedo.github.io/14-ret\_2\_system/hxp18\_poorCanary/index.html)
* 32 bit, ARM, bez relro-a, canary, nx, bez pie-a. Prelivanje sa pozivom puts-a na njega da procuri canary + ret2lib pozivanje `system` sa ROP lancem da izbaci r0 (arg `/bin/sh`) i pc (adresa system-a)

## Proizvoljno 캛itanje

Sa proizvoljnim 캜itanjem kao 코to je ono koje pru쬬ju format **stringovi** mogu캖e je procuriti canary. Proverite ovaj primer: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) i mo쬰te pro캜itati o zloupotrebi format stringova za 캜itanje proizvoljnih memorijskih adresa u:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* Ovaj izazov zloupotrebljava na veoma jednostavan na캜in format string da pro캜ita canary sa stack-a

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
