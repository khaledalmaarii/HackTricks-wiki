# Bins & Î•ÎºÏ‡Ï‰ÏÎ®ÏƒÎµÎ¹Ï‚ ÎœÎ½Î®Î¼Î·Ï‚

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ Ï„Î·Î½ [**ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± Ï„Î·Î»ÎµÎ³ÏÎ±Ï†Î®Î¼Î±Ï„Î¿Ï‚**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

Î“Î¹Î± Î½Î± Î²ÎµÎ»Ï„Î¹ÏÏƒÎµÏ„Îµ Ï„Î·Î½ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± ÏƒÏ„Î¿Î½ Ï„ÏÏŒÏ€Î¿ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ Ï„Ï‰Î½ Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½, ÎºÎ¬Î¸Îµ Ï„Î¼Î®Î¼Î± Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ ÏƒÎµ Î¼Î¹Î± ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±, Î±Î»Î»Î¬ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î¬Ï†Î¿ÏÎ¿Î¹ Ï„ÏÏ€Î¿Î¹. Î‘Ï…Ï„Î¿Î¯ ÎµÎ¯Î½Î±Î¹ Î¿Î¹ bins ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ 5 Ï„ÏÏ€Î¿Î¹ bins: [62](https://sourceware.org/git/gitweb.cgi?p=glibc.git;a=blob;f=malloc/malloc.c;h=6e766d11bc85b6480fa5c9f2a76559f8acf9deb5;hb=HEAD#l1407) Î¼Î¹ÎºÏÎ¿Î¯ bins, 63 Î¼ÎµÎ³Î¬Î»Î¿Î¹ bins, 1 unsorted bin, 10 fast bins ÎºÎ±Î¹ 64 tcache bins Î±Î½Î¬ Î½Î®Î¼Î±.

Î— Î±ÏÏ‡Î¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î³Î¹Î± ÎºÎ¬Î¸Îµ unsorted, small ÎºÎ±Î¹ large bin Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Î¯Î´Î¹Î¿ Ï€Î¯Î½Î±ÎºÎ±. Î¤Î¿ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ 0 Î´ÎµÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹, Ï„Î¿ 1 ÎµÎ¯Î½Î±Î¹ Ï„Î¿ unsorted bin, Ï„Î± bins 2-64 ÎµÎ¯Î½Î±Î¹ Î¼Î¹ÎºÏÎ¿Î¯ bins ÎºÎ±Î¹ Ï„Î± bins 65-127 ÎµÎ¯Î½Î±Î¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ bins.

### ÎœÎ¹ÎºÏÎ¿Î¯ Bins

ÎŸÎ¹ Î¼Î¹ÎºÏÎ¿Î¯ bins ÎµÎ¯Î½Î±Î¹ Ï„Î±Ï‡ÏÏ„ÎµÏÎ¿Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Î¼ÎµÎ³Î¬Î»Î¿Ï…Ï‚ bins Î±Î»Î»Î¬ Ï€Î¹Î¿ Î±ÏÎ³Î¿Î¯ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ fast bins.

ÎšÎ¬Î¸Îµ bin Î±Ï€ÏŒ Ï„Î± 62 Î¸Î± Î­Ï‡ÎµÎ¹ **chunks Ï„Î¿Ï… Î¯Î´Î¹Î¿Ï… Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚**: 16, 24, ... (Î¼Îµ Î¼Î­Î³Î¹ÏƒÏ„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ 504 bytes ÏƒÎµ 32bits ÎºÎ±Î¹ 1024 ÏƒÎµ 64bits). Î‘Ï…Ï„ÏŒ Î²Î¿Î·Î¸Î¬ÎµÎ¹ ÏƒÏ„Î·Î½ Ï„Î±Ï‡ÏÏ„Î·Ï„Î± ÎµÏÏÎµÏƒÎ·Ï‚ Ï„Î¿Ï… bin ÏŒÏ€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î¯Î½ÎµÎ¹ ÎµÎºÏ‡ÏÏÎ·ÏƒÎ· Ï‡ÏÏÎ¿Ï… ÎºÎ±Î¹ ÏƒÏ„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÎ±Î¹ Î±Ï†Î±Î¯ÏÎµÏƒÎ· ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÎµÏ‰Î½ ÏƒÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î»Î¯ÏƒÏ„ÎµÏ‚.

### ÎœÎµÎ³Î¬Î»Î¿Î¹ Bins

Î‘Î½Ï„Î¯Î¸ÎµÏ„Î± Î¼Îµ Ï„Î¿Ï…Ï‚ Î¼Î¹ÎºÏÎ¿ÏÏ‚ bins, Î¿Î¹ Î¿Ï€Î¿Î¯Î¿Î¹ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Ï„Î¼Î®Î¼Î±Ï„Î± Î¼Îµ ÏƒÏ„Î±Î¸ÎµÏÎ¬ Î¼ÎµÎ³Î­Î¸Î·, ÎºÎ¬Î¸Îµ **Î¼ÎµÎ³Î¬Î»Î¿Ï‚ bin Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î­Î½Î± ÎµÏÏÎ¿Ï‚ Î¼ÎµÎ³ÎµÎ¸ÏÎ½ Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½**. Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ ÎµÏ…Î­Î»Î¹ÎºÏ„Î¿, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î½Î± Ï†Î¹Î»Î¿Î¾ÎµÎ½ÎµÎ¯ **Î´Î¹Î¬Ï†Î¿ÏÎ± Î¼ÎµÎ³Î­Î¸Î·** Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î·Î½ Î±Î½Î¬Î³ÎºÎ· Î³Î¹Î± Î­Î½Î±Î½ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ bin Î³Î¹Î± ÎºÎ¬Î¸Îµ Î¼Î­Î³ÎµÎ¸Î¿Ï‚.

Î£Îµ Î­Î½Î±Î½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Î¼Î½Î®Î¼Î·Ï‚, Î¿Î¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ bins Î¾ÎµÎºÎ¹Î½Î¿ÏÎ½ Î±Ï€ÏŒ ÎµÎºÎµÎ¯ Ï€Î¿Ï… Ï„ÎµÎ»ÎµÎ¹ÏÎ½Î¿Ï…Î½ Î¿Î¹ Î¼Î¹ÎºÏÎ¿Î¯ bins. Î¤Î± ÎµÏÏÎ· Ï„Ï‰Î½ Î¼ÎµÎ³Î¬Î»Ï‰Î½ bins Î¼ÎµÎ³Î±Î»ÏÎ½Î¿Ï…Î½ ÏƒÏ„Î±Î´Î¹Î±ÎºÎ¬, Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ Ï€ÏÏÏ„Î¿ bin Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î¼Î®Î¼Î±Ï„Î± Î±Ï€ÏŒ 512 Î­Ï‰Ï‚ 576 bytes, ÎµÎ½Ï Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Î±Ï€ÏŒ 576 Î­Ï‰Ï‚ 640 bytes. Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ ÏƒÏ…Î½ÎµÏ‡Î¯Î¶ÎµÏ„Î±Î¹, Î¼Îµ Ï„Î¿Î½ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ bin Î½Î± Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Ï„Î¼Î®Î¼Î±Ï„Î± Î¬Î½Ï‰ Ï„Ï‰Î½ 1MB.

ÎŸÎ¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ bins ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Î±ÏÎ³Î¿Î¯ ÏƒÏ„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± ÏƒÎµ ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· Î¼Îµ Ï„Î¿Ï…Ï‚ Î¼Î¹ÎºÏÎ¿ÏÏ‚ bins ÎµÏ€ÎµÎ¹Î´Î® Ï€ÏÎ­Ï€ÎµÎ¹ **Î½Î± Ï„Î±Î¾Î¹Î½Î¿Î¼Î®ÏƒÎ¿Ï…Î½ ÎºÎ±Î¹ Î½Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎ¿Ï…Î½ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ Î¼Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Î¼ÎµÎ³Î­Î¸Î· Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ Î³Î¹Î± Î½Î± Î²ÏÎ¿Ï…Î½ Ï„Î·Î½ ÎºÎ±Î»ÏÏ„ÎµÏÎ· Ï„Î±Î¹ÏÎ¹Î¬ÏƒÏ„Î·ÎºÎ·** Î³Î¹Î± Î¼Î¹Î± ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·. ÎŒÏ„Î±Î½ Î­Î½Î± Ï„Î¼Î®Î¼Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ ÏƒÎµ Î­Î½Î±Î½ Î¼ÎµÎ³Î¬Î»Î¿ bin, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î±Î¾Î¹Î½Î¿Î¼Î·Î¸ÎµÎ¯, ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎºÏ‡ÏÏÎ·ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²ÏÎµÎ¹ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ Ï„Î¼Î®Î¼Î±. Î‘Ï…Ï„Î® Î· ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ ÎµÏÎ³Î±ÏƒÎ¯Î± Ï„Î¿Ï…Ï‚ ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ **Ï€Î¹Î¿ Î±ÏÎ³Î¿ÏÏ‚**, Î±Î»Î»Î¬ ÎµÏ€ÎµÎ¹Î´Î® Î¿Î¹ Î¼ÎµÎ³Î¬Î»ÎµÏ‚ ÎµÎºÏ‡Ï‰ÏÎ®ÏƒÎµÎ¹Ï‚ ÎµÎ¯Î½Î±Î¹ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î¼Î¹ÎºÏÎ­Ï‚, ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±Ï€Î¿Î´ÎµÎºÏ„Î® Î±Î½Ï„Î±Î»Î»Î±Î³Î®.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½:

* 32 bins ÎµÏÏÎ¿Ï…Ï‚ 64B
* 16 bins ÎµÏÏÎ¿Ï…Ï‚ 512B
* 8 bins ÎµÏÏÎ¿Ï…Ï‚ 4096B
* 4 bins ÎµÏÏÎ¿Ï…Ï‚ 32768B
* 2 bins ÎµÏÏÎ¿Ï…Ï‚ 262144B
* 1 bin Î³Î¹Î± Ï…Ï€ÎµÎ½Î¸ÏÎ¼Î¹ÏƒÎ· Î¼ÎµÎ³ÎµÎ¸ÏÎ½

### Unsorted bin

Î¤Î¿ unsorted bin ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **Î³ÏÎ®Î³Î¿ÏÎ¿ cache** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï„Î¿Ï… ÏƒÏ‰ÏÎ¿Ï Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ‡ÏÏÎ·ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ·. ÎˆÏ„ÏƒÎ¹ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯: ÎŒÏ„Î±Î½ Î­Î½Î± Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏÎ½ÎµÎ¹ Î¼Î½Î®Î¼Î·, Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï„Î¿Ï… ÏƒÏ‰ÏÎ¿Ï Î´ÎµÎ½ Ï„Î·Î½ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯ Î±Î¼Î­ÏƒÏ‰Ï‚ ÏƒÎµ Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ bin. Î‘Î½Ï„' Î±Ï…Ï„Î¿Ï, Ï€ÏÏÏ„Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± **ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÏƒÎµÎ¹ Î¼Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î³ÎµÎ¹Ï„Î¿Î½Î¹ÎºÎ¬ ÎµÎ»ÎµÏÎ¸ÎµÏÎ± Ï„Î¼Î®Î¼Î±Ï„Î±** Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î± Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Ï„Î¼Î®Î¼Î± ÎµÎ»ÎµÏÎ¸ÎµÏÎ·Ï‚ Î¼Î½Î®Î¼Î·Ï‚. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï„Î¿ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯ Î±Ï…Ï„ÏŒ Ï„Î¿ Î½Î­Î¿ Ï„Î¼Î®Î¼Î± ÏƒÎµ Î­Î½Î± Î³ÎµÎ½Î¹ÎºÏŒ bin Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "unsorted bin".

ÎŒÏ„Î±Î½ Î­Î½Î± Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î¶Î·Ï„Î¬ Î¼Î½Î®Î¼Î·, Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï„Î¿Ï… ÏƒÏ‰ÏÎ¿Ï **ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î¿ unsorted bin** Î³Î¹Î± Î½Î± Î´ÎµÎ¹ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± Ï„Î¼Î®Î¼Î± Î±ÏÎºÎµÏ„Î¬ Î¼ÎµÎ³Î¬Î»Î¿. Î‘Î½ Î²ÏÎµÎ¹ Î­Î½Î±, Ï„Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î±Î¼Î­ÏƒÏ‰Ï‚. Î‘Î½ Î´ÎµÎ½ Î²ÏÎµÎ¹ Î­Î½Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ Ï„Î¼Î®Î¼Î±, Î¼ÎµÏ„Î±Ï†Î­ÏÎµÎ¹ Ï„Î± ÎµÎ»ÎµÏÎ¸ÎµÏÎ± Ï„Î¼Î®Î¼Î±Ï„Î± ÏƒÏ„Î± Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î± bins Ï„Î¿Ï…Ï‚, ÎµÎ¯Ï„Îµ Î¼Î¹ÎºÏÎ¬ ÎµÎ¯Ï„Îµ Î¼ÎµÎ³Î¬Î»Î±, Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ Î¼Î­Î³ÎµÎ¸ÏŒÏ‚ Ï„Î¿Ï…Ï‚.

ÎˆÏ„ÏƒÎ¹, Ï„Î¿ unsorted bin ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± ÎµÏ€Î¹Ï„Î±Ï‡Ï…Î½Î¸ÎµÎ¯ Î· ÎµÎºÏ‡ÏÏÎ·ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚ Î¼Îµ Ï„Î·Î½ Î³ÏÎ®Î³Î¿ÏÎ· ÎµÏ€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€ÏÏŒÏƒÏ†Î±Ï„Î± Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¼Î­Î½Î·Ï‚ Î¼Î½Î®Î¼Î·Ï‚ ÎºÎ±Î¹ Ï„Î· Î¼ÎµÎ¯Ï‰ÏƒÎ· Ï„Î·Ï‚ Î±Î½Î¬Î³ÎºÎ·Ï‚ Î³Î¹Î± Ï‡ÏÎ¿Î½Î¿Î²ÏŒÏÎµÏ‚ Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÏƒÎµÎ¹Ï‚.

{% hint style="danger" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Ï„Î± Ï„Î¼Î®Î¼Î±Ï„Î± ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½, Î±Î½ Î­Î½Î± Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Ï„Î¼Î®Î¼Î± ÏƒÏ…Î³ÎºÏÎ¿ÏÎµÏ„Î±Î¹ Î¼Îµ Î­Î½Î± Î¬Î»Î»Î¿ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Ï„Î¼Î®Î¼Î± (Î±ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½), Î¸Î± ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏ…Ï„Î¿ÏÎ½.
{% endhint %}

### Fast bins

ÎŸÎ¹ fast bins ÏƒÏ‡ÎµÎ´Î¹Î¬ÏƒÏ„Î·ÎºÎ±Î½ Î³Î¹Î± Î½Î± **ÎµÏ€Î¹Ï„Î±Ï‡ÏÎ½Î¿Ï…Î½ Ï„Î·Î½ ÎµÎºÏ‡ÏÏÎ·ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± Î¼Î¹ÎºÏÎ¬ Ï„Î¼Î®Î¼Î±Ï„Î±** ÎºÏÎ±Ï„ÏÎ½Ï„Î±Ï‚ Ï€ÏÏŒÏƒÏ†Î±Ï„Î± Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¼Î­Î½Î± Ï„Î¼Î®Î¼Î±Ï„Î± ÏƒÎµ Î¼Î¹Î± Î´Î¿Î¼Î® Î³ÏÎ®Î³Î¿ÏÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚. Î‘Ï…Ï„Î¬ Ï„Î± bins Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î¼Î¹Î± Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Last-In, First-Out (LIFO), Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ **Ï€Î¹Î¿ Ï€ÏÏŒÏƒÏ†Î±Ï„Î± Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¼Î­Î½Î¿ Ï„Î¼Î®Î¼Î± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€ÏÏÏ„Î¿** Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÏŒÏ„Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±Î¯Ï„Î·ÏƒÎ· Î³Î¹Î± Î½Î­Î± ÎµÎºÏ‡ÏÏÎ·ÏƒÎ·. Î‘Ï…Ï„Î® Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Ï‰Ï†ÎµÎ»Î®Ï‚ Î³Î¹Î± Ï„Î·Î½ Ï„Î±Ï‡ÏÏ„Î·Ï„Î±, ÎºÎ±Î¸ÏÏ‚ ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ¿ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎµÏ„Îµ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® Î¼Î¹Î±Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ (LIFO) ÏƒÎµ ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· Î¼Îµ Î¼Î¹Î± Î¿Ï…ÏÎ¬ (FIFO).

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, **Î¿Î¹ fast bins Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î¼Î¿Î½ÏŒÎ´ÎµÏƒÎ¼ÎµÏ‚ Î»Î¯ÏƒÏ„ÎµÏ‚**, ÏŒÏ‡Î¹ Î´Î¹Ï€Î»Î­Ï‚, Ï€Î¿Ï… Î²ÎµÎ»Ï„Î¹ÏÎ½ÎµÎ¹ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Ï„Î·Î½ Ï„Î±Ï‡ÏÏ„Î·Ï„Î±. Î”ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÏŒÏ„Î¹ Ï„Î± Ï„Î¼Î®Î¼Î±Ï„Î± ÏƒÏ„Î¿Ï…Ï‚ fast bins Î´ÎµÎ½ ÏƒÏ…Î³
## Î¡Î¿Î® ÎšÎ±Ï„Î±Î½Î¿Î¼Î®Ï‚

{% hint style="success" %}
(Î— Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÎµÎ¾Î®Î³Î·ÏƒÎ· Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions). TODO: Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î­ÎºÎ´Î¿ÏƒÎ· ÎºÎ±Î¹ ÎµÎ½Î·Î¼ÎµÏÏÏƒÏ„Îµ Ï„Î·Î½)
{% endhint %}

ÎŸÎ¹ ÎºÎ±Ï„Î±Î½Î¿Î¼Î­Ï‚ Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Ï„ÎµÎ»Î¹ÎºÎ¬ Î¼Îµ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±: `void * _int_malloc (mstate av, size_t bytes)` ÎºÎ±Î¹ Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ½ Î±Ï…Ï„Î®Î½ Ï„Î· ÏƒÎµÎ¹ÏÎ¬:

1. Î•Î½Î·Î¼ÎµÏÏÎ½ÎµÎ¹ Ï„Î¿ `bytes` Î³Î¹Î± Î½Î± Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎµÎ¹ Ï„Î¹Ï‚ **ÎµÏ…Î¸Ï…Î³ÏÎ±Î¼Î¼Î¯ÏƒÎµÎ¹Ï‚**, Îº.Î»Ï€.
2. Î•Î»Î­Î³Ï‡ÎµÎ¹ Î±Î½ Ï„Î¿ `av` ÎµÎ¯Î½Î±Î¹ **NULL** Î® ÏŒÏ‡Î¹.
3. Î£Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î±Ï€Î¿Ï…ÏƒÎ¯Î±Ï‚ **Ï‡ÏÎ®ÏƒÎ¹Î¼Î·Ï‚ Î±ÏÎ­Î½Î±Ï‚** (ÏŒÏ„Î±Î½ Ï„Î¿ `av` ÎµÎ¯Î½Î±Î¹ NULL), ÎºÎ±Î»ÎµÎ¯ Ï„Î¿ `sysmalloc` Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÎ¹ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ mmap. Î•Î¬Î½ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¹Ï„Ï…Ï‡Î­Ï‚, ÎºÎ±Î»ÎµÎ¯ Ï„Î¿ `alloc_perturb`. Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï„Î¿ Î´ÎµÎ¯ÎºÏ„Î·.
4. Î‘Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚:
* \[Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î¿Î½ Î±ÏÏ‡Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±] Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ tcache Ï€ÏÎ¹Î½ ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ fastbin.
* \[Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î¿Î½ Î±ÏÏ‡Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±] Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ tcache Î±Î»Î»Î¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒÏ‚ bin (Î´ÎµÎ¯Ï„Îµ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±), Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ„Îµ Î½Î± Î³ÎµÎ¼Î¯ÏƒÎµÏ„Îµ Ï„Î¿ tcache Î±Ï€ÏŒ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ bin
* Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… **fastbin**:
1. Î Î¬ÏÏ„Îµ Î´ÎµÎ¯ÎºÏ„Î· ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± fastbin Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ bin ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚.
2. Î‘Ï†Î±Î¹ÏÎµÎ¯ Ï„Î¿ Ï€ÏÏÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ bin ÎºÎ±Î¹ ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ `victim` Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÎµ Î±Ï…Ï„ÏŒ.
3. Î‘Î½ Ï„Î¿ `victim` ÎµÎ¯Î½Î±Î¹ NULL, Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÏ„Îµ ÏƒÏ„Î·Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î· Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· (smallbin).
4. Î‘Î½ Ï„Î¿ `victim` Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ NULL, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î³Î¹Î± Î½Î± Î²ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Î±Î½Î®ÎºÎµÎ¹ ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ bin. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± ("malloc(): Î¼Î½Î®Î¼Î· Ï€Î¿Ï… Î´Î¹Î±Ï†Î¸ÎµÎ¯ÏÎµÏ„Î±Î¹ (fast)").
5. ÎšÎ±Î»ÎµÎ¯ Ï„Î¿ `alloc_perturb` ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï„Î¿ Î´ÎµÎ¯ÎºÏ„Î·.
* Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… **smallbin**:
1. Î Î¬ÏÏ„Îµ Î´ÎµÎ¯ÎºÏ„Î· ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± smallbin Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ bin ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚.
2. Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ bin, Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÏ„Îµ ÏƒÏ„Î·Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î· Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·. Î‘Ï…Ï„ÏŒ ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ ÏƒÏ…Î³ÎºÏÎ¯Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ `bin` ÎºÎ±Î¹ `bin->bk`.
3. Î¤Î¿ `victim` Î³Î¯Î½ÎµÏ„Î±Î¹ Î¯ÏƒÎ¿ Î¼Îµ Ï„Î¿ `bin->bk` (Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÏ„Î¿ bin). Î‘Î½ ÎµÎ¯Î½Î±Î¹ NULL (ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ `Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·`), ÎºÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ `malloc_consolidate` ÎºÎ±Î¹ Ï€Î±ÏÎ±Î»ÎµÎ¯ÏˆÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚ Î²Î®Î¼Î± ÎµÎ»Î­Î³Ï‡Î¿Ï… ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ bins.
4. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, ÏŒÏ„Î±Î½ Ï„Î¿ `victim` Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ NULL, ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Î½ `victim->bk->fd` ÎºÎ±Î¹ `victim` ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ± Î® ÏŒÏ‡Î¹. Î‘Î½ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ±, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`malloc(): Î´Î¹Ï€Î»Î® Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ Î¼Î¹ÎºÏÎ¿Ï bin`). 
5. ÎŸÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ bit PREV\_INSUSE Î³Î¹Î± Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (ÏƒÏ„Î· Î¼Î½Î®Î¼Î·, ÏŒÏ‡Î¹ ÏƒÏ„Î· Î´Î¹Ï€Î»Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î»Î¯ÏƒÏ„Î±) Î³Î¹Î± Ï„Î¿ `victim`.
6. Î‘Ï†Î±Î¹ÏÎµÎ¯ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î±Ï€ÏŒ Ï„Î· Î»Î¯ÏƒÏ„Î± Ï„Î¿Ï… bin.
7. ÎŸÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ bit Î±ÏÎ­Î½Î±Ï‚ Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ `av`.
8. ÎšÎ±Î»ÎµÎ¯ Ï„Î¿ `alloc_perturb` ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï„Î¿ Î´ÎµÎ¯ÎºÏ„Î·.
* Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î´ÎµÎ½ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… smallbin:
1. Î Î¬ÏÏ„Îµ Î´ÎµÎ¯ÎºÏ„Î· ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± largebin Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ bin ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚.
2. Î”ÎµÎ¯Ï„Îµ Î±Î½ Ï„Î¿ `av` Î­Ï‡ÎµÎ¹ fastchunks Î® ÏŒÏ‡Î¹. Î‘Ï…Ï„ÏŒ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿ `FASTCHUNKS_BIT` ÏƒÏ„Î± `av->flags`. Î‘Î½ Î½Î±Î¹, ÎºÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ `malloc_consolidate` ÏƒÏ„Î¿ `av`.
5. Î‘Î½ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎµÏ€Î¹ÏƒÏ„ÏÎ±Ï†ÎµÎ¯ Î±ÎºÏŒÎ¼Î± Î´ÎµÎ¯ÎºÏ„Î·Ï‚, Î±Ï…Ï„ÏŒ Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Î­Î½Î± Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î±Ï€ÏŒ Ï„Î± Î±ÎºÏŒÎ»Î¿Ï…Î¸Î± Ï€ÎµÏÎ¹ÏƒÏ„Î±Ï„Î¹ÎºÎ¬:
1. Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ 'fastbin' Î±Î»Î»Î¬ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ fastchunk Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿.
2. Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ 'smallbin' Î±Î»Î»Î¬ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ smallchunk Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ (ÎºÎ±Î»ÎµÎ¯ Ï„Î¿ `malloc_consolidate` ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·).
3. Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ 'largebin'.
6. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ **Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î±** ÎºÎ±Î¹ Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï€Î¿Ï… Î´Î¹Î±Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹ Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ bins. Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¼ÏŒÎ½Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ ÏŒÏ€Î¿Ï… Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ bins. Î”Î¹Î±Ï„ÏÎ­Î¾Ï„Îµ Ï„Î¿Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î¿ bin Î±Ï€ÏŒ Ï„Î¿ 'TAIL'.
1. Î¤Î¿ `victim` Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… ÎµÎ¾ÎµÏ„Î¬Î¶ÎµÏ„Î±Î¹.
2. Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï `victim` Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿Ï… (`2*SIZE_SZ`) ÎºÎ±Î¹ Î¼Î­Î³Î¹ÏƒÏ„Î¿Ï… (`av->system_mem`) ÎµÏÏÎ¿Ï…Ï‚. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`malloc(): Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ Î¼Î½Î®Î¼Î·Ï‚`).
3. Î‘Î½ (Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… smallbin) ÎºÎ±Î¹ (`victim` ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï…Ï€Î¿Î»Î¿Î¯Ï€Î¿Ï…) ÎºÎ±Î¹ (ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÏ„Î¿Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î¿ bin) ÎºÎ±Î¹ (Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Ï‰Î½ ÎºÎ¿Î¼Î¼Î±Ï„Î¹ÏÎ½ >= Î±Ï…Ï„Î¿Ï Ï€Î¿Ï… Î¶Î·Ï„Î®Î¸Î·ÎºÎµ): **Î”Î¹Î±Î¯ÏÎµÏƒÎµ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÎµ 2 ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î±**:
* Î¤Î¿ Ï€ÏÏÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Î¶Î·Ï„Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎºÎ±Î¹ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÏ„Î±Î¹.
* Î¤Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ Ï„Î¿ Î½Î­Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï…Ï€Î¿Î»Î¿Î¯Ï€Î¿Ï…. Î•Î¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ Ï€Î¯ÏƒÏ‰ ÏƒÏ„Î¿Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î¿ bin.
1. ÎŸÏÎ¯ÏƒÏ„Îµ Ï„Î± Ï€ÎµÎ´Î¯Î± `chunk_size` ÎºÎ±Î¹ `chunk_prev_size` ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î± Î³Î¹Î± Ï„Î± Î´ÏÎ¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î±.
2. Î¤Î¿ Ï€ÏÏÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÏ„Î±Î¹ Î¼ÎµÏ„Î¬ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Ï„Î¿Ï… `alloc_perturb`.
3. Î‘Î½ Î· Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÏƒÏ…Î½Î¸Î®ÎºÎ· ÎµÎ¯Î½Î±Î¹ ÏˆÎµÏ…Î´Î®Ï‚, Î· Î­Î»ÎµÎ³Ï‡Î¿Ï‚ Ï†Ï„Î¬Î½ÎµÎ¹ ÎµÎ´Ï. Î‘Ï†Î±Î¹ÏÎ­ÏƒÏ„Îµ Ï„Î¿ `victim` Î±Ï€ÏŒ Ï„Î¿Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î¿ bin. Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… `victim` Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Î¼Îµ Ï„Î¿ Î¶Î·Ï„Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚, ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î¼ÎµÏ„Î¬ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Ï„Î¿Ï… `alloc_perturb`.
4. Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… `victim` Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… smallbin, Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ smallbin ÏƒÏ„Î¿ `HEAD`.
5. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ largebin Î´Î¹Î±Ï„Î·ÏÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Ï„Î±Î¾Î¹Î½Î¿Î¼Î·Î¼Î­Î½Î· ÏƒÎµÎ¹ÏÎ¬:
6. Î•Î»Î­Î³Î¾Ï„Îµ Ï€ÏÏÏ„Î± Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (Ï„Î¿ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿). Î‘Î½ Ï„Î¿ `victim` ÎµÎ¯Î½Î±Î¹ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹, ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î­ Ï„Î¿ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚.
7. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, ÎµÏ€Î±Î½Î±Î»Î¬Î²ÎµÏ„Îµ Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î¼Îµ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ >= Ï„Î¿Ï… `victim`. Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¿ Î¯Î´Î¹Î¿, ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€Î¬Î½Ï„Î± ÏƒÏ„Î· Î´ÎµÏÏ„ÎµÏÎ· Î¸Î­ÏƒÎ·.
8. Î•Ï€Î±Î½Î±Î»Î¬Î²ÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î²Î®Î¼Î± Î¼Î­Î³Î¹ÏƒÏ„Î¿ `MAX_ITERS` (10000) Ï†Î¿ÏÎ­Ï‚ Î® Î¼Î­Ï‡ÏÎ¹ Î½Î± ÎµÎ¾Î±Î½Ï„Î»Î·Î¸Î¿ÏÎ½ ÏŒÎ»Î± Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÏƒÏ„Î¿Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Î¿ bin.
7. ÎœÎµÏ„Î¬ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Ï‰Î½ Î±Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·Ï„Ï‰Î½ ÎºÎ¿Î¼Î¼Î±Ï„Î¹ÏÎ½, ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Î½ Ï„Î¿ Î¶Î·Ï„Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î´ÎµÎ½ Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ ÎµÏÏÎ¿Ï‚ Ï„Î¿Ï… smallbin, Î±Î½ Î½Î±Î¹ Ï„ÏŒÏ„Îµ ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± **largebins**.
1. Î Î¬ÏÏ„Îµ Î´ÎµÎ¯ÎºÏ„Î· ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± largebin Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿
## Î•Î»ÎµÏÎ¸ÎµÏÎ· Î¡Î¿Î®

{% hint style="success" %}
(Î— Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÎµÎ¾Î®Î³Î·ÏƒÎ· Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions). TODO: Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î­ÎºÎ´Î¿ÏƒÎ· ÎºÎ±Î¹ ÎµÎ½Î·Î¼ÎµÏÏÏƒÏ„Îµ Ï„Î·Î½)
{% endhint %}

Î— Ï„ÎµÎ»Î¹ÎºÎ® ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î¿Ï… ÎµÎ»ÎµÏ…Î¸ÎµÏÏÎ½ÎµÎ¹ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Î¼Î½Î®Î¼Î·Ï‚ ÎµÎ¯Î½Î±Î¹ Î· `_int_free (mstate av, mchunkptr p, int have_lock)`:

1. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ `p` Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î¿ `p + chunksize(p)` ÏƒÏ„Î· Î¼Î½Î®Î¼Î· (Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÎµÏ…Ï‡Î¸ÎµÎ¯ Î· Ï„Ï…Î»Î¹Î³Î¼Î­Î½Î· Î¼Î½Î®Î¼Î·). Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`free(): Î¼Î· Î­Î³ÎºÏ…ÏÎ¿Ï‚ Î´ÎµÎ¯ÎºÏ„Î·Ï‚`).
2. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ `MINSIZE` Î® Ï€Î¿Î»Î»Î±Ï€Î»Î¬ÏƒÎ¹Î¿ Ï„Î¿Ï… `MALLOC_ALIGNMENT`. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`free(): Î¼Î· Î­Î³ÎºÏ…ÏÎ¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚`).
3. Î•Î¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± fastbin:
1. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼ÎµÏ„Î±Î¾Ï ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿Ï… ÎºÎ±Î¹ Î¼Î­Î³Î¹ÏƒÏ„Î¿Ï… Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚ (`av->system_mem`), Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`free(): Î¼Î· Î­Î³ÎºÏ…ÏÎ¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… (fast)`) Î±Î»Î»Î¹ÏÏ‚.
2. ÎšÎ±Î»ÎµÎ¯ Ï„Î¿ `free_perturb` ÏƒÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
3. ÎŸÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ `FASTCHUNKS_BIT` Î³Î¹Î± Ï„Î¿ `av`.
4. Î Î±Î¯ÏÎ½ÎµÎ¹ Î´ÎµÎ¯ÎºÏ„Î· ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± fastbin Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï.
5. Î•Î»Î­Î³Ï‡ÎµÎ¹ ÎµÎ¬Î½ Î· ÎºÎ¿ÏÏ…Ï†Î® Ï„Î¿Ï… ÎºÎ¬Î´Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± Ï€ÏÎ¿ÏƒÏ„ÎµÎ¸ÎµÎ¯. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`Î´Î¹Ï€Î»Î® ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ· Î® Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ (fasttop)`).
6. Î•Î»Î­Î³Ï‡ÎµÎ¹ ÎµÎ¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï fastbin ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¯Î´Î¹Î¿ Î¼Îµ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î¼Îµ. Î”Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`Î¼Î· Î­Î³ÎºÏ…ÏÎ· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ fastbin (ÎµÎ»ÎµÏÎ¸ÎµÏÎ·)`).
7. Î•Î¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ fastbin ÎºÎ±Î¹ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹.
4. Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ mmapped:
1. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î® ÏŒÏ‡Î¹. Î•Î¬Î½ Î½Î±Î¹, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`Î´Î¹Ï€Î»Î® ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ· Î® Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ (ÎºÎ¿ÏÏ…Ï†Î®) `).
2. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·) Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÎµÎ½Ï„ÏŒÏ‚ Ï„Ï‰Î½ Î¿ÏÎ¯Ï‰Î½ Ï„Î·Ï‚ Î±ÏÎ­Î½Î±Ï‚. Î‘Î½ ÏŒÏ‡Î¹, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`Î´Î¹Ï€Î»Î® ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ· Î® Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ (Î­Î¾Ï‰) `).
3. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ bit Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·) ÎµÎ¯Î½Î±Î¹ ÏƒÎ·Î¼Î±ÏƒÎ¼Î­Î½Î¿ Î® ÏŒÏ‡Î¹. Î‘Î½ ÏŒÏ‡Î¹, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`Î´Î¹Ï€Î»Î® ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ· Î® Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ (!prev) `).
4. Î•Î»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿Ï… ÎºÎ±Î¹ Î¼Î­Î³Î¹ÏƒÏ„Î¿Ï… Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚ (`av->system_mem`). Î‘Î½ ÏŒÏ‡Î¹, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± (`free(): Î¼Î· Î­Î³ÎºÏ…ÏÎ¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… (ÎºÎ±Î½Î¿Î½Î¹ÎºÏŒ) `).
5. ÎšÎ±Î»ÎµÎ¯ Ï„Î¿ `free_perturb` ÏƒÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
6. Î•Î¬Î½ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·) Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ·, ÎºÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ `unlink` ÏƒÏ„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
7. Î•Î¬Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·) Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹:
1. Î‘Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ·, ÎºÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ `unlink` ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
2. Î£Ï…Î³Ï‡Ï‰Î½ÎµÏÏƒÏ„Îµ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î¼Îµ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿, Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·), Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿, ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï„Î¿ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î® Ï„Î¿Ï… unsorted bin. Î ÏÎ¹Î½ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®, ÎµÎ»Î­Î³Î¾Ï„Îµ ÎµÎ¬Î½ `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` Î® ÏŒÏ‡Î¹. Î‘Î½ ÏŒÏ‡Î¹, ÎµÎºÏ„Î¿Î¾ÎµÏÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± ("free(): Î´Î¹Î±Ï†Î¸Î¿ÏÎ¬ ÏƒÏ„Î± unsorted chunks").
8. Î•Î¬Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¼Î½Î®Î¼Î·) Î®Ï„Î±Î½ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹, ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÏƒÏ„Îµ Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î± ÏƒÎµ Î­Î½Î± Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
5. Î‘Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î®Ï„Î±Î½ mmapped, ÎºÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ `munmap_chunk`.

## ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ Î‘ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ ÎšÎ¬Î´Î¿Ï…

Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿Ï…Ï‚ Î­Î»ÎµÎ³Ï‡Î¿Ï…Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï€Î¿Ï… Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ ÏƒÏ…Ï‡Î½Î¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿Î½ ÎºÎ¬Î´Î¿ ÏƒÎµ:

{% content-ref url="heap-functions-security-checks.md" %}
[heap-functions-security-checks.md](heap-functions-security-checks.md)
{% endcontent-ref %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/](https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/)
* [https://azeria-labs.com/heap-exploitation-part-2-glibc-heap-free-bins/](https://azeria-labs.com/heap-exploitation-part-2-glibc-heap-free-bins/)
* [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions)
