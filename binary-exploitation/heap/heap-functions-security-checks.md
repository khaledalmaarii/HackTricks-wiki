# V√©rifications de s√©curit√© des fonctions du tas

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## unlink

Cette fonction supprime un morceau d'une liste doublement cha√Æn√©e. Des v√©rifications courantes garantissent que la structure de la liste cha√Æn√©e reste coh√©rente lors de la suppression des morceaux.

* **V√©rifications de coh√©rence** :
* V√©rifiez si `P->fd->bk == P` et `P->bk->fd == P`.
* Message d'erreur : `corrupted double-linked list`

## \_int\_malloc

Cette fonction est responsable de l'allocation de m√©moire √† partir du tas. Les v√©rifications ici garantissent que la m√©moire n'est pas corrompue pendant l'allocation.

* **V√©rification de la taille de Fastbin** :
* Lors de la suppression d'un morceau d'un fastbin, assurez-vous que la taille du morceau est dans la plage du fastbin.
* Message d'erreur : `malloc(): memory corruption (fast)`
* **V√©rification de coh√©rence de Smallbin** :
* Lors de la suppression d'un morceau d'un smallbin, assurez-vous que les liens pr√©c√©dents et suivants dans la liste doublement cha√Æn√©e sont coh√©rents.
* Message d'erreur : `malloc(): smallbin double linked list corrupted`
* **V√©rification de la plage de m√©moire de Unsorted Bin** :
* Assurez-vous que la taille des morceaux dans le unsorted bin est dans les limites minimale et maximale.
* Message d'erreur : `malloc(): memory corruption`
* **V√©rification de coh√©rence de Unsorted Bin (Premier sc√©nario)** :
* Lors de l'insertion d'un morceau restant dans le unsorted bin, v√©rifiez si `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Message d'erreur : `malloc(): corrupted unsorted chunks`
* **V√©rification de coh√©rence de Unsorted Bin (Deuxi√®me sc√©nario)** :
* Identique √† la v√©rification pr√©c√©dente, mais d√©clench√©e lors de l'insertion apr√®s la division d'un morceau rapide ou petit.
* Message d'erreur : `malloc(): corrupted unsorted chunks 2`

## \_int\_free

Cette fonction lib√®re la m√©moire pr√©c√©demment allou√©e. Les v√©rifications ici aident √† garantir une d√©sallocation m√©moire appropri√©e et √† pr√©venir la corruption de la m√©moire.

* **V√©rification des limites du pointeur** :
* Assurez-vous que le pointeur √† lib√©rer ne fait pas le tour de la m√©moire.
* Message d'erreur : `free(): invalid pointer`
* **V√©rification de la taille** :
* Assurez-vous que la taille du morceau √† lib√©rer est au moins `MINSIZE` ou un multiple de `MALLOC_ALIGNMENT`.
* Message d'erreur : `free(): invalid size`
* **V√©rification de la taille de Fastbin** :
* Pour les morceaux de fastbin, assurez-vous que la taille du morceau suivant est dans les limites minimale et maximale.
* Message d'erreur : `free(): invalid next size (fast)`
* **V√©rification de double lib√©ration de Fastbin** :
* Lors de l'insertion d'un morceau dans un fastbin, assurez-vous que le morceau en t√™te n'est pas le m√™me que celui ins√©r√©.
* Message d'erreur : `double free or corruption (fasttop)`
* **V√©rification de coh√©rence de Fastbin** :
* Lors de l'insertion dans un fastbin, assurez-vous que les tailles du morceau en t√™te et du morceau ins√©r√© sont les m√™mes.
* Message d'erreur : `invalid fastbin entry (free)`
* **V√©rification de coh√©rence du Top Chunk** :
* Pour les morceaux non fastbin, assurez-vous que le morceau n'est pas le m√™me que le top chunk.
* Message d'erreur : `double free or corruption (top)`
* **V√©rification des limites de m√©moire** :
* Assurez-vous que le morceau suivant par la m√©moire est dans les limites de l'ar√®ne.
* Message d'erreur : `double free or corruption (out)`
* **V√©rification du bit Prev_inuse** :
* Assurez-vous que le bit pr√©c√©dent utilis√© dans le morceau suivant est marqu√©.
* Message d'erreur : `double free or corruption (!prev)`
* **V√©rification de la taille normale** :
* Assurez-vous que la taille du morceau suivant est dans des plages valides.
* Message d'erreur : `free(): invalid next size (normal)`
* **V√©rification de coh√©rence de Unsorted Bin** :
* Lors de l'insertion d'un morceau fusionn√© dans le unsorted bin, v√©rifiez si `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Message d'erreur : `free(): corrupted unsorted chunks`

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
