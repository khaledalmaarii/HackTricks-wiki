# Heap FonksiyonlarÄ± GÃ¼venlik Kontrolleri

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

## unlink

Bu fonksiyon, bir parÃ§ayÄ± Ã§ift yÃ¶nlÃ¼ baÄŸlÄ± listeden kaldÄ±rÄ±r. ParÃ§alarÄ± ayÄ±rÄ±rken baÄŸlÄ± liste yapÄ±sÄ±nÄ±n tutarlÄ± kalmasÄ±nÄ± saÄŸlayan yaygÄ±n kontroller bulunmaktadÄ±r.

* **TutarlÄ±lÄ±k Kontrolleri**:
* `P->fd->bk == P` ve `P->bk->fd == P` koÅŸullarÄ±nÄ± kontrol edin.
* Hata mesajÄ±: `corrupted double-linked list`

## \_int\_malloc

Bu fonksiyon, heap'ten bellek ayÄ±rmaktan sorumludur. Buradaki kontroller, belleÄŸin ayÄ±rma sÄ±rasÄ±nda bozulmadÄ±ÄŸÄ±ndan emin olur.

* **Fastbin Boyut KontrolÃ¼**:
* Bir parÃ§ayÄ± fastbin'den kaldÄ±rÄ±rken, parÃ§anÄ±n boyutunun fastbin aralÄ±ÄŸÄ±nda olduÄŸundan emin olun.
* Hata mesajÄ±: `malloc(): memory corruption (fast)`
* **Smallbin TutarlÄ±lÄ±k KontrolÃ¼**:
* Bir parÃ§ayÄ± smallbin'den kaldÄ±rÄ±rken, Ã§ift yÃ¶nlÃ¼ baÄŸlÄ± listedeki Ã¶nceki ve sonraki baÄŸlantÄ±larÄ±n tutarlÄ± olduÄŸundan emin olun.
* Hata mesajÄ±: `malloc(): smallbin double linked list corrupted`
* **Unsorted Bin Bellek AralÄ±ÄŸÄ± KontrolÃ¼**:
* KarÄ±ÅŸÄ±k kutulardaki parÃ§alarÄ±n boyutunun minimum ve maksimum sÄ±nÄ±rlar arasÄ±nda olduÄŸundan emin olun.
* Hata mesajÄ±: `malloc(): memory corruption | malloc(): invalid next size (unsorted)`
* **Unsorted Bin TutarlÄ±lÄ±k KontrolÃ¼ (Ä°lk Senaryo)**:
* Kalan bir parÃ§ayÄ± karÄ±ÅŸÄ±k kutuya eklerken, `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` koÅŸulunu kontrol edin.
* Hata mesajÄ±: `malloc(): corrupted unsorted chunks`
* **Unsorted Bin TutarlÄ±lÄ±k KontrolÃ¼ (Ä°kinci Senaryo)**:
* Ã–nceki kontrolle aynÄ±dÄ±r, ancak hÄ±zlÄ± veya kÃ¼Ã§Ã¼k bir parÃ§ayÄ± bÃ¶ldÃ¼kten sonra ekleme yapÄ±ldÄ±ÄŸÄ±nda tetiklenir.
* Hata mesajÄ±: `malloc(): corrupted unsorted chunks 2`

## \_int\_free

Bu fonksiyon Ã¶nceden ayrÄ±lmÄ±ÅŸ belleÄŸi serbest bÄ±rakÄ±r. Buradaki kontroller, uygun bellek serbest bÄ±rakma ve bellek bozulmasÄ±nÄ± Ã¶nlemeye yardÄ±mcÄ± olur.

* **Ä°ÅŸaretÃ§i SÄ±nÄ±r KontrolÃ¼**:
* Serbest bÄ±rakÄ±lan iÅŸaretÃ§inin belleÄŸi sarmadÄ±ÄŸÄ±ndan emin olun.
* Hata mesajÄ±: `free(): invalid pointer`
* **Boyut KontrolÃ¼**:
* Serbest bÄ±rakÄ±lan parÃ§anÄ±n boyutunun en az `MINSIZE` veya `MALLOC_ALIGNMENT`'Ä±n katlarÄ±ndan biri olduÄŸundan emin olun.
* Hata mesajÄ±: `free(): invalid size`
* **Fastbin Boyut KontrolÃ¼**:
* Fastbin parÃ§alarÄ± iÃ§in, bir sonraki parÃ§anÄ±n boyutunun minimum ve maksimum sÄ±nÄ±rlar arasÄ±nda olduÄŸundan emin olun.
* Hata mesajÄ±: `free(): invalid next size (fast)`
* **Fastbin Ã‡ift Serbest BÄ±rakma KontrolÃ¼**:
* Bir parÃ§ayÄ± fastbin'e eklerken, baÅŸtaki parÃ§anÄ±n eklenen parÃ§a ile aynÄ± olmadÄ±ÄŸÄ±ndan emin olun.
* Hata mesajÄ±: `double free or corruption (fasttop)`
* **Fastbin TutarlÄ±lÄ±k KontrolÃ¼**:
* Fastbin'e ekleme yaparken, baÅŸtaki parÃ§a ile eklenen parÃ§anÄ±n boyutlarÄ±nÄ±n aynÄ± olduÄŸundan emin olun.
* Hata mesajÄ±: `invalid fastbin entry (free)`
* **Ãœst ParÃ§a TutarlÄ±lÄ±k KontrolÃ¼**:
* HÄ±zlÄ± olmayan fastbin parÃ§alarÄ± iÃ§in, parÃ§anÄ±n Ã¼st parÃ§a ile aynÄ± olmadÄ±ÄŸÄ±ndan emin olun.
* Hata mesajÄ±: `double free or corruption (top)`
* **Bellek SÄ±nÄ±rlarÄ± KontrolÃ¼**:
* BelleÄŸi saran bir sonraki parÃ§anÄ±n arenanÄ±n sÄ±nÄ±rlarÄ± iÃ§inde olduÄŸundan emin olun.
* Hata mesajÄ±: `double free or corruption (out)`
* **Prev\_inuse Bit KontrolÃ¼**:
* Bir sonraki parÃ§adaki Ã¶nceki kullanÄ±mda bitin iÅŸaretlendiÄŸinden emin olun.
* Hata mesajÄ±: `double free or corruption (!prev)`
* **Normal Boyut KontrolÃ¼**:
* Bir sonraki parÃ§anÄ±n boyutunun geÃ§erli aralÄ±klarda olduÄŸundan emin olun.
* Hata mesajÄ±: `free(): invalid next size (normal)`
* **Unsorted Bin TutarlÄ±lÄ±k KontrolÃ¼**:
* Bir birleÅŸtirilmiÅŸ parÃ§ayÄ± karÄ±ÅŸÄ±k kutuya eklerken, `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` koÅŸulunu kontrol edin.
* Hata mesajÄ±: `free(): corrupted unsorted chunks`

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
