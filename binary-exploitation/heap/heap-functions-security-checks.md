# Sprawdzanie zabezpiecze funkcji sterty

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## unlink

Ta funkcja usuwa kawaek z dwukierunkowej listy. Powszechne sprawdzenia zapewniaj, 偶e struktura listy pozostaje sp贸jna podczas usuwania kawak贸w.

* **Sprawdzenia sp贸jnoci**:
* Sprawd藕, czy `P->fd->bk == P` i `P->bk->fd == P`.
* Komunikat o bdzie: `corrupted double-linked list`

## \_int\_malloc

Ta funkcja jest odpowiedzialna za alokacj pamici ze sterty. Sprawdzenia tutaj zapewniaj, 偶e pami nie jest uszkodzona podczas alokacji.

* **Sprawdzenie rozmiaru fastbin**:
* Podczas usuwania kawaka z fastbin, upewnij si, 偶e rozmiar kawaka mieci si w zakresie fastbin.
* Komunikat o bdzie: `malloc(): memory corruption (fast)`
* **Sprawdzenie sp贸jnoci smallbin**:
* Podczas usuwania kawaka z smallbin, upewnij si, 偶e poprzednie i nastpne odnoniki w dwukierunkowej licie s sp贸jne.
* Komunikat o bdzie: `malloc(): smallbin double linked list corrupted`
* **Sprawdzenie zakresu pamici unsorted bin**:
* Upewnij si, 偶e rozmiar kawak贸w w unsorted bin mieci si w granicach minimalnego i maksymalnego limitu.
* Komunikat o bdzie: `malloc(): memory corruption`
* **Sprawdzenie sp贸jnoci unsorted bin (pierwszy scenariusz)**:
* Podczas wstawiania pozostaego kawaka do unsorted bin, sprawd藕, czy `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Komunikat o bdzie: `malloc(): corrupted unsorted chunks`
* **Sprawdzenie sp贸jnoci unsorted bin (drugi scenariusz)**:
* To samo co poprzednie sprawdzenie, ale wywoywane podczas wstawiania po podziale szybkiego lub maego kawaka.
* Komunikat o bdzie: `malloc(): corrupted unsorted chunks 2`

## \_int\_free

Ta funkcja zwalnia wczeniej zaalokowan pami. Sprawdzenia tutaj pomagaj zapewni waciwe zwalnianie pamici i zapobiegaj uszkodzeniom pamici.

* **Sprawdzenie granic wska藕nika**:
* Upewnij si, 偶e zwalniany wska藕nik nie owija si wok贸 pamici.
* Komunikat o bdzie: `free(): invalid pointer`
* **Sprawdzenie rozmiaru**:
* Upewnij si, 偶e rozmiar zwalnianego kawaka wynosi co najmniej `MINSIZE` lub jest wielokrotnoci `MALLOC_ALIGNMENT`.
* Komunikat o bdzie: `free(): invalid size`
* **Sprawdzenie rozmiaru fastbin**:
* Dla kawak贸w fastbin, upewnij si, 偶e rozmiar nastpnego kawaka mieci si w granicach minimalnego i maksymalnego limitu.
* Komunikat o bdzie: `free(): invalid next size (fast)`
* **Sprawdzenie podw贸jnego zwalniania fastbin**:
* Podczas wstawiania kawaka do fastbin, upewnij si, 偶e kawaek na pocztku nie jest taki sam jak ten, kt贸ry jest wstawiany.
* Komunikat o bdzie: `double free or corruption (fasttop)`
* **Sprawdzenie sp贸jnoci fastbin**:
* Podczas wstawiania do fastbin, upewnij si, 偶e rozmiary kawaka g贸wnego i wstawianego kawaka s takie same.
* Komunikat o bdzie: `invalid fastbin entry (free)`
* **Sprawdzenie sp贸jnoci top chunk**:
* Dla kawak贸w niebdcych fastbin, upewnij si, 偶e kawaek nie jest taki sam jak top chunk.
* Komunikat o bdzie: `double free or corruption (top)`
* **Sprawdzenie granic pamici**:
* Upewnij si, 偶e nastpny kawaek pamici mieci si w granicach areny.
* Komunikat o bdzie: `double free or corruption (out)`
* **Sprawdzenie bitu prev\_inuse**:
* Upewnij si, 偶e bit poprzednio u偶ywany w nastpnym kawaku jest oznaczony.
* Komunikat o bdzie: `double free or corruption (!prev)`
* **Sprawdzenie normalnego rozmiaru**:
* Upewnij si, 偶e rozmiar nastpnego kawaka mieci si w prawidowym zakresie.
* Komunikat o bdzie: `free(): invalid next size (normal)`
* **Sprawdzenie sp贸jnoci unsorted bin**:
* Podczas wstawiania poczonego kawaka do unsorted bin, sprawd藕, czy `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Komunikat o bdzie: `free(): corrupted unsorted chunks`

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
