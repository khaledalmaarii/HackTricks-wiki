# Einherjarä¹‹å±‹

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

### ä»£ç 

* æŸ¥çœ‹ç¤ºä¾‹ï¼š[https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

### ç›®æ ‡

* ç›®æ ‡æ˜¯åœ¨å‡ ä¹ä»»æ„ç‰¹å®šåœ°å€ä¸Šåˆ†é…å†…å­˜ã€‚

### è¦æ±‚

* é€šè¿‡ä¸‹ä¸€ä¸ªå—çš„å¤´éƒ¨çš„ä¸€ä¸ªåç§»é‡æ¥ä¿®æ”¹å‰ä¸€ä¸ªå—çš„ä½¿ç”¨æƒ…å†µ
* èƒ½å¤Ÿä¿®æ”¹`prev_size`æ•°æ®ï¼Œè¿™æ˜¯å½“å‰å—çš„ä¸€éƒ¨åˆ†ï¼ˆä½äºæœ«å°¾ï¼‰
* å †æ³„æ¼

### æ”»å‡»

* åœ¨å—æ”»å‡»è€…æ§åˆ¶çš„å—å†…åˆ›å»ºä¸€ä¸ª`A`å‡å—ï¼Œå°†`fd`å’Œ`bk`æŒ‡å‘åŸå§‹å—ä»¥ç»•è¿‡ä¿æŠ¤
* åˆ›å»ºå¦å¤–2ä¸ªå—ï¼ˆ`B`å’Œ`C`ï¼‰
* åˆ©ç”¨`B`ä¸­çš„ä¸€ä¸ªåç§»é‡ï¼Œæ¸…é™¤`prev in use`ä½å¹¶ç”¨`C`å—åˆ†é…çš„ä½ç½®ä¸ä¹‹å‰ç”Ÿæˆçš„å‡`A`å—ä¹‹é—´çš„å·®å¼‚è¦†ç›–`prev_size`æ•°æ®
* è¿™ä¸ª`prev_size`å’Œå‡å—`A`çš„å¤§å°å¿…é¡»ç›¸åŒä»¥ç»•è¿‡æ£€æŸ¥
* ç„¶åå¡«å……Tcache
* ç„¶åé‡Šæ”¾`C`ï¼Œä½¿å…¶ä¸å‡å—`A`åˆå¹¶
* ç„¶ååˆ›å»ºä¸€ä¸ªæ–°å—`D`ï¼Œå®ƒå°†ä»å‡`A`å—å¼€å§‹å¹¶è¦†ç›–`B`å—
* ç„¶åé‡Šæ”¾`B`ï¼Œå¹¶å°†å…¶`fd`è¦†ç›–ä¸ºç›®æ ‡åœ°å€ï¼Œä½¿å…¶æŒ‡å‘ç›®æ ‡åœ°å€ï¼Œåˆ©ç”¨åŒ…å«å®ƒçš„`D`å—
* ç„¶åè¿›è¡Œ2æ¬¡mallocï¼Œå› ä¸ºç¬¬äºŒæ¬¡mallocå°†åŒ…å«ç›®æ ‡åœ°å€

## å‚è€ƒèµ„æ–™

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
