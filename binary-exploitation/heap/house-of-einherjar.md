# Einherjar Evi

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

### Kod

* Ã–rneÄŸi [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c) adresinden kontrol edin

### AmaÃ§

* Hemen hemen her belirli adrese bellek tahsis etmek.

### Gereksinimler

* Ã–nceki kullanÄ±mdaki baÅŸlÄ±k Ã¼zerinde bir hata ile bir sonraki parÃ§anÄ±n `prev`'ini deÄŸiÅŸtirmek
* Mevcut parÃ§anÄ±n bir parÃ§asÄ± olan `prev_size` verilerini deÄŸiÅŸtirebilmek (sonunda)
* Heap sÄ±zÄ±ntÄ±sÄ±

### SaldÄ±rÄ±

* SaldÄ±rgan tarafÄ±ndan kontrol edilen bir parÃ§anÄ±n iÃ§inde `fd` ve `bk` ile orijinal parÃ§aya iÅŸaret eden sahte bir parÃ§a (`A`) oluÅŸturulur ve korumalarÄ± atlamak iÃ§in
* 2 diÄŸer parÃ§a (`B` ve `C`) oluÅŸturulur.
* `B`'deki bir hata kullanÄ±larak `prev in use` biti temizlenir ve `C` parÃ§asÄ±nÄ±n tahsis edildiÄŸi yer ile Ã¶nceden oluÅŸturulan sahte `A` parÃ§asÄ± arasÄ±ndaki farkla `prev_size` verileri Ã¼zerine yazÄ±lÄ±r.
* Bu `prev_size` ve sahte parÃ§a `A`'nÄ±n boyutu, kontrolleri atlamak iÃ§in aynÄ± olmalÄ±dÄ±r.
* ArdÄ±ndan, Tcache doldurulur
* ArdÄ±ndan, `C` serbest bÄ±rakÄ±lÄ±r, bÃ¶ylece sahte parÃ§a `A` ile birleÅŸir
* ArdÄ±ndan, sahte `A` parÃ§asÄ±nda baÅŸlayacak ve `B` parÃ§asÄ±nÄ± kaplayacak yeni bir parÃ§a `D` oluÅŸturulur
* ArdÄ±ndan, `B` serbest bÄ±rakÄ±lÄ±r ve `fd`si hedef adres olarak Ã¼zerine yazÄ±lÄ±r, bÃ¶ylece iÃ§eren `D` parÃ§asÄ±nÄ± kullanarak hedef adresi iÅŸaret eder.
* ArdÄ±ndan, 2 malloc yapÄ±lÄ±r Ã§Ã¼nkÃ¼ ikincisi hedef adresi iÃ§erecektir

## Referanslar

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)
