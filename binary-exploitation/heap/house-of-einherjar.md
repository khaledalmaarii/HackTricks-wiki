# House of Einherjar

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong>!</summary>

ë‹¤ë¥¸ HackTricks ì§€ì› ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•˜ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œë¡œ PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## ê¸°ë³¸ ì •ë³´

### ì½”ë“œ

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)ì—ì„œ ì˜ˆì œë¥¼ í™•ì¸í•˜ì„¸ìš”.

### ëª©í‘œ

* ê±°ì˜ ëª¨ë“  íŠ¹ì • ì£¼ì†Œì— ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

### ìš”êµ¬ ì‚¬í•­

* ë‹¤ìŒ ì²­í¬ì˜ í—¤ë”ì—ì„œ í•˜ë‚˜ê°€ ë¶€ì¡±í•˜ì—¬ `prev in use`ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
* í˜„ì¬ ì²­í¬ì˜ ì¼ë¶€ì¸ `prev_size` ë°ì´í„°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
* í™ ëˆ„ìˆ˜

### ê³µê²©

* ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ì²­í¬ ë‚´ì— `fd`ì™€ `bk`ë¥¼ ê°€ë¦¬í‚¤ëŠ” ê°€ì§œ ì²­í¬ `A`ê°€ ìƒì„±ë˜ì–´ ë³´í˜¸ ê¸°ëŠ¥ì„ ìš°íšŒí•©ë‹ˆë‹¤.
* ë‹¤ë¥¸ 2ê°œì˜ ì²­í¬(`B` ë° `C`)ê°€ ìƒì„±ë©ë‹ˆë‹¤.
* `B`ì—ì„œì˜ off by oneì„ ì•…ìš©í•˜ì—¬ `prev in use` ë¹„íŠ¸ê°€ ì§€ì›Œì§€ê³  `prev_size` ë°ì´í„°ê°€ `C` ì²­í¬ê°€ í• ë‹¹ëœ ìœ„ì¹˜ì™€ ì´ì „ì— ìƒì„±ëœ ê°€ì§œ `A` ì²­í¬ ì‚¬ì´ì˜ ì°¨ì´ë¡œ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤.
* ì´ `prev_size`ì™€ ê°€ì§œ ì²­í¬ `A`ì˜ í¬ê¸°ëŠ” ì²´í¬ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ, Tcacheê°€ ì±„ì›Œì§‘ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ, `C`ê°€ í•´ì œë˜ì–´ ê°€ì§œ ì²­í¬ `A`ì™€ í†µí•©ë©ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ, ê°€ì§œ `A` ì²­í¬ì—ì„œ ì‹œì‘í•˜ê³  `B` ì²­í¬ë¥¼ í¬í•¨í•˜ëŠ” ìƒˆë¡œìš´ ì²­í¬ `D`ê°€ ìƒì„±ë©ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ, `B`ê°€ í•´ì œë˜ê³  `fd`ê°€ ëŒ€ìƒ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤. ì´ëŠ” ê·¸ê²ƒì„ í¬í•¨í•˜ëŠ” `D` ì²­í¬ë¥¼ ì•…ìš©í•©ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ, ëŒ€ìƒ ì£¼ì†Œë¥¼ í¬í•¨í•˜ëŠ” ë‘ ë²ˆì˜ mallocê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong>!</summary>

ë‹¤ë¥¸ HackTricks ì§€ì› ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•˜ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œë¡œ PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
