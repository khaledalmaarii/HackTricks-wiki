# Einherjar Evi

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

### Kod

* Ã–rneÄŸi kontrol edin [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)
* Veya ÅŸu adresten bakÄ±n [https://guyinatuxedo.github.io/42-house\_of\_einherjar/house\_einherjar\_exp/index.html#house-of-einherjar-explanation](https://guyinatuxedo.github.io/42-house\_of\_einherjar/house\_einherjar\_exp/index.html#house-of-einherjar-explanation) (tcache'yi doldurmanÄ±z gerekebilir)

### AmaÃ§

* Hemen hemen herhangi bir belirli adreste bellek tahsis etmek.

### Gereksinimler

* Bir parÃ§a tahsis etmek istediÄŸimizde sahte bir parÃ§a oluÅŸturun:
* Kontrol noktalarÄ±nÄ± kendisine iÅŸaret etmek iÃ§in iÅŸaretÃ§ileri ayarlayÄ±n
* Bir parÃ§adan diÄŸerine bir tane eksik olacak ÅŸekilde yanlÄ±ÅŸlÄ±kla geÃ§in ve Ã¶nceki kullanÄ±mda deÄŸiÅŸiklik yapÄ±n
* YanlÄ±ÅŸlÄ±kla yanlÄ±ÅŸ kullanÄ±lan parÃ§anÄ±n `prev_size`'Ä±na kendisi ile sahte parÃ§a arasÄ±ndaki farkÄ± gÃ¶sterin
* Sahte parÃ§a boyutu da kontrol noktalarÄ±nÄ± atlamak iÃ§in aynÄ± boyutta olmalÄ±dÄ±r
* Bu parÃ§alarÄ± oluÅŸturmak iÃ§in bir heap sÄ±zÄ±ntÄ±sÄ±na ihtiyacÄ±nÄ±z olacak.

### SaldÄ±rÄ±

* SaldÄ±rgan tarafÄ±ndan kontrol edilen bir parÃ§anÄ±n iÃ§ine `A` sahte bir parÃ§a oluÅŸturulur ve korumalarÄ± atlamak iÃ§in `fd` ve `bk` ile orijinal parÃ§aya iÅŸaret eder
* 2 diÄŸer parÃ§a (`B` ve `C`) tahsis edilir
* `B`'deki yanlÄ±ÅŸlÄ±k kullanÄ±larak `prev in use` biti temizlenir ve `C` parÃ§asÄ±nÄ±n tahsis edildiÄŸi yer ile Ã¶nce oluÅŸturulan sahte `A` parÃ§asÄ± arasÄ±ndaki farkla `prev_size` verisi Ã¼zerine yazÄ±lÄ±r
* Bu `prev_size` ve sahte parÃ§adaki boyut aynÄ± olmalÄ±dÄ±r kontrol noktalarÄ±nÄ± atlamak iÃ§in.
* Sonra, tcache doldurulur
* Sonra, `C` serbest bÄ±rakÄ±lÄ±r bÃ¶ylece sahte parÃ§a `A` ile birleÅŸir
* Sonra, sahte `A` parÃ§asÄ±nda baÅŸlayacak ve `B` parÃ§ayÄ± kapsayacak yeni bir parÃ§a `D` oluÅŸturulur
* Einherjar Evi burada biter
* Bu, hÄ±zlÄ± bin saldÄ±rÄ±sÄ± ile devam ettirilebilir:
* `B`'yi serbest bÄ±rakarak hÄ±zlÄ± bine ekleyin
* `B`'nin `fd`si Ã¼zerine yazÄ±larak hedef adresi hedefleyen `D` parÃ§asÄ±nÄ± (Ã§Ã¼nkÃ¼ iÃ§inde `B` bulunmaktadÄ±r) iÅŸaret eder
* Sonra, 2 malloc yapÄ±lÄ±r ve ikincisi **hedef adresi tahsis edecek**

## Referanslar ve diÄŸer Ã¶rnekler

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)
* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_einherjar/#2016-seccon-tinypad](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_einherjar/#2016-seccon-tinypad)
* Ä°ÅŸaretÃ§ileri sÄ±fÄ±rlamadÄ±ÄŸÄ±nÄ±zda serbest bÄ±rakÄ±ldÄ±ktan sonra, verilerine hala eriÅŸmek mÃ¼mkÃ¼ndÃ¼r. Bu nedenle, bir parÃ§a sÄ±ralanmamÄ±ÅŸ kutuya yerleÅŸtirilir ve iÃ§erdiÄŸi iÅŸaretÃ§iler sÄ±zdÄ±rÄ±lÄ±r (libc sÄ±zÄ±ntÄ±sÄ±) ve ardÄ±ndan bir yeni heap sÄ±ralanmamÄ±ÅŸ kutuya yerleÅŸtirilir ve aldÄ±ÄŸÄ± iÅŸaretÃ§iden bir heap adresi sÄ±zdÄ±rÄ±lÄ±r.
