# Bir birim taÅŸmasÄ±

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±) ile sÄ±fÄ±rdan kahramana kadar AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

YalnÄ±zca 1B birim taÅŸmasÄ±na eriÅŸim saÄŸlamak, saldÄ±rganÄ±n Ã¶nceki boyut meta veri bilgisini deÄŸiÅŸtirmesine olanak tanÄ±r, bÃ¶ylece hangi parÃ§alarÄ±n gerÃ§ekten serbest bÄ±rakÄ±ldÄ±ÄŸÄ±nÄ± deÄŸiÅŸtirerek sonunda baÅŸka bir meÅŸru parÃ§a iÃ§eren bir parÃ§a oluÅŸturur.

### Kod Ã–rneÄŸi:

* [https://github.com/DhavalKapil/heap-exploitation/blob/d778318b6a14edad18b20421f5a06fa1a6e6920e/assets/files/shrinking\_free\_chunks.c](https://github.com/DhavalKapil/heap-exploitation/blob/d778318b6a14edad18b20421f5a06fa1a6e6920e/assets/files/shrinking\_free\_chunks.c)
* Bu saldÄ±rÄ± artÄ±k Tcaches kullanÄ±mÄ± nedeniyle Ã§alÄ±ÅŸmÄ±yor.
* AyrÄ±ca, daha bÃ¼yÃ¼k parÃ§alar kullanarak (bu durumda tcaches devreye girmez), hata alÄ±rsÄ±nÄ±z: `malloc(): invalid next size (unsorted)`

### AmaÃ§

* Bir parÃ§anÄ±n baÅŸka bir parÃ§anÄ±n iÃ§inde bulunmasÄ±nÄ± saÄŸlamak, bÃ¶ylece ikinci parÃ§anÄ±n Ã¼zerinde yazma eriÅŸimi, iÃ§erilen parÃ§ayÄ± Ã¼zerine yazmaya olanak tanÄ±r

### Gereksinimler

* Ã–nceki boyut meta veri bilgisini deÄŸiÅŸtirmek iÃ§in bir birim taÅŸmasÄ±
* 3 bellek parÃ§asÄ± (a, b, c) ardÄ±ÅŸÄ±k olarak ayrÄ±lmÄ±ÅŸtÄ±r. ArdÄ±ndan ortadaki parÃ§a serbest bÄ±rakÄ±lÄ±r. Ä°lk parÃ§a bir birim taÅŸmasÄ± gÃ¼venlik aÃ§Ä±ÄŸÄ±na sahiptir ve saldÄ±rgan bunu 0x00 ile kÃ¶tÃ¼ye kullanÄ±r (Ã¶nceki bayt 0x10 ise, ortadaki parÃ§anÄ±n gerÃ§ekte olduÄŸundan 0x10 daha kÃ¼Ã§Ã¼k olduÄŸunu gÃ¶sterir).
* Daha sonra, ortadaki serbest bÄ±rakÄ±lan parÃ§ada (b) 2 daha kÃ¼Ã§Ã¼k parÃ§a ayrÄ±lÄ±r, ancak `b + b->boyut` c parÃ§asÄ±nÄ± gÃ¼ncellemez Ã§Ã¼nkÃ¼ iÅŸaret edilen adres olmasÄ± gerektiÄŸinden daha kÃ¼Ã§Ã¼ktÃ¼r.
* Daha sonra, b1 ve c serbest bÄ±rakÄ±lÄ±r. `c - c->prev_size` hala b'yi (ÅŸimdi b1) iÅŸaret ettiÄŸi iÃ§in, her ikisi de birleÅŸtirilir. Ancak, b2 hala b1 ve c arasÄ±nda iÃ§indedir.
* Son olarak, bu bellek alanÄ±nÄ± geri kazanmak iÃ§in yeni bir malloc iÅŸlemi gerÃ§ekleÅŸtirilir, bu da yeni malloc sahibinin b2 iÃ§eriÄŸini kontrol etmesine olanak tanÄ±r.

Bu resim saldÄ±rÄ±yÄ± mÃ¼kemmel bir ÅŸekilde aÃ§Ä±klar:

<figure><img src="../../.gitbook/assets/image (1247).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/shrinking_free_chunks">https://heap-exploitation.dhavalkapil.com/attacks/shrinking_free_chunks</a></p></figcaption></figure>

## Referanslar

* [https://heap-exploitation.dhavalkapil.com/attacks/shrinking\_free\_chunks](https://heap-exploitation.dhavalkapil.com/attacks/shrinking\_free\_chunks)

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±) ile sÄ±fÄ±rdan kahramana kadar AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
