# ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ Heap

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Hacking Ï„Î¿Ï… AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Hacking Ï„Î¿Ï… GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ÏƒÏ„Î·Î½ ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>
{% endhint %}

## unlink

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="unlink.md" %}
[unlink.md](unlink.md)
{% endcontent-ref %}

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏÎ½Î¿ÏˆÎ· Ï„Ï‰Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ ÎµÎ»Î­Î³Ï‡Ï‰Î½:

* ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎµÎ¬Î½ Ï„Î¿ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¯Î´Î¹Î¿ Î¼Îµ Ï„Î¿ `prev_size` Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `corrupted size vs. prev_size`
* ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÏŒÏ„Î¹ `P->fd->bk == P` ÎºÎ±Î¹ `P->bk->fw == P`
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `corrupted double-linked list`
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î¼Î¹ÎºÏÏŒ, ÎµÎ»Î­Î³Î¾Ï„Îµ ÏŒÏ„Î¹ `P->fd_nextsize->bk_nextsize == P` ÎºÎ±Î¹ `P->bk_nextsize->fd_nextsize == P`
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `corrupted double-linked list (not small)`

## \_int\_malloc

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="malloc-and-sysmalloc.md" %}
[malloc-and-sysmalloc.md](malloc-and-sysmalloc.md)
{% endcontent-ref %}

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ fast bin:**
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): unaligned fastbin chunk detected 2`
* Î•Î¬Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): unaligned fastbin chunk detected`
* Î•Î¬Î½ Ï„Î¿ ÎµÏ€Î¹ÏƒÏ„ÏÎµÏ†ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î­Ï‡ÎµÎ¹ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï€Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ Î»ÏŒÎ³Ï‰ Ï„Î·Ï‚ Î¸Î­ÏƒÎ·Ï‚ Ï„Î¿Ï… ÏƒÏ„Î¿ fast bin:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): memory corruption (fast)`
* Î•Î¬Î½ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Î³ÎµÎ¼Î¯ÏƒÎµÎ¹ Ï„Î¿ tcache Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): unaligned fastbin chunk detected 3`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ small bin:**
* Î•Î¬Î½ `victim->bk->fd != victim`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): smallbin double linked list corrupted`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· ÏƒÏ…Î³Ï‡ÏÎ½ÎµÏ…ÏƒÎ·** Ï€Î¿Ï… Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ fast bin:&#x20;
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc_consolidate(): unaligned fastbin chunk detected`
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î¸Î± Î­Ï€ÏÎµÏ€Îµ Î»ÏŒÎ³Ï‰ Ï„Î·Ï‚ Î¸Î­ÏƒÎ·Ï‚ Ï„Î¿Ï…:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc_consolidate(): invalid chunk size`
* Î•Î¬Î½ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ· ÎºÎ±Î¹ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ prev\_chunk:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `corrupted size vs. prev_size in fastbins`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ unsorted bin**:
* Î•Î¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÎ¬Î¾ÎµÎ½Î¿ (Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ Î® Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿):&#x20;
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): invalid size (unsorted)`
* Î•Î¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÎ¬Î¾ÎµÎ½Î¿ (Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ Î® Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿):
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): invalid next size (unsorted)`
* Î•Î¬Î½ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´Î¹Î±Ï†Î­ÏÎµÎ¹ Î±Ï€ÏŒ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): mismatching next->prev_size (unsorted)`
* Î•Î¬Î½ Î´ÎµÎ½ Î¹ÏƒÏ‡ÏÎµÎ¹ `victim->bck->fd == victim` Î® Î´ÎµÎ½ Î¹ÏƒÏ‡ÏÎµÎ¹ `victim->fd == av (arena)`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): unsorted double linked list corrupted`
* ÎšÎ±Î¸ÏÏ‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Î¼Îµ Ï€Î¬Î½Ï„Î± Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿, Ï„Î¿ fd Ï„Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€Î¬Î½Ï„Î± ÏƒÏ„Î· Î´Î¿Î¼Î® arena.
* Î•Î¬Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ·:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): invalid next->prev_inuse (unsorted)`
* Î•Î¬Î½ `fwd->bk_nextsize->fd_nextsize != fwd`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): largebin double linked list corrupted (nextsize)`
* Î•Î¬Î½ `fwd->bk->fd != fwd`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): largebin double linked list corrupted (bk)`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ large bin (Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ ÎµÏ…ÏÎµÏ„Î®ÏÎ¹Î¿)**:
* `bck->fd-> bk != bck`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): corrupted unsorted chunks`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ large bin (ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿)**:
* `bck->fd-> bk != bck`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): corrupted unsorted chunks2`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚ Top chunk**:
* `chunksize(av->top) > av->system_mem`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): corrupted top size`

## `tcache_get_n`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `tcache_get_n`:**
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc(): unaligned tcache chunk detected`

## `tcache_thread_shutdown`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `tcache_thread_shutdown`:**
* Î•Î¬Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `tcache_thread_shutdown(): unaligned tcache chunk detected`

## `__libc_realloc`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `__libc_realloc`:**
* Î•Î¬Î½ Ï„Î¿ Ï€Î±Î»Î¹ÏŒ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒÏ‚ Î® Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î®Ï„Î±Î½ ÎµÏƒÏ†Î±Î»Î¼Î­Î½Î¿:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `realloc(): invalid pointer`

## `_int_free`

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="free.md" %}
[free.md](free.md)
{% endcontent-ref %}

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î­Î½Î±ÏÎ¾Î· Ï„Î¿Ï… `_int_free`:**
* ÎŸ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒÏ‚:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): invalid pointer`
* ÎœÎ­Î³ÎµÎ¸Î¿Ï‚ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Ï„Î¿ `MINSIZE` ÎºÎ±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): invalid size`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `_int_free` tcache:**
* Î•Î¬Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï„Î¿ `mp_.tcache_count`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): too many chunks detected in tcache`
* Î•Î¬Î½ Î· ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¹ÎºÎ®:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): unaligned chunk detected in tcache 2`
* Î•Î¬Î½ Ï„Î¿ Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¼Î­Î½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎµÎ¯Ï‡Îµ Î®Î´Î· Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¸ÎµÎ¯ ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï‰Ï‚ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÏƒÏ„Î¿ tcache:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): double free detected in tcache 2`
* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `_int_free` fast bin:**
* Î•Î¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Î¼Î· Î­Î³ÎºÏ…ÏÎ¿ (Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿ Î® Î¼Î¹ÎºÏÏŒ) ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): invalid next size (fast)`
* Î•Î¬Î½ Ï„Î¿ Ï€ÏÎ¿ÏƒÏ„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î®Ï„Î±Î½ Î®Î´Î· ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® Ï„Î¿Ï… fast bin:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `double free or corruption (fasttop)`
* Î•Î¬Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î±Ï€ÏŒ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î¼Îµ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `invalid fastbin entry (free)`
## **`_int_free_merge_chunk`**

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `_int_free_merge_chunk`:**
* Î‘Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `double free or corruption (top)`
* Î‘Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î­Î¾Ï‰ Î±Ï€ÏŒ Ï„Î± ÏŒÏÎ¹Î± Ï„Î·Ï‚ Î±ÏÎ­Î½Î±Ï‚:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `double free or corruption (out)`
* Î‘Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎ·Î¼Î±ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î¿ Ï‰Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ (ÏƒÏ„Î¿ prev\_inuse Î±Ï€ÏŒ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹):
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `double free or corruption (!prev)`
* Î‘Î½ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ Î® Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): invalid next size (normal)`
* Î‘Î½ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ·, Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÏƒÎµÎ¹. Î‘Î»Î»Î¬, Î±Î½ Ï„Î¿ `prev_size` Î´Î¹Î±Ï†Î­ÏÎµÎ¹ Î±Ï€ÏŒ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `corrupted size vs. prev_size while consolidating`

## **`_int_free_create_chunk`**

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `_int_free_create_chunk`:**
* Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎµÎ½ÏŒÏ‚ ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÏƒÏ„Î¿Î½ Î¼Î· Ï„Î±Î¾Î¹Î½Î¿Î¼Î·Î¼Î­Î½Î¿ ÎºÎ¬Î´Î¿, ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Î½ `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `free(): corrupted unsorted chunks`

## `do_check_malloc_state`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `do_check_malloc_state`:**
* Î‘Î½ Ï„Î¿ fast bin chunk Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÎµÏ…Î¸Ï…Î³ÏÎ±Î¼Î¼Î¹ÏƒÎ¼Î­Î½Î¿:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `do_check_malloc_state(): unaligned fastbin chunk detected`

## `malloc_consolidate`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `malloc_consolidate`:**
* Î‘Î½ Ï„Î¿ fast bin chunk Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÎµÏ…Î¸Ï…Î³ÏÎ±Î¼Î¼Î¹ÏƒÎ¼Î­Î½Î¿:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc_consolidate(): unaligned fastbin chunk detected`
* Î‘Î½ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… fast bin chunk Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `malloc_consolidate(): invalid chunk size`

## `_int_realloc`

* **ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ ÏƒÏ„Î¿ `_int_realloc`:**
* Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿ Î® Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `realloc(): invalid old size`
* Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î¿ Î® Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ:
* ÎœÎ®Î½Ï…Î¼Î± ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚: `realloc(): invalid next size`
