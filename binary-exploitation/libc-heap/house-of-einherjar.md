# Einherjarä¹‹å±‹

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)çš„æ”¶è—
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

### ä»£ç 

* æŸ¥çœ‹ç¤ºä¾‹ï¼š[https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)
* æˆ–è€…æŸ¥çœ‹ï¼š[https://guyinatuxedo.github.io/42-house\_of\_einherjar/house\_einherjar\_exp/index.html#house-of-einherjar-explanation](https://guyinatuxedo.github.io/42-house\_of\_einherjar/house\_einherjar\_exp/index.html#house-of-einherjar-explanation)ï¼ˆæ‚¨å¯èƒ½éœ€è¦å¡«å……tcacheï¼‰

### ç›®æ ‡

* ç›®æ ‡æ˜¯åœ¨å‡ ä¹ä»»æ„ç‰¹å®šåœ°å€ä¸Šåˆ†é…å†…å­˜ã€‚

### è¦æ±‚

* å½“æˆ‘ä»¬æƒ³è¦åˆ†é…ä¸€ä¸ªå—æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªå‡å—ï¼š
* è®¾ç½®æŒ‡é’ˆæŒ‡å‘è‡ªèº«ä»¥ç»•è¿‡å®Œæ•´æ€§æ£€æŸ¥
* é€šè¿‡ä¸€ä¸ªå—åˆ°ä¸‹ä¸€ä¸ªå—çš„ä¸€ä¸ªå­—èŠ‚æº¢å‡ºï¼Œä½¿ç”¨ç©ºå­—èŠ‚ä¿®æ”¹`PREV_INUSE`æ ‡å¿—ã€‚
* åœ¨è¢«æ»¥ç”¨çš„å—çš„`prev_size`ä¸­æŒ‡ç¤ºè‡ªèº«ä¸å‡å—ä¹‹é—´çš„å·®å¼‚
* å‡å—çš„å¤§å°ä¹Ÿå¿…é¡»è®¾ç½®ä¸ºç›¸åŒçš„å¤§å°ä»¥ç»•è¿‡å®Œæ•´æ€§æ£€æŸ¥
* è¦æ„é€ è¿™äº›å—ï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªå †æ³„æ¼ã€‚

### æ”»å‡»

* æ”»å‡»è€…åœ¨å—æ”»å‡»è€…æ§åˆ¶çš„å—å†…åˆ›å»ºä¸€ä¸ªå‡å—ï¼Œç”¨`fd`å’Œ`bk`æŒ‡å‘åŸå§‹å—ä»¥ç»•è¿‡ä¿æŠ¤
* åˆ†é…2ä¸ªå…¶ä»–å—ï¼ˆ`B`å’Œ`C`ï¼‰
* åœ¨`B`ä¸­æ»¥ç”¨`prev in use`ï¼Œæ¸…é™¤`prev_size`æ•°æ®ï¼Œå¹¶ç”¨`C`å—åˆ†é…çš„ä½ç½®ä¸ä¹‹å‰ç”Ÿæˆçš„å‡`A`å—ä¹‹é—´çš„å·®å¼‚è¿›è¡Œè¦†ç›–
* è¿™ä¸ª`prev_size`å’Œå‡å—`A`ä¸­çš„å¤§å°å¿…é¡»ç›¸åŒä»¥ç»•è¿‡æ£€æŸ¥ã€‚
* ç„¶åï¼Œå¡«å……tcache
* ç„¶åï¼Œé‡Šæ”¾`C`ï¼Œä½¿å…¶ä¸å‡å—`A`åˆå¹¶
* ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªæ–°å—`D`ï¼Œå®ƒå°†ä»å‡`A`å—å¼€å§‹ï¼Œè¦†ç›–`B`å—
* Einherjarä¹‹å±‹åˆ°æ­¤ç»“æŸ
* è¿™å¯ä»¥ç»§ç»­è¿›è¡Œå¿«é€Ÿbinæ”»å‡»æˆ–Tcacheæ±¡æŸ“ï¼š
* é‡Šæ”¾`B`ä»¥å°†å…¶æ·»åŠ åˆ°å¿«é€Ÿbin / Tcache
* è¦†ç›–`B`çš„`fd`ï¼Œä½¿å…¶æŒ‡å‘ç›®æ ‡åœ°å€ï¼Œæ»¥ç”¨åŒ…å«`B`çš„`D`å—ï¼ˆå› ä¸ºå®ƒåŒ…å«`B`ï¼‰&#x20;
* ç„¶åï¼Œæ‰§è¡Œ2æ¬¡mallocï¼Œç¬¬äºŒæ¬¡å°†**åˆ†é…ç›®æ ‡åœ°å€**

## å‚è€ƒå’Œå…¶ä»–ç¤ºä¾‹

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)
* **CTF** [**https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_einherjar/#2016-seccon-tinypad**](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_einherjar/#2016-seccon-tinypad)
* é‡Šæ”¾æŒ‡é’ˆåï¼Œå®ƒä»¬æ²¡æœ‰è¢«ç½®ç©ºï¼Œå› æ­¤ä»ç„¶å¯ä»¥è®¿é—®å®ƒä»¬çš„æ•°æ®ã€‚å› æ­¤ï¼Œåœ¨æœªæ’åºçš„binä¸­æ”¾ç½®ä¸€ä¸ªå—ï¼Œå¹¶æ³„æ¼å®ƒåŒ…å«çš„æŒ‡é’ˆï¼ˆlibcæ³„æ¼ï¼‰ï¼Œç„¶ååœ¨æœªæ’åºçš„binä¸­æ”¾ç½®ä¸€ä¸ªæ–°å †ï¼Œå¹¶ä»å®ƒè·å¾—çš„æŒ‡é’ˆæ³„æ¼ä¸€ä¸ªå †åœ°å€ã€‚
* [**baby-talk. DiceCTF 2024**](https://7rocky.github.io/en/ctf/other/dicectf/baby-talk/)
* `strtok`ä¸­çš„ç©ºå­—èŠ‚æº¢å‡ºæ¼æ´ã€‚
* ä½¿ç”¨Einherjarä¹‹å±‹è·å–é‡å å—æƒ…å†µï¼Œå¹¶æœ€ç»ˆé€šè¿‡Tcacheæ±¡æŸ“è·å¾—ä»»æ„å†™å…¥æƒé™ã€‚
