# House of Lore | Small bin Attack

{% hint style="success" %}
AWS Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

### Kod

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/) adresinden kontrol edin
* Bu Ã§alÄ±ÅŸmÄ±yor
* Veya: [https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c)
* Bu, bazÄ± kontrolleri atlamaya Ã§alÄ±ÅŸsa da Ã§alÄ±ÅŸmÄ±yor ve `malloc(): unaligned tcache chunk detected` hatasÄ±nÄ± alÄ±yor
* Bu Ã¶rnek hala Ã§alÄ±ÅŸÄ±yor: [**https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html**](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)&#x20;

### AmaÃ§

* **KÃ¼Ã§Ã¼k binde sahte bir kÃ¼Ã§Ã¼k parÃ§a ekleyerek onu tahsis etmek mÃ¼mkÃ¼n hale gelir.**\
Eklenen kÃ¼Ã§Ã¼k parÃ§a, saldÄ±rganÄ±n oluÅŸturduÄŸu sahte parÃ§adÄ±r ve rastgele bir konumda sahte deÄŸildir.

### Gereksinimler

* 2 sahte parÃ§a oluÅŸturun ve bunlarÄ± birbirine ve kÃ¼Ã§Ã¼k bindeki meÅŸru parÃ§aya baÄŸlayÄ±n:
* `fake0.bk` -> `fake1`
* `fake1.fd` -> `fake0`
* `fake0.fd` -> `legit` (baÅŸka bir zayÄ±flÄ±k aracÄ±lÄ±ÄŸÄ±yla serbest bÄ±rakÄ±lan kÃ¼Ã§Ã¼k bin parÃ§asÄ±ndaki bir iÅŸaretÃ§iyi deÄŸiÅŸtirmeniz gerekir)
* `legit.bk` -> `fake0`

Daha sonra `fake0`'Ä± tahsis edebileceksiniz.

### SaldÄ±rÄ±

* Bir kÃ¼Ã§Ã¼k parÃ§a (`legit`) tahsis edilir, ardÄ±ndan Ã¼st parÃ§ayla birleÅŸmesini Ã¶nlemek iÃ§in baÅŸka bir parÃ§a tahsis edilir. ArdÄ±ndan, `legit` serbest bÄ±rakÄ±lÄ±r (onu sÄ±ralanmamÄ±ÅŸ bin listesine taÅŸÄ±r) ve daha bÃ¼yÃ¼k bir parÃ§a tahsis edilir, **`legit`'i kÃ¼Ã§Ã¼k bine taÅŸÄ±r.**
* Bir saldÄ±rgan birkaÃ§ sahte kÃ¼Ã§Ã¼k parÃ§a oluÅŸturur ve gerekli baÄŸlantÄ±larÄ± yaparak saÄŸlamlÄ±k kontrollerini atlar:
* `fake0.bk` -> `fake1`
* `fake1.fd` -> `fake0`
* `fake0.fd` -> `legit` (baÅŸka bir zayÄ±flÄ±k aracÄ±lÄ±ÄŸÄ±yla serbest bÄ±rakÄ±lan kÃ¼Ã§Ã¼k bin parÃ§asÄ±ndaki bir iÅŸaretÃ§iyi deÄŸiÅŸtirmeniz gerekir)
* `legit.bk` -> `fake0`
* `legit`'i almak iÃ§in bir kÃ¼Ã§Ã¼k parÃ§a tahsis edilir, **`fake0`**'Ä± kÃ¼Ã§Ã¼k parÃ§alarÄ±n Ã¼st listesine taÅŸÄ±r
* BaÅŸka bir kÃ¼Ã§Ã¼k parÃ§a tahsis edilir, `fake0`'Ä± bir parÃ§a olarak alÄ±r, potansiyel olarak iÃ§indeki iÅŸaretÃ§ileri okuma/yazma izni verir.

## Referanslar

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/)
* [https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore](https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore)
* [https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)

{% hint style="success" %}
AWS Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'Ä± Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
{% endhint %}
