# æ ˆæº¢å‡º

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## ä»€ä¹ˆæ˜¯æ ˆæº¢å‡º

**æ ˆæº¢å‡º**æ˜¯ä¸€ç§æ¼æ´ï¼Œå½“ç¨‹åºå‘æ ˆå†™å…¥çš„æ•°æ®è¶…è¿‡å…¶åˆ†é…çš„ç©ºé—´æ—¶å‘ç”Ÿã€‚è¿™äº›å¤šä½™çš„æ•°æ®å°†**è¦†ç›–ç›¸é‚»çš„å†…å­˜ç©ºé—´**ï¼Œå¯¼è‡´æœ‰æ•ˆæ•°æ®çš„æŸåï¼Œæ§åˆ¶æµçš„ä¸­æ–­ï¼Œä»¥åŠæ½œåœ¨åœ°æ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™ä¸ªé—®é¢˜é€šå¸¸æ˜¯ç”±äºä½¿ç”¨ä¸æ‰§è¡Œè¾“å…¥è¾¹ç•Œæ£€æŸ¥çš„ä¸å®‰å…¨å‡½æ•°è€Œå¼•èµ·çš„ã€‚

è¿™ç§è¦†ç›–çš„ä¸»è¦é—®é¢˜åœ¨äº**ä¿å­˜çš„æŒ‡ä»¤æŒ‡é’ˆï¼ˆEIP/RIPï¼‰**å’Œ**ä¿å­˜çš„åŸºæŒ‡é’ˆï¼ˆEBP/RBPï¼‰**ç”¨äºè¿”å›åˆ°å‰ä¸€ä¸ªå‡½æ•°çš„ä½ç½®æ˜¯**å­˜å‚¨åœ¨æ ˆä¸Š**çš„ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–è¿™äº›å†…å®¹å¹¶**æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹**ã€‚

è¿™ç§æ¼æ´é€šå¸¸æ˜¯å› ä¸ºä¸€ä¸ªå‡½æ•°**åœ¨æ ˆå†…å¤åˆ¶çš„å­—èŠ‚æ•°è¶…è¿‡äº†ä¸ºå…¶åˆ†é…çš„æ•°é‡**ï¼Œå› æ­¤èƒ½å¤Ÿè¦†ç›–æ ˆçš„å…¶ä»–éƒ¨åˆ†ã€‚

ä¸€äº›å¸¸è§çš„å®¹æ˜“å—åˆ°å½±å“çš„å‡½æ•°åŒ…æ‹¬ï¼š**`strcpy`ã€`strcat`ã€`sprintf`ã€`gets`**... åŒæ ·ï¼Œåƒ**`fgets`**ã€**`read`**å’Œ**`memcpy`**è¿™æ ·å¸¦æœ‰**é•¿åº¦å‚æ•°**çš„å‡½æ•°ï¼Œå¦‚æœæŒ‡å®šçš„é•¿åº¦å¤§äºåˆ†é…çš„é•¿åº¦ï¼Œå¯èƒ½ä¼šä»¥ä¸€ç§æ˜“å—æ”»å‡»çš„æ–¹å¼ä½¿ç”¨ã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹å‡½æ•°å¯èƒ½å­˜åœ¨æ¼æ´ï¼š
```c
void vulnerable() {
char buffer[128];
printf("Enter some text: ");
gets(buffer); // This is where the vulnerability lies
printf("You entered: %s\n", buffer);
}
```
### å¯»æ‰¾æ ˆæº¢å‡ºåç§»é‡

å‘ç°æ ˆæº¢å‡ºæœ€å¸¸è§çš„æ–¹æ³•æ˜¯è¾“å…¥å¤§é‡çš„ `A`ï¼ˆä¾‹å¦‚ `python3 -c 'print("A"*1000)'ï¼‰å¹¶æœŸæœ›å‡ºç° `Segmentation Fault`ï¼Œè¡¨æ˜å°è¯•è®¿é—®åœ°å€ `0x41414141`ã€‚

æ­¤å¤–ï¼Œä¸€æ—¦å‘ç°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œå°±éœ€è¦æ‰¾åˆ°åç§»é‡ï¼Œç›´åˆ°å¯ä»¥è¦†ç›–**è¿”å›åœ°å€**ï¼Œä¸ºæ­¤é€šå¸¸ä½¿ç”¨**å¾·å¸ƒé²å› åºåˆ—**ã€‚å¯¹äºå¤§å°ä¸º _k_ çš„å­—æ¯è¡¨å’Œé•¿åº¦ä¸º _n_ çš„å­åºåˆ—ï¼Œå¾·å¸ƒé²å› åºåˆ—æ˜¯ä¸€ä¸ª**å¾ªç¯åºåˆ—ï¼Œå…¶ä¸­æ¯ä¸ªå¯èƒ½çš„é•¿åº¦ä¸º _n_ çš„å­åºåˆ—**éƒ½æ°å¥½å‡ºç°ä¸€æ¬¡**ä½œä¸ºä¸€ä¸ªè¿ç»­çš„å­åºåˆ—ã€‚

è¿™æ ·ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ‰¾å‡ºæ§åˆ¶ EIP æ‰€éœ€çš„åç§»é‡ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªè¿™äº›åºåˆ—ä½œä¸ºå¡«å……ï¼Œç„¶åæ‰¾åˆ°æœ€ç»ˆè¦†ç›–å®ƒçš„å­—èŠ‚çš„åç§»é‡ã€‚

å¯ä»¥ä½¿ç”¨**pwntools**æ¥å®ç°è¿™ä¸€ç‚¹ï¼š
```python
from pwn import *

# Generate a De Bruijn sequence of length 1000 with an alphabet size of 256 (byte values)
pattern = cyclic(1000)

# This is an example value that you'd have found in the EIP/IP register upon crash
eip_value = p32(0x6161616c)
offset = cyclic_find(eip_value)  # Finds the offset of the sequence in the De Bruijn pattern
print(f"The offset is: {offset}")
```
æˆ–è€… **GEF**ï¼š
```bash
#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp
```
## åˆ©ç”¨æ ˆæº¢å‡º

åœ¨æº¢å‡ºæ—¶ï¼ˆå‡è®¾æº¢å‡ºå¤§å°è¶³å¤Ÿå¤§ï¼‰ï¼Œæ‚¨å°†èƒ½å¤Ÿ**è¦†ç›–**æ ˆå†…éƒ¨çš„å±€éƒ¨å˜é‡çš„å€¼ï¼Œç›´åˆ°è¾¾åˆ°ä¿å­˜çš„**EBP/RBPå’ŒEIP/RIPï¼ˆç”šè‡³æ›´å¤šï¼‰**ã€‚\
æ»¥ç”¨è¿™ç§ç±»å‹çš„æ¼æ´æœ€å¸¸è§çš„æ–¹æ³•æ˜¯é€šè¿‡**ä¿®æ”¹è¿”å›åœ°å€**ï¼Œå› æ­¤å½“å‡½æ•°ç»“æŸæ—¶ï¼Œ**æ§åˆ¶æµå°†è¢«é‡å®šå‘åˆ°ç”¨æˆ·åœ¨æŒ‡é’ˆä¸­æŒ‡å®šçš„ä½ç½®**ã€‚

ç„¶è€Œï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œä¹Ÿè®¸åªæ˜¯**è¦†ç›–æ ˆä¸­çš„ä¸€äº›å˜é‡å€¼**å°±è¶³ä»¥è¿›è¡Œåˆ©ç”¨ï¼ˆå°±åƒåœ¨ç®€å•çš„CTFæŒ‘æˆ˜ä¸­ä¸€æ ·ï¼‰ã€‚

### Ret2win

åœ¨è¿™ç§ç±»å‹çš„CTFæŒ‘æˆ˜ä¸­ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ª**ä»æœªè¢«è°ƒç”¨çš„å‡½æ•°**ï¼Œ**æ‚¨éœ€è¦è°ƒç”¨è¯¥å‡½æ•°æ‰èƒ½è·èƒœ**ã€‚å¯¹äºè¿™äº›æŒ‘æˆ˜ï¼Œæ‚¨åªéœ€è¦æ‰¾åˆ°**è¦†ç›–è¿”å›åœ°å€çš„åç§»é‡**ï¼Œå¹¶æ‰¾åˆ°è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€ï¼ˆé€šå¸¸ä¼šç¦ç”¨[**ASLR**](../common-binary-protections-and-bypasses/aslr/)ï¼‰ï¼Œå› æ­¤å½“æ˜“å—æ”»å‡»çš„å‡½æ•°è¿”å›æ—¶ï¼Œéšè—å‡½æ•°å°†è¢«è°ƒç”¨ï¼š

{% content-ref url="ret2win/" %}
[ret2win](ret2win/)
{% endcontent-ref %}

### æ ˆå†…ä»£ç 

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ ˆä¸­æ”¾ç½®ä¸€ä¸ªshellcodeï¼Œå¹¶æ»¥ç”¨å—æ§çš„EIP/RIPæ¥è·³è½¬åˆ°shellcodeå¹¶æ‰§è¡Œä»»æ„ä»£ç ï¼š

{% content-ref url="stack-shellcode/" %}
[stack-shellcode](stack-shellcode/)
{% endcontent-ref %}

### ROPå’ŒRet2...æŠ€æœ¯

è¿™ç§æŠ€æœ¯æ˜¯ç»•è¿‡å‰ä¸€ç§æŠ€æœ¯çš„ä¸»è¦ä¿æŠ¤æªæ–½ï¼š**ä¸å¯æ‰§è¡Œçš„æ ˆï¼ˆNXï¼‰**çš„åŸºæœ¬æ¡†æ¶ã€‚å®ƒå…è®¸æ‰§è¡Œå‡ ç§å…¶ä»–æŠ€æœ¯ï¼ˆret2libã€ret2syscall...ï¼‰ï¼Œè¿™äº›æŠ€æœ¯å°†é€šè¿‡æ»¥ç”¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ç°æœ‰æŒ‡ä»¤æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š

{% content-ref url="../rop-return-oriented-programing/" %}
[rop-return-oriented-programing](../rop-return-oriented-programing/)
{% endcontent-ref %}

## å †æº¢å‡º

æº¢å‡ºå¹¶ä¸æ€»æ˜¯å‘ç”Ÿåœ¨æ ˆä¸­ï¼Œä¾‹å¦‚ï¼Œå®ƒä¹Ÿå¯èƒ½å‘ç”Ÿåœ¨**å †**ä¸­ï¼š

{% content-ref url="../libc-heap/heap-overflow.md" %}
[heap-overflow.md](../libc-heap/heap-overflow.md)
{% endcontent-ref %}

## ä¿æŠ¤ç±»å‹

æœ‰å‡ ç§ä¿æŠ¤æªæ–½è¯•å›¾é˜²æ­¢åˆ©ç”¨æ¼æ´ï¼Œå¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æŸ¥çœ‹å®ƒä»¬ï¼š

{% content-ref url="../common-binary-protections-and-bypasses/" %}
[common-binary-protections-and-bypasses](../common-binary-protections-and-bypasses/)
{% endcontent-ref %}
