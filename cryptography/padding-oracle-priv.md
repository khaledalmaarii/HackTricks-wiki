<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFT**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)λ¥Ό **ν”λ΅μ°**ν•μ„Έμ”.
* **Hacking νΈλ¦­μ„ κ³µμ ν•λ ¤λ©΄** [**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ„Έμ”.

</details>


# CBC - Cipher Block Chaining

CBC λ¨λ“μ—μ„λ” **μ΄μ „ μ•”νΈν™”λ λΈ”λ΅μ΄ IVλ΅ μ‚¬μ©**λμ–΄ λ‹¤μ λΈ”λ΅κ³Ό XOR μ—°μ‚°μ„ μν–‰ν•©λ‹λ‹¤:

![https://defuse.ca/images/cbc\_encryption.png](https://defuse.ca/images/cbc\_encryption.png)

CBCλ¥Ό λ³µνΈν™”ν•λ ¤λ©΄ **λ°λ€λ΅** **μ—°μ‚°**μ„ μν–‰ν•©λ‹λ‹¤:

![https://defuse.ca/images/cbc\_decryption.png](https://defuse.ca/images/cbc\_decryption.png)

μ•”νΈν™”μ—λ” **μ•”νΈν™” ν‚¤**μ™€ **IV**λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•¨μ— μ μν•μ„Έμ”.

# λ©”μ‹μ§€ ν¨λ”©

μ•”νΈν™”λ” **κ³ μ •λ ν¬κΈ°μ λΈ”λ΅**μΌλ΅ μν–‰λλ―€λ΅, **λ§μ§€λ§‰ λΈ”λ΅**μ κΈΈμ΄λ¥Ό μ™„μ„±ν•κΈ° μ„ν•΄ μΌλ°μ μΌλ΅ **ν¨λ”©**μ΄ ν•„μ”ν•©λ‹λ‹¤.\
μΌλ°μ μΌλ΅λ” **PKCS7**μ΄ μ‚¬μ©λλ©°, ν¨λ”©μ€ λΈ”λ΅μ„ **μ™„μ„±**ν•κΈ° μ„ν•΄ ν•„μ”ν• **λ°”μ΄νΈ μ**λ¥Ό **λ°λ³µ**ν•μ—¬ μƒμ„±λ©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, λ§μ§€λ§‰ λΈ”λ΅μ΄ 3λ°”μ΄νΈκ°€ λ¶€μ΅±ν• κ²½μ° ν¨λ”©μ€ `\x03\x03\x03`μ΄ λ©λ‹λ‹¤.

**8λ°”μ΄νΈ κΈΈμ΄μ 2κ° λΈ”λ΅**μ„ κ°€μ§„ λ” λ§μ€ μμ λ¥Ό μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤:

| byte #0 | byte #1 | byte #2 | byte #3 | byte #4 | byte #5 | byte #6 | byte #7 | byte #0  | byte #1  | byte #2  | byte #3  | byte #4  | byte #5  | byte #6  | byte #7  |
| ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | -------- | -------- | -------- | -------- | -------- | -------- | -------- | -------- |
| P       | A       | S       | S       | W       | O       | R       | D       | 1        | 2        | 3        | 4        | 5        | 6        | **0x02** | **0x02** |
| P       | A       | S       | S       | W       | O       | R       | D       | 1        | 2        | 3        | 4        | 5        | **0x03** | **0x03** | **0x03** |
| P       | A       | S       | S       | W       | O       | R       | D       | 1        | 2        | 3        | **0x05** | **0x05** | **0x05** | **0x05** | **0x05** |
| P       | A       | S       | S       | W       | O       | R       | D       | **0x08** | **0x08** | **0x08** | **0x08** | **0x08** | **0x08** | **0x08** | **0x08** |

λ§μ§€λ§‰ μμ μ—μ„λ” **λ§μ§€λ§‰ λΈ”λ΅μ΄ κ°€λ“ μ°¨ μμ–΄ ν¨λ”©λ§ μλ” λΈ”λ΅μ΄ μ¶”κ°€λ΅ μƒμ„±**λμ—μμ„ μ• μ μμµλ‹λ‹¤.

# ν¨λ”© μ¤λΌν΄

μ‘μ© ν”„λ΅κ·Έλ¨μ΄ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•  λ•, λ¨Όμ € λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν• λ‹¤μ ν¨λ”©μ„ μ κ±°ν•©λ‹λ‹¤. ν¨λ”©μ„ μ •λ¦¬ν•λ” λ™μ•, **μλ»λ ν¨λ”©μ΄ κ°μ§€ κ°€λ¥ν• λ™μ‘μ„ νΈλ¦¬κ±°**ν•λ©΄ ν¨λ”© μ¤λΌν΄ μ·¨μ•½μ μ΄ μμµλ‹λ‹¤. κ°μ§€ κ°€λ¥ν• λ™μ‘μ€ **μ¤λ¥**, **κ²°κ³Ό λ¶€μ΅±** λλ” **μ‘λ‹µ μ†λ„κ°€ λλ ¤μ§**μΌ μ μμµλ‹λ‹¤.

μ΄λ¬ν• λ™μ‘μ„ κ°μ§€ν•λ©΄, μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό **λ³µνΈν™”**ν•κ³  μ‹¬μ§€μ–΄ **μ„μμ ν‰λ¬Έμ„ μ•”νΈν™”**ν•  μ μμµλ‹λ‹¤.

## μ•…μ© λ°©λ²•

[https://github.com/AonCyberLabs/PadBuster](https://github.com/AonCyberLabs/PadBuster)λ¥Ό μ‚¬μ©ν•μ—¬ μ΄λ¬ν• μ ν•μ μ·¨μ•½μ μ„ μ•…μ©ν•κ±°λ‚, λ‹¨μν λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤.
```
sudo apt-get install padbuster
```
μ‚¬μ΄νΈμ μΏ ν‚¤κ°€ μ·¨μ•½ν•μ§€ ν…μ¤νΈν•κΈ° μ„ν•΄ λ‹¤μμ„ μ‹λ„ν•  μ μμµλ‹λ‹¤:
```bash
perl ./padBuster.pl http://10.10.10.10/index.php "RVJDQrwUdTRWJUVUeBKkEA==" 8 -encoding 0 -cookies "login=RVJDQrwUdTRWJUVUeBKkEA=="
```
**μΈμ½”λ”© 0**μ€ **base64**κ°€ μ‚¬μ©λλ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤ (ν•μ§€λ§ λ‹¤λ¥Έ κ²ƒλ“¤λ„ μ‚¬μ© κ°€λ¥ν•λ‹ λ„μ›€λ§ λ©”λ‰΄λ¥Ό ν™•μΈν•μ„Έμ”).

λν• μ΄ μ·¨μ•½μ μ„ **μƒλ΅μ΄ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κΈ° μ„ν•΄ μ•…μ©**ν•  μλ„ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μΏ ν‚¤μ λ‚΄μ©μ΄ "\_user=MyUsername\_"μΈ κ²½μ°, μ΄λ¥Ό "\_user=administrator\_"λ΅ λ³€κ²½ν•μ—¬ μ‘μ© ν”„λ΅κ·Έλ¨ λ‚΄μ—μ„ κ¶ν•μ„ μƒμΉμ‹ν‚¬ μ μμµλ‹λ‹¤. λν• `padbuster`λ¥Ό μ‚¬μ©ν•μ—¬ `-plaintext` λ§¤κ°λ³€μλ¥Ό μ§€μ •ν•μ—¬ μ΄ μ‘μ—…μ„ μν–‰ν•  μλ„ μμµλ‹λ‹¤:
```bash
perl ./padBuster.pl http://10.10.10.10/index.php "RVJDQrwUdTRWJUVUeBKkEA==" 8 -encoding 0 -cookies "login=RVJDQrwUdTRWJUVUeBKkEA==" -plaintext "user=administrator"
```
λ§μ•½ μ‚¬μ΄νΈκ°€ μ·¨μ•½ν•λ‹¤λ©΄ `padbuster`λ” μλ™μΌλ΅ ν¨λ”© μ¤λ¥κ°€ λ°μƒν•λ” μ‹μ μ„ μ°ΎμΌλ ¤κ³  μ‹λ„ν•  κ²ƒμ…λ‹λ‹¤. κ·Έλ¬λ‚ **-error** λ§¤κ°λ³€μλ¥Ό μ‚¬μ©ν•μ—¬ μ¤λ¥ λ©”μ‹μ§€λ¥Ό μ§€μ •ν•  μλ„ μμµλ‹λ‹¤.
```bash
perl ./padBuster.pl http://10.10.10.10/index.php "" 8 -encoding 0 -cookies "hcon=RVJDQrwUdTRWJUVUeBKkEA==" -error "Invalid padding"
```
## μ΄λ΅ 

μ”μ•½ν•μλ©΄, λ¨λ“  **λ‹¤λ¥Έ ν¨λ”©**μ„ μƒμ„±ν•λ” λ° μ‚¬μ©λ  μ μλ” μ¬λ°”λ¥Έ κ°’μ„ μ¶”μΈ΅ν•μ—¬ μ•”νΈν™”λ λ°μ΄ν„°μ λ³µνΈν™”λ¥Ό μ‹μ‘ν•  μ μμµλ‹λ‹¤. κ·Έλ° λ‹¤μ ν¨λ”© μ¤λΌν΄ κ³µκ²©μ€ 1, 2, 3 λ“±μ ν¨λ”©μ„ μƒμ„±ν•λ” μ¬λ°”λ¥Έ κ°’μ„ μ¶”μΈ΅ν•μ—¬ μ‹μ‘ν•μ—¬ λμ—μ„ μ‹μ‘ν•μ—¬ λ°”μ΄νΈλ¥Ό λ³µνΈν™”ν•©λ‹λ‹¤.

![](<../.gitbook/assets/image (629) (1) (1).png>)

E0μ—μ„ E15κΉμ§€μ λ°”μ΄νΈλ΅ κµ¬μ„±λ **2κ°μ λΈ”λ΅**μΌλ΅ μ΄λ£¨μ–΄μ§„ μ•”νΈν™”λ ν…μ¤νΈκ°€ μλ‹¤κ³  μƒμƒν•΄λ³΄μ‹­μ‹μ¤.\
λ§μ§€λ§‰ λΈ”λ΅(E8μ—μ„ E15)μ„ **λ³µνΈν™”**ν•κΈ° μ„ν•΄ μ „μ²΄ λΈ”λ΅μ€ "λΈ”λ΅ μ•”νΈ λ³µνΈν™”"λ¥Ό ν†µν•΄ μ¤‘κ°„ λ°”μ΄νΈ I0μ—μ„ I15μ„ μƒμ„±ν•©λ‹λ‹¤.\
λ§μ§€λ§‰μΌλ΅, κ° μ¤‘κ°„ λ°”μ΄νΈλ” μ΄μ „μ μ•”νΈν™”λ λ°”μ΄νΈ(E0μ—μ„ E7)μ™€ **XOR**λ©λ‹λ‹¤. κ·Έλμ„:

* `C15 = D(E15) ^ E7 = I15 ^ E7`
* `C14 = I14 ^ E6`
* `C13 = I13 ^ E5`
* `C12 = I12 ^ E4`
* ...

μ΄μ  `C15`μ΄ `0x01`μ΄ λ  λ•κΉμ§€ `E7`μ„ μμ •ν•  μ μμµλ‹λ‹¤. μ΄λ” μ¬λ°”λ¥Έ ν¨λ”©μ΄κΈ°λ„ ν•©λ‹λ‹¤. λ”°λΌμ„ μ΄ κ²½μ°μ—λ”: `\x01 = I15 ^ E'7`

λ”°λΌμ„, `E'7`μ„ μ°ΎμΌλ©΄ **I15μ„ κ³„μ‚°**ν•  μ μμµλ‹λ‹¤: `I15 = 0x01 ^ E'7`

μ΄λ΅μ¨ **C15μ„ κ³„μ‚°**ν•  μ μμµλ‹λ‹¤: `C15 = E7 ^ I15 = E7 ^ \x01 ^ E'7`

**C15**μ„ μ•κ² λλ©΄, μ΄μ  **C14λ¥Ό κ³„μ‚°**ν•  μ μμ§€λ§, μ΄λ²μ—λ” ν¨λ”© `\x02\x02`λ¥Ό λ¬΄μ°¨λ³„ λ€μ…(brute-force)ν•©λ‹λ‹¤.

μ΄ λ¬΄μ°¨λ³„ λ€μ…μ€ μ΄μ „κ³Ό κ°™μ΄ λ³µμ΅ν•©λ‹λ‹¤. 0x02μΈ **`E''15`**λ¥Ό κ³„μ‚°ν•  μ μμµλ‹λ‹¤: `E''7 = \x02 ^ I15` κ·Έλμ„ **`C14`**κ°€ **`0x02`**μ™€ κ°™μ€ **`E'14`**λ¥Ό μ°ΎκΈ°λ§ ν•λ©΄ λ©λ‹λ‹¤.\
κ·Έλ° λ‹¤μ, C14λ¥Ό λ³µνΈν™”ν•κΈ° μ„ν•΄ λ™μΌν• λ‹¨κ³„λ¥Ό μν–‰ν•©λ‹λ‹¤: **`C14 = E6 ^ I14 = E6 ^ \x02 ^ E''6`**

**μ „μ²΄ μ•”νΈν™”λ ν…μ¤νΈλ¥Ό λ³µνΈν™”**ν•κΈ° μ„ν•΄ μ΄λ¬ν• κ³Όμ •μ„ λ”°λ¥΄μ‹­μ‹μ¤.

## μ·¨μ•½μ  νƒμ§€

κ³„μ •μ„ λ“±λ΅ν•κ³ μ΄ κ³„μ •μΌλ΅ λ΅κ·ΈμΈν•μ‹­μ‹μ¤.\
μ—¬λ¬ λ² λ΅κ·ΈμΈν•κ³  ν•­μƒ **λ™μΌν• μΏ ν‚¤**λ¥Ό λ°›μΌλ©΄ μ‘μ© ν”„λ΅κ·Έλ¨μ— λ¬Έμ κ°€ μμ„ μ μμµλ‹λ‹¤. μΏ ν‚¤λ” λ΅κ·ΈμΈν•  λ•λ§λ‹¤ **κ³ μ ν•΄μ•Ό**ν•©λ‹λ‹¤. μΏ ν‚¤κ°€ **ν•­μƒ** **λ™μΌ**ν•λ©΄ ν•­μƒ μ ν¨ν•κ³  **λ¬΄ν¨ν™”ν•  μ μλ” λ°©λ²•μ΄ μ—†μ„ κ²ƒ**μ…λ‹λ‹¤.

μ΄μ  μΏ ν‚¤λ¥Ό **μμ •**ν•λ ¤κ³ ν•λ©΄ μ‘μ© ν”„λ΅κ·Έλ¨μ—μ„ **μ¤λ¥**κ°€ λ°μƒν•λ” κ²ƒμ„ λ³Ό μ μμµλ‹λ‹¤.\
κ·Έλ¬λ‚ ν¨λ”©μ„ λ¬΄μ°¨λ³„ λ€μ…(padbusterλ¥Ό μ‚¬μ©ν•μ—¬ μλ¥Ό λ“¤λ©΄)ν•λ©΄ λ‹¤λ¥Έ μ‚¬μ©μμ— λ€ν• μ ν¨ν• λ‹¤λ¥Έ μΏ ν‚¤λ¥Ό μ–»μ„ μ μμµλ‹λ‹¤. μ΄ μ‹λ‚λ¦¬μ¤λ” padbusterμ— μ·¨μ•½ν•  κ°€λ¥μ„±μ΄ λ§¤μ° λ†’μµλ‹λ‹¤.

## μ°Έκ³  μλ£

* [https://en.wikipedia.org/wiki/Block\_cipher\_mode\_of\_operation](https://en.wikipedia.org/wiki/Block\_cipher\_mode\_of\_operation)


<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* νμ‚¬λ¥Ό HackTricksμ—μ„ **κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* λ…μ μ μΈ [**NFTs**](https://opensea.io/collection/the-peass-family)μΈ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ„ λ°κ²¬ν•μ„Έμ”.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**λ¥Ό** ν”λ΅μ°ν•μ„Έμ”.
* **HackTricks**μ™€ **HackTricks Cloud** github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **μμ‹ μ ν•΄ν‚Ή κΈ°λ²•μ„ κ³µμ **ν•μ„Έμ”.

</details>
