# рд▓рд┐рдирдХреНрд╕ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрд▓реНрдб рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рдирд╛

### рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, **рдПрдХ USB** рдХреЗ рд╕рд╛рде рдХреБрдЫ **рдЕрдЪреНрдЫреЗ рдЬрд╛рдиреЗ рдорд╛рдиреЗ рдмрд╛рдЗрдирд░реА рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА** рд░рдЦрдирд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЖрдк рдмрд╕ рдЙрдмрдВрдЯреВ рд▓реЗрдХрд░ рдЖ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлреЛрд▓реНрдбрд░ _/bin_, _/sbin_, _/lib,_ рдФрд░ _/lib64_ рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ), рдлрд┐рд░ USB рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ, рдФрд░ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЙрди рдмрд╛рдЗрдирд░реАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ:
```bash
export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
```
рдЬрдм рдЖрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдЪреНрдЫреЗ рдФрд░ рдЬрд╛рдиреЗ-рдорд╛рдиреЗ binaries рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛** рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
```
#### рд╕рдВрджрд┐рдЧреНрдз рдЬрд╛рдирдХрд╛рд░реА

рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдРрд╕реА рдЕрдЬреАрдм рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреИрд╕реЗ:

* **рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдЖрдо рддреМрд░ рдкрд░ рдХрдо PIDS рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдЖрдк рдПрдХ рдмрдбрд╝реА PID рдХреЗ рд╕рд╛рде рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕рдВрджреЗрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* `/etc/passwd` рдореЗрдВ рд╢реИрд▓реА рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА **рд░рдЬрд┐рд╕реНрдЯрд░реНрдб рд▓реЙрдЧрд┐рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* `/etc/shadow` рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдПрдХ рд╢реИрд▓ рдирд╣реАрдВ рд╣реИ

### рдореЗрдореЛрд░реА рдбрдВрдк

рдЪрд▓ рд░рд╣реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рдореЗрдореЛрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**LiME**](https://github.com/504ensicsLabs/LiME) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИред\
рдЗрд╕реЗ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреАрдбреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рд╡рд┐рдХреНрдЯрд┐рдо рдорд╢реАрди рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред

{% hint style="info" %}
рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдЖрдк **LiME рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪреАрдЬ** рдХреЛ рд╡рд┐рдХреНрдЯрд┐рдо рдорд╢реАрди рдореЗрдВ рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдХрдИ рдмрджрд▓рд╛рд╡ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ
{% endhint %}

рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рд╡реИрд╢рд┐рд╖реНрдЯреНрдпрдкреВрд░реНрдг рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдпреВрдмрдВрдЯреВ рд╣реИ рддреЛ рдЖрдк `apt-get install lime-forensics-dkms` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ [**LiME**](https://github.com/504ensicsLabs/LiME) рдХреЛ github рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╣реА рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рд╡рд┐рдХреНрдЯрд┐рдо рдорд╢реАрди рдХреЗ рд╕рдЯреАрдХ рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ `/lib/modules/<рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг>` рдХреА **рдХреЙрдкреА** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LiME рдХреЛ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
make -C /lib/modules/<kernel version>/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
```
LiME рд╕рдорд░реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ 3 **рдлреЙрд░реНрдореЗрдЯ**:

* Raw (рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛)
* Padded (рд░реЙ рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди рджрд╛рдПрдВ рдмрд┐рдЯреНрд╕ рдореЗрдВ рд╢реВрдиреНрдп рд╣реИрдВ)
* Lime (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлреЙрд░реНрдореЗрдЯ)

LiME рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрдВрдк рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: `path=tcp:4444`

### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧ

#### рдмрдВрдж рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕рдордп рд╕рд┐рд╕реНрдЯрдо рдПрдХ рдЙрддреНрдкрд╛рджрди рд╕рд░реНрд╡рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрдВрдкрдиреА рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреА рд╕рд╛рдорд░реНрдереНрдп рдирд╣реАрдВ рд╣реЛрддреАред\
рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ **2 рддрд░реАрдХреЗ** рд╣реИрдВ, рдПрдХ **рд╕рд╛рдорд╛рдиреНрдп рдмрдВрдж рдХрд░рдирд╛** рдФрд░ рдПрдХ **"рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓рдирд╛" рдмрдВрдж рдХрд░рдирд╛**ред рдкрд╣рд▓рд╛ рд╡рд╛рд▓рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ** рдФрд░ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо** рдХреЛ **рд╕рдордХрд╛рд▓реАрди** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рд╕рдВрднрд╛рд╡рд┐рдд **рдореИрд▓рд╡реЗрдпрд░** рдХреЛ **рд╕рдмреВрдд рдирд╖реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред "рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓рдирд╛" рджреГрд╖реНрдЯрд┐рдХреЛрдг **рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдХреА рд╣рд╛рдирд┐** рд▓реЗ рд╕рдХрддрд╛ рд╣реИ (рдЬреНрдпрд╛рджрд╛рддрд░ рдЬрд╛рдирдХрд╛рд░реА рдирд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдореЗрдореЛрд░реА рдХрд╛ рдЫрд╡рд┐ рд▓реЗ рд▓реА рд╣реИ) рдФрд░ **рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдХреБрдЫ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдореМрдХрд╛ рдирд╣реАрдВ** рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣рд╛рдБ рдХреЛрдИ **рдореИрд▓рд╡реЗрдпрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **`sync`** **рдХрдорд╛рдВрдб** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓реЗрдВред

#### рдбрд┐рд╕реНрдХ рдХреА рдЫрд╡рд┐ рд▓реЗрдирд╛

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдорд╛рдорд▓реЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЛ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрдВрдЯ** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рдХреЛрдИ рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рди рдХрд░реЗрдВред
```bash
#Create a raw copy of the disk
dd if=<subject device> of=<image file> bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=<subject device> of=<image file> bs=512 hash=<algorithm> hashwindow=<chunk size> hashlog=<hash file>
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
```
### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдкреВрд░реНрд╡ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдХрд┐рд╕реА рднреА рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдХреЛ рдЗрдореЗрдЬрд┐рдВрдЧ рдХрд░реЗрдВред
```bash
#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдХрд░реЗрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЬреНрдЮрд╛рдд рдореИрд▓рд╡реЗрдпрд░ рдХреА рдЦреЛрдЬ

### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓реЗрдВ

Linux рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдШрд╛рддрдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЦрд┐рд▓ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдорд╕реНрдпрд╛рддреНрдордХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

- **RedHat рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо**: рд╡реНрдпрд╛рдкрдХ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП `rpm -Va` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
- **Debian рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо**: рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП `dpkg --verify` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ `debsums | grep -v "OK$"` ( `apt-get install debsums` рдХреЗ рд╕рд╛рде `debsums` рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдХрд┐рд╕реА рднреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдПред

### рдореИрд▓рд╡реЗрдпрд░/рд░реВрдЯрдХрд┐рдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░реНрд╕

рдореИрд▓рд╡реЗрдпрд░ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрдврд╝реЗрдВ:

{% content-ref url="malware-analysis.md" %}
[malware-analysis.md](malware-analysis.md)
{% endcontent-ref %}

## рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдЦреЛрдЬ

Debian рдФрд░ RedHat рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдкреНрд░рднрд╛рд╡реА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП, рд╕рд╛рдорд╛рдиреНрдп рдирд┐рд░реАрдХреНрд╖рдг рдХреЗ рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВред

- Debian рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП `grep` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрдирд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **_`/var/lib/dpkg/status`_** рдФрд░ **_`/var/log/dpkg.log`_** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

- RedHat рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ `rpm -qa --root=/mntpath/var/lib/rpm` рдХреЗ рд╕рд╛рде RPM рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

рдЗрди рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЗ рдмрд╛рд╣рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЧрдП рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП, **_`/usr/local`_**, **_`/opt`_**, **_`/usr/sbin`_**, **_`/usr/bin`_**, **_`/bin`_**, рдФрд░ **_`/sbin`_** рдЬреИрд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░реЗрдВред рд╕рд┐рд╕реНрдЯрдо-рд╡рд┐рд╢реЗрд╖ рдЖрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдкрд╣рдЪрд╛рдиреЗрдВ рдЬрд┐рдирдореЗрдВ рдХрд┐рд╕реА рднреА рдЬрд╛рдиреЗ рдЧрдП рдкреИрдХреЗрдЬ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рди рд╣реЛ, рд╕рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдЦреЛрдЬ рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдВред
```bash
# Debian package and log details
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
# RedHat RPM database query
rpm -qa --root=/mntpath/var/lib/rpm
# Listing directories for manual installations
ls /usr/sbin /usr/bin /bin /sbin
# Identifying non-package executables (Debian)
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
# Identifying non-package executables (RedHat)
find /sbin/ тАУexec rpm -qf {} \; | grep "is not"
# Find exacuable files
find / -type f -executable | grep <something>
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╣рдЯрд╛рдП рдЧрдП рдЪрд▓ рд░рд╣реЗ рдмрд╛рдЗрдирд░реА рдХреЛ рдмрд╣рд╛рд▓ рдХрд░реЗрдВ

рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬреЛ /tmp/exec рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЧрдИ рдереА рдФрд░ рд╣рдЯрд╛ рджреА рдЧрдИ рдереАред рдЗрд╕реЗ рдирд┐рдХрд╛рд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ
```bash
cd /proc/3746/ #PID with the exec file deleted
head -1 maps #Get address of the file. It was 08048000-08049000
dd if=mem bs=1 skip=08048000 count=1000 of=/tmp/exec2 #Recorver it
```
## рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдпреЛрдВ
```bash
cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
```
### рд╕реЗрд╡рд╛рдПрдВ

рдорд╛рд▓рд╡реЗрдпрд░ рдХреЛ рд╕реЗрд╡рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдкрде:

- **/etc/inittab**: rc.sysinit рдЬреИрд╕реЗ рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдмреБрд▓рд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрдЧреЗ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- **/etc/rc.d/** рдФрд░ **/etc/rc.boot/**: рд╕реЗрд╡рд╛ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд░рдЦрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдкреБрд░рд╛рдиреЗ Linux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рджреВрд╕рд░рд╛ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **/etc/init.d/**: Debian рдЬреИрд╕реЗ рдХреБрдЫ Linux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рд╕реЗрд╡рд╛рдПрдВ **/etc/inetd.conf** рдпрд╛ **/etc/xinetd/** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рд╕рдХреНрд░рд┐рдп рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬреЛ Linux рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред
- **/etc/systemd/system**: рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
- **/etc/systemd/system/multi-user.target.wants/**: рдЙрди рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдВрдХреНрд╕ рдХреЛ рд░рдЦрддрд╛ рд╣реИ рдЬреЛ рдорд▓реНрдЯреА-рдпреВрдЬрд░ рд░рдирд▓реЗрд╡рд▓ рдореЗрдВ рд╢реБрд░реВ рдХрд┐рдП рдЬрд╛рдиреЗ рдЪрд╛рд╣рд┐рдПред
- **/usr/local/etc/rc.d/**: рдХрд╕реНрдЯрдо рдпрд╛ рдерд░реНрдб-рдкрд╛рд░реНрдЯреА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдПред
- **~/.config/autostart/**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд▓рдХреНрд╖рд┐рдд рдорд╛рд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫрд┐рдкрдиреЗ рдХреА рдЬрдЧрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
- **/lib/systemd/system/**: рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдпреВрдирд┐рдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЬреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИрдВред

### рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓

рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓, рдЬреЛ рдЕрдХреНрд╕рд░ рдорд╛рд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд░реВрдЯрдХрд┐рдЯ рдШрдЯрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рдмреВрдЯ рдкрд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВред рдЗрди рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ рдФрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- **/lib/modules/$(uname -r)**: рдЪрд▓ рд░рд╣реЗ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓реНрд╕ рдХреЛ рд░рдЦрддрд╛ рд╣реИред
- **/etc/modprobe.d**: рдореЙрдбреНрдпреВрд▓ рд▓реЛрдбрд┐рдВрдЧ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- **/etc/modprobe** рдФрд░ **/etc/modprobe.conf**: рд╡реИрд╢реНрд╡рд┐рдХ рдореЙрдбреНрдпреВрд▓ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЗрдВред

### рдЕрдиреНрдп рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реНрдерд╛рди

рд▓рд┐рдирдХреНрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдорд╛рд▓рд╡реЗрдпрд░ рдХреЛ рдЫреБрдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛ рд╕рдХрддреА рд╣реИрдВ:

- **/etc/profile.d/***, **/etc/profile**, рдФрд░ **/etc/bash.bashrc**: рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **~/.bashrc**, **~/.bash_profile**, **~/.profile**, рдФрд░ **~/.config/autostart**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреЛ рдЙрдирдХреЗ рд▓реЙрдЧрд┐рди рдкрд░ рдЪрд▓рддреА рд╣реИрдВред
- **/etc/rc.local**: рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдПрдВ рд╢реБрд░реВ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЪрд▓рддрд╛ рд╣реИ, рдЬреЛ рдорд▓реНрдЯреАрдпреВрдЬрд░ рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рдорд╛рд░реЛрд╣ рдХрд╛ рдЕрдВрдд рдХрд░рддрд╛ рд╣реИред

## рд▓реЙрдЧ рдХреА рдЬрд╛рдВрдЪ

рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рднрд┐рдиреНрди рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИред рдпреЗ рд▓реЙрдЧ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ, рдорд╛рд▓рд╡реЗрдпрд░ рд╕рдВрдХреНрд░рдордг рдФрд░ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред рдореБрдЦреНрдп рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- **/var/log/syslog** (Debian) рдпрд╛ **/var/log/messages** (RedHat): рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рд╕рдВрджреЗрд╢ рдФрд░ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддреЗ рд╣реИрдВред
- **/var/log/auth.log** (Debian) рдпрд╛ **/var/log/secure** (RedHat): рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕реЛрдВ, рд╕рдлрд▓ рдФрд░ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреЗ рд╣реИрдВред
- `grep -iE "session opened for|accepted password|new session|not in sudoers" /var/log/auth.log` рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдШрдЯрдирд╛рдУрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВред
- **/var/log/boot.log**: рд╕рд┐рд╕реНрдЯрдо рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕рдВрджреЗрд╢ рд╢рд╛рдорд┐рд▓ рд╣реИред
- **/var/log/maillog** рдпрд╛ **/var/log/mail.log**: рдИрдореЗрд▓ рд╕рд░реНрд╡рд░ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдИрдореЗрд▓ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
- **/var/log/kern.log**: рдХрд░реНрдиреЗрд▓ рд╕рдВрджреЗрд╢ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдФрд░ рдЪреЗрддрд╛рд╡рдирд┐рдпрд╛рдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- **/var/log/dmesg**: рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрджреЗрд╢ рд░рдЦрддрд╛ рд╣реИред
- **/var/log/faillog**: рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдЬрд╛рдВрдЪ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред
- **/var/log/cron**: рдХреНрд░реЙрди рдЬреЙрдм рдХреНрд░рд┐рдпрд╛рдПрдБ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
- **/var/log/daemon.log**: рдкрд┐рдЫрд▓реЗ рд╕реЗрд╡рд╛ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИред
- **/var/log/btmp**: рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИред
- **/var/log/httpd/**: Apache HTTPD рддреНрд░реБрдЯрд┐ рдФрд░ рдПрдХреНрд╕реЗрд╕ рд▓реЙрдЧреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- **/var/log/mysqld.log** рдпрд╛ **/var/log/mysql.log**: MySQL рдбреЗрдЯрд╛рдмреЗрд╕ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
- **/var/log/xferlog**: FTP рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред
- **/var/log/**: рдпрд╣рд╛рдБ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд▓реЙрдЧ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

{% hint style="info" %}
рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдФрд░ рдСрдбрд┐рдЯ рд╕рдмрд╕рд┐рд╕реНрдЯрдо рдХреЛ рдПрдХ рдЙрддреНрддрд░реНрдЬрди рдпрд╛ рдорд╛рд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛ рдореЗрдВ рдЕрдХреНрд╖рдо рдпрд╛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд▓реЙрдЧ рдЖрдо рддреМрд░ рдкрд░ рджреБрд╖реНрдЯ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ, рдЕрддрдГ рдЕрддрд┐рдХреНрд░рдордг рдпрд╛ рдорд╛рд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛ рдореЗрдВ рдЬрдм рдЙрдкрд▓рдмреНрдз рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╣рдЯрд╛рдиреЗ рдпрд╛ рдЫреЗрджрдЦрджреНрдж рдХреА рд╕рдВрдХреЗрдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред
{% endhint %}

**рд▓рд┐рдирдХреНрд╕ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдорд╛рдВрдб рд╣рд┐рд╕реНрдЯреНрд░реА рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ**, рдЬрд┐рд╕реЗ рдпрд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

- ~/.bash_history
- ~/.zsh_history
- ~/.zsh_sessions/*
- ~/.python_history
- ~/.*_history

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, `last -Faiwx` рдХрдорд╛рдВрдб рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреА рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЕрдЬреНрдЮрд╛рдд рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЬрд╛рдВрдЪреЗрдВред

рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдзрд┐рдХ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬрд╛рдВрдЪреЗрдВ:

- рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП `/etc/sudoers` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
- рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП `/etc/sudoers.d/` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
- рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рд╕рджрд╕реНрдпрддрд╛ рдпрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП `/etc/groups` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред
- рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рд╕рджрд╕реНрдпрддрд╛ рдпрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП `/etc/passwd` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред

рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рднреА рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ:

- **SSH**: рдЕрдирдзрд┐рдХреГрдд рджреВрд░рд╕реНрде рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП _~/.ssh/authorized_keys_ рдФрд░ _~/.ssh/known_hosts_ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
- **
```bash
pip3 install usbrip
usbrip ids download #Download USB ID database
```
### рдЙрджрд╛рд╣рд░рдг
```bash
usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
```
рдЕрдзрд┐рдХ рдЙрджрд╛рд╣рд░рдг рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЧрд┐рдЯрд╣рдм рдореЗрдВ: [https://github.com/snovvcrash/usbrip](https://github.com/snovvcrash/usbrip)



<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд╛рд░реНрдпрдкреНрд░рдгрд╛рд▓рд┐рдпрд╛рдБ** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рд╢рдХреНрдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}



## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдФрд░ рд▓реЙрдЧрдСрди рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ

рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╛рдореЛрдВ рдпрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ _**/etc/passwd**_, _**/etc/shadow**_ рдФрд░ **рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ** рдореЗрдВ рдирд┐рд░реНрдорд┐рдд рдФрд░/рдпрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реЛрдВ рдЬреЛ рдЬреНрдЮрд╛рдд рдЕрдирдзрд┐рдХреГрдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдХрд░реАрдм рдмрдирд╛рдП рдЧрдП рд╣реЛрдВред рд╕рд╛рде рд╣реА, рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрдбреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреА рдЧрдИ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП _**/etc/sudoers**_ рдФрд░ _**/etc/groups**_ рдЬреИрд╕реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдЕрдВрддрддрдГ, **рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ** рдпрд╛ **рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓рд╛ рдкрд╛рд╕рд╡рд░реНрдб** рд╡рд╛рд▓реЗ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

## рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдореИрд▓рд╡реЗрдпрд░ рдЬрд╛рдВрдЪ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдореИрд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╕рдордп, рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕рдВрд░рдЪрдирд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реВрддреНрд░ рд╕реНрд░реЛрдд рд╣реИ, рдЬреЛ рдШрдЯрдирд╛рдУрдВ рдХреА рдХреНрд░рдорд╡рд╛рд░реНрддрд╛ рдФрд░ рдореИрд▓рд╡реЗрдпрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рджреЛрдиреЛрдВ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореИрд▓рд╡реЗрдпрд░ рд▓реЗрдЦрдХ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдпрд╛ рдбреЗрдЯрд╛ рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдмрдЪрдирд╛ред

рдЗрди рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рд╡рд┐рд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ:

- **рдШрдЯрдирд╛ рд╕рдордпрд░реЗрдЦрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг** рдХрд╛ рд╡рд┐рд╕реНрддреГрдд рдХрд╛рд░реНрдп рдХрд░реЗрдВ, рдЬреИрд╕реЗ рдХрд┐ **Autopsy** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдШрдЯрдирд╛ рд╕рдордпрд░реЗрдЦрд╛рдУрдВ рдХреЛ рджреГрд╢реНрдпреАрдХрд░рдг рдХрд░рдиреЗ рдпрд╛ **Sleuth Kit's** `mactime` рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╕реНрддреГрдд рд╕рдордпрд░реЗрдЦрд╛ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдПред
- рддрдВрддреНрд░рд┐рдХрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдЬреЛ рдЖрдХреНрд░рдордгрдХрд╛рд░рд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╢реИрд▓ рдпрд╛ PHP рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
- **рдЕрдЯрд┐рдкрд┐рдХрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ `/dev` рдореЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рднреА рд░рдЦ рд╕рдХрддрд╛ рд╣реИред
- **рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ рдЬрд┐рдирдХреЗ рдирд╛рдо ".. " (рдбреЙрдЯ рдбреЙрдЯ рд╕реНрдкреЗрд╕) рдпрд╛ "..^G" (рдбреЙрдЯ рдбреЙрдЯ рдХрдВрдЯреНрд░реЛрд▓-рдЬреА) рдЬреИрд╕реЗ рд╣реЛрдВ, рдЬреЛ рдХрд┐рд╕реА рджреБрд░реБрдкрдпреЛрдЧреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЫреБрдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
- **рд╕реЗрдЯрдпреВрдЖрдЗрдб рд░реВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдЗрд╕ рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```find / -user root -perm -04000 -print```
рдпрд╣ рдЙрдЪреНрдЪ рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдХреНрд░рдордгрдХрд╛рд░рд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- рдЗрдиреЛрдб рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ **рдорд┐рдЯрд╛рдиреЗ рдХреА рд╕рдордпрдЪрд┐рд╣реНрди** рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ, рддрд╛рдХрд┐ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдорд┐рдЯрд╛рдпрд╛ рдЧрдпрд╛ рд╣реЛ рдЙрд╕реЗ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП, рдЬреЛ рд░реВрдЯрдХрд┐рдЯреНрд╕ рдпрд╛ рдЯреНрд░реЛрдЬрдиреНрд╕ рдХреА рдореМрдЬреВрджрдЧреА рдХреА рд╕рдВрдХреЗрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
- **рдирд┐рдХрдЯ рдореЗрдВ рд╕реНрдерд┐рдд рджреБрд░реБрдкрдпреЛрдЧреА рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЙрдирдХреЗ рдкрд╛рд╕ рд╕рдВрдпреБрдХреНрдд рдЗрдиреЛрдбреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рд╕рд╛рде рдореЗрдВ рд░рдЦреЗ рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
- рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдмрд╛рдЗрдирд░реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ (_/bin_, _/sbin_) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпреЗ рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# List recent files in a directory:
ls -laR --sort=time /bin```

# Sort files in a directory by inode:
ls -lai /bin | sort -n```
```
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рд╕рдордп **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╡реИрдз** рд▓рдЧреЗрдВ, рд▓реЗрдХрд┐рди рд╡рд╣ **inode** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред рдЕрдЧрд░ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдПрдХ **рдлрд╝рд╛рдЗрд▓** рдЗрд╕ рдмрд╛рдд рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИ рдХрд┐ рдпрд╣ рдЙрд╕реА рд╕рдордп рдмрдирд╛рдИ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЧрдИ рдереА рдЬреИрд╕реЗ рдХрд┐ рдЙрд╕реА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ, рд▓реЗрдХрд┐рди **inode** рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдмрдбрд╝рд╛ рд╣реИ, рддреЛ рдЙрд╕ **рдлрд╝рд╛рдЗрд▓ рдХреЗ timestamps рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**ред
{% endhint %}

## рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ

### рдлрд╝рд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдг рддреБрд▓рдирд╛ рд╕рд╛рд░рд╛рдВрд╢

рдлрд╝рд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рд░рд▓рд┐рдд `git diff` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:

- **рдирдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП**, рджреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ:
```bash
git diff --no-index --diff-filter=A path/to/old_version/ path/to/new_version/
```
- **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП**, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реБрдП рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:
```bash
git diff --no-index --diff-filter=M path/to/old_version/ path/to/new_version/ | grep -E "^\+" | grep -v "Installed-Time"
```
- **рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП**:
```bash
git diff --no-index --diff-filter=D path/to/old_version/ path/to/new_version/
```
- **рдлрд╝рд┐рд▓реНрдЯрд░ рд╡рд┐рдХрд▓реНрдк** (`--diff-filter`) рдорджрдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдкрд░рд┐рд╡рд░реНрддрди рдЬреИрд╕реЗ рдЬреЛрдбрд╝реА рдЧрдИ (`A`), рд╣рдЯрд╛рдИ рдЧрдИ (`D`), рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд (`M`) рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдореЗрдВред
- `A`: рдЬреЛрдбрд╝реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
- `C`: рдХреЙрдкреА рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
- `D`: рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
- `M`: рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
- `R`: рдирд╛рдордХрд░рдг рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
- `T`: рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд░реНрддрди (рдЙрджрд╛., рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╕рд┐рдВрдмрд▓рд┐рдВрдХ)
- `U`: рдЕрдорд░реНрдЬрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
- `X`: рдЕрдЬреНрдЮрд╛рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
- `B`: рдЯреВрдЯреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ

## рд╕рдВрджрд░реНрдн

* [https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf](https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf)
* [https://www.plesk.com/blog/featured/linux-logs-explained/](https://www.plesk.com/blog/featured/linux-logs-explained/)
* [https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203](https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203)
* **рдкреБрд╕реНрддрдХ: рдореИрд▓рд╡реЗрдпрд░ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдлрд╝реАрд▓реНрдб рдЧрд╛рдЗрдб рдлреЙрд░ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореНрд╕: рдбрд┐рдЬрд┐рдЯрд▓ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдлрд╝реАрд▓реНрдб рдЧрд╛рдЗрдбреНрд╕**
