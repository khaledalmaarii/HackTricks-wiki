# Linux Forensics

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

## рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рдг

### рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **USB** рд╣реЛ рдЬрд┐рд╕рдореЗрдВ **рдЕрдЪреНрдЫреА рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реА рдФрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реЛрдВ** (рдЖрдк рдмрд╕ рдЙрдмрдВрдЯреВ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ _/bin_, _/sbin_, _/lib,_ рдФрд░ _/lib64_ рдХреА рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ), рдлрд┐рд░ USB рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ, рдФрд░ рдЙрди рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП env рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ:
```bash
export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
```
рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдЪреНрдЫреЗ рдФрд░ рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛** рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
```
#### рд╕рдВрджрд┐рдЧреНрдз рдЬрд╛рдирдХрд╛рд░реА

рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдЕрдЬреАрдм рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреИрд╕реЗ:

* **рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдЖрдорддреМрд░ рдкрд░ рдХрдо PIDS рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдПрдХ рдмрдбрд╝реЗ PID рдХреЗ рд╕рд╛рде рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕рдВрджреЗрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* `/etc/passwd` рдХреЗ рдЕрдВрджрд░ рдмрд┐рдирд╛ рд╢реЗрд▓ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ **рдкрдВрдЬреАрдХреГрдд рд▓реЙрдЧрд┐рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* рдмрд┐рдирд╛ рд╢реЗрд▓ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП `/etc/shadow` рдХреЗ рдЕрдВрджрд░ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдореЗрдореЛрд░реА рдбрдВрдк

рдЪрд▓ рд░рд╣реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рдореЗрдореЛрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**LiME**](https://github.com/504ensicsLabs/LiME) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред\
рдЗрд╕реЗ **рд╕рдВрдХрд▓рд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ **рдЙрд╕реА рдХрд░реНрдиреЗрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИред

{% hint style="info" %}
рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрдк **рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдореЗрдВ LiME рдпрд╛ рдХреЛрдИ рдЕрдиреНрдп рдЪреАрдЬрд╝ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ** рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдЗрд╕рдореЗрдВ рдХрдИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрдВрдЧреЗ
{% endhint %}

рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Ubuntu рдХрд╛ рдПрдХ рд╕рдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рд╣реИ, рддреЛ рдЖрдк `apt-get install lime-forensics-dkms` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ [**LiME**](https://github.com/504ensicsLabs/LiME) рдХреЛ github рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ рд╕рд╣реА рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдХрд▓рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдХреЗ **рд╕рдЯреАрдХ рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛** `/lib/modules/<kernel version>` рдХреЛ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ **LiME** рдХреЛ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
make -C /lib/modules/<kernel version>/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
```
LiME 3 **рдлреЙрд░реНрдореЗрдЯреНрд╕** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

* рдХрдЪреНрдЪрд╛ (рд╣рд░ рдЦрдВрдб рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛)
* рдкреИрдбреЗрдб (рдХрдЪреНрдЪреЗ рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди рджрд╛рд╣рд┐рдиреЗ рдмрд┐рдЯреНрд╕ рдореЗрдВ рдЬрд╝реАрд░реЛ рдХреЗ рд╕рд╛рде)
* рд▓рд╛рдЗрдо (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлреЙрд░реНрдореЗрдЯ)

LiME рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрдВрдк рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдХреБрдЫ рдЗрд╕ рддрд░рд╣: `path=tcp:4444`

### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧ

#### рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдирд╛** рд╣реЛрдЧрд╛ред рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реЛрддрд╛ рдХреНрдпреЛрдВрдХрд┐ рдХрднреА-рдХрднреА рд╕рд┐рд╕реНрдЯрдо рдПрдХ рдкреНрд░реЛрдбрдХреНрд╢рди рд╕рд░реНрд╡рд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрдВрдкрдиреА рдмрдВрдж рдирд╣реАрдВ рдХрд░ рд╕рдХрддреАред\
рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ **2 рддрд░реАрдХреЗ** рд╣реИрдВ, рдПрдХ **рд╕рд╛рдорд╛рдиреНрдп рд╢рдЯрдбрд╛рдЙрди** рдФрд░ рдПрдХ **"рдкреНрд▓рдЧ рдХреЛ рдЦреАрдВрдЪрдирд╛" рд╢рдЯрдбрд╛рдЙрди**ред рдкрд╣рд▓рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд** рдХрд░рдиреЗ рдФрд░ **рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо** рдХреЛ **рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд **рдореИрд▓рд╡реЗрдпрд░** рдХреЛ **рд╕рд╛рдХреНрд╖реНрдп рдирд╖реНрдЯ** рдХрд░рдиреЗ рдХреА рднреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред "рдкреНрд▓рдЧ рдХреЛ рдЦреАрдВрдЪрдиреЗ" рдХрд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг **рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдиреБрдХрд╕рд╛рди** рдХреЛ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЬрд┐рддрдиреА рдЬрд╛рдирдХрд╛рд░реА рдЦреЛрдиреЗ рд╡рд╛рд▓реА рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдореЗрдореЛрд░реА рдХреА рдПрдХ рдЗрдореЗрдЬ рд▓реА рд╣реИ) рдФрд░ **рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдЕрд╡рд╕рд░ рдирд╣реАрдВ рдорд┐рд▓реЗрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рд╕рдВрджреЗрд╣** рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣рд╛рдБ **рдореИрд▓рд╡реЗрдпрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдмрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **`sync`** **рдХрдорд╛рдВрдб** рдЪрд▓рд╛рдПрдБ рдФрд░ рдкреНрд▓рдЧ рдХреЛ рдЦреАрдВрдЪреЗрдВред

#### рдбрд┐рд╕реНрдХ рдХреА рдЗрдореЗрдЬ рд▓реЗрдирд╛

рдпрд╣ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рд╕реЗ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЗрд╕реЗ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
#Create a raw copy of the disk
dd if=<subject device> of=<image file> bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=<subject device> of=<image file> bs=512 hash=<algorithm> hashwindow=<chunk size> hashlog=<hash file>
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
```
### Disk Image pre-analysis

рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдХреЛ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдФрд░ рдбреЗрдЯрд╛ рдХреЗ рдЗрдореЗрдЬ рдХрд░рдирд╛ред
```bash
#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЬреНрдЮрд╛рдд рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ

### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓реЗрдВ

Linux рд╕рд┐рд╕реНрдЯрдо рдШрдЯрдХреЛрдВ рдХреА рдЕрдЦрдВрдбрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

* **RedHat-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо**: рд╡реНрдпрд╛рдкрдХ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП `rpm -Va` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **Debian-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо**: рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП `dpkg --verify` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рдмрд╛рдж `debsums | grep -v "OK$"` (рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП `debsums` рдХреЛ `apt-get install debsums` рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рд╕рдорд╕реНрдпрд╛ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗред

### рдореИрд▓рд╡реЗрдпрд░/рд░реВрдЯрдХрд┐рдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░реНрд╕

рдореИрд▓рд╡реЗрдпрд░ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрдврд╝реЗрдВ:

{% content-ref url="malware-analysis.md" %}
[malware-analysis.md](malware-analysis.md)
{% endcontent-ref %}

## рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ

Debian рдФрд░ RedHat рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдкреНрд░рднрд╛рд╡реА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП, рд╕рд╛рдорд╛рдиреНрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдореИрдиреБрдЕрд▓ рдЬрд╛рдВрдЪ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред

* Debian рдХреЗ рд▓рд┐рдП, рдкреИрдХреЗрдЬ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _**`/var/lib/dpkg/status`**_ рдФрд░ _**`/var/log/dpkg.log`**_ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рд╡рд┐рд╢реЗрд╖ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП `grep` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* RedHat рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬреЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП `rpm -qa --root=/mntpath/var/lib/rpm` рдХреЗ рд╕рд╛рде RPM рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрди рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЗ рдмрд╛рд╣рд░ рдпрд╛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, _**`/usr/local`**_, _**`/opt`**_, _**`/usr/sbin`**_, _**`/usr/bin`**_, _**`/bin`**_, рдФрд░ _**`/sbin`**_ рдЬреИрд╕реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░реЗрдВред рдЬреНрдЮрд╛рдд рдкреИрдХреЗрдЬреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рд╕рд┐рд╕реНрдЯрдо-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдПрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рд╕рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдЦреЛрдЬ рдХреЛ рдмрдврд╝рд╛ рд╕рдХреЗрдВред
```bash
# Debian package and log details
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
# RedHat RPM database query
rpm -qa --root=/mntpath/var/lib/rpm
# Listing directories for manual installations
ls /usr/sbin /usr/bin /bin /sbin
# Identifying non-package executables (Debian)
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
# Identifying non-package executables (RedHat)
find /sbin/ тАУexec rpm -qf {} \; | grep "is not"
# Find exacuable files
find / -type f -executable | grep <something>
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╣рдЯрд╛рдП рдЧрдП рдЪрд▓ рд░рд╣реЗ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ /tmp/exec рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЧрдИ рдереА рдФрд░ рдлрд┐рд░ рд╣рдЯрд╛ рджреА рдЧрдИред рдЗрд╕реЗ рдирд┐рдХрд╛рд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ
```bash
cd /proc/3746/ #PID with the exec file deleted
head -1 maps #Get address of the file. It was 08048000-08049000
dd if=mem bs=1 skip=08048000 count=1000 of=/tmp/exec2 #Recorver it
```
## рдСрдЯреЙрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реЗрдВ

### рдЕрдиреБрд╕реВрдЪрд┐рдд рдХрд╛рд░реНрдп
```bash
cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
```
### Services

рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рд╕реЗрд╡рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрде:

* **/etc/inittab**: рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЬреИрд╕реЗ rc.sysinit рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рдЖрдЧреЗ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **/etc/rc.d/** рдФрд░ **/etc/rc.boot/**: рд╕реЗрд╡рд╛ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ, рдмрд╛рдж рд╡рд╛рд▓рд╛ рдкреБрд░рд╛рдиреЗ Linux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **/etc/init.d/**: рдХреБрдЫ Linux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдЬреИрд╕реЗ Debian рдореЗрдВ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* рд╕реЗрд╡рд╛рдПрдБ **/etc/inetd.conf** рдпрд╛ **/etc/xinetd/** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рд╕рдХреНрд░рд┐рдп рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, Linux рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред
* **/etc/systemd/system**: рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
* **/etc/systemd/system/multi-user.target.wants/**: рдЙрди рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдорд▓реНрдЯреА-рдпреВрдЬрд░ рд░рдирд▓реЗрд╡рд▓ рдореЗрдВ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* **/usr/local/etc/rc.d/**: рдХрд╕реНрдЯрдо рдпрд╛ рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдПред
* **\~/.config/autostart/**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд▓рдХреНрд╖рд┐рдд рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫрд┐рдкрдиреЗ рдХреА рдЬрдЧрд╣ рд╣реЛ рд╕рдХрддреА рд╣реИред
* **/lib/systemd/system/**: рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдпреВрдирд┐рдЯ рдлрд╝рд╛рдЗрд▓реЗрдВред

### Kernel Modules

Linux рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓, рдЬреЛ рдЕрдХреНрд╕рд░ рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд░реВрдЯрдХрд┐рдЯ рдШрдЯрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рдмреВрдЯ рдкрд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВред рдЗрди рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ рдФрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **/lib/modules/$(uname -r)**: рдЪрд▓ рд░рд╣реЗ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓ рд░рдЦрддрд╛ рд╣реИред
* **/etc/modprobe.d**: рдореЙрдбреНрдпреВрд▓ рд▓реЛрдбрд┐рдВрдЧ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВред
* **/etc/modprobe** рдФрд░ **/etc/modprobe.conf**: рд╡реИрд╢реНрд╡рд┐рдХ рдореЙрдбреНрдпреВрд▓ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЗрдВред

### Other Autostart Locations

Linux рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЖрд╢реНрд░рдп рджреЗ рд╕рдХрддреЗ рд╣реИрдВ:

* **/etc/profile.d/**\*, **/etc/profile**, рдФрд░ **/etc/bash.bashrc**: рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* **\~/.bashrc**, **\~/.bash\_profile**, **\~/.profile**, рдФрд░ **\~/.config/autostart**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреЛ рдЙрдирдХреЗ рд▓реЙрдЧрд┐рди рдкрд░ рдЪрд▓рддреА рд╣реИрдВред
* **/etc/rc.local**: рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЪрд▓рддреА рд╣реИ, рдорд▓реНрдЯреАрдпреВрдЬрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХреЗ рдЕрдВрдд рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддреА рд╣реИред

## Examine Logs

Linux рд╕рд┐рд╕реНрдЯрдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдШрдЯрдирд╛рдУрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИред рдпреЗ рд▓реЙрдЧ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ, рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдХреНрд░рдордг, рдФрд░ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред рдкреНрд░рдореБрдЦ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **/var/log/syslog** (Debian) рдпрд╛ **/var/log/messages** (RedHat): рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рд╕рдВрджреЗрд╢реЛрдВ рдФрд░ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред
* **/var/log/auth.log** (Debian) рдпрд╛ **/var/log/secure** (RedHat): рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕реЛрдВ, рд╕рдлрд▓ рдФрд░ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред
* рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдШрдЯрдирд╛рдУрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `grep -iE "session opened for|accepted password|new session|not in sudoers" /var/log/auth.log` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **/var/log/boot.log**: рд╕рд┐рд╕реНрдЯрдо рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/maillog** рдпрд╛ **/var/log/mail.log**: рдИрдореЗрд▓ рд╕рд░реНрд╡рд░ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИ, рдИрдореЗрд▓ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреАред
* **/var/log/kern.log**: рдХрд░реНрдиреЗрд▓ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдФрд░ рдЪреЗрддрд╛рд╡рдирд┐рдпрд╛рдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **/var/log/dmesg**: рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/faillog**: рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ, рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдХреА рдЬрд╛рдВрдЪ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред
* **/var/log/cron**: рдХреНрд░реЛрди рдЬреЙрдм рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
* **/var/log/daemon.log**: рдкреГрд╖реНрдарднреВрдорд┐ рд╕реЗрд╡рд╛ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИред
* **/var/log/btmp**: рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬреАрдХрд░рдг рдХрд░рддрд╛ рд╣реИред
* **/var/log/httpd/**: Apache HTTPD рддреНрд░реБрдЯрд┐ рдФрд░ рдПрдХреНрд╕реЗрд╕ рд▓реЙрдЧ рдХреЛ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/mysqld.log** рдпрд╛ **/var/log/mysql.log**: MySQL рдбреЗрдЯрд╛рдмреЗрд╕ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
* **/var/log/xferlog**: FTP рдлрд╝рд╛рдЗрд▓ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред
* **/var/log/**: рдпрд╣рд╛рдБ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд▓реЙрдЧ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

{% hint style="info" %}
Linux рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдФрд░ рдСрдбрд┐рдЯ рдЙрдкрдкреНрд░рдгрд╛рд▓рд┐рдпрд╛рдБ рдПрдХ рдШреБрд╕рдкреИрда рдпрд╛ рдореИрд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛ рдореЗрдВ рдЕрдХреНрд╖рдо рдпрд╛ рд╣рдЯрд╛ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдХреНрдпреЛрдВрдХрд┐ Linux рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд▓реЙрдЧ рдЖрдорддреМрд░ рдкрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ, рдШреБрд╕рдкреИрдард┐рдП рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдЙрдкрд▓рдмреНрдз рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╕рдордп, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдк рдЙрди рдЕрдВрддрд░рд╛рд▓реЛрдВ рдпрд╛ рдЕрдиреБрдХреНрд░рдо рд╕реЗ рдмрд╛рд╣рд░ рдХреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рдЬреЛ рд╣рдЯрд╛рдиреЗ рдпрд╛ рдЫреЗрдбрд╝рдЫрд╛рдбрд╝ рдХрд╛ рд╕рдВрдХреЗрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}

**Linux рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдорд╛рдВрдб рдЗрддрд┐рд╣рд╛рд╕ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ**, рдЬреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ:

* \~/.bash\_history
* \~/.zsh\_history
* \~/.zsh\_sessions/\*
* \~/.python\_history
* \~/.\*\_history

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, `last -Faiwx` рдХрдорд╛рдВрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЕрдЬреНрдЮрд╛рдд рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

* рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП `/etc/sudoers` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП `/etc/sudoers.d/` рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* рдХрд┐рд╕реА рднреА рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рд╕рджрд╕реНрдпрддрд╛ рдпрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/etc/groups` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
* рдХрд┐рд╕реА рднреА рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рд╕рджрд╕реНрдпрддрд╛ рдпрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/etc/passwd` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

рдХреБрдЫ рдРрдкреНрд╕ рднреА рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ:

* **SSH**: рдЕрдирдзрд┐рдХреГрдд рджреВрд░рд╕реНрде рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП _\~/.ssh/authorized\_keys_ рдФрд░ _\~/.ssh/known\_hosts_ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
* **Gnome Desktop**: Gnome рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП _\~/.recently-used.xbel_ рдореЗрдВ рджреЗрдЦреЗрдВред
* **Firefox/Chrome**: рд╕рдВрджрд┐рдЧреНрдз рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП _\~/.mozilla/firefox_ рдпрд╛ _\~/.config/google-chrome_ рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред
* **VIM**: рдЙрдкрдпреЛрдЧ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП _\~/.viminfo_ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ, рдЬреИрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдкрде рдФрд░ рдЦреЛрдЬ рдЗрддрд┐рд╣рд╛рд╕ред
* **Open Office**: рд╣рд╛рд▓ рдХреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрд╣реБрдВрдЪ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ рд╕рдордЭреМрддрд╛ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИред
* **FTP/SFTP**: рдЕрдирдзрд┐рдХреГрдд рдлрд╝рд╛рдЗрд▓ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХреЗ рд▓рд┐рдП _\~/.ftp\_history_ рдпрд╛ _\~/.sftp\_history_ рдореЗрдВ рд▓реЙрдЧ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред
* **MySQL**: рдЕрдирдзрд┐рдХреГрдд рдбреЗрдЯрд╛рдмреЗрд╕ рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП _\~/.mysql\_history_ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
* **Less**: рдЙрдкрдпреЛрдЧ рдЗрддрд┐рд╣рд╛рд╕ рдХреЗ рд▓рд┐рдП _\~/.lesshst_ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ, рдЬрд┐рд╕рдореЗрдВ рджреЗрдЦреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрдорд╛рдВрдб рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **Git**: рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд▓рд┐рдП _\~/.gitconfig_ рдФрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ _.git/logs_ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

### USB Logs

[**usbrip**](https://github.com/snovvcrash/usbrip) рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╣реИ рдЬреЛ рд╢реБрджреНрдз Python 3 рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ USB рдЗрд╡реЗрдВрдЯ рдЗрддрд┐рд╣рд╛рд╕ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Linux рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ (`/var/log/syslog*` рдпрд╛ `/var/log/messages*` рд╡рд┐рддрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░) рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдЬрд╛рдирдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ **рд╕рднреА USBs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рдФрд░ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ "рдЙрд▓реНрд▓рдВрдШрди рдШрдЯрдирд╛рдУрдВ" (рдЙрди USBs рдХрд╛ рдЙрдкрдпреЛрдЧ рдЬреЛ рдЙрд╕ рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВ) рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХреГрдд USBs рдХреА рд╕реВрдЪреА рд╣реИ рддреЛ рдпрд╣ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ред

### Installation
```bash
pip3 install usbrip
usbrip ids download #Download USB ID database
```
### рдЙрджрд╛рд╣рд░рдг
```bash
usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
```
More examples and info inside the github: [https://github.com/snovvcrash/usbrip](https://github.com/snovvcrash/usbrip)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдФрд░ рд▓реЙрдЧрд┐рди рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ

_**/etc/passwd**_, _**/etc/shadow**_ рдФрд░ **рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╛рдореЛрдВ рдпрд╛ рдЦрд╛рддреЛрдВ рдХрд╛ рдкрддрд╛ рдЪрд▓ рд╕рдХреЗ рдЬреЛ рдЬреНрдЮрд╛рдд рдЕрдирдзрд┐рдХреГрдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдХрдЯрддрд╛ рдореЗрдВ рдмрдирд╛рдП рдЧрдП рдпрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдВрднрд╛рд╡рд┐рдд sudo рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, _**/etc/sudoers**_ рдФрд░ _**/etc/groups**_ рдЬреИрд╕реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджрд┐рдП рдЧрдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рдкрддрд╛ рдЪрд▓ рд╕рдХреЗред\
рдЕрдВрдд рдореЗрдВ, **рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ** рдпрд╛ **рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рдирд┐рдд** рдкрд╛рд╕рд╡рд░реНрдб рд╡рд╛рд▓реЗ рдЦрд╛рддреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВред

## рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдореИрд▓рд╡реЗрдпрд░ рдЬрд╛рдВрдЪ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдЬрдм рдореИрд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рдХреА рд╕рдВрд░рдЪрдирд╛ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрд░реЛрдд рд╣реЛрддреА рд╣реИ, рдЬреЛ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдФрд░ рдореИрд▓рд╡реЗрдпрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреА рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдореИрд▓рд╡реЗрдпрд░ рд▓реЗрдЦрдХ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЗрдВ рд╡рд┐рдХрд╕рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдпрд╛ рдбреЗрдЯрд╛ рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рд╕реЗ рдмрдЪрдирд╛ред

рдЗрди рдПрдВрдЯреА-рдлреЙрд░реЗрдВрд╕рд┐рдХ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдореБрдХрд╛рдмрд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

* **рдШрдирд┐рд╖реНрда рд╕рдордпрд░реЗрдЦрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг** рдХрд░реЗрдВ, рдЬреИрд╕реЗ **Autopsy** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рдордпрд░реЗрдЦрд╛ рдХреЛ рджреГрд╢реНрдп рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ рдпрд╛ **Sleuth Kit's** `mactime` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╕реНрддреГрдд рд╕рдордпрд░реЗрдЦрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ред
* **рд╕рд┐рд╕реНрдЯрдо рдХреЗ $PATH рдореЗрдВ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**, рдЬрд┐рд╕рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╢реЗрд▓ рдпрд╛ PHP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдЕрд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП `/dev` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рднреА рд░рдЦ рд╕рдХрддрд╛ рд╣реИред
* **рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ** рдЬрд┐рдирдХреЗ рдирд╛рдо ".. " (рдбреЙрдЯ рдбреЙрдЯ рд╕реНрдкреЗрд╕) рдпрд╛ "..^G" (рдбреЙрдЯ рдбреЙрдЯ рдХрдВрдЯреНрд░реЛрд▓-G) рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЫрд┐рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **setuid рд░реВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: `find / -user root -perm -04000 -print` рдпрд╣ рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдЙрдЪреНрдЪ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдорд╛рд╕ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдиреЛрдб рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╣рдЯрд╛рдиреЗ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ**, рдЬреЛ рд╕рдВрднрд╡рддрдГ рд░реВрдЯрдХрд┐рдЯ рдпрд╛ рдЯреНрд░реЛрдЬрди рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВред
* **рдПрдХ рдмрд╛рд░ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж рдирд┐рдХрдЯрд╡рд░реНрддреА рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд▓рдЧрд╛рддрд╛рд░ рдЗрдиреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**, рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕рд╛рде рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдмрд╛рдЗрдирд░реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ** (_/bin_, _/sbin_) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЗрдиреНрд╣реЗрдВ рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
````bash
# List recent files in a directory:
ls -laR --sort=time /bin```

# Sort files in a directory by inode:
ls -lai /bin | sort -n```
````
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** **рд╕рдордп** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдлрд╛рдЗрд▓реЗрдВ рд╡реИрдз** **рджрд┐рдЦреЗрдВ**, рд▓реЗрдХрд┐рди рд╡рд╣ **inode** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред рдпрджрд┐ рдЖрдк рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ **рдлрд╛рдЗрд▓** рдпрд╣ рджрд░реНрд╢рд╛рддреА рд╣реИ рдХрд┐ рдЗрд╕реЗ рдЙрд╕реА рд╕рдордп **рдмрдирд╛рдпрд╛** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреИрд╕реЗ рдХрд┐ рдЙрд╕реА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ, рд▓реЗрдХрд┐рди **inode** **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдмрдбрд╝рд╛** рд╣реИ, рддреЛ рдЙрд╕ **рдлрд╛рдЗрд▓ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**ред
{% endhint %}

## рд╡рд┐рднрд┐рдиреНрди рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ

### рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдг рддреБрд▓рдирд╛ рд╕рд╛рд░рд╛рдВрд╢

рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рд░рд▓ `git diff` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:

* **рдирдИ рдлрд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП**, рджреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ:
```bash
git diff --no-index --diff-filter=A path/to/old_version/ path/to/new_version/
```
* **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП**, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдЕрдирджреЗрдЦреА рдХрд░рддреЗ рд╣реБрдП рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:
```bash
git diff --no-index --diff-filter=M path/to/old_version/ path/to/new_version/ | grep -E "^\+" | grep -v "Installed-Time"
```
* **рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП**:
```bash
git diff --no-index --diff-filter=D path/to/old_version/ path/to/new_version/
```
* **рдлрд┐рд▓реНрдЯрд░ рд╡рд┐рдХрд▓реНрдк** (`--diff-filter`) рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдЬреИрд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП (`A`), рд╣рдЯрд╛рдП рдЧрдП (`D`), рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд (`M`) рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред
* `A`: рдЬреЛрдбрд╝реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
* `C`: рдХреЙрдкреА рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
* `D`: рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
* `M`: рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
* `R`: рдирд╛рдо рдмрджрд▓реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
* `T`: рдкреНрд░рдХрд╛рд░ рдкрд░рд┐рд╡рд░реНрддрди (рдЬреИрд╕реЗ, рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╕рд┐рдореНрд▓рд┐рдВрдХ)
* `U`: рдЕрд╕рдВрдпреБрдХреНрдд рдлрд╝рд╛рдЗрд▓реЗрдВ
* `X`: рдЕрдЬреНрдЮрд╛рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
* `B`: рдЯреВрдЯреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ

## рд╕рдВрджрд░реНрдн

* [https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf](https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf)
* [https://www.plesk.com/blog/featured/linux-logs-explained/](https://www.plesk.com/blog/featured/linux-logs-explained/)
* [https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203](https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203)
* **рдкреБрд╕реНрддрдХ: Linux Systems рдХреЗ рд▓рд┐рдП Malware Forensics Field Guide: Digital Forensics Field Guides**

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
