<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©**? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks**? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Feuilles de triche en informatique lÃ©gale

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/#)

# Services en ligne

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)

# Outils antivirus et de dÃ©tection hors ligne

## Yara

### Installer
```bash
sudo apt-get install -y yara
```
### PrÃ©parer les rÃ¨gles

Utilisez ce script pour tÃ©lÃ©charger et fusionner toutes les rÃ¨gles de malware yara depuis Github: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
CrÃ©ez le rÃ©pertoire _**rules**_ et exÃ©cutez-le. Cela crÃ©era un fichier appelÃ© _**malware\_rules.yar**_ qui contient toutes les rÃ¨gles yara pour les malwares.
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
### Analyse

La premiÃ¨re Ã©tape de l'analyse de logiciels malveillants consiste Ã  scanner le fichier suspect Ã  l'aide d'un logiciel antivirus ou d'un outil d'analyse de logiciels malveillants. Cela permet de dÃ©tecter rapidement les menaces connues et de dÃ©terminer si le fichier est infectÃ© ou non. Il est important d'utiliser plusieurs outils de numÃ©risation pour augmenter les chances de dÃ©tecter les menaces.

Si le fichier est dÃ©tectÃ© comme malveillant, il est important de prendre des mesures immÃ©diates pour isoler le fichier et empÃªcher la propagation de la menace. Si le fichier n'est pas dÃ©tectÃ© comme malveillant, cela ne signifie pas nÃ©cessairement qu'il est sÃ»r. Il est important de poursuivre l'analyse pour dÃ©terminer si le fichier est malveillant ou non.
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
### YaraGen: VÃ©rification de logiciels malveillants et crÃ©ation de rÃ¨gles

Vous pouvez utiliser l'outil [**YaraGen**](https://github.com/Neo23x0/yarGen) pour gÃ©nÃ©rer des rÃ¨gles yara Ã  partir d'un binaire. Consultez ces tutoriels: [**Partie 1**](https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/) , [**Partie 2**](https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/) , [**Partie 3**](https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
 python3 yarGen.py --update
 python3.exe yarGen.py --excludegood -m  ../../mals/
```
## ClamAV

### Installation
```
sudo apt-get install -y clamav
```
### Analyse

La premiÃ¨re Ã©tape de l'analyse de logiciels malveillants consiste Ã  scanner le fichier suspect Ã  l'aide d'un logiciel antivirus ou d'un outil d'analyse de logiciels malveillants. Cela permet de dÃ©tecter rapidement les menaces connues et de dÃ©terminer si le fichier est infectÃ© ou non. Il est important d'utiliser plusieurs outils de numÃ©risation pour augmenter les chances de dÃ©tecter les menaces.

Une fois que le fichier a Ã©tÃ© scannÃ©, il est important de vÃ©rifier les rÃ©sultats de l'analyse. Si le fichier est dÃ©tectÃ© comme malveillant, il est important de dÃ©terminer le type de menace et les actions qu'elle peut effectuer sur le systÃ¨me. Si le fichier n'est pas dÃ©tectÃ© comme malveillant, cela ne signifie pas nÃ©cessairement qu'il est sÃ»r. Il est important de poursuivre l'analyse pour dÃ©terminer si le fichier est malveillant ou non.
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
## IOCs

IOC signifie Indicateur de compromission. Un IOC est un ensemble de **conditions qui identifient** un logiciel potentiellement indÃ©sirable ou un **logiciel malveillant confirmÃ©**. Les Ã©quipes de sÃ©curitÃ© (Blue Teams) utilisent ce type de dÃ©finition pour **rechercher ce type de fichiers malveillants** dans leurs **systÃ¨mes** et **rÃ©seaux**.\
Le partage de ces dÃ©finitions est trÃ¨s utile car lorsque des logiciels malveillants sont identifiÃ©s sur un ordinateur et qu'un IOC pour ce logiciel malveillant est crÃ©Ã©, d'autres Ã©quipes de sÃ©curitÃ© peuvent l'utiliser pour identifier plus rapidement le logiciel malveillant.

Un outil pour crÃ©er ou modifier des IOCs est [**IOC Editor**](https://www.fireeye.com/services/freeware/ioc-editor.html)**.**\
Vous pouvez utiliser des outils tels que [**Redline**](https://www.fireeye.com/services/freeware/redline.html) pour **rechercher des IOCs dÃ©finis sur un appareil**.

## Loki

[**Loki**](https://github.com/Neo23x0/Loki) est un scanner pour les Indicateurs de Compromission Simples.\
La dÃ©tection est basÃ©e sur quatre mÃ©thodes de dÃ©tection :
```
1. File Name IOC
   Regex match on full file path/name

2. Yara Rule Check
   Yara signature matches on file data and process memory

3. Hash Check
   Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files
   
4. C2 Back Connect Check
   Compares process connection endpoints with C2 IOCs (new since version v.10)
```
## Linux Malware Detect

[**Linux Malware Detect (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/) est un scanner de logiciels malveillants pour Linux publiÃ© sous la licence GNU GPLv2, conÃ§u pour faire face aux menaces rencontrÃ©es dans les environnements d'hÃ©bergement partagÃ©. Il utilise les donnÃ©es de menace des systÃ¨mes de dÃ©tection d'intrusion en bordure de rÃ©seau pour extraire les logiciels malveillants qui sont activement utilisÃ©s dans les attaques et gÃ©nÃ¨re des signatures pour la dÃ©tection. De plus, les donnÃ©es de menace sont Ã©galement dÃ©rivÃ©es des soumissions d'utilisateurs avec la fonction de vÃ©rification LMD et des ressources de la communautÃ© de logiciels malveillants.

## rkhunter

Des outils comme [**rkhunter**](http://rkhunter.sourceforge.net) peuvent Ãªtre utilisÃ©s pour vÃ©rifier le systÃ¨me de fichiers pour les possibles **rootkits** et logiciels malveillants.
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
## PEpper

[PEpper](https://github.com/Th3Hurrican3/PEpper) vÃ©rifie quelques Ã©lÃ©ments de base Ã  l'intÃ©rieur de l'exÃ©cutable (donnÃ©es binaires, entropie, URLs et IPs, quelques rÃ¨gles yara).

## NeoPI

[**NeoPI**](https://github.com/CiscoCXSecurity/NeoPI) est un script Python qui utilise une variÃ©tÃ© de **mÃ©thodes statistiques** pour dÃ©tecter du contenu **obscurci** et **cryptÃ©** dans des fichiers texte/script. Le but de NeoPI est d'aider Ã  la **dÃ©tection de code de shell web cachÃ©**.

## **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder) fait de son mieux pour dÃ©tecter du code **obscurci**/**douteux** ainsi que des fichiers utilisant des fonctions **PHP** souvent utilisÃ©es dans les **malwares**/shell web.

## Signatures binaires Apple

Lors de la vÃ©rification d'un **Ã©chantillon de malware**, vous devriez toujours **vÃ©rifier la signature** du binaire car le **dÃ©veloppeur** qui l'a signÃ© peut dÃ©jÃ  Ãªtre **liÃ©** Ã  un **malware**.
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
# Techniques de dÃ©tection

## Empilement de fichiers

Si vous savez qu'un dossier contenant les **fichiers** d'un serveur web a Ã©tÃ© **derniÃ¨rement mis Ã  jour Ã  une certaine date**. **VÃ©rifiez** la **date** Ã  laquelle tous les **fichiers** du **serveur web ont Ã©tÃ© crÃ©Ã©s et modifiÃ©s** et si une date est **suspecte**, vÃ©rifiez ce fichier.

## Baselines

Si les fichiers d'un dossier **ne devraient pas avoir Ã©tÃ© modifiÃ©s**, vous pouvez calculer le **hash** des **fichiers originaux** du dossier et les **comparer** avec les **fichiers actuels**. Tout ce qui a Ã©tÃ© modifiÃ© sera **suspect**.

## Analyse statistique

Lorsque les informations sont enregistrÃ©es dans des journaux, vous pouvez **vÃ©rifier des statistiques comme le nombre de fois oÃ¹ chaque fichier d'un serveur web a Ã©tÃ© accÃ©dÃ© car un shell web pourrait Ãªtre l'un des plus**.
