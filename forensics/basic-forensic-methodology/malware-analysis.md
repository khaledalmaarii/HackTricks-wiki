# ì•…ì„±ì½”ë“œ ë¶„ì„

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ **Discord ê·¸ë£¹**ì— **ê°€ì…**í•˜ì„¸ìš”(https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
{% endhint %}

## í¬ë Œì‹ ì¹˜íŠ¸ì‹œíŠ¸

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/)

## ì˜¨ë¼ì¸ ì„œë¹„ìŠ¤

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)
* [Any.Run](https://any.run/)

## ì˜¤í”„ë¼ì¸ ë°±ì‹  ë° íƒì§€ ë„êµ¬

### Yara

#### ì„¤ì¹˜
```bash
sudo apt-get install -y yara
```
#### ê·œì¹™ ì¤€ë¹„

ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ githubì—ì„œ ëª¨ë“  yara ì•…ì„± ì½”ë“œ ê·œì¹™ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ë³‘í•©í•©ë‹ˆë‹¤: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
_**rules**_ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•˜ì‹­ì‹œì˜¤. ì´ë ‡ê²Œ í•˜ë©´ _**malware\_rules.yar**_ì´ë¼ëŠ” íŒŒì¼ì´ ìƒì„±ë˜ë©° ì´ íŒŒì¼ì—ëŠ” ì•…ì„± ì½”ë“œì— ëŒ€í•œ ëª¨ë“  yara ê·œì¹™ì´ í¬í•¨ë©ë‹ˆë‹¤.
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
#### ìŠ¤ìº”
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
#### YaraGen: ì•…ì„± ì½”ë“œ í™•ì¸ ë° ê·œì¹™ ìƒì„±

**YaraGen** ë„êµ¬(https://github.com/Neo23x0/yarGen)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ì§„ íŒŒì¼ì—ì„œ yara ê·œì¹™ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ììŠµì„œë¥¼ í™•ì¸í•˜ì„¸ìš”: **Part 1**(https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/), **Part 2**(https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/), **Part 3**(https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
python3 yarGen.py --update
python3.exe yarGen.py --excludegood -m  ../../mals/
```
### ClamAV

#### ì„¤ì¹˜
```
sudo apt-get install -y clamav
```
#### ìŠ¤ìº”
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
### [Capa](https://github.com/mandiant/capa)

**Capa**ëŠ” ì‹¤í–‰ íŒŒì¼(PE, ELF, .NET)ì—ì„œ ì ì¬ì ìœ¼ë¡œ ì•…ì˜ì ì¸ **ê¸°ëŠ¥**ì„ ê°ì§€í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Att\&ck ì „ìˆ ê³¼ ê°™ì€ ê²ƒë“¤ ë˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- OutputDebugString ì˜¤ë¥˜ í™•ì¸
- ì„œë¹„ìŠ¤ë¡œ ì‹¤í–‰
- í”„ë¡œì„¸ìŠ¤ ìƒì„±

[**Github ì €ì¥ì†Œ**](https://github.com/mandiant/capa)ì—ì„œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### IOCs

IOCëŠ” Compromiseì˜ ì§€í‘œë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. IOCëŠ” ì¼ë¶€ ì ì¬ì ìœ¼ë¡œ ì›ì¹˜ ì•ŠëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë˜ëŠ” í™•ì¸ëœ **ì•…ì„± ì½”ë“œ**ë¥¼ ì‹ë³„í•˜ëŠ” **ì¡°ê±´ ì§‘í•©**ì…ë‹ˆë‹¤. Blue Teamì€ ì‹œìŠ¤í…œ ë° ë„¤íŠ¸ì›Œí¬ì—ì„œ ì´ëŸ¬í•œ ì•…ì„± íŒŒì¼ì„ **ê²€ìƒ‰**í•˜ê¸° ìœ„í•´ ì´ëŸ¬í•œ ì •ì˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\
ì´ëŸ¬í•œ ì •ì˜ë¥¼ ê³µìœ í•˜ëŠ” ê²ƒì€ ì»´í“¨í„°ì—ì„œ ì•…ì„± ì½”ë“œê°€ ì‹ë³„ë˜ê³  í•´ë‹¹ ì•…ì„± ì½”ë“œì— ëŒ€í•œ IOCê°€ ìƒì„±ë  ë•Œ ë‹¤ë¥¸ Blue Teamì´ í•´ë‹¹ ì•…ì„± ì½”ë“œë¥¼ ë” ë¹¨ë¦¬ ì‹ë³„í•  ìˆ˜ ìˆë„ë¡ ë„ì›€ì´ ë©ë‹ˆë‹¤.

IOCë¥¼ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ë„êµ¬ëŠ” [**IOC Editor**](https://www.fireeye.com/services/freeware/ioc-editor.html)**ì…ë‹ˆë‹¤.**\
[**Redline**](https://www.fireeye.com/services/freeware/redline.html)ê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¥ì¹˜ì—ì„œ ì •ì˜ëœ IOCë¥¼ **ê²€ìƒ‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Loki

[**Loki**](https://github.com/Neo23x0/Loki)ëŠ” ê°„ë‹¨í•œ Compromise ì§€í‘œë¥¼ ìŠ¤ìº”í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.\
ê²€ì¶œì€ ë„¤ ê°€ì§€ ê²€ì¶œ ë°©ë²•ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤:
```
1. File Name IOC
Regex match on full file path/name

2. Yara Rule Check
Yara signature matches on file data and process memory

3. Hash Check
Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files

4. C2 Back Connect Check
Compares process connection endpoints with C2 IOCs (new since version v.10)
```
### Linux ì•…ì„± ì½”ë“œ íƒì§€

[**Linux ì•…ì„± ì½”ë“œ íƒì§€ (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/)ëŠ” GNU GPLv2 ë¼ì´ì„ ìŠ¤ í•˜ì— ì¶œì‹œëœ Linuxìš© ì•…ì„± ì½”ë“œ ìŠ¤ìºë„ˆë¡œ, ê³µìœ  í˜¸ìŠ¤íŒ… í™˜ê²½ì—ì„œ ì§ë©´í•œ ìœ„í˜‘ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ê°€ì¥ìë¦¬ ì¹¨ì… íƒì§€ ì‹œìŠ¤í…œì—ì„œ ìœ„í˜‘ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³µê²© ì¤‘ì— í™œë°œíˆ ì‚¬ìš©ë˜ëŠ” ì•…ì„± ì½”ë“œë¥¼ ì¶”ì¶œí•˜ê³  íƒì§€ë¥¼ ìœ„í•œ ì‹œê·¸ë‹ˆì²˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë˜í•œ, ìœ„í˜‘ ë°ì´í„°ëŠ” LMD ì²´í¬ì•„ì›ƒ ê¸°ëŠ¥ê³¼ ì•…ì„± ì½”ë“œ ì»¤ë®¤ë‹ˆí‹° ë¦¬ì†ŒìŠ¤ë¥¼ í†µí•´ ì‚¬ìš©ì ì œì¶œì—ì„œ íŒŒìƒë©ë‹ˆë‹¤.

### rkhunter

[**rkhunter**](http://rkhunter.sourceforge.net)ì™€ ê°™ì€ ë„êµ¬ëŠ” íŒŒì¼ ì‹œìŠ¤í…œì„ í™•ì¸í•˜ì—¬ ê°€ëŠ¥í•œ **ë£¨íŠ¸í‚·**ê³¼ ì•…ì„± ì½”ë“œë¥¼ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
### FLOSS

[**FLOSS**](https://github.com/mandiant/flare-floss)ëŠ” ë‹¤ì–‘í•œ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ íŒŒì¼ ë‚´ì—ì„œ ë‚œë…í™”ëœ ë¬¸ìì—´ì„ ì°¾ìœ¼ë ¤ê³  ì‹œë„í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### PEpper

[PEpper](https://github.com/Th3Hurrican3/PEpper)ëŠ” ì‹¤í–‰ íŒŒì¼ ë‚´ë¶€ì˜ ì¼ë¶€ ê¸°ë³¸ì ì¸ ë‚´ìš©(ì´ì§„ ë°ì´í„°, ì—”íŠ¸ë¡œí”¼, URL ë° IP, ì¼ë¶€ yara ê·œì¹™)ì„ í™•ì¸í•©ë‹ˆë‹¤.

### PEstudio

[PEstudio](https://www.winitor.com/download)ëŠ” Windows ì‹¤í–‰ íŒŒì¼ì˜ ì •ë³´(ì„í¬íŠ¸, ìµìŠ¤í¬íŠ¸, í—¤ë”)ë¥¼ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ë„êµ¬ì´ë©°, ë°”ì´ëŸ¬ìŠ¤ í† íƒˆì„ í™•ì¸í•˜ê³  ì ì¬ì ì¸ Att\&ck ê¸°ìˆ ì„ ì°¾ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### Detect It Easy(DiE)

[**DiE**](https://github.com/horsicq/Detect-It-Easy/)ëŠ” íŒŒì¼ì´ **ì•”í˜¸í™”**ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ê°ì§€í•˜ê³  **íŒ¨ì»¤**ë¥¼ ì°¾ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### NeoPI

[**NeoPI**](https://github.com/CiscoCXSecurity/NeoPI)ëŠ” ë‹¤ì–‘í•œ **í†µê³„ì  ë°©ë²•**ì„ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸/ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë‚´ì—ì„œ **ë‚œë…í™”** ë° **ì•”í˜¸í™”**ëœ ë‚´ìš©ì„ ê°ì§€í•˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. NeoPIì˜ ëª©ì ì€ **ìˆ¨ê²¨ì§„ ì›¹ ì‰˜ ì½”ë“œ**ë¥¼ ê°ì§€í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤.

### **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder)ëŠ” **ë‚œë…í™”**/**ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì½”ë“œ** ë° **ì•…ì„± ì½”ë“œ**/**ì›¹ ì‰˜**ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” **PHP** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ì„ ê°ì§€í•˜ê¸° ìœ„í•´ ìµœì„ ì„ ë‹¤í•©ë‹ˆë‹¤.

### Apple Binary Signatures

**ì•…ì„± ì½”ë“œ ìƒ˜í”Œ**ì„ í™•ì¸í•  ë•ŒëŠ” í•­ìƒ ì´ì§„ íŒŒì¼ì˜ **ì„œëª…**ì„ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ì„œëª…í•œ **ê°œë°œì**ê°€ ì´ë¯¸ **ì•…ì„± ì½”ë“œ**ì™€ ê´€ë ¨ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
## íƒì§€ ê¸°ìˆ 

### íŒŒì¼ ìŒ“ê¸°

ì›¹ ì„œë²„ì˜ **íŒŒì¼**ì´ í¬í•¨ëœ í´ë”ê°€ **íŠ¹ì • ë‚ ì§œì— ë§ˆì§€ë§‰ìœ¼ë¡œ ì—…ë°ì´íŠ¸**ëœ ê²ƒì„ ì•Œê³  ìˆë‹¤ë©´. **ì›¹ ì„œë²„ì˜ ëª¨ë“  íŒŒì¼ì´ ìƒì„± ë° ìˆ˜ì •ëœ ë‚ ì§œ**ë¥¼ í™•ì¸í•˜ê³  **ì˜ì‹¬ìŠ¤ëŸ¬ìš´** ë‚ ì§œê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.

### ê¸°ì¤€ì„ 

í´ë”ì˜ íŒŒì¼ì´ **ìˆ˜ì •ë˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” ê²½ìš°**, í´ë”ì˜ **ì›ë³¸ íŒŒì¼ì˜ í•´ì‹œ**ë¥¼ ê³„ì‚°í•˜ê³  **í˜„ì¬ íŒŒì¼**ê³¼ **ë¹„êµ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ì •ëœ ë‚´ìš©ì€ **ì˜ì‹¬ìŠ¤ëŸ¬ìš¸ ê²ƒ**ì…ë‹ˆë‹¤.

### í†µê³„ ë¶„ì„

ì •ë³´ê°€ ë¡œê·¸ì— ì €ì¥ëœ ê²½ìš°, ì›¹ ì„œë²„ì˜ ê° íŒŒì¼ì´ ì•¡ì„¸ìŠ¤ëœ íšŸìˆ˜ì™€ ê°™ì€ **í†µê³„ë¥¼ í™•ì¸**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›¹ ì‰˜ ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ë ˆí¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ **ê³µìœ **í•˜ì„¸ìš”.

</details>
{% endhint %}
