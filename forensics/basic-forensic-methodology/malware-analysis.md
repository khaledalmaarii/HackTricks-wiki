# æ¶æ„è½¯ä»¶åˆ†æ

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWSçº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## å–è¯é€ŸæŸ¥è¡¨

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/)

## åœ¨çº¿æœåŠ¡

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)
* [Any.Run](https://any.run/)

## ç¦»çº¿æ€æ¯’å’Œæ£€æµ‹å·¥å…·

### Yara

#### å®‰è£…
```bash
sudo apt-get install -y yara
```
#### å‡†å¤‡è§„åˆ™

ä½¿ç”¨æ­¤è„šæœ¬ä»githubä¸‹è½½å¹¶åˆå¹¶æ‰€æœ‰çš„yaraæ¶æ„è½¯ä»¶è§„åˆ™ï¼š[https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
åˆ›å»º _**rules**_ ç›®å½•å¹¶æ‰§è¡Œå®ƒã€‚è¿™å°†åˆ›å»ºä¸€ä¸ªåä¸º _**malware\_rules.yar**_ çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰é’ˆå¯¹æ¶æ„è½¯ä»¶çš„yaraè§„åˆ™ã€‚
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
#### æ‰«æ
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
#### YaraGenï¼šæ£€æŸ¥æ¶æ„è½¯ä»¶å’Œåˆ›å»ºè§„åˆ™

æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…· [**YaraGen**](https://github.com/Neo23x0/yarGen) ä»äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆyaraè§„åˆ™ã€‚æŸ¥çœ‹è¿™äº›æ•™ç¨‹ï¼š[**ç¬¬1éƒ¨åˆ†**](https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/)ï¼Œ[**ç¬¬2éƒ¨åˆ†**](https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/)ï¼Œ[**ç¬¬3éƒ¨åˆ†**](https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
python3 yarGen.py --update
python3.exe yarGen.py --excludegood -m  ../../mals/
```
### ClamAV

#### å®‰è£…
```
sudo apt-get install -y clamav
```
#### æ‰«æ
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
### [Capa](https://github.com/mandiant/capa)

**Capa** å¯ä»¥æ£€æµ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ½œåœ¨çš„æ¶æ„**èƒ½åŠ›**ï¼šPEã€ELFã€.NETã€‚å› æ­¤ï¼Œå®ƒä¼šå‘ç°ä¾‹å¦‚ Att\&ck æˆ˜æœ¯ï¼Œæˆ–è€…å¯ç–‘èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼š

* æ£€æŸ¥ OutputDebugString é”™è¯¯
* ä½œä¸ºæœåŠ¡è¿è¡Œ
* åˆ›å»ºè¿›ç¨‹

åœ¨ [**Github ä»“åº“**](https://github.com/mandiant/capa) è·å–å®ƒã€‚

### IOCs

IOC æŒ‡çš„æ˜¯å¦¥åæŒ‡æ ‡ã€‚IOC æ˜¯ä¸€ç»„**æ¡ä»¶ï¼Œç”¨äºè¯†åˆ«**ä¸€äº›å¯èƒ½ä¸å—æ¬¢è¿çš„è½¯ä»¶æˆ–å·²ç¡®è®¤çš„**æ¶æ„è½¯ä»¶**ã€‚è“é˜Ÿä½¿ç”¨è¿™ç§å®šä¹‰æ¥**åœ¨ä»–ä»¬çš„**ç³»ç»Ÿ**å’Œ**ç½‘ç»œ**ä¸­æœç´¢è¿™ç±»æ¶æ„æ–‡ä»¶**ã€‚\
åˆ†äº«è¿™äº›å®šä¹‰éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå½“åœ¨è®¡ç®—æœºä¸­è¯†åˆ«å‡ºæ¶æ„è½¯ä»¶å¹¶ä¸ºè¯¥æ¶æ„è½¯ä»¶åˆ›å»ºäº† IOC åï¼Œå…¶ä»–è“é˜Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥æ›´å¿«åœ°è¯†åˆ«æ¶æ„è½¯ä»¶ã€‚

åˆ›å»ºæˆ–ä¿®æ”¹ IOCs çš„å·¥å…·æ˜¯ [**IOC ç¼–è¾‘å™¨**](https://www.fireeye.com/services/freeware/ioc-editor.html)**ã€‚**\
æ‚¨å¯ä»¥ä½¿ç”¨ [**Redline**](https://www.fireeye.com/services/freeware/redline.html) ç­‰å·¥å…·**åœ¨è®¾å¤‡ä¸­æœç´¢å®šä¹‰çš„ IOCs**ã€‚

### Loki

[**Loki**](https://github.com/Neo23x0/Loki) æ˜¯ä¸€ä¸ªç®€å•å¦¥åæŒ‡æ ‡çš„æ‰«æå™¨ã€‚\
æ£€æµ‹åŸºäºå››ç§æ£€æµ‹æ–¹æ³•ï¼š
```
1. File Name IOC
Regex match on full file path/name

2. Yara Rule Check
Yara signature matches on file data and process memory

3. Hash Check
Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files

4. C2 Back Connect Check
Compares process connection endpoints with C2 IOCs (new since version v.10)
```
### Linux Malware Detect

[**Linux Malware Detect (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/) æ˜¯ä¸€æ¬¾åœ¨ GNU GPLv2 è®¸å¯ä¸‹å‘å¸ƒçš„ Linux æ¶æ„è½¯ä»¶æ‰«æå™¨ï¼Œä¸“ä¸ºå…±äº«æ‰˜ç®¡ç¯å¢ƒä¸­é¢ä¸´çš„å¨èƒè€Œè®¾è®¡ã€‚å®ƒä½¿ç”¨æ¥è‡ªç½‘ç»œè¾¹ç¼˜å…¥ä¾µæ£€æµ‹ç³»ç»Ÿçš„å¨èƒæ•°æ®æ¥æå–æ­£åœ¨æ”»å‡»ä¸­ç§¯æä½¿ç”¨çš„æ¶æ„è½¯ä»¶ï¼Œå¹¶ç”Ÿæˆç”¨äºæ£€æµ‹çš„ç­¾åã€‚æ­¤å¤–ï¼Œå¨èƒæ•°æ®è¿˜æ¥è‡ªç”¨æˆ·é€šè¿‡ LMD ç»“è´¦åŠŸèƒ½çš„æäº¤ä»¥åŠæ¶æ„è½¯ä»¶ç¤¾åŒºèµ„æºã€‚

### rkhunter

åƒ [**rkhunter**](http://rkhunter.sourceforge.net) è¿™æ ·çš„å·¥å…·å¯ä»¥ç”¨æ¥æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿä¸­å¯èƒ½å­˜åœ¨çš„ **rootkits** å’Œæ¶æ„è½¯ä»¶ã€‚
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
### FLOSS

[**FLOSS**](https://github.com/mandiant/flare-floss) æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒä¼šå°è¯•ä½¿ç”¨ä¸åŒæŠ€æœ¯åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ‰¾åˆ°æ··æ·†çš„å­—ç¬¦ä¸²ã€‚

### PEpper

[PEpper](https://github.com/Th3Hurrican3/PEpper) æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶å†…çš„ä¸€äº›åŸºæœ¬å†…å®¹ï¼ˆäºŒè¿›åˆ¶æ•°æ®ã€ç†µã€URLå’ŒIPï¼Œä¸€äº›yaraè§„åˆ™ï¼‰ã€‚

### PEstudio

[PEstudio](https://www.winitor.com/download) æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå…è®¸è·å–Windowså¯æ‰§è¡Œæ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¦‚å¯¼å…¥ã€å¯¼å‡ºã€å¤´æ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¼šæ£€æŸ¥ç—…æ¯’æ€»æ•°å¹¶æ‰¾åˆ°æ½œåœ¨çš„æ”»å‡»æŠ€æœ¯ã€‚

### Detect It Easy(DiE)

[**DiE**](https://github.com/horsicq/Detect-It-Easy/) æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ£€æµ‹æ–‡ä»¶æ˜¯å¦è¢«**åŠ å¯†**ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ‰¾åˆ°**æ‰“åŒ…å™¨**ã€‚

### NeoPI

[**NeoPI**](https://github.com/CiscoCXSecurity/NeoPI) æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œä½¿ç”¨å„ç§**ç»Ÿè®¡æ–¹æ³•**æ¥æ£€æµ‹æ–‡æœ¬/è„šæœ¬æ–‡ä»¶ä¸­çš„**æ··æ·†**å’Œ**åŠ å¯†**å†…å®¹ã€‚NeoPIçš„ç›®çš„æ˜¯å¸®åŠ©**æ£€æµ‹éšè—çš„web shellä»£ç **ã€‚

### **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder) å°½å…¶æ‰€èƒ½æ£€æµ‹**æ··æ·†**/**å¯ç–‘ä»£ç **ï¼Œä»¥åŠä½¿ç”¨**PHP**å‡½æ•°çš„æ–‡ä»¶ï¼Œè¿™äº›å‡½æ•°ç»å¸¸åœ¨**æ¶æ„è½¯ä»¶**/webshellsä¸­ä½¿ç”¨ã€‚

### Apple Binary Signatures

åœ¨æ£€æŸ¥æŸäº›**æ¶æ„è½¯ä»¶æ ·æœ¬**æ—¶ï¼Œä½ åº”è¯¥å§‹ç»ˆ**æ£€æŸ¥äºŒè¿›åˆ¶æ–‡ä»¶çš„ç­¾å**ï¼Œå› ä¸ºç­¾åå®ƒçš„**å¼€å‘è€…**å¯èƒ½å·²ç»ä¸**æ¶æ„è½¯ä»¶**æœ‰å…³ã€‚
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
## æ£€æµ‹æŠ€æœ¯

### æ–‡ä»¶å †å 

å¦‚æœæ‚¨çŸ¥é“æŸä¸ªåŒ…å«**æ–‡ä»¶**çš„æ–‡ä»¶å¤¹æ˜¯åœ¨**æŸä¸ªæ—¥æœŸ**ä¸Šæ¬¡æ›´æ–°çš„ã€‚**æ£€æŸ¥**è¯¥**æ—¥æœŸ**æ‰€æœ‰**æ–‡ä»¶**åœ¨**ç½‘é¡µæœåŠ¡å™¨ä¸Šåˆ›å»ºå’Œä¿®æ”¹çš„æ—¥æœŸ**ï¼Œå¦‚æœæœ‰ä»»ä½•æ—¥æœŸ**å¯ç–‘**ï¼Œæ£€æŸ¥è¯¥æ–‡ä»¶ã€‚

### åŸºçº¿

å¦‚æœæ–‡ä»¶å¤¹çš„æ–‡ä»¶**ä¸åº”è¯¥è¢«ä¿®æ”¹**ï¼Œæ‚¨å¯ä»¥è®¡ç®—æ–‡ä»¶å¤¹**åŸå§‹æ–‡ä»¶**çš„**å“ˆå¸Œå€¼**å¹¶å°†å®ƒä»¬ä¸**å½“å‰**æ–‡ä»¶è¿›è¡Œ**æ¯”è¾ƒ**ã€‚ä»»ä½•è¢«ä¿®æ”¹çš„éƒ½å°†æ˜¯**å¯ç–‘çš„**ã€‚

### ç»Ÿè®¡åˆ†æ

å½“ä¿¡æ¯è¢«ä¿å­˜åœ¨æ—¥å¿—ä¸­æ—¶ï¼Œæ‚¨å¯ä»¥**æ£€æŸ¥ç»Ÿè®¡æ•°æ®ï¼Œæ¯”å¦‚æ¯ä¸ªæ–‡ä»¶è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œå› ä¸ºç½‘é¡µå¤–å£³å¯èƒ½æ˜¯å…¶ä¸­ä¹‹ä¸€**ã€‚

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´åˆ°æˆä¸ºä¸“å®¶ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
