# KÃ¶tÃ¼ AmaÃ§lÄ± YazÄ±lÄ±m Analizi

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Adli BiliÅŸim Hile KaÄŸÄ±tlarÄ±

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/)

## Ã‡evrimiÃ§i Hizmetler

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)
* [Any.Run](https://any.run/)

## Ã‡evrimdÄ±ÅŸÄ± AntivirÃ¼s ve AlgÄ±lama AraÃ§larÄ±

### Yara

#### Kurulum
```bash
sudo apt-get install -y yara
```
#### KurallarÄ± hazÄ±rlayÄ±n

Bu betiÄŸi kullanarak github'dan tÃ¼m yara kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m kurallarÄ±nÄ± indirin ve birleÅŸtirin: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
_**rules**_ adlÄ± bir dizin oluÅŸturun ve betiÄŸi Ã§alÄ±ÅŸtÄ±rÄ±n. Bu, kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlar iÃ§in tÃ¼m yara kurallarÄ±nÄ± iÃ§eren _**malware\_rules.yar**_ adlÄ± bir dosya oluÅŸturacaktÄ±r.
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
#### Tarama
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
#### YaraGen: ZararlÄ± yazÄ±lÄ±m kontrolÃ¼ ve kurallar oluÅŸturma

[**YaraGen**](https://github.com/Neo23x0/yarGen) aracÄ±nÄ± kullanarak bir ikiliden yara kurallarÄ± oluÅŸturabilirsiniz. Bu eÄŸitimlere gÃ¶z atÄ±n: [**BÃ¶lÃ¼m 1**](https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/), [**BÃ¶lÃ¼m 2**](https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/), [**BÃ¶lÃ¼m 3**](https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
python3 yarGen.py --update
python3.exe yarGen.py --excludegood -m  ../../mals/
```
### ClamAV

#### Kurulum
```
sudo apt-get install -y clamav
```
#### Tarama
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
### [Capa](https://github.com/mandiant/capa)

**Capa**, yÃ¼rÃ¼tÃ¼lebilir dosyalardaki (PE, ELF, .NET) potansiyel olarak kÃ¶tÃ¼ niyetli **yetenekleri** tespit eder. Bu nedenle Att\&ck taktikleri gibi ÅŸeyleri veya ÅŸÃ¼pheli yetenekleri bulacaktÄ±r:

- OutputDebugString hatasÄ±nÄ± kontrol et
- bir hizmet olarak Ã§alÄ±ÅŸtÄ±r
- iÅŸlem oluÅŸtur

[**Github deposundan**](https://github.com/mandiant/capa) edinin.

### IOC'ler

IOC, Tehdit Belirleyici anlamÄ±na gelir. Bir IOC, bazÄ± potansiyel istenmeyen yazÄ±lÄ±mlarÄ± veya onaylanmÄ±ÅŸ **zararlÄ± yazÄ±lÄ±mlarÄ± tanÄ±mlayan koÅŸullar** kÃ¼mesidir. Mavi TakÄ±mlar, bu tÃ¼r kÃ¶tÃ¼ niyetli dosyalarÄ± **sistemlerinde** ve **aÄŸlarÄ±nda aramak** iÃ§in bu tÃ¼r tanÄ±mlamalarÄ± kullanÄ±r.\
Bu tanÄ±mlamalarÄ± paylaÅŸmak, bir bilgisayarda zararlÄ± yazÄ±lÄ±m tanÄ±mlandÄ±ÄŸÄ±nda ve o zararlÄ± yazÄ±lÄ±m iÃ§in bir IOC oluÅŸturulduÄŸunda, diÄŸer Mavi TakÄ±mlarÄ±n zararlÄ± yazÄ±lÄ±mÄ± daha hÄ±zlÄ± tanÄ±mlamasÄ±na yardÄ±mcÄ± olur.

IOC'ler oluÅŸturmak veya deÄŸiÅŸtirmek iÃ§in bir araÃ§ [**IOC Editor**](https://www.fireeye.com/services/freeware/ioc-editor.html)**'dÄ±r.**\
[**Redline**](https://www.fireeye.com/services/freeware/redline.html) gibi araÃ§larÄ± kullanarak bir cihazda tanÄ±mlanmÄ±ÅŸ IOC'leri **aramak** mÃ¼mkÃ¼ndÃ¼r.

### Loki

[**Loki**](https://github.com/Neo23x0/Loki), Basit Tehdit GÃ¶stergeleri iÃ§in bir tarayÄ±cÄ±dÄ±r.\
Tespit, dÃ¶rt tespit yÃ¶ntemine dayanmaktadÄ±r:
```
1. File Name IOC
Regex match on full file path/name

2. Yara Rule Check
Yara signature matches on file data and process memory

3. Hash Check
Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files

4. C2 Back Connect Check
Compares process connection endpoints with C2 IOCs (new since version v.10)
```
### Linux ZararlÄ± YazÄ±lÄ±m Tespiti

[**Linux ZararlÄ± YazÄ±lÄ±m Tespit (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/), GNU GPLv2 lisansÄ± altÄ±nda yayÄ±nlanan, paylaÅŸÄ±mlÄ± barÄ±ndÄ±rma ortamlarÄ±nda karÅŸÄ±laÅŸÄ±lan tehditlere odaklanan bir Linux zararlÄ± yazÄ±lÄ±m tarayÄ±cÄ±sÄ±dÄ±r. AÄŸ kenarÄ± sÄ±zma tespit sistemlerinden tehdit verileri kullanarak saldÄ±rÄ±larda aktif olarak kullanÄ±lan zararlÄ± yazÄ±lÄ±mlarÄ± Ã§Ä±kartÄ±r ve tespit iÃ§in imzalar oluÅŸturur. AyrÄ±ca, tehdit verileri, LMD Ã¶deme Ã¶zelliÄŸi ve zararlÄ± yazÄ±lÄ±m topluluk kaynaklarÄ± ile kullanÄ±cÄ± gÃ¶nderimlerinden de elde edilir.

### rkhunter

[**rkhunter**](http://rkhunter.sourceforge.net) gibi araÃ§lar, dosya sisteminde olasÄ± **rootkit** ve zararlÄ± yazÄ±lÄ±mlarÄ± kontrol etmek iÃ§in kullanÄ±labilir.
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
### FLOSS

[**FLOSS**](https://github.com/mandiant/flare-floss) farklÄ± teknikler kullanarak yÃ¼rÃ¼tÃ¼lebilir dosyalar iÃ§inde ÅŸifrelenmiÅŸ dizeleri bulmaya Ã§alÄ±ÅŸan bir araÃ§tÄ±r.

### PEpper

[PEpper ](https://github.com/Th3Hurrican3/PEpper) yÃ¼rÃ¼tÃ¼lebilir dosyanÄ±n iÃ§inde bazÄ± temel bilgileri kontrol eder (ikili veri, entropi, URL'ler ve IP'ler, bazÄ± yara kurallarÄ±).

### PEstudio

[PEstudio](https://www.winitor.com/download) Windows yÃ¼rÃ¼tÃ¼lebilir dosyalar hakkÄ±nda bilgi almayÄ± saÄŸlayan bir araÃ§tÄ±r; iÃ§eri aktarÄ±mlar, dÄ±ÅŸarÄ± aktarÄ±mlar, baÅŸlÄ±klar gibi, ayrÄ±ca virÃ¼s toplamÄ±nÄ± kontrol eder ve potansiyel Att\&ck tekniklerini bulur.

### Detect It Easy(DiE)

[**DiE**](https://github.com/horsicq/Detect-It-Easy/) bir dosyanÄ±n **ÅŸifreli** olup olmadÄ±ÄŸÄ±nÄ± tespit etmek ve **paketleyicileri** bulmak iÃ§in bir araÃ§tÄ±r.

### NeoPI

[**NeoPI** ](https://github.com/CiscoCXSecurity/NeoPI) metin/skript dosyalarÄ± iÃ§indeki **ÅŸifrelenmiÅŸ** ve **ÅŸifrelenmiÅŸ** iÃ§eriÄŸi tespit etmek iÃ§in Ã§eÅŸitli **istatistiksel yÃ¶ntemler** kullanan bir Python betiÄŸidir. NeoPI'nin amaÃ§lanan amacÄ±, **gizli web kabuk kodunun tespitine yardÄ±mcÄ± olmaktÄ±r**.

### **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder) **ÅŸifrelenmiÅŸ**/**ÅŸÃ¼pheli kodlarÄ±** ve genellikle **kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlarda**/web kabuklarÄ±nda kullanÄ±lan **PHP** iÅŸlevlerini iÃ§eren dosyalarÄ± tespit etmek iÃ§in elinden geleni yapar.

### Apple Binary Signatures

BazÄ± **kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m Ã¶rneÄŸini** kontrol ederken, binary'nin **imzasÄ±nÄ± kontrol etmek** her zaman Ã¶nemlidir Ã§Ã¼nkÃ¼ imzayÄ± atan **geliÅŸtirici** muhtemelen zaten **kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mla iliÅŸkilidir.**
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
## AlgÄ±lama Teknikleri

### Dosya YÄ±ÄŸma

EÄŸer bir web sunucusunun **dosyalarÄ±nÄ± iÃ§eren bir klasÃ¶rÃ¼n** en son ne zaman **gÃ¼ncellendiÄŸini** biliyorsanÄ±z, **web sunucusundaki tÃ¼m dosyalarÄ±n oluÅŸturulma ve deÄŸiÅŸtirilme tarihlerini kontrol edin** ve herhangi bir tarih **ÅŸÃ¼pheli** ise o dosyayÄ± kontrol edin.

### Temel Ã‡izgiler

Bir klasÃ¶rÃ¼n dosyalarÄ±nÄ±n **deÄŸiÅŸtirilmemesi gerektiÄŸini** biliyorsanÄ±z, klasÃ¶rÃ¼n **orijinal dosyalarÄ±nÄ±n** **hash'ini hesaplayabilir** ve **ÅŸu anki** dosyalarla **karÅŸÄ±laÅŸtÄ±rabilirsiniz**. DeÄŸiÅŸtirilen her ÅŸey **ÅŸÃ¼pheli** olacaktÄ±r.

### Ä°statistiksel Analiz

Bilgiler loglarda kaydedildiÄŸinde, bir web sunucusunun her dosyasÄ±nÄ±n kaÃ§ kez eriÅŸildiÄŸi gibi istatistikleri **kontrol edebilirsiniz**, Ã§Ã¼nkÃ¼ bir web kabuÄŸu en Ã§ok kullanÄ±lanlardan biri olabilir.
