# Windows Artifacts

## Windows Artifacts

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Generic Windows Artifacts

### Windows 10 Notifications

рдкрде `\Users\<username>\AppData\Local\Microsoft\Windows\Notifications` рдореЗрдВ рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ `appdb.dat` (Windows рдХреА рд╡рд░реНрд╖рдЧрд╛рдВрда рд╕реЗ рдкрд╣рд▓реЗ) рдпрд╛ `wpndatabase.db` (Windows рдХреА рд╡рд░реНрд╖рдЧрд╛рдВрда рдХреЗ рдмрд╛рдж) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░, рдЖрдк `Notification` рддрд╛рд▓рд┐рдХрд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рд╕реВрдЪрдирд╛рдПрдБ (XML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ) рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рдбреЗрдЯрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### Timeline

Timeline рдПрдХ Windows рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ **рдХрд╛рд▓рд╛рдиреБрдХреНрд░рдорд┐рдХ рдЗрддрд┐рд╣рд╛рд╕** рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреЗрдЦреА рдЧрдИ рд╡реЗрдм рдкреГрд╖реНрда, рд╕рдВрдкрд╛рджрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

рдбреЗрдЯрд╛рдмреЗрд╕ рдкрде `\Users\<username>\AppData\Local\ConnectedDevicesPlatform\<id>\ActivitiesCache.db` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ SQLite рдЯреВрд▓ рдпрд╛ [**WxTCmd**](https://github.com/EricZimmerman/WxTCmd) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдЬреЛ 2 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ** [**TimeLine Explorer**](https://ericzimmerman.github.io/#!index.md) **рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

### ADS (Alternate Data Streams)

рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ **ADS Zone.Identifier** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рдпрд╣ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐** рдЗрд╕реЗ **рдХреИрд╕реЗ** рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреИрд╕реЗ рдХрд┐ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ, рдЗрдВрдЯрд░рдиреЗрдЯ, рдЖрджрд┐ред рдХреБрдЫ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ (рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рдЖрдорддреМрд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **URL** рдЬреИрд╕реА **рдЕрдзрд┐рдХ** **рдЬрд╛рдирдХрд╛рд░реА** рднреА рдбрд╛рд▓рддреЗ рд╣реИрдВред

## **File Backups**

### Recycle Bin

Vista/Win7/Win8/Win10 рдореЗрдВ **Recycle Bin** рдбреНрд░рд╛рдЗрд╡ рдХреЗ рд░реВрдЯ рдореЗрдВ рдлрд╝реЛрд▓реНрдбрд░ **`$Recycle.bin`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЬрдм рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ, рддреЛ 2 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ:

* `$I{id}`: рдлрд╝рд╛рдЗрд▓ рдЬрд╛рдирдХрд╛рд░реА (рдЬрдм рдЗрд╕реЗ рд╣рдЯрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛)
* `$R{id}`: рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА

![](<../../../.gitbook/assets/image (1029).png>)

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде, рдЖрдк [**Rifiuti**](https://github.com/abelcheung/rifiuti2) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдореВрд▓ рдкрддрд╛ рдФрд░ рдЗрд╕реЗ рд╣рдЯрд╛рдП рдЬрд╛рдиреЗ рдХреА рддрд╛рд░реАрдЦ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (Vista тАУ Win10 рдХреЗ рд▓рд┐рдП `rifiuti-vista.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред
```
.\rifiuti-vista.exe C:\Users\student\Desktop\Recycle
```
![](<../../../.gitbook/assets/image (495) (1) (1) (1).png>)

### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкрд┐рдпрд╛рдБ

рд╢реИрдбреЛ рдХреЙрдкреА рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ Microsoft Windows рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рдХреА **рдмреИрдХрдЕрдк рдХреЙрдкрд┐рдпрд╛рдБ** рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рднрд▓реЗ рд╣реА рд╡реЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реЛрдВред

рдпреЗ рдмреИрдХрдЕрдк рдЖрдорддреМрд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрдбрд╝ рд╕реЗ `\System Volume Information` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдирд╛рдо **UIDs** рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рд╣реИрдВ:

![](<../../../.gitbook/assets/image (94).png>)

рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдЗрдореЗрдЬ рдХреЛ **ArsenalImageMounter** рдХреЗ рд╕рд╛рде рдорд╛рдЙрдВрдЯ рдХрд░рддреЗ рд╕рдордп, рдЯреВрд▓ [**ShadowCopyView**](https://www.nirsoft.net/utils/shadow\_copy\_view.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢реИрдбреЛ рдХреЙрдкреА рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (576).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BackupRestore` рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ **рдмреИрдХрдЕрдк рди рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ:

![](<../../../.gitbook/assets/image (254).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS` рдореЗрдВ `рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ` рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред

### рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдк рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрддреЗ рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `C:\Usuarios\\AppData\Roaming\Microsoft{Excel|Word|Powerpoint}\`

## рд╢реЗрд▓ рдЖрдЗрдЯрдо

рдПрдХ рд╢реЗрд▓ рдЖрдЗрдЯрдо рдПрдХ рдРрд╕рд╛ рдЖрдЗрдЯрдо рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

### рд╣рд╛рд▓ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (LNK)

Windows **рд╕реНрд╡рддрдГ** **рдЗрди рд╢реЙрд░реНрдЯрдХрдЯреНрд╕** рдХреЛ рддрдм **рдмрдирд╛рддрд╛ рд╣реИ** рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рддрд╛ рд╣реИ, рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдмрдирд╛рддрд╛ рд╣реИ**:

* Win7-Win10: `C:\Users\\AppData\Roaming\Microsoft\Windows\Recent\`
* рдСрдлрд┐рд╕: `C:\Users\\AppData\Roaming\Microsoft\Office\Recent\`

рдЬрдм рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдлрд╝реЛрд▓реНрдбрд░, рдкреИрд░реЗрдВрдЯ рдлрд╝реЛрд▓реНрдбрд░ рдФрд░ рдЧреНрд░реИрдВрдбрдкреИрд░реЗрдВрдЯ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рднреА рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓реЗрдВ **рдЙрджреНрдЧрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА** рд░рдЦрддреА рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ **рдлрд╝рд╛рдЗрд▓** **рдпрд╛** **рдлрд╝реЛрд▓реНрдбрд░** рд╣реИ, рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ **MAC** **рд╕рдордп**, рдлрд╝рд╛рдЗрд▓ рдХрд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдЙрд╕рдХрд╛ **рд╡реЙрд▓реНрдпреВрдо рдЬрд╛рдирдХрд╛рд░реА** рдФрд░ **рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдлрд╝реЛрд▓реНрдбрд░**ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рд╡реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реЛрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХреА **рддрд╛рд░реАрдЦ рдмрдирд╛рдИ рдЧрдИ** рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЗ **рдкрд╣рд▓реЗ** **рдЙрдкрдпреЛрдЧ** рдХрд╛ рдкрд╣рд▓рд╛ **рд╕рдордп** рд╣реИ рдФрд░ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХреА **рддрд╛рд░реАрдЦ рд╕рдВрд╢реЛрдзрд┐рдд** рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд╛ **рдЕрдВрддрд┐рдо** **рд╕рдордп** рд╣реИред

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**LinkParser**](http://4discovery.com/our-tools/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЯреВрд▓ рдореЗрдВ рдЖрдкрдХреЛ **2 рд╕реЗрдЯ** рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдорд┐рд▓реЗрдВрдЧреЗ:

* **рдкрд╣рд▓рд╛ рд╕реЗрдЯ:**
1. FileModifiedDate
2. FileAccessDate
3. FileCreationDate
* **рджреВрд╕рд░рд╛ рд╕реЗрдЯ:**
1. LinkModifiedDate
2. LinkAccessDate
3. LinkCreationDate.

рдкрд╣рд▓реЗ рд╕реЗрдЯ рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк **рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рд╕реЗрдЯ **рд▓рд┐рдВрдХ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЖрдк Windows CLI рдЯреВрд▓: [**LECmd.exe**](https://github.com/EricZimmerman/LECmd) рдЪрд▓рд╛рдХрд░ рд╡рд╣реА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
LECmd.exe -d C:\Users\student\Desktop\LNKs --csv C:\Users\student\Desktop\LNKs
```
In this case, the information is going to be saved inside a CSV file.

### Jumplists

рдпреЗ рд╣рд╛рд▓ рдХреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрддрд┐рдд рд╣реЛрддреА рд╣реИрдВред рдпрд╣ **рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рд╣рд╛рд▓ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА** рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдпрд╛ рдХрд╕реНрдЯрдо** рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП **jumplists** `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред jumplists рдХрд╛ рдирд╛рдо `{id}.autmaticDestinations-ms` рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдБ рдкреНрд░рд╛рд░рдВрднрд┐рдХ ID рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА ID рд╣реЛрддреА рд╣реИред

рдХрд╕реНрдЯрдо jumplists `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\CustomDestination\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХреБрдЫ **рдорд╣рддреНрд╡рдкреВрд░реНрдг** рд╣реБрдЖ рд╣реИ (рд╢рд╛рдпрдж рдкрд╕рдВрджреАрджрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ)

рдХрд┐рд╕реА рднреА jumplist рдХрд╛ **рдирд┐рд░реНрдорд╛рдг рд╕рдордп** **рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╣рд▓реА рдмрд╛рд░ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рдХрд╛ рд╕рдордп** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп рдЕрдВрддрд┐рдо рдмрд╛рд░** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЖрдк [**JumplistExplorer**](https://ericzimmerman.github.io/#!index.md) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ jumplists рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (168).png>)

(_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ JumplistExplorer рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк jumplist рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ_)

### Shellbags

[**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ shellbags рдХреНрдпрд╛ рд╣реИрдВред**](interesting-windows-registry-keys.md#shellbags)

## Windows USBs рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрд╣ рдкрд╣рдЪрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ USB рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдзрдиреНрдпрд╡рд╛рдж рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП:

* Windows Recent Folder
* Microsoft Office Recent Folder
* Jumplists

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ LNK рдлрд╝рд╛рдЗрд▓ рдореВрд▓ рдкрде рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп WPDNSE рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреА рд╣реИ:

![](<../../../.gitbook/assets/image (218).png>)

WPDNSE рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдореВрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдПрдХ рдкреНрд░рддрд┐ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпреЗ PC рдХреЗ рдкреБрдирд░рд╛рд░рдВрдн рд╣реЛрдиреЗ рдкрд░ рдЬреАрд╡рд┐рдд рдирд╣реАрдВ рд░рд╣реЗрдВрдЧреА рдФрд░ GUID рдПрдХ shellbag рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

### Registry Information

[рдпрд╣ рдкреГрд╖реНрда рджреЗрдЦреЗрдВ](interesting-windows-registry-keys.md#usb-information) рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА USB рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВред

### setupapi

USB рдХрдиреЗрдХреНрд╢рди рдХрдм рдЙрддреНрдкрдиреНрди рд╣реБрдЖ, рдЗрд╕рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ `C:\Windows\inf\setupapi.dev.log` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ ( `Section start` рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ)ред

![](<../../../.gitbook/assets/image (477) (2) (2) (2) (2) (2) (2) (2) (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (14) (2).png>)

### USB Detective

[**USBDetective**](https://usbdetective.com) рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрди USB рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЫрд╡рд┐ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВред

![](<../../../.gitbook/assets/image (452).png>)

### Plug and Play Cleanup

'Plug and Play Cleanup' рдХреЗ рд░реВрдк рдореЗрдВ рдЬреНрдЮрд╛рдд рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдкреБрд░рд╛рдиреЗ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд╡рд┐рдкрд░реАрдд рдирд╡реАрдирддрдо рдбреНрд░рд╛рдЗрд╡рд░ рдкреИрдХреЗрдЬ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдСрдирд▓рд╛рдЗрди рд╕реНрд░реЛрддреЛрдВ рдХрд╛ рд╕реБрдЭрд╛рд╡ рд╣реИ рдХрд┐ рдпрд╣ 30 рджрд┐рдиреЛрдВ рд╕реЗ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рднреА рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдкрд┐рдЫрд▓реЗ 30 рджрд┐рдиреЛрдВ рдореЗрдВ рдЬреБрдбрд╝реЗ рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╣рдЯрд╛рдиреЗ рдпреЛрдЧреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдЕрдзреАрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдХрд╛рд░реНрдп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдкрд░ рд╕реНрдерд┐рдд рд╣реИ: `C:\Windows\System32\Tasks\Microsoft\Windows\Plug and Play\Plug and Play Cleanup`.

рдХрд╛рд░реНрдп рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓реА рдПрдХ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╣реИ: ![](https://2.bp.blogspot.com/-wqYubtuR\_W8/W19bV5S9XyI/AAAAAAAANhU/OHsBDEvjqmg9ayzdNwJ4y2DKZnhCdwSMgCLcBGAs/s1600/xml.png)

**рдХрд╛рд░реНрдп рдХреЗ рдкреНрд░рдореБрдЦ рдШрдЯрдХ рдФрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕:**

* **pnpclean.dll**: рдпрд╣ DLL рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдлрд╛рдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред
* **UseUnifiedSchedulingEngine**: `TRUE` рдкрд░ рд╕реЗрдЯ, рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ рдЗрдВрдЬрди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред
* **MaintenanceSettings**:
* **Period ('P1M')**: рдХрд╛рд░реНрдп рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рдирд┐рдпрдорд┐рдд рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдХреЗ рджреМрд░рд╛рди рдорд╛рд╕рд┐рдХ рд╕рдлрд╛рдИ рдХрд╛рд░реНрдп рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **Deadline ('P2M')**: рдХрд╛рд░реНрдп рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдХрд╛рд░реНрдп рджреЛ рд▓рдЧрд╛рддрд╛рд░ рдорд╣реАрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдлрд▓ рд░рд╣рддрд╛ рд╣реИ, рддреЛ рдЖрдкрд╛рддрдХрд╛рд▓реАрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдХреЗ рджреМрд░рд╛рди рдХрд╛рд░реНрдп рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред

рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдирд┐рдпрдорд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдФрд░ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреА рд╕рдлрд╛рдИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд▓рдЧрд╛рддрд╛рд░ рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд╛рд░реНрдп рдХреЛ рдлрд┐рд░ рд╕реЗ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд╡рдзрд╛рди рдХреЗ рд╕рд╛рдеред

**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:** [**https://blog.1234n6.com/2018/07/windows-plug-and-play-cleanup.html**](https://blog.1234n6.com/2018/07/windows-plug-and-play-cleanup.html)

## Emails

рдИрдореЗрд▓ рдореЗрдВ **2 рджрд┐рд▓рдЪрд╕реНрдк рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: рдИрдореЗрд▓ рдХреЗ рд╣реЗрдбрд░ рдФрд░ рд╕рд╛рдордЧреНрд░реА**ред **рд╣реЗрдбрд░** рдореЗрдВ рдЖрдк рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:

* **рдХрд┐рд╕рдиреЗ** рдИрдореЗрд▓ рднреЗрдЬреЗ (рдИрдореЗрд▓ рдкрддрд╛, IP, рдореЗрд▓ рд╕рд░реНрд╡рд░ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдИрдореЗрд▓ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛)
* **рдХрдм** рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, `References` рдФрд░ `In-Reply-To` рд╣реЗрдбрд░ рдХреЗ рдЕрдВрджрд░ рдЖрдк рд╕рдВрджреЗрд╢реЛрдВ рдХреА ID рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../../.gitbook/assets/image (593).png>)

### Windows Mail App

рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдИрдореЗрд▓ рдХреЛ HTML рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред рдЖрдк рдИрдореЗрд▓ рдХреЛ `\Users\<username>\AppData\Local\Comms\Unistore\data\3\` рдХреЗ рдЕрдВрджрд░ рдЙрдкрдлреЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдИрдореЗрд▓ рдХреЛ `.dat` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдИрдореЗрд▓ рдХрд╛ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдФрд░ **рд╕рдВрдкрд░реНрдХ** **EDB рдбреЗрдЯрд╛рдмреЗрд╕** рдХреЗ рдЕрдВрджрд░ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `\Users\<username>\AppData\Local\Comms\UnistoreDB\store.vol`

**рдлрд╛рдЗрд▓ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** `.vol` рд╕реЗ `.edb` рдореЗрдВ рдмрджрд▓реЗрдВ рдФрд░ рдЖрдк рдЗрд╕реЗ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред `Message` рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдИрдореЗрд▓ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### Microsoft Outlook

рдЬрдм рдПрдХреНрд╕рдЪреЗрдВрдЬ рд╕рд░реНрд╡рд░ рдпрд╛ рдЖрдЙрдЯрд▓реБрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреБрдЫ MAPI рд╣реЗрдбрд░ рд╣реЛрдВрдЧреЗ:

* `Mapi-Client-Submit-Time`: рд╕рдордп рдЬрдм рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛
* `Mapi-Conversation-Index`: рдереНрд░реЗрдб рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдереНрд░реЗрдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк
* `Mapi-Entry-ID`: рд╕рдВрджреЗрд╢ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* `Mappi-Message-Flags` рдФрд░ `Pr_last_Verb-Executed`: MAPI рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА (рд╕рдВрджреЗрд╢ рдкрдврд╝рд╛? рдирд╣реАрдВ рдкрдврд╝рд╛? рдЙрддреНрддрд░ рджрд┐рдпрд╛? рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд? рдХрд╛рд░реНрдпрд╛рд▓рдп рд╕реЗ рдмрд╛рд╣рд░?)

Microsoft Outlook рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ, рд╕рднреА рднреЗрдЬреЗ рдЧрдП/рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢, рд╕рдВрдкрд░реНрдХ рдбреЗрдЯрд╛, рдФрд░ рдХреИрд▓реЗрдВрдбрд░ рдбреЗрдЯрд╛ PST рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ:

* `%USERPROFILE%\Local Settings\Application Data\Microsoft\Outlook` (WinXP)
* `%USERPROFILE%\AppData\Local\Microsoft\Outlook`

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде `HKEY_CURRENT_USER\Software\Microsoft\WindowsNT\CurrentVersion\Windows Messaging Subsystem\Profiles\Outlook` рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред

рдЖрдк [**Kernel PST Viewer**](https://www.nucleustechnologies.com/es/visor-de-pst.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PST рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (498).png>)

### Microsoft Outlook OST Files

рдПрдХ **OST рдлрд╝рд╛рдЗрд▓** Microsoft Outlook рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдЗрд╕реЗ **IMAP** рдпрд╛ **Exchange** рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ PST рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИред рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдордиреНрд╡рдпрд┐рдд рд╣реЛрддреА рд╣реИ, **рдЕрдВрддрд┐рдо 12 рдорд╣реАрдиреЛрдВ** рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдмрдирд╛рдП рд░рдЦрддреА рд╣реИ рдФрд░ **50GB** рдХреЗ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдореЗрдВ рд╣реЛрддреА рд╣реИ, рдФрд░ PST рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИред OST рдлрд╝рд╛рдЗрд▓ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, [**Kernel OST viewer**](https://www.nucleustechnologies.com/ost-viewer.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Retrieving Attachments

рдЦреЛрдИ рд╣реБрдИ рдЕрдЯреИрдЪрдореЗрдВрдЯреНрд╕ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* **IE10** рдХреЗ рд▓рд┐рдП: `%APPDATA%\Local\Microsoft\Windows\Temporary Internet Files\Content.Outlook`
* **IE11 рдФрд░ рдКрдкрд░** рдХреЗ рд▓рд┐рдП: `%APPDATA%\Local\Microsoft\InetCache\Content.Outlook`

### Thunderbird MBOX Files

**Thunderbird** **MBOX рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ, рдЬреЛ `\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИрдВред

### Image Thumbnails

* **Windows XP рдФрд░ 8-8.1**: рдердВрдмрдиреЗрд▓ рдХреЗ рд╕рд╛рде рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рдПрдХ `thumbs.db` рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬреЛ рдЫрд╡рд┐ рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж рднреАред
* **Windows 7/10**: `thumbs.db` рддрдм рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ рдЬрдм UNC рдкрде рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкрд╣реБрдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИред
* **Windows Vista рдФрд░ рдирдП**: рдердВрдмрдиреЗрд▓ рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди `%userprofile%\AppData\Local\Microsoft\Windows\Explorer` рдореЗрдВ рдХреЗрдВрджреНрд░реАрдХреГрдд рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ **thumbcache\_xxx.db** рдирд╛рдо рдХреА рд╣реЛрддреА рд╣реИрдВред рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП [**Thumbsviewer**](https://thumbsviewer.github.io) рдФрд░ [**ThumbCache Viewer**](https://thumbcacheviewer.github.io) рдЯреВрд▓ рд╣реИрдВред

### Windows Registry Information

Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА, рдЬреЛ рд╡реНрдпрд╛рдкрдХ рдкреНрд░рдгрд╛рд▓реА рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрддрд┐рд╡рд┐рдзрд┐ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реЛрддреА рд╣реИ:

* рд╡рд┐рднрд┐рдиреНрди `HKEY_LOCAL_MACHINE` рдЙрдкрдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП `%windir%\System32\Config`ред
* `HKEY_CURRENT_USER` рдХреЗ рд▓рд┐рдП `%UserProfile%{User}\NTUSER.DAT`ред
* Windows Vista рдФрд░ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг `HKEY_LOCAL_MACHINE` рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдмреИрдХрдЕрдк `%Windir%\System32\Config\RegBack\` рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВред
* рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЬрд╛рдирдХрд╛рд░реА Windows Vista рдФрд░ Windows 2008 Server рд╕реЗ рдЖрдЧреЗ `%UserProfile%\{User}\AppData\Local\Microsoft\Windows\USERCLASS.DAT` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИред

### Tools

рдХреБрдЫ рдЯреВрд▓ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИрдВ:

* **Registry Editor**: рдпрд╣ Windows рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рд╣реИред рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕рддреНрд░ рдХреА Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ GUI рд╣реИред
* [**Registry Explorer**](https://ericzimmerman.github.io/#!index.md): рдпрд╣ рдЖрдкрдХреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ GUI рдХреЗ рд╕рд╛рде рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╡рд╛рд▓реЗ рдХреБрдВрдЬреА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдмреБрдХрдорд╛рд░реНрдХ рднреА рд╣реЛрддреЗ рд╣реИрдВред
* [**RegRipper**](https://github.com/keydet89/RegRipper3.0): рдлрд┐рд░ рд╕реЗ, рдЗрд╕рдореЗрдВ рдПрдХ GUI рд╣реИ рдЬреЛ рд▓реЛрдб рдХреА рдЧрдИ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЛрдб рдХреА рдЧрдИ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдЕрдВрджрд░ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред
* [**Windows Registry Recovery**](https://www.mitec.cz/wrr.html): рдПрдХ рдФрд░ GUI рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛ рд▓реЛрдб рдХреА рдЧрдИ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред

### Recovering Deleted Element

рдЬрдм рдПрдХ рдХреБрдВрдЬреА рдХреЛ рд╣рдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрдм рддрдХ рдпрд╣ рд╕реНрдерд╛рди рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реЛрддрд╛, рддрдм рддрдХ рдЗрд╕реЗ рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, **Registry Explorer** рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрди рд╣рдЯрд╛рдИ рдЧрдИ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

### Last Write Time

рдкреНрд░рддреНрдпреЗрдХ Key-Value рдореЗрдВ рдПрдХ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЕрдВрддрд┐рдо рдмрд╛рд░ рд╕рдВрд╢реЛрдзрд┐рдд рд╣реЛрдиреЗ рдХрд╛ рд╕рдордп рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред

### SAM

рдлрд╝рд╛рдЗрд▓/рд╣рд╛рдЗрд╡ **SAM** рдореЗрдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ, рд╕рдореВрд╣реЛрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб** рд╣реИрд╢ рд╣реЛрддреЗ рд╣реИрдВред

`SAM\Domains\Account\Users` рдореЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, RID, рдЕрдВрддрд┐рдо рд▓реЙрдЧрд┐рди, рдЕрдВрддрд┐рдо рд╡рд┐рдлрд▓ рд▓реЙрдЧрд┐рди, рд▓реЙрдЧрд┐рди рдХрд╛рдЙрдВрдЯрд░, рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдФрд░ рдЬрдм рдЦрд╛рддрд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред **рд╣реИрд╢** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓/рд╣рд╛рдЗрд╡ **SYSTEM** рдХреА рднреА **рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реИред

### Interesting entries in the Windows Registry

{% content-ref url="interesting-windows-registry-keys.md" %}
[interesting-windows-registry-keys.md](interesting-windows-registry-keys.md)
{% endcontent-ref %}

## Programs Executed

### Basic Windows Processes

[рдЗрд╕ рдкреЛрд╕реНрдЯ](https://jonahacks.medium.com/investigating-common-windows-processes-18dee5f97c1d) рдореЗрдВ рдЖрдк рд╕рдВрджрд┐рдЧреНрдз рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп Windows рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред

### Windows Recent APPs

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `NTUSER.DAT` рдХреЗ рдЕрдВрджрд░ рдкрде `Software\Microsoft\Current Version\Search\RecentApps` рдореЗрдВ рдЖрдк рдЙрдкрдХреБрдВрдЬреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди**, **рдЕрдВрддрд┐рдо рдмрд╛рд░** рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ **рдХрд┐рддрдиреА рдмрд╛рд░** рдЗрд╕реЗ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### BAM (Background Activity Moderator)

рдЖрдк рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрдкрд╛рджрдХ рдХреЗ рд╕рд╛рде `SYSTEM` рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрде `SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}` рдХреЗ рдЕрдВрджрд░ рдЖрдк **рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдкрде рдореЗрдВ `{SID}` рдиреЛрдЯ рдХрд░реЗрдВ) рдФрд░ **рдХрдм** рдЙрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рд╕рдордп рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдбреЗрдЯрд╛ рдорд╛рди рдХреЗ рдЕрдВрджрд░ рд╣реИ)ред

### Windows Prefetch

Prefetching рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдПрдХ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪреБрдкрдЪрд╛рдк **рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓рд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдирд┐рдХрдЯ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рддреЗрдЬреА рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

Windows prefetch рдореЗрдВ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдХреИрд╢ рдмрдирд╛рдиреЗ** рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпреЗ рдХреИрд╢ `.pf` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдореЗрдВ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ: `C:\Windows\Prefetch`ред XP/VISTA/WIN7 рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реАрдорд╛ 128 рд╣реИ рдФрд░ Win8/Win10 рдореЗрдВ 1024 рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВред

рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо `{program_name}-{hash}.pf` рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд╣реИрд╢ рдкрде рдФрд░ рдирд┐рд╖реНрдкрд╛рджрдиреАрдп рдХреЗ рддрд░реНрдХреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред W10 рдореЗрдВ рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛрддреА рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреА рдХреЗрд╡рд▓ рдЙрдкрд╕реНрдерд┐рддрд┐ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИ рдХрд┐ **рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**ред

рдлрд╝рд╛рдЗрд▓ `C:\Windows\Prefetch\Layout.ini` рдореЗрдВ **рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЗ рдирд╛рдо рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░реАрдлреЗрдЪ рдХрд┐рдП рдЧрдП рд╣реИрдВ**ред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдирд┐рд╖реНрдкрд╛рджрди рдХреА рд╕рдВрдЦреНрдпрд╛**, **рдирд┐рд╖реНрдкрд╛рджрди рдХреА рддрд┐рдерд┐рдпрд╛рдБ** рдФрд░ **рдлрд╝рд╛рдЗрд▓реЗрдВ** **рдЦреБрд▓реА** рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдХрд╛рд░реНрдпрдХреНрд░рдо рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реА рдЧрдИ рд╣реИрдВред

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЯреВрд▓ [**PEcmd.exe**](https://github.com/EricZimmerman/PECmd) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
.\PECmd.exe -d C:\Users\student\Desktop\Prefetch --html "C:\Users\student\Desktop\out_folder"
```
![](<../../../.gitbook/assets/image (315).png>)

### Superprefetch

**Superprefetch** рдХрд╛ рд▓рдХреНрд╖реНрдп **prefetch** рдХреЗ рд╕рдорд╛рди рд╣реИ, **рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдирд╛** рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдХрд░ рдХрд┐ рдЕрдЧрд▓рд╛ рдХреНрдпрд╛ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ prefetch рд╕реЗрд╡рд╛ рдХрд╛ рд╕реНрдерд╛рди рдирд╣реАрдВ рд▓реЗрддрд╛ред\
рдпрд╣ рд╕реЗрд╡рд╛ `C:\Windows\Prefetch\Ag*.db` рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧреАред

рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдк **рдХрд╛рд░реНрдпрдХреНрд░рдо** рдХрд╛ **рдирд╛рдо**, **рдХрд╛рд░реНрдпрд╡рд╛рд╣реА** рдХреА **рд╕рдВрдЦреНрдпрд╛**, **рдЦреБрд▓реЗ** **рдлрд╝рд╛рдЗрд▓реЗрдВ**, **рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛** **рд╡реЙрд▓реНрдпреВрдо**, **рдкреВрд░реНрдг** **рдкрде**, **рд╕рдордп рд╕реАрдорд╛** рдФрд░ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ [**CrowdResponse**](https://www.crowdstrike.com/resources/community-tools/crowdresponse/) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### SRUM

**System Resource Usage Monitor** (SRUM) **рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рджреНрд╡рд╛рд░рд╛ **рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП** **рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреА **рдирд┐рдЧрд░рд╛рдиреА** рдХрд░рддрд╛ рд╣реИред рдпрд╣ W8 рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реБрдЖ рдФрд░ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ `C:\Windows\System32\sru\SRUDB.dat` рдореЗрдВ ESE рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* AppID рдФрд░ рдкрде
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕рдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛
* рднреЗрдЬреЗ рдЧрдП рдмрд╛рдЗрдЯреНрд╕
* рдкреНрд░рд╛рдкреНрдд рдмрд╛рдЗрдЯреНрд╕
* рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕
* рдХрдиреЗрдХреНрд╢рди рдЕрд╡рдзрд┐
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрд╡рдзрд┐

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рд░ 60 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИред

рдЖрдк рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**srum\_dump**](https://github.com/MarkBaggett/srum-dump) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
.\srum_dump.exe -i C:\Users\student\Desktop\SRUDB.dat -t SRUM_TEMPLATE.xlsx -o C:\Users\student\Desktop\srum
```
### AppCompatCache (ShimCache)

The **AppCompatCache**, рдЬрд┐рд╕реЗ **ShimCache** рдХреЗ рдирд╛рдо рд╕реЗ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, **Microsoft** рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд **Application Compatibility Database** рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдВрдЧрддрддрд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рд╕рд┐рд╕реНрдЯрдо рдШрдЯрдХ рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкреВрд░рд╛ рдкрде
* рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░
* **$Standard\_Information** (SI) рдХреЗ рддрд╣рдд рдЕрдВрддрд┐рдо рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп
* ShimCache рдХрд╛ рдЕрдВрддрд┐рдо рдЕрдкрдбреЗрдЯ рд╕рдордп
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдзреНрд╡рдЬ

рдЗрд╕ рддрд░рд╣ рдХрд╛ рдбреЗрдЯрд╛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* XP рдХреЗ рд▓рд┐рдП, рдбреЗрдЯрд╛ `SYSTEM\CurrentControlSet\Control\SessionManager\Appcompatibility\AppcompatCache` рдХреЗ рддрд╣рдд рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ 96 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред
* рд╕рд░реНрд╡рд░ 2003 рдХреЗ рд▓рд┐рдП, рд╕рд╛рде рд╣реА Windows рдХреЗ рд╕рдВрд╕реНрдХрд░рдг 2008, 2012, 2016, 7, 8, рдФрд░ 10 рдХреЗ рд▓рд┐рдП, рд╕рдВрдЧреНрд░рд╣рдг рдкрде `SYSTEM\CurrentControlSet\Control\SessionManager\AppcompatCache\AppCompatCache` рд╣реИ, рдЬреЛ рдХреНрд░рдорд╢рдГ 512 рдФрд░ 1024 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рддрд╛ рд╣реИред

рд╕рдВрдЧреНрд░рд╣реАрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**AppCompatCacheParser** рдЯреВрд▓](https://github.com/EricZimmerman/AppCompatCacheParser) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред

![](<../../../.gitbook/assets/image (75).png>)

### Amcache

**Amcache.hve** рдлрд╝рд╛рдЗрд▓ рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣рд╛рдЗрд╡ рд╣реИ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд▓реЙрдЧ рдХрд░рддреА рд╣реИред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ `C:\Windows\AppCompat\Programas\Amcache.hve` рдкрд░ рдкрд╛рдИ рдЬрд╛рддреА рд╣реИред

рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдкрде рдФрд░ рдЙрдирдХреЗ SHA1 рд╣реИрд╢ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдореВрд▓реНрдп рд╣реИред

**Amcache.hve** рд╕реЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**AmcacheParser**](https://github.com/EricZimmerman/AmcacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб **Amcache.hve** рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ CSV рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП AmcacheParser рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:
```bash
AmcacheParser.exe -f C:\Users\genericUser\Desktop\Amcache.hve --csv C:\Users\genericUser\Desktop\outputFolder
```
Among the generated CSV files, the `Amcache_Unassociated file entries` is particularly noteworthy due to the rich information it provides about unassociated file entries.

The most interesting CVS file generated is the `Amcache_Unassociated file entries`.

### RecentFileCache

рдпрд╣ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдХреЗрд╡рд▓ W7 рдореЗрдВ `C:\Windows\AppCompat\Programs\RecentFileCache.bcf` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрд╛рдЗрдирд░реА рдХреЗ рд╣рд╛рд▓рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

рдЖрдк рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**RecentFileCacheParse**](https://github.com/EricZimmerman/RecentFileCacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Scheduled tasks

рдЖрдк рдЗрдиреНрд╣реЗрдВ `C:\Windows\Tasks` рдпрд╛ `C:\Windows\System32\Tasks` рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ XML рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

### Services

рдЖрдк рдЗрдиреНрд╣реЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ `SYSTEM\ControlSet001\Services` рдХреЗ рддрд╣рдд рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рдФрд░ рдХрдмред

### **Windows Store**

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди `\ProgramData\Microsoft\Windows\AppRepository\` рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ **`StateRepository-Machine.srd`** рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ **рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЗ рд╕рд╛рде рдПрдХ **рд▓реЙрдЧ** рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░, "Application ID", "PackageNumber", рдФрд░ "Display Name" рдЬреИрд╕реЗ рдХреЙрд▓рдо рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рдХреЙрд▓рдо рдкреНрд░реА-рдЗрдВрд╕реНрдЯреЙрд▓ рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдереЗ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ IDs рдЕрдиреБрдХреНрд░рдорд┐рдХ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред

рдЖрдк рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде рдореЗрдВ рднреА **рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\`\
рдФрд░ **рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deleted\`

## Windows Events

Windows рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЗ рдЕрдВрджрд░ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ рд╡рд╣ рд╣реИ:

* рдХреНрдпрд╛ рд╣реБрдЖ
* рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк (UTC + 0)
* рд╢рд╛рдорд┐рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рд╢рд╛рдорд┐рд▓ рд╣реЛрд╕реНрдЯ (hostname, IP)
* рдПрдХреНрд╕реЗрд╕ рдХрд┐рдП рдЧрдП рдПрд╕реЗрдЯреНрд╕ (рдлрд╛рдЗрд▓реЗрдВ, рдлрд╝реЛрд▓реНрдбрд░, рдкреНрд░рд┐рдВрдЯрд░, рд╕реЗрд╡рд╛рдПрдБ)

рд▓реЙрдЧ `C:\Windows\System32\config` рдореЗрдВ Windows Vista рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ `C:\Windows\System32\winevt\Logs` рдореЗрдВ Windows Vista рдХреЗ рдмрд╛рдж рд╕реНрдерд┐рдд рд╣реИрдВред Windows Vista рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдереЗ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж, рд╡реЗ **XML рдкреНрд░рд╛рд░реВрдк** рдореЗрдВ рд╣реИрдВ рдФрд░ **.evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕реНрдерд╛рди SYSTEM рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ **`HKLM\SYSTEM\CurrentControlSet\services\EventLog\{Application|System|Security}`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрдиреНрд╣реЗрдВ Windows рдЗрд╡реЗрдВрдЯ рд╡реНрдпреВрдЕрд░ (**`eventvwr.msc`**) рд╕реЗ рдпрд╛ рдЕрдиреНрдп рдЯреВрд▓ рдЬреИрд╕реЗ [**Event Log Explorer**](https://eventlogxp.com) **рдпрд╛** [**Evtx Explorer/EvtxECmd**](https://ericzimmerman.github.io/#!index.md)** рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

## Understanding Windows Security Event Logging

рдПрдХреНрд╕реЗрд╕ рдЗрд╡реЗрдВрдЯреНрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рджрд░реНрдЬ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ `C:\Windows\System32\winevt\Security.evtx` рдкрд░ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рдпреЛрдЬреНрдп рд╣реИ, рдФрд░ рдЬрдм рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рдкрд╣реБрдБрдЪ рдЬрд╛рддреА рд╣реИ, рддреЛ рдкреБрд░рд╛рдиреЗ рдЗрд╡реЗрдВрдЯреНрд╕ рдУрд╡рд░рд░рд╛рдЗрдЯ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рджрд░реНрдЬ рдЗрд╡реЗрдВрдЯреНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдФрд░ рд▓реЙрдЧрдСрдл, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдПрдБ, рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди, рд╕рд╛рде рд╣реА рдлрд╝рд╛рдЗрд▓, рдлрд╝реЛрд▓реНрдбрд░, рдФрд░ рд╕рд╛рдЭрд╛ рдПрд╕реЗрдЯреНрд╕ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИред

### Key Event IDs for User Authentication:

* **EventID 4624**: рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реБрдЖред
* **EventID 4625**: рдкреНрд░рдорд╛рдгрди рд╡рд┐рдлрд▓рддрд╛ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред
* **EventIDs 4634/4647**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрдСрдл рдЗрд╡реЗрдВрдЯреНрд╕ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ рд╣реИрдВред
* **EventID 4672**: рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред

#### Sub-types within EventID 4634/4647:

* **Interactive (2)**: рдкреНрд░рддреНрдпрдХреНрд╖ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рдиред
* **Network (3)**: рд╕рд╛рдЭрд╛ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рддрдХ рдкрд╣реБрдБрдЪред
* **Batch (4)**: рдмреИрдЪ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрдиред
* **Service (5)**: рд╕реЗрд╡рд╛ рд▓реЙрдиреНрдЪред
* **Proxy (6)**: рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рдорд╛рдгрдиред
* **Unlock (7)**: рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рд╕реНрдХреНрд░реАрди рдЕрдирд▓реЙрдХред
* **Network Cleartext (8)**: рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди, рдЕрдХреНрд╕рд░ IIS рд╕реЗред
* **New Credentials (9)**: рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧред
* **Remote Interactive (10)**: рд░рд┐рдореЛрдЯ рдбреЗрд╕реНрдХрдЯреЙрдк рдпрд╛ рдЯрд░реНрдорд┐рдирд▓ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд▓реЙрдЧрд┐рдиред
* **Cache Interactive (11)**: рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рд╕рдВрдкрд░реНрдХ рдХреЗ рдмрд┐рдирд╛ рдХреИрд╢ рдХрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рдиред
* **Cache Remote Interactive (12)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рд░рд┐рдореЛрдЯ рд▓реЙрдЧрд┐рдиред
* **Cached Unlock (13)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдирд▓реЙрдХ рдХрд░рдирд╛ред

#### Status and Sub Status Codes for EventID 4625:

* **0xC0000064**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ - рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо enumeration рд╣рдорд▓реЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддрд╛ рд╣реИред
* **0xC000006A**: рд╕рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд▓реЗрдХрд┐рди рдЧрд▓рдд рдкрд╛рд╕рд╡рд░реНрдб - рд╕рдВрднрд╛рд╡рд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрдорд╛рди рдпрд╛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкреНрд░рдпрд╛рд╕ред
* **0xC0000234**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рд▓реЙрдХ рдЖрдЙрдЯ - рдХрдИ рд╡рд┐рдлрд▓ рд▓реЙрдЧрд┐рди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЗ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **0xC0000072**: рдЦрд╛рддрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп - рдирд┐рд╖реНрдХреНрд░рд┐рдп рдЦрд╛рддреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рдЕрдирдзрд┐рдХреГрдд рдкреНрд░рдпрд╛рд╕ред
* **0xC000006F**: рдЕрдиреБрдорддрд┐ рд╕рдордп рдХреЗ рдмрд╛рд╣рд░ рд▓реЙрдЧрд┐рди - рд╕реЗрдЯ рд▓реЙрдЧрд┐рди рдШрдВрдЯреЛрдВ рдХреЗ рдмрд╛рд╣рд░ рдкрд╣реБрдБрдЪ рдХреЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХрд╛ рд╕рдВрдХреЗрдд, рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдБрдЪ рдХрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдВрдХреЗрддред
* **0xC0000070**: рдХрд╛рд░реНрдпрд╕реНрдерд▓ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди - рдЕрдирдзрд┐рдХреГрдд рд╕реНрдерд╛рди рд╕реЗ рд▓реЙрдЧрд┐рди рдХрд╛ рдкреНрд░рдпрд╛рд╕ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* **0xC0000193**: рдЦрд╛рддрд╛ рд╕рдорд╛рдкреНрддрд┐ - рд╕рдорд╛рдкреНрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рд╕рд╛рде рдкрд╣реБрдБрдЪ рдХреЗ рдкреНрд░рдпрд╛рд╕ред
* **0xC0000071**: рд╕рдорд╛рдкреНрдд рдкрд╛рд╕рд╡рд░реНрдб - рдкреБрд░рд╛рдиреА рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕ред
* **0xC0000133**: рд╕рдордп рд╕рдордиреНрд╡рдп рдореБрджреНрджреЗ - рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдмрдбрд╝реЗ рд╕рдордп рдХреЗ рдЕрдВрддрд░ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣рдорд▓реЛрдВ рдЬреИрд╕реЗ рдкрд╛рд╕-рджреА-рдЯрд┐рдХрдЯ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВред
* **0xC0000224**: рдЕрдирд┐рд╡рд╛рд░реНрдп рдкрд╛рд╕рд╡рд░реНрдб рдкрд░рд┐рд╡рд░реНрддрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ - рдмрд╛рд░-рдмрд╛рд░ рдЕрдирд┐рд╡рд╛рд░реНрдп рдкрд░рд┐рд╡рд░реНрддрди рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЕрд╕реНрдерд┐рд░ рдХрд░рдиреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред
* **0xC0000225**: рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЗ рдХреЗ рдмрдЬрд╛рдп рд╕рд┐рд╕реНрдЯрдо рдмрдЧ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред
* **0xC000015b**: рдЕрд╕реНрд╡реАрдХреГрдд рд▓реЙрдЧрд┐рди рдкреНрд░рдХрд╛рд░ - рдЕрдирдзрд┐рдХреГрдд рд▓реЙрдЧрд┐рди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдкрд╣реБрдБрдЪ рдХрд╛ рдкреНрд░рдпрд╛рд╕, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрд╡рд╛ рд▓реЙрдЧрд┐рди рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИред

#### EventID 4616:

* **Time Change**: рд╕рд┐рд╕реНрдЯрдо рд╕рдордп рдореЗрдВ рд╕рдВрд╢реЛрдзрди, рдЬреЛ рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рдордпрд░реЗрдЦрд╛ рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### EventID 6005 рдФрд░ 6006:

* **System Startup and Shutdown**: EventID 6005 рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЪрд╛рд▓реВ рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ EventID 6006 рдЗрд╕реЗ рдмрдВрдж рдХрд░рдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред

#### EventID 1102:

* **Log Deletion**: рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ рдХреЛ рд╕рд╛рдл рдХрд░рдирд╛, рдЬреЛ рдЕрдХреНрд╕рд░ рдЕрд╡реИрдз рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд╛рд▓ рдЭрдВрдбрд╛ рд╣реЛрддрд╛ рд╣реИред

#### EventIDs for USB Device Tracking:

* **20001 / 20003 / 10000**: USB рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдкрд╣рд▓рд╛ рдХрдиреЗрдХреНрд╢рдиред
* **10100**: USB рдбреНрд░рд╛рдЗрд╡рд░ рдЕрдкрдбреЗрдЯред
* **EventID 112**: USB рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдбрд╛рд▓рдиреЗ рдХрд╛ рд╕рдордпред

рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрди рд▓реЙрдЧрд┐рди рдкреНрд░рдХрд╛рд░реЛрдВ рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдбрдВрдкрд┐рдВрдЧ рдХреЗ рдЕрд╡рд╕рд░реЛрдВ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [Altered Security's detailed guide](https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them) рдкрд░ рдЬрд╛рдПрдВред

рдЗрд╡реЗрдВрдЯ рд╡рд┐рд╡рд░рдг, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЗрд╡реЗрдВрдЯ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ Event ID 4625 рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрдиреАрдпред

### Recovering Windows Events

рд╣рдЯрд╛рдП рдЧрдП Windows рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдВрджрд┐рдЧреНрдз рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рд╕реАрдзреЗ рдЕрдирдкреНрд▓рдЧ рдХрд░рдХреЗ рдмрдВрдж рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИред **Bulk\_extractor**, рдПрдХ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдЙрдкрдХрд░рдг рдЬреЛ `.evtx` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдРрд╕реЗ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред

### Identifying Common Attacks via Windows Events

рд╕рд╛рдорд╛рдиреНрдп рд╕рд╛рдЗрдмрд░ рд╣рдорд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдореЗрдВ Windows рдЗрд╡реЗрдВрдЯ IDs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реНрдпрд╛рдкрдХ рдЧрд╛рдЗрдб рдХреЗ рд▓рд┐рдП, [Red Team Recipe](https://redteamrecipe.com/event-codes/) рдкрд░ рдЬрд╛рдПрдВред

#### Brute Force Attacks

рдХрдИ EventID 4625 рд░рд┐рдХреЙрд░реНрдб рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдиреЗ рдЬрд╛рдиреЗ рдпреЛрдЧреНрдп, рдпрджрд┐ рд╣рдорд▓рд╛ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ рддреЛ рдЗрд╕рдХреЗ рдмрд╛рдж рдПрдХ EventID 4624 рд╣реЛрддрд╛ рд╣реИред

#### Time Change

EventID 4616 рджреНрд╡рд╛рд░рд╛ рджрд░реНрдЬ, рд╕рд┐рд╕реНрдЯрдо рд╕рдордп рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдлреЛрд░реЗрдВрд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдЬрдЯрд┐рд▓ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

#### USB Device Tracking

USB рдбрд┐рд╡рд╛рдЗрд╕ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╕рд┐рд╕реНрдЯрдо EventIDs рдореЗрдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП 20001/20003/10000, рдбреНрд░рд╛рдЗрд╡рд░ рдЕрдкрдбреЗрдЯ рдХреЗ рд▓рд┐рдП 10100, рдФрд░ DeviceSetupManager рд╕реЗ рдбрд╛рд▓рдиреЗ рдХреЗ рд╕рдордп рдХреЗ рд▓рд┐рдП EventID 112 рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

#### System Power Events

EventID 6005 рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЪрд╛рд▓реВ рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ EventID 6006 рдмрдВрдж рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред

#### Log Deletion

рд╕реБрд░рдХреНрд╖рд╛ EventID 1102 рд▓реЙрдЧ рдХреЗ рд╣рдЯрд╛рдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдлреЛрд░реЗрдВрд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдирд╛ рд╣реИред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
