# Nmap Ã–zeti (ESP)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github depolarÄ±na katkÄ±da bulunun.**

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parametreler

### Taranacak IP'ler

* **`<ip>,<net/mask>`:** IP'leri doÄŸrudan belirtir
* **`-iL <ips_file>`:** IP listesi
* **`-iR <number>`**: Rastgele IP'lerin sayÄ±sÄ±, olasÄ± IP'leri `--exclude <Ips>` veya `--excludefile <file>` ile hariÃ§ tutabilirsiniz.

### Ekipman keÅŸfi

Nmap varsayÄ±lan olarak `-PA80 -PS443 -PE -PP` oluÅŸan bir keÅŸif aÅŸamasÄ± baÅŸlatÄ±r.

* **`-sL`**: Ä°stilacÄ± deÄŸildir, hedefleri listeler ve isimleri Ã§Ã¶zmek iÃ§in **DNS** istekleri yapar. Ã–rneÄŸin www.prueba.es/24 gibi tÃ¼m IP'lerin hedeflerimiz olup olmadÄ±ÄŸÄ±nÄ± bilmek iÃ§in faydalÄ±dÄ±r.
* **`-Pn`**: **Ping yok**. TÃ¼mÃ¼nÃ¼n aktif olduÄŸunu biliyorsanÄ±z (aksi takdirde Ã§ok zaman kaybedebilirsiniz, ancak bu seÃ§enek aynÄ± zamanda aktif olmadÄ±klarÄ±nÄ± belirterek yanlÄ±ÅŸ negatifler Ã¼retir), keÅŸif aÅŸamasÄ±nÄ± engeller.
* **`-sn`** : **Port taramasÄ± yok**. KeÅŸif aÅŸamasÄ±nÄ± tamamladÄ±ktan sonra port taramasÄ± yapmaz. Nispeten gizli ve kÃ¼Ã§Ã¼k bir aÄŸ taramasÄ±na izin verir. Yetkilerle 80'e bir ACK (-PA), 443'e bir SYN(-PS) ve bir echo isteÄŸi ile bir Zaman damgasÄ± isteÄŸi gÃ¶nderir, yetkiler olmadan her zaman baÄŸlantÄ±larÄ± tamamlar. Hedef aÄŸsa, yalnÄ±zca ARP(-PR) kullanÄ±r. BaÅŸka bir seÃ§enekle kullanÄ±ldÄ±ÄŸÄ±nda, yalnÄ±zca diÄŸer seÃ§eneÄŸin paketleri bÄ±rakÄ±lÄ±r.
* **`-PR`**: **Ping ARP**. AÄŸÄ±mÄ±zdaki bilgisayarlarÄ± analiz ederken varsayÄ±lan olarak kullanÄ±lÄ±r, ping'leri kullanmaktan daha hÄ±zlÄ±dÄ±r. ARP paketleri kullanmak istemiyorsanÄ±z `--send-ip` kullanÄ±n.
* **`-PS <ports>`**: EÄŸer SYN/ACK ile yanÄ±tlarsa aÃ§Ä±ktÄ±r (baÄŸlantÄ±yÄ± sonlandÄ±rmamak iÃ§in RST ile yanÄ±tlarsa), RST ile yanÄ±tlarsa kapalÄ±dÄ±r ve yanÄ±t vermezse ulaÅŸÄ±lamazdÄ±r. Yetkileri yoksa, otomatik olarak toplam bir baÄŸlantÄ± kullanÄ±lÄ±r. EÄŸer portlar belirtilmemiÅŸse, 80'e gÃ¶nderilir.
* **`-PA <ports>`**: Bir Ã¶ncekiyle aynÄ±dÄ±r ancak ACK ile, ikisini birleÅŸtirmek daha iyi sonuÃ§lar verir.
* **`-PU <ports>`**: AmaÃ§larÄ± zÄ±ttÄ±r, kapatÄ±lmÄ±ÅŸ olmasÄ± beklenen portlara gÃ¶nderilir. BazÄ± gÃ¼venlik duvarlarÄ± yalnÄ±zca TCP baÄŸlantÄ±larÄ±nÄ± kontrol eder. EÄŸer kapalÄ±ysa port ulaÅŸÄ±lamaz yanÄ±tÄ± verilir, baÅŸka bir icmp yanÄ±tÄ± veya yanÄ±t verilmezse hedef ulaÅŸÄ±lamaz olarak bÄ±rakÄ±lÄ±r.
* **`-PE, -PP, -PM`** : ICMP PING'leri: echo replay, zaman damgasÄ± ve adres maskesi. Hedefin aktif olup olmadÄ±ÄŸÄ±nÄ± Ã¶ÄŸrenmek iÃ§in gÃ¶nderilir.
* **`-PY<ports>`**: VarsayÄ±lan olarak 80'e SCTP INIT sorgularÄ± gÃ¶nderir, INIT-ACK(aÃ§Ä±k) veya ABORT(kapalÄ±) veya hiÃ§bir ÅŸey veya ICMP ulaÅŸÄ±lamaz (etkin deÄŸil) yanÄ±tÄ± alabilir.
* **`-PO <protocols>`**: BaÅŸlÄ±kta bir protokol belirtilir, varsayÄ±lan olarak 1(ICMP), 2(IGMP) ve 4(Encap IP). ICMP, IGMP, TCP (6) ve UDP (17) protokolleri iÃ§in protokol baÅŸlÄ±klarÄ± gÃ¶nderilir, geri kalanlar iÃ§in yalnÄ±zca IP baÅŸlÄ±ÄŸÄ± gÃ¶nderilir. AmacÄ±, baÅŸlÄ±klarÄ±n bozukluÄŸundan dolayÄ±, Protokol ulaÅŸÄ±lamaz veya aynÄ± protokolÃ¼n yanÄ±tlarÄ± alÄ±nÄ±r ve yukarÄ±da olup olmadÄ±ÄŸÄ±nÄ± anlamak iÃ§in yanÄ±tlar alÄ±nÄ±r.
* **`-n`**: DNS yok
* **`-R`**: Her zaman DNS

### Port tarama teknikleri

* **`-sS`**: BaÄŸlantÄ±yÄ± tamamlamaz, bu nedenle iz bÄ±rakmaz, kullanÄ±labilirse Ã§ok iyidir (yetkiler) VarsayÄ±lan olarak kullanÄ±lan budur.
* **`-sT`**: BaÄŸlantÄ±yÄ± tamamlar, bu nedenle iz bÄ±rakÄ±r, ancak kesin olmasÄ± iÃ§in kullanÄ±labilir. VarsayÄ±lan olarak yetkisiz.
* **`-sU`**: Daha yavaÅŸ, UDP iÃ§in. Genellikle: DNS(53), SNMP(161,162), DHCP(67 ve 68), (-sU53,161,162,67,68): aÃ§Ä±k(yanÄ±t), kapalÄ±(port ulaÅŸÄ±lamaz), filtrelenmiÅŸ (baÅŸka bir ICMP), aÃ§Ä±k/filtrelenmiÅŸ (hiÃ§bir ÅŸey). AÃ§Ä±k/filtrelenmiÅŸ durumunda, -sV nmap'in desteklediÄŸi sÃ¼rÃ¼mlerden herhangi birini tespit etmek iÃ§in birÃ§ok istek gÃ¶nderir ve gerÃ§ek durumu tespit edebilir. ZamanÄ± oldukÃ§a artÄ±rÄ±r.
* **`-sY`**: SCTP protokolÃ¼ baÄŸlantÄ±yÄ± kuramaz, bu nedenle kayÄ±tlar olmaz, -PY gibi Ã§alÄ±ÅŸÄ±r
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, bazÄ± gÃ¼venlik duvarlarÄ±nÄ± aÅŸabilir ve bilgi Ã§Ä±karabilir. Standart uyumlu makinelerin SYN, RST veya ACK bayraklarÄ± iÃ§ermeyen tÃ¼m isteklere RST ile yanÄ±t vermesi gerektiÄŸi varsayÄ±mÄ±na dayanÄ±r: aÃ§Ä±k/filtrelenmiÅŸ(hiÃ§bir ÅŸey), kapalÄ±(RST), filtrelenmiÅŸ (ICMP ulaÅŸÄ±lamaz). Windows, CIsco, BSDI ve OS/400'te gÃ¼venilir deÄŸildir. Unix'te evet.
* **`-sM`**: Maimon taramasÄ±: FIN ve ACK bayraklarÄ± gÃ¶nderir, BSD iÃ§in kullanÄ±lÄ±r, ÅŸu anda tÃ¼mÃ¼nÃ¼ kapalÄ± olarak dÃ¶ndÃ¼recektir.
* **`-sA, sW`**: ACK ve Window, gÃ¼venlik duvarlarÄ±nÄ± tespit etmek iÃ§in kullanÄ±lÄ±r, portlarÄ±n filtrelenip filtrelenmediÄŸini bilmek iÃ§in. -sW, aÃ§Ä±k/kapalÄ± arasÄ±nda ayrÄ±m yapar Ã§Ã¼nkÃ¼ aÃ§Ä±klar farklÄ± bir pencere deÄŸeri ile yanÄ±t verir: aÃ§Ä±k (pencere deÄŸeri 0 olmayan RST), kapalÄ± (pencere = 0 RST), filtrelenmiÅŸ (ICMP ulaÅŸÄ±lamaz veya hiÃ§bir ÅŸey). TÃ¼m bilgisayarlar bu ÅŸekilde Ã§alÄ±ÅŸmaz, bu nedenle tÃ¼m kapalÄ±ysa, Ã§alÄ±ÅŸmÄ±yor demektir, birkaÃ§ aÃ§Ä±ksa, dÃ¼zgÃ¼n Ã§alÄ±ÅŸÄ±yor demektir ve birÃ§ok aÃ§Ä±k ve birkaÃ§ kapalÄ± varsa, ters ÅŸekilde Ã§alÄ±ÅŸÄ±yor demektir.
* **`-sI`:** BoÅŸta tarama. EÄŸer aktif bir gÃ¼venlik duvarÄ± varsa ve belirli bir IP'yi filtrelemediÄŸini biliyorsak (veya sadece anonimlik istiyorsak) zombi tarayÄ±cÄ±yÄ± kullanabiliriz (tÃ¼m portlar iÃ§in Ã§alÄ±ÅŸÄ±r), olasÄ± zombileri bulmak iÃ§in ipidseq betiÄŸi veya exploit auxiliary/scanner/ip/ipidseq kullanabiliriz. Bu tarayÄ±cÄ±, IP paketlerinin IPID numarasÄ±na dayanÄ±r.
* **`--badsum`:** YanlÄ±ÅŸ toplam gÃ¶nderir, bilgisayarlar paketleri reddeder, ancak gÃ¼venlik duvarlarÄ± bir ÅŸeyler yanÄ±tlayabilir, gÃ¼venlik duvarlarÄ±nÄ± tespit etmek iÃ§in kullanÄ±lÄ±r.
* **`-sZ`:** "Garip" SCTP tarayÄ±cÄ±, Ã§erez yankÄ±sÄ± parÃ§alarÄ±yla sorgular gÃ¶nderirken aÃ§Ä±ksa dÃ¼ÅŸÃ¼rÃ¼lmeli veya kapalÄ±ysa ABORT ile yanÄ±tlanmalÄ±dÄ±r. Init'in geÃ§emediÄŸi gÃ¼venlik duvarlarÄ±ndan geÃ§ebilir, kÃ¶tÃ¼ olan, filtrelenmiÅŸ ve aÃ§Ä±k arasÄ±nda ayrÄ±m yapmamasÄ±dÄ±r.
* **`-sO`:** Protokol Ip taramasÄ±. BazÄ± durumlarda hatta protokol bile ayÄ±rt edilemeyen yanlÄ±ÅŸ ve boÅŸ baÅŸlÄ±klar gÃ¶nderir. EÄŸer ICMP ulaÅŸÄ±lamaz protokol gelirse kapalÄ±dÄ±r, ulaÅŸÄ±lamaz port gelirse aÃ§Ä±ktÄ±r, baÅŸka bir hata gelirse filtrelenmiÅŸtir, hiÃ§bir ÅŸey gelirse aÃ§Ä±k|filtrelenmiÅŸtir.
* **`-b <server>`:** FTPhost--> BaÅŸka bir makineden bir makineyi taramak iÃ§in kullanÄ±lÄ±r, bunu yapmak iÃ§in baÅŸka bir makinenin ftp'sine baÄŸlanarak istediÄŸiniz portlara dosya gÃ¶ndermesini istersiniz, yanÄ±tlara gÃ¶re aÃ§Ä±k olup olmadÄ±klarÄ±nÄ± bileceÄŸiz. \[\<user>:\<password>@]\<server>\[:\<port>] ArtÄ±k neredeyse tÃ¼m ftp sunucularÄ±na izin vermez ve bu nedenle pratikte pek kullanÄ±ÅŸlÄ± deÄŸildir.

### **Merkezi analiz**

**-p:** Taranacak portlarÄ± belirtmek iÃ§in kullanÄ±lÄ±r. 65335'i seÃ§mek iÃ§in: **-p-** veya **-p all**. Nmap'in popÃ¼lerliÄŸine gÃ¶re dahili bir sÄ±ralamasÄ± vardÄ±r. VarsayÄ±lan olarak ilk 1000'i kullanÄ±r. **-F** (hÄ±zlÄ± tarama) ile ilk 100'Ã¼ tarar. **--top-ports \<numero>** Belirtilen sayÄ±da ilk portlarÄ± tarar (1'den 65335'e kadar). PortlarÄ± rastgele sÄ±rayla kontrol eder, bunu Ã¶nlemek iÃ§in **-r** kullanÄ±lÄ±r. AyrÄ±ca portlarÄ± seÃ§ebiliriz: 20-30,80,443,1024- Bu sonuncusu 1024'ten sonrasÄ±na bakacaÄŸÄ± anlamÄ±na gelir. AyrÄ±ca portlarÄ± protokollere gÃ¶re gruplayabiliriz: U:53,T:21-25,80,139,S:9. Nmap'in popÃ¼ler portlarÄ± arasÄ±ndan bir aralÄ±k seÃ§ebiliriz: -p \[-1024] nmap-services iÃ§inde bulunan 1024'e kadar olan portlarÄ± tarar. **--port-ratio \<ratio>** Belirtilen oran aralÄ±ÄŸÄ±ndaki en yaygÄ±n portlarÄ± tarar, oran 0 ile 1 arasÄ±nda olmalÄ±dÄ±r.

**-sV** SÃ¼rÃ¼m taramasÄ±, yoÄŸunluÄŸu 0 ile 9 arasÄ±nda ayarlanabilir, varsayÄ±lan 7.

**--version-intensity \<numero>** YoÄŸunluÄŸu ayarlarÄ±z, daha dÃ¼ÅŸÃ¼kse sadece olasÄ±lÄ±ÄŸÄ± yÃ¼ksek olan sorgularÄ± gÃ¶nderir, ancak tÃ¼mÃ¼nÃ¼ deÄŸil. Bu sayede UDP tarama sÃ¼resini Ã¶nemli Ã¶lÃ§Ã¼de kÄ±saltabiliriz.

**-O** Ä°ÅŸletim sistemi tespiti

**--osscan-limit** Bir ana bilgisayarÄ± iyi taramak iÃ§in en az bir aÃ§Ä±k ve bir kapalÄ± port olmasÄ± gerekmektedir, bu koÅŸul saÄŸlanmazsa ve bu seÃ§eneÄŸi belirlediysek, iÅŸletim sistemi tahmini yapmaz (zaman kazandÄ±rÄ±r)
**--osscan-guess** OS tespiti mÃ¼kemmel olmadÄ±ÄŸÄ±nda daha fazla Ã§aba harcar

**Scriptler**

\--script _\<dosyaadÄ±>_|_\<kategori>_|_\<dizin>_|_\<ifade>_\[,...]

VarsayÄ±lanlarÄ± kullanmak iÃ§in -sC veya --script=default yeterlidir

Mevcut tÃ¼rler: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version ve vuln

* **Auth:** kimlik doÄŸrulama iÃ§in mevcut tÃ¼m _scriptleri_ Ã§alÄ±ÅŸtÄ±rÄ±r
* **Default:** aracÄ±n varsayÄ±lan temel _scriptlerini_ Ã§alÄ±ÅŸtÄ±rÄ±r
* **Discovery:** hedef veya kurban hakkÄ±nda bilgi toplar
* **External:** harici kaynaklarÄ± kullanmak iÃ§in _script_
* **Intrusive:** kurban veya hedef iÃ§in mÃ¼dahaleci olarak kabul edilen _scriptleri_ kullanÄ±r
* **Malware:** kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m veya _backdoor_ (arka kapÄ±) tarafÄ±ndan aÃ§Ä±k baÄŸlantÄ±larÄ± kontrol eder
* **Safe:** mÃ¼dahaleci olmayan _scriptleri_ Ã§alÄ±ÅŸtÄ±rÄ±r
* **Vuln:** en bilinen zayÄ±flÄ±klarÄ± keÅŸfeder
* **All:** mevcut tÃ¼m NSE uzantÄ±lÄ± _scriptleri_ Ã§alÄ±ÅŸtÄ±rÄ±r

Scriptleri aramak iÃ§in:

**nmap --script-help="http-\*" -> http- ile baÅŸlayanlar**

**nmap --script-help="not intrusive" -> Bunlar hariÃ§ tÃ¼m scriptler**

**nmap --script-help="default or safe" -> Birinde veya her ikisinde olanlar**

**nmap --script-help="default and safe" --> Her ikisinde olanlar**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<dosyaadÄ±>_

\--script-help _\<dosyaadÄ±>_|_\<kategori>_|_\<dizin>_|_\<ifade>_|all\[,...]

\--script-trace ---> Scriptin durumu hakkÄ±nda bilgi verir

\--script-updatedb

**Bir scripti kullanmak iÃ§in sadece ÅŸunu yazmak yeterlidir: nmap --script Script_AdÄ± hedef** --> Script yazÄ±ldÄ±ÄŸÄ±nda hem script hem de tarayÄ±cÄ± Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r, bu nedenle tarayÄ±cÄ± seÃ§enekleri de ekleyebiliriz, sadece gÃ¼venli olanlarÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **"safe=1"** ekleyebiliriz.

**Zaman KontrolÃ¼**

**Nmap saniye, dakika, ms cinsinden zamanÄ± deÄŸiÅŸtirebilir:** --host-timeout arguments 900000ms, 900, 900s ve 15m hepsi aynÄ± iÅŸi yapar.

Nmap, taranacak toplam host sayÄ±sÄ±nÄ± gruplara bÃ¶ler ve bu gruplarÄ± bloklar halinde analiz eder, bÃ¶ylece tÃ¼m gruplar analiz edilene kadar bir sonraki bloÄŸa geÃ§mez (ve kullanÄ±cÄ±ya blok analiz edilene kadar herhangi bir gÃ¼ncelleme alÄ±nmaz), bu nedenle nmap iÃ§in bÃ¼yÃ¼k gruplar kullanmak daha iyidir. VarsayÄ±lan olarak sÄ±nÄ±f C'de 256 kullanÄ±r.

DeÄŸiÅŸtirebilirsiniz\*\*--min-hostgroup\*\* _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Paralel tarama grup boyutlarÄ±nÄ± ayarlayÄ±n)

Paralel tarama sayÄ±sÄ±nÄ± kontrol edebilirsiniz ancak genellikle gerekli deÄŸildir (nmap aÄŸ durumuna gÃ¶re otomatik kontrol saÄŸlar): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

Rtt zaman aÅŸÄ±mÄ±nÄ± deÄŸiÅŸtirebilirsiniz, ancak genellikle gerekli deÄŸildir: **--min-rtt-timeout** _**\<zaman>**_**,** **--max-rtt-timeout** _**\<zaman>**_**,** **--initial-rtt-timeout** _**\<zaman>**_

Deneme sayÄ±sÄ±nÄ± deÄŸiÅŸtirebilirsiniz:**--max-retries** _**\<denemesayÄ±sÄ±>**_

Bir hostun tarama sÃ¼resini deÄŸiÅŸtirebilirsiniz: **--host-timeout** _**\<zaman>**_

Her test arasÄ±ndaki sÃ¼reyi yavaÅŸlatmak iÃ§in: **--scan-delay** _**\<zaman>**_**;** **--max-scan-delay** _**\<zaman>**_

Saniyedeki paket sayÄ±sÄ±nÄ± deÄŸiÅŸtirebilirsiniz: **--min-rate** _**\<sayÄ±>**_**;** **--max-rate** _**\<sayÄ±>**_

FiltrelenmiÅŸ veya kapalÄ± birÃ§ok port yanÄ±t vermek iÃ§in uzun sÃ¼rebilir, yalnÄ±zca aÃ§Ä±k olanlarÄ± ilgilendiriyorsa daha hÄ±zlÄ± tarama yapabiliriz: **--defeat-rst-ratelimit**

Nmap'Ä±n ne kadar saldÄ±rgan olmasÄ±nÄ± istediÄŸimizi belirlemek iÃ§in: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> YalnÄ±zca bir port taranÄ±r ve bir sonraki iÃ§in 5 dakika beklenir

\-T1 ve T2 --> Ã‡ok benzer ancak her test arasÄ±nda sÄ±rasÄ±yla 15 ve 0,4 saniye bekler

\-T3 --> VarsayÄ±lan iÅŸlevsellik, paralel iÃ§erir

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**GÃ¼venlik DuvarÄ±/IDS**

PortlarÄ± kapatÄ±r ve paketleri analiz eder.

**-f** Paketleri parÃ§alamak iÃ§in, varsayÄ±lan olarak baÅŸlÄ±k sonrasÄ± 8 bayt parÃ§alar, bu boyutu belirtmek iÃ§in ..mtu kullanÄ±rÄ±z (bununla birlikte, -f kullanmayÄ±n), ofset 8'in katÄ± olmalÄ±dÄ±r. **Versiyon tarama ve scriptler parÃ§alamayÄ± desteklemez**

**-D decoy1,decoy2,ME** Nmap, diÄŸer IP adresleriyle taramalar gÃ¶nderir, bÃ¶ylece kendinizi gizler. ME'yi listeye eklerseniz, nmap sizi oraya yerleÅŸtirir, sizi tamamen gizlemek iÃ§in kendinizden Ã¶nce 5 veya 6 eklemek daha iyidir. RND:\<sayÄ±> ile rastgele IP'ler oluÅŸturabilirsiniz. TCP baÄŸlantÄ±sÄ± olmayan versiyon algÄ±layÄ±cÄ±larÄ±yla Ã§alÄ±ÅŸmaz. Bir aÄŸ iÃ§indeyseniz, etkin IP'leri kullanmanÄ±z Ã¶nemlidir, aksi takdirde sizin tek etkin olduÄŸunuzu kolayca anlamak mÃ¼mkÃ¼n olacaktÄ±r.

Rastgele IP'ler kullanmak iÃ§in: nmap-D RND: 10 Hedef_IP

**-S IP** Nmap, IP adresinizi alamadÄ±ÄŸÄ±nda bunu vermeniz gerekir. AyrÄ±ca, baÅŸka bir hedefin tarama yaptÄ±ÄŸÄ±nÄ± dÃ¼ÅŸÃ¼ndÃ¼rmek iÃ§in de kullanÄ±lÄ±r.

**-e \<arayÃ¼z>** ArayÃ¼zÃ¼ seÃ§mek iÃ§in

BirÃ§ok yÃ¶netici, her ÅŸeyin dÃ¼zgÃ¼n Ã§alÄ±ÅŸmasÄ± iÃ§in giriÅŸ kapÄ±larÄ±nÄ± aÃ§Ä±k bÄ±rakÄ±r ve baÅŸka bir Ã§Ã¶zÃ¼m aramaktan kaÃ§Ä±nÄ±rlar. Bu, DNS veya FTP gibi portlar olabilir... Bu zayÄ±flÄ±ÄŸÄ± aramak iÃ§in nmap ÅŸunlarÄ± iÃ§erir: **--source-port** _**\<portnumarasÄ±>**_**;-g** _**\<portnumarasÄ±>**_ _EÅŸdeÄŸerdir_

**--data** _**\<onaltÄ±lÄ±k dize>**_ OnaltÄ±lÄ±k metin gÃ¶ndermek iÃ§in: --data 0xdeadbeef ve --data \xCA\xFE\x09

**--data-string** _**\<dize>**_ Normal metin gÃ¶ndermek iÃ§in: --data-string "GÃ¼venlik OperasyonlarÄ± tarafÄ±ndan yapÄ±lan tarama, uzantÄ± 7192"

**--data-length** _**\<sayÄ±>**_ Nmap yalnÄ±zca baÅŸlÄ±klar gÃ¶nderir, bu sayede rastgele oluÅŸturulan belirli bir bayt sayÄ±sÄ±nÄ± ekleriz

IP paketini tamamen yapÄ±landÄ±rmak iÃ§in **--ip-options** kullanÄ±n

GÃ¶nderilen ve alÄ±nan paketlerdeki seÃ§enekleri gÃ¶rmek istiyorsanÄ±z, --packet-trace belirtin. Nmap ile IP seÃ§eneklerini kullanma hakkÄ±nda daha fazla bilgi ve Ã¶rnek iÃ§in [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52) adresine bakÄ±n.

**--ttl** _**\<deÄŸer>**_

**--randomize-hosts** SaldÄ±rÄ±nÄ±n daha az belirgin olmasÄ±nÄ± saÄŸlamak iÃ§in

**--spoof-mac** _**\<MAC adresi, Ã¶nek veya Ã¼retici adÄ±>**_ Mac adresini deÄŸiÅŸtirmek iÃ§in Ã¶rnekler: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 ve Cisco
**--proxies** _**\<Proxy URL'lerinin virgÃ¼lle ayrÄ±lmÄ±ÅŸ listesi>**_ Proxies kullanmak iÃ§in, bazen bir proxy nmap'in istediÄŸi kadar Ã§ok baÄŸlantÄ±yÄ± aÃ§Ä±k tutmaz, bu yÃ¼zden paralelizmi deÄŸiÅŸtirmek gerekebilir: --max-parallelism

**-sP** ARP ile aÄŸdaki ana bilgisayarlarÄ± keÅŸfetmek iÃ§in

Ã‡oÄŸu yÃ¶netici, belirli bir baÄŸlantÄ± noktasÄ±ndan gelen tÃ¼m paketlerin geÃ§mesine izin veren bir gÃ¼venlik duvarÄ± kuralÄ± oluÅŸturur (Ã¶rneÄŸin 20, 53 ve 67 gibi), nmap'e paketlerimizi bu baÄŸlantÄ± noktalarÄ±ndan gÃ¶ndermesini sÃ¶yleyebiliriz: **nmap --source-port 53 Ip**

**Ã‡Ä±ktÄ±lar**

**-oN dosya** Normal Ã§Ä±ktÄ±

**-oX dosya** XML Ã§Ä±ktÄ±sÄ±

**-oS dosya** Script Ã§ocuklarÄ± Ã§Ä±ktÄ±sÄ±

**-oG dosya** Grepable Ã§Ä±ktÄ±

**-oA dosya** -oS hariÃ§ tÃ¼m Ã§Ä±ktÄ±lar

**-v seviye** ayrÄ±ntÄ± seviyesi

**-d seviye** hata ayÄ±klama

**--reason** Ana bilgisayarÄ±n ve durumun nedeni

**--stats-every zaman** Belirli aralÄ±klarla durumu bildirir

**--packet-trace** GÃ¶nderilen paketleri gÃ¶rmek iÃ§in filtreler belirtilebilir: --version-trace veya --script-trace

**--open** AÃ§Ä±k, aÃ§Ä±k|filtrelenen ve filtrelenmeyenleri gÃ¶sterir

**--resume dosya** Ã–zet Ã§Ä±karÄ±r

**Ã‡eÅŸitli**

**-6** ipv6'ya izin verir

**-A** -O -sV -sC --traceroute ile aynÄ±dÄ±r

**Ã‡alÄ±ÅŸma sÃ¼resi**

Nmap Ã§alÄ±ÅŸÄ±rken seÃ§enekleri deÄŸiÅŸtirebiliriz:

v / V AyrÄ±ntÄ± seviyesini artÄ±r / azalt

d / D Hata ayÄ±klama seviyesini artÄ±r / azalt

p / P Paket izlemeyi aÃ§ / kapat

? Ã‡alÄ±ÅŸma zamanÄ± etkileÅŸim yardÄ±m ekranÄ±nÄ± yazdÄ±r

**Vulscan**

Nmap betiÄŸi, alÄ±nan hizmet sÃ¼rÃ¼mlerini Ã§evrimdÄ±ÅŸÄ± bir veritabanÄ±nda (diÄŸer Ã¶nemli veritabanlarÄ±ndan indirilen) inceleyen ve olasÄ± zayÄ±flÄ±klarÄ± dÃ¶ndÃ¼ren bir betiktir

KullandÄ±ÄŸÄ± veritabanlarÄ±:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Nmap klasÃ¶rÃ¼ne indirip kurmak iÃ§in:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

AyrÄ±ca, veritabanÄ± paketlerini indirip /usr/share/nmap/scripts/vulscan/ klasÃ¶rÃ¼ne eklemek gerekecektir

KullanÄ±m:

Hepsini kullanmak iÃ§in: sudo nmap -sV --script=vulscan TARAMA_YAPILACAK_IP

Belirli bir veritabanÄ±nÄ± kullanmak iÃ§in: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv TARAMA_YAPILACAK_IP

## Nmap Hizmet taramasÄ±nÄ± x16 hÄ±zlandÄ±rma

[**Bu gÃ¶nderiye**](https://joshua.hu/nmap-speedup-service-scanning-16x) gÃ¶re, nmap hizmet analizini hÄ±zlandÄ±rabilirsiniz, tÃ¼m **`totalwaitms`** deÄŸerlerini **`/usr/share/nmap/nmap-service-probes`** dosyasÄ±nda **300** ve **`tcpwrappedms`** deÄŸerlerini **200** olarak deÄŸiÅŸtirerek.

AyrÄ±ca, Ã¶zellikle tanÄ±mlanmamÄ±ÅŸ **`servicewaitms`** deÄŸerine sahip probeler varsayÄ±lan olarak **`5000`** deÄŸerini kullanÄ±r. Bu nedenle, her bir probeye deÄŸer ekleyebiliriz veya **nmap**'i kendimiz derleyerek [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79) dosyasÄ±ndaki varsayÄ±lan deÄŸeri deÄŸiÅŸtirebiliriz.

EÄŸer **`totalwaitms`** ve **`tcpwrappedms`** deÄŸerlerini hiÃ§ deÄŸiÅŸtirmek istemiyorsanÄ±z, `/usr/share/nmap/nmap-service-probes` dosyasÄ±ndaki bu deÄŸerlerin tamamen yok sayÄ±lmasÄ±nÄ± saÄŸlayacak ÅŸekilde [ayrÄ±ÅŸtÄ±rma kodunu](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) dÃ¼zenleyebilirsiniz.
