# Podsumowanie Nmap (ESP)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parametry

### Adresy IP do skanowania

* **`<ip>,<net/mask>`:** Wskazuje bezpoÅ›rednio adresy IP.
* **`-iL <ips_file>`:** list\_IPs
* **`-iR <number>`**: Liczba losowych adresÃ³w IP, moÅ¼na wykluczyÄ‡ moÅ¼liwe adresy IP za pomocÄ… `--exclude <Ips>` lub `--excludefile <file>`.

### Odkrywanie urzÄ…dzeÅ„

DomyÅ›lnie Nmap uruchamia fazÄ™ odkrywania skÅ‚adajÄ…cÄ… siÄ™ z: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Nieinwazyjne, wyÅ›wietla cele, wysyÅ‚ajÄ…c Å¼Ä…dania **DNS** w celu rozwiÄ…zania nazw. Jest przydatne, aby dowiedzieÄ‡ siÄ™, czy na przykÅ‚ad www.prueba.es/24 wszystkie adresy IP sÄ… naszymi celami.
* **`-Pn`**: **Brak pinga**. Jest to przydatne, jeÅ›li wiesz, Å¼e wszystkie sÄ… aktywne (w przeciwnym razie moÅ¼esz straciÄ‡ duÅ¼o czasu, ale ta opcja rÃ³wnieÅ¼ generuje faÅ‚szywe negatywy mÃ³wiÄ…c, Å¼e nie sÄ… aktywne), zapobiega fazie odkrywania.
* **`-sn`** : **Brak skanowania portÃ³w**. Po zakoÅ„czeniu fazy rozpoznawczej nie skanuje portÃ³w. Jest stosunkowo dyskretny i pozwala na maÅ‚y skan sieci. Z uprawnieniami wysyÅ‚a ACK (-PA) do 80, SYN(-PS) do 443 oraz Å¼Ä…danie echo i Å¼Ä…danie znacznika czasu, bez uprawnieÅ„ zawsze koÅ„czy poÅ‚Ä…czenia. JeÅ›li celem jest sieÄ‡, uÅ¼ywa tylko ARP(-PR). JeÅ›li jest uÅ¼ywany z innÄ… opcjÄ…, odrzucane sÄ… tylko pakiety z innej opcji.
* **`-PR`**: **Ping ARP**. Jest uÅ¼ywany domyÅ›lnie podczas analizy komputerÃ³w w naszej sieci, jest szybszy niÅ¼ uÅ¼ycie pingÃ³w. JeÅ›li nie chcesz uÅ¼ywaÄ‡ pakietÃ³w ARP, uÅ¼yj `--send-ip`.
* **`-PS <ports>`**: WysyÅ‚a pakiety SYN, na ktÃ³re jeÅ›li odpowiada SYN/ACK, jest otwarty (jeÅ›li odpowiada RST, aby nie zakoÅ„czyÄ‡ poÅ‚Ä…czenia), jeÅ›li odpowiada RST, jest zamkniÄ™ty, a jeÅ›li nie odpowiada, jest nieosiÄ…galny. W przypadku braku uprawnieÅ„ automatycznie uÅ¼ywane jest peÅ‚ne poÅ‚Ä…czenie. JeÅ›li nie podano portÃ³w, wysyÅ‚a je do 80.
* **`-PA <ports>`**: Jak poprzedni, ale z ACK, Å‚Ä…czÄ…c oba daje lepsze wyniki.
* **`-PU <ports>`**: Celem jest przeciwny, sÄ… wysyÅ‚ane do portÃ³w, ktÃ³re powinny byÄ‡ zamkniÄ™te. NiektÃ³re firewalle sprawdzajÄ… tylko poÅ‚Ä…czenia TCP. JeÅ›li jest zamkniÄ™ty, odpowiada portem nieosiÄ…galnym, jeÅ›li odpowiada innym icmp lub nie odpowiada, jest pozostawiony jako nieosiÄ…galny.
* **`-PE, -PP, -PM`** : PINGI ICMP: odpowiedÅº echo, znacznik czasu i maska adresu. SÄ… wysyÅ‚ane, aby dowiedzieÄ‡ siÄ™, czy cel jest aktywny.
* **`-PY<ports>`**: WysyÅ‚a sondy SCTP INIT do 80 domyÅ›lnie, INIT-ACK(otwarty) lub ABORT(zamkniÄ™ty) lub nic albo ICMP nieosiÄ…galny(nieaktywny) mogÄ… byÄ‡ odpowiedziane.
* **`-PO <protocols>`**: W nagÅ‚Ã³wkach wskazany jest protokÃ³Å‚, domyÅ›lnie 1(ICMP), 2(IGMP) i 4(Encap IP). Dla protokoÅ‚Ã³w ICMP, IGMP, TCP (6) i UDP (17) wysyÅ‚ane sÄ… nagÅ‚Ã³wki protokoÅ‚Ã³w, dla reszty wysyÅ‚any jest tylko nagÅ‚Ã³wek IP. Celem tego jest to, Å¼e z powodu znieksztaÅ‚cenia nagÅ‚Ã³wkÃ³w, odpowiedzi na niedostÄ™pny protokÃ³Å‚ lub odpowiedzi tego samego protokoÅ‚u sÄ… wysyÅ‚ane, aby dowiedzieÄ‡ siÄ™, czy jest aktywny.
* **`-n`**: Brak DNS
* **`-R`**: Zawsze DNS

### Techniki skanowania portÃ³w

* **`-sS`**: Nie koÅ„czy poÅ‚Ä…czenia, wiÄ™c nie pozostawia Å›ladu, bardzo dobre, jeÅ›li moÅ¼na go uÅ¼yÄ‡ (uprawnienia). Jest uÅ¼ywany domyÅ›lnie.
* **`-sT`**: KoÅ„czy poÅ‚Ä…czenie, wiÄ™c pozostawia Å›lad, ale moÅ¼na go uÅ¼yÄ‡ z pewnoÅ›ciÄ…. DomyÅ›lnie bez uprawnieÅ„.
* **`-sU`**: Wolniejszy, dla UDP. GÅ‚Ã³wnie: DNS(53), SNMP(161,162), DHCP(67 i 68), (-sU53,161,162,67,68): otwarty(odpowiedÅº), zamkniÄ™ty(port nieosiÄ…galny), odfiltrowany (inny ICMP), otwarty/odfiltrowany (nic). W przypadku otwarto/odfiltrowany, -sV wysyÅ‚a liczne Å¼Ä…dania, aby wykryÄ‡ ktÃ³reÅ› z wersji obsÅ‚ugiwanych przez nmap i moÅ¼e wykryÄ‡ prawdziwy stan. Znacznie zwiÄ™ksza czas.
* **`-sY`**: ProtokÃ³Å‚ SCTP nie udaje siÄ™ nawiÄ…zaÄ‡ poÅ‚Ä…czenia, wiÄ™c nie ma logÃ³w, dziaÅ‚a jak -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, mogÄ… przenikaÄ‡ przez niektÃ³re firewalle i wydobywaÄ‡ informacje. Oparte sÄ… na fakcie, Å¼e zgodne z normÄ… maszyny powinny odpowiadaÄ‡ RST na wszystkie Å¼Ä…dania, ktÃ³re nie majÄ… podniesionych flag SYN, RST lub ACK: otwarty/odfiltrowany(nic), zamkniÄ™ty(RST), odfiltrowany (ICMP nieosiÄ…galny). Niepewne w przypadku systemÃ³w Windows, CIsco, BSDI i OS/400. W systemach Unix tak.
* **`-sM`**: Skan Maimon: WysyÅ‚a flagi FIN i ACK, uÅ¼ywane dla BSD, obecnie zwrÃ³ci wszystko jako zamkniÄ™te.
* **`-sA, sW`**: ACK i Window, sÅ‚uÅ¼y do wykrywania firewalle, aby dowiedzieÄ‡ siÄ™, czy porty sÄ… odfiltrowane czy nie. -sW rozrÃ³Å¼nia miÄ™dzy otwartymi/zamkniÄ™tymi, poniewaÅ¼ otwarte odpowiadajÄ… innÄ… wartoÅ›ciÄ… okna: otwarty (RST z oknem innym niÅ¼ 0), zamkniÄ™ty (RST z oknem = 0), odfiltrowany (ICMP nieosiÄ…galny lub nic). Nie wszystkie komputery dziaÅ‚ajÄ… w ten sposÃ³b, wiÄ™c jeÅ›li wszystkie sÄ… zamkniÄ™te, to nie dziaÅ‚a, jeÅ›li kilka jest otwartych, to dziaÅ‚a dobrze, a jeÅ›li jest wiele otwartych i niewiele zamkniÄ™tych, to dziaÅ‚a odwrotnie.
* **`-sI`:** Skan bezczynnoÅ›ci. W przypadkach, gdy istnieje aktywny firewall, ale wiemy, Å¼e nie filtrowuje do okreÅ›lonego adresu IP (lub gdy po prostu chcemy zachowaÄ‡ anonimowoÅ›Ä‡), moÅ¼emy uÅ¼yÄ‡ skanera zombie (dziaÅ‚a dla wszystkich portÃ³w), aby znaleÅºÄ‡ moÅ¼liwe zombi, moÅ¼emy uÅ¼yÄ‡ skryptu ipidseq lub eksploatacji pomocniczej/skaner/ip/ipidseq. Ten skaner opiera siÄ™ na numerze IPID pakietÃ³w IP.
* **`--badsum`:** WysyÅ‚a bÅ‚Ä™dne sumy, komputery odrzuciÅ‚yby pakiety, ale firewalle mogÄ… odpowiedzieÄ‡ czymÅ›, sÅ‚uÅ¼y do wykrywania firewalle.
* **`-sZ`:** "Dziwny" skaner SCTP, podczas wysyÅ‚ania sond z fragmentami echo cookie powinny byÄ‡ odrzucane, jeÅ›li sÄ… otwarte lub odpowiedziane ABORT, jeÅ›li sÄ… zamkniÄ™te. MoÅ¼e przechodziÄ‡ przez firewalle, przez ktÃ³re nie przechodzi init, zÅ‚e jest to, Å¼e nie rozrÃ³Å¼nia miÄ™dzy odfiltrowanymi i otwartymi.
* **`-sO`:** Skan protokoÅ‚u Ip. WysyÅ‚a zÅ‚e i puste nagÅ‚Ã³wki, w ktÃ³rych czasami nawet protokÃ³Å‚ nie moÅ¼e byÄ‡ odrÃ³Å¼niony. JeÅ›li dotrze nieosiÄ…galny protokÃ³Å‚ ICMP, jest zamkniÄ™ty, jeÅ›li dotrze nieosiÄ…galny port, jest otwarty, jeÅ›li dotrze inny bÅ‚Ä…d, jest odfiltrowany, jeÅ›li nic nie dotrze, jest otwarty|odfiltrowany.
* **`-b <server>`:** FTPhost--> SÅ‚uÅ¼y do skanowania hosta z innego, jest to robione poprzez poÅ‚Ä…czenie z ftp innego komputera i proszenie go o wysÅ‚anie plikÃ³w do portÃ³w, ktÃ³re chcesz zeskanowaÄ‡ z innego komputera, na podstawie odpowiedzi dowiemy siÄ™, czy sÄ… otwarte czy nie. \[\<user>:\<password>@]\<server>\[:\<port>] Prawie wszystkie serwery ftp juÅ¼ nie pozwalajÄ… na to, dlatego jest to maÅ‚o praktyczne.

### **Centrowanie analizy**

**-p:** SÅ‚uÅ¼y do okreÅ›lenia skanowanych portÃ³w. Aby wybraÄ‡ 65335: **-p-** lub **-p all**. Nmap ma wewnÄ™trznÄ… klasyfikacjÄ™ wedÅ‚ug popularnoÅ›ci. DomyÅ›lnie uÅ¼ywa 1000 gÅ‚Ã³wnych portÃ³w. Z **-F** (szybkie skanowanie) analizuje 100 gÅ‚Ã³wnych portÃ³w. Z **--top-ports \<numero>** Analizuje tÄ™ liczbÄ™ gÅ‚Ã³wnych portÃ³w (od 1 do 65335). Sprawdza porty w losowej kolejnoÅ›ci, aby tego uniknÄ…Ä‡ **-r**. MoÅ¼emy rÃ³wnieÅ¼ wybraÄ‡ porty: 20-30,80,443,1024- To ostatnie oznacza, Å¼e sprawdza od 1024 w gÃ³rÄ™. MoÅ¼emy rÃ³wnieÅ¼ grupowaÄ‡ porty wedÅ‚ug protokoÅ‚Ã³w: U:53,T:21-25,80,139,S:9. MoÅ¼emy rÃ³wnieÅ¼ wybraÄ‡ zakres wÅ›rÃ³d popularnych portÃ³w nmap: -p \[-1024] analizuje do 1024 z tych zawartych w nmap-services. **--port-ratio \<ratio>** Analizuje najczÄ™Å›ciej uÅ¼ywane porty z okreÅ›lonym wspÃ³Å‚czynnikiem, ktÃ³ry powinien byÄ‡ miÄ™dzy 0 a 1.

**-sV** Skanowanie wersji, intensywnoÅ›Ä‡ moÅ¼na regulowaÄ‡ od 0 do 9, domyÅ›lnie 7.

**--version-intensity \<numero>** Reguluje intensywnoÅ›Ä‡, im niÅ¼sza, tym tylko najbardziej prawdopodobne sondy zostanÄ… wysÅ‚ane, ale nie wszystkie. DziÄ™ki temu moÅ¼emy znacznie skrÃ³ciÄ‡ czas skanowania UDP.

**-O** Wykrywanie systemu operacyjnego

**--osscan-limit** Aby dobrze zeskanowaÄ‡ hosta, potrzebny jest co najmniej jeden otwarty i jeden zamkniÄ™ty port, jeÅ›li ta zasada nie jest speÅ‚niona i uÅ¼yliÅ›my tego, nie prÃ³buje przewidywaÄ‡ systemu operacyjnego (oszczÄ™dza czas)
**--osscan-guess** Gdy wykrycie systemu operacyjnego nie jest idealne, ta opcja zmusza do wiÄ™kszego wysiÅ‚ku.

**Skrypty**

\--script _\<nazwapliku>_|_\<kategoria>_|_\<katalog>_|_\<wyraÅ¼enie>_\[,...]

DomyÅ›lnie moÅ¼na uÅ¼yÄ‡ -sC lub --script=default

DostÄ™pne kategorie to: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version i vuln

* **Auth:** uruchamia wszystkie dostÄ™pne skrypty autoryzacyjne
* **Default:** uruchamia podstawowe skrypty domyÅ›lne narzÄ™dzia
* **Discovery:** pozyskuje informacje o celu
* **External:** skrypt do korzystania z zewnÄ™trznych zasobÃ³w
* **Intrusive:** uÅ¼ywa skryptÃ³w uznawanych za inwazyjne dla celu
* **Malware:** sprawdza, czy istniejÄ… otwarte poÅ‚Ä…czenia zÅ‚oÅ›liwych kodÃ³w lub tylnych drzwi (backdoors)
* **Safe:** uruchamia skrypty, ktÃ³re nie sÄ… inwazyjne
* **Vuln:** odkrywa najbardziej znane podatnoÅ›ci
* **All:** uruchamia wszystkie dostÄ™pne skrypty NSE

Aby wyszukaÄ‡ skrypty:

**nmap --script-help="http-\*" -> Te, ktÃ³re zaczynajÄ… siÄ™ od http-**

**nmap --script-help="not intrusive" -> Wszystkie oprÃ³cz tych**

**nmap --script-help="default or safe" -> Te, ktÃ³re sÄ… w jednym lub drugim lub obu**

**nmap --script-help="default and safe" --> Te, ktÃ³re sÄ… w obu**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<nazwapliku>_

\--script-help _\<nazwapliku>_|_\<kategoria>_|_\<katalog>_|_\<wyraÅ¼enie>_|all\[,...]

\--script-trace ---> UdostÄ™pnia informacje o dziaÅ‚aniu skryptu

\--script-updatedb

**Aby uÅ¼yÄ‡ skryptu, wystarczy wpisaÄ‡: nmap --script Nazwa\_skryptu cel** --> Po wpisaniu skryptu zostanie uruchomiony zarÃ³wno skrypt, jak i skaner, wiÄ™c moÅ¼na rÃ³wnieÅ¼ dodawaÄ‡ opcje skanera, moÅ¼na dodaÄ‡ **â€œsafe=1â€** aby uruchomiÄ‡ tylko te, ktÃ³re sÄ… bezpieczne.

**Kontrola czasu**

**Nmap moÅ¼e zmieniaÄ‡ czas w sekundach, minutach, ms:** --host-timeout arguments 900000ms, 900, 900s, and 15m all do the same thing.

Nmap dzieli Å‚Ä…cznÄ… liczbÄ™ hostÃ³w do zeskanowania na grupy i analizuje te grupy blokami, tak Å¼e dopÃ³ki wszystkie nie zostanÄ… zanalizowane, nie przechodzi do nastÄ™pnego bloku (i uÅ¼ytkownik nie otrzymuje aktualizacji, dopÃ³ki blok nie zostanie zanalizowany). Dlatego dla nmapa bardziej optymalne jest uÅ¼ywanie duÅ¼ych grup. DomyÅ›lnie w klasie C uÅ¼ywa 256.

MoÅ¼na to zmieniÄ‡ za pomocÄ…\*\*--min-hostgroup\*\* _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Dostosuj rozmiary grup skanowania rÃ³wnolegÅ‚ego)

MoÅ¼na kontrolowaÄ‡ liczbÄ™ skanerÃ³w rÃ³wnolegÅ‚ych, ale lepiej tego nie robiÄ‡ (nmap ma juÅ¼ wbudowany automatyczny kontroler na podstawie stanu sieci): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

MoÅ¼na zmieniÄ‡ czas oczekiwania na rtt, ale zazwyczaj nie jest to konieczne: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

MoÅ¼na zmieniÄ‡ liczbÄ™ prÃ³b:**--max-retries** _**\<numtries>**_

MoÅ¼na zmieniÄ‡ czas skanowania hosta: **--host-timeout** _**\<time>**_

MoÅ¼na zmieniÄ‡ czas miÄ™dzy kaÅ¼dym testem, aby dziaÅ‚aÄ‡ wolniej: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

MoÅ¼na zmieniÄ‡ liczbÄ™ pakietÃ³w na sekundÄ™: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

Wiele portÃ³w dÅ‚ugo odpowiada, gdy sÄ… filtrowane lub zamkniÄ™te, jeÅ›li interesujÄ… nas tylko otwarte, moÅ¼emy dziaÅ‚aÄ‡ szybciej z: **--defeat-rst-ratelimit**

Aby okreÅ›liÄ‡, jak agresywne ma byÄ‡ nmap: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> Skanuje tylko 1 port na raz i czeka 5 minut przed kolejnym

\-T1 i T2 --> Bardzo podobne, ale czekajÄ… tylko 15 i 0,4 sekundy miÄ™dzy kaÅ¼dym testem

\-T3 --> DziaÅ‚anie domyÅ›lne, obejmuje rÃ³wnolegÅ‚e dziaÅ‚anie

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**Firewall/IDS**

Blokuje porty i analizuje pakiety.

**-f** Do fragmentacji pakietÃ³w, domyÅ›lnie fragmentuje je co 8 bajtÃ³w po nagÅ‚Ã³wku, aby okreÅ›liÄ‡ ten rozmiar uÅ¼ywamy ..mtu (wtedy nie uÅ¼ywamy -f), przesuniÄ™cie musi byÄ‡ wielokrotnoÅ›ciÄ… 8. **Skanery wersji i skrypty nie obsÅ‚ugujÄ… fragmentacji**

**-D decoy1,decoy2,ME** Nmap wysyÅ‚a skanery, ale z innymi adresami IP jako ÅºrÃ³dÅ‚owymi, w ten sposÃ³b ukrywasz siÄ™. JeÅ›li dodasz ME do listy, nmap umieÅ›ci ciÄ™ tam, lepiej dodaÄ‡ 5 lub 6 przed tobÄ…, aby caÅ‚kowicie ukryÄ‡ swojÄ… toÅ¼samoÅ›Ä‡. MoÅ¼na generowaÄ‡ losowe adresy IP z RND:\<numer> Aby wygenerowaÄ‡ \<numer> losowych adresÃ³w IP. Nie dziaÅ‚ajÄ… z wykrywaniem wersji bez poÅ‚Ä…czenia TCP. JeÅ›li jesteÅ› w sieci, lepiej uÅ¼yÄ‡ aktywnych adresÃ³w IP, w przeciwnym razie bÄ™dzie Å‚atwo ustaliÄ‡, Å¼e jesteÅ› jedynym aktywnym.

Aby uÅ¼yÄ‡ losowych adresÃ³w IP: nmap-D RND: 10 Cel\_IP

**-S IP** Gdy Nmap nie wykrywa twojego adresu IP, musisz go podaÄ‡. MoÅ¼e rÃ³wnieÅ¼ sprawiÄ‡, Å¼e wydaje siÄ™, Å¼e inny cel skanuje ich.

**-e \<interfejs>** Do wyboru interfejsu

Wielu administratorÃ³w pozostawia otwarte porty wejÅ›ciowe, aby wszystko dziaÅ‚aÅ‚o poprawnie i Å‚atwiej jest im znaleÅºÄ‡ inne rozwiÄ…zanie. MogÄ… to byÄ‡ porty DNS lub FTP... aby znaleÅºÄ‡ tÄ™ podatnoÅ›Ä‡, nmap zawiera: **--source-port** _**\<numerportu>**_**;-g** _**\<numerportu>**_ _SÄ… rÃ³wnowaÅ¼ne_

**--data** _**\<ciÄ…g szesnastkowy>**_ Do wysyÅ‚ania tekstu szesnastkowego: --data 0xdeadbeef and --data \xCA\xFE\x09

**--data-string** _**\<ciÄ…g>**_ Do wysyÅ‚ania zwykÅ‚ego tekstu: --data-string "Skan przeprowadzony przez Security Ops, numer wewnÄ™trzny 7192"

**--data-length** _**\<liczba>**_ Nmap wysyÅ‚a tylko nagÅ‚Ã³wki, dziÄ™ki temu dodajemy okreÅ›lonÄ… liczbÄ™ dodatkowych bajtÃ³w (ktÃ³re zostanÄ… wygenerowane losowo)

Aby skonfigurowaÄ‡ pakiet IP w peÅ‚ni, uÅ¼yj **--ip-options**

JeÅ›li chcesz zobaczyÄ‡ opcje w wysyÅ‚anych i otrzymywanych pakietach, okreÅ›l --packet-trace. Aby uzyskaÄ‡ wiÄ™cej informacji i przykÅ‚ady korzystania z opcji IP z Nmap, zobacz [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<wartoÅ›Ä‡>**_

**--randomize-hosts** Aby atak byÅ‚ mniej oczywisty

**--spoof-mac** _**\<adresMAC, prefiks lub nazwa producenta>**_ Do zmiany adresu MAC, przykÅ‚ady: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, and Cisco
**--proxies** _**\<Lista adresÃ³w URL proxy oddzielonych przecinkami>**_ Aby uÅ¼ywaÄ‡ proxy, czasami proxy nie utrzymuje tylu otwartych poÅ‚Ä…czeÅ„, ile chce nmap, dlatego naleÅ¼y dostosowaÄ‡ rÃ³wnolegÅ‚oÅ›Ä‡: --max-parallelism

**-sP** Do odkrywania hostÃ³w w sieci, w ktÃ³rej siÄ™ znajdujemy za pomocÄ… ARP

Wielu administratorÃ³w tworzy reguÅ‚Ä™ w firewallu, ktÃ³ra pozwala na przepuszczanie wszystkich pakietÃ³w pochodzÄ…cych z okreÅ›lonego portu (np. 20, 53 i 67), moÅ¼emy powiedzieÄ‡ nmapowi, aby wysyÅ‚aÅ‚ nasze pakiety z tych portÃ³w: **nmap --source-port 53 Ip**

**WyjÅ›cia**

**-oN plik** Normalne wyjÅ›cie

**-oX plik** WyjÅ›cie XML

**-oS plik** WyjÅ›cie dla script kiddies

**-oG plik** WyjÅ›cie w formacie grepable

**-oA plik** Wszystkie oprÃ³cz -oS

**-v poziom** poziom szczegÃ³Å‚owoÅ›ci

**-d poziom** debugowanie

**--reason** PowÃ³d hosta i jego stan

**--stats-every czas** Co jakiÅ› czas pokazuje postÄ™p

**--packet-trace** Aby zobaczyÄ‡, jakie pakiety sÄ… wysyÅ‚ane, moÅ¼na okreÅ›liÄ‡ filtry, takie jak: --version-trace lub --script-trace

**--open** Pokazuje otwarte, otwarte|filtrowane i niezfiltrowane

**--resume plik** Tworzy podsumowanie

**RÃ³Å¼ne**

**-6** Pozwala na IPv6

**-A** To samo co -O -sV -sC --traceroute

**Czas dziaÅ‚ania**

Podczas dziaÅ‚ania nmap moÅ¼emy zmieniaÄ‡ opcje:

v / V ZwiÄ™ksz / zmniejsz poziom szczegÃ³Å‚owoÅ›ci

d / D ZwiÄ™ksz / zmniejsz poziom debugowania

p / P WÅ‚Ä…cz / wyÅ‚Ä…cz Å›ledzenie pakietÃ³w

? WyÅ›wietl pomoc interakcji w czasie rzeczywistym

**Vulscan**

Skrypt nmapa, ktÃ³ry sprawdza wersje usÅ‚ug uzyskane z bazy danych offline (pobieranej z innych bardzo waÅ¼nych) i zwraca potencjalne podatnoÅ›ci

UÅ¼ywane bazy danych to:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Aby pobraÄ‡ i zainstalowaÄ‡ go w folderze Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

NaleÅ¼y rÃ³wnieÅ¼ pobraÄ‡ pakiety z baz danych i dodaÄ‡ je do /usr/share/nmap/scripts/vulscan/

UÅ¼ycie:

Aby uÅ¼yÄ‡ wszystkich: sudo nmap -sV --script=vulscan HOST\_A\_DO\_Skanowania

Aby uÅ¼yÄ‡ okreÅ›lonej bazy danych: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_DO\_Skanowania

## Przyspieszenie skanowania usÅ‚ug Nmap x16

Zgodnie z [**tym postem**](https://joshua.hu/nmap-speedup-service-scanning-16x) moÅ¼na przyspieszyÄ‡ analizÄ™ usÅ‚ug nmap, modyfikujÄ…c wszystkie wartoÅ›ci **`totalwaitms`** w **`/usr/share/nmap/nmap-service-probes`** na **300** i **`tcpwrappedms`** na **200**.

Ponadto sondy, ktÃ³re nie majÄ… zdefiniowanej wartoÅ›ci **`servicewaitms`**, uÅ¼ywajÄ… domyÅ›lnej wartoÅ›ci **`5000`**. Dlatego moÅ¼emy albo dodaÄ‡ wartoÅ›ci do kaÅ¼dej z sond, albo **skompilowaÄ‡ nmap** samodzielnie i zmieniÄ‡ domyÅ›lnÄ… wartoÅ›Ä‡ w [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

JeÅ›li nie chcesz w ogÃ³le zmieniaÄ‡ wartoÅ›ci **`totalwaitms`** i **`tcpwrappedms`** w pliku `/usr/share/nmap/nmap-service-probes`, moÅ¼esz edytowaÄ‡ [kod parsowania](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) w taki sposÃ³b, aby te wartoÅ›ci w pliku `nmap-service-probes` byÅ‚y caÅ‚kowicie ignorowane.

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
