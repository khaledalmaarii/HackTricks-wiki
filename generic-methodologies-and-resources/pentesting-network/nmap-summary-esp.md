<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
```text
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
**-iL** lista\_IPs

**-iR** numero --&gt; Nombre d'IPs alÃ©atoires, les IP possibles peuvent Ãªtre exclues avec **--exclude &lt;Ips&gt;** ou **--excludefile &lt;fichier&gt;**

**DÃ©couverte d'Ã©quipements:**

Nous pouvons utiliser des masques/24

**-sL**: Non invasif, liste les cibles en effectuant des requÃªtes DNS pour rÃ©soudre les noms. Utile pour savoir si, par exemple, www.prueba.es/24 toutes les IPs sont nos cibles.

Par dÃ©faut, Nmap lance une phase de dÃ©couverte qui comprend: -PA80 -PS443 -PE -PP

**-Pn** No ping --&gt; utile **si on sait que tous sont actifs** \(sinon, on pourrait perd
**-f** Pour fragmenter les paquets, par dÃ©faut, ils sont fragmentÃ©s en 8 octets aprÃ¨s l'en-tÃªte. Pour spÃ©cifier cette taille, nous utilisons ..mtu (sans utiliser -f), l'offset doit Ãªtre un multiple de 8. Les scanners de version et les scripts ne prennent pas en charge la fragmentation.

**-D decoy1,decoy2,ME** Nmap envoie des scanners mais avec d'autres adresses IP d'origine, de cette faÃ§on, ils vous cachent. Si vous mettez ME dans la liste, nmap vous y placera, il est prÃ©fÃ©rable de mettre 5 ou 6 avant vous pour vous masquer complÃ¨tement. Des adresses IP alÃ©atoires peuvent Ãªtre gÃ©nÃ©rÃ©es avec RND:&lt;numero&gt; pour gÃ©nÃ©rer &lt;numero&gt; adresses IP alÃ©atoires. Ils ne fonctionnent pas avec les dÃ©tecteurs de versions sans connexion TCP. Si vous Ãªtes dans un rÃ©seau, vous devez utiliser des adresses IP qui sont actives, sinon il sera trÃ¨s facile de dÃ©couvrir que vous Ãªtes la seule active.

Pour utiliser des adresses IP alÃ©atoires: nmap-D RND: 10 Ip\_objetivo

**-S IP** Lorsque Nmap ne dÃ©tecte pas votre adresse IP, vous devez la lui donner avec cela. Cela sert Ã©galement Ã  faire croire qu'il y a une autre cible qui les scanne.

**-e &lt;interface&gt;** Pour choisir l'interface

De nombreux administrateurs laissent des ports d'entrÃ©e ouverts pour que tout fonctionne correctement et qu'il leur soit plus facile de trouver une autre solution. Ceux-ci peuvent Ãªtre les ports DNS ou FTP... pour rechercher cette vulnÃ©rabilitÃ©, nmap intÃ¨gre: **--source-port** _**&lt;portnumber&gt;**_**;-g** _**&lt;portnumber&gt;**_ _Sont Ã©quivalents_

**--data** _**&lt;hex string&gt;**_ Pour envoyer du texte hexadÃ©cimal: --data 0xdeadbeef et --data \xCA\xFE\x09

**--data-string** _**&lt;string&gt;**_ Pour envoyer un texte normal: --data-string "Scan conducted by Security Ops, extension 7192"

**--data-length** _**&lt;number&gt;**_ Nmap envoie uniquement des en-tÃªtes, avec cela, nous parvenons Ã  ajouter un certain nombre d'octets de plus (qui seront gÃ©nÃ©rÃ©s de maniÃ¨re alÃ©atoire)

Pour configurer complÃ¨tement le paquet IP, utilisez **--ip-options**

Si vous souhaitez voir les options dans les paquets envoyÃ©s et reÃ§us, spÃ©cifiez --packet-trace. Pour plus d'informations et d'exemples d'utilisation des options IP avec Nmap, voir [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**&lt;value&gt;**_

**--randomize-hosts** Pour que l'attaque soit moins Ã©vidente

**--spoof-mac** _**&lt;MAC address, prefix, or vendor name&gt;**_ Pour changer la MAC, exemples: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, et Cisco

**--proxies** _**&lt;Comma-separated list of proxy URLs&gt;**_ Pour utiliser des proxys, parfois un proxy ne maintient pas autant de connexions ouvertes que nmap le souhaite, il faudrait donc modifier la parallÃ©lisme: --max-parallelism

**-sP** Pour dÃ©couvrir les hÃ´tes sur le rÃ©seau sur lequel nous sommes par ARP

De nombreux administrateurs crÃ©ent une rÃ¨gle dans le pare-feu qui permet de passer tous les paquets provenant d'un port particulier (comme le 20,53 et 67), nous pouvons dire Ã  nmap d'envoyer nos paquets depuis ces ports: **nmap --source-port 53 Ip**

**Sorties**

**-oN file** Sortie normale

**-oX file** Sortie XML

**-oS file** Sortie pour les script kiddies

**-oG file** Sortie grepable

**-oA file** Tous sauf -oS

**-v level** VerbositÃ©

**-d level** DÃ©bogage

**--reason** Pourquoi de l'hÃ´te et de l'Ã©tat

**--stats-every time** Toutes les fois qu'il nous dit comment Ã§a va

**--packet-trace** Pour voir quels paquets sortent, des filtres peuvent Ãªtre spÃ©cifiÃ©s tels que: --version-trace ou --script-trace

**--open** montre les ouverts, ouverts\|filtrÃ©s et les non filtrÃ©s

**--resume file** Fait un rÃ©sumÃ©

**Divers**

**-6** Permet ipv6

**-A** est la mÃªme chose que -O -sV -sC --traceroute

**Temps d'exÃ©cution**

Pendant que nmap s'exÃ©cute, nous pouvons changer les options:

v / V Augmenter / diminuer le niveau de verbositÃ©

d / D Augmenter / diminuer le niveau de dÃ©bogage

p / P Activer / dÃ©sactiver la trace des paquets

? Imprimer un Ã©cran d'aide Ã  l'interaction en temps d'exÃ©cution

**Vulscan**

Script de nmap qui regarde les versions des services obtenus dans une base de donnÃ©es hors ligne (tÃ©lÃ©chargÃ©e Ã  partir d'autres bases de donnÃ©es trÃ¨s importantes) et renvoie les vulnÃ©rabilitÃ©s possibles.

Les bases de donnÃ©es qu'il utilise sont:

1. Scipvuldb.csv \| [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv \| [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv \| [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv \| [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv \| [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv \| [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv \| [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv \| [http://www.openvas.org](http://www.openvas.org/)

Pour le tÃ©lÃ©charger et l'installer dans le dossier Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Il faudrait Ã©galement tÃ©lÃ©charger les packages des bases de donnÃ©es et les ajouter Ã  /usr/share/nmap/scripts/vulscan/

Utilisation:

Pour tout utiliser: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

Pour utiliser une base de donnÃ©es spÃ©cifique: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS
