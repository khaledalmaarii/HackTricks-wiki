# Spoofing SSDP y Dispositivos UPnP con EvilSSDP

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Consulta los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}

**Consulta [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para m谩s informaci贸n.**

## **Descripci贸n General de SSDP y UPnP**

SSDP (Protocolo Simple de Descubrimiento de Servicios) se utiliza para la publicidad y descubrimiento de servicios de red, operando en el puerto UDP 1900 sin necesidad de configuraciones DHCP o DNS. Es fundamental en la arquitectura UPnP (Universal Plug and Play), facilitando la interacci贸n sin problemas entre dispositivos en red como PCs, impresoras y dispositivos m贸viles. La red de cero configuraci贸n de UPnP soporta el descubrimiento de dispositivos, la asignaci贸n de direcciones IP y la publicidad de servicios.

## **Flujo y Estructura de UPnP**

La arquitectura UPnP se compone de seis capas: direccionamiento, descubrimiento, descripci贸n, control, eventos y presentaci贸n. Inicialmente, los dispositivos intentan obtener una direcci贸n IP o autoasignarse una (AutoIP). La fase de descubrimiento involucra el SSDP, con dispositivos enviando activamente solicitudes M-SEARCH o transmitiendo pasivamente mensajes NOTIFY para anunciar servicios. La capa de control, vital para la interacci贸n cliente-dispositivo, utiliza mensajes SOAP para la ejecuci贸n de comandos basados en descripciones de dispositivos en archivos XML.

## **Descripci贸n General de IGD y Herramientas**

IGD (Dispositivo de Puerta de Enlace a Internet) facilita mapeos de puertos temporales en configuraciones NAT, permitiendo la aceptaci贸n de comandos a trav茅s de puntos de control SOAP abiertos a pesar de las restricciones est谩ndar de la interfaz WAN. Herramientas como **Miranda** ayudan en el descubrimiento de servicios UPnP y la ejecuci贸n de comandos. **Umap** expone comandos UPnP accesibles desde WAN, mientras que repositorios como **upnp-arsenal** ofrecen una variedad de herramientas UPnP. **Evil SSDP** se especializa en phishing a trav茅s de dispositivos UPnP falsificados, albergando plantillas para imitar servicios leg铆timos.

## **Uso Pr谩ctico de Evil SSDP**

Evil SSDP crea efectivamente dispositivos UPnP falsos convincentes, manipulando a los usuarios para que interact煤en con servicios aparentemente aut茅nticos. Los usuarios, enga帽ados por la apariencia genuina, pueden proporcionar informaci贸n sensible como credenciales. La versatilidad de la herramienta se extiende a varias plantillas, imitando servicios como esc谩neres, Office365 e incluso b贸vedas de contrase帽as, capitalizando la confianza del usuario y la visibilidad de la red. Despu茅s de capturar credenciales, los atacantes pueden redirigir a las v铆ctimas a URL designadas, manteniendo la credibilidad del enga帽o.

## **Estrategias de Mitigaci贸n**

Para combatir estas amenazas, se recomiendan las siguientes medidas:

- Deshabilitar UPnP en dispositivos cuando no sea necesario.
- Educar a los usuarios sobre phishing y seguridad de la red.
- Monitorear el tr谩fico de la red en busca de datos sensibles no cifrados.

En esencia, aunque UPnP ofrece conveniencia y fluidez en la red, tambi茅n abre puertas a posibles explotaciones. La conciencia y la defensa proactiva son clave para garantizar la integridad de la red.

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Consulta los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
