# FalsificaÃ§Ã£o de Dispositivos SSDP e UPnP com EvilSSDP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Confira [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para mais informaÃ§Ãµes.**

## **VisÃ£o Geral de SSDP & UPnP**

O SSDP (Protocolo de Descoberta de ServiÃ§o Simples) Ã© utilizado para publicidade e descoberta de serviÃ§os de rede, operando na porta UDP 1900 sem a necessidade de configuraÃ§Ãµes DHCP ou DNS. Ã‰ fundamental na arquitetura UPnP (Plug and Play Universal), facilitando a interaÃ§Ã£o contÃ­nua entre dispositivos em rede como PCs, impressoras e dispositivos mÃ³veis. A rede de configuraÃ§Ã£o zero do UPnP suporta descoberta de dispositivos, atribuiÃ§Ã£o de endereÃ§os IP e publicidade de serviÃ§os.

## **Fluxo e Estrutura do UPnP**

A arquitetura UPnP Ã© composta por seis camadas: endereÃ§amento, descoberta, descriÃ§Ã£o, controle, eventos e apresentaÃ§Ã£o. Inicialmente, os dispositivos tentam obter um endereÃ§o IP ou atribuir um automaticamente (AutoIP). A fase de descoberta envolve o SSDP, com dispositivos enviando ativamente solicitaÃ§Ãµes M-SEARCH ou transmitindo passivamente mensagens NOTIFY para anunciar serviÃ§os. A camada de controle, vital para a interaÃ§Ã£o cliente-dispositivo, utiliza mensagens SOAP para execuÃ§Ã£o de comandos com base em descriÃ§Ãµes de dispositivos em arquivos XML.

## **VisÃ£o Geral de IGD e Ferramentas**

O IGD (Dispositivo de Gateway de Internet) facilita mapeamentos temporÃ¡rios de portas em configuraÃ§Ãµes NAT, permitindo a aceitaÃ§Ã£o de comandos via pontos de controle SOAP abertos apesar das restriÃ§Ãµes padrÃ£o da interface WAN. Ferramentas como **Miranda** auxiliam na descoberta de serviÃ§os UPnP e execuÃ§Ã£o de comandos. **Umap** expÃµe comandos UPnP acessÃ­veis pela WAN, enquanto repositÃ³rios como **upnp-arsenal** oferecem uma variedade de ferramentas UPnP. **Evil SSDP** se especializa em phishing por meio de dispositivos UPnP falsificados, hospedando modelos para imitar serviÃ§os legÃ­timos.

## **Uso PrÃ¡tico do Evil SSDP**

O Evil SSDP cria efetivamente dispositivos UPnP falsos convincentes, manipulando usuÃ¡rios para interagir com serviÃ§os aparentemente autÃªnticos. UsuÃ¡rios, enganados pela aparÃªncia genuÃ­na, podem fornecer informaÃ§Ãµes sensÃ­veis como credenciais. A versatilidade da ferramenta se estende a vÃ¡rios modelos, imitando serviÃ§os como scanners, Office365 e atÃ© cofres de senhas, capitalizando a confianÃ§a do usuÃ¡rio e a visibilidade da rede. ApÃ³s a captura de credenciais, os atacantes podem redirecionar as vÃ­timas para URLs designados, mantendo a credibilidade da decepÃ§Ã£o.

## **EstratÃ©gias de MitigaÃ§Ã£o**

Para combater essas ameaÃ§as, medidas recomendadas incluem:

- Desativar o UPnP em dispositivos quando nÃ£o necessÃ¡rio.
- Educar os usuÃ¡rios sobre phishing e seguranÃ§a de rede.
- Monitorar o trÃ¡fego de rede em busca de dados sensÃ­veis nÃ£o criptografados.

Em essÃªncia, enquanto o UPnP oferece conveniÃªncia e fluidez de rede, tambÃ©m abre portas para possÃ­veis exploraÃ§Ãµes. ConsciÃªncia e defesa proativa sÃ£o essenciais para garantir a integridade da rede.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
