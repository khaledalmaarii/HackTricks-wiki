# Spoofing SSDP und UPnP Ger√§te mit EvilSSDP

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

**√úberpr√ºfen Sie [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) f√ºr weitere Informationen.**

## **SSDP & UPnP √úbersicht**

SSDP (Simple Service Discovery Protocol) wird f√ºr die Werbung und Entdeckung von Netzwerkdiensten verwendet und arbeitet √ºber den UDP-Port 1900, ohne dass DHCP- oder DNS-Konfigurationen erforderlich sind. Es ist grundlegend in der UPnP (Universal Plug and Play) Architektur, die eine nahtlose Interaktion zwischen vernetzten Ger√§ten wie PCs, Druckern und mobilen Ger√§ten erm√∂glicht. UPnP's Zero-Configuration-Netzwerk unterst√ºtzt die Ger√§tesuche, IP-Adresszuweisung und Dienstwerbung.

## **UPnP Ablauf & Struktur**

Die UPnP-Architektur besteht aus sechs Schichten: Adressierung, Entdeckung, Beschreibung, Steuerung, Ereignisverarbeitung und Pr√§sentation. Zun√§chst versuchen Ger√§te, eine IP-Adresse zu erhalten oder eine selbst zuzuweisen (AutoIP). Die Entdeckungsphase umfasst das SSDP, wobei Ger√§te aktiv M-SEARCH-Anfragen senden oder passiv NOTIFY-Nachrichten senden, um Dienste anzuk√ºndigen. Die Steuerungsschicht, die f√ºr die Interaktion zwischen Client und Ger√§t entscheidend ist, nutzt SOAP-Nachrichten zur Ausf√ºhrung von Befehlen basierend auf Ger√§beschreibungen in XML-Dateien.

## **IGD & Tools √úbersicht**

IGD (Internet Gateway Device) erm√∂glicht tempor√§re Portzuweisungen in NAT-Setups und erlaubt die Annahme von Befehlen √ºber offene SOAP-Steuerpunkte, trotz der Einschr√§nkungen der Standard-WAN-Schnittstelle. Tools wie **Miranda** helfen bei der Entdeckung von UPnP-Diensten und der Ausf√ºhrung von Befehlen. **Umap** macht WAN-zug√§ngliche UPnP-Befehle sichtbar, w√§hrend Repositories wie **upnp-arsenal** eine Vielzahl von UPnP-Tools anbieten. **Evil SSDP** spezialisiert sich auf Phishing √ºber gef√§lschte UPnP-Ger√§te und hostet Vorlagen, um legitime Dienste zu imitieren.

## **Evil SSDP Praktische Nutzung**

Evil SSDP erstellt effektiv √ºberzeugende gef√§lschte UPnP-Ger√§te und manipuliert Benutzer, um mit scheinbar authentischen Diensten zu interagieren. Benutzer, die durch das echte Aussehen get√§uscht werden, k√∂nnten sensible Informationen wie Anmeldeinformationen bereitstellen. Die Vielseitigkeit des Tools erstreckt sich auf verschiedene Vorlagen, die Dienste wie Scanner, Office365 und sogar Passwortmanager nachahmen und das Vertrauen der Benutzer sowie die Sichtbarkeit im Netzwerk ausnutzen. Nach der Erfassung von Anmeldeinformationen k√∂nnen Angreifer die Opfer auf festgelegte URLs umleiten und die Glaubw√ºrdigkeit der T√§uschung aufrechterhalten.

## **Minderungsstrategien**

Um diesen Bedrohungen entgegenzuwirken, werden folgende Ma√ünahmen empfohlen:

- Deaktivieren Sie UPnP auf Ger√§ten, wenn es nicht ben√∂tigt wird.
- Schulen Sie Benutzer √ºber Phishing und Netzwerksicherheit.
- √úberwachen Sie den Netzwerkverkehr auf unverschl√ºsselte sensible Daten.

Im Wesentlichen bietet UPnP zwar Komfort und Netzwerkfluidit√§t, √∂ffnet jedoch auch T√ºren f√ºr potenzielle Ausbeutung. Bewusstsein und proaktive Verteidigung sind der Schl√ºssel zur Gew√§hrleistung der Netzwerkintegrit√§t.

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
