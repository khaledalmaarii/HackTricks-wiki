# Spoofing SSDP e dispositivi UPnP con EvilSSDP

{% hint style="success" %}
Impara e pratica il hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Impara e pratica il hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporta HackTricks</summary>

* Controlla i [**piani di abbonamento**](https://github.com/sponsors/carlospolop)!
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>
{% endhint %}

**Controlla [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) per ulteriori informazioni.**

## **Panoramica su SSDP e UPnP**

SSDP (Simple Service Discovery Protocol) √® utilizzato per la pubblicit√† e la scoperta dei servizi di rete, operando sulla porta UDP 1900 senza necessit√† di configurazioni DHCP o DNS. √à fondamentale nell'architettura UPnP (Universal Plug and Play), facilitando l'interazione senza soluzione di continuit√† tra dispositivi di rete come PC, stampanti e dispositivi mobili. La rete senza configurazione di UPnP supporta la scoperta dei dispositivi, l'assegnazione degli indirizzi IP e la pubblicit√† dei servizi.

## **Flusso e Struttura di UPnP**

L'architettura UPnP comprende sei livelli: indirizzamento, scoperta, descrizione, controllo, eventi e presentazione. Inizialmente, i dispositivi tentano di ottenere un indirizzo IP o di auto-assegnarne uno (AutoIP). La fase di scoperta coinvolge il SSDP, con i dispositivi che inviano attivamente richieste M-SEARCH o trasmettono passivamente messaggi NOTIFY per annunciare i servizi. Il livello di controllo, vitale per l'interazione client-dispositivo, sfrutta i messaggi SOAP per l'esecuzione dei comandi basati sulle descrizioni dei dispositivi nei file XML.

## **Panoramica su IGD e Strumenti**

IGD (Internet Gateway Device) facilita le mappature temporanee delle porte nelle configurazioni NAT, consentendo l'accettazione dei comandi tramite punti di controllo SOAP aperti nonostante le restrizioni standard dell'interfaccia WAN. Strumenti come **Miranda** aiutano nella scoperta dei servizi UPnP e nell'esecuzione dei comandi. **Umap** espone i comandi UPnP accessibili da WAN, mentre repository come **upnp-arsenal** offrono una gamma di strumenti UPnP. **Evil SSDP** si specializza nel phishing tramite dispositivi UPnP falsificati, ospitando modelli per imitare servizi legittimi.

## **Utilizzo Pratico di Evil SSDP**

Evil SSDP crea efficacemente dispositivi UPnP falsi convincenti, manipolando gli utenti a interagire con servizi apparentemente autentici. Gli utenti, ingannati dall'aspetto genuino, possono fornire informazioni sensibili come credenziali. La versatilit√† dello strumento si estende a vari modelli, mimando servizi come scanner, Office365 e persino vault di password, capitalizzando sulla fiducia degli utenti e sulla visibilit√† della rete. Dopo la cattura delle credenziali, gli attaccanti possono reindirizzare le vittime a URL designati, mantenendo la credibilit√† dell'inganno.

## **Strategie di Mitigazione**

Per combattere queste minacce, le misure raccomandate includono:

- Disabilitare UPnP sui dispositivi quando non necessario.
- Educare gli utenti riguardo al phishing e alla sicurezza della rete.
- Monitorare il traffico di rete per dati sensibili non crittografati.

In sostanza, mentre UPnP offre convenienza e fluidit√† di rete, apre anche porte a potenziali sfruttamenti. La consapevolezza e la difesa proattiva sono fondamentali per garantire l'integrit√† della rete.

{% hint style="success" %}
Impara e pratica il hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Impara e pratica il hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporta HackTricks</summary>

* Controlla i [**piani di abbonamento**](https://github.com/sponsors/carlospolop)!
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>
{% endhint %}
