# WebRTC DoS

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

**Ce probl√®me a √©t√© trouv√© dans cet article de blog :** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

La vuln√©rabilit√© d√©crite dans les serveurs multim√©dias WebRTC provient d'une **condition de concurrence** lors de l'initialisation des sessions multim√©dias, sp√©cifiquement entre la **v√©rification du consentement multim√©dia ICE** et l'**initiation du trafic DTLS**. Voici une analyse d√©taill√©e :

### Origine de la vuln√©rabilit√©

1. **Allocation de port UDP :** Lorsqu'un utilisateur initie un appel WebRTC, le serveur multim√©dia alloue des ports UDP pour g√©rer les flux multim√©dias, avec l'IP et le port communiqu√©s via la signalisation.
2. **Processus ICE et STUN :** Le navigateur de l'utilisateur utilise ICE pour la v√©rification du consentement multim√©dia, utilisant STUN pour d√©terminer le chemin de connexion vers le serveur multim√©dia.
3. **Session DTLS :** Apr√®s une v√©rification STUN r√©ussie, une session DTLS commence pour √©tablir des cl√©s ma√Ætresses SRTP, passant √† SRTP pour le flux multim√©dia.

### M√©canisme d'exploitation

* **Exploitation de la condition de concurrence :** Un attaquant peut exploiter une condition de concurrence en envoyant un message DTLS ClientHello avant l'utilisateur l√©gitime, utilisant potentiellement une suite de chiffrement invalide comme `TLS_NULL_WITH_NULL_NULL`. Cela provoque une erreur DTLS sur le serveur, emp√™chant l'√©tablissement de la session SRTP.

### Processus d'attaque

* **Analyse de port :** L'attaquant doit deviner quels ports UDP g√®rent les sessions multim√©dias entrantes, envoyant des messages ClientHello avec la suite de chiffrement nulle √† ces ports pour d√©clencher la vuln√©rabilit√©.
* **Diagramme de l'attaque :** La s√©quence implique plusieurs messages ClientHello envoy√©s par l'attaquant au serveur, entrecoup√©s de signalisation l√©gitime et de messages DTLS, entra√Ænant un √©chec de la poign√©e de main en raison de la suite de chiffrement erron√©e.

### Tests et att√©nuation

* **Tests s√ªrs :** En utilisant des outils comme Scapy, les attaquants rejouent des messages DTLS ClientHello ciblant des ports multim√©dias sp√©cifiques. Pour des tests √©thiques, des modifications de Chromium (par exemple, `JsepTransport::AddRemoteCandidates`) ont √©t√© utilis√©es pour imiter le comportement de la victime en toute s√©curit√©.
* **Mesures d'att√©nuation :** Les solutions impliquent de rejeter les paquets provenant d'adresses non v√©rifi√©es, comme mis en ≈ìuvre dans les versions plus r√©centes de biblioth√®ques comme libnice. La solution principale met l'accent sur la confiance dans le processus de v√©rification ICE et sur le traitement uniquement des paquets provenant de combinaisons IP et port valid√©es.

### Sc√©narios non vuln√©rables

* **Configurations de serveur DTLS :** Les cas o√π le navigateur agit en tant que serveur DTLS ou lorsque le serveur multim√©dia n'utilise pas de ports √©ph√©m√®res pour les sessions multim√©dias ne sont pas susceptibles √† cette vuln√©rabilit√©.

### Conclusion

Cette vuln√©rabilit√© met en √©vidence l'√©quilibre d√©licat dans les processus d'initialisation des sessions multim√©dias et la n√©cessit√© de m√©canismes de v√©rification et de synchronisation pr√©cis pour pr√©venir l'exploitation. Les d√©veloppeurs sont conseill√©s de mettre en ≈ìuvre les correctifs de s√©curit√© recommand√©s et de garantir des processus de v√©rification robustes pour att√©nuer de telles vuln√©rabilit√©s.

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
