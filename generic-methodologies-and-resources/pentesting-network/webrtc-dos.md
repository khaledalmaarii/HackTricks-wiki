# WebRTC DoS

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

**Ova ranjivost je prona캠ena u ovom blog postu:** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

Opisani problem u WebRTC medijskim serverima proiza코ao je iz **trke uslova** tokom inicijalizacije medijskih sesija, posebno izme캠u **ICE verifikacije medijskog pristanka** i **DTLS inicijacije saobra캖aja**. Evo detaljnog pregleda:

### Poreklo Ranjivosti

1. **Dodela UDP Portova:** Kada korisnik zapo캜ne WebRTC poziv, medijski server dodeljuje UDP portove za upravljanje medijskim tokovima, pri 캜emu se IP i port komuniciraju putem signalizacije.
2. **ICE i STUN Procesi:** Korisnikov pregleda캜 koristi ICE za verifikaciju medijskog pristanka, koriste캖i STUN za odre캠ivanje putanje veze do medijskog servera.
3. **DTLS Sesija:** Nakon uspe코ne STUN verifikacije, zapo캜inje DTLS sesija za uspostavljanje SRTP glavnih klju캜eva, prelaze캖i na SRTP za medijski tok.

### Mehanizam Eksploatacije

* **Eksploatacija Trke Uslova:** Napada캜 mo쬰 iskoristiti trku uslova slanjem DTLS ClientHello poruke pre legitimnog korisnika, potencijalno koriste캖i neva쬰캖i skup 코ifri kao 코to je `TLS_NULL_WITH_NULL_NULL`. Ovo uzrokuje DTLS gre코ku na serveru, spre캜avaju캖i uspostavljanje SRTP sesije.

### Proces Napada

* **Skener Portova:** Napada캜 treba da pogodi koji UDP portovi upravljaju dolaznim medijskim sesijama, 코alju캖i ClientHello poruke sa null skupom 코ifri na te portove kako bi aktivirao ranjivost.
* **Dijagram Napada:** Sekvenca uklju캜uje vi코e ClientHello poruka koje napada캜 코alje serveru, isprepletenih sa legitimnim signalizacijama i DTLS porukama, 코to dovodi do neuspeha rukovanja zbog pogre코nog skupa 코ifri.

### Testiranje i Ubla쬬vanje

* **Sigurno Testiranje:** Koriste캖i alate kao 코to je Scapy, napada캜i ponavljaju DTLS ClientHello poruke usmerene na specifi캜ne medijske portove. Za eti캜ko testiranje, kori코캖ene su modifikacije Chromium-a (npr. `JsepTransport::AddRemoteCandidates`) kako bi se bezbedno opona코alo pona코anje rtve.
* **Mere Ubla쬬vanja:** Re코enja uklju캜uju odbacivanje paketa sa neproverenih adresa, kao 코to je implementirano u novijim verzijama biblioteka poput libnice. Primarno re코enje nagla코ava poverenje u ICE verifikacijski proces i obradu paketa samo iz validiranih IP i port kombinacija.

### Scenariji Bez Ranjivosti

* **DTLS Server Konfiguracije:** Situacije u kojima pregleda캜 deluje kao DTLS server ili kada medijski server ne koristi ephemerne portove za medijske sesije nisu podlo쬹e ovoj ranjivosti.

### Zaklju캜ak

Ova ranjivost isti캜e delikatnu ravnote쬿 u procesima inicijalizacije medijskih sesija i potrebu za preciznim vremenom i mehanizmima verifikacije kako bi se spre캜ila eksploatacija. Programerima se savetuje da implementiraju preporu캜ene bezbednosne ispravke i osiguraju robusne procese verifikacije kako bi ubla쬴li ovakve ranjivosti.

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
