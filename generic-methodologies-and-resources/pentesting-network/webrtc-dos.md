# WebRTC DoS

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

**Bu sorun bu blog yazÄ±sÄ±nda bulundu:** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

WebRTC medya sunucularÄ±ndaki tanÄ±mlanan zafiyet, medya oturumlarÄ±nÄ±n baÅŸlatÄ±lmasÄ± sÄ±rasÄ±nda, Ã¶zellikle **ICE medya onay doÄŸrulamasÄ±** ile **DTLS trafik baÅŸlatma** arasÄ±nda bir **yarÄ±ÅŸ durumu** nedeniyle ortaya Ã§Ä±kmaktadÄ±r. Ä°ÅŸte detaylÄ± bir inceleme:

### Zafiyetin KaynaÄŸÄ±

1. **UDP Port Tahsisi:** Bir kullanÄ±cÄ± WebRTC aramasÄ± baÅŸlattÄ±ÄŸÄ±nda, medya sunucusu medya akÄ±ÅŸlarÄ±nÄ± yÃ¶netmek iÃ§in UDP portlarÄ± tahsis eder, IP ve port sinyalizasyon yoluyla iletilir.
2. **ICE ve STUN SÃ¼reÃ§leri:** KullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±, medya onay doÄŸrulamasÄ± iÃ§in ICE kullanÄ±r ve medya sunucusuna baÄŸlantÄ± yolunu belirlemek iÃ§in STUN kullanÄ±r.
3. **DTLS Oturumu:** BaÅŸarÄ±lÄ± STUN doÄŸrulamasÄ±nÄ±n ardÄ±ndan, SRTP anahtarlarÄ±nÄ± oluÅŸturmak iÃ§in bir DTLS oturumu baÅŸlar ve medya akÄ±ÅŸÄ± iÃ§in SRTP'ye geÃ§ilir.

### SÃ¶mÃ¼rÃ¼ MekanizmasÄ±

* **YarÄ±ÅŸ Durumu SÃ¶mÃ¼rÃ¼sÃ¼:** Bir saldÄ±rgan, meÅŸru kullanÄ±cÄ±dan Ã¶nce bir DTLS ClientHello mesajÄ± gÃ¶ndererek bir yarÄ±ÅŸ durumunu sÃ¶mÃ¼rebilir, potansiyel olarak `TLS_NULL_WITH_NULL_NULL` gibi geÃ§ersiz bir ÅŸifreleme kÃ¼mesi kullanarak. Bu, sunucuda bir DTLS hatasÄ±na neden olur ve SRTP oturumunun kurulmasÄ±nÄ± engeller.

### SaldÄ±rÄ± SÃ¼reci

* **Port TaramasÄ±:** SaldÄ±rgan, hangi UDP portlarÄ±nÄ±n gelen medya oturumlarÄ±nÄ± yÃ¶nettiÄŸini tahmin etmelidir, bu portlara null ÅŸifreleme kÃ¼mesi ile ClientHello mesajlarÄ± gÃ¶ndererek zafiyeti tetikler.
* **SaldÄ±rÄ± DiyagramÄ±:** SÄ±ralama, saldÄ±rgan tarafÄ±ndan sunucuya gÃ¶nderilen birden fazla ClientHello mesajÄ±nÄ±, meÅŸru sinyalizasyon ve DTLS mesajlarÄ± ile iÃ§ iÃ§e geÃ§irerek, hatalÄ± ÅŸifreleme kÃ¼mesi nedeniyle bir el sÄ±kÄ±ÅŸma hatasÄ±na yol aÃ§ar.

### Test ve Azaltma

* **GÃ¼venli Test:** SaldÄ±rganlar, belirli medya portlarÄ±nÄ± hedef alarak DTLS ClientHello mesajlarÄ±nÄ± tekrar oynatmak iÃ§in Scapy gibi araÃ§lar kullanÄ±r. Etik testler iÃ§in, kurban davranÄ±ÅŸÄ±nÄ± gÃ¼venli bir ÅŸekilde taklit etmek amacÄ±yla Chromium'da (Ã¶rneÄŸin, `JsepTransport::AddRemoteCandidates`) deÄŸiÅŸiklikler yapÄ±lmÄ±ÅŸtÄ±r.
* **Azaltma Ã–nlemleri:** Ã‡Ã¶zÃ¼mler, doÄŸrulanmamÄ±ÅŸ adreslerden gelen paketlerin dÃ¼ÅŸÃ¼rÃ¼lmesini iÃ§erir; bu, libnice gibi kÃ¼tÃ¼phanelerin daha yeni sÃ¼rÃ¼mlerinde uygulanmÄ±ÅŸtÄ±r. Temel Ã§Ã¶zÃ¼m, ICE doÄŸrulama sÃ¼recine gÃ¼venmeyi ve yalnÄ±zca doÄŸrulanmÄ±ÅŸ IP ve port kombinasyonlarÄ±ndan gelen paketleri iÅŸlemeyi vurgular.

### Zafiyetten Etkilenmeyen Senaryolar

* **DTLS Sunucu YapÄ±landÄ±rmalarÄ±:** TarayÄ±cÄ±nÄ±n bir DTLS sunucusu olarak davrandÄ±ÄŸÄ± veya medya sunucusunun medya oturumlarÄ± iÃ§in geÃ§ici portlar kullanmadÄ±ÄŸÄ± durumlar bu zafiyete karÅŸÄ± duyarsÄ±zdÄ±r.

### SonuÃ§

Bu zafiyet, medya oturumu baÅŸlatma sÃ¼reÃ§lerindeki hassas dengeyi ve sÃ¶mÃ¼rÃ¼yÃ¼ Ã¶nlemek iÃ§in kesin zamanlama ve doÄŸrulama mekanizmalarÄ±nÄ±n gerekliliÄŸini vurgulamaktadÄ±r. GeliÅŸtiricilerin Ã¶nerilen gÃ¼venlik dÃ¼zeltmelerini uygulamalarÄ± ve bu tÃ¼r zafiyetleri azaltmak iÃ§in saÄŸlam doÄŸrulama sÃ¼reÃ§lerini saÄŸlamalarÄ± tavsiye edilmektedir.

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
