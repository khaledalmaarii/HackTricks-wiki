# Zli blizanac EAP-TLS

{% hint style="success" %}
NauÄite i veÅ¾bajte hakovanje AWS-a:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks obuka AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
NauÄite i veÅ¾bajte hakovanje GCP-a: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks obuka GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

U jednom trenutku morao sam da koristim predloÅ¾eno reÅ¡enje iz posta ispod, ali koraci na [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) viÅ¡e nisu radili na modernom kali (2019v3).\
U svakom sluÄaju, lako je da ih prilagodite da rade.\
Samo trebate preuzeti hostapd-2.6 odavde: [https://w1.fi/releases/](https://w1.fi/releases/) i pre ponovnog kompajliranja hostapd-wpe instalirati: `apt-get install libssl1.0-dev`

### Analiza i iskoriÅ¡Ä‡avanje EAP-TLS u beÅ¾iÄnim mreÅ¾ama

#### Pozadina: EAP-TLS u beÅ¾iÄnim mreÅ¾ama
EAP-TLS je sigurnosni protokol koji omoguÄ‡ava meÄ‘usobnu autentikaciju izmeÄ‘u klijenta i servera koriÅ¡Ä‡enjem sertifikata. Veza se uspostavlja samo ako se klijent i server meÄ‘usobno autentiÄu putem svojih sertifikata.

#### Izazov koji je naiÅ¡ao
Tokom procene, naiÅ¡la je zanimljiva greÅ¡ka prilikom koriÅ¡Ä‡enja alata `hostapd-wpe`. Alat je odbio povezivanje klijenta zbog toga Å¡to je sertifikat klijenta potpisan od strane nepoznatog sertifikacionog tela (CA). To je ukazalo na to da klijent nije verovao laÅ¾nom serverovom sertifikatu, Å¡to ukazuje na nepaÅ¾ljive sigurnosne konfiguracije na strani klijenta.

#### Cilj: Postavljanje napada Äovek-u-sredini (MiTM)
Cilj je bio da se izmeni alat kako bi prihvatao bilo koji klijentski sertifikat. Ovo bi omoguÄ‡ilo uspostavljanje veze sa zlonamernom beÅ¾iÄnom mreÅ¾om i omoguÄ‡ilo napad Äovek-u-sredini, potencijalno hvatanje tekstualnih lozinki ili drugih osetljivih podataka.

#### ReÅ¡enje: Modifikacija `hostapd-wpe`
Analiza izvornog koda `hostapd-wpe` otkrila je da je validacija klijentskog sertifikata kontrolisana parametrom (`verify_peer`) u OpenSSL funkciji `SSL_set_verify`. Menjanjem vrednosti ovog parametra sa 1 (validacija) na 0 (ne validacija), alat je napravljen da prihvata bilo koji klijentski sertifikat.

#### IzvrÅ¡enje napada
1. **Provera okoline:** Koristite `airodump-ng` da pratite beÅ¾iÄne mreÅ¾e i identifikujete ciljeve.
2. **Postavljanje laÅ¾ne AP:** Pokrenite modifikovani `hostapd-wpe` da kreirate laÅ¾nu pristupnu taÄku (AP) imitirajuÄ‡i ciljnu mreÅ¾u.
3. **PrilagoÄ‘avanje zarobljeniÄkog portala:** Prilagodite stranicu za prijavu zarobljeniÄkog portala da izgleda legitimno i poznato ciljnom korisniku.
4. **Napad deautentikacije:** Opciono, izvedite napad deautentikacije da odvojite klijenta sa legitimne mreÅ¾e i poveÅ¾ete ga sa laÅ¾nom AP.
5. **Hvatanje lozinki:** Kada se klijent poveÅ¾e sa laÅ¾nom AP i interaguje sa zarobljeniÄkim portalom, njegove lozinke se hvataju.

#### Opservacije iz napada
- Na Windows maÅ¡inama, sistem moÅ¾e automatski da se poveÅ¾e sa laÅ¾nom AP, prikazujuÄ‡i zarobljeniÄki portal kada se pokuÅ¡a sa web navigacijom.
- Na iPhone-u, korisnik moÅ¾e biti zamoljen da prihvati novi sertifikat, a zatim mu se prikazuje zarobljeniÄki portal.

#### ZakljuÄak
Iako se EAP-TLS smatra sigurnim, njegova efikasnost u velikoj meri zavisi od ispravne konfiguracije i opreznog ponaÅ¡anja krajnjih korisnika. PogreÅ¡no konfigurisani ureÄ‘aji ili nesumnjivi korisnici koji prihvataju laÅ¾ne sertifikate mogu ugroziti sigurnost mreÅ¾e zaÅ¡tiÄ‡ene EAP-TLS-om.

Za viÅ¡e detalja pogledajte https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Reference
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
NauÄite & veÅ¾bajte hakovanje AWS-a:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks obuka AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
NauÄite & veÅ¾bajte hakovanje GCP-a: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks obuka GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
