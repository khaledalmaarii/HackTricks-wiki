# Zoliwy bli藕niak EAP-TLS

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Wskaz贸wka dotyczca bug bounty**: **Zapisz si** na platform **Intigriti**, premium **platform bug bounty stworzon przez haker贸w, dla haker贸w**! Docz do nas ju偶 dzi na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) i zacznij zarabia nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

W pewnym momencie potrzebowaem skorzysta z proponowanego rozwizania w poni偶szym pocie, ale kroki opisane w [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) nie dziaay ju偶 w nowoczesnym kali (2019v3).\
W ka偶dym razie, atwo jest je uruchomi.\
Wystarczy pobra hostapd-2.6 std: [https://w1.fi/releases/](https://w1.fi/releases/) i przed ponownym kompilowaniem hostapd-wpe zainstalowa: `apt-get install libssl1.0-dev`

### Analiza i wykorzystanie EAP-TLS w sieciach bezprzewodowych

#### To: EAP-TLS w sieciach bezprzewodowych
EAP-TLS to protok贸 bezpieczestwa zapewniajcy wzajemn autentykacj midzy klientem a serwerem za pomoc certyfikat贸w. Poczenie jest nawizywane tylko wtedy, gdy zar贸wno klient, jak i serwer autentykuj certyfikaty drugiej strony.

#### Napotkane wyzwanie
Podczas oceny napotkano interesujcy bd przy u偶yciu narzdzia `hostapd-wpe`. Narzdzie odrzucio poczenie klienta z powodu certyfikatu klienta podpisanego przez nieznanego dostawc certyfikat贸w (CA). Wskazywao to na to, 偶e klient ufa faszywemu certyfikatowi serwera, co wskazywao na lu藕ne konfiguracje zabezpiecze po stronie klienta.

#### Cel: Ustawienie ataku Man-in-the-Middle (MiTM)
Celem byo zmodyfikowanie narzdzia tak, aby akceptowao dowolny certyfikat klienta. Pozwolioby to na nawizanie poczenia z zoliw sieci bezprzewodow i umo偶liwio atak typu MiTM, potencjalnie przechwytujc poufne dane uwierzytelniajce lub inne wra偶liwe dane.

#### Rozwizanie: Modyfikacja `hostapd-wpe`
Analiza kodu 藕r贸dowego `hostapd-wpe` ujawnia, 偶e walidacja certyfikatu klienta bya kontrolowana przez parametr (`verify_peer`) w funkcji OpenSSL `SSL_set_verify`. Zmieniajc warto tego parametru z 1 (walidacja) na 0 (brak walidacji), narzdzie zostao zmuszone do akceptowania dowolnego certyfikatu klienta.

#### Wykonanie ataku
1. **Sprawdzenie rodowiska:** U偶yj `airodump-ng`, aby monitorowa sieci bezprzewodowe i zidentyfikowa cele.
2. **Utw贸rz faszywy punkt dostpowy (AP):** Uruchom zmodyfikowany `hostapd-wpe`, aby utworzy faszywy punkt dostpowy (AP) naladujcy docelow sie.
3. **Dostosowanie portalu przechwytujcego:** Dostosuj stron logowania portalu przechwytujcego, aby wygldaa legalnie i znajomo dla u偶ytkownika docelowego.
4. **Atak deautoryzacji:** Opcjonalnie przeprowad藕 atak deautoryzacji, aby odczy klienta od prawidowej sieci i podczy go do faszywego AP.
5. **Przechwytywanie danych uwierzytelniajcych:** Po podczeniu klienta do faszywego AP i interakcji z portalem przechwytujcym, przechwytywane s jego dane uwierzytelniajce.

#### Obserwacje z ataku
- Na komputerach z systemem Windows system mo偶e automatycznie czy si z faszywym AP, wywietlajc portal przechwytujcy przy pr贸bie nawigacji internetowej.
- Na iPhone'ach u偶ytkownik mo偶e zosta poproszony o zaakceptowanie nowego certyfikatu, a nastpnie wywietlony zostanie portal przechwytujcy.

#### Wnioski
Cho EAP-TLS uwa偶ane jest za bezpieczne, jego skuteczno w du偶ej mierze zale偶y od poprawnej konfiguracji i ostro偶nego zachowania u偶ytkownik贸w kocowych. Niewaciwie skonfigurowane urzdzenia lub niespodziewajcy si u偶ytkownicy akceptujcy faszywe certyfikaty mog podwa偶y bezpieczestwo sieci zabezpieczonej protokoem EAP-TLS.

Aby uzyska dalsze szczeg贸y, sprawd藕 https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Odwoania
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Wskaz贸wka dotyczca bug bounty**: **Zapisz si** na platform **Intigriti**, premium **platform bug bounty stworzon przez haker贸w, dla haker贸w**! Docz do nas ju偶 dzi na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) i zacznij zarabia nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**
