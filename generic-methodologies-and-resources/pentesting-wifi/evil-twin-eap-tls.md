# Zli blizanac EAP-TLS

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

U jednom trenutku sam morao da koristim predloÅ¾eno reÅ¡enje iz posta ispod, ali koraci u [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) viÅ¡e nisu radili u modernom kali (2019v3).\
U svakom sluÄaju, lako je da ih proradite.\
Samo trebate preuzeti hostapd-2.6 odavde: [https://w1.fi/releases/](https://w1.fi/releases/) i pre nego Å¡to ponovo kompajlirate hostapd-wpe instalirajte: `apt-get install libssl1.0-dev`

### Analiza i iskoriÅ¡Ä‡avanje EAP-TLS u beÅ¾iÄnim mreÅ¾ama

#### Pozadina: EAP-TLS u beÅ¾iÄnim mreÅ¾ama
EAP-TLS je sigurnosni protokol koji omoguÄ‡ava meÄ‘usobnu autentifikaciju izmeÄ‘u klijenta i servera koriÅ¡Ä‡enjem sertifikata. Veza se uspostavlja samo ako se klijent i server meÄ‘usobno autentifikuju putem svojih sertifikata.

#### NaiÄ‘eni izazov
Tokom procene, naiÄ‘ena je interesantna greÅ¡ka prilikom koriÅ¡Ä‡enja alata `hostapd-wpe`. Alat je odbio konekciju klijenta zbog toga Å¡to je klijentov sertifikat potpisan od strane nepoznatog Sertifikacionog Autoriteta (CA). To ukazuje na to da klijent veruje laÅ¾nom serverovom sertifikatu, Å¡to ukazuje na slabu konfiguraciju sigurnosti na strani klijenta.

#### Cilj: Postavljanje napada Äovek-u-sredini (MiTM)
Cilj je bio izmeniti alat tako da prihvati bilo koji klijentski sertifikat. To bi omoguÄ‡ilo uspostavljanje veze sa zlonamernom beÅ¾iÄnom mreÅ¾om i omoguÄ‡ilo napad Äovek-u-sredini, potencijalno hvatanje tekstualnih lozinki ili drugih osetljivih podataka.

#### ReÅ¡enje: Izmena `hostapd-wpe`
Analiza izvornog koda `hostapd-wpe` otkrila je da se validacija klijentskog sertifikata kontroliÅ¡e parametrom (`verify_peer`) u OpenSSL funkciji `SSL_set_verify`. Promenom vrednosti ovog parametra sa 1 (validacija) na 0 (ne validacija), alat je bio modifikovan da prihvati bilo koji klijentski sertifikat.

#### IzvrÅ¡enje napada
1. **Provera okruÅ¾enja:** Koristite `airodump-ng` da biste pratili beÅ¾iÄne mreÅ¾e i identifikovali ciljeve.
2. **Postavljanje laÅ¾ne AP:** Pokrenite modifikovani `hostapd-wpe` da biste kreirali laÅ¾nu pristupnu taÄku (AP) koja oponaÅ¡a ciljnu mreÅ¾u.
3. **PrilagoÄ‘avanje portala za zarobljavanje:** Prilagodite stranicu za prijavljivanje portala za zarobljavanje da izgleda legitimno i poznato ciljnom korisniku.
4. **De-autentifikacioni napad:** Opciono, izvedite de-autentifikacioni napad da biste prekinuli vezu klijenta sa legitimnom mreÅ¾om i povezali ga sa laÅ¾nom AP.
5. **Hvatanje lozinki:** Kada se klijent poveÅ¾e sa laÅ¾nom AP i interaguje sa portalom za zarobljavanje, njegove lozinke se hvataju.

#### Opservacije iz napada
- Na Windows maÅ¡inama, sistem moÅ¾e automatski da se poveÅ¾e sa laÅ¾nom AP, prikazujuÄ‡i portal za zarobljavanje prilikom pokuÅ¡aja web navigacije.
- Na iPhone-u, korisnik moÅ¾e biti upitan da prihvati novi sertifikat, a zatim mu se prikazuje portal za zarobljavanje.

#### ZakljuÄak
Iako se EAP-TLS smatra sigurnim, njegova efikasnost uveliko zavisi od ispravne konfiguracije i opreznog ponaÅ¡anja krajnjih korisnika. PogreÅ¡no konfigurisani ureÄ‘aji ili nesumnjivi korisnici koji prihvataju laÅ¾ne sertifikate mogu ugroziti sigurnost mreÅ¾e zaÅ¡tiÄ‡ene EAP-TLS protokolom.

Za dalje detalje pogledajte https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Reference
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
