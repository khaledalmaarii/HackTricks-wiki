# Zoliwy bli藕niak EAP-TLS

{% hint style="success" %}
Dowiedz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Dowiedz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wesprzyj HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na GitHubie.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Wskaz贸wka dotyczca nagrody za bd**: **Zarejestruj si** na platformie **Intigriti**, premiumowej platformie **nagr贸d za bdy stworzonej przez haker贸w, dla haker贸w**! Docz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) ju偶 dzi i zacznij zarabia nagrody do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

W pewnym momencie musiaem skorzysta z proponowanego rozwizania przez poni偶szy post, ale kroki w [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) nie dziaay ju偶 w nowoczesnym kali (2019v3).\
W ka偶dym razie, atwo je byo uruchomi.\
Wystarczy pobra hostapd-2.6 std: [https://w1.fi/releases/](https://w1.fi/releases) i przed ponownym kompilowaniem hostapd-wpe zainstalowa: `apt-get install libssl1.0-dev`

### Analiza i Wykorzystanie EAP-TLS w Sieciach Bezprzewodowych

#### To: EAP-TLS w Sieciach Bezprzewodowych
EAP-TLS to protok贸 bezpieczestwa zapewniajcy wzajemn autentykacj midzy klientem a serwerem za pomoc certyfikat贸w. Poczenie jest nawizywane tylko wtedy, gdy zar贸wno klient, jak i serwer autentykuj certyfikaty drugiej strony.

#### Napotkane Wyzwanie
Podczas oceny napotkano interesujcy bd podczas korzystania z narzdzia `hostapd-wpe`. Narzdzie odrzucio poczenie klienta z powodu certyfikatu klienta podpisanego przez nieznanego dostawc certyfikat贸w (CA). Wskazywao to, 偶e klient nie ufa certyfikatowi faszywego serwera, co wskazywao na lu藕ne konfiguracje bezpieczestwa po stronie klienta.

#### Cel: Ustawienie Ataku Czowiek w rodku (MiTM)
Celem byo zmodyfikowanie narzdzia tak, aby akceptowao dowolny certyfikat klienta. Pozwolioby to na nawizanie poczenia z zoliw sieci bezprzewodow i umo偶liwio atak typu MiTM, potencjalnie przechwytujc dane w postaci zwykego tekstu lub inne wra偶liwe informacje.

#### Rozwizanie: Modyfikacja `hostapd-wpe`
Analiza kodu 藕r贸dowego `hostapd-wpe` ujawnia, 偶e walidacja certyfikatu klienta bya kontrolowana przez parametr (`verify_peer`) w funkcji OpenSSL `SSL_set_verify`. Zmieniajc warto tego parametru z 1 (walidacja) na 0 (brak walidacji), narzdzie zostao zmuszone do akceptowania dowolnego certyfikatu klienta.

#### Wykonanie Ataku
1. **Sprawdzenie rodowiska:** U偶yj `airodump-ng` do monitorowania sieci bezprzewodowych i identyfikacji cel贸w.
2. **Utw贸rz Faszywy AP:** Uruchom zmodyfikowany `hostapd-wpe`, aby stworzy faszywy punkt dostpu (AP) imitujcy sie docelow.
3. **Dostosowanie Portalu Przechwytywania:** Dostosuj stron logowania portalu przechwytywania, aby wygldaa legitnie i znajomo dla u偶ytkownika docelowego.
4. **Atak Deautentykacji:** Opcjonalnie, przeprowad藕 atak deautentykacji, aby odczy klienta od prawidowej sieci i poczy go z faszywym AP.
5. **Przechwytywanie Powiadcze:** Gdy klient poczy si z faszywym AP i bdzie dziaa z portalem przechwytywania, ich powiadczenia zostan przechwycone.

#### Obserwacje z Ataku
- Na maszynach z systemem Windows system mo偶e automatycznie poczy si z faszywym AP, prezentujc portal przechwytywania podczas pr贸by nawigacji internetowej.
- Na iPhone'ach u偶ytkownik mo偶e zosta poproszony o zaakceptowanie nowego certyfikatu, a nastpnie prezentowany z portalem przechwytywania.

#### Podsumowanie
Mimo 偶e EAP-TLS jest uwa偶any za bezpieczny, jego skuteczno w du偶ej mierze zale偶y od poprawnej konfiguracji i ostro偶nego zachowania u偶ytkownik贸w kocowych. Niewaciwie skonfigurowane urzdzenia lub naiwni u偶ytkownicy akceptujcy faszywe certyfikaty mog podwa偶y bezpieczestwo sieci zabezpieczonej EAP-TLS.

Dla dalszych szczeg贸贸w sprawd藕 https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Referencje
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Wskaz贸wka dotyczca nagrody za bd**: **Zarejestruj si** na platformie **Intigriti**, premiumowej platformie **nagr贸d za bdy stworzonej przez haker贸w, dla haker贸w**! Docz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) ju偶 dzi i zacznij zarabia nagrody do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Dowiedz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Dowiedz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wesprzyj HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na GitHubie.

</details>
{% endhint %}
