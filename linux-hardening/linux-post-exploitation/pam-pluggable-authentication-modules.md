# PAM - M贸dulos de Autenticaci贸n Pluggable

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


### Informaci贸n B谩sica

**PAM (M贸dulos de Autenticaci贸n Pluggable)** act煤a como un mecanismo de seguridad que **verifica la identidad de los usuarios que intentan acceder a los servicios inform谩ticos**, controlando su acceso en funci贸n de varios criterios. Es similar a un portero digital, asegurando que solo los usuarios autorizados puedan interactuar con servicios espec铆ficos mientras limita potencialmente su uso para prevenir sobrecargas del sistema.

#### Archivos de Configuraci贸n

* **Los sistemas Solaris y basados en UNIX** suelen utilizar un archivo de configuraci贸n central ubicado en `/etc/pam.conf`.
* **Los sistemas Linux** prefieren un enfoque de directorio, almacenando configuraciones espec铆ficas de servicios dentro de `/etc/pam.d`. Por ejemplo, el archivo de configuraci贸n para el servicio de inicio de sesi贸n se encuentra en `/etc/pam.d/login`.

Un ejemplo de una configuraci贸n de PAM para el servicio de inicio de sesi贸n podr铆a verse as铆:
```
auth required /lib/security/pam_securetty.so
auth required /lib/security/pam_nologin.so
auth sufficient /lib/security/pam_ldap.so
auth required /lib/security/pam_unix_auth.so try_first_pass
account sufficient /lib/security/pam_ldap.so
account required /lib/security/pam_unix_acct.so
password required /lib/security/pam_cracklib.so
password required /lib/security/pam_ldap.so
password required /lib/security/pam_pwdb.so use_first_pass
session required /lib/security/pam_unix_session.so
```
#### **Reinos de Gesti贸n de PAM**

Estos reinos, o grupos de gesti贸n, incluyen **auth**, **account**, **password** y **session**, cada uno responsable de diferentes aspectos del proceso de autenticaci贸n y gesti贸n de sesiones:

* **Auth**: Valida la identidad del usuario, a menudo solicitando una contrase帽a.
* **Account**: Maneja la verificaci贸n de cuentas, comprobando condiciones como la membres铆a en grupos o restricciones de horario.
* **Password**: Gestiona las actualizaciones de contrase帽as, incluyendo verificaciones de complejidad o prevenci贸n de ataques de diccionario.
* **Session**: Gestiona acciones durante el inicio o final de una sesi贸n de servicio, como montar directorios o establecer l铆mites de recursos.

#### **Controles de M贸dulo PAM**

Los controles dictan la respuesta del m贸dulo ante el 茅xito o el fracaso, influyendo en el proceso de autenticaci贸n general. Estos incluyen:

* **Required**: El fallo de un m贸dulo requerido resulta en un eventual fracaso, pero solo despu茅s de que se verifiquen todos los m贸dulos subsiguientes.
* **Requisite**: Terminaci贸n inmediata del proceso al fallar.
* **Sufficient**: El 茅xito omite el resto de las verificaciones del mismo reino a menos que un m贸dulo subsiguiente falle.
* **Optional**: Solo causa fallo si es el 煤nico m贸dulo en la pila.

#### Escenario de Ejemplo

En una configuraci贸n con m煤ltiples m贸dulos de auth, el proceso sigue un orden estricto. Si el m贸dulo `pam_securetty` encuentra el terminal de inicio de sesi贸n no autorizado, los inicios de sesi贸n de root son bloqueados, sin embargo, todos los m贸dulos a煤n se procesan debido a su estado de "required". El `pam_env` establece variables de entorno, potencialmente ayudando en la experiencia del usuario. Los m贸dulos `pam_ldap` y `pam_unix` trabajan juntos para autenticar al usuario, con `pam_unix` intentando usar una contrase帽a previamente suministrada, mejorando la eficiencia y flexibilidad en los m茅todos de autenticaci贸n.

### Referencias

* [https://hotpotato.tistory.com/434](https://hotpotato.tistory.com/434)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
