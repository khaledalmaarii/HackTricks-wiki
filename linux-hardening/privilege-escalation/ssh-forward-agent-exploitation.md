{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
{% endhint %}
{% endhint %}


# Podsumowanie

Co moÅ¼esz zrobiÄ‡, jeÅ›li odkryjesz w pliku `/etc/ssh_config` lub w `$HOME/.ssh/config` takÄ… konfiguracjÄ™:
```
ForwardAgent yes
```
JeÅ›li jesteÅ› rootem na maszynie, prawdopodobnie moÅ¼esz **uzyskaÄ‡ dostÄ™p do dowolnego poÅ‚Ä…czenia ssh nawiÄ…zanego przez dowolnego agenta**, ktÃ³rego moÅ¼esz znaleÅºÄ‡ w katalogu _/tmp_

Podrobienie Boba przy uÅ¼yciu jednego z agentÃ³w ssh Boba:
```bash
SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston
```
## Dlaczego to dziaÅ‚a?

Gdy ustawiasz zmiennÄ… `SSH_AUTH_SOCK`, uzyskujesz dostÄ™p do kluczy Boba, ktÃ³re byÅ‚y uÅ¼ywane w poÅ‚Ä…czeniu ssh Boba. JeÅ›li jego klucz prywatny nadal tam jest (zwykle tak bÄ™dzie), bÄ™dziesz mÃ³gÅ‚ uzyskaÄ‡ dostÄ™p do dowolnego hosta, uÅ¼ywajÄ…c go.

PoniewaÅ¼ klucz prywatny jest przechowywany w pamiÄ™ci agenta w postaci niezaszyfrowanej, zakÅ‚adam, Å¼e jeÅ›li jesteÅ› Bobem, ale nie znasz hasÅ‚a do klucza prywatnego, nadal moÅ¼esz uzyskaÄ‡ dostÄ™p do agenta i go uÅ¼yÄ‡.

InnÄ… opcjÄ… jest to, Å¼e uÅ¼ytkownik bÄ™dÄ…cy wÅ‚aÅ›cicielem agenta oraz root mogÄ… uzyskaÄ‡ dostÄ™p do pamiÄ™ci agenta i wyodrÄ™bniÄ‡ klucz prywatny.

# DÅ‚ugie wyjaÅ›nienie i eksploatacja

**SprawdÅº [oryginalne badania tutaj](https://www.clockwork.com/insights/ssh-agent-hijacking/)**
{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w na githubie.

</details>
{% endhint %}
</details>
{% endhint %}
</details>
{% endhint %}
