# macOS í”„ë¡œì„¸ìŠ¤ ë‚¨ìš©

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PDFë¡œ HackTricks ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [ë””ìŠ¤ì½”ë“œ ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## macOS í”„ë¡œì„¸ìŠ¤ ë‚¨ìš©

ë§¥OSëŠ” ë‹¤ë¥¸ ìš´ì˜ ì²´ì œì™€ ë§ˆì°¬ê°€ì§€ë¡œ **í”„ë¡œì„¸ìŠ¤ê°€ ìƒí˜¸ ì‘ìš©í•˜ê³  í†µì‹ í•˜ë©° ë°ì´í„°ë¥¼ ê³µìœ í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ê³¼ ë©”ì»¤ë‹ˆì¦˜**ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê¸°ìˆ ì€ íš¨ìœ¨ì ì¸ ì‹œìŠ¤í…œ ì‘ë™ì— í•„ìˆ˜ì ì´ì§€ë§Œ, ìœ„í˜‘ ìš”ì†Œë“¤ì´ **ì•…ì˜ì ì¸ í™œë™ì„ ìˆ˜í–‰**í•˜ëŠ” ë° ë‚¨ìš©ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ì£¼ì…

ë¼ì´ë¸ŒëŸ¬ë¦¬ ì£¼ì…ì€ ê³µê²©ìê°€ **í”„ë¡œì„¸ìŠ¤ì— ì•…ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ë„ë¡ ê°•ì œí•˜ëŠ” ê¸°ìˆ **ì…ë‹ˆë‹¤. ì£¼ì…ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ëŒ€ìƒ í”„ë¡œì„¸ìŠ¤ì˜ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ë˜ì–´ ê³µê²©ìì—ê²Œ í”„ë¡œì„¸ìŠ¤ì™€ ë™ì¼í•œ ê¶Œí•œê³¼ ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

{% content-ref url="macos-library-injection/" %}
[macos-library-injection](macos-library-injection/)
{% endcontent-ref %}

### í•¨ìˆ˜ í›„í‚¹

í•¨ìˆ˜ í›„í‚¹ì€ ì†Œí”„íŠ¸ì›¨ì–´ ì½”ë“œ ë‚´ì—ì„œ **í•¨ìˆ˜ í˜¸ì¶œì´ë‚˜ ë©”ì‹œì§€ë¥¼ ê°€ë¡œì±„ëŠ”** ê¸°ìˆ ì…ë‹ˆë‹¤. í•¨ìˆ˜ í›„í‚¹ì„ í†µí•´ ê³µê²©ìëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ë™ì‘ì„ **ìˆ˜ì •í•˜ê±°ë‚˜ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ê´€ì°°í•˜ê±°ë‚˜ ì‹¤í–‰ íë¦„ì„ ì œì–´**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% content-ref url="../mac-os-architecture/macos-function-hooking.md" %}
[macos-function-hooking.md](../mac-os-architecture/macos-function-hooking.md)
{% endcontent-ref %}

### í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ 

í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹  (IPC)ì€ ë³„ë„ì˜ í”„ë¡œì„¸ìŠ¤ê°€ **ë°ì´í„°ë¥¼ ê³µìœ í•˜ê³  êµí™˜í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•**ì„ ê°€ë¦¬í‚µë‹ˆë‹¤. IPCëŠ” ë§ì€ í•©ë²•ì ì¸ ì‘ìš© í”„ë¡œê·¸ë¨ì— í•„ìˆ˜ì ì´ì§€ë§Œ, í”„ë¡œì„¸ìŠ¤ ê²©ë¦¬ë¥¼ ë¬´ë ¥í™”í•˜ê±°ë‚˜ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìœ ì¶œí•˜ê±°ë‚˜ ë¬´ë‹¨ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆë„ë¡ ë‚¨ìš©ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

{% content-ref url="../mac-os-architecture/macos-ipc-inter-process-communication/" %}
[macos-ipc-inter-process-communication](../mac-os-architecture/macos-ipc-inter-process-communication/)
{% endcontent-ref %}

### ì¼ë ‰íŠ¸ë¡  ì• í”Œë¦¬ì¼€ì´ì…˜ ì£¼ì…

íŠ¹ì • í™˜ê²½ ë³€ìˆ˜ë¡œ ì‹¤í–‰ëœ ì¼ë ‰íŠ¸ë¡  ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í”„ë¡œì„¸ìŠ¤ ì£¼ì…ì— ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="macos-electron-applications-injection.md" %}
[macos-electron-applications-injection.md](macos-electron-applications-injection.md)
{% endcontent-ref %}

### í¬ë¡œë¯¸ì›€ ì£¼ì…

`--load-extension` ë° `--use-fake-ui-for-media-stream` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ **ë¸Œë¼ìš°ì € ì¤‘ê°„ì ê³µê²©**ì„ ìˆ˜í–‰í•˜ì—¬ í‚¤ ì…ë ¥, íŠ¸ë˜í”½, ì¿ í‚¤ë¥¼ ë„ìš©í•˜ê±°ë‚˜ í˜ì´ì§€ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="macos-chromium-injection.md" %}
[macos-chromium-injection.md](macos-chromium-injection.md)
{% endcontent-ref %}

### ë”ëŸ¬ìš´ NIB

NIB íŒŒì¼ì€ ì‘ìš© í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ **ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (UI) ìš”ì†Œì™€ ìƒí˜¸ ì‘ìš©ì„ ì •ì˜**í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ NIB íŒŒì¼ì€ **ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰**í•  ìˆ˜ ìˆìœ¼ë©° **ê²Œì´íŠ¸í‚¤í¼ëŠ”** NIB íŒŒì¼ì´ ìˆ˜ì •ë˜ë©´ ì´ë¯¸ ì‹¤í–‰ëœ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë‹¤ì‹œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë§‰ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì„ì˜ì˜ í”„ë¡œê·¸ë¨ì´ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë„ë¡ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="macos-dirty-nib.md" %}
[macos-dirty-nib.md](macos-dirty-nib.md)
{% endcontent-ref %}

### ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ ì£¼ì…

ì¼ë¶€ ìë°” ê¸°ëŠ¥(ì˜ˆ: **`_JAVA_OPTS`** í™˜ê²½ ë³€ìˆ˜)ì„ ë‚¨ìš©í•˜ì—¬ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ **ì„ì˜ì˜ ì½”ë“œ/ëª…ë ¹ì„ ì‹¤í–‰**í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% content-ref url="macos-java-apps-injection.md" %}
[macos-java-apps-injection.md](macos-java-apps-injection.md)
{% endcontent-ref %}

### .Net ì• í”Œë¦¬ì¼€ì´ì…˜ ì£¼ì…

.Net ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì½”ë“œë¥¼ ì£¼ì…í•˜ëŠ” ê²ƒì€ **.Net ë””ë²„ê¹… ê¸°ëŠ¥ì„ ë‚¨ìš©**í•˜ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤(ëŸ°íƒ€ì„ ê°•í™”ì™€ ê°™ì€ macOS ë³´í˜¸ ê¸°ëŠ¥ìœ¼ë¡œ ë³´í˜¸ë˜ì§€ ì•ŠìŒ).

{% content-ref url="macos-.net-applications-injection.md" %}
[macos-.net-applications-injection.md](macos-.net-applications-injection.md)
{% endcontent-ref %}

### í„ ì£¼ì…

í„ ìŠ¤í¬ë¦½íŠ¸ê°€ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ ë§Œë“œëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="macos-perl-applications-injection.md" %}
[macos-perl-applications-injection.md](macos-perl-applications-injection.md)
{% endcontent-ref %}

### ë£¨ë¹„ ì£¼ì…

ë£¨ë¹„ í™˜ê²½ ë³€ìˆ˜ë¥¼ ë‚¨ìš©í•˜ì—¬ ì„ì˜ì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="macos-ruby-applications-injection.md" %}
[macos-ruby-applications-injection.md](macos-ruby-applications-injection.md)
{% endcontent-ref %}

### íŒŒì´ì¬ ì£¼ì…

í™˜ê²½ ë³€ìˆ˜ **`PYTHONINSPECT`**ê°€ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ íŒŒì´ì¬ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë˜ë©´ íŒŒì´ì¬ CLIë¡œ ì´ë™í•©ë‹ˆë‹¤. ëŒ€í™”í˜• ì„¸ì…˜ì˜ ì‹œì‘ ì‹œ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë„ë¡ **`PYTHONSTARTUP`**ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ **`PYTHONSTARTUP`** ìŠ¤í¬ë¦½íŠ¸ëŠ” **`PYTHONINSPECT`**ê°€ ëŒ€í™”í˜• ì„¸ì…˜ì„ ìƒì„±í•  ë•Œ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**`PYTHONPATH`** ë° **`PYTHONHOME`**ê³¼ ê°™ì€ ë‹¤ë¥¸ í™˜ê²½ ë³€ìˆ˜ë„ íŒŒì´ì¬ ëª…ë ¹ì´ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•˜ëŠ” ë° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**`pyinstaller`**ë¡œ ì»´íŒŒì¼ëœ ì‹¤í–‰ íŒŒì¼ì€ ë‚´ì¥ëœ íŒŒì´ì¬ì„ ì‚¬ìš©í•˜ë”ë¼ë„ ì´ëŸ¬í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

{% hint style="danger" %}
ì „ë°˜ì ìœ¼ë¡œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ë‚¨ìš©í•˜ì—¬ íŒŒì´ì¬ì´ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒë“¤ì€ **Hombrew**ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì´ì¬ì„ ì„¤ì¹˜í•˜ë¯€ë¡œ ê¸°ë³¸ ê´€ë¦¬ì ì‚¬ìš©ìë¥¼ ìœ„í•œ **ì“°ê¸° ê°€ëŠ¥í•œ ìœ„ì¹˜**ì— íŒŒì´ì¬ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì´ë¥¼ íƒˆì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
mv /opt/homebrew/bin/python3 /opt/homebrew/bin/python3.old
cat > /opt/homebrew/bin/python3 <<EOF
#!/bin/bash
# Extra hijack code
/opt/homebrew/bin/python3.old "$@"
EOF
chmod +x /opt/homebrew/bin/python3
```
## íƒì§€

### Shield

[**Shield**](https://theevilbit.github.io/shield/) ([**Github**](https://github.com/theevilbit/Shield))ì€ ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œì„¸ìŠ¤ ì£¼ì… ì‘ì—…ì„ **íƒì§€í•˜ê³  ì°¨ë‹¨**í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤:

* **í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©**: **`DYLD_INSERT_LIBRARIES`**, **`CFNETWORK_LIBRARY_PATH`**, **`RAWCAMERA_BUNDLE_PATH`**, **`ELECTRON_RUN_AS_NODE`** í™˜ê²½ ë³€ìˆ˜ì˜ ì¡´ì¬ë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.
* **`task_for_pid`** í˜¸ì¶œ ì‚¬ìš©: í•œ í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì˜ **ì‘ì—… í¬íŠ¸ë¥¼ ê°€ì ¸ì˜¤ë ¤ê³  í•  ë•Œ** ì½”ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
* **Electron ì•± ë§¤ê°œë³€ìˆ˜**: ëˆ„êµ°ê°€ëŠ” **`--inspect`**, **`--inspect-brk`**, **`--remote-debugging-port`** ëª…ë ¹í–‰ ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Electron ì•±ì„ ë””ë²„ê¹… ëª¨ë“œë¡œ ì‹œì‘í•˜ê³  ì´ì— ì½”ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ì‹¬ë³¼ë¦­ ë§í¬** ë˜ëŠ” **í•˜ë“œ ë§í¬** ì‚¬ìš©: ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ í”í•œ ë‚¨ìš©ì€ **ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ ë§í¬ë¥¼ ë§Œë“¤ê³ **, **ë³´ë‹¤ ë†’ì€ ê¶Œí•œ** ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í•˜ë“œ ë§í¬ì™€ ì‹¬ë³¼ë¦­ ë§í¬ ëª¨ë‘ì— ëŒ€í•œ ê°ì§€ëŠ” ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. ë§í¬ë¥¼ ë§Œë“œëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ëŒ€ìƒ íŒŒì¼ë³´ë‹¤ **ë‹¤ë¥¸ ê¶Œí•œ ìˆ˜ì¤€**ì„ ê°€ì§€ê³  ìˆìœ¼ë©´ **ê²½ê³ **ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë¶ˆí–‰íˆë„ ì‹¬ë³¼ë¦­ ë§í¬ì˜ ê²½ìš° ì°¨ë‹¨ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë§í¬ì˜ ëŒ€ìƒì— ëŒ€í•œ ì •ë³´ë¥¼ ì‚¬ì „ì— ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì´ëŠ” Appleì˜ EndpointSecuriy í”„ë ˆì„ì›Œí¬ì˜ ì œí•œì…ë‹ˆë‹¤.

### ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ì˜í•œ í˜¸ì¶œ

[**ì´ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼**](https://knight.sc/reverse%20engineering/2019/04/15/detecting-task-modifications.html)ì—ì„œëŠ” **`task_name_for_pid`** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ **í”„ë¡œì„¸ìŠ¤ê°€ í”„ë¡œì„¸ìŠ¤ì— ì½”ë“œë¥¼ ì£¼ì…**í•˜ëŠ” ê²ƒì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ê³  ê·¸ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ëŠ” ì‚¬ìš©ìì™€ **ë™ì¼í•œ uid**ì´ê±°ë‚˜ **root** ì—¬ì•¼ í•©ë‹ˆë‹¤ (ê·¸ë¦¬ê³  ì´ëŠ” í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°˜í™˜í•˜ë©° ì½”ë“œë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•ì€ ì•„ë‹™ë‹ˆë‹¤).

## ì°¸ê³  ìë£Œ

* [https://theevilbit.github.io/shield/](https://theevilbit.github.io/shield/)
* [https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f)
