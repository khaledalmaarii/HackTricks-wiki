# macOSè¿›ç¨‹æ»¥ç”¨

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## MacOSè¿›ç¨‹æ»¥ç”¨

ä¸ä»»ä½•å…¶ä»–æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒMacOSæä¾›äº†å„ç§æ–¹æ³•å’Œæœºåˆ¶ï¼Œç”¨äºè¿›ç¨‹ä¹‹é—´çš„**äº¤äº’ã€é€šä¿¡å’Œå…±äº«æ•°æ®**ã€‚è™½ç„¶è¿™äº›æŠ€æœ¯å¯¹äºç³»ç»Ÿçš„é«˜æ•ˆè¿è¡Œè‡³å…³é‡è¦ï¼Œä½†é»‘å®¢ä¹Ÿå¯ä»¥æ»¥ç”¨è¿™äº›æŠ€æœ¯æ¥**æ‰§è¡Œæ¶æ„æ´»åŠ¨**ã€‚

### åº“æ³¨å…¥

åº“æ³¨å…¥æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡å®ƒ**å¼ºåˆ¶ä¸€ä¸ªè¿›ç¨‹åŠ è½½æ¶æ„åº“**ã€‚ä¸€æ—¦æ³¨å…¥ï¼Œè¯¥åº“åœ¨ç›®æ ‡è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œä¸ºæ”»å‡»è€…æä¾›ä¸è¿›ç¨‹ç›¸åŒçš„æƒé™å’Œè®¿é—®æƒé™ã€‚

{% content-ref url="macos-library-injection/" %}
[macos-library-injection](macos-library-injection/)
{% endcontent-ref %}

### å‡½æ•°æŒ‚é’©

å‡½æ•°æŒ‚é’©æ¶‰åŠ**æ‹¦æˆªè½¯ä»¶ä»£ç ä¸­çš„å‡½æ•°è°ƒç”¨**æˆ–æ¶ˆæ¯ã€‚é€šè¿‡æŒ‚é’©å‡½æ•°ï¼Œæ”»å‡»è€…å¯ä»¥**ä¿®æ”¹è¿›ç¨‹çš„è¡Œä¸º**ï¼Œè§‚å¯Ÿæ•æ„Ÿæ•°æ®ï¼Œç”šè‡³æ§åˆ¶æ‰§è¡Œæµç¨‹ã€‚

{% content-ref url="../mac-os-architecture/macos-function-hooking.md" %}
[macos-function-hooking.md](../mac-os-architecture/macos-function-hooking.md)
{% endcontent-ref %}

### è¿›ç¨‹é—´é€šä¿¡

è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ˜¯æŒ‡ä¸åŒè¿›ç¨‹ä¹‹é—´**å…±äº«å’Œäº¤æ¢æ•°æ®**çš„ä¸åŒæ–¹æ³•ã€‚è™½ç„¶IPCå¯¹äºè®¸å¤šåˆæ³•åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ï¼Œä½†å®ƒä¹Ÿå¯ä»¥è¢«æ»¥ç”¨ä»¥ç ´åè¿›ç¨‹éš”ç¦»ã€æ³„éœ²æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

{% content-ref url="../mac-os-architecture/macos-ipc-inter-process-communication/" %}
[macos-ipc-inter-process-communication](../mac-os-architecture/macos-ipc-inter-process-communication/)
{% endcontent-ref %}

### Electronåº”ç”¨ç¨‹åºæ³¨å…¥

ä½¿ç”¨ç‰¹å®šçš„ç¯å¢ƒå˜é‡æ‰§è¡Œçš„Electronåº”ç”¨ç¨‹åºå¯èƒ½å®¹æ˜“å—åˆ°è¿›ç¨‹æ³¨å…¥çš„æ”»å‡»ï¼š

{% content-ref url="macos-electron-applications-injection.md" %}
[macos-electron-applications-injection.md](macos-electron-applications-injection.md)
{% endcontent-ref %}

### Dirty NIB

NIBæ–‡ä»¶**å®šä¹‰åº”ç”¨ç¨‹åºä¸­çš„ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰å…ƒç´ åŠå…¶äº¤äº’**ã€‚ç„¶è€Œï¼Œå®ƒä»¬å¯ä»¥**æ‰§è¡Œä»»æ„å‘½ä»¤**ï¼Œå¹¶ä¸”å¦‚æœä¿®æ”¹äº†NIBæ–‡ä»¶ï¼ŒGatekeeperä¸ä¼šé˜»æ­¢å·²ç»æ‰§è¡Œçš„åº”ç”¨ç¨‹åºå†æ¬¡æ‰§è¡Œã€‚å› æ­¤ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥ä½¿ä»»æ„ç¨‹åºæ‰§è¡Œä»»æ„å‘½ä»¤ï¼š

{% content-ref url="macos-dirty-nib.md" %}
[macos-dirty-nib.md](macos-dirty-nib.md)
{% endcontent-ref %}

### Javaåº”ç”¨ç¨‹åºæ³¨å…¥

å¯ä»¥æ»¥ç”¨æŸäº›JavaåŠŸèƒ½ï¼ˆå¦‚**`_JAVA_OPTS`**ç¯å¢ƒå˜é‡ï¼‰æ¥ä½¿Javaåº”ç”¨ç¨‹åºæ‰§è¡Œ**ä»»æ„ä»£ç /å‘½ä»¤**ã€‚

{% content-ref url="macos-java-apps-injection.md" %}
[macos-java-apps-injection.md](macos-java-apps-injection.md)
{% endcontent-ref %}

### .Netåº”ç”¨ç¨‹åºæ³¨å…¥

å¯ä»¥é€šè¿‡æ»¥ç”¨.Netè°ƒè¯•åŠŸèƒ½ï¼ˆä¸å—macOSçš„è¿è¡Œæ—¶åŠ å›ºç­‰ä¿æŠ¤æªæ–½ä¿æŠ¤ï¼‰å°†ä»£ç æ³¨å…¥åˆ°.Netåº”ç”¨ç¨‹åºä¸­ã€‚

{% content-ref url="macos-.net-applications-injection.md" %}
[macos-.net-applications-injection.md](macos-.net-applications-injection.md)
{% endcontent-ref %}

### Perlæ³¨å…¥

æ£€æŸ¥ä¸åŒçš„é€‰é¡¹ï¼Œä»¥ä½¿Perlè„šæœ¬æ‰§è¡Œä»»æ„ä»£ç ï¼š

{% content-ref url="macos-perl-applications-injection.md" %}
[macos-perl-applications-injection.md](macos-perl-applications-injection.md)
{% endcontent-ref %}

### Pythonæ³¨å…¥

å¦‚æœè®¾ç½®äº†ç¯å¢ƒå˜é‡**`PYTHONINSPECT`**ï¼ŒPythonè¿›ç¨‹åœ¨å®Œæˆåå°†è¿›å…¥Pythonå‘½ä»¤è¡Œç•Œé¢ã€‚è¿˜å¯ä»¥ä½¿ç”¨**`PYTHONSTARTUP`**æŒ‡å®šåœ¨äº¤äº’ä¼šè¯å¼€å§‹æ—¶è¦æ‰§è¡Œçš„Pythonè„šæœ¬ã€‚\
ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œå½“**`PYTHONINSPECT`**åˆ›å»ºäº¤äº’ä¼šè¯æ—¶ï¼Œ**`PYTHONSTARTUP`**è„šæœ¬ä¸ä¼šè¢«æ‰§è¡Œã€‚

å…¶ä»–ç¯å¢ƒå˜é‡ï¼Œå¦‚**`PYTHONPATH`**å’Œ**`PYTHONHOME`**ï¼Œä¹Ÿå¯ä»¥ç”¨äºä½¿Pythonå‘½ä»¤æ‰§è¡Œä»»æ„ä»£ç ã€‚

è¯·æ³¨æ„ï¼Œä½¿ç”¨**`pyinstaller`**ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶å³ä½¿ä½¿ç”¨åµŒå…¥çš„Pythonè¿è¡Œï¼Œä¹Ÿä¸ä¼šä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ã€‚

{% hint style="danger" %}
æ€»çš„æ¥è¯´ï¼Œæˆ‘æ‰¾ä¸åˆ°ä¸€ç§æ»¥ç”¨ç¯å¢ƒå˜é‡ä½¿Pythonæ‰§è¡Œä»»æ„ä»£ç çš„æ–¹æ³•ã€‚\
ç„¶è€Œï¼Œå¤§å¤šæ•°äººä½¿ç”¨**Hombrew**å®‰è£…Pythonï¼Œå®ƒä¼šå°†Pythonå®‰è£…åœ¨é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·çš„**å¯å†™ä½ç½®**ã€‚ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼ä»¥ä¸‹çš„æ–¹æ³•åŠ«æŒå®ƒï¼š
```bash
mv /opt/homebrew/bin/python3 /opt/homebrew/bin/python3.old
cat > /opt/homebrew/bin/python3 <<EOF
#!/bin/bash
# Extra hijack code
/opt/homebrew/bin/python3.old "$@"
EOF
chmod +x /opt/homebrew/bin/python3
```
å³ä½¿ä»¥rootèº«ä»½è¿è¡Œpythonï¼Œä¹Ÿä¼šè¿è¡Œæ­¤ä»£ç ã€‚

## æ£€æµ‹

### Shield

[**Shield**](https://theevilbit.github.io/shield/)ï¼ˆ[**Github**](https://github.com/theevilbit/Shield)ï¼‰æ˜¯ä¸€ä¸ªå¼€æºåº”ç”¨ç¨‹åºï¼Œå¯ä»¥**æ£€æµ‹å’Œé˜»æ­¢è¿›ç¨‹æ³¨å…¥**æ“ä½œï¼š

* ä½¿ç”¨**ç¯å¢ƒå˜é‡**ï¼šå®ƒå°†ç›‘è§†ä»¥ä¸‹ä»»ä½•ç¯å¢ƒå˜é‡çš„å­˜åœ¨ï¼š**`DYLD_INSERT_LIBRARIES`**ï¼Œ**`CFNETWORK_LIBRARY_PATH`**ï¼Œ**`RAWCAMERA_BUNDLE_PATH`**å’Œ**`ELECTRON_RUN_AS_NODE`**
* ä½¿ç”¨**`task_for_pid`**è°ƒç”¨ï¼šæŸ¥æ‰¾ä¸€ä¸ªè¿›ç¨‹æƒ³è¦è·å–å¦ä¸€ä¸ªè¿›ç¨‹çš„**ä»»åŠ¡ç«¯å£**ï¼Œä»è€Œå…è®¸åœ¨è¿›ç¨‹ä¸­æ³¨å…¥ä»£ç çš„æƒ…å†µã€‚
* **Electronåº”ç”¨ç¨‹åºå‚æ•°**ï¼šæŸäººå¯ä»¥ä½¿ç”¨**`--inspect`**ï¼Œ**`--inspect-brk`**å’Œ**`--remote-debugging-port`**å‘½ä»¤è¡Œå‚æ•°ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨Electronåº”ç”¨ç¨‹åºï¼Œä»è€Œæ³¨å…¥ä»£ç ã€‚
* ä½¿ç”¨**ç¬¦å·é“¾æ¥**æˆ–**ç¡¬é“¾æ¥**ï¼šé€šå¸¸æœ€å¸¸è§çš„æ»¥ç”¨æ˜¯**ä½¿ç”¨æˆ‘ä»¬çš„ç”¨æˆ·æƒé™**æ”¾ç½®ä¸€ä¸ªé“¾æ¥ï¼Œå¹¶å°†å…¶æŒ‡å‘æ›´é«˜æƒé™çš„ä½ç½®ã€‚å¯¹äºç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥ï¼Œæ£€æµ‹éå¸¸ç®€å•ã€‚å¦‚æœåˆ›å»ºé“¾æ¥çš„è¿›ç¨‹å…·æœ‰**ä¸åŒçš„æƒé™çº§åˆ«**ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ª**è­¦æŠ¥**ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ç¬¦å·é“¾æ¥çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åˆ›å»ºä¹‹å‰æ²¡æœ‰å…³äºé“¾æ¥ç›®æ ‡çš„ä¿¡æ¯ã€‚è¿™æ˜¯Appleçš„EndpointSecuriyæ¡†æ¶çš„ä¸€ä¸ªé™åˆ¶ã€‚

### å…¶ä»–è¿›ç¨‹å‘å‡ºçš„è°ƒç”¨

åœ¨[**è¿™ç¯‡åšæ–‡**](https://knight.sc/reverse%20engineering/2019/04/15/detecting-task-modifications.html)ä¸­ï¼Œæ‚¨å¯ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨å‡½æ•°**`task_name_for_pid`**è·å–æœ‰å…³å…¶ä»–**åœ¨è¿›ç¨‹ä¸­æ³¨å…¥ä»£ç çš„è¿›ç¨‹**çš„ä¿¡æ¯ï¼Œç„¶åè·å–æœ‰å…³è¯¥å…¶ä»–è¿›ç¨‹çš„ä¿¡æ¯ã€‚

è¯·æ³¨æ„ï¼Œè¦è°ƒç”¨è¯¥å‡½æ•°ï¼Œæ‚¨éœ€è¦å…·æœ‰ä¸è¿è¡Œè¿›ç¨‹ç›¸åŒçš„uidæˆ–**root**ï¼ˆå®ƒè¿”å›æœ‰å…³è¿›ç¨‹çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ³¨å…¥ä»£ç çš„æ–¹æ³•ï¼‰ã€‚

## å‚è€ƒèµ„æ–™

* [https://theevilbit.github.io/shield/](https://theevilbit.github.io/shield/)
* [https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTricksè¡£ç‰©**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
