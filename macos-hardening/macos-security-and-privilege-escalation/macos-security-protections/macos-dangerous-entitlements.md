# macOS Dangerous Entitlements & TCC perms

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`com.apple`** рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЕрдзрд┐рдХрд╛рд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИрдВ, рдХреЗрд╡рд▓ Apple рдЙрдиреНрд╣реЗрдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

## High

### `com.apple.rootless.install.heritable`

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.rootless.install.heritable`** **SIP** рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](macos-sip.md#com.apple.rootless.install.heritable).

### **`com.apple.rootless.install`**

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.rootless.install`** **SIP** рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](macos-sip.md#com.apple.rootless.install).

### **`com.apple.system-task-ports` (рдкрд╣рд▓реЗ `task_for_pid-allow` рдХрд╣рд╛ рдЬрд╛рддрд╛ рдерд╛)**

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП **рдХрд╛рд░реНрдп рдкреЛрд░реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рд┐рд╡рд╛рдп рдХрд░реНрдиреЗрд▓ рдХреЗред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](../macos-proces-abuse/macos-ipc-inter-process-communication/).

### `com.apple.security.get-task-allow`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ **`com.apple.security.cs.debugger`** рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрд╛рд░реНрдп рдкреЛрд░реНрдЯ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ **рдЗрд╕ рдкрд░ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдмрд╛рдЗрдирд░реА рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдпреА рдЬрд╛рддреА рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](../macos-proces-abuse/macos-ipc-inter-process-communication/).

### `com.apple.security.cs.debugger`

рдбрд┐рдмрдЧрд┐рдВрдЧ рдЯреВрд▓ рдЕрдзрд┐рдХрд╛рд░ рд╡рд╛рд▓реЗ рдРрдкреНрд╕ `task_for_pid()` рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдмрд┐рдирд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдФрд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдкреЛрд░реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ `Get Task Allow` рдЕрдзрд┐рдХрд╛рд░ `true` рдкрд░ рд╕реЗрдЯ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдбрд┐рдмрдЧрд┐рдВрдЧ рдЯреВрд▓ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рднреА, рдПрдХ рдбрд┐рдмрдЧрд░ **рдЙрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдХрд╛рд░реНрдп рдкреЛрд░реНрдЯ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛** рдЬрд┐рдирдХреЗ рдкрд╛рд╕ `Get Task Allow` рдЕрдзрд┐рдХрд╛рд░ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЬреЛ рдЗрд╕рд▓рд┐рдП рд╕рд┐рд╕реНрдЯрдо рдЗрдВрдЯреАрдЧреНрд░рд┐рдЯреА рдкреНрд░реЛрдЯреЗрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИрдВред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_debugger).

### `com.apple.security.cs.disable-library-validation`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **рдлреНрд░реЗрдорд╡рд░реНрдХ, рдкреНрд▓рдЧ-рдЗрди, рдпрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдмрд┐рдирд╛ Apple рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реЛрдиреЗ рдпрд╛ рдореБрдЦреНрдп рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЗ рд╕рдорд╛рди рдЯреАрдо рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реЛрдиреЗ рдХреЗ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреБрдЫ рдордирдорд╛рдиреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_disable-library-validation).

### `com.apple.private.security.clear-library-validation`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **`com.apple.security.cs.disable-library-validation`** рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди **рд╕реАрдзреЗ** рдкреБрд╕реНрддрдХрд╛рд▓рдп рдорд╛рдиреНрдпрддрд╛ рдХреЛ **рдирд┐рд╖реНрдХреНрд░рд┐рдп** рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **`csops` рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рдЗрд╕реЗ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](https://theevilbit.github.io/posts/com.apple.private.security.clear-library-validation/).

### `com.apple.security.cs.allow-dyld-environment-variables`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **DYLD рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдФрд░ рдХреЛрдб рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-dyld-environment-variables).

### `com.apple.private.tcc.manager` рдпрд╛ `com.apple.rootless.storage`.`TCC`

[**рдЗрд╕ рдмреНрд▓реЙрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://objective-see.org/blog/blog\_0x4C.html) **рдФрд░** [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://wojciechregula.blog/post/play-the-music-and-bypass-tcc-aka-cve-2020-29621/), рдпреЗ рдЕрдзрд┐рдХрд╛рд░ **TCC** рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

### **`system.install.apple-software`** рдФрд░ **`system.install.apple-software.standar-user`**

рдпреЗ рдЕрдзрд┐рдХрд╛рд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЕрдиреБрдорддрд┐ рдкреВрдЫреЗ рдмрд┐рдирд╛** рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ **рд╕реНрдерд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреЛ **рдЕрдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐** рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `com.apple.private.security.kext-management`

рдХрд░реНрдиреЗрд▓ рдХреЛ рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрдЫрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЕрдзрд┐рдХрд╛рд░ред

### **`com.apple.private.icloud-account-access`**

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.private.icloud-account-access`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **`com.apple.iCloudHelper`** XPC рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ **iCloud рдЯреЛрдХрди** рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред

**iMovie** рдФрд░ **Garageband** рдХреЗ рдкрд╛рд╕ рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдерд╛ред

рдЗрд╕ рдЕрдзрд┐рдХрд╛рд░ рд╕реЗ **icloud рдЯреЛрдХрди** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╢реЛрд╖рдг** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдмрд╛рдд рджреЗрдЦреЗрдВ: [**#OBTS v5.0: "What Happens on your Mac, Stays on Apple's iCloud?!" - Wojciech Regula**](https://www.youtube.com/watch?v=\_6e2LhmxVc0)

### `com.apple.private.tcc.manager.check-by-audit-token`

TODO: рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ

### `com.apple.private.apfs.revert-to-snapshot`

TODO: [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) **рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ** рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж SSV-рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреГрдкрдпрд╛ PR рднреЗрдЬреЗрдВ!

### `com.apple.private.apfs.create-sealed-snapshot`

TODO: [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) **рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ** рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж SSV-рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреГрдкрдпрд╛ PR рднреЗрдЬреЗрдВ!

### `keychain-access-groups`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **keychain** рд╕рдореВрд╣реЛрдВ рдХреА рд╕реВрдЪреА рд╣реИ рдЬрд┐рди рддрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╣реБрдБрдЪ рд╣реИ:
```xml
<key>keychain-access-groups</key>
<array>
<string>ichat</string>
<string>apple</string>
<string>appleaccount</string>
<string>InternetAccounts</string>
<string>IMCore</string>
</array>
```
### **`kTCCServiceSystemPolicyAllFiles`**

**рдкреВрд░реНрдг рдбрд┐рд╕реНрдХ рдПрдХреНрд╕реЗрд╕** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗрддрд╛ рд╣реИ, рдЬреЛ TCC рдХреА рд╕рдмрд╕реЗ рдЙрдЪреНрдЪ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╣реЛ рд╕рдХрддреА рд╣реИред

### **`kTCCServiceAppleEvents`**

рдРрдк рдХреЛ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ **рдХрд╛рд░реНрдп рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдПрдБ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ рдЗрди рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЛ рджреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЬреИрд╕реЗ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЙрд╕рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдкреВрдЫрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдирд╛: 

{% code overflow="wrap" %}
```bash
osascript -e 'tell app "App Store" to activate' -e 'tell app "App Store" to activate' -e 'tell app "App Store" to display dialog "App Store requires your password to continue." & return & return default answer "" with icon 1 with hidden answer with title "App Store Alert"'
```
{% endcode %}

рдпрд╛ рдЙрдиреНрд╣реЗрдВ **рдордирдорд╛рдиреЗ рдХрд╛рд░реНрдп** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛ред

### **`kTCCServiceEndpointSecurityClient`**

рдЕрдиреНрдп рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ TCC рдбреЗрдЯрд╛рдмреЗрд╕** рдХреЛ **рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### **`kTCCServiceSystemPolicySysAdminFiles`**

рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ **`NFSHomeDirectory`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ **рдмрджрд▓рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдЙрд╕рдХреЗ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рдкрде рдХреЛ рдмрджрд▓рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП **TCC** рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### **`kTCCServiceSystemPolicyAppBundles`**

рдРрдкреНрд╕ рдмрдВрдбрд▓ (app.app рдХреЗ рдЕрдВрджрд░) рдХреЗ рдЕрдВрджрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрд╕реНрд╡реАрдХреГрдд** рд╣реИред

<figure><img src="../../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХрд┐рд╕рдХреЗ рдкрд╛рд╕ рдпрд╣ рдкрд╣реБрдВрдЪ рд╣реИ _System Settings_ > _Privacy & Security_ > _App Management._

### `kTCCServiceAccessibility`

рдкреНрд░рдХреНрд░рд┐рдпрд╛ **macOS рдкрд╣реБрдВрдЪ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ** рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧреА, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╡рд╣ рдХреАрд╕реНрдЯреНрд░реЛрдХ рджрдмрд╛ рд╕рдХреЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рд╡рд╣ Finder рдЬреИрд╕реЗ рдРрдк рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХреЛ рдордВрдЬреВрд░реА рджреЗ рд╕рдХрддрд╛ рд╣реИред

## рдордзреНрдпрдо

### `com.apple.security.cs.allow-jit`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдореЗрдореЛрд░реА** рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ `mmap()` рд╕рд┐рд╕реНрдЯрдо рдлрд╝рдВрдХреНрд╢рди рдХреЛ `MAP_JIT` рдзреНрд╡рдЬ рдкрд╛рд╕ рдХрд░рдХреЗред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдпрд╣ рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-jit)ред

### `com.apple.security.cs.allow-unsigned-executable-memory`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **C рдХреЛрдб рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдпрд╛ рдкреИрдЪ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдЕрдкреНрд░рдЪрд▓рд┐рдд **`NSCreateObjectFileImageFromMemory`** (рдЬреЛ рдореМрд▓рд┐рдХ рд░реВрдк рд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдпрд╛ **DVDPlayback** рдврд╛рдВрдЪреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдпрд╣ рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-unsigned-executable-memory)ред

{% hint style="danger" %}
рдЗрд╕ рдЕрдзрд┐рдХрд╛рд░ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХрд╛ рдРрдк рдореЗрдореЛрд░реА-рдЦрддрд░рдирд╛рдХ рдХреЛрдб рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рд╣реЛрддрд╛ рд╣реИред рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдРрдк рдХреЛ рдЗрд╕ рдЕрдкрд╡рд╛рдж рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
{% endhint %}

### `com.apple.security.cs.disable-executable-page-protection`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрд▓рд╛рддреНрдХрд╛рд░реА рд░реВрдк рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХреЗред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдпрд╣ рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_disable-executable-page-protection)уАВ

{% hint style="danger" %}
Disable Executable Memory Protection Entitlement рдПрдХ рдЪрд░рдо рдЕрдзрд┐рдХрд╛рд░ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдРрдк рд╕реЗ рдПрдХ рдореМрд▓рд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЖрдкрдХреЗ рдРрдк рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЛрдб рдХреЛ рдмрд┐рдирд╛ рдкрд╣рдЪрд╛рди рдХреЗ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рд╕рдВрдХреАрд░реНрдг рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВред
{% endhint %}

### `com.apple.security.cs.allow-relative-library-loads`

TODO

### `com.apple.private.nullfs_allow`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдПрдХ nullfs рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд╖рд┐рджреНрдз)ред рдЙрдкрдХрд░рдг: [**mount\_nullfs**](https://github.com/JamaicanMoose/mount\_nullfs/tree/master)уАВ

### `kTCCServiceAll`

рдЗрд╕ рдмреНрд▓реЙрдЧрдкреЛрд╕реНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ TCC рдЕрдиреБрдорддрд┐ рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рд░реВрдк рдореЗрдВ рдкрд╛рдИ рдЬрд╛рддреА рд╣реИ:
```
[Key] com.apple.private.tcc.allow-prompting
[Value]
[Array]
[String] kTCCServiceAll
```
Allow the process to **ask for all the TCC permissions**.

### **`kTCCServicePostEvent`**
{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
</details>
