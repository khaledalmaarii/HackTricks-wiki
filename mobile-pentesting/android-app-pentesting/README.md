# Android åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

åŠ å…¥ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼

**é»‘å®¢è§è§£**\
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€å’ŒæŒ‘æˆ˜çš„å†…å®¹

**å®æ—¶é»‘å®¢æ–°é—»**\
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ

**æœ€æ–°å…¬å‘Š**\
äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘è®¡åˆ’å’Œé‡è¦å¹³å°æ›´æ–°

**ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬çš„** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ï¼Œä¸é¡¶å°–é»‘å®¢å¼€å§‹åˆä½œå§ï¼

## Android åº”ç”¨ç¨‹åºåŸºç¡€

å¼ºçƒˆå»ºè®®æ‚¨å¼€å§‹é˜…è¯»æ­¤é¡µé¢ï¼Œä»¥äº†è§£ä¸ Android å®‰å…¨æ€§ç›¸å…³çš„ **æœ€é‡è¦éƒ¨åˆ†å’Œ Android åº”ç”¨ç¨‹åºä¸­æœ€å±é™©çš„ç»„ä»¶**ï¼š

{% content-ref url="android-applications-basics.md" %}
[android-applications-basics.md](android-applications-basics.md)
{% endcontent-ref %}

## ADB (Android è°ƒè¯•æ¡¥)

è¿™æ˜¯æ‚¨è¿æ¥åˆ° Android è®¾å¤‡ï¼ˆæ¨¡æ‹Ÿæˆ–ç‰©ç†ï¼‰æ‰€éœ€çš„ä¸»è¦å·¥å…·ã€‚\
**ADB** å…è®¸ä»è®¡ç®—æœºé€šè¿‡ **USB** æˆ– **ç½‘ç»œ** æ§åˆ¶è®¾å¤‡ã€‚æ­¤å·¥å…·ä½¿ **æ–‡ä»¶** åŒå‘ **å¤åˆ¶**ã€**å®‰è£…** å’Œ **å¸è½½** åº”ç”¨ç¨‹åºã€**æ‰§è¡Œ** shell å‘½ä»¤ã€**å¤‡ä»½** æ•°æ®ã€**è¯»å–** æ—¥å¿—ç­‰åŠŸèƒ½æˆä¸ºå¯èƒ½ã€‚

æŸ¥çœ‹ä»¥ä¸‹ [**ADB å‘½ä»¤**](adb-commands.md) åˆ—è¡¨ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨ adbã€‚

## Smali

æœ‰æ—¶ä¿®æ”¹ **åº”ç”¨ç¨‹åºä»£ç ** ä»¥è®¿é—® **éšè—ä¿¡æ¯**ï¼ˆå¯èƒ½æ˜¯ç»è¿‡è‰¯å¥½æ··æ·†çš„å¯†ç æˆ–æ ‡å¿—ï¼‰æ˜¯å¾ˆæœ‰è¶£çš„ã€‚ç„¶åï¼Œåç¼–è¯‘ apkã€ä¿®æ”¹ä»£ç å¹¶é‡æ–°ç¼–è¯‘å¯èƒ½ä¼šå¾ˆæœ‰è¶£ã€‚\
[**åœ¨æœ¬æ•™ç¨‹ä¸­**ï¼Œæ‚¨å¯ä»¥ **å­¦ä¹ å¦‚ä½•åç¼–è¯‘ APKï¼Œä¿®æ”¹ Smali ä»£ç å¹¶é‡æ–°ç¼–è¯‘ APK**ï¼Œä»¥å®ç°æ–°åŠŸèƒ½](smali-changes.md)ã€‚è¿™åœ¨ **åŠ¨æ€åˆ†æ** ä¸­ä½œä¸º **å¤šé¡¹æµ‹è¯•çš„æ›¿ä»£æ–¹æ¡ˆ** å°†éå¸¸æœ‰ç”¨ã€‚ç„¶åï¼Œ**å§‹ç»ˆè®°ä½è¿™ä¸ªå¯èƒ½æ€§**ã€‚

## å…¶ä»–æœ‰è¶£çš„æŠ€å·§

* [åœ¨ Play å•†åº—ä¸­ä¼ªè£…æ‚¨çš„ä½ç½®](spoofing-your-location-in-play-store.md)
* **ä¸‹è½½ APK**: [https://apps.evozi.com/apk-downloader/](https://apps.evozi.com/apk-downloader/), [https://apkpure.com/es/](https://apkpure.com/es/), [https://www.apkmirror.com/](https://www.apkmirror.com), [https://apkcombo.com/es-es/apk-downloader/](https://apkcombo.com/es-es/apk-downloader/), [https://github.com/kiber-io/apkd](https://github.com/kiber-io/apkd)
* ä»è®¾å¤‡æå– APK:
```bash
adb shell pm list packages
com.android.insecurebankv2

adb shell pm path com.android.insecurebankv2
package:/data/app/com.android.insecurebankv2-Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk

adb pull /data/app/com.android.insecurebankv2-Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk
```
* ä½¿ç”¨ [APKEditor](https://github.com/REAndroid/APKEditor) åˆå¹¶æ‰€æœ‰æ‹†åˆ†å’ŒåŸºç¡€ APKï¼š
```bash
mkdir splits
adb shell pm path com.android.insecurebankv2 | cut -d ':' -f 2 | xargs -n1 -i adb pull {} splits
java -jar ../APKEditor.jar m -i splits/ -o merged.apk

# after merging, you will need to align and sign the apk, personally, I like to use the uberapksigner
java -jar uber-apk-signer.jar -a merged.apk --allowResign -o merged_signed
```
## é™æ€åˆ†æ

é¦–å…ˆï¼Œåˆ†æ APK æ—¶ï¼Œæ‚¨åº”è¯¥**æŸ¥çœ‹ Java ä»£ç **ï¼Œä½¿ç”¨åç¼–è¯‘å™¨ã€‚\
è¯·[**åœ¨è¿™é‡Œé˜…è¯»æœ‰å…³ä¸åŒå¯ç”¨åç¼–è¯‘å™¨çš„ä¿¡æ¯**](apk-decompilers.md)ã€‚

### å¯»æ‰¾æœ‰è¶£çš„ä¿¡æ¯

ä»…æŸ¥çœ‹ APK çš„**å­—ç¬¦ä¸²**ï¼Œæ‚¨å¯ä»¥æœç´¢**å¯†ç **ã€**URL**ï¼ˆ[https://github.com/ndelphit/apkurlgrep](https://github.com/ndelphit/apkurlgrep)ï¼‰ã€**api** å¯†é’¥ã€**åŠ å¯†**ã€**è“ç‰™ UUID**ã€**ä»¤ç‰Œ**ä»¥åŠä»»ä½•æœ‰è¶£çš„å†…å®¹â€¦â€¦ç”šè‡³æŸ¥æ‰¾ä»£ç æ‰§è¡Œçš„**åé—¨**æˆ–èº«ä»½éªŒè¯åé—¨ï¼ˆç¡¬ç¼–ç çš„ç®¡ç†å‘˜å‡­æ®ï¼‰ã€‚

**Firebase**

ç‰¹åˆ«æ³¨æ„**firebase URL**ï¼Œå¹¶æ£€æŸ¥å…¶æ˜¯å¦é…ç½®ä¸å½“ã€‚[æœ‰å…³ Firebase çš„æ›´å¤šä¿¡æ¯ä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒï¼Œè¯·ç‚¹å‡»è¿™é‡Œã€‚](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)

### åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç†è§£ - Manifest.xml, strings.xml

**æ£€æŸ¥åº”ç”¨ç¨‹åºçš„ \_Manifest.xml**_\*\* å’Œ \*\*_**strings.xml**\_\*\* æ–‡ä»¶å¯ä»¥æ­ç¤ºæ½œåœ¨çš„å®‰å…¨æ¼æ´\*\*ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥é€šè¿‡åç¼–è¯‘å™¨è®¿é—®ï¼Œæˆ–é€šè¿‡å°† APK æ–‡ä»¶æ‰©å±•åé‡å‘½åä¸º .zip ç„¶åè§£å‹ç¼©æ¥è®¿é—®ã€‚

ä» **Manifest.xml** ä¸­è¯†åˆ«çš„**æ¼æ´**åŒ…æ‹¬ï¼š

* **å¯è°ƒè¯•åº”ç”¨ç¨‹åº**ï¼šåœ¨ _Manifest.xml_ æ–‡ä»¶ä¸­è®¾ç½®ä¸ºå¯è°ƒè¯•ï¼ˆ`debuggable="true"`ï¼‰çš„åº”ç”¨ç¨‹åºå­˜åœ¨é£é™©ï¼Œå› ä¸ºå®ƒä»¬å…è®¸è¿æ¥ï¼Œå¯èƒ½å¯¼è‡´è¢«åˆ©ç”¨ã€‚æœ‰å…³å¦‚ä½•åˆ©ç”¨å¯è°ƒè¯•åº”ç”¨ç¨‹åºçš„è¿›ä¸€æ­¥ç†è§£ï¼Œè¯·å‚è€ƒæœ‰å…³åœ¨è®¾å¤‡ä¸ŠæŸ¥æ‰¾å’Œåˆ©ç”¨å¯è°ƒè¯•åº”ç”¨ç¨‹åºçš„æ•™ç¨‹ã€‚
* **å¤‡ä»½è®¾ç½®**ï¼šå¤„ç†æ•æ„Ÿä¿¡æ¯çš„åº”ç”¨ç¨‹åºåº”æ˜ç¡®è®¾ç½® `android:allowBackup="false"` å±æ€§ï¼Œä»¥é˜²æ­¢é€šè¿‡ adb è¿›è¡Œæœªç»æˆæƒçš„æ•°æ®å¤‡ä»½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¯ç”¨ USB è°ƒè¯•æ—¶ã€‚
* **ç½‘ç»œå®‰å…¨**ï¼š_res/xml/_ ä¸­çš„è‡ªå®šä¹‰ç½‘ç»œå®‰å…¨é…ç½®ï¼ˆ`android:networkSecurityConfig="@xml/network_security_config"`ï¼‰å¯ä»¥æŒ‡å®šå®‰å…¨ç»†èŠ‚ï¼Œå¦‚è¯ä¹¦å›ºå®šå’Œ HTTP æµé‡è®¾ç½®ã€‚ä¸€ä¸ªä¾‹å­æ˜¯å…è®¸ç‰¹å®šåŸŸçš„ HTTP æµé‡ã€‚
* **å¯¼å‡ºæ´»åŠ¨å’ŒæœåŠ¡**ï¼šåœ¨æ¸…å•ä¸­è¯†åˆ«å¯¼å‡ºçš„æ´»åŠ¨å’ŒæœåŠ¡å¯ä»¥çªå‡ºå¯èƒ½è¢«æ»¥ç”¨çš„ç»„ä»¶ã€‚åœ¨åŠ¨æ€æµ‹è¯•æœŸé—´çš„è¿›ä¸€æ­¥åˆ†æå¯ä»¥æ­ç¤ºå¦‚ä½•åˆ©ç”¨è¿™äº›ç»„ä»¶ã€‚
* **å†…å®¹æä¾›è€…å’Œæ–‡ä»¶æä¾›è€…**ï¼šæš´éœ²çš„å†…å®¹æä¾›è€…å¯èƒ½å…è®¸æœªç»æˆæƒè®¿é—®æˆ–ä¿®æ”¹æ•°æ®ã€‚æ–‡ä»¶æä¾›è€…çš„é…ç½®ä¹Ÿåº”å—åˆ°å®¡æŸ¥ã€‚
* **å¹¿æ’­æ¥æ”¶å™¨å’Œ URL æ–¹æ¡ˆ**ï¼šè¿™äº›ç»„ä»¶å¯èƒ½è¢«åˆ©ç”¨è¿›è¡Œæ”»å‡»ï¼Œç‰¹åˆ«æ³¨æ„ URL æ–¹æ¡ˆå¦‚ä½•ç®¡ç†è¾“å…¥æ¼æ´ã€‚
* **SDK ç‰ˆæœ¬**ï¼š`minSdkVersion`ã€`targetSDKVersion` å’Œ `maxSdkVersion` å±æ€§æŒ‡ç¤ºæ”¯æŒçš„ Android ç‰ˆæœ¬ï¼Œå¼ºè°ƒå‡ºäºå®‰å…¨åŸå› ä¸æ”¯æŒè¿‡æ—¶ã€æ˜“å—æ”»å‡»çš„ Android ç‰ˆæœ¬çš„é‡è¦æ€§ã€‚

ä» **strings.xml** æ–‡ä»¶ä¸­ï¼Œå¯ä»¥å‘ç°æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ API å¯†é’¥ã€è‡ªå®šä¹‰æ¨¡å¼å’Œå…¶ä»–å¼€å‘è€…æ³¨é‡Šï¼Œå¼ºè°ƒäº†å¯¹è¿™äº›èµ„æºè¿›è¡Œä»”ç»†å®¡æŸ¥çš„å¿…è¦æ€§ã€‚

### Tapjacking

**Tapjacking** æ˜¯ä¸€ç§æ”»å‡»ï¼Œå…¶ä¸­**æ¶æ„** **åº”ç”¨ç¨‹åº**è¢«å¯åŠ¨å¹¶**å®šä½åœ¨å—å®³è€…åº”ç”¨ç¨‹åºçš„é¡¶éƒ¨**ã€‚ä¸€æ—¦å®ƒå¯è§åœ°é®æŒ¡äº†å—å®³è€…åº”ç”¨ç¨‹åºï¼Œå…¶ç”¨æˆ·ç•Œé¢è¢«è®¾è®¡æˆæ¬ºéª—ç”¨æˆ·ä¸ä¹‹äº¤äº’ï¼ŒåŒæ—¶å°†äº¤äº’ä¼ é€’ç»™å—å®³è€…åº”ç”¨ç¨‹åºã€‚\
å®é™…ä¸Šï¼Œå®ƒæ˜¯**è®©ç”¨æˆ·ä¸çŸ¥é“ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨å¯¹å—å®³è€…åº”ç”¨ç¨‹åºæ‰§è¡Œæ“ä½œ**ã€‚

åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šä¿¡æ¯ï¼š

{% content-ref url="tapjacking.md" %}
[tapjacking.md](tapjacking.md)
{% endcontent-ref %}

### ä»»åŠ¡åŠ«æŒ

ä¸€ä¸ª**æ´»åŠ¨**ï¼Œå…¶**`launchMode`** è®¾ç½®ä¸º**`singleTask`**ï¼Œä¸”æœªå®šä¹‰ä»»ä½• `taskAffinity`ï¼Œæ˜“å—ä»»åŠ¡åŠ«æŒã€‚è¿™æ„å‘³ç€ï¼Œå¯ä»¥å®‰è£…ä¸€ä¸ª**åº”ç”¨ç¨‹åº**ï¼Œå¦‚æœåœ¨çœŸå®åº”ç”¨ç¨‹åºä¹‹å‰å¯åŠ¨ï¼Œå®ƒå¯èƒ½ä¼š**åŠ«æŒçœŸå®åº”ç”¨ç¨‹åºçš„ä»»åŠ¡**ï¼ˆå› æ­¤ç”¨æˆ·å°†ä¸**æ¶æ„åº”ç”¨ç¨‹åº**äº¤äº’ï¼Œä»¥ä¸ºè‡ªå·±åœ¨ä½¿ç”¨çœŸå®åº”ç”¨ç¨‹åºï¼‰ã€‚

æ›´å¤šä¿¡æ¯åœ¨ï¼š

{% content-ref url="android-task-hijacking.md" %}
[android-task-hijacking.md](android-task-hijacking.md)
{% endcontent-ref %}

### ä¸å®‰å…¨çš„æ•°æ®å­˜å‚¨

**å†…éƒ¨å­˜å‚¨**

åœ¨ Android ä¸­ï¼Œ**å­˜å‚¨**åœ¨**å†…éƒ¨**å­˜å‚¨ä¸­çš„æ–‡ä»¶**è®¾è®¡**ä¸ºä»…ç”±**åˆ›å»º**å®ƒä»¬çš„**åº”ç”¨ç¨‹åº**è®¿é—®ã€‚æ­¤å®‰å…¨æªæ–½ç”± Android æ“ä½œç³»ç»Ÿ**å¼ºåˆ¶**æ‰§è¡Œï¼Œé€šå¸¸è¶³ä»¥æ»¡è¶³å¤§å¤šæ•°åº”ç”¨ç¨‹åºçš„å®‰å…¨éœ€æ±‚ã€‚ç„¶è€Œï¼Œå¼€å‘è€…æœ‰æ—¶ä¼šåˆ©ç”¨ `MODE_WORLD_READABLE` å’Œ `MODE_WORLD_WRITABLE` ç­‰æ¨¡å¼æ¥**å…è®¸**æ–‡ä»¶åœ¨ä¸åŒåº”ç”¨ç¨‹åºä¹‹é—´**å…±äº«**ã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å¼**å¹¶ä¸é™åˆ¶**å…¶ä»–åº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬æ½œåœ¨æ¶æ„åº”ç”¨ç¨‹åºï¼‰å¯¹è¿™äº›æ–‡ä»¶çš„è®¿é—®ã€‚

1. **é™æ€åˆ†æï¼š**
* **ç¡®ä¿**ä»”ç»†å®¡æŸ¥ `MODE_WORLD_READABLE` å’Œ `MODE_WORLD_WRITABLE` çš„ä½¿ç”¨ã€‚è¿™äº›æ¨¡å¼**å¯èƒ½ä¼šæš´éœ²**æ–‡ä»¶ç»™**æ„å¤–æˆ–æœªç»æˆæƒçš„è®¿é—®**ã€‚
2. **åŠ¨æ€åˆ†æï¼š**
* **éªŒè¯**åº”ç”¨ç¨‹åºåˆ›å»ºçš„æ–‡ä»¶ä¸Šçš„**æƒé™**ã€‚å…·ä½“æ¥è¯´ï¼Œ**æ£€æŸ¥**æ˜¯å¦æœ‰ä»»ä½•æ–‡ä»¶è¢«**è®¾ç½®ä¸ºå…¨çƒå¯è¯»æˆ–å¯å†™**ã€‚è¿™å¯èƒ½æ„æˆé‡å¤§å®‰å…¨é£é™©ï¼Œå› ä¸ºè¿™å°†å…è®¸**ä»»ä½•å®‰è£…åœ¨è®¾å¤‡ä¸Šçš„åº”ç”¨ç¨‹åº**ï¼Œæ— è®ºå…¶æ¥æºæˆ–æ„å›¾å¦‚ä½•ï¼Œ**è¯»å–æˆ–ä¿®æ”¹**è¿™äº›æ–‡ä»¶ã€‚

**å¤–éƒ¨å­˜å‚¨**

å¤„ç†**å¤–éƒ¨å­˜å‚¨**ä¸Šçš„æ–‡ä»¶ï¼ˆå¦‚ SD å¡ï¼‰æ—¶ï¼Œåº”é‡‡å–æŸäº›é¢„é˜²æªæ–½ï¼š

1. **å¯è®¿é—®æ€§**ï¼š
* å¤–éƒ¨å­˜å‚¨ä¸Šçš„æ–‡ä»¶æ˜¯**å…¨çƒå¯è¯»å’Œå¯å†™**çš„ã€‚è¿™æ„å‘³ç€ä»»ä½•åº”ç”¨ç¨‹åºæˆ–ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®è¿™äº›æ–‡ä»¶ã€‚
2. **å®‰å…¨é—®é¢˜**ï¼š
* é‰´äºè®¿é—®çš„ä¾¿åˆ©æ€§ï¼Œå»ºè®®**ä¸è¦åœ¨å¤–éƒ¨å­˜å‚¨ä¸Šå­˜å‚¨æ•æ„Ÿä¿¡æ¯**ã€‚
* å¤–éƒ¨å­˜å‚¨å¯ä»¥è¢«ä»»ä½•åº”ç”¨ç¨‹åºç§»é™¤æˆ–è®¿é—®ï¼Œä½¿å…¶å®‰å…¨æ€§é™ä½ã€‚
3. **å¤„ç†æ¥è‡ªå¤–éƒ¨å­˜å‚¨çš„æ•°æ®**ï¼š
* å§‹ç»ˆå¯¹ä»å¤–éƒ¨å­˜å‚¨æ£€ç´¢çš„æ•°æ®**æ‰§è¡Œè¾“å…¥éªŒè¯**ã€‚è¿™è‡³å…³é‡è¦ï¼Œå› ä¸ºæ•°æ®æ¥è‡ªä¸å—ä¿¡ä»»çš„æ¥æºã€‚
* å¼ºçƒˆä¸å»ºè®®åœ¨å¤–éƒ¨å­˜å‚¨ä¸Šå­˜å‚¨å¯æ‰§è¡Œæ–‡ä»¶æˆ–ç±»æ–‡ä»¶ä»¥è¿›è¡ŒåŠ¨æ€åŠ è½½ã€‚
* å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºå¿…é¡»ä»å¤–éƒ¨å­˜å‚¨æ£€ç´¢å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯·ç¡®ä¿è¿™äº›æ–‡ä»¶åœ¨åŠ¨æ€åŠ è½½ä¹‹å‰**å·²ç­¾åå¹¶ç»è¿‡åŠ å¯†éªŒè¯**ã€‚æ­¤æ­¥éª¤å¯¹äºç»´æŠ¤åº”ç”¨ç¨‹åºçš„å®‰å…¨å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚

å¤–éƒ¨å­˜å‚¨å¯ä»¥åœ¨ `/storage/emulated/0`ã€`/sdcard`ã€`/mnt/sdcard` ä¸­è®¿é—®ã€‚

{% hint style="info" %}
ä» Android 4.4ï¼ˆ**API 17**ï¼‰å¼€å§‹ï¼ŒSD å¡å…·æœ‰ç›®å½•ç»“æ„ï¼Œè¿™**é™åˆ¶äº†åº”ç”¨ç¨‹åºå¯¹ç‰¹å®šäºè¯¥åº”ç”¨ç¨‹åºçš„ç›®å½•çš„è®¿é—®**ã€‚è¿™é˜²æ­¢æ¶æ„åº”ç”¨ç¨‹åºè·å¾—å¯¹å…¶ä»–åº”ç”¨ç¨‹åºæ–‡ä»¶çš„è¯»å†™è®¿é—®ã€‚
{% endhint %}

**ä»¥æ˜æ–‡å­˜å‚¨çš„æ•æ„Ÿæ•°æ®**

* **å…±äº«é¦–é€‰é¡¹**ï¼šAndroid å…è®¸æ¯ä¸ªåº”ç”¨ç¨‹åºè½»æ¾åœ°åœ¨è·¯å¾„ `/data/data/<packagename>/shared_prefs/` ä¸­ä¿å­˜ xml æ–‡ä»¶ï¼Œæœ‰æ—¶å¯ä»¥åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ˜æ–‡çš„æ•æ„Ÿä¿¡æ¯ã€‚
* **æ•°æ®åº“**ï¼šAndroid å…è®¸æ¯ä¸ªåº”ç”¨ç¨‹åºè½»æ¾åœ°åœ¨è·¯å¾„ `/data/data/<packagename>/databases/` ä¸­ä¿å­˜ sqlite æ•°æ®åº“ï¼Œæœ‰æ—¶å¯ä»¥åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ˜æ–‡çš„æ•æ„Ÿä¿¡æ¯ã€‚

### ç ´æŸçš„ TLS

**æ¥å—æ‰€æœ‰è¯ä¹¦**

å‡ºäºæŸç§åŸå› ï¼Œæœ‰æ—¶å¼€å‘è€…ä¼šæ¥å—æ‰€æœ‰è¯ä¹¦ï¼Œå³ä½¿ä¾‹å¦‚ä¸»æœºåä¸ä»¥ä¸‹ä»£ç è¡Œä¸åŒ¹é…ï¼š
```java
SSLSocketFactory sf = new cc(trustStore);
sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
```
A good way to test this is to try to capture the traffic using some proxy like Burp without authorising Burp CA inside the device. Also, you can generate with Burp a certificate for a different hostname and use it.

### Broken Cryptography

**Poor Key Management Processes**

ä¸€äº›å¼€å‘è€…å°†æ•æ„Ÿæ•°æ®ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå¹¶ç”¨ä»£ç ä¸­ç¡¬ç¼–ç /å¯é¢„æµ‹çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚è¿™æ˜¯ä¸åº”è¯¥çš„ï¼Œå› ä¸ºä¸€äº›åå‘å·¥ç¨‹å¯èƒ½å…è®¸æ”»å‡»è€…æå–æœºå¯†ä¿¡æ¯ã€‚

**Use of Insecure and/or Deprecated Algorithms**

å¼€å‘è€…ä¸åº”è¯¥ä½¿ç”¨**è¿‡æ—¶çš„ç®—æ³•**æ¥æ‰§è¡Œæˆæƒ**æ£€æŸ¥**ã€**å­˜å‚¨**æˆ–**å‘é€**æ•°æ®ã€‚è¿™äº›ç®—æ³•åŒ…æ‹¬ï¼šRC4ã€MD4ã€MD5ã€SHA1â€¦â€¦å¦‚æœ**å“ˆå¸Œ**ç”¨äºå­˜å‚¨å¯†ç ï¼Œä¾‹å¦‚ï¼Œåº”è¯¥ä½¿ç”¨å¸¦ç›çš„æŠ—æš´åŠ›ç ´è§£**å“ˆå¸Œ**ã€‚

### Other checks

* å»ºè®®**æ··æ·†APK**ä»¥å¢åŠ æ”»å‡»è€…çš„åå‘å·¥ç¨‹éš¾åº¦ã€‚
* å¦‚æœåº”ç”¨ç¨‹åºæ˜¯æ•æ„Ÿçš„ï¼ˆå¦‚é“¶è¡Œåº”ç”¨ï¼‰ï¼Œå®ƒåº”è¯¥æ‰§è¡Œ**è‡ªå·±çš„æ£€æŸ¥ä»¥æŸ¥çœ‹æ‰‹æœºæ˜¯å¦å·²è¢«root**å¹¶é‡‡å–ç›¸åº”æªæ–½ã€‚
* å¦‚æœåº”ç”¨ç¨‹åºæ˜¯æ•æ„Ÿçš„ï¼ˆå¦‚é“¶è¡Œåº”ç”¨ï¼‰ï¼Œå®ƒåº”è¯¥æ£€æŸ¥æ˜¯å¦æ­£åœ¨ä½¿ç”¨**æ¨¡æ‹Ÿå™¨**ã€‚
* å¦‚æœåº”ç”¨ç¨‹åºæ˜¯æ•æ„Ÿçš„ï¼ˆå¦‚é“¶è¡Œåº”ç”¨ï¼‰ï¼Œå®ƒåº”è¯¥**åœ¨æ‰§è¡Œä¹‹å‰æ£€æŸ¥è‡ªèº«çš„å®Œæ•´æ€§**ä»¥ç¡®è®¤æ˜¯å¦è¢«ä¿®æ”¹ã€‚
* ä½¿ç”¨[**APKiD**](https://github.com/rednaga/APKiD)æ£€æŸ¥æ„å»ºAPKæ—¶ä½¿ç”¨çš„ç¼–è¯‘å™¨/æ‰“åŒ…å™¨/æ··æ·†å™¨

### React Native Application

Read the following page to learn how to easily access javascript code of React applications:

{% content-ref url="react-native-application.md" %}
[react-native-application.md](react-native-application.md)
{% endcontent-ref %}

### Xamarin Applications

Read the following page to learn how to easily access C# code of a xamarin applications:

{% content-ref url="../xamarin-apps.md" %}
[xamarin-apps.md](../xamarin-apps.md)
{% endcontent-ref %}

### Superpacked Applications

According to this [**blog post**](https://clearbluejar.github.io/posts/desuperpacking-meta-superpacked-apks-with-github-actions/) superpacked is a Meta algorithm that compress the content of an application into a single file. The blog talks about the possibility of creating an app that decompress these kind of apps... and a faster way which involves to **execute the application and gather the decompressed files from the filesystem.**

### Automated Static Code Analysis

The tool [**mariana-trench**](https://github.com/facebook/mariana-trench) is capable of finding **vulnerabilities** by **scanning** the **code** of the application. This tool contains a series of **known sources** (that indicates to the tool the **places** where the **input** is **controlled by the user**), **sinks** (which indicates to the tool **dangerous** **places** where malicious user input could cause damages) and **rules**. These rules indicates the **combination** of **sources-sinks** that indicates a vulnerability.

With this knowledge, **mariana-trench will review the code and find possible vulnerabilities on it**.

### Secrets leaked

An application may contain secrets (API keys, passwords, hidden urls, subdomains...) inside of it that you might be able to discover. You could us a tool such as [https://github.com/dwisiswant0/apkleaks](https://github.com/dwisiswant0/apkleaks)

### Bypass Biometric Authentication

{% content-ref url="bypass-biometric-authentication-android.md" %}
[bypass-biometric-authentication-android.md](bypass-biometric-authentication-android.md)
{% endcontent-ref %}

### Other interesting functions

* **Code execution**: `Runtime.exec(), ProcessBuilder(), native code:system()`
* **Send SMSs**: `sendTextMessage, sendMultipartTestMessage`
* **Native functions** declared as `native`: `public native, System.loadLibrary, System.load`
* [Read this to learn **how to reverse native functions**](reversing-native-libraries.md)

### **Other tricks**

{% content-ref url="content-protocol.md" %}
[content-protocol.md](content-protocol.md)
{% endcontent-ref %}

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

***

## Dynamic Analysis

> First of all, you need an environment where you can install the application and all the environment (Burp CA cert, Drozer and Frida mainly). Therefore, a rooted device (emulated or not) is extremely recommended.

### Online Dynamic analysis

You can create a **free account** in: [https://appetize.io/](https://appetize.io). This platform allows you to **upload** and **execute** APKs, so it is useful to see how an apk is behaving.

You can even **see the logs of your application** in the web and connect through **adb**.

![](<../../.gitbook/assets/image (831).png>)

Thanks to the ADB connection you can use **Drozer** and **Frida** inside the emulators.

### Local Dynamic Analysis

#### Using an emulator

* [**Android Studio**](https://developer.android.com/studio) (You can create **x86** and **arm** devices, and according to [**this** ](https://android-developers.googleblog.com/2020/03/run-arm-apps-on-android-emulator.html)**latest x86** versions **support ARM libraries** without needing an slow arm emulator).
* Learn to set it up in this page:

{% content-ref url="avd-android-virtual-device.md" %}
[avd-android-virtual-device.md](avd-android-virtual-device.md)
{% endcontent-ref %}

* [**Genymotion**](https://www.genymotion.com/fun-zone/) **(Free version:** Personal Edition, you need to create an account. _It's recommend to **download** the version **WITH**_ _**VirtualBox** to avoid potential errors._)
* [**Nox**](https://es.bignox.com) (Free, but it doesn't support Frida or Drozer).

{% hint style="info" %}
When creating a new emulator on any platform remember that the bigger the screen is, the slower the emulator will run. So select small screens if possible.
{% endhint %}

To **install google services** (like AppStore) in Genymotion you need to click on the red marked button of the following image:

![](<../../.gitbook/assets/image (277).png>)

Also, notice that in the **configuration of the Android VM in Genymotion** you can select **Bridge Network mode** (this will be useful if you will be connecting to the Android VM from a different VM with the tools).

#### Use a physical device

You need to activate the **debugging** options and it will be cool if you can **root** it:

1. **Settings**.
2. (FromAndroid 8.0) Select **System**.
3. Select **About phone**.
4. Press **Build number** 7 times.
5. Go back and you will find the **Developer options**.

> Once you have installed the application, the first thing you should do is to try it and investigate what does it do, how does it work and get comfortable with it.\
> I will suggest to **perform this initial dynamic analysis using MobSF dynamic analysis + pidcat**, so we will be able to **learn how the application works** while MobSF **captures** a lot of **interesting** **data** you can review later on.

### Unintended Data Leakage

**Logging**

å¼€å‘è€…åº”è¯¥è°¨æ…å…¬å¼€**è°ƒè¯•ä¿¡æ¯**ï¼Œå› ä¸ºè¿™å¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ã€‚æ¨èä½¿ç”¨å·¥å…·[**pidcat**](https://github.com/JakeWharton/pidcat)å’Œ`adb logcat`æ¥ç›‘æ§åº”ç”¨ç¨‹åºæ—¥å¿—ï¼Œä»¥è¯†åˆ«å’Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯ã€‚**Pidcat**å› å…¶æ˜“ç”¨æ€§å’Œå¯è¯»æ€§è€Œå—åˆ°é’çã€‚

{% hint style="warning" %}
æ³¨æ„ï¼Œä»**Android 4.0 åŠæ›´é«˜ç‰ˆæœ¬**å¼€å§‹ï¼Œ**åº”ç”¨ç¨‹åºåªèƒ½è®¿é—®è‡ªå·±çš„æ—¥å¿—**ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºæ— æ³•è®¿é—®å…¶ä»–åº”ç”¨çš„æ—¥å¿—ã€‚\
æ— è®ºå¦‚ä½•ï¼Œä»ç„¶å»ºè®®**ä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯**ã€‚
{% endhint %}

**Copy/Paste Buffer Caching**

Androidçš„**åŸºäºå‰ªè´´æ¿**çš„æ¡†æ¶ä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿå®ç°å¤åˆ¶ç²˜è´´åŠŸèƒ½ï¼Œä½†ä¹Ÿå¸¦æ¥äº†é£é™©ï¼Œå› ä¸º**å…¶ä»–åº”ç”¨ç¨‹åº**å¯ä»¥**è®¿é—®**å‰ªè´´æ¿ï¼Œå¯èƒ½ä¼šæš´éœ²æ•æ„Ÿæ•°æ®ã€‚å¯¹äºåº”ç”¨ç¨‹åºçš„æ•æ„Ÿéƒ¨åˆ†ï¼Œå¦‚ä¿¡ç”¨å¡ä¿¡æ¯ï¼Œè‡³å…³é‡è¦çš„æ˜¯**ç¦ç”¨å¤åˆ¶/ç²˜è´´**åŠŸèƒ½ï¼Œä»¥é˜²æ­¢æ•°æ®æ³„éœ²ã€‚

**Crash Logs**

å¦‚æœåº”ç”¨ç¨‹åº**å´©æºƒ**å¹¶**ä¿å­˜æ—¥å¿—**ï¼Œè¿™äº›æ—¥å¿—å¯èƒ½ä¼šå¸®åŠ©æ”»å‡»è€…ï¼Œç‰¹åˆ«æ˜¯å½“åº”ç”¨ç¨‹åºæ— æ³•è¢«åå‘å·¥ç¨‹æ—¶ã€‚ä¸ºäº†é™ä½è¿™ç§é£é™©ï¼Œé¿å…åœ¨å´©æºƒæ—¶è®°å½•æ—¥å¿—ï¼Œå¦‚æœå¿…é¡»é€šè¿‡ç½‘ç»œä¼ è¾“æ—¥å¿—ï¼Œç¡®ä¿é€šè¿‡SSLé€šé“å‘é€ä»¥ç¡®ä¿å®‰å…¨ã€‚

ä½œä¸ºæ¸—é€æµ‹è¯•è€…ï¼Œ**å°è¯•æŸ¥çœ‹è¿™äº›æ—¥å¿—**ã€‚

**Analytics Data Sent To 3rd Parties**

åº”ç”¨ç¨‹åºé€šå¸¸é›†æˆåƒGoogle Adsenseè¿™æ ·çš„æœåŠ¡ï¼Œè¿™å¯èƒ½ç”±äºå¼€å‘è€…çš„ä¸å½“å®ç°è€Œ**æ³„éœ²æ•æ„Ÿæ•°æ®**ã€‚ä¸ºäº†è¯†åˆ«æ½œåœ¨çš„æ•°æ®æ³„éœ²ï¼Œå»ºè®®**æ‹¦æˆªåº”ç”¨ç¨‹åºçš„æµé‡**å¹¶æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•æ•æ„Ÿä¿¡æ¯è¢«å‘é€åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚

### SQLite DBs

å¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†ä½¿ç”¨**å†…éƒ¨SQLiteæ•°æ®åº“**æ¥ä¿å­˜ä¿¡æ¯ã€‚åœ¨æ¸—é€æµ‹è¯•æœŸé—´ï¼ŒæŸ¥çœ‹åˆ›å»ºçš„**æ•°æ®åº“**ã€**è¡¨**å’Œ**åˆ—**çš„åç§°ä»¥åŠæ‰€æœ‰ä¿å­˜çš„**æ•°æ®**ï¼Œå› ä¸ºä½ å¯èƒ½ä¼šå‘ç°**æ•æ„Ÿä¿¡æ¯**ï¼ˆè¿™å°†æ˜¯ä¸€ä¸ªæ¼æ´ï¼‰ã€‚\
æ•°æ®åº“åº”ä½äº`/data/data/the.package.name/databases`ï¼Œå¦‚`/data/data/com.mwr.example.sieve/databases`

å¦‚æœæ•°æ®åº“ä¿å­˜æœºå¯†ä¿¡æ¯å¹¶ä¸”æ˜¯**åŠ å¯†çš„**ä½†ä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­**æ‰¾åˆ°**å¯†ç ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ª**æ¼æ´**ã€‚

ä½¿ç”¨`.tables`åˆ—å‡ºè¡¨ï¼Œä½¿ç”¨`.schema <table_name>`åˆ—å‡ºè¡¨çš„åˆ—

### Drozer (Exploit Activities, Content Providers and Services)

From [Drozer Docs](https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf): **Drozer** allows you to **assume the role of an Android app** and interact with other apps. It can do **anything that an installed application can do**, such as make use of Androidâ€™s Inter-Process Communication (IPC) mechanism and interact with the underlying operating system. .\
Drozeræ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥**åˆ©ç”¨å¯¼å‡ºæ´»åŠ¨ã€å¯¼å‡ºæœåŠ¡å’Œå†…å®¹æä¾›è€…**ï¼Œæ­£å¦‚ä½ å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­å­¦ä¹ çš„é‚£æ ·ã€‚

### Exploiting exported Activities

[**Read this if you want to refresh what is an Android Activity.**](android-applications-basics.md#launcher-activity-and-other-activities)\
ä¹Ÿè¯·è®°ä½ï¼Œæ´»åŠ¨çš„ä»£ç ä»**`onCreate`**æ–¹æ³•å¼€å§‹ã€‚

**Authorisation bypass**

å½“ä¸€ä¸ªæ´»åŠ¨è¢«å¯¼å‡ºæ—¶ï¼Œä½ å¯ä»¥ä»å¤–éƒ¨åº”ç”¨è°ƒç”¨å®ƒçš„ç•Œé¢ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªåŒ…å«**æ•æ„Ÿä¿¡æ¯**çš„æ´»åŠ¨è¢«**å¯¼å‡º**ï¼Œä½ å¯èƒ½ä¼š**ç»•è¿‡**è®¿é—®å®ƒçš„**è®¤è¯**æœºåˆ¶ã€‚

[**Learn how to exploit exported activities with Drozer.**](drozer-tutorial/#activities)

ä½ ä¹Ÿå¯ä»¥ä»adbå¯åŠ¨ä¸€ä¸ªå¯¼å‡ºçš„æ´»åŠ¨ï¼š

* PackageNameæ˜¯com.example.demo
* Exported ActivityNameæ˜¯com.example.test.MainActivity
```bash
adb shell am start -n com.example.demo/com.example.test.MainActivity
```
**æ³¨æ„**ï¼šMobSFä¼šå°†ä½¿ç”¨_**singleTask/singleInstance**_ä½œä¸ºæ´»åŠ¨ä¸­çš„`android:launchMode`è§†ä¸ºæ¶æ„ï¼Œä½†ç”±äº[è¿™ä¸ª](https://github.com/MobSF/Mobile-Security-Framework-MobSF/pull/750)ï¼Œæ˜¾ç„¶è¿™åœ¨æ—§ç‰ˆæœ¬ï¼ˆAPIç‰ˆæœ¬<21ï¼‰ä¸­æ‰æ˜¯å±é™©çš„ã€‚

{% hint style="info" %}
è¯·æ³¨æ„ï¼Œæˆæƒç»•è¿‡å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªæ¼æ´ï¼Œè¿™å–å†³äºç»•è¿‡çš„å·¥ä½œæ–¹å¼å’Œæš´éœ²çš„ä¿¡æ¯ã€‚
{% endhint %}

**æ•æ„Ÿä¿¡æ¯æ³„éœ²**

**æ´»åŠ¨ä¹Ÿå¯ä»¥è¿”å›ç»“æœ**ã€‚å¦‚æœä½ è®¾æ³•æ‰¾åˆ°ä¸€ä¸ªå¯¼å‡ºä¸”æœªä¿æŠ¤çš„æ´»åŠ¨è°ƒç”¨**`setResult`**æ–¹æ³•å¹¶**è¿”å›æ•æ„Ÿä¿¡æ¯**ï¼Œåˆ™å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

#### Tapjacking

å¦‚æœæ²¡æœ‰é˜²æ­¢tapjackingï¼Œä½ å¯ä»¥åˆ©ç”¨å¯¼å‡ºçš„æ´»åŠ¨ä½¿**ç”¨æˆ·æ‰§è¡Œæ„å¤–æ“ä½œ**ã€‚æœ‰å…³[**ä»€ä¹ˆæ˜¯Tapjackingçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®æ­¤é“¾æ¥**](./#tapjacking)ã€‚

### åˆ©ç”¨å†…å®¹æä¾›è€… - è®¿é—®å’Œæ“çºµæ•æ„Ÿä¿¡æ¯

[**å¦‚æœä½ æƒ³åˆ·æ–°ä»€ä¹ˆæ˜¯å†…å®¹æä¾›è€…ï¼Œè¯·é˜…è¯»æ­¤å†…å®¹ã€‚**](android-applications-basics.md#content-provider)\
å†…å®¹æä¾›è€…åŸºæœ¬ä¸Šç”¨äº**å…±äº«æ•°æ®**ã€‚å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰å¯ç”¨çš„å†…å®¹æä¾›è€…ï¼Œä½ å¯èƒ½èƒ½å¤Ÿ**æå–æ•æ„Ÿ**æ•°æ®ã€‚æµ‹è¯•å¯èƒ½çš„**SQLæ³¨å…¥**å’Œ**è·¯å¾„éå†**ä¹Ÿå¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

[**å­¦ä¹ å¦‚ä½•ä½¿ç”¨Drozeråˆ©ç”¨å†…å®¹æä¾›è€…ã€‚**](drozer-tutorial/#content-providers)

### **åˆ©ç”¨æœåŠ¡**

[**å¦‚æœä½ æƒ³åˆ·æ–°ä»€ä¹ˆæ˜¯æœåŠ¡ï¼Œè¯·é˜…è¯»æ­¤å†…å®¹ã€‚**](android-applications-basics.md#services)\
è¯·è®°ä½ï¼ŒæœåŠ¡çš„æ“ä½œå§‹äºæ–¹æ³•`onStartCommand`ã€‚

æœåŠ¡åŸºæœ¬ä¸Šæ˜¯å¯ä»¥**æ¥æ”¶æ•°æ®**ã€**å¤„ç†**å®ƒå¹¶**è¿”å›**ï¼ˆæˆ–ä¸è¿”å›ï¼‰å“åº”çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¼å‡ºäº†ä¸€äº›æœåŠ¡ï¼Œä½ åº”è¯¥**æ£€æŸ¥**ä»£ç ä»¥äº†è§£å®ƒåœ¨åšä»€ä¹ˆï¼Œå¹¶**åŠ¨æ€æµ‹è¯•**ä»¥æå–æœºå¯†ä¿¡æ¯ã€ç»•è¿‡èº«ä»½éªŒè¯æªæ–½...\
[**å­¦ä¹ å¦‚ä½•ä½¿ç”¨Drozeråˆ©ç”¨æœåŠ¡ã€‚**](drozer-tutorial/#services)

### **åˆ©ç”¨å¹¿æ’­æ¥æ”¶å™¨**

[**å¦‚æœä½ æƒ³åˆ·æ–°ä»€ä¹ˆæ˜¯å¹¿æ’­æ¥æ”¶å™¨ï¼Œè¯·é˜…è¯»æ­¤å†…å®¹ã€‚**](android-applications-basics.md#broadcast-receivers)\
è¯·è®°ä½ï¼Œå¹¿æ’­æ¥æ”¶å™¨çš„æ“ä½œå§‹äºæ–¹æ³•`onReceive`ã€‚

å¹¿æ’­æ¥æ”¶å™¨å°†ç­‰å¾…æŸç§ç±»å‹çš„æ¶ˆæ¯ã€‚æ ¹æ®æ¥æ”¶å™¨å¦‚ä½•å¤„ç†æ¶ˆæ¯ï¼Œå®ƒå¯èƒ½ä¼šå­˜åœ¨æ¼æ´ã€‚\
[**å­¦ä¹ å¦‚ä½•ä½¿ç”¨Drozeråˆ©ç”¨å¹¿æ’­æ¥æ”¶å™¨ã€‚**](./#exploiting-broadcast-receivers)

### **åˆ©ç”¨æ–¹æ¡ˆ/æ·±åº¦é“¾æ¥**

ä½ å¯ä»¥æ‰‹åŠ¨æŸ¥æ‰¾æ·±åº¦é“¾æ¥ï¼Œä½¿ç”¨åƒMobSFè¿™æ ·çš„å·¥å…·æˆ–åƒ[è¿™ä¸ª](https://github.com/ashleykinguk/FBLinkBuilder/blob/master/FBLinkBuilder.py)çš„è„šæœ¬ã€‚\
ä½ å¯ä»¥ä½¿ç”¨**adb**æˆ–**æµè§ˆå™¨**æ‰“å¼€å£°æ˜çš„**æ–¹æ¡ˆ**ï¼š

{% code overflow="wrap" %}
```bash
adb shell am start -a android.intent.action.VIEW -d "scheme://hostname/path?param=value" [your.package.name]
```
{% endcode %}

_è¯·æ³¨æ„ï¼Œæ‚¨å¯ä»¥**çœç•¥åŒ…å**ï¼Œæ‰‹æœºå°†è‡ªåŠ¨è°ƒç”¨åº”è¯¥æ‰“å¼€è¯¥é“¾æ¥çš„åº”ç”¨ç¨‹åºã€‚_

{% code overflow="wrap" %}
```markup
<!-- Browser regular link -->
<a href="scheme://hostname/path?param=value">Click me</a>
<!-- fallback in your url you could try the intent url -->
<a href="intent://hostname#Intent;scheme=scheme;package=your.package.name;S.browser_fallback_url=http%3A%2F%2Fwww.example.com;end">with alternative</a>
```
{% endcode %}

**ä»£ç æ‰§è¡Œ**

ä¸ºäº†æ‰¾åˆ°**å°†åœ¨åº”ç”¨ä¸­æ‰§è¡Œçš„ä»£ç **ï¼Œè¯·è½¬åˆ°ç”±æ·±åº¦é“¾æ¥è°ƒç”¨çš„æ´»åŠ¨ï¼Œå¹¶æœç´¢å‡½æ•°**`onNewIntent`**ã€‚

![](<../../.gitbook/assets/image (436) (1) (1) (1).png>)

**æ•æ„Ÿä¿¡æ¯**

æ¯æ¬¡æ‰¾åˆ°æ·±åº¦é“¾æ¥æ—¶ï¼Œè¯·æ£€æŸ¥**å®ƒæ˜¯å¦é€šè¿‡ URL å‚æ•°æ¥æ”¶æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ï¼‰**ï¼Œå› ä¸ºä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºéƒ½å¯èƒ½**å†’å……æ·±åº¦é“¾æ¥å¹¶çªƒå–è¯¥æ•°æ®ï¼**

**è·¯å¾„ä¸­çš„å‚æ•°**

æ‚¨**è¿˜å¿…é¡»æ£€æŸ¥ä»»ä½•æ·±åº¦é“¾æ¥æ˜¯å¦åœ¨ URL çš„è·¯å¾„ä¸­ä½¿ç”¨å‚æ•°**ï¼Œä¾‹å¦‚ï¼š`https://api.example.com/v1/users/{username}`ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å¼ºåˆ¶è·¯å¾„éå†ï¼Œè®¿é—®ç±»ä¼¼äºï¼š`example://app/users?username=../../unwanted-endpoint%3fparam=value`ã€‚\
è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨åœ¨åº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°æ­£ç¡®çš„ç«¯ç‚¹ï¼Œæ‚¨å¯èƒ½èƒ½å¤Ÿå¯¼è‡´**å¼€æ”¾é‡å®šå‘**ï¼ˆå¦‚æœè·¯å¾„çš„ä¸€éƒ¨åˆ†ç”¨ä½œåŸŸåï¼‰ï¼Œ**è´¦æˆ·æ¥ç®¡**ï¼ˆå¦‚æœæ‚¨å¯ä»¥åœ¨æ²¡æœ‰ CSRF ä»¤ç‰Œçš„æƒ…å†µä¸‹ä¿®æ”¹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ä¸”æ¼æ´ç«¯ç‚¹ä½¿ç”¨äº†æ­£ç¡®çš„æ–¹æ³•ï¼‰ä»¥åŠä»»ä½•å…¶ä»–æ¼æ´ã€‚æ›´å¤š[ä¿¡æ¯åœ¨è¿™é‡Œ](http://dphoeniixx.com/2020/12/13-2/)ã€‚

**æ›´å¤šç¤ºä¾‹**

ä¸€ä¸ª[æœ‰è¶£çš„æ¼æ´èµé‡‘æŠ¥å‘Š](https://hackerone.com/reports/855618)å…³äºé“¾æ¥ (_/.well-known/assetlinks.json_)ã€‚

### ä¼ è¾“å±‚æ£€æŸ¥å’ŒéªŒè¯å¤±è´¥

* **è¯ä¹¦å¹¶ä¸æ€»æ˜¯è¢« Android åº”ç”¨ç¨‹åºæ­£ç¡®æ£€æŸ¥**ã€‚è¿™äº›åº”ç”¨ç¨‹åºå¸¸å¸¸å¿½è§†è­¦å‘Šï¼Œæ¥å—è‡ªç­¾åè¯ä¹¦ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¢å¤ä½¿ç”¨ HTTP è¿æ¥ã€‚
* **SSL/TLS æ¡æ‰‹æœŸé—´çš„åå•†æœ‰æ—¶è¾ƒå¼±**ï¼Œä½¿ç”¨ä¸å®‰å…¨çš„å¯†ç å¥—ä»¶ã€‚æ­¤æ¼æ´ä½¿è¿æ¥å®¹æ˜“å—åˆ°ä¸­é—´äººï¼ˆMITMï¼‰æ”»å‡»ï¼Œå…è®¸æ”»å‡»è€…è§£å¯†æ•°æ®ã€‚
* **ç§å¯†ä¿¡æ¯æ³„éœ²**æ˜¯ä¸€ä¸ªé£é™©ï¼Œå½“åº”ç”¨ç¨‹åºé€šè¿‡å®‰å…¨é€šé“è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä½†éšååœ¨å…¶ä»–äº¤æ˜“ä¸­é€šè¿‡éå®‰å…¨é€šé“è¿›è¡Œé€šä¿¡ã€‚è¿™ç§æ–¹æ³•æœªèƒ½ä¿æŠ¤æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚ä¼šè¯ cookie æˆ–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå…å—æ¶æ„å®ä½“çš„æ‹¦æˆªã€‚

#### è¯ä¹¦éªŒè¯

æˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨**è¯ä¹¦éªŒè¯**ã€‚å¿…é¡»éªŒè¯æœåŠ¡å™¨è¯ä¹¦çš„å®Œæ•´æ€§ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚è¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼Œå› ä¸ºä¸å®‰å…¨çš„ TLS é…ç½®å’Œé€šè¿‡æœªåŠ å¯†é€šé“ä¼ è¾“æ•æ„Ÿæ•°æ®å¯èƒ½ä¼šå¸¦æ¥é‡å¤§é£é™©ã€‚æœ‰å…³éªŒè¯æœåŠ¡å™¨è¯ä¹¦å’Œè§£å†³æ¼æ´çš„è¯¦ç»†æ­¥éª¤ï¼Œ[**æ­¤èµ„æº**](https://manifestsecurity.com/android-application-security-part-10/)æä¾›äº†å…¨é¢çš„æŒ‡å¯¼ã€‚

#### SSL é’‰æ‰

SSL é’‰æ‰æ˜¯ä¸€ç§å®‰å…¨æªæ–½ï¼Œåº”ç”¨ç¨‹åºå°†æœåŠ¡å™¨çš„è¯ä¹¦ä¸å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…éƒ¨çš„å·²çŸ¥å‰¯æœ¬è¿›è¡ŒéªŒè¯ã€‚è¿™ç§æ–¹æ³•å¯¹äºé˜²æ­¢ MITM æ”»å‡»è‡³å…³é‡è¦ã€‚å¼ºçƒˆå»ºè®®å¤„ç†æ•æ„Ÿä¿¡æ¯çš„åº”ç”¨ç¨‹åºå®æ–½ SSL é’‰æ‰ã€‚

#### æµé‡æ£€æŸ¥

è¦æ£€æŸ¥ HTTP æµé‡ï¼Œå¿…é¡»**å®‰è£…ä»£ç†å·¥å…·çš„è¯ä¹¦**ï¼ˆä¾‹å¦‚ï¼ŒBurpï¼‰ã€‚å¦‚æœä¸å®‰è£…æ­¤è¯ä¹¦ï¼Œç»è¿‡ä»£ç†çš„åŠ å¯†æµé‡å¯èƒ½ä¸å¯è§ã€‚æœ‰å…³å®‰è£…è‡ªå®šä¹‰ CA è¯ä¹¦çš„æŒ‡å—ï¼Œ[**è¯·ç‚¹å‡»è¿™é‡Œ**](avd-android-virtual-device.md#install-burp-certificate-on-a-virtual-machine)ã€‚

é’ˆå¯¹**API Level 24 åŠä»¥ä¸Š**çš„åº”ç”¨ç¨‹åºéœ€è¦ä¿®æ”¹ç½‘ç»œå®‰å…¨é…ç½®ä»¥æ¥å—ä»£ç†çš„ CA è¯ä¹¦ã€‚è¿™ä¸€æ­¥å¯¹äºæ£€æŸ¥åŠ å¯†æµé‡è‡³å…³é‡è¦ã€‚æœ‰å…³ä¿®æ”¹ç½‘ç»œå®‰å…¨é…ç½®çš„è¯´æ˜ï¼Œ[**è¯·å‚è€ƒæ­¤æ•™ç¨‹**](make-apk-accept-ca-certificate.md)ã€‚

#### ç»•è¿‡ SSL é’‰æ‰

å½“å®æ–½ SSL é’‰æ‰æ—¶ï¼Œç»•è¿‡å®ƒå˜å¾—å¿…è¦ï¼Œä»¥æ£€æŸ¥ HTTPS æµé‡ã€‚ä¸ºæ­¤æœ‰å¤šç§æ–¹æ³•å¯ç”¨ï¼š

* è‡ªåŠ¨**ä¿®æ”¹** **apk**ä»¥**ç»•è¿‡** SSLPinningï¼Œä½¿ç”¨[**apk-mitm**](https://github.com/shroudedcode/apk-mitm)ã€‚æ­¤é€‰é¡¹çš„æœ€å¤§ä¼˜ç‚¹æ˜¯ï¼Œæ‚¨æ— éœ€ root å³å¯ç»•è¿‡ SSL é’‰æ‰ï¼Œä½†æ‚¨éœ€è¦åˆ é™¤åº”ç”¨ç¨‹åºå¹¶é‡æ–°å®‰è£…æ–°ç‰ˆæœ¬ï¼Œè¿™å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆã€‚
* æ‚¨å¯ä»¥ä½¿ç”¨**Frida**ï¼ˆä¸‹é¢è®¨è®ºï¼‰æ¥ç»•è¿‡æ­¤ä¿æŠ¤ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ Burp+Frida+Genymotion çš„æŒ‡å—ï¼š[https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/](https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/)
* æ‚¨è¿˜å¯ä»¥å°è¯•ä½¿ç”¨[**objection**](frida-tutorial/objection-tutorial.md)**è‡ªåŠ¨ç»•è¿‡ SSL é’‰æ‰**ï¼š`objection --gadget com.package.app explore --startup-command "android sslpinning disable"`
* æ‚¨è¿˜å¯ä»¥å°è¯•ä½¿ç”¨**MobSF åŠ¨æ€åˆ†æ**ï¼ˆä¸‹é¢è§£é‡Šï¼‰**è‡ªåŠ¨ç»•è¿‡ SSL é’‰æ‰**
* å¦‚æœæ‚¨ä»ç„¶è®¤ä¸ºæœ‰ä¸€äº›æµé‡æœªè¢«æ•è·ï¼Œæ‚¨å¯ä»¥å°è¯•**ä½¿ç”¨ iptables å°†æµé‡è½¬å‘åˆ° burp**ã€‚é˜…è¯»æ­¤åšå®¢ï¼š[https://infosecwriteups.com/bypass-ssl-pinning-with-ip-forwarding-iptables-568171b52b62](https://infosecwriteups.com/bypass-ssl-pinning-with-ip-forwarding-iptables-568171b52b62)

#### å¯»æ‰¾å¸¸è§çš„ç½‘ç»œæ¼æ´

åœ¨åº”ç”¨ç¨‹åºä¸­æœç´¢å¸¸è§çš„ç½‘ç»œæ¼æ´ä¹Ÿå¾ˆé‡è¦ã€‚æœ‰å…³è¯†åˆ«å’Œç¼“è§£è¿™äº›æ¼æ´çš„è¯¦ç»†ä¿¡æ¯è¶…å‡ºäº†æœ¬æ‘˜è¦çš„èŒƒå›´ï¼Œä½†åœ¨å…¶ä»–åœ°æ–¹æœ‰å¹¿æ³›çš„è¦†ç›–ã€‚

### Frida

[Frida](https://www.frida.re) æ˜¯ä¸€ä¸ªåŠ¨æ€æ’æ¡©å·¥å…·åŒ…ï¼Œä¾›å¼€å‘äººå‘˜ã€é€†å‘å·¥ç¨‹å¸ˆå’Œå®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚\
**æ‚¨å¯ä»¥è®¿é—®æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºå¹¶åœ¨è¿è¡Œæ—¶æŒ‚é’©æ–¹æ³•ä»¥æ›´æ”¹è¡Œä¸ºã€æ›´æ”¹å€¼ã€æå–å€¼ã€è¿è¡Œä¸åŒçš„ä»£ç ...**\
å¦‚æœæ‚¨æƒ³å¯¹ Android åº”ç”¨ç¨‹åºè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œæ‚¨éœ€è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨ Fridaã€‚

* å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Fridaï¼š[**Frida æ•™ç¨‹**](frida-tutorial/)
* ä¸€äº›ç”¨äº Frida æ“ä½œçš„â€œGUIâ€ï¼š [**https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security**](https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security)
* Ojection éå¸¸é€‚åˆè‡ªåŠ¨åŒ–ä½¿ç”¨ Fridaï¼š[**https://github.com/sensepost/objection**](https://github.com/sensepost/objection) **,** [**https://github.com/dpnishant/appmon**](https://github.com/dpnishant/appmon)
* æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€äº›å¾ˆæ£’çš„ Frida è„šæœ¬ï¼š[**https://codeshare.frida.re/**](https://codeshare.frida.re)
* å°è¯•é€šè¿‡åŠ è½½ Frida ç»•è¿‡åè°ƒè¯•/å Frida æœºåˆ¶ï¼Œå¦‚[https://erfur.github.io/blog/dev/code-injection-without-ptrace](https://erfur.github.io/blog/dev/code-injection-without-ptrace)ä¸­æ‰€ç¤ºï¼ˆå·¥å…·[linjector](https://github.com/erfur/linjector-rs)ï¼‰

### **å†…å­˜è½¬å‚¨ - Fridump**

æ£€æŸ¥åº”ç”¨ç¨‹åºæ˜¯å¦åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸åº”å­˜å‚¨çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚å¯†ç æˆ–åŠ©è®°ç¬¦ã€‚

ä½¿ç”¨[**Fridump3**](https://github.com/rootbsd/fridump3)ï¼Œæ‚¨å¯ä»¥è½¬å‚¨åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼š
```bash
# With PID
python3 fridump3.py -u <PID>

# With name
frida-ps -Uai
python3 fridump3.py -u "<Name>"
```
è¿™å°†æŠŠå†…å­˜è½¬å‚¨åˆ° ./dump æ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨é‚£é‡Œä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„ grepï¼š 

{% code overflow="wrap" %}
```bash
strings * | grep -E "^[a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+$"
```
{% endcode %}

### **Keystoreä¸­çš„æ•æ„Ÿæ•°æ®**

åœ¨Androidä¸­ï¼ŒKeystoreæ˜¯å­˜å‚¨æ•æ„Ÿæ•°æ®çš„æœ€ä½³ä½ç½®ï¼Œç„¶è€Œï¼Œæ‹¥æœ‰è¶³å¤Ÿæƒé™çš„æƒ…å†µä¸‹ä»ç„¶**å¯ä»¥è®¿é—®å®ƒ**ã€‚ç”±äºåº”ç”¨ç¨‹åºå€¾å‘äºåœ¨æ­¤å¤„å­˜å‚¨**æ˜æ–‡æ•æ„Ÿæ•°æ®**ï¼Œå› æ­¤æ¸—é€æµ‹è¯•åº”ä»¥rootç”¨æˆ·èº«ä»½è¿›è¡Œæ£€æŸ¥ï¼Œæˆ–è€…æŸäº›å…·æœ‰ç‰©ç†è®¿é—®æƒé™çš„äººå¯èƒ½èƒ½å¤Ÿçªƒå–è¿™äº›æ•°æ®ã€‚

å³ä½¿åº”ç”¨ç¨‹åºå°†æ•°æ®å­˜å‚¨åœ¨keystoreä¸­ï¼Œæ•°æ®ä¹Ÿåº”è¯¥æ˜¯åŠ å¯†çš„ã€‚

è¦è®¿é—®keystoreä¸­çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨æ­¤Fridaè„šæœ¬ï¼š[https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/tracer-cipher.js](https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/tracer-cipher.js)
```bash
frida -U -f com.example.app -l frida-scripts/tracer-cipher.js
```
### **æŒ‡çº¹/ç”Ÿç‰©è¯†åˆ«ç»•è¿‡**

ä½¿ç”¨ä»¥ä¸‹ Frida è„šæœ¬ï¼Œå¯ä»¥**ç»•è¿‡æŒ‡çº¹è®¤è¯**ï¼ŒAndroid åº”ç”¨å¯èƒ½ä¼šæ‰§è¡Œæ­¤æ“ä½œä»¥**ä¿æŠ¤æŸäº›æ•æ„ŸåŒºåŸŸï¼š**

{% code overflow="wrap" %}
```bash
frida --codeshare krapgras/android-biometric-bypass-update-android-11 -U -f <app.package>
```
{% endcode %}

### **èƒŒæ™¯å›¾åƒ**

å½“æ‚¨å°†åº”ç”¨ç¨‹åºç½®äºåå°æ—¶ï¼ŒAndroid ä¼šå­˜å‚¨åº”ç”¨ç¨‹åºçš„ **å¿«ç…§**ï¼Œä»¥ä¾¿åœ¨æ¢å¤åˆ°å‰å°æ—¶ï¼Œå®ƒä¼šåœ¨åº”ç”¨ç¨‹åºä¹‹å‰å¼€å§‹åŠ è½½å›¾åƒï¼Œå› æ­¤çœ‹èµ·æ¥åº”ç”¨ç¨‹åºåŠ è½½å¾—æ›´å¿«ã€‚

ç„¶è€Œï¼Œå¦‚æœè¿™ä¸ªå¿«ç…§åŒ…å« **æ•æ„Ÿä¿¡æ¯**ï¼Œé‚£ä¹ˆæœ‰æƒé™è®¿é—®å¿«ç…§çš„äººå¯èƒ½ä¼š **çªƒå–è¿™äº›ä¿¡æ¯**ï¼ˆè¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦ root æƒé™æ‰èƒ½è®¿é—®å®ƒï¼‰ã€‚

å¿«ç…§é€šå¸¸å­˜å‚¨åœ¨ï¼š**`/data/system_ce/0/snapshots`**

Android æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡è®¾ç½® FLAG\_SECURE å¸ƒå±€å‚æ•°æ¥ **é˜²æ­¢æˆªå›¾æ•è·**ã€‚ä½¿ç”¨æ­¤æ ‡å¿—æ—¶ï¼Œçª—å£å†…å®¹è¢«è§†ä¸ºå®‰å…¨ï¼Œé˜²æ­¢å…¶å‡ºç°åœ¨æˆªå›¾ä¸­æˆ–åœ¨ä¸å®‰å…¨çš„æ˜¾ç¤ºå™¨ä¸ŠæŸ¥çœ‹ã€‚
```bash
getWindow().setFlags(LayoutParams.FLAG_SECURE, LayoutParams.FLAG_SECURE);
```
### **Android åº”ç”¨åˆ†æå™¨**

æ­¤å·¥å…·å¯ä»¥å¸®åŠ©æ‚¨åœ¨åŠ¨æ€åˆ†ææœŸé—´ç®¡ç†ä¸åŒçš„å·¥å…·ï¼š[https://github.com/NotSoSecure/android\_application\_analyzer](https://github.com/NotSoSecure/android\_application\_analyzer)

### æ„å›¾æ³¨å…¥

å¼€å‘äººå‘˜ç»å¸¸åˆ›å»ºä»£ç†ç»„ä»¶ï¼Œå¦‚æ´»åŠ¨ã€æœåŠ¡å’Œå¹¿æ’­æ¥æ”¶å™¨ï¼Œè¿™äº›ç»„ä»¶å¤„ç†è¿™äº›æ„å›¾å¹¶å°†å…¶ä¼ é€’ç»™ `startActivity(...)` æˆ– `sendBroadcast(...)` ç­‰æ–¹æ³•ï¼Œè¿™å¯èƒ½æ˜¯æœ‰é£é™©çš„ã€‚

å±é™©åœ¨äºå…è®¸æ”»å‡»è€…é€šè¿‡é”™è¯¯å¼•å¯¼è¿™äº›æ„å›¾æ¥è§¦å‘æœªå¯¼å‡ºçš„åº”ç”¨ç»„ä»¶æˆ–è®¿é—®æ•æ„Ÿå†…å®¹æä¾›è€…ã€‚ä¸€ä¸ªæ˜¾è‘—çš„ä¾‹å­æ˜¯ `WebView` ç»„ä»¶é€šè¿‡ `Intent.parseUri(...)` å°† URL è½¬æ¢ä¸º `Intent` å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œå®ƒä»¬ï¼Œè¿™å¯èƒ½å¯¼è‡´æ¶æ„æ„å›¾æ³¨å…¥ã€‚

### é‡è¦è¦ç‚¹

* **æ„å›¾æ³¨å…¥** ç±»ä¼¼äºç½‘ç»œçš„å¼€æ”¾é‡å®šå‘é—®é¢˜ã€‚
* åˆ©ç”¨æ¶‰åŠå°† `Intent` å¯¹è±¡ä½œä¸ºé™„åŠ é¡¹ä¼ é€’ï¼Œè¿™å¯èƒ½è¢«é‡å®šå‘ä»¥æ‰§è¡Œä¸å®‰å…¨çš„æ“ä½œã€‚
* å®ƒå¯ä»¥å°†æœªå¯¼å‡ºçš„ç»„ä»¶å’Œå†…å®¹æä¾›è€…æš´éœ²ç»™æ”»å‡»è€…ã€‚
* `WebView` çš„ URL åˆ° `Intent` çš„è½¬æ¢å¯ä»¥ä¿ƒè¿›æ„å¤–æ“ä½œã€‚

### Android å®¢æˆ·ç«¯ä¾§æ³¨å…¥åŠå…¶ä»–

æ‚¨å¯èƒ½å·²ç»çŸ¥é“è¿™ç§ç±»å‹çš„æ¼æ´æ¥è‡ªç½‘ç»œã€‚æ‚¨å¿…é¡»ç‰¹åˆ«å°å¿ƒ Android åº”ç”¨ä¸­çš„è¿™äº›æ¼æ´ï¼š

* **SQL æ³¨å…¥ï¼š** åœ¨å¤„ç†åŠ¨æ€æŸ¥è¯¢æˆ–å†…å®¹æä¾›è€…æ—¶ï¼Œç¡®ä¿ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ã€‚
* **JavaScript æ³¨å…¥ (XSS)ï¼š** éªŒè¯ä»»ä½• WebViews çš„ JavaScript å’Œæ’ä»¶æ”¯æŒæ˜¯å¦å·²ç¦ç”¨ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰ã€‚ [æ›´å¤šä¿¡æ¯åœ¨è¿™é‡Œ](webview-attacks.md#javascript-enabled)ã€‚
* **æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼š** WebViews åº”ç¦ç”¨å¯¹æ–‡ä»¶ç³»ç»Ÿçš„è®¿é—®ï¼ˆé»˜è®¤å¯ç”¨ï¼‰ - `(webview.getSettings().setAllowFileAccess(false);)`ã€‚ [æ›´å¤šä¿¡æ¯åœ¨è¿™é‡Œ](webview-attacks.md#javascript-enabled)ã€‚
* **æŒä¹…æ€§ Cookieï¼š** åœ¨å¤šä¸ªæƒ…å†µä¸‹ï¼Œå½“ Android åº”ç”¨ç»“æŸä¼šè¯æ—¶ï¼ŒCookie å¹¶æœªè¢«æ’¤é”€ï¼Œç”šè‡³å¯èƒ½è¢«ä¿å­˜åˆ°ç£ç›˜ã€‚
* [**Cookie ä¸­çš„å®‰å…¨æ ‡å¿—**](../../pentesting-web/hacking-with-cookies/#cookies-flags)

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

åŠ å…¥ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼

**é»‘å®¢è§è§£**\
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€ä¸æŒ‘æˆ˜çš„å†…å®¹

**å®æ—¶é»‘å®¢æ–°é—»**\
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ

**æœ€æ–°å…¬å‘Š**\
åŠæ—¶äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘å‘å¸ƒå’Œé‡è¦å¹³å°æ›´æ–°

**åŠ å…¥æˆ‘ä»¬** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ï¼Œä»Šå¤©å°±å¼€å§‹ä¸é¡¶çº§é»‘å®¢åˆä½œï¼

## è‡ªåŠ¨åˆ†æ

### [MobSF](https://github.com/MobSF/Mobile-Security-Framework-MobSF)

**é™æ€åˆ†æ**

![](<../../.gitbook/assets/image (866).png>)

**ä½¿ç”¨æ¼‚äº®çš„åŸºäº Web çš„å‰ç«¯è¿›è¡Œåº”ç”¨ç¨‹åºçš„æ¼æ´è¯„ä¼°**ã€‚æ‚¨è¿˜å¯ä»¥æ‰§è¡ŒåŠ¨æ€åˆ†æï¼ˆä½†æ‚¨éœ€è¦å‡†å¤‡ç¯å¢ƒï¼‰ã€‚
```bash
docker pull opensecurity/mobile-security-framework-mobsf
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest
```
æ³¨æ„ï¼ŒMobSF å¯ä»¥åˆ†æ **Android**(apk)**ã€IOS**(ipa) **å’Œ Windows**(apx) åº”ç”¨ç¨‹åºï¼ˆ_Windows åº”ç”¨ç¨‹åºå¿…é¡»ä»å®‰è£…åœ¨ Windows ä¸»æœºä¸Šçš„ MobSF è¿›è¡Œåˆ†æ_ï¼‰ã€‚\
æ­¤å¤–ï¼Œå¦‚æœæ‚¨åˆ›å»ºä¸€ä¸ªåŒ…å« **Android** æˆ– **IOS** åº”ç”¨ç¨‹åºæºä»£ç çš„ **ZIP** æ–‡ä»¶ï¼ˆè½¬åˆ°åº”ç”¨ç¨‹åºçš„æ ¹æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©æ‰€æœ‰å†…å®¹å¹¶åˆ›å»ºä¸€ä¸ª ZIP æ–‡ä»¶ï¼‰ï¼Œå®ƒä¹Ÿèƒ½å¤Ÿåˆ†æå®ƒã€‚

MobSF è¿˜å…è®¸æ‚¨è¿›è¡Œ **diff/æ¯”è¾ƒ** åˆ†æï¼Œå¹¶é›†æˆ **VirusTotal**ï¼ˆæ‚¨éœ€è¦åœ¨ _MobSF/settings.py_ ä¸­è®¾ç½®æ‚¨çš„ API å¯†é’¥å¹¶å¯ç”¨å®ƒï¼š`VT_ENABLED = TRUE` `VT_API_KEY = <Your API key>` `VT_UPLOAD = TRUE`ï¼‰ã€‚æ‚¨è¿˜å¯ä»¥å°† `VT_UPLOAD` è®¾ç½®ä¸º `False`ï¼Œé‚£ä¹ˆ **hash** å°†è¢« **ä¸Šä¼ ** è€Œä¸æ˜¯æ–‡ä»¶ã€‚

### ä½¿ç”¨ MobSF è¿›è¡Œè¾…åŠ©åŠ¨æ€åˆ†æ

**MobSF** å¯¹äº **Android** çš„ **åŠ¨æ€åˆ†æ** ä¹Ÿéå¸¸æœ‰å¸®åŠ©ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦åœ¨ä¸»æœºä¸Šå®‰è£… MobSF å’Œ **genymotion**ï¼ˆè™šæ‹Ÿæœºæˆ– Docker ä¸ä¼šå·¥ä½œï¼‰ã€‚_æ³¨æ„ï¼šæ‚¨éœ€è¦ **å…ˆåœ¨ genymotion ä¸­å¯åŠ¨è™šæ‹Ÿæœº**ï¼Œç„¶å **å†å¯åŠ¨ MobSFã€‚**_\
**MobSF åŠ¨æ€åˆ†æå™¨** å¯ä»¥ï¼š

* **è½¬å‚¨åº”ç”¨ç¨‹åºæ•°æ®**ï¼ˆURLsã€æ—¥å¿—ã€å‰ªè´´æ¿ã€æ‚¨æ‹æ‘„çš„å±å¹•æˆªå›¾ã€ç”± "**Exported Activity Tester**" æ‹æ‘„çš„å±å¹•æˆªå›¾ã€ç”µå­é‚®ä»¶ã€SQLite æ•°æ®åº“ã€XML æ–‡ä»¶å’Œå…¶ä»–åˆ›å»ºçš„æ–‡ä»¶ï¼‰ã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œé™¤äº†å±å¹•æˆªå›¾ï¼Œæ‚¨éœ€è¦åœ¨æƒ³è¦æˆªå›¾æ—¶æŒ‰ä¸‹ï¼Œæˆ–è€…æ‚¨éœ€è¦æŒ‰ "**Exported Activity Tester**" ä»¥è·å–æ‰€æœ‰å¯¼å‡ºæ´»åŠ¨çš„å±å¹•æˆªå›¾ã€‚
* æ•è· **HTTPS æµé‡**
* ä½¿ç”¨ **Frida** è·å– **è¿è¡Œæ—¶** **ä¿¡æ¯**

ä» Android **ç‰ˆæœ¬ > 5** å¼€å§‹ï¼Œå®ƒå°† **è‡ªåŠ¨å¯åŠ¨ Frida** å¹¶è®¾ç½®å…¨å±€ **ä»£ç†** è®¾ç½®ä»¥ **æ•è·** æµé‡ã€‚å®ƒåªä¼šæ•è·è¢«æµ‹è¯•åº”ç”¨ç¨‹åºçš„æµé‡ã€‚

**Frida**

é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒè¿˜å°†ä½¿ç”¨ä¸€äº› Frida è„šæœ¬æ¥ **ç»•è¿‡ SSL é’‰æ‰**ã€**æ ¹æ£€æµ‹** å’Œ **è°ƒè¯•å™¨æ£€æµ‹**ï¼Œå¹¶ **ç›‘æ§æœ‰è¶£çš„ API**ã€‚\
MobSF è¿˜å¯ä»¥ **è°ƒç”¨å¯¼å‡ºæ´»åŠ¨**ï¼ŒæŠ“å–å®ƒä»¬çš„ **å±å¹•æˆªå›¾** å¹¶ **ä¿å­˜** åˆ°æŠ¥å‘Šä¸­ã€‚

è¦ **å¼€å§‹** åŠ¨æ€æµ‹è¯•ï¼Œè¯·æŒ‰ç»¿è‰²æŒ‰é’®ï¼šâ€œ**å¼€å§‹ä»ªå™¨åŒ–**â€ã€‚æŒ‰ä¸‹â€œ**Frida å®æ—¶æ—¥å¿—**â€ä»¥æŸ¥çœ‹ Frida è„šæœ¬ç”Ÿæˆçš„æ—¥å¿—ï¼ŒæŒ‰ä¸‹â€œ**å®æ—¶ API ç›‘è§†å™¨**â€ä»¥æŸ¥çœ‹æ‰€æœ‰è°ƒç”¨çš„æŒ‚é’©æ–¹æ³•ã€ä¼ é€’çš„å‚æ•°å’Œè¿”å›å€¼ï¼ˆåœ¨æŒ‰ä¸‹â€œå¼€å§‹ä»ªå™¨åŒ–â€åä¼šå‡ºç°ï¼‰ã€‚\
MobSF è¿˜å…è®¸æ‚¨åŠ è½½è‡ªå·±çš„ **Frida è„šæœ¬**ï¼ˆè¦å°†æ‚¨çš„ Frida è„šæœ¬çš„ç»“æœå‘é€åˆ° MobSFï¼Œè¯·ä½¿ç”¨å‡½æ•° `send()`ï¼‰ã€‚å®ƒè¿˜å…·æœ‰ **å¤šä¸ªé¢„ç¼–å†™çš„è„šæœ¬**ï¼Œæ‚¨å¯ä»¥åŠ è½½ï¼ˆæ‚¨å¯ä»¥åœ¨ `MobSF/DynamicAnalyzer/tools/frida_scripts/others/` ä¸­æ·»åŠ æ›´å¤šï¼‰ï¼Œåªéœ€ **é€‰æ‹©å®ƒä»¬**ï¼ŒæŒ‰â€œ**åŠ è½½**â€å¹¶æŒ‰â€œ**å¼€å§‹ä»ªå™¨åŒ–**â€ï¼ˆæ‚¨å°†èƒ½å¤Ÿåœ¨â€œ**Frida å®æ—¶æ—¥å¿—**â€ä¸­çœ‹åˆ°è¯¥è„šæœ¬çš„æ—¥å¿—ï¼‰ã€‚

![](<../../.gitbook/assets/image (419).png>)

æ­¤å¤–ï¼Œæ‚¨è¿˜æœ‰ä¸€äº›è¾…åŠ© Frida åŠŸèƒ½ï¼š

* **æšä¸¾å·²åŠ è½½çš„ç±»**ï¼šå®ƒå°†æ‰“å°æ‰€æœ‰å·²åŠ è½½çš„ç±»
* **æ•è·å­—ç¬¦ä¸²**ï¼šå®ƒå°†æ‰“å°åœ¨ä½¿ç”¨åº”ç”¨ç¨‹åºæ—¶æ•è·çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼ˆéå¸¸å˜ˆæ‚ï¼‰
* **æ•è·å­—ç¬¦ä¸²æ¯”è¾ƒ**ï¼šå¯èƒ½éå¸¸æœ‰ç”¨ã€‚å®ƒå°† **æ˜¾ç¤ºæ­£åœ¨æ¯”è¾ƒçš„ä¸¤ä¸ªå­—ç¬¦ä¸²** ä»¥åŠç»“æœæ˜¯ True è¿˜æ˜¯ Falseã€‚
* **æšä¸¾ç±»æ–¹æ³•**ï¼šè¾“å…¥ç±»åï¼ˆå¦‚ "java.io.File"ï¼‰ï¼Œå®ƒå°†æ‰“å°è¯¥ç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚
* **æœç´¢ç±»æ¨¡å¼**ï¼šæŒ‰æ¨¡å¼æœç´¢ç±»
* **è·Ÿè¸ªç±»æ–¹æ³•**ï¼š**è·Ÿè¸ª** ä¸€ä¸ª **æ•´ä¸ªç±»**ï¼ˆæŸ¥çœ‹è¯¥ç±»æ‰€æœ‰æ–¹æ³•çš„è¾“å…¥å’Œè¾“å‡ºï¼‰ã€‚è¯·è®°ä½ï¼Œé»˜è®¤æƒ…å†µä¸‹ MobSF è·Ÿè¸ªå‡ ä¸ªæœ‰è¶£çš„ Android API æ–¹æ³•ã€‚

ä¸€æ—¦æ‚¨é€‰æ‹©äº†è¦ä½¿ç”¨çš„è¾…åŠ©æ¨¡å—ï¼Œæ‚¨éœ€è¦æŒ‰â€œ**å¼€å§‹ä»ªå™¨åŒ–**â€ï¼Œæ‚¨å°†çœ‹åˆ°æ‰€æœ‰è¾“å‡ºåœ¨â€œ**Frida å®æ—¶æ—¥å¿—**â€ä¸­ã€‚

**Shell**

Mobsf è¿˜ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªå¸¦æœ‰ä¸€äº› **adb** å‘½ä»¤ã€**MobSF å‘½ä»¤** å’Œå¸¸è§ **shell** **å‘½ä»¤** çš„ shellï¼Œä½äºåŠ¨æ€åˆ†æé¡µé¢çš„åº•éƒ¨ã€‚ä¸€äº›æœ‰è¶£çš„å‘½ä»¤ï¼š
```bash
help
shell ls
activities
exported_activities
services
receivers
```
**HTTPå·¥å…·**

å½“HTTPæµé‡è¢«æ•è·æ—¶ï¼Œæ‚¨å¯ä»¥åœ¨â€œ**HTTP(S) Traffic**â€åº•éƒ¨çœ‹åˆ°æ•è·æµé‡çš„ä¸‘é™‹è§†å›¾ï¼Œæˆ–è€…åœ¨â€œ**Start HTTPTools**â€ç»¿è‰²æŒ‰é’®ä¸­çœ‹åˆ°æ›´å¥½çš„è§†å›¾ã€‚ä»ç¬¬äºŒä¸ªé€‰é¡¹ä¸­ï¼Œæ‚¨å¯ä»¥**å‘é€**æ•è·çš„**è¯·æ±‚**åˆ°åƒBurpæˆ–Owasp ZAPè¿™æ ·çš„**ä»£ç†**ã€‚\
è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œ_æ‰“å¼€Burp -->_ _å…³é—­æ‹¦æˆª --> åœ¨MobSB HTTPToolsä¸­é€‰æ‹©è¯·æ±‚_ --> æŒ‰ä¸‹â€œ**Send to Fuzzer**â€ --> _é€‰æ‹©ä»£ç†åœ°å€_ ([http://127.0.0.1:8080\\](http://127.0.0.1:8080))ã€‚

å®ŒæˆMobSFçš„åŠ¨æ€åˆ†æåï¼Œæ‚¨å¯ä»¥æŒ‰â€œ**Start Web API Fuzzer**â€æ¥**æ¨¡ç³ŠHTTPè¯·æ±‚**å¹¶å¯»æ‰¾æ¼æ´ã€‚

{% hint style="info" %}
åœ¨ä½¿ç”¨MobSFè¿›è¡ŒåŠ¨æ€åˆ†æåï¼Œä»£ç†è®¾ç½®å¯èƒ½ä¼šé…ç½®é”™è¯¯ï¼Œæ‚¨å°†æ— æ³•ä»GUIä¸­ä¿®å¤å®ƒä»¬ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®å¤ä»£ç†è®¾ç½®ï¼š
```
adb shell settings put global http_proxy :0
```
{% endhint %}

### Assisted Dynamic Analysis with Inspeckage

æ‚¨å¯ä»¥ä» [**Inspeckage**](https://github.com/ac-pm/Inspeckage) è·å–è¯¥å·¥å…·ã€‚\
è¯¥å·¥å…·å°†ä½¿ç”¨ä¸€äº› **Hooks** è®©æ‚¨äº†è§£ **åœ¨åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿäº†ä»€ä¹ˆ**ï¼ŒåŒæ—¶æ‚¨æ‰§è¡Œ **åŠ¨æ€åˆ†æ**ã€‚

### [Yaazhini](https://www.vegabird.com/yaazhini/)

è¿™æ˜¯ä¸€ä¸ª **ä½¿ç”¨ GUI è¿›è¡Œé™æ€åˆ†æçš„å¥½å·¥å…·**

![](<../../.gitbook/assets/image (741).png>)

### [Qark](https://github.com/linkedin/qark)

è¯¥å·¥å…·æ—¨åœ¨æŸ¥æ‰¾å¤šä¸ª **ä¸å®‰å…¨ç›¸å…³çš„ Android åº”ç”¨ç¨‹åºæ¼æ´**ï¼Œæ— è®ºæ˜¯åœ¨ **æºä»£ç ** è¿˜æ˜¯ **æ‰“åŒ…çš„ APK** ä¸­ã€‚è¯¥å·¥å…·è¿˜ **èƒ½å¤Ÿåˆ›å»ºå¯éƒ¨ç½²çš„ "æ¦‚å¿µéªŒè¯" APK** å’Œ **ADB å‘½ä»¤**ï¼Œä»¥åˆ©ç”¨ä¸€äº›å‘ç°çš„æ¼æ´ï¼ˆæš´éœ²çš„æ´»åŠ¨ã€æ„å›¾ã€tapjacking...ï¼‰ã€‚ä¸ Drozer ä¸€æ ·ï¼Œæ— éœ€å¯¹æµ‹è¯•è®¾å¤‡è¿›è¡Œ rootã€‚
```bash
pip3 install --user qark  # --user is only needed if not using a virtualenv
qark --apk path/to/my.apk
qark --java path/to/parent/java/folder
qark --java path/to/specific/java/file.java
```
### [**ReverseAPK**](https://github.com/1N3/ReverseAPK.git)

* æ˜¾ç¤ºæ‰€æœ‰æå–çš„æ–‡ä»¶ä»¥ä¾¿äºå‚è€ƒ
* è‡ªåŠ¨å°†APKæ–‡ä»¶åç¼–è¯‘ä¸ºJavaå’ŒSmaliæ ¼å¼
* åˆ†æAndroidManifest.xmlä»¥æŸ¥æ‰¾å¸¸è§æ¼æ´å’Œè¡Œä¸º
* å¯¹å¸¸è§æ¼æ´å’Œè¡Œä¸ºè¿›è¡Œé™æ€æºä»£ç åˆ†æ
* è®¾å¤‡ä¿¡æ¯
* ä»¥åŠæ›´å¤š
```bash
reverse-apk relative/path/to/APP.apk
```
### [SUPER Android Analyzer](https://github.com/SUPERAndroidAnalyzer/super)

SUPER æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ Windowsã€MacOS X å’Œ Linux ä¸­ä½¿ç”¨çš„å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œæ—¨åœ¨åˆ†æ _.apk_ æ–‡ä»¶ä»¥å¯»æ‰¾æ¼æ´ã€‚å®ƒé€šè¿‡è§£å‹ APK å¹¶åº”ç”¨ä¸€ç³»åˆ—è§„åˆ™æ¥æ£€æµ‹è¿™äº›æ¼æ´ã€‚

æ‰€æœ‰è§„åˆ™éƒ½é›†ä¸­åœ¨ä¸€ä¸ª `rules.json` æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå…¬å¸æˆ–æµ‹è¯•äººå‘˜éƒ½å¯ä»¥åˆ›å»ºè‡ªå·±çš„è§„åˆ™æ¥åˆ†æä»–ä»¬æ‰€éœ€çš„å†…å®¹ã€‚

ä» [ä¸‹è½½é¡µé¢](https://superanalyzer.rocks/download.html) ä¸‹è½½æœ€æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
```
super-analyzer {apk_file}
```
### [StaCoAn](https://github.com/vincentcox/StaCoAn)

![](<../../.gitbook/assets/image (297).png>)

StaCoAn æ˜¯ä¸€ä¸ª **è·¨å¹³å°** å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…ã€æ¼æ´èµé‡‘çŒäººå’Œé“å¾·é»‘å®¢å¯¹ç§»åŠ¨åº”ç”¨ç¨‹åºè¿›è¡Œ [é™æ€ä»£ç åˆ†æ](https://en.wikipedia.org/wiki/Static\_program\_analysis)ã€‚

å…¶æ¦‚å¿µæ˜¯å°†æ‚¨çš„ç§»åŠ¨åº”ç”¨ç¨‹åºæ–‡ä»¶ï¼ˆ.apk æˆ– .ipa æ–‡ä»¶ï¼‰æ‹–æ”¾åˆ° StaCoAn åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒå°†ä¸ºæ‚¨ç”Ÿæˆä¸€ä¸ªå¯è§†åŒ–å’Œä¾¿æºçš„æŠ¥å‘Šã€‚æ‚¨å¯ä»¥è°ƒæ•´è®¾ç½®å’Œè¯æ±‡è¡¨ï¼Œä»¥è·å¾—å®šåˆ¶çš„ä½“éªŒã€‚

ä¸‹è½½ [æœ€æ–°ç‰ˆæœ¬](https://github.com/vincentcox/StaCoAn/releases):
```
./stacoan
```
### [AndroBugs](https://github.com/AndroBugs/AndroBugs\_Framework)

AndroBugs Framework æ˜¯ä¸€ä¸ª Android æ¼æ´åˆ†æç³»ç»Ÿï¼Œå¸®åŠ©å¼€å‘è€…æˆ–é»‘å®¢å‘ç° Android åº”ç”¨ä¸­çš„æ½œåœ¨å®‰å…¨æ¼æ´ã€‚\
[Windows releases](https://github.com/AndroBugs/AndroBugs\_Framework/releases)
```
python androbugs.py -f [APK file]
androbugs.exe -f [APK file]
```
### [Androwarn](https://github.com/maaaaz/androwarn)

**Androwarn** æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯æ£€æµ‹å¹¶è­¦å‘Šç”¨æˆ·å…³äº Android åº”ç”¨ç¨‹åºå¯èƒ½å­˜åœ¨çš„æ¶æ„è¡Œä¸ºã€‚

æ£€æµ‹æ˜¯é€šè¿‡å¯¹åº”ç”¨ç¨‹åºçš„ Dalvik å­—èŠ‚ç è¿›è¡Œ **é™æ€åˆ†æ** æ¥å®Œæˆçš„ï¼Œè¯¥å­—èŠ‚ç ä»¥ **Smali** å½¢å¼è¡¨ç¤ºï¼Œä½¿ç”¨ [`androguard`](https://github.com/androguard/androguard) åº“ã€‚

è¯¥å·¥å…·å¯»æ‰¾ **â€œåâ€ åº”ç”¨ç¨‹åºçš„å¸¸è§è¡Œä¸º**ï¼Œä¾‹å¦‚ï¼šç”µè¯æ ‡è¯†ç¬¦å¤–æ³„ã€éŸ³é¢‘/è§†é¢‘æµæ‹¦æˆªã€PIM æ•°æ®ä¿®æ”¹ã€ä»»æ„ä»£ç æ‰§è¡Œ...
```
python androwarn.py -i my_application_to_be_analyzed.apk -r html -v 3
```
### [MARA Framework](https://github.com/xtiankisutsa/MARA\_Framework)

![](<../../.gitbook/assets/image (595).png>)

**MARA** æ˜¯ä¸€ä¸ª **M**obile **A**pplication **R**everse engineering å’Œ **A**nalysis Frameworkã€‚å®ƒæ˜¯ä¸€ä¸ªå°†å¸¸ç”¨çš„ç§»åŠ¨åº”ç”¨ç¨‹åºé€†å‘å·¥ç¨‹å’Œåˆ†æå·¥å…·æ•´åˆåœ¨ä¸€èµ·çš„å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©æµ‹è¯•ç§»åŠ¨åº”ç”¨ç¨‹åºä»¥åº”å¯¹ OWASP ç§»åŠ¨å®‰å…¨å¨èƒã€‚å…¶ç›®æ ‡æ˜¯ä½¿è¿™ä¸€ä»»åŠ¡å¯¹ç§»åŠ¨åº”ç”¨ç¨‹åºå¼€å‘è€…å’Œå®‰å…¨ä¸“ä¸šäººå‘˜æ›´åŠ ç®€å•å’Œå‹å¥½ã€‚

å®ƒèƒ½å¤Ÿï¼š

* ä½¿ç”¨ä¸åŒå·¥å…·æå– Java å’Œ Smali ä»£ç 
* ä½¿ç”¨ä»¥ä¸‹å·¥å…·åˆ†æ APKï¼š [smalisca](https://github.com/dorneanu/smalisca), [ClassyShark](https://github.com/google/android-classyshark), [androbugs](https://github.com/AndroBugs/AndroBugs\_Framework), [androwarn](https://github.com/maaaaz/androwarn), [APKiD](https://github.com/rednaga/APKiD)
* ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä» APK ä¸­æå–ç§äººä¿¡æ¯ã€‚
* åˆ†æ Manifestã€‚
* ä½¿ç”¨ä»¥ä¸‹å·¥å…·åˆ†æå‘ç°çš„åŸŸï¼š [pyssltest](https://github.com/moheshmohan/pyssltest), [testssl](https://github.com/drwetter/testssl.sh) å’Œ [whatweb](https://github.com/urbanadventurer/WhatWeb)
* é€šè¿‡ [apk-deguard.com](http://www.apk-deguard.com) è¿›è¡Œ APK çš„å»æ··æ·†ã€‚

### Koodous

ç”¨äºæ£€æµ‹æ¶æ„è½¯ä»¶ï¼š [https://koodous.com/](https://koodous.com)

## æ··æ·†/å»æ··æ·†ä»£ç 

è¯·æ³¨æ„ï¼Œå…·ä½“å–å†³äºæ‚¨ç”¨äºæ··æ·†ä»£ç çš„æœåŠ¡å’Œé…ç½®ã€‚ç§˜å¯†å¯èƒ½ä¼šè¢«æ··æ·†æˆ–ä¸è¢«æ··æ·†ã€‚

### [ProGuard](https://en.wikipedia.org/wiki/ProGuard\_\(software\))

æ¥è‡ª [Wikipedia](https://en.wikipedia.org/wiki/ProGuard\_\(software\))ï¼š**ProGuard** æ˜¯ä¸€ä¸ªå¼€æºå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç¼©å°ã€ä¼˜åŒ–å’Œæ··æ·† Java ä»£ç ã€‚å®ƒèƒ½å¤Ÿä¼˜åŒ–å­—èŠ‚ç ï¼Œå¹¶æ£€æµ‹å’Œåˆ é™¤æœªä½¿ç”¨çš„æŒ‡ä»¤ã€‚ProGuard æ˜¯è‡ªç”±è½¯ä»¶ï¼ŒæŒ‰ç…§ GNU é€šç”¨å…¬å…±è®¸å¯è¯ç¬¬ 2 ç‰ˆåˆ†å‘ã€‚

ProGuard ä½œä¸º Android SDK çš„ä¸€éƒ¨åˆ†åˆ†å‘ï¼Œå¹¶åœ¨ä»¥å‘å¸ƒæ¨¡å¼æ„å»ºåº”ç”¨ç¨‹åºæ—¶è¿è¡Œã€‚

### [DexGuard](https://www.guardsquare.com/dexguard)

åœ¨ [https://blog.lexfo.fr/dexguard.html](https://blog.lexfo.fr/dexguard.html) æ‰¾åˆ°é€æ­¥æŒ‡å—ä»¥å»æ··æ·† apkã€‚

ï¼ˆæ¥è‡ªè¯¥æŒ‡å—ï¼‰ä¸Šæ¬¡æˆ‘ä»¬æ£€æŸ¥æ—¶ï¼ŒDexguard çš„æ“ä½œæ¨¡å¼æ˜¯ï¼š

* å°†èµ„æºåŠ è½½ä¸º InputStreamï¼›
* å°†ç»“æœä¼ é€’ç»™ç»§æ‰¿è‡ª FilterInputStream çš„ç±»ä»¥è§£å¯†ï¼›
* è¿›è¡Œä¸€äº›æ— ç”¨çš„æ··æ·†ï¼Œä»¥æµªè´¹åå‘å·¥ç¨‹å¸ˆå‡ åˆ†é’Ÿçš„æ—¶é—´ï¼›
* å°†è§£å¯†çš„ç»“æœä¼ é€’ç»™ ZipInputStream ä»¥è·å– DEX æ–‡ä»¶ï¼›
* æœ€åä½¿ç”¨ `loadDex` æ–¹æ³•å°†ç»“æœ DEX åŠ è½½ä¸ºèµ„æºã€‚

### [DeGuard](http://apk-deguard.com)

**DeGuard é€†è½¬äº† Android æ··æ·†å·¥å…·æ‰§è¡Œçš„æ··æ·†è¿‡ç¨‹ã€‚è¿™ä½¿å¾—è¿›è¡Œå¤šç§å®‰å…¨åˆ†ææˆä¸ºå¯èƒ½ï¼ŒåŒ…æ‹¬ä»£ç æ£€æŸ¥å’Œé¢„æµ‹åº“ã€‚**

æ‚¨å¯ä»¥å°†æ··æ·†çš„ APK ä¸Šä¼ åˆ°ä»–ä»¬çš„å¹³å°ã€‚

### [Simplify](https://github.com/CalebFenton/simplify)

å®ƒæ˜¯ä¸€ä¸ª **é€šç”¨çš„ Android å»æ··æ·†å·¥å…·ã€‚** Simplify **è™šæ‹Ÿæ‰§è¡Œåº”ç”¨ç¨‹åº** ä»¥ç†è§£å…¶è¡Œä¸ºï¼Œç„¶å **å°è¯•ä¼˜åŒ–ä»£ç ** ä½¿å…¶è¡¨ç°ç›¸åŒï¼Œä½†æ›´æ˜“äºäººç±»ç†è§£ã€‚æ¯ç§ä¼˜åŒ–ç±»å‹éƒ½ç®€å•ä¸”é€šç”¨ï¼Œå› æ­¤æ— è®ºä½¿ç”¨ä½•ç§ç‰¹å®šç±»å‹çš„æ··æ·†éƒ½æ— å…³ç´§è¦ã€‚

### [APKiD](https://github.com/rednaga/APKiD)

APKiD æä¾›æœ‰å…³ **APK åˆ¶ä½œæ–¹å¼** çš„ä¿¡æ¯ã€‚å®ƒè¯†åˆ«è®¸å¤š **ç¼–è¯‘å™¨**ã€**æ‰“åŒ…å™¨**ã€**æ··æ·†å™¨** å’Œå…¶ä»–å¥‡æ€ªçš„ä¸œè¥¿ã€‚å®ƒæ˜¯ Android çš„ [_PEiD_](https://www.aldeid.com/wiki/PEiD)ã€‚

### æ‰‹åŠ¨

[é˜…è¯»æœ¬æ•™ç¨‹ä»¥å­¦ä¹ ä¸€äº›å…³äº **å¦‚ä½•é€†å‘è‡ªå®šä¹‰æ··æ·†** çš„æŠ€å·§](manual-deobfuscation.md)

## å®éªŒå®¤

### [Androl4b](https://github.com/sh4hin/Androl4b)

AndroL4b æ˜¯ä¸€ä¸ªåŸºäº ubuntu-mate çš„ Android å®‰å…¨è™šæ‹Ÿæœºï¼ŒåŒ…å«æ¥è‡ªä¸åŒå®‰å…¨æå®¢å’Œç ”ç©¶äººå‘˜çš„æœ€æ–°æ¡†æ¶ã€æ•™ç¨‹å’Œå®éªŒå®¤ï¼Œç”¨äºé€†å‘å·¥ç¨‹å’Œæ¶æ„è½¯ä»¶åˆ†æã€‚

## å‚è€ƒèµ„æ–™

* [https://owasp.org/www-project-mobile-app-security/](https://owasp.org/www-project-mobile-app-security/)
* [https://appsecwiki.com/#/](https://appsecwiki.com/#/) è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ„æºåˆ—è¡¨
* [https://maddiestone.github.io/AndroidAppRE/](https://maddiestone.github.io/AndroidAppRE/) Android å¿«é€Ÿè¯¾ç¨‹
* [https://manifestsecurity.com/android-application-security/](https://manifestsecurity.com/android-application-security/)
* [https://github.com/Ralireza/Android-Security-Teryaagh](https://github.com/Ralireza/Android-Security-Teryaagh)
* [https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec](https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec)

## å°šå¾…å°è¯•

* [https://www.vegabird.com/yaazhini/](https://www.vegabird.com/yaazhini/)
* [https://github.com/abhi-r3v0/Adhrit](https://github.com/abhi-r3v0/Adhrit)

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

åŠ å…¥ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼

**é»‘å®¢è§è§£**\
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€å’ŒæŒ‘æˆ˜çš„å†…å®¹

**å®æ—¶é»‘å®¢æ–°é—»**\
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ

**æœ€æ–°å…¬å‘Š**\
åŠæ—¶äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘è®¡åˆ’å’Œé‡è¦å¹³å°æ›´æ–°

**åŠ å…¥æˆ‘ä»¬** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ï¼Œä»Šå¤©å°±å¼€å§‹ä¸é¡¶çº§é»‘å®¢åˆä½œï¼

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨ Twitter ä¸Šå…³æ³¨** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
