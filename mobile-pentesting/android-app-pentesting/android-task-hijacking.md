# Android Task Hijacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## GÃ¶rev, Geri YÄ±ÄŸÄ±n ve Ã–n Plan Aktiviteleri

Android'de, bir **gÃ¶rev**, kullanÄ±cÄ±larÄ±n belirli bir iÅŸi tamamlamak iÃ§in etkileÅŸimde bulunduÄŸu aktivitelerin bir setidir ve bir **geri yÄ±ÄŸÄ±n** iÃ§inde organize edilmiÅŸtir. Bu yÄ±ÄŸÄ±n, aktiviteleri aÃ§Ä±ldÄ±klarÄ± zamana gÃ¶re sÄ±ralar; en son aÃ§Ä±lan aktivite en Ã¼stte **Ã¶n plan aktivitesi** olarak gÃ¶rÃ¼ntÃ¼lenir. Her an, yalnÄ±zca bu aktivite ekranda gÃ¶rÃ¼nÃ¼r, bu da onu **Ã¶n plan gÃ¶revi**nin bir parÃ§asÄ± yapar.

Aktivite geÃ§iÅŸlerinin hÄ±zlÄ± bir Ã¶zeti:

* **Aktivite 1**, Ã¶n planda tek aktivite olarak baÅŸlar.
* **Aktivite 2**'yi baÅŸlatmak, **Aktivite 1**'i geri yÄ±ÄŸÄ±na iterek **Aktivite 2**'yi Ã¶n plana getirir.
* **Aktivite 3**'Ã¼ baÅŸlatmak, **Aktivite 1** ve **Aktivite 2**'yi yÄ±ÄŸÄ±nda daha geriye taÅŸÄ±r, **Aktivite 3** ÅŸimdi Ã¶n plandadÄ±r.
* **Aktivite 3**'Ã¼ kapatmak, **Aktivite 2**'yi tekrar Ã¶n plana getirir ve Android'in akÄ±cÄ± gÃ¶rev navigasyon mekanizmasÄ±nÄ± sergiler.

![https://developer.android.com/images/fundamentals/diagram\_backstack.png](<../../.gitbook/assets/image (698).png>)

## GÃ¶rev baÄŸlÄ±lÄ±ÄŸÄ± saldÄ±rÄ±sÄ±

### GÃ¶rev BaÄŸlÄ±lÄ±ÄŸÄ± ve BaÅŸlatma ModlarÄ± Genel GÃ¶rÃ¼nÃ¼mÃ¼

Android uygulamalarÄ±nda, **gÃ¶rev baÄŸlÄ±lÄ±ÄŸÄ±**, bir aktivitenin tercih edilen gÃ¶revini belirtir ve genellikle uygulamanÄ±n paket adÄ±yla uyumludur. Bu yapÄ±, saldÄ±rÄ±yÄ± gÃ¶stermek iÃ§in bir kanÄ±t konsepti (PoC) uygulamasÄ± oluÅŸturmakta Ã¶nemlidir.

### BaÅŸlatma ModlarÄ±

`launchMode` niteliÄŸi, gÃ¶revler iÃ§indeki aktivite Ã¶rneklerinin nasÄ±l iÅŸleneceÄŸini yÃ¶nlendirir. **singleTask** modu, bu saldÄ±rÄ± iÃ§in kritik Ã¶neme sahiptir ve mevcut aktivite Ã¶rnekleri ile gÃ¶rev baÄŸlÄ±lÄ±ÄŸÄ± eÅŸleÅŸmelerine dayanan Ã¼Ã§ senaryo belirler. SaldÄ±rÄ±, bir saldÄ±rganÄ±n uygulamasÄ±nÄ±n hedef uygulamanÄ±n gÃ¶rev baÄŸlÄ±lÄ±ÄŸÄ±nÄ± taklit etme yeteneÄŸine dayanÄ±r ve Android sistemini saldÄ±rganÄ±n uygulamasÄ±nÄ± baÅŸlatmaya yÃ¶nlendirir.

### AyrÄ±ntÄ±lÄ± SaldÄ±rÄ± AdÄ±mlarÄ±

1. **KÃ¶tÃ¼ AmaÃ§lÄ± Uygulama Kurulumu**: Kurban, saldÄ±rganÄ±n uygulamasÄ±nÄ± cihazÄ±na kurar.
2. **Ä°lk Aktivasyon**: Kurban, Ã¶nce kÃ¶tÃ¼ amaÃ§lÄ± uygulamayÄ± aÃ§arak cihazÄ± saldÄ±rÄ±ya hazÄ±rlar.
3. **Hedef Uygulama BaÅŸlatma GiriÅŸimi**: Kurban, hedef uygulamayÄ± aÃ§maya Ã§alÄ±ÅŸÄ±r.
4. **KaÃ§Ä±rma UygulamasÄ±**: EÅŸleÅŸen gÃ¶rev baÄŸlÄ±lÄ±ÄŸÄ± nedeniyle, kÃ¶tÃ¼ amaÃ§lÄ± uygulama hedef uygulamanÄ±n yerine baÅŸlatÄ±lÄ±r.
5. **Aldatma**: KÃ¶tÃ¼ amaÃ§lÄ± uygulama, hedef uygulamaya benzeyen sahte bir giriÅŸ ekranÄ± sunarak kullanÄ±cÄ±yÄ± hassas bilgileri girmeye kandÄ±rÄ±r.

Bu saldÄ±rÄ±nÄ±n pratik bir uygulamasÄ± iÃ§in GitHub'daki GÃ¶rev KaÃ§Ä±rma Strandhogg deposuna bakÄ±n: [GÃ¶rev KaÃ§Ä±rma Strandhogg](https://github.com/az0mb13/Task\_Hijacking\_Strandhogg).

### Ã–nleme Ã–nlemleri

Bu tÃ¼r saldÄ±rÄ±larÄ± Ã¶nlemek iÃ§in geliÅŸtiriciler, `taskAffinity`'yi boÅŸ bir dize olarak ayarlayabilir ve uygulamalarÄ±nÄ±n diÄŸerlerinden izole olmasÄ±nÄ± saÄŸlamak iÃ§in `singleInstance` baÅŸlatma modunu seÃ§ebilir. `onBackPressed()` fonksiyonunu Ã¶zelleÅŸtirmek, gÃ¶rev kaÃ§Ä±rmaya karÅŸÄ± ek koruma saÄŸlar.

## **Kaynaklar**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
