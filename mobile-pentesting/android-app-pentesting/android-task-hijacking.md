# Android Task Hijacking

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Trouvez les vuln√©rabilit√©s les plus importantes afin de les corriger plus rapidement. Intruder suit votre surface d'attaque, lance des analyses de menaces proactives, trouve des probl√®mes dans l'ensemble de votre pile technologique, des API aux applications web et aux syst√®mes cloud. [**Essayez-le gratuitement**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) aujourd'hui.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## T√¢che, Pile arri√®re et Activit√©s au premier plan

En Android, une **t√¢che** est essentiellement un ensemble d'activit√©s avec lesquelles les utilisateurs interagissent pour accomplir une t√¢che sp√©cifique, organis√©es dans une **pile arri√®re**. Cette pile classe les activit√©s en fonction de leur ouverture, l'activit√© la plus r√©cente √©tant affich√©e en haut comme activit√© au premier plan. √Ä tout moment, seule cette activit√© est visible √† l'√©cran, faisant partie de la **t√¢che au premier plan**.

Voici un bref aper√ßu des transitions d'activit√© :

- **Activit√© 1** d√©marre comme seule activit√© au premier plan.
- Le lancement de **l'Activit√© 2** pousse **l'Activit√© 1** dans la pile arri√®re, amenant **l'Activit√© 2** au premier plan.
- Le d√©marrage de **l'Activit√© 3** d√©place **l'Activit√© 1** et **l'Activit√© 2** plus loin dans la pile, avec **l'Activit√© 3** maintenant en premier plan.
- La fermeture de **l'Activit√© 3** ram√®ne **l'Activit√© 2** au premier plan, mettant en valeur le m√©canisme de navigation de t√¢che simplifi√© d'Android.

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## Attaque par affinit√© de t√¢che

### Aper√ßu de l'affinit√© de t√¢che et des modes de lancement

Dans les applications Android, **l'affinit√© de t√¢che** sp√©cifie la t√¢che pr√©f√©r√©e d'une activit√©, correspondant g√©n√©ralement au nom du package de l'application. Cette configuration est essentielle pour cr√©er une application de preuve de concept (PoC) d√©montrant l'attaque.

### Modes de lancement

L'attribut `launchMode` dirige la gestion des instances d'activit√© au sein des t√¢ches. Le mode **singleTask** est essentiel pour cette attaque, dictant trois sc√©narios en fonction des instances d'activit√© existantes et des correspondances d'affinit√© de t√¢che. L'exploit repose sur la capacit√© de l'application d'un attaquant √† imiter l'affinit√© de t√¢che de l'application cible, induisant en erreur le syst√®me Android pour lancer l'application de l'attaquant √† la place de l'application cible pr√©vue.

### √âtapes d√©taill√©es de l'attaque

1. **Installation de l'application malveillante** : La victime installe l'application de l'attaquant sur son appareil.
2. **Activation initiale** : La victime ouvre d'abord l'application malveillante, pr√©parant l'appareil pour l'attaque.
3. **Tentative de lancement de l'application cible** : La victime tente d'ouvrir l'application cible.
4. **Ex√©cution de d√©tournement** : En raison de l'affinit√© de t√¢che correspondante, l'application malveillante est lanc√©e √† la place de l'application cible.
5. **Tromperie** : L'application malveillante pr√©sente un faux √©cran de connexion ressemblant √† l'application cible, incitant l'utilisateur √† saisir des informations sensibles.

Pour une mise en ≈ìuvre pratique de cette attaque, consultez le d√©p√¥t Task Hijacking Strandhogg sur GitHub : [Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg).

### Mesures de pr√©vention

Pour pr√©venir de telles attaques, les d√©veloppeurs peuvent d√©finir `taskAffinity` sur une cha√Æne vide et opter pour le mode de lancement `singleInstance`, assurant l'isolation de leur application par rapport aux autres. Personnaliser la fonction `onBackPressed()` offre une protection suppl√©mentaire contre le d√©tournement de t√¢che.

## **R√©f√©rences**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Trouvez les vuln√©rabilit√©s les plus importantes afin de les corriger plus rapidement. Intruder suit votre surface d'attaque, lance des analyses de menaces proactives, trouve des probl√®mes dans l'ensemble de votre pile technologique, des API aux applications web et aux syst√®mes cloud. [**Essayez-le gratuitement**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) aujourd'hui.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
