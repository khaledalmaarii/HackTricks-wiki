# Android Task Hijacking

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## Zadatak, Back Stack i Aktivnosti u prvom planu

U Androidu, **zadatak** je suÅ¡tinski skup aktivnosti sa kojima korisnici interaguju kako bi zavrÅ¡ili odreÄ‘eni posao, organizovan unutar **back stack-a**. Ovaj stek poreda aktivnosti na osnovu toga kada su otvorene, pri Äemu se najnovija aktivnost prikazuje na vrhu kao **aktivnost u prvom planu**. U svakom trenutku, samo je ova aktivnost vidljiva na ekranu, ÄineÄ‡i je delom **zadatka u prvom planu**.

Evo brzog pregleda tranzicija aktivnosti:

* **Aktivnost 1** poÄinje kao jedina aktivnost u prvom planu.
* Pokretanje **Aktivnosti 2** gura **Aktivnost 1** u back stack, dovodeÄ‡i **Aktivnost 2** u prvi plan.
* Pokretanje **Aktivnosti 3** pomera **Aktivnost 1** i **Aktivnost 2** dalje u stek, sa **AktivnoÅ¡Ä‡u 3** sada u prvom planu.
* Zatvaranje **Aktivnosti 3** vraÄ‡a **Aktivnost 2** u prvi plan, prikazujuÄ‡i Android-ov mehanizam navigacije zadataka.

![https://developer.android.com/images/fundamentals/diagram\_backstack.png](<../../.gitbook/assets/image (548).png>)

## Napad na zadatke

### Pregled zadatka i reÅ¾ima pokretanja

U Android aplikacijama, **zadatak pripadnosti** odreÄ‘uje preferirani zadatak aktivnosti, obiÄno se podudarajuÄ‡i sa imenom paketa aplikacije. Ova postavka je kljuÄna za izradu koncepta aplikacije (PoC) za demonstraciju napada.

### ReÅ¾imi pokretanja

Atribut `launchMode` usmerava rukovanje instancama aktivnosti unutar zadataka. ReÅ¾im **singleTask** je kljuÄan za ovaj napad, diktirajuÄ‡i tri scenarija na osnovu postojeÄ‡ih instanci aktivnosti i podudaranja zadataka pripadnosti. Eksploatacija se oslanja na sposobnost aplikacije napadaÄa da imitira zadatak pripadnosti ciljne aplikacije, zavaravajuÄ‡i Android sistem da pokrene aplikaciju napadaÄa umesto ciljane.

### Detaljni koraci napada

1. **Instalacija zlonamerne aplikacije**: Å½rtva instalira aplikaciju napadaÄa na svom ureÄ‘aju.
2. **PoÄetna aktivacija**: Å½rtva prvo otvara zlonamernu aplikaciju, pripremajuÄ‡i ureÄ‘aj za napad.
3. **PokuÅ¡aj pokretanja ciljane aplikacije**: Å½rtva pokuÅ¡ava da otvori ciljanu aplikaciju.
4. **IzvrÅ¡enje preuzimanja kontrole**: Zbog podudaranja zadatka pripadnosti, zlonamerna aplikacija se pokreÄ‡e umesto ciljane aplikacije.
5. **Prevara**: Zlonamerna aplikacija prikazuje laÅ¾ni ekran za prijavu koji podseÄ‡a na ciljanu aplikaciju, prevareÄ‡i korisnika da unese osetljive informacije.

Za praktiÄnu implementaciju ovog napada, pogledajte repozitorijum Task Hijacking Strandhogg na GitHub-u: [Task Hijacking Strandhogg](https://github.com/az0mb13/Task\_Hijacking\_Strandhogg).

### Mere prevencije

Da bi se spreÄili ovakvi napadi, programeri mogu postaviti `taskAffinity` na prazan string i odabrati reÅ¾im pokretanja `singleInstance`, obezbeÄ‘ujuÄ‡i izolaciju njihove aplikacije od drugih. PrilagoÄ‘avanje funkcije `onBackPressed()` nudi dodatnu zaÅ¡titu od preuzimanja kontrole nad zadacima.

## **Reference**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
