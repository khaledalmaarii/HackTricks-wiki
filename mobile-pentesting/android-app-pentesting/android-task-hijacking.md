# Androidä»»åŠ¡åŠ«æŒ

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

å‘ç°æœ€é‡è¦çš„æ¼æ´ï¼Œä»¥ä¾¿æ›´å¿«ä¿®å¤ã€‚Intruderè·Ÿè¸ªæ‚¨çš„æ”»å‡»é¢ï¼Œè¿è¡Œä¸»åŠ¨å¨èƒæ‰«æï¼Œå‘ç°æ•´ä¸ªæŠ€æœ¯å †æ ˆä¸­çš„é—®é¢˜ï¼Œä»APIåˆ°Webåº”ç”¨ç¨‹åºå’Œäº‘ç³»ç»Ÿã€‚[**ç«‹å³å…è´¹è¯•ç”¨**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## ä»»åŠ¡ã€åé€€æ ˆå’Œå‰å°æ´»åŠ¨

åœ¨Androidä¸­ï¼Œ**ä»»åŠ¡**æœ¬è´¨ä¸Šæ˜¯ç”¨æˆ·ä¸ä¹‹äº¤äº’ä»¥å®Œæˆç‰¹å®šå·¥ä½œçš„ä¸€ç»„æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨åœ¨**åé€€æ ˆ**ä¸­ç»„ç»‡ã€‚è¯¥å †æ ˆæ ¹æ®æ‰“å¼€æ´»åŠ¨çš„æ—¶é—´é¡ºåºå¯¹æ´»åŠ¨è¿›è¡Œæ’åºï¼Œæœ€è¿‘çš„æ´»åŠ¨æ˜¾ç¤ºåœ¨é¡¶éƒ¨ä½œä¸º**å‰å°æ´»åŠ¨**ã€‚åœ¨ä»»ä½•æ—¶åˆ»ï¼Œå±å¹•ä¸Šåªæœ‰è¿™ä¸ªæ´»åŠ¨å¯è§ï¼Œä½¿å…¶æˆä¸º**å‰å°ä»»åŠ¡**çš„ä¸€éƒ¨åˆ†ã€‚

ä»¥ä¸‹æ˜¯æ´»åŠ¨è½¬æ¢çš„å¿«é€Ÿæ¦‚è¿°ï¼š

- **æ´»åŠ¨1**å¼€å§‹ä½œä¸ºå‰å°ä¸­å”¯ä¸€çš„æ´»åŠ¨ã€‚
- å¯åŠ¨**æ´»åŠ¨2**å°†**æ´»åŠ¨1**æ¨é€åˆ°åé€€æ ˆï¼Œå°†**æ´»åŠ¨2**ç½®äºå‰å°ã€‚
- å¯åŠ¨**æ´»åŠ¨3**å°†**æ´»åŠ¨1**å’Œ**æ´»åŠ¨2**è¿›ä¸€æ­¥æ¨åˆ°å †æ ˆåé¢ï¼Œç°åœ¨**æ´»åŠ¨3**åœ¨å‰é¢ã€‚
- å…³é—­**æ´»åŠ¨3**å°†**æ´»åŠ¨2**å¸¦å›å‰å°ï¼Œå±•ç¤ºäº†Androidç®€åŒ–çš„ä»»åŠ¡å¯¼èˆªæœºåˆ¶ã€‚

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## ä»»åŠ¡äº²å’Œæ€§æ”»å‡»

### ä»»åŠ¡äº²å’Œæ€§å’Œå¯åŠ¨æ¨¡å¼æ¦‚è¿°

åœ¨Androidåº”ç”¨ç¨‹åºä¸­ï¼Œ**ä»»åŠ¡äº²å’Œæ€§**æŒ‡å®šæ´»åŠ¨çš„é¦–é€‰ä»»åŠ¡ï¼Œé€šå¸¸ä¸åº”ç”¨ç¨‹åºçš„åŒ…åç§°å¯¹é½ã€‚è¿™ç§è®¾ç½®å¯¹äºåˆ›å»ºç”¨äºæ¼”ç¤ºæ”»å‡»çš„æ¦‚å¿µéªŒè¯ï¼ˆPoCï¼‰åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚

### å¯åŠ¨æ¨¡å¼

`launchMode`å±æ€§æŒ‡å¯¼ä»»åŠ¡å†…æ´»åŠ¨å®ä¾‹çš„å¤„ç†ã€‚**singleTask**æ¨¡å¼å¯¹äºæ­¤æ”»å‡»è‡³å…³é‡è¦ï¼Œæ ¹æ®ç°æœ‰æ´»åŠ¨å®ä¾‹å’Œä»»åŠ¡äº²å’Œæ€§åŒ¹é…ï¼Œè§„å®šäº†ä¸‰ç§æƒ…å†µã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ”»å‡»è€…çš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿæ¨¡ä»¿ç›®æ ‡åº”ç”¨ç¨‹åºçš„ä»»åŠ¡äº²å’Œæ€§ï¼Œè¯¯å¯¼Androidç³»ç»Ÿå¯åŠ¨æ”»å‡»è€…çš„åº”ç”¨ç¨‹åºè€Œä¸æ˜¯é¢„æœŸçš„ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

### è¯¦ç»†çš„æ”»å‡»æ­¥éª¤

1. **æ¶æ„åº”ç”¨ç¨‹åºå®‰è£…**ï¼šå—å®³è€…åœ¨å…¶è®¾å¤‡ä¸Šå®‰è£…æ”»å‡»è€…çš„åº”ç”¨ç¨‹åºã€‚
2. **åˆå§‹æ¿€æ´»**ï¼šå—å®³è€…é¦–å…ˆæ‰“å¼€æ¶æ„åº”ç”¨ç¨‹åºï¼Œä¸ºæ”»å‡»åšå‡†å¤‡ã€‚
3. **ç›®æ ‡åº”ç”¨ç¨‹åºå¯åŠ¨å°è¯•**ï¼šå—å®³è€…å°è¯•æ‰“å¼€ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4. **åŠ«æŒæ‰§è¡Œ**ï¼šç”±äºåŒ¹é…çš„ä»»åŠ¡äº²å’Œæ€§ï¼Œæ¶æ„åº”ç”¨ç¨‹åºä»£æ›¿ç›®æ ‡åº”ç”¨ç¨‹åºå¯åŠ¨ã€‚
5. **æ¬ºéª—**ï¼šæ¶æ„åº”ç”¨ç¨‹åºå‘ˆç°ä¸€ä¸ªä¼ªé€ çš„ç™»å½•å±å¹•ï¼Œç±»ä¼¼äºç›®æ ‡åº”ç”¨ç¨‹åºï¼Œæ¬ºéª—ç”¨æˆ·è¾“å…¥æ•æ„Ÿä¿¡æ¯ã€‚

è¦äº†è§£æ­¤æ”»å‡»çš„å®é™…å®ç°ï¼Œè¯·å‚è€ƒGitHubä¸Šçš„Task Hijacking Strandhoggå­˜å‚¨åº“ï¼š[Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg)ã€‚

### é¢„é˜²æªæ–½

ä¸ºé˜²æ­¢æ­¤ç±»æ”»å‡»ï¼Œå¼€å‘äººå‘˜å¯ä»¥å°†`taskAffinity`è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå¹¶é€‰æ‹©`singleInstance`å¯åŠ¨æ¨¡å¼ï¼Œç¡®ä¿å…¶åº”ç”¨ç¨‹åºä¸å…¶ä»–åº”ç”¨ç¨‹åºéš”ç¦»ã€‚è‡ªå®šä¹‰`onBackPressed()`å‡½æ•°å¯ä»¥æä¾›é¢å¤–çš„é˜²æŠ¤ï¼Œé˜²æ­¢ä»»åŠ¡åŠ«æŒã€‚

## **å‚è€ƒèµ„æ–™**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

å‘ç°æœ€é‡è¦çš„æ¼æ´ï¼Œä»¥ä¾¿æ›´å¿«ä¿®å¤ã€‚Intruderè·Ÿè¸ªæ‚¨çš„æ”»å‡»é¢ï¼Œè¿è¡Œä¸»åŠ¨å¨èƒæ‰«æï¼Œå‘ç°æ•´ä¸ªæŠ€æœ¯å †æ ˆä¸­çš„é—®é¢˜ï¼Œä»APIåˆ°Webåº”ç”¨ç¨‹åºå’Œäº‘ç³»ç»Ÿã€‚[**ç«‹å³å…è´¹è¯•ç”¨**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
