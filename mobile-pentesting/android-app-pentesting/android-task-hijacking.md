# Android Task Hijacking

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Znajd藕 najwa偶niejsze podatnoci, aby szybko je naprawi. Intruder ledzi powierzchni ataku, wykonuje proaktywne skanowanie zagro偶e, znajduje problemy we wszystkich warstwach technologicznych, od interfejs贸w API po aplikacje internetowe i systemy chmurowe. [**Wypr贸buj za darmo**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) ju偶 dzi.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Zadanie, stos wsteczny i aktywnoci w pierwszym planie

W systemie Android **zadanie** to zestaw aktywnoci, z kt贸rymi u偶ytkownicy wsp贸dziaaj, aby ukoczy okrelone zadanie, zorganizowane w **stosie wstecznym**. Ten stos uporzdkowuje aktywnoci na podstawie czasu ich otwarcia, przy czym najnowsza aktywno jest wywietlana na g贸rze jako **aktywno w pierwszym planie**. W ka偶dej chwili tylko ta aktywno jest widoczna na ekranie, co czyni j czci **zadania w pierwszym planie**.

Oto szybki przegld przej midzy aktywnociami:

- **Aktywno 1** rozpoczyna jako jedyna aktywno w pierwszym planie.
- Uruchomienie **aktywnoci 2** przesuwa **aktywno 1** do stosu wstecznego, przynoszc **aktywno 2** do pierwszego planu.
- Rozpoczcie **aktywnoci 3** przenosi **aktywno 1** i **aktywno 2** dalej w stosie, a **aktywno 3** jest teraz na pierwszym planie.
- Zamknicie **aktywnoci 3** przywraca **aktywno 2** do pierwszego planu, prezentujc zoptymalizowany mechanizm nawigacji zada w systemie Android.

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## Atak na powizanie zada

### Przegld powizania zada i tryb贸w uruchamiania

W aplikacjach Android **powizanie zada** okrela preferowane zadanie dla danej aktywnoci, zwykle zgodne z nazw pakietu aplikacji. Ta konfiguracja jest istotna przy tworzeniu aplikacji proof-of-concept (PoC) do demonstracji ataku.

### Tryby uruchamiania

Atrybut `launchMode` kieruje obsug instancji aktywnoci w zadaniach. Tryb **singleTask** jest kluczowy dla tego ataku i okrela trzy scenariusze na podstawie istniejcych instancji aktywnoci i dopasowania powizania zada. Atak polega na zdolnoci aplikacji atakujcego do naladowania powizania zada aplikacji docelowej, wprowadzajc w bd system Android i uruchamiajc aplikacj atakujcego zamiast zamierzonej aplikacji docelowej.

### Szczeg贸owe kroki ataku

1. **Instalacja zoliwej aplikacji**: Ofiara instaluje aplikacj atakujcego na swoim urzdzeniu.
2. **Pocztkowe uruchomienie**: Ofiara otwiera po raz pierwszy zoliw aplikacj, przygotowujc urzdzenie do ataku.
3. **Pr贸ba uruchomienia aplikacji docelowej**: Ofiara pr贸buje otworzy aplikacj docelow.
4. **Przechwycenie wykonania**: Ze wzgldu na dopasowanie powizania zada, zamiast aplikacji docelowej uruchamiana jest zoliwa aplikacja.
5. **Oszustwo**: Zoliwa aplikacja prezentuje faszywy ekran logowania przypominajcy aplikacj docelow, wprowadzajc u偶ytkownika w bd i skaniajc go do podania poufnych informacji.

Aby zobaczy praktyczn implementacj tego ataku, odwoaj si do repozytorium Task Hijacking Strandhogg na GitHubie: [Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg).

### rodki zapobiegawcze

Aby zapobiec takim atakom, programici mog ustawi `taskAffinity` na pusty cig znak贸w i wybra tryb uruchamiania `singleInstance`, zapewniajc izolacj swojej aplikacji od innych. Dostosowanie funkcji `onBackPressed()` oferuje dodatkow ochron przed przechwyceniem zada.

## **Odnoniki**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Znajd藕 najwa偶niejsze podatnoci, aby szybko je naprawi. Intruder ledzi powierzchni ataku, wykonuje proaktywne skanowanie zagro偶e, znajduje problemy we wszystkich warstwach technologicznych, od interfejs贸w API po aplikacje internetowe i systemy chmurowe. [**Wypr贸buj za darmo**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) ju偶 dzi.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
