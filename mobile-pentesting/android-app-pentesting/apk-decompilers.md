# DÃ©compilateurs APK

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## [JD-Gui](https://github.com/java-decompiler/jd-gui)

Le premier dÃ©compilateur Java gui cÃ©lÃ¨bre, vous pouvez l'utiliser pour examiner le code Java de l'APK une fois que vous l'avez obtenu.

## [Jadx](https://github.com/skylot/jadx)

DÃ©compilateur Java (multi-plateforme) intÃ©grÃ© et en ce moment je pense que c'est celui recommandÃ©.\
Il suffit de **tÃ©lÃ©charger** la **derniÃ¨re** version et de l'exÃ©cuter Ã  partir du dossier _**bin**_:
```
jadx-gui
```
En utilisant l'interface graphique, vous pouvez effectuer une **recherche de texte**, accÃ©der aux **dÃ©finitions de fonctions** (_CTRL + clic gauche_ sur la fonction) et aux rÃ©fÃ©rences croisÃ©es (_clic droit_ --> _Rechercher l'utilisation_).

Si vous voulez **seulement** le **code Java** mais sans utiliser une interface graphique, une mÃ©thode trÃ¨s simple est d'utiliser l'outil de ligne de commande jadx :
```
jadx app.apk
```
Quelques **options intÃ©ressantes de jadx** (versions GUI et CLI) sont :
```
-d <path to output dir>
--no-res #No resources
--no-src #No source code
--no-imports #Always write entire package name (very useful to know where is the function that you might want to hook)
```
## [Outil de rÃ©tro-ingÃ©nierie GDA-android](https://github.com/charles2gan/GDA-android-reversing-Tool)

GDA est Ã©galement une plateforme d'analyse inverse puissante et rapide. Elle ne prend pas en charge uniquement les opÃ©rations de dÃ©compilation de base, mais Ã©galement de nombreuses fonctions excellentes telles que la **dÃ©tection de comportements malveillants, la dÃ©tection de fuites de confidentialitÃ©, la dÃ©tection de vulnÃ©rabilitÃ©s, la rÃ©solution de chemin, l'identification de packer, l'analyse de suivi de variable, la dÃ©sobfuscation, les scripts Python et Java, l'extraction de la mÃ©moire de l'appareil, le chiffrement et le dÃ©chiffrement de donnÃ©es**, etc.

**Uniquement pour Windows.**

![](<../../.gitbook/assets/image (207) (1) (1).png>)

## [Visionneuse de bytecode](https://github.com/Konloch/bytecode-viewer/releases)

Un autre **outil intÃ©ressant pour effectuer une analyse statique est** : [**bytecode-viewer**](https://github.com/Konloch/bytecode-viewer/releases)**.** Il vous permet de dÃ©compiler l'APK en utilisant **plusieurs dÃ©compilateurs en mÃªme temps**. Ensuite, vous pouvez voir par exemple, 2 dÃ©compilateurs Java diffÃ©rents et un dÃ©compilateur Smali. Il vous permet Ã©galement de **modifier** le code :

![](<../../.gitbook/assets/image (82).png>)

Si vous modifiez le code, vous pouvez alors **l'exporter**.\
Un mauvais point de bytecode-viewer est qu'il **n'a pas de rÃ©fÃ©rences** ou de **rÃ©fÃ©rences croisÃ©es**.

## [**Enjarify**](https://github.com/Storyyeller/enjarify)

Enjarify est un outil de traduction du bytecode Dalvik en bytecode Java Ã©quivalent. Cela permet aux outils d'analyse Java d'analyser les applications Android.\
Dex2jar est un outil plus ancien qui tente Ã©galement de traduire Dalvik en bytecode Java. Il fonctionne raisonnablement bien la plupart du temps, mais de nombreuses fonctionnalitÃ©s obscures ou des cas limites le feront Ã©chouer ou mÃªme produire des rÃ©sultats incorrects en silence. En revanche, Enjarify est conÃ§u pour fonctionner dans le plus grand nombre de cas possible, mÃªme pour le code oÃ¹ Dex2jar Ã©chouerait. Entre autres choses, Enjarify gÃ¨re correctement les noms de classe Unicode, les constantes utilisÃ©es comme plusieurs types, les conversions implicites, les gestionnaires d'exceptions sautant dans le flux de contrÃ´le normal, les classes qui font rÃ©fÃ©rence Ã  trop de constantes, les mÃ©thodes trÃ¨s longues, les gestionnaires d'exceptions aprÃ¨s un gestionnaire catchall et les valeurs initiales statiques du mauvais type.

## [CFR](https://github.com/leibnitz27/cfr)

CFR dÃ©compilera les fonctionnalitÃ©s Java modernes - [y compris une grande partie de Java ](https://www.benf.org/other/cfr/java9observations.html)[9](https://github.com/leibnitz27/cfr/blob/master/java9stringconcat.html), [12](https://www.benf.org/other/cfr/switch\_expressions.html) & [14](https://www.benf.org/other/cfr/java14instanceof\_pattern), mais est entiÃ¨rement Ã©crit en Java 6, donc fonctionnera partout ! ([FAQ](https://www.benf.org/other/cfr/faq.html)) - Il fera mÃªme un bon travail en transformant les fichiers de classe d'autres langages JVM en Java !

Ce fichier JAR peut Ãªtre utilisÃ© comme suit :
```
java -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Pour les fichiers JAR plus volumineux, j'ai constatÃ© que la mÃ©moire Ã©tait insuffisante. Vous pouvez simplement adapter la taille du pool d'allocation de mÃ©moire du JVM si cela vous arrive Ã©galement.
```
java -Xmx4G -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Cet exemple permettra d'allouer un maximum de 4 Go.

Dans le rÃ©pertoire de sortie, vous trouverez les fichiers `.java` dÃ©compilÃ©s, ainsi qu'un rÃ©sumÃ© de la dÃ©compilation.

## [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)

Ensuite, il y a [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine), qui fait partie de [IntelliJ IDEA](https://www.jetbrains.com/idea/). Tout le monde mentionne que c'est un dÃ©compilateur _analytique_ (comme indiquÃ© dans leur description de projet), mais personne ne prÃ©cise ce que cela signifie rÃ©ellement. J'ai seulement trouvÃ© [cette question Stackoverflow](https://stackoverflow.com/q/62298929), qui malheureusement reste sans rÃ©ponse Ã  ce jour.

Quoi qu'il en soit, comme il n'y a pas de versions autonomes, vous devez le construire vous-mÃªme. En tant que projet basÃ© sur [Gradle](https://gradle.org), vous pouvez le cloner et exÃ©cuter la commande suivante, Ã  condition que Gradle soit installÃ© sur votre machine.
```
cd ./plugins/java-decompiler/engine && gradle jar
```
Ici, nous commenÃ§ons par changer notre rÃ©pertoire de travail vers le rÃ©pertoire racine de Fernflower. Ensuite, nous demandons Ã  Gradle de construire le fichier `./build/libs/fernflower.jar`.

L'invocation de Fernflower est similaire Ã  celle de CFR.
```
java -jar ./fernflower.jar "$JARFILE" "$OUTDIR"
```
Parmi les dÃ©compileurs dÃ©crits ici, c'est le seul qui gÃ©nÃ¨re les fichiers `.java` dans un fichier JAR. Vous pouvez facilement extraire les fichiers sources en utilisant `unzip`.

## [Krakatau](https://github.com/Storyyeller/Krakatau)

Vous vous souvenez d'Enjarify ci-dessus ? Le mÃªme auteur est Ã©galement le dÃ©veloppeur d'un dÃ©compileur nommÃ© [Krakatau](https://github.com/Storyyeller/Krakatau).

Contrairement aux autres projets, celui-ci est Ã©crit en Python. Et je pense que c'est la raison pour laquelle il est un peu diffÃ©rent des autres.

Permettez-moi de citer [le README du projet](https://github.com/Storyyeller/Krakatau/blob/master/README.md).

> Ensuite, assurez-vous d'avoir des fichiers JAR contenant les dÃ©finitions (sic!) de toutes les classes externes (c'est-Ã -dire les bibliothÃ¨ques) qui pourraient Ãªtre rÃ©fÃ©rencÃ©es par le JAR que vous essayez de dÃ©compiler. Cela inclut les classes de la bibliothÃ¨que standard (c'est-Ã -dire JRT).

Et selon la description, ces classes de bibliothÃ¨que standard sont fournies jusqu'Ã  la version 8 de Java sous la forme du fichier `rt.jar`. Pour les versions ultÃ©rieures, l'auteur fournit [jrt-extractor](https://github.com/Storyyeller/jrt-extractor), qui peut gÃ©nÃ©rer ce fichier pour nous.

Nous tÃ©lÃ©chargeons donc cet outil et exÃ©cutons les commandes suivantes.
```
cd ./jrt-extractor
javac JRTExtractor.java
java -ea JRTExtractor
```
Cela devrait avoir Ã©crit un fichier `rt.jar` Ã  l'intÃ©rieur du rÃ©pertoire.

Avec ce fichier, nous pouvons exÃ©cuter Krakatau comme suit.
```
./Krakatau/decompile.py -out "$OUTDIR" -skip -nauto -path ./jrt-extractor/rt.jar "$JARFILE"
```
Je vais me rÃ©fÃ©rer au GitHub du projet pour une explication des paramÃ¨tres. Notez simplement que pour toutes les bibliothÃ¨ques utilisÃ©es par votre fichier JAR, Krakatau vous demandera de l'ajouter en tant que fichier JAR au drapeau `-path`.

## [procyon](https://github.com/mstrobel/procyon)

Une fois installÃ©, l'utilisation est simple.
```
procyon -jar "$JARFILE" -o "$OUTDIR"
```
## RÃ©fÃ©rences

{% embed url="https://eiken.dev/blog/2021/02/how-to-break-your-jar-in-2021-decompilation-guide-for-jars-and-apks/#cfr" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
