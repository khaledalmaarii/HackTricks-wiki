# ç»•è¿‡ç”Ÿç‰©è¯†åˆ«è®¤è¯ï¼ˆAndroidï¼‰

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨**HackTricks**ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è¦è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½HackTricksçš„PDF**ï¼ŸæŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

### **æ–¹æ³•1 â€“ ä¸ä½¿ç”¨CryptoObjectç»•è¿‡**

è¿™é‡Œçš„é‡ç‚¹æ˜¯*onAuthenticationSucceeded*å›è°ƒï¼Œè¿™åœ¨è®¤è¯è¿‡ç¨‹ä¸­è‡³å…³é‡è¦ã€‚WithSecureçš„ç ”ç©¶äººå‘˜å¼€å‘äº†ä¸€ä¸ª[Fridaè„šæœ¬](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js)ï¼Œå¯ä»¥ç»•è¿‡*onAuthenticationSucceeded(...)*ä¸­çš„NULL *CryptoObject*ã€‚è¯¥è„šæœ¬å¼ºåˆ¶åœ¨æ–¹æ³•è°ƒç”¨æ—¶è‡ªåŠ¨ç»•è¿‡æŒ‡çº¹è®¤è¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–çš„ä»£ç ç‰‡æ®µï¼Œæ¼”ç¤ºäº†åœ¨AndroidæŒ‡çº¹ä¸Šä¸‹æ–‡ä¸­çš„ç»•è¿‡ï¼Œå®Œæ•´çš„åº”ç”¨ç¨‹åºå¯åœ¨[GitHub](https://github.com/St3v3nsS/InsecureBanking)ä¸Šæ‰¾åˆ°ã€‚
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
```markdown
è¿è¡ŒFridaè„šæœ¬çš„å‘½ä»¤ï¼š
```
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
### **æ–¹æ³•2 â€“ å¼‚å¸¸å¤„ç†æ–¹æ³•**

å¦ä¸€ä¸ªç”±WithSecureæä¾›çš„[Fridaè„šæœ¬](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js)è§£å†³äº†ç»•è¿‡ä¸å®‰å…¨çš„åŠ å¯†å¯¹è±¡ä½¿ç”¨é—®é¢˜ã€‚è¯¥è„šæœ¬è°ƒç”¨*onAuthenticationSucceeded*ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªæœªç»æŒ‡çº¹æˆæƒçš„*CryptoObject*ã€‚å¦‚æœåº”ç”¨ç¨‹åºå°è¯•ä½¿ç”¨ä¸åŒçš„å¯†ç å¯¹è±¡ï¼Œå°†è§¦å‘ä¸€ä¸ªå¼‚å¸¸ã€‚è¯¥è„šæœ¬å‡†å¤‡è°ƒç”¨*onAuthenticationSucceeded*å¹¶å¤„ç†_Cipher_ç±»ä¸­çš„*javax.crypto.IllegalBlockSizeException*ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºä½¿ç”¨çš„åç»­å¯¹è±¡éƒ½ç”¨æ–°å¯†é’¥åŠ å¯†ã€‚

è¿è¡ŒFridaè„šæœ¬çš„å‘½ä»¤ï¼š
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
åœ¨åˆ°è¾¾æŒ‡çº¹å±å¹•å¹¶å¯åŠ¨ `authenticate()` åï¼Œåœ¨ Frida æ§åˆ¶å°ä¸­è¾“å…¥ `bypass()` ä»¥æ¿€æ´»ç»•è¿‡ï¼š
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
### **æ–¹æ³• 3 â€“ Instrumentation æ¡†æ¶**

åƒ Xposed æˆ– Frida è¿™æ ·çš„ Instrumentation æ¡†æ¶å¯ä»¥åœ¨è¿è¡Œæ—¶æŒ‚é’©åº”ç”¨ç¨‹åºæ–¹æ³•ã€‚å¯¹äºæŒ‡çº¹è®¤è¯ï¼Œè¿™äº›æ¡†æ¶å¯ä»¥ï¼š

1. **æ¨¡æ‹Ÿè®¤è¯å›è°ƒ**: é€šè¿‡æŒ‚é’© `BiometricPrompt.AuthenticationCallback` çš„ `onAuthenticationSucceeded`ã€`onAuthenticationFailed` æˆ– `onAuthenticationError` æ–¹æ³•ï¼Œä½ å¯ä»¥æ§åˆ¶æŒ‡çº¹è®¤è¯è¿‡ç¨‹çš„ç»“æœã€‚
2. **ç»•è¿‡ SSL Pinning**: è¿™å…è®¸æ”»å‡»è€…æ‹¦æˆªå¹¶ä¿®æ”¹å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œå¯èƒ½æ”¹å˜è®¤è¯è¿‡ç¨‹æˆ–çªƒå–æ•æ„Ÿæ•°æ®ã€‚

Frida ç¤ºä¾‹å‘½ä»¤ï¼š
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
### **æ–¹æ³• 4 â€“ åå‘å·¥ç¨‹ä¸ä»£ç ä¿®æ”¹**

åƒ `APKTool`ã€`dex2jar` å’Œ `JD-GUI` è¿™æ ·çš„åå‘å·¥ç¨‹å·¥å…·å¯ä»¥ç”¨æ¥åç¼–è¯‘å®‰å“åº”ç”¨ç¨‹åºï¼Œé˜…è¯»å…¶æºä»£ç ï¼Œå¹¶äº†è§£å…¶è®¤è¯æœºåˆ¶ã€‚æ­¥éª¤é€šå¸¸åŒ…æ‹¬ï¼š

1. **åç¼–è¯‘ APK**ï¼šå°† APK æ–‡ä»¶è½¬æ¢ä¸ºæ›´æ˜“äºäººç±»é˜…è¯»çš„æ ¼å¼ï¼ˆå¦‚ Java ä»£ç ï¼‰ã€‚
2. **åˆ†æä»£ç **ï¼šå¯»æ‰¾æŒ‡çº¹è®¤è¯çš„å®ç°ï¼Œå¹¶è¯†åˆ«æ½œåœ¨çš„å¼±ç‚¹ï¼ˆå¦‚åå¤‡æœºåˆ¶æˆ–ä¸å½“çš„éªŒè¯æ£€æŸ¥ï¼‰ã€‚
3. **é‡æ–°ç¼–è¯‘ APK**ï¼šä¿®æ”¹ä»£ç ä»¥ç»•è¿‡æŒ‡çº¹è®¤è¯åï¼Œé‡æ–°ç¼–è¯‘åº”ç”¨ç¨‹åºï¼Œç­¾åï¼Œå¹¶å®‰è£…åœ¨è®¾å¤‡ä¸Šè¿›è¡Œæµ‹è¯•ã€‚

### **æ–¹æ³• 5 â€“ ä½¿ç”¨è‡ªå®šä¹‰è®¤è¯å·¥å…·**

æœ‰ä¸“é—¨è®¾è®¡çš„å·¥å…·å’Œè„šæœ¬ç”¨äºæµ‹è¯•å’Œç»•è¿‡è®¤è¯æœºåˆ¶ã€‚ä¾‹å¦‚ï¼š

1. **MAGISK æ¨¡å—**ï¼šMAGISK æ˜¯ä¸€ä¸ªå®‰å“å·¥å…·ï¼Œå…è®¸ç”¨æˆ·å¯¹å…¶è®¾å¤‡è¿›è¡Œ root å¹¶æ·»åŠ æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯ä»¥ä¿®æ”¹æˆ–ä¼ªé€ ç¡¬ä»¶çº§åˆ«çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æŒ‡çº¹ã€‚
2. **è‡ªå®šä¹‰è„šæœ¬**ï¼šå¯ä»¥ç¼–å†™è„šæœ¬ä¸ Android Debug Bridge (ADB) æˆ–ç›´æ¥ä¸åº”ç”¨ç¨‹åºçš„åç«¯äº¤äº’ï¼Œä»¥æ¨¡æ‹Ÿæˆ–ç»•è¿‡æŒ‡çº¹è®¤è¯ã€‚

# å‚è€ƒèµ„æ–™
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* å¦‚æœä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œï¼Ÿä½ æƒ³åœ¨ **HackTricks** ä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**ï¼Ÿæˆ–è€…ä½ æƒ³è¦è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**ï¼ŸæŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„ [**NFTs**](https://opensea.io/collection/the-peass-family) æ”¶è—ã€‚
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ä¸Š**å…³æ³¨**æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
