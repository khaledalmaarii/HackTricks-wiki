# Contournement de l'authentification biomÃ©trique (Android)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou souhaitez-vous accÃ©der Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PRs aux dÃ©pÃ´ts [hacktricks](https://github.com/carlospolop/hacktricks) et [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

### **MÃ©thode 1 â€“ Contournement sans utilisation d'objet Crypto**

L'attention est portÃ©e ici sur le rappel *onAuthenticationSucceeded*, qui est crucial dans le processus d'authentification. Des chercheurs de WithSecure ont dÃ©veloppÃ© un [script Frida](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js), permettant de contourner l'objet *CryptoObject* NULL dans *onAuthenticationSucceeded(...)*. Le script force un contournement automatique de l'authentification par empreinte digitale lors de l'invocation de la mÃ©thode. Ci-dessous, un extrait simplifiÃ© dÃ©montrant le contournement dans un contexte d'empreinte digitale Android, avec l'application complÃ¨te disponible sur [GitHub](https://github.com/St3v3nsS/InsecureBanking).
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
Commande pour exÃ©cuter le script Frida :
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
### **MÃ©thode 2 â€“ Approche de gestion des exceptions**

Un autre [script Frida](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) de WithSecure aborde le contournement de l'utilisation non sÃ©curisÃ©e d'objet crypto. Le script invoque *onAuthenticationSucceeded* avec un *CryptoObject* qui n'a pas Ã©tÃ© autorisÃ© par une empreinte digitale. Si l'application tente d'utiliser un objet de chiffrement diffÃ©rent, cela dÃ©clenchera une exception. Le script se prÃ©pare Ã  invoquer *onAuthenticationSucceeded* et Ã  gÃ©rer l'*javax.crypto.IllegalBlockSizeException* dans la classe _Cipher_, assurant que les objets subsÃ©quents utilisÃ©s par l'application soient chiffrÃ©s avec la nouvelle clÃ©.

Commande pour exÃ©cuter le script Frida :
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
Lorsque vous arrivez Ã  l'Ã©cran d'empreinte digitale et que l'initiation de `authenticate()` se produit, tapez `bypass()` dans la console Frida pour activer le contournement :
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
### **MÃ©thode 3 â€“ Frameworks d'instrumentation**

Des frameworks d'instrumentation comme Xposed ou Frida peuvent Ãªtre utilisÃ©s pour se brancher sur les mÃ©thodes d'application en temps rÃ©el. Pour l'authentification par empreinte digitale, ces frameworks peuvent :

1. **Simuler les Callbacks d'Authentification** : En se branchant sur les mÃ©thodes `onAuthenticationSucceeded`, `onAuthenticationFailed`, ou `onAuthenticationError` de `BiometricPrompt.AuthenticationCallback`, vous pouvez contrÃ´ler le rÃ©sultat du processus d'authentification par empreinte digitale.
2. **Contourner le Pinning SSL** : Cela permet Ã  un attaquant d'intercepter et de modifier le trafic entre le client et le serveur, pouvant altÃ©rer le processus d'authentification ou voler des donnÃ©es sensibles.

Exemple de commande pour Frida :
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
### **MÃ©thode 4 â€“ IngÃ©nierie Inverse & Modification de Code**

Des outils d'ingÃ©nierie inverse comme `APKTool`, `dex2jar` et `JD-GUI` peuvent Ãªtre utilisÃ©s pour dÃ©compiler une application Android, lire son code source et comprendre son mÃ©canisme d'authentification. Les Ã©tapes comprennent gÃ©nÃ©ralement :

1. **DÃ©compilation de l'APK** : Convertir le fichier APK en un format plus lisible par l'homme (comme le code Java).
2. **Analyse du Code** : Rechercher l'implÃ©mentation de l'authentification par empreinte digitale et identifier les faiblesses potentielles (comme les mÃ©canismes de secours ou les vÃ©rifications de validation inappropriÃ©es).
3. **Recompilation de l'APK** : AprÃ¨s avoir modifiÃ© le code pour contourner l'authentification par empreinte digitale, l'application est recompilÃ©e, signÃ©e et installÃ©e sur l'appareil pour les tests.

### **MÃ©thode 5 â€“ Utilisation d'Outils d'Authentification PersonnalisÃ©s**

Il existe des outils et scripts spÃ©cialisÃ©s conÃ§us pour tester et contourner les mÃ©canismes d'authentification. Par exemple :

1. **Modules MAGISK** : MAGISK est un outil pour Android qui permet aux utilisateurs de rooter leurs appareils et d'ajouter des modules qui peuvent modifier ou simuler des informations au niveau matÃ©riel, y compris les empreintes digitales.
2. **Scripts PersonnalisÃ©s** : Des scripts peuvent Ãªtre Ã©crits pour interagir avec le Android Debug Bridge (ADB) ou directement avec le backend de l'application pour simuler ou contourner l'authentification par empreinte digitale.

# RÃ©fÃ©rences
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Vous travaillez dans une **entreprise de cybersÃ©curitÃ©** ? Vous voulez voir votre **entreprise annoncÃ©e dans HackTricks** ? ou souhaitez-vous accÃ©der Ã  la **derniÃ¨re version du PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de hacking en soumettant des PRs au [dÃ©pÃ´t hacktricks](https://github.com/carlospolop/hacktricks) et au [dÃ©pÃ´t hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
