# Bypass Biometric Authentication (Android)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–ú–µ—Ç–æ–¥ 1 ‚Äì –û–±—Ö—ñ–¥ –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–±'—î–∫—Ç–∞ Crypto**

–û—Å–Ω–æ–≤–Ω–∞ —É–≤–∞–≥–∞ –ø—Ä–∏–¥—ñ–ª—è—î—Ç—å—Å—è –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –≤–∏–∫–ª–∏–∫—É *onAuthenticationSucceeded*, —è–∫–∏–π —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º —É –ø—Ä–æ—Ü–µ—Å—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –î–æ—Å–ª—ñ–¥–Ω–∏–∫–∏ –∑ WithSecure —Ä–æ–∑—Ä–æ–±–∏–ª–∏ [—Å–∫—Ä–∏–ø—Ç Frida](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js), —â–æ –¥–æ–∑–≤–æ–ª—è—î –æ–±—ñ–π—Ç–∏ NULL *CryptoObject* —É *onAuthenticationSucceeded(...)*. –°–∫—Ä–∏–ø—Ç –ø—Ä–∏–º—É—Å–æ–≤–æ –≤–∏–∫–ª–∏–∫–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –æ–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–æ–º –ø–∞–ª—å—Ü—è –ø—ñ–¥ —á–∞—Å –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ —Å–ø—Ä–æ—â–µ–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç, —â–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –æ–±—Ö—ñ–¥ —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ Android Fingerprint, –ø–æ–≤–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ [GitHub](https://github.com/St3v3nsS/InsecureBanking).
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–∞ Frida:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
## **–ú–µ—Ç–æ–¥ 2 ‚Äì –ü—ñ–¥—Ö—ñ–¥ –æ–±—Ä–æ–±–∫–∏ –≤–∏–∫–ª—é—á–µ–Ω—å**

–©–µ –æ–¥–∏–Ω [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) –≤—ñ–¥ WithSecure –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É –æ–±—Ö–æ–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –∫—Ä–∏–ø—Ç–æ–æ–±'—î–∫—Ç—ñ–≤. –°–∫—Ä–∏–ø—Ç –≤–∏–∫–ª–∏–∫–∞—î *onAuthenticationSucceeded* –∑ *CryptoObject*, —è–∫–∏–π –Ω–µ –±—É–≤ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –≤—ñ–¥–±–∏—Ç–∫–æ–º –ø–∞–ª—å—Ü—è. –Ø–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π –æ–±'—î–∫—Ç —à–∏—Ñ—Ä—É, —Ü–µ –≤–∏–∫–ª–∏—á–µ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è. –°–∫—Ä–∏–ø—Ç –≥–æ—Ç—É—î—Ç—å—Å—è –≤–∏–∫–ª–∏–∫–∞—Ç–∏ *onAuthenticationSucceeded* —ñ –æ–±—Ä–æ–±–ª—è—Ç–∏ *javax.crypto.IllegalBlockSizeException* —É –∫–ª–∞—Å—ñ _Cipher_, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏, —â–æ–± –Ω–∞—Å—Ç—É–ø–Ω—ñ –æ–±'—î–∫—Ç–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–º, –±—É–ª–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –Ω–æ–≤–∏–º –∫–ª—é—á–µ–º.

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–∞ Frida:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
–ü—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –µ–∫—Ä–∞–Ω—É –≤—ñ–¥–±–∏—Ç–∫–∞ –ø–∞–ª—å—Ü—è —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞—Ü—ñ—ó `authenticate()`, –≤–≤–µ–¥—ñ—Ç—å `bypass()` —É –∫–æ–Ω—Å–æ–ª—ñ Frida, —â–æ–± –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –æ–±—Ö—ñ–¥:
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
## **–ú–µ—Ç–æ–¥ 3 ‚Äì –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ñ –§—Ä–µ–π–º–≤–æ—Ä–∫–∏**

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ñ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏, —Ç–∞–∫—ñ —è–∫ Xposed –∞–±–æ Frida, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –º–µ—Ç–æ–¥—ñ–≤ –¥–æ–¥–∞—Ç–∫–∞ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–æ–º –ø–∞–ª—å—Ü—è —Ü—ñ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –º–æ–∂—É—Ç—å:

1. **–ú–æ–∫–∞—Ç–∏ –í–∏–∫–ª–∏–∫–∏ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**: –ü—ñ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å –¥–æ –º–µ—Ç–æ–¥—ñ–≤ `onAuthenticationSucceeded`, `onAuthenticationFailed` –∞–±–æ `onAuthenticationError` –∫–ª–∞—Å—É `BiometricPrompt.AuthenticationCallback`, –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ—Ü–µ—Å—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–æ–º –ø–∞–ª—å—Ü—è.
2. **–û–±—ñ–π—Ç–∏ SSL Pinning**: –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—Ç–∏ —Ç–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —ñ —Å–µ—Ä–≤–µ—Ä–æ–º, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∑–º—ñ–Ω—é—é—á–∏ –ø—Ä–æ—Ü–µ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∞–±–æ –∫—Ä–∞–¥—É—á–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ.

–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è Frida:
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
## **–ú–µ—Ç–æ–¥ 4 ‚Äì –†–µ–≤–µ—Ä—Å-—ñ–Ω–∂–∏–Ω—ñ—Ä–∏–Ω–≥ —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ–¥—É**

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–µ–≤–µ—Ä—Å-—ñ–Ω–∂–∏–Ω—ñ—Ä–∏–Ω–≥—É, —Ç–∞–∫—ñ —è–∫ `APKTool`, `dex2jar` —Ç–∞ `JD-GUI`, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –¥–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó Android-–¥–æ–¥–∞—Ç–∫—É, —á–∏—Ç–∞–Ω–Ω—è –π–æ–≥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É —Ç–∞ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –π–æ–≥–æ –º–µ—Ö–∞–Ω—ñ–∑–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ö—Ä–æ–∫–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∫–ª—é—á–∞—é—Ç—å:

1. **–î–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—è APK**: –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É APK —É –±—ñ–ª—å—à –∑—Ä–æ–∑—É–º—ñ–ª–∏–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Java-–∫–æ–¥).
2. **–ê–Ω–∞–ª—ñ–∑ –∫–æ–¥—É**: –ü–æ—à—É–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–∞–º–∏ –ø–∞–ª—å—Ü—ñ–≤ —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∞–±–æ –Ω–µ–Ω–∞–ª–µ–∂–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó).
3. **–†–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—è APK**: –ü—ñ—Å–ª—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–¥—É –¥–ª—è –æ–±—Ö–æ–¥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–∞–º–∏ –ø–∞–ª—å—Ü—ñ–≤, –¥–æ–¥–∞—Ç–æ–∫ —Ä–µ–∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è, –ø—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞ –ø—Ä–∏—Å—Ç—Ä—ñ–π –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.

## **–ú–µ—Ç–æ–¥ 5 ‚Äì –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**

–Ü—Å–Ω—É—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ —Å–∫—Ä–∏–ø—Ç–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–±—Ö–æ–¥—É –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

1. **MAGISK –ú–æ–¥—É–ª—ñ**: MAGISK ‚Äì —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è Android, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —Ä—É—Ç—É–≤–∞—Ç–∏ —Å–≤–æ—ó –ø—Ä–∏—Å—Ç—Ä–æ—ó —Ç–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –º–æ–¥—É–ª—ñ, —è–∫—ñ –º–æ–∂—É—Ç—å –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∞–±–æ –ø—ñ–¥—Ä–æ–±–ª—è—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ –∞–ø–∞—Ä–∞—Ç–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ, –≤–∫–ª—é—á–∞—é—á–∏ –≤—ñ–¥–±–∏—Ç–∫–∏ –ø–∞–ª—å—Ü—ñ–≤.
2. **–°–∫—Ä–∏–ø—Ç–∏ –Ω–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è**: –°–∫—Ä–∏–ø—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–∞–ø–∏—Å–∞–Ω—ñ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Android Debug Bridge (ADB) –∞–±–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ –±–µ–∫–µ–Ω–¥–æ–º –¥–æ–¥–∞—Ç–∫—É –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó –∞–±–æ –æ–±—Ö–æ–¥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –≤—ñ–¥–±–∏—Ç–∫–∞–º–∏ –ø–∞–ª—å—Ü—ñ–≤.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
