# ç»•è¿‡ç”Ÿç‰©è¯†åˆ«è®¤è¯ï¼ˆAndroidï¼‰

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿ æƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**ï¼Ÿ æˆ–è€…æƒ³è¦è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Ÿ è¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTsæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Š**ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

### **æ–¹æ³•1 - æ— åŠ å¯†å¯¹è±¡ä½¿ç”¨çš„ç»•è¿‡**

é‡ç‚¹åœ¨äº*onAuthenticationSucceeded*å›è°ƒï¼Œåœ¨è®¤è¯è¿‡ç¨‹ä¸­è‡³å…³é‡è¦ã€‚WithSecureçš„ç ”ç©¶äººå‘˜å¼€å‘äº†ä¸€ä¸ª[Fridaè„šæœ¬](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js)ï¼Œå¯ä»¥ç»•è¿‡*onAuthenticationSucceeded(...)*ä¸­çš„ç©º*CrytoObject*ã€‚è¯¥è„šæœ¬åœ¨æ–¹æ³•è°ƒç”¨æ—¶å¼ºåˆ¶è‡ªåŠ¨ç»•è¿‡æŒ‡çº¹è®¤è¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„ä»£ç ç‰‡æ®µï¼Œæ¼”ç¤ºäº†åœ¨AndroidæŒ‡çº¹ä¸Šä¸‹æ–‡ä¸­çš„ç»•è¿‡ï¼Œå®Œæ•´åº”ç”¨ç¨‹åºå¯åœ¨[GitHub](https://github.com/St3v3nsS/InsecureBanking)ä¸Šæ‰¾åˆ°ã€‚
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
è¿è¡ŒFridaè„šæœ¬çš„å‘½ä»¤ï¼š
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
### **æ–¹æ³•2 â€“ å¼‚å¸¸å¤„ç†æ–¹æ³•**

å¦ä¸€ä¸ªç”±WithSecureç¼–å†™çš„[Fridaè„šæœ¬](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js)è§£å†³äº†ç»•è¿‡ä¸å®‰å…¨çš„åŠ å¯†å¯¹è±¡ä½¿ç”¨çš„é—®é¢˜ã€‚è¯¥è„šæœ¬è°ƒç”¨*onAuthenticationSucceeded*æ—¶ä½¿ç”¨ä¸€ä¸ªæœªç»æŒ‡çº¹æˆæƒçš„*CryptoObject*ã€‚å¦‚æœåº”ç”¨ç¨‹åºå°è¯•ä½¿ç”¨ä¸åŒçš„å¯†ç å¯¹è±¡ï¼Œå°†è§¦å‘å¼‚å¸¸ã€‚è¯¥è„šæœ¬å‡†å¤‡è°ƒç”¨*onAuthenticationSucceeded*å¹¶å¤„ç†_Cipher_ç±»ä¸­çš„*javax.crypto.IllegalBlockSizeException*ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºä½¿ç”¨çš„åç»­å¯¹è±¡ä½¿ç”¨æ–°å¯†é’¥åŠ å¯†ã€‚

è¿è¡ŒFridaè„šæœ¬çš„å‘½ä»¤ï¼š
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
åœ¨è¾¾åˆ°æŒ‡çº¹å±å¹•å¹¶å¯åŠ¨`authenticate()`æ—¶ï¼Œåœ¨Fridaæ§åˆ¶å°ä¸­é”®å…¥`bypass()`ä»¥æ¿€æ´»ç»•è¿‡ï¼š
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
### **æ–¹æ³• 3 â€“ ä»ªå™¨åŒ–æ¡†æ¶**

ä»ªå™¨åŒ–æ¡†æ¶å¦‚ Xposed æˆ– Frida å¯ç”¨äºåœ¨è¿è¡Œæ—¶é’©å…¥åº”ç”¨ç¨‹åºæ–¹æ³•ã€‚å¯¹äºæŒ‡çº¹è®¤è¯ï¼Œè¿™äº›æ¡†æ¶å¯ä»¥ï¼š

1. **æ¨¡æ‹Ÿè®¤è¯å›è°ƒ**ï¼šé€šè¿‡é’©å…¥ `BiometricPrompt.AuthenticationCallback` çš„ `onAuthenticationSucceeded`ã€`onAuthenticationFailed` æˆ– `onAuthenticationError` æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æ§åˆ¶æŒ‡çº¹è®¤è¯è¿‡ç¨‹çš„ç»“æœã€‚
2. **ç»•è¿‡ SSL Pinning**ï¼šè¿™å…è®¸æ”»å‡»è€…æ‹¦æˆªå’Œä¿®æ”¹å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„æµé‡ï¼Œå¯èƒ½æ”¹å˜è®¤è¯è¿‡ç¨‹æˆ–çªƒå–æ•æ„Ÿæ•°æ®ã€‚

Frida çš„ç¤ºä¾‹å‘½ä»¤ï¼š
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
### **æ–¹æ³•4 â€“ åå‘å·¥ç¨‹ & ä»£ç ä¿®æ”¹**

ç±»ä¼¼ `APKTool`ã€`dex2jar` å’Œ `JD-GUI` çš„åå‘å·¥ç¨‹å·¥å…·å¯ç”¨äºåç¼–è¯‘ Android åº”ç”¨ç¨‹åºï¼Œé˜…è¯»å…¶æºä»£ç ï¼Œå¹¶äº†è§£å…¶èº«ä»½éªŒè¯æœºåˆ¶ã€‚ä¸€èˆ¬æ­¥éª¤åŒ…æ‹¬ï¼š

1. **åç¼–è¯‘ APK**ï¼šå°† APK æ–‡ä»¶è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„æ ¼å¼ï¼ˆå¦‚ Java ä»£ç ï¼‰ã€‚
2. **åˆ†æä»£ç **ï¼šæŸ¥æ‰¾æŒ‡çº¹èº«ä»½éªŒè¯çš„å®ç°ï¼Œå¹¶è¯†åˆ«æ½œåœ¨å¼±ç‚¹ï¼ˆå¦‚å¤‡ç”¨æœºåˆ¶æˆ–ä¸æ­£ç¡®çš„éªŒè¯æ£€æŸ¥ï¼‰ã€‚
3. **é‡æ–°ç¼–è¯‘ APK**ï¼šåœ¨ä¿®æ”¹ä»£ç ä»¥ç»•è¿‡æŒ‡çº¹èº«ä»½éªŒè¯åï¼Œé‡æ–°ç¼–è¯‘ã€ç­¾åå¹¶å®‰è£…åº”ç”¨ç¨‹åºåˆ°è®¾å¤‡è¿›è¡Œæµ‹è¯•ã€‚

### **æ–¹æ³•5 â€“ ä½¿ç”¨è‡ªå®šä¹‰èº«ä»½éªŒè¯å·¥å…·**

æœ‰ä¸“é—¨è®¾è®¡ç”¨äºæµ‹è¯•å’Œç»•è¿‡èº«ä»½éªŒè¯æœºåˆ¶çš„å·¥å…·å’Œè„šæœ¬ã€‚ä¾‹å¦‚ï¼š

1. **MAGISK æ¨¡å—**ï¼šMAGISK æ˜¯ä¸€æ¬¾ç”¨äº Android çš„å·¥å…·ï¼Œå…è®¸ç”¨æˆ·å¯¹å…¶è®¾å¤‡è¿›è¡Œ rootï¼Œå¹¶æ·»åŠ å¯ä¿®æ”¹æˆ–æ¬ºéª—ç¡¬ä»¶çº§ä¿¡æ¯ï¼ˆåŒ…æ‹¬æŒ‡çº¹ï¼‰çš„æ¨¡å—ã€‚
2. **è‡ªå®šä¹‰è„šæœ¬**ï¼šå¯ä»¥ç¼–å†™è„šæœ¬ä¸ Android è°ƒè¯•æ¡¥ï¼ˆADBï¼‰äº¤äº’ï¼Œæˆ–ç›´æ¥ä¸åº”ç”¨ç¨‹åºçš„åç«¯äº¤äº’ï¼Œæ¨¡æ‹Ÿæˆ–ç»•è¿‡æŒ‡çº¹èº«ä»½éªŒè¯ã€‚

# å‚è€ƒèµ„æ–™
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„ **å…¬å¸å¹¿å‘Š**ï¼Ÿæˆ–è€…æƒ³è¦è®¿é—® **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* æ¢ç´¢æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘çš„ **Twitter** **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
