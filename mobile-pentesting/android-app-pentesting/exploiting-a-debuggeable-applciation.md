# IskoriÅ¡Ä‡avanje aplikacije koja je moguÄ‡a za debugovanje

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

# **Bypass-ovanje provere root-a i debugovanja**

Ova sekcija posta je saÅ¾etak posta [**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)

## Koraci za omoguÄ‡avanje debugovanja aplikacije i zaobilaÅ¾enje provera

### **OmoguÄ‡avanje debugovanja aplikacije**

SadrÅ¾aj zasnovan na https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0

1. **Dekompajliranje APK-a:**
- Koristite APK-GUI alat za dekompajliranje APK-a.
- U fajlu _android-manifest_ unesite `android:debuggable=true` da biste omoguÄ‡ili reÅ¾im debugovanja.
- Rekompajlirajte, potpiÅ¡ite i zipalign-ujte izmenjenu aplikaciju.

2. **Instaliranje izmenjene aplikacije:**
- Koristite komandu: `adb install <ime_aplikacije>`.

3. **Dobijanje imena paketa:**
- IzvrÅ¡ite `adb shell pm list packages â€“3` da biste dobili listu aplikacija treÄ‡ih strana i pronaÅ¡li ime paketa.

4. **Postavljanje aplikacije da Äeka povezivanje sa debugger-om:**
- Komanda: `adb shell am setup-debug-app â€“w <ime_paketa>`.
- **Napomena:** Ovu komandu treba pokrenuti svaki put pre pokretanja aplikacije kako bi se osiguralo da Äeka debugger.
- Za trajnost, koristite `adb shell am setup-debug-app â€“w -â€“persistent <ime_paketa>`.
- Da biste uklonili sve zastavice, koristite `adb shell am clear-debug-app <ime_paketa>`.

5. **Priprema za debugovanje u Android Studiju:**
- U Android Studiju idite na _File -> Open Profile or APK_.
- Otvorite rekompajlirani APK.

6. **Postavljanje taÄaka prekida u kljuÄnim Java fajlovima:**
- Postavite taÄke prekida u `MainActivity.java` (posebno u metodi `onCreate`), `b.java` i `ContextWrapper.java`.

### **ZaobilaÅ¾enje provera**

Aplikacija Ä‡e na odreÄ‘enim mestima proveravati da li je moguÄ‡e debugovanje i takoÄ‘e Ä‡e proveriti postojanje binarnih fajlova koji ukazuju na root-ovani ureÄ‘aj. Debugger se moÅ¾e koristiti za izmenu informacija o aplikaciji, uklanjanje bita za debugovanje i izmenu imena traÅ¾enih binarnih fajlova kako bi se zaobiÅ¡le ove provere.

Za proveru debugovanja:

1. **Izmena postavki zastavica:**
- U odeljku sa promenljivama konzole debugger-a, idite na: `this mLoadedAPK -> mApplicationInfo -> flags = 814267974`.
- **Napomena:** Binarna reprezentacija `flags = 814267974` je `11000011100111011110`, Å¡to ukazuje da je "Flag_debuggable" aktivan.

![https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png](https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png)

Ovi koraci zajedno osiguravaju da se aplikacija moÅ¾e debugovati i da se odreÄ‘ene sigurnosne provere mogu zaobiÄ‡i koriÅ¡Ä‡enjem debugger-a, Å¡to omoguÄ‡ava dublju analizu ili izmenu ponaÅ¡anja aplikacije.

Korak 2 ukljuÄuje promenu vrednosti zastavice u 814267972, Å¡to je binarno predstavljeno kao 110000101101000000100010100.

# **IskoriÅ¡Ä‡avanje ranjivosti**

Prikaz je dat koriÅ¡Ä‡enjem ranjive aplikacije koja sadrÅ¾i dugme i tekstualno polje. PoÄetno, aplikacija prikazuje "Crack Me". Cilj je promeniti poruku sa "Try Again" na "Hacked" tokom izvrÅ¡avanja, bez izmene izvornog koda.

## **Provera ranjivosti**
- Aplikacija je dekompajlirana koriÅ¡Ä‡enjem `apktool`-a kako bi se pristupilo fajlu `AndroidManifest.xml`.
- Prisustvo `android_debuggable="true"` u AndroidManifest.xml ukazuje da je aplikacija moguÄ‡a za debugovanje i podloÅ¾na iskoriÅ¡Ä‡avanju.
- Vredno je napomenuti da se `apktool` koristi samo za proveru statusa debugovanja bez izmene bilo kog koda.

## **Priprema postavke**
- Proces je ukljuÄivao pokretanje emulatora, instaliranje ranjive aplikacije i koriÅ¡Ä‡enje `adb jdwp` za identifikaciju portova Dalvik VM-a koji sluÅ¡aju.
- JDWP (Java Debug Wire Protocol) omoguÄ‡ava debugovanje aplikacije koja se izvrÅ¡ava u VM-u putem izlaganja jedinstvenog porta.
- Bilo je potrebno prosleÄ‘ivanje porta za daljinsko debugovanje, a zatim povezivanje JDB sa ciljnom aplikacijom.

## **Ubacivanje koda tokom izvrÅ¡avanja**
- IskoriÅ¡Ä‡avanje je izvrÅ¡eno postavljanjem taÄaka prekida i kontrolisanjem toka aplikacije.
- KoriÅ¡Ä‡ene su komande poput `classes` i `methods <ime_klase>` da bi se otkrila struktura aplikacije.
- TaÄka prekida je postavljena na metodu `onClick`, a njeno izvrÅ¡avanje je kontrolisano.
- KoriÅ¡Ä‡ene su komande `locals`, `next` i `set` da bi se pregledali i izmenili lokalne promenljive, posebno promena poruke "Try Again" u "Hacked".
- Izmenjeni kod je izvrÅ¡en koriÅ¡Ä‡enjem komande `run`, uspeÅ¡no menjajuÄ‡i izlaz aplikacije u real
