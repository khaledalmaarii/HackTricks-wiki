# åˆ©ç”¨å¯è°ƒè¯•åº”ç”¨ç¨‹åº

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

# **ç»•è¿‡ root å’Œå¯è°ƒè¯•æ£€æŸ¥**

æœ¬èŠ‚å†…å®¹æ˜¯æ¥è‡ªå¸–å­ [**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0) çš„æ€»ç»“ã€‚

## ä½¿ Android åº”ç”¨å¯è°ƒè¯•å¹¶ç»•è¿‡æ£€æŸ¥çš„æ­¥éª¤

### **ä½¿åº”ç”¨å¯è°ƒè¯•**

å†…å®¹åŸºäº https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0

1. **åç¼–è¯‘ APKï¼š**
- ä½¿ç”¨ APK-GUI å·¥å…·åç¼–è¯‘ APKã€‚
- åœ¨ _android-manifest_ æ–‡ä»¶ä¸­æ’å…¥ `android:debuggable=true` ä»¥å¯ç”¨è°ƒè¯•æ¨¡å¼ã€‚
- é‡æ–°ç¼–è¯‘ã€ç­¾åå¹¶è¿›è¡Œ zipalign å¤„ç†ä¿®æ”¹åçš„åº”ç”¨ç¨‹åºã€‚

2. **å®‰è£…ä¿®æ”¹åçš„åº”ç”¨ç¨‹åºï¼š**
- ä½¿ç”¨å‘½ä»¤ï¼š `adb install <application_name>`ã€‚

3. **æ£€ç´¢åŒ…åï¼š**
- æ‰§è¡Œ `adb shell pm list packages â€“3` åˆ—å‡ºç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºå¹¶æ‰¾åˆ°åŒ…åã€‚

4. **è®¾ç½®åº”ç”¨ä»¥ç­‰å¾…è°ƒè¯•å™¨è¿æ¥ï¼š**
- å‘½ä»¤ï¼š `adb shell am setup-debug-app â€“w <package_name>`ã€‚
- **æ³¨æ„ï¼š** æ¯æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºä¹‹å‰å¿…é¡»è¿è¡Œæ­¤å‘½ä»¤ï¼Œä»¥ç¡®ä¿å®ƒç­‰å¾…è°ƒè¯•å™¨ã€‚
- ä¸ºäº†æŒä¹…æ€§ï¼Œä½¿ç”¨ `adb shell am setup-debug-app â€“w -â€“persistent <package_name>`ã€‚
- è¦ç§»é™¤æ‰€æœ‰æ ‡å¿—ï¼Œä½¿ç”¨ `adb shell am clear-debug-app <package_name>`ã€‚

5. **åœ¨ Android Studio ä¸­å‡†å¤‡è°ƒè¯•ï¼š**
- åœ¨ Android Studio ä¸­å¯¼èˆªåˆ° _File -> Open Profile or APK_ã€‚
- æ‰“å¼€é‡æ–°ç¼–è¯‘çš„ APKã€‚

6. **åœ¨å…³é”® Java æ–‡ä»¶ä¸­è®¾ç½®æ–­ç‚¹ï¼š**
- åœ¨ `MainActivity.java`ï¼ˆç‰¹åˆ«æ˜¯åœ¨ `onCreate` æ–¹æ³•ä¸­ï¼‰ã€`b.java` å’Œ `ContextWrapper.java` ä¸­è®¾ç½®æ–­ç‚¹ã€‚

### **ç»•è¿‡æ£€æŸ¥**

åº”ç”¨ç¨‹åºåœ¨æŸäº›æ—¶åˆ»ä¼šéªŒè¯æ˜¯å¦å¯è°ƒè¯•ï¼Œå¹¶æ£€æŸ¥æŒ‡ç¤ºè®¾å¤‡å·² root çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨è°ƒè¯•å™¨ä¿®æ”¹åº”ç”¨ä¿¡æ¯ã€å–æ¶ˆè®¾ç½®å¯è°ƒè¯•ä½ï¼Œå¹¶æ›´æ”¹æœç´¢çš„äºŒè¿›åˆ¶æ–‡ä»¶åç§°ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

å¯¹äºå¯è°ƒè¯•æ£€æŸ¥ï¼š

1. **ä¿®æ”¹æ ‡å¿—è®¾ç½®ï¼š**
- åœ¨è°ƒè¯•å™¨æ§åˆ¶å°çš„å˜é‡éƒ¨åˆ†ï¼Œå¯¼èˆªåˆ°ï¼š `this mLoadedAPK -> mApplicationInfo -> flags = 814267974`ã€‚
- **æ³¨æ„ï¼š** `flags = 814267974` çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º `11000011100111011110`ï¼Œè¡¨ç¤º "Flag_debuggable" æ˜¯æ´»åŠ¨çš„ã€‚

![https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png](https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png)

è¿™äº›æ­¥éª¤å…±åŒç¡®ä¿åº”ç”¨ç¨‹åºå¯ä»¥è¢«è°ƒè¯•ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨è°ƒè¯•å™¨ç»•è¿‡æŸäº›å®‰å…¨æ£€æŸ¥ï¼Œä»è€Œä¾¿äºå¯¹åº”ç”¨ç¨‹åºè¡Œä¸ºè¿›è¡Œæ›´æ·±å…¥çš„åˆ†ææˆ–ä¿®æ”¹ã€‚

ç¬¬ 2 æ­¥æ¶‰åŠå°†æ ‡å¿—å€¼æ›´æ”¹ä¸º 814267972ï¼Œå…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸º 110000101101000000100010100ã€‚

# **åˆ©ç”¨æ¼æ´**

æ¼”ç¤ºä½¿ç”¨äº†ä¸€ä¸ªåŒ…å«æŒ‰é’®å’Œæ–‡æœ¬è§†å›¾çš„æ˜“å—æ”»å‡»åº”ç”¨ç¨‹åºã€‚æœ€åˆï¼Œåº”ç”¨ç¨‹åºæ˜¾ç¤º "Crack Me"ã€‚ç›®æ ‡æ˜¯åœ¨è¿è¡Œæ—¶å°†æ¶ˆæ¯ä» "Try Again" æ›´æ”¹ä¸º "Hacked"ï¼Œè€Œä¸ä¿®æ”¹æºä»£ç ã€‚

## **æ£€æŸ¥æ¼æ´**
- ä½¿ç”¨ `apktool` åç¼–è¯‘åº”ç”¨ç¨‹åºä»¥è®¿é—® `AndroidManifest.xml` æ–‡ä»¶ã€‚
- `AndroidManifest.xml` ä¸­å­˜åœ¨ `android_debuggable="true"` è¡¨ç¤ºè¯¥åº”ç”¨ç¨‹åºæ˜¯å¯è°ƒè¯•çš„ï¼Œå®¹æ˜“å—åˆ°åˆ©ç”¨ã€‚
- å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ`apktool` ä»…ç”¨äºæ£€æŸ¥å¯è°ƒè¯•çŠ¶æ€ï¼Œè€Œä¸æ›´æ”¹ä»»ä½•ä»£ç ã€‚

## **å‡†å¤‡è®¾ç½®**
- è¯¥è¿‡ç¨‹æ¶‰åŠå¯åŠ¨æ¨¡æ‹Ÿå™¨ï¼Œå®‰è£…æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨ `adb jdwp` è¯†åˆ«æ­£åœ¨ç›‘å¬çš„ Dalvik VM ç«¯å£ã€‚
- JDWPï¼ˆJava Debug Wire Protocolï¼‰å…è®¸é€šè¿‡æš´éœ²å”¯ä¸€ç«¯å£æ¥è°ƒè¯•åœ¨ VM ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚
- éœ€è¦è¿›è¡Œç«¯å£è½¬å‘ä»¥è¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œç„¶åå°† JDB é™„åŠ åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

## **åœ¨è¿è¡Œæ—¶æ³¨å…¥ä»£ç **
- é€šè¿‡è®¾ç½®æ–­ç‚¹å’Œæ§åˆ¶åº”ç”¨ç¨‹åºæµç¨‹è¿›è¡Œåˆ©ç”¨ã€‚
- ä½¿ç”¨ `classes` å’Œ `methods <class_name>` ç­‰å‘½ä»¤æ¥æ­ç¤ºåº”ç”¨ç¨‹åºçš„ç»“æ„ã€‚
- åœ¨ `onClick` æ–¹æ³•å¤„è®¾ç½®æ–­ç‚¹ï¼Œå¹¶æ§åˆ¶å…¶æ‰§è¡Œã€‚
- ä½¿ç”¨ `locals`ã€`next` å’Œ `set` å‘½ä»¤æ£€æŸ¥å’Œä¿®æ”¹å±€éƒ¨å˜é‡ï¼Œç‰¹åˆ«æ˜¯å°† "Try Again" æ¶ˆæ¯æ›´æ”¹ä¸º "Hacked"ã€‚
- ä½¿ç”¨ `run` å‘½ä»¤æ‰§è¡Œä¿®æ”¹åçš„ä»£ç ï¼ŒæˆåŠŸå®æ—¶æ›´æ”¹åº”ç”¨ç¨‹åºçš„è¾“å‡ºã€‚

è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•æ“çºµå¯è°ƒè¯•åº”ç”¨ç¨‹åºçš„è¡Œä¸ºï¼Œçªæ˜¾äº†æ›´å¤æ‚çš„åˆ©ç”¨æ½œåŠ›ï¼Œä¾‹å¦‚åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è·å¾—è®¾å¤‡çš„ shell è®¿é—®æƒé™ã€‚

## å‚è€ƒæ–‡çŒ®
* [https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)
* [https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications](https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
