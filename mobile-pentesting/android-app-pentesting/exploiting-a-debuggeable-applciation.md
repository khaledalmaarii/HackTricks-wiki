# Debuggable bir uygulamanÄ±n istismar edilmesi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

# **Root ve debuggeable kontrollerinin atlatÄ±lmasÄ±**

Bu bÃ¶lÃ¼m, [**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0) adresindeki yazÄ±nÄ±n bir Ã¶zetidir.

## Android UygulamasÄ±nÄ± Debuggable Hale Getirme ve Kontrolleri Atlatma AdÄ±mlarÄ±

### **UygulamayÄ± Debuggable Hale Getirme**

Ä°Ã§erik https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0 adresine dayanmaktadÄ±r.

1. **APK'yÄ± Decompile Etme:**
- APK'yÄ± decompile etmek iÃ§in APK-GUI aracÄ±nÄ± kullanÄ±n.
- _android-manifest_ dosyasÄ±na `android:debuggable=true` ekleyerek hata ayÄ±klama modunu etkinleÅŸtirin.
- DeÄŸiÅŸtirilen uygulamayÄ± yeniden derleyin, imzalayÄ±n ve zipalign yapÄ±n.

2. **DeÄŸiÅŸtirilen UygulamayÄ± YÃ¼kleme:**
- Komutu kullanÄ±n: `adb install <application_name>`.

3. **Paket AdÄ±nÄ± Alma:**
- ÃœÃ§Ã¼ncÃ¼ taraf uygulamalarÄ± listelemek ve paket adÄ±nÄ± bulmak iÃ§in `adb shell pm list packages â€“3` komutunu Ã§alÄ±ÅŸtÄ±rÄ±n.

4. **UygulamayÄ± Debugger BaÄŸlantÄ±sÄ±nÄ± Bekleyecek Åekilde Ayarlama:**
- Komut: `adb shell am setup-debug-app â€“w <package_name>`.
- **Not:** Bu komut, uygulamayÄ± baÅŸlatmadan Ã¶nce her seferinde Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±dÄ±r, bÃ¶ylece debugger'Ä± bekler.
- KalÄ±cÄ±lÄ±k iÃ§in `adb shell am setup-debug-app â€“w -â€“persistent <package_name>` kullanÄ±n.
- TÃ¼m bayraklarÄ± kaldÄ±rmak iÃ§in `adb shell am clear-debug-app <package_name>` komutunu kullanÄ±n.

5. **Android Studio'da Hata AyÄ±klama Ä°Ã§in HazÄ±rlÄ±k:**
- Android Studio'da _File -> Open Profile or APK_ yolunu izleyin.
- Yeniden derlenmiÅŸ APK'yÄ± aÃ§Ä±n.

6. **Ana Java DosyalarÄ±nda Kesme NoktalarÄ± Ayarlama:**
- `MainActivity.java` (Ã¶zellikle `onCreate` metodunda), `b.java` ve `ContextWrapper.java` dosyalarÄ±nda kesme noktalarÄ± koyun.

### **Kontrolleri Atlatma**

Uygulama, belirli noktalarda debuggeable olup olmadÄ±ÄŸÄ±nÄ± kontrol edecek ve kÃ¶klÃ¼ bir cihazÄ± gÃ¶steren ikili dosyalarÄ± da kontrol edecektir. Debugger, uygulama bilgilerini deÄŸiÅŸtirmek, debuggeable bitini kaldÄ±rmak ve aranan ikili dosyalarÄ±n adlarÄ±nÄ± deÄŸiÅŸtirmek iÃ§in kullanÄ±labilir.

Debuggable kontrolÃ¼ iÃ§in:

1. **Bayrak AyarlarÄ±nÄ± DeÄŸiÅŸtirme:**
- Debugger konsolunun deÄŸiÅŸken bÃ¶lÃ¼mÃ¼nde, `this mLoadedAPK -> mApplicationInfo -> flags = 814267974` yolunu izleyin.
- **Not:** `flags = 814267974` ikili temsili `11000011100111011110` olup, "Flag_debuggable" bayraÄŸÄ±nÄ±n aktif olduÄŸunu gÃ¶sterir.

![https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png](https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png)

Bu adÄ±mlar, uygulamanÄ±n hata ayÄ±klanabilir olmasÄ±nÄ± ve belirli gÃ¼venlik kontrollerinin debugger kullanÄ±larak atlatÄ±lmasÄ±nÄ± saÄŸlar, bÃ¶ylece uygulamanÄ±n davranÄ±ÅŸÄ±nÄ±n daha derinlemesine analizi veya deÄŸiÅŸtirilmesi mÃ¼mkÃ¼n olur.

AdÄ±m 2, bir bayrak deÄŸerini 814267972 olarak deÄŸiÅŸtirmeyi iÃ§erir; bu, ikili olarak 110000101101000000100010100 ÅŸeklinde temsil edilir.

# **Bir AÃ§Ä±ÄŸÄ± Ä°stismar Etme**

Bir dÃ¼ÄŸme ve bir metin gÃ¶rÃ¼nÃ¼mÃ¼ iÃ§eren savunmasÄ±z bir uygulama kullanÄ±larak bir gÃ¶sterim saÄŸlandÄ±. BaÅŸlangÄ±Ã§ta uygulama "Crack Me" mesajÄ±nÄ± gÃ¶sterir. AmaÃ§, kaynak kodunu deÄŸiÅŸtirmeden "Try Again" mesajÄ±nÄ± "Hacked" olarak deÄŸiÅŸtirmektir.

## **AÃ§Ä±ÄŸÄ± Kontrol Etme**
- Uygulama, `AndroidManifest.xml` dosyasÄ±na eriÅŸmek iÃ§in `apktool` kullanÄ±larak decompile edildi.
- AndroidManifest.xml dosyasÄ±nda `android_debuggable="true"` ifadesinin varlÄ±ÄŸÄ±, uygulamanÄ±n debuggeable olduÄŸunu ve istismara aÃ§Ä±k olduÄŸunu gÃ¶sterir.
- `apktool`'un yalnÄ±zca debuggeable durumunu kontrol etmek iÃ§in kullanÄ±ldÄ±ÄŸÄ±nÄ± ve herhangi bir kodu deÄŸiÅŸtirmediÄŸini belirtmek Ã¶nemlidir.

## **Kurulumu HazÄ±rlama**
- SÃ¼reÃ§, bir emÃ¼latÃ¶r baÅŸlatmayÄ±, savunmasÄ±z uygulamayÄ± yÃ¼klemeyi ve dinleyen Dalvik VM portlarÄ±nÄ± belirlemek iÃ§in `adb jdwp` kullanmayÄ± iÃ§eriyordu.
- JDWP (Java Debug Wire Protocol), bir VM'de Ã§alÄ±ÅŸan bir uygulamanÄ±n hata ayÄ±klanmasÄ±nÄ± saÄŸlamak iÃ§in benzersiz bir port aÃ§ar.
- Uzaktan hata ayÄ±klama iÃ§in port yÃ¶nlendirme gerekliydi, ardÄ±ndan JDB hedef uygulamaya baÄŸlandÄ±.

## **Ã‡alÄ±ÅŸma ZamanÄ±nda Kod Enjekte Etme**
- Ä°stismar, kesme noktalarÄ± ayarlayarak ve uygulama akÄ±ÅŸÄ±nÄ± kontrol ederek gerÃ§ekleÅŸtirildi.
- UygulamanÄ±n yapÄ±sÄ±nÄ± ortaya Ã§Ä±karmak iÃ§in `classes` ve `methods <class_name>` gibi komutlar kullanÄ±ldÄ±.
- `onClick` metodunda bir kesme noktasÄ± ayarlandÄ± ve yÃ¼rÃ¼tmesi kontrol edildi.
- `locals`, `next` ve `set` komutlarÄ±, yerel deÄŸiÅŸkenleri incelemek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±ldÄ±; Ã¶zellikle "Try Again" mesajÄ±nÄ± "Hacked" olarak deÄŸiÅŸtirmek iÃ§in.
- DeÄŸiÅŸtirilen kod, `run` komutu kullanÄ±larak yÃ¼rÃ¼tÃ¼ldÃ¼ ve uygulamanÄ±n Ã§Ä±ktÄ±sÄ± gerÃ§ek zamanlÄ± olarak baÅŸarÄ±yla deÄŸiÅŸtirildi.

Bu Ã¶rnek, debuggeable bir uygulamanÄ±n davranÄ±ÅŸÄ±nÄ±n nasÄ±l manipÃ¼le edilebileceÄŸini gÃ¶sterdi ve uygulama baÄŸlamÄ±nda cihazda shell eriÅŸimi elde etme gibi daha karmaÅŸÄ±k istismarlarÄ±n potansiyelini vurguladÄ±.

## Referanslar
* [https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)
* [https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications](https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
