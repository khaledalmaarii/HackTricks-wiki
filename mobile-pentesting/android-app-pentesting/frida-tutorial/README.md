# Frida íŠœí† ë¦¬ì–¼

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **í•´ì»¤ë“¤ì— ì˜í•´ ë§Œë“¤ì–´ì§„ í”„ë¦¬ë¯¸ì—„ ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼ì¸ Intigritiì— ê°€ì…**í•˜ì„¸ìš”! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì°¸ì—¬í•˜ì—¬ ìµœëŒ€ **$100,000**ì˜ ë°”ìš´í‹°ë¥¼ ë°›ìœ¼ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ì„¤ì¹˜

**frida ë„êµ¬**ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”:
```bash
pip install frida-tools
pip install frida
```
**frida ì„œë²„**ë¥¼ ì•ˆë“œë¡œì´ë“œì— **ë‹¤ìš´ë¡œë“œí•˜ê³  ì„¤ì¹˜**í•˜ì„¸ìš” ([ìµœì‹  ë¦´ë¦¬ìŠ¤ ë‹¤ìš´ë¡œë“œ](https://github.com/frida/frida/releases)).\
ë£¨íŠ¸ ëª¨ë“œì—ì„œ adbë¥¼ ì¬ì‹œì‘í•˜ê³  ì—°ê²°í•œ í›„, frida-serverë¥¼ ì—…ë¡œë“œí•˜ê³  ì‹¤í–‰ ê¶Œí•œì„ ë¶€ì—¬í•˜ì—¬ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” ì›ë¼ì´ë„ˆì…ë‹ˆë‹¤:

{% code overflow="wrap" %}
```bash
adb root; adb connect localhost:6000; sleep 1; adb push frida-server /data/local/tmp/; adb shell "chmod 755 /data/local/tmp/frida-server"; adb shell "/data/local/tmp/frida-server &"
```
{% endcode %}

**ì‘ë™í•˜ëŠ”ì§€** í™•ì¸í•˜ì„¸ìš”:
```bash
frida-ps -U #List packages and processes
frida-ps -U | grep -i <part_of_the_package_name> #Get all the package name
```
## íŠœí† ë¦¬ì–¼

### [íŠœí† ë¦¬ì–¼ 1](frida-tutorial-1.md)

**ì¶œì²˜**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**ì†ŒìŠ¤ ì½”ë“œ**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

**[ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ì½ì–´ë³´ì„¸ìš”](frida-tutorial-1.md).**

### [íŠœí† ë¦¬ì–¼ 2](frida-tutorial-2.md)

**ì¶œì²˜**: [https://11x256.github.io/Frida-hooking-android-part-2/](https://11x256.github.io/Frida-hooking-android-part-2/) (íŒŒíŠ¸ 2, 3 ë° 4)\
**APK ë° ì†ŒìŠ¤ ì½”ë“œ**: [https://github.com/11x256/frida-android-examples](https://github.com/11x256/frida-android-examples)

**[ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ì½ì–´ë³´ì„¸ìš”](frida-tutorial-2.md).**

### [íŠœí† ë¦¬ì–¼ 3](owaspuncrackable-1.md)

**ì¶œì²˜**: [https://joshspicer.com/android-frida-1](https://joshspicer.com/android-frida-1)\
**APK**: [https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk](https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk)

**[ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ì½ì–´ë³´ì„¸ìš”](owaspuncrackable-1.md).**

**ë” ë§ì€ ë©‹ì§„ Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:** [**https://codeshare.frida.re/**](https://codeshare.frida.re)

## ë¹ ë¥¸ ì˜ˆì œ

### ëª…ë ¹ ì¤„ì—ì„œ Frida í˜¸ì¶œí•˜ê¸°
```bash
frida-ps -U

#Basic frida hooking
frida -l disableRoot.js -f owasp.mstg.uncrackable1

#Hooking before starting the app
frida -U --no-pause -l disableRoot.js -f owasp.mstg.uncrackable1
#The --no-pause and -f options allow the app to be spawned automatically,
#frozen so that the instrumentation can occur, and the automatically
#continue execution with our modified code.
```
### ê¸°ë³¸ Python ìŠ¤í¬ë¦½íŠ¸

```python
import frida

# Attach to the target process
session = frida.attach("com.example.app")

# Define the JavaScript code to be injected
js_code = """
Java.perform(function () {
    // Hook the target method
    var targetClass = Java.use("com.example.app.TargetClass");
    targetClass.targetMethod.implementation = function () {
        // Modify the behavior of the target method
        console.log("Target method hooked!");
        // Call the original method
        this.targetMethod();
    };
});
"""

# Create the script
script = session.create_script(js_code)

# Load the script into the target process
script.load()

# Detach from the target process
session.detach()
```

ìœ„ì˜ Python ìŠ¤í¬ë¦½íŠ¸ëŠ” [Frida](https://frida.re/)ë¥¼ ì‚¬ìš©í•˜ì—¬ íƒ€ê²Ÿ í”„ë¡œì„¸ìŠ¤ì— ì£¼ì…í•  JavaScript ì½”ë“œë¥¼ ì •ì˜í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê¸°ë³¸ì ì¸ ì˜ˆì œì…ë‹ˆë‹¤.

```python
import frida

# íƒ€ê²Ÿ í”„ë¡œì„¸ìŠ¤ì— ì—°ê²°
session = frida.attach("com.example.app")

# ì£¼ì…í•  JavaScript ì½”ë“œ ì •ì˜
js_code = """
Java.perform(function () {
    // íƒ€ê²Ÿ ë©”ì†Œë“œ í›„í‚¹
    var targetClass = Java.use("com.example.app.TargetClass");
    targetClass.targetMethod.implementation = function () {
        // íƒ€ê²Ÿ ë©”ì†Œë“œì˜ ë™ì‘ ìˆ˜ì •
        console.log("íƒ€ê²Ÿ ë©”ì†Œë“œ í›„í‚¹ë¨!");
        // ì›ë³¸ ë©”ì†Œë“œ í˜¸ì¶œ
        this.targetMethod();
    };
});
"""

# ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
script = session.create_script(js_code)

# ìŠ¤í¬ë¦½íŠ¸ë¥¼ íƒ€ê²Ÿ í”„ë¡œì„¸ìŠ¤ì— ë¡œë“œ
script.load()

# íƒ€ê²Ÿ í”„ë¡œì„¸ìŠ¤ì™€ ì—°ê²° í•´ì œ
session.detach()
```

ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” `com.example.app`ì´ë¼ëŠ” íƒ€ê²Ÿ ì•±ì— ëŒ€í•´ Fridaë¥¼ ì‚¬ìš©í•˜ì—¬ JavaScript ì½”ë“œë¥¼ ì£¼ì…í•˜ê³  ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. íƒ€ê²Ÿ ì•±ì˜ `TargetClass`ë¼ëŠ” í´ë˜ìŠ¤ì˜ `targetMethod` ë©”ì†Œë“œë¥¼ í›„í‚¹í•˜ì—¬ ë™ì‘ì„ ìˆ˜ì •í•˜ê³ , ì›ë³¸ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.
```python
import frida, sys

jscode = open(sys.argv[0]).read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
### ë§¤ê°œë³€ìˆ˜ê°€ ì—†ëŠ” í•¨ìˆ˜ í›„í‚¹

`sg.vantagepoint.a.c` í´ë˜ìŠ¤ì˜ `a()` í•¨ìˆ˜ë¥¼ í›„í‚¹í•˜ì„¸ìš”.
```javascript
Java.perform(function () {
;  rootcheck1.a.overload().implementation = function() {
rootcheck1.a.overload().implementation = function() {
send("sg.vantagepoint.a.c.a()Z   Root check 1 HIT!  su.exists()");
return false;
};
});
```
# Frida Tutorial: Hooking Java `exit()`

In this tutorial, we will learn how to hook the `exit()` method in Java using Frida. By hooking this method, we can intercept the application's exit calls and perform additional actions before the application terminates.

## Prerequisites

Before we begin, make sure you have the following:

- A rooted Android device or an emulator
- Frida installed on your machine
- Basic knowledge of JavaScript and Java

## Steps

1. Start by creating a new JavaScript file, for example `hook_exit.js`, and open it in a text editor.

2. Import the necessary Frida modules at the beginning of the file:

```javascript
const { Java } = require('frida');
```

3. Attach Frida to the target application using the package name or process ID:

```javascript
const processName = 'com.example.app';
const session = Java.openSession();
const target = Java.choose(processName, {
  onMatch: function (instance) {
    return instance;
  },
  onComplete: function () {
    console.log('Target not found');
    session.detach();
  }
});
```

4. Define the hook function that will be executed when `exit()` is called:

```javascript
function onExit() {
  console.log('Exit called');
  // Additional actions can be performed here
}
```

5. Hook the `exit()` method using the `Java.use()` function:

```javascript
const System = Java.use('java.lang.System');
System.exit.implementation = function () {
  onExit();
  this.exit();
};
```

6. Save the JavaScript file and start the Frida server on your Android device or emulator.

7. Launch the target application on the device or emulator.

8. Use Frida to inject the JavaScript code into the target application:

```bash
frida -U -l hook_exit.js -f com.example.app
```

Replace `com.example.app` with the package name of the target application.

9. You should see the message "Exit called" printed in the console whenever the `exit()` method is called in the target application.

## Conclusion

By hooking the `exit()` method in Java using Frida, we can intercept the application's exit calls and perform additional actions. This technique can be useful for debugging, analyzing, or modifying the behavior of Android applications during penetration testing.
```javascript
var sysexit = Java.use("java.lang.System");
sysexit.exit.overload("int").implementation = function(var_0) {
send("java.lang.System.exit(I)V  // We avoid exiting the application  :)");
};
```
# Frida Tutorial: Hook MainActivity `.onStart()` & `.onCreate()`

ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” Fridaë¥¼ ì‚¬ìš©í•˜ì—¬ Android ì•±ì˜ `MainActivity` í´ë˜ìŠ¤ì˜ `.onStart()` ë° `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ëŠ” ë°©ë²•ì„ ë°°ìš°ê²Œ ë©ë‹ˆë‹¤.

## Fridaë€?

FridaëŠ” ë™ì  ë¶„ì„ ë„êµ¬ë¡œì„œ, ì•±ì˜ ì‹¤í–‰ ì¤‘ì— ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  ê°ì‹œí•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. Fridaë¥¼ ì‚¬ìš©í•˜ë©´ ì•±ì˜ ë™ì‘ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¡°ì‘í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## í•„ìš”í•œ ë„êµ¬

ì´ íŠœí† ë¦¬ì–¼ì„ ì™„ë£Œí•˜ê¸° ìœ„í•´ ë‹¤ìŒ ë„êµ¬ë“¤ì´ í•„ìš”í•©ë‹ˆë‹¤:

- Frida CLI (Command Line Interface)
- ì•ˆë“œë¡œì´ë“œ ë””ë°”ì´ìŠ¤ ë˜ëŠ” ì—ë®¬ë ˆì´í„°

## ë‹¨ê³„ë³„ ì§€ì¹¨

1. Fridaë¥¼ ì„¤ì¹˜í•˜ê³  í™˜ê²½ì„ ì„¤ì •í•©ë‹ˆë‹¤. Frida CLIë¥¼ ì‚¬ìš©í•˜ì—¬ Fridaë¥¼ ì„¤ì¹˜í•˜ê³  ì•ˆë“œë¡œì´ë“œ ë””ë°”ì´ìŠ¤ ë˜ëŠ” ì—ë®¬ë ˆì´í„°ì™€ ì—°ê²°í•©ë‹ˆë‹¤.

2. Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ìœ¼ë¡œ `hook.js` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤:

```javascript
Java.perform(function() {
    var MainActivity = Java.use('com.example.app.MainActivity');

    MainActivity.onStart.implementation = function() {
        console.log('MainActivity.onStart() hooked');
        this.onStart();
    };

    MainActivity.onCreate.implementation = function() {
        console.log('MainActivity.onCreate() hooked');
        this.onCreate();
    };
});
```

3. Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
frida -U -l hook.js -f com.example.app
```

4. ì•±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. Frida ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ ì¤‘ì¸ ë™ì•ˆ ì•±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

5. ê²°ê³¼ í™•ì¸. ì•±ì´ `.onStart()` ë˜ëŠ” `.onCreate()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ Frida ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì •ì˜í•œ í›„í‚¹ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  ë¡œê·¸ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

## ê²°ë¡ 

ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” Fridaë¥¼ ì‚¬ìš©í•˜ì—¬ Android ì•±ì˜ `MainActivity` í´ë˜ìŠ¤ì˜ `.onStart()` ë° `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. Fridaë¥¼ ì‚¬ìš©í•˜ë©´ ì•±ì˜ ë™ì‘ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¡°ì‘í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì•±ì˜ ë™ì‘ì„ ì´í•´í•˜ê³  ë³´ì•ˆ ì·¨ì•½ì ì„ ë°œê²¬í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
```javascript
var mainactivity = Java.use("sg.vantagepoint.uncrackable1.MainActivity");
mainactivity.onStart.overload().implementation = function() {
send("MainActivity.onStart() HIT!!!");
var ret = this.onStart.overload().call(this);
};
mainactivity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("MainActivity.onCreate() HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
# ì•ˆë“œë¡œì´ë“œ `.onCreate()` í›„í‚¹

ì•ˆë“œë¡œì´ë“œ ì•±ì„ íœí…ŒìŠ¤íŒ…í•  ë•Œ, `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ëŠ” ê²ƒì€ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤. `.onCreate()` ë©”ì„œë“œëŠ” ì•¡í‹°ë¹„í‹°ê°€ ìƒì„±ë  ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œë¡œ, ì•±ì˜ ì´ˆê¸°í™” ë° ì„¤ì •ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ì´ ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ì—¬ ì•±ì˜ ë™ì‘ì„ ì¡°ì‘í•˜ê±°ë‚˜ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Fridaë¥¼ ì‚¬ìš©í•˜ì—¬ ì•ˆë“œë¡œì´ë“œ ì•±ì˜ `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. Fridaë¥¼ ì„¤ì¹˜í•˜ê³  íƒ€ê²Ÿ ë””ë°”ì´ìŠ¤ì— Frida ì„œë²„ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
2. Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•©ë‹ˆë‹¤.
3. Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ í›„í‚¹ì„ ì ìš©í•©ë‹ˆë‹¤.

ë‹¤ìŒì€ Frida ìŠ¤í¬ë¦½íŠ¸ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤:

```javascript
Java.perform(function() {
  var targetClass = Java.use('com.example.app.MainActivity');
  targetClass.onCreate.implementation = function() {
    console.log('Hooked .onCreate()');
    // ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    // ì˜ˆ: ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê±°ë‚˜ ì¡°ì‘í•©ë‹ˆë‹¤.
    this.onCreate();
  };
});
```

ìœ„ ìŠ¤í¬ë¦½íŠ¸ëŠ” `com.example.app.MainActivity` í´ë˜ìŠ¤ì˜ `.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ê³ , í›„í‚¹ì´ ì ìš©ë˜ì—ˆìŒì„ ë¡œê·¸ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•œ í›„, `this.onCreate()`ì„ í˜¸ì¶œí•˜ì—¬ ì›ë˜ì˜ `.onCreate()` ë©”ì„œë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œ í›„, ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ Frida ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:

```
frida -U -f com.example.app -l script.js --no-pause
```

ìœ„ ëª…ë ¹ì—ì„œ `com.example.app`ì€ íƒ€ê²Ÿ ì•±ì˜ íŒ¨í‚¤ì§€ ì´ë¦„ì´ë©°, `script.js`ëŠ” ì‘ì„±í•œ Frida ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì…ë‹ˆë‹¤.

`.onCreate()` ë©”ì„œë“œë¥¼ í›„í‚¹í•˜ì—¬ ì•ˆë“œë¡œì´ë“œ ì•±ì„ ì¡°ì‘í•˜ê±°ë‚˜ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì€ íœí…ŒìŠ¤íŒ… ê³¼ì •ì—ì„œ ë§¤ìš° ìœ ìš©í•œ ê¸°ìˆ ì…ë‹ˆë‹¤. Fridaë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ì‹¤í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```javascript
var activity = Java.use("android.app.Activity");
activity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("Activity HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
### ë§¤ê°œë³€ìˆ˜ì™€ ê°’ì„ ê²€ìƒ‰í•˜ì—¬ í•¨ìˆ˜ í›„í‚¹í•˜ê¸°

ë³µí˜¸í™” í•¨ìˆ˜ í›„í‚¹í•˜ê¸°. ì…ë ¥ê°’ì„ ì¶œë ¥í•˜ê³ , ì›ë˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì…ë ¥ê°’ì„ ë³µí˜¸í™”í•˜ê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ í‰ë¬¸ ë°ì´í„°ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤:
```javascript
function getString(data){
var ret = "";
for (var i=0; i < data.length; i++){
ret += data[i].toString();
}
return ret
}
var aes_decrypt = Java.use("sg.vantagepoint.a.a");
aes_decrypt.a.overload("[B","[B").implementation = function(var_0,var_1) {
send("sg.vantagepoint.a.a.a([B[B)[B   doFinal(enc)  // AES/ECB/PKCS7Padding");
send("Key       : " + getString(var_0));
send("Encrypted : " + getString(var_1));
var ret = this.a.overload("[B","[B").call(this,var_0,var_1);
send("Decrypted : " + ret);

var flag = "";
for (var i=0; i < ret.length; i++){
flag += String.fromCharCode(ret[i]);
}
send("Decrypted flag: " + flag);
return ret; //[B
};
```
### í•¨ìˆ˜ í›„í‚¹ ë° ì…ë ¥ê°’ìœ¼ë¡œ í˜¸ì¶œí•˜ê¸°

ë¬¸ìì—´ì„ ë°›ëŠ” í•¨ìˆ˜ë¥¼ í›„í‚¹í•˜ê³ , ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤ ([ì—¬ê¸°](https://11x256.github.io/Frida-hooking-android-part-2/)ì—ì„œ ê°€ì ¸ì˜´).
```javascript
var string_class = Java.use("java.lang.String"); // get a JS wrapper for java's String class

my_class.fun.overload("java.lang.String").implementation = function(x){ //hooking the new function
var my_string = string_class.$new("My TeSt String#####"); //creating a new String by using `new` operator
console.log("Original arg: " +x );
var ret =  this.fun(my_string); // calling the original function with the new String, and putting its return value in ret variable
console.log("Return value: "+ret);
return ret;
};
```
### í´ë˜ìŠ¤ì˜ ì´ë¯¸ ìƒì„±ëœ ê°ì²´ ê°€ì ¸ì˜¤ê¸°

ë§Œì•½ ìƒì„±ëœ ê°ì²´ì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì¶”ì¶œí•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ì˜ˆì œì—ì„œëŠ” í´ë˜ìŠ¤ my\_activityì˜ ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ê³ , ê°ì²´ì˜ ë¹„ê³µê°œ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ .secret()ë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```javascript
Java.choose("com.example.a11x256.frida_test.my_activity" , {
onMatch : function(instance){ //This function will be called for every instance found by frida
console.log("Found instance: "+instance);
console.log("Result of secret func: " + instance.secret());
},
onComplete:function(){}
});
```
## ë‹¤ë¥¸ Frida íŠœí† ë¦¬ì–¼

* [https://github.com/DERE-ad2001/Frida-Labs](https://github.com/DERE-ad2001/Frida-Labs)
* [ê³ ê¸‰ Frida ì‚¬ìš© ë¸”ë¡œê·¸ ì‹œë¦¬ì¦ˆì˜ 1ë¶€: IOS ì•”í˜¸í™” ë¼ì´ë¸ŒëŸ¬ë¦¬](https://8ksec.io/advanced-frida-usage-part-1-ios-encryption-libraries-8ksec-blogs/)



<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: í•´ì»¤ë“¤ì´ ë§Œë“  í”„ë¦¬ë¯¸ì—„ ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼ì¸ **Intigritiì— ê°€ì…**í•˜ì„¸ìš”! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ê°€ì…í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë°”ìš´í‹°ë¥¼ ë°›ìœ¼ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
