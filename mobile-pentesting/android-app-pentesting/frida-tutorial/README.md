# Frida Tutorial

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ì„¤ì¹˜

**frida tools** ì„¤ì¹˜:
```bash
pip install frida-tools
pip install frida
```
**ì•ˆë“œë¡œì´ë“œì—** **frida server**ë¥¼ **ë‹¤ìš´ë¡œë“œí•˜ê³  ì„¤ì¹˜**í•˜ì„¸ìš” ([ìµœì‹  ë¦´ë¦¬ìŠ¤ ë‹¤ìš´ë¡œë“œ](https://github.com/frida/frida/releases)).\
adbë¥¼ ë£¨íŠ¸ ëª¨ë“œë¡œ ì¬ì‹œì‘í•˜ê³ , ì—°ê²°í•˜ê³ , frida-serverë¥¼ ì—…ë¡œë“œí•˜ê³ , ì‹¤í–‰ ê¶Œí•œì„ ë¶€ì—¬í•œ í›„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” ì›ë¼ì´ë„ˆ:

{% code overflow="wrap" %}
```bash
adb root; adb connect localhost:6000; sleep 1; adb push frida-server /data/local/tmp/; adb shell "chmod 755 /data/local/tmp/frida-server"; adb shell "/data/local/tmp/frida-server &"
```
{% endcode %}

**ì‘ë™í•˜ëŠ”ì§€ í™•ì¸**:
```bash
frida-ps -U #List packages and processes
frida-ps -U | grep -i <part_of_the_package_name> #Get all the package name
```
## Tutorials

### [Tutorial 1](frida-tutorial-1.md)

**From**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**Source Code**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

**Follow the [link to read it](frida-tutorial-1.md).**

### [Tutorial 2](frida-tutorial-2.md)

**From**: [https://11x256.github.io/Frida-hooking-android-part-2/](https://11x256.github.io/Frida-hooking-android-part-2/) (Parts 2, 3 & 4)\
**APKs and Source code**: [https://github.com/11x256/frida-android-examples](https://github.com/11x256/frida-android-examples)

**Follow the[ link to read it.](frida-tutorial-2.md)**

### [Tutorial 3](owaspuncrackable-1.md)

**From**: [https://joshspicer.com/android-frida-1](https://joshspicer.com/android-frida-1)\
**APK**: [https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk](https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk)

**Follow the [link to read it](owaspuncrackable-1.md).**

**You can find more Awesome Frida scripts here:** [**https://codeshare.frida.re/**](https://codeshare.frida.re)

## Quick Examples

### Calling Frida from command line
```bash
frida-ps -U

#Basic frida hooking
frida -l disableRoot.js -f owasp.mstg.uncrackable1

#Hooking before starting the app
frida -U --no-pause -l disableRoot.js -f owasp.mstg.uncrackable1
#The --no-pause and -f options allow the app to be spawned automatically,
#frozen so that the instrumentation can occur, and the automatically
#continue execution with our modified code.
```
### ê¸°ë³¸ Python ìŠ¤í¬ë¦½íŠ¸
```python
import frida, sys

jscode = open(sys.argv[0]).read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
### ë§¤ê°œë³€ìˆ˜ ì—†ì´ í•¨ìˆ˜ í›…í‚¹í•˜ê¸°

í´ë˜ìŠ¤ `sg.vantagepoint.a.c`ì˜ í•¨ìˆ˜ `a()`ë¥¼ í›…í‚¹í•©ë‹ˆë‹¤.
```javascript
Java.perform(function () {
;  rootcheck1.a.overload().implementation = function() {
rootcheck1.a.overload().implementation = function() {
send("sg.vantagepoint.a.c.a()Z   Root check 1 HIT!  su.exists()");
return false;
};
});
```
Hook java `exit()`
```javascript
var sysexit = Java.use("java.lang.System");
sysexit.exit.overload("int").implementation = function(var_0) {
send("java.lang.System.exit(I)V  // We avoid exiting the application  :)");
};
```
Hook MainActivity `.onStart()` & `.onCreate()`
```javascript
var mainactivity = Java.use("sg.vantagepoint.uncrackable1.MainActivity");
mainactivity.onStart.overload().implementation = function() {
send("MainActivity.onStart() HIT!!!");
var ret = this.onStart.overload().call(this);
};
mainactivity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("MainActivity.onCreate() HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
Hook android `.onCreate()`
```javascript
var activity = Java.use("android.app.Activity");
activity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("Activity HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
### ë§¤ê°œë³€ìˆ˜ê°€ ìˆëŠ” í•¨ìˆ˜ í›„í‚¹ ë° ê°’ ê²€ìƒ‰

ë³µí˜¸í™” í•¨ìˆ˜ë¥¼ í›„í‚¹í•©ë‹ˆë‹¤. ì…ë ¥ì„ ì¶œë ¥í•˜ê³ , ì›ë˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì…ë ¥ì„ ë³µí˜¸í™”í•œ ë‹¤ìŒ, í‰ë¬¸ ë°ì´í„°ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤:
```javascript
function getString(data){
var ret = "";
for (var i=0; i < data.length; i++){
ret += data[i].toString();
}
return ret
}
var aes_decrypt = Java.use("sg.vantagepoint.a.a");
aes_decrypt.a.overload("[B","[B").implementation = function(var_0,var_1) {
send("sg.vantagepoint.a.a.a([B[B)[B   doFinal(enc)  // AES/ECB/PKCS7Padding");
send("Key       : " + getString(var_0));
send("Encrypted : " + getString(var_1));
var ret = this.a.overload("[B","[B").call(this,var_0,var_1);
send("Decrypted : " + ret);

var flag = "";
for (var i=0; i < ret.length; i++){
flag += String.fromCharCode(ret[i]);
}
send("Decrypted flag: " + flag);
return ret; //[B
};
```
### í•¨ìˆ˜ í›„í‚¹ ë° ì…ë ¥ìœ¼ë¡œ í˜¸ì¶œí•˜ê¸°

ë¬¸ìì—´ì„ ë°›ëŠ” í•¨ìˆ˜ë¥¼ í›„í‚¹í•˜ê³  ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ í˜¸ì¶œí•˜ê¸° ([ì—¬ê¸°ì„œ](https://11x256.github.io/Frida-hooking-android-part-2/))
```javascript
var string_class = Java.use("java.lang.String"); // get a JS wrapper for java's String class

my_class.fun.overload("java.lang.String").implementation = function(x){ //hooking the new function
var my_string = string_class.$new("My TeSt String#####"); //creating a new String by using `new` operator
console.log("Original arg: " +x );
var ret =  this.fun(my_string); // calling the original function with the new String, and putting its return value in ret variable
console.log("Return value: "+ret);
return ret;
};
```
### ì´ë¯¸ ìƒì„±ëœ í´ë˜ìŠ¤ ê°ì²´ ê°€ì ¸ì˜¤ê¸°

ìƒì„±ëœ ê°ì²´ì˜ ì¼ë¶€ ì†ì„±ì„ ì¶”ì¶œí•˜ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ì˜ˆì œì—ì„œëŠ” my\_activity í´ë˜ìŠ¤ì˜ ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ê³¼ ê°ì²´ì˜ ë¹„ê³µê°œ ì†ì„±ì„ ì¶œë ¥í•˜ëŠ” .secret() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```javascript
Java.choose("com.example.a11x256.frida_test.my_activity" , {
onMatch : function(instance){ //This function will be called for every instance found by frida
console.log("Found instance: "+instance);
console.log("Result of secret func: " + instance.secret());
},
onComplete:function(){}
});
```
## ë‹¤ë¥¸ Frida íŠœí† ë¦¬ì–¼

* [https://github.com/DERE-ad2001/Frida-Labs](https://github.com/DERE-ad2001/Frida-Labs)
* [ê³ ê¸‰ Frida ì‚¬ìš© ë¸”ë¡œê·¸ ì‹œë¦¬ì¦ˆ 1ë¶€: IOS ì•”í˜¸í™” ë¼ì´ë¸ŒëŸ¬ë¦¬](https://8ksec.io/advanced-frida-usage-part-1-ios-encryption-libraries-8ksec-blogs/)

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **í•´ì»¤ë¥¼ ìœ„í•´ í•´ì»¤ê°€ ë§Œë“  í”„ë¦¬ë¯¸ì—„** **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼ì¸ Intigritiì—** **ê°€ì…í•˜ì„¸ìš”**! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì €í¬ì™€ í•¨ê»˜í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë³´ìƒì„ ë°›ê¸° ì‹œì‘í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
