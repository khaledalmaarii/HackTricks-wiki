# Frida Tutorial 1

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**This is a summary of the post**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**Source Code**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

## Python

FridaëŠ” ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•¨ìˆ˜ ë‚´ì— **JavaScript ì½”ë“œ**ë¥¼ **ì‚½ì…**í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. í•˜ì§€ë§Œ **python**ì„ ì‚¬ìš©í•˜ì—¬ **hooks**ë¥¼ **í˜¸ì¶œ**í•˜ê³  **hooks**ì™€ **ìƒí˜¸ì‘ìš©**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ê²ƒì€ ì´ íŠœí† ë¦¬ì–¼ì˜ ëª¨ë“  ì œì•ˆëœ ì˜ˆì œì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ python ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤:
```python
#hooking.py
import frida, sys

with open(sys.argv[1], 'r') as f:
jscode = f.read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
ìŠ¤í¬ë¦½íŠ¸ë¥¼ í˜¸ì¶œí•˜ì„¸ìš”:
```bash
python hooking.py <hookN.js>
```
pythonì„ fridaì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì•„ëŠ” ê²ƒì€ ìœ ìš©í•˜ì§€ë§Œ, ì´ ì˜ˆì œì—ì„œëŠ” ëª…ë ¹ì¤„ frida ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ Fridaë¥¼ í˜¸ì¶œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```bash
frida -U --no-pause -l hookN.js -f infosecadventures.fridademo
```
## Hook 1 - Boolean Bypass

ì—¬ê¸°ì—ì„œ í´ë˜ìŠ¤ _infosecadventures.fridademo.utils.PinUtil_ì˜ **boolean** ë©”ì„œë“œ (_checkPin_)ë¥¼ **hook**í•˜ëŠ” ë°©ë²•ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```javascript
//hook1.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")
var MainActivity = Java.use("infosecadventures.fridademo.utils.PinUtil");
MainActivity.checkPin.implementation = function(pin){
console.log("[ + ] PIN check successfully bypassed!")
return true;
}
});
```

```
python hooking.py hook1.js
```
ë³´ì„¸ìš”: í•¨ìˆ˜ëŠ” ë§¤ê°œë³€ìˆ˜ë¡œ Stringì„ ë°›ìŠµë‹ˆë‹¤. ì˜¤ë²„ë¡œë“œê°€ í•„ìš”í•˜ì§€ ì•Šë‚˜ìš”?

## Hook 2 - Function Bruteforce

### ë¹„ì •ì  í•¨ìˆ˜

í´ë˜ìŠ¤ì˜ ë¹„ì •ì  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ **ë¨¼ì € í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”**í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ê·¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ë¥¼ ìœ„í•´ **ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¾ì•„ì„œ** ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```javascript
Java.perform(function() {
console.log("[ * ] Starting PIN Brute-force, please wait...");
Java.choose("infosecadventures.fridademo.utils.PinUtil", {
onMatch: function(instance) {
console.log("[ * ] Instance found in memory: " + instance);
for(var i = 1000; i < 9999; i++){
if(instance.checkPin(i + "") == true){
console.log("[ + ] Found correct PIN: " + i);
break;
}
}
},
onComplete: function() { }
});
});
```
ì´ ê²½ìš° ì¸ìŠ¤í„´ìŠ¤ê°€ ì—†ê³  í•¨ìˆ˜ê°€ ì •ì ì´ê¸° ë•Œë¬¸ì— ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### ì •ì  í•¨ìˆ˜

í•¨ìˆ˜ê°€ ì •ì ì´ë¼ë©´, ê·¸ëƒ¥ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```javascript
//hook2.js
Java.perform(function () {
console.log("[ * ] Starting PIN Brute-force, please wait...")
var PinUtil = Java.use("infosecadventures.fridademo.utils.PinUtil");

for(var i=1000; i < 9999; i++)
{
if(PinUtil.checkPin(i+"") == true){
console.log("[ + ] Found correct PIN: " + i);
}
}
});
```
## Hook 3 - ì¸ìˆ˜ ë° ë°˜í™˜ ê°’ ê°€ì ¸ì˜¤ê¸°

í•¨ìˆ˜ë¥¼ í›„í‚¹í•˜ì—¬ **ì „ë‹¬ëœ ì¸ìˆ˜**ì˜ ê°’ê³¼ **ë°˜í™˜ ê°’**ì˜ ê°’ì„ **ì¶œë ¥**í•˜ë„ë¡ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```javascript
//hook3.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")

var EncryptionUtil = Java.use("infosecadventures.fridademo.utils.EncryptionUtil");
EncryptionUtil.encrypt.implementation = function(key, value){
console.log("Key: " + key);
console.log("Value: " + value);
var encrypted_ret = this.encrypt(key, value); //Call the original function
console.log("Encrypted value: " + encrypted_ret);
return encrypted_ret;
}
});
```
## ì¤‘ìš”

ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ë©”ì„œë“œ ì´ë¦„ê³¼ _.implementation_ì„ ì‚¬ìš©í•˜ì—¬ ë©”ì„œë“œë¥¼ í›„í‚¹í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ **ê°™ì€ ì´ë¦„ì„ ê°€ì§„ ë©”ì„œë“œê°€ ì—¬ëŸ¬ ê°œ** ìˆì„ ê²½ìš°, **ì¸ìˆ˜ì˜ ìœ í˜•ì„ ì§€ì •í•˜ì—¬** í›„í‚¹í•  ë©”ì„œë“œë¥¼ **ëª…ì‹œí•´ì•¼** í•©ë‹ˆë‹¤.

ë‹¤ìŒ íŠœí† ë¦¬ì–¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ [the next tutorial](frida-tutorial-2.md).

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: í•´ì»¤ë¥¼ ìœ„í•´ í•´ì»¤ê°€ ë§Œë“  í”„ë¦¬ë¯¸ì—„ **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼ì¸** **Intigriti**ì— **ê°€ì…í•˜ì„¸ìš”**! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì €í¬ì™€ í•¨ê»˜í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë³´ìƒì„ ë°›ê¸° ì‹œì‘í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…í•˜ê±°ë‚˜** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
