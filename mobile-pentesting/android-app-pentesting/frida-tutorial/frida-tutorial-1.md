# Frida Tutorial 1

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **zarejestruj siÄ™** w **Intigriti**, premium **platformie bug bounty stworzonej przez hackerÃ³w, dla hackerÃ³w**! DoÅ‚Ä…cz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) juÅ¼ dziÅ› i zacznij zarabiaÄ‡ nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**To jest podsumowanie posta**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**Kod ÅºrÃ³dÅ‚owy**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

## Python

Frida pozwala na **wstawienie kodu JavaScript** wewnÄ…trz funkcji dziaÅ‚ajÄ…cej aplikacji. MoÅ¼esz jednak uÅ¼yÄ‡ **Pythona**, aby **wywoÅ‚aÄ‡** haki, a nawet **interagowaÄ‡** z **hakami**.

To jest prosty skrypt w Pythonie, ktÃ³ry moÅ¼esz uÅ¼yÄ‡ ze wszystkimi proponowanymi przykÅ‚adami w tym tutorialu:
```python
#hooking.py
import frida, sys

with open(sys.argv[1], 'r') as f:
jscode = f.read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
ZadzwoÅ„ do skryptu:
```bash
python hooking.py <hookN.js>
```
Jest przydatne, aby wiedzieÄ‡, jak uÅ¼ywaÄ‡ pythona z frida, ale w tych przykÅ‚adach moÅ¼esz rÃ³wnieÅ¼ bezpoÅ›rednio wywoÅ‚aÄ‡ Frida, uÅ¼ywajÄ…c narzÄ™dzi wiersza poleceÅ„ frida:
```bash
frida -U --no-pause -l hookN.js -f infosecadventures.fridademo
```
## Hook 1 - Boolean Bypass

Tutaj moÅ¼esz zobaczyÄ‡, jak **hook**'owaÄ‡ metodÄ™ **boolean** (_checkPin_) z klasy: _infosecadventures.fridademo.utils.PinUtil_
```javascript
//hook1.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")
var MainActivity = Java.use("infosecadventures.fridademo.utils.PinUtil");
MainActivity.checkPin.implementation = function(pin){
console.log("[ + ] PIN check successfully bypassed!")
return true;
}
});
```

```
python hooking.py hook1.js
```
Mirar: Funkcja przyjmuje jako parametr String, czy nie trzeba przeciÄ…Å¼aÄ‡?

## Hook 2 - Funkcja Bruteforce

### Funkcja Nienastatyczna

JeÅ›li chcesz wywoÅ‚aÄ‡ nienastatycznÄ… funkcjÄ™ klasy, **najpierw potrzebujesz instancji** tej klasy. NastÄ™pnie moÅ¼esz uÅ¼yÄ‡ tej instancji do wywoÅ‚ania funkcji.\
Aby to zrobiÄ‡, moÅ¼esz **znaleÅºÄ‡ istniejÄ…cÄ… instancjÄ™** i uÅ¼yÄ‡ jej:
```javascript
Java.perform(function() {
console.log("[ * ] Starting PIN Brute-force, please wait...");
Java.choose("infosecadventures.fridademo.utils.PinUtil", {
onMatch: function(instance) {
console.log("[ * ] Instance found in memory: " + instance);
for(var i = 1000; i < 9999; i++){
if(instance.checkPin(i + "") == true){
console.log("[ + ] Found correct PIN: " + i);
break;
}
}
},
onComplete: function() { }
});
});
```
W tym przypadku to nie dziaÅ‚a, poniewaÅ¼ nie ma Å¼adnej instancji, a funkcja jest statyczna.

### Static Function

JeÅ›li funkcja jest statyczna, moÅ¼esz po prostu jÄ… wywoÅ‚aÄ‡:
```javascript
//hook2.js
Java.perform(function () {
console.log("[ * ] Starting PIN Brute-force, please wait...")
var PinUtil = Java.use("infosecadventures.fridademo.utils.PinUtil");

for(var i=1000; i < 9999; i++)
{
if(PinUtil.checkPin(i+"") == true){
console.log("[ + ] Found correct PIN: " + i);
}
}
});
```
## Hook 3 - Pobieranie argumentÃ³w i wartoÅ›ci zwracanej

MoÅ¼esz podpiÄ…Ä‡ funkcjÄ™ i sprawiÄ‡, aby **drukowaÅ‚a** wartoÅ›Ä‡ **przekazanych argumentÃ³w** oraz wartoÅ›Ä‡ **wartoÅ›ci zwracanej:**
```javascript
//hook3.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")

var EncryptionUtil = Java.use("infosecadventures.fridademo.utils.EncryptionUtil");
EncryptionUtil.encrypt.implementation = function(key, value){
console.log("Key: " + key);
console.log("Value: " + value);
var encrypted_ret = this.encrypt(key, value); //Call the original function
console.log("Encrypted value: " + encrypted_ret);
return encrypted_ret;
}
});
```
## WaÅ¼ne

W tym samouczku podÅ‚Ä…czyÅ‚eÅ› metody uÅ¼ywajÄ…c nazwy metody i _.implementation_. Ale jeÅ›li byÅ‚o **wiÄ™cej niÅ¼ jedna metoda** o tej samej nazwie, bÄ™dziesz musiaÅ‚ **okreÅ›liÄ‡ metodÄ™**, ktÃ³rÄ… chcesz podÅ‚Ä…czyÄ‡, **wskazujÄ…c typ argumentÃ³w**.

MoÅ¼esz to zobaczyÄ‡ w [nastÄ™pnym samouczku](frida-tutorial-2.md).

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**WskazÃ³wka dotyczÄ…ca bug bounty**: **zarejestruj siÄ™** w **Intigriti**, premium **platformie bug bounty stworzonej przez hackerÃ³w, dla hackerÃ³w**! DoÅ‚Ä…cz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) juÅ¼ dziÅ› i zacznij zarabiaÄ‡ nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
