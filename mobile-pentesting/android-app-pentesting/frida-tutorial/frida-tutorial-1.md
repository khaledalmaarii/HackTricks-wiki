# Frida Tutorial 1

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **ÎµÎ³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** Î³Î¹Î± **Intigriti**, Î¼Î¹Î± premium **Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± bug bounty Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î±Ï€ÏŒ hackers, Î³Î¹Î± hackers**! Î•Î»Î¬Ï„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚ ÏƒÏ„Î¿ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) ÏƒÎ®Î¼ÎµÏÎ±, ÎºÎ±Î¹ Î±ÏÏ‡Î¯ÏƒÏ„Îµ Î½Î± ÎºÎµÏÎ´Î¯Î¶ÎµÏ„Îµ Î²ÏÎ±Î²ÎµÎ¯Î± Î­Ï‰Ï‚ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**This is a summary of the post**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**Source Code**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

## Python

Frida allows you to **insert JavaScript code** inside functions of a running application. But you can use **python** to **call** the hooks and even to **interact** with the **hooks**.

This is a easy python script that you can use with all the proposed examples in this tutorial:
```python
#hooking.py
import frida, sys

with open(sys.argv[1], 'r') as f:
jscode = f.read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
ÎšÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿:
```bash
python hooking.py <hookN.js>
```
Î•Î¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï€ÏÏ‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î¿ python Î¼Îµ Ï„Î¿ frida, Î±Î»Î»Î¬ Î³Î¹Î± Î±Ï…Ï„Î¬ Ï„Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Ï„Î¿ Frida Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ frida:
```bash
frida -U --no-pause -l hookN.js -f infosecadventures.fridademo
```
## Hook 1 - Boolean Bypass

Î•Î´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€ÏÏ‚ Î½Î± **hook** Î¼Î¹Î± **boolean** Î¼Î­Î¸Î¿Î´Î¿ (_checkPin_) Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î¬ÏƒÎ·: _infosecadventures.fridademo.utils.PinUtil_
```javascript
//hook1.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")
var MainActivity = Java.use("infosecadventures.fridademo.utils.PinUtil");
MainActivity.checkPin.implementation = function(pin){
console.log("[ + ] PIN check successfully bypassed!")
return true;
}
});
```

```
python hooking.py hook1.js
```
ÎšÎ¿Î¯Ï„Î±: Î— ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î´Î­Ï‡ÎµÏ„Î±Î¹ Ï‰Ï‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ Î­Î½Î± String, Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ overload;

## Hook 2 - Function Bruteforce

### ÎœÎ· Î£Ï„Î±Ï„Î¹ÎºÎ® Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ·

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹Ï‚ Î¼Î¹Î± Î¼Î· ÏƒÏ„Î±Ï„Î¹ÎºÎ® ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î¼Î¹Î±Ï‚ ÎºÎ»Î¬ÏƒÎ·Ï‚, **Ï€ÏÎ­Ï€ÎµÎ¹ Ï€ÏÏÏ„Î± Î½Î± Î­Ï‡ÎµÎ¹Ï‚ Î¼Î¹Î± Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±** Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎºÎ»Î¬ÏƒÎ·Ï‚. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î± Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹Ï‚ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·.\
Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹Ï‚ Î±Ï…Ï„ÏŒ, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµÏ‚ Î½Î± **Î²ÏÎµÎ¹Ï‚ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±** ÎºÎ±Î¹ Î½Î± Ï„Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚:
```javascript
Java.perform(function() {
console.log("[ * ] Starting PIN Brute-force, please wait...");
Java.choose("infosecadventures.fridademo.utils.PinUtil", {
onMatch: function(instance) {
console.log("[ * ] Instance found in memory: " + instance);
for(var i = 1000; i < 9999; i++){
if(instance.checkPin(i + "") == true){
console.log("[ + ] Found correct PIN: " + i);
break;
}
}
},
onComplete: function() { }
});
});
```
Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎºÎ±Î¸ÏÏ‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î± ÎºÎ±Î¹ Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î£Ï„Î±Ï„Î¹ÎºÎ®

### Î£Ï„Î±Ï„Î¹ÎºÎ® Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ·

Î‘Î½ Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î±Ï„Î¹ÎºÎ®, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î±Ï€Î»Î¬ Î½Î± Ï„Î·Î½ ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ:
```javascript
//hook2.js
Java.perform(function () {
console.log("[ * ] Starting PIN Brute-force, please wait...")
var PinUtil = Java.use("infosecadventures.fridademo.utils.PinUtil");

for(var i=1000; i < 9999; i++)
{
if(PinUtil.checkPin(i+"") == true){
console.log("[ + ] Found correct PIN: " + i);
}
}
});
```
## Hook 3 - Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ ÎºÎ±Î¹ Ï„Î¹Î¼Î®Ï‚ ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚

You could hook a function and make it **print** the value of the **passed arguments** and the value of the **return value:**
```javascript
//hook3.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")

var EncryptionUtil = Java.use("infosecadventures.fridademo.utils.EncryptionUtil");
EncryptionUtil.encrypt.implementation = function(key, value){
console.log("Key: " + key);
console.log("Value: " + value);
var encrypted_ret = this.encrypt(key, value); //Call the original function
console.log("Encrypted value: " + encrypted_ret);
return encrypted_ret;
}
});
```
## Î£Î·Î¼Î±Î½Ï„Î¹ÎºÏŒ

Î£Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎµÎ¼Î¹Î½Î¬ÏÎ¹Î¿ Î­Ï‡ÎµÏ„Îµ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î·Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… ÎºÎ±Î¹ Ï„Î·Î½ _.implementation_. Î‘Î»Î»Î¬ Î±Î½ Ï…Ï€Î®ÏÏ‡Î±Î½ **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î±Ï€ÏŒ Î¼Î¯Î± Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚** Î¼Îµ Ï„Î¿ Î¯Î´Î¹Î¿ ÏŒÎ½Î¿Î¼Î±, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± **ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿** Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÏƒÏ…Î½Î´Î­ÏƒÎµÏ„Îµ **Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Ï‰Î½ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½**.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ Î´ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ [ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÏƒÎµÎ¼Î¹Î½Î¬ÏÎ¹Î¿](frida-tutorial-2.md).

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Î£Ï…Î¼Î²Î¿Ï…Î»Î® bug bounty**: **ÎµÎ³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ÏƒÏ„Î¿ **Intigriti**, Î¼Î¹Î± premium **Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± bug bounty Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î±Ï€ÏŒ hackers, Î³Î¹Î± hackers**! Î•Î»Î¬Ï„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚ ÏƒÏ„Î¿ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) ÏƒÎ®Î¼ÎµÏÎ± ÎºÎ±Î¹ Î±ÏÏ‡Î¯ÏƒÏ„Îµ Î½Î± ÎºÎµÏÎ´Î¯Î¶ÎµÏ„Îµ Î²ÏÎ±Î²ÎµÎ¯Î± Î­Ï‰Ï‚ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î»Î¬Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
