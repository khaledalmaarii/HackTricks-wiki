# Objectionæ•™ç¨‹

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**èµé‡‘çŒäººæç¤º**ï¼š**æ³¨å†Œ**Intigritiï¼Œä¸€ä¸ªç”±é»‘å®¢åˆ›å»ºçš„é«˜çº§**èµé‡‘çŒäººå¹³å°**ï¼ç«‹å³åŠ å…¥æˆ‘ä»¬çš„[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾**$100,000**çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

## **ä»‹ç»**

[![objection](https://github.com/sensepost/objection/raw/master/images/objection.png)](https://github.com/sensepost/objection)

**objection - è¿è¡Œæ—¶ç§»åŠ¨åº”ç”¨æ¢ç´¢**

`objection`æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ç§»åŠ¨åº”ç”¨æ¢ç´¢å·¥å…·åŒ…ï¼Œç”±[Frida](https://www.frida.re)æä¾›æ”¯æŒã€‚å®ƒçš„ç›®æ ‡æ˜¯å¸®åŠ©è¯„ä¼°ç§»åŠ¨åº”ç”¨åŠå…¶å®‰å…¨çŠ¶å†µï¼Œè€Œæ— éœ€è¶Šç‹±æˆ–è·å–rootæƒé™çš„ç§»åŠ¨è®¾å¤‡ã€‚

**æ³¨æ„ï¼š**è¿™ä¸æ˜¯æŸç§è¶Šç‹±/è·å–rootæƒé™çš„ç»•è¿‡æ–¹å¼ã€‚ä½¿ç”¨`objection`æ—¶ï¼Œæ‚¨ä»ç„¶å—åˆ°æ‰€é¢ä¸´çš„é€‚ç”¨æ²™ç®±æ‰€æ–½åŠ çš„æ‰€æœ‰é™åˆ¶ã€‚

### ç®€ä»‹

**objection**çš„ç›®æ ‡æ˜¯è®©ç”¨æˆ·è°ƒç”¨**Fridaæä¾›çš„ä¸»è¦æ“ä½œ**ã€‚å¦åˆ™ï¼Œç”¨æˆ·å°†éœ€è¦ä¸ºæ¯ä¸ªè¦æµ‹è¯•çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ª**å•ç‹¬çš„è„šæœ¬**ã€‚

## æ•™ç¨‹

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨å¯ä»¥åœ¨æ­¤å¤„ä¸‹è½½çš„APKï¼š

{% file src="../../../.gitbook/assets/app-release.zip" %}

æˆ–ä»å…¶[åŸå§‹å­˜å‚¨åº“](https://github.com/asvid/FridaApp)ä¸‹è½½app-release.apk

### å®‰è£…
```bash
pip3 install objection
```
### è¿æ¥

å»ºç«‹ä¸€ä¸ª**å¸¸è§„çš„ADBè¿æ¥**å¹¶åœ¨è®¾å¤‡ä¸Š**å¯åŠ¨**fridaæœåŠ¡å™¨ï¼ˆå¹¶æ£€æŸ¥fridaåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šæ˜¯å¦æ­£å¸¸å·¥ä½œï¼‰ã€‚

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯**å·²rootçš„è®¾å¤‡**ï¼Œåˆ™éœ€è¦åœ¨_**--gadget**_é€‰é¡¹ä¸­é€‰æ‹©è¦æµ‹è¯•çš„åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼š
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### åŸºæœ¬æ“ä½œ

æœ¬æ•™ç¨‹ä¸ä¼šåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„objectionå‘½ä»¤ï¼Œåªä¼šåˆ—å‡ºæˆ‘å‘ç°æœ€æœ‰ç”¨çš„å‘½ä»¤ã€‚

#### ç¯å¢ƒ

ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼ˆå¦‚å¯†ç æˆ–è·¯å¾„ï¼‰å¯èƒ½ä¼šåœ¨ç¯å¢ƒä¸­æ‰¾åˆ°ã€‚
```bash
env
```
![](<../../../.gitbook/assets/image (64).png>)

#### Frida ä¿¡æ¯

Frida is a dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers. It allows you to inject JavaScript code into native apps on Windows, macOS, Linux, iOS, and Android. With Frida, you can dynamically modify the behavior of an app, intercept function calls, manipulate data, and much more.

Frida provides a high-level API that simplifies the process of injecting code into apps. It also comes with a command-line tool called `frida-cli` that allows you to interact with Frida from the terminal.

Frida can be used for various purposes, including:

- Dynamic analysis: Frida allows you to inspect and modify the runtime behavior of an app, making it useful for analyzing and understanding how an app works.
- Reverse engineering: Frida can be used to reverse engineer apps by hooking into their functions and inspecting their behavior at runtime.
- Exploit development: Frida can be used to aid in the development of exploits by providing a way to inject code into vulnerable apps and manipulate their behavior.
- Security testing: Frida can be used for security testing, including vulnerability assessment and penetration testing of mobile apps.

Frida supports both iOS and Android platforms. In this tutorial, we will focus on using Frida for Android app pentesting.
```bash
frida
```
![](<../../../.gitbook/assets/image (65).png>)

#### ä¸Šä¼ /ä¸‹è½½
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### å¯¼å…¥ Frida è„šæœ¬

```javascript
const { spawn } = require('child_process');
const frida = require('frida');

async function runFridaScript() {
  try {
    // Attach to the target process
    const session = await frida.attach('com.example.app');

    // Load the script
    const script = await session.createScript(`
      // Your Frida script code here
    `);

    // Load the script into the target process
    await script.load();

    // Resume the target process
    await session.resume();

    console.log('Frida script loaded successfully');
  } catch (error) {
    console.error('Failed to load Frida script:', error);
  }
}

runFridaScript();
```

#### å¯¼å…¥ Frida è„šæœ¬

```javascript
const { spawn } = require('child_process');
const frida = require('frida');

async function runFridaScript() {
  try {
    // é™„åŠ åˆ°ç›®æ ‡è¿›ç¨‹
    const session = await frida.attach('com.example.app');

    // åŠ è½½è„šæœ¬
    const script = await session.createScript(`
      // åœ¨è¿™é‡Œç¼–å†™ä½ çš„ Frida è„šæœ¬ä»£ç 
    `);

    // å°†è„šæœ¬åŠ è½½åˆ°ç›®æ ‡è¿›ç¨‹ä¸­
    await script.load();

    // æ¢å¤ç›®æ ‡è¿›ç¨‹
    await session.resume();

    console.log('Frida è„šæœ¬åŠ è½½æˆåŠŸ');
  } catch (error) {
    console.error('åŠ è½½ Frida è„šæœ¬å¤±è´¥ï¼š', error);
  }
}

runFridaScript();
```
```bash
import <local path frida-script>
```
#### SSLPinning

SSLPinningæ˜¯ä¸€ç§ç”¨äºä¿æŠ¤ç§»åŠ¨åº”ç”¨ç¨‹åºé€šä¿¡å®‰å…¨çš„æŠ€æœ¯ã€‚å®ƒé€šè¿‡éªŒè¯æœåŠ¡å™¨çš„SSLè¯ä¹¦ï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»å’Œçªƒå¬ã€‚åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ï¼ŒSSLè¯ä¹¦é€šå¸¸ç”¨äºå»ºç«‹ä¸æœåŠ¡å™¨ä¹‹é—´çš„å®‰å…¨è¿æ¥ã€‚ç„¶è€Œï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åŠ«æŒåº”ç”¨ç¨‹åºçš„ç½‘ç»œæµé‡å¹¶æ›¿æ¢è¯ä¹¦æ¥è¿›è¡Œæ”»å‡»ã€‚

SSLPinningçš„åŸç†æ˜¯åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­å›ºå®šï¼ˆæˆ–ç»‘å®šï¼‰æœåŠ¡å™¨çš„SSLè¯ä¹¦ã€‚è¿™æ„å‘³ç€åº”ç”¨ç¨‹åºå°†åªä¿¡ä»»ç‰¹å®šçš„è¯ä¹¦ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿé»˜è®¤çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ã€‚è¿™æ ·ï¼Œå³ä½¿æ”»å‡»è€…æ›¿æ¢äº†è¯ä¹¦ï¼Œåº”ç”¨ç¨‹åºä¹Ÿä¼šå‘ç°å¹¶æ‹’ç»è¿æ¥ã€‚

åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Fridaå’ŒObjectionæ¥ç»•è¿‡SSLPinningã€‚Objectionæ˜¯ä¸€ä¸ªåŸºäºFridaçš„å·¥å…·ï¼Œç”¨äºåŠ¨æ€åˆ†æå’Œä¿®æ”¹ç§»åŠ¨åº”ç”¨ç¨‹åºã€‚é€šè¿‡ä½¿ç”¨Objectionï¼Œæˆ‘ä»¬å¯ä»¥ç»•è¿‡SSLè¯ä¹¦éªŒè¯ï¼Œä»è€ŒåŠ«æŒå’Œä¿®æ”¹åº”ç”¨ç¨‹åºçš„ç½‘ç»œæµé‡ã€‚

è¦ç»•è¿‡SSLPinningï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Objectionçš„`sslpinning disable`å‘½ä»¤ã€‚è¿™å°†ç¦ç”¨åº”ç”¨ç¨‹åºä¸­çš„SSLPinningæœºåˆ¶ï¼Œä½¿æˆ‘ä»¬èƒ½å¤ŸæŸ¥çœ‹å’Œä¿®æ”¹ç½‘ç»œæµé‡ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œç»•è¿‡SSLPinningå¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§é™ä½ï¼Œå› æ­¤åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶åº”è°¨æ…ä½¿ç”¨ã€‚

ä»¥ä¸‹æ˜¯ä½¿ç”¨Objectionç»•è¿‡SSLPinningçš„ç¤ºä¾‹å‘½ä»¤ï¼š

```plaintext
$ objection -g com.example.app explore
[tab]$ sslpinning disable
```

é€šè¿‡æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æˆåŠŸç»•è¿‡åº”ç”¨ç¨‹åºä¸­çš„SSLPinningï¼Œå¹¶å¯¹ç½‘ç»œæµé‡è¿›è¡Œåˆ†æå’Œä¿®æ”¹ã€‚
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Rootæ£€æµ‹

Rootæ£€æµ‹æ˜¯ä¸€ç§ç”¨äºæ£€æµ‹Androidè®¾å¤‡æ˜¯å¦å·²ç»è·å–äº†rootæƒé™çš„æŠ€æœ¯ã€‚åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ä¸­ï¼Œäº†è§£åº”ç”¨ç¨‹åºæ˜¯å¦èƒ½å¤Ÿæ£€æµ‹åˆ°è®¾å¤‡æ˜¯å¦å·²ç»è¢«rootæ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœåº”ç”¨ç¨‹åºèƒ½å¤Ÿæ£€æµ‹åˆ°è®¾å¤‡å·²ç»è¢«rootï¼Œå¯èƒ½ä¼šé‡‡å–ä¸€äº›å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚ç¦æ­¢è®¿é—®æŸäº›åŠŸèƒ½æˆ–é™åˆ¶åº”ç”¨ç¨‹åºçš„ä½¿ç”¨ã€‚

åœ¨è¿›è¡ŒRootæ£€æµ‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Fridaå’ŒObjectionå·¥å…·æ¥ç»•è¿‡åº”ç”¨ç¨‹åºçš„æ£€æµ‹æœºåˆ¶ã€‚Fridaæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„åŠ¨æ€æ’æ¡©å·¥å…·ï¼Œå¯ä»¥ç”¨äºä¿®æ”¹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚Objectionæ˜¯åŸºäºFridaçš„ä¸€ä¸ªæ’ä»¶ï¼Œä¸“é—¨ç”¨äºç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ã€‚

ä»¥ä¸‹æ˜¯ä½¿ç”¨Objectionç»•è¿‡Rootæ£€æµ‹çš„æ­¥éª¤ï¼š

1. é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…Fridaå’ŒObjectionå·¥å…·ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ï¼š

   ```
   pip install objection
   ```

2. å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨Objectionï¼š

   ```
   objection
   ```

3. è¿æ¥åˆ°ç›®æ ‡è®¾å¤‡ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¿æ¥åˆ°è®¾å¤‡ï¼š

   ```
   device connect
   ```

4. åœ¨è¿æ¥åˆ°è®¾å¤‡åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥ç»•è¿‡Rootæ£€æµ‹ï¼š

   ```
   android root disable
   ```

   è¿™å°†ç¦ç”¨åº”ç”¨ç¨‹åºä¸­çš„Rootæ£€æµ‹æœºåˆ¶ï¼Œä½¿å…¶æ— æ³•æ£€æµ‹åˆ°è®¾å¤‡æ˜¯å¦å·²ç»è¢«rootã€‚

é€šè¿‡ä½¿ç”¨Objectionå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ç»•è¿‡åº”ç”¨ç¨‹åºä¸­çš„Rootæ£€æµ‹æœºåˆ¶ï¼Œä»è€Œè·å¾—æ›´å¤šçš„æƒé™å’ŒåŠŸèƒ½ã€‚è¿™å¯¹äºç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬æ¨¡æ‹Ÿå·²ç»è·å–äº†rootæƒé™çš„è®¾å¤‡ï¼Œä»¥ä¾¿æµ‹è¯•åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### æ‰§è¡Œå‘½ä»¤

The `exec` command in objection allows you to execute shell commands on the target Android device. This can be useful for various purposes, such as exploring the device's file system, running scripts, or interacting with other installed applications.

To use the `exec` command, you need to specify the command you want to execute as an argument. For example, to list the files in the current directory, you can use the following command:

```
objection> exec ls
```

The output of the command will be displayed in the console. You can also capture the output and save it to a file by using the `-o` or `--output` option followed by the file path. For example:

```
objection> exec ls -o /sdcard/files.txt
```

This will save the output of the `ls` command to a file named `files.txt` in the `/sdcard` directory of the target device.

Keep in mind that the `exec` command runs the specified command as the user running the target application. Therefore, the available commands and their outputs may vary depending on the permissions and privileges of the application.

It's important to use the `exec` command responsibly and avoid executing malicious or harmful commands on the target device. Always ensure that you have proper authorization and legal permission before performing any actions that may impact the security or privacy of the device or its users.
```bash
android shell_exec whoami
```
#### æˆªå›¾

```html
<img src="screenshots/objection-tutorial-01.png" alt="Screenshot 1" width="400"/>
<img src="screenshots/objection-tutorial-02.png" alt="Screenshot 2" width="400"/>
<img src="screenshots/objection-tutorial-03.png" alt="Screenshot 3" width="400"/>
<img src="screenshots/objection-tutorial-04.png" alt="Screenshot 4" width="400"/>
```

#### æˆªå›¾

```html
<img src="screenshots/objection-tutorial-01.png" alt="æˆªå›¾ 1" width="400"/>
<img src="screenshots/objection-tutorial-02.png" alt="æˆªå›¾ 2" width="400"/>
<img src="screenshots/objection-tutorial-03.png" alt="æˆªå›¾ 3" width="400"/>
<img src="screenshots/objection-tutorial-04.png" alt="æˆªå›¾ 4" width="400"/>
```
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### é™æ€åˆ†æå˜ä¸ºåŠ¨æ€åˆ†æ

åœ¨ä½¿ç”¨objectionä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥é€šè¿‡**é™æ€åˆ†æ**äº†è§£æœ¬éƒ¨åˆ†å‘ç°çš„æ‰€æœ‰ä¿¡æ¯ã€‚æ— è®ºå¦‚ä½•ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°**ä¸€äº›æ–°çš„ä¸œè¥¿**ï¼Œå› ä¸ºæ‚¨å°†è·å¾—ä¸€ä¸ªå®Œæ•´çš„ç±»ã€æ–¹æ³•å’Œå¯¼å‡ºå¯¹è±¡åˆ—è¡¨ã€‚

å¦‚æœæ‚¨æ— æ³•è·å–åº”ç”¨ç¨‹åºçš„å¯è¯»æºä»£ç ï¼Œè¿™ä¹Ÿæ˜¯æœ‰ç”¨çš„ã€‚

#### åˆ—å‡ºæ´»åŠ¨ã€æ¥æ”¶å™¨å’ŒæœåŠ¡
```
android hooking list activities
```
![](<../../../.gitbook/assets/image (78).png>)
```
android hooking list services
android hooking list receivers
```
å¦‚æœæ‰¾ä¸åˆ°Fridaï¼Œå®ƒå°†ä¼šæŠ¥é”™

#### è·å–å½“å‰æ´»åŠ¨
```
android hooking get current_activity
```
#### æœç´¢ç±»

è®©æˆ‘ä»¬å¼€å§‹åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­æŸ¥æ‰¾ç±»
```
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (69).png>)

#### æœç´¢ç±»çš„æ–¹æ³•

ç°åœ¨è®©æˆ‘ä»¬æå–_MainActivity_ç±»ä¸­çš„æ–¹æ³•ï¼š
```
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (70) (1).png>)

#### åˆ—å‡ºç±»çš„å£°æ˜æ–¹æ³•åŠå…¶å‚æ•°

è®©æˆ‘ä»¬æ‰¾å‡ºç±»çš„æ–¹æ³•éœ€è¦å“ªäº›å‚æ•°ï¼š
```
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (79).png>)

#### åˆ—å‡ºç±»

æ‚¨è¿˜å¯ä»¥åˆ—å‡ºå½“å‰åº”ç”¨ç¨‹åºä¸­åŠ è½½çš„æ‰€æœ‰ç±»ï¼š
```
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
è¿™å¯¹äºæƒ³è¦**é’©å–ä¸€ä¸ªç±»çš„æ–¹æ³•ï¼Œä½†åªçŸ¥é“ç±»å**çš„æƒ…å†µéå¸¸æœ‰ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°æ¥**æœç´¢æ‹¥æœ‰è¯¥ç±»çš„æ¨¡å—**ï¼Œç„¶åé’©å–å…¶æ–¹æ³•ã€‚

### é’©å–éå¸¸ç®€å•

#### é’©å–ï¼ˆç›‘è§†ï¼‰ä¸€ä¸ªæ–¹æ³•

ä»åº”ç”¨ç¨‹åºçš„[æºä»£ç ](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt)ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“**MainActivity**ä¸­çš„**å‡½æ•°**_**sum()**_**æ¯ç§’éƒ½åœ¨è¿è¡Œ**ã€‚è®©æˆ‘ä»¬å°è¯•åœ¨æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶**è½¬å‚¨æ‰€æœ‰å¯èƒ½çš„ä¿¡æ¯**ï¼ˆå‚æ•°ã€è¿”å›å€¼å’Œå›æº¯ï¼‰ï¼š
```
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (71).png>)

#### é’©ä½ï¼ˆç›‘è§†ï¼‰æ•´ä¸ªç±»

å®é™…ä¸Šï¼Œæˆ‘å‘ç°MainActivityç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½éå¸¸æœ‰è¶£ï¼Œè®©æˆ‘ä»¬**é’©ä½å®ƒä»¬**ã€‚è¯·æ³¨æ„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åº**å´©æºƒ**ã€‚
```
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
å¦‚æœæ‚¨åœ¨ç±»è¢«æŒ‚é’©çš„æƒ…å†µä¸‹æ“ä½œåº”ç”¨ç¨‹åºï¼Œæ‚¨å°†ä¼šçœ‹åˆ°æ¯ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶çš„å‚æ•°å’Œè¿”å›å€¼ã€‚

![](<../../../.gitbook/assets/image (72).png>)

#### æ›´æ”¹å‡½æ•°çš„å¸ƒå°”è¿”å›å€¼

ä»æºä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°_checkPin_æ¥æ”¶ä¸€ä¸ª_String_ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª_boolean_ã€‚è®©æˆ‘ä»¬è®©è¿™ä¸ªå‡½æ•°**å§‹ç»ˆè¿”å›true**ï¼š

![](<../../../.gitbook/assets/image (74).png>)

ç°åœ¨ï¼Œå¦‚æœæ‚¨åœ¨PINç çš„æ–‡æœ¬æ¡†ä¸­è¾“å…¥ä»»ä½•å†…å®¹ï¼Œæ‚¨å°†çœ‹åˆ°ä»»ä½•å†…å®¹éƒ½æ˜¯æœ‰æ•ˆçš„ï¼š

![](<../../../.gitbook/assets/image (77).png>)

### ç±»å®ä¾‹

æœç´¢å¹¶æ‰“å°æŒ‡å®šçš„Javaç±»çš„**æ´»åŠ¨å®ä¾‹**ï¼Œç”±å®Œå…¨é™å®šçš„ç±»åæŒ‡å®šã€‚è¾“å‡ºæ˜¯å°è¯•è·å–å‘ç°çš„åå¯¹æ„è§çš„å­—ç¬¦ä¸²å€¼çš„ç»“æœï¼Œè¯¥å­—ç¬¦ä¸²å€¼é€šå¸¸**åŒ…å«å¯¹è±¡çš„å±æ€§å€¼**ã€‚
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (80).png>)

### Keystore/Intents

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥æ“ä½œå¯†é’¥åº“å’Œæ„å›¾ï¼š
```
android keystore list
android intents launch_activity
android intent launch_service
```
#### å†…å­˜

##### è½¬å‚¨

åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è·å–åº”ç”¨ç¨‹åºçš„å†…å­˜è½¬å‚¨ã€‚å†…å­˜è½¬å‚¨æ˜¯åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶çš„å¿«ç…§ï¼Œå…¶ä¸­åŒ…å«äº†åº”ç”¨ç¨‹åºçš„ä»£ç ã€æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚é€šè¿‡åˆ†æå†…å­˜è½¬å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´ã€æ•æ„Ÿæ•°æ®ä»¥åŠå…¶ä»–æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚

Frida æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–åº”ç”¨ç¨‹åºçš„å†…å­˜è½¬å‚¨ã€‚Objection æ˜¯ Frida çš„ä¸€ä¸ªæ’ä»¶ï¼Œå®ƒæä¾›äº†ä¸€äº›æ–¹ä¾¿çš„å‘½ä»¤å’ŒåŠŸèƒ½ï¼Œç”¨äºåœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ä¸­è¿›è¡Œå†…å­˜è½¬å‚¨ã€‚

è¦ä½¿ç”¨ Objection è¿›è¡Œå†…å­˜è½¬å‚¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¿æ¥åˆ°ç›®æ ‡è®¾å¤‡ä¸Šçš„åº”ç”¨ç¨‹åºã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ°è®¾å¤‡ä¸Šçš„åº”ç”¨ç¨‹åºï¼š

```
objection -N -g com.example.app explore
```

è¿™å°†å¯åŠ¨ Objection å¹¶è¿æ¥åˆ°æŒ‡å®šçš„åº”ç”¨ç¨‹åºã€‚ä¸€æ—¦è¿æ¥æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è·å–å†…å­˜è½¬å‚¨ï¼š

```
memory dump
```

è¿™å°†åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `memory_dump.bin` çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†åº”ç”¨ç¨‹åºçš„å†…å­˜è½¬å‚¨ã€‚

è·å–å†…å­˜è½¬å‚¨åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–å·¥å…·æ¥åˆ†æå’Œæå–å…¶ä¸­çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `volatility` å·¥å…·æ¥åˆ†æå†…å­˜è½¬å‚¨ä¸­çš„è¿›ç¨‹ã€çº¿ç¨‹ã€æ–‡ä»¶å¥æŸ„ç­‰ä¿¡æ¯ã€‚

é€šè¿‡è·å–åº”ç”¨ç¨‹åºçš„å†…å­˜è½¬å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥æ·±å…¥äº†è§£åº”ç”¨ç¨‹åºçš„å†…éƒ¨è¿è¡Œæœºåˆ¶ï¼Œå¹¶å‘ç°æ½œåœ¨çš„æ¼æ´å’Œæ•æ„Ÿæ•°æ®ã€‚è¿™å¯¹äºç§»åŠ¨åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å’Œè¯„ä¼°ç›®æ ‡åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### åˆ—è¡¨

---

#### Introduction

#### ä»‹ç»

In this tutorial, we will learn how to use Objection, a runtime mobile exploration toolkit, to perform various tasks during Android application penetration testing.

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Objectionï¼Œä¸€ä¸ªè¿è¡Œæ—¶ç§»åŠ¨æ¢ç´¢å·¥å…·åŒ…ï¼Œåœ¨ Android åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æœŸé—´æ‰§è¡Œå„ç§ä»»åŠ¡ã€‚

---

#### Prerequisites

#### å…ˆå†³æ¡ä»¶

Before we begin, make sure you have the following:

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š

- A rooted Android device or an emulator with Frida Server installed.

- å®‰è£…äº† Frida Server çš„å·² root çš„ Android è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ã€‚

- Frida CLI installed on your machine.

- åœ¨æ‚¨çš„è®¡ç®—æœºä¸Šå®‰è£…äº† Frida CLIã€‚

- Basic knowledge of Android application security and penetration testing.

- å¯¹ Android åº”ç”¨ç¨‹åºå®‰å…¨å’Œæ¸—é€æµ‹è¯•æœ‰åŸºæœ¬çš„äº†è§£ã€‚

---

#### Setting Up the Environment

#### è®¾ç½®ç¯å¢ƒ

1. Install Frida Server on your rooted Android device or emulator.

1. åœ¨å·² root çš„ Android è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸Šå®‰è£… Frida Serverã€‚

2. Connect your device or emulator to your machine using USB.

2. ä½¿ç”¨ USB å°†æ‚¨çš„è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨è¿æ¥åˆ°è®¡ç®—æœºã€‚

3. Open a terminal and run the following command to check if your device is connected:

3. æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ£€æŸ¥è®¾å¤‡æ˜¯å¦å·²è¿æ¥ï¼š

   ```bash
   adb devices
   ```

   You should see your device listed.

   æ‚¨åº”è¯¥çœ‹åˆ°æ‚¨çš„è®¾å¤‡å·²åˆ—å‡ºã€‚

4. Install Frida CLI by running the following command:

4. è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Frida CLIï¼š

   ```bash
   pip install frida-tools
   ```

---

#### Starting Objection

#### å¯åŠ¨ Objection

1. Open a terminal and run the following command to start Objection:

1. æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å¯åŠ¨ Objectionï¼š

   ```bash
   objection
   ```

2. Objection will start and display the prompt `objection>`. You are now ready to use Objection commands.

2. Objection å°†å¯åŠ¨å¹¶æ˜¾ç¤ºæç¤ºç¬¦ `objection>`ã€‚ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ Objection å‘½ä»¤äº†ã€‚

---

#### Conclusion

#### ç»“è®º

In this tutorial, we learned how to set up the environment for using Objection and how to start Objection. In the next tutorials, we will explore various Objection commands and techniques for Android application penetration testing.

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è®¾ç½®ä½¿ç”¨ Objection çš„ç¯å¢ƒä»¥åŠå¦‚ä½•å¯åŠ¨ Objectionã€‚åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢å„ç§ Objection å‘½ä»¤å’ŒæŠ€æœ¯ï¼Œç”¨äº Android åº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•ã€‚
```
memory list modules
```
![](<../../../.gitbook/assets/image (66).png>)

åœ¨åˆ—è¡¨åº•éƒ¨ï¼Œä½ å¯ä»¥çœ‹åˆ°Fridaï¼š

![](<../../../.gitbook/assets/image (67).png>)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹Fridaå¯¼å‡ºäº†ä»€ä¹ˆï¼š

![](<../../../.gitbook/assets/image (68).png>)

#### æœç´¢/å†™å…¥

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Objectionåœ¨å†…å­˜ä¸­è¿›è¡Œæœç´¢å’Œå†™å…¥æ“ä½œï¼š
```
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

æ‚¨å¯ä»¥ä½¿ç”¨å‘½ä»¤`sqlite`ä¸SQLiteæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

### é€€å‡º
```
exit
```
## æˆ‘åœ¨Objectionä¸­æ‰€ç¼ºå°‘çš„åŠŸèƒ½

* é’©å­æ–¹æ³•æœ‰æ—¶ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒï¼ˆè¿™ä¹Ÿæ˜¯ç”±äºFridaï¼‰ã€‚
* æ— æ³•ä½¿ç”¨ç±»çš„å®ä¾‹æ¥è°ƒç”¨å®ä¾‹çš„å‡½æ•°ã€‚ä¹Ÿæ— æ³•åˆ›å»ºæ–°çš„ç±»å®ä¾‹å¹¶ä½¿ç”¨å®ƒä»¬æ¥è°ƒç”¨å‡½æ•°ã€‚
* æ²¡æœ‰å¿«æ·æ–¹å¼ï¼ˆç±»ä¼¼äºsslpinningï¼‰æ¥é’©ä½åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰å¸¸è§åŠ å¯†æ–¹æ³•ï¼Œä»¥æŸ¥çœ‹åŠ å¯†æ–‡æœ¬ã€æ˜æ–‡ã€å¯†é’¥ã€IVå’Œç®—æ³•ã€‚

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bugèµé‡‘æç¤º**ï¼š**æ³¨å†Œ**Intigritiï¼Œä¸€ä¸ªç”±é»‘å®¢åˆ›å»ºçš„é«˜çº§**Bugèµé‡‘å¹³å°**ï¼ç«‹å³åŠ å…¥æˆ‘ä»¬çš„[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾**$100,000**çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“](https://opensea.io/collection/the-peass-family)â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
