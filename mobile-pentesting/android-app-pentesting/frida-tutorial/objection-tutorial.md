# Objection Tutorijal

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Uvod**

**objection - Runtime Mobile Exploration**

[**Objection**](https://github.com/sensepost/objection) je alat za istraÅ¾ivanje mobilnih aplikacija u realnom vremenu, pokretan od strane [Frida](https://www.frida.re). Napravljen je sa ciljem da pomogne u proceni mobilnih aplikacija i njihovog bezbednosnog poloÅ¾aja bez potrebe za jailbroken ili rooted mobilnim ureÄ‘ajem.

**Napomena:** Ovo nije neka vrsta jailbreak / root zaobilaska. KoriÅ¡Ä‡enjem `objection`, i dalje ste ograniÄeni svim restrikcijama koje nameÄ‡e odgovarajuÄ‡i sandbox sa kojim se suoÄavate.

### Rezime

**Cilj** **objection**-a je omoguÄ‡iti korisniku da pozove **glavne akcije koje nudi Frida**. **InaÄe**, korisnik Ä‡e morati da napravi **jedan skript za svaku aplikaciju** koju Å¾eli da testira.

## Tutorijal

Za ovaj tutorijal Ä‡u koristiti APK koji moÅ¾ete preuzeti ovde:

{% file src="../../../.gitbook/assets/app-release.zip" %}

Ili sa njegovog [originalnog repozitorijuma ](https://github.com/asvid/FridaApp)(preuzmite app-release.apk)

### Instalacija
```bash
pip3 install objection
```
### Povezivanje

Napravite **obiÄnu ADB konekciju** i **pokrenite** frida server na ureÄ‘aju (i proverite da li frida radi i na klijentu i na serveru).

Ako koristite **rootovani ureÄ‘aj**, potrebno je izabrati aplikaciju koju Å¾elite testirati unutar opcije _**--gadget**_. U ovom sluÄaju:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Osnovne radnje

NeÄ‡e biti navedene sve moguÄ‡e komande objekcije u ovom tutorijalu, veÄ‡ samo one koje sam smatrao korisnijim.

#### OkruÅ¾enje

Neke zanimljive informacije (poput lozinki ili putanja) mogu se pronaÄ‡i unutar okruÅ¾enja.
```bash
env
```
#### Frida Informacije
```bash
frida
```
![](<../../../.gitbook/assets/image (1090).png>)

#### Postavi/Preuzmi
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Uvoz frida skripte
```bash
import <local path frida-script>
```
#### SSLPinning
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Detekcija root-a
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### IzvrÅ¡i komandu
```bash
android shell_exec whoami
```
#### Snimci ekrana
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### StatistiÄka analiza pretvorena u dinamiÄku

U stvarnoj aplikaciji trebalo bi da znamo sve informacije otkrivene u ovom delu pre koriÅ¡Ä‡enja prigovora zahvaljujuÄ‡i **statistiÄkoj analizi**. U svakom sluÄaju, na ovaj naÄin moÅ¾da moÅ¾ete videti **neÅ¡to novo** jer Ä‡ete ovde imati potpuni spisak klasa, metoda i izvezenih objekata.

Ovo je takoÄ‘e korisno ako iz nekog razloga **niste u moguÄ‡nosti da dobijete neki Äitljiv izvorni kod** aplikacije.

#### Spisak aktivnosti, prijemnika i servisa
```bash
android hooking list activities
```
![](<../../../.gitbook/assets/image (1013).png>)
```bash
android hooking list services
android hooking list receivers
```
Frida Ä‡e pokrenuti greÅ¡ku ako niÅ¡ta nije pronaÄ‘eno

#### Dobijanje trenutne aktivnosti
```bash
android hooking get current_activity
```
![](<../../../.gitbook/assets/image (810).png>)

#### Pretraga Klasa

PoÄnimo sa traÅ¾enjem klasa unutar naÅ¡e aplikacije
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (504).png>)

#### Pretraga metoda klase

Sada Ä‡emo izdvojiti metode unutar klase _MainActivity:_
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (926).png>)

#### Lista deklarisanih metoda klase sa njihovim parametrima

Otkrijmo koje parametre metodi klase zahtevaju:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (296).png>)

#### Lista klasa

TakoÄ‘e moÅ¾ete da prikaÅ¾ete sve klase koje su uÄitane unutar trenutne aplikacije:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Ovo je veoma korisno ako Å¾elite da **poveÅ¾ete metodu klase, a znate samo ime klase**. MoÅ¾ete koristiti ovu funkciju da **pronaÄ‘ete koji modul poseduje klasu** i zatim poveÅ¾ete njenu metodu.

### Povezivanje je lako

#### Povezivanje (praÄ‡enje) metode

Iz [izvornog koda](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) aplikacije znamo da se **funkcija** _**sum()**_ **iz klase** _**MainActivity**_ **izvrÅ¡ava svake sekunde**. PokuÅ¡ajmo **da izbacimo sve moguÄ‡e informacije** svaki put kada se funkcija pozove (argumente, vrednost povratka i stek poziva):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (1083).png>)

#### Hakovanje (pratnja) cele klase

Zapravo, smatram da su svi metodi klase MainActivity zaista interesantni, hajde da ih **hukujemo sve**. Budite oprezni, ovo moÅ¾e **uzrokovati pad** aplikacije.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
Ako igrate sa aplikacijom dok je klasa povezana, videÄ‡ete kada se **svaka funkcija poziva**, njene **argumente** i **vrednost povratka**.

![](<../../../.gitbook/assets/image (858).png>)

#### Menjanje boolean vrednosti povratka funkcije

Iz izvornog koda moÅ¾ete videti da funkcija _checkPin_ dobija _String_ kao argument i vraÄ‡a _boolean_. Hajde da funkciju **uvek vraÄ‡a true**:

![](<../../../.gitbook/assets/image (880).png>)

Sada, ako unesete bilo Å¡ta u polje za unos PIN koda, videÄ‡ete da je sve validno:

![](<../../../.gitbook/assets/image (225).png>)

### Instance klase

PretraÅ¾ite i Å¡tampajte **aktivne instance odreÄ‘ene Java klase**, navedene potpuno kvalifikovanim imenom klase. Rezultat je pokuÅ¡aj dobijanja string vrednosti za otkriveni prigovor koji bi tipiÄno **sadrÅ¾avao vrednosti svojstava objekta**.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (1092).png>)

### Keystore/Intents

MoÅ¾ete se igrati sa keystore-om i intentima koristeÄ‡i:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
### Memorija

#### Izbacivanje
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Lista
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (283).png>)

Na dnu liste moÅ¾ete videti Fridu:

![](<../../../.gitbook/assets/image (1094).png>)

Pogledajmo Å¡ta Frida izvozi:

![](<../../../.gitbook/assets/image (295).png>)

#### Pretraga/Pisanje

TakoÄ‘e moÅ¾ete pretraÅ¾ivati i pisati unutar memorije pomoÄ‡u Objection-a:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

MoÅ¾ete koristiti komandu `sqlite` da biste interagovali sa SQLite bazama podataka.

### Exit
```bash
exit
```
## Å ta mi nedostaje u Objection-u

* Metode hakovanja ponekad ruÅ¡e aplikaciju (ovo je takoÄ‘e zbog Fridda).
* Ne moÅ¾ete koristiti instance klasa da biste pozvali funkcije instance. I ne moÅ¾ete kreirati nove instance klasa i koristiti ih da biste pozvali funkcije.
* Ne postoji preÄica (poput one za sslpinnin) da hakujete sve uobiÄajene kripto metode koje koristi aplikacija kako biste videli Å¡ifrovani tekst, obiÄan tekst, kljuÄeve, IV-e i algoritme koji se koriste.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! PridruÅ¾ite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i poÄnite da zaraÄ‘ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
