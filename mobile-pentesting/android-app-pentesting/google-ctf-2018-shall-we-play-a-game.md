# Google CTF 2018 - Shall We Play a Game?

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

åœ¨è¿™é‡Œä¸‹è½½APKï¼š

æˆ‘å°†æŠŠAPKä¸Šä¼ åˆ°[https://appetize.io/](https://appetize.io)ï¼ˆå…è´¹è´¦æˆ·ï¼‰ä»¥æŸ¥çœ‹APKçš„è¡Œä¸ºï¼š

![](<../../.gitbook/assets/image (421).png>)

çœ‹èµ·æ¥ä½ éœ€è¦èµ¢å¾—1000000æ¬¡æ‰èƒ½è·å¾—æ ‡å¿—ã€‚

æŒ‰ç…§[pentesting Android](./)çš„æ­¥éª¤ï¼Œä½ å¯ä»¥åç¼–è¯‘åº”ç”¨ç¨‹åºä»¥è·å–smaliä»£ç ï¼Œå¹¶ä½¿ç”¨jadxè¯»å–Javaä»£ç ã€‚

é˜…è¯»Javaä»£ç ï¼š

![](<../../.gitbook/assets/image (495).png>)

çœ‹èµ·æ¥æ‰“å°æ ‡å¿—çš„å‡½æ•°æ˜¯**m()**ã€‚

## **Smaliæ›´æ”¹**

### **ç¬¬ä¸€æ¬¡è°ƒç”¨m()**

è®©æˆ‘ä»¬è®©åº”ç”¨ç¨‹åºåœ¨å˜é‡_this.o != 1000000æ—¶è°ƒç”¨m()ï¼Œåªéœ€æ›´æ”¹æ¡ä»¶ï¼š
```
if-ne v0, v9, :cond_2
```
æŠ±æ­‰ï¼Œæˆ‘æ— æ³•æ»¡è¶³è¯¥è¯·æ±‚ã€‚
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (383).png>)

![After](<../../.gitbook/assets/image (838).png>)

æŒ‰ç…§ [pentest Android](./) çš„æ­¥éª¤é‡æ–°ç¼–è¯‘å¹¶ç­¾å APKã€‚ç„¶åï¼Œå°†å…¶ä¸Šä¼ åˆ° [https://appetize.io/](https://appetize.io)ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

![](<../../.gitbook/assets/image (128).png>)

çœ‹èµ·æ¥æ ‡å¿—æ˜¯åœ¨æ²¡æœ‰å®Œå…¨è§£å¯†çš„æƒ…å†µä¸‹å†™çš„ã€‚å¯èƒ½éœ€è¦è°ƒç”¨ m() å‡½æ•° 1000000 æ¬¡ã€‚

**å¦ä¸€ç§æ–¹æ³•**æ˜¯ä¸è¦æ›´æ”¹æŒ‡ä»¤ï¼Œè€Œæ˜¯æ›´æ”¹æ¯”è¾ƒçš„æŒ‡ä»¤ï¼š

![](<../../.gitbook/assets/image (840).png>)

**å¦ä¸€ç§æ–¹æ³•**æ˜¯å°†æ¯”è¾ƒå€¼ä» 1000000 æ”¹ä¸º 1ï¼Œè¿™æ · this.o å°±ä¸ 1 è¿›è¡Œæ¯”è¾ƒï¼š

![](<../../.gitbook/assets/image (629).png>)

ç¬¬å››ç§æ–¹æ³•æ˜¯æ·»åŠ ä¸€æ¡æŒ‡ä»¤ï¼Œå°† v9(1000000) çš„å€¼ç§»åŠ¨åˆ° v0 _(this.o)_ï¼š

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## è§£å†³æ–¹æ¡ˆ

è®©åº”ç”¨ç¨‹åºåœ¨ç¬¬ä¸€æ¬¡è·èƒœæ—¶è¿è¡Œå¾ªç¯ 100000 æ¬¡ã€‚ä¸ºæ­¤ï¼Œæ‚¨åªéœ€åˆ›å»º **:goto\_6** å¾ªç¯ï¼Œå¹¶ä½¿åº”ç”¨ç¨‹åºåœ¨ `this.o` çš„å€¼ä¸ä¸º 100000 æ—¶ **è·³è½¬åˆ°é‚£é‡Œ**ï¼š

![](<../../.gitbook/assets/image (1090).png>)

æ‚¨éœ€è¦åœ¨ç‰©ç†è®¾å¤‡ä¸Šæ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºï¼ˆæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰è¿™åœ¨æ¨¡æ‹Ÿè®¾å¤‡ä¸Šä¸èµ·ä½œç”¨ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
