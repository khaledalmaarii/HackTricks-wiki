# Google CTF 2018 - ê²Œì„ì„ í•´ë³¼ê¹Œìš”?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

APKë¥¼ ì—¬ê¸°ì—ì„œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”:

APKê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ APKë¥¼ [https://appetize.io/](https://appetize.io) (ë¬´ë£Œ ê³„ì •)ì— ì—…ë¡œë“œí•  ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (46).png>)

í”Œë˜ê·¸ë¥¼ ì–»ìœ¼ë ¤ë©´ 1000000ë²ˆ ì´ê¸°ì…”ì•¼ í•©ë‹ˆë‹¤.

[Android ì•± íœí…ŒìŠ¤íŒ…](./)ì˜ ë‹¨ê³„ë¥¼ ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë””ì»´íŒŒì¼í•˜ì—¬ smali ì½”ë“œë¥¼ ì–»ê³ , jadxë¥¼ ì‚¬ìš©í•˜ì—¬ Java ì½”ë“œë¥¼ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Java ì½”ë“œë¥¼ ì½ì–´ë³´ë©´:

![](<../../.gitbook/assets/image (47).png>)

í”Œë˜ê·¸ë¥¼ ì¶œë ¥í•  í•¨ìˆ˜ëŠ” **m()**ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

## **Smali ë³€ê²½**

### **ì²« ë²ˆì§¸ë¡œ m() í˜¸ì¶œí•˜ê¸°**

ë³€ìˆ˜ _this.o != 1000000_ì´ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ m()ì„ í˜¸ì¶œí•˜ë„ë¡ ë§Œë“¤ê¸° ìœ„í•´ ì¡°ê±´ì„ ë³€ê²½í•˜ì„¸ìš”:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Google CTF 2018 - Shall we play a game?

## Introduction

In this challenge, we are given an Android application called "Shall we play a game?" and our goal is to find the flag. The application has a login screen and a game screen where we can play a game of Tic Tac Toe against the computer.

## Analyzing the APK

To start, we need to analyze the APK file of the application. We can use tools like JADX or APKTool to decompile the APK and examine its code. By analyzing the code, we can understand how the application works and look for any vulnerabilities.

## Reverse Engineering the Code

After decompiling the APK, we can start reverse engineering the code. We can look for interesting functions, API calls, or any other clues that might help us find the flag. It's important to understand the logic of the application and how it handles user input.

## Finding the Flag

In this challenge, the flag is stored in a file called "flag.txt" in the assets folder of the APK. We can use tools like JADX or APKTool to extract the file from the APK. Once we have the flag, we can submit it and complete the challenge.

## Conclusion

In this challenge, we learned how to analyze and reverse engineer an Android application to find the flag. By understanding the code and looking for vulnerabilities, we were able to extract the flag and complete the challenge.

---

# Google CTF 2018 - ê²Œì„ì„ í•´ë³¼ê¹Œìš”?

## ì†Œê°œ

ì´ ë„ì „ì—ì„œëŠ” "ê²Œì„ì„ í•´ë³¼ê¹Œìš”?"ë¼ëŠ” ì´ë¦„ì˜ Android ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì œê³µë°›ì•˜ìœ¼ë©°, ëª©í‘œëŠ” í”Œë˜ê·¸ë¥¼ ì°¾ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ëŠ” ë¡œê·¸ì¸ í™”ë©´ê³¼ ì»´í“¨í„°ì™€ ëŒ€ì „í•  ìˆ˜ ìˆëŠ” Tic Tac Toe ê²Œì„ í™”ë©´ì´ ìˆìŠµë‹ˆë‹¤.

## APK ë¶„ì„

ë¨¼ì €, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ APK íŒŒì¼ì„ ë¶„ì„í•´ì•¼ í•©ë‹ˆë‹¤. JADXë‚˜ APKToolê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ APKë¥¼ ë””ì»´íŒŒì¼í•˜ê³  ì½”ë“œë¥¼ ì¡°ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ë¶„ì„í•¨ìœ¼ë¡œì¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì´í•´í•˜ê³  ì·¨ì•½ì ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì½”ë“œ ì—­ê³µí•™

APKë¥¼ ë””ì»´íŒŒì¼í•œ í›„, ì½”ë“œë¥¼ ì—­ê³µí•™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í¥ë¯¸ë¡œìš´ í•¨ìˆ˜, API í˜¸ì¶œ ë˜ëŠ” í”Œë˜ê·¸ë¥¼ ì°¾ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ë‹¨ì„œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë…¼ë¦¬ì™€ ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ ë°©ì‹ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

## í”Œë˜ê·¸ ì°¾ê¸°

ì´ ë„ì „ì—ì„œ í”Œë˜ê·¸ëŠ” APKì˜ assets í´ë”ì— ìˆëŠ” "flag.txt"ë¼ëŠ” íŒŒì¼ì— ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤. JADXë‚˜ APKToolê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ APKì—ì„œ íŒŒì¼ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”Œë˜ê·¸ë¥¼ ì–»ì€ í›„, ì œì¶œí•˜ì—¬ ë„ì „ì„ ì™„ë£Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê²°ë¡ 

ì´ ë„ì „ì—ì„œëŠ” Android ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¶„ì„í•˜ê³  ì—­ê³µí•™í•˜ì—¬ í”Œë˜ê·¸ë¥¼ ì°¾ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ì´í•´í•˜ê³  ì·¨ì•½ì ì„ ì°¾ìŒìœ¼ë¡œì¨ í”Œë˜ê·¸ë¥¼ ì¶”ì¶œí•˜ê³  ë„ì „ì„ ì™„ë£Œí•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

[Android íœí…ŒìŠ¤íŠ¸](./)ì˜ ë‹¨ê³„ë¥¼ ë”°ë¼ APKë¥¼ ë‹¤ì‹œ ì»´íŒŒì¼í•˜ê³  ì„œëª…í•˜ì„¸ìš”. ê·¸ëŸ° ë‹¤ìŒ [https://appetize.io/](https://appetize.io)ì— ì—…ë¡œë“œí•˜ê³  ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ í™•ì¸í•´ ë´…ì‹œë‹¤:

![](<../../.gitbook/assets/image (50).png>)

ì „ì²´ ë³µí˜¸í™” ì—†ì´ í”Œë˜ê·¸ê°€ ì‘ì„±ëœ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì•„ë§ˆë„ m() í•¨ìˆ˜ë¥¼ 1000000ë²ˆ í˜¸ì¶œí•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.

ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” **ë‹¤ë¥¸ ë°©ë²•**ì€ ëª…ë ¹ì„ ë³€ê²½í•˜ì§€ ì•Šê³  ë¹„êµ ëª…ë ¹ì„ ë³€ê²½í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (55).png>)

**ë˜ ë‹¤ë¥¸ ë°©ë²•**ì€ 1000000ê³¼ ë¹„êµí•˜ëŠ” ëŒ€ì‹  ê°’ì„ 1ë¡œ ì„¤ì •í•˜ì—¬ this.oê°€ 1ê³¼ ë¹„êµë˜ë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (57).png>)

ë„¤ ë²ˆì§¸ ë°©ë²•ì€ v9(1000000)ì˜ ê°’ì„ v0 _(this.o)_ë¡œ ì´ë™ì‹œí‚¤ëŠ” ëª…ë ¹ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## í•´ê²°ì±…

ì²« ë²ˆì§¸ë¡œ ì´ê¸°ë©´ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë£¨í”„ë¥¼ 100000ë²ˆ ì‹¤í–‰í•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ **:goto\_6** ë£¨í”„ë¥¼ ìƒì„±í•˜ê³  ì‘ìš© í”„ë¡œê·¸ë¨ì´ `this.o`ê°€ 100000ê³¼ ê°™ì§€ ì•Šìœ¼ë©´ **ê±°ê¸°ë¡œ ì´ë™í•˜ë„ë¡** ë§Œë“¤ë©´ ë©ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (59).png>)

ì´ ì‘ì—…ì€ ë¬¼ë¦¬ì  ì¥ì¹˜ì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤. (ì™œì¸ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ) ì—ë®¬ë ˆì´ì…˜ëœ ì¥ì¹˜ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* íšŒì‚¬ë¥¼ **HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PDFë¡œ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ìˆ ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
