# Google CTF 2018 - Czy zagramy w gr?

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

Pobierz APK tutaj:

Zamierzam przesa APK na [https://appetize.io/](https://appetize.io) (darmowe konto), aby zobaczy, jak zachowuje si apk:

![](<../../.gitbook/assets/image (46).png>)

Wyglda na to, 偶e musisz wygra 1000000 razy, aby zdoby flag.

Postpujc zgodnie z krokami z [pentestowania Androida](./), mo偶esz zdekompilowa aplikacj, aby uzyska kod smali i odczyta kod Java za pomoc jadx.

Odczytanie kodu Java:

![](<../../.gitbook/assets/image (47).png>)

Wyglda na to, 偶e funkcja, kt贸ra wywietli flag, to **m().**

## **Zmiany w kodzie Smali**

### **Wywoanie m() po raz pierwszy**

Za贸偶my, 偶e aplikacja wywouje m(), jeli zmienna _this.o != 1000000_, aby to zrobi, po prostu zmie warunek:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Google CTF 2018 - Shall we play a game?

## Introduction

In this challenge, we are given an Android application called "Shall we play a game?" and our goal is to find the flag. The application has a login screen where we need to enter a username and password. After successful login, we are presented with a game screen.

## Analyzing the APK

To start our analysis, we can extract the APK file from the Android device using tools like `adb` or by directly downloading it from the Google Play Store. Once we have the APK file, we can use tools like `apktool` or `dex2jar` to decompile it and analyze the code.

## Reverse Engineering the Code

After decompiling the APK, we can start reverse engineering the code to understand its functionality. We can look for interesting classes, methods, and strings that might contain useful information.

## Finding the Flag

In this challenge, the flag is hidden within the code. We can search for the string "CTF{" to find the flag. Once we find the flag, we can extract it and submit it to complete the challenge.

## Conclusion

In this challenge, we learned how to analyze and reverse engineer an Android application to find hidden information like flags. This skill is essential for mobile application penetration testing and can help us identify vulnerabilities and secure our applications.
```
if-eq v0, v9, :cond_2
```
![Przed](<../../.gitbook/assets/image (48).png>)

![Po](<../../.gitbook/assets/image (49).png>)

Postpuj zgodnie z krokami [pentestu Androida](./), aby ponownie skompilowa i podpisa plik APK. Nastpnie, przesa go na [https://appetize.io/](https://appetize.io) i zobaczy, co si stanie:

![](<../../.gitbook/assets/image (50).png>)

Wyglda na to, 偶e flaga jest zapisana bez penego odszyfrowania. Prawdopodobnie funkcja m() powinna by wywoana 1000000 razy.

**Inny spos贸b** na to jest nie zmienia instrukcji, ale zmieni instrukcje por贸wnujce:

![](<../../.gitbook/assets/image (55).png>)

**Inny spos贸b** to zamiast por贸wnywa z 1000000, ustawi warto na 1, aby this.o by por贸wnywany z 1:

![](<../../.gitbook/assets/image (57).png>)

Czwarty spos贸b to dodanie instrukcji przenoszcej warto v9(1000000) do v0 _(this.o)_:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## Rozwizanie

Spowoduj, 偶e aplikacja wykona ptl 100000 razy, gdy wygrasz pierwszy raz. Aby to zrobi, wystarczy utworzy ptl **:goto\_6** i sprawi, 偶e aplikacja **skoczy tam, jeli `this.o`** nie ma wartoci 100000\:

![](<../../.gitbook/assets/image (59).png>)

Musisz to zrobi na fizycznym urzdzeniu, poniewa偶 (nie wiem dlaczego) nie dziaa to na urzdzeniu wirtualnym.

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
