# Google CTF 2018 - Oyun OynayalÄ±m mÄ±?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hacklemeyi Ã¶ÄŸrenin!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

APK'yÄ± buradan indirin:

APK'yÄ± [https://appetize.io/](https://appetize.io) (Ã¼cretsiz hesap) yÃ¼kleyeceÄŸim ve apk'nin nasÄ±l davrandÄ±ÄŸÄ±nÄ± gÃ¶receÄŸim:

![](<../../.gitbook/assets/image (418).png>)

BayraÄŸÄ± alabilmek iÃ§in 1000000 kez kazanmanÄ±z gerektiÄŸi gÃ¶rÃ¼nÃ¼yor.

[Pentesting Android](./) adÄ±mlarÄ±nÄ± takip ederek uygulamayÄ± decompile edebilir ve jadx kullanarak Java kodunu okuyabilirsiniz.

Java kodunu okuma:

![](<../../.gitbook/assets/image (492).png>)

BayraÄŸÄ± yazdÄ±racak olan fonksiyonun **m().** olduÄŸu gÃ¶rÃ¼nÃ¼yor.

## **Smali deÄŸiÅŸiklikler**

### **Ä°lk kez m() Ã§aÄŸrÄ±sÄ±**

UygulamanÄ±n _this.o != 1000000_ deÄŸiÅŸkeni ise m() fonksiyonunu Ã§aÄŸÄ±rmasÄ±nÄ± saÄŸlayalÄ±m, bunun iÃ§in sadece koÅŸulu deÄŸiÅŸtirin:
```
if-ne v0, v9, :cond_2
```
```markdown
## Shall we play a game?

### Challenge Description
The challenge is an Android application where you have to play a game to get the flag. The game is a simple Tic-Tac-Toe game where you have to win against the computer to get the flag.

### Challenge Solution
1. Decompile the APK file using JADX or apktool.
2. Analyze the source code to understand the logic of the game.
3. Identify the algorithm used by the computer to make its moves.
4. Modify the source code to manipulate the game logic in your favor.
5. Recompile the modified code and install the APK on a device.
6. Play the game and make the necessary moves to win and retrieve the flag.

### Flag
CTF{Y0u_W1n!_Th3_fl4g_1s_XXXXXXXX}
```
```
if-eq v0, v9, :cond_2
```
![Ã–nce](<../../.gitbook/assets/image (380).png>)

![Sonra](<../../.gitbook/assets/image (835).png>)

[Pentest Android](./) adÄ±mlarÄ±nÄ± izleyerek APK'yÄ± yeniden derleyin ve imzalayÄ±n. ArdÄ±ndan, [https://appetize.io/](https://appetize.io) adresine yÃ¼kleyin ve ne olduÄŸunu gÃ¶relim:

![](<../../.gitbook/assets/image (125).png>)

BayraÄŸÄ±n tamamen ÅŸifrelenmeden yazÄ±ldÄ±ÄŸÄ± gÃ¶rÃ¼nÃ¼yor. Muhtemelen m() fonksiyonunun 1000000 kez Ã§aÄŸrÄ±lmasÄ± gerekiyor.

Bunu yapmanÄ±n **baÅŸka bir yolu**, talimatÄ± deÄŸiÅŸtirmemek ancak karÅŸÄ±laÅŸtÄ±rma talimatlarÄ±nÄ± deÄŸiÅŸtirmektir:

![](<../../.gitbook/assets/image (837).png>)

**BaÅŸka bir yol**, 1000000 ile karÅŸÄ±laÅŸtÄ±rmak yerine deÄŸeri 1 olarak ayarlamaktÄ±r, bÃ¶ylece this.o 1 ile karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r:

![](<../../.gitbook/assets/image (626).png>)

DÃ¶rdÃ¼ncÃ¼ bir yol, v9(1000000) deÄŸerini v0 _(this.o)_ deÄŸerine taÅŸÄ±mak iÃ§in bir talimat eklemektir:

![](<../../.gitbook/assets/image (411).png>)

![](<../../.gitbook/assets/image (421).png>)

## Ã‡Ã¶zÃ¼m

UygulamanÄ±n ilk seferinde kazandÄ±ÄŸÄ±nÄ±zda dÃ¶ngÃ¼yÃ¼ 100000 kez Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± saÄŸlayÄ±n. Bunu yapmak iÃ§in sadece **:goto\_6** dÃ¶ngÃ¼sÃ¼nÃ¼ oluÅŸturmanÄ±z ve uygulamanÄ±n **`this.o`** deÄŸeri 100000 olmadÄ±ÄŸÄ±nda oraya **atlamasÄ±nÄ± saÄŸlamanÄ±z gerekir:

![](<../../.gitbook/assets/image (1087).png>)

Bunu fiziksel bir cihazda yapmanÄ±z gerekmektedir Ã§Ã¼nkÃ¼ (nedenini bilmiyorum) bu emÃ¼le edilmiÅŸ bir cihazda Ã§alÄ±ÅŸmaz.

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi **HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu gÃ¶rÃ¼n
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u takip edin.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
