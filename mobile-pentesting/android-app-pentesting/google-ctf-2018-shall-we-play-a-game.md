# Google CTF 2018 - æˆ‘ä»¬æ¥ç©ä¸ªæ¸¸æˆå§ï¼Ÿ

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆçš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬**ã€‚
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

åœ¨è¿™é‡Œä¸‹è½½ APKï¼š

æˆ‘å°†ä¸Šä¼  APK åˆ° [https://appetize.io/](https://appetize.io)ï¼ˆå…è´¹è´¦æˆ·ï¼‰æŸ¥çœ‹ apk çš„è¡Œä¸ºï¼š

![](<../../.gitbook/assets/image (421).png>)

çœ‹èµ·æ¥ä½ éœ€è¦èµ¢å¾— 1000000 æ¬¡æ‰èƒ½è·å¾— flagã€‚

æŒ‰ç…§ [Android æ¸—é€æµ‹è¯•](./) ä¸­çš„æ­¥éª¤ï¼Œæ‚¨å¯ä»¥åç¼–è¯‘åº”ç”¨ç¨‹åºä»¥è·å– smali ä»£ç ï¼Œå¹¶ä½¿ç”¨ jadx è¯»å– Java ä»£ç ã€‚

é˜…è¯» Java ä»£ç ï¼š

![](<../../.gitbook/assets/image (495).png>)

çœ‹èµ·æ¥æ‰“å° flag çš„å‡½æ•°æ˜¯ **m().**

## **Smali æ›´æ”¹**

### **ç¬¬ä¸€æ¬¡è°ƒç”¨ m()**

è®©åº”ç”¨ç¨‹åºåœ¨å˜é‡ _this.o != 1000000_ æ—¶è°ƒç”¨ m()ï¼Œä¸ºæ­¤ï¼Œåªéœ€æ›´æ”¹æ¡ä»¶ï¼š
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Flag 1

The first flag is stored in the `SharedPreferences` of the application. You can easily retrieve it using `adb`.

### Flag 2

The second flag is stored in the app's internal database. You can access it by pulling the database file from the device using `adb`.

### Flag 3

The third flag is stored in a file located at `/data/data/com.google.ctf.shallweplayagame/files/flag3.txt` on the device. You can pull this file using `adb`.

### Flag 4

The fourth flag is stored in the app's cache directory. You can retrieve it by pulling the cache directory from the device using `adb`.

### Flag 5

The fifth flag is stored in the app's private directory. You can access it by pulling the app's private directory from the device using `adb`.

### Flag 6

The sixth flag is stored in the app's external storage directory. You can retrieve it by pulling the external storage directory from the device using `adb`.
```
if-eq v0, v9, :cond_2
```
![ä¹‹å‰](<../../.gitbook/assets/image (383).png>)

![ä¹‹å](<../../.gitbook/assets/image (838).png>)

æŒ‰ç…§[Androidæ¸—é€æµ‹è¯•](./)çš„æ­¥éª¤é‡æ–°ç¼–è¯‘å¹¶ç­¾ç½²APKã€‚ç„¶åï¼Œå°†å…¶ä¸Šä¼ åˆ°[https://appetize.io/](https://appetize.io)ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

![](<../../.gitbook/assets/image (128).png>)

çœ‹èµ·æ¥æ ‡å¿—æ˜¯æœªå®Œå…¨è§£å¯†åœ°å†™å…¥çš„ã€‚å¯èƒ½åº”è¯¥è°ƒç”¨m()å‡½æ•°1000000æ¬¡ã€‚

**å¦ä¸€ç§**æ–¹æ³•æ˜¯ä¸æ›´æ”¹æŒ‡ä»¤ï¼Œè€Œæ˜¯æ›´æ”¹æ¯”è¾ƒçš„æŒ‡ä»¤ï¼š

![](<../../.gitbook/assets/image (840).png>)

**å¦ä¸€ç§**æ–¹æ³•æ˜¯å°†å€¼ä¸1000000è¿›è¡Œæ¯”è¾ƒï¼Œå°†å€¼è®¾ç½®ä¸º1ï¼Œä»¥ä¾¿å°†this.oä¸1è¿›è¡Œæ¯”è¾ƒï¼š

![](<../../.gitbook/assets/image (629).png>)

ç¬¬å››ç§æ–¹æ³•æ˜¯æ·»åŠ ä¸€æ¡æŒ‡ä»¤ï¼Œå°†v9(1000000)çš„å€¼ç§»åŠ¨åˆ°v0 _(this.o)_ï¼š

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## è§£å†³æ–¹æ¡ˆ

å½“æ‚¨ç¬¬ä¸€æ¬¡è·èƒœæ—¶ï¼Œä½¿åº”ç”¨ç¨‹åºè¿è¡Œå¾ªç¯100000æ¬¡ã€‚ä¸ºæ­¤ï¼Œæ‚¨åªéœ€è¦åˆ›å»º**ï¼šgoto\_6**å¾ªç¯ï¼Œå¹¶ä½¿åº”ç”¨ç¨‹åº**è·³è½¬åˆ°é‚£é‡Œï¼Œå¦‚æœ`this.o`**çš„å€¼ä¸æ˜¯100000ï¼š

![](<../../.gitbook/assets/image (1090).png>)

æ‚¨éœ€è¦åœ¨ç‰©ç†è®¾å¤‡å†…æ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºï¼ˆæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰åœ¨æ¨¡æ‹Ÿè®¾å¤‡ä¸­æ— æ³•æ­£å¸¸å·¥ä½œã€‚
