# Google CTF 2018 - ê²Œì„ì„ í• ê¹Œìš”?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ ì œë¡œì—ì„œ ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **ë‹¹ì‹ ì˜ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

APKë¥¼ ì—¬ê¸°ì„œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”:

APKë¥¼ [https://appetize.io/](https://appetize.io) (ë¬´ë£Œ ê³„ì •)ì— ì—…ë¡œë“œí•  ê²ƒì…ë‹ˆë‹¤. APKê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤:

![](<../../.gitbook/assets/image (421).png>)

í”Œë˜ê·¸ë¥¼ ì–»ìœ¼ë ¤ë©´ 1000000ë²ˆ ì´ê¸°ì–´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.

[pentesting Android](./)ì—ì„œì˜ ë‹¨ê³„ë¥¼ ë”°ë¼ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë””ì»´íŒŒì¼í•˜ì—¬ smali ì½”ë“œë¥¼ ì–»ê³  jadxë¥¼ ì‚¬ìš©í•˜ì—¬ Java ì½”ë“œë¥¼ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Java ì½”ë“œ ì½ê¸°:

![](<../../.gitbook/assets/image (495).png>)

í”Œë˜ê·¸ë¥¼ ì¶œë ¥í•  í•¨ìˆ˜ëŠ” **m().** ì¸ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.

## **Smali ë³€ê²½**

### **ì²« ë²ˆì§¸ë¡œ m() í˜¸ì¶œ**

ì• í”Œë¦¬ì¼€ì´ì…˜ì´ _this.o != 1000000_ì´ë©´ m()ì„ í˜¸ì¶œí•˜ë„ë¡ ë§Œë“¤ì–´ë´…ì‹œë‹¤. ì´ë¥¼ ìœ„í•´ ì¡°ê±´ì„ ë³€ê²½í•˜ì„¸ìš”:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Challenge description
The challenge was an Android APK file. The app presents you with a login screen, and after logging in, you are greeted with a screen that says "Shall we play a game?". There is a button to start the game, which when clicked, opens a new screen with a grid of numbers from 1 to 9.

---

## Vulnerability
The vulnerability in this app was that the game screen allowed you to input any number, and when you clicked the "Check" button, it would tell you if the number was correct or not. By intercepting the traffic between the app and the server, you could see that the response from the server contained the flag.

---

## Solution
To solve this challenge, you needed to intercept the traffic using a proxy tool like Burp Suite, send a request with a specific number, intercept the response, and extract the flag from the response. The flag was in the format `CTF{...}`.
```
if-eq v0, v9, :cond_2
```
![ì´ì „](<../../.gitbook/assets/image (383).png>)

![ì´í›„](<../../.gitbook/assets/image (838).png>)

[Android íŒ¬í…ŒìŠ¤íŠ¸](./) ë‹¨ê³„ë¥¼ ë”°ë¼ APKë¥¼ ë‹¤ì‹œ ì»´íŒŒì¼í•˜ê³  ì„œëª…í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ [https://appetize.io/](https://appetize.io)ì— ì—…ë¡œë“œí•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•´ ë´…ì‹œë‹¤:

![](<../../.gitbook/assets/image (128).png>)

ì™„ì „íˆ í•´ë…ë˜ì§€ ì•Šì€ ì±„ë¡œ í”Œë˜ê·¸ê°€ ì‘ì„±ëœ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. ì•„ë§ˆë„ m() í•¨ìˆ˜ë¥¼ 100ë§Œ ë²ˆ í˜¸ì¶œí•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.

ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” **ë‹¤ë¥¸ ë°©ë²•**ì€ ëª…ë ¹ì„ ë³€ê²½í•˜ì§€ ì•Šê³  ë¹„êµ ëª…ë ¹ì„ ë³€ê²½í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (840).png>)

**ë˜ ë‹¤ë¥¸ ë°©ë²•**ì€ 1000000ê³¼ ë¹„êµí•˜ëŠ” ëŒ€ì‹  ê°’ì´ 1ë¡œ ì„¤ì •ë˜ë„ë¡ í•˜ì—¬ this.oê°€ 1ê³¼ ë¹„êµë˜ë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (629).png>)

ë„¤ ë²ˆì§¸ ë°©ë²•ì€ v9(1000000)ì˜ ê°’ì„ v0 _(this.o)_ë¡œ ì´ë™í•˜ëŠ” ëª…ë ¹ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## í•´ê²°ì±…

ì²« ë²ˆì§¸ë¡œ ì´ê¸°ë©´ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë£¨í”„ë¥¼ 100,000ë²ˆ ì‹¤í–‰í•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ **:goto\_6** ë£¨í”„ë¥¼ ìƒì„±í•˜ê³  ì‘ìš© í”„ë¡œê·¸ë¨ì´ **`this.o`**ê°€ 100,000ì´ ì•„ë‹Œ ê²½ìš° ê±°ê¸°ë¡œ **ì í”„í•˜ë„ë¡** ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤:

![](<../../.gitbook/assets/image (1090).png>)

ì´ê²ƒì€ ë¬¼ë¦¬ì  ì¥ì¹˜ ë‚´ì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤(ì™œì¸ì§€ëŠ” ëª¨ë¥´ê² ìŠµë‹ˆë‹¤) ê°€ìƒ ì¥ì¹˜ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
