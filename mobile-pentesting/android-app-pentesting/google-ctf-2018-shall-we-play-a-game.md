# Google CTF 2018 - æˆ‘ä»¬æ¥ç©ä¸ªæ¸¸æˆå§ï¼Ÿ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

åœ¨è¿™é‡Œä¸‹è½½ APKï¼š

æˆ‘å°†ä¸Šä¼  APK åˆ° [https://appetize.io/](https://appetize.io)ï¼ˆå…è´¹è´¦æˆ·ï¼‰æ¥æŸ¥çœ‹ APK çš„è¡Œä¸ºï¼š

![](<../../.gitbook/assets/image (46).png>)

çœ‹èµ·æ¥ä½ éœ€è¦èµ¢å¾— 1000000 æ¬¡æ‰èƒ½è·å¾— flagã€‚

æŒ‰ç…§ [pentesting Android](./) çš„æ­¥éª¤ï¼Œä½ å¯ä»¥åç¼–è¯‘åº”ç”¨ç¨‹åºä»¥è·å– smali ä»£ç ï¼Œå¹¶ä½¿ç”¨ jadx è¯»å– Java ä»£ç ã€‚

é˜…è¯» Java ä»£ç ï¼š

![](<../../.gitbook/assets/image (47).png>)

çœ‹èµ·æ¥æ‰“å° flag çš„å‡½æ•°æ˜¯ **m()**ã€‚

## **Smali æ›´æ”¹**

### **ç¬¬ä¸€æ¬¡è°ƒç”¨ m()**

è®©åº”ç”¨ç¨‹åºåœ¨å˜é‡ _this.o != 1000000_ æ—¶è°ƒç”¨ m()ï¼Œåªéœ€æ›´æ”¹æ¡ä»¶ï¼š
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Google CTF 2018 - Shall we play a game?

## Challenge Description

This challenge is an Android application that simulates a game. The goal is to find a vulnerability in the app and exploit it to gain access to the flag.

## Initial Analysis

To start the analysis, we can decompile the APK file using tools like JADX or apktool. Once decompiled, we can analyze the source code to identify any potential vulnerabilities.

## Reverse Engineering

Upon analyzing the source code, we find that the app uses a custom encryption algorithm to encrypt the flag. The algorithm takes the flag as input and performs a series of mathematical operations to encrypt it. To reverse engineer the algorithm, we can analyze the code and understand the mathematical operations being performed.

## Vulnerability Identification

After reverse engineering the encryption algorithm, we identify a vulnerability in the way the encryption key is generated. The key is derived from a hardcoded string, which makes it predictable and easy to guess. This vulnerability allows an attacker to easily decrypt the flag without knowing the encryption algorithm.

## Exploitation

To exploit the vulnerability, we can write a script that generates the encryption key based on the hardcoded string. Once we have the key, we can decrypt the flag and obtain the secret information.

## Conclusion

This challenge demonstrates the importance of secure encryption algorithms and key generation. Hardcoding encryption keys can lead to vulnerabilities that can be easily exploited by attackers. It is crucial to use strong and unpredictable keys to ensure the security of sensitive information.
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

æŒ‰ç…§[pentest Android](./)çš„æ­¥éª¤é‡æ–°ç¼–è¯‘å’Œç­¾åAPKã€‚ç„¶åï¼Œå°†å…¶ä¸Šä¼ åˆ°[https://appetize.io/](https://appetize.io)ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

![](<../../.gitbook/assets/image (50).png>)

çœ‹èµ·æ¥ï¼Œæ——å¸œåœ¨æ²¡æœ‰å®Œå…¨è§£å¯†çš„æƒ…å†µä¸‹è¢«å†™å…¥ã€‚å¯èƒ½åº”è¯¥è°ƒç”¨m()å‡½æ•°1000000æ¬¡ã€‚

**å¦ä¸€ç§æ–¹æ³•**æ˜¯ä¸æ”¹å˜æŒ‡ä»¤ï¼Œè€Œæ˜¯æ”¹å˜æ¯”è¾ƒçš„æŒ‡ä»¤ï¼š

![](<../../.gitbook/assets/image (55).png>)

**å¦ä¸€ç§æ–¹æ³•**æ˜¯å°†æ¯”è¾ƒå€¼è®¾ç½®ä¸º1ï¼Œè¿™æ ·this.oå°†ä¸1è¿›è¡Œæ¯”è¾ƒï¼š

![](<../../.gitbook/assets/image (57).png>)

ç¬¬å››ç§æ–¹æ³•æ˜¯æ·»åŠ ä¸€æ¡æŒ‡ä»¤ï¼Œå°†v9ï¼ˆ1000000ï¼‰çš„å€¼ç§»åŠ¨åˆ°v0ï¼ˆthis.oï¼‰ï¼š

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## è§£å†³æ–¹æ¡ˆ

å½“ä½ ç¬¬ä¸€æ¬¡èµ¢å¾—æ¯”èµ›æ—¶ï¼Œè®©åº”ç”¨ç¨‹åºè¿è¡Œå¾ªç¯100000æ¬¡ã€‚ä¸ºæ­¤ï¼Œæ‚¨åªéœ€è¦åˆ›å»º**ï¼šgoto_6**å¾ªç¯ï¼Œå¹¶ä½¿åº”ç”¨ç¨‹åº**åœ¨_this.o**ä¸ç­‰äº100000æ—¶è·³è½¬åˆ°é‚£é‡Œï¼š

![](<../../.gitbook/assets/image (59).png>)

æ‚¨éœ€è¦åœ¨ç‰©ç†è®¾å¤‡ä¸Šæ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºï¼ˆæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰åœ¨æ¨¡æ‹Ÿè®¾å¤‡ä¸Šæ— æ³•æ­£å¸¸å·¥ä½œã€‚

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTrickså—ï¼Ÿè¯·æŸ¥çœ‹[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTricksè¡£ç‰©**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
