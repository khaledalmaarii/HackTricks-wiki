# Google CTF 2018 - Da li da igramo igru?

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

Preuzmite APK ovde:

Idem da postavim APK na [https://appetize.io/](https://appetize.io) (besplatan nalog) da vidim kako se apk ponaÅ¡a:

![](<../../.gitbook/assets/image (418).png>)

Izgleda da morate da pobedite 1000000 puta da biste dobili zastavu.

PrateÄ‡i korake sa [pentesting Android](./) moÅ¾ete dekompajlirati aplikaciju da biste dobili smali kod i proÄitali Java kod koristeÄ‡i jadx.

ÄŒitanje Java koda:

![](<../../.gitbook/assets/image (492).png>)

Izgleda da je funkcija koja Ä‡e odÅ¡tampati zastavu **m().**

## **Izmene u Smali kodu**

### **Poziv funkcije m() prvi put**

Neka aplikacija pozove m() ako je promenljiva _this.o != 1000000_, da biste to uradili, samo promenite uslov:
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Challenge Description

The challenge provides an Android application named `game.apk`. The goal is to find the flag by playing the game.

### Challenge Solution

1. **Decompile the APK**: Use tools like JADX or APKTool to decompile the APK file.

2. **Analyzing the Code**: Look for interesting code snippets, API calls, or hardcoded strings that might lead to the flag.

3. **Finding the Flag**: By analyzing the code, you can find the logic or conditions that reveal the flag. It could be hidden in the source code or displayed during a specific game action.

4. **Testing the Flag**: Once you think you found the flag, test it within the app to confirm if it's the correct solution.

5. **Submit the Flag**: If the tested flag is correct, submit it to the CTF platform to earn points.

By following these steps, you can successfully complete the Google CTF 2018 challenge and find the flag within the Android application.
```
if-eq v0, v9, :cond_2
```
![Pre](<../../.gitbook/assets/image (380).png>)

![Posle](<../../.gitbook/assets/image (835).png>)

Pratite korake [pentest Androida](./) da biste ponovo kompajlirali i potpisali APK. Zatim ga otpremite na [https://appetize.io/](https://appetize.io) i vidimo Å¡ta se deÅ¡ava:

![](<../../.gitbook/assets/image (125).png>)

Izgleda da je zastava napisana bez potpune deÅ¡ifrovanosti. Verovatno bi trebalo pozvati funkciju m() 1000000 puta.

**Drugi naÄin** da se ovo uradi je da se ne menja instrukcija veÄ‡ da se promene uporeÄ‘ene instrukcije:

![](<../../.gitbook/assets/image (837).png>)

**JoÅ¡ jedan naÄin** je umesto uporeÄ‘ivanja sa 1000000, postaviti vrednost na 1 tako da se this.o uporeÄ‘uje sa 1:

![](<../../.gitbook/assets/image (626).png>)

ÄŒetvrti naÄin je dodati instrukciju za premeÅ¡tanje vrednosti v9(1000000) u v0 _(this.o)_:

![](<../../.gitbook/assets/image (411).png>)

![](<../../.gitbook/assets/image (421).png>)

## ReÅ¡enje

Naterajte aplikaciju da izvrÅ¡i petlju 100000 puta kada pobedite prvi put. Da biste to uradili, samo treba da kreirate **:goto\_6** petlju i naterate aplikaciju da **skoÄi tamo ako `this.o`** nema vrednost 100000:

![](<../../.gitbook/assets/image (1087).png>)

Ovo morate uraditi na fiziÄkom ureÄ‘aju jer (ne znam zaÅ¡to) ovo ne funkcioniÅ¡e na emuliranom ureÄ‘aju.

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
