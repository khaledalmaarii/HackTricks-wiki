# Google CTF 2018 - Da li Å¾elimo da igramo igru?

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini da podrÅ¾ite HackTricks:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

Preuzmite APK ovde:

Idem da postavim APK na [https://appetize.io/](https://appetize.io) (besplatan nalog) da vidim kako se apk ponaÅ¡a:

![](<../../.gitbook/assets/image (46).png>)

Izgleda da morate pobediti 1000000 puta da biste dobili zastavicu.

PrateÄ‡i korake sa [pentesting Android](./) moÅ¾ete dekompajlirati aplikaciju da biste dobili smali kod i proÄitali Java kod koristeÄ‡i jadx.

ÄŒitanje Java koda:

![](<../../.gitbook/assets/image (47).png>)

Izgleda da je funkcija koja Ä‡e ispisati zastavicu **m().**

## **Smali promene**

### **Pozovite m() prvi put**

Neka aplikacija pozove m() ako promenljiva _this.o != 1000000_, da biste to uradili, samo promenite uslov:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Da li Å¾elimo da igramo igru?

## Opis

Ova CTF (Capture The Flag) igra je bazirana na Android aplikaciji koja ima nekoliko ranjivosti. Cilj igre je da pronaÄ‘ete i iskoristite ove ranjivosti kako biste pristupili tajnim informacijama.

## Koraci

1. Preuzmite APK datoteku aplikacije sa [ovog linka](https://github.com/google/google-ctf/releases/tag/2018-quals).

2. Instalirajte APK datoteku na Android ureÄ‘aj.

3. Pokrenite aplikaciju i pritisnite dugme "Play".

4. Analizirajte mreÅ¾ni saobraÄ‡aj koji generiÅ¡e aplikacija. MoÅ¾ete koristiti alate poput Wireshark-a ili Burp Suite-a.

5. PronaÄ‘ite HTTP zahtev koji sadrÅ¾i tajne informacije. Ovaj zahtev Ä‡e biti enkriptovan.

6. Koristite alate za dekripciju kako biste deÅ¡ifrovali enkriptovane podatke.

7. PronaÄ‘ite kljuÄ za dekripciju enkriptovanih podataka. MoÅ¾ete koristiti alate poput Frida ili Xposed Framework-a.

8. Iskoristite ranjivost u aplikaciji kako biste pristupili tajnim informacijama.

9. ZabeleÅ¾ite flag koji se nalazi u tajnim informacijama.

10. Ponovite korake 4-9 za sve nivoe igre.

## Napomena

Ova igra je samo simulacija i treba je koristiti u edukativne svrhe. Nepravilno koriÅ¡Ä‡enje ovih tehnika moÅ¾e biti nezakonito.
```
if-eq v0, v9, :cond_2
```
![Pre](<../../.gitbook/assets/image (48).png>)

![Posle](<../../.gitbook/assets/image (49).png>)

Pratite korake [pentestiranja Androida](./) da biste rekompovali i potpisali APK. Zatim, otpremite ga na [https://appetize.io/](https://appetize.io) i vidimo Å¡ta se deÅ¡ava:

![](<../../.gitbook/assets/image (50).png>)

Izgleda da je zastava napisana bez potpune deÅ¡ifrovanosti. Verovatno bi trebalo pozvati funkciju m() 1000000 puta.

**Drugi naÄin** da se to uradi je da se ne menja instrukcija, veÄ‡ da se promene uporeÄ‘ene instrukcije:

![](<../../.gitbook/assets/image (55).png>)

**JoÅ¡ jedan naÄin** je umesto uporeÄ‘ivanja sa 1000000, postaviti vrednost na 1 tako da se this.o uporeÄ‘uje sa 1:

![](<../../.gitbook/assets/image (57).png>)

ÄŒetvrti naÄin je dodavanje instrukcije za premeÅ¡tanje vrednosti v9(1000000) u v0 _(this.o)_:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## ReÅ¡enje

Naterajte aplikaciju da izvrÅ¡i petlju 100000 puta kada prvi put pobedite. Da biste to uradili, samo treba da napravite petlju **:goto\_6** i naterate aplikaciju da **skoÄi tamo ako `this.o`** nema vrednost 100000\:

![](<../../.gitbook/assets/image (59).png>)

Ovo morate uraditi na fiziÄkom ureÄ‘aju jer (ne znam zaÅ¡to) ovo ne funkcioniÅ¡e na emuliranom ureÄ‘aju.

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini da podrÅ¾ite HackTricks:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
