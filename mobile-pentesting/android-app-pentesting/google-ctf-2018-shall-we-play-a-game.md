# Google CTF 2018 - Zagramy w gr?

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

Pobierz plik APK tutaj:

Zamierzam przesa plik APK na [https://appetize.io/](https://appetize.io) (konto darmowe), aby zobaczy, jak zachowuje si apk:

![](<../../.gitbook/assets/image (421).png>)

Wyglda na to, 偶e musisz wygra 1000000 razy, aby zdoby flag.

Postpujc zgodnie z krokami [testowania penetracyjnego Androida](./), mo偶esz zdekompilowa aplikacj, aby uzyska kod smali i przeczyta kod Javy za pomoc jadx.

Czytanie kodu Javy:

![](<../../.gitbook/assets/image (495).png>)

Wyglda na to, 偶e funkcja, kt贸ra wydrukuje flag, to **m().**

## **Zmiany w kodzie Smali**

### **Wywoanie m() po raz pierwszy**

Zmodyfikujmy aplikacj tak, aby wywoywaa m(), jeli zmienna _this.o != 1000000_, aby to zrobi, po prostu zmie warunek:
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Introduction

In this challenge, we are provided with an Android application named "Shall we play a game?". The goal is to find the flag by analyzing the app's behavior and identifying any vulnerabilities that can be exploited.

### Challenge Overview

The app presents a simple interface with a button that, when clicked, displays a message. By decompiling the APK and analyzing the source code, we can discover how the app processes user input and determine if there are any security flaws that can lead to the flag.

### Decompiling the APK

To decompile the APK, we can use tools like JADX or apktool. By examining the decompiled code, we can identify potential areas of interest such as input validation, cryptographic operations, or hidden functionalities that may reveal the flag.

### Finding the Flag

Through static analysis and dynamic testing, we can uncover vulnerabilities such as insecure data storage, improper input validation, or unintended behavior triggered by specific user actions. By exploiting these weaknesses, we can extract the flag and complete the challenge.

### Conclusion

The "Shall we play a game?" Android app challenge from Google CTF 2018 provides an opportunity to practice mobile application pentesting techniques and hone our skills in identifying and exploiting security issues in Android apps.
```
if-eq v0, v9, :cond_2
```
![Przed](<../../.gitbook/assets/image (383).png>)

![Po](<../../.gitbook/assets/image (838).png>)

Postpuj zgodnie z krokami [pentest Android](./), aby ponownie skompilowa i podpisa plik APK. Nastpnie zaaduj go na [https://appetize.io/](https://appetize.io) i zobaczmy, co si stanie:

![](<../../.gitbook/assets/image (128).png>)

Wyglda na to, 偶e flaga jest zapisana bez penego odszyfrowania. Prawdopodobnie funkcja m() powinna by wywoana 1000000 razy.

**Inny spos贸b** na to jest nie zmienia instrukcji, ale zmieni instrukcje por贸wnywane:

![](<../../.gitbook/assets/image (840).png>)

**Innym sposobem** jest zamiast por贸wnywa z 1000000, ustawi warto na 1, aby this.o by por贸wnywany z 1:

![](<../../.gitbook/assets/image (629).png>)

Czwarty spos贸b to dodanie instrukcji przeniesienia wartoci v9(1000000) do v0 _(this.o)_:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## Rozwizanie

Spowoduj, aby aplikacja wykonywaa ptl 100 000 razy po wygranej pierwszym razem. Aby to zrobi, wystarczy utworzy ptl **:goto\_6** i sprawi, aby aplikacja **przeskoczya tam, jeli `this.o`** nie ma wartoci 100 000:

![](<../../.gitbook/assets/image (1090).png>)

Musisz to zrobi na fizycznym urzdzeniu, poniewa偶 (nie wiem dlaczego) nie dziaa to na urzdzeniu wirtualnym.

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
