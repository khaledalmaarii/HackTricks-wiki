# Google CTF 2018 - Oyun OynayalÄ±m mÄ±?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki Ã¶zel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

APK'yÄ± buradan indirin:

APK'yÄ± [https://appetize.io/](https://appetize.io) (Ã¼cretsiz hesap) Ã¼zerine yÃ¼kleyeceÄŸim, bÃ¶ylece apk'nin nasÄ±l davrandÄ±ÄŸÄ±nÄ± gÃ¶rebilirim:

![](<../../.gitbook/assets/image (46).png>)

BayraÄŸÄ± almak iÃ§in 1000000 kez kazanmanÄ±z gerektiÄŸi gibi gÃ¶rÃ¼nÃ¼yor.

Android pentesting adÄ±mlarÄ±nÄ± takip ederek uygulamayÄ± decompile edebilir ve smali kodunu alarak Java kodunu jadx kullanarak okuyabilirsiniz.

Java kodunu okuma:

![](<../../.gitbook/assets/image (47).png>)

BayraÄŸÄ± yazdÄ±racak olan fonksiyonun **m()** olduÄŸu gibi gÃ¶rÃ¼nÃ¼yor.

## **Smali deÄŸiÅŸiklikleri**

### **Ä°lk seferde m() fonksiyonunu Ã§aÄŸÄ±rma**

UygulamanÄ±n _this.o != 1000000_ deÄŸiÅŸkeni olduÄŸunda m() fonksiyonunu Ã§aÄŸÄ±rmasÄ±nÄ± saÄŸlayalÄ±m, bunun iÃ§in sadece koÅŸulu deÄŸiÅŸtirin:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Shall we play a game?

## Challenge Description

This challenge is about a simple Android app that allows the user to play a game. The goal is to find a way to cheat and get the flag.

## Initial Analysis

The first step is to decompile the APK file using a tool like JADX or apktool. Once decompiled, we can analyze the source code to understand how the app works.

## Source Code Analysis

In the `MainActivity` class, we can see that the app uses a `Game` object to handle the game logic. The `Game` class has a `checkFlag` method that checks if the user has found the flag.

```java
public class Game {
    private String flag = "FLAG{XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX}";

    public boolean checkFlag(String input) {
        return input.equals(flag);
    }
}
```

## Exploiting the Vulnerability

The vulnerability in this app is that the `flag` variable is hardcoded in the source code. This means that if we can decompile the app and find the value of `flag`, we can cheat and get the flag without actually playing the game.

To do this, we can decompile the APK file and search for the `flag` variable in the source code. Once we find it, we can extract the value and use it to get the flag.

## Conclusion

In this challenge, we learned how to exploit a simple Android app by finding a hardcoded flag in the source code. This highlights the importance of properly securing sensitive information in mobile apps.
```
if-eq v0, v9, :cond_2
```
![Ã–nce](<../../.gitbook/assets/image (48).png>)

![Sonra](<../../.gitbook/assets/image (49).png>)

[Pentest Android](./) adÄ±mlarÄ±nÄ± takip ederek APK'yÄ± yeniden derleyin ve imzalayÄ±n. ArdÄ±ndan, [https://appetize.io/](https://appetize.io) adresine yÃ¼kleyin ve ne olduÄŸunu gÃ¶relim:

![](<../../.gitbook/assets/image (50).png>)

Bayrak, tamamen ÅŸifrelenmeden yazÄ±lmÄ±ÅŸ gibi gÃ¶rÃ¼nÃ¼yor. Muhtemelen m() fonksiyonu 1000000 kez Ã§aÄŸrÄ±lmalÄ±dÄ±r.

Bunu yapmanÄ±n **baÅŸka bir yolu**, talimatÄ± deÄŸiÅŸtirmek yerine karÅŸÄ±laÅŸtÄ±rÄ±lan talimatlarÄ± deÄŸiÅŸtirmektir:

![](<../../.gitbook/assets/image (55).png>)

**BaÅŸka bir yol**, 1000000 ile karÅŸÄ±laÅŸtÄ±rmak yerine deÄŸeri 1 olarak ayarlamaktÄ±r, bÃ¶ylece this.o 1 ile karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r:

![](<../../.gitbook/assets/image (57).png>)

DÃ¶rdÃ¼ncÃ¼ bir yol, v9(1000000) deÄŸerini v0 _(this.o)_'ya taÅŸÄ±mak iÃ§in bir talimat eklemektir:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## Ã‡Ã¶zÃ¼m

UygulamanÄ±n ilk seferinde kazandÄ±ÄŸÄ±nÄ±zda dÃ¶ngÃ¼yÃ¼ 100000 kez Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± saÄŸlayÄ±n. Bunun iÃ§in sadece **:goto\_6** dÃ¶ngÃ¼sÃ¼nÃ¼ oluÅŸturmanÄ±z ve uygulamanÄ±n **this.o** deÄŸeri 100000 olmadÄ±ÄŸÄ±nda oraya **atlamasÄ±nÄ± saÄŸlamanÄ±z** yeterlidir:

![](<../../.gitbook/assets/image (59).png>)

Bunu bir fiziksel cihazda yapmanÄ±z gerekiyor Ã§Ã¼nkÃ¼ (nedenini bilmiyorum) emÃ¼le edilen bir cihazda Ã§alÄ±ÅŸmÄ±yor.

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
