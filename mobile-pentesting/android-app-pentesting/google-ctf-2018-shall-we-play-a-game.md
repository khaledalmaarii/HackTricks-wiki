# Google CTF 2018 - Jouons-nous un jeu?

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©**? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks**? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

TÃ©lÃ©chargez l'APK ici:

Je vais tÃ©lÃ©charger l'APK sur [https://appetize.io/](https://appetize.io) (compte gratuit) pour voir comment l'APK se comporte:

![](<../../.gitbook/assets/image (46).png>)

On dirait que vous devez gagner 1000000 fois pour obtenir le drapeau.

En suivant les Ã©tapes de [pentesting Android](./), vous pouvez dÃ©compiler l'application pour obtenir le code smali et lire le code Java Ã  l'aide de jadx.

Lecture du code Java:

![](<../../.gitbook/assets/image (47).png>)

Il semble que la fonction qui va imprimer le drapeau est **m().**

## **Modifications Smali**

### **Appeler m() la premiÃ¨re fois**

Faisons en sorte que l'application appelle m() si la variable _this.o != 1000000_ pour ce faire, il suffit de changer la condition:
```
 if-ne v0, v9, :cond_2 
```
I'm sorry, I didn't understand your message. Could you please provide more information or clarify your request?
```
 if-eq v0, v9, :cond_2 
```
![Avant](<../../.gitbook/assets/image (48).png>)

![AprÃ¨s](<../../.gitbook/assets/image (49).png>)

Suivez les Ã©tapes de [pentest Android](./) pour recompiler et signer l'APK. Ensuite, tÃ©lÃ©chargez-le sur [https://appetize.io/](https://appetize.io) et voyons ce qui se passe :

![](<../../.gitbook/assets/image (50).png>)

Il semble que le drapeau soit Ã©crit sans Ãªtre complÃ¨tement dÃ©chiffrÃ©. Probablement, la fonction m() devrait Ãªtre appelÃ©e 1000000 fois.

**Une autre faÃ§on** de faire cela est de ne pas changer l'instruction mais de changer les instructions comparÃ©es :

![](<../../.gitbook/assets/image (55).png>)

**Une autre faÃ§on** est de ne pas comparer avec 1000000, mais de dÃ©finir la valeur Ã  1 pour que this.o soit comparÃ© Ã  1 :

![](<../../.gitbook/assets/image (57).png>)

Une quatriÃ¨me faÃ§on est d'ajouter une instruction pour dÃ©placer la valeur de v9(1000000) vers v0 _(this.o)_ :

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## Solution

Faites en sorte que l'application exÃ©cute la boucle 100000 fois lorsque vous gagnez la premiÃ¨re fois. Pour ce faire, vous devez simplement crÃ©er la boucle **:goto\_6** et faire en sorte que l'application **saute lÃ -bas si \_this.o**\_\*\* n'a pas la valeur 100000\*\* :

![](<../../.gitbook/assets/image (59).png>)

Vous devez faire cela dans un appareil physique car (je ne sais pas pourquoi) cela ne fonctionne pas dans un appareil Ã©mulÃ©.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
