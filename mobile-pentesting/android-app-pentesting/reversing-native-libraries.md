# Reversing Native Libraries

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}


**Para mais informa√ß√µes, confira:** [**https://maddiestone.github.io/AndroidAppRE/reversing\_native\_libs.html**](https://maddiestone.github.io/AndroidAppRE/reversing\_native\_libs.html)

Aplicativos Android podem usar bibliotecas nativas, tipicamente escritas em C ou C++, para tarefas cr√≠ticas de desempenho. Criadores de malware tamb√©m usam essas bibliotecas, pois s√£o mais dif√≠ceis de reverter do que o bytecode DEX. A se√ß√£o enfatiza habilidades de engenharia reversa adaptadas para Android, em vez de ensinar linguagens de montagem. Vers√µes ARM e x86 das bibliotecas s√£o fornecidas para compatibilidade.

### Pontos Chave:

* **Bibliotecas Nativas em Aplicativos Android:**
* Usadas para tarefas intensivas em desempenho.
* Escritas em C ou C++, tornando a engenharia reversa desafiadora.
* Encontradas no formato `.so` (shared object), semelhante a bin√°rios do Linux.
* Criadores de malware preferem c√≥digo nativo para dificultar a an√°lise.
* **Java Native Interface (JNI) & Android NDK:**
* JNI permite que m√©todos Java sejam implementados em c√≥digo nativo.
* NDK √© um conjunto de ferramentas espec√≠fico do Android para escrever c√≥digo nativo.
* JNI e NDK conectam c√≥digo Java (ou Kotlin) com bibliotecas nativas.
* **Carregamento e Execu√ß√£o de Bibliotecas:**
* Bibliotecas s√£o carregadas na mem√≥ria usando `System.loadLibrary` ou `System.load`.
* JNI\_OnLoad √© executado ao carregar a biblioteca.
* M√©todos nativos declarados em Java se conectam a fun√ß√µes nativas, permitindo a execu√ß√£o.
* **Vinculando M√©todos Java a Fun√ß√µes Nativas:**
* **Vincula√ß√£o Din√¢mica:** Nomes de fun√ß√µes em bibliotecas nativas correspondem a um padr√£o espec√≠fico, permitindo vincula√ß√£o autom√°tica.
* **Vincula√ß√£o Est√°tica:** Usa `RegisterNatives` para vincula√ß√£o, proporcionando flexibilidade na nomea√ß√£o e estrutura das fun√ß√µes.
* **Ferramentas e T√©cnicas de Engenharia Reversa:**
* Ferramentas como Ghidra e IDA Pro ajudam a analisar bibliotecas nativas.
* `JNIEnv` √© crucial para entender fun√ß√µes e intera√ß√µes JNI.
* Exerc√≠cios s√£o fornecidos para praticar o carregamento de bibliotecas, vincula√ß√£o de m√©todos e identifica√ß√£o de fun√ß√µes nativas.

### Recursos:

* **Aprendendo Assembly ARM:**
* Sugerido para uma compreens√£o mais profunda da arquitetura subjacente.
* [ARM Assembly Basics](https://azeria-labs.com/writing-arm-assembly-part-1/) da Azeria Labs √© recomendado.
* **Documenta√ß√£o JNI & NDK:**
* [Especifica√ß√£o JNI da Oracle](https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/jniTOC.html)
* [Dicas JNI do Android](https://developer.android.com/training/articles/perf-jni)
* [Introdu√ß√£o ao NDK](https://developer.android.com/ndk/guides/)
* **Depurando Bibliotecas Nativas:**
* [Depurando Bibliotecas Nativas do Android Usando JEB Decompiler](https://medium.com/@shubhamsonani/how-to-debug-android-native-libraries-using-jeb-decompiler-eec681a22cf3)


{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
