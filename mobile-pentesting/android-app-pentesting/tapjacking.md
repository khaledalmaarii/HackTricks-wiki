# Tapjacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## **Basic Information**

**Tapjacking** je napad gde se **maliciozna** **aplikacija** pokreÄ‡e i **pozicionira iznad aplikacije Å¾rtve**. Kada vidljivo zakloni aplikaciju Å¾rtve, njen korisniÄki interfejs je dizajniran na naÄin da prevari korisnika da interaguje sa njom, dok zapravo prosleÄ‘uje interakciju aplikaciji Å¾rtve.\
U suÅ¡tini, to **oslepljuje korisnika da ne zna da zapravo izvrÅ¡ava radnje na aplikaciji Å¾rtve**.

### Detection

Da biste otkrili aplikacije ranjive na ovaj napad, trebali biste traÅ¾iti **izvezene aktivnosti** u android manifestu (napomena: aktivnost sa intent-filter-om se automatski izveze po defaultu). Kada pronaÄ‘ete izvezene aktivnosti, **proverite da li zahtevaju neku dozvolu**. To je zato Å¡to Ä‡e **maliciozna aplikacija takoÄ‘e trebati tu dozvolu**.

### Protection

#### Android 12 (API 31,32) i viÅ¡e

[**Prema ovom izvoru**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** napadi tapjacking-a se automatski spreÄavaju od strane Android-a od Android 12 (API 31 & 30) i viÅ¡e. Dakle, Äak i ako je aplikacija ranjiva, **neÄ‡ete moÄ‡i da je iskoristite**.

#### `filterTouchesWhenObscured`

Ako je **`android:filterTouchesWhenObscured`** postavljeno na **`true`**, `View` neÄ‡e primati dodire kada je prozor prikaza zaklonjen drugim vidljivim prozorom.

#### **`setFilterTouchesWhenObscured`**

Atribut **`setFilterTouchesWhenObscured`** postavljen na true takoÄ‘e moÅ¾e spreÄiti iskoriÅ¡Ä‡avanje ove ranjivosti ako je verzija Android-a niÅ¾a.\
Ako je postavljeno na **`true`**, na primer, dugme moÅ¾e automatski biti **onemoguÄ‡eno ako je zaklonjeno**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Eksploatacija

### Tapjacking-ExportedActivity

Najnovija **Android aplikacija** koja izvodi Tapjacking napad (+ pozivanje pre izvezene aktivnosti napadnute aplikacije) moÅ¾e se pronaÄ‡i na: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Pratite **README uputstva za koriÅ¡Ä‡enje**.

### FloatingWindowApp

Primer projekta koji implementira **FloatingWindowApp**, koji se moÅ¾e koristiti za postavljanje iznad drugih aktivnosti radi izvoÄ‘enja clickjacking napada, moÅ¾e se pronaÄ‡i u [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (malo staro, sreÄ‡no sa izradom apk).

### Qark

{% hint style="danger" %}
Izgleda da ovaj projekat sada nije odrÅ¾avan i ova funkcionalnost viÅ¡e ne radi ispravno
{% endhint %}

MoÅ¾ete koristiti [**qark**](https://github.com/linkedin/qark) sa `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` parametrima da kreirate zloÄ‡udnu aplikaciju za testiranje moguÄ‡ih **Tapjacking** ranjivosti.\

Mitracija je relativno jednostavna jer programer moÅ¾e odluÄiti da ne prima dodirne dogaÄ‘aje kada je prikaz pokriven drugim. KoristeÄ‡i [Android Developerâ€™s Reference](https://developer.android.com/reference/android/view/View#security):

> Ponekad je od suÅ¡tinskog znaÄaja da aplikacija moÅ¾e da verifikuje da se akcija vrÅ¡i uz puno znanje i pristanak korisnika, kao Å¡to je odobravanje zahteva za dozvolu, kupovina ili klik na oglas. NaÅ¾alost, zloÄ‡udna aplikacija bi mogla pokuÅ¡ati da prevari korisnika da izvrÅ¡i ove akcije, nesvesno, prikrivajuÄ‡i namenu prikaza. Kao reÅ¡enje, okvir nudi mehanizam filtriranja dodira koji se moÅ¾e koristiti za poboljÅ¡anje bezbednosti prikaza koji pruÅ¾aju pristup osetljivoj funkcionalnosti.
>
> Da biste omoguÄ‡ili filtriranje dodira, pozovite [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ili postavite android:filterTouchesWhenObscured atribut rasporeda na true. Kada je omoguÄ‡eno, okvir Ä‡e odbaciti dodire koji se primaju kada je prozor prikaza zaklonjen drugim vidljivim prozorom. Kao rezultat, prikaz neÄ‡e primati dodire kada se iznad prozora prikaza pojavi toast, dijalog ili drugi prozor.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¡ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
