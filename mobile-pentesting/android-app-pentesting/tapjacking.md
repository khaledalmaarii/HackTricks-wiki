# Tapjacking

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **InformaÃ§Ãµes BÃ¡sicas**

**Tapjacking** Ã© um ataque em que um **aplicativo malicioso** Ã© lanÃ§ado e **se posiciona sobre um aplicativo vÃ­tima**. Uma vez que ele obscurece visivelmente o aplicativo vÃ­tima, sua interface de usuÃ¡rio Ã© projetada de forma a enganar o usuÃ¡rio para interagir com ele, enquanto ele estÃ¡ passando a interaÃ§Ã£o para o aplicativo vÃ­tima.\
Na prÃ¡tica, ele **impede que o usuÃ¡rio saiba que estÃ¡ realmente realizando aÃ§Ãµes no aplicativo vÃ­tima**.

### DetecÃ§Ã£o

Para detectar aplicativos vulnerÃ¡veis a esse ataque, vocÃª deve procurar por **atividades exportadas** no manifesto do Android (observe que uma atividade com um intent-filter Ã© automaticamente exportada por padrÃ£o). Depois de encontrar as atividades exportadas, **verifique se elas requerem alguma permissÃ£o**. Isso ocorre porque o **aplicativo malicioso tambÃ©m precisarÃ¡ dessa permissÃ£o**.

### ProteÃ§Ã£o

#### Android 12 (API 31,32) e superior

[**De acordo com esta fonte**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** os ataques de tapjacking sÃ£o automaticamente impedidos pelo Android a partir do Android 12 (API 31 e 30) e versÃµes superiores. Portanto, mesmo que o aplicativo seja vulnerÃ¡vel, vocÃª **nÃ£o poderÃ¡ explorÃ¡-lo**.

#### **`setFilterTouchesWhenObscured`**

O atributo **`setFilterTouchesWhenObscured`** definido como true tambÃ©m pode impedir a exploraÃ§Ã£o dessa vulnerabilidade se a versÃ£o do Android for inferior.\
Se definido como **`true`**, por exemplo, um botÃ£o pode ser automaticamente **desativado se estiver obscurecido**:
```markup
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## ExploraÃ§Ã£o

### Tapjacking-ExportedActivity

A aplicaÃ§Ã£o **mais recente do Android** que realiza um **ataque de Tapjacking** (+ invocando antes uma **atividade exportada** da aplicaÃ§Ã£o atacada) pode ser encontrada em [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Siga as **instruÃ§Ãµes do README para utilizÃ¡-la**.

### FloatingWindowApp

Um projeto de exemplo que implementa o **FloatingWindowApp**, que pode ser usado para colocar em cima de outras atividades e realizar um ataque de clickjacking, pode ser encontrado em [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (um pouco antigo, boa sorte para construir o apk).

### Qark

{% hint style="danger" %}
Parece que este projeto nÃ£o estÃ¡ mais sendo mantido e essa funcionalidade nÃ£o estÃ¡ funcionando corretamente.
{% endhint %}

VocÃª pode usar o [**qark**](https://github.com/linkedin/qark) com os parÃ¢metros `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` para criar um aplicativo malicioso e testar possÃ­veis vulnerabilidades de **Tapjacking**.

A mitigaÃ§Ã£o Ã© relativamente simples, pois o desenvolvedor pode optar por nÃ£o receber eventos de toque quando uma visualizaÃ§Ã£o Ã© coberta por outra. Usando a [ReferÃªncia do Desenvolvedor Android](https://developer.android.com/reference/android/view/View#security):

> Ã€s vezes, Ã© essencial que um aplicativo possa verificar se uma aÃ§Ã£o estÃ¡ sendo realizada com o pleno conhecimento e consentimento do usuÃ¡rio, como conceder uma solicitaÃ§Ã£o de permissÃ£o, fazer uma compra ou clicar em um anÃºncio. Infelizmente, um aplicativo malicioso pode tentar enganar o usuÃ¡rio para realizar essas aÃ§Ãµes, sem saber, ocultando o propÃ³sito pretendido da visualizaÃ§Ã£o. Como remÃ©dio, o framework oferece um mecanismo de filtragem de toque que pode ser usado para melhorar a seguranÃ§a das visualizaÃ§Ãµes que fornecem acesso a funcionalidades sensÃ­veis.
>
> Para habilitar a filtragem de toque, chame [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ou defina o atributo de layout android:filterTouchesWhenObscured como true. Quando habilitado, o framework descartarÃ¡ os toques recebidos sempre que a janela da visualizaÃ§Ã£o estiver obscurecida por outra janela visÃ­vel. Como resultado, a visualizaÃ§Ã£o nÃ£o receberÃ¡ toques sempre que um toast, diÃ¡logo ou outra janela aparecer acima da janela da visualizaÃ§Ã£o.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? Gostaria de ver sua **empresa anunciada no HackTricks**? Ou gostaria de ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
