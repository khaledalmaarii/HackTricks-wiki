# Tapjacking

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## **Osnovne informacije**

**Tapjacking** je napad u kojem se pokreÄ‡e **zlonamerna aplikacija** i **pozicionira iznad aplikacije Å¾rtve**. Kada vidljivo prekrije aplikaciju Å¾rtve, njen korisniÄki interfejs je dizajniran na naÄin da prevari korisnika da s njom interaguje, dok istovremeno prenosi interakciju na aplikaciju Å¾rtve.\
Na taj naÄin, **korisnik nije svestan da zapravo izvrÅ¡ava radnje na aplikaciji Å¾rtve**.

### Detekcija

Da biste otkrili aplikacije koje su ranjive na ovaj napad, trebali biste pretraÅ¾iti **izloÅ¾ene aktivnosti** u Android manifestu (imajte na umu da se aktivnost sa intent-filterom automatski izlaÅ¾e prema podrazumevanim podeÅ¡avanjima). Kada pronaÄ‘ete izloÅ¾ene aktivnosti, **proverite da li zahtevaju neka ovlaÅ¡Ä‡enja**. To je zato Å¡to Ä‡e **zlonamerna aplikacija takoÄ‘e morati da ima to ovlaÅ¡Ä‡enje**.

### ZaÅ¡tita

#### Android 12 (API 31,32) i noviji

[**Prema ovom izvoru**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** tapjacking napadi automatski su spreÄeni od strane Androida od verzije Android 12 (API 31 i 30) i novijih. Dakle, Äak i ako je aplikacija ranjiva, **neÄ‡ete moÄ‡i da je iskoristite**.

#### `filterTouchesWhenObscured`

Ako je **`android:filterTouchesWhenObscured`** postavljen na **`true`**, `View` neÄ‡e primati dodire kada je prozor prikaza prekriven drugim vidljivim prozorom.

#### **`setFilterTouchesWhenObscured`**

Atribut **`setFilterTouchesWhenObscured`** postavljen na true takoÄ‘e moÅ¾e spreÄiti iskoriÅ¡Ä‡avanje ove ranjivosti ako je verzija Androida niÅ¾a.\
Na primer, ako je postavljeno na **`true`**, dugme se moÅ¾e automatski **onemoguÄ‡iti ako je prekriveno**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Eksploatacija

### Tapjacking-ExportedActivity

Najnoviju Android aplikaciju koja izvodi napad Tapjacking (+ pozivanje pre izvoÄ‘enja izvoÄ‘ene aktivnosti napadnute aplikacije) moÅ¾ete pronaÄ‡i na: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Pratite **uputstva u README datoteci** kako biste je koristili.

### FloatingWindowApp

Primer projekta koji implementira **FloatingWindowApp**, koji se moÅ¾e koristiti za postavljanje preko drugih aktivnosti radi izvoÄ‘enja napada clickjacking, moÅ¾ete pronaÄ‡i na [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (malo je zastareo, sreÄ‡no sa izgradnjom apk datoteke).

### Qark

{% hint style="danger" %}
Izgleda da ovaj projekat viÅ¡e nije odrÅ¾avan i ova funkcionalnost viÅ¡e ne radi kako treba.
{% endhint %}

MoÅ¾ete koristiti [**qark**](https://github.com/linkedin/qark) sa parametrima `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` da biste napravili zlonamernu aplikaciju za testiranje moguÄ‡ih ranjivosti na **Tapjacking**.

Otklanjanje ovog problema je relativno jednostavno jer programer moÅ¾e odluÄiti da ne prima dodirne dogaÄ‘aje kada je pogled prekriven drugim. KoristeÄ‡i [Android Developerâ€™s Reference](https://developer.android.com/reference/android/view/View#security):

> Ponekad je neophodno da aplikacija moÅ¾e da potvrdi da se radnja izvrÅ¡ava uz punu saglasnost i znanje korisnika, kao Å¡to je odobravanje zahteva za dozvolu, obavljanje kupovine ili klik na oglas. NaÅ¾alost, zlonamerna aplikacija moÅ¾e pokuÅ¡ati da prevari korisnika da izvrÅ¡i ove radnje, nesvestan toga, sakrivajuÄ‡i namenu prikaza. Kao lek, okvir nudi mehanizam filtriranja dodira koji se moÅ¾e koristiti za poboljÅ¡anje sigurnosti prikaza koji omoguÄ‡avaju pristup osetljivoj funkcionalnosti.
>
> Da biste omoguÄ‡ili filtriranje dodira, pozovite [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ili postavite android:filterTouchesWhenObscured atribut rasporeda na true. Kada je omoguÄ‡eno, okvir Ä‡e odbaciti dodire koji se primaju kada je prozor prikaza prekriven drugim vidljivim prozorom. Kao rezultat, prikaz neÄ‡e primati dodire kada se pojavi tost, dijalog ili drugi prozor iznad prozora prikaza.

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **oglaÅ¡avanje vaÅ¡e kompanije u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
