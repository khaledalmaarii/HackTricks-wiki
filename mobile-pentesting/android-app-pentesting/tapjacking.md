# Tapjacking

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## **Osnovne informacije**

**Tapjacking** je napad gde se **zlonamerna aplikacija pokreÄ‡e i pozicionira iznad aplikacije Å¾rtve**. Kada vidljivo prekrije aplikaciju Å¾rtve, njen korisniÄki interfejs je dizajniran na naÄin da prevari korisnika da interaguje sa njom, dok zapravo ta interakcija ide ka aplikaciji Å¾rtve.\
Na taj naÄin, **korisnik je zaslepljen i ne zna da zapravo izvrÅ¡ava akcije na aplikaciji Å¾rtve**.

### Detekcija

Da biste otkrili aplikacije koje su ranjive na ovaj napad, trebalo bi da traÅ¾ite **izloÅ¾ene aktivnosti** u android manifestu (imajte na umu da aktivnost sa intent-filterom automatski biva izloÅ¾ena po default-u). Kada pronaÄ‘ete izloÅ¾ene aktivnosti, **proverite da li zahtevaju neku dozvolu**. To je zato Å¡to Ä‡e **zlonamerna aplikacija takoÄ‘e trebati tu dozvolu**.

### ZaÅ¡tita

#### Android 12 (API 31,32) i noviji

[**Prema ovom izvoru**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** napadi tapjacking-a su automatski spreÄeni od strane Androida od Androida 12 (API 31 & 30) i novijih verzija. Dakle, Äak i ako je aplikacija ranjiva, **neÄ‡ete moÄ‡i da je iskoristite**.

#### `filterTouchesWhenObscured`

Ako je **`android:filterTouchesWhenObscured`** postavljen na **`true`**, `View` neÄ‡e primati dodire kada je prozor prikaza prekriven drugim vidljivim prozorom.

#### **`setFilterTouchesWhenObscured`**

Atribut **`setFilterTouchesWhenObscured`** postavljen na true takoÄ‘e moÅ¾e spreÄiti iskoriÅ¡Ä‡avanje ove ranjivosti ako je Android verzija niÅ¾a.\
Ako je postavljen na **`true`**, na primer, dugme moÅ¾e automatski biti **onemoguÄ‡eno ako je prekriveno**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Eksploatacija

### Tapjacking-ExportedActivity

Najnoviju **Android aplikaciju** koja izvodi napad tapjacking (+ pozivanje pre izvoÄ‘enja aktivnosti izloÅ¾ene aplikacije) moÅ¾ete pronaÄ‡i na: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Pratite **uputstva u README datoteci** kako biste je koristili.

### FloatingWindowApp

Primer projekta koji implementira **FloatingWindowApp**, koja se moÅ¾e koristiti da se postavi preko drugih aktivnosti radi izvoÄ‘enja napada clickjacking, moÅ¾ete pronaÄ‡i na [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (malo zastareo, sreÄ‡no sa izgradnjom apk datoteke).

### Qark

{% hint style="danger" %}
Izgleda da ovaj projekat viÅ¡e nije odrÅ¾avan i ova funkcionalnost viÅ¡e ne radi ispravno
{% endhint %}

MoÅ¾ete koristiti [**qark**](https://github.com/linkedin/qark) sa parametrima `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` da biste kreirali zlonamernu aplikaciju za testiranje moguÄ‡ih ranjivosti na **Tapjacking**.

Mitigacija je relativno jednostavna jer programer moÅ¾e odluÄiti da ne prima dogaÄ‘aje dodira kada je prikazan drugi prikaz preko njega. KoristeÄ‡i [Android Developerâ€™s Reference](https://developer.android.com/reference/android/view/View#security):

> Ponekad je esencijalno da aplikacija moÅ¾e da potvrdi da se akcija izvrÅ¡ava uz punu saglasnost i znanje korisnika, kao Å¡to je odobravanje zahteva za dozvolu, obavljanje kupovine ili klikanje na oglas. NaÅ¾alost, zlonamerna aplikacija moÅ¾e pokuÅ¡ati da prevari korisnika da izvrÅ¡i ove akcije, nesvestan, sakrivajuÄ‡i namenu prikaza. Kao lek, okvir nudi mehanizam filtriranja dodira koji se moÅ¾e koristiti za poboljÅ¡anje sigurnosti prikaza koji omoguÄ‡avaju pristup osetljivoj funkcionalnosti.
>
> Da biste omoguÄ‡ili filtriranje dodira, pozovite [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ili postavite android:filterTouchesWhenObscured atribut rasporeda na true. Kada je omoguÄ‡eno, okvir Ä‡e odbaciti dodire koji su primljeni kada je prozor prikaza zasenjen drugim vidljivim prozorom. Kao rezultat, prikaz neÄ‡e primati dodire kada se prikazuje tost, dijalog ili drugi prozor iznad prozora prikaza.

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
