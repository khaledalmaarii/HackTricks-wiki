# Tapjacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na(https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live) **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## **Temel Bilgiler**

**Tapjacking**, **kÃ¶tÃ¼ niyetli bir uygulamanÄ±n** **kurban uygulamanÄ±n Ã¼stÃ¼ne yerleÅŸtiÄŸi ve konumlandÄ±ÄŸÄ±** bir saldÄ±rÄ±dÄ±r. Kurban uygulamayÄ± aÃ§Ä±kÃ§a engellediÄŸinde, kullanÄ±cÄ± arayÃ¼zÃ¼ kullanÄ±cÄ±yÄ± yanÄ±ltacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r ve kullanÄ±cÄ±yÄ± etkileÅŸime girmeye ikna etmeye Ã§alÄ±ÅŸÄ±rken, etkileÅŸimi kurban uygulamaya iletmektedir.\
AslÄ±nda, kullanÄ±cÄ±nÄ±n **kurban uygulamada gerÃ§ekten eylemler gerÃ§ekleÅŸtirdiÄŸini bilmemesine neden olur**.

### Tespit

Bu saldÄ±rÄ±ya karÅŸÄ± savunmasÄ±z uygulamalarÄ± tespit etmek iÃ§in android manifestte **dÄ±ÅŸa aktarÄ±lan aktiviteleri** aramalÄ±sÄ±nÄ±z (bir intent-filter'a sahip bir aktivite varsayÄ±lan olarak otomatik olarak dÄ±ÅŸa aktarÄ±lÄ±r). DÄ±ÅŸa aktarÄ±lan aktiviteleri bulduktan sonra, **herhangi bir izin gerekip gerekmediÄŸini kontrol edin**. Bu, **kÃ¶tÃ¼ niyetli uygulamanÄ±n da o izne ihtiyaÃ§ duyacaÄŸÄ± anlamÄ±na gelir**.

### Koruma

#### Android 12 (API 31,32) ve Ã¼stÃ¼

[**Bu kaynaÄŸa gÃ¶re**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** Android 12'den (API 31 ve 30) ve Ã¼stÃ¼nden itibaren tapjacking saldÄ±rÄ±larÄ± otomatik olarak engellenir. Bu nedenle, uygulama savunmasÄ±z olsa bile **onu sÃ¶mÃ¼remeyeceksiniz**.

#### `filterTouchesWhenObscured`

**`android:filterTouchesWhenObscured`** **`true`** olarak ayarlandÄ±ÄŸÄ±nda, `View` baÅŸka bir gÃ¶rÃ¼nÃ¼r pencere tarafÄ±ndan engellendiÄŸinde dokunmalarÄ± almayacaktÄ±r.

#### **`setFilterTouchesWhenObscured`**

Ã–zellik **`setFilterTouchesWhenObscured`** **true** olarak ayarlandÄ±ÄŸÄ±nda, bu zafiyetin sÃ¶mÃ¼rÃ¼lmesini Ã¶nleyebilir, Ã¶zellikle Android sÃ¼rÃ¼mÃ¼ daha dÃ¼ÅŸÃ¼kse.\
Ã–rneÄŸin **`true`** olarak ayarlandÄ±ÄŸÄ±nda, bir dÃ¼ÄŸme otomatik olarak **engellenebilir hale gelir** eÄŸer engellenmiÅŸse:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## SÃ¶mÃ¼rÃ¼

### Tapjacking-ExportedActivity

En son **Android uygulamasÄ±** bir Tapjacking saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilir (+ hedeflenen uygulamanÄ±n dÄ±ÅŸa aktarÄ±lan bir aktivitesinden Ã¶nce Ã§aÄŸrÄ± yapabilir) ÅŸurada bulunabilir: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Kullanmak iÃ§in **README talimatlarÄ±nÄ± takip edin**.

### FloatingWindowApp

BaÅŸka aktivitelerin Ã¼zerine yerleÅŸtirilebilecek **FloatingWindowApp**'i uygulamak iÃ§in bir Ã¶rnek proje [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) iÃ§inde bulunabilir (biraz eski, apk oluÅŸturma konusunda iyi ÅŸanslar).

### Qark

{% hint style="danger" %}
Bu proje artÄ±k bakÄ±msÄ±z gÃ¶rÃ¼nÃ¼yor ve bu iÅŸlev artÄ±k dÃ¼zgÃ¼n Ã§alÄ±ÅŸmÄ±yor gibi gÃ¶rÃ¼nÃ¼yor
{% endhint %}

Muhtemel **Tapjacking** zafiyetlerini test etmek iÃ§in kÃ¶tÃ¼ niyetli bir uygulama oluÅŸturmak iÃ§in [**qark**](https://github.com/linkedin/qark) kullanabilirsiniz. `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` parametreleri ile.

GeliÅŸtirici, bir gÃ¶rÃ¼nÃ¼m baÅŸka bir ÅŸey tarafÄ±ndan kapatÄ±ldÄ±ÄŸÄ±nda dokunma olaylarÄ±nÄ± almayÄ± seÃ§ebilir, bu nedenle Ã¶nlem oldukÃ§a basittir. [Android GeliÅŸtirici ReferansÄ±](https://developer.android.com/reference/android/view/View#security) kullanarak:

> BazÄ± durumlarda, bir uygulamanÄ±n bir izin isteÄŸini kabul eden, bir satÄ±n alma yapan veya bir reklama tÄ±klayan kullanÄ±cÄ± tarafÄ±ndan tam bilgi ve onayla gerÃ§ekleÅŸtirildiÄŸini doÄŸrulamasÄ± gerekebilir. Ne yazÄ±k ki, kÃ¶tÃ¼ niyetli bir uygulama, kullanÄ±cÄ±yÄ±, gÃ¶rÃ¼nÃ¼mÃ¼n amaÃ§lanan amacÄ±nÄ± gizleyerek, bu eylemleri yapmaya zorlayabilir. Bir Ã§Ã¶zÃ¼m olarak, Ã§erÃ§eve, hassas iÅŸlevselliÄŸe eriÅŸim saÄŸlayan gÃ¶rÃ¼nÃ¼mlerin gÃ¼venliÄŸini artÄ±rmak iÃ§in kullanÄ±labilecek bir dokunma filtreleme mekanizmasÄ± sunar.
>
> Dokunma filtrelemeyi etkinleÅŸtirmek iÃ§in [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) yÃ¶ntemini Ã§aÄŸÄ±rÄ±n veya android:filterTouchesWhenObscured dÃ¼zen Ã¶zniteliÄŸini true olarak ayarlayÄ±n. EtkinleÅŸtirildiÄŸinde, Ã§erÃ§eve, gÃ¶rÃ¼nÃ¼m penceresi baÅŸka bir gÃ¶rÃ¼nÃ¼r pencere tarafÄ±ndan kaplandÄ±ÄŸÄ±nda alÄ±nan dokunuÅŸlarÄ± reddedecektir. SonuÃ§ olarak, gÃ¶rÃ¼nÃ¼m, bir toast, iletiÅŸim kutusu veya baÅŸka bir pencere gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼n penceresinin Ã¼zerinde gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nde dokunuÅŸlarÄ± almayacaktÄ±r.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
