# Tapjacking

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Informations de base**

**Tapjacking** est une attaque oÃ¹ une **application malveillante** est lancÃ©e et **se positionne au-dessus d'une application victime**. Une fois qu'elle obscurcit visiblement l'application victime, son interface utilisateur est conÃ§ue de maniÃ¨re Ã  tromper l'utilisateur pour qu'il interagisse avec elle, tout en transmettant l'interaction Ã  l'application victime.\
En effet, cela **empÃªche l'utilisateur de savoir qu'il effectue rÃ©ellement des actions sur l'application victime**.

### DÃ©tection

Pour dÃ©tecter les applications vulnÃ©rables Ã  cette attaque, vous devez rechercher des **activitÃ©s exportÃ©es** dans le manifeste Android (notez qu'une activitÃ© avec un intent-filter est automatiquement exportÃ©e par dÃ©faut). Une fois que vous avez trouvÃ© les activitÃ©s exportÃ©es, **vÃ©rifiez si elles nÃ©cessitent une autorisation**. C'est parce que l'**application malveillante aura Ã©galement besoin de cette autorisation**.

### Protection

#### Android 12 (API 31,32) et versions supÃ©rieures

[**Selon cette source**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** les attaques de tapjacking sont automatiquement empÃªchÃ©es par Android Ã  partir d'Android 12 (API 31 et 30) et versions supÃ©rieures. Donc, mÃªme si l'application est vulnÃ©rable, vous **ne pourrez pas l'exploiter**.

#### `filterTouchesWhenObscured`

Si **`android:filterTouchesWhenObscured`** est dÃ©fini sur **`true`**, la `View` ne recevra pas les touches lorsque la fenÃªtre de la vue est obscurcie par une autre fenÃªtre visible.

#### **`setFilterTouchesWhenObscured`**

L'attribut **`setFilterTouchesWhenObscured`** dÃ©fini sur true peut Ã©galement empÃªcher l'exploitation de cette vulnÃ©rabilitÃ© si la version d'Android est infÃ©rieure.\
Si dÃ©fini sur **`true`**, par exemple, un bouton peut Ãªtre automatiquement **dÃ©sactivÃ© s'il est obscurci** :
```markup
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Exploitation

### Tapjacking-ExportedActivity

La plus **rÃ©cente application Android** rÃ©alisant une **attaque Tapjacking** (+ invocation avant une **activitÃ© exportÃ©e** de l'application attaquÃ©e) peut Ãªtre trouvÃ©e sur [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Suivez les **instructions du README pour l'utiliser**.

### FloatingWindowApp

Un projet d'exemple implÃ©mentant **FloatingWindowApp**, qui peut Ãªtre utilisÃ© pour placer une fenÃªtre flottante au-dessus d'autres activitÃ©s afin de rÃ©aliser une attaque de clickjacking, peut Ãªtre trouvÃ© sur [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (un peu ancien, bonne chance pour construire l'APK).

### Qark

{% hint style="danger" %}
Il semble que ce projet ne soit plus maintenu et que cette fonctionnalitÃ© ne fonctionne plus correctement.
{% endhint %}

Vous pouvez utiliser [**qark**](https://github.com/linkedin/qark) avec les paramÃ¨tres `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` pour crÃ©er une application malveillante afin de tester les vulnÃ©rabilitÃ©s potentielles de **Tapjacking**.

La mitigation est relativement simple car le dÃ©veloppeur peut choisir de ne pas recevoir les Ã©vÃ©nements tactiles lorsque une vue est recouverte par une autre. En utilisant la [RÃ©fÃ©rence du dÃ©veloppeur Android](https://developer.android.com/reference/android/view/View#security) :

> Parfois, il est essentiel qu'une application puisse vÃ©rifier qu'une action est effectuÃ©e avec la pleine connaissance et le consentement de l'utilisateur, comme accorder une demande d'autorisation, effectuer un achat ou cliquer sur une publicitÃ©. Malheureusement, une application malveillante pourrait essayer de tromper l'utilisateur en effectuant ces actions, sans le savoir, en dissimulant l'objectif rÃ©el de la vue. Pour remÃ©dier Ã  cela, le framework propose un mÃ©canisme de filtrage tactile qui peut Ãªtre utilisÃ© pour amÃ©liorer la sÃ©curitÃ© des vues qui fournissent un accÃ¨s Ã  des fonctionnalitÃ©s sensibles.
>
> Pour activer le filtrage tactile, appelez [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ou dÃ©finissez l'attribut de mise en page android:filterTouchesWhenObscured sur true. Lorsqu'il est activÃ©, le framework ignorera les touches reÃ§ues chaque fois que la fenÃªtre de la vue est recouverte par une autre fenÃªtre visible. Par consÃ©quent, la vue ne recevra pas de touches chaque fois qu'un toast, une boÃ®te de dialogue ou une autre fenÃªtre apparaÃ®t au-dessus de la fenÃªtre de la vue.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Vous travaillez dans une **entreprise de cybersÃ©curitÃ©** ? Vous souhaitez voir votre **entreprise annoncÃ©e dans HackTricks** ? ou souhaitez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
