# Tapjacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

- **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
- [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
- [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
- **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'da **takip edin**.
- **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek PR'ler aracÄ±lÄ±ÄŸÄ±yla** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## **Temel Bilgiler**

**Tapjacking**, **kÃ¶tÃ¼ niyetli bir uygulamanÄ±n** **kurban uygulamanÄ±n Ã¼zerine yerleÅŸtiÄŸi** ve kurban uygulamanÄ±n kullanÄ±cÄ± arayÃ¼zÃ¼nÃ¼ yanÄ±ltacak ÅŸekilde tasarlandÄ±ÄŸÄ± bir saldÄ±rÄ±dÄ±r. Kurban uygulamada gerÃ§ekleÅŸtirilen eylemleri kullanÄ±cÄ±nÄ±n farkÄ±nda olmadan gerÃ§ekleÅŸtirmesine neden olur.

### Tespit

Bu saldÄ±rÄ±ya karÅŸÄ± savunmasÄ±z uygulamalarÄ± tespit etmek iÃ§in android manifest dosyasÄ±nda **dÄ±ÅŸa aktarÄ±lan aktiviteleri** aramalÄ±sÄ±nÄ±z (bir intent-filter'a sahip bir aktivite varsayÄ±lan olarak dÄ±ÅŸa aktarÄ±lÄ±r). DÄ±ÅŸa aktarÄ±lan aktiviteleri bulduktan sonra, **herhangi bir izin gerekip gerekmediÄŸini kontrol edin**. Ã‡Ã¼nkÃ¼ **kÃ¶tÃ¼ niyetli uygulama da o izne ihtiyaÃ§ duyacaktÄ±r**.

### Koruma

#### Android 12 (API 31,32) ve Ã¼stÃ¼

[**Bu kaynaÄŸa gÃ¶re**](https://www.geeksforgeeks.org/tapjacking-in-android/), Android 12'den (API 31 ve 30) itibaren tapjacking saldÄ±rÄ±larÄ± otomatik olarak engellenir. Bu nedenle, uygulama savunmasÄ±z olsa bile **saldÄ±rmak mÃ¼mkÃ¼n olmayacaktÄ±r**.

#### `filterTouchesWhenObscured`

**`android:filterTouchesWhenObscured`** **`true`** olarak ayarlandÄ±ÄŸÄ±nda, `View` baÅŸka bir gÃ¶rÃ¼nÃ¼r pencere tarafÄ±ndan kaplandÄ±ÄŸÄ±nda dokunmalarÄ± almayacaktÄ±r.

#### **`setFilterTouchesWhenObscured`**

Ã–zellik **`setFilterTouchesWhenObscured`** **true** olarak ayarlandÄ±ÄŸÄ±nda, bu zafiyetin sÃ¶mÃ¼rÃ¼lmesini Ã¶nleyebilir, Android sÃ¼rÃ¼mÃ¼ daha dÃ¼ÅŸÃ¼kse. Ã–rneÄŸin, bir dÃ¼ÄŸme **kapalÄ±ysa otomatik olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±labilir**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## SÃ¶mÃ¼rÃ¼

### Tapjacking-ExportedActivity

En son **Android uygulamasÄ±** bir Tapjacking saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilir (+ hedeflenen uygulamanÄ±n dÄ±ÅŸa aktarÄ±lan bir etkinliÄŸini Ã§aÄŸÄ±rarak) [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity) adresinde bulunabilir.

Kullanmak iÃ§in **README talimatlarÄ±nÄ± takip edin**.

### FloatingWindowApp

DiÄŸer etkinliklerin Ã¼zerine yerleÅŸtirilebilecek ve bir tÄ±klama sahtekarlÄ±ÄŸÄ± saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±labilecek **FloatingWindowApp**'i uygulayan bir Ã¶rnek proje [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) adresinde bulunabilir (biraz eski, apk oluÅŸturma konusunda iyi ÅŸanslar).

### Qark

{% hint style="danger" %}
Bu proje artÄ±k bakÄ±msÄ±z gÃ¶rÃ¼nÃ¼yor ve bu iÅŸlev artÄ±k dÃ¼zgÃ¼n Ã§alÄ±ÅŸmÄ±yor gibi gÃ¶rÃ¼nÃ¼yor
{% endhint %}

Muhtemel **Tapjacking** zafiyetlerini test etmek iÃ§in kÃ¶tÃ¼ niyetli bir uygulama oluÅŸturmak iÃ§in `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` parametreleri ile [**qark**](https://github.com/linkedin/qark) kullanabilirsiniz.

GeliÅŸtirici, bir gÃ¶rÃ¼nÃ¼mÃ¼n baÅŸka bir ÅŸey tarafÄ±ndan kapatÄ±ldÄ±ÄŸÄ±nda dokunma olaylarÄ±nÄ± almayÄ± seÃ§ebileceÄŸinden, Ã¶nlem oldukÃ§a basittir. [Android GeliÅŸtirici ReferansÄ±](https://developer.android.com/reference/android/view/View#security) kullanarak:

> BazÄ± durumlarda, bir uygulamanÄ±n, kullanÄ±cÄ±nÄ±n tam bilgi ve onayÄ±yla gerÃ§ekleÅŸtirildiÄŸini doÄŸrulamasÄ± gerekebilir, Ã¶rneÄŸin bir izin isteÄŸi vermek, bir satÄ±n alma yapmak veya bir reklama tÄ±klamak. Ne yazÄ±k ki, kÃ¶tÃ¼ niyetli bir uygulama, kullanÄ±cÄ±yÄ±, amaÃ§lanan gÃ¶rÃ¼nÃ¼mÃ¼n amacÄ±nÄ± gizleyerek, bu eylemleri bilmeksizin gerÃ§ekleÅŸtirmeye Ã§alÄ±ÅŸabilir. Bir Ã§Ã¶zÃ¼m olarak, Ã§erÃ§eve, hassas iÅŸlevselliÄŸe eriÅŸim saÄŸlayan gÃ¶rÃ¼nÃ¼mlerin gÃ¼venliÄŸini artÄ±rmak iÃ§in kullanÄ±labilecek bir dokunma filtreleme mekanizmasÄ± sunar.
>
> Dokunma filtrelemeyi etkinleÅŸtirmek iÃ§in [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) yÃ¶ntemini Ã§aÄŸÄ±rÄ±n veya android:filterTouchesWhenObscured dÃ¼zen Ã¶zniteliÄŸini true olarak ayarlayÄ±n. EtkinleÅŸtirildiÄŸinde, Ã§erÃ§eve, gÃ¶rÃ¼nÃ¼mÃ¼n penceresinin baÅŸka bir gÃ¶rÃ¼nÃ¼r pencere tarafÄ±ndan kapatÄ±ldÄ±ÄŸÄ± her zaman alÄ±nan dokunuÅŸlarÄ± reddedecektir. SonuÃ§ olarak, bir toast, iletiÅŸim kutusu veya baÅŸka bir pencere gÃ¶rÃ¼nÃ¼mÃ¼n penceresinin Ã¼zerinde gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nde, gÃ¶rÃ¼nÃ¼m dokunuÅŸlarÄ± almayacaktÄ±r.

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
