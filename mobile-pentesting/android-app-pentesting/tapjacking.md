# Tapjacking

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## **åŸºæœ¬ä¿¡æ¯**

**Tapjacking**æ˜¯ä¸€ç§æ”»å‡»ï¼Œå…¶ä¸­ä¸€ä¸ª**æ¶æ„åº”ç”¨ç¨‹åº**è¢«å¯åŠ¨å¹¶**ä½äºå—å®³è€…åº”ç”¨ç¨‹åºçš„é¡¶éƒ¨**ã€‚ä¸€æ—¦å®ƒæ˜æ˜¾é®æŒ¡äº†å—å®³è€…åº”ç”¨ç¨‹åºï¼Œå®ƒçš„ç”¨æˆ·ç•Œé¢è¢«è®¾è®¡æˆä»¥ä¸€ç§æ¬ºéª—ç”¨æˆ·ä¸ä¹‹äº¤äº’çš„æ–¹å¼ï¼ŒåŒæ—¶å°†äº¤äº’ä¼ é€’ç»™å—å®³è€…åº”ç”¨ç¨‹åºã€‚\
å®é™…ä¸Šï¼Œå®ƒ**ä½¿ç”¨æˆ·æ— æ³•çŸ¥é“ä»–ä»¬å®é™…ä¸Šæ˜¯åœ¨å¯¹å—å®³è€…åº”ç”¨ç¨‹åºæ‰§è¡Œæ“ä½œ**ã€‚

### æ£€æµ‹

ä¸ºäº†æ£€æµ‹å—æ­¤æ”»å‡»å½±å“çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨åº”è¯¥åœ¨Androidæ¸…å•ä¸­æœç´¢**å¯¼å‡ºçš„æ´»åŠ¨**ï¼ˆè¯·æ³¨æ„ï¼Œå…·æœ‰æ„å›¾è¿‡æ»¤å™¨çš„æ´»åŠ¨é»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨å¯¼å‡ºï¼‰ã€‚ä¸€æ—¦æ‰¾åˆ°å¯¼å‡ºçš„æ´»åŠ¨ï¼Œ**æ£€æŸ¥å®ƒä»¬æ˜¯å¦éœ€è¦ä»»ä½•æƒé™**ã€‚è¿™æ˜¯å› ä¸º**æ¶æ„åº”ç”¨ç¨‹åºä¹Ÿéœ€è¦è¯¥æƒé™**ã€‚

### ä¿æŠ¤

#### Android 12 (API 31,32)åŠæ›´é«˜ç‰ˆæœ¬

[**æ ¹æ®æ­¤æ¥æº**](https://www.geeksforgeeks.org/tapjacking-in-android/)**ï¼Œ**ä»Android 12ï¼ˆAPI 31å’Œ30ï¼‰åŠæ›´é«˜ç‰ˆæœ¬å¼€å§‹ï¼ŒAndroidä¼šè‡ªåŠ¨é˜²æ­¢tapjackingæ”»å‡»ã€‚å› æ­¤ï¼Œå³ä½¿åº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œæ‚¨**ä¹Ÿæ— æ³•åˆ©ç”¨å®ƒ**ã€‚

#### `filterTouchesWhenObscured`

å¦‚æœå°†**`android:filterTouchesWhenObscured`**è®¾ç½®ä¸º**`true`**ï¼Œå½“è§†å›¾çš„çª—å£è¢«å¦ä¸€ä¸ªå¯è§çª—å£é®æŒ¡æ—¶ï¼Œè¯¥è§†å›¾å°†ä¸ä¼šæ¥æ”¶è§¦æ‘¸äº‹ä»¶ã€‚

#### **`setFilterTouchesWhenObscured`**

å¦‚æœå°†å±æ€§**`setFilterTouchesWhenObscured`**è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”Androidç‰ˆæœ¬è¾ƒä½ï¼Œåˆ™è¿˜å¯ä»¥é˜²æ­¢åˆ©ç”¨æ­¤æ¼æ´ã€‚\
ä¾‹å¦‚ï¼Œå¦‚æœè¢«é®æŒ¡ï¼ŒæŒ‰é’®å¯ä»¥è‡ªåŠ¨**ç¦ç”¨**ï¼š
```markup
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Exploitation

### Tapjacking-ExportedActivity

æœ€è¿‘çš„ä¸€ä¸ªæ‰§è¡ŒTapjackingæ”»å‡»çš„Androidåº”ç”¨ç¨‹åºï¼ˆåœ¨æ”»å‡»åº”ç”¨ç¨‹åºçš„å¯¼å‡ºæ´»åŠ¨ä¹‹å‰è°ƒç”¨ï¼‰å¯ä»¥åœ¨[https://github.com/carlospolop/Tapjacking-ExportedActivity](https://github.com/carlospolop/Tapjacking-ExportedActivity)æ‰¾åˆ°ã€‚

æŒ‰ç…§READMEä¸­çš„è¯´æ˜ä½¿ç”¨å®ƒã€‚

### FloatingWindowApp

ä¸€ä¸ªå®ç°FloatingWindowAppçš„ç¤ºä¾‹é¡¹ç›®ï¼Œå¯ä»¥ç”¨æ¥æ”¾åœ¨å…¶ä»–æ´»åŠ¨çš„ä¸Šæ–¹æ‰§è¡Œç‚¹å‡»åŠ«æŒæ”»å‡»ï¼Œå¯ä»¥åœ¨[FloatingWindowApp](https://github.com/aminography/FloatingWindowApp)ä¸­æ‰¾åˆ°ï¼ˆæœ‰ç‚¹æ—§äº†ï¼Œç¥ä½ æ„å»ºapkå¥½è¿ï¼‰ã€‚

### Qark

{% hint style="danger" %}
çœ‹èµ·æ¥è¿™ä¸ªé¡¹ç›®ç°åœ¨å·²ç»ä¸å†ç»´æŠ¤ï¼Œè¿™ä¸ªåŠŸèƒ½ä¹Ÿä¸å†æ­£å¸¸å·¥ä½œ
{% endhint %}

æ‚¨å¯ä»¥ä½¿ç”¨[qark](https://github.com/linkedin/qark)å’Œ`--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk`å‚æ•°åˆ›å»ºä¸€ä¸ªæ¶æ„åº”ç”¨ç¨‹åºï¼Œä»¥æµ‹è¯•å¯èƒ½çš„Tapjackingæ¼æ´ã€‚

ç¼“è§£æªæ–½ç›¸å¯¹ç®€å•ï¼Œå¼€å‘äººå‘˜å¯ä»¥é€‰æ‹©åœ¨ä¸€ä¸ªè§†å›¾è¢«å¦ä¸€ä¸ªè§†å›¾è¦†ç›–æ—¶ä¸æ¥æ”¶è§¦æ‘¸äº‹ä»¶ã€‚ä½¿ç”¨[Androidå¼€å‘è€…å‚è€ƒ](https://developer.android.com/reference/android/view/View#security)ï¼š

> æœ‰æ—¶ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»èƒ½å¤ŸéªŒè¯ç”¨æˆ·å®Œå…¨çŸ¥æƒ…å¹¶åŒæ„æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚æˆäºˆæƒé™è¯·æ±‚ã€è¿›è¡Œè´­ä¹°æˆ–ç‚¹å‡»å¹¿å‘Šã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ¶æ„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šè¯•å›¾æ¬ºéª—ç”¨æˆ·æ‰§è¡Œè¿™äº›æ“ä½œï¼Œè€Œç”¨æˆ·å´ä¸çŸ¥æƒ…ï¼Œé€šè¿‡éšè—è§†å›¾çš„é¢„æœŸç›®çš„ã€‚ä½œä¸ºè¡¥æ•‘æªæ–½ï¼Œæ¡†æ¶æä¾›äº†ä¸€ä¸ªè§¦æ‘¸è¿‡æ»¤æœºåˆ¶ï¼Œå¯ç”¨äºæé«˜æä¾›å¯¹æ•æ„ŸåŠŸèƒ½çš„è®¿é—®çš„è§†å›¾çš„å®‰å…¨æ€§ã€‚
>
> è¦å¯ç”¨è§¦æ‘¸è¿‡æ»¤ï¼Œè¯·è°ƒç”¨[`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29)æˆ–å°†android:filterTouchesWhenObscuredå¸ƒå±€å±æ€§è®¾ç½®ä¸ºtrueã€‚å¯ç”¨åï¼Œæ¡†æ¶å°†åœ¨è§†å›¾çš„çª—å£è¢«å¦ä¸€ä¸ªå¯è§çª—å£é®æŒ¡æ—¶ä¸¢å¼ƒæ¥æ”¶åˆ°çš„è§¦æ‘¸ã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªtoastã€å¯¹è¯æ¡†æˆ–å…¶ä»–çª—å£å‡ºç°åœ¨è§†å›¾çš„çª—å£ä¸Šæ–¹æ—¶ï¼Œè§†å›¾å°†ä¸ä¼šæ¥æ”¶åˆ°è§¦æ‘¸ã€‚

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨ä¸€å®¶ç½‘ç»œå®‰å…¨å…¬å¸å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šå—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTrickså—ï¼Ÿè¯·æŸ¥çœ‹[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
