# Webview SaldÄ±rÄ±larÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## WebView YapÄ±landÄ±rmalarÄ± ve GÃ¼venliÄŸi Rehberi

### WebView Zafiyetlerinin Genel BakÄ±ÅŸÄ±

Android geliÅŸtirmenin kritik bir yÃ¶nÃ¼, WebViews'in doÄŸru ÅŸekilde iÅŸlenmesini iÃ§erir. Bu rehber, WebView kullanÄ±mÄ±yla iliÅŸkili riskleri azaltmak iÃ§in temel yapÄ±landÄ±rmalarÄ± ve gÃ¼venlik uygulamalarÄ±nÄ± vurgular.

![WebView Ã–rneÄŸi](<../../.gitbook/assets/image (1187).png>)

### **WebViews'de Dosya EriÅŸimi**

VarsayÄ±lan olarak, WebViews dosya eriÅŸimine izin verir. Bu iÅŸlevsellik, Android API seviyesi 3'ten beri mevcut olan `setAllowFileAccess()` yÃ¶ntemi tarafÄ±ndan kontrol edilir. **android.permission.READ\_EXTERNAL\_STORAGE** iznine sahip uygulamalar, dosya URL ÅŸemasÄ± (`file://path/to/file`) kullanarak harici depolamadan dosyalarÄ± okuyabilir.

#### **KullanÄ±mdan KaldÄ±rÄ±lan Ã–zellikler: Evrensel ve URL'lerden Dosya EriÅŸimi**

* **Dosya URL'lerinden Evrensel EriÅŸim**: Bu kullanÄ±mdan kaldÄ±rÄ±lan Ã¶zellik, dosya URL'lerinden Ã§apraz kÃ¶kenli isteklere izin veriyordu ve potansiyel XSS saldÄ±rÄ±larÄ± nedeniyle Ã¶nemli bir gÃ¼venlik riski oluÅŸturuyordu. Android Jelly Bean ve Ã¼zeri sÃ¼rÃ¼mlere hedeflenen uygulamalar iÃ§in varsayÄ±lan ayar devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸtÄ±r (`false`).
* Bu ayarÄ± kontrol etmek iÃ§in `getAllowUniversalAccessFromFileURLs()` kullanÄ±n.
* Bu ayarÄ± deÄŸiÅŸtirmek iÃ§in `setAllowUniversalAccessFromFileURLs(boolean)` kullanÄ±n.
* **Dosya URL'lerinden Dosya EriÅŸimi**: Bu Ã¶zellik de kullanÄ±mdan kaldÄ±rÄ±lmÄ±ÅŸ olup, diÄŸer dosya ÅŸema URL'lerinden iÃ§eriÄŸe eriÅŸimi kontrol ediyordu. Evrensel eriÅŸim gibi, gÃ¼venliÄŸi artÄ±rmak iÃ§in varsayÄ±lan olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸtÄ±r.
* Kontrol etmek iÃ§in `getAllowFileAccessFromFileURLs()` kullanÄ±n ve ayarlamak iÃ§in `setAllowFileAccessFromFileURLs(boolean)` kullanÄ±n.

#### **GÃ¼venli Dosya YÃ¼kleme**

VarlÄ±klara ve kaynaklara eriÅŸirken dosya sistemine eriÅŸimi devre dÄ±ÅŸÄ± bÄ±rakmak iÃ§in `setAllowFileAccess()` yÃ¶ntemi kullanÄ±lÄ±r. Android R ve Ã¼zeri sÃ¼rÃ¼mlerde, varsayÄ±lan ayar `false`'dur.

* `getAllowFileAccess()` ile kontrol edin.
* `setAllowFileAccess(boolean)` ile etkinleÅŸtirin veya devre dÄ±ÅŸÄ± bÄ±rakÄ±n.

#### **WebViewAssetLoader**

**WebViewAssetLoader** sÄ±nÄ±fÄ±, yerel dosyalarÄ± yÃ¼klemek iÃ§in modern bir yaklaÅŸÄ±mÄ± temsil eder. Yerel varlÄ±klara ve kaynaklara eriÅŸmek iÃ§in http(s) URL'lerini kullanÄ±r ve AynÄ± KÃ¶ken PolitikasÄ± ile uyumlu olarak Ã§alÄ±ÅŸÄ±r, bÃ¶ylece CORS yÃ¶netimini kolaylaÅŸtÄ±rÄ±r.

### loadUrl

Bu, bir web gÃ¶rÃ¼nÃ¼mÃ¼nde keyfi URL'leri yÃ¼klemek iÃ§in yaygÄ±n olarak kullanÄ±lan bir iÅŸlevdir:
```java
webview.loadUrl("<url here>")
```
### **JavaScript ve Intent Scheme Ä°ÅŸleme**

- **JavaScript**: WebViews'de varsayÄ±lan olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸtÄ±r, `setJavaScriptEnabled()` aracÄ±lÄ±ÄŸÄ±yla etkinleÅŸtirilebilir. JavaScript'in uygun korumalar olmadan etkinleÅŸtirilmesi gÃ¼venlik aÃ§Ä±klarÄ±na neden olabileceÄŸinden dikkatli olunmalÄ±dÄ±r.
- **Intent Scheme**: WebViews, `intent` ÅŸemasÄ±nÄ± iÅŸleyebilir ve dikkatli yÃ¶netilmezse sÃ¶mÃ¼rÃ¼lere yol aÃ§abilir. Bir Ã¶rnek gÃ¼venlik aÃ§Ä±ÄŸÄ±, kÃ¶tÃ¼ niyetli bir ÅŸekilde kullanÄ±labilecek "support\_url" adlÄ± aÃ§Ä±k bir WebView parametresini iÃ§eriyordu ve bu durum Ã§apraz site komut dosyasÄ± (XSS) saldÄ±rÄ±larÄ±nÄ± gerÃ§ekleÅŸtirmek iÃ§in sÃ¶mÃ¼rÃ¼lebilirdi.

![ZararlÄ± WebView](<../../.gitbook/assets/image (1188).png>)

adb kullanarak sÃ¶mÃ¼rÃ¼ Ã¶rneÄŸi:

{% code overflow="wrap" %}
```bash
adb.exe shell am start -n com.tmh.vulnwebview/.SupportWebView â€“es support_url "https://example.com/xss.html"
```
{% endcode %}

### Javascript KÃ¶prÃ¼sÃ¼

Android tarafÄ±ndan saÄŸlanan bir Ã¶zellik, WebView iÃ§indeki **JavaScript**'in **yerel Android uygulama iÅŸlevlerini** Ã§aÄŸÄ±rmasÄ±nÄ± saÄŸlar. Bu, JavaScript'i yerel Android iÅŸlevleriyle entegre eden `addJavascriptInterface` yÃ¶ntemi kullanÄ±larak gerÃ§ekleÅŸtirilir ve _WebView JavaScript kÃ¶prÃ¼sÃ¼_ olarak adlandÄ±rÄ±lÄ±r. Bu yÃ¶ntem, WebView iÃ§indeki tÃ¼m sayfalarÄ±n kayÄ±tlÄ± JavaScript ArayÃ¼zÃ¼ nesnesine eriÅŸmesine izin verdiÄŸi iÃ§in hassas bilgiler bu arayÃ¼zler aracÄ±lÄ±ÄŸÄ±yla ifÅŸa edilirse gÃ¼venlik riski oluÅŸturabilir.

* Android sÃ¼rÃ¼mÃ¼ 4.2'den dÃ¼ÅŸÃ¼k hedefleyen uygulamalar iÃ§in **son derece dikkatli olunmasÄ± gerekmektedir**, Ã§Ã¼nkÃ¼ kÃ¶tÃ¼ amaÃ§lÄ± JavaScript kullanarak yansÄ±mayÄ± sÃ¶mÃ¼rerek uzaktan kod yÃ¼rÃ¼tme izni veren bir zafiyet bulunmaktadÄ±r.

#### JavaScript KÃ¶prÃ¼sÃ¼ Uygulama

* **JavaScript arayÃ¼zleri**, bir sÄ±nÄ±f yÃ¶nteminin JavaScript'e aÃ§Ä±klandÄ±ÄŸÄ± Ã¶rneklerde olduÄŸu gibi yerel kodla etkileÅŸime geÃ§ebilir:
```javascript
@JavascriptInterface
public String getSecret() {
return "SuperSecretPassword";
};
```
* JavaScript KÃ¶prÃ¼sÃ¼, WebView'e bir arayÃ¼z eklenerek etkinleÅŸtirilir:
```javascript
webView.addJavascriptInterface(new JavascriptBridge(), "javascriptBridge");
webView.reload();
```
* JavaScript aracÄ±lÄ±ÄŸÄ±yla olasÄ± sÃ¶mÃ¼rÃ¼, Ã¶rneÄŸin bir XSS saldÄ±rÄ±sÄ± yoluyla, aÃ§Ä±ÄŸa Ã§Ä±karÄ±lan Java yÃ¶ntemlerinin Ã§aÄŸrÄ±lmasÄ±nÄ± saÄŸlar:
```html
<script>alert(javascriptBridge.getSecret());</script>
```
* Riskleri azaltmak iÃ§in **JavaScript kÃ¶prÃ¼sÃ¼ kullanÄ±mÄ±nÄ± kÄ±sÄ±tlayÄ±n** ve uzak kaynaklardan JavaScript yÃ¼klenmesini engelleyin. Eski cihazlar iÃ§in minimum API seviyesini 17 olarak ayarlayÄ±n.

### YansÄ±ma TabanlÄ± Uzak Kod YÃ¼rÃ¼tme (RCE)

* BelgelenmiÅŸ bir yÃ¶ntem, belirli bir yÃ¼kÃ¼ yÃ¼rÃ¼terek yansÄ±ma aracÄ±lÄ±ÄŸÄ±yla RCE elde etmeyi saÄŸlar. Bununla birlikte, `@JavascriptInterface` aÃ§Ä±klamasÄ± izinsiz yÃ¶ntem eriÅŸimini engeller, saldÄ±rÄ± yÃ¼zeyini sÄ±nÄ±rlar.

### Uzak Hata AyÄ±klama

* **Uzak hata ayÄ±klama**, WebView iÃ§eriÄŸi iÃ§inde etkileÅŸim ve keyfi JavaScript yÃ¼rÃ¼tme olanaÄŸÄ± saÄŸlayan **Chrome GeliÅŸtirici AraÃ§larÄ±** ile mÃ¼mkÃ¼ndÃ¼r.

#### Uzak Hata AyÄ±klamanÄ±n EtkinleÅŸtirilmesi

* Uygulama iÃ§indeki tÃ¼m WebViews iÃ§in uzak hata ayÄ±klama, ÅŸu ÅŸekilde etkinleÅŸtirilebilir:
```java
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
WebView.setWebContentsDebuggingEnabled(true);
}
```
* UygulamanÄ±n hata ayÄ±klanabilir durumuna baÄŸlÄ± olarak hata ayÄ±klamayÄ± koÅŸullu olarak etkinleÅŸtirmek iÃ§in:
```java
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
if (0 != (getApplicationInfo().flags & ApplicationInfo.FLAG_DEBUGGABLE))
{ WebView.setWebContentsDebuggingEnabled(true); }
}
```
## Keyfi DosyalarÄ± DÄ±ÅŸa Aktar

* Bir XMLHttpRequest kullanarak keyfi dosyalarÄ±n dÄ±ÅŸa aktarÄ±lmasÄ±nÄ± gÃ¶sterir:
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if (xhr.readyState == XMLHttpRequest.DONE) {
alert(xhr.responseText);
}
}
xhr.open('GET', 'file:///data/data/com.authenticationfailure.wheresmybrowser/databases/super_secret.db', true);
xhr.send(null);
```
## Referanslar

* [https://labs.integrity.pt/articles/review-android-webviews-fileaccess-attack-vectors/index.html](https://labs.integrity.pt/articles/review-android-webviews-fileaccess-attack-vectors/index.html)
* [https://github.com/authenticationfailure/WheresMyBrowser.Android](https://github.com/authenticationfailure/WheresMyBrowser.Android)
* [https://developer.android.com/reference/android/webkit/WebView](https://developer.android.com/reference/android/webkit/WebView)
* [https://medium.com/@justmobilesec/deep-links-webviews-exploitations-part-ii-5c0b118ec6f1](https://medium.com/@justmobilesec/deep-links-webviews-exploitations-part-ii-5c0b118ec6f1)
* [https://www.justmobilesec.com/en/blog/deep-links-webviews-exploitations-part-I](https://www.justmobilesec.com/en/blog/deep-links-webviews-exploitations-part-I)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) arasÄ±nda
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
