# iOS Pentesting

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=ios-pentesting) è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=ios-pentesting" %}

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
{% endhint %}

## iOS åŸºç¡€

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

## æµ‹è¯•ç¯å¢ƒ

åœ¨æ­¤é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æœ‰å…³ **iOS æ¨¡æ‹Ÿå™¨**ã€**ä»¿çœŸå™¨**å’Œ **è¶Šç‹±**çš„ä¿¡æ¯ï¼š

{% content-ref url="ios-testing-environment.md" %}
[ios-testing-environment.md](ios-testing-environment.md)
{% endcontent-ref %}

## åˆæ­¥åˆ†æ

### åŸºæœ¬ iOS æµ‹è¯•æ“ä½œ

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ **å°†å»ºè®®è¿›è¡Œå‡ é¡¹æ“ä½œ**ï¼ˆè¿æ¥è®¾å¤‡ã€è¯»/å†™/ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶ã€ä½¿ç”¨ä¸€äº›å·¥å…·...ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•æ‰§è¡Œè¿™äº›æ“ä½œï¼Œè¯· **å¼€å§‹é˜…è¯»é¡µé¢**ï¼š

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

{% hint style="info" %}
å¯¹äºä»¥ä¸‹æ­¥éª¤ **åº”ç”¨ç¨‹åºåº”å·²å®‰è£…** åœ¨è®¾å¤‡ä¸Šï¼Œå¹¶ä¸”åº”å·²è·å¾— **IPA æ–‡ä»¶**ã€‚\
é˜…è¯» [åŸºæœ¬ iOS æµ‹è¯•æ“ä½œ](basic-ios-testing-operations.md) é¡µé¢ä»¥äº†è§£å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚
{% endhint %}

### åŸºæœ¬é™æ€åˆ†æ

å»ºè®®ä½¿ç”¨å·¥å…· [**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF) å¯¹ IPA æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨é™æ€åˆ†æã€‚

è¯†åˆ« **äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å­˜åœ¨çš„ä¿æŠ¤**ï¼š

*   **PIEï¼ˆä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼‰**ï¼šå¯ç”¨æ—¶ï¼Œåº”ç”¨ç¨‹åºæ¯æ¬¡å¯åŠ¨æ—¶åŠ è½½åˆ°éšæœºå†…å­˜åœ°å€ï¼Œä½¿å…¶åˆå§‹å†…å­˜åœ°å€æ›´éš¾é¢„æµ‹ã€‚

```bash
otool -hv <app-binary> | grep PIE   # åº”è¯¥åŒ…å« PIE æ ‡å¿—
```
*   **æ ˆé‡‘ä¸é›€**ï¼šä¸ºäº†éªŒè¯æ ˆçš„å®Œæ•´æ€§ï¼Œåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰å°†ä¸€ä¸ªâ€œé‡‘ä¸é›€â€å€¼æ”¾ç½®åœ¨æ ˆä¸Šï¼Œå¹¶åœ¨å‡½æ•°ç»“æŸæ—¶å†æ¬¡éªŒè¯ã€‚

```bash
otool -I -v <app-binary> | grep stack_chk   # åº”è¯¥åŒ…å«ç¬¦å·ï¼šstack_chk_guard å’Œ stack_chk_fail
```
*   **ARCï¼ˆè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼‰**ï¼šé˜²æ­¢å¸¸è§çš„å†…å­˜æŸåç¼ºé™·

```bash
otool -I -v <app-binary> | grep objc_release   # åº”è¯¥åŒ…å« _objc_release ç¬¦å·
```
*   **åŠ å¯†äºŒè¿›åˆ¶æ–‡ä»¶**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶åº”è¢«åŠ å¯†

```bash
otool -arch all -Vl <app-binary> | grep -A5 LC_ENCRYPT   # cryptid åº”è¯¥ä¸º 1
```

**è¯†åˆ«æ•æ„Ÿ/ä¸å®‰å…¨å‡½æ•°**

*   **å¼±å“ˆå¸Œç®—æ³•**

```bash
# åœ¨ iOS è®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_CC_MD5"
otool -Iv <app> | grep -w "_CC_SHA1"

# åœ¨ Linux ä¸Š
grep -iER "_CC_MD5"
grep -iER "_CC_SHA1"
```
*   **ä¸å®‰å…¨çš„éšæœºå‡½æ•°**

```bash
# åœ¨ iOS è®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_random"
otool -Iv <app> | grep -w "_srand"
otool -Iv <app> | grep -w "_rand"

# åœ¨ Linux ä¸Š
grep -iER "_random"
grep -iER "_srand"
grep -iER "_rand"
```
*   **ä¸å®‰å…¨çš„ â€˜Mallocâ€™ å‡½æ•°**

```bash
# åœ¨ iOS è®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_malloc"

# åœ¨ Linux ä¸Š
grep -iER "_malloc"
```
*   **ä¸å®‰å…¨å’Œæ˜“å—æ”»å‡»çš„å‡½æ•°**

```bash
# åœ¨ iOS è®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_gets"
otool -Iv <app> | grep -w "_memcpy"
otool -Iv <app> | grep -w "_strncpy"
otool -Iv <app> | grep -w "_strlen"
otool -Iv <app> | grep -w "_vsnprintf"
otool -Iv <app> | grep -w "_sscanf"
otool -Iv <app> | grep -w "_strtok"
otool -Iv <app> | grep -w "_alloca"
otool -Iv <app> | grep -w "_sprintf"
otool -Iv <app> | grep -w "_printf"
otool -Iv <app> | grep -w "_vsprintf"

# åœ¨ Linux ä¸Š
grep -R "_gets"
grep -iER "_memcpy"
grep -iER "_strncpy"
grep -iER "_strlen"
grep -iER "_vsnprintf"
grep -iER "_sscanf"
grep -iER "_strtok"
grep -iER "_alloca"
grep -iER "_sprintf"
grep -iER "_printf"
grep -iER "_vsprintf"
```

### åŸºæœ¬åŠ¨æ€åˆ†æ

æŸ¥çœ‹ [**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF) æ‰§è¡Œçš„åŠ¨æ€åˆ†æã€‚æ‚¨éœ€è¦æµè§ˆä¸åŒçš„è§†å›¾å¹¶ä¸ä¹‹äº’åŠ¨ï¼Œä½†å®ƒå°†åœ¨æ‰§è¡Œå…¶ä»–æ“ä½œæ—¶æŒ‚é’©å¤šä¸ªç±»ï¼Œå¹¶åœ¨å®Œæˆåå‡†å¤‡æŠ¥å‘Šã€‚

### åˆ—å‡ºå·²å®‰è£…çš„åº”ç”¨ç¨‹åº

ä½¿ç”¨å‘½ä»¤ `frida-ps -Uai` ç¡®å®šå·²å®‰è£…åº”ç”¨ç¨‹åºçš„ **åŒ…æ ‡è¯†ç¬¦**ï¼š
```bash
$ frida-ps -Uai
PID  Name                 Identifier
----  -------------------  -----------------------------------------
6847  Calendar             com.apple.mobilecal
6815  Mail                 com.apple.mobilemail
-  App Store            com.apple.AppStore
-  Apple Store          com.apple.store.Jolly
-  Calculator           com.apple.calculator
-  Camera               com.apple.camera
-  iGoat-Swift          OWASP.iGoat-Swift
```
### åŸºæœ¬æšä¸¾ä¸é’©å­

å­¦ä¹ å¦‚ä½•**æšä¸¾åº”ç”¨ç¨‹åºçš„ç»„ä»¶**ä»¥åŠå¦‚ä½•ä½¿ç”¨objectionè½»æ¾**é’©ä½æ–¹æ³•å’Œç±»**ï¼š

{% content-ref url="ios-hooking-with-objection.md" %}
[ios-hooking-with-objection.md](ios-hooking-with-objection.md)
{% endcontent-ref %}

### IPAç»“æ„

**IPAæ–‡ä»¶**çš„ç»“æ„æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**å‹ç¼©åŒ…**ã€‚é€šè¿‡å°†å…¶æ‰©å±•åé‡å‘½åä¸º`.zip`ï¼Œå¯ä»¥**è§£å‹ç¼©**ä»¥æ­ç¤ºå…¶å†…å®¹ã€‚åœ¨æ­¤ç»“æ„ä¸­ï¼Œ**Bundle**è¡¨ç¤ºä¸€ä¸ªå®Œå…¨æ‰“åŒ…çš„åº”ç”¨ç¨‹åºï¼Œå‡†å¤‡å®‰è£…ã€‚åœ¨å…¶ä¸­ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªåä¸º`<NAME>.app`çš„ç›®å½•ï¼Œå°è£…äº†åº”ç”¨ç¨‹åºçš„èµ„æºã€‚

* **`Info.plist`**ï¼šæ­¤æ–‡ä»¶åŒ…å«åº”ç”¨ç¨‹åºçš„ç‰¹å®šé…ç½®è¯¦ç»†ä¿¡æ¯ã€‚
* **`_CodeSignature/`**ï¼šæ­¤ç›®å½•åŒ…å«ä¸€ä¸ªplistæ–‡ä»¶ï¼ŒåŒ…å«ç­¾åï¼Œç¡®ä¿åŒ…ä¸­æ‰€æœ‰æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚
* **`Assets.car`**ï¼šä¸€ä¸ªå‹ç¼©æ¡£æ¡ˆï¼Œå­˜å‚¨å›¾æ ‡ç­‰èµ„äº§æ–‡ä»¶ã€‚
* **`Frameworks/`**ï¼šæ­¤æ–‡ä»¶å¤¹åŒ…å«åº”ç”¨ç¨‹åºçš„æœ¬åœ°åº“ï¼Œå¯èƒ½ä»¥`.dylib`æˆ–`.framework`æ–‡ä»¶çš„å½¢å¼å­˜åœ¨ã€‚
* **`PlugIns/`**ï¼šè¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºçš„æ‰©å±•ï¼Œç§°ä¸º`.appex`æ–‡ä»¶ï¼Œå°½ç®¡å®ƒä»¬å¹¶ä¸æ€»æ˜¯å­˜åœ¨ã€‚ \* [**`Core Data`**](https://developer.apple.com/documentation/coredata)ï¼šç”¨äºä¿å­˜åº”ç”¨ç¨‹åºçš„æ°¸ä¹…æ•°æ®ä»¥ä¾›ç¦»çº¿ä½¿ç”¨ï¼Œç¼“å­˜ä¸´æ—¶æ•°æ®ï¼Œå¹¶ä¸ºæ‚¨çš„åº”ç”¨åœ¨å•ä¸ªè®¾å¤‡ä¸Šæ·»åŠ æ’¤æ¶ˆåŠŸèƒ½ã€‚è¦åœ¨å•ä¸ªiCloudå¸æˆ·ä¸­çš„å¤šä¸ªè®¾å¤‡ä¹‹é—´åŒæ­¥æ•°æ®ï¼ŒCore Dataä¼šè‡ªåŠ¨å°†æ‚¨çš„æ¶æ„é•œåƒåˆ°CloudKitå®¹å™¨ä¸­ã€‚
* [**`PkgInfo`**](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/ConfigApplications.html)ï¼š`PkgInfo`æ–‡ä»¶æ˜¯æŒ‡å®šåº”ç”¨ç¨‹åºæˆ–åŒ…çš„ç±»å‹å’Œåˆ›å»ºè€…ä»£ç çš„å¦ä¸€ç§æ–¹å¼ã€‚
* **en.lproj, fr.proj, Base.lproj**ï¼šæ˜¯åŒ…å«ç‰¹å®šè¯­è¨€èµ„æºçš„è¯­è¨€åŒ…ï¼Œä»¥åŠåœ¨ä¸æ”¯æŒæŸç§è¯­è¨€æ—¶çš„é»˜è®¤èµ„æºã€‚
* **å®‰å…¨æ€§**ï¼š`_CodeSignature/`ç›®å½•é€šè¿‡æ•°å­—ç­¾åéªŒè¯æ‰€æœ‰æ‰“åŒ…æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ä¸­å‘æŒ¥å…³é”®ä½œç”¨ã€‚
* **èµ„äº§ç®¡ç†**ï¼š`Assets.car`æ–‡ä»¶ä½¿ç”¨å‹ç¼©æœ‰æ•ˆç®¡ç†å›¾å½¢èµ„äº§ï¼Œå¯¹äºä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½å’Œå‡å°‘æ•´ä½“å¤§å°è‡³å…³é‡è¦ã€‚
* **æ¡†æ¶å’Œæ’ä»¶**ï¼šè¿™äº›ç›®å½•å¼ºè°ƒäº†iOSåº”ç”¨ç¨‹åºçš„æ¨¡å—åŒ–ï¼Œå…è®¸å¼€å‘äººå‘˜åŒ…å«å¯é‡ç”¨çš„ä»£ç åº“ï¼ˆ`Frameworks/`ï¼‰å¹¶æ‰©å±•åº”ç”¨ç¨‹åºåŠŸèƒ½ï¼ˆ`PlugIns/`ï¼‰ã€‚
* **æœ¬åœ°åŒ–**ï¼šè¯¥ç»“æ„æ”¯æŒå¤šç§è¯­è¨€ï¼Œé€šè¿‡åŒ…å«ç‰¹å®šè¯­è¨€åŒ…çš„èµ„æºï¼Œä¿ƒè¿›å…¨çƒåº”ç”¨ç¨‹åºçš„è¦†ç›–ã€‚

**Info.plist**

**Info.plist**ä½œä¸ºiOSåº”ç”¨ç¨‹åºçš„åŸºçŸ³ï¼Œä»¥**é”®å€¼**å¯¹çš„å½¢å¼å°è£…äº†å…³é”®é…ç½®æ•°æ®ã€‚æ­¤æ–‡ä»¶ä¸ä»…æ˜¯åº”ç”¨ç¨‹åºçš„å¿…éœ€å“ï¼Œä¹Ÿæ˜¯æ†ç»‘åœ¨å†…çš„åº”ç”¨æ‰©å±•å’Œæ¡†æ¶çš„å¿…éœ€å“ã€‚å®ƒä»¥XMLæˆ–äºŒè¿›åˆ¶æ ¼å¼ç»“æ„åŒ–ï¼ŒåŒ…å«ä»åº”ç”¨æƒé™åˆ°å®‰å…¨é…ç½®çš„å…³é”®ä¿¡æ¯ã€‚æœ‰å…³å¯ç”¨é”®çš„è¯¦ç»†æ¢ç´¢ï¼Œå¯ä»¥å‚è€ƒ[**Apple Developer Documentation**](https://developer.apple.com/documentation/bundleresources/information\_property\_list?language=objc)ã€‚

å¯¹äºå¸Œæœ›ä»¥æ›´æ˜“äºè®¿é—®çš„æ ¼å¼å¤„ç†æ­¤æ–‡ä»¶çš„ç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡åœ¨macOSä¸Šä½¿ç”¨`plutil`ï¼ˆåœ¨10.2åŠæ›´é«˜ç‰ˆæœ¬ä¸­åŸç”Ÿå¯ç”¨ï¼‰æˆ–åœ¨Linuxä¸Šä½¿ç”¨`plistutil`è½»æ¾å®ç°XMLè½¬æ¢ã€‚è½¬æ¢çš„å‘½ä»¤å¦‚ä¸‹ï¼š

* **å¯¹äºmacOS**ï¼š
```bash
$ plutil -convert xml1 Info.plist
```
* **å¯¹äºLinux**:
```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```
åœ¨**Info.plist**æ–‡ä»¶å¯ä»¥é€éœ²çš„ä¼—å¤šä¿¡æ¯ä¸­ï¼Œæ˜¾è‘—æ¡ç›®åŒ…æ‹¬åº”ç”¨æƒé™å­—ç¬¦ä¸²ï¼ˆ`UsageDescription`ï¼‰ã€è‡ªå®šä¹‰URLæ–¹æ¡ˆï¼ˆ`CFBundleURLTypes`ï¼‰å’Œåº”ç”¨ä¼ è¾“å®‰å…¨é…ç½®ï¼ˆ`NSAppTransportSecurity`ï¼‰ã€‚è¿™äº›æ¡ç›®ï¼Œä»¥åŠå…¶ä»–å¦‚å¯¼å‡º/å¯¼å…¥çš„è‡ªå®šä¹‰æ–‡æ¡£ç±»å‹ï¼ˆ`UTExportedTypeDeclarations` / `UTImportedTypeDeclarations`ï¼‰ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶æˆ–ä½¿ç”¨ç®€å•çš„`grep`å‘½ä»¤è½»æ¾æ‰¾åˆ°ï¼š
```bash
$ grep -i <keyword> Info.plist
```
**æ•°æ®è·¯å¾„**

åœ¨ iOS ç¯å¢ƒä¸­ï¼Œç›®å½•ä¸“é—¨ç”¨äº **ç³»ç»Ÿåº”ç”¨ç¨‹åº** å’Œ **ç”¨æˆ·å®‰è£…çš„åº”ç”¨ç¨‹åº**ã€‚ç³»ç»Ÿåº”ç”¨ç¨‹åºä½äº `/Applications` ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·å®‰è£…çš„åº”ç”¨ç¨‹åºåˆ™æ”¾ç½®åœ¨ `/var/mobile/containers/Data/Application/` ä¸‹ã€‚è¿™äº›åº”ç”¨ç¨‹åºè¢«åˆ†é…ä¸€ä¸ªç§°ä¸º **128-bit UUID** çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä½¿å¾—æ‰‹åŠ¨å®šä½åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹çš„ä»»åŠ¡å› ç›®å½•åç§°çš„éšæœºæ€§è€Œå˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚

{% hint style="warning" %}
ç”±äº iOS ä¸­çš„åº”ç”¨ç¨‹åºå¿…é¡»è¿›è¡Œæ²™ç®±å¤„ç†ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºåœ¨ **`$HOME/Library/Containers`** ä¸­ä¹Ÿä¼šæœ‰ä¸€ä¸ªä»¥åº”ç”¨ç¨‹åºçš„ **`CFBundleIdentifier`** ä½œä¸ºæ–‡ä»¶å¤¹åç§°çš„æ–‡ä»¶å¤¹ã€‚

ç„¶è€Œï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼ˆæ•°æ®å’Œå®¹å™¨æ–‡ä»¶å¤¹ï¼‰éƒ½æœ‰æ–‡ä»¶ **`.com.apple.mobile_container_manager.metadata.plist`**ï¼Œè¯¥æ–‡ä»¶åœ¨é”® `MCMetadataIdentifier` ä¸­é“¾æ¥äº†è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚
{% endhint %}

ä¸ºäº†æ–¹ä¾¿å‘ç°ç”¨æˆ·å®‰è£…çš„åº”ç”¨ç¨‹åºçš„å®‰è£…ç›®å½•ï¼Œ**objection å·¥å…·** æä¾›äº†ä¸€ä¸ªæœ‰ç”¨çš„å‘½ä»¤ `env`ã€‚è¯¥å‘½ä»¤æ˜¾ç¤ºäº†ç›¸å…³åº”ç”¨ç¨‹åºçš„è¯¦ç»†ç›®å½•ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨æ­¤å‘½ä»¤çš„ç¤ºä¾‹ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # env

Name               Path
-----------------  -------------------------------------------------------------------------------------------
BundlePath         /var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app
CachesDirectory    /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library/Caches
DocumentDirectory  /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Documents
LibraryDirectory   /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library
```
æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨ `find` å‘½ä»¤åœ¨ `/private/var/containers` ä¸­æœç´¢åº”ç”¨ç¨‹åºåç§°ï¼š
```bash
find /private/var/containers -name "Progname*"
```
å‘½ä»¤å¦‚ `ps` å’Œ `lsof` ä¹Ÿå¯ä»¥ç”¨æ¥è¯†åˆ«åº”ç”¨ç¨‹åºçš„è¿›ç¨‹å’Œåˆ—å‡ºæ‰“å¼€çš„æ–‡ä»¶ï¼Œä»è€Œæä¾›æœ‰å…³åº”ç”¨ç¨‹åºæ´»åŠ¨ç›®å½•è·¯å¾„çš„è§è§£ï¼š
```bash
ps -ef | grep -i <app-name>
lsof -p <pid> | grep -i "/containers" | head -n 1
```
**Bundle directory:**

* **AppName.app**
* è¿™æ˜¯åœ¨IPAä¸­çœ‹åˆ°çš„åº”ç”¨ç¨‹åºåŒ…ï¼Œå®ƒåŒ…å«äº†åŸºæœ¬çš„åº”ç”¨ç¨‹åºæ•°æ®ã€é™æ€å†…å®¹ä»¥åŠåº”ç”¨ç¨‹åºçš„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
* è¯¥ç›®å½•å¯¹ç”¨æˆ·å¯è§ï¼Œä½†**ç”¨æˆ·æ— æ³•å†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸è¢«å¤‡ä»½**ã€‚
* æ­¤æ–‡ä»¶å¤¹çš„å†…å®¹ç”¨äº**éªŒè¯ä»£ç ç­¾å**ã€‚

**Data directory:**

* **Documents/**
* åŒ…å«æ‰€æœ‰ç”¨æˆ·ç”Ÿæˆçš„æ•°æ®ã€‚åº”ç”¨ç¨‹åºæœ€ç»ˆç”¨æˆ·å‘èµ·æ­¤æ•°æ®çš„åˆ›å»ºã€‚
* å¯¹ç”¨æˆ·å¯è§ï¼Œ**ç”¨æˆ·å¯ä»¥å†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**è¢«å¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½®`NSURLIsExcludedFromBackupKey`æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/**
* åŒ…å«æ‰€æœ‰**éç”¨æˆ·ç‰¹å®š**çš„**æ–‡ä»¶**ï¼Œä¾‹å¦‚**ç¼“å­˜**ã€**åå¥½è®¾ç½®**ã€**cookies**å’Œå±æ€§åˆ—è¡¨ï¼ˆplistï¼‰é…ç½®æ–‡ä»¶ã€‚
* iOSåº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨`Application Support`å’Œ`Caches`å­ç›®å½•ï¼Œä½†åº”ç”¨ç¨‹åºå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å­ç›®å½•ã€‚
* **Library/Caches/**
* åŒ…å«**åŠæŒä¹…çš„ç¼“å­˜æ–‡ä»¶**ã€‚
* å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œ**ç”¨æˆ·æ— æ³•å†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸è¢«å¤‡ä»½**ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•çš„æ–‡ä»¶ã€‚
* **Library/Application Support/**
* åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„**æŒä¹…****æ–‡ä»¶**ã€‚
* å¯¹**ç”¨æˆ·ä¸å¯è§**ï¼Œç”¨æˆ·æ— æ³•å†™å…¥ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**è¢«å¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½®`NSURLIsExcludedFromBackupKey`æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/Preferences/**
* ç”¨äºå­˜å‚¨å³ä½¿åœ¨åº”ç”¨ç¨‹åºé‡æ–°å¯åŠ¨åä¹Ÿèƒ½**æŒä¹…**çš„å±æ€§ã€‚
* ä¿¡æ¯ä»¥æœªåŠ å¯†çš„å½¢å¼ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç®±ä¸­çš„ä¸€ä¸ªåä¸º\[BUNDLE\_ID].plistçš„plistæ–‡ä»¶ä¸­ã€‚
* ä½¿ç”¨`NSUserDefaults`å­˜å‚¨çš„æ‰€æœ‰é”®/å€¼å¯¹éƒ½å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚
* **tmp/**
* ä½¿ç”¨æ­¤ç›®å½•æ¥å†™å…¥**ä¸´æ—¶æ–‡ä»¶**ï¼Œè¿™äº›æ–‡ä»¶åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä¹‹é—´ä¸éœ€è¦æŒä¹…åŒ–ã€‚
* åŒ…å«éæŒä¹…çš„ç¼“å­˜æ–‡ä»¶ã€‚
* å¯¹ç”¨æˆ·**ä¸å¯è§**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹ä¸è¢«å¤‡ä»½ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•çš„æ–‡ä»¶ã€‚

è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹çœ‹iGoat-Swiftçš„åº”ç”¨ç¨‹åºåŒ…ï¼ˆ.appï¼‰ç›®å½•ï¼Œä½äºåŒ…ç›®å½•å†…ï¼ˆ`/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app`ï¼‰ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # ls
NSFileType      Perms  NSFileProtection    ...  Name
------------  -------  ------------------  ...  --------------------------------------
Regular           420  None                ...  rutger.html
Regular           420  None                ...  mansi.html
Regular           420  None                ...  splash.html
Regular           420  None                ...  about.html

Regular           420  None                ...  LICENSE.txt
Regular           420  None                ...  Sentinel.txt
Regular           420  None                ...  README.txt
```
### äºŒè¿›åˆ¶é€†å‘

åœ¨ `<application-name>.app` æ–‡ä»¶å¤¹å†…ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªåä¸º `<application-name>` çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™æ˜¯å°†è¢« **æ‰§è¡Œ** çš„æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…· **`otool`** å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒåŸºæœ¬æ£€æŸ¥ï¼š
```bash
otool -Vh DVIA-v2 #Check some compilation attributes
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64    ARM64        ALL  0x00     EXECUTE    65       7112   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE

otool -L DVIA-v2 #Get third party libraries
DVIA-v2:
/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.1)
/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 274.6.0)
/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)
@rpath/Bolts.framework/Bolts (compatibility version 1.0.0, current version 1.0.0)
[...]
```
**æ£€æŸ¥åº”ç”¨æ˜¯å¦åŠ å¯†**

æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•è¾“å‡ºï¼š
```bash
otool -l <app-binary> | grep -A 4 LC_ENCRYPTION_INFO
```
**åæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶**

åæ±‡ç¼–æ–‡æœ¬æ®µï¼š
```bash
otool -tV DVIA-v2
DVIA-v2:
(__TEXT,__text) section
+[DDLog initialize]:
0000000100004ab8    sub    sp, sp, #0x60
0000000100004abc    stp    x29, x30, [sp, #0x50]   ; Latency: 6
0000000100004ac0    add    x29, sp, #0x50
0000000100004ac4    sub    x8, x29, #0x10
0000000100004ac8    mov    x9, #0x0
0000000100004acc    adrp    x10, 1098 ; 0x10044e000
0000000100004ad0    add    x10, x10, #0x268
```
è¦æ‰“å°ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„ **Objective-C æ®µ**ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
```bash
otool -oV DVIA-v2
DVIA-v2:
Contents of (__DATA,__objc_classlist) section
00000001003dd5b8 0x1004423d0 _OBJC_CLASS_$_DDLog
isa        0x1004423a8 _OBJC_METACLASS_$_DDLog
superclass 0x0 _OBJC_CLASS_$_NSObject
cache      0x0 __objc_empty_cache
vtable     0x0
data       0x1003de748
flags          0x80
instanceStart  8
```
ä¸ºäº†è·å¾—æ›´ç´§å‡‘çš„ Objective-C ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [**class-dump**](http://stevenygard.com/projects/class-dump/):
```bash
class-dump some-app
//
//     Generated by class-dump 3.5 (64 bit).
//
//     class-dump is Copyright (C) 1997-1998, 2000-2001, 2004-2013 by Steve Nygard.
//

#pragma mark Named Structures

struct CGPoint {
double _field1;
double _field2;
};

struct CGRect {
struct CGPoint _field1;
struct CGSize _field2;
};

struct CGSize {
double _field1;
double _field2;
};
```
ç„¶è€Œï¼Œåæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶çš„æœ€ä½³é€‰é¡¹æ˜¯ï¼š[**Hopper**](https://www.hopperapp.com/download.html?) å’Œ [**IDA**](https://www.hex-rays.com/products/ida/support/download\_freeware/)ã€‚

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=ios-pentesting) è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=ios-pentesting" %}

## æ•°æ®å­˜å‚¨

è¦äº†è§£ iOS å¦‚ä½•åœ¨è®¾å¤‡ä¸­å­˜å‚¨æ•°æ®ï¼Œè¯·é˜…è¯»æ­¤é¡µé¢ï¼š

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

{% hint style="warning" %}
ä»¥ä¸‹å­˜å‚¨ä¿¡æ¯çš„åœ°æ–¹åº”åœ¨ **å®‰è£…åº”ç”¨ç¨‹åºåç«‹å³** æ£€æŸ¥ï¼Œ**æ£€æŸ¥åº”ç”¨ç¨‹åºçš„æ‰€æœ‰åŠŸèƒ½å**ï¼Œç”šè‡³åœ¨ **ä»ä¸€ä¸ªç”¨æˆ·æ³¨é”€å¹¶ç™»å½•åˆ°å¦ä¸€ä¸ªç”¨æˆ·å**ã€‚\
ç›®æ ‡æ˜¯æ‰¾åˆ°åº”ç”¨ç¨‹åºçš„ **æœªä¿æŠ¤æ•æ„Ÿä¿¡æ¯**ï¼ˆå¯†ç ã€ä»¤ç‰Œï¼‰ã€å½“å‰ç”¨æˆ·å’Œä¹‹å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚
{% endhint %}

### Plist

**plist** æ–‡ä»¶æ˜¯ç»“æ„åŒ–çš„ XML æ–‡ä»¶ï¼Œ**åŒ…å«é”®å€¼å¯¹**ã€‚è¿™æ˜¯ä¸€ç§å­˜å‚¨æŒä¹…æ•°æ®çš„æ–¹å¼ï¼Œå› æ­¤æœ‰æ—¶æ‚¨å¯èƒ½ä¼šåœ¨è¿™äº›æ–‡ä»¶ä¸­æ‰¾åˆ° **æ•æ„Ÿä¿¡æ¯**ã€‚å»ºè®®åœ¨å®‰è£…åº”ç”¨ç¨‹åºåä»¥åŠåœ¨å¯†é›†ä½¿ç”¨åæ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦å†™å…¥äº†æ–°æ•°æ®ã€‚

åœ¨ plist æ–‡ä»¶ä¸­æŒä¹…åŒ–æ•°æ®çš„æœ€å¸¸è§æ–¹å¼æ˜¯é€šè¿‡ä½¿ç”¨ **NSUserDefaults**ã€‚æ­¤ plist æ–‡ä»¶ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç®±ä¸­çš„ **`Library/Preferences/<appBundleID>.plist`**

[`NSUserDefaults`](https://developer.apple.com/documentation/foundation/nsuserdefaults) ç±»æä¾›äº†ä¸é»˜è®¤ç³»ç»Ÿäº¤äº’çš„ç¼–ç¨‹æ¥å£ã€‚é»˜è®¤ç³»ç»Ÿå…è®¸åº”ç”¨ç¨‹åºæ ¹æ® **ç”¨æˆ·åå¥½** è‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚é€šè¿‡ `NSUserDefaults` ä¿å­˜çš„æ•°æ®å¯ä»¥åœ¨åº”ç”¨ç¨‹åºåŒ…ä¸­æŸ¥çœ‹ã€‚æ­¤ç±»å°† **æ•°æ®** å­˜å‚¨åœ¨ **plist** **æ–‡ä»¶** ä¸­ï¼Œä½†æ—¨åœ¨ç”¨äºå°‘é‡æ•°æ®ã€‚

æ­¤æ•°æ®ä¸èƒ½å†é€šè¿‡å—ä¿¡ä»»çš„è®¡ç®—æœºç›´æ¥è®¿é—®ï¼Œä½†å¯ä»¥é€šè¿‡æ‰§è¡Œ **å¤‡ä»½** è¿›è¡Œè®¿é—®ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ objection çš„ `ios nsuserdefaults get` æ¥ **è½¬å‚¨** ä½¿ç”¨ **`NSUserDefaults`** ä¿å­˜çš„ä¿¡æ¯ã€‚

è¦æ‰¾åˆ°åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰ plistï¼Œæ‚¨å¯ä»¥è®¿é—® `/private/var/mobile/Containers/Data/Application/{APPID}` å¹¶è¿è¡Œï¼š
```bash
find ./ -name "*.plist"
```
è¦å°†æ–‡ä»¶ä» **XML æˆ–äºŒè¿›åˆ¶ (bplist)** æ ¼å¼è½¬æ¢ä¸º XMLï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„æ“ä½œç³»ç»Ÿä½¿ç”¨å„ç§æ–¹æ³•ï¼š

**å¯¹äº macOS ç”¨æˆ·ï¼š** ä½¿ç”¨ `plutil` å‘½ä»¤ã€‚å®ƒæ˜¯ macOS (10.2+) ä¸­çš„å†…ç½®å·¥å…·ï¼Œä¸“ä¸ºæ­¤ç›®çš„è®¾è®¡ï¼š
```bash
$ plutil -convert xml1 Info.plist
```
**å¯¹äºLinuxç”¨æˆ·ï¼š** é¦–å…ˆå®‰è£… `libplist-utils`ï¼Œç„¶åä½¿ç”¨ `plistutil` è½¬æ¢æ‚¨çš„æ–‡ä»¶ï¼š
```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```
**åœ¨ Objection ä¼šè¯ä¸­ï¼š** å¯¹äºåˆ†æç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œç‰¹å®šå‘½ä»¤å…è®¸æ‚¨ç›´æ¥è½¬æ¢ plist æ–‡ä»¶ï¼š
```bash
ios plist cat /private/var/mobile/Containers/Data/Application/<Application-UUID>/Library/Preferences/com.some.package.app.plist
```
### Core Data

[`Core Data`](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CoreData/nsfetchedresultscontroller.html#//apple\_ref/doc/uid/TP40001075-CH8-SW1) æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†åº”ç”¨ç¨‹åºä¸­å¯¹è±¡æ¨¡å‹å±‚çš„æ¡†æ¶ã€‚[Core Data å¯ä»¥ä½¿ç”¨ SQLite ä½œä¸ºå…¶æŒä¹…å­˜å‚¨](https://cocoacasts.com/what-is-the-difference-between-core-data-and-sqlite/)ï¼Œä½†è¯¥æ¡†æ¶æœ¬èº«ä¸æ˜¯æ•°æ®åº“ã€‚\
CoreData é»˜è®¤ä¸åŠ å¯†å…¶æ•°æ®ã€‚ç„¶è€Œï¼Œå¯ä»¥å‘ CoreData æ·»åŠ é¢å¤–çš„åŠ å¯†å±‚ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ [GitHub Repo](https://github.com/project-imas/encrypted-core-data)ã€‚

æ‚¨å¯ä»¥åœ¨è·¯å¾„ `/private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support` ä¸­æ‰¾åˆ°åº”ç”¨ç¨‹åºçš„ SQLite Core Data ä¿¡æ¯ã€‚

**å¦‚æœæ‚¨å¯ä»¥æ‰“å¼€ SQLite å¹¶è®¿é—®æ•æ„Ÿä¿¡æ¯ï¼Œé‚£ä¹ˆæ‚¨å‘ç°äº†ä¸€ä¸ªé…ç½®é”™è¯¯ã€‚**

{% code title="Code from iGoat" %}
```objectivec
-(void)storeDetails {
AppDelegate * appDelegate = (AppDelegate *)(UIApplication.sharedApplication.delegate);

NSManagedObjectContext *context =[appDelegate managedObjectContext];

User *user = [self fetchUser];
if (user) {
return;
}
user = [NSEntityDescription insertNewObjectForEntityForName:@"User"
inManagedObjectContext:context];
user.email = CoreDataEmail;
user.password = CoreDataPassword;
NSError *error;
if (![context save:&error]) {
NSLog(@"Error in saving data: %@", [error localizedDescription]);

}else{
NSLog(@"data stored in core data");
}
}
```
{% endcode %}

### YapDatabase

[YapDatabase](https://github.com/yapstudios/YapDatabase) æ˜¯ä¸€ä¸ªåŸºäº SQLite çš„é”®å€¼å­˜å‚¨ã€‚\
ç”±äº Yap æ•°æ®åº“æ˜¯ sqlite æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­æä¾›çš„å‘½ä»¤æ‰¾åˆ°å®ƒä»¬ã€‚

### å…¶ä»– SQLite æ•°æ®åº“

åº”ç”¨ç¨‹åºé€šå¸¸ä¼šåˆ›å»ºè‡ªå·±çš„ sqlite æ•°æ®åº“ã€‚å®ƒä»¬å¯èƒ½åœ¨ä¸Šé¢**å­˜å‚¨** **æ•æ„Ÿ** **æ•°æ®**ï¼Œå¹¶ä¸”æœªåŠ å¯†ã€‚å› æ­¤ï¼Œæ£€æŸ¥åº”ç”¨ç¨‹åºç›®å½•ä¸­çš„æ¯ä¸ªæ•°æ®åº“æ€»æ˜¯å¾ˆæœ‰è¶£ã€‚å› æ­¤ï¼Œè¯·å‰å¾€ä¿å­˜æ•°æ®çš„åº”ç”¨ç¨‹åºç›®å½• (`/private/var/mobile/Containers/Data/Application/{APPID}`)
```bash
find ./ -name "*.sqlite" -or -name "*.db"
```
### Firebase å®æ—¶æ•°æ®åº“

å¼€å‘è€…å¯ä»¥é€šè¿‡ Firebase å®æ—¶æ•°æ®åº“åœ¨ **NoSQL äº‘æ‰˜ç®¡æ•°æ®åº“** ä¸­ **å­˜å‚¨å’ŒåŒæ­¥æ•°æ®**ã€‚æ•°æ®ä»¥ JSON æ ¼å¼å­˜å‚¨ï¼Œå¹¶å®æ—¶åŒæ­¥åˆ°æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯ã€‚

æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å¦‚ä½•æ£€æŸ¥é…ç½®é”™è¯¯çš„ Firebase æ•°æ®åº“ï¼š

{% content-ref url="../../network-services-pentesting/pentesting-web/buckets/firebase-database.md" %}
[firebase-database.md](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)
{% endcontent-ref %}

### Realm æ•°æ®åº“

[Realm Objective-C](https://realm.io/docs/objc/latest/) å’Œ [Realm Swift](https://realm.io/docs/swift/latest/) æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®å­˜å‚¨æ›¿ä»£æ–¹æ¡ˆï¼Œè¿™æ˜¯ Apple æœªæä¾›çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ **ä»¥æœªåŠ å¯†çš„æ–¹å¼å­˜å‚¨æ•°æ®**ï¼Œå¯ä»¥é€šè¿‡ç‰¹å®šé…ç½®å¯ç”¨åŠ å¯†ã€‚

æ•°æ®åº“ä½äºï¼š`/private/var/mobile/Containers/Data/Application/{APPID}`ã€‚è¦æ¢ç´¢è¿™äº›æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
iPhone:/private/var/mobile/Containers/Data/Application/A079DF84-726C-4AEA-A194-805B97B3684A/Documents root# ls
default.realm  default.realm.lock  default.realm.management/  default.realm.note|

$ find ./ -name "*.realm*"
```
ä¸ºäº†æŸ¥çœ‹è¿™äº›æ•°æ®åº“æ–‡ä»¶ï¼Œæ¨èä½¿ç”¨ [**Realm Studio**](https://github.com/realm/realm-studio) å·¥å…·ã€‚

è¦åœ¨ Realm æ•°æ®åº“ä¸­å®ç°åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š
```swift
// Open the encrypted Realm file where getKey() is a method to obtain a key from the Keychain or a server
let config = Realm.Configuration(encryptionKey: getKey())
do {
let realm = try Realm(configuration: config)
// Use the Realm as normal
} catch let error as NSError {
// If the encryption key is wrong, `error` will say that it's an invalid database
fatalError("Error opening realm: \(error)")
}
```
### Couchbase Lite æ•°æ®åº“

[Couchbase Lite](https://github.com/couchbase/couchbase-lite-ios) è¢«æè¿°ä¸ºä¸€ä¸ª **è½»é‡çº§** å’Œ **åµŒå…¥å¼** æ•°æ®åº“å¼•æ“ï¼Œéµå¾ª **æ–‡æ¡£å¯¼å‘** (NoSQL) æ–¹æ³•ã€‚å®ƒæ—¨åœ¨åŸç”Ÿæ”¯æŒ **iOS** å’Œ **macOS**ï¼Œæä¾›æ— ç¼åŒæ­¥æ•°æ®çš„èƒ½åŠ›ã€‚

è¦è¯†åˆ«è®¾å¤‡ä¸Šæ½œåœ¨çš„ Couchbase æ•°æ®åº“ï¼Œåº”æ£€æŸ¥ä»¥ä¸‹ç›®å½•ï¼š
```bash
ls /private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support/
```
### Cookies

iOS å°†åº”ç”¨çš„ cookies å­˜å‚¨åœ¨æ¯ä¸ªåº”ç”¨æ–‡ä»¶å¤¹ä¸­çš„ **`Library/Cookies/cookies.binarycookies`** ä¸­ã€‚ç„¶è€Œï¼Œå¼€å‘è€…æœ‰æ—¶å†³å®šå°†å®ƒä»¬ä¿å­˜åœ¨ **keychain** ä¸­ï¼Œå› ä¸ºæåˆ°çš„ **cookie æ–‡ä»¶å¯ä»¥åœ¨å¤‡ä»½ä¸­è®¿é—®**ã€‚

è¦æ£€æŸ¥ cookies æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [**è¿™ä¸ª python è„šæœ¬**](https://github.com/mdegrazia/Safari-Binary-Cookie-Parser) æˆ–ä½¿ç”¨ objection çš„ **`ios cookies get`ã€‚**\
**æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ objection å°†è¿™äº›æ–‡ä»¶è½¬æ¢ä¸º JSON æ ¼å¼å¹¶æ£€æŸ¥æ•°æ®ã€‚**
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios cookies get --json
[
{
"domain": "highaltitudehacks.com",
"expiresDate": "2051-09-15 07:46:43 +0000",
"isHTTPOnly": "false",
"isSecure": "false",
"name": "username",
"path": "/",
"value": "admin123",
"version": "0"
}
]
```
### Cache

é»˜è®¤æƒ…å†µä¸‹ï¼ŒNSURLSessionå°†æ•°æ®å­˜å‚¨åœ¨**Cache.db**æ•°æ®åº“ä¸­ï¼Œä¾‹å¦‚**HTTPè¯·æ±‚å’Œå“åº”**ã€‚å¦‚æœä»¤ç‰Œã€ç”¨æˆ·åæˆ–ä»»ä½•å…¶ä»–æ•æ„Ÿä¿¡æ¯è¢«ç¼“å­˜ï¼Œåˆ™è¯¥æ•°æ®åº“å¯èƒ½åŒ…å«**æ•æ„Ÿæ•°æ®**ã€‚è¦æŸ¥æ‰¾ç¼“å­˜çš„ä¿¡æ¯ï¼Œè¯·æ‰“å¼€åº”ç”¨çš„æ•°æ®ç›®å½•ï¼ˆ`/var/mobile/Containers/Data/Application/<UUID>`ï¼‰ï¼Œç„¶åè½¬åˆ°`/Library/Caches/<Bundle Identifier>`ã€‚**WebKitç¼“å­˜ä¹Ÿå­˜å‚¨åœ¨Cache.db**æ–‡ä»¶ä¸­ã€‚**Objection**å¯ä»¥ä½¿ç”¨å‘½ä»¤`sqlite connect Cache.db`æ‰“å¼€å¹¶ä¸æ•°æ®åº“äº¤äº’ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª**æ™®é€šçš„SQLiteæ•°æ®åº“**ã€‚

**å»ºè®®ç¦ç”¨ç¼“å­˜è¿™äº›æ•°æ®**ï¼Œå› ä¸ºå®ƒå¯èƒ½åœ¨è¯·æ±‚æˆ–å“åº”ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚ä»¥ä¸‹åˆ—è¡¨æ˜¾ç¤ºäº†å®ç°æ­¤ç›®çš„çš„ä¸åŒæ–¹æ³•ï¼š

1. å»ºè®®åœ¨æ³¨é”€ååˆ é™¤ç¼“å­˜çš„å“åº”ã€‚è¿™å¯ä»¥é€šè¿‡Appleæä¾›çš„æ–¹æ³•[`removeAllCachedResponses`](https://developer.apple.com/documentation/foundation/urlcache/1417802-removeallcachedresponses)æ¥å®Œæˆã€‚æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è°ƒç”¨æ­¤æ–¹æ³•ï¼š

`URLCache.shared.removeAllCachedResponses()`

æ­¤æ–¹æ³•å°†ä»Cache.dbæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„è¯·æ±‚å’Œå“åº”ã€‚
2. å¦‚æœæ‚¨ä¸éœ€è¦ä½¿ç”¨cookieçš„ä¼˜åŠ¿ï¼Œå»ºè®®ä»…ä½¿ç”¨URLSessionçš„[.ephemeral](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral)é…ç½®å±æ€§ï¼Œè¿™å°†ç¦ç”¨ä¿å­˜cookieå’Œç¼“å­˜ã€‚

[Appleæ–‡æ¡£](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral):

`ä¸€ä¸ªçŸ­æš‚çš„ä¼šè¯é…ç½®å¯¹è±¡ç±»ä¼¼äºé»˜è®¤çš„ä¼šè¯é…ç½®ï¼ˆè§é»˜è®¤ï¼‰ï¼Œä¸åŒä¹‹å¤„åœ¨äºç›¸åº”çš„ä¼šè¯å¯¹è±¡ä¸ä¼šå°†ç¼“å­˜ã€å‡­è¯å­˜å‚¨æˆ–ä»»ä½•ä¸ä¼šè¯ç›¸å…³çš„æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ä¸Šã€‚ç›¸åï¼Œä¸ä¼šè¯ç›¸å…³çš„æ•°æ®å­˜å‚¨åœ¨RAMä¸­ã€‚çŸ­æš‚ä¼šè¯å†™å…¥æ•°æ®åˆ°ç£ç›˜çš„å”¯ä¸€æ—¶é—´æ˜¯å½“æ‚¨å‘Šè¯‰å®ƒå°†URLçš„å†…å®¹å†™å…¥æ–‡ä»¶æ—¶ã€‚`
3. é€šè¿‡å°†ç¼“å­˜ç­–ç•¥è®¾ç½®ä¸º[.notAllowed](https://developer.apple.com/documentation/foundation/urlcache/storagepolicy/notallowed)ä¹Ÿå¯ä»¥ç¦ç”¨ç¼“å­˜ã€‚è¿™å°†ç¦ç”¨ä»¥ä»»ä½•æ–¹å¼å­˜å‚¨ç¼“å­˜ï¼Œæ— è®ºæ˜¯åœ¨å†…å­˜ä¸­è¿˜æ˜¯åœ¨ç£ç›˜ä¸Šã€‚

### Snapshots

æ¯å½“æ‚¨æŒ‰ä¸‹ä¸»å±å¹•æŒ‰é’®æ—¶ï¼ŒiOS **ä¼šæ‹æ‘„å½“å‰å±å¹•çš„å¿«ç…§**ï¼Œä»¥ä¾¿èƒ½å¤Ÿä»¥æ›´å¹³æ»‘çš„æ–¹å¼è¿‡æ¸¡åˆ°åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œå¦‚æœå½“å‰å±å¹•ä¸Šå­˜åœ¨**æ•æ„Ÿ** **æ•°æ®**ï¼Œå®ƒå°†è¢«**ä¿å­˜**åœ¨**å›¾åƒ**ä¸­ï¼ˆè¯¥å›¾åƒ**åœ¨é‡å¯åä»ç„¶å­˜åœ¨**ï¼‰ã€‚è¿™äº›å¿«ç…§æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡åŒå‡»ä¸»å±å¹•åœ¨åº”ç”¨ä¹‹é—´åˆ‡æ¢è®¿é—®ã€‚

é™¤éiPhoneè¶Šç‹±ï¼Œå¦åˆ™**æ”»å‡»è€…**éœ€è¦**è®¿é—®**æœªè¢«**è§£é”**çš„**è®¾å¤‡**æ‰èƒ½æŸ¥çœ‹è¿™äº›å±å¹•æˆªå›¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªå¿«ç…§å­˜å‚¨åœ¨åº”ç”¨çš„æ²™ç›’ä¸­ï¼Œä½äº`Library/Caches/Snapshots/`æˆ–`Library/SplashBoard/Snapshots`æ–‡ä»¶å¤¹ä¸­ï¼ˆå—ä¿¡ä»»çš„è®¡ç®—æœºæ— æ³•ä»iOS 7.0è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚

é˜²æ­¢è¿™ç§ä¸è‰¯è¡Œä¸ºçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨ä½¿ç”¨`ApplicationDidEnterBackground()`å‡½æ•°æ‹æ‘„å¿«ç…§ä¹‹å‰ï¼Œæ”¾ç½®ä¸€ä¸ªç©ºç™½å±å¹•æˆ–åˆ é™¤æ•æ„Ÿæ•°æ®ã€‚

ä»¥ä¸‹æ˜¯è®¾ç½®é»˜è®¤å±å¹•æˆªå›¾çš„ç¤ºä¾‹ä¿®å¤æ–¹æ³•ã€‚

Swift:
```swift
private var backgroundImage: UIImageView?

func applicationDidEnterBackground(_ application: UIApplication) {
let myBanner = UIImageView(image: #imageLiteral(resourceName: "overlayImage"))
myBanner.frame = UIScreen.main.bounds
backgroundImage = myBanner
window?.addSubview(myBanner)
}

func applicationWillEnterForeground(_ application: UIApplication) {
backgroundImage?.removeFromSuperview()
}
```
Objective-C:
```
@property (UIImageView *)backgroundImage;

- (void)applicationDidEnterBackground:(UIApplication *)application {
UIImageView *myBanner = [[UIImageView alloc] initWithImage:@"overlayImage.png"];
self.backgroundImage = myBanner;
self.backgroundImage.bounds = UIScreen.mainScreen.bounds;
[self.window addSubview:myBanner];
}

- (void)applicationWillEnterForeground:(UIApplication *)application {
[self.backgroundImage removeFromSuperview];
}
```
è¿™ä¼šåœ¨åº”ç”¨ç¨‹åºè¿›å…¥åå°æ—¶å°†èƒŒæ™¯å›¾åƒè®¾ç½®ä¸º `overlayImage.png`ã€‚å®ƒé˜²æ­¢æ•æ„Ÿæ•°æ®æ³„æ¼ï¼Œå› ä¸º `overlayImage.png` å°†å§‹ç»ˆè¦†ç›–å½“å‰è§†å›¾ã€‚

### Keychain

è¦è®¿é—®å’Œç®¡ç† iOS å¯†é’¥é“¾ï¼Œå¯ä»¥ä½¿ç”¨åƒ [**Keychain-Dumper**](https://github.com/ptoomey3/Keychain-Dumper) è¿™æ ·çš„å·¥å…·ï¼Œé€‚ç”¨äºè¶Šç‹±è®¾å¤‡ã€‚æ­¤å¤–ï¼Œ [**Objection**](https://github.com/sensepost/objection) æä¾›äº†å‘½ä»¤ `ios keychain dump` ç”¨äºç±»ä¼¼ç›®çš„ã€‚

#### **å­˜å‚¨å‡­æ®**

**NSURLCredential** ç±»éå¸¸é€‚åˆç›´æ¥åœ¨å¯†é’¥é“¾ä¸­ä¿å­˜æ•æ„Ÿä¿¡æ¯ï¼Œç»•è¿‡ NSUserDefaults æˆ–å…¶ä»–åŒ…è£…å™¨çš„éœ€è¦ã€‚è¦åœ¨ç™»å½•åå­˜å‚¨å‡­æ®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ Swift ä»£ç ï¼š
```swift
NSURLCredential *credential;
credential = [NSURLCredential credentialWithUser:username password:password persistence:NSURLCredentialPersistencePermanent];
[[NSURLCredentialStorage sharedCredentialStorage] setCredential:credential forProtectionSpace:self.loginProtectionSpace];
```
è¦æå–è¿™äº›å­˜å‚¨çš„å‡­æ®ï¼Œå¯ä»¥ä½¿ç”¨ Objection çš„å‘½ä»¤ `ios nsurlcredentialstorage dump`ã€‚

## **è‡ªå®šä¹‰é”®ç›˜å’Œé”®ç›˜ç¼“å­˜**

ä» iOS 8.0 å¼€å§‹ï¼Œç”¨æˆ·å¯ä»¥å®‰è£…è‡ªå®šä¹‰é”®ç›˜æ‰©å±•ï¼Œè¿™äº›æ‰©å±•å¯ä»¥åœ¨ **è®¾ç½® > é€šç”¨ > é”®ç›˜ > é”®ç›˜** ä¸‹ç®¡ç†ã€‚è™½ç„¶è¿™äº›é”®ç›˜æä¾›äº†æ‰©å±•åŠŸèƒ½ï¼Œä½†å®ƒä»¬å­˜åœ¨è®°å½•æŒ‰é”®å’Œå°†æ•°æ®ä¼ è¾“åˆ°å¤–éƒ¨æœåŠ¡å™¨çš„é£é™©ï¼Œå°½ç®¡ç”¨æˆ·ä¼šè¢«é€šçŸ¥éœ€è¦ç½‘ç»œè®¿é—®çš„é”®ç›˜ã€‚åº”ç”¨ç¨‹åºå¯ä»¥å¹¶ä¸”åº”è¯¥é™åˆ¶åœ¨æ•æ„Ÿä¿¡æ¯è¾“å…¥æ—¶ä½¿ç”¨è‡ªå®šä¹‰é”®ç›˜ã€‚

**å®‰å…¨å»ºè®®ï¼š**

* å»ºè®®ç¦ç”¨ç¬¬ä¸‰æ–¹é”®ç›˜ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚
* æ³¨æ„é»˜è®¤ iOS é”®ç›˜çš„è‡ªåŠ¨æ›´æ­£å’Œè‡ªåŠ¨å»ºè®®åŠŸèƒ½ï¼Œè¿™å¯èƒ½ä¼šå°†æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨ä½äº `Library/Keyboard/{locale}-dynamic-text.dat` æˆ– `/private/var/mobile/Library/Keyboard/dynamic-text.dat` çš„ç¼“å­˜æ–‡ä»¶ä¸­ã€‚è¿™äº›ç¼“å­˜æ–‡ä»¶åº”å®šæœŸæ£€æŸ¥ä»¥æŸ¥æ‰¾æ•æ„Ÿæ•°æ®ã€‚å»ºè®®é€šè¿‡ **è®¾ç½® > é€šç”¨ > é‡ç½® > é‡ç½®é”®ç›˜å­—å…¸** æ¥é‡ç½®é”®ç›˜å­—å…¸ï¼Œä»¥æ¸…é™¤ç¼“å­˜æ•°æ®ã€‚
* æ‹¦æˆªç½‘ç»œæµé‡å¯ä»¥æ­ç¤ºè‡ªå®šä¹‰é”®ç›˜æ˜¯å¦æ­£åœ¨è¿œç¨‹ä¼ è¾“æŒ‰é”®ã€‚

### **é˜²æ­¢æ–‡æœ¬å­—æ®µç¼“å­˜**

[UITextInputTraits åè®®](https://developer.apple.com/reference/uikit/uitextinputtraits) æä¾›äº†ç®¡ç†è‡ªåŠ¨æ›´æ­£å’Œå®‰å…¨æ–‡æœ¬è¾“å…¥çš„å±æ€§ï¼Œè¿™å¯¹äºé˜²æ­¢æ•æ„Ÿä¿¡æ¯ç¼“å­˜è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ç¦ç”¨è‡ªåŠ¨æ›´æ­£å’Œå¯ç”¨å®‰å…¨æ–‡æœ¬è¾“å…¥æ¥å®ç°ï¼š
```objectivec
textObject.autocorrectionType = UITextAutocorrectionTypeNo;
textObject.secureTextEntry = YES;
```
æ­¤å¤–ï¼Œå¼€å‘äººå‘˜åº”ç¡®ä¿æ–‡æœ¬å­—æ®µï¼Œç‰¹åˆ«æ˜¯ç”¨äºè¾“å…¥æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç å’Œ PIN çš„å­—æ®µï¼Œé€šè¿‡å°† `autocorrectionType` è®¾ç½®ä¸º `UITextAutocorrectionTypeNo` å’Œ `secureTextEntry` è®¾ç½®ä¸º `YES` æ¥ç¦ç”¨ç¼“å­˜ã€‚
```objectivec
UITextField *textField = [[UITextField alloc] initWithFrame:frame];
textField.autocorrectionType = UITextAutocorrectionTypeNo;
```
## **æ—¥å¿—**

è°ƒè¯•ä»£ç é€šå¸¸æ¶‰åŠä½¿ç”¨**æ—¥å¿—è®°å½•**ã€‚è¿™å­˜åœ¨é£é™©ï¼Œå› ä¸º**æ—¥å¿—å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯**ã€‚åœ¨ iOS 6 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œæ—¥å¿—å¯¹æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½æ˜¯å¯è®¿é—®çš„ï¼Œè¿™å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²çš„é£é™©ã€‚**ç°åœ¨ï¼Œåº”ç”¨ç¨‹åºè¢«é™åˆ¶åªèƒ½è®¿é—®è‡ªå·±çš„æ—¥å¿—**ã€‚

å°½ç®¡æœ‰è¿™äº›é™åˆ¶ï¼Œ**å…·æœ‰ç‰©ç†è®¿é—®æƒé™**çš„æ”»å‡»è€…ä»ç„¶å¯ä»¥é€šè¿‡å°†è®¾å¤‡è¿æ¥åˆ°è®¡ç®—æœºå¹¶**è¯»å–æ—¥å¿—**æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ—¥å¿—åœ¨åº”ç”¨ç¨‹åºå¸è½½åä»ç„¶ä¿ç•™åœ¨ç£ç›˜ä¸Šã€‚

ä¸ºäº†é™ä½é£é™©ï¼Œå»ºè®®**å½»åº•ä¸åº”ç”¨ç¨‹åºäº¤äº’**ï¼Œæ¢ç´¢å…¶æ‰€æœ‰åŠŸèƒ½å’Œè¾“å…¥ï¼Œä»¥ç¡®ä¿æ²¡æœ‰æ•æ„Ÿä¿¡æ¯è¢«æ„å¤–è®°å½•ã€‚

åœ¨æ£€æŸ¥åº”ç”¨ç¨‹åºæºä»£ç ä»¥å¯»æ‰¾æ½œåœ¨æ³„éœ²æ—¶ï¼ŒæŸ¥æ‰¾ä½¿ç”¨å…³é”®å­— `NSLog`ã€`NSAssert`ã€`NSCAssert`ã€`fprintf` çš„**é¢„å®šä¹‰**å’Œ**è‡ªå®šä¹‰æ—¥å¿—è®°å½•è¯­å¥**ï¼Œä»¥åŠä»»ä½•æåˆ° `Logging` æˆ– `Logfile` çš„è‡ªå®šä¹‰å®ç°ã€‚

### **ç›‘æ§ç³»ç»Ÿæ—¥å¿—**

åº”ç”¨ç¨‹åºè®°å½•å„ç§ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯èƒ½æ˜¯æ•æ„Ÿçš„ã€‚è¦ç›‘æ§è¿™äº›æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·å’Œå‘½ä»¤ï¼š
```bash
idevice_id --list   # To find the device ID
idevicesyslog -u <id> (| grep <app>)   # To capture the device logs
```
æ˜¯æœ‰ç”¨çš„ã€‚æ­¤å¤–ï¼Œ**Xcode** æä¾›äº†ä¸€ç§æ”¶é›†æ§åˆ¶å°æ—¥å¿—çš„æ–¹æ³•ï¼š

1. æ‰“å¼€ Xcodeã€‚
2. è¿æ¥ iOS è®¾å¤‡ã€‚
3. å¯¼èˆªåˆ° **Window** -> **Devices and Simulators**ã€‚
4. é€‰æ‹©æ‚¨çš„è®¾å¤‡ã€‚
5. è§¦å‘æ‚¨æ­£åœ¨è°ƒæŸ¥çš„é—®é¢˜ã€‚
6. ä½¿ç”¨ **Open Console** æŒ‰é’®åœ¨æ–°çª—å£ä¸­æŸ¥çœ‹æ—¥å¿—ã€‚

å¯¹äºæ›´é«˜çº§çš„æ—¥å¿—è®°å½•ï¼Œè¿æ¥åˆ°è®¾å¤‡ shell å¹¶ä½¿ç”¨ **socat** å¯ä»¥æä¾›å®æ—¶æ—¥å¿—ç›‘æ§ï¼š
```bash
iPhone:~ root# socat - UNIX-CONNECT:/var/run/lockdown/syslog.sock
```
è·Ÿéšå‘½ä»¤è§‚å¯Ÿæ—¥å¿—æ´»åŠ¨ï¼Œè¿™å¯¹äºè¯Šæ–­é—®é¢˜æˆ–è¯†åˆ«æ—¥å¿—ä¸­çš„æ½œåœ¨æ•°æ®æ³„æ¼éå¸¸å®è´µã€‚

***

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=ios-pentesting) è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ä»Šå¤©è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=ios-pentesting" %}

## å¤‡ä»½

**è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½** é›†æˆåœ¨ iOS ä¸­ï¼Œé€šè¿‡ iTunesï¼ˆæœ€å¤šåˆ° macOS Catalinaï¼‰ã€Finderï¼ˆä» macOS Catalina å¼€å§‹ï¼‰æˆ– iCloud æ–¹ä¾¿åœ°åˆ›å»ºè®¾å¤‡æ•°æ®å‰¯æœ¬ã€‚è¿™äº›å¤‡ä»½å‡ ä¹æ¶µç›–æ‰€æœ‰è®¾å¤‡æ•°æ®ï¼Œæ’é™¤é«˜åº¦æ•æ„Ÿçš„å…ƒç´ ï¼Œå¦‚ Apple Pay è¯¦ç»†ä¿¡æ¯å’Œ Touch ID é…ç½®ã€‚

### å®‰å…¨é£é™©

**å·²å®‰è£…åº”ç”¨åŠå…¶æ•°æ®** åŒ…å«åœ¨å¤‡ä»½ä¸­ï¼Œæå‡ºäº†æ½œåœ¨ **æ•°æ®æ³„æ¼** çš„é—®é¢˜ï¼Œä»¥åŠ **å¤‡ä»½ä¿®æ”¹å¯èƒ½æ”¹å˜åº”ç”¨åŠŸèƒ½** çš„é£é™©ã€‚å»ºè®® **ä¸è¦åœ¨ä»»ä½•åº”ç”¨çš„ç›®å½•æˆ–å…¶å­ç›®å½•ä¸­ä»¥æ˜æ–‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯** ä»¥é™ä½è¿™äº›é£é™©ã€‚

### ä»å¤‡ä»½ä¸­æ’é™¤æ–‡ä»¶

`Documents/` å’Œ `Library/Application Support/` ä¸­çš„æ–‡ä»¶é»˜è®¤ä¼šè¢«å¤‡ä»½ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨ `NSURL setResourceValue:forKey:error:` å’Œ `NSURLIsExcludedFromBackupKey` æ¥æ’é™¤ç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•ä¸è¢«å¤‡ä»½ã€‚æ­¤åšæ³•å¯¹äºä¿æŠ¤æ•æ„Ÿæ•°æ®ä¸è¢«åŒ…å«åœ¨å¤‡ä»½ä¸­è‡³å…³é‡è¦ã€‚

### æµ‹è¯•æ¼æ´

è¦è¯„ä¼°åº”ç”¨çš„å¤‡ä»½å®‰å…¨æ€§ï¼Œé¦–å…ˆä½¿ç”¨ Finder **åˆ›å»ºå¤‡ä»½**ï¼Œç„¶åæ ¹æ® [Apple çš„å®˜æ–¹æ–‡æ¡£](https://support.apple.com/en-us/HT204215) æ‰¾åˆ°å®ƒã€‚åˆ†æå¤‡ä»½ä¸­å¯èƒ½å½±å“åº”ç”¨è¡Œä¸ºçš„æ•æ„Ÿæ•°æ®æˆ–é…ç½®ã€‚

å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æˆ–åƒ [iMazing](https://imazing.com) è¿™æ ·çš„åº”ç”¨ç¨‹åºå¯»æ‰¾æ•æ„Ÿä¿¡æ¯ã€‚å¯¹äºåŠ å¯†å¤‡ä»½ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥å¤‡ä»½æ ¹ç›®å½•ä¸­çš„ "Manifest.plist" æ–‡ä»¶ä¸­çš„ "IsEncrypted" é”®æ¥ç¡®è®¤æ˜¯å¦å­˜åœ¨åŠ å¯†ã€‚
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
...
<key>Date</key>
<date>2021-03-12T17:43:33Z</date>
<key>IsEncrypted</key>
<true/>
...
</plist>
```
å¯¹äºå¤„ç†åŠ å¯†å¤‡ä»½ï¼ŒPython è„šæœ¬å¯åœ¨ [DinoSec çš„ GitHub ä»“åº“](https://github.com/dinosec/iphone-dataprotection/tree/master/python\_scripts) ä¸­æ‰¾åˆ°ï¼Œå¦‚ **backup\_tool.py** å’Œ **backup\_passwd.py**ï¼Œå¯èƒ½ä¼šæœ‰ç”¨ï¼Œä½†å¯èƒ½éœ€è¦è¿›è¡Œè°ƒæ•´ä»¥å…¼å®¹æœ€æ–°çš„ iTunes/Finder ç‰ˆæœ¬ã€‚[**iOSbackup** å·¥å…·](https://pypi.org/project/iOSbackup/) æ˜¯è®¿é—®å¯†ç ä¿æŠ¤å¤‡ä»½ä¸­æ–‡ä»¶çš„å¦ä¸€ç§é€‰æ‹©ã€‚

### ä¿®æ”¹åº”ç”¨è¡Œä¸º

é€šè¿‡å¤‡ä»½ä¿®æ”¹æ¥æ”¹å˜åº”ç”¨è¡Œä¸ºçš„ä¸€ä¸ªä¾‹å­æ˜¯åœ¨ [Bither æ¯”ç‰¹å¸é’±åŒ…åº”ç”¨](https://github.com/bither/bither-ios) ä¸­æ¼”ç¤ºçš„ï¼Œå…¶ä¸­ UI é”å®š PIN å­˜å‚¨åœ¨ `net.bither.plist` çš„ **pin\_code** é”®ä¸‹ã€‚å°†æ­¤é”®ä» plist ä¸­åˆ é™¤å¹¶æ¢å¤å¤‡ä»½å°†ç§»é™¤ PIN è¦æ±‚ï¼Œä»è€Œæä¾›æ— é™åˆ¶è®¿é—®ã€‚

## å…³äºæ•æ„Ÿæ•°æ®çš„å†…å­˜æµ‹è¯•æ€»ç»“

åœ¨å¤„ç†å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…å­˜ä¸­çš„æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œé™åˆ¶è¿™äº›æ•°æ®çš„æš´éœ²æ—¶é—´è‡³å…³é‡è¦ã€‚è°ƒæŸ¥å†…å­˜å†…å®¹æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼š**åˆ›å»ºå†…å­˜è½¬å‚¨** å’Œ **å®æ—¶åˆ†æå†…å­˜**ã€‚è¿™ä¸¤ç§æ–¹æ³•éƒ½æœ‰å…¶æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬åœ¨è½¬å‚¨è¿‡ç¨‹æˆ–åˆ†æè¿‡ç¨‹ä¸­å¯èƒ½é”™è¿‡å…³é”®æ•°æ®ã€‚

## **æ£€ç´¢å’Œåˆ†æå†…å­˜è½¬å‚¨**

å¯¹äºè¶Šç‹±å’Œéè¶Šç‹±è®¾å¤‡ï¼Œå·¥å…·å¦‚ [objection](https://github.com/sensepost/objection) å’Œ [Fridump](https://github.com/Nightbringer21/fridump) å…è®¸è½¬å‚¨åº”ç”¨ç¨‹åºçš„è¿›ç¨‹å†…å­˜ã€‚ä¸€æ—¦è½¬å‚¨ï¼Œåˆ†æè¿™äº›æ•°æ®éœ€è¦å„ç§å·¥å…·ï¼Œå…·ä½“å–å†³äºæ‚¨è¦æœç´¢çš„ä¿¡æ¯çš„æ€§è´¨ã€‚

è¦ä»å†…å­˜è½¬å‚¨ä¸­æå–å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ `strings` æˆ– `rabin2 -zz` ç­‰å‘½ä»¤ï¼š
```bash
# Extracting strings using strings command
$ strings memory > strings.txt

# Extracting strings using rabin2
$ rabin2 -ZZ memory > strings.txt
```
å¯¹äºæ›´è¯¦ç»†çš„åˆ†æï¼ŒåŒ…æ‹¬æœç´¢ç‰¹å®šæ•°æ®ç±»å‹æˆ–æ¨¡å¼ï¼Œ**radare2** æä¾›äº†å¹¿æ³›çš„æœç´¢åŠŸèƒ½ï¼š
```bash
$ r2 <name_of_your_dump_file>
[0x00000000]> /?
...
```
## **è¿è¡Œæ—¶å†…å­˜åˆ†æ**

**r2frida** æä¾›äº†ä¸€ç§å¼ºå¤§çš„æ›¿ä»£æ–¹æ¡ˆï¼Œç”¨äºå®æ—¶æ£€æŸ¥åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼Œè€Œæ— éœ€å†…å­˜è½¬å‚¨ã€‚è¯¥å·¥å…·ä½¿å¾—å¯ä»¥ç›´æ¥åœ¨æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„å†…å­˜ä¸Šæ‰§è¡Œæœç´¢å‘½ä»¤ï¼š
```bash
$ r2 frida://usb//<name_of_your_app>
[0x00000000]> /\ <search_command>
```
## ç ´æŸçš„åŠ å¯†æŠ€æœ¯

### ä¸è‰¯çš„å¯†é’¥ç®¡ç†æµç¨‹

ä¸€äº›å¼€å‘è€…å°†æ•æ„Ÿæ•°æ®ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨åœ¨ä»£ç ä¸­ç¡¬ç¼–ç /å¯é¢„æµ‹çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚è¿™æ˜¯ä¸åº”è¯¥è¿™æ ·åšçš„ï¼Œå› ä¸ºä¸€äº›åå‘å·¥ç¨‹å¯èƒ½å…è®¸æ”»å‡»è€…æå–æœºå¯†ä¿¡æ¯ã€‚

### ä½¿ç”¨ä¸å®‰å…¨å’Œ/æˆ–è¿‡æ—¶çš„ç®—æ³•

å¼€å‘è€…ä¸åº”è¯¥ä½¿ç”¨**è¿‡æ—¶çš„ç®—æ³•**æ¥æ‰§è¡Œæˆæƒ**æ£€æŸ¥**ã€**å­˜å‚¨**æˆ–**å‘é€**æ•°æ®ã€‚è¿™äº›ç®—æ³•åŒ…æ‹¬ï¼šRC4ã€MD4ã€MD5ã€SHA1â€¦â€¦å¦‚æœ**å“ˆå¸Œ**ç”¨äºå­˜å‚¨å¯†ç ï¼Œä¾‹å¦‚ï¼Œåº”è¯¥ä½¿ç”¨æŠ—æš´åŠ›ç ´è§£çš„å“ˆå¸Œï¼Œå¹¶åŠ ç›ã€‚

### æ£€æŸ¥

ä¸»è¦çš„æ£€æŸ¥æ˜¯å¯»æ‰¾æ˜¯å¦å¯ä»¥åœ¨ä»£ç ä¸­æ‰¾åˆ°**ç¡¬ç¼–ç **çš„å¯†ç /ç§˜å¯†ï¼Œæˆ–è€…è¿™äº›æ˜¯å¦æ˜¯**å¯é¢„æµ‹**çš„ï¼Œä»¥åŠä»£ç æ˜¯å¦ä½¿ç”¨æŸç§**å¼±**çš„**åŠ å¯†**ç®—æ³•ã€‚

æœ‰è¶£çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨**objection**è‡ªåŠ¨**ç›‘æ§**ä¸€äº›**åŠ å¯†****åº“**ï¼š
```swift
ios monitor crypt
```
å¯¹äº **æ›´å¤šä¿¡æ¯** å…³äº iOS åŠ å¯† API å’Œåº“ï¼Œè¯·è®¿é—® [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography)

## æœ¬åœ°èº«ä»½éªŒè¯

**æœ¬åœ°èº«ä»½éªŒè¯** åœ¨ä¿æŠ¤é€šè¿‡åŠ å¯†æ–¹æ³•è®¿é—®è¿œç¨‹ç«¯ç‚¹æ–¹é¢å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å…³é”®åœ¨äºï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®çš„å®ç°ï¼Œæœ¬åœ°èº«ä»½éªŒè¯æœºåˆ¶å¯èƒ½ä¼šè¢«ç»•è¿‡ã€‚

è‹¹æœçš„ [**æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶**](https://developer.apple.com/documentation/localauthentication) å’Œ [**é’¥åŒ™ä¸²**](https://developer.apple.com/library/content/documentation/Security/Conceptual/keychainServConcepts/01introduction/introduction.html) ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„ APIï¼Œä»¥ä¾¿åˆ†åˆ«ä¿ƒè¿›ç”¨æˆ·èº«ä»½éªŒè¯å¯¹è¯æ¡†å’Œå®‰å…¨å¤„ç†ç§˜å¯†æ•°æ®ã€‚å®‰å…¨éš” enclave ä¿æŠ¤ Touch ID çš„æŒ‡çº¹ IDï¼Œè€Œ Face ID åˆ™ä¾èµ–äºé¢éƒ¨è¯†åˆ«è€Œä¸å¦¥åç”Ÿç‰©è¯†åˆ«æ•°æ®ã€‚

è¦é›†æˆ Touch ID/Face IDï¼Œå¼€å‘è€…æœ‰ä¸¤ä¸ª API é€‰æ‹©ï¼š

* **`LocalAuthentication.framework`** ç”¨äºé«˜å±‚æ¬¡çš„ç”¨æˆ·èº«ä»½éªŒè¯ï¼Œè€Œä¸è®¿é—®ç”Ÿç‰©è¯†åˆ«æ•°æ®ã€‚
* **`Security.framework`** ç”¨äºä½å±‚æ¬¡çš„é’¥åŒ™ä¸²æœåŠ¡è®¿é—®ï¼Œé€šè¿‡ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯ä¿æŠ¤ç§˜å¯†æ•°æ®ã€‚å„ç§ [å¼€æºåŒ…è£…å™¨](https://www.raywenderlich.com/147308/secure-ios-user-data-keychain-touch-id) ä½¿é’¥åŒ™ä¸²è®¿é—®æ›´ç®€å•ã€‚

{% hint style="danger" %}
ç„¶è€Œï¼Œ`LocalAuthentication.framework` å’Œ `Security.framework` éƒ½å­˜åœ¨æ¼æ´ï¼Œå› ä¸ºå®ƒä»¬ä¸»è¦è¿”å›å¸ƒå°”å€¼è€Œä¸ä¼ è¾“ç”¨äºèº«ä»½éªŒè¯è¿‡ç¨‹çš„æ•°æ®ï¼Œä½¿å…¶å®¹æ˜“è¢«ç»•è¿‡ï¼ˆå‚è§ [Don't touch me that way, by David Lindner et al](https://www.youtube.com/watch?v=XhXIHVGCFFM)ï¼‰ã€‚
{% endhint %}

### å®ç°æœ¬åœ°èº«ä»½éªŒè¯

ä¸ºäº†æç¤ºç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¼€å‘è€…åº”åˆ©ç”¨ **`LAContext`** ç±»ä¸­çš„ **`evaluatePolicy`** æ–¹æ³•ï¼Œé€‰æ‹©ï¼š

* **`deviceOwnerAuthentication`**ï¼šæç¤ºè¾“å…¥ Touch ID æˆ–è®¾å¤‡å¯†ç ï¼Œå¦‚æœä¸¤è€…éƒ½æœªå¯ç”¨åˆ™å¤±è´¥ã€‚
* **`deviceOwnerAuthenticationWithBiometrics`**ï¼šä»…æç¤ºè¾“å…¥ Touch IDã€‚

æˆåŠŸçš„èº«ä»½éªŒè¯é€šè¿‡ **`evaluatePolicy`** çš„å¸ƒå°”è¿”å›å€¼æŒ‡ç¤ºï¼Œçªæ˜¾å‡ºæ½œåœ¨çš„å®‰å…¨ç¼ºé™·ã€‚

### ä½¿ç”¨é’¥åŒ™ä¸²è¿›è¡Œæœ¬åœ°èº«ä»½éªŒè¯

åœ¨ iOS åº”ç”¨ä¸­å®ç° **æœ¬åœ°èº«ä»½éªŒè¯** æ¶‰åŠä½¿ç”¨ **é’¥åŒ™ä¸² API** å®‰å…¨å­˜å‚¨ç§˜å¯†æ•°æ®ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ä»¤ç‰Œã€‚æ­¤è¿‡ç¨‹ç¡®ä¿æ•°æ®åªèƒ½ç”±ç”¨æˆ·è®¿é—®ï¼Œä½¿ç”¨ä»–ä»¬çš„è®¾å¤‡å¯†ç æˆ–ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯ï¼Œå¦‚ Touch IDã€‚

é’¥åŒ™ä¸²æä¾›äº†è®¾ç½®å¸¦æœ‰ `SecAccessControl` å±æ€§çš„é¡¹ç›®çš„èƒ½åŠ›ï¼Œè¯¥å±æ€§é™åˆ¶å¯¹è¯¥é¡¹ç›®çš„è®¿é—®ï¼Œç›´åˆ°ç”¨æˆ·é€šè¿‡ Touch ID æˆ–è®¾å¤‡å¯†ç æˆåŠŸèº«ä»½éªŒè¯ã€‚æ­¤åŠŸèƒ½å¯¹äºå¢å¼ºå®‰å…¨æ€§è‡³å…³é‡è¦ã€‚

ä»¥ä¸‹æ˜¯ Swift å’Œ Objective-C ä¸­çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¿™äº›å®‰å…¨åŠŸèƒ½å°†å­—ç¬¦ä¸²ä¿å­˜åˆ°é’¥åŒ™ä¸²å¹¶ä»ä¸­æ£€ç´¢ã€‚ç¤ºä¾‹ç‰¹åˆ«å±•ç¤ºäº†å¦‚ä½•è®¾ç½®è®¿é—®æ§åˆ¶ä»¥è¦æ±‚ Touch ID èº«ä»½éªŒè¯ï¼Œå¹¶ç¡®ä¿æ•°æ®ä»…åœ¨è®¾ç½®çš„è®¾å¤‡ä¸Šå¯è®¿é—®ï¼Œå‰ææ˜¯é…ç½®äº†è®¾å¤‡å¯†ç ã€‚

{% tabs %}
{% tab title="Swift" %}
```swift
// From https://github.com/mufambisi/owasp-mstg/blob/master/Document/0x06f-Testing-Local-Authentication.md

// 1. create AccessControl object that will represent authentication settings

var error: Unmanaged<CFError>?

guard let accessControl = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
SecAccessControlCreateFlags.biometryCurrentSet,
&error) else {
// failed to create AccessControl object

return
}

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute

var query: [String: Any] = [:]

query[kSecClass as String] = kSecClassGenericPassword
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecAttrAccount as String] = "OWASP Account" as CFString
query[kSecValueData as String] = "test_strong_password".data(using: .utf8)! as CFData
query[kSecAttrAccessControl as String] = accessControl

// 3. save item

let status = SecItemAdd(query as CFDictionary, nil)

if status == noErr {
// successfully saved
} else {
// error while saving
}
```
{% endtab %}

{% tab title="Objective-C" %}ç›®æ ‡-C{% endtab %}
```objectivec
// 1. create AccessControl object that will represent authentication settings
CFErrorRef *err = nil;

SecAccessControlRef sacRef = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
kSecAccessControlUserPresence,
err);

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute
NSDictionary* query = @{
(_ _bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecAttrAccount: @"OWASP Account",
(__bridge id)kSecValueData: [@"test_strong_password" dataUsingEncoding:NSUTF8StringEncoding],
(__bridge id)kSecAttrAccessControl: (__bridge_transfer id)sacRef
};

// 3. save item
OSStatus status = SecItemAdd((__bridge CFDictionaryRef)query, nil);

if (status == noErr) {
// successfully saved
} else {
// error while saving
}
```
{% endtab %}
{% endtabs %}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»é’¥åŒ™ä¸²è¯·æ±‚ä¿å­˜çš„é¡¹ç›®ã€‚é’¥åŒ™ä¸²æœåŠ¡å°†å‘ç”¨æˆ·æ˜¾ç¤ºèº«ä»½éªŒè¯å¯¹è¯æ¡†ï¼Œå¹¶æ ¹æ®æ˜¯å¦æä¾›äº†åˆé€‚çš„æŒ‡çº¹è¿”å›æ•°æ®æˆ–nilã€‚

{% tabs %}
{% tab title="Swift" %}
```swift
// 1. define query
var query = [String: Any]()
query[kSecClass as String] = kSecClassGenericPassword
query[kSecReturnData as String] = kCFBooleanTrue
query[kSecAttrAccount as String] = "My Name" as CFString
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecUseOperationPrompt as String] = "Please, pass authorisation to enter this area" as CFString

// 2. get item
var queryResult: AnyObject?
let status = withUnsafeMutablePointer(to: &queryResult) {
SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
}

if status == noErr {
let password = String(data: queryResult as! Data, encoding: .utf8)!
// successfully received password
} else {
// authorization not passed
}
```
{% endtab %}

{% tab title="Objective-C" %}ç›®æ ‡-C{% endtab %}
```objectivec
// 1. define query
NSDictionary *query = @{(__bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecReturnData: @YES,
(__bridge id)kSecAttrAccount: @"My Name1",
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecUseOperationPrompt: @"Please, pass authorisation to enter this area" };

// 2. get item
CFTypeRef queryResult = NULL;
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)query, &queryResult);

if (status == noErr){
NSData* resultData = ( __bridge_transfer NSData* )queryResult;
NSString* password = [[NSString alloc] initWithData:resultData encoding:NSUTF8StringEncoding];
NSLog(@"%@", password);
} else {
NSLog(@"Something went wrong");
}
```
{% endtab %}
{% endtabs %}

### æ£€æµ‹

é€šè¿‡åˆ†æåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶çš„å…±äº«åŠ¨æ€åº“åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥æ£€æµ‹åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„æ¡†æ¶ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ `otool` æ¥å®Œæˆï¼š
```bash
$ otool -L <AppName>.app/<AppName>
```
å¦‚æœåœ¨åº”ç”¨ä¸­ä½¿ç”¨äº† `LocalAuthentication.framework`ï¼Œè¾“å‡ºå°†åŒ…å«ä»¥ä¸‹ä¸¤è¡Œï¼ˆè¯·è®°ä½ï¼Œ`LocalAuthentication.framework` åœ¨åº•å±‚ä½¿ç”¨ `Security.framework`ï¼‰ï¼š
```bash
/System/Library/Frameworks/LocalAuthentication.framework/LocalAuthentication
/System/Library/Frameworks/Security.framework/Security
```
å¦‚æœä½¿ç”¨äº† `Security.framework`ï¼Œåˆ™åªä¼šæ˜¾ç¤ºç¬¬äºŒä¸ªã€‚

### æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶ç»•è¿‡

#### **Objection**

é€šè¿‡ä½äº [è¿™ä¸ª GitHub é¡µé¢](https://github.com/sensepost/objection/wiki/Understanding-the-iOS-Biometrics-Bypass) çš„ **Objection Biometrics Bypass**ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç§æŠ€æœ¯æ¥å…‹æœ **LocalAuthentication** æœºåˆ¶ã€‚è¯¥æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºåˆ©ç”¨ **Frida** æ“ä½œ `evaluatePolicy` å‡½æ•°ï¼Œç¡®ä¿å…¶å§‹ç»ˆè¿”å› `True` ç»“æœï¼Œè€Œä¸ç®¡å®é™…çš„èº«ä»½éªŒè¯æ˜¯å¦æˆåŠŸã€‚è¿™å¯¹äºç»•è¿‡æœ‰ç¼ºé™·çš„ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯è¿‡ç¨‹ç‰¹åˆ«æœ‰ç”¨ã€‚

è¦æ¿€æ´»æ­¤ç»•è¿‡ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios ui biometrics_bypass
(agent) Registering job 3mhtws9x47q. Type: ios-biometrics-disable
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # (agent) [3mhtws9x47q] Localized Reason for auth requirement: Please authenticate yourself
(agent) [3mhtws9x47q] OS authentication response: false
(agent) [3mhtws9x47q] Marking OS response as True instead
(agent) [3mhtws9x47q] Biometrics bypass hook complete
```
æ­¤å‘½ä»¤è§¦å‘ä¸€ä¸ªåºåˆ—ï¼Œå…¶ä¸­ Objection æ³¨å†Œä¸€ä¸ªä»»åŠ¡ï¼Œæœ‰æ•ˆåœ°å°† `evaluatePolicy` æ£€æŸ¥çš„ç»“æœæ›´æ”¹ä¸º `True`ã€‚

#### Frida

æ¥è‡ª [DVIA-v2 åº”ç”¨ç¨‹åº](https://github.com/prateek147/DVIA-v2) çš„ **`evaluatePolicy`** ä½¿ç”¨ç¤ºä¾‹ï¼š
```swift
+(void)authenticateWithTouchID {
LAContext *myContext = [[LAContext alloc] init];
NSError *authError = nil;
NSString *myLocalizedReasonString = @"Please authenticate yourself";

if ([myContext canEvaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics error:&authError]) {
[myContext evaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics
localizedReason:myLocalizedReasonString
reply:^(BOOL success, NSError *error) {
if (success) {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Successful" withTitle:@"Success"];
});
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Failed !" withTitle:@"Error"];
});
}
}];
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Your device doesn't support Touch ID or you haven't configured Touch ID authentication on your device" withTitle:@"Error"];
});
}
}
```
ä¸ºäº†å®ç°å¯¹æœ¬åœ°èº«ä»½éªŒè¯çš„**bypass**ï¼Œç¼–å†™äº†ä¸€ä¸ªFridaè„šæœ¬ã€‚è¯¥è„šæœ¬é’ˆå¯¹**evaluatePolicy**æ£€æŸ¥ï¼Œæ‹¦æˆªå…¶å›è°ƒä»¥ç¡®ä¿è¿”å›**success=1**ã€‚é€šè¿‡æ”¹å˜å›è°ƒçš„è¡Œä¸ºï¼Œèº«ä»½éªŒè¯æ£€æŸ¥è¢«æœ‰æ•ˆç»•è¿‡ã€‚

ä¸‹é¢çš„è„šæœ¬è¢«æ³¨å…¥ä»¥ä¿®æ”¹**evaluatePolicy**æ–¹æ³•çš„ç»“æœã€‚å®ƒå°†å›è°ƒçš„ç»“æœæ›´æ”¹ä¸ºå§‹ç»ˆæŒ‡ç¤ºæˆåŠŸã€‚
```swift
// from https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/
if(ObjC.available) {
console.log("Injecting...");
var hook = ObjC.classes.LAContext["- evaluatePolicy:localizedReason:reply:"];
Interceptor.attach(hook.implementation, {
onEnter: function(args) {
var block = new ObjC.Block(args[4]);
const callback = block.implementation;
block.implementation = function (error, value)  {

console.log("Changing the result value to true")
const result = callback(1, null);
return result;
};
},
});
} else {
console.log("Objective-C Runtime is not available!");
}
```
è¦æ³¨å…¥Fridaè„šæœ¬å¹¶ç»•è¿‡ç”Ÿç‰©è¯†åˆ«è®¤è¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
frida -U -f com.highaltitudehacks.DVIAswiftv2 --no-pause -l fingerprint-bypass-ios.js
```
## æ•æ„ŸåŠŸèƒ½é€šè¿‡ IPC æš´éœ²

### è‡ªå®šä¹‰ URI å¤„ç†ç¨‹åº / æ·±åº¦é“¾æ¥ / è‡ªå®šä¹‰æ–¹æ¡ˆ

{% content-ref url="ios-custom-uri-handlers-deeplinks-custom-schemes.md" %}
[ios-custom-uri-handlers-deeplinks-custom-schemes.md](ios-custom-uri-handlers-deeplinks-custom-schemes.md)
{% endcontent-ref %}

### é€šç”¨é“¾æ¥

{% content-ref url="ios-universal-links.md" %}
[ios-universal-links.md](ios-universal-links.md)
{% endcontent-ref %}

### UIActivity å…±äº«

{% content-ref url="ios-uiactivity-sharing.md" %}
[ios-uiactivity-sharing.md](ios-uiactivity-sharing.md)
{% endcontent-ref %}

### UIPasteboard

{% content-ref url="ios-uipasteboard.md" %}
[ios-uipasteboard.md](ios-uipasteboard.md)
{% endcontent-ref %}

### åº”ç”¨æ‰©å±•

{% content-ref url="ios-app-extensions.md" %}
[ios-app-extensions.md](ios-app-extensions.md)
{% endcontent-ref %}

### WebViews

{% content-ref url="ios-webviews.md" %}
[ios-webviews.md](ios-webviews.md)
{% endcontent-ref %}

### åºåˆ—åŒ–å’Œç¼–ç 

{% content-ref url="ios-serialisation-and-encoding.md" %}
[ios-serialisation-and-encoding.md](ios-serialisation-and-encoding.md)
{% endcontent-ref %}

## ç½‘ç»œé€šä¿¡

é‡è¦çš„æ˜¯æ£€æŸ¥æ˜¯å¦å­˜åœ¨ **æœªåŠ å¯†** çš„é€šä¿¡ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºæ˜¯å¦æ­£ç¡® **éªŒè¯æœåŠ¡å™¨çš„ TLS è¯ä¹¦**ã€‚\
è¦æ£€æŸ¥è¿™äº›é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åƒ **Burp** è¿™æ ·çš„ä»£ç†ï¼š

{% content-ref url="burp-configuration-for-ios.md" %}
[burp-configuration-for-ios.md](burp-configuration-for-ios.md)
{% endcontent-ref %}

### ä¸»æœºåæ£€æŸ¥

éªŒè¯ TLS è¯ä¹¦çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯æ£€æŸ¥è¯ä¹¦æ˜¯å¦ç”± **å—ä¿¡ä»»çš„** **CA** ç­¾åï¼Œä½† **ä¸æ£€æŸ¥** **è¯ä¹¦çš„ä¸»æœºå** æ˜¯å¦æ˜¯æ­£åœ¨è®¿é—®çš„ä¸»æœºåã€‚\
ä¸ºäº†ä½¿ç”¨ Burp æ£€æŸ¥æ­¤é—®é¢˜ï¼Œåœ¨ iPhone ä¸­ä¿¡ä»» Burp CA åï¼Œå¯ä»¥ **ä¸ºä¸åŒçš„ä¸»æœºåä½¿ç”¨ Burp åˆ›å»ºæ–°è¯ä¹¦** å¹¶ä½¿ç”¨å®ƒã€‚å¦‚æœåº”ç”¨ç¨‹åºä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆæŸäº›åœ°æ–¹æ˜¯è„†å¼±çš„ã€‚

### è¯ä¹¦é’‰æ‰

å¦‚æœåº”ç”¨ç¨‹åºæ­£ç¡®ä½¿ç”¨ SSL é’‰æ‰ï¼Œåˆ™åªæœ‰åœ¨è¯ä¹¦æ˜¯é¢„æœŸçš„è¯ä¹¦æ—¶ï¼Œåº”ç”¨ç¨‹åºæ‰ä¼šæ­£å¸¸å·¥ä½œã€‚åœ¨æµ‹è¯•åº”ç”¨ç¨‹åºæ—¶ **è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸º Burp å°†æä¾›è‡ªå·±çš„è¯ä¹¦ã€‚**\
ä¸ºäº†ç»•è¿‡è¿™ç§ä¿æŠ¤ï¼Œå¯ä»¥åœ¨è¶Šç‹±è®¾å¤‡ä¸­å®‰è£… [**SSL Kill Switch**](https://github.com/nabla-c0d3/ssl-kill-switch2) æˆ–å®‰è£… [**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/mobile/config-ios-device)

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ **objection's** `ios sslpinning disable`

## æ‚é¡¹

* åœ¨ **`/System/Library`** ä¸­å¯ä»¥æ‰¾åˆ°ç³»ç»Ÿåº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¡†æ¶
* ç”¨æˆ·ä» App Store å®‰è£…çš„åº”ç”¨ç¨‹åºä½äº **`/User/Applications`**
* **`/User/Library`** åŒ…å«ç”¨æˆ·çº§åº”ç”¨ç¨‹åºä¿å­˜çš„æ•°æ®
* æ‚¨å¯ä»¥è®¿é—® **`/User/Library/Notes/notes.sqlite`** ä»¥è¯»å–åº”ç”¨ç¨‹åºä¸­ä¿å­˜çš„ç¬”è®°ã€‚
* åœ¨å·²å®‰è£…åº”ç”¨ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸­ (**`/User/Applications/<APP ID>/`**) æ‚¨å¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰è¶£çš„æ–‡ä»¶ï¼š
* **`iTunesArtwork`**ï¼šåº”ç”¨ç¨‹åºä½¿ç”¨çš„å›¾æ ‡
* **`iTunesMetadata.plist`**ï¼šåœ¨ App Store ä¸­ä½¿ç”¨çš„åº”ç”¨ç¨‹åºä¿¡æ¯
* **`/Library/*`**ï¼šåŒ…å«é¦–é€‰é¡¹å’Œç¼“å­˜ã€‚åœ¨ **`/Library/Cache/Snapshots/*`** ä¸­å¯ä»¥æ‰¾åˆ°åœ¨å°†åº”ç”¨ç¨‹åºå‘é€åˆ°åå°ä¹‹å‰å¯¹å…¶è¿›è¡Œçš„å¿«ç…§ã€‚

### çƒ­è¡¥ä¸/å¼ºåˆ¶æ›´æ–°

å¼€å‘äººå‘˜å¯ä»¥ **ç«‹å³è¿œç¨‹ä¿®è¡¥å…¶åº”ç”¨çš„æ‰€æœ‰å®‰è£…**ï¼Œè€Œæ— éœ€é‡æ–°æäº¤åº”ç”¨ç¨‹åºåˆ° App Store å¹¶ç­‰å¾…æ‰¹å‡†ã€‚\
ä¸ºæ­¤ï¼Œé€šå¸¸ä½¿ç”¨ [**JSPatch**](https://github.com/bang590/JSPatch)**.** ä½†è¿˜æœ‰å…¶ä»–é€‰é¡¹ï¼Œå¦‚ [Siren](https://github.com/ArtSabintsev/Siren) å’Œ [react-native-appstore-version-checker](https://www.npmjs.com/package/react-native-appstore-version-checker)ã€‚\
**è¿™æ˜¯ä¸€ç§å±é™©çš„æœºåˆ¶ï¼Œå¯èƒ½è¢«æ¶æ„ç¬¬ä¸‰æ–¹ SDK æ»¥ç”¨ï¼Œå› æ­¤å»ºè®®æ£€æŸ¥ç”¨äºè‡ªåŠ¨æ›´æ–°çš„æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å¹¶è¿›è¡Œæµ‹è¯•ã€‚** æ‚¨å¯ä»¥å°è¯•ä¸‹è½½è¯¥åº”ç”¨ç¨‹åºçš„å…ˆå‰ç‰ˆæœ¬ä»¥æ­¤ç›®çš„ã€‚

### ç¬¬ä¸‰æ–¹

**ç¬¬ä¸‰æ–¹ SDK** çš„ä¸€ä¸ªé‡å¤§æŒ‘æˆ˜æ˜¯ **ç¼ºä¹å¯¹å…¶åŠŸèƒ½çš„ç»†ç²’åº¦æ§åˆ¶**ã€‚å¼€å‘äººå‘˜é¢ä¸´é€‰æ‹©ï¼šè¦ä¹ˆé›†æˆ SDK å¹¶æ¥å—å…¶æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ½œåœ¨çš„å®‰å…¨æ¼æ´å’Œéšç§é—®é¢˜ï¼Œè¦ä¹ˆå®Œå…¨æ”¾å¼ƒå…¶å¥½å¤„ã€‚é€šå¸¸ï¼Œå¼€å‘äººå‘˜æ— æ³•è‡ªè¡Œä¿®è¡¥è¿™äº› SDK ä¸­çš„æ¼æ´ã€‚æ­¤å¤–ï¼Œéšç€ SDK åœ¨ç¤¾åŒºä¸­è·å¾—ä¿¡ä»»ï¼Œæœ‰äº›å¯èƒ½å¼€å§‹åŒ…å«æ¶æ„è½¯ä»¶ã€‚

ç¬¬ä¸‰æ–¹ SDK æä¾›çš„æœåŠ¡å¯èƒ½åŒ…æ‹¬ç”¨æˆ·è¡Œä¸ºè·Ÿè¸ªã€å¹¿å‘Šå±•ç¤ºæˆ–ç”¨æˆ·ä½“éªŒå¢å¼ºã€‚ç„¶è€Œï¼Œè¿™å¸¦æ¥äº†é£é™©ï¼Œå› ä¸ºå¼€å‘äººå‘˜å¯èƒ½å¹¶ä¸å®Œå…¨äº†è§£è¿™äº›åº“æ‰§è¡Œçš„ä»£ç ï¼Œä»è€Œå¯¼è‡´æ½œåœ¨çš„éšç§å’Œå®‰å…¨é£é™©ã€‚é™åˆ¶ä¸ç¬¬ä¸‰æ–¹æœåŠ¡å…±äº«çš„ä¿¡æ¯ä»…é™äºå¿…è¦çš„ä¿¡æ¯ï¼Œå¹¶ç¡®ä¿æ²¡æœ‰æ•æ„Ÿæ•°æ®è¢«æš´éœ²æ˜¯è‡³å…³é‡è¦çš„ã€‚

ç¬¬ä¸‰æ–¹æœåŠ¡çš„å®ç°é€šå¸¸æœ‰ä¸¤ç§å½¢å¼ï¼šç‹¬ç«‹åº“æˆ–å®Œæ•´ SDKã€‚ä¸ºäº†ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œä¸è¿™äº›æœåŠ¡å…±äº«çš„ä»»ä½•æ•°æ®éƒ½åº” **åŒ¿ååŒ–** ä»¥é˜²æ­¢æ³„éœ²ä¸ªäººå¯è¯†åˆ«ä¿¡æ¯ï¼ˆPIIï¼‰ã€‚

è¦è¯†åˆ«åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“ï¼Œå¯ä»¥ä½¿ç”¨ **`otool`** å‘½ä»¤ã€‚æ­¤å·¥å…·åº”é’ˆå¯¹åº”ç”¨ç¨‹åºåŠå…¶ä½¿ç”¨çš„æ¯ä¸ªå…±äº«åº“è¿è¡Œï¼Œä»¥å‘ç°å…¶ä»–åº“ã€‚
```bash
otool -L <application_path>
```
## **å‚è€ƒèµ„æ–™ä¸æ›´å¤šèµ„æº**

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering)
* [iOS & ç§»åŠ¨åº”ç”¨ Pentesting - INE](https://my.ine.com/CyberSecurity/courses/089d060b/ios-mobile-app-pentesting)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0057/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0057/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0058/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0058/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0059/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0059/)
* [https://mas.owasp.org/MASTG/iOS/0x06d-Testing-Data-Storage](https://mas.owasp.org/MASTG/iOS/0x06d-Testing-Data-Storage)
* [https://coderwall.com/p/kjb3lw/storing-password-in-keychain-the-smart-way](https://coderwall.com/p/kjb3lw/storing-password-in-keychain-the-smart-way)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0055/](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0055/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0053](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0053)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0060/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0060/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0058](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0058)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0060](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0060)
* [https://mas.owasp.org/MASTG/Android/0x05f-Testing-Local-Authentication/](https://mas.owasp.org/MASTG/Android/0x05f-Testing-Local-Authentication/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-AUTH/MASTG-TEST-0064](https://mas.owasp.org/MASTG/tests/ios/MASVS-AUTH/MASTG-TEST-0064)
* [https://medium.com/securing/bypassing-your-apps-biometric-checks-on-ios-c2555c81a2dc](https://medium.com/securing/bypassing-your-apps-biometric-checks-on-ios-c2555c81a2dc)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0054](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0054)
* [https://github.com/ivRodriguezCA/RE-iOS-Apps/](https://github.com/ivRodriguezCA/RE-iOS-Apps/) iOS å…è´¹è¯¾ç¨‹([https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/](https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/))
* [https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577](https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577)
* [https://www.slideshare.net/RyanISI/ios-appsecurityminicourse](https://www.slideshare.net/RyanISI/ios-appsecurityminicourse)
* [https://github.com/prateek147/DVIA](https://github.com/prateek147/DVIA)
* [https://github.com/prateek147/DVIA-v2](https://github.com/prateek147/DVIA-v2)
* [https://github.com/OWASP/MSTG-Hacking-Playground%20](https://github.com/OWASP/MSTG-Hacking-Playground)
* OWASP iGoat [_https://github.com/OWASP/igoat_](https://github.com/OWASP/igoat) <<< Objective-C ç‰ˆæœ¬ [_https://github.com/OWASP/iGoat-Swift_](https://github.com/OWASP/iGoat-Swift) <<< Swift ç‰ˆæœ¬
* [https://github.com/authenticationfailure/WheresMyBrowser.iOS](https://github.com/authenticationfailure/WheresMyBrowser.iOS)
* [https://github.com/nabla-c0d3/ssl-kill-switch2](https://github.com/nabla-c0d3/ssl-kill-switch2)

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=ios-pentesting) è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=ios-pentesting" %}
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hackingï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP Hackingï¼š <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
</details>
{% endhint %}
