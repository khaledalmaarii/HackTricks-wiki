# iOSæ¸—é€æµ‹è¯•

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)æ¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## iOSåŸºç¡€çŸ¥è¯†

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

## æµ‹è¯•ç¯å¢ƒ

åœ¨æ­¤é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å…³äº**iOSæ¨¡æ‹Ÿå™¨**ã€**æ¨¡æ‹Ÿå™¨**å’Œ**è¶Šç‹±**çš„ä¿¡æ¯ï¼š

{% content-ref url="ios-testing-environment.md" %}
[ios-testing-environment.md](ios-testing-environment.md)
{% endcontent-ref %}

## åˆå§‹åˆ†æ

### åŸºæœ¬iOSæµ‹è¯•æ“ä½œ

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä¼šå»ºè®®æ‰§è¡Œ**å¤šä¸ªæ“ä½œ**ï¼ˆè¿æ¥åˆ°è®¾å¤‡ã€è¯»å–/å†™å…¥/ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶ã€ä½¿ç”¨ä¸€äº›å·¥å…·...ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•æ‰§è¡Œè¿™äº›æ“ä½œï¼Œè¯·**å¼€å§‹é˜…è¯»é¡µé¢**ï¼š

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

{% hint style="info" %}
åœ¨ä»¥ä¸‹æ­¥éª¤ä¸­ï¼Œåº”åœ¨è®¾å¤‡ä¸Š**å®‰è£…åº”ç”¨ç¨‹åº**å¹¶å·²è·å–åº”ç”¨ç¨‹åºçš„**IPAæ–‡ä»¶**ã€‚\
é˜…è¯»[åŸºæœ¬iOSæµ‹è¯•æ“ä½œ](basic-ios-testing-operations.md)é¡µé¢ä»¥äº†è§£å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚
{% endhint %}

### åŸºæœ¬é™æ€åˆ†æ

å»ºè®®ä½¿ç”¨å·¥å…·[**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF)å¯¹IPAæ–‡ä»¶æ‰§è¡Œè‡ªåŠ¨é™æ€åˆ†æã€‚

è¯†åˆ«äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å­˜åœ¨çš„**ä¿æŠ¤æªæ–½**ï¼š

*   **PIEï¼ˆä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼‰**ï¼šå¯ç”¨åï¼Œåº”ç”¨ç¨‹åºæ¯æ¬¡å¯åŠ¨æ—¶éƒ½ä¼šåŠ è½½åˆ°éšæœºå†…å­˜åœ°å€ï¼Œä½¿å¾—éš¾ä»¥é¢„æµ‹å…¶åˆå§‹å†…å­˜åœ°å€ã€‚

```bash
otool -hv <app-binary> | grep PIE   # åº”åŒ…å«PIEæ ‡å¿—
```
*   **å †æ ˆCanaries**ï¼šä¸ºäº†éªŒè¯å †æ ˆçš„å®Œæ•´æ€§ï¼Œåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰åœ¨å †æ ˆä¸Šæ”¾ç½®ä¸€ä¸ªâ€œcanaryâ€å€¼ï¼Œå¹¶åœ¨å‡½æ•°ç»“æŸæ—¶å†æ¬¡éªŒè¯ã€‚

```bash
otool -I -v <app-binary> | grep stack_chk   # åº”åŒ…å«ç¬¦å·ï¼šstack_chk_guardå’Œstack_chk_fail
```
*   **ARCï¼ˆè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼‰**ï¼šé˜²æ­¢å¸¸è§çš„å†…å­˜æŸåç¼ºé™·

```bash
otool -I -v <app-binary> | grep objc_release   # åº”åŒ…å«_objc_releaseç¬¦å·
```
*   **åŠ å¯†äºŒè¿›åˆ¶æ–‡ä»¶**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶åº”è¯¥æ˜¯åŠ å¯†çš„

```bash
otool -arch all -Vl <app-binary> | grep -A5 LC_ENCRYPT   # cryptidåº”ä¸º1
```

**è¯†åˆ«æ•æ„Ÿ/ä¸å®‰å…¨å‡½æ•°**

*   **å¼±å“ˆå¸Œç®—æ³•**

```bash
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_CC_MD5"
otool -Iv <app> | grep -w "_CC_SHA1"

# åœ¨Linuxä¸Š
grep -iER "_CC_MD5"
grep -iER "_CC_SHA1"
```
*   **ä¸å®‰å…¨çš„éšæœºå‡½æ•°**

```bash
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_random"
otool -Iv <app> | grep -w "_srand"
otool -Iv <app> | grep -w "_rand"

# åœ¨Linuxä¸Š
grep -iER "_random"
grep -iER "_srand"
grep -iER "_rand"
```
*   **ä¸å®‰å…¨çš„â€˜Mallocâ€™å‡½æ•°**

```bash
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_malloc"

# åœ¨Linuxä¸Š
grep -iER "_malloc"
```
*   **ä¸å®‰å…¨å’Œæ˜“å—æ”»å‡»çš„å‡½æ•°**

```bash
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_gets"
otool -Iv <app> | grep -w "_memcpy"
otool -Iv <app> | grep -w "_strncpy"
otool -Iv <app> | grep -w "_strlen"
otool -Iv <app> | grep -w "_vsnprintf"
otool -Iv <app> | grep -w "_sscanf"
otool -Iv <app> | grep -w "_strtok"
otool -Iv <app> | grep -w "_alloca"
otool -Iv <app> | grep -w "_sprintf"
otool -Iv <app> | grep -w "_printf"
otool -Iv <app> | grep -w "_vsprintf"

# åœ¨Linuxä¸Š
grep -R "_gets"
grep -iER "_memcpy"
grep -iER "_strncpy"
grep -iER "_strlen"
grep -iER "_vsnprintf"
grep -iER "_sscanf"
grep -iER "_strtok"
grep -iER "_alloca"
grep -iER "_sprintf"
grep -iER "_printf"
grep -iER "_vsprintf"
```

### åŸºæœ¬åŠ¨æ€åˆ†æ

æŸ¥çœ‹[**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF)æ‰§è¡Œçš„åŠ¨æ€åˆ†æã€‚æ‚¨éœ€è¦æµè§ˆä¸åŒè§†å›¾å¹¶ä¸å…¶äº¤äº’ï¼Œä½†å®ƒå°†æŒ‚æ¥å¤šä¸ªç±»å¹¶æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¹¶åœ¨å®Œæˆåå‡†å¤‡æŠ¥å‘Šã€‚

### åˆ—å‡ºå·²å®‰è£…çš„åº”ç”¨ç¨‹åº

ä½¿ç”¨å‘½ä»¤`frida-ps -Uai`æ¥ç¡®å®šå·²å®‰è£…åº”ç”¨ç¨‹åºçš„**æ†ç»‘æ ‡è¯†ç¬¦**ï¼š
```bash
$ frida-ps -Uai
PID  Name                 Identifier
----  -------------------  -----------------------------------------
6847  Calendar             com.apple.mobilecal
6815  Mail                 com.apple.mobilemail
-  App Store            com.apple.AppStore
-  Apple Store          com.apple.store.Jolly
-  Calculator           com.apple.calculator
-  Camera               com.apple.camera
-  iGoat-Swift          OWASP.iGoat-Swift
```
### åŸºæœ¬æšä¸¾ & Hooking

å­¦ä¹ å¦‚ä½•**æšä¸¾åº”ç”¨ç¨‹åºçš„ç»„ä»¶**ä»¥åŠå¦‚ä½•ä½¿ç”¨ objection è½»æ¾**hookæ–¹æ³•å’Œç±»**ï¼š

{% content-ref url="ios-hooking-with-objection.md" %}
[ios-hooking-with-objection.md](ios-hooking-with-objection.md)
{% endcontent-ref %}

### IPA ç»“æ„

**IPA æ–‡ä»¶**çš„ç»“æ„æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**å‹ç¼©åŒ…**ã€‚é€šè¿‡å°†å…¶æ‰©å±•åæ›´æ”¹ä¸º`.zip`ï¼Œå¯ä»¥**è§£å‹**ä»¥æ˜¾ç¤ºå…¶å†…å®¹ã€‚åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œ**Bundle**ä»£è¡¨ä¸€ä¸ªå®Œå…¨æ‰“åŒ…å¥½å¾…å®‰è£…çš„åº”ç”¨ç¨‹åºã€‚åœ¨å…¶ä¸­ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªåä¸º`<NAME>.app`çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºçš„èµ„æºã€‚

* **`Info.plist`**ï¼šæ­¤æ–‡ä»¶ä¿å­˜åº”ç”¨ç¨‹åºçš„ç‰¹å®šé…ç½®è¯¦ç»†ä¿¡æ¯ã€‚
* **`_CodeSignature/`**ï¼šæ­¤ç›®å½•åŒ…å«ä¸€ä¸ªåŒ…å«ç­¾åçš„ plist æ–‡ä»¶ï¼Œç¡®ä¿æ†ç»‘åŒ…ä¸­æ‰€æœ‰æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚
* **`Assets.car`**ï¼šå­˜å‚¨åƒå›¾æ ‡è¿™æ ·çš„èµ„æºæ–‡ä»¶çš„å‹ç¼©å­˜æ¡£ã€‚
* **`Frameworks/`**ï¼šæ­¤æ–‡ä»¶å¤¹åŒ…å«åº”ç”¨ç¨‹åºçš„æœ¬æœºåº“ï¼Œå¯èƒ½æ˜¯`.dylib`æˆ–`.framework`æ–‡ä»¶çš„å½¢å¼ã€‚
* **`PlugIns/`**ï¼šè¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºçš„æ‰©å±•ï¼Œç§°ä¸º`.appex`æ–‡ä»¶ï¼Œå°½ç®¡å®ƒä»¬å¹¶ä¸æ€»æ˜¯å­˜åœ¨ã€‚
* [**`Core Data`**](https://developer.apple.com/documentation/coredata)ï¼šç”¨äºä¿å­˜åº”ç”¨ç¨‹åºçš„æ°¸ä¹…æ•°æ®ä»¥ä¾›ç¦»çº¿ä½¿ç”¨ï¼Œç¼“å­˜ä¸´æ—¶æ•°æ®ï¼Œå¹¶åœ¨å•ä¸ªè®¾å¤‡ä¸Šä¸ºåº”ç”¨ç¨‹åºæ·»åŠ æ’¤æ¶ˆåŠŸèƒ½ã€‚ä¸ºäº†åœ¨å•ä¸ª iCloud å¸æˆ·ä¸­è·¨å¤šä¸ªè®¾å¤‡åŒæ­¥æ•°æ®ï¼ŒCore Data ä¼šè‡ªåŠ¨å°†æ‚¨çš„æ¨¡å¼é•œåƒåˆ° CloudKit å®¹å™¨ä¸­ã€‚
* [**`PkgInfo`**](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/ConfigApplications.html)ï¼š`PkgInfo` æ–‡ä»¶æ˜¯æŒ‡å®šåº”ç”¨ç¨‹åºæˆ–æ†ç»‘åŒ…çš„ç±»å‹å’Œåˆ›å»ºè€…ä»£ç çš„å¦ä¸€ç§æ–¹å¼ã€‚
* **en.lproj, fr.proj, Base.lproj**ï¼šæ˜¯åŒ…å«è¿™äº›ç‰¹å®šè¯­è¨€èµ„æºçš„è¯­è¨€åŒ…ï¼Œä»¥åŠåœ¨ä¸æ”¯æŒæŸç§è¯­è¨€æ—¶çš„é»˜è®¤èµ„æºã€‚
* **å®‰å…¨æ€§**ï¼š`_CodeSignature/` ç›®å½•é€šè¿‡æ•°å­—ç­¾åéªŒè¯æ‰€æœ‰æ†ç»‘æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§æ–¹é¢èµ·ç€å…³é”®ä½œç”¨ã€‚
* **èµ„äº§ç®¡ç†**ï¼š`Assets.car` æ–‡ä»¶ä½¿ç”¨å‹ç¼©æ¥é«˜æ•ˆç®¡ç†å›¾å½¢èµ„äº§ï¼Œè¿™å¯¹äºä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½å¹¶å‡å°å…¶æ•´ä½“å¤§å°è‡³å…³é‡è¦ã€‚
* **æ¡†æ¶å’Œæ’ä»¶**ï¼šè¿™äº›ç›®å½•çªæ˜¾äº† iOS åº”ç”¨ç¨‹åºçš„æ¨¡å—åŒ–ï¼Œå…è®¸å¼€å‘äººå‘˜åŒ…å«å¯é‡ç”¨çš„ä»£ç åº“ï¼ˆ`Frameworks/`ï¼‰å¹¶æ‰©å±•åº”ç”¨åŠŸèƒ½ï¼ˆ`PlugIns/`ï¼‰ã€‚
* **æœ¬åœ°åŒ–**ï¼šè¯¥ç»“æ„æ”¯æŒå¤šç§è¯­è¨€ï¼Œé€šè¿‡ä¸ºç‰¹å®šè¯­è¨€åŒ…å«èµ„æºæ¥ä¿ƒè¿›å…¨çƒåº”ç”¨ç¨‹åºçš„è¦†ç›–èŒƒå›´ã€‚

**Info.plist**

**Info.plist** æ˜¯ iOS åº”ç”¨ç¨‹åºçš„åŸºçŸ³ï¼Œä»¥**é”®-å€¼**å¯¹çš„å½¢å¼å°è£…å…³é”®é…ç½®æ•°æ®ã€‚è¿™ä¸ªæ–‡ä»¶ä¸ä»…å¯¹åº”ç”¨ç¨‹åºæ˜¯å¿…éœ€çš„ï¼Œå¯¹äºæ‰“åŒ…åœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºæ‰©å±•å’Œæ¡†æ¶ä¹Ÿæ˜¯å¿…éœ€çš„ã€‚å®ƒä»¥ XML æˆ–äºŒè¿›åˆ¶æ ¼å¼ç»“æ„åŒ–ï¼Œå¹¶åŒ…å«ä»åº”ç”¨æƒé™åˆ°å®‰å…¨é…ç½®ç­‰å…³é”®ä¿¡æ¯ã€‚è¦è¯¦ç»†æ¢ç´¢å¯ç”¨é”®ï¼Œå¯ä»¥å‚è€ƒ[**Apple Developer Documentation**](https://developer.apple.com/documentation/bundleresources/information\_property\_list?language=objc)ã€‚

å¯¹äºå¸Œæœ›ä»¥æ›´æ˜“è®¿é—®çš„æ ¼å¼å¤„ç†æ­¤æ–‡ä»¶çš„äººï¼Œå¯ä»¥é€šè¿‡ macOS ä¸Šçš„ `plutil`ï¼ˆåœ¨ç‰ˆæœ¬ 10.2 åŠæ›´é«˜ç‰ˆæœ¬ä¸­æœ¬åœ°å¯ç”¨ï¼‰æˆ– Linux ä¸Šçš„ `plistutil` è½»æ¾å®ç° XML è½¬æ¢ã€‚è½¬æ¢å‘½ä»¤å¦‚ä¸‹ï¼š

* **å¯¹äº macOS**ï¼š
```bash
$ plutil -convert xml1 Info.plist
```
* **å¯¹äºLinuxç³»ç»Ÿ**ï¼š
```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```
åœ¨**Info.plist**æ–‡ä»¶å¯èƒ½æ³„éœ²çš„å¤§é‡ä¿¡æ¯ä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ¡ç›®åŒ…æ‹¬åº”ç”¨ç¨‹åºæƒé™å­—ç¬¦ä¸²ï¼ˆ`UsageDescription`ï¼‰ã€è‡ªå®šä¹‰URL schemesï¼ˆ`CFBundleURLTypes`ï¼‰ä»¥åŠApp Transport Securityçš„é…ç½®ï¼ˆ`NSAppTransportSecurity`ï¼‰ã€‚è¿™äº›æ¡ç›®ä»¥åŠå…¶ä»–æ¡ç›®ï¼Œå¦‚å¯¼å‡º/å¯¼å…¥çš„è‡ªå®šä¹‰æ–‡æ¡£ç±»å‹ï¼ˆ`UTExportedTypeDeclarations` / `UTImportedTypeDeclarations`ï¼‰ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶æˆ–ä½¿ç”¨ç®€å•çš„`grep`å‘½ä»¤è½»æ¾å®šä½ï¼š
```bash
$ grep -i <keyword> Info.plist
```
**æ•°æ®è·¯å¾„**

åœ¨iOSç¯å¢ƒä¸­ï¼Œç›®å½•ä¸“é—¨ç”¨äº**ç³»ç»Ÿåº”ç”¨**å’Œ**ç”¨æˆ·å®‰è£…çš„åº”ç”¨**ã€‚ç³»ç»Ÿåº”ç”¨ä½äº`/Applications`ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·å®‰è£…çš„åº”ç”¨åˆ™æ”¾ç½®åœ¨`/var/mobile/containers/Data/Application/`ç›®å½•ä¸‹ã€‚è¿™äº›åº”ç”¨è¢«åˆ†é…ä¸€ä¸ªç§°ä¸º**128ä½UUID**çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”±äºç›®å½•åç§°çš„éšæœºæ€§ï¼Œæ‰‹åŠ¨å®šä½åº”ç”¨æ–‡ä»¶å¤¹çš„ä»»åŠ¡å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚

{% hint style="warning" %}
ç”±äºiOSä¸­çš„åº”ç”¨å¿…é¡»è¿›è¡Œæ²™ç®±åŒ–ï¼Œæ¯ä¸ªåº”ç”¨è¿˜å°†åœ¨**`$HOME/Library/Containers`**ç›®å½•ä¸‹æ‹¥æœ‰ä¸€ä¸ªä»¥åº”ç”¨çš„**`CFBundleIdentifier`**å‘½åçš„æ–‡ä»¶å¤¹ã€‚

ç„¶è€Œï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼ˆæ•°æ®å’Œå®¹å™¨æ–‡ä»¶å¤¹ï¼‰éƒ½æœ‰ä¸€ä¸ªåä¸º**`.com.apple.mobile_container_manager.metadata.plist`**çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨é”®`MCMetadataIdentifier`ä¸­é“¾æ¥äº†è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚
{% endhint %}

ä¸ºäº†æ–¹ä¾¿å‘ç°ç”¨æˆ·å®‰è£…çš„åº”ç”¨çš„å®‰è£…ç›®å½•ï¼Œ**objectionå·¥å…·**æä¾›äº†ä¸€ä¸ªæœ‰ç”¨çš„å‘½ä»¤`env`ã€‚è¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºæœ‰å…³æ‰€è®¨è®ºåº”ç”¨çš„è¯¦ç»†ç›®å½•ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå‘½ä»¤çš„ç¤ºä¾‹ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # env

Name               Path
-----------------  -------------------------------------------------------------------------------------------
BundlePath         /var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app
CachesDirectory    /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library/Caches
DocumentDirectory  /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Documents
LibraryDirectory   /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library
```
æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨`find`å‘½ä»¤åœ¨`/private/var/containers`ä¸­æœç´¢åº”ç”¨ç¨‹åºåç§°ï¼š
```bash
find /private/var/containers -name "Progname*"
```
å‘½ä»¤è¯¸å¦‚ `ps` å’Œ `lsof` ä¹Ÿå¯ç”¨äºè¯†åˆ«åº”ç”¨ç¨‹åºçš„è¿›ç¨‹å¹¶åˆ†åˆ«åˆ—å‡ºæ‰“å¼€çš„æ–‡ä»¶ï¼Œä»è€Œæä¾›æœ‰å…³åº”ç”¨ç¨‹åºæ´»åŠ¨ç›®å½•è·¯å¾„çš„è§è§£ï¼š
```bash
ps -ef | grep -i <app-name>
lsof -p <pid> | grep -i "/containers" | head -n 1
```
**Bundle directory:**

* **AppName.app**
* è¿™æ˜¯åº”ç”¨ç¨‹åºåŒ…ï¼Œä¸IPAä¸­çœ‹åˆ°çš„ä¸€æ ·ï¼Œå…¶ä¸­åŒ…å«åŸºæœ¬åº”ç”¨ç¨‹åºæ•°æ®ã€é™æ€å†…å®¹ä»¥åŠåº”ç”¨ç¨‹åºçš„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
* æ­¤ç›®å½•å¯¹ç”¨æˆ·å¯è§ï¼Œä½†**ç”¨æˆ·æ— æ³•å¯¹å…¶è¿›è¡Œå†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸ä¼šè¢«å¤‡ä»½**ã€‚
* æ­¤æ–‡ä»¶å¤¹çš„å†…å®¹ç”¨äº**éªŒè¯ä»£ç ç­¾å**ã€‚

**Data directory:**

* **Documents/**
* åŒ…å«æ‰€æœ‰ç”¨æˆ·ç”Ÿæˆçš„æ•°æ®ã€‚åº”ç”¨ç¨‹åºæœ€ç»ˆç”¨æˆ·å¯åŠ¨åˆ›å»ºè¿™äº›æ•°æ®ã€‚
* å¯¹ç”¨æˆ·å¯è§ï¼Œ**ç”¨æˆ·å¯ä»¥å¯¹å…¶è¿›è¡Œå†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**å·²å¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½®`NSURLIsExcludedFromBackupKey`æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/**
* åŒ…å«æ‰€æœ‰**éç‰¹å®šäºç”¨æˆ·**çš„æ–‡ä»¶ï¼Œå¦‚**ç¼“å­˜**ã€**é¦–é€‰é¡¹**ã€**cookies**å’Œå±æ€§åˆ—è¡¨ï¼ˆplistï¼‰é…ç½®æ–‡ä»¶ã€‚
* iOSåº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨`Application Support`å’Œ`Caches`å­ç›®å½•ï¼Œä½†åº”ç”¨ç¨‹åºå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å­ç›®å½•ã€‚
* **Library/Caches/**
* åŒ…å«**åŠæŒä¹…æ€§ç¼“å­˜æ–‡ä»¶**ã€‚
* å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œ**ç”¨æˆ·æ— æ³•å¯¹å…¶è¿›è¡Œå†™å…¥**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸ä¼šè¢«å¤‡ä»½**ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚
* **Library/Application Support/**
* åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„**æŒä¹…æ€§æ–‡ä»¶**ã€‚
* å¯¹ç”¨æˆ·**ä¸å¯è§**ï¼Œç”¨æˆ·æ— æ³•å¯¹å…¶è¿›è¡Œå†™å…¥ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**å·²å¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½®`NSURLIsExcludedFromBackupKey`æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/Preferences/**
* ç”¨äºå­˜å‚¨å±æ€§ï¼Œè¿™äº›å±æ€§å¯ä»¥åœ¨åº”ç”¨ç¨‹åºé‡æ–°å¯åŠ¨å**æŒä¹…å­˜åœ¨**ã€‚
* ä¿¡æ¯ä»¥æœªåŠ å¯†çš„æ–¹å¼ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç®±ä¸­çš„åä¸º\[BUNDLE\_ID].plistçš„plistæ–‡ä»¶ä¸­ã€‚
* ä½¿ç”¨`NSUserDefaults`å­˜å‚¨çš„æ‰€æœ‰é”®/å€¼å¯¹éƒ½å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚
* **tmp/**
* ä½¿ç”¨æ­¤ç›®å½•æ¥å†™å…¥**ä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä¹‹é—´æŒä¹…å­˜åœ¨**çš„**ä¸´æ—¶æ–‡ä»¶**ã€‚
* åŒ…å«éæŒä¹…æ€§ç¼“å­˜æ–‡ä»¶ã€‚
* å¯¹ç”¨æˆ·ä¸å¯è§ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹ä¸ä¼šè¢«å¤‡ä»½ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚

è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°æŸ¥çœ‹iGoat-Swiftçš„åº”ç”¨ç¨‹åºåŒ…(.app)ç›®å½•ï¼Œä½äºBundleç›®å½•å†…(`/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app`)ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # ls
NSFileType      Perms  NSFileProtection    ...  Name
------------  -------  ------------------  ...  --------------------------------------
Regular           420  None                ...  rutger.html
Regular           420  None                ...  mansi.html
Regular           420  None                ...  splash.html
Regular           420  None                ...  about.html

Regular           420  None                ...  LICENSE.txt
Regular           420  None                ...  Sentinel.txt
Regular           420  None                ...  README.txt
```
### äºŒè¿›åˆ¶åå‘

åœ¨ `<application-name>.app` æ–‡ä»¶å¤¹ä¸­ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªåä¸º `<application-name>` çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™æ˜¯å°†è¢«**æ‰§è¡Œ**çš„æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…· **`otool`** å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒåŸºæœ¬æ£€æŸ¥ï¼š
```bash
otool -Vh DVIA-v2 #Check some compilation attributes
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64    ARM64        ALL  0x00     EXECUTE    65       7112   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE

otool -L DVIA-v2 #Get third party libraries
DVIA-v2:
/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.1)
/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 274.6.0)
/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)
@rpath/Bolts.framework/Bolts (compatibility version 1.0.0, current version 1.0.0)
[...]
```
**æ£€æŸ¥åº”ç”¨æ˜¯å¦å·²åŠ å¯†**

æŸ¥çœ‹æ˜¯å¦æœ‰ä»¥ä¸‹è¾“å‡ºï¼š
```bash
otool -l <app-binary> | grep -A 4 LC_ENCRYPTION_INFO
```
**åæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶**

åæ±‡ç¼–æ–‡æœ¬éƒ¨åˆ†ï¼š
```bash
otool -tV DVIA-v2
DVIA-v2:
(__TEXT,__text) section
+[DDLog initialize]:
0000000100004ab8    sub    sp, sp, #0x60
0000000100004abc    stp    x29, x30, [sp, #0x50]   ; Latency: 6
0000000100004ac0    add    x29, sp, #0x50
0000000100004ac4    sub    x8, x29, #0x10
0000000100004ac8    mov    x9, #0x0
0000000100004acc    adrp    x10, 1098 ; 0x10044e000
0000000100004ad0    add    x10, x10, #0x268
```
è¦æ‰“å°ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„**Objective-Cæ®µ**ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
```bash
otool -oV DVIA-v2
DVIA-v2:
Contents of (__DATA,__objc_classlist) section
00000001003dd5b8 0x1004423d0 _OBJC_CLASS_$_DDLog
isa        0x1004423a8 _OBJC_METACLASS_$_DDLog
superclass 0x0 _OBJC_CLASS_$_NSObject
cache      0x0 __objc_empty_cache
vtable     0x0
data       0x1003de748
flags          0x80
instanceStart  8
```
ä¸ºäº†è·å¾—æ›´ç´§å‡‘çš„ Objective-C ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [**class-dump**](http://stevenygard.com/projects/class-dump/) å·¥å…·ï¼š
```bash
class-dump some-app
//
//     Generated by class-dump 3.5 (64 bit).
//
//     class-dump is Copyright (C) 1997-1998, 2000-2001, 2004-2013 by Steve Nygard.
//

#pragma mark Named Structures

struct CGPoint {
double _field1;
double _field2;
};

struct CGRect {
struct CGPoint _field1;
struct CGSize _field2;
};

struct CGSize {
double _field1;
double _field2;
};
```
ç„¶è€Œï¼Œåæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶çš„æœ€ä½³é€‰é¡¹æ˜¯ï¼š[**Hopper**](https://www.hopperapp.com/download.html?) å’Œ [**IDA**](https://www.hex-rays.com/products/ida/support/download_freeware/)ã€‚

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) æ¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œåˆ©ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## æ•°æ®å­˜å‚¨

è¦äº†è§£ iOS å¦‚ä½•åœ¨è®¾å¤‡ä¸­å­˜å‚¨æ•°æ®ï¼Œè¯·é˜…è¯»æ­¤é¡µé¢ï¼š

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

{% hint style="warning" %}
åº”è¯¥åœ¨**å®‰è£…åº”ç”¨ç¨‹åºå**ç«‹å³æ£€æŸ¥ä»¥ä¸‹å­˜å‚¨ä¿¡æ¯çš„ä½ç½®ï¼Œ**åœ¨æ£€æŸ¥åº”ç”¨ç¨‹åºçš„æ‰€æœ‰åŠŸèƒ½å**ï¼Œç”šè‡³åœ¨**ä»ä¸€ä¸ªç”¨æˆ·æ³¨é”€å¹¶ç™»å½•åˆ°å¦ä¸€ä¸ªç”¨æˆ·å**ã€‚\
ç›®æ ‡æ˜¯æŸ¥æ‰¾åº”ç”¨ç¨‹åºï¼ˆå¯†ç ã€ä»¤ç‰Œï¼‰ã€å½“å‰ç”¨æˆ·å’Œå…ˆå‰ç™»å½•ç”¨æˆ·çš„**æœªå—ä¿æŠ¤çš„æ•æ„Ÿä¿¡æ¯**ã€‚
{% endhint %}

### Plist

**plist** æ–‡ä»¶æ˜¯ç»“æ„åŒ–çš„ XML æ–‡ä»¶ï¼Œ**åŒ…å«é”®å€¼å¯¹**ã€‚è¿™æ˜¯ä¸€ç§å­˜å‚¨æŒä¹…æ•°æ®çš„æ–¹å¼ï¼Œå› æ­¤æœ‰æ—¶æ‚¨å¯èƒ½ä¼šåœ¨è¿™äº›æ–‡ä»¶ä¸­æ‰¾åˆ°**æ•æ„Ÿä¿¡æ¯**ã€‚å»ºè®®åœ¨å®‰è£…åº”ç”¨ç¨‹åºåå’Œåœ¨å¤§é‡ä½¿ç”¨åº”ç”¨ç¨‹åºåæ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦å†™å…¥äº†æ–°æ•°æ®ã€‚

åœ¨ plist æ–‡ä»¶ä¸­æŒä¹…ä¿å­˜æ•°æ®çš„æœ€å¸¸è§æ–¹å¼æ˜¯é€šè¿‡ä½¿ç”¨ **NSUserDefaults**ã€‚æ­¤ plist æ–‡ä»¶ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç›’ä¸­çš„ **`Library/Preferences/<appBundleID>.plist`**

[`NSUserDefaults`](https://developer.apple.com/documentation/foundation/nsuserdefaults) ç±»æä¾›äº†ä¸é»˜è®¤ç³»ç»Ÿäº¤äº’çš„ç¼–ç¨‹æ¥å£ã€‚é»˜è®¤ç³»ç»Ÿå…è®¸åº”ç”¨ç¨‹åºæ ¹æ®**ç”¨æˆ·åå¥½**è‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚ç”± `NSUserDefaults` ä¿å­˜çš„æ•°æ®å¯ä»¥åœ¨åº”ç”¨ç¨‹åºåŒ…ä¸­æŸ¥çœ‹ã€‚æ­¤ç±»å°†**æ•°æ®**å­˜å‚¨åœ¨ **plist** **æ–‡ä»¶**ä¸­ï¼Œä½†åº”è¯¥ç”¨äºå°‘é‡æ•°æ®ã€‚

è¿™äº›æ•°æ®æ— æ³•ç›´æ¥é€šè¿‡å—ä¿¡ä»»çš„è®¡ç®—æœºè®¿é—®ï¼Œä½†å¯ä»¥é€šè¿‡**å¤‡ä»½**è®¿é—®ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ objection çš„ `ios nsuserdefaults get` æ¥**è½¬å‚¨**ä½¿ç”¨ **`NSUserDefaults`** ä¿å­˜çš„ä¿¡æ¯ã€‚

è¦æŸ¥æ‰¾åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰ plistï¼Œå¯ä»¥è®¿é—® `/private/var/mobile/Containers/Data/Application/{APPID}` å¹¶è¿è¡Œï¼š
```bash
find ./ -name "*.plist"
```
è¦å°†æ–‡ä»¶ä»**XMLæˆ–äºŒè¿›åˆ¶ï¼ˆbplistï¼‰**æ ¼å¼è½¬æ¢ä¸ºXMLï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„æ“ä½œç³»ç»Ÿä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼š

**å¯¹äº macOS ç”¨æˆ·ï¼š** ä½¿ç”¨ `plutil` å‘½ä»¤ã€‚è¿™æ˜¯ macOSï¼ˆ10.2+ï¼‰ä¸­çš„ä¸€ä¸ªå†…ç½®å·¥å…·ï¼Œä¸“é—¨ç”¨äºæ­¤ç›®çš„ï¼š
```bash
$ plutil -convert xml1 Info.plist
```
**å¯¹äºLinuxç”¨æˆ·ï¼š**é¦–å…ˆå®‰è£…`libplist-utils`ï¼Œç„¶åä½¿ç”¨`plistutil`æ¥è½¬æ¢æ‚¨çš„æ–‡ä»¶ï¼š
```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```
**åœ¨ Objection ä¼šè¯ä¸­ï¼š** ç”¨äºåˆ†æç§»åŠ¨åº”ç”¨ç¨‹åºçš„ç‰¹å®šå‘½ä»¤å…è®¸æ‚¨ç›´æ¥è½¬æ¢ plist æ–‡ä»¶ï¼š
```bash
ios plist cat /private/var/mobile/Containers/Data/Application/<Application-UUID>/Library/Preferences/com.some.package.app.plist
```
### Core Data

[`Core Data`](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CoreData/nsfetchedresultscontroller.html#//apple_ref/doc/uid/TP40001075-CH8-SW1) æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†åº”ç”¨ç¨‹åºä¸­å¯¹è±¡æ¨¡å‹å±‚çš„æ¡†æ¶ã€‚[Core Dataå¯ä»¥ä½¿ç”¨SQLiteä½œä¸ºå…¶æŒä¹…å­˜å‚¨](https://cocoacasts.com/what-is-the-difference-between-core-data-and-sqlite/)ï¼Œä½†æ¡†æ¶æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæ•°æ®åº“ã€‚\
CoreDataé»˜è®¤ä¸åŠ å¯†å…¶æ•°æ®ã€‚ç„¶è€Œï¼Œå¯ä»¥å‘CoreDataæ·»åŠ é¢å¤–çš„åŠ å¯†å±‚ã€‚æŸ¥çœ‹[GitHub Repo](https://github.com/project-imas/encrypted-core-data)è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

æ‚¨å¯ä»¥åœ¨è·¯å¾„`/private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support`ä¸­æ‰¾åˆ°åº”ç”¨ç¨‹åºçš„SQLite Core Dataä¿¡æ¯ã€‚

**å¦‚æœæ‚¨å¯ä»¥æ‰“å¼€SQLiteå¹¶è®¿é—®æ•æ„Ÿä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºæ‚¨å‘ç°äº†ä¸€ä¸ªé…ç½®é”™è¯¯ã€‚**

{% code title="iGoatä¸­çš„ä»£ç " %}
```objectivec
-(void)storeDetails {
AppDelegate * appDelegate = (AppDelegate *)(UIApplication.sharedApplication.delegate);

NSManagedObjectContext *context =[appDelegate managedObjectContext];

User *user = [self fetchUser];
if (user) {
return;
}
user = [NSEntityDescription insertNewObjectForEntityForName:@"User"
inManagedObjectContext:context];
user.email = CoreDataEmail;
user.password = CoreDataPassword;
NSError *error;
if (![context save:&error]) {
NSLog(@"Error in saving data: %@", [error localizedDescription]);

}else{
NSLog(@"data stored in core data");
}
}
```
{% endcode %}

### YapDatabase

[YapDatabase](https://github.com/yapstudios/YapDatabase) æ˜¯å»ºç«‹åœ¨ SQLite ä¹‹ä¸Šçš„é”®/å€¼å­˜å‚¨ã€‚\
ç”±äº Yap æ•°æ®åº“æ˜¯ SQLite æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­æåˆ°çš„å‘½ä»¤æ‰¾åˆ°å®ƒä»¬ã€‚

### å…¶ä»– SQLite æ•°æ®åº“

åº”ç”¨ç¨‹åºé€šå¸¸ä¼šåˆ›å»ºè‡ªå·±çš„ SQLite æ•°æ®åº“ã€‚å®ƒä»¬å¯èƒ½åœ¨å…¶ä¸­å­˜å‚¨æ•æ„Ÿæ•°æ®å¹¶å°†å…¶ä¿ç•™ä¸ºæœªåŠ å¯†ã€‚å› æ­¤ï¼Œæ£€æŸ¥åº”ç”¨ç¨‹åºç›®å½•ä¸­çš„æ¯ä¸ªæ•°æ®åº“å§‹ç»ˆæ˜¯ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œè¯·è½¬åˆ°ä¿å­˜æ•°æ®çš„åº”ç”¨ç¨‹åºç›®å½• (`/private/var/mobile/Containers/Data/Application/{APPID}`)ã€‚
```bash
find ./ -name "*.sqlite" -or -name "*.db"
```
### Firebaseå®æ—¶æ•°æ®åº“

å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡Firebaseå®æ—¶æ•°æ®åº“åœ¨**NoSQLäº‘æ‰˜ç®¡æ•°æ®åº“**ä¸­**å­˜å‚¨å’ŒåŒæ­¥æ•°æ®**ã€‚æ•°æ®ä»¥JSONæ ¼å¼å­˜å‚¨ï¼Œå¹¶å®æ—¶åŒæ­¥åˆ°æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯ã€‚

æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°å¦‚ä½•æ£€æŸ¥é…ç½®é”™è¯¯çš„Firebaseæ•°æ®åº“ï¼š

{% content-ref url="../../network-services-pentesting/pentesting-web/buckets/firebase-database.md" %}
[firebase-database.md](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)
{% endcontent-ref %}

### Realmæ•°æ®åº“

[Realm Objective-C](https://realm.io/docs/objc/latest/) å’Œ [Realm Swift](https://realm.io/docs/swift/latest/) æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®å­˜å‚¨æ›¿ä»£æ–¹æ¡ˆï¼Œè‹¹æœæ²¡æœ‰æä¾›ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä»¥æœªåŠ å¯†çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ç‰¹å®šé…ç½®è¿›è¡ŒåŠ å¯†ã€‚

è¿™äº›æ•°æ®åº“ä½äºï¼š`/private/var/mobile/Containers/Data/Application/{APPID}`ã€‚è¦æŸ¥çœ‹è¿™äº›æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š
```bash
iPhone:/private/var/mobile/Containers/Data/Application/A079DF84-726C-4AEA-A194-805B97B3684A/Documents root# ls
default.realm  default.realm.lock  default.realm.management/  default.realm.note|

$ find ./ -name "*.realm*"
```
è¦æŸ¥çœ‹è¿™äº›æ•°æ®åº“æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨[**Realm Studio**](https://github.com/realm/realm-studio)å·¥å…·ã€‚

è¦åœ¨Realmæ•°æ®åº“ä¸­å®ç°åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š
```swift
// Open the encrypted Realm file where getKey() is a method to obtain a key from the Keychain or a server
let config = Realm.Configuration(encryptionKey: getKey())
do {
let realm = try Realm(configuration: config)
// Use the Realm as normal
} catch let error as NSError {
// If the encryption key is wrong, `error` will say that it's an invalid database
fatalError("Error opening realm: \(error)")
}
```
### Couchbase Liteæ•°æ®åº“

[Couchbase Lite](https://github.com/couchbase/couchbase-lite-ios)è¢«æè¿°ä¸ºä¸€ç§**è½»é‡çº§**å’Œ**åµŒå…¥å¼**æ•°æ®åº“å¼•æ“ï¼Œéµå¾ª**é¢å‘æ–‡æ¡£**ï¼ˆNoSQLï¼‰çš„æ–¹æ³•ã€‚è®¾è®¡ä¸ºåŸç”Ÿæ”¯æŒ**iOS**å’Œ**macOS**ï¼Œæä¾›äº†æ— ç¼åŒæ­¥æ•°æ®çš„èƒ½åŠ›ã€‚

è¦è¯†åˆ«è®¾å¤‡ä¸Šå¯èƒ½å­˜åœ¨çš„Couchbaseæ•°æ®åº“ï¼Œåº”æ£€æŸ¥ä»¥ä¸‹ç›®å½•ï¼š
```bash
ls /private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support/
```
### Cookies

iOSå°†åº”ç”¨ç¨‹åºçš„cookieå­˜å‚¨åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ä¸­çš„**`Library/Cookies/cookies.binarycookies`**ä¸­ã€‚ç„¶è€Œï¼Œå¼€å‘äººå‘˜æœ‰æ—¶ä¼šå†³å®šå°†å®ƒä»¬ä¿å­˜åœ¨**é’¥åŒ™ä¸²**ä¸­ï¼Œå› ä¸ºä¸Šè¿°**cookieæ–‡ä»¶å¯ä»¥åœ¨å¤‡ä»½ä¸­è®¿é—®**ã€‚

è¦æ£€æŸ¥cookieæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**æ­¤Pythonè„šæœ¬**](https://github.com/mdegrazia/Safari-Binary-Cookie-Parser)æˆ–ä½¿ç”¨objectionçš„**`ios cookies get`**ã€‚\
**æ‚¨è¿˜å¯ä»¥ä½¿ç”¨objectionå°†è¿™äº›æ–‡ä»¶è½¬æ¢ä¸ºJSONæ ¼å¼å¹¶æ£€æŸ¥æ•°æ®ã€‚**
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios cookies get --json
[
{
"domain": "highaltitudehacks.com",
"expiresDate": "2051-09-15 07:46:43 +0000",
"isHTTPOnly": "false",
"isSecure": "false",
"name": "username",
"path": "/",
"value": "admin123",
"version": "0"
}
]
```
### ç¼“å­˜

é»˜è®¤æƒ…å†µä¸‹ï¼ŒNSURLSessionå°†æ•°æ®ï¼Œå¦‚**HTTPè¯·æ±‚å’Œå“åº”å­˜å‚¨åœ¨Cache.db**æ•°æ®åº“ä¸­ã€‚å¦‚æœä»¤ç‰Œã€ç”¨æˆ·åæˆ–ä»»ä½•å…¶ä»–æ•æ„Ÿä¿¡æ¯å·²è¢«ç¼“å­˜ï¼Œè¯¥æ•°æ®åº“å¯èƒ½åŒ…å«**æ•æ„Ÿæ•°æ®**ã€‚è¦æŸ¥æ‰¾ç¼“å­˜çš„ä¿¡æ¯ï¼Œè¯·æ‰“å¼€åº”ç”¨çš„æ•°æ®ç›®å½•ï¼ˆ`/var/mobile/Containers/Data/Application/<UUID>`ï¼‰å¹¶è½¬åˆ°`/Library/Caches/<Bundle Identifier>`ã€‚**WebKitç¼“å­˜ä¹Ÿå­˜å‚¨åœ¨Cache.db**æ–‡ä»¶ä¸­ã€‚**Objection**å¯ä»¥ä½¿ç”¨å‘½ä»¤`sqlite connect Cache.db`æ‰“å¼€å¹¶ä¸æ•°æ®åº“äº¤äº’ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª**æ™®é€šçš„SQLiteæ•°æ®åº“**ã€‚

**å»ºè®®ç¦ç”¨ç¼“å­˜è¿™äº›æ•°æ®**ï¼Œå› ä¸ºè¯·æ±‚æˆ–å“åº”ä¸­å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚ä¸‹é¢çš„åˆ—è¡¨æ˜¾ç¤ºäº†å®ç°æ­¤ç›®çš„çš„ä¸åŒæ–¹æ³•ï¼š

1. å»ºè®®åœ¨æ³¨é”€ååˆ é™¤ç¼“å­˜çš„å“åº”ã€‚å¯ä»¥ä½¿ç”¨è‹¹æœæä¾›çš„åä¸º[`removeAllCachedResponses`](https://developer.apple.com/documentation/foundation/urlcache/1417802-removeallcachedresponses)çš„æ–¹æ³•æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è°ƒç”¨æ­¤æ–¹æ³•ï¼š

   `URLCache.shared.removeAllCachedResponses()`

   æ­¤æ–¹æ³•å°†ä»Cache.dbæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„è¯·æ±‚å’Œå“åº”ã€‚
2. å¦‚æœæ‚¨ä¸éœ€è¦ä½¿ç”¨cookiesçš„ä¼˜åŠ¿ï¼Œå»ºè®®åªä½¿ç”¨URLSessionçš„[.ephemeral](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral)é…ç½®å±æ€§ï¼Œè¿™å°†ç¦ç”¨ä¿å­˜cookieså’Œç¼“å­˜ã€‚

   [è‹¹æœæ–‡æ¡£](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral)ï¼š

   `ä¸€ä¸ªä¸´æ—¶ä¼šè¯é…ç½®å¯¹è±¡ç±»ä¼¼äºé»˜è®¤ä¼šè¯é…ç½®ï¼ˆè¯·å‚é˜…defaultï¼‰ï¼Œä¸åŒä¹‹å¤„åœ¨äºç›¸åº”çš„ä¼šè¯å¯¹è±¡ä¸ä¼šå°†ç¼“å­˜ã€å‡­æ®å­˜å‚¨æˆ–ä»»ä½•ä¼šè¯ç›¸å…³æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ã€‚ç›¸åï¼Œä¼šè¯ç›¸å…³æ•°æ®å­˜å‚¨åœ¨RAMä¸­ã€‚ä¸´æ—¶ä¼šè¯ä»…åœ¨æ‚¨å‘Šè¯‰å®ƒå°†URLçš„å†…å®¹å†™å…¥æ–‡ä»¶æ—¶æ‰ä¼šå°†æ•°æ®å†™å…¥ç£ç›˜ã€‚`
3. é€šè¿‡å°†ç¼“å­˜ç­–ç•¥è®¾ç½®ä¸º[.notAllowed](https://developer.apple.com/documentation/foundation/urlcache/storagepolicy/notallowed)ä¹Ÿå¯ä»¥ç¦ç”¨ç¼“å­˜ã€‚è¿™å°†ç¦æ­¢ä»¥ä»»ä½•æ–¹å¼å­˜å‚¨ç¼“å­˜ï¼Œæ— è®ºæ˜¯åœ¨å†…å­˜ä¸­è¿˜æ˜¯åœ¨ç£ç›˜ä¸Šã€‚

### å¿«ç…§

æ¯å½“æŒ‰ä¸‹ä¸»å±å¹•æŒ‰é’®æ—¶ï¼ŒiOSéƒ½ä¼š**æ‹æ‘„å½“å‰å±å¹•çš„å¿«ç…§**ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ›´æµç•…åœ°åˆ‡æ¢åˆ°åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œå¦‚æœå½“å‰å±å¹•ä¸­å­˜åœ¨**æ•æ„Ÿæ•°æ®**ï¼Œå®ƒå°†è¢«**ä¿å­˜**åœ¨**å›¾åƒ**ä¸­ï¼ˆè¿™å°†**æŒç»­** **è·¨** **é‡å¯**ï¼‰ã€‚è¿™äº›å¿«ç…§ä¹Ÿå¯ä»¥é€šè¿‡åŒå‡»ä¸»å±å¹•æ¥è®¿é—®ï¼Œä»¥åœ¨åº”ç”¨ç¨‹åºä¹‹é—´åˆ‡æ¢ã€‚

é™¤éiPhoneå·²è¶Šç‹±ï¼Œå¦åˆ™**æ”»å‡»è€…**éœ€è¦**è§£é”**è®¾å¤‡æ‰èƒ½æŸ¥çœ‹è¿™äº›å±å¹•æˆªå›¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªå¿«ç…§å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºçš„æ²™ç›’ä¸­çš„`Library/Caches/Snapshots/`æˆ–`Library/SplashBoard/Snapshots`æ–‡ä»¶å¤¹ä¸­ï¼ˆå—ä¿¡ä»»çš„è®¡ç®—æœºæ— æ³•ä»iOS 7.0è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚

é˜²æ­¢è¿™ç§ä¸è‰¯è¡Œä¸ºçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨æ‹æ‘„å¿«ç…§ä¹‹å‰æ”¾ç½®ä¸€ä¸ªç©ºç™½å±å¹•æˆ–åˆ é™¤æ•æ„Ÿæ•°æ®ï¼Œä½¿ç”¨`ApplicationDidEnterBackground()`å‡½æ•°ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªè®¾ç½®é»˜è®¤å±å¹•æˆªå›¾çš„ç¤ºä¾‹ä¿®å¤æ–¹æ³•ã€‚

Swift:
```swift
private var backgroundImage: UIImageView?

func applicationDidEnterBackground(_ application: UIApplication) {
let myBanner = UIImageView(image: #imageLiteral(resourceName: "overlayImage"))
myBanner.frame = UIScreen.main.bounds
backgroundImage = myBanner
window?.addSubview(myBanner)
}

func applicationWillEnterForeground(_ application: UIApplication) {
backgroundImage?.removeFromSuperview()
}
```
Objective-Cï¼š
```
@property (UIImageView *)backgroundImage;

- (void)applicationDidEnterBackground:(UIApplication *)application {
UIImageView *myBanner = [[UIImageView alloc] initWithImage:@"overlayImage.png"];
self.backgroundImage = myBanner;
self.backgroundImage.bounds = UIScreen.mainScreen.bounds;
[self.window addSubview:myBanner];
}

- (void)applicationWillEnterForeground:(UIApplication *)application {
[self.backgroundImage removeFromSuperview];
}
```
è¿™ä¼šåœ¨åº”ç”¨ç¨‹åºè¿›å…¥åå°æ—¶å°†èƒŒæ™¯å›¾åƒè®¾ç½®ä¸º`overlayImage.png`ã€‚å®ƒå¯ä»¥é˜²æ­¢æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œå› ä¸º`overlayImage.png`å°†å§‹ç»ˆè¦†ç›–å½“å‰è§†å›¾ã€‚

### Keychain

è¦è®¿é—®å’Œç®¡ç†iOSé’¥åŒ™ä¸²ï¼Œå¯ä»¥ä½¿ç”¨åƒ[**Keychain-Dumper**](https://github.com/ptoomey3/Keychain-Dumper)è¿™æ ·çš„å·¥å…·ï¼Œé€‚ç”¨äºè¶Šç‹±è®¾å¤‡ã€‚æ­¤å¤–ï¼Œ[**Objection**](https://github.com/sensepost/objection)æä¾›äº†`ios keychain dump`å‘½ä»¤ï¼Œç”¨äºç±»ä¼¼çš„ç›®çš„ã€‚

#### **å­˜å‚¨å‡­æ®**

**NSURLCredential**ç±»éå¸¸é€‚åˆç›´æ¥å°†æ•æ„Ÿä¿¡æ¯ä¿å­˜åœ¨é’¥åŒ™ä¸²ä¸­ï¼Œæ— éœ€ä½¿ç”¨NSUserDefaultæˆ–å…¶ä»–åŒ…è£…å™¨ã€‚è¦åœ¨ç™»å½•åå­˜å‚¨å‡­æ®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹Swiftä»£ç ï¼š
```swift
NSURLCredential *credential;
credential = [NSURLCredential credentialWithUser:username password:password persistence:NSURLCredentialPersistencePermanent];
[[NSURLCredentialStorage sharedCredentialStorage] setCredential:credential forProtectionSpace:self.loginProtectionSpace];
```
## **è‡ªå®šä¹‰é”®ç›˜å’Œé”®ç›˜ç¼“å­˜**

ä»iOS 8.0å¼€å§‹ï¼Œç”¨æˆ·å¯ä»¥å®‰è£…è‡ªå®šä¹‰é”®ç›˜æ‰©å±•ï¼Œå¯åœ¨**è®¾ç½® > é€šç”¨ > é”®ç›˜ > é”®ç›˜**ä¸‹è¿›è¡Œç®¡ç†ã€‚è™½ç„¶è¿™äº›é”®ç›˜æä¾›äº†æ‰©å±•åŠŸèƒ½ï¼Œä½†å­˜åœ¨è®°å½•æŒ‰é”®å’Œå°†æ•°æ®ä¼ è¾“åˆ°å¤–éƒ¨æœåŠ¡å™¨çš„é£é™©ï¼Œä¸è¿‡ç”¨æˆ·ä¼šæ”¶åˆ°æœ‰å…³éœ€è¦ç½‘ç»œè®¿é—®çš„é”®ç›˜çš„é€šçŸ¥ã€‚åº”ç”¨ç¨‹åºå¯ä»¥å¹¶ä¸”åº”è¯¥é™åˆ¶å¯¹è‡ªå®šä¹‰é”®ç›˜ç”¨äºè¾“å…¥æ•æ„Ÿä¿¡æ¯ã€‚

**å®‰å…¨å»ºè®®:**

* å»ºè®®ç¦ç”¨ç¬¬ä¸‰æ–¹é”®ç›˜ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚
* æ³¨æ„é»˜è®¤iOSé”®ç›˜çš„è‡ªåŠ¨æ›´æ­£å’Œè‡ªåŠ¨å»ºè®®åŠŸèƒ½ï¼Œå¯èƒ½ä¼šå°†æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨`Library/Keyboard/{locale}-dynamic-text.dat`æˆ–`/private/var/mobile/Library/Keyboard/dynamic-text.dat`ä¸­çš„ç¼“å­˜æ–‡ä»¶ä¸­ã€‚åº”å®šæœŸæ£€æŸ¥è¿™äº›ç¼“å­˜æ–‡ä»¶ä»¥æŸ¥æ‰¾æ•æ„Ÿæ•°æ®ã€‚å»ºè®®é€šè¿‡**è®¾ç½® > é€šç”¨ > é‡ç½® > é‡ç½®é”®ç›˜å­—å…¸**æ¥é‡ç½®é”®ç›˜å­—å…¸ä»¥æ¸…é™¤ç¼“å­˜æ•°æ®ã€‚
* æ‹¦æˆªç½‘ç»œæµé‡å¯ä»¥æ­ç¤ºè‡ªå®šä¹‰é”®ç›˜æ˜¯å¦è¿œç¨‹ä¼ è¾“æŒ‰é”®ã€‚

### **é˜²æ­¢æ–‡æœ¬å­—æ®µç¼“å­˜**

[UITextInputTraitsåè®®](https://developer.apple.com/reference/uikit/uitextinputtraits)æä¾›äº†ç®¡ç†è‡ªåŠ¨æ›´æ­£å’Œå®‰å…¨æ–‡æœ¬è¾“å…¥çš„å±æ€§ï¼Œå¯¹äºé˜²æ­¢æ•æ„Ÿä¿¡æ¯ç¼“å­˜è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç¦ç”¨è‡ªåŠ¨æ›´æ­£å’Œå¯ç”¨å®‰å…¨æ–‡æœ¬è¾“å…¥ï¼Œå¯ä»¥å®ç°ï¼š
```objectivec
textObject.autocorrectionType = UITextAutocorrectionTypeNo;
textObject.secureTextEntry = YES;
```
å¦å¤–ï¼Œå¼€å‘äººå‘˜åº”ç¡®ä¿æ–‡æœ¬å­—æ®µï¼Œç‰¹åˆ«æ˜¯ç”¨äºè¾“å…¥å¯†ç å’ŒPINç­‰æ•æ„Ÿä¿¡æ¯çš„å­—æ®µï¼Œé€šè¿‡å°†`autocorrectionType`è®¾ç½®ä¸º`UITextAutocorrectionTypeNo`å’Œ`secureTextEntry`è®¾ç½®ä¸º`YES`æ¥ç¦ç”¨ç¼“å­˜ã€‚
```objectivec
UITextField *textField = [[UITextField alloc] initWithFrame:frame];
textField.autocorrectionType = UITextAutocorrectionTypeNo;
```
## **æ—¥å¿—**

è°ƒè¯•ä»£ç é€šå¸¸æ¶‰åŠä½¿ç”¨**æ—¥å¿—**ã€‚å­˜åœ¨é£é™©ï¼Œå› ä¸º**æ—¥å¿—å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯**ã€‚åœ¨iOS 6åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œæ—¥å¿—å¯¹æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½æ˜¯å¯è®¿é—®çš„ï¼Œå­˜åœ¨æ•æ„Ÿæ•°æ®æ³„éœ²çš„é£é™©ã€‚**ç°åœ¨ï¼Œåº”ç”¨ç¨‹åºä»…é™äºè®¿é—®è‡ªå·±çš„æ—¥å¿—**ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é™åˆ¶ï¼Œ**æ‹¥æœ‰ç‰©ç†è®¿é—®æƒé™**çš„æ”»å‡»è€…ä»å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œé€šè¿‡å°†è®¾å¤‡è¿æ¥åˆ°è®¡ç®—æœºå¹¶**è¯»å–æ—¥å¿—**ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åœ¨åº”ç”¨ç¨‹åºå¸è½½åï¼Œæ—¥å¿—ä»ç„¶ä¿ç•™åœ¨ç£ç›˜ä¸Šã€‚

ä¸ºäº†å‡è½»é£é™©ï¼Œå»ºè®®**ä¸åº”ç”¨ç¨‹åºè¿›è¡Œå…¨é¢äº¤äº’**ï¼Œæ¢ç´¢å…¶æ‰€æœ‰åŠŸèƒ½å’Œè¾“å…¥ï¼Œä»¥ç¡®ä¿æ²¡æœ‰æ„å¤–è®°å½•æ•æ„Ÿä¿¡æ¯ã€‚

åœ¨å®¡æŸ¥åº”ç”¨ç¨‹åºæºä»£ç ä»¥æŸ¥æ‰¾æ½œåœ¨æ³„æ¼æ—¶ï¼ŒæŸ¥æ‰¾ä½¿ç”¨å…³é”®å­—å¦‚`NSLog`ã€`NSAssert`ã€`NSCAssert`ã€`fprintf`ç­‰å†…ç½®å‡½æ•°çš„**é¢„å®šä¹‰**å’Œ**è‡ªå®šä¹‰æ—¥å¿—è®°å½•è¯­å¥**ï¼Œä»¥åŠä»»ä½•æåŠ`Logging`æˆ–`Logfile`çš„è‡ªå®šä¹‰å®ç°ã€‚

### **ç›‘æ§ç³»ç»Ÿæ—¥å¿—**

åº”ç”¨ç¨‹åºè®°å½•å„ç§å¯èƒ½æ•æ„Ÿçš„ä¿¡æ¯ã€‚è¦ç›‘è§†è¿™äº›æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·å’Œå‘½ä»¤ï¼Œå¦‚ï¼š
```bash
idevice_id --list   # To find the device ID
idevicesyslog -u <id> (| grep <app>)   # To capture the device logs
```
ä»¥ä¸‹å†…å®¹å¾ˆæœ‰ç”¨ã€‚æ­¤å¤–ï¼Œ**Xcode** æä¾›äº†ä¸€ç§æ”¶é›†æ§åˆ¶å°æ—¥å¿—çš„æ–¹æ³•ï¼š

1. æ‰“å¼€ Xcodeã€‚
2. è¿æ¥ iOS è®¾å¤‡ã€‚
3. å¯¼èˆªè‡³ **Window** -> **Devices and Simulators**ã€‚
4. é€‰æ‹©æ‚¨çš„è®¾å¤‡ã€‚
5. è§¦å‘æ‚¨æ­£åœ¨è°ƒæŸ¥çš„é—®é¢˜ã€‚
6. ä½¿ç”¨ **Open Console** æŒ‰é’®åœ¨æ–°çª—å£ä¸­æŸ¥çœ‹æ—¥å¿—ã€‚

å¯¹äºæ›´é«˜çº§çš„æ—¥å¿—è®°å½•ï¼Œè¿æ¥åˆ°è®¾å¤‡ shell å¹¶ä½¿ç”¨ **socat** å¯ä»¥æä¾›å®æ—¶æ—¥å¿—ç›‘æ§ï¼š
```bash
iPhone:~ root# socat - UNIX-CONNECT:/var/run/lockdown/syslog.sock
```
è·Ÿéšå‘½ä»¤è§‚å¯Ÿæ—¥å¿—æ´»åŠ¨ï¼Œè¿™å¯¹è¯Šæ–­é—®é¢˜æˆ–è¯†åˆ«æ—¥å¿—ä¸­æ½œåœ¨æ•°æ®æ³„æ¼éå¸¸å®è´µã€‚

***

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) å¯è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œåˆ©ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## å¤‡ä»½

**è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½**å·²é›†æˆåˆ° iOS ä¸­ï¼Œé€šè¿‡ iTunesï¼ˆåœ¨ macOS Catalina ä¹‹å‰ï¼‰ã€Finderï¼ˆä» macOS Catalina å¼€å§‹ï¼‰æˆ– iCloudï¼Œä¾¿äºåˆ›å»ºè®¾å¤‡æ•°æ®å‰¯æœ¬ã€‚è¿™äº›å¤‡ä»½å‡ ä¹åŒ…å«æ‰€æœ‰è®¾å¤‡æ•°æ®ï¼Œä½†ä¸åŒ…æ‹¬é«˜åº¦æ•æ„Ÿçš„å…ƒç´ ï¼Œå¦‚ Apple Pay è¯¦ç»†ä¿¡æ¯å’Œ Touch ID é…ç½®ã€‚

### å®‰å…¨é£é™©

å¤‡ä»½ä¸­åŒ…å«**å·²å®‰è£…çš„åº”ç”¨åŠå…¶æ•°æ®**å¼•å‘äº†æ½œåœ¨**æ•°æ®æ³„æ¼**é—®é¢˜ï¼Œä»¥åŠ**å¤‡ä»½ä¿®æ”¹å¯èƒ½æ”¹å˜åº”ç”¨åŠŸèƒ½**çš„é£é™©ã€‚å»ºè®®**ä¸è¦åœ¨æ˜æ–‡ä¸­å­˜å‚¨æ•æ„Ÿä¿¡æ¯**ï¼Œä»¥å‡è½»è¿™äº›é£é™©ã€‚

### ä»å¤‡ä»½ä¸­æ’é™¤æ–‡ä»¶

`Documents/` å’Œ `Library/Application Support/` ä¸­çš„æ–‡ä»¶é»˜è®¤ä¼šè¢«å¤‡ä»½ã€‚å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ `NSURL setResourceValue:forKey:error:` å’Œ `NSURLIsExcludedFromBackupKey` ä»å¤‡ä»½ä¸­æ’é™¤ç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™ä¸€åšæ³•å¯¹äºä¿æŠ¤æ•æ„Ÿæ•°æ®ä¸è¢«åŒ…å«åœ¨å¤‡ä»½ä¸­è‡³å…³é‡è¦ã€‚

### æ¼æ´æµ‹è¯•

è¦è¯„ä¼°åº”ç”¨çš„å¤‡ä»½å®‰å…¨æ€§ï¼Œé¦–å…ˆé€šè¿‡ Finder **åˆ›å»ºä¸€ä¸ªå¤‡ä»½**ï¼Œç„¶åæ ¹æ®[è‹¹æœå®˜æ–¹æ–‡æ¡£](https://support.apple.com/en-us/HT204215)ä¸­çš„æŒ‡å¯¼æ‰¾åˆ°å¤‡ä»½ã€‚åˆ†æå¤‡ä»½ä¸­çš„æ•æ„Ÿæ•°æ®æˆ–é…ç½®ï¼Œä»¥ç¡®å®šå¯èƒ½ä¼šå½±å“åº”ç”¨è¡Œä¸ºçš„å†…å®¹ã€‚

å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æˆ–åº”ç”¨ç¨‹åºå¦‚ [iMazing](https://imazing.com) æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯ã€‚å¯¹äºåŠ å¯†å¤‡ä»½ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥å¤‡ä»½æ ¹ç›®å½•ä¸­çš„ "Manifest.plist" æ–‡ä»¶ä¸­çš„ "IsEncrypted" é”®æ¥ç¡®è®¤æ˜¯å¦åŠ å¯†ã€‚
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
...
<key>Date</key>
<date>2021-03-12T17:43:33Z</date>
<key>IsEncrypted</key>
<true/>
...
</plist>
```
### å¤„ç†åŠ å¯†å¤‡ä»½

å¤„ç†åŠ å¯†å¤‡ä»½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨[DinoSecçš„GitHubå­˜å‚¨åº“](https://github.com/dinosec/iphone-dataprotection/tree/master/python\_scripts)ä¸­æä¾›çš„Pythonè„šæœ¬ï¼Œå¦‚**backup\_tool.py**å’Œ**backup\_passwd.py**ï¼Œå°½ç®¡å¯èƒ½éœ€è¦è¿›è¡Œè°ƒæ•´ä»¥ä¸æœ€æ–°çš„iTunes/Finderç‰ˆæœ¬å…¼å®¹ã€‚å¦ä¸€ä¸ªè®¿é—®å—å¯†ç ä¿æŠ¤å¤‡ä»½ä¸­æ–‡ä»¶çš„é€‰æ‹©æ˜¯[**iOSbackup**å·¥å…·](https://pypi.org/project/iOSbackup/)ã€‚

### ä¿®æ”¹åº”ç”¨ç¨‹åºè¡Œä¸º

é€šè¿‡å¤‡ä»½ä¿®æ”¹æ¥æ”¹å˜åº”ç”¨ç¨‹åºè¡Œä¸ºçš„ç¤ºä¾‹å¯åœ¨[Bitheræ¯”ç‰¹å¸é’±åŒ…åº”ç”¨](https://github.com/bither/bither-ios)ä¸­æ‰¾åˆ°ï¼Œå…¶ä¸­UIé”å®šPINå­˜å‚¨åœ¨`net.bither.plist`æ–‡ä»¶ä¸­çš„**pin\_code**é”®ä¸‹ã€‚ä»plistä¸­ç§»é™¤æ­¤é”®å¹¶æ¢å¤å¤‡ä»½å³å¯å»é™¤PINè¦æ±‚ï¼Œæä¾›æ— é™åˆ¶è®¿é—®ã€‚

## æ•æ„Ÿæ•°æ®çš„å†…å­˜æµ‹è¯•æ€»ç»“

å¤„ç†å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…å­˜ä¸­çš„æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œé™åˆ¶æ­¤æ•°æ®çš„æš´éœ²æ—¶é—´è‡³å…³é‡è¦ã€‚è°ƒæŸ¥å†…å­˜å†…å®¹æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼š**åˆ›å»ºå†…å­˜è½¬å‚¨**å’Œ**å®æ—¶åˆ†æå†…å­˜**ã€‚è¿™ä¸¤ç§æ–¹æ³•éƒ½æœ‰å„è‡ªçš„æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬åœ¨è½¬å‚¨è¿‡ç¨‹æˆ–åˆ†æè¿‡ç¨‹ä¸­å¯èƒ½é”™è¿‡å…³é”®æ•°æ®çš„é£é™©ã€‚

## **æ£€ç´¢å’Œåˆ†æå†…å­˜è½¬å‚¨**

å¯¹äºè¶Šç‹±å’Œéè¶Šç‹±è®¾å¤‡ï¼Œè¯¸å¦‚[objection](https://github.com/sensepost/objection)å’Œ[Fridump](https://github.com/Nightbringer21/fridump)ç­‰å·¥å…·å…è®¸è½¬å‚¨åº”ç”¨ç¨‹åºè¿›ç¨‹å†…å­˜ã€‚ä¸€æ—¦è½¬å‚¨å®Œæˆï¼Œåˆ†æè¿™äº›æ•°æ®éœ€è¦ä½¿ç”¨å„ç§å·¥å…·ï¼Œå…·ä½“å–å†³äºæ‚¨è¦æœç´¢çš„ä¿¡æ¯çš„æ€§è´¨ã€‚

è¦ä»å†…å­˜è½¬å‚¨ä¸­æå–å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨`strings`æˆ–`rabin2 -zz`ç­‰å‘½ä»¤ï¼š
```bash
# Extracting strings using strings command
$ strings memory > strings.txt

# Extracting strings using rabin2
$ rabin2 -ZZ memory > strings.txt
```
å¯¹äºæ›´è¯¦ç»†çš„åˆ†æï¼ŒåŒ…æ‹¬æœç´¢ç‰¹å®šæ•°æ®ç±»å‹æˆ–æ¨¡å¼ï¼Œ**radare2** æä¾›äº†å¹¿æ³›çš„æœç´¢åŠŸèƒ½ï¼š
```bash
$ r2 <name_of_your_dump_file>
[0x00000000]> /?
...
```
## **è¿è¡Œæ—¶å†…å­˜åˆ†æ**

**r2frida** æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥å®æ—¶æ£€æŸ¥åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼Œè€Œæ— éœ€è¿›è¡Œå†…å­˜è½¬å‚¨ã€‚è¯¥å·¥å…·ä½¿å¾—å¯ä»¥ç›´æ¥åœ¨è¿è¡Œåº”ç”¨ç¨‹åºçš„å†…å­˜ä¸Šæ‰§è¡Œæœç´¢å‘½ä»¤ï¼š
```bash
$ r2 frida://usb//<name_of_your_app>
[0x00000000]> /\ <search_command>
```
## åŠ å¯†ç ´è§£

### å¯†é’¥ç®¡ç†æµç¨‹ä¸å½“

ä¸€äº›å¼€å‘äººå‘˜ä¼šå°†æ•æ„Ÿæ•°æ®ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨åœ¨ä»£ç ä¸­ç¡¬ç¼–ç /å¯é¢„æµ‹çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚è¿™æ ·åšæ˜¯ä¸åº”è¯¥çš„ï¼Œå› ä¸ºä¸€äº›é€†å‘å·¥ç¨‹å¯èƒ½ä¼šä½¿æ”»å‡»è€…æå–æœºå¯†ä¿¡æ¯ã€‚

### ä½¿ç”¨ä¸å®‰å…¨å’Œ/æˆ–å·²å¼ƒç”¨çš„ç®—æ³•

å¼€å‘äººå‘˜ä¸åº”è¯¥ä½¿ç”¨**å·²å¼ƒç”¨çš„ç®—æ³•**æ¥æ‰§è¡Œæˆæƒ**æ£€æŸ¥**ï¼Œ**å­˜å‚¨**æˆ–**å‘é€**æ•°æ®ã€‚ä¸€äº›è¿™äº›ç®—æ³•åŒ…æ‹¬ï¼šRC4ï¼ŒMD4ï¼ŒMD5ï¼ŒSHA1... å¦‚æœç”¨äºå­˜å‚¨å¯†ç çš„**å“ˆå¸Œ**ï¼Œåº”è¯¥ä½¿ç”¨æŠ—æš´åŠ›ç ´è§£çš„å“ˆå¸Œç®—æ³•å¹¶åŠ ç›ã€‚

### æ£€æŸ¥

è¦æ‰§è¡Œçš„ä¸»è¦æ£€æŸ¥åŒ…æ‹¬æŸ¥æ‰¾ä»£ç ä¸­æ˜¯å¦å­˜åœ¨**ç¡¬ç¼–ç **çš„å¯†ç /å¯†é’¥ï¼Œæˆ–è€…è¿™äº›æ˜¯å¦æ˜¯**å¯é¢„æµ‹**çš„ï¼Œå¹¶ä¸”ä»£ç æ˜¯å¦ä½¿ç”¨äº†æŸç§**å¼±**çš„**åŠ å¯†**ç®—æ³•ã€‚

æœ‰è¶£çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨**objection**è‡ªåŠ¨ç›‘è§†ä¸€äº›**åŠ å¯†** **åº“**ï¼Œæ–¹æ³•æ˜¯ï¼š
```swift
ios monitor crypt
```
æœ‰å…³iOSåŠ å¯†APIå’Œåº“çš„**æ›´å¤šä¿¡æ¯**ï¼Œè¯·è®¿é—®[https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography)

## æœ¬åœ°èº«ä»½éªŒè¯

**æœ¬åœ°èº«ä»½éªŒè¯**åœ¨é€šè¿‡åŠ å¯†æ–¹æ³•ä¿æŠ¤è¿œç¨‹ç«¯ç‚¹çš„è®¿é—®æ—¶å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å…³é”®åœ¨äºï¼Œå¦‚æœæ²¡æœ‰é€‚å½“çš„å®ç°ï¼Œæœ¬åœ°èº«ä»½éªŒè¯æœºåˆ¶å¯èƒ½ä¼šè¢«è§„é¿ã€‚

è‹¹æœçš„[**æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶**](https://developer.apple.com/documentation/localauthentication)å’Œ[**é’¥åŒ™ä¸²**](https://developer.apple.com/library/content/documentation/Security/Conceptual/keychainServConcepts/01introduction/introduction.html)ä¸ºå¼€å‘äººå‘˜æä¾›äº†å¼ºå¤§çš„APIï¼Œä»¥ä¾¿äºç”¨æˆ·èº«ä»½éªŒè¯å¯¹è¯æ¡†å’Œå®‰å…¨å¤„ç†ç§˜å¯†æ•°æ®ã€‚å®‰å…¨åŒºåŸŸä¸ºTouch IDæä¾›æŒ‡çº¹IDå®‰å…¨ï¼Œè€ŒFace IDä¾èµ–é¢éƒ¨è¯†åˆ«è€Œä¸ä¼šæ³„éœ²ç”Ÿç‰©ç‰¹å¾æ•°æ®ã€‚

è¦é›†æˆTouch ID/Face IDï¼Œå¼€å‘äººå‘˜æœ‰ä¸¤ä¸ªAPIé€‰æ‹©ï¼š

* **`LocalAuthentication.framework`** ç”¨äºé«˜çº§ç”¨æˆ·èº«ä»½éªŒè¯ï¼Œæ— æ³•è®¿é—®ç”Ÿç‰©ç‰¹å¾æ•°æ®ã€‚
* **`Security.framework`** ç”¨äºè¾ƒä½çº§åˆ«çš„é’¥åŒ™ä¸²æœåŠ¡è®¿é—®ï¼Œä½¿ç”¨ç”Ÿç‰©ç‰¹å¾èº«ä»½éªŒè¯ä¿æŠ¤ç§˜å¯†æ•°æ®ã€‚å„ç§[å¼€æºåŒ…è£…å™¨](https://www.raywenderlich.com/147308/secure-ios-user-data-keychain-touch-id)ä½¿é’¥åŒ™ä¸²è®¿é—®æ›´ç®€å•ã€‚

{% hint style="danger" %}
ç„¶è€Œï¼Œ`LocalAuthentication.framework`å’Œ`Security.framework`éƒ½å­˜åœ¨æ¼æ´ï¼Œå› ä¸ºå®ƒä»¬ä¸»è¦è¿”å›å¸ƒå°”å€¼ï¼Œè€Œä¸ä¼šä¼ è¾“ç”¨äºèº«ä»½éªŒè¯è¿‡ç¨‹çš„æ•°æ®ï¼Œä½¿å…¶å®¹æ˜“å—åˆ°ç»•è¿‡æ”»å‡»ï¼ˆå‚è§[Don't touch me that way, by David Lindner et al](https://www.youtube.com/watch?v=XhXIHVGCFFM)ï¼‰ã€‚
{% endhint %}

### å®ç°æœ¬åœ°èº«ä»½éªŒè¯

ä¸ºäº†æç¤ºç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¼€å‘äººå‘˜åº”è¯¥åœ¨**`LAContext`**ç±»ä¸­ä½¿ç”¨**`evaluatePolicy`**æ–¹æ³•ï¼Œåœ¨ä»¥ä¸‹é€‰é¡¹ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼š

* **`deviceOwnerAuthentication`**ï¼šæç¤ºä½¿ç”¨Touch IDæˆ–è®¾å¤‡å¯†ç ï¼Œå¦‚æœä¸¤è€…éƒ½æœªå¯ç”¨ï¼Œåˆ™å¤±è´¥ã€‚
* **`deviceOwnerAuthenticationWithBiometrics`**ï¼šä»…æç¤ºä½¿ç”¨Touch IDã€‚

ä»**`evaluatePolicy`**è¿”å›çš„å¸ƒå°”å€¼è¡¨ç¤ºæˆåŠŸçš„èº«ä»½éªŒè¯ï¼Œçªæ˜¾äº†æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

### ä½¿ç”¨é’¥åŒ™ä¸²è¿›è¡Œæœ¬åœ°èº«ä»½éªŒè¯

åœ¨iOSåº”ç”¨ä¸­å®ç°**æœ¬åœ°èº«ä»½éªŒè¯**æ¶‰åŠä½¿ç”¨**é’¥åŒ™ä¸²API**æ¥å®‰å…¨å­˜å‚¨è¯¸å¦‚èº«ä»½éªŒè¯ä»¤ç‰Œä¹‹ç±»çš„ç§˜å¯†æ•°æ®ã€‚è¯¥è¿‡ç¨‹ç¡®ä¿æ•°æ®åªèƒ½é€šè¿‡ç”¨æˆ·ä½¿ç”¨å…¶è®¾å¤‡å¯†ç æˆ–Touch IDç­‰ç”Ÿç‰©ç‰¹å¾èº«ä»½éªŒè¯æ¥è®¿é—®ã€‚

é’¥åŒ™ä¸²æä¾›äº†ä½¿ç”¨`SecAccessControl`å±æ€§è®¾ç½®é¡¹ç›®çš„åŠŸèƒ½ï¼Œè¯¥å±æ€§é™åˆ¶å¯¹é¡¹ç›®çš„è®¿é—®ï¼Œç›´åˆ°ç”¨æˆ·é€šè¿‡Touch IDæˆ–è®¾å¤‡å¯†ç æˆåŠŸè¿›è¡Œèº«ä»½éªŒè¯ã€‚è¿™ä¸€åŠŸèƒ½å¯¹äºå¢å¼ºå®‰å…¨æ€§è‡³å…³é‡è¦ã€‚

ä»¥ä¸‹æ˜¯Swiftå’ŒObjective-Cä¸­çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å°†å­—ç¬¦ä¸²ä¿å­˜åˆ°é’¥åŒ™ä¸²ä¸­å¹¶ä»ä¸­æ£€ç´¢å‡ºæ¥ï¼Œåˆ©ç”¨è¿™äº›å®‰å…¨åŠŸèƒ½ã€‚ç¤ºä¾‹ç‰¹åˆ«å±•ç¤ºäº†å¦‚ä½•è®¾ç½®è®¿é—®æ§åˆ¶ä»¥è¦æ±‚Touch IDèº«ä»½éªŒè¯ï¼Œå¹¶ç¡®ä¿æ•°æ®ä»…åœ¨è®¾ç½®çš„è®¾å¤‡ä¸Šå¯è®¿é—®ï¼Œå‰ææ˜¯é…ç½®äº†è®¾å¤‡å¯†ç ã€‚

{% tabs %}
{% tab title="Swift" %}
```swift
// From https://github.com/mufambisi/owasp-mstg/blob/master/Document/0x06f-Testing-Local-Authentication.md

// 1. create AccessControl object that will represent authentication settings

var error: Unmanaged<CFError>?

guard let accessControl = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
SecAccessControlCreateFlags.biometryCurrentSet,
&error) else {
// failed to create AccessControl object

return
}

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute

var query: [String: Any] = [:]

query[kSecClass as String] = kSecClassGenericPassword
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecAttrAccount as String] = "OWASP Account" as CFString
query[kSecValueData as String] = "test_strong_password".data(using: .utf8)! as CFData
query[kSecAttrAccessControl as String] = accessControl

// 3. save item

let status = SecItemAdd(query as CFDictionary, nil)

if status == noErr {
// successfully saved
} else {
// error while saving
}
```
{% endtab %}

{% tab title="Objective-C" %}

## iOSåº”ç”¨ç¨‹åºé€†å‘å·¥ç¨‹å’Œæ¸—é€æµ‹è¯•

### 1. å®‰è£…å·¥å…·

åœ¨è¿›è¡ŒiOSåº”ç”¨ç¨‹åºé€†å‘å·¥ç¨‹å’Œæ¸—é€æµ‹è¯•ä¹‹å‰ï¼Œæ‚¨éœ€è¦å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

- **Theos**ï¼šç”¨äºiOSåº”ç”¨ç¨‹åºçš„å¼€å‘å’Œé€†å‘å·¥ç¨‹çš„å·¥å…·å¥—ä»¶ã€‚
- **Cydia Substrate**ï¼šç”¨äºiOSåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶æ³¨å…¥ã€‚
- **iOS App Signer**ï¼šç”¨äºç­¾åiOSåº”ç”¨ç¨‹åºã€‚
- **Clutch**ï¼šç”¨äºåœ¨iOSè®¾å¤‡ä¸Šå¯¼å‡ºåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚
- **class-dump**ï¼šç”¨äºå¯¼å‡ºiOSåº”ç”¨ç¨‹åºçš„ç±»å®šä¹‰ã€‚

### 2. é€†å‘å·¥ç¨‹iOSåº”ç”¨ç¨‹åº

è¦é€†å‘å·¥ç¨‹iOSåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. ä½¿ç”¨Clutchå¯¼å‡ºåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚
2. ä½¿ç”¨class-dumpå¯¼å‡ºåº”ç”¨ç¨‹åºçš„ç±»å®šä¹‰ã€‚
3. ä½¿ç”¨é€†å‘å·¥ç¨‹å·¥å…·åˆ†æåº”ç”¨ç¨‹åºçš„ä»£ç å’ŒåŠŸèƒ½ã€‚

### 3. iOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•

è¿›è¡ŒiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶ï¼Œæ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹æŠ€æœ¯ï¼š

- **é™æ€åˆ†æ**ï¼šåˆ†æåº”ç”¨ç¨‹åºçš„ä»£ç å’Œèµ„æºæ–‡ä»¶ã€‚
- **åŠ¨æ€åˆ†æ**ï¼šä½¿ç”¨å·¥å…·è¿›è¡Œåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶åˆ†æã€‚
- **æ•°æ®ä¼ è¾“åˆ†æ**ï¼šåˆ†æåº”ç”¨ç¨‹åºä¸æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚
- **æ¼æ´åˆ©ç”¨**ï¼šå°è¯•åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

### 4. å®‰å…¨å»ºè®®

åœ¨è¿›è¡ŒiOSåº”ç”¨ç¨‹åºé€†å‘å·¥ç¨‹å’Œæ¸—é€æµ‹è¯•æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹å®‰å…¨å»ºè®®ï¼š

- **ä»…åœ¨åˆæ³•æˆæƒçš„ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•**ã€‚
- **å°Šé‡ç”¨æˆ·éšç§**ï¼Œä¸è¦æ³„éœ²ç”¨æˆ·æ•°æ®ã€‚
- **éµå®ˆæ³•å¾‹æ³•è§„**ï¼Œé¿å…éæ³•æ´»åŠ¨ã€‚

{% endtab %}
```objectivec
// 1. create AccessControl object that will represent authentication settings
CFErrorRef *err = nil;

SecAccessControlRef sacRef = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
kSecAccessControlUserPresence,
err);

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute
NSDictionary* query = @{
(_ _bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecAttrAccount: @"OWASP Account",
(__bridge id)kSecValueData: [@"test_strong_password" dataUsingEncoding:NSUTF8StringEncoding],
(__bridge id)kSecAttrAccessControl: (__bridge_transfer id)sacRef
};

// 3. save item
OSStatus status = SecItemAdd((__bridge CFDictionaryRef)query, nil);

if (status == noErr) {
// successfully saved
} else {
// error while saving
}
```
{% endtab %}
{% endtabs %}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»é’¥åŒ™ä¸²ä¸­è¯·æ±‚ä¿å­˜çš„é¡¹ç›®ã€‚é’¥åŒ™ä¸²æœåŠ¡å°†å‘ç”¨æˆ·æ˜¾ç¤ºèº«ä»½éªŒè¯å¯¹è¯æ¡†ï¼Œå¹¶æ ¹æ®æ˜¯å¦æä¾›äº†åˆé€‚çš„æŒ‡çº¹æ¥è¿”å›æ•°æ®æˆ–nilã€‚
```swift
// 1. define query
var query = [String: Any]()
query[kSecClass as String] = kSecClassGenericPassword
query[kSecReturnData as String] = kCFBooleanTrue
query[kSecAttrAccount as String] = "My Name" as CFString
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecUseOperationPrompt as String] = "Please, pass authorisation to enter this area" as CFString

// 2. get item
var queryResult: AnyObject?
let status = withUnsafeMutablePointer(to: &queryResult) {
SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
}

if status == noErr {
let password = String(data: queryResult as! Data, encoding: .utf8)!
// successfully received password
} else {
// authorization not passed
}
```
{% endtab %}

{% tab title="Objective-C" %}

## Objective-C

### ä¸ºä»€ä¹ˆè¦å…³æ³¨Objective-C

Objective-Cæ˜¯iOSåº”ç”¨ç¨‹åºçš„ä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼Œå› æ­¤äº†è§£å¦‚ä½•åˆ†æå’Œä¿®æ”¹Objective-Cä»£ç å¯¹äºiOSæ¸—é€æµ‹è¯•è‡³å…³é‡è¦ã€‚Objective-Cä»£ç å®¡è®¡å¯ä»¥å¸®åŠ©å‘ç°åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´å’Œå®‰å…¨é—®é¢˜ã€‚

### Objective-Cä»£ç å®¡è®¡å·¥å…·

åœ¨iOSæ¸—é€æµ‹è¯•æœŸé—´ï¼Œä»¥ä¸‹å·¥å…·å¯ç”¨äºåˆ†æObjective-Cä»£ç ï¼š

- **class-dump**: ç”¨äºä»Mach-Oæ–‡ä»¶ä¸­æå–Objective-Cç±»å’Œæ–¹æ³•çš„ä¿¡æ¯ã€‚
- **Hopper**: ç”¨äºåæ±‡ç¼–ã€åˆ†æå’Œä¿®æ”¹Objective-Cä»£ç ã€‚
- **IDA Pro**: ç”¨äºé™æ€åˆ†æiOSåº”ç”¨ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…æ‹¬Objective-Cä»£ç ã€‚

### Objective-Cä»£ç å®¡è®¡æŠ€å·§

åœ¨è¿›è¡ŒObjective-Cä»£ç å®¡è®¡æ—¶ï¼Œå¯ä»¥å…³æ³¨ä»¥ä¸‹æ–¹é¢ï¼š

- **æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç **: æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨ç¡¬ç¼–ç çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚APIå¯†é’¥ã€å¯†ç ç­‰ã€‚
- **ä¸å®‰å…¨çš„å‡½æ•°**: æŸ¥æ‰¾ä½¿ç”¨ä¸å®‰å…¨å‡½æ•°çš„åœ°æ–¹ï¼Œå¦‚strcpyã€strcatç­‰ã€‚
- **é€†å‘å·¥ç¨‹**: ä½¿ç”¨åæ±‡ç¼–å·¥å…·åˆ†æåº”ç”¨ç¨‹åºçš„é€»è¾‘å’Œæ•°æ®æµã€‚
- **æ¼æ´åˆ©ç”¨**: å¯»æ‰¾æ½œåœ¨çš„æ¼æ´å¹¶å°è¯•åˆ©ç”¨å®ƒä»¬ã€‚

{% endtab %}
```objectivec
// 1. define query
NSDictionary *query = @{(__bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecReturnData: @YES,
(__bridge id)kSecAttrAccount: @"My Name1",
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecUseOperationPrompt: @"Please, pass authorisation to enter this area" };

// 2. get item
CFTypeRef queryResult = NULL;
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)query, &queryResult);

if (status == noErr){
NSData* resultData = ( __bridge_transfer NSData* )queryResult;
NSString* password = [[NSString alloc] initWithData:resultData encoding:NSUTF8StringEncoding];
NSLog(@"%@", password);
} else {
NSLog(@"Something went wrong");
}
```
### æ£€æµ‹

åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„æ¡†æ¶è¿˜å¯ä»¥é€šè¿‡åˆ†æåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶çš„å…±äº«åŠ¨æ€åº“åˆ—è¡¨æ¥æ£€æµ‹ã€‚å¯ä»¥ä½¿ç”¨ `otool` æ¥å®Œæˆæ­¤æ“ä½œï¼š
```bash
$ otool -L <AppName>.app/<AppName>
```
å¦‚æœåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `LocalAuthentication.framework`ï¼Œè¾“å‡ºå°†åŒ…å«ä»¥ä¸‹ä¸¤è¡Œï¼ˆè¯·è®°ä½ `LocalAuthentication.framework` åœ¨åº•å±‚ä½¿ç”¨ `Security.framework`ï¼‰:
```bash
/System/Library/Frameworks/LocalAuthentication.framework/LocalAuthentication
/System/Library/Frameworks/Security.framework/Security
```
å¦‚æœä½¿ç”¨`Security.framework`ï¼Œåªä¼šæ˜¾ç¤ºç¬¬äºŒä¸ªã€‚

### æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶ç»•è¿‡

#### **Objection**

é€šè¿‡**Objectionç”Ÿç‰©è¯†åˆ«ç»•è¿‡**ï¼Œä½äº[æ­¤GitHubé¡µé¢](https://github.com/sensepost/objection/wiki/Understanding-the-iOS-Biometrics-Bypass)ï¼Œæä¾›äº†ä¸€ç§æŠ€æœ¯æ¥ç»•è¿‡**LocalAuthentication**æœºåˆ¶ã€‚è¯¥æ–¹æ³•çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨**Frida**æ¥æ“çºµ`evaluatePolicy`å‡½æ•°ï¼Œç¡®ä¿å®ƒå§‹ç»ˆäº§ç”Ÿ`True`ç»“æœï¼Œè€Œä¸è€ƒè™‘å®é™…çš„èº«ä»½éªŒè¯æˆåŠŸä¸å¦ã€‚è¿™å¯¹äºè§„é¿å­˜åœ¨ç¼ºé™·çš„ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯æµç¨‹ç‰¹åˆ«æœ‰ç”¨ã€‚

è¦æ¿€æ´»æ­¤ç»•è¿‡ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios ui biometrics_bypass
(agent) Registering job 3mhtws9x47q. Type: ios-biometrics-disable
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # (agent) [3mhtws9x47q] Localized Reason for auth requirement: Please authenticate yourself
(agent) [3mhtws9x47q] OS authentication response: false
(agent) [3mhtws9x47q] Marking OS response as True instead
(agent) [3mhtws9x47q] Biometrics bypass hook complete
```
è¿™ä¸ªå‘½ä»¤å¯åŠ¨ä¸€ä¸ªåºåˆ—ï¼ŒObjectionæ³¨å†Œä¸€ä¸ªä»»åŠ¡ï¼Œæœ‰æ•ˆåœ°æ”¹å˜äº†`evaluatePolicy`æ£€æŸ¥çš„ç»“æœä¸º`True`ã€‚

#### Frida

æ¥è‡ª[DVIA-v2åº”ç”¨ç¨‹åº](https://github.com/prateek147/DVIA-v2)ä¸­ä½¿ç”¨**`evaluatePolicy`**çš„ç¤ºä¾‹ï¼š
```swift
+(void)authenticateWithTouchID {
LAContext *myContext = [[LAContext alloc] init];
NSError *authError = nil;
NSString *myLocalizedReasonString = @"Please authenticate yourself";

if ([myContext canEvaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics error:&authError]) {
[myContext evaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics
localizedReason:myLocalizedReasonString
reply:^(BOOL success, NSError *error) {
if (success) {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Successful" withTitle:@"Success"];
});
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Failed !" withTitle:@"Error"];
});
}
}];
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Your device doesn't support Touch ID or you haven't configured Touch ID authentication on your device" withTitle:@"Error"];
});
}
}
```
ä¸ºäº†å®ç°æœ¬åœ°è®¤è¯çš„**ç»•è¿‡**ï¼Œç¼–å†™äº†ä¸€ä¸ª Frida è„šæœ¬ã€‚è¯¥è„šæœ¬é’ˆå¯¹**evaluatePolicy**æ£€æŸ¥ï¼Œæ‹¦æˆªå…¶å›è°ƒä»¥ç¡®ä¿å…¶è¿”å›**success=1**ã€‚é€šè¿‡æ”¹å˜å›è°ƒçš„è¡Œä¸ºï¼Œè®¤è¯æ£€æŸ¥è¢«æœ‰æ•ˆåœ°ç»•è¿‡ã€‚

ä¸‹é¢çš„è„šæœ¬è¢«æ³¨å…¥ä»¥ä¿®æ”¹**evaluatePolicy**æ–¹æ³•çš„ç»“æœã€‚å®ƒå°†å›è°ƒçš„ç»“æœæ›´æ”¹ä¸ºå§‹ç»ˆæŒ‡ç¤ºæˆåŠŸã€‚
```swift
// from https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/
if(ObjC.available) {
console.log("Injecting...");
var hook = ObjC.classes.LAContext["- evaluatePolicy:localizedReason:reply:"];
Interceptor.attach(hook.implementation, {
onEnter: function(args) {
var block = new ObjC.Block(args[4]);
const callback = block.implementation;
block.implementation = function (error, value)  {

console.log("Changing the result value to true")
const result = callback(1, null);
return result;
};
},
});
} else {
console.log("Objective-C Runtime is not available!");
}
```
è¦æ³¨å…¥Fridaè„šæœ¬å¹¶ç»•è¿‡ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
frida -U -f com.highaltitudehacks.DVIAswiftv2 --no-pause -l fingerprint-bypass-ios.js
```
## é€šè¿‡IPCæš´éœ²æ•æ„ŸåŠŸèƒ½

### è‡ªå®šä¹‰URIå¤„ç†ç¨‹åº / Deeplinks / è‡ªå®šä¹‰æ–¹æ¡ˆ

{% content-ref url="ios-custom-uri-handlers-deeplinks-custom-schemes.md" %}
[ios-custom-uri-handlers-deeplinks-custom-schemes.md](ios-custom-uri-handlers-deeplinks-custom-schemes.md)
{% endcontent-ref %}

### é€šç”¨é“¾æ¥

{% content-ref url="ios-universal-links.md" %}
[ios-universal-links.md](ios-universal-links.md)
{% endcontent-ref %}

### UIActivityå…±äº«

{% content-ref url="ios-uiactivity-sharing.md" %}
[ios-uiactivity-sharing.md](ios-uiactivity-sharing.md)
{% endcontent-ref %}

### UIPasteboard

{% content-ref url="ios-uipasteboard.md" %}
[ios-uipasteboard.md](ios-uipasteboard.md)
{% endcontent-ref %}

### åº”ç”¨æ‰©å±•

{% content-ref url="ios-app-extensions.md" %}
[ios-app-extensions.md](ios-app-extensions.md)
{% endcontent-ref %}

### WebViews

{% content-ref url="ios-webviews.md" %}
[ios-webviews.md](ios-webviews.md)
{% endcontent-ref %}

### åºåˆ—åŒ–å’Œç¼–ç 

{% content-ref url="ios-serialisation-and-encoding.md" %}
[ios-serialisation-and-encoding.md](ios-serialisation-and-encoding.md)
{% endcontent-ref %}

## ç½‘ç»œé€šä¿¡

é‡è¦çš„æ˜¯æ£€æŸ¥æ˜¯å¦å‘ç”Ÿ**æœªåŠ å¯†**çš„é€šä¿¡ï¼Œä»¥åŠåº”ç”¨ç¨‹åºæ˜¯å¦æ­£ç¡®**éªŒè¯æœåŠ¡å™¨çš„TLSè¯ä¹¦**ã€‚\
è¦æ£€æŸ¥è¿™ç±»é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åƒ**Burp**è¿™æ ·çš„ä»£ç†ï¼š

{% content-ref url="burp-configuration-for-ios.md" %}
[burp-configuration-for-ios.md](burp-configuration-for-ios.md)
{% endcontent-ref %}

### ä¸»æœºåæ£€æŸ¥

éªŒè¯TLSè¯ä¹¦çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯æ£€æŸ¥è¯ä¹¦æ˜¯å¦ç”±**å—ä¿¡ä»»çš„CA**ç­¾åï¼Œä½†**æœªæ£€æŸ¥**è¯ä¹¦çš„**ä¸»æœºå**æ˜¯å¦ä¸ºæ­£åœ¨è®¿é—®çš„ä¸»æœºåã€‚\
ä¸ºäº†ä½¿ç”¨Burpæ£€æŸ¥æ­¤é—®é¢˜ï¼Œåœ¨iPhoneä¸Šä¿¡ä»»Burp CAåï¼Œæ‚¨å¯ä»¥**ä¸ºä¸åŒä¸»æœºåä½¿ç”¨Burpåˆ›å»ºæ–°è¯ä¹¦**å¹¶ä½¿ç”¨å®ƒã€‚å¦‚æœåº”ç”¨ç¨‹åºä»ç„¶æ­£å¸¸å·¥ä½œï¼Œåˆ™å­˜åœ¨æ¼æ´ã€‚

### è¯ä¹¦å›ºå®š

å¦‚æœåº”ç”¨ç¨‹åºæ­£ç¡®ä½¿ç”¨SSL Pinningï¼Œåˆ™åº”ç”¨ç¨‹åºä»…åœ¨è¯ä¹¦ç¬¦åˆé¢„æœŸæ—¶æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨æµ‹è¯•åº”ç”¨ç¨‹åºæ—¶ï¼Œ**è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºBurpå°†æä¾›è‡ªå·±çš„è¯ä¹¦ã€‚**\
ä¸ºäº†ç»•è¿‡æ­¤ä¿æŠ¤ï¼Œåœ¨è¶Šç‹±è®¾å¤‡å†…éƒ¨ï¼Œæ‚¨å¯ä»¥å®‰è£…åº”ç”¨ç¨‹åº[**SSL Kill Switch**](https://github.com/nabla-c0d3/ssl-kill-switch2)æˆ–å®‰è£…[Burp Mobile Assistant](https://portswigger.net/burp/documentation/desktop/mobile/config-ios-device)

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**objection**çš„`ios sslpinning disable`

## æ‚é¡¹

* åœ¨**`/System/Library`**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æ‰‹æœºä¸Šç³»ç»Ÿåº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¡†æ¶
* ç”¨æˆ·ä»App Storeå®‰è£…çš„åº”ç”¨ç¨‹åºä½äº**`/User/Applications`**ä¸­
* **`/User/Library`**åŒ…å«ç”¨æˆ·çº§åº”ç”¨ç¨‹åºä¿å­˜çš„æ•°æ®
* æ‚¨å¯ä»¥è®¿é—®**`/User/Library/Notes/notes.sqlite`**ä»¥é˜…è¯»åº”ç”¨ç¨‹åºå†…ä¿å­˜çš„ç¬”è®°ã€‚
* åœ¨å·²å®‰è£…åº”ç”¨ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸­ï¼ˆ**`/User/Applications/<APP ID>/`**ï¼‰ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰è¶£çš„æ–‡ä»¶ï¼š
* **`iTunesArtwork`**ï¼šåº”ç”¨ç¨‹åºä½¿ç”¨çš„å›¾æ ‡
* **`iTunesMetadata.plist`**ï¼šApp Storeä¸­ä½¿ç”¨çš„åº”ç”¨ç¨‹åºä¿¡æ¯
* **`/Library/*`**ï¼šåŒ…å«é¦–é€‰é¡¹å’Œç¼“å­˜ã€‚åœ¨**`/Library/Cache/Snapshots/*`**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å°†åº”ç”¨ç¨‹åºå‘é€åˆ°åå°ä¹‹å‰æ‰§è¡Œçš„å¿«ç…§ã€‚

### çƒ­ä¿®è¡¥/å¼ºåˆ¶æ›´æ–°

å¼€å‘äººå‘˜å¯ä»¥è¿œç¨‹**ç«‹å³ä¿®è¡¥å…¶åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å®‰è£…**ï¼Œè€Œæ— éœ€é‡æ–°æäº¤åº”ç”¨ç¨‹åºåˆ°App Storeå¹¶ç­‰å¾…æ‰¹å‡†ã€‚\
ä¸ºæ­¤é€šå¸¸ä½¿ç”¨[JSPatch](https://github.com/bang590/JSPatch)**ã€‚** ä½†ä¹Ÿæœ‰å…¶ä»–é€‰é¡¹ï¼Œå¦‚[Siren](https://github.com/ArtSabintsev/Siren)å’Œ[react-native-appstore-version-checker](https://www.npmjs.com/package/react-native-appstore-version-checker)ã€‚\
**è¿™æ˜¯ä¸€ç§å±é™©çš„æœºåˆ¶ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„ç¬¬ä¸‰æ–¹SDKæ»¥ç”¨ï¼Œå› æ­¤å»ºè®®æ£€æŸ¥ä½¿ç”¨å“ªç§æ–¹æ³•è¿›è¡Œè‡ªåŠ¨æ›´æ–°ï¼ˆå¦‚æœæœ‰ï¼‰å¹¶è¿›è¡Œæµ‹è¯•ã€‚** æ‚¨å¯ä»¥å°è¯•ä¸‹è½½åº”ç”¨ç¨‹åºçš„å…ˆå‰ç‰ˆæœ¬ä»¥è¿›è¡Œæ­¤ç›®çš„ã€‚

### ç¬¬ä¸‰æ–¹

**ç¬¬ä¸‰æ–¹SDK**çš„ä¸€ä¸ªé‡è¦æŒ‘æˆ˜æ˜¯å¯¹å…¶åŠŸèƒ½çš„**ç¼ºä¹ç»†ç²’åº¦æ§åˆ¶**ã€‚å¼€å‘äººå‘˜é¢ä¸´é€‰æ‹©ï¼šè¦ä¹ˆé›†æˆSDKå¹¶æ¥å—å…¶æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ½œåœ¨çš„å®‰å…¨æ¼æ´å’Œéšç§é—®é¢˜ï¼Œè¦ä¹ˆå®Œå…¨æ”¾å¼ƒå…¶ä¼˜åŠ¿ã€‚é€šå¸¸ï¼Œå¼€å‘äººå‘˜æ— æ³•è‡ªè¡Œä¿®è¡¥è¿™äº›SDKä¸­çš„æ¼æ´ã€‚æ­¤å¤–ï¼Œéšç€SDKåœ¨ç¤¾åŒºä¸­è·å¾—ä¿¡ä»»ï¼Œä¸€äº›å¯èƒ½å¼€å§‹åŒ…å«æ¶æ„è½¯ä»¶ã€‚

ç¬¬ä¸‰æ–¹SDKæä¾›çš„æœåŠ¡å¯èƒ½åŒ…æ‹¬ç”¨æˆ·è¡Œä¸ºè·Ÿè¸ªã€å¹¿å‘Šæ˜¾ç¤ºæˆ–ç”¨æˆ·ä½“éªŒå¢å¼ºã€‚ç„¶è€Œï¼Œè¿™å¸¦æ¥äº†é£é™©ï¼Œå› ä¸ºå¼€å‘äººå‘˜å¯èƒ½å¹¶ä¸å®Œå…¨äº†è§£è¿™äº›åº“æ‰§è¡Œçš„ä»£ç ï¼Œä»è€Œå¯¼è‡´æ½œåœ¨çš„éšç§å’Œå®‰å…¨é£é™©ã€‚é™åˆ¶ä¸ç¬¬ä¸‰æ–¹æœåŠ¡å…±äº«çš„ä¿¡æ¯è‡³å¿…è¦å†…å®¹ï¼Œå¹¶ç¡®ä¿ä¸ä¼šæ³„éœ²æ•æ„Ÿæ•°æ®ï¼Œè¿™ä¸€ç‚¹è‡³å…³é‡è¦ã€‚

ç¬¬ä¸‰æ–¹æœåŠ¡çš„å®æ–½é€šå¸¸æœ‰ä¸¤ç§å½¢å¼ï¼šç‹¬ç«‹åº“æˆ–å®Œæ•´SDKã€‚ä¸ºäº†ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œä¸è¿™äº›æœåŠ¡å…±äº«çš„ä»»ä½•æ•°æ®éƒ½åº”**åŒ¿ååŒ–**ï¼Œä»¥é˜²æ­¢æ³„éœ²ä¸ªäººå¯è¯†åˆ«ä¿¡æ¯ï¼ˆPIIï¼‰ã€‚

è¦è¯†åˆ«åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“ï¼Œå¯ä»¥ä½¿ç”¨**`otool`**å‘½ä»¤ã€‚åº”è¯¥é’ˆå¯¹åº”ç”¨ç¨‹åºåŠå…¶ä½¿ç”¨çš„æ¯ä¸ªå…±äº«åº“è¿è¡Œæ­¤å·¥å…·ï¼Œä»¥å‘ç°å…¶ä»–åº“ã€‚
```bash
otool -L <application_path>
```
## **å‚è€ƒèµ„æ–™å’Œæ›´å¤šèµ„æº**

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering)
* [iOS & ç§»åŠ¨åº”ç”¨æ¸—é€æµ‹è¯• - INE](https://my.ine.com/CyberSecurity/courses/089d060b/ios-mobile-app-pentesting)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0057/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0057/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0058/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0058/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0059/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0059/)
* [https://mas.owasp.org/MASTG/iOS/0x06d-Testing-Data-Storage](https://mas.owasp.org/MASTG/iOS/0x06d-Testing-Data-Storage)
* [https://coderwall.com/p/kjb3lw/storing-password-in-keychain-the-smart-way](https://coderwall.com/p/kjb3lw/storing-password-in-keychain-the-smart-way)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0055/](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0055/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0053](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0053)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0060/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0060/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0058](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0058)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0060](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0060)
* [https://mas.owasp.org/MASTG/Android/0x05f-Testing-Local-Authentication/](https://mas.owasp.org/MASTG/Android/0x05f-Testing-Local-Authentication/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-AUTH/MASTG-TEST-0064](https://mas.owasp.org/MASTG/tests/ios/MASVS-AUTH/MASTG-TEST-0064)
* [https://medium.com/securing/bypassing-your-apps-biometric-checks-on-ios-c2555c81a2dc](https://medium.com/securing/bypassing-your-apps-biometric-checks-on-ios-c2555c81a2dc)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0054](https://mas.owasp.org/MASTG/tests/ios/MASVS-STORAGE/MASTG-TEST-0054)
* [https://github.com/ivRodriguezCA/RE-iOS-Apps/](https://github.com/ivRodriguezCA/RE-iOS-Apps/) IOS å…è´¹è¯¾ç¨‹([https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/](https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/))
* [https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577](https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577)
* [https://www.slideshare.net/RyanISI/ios-appsecurityminicourse](https://www.slideshare.net/RyanISI/ios-appsecurityminicourse)
* [https://github.com/prateek147/DVIA](https://github.com/prateek147/DVIA)
* [https://github.com/prateek147/DVIA-v2](https://github.com/prateek147/DVIA-v2)
* [https://github.com/OWASP/MSTG-Hacking-Playground%20](https://github.com/OWASP/MSTG-Hacking-Playground)
* OWASP iGoat [_https://github.com/OWASP/igoat_](https://github.com/OWASP/igoat) <<< Objective-C ç‰ˆæœ¬ [_https://github.com/OWASP/iGoat-Swift_](https://github.com/OWASP/iGoat-Swift) <<< Swift ç‰ˆæœ¬
* [https://github.com/authenticationfailure/WheresMyBrowser.iOS](https://github.com/authenticationfailure/WheresMyBrowser.iOS)
* [https://github.com/nabla-c0d3/ssl-kill-switch2](https://github.com/nabla-c0d3/ssl-kill-switch2)

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) å¯ä»¥è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨å…¨çƒ **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„ **å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢ [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFT**](https://opensea.io/collection/the-peass-family) æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
