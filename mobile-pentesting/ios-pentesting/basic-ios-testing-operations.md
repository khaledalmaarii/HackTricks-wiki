# iOS Temel Test Ä°ÅŸlemleri

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## **iOS Cihaz Kimliklendirme ve EriÅŸim Ã–zeti**

### **Bir iOS CihazÄ±nÄ±n UDID'sini Belirleme**

Bir iOS cihazÄ±nÄ± benzersiz bir ÅŸekilde tanÄ±mlamak iÃ§in UDID olarak bilinen 40 haneli bir dizi kullanÄ±lÄ±r. macOS Catalina veya daha yeni sÃ¼rÃ¼mlerde, iTunes artÄ±k mevcut olmadÄ±ÄŸÄ±ndan, bunu **Finder uygulamasÄ±nda** bulabilirsiniz. Cihaz, USB aracÄ±lÄ±ÄŸÄ±yla baÄŸlandÄ±ÄŸÄ±nda ve Finder'da seÃ§ildiÄŸinde, adÄ±nÄ±n altÄ±ndaki ayrÄ±ntÄ±lar tÄ±klanarak UDID'sini diÄŸer bilgilerle birlikte ortaya koyar.

Catalina'dan Ã¶nceki macOS sÃ¼rÃ¼mleri iÃ§in, UDID'nin keÅŸfedilmesini iTunes kolaylaÅŸtÄ±rÄ±r. DetaylÄ± talimatlar [burada](http://www.iclarified.com/52179/how-to-find-your-iphones-udid) bulunabilir.

Komut satÄ±rÄ± araÃ§larÄ±, UDID'nin alÄ±nmasÄ± iÃ§in alternatif yÃ¶ntemler sunar:

* **I/O Registry Explorer aracÄ±nÄ± kullanarak `ioreg`:**
```bash
$ ioreg -p IOUSB -l | grep "USB Serial"
```
* **`ideviceinstaller`'Ä± macOS (ve Linux) iÃ§in kullanma:**
```bash
$ brew install ideviceinstaller
$ idevice_id -l
```
* **`system_profiler` kullanÄ±mÄ±:**
```bash
$ system_profiler SPUSBDataType | sed -n -e '/iPad/,/Serial/p;/iPhone/,/Serial/p;/iPod/,/Serial/p' | grep "Serial Number:"
```
* **CihazlarÄ± listelemek iÃ§in `instruments` kullanma:**
```bash
$ instruments -s devices
```
### **Cihaz KabuÄŸuna EriÅŸim**

**SSH eriÅŸimi**, **OpenSSH paketi**nin jailbreak sonrasÄ± yÃ¼klenmesiyle etkinleÅŸtirilir ve `ssh root@<cihaz_ip_adresi>` Ã¼zerinden baÄŸlantÄ± saÄŸlanÄ±r. CihazÄ± gÃ¼vence altÄ±na almak iÃ§in `root` ve `mobile` kullanÄ±cÄ±larÄ± iÃ§in varsayÄ±lan ÅŸifreleri (`alpine`) deÄŸiÅŸtirmek Ã¶nemlidir.

**USB Ã¼zerinden SSH** eriÅŸimi, Wi-Fi olmadÄ±ÄŸÄ±nda `iproxy` kullanÄ±larak cihaz baÄŸlantÄ± noktalarÄ±nÄ±n SSH baÄŸlantÄ±larÄ± iÃ§in eÅŸlenmesini gerektirir. Bu yapÄ±landÄ±rma, USB Ã¼zerinden SSH eriÅŸimini saÄŸlamak iÃ§in aÅŸaÄŸÄ±daki komutun Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±nÄ± saÄŸlar:
```bash
$ iproxy 2222 22
$ ssh -p 2222 root@localhost
```
**Cihaz Ã¼zerindeki kabuk uygulamalarÄ±**, Ã¶zellikle sorun giderme iÃ§in doÄŸrudan cihaz etkileÅŸimi saÄŸlar. **Ters SSH kabuklarÄ±**, uzaktan eriÅŸim iÃ§in ana bilgisayardan da kurulabilir.

### **Unutulan Åifreleri SÄ±fÄ±rlama**

Unutulan bir ÅŸifreyi varsayÄ±lan (`alpine`) ÅŸifreye sÄ±fÄ±rlamak iÃ§in `/private/etc/master.passwd` dosyasÄ±nÄ± dÃ¼zenlemek gereklidir. Bu, mevcut karma yerine `root` ve `mobile` kullanÄ±cÄ± giriÅŸlerinin yanÄ±na `alpine` iÃ§in karma yerleÅŸtirilerek yapÄ±lÄ±r.

## **Veri Transfer Teknikleri**

### **Uygulama Veri DosyalarÄ±nÄ±n Transferi**

**SSH ve SCP AracÄ±lÄ±ÄŸÄ±yla ArÅŸivleme ve Geri Alma:** UygulamanÄ±n Veri dizinini `tar` kullanarak arÅŸivlemek ve ardÄ±ndan `scp` kullanarak transfer etmek oldukÃ§a basittir. AÅŸaÄŸÄ±daki komut, Veri dizinini .tgz dosyasÄ±na arÅŸivler ve ardÄ±ndan cihazdan Ã§eker:
```bash
tar czvf /tmp/data.tgz /private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693
exit
scp -P 2222 root@localhost:/tmp/data.tgz .
```
### **Grafik KullanÄ±cÄ± ArayÃ¼zÃ¼ AraÃ§larÄ±**

**iFunbox ve iExplorer KullanÄ±mÄ±:** Bu GUI araÃ§larÄ±, iOS cihazlardaki dosyalarÄ± yÃ¶netmek iÃ§in kullanÄ±ÅŸlÄ±dÄ±r. Ancak, iOS 8.4 ile baÅŸlayarak, Apple bu araÃ§larÄ±n uygulama sandbox'Ä±na eriÅŸimini kÄ±sÄ±tladÄ±, ancak cihaz jailbreak yapÄ±lmÄ±ÅŸsa eriÅŸim saÄŸlanabilir.

### **Dosya YÃ¶netimi iÃ§in Objection KullanÄ±mÄ±**

**Objection ile EtkileÅŸimli Kabuk:** Objection'Ä± baÅŸlatmak, bir uygulamanÄ±n Bundle dizinine eriÅŸim saÄŸlar. Buradan, uygulamanÄ±n Documents dizinine giderek dosyalarÄ± yÃ¶netebilir, iOS cihazÄ±na dosya indirebilir ve yÃ¼kleyebilirsiniz.
```bash
objection --gadget com.apple.mobilesafari explorer
cd /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents
file download <filename>
```
## **UygulamalarÄ±n Elde Edilmesi ve Ã‡Ä±karÄ±lmasÄ±**

### **IPA DosyasÄ±nÄ±n Edinilmesi**

**Over-The-Air (OTA) DaÄŸÄ±tÄ±m BaÄŸlantÄ±sÄ±:** OTA ile test iÃ§in daÄŸÄ±tÄ±lan uygulamalar, ITMS hizmetleri varlÄ±k indirme aracÄ± kullanÄ±larak indirilebilir. Bu araÃ§ npm aracÄ±lÄ±ÄŸÄ±yla yÃ¼klenir ve IPA dosyasÄ±nÄ± yerel olarak kaydetmek iÃ§in kullanÄ±lÄ±r.
```bash
npm install -g itms-services
itms-services -u "itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist" -o - > out.ipa
```
### **Uygulama Ä°kili DosyasÄ±nÄ± Ã‡Ä±karma**

1. **Bir IPA'dan:** IPA'yÄ± aÃ§arak ÅŸifresi Ã§Ã¶zÃ¼lmÃ¼ÅŸ uygulama ikili dosyasÄ±na eriÅŸin.
2. **Jailbreak YapÄ±lmÄ±ÅŸ Bir Cihazdan:** UygulamayÄ± yÃ¼kleyin ve bellekten ÅŸifresi Ã§Ã¶zÃ¼lmÃ¼ÅŸ ikili dosyayÄ± Ã§Ä±karÄ±n.

### **Åifre Ã‡Ã¶zme SÃ¼reci**

**Manuel Åifre Ã‡Ã¶zme Genel BakÄ±ÅŸÄ±:** iOS uygulama ikili dosyalarÄ± Apple tarafÄ±ndan FairPlay kullanÄ±larak ÅŸifrelenir. Tersine mÃ¼hendislik yapabilmek iÃ§in, ÅŸifresi Ã§Ã¶zÃ¼lmÃ¼ÅŸ ikili dosyayÄ± bellekten Ã§Ä±karmak gerekir. Åifre Ã§Ã¶zme sÃ¼reci, PIE bayraÄŸÄ±nÄ±n kontrol edilmesini, bellek bayraklarÄ±nÄ±n ayarlanmasÄ±nÄ±, ÅŸifreli bÃ¶lÃ¼mÃ¼n belirlenmesini ve ardÄ±ndan bu bÃ¶lÃ¼mÃ¼n ÅŸifresi Ã§Ã¶zÃ¼lmÃ¼ÅŸ haliyle deÄŸiÅŸtirilmesini iÃ§erir.

**PIE BayraÄŸÄ±nÄ±n Kontrol Edilmesi ve DeÄŸiÅŸtirilmesi:**
```bash
otool -Vh Original_App
python change_macho_flags.py --no-pie Original_App
otool -Vh Hello_World
```
**Åifreli BÃ¶lÃ¼mÃ¼ TanÄ±mlama ve BelleÄŸi DÃ¶kme:**

`otool` kullanarak ÅŸifreli bÃ¶lÃ¼mÃ¼n baÅŸlangÄ±Ã§ ve bitiÅŸ adreslerini belirleyin ve gdb kullanarak jailbreak yapÄ±lmÄ±ÅŸ cihazdan belleÄŸi dÃ¶kÃ¼n.
```bash
otool -l Original_App | grep -A 4 LC_ENCRYPTION_INFO
dump memory dump.bin 0x8000 0x10a4000
```
**Åifreli BÃ¶lÃ¼mÃ¼ Ãœzerine Yazma:**

Orijinal uygulama ikili dosyasÄ±ndaki ÅŸifreli bÃ¶lÃ¼mÃ¼, ÅŸifresi Ã§Ã¶zÃ¼lmÃ¼ÅŸ veriyle deÄŸiÅŸtirin.
```bash
dd bs=1 seek=<starting_address> conv=notrunc if=dump.bin of=Original_App
```
**Åifre Ã‡Ã¶zÃ¼mÃ¼nÃ¼ Tamamlama:** `MachOView` gibi araÃ§larÄ± kullanarak, ÅŸifreleme olmadÄ±ÄŸÄ±nÄ± belirtmek iÃ§in ikili dosyanÄ±n meta verilerini deÄŸiÅŸtirin ve `cryptid` deÄŸerini 0 olarak ayarlayÄ±n.

### **Åifre Ã‡Ã¶zme (Otomatik)**
#### **frida-ios-dump**
[**frida-ios-dump**](https://github.com/AloneMonkey/frida-ios-dump) aracÄ±, iOS cihazlarÄ±ndan uygulamalarÄ±n otomatik olarak ÅŸifrelenmesini ve Ã§Ä±karÄ±lmasÄ±nÄ± saÄŸlamak iÃ§in kullanÄ±lÄ±r. Ä°lk olarak, `dump.py` dosyasÄ± iOS cihazÄ±na baÄŸlanacak ÅŸekilde yapÄ±landÄ±rÄ±lmalÄ±dÄ±r. Bu, **iproxy** aracÄ±lÄ±ÄŸÄ±yla localhost Ã¼zerinden 2222 numaralÄ± porta veya doÄŸrudan cihazÄ±n IP adresi ve portu Ã¼zerinden yapÄ±labilir.

Cihaza yÃ¼klenen uygulamalarÄ± listelemek iÃ§in aÅŸaÄŸÄ±daki komut kullanÄ±lÄ±r:
```bash
$ python dump.py -l
```
Belirli bir uygulamayÄ±, Ã¶rneÄŸin Telegram'Ä± dÃ¶kmek iÃ§in aÅŸaÄŸÄ±daki komut kullanÄ±lÄ±r:
```bash
$ python3 dump.py -u "root" -p "<PASSWORD>" ph.telegra.Telegraph
```
Bu komut, mevcut dizinde `Telegram.ipa` adlÄ± bir dosyanÄ±n oluÅŸturulmasÄ±yla sonuÃ§lanan uygulama dÃ¶kÃ¼mÃ¼nÃ¼ baÅŸlatÄ±r. Bu iÅŸlem, jailbreak yapÄ±lmÄ±ÅŸ cihazlar iÃ§in uygundur, Ã§Ã¼nkÃ¼ imzasÄ±z veya sahte imzalÄ± uygulamalar [**ios-deploy**](https://github.com/ios-control/ios-deploy) gibi araÃ§lar kullanÄ±larak yeniden yÃ¼klenebilir.

#### **flexdecrypt**
[**flexdecrypt**](https://github.com/JohnCoates/flexdecrypt) aracÄ± ve onun sarmalayÄ±cÄ±sÄ± [**flexdump**](https://gist.github.com/defparam/71d67ee738341559c35c684d659d40ac), yÃ¼klÃ¼ uygulamalardan IPA dosyalarÄ±nÄ±n Ã§Ä±karÄ±lmasÄ±nÄ± saÄŸlar. Cihazdaki **flexdecrypt** iÃ§in kurulum komutlarÄ±, `.deb` paketinin indirilip kurulmasÄ± iÃ§erir. AÅŸaÄŸÄ±daki komutlarda gÃ¶sterildiÄŸi gibi **flexdump**, uygulamalarÄ± listelemek ve dÃ¶kmek iÃ§in kullanÄ±labilir:
```bash
apt install zip unzip
wget https://gist.githubusercontent.com/defparam/71d67ee738341559c35c684d659d40ac/raw/30c7612262f1faf7871ba8e32fbe29c0f3ef9e27/flexdump -P /usr/local/bin; chmod +x /usr/local/bin/flexdump
flexdump list
flexdump dump Twitter.app
```
#### **bagbak**
[**bagbak**](https://github.com/ChiChou/bagbak), baÅŸka bir Frida tabanlÄ± araÃ§tÄ±r ve uygulama ÅŸifrelemesini Ã§Ã¶zmek iÃ§in jailbreak yapÄ±lmÄ±ÅŸ bir cihaz gerektirir:
```bash
bagbak --raw Chrome
```
#### **r2flutch**
**r2flutch**, radare ve frida'yÄ± kullanarak uygulama ÅŸifrelemesini ve dÃ¶kÃ¼mlemesini saÄŸlar. Daha fazla bilgiye [**GitHub sayfasÄ±nda**](https://github.com/as0ler/r2flutch) ulaÅŸÄ±labilir.

### **Uygulama Kurulumu**

**Sideloading**, resmi App Store dÄ±ÅŸÄ±nda uygulama kurulumunu ifade eder. Bu iÅŸlem **installd daemon** tarafÄ±ndan yÃ¶netilir ve uygulamalarÄ±n Apple tarafÄ±ndan verilen bir sertifika ile imzalanmasÄ± gerekmektedir. Jailbreak yapÄ±lmÄ±ÅŸ cihazlar, sahte imzalÄ± IPA paketlerinin kurulumunu mÃ¼mkÃ¼n kÄ±lan **AppSync** ile bu iÅŸlemi atlayabilir.

#### **Sideloading AraÃ§larÄ±**

- **Cydia Impactor**: iOS Ã¼zerinde IPA dosyalarÄ±nÄ±, Android Ã¼zerinde APK dosyalarÄ±nÄ± imzalamak ve kurmak iÃ§in bir araÃ§tÄ±r. KÄ±lavuzlar ve sorun giderme iÃ§in [yalujailbreak.net](https://yalujailbreak.net/how-to-use-cydia-impactor/) adresine bakabilirsiniz.

- **libimobiledevice**: Linux ve macOS iÃ§in iOS cihazlarla iletiÅŸim kurmak iÃ§in bir kÃ¼tÃ¼phanedir. UygulamalarÄ± USB Ã¼zerinden kurmak iÃ§in ideviceinstaller iÃ§in kurulum komutlarÄ± ve kullanÄ±m Ã¶rnekleri saÄŸlanmaktadÄ±r.

- **ipainstaller**: Bu komut satÄ±rÄ± aracÄ±, iOS cihazlara doÄŸrudan uygulama kurulumuna izin verir.

- **ios-deploy**: macOS kullanÄ±cÄ±larÄ± iÃ§in, ios-deploy komut satÄ±rÄ±ndan iOS uygulamalarÄ±nÄ± kurar. IPA dosyasÄ±nÄ± aÃ§mak ve doÄŸrudan uygulama baÅŸlatmak iÃ§in `-m` bayraÄŸÄ±nÄ± kullanmak bu sÃ¼recin bir parÃ§asÄ±dÄ±r.

- **Xcode**: UygulamalarÄ± kurmak iÃ§in Xcode'u kullanarak **Window/Devices and Simulators** bÃ¶lÃ¼mÃ¼ne gidin ve uygulamayÄ± **Installed Apps** bÃ¶lÃ¼mÃ¼ne ekleyin.

#### **iPad Olmayan Cihazlara Uygulama Kurulumuna Ä°zin Verme**
iPhone veya iPod touch cihazlara iPad'e Ã¶zgÃ¼ uygulamalarÄ± kurmak iÃ§in **Info.plist** dosyasÄ±ndaki **UIDeviceFamily** deÄŸeri **1** olarak deÄŸiÅŸtirilmelidir. Ancak, imza doÄŸrulama kontrolleri nedeniyle bu deÄŸiÅŸiklik IPA dosyasÄ±nÄ±n yeniden imzalanmasÄ±nÄ± gerektirir.

**Not**: Bu yÃ¶ntem, daha eski bir iPhone veya iPod touch kullanÄ±rken uygulamanÄ±n daha yeni iPad modellerine Ã¶zgÃ¼ yetenekler talep etmesi durumunda baÅŸarÄ±sÄ±z olabilir.



## Referanslar
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](ttps://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0052/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0052/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0053/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0053/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0054/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0054/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0056/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0056/)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github reposuna PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
