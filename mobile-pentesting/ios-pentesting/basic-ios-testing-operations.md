# iOS Temel Test OperasyonlarÄ±

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **iOS Cihaz TanÄ±mlama ve EriÅŸim Ã–zeti**

### **Bir iOS CihazÄ±nÄ±n UDID'sini TanÄ±mlama**

Bir iOS cihazÄ±nÄ± benzersiz bir ÅŸekilde tanÄ±mlamak iÃ§in, UDID olarak bilinen 40 haneli bir dizi kullanÄ±lÄ±r. macOS Catalina veya daha yenilerinde, bu **Finder uygulamasÄ±nda** bulunabilir, Ã§Ã¼nkÃ¼ iTunes artÄ±k mevcut deÄŸildir. Cihaz, USB ile baÄŸlandÄ±ÄŸÄ±nda ve Finder'da seÃ§ildiÄŸinde, adÄ± altÄ±ndaki detaylar tÄ±klandÄ±ÄŸÄ±nda UDID'sini diÄŸer bilgilerle birlikte gÃ¶sterir.

Catalina'dan Ã¶nceki macOS sÃ¼rÃ¼mlerinde, UDID'nin keÅŸfi iÃ§in iTunes yardÄ±mcÄ± olur. AyrÄ±ntÄ±lÄ± talimatlar [burada](http://www.iclarified.com/52179/how-to-find-your-iphones-udid) bulunabilir.

Komut satÄ±rÄ± araÃ§larÄ±, UDID'yi almak iÃ§in alternatif yÃ¶ntemler sunar:

* **I/O Registry Explorer aracÄ± `ioreg` kullanarak:**
```bash
$ ioreg -p IOUSB -l | grep "USB Serial"
```
* **`ideviceinstaller` kullanarak macOS (ve Linux) iÃ§in:**
```bash
$ brew install ideviceinstaller
$ idevice_id -l
```
* **`system_profiler` KullanÄ±mÄ±:**
```bash
$ system_profiler SPUSBDataType | sed -n -e '/iPad/,/Serial/p;/iPhone/,/Serial/p;/iPod/,/Serial/p' | grep "Serial Number:"
```
* **CihazlarÄ± listelemek iÃ§in `instruments` kullanma:**
```bash
$ instruments -s devices
```
### **Cihaza EriÅŸim Shell'i**

**SSH eriÅŸimi**, jailbreak sonrasÄ± **OpenSSH paketi** yÃ¼klenerek etkinleÅŸtirilir ve `ssh root@<device_ip_address>` Ã¼zerinden baÄŸlantÄ±lara izin verir. CihazÄ± gÃ¼vence altÄ±na almak iÃ§in `root` ve `mobile` kullanÄ±cÄ±larÄ± iÃ§in varsayÄ±lan ÅŸifrelerin (`alpine`) deÄŸiÅŸtirilmesi kritik Ã¶neme sahiptir.

**USB Ã¼zerinden SSH**, Wi-Fi yokluÄŸunda gereklidir ve SSH baÄŸlantÄ±larÄ± iÃ§in cihaz portlarÄ±nÄ± eÅŸlemek amacÄ±yla `iproxy` kullanÄ±lÄ±r. Bu kurulum, USB Ã¼zerinden SSH eriÅŸimi saÄŸlamak iÃ§in ÅŸu komutla Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r:
```bash
$ iproxy 2222 22
$ ssh -p 2222 root@localhost
```
**Cihaz iÃ§i shell uygulamalarÄ±**, NewTerm 2 gibi, doÄŸrudan cihaz etkileÅŸimini kolaylaÅŸtÄ±rÄ±r, bu da sorun giderme iÃ§in Ã¶zellikle faydalÄ±dÄ±r. **Ters SSH shell'leri** de ana bilgisayardan uzaktan eriÅŸim iÃ§in kurulabilir.

### **Unutulan Åifreleri SÄ±fÄ±rlama**

Unutulan bir ÅŸifreyi varsayÄ±lan (`alpine`) olarak sÄ±fÄ±rlamak iÃ§in, `/private/etc/master.passwd` dosyasÄ±nÄ± dÃ¼zenlemek gereklidir. Bu, mevcut hash'in `root` ve `mobile` kullanÄ±cÄ± giriÅŸlerinin yanÄ±ndaki `alpine` hash'i ile deÄŸiÅŸtirilmesini iÃ§erir.

## **Veri AktarÄ±m Teknikleri**

### **Uygulama Veri DosyalarÄ±nÄ± Aktarma**

**SSH ve SCP ile ArÅŸivleme ve Geri Alma:** UygulamanÄ±n Data dizinini `tar` kullanarak arÅŸivlemek ve ardÄ±ndan `scp` ile aktarmak oldukÃ§a basittir. AÅŸaÄŸÄ±daki komut, Data dizinini bir .tgz dosyasÄ±na arÅŸivler ve ardÄ±ndan cihazdan Ã§ekilir:
```bash
tar czvf /tmp/data.tgz /private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693
exit
scp -P 2222 root@localhost:/tmp/data.tgz .
```
### **Grafiksel KullanÄ±cÄ± ArayÃ¼zÃ¼ AraÃ§larÄ±**

**iFunbox ve iExplorer KullanÄ±mÄ±:** Bu GUI araÃ§larÄ±, iOS cihazlarÄ±ndaki dosyalarÄ± yÃ¶netmek iÃ§in faydalÄ±dÄ±r. Ancak, iOS 8.4 ile birlikte, Apple bu araÃ§larÄ±n uygulama sandbox'una eriÅŸimini kÄ±sÄ±tladÄ±, cihaz jailbreak edilmedikÃ§e.

### **Dosya YÃ¶netimi iÃ§in Objection KullanÄ±mÄ±**

**Objection ile EtkileÅŸimli Shell:** Objection'Ä± baÅŸlatmak, bir uygulamanÄ±n Bundle dizinine eriÅŸim saÄŸlar. Buradan, uygulamanÄ±n Belgeler dizinine geÃ§ebilir ve dosyalarÄ± yÃ¶netebilir, bunlarÄ± iOS cihazÄ±na indirme ve yÃ¼kleme iÅŸlemlerini gerÃ§ekleÅŸtirebilirsiniz.
```bash
objection --gadget com.apple.mobilesafari explorer
cd /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents
file download <filename>
```
## **UygulamalarÄ± Elde Etme ve Ã‡Ä±karma**

### **IPA DosyasÄ±nÄ± Elde Etme**

**Hava Ãœzerinden (OTA) DaÄŸÄ±tÄ±m BaÄŸlantÄ±sÄ±:** Test iÃ§in OTA Ã¼zerinden daÄŸÄ±tÄ±lan uygulamalar, npm aracÄ±lÄ±ÄŸÄ±yla kurulan ve IPA dosyasÄ±nÄ± yerel olarak kaydetmek iÃ§in kullanÄ±lan ITMS hizmetleri varlÄ±k indirme aracÄ± ile indirilebilir.
```bash
npm install -g itms-services
itms-services -u "itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist" -o - > out.ipa
```
### **Uygulama Ä°kili DosyasÄ±nÄ± Ã‡Ä±karma**

1. **Bir IPA'dan:** ÅifrelenmemiÅŸ uygulama ikili dosyasÄ±na eriÅŸmek iÃ§in IPA'yÄ± aÃ§Ä±n.
2. **KÄ±rÄ±lmÄ±ÅŸ Bir Cihazdan:** UygulamayÄ± yÃ¼kleyin ve ÅŸifrelenmemiÅŸ ikili dosyayÄ± bellekten Ã§Ä±karÄ±n.

### **Åifre Ã‡Ã¶zme SÃ¼reci**

**Manuel Åifre Ã‡Ã¶zme Genel BakÄ±ÅŸ:** iOS uygulama ikili dosyalarÄ± Apple tarafÄ±ndan FairPlay kullanÄ±larak ÅŸifrelenmiÅŸtir. Ters mÃ¼hendislik yapmak iÃ§in, ÅŸifrelenmemiÅŸ ikili dosyayÄ± bellekten dÃ¶kmek gerekir. Åifre Ã§Ã¶zme sÃ¼reci, PIE bayraÄŸÄ±nÄ± kontrol etmeyi, bellek bayraklarÄ±nÄ± ayarlamayÄ±, ÅŸifrelenmiÅŸ bÃ¶lÃ¼mÃ¼ tanÄ±mlamayÄ± ve ardÄ±ndan bu bÃ¶lÃ¼mÃ¼ ÅŸifrelenmemiÅŸ haliyle deÄŸiÅŸtirmeyi iÃ§erir.

**PIE BayraÄŸÄ±nÄ± Kontrol Etme ve DeÄŸiÅŸtirme:**
```bash
otool -Vh Original_App
python change_macho_flags.py --no-pie Original_App
otool -Vh Hello_World
```
**Åifreli BÃ¶lÃ¼mÃ¼ Belirleme ve BelleÄŸi DÃ¶kme:**

`otool` kullanarak ÅŸifreli bÃ¶lÃ¼mÃ¼n baÅŸlangÄ±Ã§ ve bitiÅŸ adreslerini belirleyin ve jailbreak yapÄ±lmÄ±ÅŸ cihazdan belleÄŸi `gdb` kullanarak dÃ¶kÃ¼n.
```bash
otool -l Original_App | grep -A 4 LC_ENCRYPTION_INFO
dump memory dump.bin 0x8000 0x10a4000
```
**Åifreli BÃ¶lÃ¼mÃ¼ Ãœzerine Yazma:**

Orijinal uygulama ikili dosyasÄ±ndaki ÅŸifreli bÃ¶lÃ¼mÃ¼, ÅŸifrelenmemiÅŸ dÃ¶kÃ¼m ile deÄŸiÅŸtirin.
```bash
dd bs=1 seek=<starting_address> conv=notrunc if=dump.bin of=Original_App
```
**Åifre Ã‡Ã¶zÃ¼mlemenin TamamlanmasÄ±:** Åifrelemenin yokluÄŸunu belirtmek iÃ§in ikili dosyanÄ±n meta verilerini **MachOView** gibi araÃ§lar kullanarak deÄŸiÅŸtirin, `cryptid` deÄŸerini 0 olarak ayarlayÄ±n.

### **Åifre Ã‡Ã¶zÃ¼mÃ¼ (Otomatik Olarak)**

#### **frida-ios-dump**
[**frida-ios-dump**](https://github.com/AloneMonkey/frida-ios-dump) aracÄ±, iOS cihazlarÄ±ndan **otomatik olarak uygulamalarÄ± ÅŸifre Ã§Ã¶zmek ve Ã§Ä±karmak** iÃ§in kullanÄ±lÄ±r. Ã–ncelikle, `dump.py` dosyasÄ±nÄ± iOS cihazÄ±na baÄŸlanacak ÅŸekilde yapÄ±landÄ±rmak gerekir; bu, **iproxy** aracÄ±lÄ±ÄŸÄ±yla localhost Ã¼zerinden 2222 portu ile veya doÄŸrudan cihazÄ±n IP adresi ve portu Ã¼zerinden yapÄ±labilir.

Cihazda yÃ¼klÃ¼ olan uygulamalar ÅŸu komutla listelenebilir:
```bash
$ python dump.py -l
```
Belirli bir uygulamayÄ±, Ã¶rneÄŸin Telegram'Ä± dÃ¶kmek iÃ§in aÅŸaÄŸÄ±daki komut kullanÄ±lÄ±r:
```bash
$ python3 dump.py -u "root" -p "<PASSWORD>" ph.telegra.Telegraph
```
Bu komut, uygulama dÃ¶kÃ¼mÃ¼nÃ¼ baÅŸlatÄ±r ve mevcut dizinde `Telegram.ipa` dosyasÄ±nÄ±n oluÅŸturulmasÄ±na neden olur. Bu iÅŸlem, imzasÄ±z veya sahte imzalÄ± uygulamalarÄ±n [**ios-deploy**](https://github.com/ios-control/ios-deploy) gibi araÃ§lar kullanÄ±larak yeniden yÃ¼klenebileceÄŸi jailbreak'li cihazlar iÃ§in uygundur.

#### **flexdecrypt**
[**flexdecrypt**](https://github.com/JohnCoates/flexdecrypt) aracÄ± ve onun sarmalayÄ±cÄ±sÄ± [**flexdump**](https://gist.github.com/defparam/71d67ee738341559c35c684d659d40ac), yÃ¼klÃ¼ uygulamalardan IPA dosyalarÄ±nÄ±n Ã§Ä±karÄ±lmasÄ±na olanak tanÄ±r. Cihazda **flexdecrypt** iÃ§in kurulum komutlarÄ±, `.deb` paketinin indirilmesi ve yÃ¼klenmesini iÃ§erir. **flexdump**, aÅŸaÄŸÄ±daki komutlarda gÃ¶sterildiÄŸi gibi uygulamalarÄ± listelemek ve dÃ¶kmek iÃ§in kullanÄ±labilir:
```bash
apt install zip unzip
wget https://gist.githubusercontent.com/defparam/71d67ee738341559c35c684d659d40ac/raw/30c7612262f1faf7871ba8e32fbe29c0f3ef9e27/flexdump -P /usr/local/bin; chmod +x /usr/local/bin/flexdump
flexdump list
flexdump dump Twitter.app
```
#### **bagbak**
[**bagbak**](https://github.com/ChiChou/bagbak), baÅŸka bir Frida tabanlÄ± araÃ§, uygulama ÅŸifrelemesini Ã§Ã¶zmek iÃ§in jailbreak yapÄ±lmÄ±ÅŸ bir cihaza ihtiyaÃ§ duyar:
```bash
bagbak --raw Chrome
```
#### **r2flutch**
**r2flutch**, hem radare hem de frida kullanarak, uygulama ÅŸifrelemesi ve dÃ¶kÃ¼mÃ¼ iÃ§in hizmet eder. Daha fazla bilgi [**GitHub sayfasÄ±nda**](https://github.com/as0ler/r2flutch) bulunabilir.

### **Uygulama YÃ¼kleme**

**Sideloading**, uygulamalarÄ±n resmi App Store dÄ±ÅŸÄ±nda yÃ¼klenmesini ifade eder. Bu iÅŸlem **installd daemon** tarafÄ±ndan yÃ¶netilir ve uygulamalarÄ±n Apple tarafÄ±ndan verilen bir sertifika ile imzalanmasÄ±nÄ± gerektirir. Jailbroken cihazlar, sahte imzalÄ± IPA paketlerinin yÃ¼klenmesini saÄŸlayan **AppSync** aracÄ±lÄ±ÄŸÄ±yla bunu atlayabilir.

#### **Sideloading AraÃ§larÄ±**

- **Cydia Impactor**: iOS'ta IPA dosyalarÄ±nÄ± ve Android'de APK dosyalarÄ±nÄ± imzalamak ve yÃ¼klemek iÃ§in bir araÃ§tÄ±r. KÄ±lavuzlar ve sorun giderme bilgileri [yalujailbreak.net](https://yalujailbreak.net/how-to-use-cydia-impactor/) adresinde bulunabilir.

- **libimobiledevice**: iOS cihazlarÄ±yla iletiÅŸim kurmak iÃ§in Linux ve macOS iÃ§in bir kÃ¼tÃ¼phanedir. USB Ã¼zerinden uygulama yÃ¼klemek iÃ§in ideviceinstaller iÃ§in kurulum komutlarÄ± ve kullanÄ±m Ã¶rnekleri saÄŸlanmÄ±ÅŸtÄ±r.

- **ipainstaller**: Bu komut satÄ±rÄ± aracÄ±, iOS cihazlarÄ±nda doÄŸrudan uygulama yÃ¼klemeye olanak tanÄ±r.

- **ios-deploy**: macOS kullanÄ±cÄ±larÄ± iÃ§in, ios-deploy komut satÄ±rÄ±ndan iOS uygulamalarÄ±nÄ± yÃ¼kler. IPA dosyasÄ±nÄ± aÃ§mak ve doÄŸrudan uygulama baÅŸlatmak iÃ§in `-m` bayraÄŸÄ±nÄ± kullanmak sÃ¼recin bir parÃ§asÄ±dÄ±r.

- **Xcode**: UygulamalarÄ± yÃ¼klemek iÃ§in Xcode'u kullanarak **Window/Devices and Simulators** bÃ¶lÃ¼mÃ¼ne gidin ve uygulamayÄ± **Installed Apps** kÄ±smÄ±na ekleyin.

#### **iPad DÄ±ÅŸÄ± Cihazlarda Uygulama YÃ¼klemeye Ä°zin Ver**
iPhone veya iPod touch cihazlarÄ±nda iPad'e Ã¶zel uygulamalarÄ± yÃ¼klemek iÃ§in, **Info.plist** dosyasÄ±ndaki **UIDeviceFamily** deÄŸeri **1** olarak deÄŸiÅŸtirilmelidir. Ancak, bu deÄŸiÅŸiklik imza doÄŸrulama kontrolleri nedeniyle IPA dosyasÄ±nÄ±n yeniden imzalanmasÄ±nÄ± gerektirir.

**Not**: Bu yÃ¶ntem, uygulama daha yeni iPad modellerine Ã¶zgÃ¼ yetenekler talep ediyorsa, eski bir iPhone veya iPod touch kullanÄ±rken baÅŸarÄ±sÄ±z olabilir.



## References
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](ttps://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0052/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0052/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0053/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0053/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0054/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0054/)
* [https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0056/](https://mas.owasp.org/MASTG/techniques/ios/MASTG-TECH-0056/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
