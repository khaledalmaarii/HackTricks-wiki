# Extracting Entitlements from Compiled Application

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


ãƒšãƒ¼ã‚¸ã®è¦ç´„ [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracting Entitlements and Mobile Provision Files**

ã‚¢ãƒ—ãƒªã®IPAã‚„è„±ç„ãƒ‡ãƒã‚¤ã‚¹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚’æ‰±ã†éš›ã€`.entitlements`ãƒ•ã‚¡ã‚¤ãƒ«ã‚„`embedded.mobileprovision`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥è¦‹ã¤ã‘ã‚‹ã“ã¨ã¯ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªãƒã‚¤ãƒŠãƒªã‹ã‚‰æ¨©é™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒªã‚¹ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã‚ã‚Šã€ã€ŒiOS Basic Security Testingã€ç« ã€ç‰¹ã«ã€ŒAcquiring the App Binaryã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¨˜è¼‰ã•ã‚ŒãŸæ‰‹é †ã«å¾“ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

æš—å·åŒ–ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒªã§ã‚‚ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ç‰¹å®šã®æ‰‹é †ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®æ‰‹é †ãŒå¤±æ•—ã—ãŸå ´åˆã€Clutchï¼ˆiOSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨äº’æ›æ€§ãŒã‚ã‚‹å ´åˆï¼‰ã€frida-ios-dumpã€ã¾ãŸã¯åŒæ§˜ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã‚’å¾©å·åŒ–ã—ã€æŠ½å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

#### **Extracting the Entitlements Plist from the App Binary**

ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ã‚¢ãƒ—ãƒªãƒã‚¤ãƒŠãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã€**binwalk**ã‚’ä½¿ç”¨ã—ã¦ã™ã¹ã¦ã®XMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãã®æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
ä»£ã‚ã‚Šã«ã€**radare2**ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’é™ã‹ã«å®Ÿè¡Œã—ã€çµ‚äº†ã™ã‚‹ã“ã¨ãŒã§ãã€ã‚¢ãƒ—ãƒªãƒã‚¤ãƒŠãƒªå†…ã®ã€ŒPropertyListã€ã‚’å«ã‚€ã™ã¹ã¦ã®æ–‡å­—åˆ—ã‚’æ¤œç´¢ã—ã¾ã™ï¼š
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
ä¸¡æ–¹ã®æ–¹æ³•ã€binwalkã¨radare2ã¯ã€`plist`ãƒ•ã‚¡ã‚¤ãƒ«ã®æŠ½å‡ºã‚’å¯èƒ½ã«ã—ã€æœ€åˆã®ã‚‚ã®ï¼ˆ0x0015d2a4ï¼‰ã®æ¤œæŸ»ã«ã‚ˆã‚Šã€[Telegramã‹ã‚‰ã®å…ƒã®entitlementsãƒ•ã‚¡ã‚¤ãƒ«ã®æˆåŠŸã—ãŸå›å¾©](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements)ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚

è„±ç„ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚ŒãŸã‚¢ãƒ—ãƒªãƒã‚¤ãƒŠãƒªï¼ˆä¾‹ï¼šSSHçµŒç”±ï¼‰ã«å¯¾ã—ã¦ã€**grep**ã‚³ãƒãƒ³ãƒ‰ã®`-a, --text`ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ã¦ã€ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ASCIIãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ï¼š
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
`-A num, --after-context=num` ãƒ•ãƒ©ã‚°ã‚’èª¿æ•´ã™ã‚‹ã“ã¨ã§ã€è¡¨ç¤ºã™ã‚‹è¡Œæ•°ã‚’å¢—ã‚„ã—ãŸã‚Šæ¸›ã‚‰ã—ãŸã‚Šã§ãã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€æš—å·åŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªãƒã‚¤ãƒŠãƒªã«ã‚‚æœ‰åŠ¹ã§ã‚ã‚Šã€è¤‡æ•°ã®App Storeã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦æ¤œè¨¼ã•ã‚Œã¦ã„ã¾ã™ã€‚å‰è¿°ã®ãƒ„ãƒ¼ãƒ«ã¯ã€åŒæ§˜ã®ç›®çš„ã§è„±ç„ã—ãŸiOSãƒ‡ãƒã‚¤ã‚¹ã§ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

**æ³¨æ„**: ã“ã®ã‚¿ã‚¹ã‚¯ã«å¯¾ã—ã¦ `strings` ã‚³ãƒãƒ³ãƒ‰ã®ç›´æ¥ä½¿ç”¨ã¯æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ã€‚é–¢é€£æƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹éš›ã®åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚ä»£ã‚ã‚Šã«ã€ãƒã‚¤ãƒŠãƒªã«å¯¾ã—ã¦ `-a` ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ãŸgrepã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€radare2ï¼ˆ`izz`ï¼‰/rabin2ï¼ˆ`-zz`ï¼‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã€ã‚ˆã‚ŠåŠ¹æœçš„ãªçµæœã‚’å¾—ã‚‹ãŸã‚ã«æ¨å¥¨ã•ã‚Œã¾ã™ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
