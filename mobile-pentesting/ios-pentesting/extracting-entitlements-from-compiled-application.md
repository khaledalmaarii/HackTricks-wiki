# Entitlements aus kompilierter Anwendung extrahieren

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks unterst√ºtzen</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}


Zusammenfassung der Seite [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Entitlements und mobile Bereitstellungsdateien extrahieren**

Beim Umgang mit einer IPA einer App oder einer installierten App auf einem jailbroken Ger√§t kann es m√∂glicherweise nicht m√∂glich sein, `.entitlements`-Dateien oder die `embedded.mobileprovision`-Datei direkt zu finden. Es ist jedoch m√∂glich, die Entitlements-Property-Listen aus der App-Bin√§rdatei zu extrahieren, indem die Verfahren im Kapitel "iOS Basic Security Testing", insbesondere im Abschnitt "Erwerb der App-Bin√§rdatei", befolgt werden.

Selbst bei verschl√ºsselten Bin√§rdateien k√∂nnen bestimmte Schritte unternommen werden, um diese Dateien zu extrahieren. Sollten diese Schritte fehlschlagen, k√∂nnen Tools wie Clutch (sofern mit der iOS-Version kompatibel), frida-ios-dump oder √§hnliche Dienstprogramme erforderlich sein, um die App zu entschl√ºsseln und zu extrahieren.

#### **Extrahieren der Entitlements-Plist aus der App-Bin√§rdatei**

Mit der App-Bin√§rdatei, die auf einem Computer zug√§nglich ist, kann **binwalk** verwendet werden, um alle XML-Dateien zu extrahieren. Der folgende Befehl zeigt, wie dies zu tun ist:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternativ kann **radare2** verwendet werden, um einen Befehl leise auszuf√ºhren und zu beenden, indem nach allen Zeichenfolgen im App-Bin√§rdatei gesucht wird, die "PropertyList" enthalten:
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Beide Methoden, binwalk und radare2, erm√∂glichen das Extrahieren von `plist`-Dateien, wobei eine Inspektion der ersten (0x0015d2a4) eine erfolgreiche Wiederherstellung der [originalen Berechtigungsdatei von Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements) zeigt.

F√ºr App-Bin√§rdateien, die auf jailbroken Ger√§ten (z. B. √ºber SSH) zugegriffen werden, kann der **grep**-Befehl mit dem `-a, --text`-Flag verwendet werden, um alle Dateien als ASCII-Text zu behandeln:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Das Anpassen des `-A num, --after-context=num` Flags erm√∂glicht die Anzeige von mehr oder weniger Zeilen. Diese Methode ist auch f√ºr verschl√ºsselte App-Bin√§rdateien geeignet und wurde gegen mehrere App Store-Apps verifiziert. Die zuvor erw√§hnten Tools k√∂nnen ebenfalls auf jailbroken iOS-Ger√§ten f√ºr √§hnliche Zwecke eingesetzt werden.

**Hinweis**: Die direkte Verwendung des `strings`-Befehls wird f√ºr diese Aufgabe aufgrund seiner Einschr√§nkungen bei der Auffindung relevanter Informationen nicht empfohlen. Stattdessen ist es ratsam, grep mit dem `-a`-Flag auf der Bin√§rdatei zu verwenden oder radare2 (`izz`)/rabin2 (`-zz`) f√ºr effektivere Ergebnisse zu nutzen.
