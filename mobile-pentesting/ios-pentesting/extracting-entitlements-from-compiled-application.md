# Extracci贸n de derechos de la aplicaci贸n compilada

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}


Resumen de la p谩gina [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracci贸n de derechos y archivos de provisi贸n m贸vil**

Al tratar con el IPA de una aplicaci贸n o una aplicaci贸n instalada en un dispositivo con jailbreak, puede que no sea posible encontrar archivos `.entitlements` o el archivo `embedded.mobileprovision` directamente. Sin embargo, las listas de propiedades de derechos a煤n se pueden extraer del binario de la aplicaci贸n, siguiendo los procedimientos descritos en el cap铆tulo "Pruebas de Seguridad B谩sica en iOS", particularmente en la secci贸n "Adquisici贸n del Binario de la Aplicaci贸n".

Incluso con binarios cifrados, se pueden emplear ciertos pasos para extraer estos archivos. Si estos pasos fallan, pueden ser necesarias herramientas como Clutch (si es compatible con la versi贸n de iOS), frida-ios-dump, o utilidades similares para descifrar y extraer la aplicaci贸n.

#### **Extracci贸n del Plist de Derechos del Binario de la Aplicaci贸n**

Con el binario de la aplicaci贸n accesible en una computadora, se puede utilizar **binwalk** para extraer todos los archivos XML. El comando a continuaci贸n demuestra c贸mo hacerlo:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternativamente, **radare2** se puede usar para ejecutar un comando en silencio y salir, buscando todas las cadenas en el binario de la aplicaci贸n que contengan "PropertyList":
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Ambos m茅todos, binwalk y radare2, permiten la extracci贸n de archivos `plist`, con una inspecci贸n del primero (0x0015d2a4) revelando una recuperaci贸n exitosa del [archivo de derechos original de Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

Para los binarios de aplicaciones accedidos en dispositivos con jailbreak (por ejemplo, a trav茅s de SSH), se puede utilizar el comando **grep** con la bandera `-a, --text` para tratar todos los archivos como texto ASCII:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Ajustar la bandera `-A num, --after-context=num` permite mostrar m谩s o menos l铆neas. Este m茅todo es viable incluso para binarios de aplicaciones encriptadas y ha sido verificado en m煤ltiples aplicaciones de la App Store. Las herramientas mencionadas anteriormente tambi茅n pueden ser empleadas en dispositivos iOS con jailbreak para prop贸sitos similares.

**Nota**: No se recomienda el uso directo del comando `strings` para esta tarea debido a sus limitaciones para encontrar informaci贸n relevante. En su lugar, se aconseja emplear grep con la bandera `-a` en el binario o utilizar radare2 (`izz`)/rabin2 (`-zz`) para obtener resultados m谩s efectivos.
