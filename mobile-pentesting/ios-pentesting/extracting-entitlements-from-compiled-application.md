# Extracting Entitlements from Compiled Application

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


Summary of the page [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracting Entitlements and Mobile Provision Files**

ÎŒÏ„Î±Î½ Î±ÏƒÏ‡Î¿Î»ÎµÎ¯ÏƒÏ„Îµ Î¼Îµ Ï„Î¿ IPA Î¼Î¹Î±Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î® Î¼Îµ Î¼Î¹Î± ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÎµ Î¼Î¹Î± jailbroken ÏƒÏ…ÏƒÎºÎµÏ…Î®, Î· ÎµÏÏÎµÏƒÎ· Ï„Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ `.entitlements` Î® Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… `embedded.mobileprovision` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î®. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¿Î¹ Î»Î¯ÏƒÏ„ÎµÏ‚ Î¹Î´Î¹Î¿Ï„Î®Ï„Ï‰Î½ entitlements Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¾Î±Ï‡Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚, Î±ÎºÎ¿Î»Î¿Ï…Î¸ÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ ÎºÎµÏ†Î¬Î»Î±Î¹Î¿ "iOS Basic Security Testing", Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± ÏƒÏ„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± "Acquiring the App Binary".

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¼Îµ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î± Î´Ï…Î±Î´Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î±, Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± Î²Î®Î¼Î±Ï„Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Î½Î± ÎµÎ¾Î±Ï‡Î¸Î¿ÏÎ½ Î±Ï…Ï„Î¬ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î±. Î•Î¬Î½ Î±Ï…Ï„Î¬ Ï„Î± Î²Î®Î¼Î±Ï„Î± Î±Ï€Î¿Ï„ÏÏ‡Î¿Ï…Î½, ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Clutch (Î±Î½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î²Î±Ï„ÏŒ Î¼Îµ Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· iOS), frida-ios-dump Î® Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î²Î¿Î·Î¸Î·Ï„Î¹ÎºÎ¬ Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎ¿Ï…Î½ ÎºÎ±Î¹ Î½Î± ÎµÎ¾Î¬Î³Î¿Ï…Î½ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

#### **Extracting the Entitlements Plist from the App Binary**

ÎœÎµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î¿ ÏƒÎµ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®, **binwalk** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎµÎ¾Î±Ï‡Î¸Î¿ÏÎ½ ÏŒÎ»Î± Ï„Î± XML Î±ÏÏ‡ÎµÎ¯Î±. Î— Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Ï„Î¿Î»Î® Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏÏ‚ Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ¬, **radare2** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î®ÏƒÏ…Ï‡Î± Î¼Î¹Î± ÎµÎ½Ï„Î¿Î»Î® ÎºÎ±Î¹ Î½Î± ÎµÎ¾Î­Î»Î¸ÎµÎ¹, Î±Î½Î±Î¶Î·Ï„ÏÎ½Ï„Î±Ï‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ­Ï‚ ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ "PropertyList":
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
ÎšÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ Î¼Î­Î¸Î¿Î´Î¿Î¹, binwalk ÎºÎ±Î¹ radare2, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î·Î½ ÎµÎ¾Î±Î³Ï‰Î³Î® Î±ÏÏ‡ÎµÎ¯Ï‰Î½ `plist`, Î¼Îµ Î¼Î¹Î± ÎµÏ€Î¹Î¸ÎµÏÏÎ·ÏƒÎ· Ï„Î¿Ï… Ï€ÏÏÏ„Î¿Ï… (0x0015d2a4) Î½Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î¹Ï„Ï…Ï‡Î·Î¼Î­Î½Î· Î±Î½Î¬ÎºÏ„Î·ÏƒÎ· Ï„Î¿Ï… [Î±ÏÏ‡Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Î±Ï€ÏŒ Ï„Î¿ Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

Î“Î¹Î± Ï„Î± Î´Ï…Î±Î´Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÏ„Î·ÎºÎ±Î½ ÏƒÎµ jailbroken ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ (Ï€.Ï‡., Î¼Î­ÏƒÏ‰ SSH), Î· ÎµÎ½Ï„Î¿Î»Î® **grep** Î¼Îµ Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® `-a, --text` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¹ÏƒÏ„Î¿ÏÎ½ ÏŒÎ»Î± Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± Ï‰Ï‚ ASCII ÎºÎµÎ¯Î¼ÎµÎ½Î¿:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Î¡Ï…Î¸Î¼Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® `-A num, --after-context=num` ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Î® Î»Î¹Î³ÏŒÏ„ÎµÏÏ‰Î½ Î³ÏÎ±Î¼Î¼ÏÎ½. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î²Î¹ÏÏƒÎ¹Î¼Î· Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î³Î¹Î± ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î± Î´Ï…Î±Î´Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ ÎµÏ€Î±Î»Î·Î¸ÎµÏ…Ï„ÎµÎ¯ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï„Î¿Ï… App Store. Î¤Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎ±Î½ Î½Ï‰ÏÎ¯Ï„ÎµÏÎ± Î¼Ï€Î¿ÏÎ¿ÏÎ½ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ ÏƒÎµ jailbroken iOS ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Î³Î¹Î± Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿Ï…Ï‚ ÏƒÎºÎ¿Ï€Î¿ÏÏ‚.

**Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: Î— Î¬Î¼ÎµÏƒÎ· Ï‡ÏÎ®ÏƒÎ· Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ `strings` Î´ÎµÎ½ ÏƒÏ…Î½Î¹ÏƒÏ„Î¬Ï„Î±Î¹ Î³Î¹Î± Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÏÎ³Î±ÏƒÎ¯Î± Î»ÏŒÎ³Ï‰ Ï„Ï‰Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏÎ½ Ï„Î·Ï‚ ÏƒÏ„Î·Î½ ÎµÏÏÎµÏƒÎ· ÏƒÏ‡ÎµÏ„Î¹ÎºÏÎ½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½. Î‘Î½Ï„Î¯Î¸ÎµÏ„Î±, Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… grep Î¼Îµ Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® `-a` ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î® Î· Î±Î¾Î¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… radare2 (`izz`)/rabin2 (`-zz`) ÎµÎ¯Î½Î±Î¹ ÏƒÎºÏŒÏ€Î¹Î¼Î· Î³Î¹Î± Ï€Î¹Î¿ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
