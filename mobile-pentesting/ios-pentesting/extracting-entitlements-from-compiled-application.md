# Extracting Entitlements from Compiled Application

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


í˜ì´ì§€ ìš”ì•½ [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracting Entitlements and Mobile Provision Files**

ì•±ì˜ IPA ë˜ëŠ” íƒˆì˜¥ëœ ì¥ì¹˜ì— ì„¤ì¹˜ëœ ì•±ì„ ë‹¤ë£° ë•Œ, `.entitlements` íŒŒì¼ì´ë‚˜ `embedded.mobileprovision` íŒŒì¼ì„ ì§ì ‘ ì°¾ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ì•± ë°”ì´ë„ˆë¦¬ì—ì„œ ê¶Œí•œ ì†ì„± ëª©ë¡ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” "iOS Basic Security Testing" ì¥ì˜ ì ˆì°¨ë¥¼ ë”°ë¦…ë‹ˆë‹¤. íŠ¹íˆ "Acquiring the App Binary" ì„¹ì…˜ì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.

ì•”í˜¸í™”ëœ ë°”ì´ë„ˆë¦¬ì—ì„œë„ ì´ëŸ¬í•œ íŒŒì¼ì„ ì¶”ì¶œí•˜ê¸° ìœ„í•´ íŠ¹ì • ë‹¨ê³„ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë‹¨ê³„ê°€ ì‹¤íŒ¨í•  ê²½ìš°, Clutch(í˜¸í™˜ë˜ëŠ” iOS ë²„ì „ì¼ ê²½ìš°), frida-ios-dump ë˜ëŠ” ìœ ì‚¬í•œ ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•±ì„ ë³µí˜¸í™”í•˜ê³  ì¶”ì¶œí•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **Extracting the Entitlements Plist from the App Binary**

ì•± ë°”ì´ë„ˆë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì»´í“¨í„°ì—ì„œ **binwalk**ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  XML íŒŒì¼ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ëŠ” ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
ëŒ€ì•ˆìœ¼ë¡œ, **radare2**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¡°ìš©íˆ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ì¢…ë£Œí•  ìˆ˜ ìˆìœ¼ë©°, "PropertyList"ë¥¼ í¬í•¨í•˜ëŠ” ì•± ë°”ì´ë„ˆë¦¬ì˜ ëª¨ë“  ë¬¸ìì—´ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
ë‘ ë°©ë²•ì¸ binwalkì™€ radare2ëŠ” `plist` íŒŒì¼ì˜ ì¶”ì¶œì„ ê°€ëŠ¥í•˜ê²Œ í•˜ë©°, ì²« ë²ˆì§¸ ë°©ë²•(0x0015d2a4)ì˜ ê²€í† ë¥¼ í†µí•´ [í…”ë ˆê·¸ë¨ì˜ ì›ë³¸ ê¶Œí•œ íŒŒì¼](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements)ì˜ ì„±ê³µì ì¸ ë³µêµ¬ê°€ ë“œëŸ¬ë‚¬ìŠµë‹ˆë‹¤.

íƒˆì˜¥ëœ ì¥ì¹˜ì—ì„œ ì ‘ê·¼í•œ ì•± ë°”ì´ë„ˆë¦¬ì— ëŒ€í•´ì„œëŠ” **grep** ëª…ë ¹ì–´ì™€ `-a, --text` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  íŒŒì¼ì„ ASCII í…ìŠ¤íŠ¸ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
`-A num, --after-context=num` í”Œë˜ê·¸ë¥¼ ì¡°ì •í•˜ë©´ ë” ë§ì€ ë˜ëŠ” ë” ì ì€ ì¤„ì„ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì€ ì•”í˜¸í™”ëœ ì•± ë°”ì´ë„ˆë¦¬ì—ë„ ìœ íš¨í•˜ë©° ì—¬ëŸ¬ App Store ì•±ì— ëŒ€í•´ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤. ì•ì„œ ì–¸ê¸‰í•œ ë„êµ¬ëŠ” ìœ ì‚¬í•œ ëª©ì ì„ ìœ„í•´ íƒˆì˜¥ëœ iOS ì¥ì¹˜ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì°¸ê³ **: ì´ ì‘ì—…ì— ëŒ€í•´ `strings` ëª…ë ¹ì–´ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê´€ë ¨ ì •ë³´ë¥¼ ì°¾ëŠ” ë° í•œê³„ê°€ ìˆê¸° ë•Œë¬¸ì— ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹ , ë°”ì´ë„ˆë¦¬ì— ëŒ€í•´ `-a` í”Œë˜ê·¸ì™€ í•¨ê»˜ grepì„ ì‚¬ìš©í•˜ê±°ë‚˜ radare2(`izz`)/rabin2(`-zz`)ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ë” íš¨ê³¼ì ì¸ ê²°ê³¼ë¥¼ ì–»ëŠ” ë° ë°”ëŒì§í•©ë‹ˆë‹¤.
