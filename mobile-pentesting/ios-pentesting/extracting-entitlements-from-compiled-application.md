# Extracting Entitlements from Compiled Application

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


Podsumowanie strony [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracting Entitlements and Mobile Provision Files**

Podczas pracy z plikiem IPA aplikacji lub zainstalowan aplikacj na urzdzeniu z jailbreakiem, bezporednie znalezienie plik贸w `.entitlements` lub pliku `embedded.mobileprovision` mo偶e by niemo偶liwe. Niemniej jednak, listy waciwoci uprawnie mo偶na nadal wyodrbni z binarnego pliku aplikacji, stosujc procedury opisane w rozdziale "Podstawowe testowanie bezpieczestwa iOS", szczeg贸lnie w sekcji "Pozyskiwanie binarnego pliku aplikacji".

Nawet w przypadku zaszyfrowanych plik贸w binarnych, mo偶na zastosowa pewne kroki, aby wyodrbni te pliki. Jeli te kroki zawiod, mog by wymagane narzdzia takie jak Clutch (jeli jest zgodne z wersj iOS), frida-ios-dump lub podobne narzdzia do odszyfrowania i wyodrbnienia aplikacji.

#### **Extracting the Entitlements Plist from the App Binary**

Gdy binarny plik aplikacji jest dostpny na komputerze, **binwalk** mo偶na wykorzysta do wyodrbnienia wszystkich plik贸w XML. Poni偶sze polecenie pokazuje, jak to zrobi:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternatywnie, **radare2** mo偶e by u偶yty do cichego uruchomienia polecenia i wyjcia, przeszukujc wszystkie cigi w binarnym pliku aplikacji, kt贸re zawieraj "PropertyList":
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Obie metody, binwalk i radare2, umo偶liwiaj ekstrakcj plik贸w `plist`, przy czym inspekcja pierwszej (0x0015d2a4) ujawnia udane odzyskanie [oryginalnego pliku uprawnie z Telegramu](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

Dla binari贸w aplikacji uzyskanych na urzdzeniach z jailbreakiem (np. przez SSH), polecenie **grep** z flag `-a, --text` mo偶e by u偶yte do traktowania wszystkich plik贸w jako tekst ASCII:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Dostosowanie flagi `-A num, --after-context=num` pozwala na wywietlenie wikszej lub mniejszej liczby linii. Ta metoda jest wykonalna nawet dla zaszyfrowanych binari贸w aplikacji i zostaa zweryfikowana w przypadku wielu aplikacji z App Store. Narzdzia wspomniane wczeniej mog by r贸wnie偶 u偶ywane na zrootowanych urzdzeniach iOS w podobnych celach.

**Uwaga**: Bezporednie u偶ycie polecenia `strings` nie jest zalecane do tego zadania z powodu jego ogranicze w znajdowaniu istotnych informacji. Zamiast tego, zaleca si u偶ycie grep z flag `-a` na binarium lub wykorzystanie radare2 (`izz`)/rabin2 (`-zz`) dla bardziej efektywnych wynik贸w.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
