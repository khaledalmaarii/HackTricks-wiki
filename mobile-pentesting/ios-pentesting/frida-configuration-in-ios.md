# Î¡ÏÎ¸Î¼Î¹ÏƒÎ· Ï„Î¿Ï… Frida ÏƒÏ„Î¿ iOS

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… Frida

**Î’Î®Î¼Î±Ï„Î± Î³Î¹Î± Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿ Frida ÏƒÎµ Î¼Î¹Î± Jailbroken ÏƒÏ…ÏƒÎºÎµÏ…Î®:**

1. Î‘Î½Î¿Î¯Î¾Ï„Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Cydia/Sileo.
2. Î Î»Î¿Î·Î³Î·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Manage -> Sources -> Edit -> Add.
3. Î•Î¹ÏƒÎ±Î³Î¬Î³ÎµÏ„Îµ Ï„Î¿ "https://build.frida.re" Ï‰Ï‚ URL.
4. Î Î·Î³Î±Î¯Î½ÎµÏ„Îµ ÏƒÏ„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸ÎµÎ¸ÎµÎ¯ÏƒÎ± Ï€Î·Î³Î® Ï„Î¿Ï… Frida.
5. Î•Î³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÏ„Îµ Ï„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ Ï„Î¿Ï… Frida.

Î•Î¬Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î¿ **Corellium**, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… Frida Î±Ï€ÏŒ [https://github.com/frida/frida/releases](https://github.com/frida/frida/releases) (`frida-gadget-[yourversion]-ios-universal.dylib.gz`) ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± Î±Î½Ï„Î¹Î³ÏÎ¬ÏˆÎµÏ„Îµ ÏƒÏ„Î·Î½ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± dylib Ï€Î¿Ï… Î¶Î·Ï„Î¬ Î¿ Frida, Ï€.Ï‡.: `/Users/[youruser]/.cache/frida/gadget-ios.dylib`

Î‘Ï†Î¿Ï ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸ÎµÎ¯, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏƒÏ„Î¿Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® ÏƒÎ±Ï‚ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® **`frida-ls-devices`** ÎºÎ±Î¹ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ ÏŒÏ„Î¹ Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ (Î¿ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®Ï‚ ÏƒÎ±Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎµÎ¹).\
Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® **`frida-ps -Uia`** Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Ï„Î¿Ï… Ï„Î·Î»ÎµÏ†ÏÎ½Î¿Ï….

## Î§ÏÎ®ÏƒÎ· Ï„Î¿Ï… Frida Ï‡Ï‰ÏÎ¯Ï‚ Jailbroken ÏƒÏ…ÏƒÎºÎµÏ…Î® ÎºÎ±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎµÏ€Î¹Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚

Î•Î»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ„Î¿ blog Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ Frida ÏƒÎµ Î¼Î·-Jailbroken ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ ÎµÏ€Î¹Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚: [https://mrbypass.medium.com/unlocking-potential-exploring-frida-objection-on-non-jailbroken-devices-without-application-ed0367a84f07](https://mrbypass.medium.com/unlocking-potential-exploring-frida-objection-on-non-jailbroken-devices-without-application-ed0367a84f07)

## Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… Frida Client

Î•Î³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÏ„Îµ Ï„Î± **ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î¿Ï… frida**:
```bash
pip install frida-tools
pip install frida
```
ÎœÎµ Ï„Î¿Î½ Frida server ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î¿ ÎºÎ±Î¹ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î¹ Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·, **ÎµÎ»Î­Î³Î¾Ï„Îµ** Î±Î½ Î¿ Ï€ÎµÎ»Î¬Ï„Î·Ï‚ **Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯**:
```bash
frida-ls-devices  # List devices
frida-ps -Uia     # Get running processes
```
## ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î® Î¼Îµ Ï„Î¿ Frida

Frida is a dynamic instrumentation framework that allows you to inject JavaScript code into running processes. It is commonly used for mobile application security testing and analysis. With Frida, you can trace function calls, monitor network traffic, modify function behavior, and much more.

To configure Frida for iOS pentesting, follow these steps:

1. Install Frida on your iOS device by using the following command:

   ```
   pip install frida-tools
   ```

2. Connect your iOS device to your computer using a USB cable.

3. Enable USB debugging on your iOS device by going to **Settings > Developer > Enable USB Debugging**.

4. Launch the Frida server on your iOS device by running the following command:

   ```
   frida-server -l 0.0.0.0:1234
   ```

5. Verify that the Frida server is running by checking the output for the following line:

   ```
   Listening on 0.0.0.0:1234...
   ```

6. Install the Frida client on your computer by running the following command:

   ```
   npm install frida
   ```

7. Create a new JavaScript file with your desired Frida trace code. For example, you can use the following code to trace the `open` function:

   ```javascript
   const open = Module.findExportByName(null, 'open');
   Interceptor.attach(open, {
     onEnter: function(args) {
       console.log('open called with path: ' + Memory.readUtf8String(args[0]));
     }
   });
   ```

8. Run the Frida client with the following command, replacing `your_script.js` with the path to your JavaScript file:

   ```
   frida -U -l your_script.js
   ```

9. Launch the target application on your iOS device.

10. You should see the output of your Frida trace code in the terminal, displaying the function calls or other information you specified.

By following these steps, you can configure Frida for iOS pentesting and use it to trace and analyze the behavior of iOS applications.
```bash
# Functions
## Trace all functions with the word "log" in their name
frida-trace -U <program> -i "*log*"
frida-trace -U <program> -i "*log*" | swift demangle # Demangle names

# Objective-C
## Trace all methods of all classes
frida-trace -U <program> -m "*[* *]"

## Trace all methods with the word "authentication" from classes that start with "NE"
frida-trace -U <program> -m "*[NE* *authentication*]"

# Plug-In
## To hook a plugin that is momentarely executed prepare Frida indicating the ID of the Plugin binary
frida-trace -U -W <if-plugin-bin> -m '*[* *]'
```
### Î›Î®ÏˆÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ÎºÎ»Î¬ÏƒÎµÏ‰Î½ ÎºÎ±Î¹ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½

* Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÏƒÏ…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎ·: Î‘Ï€Î»Î¬ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `frida -U <Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î±>`

<figure><img src="../../.gitbook/assets/image (687).png" alt=""><figcaption></figcaption></figure>

* Î›Î®ÏˆÎ· **ÏŒÎ»Ï‰Î½** Ï„Ï‰Î½ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ **ÎºÎ»Î¬ÏƒÎµÏ‰Î½** (Ï†Î¹Î»Ï„ÏÎ¬ÏÎ¹ÏƒÎ¼Î± Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ string)

{% code title="/tmp/script.js" %}
```javascript
// frida -U <program> -l /tmp/script.js

var filterClass = "filterstring";

if (ObjC.available) {
for (var className in ObjC.classes) {
if (ObjC.classes.hasOwnProperty(className)) {
if (!filterClass || className.includes(filterClass)) {
console.log(className);
}
}
}
} else {
console.log("Objective-C runtime is not available.");
}
```
{% endcode %}

* Î Î¬ÏÏ„Îµ **ÏŒÎ»ÎµÏ‚** Ï„Î¹Ï‚ **Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚** ÎµÎ½ÏŒÏ‚ **ÎºÎ»Î¬ÏƒÎ·Ï‚** (Ï†Î¹Î»Ï„ÏÎ¬ÏÎµÏ„Îµ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ string)

{% code title="/tmp/script.js" %}
```javascript
// frida -U <program> -l /tmp/script.js

var specificClass = "YourClassName";
var filterMethod = "filtermethod";

if (ObjC.available) {
if (ObjC.classes.hasOwnProperty(specificClass)) {
var methods = ObjC.classes[specificClass].$ownMethods;
for (var i = 0; i < methods.length; i++) {
if (!filterMethod || methods[i].includes(filterClass)) {
console.log(specificClass + ': ' + methods[i]);
}
}
} else {
console.log("Class not found.");
}
} else {
console.log("Objective-C runtime is not available.");
}
```
{% endcode %}

* **ÎšÎ±Î»Î­ÏƒÏ„Îµ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·**
```javascript
// Find the address of the function to call
const func_addr = Module.findExportByName("<Prog Name>", "<Func Name>");
// Declare the function to call
const func = new NativeFunction(
func_addr,
"void", ["pointer", "pointer", "pointer"], {
});

var arg0 = null;

// In this case to call this function we need to intercept a call to it to copy arg0
Interceptor.attach(wg_log_addr, {
onEnter: function(args) {
arg0 = new NativePointer(args[0]);
}
});

// Wait untill a call to the func occurs
while (! arg0) {
Thread.sleep(1);
console.log("waiting for ptr");
}


var arg1 = Memory.allocUtf8String('arg1');
var txt = Memory.allocUtf8String('Some text for arg2');
wg_log(arg0, arg1, txt);

console.log("loaded");
```
## Frida Fuzzing

### Frida Stalker

[Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±](https://frida.re/docs/stalker/#:~:text=Stalker%20is%20Frida's%20code%20tracing,every%20instruction%20which%20is%20executed.): ÎŸ Stalker ÎµÎ¯Î½Î±Î¹ Î¿ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ **Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚ ÎºÏÎ´Î¹ÎºÎ±** Ï„Î¿Ï… Frida. Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ **Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·** Î½Î·Î¼Î¬Ï„Ï‰Î½, **ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Ï‚** ÎºÎ¬Î¸Îµ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·, **ÎºÎ¬Î¸Îµ Î¼Ï€Î»Î¿Îº**, Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ ÎºÎ¬Î¸Îµ ÎµÎ½Ï„Î¿Î»Î® Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.

ÎˆÏ‡ÎµÏ„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï„Î¿Ï… Frida Stalker ÏƒÏ„Î¿ [https://github.com/poxyran/misc/blob/master/frida-stalker-example.py](https://github.com/poxyran/misc/blob/master/frida-stalker-example.py)

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¬Î»Î»Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Î¼Îµ Ï„Î¿ Frida Stalker ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬ Ï€Î¿Ï… ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·:
```javascript
console.log("loading");
const wg_log_addr = Module.findExportByName("<Program>", "<function_name>");
const wg_log = new NativeFunction(
wg_log_addr,
"void", ["pointer", "pointer", "pointer"], {
});

Interceptor.attach(wg_log_addr, {
onEnter: function(args) {
console.log(`logging the following message: ${args[2].readCString()}`);

Stalker.follow({
events: {
// only collect coverage for newly encountered blocks
compile: true,
},
onReceive: function (events) {
const bbs = Stalker.parse(events, {
stringify: false,
annotate: false
});
console.log("Stalker trace of write_msg_to_log: \n" + bbs.flat().map(DebugSymbol.fromAddress).join('\n'));
}
});
},
onLeave: function(retval) {
Stalker.unfollow();
Stalker.flush();  // this is important to get all events
}
});
```
{% hint style="danger" %}
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½ Î³Î¹Î± ÏƒÎºÎ¿Ï€Î¿ÏÏ‚ Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚, Î±Î»Î»Î¬ Î³Î¹Î± Ï„Î¿ fuzzing, Î½Î± Î±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…Î½ÎµÏ‡ÏÏ‚ Ï„Î¿ **`.follow()`** ÎºÎ±Î¹ Ï„Î¿ **`.unfollow()`** ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î±Î½ÎµÏ€Î±ÏÎºÎ­Ï‚.
{% endhint %}

## [Fpicker](https://github.com/ttdennis/fpicker)

Î¤Î¿ [**fpicker**](https://github.com/ttdennis/fpicker) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½ Î³Î¹Î± fuzzing Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿ Frida Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Î´Î¹Î¬Ï†Î¿ÏÎ± modes Î³Î¹Î± Ï„Î¿ in-process fuzzing, ÏŒÏ€Ï‰Ï‚ Î­Î½Î± mode AFL++ Î® Î­Î½Î± mode Ï€Î±Î¸Î·Ï„Î¹ÎºÎ®Ï‚ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·Ï‚. Î˜Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÏƒÎµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚ Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Frida.

* [**Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… fpicker**](https://github.com/ttdennis/fpicker#requirements-and-installation) **& radamsa**
```bash
# Get fpicker
git clone https://github.com/ttdennis/fpicker
cd fpicker

# Get Frida core devkit and prepare fpicker
wget https://github.com/frida/frida/releases/download/16.1.4/frida-core-devkit-16.1.4-[yourOS]-[yourarchitecture].tar.xz
# e.g. https://github.com/frida/frida/releases/download/16.1.4/frida-core-devkit-16.1.4-macos-arm64.tar.xz
tar -xf ./*tar.xz
cp libfrida-core.a libfrida-core-[yourOS].a #libfrida-core-macos.a

# Install fpicker
make fpicker-[yourOS] # fpicker-macos
# This generates ./fpicker

# Install radamsa (fuzzer generator)
brew install radamsa
```
* **Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚:**
```bash
# From inside fpicker clone
mkdir -p examples/wg-log # Where the fuzzing script will be
mkdir -p examples/wg-log/out # For code coverage and crashes
mkdir -p examples/wg-log/in # For starting inputs

# Create at least 1 input for the fuzzer
echo Hello World > examples/wg-log/in/0
```
* **Î£ÎµÎ½Î¬ÏÎ¹Î¿ Fuzzer** (`Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±/wg-log/myfuzzer.js`):

{% code title="Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±/wg-log/myfuzzer.js" %}
```javascript
// Import the fuzzer base class
import { Fuzzer } from "../../harness/fuzzer.js";

class WGLogFuzzer extends Fuzzer {

constructor() {
console.log("WGLogFuzzer constructor called")

// Get and declare the function we are going to fuzz
var wg_log_addr = Module.findExportByName("<Program name>", "<func name to fuzz>");
var wg_log_func = new NativeFunction(
wg_log_addr,
"void", ["pointer", "pointer", "pointer"], {
});

// Initialize the object
super("<Program nane>", wg_log_addr, wg_log_func);
this.wg_log_addr = wg_log_addr; // We cannot use "this" before calling "super"

console.log("WGLogFuzzer in the middle");

// Prepare the second argument to pass to the fuzz function
this.tag = Memory.allocUtf8String("arg2");

// Get the first argument we need to pass from a call to the functino we want to fuzz
var wg_log_global_ptr = null;
console.log(this.wg_log_addr);
Interceptor.attach(this.wg_log_addr, {
onEnter: function(args) {
console.log("Entering in the function to get the first argument");
wg_log_global_ptr = new NativePointer(args[0]);
}
});

while (! wg_log_global_ptr) {
Thread.sleep(1)
}
this.wg_log_global_ptr = wg_log_global_ptr;
console.log("WGLogFuzzer prepare ended")
}


// This function is called by the fuzzer with the first argument being a pointer into memory
// where the payload is stored and the second the length of the input.
fuzz(payload, len) {
// Get a pointer to payload being a valid C string (with a null byte at the end)
var payload_cstring = payload.readCString(len);
this.payload = Memory.allocUtf8String(payload_cstring);

// Debug and fuzz
this.debug_log(this.payload, len);
// Pass the 2 first arguments we know the function needs and finally the payload to fuzz
this.target_function(this.wg_log_global_ptr, this.tag, this.payload);
}
}

const f = new WGLogFuzzer();
rpc.exports.fuzzer = f;
```
{% endcode %}

* **ÎœÎµÏ„Î±Î³Î»Ï‰Ï„Ï„Î¯ÏƒÏ„Îµ** Ï„Î¿ fuzzer:
```bash
# From inside fpicker clone
## Compile from "myfuzzer.js" to "harness.js"
frida-compile examples/wg-log/myfuzzer.js -o harness.js
```
* ÎšÎ±Î»Î­ÏƒÏ„Îµ Ï„Î¿ fuzzer **`fpicker`** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ **`radamsa`**:

{% code overflow="wrap" %}
```bash
# Indicate fpicker to fuzz a program with the harness.js script and which folders to use
fpicker -v --fuzzer-mode active -e attach -p <Program to fuzz> -D usb -o examples/wg-log/out/ -i examples/wg-log/in/ -f harness.js --standalone-mutator cmd --mutator-command "radamsa"
# You can find code coverage and crashes in examples/wg-log/out/
```
{% endcode %}

{% hint style="danger" %}
Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· **Î´ÎµÎ½ ÎµÏ€Î±Î½ÎµÎºÎºÎ¹Î½Î¿ÏÎ¼Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î® ÎµÏ€Î±Î½Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·** Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ Ï†Î¿ÏÏ„Î¯Î¿. ÎˆÏ„ÏƒÎ¹, Î±Î½ Î¿ Frida Î²ÏÎµÎ¹ Î­Î½Î± **ÏƒÏ†Î¬Î»Î¼Î±** Ï„Î± **ÎµÏ€ÏŒÎ¼ÎµÎ½Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î¹ÎºÎ¬** Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï†Î¿ÏÏ„Î¯Î¿ Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± **ÎºÎ±Ï„Î±ÏÏÎµÏÏƒÎ¿Ï…Î½ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®** (ÎµÏ€ÎµÎ¹Î´Î® Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¹Î± Î±ÏƒÏ„Î±Î¸Î® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·), Î±ÎºÏŒÎ¼Î· ÎºÎ¹ Î±Î½ Î· **ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Î´ÎµÎ½ Î¸Î± Î­Ï€ÏÎµÏ€Îµ Î½Î± ÎºÎ±Ï„Î±ÏÏÎµÏÏƒÎµÎ¹** Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¿ Frida Î¸Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î± ÏƒÎ®Î¼Î±Ï„Î± ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÏ‰Î½ Ï„Î¿Ï… iOS, Î¿Ï€ÏŒÏ„Îµ ÏŒÏ„Î±Î½ Î¿ **Frida Î²ÏÎµÎ¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î±**, Ï€Î¹Î¸Î±Î½ÏÏ‚ Î´ÎµÎ½ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸Î¿ÏÎ½ **Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚ Ï„Î¿Ï… iOS**.

Î“Î¹Î± Î½Î± Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± ÎµÏ€Î±Î½ÎµÎºÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ ÎºÎ±Ï„Î¬ÏÏÎµÏ…ÏƒÎ· Ï„Î¿Ï… Frida.
{% endhint %}

### Î‘ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÎºÎ±Î¹ ÎºÎ±Ï„Î±ÏÏÎ¯ÏˆÎµÎ¹Ï‚

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î·Î½ **ÎºÎ¿Î½ÏƒÏŒÎ»Î± Ï„Î¿Ï… macOS** Î® Ï„Î¿ **`log`** cli Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Ï„Î¿Ï… macOS.\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î±Ï€ÏŒ Ï„Î¿ iOS Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ **`idevicesyslog`**.\
ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î¸Î± Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€Î¿Ï…Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Î½Ï„Î±Ï‚ **`<private>`**. Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ Î­Î½Î± Ï€ÏÎ¿Ï†Î¯Î» Î±Ï€ÏŒ [https://developer.apple.com/bug-reporting/profiles-and-logs/](https://developer.apple.com/bug-reporting/profiles-and-logs/) Î³Î¹Î± Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î¹Î´Î¹Ï‰Ï„Î¹ÎºÎ­Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.

Î‘Î½ Î´ÎµÎ½ Î¾Î­ÏÎµÏ„Îµ Ï„Î¹ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ:
```sh
vim /Library/Preferences/Logging/com.apple.system.logging.plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Enable-Private-Data</key>
<true/>
</dict>
</plist>

killall -9 logd
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î±Ï„Ï…Ï‡Î®Î¼Î±Ï„Î± ÏƒÏ„Î± ÎµÎ¾Î®Ï‚:

* **iOS**
* Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ â†’ Î‘Ï€ÏŒÏÏÎ·Ï„Î¿ â†’ Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ¬ & Î’ÎµÎ»Ï„Î¹ÏÏƒÎµÎ¹Ï‚ â†’ Î”ÎµÎ´Î¿Î¼Î­Î½Î± Î±Î½Î±Î»Ï…Ï„Î¹ÎºÏÎ½
* `/private/var/mobile/Library/Logs/CrashReporter/`
* **macOS**:
* `/Library/Logs/DiagnosticReports/`
* `~/Library/Logs/DiagnosticReports`

{% hint style="warning" %}
Î¤Î¿ iOS Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Î¼ÏŒÎ½Î¿ 25 Î±Ï„Ï…Ï‡Î®Î¼Î±Ï„Î± Ï„Î·Ï‚ Î¯Î´Î¹Î±Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚, Î¿Ï€ÏŒÏ„Îµ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎµÏ„Îµ Î±Î»Î»Î¹ÏÏ‚ Ï„Î¿ iOS Î¸Î± ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï„Ï…Ï‡Î®Î¼Î±Ï„Î±.
{% endhint %}

## Frida Android ÎŸÎ´Î·Î³Î¿Î¯

{% content-ref url="../android-app-pentesting/frida-tutorial/" %}
[frida-tutorial](../android-app-pentesting/frida-tutorial/)
{% endcontent-ref %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚
* [https://www.briskinfosec.com/blogs/blogsdetail/Getting-Started-with-Frida](https://www.briskinfosec.com/blogs/blogsdetail/Getting-Started-with-Frida)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î£Ï…Î¼Î¼ÎµÏ„Î¬ÏƒÏ‡ÎµÏ„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
