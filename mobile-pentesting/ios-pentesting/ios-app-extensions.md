# iOS App Extensions

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Les extensions d'application am√©liorent la fonctionnalit√© des applications en leur permettant d'interagir avec d'autres applications ou le syst√®me, fournissant des fonctionnalit√©s ou du contenu personnalis√©s. Ces extensions incluent :

- **Clavier personnalis√©** : Offre un clavier unique dans toutes les applications, rempla√ßant le clavier iOS par d√©faut.
- **Partager** : Permet de partager sur les r√©seaux sociaux ou avec d'autres directement.
- **Aujourd'hui (Widgets)** : Fournit du contenu ou effectue des t√¢ches rapidement depuis la vue Aujourd'hui du Centre de notifications.

Lorsqu'un utilisateur interagit avec ces extensions, comme le partage de texte depuis une application h√¥te, l'extension traite cette entr√©e dans son contexte, utilisant les informations partag√©es pour effectuer sa t√¢che, comme d√©taill√© dans la documentation d'Apple.

### **Consid√©rations de s√©curit√©**

Les principaux aspects de s√©curit√© incluent :

- Les extensions et leurs applications contenant communiquent via la communication inter-processus, pas directement.
- Le **widget Aujourd'hui** est unique en ce sens qu'il peut demander √† son application de s'ouvrir via une m√©thode sp√©cifique.
- L'acc√®s aux donn√©es partag√©es est autoris√© dans un conteneur priv√©, mais l'acc√®s direct est restreint.
- Certaines API, y compris HealthKit, sont interdites aux extensions d'application, qui ne peuvent √©galement pas d√©marrer de t√¢ches de longue dur√©e, acc√©der √† la cam√©ra ou au microphone, sauf pour les extensions iMessage.

### Analyse statique

#### **Identification des extensions d'application**

Pour trouver des extensions d'application dans le code source, recherchez `NSExtensionPointIdentifier` dans Xcode ou inspectez le bundle de l'application pour des fichiers `.appex` indiquant des extensions. Sans code source, utilisez grep ou SSH pour localiser ces identifiants dans le bundle de l'application.

#### **Types de donn√©es pris en charge**

V√©rifiez le fichier `Info.plist` d'une extension pour `NSExtensionActivationRule` afin d'identifier les types de donn√©es pris en charge. Cette configuration garantit que seuls les types de donn√©es compatibles d√©clenchent l'extension dans les applications h√¥tes.

#### **Partage de donn√©es**

Le partage de donn√©es entre une application et son extension n√©cessite un conteneur partag√©, configur√© via "App Groups" et accessible via `NSUserDefaults`. Cet espace partag√© est n√©cessaire pour les transferts en arri√®re-plan initi√©s par les extensions.

#### **Restriction des extensions**

Les applications peuvent restreindre certains types d'extensions, en particulier les claviers personnalis√©s, garantissant que le traitement des donn√©es sensibles est conforme aux protocoles de s√©curit√©.

### Analyse dynamique

L'analyse dynamique implique :

- **Inspection des √©l√©ments partag√©s** : Acc√©dez √† `NSExtensionContext - inputItems` pour voir les types de donn√©es et leurs origines partag√©es.
- **Identification des extensions** : D√©couvrez quelles extensions traitent vos donn√©es en observant les m√©canismes internes, comme `NSXPCConnection`.

Des outils comme `frida-trace` peuvent aider √† comprendre les processus sous-jacents, en particulier pour ceux qui s'int√©ressent aux d√©tails techniques de la communication inter-processus.

## R√©f√©rences
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
