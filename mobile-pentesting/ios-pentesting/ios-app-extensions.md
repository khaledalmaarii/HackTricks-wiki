# iOS App Extensions

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Rozszerzenia aplikacji zwikszaj funkcjonalno aplikacji, umo偶liwiajc im interakcj z innymi aplikacjami lub systemem, oferujc niestandardowe funkcje lub treci. Te rozszerzenia obejmuj:

- **Niestandardowa klawiatura**: Oferuje unikaln klawiatur we wszystkich aplikacjach, zastpujc domyln klawiatur iOS.
- **Udostpnij**: Umo偶liwia udostpnianie w sieciach spoecznociowych lub innym u偶ytkownikom bezporednio.
- **Dzi (Widgety)**: Dostarcza treci lub wykonuje zadania szybko z widoku Dzi w Centrum powiadomie.

Gdy u偶ytkownik korzysta z tych rozszerze, takich jak udostpnianie tekstu z aplikacji g贸wnej, rozszerzenie przetwarza ten input w swoim kontekcie, wykorzystujc udostpnione informacje do wykonania swojego zadania, jak opisano w dokumentacji Apple.

### **Rozwa偶ania dotyczce bezpieczestwa**

Kluczowe aspekty bezpieczestwa obejmuj:

- Rozszerzenia i ich aplikacje komunikuj si za pomoc komunikacji midzyprocesowej, a nie bezporednio.
- **Widget Dzi** jest wyjtkowy, poniewa偶 mo偶e za偶da, aby jego aplikacja otworzya si za pomoc okrelonej metody.
- Dostp do udostpnionych danych jest dozwolony w ramach prywatnego kontenera, ale bezporedni dostp jest ograniczony.
- Niekt贸re API, w tym HealthKit, s niedostpne dla rozszerze aplikacji, kt贸re r贸wnie偶 nie mog uruchamia dugoterminowych zada, uzyskiwa dostpu do kamery ani mikrofonu, z wyjtkiem rozszerze iMessage.

### Analiza statyczna

#### **Identyfikacja rozszerze aplikacji**

Aby znale藕 rozszerzenia aplikacji w kodzie 藕r贸dowym, wyszukaj `NSExtensionPointIdentifier` w Xcode lub sprawd藕 pakiet aplikacji pod ktem plik贸w `.appex`, kt贸re wskazuj na rozszerzenia. Bez kodu 藕r贸dowego u偶yj grep lub SSH, aby zlokalizowa te identyfikatory w pakiecie aplikacji.

#### **Obsugiwane typy danych**

Sprawd藕 plik `Info.plist` rozszerzenia pod ktem `NSExtensionActivationRule`, aby zidentyfikowa obsugiwane typy danych. Ta konfiguracja zapewnia, 偶e tylko kompatybilne typy danych uruchamiaj rozszerzenie w aplikacjach g贸wnych.

#### **Udostpnianie danych**

Udostpnianie danych midzy aplikacj a jej rozszerzeniem wymaga wsp贸lnego kontenera, skonfigurowanego za pomoc "Grup aplikacji" i uzyskiwanego przez `NSUserDefaults`. Ta wsp贸lna przestrze jest niezbdna do transfer贸w w tle inicjowanych przez rozszerzenia.

#### **Ograniczanie rozszerze**

Aplikacje mog ogranicza niekt贸re typy rozszerze, szczeg贸lnie niestandardowe klawiatury, zapewniajc, 偶e obsuga wra偶liwych danych jest zgodna z protokoami bezpieczestwa.

### Analiza dynamiczna

Analiza dynamiczna obejmuje:

- **Inspekcj udostpnionych element贸w**: Podcz si do `NSExtensionContext - inputItems`, aby zobaczy typy i 藕r贸da udostpnianych danych.
- **Identyfikacj rozszerze**: Odkryj, kt贸re rozszerzenia przetwarzaj twoje dane, obserwujc wewntrzne mechanizmy, takie jak `NSXPCConnection`.

Narzdzia takie jak `frida-trace` mog pom贸c w zrozumieniu podstawowych proces贸w, szczeg贸lnie dla tych, kt贸rzy s zainteresowani technicznymi szczeg贸ami komunikacji midzyprocesowej.

## Referencje
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
