# iOS App Extensions

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}

As extens√µes de aplicativos aprimoram a funcionalidade dos aplicativos, permitindo que interajam com outros aplicativos ou com o sistema, fornecendo recursos ou conte√∫do personalizados. Essas extens√µes incluem:

- **Teclado Personalizado**: Oferece um teclado exclusivo em todos os aplicativos, substituindo o teclado padr√£o do iOS.
- **Compartilhar**: Permite compartilhar em redes sociais ou com outros diretamente.
- **Hoje (Widgets)**: Fornece conte√∫do ou realiza tarefas rapidamente a partir da visualiza√ß√£o Hoje do Centro de Notifica√ß√µes.

Quando um usu√°rio interage com essas extens√µes, como compartilhar texto de um aplicativo host, a extens√£o processa essa entrada dentro de seu contexto, aproveitando as informa√ß√µes compartilhadas para realizar sua tarefa, conforme detalhado na documenta√ß√£o da Apple.

### **Considera√ß√µes de Seguran√ßa**

Os principais aspectos de seguran√ßa incluem:

- Extens√µes e seus aplicativos contidos se comunicam via comunica√ß√£o entre processos, n√£o diretamente.
- O **widget Hoje** √© √∫nico, pois pode solicitar que seu aplicativo seja aberto por meio de um m√©todo espec√≠fico.
- O acesso a dados compartilhados √© permitido dentro de um cont√™iner privado, mas o acesso direto √© restrito.
- Certas APIs, incluindo HealthKit, est√£o fora dos limites para extens√µes de aplicativos, que tamb√©m n√£o podem iniciar tarefas de longa dura√ß√£o, acessar a c√¢mera ou o microfone, exceto para extens√µes do iMessage.

### An√°lise Est√°tica

#### **Identificando Extens√µes de Aplicativos**

Para encontrar extens√µes de aplicativos no c√≥digo-fonte, procure por `NSExtensionPointIdentifier` no Xcode ou inspecione o pacote do aplicativo em busca de arquivos `.appex` que indiquem extens√µes. Sem o c√≥digo-fonte, use grep ou SSH para localizar esses identificadores dentro do pacote do aplicativo.

#### **Tipos de Dados Suportados**

Verifique o arquivo `Info.plist` de uma extens√£o para `NSExtensionActivationRule` para identificar os tipos de dados suportados. Essa configura√ß√£o garante que apenas tipos de dados compat√≠veis acionem a extens√£o em aplicativos host.

#### **Compartilhamento de Dados**

O compartilhamento de dados entre um aplicativo e sua extens√£o requer um cont√™iner compartilhado, configurado via "Grupos de Aplicativos" e acessado atrav√©s de `NSUserDefaults`. Esse espa√ßo compartilhado √© necess√°rio para transfer√™ncias em segundo plano iniciadas por extens√µes.

#### **Restringindo Extens√µes**

Os aplicativos podem restringir certos tipos de extens√µes, particularmente teclados personalizados, garantindo que o manuseio de dados sens√≠veis esteja alinhado com os protocolos de seguran√ßa.

### An√°lise Din√¢mica

A an√°lise din√¢mica envolve:

- **Inspecionando Itens Compartilhados**: Intercepte `NSExtensionContext - inputItems` para ver tipos de dados e origens compartilhados.
- **Identificando Extens√µes**: Descubra quais extens√µes processam seus dados observando mecanismos internos, como `NSXPCConnection`.

Ferramentas como `frida-trace` podem ajudar a entender os processos subjacentes, especialmente para aqueles interessados nos detalhes t√©cnicos da comunica√ß√£o entre processos.

## Refer√™ncias
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
