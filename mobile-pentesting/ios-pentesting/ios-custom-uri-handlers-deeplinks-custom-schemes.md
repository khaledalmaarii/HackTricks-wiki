<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

è¿™æ˜¯æ¥è‡ª[https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)ç›¸å…³ä¿¡æ¯çš„æ‘˜è¦ã€‚

## åŸºæœ¬ä¿¡æ¯

è‡ªå®šä¹‰URL schemesä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä½¿ç”¨è‡ªå®šä¹‰åè®®è¿›è¡Œé€šä¿¡ï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…[Appleå¼€å‘äººå‘˜æ–‡æ¡£](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)ã€‚è¿™äº›æ–¹æ¡ˆå¿…é¡»ç”±åº”ç”¨ç¨‹åºå£°æ˜ï¼Œç„¶åå¤„ç†éµå¾ªè¿™äº›æ–¹æ¡ˆçš„ä¼ å…¥URLã€‚**éªŒè¯æ‰€æœ‰URLå‚æ•°**å¹¶**ä¸¢å¼ƒä»»ä½•æ ¼å¼é”™è¯¯çš„URL**æ˜¯è‡³å…³é‡è¦çš„ï¼Œä»¥é˜²æ­¢é€šè¿‡æ­¤å‘é‡è¿›è¡Œæ”»å‡»ã€‚

ä¸¾ä¾‹è¯´æ˜ï¼ŒURI `myapp://hostname?data=123876123` è°ƒç”¨ç‰¹å®šåº”ç”¨ç¨‹åºæ“ä½œã€‚ä¸€ä¸ªå·²çŸ¥çš„æ¼æ´å‡ºç°åœ¨Skypeç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå…è®¸é€šè¿‡`skype://`åè®®æ‰§è¡Œæœªç»è®¸å¯çš„å‘¼å«æ“ä½œã€‚æ³¨å†Œçš„æ–¹æ¡ˆå¯ä»¥åœ¨åº”ç”¨ç¨‹åºçš„`Info.plist`ä¸­çš„`CFBundleURLTypes`ä¸‹æ‰¾åˆ°ã€‚æ¶æ„åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡é‡æ–°æ³¨å†ŒURIæ¥æ‹¦æˆªæ•æ„Ÿä¿¡æ¯æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚

### åº”ç”¨ç¨‹åºæŸ¥è¯¢æ–¹æ¡ˆæ³¨å†Œ

ä»iOS 9.0å¼€å§‹ï¼Œè¦æ£€æŸ¥åº”ç”¨ç¨‹åºæ˜¯å¦å¯ç”¨ï¼Œ`canOpenURL:`éœ€è¦åœ¨`Info.plist`ä¸­çš„`LSApplicationQueriesSchemes`ä¸‹å£°æ˜URL schemesã€‚è¿™é™åˆ¶äº†åº”ç”¨ç¨‹åºå¯ä»¥æŸ¥è¯¢çš„æ–¹æ¡ˆä¸º50ä¸ªï¼Œé€šè¿‡é˜»æ­¢åº”ç”¨ç¨‹åºæšä¸¾æ¥å¢å¼ºéšç§ã€‚
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### æµ‹è¯•URLå¤„ç†å’ŒéªŒè¯

å¼€å‘äººå‘˜åº”æ£€æŸ¥æºä»£ç ä¸­çš„ç‰¹å®šæ–¹æ³•ï¼Œä»¥äº†è§£URLè·¯å¾„çš„æ„å»ºå’ŒéªŒè¯ï¼Œä¾‹å¦‚ `application:didFinishLaunchingWithOptions:` å’Œ `application:openURL:options:`ã€‚ä¾‹å¦‚ï¼ŒTelegram ä½¿ç”¨å„ç§æ–¹æ³•æ¥æ‰“å¼€URLï¼š
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### æµ‹è¯•å‘å…¶ä»–åº”ç”¨ç¨‹åºå‘é€URLè¯·æ±‚

è¯¸å¦‚ `openURL:options:completionHandler:` è¿™æ ·çš„æ–¹æ³•å¯¹äºæ‰“å¼€URLä»¥ä¸å…¶ä»–åº”ç”¨ç¨‹åºäº¤äº’è‡³å…³é‡è¦ã€‚è¯†åˆ«åº”ç”¨ç¨‹åºæºä»£ç ä¸­å¯¹è¿™äº›æ–¹æ³•çš„ä½¿ç”¨å¯¹äºç†è§£å¤–éƒ¨é€šä¿¡è‡³å…³é‡è¦ã€‚

### æµ‹è¯•å·²å¼ƒç”¨çš„æ–¹æ³•

åº”è¯¥è¯†åˆ«å¤„ç†URLæ‰“å¼€çš„å·²å¼ƒç”¨æ–¹æ³•ï¼Œä¾‹å¦‚ `application:handleOpenURL:` å’Œ `openURL:`ï¼Œå¹¶å°±å®‰å…¨å½±å“è¿›è¡Œå®¡æŸ¥ã€‚

### å¯¹URL Scheme è¿›è¡Œæ¨¡ç³Šæµ‹è¯•

å¯¹URL Scheme è¿›è¡Œæ¨¡ç³Šæµ‹è¯•å¯ä»¥è¯†åˆ«å†…å­˜æŸåæ¼æ´ã€‚åƒ[Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/)è¿™æ ·çš„å·¥å…·å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸åŒæœ‰æ•ˆè´Ÿè½½æ‰“å¼€URLæ¥ç›‘è§†å´©æºƒï¼Œä¾‹å¦‚åœ¨ iGoat-Swift åº”ç”¨ç¨‹åºä¸­æ“çºµURLã€‚
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## å‚è€ƒèµ„æ–™
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼:

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­è¢«å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚ 

</details>
