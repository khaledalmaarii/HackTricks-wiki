{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a sumary from the related information from [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

## Basic Information

ì‚¬ìš©ì ì •ì˜ URL ìŠ¤í‚´ì€ ì•±ì´ ì‚¬ìš©ì ì •ì˜ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ í•˜ë©°, ì´ëŠ” [Apple Developer Documentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)ì—ì„œ ìì„¸íˆ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìŠ¤í‚´ì€ ì•±ì—ì„œ ì„ ì–¸í•´ì•¼ í•˜ë©°, ì´í›„ í•´ë‹¹ ìŠ¤í‚´ì— ë”°ë¼ ë“¤ì–´ì˜¤ëŠ” URLì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. **ëª¨ë“  URL ë§¤ê°œë³€ìˆ˜ë¥¼ ê²€ì¦**í•˜ê³  **í˜•ì‹ì´ ì˜ëª»ëœ URLì„ íê¸°**í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ì—¬, ì´ë¥¼ í†µí•´ ê³µê²©ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, URI `myapp://hostname?data=123876123`ëŠ” íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ì—…ì„ í˜¸ì¶œí•©ë‹ˆë‹¤. ì£¼ëª©í•  ë§Œí•œ ì·¨ì•½ì ì€ Skype Mobile ì•±ì—ì„œ ë°œê²¬ë˜ì—ˆìœ¼ë©°, ì´ëŠ” `skype://` í”„ë¡œí† ì½œì„ í†µí•´ í—ˆê°€ë˜ì§€ ì•Šì€ í†µí™” ì‘ì—…ì„ í—ˆìš©í–ˆìŠµë‹ˆë‹¤. ë“±ë¡ëœ ìŠ¤í‚´ì€ ì•±ì˜ `Info.plist`ì˜ `CFBundleURLTypes`ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•…ì˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ URIë¥¼ ì¬ë“±ë¡í•˜ì—¬ ë¯¼ê°í•œ ì •ë³´ë¥¼ ê°€ë¡œì±Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Application Query Schemes Registration

iOS 9.0ë¶€í„°, ì•±ì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ `canOpenURL:`ëŠ” `Info.plist`ì˜ `LSApplicationQueriesSchemes`ì— URL ìŠ¤í‚´ì„ ì„ ì–¸í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì•±ì´ ì¿¼ë¦¬í•  ìˆ˜ ìˆëŠ” ìŠ¤í‚´ì„ 50ê°œë¡œ ì œí•œí•˜ì—¬ ì•± ì—´ê±°ë¥¼ ë°©ì§€í•˜ê³  ê°œì¸ ì •ë³´ë¥¼ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### Testing URL Handling and Validation

ê°œë°œìëŠ” `application:didFinishLaunchingWithOptions:` ë° `application:openURL:options:`ì™€ ê°™ì€ ì†ŒìŠ¤ ì½”ë“œì˜ íŠ¹ì • ë©”ì„œë“œë¥¼ ê²€ì‚¬í•˜ì—¬ URL ê²½ë¡œ êµ¬ì„± ë° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Telegramì€ URLì„ ì—¬ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### ë‹¤ë¥¸ ì•±ì— ëŒ€í•œ URL ìš”ì²­ í…ŒìŠ¤íŠ¸

`openURL:options:completionHandler:`ì™€ ê°™ì€ ë©”ì„œë“œëŠ” ë‹¤ë¥¸ ì•±ê³¼ ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•´ URLì„ ì—¬ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. ì•±ì˜ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì´ëŸ¬í•œ ë©”ì„œë“œì˜ ì‚¬ìš©ì„ ì‹ë³„í•˜ëŠ” ê²ƒì€ ì™¸ë¶€ í†µì‹ ì„ ì´í•´í•˜ëŠ” ë° í•µì‹¬ì…ë‹ˆë‹¤.

### ì‚¬ìš© ì¤‘ë‹¨ëœ ë©”ì„œë“œ í…ŒìŠ¤íŠ¸

`application:handleOpenURL:` ë° `openURL:`ì™€ ê°™ì€ URL ì—´ê¸°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‚¬ìš© ì¤‘ë‹¨ëœ ë©”ì„œë“œëŠ” ì‹ë³„í•˜ê³  ë³´ì•ˆ ì˜í–¥ì„ ê²€í† í•´ì•¼ í•©ë‹ˆë‹¤.

### URL ìŠ¤í‚´ í¼ì§•

URL ìŠ¤í‚´ í¼ì§•ì€ ë©”ëª¨ë¦¬ ì†ìƒ ë²„ê·¸ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. [Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/)ì™€ ê°™ì€ ë„êµ¬ëŠ” ë‹¤ì–‘í•œ í˜ì´ë¡œë“œë¡œ URLì„ ì—´ì–´ ì¶©ëŒì„ ëª¨ë‹ˆí„°ë§í•˜ì—¬ ì´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” iGoat-Swift ì•±ì—ì„œ URLì„ ì¡°ì‘í•œ ì˜ˆë¡œ ì„¤ëª…ë©ë‹ˆë‹¤:
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## References
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
