{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

è¿™æ˜¯æ¥è‡ª [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/) çš„ç›¸å…³ä¿¡æ¯æ‘˜è¦

## åŸºæœ¬ä¿¡æ¯

è‡ªå®šä¹‰ URL æ–¹æ¡ˆä½¿åº”ç”¨èƒ½å¤Ÿä½¿ç”¨è‡ªå®šä¹‰åè®®è¿›è¡Œé€šä¿¡ï¼Œè¯¦ç»†ä¿¡æ¯è§ [Apple Developer Documentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)ã€‚è¿™äº›æ–¹æ¡ˆå¿…é¡»ç”±åº”ç”¨å£°æ˜ï¼Œç„¶åå¤„ç†éµå¾ªè¿™äº›æ–¹æ¡ˆçš„ä¼ å…¥ URLã€‚è‡³å…³é‡è¦çš„æ˜¯ **éªŒè¯æ‰€æœ‰ URL å‚æ•°** å¹¶ **ä¸¢å¼ƒä»»ä½•æ ¼å¼ä¸æ­£ç¡®çš„ URL** ä»¥é˜²æ­¢é€šè¿‡æ­¤å‘é‡è¿›è¡Œæ”»å‡»ã€‚

ç»™å‡ºäº†ä¸€ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­ URI `myapp://hostname?data=123876123` è°ƒç”¨ç‰¹å®šçš„åº”ç”¨æ“ä½œã€‚ä¸€ä¸ªå·²çŸ¥çš„æ¼æ´å‡ºç°åœ¨ Skype Mobile åº”ç”¨ä¸­ï¼Œå®ƒå…è®¸é€šè¿‡ `skype://` åè®®è¿›è¡Œæœªæˆæƒçš„å‘¼å«æ“ä½œã€‚æ³¨å†Œçš„æ–¹æ¡ˆå¯ä»¥åœ¨åº”ç”¨çš„ `Info.plist` ä¸­çš„ `CFBundleURLTypes` ä¸‹æ‰¾åˆ°ã€‚æ¶æ„åº”ç”¨å¯ä»¥é€šè¿‡é‡æ–°æ³¨å†Œ URI æ¥æ‹¦æˆªæ•æ„Ÿä¿¡æ¯ã€‚

### åº”ç”¨æŸ¥è¯¢æ–¹æ¡ˆæ³¨å†Œ

ä» iOS 9.0 å¼€å§‹ï¼Œè¦æ£€æŸ¥åº”ç”¨æ˜¯å¦å¯ç”¨ï¼Œ`canOpenURL:` éœ€è¦åœ¨ `Info.plist` ä¸­çš„ `LSApplicationQueriesSchemes` ä¸‹å£°æ˜ URL æ–¹æ¡ˆã€‚è¿™å°†åº”ç”¨å¯ä»¥æŸ¥è¯¢çš„æ–¹æ¡ˆé™åˆ¶ä¸º 50ï¼Œå¢å¼ºäº†éšç§ï¼Œé˜²æ­¢äº†åº”ç”¨æšä¸¾ã€‚
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### æµ‹è¯• URL å¤„ç†å’ŒéªŒè¯

å¼€å‘è€…åº”æ£€æŸ¥æºä»£ç ä¸­çš„ç‰¹å®šæ–¹æ³•ï¼Œä»¥äº†è§£ URL è·¯å¾„æ„é€ å’ŒéªŒè¯ï¼Œä¾‹å¦‚ `application:didFinishLaunchingWithOptions:` å’Œ `application:openURL:options:`ã€‚ä¾‹å¦‚ï¼ŒTelegram ä½¿ç”¨å¤šç§æ–¹æ³•æ¥æ‰“å¼€ URLï¼š
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### æµ‹è¯•å¯¹å…¶ä»–åº”ç”¨çš„ URL è¯·æ±‚

åƒ `openURL:options:completionHandler:` è¿™æ ·çš„æ–¹æ³•å¯¹äºæ‰“å¼€ URL ä»¥ä¸å…¶ä»–åº”ç”¨äº¤äº’è‡³å…³é‡è¦ã€‚è¯†åˆ«åº”ç”¨æºä»£ç ä¸­æ­¤ç±»æ–¹æ³•çš„ä½¿ç”¨å¯¹äºç†è§£å¤–éƒ¨é€šä¿¡è‡³å…³é‡è¦ã€‚

### æµ‹è¯•å·²å¼ƒç”¨çš„æ–¹æ³•

å¤„ç† URL æ‰“å¼€çš„å·²å¼ƒç”¨æ–¹æ³•ï¼Œå¦‚ `application:handleOpenURL:` å’Œ `openURL:`ï¼Œåº”è¢«è¯†åˆ«å¹¶å®¡æŸ¥å…¶å®‰å…¨å½±å“ã€‚

### æ¨¡ç³Šæµ‹è¯• URL æ–¹æ¡ˆ

æ¨¡ç³Šæµ‹è¯• URL æ–¹æ¡ˆå¯ä»¥è¯†åˆ«å†…å­˜æŸåæ¼æ´ã€‚åƒ [Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) è¿™æ ·çš„å·¥å…·å¯ä»¥é€šè¿‡æ‰“å¼€å…·æœ‰ä¸åŒæœ‰æ•ˆè´Ÿè½½çš„ URL æ¥è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ï¼Œä»¥ç›‘æ§å´©æºƒï¼Œç¤ºä¾‹ä¸º iGoat-Swift åº”ç”¨ä¸­ URL çš„æ“æ§ï¼š
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## å‚è€ƒæ–‡çŒ®
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
