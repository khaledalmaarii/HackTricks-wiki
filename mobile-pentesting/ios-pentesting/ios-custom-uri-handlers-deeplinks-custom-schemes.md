<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE PRETPLATE**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

Ovo je sa쬰tak povezanih informacija sa [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

## Osnovne informacije

Prilago캠ene URL 코eme omogu캖avaju aplikacijama da komuniciraju koriste캖i prilago캠eni protokol, kako je detaljno opisano u [Apple Developer dokumentaciji](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1). Ove 코eme moraju biti deklarisane od strane aplikacije, koja zatim obra캠uje dolazne URL-ove koji slede te 코eme. Va쬹o je **validirati sve parametre URL-a** i **odbaciti bilo kakve neispravne URL-ove** kako bi se spre캜ili napadi putem ovog vektora.

Dato je primer gde URI `myapp://hostname?data=123876123` pokre캖e odre캠enu akciju aplikacije. Prime캖ena ranjivost bila je u Skype Mobile aplikaciji, koja je omogu캖avala neovla코tene pozive putem `skype://` protokola. Registrovane 코eme mogu se prona캖i u `Info.plist` datoteci aplikacije pod `CFBundleURLTypes`. Zlonamerne aplikacije mogu iskoristiti ovo tako 코to 캖e ponovo registrovati URI-jeve kako bi presrele osetljive informacije.

### Registracija 코ema upita aplikacije

Od iOS 9.0, da bi se proverilo da li je aplikacija dostupna, `canOpenURL:` zahteva deklarisanje URL 코ema u `Info.plist` datoteci pod `LSApplicationQueriesSchemes`. Ovo ograni캜ava 코eme koje aplikacija mo쬰 koristiti za upite na 50, pobolj코avaju캖i privatnost spre캜avanjem enumeracije aplikacija.
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### Testiranje obrade i validacije URL-ova

Razvojni programeri trebaju pregledati odre캠ene metode u izvornom kodu kako bi razumeli konstrukciju i validaciju putanje URL-a, kao 코to su `application:didFinishLaunchingWithOptions:` i `application:openURL:options:`. Na primer, Telegram koristi razli캜ite metode za otvaranje URL-ova:
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### Testiranje URL zahteva drugim aplikacijama

Metode poput `openURL:options:completionHandler:` su klju캜ne za otvaranje URL-ova i interakciju sa drugim aplikacijama. Identifikacija kori코캖enja ovih metoda u izvornom kodu aplikacije je klju캜na za razumevanje spoljnih komunikacija.

### Testiranje zastarelih metoda

Zastarele metode za obradu otvaranja URL-ova, poput `application:handleOpenURL:` i `openURL:`, treba identifikovati i pregledati zbog bezbednosnih implikacija.

### Fuzziranje URL 코ema

Fuzziranje URL 코ema mo쬰 identifikovati gre코ke u memoriji. Alati poput [Fride](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) mogu automatizovati ovaj proces otvaranjem URL-ova sa razli캜itim payload-ima kako bi se pratili padovi, kao 코to je manipulacija URL-ovima u iGoat-Swift aplikaciji:
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## Reference
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
