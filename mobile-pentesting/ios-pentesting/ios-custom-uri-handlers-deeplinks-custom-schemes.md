<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

Bu, [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/) adresindeki ilgili bilgilerin bir Ã¶zetidir.

## Temel Bilgiler

Ã–zel URL ÅŸemalarÄ±, uygulamalarÄ±n Ã¶zel bir protokol kullanarak iletiÅŸim kurmasÄ±nÄ± saÄŸlar ve ayrÄ±ntÄ±larÄ± [Apple GeliÅŸtirici Belgeleri](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)nde aÃ§Ä±klanmÄ±ÅŸtÄ±r. Bu ÅŸemalar, uygulama tarafÄ±ndan bildirilmeli ve ardÄ±ndan bu ÅŸemalara uygun gelen URL'leri iÅŸlemlemelidir. Bu vektÃ¶r aracÄ±lÄ±ÄŸÄ±yla gerÃ§ekleÅŸebilecek saldÄ±rÄ±larÄ± Ã¶nlemek iÃ§in **tÃ¼m URL parametrelerini doÄŸrulamak** ve **hatalÄ± URL'leri reddetmek** Ã¶nemlidir.

Ã–rneÄŸin, `myapp://hostname?data=123876123` URI'si belirli bir uygulama eylemini Ã§aÄŸÄ±rÄ±r. Skype Mobile uygulamasÄ±nda bir zafiyet, `skype://` protokolÃ¼ aracÄ±lÄ±ÄŸÄ±yla izin verilmeyen Ã§aÄŸrÄ± eylemlerine izin veriyordu. KayÄ±tlÄ± ÅŸemalar, uygulamanÄ±n `Info.plist` dosyasÄ±nÄ±n `CFBundleURLTypes` bÃ¶lÃ¼mÃ¼nde bulunabilir. KÃ¶tÃ¼ niyetli uygulamalar, hassas bilgileri ele geÃ§irmek iÃ§in URI'leri yeniden kaydederek bunu istismar edebilir.

### Uygulama Sorgu ÅemalarÄ±nÄ±n Kaydedilmesi

iOS 9.0'dan itibaren bir uygulamanÄ±n mevcut olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in `canOpenURL:` iÅŸlevi, URL ÅŸemalarÄ±nÄ±n `Info.plist` dosyasÄ±nÄ±n `LSApplicationQueriesSchemes` bÃ¶lÃ¼mÃ¼nde bildirilmesini gerektirir. Bu, bir uygulamanÄ±n sorgulayabileceÄŸi ÅŸemalarÄ± 50 ile sÄ±nÄ±rlayarak gizliliÄŸi artÄ±rÄ±r ve uygulama numaralandÄ±rmasÄ±nÄ± engeller.
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### URL Ä°ÅŸleme ve DoÄŸrulama Testi

GeliÅŸtiriciler, URL yolunun oluÅŸturulmasÄ± ve doÄŸrulanmasÄ± hakkÄ±nda bilgi edinmek iÃ§in kaynak koddaki belirli yÃ¶ntemleri incelemelidir, Ã¶rneÄŸin `application:didFinishLaunchingWithOptions:` ve `application:openURL:options:`. Ã–rneÄŸin, Telegram, URL'leri aÃ§mak iÃ§in Ã§eÅŸitli yÃ¶ntemler kullanÄ±r:
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### DiÄŸer Uygulamalara YÃ¶nelik URL Ä°steklerini Test Etme

`openURL:options:completionHandler:` gibi yÃ¶ntemler, diÄŸer uygulamalarla etkileÅŸim iÃ§in URL'leri aÃ§mak iÃ§in Ã¶nemlidir. Bu tÃ¼r yÃ¶ntemlerin uygulamanÄ±n kaynak kodunda kullanÄ±mÄ±nÄ± belirlemek, harici iletiÅŸimi anlamak iÃ§in Ã¶nemlidir.

### KullanÄ±mdan KaldÄ±rÄ±lan YÃ¶ntemleri Test Etme

`application:handleOpenURL:` ve `openURL:` gibi URL aÃ§ma iÅŸlemlerini yÃ¶neten kullanÄ±mdan kaldÄ±rÄ±lan yÃ¶ntemler, gÃ¼venlikle ilgili sonuÃ§larÄ± deÄŸerlendirmek iÃ§in belirlenmeli ve incelenmelidir.

### URL ÅemalarÄ±nÄ± Fuzzing Yapma

URL ÅŸemalarÄ±nÄ± fuzzing yapmak, bellek bozulma hatalarÄ±nÄ± belirleyebilir. [Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) gibi araÃ§lar, deÄŸiÅŸen yÃ¼klerle URL'leri aÃ§arak Ã§Ã¶kme durumlarÄ±nÄ± izlemek iÃ§in bu sÃ¼reci otomatikleÅŸtirebilir. Bu, iGoat-Swift uygulamasÄ±ndaki URL'lerin manipÃ¼lasyonuyla Ã¶rneklenir:
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## Referanslar
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmaya kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
