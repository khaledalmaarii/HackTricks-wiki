{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

ã“ã‚Œã¯ã€[https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)ã«é–¢é€£ã™ã‚‹æƒ…å ±ã®è¦ç´„ã§ã™ã€‚

## åŸºæœ¬æƒ…å ±

ã‚«ã‚¹ã‚¿ãƒ URLã‚¹ã‚­ãƒ¼ãƒ ã¯ã€ã‚¢ãƒ—ãƒªãŒã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦é€šä¿¡ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚è©³ç´°ã¯[Apple Developer Documentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¹ã‚­ãƒ¼ãƒ ã¯ã‚¢ãƒ—ãƒªã«ã‚ˆã£ã¦å®£è¨€ã•ã‚Œã€ã‚¢ãƒ—ãƒªã¯ãã®ã‚¹ã‚­ãƒ¼ãƒ ã«å¾“ã£ã¦å—ä¿¡ã—ãŸURLã‚’å‡¦ç†ã—ã¾ã™ã€‚ã™ã¹ã¦ã®URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’**æ¤œè¨¼ã—**ã€**ä¸æ­£ãªURLã‚’ç ´æ£„ã™ã‚‹**ã“ã¨ãŒé‡è¦ã§ã™ã€‚ã“ã®ãƒ™ã‚¯ã‚¿ãƒ¼ã‚’é€šã˜ãŸæ”»æ’ƒã‚’é˜²ããŸã‚ã§ã™ã€‚

ä¾‹ã¨ã—ã¦ã€URI `myapp://hostname?data=123876123`ãŒç‰¹å®šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚æ³¨ç›®ã™ã¹ãè„†å¼±æ€§ã¯ã€Skype Mobileã‚¢ãƒ—ãƒªã«ã‚ã‚Šã€`skype://`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä»‹ã—ã¦è¨±å¯ã•ã‚Œã¦ã„ãªã„é€šè©±ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¯èƒ½ã«ã—ã¾ã—ãŸã€‚ç™»éŒ²ã•ã‚ŒãŸã‚¹ã‚­ãƒ¼ãƒ ã¯ã€ã‚¢ãƒ—ãƒªã®`Info.plist`ã®`CFBundleURLTypes`ã«è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ‚ªæ„ã®ã‚ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€URIã‚’å†ç™»éŒ²ã™ã‚‹ã“ã¨ã§æ©Ÿå¯†æƒ…å ±ã‚’å‚å—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã‚¹ã‚­ãƒ¼ãƒ ã®ç™»éŒ²

iOS 9.0ä»¥é™ã€ã‚¢ãƒ—ãƒªãŒåˆ©ç”¨å¯èƒ½ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€`canOpenURL:`ã¯`Info.plist`ã®`LSApplicationQueriesSchemes`ã«URLã‚¹ã‚­ãƒ¼ãƒ ã‚’å®£è¨€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªãŒã‚¯ã‚¨ãƒªã§ãã‚‹ã‚¹ã‚­ãƒ¼ãƒ ã¯50ã«åˆ¶é™ã•ã‚Œã€ã‚¢ãƒ—ãƒªã®åˆ—æŒ™ã‚’é˜²ãã“ã¨ã§ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãŒå‘ä¸Šã—ã¾ã™ã€‚
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### URLå‡¦ç†ã¨æ¤œè¨¼ã®ãƒ†ã‚¹ãƒˆ

é–‹ç™ºè€…ã¯ã€`application:didFinishLaunchingWithOptions:`ã‚„`application:openURL:options:`ãªã©ã€URLãƒ‘ã‚¹ã®æ§‹ç¯‰ã¨æ¤œè¨¼ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¤œæŸ»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€Telegramã¯URLã‚’é–‹ããŸã‚ã«ã•ã¾ã–ã¾ãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼š
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### ä»–ã®ã‚¢ãƒ—ãƒªã¸ã®URLãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆ

`openURL:options:completionHandler:`ã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ä»–ã®ã‚¢ãƒ—ãƒªã¨å¯¾è©±ã™ã‚‹ãŸã‚ã«URLã‚’é–‹ãã®ã«é‡è¦ã§ã™ã€‚ã‚¢ãƒ—ãƒªã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã§ãã®ã‚ˆã†ãªãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ç”¨ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ã¯ã€å¤–éƒ¨é€šä¿¡ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®éµã§ã™ã€‚

### éæ¨å¥¨ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ†ã‚¹ãƒˆ

`application:handleOpenURL:`ã‚„`openURL:`ã®ã‚ˆã†ãªURLã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã‚’æ‰±ã†éæ¨å¥¨ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ç‰¹å®šã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¸ã®å½±éŸ¿ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### URLã‚¹ã‚­ãƒ¼ãƒ ã®ãƒ•ã‚¡ã‚¸ãƒ³ã‚°

URLã‚¹ã‚­ãƒ¼ãƒ ã®ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã¯ã€ãƒ¡ãƒ¢ãƒªç ´æãƒã‚°ã‚’ç‰¹å®šã§ãã¾ã™ã€‚[Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã¯ã€ã•ã¾ã–ã¾ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§URLã‚’é–‹ã„ã¦ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã‚’ç›£è¦–ã™ã‚‹ã“ã¨ã§ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€iGoat-Swiftã‚¢ãƒ—ãƒªã§ã®URLã®æ“ä½œã«ã‚ˆã£ã¦ä¾‹ç¤ºã•ã‚Œã¾ã™ï¼š
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## å‚è€ƒæ–‡çŒ®
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
