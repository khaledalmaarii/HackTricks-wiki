{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

ä»£ç å’Œæ›´å¤šä¿¡æ¯è¯·è§ [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence)ã€‚

## iOS å¼€å‘ä¸­çš„å¯¹è±¡åºåˆ—åŒ–

åœ¨ iOS ä¸­ï¼Œ**å¯¹è±¡åºåˆ—åŒ–** æ¶‰åŠå°†å¯¹è±¡è½¬æ¢ä¸ºå¯ä»¥è½»æ¾å­˜å‚¨æˆ–ä¼ è¾“çš„æ ¼å¼ï¼Œç„¶ååœ¨éœ€è¦æ—¶ä»è¯¥æ ¼å¼é‡å»ºå®ƒä»¬ã€‚ä¸¤ä¸ªä¸»è¦åè®®ï¼Œ**`NSCoding`** å’Œ **`NSSecureCoding`**ï¼Œä¸º Objective-C æˆ– `NSObject` å­ç±»æä¾›äº†è¿™ä¸€è¿‡ç¨‹ï¼Œå…è®¸å¯¹è±¡åºåˆ—åŒ–ä¸º **`NSData`**ï¼Œä¸€ç§åŒ…è£…å­—èŠ‚ç¼“å†²åŒºçš„æ ¼å¼ã€‚

### **`NSCoding`** å®ç°
è¦å®ç° `NSCoding`ï¼Œä¸€ä¸ªç±»å¿…é¡»ç»§æ‰¿è‡ª `NSObject` æˆ–æ ‡è®°ä¸º `@objc`ã€‚è¯¥åè®®è¦æ±‚å®ç°ä¸¤ä¸ªæ–¹æ³•æ¥ç¼–ç å’Œè§£ç å®ä¾‹å˜é‡ï¼š
```swift
class CustomPoint: NSObject, NSCoding {
var x: Double = 0.0
var name: String = ""

func encode(with aCoder: NSCoder) {
aCoder.encode(x, forKey: "x")
aCoder.encode(name, forKey: "name")
}

required convenience init?(coder aDecoder: NSCoder) {
guard let name = aDecoder.decodeObject(forKey: "name") as? String else { return nil }
self.init(x: aDecoder.decodeDouble(forKey: "x"), name: name)
}
}
```
### **é€šè¿‡ `NSSecureCoding` å¢å¼ºå®‰å…¨æ€§**
ä¸ºäº†å‡è½»æ”»å‡»è€…å°†æ•°æ®æ³¨å…¥å·²æ„é€ å¯¹è±¡çš„æ¼æ´ï¼Œ**`NSSecureCoding`** æä¾›äº†ä¸€ç§å¢å¼ºçš„åè®®ã€‚ç¬¦åˆ `NSSecureCoding` çš„ç±»å¿…é¡»åœ¨è§£ç æ—¶éªŒè¯å¯¹è±¡çš„ç±»å‹ï¼Œç¡®ä¿ä»…å®ä¾‹åŒ–é¢„æœŸçš„å¯¹è±¡ç±»å‹ã€‚ç„¶è€Œï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œè™½ç„¶ `NSSecureCoding` å¢å¼ºäº†ç±»å‹å®‰å…¨æ€§ï¼Œä½†å®ƒå¹¶ä¸åŠ å¯†æ•°æ®æˆ–ç¡®ä¿å…¶å®Œæ•´æ€§ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„æªæ–½æ¥ä¿æŠ¤æ•æ„Ÿä¿¡æ¯ï¼š
```swift
static var supportsSecureCoding: Bool {
return true
}

let obj = decoder.decodeObject(of: MyClass.self, forKey: "myKey")
```
## Data Archiving with `NSKeyedArchiver`
`NSKeyedArchiver` å’Œå®ƒçš„å¯¹åº”ç±» `NSKeyedUnarchiver` ä½¿å¾—å°†å¯¹è±¡ç¼–ç åˆ°æ–‡ä»¶ä¸­å¹¶éšåæ£€ç´¢æˆä¸ºå¯èƒ½ã€‚è¿™ä¸ªæœºåˆ¶å¯¹äºæŒä¹…åŒ–å¯¹è±¡éå¸¸æœ‰ç”¨ï¼š
```swift
NSKeyedArchiver.archiveRootObject(customPoint, toFile: "/path/to/archive")
let customPoint = NSKeyedUnarchiver.unarchiveObjectWithFile("/path/to/archive") as? CustomPoint
```
### ä½¿ç”¨ `Codable` ç®€åŒ–åºåˆ—åŒ–
Swift çš„ `Codable` åè®®ç»“åˆäº† `Decodable` å’Œ `Encodable`ï¼Œä¾¿äºå¯¹ `String`ã€`Int`ã€`Double` ç­‰å¯¹è±¡è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œè€Œæ— éœ€é¢å¤–çš„åŠªåŠ›ï¼š
```swift
struct CustomPointStruct: Codable {
var x: Double
var name: String
}
```
è¿™ç§æ–¹æ³•æ”¯æŒå°†æ•°æ®ç®€å•åœ°åºåˆ—åŒ–åˆ°å±æ€§åˆ—è¡¨å’ŒJSONä¸­ï¼Œä»è€Œå¢å¼ºSwiftåº”ç”¨ç¨‹åºä¸­çš„æ•°æ®å¤„ç†ã€‚

## JSONå’ŒXMLç¼–ç æ›¿ä»£æ–¹æ¡ˆ
é™¤äº†åŸç”Ÿæ”¯æŒå¤–ï¼Œè¿˜æœ‰å‡ ä¸ªç¬¬ä¸‰æ–¹åº“æä¾›JSONå’ŒXMLç¼–ç /è§£ç åŠŸèƒ½ï¼Œæ¯ä¸ªåº“éƒ½æœ‰å…¶è‡ªèº«çš„æ€§èƒ½ç‰¹å¾å’Œå®‰å…¨è€ƒè™‘ã€‚å¿…é¡»ä»”ç»†é€‰æ‹©è¿™äº›åº“ï¼Œç‰¹åˆ«æ˜¯ä¸ºäº†å‡è½»åƒXXEï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰æ”»å‡»ç­‰æ¼æ´ï¼Œé€šè¿‡é…ç½®è§£æå™¨æ¥é˜²æ­¢å¤–éƒ¨å®ä½“å¤„ç†ã€‚

### å®‰å…¨è€ƒè™‘
åœ¨åºåˆ—åŒ–æ•°æ®æ—¶ï¼Œç‰¹åˆ«æ˜¯å†™å…¥æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¿…é¡»è­¦æƒ•æ½œåœ¨çš„æ•æ„Ÿä¿¡æ¯çš„åŒ…å«ã€‚å¦‚æœåºåˆ—åŒ–çš„æ•°æ®è¢«æ‹¦æˆªæˆ–å¤„ç†ä¸å½“ï¼Œå¯èƒ½ä¼šä½¿åº”ç”¨ç¨‹åºé¢ä¸´æœªç»æˆæƒçš„æ“ä½œæˆ–æ•°æ®æ³„éœ²ç­‰é£é™©ã€‚å»ºè®®å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡ŒåŠ å¯†å’Œç­¾åï¼Œä»¥å¢å¼ºå®‰å…¨æ€§ã€‚

## å‚è€ƒæ–‡çŒ®
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
