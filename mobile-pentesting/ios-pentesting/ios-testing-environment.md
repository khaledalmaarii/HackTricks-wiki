# iOS Testing Environment

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
{% endhint %}

## Apple Developer Program

Eine **Provisionierungsidentit√§t** ist eine Sammlung von √∂ffentlichen und privaten Schl√ºsseln, die mit einem Apple-Entwicklerkonto verkn√ºpft sind. Um **Apps zu signieren**, musst du **99$/Jahr** bezahlen, um dich im **Apple Developer Program** zu registrieren und deine Provisionierungsidentit√§t zu erhalten. Ohne dies kannst du Anwendungen aus dem Quellcode auf einem physischen Ger√§t nicht ausf√ºhren. Eine andere M√∂glichkeit, dies zu tun, ist die Verwendung eines **jailbroken Ger√§ts**.

Seit Xcode 7.2 hat Apple eine Option bereitgestellt, um ein **kostenloses iOS-Entwicklungs-Provisionierungsprofil** zu erstellen, das es erm√∂glicht, deine Anwendung auf einem echten iPhone zu schreiben und zu testen. Gehe zu _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (F√ºge neue Appli ID mit deinen Anmeldeinformationen hinzu) --> _Klicke auf die erstellte Apple ID_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Fertig_\
\_\_Um deine Anwendung auf deinem iPhone auszuf√ºhren, musst du zuerst **das iPhone anweisen, dem Computer zu vertrauen.** Dann kannst du versuchen, **die Anwendung auf dem Mobilger√§t aus Xcode auszuf√ºhren**, aber es wird ein Fehler angezeigt. Gehe also zu _Einstellungen_ --> _Allgemein_ --> _Profile und Ger√§teverwaltung_ --> W√§hle das nicht vertrauensw√ºrdige Profil aus und klicke auf "**Vertrauen**".

Beachte, dass **Anwendungen, die mit demselben Signierungszertifikat signiert sind, Ressourcen auf sichere Weise teilen k√∂nnen, wie z.B. Schl√ºsselbundobjekte**.

Die Provisionierungsprofile werden im Telefon unter **`/Library/MobileDevice/ProvisioningProfiles`** gespeichert.

## **Simulator**

{% hint style="info" %}
Beachte, dass ein **Simulator nicht dasselbe ist wie ein Emulator**. Der Simulator simuliert nur das Verhalten des Ger√§ts und dessen Funktionen, verwendet sie jedoch nicht tats√§chlich.
{% endhint %}

### **Simulator**

Das erste, was du wissen musst, ist, dass **das Durchf√ºhren eines Pentests in einem Simulator viel eingeschr√§nkter ist als in einem jailbroken Ger√§t**.

Alle Tools, die erforderlich sind, um eine iOS-App zu erstellen und zu unterst√ºtzen, werden **nur offiziell auf Mac OS unterst√ºtzt**.\
Das de facto-Tool von Apple zum Erstellen/Debuggen/Instruieren von iOS-Anwendungen ist **Xcode**. Es kann verwendet werden, um andere Komponenten wie **Simulatoren** und verschiedene **SDK** **Versionen** herunterzuladen, die erforderlich sind, um deine App zu erstellen und zu **testen**.\
Es wird dringend empfohlen, **Xcode** aus dem **offiziellen App Store** herunterzuladen. Andere Versionen k√∂nnten Malware enthalten.

Die Simulator-Dateien befinden sich in `/Users/<username>/Library/Developer/CoreSimulator/Devices`

Um den Simulator zu √∂ffnen, starte Xcode, dr√ºcke dann im _Xcode-Tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_Im folgenden Bild kannst du durch Klicken auf "iPod touch \[...\]" ein anderes Ger√§t zum Testen ausw√§hlen:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Anwendungen im Simulator

Im Verzeichnis `/Users/<username>/Library/Developer/CoreSimulator/Devices` findest du alle **installierten Simulatoren**. Wenn du auf die Dateien einer Anwendung zugreifen m√∂chtest, die in einem der Emulatoren erstellt wurde, kann es schwierig sein zu wissen, **in welchem die App installiert ist**. Ein schneller Weg, um **die richtige UID zu finden**, ist, die App im Simulator auszuf√ºhren und Folgendes auszuf√ºhren:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Sobald Sie die UID kennen, k√∂nnen die installierten Apps unter `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` gefunden werden.

√úberraschenderweise finden Sie die Anwendung jedoch nicht hier. Sie m√ºssen auf `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/` zugreifen.

Und in diesem Ordner k√∂nnen Sie **das Paket der Anwendung finden.**

## Emulator

Corellium ist der einzige √∂ffentlich verf√ºgbare iOS-Emulator. Es handelt sich um eine Unternehmens-SaaS-L√∂sung mit einem Lizenzmodell pro Benutzer und es werden keine Testlizenzen angeboten.

## Jailbreaking

Apple verlangt strikt, dass der auf dem iPhone ausgef√ºhrte Code **von einem von Apple ausgestellten Zertifikat signiert sein muss**. **Jailbreaking** ist der Prozess, aktiv **solche Einschr√§nkungen** und andere Sicherheitskontrollen, die vom Betriebssystem festgelegt wurden, zu **umgehen**. Daher wird, sobald das Ger√§t jailbroken ist, die **Integrit√§tspr√ºfung**, die f√ºr die √úberpr√ºfung der installierten Apps verantwortlich ist, gepatcht, sodass sie **umgangen** wird.

{% hint style="info" %}
Im Gegensatz zu Android **k√∂nnen Sie in iOS nicht in den "Entwicklermodus" wechseln**, um nicht signierten/nicht vertrauensw√ºrdigen Code auf dem Ger√§t auszuf√ºhren.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Obwohl oft verglichen, sind **Rooting** auf Android und **Jailbreaking** auf iOS grundlegend unterschiedliche Prozesse. Das Rooten von Android-Ger√§ten kann **die Installation der `su`-Binary** oder **den Austausch des Systems durch ein gerootetes benutzerdefiniertes ROM** umfassen, was nicht unbedingt Exploits erfordert, wenn der Bootloader entsperrt ist. **Das Flashen von benutzerdefinierten ROMs** ersetzt das Betriebssystem des Ger√§ts nach dem Entsperren des Bootloaders, was manchmal einen Exploit erfordert.

Im Gegensatz dazu k√∂nnen iOS-Ger√§te aufgrund der Einschr√§nkung des Bootloaders, nur von Apple signierte Images zu booten, keine benutzerdefinierten ROMs flashen. **Jailbreaking iOS** zielt darauf ab, die Code-Signierungsschutzma√ünahmen von Apple zu umgehen, um nicht signierten Code auszuf√ºhren, ein Prozess, der durch die kontinuierlichen Sicherheitsverbesserungen von Apple kompliziert wird.

### Herausforderungen beim Jailbreaking

Jailbreaking iOS wird zunehmend schwieriger, da Apple Schwachstellen schnell patcht. **Das Downgrade von iOS** ist nur f√ºr eine begrenzte Zeit nach einer Ver√∂ffentlichung m√∂glich, was Jailbreaking zu einer zeitkritischen Angelegenheit macht. Ger√§te, die f√ºr Sicherheitstests verwendet werden, sollten nicht aktualisiert werden, es sei denn, das Re-Jailbreaking ist garantiert.

iOS-Updates werden durch einen **Challenge-Response-Mechanismus** (SHSH-Blobs) gesteuert, der die Installation nur f√ºr von Apple signierte Antworten zul√§sst. Dieser Mechanismus, bekannt als "Signing Window", schr√§nkt die M√∂glichkeit ein, OTA-Firmware-Pakete zu speichern und sp√§ter zu verwenden. Die [IPSW Downloads-Website](https://ipsw.me) ist eine Ressource, um aktuelle Signing Windows zu √ºberpr√ºfen.

### Jailbreak-Varianten

* **Tethered Jailbreaks** erfordern eine Computerverbindung f√ºr jeden Neustart.
* **Semi-tethered Jailbreaks** erm√∂glichen das Booten in den nicht-jailbroken Modus ohne Computer.
* **Semi-untethered Jailbreaks** erfordern ein manuelles Re-Jailbreaking ohne einen Computer.
* **Untethered Jailbreaks** bieten eine permanente Jailbreak-L√∂sung ohne die Notwendigkeit einer erneuten Anwendung.

### Jailbreaking-Tools und Ressourcen

Jailbreaking-Tools variieren je nach iOS-Version und Ger√§t. Ressourcen wie [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) und [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) bieten aktuelle Informationen. Beispiele sind:

* [Checkra1n](https://checkra.in/) f√ºr A7-A11-Chip-Ger√§te.
* [Palera1n](https://palera.in/) f√ºr Checkm8-Ger√§te (A8-A11) auf iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) f√ºr iOS-Versionen bis 14.8.

Die Modifikation Ihres Ger√§ts birgt Risiken, und Jailbreaking sollte mit Vorsicht angegangen werden.

### Vorteile und Risiken des Jailbreakings

Jailbreaking **entfernt die vom OS auferlegte Sandboxing**, sodass Apps auf das gesamte Dateisystem zugreifen k√∂nnen. Diese Freiheit erm√∂glicht die Installation von nicht genehmigten Apps und den Zugriff auf mehr APIs. F√ºr regul√§re Benutzer wird Jailbreaking jedoch **nicht empfohlen** aufgrund potenzieller Sicherheitsrisiken und Instabilit√§t des Ger√§ts.

### **Nach dem Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak-Erkennung**

**Mehrere Anwendungen werden versuchen zu erkennen, ob das Mobilger√§t jailbroken ist, und in diesem Fall wird die Anwendung nicht ausgef√ºhrt.**

* Nach dem Jailbreaking eines iOS **werden normalerweise Dateien und Ordner installiert**, die durchsucht werden k√∂nnen, um festzustellen, ob das Ger√§t jailbroken ist.
* Auf einem jailbroken Ger√§t erhalten Anwendungen **Lese-/Schreibzugriff auf neue Dateien** au√üerhalb des Sandboxes.
* Einige **API** **Aufrufe** werden **anders reagieren**.
* Die Anwesenheit des **OpenSSH**-Dienstes.
* Der Aufruf von `/bin/sh` wird **1** anstelle von 0 zur√ºckgeben.

**Weitere Informationen zur Erkennung von Jailbreaking** [**hier**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Sie k√∂nnen versuchen, diese Erkennungen mit **objection's** `ios jailbreak disable` zu vermeiden.

## **Umgehung der Jailbreak-Erkennung**

* Sie k√∂nnen versuchen, diese Erkennungen mit **objection's** `ios jailbreak disable` zu vermeiden.
* Sie k√∂nnten auch das Tool **Liberty Lite** (https://ryleyangus.com/repo/) installieren. Sobald das Repo hinzugef√ºgt wurde, sollte die App im Tab ‚ÄûSuche‚Äú erscheinen.

## Referenzen

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)
{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
</details>
{% endhint %}
