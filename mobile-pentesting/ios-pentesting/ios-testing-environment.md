# iOS Testing Environment

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Apple Developer Program

**Provisioning identitet** je kolekcija javnih i privatnih kljuÄeva koji su povezani sa Apple developerskim nalogom. Da biste **potpisali aplikacije** morate platiti **99$/god** za registraciju u **Apple Developer Program** kako biste dobili svoj provisioning identitet. Bez toga neÄ‡ete moÄ‡i pokrenuti aplikacije iz izvornog koda na fiziÄkom ureÄ‘aju. Druga opcija je koriÅ¡Ä‡enje **jailbroken ureÄ‘aja**.

PoÄevÅ¡i od Xcode 7.2, Apple je omoguÄ‡io opciju za kreiranje **besplatnog iOS razvojnog provisioning profila** koji omoguÄ‡ava pisanje i testiranje vaÅ¡e aplikacije na pravom iPhone-u. Idite na _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Dodajte novi Appli ID sa vaÅ¡im pristupnim podacima) --> _Kliknite na kreirani Apple ID_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Done_\
\_\_Zatim, kako biste pokrenuli vaÅ¡u aplikaciju na iPhone-u, prvo morate **ukazati poverenje ureÄ‘aju raÄunaru**. Zatim, moÅ¾ete pokuÅ¡ati **pokrenuti aplikaciju na mobilnom ureÄ‘aju iz Xcode-a**, ali Ä‡e se pojaviti greÅ¡ka. Zato idite na _Settings_ --> _General_ --> _Profiles and Device Management_ --> Izaberite nepoverljiv profil i kliknite na "**Trust**".

Imajte na umu da **aplikacije potpisane istim potpisnim sertifikatom mogu deliti resurse na siguran naÄin, poput keychain stavki**.

Provisioning profili se Äuvaju unutar telefona u **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulator**

{% hint style="info" %}
Imajte na umu da **simulator nije isto Å¡to i emulator**. Simulator samo simulira ponaÅ¡anje ureÄ‘aja i funkcije, ali ih zapravo ne koristi.
{% endhint %}

### **Simulator**

Prvo Å¡to treba da znate je da Ä‡e **izvoÄ‘enje pentesta unutar simulatora biti mnogo ograniÄenije nego u jailbroken ureÄ‘aju**.

Svi alati potrebni za izgradnju i podrÅ¡ku iOS aplikacije **zvaniÄno su podrÅ¾ani samo na Mac OS-u**.\
Apple-ov de facto alat za kreiranje/debagovanje/instrumentiranje iOS aplikacija je **Xcode**. MoÅ¾e se koristiti za preuzimanje drugih komponenti kao Å¡to su **simulatori** i razliÄite **SDK** **verzije** potrebne za izgradnju i **testiranje** vaÅ¡e aplikacije.\
Visoko se preporuÄuje da **preuzmete** Xcode sa **zvaniÄnog app store-a**. Druge verzije mogu sadrÅ¾ati maliciozni softver.

Datoteke simulatora se mogu pronaÄ‡i u `/Users/<korisniÄko_ime>/Library/Developer/CoreSimulator/Devices`

Da biste otvorili simulator, pokrenite Xcode, zatim kliknite na _Xcode tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_Na sledeÄ‡oj slici klikom na "iPod touch \[...]" moÅ¾ete izabrati drugi ureÄ‘aj za testiranje:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Aplikacije u Simulatoru

Unutar `/Users/<korisniÄko_ime>/Library/Developer/CoreSimulator/Devices` moÅ¾ete pronaÄ‡i sve **instalirane simulatore**. Ako Å¾elite da pristupite datotekama aplikacije kreirane unutar jednog od emulatora, moÅ¾e biti teÅ¡ko znati **u kojem je instalirana aplikacija**. Brz naÄin da **pronaÄ‘ete taÄan UID** je da pokrenete aplikaciju u simulatoru i izvrÅ¡ite:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Kada jednom saznate UID, aplikacije instalirane unutar nje mogu se pronaÄ‡i u `/Users/<korisniÄko_ime>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

MeÄ‘utim, iznenaÄ‘ujuÄ‡e, aplikaciju neÄ‡ete pronaÄ‡i ovde. Morate pristupiti `/Users/<korisniÄko_ime>/Library/Developer/Xcode/DerivedData/{Aplikacija}/Build/Products/Debug-iphonesimulator/`

I u ovom folderu moÅ¾ete **pronaÄ‡i paket aplikacije.**

## Emulator

Corellium je jedini javno dostupan iOS emulator. To je reÅ¡enje za preduzeÄ‡a sa modelom licence po korisniku i ne nudi probnu licencu.

## Jailbreakovanje

Apple strogo zahteva da kod koji se izvrÅ¡ava na iPhone-u mora biti **potpisan sertifikatom izdatim od strane Apple-a**. **Jailbreakovanje** je proces aktivnog **zaobilaska takvih ograniÄenja** i drugih sigurnosnih kontrola postavljenih od strane OS-a. Stoga, kada je ureÄ‘aj jailbroken, **integritetna provera** koja je odgovorna za proveru instaliranih aplikacija je zakrpljena tako da je **zaobiÄ‘ena**.

{% hint style="info" %}
Za razliku od Androida, **ne moÅ¾ete prebaciti u "ReÅ¾im programera"** u iOS-u da biste pokrenuli nepotpisani/nepoverljivi kod na ureÄ‘aju.
{% endhint %}

### Rootovanje Androida vs. Jailbreakovanje iOS-a

Iako se Äesto porede, **rootovanje** na Androidu i **jailbreakovanje** na iOS-u su fundamentalno razliÄiti procesi. Rootovanje Android ureÄ‘aja moÅ¾e ukljuÄivati **instaliranje `su` binarnog koda** ili **zamenu sistema sa rootovanim prilagoÄ‘enim ROM-om**, Å¡to ne zahteva nuÅ¾no eksploate ako je bootloader otkljuÄan. **Flashing prilagoÄ‘enih ROM-ova** zamenjuje OS ureÄ‘aja nakon otkljuÄavanja bootloader-a, ponekad zahtevajuÄ‡i eksploate.

Za razliku od toga, iOS ureÄ‘aji ne mogu flashovati prilagoÄ‘ene ROM-ove zbog restrikcije bootloader-a da samo podiÅ¾e Apple-ove slike. **Jailbreakovanje iOS-a** ima za cilj da zaobiÄ‘e Apple-ove zaÅ¡tite potpisa koda kako bi pokrenuo nepotpisani kod, proces koji oteÅ¾ava kontinuiranim sigurnosnim unapreÄ‘enjima Apple-a.

### Izazovi Jailbreakovanja

Jailbreakovanje iOS-a je sve teÅ¾e kako Apple brzo zakrpljuje ranjivosti. **VraÄ‡anje na stariju verziju iOS-a** je moguÄ‡e samo u ograniÄenom vremenskom periodu nakon izdanja, ÄineÄ‡i jailbreakovanje pitanje vremena. UreÄ‘aji koriÅ¡Ä‡eni za testiranje sigurnosti ne bi trebalo da se aÅ¾uriraju osim ako ponovno jailbreakovanje nije garantovano.

AÅ¾uriranja iOS-a se kontroliÅ¡u **mehanizmom izazova-odgovora** (SHSH blokovi), omoguÄ‡avajuÄ‡i instalaciju samo za Apple-ove potpisane odgovore. Ovaj mehanizam, poznat kao "prozor potpisa", ograniÄava moguÄ‡nost skladiÅ¡tenja i kasnije koriÅ¡Ä‡enje OTA firmware paketa. Veb sajt [IPSW Downloads](https://ipsw.me) je resurs za proveru trenutnih prozora potpisa.

### Vrste Jailbreakovanja

* **Tethered jailbreakovi** zahtevaju povezivanje sa raÄunarom za svako ponovno pokretanje.
* **Semi-tethered jailbreakovi** omoguÄ‡avaju pokretanje u reÅ¾imu bez jailbreaka bez raÄunara.
* **Semi-untethered jailbreakovi** zahtevaju ruÄno ponovno jailbreakovanje bez potrebe za raÄunarom.
* **Untethered jailbreakovi** nude trajno reÅ¡enje za jailbreak bez potrebe za ponovnom primenom.

### Alati i Resursi za Jailbreakovanje

Alati za jailbreakovanje variraju po verziji iOS-a i ureÄ‘aju. Resursi poput [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) pruÅ¾aju aÅ¾urirane informacije. Primeri ukljuÄuju:

* [Checkra1n](https://checkra.in/) za ureÄ‘aje sa A7-A11 Äipom.
* [Palera1n](https://palera.in/) za ureÄ‘aje sa Checkm8 Äipom (A8-A11) na iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) za verzije iOS-a do 14.8.

Modifikacija vaÅ¡eg ureÄ‘aja nosi rizike, a jailbreakovanje treba pristupiti sa oprezom.

### Prednosti i Rizici Jailbreakovanja

Jailbreakovanje **uklanja sandboxing nametnut od strane OS-a**, omoguÄ‡avajuÄ‡i aplikacijama pristup celom fajl sistemu. Ova sloboda omoguÄ‡ava instalaciju neodobrenih aplikacija i pristup viÅ¡e API-ja. MeÄ‘utim, za obiÄne korisnike, jailbreakovanje se **ne preporuÄuje** zbog potencijalnih sigurnosnih rizika i nestabilnosti ureÄ‘aja.

### **Nakon Jailbreakovanja**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Detekcija Jailbreakovanja**

**Nekoliko aplikacija Ä‡e pokuÅ¡ati da detektuju da li je mobilni ureÄ‘aj jailbroken i u tom sluÄaju aplikacija neÄ‡e pokrenuti**

* Nakon jailbreakovanja iOS-a **fajlovi i folderi se obiÄno instaliraju**, ovi se mogu pretraÅ¾iti da bi se utvrdilo da li je ureÄ‘aj jailbroken.
* Na jailbroken ureÄ‘aju aplikacije dobijaju **pristup za Äitanje/pisanje novih fajlova** van sandbox-a
* Neki **API pozivi** Ä‡e **se ponaÅ¡ati drugaÄije**
* Prisustvo **OpenSSH** servisa
* Pozivanje `/bin/sh` Ä‡e **vratiti 1** umesto 0

**ViÅ¡e informacija o detekciji jailbreakovanja** [**ovde**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

MoÅ¾ete pokuÅ¡ati da izbegnete ove detekcije koristeÄ‡i **objection's** `ios jailbreak disable`

## **Bypass Detekcije Jailbreakovanja**

* MoÅ¾ete pokuÅ¡ati da izbegnete ove detekcije koristeÄ‡i **objection's** `ios jailbreak disable`
* TakoÄ‘e moÅ¾ete instalirati alat **Liberty Lite** (https://ryleyangus.com/repo/). Kada se repozitorijum doda, aplikacija bi trebalo da se pojavi u 'Pretraga' tabu

## Reference

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF-u** Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
