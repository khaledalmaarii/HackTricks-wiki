# iOS Testno okruÅ¾enje

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Apple Developer Program

**Provisioning identitet** je kolekcija javnih i privatnih kljuÄeva koji su povezani sa Apple developer nalogom. Da biste **potpisali aplikacije**, morate platiti **99$/godinu** da se registrujete u **Apple Developer Programu** i dobijete svoj provisioning identitet. Bez toga neÄ‡ete moÄ‡i da pokrenete aplikacije iz izvornog koda na fiziÄkom ureÄ‘aju. Druga opcija je koriÅ¡Ä‡enje **jailbroken ureÄ‘aja**.

PoÄevÅ¡i od Xcode 7.2, Apple je omoguÄ‡io opciju za kreiranje **besplatnog iOS razvojnog provisioning profila** koji omoguÄ‡ava pisanje i testiranje vaÅ¡e aplikacije na stvarnom iPhone-u. Idite na _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Dodajte novi Appli ID sa vaÅ¡im podacima) --> _Kliknite na kreirani Apple ID_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Done_\
\_\_Zatim, da biste pokrenuli aplikaciju na vaÅ¡em iPhone-u, prvo morate **ukazati poverenje ureÄ‘aju prema raÄunaru**. Zatim, moÅ¾ete pokuÅ¡ati da **pokrenete aplikaciju na mobilnom ureÄ‘aju iz Xcode-a**, ali Ä‡e se pojaviti greÅ¡ka. Zato idite na _Settings_ --> _General_ --> _Profiles and Device Management_ --> Izaberite nepovereni profil i kliknite na "**Trust**".

Imajte na umu da **aplikacije potpisane istim potpisnim sertifikatom mogu deliti resurse na siguran naÄin, kao Å¡to su stavke u keÅ¡u**.

Provisioning profili se Äuvaju unutar telefona u **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulator**

{% hint style="info" %}
Imajte na umu da **simulator nije isto Å¡to i emulator**. Simulator samo simulira ponaÅ¡anje ureÄ‘aja i funkcije, ali ih zapravo ne koristi.
{% endhint %}

### **Simulator**

Prva stvar koju trebate znati je da Ä‡e **izvoÄ‘enje pentesta unutar simulatora biti mnogo ograniÄenije nego na jailbroken ureÄ‘aju**.

Svi alati potrebni za izgradnju i podrÅ¡ku iOS aplikacije **zvaniÄno su podrÅ¾ani samo na Mac OS-u**.\
Apple-ov de facto alat za kreiranje/debagovanje/instrumentiranje iOS aplikacija je **Xcode**. MoÅ¾e se koristiti za preuzimanje drugih komponenti kao Å¡to su **simulatori** i razliÄite **verzije SDK-a** potrebne za izgradnju i **testiranje** vaÅ¡e aplikacije.\
Visoko se preporuÄuje da **preuzmete** Xcode sa **zvaniÄnog App Store-a**. Druge verzije mogu sadrÅ¾ati zlonamerni softver.

Datoteke simulatora mogu se pronaÄ‡i u `/Users/<korisniÄko_ime>/Library/Developer/CoreSimulator/Devices`

Da biste otvorili simulator, pokrenite Xcode, zatim pritisnite na _Xcode tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_Na sledeÄ‡oj slici klikom na "iPod touch \[...]" moÅ¾ete izabrati drugi ureÄ‘aj za testiranje:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Aplikacije u Simulatoru

Unutar `/Users/<korisniÄko_ime>/Library/Developer/CoreSimulator/Devices` moÅ¾ete pronaÄ‡i sve **instalirane simulatore**. Ako Å¾elite da pristupite datotekama aplikacije kreirane unutar jednog od emulatora, moÅ¾e biti teÅ¡ko znati **u kojem je instalirana aplikacija**. Brz naÄin da **pronaÄ‘ete taÄan UID** je da pokrenete aplikaciju u simulatoru i izvrÅ¡ite:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Kada saznate UID, instalirane aplikacije unutar njega mogu se pronaÄ‡i u `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

MeÄ‘utim, iznenaÄ‘ujuÄ‡e, aplikacija se neÄ‡e nalaziti ovde. Morate pristupiti `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

I u ovom folderu moÅ¾ete **pronaÄ‡i paket aplikacije**.

## Emulator

Corellium je jedini javno dostupan iOS emulator. To je poslovno reÅ¡enje SaaS modela sa licencom po korisniku i ne nudi probnu licencu.

## Jailbreak

Apple strogo zahteva da kod koji se izvrÅ¡ava na iPhone-u mora biti **potpisan sertifikatom izdatim od strane Apple-a**. **Jailbreak** je proces aktivnog **zaobilaÅ¾enja takvih ograniÄenja** i drugih sigurnosnih kontrola koje je operativni sistem postavio. Stoga, kada je ureÄ‘aj jailbroken, **provera integriteta** koja je odgovorna za proveru instaliranih aplikacija je zakrpljena tako da se **zaobilazi**.

{% hint style="info" %}
Za razliku od Androida, **ne moÅ¾ete preÄ‡i na "Developer Mode"** u iOS-u da biste pokrenuli nepotpisani/nepoverljivi kod na ureÄ‘aju.
{% endhint %}

### Rooting Androida vs. Jailbreaking iOS-a

Iako se Äesto porede, **rooting** na Androidu i **jailbreaking** na iOS-u su fundamentalno razliÄiti procesi. Rooting Android ureÄ‘aja moÅ¾e ukljuÄivati **instaliranje `su` binarnog fajla** ili **zamenu sistema sa rootovanim prilagoÄ‘enim ROM-om**, Å¡to ne zahteva nuÅ¾no eksploate ako je bootloader otkljuÄan. **Flashing prilagoÄ‘enih ROM-ova** zamenjuje operativni sistem ureÄ‘aja nakon otkljuÄavanja bootloader-a, ponekad zahtevajuÄ‡i eksploate.

S druge strane, iOS ureÄ‘aji ne mogu da flashuju prilagoÄ‘ene ROM-ove zbog ograniÄenja bootloader-a da samo butuje Apple-ovim potpisanim slikama. **Jailbreaking iOS-a** ima za cilj zaobilaÅ¾enje Apple-ovih zaÅ¡tita potpisivanja koda kako bi se pokrenuo nepotpisani kod, proces koji je oteÅ¾an kontinuiranim unapreÄ‘enjima sigurnosti od strane Apple-a.

### Izazovi Jailbreaking-a

Jailbreaking iOS-a postaje sve teÅ¾e kako Apple brzo zakrpljuje ranjivosti. **Downgrade iOS-a** je moguÄ‡ samo u ograniÄenom vremenskom periodu nakon izdanja, Å¡to Äini jailbreaking pitanje vremenske osetljivosti. UreÄ‘aji koji se koriste za testiranje sigurnosti ne bi trebali biti aÅ¾urirani osim ako ponovno jailbreaking nije zagarantovan.

AÅ¾uriranja iOS-a kontroliÅ¡e **mehanizam izazova-odgovora** (SHSH blobs), koji omoguÄ‡ava instalaciju samo za Apple-ovim potpisanim odgovorima. Ovaj mehanizam, poznat kao "prozor za potpisivanje", ograniÄava moguÄ‡nost skladiÅ¡tenja i kasnijeg koriÅ¡Ä‡enja OTA firmware paketa. Veb sajt [IPSW Downloads](https://ipsw.me) je resurs za proveru trenutnih prozora za potpisivanje.

### Vrste Jailbreak-a

- **Tethered jailbreaks** zahtevaju vezu sa raÄunarom pri svakom ponovnom pokretanju.
- **Semi-tethered jailbreaks** omoguÄ‡avaju pokretanje u reÅ¾imu bez jailbreak-a bez raÄunara.
- **Semi-untethered jailbreaks** zahtevaju ruÄno ponovno jailbreak-ovanje bez potrebe za raÄunarom.
- **Untethered jailbreaks** nude trajno reÅ¡enje za jailbreak bez potrebe za ponovnom primenom.

### Alati i resursi za Jailbreaking

Alati za jailbreaking variraju prema verziji iOS-a i ureÄ‘aju. Resursi poput [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) pruÅ¾aju aÅ¾urirane informacije. Primeri ukljuÄuju:

- [Checkra1n](https://checkra.in/) za ureÄ‘aje sa Äipom A7-A11.
- [Palera1n](https://palera.in/) za Checkm8 ureÄ‘aje (A8-A11) na iOS verzijama 15.0-16.5.
- [Unc0ver](https://unc0ver.dev/) za iOS verzije do 14.8.

Modifikacija ureÄ‘aja nosi rizike, a jailbreaking treba pristupiti sa oprezom.

### Prednosti i rizici Jailbreaking-a

Jailbreaking **uklanja sandbox ograniÄenja nametnuta od strane operativnog sistema**, omoguÄ‡avajuÄ‡i aplikacijama pristup celokupnom fajl sistemu. Ova sloboda omoguÄ‡ava instalaciju neodobrenih aplikacija i pristup viÅ¡e API-ja. MeÄ‘utim, za obiÄne korisnike, jailbreaking **nije preporuÄljiv** zbog potencijalnih sigurnosnih rizika i nestabilnosti ureÄ‘aja.

### **Nakon Jailbreaking-a**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Detekcija Jailbreak-a**

**Nekoliko aplikacija Ä‡e pokuÅ¡ati da otkrije da li je mobilni ureÄ‘aj jailbroken i u tom sluÄaju aplikacija neÄ‡e biti pokrenuta**

* Nakon jailbreaking-a iOS-a, obiÄno se instaliraju **fajlovi i folderi**, koji se mogu pretraÅ¾ivati da bi se utvrdilo da li je ureÄ‘aj jailbroken.
* Na jailbroken ureÄ‘aju aplikacije dobijaju **Äitanje/pisanje pristup novim fajlovima** van sandbox-a.
* Neke **API** **pozive** Ä‡e se **ponaÅ¡ati drugaÄije**
* Prisustvo **OpenSSH** servisa
* Pozivanje `/bin/sh` Ä‡e vratiti 1 umesto 0

**ViÅ¡e informacija o tome kako otkriti jailbreaking** [**ovde**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

MoÅ¾ete pokuÅ¡ati da izbegnete ova otkrivanja koristeÄ‡i `ios jailbreak disable` iz **objection-a**.

## **Bypass detekcije Jailbreak-a**

* MoÅ¾ete pokuÅ¡ati da izbegnete ova otkrivanja koristeÄ‡i `ios jailbreak disable` iz **objection-a**.
* TakoÄ‘e moÅ¾ete instalirati alatku **Liberty Lite** (https://ryleyangus.com/repo/). Nakon dodavanja repozitorijuma, aplikacija bi trebala da se pojavi u tabu "Pretraga".

## Reference
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
