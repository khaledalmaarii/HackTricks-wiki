# Åšrodowisko testowe iOS

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## Program dla DeweloperÃ³w Apple

**ToÅ¼samoÅ›Ä‡ weryfikacyjna** to zbiÃ³r kluczy publicznych i prywatnych powiÄ…zanych z kontem dewelopera Apple. Aby **podpisywaÄ‡ aplikacje**, musisz zapÅ‚aciÄ‡ **99 dolarÃ³w/rok** za rejestracjÄ™ w **Programie Deweloperskim Apple**, aby uzyskaÄ‡ swojÄ… toÅ¼samoÅ›Ä‡ weryfikacyjnÄ…. Bez tego nie bÄ™dziesz mÃ³gÅ‚ uruchamiaÄ‡ aplikacji ze ÅºrÃ³dÅ‚a na fizycznym urzÄ…dzeniu. InnÄ… opcjÄ… jest uÅ¼ycie **urzÄ…dzenia z jailbreakiem**.

PoczÄ…wszy od Xcode 7.2 Apple udostÄ™pniÅ‚ opcjÄ™ tworzenia **bezpÅ‚atnego profilu weryfikacyjnego dla deweloperÃ³w iOS**, ktÃ³ry pozwala pisaÄ‡ i testowaÄ‡ aplikacjÄ™ na prawdziwym iPhone'ie. PrzejdÅº do _Xcode_ --> _Preferencje_ --> _Konta_ --> _+_ (Dodaj nowe ID aplikacji do swoich danych uwierzytelniajÄ…cych) --> _Kliknij utworzone ID Apple_ --> _ZarzÄ…dzaj Certyfikatami_ --> _+_ (RozwÃ³j Apple) --> _Gotowe_\
\_\_NastÄ™pnie, aby uruchomiÄ‡ aplikacjÄ™ na swoim iPhone'ie, musisz najpierw **wskazaÄ‡ iPhone'owi, aby zaufaÅ‚ komputerowi**. NastÄ™pnie moÅ¼esz sprÃ³bowaÄ‡ **uruchomiÄ‡ aplikacjÄ™ na urzÄ…dzeniu mobilnym z Xcode**, ale pojawi siÄ™ bÅ‚Ä…d. PrzejdÅº do _Ustawienia_ --> _OgÃ³lne_ --> _Profile i ZarzÄ…dzanie UrzÄ…dzeniami_ --> Wybierz niezaufany profil i kliknij "**Zaufaj**".

ZauwaÅ¼, Å¼e **aplikacje podpisane tym samym certyfikatem podpisujÄ…cym mogÄ… dzieliÄ‡ zasoby w bezpieczny sposÃ³b, takie jak elementy schowka**.

Profile weryfikacyjne sÄ… przechowywane w telefonie w **`/Library/MobileDevice/ProvisioningProfiles`**

## **Symulator**

{% hint style="info" %}
ZauwaÅ¼, Å¼e **symulator nie jest tym samym co emulator**. Symulator jedynie symuluje zachowanie urzÄ…dzenia i funkcje, ale faktycznie ich nie uÅ¼ywa.
{% endhint %}

### **Symulator**

PierwszÄ… rzeczÄ…, ktÃ³rÄ… musisz wiedzieÄ‡, jest to, Å¼e **przeprowadzenie testu penetracyjnego wewnÄ…trz symulatora bÄ™dzie znacznie bardziej ograniczone niÅ¼ w przypadku urzÄ…dzenia z jailbreakiem**.

Wszystkie narzÄ™dzia niezbÄ™dne do budowy i obsÅ‚ugi aplikacji iOS sÄ… **oficjalnie obsÅ‚ugiwane tylko w systemie Mac OS**.\
NarzÄ™dziem Apple do tworzenia/debugowania/instrumentowania aplikacji iOS jest **Xcode**. MoÅ¼na go uÅ¼yÄ‡ do pobrania innych komponentÃ³w, takich jak **symulatory** i rÃ³Å¼ne **wersje SDK** wymagane do budowy i **testowania** aplikacji.\
Zaleca siÄ™ **pobranie** Xcode z **oficjalnego sklepu z aplikacjami**. Inne wersje mogÄ… zawieraÄ‡ zÅ‚oÅ›liwe oprogramowanie.

Pliki symulatora moÅ¼na znaleÅºÄ‡ w `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/CoreSimulator/Devices`

Aby otworzyÄ‡ symulator, uruchom Xcode, nastÄ™pnie kliknij w zakÅ‚adkÄ™ _Xcode_ --> _OtwÃ³rz narzÄ™dzia deweloperskie_ --> _Symulator_\
\_\_Na poniÅ¼szym obrazie, klikajÄ…c w "iPod touch \[...]" moÅ¼esz wybraÄ‡ inne urzÄ…dzenie do testowania:

![](<../../.gitbook/assets/image (267).png>)

![](<../../.gitbook/assets/image (517).png>)

### Aplikacje w Symulatorze

WewnÄ…trz `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/CoreSimulator/Devices` moÅ¼esz znaleÅºÄ‡ wszystkie **zainstalowane symulatory**. JeÅ›li chcesz uzyskaÄ‡ dostÄ™p do plikÃ³w aplikacji utworzonej w jednym z emulatorÃ³w, moÅ¼e byÄ‡ trudno ustaliÄ‡ **w ktÃ³rym zainstalowano aplikacjÄ™**. Szybkim sposobem **znalezienia poprawnego UID** jest uruchomienie aplikacji w symulatorze i wykonanie:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Gdy juÅ¼ znasz UID, aplikacje zainstalowane w nim moÅ¼na znaleÅºÄ‡ w `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

JednakÅ¼e zaskakujÄ…co aplikacji nie znajdziesz tutaj. Musisz uzyskaÄ‡ dostÄ™p do `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

I w tym folderze moÅ¼esz **znaleÅºÄ‡ pakiet aplikacji.**

## Emulator

Corellium to jedyny publicznie dostÄ™pny emulator iOS. Jest to rozwiÄ…zanie typu enterprise SaaS z modelem licencji na uÅ¼ytkownika i nie oferuje Å¼adnej licencji prÃ³bnej.

## Jailbreaking

Apple Å›ciÅ›le wymaga, aby kod uruchamiany na iPhone'ie byÅ‚ **podpisany certyfikatem wydanym przez Apple**. **Jailbreaking** to proces aktywnego **omijania takich ograniczeÅ„** i innych kontroli bezpieczeÅ„stwa wprowadzonych przez system operacyjny. Dlatego po zjailbreakowaniu urzÄ…dzenia, **sprawdzanie integralnoÅ›ci**, ktÃ³re jest odpowiedzialne za sprawdzanie zainstalowanych aplikacji, jest Å‚atane, wiÄ™c jest **omijane**.

{% hint style="info" %}
W przeciwieÅ„stwie do Androida, w iOS **nie moÅ¼na przeÅ‚Ä…czyÄ‡ siÄ™ w tryb "Developer Mode"** aby uruchamiaÄ‡ niepodpisany/niezaufany kod na urzÄ…dzeniu.
{% endhint %}

### Rootowanie Androida vs. Jailbreaking iOS

Mimo czÄ™stego porÃ³wnywania, **rootowanie** na Androidzie i **jailbreaking** na iOS to fundamentalnie rÃ³Å¼ne procesy. Rootowanie urzÄ…dzeÅ„ z Androidem moÅ¼e wymagaÄ‡ **zainstalowania binariÃ³w `su`** lub **zastÄ…pienia systemu spersonalizowanym ROM-em z rootem**, co niekoniecznie wymaga wykorzystywania exploitÃ³w, jeÅ›li bootloader jest odblokowany. **Instalowanie spersonalizowanych ROM-Ã³w** zastÄ™puje system operacyjny urzÄ…dzenia po odblokowaniu bootloadera, czasami wymagajÄ…c exploitu.

W przeciwieÅ„stwie do tego, urzÄ…dzenia z iOS nie mogÄ… instalowaÄ‡ spersonalizowanych ROM-Ã³w ze wzglÄ™du na ograniczenie bootloadera do uruchamiania tylko obrazÃ³w podpisanych przez Apple. **Jailbreaking iOS** ma na celu ominiÄ™cie zabezpieczeÅ„ podpisu kodu Apple'a w celu uruchamiania niepodpisanego kodu, proces ten jest utrudniony przez ciÄ…gÅ‚e ulepszenia zabezpieczeÅ„ Apple'a.

### Wyzwania zwiÄ…zane z Jailbreakingiem

Jailbreaking iOS staje siÄ™ coraz trudniejsze, poniewaÅ¼ Apple szybko Å‚ata podatnoÅ›ci. **Zmniejszenie wersji iOS** jest moÅ¼liwe tylko przez ograniczony czas po wydaniu, co sprawia, Å¼e jailbreaking jest kwestiÄ… czasowÄ…. UrzÄ…dzenia uÅ¼ywane do testÃ³w bezpieczeÅ„stwa nie powinny byÄ‡ aktualizowane, chyba Å¼e ponowne zjailbreakowanie jest gwarantowane.

Aktualizacje iOS sÄ… kontrolowane przez **mechanizm wyzwaÅ„ i odpowiedzi** (bloki SHSH), pozwalajÄ…cy na instalacjÄ™ tylko odpowiedzi podpisanych przez Apple. Ten mechanizm, znany jako "okno podpisu", ogranicza moÅ¼liwoÅ›Ä‡ przechowywania i pÃ³Åºniejszego uÅ¼ywania pakietÃ³w OTA firmware. Strona [IPSW Downloads website](https://ipsw.me) jest ÅºrÃ³dÅ‚em do sprawdzania aktualnych okien podpisÃ³w.

### Rodzaje JailbreakÃ³w

* **Jailbreaki zwiÄ…zane z komputerem** wymagajÄ… poÅ‚Ä…czenia z komputerem przy kaÅ¼dym ponownym uruchomieniu.
* **Jailbreaki pÃ³Å‚-zwiÄ…zane z komputerem** pozwalajÄ… na uruchomienie w trybie bez jailbreaka bez uÅ¼ycia komputera.
* **Jailbreaki pÃ³Å‚-niepowiÄ…zane z komputerem** wymagajÄ… rÄ™cznego ponownego zjailbreakowania bez koniecznoÅ›ci uÅ¼ycia komputera.
* **Jailbreaki niepowiÄ…zane z komputerem** oferujÄ… trwaÅ‚e rozwiÄ…zanie jailbreaka bez koniecznoÅ›ci ponownego zastosowania.

### NarzÄ™dzia i Zasoby do Jailbreakingu

NarzÄ™dzia do jailbreakingu rÃ³Å¼niÄ… siÄ™ w zaleÅ¼noÅ›ci od wersji iOS i urzÄ…dzenia. Zasoby takie jak [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) dostarczajÄ… aktualnych informacji. PrzykÅ‚ady to:

* [Checkra1n](https://checkra.in/) dla urzÄ…dzeÅ„ z chipem A7-A11.
* [Palera1n](https://palera.in/) dla urzÄ…dzeÅ„ Checkm8 (A8-A11) na iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) dla wersji iOS do 14.8.

Modyfikacja urzÄ…dzenia niesie ze sobÄ… ryzyko, dlatego jailbreaking naleÅ¼y traktowaÄ‡ ostroÅ¼nie.

### KorzyÅ›ci i Ryzyka Jailbreakingu

Jailbreaking **usuwa narzucone przez system operacyjny izolowanie**, pozwalajÄ…c aplikacjom na dostÄ™p do caÅ‚ego systemu plikÃ³w. Ta swoboda umoÅ¼liwia instalacjÄ™ niezatwierdzonych aplikacji i dostÄ™p do wiÄ™kszej liczby interfejsÃ³w API. Jednak dla zwykÅ‚ych uÅ¼ytkownikÃ³w, jailbreaking **nie jest zalecany** ze wzglÄ™du na potencjalne ryzyka bezpieczeÅ„stwa i niestabilnoÅ›Ä‡ urzÄ…dzenia.

### **Po Zjailbreakowaniu**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Wykrywanie JailbreakÃ³w**

**Kilka aplikacji sprÃ³buje wykryÄ‡, czy urzÄ…dzenie mobilne jest zjailbreakowane, a w takim przypadku aplikacja nie bÄ™dzie dziaÅ‚aÄ‡**

* Po zjailbreakowaniu urzÄ…dzenia z iOS **zazwyczaj instalowane sÄ… pliki i foldery**, ktÃ³re moÅ¼na przeszukaÄ‡, aby okreÅ›liÄ‡, czy urzÄ…dzenie jest zjailbreakowane.
* Na zjailbreakowanym urzÄ…dzeniu aplikacje uzyskujÄ… **dostÄ™p do odczytu/zapisu nowych plikÃ³w** poza piaskownicÄ….
* NiektÃ³re **wywoÅ‚ania API** bÄ™dÄ… **zachowywaÄ‡ siÄ™ inaczej**
* ObecnoÅ›Ä‡ usÅ‚ugi **OpenSSH**
* WywoÅ‚anie `/bin/sh` zwrÃ³ci **1** zamiast 0

**WiÄ™cej informacji na temat wykrywania jailbreakingu** [**tutaj**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

MoÅ¼esz sprÃ³bowaÄ‡ uniknÄ…Ä‡ tych wykryÄ‡ za pomocÄ… `ios jailbreak disable` z **objection**

## **Unikanie Wykrycia JailbreakÃ³w**

* MoÅ¼esz sprÃ³bowaÄ‡ uniknÄ…Ä‡ tych wykryÄ‡ za pomocÄ… `ios jailbreak disable` z **objection**
* MoÅ¼esz takÅ¼e zainstalowaÄ‡ narzÄ™dzie **Liberty Lite** (https://ryleyangus.com/repo/). Po dodaniu repozytorium, aplikacja powinna pojawiÄ‡ siÄ™ w zakÅ‚adce â€Wyszukajâ€

## Referencje

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**Grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
