# iOS Testing Environment

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
{% endhint %}

## Apple Developer Program

**Provisioning identity** je zbirka javnih i privatnih kljuÄeva koji su povezani sa Apple developer nalogom. Da biste **potpisali aplikacije**, potrebno je da platite **99$/god** da biste se registrovali u **Apple Developer Program** kako biste dobili svoju provisioning identity. Bez toga neÄ‡ete moÄ‡i da pokrenete aplikacije iz izvornog koda na fiziÄkom ureÄ‘aju. Druga opcija je koriÅ¡Ä‡enje **jailbroken ureÄ‘aja**.

PoÄevÅ¡i od Xcode 7.2, Apple je omoguÄ‡io opciju za kreiranje **besplatnog iOS razvojnog provisioning profila** koji omoguÄ‡ava pisanje i testiranje vaÅ¡e aplikacije na pravom iPhone-u. Idite na _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Dodajte novi Appli ID sa vaÅ¡im podacima) --> _Kliknite na kreirani Apple ID_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Done_\
\_\_Zatim, da biste pokrenuli vaÅ¡u aplikaciju na iPhone-u, prvo morate **navesti iPhone da veruje raÄunaru.** Zatim, moÅ¾ete pokuÅ¡ati da **pokrenete aplikaciju na mobilnom iz Xcode-a**, ali Ä‡e se pojaviti greÅ¡ka. Idite na _Settings_ --> _General_ --> _Profiles and Device Management_ --> Izaberite nepouzdani profil i kliknite na "**Trust**".

Napomena da **aplikacije potpisane istim potpisnim sertifikatom mogu deliti resurse na siguran naÄin, kao Å¡to su stavke u keychain-u**.

Provisioning profili se Äuvaju unutar telefona u **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulator**

{% hint style="info" %}
Napomena da **simulator nije isto Å¡to i emulator**. Simulator samo simulira ponaÅ¡anje ureÄ‘aja i funkcije, ali ih zapravo ne koristi.
{% endhint %}

### **Simulator**

Prva stvar koju treba da znate je da je **izvoÄ‘enje pentesta unutar simulatora mnogo ograniÄenije nego na jailbroken ureÄ‘aju**.

Svi alati potrebni za izgradnju i podrÅ¡ku iOS aplikacije su **samo zvaniÄno podrÅ¾ani na Mac OS**.\
Apple-ov de facto alat za kreiranje/debugovanje/instrumentaciju iOS aplikacija je **Xcode**. MoÅ¾e se koristiti za preuzimanje drugih komponenti kao Å¡to su **simulatori** i razliÄite **SDK** **verzije** potrebne za izgradnju i **testiranje** vaÅ¡e aplikacije.\
PreporuÄuje se da **preuzmete** Xcode iz **zvaniÄne prodavnice aplikacija**. Druge verzije mogu sadrÅ¾ati malver.

Datoteke simulatora se mogu naÄ‡i u `/Users/<username>/Library/Developer/CoreSimulator/Devices`

Da biste otvorili simulator, pokrenite Xcode, zatim pritisnite na _Xcode tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_Na sledeÄ‡oj slici klikom na "iPod touch \[...\]" moÅ¾ete izabrati drugi ureÄ‘aj za testiranje:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Aplikacije u Simulatoru

Unutar `/Users/<username>/Library/Developer/CoreSimulator/Devices` moÅ¾ete pronaÄ‡i sve **instalirane simulatore**. Ako Å¾elite da pristupite datotekama aplikacije kreirane unutar jednog od emulatora, moÅ¾e biti teÅ¡ko znati **u kojem je instalirana aplikacija**. Brz naÄin da **pronaÄ‘ete taÄan UID** je da pokrenete aplikaciju u simulatoru i izvrÅ¡ite:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Once you know the UID the apps installed within it can be found in `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

MeÄ‘utim, iznenaÄ‘ujuÄ‡e, neÄ‡ete pronaÄ‡i aplikaciju ovde. Morate pristupiti `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

I u ovoj fascikli moÅ¾ete **pronaÄ‡i paket aplikacije.**

## Emulator

Corellium je jedini javno dostupan iOS emulator. To je preduzetniÄko SaaS reÅ¡enje sa modelom licence po korisniku i ne nudi probnu licencu.

## Jailbeaking

Apple strogo zahteva da kod koji se izvrÅ¡ava na iPhone-u mora biti **potpisan sertifikatom koji je izdao Apple**. **Jailbreaking** je proces aktivnog **zaobilaÅ¾enja takvih ograniÄenja** i drugih bezbednosnih kontrola koje postavlja OS. Stoga, kada je ureÄ‘aj jailbreakovan, **provera integriteta** koja je odgovorna za proveru instaliranih aplikacija je zakrpljena tako da je **zaobiÄ‘ena**.

{% hint style="info" %}
Za razliku od Android-a, **ne moÅ¾ete preÄ‡i u "Developer Mode"** na iOS-u da biste pokrenuli nepodpisani/neprovereni kod na ureÄ‘aju.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Iako se Äesto uporeÄ‘uju, **rooting** na Android-u i **jailbreaking** na iOS-u su fundamentalno razliÄiti procesi. Rooting Android ureÄ‘aja moÅ¾e ukljuÄivati **instalaciju `su` binarnog fajla** ili **zamenu sistema sa root-ovanim prilagoÄ‘enim ROM-om**, Å¡to ne zahteva nuÅ¾no eksploate ako je bootloader otkljuÄan. **Flashing custom ROMs** zamenjuje OS ureÄ‘aja nakon otkljuÄavanja bootloader-a, ponekad zahtevajuÄ‡i eksploataciju.

Nasuprot tome, iOS ureÄ‘aji ne mogu flash-ovati prilagoÄ‘ene ROM-ove zbog ograniÄenja bootloader-a da pokreÄ‡e samo Apple-om potpisane slike. **Jailbreaking iOS** ima za cilj da zaobiÄ‘e Apple-ove zaÅ¡tite potpisivanja koda kako bi se pokrenuo nepodpisani kod, proces koji oteÅ¾ava Apple-ovo kontinuirano unapreÄ‘enje bezbednosti.

### Jailbreaking Challenges

Jailbreaking iOS postaje sve teÅ¾i jer Apple brzo zakrpljuje ranjivosti. **Downgrading iOS** je moguÄ‡ samo na ograniÄeno vreme nakon izdanja, Å¡to Äini jailbreaking vremenski osetljivim pitanjem. UreÄ‘aji koriÅ¡Ä‡eni za bezbednosno testiranje ne bi trebali biti aÅ¾urirani osim ako re-jailbreaking nije zagarantovan.

AÅ¾uriranja iOS-a kontroliÅ¡u se **mehanizmom izazov-odgovor** (SHSH blobs), omoguÄ‡avajuÄ‡i instalaciju samo za Apple-om potpisane odgovore. Ovaj mehanizam, poznat kao "prozor potpisivanja", ograniÄava moguÄ‡nost Äuvanja i kasnije koriÅ¡Ä‡enje OTA firmware paketa. [IPSW Downloads website](https://ipsw.me) je resurs za proveru trenutnih prozora potpisivanja.

### Jailbreak Varieties

* **Tethered jailbreaks** zahtevaju vezu sa raÄunarom za svaki reboot.
* **Semi-tethered jailbreaks** omoguÄ‡avaju pokretanje u ne-jailbroken reÅ¾imu bez raÄunara.
* **Semi-untethered jailbreaks** zahtevaju ruÄno re-jailbreaking bez potrebe za raÄunarom.
* **Untethered jailbreaks** nude trajno reÅ¡enje za jailbreak bez potrebe za ponovnom primenom.

### Jailbreaking Tools and Resources

Alati za jailbreaking variraju prema verziji iOS-a i ureÄ‘aju. Resursi kao Å¡to su [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com), i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) pruÅ¾aju aÅ¾urirane informacije. Primeri ukljuÄuju:

* [Checkra1n](https://checkra.in/) za A7-A11 Äip ureÄ‘aje.
* [Palera1n](https://palera.in/) za Checkm8 ureÄ‘aje (A8-A11) na iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) za iOS verzije do 14.8.

Modifikacija vaÅ¡eg ureÄ‘aja nosi rizike, a jailbreaking treba pristupiti sa oprezom.

### Jailbreaking Benefits and Risks

Jailbreaking **uklanja sandboxing koji nameÄ‡e OS**, omoguÄ‡avajuÄ‡i aplikacijama pristup celom fajl sistemu. Ova sloboda omoguÄ‡ava instalaciju neodobrenih aplikacija i pristup viÅ¡e API-ja. MeÄ‘utim, za obiÄne korisnike, jailbreaking **nije preporuÄen** zbog potencijalnih bezbednosnih rizika i nestabilnosti ureÄ‘aja.

### **After Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak Detection**

**Nekoliko aplikacija Ä‡e pokuÅ¡ati da otkrije da li je mobilni ureÄ‘aj jailbreakovan i u tom sluÄaju aplikacija neÄ‡e raditi**

* Nakon jailbreaking-a, iOS **fajlovi i fascikle se obiÄno instaliraju**, ovi se mogu pretraÅ¾ivati da bi se utvrdilo da li je ureÄ‘aj jailbreakovan.
* Na jailbreakovanom ureÄ‘aju aplikacije dobijaju **read/write pristup novim fajlovima** van sandbox-a.
* Neki **API** **pozivi** Ä‡e **drugaÄije reagovati**.
* Prisutnost **OpenSSH** servisa.
* Pozivanje `/bin/sh` Ä‡e **vratiti 1** umesto 0.

**ViÅ¡e informacija o tome kako otkriti jailbreaking** [**ovde**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

MoÅ¾ete pokuÅ¡ati da izbegnete ova otkriÄ‡a koristeÄ‡i **objection's** `ios jailbreak disable`.

## **Jailbreak Detection Bypass**

* MoÅ¾ete pokuÅ¡ati da izbegnete ova otkriÄ‡a koristeÄ‡i **objection's** `ios jailbreak disable`.
* TakoÄ‘e moÅ¾ete instalirati alat **Liberty Lite** (https://ryleyangus.com/repo/). Kada se repo doda, aplikacija bi trebala da se pojavi u kartici â€˜Searchâ€™.

## References

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)
{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
</details>
{% endhint %}
