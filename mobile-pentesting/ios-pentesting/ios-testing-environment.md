# Environnement de test iOS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? Ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Programme de dÃ©veloppement Apple

Une **identitÃ© de provisionnement** est une collection de clÃ©s publiques et privÃ©es associÃ©es Ã  un compte dÃ©veloppeur Apple. Pour **signer des applications**, vous devez payer **99 $/an** pour vous inscrire au **Programme de dÃ©veloppement Apple** et obtenir votre identitÃ© de provisionnement. Sans cela, vous ne pourrez pas exÃ©cuter les applications Ã  partir du code source sur un appareil physique. Une autre option consiste Ã  utiliser un **appareil jailbreakÃ©**.

Ã€ partir de Xcode 7.2, Apple a fourni une option pour crÃ©er un **profil de provisionnement de dÃ©veloppement iOS gratuit** qui permet d'Ã©crire et de tester votre application sur un vÃ©ritable iPhone. Allez dans _Xcode_ --> _PrÃ©fÃ©rences_ --> _Comptes_ --> _+_ (Ajouter un nouvel identifiant Apple avec vos identifiants) --> _Cliquez sur l'identifiant Apple crÃ©Ã©_ --> _GÃ©rer les certificats_ --> _+_ (DÃ©veloppement Apple) --> _TerminÃ©_\
\_\_Ensuite, pour exÃ©cuter votre application sur votre iPhone, vous devez d'abord **indiquer Ã  l'iPhone de faire confiance Ã  l'ordinateur**. Ensuite, vous pouvez essayer d'**exÃ©cuter l'application sur le mobile depuis Xcode**, mais une erreur apparaÃ®tra. Allez donc dans _RÃ©glages_ --> _GÃ©nÃ©ral_ --> _Profils et gestion des appareils_ --> SÃ©lectionnez le profil non approuvÃ© et cliquez sur "**Faire confiance**".

Notez que **les applications signÃ©es par le mÃªme certificat de signature peuvent partager des ressources de maniÃ¨re sÃ©curisÃ©e, comme les Ã©lÃ©ments du trousseau**.

Les profils de provisionnement sont stockÃ©s dans le tÃ©lÃ©phone dans **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulateur**

{% hint style="info" %}
Notez qu'un **simulateur n'est pas la mÃªme chose qu'un Ã©mulateur**. Le simulateur simule simplement le comportement de l'appareil et ses fonctions, mais ne les utilise pas rÃ©ellement.
{% endhint %}

Le simulateur iOS SDK offre une _simulation_ de niveau supÃ©rieur d'un appareil iOS. Plus important encore, les binaires de l'Ã©mulateur sont compilÃ©s en code x86 au lieu de code ARM. Les applications compilÃ©es pour un vÃ©ritable appareil ne s'exÃ©cutent pas, rendant le simulateur inutile pour l'analyse en boÃ®te noire et l'ingÃ©nierie inverse.

### **Simulateur**

La premiÃ¨re chose que vous devez savoir, c'est que **rÃ©aliser un test de pÃ©nÃ©tration dans un simulateur sera beaucoup plus limitÃ© que de le faire sur un appareil jailbreakÃ©**.

Tous les outils nÃ©cessaires pour crÃ©er et prendre en charge une application iOS sont **officiellement pris en charge uniquement sur Mac OS**.\
L'outil de facto d'Apple pour crÃ©er/dÃ©boguer/instrumenter des applications iOS est **Xcode**. Il peut Ãªtre utilisÃ© pour tÃ©lÃ©charger d'autres composants tels que des **simulateurs** et diffÃ©rentes **versions de SDK** nÃ©cessaires pour crÃ©er et **tester** votre application.\
Il est fortement recommandÃ© de **tÃ©lÃ©charger** Xcode depuis l'**App Store officiel**. D'autres versions pourraient contenir des logiciels malveillants.

Les fichiers du simulateur peuvent Ãªtre trouvÃ©s dans `/Users/<nom_utilisateur>/Library/Developer/CoreSimulator/Devices`

Pour ouvrir le simulateur, lancez Xcode, puis cliquez sur l'onglet _Xcode_ --> _Outils de dÃ©veloppement_ --> _Simulateur_\
\_\_Dans l'image suivante, en cliquant sur "iPod touch \[...]", vous pouvez sÃ©lectionner un autre appareil Ã  tester :

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Applications dans le simulateur

Ã€ l'intÃ©rieur de `/Users/<nom_utilisateur>/Library/Developer/CoreSimulator/Devices`, vous pouvez trouver tous les **simulateurs installÃ©s**. Si vous souhaitez accÃ©der aux fichiers d'une application crÃ©Ã©e dans l'un des Ã©mulateurs, il peut Ãªtre difficile de savoir **dans lequel l'application est installÃ©e**. Une faÃ§on rapide de **trouver l'UID correct** est d'exÃ©cuter l'application dans le simulateur et d'exÃ©cuter :
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Une fois que vous connaissez l'UID, les applications installÃ©es peuvent Ãªtre trouvÃ©es dans `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`.

Cependant, Ã©tonnamment, vous ne trouverez pas l'application ici. Vous devez accÃ©der Ã  `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`.

Et dans ce dossier, vous pouvez **trouver le package de l'application**.

## Ã‰mulateur

Corellium est le seul Ã©mulateur iOS disponible publiquement. C'est une solution SaaS d'entreprise avec un modÃ¨le de licence par utilisateur et ne propose aucun essai gratuit.

## Jailbreak

Apple exige strictement que le code s'exÃ©cutant sur l'iPhone soit **signÃ© par un certificat dÃ©livrÃ© par Apple**. Le **jailbreak** est le processus de **contournement actif de ces restrictions** et d'autres contrÃ´les de sÃ©curitÃ© mis en place par le systÃ¨me d'exploitation. Par consÃ©quent, une fois que l'appareil est jailbreakÃ©, la **vÃ©rification d'intÃ©gritÃ©** chargÃ©e de vÃ©rifier les applications installÃ©es est patchÃ©e pour Ãªtre **contournÃ©e**.

{% hint style="info" %}
Contrairement Ã  Android, **vous ne pouvez pas passer en "mode dÃ©veloppeur"** sur iOS pour exÃ©cuter du code non signÃ©/non fiable sur l'appareil.
{% endhint %}

### Comparaison avec le root sur Android

Le jailbreak iOS est souvent **comparÃ© au root sur Android**, mais le processus est en rÃ©alitÃ© assez **diffÃ©rent**. Pour expliquer la diffÃ©rence, nous allons d'abord passer en revue les concepts de "root" et de "flashing" sur Android.

* **Root**: Cela implique gÃ©nÃ©ralement l'installation du binaire `su` sur le systÃ¨me ou le remplacement de l'ensemble du systÃ¨me par une ROM personnalisÃ©e rootÃ©e. Les exploits ne sont pas nÃ©cessaires pour obtenir un accÃ¨s root tant que le chargeur de dÃ©marrage est accessible.
* **Flashing de ROM personnalisÃ©e**: Cela vous permet de remplacer le systÃ¨me d'exploitation qui s'exÃ©cute sur l'appareil aprÃ¨s avoir dÃ©verrouillÃ© le chargeur de dÃ©marrage. Le chargeur de dÃ©marrage peut nÃ©cessiter un exploit pour Ãªtre dÃ©verrouillÃ©.

**Sur les appareils iOS, il est impossible de flasher une ROM personnalisÃ©e** car le chargeur de dÃ©marrage iOS **ne permet de dÃ©marrer et de flasher que des images signÃ©es par Apple**. C'est pourquoi mÃªme les **images iOS officielles ne peuvent pas Ãªtre installÃ©es si elles ne sont pas signÃ©es par Apple, et cela rend les rÃ©trogradations iOS possibles uniquement tant que la version iOS prÃ©cÃ©dente est toujours signÃ©e**.

Le but du jailbreak est de **dÃ©sactiver les protections d'iOS** (en particulier les mÃ©canismes de signature de code d'Apple) afin que du **code non signÃ© arbitraire puisse s'exÃ©cuter sur l'appareil** (par exemple, du code personnalisÃ© ou tÃ©lÃ©chargÃ© Ã  partir de magasins d'applications alternatifs tels que Cydia ou Sileo). Le mot "jailbreak" est une rÃ©fÃ©rence familiÃ¨re Ã  des outils tout-en-un qui automatisent le processus de dÃ©sactivation.

### ConsidÃ©rations lors du jailbreak

Le jailbreak d'un appareil iOS devient de plus en plus **compliquÃ©** car Apple renforce constamment le systÃ¨me et corrige les vulnÃ©rabilitÃ©s exploitÃ©es. Le jailbreak est devenu une procÃ©dure trÃ¨s sensible au temps car **Apple cesse de signer ces versions vulnÃ©rables relativement peu de temps aprÃ¨s la sortie d'une correction** (Ã  moins que le jailbreak ne bÃ©nÃ©ficie de vulnÃ©rabilitÃ©s basÃ©es sur le matÃ©riel, telles que l'exploit [limera1n](https://www.theiphonewiki.com/wiki/Limera1n) affectant le BootROM de l'iPhone 4 et de l'iPad 1). Cela signifie que **vous ne pouvez pas rÃ©trograder vers une version spÃ©cifique d'iOS une fois qu'Apple cesse de signer le micrologiciel**.

Si vous avez un appareil jailbreakÃ© que vous utilisez pour des tests de sÃ©curitÃ©, **gardez-le** tel quel Ã  moins d'Ãªtre sÃ»r Ã  100% que vous pouvez le re-jailbreaker aprÃ¨s la mise Ã  niveau vers la derniÃ¨re version d'iOS.

Les mises Ã  niveau d'iOS sont basÃ©es sur un processus de dÃ©fi-rÃ©ponse (gÃ©nÃ©rant les soi-disant blobs SHSH en rÃ©sultat). L'appareil n'autorisera l'installation du systÃ¨me d'exploitation que si la rÃ©ponse au dÃ©fi est signÃ©e par Apple. C'est ce que les chercheurs appellent une "fenÃªtre de signature", et c'est la raison pour laquelle **vous ne pouvez pas simplement stocker le package de micrologiciel OTA que vous avez tÃ©lÃ©chargÃ© et le charger sur l'appareil quand vous le souhaitez**. Lors de mises Ã  niveau mineures d'iOS, deux versions peuvent Ãªtre signÃ©es par Apple (la plus rÃ©cente et la version iOS prÃ©cÃ©dente). C'est la seule situation dans laquelle vous pouvez rÃ©trograder l'appareil iOS. Vous pouvez **vÃ©rifier la fenÃªtre de signature actuelle et tÃ©lÃ©charger le micrologiciel OTA depuis le** [**site Web IPSW Downloads**](https://ipsw.me).

{% hint style="danger" %}
**La mise Ã  jour du systÃ¨me d'exploitation supprime l'effet du jailbreak.**
{% endhint %}

### Types de jailbreak

* Les **jailbreaks tethered** ne persistent pas aprÃ¨s les redÃ©marrages, donc il faut connecter (tethered) l'appareil Ã  un ordinateur Ã  chaque redÃ©marrage pour rÃ©appliquer le jailbreak. L'appareil peut ne pas redÃ©marrer du tout si l'ordinateur n'est pas connectÃ©.
* Les **jailbreaks semi-tethered** ne peuvent pas Ãªtre rÃ©appliquÃ©s Ã  moins que l'appareil ne soit connectÃ© Ã  un ordinateur lors du redÃ©marrage. L'appareil peut Ã©galement dÃ©marrer en mode non jailbreakÃ© de lui-mÃªme.
* Les **jailbreaks semi-untethered** permettent Ã  l'appareil de dÃ©marrer de lui-mÃªme, mais les correctifs du noyau (ou les modifications de l'espace utilisateur) pour dÃ©sactiver la signature du code ne sont pas appliquÃ©s automatiquement. L'utilisateur doit rÃ©appliquer le jailbreak de l'appareil en lanÃ§ant une application ou en visitant un site web (sans nÃ©cessiter de connexion Ã  un ordinateur, d'oÃ¹ le terme untethered).
* Les **jailbreaks untethered** sont le choix le plus populaire pour les utilisateurs finaux car ils ne doivent Ãªtre appliquÃ©s qu'une seule fois, aprÃ¨s quoi l'appareil sera jailbreakÃ© en permanence.

### Outils de jailbreak

DiffÃ©rentes versions d'iOS nÃ©cessitent **diffÃ©rentes techniques de jailbreak**. [DÃ©terminez si un jailbreak public est disponible pour votre version d'iOS](https://canijailbreak.com). MÃ©fiez-vous des outils et des logiciels espions falsifiÃ©s, qui se cachent souvent derriÃ¨re des noms de domaine similaires au nom du groupe/auteur de jailbreak.

Exemples de versions :

* [Checkra1n](https://checkra.in/) : Fonctionne sur les appareils Ã©quipÃ©s de la puce A7 et aussi rÃ©cents que la puce A11, par exemple l'iPhone 5S jusqu'Ã  l'iPhone X.
* [Palera1n](https://palera.in/) : Appareils Checkm8 (A8-A11) sous iOS 15.0-16.5.
* [Unc0ver](https://checkra.in/) : Fonctionne uniquement pour les versions d'iOS jusqu'Ã  14.8, car Apple a corrigÃ© les problÃ¨mes qui permettaient Ã  Unc0ver de s'exÃ©cuter.

La scÃ¨ne du jailbreak iOS Ã©volue si rapidement qu'il est difficile de fournir des instructions Ã  jour. Cependant, nous pouvons vous orienter vers certaines sources qui sont actuellement fiables :

* [**Can I Jailbreak?**](https://canijailbreak.com)
* [**The iPhone Wiki**](https://www.theiphonewiki.com)
* [**Redmond Pie**](https://www.redmondpie.com)
* [**Reddit Jailbreak**](https://www.reddit.com/r/jailbreak/)
* [**https://checkra.in/**](https://checkra.in)

> Notez que toute modification que vous apportez Ã  votre appareil se fait Ã  vos propres risques. Bien que le jailbreak soit gÃ©nÃ©ralement sÃ»r, des problÃ¨mes peuvent survenir et vous risquez de rendre votre appareil inutilisable. Aucune autre partie que vous-mÃªme ne peut Ãªtre tenue responsable de tout dommage.
### Avantages

L'effet secondaire le plus important du Jailbreaking est qu'il **supprime toute sandbox mise en place par le systÃ¨me d'exploitation**. Par consÃ©quent, **toute application sur l'appareil peut lire n'importe quel fichier** sur le systÃ¨me de fichiers, y compris les fichiers des autres applications, les cookies et le trousseau.

Un appareil jailbreakÃ© permet aux utilisateurs d'**installer des applications non approuvÃ©es** et d'exploiter **plus d'API**, qui ne sont normalement pas accessibles.

{% hint style="warning" %}
**Il n'est pas recommandÃ© de jailbreaker le mobile pour les utilisateurs rÃ©guliers**
{% endhint %}

### **AprÃ¨s le Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **DÃ©tection du Jailbreak**

**Plusieurs applications essaieront de dÃ©tecter si le mobile est jailbreakÃ© et, dans ce cas, l'application ne se lancera pas**

* AprÃ¨s le jailbreak d'un iOS, **des fichiers et des dossiers sont gÃ©nÃ©ralement installÃ©s**, qui peuvent Ãªtre recherchÃ©s pour dÃ©terminer si l'appareil est jailbreakÃ©.
* Sur un appareil jailbreakÃ©, les applications obtiennent un **accÃ¨s en lecture/Ã©criture Ã  de nouveaux fichiers** en dehors de la sandbox.
* Certains **appels d'API** se comporteront diffÃ©remment.
* La prÃ©sence du service **OpenSSH**.
* L'appel Ã  `/bin/sh` renverra **1** au lieu de 0.

**Plus d'informations sur la faÃ§on de dÃ©tecter le jailbreak** [**ici**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Vous pouvez essayer d'Ã©viter ces dÃ©tections en utilisant la commande `ios jailbreak disable` de **objection**.

## **Contournement de la dÃ©tection du Jailbreak**

* Vous pouvez essayer d'Ã©viter ces dÃ©tections en utilisant la commande `ios jailbreak disable` de **objection**.
* Vous pouvez Ã©galement installer l'outil **Liberty Lite** (https://ryleyangus.com/repo/). Une fois le rÃ©fÃ©rentiel ajoutÃ©, l'application devrait apparaÃ®tre dans l'onglet "Recherche".

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Vous travaillez dans une **entreprise de cybersÃ©curitÃ©** ? Vous voulez voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
