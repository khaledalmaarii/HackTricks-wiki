# Åšrodowisko testowe iOS

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) **i** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **repozytoriÃ³w GitHub**.

</details>

## Program Apple Developer

**Identyfikacja dostarczania** to zbiÃ³r kluczy publicznych i prywatnych powiÄ…zanych z kontem dewelopera Apple. Aby **podpisywaÄ‡ aplikacje**, musisz zapÅ‚aciÄ‡ **99$/rok**, aby zarejestrowaÄ‡ siÄ™ w **Programie Dewelopera Apple** i uzyskaÄ‡ swojÄ… identyfikacjÄ™ dostarczania. Bez tego nie bÄ™dziesz mÃ³gÅ‚ uruchamiaÄ‡ aplikacji ze ÅºrÃ³dÅ‚owego kodu na fizycznym urzÄ…dzeniu. InnÄ… opcjÄ… jest uÅ¼ycie **urzÄ…dzenia z jailbreakiem**.

PoczÄ…wszy od Xcode 7.2 Apple udostÄ™pniÅ‚ opcjÄ™ tworzenia **darmowego profilu dostarczania dla rozwoju iOS**, ktÃ³ry umoÅ¼liwia pisanie i testowanie aplikacji na prawdziwym iPhone'ie. PrzejdÅº do _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Dodaj nowe ID aplikacji do swoich poÅ›wiadczeÅ„) --> _Kliknij utworzone ID Apple_ --> _ZarzÄ…dzaj certyfikatami_ --> _+_ (Apple Development) --> _Gotowe_\
\_\_NastÄ™pnie, aby uruchomiÄ‡ aplikacjÄ™ na iPhone'ie, musisz najpierw **wskazaÄ‡ iPhone'owi, aby zaufaÅ‚ komputerowi**. NastÄ™pnie moÅ¼esz sprÃ³bowaÄ‡ **uruchomiÄ‡ aplikacjÄ™ na telefonie komÃ³rkowym z Xcode**, ale pojawi siÄ™ bÅ‚Ä…d. PrzejdÅº wiÄ™c do _Ustawienia_ --> _OgÃ³lne_ --> _Profile i zarzÄ…dzanie urzÄ…dzeniami_ --> Wybierz niezaufany profil i kliknij "**Zaufaj**".

ZauwaÅ¼, Å¼e **aplikacje podpisane tym samym certyfikatem podpisu mogÄ… dzieliÄ‡ siÄ™ zasobami w bezpieczny sposÃ³b, takimi jak elementy schowka**.

Profile dostarczania sÄ… przechowywane w telefonie w **`/Library/MobileDevice/ProvisioningProfiles`**

## **Symulator**

{% hint style="info" %}
ZauwaÅ¼, Å¼e **symulator nie jest tym samym, co emulator**. Symulator tylko symuluje zachowanie urzÄ…dzenia i funkcje, ale ich faktycznie nie uÅ¼ywa.
{% endhint %}

### **Symulator**

PierwszÄ… rzeczÄ…, ktÃ³rÄ… musisz wiedzieÄ‡, jest to, Å¼e **przeprowadzenie pentestu wewnÄ…trz symulatora bÄ™dzie znacznie bardziej ograniczone niÅ¼ w przypadku urzÄ…dzenia z jailbreakiem**.

Wszystkie narzÄ™dzia niezbÄ™dne do budowy i obsÅ‚ugi aplikacji iOS sÄ… **oficjalnie obsÅ‚ugiwane tylko w systemie Mac OS**.\
NarzÄ™dziem de facto firmy Apple do tworzenia/debugowania/instrumentowania aplikacji iOS jest **Xcode**. MoÅ¼e byÄ‡ uÅ¼ywany do pobierania innych komponentÃ³w, takich jak **symulatory** i rÃ³Å¼ne **wersje SDK**, ktÃ³re sÄ… wymagane do budowy i **testowania** aplikacji.\
Zaleca siÄ™ **pobranie** Xcode ze **sklepu aplikacji oficjalnego**. Inne wersje mogÄ… zawieraÄ‡ zÅ‚oÅ›liwe oprogramowanie.

Pliki symulatora moÅ¼na znaleÅºÄ‡ w `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/CoreSimulator/Devices`

Aby otworzyÄ‡ symulator, uruchom Xcode, a nastÄ™pnie kliknij w zakÅ‚adkÄ™ _Xcode_ --> _OtwÃ³rz narzÄ™dzia deweloperskie_ --> _Symulator_\
\_\_Na poniÅ¼szym obrazku klikajÄ…c na "iPod touch \[...]" moÅ¼esz wybraÄ‡ inne urzÄ…dzenie do przetestowania:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Aplikacje w symulatorze

WewnÄ…trz `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/CoreSimulator/Devices` moÅ¼esz znaleÅºÄ‡ wszystkie **zainstalowane symulatory**. JeÅ›li chcesz uzyskaÄ‡ dostÄ™p do plikÃ³w aplikacji utworzonej w jednym z emulatorÃ³w, moÅ¼e byÄ‡ trudno ustaliÄ‡, **w ktÃ³rym z nich zainstalowana jest aplikacja**. Szybkim sposobem na **znalezienie poprawnego UID** jest uruchomienie aplikacji w symulatorze i wykonanie polecenia:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Gdy juÅ¼ znasz UID, zainstalowane aplikacje moÅ¼na znaleÅºÄ‡ w `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

Jednak zaskakujÄ…co nie znajdziesz tutaj aplikacji. Musisz uzyskaÄ‡ dostÄ™p do `/Users/<nazwa_uÅ¼ytkownika>/Library/Developer/Xcode/DerivedData/{Aplikacja}/Build/Products/Debug-iphonesimulator/`

W tym folderze **znajdziesz paczkÄ™ aplikacji**.

## Emulator

Corellium to jedyny publicznie dostÄ™pny emulator iOS. Jest to rozwiÄ…zanie typu enterprise SaaS z modelem licencji na uÅ¼ytkownika i nie oferuje Å¼adnej wersji prÃ³bnej.

## Jailbreak

Apple Å›ciÅ›le wymaga, aby kod uruchamiany na iPhone'ie byÅ‚ **podpisany przez certyfikat wydany przez Apple**. **Jailbreak** to proces aktywnego **omijania takich ograniczeÅ„** i innych kontroli bezpieczeÅ„stwa wprowadzonych przez system operacyjny. Dlatego po zjailbreakowaniu urzÄ…dzenia, **sprawdzanie integralnoÅ›ci**, ktÃ³re jest odpowiedzialne za sprawdzanie zainstalowanych aplikacji, jest Å‚atane, aby je **obejÅ›Ä‡**.

{% hint style="info" %}
W przeciwieÅ„stwie do Androida, w iOS **nie moÅ¼na przeÅ‚Ä…czyÄ‡ siÄ™ w tryb "Developer"**, aby uruchamiaÄ‡ niepodpisany/niezaufany kod na urzÄ…dzeniu.
{% endhint %}

### Rootowanie Androida vs. Jailbreak iOS

ChociaÅ¼ czÄ™sto porÃ³wnuje siÄ™ **rootowanie** na Androidzie i **jailbreak** na iOS, sÄ… to fundamentalnie rÃ³Å¼ne procesy. Rootowanie urzÄ…dzeÅ„ Android moÅ¼e obejmowaÄ‡ **instalacjÄ™ binarnego pliku `su`** lub **zamianÄ™ systemu na zrootowany niestandardowy ROM**, co niekoniecznie wymaga wykorzystania podatnoÅ›ci, jeÅ›li bootloader jest odblokowany. **Flashing niestandardowych ROM-Ã³w** polega na zastÄ…pieniu systemu operacyjnego urzÄ…dzenia po odblokowaniu bootloadera, co czasami wymaga wykorzystania podatnoÅ›ci.

W przeciwieÅ„stwie do tego, urzÄ…dzenia iOS nie mogÄ… flashowaÄ‡ niestandardowych ROM-Ã³w ze wzglÄ™du na ograniczenie bootloadera do uruchamiania tylko obrazÃ³w podpisanych przez Apple. **Jailbreak iOS** ma na celu obejÅ›cie zabezpieczeÅ„ podpisu kodu Apple, aby uruchamiaÄ‡ niepodpisany kod, co jest utrudnione przez ciÄ…gÅ‚e ulepszenia zabezpieczeÅ„ Apple.

### Wyzwania zwiÄ…zane z jailbreakiem

Jailbreak iOS staje siÄ™ coraz trudniejszy, poniewaÅ¼ Apple szybko Å‚ata podatnoÅ›ci. **Zmniejszenie wersji iOS** jest moÅ¼liwe tylko przez ograniczony czas po wydaniu, co czyni jailbreak kwestiÄ… czasowÄ…. UrzÄ…dzenia uÅ¼ywane do testÃ³w bezpieczeÅ„stwa nie powinny byÄ‡ aktualizowane, chyba Å¼e ponowne zjailbreakowanie jest gwarantowane.

Aktualizacje iOS sÄ… kontrolowane przez mechanizm **wyzwania-odpowiedzi** (bloki SHSH), ktÃ³ry pozwala na instalacjÄ™ tylko odpowiedzi podpisanych przez Apple. Ten mechanizm, znany jako "okno podpisu", ogranicza moÅ¼liwoÅ›Ä‡ przechowywania i pÃ³Åºniejszego uÅ¼ycia pakietÃ³w OTA firmware. Strona internetowa [IPSW Downloads](https://ipsw.me) jest ÅºrÃ³dÅ‚em informacji na temat aktualnych okien podpisu.

### Rodzaje jailbreakÃ³w

- **Jailbreaki tethered** wymagajÄ… poÅ‚Ä…czenia z komputerem przy kaÅ¼dym ponownym uruchomieniu.
- **Jailbreaki semi-tethered** pozwalajÄ… na uruchomienie w trybie bez jailbreaka bez komputera.
- **Jailbreaki semi-untethered** wymagajÄ… rÄ™cznego ponownego zjailbreakowania bez koniecznoÅ›ci uÅ¼ycia komputera.
- **Jailbreaki untethered** oferujÄ… trwaÅ‚e rozwiÄ…zanie jailbreak bez koniecznoÅ›ci ponownego stosowania.

### NarzÄ™dzia i zasoby do jailbreaku

NarzÄ™dzia do jailbreaku rÃ³Å¼niÄ… siÄ™ w zaleÅ¼noÅ›ci od wersji iOS i urzÄ…dzenia. Zasoby takie jak [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) dostarczajÄ… aktualnych informacji. PrzykÅ‚ady to:

- [Checkra1n](https://checkra.in/) dla urzÄ…dzeÅ„ z chipem A7-A11.
- [Palera1n](https://palera.in/) dla urzÄ…dzeÅ„ Checkm8 (A8-A11) na iOS 15.0-16.5.
- [Unc0ver](https://unc0ver.dev/) dla wersji iOS do 14.8.

Modyfikowanie urzÄ…dzenia niesie ze sobÄ… ryzyko, a jailbreak powinien byÄ‡ podchodzony ostroÅ¼nie.

### KorzyÅ›ci i ryzyka zwiÄ…zane z jailbreakiem

Jailbreak **usuwa narzucone przez system operacyjny sandboxing**, umoÅ¼liwiajÄ…c aplikacjom dostÄ™p do caÅ‚ego systemu plikÃ³w. Ta swoboda umoÅ¼liwia instalacjÄ™ niezatwierdzonych aplikacji i dostÄ™p do wiÄ™kszej liczby interfejsÃ³w API. Jednak dla zwykÅ‚ych uÅ¼ytkownikÃ³w **nie zaleca siÄ™** jailbreaku ze wzglÄ™du na potencjalne ryzyko bezpieczeÅ„stwa i niestabilnoÅ›Ä‡ urzÄ…dzenia.

### **Po zjailbreakowaniu**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Wykrywanie jailbreaku**

**Wiele aplikacji bÄ™dzie prÃ³bowaÄ‡ wykryÄ‡, czy urzÄ…dzenie jest zjailbreakowane, i w takim przypadku aplikacja nie zostanie uruchomiona**

* Po zjailbreakowaniu iOS **zwykle instalowane sÄ… pliki i foldery**, ktÃ³re moÅ¼na przeszukaÄ‡, aby sprawdziÄ‡, czy urzÄ…dzenie jest zjailbreakowane.
* Na zjailbreakowanym urzÄ…dzeniu aplikacje uzyskujÄ… **dostÄ™p do odczytu/zapisu nowych plikÃ³w** poza sandboxem.
* NiektÃ³re **wywoÅ‚ania API** bÄ™dÄ… **zachowywaÄ‡ siÄ™ inaczej**.
* ObecnoÅ›Ä‡ usÅ‚ugi **OpenSSH**
* WywoÅ‚anie `/bin/sh` zwrÃ³ci 1 zamiast 0

**WiÄ™cej informacji na temat wykrywania jailbreaku** [**tutaj**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

MoÅ¼esz sprÃ³bowaÄ‡ uniknÄ…Ä‡ tych wykryÄ‡, uÅ¼ywajÄ…c `ios jailbreak disable` z **narzÄ™dziem objection**.

## **OminiÄ™cie wykrywania jailbreaku**

* MoÅ¼esz sprÃ³bowaÄ‡ uniknÄ…Ä‡ tych wykryÄ‡, uÅ¼ywajÄ…c `ios jailbreak disable` z **narzÄ™dziem objection**.
* MoÅ¼esz rÃ³wnieÅ¼ zainstalowaÄ‡ narzÄ™dzie **Liberty Lite** (https://ryleyangus.com/repo/). Po dodaniu repozytorium, aplikacja powinna pojawiÄ‡ siÄ™ w zakÅ‚adce â€Wyszukajâ€.

## OdwoÅ‚ania
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi trikami hakerskimi, przesyÅ‚ajÄ…c PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
