# Udostpnianie UIActivity w systemie iOS

<details>

<summary><strong>Dowiedz si, jak hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

# Proste udostpnianie UIActivity

Od wersji iOS 6 aplikacje innych firm mog **udostpnia dane**, takie jak tekst, adresy URL lub obrazy, za pomoc mechanizm贸w takich jak AirDrop, jak opisano w [przewodniku dotyczcym komunikacji midzy aplikacjami](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3) firmy Apple. Ta funkcja manifestuje si poprzez og贸lnodostpne _okno aktywnoci udostpniania_, kt贸re pojawia si po interakcji z przyciskiem "Udostpnij".

Pene wyliczenie wszystkich wbudowanych opcji udostpniania jest dostpne pod adresem [UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype). Deweloperzy mog zdecydowa si wykluczy okrelone opcje udostpniania, jeli uwa偶aj je za nieodpowiednie dla swojej aplikacji.

## **Jak udostpni dane**

Nale偶y zwr贸ci uwag na:

- Charakter udostpnianych danych.
- Dodanie niestandardowych aktywnoci.
- Wykluczenie okrelonych typ贸w aktywnoci.

Udostpnianie jest uatwione poprzez utworzenie instancji `UIActivityViewController`, do kt贸rej przekazywane s elementy przeznaczone do udostpnienia. Mo偶na to osign, wywoujc:
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
Deweloperzy powinni dokadnie przeanalizowa `UIActivityViewController` w celu sprawdzenia aktywnoci i niestandardowych aktywnoci, z kt贸rymi jest zainicjowany, oraz wszelkich okrelonych `excludedActivityTypes`.

## **Jak otrzyma dane**

Nastpujce aspekty s kluczowe podczas odbierania danych:

- Deklaracja **niestandardowych typ贸w dokument贸w**.
- Okrelenie **typ贸w dokument贸w, kt贸re aplikacja mo偶e otworzy**.
- Weryfikacja **integralnoci otrzymanych danych**.

Bez dostpu do kodu 藕r贸dowego, mo偶na nadal sprawdzi plik `Info.plist` pod ktem kluczy takich jak `UTExportedTypeDeclarations`, `UTImportedTypeDeclarations` i `CFBundleDocumentTypes`, aby zrozumie rodzaje dokument贸w, kt贸re aplikacja mo偶e obsugiwa i deklarowa.

Zwizy przewodnik dotyczcy tych kluczy jest dostpny na [Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i), podkrelajc znaczenie definiowania i importowania UTI dla rozpoznawania na poziomie systemu oraz czenia typ贸w dokument贸w z aplikacj w dialogu "Otw贸rz za pomoc".

## Dynamiczne podejcie testowe

Aby przetestowa **wysyanie aktywnoci**, mo偶na:

- Podczy si do metody `init(activityItems:applicationActivities:)`, aby przechwyci udostpniane elementy i aktywnoci.
- Zidentyfikowa wykluczone aktywnoci, przechwytujc waciwo `excludedActivityTypes`.

W przypadku **odbierania element贸w** wymaga to:

- Udostpnienia pliku aplikacji z innego 藕r贸da (np. AirDrop, e-mail), co spowoduje wywietlenie dialogu "Otw贸rz za pomoc...".
- Podczenia metody `application:openURL:options:` oraz innych zidentyfikowanych metod podczas analizy statycznej, aby obserwowa reakcj aplikacji.
- Wykorzystania uszkodzonych plik贸w lub technik fuzzingowych w celu oceny odpornoci aplikacji.

## Odwoania
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
