# iOS UIActivity Sharing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

# UIActivity Sharing Simplified

Desde iOS 6 en adelante, las aplicaciones de terceros han podido **compartir datos** como texto, URLs o im谩genes utilizando mecanismos como AirDrop, como se detalla en la [gu铆a de Comunicaci贸n entre Aplicaciones](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3) de Apple. Esta funci贸n se manifiesta a trav茅s de una _hoja de actividad de compartir_ a nivel del sistema que aparece al interactuar con el bot贸n "Compartir".

Una enumeraci贸n completa de todas las opciones de compartir integradas est谩 disponible en [UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype). Los desarrolladores pueden optar por excluir opciones de compartir espec铆ficas si las consideran inapropiadas para su aplicaci贸n.

## **C贸mo Compartir Datos**

Se debe prestar atenci贸n a:

- La naturaleza de los datos que se comparten.
- La inclusi贸n de actividades personalizadas.
- La exclusi贸n de ciertos tipos de actividad.

El compartir se facilita a trav茅s de la instanciaci贸n de un `UIActivityViewController`, al cual se pasan los elementos destinados a compartir. Esto se logra llamando:
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
Los desarrolladores deben examinar el `UIActivityViewController` por las actividades y actividades personalizadas con las que se inicializa, as铆 como cualquier `excludedActivityTypes` especificado.

## **C贸mo Recibir Datos**

Los siguientes aspectos son cruciales al recibir datos:

- La declaraci贸n de **tipos de documentos personalizados**.
- La especificaci贸n de **tipos de documentos que la aplicaci贸n puede abrir**.
- La verificaci贸n de la **integridad de los datos recibidos**.

Sin acceso al c贸digo fuente, a煤n se puede inspeccionar el `Info.plist` en busca de claves como `UTExportedTypeDeclarations`, `UTImportedTypeDeclarations` y `CFBundleDocumentTypes` para entender los tipos de documentos que una aplicaci贸n puede manejar y declarar.

Una gu铆a concisa sobre estas claves est谩 disponible en [Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i), destacando la importancia de definir e importar UTIs para el reconocimiento a nivel del sistema y asociar tipos de documentos con su aplicaci贸n para la integraci贸n en el di谩logo "Abrir con".

## Enfoque de Pruebas Din谩micas

Para probar **actividades de env铆o**, se podr铆a:

- Engancharse al m茅todo `init(activityItems:applicationActivities:)` para capturar los elementos y actividades que se comparten.
- Identificar actividades excluidas interceptando la propiedad `excludedActivityTypes`.

Para **recibir elementos**, implica:

- Compartir un archivo con la aplicaci贸n desde otra fuente (por ejemplo, AirDrop, correo electr贸nico) que solicite el di谩logo "Abrir con...".
- Enganchar `application:openURL:options:` entre otros m茅todos identificados durante el an谩lisis est谩tico para observar la respuesta de la aplicaci贸n.
- Emplear archivos malformados o t茅cnicas de fuzzing para evaluar la robustez de la aplicaci贸n.

## Referencias
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
