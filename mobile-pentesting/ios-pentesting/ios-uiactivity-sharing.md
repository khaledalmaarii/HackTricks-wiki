# iOS UIActivity Sharing

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­è¢«å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

# UIActivity Sharing Simplified

ä»iOS 6å¼€å§‹ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨AirDropç­‰æœºåˆ¶å…±äº«æ–‡æœ¬ã€URLæˆ–å›¾åƒç­‰æ•°æ®ï¼Œå¦‚è‹¹æœçš„[åº”ç”¨é—´é€šä¿¡æŒ‡å—](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3)ä¸­æ‰€è¿°ã€‚æ­¤åŠŸèƒ½é€šè¿‡ç³»ç»ŸèŒƒå›´çš„_å…±äº«æ´»åŠ¨è¡¨_å®ç°ï¼Œç”¨æˆ·ä¸â€œåˆ†äº«â€æŒ‰é’®äº¤äº’æ—¶ä¼šå‡ºç°è¯¥è¡¨ã€‚

å¯ä»¥åœ¨[UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype)ä¸­æ‰¾åˆ°æ‰€æœ‰å†…ç½®å…±äº«é€‰é¡¹çš„è¯¦å°½æšä¸¾ã€‚å¼€å‘äººå‘˜å¯ä»¥é€‰æ‹©æ’é™¤ç‰¹å®šçš„å…±äº«é€‰é¡¹ï¼Œå¦‚æœè®¤ä¸ºè¿™äº›é€‰é¡¹ä¸é€‚åˆå…¶åº”ç”¨ç¨‹åºã€‚

## **å¦‚ä½•å…±äº«æ•°æ®**

åº”æ³¨æ„ä»¥ä¸‹å†…å®¹ï¼š

- è¦å…±äº«çš„æ•°æ®çš„æ€§è´¨ã€‚
- åŒ…æ‹¬è‡ªå®šä¹‰æ´»åŠ¨ã€‚
- æ’é™¤æŸäº›æ´»åŠ¨ç±»å‹ã€‚

é€šè¿‡å®ä¾‹åŒ–`UIActivityViewController`æ¥å®ç°å…±äº«ï¼Œå°†è¦å…±äº«çš„é¡¹ç›®ä¼ é€’ç»™å®ƒã€‚è¿™å¯ä»¥é€šè¿‡è°ƒç”¨å®ç°ï¼š
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
å¼€å‘äººå‘˜åº”è¯¥ä»”ç»†å®¡æŸ¥`UIActivityViewController`çš„åˆå§‹åŒ–æ´»åŠ¨å’Œè‡ªå®šä¹‰æ´»åŠ¨ï¼Œä»¥åŠä»»ä½•æŒ‡å®šçš„`excludedActivityTypes`ã€‚

## **å¦‚ä½•æ¥æ”¶æ•°æ®**

åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œä»¥ä¸‹å‡ ä¸ªæ–¹é¢è‡³å…³é‡è¦ï¼š

- **è‡ªå®šä¹‰æ–‡æ¡£ç±»å‹**çš„å£°æ˜ã€‚
- æŒ‡å®šåº”ç”¨ç¨‹åºå¯ä»¥æ‰“å¼€çš„**æ–‡æ¡£ç±»å‹**ã€‚
- éªŒè¯æ¥æ”¶æ•°æ®çš„**å®Œæ•´æ€§**ã€‚

å³ä½¿æ²¡æœ‰è®¿é—®æºä»£ç ï¼Œä¹Ÿå¯ä»¥æ£€æŸ¥`Info.plist`ä¸­çš„é”®ï¼Œå¦‚`UTExportedTypeDeclarations`ï¼Œ`UTImportedTypeDeclarations`å’Œ`CFBundleDocumentTypes`ï¼Œä»¥äº†è§£åº”ç”¨ç¨‹åºå¯ä»¥å¤„ç†å’Œå£°æ˜çš„æ–‡æ¡£ç±»å‹ã€‚

å…³äºè¿™äº›é”®çš„ç®€æ˜æŒ‡å—å¯åœ¨[Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i)ä¸Šæ‰¾åˆ°ï¼Œå¼ºè°ƒäº†å®šä¹‰å’Œå¯¼å…¥UTIsä»¥ä¾›ç³»ç»Ÿå¹¿æ³›è¯†åˆ«ï¼Œå¹¶å°†æ–‡æ¡£ç±»å‹ä¸æ‚¨çš„åº”ç”¨ç¨‹åºå…³è”ä»¥åœ¨â€œæ‰“å¼€æ–¹å¼â€å¯¹è¯æ¡†ä¸­é›†æˆçš„é‡è¦æ€§ã€‚

## åŠ¨æ€æµ‹è¯•æ–¹æ³•

è¦æµ‹è¯•**å‘é€æ´»åŠ¨**ï¼Œå¯ä»¥ï¼š

- é’©å…¥`init(activityItems:applicationActivities:)`æ–¹æ³•ä»¥æ•è·æ­£åœ¨å…±äº«çš„é¡¹ç›®å’Œæ´»åŠ¨ã€‚
- é€šè¿‡æ‹¦æˆª`excludedActivityTypes`å±æ€§æ¥è¯†åˆ«æ’é™¤çš„æ´»åŠ¨ã€‚

å¯¹äº**æ¥æ”¶é¡¹ç›®**ï¼Œæ¶‰åŠï¼š

- ä»å…¶ä»–æ¥æºï¼ˆä¾‹å¦‚AirDropï¼Œç”µå­é‚®ä»¶ï¼‰ä¸åº”ç”¨ç¨‹åºå…±äº«æ–‡ä»¶ï¼Œä»¥è§¦å‘â€œæ‰“å¼€æ–¹å¼...â€å¯¹è¯æ¡†ã€‚
- é’©å…¥`application:openURL:options:`ç­‰åœ¨é™æ€åˆ†ææœŸé—´è¯†åˆ«çš„å…¶ä»–æ–¹æ³•ï¼Œä»¥è§‚å¯Ÿåº”ç”¨ç¨‹åºçš„å“åº”ã€‚
- ä½¿ç”¨æ ¼å¼é”™è¯¯çš„æ–‡ä»¶æˆ–æ¨¡ç³ŠæŠ€æœ¯æ¥è¯„ä¼°åº”ç”¨ç¨‹åºçš„å¥å£®æ€§ã€‚

## å‚è€ƒèµ„æ–™
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)
