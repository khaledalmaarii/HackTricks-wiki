# iOS UIActivity Sharing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

# UIActivity Sharing Simplifi√©

Depuis iOS 6, les applications tierces ont √©t√© autoris√©es √† **partager des donn√©es** telles que du texte, des URL ou des images en utilisant des m√©canismes comme AirDrop, comme d√©crit dans le [guide de communication inter-applications](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3) d'Apple. Cette fonctionnalit√© se manifeste par une _feuille d'activit√© de partage_ √† l'√©chelle du syst√®me qui appara√Æt lors de l'interaction avec le bouton "Partager".

Une √©num√©ration compl√®te de toutes les options de partage int√©gr√©es est disponible √† [UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype). Les d√©veloppeurs peuvent choisir d'exclure certaines options de partage s'ils les jugent inappropri√©es pour leur application.

## **Comment Partager des Donn√©es**

L'attention doit √™tre port√©e sur :

- La nature des donn√©es partag√©es.
- L'inclusion d'activit√©s personnalis√©es.
- L'exclusion de certains types d'activit√©s.

Le partage est facilit√© par l'instanciation d'un `UIActivityViewController`, auquel les √©l√©ments destin√©s au partage sont pass√©s. Cela est r√©alis√© en appelant :
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
Les d√©veloppeurs doivent examiner le `UIActivityViewController` pour les activit√©s et les activit√©s personnalis√©es avec lesquelles il est initialis√©, ainsi que tout `excludedActivityTypes` sp√©cifi√©.

## **Comment Recevoir des Donn√©es**

Les aspects suivants sont cruciaux lors de la r√©ception de donn√©es :

- La d√©claration de **types de documents personnalis√©s**.
- La sp√©cification des **types de documents que l'application peut ouvrir**.
- La v√©rification de l'**int√©grit√© des donn√©es re√ßues**.

Sans acc√®s au code source, on peut toujours inspecter le `Info.plist` pour des cl√©s comme `UTExportedTypeDeclarations`, `UTImportedTypeDeclarations`, et `CFBundleDocumentTypes` afin de comprendre les types de documents qu'une application peut g√©rer et d√©clarer.

Un guide succinct sur ces cl√©s est disponible sur [Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i), soulignant l'importance de d√©finir et d'importer des UTI pour une reconnaissance √† l'√©chelle du syst√®me et d'associer des types de documents avec votre application pour l'int√©gration dans la bo√Æte de dialogue "Ouvrir avec".

## Approche de Test Dynamique

Pour tester **l'envoi d'activit√©s**, on pourrait :

- S'accrocher √† la m√©thode `init(activityItems:applicationActivities:)` pour capturer les √©l√©ments et les activit√©s partag√©es.
- Identifier les activit√©s exclues en interceptant la propri√©t√© `excludedActivityTypes`.

Pour **recevoir des √©l√©ments**, cela implique :

- Partager un fichier avec l'application depuis une autre source (par exemple, AirDrop, email) qui invite √† la bo√Æte de dialogue "Ouvrir avec...".
- S'accrocher √† `application:openURL:options:` parmi d'autres m√©thodes identifi√©es lors de l'analyse statique pour observer la r√©ponse de l'application.
- Utiliser des fichiers malform√©s ou des techniques de fuzzing pour √©valuer la robustesse de l'application.

## R√©f√©rences
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
