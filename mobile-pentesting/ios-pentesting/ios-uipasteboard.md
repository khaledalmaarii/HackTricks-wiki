{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


Die Datenfreigabe innerhalb und zwischen Anwendungen auf iOS-Ger√§ten erfolgt √ºber den [`UIPasteboard`](https://developer.apple.com/documentation/uikit/uipasteboard) Mechanismus, der in zwei Hauptkategorien unterteilt ist:

- **Systemweiter allgemeiner Pasteboard**: Dieser wird verwendet, um Daten mit **beliebigen Anwendungen** zu teilen und ist so konzipiert, dass Daten √ºber Ger√§te-Neustarts und App-Deinstallationen hinweg bestehen bleiben, eine Funktion, die seit iOS 10 verf√ºgbar ist.
- **Benutzerdefinierte / benannte Pasteboards**: Diese sind speziell f√ºr die Datenfreigabe **innerhalb einer App oder mit einer anderen App**, die dieselbe Team-ID teilt, und sind nicht daf√ºr ausgelegt, √ºber die Lebensdauer des Anwendungsprozesses, der sie erstellt, hinaus zu bestehen, gem√§√ü den √Ñnderungen, die in iOS 10 eingef√ºhrt wurden.

**Sicherheits√ºberlegungen** spielen eine bedeutende Rolle bei der Nutzung von Pasteboards. Zum Beispiel:
- Es gibt keinen Mechanismus f√ºr Benutzer, um die App-Berechtigungen zum Zugriff auf das **Pasteboard** zu verwalten.
- Um das Risiko einer unbefugten Hintergrund√ºberwachung des Pasteboards zu verringern, ist der Zugriff auf den Vordergrund der Anwendung beschr√§nkt (seit iOS 9).
- Die Verwendung von persistenten benannten Pasteboards wird aus Datenschutzgr√ºnden zugunsten von gemeinsamen Containern nicht empfohlen.
- Die mit iOS 10 eingef√ºhrte **Universal Clipboard**-Funktion, die das Teilen von Inhalten √ºber Ger√§te hinweg √ºber das allgemeine Pasteboard erm√∂glicht, kann von Entwicklern verwaltet werden, um die Datenablaufzeit festzulegen und die automatische Inhalts√ºbertragung zu deaktivieren.

Es ist entscheidend, sicherzustellen, dass **sensible Informationen nicht versehentlich** im globalen Pasteboard gespeichert werden. Dar√ºber hinaus sollten Anwendungen so gestaltet sein, dass sie den Missbrauch von globalen Pasteboard-Daten f√ºr unbeabsichtigte Aktionen verhindern, und Entwickler werden ermutigt, Ma√ünahmen zu ergreifen, um das Kopieren sensibler Informationen in die Zwischenablage zu verhindern.

### Statische Analyse

F√ºr die statische Analyse suchen Sie im Quellcode oder in der Bin√§rdatei nach:
- `generalPasteboard`, um die Nutzung des **systemweiten allgemeinen Pasteboards** zu identifizieren.
- `pasteboardWithName:create:` und `pasteboardWithUniqueName` zur Erstellung von **benutzerdefinierten Pasteboards**. √úberpr√ºfen Sie, ob die Persistenz aktiviert ist, obwohl dies veraltet ist.

### Dynamische Analyse

Die dynamische Analyse umfasst das Hooking oder Tracing spezifischer Methoden:
- √úberwachen Sie `generalPasteboard` f√ºr die systemweite Nutzung.
- Verfolgen Sie `pasteboardWithName:create:` und `pasteboardWithUniqueName` f√ºr benutzerdefinierte Implementierungen.
- Beobachten Sie veraltete `setPersistent:`-Methodenaufrufe, um die Persistenzeinstellungen zu √ºberpr√ºfen.

Wichtige Details, die √ºberwacht werden sollten, sind:
- **Pasteboard-Namen** und **Inhalte** (zum Beispiel √úberpr√ºfung auf Strings, URLs, Bilder).
- **Anzahl der Elemente** und **Datentypen**, die vorhanden sind, unter Verwendung von Standard- und benutzerdefinierten Datentyppr√ºfungen.
- **Ablauf- und lokal nur-Optionen** durch √úberpr√ºfung der `setItems:options:`-Methode.

Ein Beispiel f√ºr die Nutzung eines √úberwachungstools ist **objection's pasteboard monitor**, der das generalPasteboard alle 5 Sekunden auf √Ñnderungen abfragt und die neuen Daten ausgibt.

Hier ist ein einfaches JavaScript-Skriptbeispiel, inspiriert von der Vorgehensweise von objection, um alle 5 Sekunden √Ñnderungen vom Pasteboard zu lesen und zu protokollieren:
```javascript
const UIPasteboard = ObjC.classes.UIPasteboard;
const Pasteboard = UIPasteboard.generalPasteboard();
var items = "";
var count = Pasteboard.changeCount().toString();

setInterval(function () {
const currentCount = Pasteboard.changeCount().toString();
const currentItems = Pasteboard.items().toString();

if (currentCount === count) { return; }

items = currentItems;
count = currentCount;

console.log('[* Pasteboard changed] count: ' + count +
' hasStrings: ' + Pasteboard.hasStrings().toString() +
' hasURLs: ' + Pasteboard.hasURLs().toString() +
' hasImages: ' + Pasteboard.hasImages().toString());
console.log(items);

}, 1000 * 5);
```
## References

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8)
* [https://hackmd.io/@robihamanto/owasp-robi](https://hackmd.io/@robihamanto/owasp-robi)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0073/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0073/)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
