<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


Le partage de donn√©es au sein et entre les applications sur les appareils iOS est facilit√© par le m√©canisme [`UIPasteboard`](https://developer.apple.com/documentation/uikit/uipasteboard), qui est divis√© en deux cat√©gories principales :

- **Presse-papiers g√©n√©ral √† l'√©chelle du syst√®me** : Il est utilis√© pour partager des donn√©es avec **n'importe quelle application** et est con√ßu pour persister les donn√©es √† travers les red√©marrages de l'appareil et les d√©sinstallations d'applications, une fonctionnalit√© disponible depuis iOS 10.
- **Presse-papiers personnalis√©s / nomm√©s** : Ceux-ci sont sp√©cifiquement pour le partage de donn√©es **au sein d'une application ou avec une autre application** partageant le m√™me ID d'√©quipe, et ne sont pas con√ßus pour persister au-del√† de la dur√©e de vie du processus d'application qui les cr√©e, suite aux changements introduits dans iOS 10.

Les **consid√©rations de s√©curit√©** jouent un r√¥le important lors de l'utilisation des presse-papiers. Par exemple :
- Il n'y a pas de m√©canisme pour que les utilisateurs g√®rent les autorisations d'application pour acc√©der au **presse-papiers**.
- Pour att√©nuer le risque de surveillance non autoris√©e en arri√®re-plan du presse-papiers, l'acc√®s est restreint lorsque l'application est √† l'avant-plan (depuis iOS 9).
- L'utilisation de presse-papiers nomm√©s persistants est d√©conseill√©e au profit des conteneurs partag√©s en raison de pr√©occupations en mati√®re de confidentialit√©.
- La fonctionnalit√© **Presse-papiers universel** introduite avec iOS 10, permettant le partage de contenu entre les appareils via le presse-papiers g√©n√©ral, peut √™tre g√©r√©e par les d√©veloppeurs pour d√©finir l'expiration des donn√©es et d√©sactiver le transfert automatique de contenu.

Il est crucial de s'assurer que les **informations sensibles ne sont pas stock√©es involontairement** sur le presse-papiers g√©n√©ral. De plus, les applications doivent √™tre con√ßues pour emp√™cher l'utilisation abusive des donn√©es du presse-papiers g√©n√©ral pour des actions non intentionnelles, et les d√©veloppeurs sont encourag√©s √† mettre en place des mesures pour emp√™cher la copie d'informations sensibles dans le presse-papiers.

### Analyse statique

Pour l'analyse statique, recherchez le code source ou binaire pour :
- `generalPasteboard` pour identifier l'utilisation du **presse-papiers g√©n√©ral √† l'√©chelle du syst√®me**.
- `pasteboardWithName:create:` et `pasteboardWithUniqueName` pour la cr√©ation de **presse-papiers personnalis√©s**. V√©rifiez si la persistance est activ√©e, bien que cela soit obsol√®te.

### Analyse dynamique

L'analyse dynamique implique l'accrochage ou le tra√ßage de m√©thodes sp√©cifiques :
- Surveillez `generalPasteboard` pour l'utilisation √† l'√©chelle du syst√®me.
- Tracez `pasteboardWithName:create:` et `pasteboardWithUniqueName` pour les impl√©mentations personnalis√©es.
- Observez les appels de m√©thode obsol√®tes `setPersistent:` pour v√©rifier les param√®tres de persistance.

Les d√©tails cl√©s √† surveiller comprennent :
- **Noms** et **contenus** du presse-papiers (par exemple, v√©rification des cha√Ænes, des URL, des images).
- **Nombre d'√©l√©ments** et **types de donn√©es** pr√©sents, en exploitant les v√©rifications de types de donn√©es standard et personnalis√©es.
- Options d'**expiration et de local uniquement** en inspectant la m√©thode `setItems:options:`.

Un exemple d'utilisation d'outil de surveillance est le **moniteur de presse-papiers d'objection**, qui interroge le presse-papiers g√©n√©ral toutes les 5 secondes pour les changements et affiche les nouvelles donn√©es.

Voici un exemple de script JavaScript simple, inspir√© de l'approche d'objection, pour lire et journaliser les changements du presse-papiers toutes les 5 secondes:
```javascript
const UIPasteboard = ObjC.classes.UIPasteboard;
const Pasteboard = UIPasteboard.generalPasteboard();
var items = "";
var count = Pasteboard.changeCount().toString();

setInterval(function () {
const currentCount = Pasteboard.changeCount().toString();
const currentItems = Pasteboard.items().toString();

if (currentCount === count) { return; }

items = currentItems;
count = currentCount;

console.log('[* Pasteboard changed] count: ' + count +
' hasStrings: ' + Pasteboard.hasStrings().toString() +
' hasURLs: ' + Pasteboard.hasURLs().toString() +
' hasImages: ' + Pasteboard.hasImages().toString());
console.log(items);

}, 1000 * 5);
```
## R√©f√©rences

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8)
* [https://hackmd.io/@robihamanto/owasp-robi](https://hackmd.io/@robihamanto/owasp-robi)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0073/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0073/)

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
