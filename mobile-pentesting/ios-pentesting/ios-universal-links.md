# iOSé€šç”¨é“¾æ¥


<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>


## ä»‹ç»

é€šç”¨é“¾æ¥é€šè¿‡ç›´æ¥åœ¨åº”ç”¨ä¸­æ‰“å¼€å†…å®¹ï¼Œç»•è¿‡Safarié‡å®šå‘çš„éœ€æ±‚ï¼Œä¸ºç”¨æˆ·æä¾›äº†**æ— ç¼é‡å®šå‘**ä½“éªŒã€‚è¿™äº›é“¾æ¥æ˜¯**ç‹¬ç‰¹**ä¸”å®‰å…¨çš„ï¼Œå› ä¸ºå…¶ä»–åº”ç”¨æ— æ³•å£°æ˜å®ƒä»¬ã€‚è¿™æ˜¯é€šè¿‡åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¸Šæ‰˜ç®¡`apple-app-site-association` JSONæ–‡ä»¶æ¥å®ç°çš„ï¼Œå»ºç«‹äº†ç½‘ç«™å’Œåº”ç”¨ä¹‹é—´å¯éªŒè¯çš„é“¾æ¥ã€‚åœ¨åº”ç”¨æœªå®‰è£…çš„æƒ…å†µä¸‹ï¼ŒSafariå°†æ¥ç®¡å¹¶å°†ç”¨æˆ·å¼•å¯¼åˆ°ç½‘é¡µï¼Œä¿æŒåº”ç”¨çš„å­˜åœ¨ã€‚

å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œ`apple-app-site-association`æ–‡ä»¶å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæ­ç¤º**æ•æ„Ÿè·¯å¾„**ï¼Œå¯èƒ½åŒ…æ‹¬ä¸æœªå‘å¸ƒåŠŸèƒ½ç›¸å…³çš„è·¯å¾„ã€‚

### **åˆ†æå…³è”åŸŸæƒåˆ©**

å¼€å‘äººå‘˜é€šè¿‡åœ¨Xcodeçš„Capabilitiesé€‰é¡¹å¡ä¸­é…ç½®**å…³è”åŸŸ**æˆ–æ£€æŸ¥`.entitlements`æ–‡ä»¶æ¥å¯ç”¨é€šç”¨é“¾æ¥ã€‚æ¯ä¸ªåŸŸåéƒ½ä»¥`applinks:`ä¸ºå‰ç¼€ã€‚ä¾‹å¦‚ï¼ŒTelegramçš„é…ç½®å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
```xml
<key>com.apple.developer.associated-domains</key>
<array>
<string>applinks:telegram.me</string>
<string>applinks:t.me</string>
</array>
```
### **è·å–è‹¹æœåº”ç”¨ç½‘ç«™å…³è”æ–‡ä»¶**

åº”ä»æœåŠ¡å™¨ä½¿ç”¨åœ¨æƒé™ä¸­æŒ‡å®šçš„åŸŸæ£€ç´¢`apple-app-site-association`æ–‡ä»¶ã€‚ç¡®ä¿æ–‡ä»¶å¯ä»¥é€šè¿‡HTTPSç›´æ¥è®¿é—®ï¼Œç½‘å€ä¸º`https://<domain>/apple-app-site-association`ã€‚å·¥å…·å¦‚[è‹¹æœåº”ç”¨ç½‘ç«™å…³è”ï¼ˆAASAï¼‰éªŒè¯å™¨](https://branch.io/resources/aasa-validator/)å¯ä»¥å¸®åŠ©è¿›è¡Œæ­¤è¿‡ç¨‹ã€‚

### **å¤„ç†åº”ç”¨ä¸­çš„é€šç”¨é“¾æ¥**

åº”ç”¨å¿…é¡»å®ç°ç‰¹å®šæ–¹æ³•æ¥æ­£ç¡®å¤„ç†é€šç”¨é“¾æ¥ã€‚è¦æŸ¥æ‰¾çš„ä¸»è¦æ–¹æ³•æ˜¯[`application:continueUserActivity:restorationHandler:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623072-application)ã€‚å¤„ç†çš„URLæ–¹æ¡ˆå¿…é¡»æ˜¯HTTPæˆ–HTTPSï¼Œå…¶ä»–æ–¹æ¡ˆå°†ä¸å—æ”¯æŒã€‚

#### **éªŒè¯æ•°æ®å¤„ç†æ–¹æ³•**

å½“é€šç”¨é“¾æ¥æ‰“å¼€åº”ç”¨æ—¶ï¼Œå°†ä½¿ç”¨`NSUserActivity`å¯¹è±¡å°†URLä¼ é€’ç»™åº”ç”¨ã€‚åœ¨å¤„ç†æ­¤URLä¹‹å‰ï¼Œå¿…é¡»éªŒè¯å’Œæ¸…ç†å®ƒä»¥é˜²æ­¢å®‰å…¨é£é™©ã€‚ä»¥ä¸‹æ˜¯Swiftä¸­æ¼”ç¤ºæ­¤è¿‡ç¨‹çš„ç¤ºä¾‹ï¼š
```swift
func application(_ application: UIApplication, continue userActivity: NSUserActivity,
restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool {
// Check for web browsing activity and valid URL
if userActivity.activityType == NSUserActivityTypeBrowsingWeb, let url = userActivity.webpageURL {
application.open(url, options: [:], completionHandler: nil)
}

return true
}
```
URLs åº”è¯¥è¢«ä»”ç»†è§£æå’ŒéªŒè¯ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå®ƒä»¬åŒ…å«å‚æ•°ï¼Œä»¥é˜²æ­¢æ½œåœ¨çš„æ¬ºéª—æˆ–æ ¼å¼ä¸æ­£ç¡®çš„æ•°æ®ã€‚`NSURLComponents` API å¯¹äºè¿™ä¸ªç›®çš„éå¸¸æœ‰ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```swift
func application(_ application: UIApplication,
continue userActivity: NSUserActivity,
restorationHandler: @escaping ([Any]?) -> Void) -> Bool {
guard userActivity.activityType == NSUserActivityTypeBrowsingWeb,
let incomingURL = userActivity.webpageURL,
let components = NSURLComponents(url: incomingURL, resolvingAgainstBaseURL: true),
let path = components.path,
let params = components.queryItems else {
return false
}

if let albumName = params.first(where: { $0.name == "albumname" })?.value,
let photoIndex = params.first(where: { $0.name == "index" })?.value {
// Process the URL with album name and photo index

return true

} else {
// Handle invalid or missing parameters

return false
}
}
```
é€šè¿‡**å‹¤å¥‹çš„é…ç½®å’ŒéªŒè¯**ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç¡®ä¿é€šç”¨é“¾æ¥æå‡ç”¨æˆ·ä½“éªŒçš„åŒæ—¶ä¿æŒå®‰å…¨å’Œéšç§æ ‡å‡†ã€‚




## å‚è€ƒèµ„æ–™
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0070/#static-analysis](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0070/#static-analysis)
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8)



<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
