# iOS Universal Links


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Introduction

Evrensel baÄŸlantÄ±lar, kullanÄ±cÄ±lar iÃ§in **kesintisiz bir yÃ¶nlendirme** deneyimi sunarak iÃ§eriÄŸi doÄŸrudan uygulamada aÃ§ar ve Safari yÃ¶nlendirmesi gereksinimini ortadan kaldÄ±rÄ±r. Bu baÄŸlantÄ±lar **eÅŸsiz** ve gÃ¼venlidir, Ã§Ã¼nkÃ¼ diÄŸer uygulamalar tarafÄ±ndan talep edilemezler. Bu, web sitesinin kÃ¶k dizininde bir `apple-app-site-association` JSON dosyasÄ± barÄ±ndÄ±rÄ±larak saÄŸlanÄ±r ve web sitesi ile uygulama arasÄ±nda doÄŸrulanabilir bir baÄŸlantÄ± kurulur. Uygulama yÃ¼klÃ¼ deÄŸilse, Safari devralÄ±r ve kullanÄ±cÄ±yÄ± web sayfasÄ±na yÃ¶nlendirir, uygulamanÄ±n varlÄ±ÄŸÄ±nÄ± korur.

Penetrasyon test uzmanlarÄ± iÃ§in `apple-app-site-association` dosyasÄ± Ã¶zellikle ilgi Ã§ekicidir Ã§Ã¼nkÃ¼ **hassas yollarÄ±** aÃ§Ä±ÄŸa Ã§Ä±karabilir, bu yollar henÃ¼z yayÄ±mlanmamÄ±ÅŸ Ã¶zelliklerle ilgili olabilir.

### **Ä°liÅŸkili Alanlar Yetkisini Analiz Etme**

GeliÅŸtiriciler, Xcode'un Yetenekler sekmesinde **Ä°liÅŸkili Alanlar**'Ä± yapÄ±landÄ±rarak veya `.entitlements` dosyasÄ±nÄ± inceleyerek Evrensel BaÄŸlantÄ±larÄ± etkinleÅŸtirir. Her alan `applinks:` ile baÅŸlar. Ã–rneÄŸin, Telegram'Ä±n yapÄ±landÄ±rmasÄ± ÅŸu ÅŸekilde gÃ¶rÃ¼nebilir:
```xml
<key>com.apple.developer.associated-domains</key>
<array>
<string>applinks:telegram.me</string>
<string>applinks:t.me</string>
</array>
```
Daha kapsamlÄ± bilgiler iÃ§in [arÅŸivlenmiÅŸ Apple GeliÅŸtirici DokÃ¼mantasyonu'na](https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2) baÅŸvurun.

DerlenmiÅŸ bir uygulama ile Ã§alÄ±ÅŸÄ±yorsanÄ±z, haklar [bu kÄ±lavuzda](extracting-entitlements-from-compiled-application.md) aÃ§Ä±klandÄ±ÄŸÄ± gibi Ã§Ä±karÄ±labilir.

### **Apple Uygulama Site Ä°liÅŸkilendirme DosyasÄ±nÄ± Alma**

`apple-app-site-association` dosyasÄ±, haklarda belirtilen alan adlarÄ± kullanÄ±larak sunucudan alÄ±nmalÄ±dÄ±r. DosyanÄ±n `https://<domain>/apple-app-site-association` adresinden HTTPS Ã¼zerinden eriÅŸilebilir olduÄŸundan emin olun. [Apple Uygulama Site Ä°liÅŸkilendirme (AASA) DoÄŸrulayÄ±cÄ±](https://branch.io/resources/aasa-validator/) gibi araÃ§lar bu sÃ¼reÃ§te yardÄ±mcÄ± olabilir.

### **Uygulamada Evrensel BaÄŸlantÄ±larÄ± YÃ¶netme**

Uygulama, evrensel baÄŸlantÄ±larÄ± doÄŸru bir ÅŸekilde yÃ¶netmek iÃ§in belirli yÃ¶ntemleri uygulamalÄ±dÄ±r. BakÄ±lmasÄ± gereken ana yÃ¶ntem [`application:continueUserActivity:restorationHandler:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623072-application) yÃ¶ntemidir. Ä°ÅŸlenen URL'lerin ÅŸemasÄ±nÄ±n HTTP veya HTTPS olmasÄ± kritik Ã¶neme sahiptir, diÄŸerleri desteklenmeyecektir.

#### **Veri Ä°ÅŸleyici YÃ¶ntemini DoÄŸrulama**

Bir evrensel baÄŸlantÄ± bir uygulamayÄ± aÃ§tÄ±ÄŸÄ±nda, uygulamaya URL ile birlikte bir `NSUserActivity` nesnesi iletilir. Bu URL'yi iÅŸlemeye baÅŸlamadan Ã¶nce, gÃ¼venlik risklerini Ã¶nlemek iÃ§in doÄŸrulamak ve temizlemek Ã¶nemlidir. Ä°ÅŸte sÃ¼reci gÃ¶steren bir Swift Ã¶rneÄŸi:
```swift
func application(_ application: UIApplication, continue userActivity: NSUserActivity,
restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool {
// Check for web browsing activity and valid URL
if userActivity.activityType == NSUserActivityTypeBrowsingWeb, let url = userActivity.webpageURL {
application.open(url, options: [:], completionHandler: nil)
}

return true
}
```
URLs dikkatlice ayrÄ±ÅŸtÄ±rÄ±lmalÄ± ve doÄŸrulanmalÄ±dÄ±r, Ã¶zellikle parametreler iÃ§eriyorsa, potansiyel sahtecilik veya hatalÄ± verilerden korunmak iÃ§in. AÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi, `NSURLComponents` API'si bu amaÃ§ iÃ§in faydalÄ±dÄ±r:
```swift
func application(_ application: UIApplication,
continue userActivity: NSUserActivity,
restorationHandler: @escaping ([Any]?) -> Void) -> Bool {
guard userActivity.activityType == NSUserActivityTypeBrowsingWeb,
let incomingURL = userActivity.webpageURL,
let components = NSURLComponents(url: incomingURL, resolvingAgainstBaseURL: true),
let path = components.path,
let params = components.queryItems else {
return false
}

if let albumName = params.first(where: { $0.name == "albumname" })?.value,
let photoIndex = params.first(where: { $0.name == "index" })?.value {
// Process the URL with album name and photo index

return true

} else {
// Handle invalid or missing parameters

return false
}
}
```
**Titiz yapÄ±landÄ±rma ve doÄŸrulama** sayesinde, geliÅŸtiriciler evrensel baÄŸlantÄ±larÄ±n kullanÄ±cÄ± deneyimini artÄ±rmasÄ±nÄ± saÄŸlarken gÃ¼venlik ve gizlilik standartlarÄ±nÄ± koruyabilirler.

## AraÃ§lar
* [GetUniversal.link](https://getuniversal.link/): UygulamanÄ±zÄ±n Evrensel BaÄŸlantÄ±larÄ±nÄ± ve AASA dosyasÄ±nÄ± test etmeyi ve yÃ¶netmeyi basitleÅŸtirmeye yardÄ±mcÄ± olur. AASA dosyasÄ± bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ doÄŸrulamak iÃ§in yalnÄ±zca alan adÄ±nÄ±zÄ± girin veya baÄŸlantÄ± davranÄ±ÅŸÄ±nÄ± kolayca test etmek iÃ§in Ã¶zel kontrol panelini kullanÄ±n. Bu araÃ§ ayrÄ±ca Apple'Ä±n AASA dosyanÄ±zÄ± bir sonraki ne zaman dizine alacaÄŸÄ±nÄ± belirlemenize yardÄ±mcÄ± olur.

## Referanslar
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0070/#static-analysis](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0070/#static-analysis)
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
