<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


Les liens universels permettent de **rediriger les utilisateurs directement** vers l'application sans passer par Safari pour la redirection.\
Les liens universels sont **uniques**, donc ils **ne peuvent pas Ãªtre revendiquÃ©s par d'autres applications** car ils utilisent des liens HTTP(S) standard vers le **site web oÃ¹ le propriÃ©taire a tÃ©lÃ©chargÃ© un fichier pour s'assurer que le site web et l'application sont liÃ©s**.\
Comme ces liens utilisent des schÃ©mas HTTP(S), lorsque l'**application n'est pas installÃ©e, Safari ouvrira le lien** en redirigeant les utilisateurs vers la page. Cela permet aux **applications de communiquer avec l'application mÃªme si elle n'est pas installÃ©e**.

Pour crÃ©er des liens universels, il est nÃ©cessaire de **crÃ©er un fichier JSON appelÃ© `apple-app-site-association`** avec les dÃ©tails. Ensuite, ce fichier doit Ãªtre **hÃ©bergÃ© dans le rÃ©pertoire racine de votre serveur web** (par exemple [https://google.com/apple-app-site-association](https://google.com/apple-app-site-association)).\
Pour le testeur de pÃ©nÃ©tration, ce fichier est trÃ¨s intÃ©ressant car il **dÃ©voile les chemins**. Il peut mÃªme rÃ©vÃ©ler des chemins de versions qui n'ont pas encore Ã©tÃ© publiÃ©es.

## **VÃ©rification de l'attribution des domaines associÃ©s**

Dans Xcode, allez Ã  l'onglet **Capabilities** et recherchez **Associated Domains**. Vous pouvez Ã©galement inspecter le fichier `.entitlements` en recherchant `com.apple.developer.associated-domains`. Chacun des domaines doit Ãªtre prÃ©fixÃ© par `applinks:`, comme `applinks:www.mywebsite.com`.

Voici un exemple du fichier `.entitlements` de Telegram :
```markup
    <key>com.apple.developer.associated-domains</key>
    <array>
        <string>applinks:telegram.me</string>
        <string>applinks:t.me</string>
    </array>
```
Des informations plus dÃ©taillÃ©es peuvent Ãªtre trouvÃ©es dans la [Documentation archivÃ©e des dÃ©veloppeurs Apple](https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2).

Si vous n'avez que l'application compilÃ©e, vous pouvez extraire les entitlements en suivant ce guide :

{% content-ref url="extracting-entitlements-from-compiled-application.md" %}
[extracting-entitlements-from-compiled-application.md](extracting-entitlements-from-compiled-application.md)
{% endcontent-ref %}

## RÃ©cupÃ©ration du fichier Apple App Site Association

Essayez de rÃ©cupÃ©rer le fichier `apple-app-site-association` depuis le serveur en utilisant les domaines associÃ©s que vous avez obtenus Ã  partir de l'Ã©tape prÃ©cÃ©dente. Ce fichier doit Ãªtre accessible via HTTPS, sans redirection, Ã  `https://<domain>/apple-app-site-association` ou `https://<domain>/.well-known/apple-app-site-association`.

Vous pouvez le rÃ©cupÃ©rer vous-mÃªme avec votre navigateur ou utiliser le [validateur Apple App Site Association (AASA)](https://branch.io/resources/aasa-validator/).

## VÃ©rification de la mÃ©thode de rÃ©ception de lien

Afin de recevoir des liens et de les gÃ©rer de maniÃ¨re appropriÃ©e, le dÃ©lÃ©guÃ© de l'application doit implÃ©menter [`application:continueUserActivity:restorationHandler:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623072-application). Si vous avez le projet original, essayez de rechercher cette mÃ©thode.

Veuillez noter que si l'application utilise [`openURL:options:completionHandler:`](https://developer.apple.com/documentation/uikit/uiapplication/1648685-openurl?language=objc) pour ouvrir un lien universel vers le site web de l'application, le lien ne s'ouvrira pas dans l'application. Comme l'appel provient de l'application, il ne sera pas gÃ©rÃ© comme un lien universel.

* Le schÃ©ma de `webpageURL` doit Ãªtre HTTP ou HTTPS (tout autre schÃ©ma doit gÃ©nÃ©rer une exception). La propriÃ©tÃ© d'instance [`scheme`](https://developer.apple.com/documentation/foundation/urlcomponents/1779624-scheme) de `URLComponents` / `NSURLComponents` peut Ãªtre utilisÃ©e pour vÃ©rifier cela.

## VÃ©rification de la mÃ©thode de gestion de donnÃ©es

Lorsque iOS ouvre une application en tant que rÃ©sultat d'un lien universel, l'application reÃ§oit un objet `NSUserActivity` avec une valeur `activityType` de `NSUserActivityTypeBrowsingWeb`. La propriÃ©tÃ© `webpageURL` de l'objet d'activitÃ© contient l'URL HTTP ou HTTPS que l'utilisateur accÃ¨de. L'exemple suivant en Swift vÃ©rifie exactement cela avant d'ouvrir l'URL :
```swift
func application(_ application: UIApplication, continue userActivity: NSUserActivity,
                 restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool {
    // ...
    if userActivity.activityType == NSUserActivityTypeBrowsingWeb, let url = userActivity.webpageURL {
        application.open(url, options: [:], completionHandler: nil)
    }

    return true
}
```
De plus, n'oubliez pas que si l'URL contient des paramÃ¨tres, ils ne doivent pas Ãªtre considÃ©rÃ©s comme fiables avant d'Ãªtre soigneusement nettoyÃ©s et validÃ©s (mÃªme s'ils proviennent d'un domaine de confiance). Par exemple, ils pourraient avoir Ã©tÃ© falsifiÃ©s par un attaquant ou pourraient inclure des donnÃ©es malformÃ©es. Si tel est le cas, l'ensemble de l'URL et donc la demande de lien universel doivent Ãªtre rejetÃ©s.

L'API `NSURLComponents` peut Ãªtre utilisÃ©e pour analyser et manipuler les composants de l'URL. Cela peut Ã©galement faire partie de la mÃ©thode `application:continueUserActivity:restorationHandler:` elle-mÃªme ou peut Ãªtre appelÃ© Ã  partir d'une mÃ©thode distincte. L'exemple suivant dÃ©montre cela: [example](https://developer.apple.com/documentation/uikit/core\_app/allowing\_apps\_and\_websites\_to\_link\_to\_your\_content/handling\_universal\_links#3001935).
```swift
func application(_ application: UIApplication,
                 continue userActivity: NSUserActivity,
                 restorationHandler: @escaping ([Any]?) -> Void) -> Bool {
    guard userActivity.activityType == NSUserActivityTypeBrowsingWeb,
        let incomingURL = userActivity.webpageURL,
        let components = NSURLComponents(url: incomingURL, resolvingAgainstBaseURL: true),
        let path = components.path,
        let params = components.queryItems else {
        return false
    }

    if let albumName = params.first(where: { $0.name == "albumname" })?.value,
        let photoIndex = params.first(where: { $0.name == "index" })?.value {
        // Interact with album name and photo index

        return true

    } else {
        // Handle when album and/or album name or photo index missing

        return false
    }
}
```
# RÃ©fÃ©rences

{% embed url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8" %}



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
