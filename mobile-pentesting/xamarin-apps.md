# Xamarin åº”ç”¨ç¨‹åº

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## **åŸºæœ¬ä¿¡æ¯**

Xamarin æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œä¸ºå¼€å‘äººå‘˜æä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œé™„åŠ ç»„ä»¶ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿä½¿ç”¨ .NET å’Œ C# æ¡†æ¶**åˆ›å»ºç°ä»£çš„ iOSã€Android å’Œ Windows åº”ç”¨ç¨‹åº**ã€‚

### Xamarin Android æ¶æ„&#x20;

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Xamarin æä¾›äº†å¯¹ Android.\* å’Œ Java.\* å‘½åç©ºé—´çš„ .NET ç»‘å®šã€‚Xamarin Android åº”ç”¨ç¨‹åºåœ¨ Mono æ‰§è¡Œç¯å¢ƒä¸‹è¿è¡Œï¼ŒAndroid è¿è¡Œæ—¶ï¼ˆARTï¼‰è™šæ‹Ÿæœºå¹¶è¡Œè¿è¡Œã€‚

Mono æ‰§è¡Œç¯å¢ƒé€šè¿‡æ‰˜ç®¡å¯è°ƒç”¨åŒ…è£…å™¨ï¼ˆMCWï¼‰è°ƒç”¨è¿™äº›å‘½åç©ºé—´ï¼Œå¹¶ä¸º ART æä¾› Android å¯è°ƒç”¨åŒ…è£…å™¨ï¼ˆACWï¼‰ã€‚

è¿™ä¸¤ä¸ªç¯å¢ƒéƒ½è¿è¡Œåœ¨ Linux å†…æ ¸ä¹‹ä¸Šï¼Œå¹¶è°ƒç”¨å„ç§ API ä»¥è®¿é—®ç”¨æˆ·ä»£ç ã€‚è¿™ç§å®‰æ’å…è®¸å¼€å‘äººå‘˜è®¿é—®åº•å±‚ç³»ç»Ÿã€‚

### Xamarin iOS é¡¹ç›®

Xamarin.iOS åº”ç”¨ç¨‹åºåœ¨ Mono è¿è¡Œæ—¶ç¯å¢ƒä¸‹è¿è¡Œï¼Œå¹¶ä½¿ç”¨å…¨é¢çš„ Ahead of Timeï¼ˆAOTï¼‰ç¼–è¯‘å°† C# .NET ä»£ç ç¼–è¯‘ä¸º ARM æ±‡ç¼–è¯­è¨€ã€‚

å®ƒä¸ Objective-C è¿è¡Œæ—¶ä¸€èµ·è¿è¡Œã€‚è¿è¡Œæ—¶ç¯å¢ƒè¿è¡Œåœ¨ç±» UNIX å†…æ ¸ä¹‹ä¸Šï¼Œå¹¶è°ƒç”¨å¤šä¸ª API ä»¥è®¿é—®ç”¨æˆ·ä»£ç ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè®¿é—®åº•å±‚çš„æ‰˜ç®¡æˆ–æœ¬æœºç³»ç»Ÿã€‚&#x20;

ä¸‹å›¾æè¿°äº†è¿™ç§æ¶æ„ï¼š

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### ä»€ä¹ˆæ˜¯ .Net Runtime å’Œ Mono Frameworkï¼Ÿ

**.Net æ¡†æ¶æ˜¯ä¸€ç»„ç¨‹åºé›†ã€ç±»å’Œå‘½åç©ºé—´**ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥åˆ›å»ºåº”ç”¨ç¨‹åºï¼›.Net Runtime è¿è¡Œç¼–è¯‘åçš„ä»£ç ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ‰˜ç®¡ä»£ç æ‰§è¡Œã€‚.NET Runtime æä¾›äº†å‡ ä¸ªåŠŸèƒ½ï¼Œç¡®ä¿å¹³å°ç‹¬ç«‹æ€§ï¼Œå¹¶ä¸æ—§ç‰ˆæœ¬çš„æ¡†æ¶å…¼å®¹ã€‚

**Mono Framework** äº 2005 å¹´å¼€å§‹ä½œä¸º Linuxï¼ˆXimian/SuSe/Novellï¼‰ä¸Š .NET Framework çš„å®ç°ã€‚ç”± Microsoft èµåŠ©å¹¶ç”± Xamarin é¢†å¯¼ï¼ŒMono æ˜¯åŸºäº ECMA æ ‡å‡†çš„ Common Language Runtime å’Œ C# çš„ .NET Framework çš„å¼€æºå®ç°ã€‚&#x20;



## ç”¨äº Xamarin åº”ç”¨ç¨‹åºçš„é€†å‘å·¥ç¨‹æŠ€æœ¯

### å¯¹ Xamarin ç¨‹åºé›†è¿›è¡Œåç¼–è¯‘

åç¼–è¯‘æ˜¯ä»ç¼–è¯‘ä»£ç ç”Ÿæˆæºä»£ç çš„è¿‡ç¨‹ã€‚è¦è·å–æœ‰å…³å½“å‰å†…å­˜ä¸­çš„ç¨‹åºé›†å’Œå¯æ‰§è¡Œæ–‡ä»¶çš„ä¿¡æ¯ï¼ŒWindows æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚

è¦æ‰“å¼€æ¨¡å—çª—å£ï¼Œè¯·é€‰æ‹©è°ƒè¯• > çª—å£ > æ¨¡å—ã€‚ä¸€æ—¦æ£€æµ‹åˆ°éœ€è¦åç¼–è¯‘çš„æ¨¡å—ï¼Œå³é”®å•å‡»å¹¶é€‰æ‹©â€œåç¼–è¯‘æºä»£ç åˆ°ç¬¦å·æ–‡ä»¶â€ã€‚æ­¤æ“ä½œ**æ„å»ºä¸€ä¸ªåŒ…å«åç¼–è¯‘æºä»£ç çš„ç¬¦å·æ–‡ä»¶**ï¼Œä»è€Œå…è®¸æ‚¨ç›´æ¥ä»æºä»£ç è¿›å…¥ç¬¬ä¸‰æ–¹ä»£ç ã€‚

**Visual Studio** å¯ä»¥åç¼–è¯‘æ‰˜ç®¡ä»£ç ï¼Œå³ä½¿æ²¡æœ‰ç¬¦å·ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹ä»£ç ã€æ£€æŸ¥å˜é‡å¹¶è®¾ç½®æ–­ç‚¹ã€‚è¦å°†æºä»£ç æå–åˆ°ç£ç›˜ä¸Šï¼Œè¯·å³é”®å•å‡»å¸¦æœ‰åµŒå…¥æºä»£ç çš„æ¨¡å—ï¼Œç„¶åå•å‡»â€œæå–åµŒå…¥çš„æºä»£ç â€ã€‚è¿™å°†æŠŠæºæ–‡ä»¶å¯¼å‡ºåˆ°ä¸€ä¸ªæ‚é¡¹æ–‡ä»¶å¤¹ä»¥ä¾›è¿›ä¸€æ­¥åˆ†æã€‚

### Xamarin åº”ç”¨ç¨‹åºçš„ JIT ç¼–è¯‘ä¸ AOT ç¼–è¯‘

è¿™ä¸¤ç§é€‰é¡¹ç”¨äºå°†åŸºäº C# çš„ Xamarin ä»£ç ç¼–è¯‘ä¸ºåº”ç”¨ç¨‹åºï¼Œå³**å³æ—¶ç¼–è¯‘å’Œæå‰ç¼–è¯‘**ã€‚ç¼–è¯‘æ–¹å¼ä¼šå½±å“åº”ç”¨ç¨‹åºä»£ç åœ¨ apk æˆ– ipa æ–‡ä»¶ä¸­çš„åˆ†å‘æ–¹å¼ã€‚è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹ä¸‹é¢çš„å†…å®¹ï¼š

\- **Android**ï¼šXamarin å…è®¸æ‚¨ä½¿ç”¨**JIT å’Œ AOT æ ‡å¿—åŒæ—¶è¿›è¡Œç¼–è¯‘**ã€‚è¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œä»¥è·å¾—æœ€é«˜çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå³æ··åˆ AOT æ¨¡å¼ã€‚è¯·æ³¨æ„ï¼Œå®Œå…¨ AOT æ¨¡å¼ä»…é€‚ç”¨äºä¼ä¸šè®¸å¯è¯ã€‚

\- **iOS**ï¼šåœ¨ iOS çš„æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ç§é€‰æ‹©ï¼Œå³**æå‰ç¼–è¯‘**ã€‚è¿™æ˜¯ç”±äºè‹¹æœçš„æ”¿ç­–ç¦æ­¢åœ¨è®¾å¤‡ä¸Šæ‰§è¡ŒåŠ¨æ€ç”Ÿæˆçš„ä»£ç ã€‚

{% hint style="info" %}
å¦‚æœé‡åˆ°ä¸€ä¸ªå®Œå…¨ AOT ç¼–è¯‘çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”å¼€å‘äººå‘˜å·²ç»åˆ é™¤äº† IL Assembly æ–‡ä»¶ä»¥å‡å°æ„å»ºå¤§å°ï¼Œåˆ™åå‘å·¥ç¨‹éœ€è¦é¢å¤–çš„æ­¥éª¤ï¼Œå³ä» lib æ–‡ä»¶å¤¹æˆ– `libmonodroid_bundle_app.so` æ–‡ä»¶ä¸­æå– .dll.so æ–‡ä»¶ä¸­çš„ dll æ–‡ä»¶ã€‚å¦‚æœæ˜¯æ··åˆ AOT ç¼–è¯‘çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸” IL æ–‡ä»¶ä»ç„¶ä¿ç•™åœ¨åº”ç”¨ç¨‹åºåŒ…ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œé€†å‘å·¥ç¨‹åˆ†æã€‚
{% endhint %}
## ä»APK/IPAè·å–dllæ–‡ä»¶

åªéœ€**è§£å‹apk/ipa**æ–‡ä»¶å¹¶å¤åˆ¶æ‰€æœ‰ä½äºassembliesç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

å¯¹äºAndroidçš„**APKæ–‡ä»¶ï¼Œè¿™äº›dllæ–‡ä»¶æ˜¯å‹ç¼©çš„**ï¼Œä¸èƒ½ç›´æ¥ç”¨äºåç¼–è¯‘ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›å·¥å…·æ¥**è§£å‹è¿™äº›dllæ–‡ä»¶**ï¼Œå¦‚[XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ)å’Œ[xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress)ã€‚
```
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
åœ¨iOSçš„æƒ…å†µä¸‹ï¼Œ**IPAæ–‡ä»¶ä¸­çš„dllæ–‡ä»¶å¯ä»¥ç›´æ¥åŠ è½½**åˆ°åç¼–è¯‘å™¨ä¸­ï¼ˆæ— éœ€è§£å‹ç¼©ï¼‰ã€‚

**å½“æˆ‘ä»¬åç¼–è¯‘dllæ–‡ä»¶æ—¶ï¼Œå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºä»£ç éƒ½å¯ä»¥æ‰¾åˆ°**ã€‚æ­¤å¤–ï¼ŒåŸºäºXamarin Frameworkçš„åº”ç”¨ç¨‹åºåœ¨æ‰€æœ‰å¹³å°ï¼ˆå¦‚iOSå’ŒAndroidç­‰ï¼‰çš„æ„å»ºä¸­åŒ…å«90%çš„å…¬å…±ä»£ç ã€‚

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä»ä¸Šé¢åˆ—å‡ºçš„apkä¸­å­˜åœ¨çš„dllæ–‡ä»¶çš„æˆªå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤è¿™æ˜¯ä¸€ä¸ªXamarinåº”ç”¨ç¨‹åºã€‚å®ƒåŒ…å«ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„dllæ–‡ä»¶ä»¥åŠè¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„åº“æ–‡ä»¶ï¼Œä¾‹å¦‚`Xamarin.Essentails.dll`æˆ–`Mono.Security.dll`ã€‚

{% hint style="success" %}
æœ€åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**è¿™äº›æ¨èçš„å·¥å…·**](../reversing/reversing-tools-basic-methods/#net-decompiler)æ¥è®¿é—®DLLä¸­çš„**C#ä»£ç **ã€‚
{% endhint %}

## åŠ¨æ€åˆ†æ

å°è¯•æ£€æŸ¥åº”ç”¨ç¨‹åºæ˜¯å¦æœ‰ä»»ä½•ç±»å‹çš„SSL pinningã€‚å¦‚æœæ²¡æœ‰ï¼Œä½¿ç”¨Burpä½œä¸ºç³»ç»Ÿçš„CAåº”è¯¥å¯ä»¥æ‹¦æˆªè¯·æ±‚ã€‚åœ¨è¿™é‡Œï¼ŒFridaä¸Javaæˆ–ObjCè¿è¡Œæ—¶ä¸èµ·ä½œç”¨ï¼Œä½†å¹¸è¿çš„æ˜¯æœ‰ä¸€ä¸ªå·¥å…·å¯ä»¥ç”¨äºæŒ‚é’©æ–¹æ³•ã€‚

[**Fridax**](https://github.com/NorthwaveSecurity/fridax)å…è®¸æ‚¨åœ¨Xamarinåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶å†…è½»æ¾åœ°**ä¿®æ”¹.NETäºŒè¿›åˆ¶æ–‡ä»¶**ã€‚é™æ€åˆ†æå°†å¸®åŠ©æ‚¨è¯†åˆ«åº”ç”¨ç¨‹åºä¸­å­˜åœ¨çš„ä¸åŒæ–¹æ³•ï¼Œç¨åå¯ä»¥ä½¿ç”¨Fridaxå¯¹å…¶è¿›è¡ŒåŠ¨æ€åˆ†æã€‚ä»¥ä¸‹æ˜¯ä¸€äº›Fridaè„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»•è¿‡rootæ£€æµ‹æˆ–SSL pinningï¼š

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)

## å‚è€ƒèµ„æ–™

* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šå—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTrickså—ï¼Ÿè¯·æŸ¥çœ‹[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
