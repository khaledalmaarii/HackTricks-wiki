# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a summary of the blog post [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **åŸºæœ¬æƒ…å ±**

Xamarinã¯ã€é–‹ç™ºè€…ãŒ.NETãŠã‚ˆã³C#ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦**iOSã€Androidã€Windowsç”¨ã®ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰**ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸ**ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **ã§ã™ã€‚ã“ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯ã€åŠ¹ç‡çš„ã«ç¾ä»£çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®å¤šæ•°ã®ãƒ„ãƒ¼ãƒ«ã¨æ‹¡å¼µæ©Ÿèƒ½ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

### Xamarinã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **Android**ã®å ´åˆã€Xamarinã¯.NETãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä»‹ã—ã¦AndroidãŠã‚ˆã³Javaåå‰ç©ºé–“ã¨çµ±åˆã•ã‚Œã€Android Runtime (ART)ã¨ã¨ã‚‚ã«Monoå®Ÿè¡Œç’°å¢ƒå†…ã§å‹•ä½œã—ã¾ã™ã€‚Managed Callable Wrappers (MCW)ã¨Android Callable Wrappers (ACW)ã¯ã€Monoã¨ARTé–“ã®é€šä¿¡ã‚’ä¿ƒé€²ã—ã€ã©ã¡ã‚‰ã‚‚Linuxã‚«ãƒ¼ãƒãƒ«ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
- **iOS**ã®å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Monoãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ä¸‹ã§å®Ÿè¡Œã•ã‚Œã€C# .NETã‚³ãƒ¼ãƒ‰ã‚’ARMã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«å¤‰æ›ã™ã‚‹ãŸã‚ã«å®Œå…¨ãªAhead of Time (AOT)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€UNIXãƒ©ã‚¤ã‚¯ãªã‚«ãƒ¼ãƒãƒ«ä¸Šã®Objective-C Runtimeã¨ã¨ã‚‚ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

### .NETãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¨Monoãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

**.NETãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**ã«ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã®ãŸã‚ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ã‚¯ãƒ©ã‚¹ã€ãŠã‚ˆã³åå‰ç©ºé–“ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€.NETãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ç‹¬ç«‹æ€§ã¨å¾Œæ–¹äº’æ›æ€§ã‚’æä¾›ã—ã¾ã™ã€‚**Monoãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**ã¯ã€2005å¹´ã«Linuxå‘ã‘ã«.NETã‚’æ‹¡å¼µã™ã‚‹ãŸã‚ã«é–‹å§‹ã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ç‰ˆã®.NETãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€ç¾åœ¨ã¯Microsoftã«ã‚ˆã£ã¦ã‚µãƒãƒ¼ãƒˆã•ã‚Œã€Xamarinã«ã‚ˆã£ã¦ä¸»å°ã•ã‚Œã¦ã„ã¾ã™ã€‚

### Xamarinã‚¢ãƒ—ãƒªã®é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

#### Xamarinã‚¢ã‚»ãƒ³ãƒ–ãƒªã®é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æˆ»ã™ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚Windowsã§ã¯ã€Visual Studioã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç‰¹å®šã§ãã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ã‚³ãƒ¼ãƒ‰ã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã¨åˆ†æã®ãŸã‚ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æŠ½å‡ºã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

#### JITã¨AOTã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

- **Android**ã¯ã€Just-In-Time (JIT)ãŠã‚ˆã³Ahead-Of-Time (AOT)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€æœ€é©ãªå®Ÿè¡Œé€Ÿåº¦ã®ãŸã‚ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰AOTãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚å®Œå…¨ãªAOTã¯ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ©ã‚¤ã‚»ãƒ³ã‚¹å°‚ç”¨ã§ã™ã€‚
- **iOS**ã¯ã€Appleã®å‹•çš„ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã«é–¢ã™ã‚‹åˆ¶é™ã®ãŸã‚ã€AOTã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### APK/IPAã‹ã‚‰ã®dllãƒ•ã‚¡ã‚¤ãƒ«ã®æŠ½å‡º

APK/IPAå†…ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¢ç´¢ã—ã¾ã™ã€‚Androidã®å ´åˆã€[XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ)ã‚„[xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦dllãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã§ãã¾ã™ã€‚
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Androidã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ–ãƒ­ãƒ–ã«ã¯ã€[pyxamstore](https://github.com/jakev/pyxamstore)ã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯ã§ãã¾ã™ã€‚
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOSã®dllãƒ•ã‚¡ã‚¤ãƒ«ã¯é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ãŸã‚ã«å®¹æ˜“ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®é‡è¦ãªéƒ¨åˆ†ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã€ç•°ãªã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ é–“ã§å…±é€šã®ãƒ™ãƒ¼ã‚¹ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

### å‹•çš„åˆ†æ

å‹•çš„åˆ†æã¯ã€SSLãƒ”ãƒ³ãƒ‹ãƒ³ã‚°ã®ãƒã‚§ãƒƒã‚¯ã¨ã€Xamarinã‚¢ãƒ—ãƒªã®.NETãƒã‚¤ãƒŠãƒªã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¿®æ­£ã®ãŸã‚ã«[Fridax](https://github.com/NorthwaveSecurity/fridax)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’å«ã¿ã¾ã™ã€‚Fridaã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ãƒ«ãƒ¼ãƒˆæ¤œå‡ºã‚„SSLãƒ”ãƒ³ãƒ‹ãƒ³ã‚°ã‚’å›é¿ã™ã‚‹ãŸã‚ã«åˆ©ç”¨å¯èƒ½ã§ã€åˆ†æèƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚

ä»–ã®èˆˆå‘³æ·±ã„Fridaã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼š

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## ã•ã‚‰ãªã‚‹æƒ…å ±
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
