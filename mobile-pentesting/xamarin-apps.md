# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a summary of the blog post [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Osnovne informacije**

Xamarin je **platforma otvorenog koda** dizajnirana za programere da **prave aplikacije za iOS, Android i Windows** koriste캖i .NET i C# okvire. Ova platforma nudi pristup brojnim alatima i ekstenzijama za efikasno kreiranje modernih aplikacija.

### Arhitektura Xamarina

- Za **Android**, Xamarin se integri코e sa Android i Java imenskim prostorima putem .NET veza, rade캖i unutar Mono izvr코nog okru쬰nja zajedno sa Android Runtime (ART). Managed Callable Wrappers (MCW) i Android Callable Wrappers (ACW) olak코avaju komunikaciju izme캠u Mono i ART, koji su oba izgra캠ena na Linux kernelu.
- Za **iOS**, aplikacije se izvr코avaju pod Mono runtime-om, koriste캖i potpunu Ahead of Time (AOT) kompilaciju za konverziju C# .NET koda u ARM asembler jezik. Ovaj proces se odvija zajedno sa Objective-C Runtime na UNIX-sli캜nom kernelu.

### .NET Runtime i Mono Framework

**.NET framework** uklju캜uje asambleje, klase i imenske prostore za razvoj aplikacija, pri 캜emu .NET Runtime upravlja izvr코enjem koda. Pru쬬 nezavisnost od platforme i unazad kompatibilnost. **Mono Framework** je verzija .NET framework-a otvorenog koda, pokrenuta 2005. godine kako bi se pro코irio .NET na Linux, sada podr쬬na od strane Microsoft-a i vo캠ena od strane Xamarina.

### Reverzno in쬰njerstvo Xamarin aplikacija

#### Decompilacija Xamarin asambleja

Decompilacija transformi코e kompajlirani kod nazad u izvorni kod. U Windows-u, prozor Moduli u Visual Studio-u mo쬰 identifikovati module za decompilaciju, omogu캖avaju캖i direktan pristup kodu tre캖ih strana i ekstrakciju izvornog koda za analizu.

#### JIT vs AOT kompilacija

- **Android** podr쬬va Just-In-Time (JIT) i Ahead-Of-Time (AOT) kompilaciju, sa hibridnim AOT re쬴mom za optimalnu brzinu izvr코enja. Potpuna AOT je ekskluzivna za Enterprise licence.
- **iOS** koristi isklju캜ivo AOT kompilaciju zbog Apple-ovih ograni캜enja na dinami캜ko izvr코avanje koda.

### Ekstrakcija dll fajlova iz APK/IPA

Da biste pristupili asamblejama u APK/IPA, raspakujte datoteku i istra쬴te direktorijum asambleja. Za Android, alati poput [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) i [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) mogu dekompresovati dll fajlove.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Za assembly blobove u Androidu, [pyxamstore](https://github.com/jakev/pyxamstore) mo쬰 da ih raspakuje.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOS dll datoteke su lako dostupne za dekompilaciju, otkrivaju캖i zna캜ajne delove koda aplikacije, koji 캜esto dele zajedni캜ku osnovu na razli캜itim platformama.

### Dinami캜ka analiza

Dinami캜ka analiza uklju캜uje proveru SSL pinovanja i kori코캖enje alata kao 코to je [Fridax](https://github.com/NorthwaveSecurity/fridax) za runtime modifikacije .NET binarnih datoteka u Xamarin aplikacijama. Frida skripte su dostupne za zaobila쬰nje detekcije root-a ili SSL pinovanja, pobolj코avaju캖i analiti캜ke mogu캖nosti.

Druge zanimljive Frida skripte:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## Dodatne informacije
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
