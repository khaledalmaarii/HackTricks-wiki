# Applications Xamarin

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

Ceci est un r√©sum√© de l'article de blog [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Informations de base**

Xamarin est une **plateforme open-source** con√ßue pour que les d√©veloppeurs **cr√©ent des applications pour iOS, Android et Windows** en utilisant les frameworks .NET et C#. Cette plateforme offre un acc√®s √† de nombreux outils et extensions pour cr√©er des applications modernes de mani√®re efficace.

### Architecture de Xamarin

- Pour **Android**, Xamarin s'int√®gre avec les espaces de noms Android et Java via des liaisons .NET, fonctionnant dans l'environnement d'ex√©cution Mono aux c√¥t√©s de l'Android Runtime (ART). Les Managed Callable Wrappers (MCW) et les Android Callable Wrappers (ACW) facilitent la communication entre Mono et ART, tous deux bas√©s sur le noyau Linux.
- Pour **iOS**, les applications s'ex√©cutent sous l'environnement d'ex√©cution Mono, utilisant une compilation compl√®te Ahead of Time (AOT) pour convertir le code C# .NET en langage d'assemblage ARM. Ce processus fonctionne aux c√¥t√©s de l'Objective-C Runtime sur un noyau de type UNIX.

### Environnement d'ex√©cution .NET et Framework Mono

Le **framework .NET** comprend des assemblies, des classes et des espaces de noms pour le d√©veloppement d'applications, avec l'environnement d'ex√©cution .NET g√©rant l'ex√©cution du code. Il offre une ind√©pendance de la plateforme et une compatibilit√© ascendante. Le **Framework Mono** est une version open-source du framework .NET, initi√©e en 2005 pour √©tendre .NET √† Linux, maintenant soutenue par Microsoft et dirig√©e par Xamarin.

### Ing√©nierie inverse des applications Xamarin

#### D√©compilation des assemblies Xamarin

La d√©compilation transforme le code compil√© en code source. Sous Windows, la fen√™tre Modules dans Visual Studio peut identifier les modules pour la d√©compilation, permettant un acc√®s direct au code tiers et l'extraction du code source pour analyse.

#### Compilation JIT vs AOT

- **Android** prend en charge la compilation Just-In-Time (JIT) et Ahead-Of-Time (AOT), avec un mode hybride AOT pour une vitesse d'ex√©cution optimale. La compilation compl√®te AOT est exclusive aux licences Enterprise.
- **iOS** utilise uniquement la compilation AOT en raison des restrictions d'Apple sur l'ex√©cution de code dynamique.

### Extraction des fichiers dll √† partir d'APK/IPA

Pour acc√©der aux assemblies dans un APK/IPA, d√©compressez le fichier et explorez le r√©pertoire des assemblies. Pour Android, des outils comme [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) et [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) peuvent d√©compresser les fichiers dll.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Pour les blobs d'assemblage dans Android, [pyxamstore](https://github.com/jakev/pyxamstore) peut les d√©compresser.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
Les fichiers dll iOS sont facilement accessibles pour la d√©compilation, r√©v√©lant des portions significatives du code de l'application, qui partagent souvent une base commune √† travers diff√©rentes plateformes.

### Analyse Dynamique

L'analyse dynamique implique de v√©rifier le SSL pinning et d'utiliser des outils comme [Fridax](https://github.com/NorthwaveSecurity/fridax) pour les modifications en temps r√©el du binaire .NET dans les applications Xamarin. Des scripts Frida sont disponibles pour contourner la d√©tection de root ou le SSL pinning, am√©liorant ainsi les capacit√©s d'analyse.

D'autres scripts Frida int√©ressants :

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)

## Informations suppl√©mentaires
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
