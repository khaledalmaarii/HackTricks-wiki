# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a summary of the blog post [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Basic Information**

Î¤Î¿ Xamarin ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ± Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±** ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î· Î³Î¹Î± Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ ÏÏƒÏ„Îµ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î³Î¹Î± iOS, Android ÎºÎ±Î¹ Windows** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î± Ï€Î»Î±Î¯ÏƒÎ¹Î± .NET ÎºÎ±Î¹ C#. Î‘Ï…Ï„Î® Î· Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï€Î¿Î»Ï…Î¬ÏÎ¹Î¸Î¼Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÎºÎ±Î¹ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÏƒÏÎ³Ï‡ÏÎ¿Î½Ï‰Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ Î¼Îµ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±.

### Xamarin's Architecture

- Î“Î¹Î± **Android**, Ï„Î¿ Xamarin ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÏ„Î±Î¹ Î¼Îµ Ï„Î± namespaces Android ÎºÎ±Î¹ Java Î¼Î­ÏƒÏ‰ Ï„Ï‰Î½ .NET bindings, Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÏÎ½Ï„Î±Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Mono Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¿ Android Runtime (ART). ÎŸÎ¹ Managed Callable Wrappers (MCW) ÎºÎ±Î¹ Î¿Î¹ Android Callable Wrappers (ACW) Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½Î¿Ï…Î½ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Mono ÎºÎ±Î¹ ART, ÎºÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ ÎµÎ¯Î½Î±Î¹ Ï‡Ï„Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿Î½ Ï€Ï…ÏÎ®Î½Î± Linux.
- Î“Î¹Î± **iOS**, Î¿Î¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Ï…Ï€ÏŒ Ï„Î¿ runtime Mono, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï€Î»Î®ÏÎ· Ahead of Time (AOT) Î¼ÎµÏ„Î±Î³Î»ÏÏ„Ï„Î¹ÏƒÎ· Î³Î¹Î± Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± C# .NET ÏƒÎµ Î³Î»ÏÏƒÏƒÎ± ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ ARM. Î‘Ï…Ï„Î® Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Ï€Î±ÏÎ¬Î»Î»Î·Î»Î± Î¼Îµ Ï„Î¿ Objective-C Runtime ÏƒÎµ Î­Î½Î±Î½ Ï€Ï…ÏÎ®Î½Î± Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ UNIX.

### .NET Runtime and Mono Framework

Î¤Î¿ **.NET framework** Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ assemblies, ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ namespaces Î³Î¹Î± Ï„Î·Î½ Î±Î½Î¬Ï€Ï„Ï…Î¾Î· ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½, Î¼Îµ Ï„Î¿ .NET Runtime Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±. Î ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Î±Î½ÎµÎ¾Î±ÏÏ„Î·ÏƒÎ¯Î± Î±Ï€ÏŒ Ï„Î·Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± ÎºÎ±Î¹ Î¿Ï€Î¹ÏƒÎ¸Î¿Î´ÏÎ¿Î¼Î¹ÎºÎ® ÏƒÏ…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î±. Î¤Î¿ **Mono Framework** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ± Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… .NET framework, Ï€Î¿Ï… Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ Ï„Î¿ 2005 Î³Î¹Î± Î½Î± ÎµÏ€ÎµÎºÏ„ÎµÎ¯Î½ÎµÎ¹ Ï„Î¿ .NET ÏƒÏ„Î¿ Linux, Ï„ÏÏÎ± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î¿ Î±Ï€ÏŒ Ï„Î· Microsoft ÎºÎ±Î¹ ÎºÎ±Î¸Î¿Î´Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Î±Ï€ÏŒ Ï„Î¿ Xamarin.

### Reverse Engineering Xamarin Apps

#### Decompilation of Xamarin Assemblies

Î— Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ· Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¿Î½ Î¼ÎµÏ„Î±Î³Î»Ï‰Ï„Ï„Î¹ÏƒÎ¼Î­Î½Î¿ ÎºÏÎ´Î¹ÎºÎ± Ï€Î¯ÏƒÏ‰ ÏƒÎµ Ï€Î·Î³Î±Î¯Î¿ ÎºÏÎ´Î¹ÎºÎ±. Î£Ï„Î± Windows, Ï„Î¿ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ Modules ÏƒÏ„Î¿ Visual Studio Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹ modules Î³Î¹Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Î¬Î¼ÎµÏƒÎ· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„ÏÎ¯Ï„Ï‰Î½ ÎºÎ±Î¹ ÎµÎ¾Î±Î³Ï‰Î³Î® Ï€Î·Î³Î±Î¯Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Î³Î¹Î± Î±Î½Î¬Î»Ï…ÏƒÎ·.

#### JIT vs AOT Compilation

- **Android** Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Just-In-Time (JIT) ÎºÎ±Î¹ Ahead-Of-Time (AOT) Î¼ÎµÏ„Î±Î³Î»ÏÏ„Ï„Î¹ÏƒÎ·, Î¼Îµ Î¼Î¹Î± Ï…Î²ÏÎ¹Î´Î¹ÎºÎ® AOT Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Î³Î¹Î± Î²Î­Î»Ï„Î¹ÏƒÏ„Î· Ï„Î±Ï‡ÏÏ„Î·Ï„Î± ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚. Î— Ï€Î»Î®ÏÎ·Ï‚ AOT ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ® Î³Î¹Î± Î¬Î´ÎµÎ¹ÎµÏ‚ Enterprise.
- **iOS** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ AOT Î¼ÎµÏ„Î±Î³Î»ÏÏ„Ï„Î¹ÏƒÎ· Î»ÏŒÎ³Ï‰ Ï„Ï‰Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏÎ½ Ï„Î·Ï‚ Apple ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î´Ï…Î½Î±Î¼Î¹ÎºÎ¿Ï ÎºÏÎ´Î¹ÎºÎ±.

### Extracting dll Files from APK/IPA

Î“Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± assemblies ÏƒÎµ Î­Î½Î± APK/IPA, Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÏ„Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ ÎµÎ¾ÎµÏÎµÏ…Î½Î®ÏƒÏ„Îµ Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ assemblies. Î“Î¹Î± Ï„Î¿ Android, ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) ÎºÎ±Î¹ Ï„Î¿ [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÎ¿Ï…Î½ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± dll.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Î“Î¹Î± Ï„Î± assembly blobs ÏƒÏ„Î¿ Android, Ï„Î¿ [pyxamstore](https://github.com/jakev/pyxamstore) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÎµÎ¹.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOS dll Î±ÏÏ‡ÎµÎ¯Î± ÎµÎ¯Î½Î±Î¹ Î¬Î¼ÎµÏƒÎ± Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î± Î³Î¹Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·, Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„Î¿Î½Ï„Î±Ï‚ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Ï„Î¼Î®Î¼Î±Ï„Î± Ï„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚, Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ ÏƒÏ…Ï‡Î½Î¬ Î¼Î¿Î¹ÏÎ¬Î¶ÎµÏ„Î±Î¹ Î¼Î¹Î± ÎºÎ¿Î¹Î½Î® Î²Î¬ÏƒÎ· ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚.

### Î”Ï…Î½Î±Î¼Î¹ÎºÎ® Î‘Î½Î¬Î»Ï…ÏƒÎ·

Î— Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ· Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± SSL pinning ÎºÎ±Î¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [Fridax](https://github.com/NorthwaveSecurity/fridax) Î³Î¹Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ ÏƒÎµ Ï‡ÏÏŒÎ½Î¿ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Ï„Î¿Ï… .NET Î´Ï…Î±Î´Î¹ÎºÎ¿Ï ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Xamarin. Î¤Î± ÏƒÎµÎ½Î¬ÏÎ¹Î± Frida ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î½ Ï„Î·Î½ Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· root Î® Ï„Î¿ SSL pinning, ÎµÎ½Î¹ÏƒÏ‡ÏÎ¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚.

Î†Î»Î»Î± ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î± ÏƒÎµÎ½Î¬ÏÎ¹Î± Frida:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## Î ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
