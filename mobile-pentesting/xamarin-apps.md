# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a summary of the blog post [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **ê¸°ë³¸ ì •ë³´**

Xamarinì€ ê°œë°œìê°€ .NET ë° C# í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ **iOS, Android ë° Windowsìš© ì•±ì„ êµ¬ì¶•**í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ëœ **ì˜¤í”ˆ ì†ŒìŠ¤ í”Œë«í¼**ì…ë‹ˆë‹¤. ì´ í”Œë«í¼ì€ í˜„ëŒ€ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•œ ìˆ˜ë§ì€ ë„êµ¬ì™€ í™•ì¥ ê¸°ëŠ¥ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œê³µí•©ë‹ˆë‹¤.

### Xamarinì˜ ì•„í‚¤í…ì²˜

- **Android**ì˜ ê²½ìš°, Xamarinì€ .NET ë°”ì¸ë”©ì„ í†µí•´ Android ë° Java ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ í†µí•©ë˜ì–´ Mono ì‹¤í–‰ í™˜ê²½ ë‚´ì—ì„œ Android Runtime (ART)ì™€ í•¨ê»˜ ì‘ë™í•©ë‹ˆë‹¤. Managed Callable Wrappers (MCW)ì™€ Android Callable Wrappers (ACW)ëŠ” Monoì™€ ART ê°„ì˜ í†µì‹ ì„ ìš©ì´í•˜ê²Œ í•˜ë©°, ë‘ ê°€ì§€ ëª¨ë‘ Linux ì»¤ë„ì„ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤.
- **iOS**ì˜ ê²½ìš°, ì• í”Œë¦¬ì¼€ì´ì…˜ì€ Mono ëŸ°íƒ€ì„ì—ì„œ ì‹¤í–‰ë˜ë©°, C# .NET ì½”ë“œë¥¼ ARM ì–´ì…ˆë¸”ë¦¬ ì–¸ì–´ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ì „ì²´ Ahead of Time (AOT) ì»´íŒŒì¼ì„ í™œìš©í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ UNIXì™€ ìœ ì‚¬í•œ ì»¤ë„ì—ì„œ Objective-C Runtimeê³¼ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤.

### .NET ëŸ°íƒ€ì„ ë° Mono í”„ë ˆì„ì›Œí¬

**.NET í”„ë ˆì„ì›Œí¬**ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ ì–´ì…ˆë¸”ë¦¬, í´ë˜ìŠ¤ ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ í¬í•¨í•˜ë©°, .NET ëŸ°íƒ€ì„ì€ ì½”ë“œ ì‹¤í–‰ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. í”Œë«í¼ ë…ë¦½ì„±ê³¼ ì´ì „ ë²„ì „ê³¼ì˜ í˜¸í™˜ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. **Mono í”„ë ˆì„ì›Œí¬**ëŠ” 2005ë…„ì— ì‹œì‘ëœ .NET í”„ë ˆì„ì›Œí¬ì˜ ì˜¤í”ˆ ì†ŒìŠ¤ ë²„ì „ìœ¼ë¡œ, Linuxì— .NETì„ í™•ì¥í•˜ê¸° ìœ„í•´ ì‹œì‘ë˜ì—ˆìœ¼ë©°, í˜„ì¬ Microsoftì˜ ì§€ì›ì„ ë°›ê³  Xamarinì´ ì£¼ë„í•˜ê³  ìˆìŠµë‹ˆë‹¤.

### Xamarin ì•±ì˜ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§

#### Xamarin ì–´ì…ˆë¸”ë¦¬ì˜ ë””ì»´íŒŒì¼

ë””ì»´íŒŒì¼ì€ ì»´íŒŒì¼ëœ ì½”ë“œë¥¼ ë‹¤ì‹œ ì†ŒìŠ¤ ì½”ë“œë¡œ ë³€í™˜í•©ë‹ˆë‹¤. Windowsì—ì„œëŠ” Visual Studioì˜ ëª¨ë“ˆ ì°½ì—ì„œ ë””ì»´íŒŒì¼ì„ ìœ„í•œ ëª¨ë“ˆì„ ì‹ë³„í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ íƒ€ì‚¬ ì½”ë“œì— ì§ì ‘ ì ‘ê·¼í•˜ê³  ë¶„ì„ì„ ìœ„í•œ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### JIT vs AOT ì»´íŒŒì¼

- **Android**ëŠ” Just-In-Time (JIT) ë° Ahead-Of-Time (AOT) ì»´íŒŒì¼ì„ ì§€ì›í•˜ë©°, ìµœì ì˜ ì‹¤í–‰ ì†ë„ë¥¼ ìœ„í•œ Hybrid AOT ëª¨ë“œê°€ ìˆìŠµë‹ˆë‹¤. ì „ì²´ AOTëŠ” Enterprise ë¼ì´ì„¼ìŠ¤ì—ë§Œ ë…ì ì ì…ë‹ˆë‹¤.
- **iOS**ëŠ” Appleì˜ ë™ì  ì½”ë“œ ì‹¤í–‰ ì œí•œìœ¼ë¡œ ì¸í•´ ì˜¤ì§ AOT ì»´íŒŒì¼ë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### APK/IPAì—ì„œ dll íŒŒì¼ ì¶”ì¶œ

APK/IPAì˜ ì–´ì…ˆë¸”ë¦¬ì— ì ‘ê·¼í•˜ë ¤ë©´ íŒŒì¼ì„ ì••ì¶• í•´ì œí•˜ê³  ì–´ì…ˆë¸”ë¦¬ ë””ë ‰í† ë¦¬ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤. Androidì˜ ê²½ìš°, [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) ë° [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress)ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ dll íŒŒì¼ì„ ì••ì¶• í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Androidì˜ assembly blobsì— ëŒ€í•´, [pyxamstore](https://github.com/jakev/pyxamstore)ëŠ” ì´ë¥¼ ì••ì¶• í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOS dll íŒŒì¼ì€ ë””ì»´íŒŒì¼ì„ ìœ„í•´ ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì˜ ìƒë‹¹ ë¶€ë¶„ì„ ë“œëŸ¬ë‚´ë©°, ì¢…ì¢… ë‹¤ì–‘í•œ í”Œë«í¼ ê°„ì— ê³µí†µ ê¸°ë°˜ì„ ê³µìœ í•©ë‹ˆë‹¤.

### ë™ì  ë¶„ì„

ë™ì  ë¶„ì„ì€ SSL í•€ë‹ì„ í™•ì¸í•˜ê³  [Fridax](https://github.com/NorthwaveSecurity/fridax)ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ Xamarin ì•±ì˜ .NET ë°”ì´ë„ˆë¦¬ì— ëŒ€í•œ ëŸ°íƒ€ì„ ìˆ˜ì •ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. Frida ìŠ¤í¬ë¦½íŠ¸ëŠ” ë£¨íŠ¸ íƒì§€ ë˜ëŠ” SSL í•€ë‹ì„ ìš°íšŒí•˜ëŠ” ë° ì‚¬ìš© ê°€ëŠ¥í•˜ì—¬ ë¶„ì„ ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

ê¸°íƒ€ í¥ë¯¸ë¡œìš´ Frida ìŠ¤í¬ë¦½íŠ¸:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## ì¶”ê°€ ì •ë³´
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
