# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

This is a summary of the blog post [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Podstawowe informacje**

Xamarin to **platforma open-source** zaprojektowana dla programist贸w do **tworzenia aplikacji na iOS, Android i Windows** przy u偶yciu framework贸w .NET i C#. Ta platforma oferuje dostp do licznych narzdzi i rozszerze, aby efektywnie tworzy nowoczesne aplikacje.

### Architektura Xamarin

- Dla **Androida**, Xamarin integruje si z przestrzeniami nazw Android i Java poprzez powizania .NET, dziaajc w rodowisku wykonawczym Mono obok Android Runtime (ART). Managed Callable Wrappers (MCW) i Android Callable Wrappers (ACW) uatwiaj komunikacj midzy Mono a ART, kt贸re s zbudowane na jdrze Linuxa.
- Dla **iOS**, aplikacje dziaaj pod runtime Mono, wykorzystujc pen kompilacj Ahead of Time (AOT) do konwersji kodu C# .NET na jzyk asemblera ARM. Proces ten dziaa obok Objective-C Runtime na jdrze podobnym do UNIX.

### Runtime .NET i framework Mono

**Framework .NET** obejmuje zestawy, klasy i przestrzenie nazw do rozwoju aplikacji, a Runtime .NET zarzdza wykonaniem kodu. Oferuje niezale偶no platformy i zgodno wsteczn. **Framework Mono** to wersja open-source frameworka .NET, rozpoczta w 2005 roku, aby rozszerzy .NET na Linuxa, obecnie wspierana przez Microsoft i kierowana przez Xamarin.

### In偶ynieria wsteczna aplikacji Xamarin

#### Dekompilacja zestaw贸w Xamarin

Dekompilacja przeksztaca skompilowany kod z powrotem w kod 藕r贸dowy. W systemie Windows okno Moduy w Visual Studio mo偶e identyfikowa moduy do dekompilacji, umo偶liwiajc bezporedni dostp do kodu stron trzecich i ekstrakcj kodu 藕r贸dowego do analizy.

#### Kompilacja JIT vs AOT

- **Android** wspiera kompilacj Just-In-Time (JIT) oraz Ahead-Of-Time (AOT), z hybrydowym trybem AOT dla optymalnej prdkoci wykonania. Pena AOT jest zarezerwowana dla licencji Enterprise.
- **iOS** stosuje wycznie kompilacj AOT z powodu ogranicze Apple dotyczcych dynamicznego wykonywania kodu.

### Ekstrakcja plik贸w dll z APK/IPA

Aby uzyska dostp do zestaw贸w w pliku APK/IPA, rozpakuj plik i przeszukaj katalog zestaw贸w. Dla Androida narzdzia takie jak [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) i [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) mog dekompresowa pliki dll.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Dla blob贸w assembly w Androidzie, [pyxamstore](https://github.com/jakev/pyxamstore) mo偶e je rozpakowa.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
Pliki dll iOS s atwo dostpne do dekompilacji, ujawniajc znaczn cz kodu aplikacji, kt贸ry czsto dzieli wsp贸ln baz na r贸偶nych platformach.

### Analiza dynamiczna

Analiza dynamiczna polega na sprawdzaniu SSL pinning i u偶ywaniu narzdzi takich jak [Fridax](https://github.com/NorthwaveSecurity/fridax) do modyfikacji binarnych .NET w aplikacjach Xamarin w czasie rzeczywistym. Skrypty Frida s dostpne, aby obej wykrywanie roota lub SSL pinning, co zwiksza mo偶liwoci analizy.

Inne interesujce skrypty Frida:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)

## Dalsze informacje
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
