# Memcache Commands

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)</strong>ì—ì„œ <strong>AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong>!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- **í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œë¡œ PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Commands Cheat-Sheet

**ì¶œì²˜** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

ì§€ì›ë˜ëŠ” ëª…ë ¹ì–´(ê³µì‹ ë° ë¹„ê³µì‹)ëŠ” [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt) ë¬¸ì„œì— ë¬¸ì„œí™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì•ˆíƒ€ê¹ê²Œë„ êµ¬ë¬¸ ì„¤ëª…ì´ ì‹¤ì œë¡œ ëª…í™•í•˜ì§€ ì•Šìœ¼ë©° ê¸°ì¡´ ëª…ë ¹ì–´ë¥¼ ë‚˜ì—´í•˜ëŠ” ê°„ë‹¨í•œ ë„ì›€ë§ ëª…ë ¹ì´ í›¨ì”¬ ë‚˜ì„ ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒì€ [ì†ŒìŠ¤](https://github.com/memcached/memcached)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´ ê°œìš”ì…ë‹ˆë‹¤(2016ë…„ 8ì›” 19ì¼ ê¸°ì¤€):

| ëª…ë ¹ì–´               | ì„¤ëª…                                                     | ì˜ˆì‹œ                                                                                                                                                                                                                                     |
| --------------------- | ------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | ê°’ì„ ì½ìŒ                                                | `get mykey`                                                                                                                                                                                                                                 |
| set                   | í‚¤ë¥¼ ë¬´ì¡°ê±´ ì„¤ì •                                        | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size</code><br><br>&#x3C;p>Unix CLI ë„êµ¬ë¥¼ ì‚¬ìš©í•  ë•Œ \r\nì„ ì¤„ ë°”ê¿ˆìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•¨. ì˜ˆë¥¼ ë“¤ì–´&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | ìƒˆ í‚¤ ì¶”ê°€                                              | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | ê¸°ì¡´ í‚¤ ë®ì–´ì”€                                          | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | ê¸°ì¡´ í‚¤ì— ë°ì´í„° ì¶”ê°€                                    | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | ê¸°ì¡´ í‚¤ì— ë°ì´í„° ì•ì— ì¶”ê°€                               | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | ìˆ«ì í‚¤ ê°’ì„ ì£¼ì–´ì§„ ìˆ«ìë§Œí¼ ì¦ê°€                       | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | ìˆ«ì í‚¤ ê°’ì„ ì£¼ì–´ì§„ ìˆ«ìë§Œí¼ ê°ì†Œ                       | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | ê¸°ì¡´ í‚¤ ì‚­ì œ                                            | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | ëª¨ë“  í•­ëª© ì¦‰ì‹œ ë¬´íš¨í™”                                   | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | n ì´ˆ í›„ ëª¨ë“  í•­ëª© ë¬´íš¨í™”                                | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | ì¼ë°˜ í†µê³„ ì¶œë ¥                                         | `stats`                                                                                                                                                                                                                                     |
|                       | ë©”ëª¨ë¦¬ í†µê³„ ì¶œë ¥                                       | `stats slabs`                                                                                                                                                                                                                               |
|                       | ë” ë†’ì€ ìˆ˜ì¤€ì˜ í• ë‹¹ í†µê³„ ì¶œë ¥                          | `stats malloc`                                                                                                                                                                                                                              |
|                       | í•­ëª©ì— ëŒ€í•œ ì •ë³´ ì¶œë ¥                                   | `stats items`                                                                                                                                                                                                                               |
|                       |                                                       | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                       | `stats sizes`                                                                                                                                                                                                                               |
|                       | í†µê³„ ì¹´ìš´í„° ì¬ì„¤ì •                                    | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | ìºì‹œì˜ ëª¨ë“  í•­ëª©(ëŒ€ë¶€ë¶„)ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„° ë¤í”„         | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | ì„œë²„ ë²„ì „ ì¶œë ¥                                         | `version`                                                                                                                                                                                                                                   |
| verbosity             | ë¡œê·¸ ë ˆë²¨ ì¦ê°€                                        | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | ì„¸ì…˜ ì¢…ë£Œ                                              | `quit`                                                                                                                                                                                                                                      |

#### íŠ¸ë˜í”½ í†µê³„ <a href="#traffic-statistics" id="traffic-statistics"></a>

í˜„ì¬ íŠ¸ë˜í”½ í†µê³„ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
stats
```
ë‹¤ìŒì€ ì—°ê²° ìˆ˜, ì „ì†¡ ë°”ì´íŠ¸ ìˆ˜ ë“±ì„ ì œê³µí•˜ëŠ” ëª©ë¡ì„ ë°›ê²Œ ë©ë‹ˆë‹¤.

ì˜ˆì‹œ ì¶œë ¥:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### ë©”ëª¨ë¦¬ í†µê³„ <a href="#memory-statistics" id="memory-statistics"></a>

í˜„ì¬ ë©”ëª¨ë¦¬ í†µê³„ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
stats slabs
```
ì˜ˆì‹œ ì¶œë ¥:
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
ë§Œì•½ memcached ì¸ìŠ¤í„´ìŠ¤ì— ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ê°€ ìˆëŠ”ì§€ í™•ì‹ ì´ ì—†ë‹¤ë©´, "stats" ëª…ë ¹ì–´ë¡œ ì œê³µë˜ëŠ” "evictions" ì¹´ìš´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”. ì¸ìŠ¤í„´ìŠ¤ì— ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ê°€ ìˆë‹¤ë©´ "evictions" ì¹´ìš´í„°ëŠ” 0ì´ê±°ë‚˜ ì¦ê°€í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.

#### ì–´ë–¤ í‚¤ê°€ ì‚¬ìš©ë˜ê³  ìˆëŠ”ê°€? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

í˜„ì¬ í‚¤ ì§‘í•©ì„ ì§ì ‘ í™•ì¸í•˜ëŠ” ë‚´ì¥ í•¨ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê°€ëŠ¥í•œ ë°©ë²•ìœ¼ë¡œëŠ”
```
stats items
```
**Command to determine how many keys do exist:**

To determine how many keys exist in a Memcache server, you can use the `stats items` command. This command will provide you with a list of items stored in the cache along with their corresponding IDs and other information.
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
ì´ê²ƒì€ ì ì–´ë„ ì–´ë–¤ í‚¤ê°€ ì‚¬ìš©ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì´ë¯¸ memcache ì•¡ì„¸ìŠ¤ë¥¼ ìˆ˜í–‰í•˜ëŠ” PHP ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í‚¤ ì´ë¦„ì„ ë¤í”„í•˜ë ¤ë©´ [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html)ì˜ PHP ì½”ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ í•™ìŠµí•˜ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ì˜ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•œë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì´ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜** íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks ë° HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
