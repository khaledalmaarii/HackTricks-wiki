# Memcache Komande

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Cheat-Sheet Komande

**Sa** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Podr쬬ne komande (zvani캜ne i neke nezvani캜ne) su dokumentovane u [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt) dokumentu.

Na쬬lost, opis sintakse nije ba코 jasan i jednostavna pomo캖na komanda koja bi navela postoje캖e komande bila bi mnogo bolja. Evo pregleda komandi koje mo쬰te prona캖i u [izvoru](https://github.com/memcached/memcached) (na dan 19.08.2016):

| Komanda               | Opis                                                     | Primer                                                                                                                                                                                                                                     |
| --------------------- | ------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | 캛ita vrednost                                           | `get mojkljuc`                                                                                                                                                                                                                                 |
| set                   | Postavlja klju캜 bezuslovno                              | <p><code>set mojkljuc &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Obavezno koristite \r\n kao prelaze linije prilikom kori코캖enja Unix CLI alata. Na primer&#x3C;/p> <code>printf "set mojkljuc 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | Dodaje novi klju캜                                       | `add novikljuc 0 60 5`                                                                                                                                                                                                                         |
| replace               | Prepi코e postoje캖i klju캜                                  | `replace kljuc 0 60 5`                                                                                                                                                                                                                        |
| append                | Dodaje podatke postoje캖em klju캜u                        | `append kljuc 0 60 15`                                                                                                                                                                                                                        |
| prepend               | Dodaje podatke na po캜etak postoje캖eg klju캜a              | `prepend kljuc 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Pove캖ava numeri캜ku vrednost klju캜a za datu vrednost      | `incr mojkljuc 2`                                                                                                                                                                                                                              |
| decr                  | Smanjuje numeri캜ku vrednost klju캜a za datu vrednost      | `decr mojkljuc 5`                                                                                                                                                                                                                              |
| delete                | Bri코e postoje캖i klju캜                                   | `delete mojkljuc`                                                                                                                                                                                                                              |
| flush\_all            | Odmah poni코tava sve stavke                               | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Poni코tava sve stavke za n sekundi                        | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Prikazuje op코te statistike                               | `stats`                                                                                                                                                                                                                                     |
|                       | Prikazuje statistike memorije                            | `stats slabs`                                                                                                                                                                                                                               |
|                       | Prikazuje statistike alokacije na vi코em nivou            | `stats malloc`                                                                                                                                                                                                                              |
|                       | Prikazuje informacije o stavkama                        | `stats items`                                                                                                                                                                                                                               |
|                       |                                                         | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                         | `stats sizes`                                                                                                                                                                                                                               |
|                       | Resetuje broja캜e statistika                             | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Izbacuje (ve캖i deo) metapodatke za (sve) stavke u ke코u  | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Prikazuje verziju servera                                | `version`                                                                                                                                                                                                                                   |
| verbosity             | Pove캖ava nivo logovanja                                  | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Zavr코ava sesiju                                          | `quit`                                                                                                                                                                                                                                      |

#### Statistika Saobra캖aja <a href="#traffic-statistics" id="traffic-statistics"></a>

Mo쬰te upitati trenutnu statistiku saobra캖aja kori코캖enjem komande
```
stats
```
Dobi캖ete listu koja prikazuje broj veza, bajtove poslate i primljene i jo코 mnogo toga.

Primer izlaza:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Statistika memorije <a href="#memory-statistics" id="memory-statistics"></a>

Mo쬰te upitati trenutnu statistiku memorije kori코캖enjem
```
stats slabs
```
Primer izlaza:
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Ako niste sigurni da li imate dovoljno memorije za svoju memcached instancu uvek obratite pa쬹ju na broja캜e "evictions" koje daje "stats" komanda. Ako imate dovoljno memorije za instancu, broja캜 "evictions" treba da bude 0 ili barem da se ne pove캖ava.

#### Koji klju캜evi se koriste? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

Ne postoji ugra캠ena funkcija za direktno odre캠ivanje trenutnog skupa klju캜eva. Me캠utim, mo쬰te koristiti
```
stats items
```
### Komanda za odre캠ivanje broja postoje캖ih klju캜eva

Koristite komandu `stats items` da biste saznali koliko klju캜eva postoji.
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Ovo bar poma쬰 da se vidi da li su kori코캖eni neki klju캜evi. Da biste izlistali imena klju캜eva iz PHP skripte koja ve캖 pristupa memcache-u, mo쬰te koristiti PHP kod sa [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).


<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
