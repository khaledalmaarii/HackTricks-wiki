# 135, 593 - MSRPC æ¸—é€æµ‹è¯•

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸Š**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof æ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**æ— éœ€ç­‰å¾…å³å¯è·å¾—å¥–åŠ±**\
HackenProof çš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨ web3 æ¸—é€æµ‹è¯•ä¸­ç§¯ç´¯ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼åœ¨å®ƒå´›èµ·çš„æ—¥å­é‡ŒæŒæ¡ web3 å®‰å…¨ã€‚

**æˆä¸º web3 é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°èª‰ç§¯åˆ†ï¼Œå¹¶å æ®æ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨ HackenProof ä¸Šæ³¨å†Œ**](https://hackenproof.com/register) å¼€å§‹ä»æ‚¨çš„é»‘å®¢æ”»å‡»ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

## åŸºæœ¬ä¿¡æ¯

Microsoft è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRemote Procedure Callï¼ŒRPCï¼‰ä¹Ÿç§°ä¸ºå‡½æ•°è°ƒç”¨æˆ–å­ç¨‹åºè°ƒç”¨ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹çš„åè®®ï¼Œå…è®¸ä¸€ä¸ªç¨‹åºå‘å¦ä¸€å°è®¡ç®—æœºä¸Šçš„ç¨‹åºè¯·æ±‚æœåŠ¡ï¼Œè€Œæ— éœ€äº†è§£è¯¥è®¡ç®—æœºçš„ç½‘ç»œç»†èŠ‚ã€‚MSRPC æœ€åˆæ˜¯ä»å¼€æºè½¯ä»¶è¡ç”Ÿè€Œæ¥ï¼Œä½†å·²ç»å¾—åˆ°äº†è¿›ä¸€æ­¥çš„å¼€å‘å¹¶ç”± Microsoft ç‰ˆæƒæ‰€æœ‰ã€‚

æ ¹æ®ä¸»æœºé…ç½®ï¼ŒRPC ç«¯ç‚¹æ˜ å°„å™¨å¯ä»¥é€šè¿‡ TCP å’Œ UDP ç«¯å£ 135 è¿›è¡Œè®¿é—®ï¼Œé€šè¿‡ç©ºæˆ–ç»è¿‡èº«ä»½éªŒè¯çš„ä¼šè¯çš„ SMBï¼ˆTCP 139 å’Œ 445ï¼‰ï¼Œä»¥åŠä½œä¸ºåœ¨ TCP ç«¯å£ 593 ä¸Šç›‘å¬çš„ Web æœåŠ¡ã€‚
```
135/tcp   open     msrpc         Microsoft Windows RPC
```
## MSRPCæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

[MSRPCè¿‡ç¨‹å§‹äºå®¢æˆ·ç«¯](https://technet.microsoft.com/en-us/library/cc738291.aspx)ï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºè°ƒç”¨æœ¬åœ°å­˜æ ¹è¿‡ç¨‹è€Œä¸æ˜¯å®ç°è¯¥è¿‡ç¨‹çš„ä»£ç ã€‚å®¢æˆ·ç«¯å­˜æ ¹ä»£ç ä»å®¢æˆ·ç«¯åœ°å€ç©ºé—´ä¸­æ£€ç´¢æ‰€éœ€å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä¼ é€’ç»™å®¢æˆ·ç«¯è¿è¡Œæ—¶åº“ï¼Œç„¶åå°†å‚æ•°è½¬æ¢ä¸ºæ ‡å‡†çš„ç½‘ç»œæ•°æ®è¡¨ç¤ºæ ¼å¼ä»¥ä¼ è¾“åˆ°æœåŠ¡å™¨ã€‚

ç„¶åï¼Œå®¢æˆ·ç«¯å­˜æ ¹è°ƒç”¨RPCå®¢æˆ·ç«¯è¿è¡Œæ—¶åº“ä¸­çš„å‡½æ•°å°†è¯·æ±‚å’Œå‚æ•°å‘é€åˆ°æœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨ä½äºè¿œç¨‹ä½ç½®ï¼Œè¿è¡Œæ—¶åº“ä¼šæŒ‡å®šé€‚å½“çš„ä¼ è¾“åè®®å’Œå¼•æ“ï¼Œå¹¶å°†RPCä¼ é€’ç»™ç½‘ç»œå †æ ˆä»¥è¿›è¡Œä¼ è¾“åˆ°æœåŠ¡å™¨ã€‚\
æ¥æºï¼š[https://www.extrahop.com/resources/protocols/msrpc/](https://www.extrahop.com/resources/protocols/msrpc/)

![](<../.gitbook/assets/image (133).png>)

**å›¾ç‰‡æ¥è‡ªä¹¦ç±ã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ç¬¬ä¸‰ç‰ˆã€‹**

## **è¯†åˆ«æš´éœ²çš„RPCæœåŠ¡**

**ä»ä¹¦ç±ã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ç¬¬ä¸‰ç‰ˆã€‹ä¸­æå–çš„éƒ¨åˆ†å†…å®¹**

æ‚¨å¯ä»¥æŸ¥è¯¢RPCå®šä½å™¨æœåŠ¡å’Œå•ä¸ªRPCç«¯ç‚¹ï¼Œä»¥è®°å½•åœ¨TCPã€UDPã€HTTPå’ŒSMBï¼ˆé€šè¿‡å‘½åç®¡é“ï¼‰ä¸Šè¿è¡Œçš„æœ‰è¶£æœåŠ¡ã€‚é€šè¿‡æ­¤è¿‡ç¨‹æ”¶é›†çš„æ¯ä¸ªIFIDå€¼è¡¨ç¤ºä¸€ä¸ªRPCæœåŠ¡ï¼ˆä¾‹å¦‚ï¼Œ5a7b91f8-ff00-11d0-a9b2-00c04fb6e6fcæ˜¯Messengeræ¥å£ï¼‰ã€‚

Todd Sabinçš„rpcdumpå’Œifids Windowså®ç”¨ç¨‹åºæŸ¥è¯¢RPCå®šä½å™¨å’Œç‰¹å®šçš„RPCç«¯ç‚¹ä»¥åˆ—å‡ºIFIDå€¼ã€‚rpcdumpçš„è¯­æ³•å¦‚ä¸‹ï¼š
```
D:\rpctools> rpcdump [-p port] 192.168.189.1
IfId: 5a7b91f8-ff00-11d0-a9b2-00c04fb6e6fc version 1.0
Annotation: Messenger Service
UUID: 00000000-0000-0000-0000-000000000000
Binding: ncadg_ip_udp:192.168.189.1[1028]
```
æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨å››ä¸ªåè®®åºåˆ—è®¿é—®RPCå®šä½å™¨æœåŠ¡ï¼š

* ncacn\_ip\_tcpå’Œncadg\_ip\_udpï¼ˆTCPå’ŒUDPç«¯å£135ï¼‰
* ncacn\_npï¼ˆé€šè¿‡SMBçš„\pipe\epmapperå‘½åç®¡é“ï¼‰
* ncacn\_httpï¼ˆé€šè¿‡TCPç«¯å£80ã€593å’Œå…¶ä»–ç«¯å£çš„RPC over HTTPï¼‰
```bash
use auxiliary/scanner/dcerpc/endpoint_mapper
use auxiliary/scanner/dcerpc/hidden
use auxiliary/scanner/dcerpc/management
use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor
rpcdump.py <IP> -p 135
```
_è¯·æ³¨æ„ï¼Œé™¤äº†**`tcp_dcerpc_auditor`**ä¹‹å¤–ï¼Œæ‰€æœ‰é€‰é¡¹éƒ½**åªèƒ½**é’ˆå¯¹**ç«¯å£135**ä¸Šçš„**msrpc**æ‰§è¡Œã€‚_

#### æ˜¾è‘—çš„RPCæ¥å£

| **IFIDå€¼**                            | **å‘½åç®¡é“**  | **æè¿°**                                                                                                                                                                                                                                                                                |
| ------------------------------------ | -------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 12345778-1234-abcd-ef00-0123456789ab | \pipe\lsarpc   | LSAæ¥å£ï¼Œç”¨äºæšä¸¾ç”¨æˆ·                                                                                                                                                                                                                                                                  |
| 3919286a-b10c-11d0-9ba8-00c04fd92ef5 | \pipe\lsarpc   | LSAç›®å½•æœåŠ¡ï¼ˆDSï¼‰æ¥å£ï¼Œç”¨äºæšä¸¾åŸŸå’Œä¿¡ä»»å…³ç³»                                                                                                                                                                                                                                              |
| 12345778-1234-abcd-ef00-0123456789ac | \pipe\samr     | LSA SAMRæ¥å£ï¼Œç”¨äºè®¿é—®å…¬å…±SAMæ•°æ®åº“å…ƒç´ ï¼ˆä¾‹å¦‚ç”¨æˆ·åï¼‰å¹¶å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œè€Œä¸å—å¸æˆ·é”å®šç­–ç•¥çš„é™åˆ¶[Oreilly library](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#idm139659172852688) |
| 1ff70682-0a51-30e8-076d-740be8cee98b | \pipe\atsvc    | ä»»åŠ¡è®¡åˆ’ç¨‹åºï¼Œç”¨äºè¿œç¨‹æ‰§è¡Œå‘½ä»¤                                                                                                                                                                                                                                                          |
| 338cd001-2244-31f1-aaaa-900038001003 | \pipe\winreg   | è¿œç¨‹æ³¨å†Œè¡¨æœåŠ¡ï¼Œç”¨äºè®¿é—®ç³»ç»Ÿæ³¨å†Œè¡¨                                                                                                                                                                                                                                                      |
| 367abb81-9844-35f1-ad32-98f038001003 | \pipe\svcctl   | æœåŠ¡æ§åˆ¶ç®¡ç†å™¨å’ŒæœåŠ¡å™¨æœåŠ¡ï¼Œç”¨äºè¿œç¨‹å¯åŠ¨å’Œåœæ­¢æœåŠ¡å¹¶æ‰§è¡Œå‘½ä»¤                                                                                                                                                                                                                              |
| 4b324fc8-1670-01d3-1278-5a47bf6ee188 | \pipe\srvsvc   | æœåŠ¡æ§åˆ¶ç®¡ç†å™¨å’ŒæœåŠ¡å™¨æœåŠ¡ï¼Œç”¨äºè¿œç¨‹å¯åŠ¨å’Œåœæ­¢æœåŠ¡å¹¶æ‰§è¡Œå‘½ä»¤                                                                                                                                                                                                                              |
| 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57 | \pipe\epmapper | DCOMæ¥å£ï¼Œæ”¯æŒWMI                                                                                                                                                                                                                                                                       |

### è¯†åˆ«IPåœ°å€

ä½¿ç”¨[https://github.com/mubix/IOXIDResolver](https://github.com/mubix/IOXIDResolver)ï¼Œæ¥è‡ª[Airbus research](https://www.cyber.airbus.com/the-oxid-resolver-part-1-remote-enumeration-of-network-interfaces-without-any-authentication/)ï¼Œå¯ä»¥æ»¥ç”¨_IOXIDResolver_æ¥å£ä¸­çš„_ServerAlive2_æ–¹æ³•ã€‚

è¿™ç§æ–¹æ³•å·²è¢«ç”¨äºä»HTBç›’å­_APT_è·å–**IPv6**åœ°å€çš„æ¥å£ä¿¡æ¯ã€‚è¯·å‚é˜…[æ­¤å¤„](https://0xdf.gitlab.io/2021/04/10/htb-apt.html)ä»¥è·å–0xdf APTçš„å†™ä½œï¼Œå…¶ä¸­åŒ…æ‹¬ä½¿ç”¨rpcmap.pyä»[Impacket](https://github.com/SecureAuthCorp/impacket/)å’Œ_stringbinding_çš„æ›¿ä»£æ–¹æ³•ï¼ˆè§ä¸Šæ–‡ï¼‰ã€‚

å‚è€ƒèµ„æ–™ï¼š

* [https://www.cyber.airbus.com/the-oxid-resolver-part-1-remote-enumeration-of-network-interfaces-without-any-authentication/](https://www.cyber.airbus.com/the-oxid-resolver-part-1-remote-enumeration-of-network-interfaces-without-any-authentication/)
* [https://www.cyber.airbus.com/the-oxid-resolver-part-2-accessing-a-remote-object-inside-dcom/](https://www.cyber.airbus.com/the-oxid-resolver-part-2-accessing-a-remote-object-inside-dcom/)

## ç«¯å£593

æ¥è‡ª[rpctools](https://resources.oreilly.com/examples/9780596510305/tree/master/tools/rpctools)çš„**rpcdump.exe**å¯ä»¥ä¸æ­¤ç«¯å£è¿›è¡Œäº¤äº’ã€‚

â€‹

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProofæ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**å³æ—¶è·å¾—å¥–åŠ±**\
HackenProofçš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´ç»è¿‡éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨web3æ¸—é€æµ‹è¯•ä¸­ç§¯ç´¯ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼åœ¨å…¶å´›èµ·ä¹‹æ—¶æŒæ¡web3å®‰å…¨ã€‚

**æˆä¸ºweb3é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°èª‰ç§¯åˆ†ï¼Œå¹¶å æ®æ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨HackenProofä¸Šæ³¨å†Œ**](https://hackenproof.com/register)å¼€å§‹ä»æ‚¨çš„é»‘å®¢è¡ŒåŠ¨ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTrickså—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTricksè¡£ç‰©**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
