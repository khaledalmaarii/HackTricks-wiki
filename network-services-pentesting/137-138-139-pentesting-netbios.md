# 137,138,139 - Pentesting NetBios

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTricksçš„è¡£ç‰©**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## NetBiosåç§°æœåŠ¡

* ç”¨äºåç§°æ³¨å†Œå’Œè§£æçš„åç§°æœåŠ¡ï¼ˆç«¯å£ï¼š137/udpå’Œ137/tcpï¼‰ã€‚
* ç”¨äºæ— è¿æ¥é€šä¿¡çš„æ•°æ®æŠ¥åˆ†å‘æœåŠ¡ï¼ˆç«¯å£ï¼š138/udpï¼‰ã€‚
* ç”¨äºé¢å‘è¿æ¥çš„é€šä¿¡çš„ä¼šè¯æœåŠ¡ï¼ˆç«¯å£ï¼š139/tcpï¼‰ã€‚

### åç§°æœåŠ¡

æ¯å°æœºå™¨åœ¨NetBiosç½‘ç»œä¸­éƒ½åº”è¯¥æœ‰ä¸€ä¸ªåç§°ã€‚è¦è¯·æ±‚ä¸€ä¸ªåç§°ï¼Œæœºå™¨åº”è¯¥å‘é€ä¸€ä¸ªå¹¿æ’­çš„â€œåç§°æŸ¥è¯¢â€æ•°æ®åŒ…ï¼Œå¦‚æœæœ‰äººå›ç­”è¯´å®ƒå·²ç»åœ¨ä½¿ç”¨è¯¥åç§°ï¼Œæœºå™¨å¯ä»¥ä½¿ç”¨è¯¥åç§°ã€‚å¦‚æœæœ‰ä¸€ä¸ªåç§°æœåŠ¡æœåŠ¡å™¨ï¼Œè®¡ç®—æœºå¯ä»¥è¯¢é—®åç§°æœåŠ¡æœåŠ¡å™¨æ˜¯å¦æœ‰äººåœ¨ä½¿ç”¨å®ƒæƒ³è¦ä½¿ç”¨çš„åç§°ã€‚

è¦å‘ç°åç§°çš„IPåœ°å€ï¼ŒPCå¿…é¡»å‘é€ä¸€ä¸ªâ€œåç§°æŸ¥è¯¢â€æ•°æ®åŒ…ï¼Œå¹¶ç­‰å¾…æ˜¯å¦æœ‰äººå›ç­”ã€‚å¦‚æœæœ‰ä¸€ä¸ªåç§°æœåŠ¡æœåŠ¡å™¨ï¼ŒPCå¯ä»¥è¯¢é—®å®ƒåç§°çš„IPåœ°å€ã€‚
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
æšä¸¾NetBIOSæœåŠ¡æ—¶ï¼Œæ‚¨å¯ä»¥è·å–æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„åç§°å’ŒæœåŠ¡å™¨çš„MACåœ°å€ã€‚
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### æ•°æ®æŠ¥åˆ†å‘æœåŠ¡

NetBIOSæ•°æ®æŠ¥é€šè¿‡UDPå‘é€ã€‚å¦‚æœæ•°æ®æŠ¥è¢«å‘é€åˆ°ç‰¹å®šçš„NetBIOSåç§°ï¼Œåˆ™ä½¿ç”¨â€œç›´æ¥å”¯ä¸€â€æˆ–â€œç›´æ¥ç»„â€æ•°æ®åŒ…å‘é€ï¼›å¦‚æœæ•°æ®æŠ¥è¢«å‘é€åˆ°ç½‘ç»œä¸Šçš„æ‰€æœ‰NetBIOSåç§°ï¼Œåˆ™ä½¿ç”¨â€œå¹¿æ’­â€æ•°æ®åŒ…å‘é€ã€‚
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### ä¼šè¯æœåŠ¡

ä¼šè¯æ¨¡å¼å…è®¸ä¸¤å°è®¡ç®—æœºå»ºç«‹è¿æ¥è¿›è¡Œâ€œå¯¹è¯â€ï¼Œå¯ä»¥å¤„ç†è¾ƒå¤§çš„æ¶ˆæ¯ï¼Œå¹¶æä¾›é”™è¯¯æ£€æµ‹å’Œæ¢å¤åŠŸèƒ½ã€‚

ä¼šè¯æ˜¯é€šè¿‡äº¤æ¢æ•°æ®åŒ…æ¥å»ºç«‹çš„ã€‚å»ºç«‹ä¼šè¯çš„è®¡ç®—æœºå°è¯•ä¸è¦å»ºç«‹ä¼šè¯çš„è®¡ç®—æœºä¸Šçš„ç«¯å£139å»ºç«‹[TCP](https://en.wikipedia.org/wiki/Transmission\_Control\_Protocol)è¿æ¥ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œå»ºç«‹ä¼šè¯çš„è®¡ç®—æœºä¼šé€šè¿‡è¿æ¥å‘é€ä¸€ä¸ªâ€œä¼šè¯è¯·æ±‚â€æ•°æ®åŒ…ï¼Œå…¶ä¸­åŒ…å«å»ºç«‹ä¼šè¯çš„åº”ç”¨ç¨‹åºçš„NetBIOSåç§°å’Œè¦å»ºç«‹ä¼šè¯çš„NetBIOSåç§°ã€‚è¦å»ºç«‹ä¼šè¯çš„è®¡ç®—æœºå°†ä»¥â€œç§¯æä¼šè¯å“åº”â€å›å¤ï¼Œè¡¨ç¤ºå¯ä»¥å»ºç«‹ä¼šè¯ï¼Œæˆ–è€…ä»¥â€œå¦å®šä¼šè¯å“åº”â€å›å¤ï¼Œè¡¨ç¤ºæ— æ³•å»ºç«‹ä¼šè¯ï¼ˆå¯èƒ½æ˜¯å› ä¸ºè¯¥è®¡ç®—æœºæ²¡æœ‰ç›‘å¬è¦å»ºç«‹åˆ°è¯¥åç§°çš„ä¼šè¯ï¼Œæˆ–è€…å› ä¸ºæ²¡æœ‰å¯ç”¨èµ„æºæ¥å»ºç«‹åˆ°è¯¥åç§°çš„ä¼šè¯ï¼‰ã€‚

åœ¨å·²å»ºç«‹çš„ä¼šè¯ä¸­ï¼Œé€šè¿‡ä¼šè¯æ¶ˆæ¯æ•°æ®åŒ…ä¼ è¾“æ•°æ®ã€‚

TCPå¤„ç†æ‰€æœ‰ä¼šè¯æœåŠ¡æ•°æ®åŒ…çš„æµé‡æ§åˆ¶å’Œé‡ä¼ ï¼Œå¹¶å°†æ•°æ®æµåˆ†å‰²æˆè¶³å¤Ÿå°ä»¥é€‚åº”é“¾è·¯å±‚æ•°æ®åŒ…çš„[IP](https://en.wikipedia.org/wiki/Internet\_Protocol)æ•°æ®æŠ¥ã€‚

ä¼šè¯é€šè¿‡å…³é—­TCPè¿æ¥æ¥å…³é—­ã€‚
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**é˜…è¯»ä¸‹ä¸€é¡µä»¥äº†è§£å¦‚ä½•æšä¸¾æ­¤æœåŠ¡ï¼š**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}

## HackTricksè‡ªåŠ¨å‘½ä»¤
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

Every machine should have a name inside the NetBios network. To request a name, a machine should send a "Name Query" packet in broadcast and if anyone answer that it is already using that name, the machine can use that name. If there is a Name Service server, the computer could ask the Name Service server if someone is using the name that it wants to use.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
