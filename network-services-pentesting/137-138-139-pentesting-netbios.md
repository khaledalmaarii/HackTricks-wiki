# 137,138,139 - Pentesting NetBios

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTsæ”¶è—å“](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## NetBiosåç§°æœåŠ¡

**NetBIOSåç§°æœåŠ¡**å‘æŒ¥ç€å…³é”®ä½œç”¨ï¼Œæ¶‰åŠå„ç§æœåŠ¡ï¼Œå¦‚**åç§°æ³¨å†Œå’Œè§£æ**ï¼Œ**æ•°æ®æŠ¥åˆ†å‘**å’Œ**ä¼šè¯æœåŠ¡**ï¼Œæ¯ç§æœåŠ¡éƒ½ä½¿ç”¨ç‰¹å®šçš„ç«¯å£ã€‚

[æ¥è‡ªWikidepia](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP):

* ç”¨äºåç§°æ³¨å†Œå’Œè§£æçš„åç§°æœåŠ¡ï¼ˆç«¯å£ï¼š137/udpå’Œ137/tcpï¼‰ã€‚
* ç”¨äºæ— è¿æ¥é€šä¿¡çš„æ•°æ®æŠ¥åˆ†å‘æœåŠ¡ï¼ˆç«¯å£ï¼š138/udpï¼‰ã€‚
* ç”¨äºé¢å‘è¿æ¥çš„é€šä¿¡çš„ä¼šè¯æœåŠ¡ï¼ˆç«¯å£ï¼š139/tcpï¼‰ã€‚

### åç§°æœåŠ¡

è¦ä½¿è®¾å¤‡å‚ä¸NetBIOSç½‘ç»œï¼Œå®ƒå¿…é¡»å…·æœ‰å”¯ä¸€çš„åç§°ã€‚è¿™æ˜¯é€šè¿‡**å¹¿æ’­è¿‡ç¨‹**å®ç°çš„ï¼Œå…¶ä¸­å‘é€â€œåç§°æŸ¥è¯¢â€æ•°æ®åŒ…ã€‚å¦‚æœæ²¡æœ‰æ”¶åˆ°å¼‚è®®ï¼Œè¯¥åç§°è¢«è§†ä¸ºå¯ç”¨ã€‚æˆ–è€…ï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢**åç§°æœåŠ¡æœåŠ¡å™¨**ä»¥æ£€æŸ¥åç§°æ˜¯å¦å¯ç”¨æˆ–å°†åç§°è§£æä¸ºIPåœ°å€ã€‚å·¥å…·å¦‚`nmblookup`ï¼Œ`nbtscan`å’Œ`nmap`ç”¨äºæšä¸¾NetBIOSæœåŠ¡ï¼Œæ˜¾ç¤ºæœåŠ¡å™¨åç§°å’ŒMACåœ°å€ã€‚
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
æšä¸¾NetBIOSæœåŠ¡ï¼Œæ‚¨å¯ä»¥è·å–æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„åç§°å’ŒæœåŠ¡å™¨çš„MACåœ°å€ã€‚
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### æ•°æ®æŠ¥åˆ†å‘æœåŠ¡

NetBIOSæ•°æ®æŠ¥å…è®¸é€šè¿‡UDPè¿›è¡Œæ— è¿æ¥é€šä¿¡ï¼Œæ”¯æŒç›´æ¥æ¶ˆæ¯ä¼ é€’æˆ–å‘æ‰€æœ‰ç½‘ç»œåç§°å¹¿æ’­ã€‚è¯¥æœåŠ¡ä½¿ç”¨**138/udp**ç«¯å£ã€‚
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### ä¼šè¯æœåŠ¡

å¯¹äºé¢å‘è¿æ¥çš„äº¤äº’ï¼Œ**ä¼šè¯æœåŠ¡**é€šè¿‡ç«¯å£**139/tcp**ä¿ƒè¿›ä¸¤å°è®¾å¤‡ä¹‹é—´çš„å¯¹è¯ï¼Œåˆ©ç”¨**TCP**è¿æ¥ã€‚ä¼šè¯å§‹äºâ€œä¼šè¯è¯·æ±‚â€æ•°æ®åŒ…ï¼Œå¹¶å¯æ ¹æ®å“åº”å»ºç«‹ã€‚è¯¥æœåŠ¡æ”¯æŒæ›´å¤§çš„æ¶ˆæ¯ã€é”™è¯¯æ£€æµ‹å’Œæ¢å¤ï¼ŒTCPå¤„ç†æµé‡æ§åˆ¶å’Œæ•°æ®åŒ…é‡ä¼ ã€‚

ä¼šè¯å†…çš„æ•°æ®ä¼ è¾“æ¶‰åŠ**ä¼šè¯æ¶ˆæ¯æ•°æ®åŒ…**ï¼Œä¼šè¯é€šè¿‡å…³é—­TCPè¿æ¥æ¥ç»ˆæ­¢ã€‚

è¿™äº›æœåŠ¡å¯¹äº**NetBIOS**åŠŸèƒ½è‡³å…³é‡è¦ï¼Œå®ç°ç½‘ç»œä¸Šçš„é«˜æ•ˆé€šä¿¡å’Œèµ„æºå…±äº«ã€‚æœ‰å…³TCPå’ŒIPåè®®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒå®ƒä»¬å„è‡ªçš„[TCP Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)å’Œ[IP Wikipedia](https://en.wikipedia.org/wiki/Internet_Protocol)é¡µé¢ã€‚
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**é˜…è¯»ä¸‹ä¸€é¡µä»¥äº†è§£å¦‚ä½•æšä¸¾æ­¤æœåŠ¡ï¼š**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

For a device to participate in a NetBIOS network, it must have a unique name. This is achieved through a broadcast process where a "Name Query" packet is sent. If no objections are received, the name is considered available. Alternatively, a Name Service server can be queried directly to check for name availability or to resolve a name to an IP address.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
