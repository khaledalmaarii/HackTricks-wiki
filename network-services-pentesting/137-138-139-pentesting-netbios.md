# 137,138,139 - Pentesting NetBios

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## NetBios Name Service

**NetBIOS Name Service**ëŠ” **ì´ë¦„ ë“±ë¡ ë° í•´ìƒë„**, **ë°ì´í„°ê·¸ë¨ ë°°í¬**, **ì„¸ì…˜ ì„œë¹„ìŠ¤**ì™€ ê°™ì€ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ í¬í•¨í•˜ì—¬ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ë©°, ê° ì„œë¹„ìŠ¤ì— ëŒ€í•´ íŠ¹ì • í¬íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

[From Wikidepia](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP):

* ì´ë¦„ ë“±ë¡ ë° í•´ìƒë„ë¥¼ ìœ„í•œ ì´ë¦„ ì„œë¹„ìŠ¤ (í¬íŠ¸: 137/udp ë° 137/tcp).
* ì—°ê²° ì—†ëŠ” í†µì‹ ì„ ìœ„í•œ ë°ì´í„°ê·¸ë¨ ë°°í¬ ì„œë¹„ìŠ¤ (í¬íŠ¸: 138/udp).
* ì—°ê²° ì§€í–¥ í†µì‹ ì„ ìœ„í•œ ì„¸ì…˜ ì„œë¹„ìŠ¤ (í¬íŠ¸: 139/tcp).

### Name Service

ì¥ì¹˜ê°€ NetBIOS ë„¤íŠ¸ì›Œí¬ì— ì°¸ì—¬í•˜ë ¤ë©´ ê³ ìœ í•œ ì´ë¦„ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” "ì´ë¦„ ì¿¼ë¦¬" íŒ¨í‚·ì´ ì „ì†¡ë˜ëŠ” **ë¸Œë¡œë“œìºìŠ¤íŠ¸ í”„ë¡œì„¸ìŠ¤**ë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ì˜ ì œê¸°ê°€ ì—†ìœ¼ë©´ ì´ë¦„ì€ ì‚¬ìš© ê°€ëŠ¥í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤. ë˜ëŠ” **ì´ë¦„ ì„œë¹„ìŠ¤ ì„œë²„**ì— ì§ì ‘ ì¿¼ë¦¬í•˜ì—¬ ì´ë¦„ì˜ ê°€ìš©ì„±ì„ í™•ì¸í•˜ê±°ë‚˜ ì´ë¦„ì„ IP ì£¼ì†Œë¡œ í•´ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `nmblookup`, `nbtscan`, `nmap`ê³¼ ê°™ì€ ë„êµ¬ëŠ” NetBIOS ì„œë¹„ìŠ¤ë¥¼ ì—´ê±°í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©°, ì„œë²„ ì´ë¦„ê³¼ MAC ì£¼ì†Œë¥¼ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
NetBIOS ì„œë¹„ìŠ¤ë¥¼ ì—´ê±°í•˜ë©´ ì„œë²„ê°€ ì‚¬ìš©í•˜ëŠ” ì´ë¦„ê³¼ ì„œë²„ì˜ MAC ì£¼ì†Œë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### Datagram Distribution Service

NetBIOS ë°ì´í„°ê·¸ë¨ì€ UDPë¥¼ í†µí•´ ì—°ê²° ì—†ëŠ” í†µì‹ ì„ í—ˆìš©í•˜ë©°, ì§ì ‘ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê±°ë‚˜ ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ì´ë¦„ì— ë¸Œë¡œë“œìºìŠ¤íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” í¬íŠ¸ **138/udp**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### Session Service

ì—°ê²° ì§€í–¥ ìƒí˜¸ì‘ìš©ì„ ìœ„í•´, **Session Service**ëŠ” ë‘ ì¥ì¹˜ ê°„ì˜ ëŒ€í™”ë¥¼ ì´‰ì§„í•˜ë©°, **TCP** ì—°ê²°ì„ í†µí•´ í¬íŠ¸ **139/tcp**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„¸ì…˜ì€ "Session Request" íŒ¨í‚·ìœ¼ë¡œ ì‹œì‘ë˜ë©°, ì‘ë‹µì— ë”°ë¼ ì„¤ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ë” í° ë©”ì‹œì§€, ì˜¤ë¥˜ ê°ì§€ ë° ë³µêµ¬ë¥¼ ì§€ì›í•˜ë©°, TCPëŠ” íë¦„ ì œì–´ ë° íŒ¨í‚· ì¬ì „ì†¡ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

ì„¸ì…˜ ë‚´ ë°ì´í„° ì „ì†¡ì€ **Session Message packets**ë¥¼ í¬í•¨í•˜ë©°, ì„¸ì…˜ì€ TCP ì—°ê²°ì„ ë‹«ìŒìœ¼ë¡œì¨ ì¢…ë£Œë©ë‹ˆë‹¤.

ì´ ì„œë¹„ìŠ¤ëŠ” **NetBIOS** ê¸°ëŠ¥ì— í•„ìˆ˜ì ì´ë©°, ë„¤íŠ¸ì›Œí¬ ì „ë°˜ì— ê±¸ì³ íš¨ìœ¨ì ì¸ í†µì‹  ë° ìì› ê³µìœ ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. TCP ë° IP í”„ë¡œí† ì½œì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” ê°ê°ì˜ [TCP Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol) ë° [IP Wikipedia](https://en.wikipedia.org/wiki/Internet_Protocol) í˜ì´ì§€ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**ë‹¤ìŒ í˜ì´ì§€ë¥¼ ì½ì–´ ì´ ì„œë¹„ìŠ¤ë¥¼ ì—´ê±°í•˜ëŠ” ë°©ë²•ì„ ë°°ìš°ì„¸ìš”:**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}

## HackTricks ìë™ ëª…ë ¹
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

For a device to participate in a NetBIOS network, it must have a unique name. This is achieved through a broadcast process where a "Name Query" packet is sent. If no objections are received, the name is considered available. Alternatively, a Name Service server can be queried directly to check for name availability or to resolve a name to an IP address.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
