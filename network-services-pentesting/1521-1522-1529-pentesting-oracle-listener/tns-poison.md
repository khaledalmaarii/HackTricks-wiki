<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Poison TNS

Si vous rencontrez une version plus rÃ©cente du listener, il ne reste plus beaucoup de place sauf le brute-forcing. Cependant, toutes les versions jusqu'Ã  la version 12c sont vulnÃ©rables Ã  une attaque appelÃ©e Â« Poison TNS Â». Bien que la derniÃ¨re version ne soit vulnÃ©rable que dans certaines configurations spÃ©ciales. Par exemple, l'une des faÃ§ons de corriger cette vulnÃ©rabilitÃ© est de dÃ©sactiver la configuration dynamique du listener, ce qui est impossible lors de l'utilisation d'Oracle DataGuard, PL/SQL Gateway en connexion avec APEX et dans certaines versions de SAP. En gÃ©nÃ©ral, le problÃ¨me est que, par dÃ©faut, le service d'Ã©coute prend en charge la configuration Ã  distance et, en outre, il permet de le faire de maniÃ¨re anonyme. C'est lÃ  que se situe le cÅ“ur de la vulnÃ©rabilitÃ©.

[![Fig. 1. TNS Poison Vulnerability](https://hackmag.com/wp-content/uploads/2015/04/poison.png)](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

Fig. 1. VulnÃ©rabilitÃ© Poison TNS

Voici un algorithme d'attaque d'exemple (voir Fig. 1) :

* Envoyer la requÃªte TNS suivante : Â« CONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)) Â».
* Le serveur vulnÃ©rable rÃ©pondra : Â« (DESCRIPTION=(TMP=)) Â». Voici ce que sera la rÃ©ponse d'un serveur patchÃ© : Â« (ERROR_STACK=(ERROR=1194)) Â».
* GÃ©nÃ©rer un package de configuration avec SID et IP du nouveau listener (pour une future MITM). Le nombre de caractÃ¨res dans le nom du SID actuel est fondamental. Vous devez le connaÃ®tre, car c'est de cela que dÃ©pend un package bien formÃ©.
* Ensuite, envoyer tous ces goodies au listener.
* Si tout est correct, alors toutes les nouvelles connexions seront transmises par le listener via votre IP contrÃ´lÃ©e.

Il est important de ne pas oublier d'activer le proxying des requÃªtes (comme IP_forwarding sous Linux), sinon, au lieu d'une attaque MITM soignÃ©e, vous obtiendrez un DoS rugueux, car les nouveaux clients ne pourront pas se connecter Ã  la base de donnÃ©es. En consÃ©quence, un attaquant peut intÃ©grer ses propres commandes dans la session d'un autre utilisateur. **Vous pouvez vÃ©rifier si le serveur est vulnÃ©rable en utilisant le module MSF suivant : Â« auxiliary/scanner/oracle/tnspoison_checker Â».**

Toutes ces pages ont Ã©tÃ© extraites d'ici : [https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)

**Autre faÃ§on de tester :**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
