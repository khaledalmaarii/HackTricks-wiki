# 27017,27018 - Pentesting MongoDB

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

**MongoDB** - —Ü–µ **—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º**, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–º–æ–¥–µ–ª—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏**, –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–∏—Ö —Ñ–æ—Ä–º –¥–∞–Ω–∏—Ö. –í–æ–Ω–∞ –ø—Ä–æ–ø–æ–Ω—É—î –≥–Ω—É—á–∫—ñ—Å—Ç—å —ñ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–º–∏ –∞–±–æ –Ω–∞–ø—ñ–≤—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –≤ —Ç–∞–∫–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö, —è–∫ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö —ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º. **–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 27017, 27018
```
PORT      STATE SERVICE VERSION
27017/tcp open  mongodb MongoDB 2.6.9 2.6.9
```
## –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

### –í—Ä—É—á–Ω—É
```python
from pymongo import MongoClient
client = MongoClient(host, port, username=username, password=password)
client.server_info() #Basic info
#If you have admin access you can obtain more info
admin = client.admin
admin_info = admin.command("serverStatus")
cursor = client.list_databases()
for db in cursor:
print(db)
print(client[db["name"]].list_collection_names())
#If admin access, you could dump the database also
```
**–î–µ—è–∫—ñ –∫–æ–º–∞–Ω–¥–∏ MongoDB:**
```bash
show dbs
use <db>
show collections
db.<collection>.find()  #Dump the collection
db.<collection>.count() #Number of records of the collection
db.current.find({"username":"admin"})  #Find in current db the username admin
```
### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π
```bash
nmap -sV --script "mongo* and default" -p 27017 <IP> #By default all the nmap mongo enumerate scripts are used
```
### Shodan

* –í—Å—ñ mongodb: `"mongodb server information"`
* –®—É–∫–∞—Ç–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫—Ä–∏—Ç—ñ mongodb —Å–µ—Ä–≤–µ—Ä–∏: `"mongodb server information" -"partially enabled"`
* –¢—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∫–æ–≤–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ auth: `"mongodb server information" "partially enabled"`

## Login

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º mongo –Ω–µ –≤–∏–º–∞–≥–∞—î –ø–∞—Ä–æ–ª—è.\
**Admin** —î –∑–∞–≥–∞–ª—å–Ω–æ—é mongo –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö.
```bash
mongo <HOST>
mongo <HOST>:<PORT>
mongo <HOST>:<PORT>/<DB>
mongo <database> -u <username> -p '<password>'
```
–°–∫—Ä–∏–ø—Ç nmap: _**mongodb-brute**_ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.
```bash
nmap -n -sV --script mongodb-brute -p 27017 <ip>
```
### [**Brute force**](../generic-methodologies-and-resources/brute-force.md#mongo)

–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –≤ _/opt/bitnami/mongodb/mongodb.conf_, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ:
```bash
grep "noauth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#" #Not needed
grep "auth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#\|noauth" #Not needed
```
## –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è Mongo Objectid

–ü—Ä–∏–∫–ª–∞–¥ [–∑ —Ç—É—Ç](https://techkranti.com/idor-through-mongodb-object-ids-prediction/).

Mongo Object ID —î **12-–±–∞–π—Ç–æ–≤–∏–º–∏ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º–∏** —Ä—è–¥–∫–∞–º–∏:

![http://techidiocy.com/\_id-objectid-in-mongodb/](../.gitbook/assets/id-and-ObjectIds-in-MongoDB.png)

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –æ—Å—å —è–∫ –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π Object ID, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π –¥–æ–¥–∞—Ç–∫–æ–º: 5f2459ac9fa6dc2500314019

1. 5f2459ac: 1596217772 –≤ –¥–µ—Å—è—Ç–∫–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ = –ø‚Äô—è—Ç–Ω–∏—Ü—è, 31 –ª–∏–ø–Ω—è 2020 17:49:32
2. 9fa6dc: –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–∞—à–∏–Ω–∏
3. 2500: –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É
4. 314019: –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫

–ó –Ω–∞–≤–µ–¥–µ–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–∞—à–∏–Ω–∏ –∑–∞–ª–∏—à–∏—Ç—å—Å—è –Ω–µ–∑–º—ñ–Ω–Ω–∏–º, –ø–æ–∫–∏ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –ø—Ä–∞—Ü—é—î –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π —Ñ—ñ–∑–∏—á–Ω—ñ–π/–≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ–π –º–∞—à–∏–Ω—ñ. –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É –∑–º—ñ–Ω–∏—Ç—å—Å—è –ª–∏—à–µ —É —Ä–∞–∑—ñ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É –ø—Ä–æ—Ü–µ—Å—É MongoDB. –ß–∞—Å–æ–≤–∞ –º—ñ—Ç–∫–∞ –±—É–¥–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏—Å—è —â–æ—Å–µ–∫—É–Ω–¥–∏. –Ñ–¥–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º—É, —â–æ–± –≤–≥–∞–¥–∞—Ç–∏ Object ID, –ø—Ä–æ—Å—Ç–æ —ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç—É—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ —Ç–∞ —á–∞—Å–æ–≤–æ—ó –º—ñ—Ç–∫–∏, –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ Mongo DB –≥–µ–Ω–µ—Ä—É—î Object ID —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–∞—î Object ID –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [https://github.com/andresriancho/mongo-objectid-predict](https://github.com/andresriancho/mongo-objectid-predict), –æ—Ç—Ä–∏–º–∞–≤—à–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π Object ID (–≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π ID), –ø–æ–≤–µ—Ä—Ç–∞—î –±–ª–∏–∑—å–∫–æ 1000 –π–º–æ–≤—ñ—Ä–Ω–∏—Ö Object ID, —è–∫—ñ –º–æ–≥–ª–∏ –±—É—Ç–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –æ–±'—î–∫—Ç–∞–º, —Ç–æ–º—É –≤–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ó—Ö –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏.

## –ü–æ—Å—Ç

–Ø–∫—â–æ –≤–∏ root, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏** —Ñ–∞–π–ª **mongodb.conf**, —â–æ–± –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–ª–æ –≤–≤–æ–¥–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ (_noauth = true_) —ñ **—É–≤—ñ–π—Ç–∏ –±–µ–∑ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**.

***

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è –≤ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ —Ö–∞–∫—ñ–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–∏–º —Å–≤—ñ—Ç–æ–º —Ö–∞–∫—ñ–Ω–≥—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
