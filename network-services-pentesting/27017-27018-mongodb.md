# 27017,27018 - Pentesting MongoDB

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## Basic Information

**MongoDB** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ±** ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Î²Î¬ÏƒÎµÏ‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î­Î½Î± **Î¼Î¿Î½Ï„Î­Î»Î¿ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€ÏÎ¿ÏƒÎ±Î½Î±Ï„Î¿Î»Î¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ Î­Î³Î³ÏÎ±Ï†Î±** Î³Î¹Î± Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Î¼Î¿ÏÏ†Î­Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½. Î ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ ÎµÏ…ÎµÎ»Î¹Î¾Î¯Î± ÎºÎ±Î¹ ÎºÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î³Î¹Î± Ï„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î¼Î· Î´Î¿Î¼Î·Î¼Î­Î½Ï‰Î½ Î® Î·Î¼Î¹-Î´Î¿Î¼Î·Î¼Î­Î½Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏŒÏ€Ï‰Ï‚ Î· Î±Î½Î¬Î»Ï…ÏƒÎ· Î¼ÎµÎ³Î¬Î»Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎºÎ±Î¹ Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï…. **Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î¸ÏÏÎ±:** 27017, 27018
```
PORT      STATE SERVICE VERSION
27017/tcp open  mongodb MongoDB 2.6.9 2.6.9
```
## Enumeration

### Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î·
```python
from pymongo import MongoClient
client = MongoClient(host, port, username=username, password=password)
client.server_info() #Basic info
#If you have admin access you can obtain more info
admin = client.admin
admin_info = admin.command("serverStatus")
cursor = client.list_databases()
for db in cursor:
print(db)
print(client[db["name"]].list_collection_names())
#If admin access, you could dump the database also
```
**ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ MongoDB:**
```bash
show dbs
use <db>
show collections
db.<collection>.find()  #Dump the collection
db.<collection>.count() #Number of records of the collection
db.current.find({"username":"admin"})  #Find in current db the username admin
```
### Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î·
```bash
nmap -sV --script "mongo* and default" -p 27017 <IP> #By default all the nmap mongo enumerate scripts are used
```
### Shodan

* ÎŒÎ»Î± Ï„Î± mongodb: `"mongodb server information"`
* Î‘Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ Ï€Î»Î®ÏÏ‰Ï‚ Î±Î½Î¿Î¹Ï‡Ï„Î¿ÏÏ‚ mongodb servers: `"mongodb server information" -"partially enabled"`
* ÎœÏŒÎ½Î¿ Î¼ÎµÏÎ¹ÎºÏÏ‚ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·: `"mongodb server information" "partially enabled"`

## Login

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Ï„Î¿ mongo Î´ÎµÎ½ Î±Ï€Î±Î¹Ï„ÎµÎ¯ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚.\
**Admin** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÎºÎ¿Î¹Î½Î® Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ mongo.
```bash
mongo <HOST>
mongo <HOST>:<PORT>
mongo <HOST>:<PORT>/<DB>
mongo <database> -u <username> -p '<password>'
```
Î¤Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ nmap: _**mongodb-brute**_ Î¸Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î±Î½ Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±.
```bash
nmap -n -sV --script mongodb-brute -p 27017 <ip>
```
### [**Brute force**](../generic-methodologies-and-resources/brute-force.md#mongo)

ÎšÎ¿Î¯Ï„Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ _/opt/bitnami/mongodb/mongodb.conf_ Î³Î¹Î± Î½Î± Î´ÎµÎ¹Ï‚ Î±Î½ Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±:
```bash
grep "noauth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#" #Not needed
grep "auth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#\|noauth" #Not needed
```
## Mongo Objectid Predict

Example [from here](https://techkranti.com/idor-through-mongodb-object-ids-prediction/).

Mongo Object IDs ÎµÎ¯Î½Î±Î¹ **12-byte hexadecimal** strings:

![http://techidiocy.com/\_id-objectid-in-mongodb/](../.gitbook/assets/id-and-ObjectIds-in-MongoDB.png)

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÎµÎ´Ï ÎµÎ¯Î½Î±Î¹ Ï€ÏÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î¼Îµ Î­Î½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Object ID Ï€Î¿Ï… ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î®: 5f2459ac9fa6dc2500314019

1. 5f2459ac: 1596217772 ÏƒÎµ Î´ÎµÎºÎ±Î´Î¹ÎºÏŒ = Î Î±ÏÎ±ÏƒÎºÎµÏ…Î®, 31 Î™Î¿Ï…Î»Î¯Î¿Ï… 2020 17:49:32
2. 9fa6dc: Î‘Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ ÎœÎ·Ï‡Î±Î½Î®Ï‚
3. 2500: Î‘Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Î”Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚
4. 314019: ÎˆÎ½Î±Ï‚ Î±Ï…Î¾Î±Î½ÏŒÎ¼ÎµÎ½Î¿Ï‚ Î¼ÎµÏ„ÏÎ·Ï„Î®Ï‚

Î‘Ï€ÏŒ Ï„Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, Ï„Î¿ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Î¼Î·Ï‡Î±Î½Î®Ï‚ Î¸Î± Ï€Î±ÏÎ±Î¼ÎµÎ¯Î½ÎµÎ¹ Ï„Î¿ Î¯Î´Î¹Î¿ ÏŒÏƒÎ¿ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Ï†Ï…ÏƒÎ¹ÎºÎ®/ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ® Î¼Î·Ï‡Î±Î½Î®. Î¤Î¿ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ Î¸Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î±Î½ Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± MongoDB ÎµÏ€Î±Î½ÎµÎºÎºÎ¹Î½Î·Î¸ÎµÎ¯. Î— Ï‡ÏÎ¿Î½Î¹ÎºÎ® ÏƒÎ®Î¼Î±Î½ÏƒÎ· Î¸Î± ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÏ„Î±Î¹ ÎºÎ¬Î¸Îµ Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿. Î— Î¼ÏŒÎ½Î· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· ÏƒÏ„Î¿ Î½Î± Î¼Î±Î½Ï„Î­ÏˆÎµÏ„Îµ Ï„Î± Object IDs Î±Ï€Î»Î¬ Î±Ï…Î¾Î¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ Ï„Î¿Ï… Î¼ÎµÏ„ÏÎ·Ï„Î® ÎºÎ±Î¹ Ï„Î·Ï‚ Ï‡ÏÎ¿Î½Î¹ÎºÎ®Ï‚ ÏƒÎ®Î¼Î±Î½ÏƒÎ·Ï‚, ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î³ÎµÎ³Î¿Î½ÏŒÏ‚ ÏŒÏ„Î¹ Î· Mongo DB Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Object IDs ÎºÎ±Î¹ Î±Î½Î± assigns Object IDs ÏƒÎµ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚.

Î¤Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [https://github.com/andresriancho/mongo-objectid-predict](https://github.com/andresriancho/mongo-objectid-predict), Î´ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÎµÎ½ÏŒÏ‚ Î±ÏÏ‡Î¹ÎºÎ¿Ï Object ID (Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î±ÏÏ‡Î¹ÎºÏŒ ID), ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï€ÎµÏÎ¯Ï€Î¿Ï… 1000 Ï€Î¹Î¸Î±Î½Î¬ Object IDs Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± Î­Ï‡Î¿Ï…Î½ Î±Î½Î±Ï„ÎµÎ¸ÎµÎ¯ ÏƒÏ„Î± ÎµÏ€ÏŒÎ¼ÎµÎ½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±, Î¿Ï€ÏŒÏ„Îµ Î±Ï€Î»Î¬ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Ï„Î± brute force.

## Post

Î‘Î½ ÎµÎ¯ÏƒÏ„Îµ root Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ** Ï„Î¿ **mongodb.conf** Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± (_noauth = true_) ÎºÎ±Î¹ Î½Î± **ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±**.

***

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
