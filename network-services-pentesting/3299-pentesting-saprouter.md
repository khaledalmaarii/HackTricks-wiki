<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## é€šè¿‡Metasploitç†è§£SAProuteræ¸—é€

SAProuterå……å½“SAPç³»ç»Ÿçš„åå‘ä»£ç†ï¼Œä¸»è¦ç”¨äºæ§åˆ¶äº’è”ç½‘ä¸å†…éƒ¨SAPç½‘ç»œä¹‹é—´çš„è®¿é—®ã€‚é€šå¸¸é€šè¿‡å…è®¸TCPç«¯å£3299ç©¿è¿‡ç»„ç»‡é˜²ç«å¢™æ¥å°†å…¶æš´éœ²åœ¨äº’è”ç½‘ä¸Šã€‚è¿™ç§è®¾ç½®ä½¿SAProuteræˆä¸ºæ¸—é€æµ‹è¯•çš„ä¸€ä¸ªå¸å¼•äººçš„ç›®æ ‡ï¼Œå› ä¸ºå®ƒå¯èƒ½ä½œä¸ºé€šå¾€é«˜ä»·å€¼å†…éƒ¨ç½‘ç»œçš„ç½‘å…³ã€‚

**æ‰«æå’Œä¿¡æ¯æ”¶é›†**

é¦–å…ˆï¼Œä½¿ç”¨**sap_service_discovery**æ¨¡å—æ‰§è¡Œæ‰«æï¼Œä»¥ç¡®å®šç»™å®šIPä¸Šæ˜¯å¦è¿è¡Œäº†SAPè·¯ç”±å™¨ã€‚è¿™ä¸€æ­¥å¯¹äºå»ºç«‹SAPè·¯ç”±å™¨åŠå…¶å¼€æ”¾ç«¯å£çš„å­˜åœ¨è‡³å…³é‡è¦ã€‚
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
åœ¨å‘ç°ä¹‹åï¼Œä½¿ç”¨ **sap_router_info_request** æ¨¡å—å¯¹ SAP è·¯ç”±å™¨çš„é…ç½®è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ï¼Œå¯èƒ½ä¼šæ­ç¤ºå†…éƒ¨ç½‘ç»œç»†èŠ‚ã€‚
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**æšä¸¾å†…éƒ¨æœåŠ¡**

é€šè¿‡è·å¾—çš„å†…éƒ¨ç½‘ç»œæ´å¯ŸåŠ›ï¼Œä½¿ç”¨**sap_router_portscanner**æ¨¡å—æ¥é€šè¿‡SAProuteræ¢æµ‹å†…éƒ¨ä¸»æœºå’ŒæœåŠ¡ï¼Œä»è€Œæ›´æ·±å…¥åœ°äº†è§£å†…éƒ¨ç½‘ç»œå’ŒæœåŠ¡é…ç½®ã€‚
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
**é«˜çº§æšä¸¾å’ŒACLæ˜ å°„**

è¿›ä¸€æ­¥çš„æ‰«æå¯ä»¥æ­ç¤ºSAProuterä¸Šçš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰é…ç½®æƒ…å†µï¼Œè¯¦ç»†è¯´æ˜äº†å…è®¸æˆ–é˜»æ­¢çš„è¿æ¥ã€‚è¿™äº›ä¿¡æ¯å¯¹äºç†è§£å®‰å…¨ç­–ç•¥å’Œæ½œåœ¨æ¼æ´è‡³å…³é‡è¦ã€‚
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**å†…éƒ¨ä¸»æœºçš„ç›²æšä¸¾**

åœ¨ç›´æ¥ä»SAProuterè·å–ä¿¡æ¯å—é™çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åº”ç”¨ç›²æšä¸¾ç­‰æŠ€æœ¯ã€‚è¿™ç§æ–¹æ³•å°è¯•çŒœæµ‹å’ŒéªŒè¯å†…éƒ¨ä¸»æœºåçš„å­˜åœ¨ï¼Œæ­ç¤ºæ½œåœ¨ç›®æ ‡è€Œæ— éœ€ç›´æ¥IPåœ°å€ã€‚

**åˆ©ç”¨ä¿¡æ¯è¿›è¡Œæ¸—é€æµ‹è¯•**

åœ¨ç»˜åˆ¶ç½‘ç»œå›¾å¹¶ç¡®å®šå¯è®¿é—®çš„æœåŠ¡åï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥åˆ©ç”¨Metasploitçš„ä»£ç†åŠŸèƒ½é€šè¿‡SAProuterè¿›è¡Œè¿›ä¸€æ­¥æ¢ç´¢å’Œåˆ©ç”¨å†…éƒ¨SAPæœåŠ¡ã€‚
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**ç»“è®º**

è¿™ç§æ–¹æ³•å¼ºè°ƒäº†å®‰å…¨çš„SAProuteré…ç½®çš„é‡è¦æ€§ï¼Œå¹¶çªå‡ºäº†é€šè¿‡æœ‰é’ˆå¯¹æ€§çš„æ¸—é€æµ‹è¯•è®¿é—®å†…éƒ¨ç½‘ç»œçš„æ½œåŠ›ã€‚æ­£ç¡®ä¿æŠ¤SAPè·¯ç”±å™¨å¹¶äº†è§£å®ƒä»¬åœ¨ç½‘ç»œå®‰å…¨æ¶æ„ä¸­çš„ä½œç”¨å¯¹äºé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®è‡³å…³é‡è¦ã€‚

è¦è·å–æœ‰å…³Metasploitæ¨¡å—åŠå…¶ç”¨æ³•çš„æ›´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®[Rapid7çš„æ•°æ®åº“](http://www.rapid7.com/db)ã€‚


## **å‚è€ƒèµ„æ–™**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
