{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
This is a summary of the post from [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)

## Understanding SAProuter Penetration with Metasploit

SAProuterëŠ” SAP ì‹œìŠ¤í…œì„ ìœ„í•œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì—­í• ì„ í•˜ë©°, ì£¼ë¡œ ì¸í„°ë„·ê³¼ ë‚´ë¶€ SAP ë„¤íŠ¸ì›Œí¬ ê°„ì˜ ì ‘ê·¼ì„ ì œì–´í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ TCP í¬íŠ¸ 3299ë¥¼ í†µí•´ ì¡°ì§ì˜ ë°©í™”ë²½ì„ í†µê³¼í•˜ì—¬ ì¸í„°ë„·ì— ë…¸ì¶œë©ë‹ˆë‹¤. ì´ ì„¤ì •ì€ SAProuterë¥¼ ê³ ê°€ì¹˜ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•œ ê²Œì´íŠ¸ì›¨ì´ ì—­í• ì„ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ì˜ ë§¤ë ¥ì ì¸ ëª©í‘œë¡œ ë§Œë“­ë‹ˆë‹¤.

**Scanning and Information Gathering**

ì´ˆê¸°ì—ëŠ” **sap_service_discovery** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ì£¼ì–´ì§„ IPì—ì„œ SAP ë¼ìš°í„°ê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ ì‹ë³„í•˜ê¸° ìœ„í•´ ìŠ¤ìº”ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” SAP ë¼ìš°í„°ì˜ ì¡´ì¬ì™€ ì—´ë¦° í¬íŠ¸ë¥¼ í™•ì¸í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
ë°œê²¬ í›„, **sap_router_info_request** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ SAP ë¼ìš°í„°ì˜ êµ¬ì„±ì— ëŒ€í•œ ì¶”ê°€ ì¡°ì‚¬ê°€ ìˆ˜í–‰ë˜ì–´ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ì„¸ë¶€ì •ë³´ë¥¼ ì ì¬ì ìœ¼ë¡œ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**ë‚´ë¶€ ì„œë¹„ìŠ¤ ì—´ê±°í•˜ê¸°**

íšë“í•œ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ í†µì°°ë ¥ì„ ë°”íƒ•ìœ¼ë¡œ, **sap_router_portscanner** ëª¨ë“ˆì€ SAProuterë¥¼ í†µí•´ ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ì™€ ì„œë¹„ìŠ¤ë¥¼ íƒìƒ‰í•˜ì—¬ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ë° ì„œë¹„ìŠ¤ êµ¬ì„±ì— ëŒ€í•œ ë” ê¹Šì€ ì´í•´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
ì´ ëª¨ë“ˆì€ íŠ¹ì • SAP ì¸ìŠ¤í„´ìŠ¤ì™€ í¬íŠ¸ë¥¼ íƒ€ê²ŸíŒ…í•˜ëŠ” ìœ ì—°ì„± ë•ë¶„ì— ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ íƒìƒ‰ì— íš¨ê³¼ì ì¸ ë„êµ¬ì…ë‹ˆë‹¤.

**ê³ ê¸‰ ì—´ê±° ë° ACL ë§¤í•‘**

ì¶”ê°€ ìŠ¤ìº”ì„ í†µí•´ SAProuterì—ì„œ ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡(ACL)ì´ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€, ì–´ë–¤ ì—°ê²°ì´ í—ˆìš©ë˜ê±°ë‚˜ ì°¨ë‹¨ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ëŠ” ë³´ì•ˆ ì •ì±…ê³¼ ì ì¬ì  ì·¨ì•½ì ì„ ì´í•´í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ì˜ ë¸”ë¼ì¸ë“œ ì—´ê±°**

SAProuterì—ì„œ ì§ì ‘ ì •ë³´ê°€ ì œí•œëœ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ë¸”ë¼ì¸ë“œ ì—´ê±°ì™€ ê°™ì€ ê¸°ìˆ ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì˜ ì¡´ì¬ë¥¼ ì¶”ì¸¡í•˜ê³  ê²€ì¦í•˜ì—¬ ì§ì ‘ IP ì£¼ì†Œ ì—†ì´ ì ì¬ì ì¸ ëŒ€ìƒì„ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.

**ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì •ë³´ í™œìš©**

ë„¤íŠ¸ì›Œí¬ë¥¼ ë§¤í•‘í•˜ê³  ì ‘ê·¼ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ë¥¼ ì‹ë³„í•œ í›„, ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ìëŠ” Metasploitì˜ í”„ë¡ì‹œ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ SAProuterë¥¼ í†µí•´ ë‚´ë¶€ SAP ì„œë¹„ìŠ¤ì˜ ì¶”ê°€ íƒìƒ‰ ë° ì•…ìš©ì„ ìœ„í•´ í”¼ë²—í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**ê²°ë¡ **

ì´ ì ‘ê·¼ ë°©ì‹ì€ ì•ˆì „í•œ SAProuter êµ¬ì„±ì˜ ì¤‘ìš”ì„±ì„ ê°•ì¡°í•˜ê³ , ëª©í‘œ ì§€í–¥ì ì¸ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ë¶€ê°ì‹œí‚µë‹ˆë‹¤. SAP ë¼ìš°í„°ë¥¼ ì ì ˆíˆ ë³´í˜¸í•˜ê³  ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì•„í‚¤í…ì²˜ì—ì„œì˜ ì—­í• ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ë¬´ë‹¨ ì ‘ê·¼ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

Metasploit ëª¨ë“ˆ ë° ì‚¬ìš©ë²•ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [Rapid7ì˜ ë°ì´í„°ë² ì´ìŠ¤](http://www.rapid7.com/db)ë¥¼ ë°©ë¬¸í•˜ì„¸ìš”.


## **ì°¸ê³ ë¬¸í—Œ**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
