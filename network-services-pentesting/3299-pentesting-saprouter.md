{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
This is a summary of the post from [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)

## Razumevanje penetracije SAProuter-a sa Metasploit-om

SAProuter deluje kao obrnuti proxy za SAP sisteme, prvenstveno za kontrolu pristupa izme캠u interneta i unutra코njih SAP mre쬬. Obi캜no je izlo쬰n internetu omogu캖avanjem TCP porta 3299 kroz organizacione vatrozidove. Ova postavka 캜ini SAProuter privla캜nom metom za pentesting jer mo쬰 poslu쬴ti kao prolaz ka mre쬬ma visoke vrednosti.

**Skener i prikupljanje informacija**

U po캜etku se vr코i skeniranje kako bi se utvrdilo da li SAP router radi na datoj IP adresi koriste캖i **sap_service_discovery** modul. Ovaj korak je klju캜an za utvr캠ivanje prisustva SAP router-a i njegovog otvorenog porta.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Nakon otkri캖a, vr코i se dalja istraga konfiguracije SAP rutera pomo캖u **sap_router_info_request** modula kako bi se potencijalno otkrili detalji interne mre쬰.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Enumerating Internal Services**

Sa dobijenim uvidima u unutra코nju mre쬿, **sap_router_portscanner** modul se koristi za ispitivanje unutra코njih hostova i usluga putem SAProuter-a, omogu캖avaju캖i dublje razumevanje unutra코njih mre쬬 i konfiguracija usluga.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Ova fleksibilnost modula u ciljanju specifi캜nih SAP instanci i portova 캜ini ga efikasnim alatom za detaljno istra쬴vanje interne mre쬰.

**Napredno enumerisanje i mapiranje ACL-a**

Dalje skeniranje mo쬰 otkriti kako su liste za kontrolu pristupa (ACL) konfigurisane na SAProuter-u, detaljno prikazuju캖i koje su veze dozvoljene ili blokirane. Ove informacije su klju캜ne za razumevanje bezbednosnih politika i potencijalnih ranjivosti.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Blind Enumeration of Internal Hosts**

U scenarijima gde su direktne informacije iz SAProuter-a ograni캜ene, tehnike poput slepe enumeracije mogu se primeniti. Ovaj pristup poku코ava da pogodi i verifikuje postojanje internih imena hostova, otkrivaju캖i potencijalne mete bez direktnih IP adresa.

**Leveraging Information for Penetration Testing**

Nakon 코to su mapirali mre쬿 i identifikovali dostupne usluge, pen-testeri mogu iskoristiti proxy mogu캖nosti Metasploit-a da se prebacuju kroz SAProuter za dalju eksploraciju i eksploataciju internih SAP usluga.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Zaklju캜ak**

Ovaj pristup nagla코ava va쬹ost sigurnih konfiguracija SAProuter-a i isti캜e potencijal za pristup unutra코njim mre쬬ma kroz ciljani pentesting. Pravilno osiguranje SAP rutera i razumevanje njihove uloge u arhitekturi mre쬹e sigurnosti je klju캜no za za코titu od neovla코캖enog pristupa.

Za detaljnije informacije o Metasploit modulima i njihovoj upotrebi, posetite [Rapid7-ovu bazu podataka](http://www.rapid7.com/db).

## **Reference**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
