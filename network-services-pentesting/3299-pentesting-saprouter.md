{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
è¿™æ˜¯æ¥è‡ª [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/) çš„å¸–å­æ‘˜è¦


## ä½¿ç”¨ Metasploit ç†è§£ SAProuter æ¸—é€

SAProuter å……å½“ SAP ç³»ç»Ÿçš„åå‘ä»£ç†ï¼Œä¸»è¦ç”¨äºæ§åˆ¶äº’è”ç½‘ä¸å†…éƒ¨ SAP ç½‘ç»œä¹‹é—´çš„è®¿é—®ã€‚å®ƒé€šå¸¸é€šè¿‡å…è®¸ TCP ç«¯å£ 3299 é€šè¿‡ç»„ç»‡é˜²ç«å¢™è€Œæš´éœ²äºäº’è”ç½‘ã€‚è¿™ç§è®¾ç½®ä½¿ SAProuter æˆä¸ºæ¸—é€æµ‹è¯•çš„ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„ç›®æ ‡ï¼Œå› ä¸ºå®ƒå¯èƒ½ä½œä¸ºé«˜ä»·å€¼å†…éƒ¨ç½‘ç»œçš„ç½‘å…³ã€‚

**æ‰«æå’Œä¿¡æ¯æ”¶é›†**

æœ€åˆï¼Œä½¿ç”¨ **sap_service_discovery** æ¨¡å—è¿›è¡Œæ‰«æï¼Œä»¥ç¡®å®šç»™å®š IP ä¸Šæ˜¯å¦è¿è¡Œ SAP è·¯ç”±å™¨ã€‚æ­¤æ­¥éª¤å¯¹äºç¡®è®¤ SAP è·¯ç”±å™¨åŠå…¶å¼€æ”¾ç«¯å£çš„å­˜åœ¨è‡³å…³é‡è¦ã€‚
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
åœ¨å‘ç°ä¹‹åï¼Œä½¿ç”¨ **sap_router_info_request** æ¨¡å—å¯¹ SAP è·¯ç”±å™¨çš„é…ç½®è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ï¼Œä»¥å¯èƒ½æ­ç¤ºå†…éƒ¨ç½‘ç»œç»†èŠ‚ã€‚
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**æšä¸¾å†…éƒ¨æœåŠ¡**

é€šè¿‡è·å¾—çš„å†…éƒ¨ç½‘ç»œæ´å¯Ÿï¼Œ**sap_router_portscanner**æ¨¡å—ç”¨äºé€šè¿‡SAProuteræ¢æµ‹å†…éƒ¨ä¸»æœºå’ŒæœåŠ¡ï¼Œä»è€Œæ›´æ·±å…¥åœ°äº†è§£å†…éƒ¨ç½‘ç»œå’ŒæœåŠ¡é…ç½®ã€‚
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
è¯¥æ¨¡å—åœ¨é’ˆå¯¹ç‰¹å®šSAPå®ä¾‹å’Œç«¯å£æ–¹é¢çš„çµæ´»æ€§ä½¿å…¶æˆä¸ºè¿›è¡Œè¯¦ç»†å†…éƒ¨ç½‘ç»œæ¢ç´¢çš„æœ‰æ•ˆå·¥å…·ã€‚

**é«˜çº§æšä¸¾å’ŒACLæ˜ å°„**

è¿›ä¸€æ­¥æ‰«æå¯ä»¥æ­ç¤ºSAProuterä¸Šè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰çš„é…ç½®ï¼Œè¯¦ç»†è¯´æ˜å“ªäº›è¿æ¥è¢«å…è®¸æˆ–é˜»æ­¢ã€‚è¿™äº›ä¿¡æ¯å¯¹äºç†è§£å®‰å…¨ç­–ç•¥å’Œæ½œåœ¨æ¼æ´è‡³å…³é‡è¦ã€‚
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**ç›²ç›®æšä¸¾å†…éƒ¨ä¸»æœº**

åœ¨ä»SAProuterè·å–ç›´æ¥ä¿¡æ¯æœ‰é™çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åº”ç”¨ç›²ç›®æšä¸¾ç­‰æŠ€æœ¯ã€‚è¿™ç§æ–¹æ³•å°è¯•çŒœæµ‹å¹¶éªŒè¯å†…éƒ¨ä¸»æœºåçš„å­˜åœ¨ï¼Œæ­ç¤ºæ½œåœ¨ç›®æ ‡è€Œæ— éœ€ç›´æ¥çš„IPåœ°å€ã€‚

**åˆ©ç”¨ä¿¡æ¯è¿›è¡Œæ¸—é€æµ‹è¯•**

åœ¨æ˜ å°„ç½‘ç»œå¹¶è¯†åˆ«å¯è®¿é—®æœåŠ¡åï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥åˆ©ç”¨Metasploitçš„ä»£ç†åŠŸèƒ½ï¼Œé€šè¿‡SAProuterè¿›è¡Œè¿›ä¸€æ­¥çš„æ¢ç´¢å’Œå†…éƒ¨SAPæœåŠ¡çš„åˆ©ç”¨ã€‚
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**ç»“è®º**

è¿™ç§æ–¹æ³•å¼ºè°ƒäº†å®‰å…¨é…ç½®SAProuterçš„é‡è¦æ€§ï¼Œå¹¶çªå‡ºäº†é€šè¿‡æœ‰é’ˆå¯¹æ€§çš„æ¸—é€æµ‹è¯•è®¿é—®å†…éƒ¨ç½‘ç»œçš„æ½œåŠ›ã€‚å¦¥å–„ä¿æŠ¤SAPè·¯ç”±å™¨å¹¶ç†è§£å…¶åœ¨ç½‘ç»œå®‰å…¨æ¶æ„ä¸­çš„ä½œç”¨å¯¹äºé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®è‡³å…³é‡è¦ã€‚

æœ‰å…³Metasploitæ¨¡å—åŠå…¶ä½¿ç”¨çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®[Rapid7çš„æ•°æ®åº“](http://www.rapid7.com/db)ã€‚

## **å‚è€ƒæ–‡çŒ®**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



{% hint style="success" %}
å­¦ä¹ ä¸å®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
