{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
This is a summary of the post from [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)

## Metasploit ile SAProuter Penetrasyonu Anlamak

SAProuter, SAP sistemleri iÃ§in bir ters proxy olarak iÅŸlev gÃ¶rÃ¼r ve esasen internet ile dahili SAP aÄŸlarÄ± arasÄ±ndaki eriÅŸimi kontrol etmek iÃ§in kullanÄ±lÄ±r. Genellikle, organizasyonel gÃ¼venlik duvarlarÄ± aracÄ±lÄ±ÄŸÄ±yla TCP port 3299'Ã¼n aÃ§Ä±lmasÄ±yla internete maruz bÄ±rakÄ±lÄ±r. Bu yapÄ±, SAProuter'Ä± penetrasyon testi iÃ§in cazip bir hedef haline getirir Ã§Ã¼nkÃ¼ yÃ¼ksek deÄŸerli dahili aÄŸlara bir kapÄ± gÃ¶revi gÃ¶rebilir.

**Tarama ve Bilgi Toplama**

BaÅŸlangÄ±Ã§ta, belirli bir IP adresinde bir SAP yÃ¶nlendiricisinin Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± belirlemek iÃ§in **sap_service_discovery** modÃ¼lÃ¼ kullanÄ±larak bir tarama gerÃ§ekleÅŸtirilir. Bu adÄ±m, bir SAP yÃ¶nlendiricisinin varlÄ±ÄŸÄ±nÄ± ve aÃ§Ä±k portunu belirlemek iÃ§in kritik Ã¶neme sahiptir.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
KeÅŸiften sonra, **sap_router_info_request** modÃ¼lÃ¼ ile SAP yÃ¶nlendiricisinin yapÄ±landÄ±rmasÄ± hakkÄ±nda daha fazla araÅŸtÄ±rma yapÄ±lÄ±r ve bu, potansiyel olarak iÃ§ aÄŸ detaylarÄ±nÄ± ortaya Ã§Ä±karabilir.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Ä°Ã§ Hizmetlerin SayÄ±mÄ±**

Elde edilen iÃ§ aÄŸ bilgileriyle, **sap_router_portscanner** modÃ¼lÃ¼, SAProuter Ã¼zerinden iÃ§ hostlarÄ± ve hizmetleri sorgulamak iÃ§in kullanÄ±lÄ±r ve bu, iÃ§ aÄŸlar ve hizmet yapÄ±landÄ±rmalarÄ± hakkÄ±nda daha derin bir anlayÄ±ÅŸ saÄŸlar.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Bu modÃ¼lÃ¼n belirli SAP Ã¶rneklerine ve portlara hedefleme esnekliÄŸi, detaylÄ± iÃ§ aÄŸ keÅŸfi iÃ§in etkili bir araÃ§ olmasÄ±nÄ± saÄŸlar.

**GeliÅŸmiÅŸ SayÄ±m ve ACL Haritalama**

Daha fazla tarama, SAProuter Ã¼zerindeki EriÅŸim Kontrol Listelerinin (ACL) nasÄ±l yapÄ±landÄ±rÄ±ldÄ±ÄŸÄ±nÄ± ortaya Ã§Ä±karabilir ve hangi baÄŸlantÄ±larÄ±n izin verildiÄŸini veya engellendiÄŸini detaylandÄ±rabilir. Bu bilgi, gÃ¼venlik politikalarÄ±nÄ± ve potansiyel zayÄ±flÄ±klarÄ± anlamada kritik Ã¶neme sahiptir.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Ä°Ã§ HostlarÄ±n KayÄ±t DÄ±ÅŸÄ± SayÄ±mÄ±**

SAProuter'dan doÄŸrudan bilgi sÄ±nÄ±rlÄ± olduÄŸunda, kayÄ±t dÄ±ÅŸÄ± sayÄ±m gibi teknikler uygulanabilir. Bu yaklaÅŸÄ±m, iÃ§ host adlarÄ±nÄ±n varlÄ±ÄŸÄ±nÄ± tahmin etmeye ve doÄŸrulamaya Ã§alÄ±ÅŸarak, doÄŸrudan IP adresleri olmadan potansiyel hedefleri ortaya Ã§Ä±karÄ±r.

**SÄ±zma Testi Ä°Ã§in Bilgiyi Kullanma**

AÄŸÄ± haritaladÄ±ktan ve eriÅŸilebilir hizmetleri belirledikten sonra, sÄ±zma test uzmanlarÄ± Metasploit'in proxy yeteneklerini kullanarak SAProuter Ã¼zerinden iÃ§ SAP hizmetlerinin daha fazla keÅŸfi ve istismarÄ± iÃ§in geÃ§iÅŸ yapabilirler.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**SonuÃ§**

Bu yaklaÅŸÄ±m, gÃ¼venli SAProuter yapÄ±landÄ±rmalarÄ±nÄ±n Ã¶nemini vurgular ve hedefli pentesting ile iÃ§ aÄŸlara eriÅŸim potansiyelini Ã¶ne Ã§Ä±karÄ±r. SAP yÃ¶nlendiricilerini doÄŸru bir ÅŸekilde gÃ¼vence altÄ±na almak ve aÄŸ gÃ¼venliÄŸi mimarisindeki rollerini anlamak, yetkisiz eriÅŸime karÅŸÄ± korunmak iÃ§in kritik Ã¶neme sahiptir.

Metasploit modÃ¼lleri ve bunlarÄ±n kullanÄ±mÄ± hakkÄ±nda daha ayrÄ±ntÄ±lÄ± bilgi iÃ§in [Rapid7'nin veritabanÄ±nÄ±](http://www.rapid7.com/db) ziyaret edin.


## **Kaynaklar**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
