<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì„ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## Metasploitì„ ì‚¬ìš©í•œ SAProuter ì¹¨íˆ¬ ì´í•´í•˜ê¸°

SAProuterëŠ” ì£¼ë¡œ ì¸í„°ë„·ê³¼ ë‚´ë¶€ SAP ë„¤íŠ¸ì›Œí¬ ê°„ì˜ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´í•˜ê¸° ìœ„í•´ SAP ì‹œìŠ¤í…œì— ëŒ€í•œ ì—­ë°©í–¥ í”„ë¡ì‹œë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì¡°ì§ ë°©í™”ë²½ì„ í†µí•´ TCP í¬íŠ¸ 3299ë¥¼ í—ˆìš©í•˜ì—¬ ì¸í„°ë„·ì— ë…¸ì¶œë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì„¤ì •ìœ¼ë¡œ ì¸í•´ SAProuterëŠ” ê³ ê°€ì¹˜ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¡œì˜ ê²Œì´íŠ¸ì›¨ì´ë¡œ ì‘ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— íœí…ŒìŠ¤íŒ…ì˜ ë§¤ë ¥ì ì¸ ëŒ€ìƒì´ ë©ë‹ˆë‹¤.

**ìŠ¤ìºë‹ ë° ì •ë³´ ìˆ˜ì§‘**

ë¨¼ì €, **sap_service_discovery** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ì£¼ì–´ì§„ IPì—ì„œ SAP ë¼ìš°í„°ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ ì—¬ë¶€ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•´ ìŠ¤ìº”ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” SAP ë¼ìš°í„°ì˜ ì¡´ì¬ì™€ ì—´ë¦° í¬íŠ¸ë¥¼ í™•ì¸í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
ë‹¤ìŒìœ¼ë¡œ, SAP ë¼ìš°í„°ì˜ êµ¬ì„±ì— ëŒ€í•œ ì¶”ê°€ ì¡°ì‚¬ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤. ì´ëŠ” ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ì„¸ë¶€ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìˆëŠ” **sap_router_info_request** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**ë‚´ë¶€ ì„œë¹„ìŠ¤ ì—´ê±°**

íšë“í•œ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ, **sap_router_portscanner** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ SAProuterë¥¼ í†µí•´ ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ì™€ ì„œë¹„ìŠ¤ë¥¼ ì¡°ì‚¬í•˜ì—¬ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì™€ ì„œë¹„ìŠ¤ êµ¬ì„±ì— ëŒ€í•œ ê¹Šì€ ì´í•´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
ì´ ëª¨ë“ˆì€ íŠ¹ì • SAP ì¸ìŠ¤í„´ìŠ¤ì™€ í¬íŠ¸ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ìœ ì—°ì„±ìœ¼ë¡œ ì¸í•´ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¥¼ ìì„¸íˆ íƒìƒ‰í•˜ëŠ” ë° íš¨ê³¼ì ì¸ ë„êµ¬ì…ë‹ˆë‹¤.

**ê³ ê¸‰ ì—´ê±° ë° ACL ë§¤í•‘**

ì¶”ê°€ ìŠ¤ìºë‹ì„ í†µí•´ SAProuterì—ì„œ ì–´ë–»ê²Œ ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡(ACL)ì´ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ì—°ê²°ì´ í—ˆìš©ë˜ê±°ë‚˜ ì°¨ë‹¨ë˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ìƒì„¸íˆ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ëŠ” ë³´ì•ˆ ì •ì±…ê³¼ ì ì¬ì ì¸ ì·¨ì•½ì ì„ ì´í•´í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ì˜ ë¸”ë¼ì¸ë“œ ì—´ê±°**

SAProuterë¡œë¶€í„° ì§ì ‘ì ì¸ ì •ë³´ê°€ ì œí•œëœ ê²½ìš°, ë¸”ë¼ì¸ë“œ ì—´ê±°ì™€ ê°™ì€ ê¸°ìˆ ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì¶”ì¸¡í•˜ê³  í™•ì¸í•˜ì—¬ ì§ì ‘ì ì¸ IP ì£¼ì†Œ ì—†ì´ ì ì¬ì ì¸ ëŒ€ìƒì„ ë°í˜€ëƒ…ë‹ˆë‹¤.

**íœíŠ¸ìŠ¤íŒ…ì„ ìœ„í•œ ì •ë³´ í™œìš©**

ë„¤íŠ¸ì›Œí¬ë¥¼ ë§¤í•‘í•˜ê³  ì ‘ê·¼ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ë¥¼ ì‹ë³„í•œ í›„, íœíŠ¸ìŠ¤í„°ëŠ” Metasploitì˜ í”„ë¡ì‹œ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ SAProuterë¥¼ í†µí•´ ë‚´ë¶€ SAP ì„œë¹„ìŠ¤ì˜ ì¶”ê°€ì ì¸ íƒìƒ‰ê³¼ ì•…ìš©ì„ ìœ„í•œ í”¼ë²—ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**ê²°ë¡ **

ì´ ì ‘ê·¼ ë°©ì‹ì€ ì•ˆì „í•œ SAProuter êµ¬ì„±ì˜ ì¤‘ìš”ì„±ì„ ê°•ì¡°í•˜ë©°, ëŒ€ìƒí™”ëœ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì ì¬ë ¥ì„ ê°•ì¡°í•©ë‹ˆë‹¤. SAP ë¼ìš°í„°ë¥¼ ì ì ˆí•˜ê²Œ ë³´í˜¸í•˜ê³  ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì•„í‚¤í…ì²˜ì—ì„œì˜ ì—­í• ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ë¬´ë‹¨ ì ‘ê·¼ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ê¸° ìœ„í•´ ì¤‘ìš”í•©ë‹ˆë‹¤.

Metasploit ëª¨ë“ˆ ë° ì‚¬ìš©ë²•ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [Rapid7ì˜ ë°ì´í„°ë² ì´ìŠ¤](http://www.rapid7.com/db)ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.


## **ì°¸ê³  ìë£Œ**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* HackTricksì—ì„œ **íšŒì‚¬ ê´‘ê³ ë¥¼ ë³´ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… í”Œëœ**](https://github.com/sponsors/carlospolop)ì„ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
