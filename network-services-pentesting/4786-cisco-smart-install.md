# 4786 - Cisco Smart Install

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Grundinformationen

**Cisco Smart Install** ist ein von Cisco entwickeltes Tool zur Automatisierung der Erstkonfiguration und des Ladens eines Betriebssystem-Images f√ºr neue Cisco-Hardware. **Standardm√§√üig ist Cisco Smart Install auf Cisco-Hardware aktiv und verwendet das Transportprotokoll TCP mit der Portnummer 4786.**

**Standardport:** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Smart Install Exploitation Tool**

**Im Jahr 2018 wurde eine kritische Schwachstelle, CVE-2018‚Äì0171, in diesem Protokoll gefunden. Das Bedrohungsniveau liegt bei 9,8 auf der CVSS-Skala.**

**Ein speziell gestaltetes Paket, das an den TCP/4786-Port gesendet wird, an dem Cisco Smart Install aktiv ist, l√∂st einen Puffer√ºberlauf aus, der es einem Angreifer erm√∂glicht:**

* das Ger√§t zwangsweise neu zu starten
* RCE aufzurufen
* Konfigurationen von Netzwerkger√§ten zu stehlen.

**Das** [**SIET**](https://github.com/frostbits-security/SIET) **(Smart Install Exploitation Tool)** wurde entwickelt, um diese Schwachstelle auszunutzen, es erm√∂glicht Ihnen, Cisco Smart Install zu missbrauchen. In diesem Artikel zeige ich Ihnen, wie Sie eine legitime Konfigurationsdatei f√ºr Netzwerkhardware lesen k√∂nnen. Die Konfigurationsexfiltration kann f√ºr einen Pentester wertvoll sein, da er √ºber die einzigartigen Merkmale des Netzwerks lernt. Und das wird das Leben erleichtern und neue Angriffsvektoren finden.

**Das Zielger√§t wird ein ‚Äûlebendiger‚Äú Cisco Catalyst 2960 Switch sein. Virtuelle Images haben kein Cisco Smart Install, daher k√∂nnen Sie nur auf der echten Hardware √ºben.**

Die Adresse des Ziel-Switches ist **10.10.100.10 und CSI ist aktiv.** Laden Sie SIET und starten Sie den Angriff. **Das -g Argument** bedeutet Exfiltration der Konfiguration vom Ger√§t, **das -i Argument** erm√∂glicht es Ihnen, die IP-Adresse des verwundbaren Ziels festzulegen.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../.gitbook/assets/image (773).png" alt=""><figcaption></figcaption></figure>

Die Switch-Konfiguration **10.10.100.10** wird im **tftp/**-Ordner sein

<figure><img src="../.gitbook/assets/image (1116).png" alt=""><figcaption></figcaption></figure>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
