# 4840 - Pentesting OPC UA

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**OPC UA**, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ **Open Platform Communications Unified Access**, рд╡рд┐рднрд┐рдиреНрди рдЙрджреНрдпреЛрдЧреЛрдВ рдЬреИрд╕реЗ рдирд┐рд░реНрдорд╛рдг, рдКрд░реНрдЬрд╛, рдПрдпрд░реЛрд╕реНрдкреЗрд╕, рдФрд░ рд░рдХреНрд╖рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рд╡рд┐рдирд┐рдордп рдФрд░ рдЙрдкрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдУрдкрди-рд╕реЛрд░реНрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ PLCs рдХреЗ рд╕рд╛рдеред

рдЗрд╕рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░, рдкреБрд░рд╛рдиреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рдЗрдиреНрд╣реЗрдВ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдЬреЛрдЦрд┐рдо рдореЗрдВ рдкрдбрд╝ рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, OPC UA рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреИрдирд░ рдЙрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рди рдирд╣реАрдВ рд╕рдХрддреЗ рдпрджрд┐ рд╡реЗ рдЧреИрд░-рдорд╛рдирдХ рдкреЛрд░реНрдЯ рдкрд░ рд╣реИрдВред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

OPC UA рд╕рд░реНрд╡рд░реЛрдВ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ [OpalOPC](https://opalopc.com/) рдХреЗ рд╕рд╛рде рд╕реНрдХреИрди рдХрд░реЗрдВред
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдирд╛

рдпрджрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдИрдкрд╛рд╕ рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдкрд╛рдИ рдЬрд╛рддреА рд╣реИрдВ, рддреЛ рдЖрдк рдПрдХ [OPC UA рдХреНрд▓рд╛рдЗрдВрдЯ](https://www.prosysopc.com/products/opc-ua-browser/) рдХреЛ рддрджрдиреБрд╕рд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХреНрдпрд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдорд╛рдиреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рднрд╛рд░реА рдФрджреНрдпреЛрдЧрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рддрдХ рдХреБрдЫ рднреА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред

рдЬрд┐рд╕ рдбрд┐рд╡рд╛рдЗрд╕ рддрдХ рдЖрдкрдХреА рдкрд╣реБрдБрдЪ рд╣реИ, рдЙрд╕рдХрд╛ рд╕рдВрдХреЗрдд рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрддреЗ рдХреА рдЬрдЧрд╣ рдореЗрдВ "ServerStatus" рдиреЛрдб рдорд╛рдиреЛрдВ рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рдЙрдкрдпреЛрдЧ рдореИрдиреБрдЕрд▓ рдХреЗ рд▓рд┐рдП рдЧреВрдЧрд▓ рдХрд░реЗрдВред

## рд╢реЛрдбрди

* `port:4840`

## рд╕рдВрджрд░реНрдн

* [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
