# 4840 - Pentesting OPC UA

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

**OPC UA**ï¼Œä»£è¡¨**å¼€æ”¾å¹³å°é€šä¿¡ç»Ÿä¸€è®¿é—®**ï¼Œæ˜¯ä¸€ä¸ªå…³é”®çš„å¼€æºåè®®ï¼Œç”¨äºåˆ¶é€ ä¸šã€èƒ½æºã€èˆªç©ºèˆªå¤©å’Œå›½é˜²ç­‰å„è¡Œä¸šçš„æ•°æ®äº¤æ¢å’Œè®¾å¤‡æ§åˆ¶ã€‚å®ƒç‹¬ç‰¹åœ°å®ç°äº†ä¸åŒä¾›åº”å•†è®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œç‰¹åˆ«æ˜¯ä¸å¯ç¼–ç¨‹é€»è¾‘æ§åˆ¶å™¨ï¼ˆPLCsï¼‰çš„é€šä¿¡ã€‚

å…¶é…ç½®å…è®¸é‡‡å–å¼ºå¤§çš„å®‰å…¨æªæ–½ï¼Œä½†é€šå¸¸ä¸ºäº†ä¸æ—§è®¾å¤‡å…¼å®¹ï¼Œè¿™äº›æªæ–½ä¼šå‡å¼±ï¼Œä»è€Œä½¿ç³»ç»Ÿé¢ä¸´é£é™©ã€‚æ­¤å¤–ï¼Œå‘ç°OPC UAæœåŠ¡å¯èƒ½æœ‰äº›æ£˜æ‰‹ï¼Œå› ä¸ºç½‘ç»œæ‰«æå·¥å…·å¯èƒ½æ— æ³•æ£€æµ‹åˆ°å®ƒä»¬ï¼Œç‰¹åˆ«æ˜¯å½“å®ƒä»¬ä½äºéæ ‡å‡†ç«¯å£ä¸Šæ—¶ã€‚

**é»˜è®¤ç«¯å£ï¼š** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## OPC UA æ¸—é€æµ‹è¯•

è¦æ­ç¤º OPC UA æœåŠ¡å™¨ä¸­çš„å®‰å…¨é—®é¢˜ï¼Œè¯·ä½¿ç”¨[OpalOPC](https://opalopc.com/)è¿›è¡Œæ‰«æã€‚
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### åˆ©ç”¨æ¼æ´

å¦‚æœå‘ç°èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œæ‚¨å¯ä»¥ç›¸åº”åœ°é…ç½®ä¸€ä¸ª[OPC UAå®¢æˆ·ç«¯](https://www.prosysopc.com/products/opc-ua-browser/)ï¼ŒæŸ¥çœ‹æ‚¨å¯ä»¥è®¿é—®çš„å†…å®¹ã€‚è¿™å¯èƒ½å…è®¸æ‚¨ä»ä»…ä»…è¯»å–è¿‡ç¨‹å€¼åˆ°å®é™…æ“ä½œé‡å‹å·¥ä¸šè®¾å¤‡ã€‚

è¦äº†è§£æ‚¨å¯ä»¥è®¿é—®çš„è®¾å¤‡çš„çº¿ç´¢ï¼Œè¯·é˜…è¯»åœ°å€ç©ºé—´ä¸­çš„â€œServerStatusâ€èŠ‚ç‚¹å€¼ï¼Œå¹¶æœç´¢ä½¿ç”¨æ‰‹å†Œã€‚

## Shodan

* `port:4840`

## å‚è€ƒèµ„æ–™

* [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
