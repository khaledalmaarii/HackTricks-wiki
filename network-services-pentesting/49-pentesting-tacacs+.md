# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ  (TACACS)** ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚µãƒ¼ãƒãƒ¼ (NAS) ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸­å¤®ã§æ¤œè¨¼ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ãã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç‰ˆã§ã‚ã‚‹ **TACACS+** ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’èªè¨¼ã€æ‰¿èªã€ãŠã‚ˆã³ä¼šè¨ˆ (AAA) ã«åˆ†é›¢ã—ã¾ã™ã€‚
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 49

## èªè¨¼ã‚­ãƒ¼ã®å‚å—

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨TACACSã‚µãƒ¼ãƒãƒ¼ã®é€šä¿¡ãŒæ”»æ’ƒè€…ã«ã‚ˆã£ã¦å‚å—ã•ã‚Œã‚‹ã¨ã€**æš—å·åŒ–ã•ã‚ŒãŸèªè¨¼ã‚­ãƒ¼ãŒå‚å—ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™**ã€‚æ”»æ’ƒè€…ã¯ã€**ãƒ­ã‚°ã«æ¤œå‡ºã•ã‚Œã‚‹ã“ã¨ãªãã‚­ãƒ¼ã«å¯¾ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚ã‚­ãƒ¼ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã«æˆåŠŸã™ã‚Œã°ã€æ”»æ’ƒè€…ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€Wiresharkã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å¾©å·åŒ–ã§ãã¾ã™ã€‚

### MitMæ”»æ’ƒã®å®Ÿè¡Œ

**ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°æ”»æ’ƒã‚’åˆ©ç”¨ã—ã¦Man-in-the-Middle (MitM)æ”»æ’ƒã‚’å®Ÿè¡Œã§ãã¾ã™**ã€‚

### ã‚­ãƒ¼ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/)ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã§ãã¾ã™:
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**é€šå¸¸ã¯MD5æš—å·åŒ–å½¢å¼ã§**)ã€**æ©Ÿå™¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€TACACSæš—å·åŒ–ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å¾©å·åŒ–ã§ãã¾ã™ã€‚**

### ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®å¾©å·åŒ–
ã‚­ãƒ¼ãŒæˆåŠŸè£ã«è§£èª­ã•ã‚Œã‚‹ã¨ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯**TACACSæš—å·åŒ–ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å¾©å·åŒ–ã™ã‚‹ã“ã¨**ã§ã™ã€‚Wiresharkã¯ã€ã‚­ãƒ¼ãŒæä¾›ã•ã‚Œã‚Œã°æš—å·åŒ–ã•ã‚ŒãŸTACACSãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å‡¦ç†ã§ãã¾ã™ã€‚å¾©å·åŒ–ã•ã‚ŒãŸãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æã™ã‚‹ã“ã¨ã§ã€**ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒŠãƒ¼ã‚„ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ãªã©ã®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ã€‚

å–å¾—ã—ãŸè³‡æ ¼æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ã€æ”»æ’ƒè€…ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¡Œå‹•ã¯æ•™è‚²ç›®çš„ã®ãŸã‚ã«å³å¯†ã«è¡Œã‚ã‚Œã‚‹ã¹ãã§ã‚ã‚Šã€é©åˆ‡ãªæ‰¿èªãªã—ã«ä½¿ç”¨ã•ã‚Œã‚‹ã¹ãã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
