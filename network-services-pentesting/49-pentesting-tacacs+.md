# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Î¤Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ **Terminal Access Controller Access Control System (TACACS)** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ ÎºÎµÎ½Ï„ÏÎ¹ÎºÎ® ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î¿ÏÎ½ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î´ÏÎ¿Î¼Î¿Î»Î¿Î³Î·Ï„Î­Ï‚ Î® Î”Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î”Î¹ÎºÏ„ÏÎ¿Ï… (NAS). Î— Î±Î½Î±Î²Î±Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î· Î­ÎºÎ´Î¿ÏƒÎ® Ï„Î¿Ï…, **TACACS+**, Î´Î¹Î±Ï‡Ï‰ÏÎ¯Î¶ÎµÎ¹ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÏƒÎµ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·, ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´ÏŒÏ„Î·ÏƒÎ· ÎºÎ±Î¹ Î»Î¿Î³Î¹ÏƒÏ„Î¹ÎºÎ® (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Default port:** 49

## Intercept Authentication Key

Î•Î¬Î½ Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Ï„Î¿Ï… Ï€ÎµÎ»Î¬Ï„Î· ÎºÎ±Î¹ Ï„Î¿Ï… TACACS server Ï€Î±ÏÎµÎ¼Î²Î»Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿, Ï„Î¿ **ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎµÎ¼Î²Î»Î·Î¸ÎµÎ¯**. ÎŸ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î¼Î¹Î± **Ï„Î¿Ï€Î¹ÎºÎ® ÎµÏ€Î¯Î¸ÎµÏƒÎ· brute-force ÎºÎ±Ï„Î¬ Ï„Î¿Ï… ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î±Î½Î¹Ï‡Î½ÎµÏ…Î¸ÎµÎ¯ ÏƒÏ„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚**. Î•Î¬Î½ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¹Ï„Ï…Ï‡Î®Ï‚ ÏƒÏ„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· brute-force Ï„Î¿Ï… ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î±Ï€Î¿ÎºÏ„Î¬ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ Î´Î¹ÎºÏ„Ï…Î±ÎºÏŒ ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼ÏŒ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Wireshark.

### Performing a MitM Attack

ÎœÎ¹Î± **ÎµÏ€Î¯Î¸ÎµÏƒÎ· spoofing ARP Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· Man-in-the-Middle (MitM)**.

### Brute-forcing the Key

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÎ¹ brute force Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯:
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**usually in MD5 encrypted format)**, **we can access the equipment and decrypt the TACACS-encrypted traffic.**

### Decrypting Traffic
Once the key is successfully cracked, the next step is to **decrypt the TACACS-encrypted traffic**. Wireshark can handle encrypted TACACS traffic if the key is provided. By analyzing the decrypted traffic, information such as the **banner used and the username of the admin** user can be obtained.

By gaining access to the control panel of network equipment using the obtained credentials, the attacker can exert control over the network. It's important to note that these actions are strictly for educational purposes and should not be used without proper authorization.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
