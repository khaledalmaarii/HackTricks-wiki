# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## ê¸°ë³¸ ì •ë³´

**ë‹¨ë§ê¸° ì ‘ê·¼ ì œì–´ê¸° ì ‘ê·¼ ì œì–´ ì‹œìŠ¤í…œ (TACACS)** í”„ë¡œí† ì½œì€ ë¼ìš°í„°ë‚˜ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ì„œë²„(NAS)ì— ì ‘ê·¼í•˜ë ¤ëŠ” ì‚¬ìš©ìë¥¼ ì¤‘ì•™ì—ì„œ ê²€ì¦í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì—…ê·¸ë ˆì´ë“œëœ ë²„ì „ì¸ **TACACS+**ëŠ” ì¸ì¦, ê¶Œí•œ ë¶€ì—¬ ë° íšŒê³„(AAA) ì„œë¹„ìŠ¤ë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**ê¸°ë³¸ í¬íŠ¸:** 49

## ì¸ì¦ í‚¤ ê°€ë¡œì±„ê¸°

í´ë¼ì´ì–¸íŠ¸ì™€ TACACS ì„œë²„ ê°„ì˜ í†µì‹ ì´ ê³µê²©ìì— ì˜í•´ ê°€ë¡œì±„ì–´ì§€ë©´, **ì•”í˜¸í™”ëœ ì¸ì¦ í‚¤ë¥¼ ê°€ë¡œì±Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ê³µê²©ìëŠ” **ë¡œê·¸ì— ê°ì§€ë˜ì§€ ì•Šê³  í‚¤ì— ëŒ€í•´ ë¡œì»¬ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì„ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. í‚¤ë¥¼ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ìœ¼ë¡œ ì„±ê³µì ìœ¼ë¡œ í•´ë…í•˜ë©´, ê³µê²©ìëŠ” ë„¤íŠ¸ì›Œí¬ ì¥ë¹„ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©° Wiresharkì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ë˜í”½ì„ ë³µí˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### MitM ê³µê²© ìˆ˜í–‰

**ARP ìŠ¤í‘¸í•‘ ê³µê²©ì„ ì´ìš©í•˜ì—¬ ì¤‘ê°„ì(MitM) ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

### í‚¤ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/)ë¥¼ ì‚¬ìš©í•˜ì—¬ í‚¤ë¥¼ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**usually in MD5 encrypted format)**, **we can access the equipment and decrypt the TACACS-encrypted traffic.**

### Decrypting Traffic
Once the key is successfully cracked, the next step is to **decrypt the TACACS-encrypted traffic**. Wireshark can handle encrypted TACACS traffic if the key is provided. By analyzing the decrypted traffic, information such as the **banner used and the username of the admin** user can be obtained.

By gaining access to the control panel of network equipment using the obtained credentials, the attacker can exert control over the network. It's important to note that these actions are strictly for educational purposes and should not be used without proper authorization.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
