# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Podstawowe informacje

Protok贸 **Terminal Access Controller Access Control System (TACACS)** jest u偶ywany do centralnej weryfikacji u偶ytkownik贸w pr贸bujcych uzyska dostp do router贸w lub serwer贸w dostpu do sieci (NAS). Jego ulepszona wersja, **TACACS+**, dzieli usugi na uwierzytelnianie, autoryzacj i rozliczanie (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Domylny port:** 49

## Przechwycenie klucza uwierzytelniajcego

Jeli komunikacja midzy klientem a serwerem TACACS jest przechwytywana przez atakujcego, **szyfrowany klucz uwierzytelniajcy mo偶e zosta przechwycony**. Atakujcy mo偶e nastpnie spr贸bowa **lokalnego ataku brute-force na klucz bez bycia wykrytym w logach**. Jeli uda mu si zama klucz, zyskuje dostp do sprztu sieciowego i mo偶e odszyfrowa ruch za pomoc narzdzi takich jak Wireshark.

### Wykonywanie ataku MitM

**Atak spoofingowy ARP mo偶e by wykorzystany do przeprowadzenia ataku Man-in-the-Middle (MitM)**.

### amanie klucza

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) mo偶e by u偶yty do amania klucza:
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**usually in MD5 encrypted format)**, **mo偶emy uzyska dostp do urzdzenia i odszyfrowa ruch zaszyfrowany TACACS.**

### Decrypting Traffic
Once the key is successfully cracked, the next step is to **odszyfrowa ruch zaszyfrowany TACACS**. Wireshark mo偶e obsugiwa zaszyfrowany ruch TACACS, jeli klucz jest podany. Analizujc odszyfrowany ruch, mo偶na uzyska informacje takie jak **u偶ywana baner i nazwa u偶ytkownika admina**.

By gaining access to the control panel of network equipment using the obtained credentials, the attacker can exert control over the network. It's important to note that these actions are strictly for educational purposes and should not be used without proper authorization.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
