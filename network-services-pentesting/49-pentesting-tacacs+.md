# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## Informa√ß√µes B√°sicas

O protocolo **Terminal Access Controller Access Control System (TACACS)** √© usado para validar centralmente usu√°rios que tentam acessar roteadores ou Servidores de Acesso √† Rede (NAS). Sua vers√£o atualizada, **TACACS+**, separa os servi√ßos em autentica√ß√£o, autoriza√ß√£o e contabilidade (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Porta padr√£o:** 49

## Interceptar a Chave de Autentica√ß√£o

Se a comunica√ß√£o entre o cliente e o servidor TACACS for interceptada por um atacante, a **chave de autentica√ß√£o criptografada pode ser interceptada**. O atacante pode ent√£o tentar um **ataque de for√ßa bruta local contra a chave sem ser detectado nos logs**. Se bem-sucedido em quebrar a chave, o atacante ganha acesso ao equipamento de rede e pode descriptografar o tr√°fego usando ferramentas como Wireshark.

### Realizando um Ataque MitM

Um **ataque de spoofing ARP pode ser utilizado para realizar um ataque Man-in-the-Middle (MitM)**.

### For√ßando a Chave

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) pode ser usado para for√ßar a chave:
```
sudo loki_gtk.py
```
Se a chave for **quebrada por for√ßa bruta** (**geralmente em formato MD5 criptografado**), **podemos acessar o equipamento e descriptografar o tr√°fego criptografado pelo TACACS.**

### Descriptografando o Tr√°fego
Uma vez que a chave √© quebrada com sucesso, o pr√≥ximo passo √© **descriptografar o tr√°fego criptografado pelo TACACS**. O Wireshark pode lidar com tr√°fego TACACS criptografado se a chave for fornecida. Ao analisar o tr√°fego descriptografado, informa√ß√µes como o **banner utilizado e o nome de usu√°rio do admin** podem ser obtidas.

Ao obter acesso ao painel de controle do equipamento de rede usando as credenciais obtidas, o atacante pode exercer controle sobre a rede. √â importante notar que essas a√ß√µes s√£o estritamente para fins educacionais e n√£o devem ser usadas sem a devida autoriza√ß√£o.

## Refer√™ncias

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-nos no** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
