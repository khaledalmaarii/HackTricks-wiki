# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Terminal Access Controller Access Control System (TACACS)** protokol se koristi za centralnu validaciju korisnika koji pokuÅ¡avaju da pristupe ruterima ili mreÅ¾nim pristupnim serverima (NAS). Njegova unapreÄ‘ena verzija, **TACACS+**, deli usluge na autentifikaciju, autorizaciju i obraÄun (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Podrazumevani port:** 49

## Presretanje autentifikacionog kljuÄa

Ako napadaÄ presretne komunikaciju izmeÄ‘u klijenta i TACACS servera, **kriptovani autentifikacioni kljuÄ moÅ¾e biti presretnut**. NapadaÄ moÅ¾e pokuÅ¡ati **lokalni napad silom protiv kljuÄa bez da bude otkriven u logovima**. Ako uspe u brute-forcing-u kljuÄa, napadaÄ dobija pristup mreÅ¾noj opremi i moÅ¾e dekriptovati saobraÄ‡aj koristeÄ‡i alate poput Wireshark.

### IzvoÄ‘enje MitM napada

**ARP spoofing napad se moÅ¾e iskoristiti za izvoÄ‘enje Man-in-the-Middle (MitM) napada**.

### Brute-forcing kljuÄa

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) se moÅ¾e koristiti za brute force kljuÄa:
```
sudo loki_gtk.py
```
Ako je kljuÄ uspeÅ¡no **bruteforced** (**obiÄno u MD5 enkriptovanom formatu**), **moÅ¾emo pristupiti opremi i dekriptovati TACACS-enkriptovani saobraÄ‡aj.**

### Dekriptovanje SaobraÄ‡aja
Kada je kljuÄ uspeÅ¡no otkriven, sledeÄ‡i korak je **dekriptovanje TACACS-enkriptovanog saobraÄ‡aja**. Wireshark moÅ¾e obraditi enkriptovani TACACS saobraÄ‡aj ako je kljuÄ dostupan. Analizom dekriptovanog saobraÄ‡aja, informacije kao Å¡to su **baner koji se koristi i korisniÄko ime admin** korisnika mogu se dobiti.

Sticanjem pristupa kontrolnoj tabli mreÅ¾ne opreme koristeÄ‡i dobijene akreditive, napadaÄ moÅ¾e ostvariti kontrolu nad mreÅ¾om. VaÅ¾no je napomenuti da su ove akcije strogo u obrazovne svrhe i ne bi se trebale koristiti bez odgovarajuÄ‡e autorizacije.

## Reference

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
