# 5353/UDP рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS (mDNS) рдФрд░ DNS-SD

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

## **рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА**

**рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS (mDNS)** рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ **DNS-рдЬреИрд╕реА рд╕рдВрдЪрд╛рд▓рди** рдХреЛ рдкрд╛рд░рдВрдкрд░рд┐рдХ DNS рд╕рд░реНрд╡рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ **UDP рдкреЛрд░реНрдЯ 5353** рдкрд░ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рдФрд░ рдЙрдирдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди IoT рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред **DNS рд╕реЗрд╡рд╛ рдЦреЛрдЬ (DNS-SD)**, рдЬреЛ рдЕрдХреНрд╕рд░ mDNS рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕реЗрд╡рд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИ рдорд╛рдирдХ DNS рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **mDNS рдХрд╛ рд╕рдВрдЪрд╛рд▓рди**

рдорд╛рдирдХ DNS рд╕рд░реНрд╡рд░ рдХреЗ рдмрд┐рдирд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, mDNS рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ **.local** рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдбреЛрдореЗрди рдирд╛рдореЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдкрддреЗ **224.0.0.251** (IPv4) рдпрд╛ **FF02::FB** (IPv6) рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдХреЗ рд╣реЛрддрд╛ рд╣реИред mDNS рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реБрдУрдВ рдореЗрдВ рдПрдХ **Time-to-Live (TTL)** рдорд╛рди рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рд░рд┐рдХреЙрд░реНрдб рдХреА рд╡реИрдзрддрд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ **QU рдмрд┐рдЯ** рдЬреЛ рдпреВрдирд┐рдХрд╛рд╕реНрдЯ рдФрд░ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреНрд╡реЗрд░реА рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рддрд╛ рд╣реИред рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, mDNS рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдкреИрдХреЗрдЯ рдХрд╛ рд╕реНрд░реЛрдд рдкрддрд╛ рд╕реНрдерд╛рдиреАрдп рдЙрдкрдиреЗрдЯ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реЛред

### **DNS-SD рдХрд╛ рдХрд╛рд░реНрдп**

DNS-SD рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕реЗрд╡рд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдирдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рд╕реЗ рдореИрдк рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреЙрдЗрдВрдЯрд░ рд░рд┐рдХреЙрд░реНрдб (PTR) рдХреЗ рд▓рд┐рдП рдХреНрд╡реЗрд░реА рдХрд░рдХреЗ рд╣реЛрддрд╛ рд╣реИред рд╕реЗрд╡рд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди **_\<Service>.\_tcp рдпрд╛ \_\<Service>.\_udp** рдкреИрдЯрд░реНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **.local** рдбреЛрдореЗрди рдХреЗ рднреАрддрд░ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд **SRV** рдФрд░ **TXT рд░рд┐рдХреЙрд░реНрдб** рдХреА рдЦреЛрдЬ рд╣реЛрддреА рд╣реИ рдЬреЛ рд╡рд┐рд╕реНрддреГрдд рд╕реЗрд╡рд╛ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

### **рдиреЗрдЯрд╡рд░реНрдХ рдЕрдиреНрд╡реЗрд╖рдг**

#### **nmap рдХрд╛ рдЙрдкрдпреЛрдЧ**

рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ mDNS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреЛрдЧреА рдХрдорд╛рдВрдб рд╣реИ:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
рдпрд╣ рдХрдорд╛рдВрдб рдЦреБрд▓реЗ mDNS рдкреЛрд░реНрдЯ рдФрд░ рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

#### **Pholus рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рдПрдиреНрдпреВрдорд░реЗрд╢рди**

рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ mDNS рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдФрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **Pholus** рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Attacks

### **mDNS рдкреНрд░реЙрдмрд┐рдВрдЧ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛**

рдПрдХ рд╣рдорд▓реЗ рдХрд╛ рд╡реЗрдХреНрдЯрд░ mDNS рдкреНрд░реЙрдмреНрд╕ рдХреЛ рдзреЛрдЦрд╛рдзрдбрд╝реА рд╡рд╛рд▓реЗ рдЙрддреНрддрд░ рднреЗрдЬрдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдпрд╣ рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реБрдП рдХрд┐ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдирдП рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдирд╛рдо рдЪреБрдирдиреЗ рд╕реЗ рд░реЛрдХрдирд╛ред рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
рдпрд╣ рддрдХрдиреАрдХ рдирдП рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЕрдкрдиреА рд╕реЗрд╡рд╛рдПрдБ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рд╕реЗ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рд░реЛрдХрддреА рд╣реИред

**рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ**, mDNS рдФрд░ DNS-SD рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдмрдВрдзрди рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред **nmap** рдФрд░ **Pholus** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐ рдЬрд╛рдЧрд░реВрдХрддрд╛ рд╣рдорд▓реЛрдВ рд╕реЗ рдмрдЪрд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред

### Spoofing/MitM

рдЗрд╕ рд╕реЗрд╡рд╛ рдкрд░ рдЖрдк рдЬреЛ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╡рд╣ рд╣реИ **MitM** **рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рдЕрд╕рд▓реА рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдореЗрдВ**ред рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ (рдкреНрд░рд┐рдВрдЯрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХреЛ MitM рдХрд░рдирд╛) рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ (Windows рдкреНрд░рдорд╛рдгреАрдХрд░рдг) рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## References

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
