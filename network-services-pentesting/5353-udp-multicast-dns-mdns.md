# 5353/UDP Multicast DNS (mDNS) i DNS-SD

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## **Osnovne informacije**

**Multicast DNS (mDNS)** omoguÄ‡ava **DNS-sliÄne operacije** unutar lokalnih mreÅ¾a bez potrebe za tradicionalnim DNS serverom. Radi na **UDP portu 5353** i omoguÄ‡ava ureÄ‘ajima da otkriju jedni druge i njihove usluge, Å¡to se Äesto viÄ‘a kod raznih IoT ureÄ‘aja. **DNS Service Discovery (DNS-SD)**, Äesto koriÅ¡Ä‡en zajedno sa mDNS, pomaÅ¾e u identifikaciji usluga dostupnih na mreÅ¾i putem standardnih DNS upita.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Rad mDNS-a**

U okruÅ¾enjima bez standardnog DNS servera, mDNS omoguÄ‡ava ureÄ‘ajima da reÅ¡avaju imena domena koja se zavrÅ¡avaju sa **.local** upitom na multicast adresu **224.0.0.251** (IPv4) ili **FF02::FB** (IPv6). VaÅ¾ni aspekti mDNS-a ukljuÄuju **Time-to-Live (TTL)** vrednost koja oznaÄava validnost zapisa i **QU bit** koji razlikuje unicast i multicast upite. Sa aspekta bezbednosti, kljuÄno je da mDNS implementacije verifikuju da se izvorna adresa paketa poklapa sa lokalnom podmreÅ¾om.

### **Funkcionisanje DNS-SD**

DNS-SD olakÅ¡ava otkrivanje mreÅ¾nih usluga upitom za pokazivaÄke zapise (PTR) koji mapiraju tipove usluga na njihove instance. Usluge se identifikuju koristeÄ‡i **_\<Service>.\_tcp ili \_\<Service>.\_udp** obrazac unutar **.local** domena, Å¡to dovodi do otkrivanja odgovarajuÄ‡ih **SRV** i **TXT zapisa** koji pruÅ¾aju detaljne informacije o uslugama.

### **IstraÅ¾ivanje MreÅ¾e**

#### **nmap KoriÅ¡Ä‡enje**

Korisna komanda za skeniranje lokalne mreÅ¾e za mDNS usluge je:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Ova komanda pomaÅ¾e u identifikaciji otvorenih mDNS portova i usluga koje se oglaÅ¡avaju preko njih.

#### **MreÅ¾na enumeracija sa Pholus-om**

Da biste aktivno slali mDNS zahteve i uhvatili saobraÄ‡aj, alat **Pholus** se moÅ¾e koristiti na sledeÄ‡i naÄin:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Napadi

### **IskoriÅ¡Ä‡avanje mDNS ispitivanja**

Vektor napada ukljuÄuje slanje laÅ¾nih odgovora na mDNS ispitivanja, sugeriÅ¡uÄ‡i da su svi potencijalni nazivi veÄ‡ u upotrebi, Äime se oteÅ¾ava novim ureÄ‘ajima da odaberu jedinstveni naziv. Ovo se moÅ¾e izvrÅ¡iti koriÅ¡Ä‡enjem:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Ova tehnika efikasno blokira nove ureÄ‘aje da registruju svoje usluge na mreÅ¾i.

**Ukratko**, razumevanje funkcionisanja mDNS i DNS-SD je kljuÄno za upravljanje mreÅ¾om i bezbednost. Alati kao Å¡to su **nmap** i **Pholus** nude dragocene uvide u lokalne mreÅ¾ne usluge, dok svest o potencijalnim ranjivostima pomaÅ¾e u zaÅ¡titi od napada.

### Spoofing/MitM

Najzanimljiviji napad koji moÅ¾ete izvesti preko ove usluge je da izvrÅ¡ite **MitM** u **komunikaciji izmeÄ‘u klijenta i pravog servera**. MoÅ¾da Ä‡ete moÄ‡i da dobijete osetljive datoteke (MitM komunikacija sa Å¡tampaÄem) ili Äak akreditive (Windows autentifikacija).\
Za viÅ¡e informacija pogledajte:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Reference

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
