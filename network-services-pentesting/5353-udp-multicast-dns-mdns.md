# 5353/UDP Multicast DNS (mDNS) i DNS-SD

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na githubie.

</details>
{% endhint %}

## **Podstawowe informacje**

**Multicast DNS (mDNS)** umo偶liwia **operacje podobne do DNS** w lokalnych sieciach bez potrzeby posiadania tradycyjnego serwera DNS. Dziaa na **porcie UDP 5353** i pozwala urzdzeniom na wzajemne odkrywanie si oraz ich usug, co jest powszechnie widoczne w r贸偶nych urzdzeniach IoT. **Odkrywanie usug DNS (DNS-SD)**, czsto u偶ywane razem z mDNS, pomaga w identyfikacji usug dostpnych w sieci za pomoc standardowych zapyta DNS.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Dziaanie mDNS**

W rodowiskach bez standardowego serwera DNS, mDNS pozwala urzdzeniom na rozwizywanie nazw domen koczcych si na **.local** poprzez zapytania do adresu multicast **224.0.0.251** (IPv4) lub **FF02::FB** (IPv6). Wa偶ne aspekty mDNS obejmuj warto **Time-to-Live (TTL)** wskazujc na wa偶no rekordu oraz bit **QU** rozr贸偶niajcy zapytania unicast i multicast. Z punktu widzenia bezpieczestwa, kluczowe jest, aby implementacje mDNS weryfikoway, 偶e adres 藕r贸dowy pakietu jest zgodny z lokalnym podsieci.

### **Dziaanie DNS-SD**

DNS-SD uatwia odkrywanie usug sieciowych poprzez zapytania o rekordy wska藕nikowe (PTR), kt贸re mapuj typy usug na ich instancje. Usugi s identyfikowane za pomoc wzoru **_\<Service>.\_tcp lub \_\<Service>.\_udp** w obrbie domeny **.local**, co prowadzi do odkrycia odpowiadajcych **rekord贸w SRV** i **TXT**, kt贸re dostarczaj szczeg贸owych informacji o usudze.

### **Eksploracja sieci**

#### **U偶ycie nmap**

Przydatna komenda do skanowania lokalnej sieci w poszukiwaniu usug mDNS to:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
To polecenie pomaga zidentyfikowa otwarte porty mDNS oraz usugi reklamowane na nich.

#### **Enumeracja Sieci z Pholus**

Aby aktywnie wysya zapytania mDNS i przechwytywa ruch, narzdzie **Pholus** mo偶na wykorzysta w nastpujcy spos贸b:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Ataki

### **Wykorzystywanie mDNS Probing**

Wektor ataku polega na wysyaniu sfaszowanych odpowiedzi na zapytania mDNS, sugerujc, 偶e wszystkie potencjalne nazwy s ju偶 zajte, co utrudnia nowym urzdzeniom wyb贸r unikalnej nazwy. Mo偶na to zrealizowa za pomoc:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Ta technika skutecznie blokuje nowe urzdzenia przed rejestrowaniem swoich usug w sieci.

**Podsumowujc**, zrozumienie dziaania mDNS i DNS-SD jest kluczowe dla zarzdzania sieci i bezpieczestwa. Narzdzia takie jak **nmap** i **Pholus** oferuj cenne informacje o lokalnych usugach sieciowych, podczas gdy wiadomo potencjalnych luk pomaga w zabezpieczaniu przed atakami.

### Spoofing/MitM

Najciekawszym atakiem, kt贸ry mo偶esz przeprowadzi za pomoc tej usugi, jest wykonanie **MitM** w **komunikacji midzy klientem a prawdziwym serwerem**. Mo偶esz by w stanie uzyska wra偶liwe pliki (MitM komunikacji z drukark) lub nawet dane uwierzytelniajce (uwierzytelnianie Windows).\
Aby uzyska wicej informacji, sprawd藕:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## References

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
