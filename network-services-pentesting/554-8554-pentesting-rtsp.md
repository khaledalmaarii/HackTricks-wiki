# 554,8554 - Testowanie penetracyjne RTSP

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Podstawowe informacje

Z [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **Real Time Streaming Protocol** (**RTSP**) to protok贸 kontroli sieciowej zaprojektowany do u偶ytku w systemach rozrywkowych i komunikacyjnych w celu kontrolowania serwer贸w strumieniowych. Protok贸 jest u偶ywany do ustanawiania i kontrolowania sesji multimedialnych midzy punktami kocowymi. Klienci serwer贸w multimedialnych wydaj polecenia w stylu VHS, takie jak odtwarzanie, nagrywanie i pauza, aby umo偶liwi kontrol w czasie rzeczywistym nad strumieniem multimedialnym z serwera do klienta (Video On Demand) lub od klienta do serwera (Nagrywanie gosu).
>
> Przesyanie strumieniowych danych nie jest zadaniem RTSP. Wikszo serwer贸w RTSP u偶ywa protokou Real-time Transport Protocol (RTP) w poczeniu z protokoem Real-time Control Protocol (RTCP) do dostarczania strumieni multimedialnych. Jednak niekt贸rzy producenci stosuj wasne protokoy transportowe. Na przykad oprogramowanie serwera RTSP firmy RealNetworks u偶ywao r贸wnie偶 wasnego protokou transportowego Real Data Transport (RDT).

**Domylne porty:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Kluczowe informacje

**RTSP** jest podobny do HTTP, ale zosta zaprojektowany specjalnie do strumieniowania medi贸w. Jest zdefiniowany w prostym specyfikacji, kt贸r mo偶na znale藕 tutaj:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

Urzdzenia mog umo偶liwia dostp **bez uwierzytelnienia** lub **uwierzytelniony**. Aby to sprawdzi, wysyane jest 偶danie "DESCRIBE". Poni偶ej przedstawiono podstawowy przykad:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Pamitaj, 偶e poprawne formatowanie obejmuje podw贸jne "\r\n" dla sp贸jnej odpowiedzi. Odpowied藕 "200 OK" oznacza **dostp bez uwierzytelnienia**, podczas gdy "401 Unauthorized" sygnalizuje konieczno uwierzytelnienia, ujawniajc, czy wymagane jest uwierzytelnienie **Basic** lub **Digest**.

W przypadku **uwierzytelnienia Basic** kodujesz nazw u偶ytkownika i haso w base64 i doczasz je do 偶dania w ten spos贸b:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Ten przykad u偶ywa powiadcze "admin" i "1234". Oto **skrypt Pythona**, kt贸ry wysya takie 偶danie:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Podstawowa autoryzacja** jest prostsza i preferowana. **Autoryzacja digest** wymaga ostro偶nego obchodzenia si z danymi uwierzytelniajcymi dostarczonymi w odpowiedzi "401 Unauthorized".

Ten przegld upraszcza proces dostpu do strumieni RTSP, skupiajc si na **podstawowej autoryzacji** ze wzgldu na jej prostot i praktyczno przy pocztkowych pr贸bach.


## Wyliczanie

Pobierzmy informacje na temat obsugiwanych metod i adres贸w URL oraz spr贸bujmy siowo zdoby dostp (jeli jest to konieczne), aby uzyska dostp do zawartoci.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Inne przydatne programy**

Do przeprowadzenia ataku brute force: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Wykrywa otwarte hosty RTSP na dowolnym dostpnym celu
* Pobiera ich publiczne informacje (nazwa hosta, port, model kamery itp.)
* Uruchamia automatyczne ataki sownikowe, aby uzyska cie偶k strumienia (na przykad /live.sdp)
* Uruchamia automatyczne ataki sownikowe, aby uzyska nazw u偶ytkownika i haso do kamer
* Generuje miniatury, aby sprawdzi, czy strumienie s poprawne i szybko zobaczy ich zawarto
* Pr贸buje utworzy potok Gstreamer, aby sprawdzi, czy s poprawnie zakodowane
* Wywietla podsumowanie wszystkich informacji, kt贸re Cameradar m贸g uzyska

## Odwoania
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy **reklam swojej firmy w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
