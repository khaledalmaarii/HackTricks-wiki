# 554,8554 - Pentesting RTSP

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

æ¥è‡ª [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **å®æ—¶æµåè®®** (**RTSP**) æ˜¯ä¸€ç§ç½‘ç»œæ§åˆ¶åè®®ï¼Œæ—¨åœ¨ç”¨äºå¨±ä¹å’Œé€šä¿¡ç³»ç»Ÿï¼Œä»¥æ§åˆ¶æµåª’ä½“æœåŠ¡å™¨ã€‚è¯¥åè®®ç”¨äºåœ¨ç«¯ç‚¹ä¹‹é—´å»ºç«‹å’Œæ§åˆ¶åª’ä½“ä¼šè¯ã€‚æµåª’ä½“æœåŠ¡å™¨çš„å®¢æˆ·ç«¯å‘å‡ºç±»ä¼¼äº VHS çš„å‘½ä»¤ï¼Œå¦‚æ’­æ”¾ã€å½•åˆ¶å’Œæš‚åœï¼Œä»¥ä¾¿å®æ—¶æ§åˆ¶ä»æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯ï¼ˆç‚¹æ’­è§†é¢‘ï¼‰æˆ–ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ï¼ˆè¯­éŸ³å½•éŸ³ï¼‰çš„åª’ä½“æµã€‚
>
> æµæ•°æ®çš„ä¼ è¾“æœ¬èº«ä¸æ˜¯ RTSP çš„ä»»åŠ¡ã€‚å¤§å¤šæ•° RTSP æœåŠ¡å™¨ä½¿ç”¨å®æ—¶ä¼ è¾“åè®® (RTP) ç»“åˆå®æ—¶æ§åˆ¶åè®® (RTCP) è¿›è¡Œåª’ä½“æµä¼ è¾“ã€‚ç„¶è€Œï¼Œä¸€äº›ä¾›åº”å•†å®ç°äº†ä¸“æœ‰çš„ä¼ è¾“åè®®ã€‚ä¾‹å¦‚ï¼ŒRealNetworks çš„ RTSP æœåŠ¡å™¨è½¯ä»¶ä¹Ÿä½¿ç”¨ RealNetworks çš„ä¸“æœ‰å®æ—¶æ•°æ®ä¼ è¾“ (RDT)ã€‚

**é»˜è®¤ç«¯å£ï¼š** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Key Details

**RTSP** ç±»ä¼¼äº HTTPï¼Œä½†ä¸“é—¨ä¸ºåª’ä½“æµè®¾è®¡ã€‚å®ƒåœ¨ä¸€ä¸ªç®€å•çš„è§„èŒƒä¸­å®šä¹‰ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

è®¾å¤‡å¯èƒ½å…è®¸ **unauthenticated** æˆ– **authenticated** è®¿é—®ã€‚è¦æ£€æŸ¥ï¼Œå‘é€ä¸€ä¸ª "DESCRIBE" è¯·æ±‚ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

è¯·è®°ä½ï¼Œæ­£ç¡®çš„æ ¼å¼åŒ…æ‹¬ä¸€ä¸ªåŒ "\r\n" ä»¥ç¡®ä¿ä¸€è‡´çš„å“åº”ã€‚"200 OK" å“åº”è¡¨ç¤º **unauthenticated access**ï¼Œè€Œ "401 Unauthorized" åˆ™è¡¨ç¤ºéœ€è¦èº«ä»½éªŒè¯ï¼Œæ­ç¤ºæ˜¯å¦éœ€è¦ **Basic** æˆ– **Digest authentication**ã€‚

å¯¹äº **Basic authentication**ï¼Œæ‚¨å°†ç”¨æˆ·åå’Œå¯†ç ç¼–ç ä¸º base64ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

æ­¤ç¤ºä¾‹ä½¿ç”¨ "admin" å’Œ "1234" ä½œä¸ºå‡­æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª **Python script** ç”¨äºå‘é€è¿™æ ·çš„è¯·æ±‚ï¼š
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**åŸºæœ¬è®¤è¯** æ›´ç®€å•ä¸”æ›´å—æ¬¢è¿ã€‚ **æ‘˜è¦è®¤è¯** éœ€è¦ä»”ç»†å¤„ç†åœ¨ "401 Unauthorized" å“åº”ä¸­æä¾›çš„è®¤è¯ç»†èŠ‚ã€‚

æ­¤æ¦‚è¿°ç®€åŒ–äº†è®¿é—® RTSP æµçš„è¿‡ç¨‹ï¼Œé‡ç‚¹å…³æ³¨ **åŸºæœ¬è®¤è¯**ï¼Œå› ä¸ºå®ƒåœ¨åˆå§‹å°è¯•ä¸­ç®€å•ä¸”å®ç”¨ã€‚

## æšä¸¾

è·å–æœ‰å…³æœ‰æ•ˆæ–¹æ³•å’Œæ”¯æŒçš„ URL çš„ä¿¡æ¯ï¼Œå¹¶å°è¯•æš´åŠ›ç ´è§£è®¿é—®ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ä»¥è·å–å†…å®¹è®¿é—®æƒé™ã€‚
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [æš´åŠ›ç ´è§£](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **å…¶ä»–æœ‰ç”¨çš„ç¨‹åº**

è¿›è¡Œæš´åŠ›ç ´è§£: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* æ£€æµ‹ä»»ä½•å¯è®¿é—®ç›®æ ‡ä¸Šçš„å¼€æ”¾ RTSP ä¸»æœº
* è·å–å®ƒä»¬çš„å…¬å…±ä¿¡æ¯ï¼ˆä¸»æœºåã€ç«¯å£ã€æ‘„åƒå¤´å‹å·ç­‰ï¼‰
* å¯åŠ¨è‡ªåŠ¨å­—å…¸æ”»å‡»ä»¥è·å–å®ƒä»¬çš„æµè·¯å¾„ï¼ˆä¾‹å¦‚ /live.sdpï¼‰
* å¯åŠ¨è‡ªåŠ¨å­—å…¸æ”»å‡»ä»¥è·å–æ‘„åƒå¤´çš„ç”¨æˆ·åå’Œå¯†ç 
* ä»ä¸­ç”Ÿæˆç¼©ç•¥å›¾ï¼Œä»¥æ£€æŸ¥æµæ˜¯å¦æœ‰æ•ˆå¹¶å¿«é€Ÿé¢„è§ˆå…¶å†…å®¹
* å°è¯•åˆ›å»º Gstreamer ç®¡é“ä»¥æ£€æŸ¥å®ƒä»¬æ˜¯å¦æ­£ç¡®ç¼–ç 
* æ‰“å° Cameradar èƒ½è·å–çš„æ‰€æœ‰ä¿¡æ¯çš„æ‘˜è¦

## å‚è€ƒæ–‡çŒ®

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
