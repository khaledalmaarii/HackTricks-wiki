# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

From [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° í”„ë¡œí† ì½œ** (**RTSP**)ëŠ” ìŠ¤íŠ¸ë¦¬ë° ë¯¸ë””ì–´ ì„œë²„ë¥¼ ì œì–´í•˜ê¸° ìœ„í•´ ì—”í„°í…Œì¸ë¨¼íŠ¸ ë° í†µì‹  ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ì„¤ê³„ëœ ë„¤íŠ¸ì›Œí¬ ì œì–´ í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ì´ í”„ë¡œí† ì½œì€ ì—”ë“œ í¬ì¸íŠ¸ ê°„ì˜ ë¯¸ë””ì–´ ì„¸ì…˜ì„ ì„¤ì •í•˜ê³  ì œì–´í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ë¯¸ë””ì–´ ì„œë²„ì˜ í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œì˜ ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¬ë°(ì£¼ë¬¸í˜• ë¹„ë””ì˜¤) ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œì˜ ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¬ë°(ìŒì„± ë…¹ìŒ)ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œì–´í•˜ê¸° ìœ„í•´ ì¬ìƒ, ë…¹í™” ë° ì¼ì‹œ ì •ì§€ì™€ ê°™ì€ VHS ìŠ¤íƒ€ì¼ì˜ ëª…ë ¹ì„ ë°œí–‰í•©ë‹ˆë‹¤.
>
> ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ìì²´ì˜ ì „ì†¡ì€ RTSPì˜ ì‘ì—…ì´ ì•„ë‹™ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ RTSP ì„œë²„ëŠ” ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì „ì†¡ì„ ìœ„í•´ ì‹¤ì‹œê°„ ì „ì†¡ í”„ë¡œí† ì½œ(RTP)ê³¼ ì‹¤ì‹œê°„ ì œì–´ í”„ë¡œí† ì½œ(RTCP)ì„ í•¨ê»˜ ì‚¬ìš©í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¼ë¶€ ê³µê¸‰ì—…ì²´ëŠ” ë…ì  ì „ì†¡ í”„ë¡œí† ì½œì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, RealNetworksì˜ RTSP ì„œë²„ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” RealNetworksì˜ ë…ì ì ì¸ ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡(RDT)ë„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Key Details

**RTSP**ëŠ” HTTPì™€ ìœ ì‚¬í•˜ì§€ë§Œ ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¬ë°ì„ ìœ„í•´ íŠ¹ë³„íˆ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•œ ì‚¬ì–‘ì´ ì •ì˜ë˜ì–´ ìˆìœ¼ë©°, ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

ì¥ì¹˜ëŠ” **ì¸ì¦ë˜ì§€ ì•Šì€** ë˜ëŠ” **ì¸ì¦ëœ** ì•¡ì„¸ìŠ¤ë¥¼ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í™•ì¸í•˜ê¸° ìœ„í•´ "DESCRIBE" ìš”ì²­ì´ ì „ì†¡ë©ë‹ˆë‹¤. ê¸°ë³¸ ì˜ˆì‹œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

ì˜¬ë°”ë¥¸ í˜•ì‹ì€ ì¼ê´€ëœ ì‘ë‹µì„ ìœ„í•´ ì´ì¤‘ "\r\n"ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤. "200 OK" ì‘ë‹µì€ **ì¸ì¦ë˜ì§€ ì•Šì€ ì•¡ì„¸ìŠ¤**ë¥¼ ë‚˜íƒ€ë‚´ê³ , "401 Unauthorized"ëŠ” ì¸ì¦ì´ í•„ìš”í•¨ì„ ë‚˜íƒ€ë‚´ë©°, **Basic** ë˜ëŠ” **Digest authentication**ì´ í•„ìš”í•œì§€ ì—¬ë¶€ë¥¼ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.

**Basic authentication**ì˜ ê²½ìš°, ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ base64ë¡œ ì¸ì½”ë”©í•˜ê³  ìš”ì²­ì— ë‹¤ìŒê³¼ ê°™ì´ í¬í•¨í•©ë‹ˆë‹¤:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

ì´ ì˜ˆì‹œëŠ” ìê²© ì¦ëª…ìœ¼ë¡œ "admin"ê³¼ "1234"ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒì€ ê·¸ëŸ¬í•œ ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•œ **Python ìŠ¤í¬ë¦½íŠ¸**ì…ë‹ˆë‹¤:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**ê¸°ë³¸ ì¸ì¦**ì€ ë” ê°„ë‹¨í•˜ê³  ì„ í˜¸ë©ë‹ˆë‹¤. **ë‹¤ì´ì œìŠ¤íŠ¸ ì¸ì¦**ì€ "401 Unauthorized" ì‘ë‹µì— ì œê³µëœ ì¸ì¦ ì„¸ë¶€ì •ë³´ë¥¼ ì‹ ì¤‘í•˜ê²Œ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ ê°œìš”ëŠ” RTSP ìŠ¤íŠ¸ë¦¼ì— ì ‘ê·¼í•˜ëŠ” ê³¼ì •ì„ ë‹¨ìˆœí™”í•˜ë©°, ì´ˆê¸° ì‹œë„ì—ì„œì˜ ë‹¨ìˆœì„±ê³¼ ì‹¤ìš©ì„±ì„ ìœ„í•´ **ê¸°ë³¸ ì¸ì¦**ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.

## ì—´ê±°

ìœ íš¨í•œ ë©”ì„œë“œì™€ ì§€ì›ë˜ëŠ” URLì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ê³ , ì½˜í…ì¸ ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ (í•„ìš”í•œ ê²½ìš°) ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì„ ì‹œë„í•´ ë´…ì‹œë‹¤.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **ê¸°íƒ€ ìœ ìš©í•œ í”„ë¡œê·¸ë¨**

Bruteforceë¥¼ ìœ„í•´: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* ì ‘ê·¼ ê°€ëŠ¥í•œ ëŒ€ìƒì—ì„œ ì—´ë¦° RTSP í˜¸ìŠ¤íŠ¸ ê°ì§€
* ê·¸ë“¤ì˜ ê³µê°œ ì •ë³´(í˜¸ìŠ¤íŠ¸ ì´ë¦„, í¬íŠ¸, ì¹´ë©”ë¼ ëª¨ë¸ ë“±) ê°€ì ¸ì˜¤ê¸°
* ìŠ¤íŠ¸ë¦¼ ê²½ë¡œë¥¼ ì–»ê¸° ìœ„í•´ ìë™í™”ëœ ì‚¬ì „ ê³µê²© ì‹œì‘(ì˜ˆ: /live.sdp)
* ì¹´ë©”ë¼ì˜ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì–»ê¸° ìœ„í•´ ìë™í™”ëœ ì‚¬ì „ ê³µê²© ì‹œì‘
* ìŠ¤íŠ¸ë¦¼ì´ ìœ íš¨í•œì§€ í™•ì¸í•˜ê³  ì½˜í…ì¸ ì˜ ë¹ ë¥¸ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ìœ„í•´ ì¸ë„¤ì¼ ìƒì„±
* ì œëŒ€ë¡œ ì¸ì½”ë”©ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ Gstreamer íŒŒì´í”„ë¼ì¸ ìƒì„± ì‹œë„
* Cameradarê°€ ì–»ì„ ìˆ˜ ìˆëŠ” ëª¨ë“  ì •ë³´ì˜ ìš”ì•½ ì¸ì‡„

## References

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
