# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

From [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **ProtokÃ³Å‚ strumieniowania w czasie rzeczywistym** (**RTSP**) to protokÃ³Å‚ kontroli sieci zaprojektowany do uÅ¼ycia w systemach rozrywkowych i komunikacyjnych w celu kontrolowania serwerÃ³w strumieniowych. ProtokÃ³Å‚ jest uÅ¼ywany do ustanawiania i kontrolowania sesji multimedialnych miÄ™dzy punktami koÅ„cowymi. Klienci serwerÃ³w multimedialnych wydajÄ… polecenia w stylu VHS, takie jak odtwarzanie, nagrywanie i pauza, aby uÅ‚atwiÄ‡ kontrolÄ™ w czasie rzeczywistym nad strumieniem multimedialnym z serwera do klienta (Video On Demand) lub z klienta do serwera (Nagrywanie gÅ‚osu).
>
> Transmisja danych strumieniowych nie jest zadaniem RTSP. WiÄ™kszoÅ›Ä‡ serwerÃ³w RTSP uÅ¼ywa ProtokÃ³Å‚u Transportu w Czasie Rzeczywistym (RTP) w poÅ‚Ä…czeniu z ProtokÃ³Å‚em Kontroli w Czasie Rzeczywistym (RTCP) do dostarczania strumieni multimedialnych. Jednak niektÃ³rzy dostawcy wdraÅ¼ajÄ… wÅ‚asne protokoÅ‚y transportowe. Oprogramowanie serwera RTSP od RealNetworks, na przykÅ‚ad, rÃ³wnieÅ¼ uÅ¼ywaÅ‚o wÅ‚asnego ProtokÃ³Å‚u Transportu Danych Real (RDT).

**Default ports:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Key Details

**RTSP** jest podobny do HTTP, ale zaprojektowany specjalnie do strumieniowania mediÃ³w. Jest zdefiniowany w prostych specyfikacjach, ktÃ³re moÅ¼na znaleÅºÄ‡ tutaj:

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

UrzÄ…dzenia mogÄ… umoÅ¼liwiaÄ‡ **nieautoryzowany** lub **autoryzowany** dostÄ™p. Aby to sprawdziÄ‡, wysyÅ‚ane jest Å¼Ä…danie "DESCRIBE". Podstawowy przykÅ‚ad przedstawiono poniÅ¼ej:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

PamiÄ™taj, Å¼e poprawne formatowanie obejmuje podwÃ³jne "\r\n" dla spÃ³jnej odpowiedzi. OdpowiedÅº "200 OK" wskazuje na **nieautoryzowany dostÄ™p**, podczas gdy "401 Unauthorized" sygnalizuje potrzebÄ™ autoryzacji, ujawniajÄ…c, czy wymagana jest **autoryzacja Basic** czy **Digest**.

Dla **autoryzacji Basic** kodujesz nazwÄ™ uÅ¼ytkownika i hasÅ‚o w base64 i doÅ‚Ä…czasz je do Å¼Ä…dania w ten sposÃ³b:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Ten przykÅ‚ad uÅ¼ywa "admin" i "1234" jako poÅ›wiadczeÅ„. Oto **skrypt Python** do wysÅ‚ania takiego Å¼Ä…dania:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Podstawowa autoryzacja** jest prostsza i preferowana. **Autoryzacja z uÅ¼yciem skrÃ³tu** wymaga starannego zarzÄ…dzania szczegÃ³Å‚ami autoryzacji podanymi w odpowiedzi "401 Unauthorized".

Ten przeglÄ…d upraszcza proces uzyskiwania dostÄ™pu do strumieni RTSP, koncentrujÄ…c siÄ™ na **podstawowej autoryzacji** ze wzglÄ™du na jej prostotÄ™ i praktycznoÅ›Ä‡ w poczÄ…tkowych prÃ³bach.

## Enumeracja

ZdobÄ…dÅº informacje o obsÅ‚ugiwanych metodach i adresach URL oraz sprÃ³buj przeprowadziÄ‡ atak brute-force (jeÅ›li to konieczne), aby uzyskaÄ‡ dostÄ™p do treÅ›ci.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Inne przydatne programy**

Aby przeprowadziÄ‡ brute force: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Wykrywanie otwartych hostÃ³w RTSP na dowolnym dostÄ™pnym celu
* Uzyskiwanie ich publicznych informacji (nazwa hosta, port, model kamery itp.)
* Uruchamianie zautomatyzowanych atakÃ³w sÅ‚ownikowych w celu uzyskania trasy strumienia (na przykÅ‚ad /live.sdp)
* Uruchamianie zautomatyzowanych atakÃ³w sÅ‚ownikowych w celu uzyskania nazwy uÅ¼ytkownika i hasÅ‚a kamer
* Generowanie miniaturek z nich, aby sprawdziÄ‡, czy strumienie sÄ… waÅ¼ne i mieÄ‡ szybki podglÄ…d ich zawartoÅ›ci
* PrÃ³ba stworzenia potoku Gstreamer, aby sprawdziÄ‡, czy sÄ… poprawnie zakodowane
* Drukowanie podsumowania wszystkich informacji, ktÃ³re Cameradar mÃ³gÅ‚ uzyskaÄ‡

## Referencje

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
