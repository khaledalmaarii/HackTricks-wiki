# 554,8554 - Pentesting RTSP

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

Sa [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **Real Time Streaming Protocol** (**RTSP**) je mreÅ¾ni kontrolni protokol dizajniran za koriÅ¡Ä‡enje u zabavnim i komunikacionim sistemima radi kontrole servera za strimovanje medija. Protokol se koristi za uspostavljanje i kontrolisanje medijskih sesija izmeÄ‘u krajnjih taÄaka. Klijenti medijskih servera izdaju komande u stilu VHS-a, poput reprodukcije, snimanja i pauziranja, radi olakÅ¡avanja realne kontrole strimovanja medija sa servera ka klijentu (Video na zahtev) ili od klijenta ka serveru (Snimanje glasa).
>
> Samo slanje strimovanih podataka nije zadatak RTSP-a. VeÄ‡ina RTSP servera koristi Real-time Transport Protocol (RTP) u kombinaciji sa Real-time Control Protocol (RTCP) za isporuku medijskog strima. MeÄ‘utim, neki proizvoÄ‘aÄi implementiraju vlasite transportne protokole. Na primer, RTSP server softver od RealNetworks-a takoÄ‘e koristi RealNetworks-ov vlasiti Real Data Transport (RDT).

**Podrazumevani portovi:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## KljuÄni detalji

**RTSP** je sliÄan HTTP-u, ali je dizajniran specifiÄno za strujanje medija. Definisan je u jednostavnoj specifikaciji koja se moÅ¾e pronaÄ‡i ovde:

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

UreÄ‘aji mogu dozvoliti **neautentifikovan** ili **autentifikovan** pristup. Da biste proverili, Å¡alje se zahtev "DESCRIBE". Osnovni primer je prikazan ispod:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

Zapamtite, ispravno formatiranje ukljuÄuje dvostruki "\r\n" za dosledan odgovor. Odgovor "200 OK" ukazuje na **neautentifikovan pristup**, dok "401 Unauthorized" signalizira potrebu za autentifikacijom, otkrivajuÄ‡i da li je potrebna **osnovna** ili **digest autentifikacija**.

Za **osnovnu autentifikaciju**, enkodirate korisniÄko ime i lozinku u base64 i ukljuÄujete ih u zahtev na sledeÄ‡i naÄin:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Ovaj primer koristi "admin" i "1234" za pristupne podatke. Evo **Python skripte** za slanje takvog zahteva:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Osnovna autentikacija** je jednostavnija i poÅ¾eljnija. **Digest autentikacija** zahteva paÅ¾ljivo rukovanje detaljima autentikacije koji se pruÅ¾aju u odgovoru "401 Unauthorized".

Ovaj pregled pojednostavljuje proces pristupa RTSP tokovima, fokusirajuÄ‡i se na **Osnovnu autentikaciju** zbog njene jednostavnosti i praktiÄnosti u poÄetnim pokuÅ¡ajima.

## Enumeracija

PokuÅ¡ajmo da dobijemo informacije o podrÅ¾anim validnim metodama i URL-ovima i pokuÅ¡ajmo da provalimo pristup (ako je potrebno) kako bismo pristupili sadrÅ¾aju.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Drugi korisni programi**

Za brute force: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Otkriva otvorene RTSP hostove na bilo kojoj dostupnoj meti
* Dobija njihove javne informacije (ime hosta, port, model kamere, itd.)
* PokreÄ‡e automatske reÄniÄke napade da dobije njihov stream put (na primer /live.sdp)
* PokreÄ‡e automatske reÄniÄke napade da dobije korisniÄko ime i lozinku kamera
* GeneriÅ¡e sliÄice da proveri da li su streamovi validni i da brzo pregleda njihov sadrÅ¾aj
* PokuÅ¡ava da kreira Gstreamer pipeline da proveri da li su pravilno enkodirani
* Ispisuje saÅ¾etak svih informacija koje je Cameradar mogao da dobije

## Reference

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
