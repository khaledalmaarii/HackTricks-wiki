# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

From [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **GerÃ§ek ZamanlÄ± AkÄ±ÅŸ ProtokolÃ¼** (**RTSP**), akÄ±ÅŸ medya sunucularÄ±nÄ± kontrol etmek iÃ§in eÄŸlence ve iletiÅŸim sistemlerinde kullanÄ±lmak Ã¼zere tasarlanmÄ±ÅŸ bir aÄŸ kontrol protokolÃ¼dÃ¼r. Protokol, uÃ§ noktalar arasÄ±nda medya oturumlarÄ± kurmak ve kontrol etmek iÃ§in kullanÄ±lÄ±r. Medya sunucularÄ±nÄ±n istemcileri, sunucudan bir istemciye (Video On Demand) veya bir istemciden sunucuya (Ses KaydÄ±) medya akÄ±ÅŸÄ±nÄ± gerÃ§ek zamanlÄ± olarak kontrol etmek iÃ§in oynatma, kaydetme ve duraklatma gibi VHS tarzÄ± komutlar verir.
>
> AkÄ±ÅŸ verilerinin iletimi, RTSP'nin bir gÃ¶revi deÄŸildir. Ã‡oÄŸu RTSP sunucusu, medya akÄ±ÅŸÄ± teslimatÄ± iÃ§in GerÃ§ek ZamanlÄ± TaÅŸÄ±ma ProtokolÃ¼ (RTP) ile birlikte GerÃ§ek ZamanlÄ± Kontrol ProtokolÃ¼ (RTCP) kullanÄ±r. Ancak, bazÄ± satÄ±cÄ±lar Ã¶zel taÅŸÄ±ma protokolleri uygular. Ã–rneÄŸin, RealNetworks'ten gelen RTSP sunucu yazÄ±lÄ±mÄ±, aynÄ± zamanda RealNetworks'Ã¼n Ã¶zel GerÃ§ek Veri TaÅŸÄ±ma (RDT) protokolÃ¼nÃ¼ de kullanmaktadÄ±r.

**VarsayÄ±lan portlar:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Ana Detaylar

**RTSP**, HTTP'ye benzer ancak medya akÄ±ÅŸÄ± iÃ§in Ã¶zel olarak tasarlanmÄ±ÅŸtÄ±r. Burada bulunabilen basit bir spesifikasyonda tanÄ±mlanmÄ±ÅŸtÄ±r:

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

Cihazlar **kimlik doÄŸrulamasÄ±z** veya **kimlik doÄŸrulamalÄ±** eriÅŸime izin verebilir. Kontrol etmek iÃ§in bir "DESCRIBE" isteÄŸi gÃ¶nderilir. AÅŸaÄŸÄ±da basit bir Ã¶rnek gÃ¶sterilmektedir:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

DoÄŸru formatlamanÄ±n, tutarlÄ± bir yanÄ±t iÃ§in Ã§ift "\r\n" iÃ§erdiÄŸini unutmayÄ±n. "200 OK" yanÄ±tÄ± **kimlik doÄŸrulamasÄ±z eriÅŸimi** gÃ¶sterirken, "401 Unauthorized" kimlik doÄŸrulamasÄ±nÄ±n gerekli olduÄŸunu belirtir ve **Basic** veya **Digest authentication** gerekip gerekmediÄŸini ortaya Ã§Ä±karÄ±r.

**Basic authentication** iÃ§in, kullanÄ±cÄ± adÄ± ve ÅŸifreyi base64 formatÄ±nda kodlayarak isteÄŸe dahil edersiniz:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Bu Ã¶rnek, kimlik bilgileri olarak "admin" ve "1234" kullanmaktadÄ±r. Ä°ÅŸte bÃ¶yle bir isteÄŸi gÃ¶ndermek iÃ§in bir **Python scripti**:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Temel kimlik doÄŸrulama** daha basit ve tercih edilen bir yÃ¶ntemdir. **Ã–zet kimlik doÄŸrulama**, "401 Yetkisiz" yanÄ±tÄ±nda saÄŸlanan kimlik doÄŸrulama ayrÄ±ntÄ±larÄ±nÄ±n dikkatli bir ÅŸekilde iÅŸlenmesini gerektirir.

Bu genel bakÄ±ÅŸ, RTSP akÄ±ÅŸlarÄ±na eriÅŸim sÃ¼recini basitleÅŸtirir ve ilk denemelerdeki basitliÄŸi ve pratikliÄŸi nedeniyle **Temel kimlik doÄŸrulama** Ã¼zerine odaklanÄ±r.

## SayÄ±m

GeÃ§erli yÃ¶ntemler ve desteklenen URL'ler hakkÄ±nda bilgi alalÄ±m ve iÃ§eriÄŸe eriÅŸim saÄŸlamak iÃ§in (gerekirse) brute-force denemesi yapalÄ±m.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **DiÄŸer faydalÄ± programlar**

Bruteforce iÃ§in: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* EriÅŸilebilir hedeflerde aÃ§Ä±k RTSP sunucularÄ±nÄ± tespit et
* Kamuya aÃ§Ä±k bilgilerini al (hostname, port, kamera modeli, vb.)
* AkÄ±ÅŸ yolunu elde etmek iÃ§in otomatik sÃ¶zlÃ¼k saldÄ±rÄ±larÄ± baÅŸlat (Ã¶rneÄŸin /live.sdp)
* KameralarÄ±n kullanÄ±cÄ± adÄ± ve ÅŸifresini elde etmek iÃ§in otomatik sÃ¶zlÃ¼k saldÄ±rÄ±larÄ± baÅŸlat
* AkÄ±ÅŸlarÄ±n geÃ§erli olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek ve iÃ§eriklerinin hÄ±zlÄ± bir Ã¶nizlemesini almak iÃ§in onlardan kÃ¼Ã§Ã¼k resimler oluÅŸtur
* DoÄŸru bir ÅŸekilde kodlanÄ±p kodlanmadÄ±klarÄ±nÄ± kontrol etmek iÃ§in bir Gstreamer boru hattÄ± oluÅŸturmaya Ã§alÄ±ÅŸ
* Cameradar'Ä±n elde edebileceÄŸi tÃ¼m bilgilerin bir Ã¶zetini yazdÄ±r

## Referanslar

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
