# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

From [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> The **Real Time Streaming Protocol** (**RTSP**) ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¡ãƒ‡ã‚£ã‚¢ã‚µãƒ¼ãƒãƒ¼ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŠã‚ˆã³é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶å¾¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆé–“ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç¢ºç«‹ã—ã€åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ãƒ¡ãƒ‡ã‚£ã‚¢ã‚µãƒ¼ãƒãƒ¼ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼ˆãƒ“ãƒ‡ã‚ªã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ï¼‰ã‚„ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã¸ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼ˆéŸ³å£°éŒ²éŸ³ï¼‰ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ã€å†ç”Ÿã€éŒ²ç”»ã€ä¸€æ™‚åœæ­¢ãªã©ã®VHSã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç™ºè¡Œã—ã¾ã™ã€‚
>
> ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã®ä¼é€ã¯RTSPã®ã‚¿ã‚¹ã‚¯ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã»ã¨ã‚“ã©ã®RTSPã‚µãƒ¼ãƒãƒ¼ã¯ã€ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®é…ä¿¡ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆRTPï¼‰ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ¶å¾¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆRTCPï¼‰ã‚’ä½µç”¨ã—ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ä¸€éƒ¨ã®ãƒ™ãƒ³ãƒ€ãƒ¼ã¯ç‹¬è‡ªã®ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ãŸã¨ãˆã°ã€RealNetworksã®RTSPã‚µãƒ¼ãƒãƒ¼ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€RealNetworksã®ç‹¬è‡ªã®ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆï¼ˆRDTï¼‰ã‚‚ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Key Details

**RTSP**ã¯HTTPã«ä¼¼ã¦ã„ã¾ã™ãŒã€ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å°‚ç”¨ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ã“ã¡ã‚‰ã«ã‚ã‚‹ç°¡æ½”ãªä»•æ§˜ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼š

[RTSP â€“ RFC2326](https://tools.ietf.org/html/rfc2326)

ãƒ‡ãƒã‚¤ã‚¹ã¯**èªè¨¼ãªã—**ã¾ãŸã¯**èªè¨¼ã‚ã‚Š**ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ã€ŒDESCRIBEã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚åŸºæœ¬çš„ãªä¾‹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

æ­£ã—ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã¯ã€ä¸€è²«ã—ãŸå¿œç­”ã®ãŸã‚ã«ãƒ€ãƒ–ãƒ«ã®"\r\n"ãŒå«ã¾ã‚Œã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚ã€Œ200 OKã€å¿œç­”ã¯**èªè¨¼ãªã—ã®ã‚¢ã‚¯ã‚»ã‚¹**ã‚’ç¤ºã—ã€ã€Œ401 Unauthorizedã€ã¯èªè¨¼ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã€**Basic**ã¾ãŸã¯**Digest authentication**ãŒå¿…è¦ã‹ã©ã†ã‹ã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã™ã€‚

**Basic authentication**ã®å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’base64ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«æ¬¡ã®ã‚ˆã†ã«å«ã‚ã¾ã™ï¼š

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

ã“ã®ä¾‹ã§ã¯ã€è³‡æ ¼æƒ…å ±ã¨ã—ã¦ã€Œadminã€ã¨ã€Œ1234ã€ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ãã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®**Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ã§ã™ï¼š
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**åŸºæœ¬èªè¨¼**ã¯ã‚ˆã‚Šç°¡å˜ã§å¥½ã¾ã‚Œã¾ã™ã€‚**ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼**ã¯ã€ã€Œ401 Unauthorizedã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§æä¾›ã•ã‚Œã‚‹èªè¨¼è©³ç´°ã®æ…é‡ãªå–ã‚Šæ‰±ã„ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚

ã“ã®æ¦‚è¦ã¯ã€RTSPã‚¹ãƒˆãƒªãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç°¡ç´ åŒ–ã—ã€åˆæœŸã®è©¦è¡Œã«ãŠã‘ã‚‹ãã®ã‚·ãƒ³ãƒ—ãƒ«ã•ã¨å®Ÿç”¨æ€§ã®ãŸã‚ã«**åŸºæœ¬èªè¨¼**ã«ç„¦ç‚¹ã‚’å½“ã¦ã¦ã„ã¾ã™ã€‚

## åˆ—æŒ™

æœ‰åŠ¹ãªãƒ¡ã‚½ãƒƒãƒ‰ã¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹URLã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’å¾—ã‚‹ãŸã‚ã«ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚’è©¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **ãã®ä»–ã®ä¾¿åˆ©ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ **

ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ç”¨: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆä¸Šã®ã‚ªãƒ¼ãƒ—ãƒ³RTSPãƒ›ã‚¹ãƒˆã‚’æ¤œå‡º
* ãã‚Œã‚‰ã®å…¬é–‹æƒ…å ±ã‚’å–å¾—ï¼ˆãƒ›ã‚¹ãƒˆåã€ãƒãƒ¼ãƒˆã€ã‚«ãƒ¡ãƒ©ãƒ¢ãƒ‡ãƒ«ãªã©ï¼‰
* ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ«ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã«è‡ªå‹•è¾æ›¸æ”»æ’ƒã‚’å®Ÿè¡Œï¼ˆä¾‹: /live.sdpï¼‰
* ã‚«ãƒ¡ãƒ©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«è‡ªå‹•è¾æ›¸æ”»æ’ƒã‚’å®Ÿè¡Œ
* ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã€ãã®å†…å®¹ã®ã‚¯ã‚¤ãƒƒã‚¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å¾—ã‚‹ãŸã‚ã«ã‚µãƒ ãƒã‚¤ãƒ«ã‚’ç”Ÿæˆ
* é©åˆ‡ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«Gstreamerãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆã—ã‚ˆã†ã¨ã™ã‚‹
* CameradarãŒå–å¾—ã§ããŸã™ã¹ã¦ã®æƒ…å ±ã®æ¦‚è¦ã‚’å°åˆ·

## å‚è€ƒæ–‡çŒ®

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„!
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
