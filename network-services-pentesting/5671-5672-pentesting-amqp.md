# 5671,5672 - Pentesting AMQP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

From [cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html):

> **RabbitMQ**ëŠ” _ë©”ì‹œì§€ ë¸Œë¡œì»¤_ ë˜ëŠ” _í ê´€ë¦¬ì_ë¡œ ì•Œë ¤ì§„ **ë©”ì‹œì§€ íì‰ ì†Œí”„íŠ¸ì›¨ì–´**ì…ë‹ˆë‹¤. ê°„ë‹¨íˆ ë§í•´, ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—°ê²°ë˜ëŠ” íê°€ ì •ì˜ëœ ì†Œí”„íŠ¸ì›¨ì–´ì…ë‹ˆë‹¤.\
> **ë©”ì‹œì§€ëŠ” ì–´ë–¤ ì¢…ë¥˜ì˜ ì •ë³´ë„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜(ë‹¤ë¥¸ ì„œë²„ì— ìˆì„ ìˆ˜ë„ ìˆìŒ)ì—ì„œ ì‹œì‘í•´ì•¼ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë‚˜ ì‘ì—…ì— ëŒ€í•œ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìœ¼ë©°, ë‹¨ìˆœí•œ í…ìŠ¤íŠ¸ ë©”ì‹œì§€ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í ê´€ë¦¬ì ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ìˆ˜ì‹  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—°ê²°ë˜ì–´ íì—ì„œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ê°ˆ ë•Œê¹Œì§€ ë©”ì‹œì§€ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ìˆ˜ì‹  ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê·¸ í›„ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.\
Definition from .

**Default port**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## ì—´ê±°

### ìˆ˜ë™
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### ìë™
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

* [**AMQP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## Other RabbitMQ ports

In [https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) you can find that **rabbitmqëŠ” ì—¬ëŸ¬ í¬íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤**:

* **1883, 8883**: ([MQTT í´ë¼ì´ì–¸íŠ¸](http://mqtt.org) TLS ì—†ì´ ë° TLSì™€ í•¨ê»˜, [MQTT í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/mqtt.html)ì´ í™œì„±í™”ëœ ê²½ìš°. [**ì—¬ê¸°ì—ì„œ MQTTë¥¼ íœí…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë” ì•Œì•„ë³´ì„¸ìš”**](1883-pentesting-mqtt-mosquitto.md).
* **4369: epmd**, RabbitMQ ë…¸ë“œì™€ CLI ë„êµ¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” í”¼ì–´ ê²€ìƒ‰ ì„œë¹„ìŠ¤. [**ì—¬ê¸°ì—ì„œ ì´ ì„œë¹„ìŠ¤ë¥¼ íœí…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë” ì•Œì•„ë³´ì„¸ìš”**](4369-pentesting-erlang-port-mapper-daemon-epmd.md).
* **5672, 5671**: TLS ì—†ì´ ë° TLSì™€ í•¨ê»˜ AMQP 0-9-1 ë° 1.0 í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html) í´ë¼ì´ì–¸íŠ¸, [ê´€ë¦¬ UI](https://www.rabbitmq.com/management.html) ë° [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html) (ë‹¨, [ê´€ë¦¬ í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/management.html)ì´ í™œì„±í™”ëœ ê²½ìš°). [**ì—¬ê¸°ì—ì„œ ì´ ì„œë¹„ìŠ¤ë¥¼ íœí…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë” ì•Œì•„ë³´ì„¸ìš”**](15672-pentesting-rabbitmq-management.md).
* 15674: STOMP-over-WebSockets í´ë¼ì´ì–¸íŠ¸ (ë‹¨, [Web STOMP í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/web-stomp.html)ì´ í™œì„±í™”ëœ ê²½ìš°)
* 15675: MQTT-over-WebSockets í´ë¼ì´ì–¸íŠ¸ (ë‹¨, [Web MQTT í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/web-mqtt.html)ì´ í™œì„±í™”ëœ ê²½ìš°)
* 15692: Prometheus ë©”íŠ¸ë¦­ (ë‹¨, [Prometheus í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/prometheus.html)ì´ í™œì„±í™”ëœ ê²½ìš°)
* 25672: ë…¸ë“œ ê°„ ë° CLI ë„êµ¬ í†µì‹ ì— ì‚¬ìš© (Erlang ë°°í¬ ì„œë²„ í¬íŠ¸)ì´ë©° ë™ì  ë²”ìœ„ì—ì„œ í• ë‹¹ë¨ (ê¸°ë³¸ì ìœ¼ë¡œ AMQP í¬íŠ¸ + 20000ìœ¼ë¡œ ê³„ì‚°ëœ ë‹¨ì¼ í¬íŠ¸ë¡œ ì œí•œë¨). ì´ëŸ¬í•œ í¬íŠ¸ì—ì„œ ì™¸ë¶€ ì—°ê²°ì´ ì •ë§ í•„ìš”í•œ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ (ì˜ˆ: í´ëŸ¬ìŠ¤í„°ê°€ [ì—°í•©](https://www.rabbitmq.com/federation.html)ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë˜ëŠ” CLI ë„êµ¬ê°€ ì„œë¸Œë„· ì™¸ë¶€ì˜ ë¨¸ì‹ ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²½ìš°), ì´ëŸ¬í•œ í¬íŠ¸ëŠ” ê³µê°œì ìœ¼ë¡œ ë…¸ì¶œë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [ë„¤íŠ¸ì›Œí‚¹ ê°€ì´ë“œ](https://www.rabbitmq.com/networking.html)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”. **ì´ í¬íŠ¸ ì¤‘ 9ê°œë§Œ ì¸í„°ë„·ì— ì—´ë ¤ ìˆìŠµë‹ˆë‹¤**.
* 35672-35682: ë…¸ë“œì™€ì˜ í†µì‹ ì„ ìœ„í•œ CLI ë„êµ¬ (Erlang ë°°í¬ í´ë¼ì´ì–¸íŠ¸ í¬íŠ¸)ì—ì„œ ì‚¬ìš©ë˜ë©° ë™ì  ë²”ìœ„ì—ì„œ í• ë‹¹ë¨ (ì„œë²„ ë°°í¬ í¬íŠ¸ + 10000ì—ì„œ ì„œë²„ ë°°í¬ í¬íŠ¸ + 10010ìœ¼ë¡œ ê³„ì‚°ë¨). ìì„¸í•œ ë‚´ìš©ì€ [ë„¤íŠ¸ì›Œí‚¹ ê°€ì´ë“œ](https://www.rabbitmq.com/networking.html)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
* 61613, 61614: [STOMP í´ë¼ì´ì–¸íŠ¸](https://stomp.github.io/stomp-specification-1.2.html) TLS ì—†ì´ ë° TLSì™€ í•¨ê»˜ (ë‹¨, [STOMP í”ŒëŸ¬ê·¸ì¸](https://www.rabbitmq.com/stomp.html)ì´ í™œì„±í™”ëœ ê²½ìš°). ì´ í¬íŠ¸ê°€ ì—´ë ¤ ìˆëŠ” ì¥ì¹˜ëŠ” 10ëŒ€ ë¯¸ë§Œì´ë©° ëŒ€ë¶€ë¶„ DHT ë…¸ë“œì— ëŒ€í•´ UDPì…ë‹ˆë‹¤.

## Shodan

* `AMQP`

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
