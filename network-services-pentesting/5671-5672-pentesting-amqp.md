# 5671,5672 - Pentesting AMQP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* å¦‚æœä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œï¼Œæƒ³åœ¨**HackTricks**ä¸Šçœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**ï¼Œæˆ–è€…æƒ³è¦è·å–**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—ï¼Œ[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricksä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloudä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## åŸºæœ¬ä¿¡æ¯

**RabbitMQ** æ˜¯ä¸€ç§**æ¶ˆæ¯é˜Ÿåˆ—è½¯ä»¶**ï¼Œä¹Ÿè¢«ç§°ä¸º_æ¶ˆæ¯ä»£ç†_æˆ–_é˜Ÿåˆ—ç®¡ç†å™¨_ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯å®šä¹‰é˜Ÿåˆ—çš„è½¯ä»¶ï¼Œåº”ç”¨ç¨‹åºè¿æ¥åˆ°è¿™äº›é˜Ÿåˆ—ä»¥ä¼ è¾“æ¶ˆæ¯ã€‚\
**æ¶ˆæ¯å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„ä¿¡æ¯**ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥åŒ…å«æœ‰å…³åº”è¯¥åœ¨å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆç”šè‡³å¯èƒ½åœ¨å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼‰ä¸Šå¯åŠ¨çš„è¿‡ç¨‹æˆ–ä»»åŠ¡çš„ä¿¡æ¯ï¼Œæˆ–è€…å®ƒå¯ä»¥ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ¶ˆæ¯ã€‚é˜Ÿåˆ—ç®¡ç†è½¯ä»¶å­˜å‚¨æ¶ˆæ¯ï¼Œç›´åˆ°æ¥æ”¶åº”ç”¨ç¨‹åºè¿æ¥å¹¶ä»é˜Ÿåˆ—ä¸­å–èµ°æ¶ˆæ¯ã€‚ç„¶åæ¥æ”¶åº”ç”¨ç¨‹åºå¤„ç†æ¶ˆæ¯ã€‚\
å®šä¹‰æ¥è‡ª[è¿™é‡Œ](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html)ã€‚

**é»˜è®¤ç«¯å£**ï¼š5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## æšä¸¾

### æ‰‹åŠ¨
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### è‡ªåŠ¨
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### æš´åŠ›ç ´è§£

* [**AMQP åè®®æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP åè®®æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## å…¶ä»– RabbitMQ ç«¯å£

ä» [https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) å¯ä»¥æ‰¾åˆ° **rabbitmq ä½¿ç”¨å¤šä¸ªç«¯å£**ï¼š

* **1883, 8883**ï¼š([MQTT å®¢æˆ·ç«¯](http://mqtt.org) ä¸ä½¿ç”¨åŠä½¿ç”¨ TLSï¼Œå¦‚æœå¯ç”¨äº† [MQTT æ’ä»¶](https://www.rabbitmq.com/mqtt.html)ã€‚[**äº†è§£æ›´å¤šå…³äºå¦‚ä½•å¯¹ MQTT è¿›è¡Œæ¸—é€æµ‹è¯•çš„ä¿¡æ¯**](1883-pentesting-mqtt-mosquitto.md)ã€‚
* **4369: epmd**ï¼ŒRabbitMQ èŠ‚ç‚¹å’Œ CLI å·¥å…·ä½¿ç”¨çš„å¯¹ç­‰å‘ç°æœåŠ¡ã€‚[**äº†è§£æ›´å¤šå…³äºå¦‚ä½•å¯¹æ­¤æœåŠ¡è¿›è¡Œæ¸—é€æµ‹è¯•çš„ä¿¡æ¯**](4369-pentesting-erlang-port-mapper-daemon-epmd.md)ã€‚
* **5672, 5671**ï¼šAMQP 0-9-1 å’Œ 1.0 å®¢æˆ·ç«¯ä¸ä½¿ç”¨åŠä½¿ç”¨ TLS
* **15672**ï¼š[HTTP API](https://www.rabbitmq.com/management.html) å®¢æˆ·ç«¯ï¼Œ[ç®¡ç† UI](https://www.rabbitmq.com/management.html) å’Œ [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html)ï¼ˆä»…å½“å¯ç”¨äº† [ç®¡ç†æ’ä»¶](https://www.rabbitmq.com/management.html) æ—¶ï¼‰ã€‚[**äº†è§£æ›´å¤šå…³äºå¦‚ä½•å¯¹æ­¤æœåŠ¡è¿›è¡Œæ¸—é€æµ‹è¯•çš„ä¿¡æ¯**](15672-pentesting-rabbitmq-management.md)ã€‚
* 15674ï¼šSTOMP-over-WebSockets å®¢æˆ·ç«¯ï¼ˆä»…å½“å¯ç”¨äº† [Web STOMP æ’ä»¶](https://www.rabbitmq.com/web-stomp.html) æ—¶ï¼‰
* 15675ï¼šMQTT-over-WebSockets å®¢æˆ·ç«¯ï¼ˆä»…å½“å¯ç”¨äº† [Web MQTT æ’ä»¶](https://www.rabbitmq.com/web-mqtt.html) æ—¶ï¼‰
* 15692ï¼šPrometheus æŒ‡æ ‡ï¼ˆä»…å½“å¯ç”¨äº† [Prometheus æ’ä»¶](https://www.rabbitmq.com/prometheus.html) æ—¶ï¼‰
* 25672ï¼šç”¨äºèŠ‚ç‚¹é—´å’Œ CLI å·¥å…·é€šä¿¡ï¼ˆErlang åˆ†å¸ƒå¼æœåŠ¡å™¨ç«¯å£ï¼‰ï¼Œä»åŠ¨æ€èŒƒå›´åˆ†é…ï¼ˆé»˜è®¤é™åˆ¶ä¸ºå•ä¸ªç«¯å£ï¼Œè®¡ç®—ä¸º AMQP ç«¯å£ + 20000ï¼‰ã€‚é™¤éè¿™äº›ç«¯å£çš„å¤–éƒ¨è¿æ¥ç¡®å®å¿…è¦ï¼ˆä¾‹å¦‚ï¼Œé›†ç¾¤ä½¿ç”¨ [è”åˆ](https://www.rabbitmq.com/federation.html) æˆ–åœ¨å­ç½‘å¤–çš„æœºå™¨ä¸Šä½¿ç”¨ CLI å·¥å…·ï¼‰ï¼Œå¦åˆ™è¿™äº›ç«¯å£ä¸åº”å…¬å¼€æš´éœ²ã€‚è¯¦æƒ…è§[ç½‘ç»œæŒ‡å—](https://www.rabbitmq.com/networking.html)ã€‚**äº’è”ç½‘ä¸Šä»…å¼€æ”¾äº† 9 ä¸ªè¿™æ ·çš„ç«¯å£**ã€‚
* 35672-35682ï¼šCLI å·¥å…·ä½¿ç”¨ï¼ˆErlang åˆ†å¸ƒå¼å®¢æˆ·ç«¯ç«¯å£ï¼‰ä¸èŠ‚ç‚¹é€šä¿¡ï¼Œä»åŠ¨æ€èŒƒå›´åˆ†é…ï¼ˆè®¡ç®—ä¸ºæœåŠ¡å™¨åˆ†å¸ƒç«¯å£ + 10000 è‡³æœåŠ¡å™¨åˆ†å¸ƒç«¯å£ + 10010ï¼‰ã€‚è¯¦æƒ…è§[ç½‘ç»œæŒ‡å—](https://www.rabbitmq.com/networking.html)ã€‚
* 61613, 61614ï¼š[STOMP å®¢æˆ·ç«¯](https://stomp.github.io/stomp-specification-1.2.html) ä¸ä½¿ç”¨åŠä½¿ç”¨ TLSï¼ˆä»…å½“å¯ç”¨äº† [STOMP æ’ä»¶](https://www.rabbitmq.com/stomp.html) æ—¶ï¼‰ã€‚å¼€æ”¾æ­¤ç«¯å£çš„è®¾å¤‡å°‘äº 10 å°ï¼Œå¤§å¤šæ•°ç”¨äº DHT èŠ‚ç‚¹çš„ UDPã€‚

## Shodan

* `AMQP`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨ **HackTricks** ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è¦è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**ï¼ŸæŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **æ¨ç‰¹** ä¸Š**å…³æ³¨**æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘ [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) å’Œ [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
