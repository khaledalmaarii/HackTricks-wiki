# 5671,5672 - Pentesting AMQP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

[cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html)ã‹ã‚‰:

> **RabbitMQ**ã¯ã€_ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼_ã¾ãŸã¯_ã‚­ãƒ¥ãƒ¼ç®¡ç†è€…_ã¨ã—ã¦ã‚‚çŸ¥ã‚‰ã‚Œã‚‹**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢**ã§ã™ã€‚ç°¡å˜ã«è¨€ãˆã°ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è»¢é€ã™ã‚‹ãŸã‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¥ç¶šã™ã‚‹ã‚­ãƒ¥ãƒ¼ãŒå®šç¾©ã•ã‚ŒãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚\
> **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®æƒ…å ±ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚ä¾‹ãˆã°ã€åˆ¥ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåˆ¥ã®ã‚µãƒ¼ãƒãƒ¼ä¸Šã«ã‚ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ï¼‰ã§é–‹å§‹ã™ã¹ããƒ—ãƒ­ã‚»ã‚¹ã‚„ã‚¿ã‚¹ã‚¯ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å«ã‚€ã“ã¨ãŒã§ãã¾ã™ã—ã€å˜ç´”ãªãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ã‚­ãƒ¥ãƒ¼ç®¡ç†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€å—ä¿¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¥ç¶šã—ã¦ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹ã¾ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã—ã¾ã™ã€‚å—ä¿¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãã®å¾Œã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã—ã¾ã™ã€‚\
å®šç¾©å…ƒã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## åˆ—æŒ™

### æ‰‹å‹•
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### è‡ªå‹•
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

* [**AMQPãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMPãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## ãã®ä»–ã®RabbitMQãƒãƒ¼ãƒˆ

[https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) ã§ã¯ã€**RabbitMQãŒã„ãã¤ã‹ã®ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹**ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼š

* **1883, 8883**: ï¼ˆTLSãªã—ãŠã‚ˆã³TLSã‚ã‚Šã®[MQTTã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](http://mqtt.org)ã€[**ã“ã“ã§MQTTã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦è©³ã—ãå­¦ã¶**](1883-pentesting-mqtt-mosquitto.md)ï¼‰ã€‚
* **4369: epmd**ã€RabbitMQãƒãƒ¼ãƒ‰ã¨CLIãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹ãƒ”ã‚¢ç™ºè¦‹ã‚µãƒ¼ãƒ“ã‚¹ã€‚[**ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦è©³ã—ãå­¦ã¶**](4369-pentesting-erlang-port-mapper-daemon-epmd.md)ã€‚
* **5672, 5671**: TLSãªã—ãŠã‚ˆã³TLSã‚ã‚Šã®AMQP 0-9-1ãŠã‚ˆã³1.0ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html)ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€[ç®¡ç†UI](https://www.rabbitmq.com/management.html)ãŠã‚ˆã³[rabbitmqadmin](https://www.rabbitmq.com/management-cli.html)ï¼ˆ[ç®¡ç†ãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/management.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ã€‚[**ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦è©³ã—ãå­¦ã¶**](15672-pentesting-rabbitmq-management.md)ã€‚
* 15674: STOMP-over-WebSocketsã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ[Web STOMPãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/web-stomp.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 15675: MQTT-over-WebSocketsã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ[Web MQTTãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/web-mqtt.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 15692: Prometheusãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆ[Prometheusãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/prometheus.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 25672: ãƒãƒ¼ãƒ‰é–“ãŠã‚ˆã³CLIãƒ„ãƒ¼ãƒ«ã®é€šä¿¡ã«ä½¿ç”¨ã•ã‚Œã‚‹ï¼ˆErlangåˆ†æ•£ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼‰ã§ã€å‹•çš„ç¯„å›²ã‹ã‚‰å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯å˜ä¸€ãƒãƒ¼ãƒˆã«åˆ¶é™ã•ã‚Œã€AMQPãƒãƒ¼ãƒˆ + 20000ã¨ã—ã¦è¨ˆç®—ã•ã‚Œã¾ã™ï¼‰ã€‚ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã§å¤–éƒ¨æ¥ç¶šãŒæœ¬å½“ã«å¿…è¦ã§ãªã„é™ã‚Šï¼ˆä¾‹ï¼šã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãŒ[ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³](https://www.rabbitmq.com/federation.html)ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã‚„ã€CLIãƒ„ãƒ¼ãƒ«ãŒã‚µãƒ–ãƒãƒƒãƒˆå¤–ã®ãƒã‚·ãƒ³ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰ã€ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã¯å…¬é–‹ã•ã‚Œã‚‹ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://www.rabbitmq.com/networking.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã®ã†ã¡ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§é–‹ã„ã¦ã„ã‚‹ã®ã¯9ã¤ã ã‘ã§ã™**ã€‚
* 35672-35682: ãƒãƒ¼ãƒ‰ã¨ã®é€šä¿¡ã®ãŸã‚ã«CLIãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹ï¼ˆErlangåˆ†æ•£ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒãƒ¼ãƒˆï¼‰ã§ã€å‹•çš„ç¯„å›²ã‹ã‚‰å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ï¼ˆã‚µãƒ¼ãƒãƒ¼åˆ†æ•£ãƒãƒ¼ãƒˆ + 10000ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼åˆ†æ•£ãƒãƒ¼ãƒˆ + 10010ã¨ã—ã¦è¨ˆç®—ã•ã‚Œã¾ã™ï¼‰ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://www.rabbitmq.com/networking.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* 61613, 61614: TLSãªã—ãŠã‚ˆã³TLSã‚ã‚Šã®[STOMPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](https://stomp.github.io/stomp-specification-1.2.html)ï¼ˆ[STOMPãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/stomp.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ã€‚ã“ã®ãƒãƒ¼ãƒˆãŒé–‹ã„ã¦ã„ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã¯10æœªæº€ã§ã€ä¸»ã«DHTãƒãƒ¼ãƒ‰ç”¨ã®UDPã§ã™ã€‚

## Shodan

* `AMQP`

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
