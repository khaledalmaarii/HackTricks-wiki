# 5671,5672 - Pentesting AMQP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

From [cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html):

> **RabbitMQ** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½** Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î³Î½Ï‰ÏƒÏ„ÏŒ Ï‰Ï‚ _Î¼ÎµÏƒÎ¯Ï„Î·Ï‚ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½_ Î® _Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î¿Ï…ÏÏÎ½._ Î‘Ï€Î»Î¬, ÎµÎ¯Î½Î±Î¹ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ ÏŒÏ€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î¿Î¹ Î¿Ï…ÏÎ­Ï‚, ÏƒÏ„Î¹Ï‚ Î¿Ï€Î¿Î¯ÎµÏ‚ ÏƒÏ…Î½Î´Î­Î¿Î½Ï„Î±Î¹ Î¿Î¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î³Î¹Î± Î½Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Ï…Î½ Î­Î½Î± Î¼Î®Î½Ï…Î¼Î± Î® Î¼Î·Î½ÏÎ¼Î±Ï„Î±.\
> ÎˆÎ½Î± **Î¼Î®Î½Ï…Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ ÎµÎ¯Î´Î¿Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î±Ï‚**. ÎœÏ€Î¿ÏÎµÎ¯, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î½Î± Î­Ï‡ÎµÎ¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î¼Î¹Î± Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î® ÎµÏÎ³Î±ÏƒÎ¯Î± Ï€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Î¬Î»Î»Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® (Î· Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ ÏƒÎµ Î¬Î»Î»Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®), Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î­Î½Î± Î±Ï€Î»ÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿. Î¤Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Î¿Ï…ÏÏÎ½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± Î¼Î­Ï‡ÏÎ¹ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Ï€Î±ÏÎ±Î»Î®Ï€Ï„Î·Ï‚ ÎºÎ±Î¹ Î½Î± Ï€Î¬ÏÎµÎ¹ Î­Î½Î± Î¼Î®Î½Ï…Î¼Î± Î±Ï€ÏŒ Ï„Î·Î½ Î¿Ï…ÏÎ¬. Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Ï€Î±ÏÎ±Î»Î®Ï€Ï„Î·Ï‚ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï„Î¿ Î¼Î®Î½Ï…Î¼Î±.\
Definition from .

**Default port**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## Enumeration

### Manual
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î·
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

* [**AMQP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## Î†Î»Î»ÎµÏ‚ Î¸ÏÏÎµÏ‚ RabbitMQ

Î£Ï„Î¿ [https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ **Ï„Î¿ rabbitmq Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï€Î¿Î»Î»Î­Ï‚ Î¸ÏÏÎµÏ‚**:

* **1883, 8883**: ([MQTT clients](http://mqtt.org) Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¹ Î¼Îµ TLS, Î±Î½ Ï„Î¿ [MQTT plugin](https://www.rabbitmq.com/mqtt.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿. [**ÎœÎ¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ pentest ÏƒÏ„Î¿ MQTT ÎµÎ´Ï**](1883-pentesting-mqtt-mosquitto.md).
* **4369: epmd**, Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ·Ï‚ peer Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ RabbitMQ ÎºÎ±Î¹ Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± CLI. [**ÎœÎ¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ pentest ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ´Ï**](4369-pentesting-erlang-port-mapper-daemon-epmd.md).
* **5672, 5671**: Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ AMQP 0-9-1 ÎºÎ±Î¹ 1.0 Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¹ Î¼Îµ TLS
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html) Ï€ÎµÎ»Î¬Ï„ÎµÏ‚, [Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· UI](https://www.rabbitmq.com/management.html) ÎºÎ±Î¹ [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html) (Î¼ÏŒÎ½Î¿ Î±Î½ Ï„Î¿ [management plugin](https://www.rabbitmq.com/management.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿). [**ÎœÎ¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ pentest ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ´Ï**](15672-pentesting-rabbitmq-management.md).
* 15674: STOMP-over-WebSockets Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ (Î¼ÏŒÎ½Î¿ Î±Î½ Ï„Î¿ [Web STOMP plugin](https://www.rabbitmq.com/web-stomp.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿)
* 15675: MQTT-over-WebSockets Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ (Î¼ÏŒÎ½Î¿ Î±Î½ Ï„Î¿ [Web MQTT plugin](https://www.rabbitmq.com/web-mqtt.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿)
* 15692: ÎœÎµÏ„ÏÎ®ÏƒÎµÎ¹Ï‚ Prometheus (Î¼ÏŒÎ½Î¿ Î±Î½ Ï„Î¿ [Prometheus plugin](https://www.rabbitmq.com/prometheus.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿)
* 25672: Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï ÎºÏŒÎ¼Î²Ï‰Î½ ÎºÎ±Î¹ ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½ CLI (Î¸ÏÏÎ± Î´Î¹Î±Î½Î¿Î¼Î®Ï‚ Erlang) ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ ÎµÎºÏ‡Ï‰ÏÎ·Î¸ÎµÎ¯ Î±Ï€ÏŒ Î¼Î¹Î± Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Ï€ÎµÏÎ¹Î¿Ï‡Î® (Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· ÏƒÎµ Î¼Î¯Î± Î¼ÏŒÎ½Î¿ Î¸ÏÏÎ± Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î­Î½Î· Ï‰Ï‚ Î¸ÏÏÎ± AMQP + 20000). Î•ÎºÏ„ÏŒÏ‚ Î±Î½ Î¿Î¹ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ ÏƒÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î¸ÏÏÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„ÎµÏ‚ (Ï€.Ï‡. Î¿ ÏƒÏ…Î¼Ï€Î»Î­ÎºÏ„Î·Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ [federation](https://www.rabbitmq.com/federation.html) Î® Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± CLI Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ Î¼Î·Ï‡Î±Î½Î­Ï‚ ÎµÎºÏ„ÏŒÏ‚ Ï„Î¿Ï… Ï…Ï€Î¿Î´Î¹ÎºÏ„ÏÎ¿Ï…), Î±Ï…Ï„Î­Ï‚ Î¿Î¹ Î¸ÏÏÎµÏ‚ Î´ÎµÎ½ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î´Î·Î¼ÏŒÏƒÎ¹Î± ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½ÎµÏ‚. Î”ÎµÎ¯Ï„Îµ Ï„Î¿Î½ [Î¿Î´Î·Î³ÏŒ Î´Î¹ÎºÏ„ÏÏ‰ÏƒÎ·Ï‚](https://www.rabbitmq.com/networking.html) Î³Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚. **ÎœÏŒÎ½Î¿ 9 Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î¸ÏÏÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î±Î½Î¿Î¹Ï‡Ï„Î­Ï‚ ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿**.
* 35672-35682: Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ ÎµÏÎ³Î±Î»ÎµÎ¯Î± CLI (Î¸ÏÏÎµÏ‚ Ï€ÎµÎ»Î¬Ï„Î· Î´Î¹Î±Î½Î¿Î¼Î®Ï‚ Erlang) Î³Î¹Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼Îµ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ ÎºÎ±Î¹ Î­Ï‡Î¿Ï…Î½ ÎµÎºÏ‡Ï‰ÏÎ·Î¸ÎµÎ¯ Î±Ï€ÏŒ Î¼Î¹Î± Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Ï€ÎµÏÎ¹Î¿Ï‡Î® (Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î­Î½Î· Ï‰Ï‚ Î¸ÏÏÎ± Î´Î¹Î±Î½Î¿Î¼Î®Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® + 10000 Î­Ï‰Ï‚ Î¸ÏÏÎ± Î´Î¹Î±Î½Î¿Î¼Î®Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® + 10010). Î”ÎµÎ¯Ï„Îµ Ï„Î¿Î½ [Î¿Î´Î·Î³ÏŒ Î´Î¹ÎºÏ„ÏÏ‰ÏƒÎ·Ï‚](https://www.rabbitmq.com/networking.html) Î³Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚.
* 61613, 61614: [STOMP clients](https://stomp.github.io/stomp-specification-1.2.html) Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¹ Î¼Îµ TLS (Î¼ÏŒÎ½Î¿ Î±Î½ Ï„Î¿ [STOMP plugin](https://www.rabbitmq.com/stomp.html) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿). Î›Î¹Î³ÏŒÏ„ÎµÏÎµÏ‚ Î±Ï€ÏŒ 10 ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Î¼Îµ Î±Ï…Ï„Î® Ï„Î· Î¸ÏÏÎ± Î±Î½Î¿Î¹Ï‡Ï„Î® ÎºÎ±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ UDP Î³Î¹Î± ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ DHT.

## Shodan

* `AMQP`

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
