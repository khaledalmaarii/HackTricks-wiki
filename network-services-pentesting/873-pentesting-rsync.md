# 873 - Pentesting Rsync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **ê¸°ë³¸ ì •ë³´**

From [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync**ëŠ” ì»´í“¨í„°ì™€ ì™¸ì¥ í•˜ë“œ ë“œë¼ì´ë¸Œ ê°„, ê·¸ë¦¬ê³  [ë„¤íŠ¸ì›Œí¬í™”ëœ](https://en.wikipedia.org/wiki/Computer\_network) [ì»´í“¨í„°](https://en.wikipedia.org/wiki/Computer) ê°„ì— [íŒŒì¼](https://en.wikipedia.org/wiki/Computer\_file)ì„ íš¨ìœ¨ì ìœ¼ë¡œ [ì „ì†¡](https://en.wikipedia.org/wiki/File\_transfer)í•˜ê³  [ë™ê¸°í™”](https://en.wikipedia.org/wiki/File\_synchronization)í•˜ëŠ” ìœ í‹¸ë¦¬í‹°ë¡œ, [ìˆ˜ì • ì‹œê°„](https://en.wikipedia.org/wiki/Timestamping\_\(computing\))ê³¼ íŒŒì¼ í¬ê¸°ë¥¼ ë¹„êµí•˜ì—¬ ì‘ë™í•©ë‹ˆë‹¤.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) ì¼ë°˜ì ìœ¼ë¡œ [ìœ ë‹‰ìŠ¤ ê³„ì—´](https://en.wikipedia.org/wiki/Unix-like) [ìš´ì˜ ì²´ì œ](https://en.wikipedia.org/wiki/Operating\_system)ì—ì„œ ë°œê²¬ë©ë‹ˆë‹¤. rsync ì•Œê³ ë¦¬ì¦˜ì€ [ë¸íƒ€ ì¸ì½”ë”©](https://en.wikipedia.org/wiki/Delta\_encoding)ì˜ ì¼ì¢…ì´ë©°, ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. [Zlib](https://en.wikipedia.org/wiki/Zlib)ëŠ” ì¶”ê°€ì ì¸ [ë°ì´í„° ì••ì¶•](https://en.wikipedia.org/wiki/Data\_compression)ì— ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ë˜ëŠ” [stunnel](https://en.wikipedia.org/wiki/Stunnel)ì€ ë³´ì•ˆì„ ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## ì—´ê±°

### ë°°ë„ˆ ë° ìˆ˜ë™ í†µì‹ 
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **ê³µìœ  í´ë” ì—´ê±°í•˜ê¸°**

**Rsync ëª¨ë“ˆ**ì€ **ë¹„ë°€ë²ˆí˜¸ë¡œ ë³´í˜¸ë  ìˆ˜ ìˆëŠ” ë””ë ‰í† ë¦¬ ê³µìœ **ë¡œ ì¸ì‹ë©ë‹ˆë‹¤. ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“ˆì„ ì‹ë³„í•˜ê³  ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
ì¼ë¶€ ê³µìœ ê°€ ëª©ë¡ì— ë‚˜íƒ€ë‚˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ìˆ¨ê²¨ì ¸ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì¼ë¶€ ê³µìœ ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì€ íŠ¹ì • **ìê²© ì¦ëª…**ì— ì œí•œë  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” **"Access Denied"** ë©”ì‹œì§€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### ìˆ˜ë™ Rsync ì‚¬ìš©

**ëª¨ë“ˆ ëª©ë¡**ì„ ì–»ì€ í›„, ì‘ì—…ì€ ì¸ì¦ì´ í•„ìš”í•œì§€ ì—¬ë¶€ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì¸ì¦ ì—†ì´ **ëª©ë¡**ì„ ì‘ì„±í•˜ê³  ê³µìœ  í´ë”ì—ì„œ ë¡œì»¬ ë””ë ‰í† ë¦¬ë¡œ íŒŒì¼ì„ **ë³µì‚¬**í•˜ëŠ” ê²ƒì€ ë‹¤ìŒì„ í†µí•´ ìˆ˜í–‰ë©ë‹ˆë‹¤:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
ì´ í”„ë¡œì„¸ìŠ¤ëŠ” **ì¬ê·€ì ìœ¼ë¡œ íŒŒì¼ì„ ì „ì†¡**í•˜ë©°, íŒŒì¼ì˜ ì†ì„±ê³¼ ê¶Œí•œì„ ìœ ì§€í•©ë‹ˆë‹¤.

**ìê²© ì¦ëª…**ì„ ì‚¬ìš©í•˜ë©´ ê³µìœ  í´ë”ì—ì„œ ëª©ë¡ì„ ì‘ì„±í•˜ê³  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ë•Œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í”„ë¡¬í”„íŠ¸ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
To **upload content**, such as an _**authorized_keys**_ íŒŒì¼ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ìœ„í•´, ì‚¬ìš©í•˜ì‹­ì‹œì˜¤:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

rsyncd êµ¬ì„± íŒŒì¼ì„ ì°¾ìœ¼ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
ì´ íŒŒì¼ ë‚´ì—ì„œ _secrets file_ ë§¤ê°œë³€ìˆ˜ëŠ” rsyncd ì¸ì¦ì„ ìœ„í•œ **ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸**ê°€ í¬í•¨ëœ íŒŒì¼ì„ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## References
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
