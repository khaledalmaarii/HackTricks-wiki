# 873 - æ¸—é€æµ‹è¯• Rsync

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„ **å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢ [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## **åŸºæœ¬ä¿¡æ¯**

æ¥è‡ª [ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Rsync)ï¼š

> **rsync** æ˜¯ä¸€ç§ç”¨äºåœ¨è®¡ç®—æœºå’Œå¤–éƒ¨ç¡¬ç›˜é©±åŠ¨å™¨ä¹‹é—´ä»¥åŠè·¨ç½‘ç»œè®¡ç®—æœºä¹‹é—´é«˜æ•ˆ [ä¼ è¾“](https://en.wikipedia.org/wiki/File\_transfer) å’Œ [åŒæ­¥](https://en.wikipedia.org/wiki/File\_synchronization) [æ–‡ä»¶](https://en.wikipedia.org/wiki/Computer\_file) çš„å®ç”¨ç¨‹åºï¼Œé€šè¿‡æ¯”è¾ƒæ–‡ä»¶çš„ [ä¿®æ”¹æ—¶é—´](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) å’Œå¤§å°æ¥å®ç°ã€‚[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) å®ƒé€šå¸¸åœ¨ [ç±» Unix](https://en.wikipedia.org/wiki/Unix-like) [æ“ä½œç³»ç»Ÿ](https://en.wikipedia.org/wiki/Operating\_system) ä¸Šæ‰¾åˆ°ã€‚rsync ç®—æ³•æ˜¯ä¸€ç§ [å¢é‡ç¼–ç ](https://en.wikipedia.org/wiki/Delta\_encoding) ç±»å‹ï¼Œç”¨äºæœ€å°åŒ–ç½‘ç»œä½¿ç”¨ã€‚[Zlib](https://en.wikipedia.org/wiki/Zlib) å¯ç”¨äºé¢å¤–çš„ [æ•°æ®å‹ç¼©](https://en.wikipedia.org/wiki/Data\_compression)ï¼Œ[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) å¹¶ä¸”å¯ä»¥ä½¿ç”¨ [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) æˆ– [stunnel](https://en.wikipedia.org/wiki/Stunnel) æ¥æä¾›å®‰å…¨æ€§ã€‚

**é»˜è®¤ç«¯å£ï¼š** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## æšä¸¾

### æ¨ªå¹… & æ‰‹åŠ¨é€šä¿¡
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **æšä¸¾å…±äº«æ–‡ä»¶å¤¹**

**Rsyncæ¨¡å—** è¢«è¯†åˆ«ä¸ºå¯èƒ½å—å¯†ç ä¿æŠ¤çš„ **ç›®å½•å…±äº«**ã€‚ä¸ºäº†è¯†åˆ«å¯ç”¨æ¨¡å—å¹¶æ£€æŸ¥å®ƒä»¬æ˜¯å¦éœ€è¦å¯†ç ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
è¯·æ³¨æ„ï¼ŒæŸäº›å…±äº«å¯èƒ½ä¸ä¼šå‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼Œå¯èƒ½è¢«éšè—ã€‚æ­¤å¤–ï¼Œè®¿é—®æŸäº›å…±äº«å¯èƒ½ä¼šå—åˆ°ç‰¹å®š**å‡­æ®**é™åˆ¶ï¼Œè¿™ä¼šæ˜¾ç¤º**"æ‹’ç»è®¿é—®"**æ¶ˆæ¯ã€‚

### [**æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#rsync)

### æ‰‹åŠ¨ä½¿ç”¨ Rsync

åœ¨è·å–**æ¨¡å—åˆ—è¡¨**åï¼Œæ“ä½œå–å†³äºæ˜¯å¦éœ€è¦èº«ä»½éªŒè¯ã€‚æ²¡æœ‰èº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ä»¥ä»å…±äº«æ–‡ä»¶å¤¹**åˆ—å‡º**å’Œ**å¤åˆ¶**æ–‡ä»¶åˆ°æœ¬åœ°ç›®å½•ï¼š
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
è¿™ä¸ªè¿‡ç¨‹**é€’å½’ä¼ è¾“æ–‡ä»¶**ï¼Œä¿ç•™å®ƒä»¬çš„å±æ€§å’Œæƒé™ã€‚

ä½¿ç”¨**å‡­æ®**ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼åˆ—å‡ºå…±äº«æ–‡ä»¶å¤¹å¹¶ä¸‹è½½æ–‡ä»¶ï¼Œä¼šå‡ºç°å¯†ç æç¤ºï¼š
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
è¦**ä¸Šä¼ å†…å®¹**ï¼Œæ¯”å¦‚ä¸€ä¸ªç”¨äºè®¿é—®çš„_**authorized_keys**_æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ï¼š
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

è¦å®šä½rsyncdé…ç½®æ–‡ä»¶ï¼Œè¯·æ‰§è¡Œï¼š
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
## å‚è€ƒèµ„æ–™
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
