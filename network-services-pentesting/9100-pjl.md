<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# åŸºæœ¬ä¿¡æ¯

åŸå§‹æ‰“å°æ˜¯æˆ‘ä»¬å®šä¹‰çš„ä¸€ç§è¿æ¥åˆ°ç½‘ç»œæ‰“å°æœºçš„9100/tcpç«¯å£çš„è¿‡ç¨‹ã€‚å®ƒæ˜¯CUPSå’ŒWindowsæ‰“å°æ¶æ„ç”¨äºä¸ç½‘ç»œæ‰“å°æœºé€šä¿¡çš„é»˜è®¤æ–¹æ³•ï¼Œå› ä¸ºå®ƒè¢«è®¤ä¸ºæ˜¯â€œæœ€ç®€å•ã€æœ€å¿«ã€é€šå¸¸ä¹Ÿæ˜¯æœ€å¯é çš„ç”¨äºæ‰“å°æœºçš„ç½‘ç»œåè®®â€ã€‚åŸå§‹ç«¯å£9100æ‰“å°ï¼Œä¹Ÿç§°ä¸ºJetDirectã€AppSocketæˆ–PDLæ•°æ®æµï¼Œå®é™…ä¸Š**ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ‰“å°åè®®**ã€‚ç›¸åï¼Œ**æ‰€æœ‰å‘é€çš„æ•°æ®éƒ½ç›´æ¥ç”±æ‰“å°è®¾å¤‡å¤„ç†**ï¼Œå°±åƒé€šè¿‡TCPçš„å¹¶è¡Œè¿æ¥ä¸€æ ·ã€‚ä¸LPDã€IPPå’ŒSMBä¸åŒï¼Œè¿™å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€ç›´æ¥åé¦ˆï¼ŒåŒ…æ‹¬çŠ¶æ€å’Œé”™è¯¯æ¶ˆæ¯ã€‚è¿™æ ·çš„**åŒå‘é€šé“**ä½¿æˆ‘ä»¬å¯ä»¥ç›´æ¥**è®¿é—®**PJLã€PostScriptæˆ–PCLå‘½ä»¤çš„**ç»“æœ**ã€‚å› æ­¤ï¼Œå‡ ä¹ä»»ä½•ç½‘ç»œæ‰“å°æœºéƒ½æ”¯æŒçš„åŸå§‹ç«¯å£9100æ‰“å°è¢«ç”¨ä½œä½¿ç”¨PRETå’ŒPFTè¿›è¡Œå®‰å…¨åˆ†æçš„é€šé“ã€‚ï¼ˆæ¥è‡ª[è¿™é‡Œ](http://hacking-printers.net/wiki/index.php/Port\_9100\_printing)ï¼‰

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº[**é»‘å®¢æ”»å‡»æ‰“å°æœºçš„ä¿¡æ¯ï¼Œè¯·é˜…è¯»æ­¤é¡µé¢**](pentesting-printers/)ã€‚

**é»˜è®¤ç«¯å£ï¼š** 9100
```
9100/tcp open  jetdirect
```
# æšä¸¾

## æ‰‹åŠ¨æšä¸¾

### PJL (Printer Job Language)

PJLï¼ˆæ‰“å°æœºä½œä¸šè¯­è¨€ï¼‰æ˜¯ä¸€ç§ç”¨äºæ§åˆ¶æ‰“å°æœºè¡Œä¸ºçš„å‘½ä»¤è¯­è¨€ã€‚é€šè¿‡å‘é€PJLå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æœ‰å…³æ‰“å°æœºçš„ä¿¡æ¯ï¼Œå¦‚æ‰“å°æœºå‹å·ã€é…ç½®å’ŒçŠ¶æ€ã€‚

PJLå‘½ä»¤é€šå¸¸é€šè¿‡ç½‘ç»œç«¯å£9100å‘é€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨telnetæˆ–ncå‘½ä»¤è¿æ¥åˆ°è¯¥ç«¯å£ï¼Œå¹¶å‘é€PJLå‘½ä»¤ä»¥è·å–æ‰“å°æœºä¿¡æ¯ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„PJLå‘½ä»¤ï¼š

- `@PJL INFO ID`ï¼šè·å–æ‰“å°æœºçš„æ ‡è¯†ä¿¡æ¯ã€‚
- `@PJL INFO CONFIG`ï¼šè·å–æ‰“å°æœºçš„é…ç½®ä¿¡æ¯ã€‚
- `@PJL INFO STATUS`ï¼šè·å–æ‰“å°æœºçš„çŠ¶æ€ä¿¡æ¯ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€šè¿‡telnetè¿æ¥åˆ°9100ç«¯å£ï¼Œå¹¶å‘é€PJLå‘½ä»¤ï¼š

```bash
telnet <target_ip> 9100
```

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å‘é€PJLå‘½ä»¤å¹¶æŸ¥çœ‹æ‰“å°æœºçš„å“åº”ã€‚

### PJLå‘½ä»¤ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„PJLå‘½ä»¤ç¤ºä¾‹ï¼š

- è·å–æ‰“å°æœºæ ‡è¯†ä¿¡æ¯ï¼š

```bash
@PJL INFO ID
```

- è·å–æ‰“å°æœºé…ç½®ä¿¡æ¯ï¼š

```bash
@PJL INFO CONFIG
```

- è·å–æ‰“å°æœºçŠ¶æ€ä¿¡æ¯ï¼š

```bash
@PJL INFO STATUS
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘é€è¿™äº›å‘½ä»¤æ¥æšä¸¾æ‰“å°æœºçš„ä¿¡æ¯ï¼Œå¹¶äº†è§£å…¶é…ç½®å’ŒçŠ¶æ€ã€‚
```bash
nc -vn <IP> 9100
@PJL INFO STATUS      #CODE=40000   DISPLAY="Sleep"   ONLINE=TRUE
@PJL INFO ID          # ID (Brand an version): Brother HL-L2360D series:84U-F75:Ver.b.26
@PJL INFO PRODINFO    #Product info
@PJL FSDIRLIST NAME="0:\" ENTRY=1 COUNT=65535  #List dir
@PJL INFO VARIABLES   #Env variales
@PJL INFO FILESYS     #?
@PJL INFO TIMEOUT     #Timeout variables
@PJL RDYMSG           #Ready message
@PJL FSINIT
@PJL FSDIRLIST
@PJL FSUPLOAD         #Useful to upload a file
@PJL FSDOWNLOAD       #Useful to download a file
@PJL FSDELETE         #Useful to delete a file
```
## è‡ªåŠ¨åŒ–

In some cases, it is possible to automate the exploitation of the PJL vulnerability using tools like Metasploit or custom scripts. These tools can send the necessary PJL commands to the printer and exploit the vulnerability without manual intervention.

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¯¸å¦‚Metasploitæˆ–è‡ªå®šä¹‰è„šæœ¬ä¹‹ç±»çš„å·¥å…·è‡ªåŠ¨åŒ–åˆ©ç”¨PJLæ¼æ´ã€‚è¿™äº›å·¥å…·å¯ä»¥å‘æ‰“å°æœºå‘é€å¿…è¦çš„PJLå‘½ä»¤ï¼Œå¹¶åœ¨æ— éœ€æ‰‹åŠ¨å¹²é¢„çš„æƒ…å†µä¸‹åˆ©ç”¨æ¼æ´ã€‚

For example, using Metasploit, you can use the `exploit/windows/printer/pjl_bounce` module to exploit the PJL vulnerability. This module allows you to specify the target printer's IP address, the PJL command to execute, and the payload to deliver.

ä¾‹å¦‚ï¼Œä½¿ç”¨Metasploitï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`exploit/windows/printer/pjl_bounce`æ¨¡å—æ¥åˆ©ç”¨PJLæ¼æ´ã€‚è¯¥æ¨¡å—å…è®¸æ‚¨æŒ‡å®šç›®æ ‡æ‰“å°æœºçš„IPåœ°å€ã€è¦æ‰§è¡Œçš„PJLå‘½ä»¤å’Œè¦ä¼ é€’çš„æœ‰æ•ˆè½½è·ã€‚

Another option is to create a custom script using a programming language like Python. This script can send the necessary PJL commands to the printer and exploit the vulnerability. By automating the exploitation process, you can save time and effort during a penetration test.

å¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨Pythonç­‰ç¼–ç¨‹è¯­è¨€åˆ›å»ºè‡ªå®šä¹‰è„šæœ¬ã€‚è¯¥è„šæœ¬å¯ä»¥å‘æ‰“å°æœºå‘é€å¿…è¦çš„PJLå‘½ä»¤å¹¶åˆ©ç”¨æ¼æ´ã€‚é€šè¿‡è‡ªåŠ¨åŒ–åˆ©ç”¨è¿‡ç¨‹ï¼Œæ‚¨å¯ä»¥åœ¨æ¸—é€æµ‹è¯•æœŸé—´èŠ‚çœæ—¶é—´å’Œç²¾åŠ›ã€‚

However, it is important to note that automated exploitation should only be performed on systems that you have proper authorization to test. Unauthorized exploitation of PJL vulnerabilities can lead to legal consequences.

ç„¶è€Œï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œåªæœ‰åœ¨æ‚¨è·å¾—é€‚å½“æˆæƒçš„ç³»ç»Ÿä¸Šæ‰èƒ½è¿›è¡Œè‡ªåŠ¨åŒ–åˆ©ç”¨ã€‚å¯¹PJLæ¼æ´çš„æœªç»æˆæƒåˆ©ç”¨å¯èƒ½ä¼šå¯¼è‡´æ³•å¾‹åæœã€‚
```bash
nmap -sV --script pjl-ready-message -p <PORT> <IP>
```

```bash
msf> use auxiliary/scanner/printer/printer_env_vars
msf> use auxiliary/scanner/printer/printer_list_dir
msf> use auxiliary/scanner/printer/printer_list_volumes
msf> use auxiliary/scanner/printer/printer_ready_message
msf> use auxiliary/scanner/printer/printer_version_info
msf> use auxiliary/scanner/printer/printer_download_file
msf> use auxiliary/scanner/printer/printer_upload_file
msf> use auxiliary/scanner/printer/printer_delete_file
```
## æ‰“å°æœºé»‘å®¢å·¥å…·

è¿™æ˜¯ä½ æƒ³è¦ä½¿ç”¨çš„æ»¥ç”¨æ‰“å°æœºçš„å·¥å…·ï¼š

{% embed url="https://github.com/RUB-NDS/PRET" %}

## é»‘å®¢æ‰“å°æœºçš„æœ€ä½³å‚è€ƒ

{% embed url="https://hacking-printers.net/wiki/index.php/File_system_access" %}

# **Shodan**

* `pjl port:9100`


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTricksçš„è¡£ç‰©**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
