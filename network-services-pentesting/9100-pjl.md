<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>


# Podstawowe informacje

Z [tej](http://hacking-printers.net/wiki/index.php/Port\_9100\_printing) strony: Drukowanie bezpoÅ›rednie to proces nawiÄ…zania poÅ‚Ä…czenia z portem 9100/tcp drukarki sieciowej. Jest to domyÅ›lna metoda uÅ¼ywana przez CUPS i architekturÄ™ drukowania systemu Windows do komunikacji z drukarkami sieciowymi, poniewaÅ¼ jest uwaÅ¼ana za â€najprostszÄ…, najszybszÄ… i ogÃ³lnie najbardziej niezawodnÄ… protokÃ³Å‚ sieciowy uÅ¼ywany do drukarekâ€. Drukowanie bezpoÅ›rednie na porcie 9100, zwane rÃ³wnieÅ¼ JetDirect, AppSocket lub strumieniem danych PDL, **nie jest protokoÅ‚em drukowania samym w sobie**. Zamiast tego **wszystkie wysyÅ‚ane dane sÄ… bezpoÅ›rednio przetwarzane przez urzÄ…dzenie drukujÄ…ce**, tak jak w przypadku poÅ‚Ä…czenia rÃ³wnolegÅ‚ego przez TCP. W przeciwieÅ„stwie do LPD, IPP i SMB, moÅ¼e to przesyÅ‚aÄ‡ bezpoÅ›rednie informacje zwrotne do klienta, w tym status i komunikaty o bÅ‚Ä™dach. Taki **dwukierunkowy kanaÅ‚** daje nam bezpoÅ›redni **dostÄ™p** do **wynikÃ³w** poleceÅ„ **PJL**, **PostScript** lub **PCL**. Dlatego drukowanie bezpoÅ›rednie na porcie 9100 - obsÅ‚ugiwane przez prawie kaÅ¼dÄ… drukarkÄ™ sieciowÄ… - jest uÅ¼ywane jako kanaÅ‚ do analizy zabezpieczeÅ„ za pomocÄ… PRET i PFT.

JeÅ›li chcesz dowiedzieÄ‡ siÄ™ wiÄ™cej na temat [**hakowania drukarek, przeczytaj tÄ™ stronÄ™**](http://hacking-printers.net/wiki/index.php/Main_Page).

**DomyÅ›lny port:** 9100
```
9100/tcp open  jetdirect
```
# Wyliczanie

## RÄ™czne wyliczanie
```bash
nc -vn <IP> 9100
@PJL INFO STATUS      #CODE=40000   DISPLAY="Sleep"   ONLINE=TRUE
@PJL INFO ID          # ID (Brand an version): Brother HL-L2360D series:84U-F75:Ver.b.26
@PJL INFO PRODINFO    #Product info
@PJL FSDIRLIST NAME="0:\" ENTRY=1 COUNT=65535  #List dir
@PJL INFO VARIABLES   #Env variales
@PJL INFO FILESYS     #?
@PJL INFO TIMEOUT     #Timeout variables
@PJL RDYMSG           #Ready message
@PJL FSINIT
@PJL FSDIRLIST
@PJL FSUPLOAD         #Useful to upload a file
@PJL FSDOWNLOAD       #Useful to download a file
@PJL FSDELETE         #Useful to delete a file
```
## Automatyczne

### PJL (Printer Job Language)

PJL (Printer Job Language) to jÄ™zyk sterujÄ…cy drukarkami laserowymi, ktÃ³ry umoÅ¼liwia zarzÄ…dzanie rÃ³Å¼nymi aspektami drukowania, takimi jak konfiguracja, monitorowanie i kontrola zadaÅ„ drukowania. PJL jest uÅ¼ywany przez drukarki laserowe HP i niektÃ³re inne modele drukarek.

### SÅ‚abe punkty

1. **Brak uwierzytelnienia**: Wiele drukarek HP obsÅ‚uguje PJL bez wymagania uwierzytelnienia, co oznacza, Å¼e â€‹â€‹osoba zdalnie podÅ‚Ä…czona do sieci moÅ¼e uzyskaÄ‡ dostÄ™p do funkcji zarzÄ…dzania drukarkÄ… bez koniecznoÅ›ci podawania hasÅ‚a.

2. **WraÅ¼liwe komendy**: PJL zawiera wiele komend, ktÃ³re mogÄ… byÄ‡ wykorzystane do wykonania nieautoryzowanych dziaÅ‚aÅ„, takich jak resetowanie drukarki, zmiana konfiguracji, wydrukowanie poufnych dokumentÃ³w itp.

### Ataki

1. **Zmiana konfiguracji**: AtakujÄ…cy moÅ¼e wykorzystaÄ‡ komendy PJL, aby zmieniÄ‡ konfiguracjÄ™ drukarki, takÄ… jak adres IP, maskÄ™ podsieci, bramÄ™ domyÅ›lnÄ… itp. MoÅ¼e to prowadziÄ‡ do dezorganizacji sieci i utraty dostÄ™pu do drukarki.

2. **Wykonanie poleceÅ„**: AtakujÄ…cy moÅ¼e wykorzystaÄ‡ komendy PJL do wykonania poleceÅ„ na drukarce. MoÅ¼e to obejmowaÄ‡ resetowanie drukarki, wydrukowanie poufnych dokumentÃ³w, zmianÄ™ ustawieÅ„ fabrycznych itp.

3. **Przechwytywanie danych**: AtakujÄ…cy moÅ¼e wykorzystaÄ‡ komendy PJL do przechwycenia danych drukowanych przez drukarkÄ™. MoÅ¼e to obejmowaÄ‡ przechwytywanie poufnych dokumentÃ³w, haseÅ‚, informacji o sieci itp.

### Zabezpieczenia

Aby zabezpieczyÄ‡ drukarkÄ™ przed atakami PJL, naleÅ¼y podjÄ…Ä‡ nastÄ™pujÄ…ce kroki:

1. **WÅ‚Ä…cz uwierzytelnianie**: Skonfiguruj drukarkÄ™ tak, aby wymagaÅ‚a uwierzytelnienia przed udostÄ™pnieniem dostÄ™pu do funkcji zarzÄ…dzania drukarkÄ….

2. **Ogranicz dostÄ™p do sieci**: Skonfiguruj drukarkÄ™ tak, aby ograniczyÄ‡ dostÄ™p do niej tylko do zaufanych adresÃ³w IP lub podsieci.

3. **Zaktualizuj oprogramowanie**: Regularnie aktualizuj oprogramowanie drukarki, aby zapewniÄ‡ najnowsze poprawki zabezpieczeÅ„.

4. **Monitoruj logi**: Regularnie monitoruj logi drukarki w celu wykrywania podejrzanej aktywnoÅ›ci.

5. **WyÅ‚Ä…cz niepotrzebne usÅ‚ugi**: WyÅ‚Ä…cz niepotrzebne usÅ‚ugi drukarki, ktÃ³re mogÄ… byÄ‡ potencjalnymi punktami ataku.

### NarzÄ™dzia

PoniÅ¼ej znajdujÄ… siÄ™ niektÃ³re narzÄ™dzia, ktÃ³re mogÄ… byÄ‡ przydatne podczas testowania penetracyjnego drukarek obsÅ‚ugujÄ…cych PJL:

- **PJLTester**: NarzÄ™dzie do testowania penetracyjnego drukarek obsÅ‚ugujÄ…cych PJL. Pozwala na wysyÅ‚anie komend PJL i analizowanie odpowiedzi drukarki.

- **PJLScan**: NarzÄ™dzie do skanowania sieci w poszukiwaniu drukarek obsÅ‚ugujÄ…cych PJL. Pozwala na identyfikacjÄ™ drukarek i przeprowadzenie testÃ³w penetracyjnych.

- **PJLExploit**: NarzÄ™dzie do wykorzystywania sÅ‚abych punktÃ³w w drukarkach obsÅ‚ugujÄ…cych PJL. Pozwala na automatyczne wykonywanie atakÃ³w, takich jak zmiana konfiguracji, wykonanie poleceÅ„ itp.
```bash
nmap -sV --script pjl-ready-message -p <PORT> <IP>
```

```bash
msf> use auxiliary/scanner/printer/printer_env_vars
msf> use auxiliary/scanner/printer/printer_list_dir
msf> use auxiliary/scanner/printer/printer_list_volumes
msf> use auxiliary/scanner/printer/printer_ready_message
msf> use auxiliary/scanner/printer/printer_version_info
msf> use auxiliary/scanner/printer/printer_download_file
msf> use auxiliary/scanner/printer/printer_upload_file
msf> use auxiliary/scanner/printer/printer_delete_file
```
## NarzÄ™dzie do hakowania drukarek

To jest narzÄ™dzie, ktÃ³re chcesz uÅ¼yÄ‡ do naduÅ¼ywania drukarek:

{% embed url="https://github.com/RUB-NDS/PRET" %}

# **Shodan**

* `pjl port:9100`


<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
