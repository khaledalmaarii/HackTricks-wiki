# 9200 - Pentesting Elasticsearch

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

Elasticsearchã¯ã€**åˆ†æ•£å‹**ã€**ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹**ã®æ¤œç´¢ãŠã‚ˆã³åˆ†æã‚¨ãƒ³ã‚¸ãƒ³ã§ã€**ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿**ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚**é€Ÿåº¦**ã€**ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**ã€ãŠã‚ˆã³**ã‚·ãƒ³ãƒ—ãƒ«ãªREST API**ã§çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚Apache Luceneã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã€2010å¹´ã«Elasticsearch N.V.ï¼ˆç¾åœ¨ã¯Elasticã¨ã—ã¦çŸ¥ã‚‰ã‚Œã‚‹ï¼‰ã«ã‚ˆã£ã¦æœ€åˆã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚Elasticsearchã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šè¾¼ã¿ã€å¼·åŒ–ã€ä¿å­˜ã€åˆ†æã€è¦–è¦šåŒ–ã®ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹Elastic Stackã®ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚ã“ã®ã‚¹ã‚¿ãƒƒã‚¯ã¯ä¸€èˆ¬ã«ELKã‚¹ã‚¿ãƒƒã‚¯ã¨å‘¼ã°ã‚Œã€Logstashã‚„Kibanaã‚‚å«ã¾ã‚Œã€ç¾åœ¨ã¯Beatsã¨å‘¼ã°ã‚Œã‚‹è»½é‡ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚ã‚Šã¾ã™ã€‚

### Elasticsearchã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã¯ï¼Ÿ

Elasticsearchã®**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ã¯ã€**é–¢é€£ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã€**JSON**ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€**ã‚­ãƒ¼**ã¨ãã‚Œã«å¯¾å¿œã™ã‚‹**å€¤**ï¼ˆæ–‡å­—åˆ—ã€æ•°å€¤ã€ãƒ–ãƒ¼ãƒ«å€¤ã€æ—¥ä»˜ã€é…åˆ—ã€åœ°ç†ä½ç½®æƒ…å ±ãªã©ï¼‰ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

Elasticsearchã¯ã€åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹**é€†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**ã‚’ä½¿ç”¨ã—ã¦ã€é«˜é€Ÿãªå…¨æ–‡æ¤œç´¢ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚ã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…ã®ã™ã¹ã¦ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå˜èªã‚’ãƒªã‚¹ãƒˆã—ã€å„å˜èªãŒå‡ºç¾ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç‰¹å®šã—ã¾ã™ã€‚

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆãƒ—ãƒ­ã‚»ã‚¹ä¸­ã«ã€Elasticsearchã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä¿å­˜ã—ã€é€†ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ§‹ç¯‰ã—ã€ã»ã¼ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®æ¤œç´¢ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹API**ã¯ã€ç‰¹å®šã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã®JSONãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã¾ãŸã¯æ›´æ–°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ**: 9200/tcp

## æ‰‹å‹•åˆ—æŒ™

### ãƒãƒŠãƒ¼

Elasticsearchã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯**HTTP**ã§ã™ã€‚HTTPçµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ã„ãã¤ã‹ã®èˆˆå‘³æ·±ã„æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã™: `http://10.10.10.115:9200/`

![](<../.gitbook/assets/image (294).png>)

`/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã®å¿œç­”ãŒè¦‹ãˆãªã„å ´åˆã¯ã€æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### èªè¨¼

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯Elasticsearchã«ã¯èªè¨¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã¾ã›ã‚“**ã®ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯è³‡æ ¼æƒ…å ±ã‚’ä½¿ç”¨ã›ãšã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ã™ã¹ã¦ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

èªè¨¼ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã¾ã™:
```bash
curl -X GET "ELASTICSEARCH-SERVER:9200/_xpack/security/user"
{"error":{"root_cause":[{"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."}],"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."},"status":500}
```
**ã—ã‹ã—**ã€`/` ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€æ¬¡ã®ã‚ˆã†ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã£ãŸå ´åˆï¼š
```bash
{"error":{"root_cause":[{"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}}],"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}},"status":401}
```
ãã‚Œã¯ã€èªè¨¼ãŒè¨­å®šã•ã‚Œã¦ãŠã‚Šã€**æœ‰åŠ¹ãªè³‡æ ¼æƒ…å ±ãŒå¿…è¦**ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚æ¬¡ã«ã€[**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™**](../generic-methodologies-and-resources/brute-force.md#elasticsearch)ï¼ˆHTTPåŸºæœ¬èªè¨¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€HTTPåŸºæœ¬èªè¨¼ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã™ã‚‹ãŸã‚ã®ä»»æ„ã®æ–¹æ³•ãŒä½¿ç”¨ã§ãã¾ã™ï¼‰ã€‚\
ã“ã“ã«**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®ãƒªã‚¹ãƒˆ**ãŒã‚ã‚Šã¾ã™ï¼š_**elastic**ï¼ˆã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã€remote\_monitoring\_userã€beats\_systemã€logstash\_systemã€kibanaã€kibana\_systemã€apm\_systemã€_ \_anonymous\_ã€‚_ Elasticsearchã®å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯**changeme**ã§ã™ã€‚
```
curl -X GET http://user:password@IP:9200/
```
### åŸºæœ¬çš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ—æŒ™
```bash
#List all roles on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/role"

#List all users on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user"

#Get more information about the rights of an user:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user/<USERNAME>"
```
### Elastic Info

ä»¥ä¸‹ã¯ã€elasticsearchã«é–¢ã™ã‚‹**æƒ…å ±**ã‚’**å–å¾—**ã™ã‚‹ãŸã‚ã«**GET**ã§**ã‚¢ã‚¯ã‚»ã‚¹**ã§ãã‚‹ã„ãã¤ã‹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ï¼š

| \_cat                           | /\_cluster                    | /\_security               |
| ------------------------------- | ----------------------------- | ------------------------- |
| /\_cat/segments                 | /\_cluster/allocation/explain | /\_security/user          |
| /\_cat/shards                   | /\_cluster/settings           | /\_security/privilege     |
| /\_cat/repositories             | /\_cluster/health             | /\_security/role\_mapping |
| /\_cat/recovery                 | /\_cluster/state              | /\_security/role          |
| /\_cat/plugins                  | /\_cluster/stats              | /\_security/api\_key      |
| /\_cat/pending\_tasks           | /\_cluster/pending\_tasks     |                           |
| /\_cat/nodes                    | /\_nodes                      |                           |
| /\_cat/tasks                    | /\_nodes/usage                |                           |
| /\_cat/templates                | /\_nodes/hot\_threads         |                           |
| /\_cat/thread\_pool             | /\_nodes/stats                |                           |
| /\_cat/ml/trained\_models       | /\_tasks                      |                           |
| /\_cat/transforms/\_all         | /\_remote/info                |                           |
| /\_cat/aliases                  |                               |                           |
| /\_cat/allocation               |                               |                           |
| /\_cat/ml/anomaly\_detectors    |                               |                           |
| /\_cat/count                    |                               |                           |
| /\_cat/ml/data\_frame/analytics |                               |                           |
| /\_cat/ml/datafeeds             |                               |                           |
| /\_cat/fielddata                |                               |                           |
| /\_cat/health                   |                               |                           |
| /\_cat/indices                  |                               |                           |
| /\_cat/master                   |                               |                           |
| /\_cat/nodeattrs                |                               |                           |
| /\_cat/nodes                    |                               |                           |

ã“ã‚Œã‚‰ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€[**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰å–å¾—ã•ã‚ŒãŸã‚‚ã®**](https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html)ã§ã€**è©³ç´°**ã‚’**è¦‹ã¤ã‘ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã¾ãŸã€`/_cat`ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹`/_cat/*`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå«ã¾ã‚Œã¾ã™ã€‚

`/_security/user`ï¼ˆèªè¨¼ãŒæœ‰åŠ¹ãªå ´åˆï¼‰ã§ã¯ã€ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ`superuser`ã®å½¹å‰²ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### Indices

`http://10.10.10.115:9200/_cat/indices?v`ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ã€**ã™ã¹ã¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åé›†**ã§ãã¾ã™ã€‚
```
health status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .kibana 6tjAYZrgQ5CwwR0g6VOoRg   1   0          1            0        4kb            4kb
yellow open   quotes  ZG2D1IqkQNiNZmi2HRImnQ   5   1        253            0    262.7kb        262.7kb
yellow open   bank    eSVpNfCfREyYoVigNWcrMw   5   1       1000            0    483.2kb        483.2kb
```
**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã«ã¯**ã€æ¬¡ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™: `http://host:9200/<index>`ã€‚ã“ã®å ´åˆã®ä¾‹ã¯ `http://10.10.10.115:9200/bank` ã§ã™ã€‚

![](<../.gitbook/assets/image (342).png>)

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ€ãƒ³ãƒ—

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®**ã™ã¹ã¦ã®å†…å®¹ã‚’ãƒ€ãƒ³ãƒ—ã—ãŸã„å ´åˆ**ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™: `http://host:9200/<index>/_search?pretty=true`ã€‚ä¾‹ãˆã° `http://10.10.10.115:9200/bank/_search?pretty=true` ã®ã‚ˆã†ã«ã€‚

![](<../.gitbook/assets/image (914).png>)

_éŠ€è¡Œã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã®å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆã‚¨ãƒ³ãƒˆãƒªï¼‰ã®å†…å®¹ã¨ã€å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¦‹ãŸã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¯”è¼ƒã™ã‚‹æ™‚é–“ã‚’å–ã£ã¦ãã ã•ã„ã€‚_

ã“ã®æ™‚ç‚¹ã§ã€**"hits" å†…ã« "total" ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã€**ã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã«**1000ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã£ãŸ**ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ä»˜ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å®Ÿéš›ã«ã¯10ä»¶ã—ã‹å–å¾—ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§10ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚**\
ã—ã‹ã—ã€**ã“ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«1000ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã®ã§ã€**ãƒ€ãƒ³ãƒ—ã—ãŸã„ã‚¨ãƒ³ãƒˆãƒªã®æ•°ã‚’**`size`**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã—ã¦ã€**ã™ã¹ã¦ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**: `http://10.10.10.115:9200/quotes/_search?pretty=true&size=1000`asd\
_æ³¨: ã‚ˆã‚Šå¤§ããªæ•°ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒˆãƒªãŒãƒ€ãƒ³ãƒ—ã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã° `size=9999` ã¨æŒ‡å®šã™ã‚‹ã¨ã€ã‚¨ãƒ³ãƒˆãƒªãŒã‚‚ã£ã¨ã‚ã£ãŸå ´åˆã¯å¥‡å¦™ã«ãªã‚Šã¾ã™ï¼ˆãŸã ã—ã€ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚_

### ã™ã¹ã¦ã‚’ãƒ€ãƒ³ãƒ—

ã™ã¹ã¦ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã«ã¯ã€**ä»¥å‰ã¨åŒã˜ãƒ‘ã‚¹ã«è¡Œãã¾ã™ãŒã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æŒ‡å®šã—ãªã„ã§ãã ã•ã„**: `http://host:9200/_search?pretty=true`ã€‚ä¾‹ãˆã° `http://10.10.10.115:9200/_search?pretty=true` ã®ã‚ˆã†ã«ã€‚\
ã“ã®å ´åˆã€**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®10ä»¶ã®åˆ¶é™**ãŒé©ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚`size`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€**ã‚ˆã‚Šå¤šãã®çµæœã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãŠèª­ã¿ãã ã•ã„ã€‚

### æ¤œç´¢

æƒ…å ±ã‚’æ¢ã—ã¦ã„ã‚‹å ´åˆã¯ã€ã™ã¹ã¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§**ç”Ÿã®æ¤œç´¢ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™**: `http://host:9200/_search?pretty=true&q=<search_term>`ã€‚ä¾‹ãˆã° `http://10.10.10.115:9200/_search?pretty=true&q=Rockwell` ã®ã‚ˆã†ã«ã€‚

![](<../.gitbook/assets/image (335).png>)

ç‰¹å®šã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§**æ¤œç´¢ã—ãŸã„å ´åˆ**ã¯ã€**ãƒ‘ã‚¹**ã«ãã‚Œã‚’**æŒ‡å®š**ã™ã‚‹ã ã‘ã§ã™: `http://host:9200/<index>/_search?pretty=true&q=<search_term>`

_æ¤œç´¢ã«ä½¿ç”¨ã•ã‚Œã‚‹qãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€**æ­£è¦è¡¨ç¾ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™**ã€‚_

ã¾ãŸã€[https://github.com/misalabs/horuz](https://github.com/misalabs/horuz)ã®ã‚ˆã†ãªã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ã€elasticsearchã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒ•ã‚¡ã‚ºã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### æ›¸ãè¾¼ã¿æ¨©é™

æ–°ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†…ã«æ–°ã—ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã‚ˆã†ã¨ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèªã§ãã¾ã™:
```bash
curl -X POST '10.10.10.115:9200/bookindex/books' -H 'Content-Type: application/json' -d'
{
"bookId" : "A00-3",
"author" : "Sankaran",
"publisher" : "Mcgrahill",
"name" : "how to get a job"
}'
```
ãã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å±æ€§ "_bookId_"ã€"_author_"ã€"_publisher_"ã€ãŠã‚ˆã³ "_name_" ã‚’æŒã¤ `books` ã‚¿ã‚¤ãƒ—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æŒã¤ **æ–°ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹** `bookindex` ã‚’ä½œæˆã—ã¾ã™ã€‚

**æ–°ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãƒªã‚¹ãƒˆã«è¡¨ç¤ºã•ã‚Œã‚‹**ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

![](<../.gitbook/assets/image (130).png>)

ãã—ã¦ã€**è‡ªå‹•çš„ã«ä½œæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

![](<../.gitbook/assets/image (434).png>)

## è‡ªå‹•åˆ—æŒ™

ã„ãã¤ã‹ã®ãƒ„ãƒ¼ãƒ«ã¯ã€å‰ã«ç¤ºã—ãŸãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã‚’å–å¾—ã—ã¾ã™ï¼š
```bash
msf > use auxiliary/scanner/elasticsearch/indices_enum
```
{% embed url="https://github.com/theMiddleBlue/nmap-elasticsearch-nse" %}

## Shodan

* `port:9200 elasticsearch`

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„!
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
