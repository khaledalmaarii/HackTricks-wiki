# 9200 - Pentesting Elasticsearch

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic information

Elasticsearch ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î·**, **Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ±** Î¼Î·Ï‡Î±Î½Î® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚ Î³Î¹Î± **ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½**. Î•Î¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„Î® Î³Î¹Î± Ï„Î·Î½ **Ï„Î±Ï‡ÏÏ„Î·Ï„Î¬** Ï„Î·Ï‚, **ÎºÎ»Î¹Î¼Î±ÎºÏ‰ÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±** ÎºÎ±Î¹ **Î±Ï€Î»Î­Ï‚ REST APIs**. Î§Ï„Î¹ÏƒÎ¼Î­Î½Î· Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿Î½ Apache Lucene, ÎºÏ…ÎºÎ»Î¿Ï†ÏŒÏÎ·ÏƒÎµ Î³Î¹Î± Ï€ÏÏÏ„Î· Ï†Î¿ÏÎ¬ Ï„Î¿ 2010 Î±Ï€ÏŒ Ï„Î·Î½ Elasticsearch N.V. (Ï„ÏÏÎ± Î³Î½Ï‰ÏƒÏ„Î® Ï‰Ï‚ Elastic). Î¤Î¿ Elasticsearch ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î²Î±ÏƒÎ¹ÎºÏŒ ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÏŒ Ï„Î¿Ï… Elastic Stack, Î¼Î¹Î±Ï‚ ÏƒÏ…Î»Î»Î¿Î³Î®Ï‚ ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½ Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ± Î³Î¹Î± Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®, ÎµÎ¼Ï€Î»Î¿Ï…Ï„Î¹ÏƒÎ¼ÏŒ, Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·, Î±Î½Î¬Î»Ï…ÏƒÎ· ÎºÎ±Î¹ Î¿Ï€Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½. Î‘Ï…Ï„Î® Î· ÏƒÏ„Î¿Î¯Î²Î±, Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï‰Ï‚ ELK Stack, Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï„Î¿ Logstash ÎºÎ±Î¹ Ï„Î¿ Kibana, ÎºÎ±Î¹ Ï„ÏÏÎ± Î­Ï‡ÎµÎ¹ ÎµÎ»Î±Ï†ÏÎ¹Î¿ÏÏ‚ Ï€ÏÎ¬ÎºÏ„Î¿ÏÎµÏ‚ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ Beats.

### What is an Elasticsearch index?

ÎˆÎ½Î±Ï‚ **Î´ÎµÎ¯ÎºÏ„Î·Ï‚** Elasticsearch ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÏƒÏ…Î»Î»Î¿Î³Î® **ÏƒÏ‡ÎµÏ„Î¹ÎºÏÎ½ ÎµÎ³Î³ÏÎ¬Ï†Ï‰Î½** Ï€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ Ï‰Ï‚ **JSON**. ÎšÎ¬Î¸Îµ Î­Î³Î³ÏÎ±Ï†Î¿ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ **ÎºÎ»ÎµÎ¹Î´Î¹Î¬** ÎºÎ±Î¹ Ï„Î¹Ï‚ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡ÎµÏ‚ **Ï„Î¹Î¼Î­Ï‚** Ï„Î¿Ï…Ï‚ (Î±Î»Ï†Î±ÏÎ¹Î¸Î¼Î·Ï„Î¹ÎºÎ¬, Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚, boolean, Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚, Ï€Î¯Î½Î±ÎºÎµÏ‚, Î³ÎµÏ‰Î³ÏÎ±Ï†Î¹ÎºÎ­Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚, Îº.Î»Ï€.).

Î¤Î¿ Elasticsearch Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÎ® Î´Î¿Î¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **Î±Î½Ï„ÎµÏƒÏ„ÏÎ±Î¼Î¼Î­Î½Î¿Ï‚ Î´ÎµÎ¯ÎºÏ„Î·Ï‚** Î³Î¹Î± Î½Î± Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÎ¹ Ï„Î¹Ï‚ Î³ÏÎ®Î³Î¿ÏÎµÏ‚ Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚ Ï€Î»Î®ÏÎ¿Ï…Ï‚ ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…. Î‘Ï…Ï„ÏŒÏ‚ Î¿ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÎ¹ ÎºÎ¬Î¸Îµ Î¼Î¿Î½Î±Î´Î¹ÎºÎ® Î»Î­Î¾Î· ÏƒÏ„Î± Î­Î³Î³ÏÎ±Ï†Î± ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î± ÏƒÏ„Î± Î¿Ï€Î¿Î¯Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÎºÎ¬Î¸Îµ Î»Î­Î¾Î·.

ÎšÎ±Ï„Î¬ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÏ…ÏÎµÏ„Î·ÏÎ¯Î±ÏƒÎ·Ï‚, Ï„Î¿ Elasticsearch Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î± ÎºÎ±Î¹ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬Î¶ÎµÎ¹ Ï„Î¿Î½ Î±Î½Ï„ÎµÏƒÏ„ÏÎ±Î¼Î¼Î­Î½Î¿ Î´ÎµÎ¯ÎºÏ„Î·, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÏƒÏ‡ÎµÎ´ÏŒÎ½ Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿. Î— **API Î´ÎµÎ¯ÎºÏ„Î·** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î® Ï„Î·Î½ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎµÎ³Î³ÏÎ¬Ï†Ï‰Î½ JSON ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï… Î´ÎµÎ¯ÎºÏ„Î·.

**Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î¸ÏÏÎ±**: 9200/tcp

## Manual Enumeration

### Banner

Î¤Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ Elasticsearch ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **HTTP**. ÎŒÏ„Î±Î½ Ï„Î¿ Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎµÏ„Îµ Î¼Î­ÏƒÏ‰ HTTP, Î¸Î± Î²ÏÎµÎ¯Ï„Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚: `http://10.10.10.115:9200/`

![](<../.gitbook/assets/image (294).png>)

Î‘Î½ Î´ÎµÎ½ Î´ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ `/`, Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î±.

### Authentication

**Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Ï„Î¿ Elasticsearch Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·**, Î¿Ï€ÏŒÏ„Îµ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÏŒÎ»Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î¼Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Ï€ÏÎ¿Ï‚:
```bash
curl -X GET "ELASTICSEARCH-SERVER:9200/_xpack/security/user"
{"error":{"root_cause":[{"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."}],"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."},"status":500}
```
**Î©ÏƒÏ„ÏŒÏƒÎ¿**, Î±Î½ ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± ÏƒÏ„Î¿ `/` ÎºÎ±Î¹ Î»Î¬Î²ÎµÏ„Îµ Î¼Î¹Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Î· Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```bash
{"error":{"root_cause":[{"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}}],"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}},"status":401}
```
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î· ÎºÎ±Î¹ **Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î­Î³ÎºÏ…ÏÎ± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Î±Ï€ÏŒ Ï„Î¿ elasticsearch. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± [**Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î½Î± Ï„Î¿ ÏƒÏ€Î¬ÏƒÎµÏ„Îµ**](../generic-methodologies-and-resources/brute-force.md#elasticsearch) (Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ HTTP basic auth, Î¿Ï€ÏŒÏ„Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ€Î¬ÏƒÎµÎ¹ Ï„Î¿ HTTP basic auth Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯).\
Î•Î´Ï Î­Ï‡ÎµÏ„Îµ Î¼Î¹Î± **Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï‡ÏÎ®ÏƒÏ„Î·**: _**elastic** (superuser), remote\_monitoring\_user, beats\_system, logstash\_system, kibana, kibana\_system, apm\_system,_ \_anonymous\_.\_ ÎŸÎ¹ Ï€Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Elasticsearch Î­Ï‡Î¿Ï…Î½ Ï„Î¿Î½ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ **changeme** Î³Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·.
```
curl -X GET http://user:password@IP:9200/
```
### Î’Î±ÏƒÎ¹ÎºÎ® ÎšÎ±Ï„Î±Î¼Î­Ï„ÏÎ·ÏƒÎ· Î§ÏÎ·ÏƒÏ„ÏÎ½
```bash
#List all roles on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/role"

#List all users on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user"

#Get more information about the rights of an user:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user/<USERNAME>"
```
### Elastic Info

Here are some endpoints that you can **access via GET** to **obtain** some **information** about elasticsearch:

| \_cat                           | /\_cluster                    | /\_security               |
| ------------------------------- | ----------------------------- | ------------------------- |
| /\_cat/segments                 | /\_cluster/allocation/explain | /\_security/user          |
| /\_cat/shards                   | /\_cluster/settings           | /\_security/privilege     |
| /\_cat/repositories             | /\_cluster/health             | /\_security/role\_mapping |
| /\_cat/recovery                 | /\_cluster/state              | /\_security/role          |
| /\_cat/plugins                  | /\_cluster/stats              | /\_security/api\_key      |
| /\_cat/pending\_tasks           | /\_cluster/pending\_tasks     |                           |
| /\_cat/nodes                    | /\_nodes                      |                           |
| /\_cat/tasks                    | /\_nodes/usage                |                           |
| /\_cat/templates                | /\_nodes/hot\_threads         |                           |
| /\_cat/thread\_pool             | /\_nodes/stats                |                           |
| /\_cat/ml/trained\_models       | /\_tasks                      |                           |
| /\_cat/transforms/\_all         | /\_remote/info                |                           |
| /\_cat/aliases                  |                               |                           |
| /\_cat/allocation               |                               |                           |
| /\_cat/ml/anomaly\_detectors    |                               |                           |
| /\_cat/count                    |                               |                           |
| /\_cat/ml/data\_frame/analytics |                               |                           |
| /\_cat/ml/datafeeds             |                               |                           |
| /\_cat/fielddata                |                               |                           |
| /\_cat/health                   |                               |                           |
| /\_cat/indices                  |                               |                           |
| /\_cat/master                   |                               |                           |
| /\_cat/nodeattrs                |                               |                           |
| /\_cat/nodes                    |                               |                           |

These endpoints were [**taken from the documentation**](https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html) where you can **find more**.\
Also, if you access `/_cat` the response will contain the `/_cat/*` endpoints supported by the instance.

In `/_security/user` (if auth enabled) you can see which user has role `superuser`.

### Indices

You can **gather all the indices** accessing `http://10.10.10.115:9200/_cat/indices?v`
```
health status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .kibana 6tjAYZrgQ5CwwR0g6VOoRg   1   0          1            0        4kb            4kb
yellow open   quotes  ZG2D1IqkQNiNZmi2HRImnQ   5   1        253            0    262.7kb        262.7kb
yellow open   bank    eSVpNfCfREyYoVigNWcrMw   5   1       1000            0    483.2kb        483.2kb
```
Î“Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ **Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï€Î¿Î¹Î¿ ÎµÎ¯Î´Î¿Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î±Î½ Î´ÎµÎ¯ÎºÏ„Î·** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·: `http://host:9200/<index>` Î±Ï€ÏŒ Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· `http://10.10.10.115:9200/bank`

![](<../.gitbook/assets/image (342).png>)

### Dump index

Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± **ÎµÎ¾Î¬Î³ÎµÏ„Îµ ÏŒÎ»Î± Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î±** ÎµÎ½ÏŒÏ‚ Î´ÎµÎ¯ÎºÏ„Î· Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·: `http://host:9200/<index>/_search?pretty=true` ÏŒÏ€Ï‰Ï‚ `http://10.10.10.115:9200/bank/_search?pretty=true`

![](<../.gitbook/assets/image (914).png>)

_Î Î¬ÏÏ„Îµ Î¼Î¹Î± ÏƒÏ„Î¹Î³Î¼Î® Î³Î¹Î± Î½Î± ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÏ„Îµ Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± ÎºÎ¬Î¸Îµ ÎµÎ³Î³ÏÎ¬Ï†Î¿Ï… (ÎºÎ±Ï„Î±Ï‡ÏÏÎ¹ÏƒÎ·) Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î· bank ÎºÎ±Î¹ Ï„Î± Ï€ÎµÎ´Î¯Î± Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… Î´ÎµÎ¯ÎºÏ„Î· Ï€Î¿Ï… ÎµÎ¯Î´Î±Î¼Îµ ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î±._

ÎˆÏ„ÏƒÎ¹, ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ **Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "total" Î¼Î­ÏƒÎ± ÏƒÎµ "hits"** Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ **Î²ÏÎ­Î¸Î·ÎºÎ±Î½ 1000 Î­Î³Î³ÏÎ±Ï†Î±** Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Î´ÎµÎ¯ÎºÏ„Î· Î±Î»Î»Î¬ Î¼ÏŒÎ½Î¿ 10 Î±Î½Î±ÎºÏ„Î®Î¸Î·ÎºÎ±Î½. Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® **ÎºÎ±Ï„Î¬ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏŒÏÎ¹Î¿ 10 ÎµÎ³Î³ÏÎ¬Ï†Ï‰Î½**.\
Î‘Î»Î»Î¬, Ï„ÏÏÎ± Ï€Î¿Ï… Î¾Î­ÏÎµÏ„Îµ ÏŒÏ„Î¹ **Î±Ï…Ï„ÏŒÏ‚ Î¿ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ 1000 Î­Î³Î³ÏÎ±Ï†Î±**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎ¾Î¬Î³ÎµÏ„Îµ ÏŒÎ»Î± Î±Ï…Ï„Î¬** Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Ï„Ï‰Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÏ‰Î½ Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÎµÎ¾Î¬Î³ÎµÏ„Îµ ÏƒÏ„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ **`size`**: `http://10.10.10.115:9200/quotes/_search?pretty=true&size=1000`asd\
_Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: Î‘Î½ Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Î±ÏÎ¹Î¸Î¼ÏŒ, ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÎ¹Ï‚ Î¸Î± ÎµÎ¾Î±Ï‡Î¸Î¿ÏÎ½ Î¿ÏÏ„Ï‰Ï‚ Î® Î¬Î»Î»Ï‰Ï‚, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ `size=9999` ÎºÎ±Î¹ Î¸Î± Î®Ï„Î±Î½ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ Î±Î½ Ï…Ï€Î®ÏÏ‡Î±Î½ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÎ¹Ï‚ (Î±Î»Î»Î¬ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ)._

### Dump all

Î“Î¹Î± Î½Î± ÎµÎ¾Î¬Î³ÎµÏ„Îµ ÏŒÎ»Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î±Ï€Î»Î¬ Î½Î± Ï€Î¬Ï„Îµ ÏƒÏ„Î¿ **Î¯Î´Î¹Î¿ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ¹Î½ Î±Î»Î»Î¬ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÎºÎ±Î½Î­Î½Î±Î½ Î´ÎµÎ¯ÎºÏ„Î·** `http://host:9200/_search?pretty=true` ÏŒÏ€Ï‰Ï‚ `http://10.10.10.115:9200/_search?pretty=true`\
Î˜Ï…Î¼Î·Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¸Î± ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„ÎµÎ¯ Ï„Î¿ **Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ ÏŒÏÎ¹Î¿ Ï„Ï‰Î½ 10** Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î¬Ï„Ï‰Î½. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `size` Î³Î¹Î± Î½Î± ÎµÎ¾Î¬Î³ÎµÏ„Îµ Î¼Î¹Î± **Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Ï€Î¿ÏƒÏŒÏ„Î·Ï„Î± Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î¬Ï„Ï‰Î½**. Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î± Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.

### Search

Î‘Î½ ÏˆÎ¬Ï‡Î½ÎµÏ„Îµ Î³Î¹Î± ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Î¼Î¹Î± **Î±ÎºÎ±Ï„Î­ÏÎ³Î±ÏƒÏ„Î· Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚** Ï€Î·Î³Î±Î¯Î½Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿ `http://host:9200/_search?pretty=true&q=<search_term>` ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ `http://10.10.10.115:9200/_search?pretty=true&q=Rockwell`

![](<../.gitbook/assets/image (335).png>)

Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î±Ï€Î»Î¬ Î½Î± **Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÏ„Îµ ÏƒÎµ Î­Î½Î±Î½ Î´ÎµÎ¯ÎºÏ„Î·** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î±Ï€Î»Î¬ Î½Î± **Ï„Î¿Î½ Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ** ÏƒÏ„Î¿ **Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹**: `http://host:9200/<index>/_search?pretty=true&q=<search_term>`

_Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î· Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ q Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï… **Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ­Ï‚ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚**_

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎºÎ¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚ [https://github.com/misalabs/horuz](https://github.com/misalabs/horuz) Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ fuzz ÏƒÎµ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± elasticsearch.

### Write permissions

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎ±Ï‚ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÏÎ½Ï„Î±Ï‚ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î½Î­Î¿ Î­Î³Î³ÏÎ±Ï†Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î±Î½ Î½Î­Î¿ Î´ÎµÎ¯ÎºÏ„Î· ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ ÎºÎ¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```bash
curl -X POST '10.10.10.115:9200/bookindex/books' -H 'Content-Type: application/json' -d'
{
"bookId" : "A00-3",
"author" : "Sankaran",
"publisher" : "Mcgrahill",
"name" : "how to get a job"
}'
```
Î‘Ï…Ï„Î® Î· ÎµÎ½Ï„Î¿Î»Î® Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î±Î½ **Î½Î­Î¿ Î´ÎµÎ¯ÎºÏ„Î·** Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `bookindex` Î¼Îµ Î­Î½Î± Î­Î³Î³ÏÎ±Ï†Î¿ Ï„ÏÏ€Î¿Ï… `books` Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Ï„Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ "_bookId_", "_author_", "_publisher_" ÎºÎ±Î¹ "_name_"

Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÏ„Îµ Ï€ÏÏ‚ Î¿ **Î½Î­Î¿Ï‚ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï„ÏÏÎ± ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±**:

![](<../.gitbook/assets/image (130).png>)

ÎšÎ±Î¹ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ Ï„Î¹Ï‚ **Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½ÎµÏ‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚**:

![](<../.gitbook/assets/image (434).png>)

## Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î‘ÏÎ¯Î¸Î¼Î·ÏƒÎ·

ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î¸Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ ÎºÎ¬Ï€Î¿Î¹Î± Î±Ï€ÏŒ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬ÏƒÏ„Î·ÎºÎ±Î½ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚:
```bash
msf > use auxiliary/scanner/elasticsearch/indices_enum
```
{% embed url="https://github.com/theMiddleBlue/nmap-elasticsearch-nse" %}

## Shodan

* `port:9200 elasticsearch`

{% hint style="success" %}
ÎœÎ¬Î¸Îµ & ÎµÎ¾Î¬ÏƒÎºÎ·ÏƒÎµ Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸Îµ & ÎµÎ¾Î¬ÏƒÎºÎ·ÏƒÎµ Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Îµ Ï„Î¿ HackTricks</summary>

* ÎˆÎ»ÎµÎ³Î¾Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î£Ï…Î¼Î¼ÎµÏ„Î¬ÏƒÏ‡ÎµÏ„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ­ Î¼Î±Ï‚ ÏƒÏ„Î¿** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ¬ÏƒÎ¿Ï… ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
