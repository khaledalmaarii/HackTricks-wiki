# 9200 - Pentesting Elasticsearch

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

Elasticsearch —î **—Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏–º**, **–≤—ñ–¥–∫—Ä–∏—Ç–∏–º** –ø–æ—à—É–∫–æ–≤–∏–º —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–º –¥–≤–∏–≥—É–Ω–æ–º –¥–ª—è **–≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö**. –í—ñ–Ω –≤—ñ–¥–æ–º–∏–π —Å–≤–æ—î—é **—à–≤–∏–¥–∫—ñ—Å—Ç—é**, **–º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—é** —Ç–∞ **–ø—Ä–æ—Å—Ç–∏–º–∏ REST API**. –ü–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ Apache Lucene, –≤–ø–µ—Ä—à–µ –±—É–≤ –≤–∏–ø—É—â–µ–Ω–∏–π —É 2010 —Ä–æ—Ü—ñ –∫–æ–º–ø–∞–Ω—ñ—î—é Elasticsearch N.V. (—Ç–µ–ø–µ—Ä –≤—ñ–¥–æ–º–∞ —è–∫ Elastic). Elasticsearch —î –æ—Å–Ω–æ–≤–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º Elastic Stack, –∫–æ–ª–µ–∫—Ü—ñ—ó –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∑–±–æ—Ä—É, –∑–±–∞–≥–∞—á–µ–Ω–Ω—è, –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è, –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö. –¶–µ–π —Å—Ç–µ–∫, –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è ELK Stack, —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–∞—î Logstash —Ç–∞ Kibana, –∞ —Ç–µ–ø–µ—Ä –º–∞—î –ª–µ–≥–∫—ñ –∞–≥–µ–Ω—Ç–∏ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö, —è–∫—ñ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è Beats.

### –©–æ —Ç–∞–∫–µ —ñ–Ω–¥–µ–∫—Å Elasticsearch?

–Ü–Ω–¥–µ–∫—Å Elasticsearch —î –∫–æ–ª–µ–∫—Ü—ñ—î—é **–ø–æ–≤'—è–∑–∞–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**, –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —É —Ñ–æ—Ä–º–∞—Ç—ñ **JSON**. –ö–æ–∂–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ **–∫–ª—é—á—ñ–≤** —Ç–∞ —ó—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö **–∑–Ω–∞—á–µ–Ω—å** (—Ä—è–¥–∫–∏, —á–∏—Å–ª–∞, –±—É–ª–µ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –¥–∞—Ç–∏, –º–∞—Å–∏–≤–∏, –≥–µ–æ–ª–æ–∫–∞—Ü—ñ—ó —Ç–æ—â–æ).

Elasticsearch –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö, –∑–≤–∞–Ω—É **—ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–º —ñ–Ω–¥–µ–∫—Å–æ–º**, –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ–≤–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ—à—É–∫—É. –¶–µ–π —ñ–Ω–¥–µ–∫—Å –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î –∫–æ–∂–Ω–µ —É–Ω—ñ–∫–∞–ª—å–Ω–µ —Å–ª–æ–≤–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö —ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –¥–æ–∫—É–º–µ–Ω—Ç–∏, –≤ —è–∫–∏—Ö –∑'—è–≤–ª—è—î—Ç—å—Å—è –∫–æ–∂–Ω–µ —Å–ª–æ–≤–æ.

–ü—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—ó Elasticsearch –∑–±–µ—Ä—ñ–≥–∞—î –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–π —ñ–Ω–¥–µ–∫—Å, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –ø–æ—à—É–∫ –º–∞–π–∂–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ. **API —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—ó** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è JSON-–¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —ñ–Ω–¥–µ–∫—Å—ñ.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**: 9200/tcp

## –†—É—á–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è

### –ë–∞–Ω–µ—Ä

–ü—Ä–æ—Ç–æ–∫–æ–ª, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ Elasticsearch, —î **HTTP**. –ö–æ–ª–∏ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ HTTP, –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –¥–µ—è–∫—É —Ü—ñ–∫–∞–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é: `http://10.10.10.115:9200/`

![](<../.gitbook/assets/image (294).png>)

–Ø–∫—â–æ –≤–∏ –Ω–µ –±–∞—á–∏—Ç–µ —Ü—å–æ–≥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É.

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

**–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤ Elasticsearch –Ω–µ –≤–≤—ñ–º–∫–Ω–µ–Ω–∞**, —Ç–æ–º—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—å–æ–≥–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—É–¥—å-—è–∫–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∏–º–∫–Ω–µ–Ω–∞, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ –∑–∞–ø–∏—Ç –¥–æ:
```bash
curl -X GET "ELASTICSEARCH-SERVER:9200/_xpack/security/user"
{"error":{"root_cause":[{"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."}],"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."},"status":500}
```
**–û–¥–Ω–∞–∫**, —è–∫—â–æ –≤–∏ –Ω–∞–¥—ñ—à–ª–µ—Ç–µ –∑–∞–ø–∏—Ç –¥–æ `/` —ñ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –ø–æ–¥—ñ–±–Ω—É –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó:
```bash
{"error":{"root_cause":[{"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}}],"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}},"status":401}
```
–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞, —ñ **–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –±—É–¥—å-—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ elasticsearch. –¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ [**—Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å**](../generic-methodologies-and-resources/brute-force.md#elasticsearch) (–≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HTTP basic auth, —Ç–æ–º—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Å–µ, —â–æ BF HTTP basic auth –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏).\
–û—Å—å —É –≤–∞—Å —î **—Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**: _**elastic** (—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á), remote\_monitoring\_user, beats\_system, logstash\_system, kibana, kibana\_system, apm\_system,_ \_anonymous\_. –°—Ç–∞—Ä—ñ –≤–µ—Ä—Å—ñ—ó Elasticsearch –º–∞—é—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –ø–∞—Ä–æ–ª—å **changeme** –¥–ª—è —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
```
curl -X GET http://user:password@IP:9200/
```
### –ë–∞–∑–æ–≤–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
```bash
#List all roles on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/role"

#List all users on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user"

#Get more information about the rights of an user:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user/<USERNAME>"
```
### Elastic Info

–û—Å—å –∫—ñ–ª—å–∫–∞ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫, –¥–æ —è–∫–∏—Ö –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ—Å—Ç—É–ø–∏—Ç–∏—Å—è —á–µ—Ä–µ–∑ GET**, —â–æ–± **–æ—Ç—Ä–∏–º–∞—Ç–∏** –¥–µ—è–∫—É **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é** –ø—Ä–æ elasticsearch:

| \_cat                           | /\_cluster                    | /\_security               |
| ------------------------------- | ----------------------------- | ------------------------- |
| /\_cat/segments                 | /\_cluster/allocation/explain | /\_security/user          |
| /\_cat/shards                   | /\_cluster/settings           | /\_security/privilege     |
| /\_cat/repositories             | /\_cluster/health             | /\_security/role\_mapping |
| /\_cat/recovery                 | /\_cluster/state              | /\_security/role          |
| /\_cat/plugins                  | /\_cluster/stats              | /\_security/api\_key      |
| /\_cat/pending\_tasks           | /\_cluster/pending\_tasks     |                           |
| /\_cat/nodes                    | /\_nodes                      |                           |
| /\_cat/tasks                    | /\_nodes/usage                |                           |
| /\_cat/templates                | /\_nodes/hot\_threads         |                           |
| /\_cat/thread\_pool             | /\_nodes/stats                |                           |
| /\_cat/ml/trained\_models       | /\_tasks                      |                           |
| /\_cat/transforms/\_all         | /\_remote/info                |                           |
| /\_cat/aliases                  |                               |                           |
| /\_cat/allocation               |                               |                           |
| /\_cat/ml/anomaly\_detectors    |                               |                           |
| /\_cat/count                    |                               |                           |
| /\_cat/ml/data\_frame/analytics |                               |                           |
| /\_cat/ml/datafeeds             |                               |                           |
| /\_cat/fielddata                |                               |                           |
| /\_cat/health                   |                               |                           |
| /\_cat/indices                  |                               |                           |
| /\_cat/master                   |                               |                           |
| /\_cat/nodeattrs                |                               |                           |
| /\_cat/nodes                    |                               |                           |

–¶—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ –±—É–ª–∏ [**–≤–∑—è—Ç–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó**](https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html), –¥–µ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à–µ**.\
–¢–∞–∫–æ–∂, —è–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ `/_cat`, –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç–∏–º–µ `/_cat/*` –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–æ–º.

–£ `/_security/user` (—è–∫—â–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —É–≤—ñ–º–∫–Ω–µ–Ω–∞) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Ä–æ–ª—å `superuser`.

### Indices

–í–∏ –º–æ–∂–µ—Ç–µ **–∑—ñ–±—Ä–∞—Ç–∏ –≤—Å—ñ —ñ–Ω–¥–µ–∫—Å–∏**, –æ—Ç—Ä–∏–º—É—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ `http://10.10.10.115:9200/_cat/indices?v`
```
health status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .kibana 6tjAYZrgQ5CwwR0g6VOoRg   1   0          1            0        4kb            4kb
yellow open   quotes  ZG2D1IqkQNiNZmi2HRImnQ   5   1        253            0    262.7kb        262.7kb
yellow open   bank    eSVpNfCfREyYoVigNWcrMw   5   1       1000            0    483.2kb        483.2kb
```
–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ç–µ, —è–∫—ñ –¥–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —ñ–Ω–¥–µ–∫—Å—ñ**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ: `http://host:9200/<index>` –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É `http://10.10.10.115:9200/bank`

![](<../.gitbook/assets/image (342).png>)

### –í–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å—ñ –≤–º—ñ—Å—Ç–∏** —ñ–Ω–¥–µ–∫—Å—É, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ: `http://host:9200/<index>/_search?pretty=true`, —è–∫ `http://10.10.10.115:9200/bank/_search?pretty=true`

![](<../.gitbook/assets/image (914).png>)

_–í–∏—Ç—Ä–∞—Ç—å—Ç–µ —Ö–≤–∏–ª–∏–Ω—É, —â–æ–± –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–∑–∞–ø–∏—Å—É) –≤ —ñ–Ω–¥–µ–∫—Å—ñ bank —Ç–∞ –ø–æ–ª—è —Ü—å–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É, —è–∫—ñ –º–∏ –±–∞—á–∏–ª–∏ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ._

–û—Ç–∂–µ, –Ω–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–º—ñ—Ç–∏—Ç–∏, —â–æ **—ñ—Å–Ω—É—î –ø–æ–ª–µ –ø—ñ–¥ –Ω–∞–∑–≤–æ—é "total" –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ "hits"**, —è–∫–µ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ **–≤ —Ü—å–æ–º—É —ñ–Ω–¥–µ–∫—Å—ñ –∑–Ω–∞–π–¥–µ–Ω–æ 1000 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**, –∞–ª–µ –ª–∏—à–µ 10 –±—É–ª–∏ –æ—Ç—Ä–∏–º–∞–Ω—ñ. –¶–µ —Ç–æ–º—É, —â–æ **–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —ñ—Å–Ω—É—î –æ–±–º–µ–∂–µ–Ω–Ω—è –≤ 10 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**.\
–ê–ª–µ —Ç–µ–ø–µ—Ä, –∫–æ–ª–∏ –≤–∏ –∑–Ω–∞—î—Ç–µ, —â–æ **—Ü–µ–π —ñ–Ω–¥–µ–∫—Å –º—ñ—Å—Ç–∏—Ç—å 1000 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å—ñ –∑ –Ω–∏—Ö**, –≤–∫–∞–∑–∞–≤—à–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤, —è–∫—ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ **`size`**: `http://10.10.10.115:9200/quotes/_search?pretty=true&size=1000`asd\
_–ü—Ä–∏–º—ñ—Ç–∫–∞: –Ø–∫—â–æ –≤–∏ –≤–∫–∞–∂–µ—Ç–µ –±—ñ–ª—å—à–µ —á–∏—Å–ª–æ, –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –≤—Å–µ –æ–¥–Ω–æ –±—É–¥—É—Ç—å –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –º–æ–≥–ª–∏ –± –≤–∫–∞–∑–∞—Ç–∏ `size=9999`, —ñ —Ü–µ –±—É–¥–µ –¥–∏–≤–Ω–æ, —è–∫—â–æ –±—É–¥–µ –±—ñ–ª—å—à–µ –∑–∞–ø–∏—Å—ñ–≤ (–∞–ª–µ –≤–∞–º —Å–ª—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏)._

### –í–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ

–©–æ–± –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **—Ç–æ–≥–æ –∂ —à–ª—è—Ö—É, —â–æ –π —Ä–∞–Ω—ñ—à–µ, –∞–ª–µ –±–µ–∑ –≤–∫–∞–∑—ñ–≤–∫–∏ –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É** `http://host:9200/_search?pretty=true`, —è–∫ `http://10.10.10.115:9200/_search?pretty=true`\
–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –±—É–¥–µ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ **–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –æ–±–º–µ–∂–µ–Ω–Ω—è –≤ 10** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `size`, —â–æ–± –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ **–±—ñ–ª—å—à—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**. –ß–∏—Ç–∞–π—Ç–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

### –ü–æ—à—É–∫

–Ø–∫—â–æ –≤–∏ —à—É–∫–∞—î—Ç–µ —è–∫—É—Å—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ **—Å–∏—Ä–∏–π –ø–æ—à—É–∫ –ø–æ –≤—Å—ñ—Ö —ñ–Ω–¥–µ–∫—Å–∞—Ö**, –ø–µ—Ä–µ–π—à–æ–≤—à–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é `http://host:9200/_search?pretty=true&q=<search_term>`, —è–∫ —É `http://10.10.10.115:9200/_search?pretty=true&q=Rockwell`

![](<../.gitbook/assets/image (335).png>)

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ **—à—É–∫–∞—Ç–∏ –≤ —ñ–Ω–¥–µ–∫—Å—ñ**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ **–≤–∫–∞–∑–∞—Ç–∏** –π–æ–≥–æ –≤ **—à–ª—è—Ö—É**: `http://host:9200/<index>/_search?pretty=true&q=<search_term>`

_–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä q, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–æ—à—É–∫—É –≤–º—ñ—Å—Ç—É, **–ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏**_

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ [https://github.com/misalabs/horuz](https://github.com/misalabs/horuz) –¥–ª—è —Ñ—É–∑–∑–∏–Ω–≥—É —Å–ª—É–∂–±–∏ elasticsearch.

### –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–≤–æ—ó –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å, —Å–ø—Ä–æ–±—É–≤–∞–≤—à–∏ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –≤ –Ω–æ–≤–æ–º—É —ñ–Ω–¥–µ–∫—Å—ñ, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ:
```bash
curl -X POST '10.10.10.115:9200/bookindex/books' -H 'Content-Type: application/json' -d'
{
"bookId" : "A00-3",
"author" : "Sankaran",
"publisher" : "Mcgrahill",
"name" : "how to get a job"
}'
```
–¶—è –∫–æ–º–∞–Ω–¥–∞ —Å—Ç–≤–æ—Ä–∏—Ç—å **–Ω–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å** –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `bookindex` –∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º —Ç–∏–ø—É `books`, —è–∫–∏–π –º–∞—î –∞—Ç—Ä–∏–±—É—Ç–∏ "_bookId_", "_author_", "_publisher_" —Ç–∞ "_name_"

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ **–Ω–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å —Ç–µ–ø–µ—Ä –∑'—è–≤–ª—è—î—Ç—å—Å—è —É —Å–ø–∏—Å–∫—É**:

![](<../.gitbook/assets/image (130).png>)

–Ü –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ**:

![](<../.gitbook/assets/image (434).png>)

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è

–î–µ—è–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –æ—Ç—Ä–∏–º–∞—é—Ç—å —á–∞—Å—Ç–∏–Ω—É –¥–∞–Ω–∏—Ö, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö —Ä–∞–Ω—ñ—à–µ:
```bash
msf > use auxiliary/scanner/elasticsearch/indices_enum
```
{% embed url="https://github.com/theMiddleBlue/nmap-elasticsearch-nse" %}

## Shodan

* `port:9200 elasticsearch`

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
