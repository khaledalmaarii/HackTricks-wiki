# 9200 - Elasticsearchæ¸—é€æµ‹è¯•

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

ä»[ä¸»é¡µ](https://www.elastic.co/what-is/elasticsearch)ä¸Šå¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰ç”¨çš„æè¿°ï¼š

> Elasticsearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€å¼€æºçš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œé€‚ç”¨äºå„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€æ•°å­—ã€åœ°ç†ç©ºé—´ã€ç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®ã€‚ElasticsearchåŸºäºApache Luceneæ„å»ºï¼Œäº2010å¹´é¦–æ¬¡ç”±Elasticsearch N.V.ï¼ˆç°åœ¨ç§°ä¸ºElasticï¼‰å‘å¸ƒã€‚Elasticsearchä»¥å…¶ç®€å•çš„REST APIã€åˆ†å¸ƒå¼æ€§è´¨ã€é€Ÿåº¦å’Œå¯æ‰©å±•æ€§è€Œé—»åï¼Œæ˜¯Elastic Stackçš„æ ¸å¿ƒç»„ä»¶ï¼ŒElastic Stackæ˜¯ä¸€å¥—ç”¨äºæ•°æ®æ‘„å–ã€ä¸°å¯Œã€å­˜å‚¨ã€åˆ†æå’Œå¯è§†åŒ–çš„å¼€æºå·¥å…·é›†ã€‚é€šå¸¸è¢«ç§°ä¸ºELK Stackï¼ˆæºè‡ªElasticsearchã€Logstashå’ŒKibanaï¼‰ï¼ŒElastic Stackç°åœ¨è¿˜åŒ…æ‹¬ä¸€ç³»åˆ—è½»é‡çº§çš„æ•°æ®ä¼ è¾“ä»£ç†ï¼Œç§°ä¸ºBeatsï¼Œç”¨äºå°†æ•°æ®å‘é€åˆ°Elasticsearchã€‚

### ä»€ä¹ˆæ˜¯Elasticsearchç´¢å¼•ï¼Ÿ

Elasticsearchçš„ä¸€ä¸ª_ç´¢å¼•_**æ˜¯ä¸€ç»„ç›¸å…³çš„æ–‡æ¡£**ã€‚Elasticsearchå°†æ•°æ®å­˜å‚¨ä¸ºJSONæ–‡æ¡£ã€‚æ¯ä¸ªæ–‡æ¡£å°†ä¸€ç»„_é”®_ï¼ˆå­—æ®µæˆ–å±æ€§çš„åç§°ï¼‰ä¸å…¶å¯¹åº”çš„å€¼ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€æ—¥æœŸã€å€¼æ•°ç»„ã€åœ°ç†ä½ç½®æˆ–å…¶ä»–ç±»å‹çš„æ•°æ®ï¼‰ç›¸å…³è”ã€‚

Elasticsearchä½¿ç”¨ä¸€ç§ç§°ä¸º_å€’æ’ç´¢å¼•_çš„æ•°æ®ç»“æ„ï¼Œæ—¨åœ¨å®ç°éå¸¸å¿«é€Ÿçš„å…¨æ–‡æœç´¢ã€‚å€’æ’ç´¢å¼•åˆ—å‡ºäº†å‡ºç°åœ¨ä»»ä½•æ–‡æ¡£ä¸­çš„æ¯ä¸ªå”¯ä¸€å•è¯ï¼Œå¹¶æ ‡è¯†æ¯ä¸ªå•è¯å‡ºç°åœ¨çš„æ‰€æœ‰æ–‡æ¡£ä¸­ã€‚

åœ¨ç´¢å¼•è¿‡ç¨‹ä¸­ï¼ŒElasticsearchå­˜å‚¨æ–‡æ¡£å¹¶æ„å»ºå€’æ’ç´¢å¼•ï¼Œä»¥ä½¿æ–‡æ¡£æ•°æ®å¯ä»¥è¿‘å®æ—¶åœ°è¿›è¡Œæœç´¢ã€‚ç´¢å¼•æ˜¯é€šè¿‡ç´¢å¼•APIå‘èµ·çš„ï¼Œé€šè¿‡è¯¥APIå¯ä»¥åœ¨ç‰¹å®šç´¢å¼•ä¸­æ·»åŠ æˆ–æ›´æ–°JSONæ–‡æ¡£ã€‚

**é»˜è®¤ç«¯å£**ï¼š9200/tcp

## æ‰‹åŠ¨æšä¸¾

### Banner

è®¿é—®Elasticsearchçš„åè®®æ˜¯**HTTP**ã€‚å½“ä½ é€šè¿‡HTTPè®¿é—®å®ƒæ—¶ï¼Œä½ ä¼šå‘ç°ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼š`http://10.10.10.115:9200/`

![](<../.gitbook/assets/image (264).png>)

å¦‚æœä½ åœ¨è®¿é—®`/`æ—¶æ²¡æœ‰çœ‹åˆ°è¿™ä¸ªå“åº”ï¼Œè¯·å‚è€ƒä¸‹ä¸€èŠ‚ã€‚

### è®¤è¯

**é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchæ²¡æœ‰å¯ç”¨è®¤è¯**ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•å‡­æ®çš„æƒ…å†µä¸‹è®¿é—®æ•°æ®åº“ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚

ä½ å¯ä»¥é€šè¿‡å‘ä»¥ä¸‹è¯·æ±‚éªŒè¯è®¤è¯æ˜¯å¦å·²ç¦ç”¨ï¼š
```bash
curl -X GET "ELASTICSEARCH-SERVER:9200/_xpack/security/user"
{"error":{"root_cause":[{"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."}],"type":"exception","reason":"Security must be explicitly enabled when using a [basic] license. Enable security by setting [xpack.security.enabled] to [true] in the elasticsearch.yml file and restart the node."},"status":500}
```
**ç„¶è€Œ**ï¼Œå¦‚æœæ‚¨å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°`/`å¹¶æ”¶åˆ°ä»¥ä¸‹ç±»ä¼¼çš„å“åº”ï¼š
```bash
{"error":{"root_cause":[{"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}}],"type":"security_exception","reason":"missing authentication credentials for REST request [/]","header":{"WWW-Authenticate":"Basic realm=\"security\" charset=\"UTF-8\""}},"status":401}
```
è¿™æ„å‘³ç€èº«ä»½éªŒè¯å·²é…ç½®ï¼Œ**æ‚¨éœ€è¦æœ‰æ•ˆçš„å‡­æ®**æ‰èƒ½ä»Elasticsearchè·å–ä»»ä½•ä¿¡æ¯ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥[**å°è¯•æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#elasticsearch)ï¼ˆå®ƒä½¿ç”¨HTTPåŸºæœ¬èº«ä»½éªŒè¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä»»ä½•æ”¯æŒBF HTTPåŸºæœ¬èº«ä»½éªŒè¯çš„å·¥å…·ï¼‰ã€‚\
è¿™é‡Œæœ‰ä¸€ä¸ª**é»˜è®¤ç”¨æˆ·ååˆ—è¡¨**ï¼š_**elastic**ï¼ˆè¶…çº§ç”¨æˆ·ï¼‰ï¼Œremote\_monitoring\_userï¼Œbeats\_systemï¼Œlogstash\_systemï¼Œkibanaï¼Œkibana\_systemï¼Œapm\_systemï¼Œ_ \_anonymous\_.\_æ—§ç‰ˆæœ¬çš„Elasticsearchçš„é»˜è®¤å¯†ç ä¸º**changeme**ã€‚
```
curl -X GET http://user:password@IP:9200/
```
### åŸºæœ¬ç”¨æˆ·æšä¸¾

Elasticsearchæä¾›äº†ä¸€äº›æ–¹æ³•æ¥æšä¸¾ç³»ç»Ÿä¸­çš„ç”¨æˆ·ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ï¼š

#### 1. ä½¿ç”¨APIæšä¸¾ç”¨æˆ·

é€šè¿‡å‘é€GETè¯·æ±‚åˆ°`/_cat/indices`æˆ–`/_cat/aliases`ç«¯ç‚¹ï¼Œå¯ä»¥è·å–æœ‰å…³ç´¢å¼•å’Œåˆ«åçš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯èƒ½åŒ…å«æœ‰å…³ç”¨æˆ·çš„çº¿ç´¢ã€‚

```plaintext
GET /_cat/indices
GET /_cat/aliases
```

#### 2. ä½¿ç”¨æ’ä»¶æšä¸¾ç”¨æˆ·

Elasticsearchæœ‰ä¸€äº›æ’ä»¶å¯ä»¥ç”¨äºæšä¸¾ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œ`kopf`æ’ä»¶æä¾›äº†ä¸€ä¸ªWebç•Œé¢ï¼Œå¯ä»¥æ˜¾ç¤ºæœ‰å…³é›†ç¾¤å’Œç´¢å¼•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·ä¿¡æ¯ã€‚

#### 3. ä½¿ç”¨æœç´¢æŸ¥è¯¢æšä¸¾ç”¨æˆ·

é€šè¿‡å‘é€æœç´¢æŸ¥è¯¢ï¼Œå¯ä»¥å°è¯•æšä¸¾ç”¨æˆ·ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹æŸ¥è¯¢ï¼Œç”¨äºæŸ¥æ‰¾å…·æœ‰`admin`è§’è‰²çš„ç”¨æˆ·ï¼š

```plaintext
GET /_search
{
  "query": {
    "match": {
      "roles": "admin"
    }
  }
}
```

#### 4. ä½¿ç”¨Kibanaæšä¸¾ç”¨æˆ·

å¦‚æœç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…äº†Kibanaï¼Œå¯ä»¥ä½¿ç”¨å…¶ç•Œé¢æ¥æšä¸¾ç”¨æˆ·ã€‚ç™»å½•åˆ°Kibanaåï¼Œå¯¼èˆªåˆ°"Management"é€‰é¡¹å¡ï¼Œç„¶åé€‰æ‹©"Security"ã€‚åœ¨"Users"éƒ¨åˆ†ï¼Œå¯ä»¥æŸ¥çœ‹å·²æ³¨å†Œçš„ç”¨æˆ·ã€‚

#### 5. ä½¿ç”¨å…¶ä»–å·¥å…·æšä¸¾ç”¨æˆ·

è¿˜æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·å¯ä»¥ç”¨äºæšä¸¾Elasticsearchç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œ`Elasticsearch User Enum`æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡å‘é€è¯·æ±‚æ¥æšä¸¾ç”¨æˆ·ã€‚

ä»¥ä¸Šæ˜¯ä¸€äº›åŸºæœ¬çš„ç”¨æˆ·æšä¸¾æ–¹æ³•ï¼Œä½†è¯·æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•å¯èƒ½ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œå› æ­¤åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶è¦å°å¿ƒä½¿ç”¨ã€‚
```bash
#List all roles on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/role"

#List all users on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user"

#Get more information about the rights of an user:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user/<USERNAME>"
```
### Elastic ä¿¡æ¯

ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥é€šè¿‡ GET è®¿é—®ä»¥è·å–æœ‰å…³ Elasticsearch çš„ä¸€äº›ä¿¡æ¯çš„ç«¯ç‚¹ï¼š

| \_cat                           | /\_cluster                    | /\_security               |
| ------------------------------- | ----------------------------- | ------------------------- |
| /\_cat/segments                 | /\_cluster/allocation/explain | /\_security/user          |
| /\_cat/shards                   | /\_cluster/settings           | /\_security/privilege     |
| /\_cat/repositories             | /\_cluster/health             | /\_security/role\_mapping |
| /\_cat/recovery                 | /\_cluster/state              | /\_security/role          |
| /\_cat/plugins                  | /\_cluster/stats              | /\_security/api\_key      |
| /\_cat/pending\_tasks           | /\_cluster/pending\_tasks     |                           |
| /\_cat/nodes                    | /\_nodes                      |                           |
| /\_cat/tasks                    | /\_nodes/usage                |                           |
| /\_cat/templates                | /\_nodes/hot\_threads         |                           |
| /\_cat/thread\_pool             | /\_nodes/stats                |                           |
| /\_cat/ml/trained\_models       | /\_tasks                      |                           |
| /\_cat/transforms/\_all         | /\_remote/info                |                           |
| /\_cat/aliases                  |                               |                           |
| /\_cat/allocation               |                               |                           |
| /\_cat/ml/anomaly\_detectors    |                               |                           |
| /\_cat/count                    |                               |                           |
| /\_cat/ml/data\_frame/analytics |                               |                           |
| /\_cat/ml/datafeeds             |                               |                           |
| /\_cat/fielddata                |                               |                           |
| /\_cat/health                   |                               |                           |
| /\_cat/indices                  |                               |                           |
| /\_cat/master                   |                               |                           |
| /\_cat/nodeattrs                |                               |                           |
| /\_cat/nodes                    |                               |                           |

è¿™äº›ç«¯ç‚¹æ˜¯ä»[**æ–‡æ¡£ä¸­è·å–çš„**](https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html)ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°æ›´å¤šä¿¡æ¯ã€‚\
æ­¤å¤–ï¼Œå¦‚æœè®¿é—® `/_cat`ï¼Œå“åº”å°†åŒ…å«å®ä¾‹æ”¯æŒçš„ `/_cat/*` ç«¯ç‚¹ã€‚

åœ¨ `/_security/user`ï¼ˆå¦‚æœå¯ç”¨äº†èº«ä»½éªŒè¯ï¼‰ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å…·æœ‰ `superuser` è§’è‰²çš„ç”¨æˆ·ã€‚

### ç´¢å¼•

æ‚¨å¯ä»¥é€šè¿‡è®¿é—® `http://10.10.10.115:9200/_cat/indices?v` æ¥**æ”¶é›†æ‰€æœ‰ç´¢å¼•**ã€‚
```
health status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .kibana 6tjAYZrgQ5CwwR0g6VOoRg   1   0          1            0        4kb            4kb
yellow open   quotes  ZG2D1IqkQNiNZmi2HRImnQ   5   1        253            0    262.7kb        262.7kb
yellow open   bank    eSVpNfCfREyYoVigNWcrMw   5   1       1000            0    483.2kb        483.2kb
```
è¦è·å–æœ‰å…³ç´¢å¼•ä¸­ä¿å­˜çš„æ•°æ®ç±»å‹çš„ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥è®¿é—®ï¼š`http://host:9200/<index>`ï¼Œä¾‹å¦‚åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ `http://10.10.10.115:9200/bank`

![](<../.gitbook/assets/image (265).png>)

### è½¬å‚¨ç´¢å¼•

å¦‚æœæ‚¨æƒ³**è½¬å‚¨ç´¢å¼•çš„æ‰€æœ‰å†…å®¹**ï¼Œå¯ä»¥è®¿é—®ï¼š`http://host:9200/<index>/_search?pretty=true`ï¼Œä¾‹å¦‚ `http://10.10.10.115:9200/bank/_search?pretty=true`

![](<../.gitbook/assets/image (266).png>)

_è¯·èŠ±ç‚¹æ—¶é—´æ¯”è¾ƒé“¶è¡Œç´¢å¼•ä¸­æ¯ä¸ªæ–‡æ¡£ï¼ˆæ¡ç›®ï¼‰çš„å†…å®¹å’Œæˆ‘ä»¬åœ¨å‰ä¸€èŠ‚ä¸­çœ‹åˆ°çš„è¯¥ç´¢å¼•çš„å­—æ®µã€‚_

å› æ­¤ï¼Œæ­¤æ—¶æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°**åœ¨â€œhitsâ€å†…éƒ¨æœ‰ä¸€ä¸ªåä¸ºâ€œtotalâ€çš„å­—æ®µ**ï¼Œå®ƒæŒ‡ç¤ºåœ¨æ­¤ç´¢å¼•ä¸­æ‰¾åˆ°äº†**1000ä¸ªæ–‡æ¡£**ï¼Œä½†åªæ£€ç´¢åˆ°äº†10ä¸ªã€‚è¿™æ˜¯å› ä¸º**é»˜è®¤æƒ…å†µä¸‹æœ‰ä¸€ä¸ª10ä¸ªæ–‡æ¡£çš„é™åˆ¶**ã€‚\
ä½†æ˜¯ï¼Œç°åœ¨æ‚¨çŸ¥é“**æ­¤ç´¢å¼•åŒ…å«1000ä¸ªæ–‡æ¡£**ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨**`size`**å‚æ•°ä¸­æŒ‡å®šè¦è½¬å‚¨çš„æ¡ç›®æ•°æ¥**è½¬å‚¨æ‰€æœ‰è¿™äº›æ–‡æ¡£**ï¼š`http://10.10.10.115:9200/quotes/_search?pretty=true&size=1000`asd\
_æ³¨æ„ï¼šå¦‚æœæ‚¨æŒ‡å®šæ›´å¤§çš„æ•°å­—ï¼Œæ‰€æœ‰æ¡ç›®éƒ½å°†è¢«è½¬å‚¨ï¼Œä¾‹å¦‚æ‚¨å¯ä»¥æŒ‡å®š`size=9999`ï¼Œå¦‚æœæœ‰æ›´å¤šæ¡ç›®ï¼Œè¿™å°†å¾ˆå¥‡æ€ªï¼ˆä½†æ‚¨åº”è¯¥æ£€æŸ¥ä¸€ä¸‹ï¼‰ã€‚_

### è½¬å‚¨å…¨éƒ¨

ä¸ºäº†è½¬å‚¨å…¨éƒ¨å†…å®¹ï¼Œæ‚¨åªéœ€è½¬åˆ°**ä¸ä¹‹å‰ç›¸åŒçš„è·¯å¾„ï¼Œä½†ä¸æŒ‡å®šä»»ä½•ç´¢å¼•**`http://host:9200/_search?pretty=true`ï¼Œä¾‹å¦‚ `http://10.10.10.115:9200/_search?pretty=true`\
è¯·è®°ä½ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†åº”ç”¨**é»˜è®¤çš„10ä¸ªç»“æœé™åˆ¶**ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`size`å‚æ•°æ¥è½¬å‚¨**æ›´å¤šçš„ç»“æœ**ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»å‰ä¸€èŠ‚ã€‚

### æœç´¢

å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾æŸäº›ä¿¡æ¯ï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç´¢å¼•ä¸Šè¿›è¡Œ**åŸå§‹æœç´¢**ï¼Œè½¬åˆ° `http://host:9200/_search?pretty=true&q=<search_term>`ï¼Œä¾‹å¦‚ `http://10.10.10.115:9200/_search?pretty=true&q=Rockwell`

![](<../.gitbook/assets/image (267).png>)

å¦‚æœæ‚¨åªæƒ³åœ¨**ä¸€ä¸ªç´¢å¼•ä¸Šè¿›è¡Œæœç´¢**ï¼Œåªéœ€åœ¨**è·¯å¾„**ä¸Š**æŒ‡å®š**å®ƒï¼š`http://host:9200/<index>/_search?pretty=true&q=<search_term>`

_è¯·æ³¨æ„ï¼Œç”¨äºæœç´¢å†…å®¹çš„qå‚æ•°**æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼**_

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ç±»ä¼¼äº[https://github.com/misalabs/horuz](https://github.com/misalabs/horuz)çš„å·¥å…·æ¥æ¨¡ç³Šæœç´¢elasticsearchæœåŠ¡ã€‚

### å†™å…¥æƒé™

æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œç±»ä¼¼ä»¥ä¸‹å†…å®¹æ¥æ£€æŸ¥æ‚¨çš„å†™å…¥æƒé™ï¼Œå°è¯•åœ¨æ–°ç´¢å¼•ä¸­åˆ›å»ºæ–°æ–‡æ¡£ï¼š
```bash
curl -X POST '10.10.10.115:9200/bookindex/books' -H 'Content-Type: application/json' -d'
{
"bookId" : "A00-3",
"author" : "Sankaran",
"publisher" : "Mcgrahill",
"name" : "how to get a job"
}'
```
è¯¥å‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªåä¸º`bookindex`çš„**æ–°ç´¢å¼•**ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º`books`çš„æ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£å…·æœ‰å±æ€§"_bookId_"ã€"_author_"ã€"_publisher_"å’Œ"_name_"

è¯·æ³¨æ„**æ–°ç´¢å¼•ç°åœ¨å‡ºç°åœ¨åˆ—è¡¨ä¸­**ï¼š

![](<../.gitbook/assets/image (268).png>)

å¹¶æ³¨æ„**è‡ªåŠ¨åˆ›å»ºçš„å±æ€§**ï¼š

![](<../.gitbook/assets/image (269).png>)

## è‡ªåŠ¨æšä¸¾

ä¸€äº›å·¥å…·å°†è·å–ä¹‹å‰å‘ˆç°çš„ä¸€äº›æ•°æ®ï¼š
```bash
msf > use auxiliary/scanner/elasticsearch/indices_enum
```
{% embed url="https://github.com/theMiddleBlue/nmap-elasticsearch-nse" %}

## Shodan

* `port:9200 elasticsearch`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ–è€… [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
