# 9042/9160 - Pentesting Cassandra

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ–è€… [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–è€… **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

Apache Cassandraæ˜¯ä¸€ç§é«˜åº¦å¯æ‰©å±•ã€é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ—¨åœ¨å¤„ç†å¤§é‡æ•°æ®å¹¶åœ¨è®¸å¤šæ™®é€šæœåŠ¡å™¨ä¸Šæä¾›é«˜å¯ç”¨æ€§ï¼Œæ²¡æœ‰å•ç‚¹æ•…éšœã€‚å®ƒæ˜¯ä¸€ç§NoSQLæ•°æ®åº“ã€‚\
åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ ä¼šå‘ç°**cassandraæ¥å—ä»»ä½•å‡­æ®**ï¼ˆå› ä¸ºæ²¡æœ‰é…ç½®ä»»ä½•å‡­æ®ï¼‰ï¼Œä½ å°†èƒ½å¤Ÿæšä¸¾æ•°æ®åº“ã€‚

**é»˜è®¤ç«¯å£ï¼š** 9042,9160
```
PORT     STATE SERVICE   REASON
9042/tcp open  cassandra-native Apache Cassandra 3.10 or later (native protocol versions 3/v3, 4/v4, 5/v5-beta)
9160/tcp open  cassandra syn-ack
```
## æšä¸¾

### æ‰‹åŠ¨æšä¸¾

Cassandraæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå®ƒä½¿ç”¨CQLï¼ˆCassandra Query Languageï¼‰è¿›è¡ŒæŸ¥è¯¢å’Œæ“ä½œã€‚åœ¨è¿›è¡ŒCassandraçš„æ‰‹åŠ¨æšä¸¾æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

1. **CQLshå‘½ä»¤è¡Œå·¥å…·**ï¼šCQLshæ˜¯Cassandraæä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨å®ƒè¿æ¥åˆ°Cassandraé›†ç¾¤å¹¶æ‰§è¡ŒCQLæŸ¥è¯¢ã€‚å¯ä»¥ä½¿ç”¨`cqlsh`å‘½ä»¤å¯åŠ¨CQLshï¼Œå¹¶ä½¿ç”¨`DESCRIBE KEYSPACES`å‘½ä»¤åˆ—å‡ºæ‰€æœ‰çš„keyspacesï¼ˆç±»ä¼¼äºæ•°æ®åº“ï¼‰ã€‚

2. **nodetoolå‘½ä»¤**ï¼šnodetoolæ˜¯Cassandraæä¾›çš„ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨å®ƒè·å–æœ‰å…³Cassandraé›†ç¾¤çš„ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨`nodetool status`å‘½ä»¤è·å–é›†ç¾¤çš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹çš„IPåœ°å€å’Œç«¯å£å·ã€‚

3. **JMXï¼ˆJava Management Extensionsï¼‰**ï¼šCassandraä½¿ç”¨JMXè¿›è¡Œç›‘æ§å’Œç®¡ç†ã€‚å¯ä»¥ä½¿ç”¨JConsoleæˆ–JVisualVMç­‰JMXå®¢æˆ·ç«¯è¿æ¥åˆ°CassandraèŠ‚ç‚¹ï¼Œå¹¶æŸ¥çœ‹èŠ‚ç‚¹çš„è¿è¡ŒçŠ¶å†µã€æ€§èƒ½æŒ‡æ ‡å’Œé…ç½®ä¿¡æ¯ã€‚

4. **Cassandraçš„é»˜è®¤ç«¯å£**ï¼šCassandraçš„é»˜è®¤ç«¯å£æ˜¯9042ï¼ˆCQLï¼‰å’Œ7199ï¼ˆJMXï¼‰ã€‚å¯ä»¥ä½¿ç”¨ç«¯å£æ‰«æå·¥å…·ï¼ˆå¦‚nmapï¼‰æ‰«æç›®æ ‡ä¸»æœºçš„è¿™äº›ç«¯å£ï¼Œä»¥ç¡®å®šæ˜¯å¦è¿è¡Œäº†CassandraæœåŠ¡ã€‚

5. **Cassandraçš„Webç®¡ç†ç•Œé¢**ï¼šCassandraæä¾›äº†ä¸€ä¸ªWebç®¡ç†ç•Œé¢ï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨è®¿é—®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥ç•Œé¢çš„URLæ˜¯`http://<Cassandra_IP>:8888`ã€‚å¯ä»¥å°è¯•è®¿é—®è¯¥URLï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥è·å–åˆ°Cassandraçš„ç®¡ç†ç•Œé¢ã€‚

6. **Cassandraçš„æ—¥å¿—æ–‡ä»¶**ï¼šCassandraçš„æ—¥å¿—æ–‡ä»¶ä¸­å¯èƒ½åŒ…å«æœ‰å…³é›†ç¾¤é…ç½®ã€é”™è¯¯ä¿¡æ¯å’Œæ•æ„Ÿä¿¡æ¯çš„çº¿ç´¢ã€‚å¯ä»¥æŸ¥çœ‹Cassandraçš„æ—¥å¿—æ–‡ä»¶ï¼Œä»¥è·å–æœ‰å…³é›†ç¾¤çš„æ›´å¤šä¿¡æ¯ã€‚

ä»¥ä¸Šæ˜¯ä¸€äº›æ‰‹åŠ¨æšä¸¾Cassandraçš„æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥è·å–æœ‰å…³Cassandraé›†ç¾¤çš„ä¿¡æ¯ï¼Œä¸ºåç»­çš„æ¸—é€æµ‹è¯•å·¥ä½œæä¾›åŸºç¡€ã€‚
```bash
pip install cqlsh
cqlsh <IP>
#Basic info enumeration
SELECT cluster_name, thrift_version, data_center, partitioner, native_protocol_version, rack, release_version from system.local;
#Keyspace enumeration
SELECT keyspace_name FROM system.schema_keyspaces;
desc <Keyspace_name>    #Decribe that DB
desc system_auth        #Describe the DB called system_auth
SELECT * from system_auth.roles;  #Retreive that info, can contain credential hashes
SELECT * from logdb.user_auth;    #Can contain credential hashes
SELECT * from logdb.user;
SELECT * from configuration."config";
```
### è‡ªåŠ¨åŒ–

è¿™é‡Œæ²¡æœ‰å¤ªå¤šé€‰æ‹©ï¼Œnmapæ— æ³•è·å–å¤ªå¤šä¿¡æ¯ã€‚
```bash
nmap -sV --script cassandra-info -p <PORT> <IP>
```
### [**æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#cassandra)

### **Shodan**

`port:9160 Cluster`\
`port:9042 "Invalid or unsupported protocol version"`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆâ€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
