{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


**CheckPoint** **Firewall-1** ë°©í™”ë²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ì—¬ ë°©í™”ë²½ì˜ ì´ë¦„ê³¼ ê´€ë¦¬ ìŠ¤í…Œì´ì…˜ì˜ ì´ë¦„ê³¼ ê°™ì€ ê·€ì¤‘í•œ ì •ë³´ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” **264/TCP** í¬íŠ¸ì— ì¿¼ë¦¬ë¥¼ ì „ì†¡í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë°©í™”ë²½ ë° ê´€ë¦¬ ìŠ¤í…Œì´ì…˜ ì´ë¦„ ì–»ê¸°

ì‚¬ì „ ì¸ì¦ ìš”ì²­ì„ ì‚¬ìš©í•˜ì—¬ **CheckPoint Firewall-1**ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ëª¨ë“ˆì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì— í•„ìš”í•œ ëª…ë ¹ì€ ì•„ë˜ì— ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
ëª¨ë“ˆì´ ì‹¤í–‰ë˜ë©´ ë°©í™”ë²½ì˜ SecuRemote Topology ì„œë¹„ìŠ¤ì— ì—°ë½ì„ ì‹œë„í•©ë‹ˆë‹¤. ì„±ê³µí•˜ë©´ CheckPoint ë°©í™”ë²½ì˜ ì¡´ì¬ë¥¼ í™•ì¸í•˜ê³  ë°©í™”ë²½ê³¼ SmartCenter ê´€ë¦¬ í˜¸ìŠ¤íŠ¸ì˜ ì´ë¦„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì¶œë ¥ì´ ì–´ë–»ê²Œ ë³´ì¼ ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternative Method for Hostname and ICA Name Discovery

ë˜ ë‹¤ë¥¸ ê¸°ìˆ ì€ ë°©í™”ë²½ì— íŠ¹ì • ì¿¼ë¦¬ë¥¼ ë³´ë‚´ê³  ì‘ë‹µì„ êµ¬ë¬¸ ë¶„ì„í•˜ì—¬ ë°©í™”ë²½ì˜ í˜¸ìŠ¤íŠ¸ ì´ë¦„ê³¼ ICA ì´ë¦„ì„ ì¶”ì¶œí•˜ëŠ” ì§ì ‘ ëª…ë ¹ì„ í¬í•¨í•©ë‹ˆë‹¤. ëª…ë ¹ê³¼ ê·¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
ì´ ëª…ë ¹ì˜ ì¶œë ¥ì€ ì•„ë˜ì—ç¤ºëœ ëŒ€ë¡œ ë°©í™”ë²½ì˜ ì¸ì¦ì„œ ì´ë¦„(CN) ë° ì¡°ì§(O)ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## References

* [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit\_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)



{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
