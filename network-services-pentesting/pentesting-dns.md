# 53 - Pentesting DNS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**–ú–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è**. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è –∑ 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –≤—ñ–¥ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è. –ú–∏ –Ω–µ –∑–∞–º—ñ–Ω—é—î–º–æ —Ç–µ—Å—Ç—É–≤–∞–ª—å–Ω–∏–∫—ñ–≤ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è - –º–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î–º–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –º–æ–¥—É–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ó–º —Ç—Ä–æ—Ö–∏ —á–∞—Å—É –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –∑–∞–ø—É—Å–∫—É –æ–±–æ–ª–æ–Ω–æ–∫ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è.

{% embed url="https://pentest-tools.com/" %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**–°–∏—Å—Ç–µ–º–∞ –¥–æ–º–µ–Ω–Ω–∏—Ö —ñ–º–µ–Ω (DNS)** —Å–ª—É–≥—É—î –∫–∞—Ç–∞–ª–æ–≥–æ–º –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—Å–∞–π—Ç—ñ–≤ —á–µ—Ä–µ–∑ **–ª–µ–≥–∫–æ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É–≤–∞–Ω—ñ –¥–æ–º–µ–Ω–Ω—ñ —ñ–º–µ–Ω–∞** —Ç–∞–∫—ñ —è–∫ google.com –∞–±–æ facebook.com, –∑–∞–º—ñ—Å—Ç—å —á–∏—Å–ª–æ–≤–∏—Ö –∞–¥—Ä–µ—Å –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ—Ç–æ–∫–æ–ª—É (IP). –ü–µ—Ä–µ–∫–ª–∞–¥–∞—é—á–∏ –¥–æ–º–µ–Ω–Ω—ñ —ñ–º–µ–Ω–∞ –≤ IP-–∞–¥—Ä–µ—Å–∏, DNS –∑–∞–±–µ–∑–ø–µ—á—É—î —à–≤–∏–¥–∫–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–∞–º–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Å–ø—Ä–æ—â—É—é—á–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –≤ –æ–Ω–ª–∞–π–Ω-—Å–≤—ñ—Ç—ñ.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### Different DNS Servers

* **DNS Root Servers**: –¶–µ —Å–µ—Ä–≤–µ—Ä–∏, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –Ω–∞ –≤–µ—Ä—à–∏–Ω—ñ —ñ—î—Ä–∞—Ä—Ö—ñ—ó DNS, –∫–µ—Ä—É—é—á–∏ –¥–æ–º–µ–Ω–∞–º–∏ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è —ñ –≤—Ç—Ä—É—á–∞—é—á–∏—Å—å –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä–∏ –Ω–∏–∂—á–æ–≥–æ —Ä—ñ–≤–Ω—è –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å. –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ—è –∑ –ø—Ä–∏—Å–≤–æ—î–Ω–Ω—è —ñ–º–µ–Ω —Ç–∞ –Ω–æ–º–µ—Ä—ñ–≤ (**ICANN**) –∫–æ–Ω—Ç—Ä–æ–ª—é—î —ó—Ö–Ω—é —Ä–æ–±–æ—Ç—É, –∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 13.
* **Authoritative Nameservers**: –¶—ñ —Å–µ—Ä–≤–µ—Ä–∏ –º–∞—é—Ç—å –æ—Å—Ç–∞—Ç–æ—á–Ω–µ —Å–ª–æ–≤–æ –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤ —É —Å–≤–æ—ó—Ö –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –∑–æ–Ω–∞—Ö, –Ω–∞–¥–∞—é—á–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –Ø–∫—â–æ –≤–æ–Ω–∏ –Ω–µ –º–æ–∂—É—Ç—å –Ω–∞–¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∑–∞–ø–∏—Ç –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –Ω–∞ –∫–æ—Ä–µ–Ω–µ–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏.
* **Non-authoritative Nameservers**: –ù–µ –º–∞—é—á–∏ –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ –Ω–∞–¥ –∑–æ–Ω–∞–º–∏ DNS, —Ü—ñ —Å–µ—Ä–≤–µ—Ä–∏ –∑–±–∏—Ä–∞—é—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–æ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç–∏ –¥–æ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤.
* **Caching DNS Server**: –¶–µ–π —Ç–∏–ø —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç–∏ –Ω–∞ –ø–µ–≤–Ω–∏–π —á–∞—Å, —â–æ–± –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –º–∞–π–±—É—Ç–Ω—ñ –∑–∞–ø–∏—Ç–∏, –ø—Ä–∏ —Ü—å–æ–º—É —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∫–µ—à—É –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º.
* **Forwarding Server**: –í–∏–∫–æ–Ω—É—é—á–∏ –ø—Ä–æ—Å—Ç—É —Ä–æ–ª—å, –ø–µ—Ä–µ—Å–∏–ª–∞–ª—å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—é—Ç—å –∑–∞–ø–∏—Ç–∏ –Ω–∞ —ñ–Ω—à–∏–π —Å–µ—Ä–≤–µ—Ä.
* **Resolver**: –Ü–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ –≤ –∫–æ–º–ø'—é—Ç–µ—Ä–∏ –∞–±–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏, —Ä–µ–∑–æ–ª–≤–µ—Ä–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è —ñ–º–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ —ñ –Ω–µ –≤–≤–∞–∂–∞—é—Ç—å—Å—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º–∏.

## Enumeration

### **Banner Grabbing**

–£ DNS –Ω–µ–º–∞—î –±–∞–Ω–µ—Ä—ñ–≤, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –º–∞–≥—ñ—á–Ω–∏–π –∑–∞–ø–∏—Ç –¥–ª—è `version.bind. CHAOS TXT`, —è–∫–∏–π –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –Ω–∞ –±—ñ–ª—å—à–æ—Å—Ç—ñ BIND nameservers.\
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ–π –∑–∞–ø–∏—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `dig`:
```bash
dig version.bind CHAOS TXT @DNS
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [`fpdns`](https://github.com/kirei/fpdns) —Ç–∞–∫–æ–∂ –º–æ–∂–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –≤—ñ–¥–±–∏—Ç–æ–∫ —Å–µ—Ä–≤–µ—Ä–∞.

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –±–∞–Ω–µ—Ä –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞ **nmap**:
```
--script dns-nsid
```
### **–ë—É–¥—å-—è–∫–∏–π –∑–∞–ø–∏—Å**

–ó–∞–ø–∏—Ç **ANY** –ø–æ–ø—Ä–æ—Å–∏—Ç—å DNS-—Å–µ—Ä–≤–µ—Ä **–ø–æ–≤–µ—Ä–Ω—É—Ç–∏** –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ **–≤—Ö–æ–¥–∏**, —è–∫—ñ **–≤—ñ–Ω –≥–æ—Ç–æ–≤–∏–π —Ä–æ–∑–∫—Ä–∏—Ç–∏**.
```bash
dig any victim.com @<DNS_IP>
```
### **Zone Transfer**

–¶—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å–∫–æ—Ä–æ—á—É—î—Ç—å—Å—è —è–∫ `Asynchronous Full Transfer Zone` (`AXFR`).
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### –ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è nslookup
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### –ö–æ—Ä–∏—Å–Ω—ñ –º–æ–¥—É–ª—ñ metasploit
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### –ö–æ—Ä–∏—Å–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ nmap
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - –ó–≤–æ—Ä–æ—Ç–Ω–∏–π BF
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
–Ø–∫—â–æ –≤–∞–º –≤–¥–∞—î—Ç—å—Å—è –∑–Ω–∞–π—Ç–∏ –ø—ñ–¥–¥–æ–º–µ–Ω–∏, —â–æ —Ä–æ–∑–≤'—è–∑—É—é—Ç—å—Å—è –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π dns BF –¥–æ NS –¥–æ–º–µ–Ω—É, –∑–∞–ø–∏—Ç—É—é—á–∏ —Ü–µ–π –¥—ñ–∞–ø–∞–∑–æ–Ω IP.
{% endhint %}

–Ü–Ω—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ü—å–æ–≥–æ: [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –∑–≤–æ—Ä–æ—Ç–Ω—ñ IP-–¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –Ω–∞ [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns) (—Ü–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–∞–∫–æ–∂ –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è BGP).

### DNS - –ü—ñ–¥–¥–æ–º–µ–Ω–∏ BF
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### –°–µ—Ä–≤–µ—Ä–∏ Active Directory
```bash
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com

nslookup -type=srv _kerberos._tcp.<CLIENT_DOMAIN>
nslookup -type=srv _kerberos._tcp.domain.com

nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—ñ–≤ "AAAA" –¥–ª—è –∑–±–æ—Ä—É IPv6 –ø—ñ–¥–¥–æ–º–µ–Ω—ñ–≤.
```bash
dnsdict6 -s -t <domain>
```
–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ DNS –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º IPv6 –∞–¥—Ä–µ—Å
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNS Recursion DDoS

–Ø–∫—â–æ **–≤–∫–ª—é—á–µ–Ω–∞ —Ä–µ–∫—É—Ä—Å—ñ—è DNS**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ **–ø—ñ–¥—Ä–æ–±–∏—Ç–∏** **–¥–∂–µ—Ä–µ–ª–æ** –≤ UDP-–ø–∞–∫–µ—Ç—ñ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **DNS –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∂–µ—Ä—Ç–≤–∏**. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Å—ñ–≤ **ANY** –∞–±–æ **DNSSEC**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å –±—ñ–ª—å—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.\
–°–ø–æ—Å—ñ–± **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**, —á–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î DNS **—Ä–µ–∫—É—Ä—Å—ñ—é**, - —Ü–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è —Ç–∞ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**, —á–∏ —î **–ø—Ä–∞–ø–æ—Ä "ra"** (_—Ä–µ–∫—É—Ä—Å—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∞_) —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
```bash
dig google.com A @<IP>
```
**–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ**:

![](<../.gitbook/assets/image (123).png>)

**–î–æ—Å—Ç—É–ø–Ω–æ**:

![](<../.gitbook/assets/image (146).png>)

<figure><img src="../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**–ú–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è**. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è –∑ 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –≤—ñ–¥ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è. –ú–∏ –Ω–µ –∑–∞–º—ñ–Ω—é—î–º–æ —Ç–µ—Å—Ç—É–≤–∞–ª—å–Ω–∏–∫—ñ–≤ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è - –º–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î–º–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –º–æ–¥—É–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ó–º —Ç—Ä–æ—Ö–∏ —á–∞—Å—É –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —Ç–∞ —Ä–æ–∑–≤–∞–≥.

{% embed url="https://pentest-tools.com/" %}

### –õ–∏—Å—Ç –Ω–∞ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π –∞–∫–∞—É–Ω—Ç

–ß–µ—Ä–µ–∑ –≤–∏–≤—á–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ–Ω–∞–¥–∞–Ω–Ω—è (NDN), –≤–∏–∫–ª–∏–∫–∞–Ω–æ–≥–æ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–º –ª–∏—Å—Ç–æ–º, –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–º –Ω–∞ –Ω–µ–¥—ñ–π—Å–Ω—É –∞–¥—Ä–µ—Å—É –≤ –º–µ–∂–∞—Ö —Ü—ñ–ª—å–æ–≤–æ–≥–æ –¥–æ–º–µ–Ω—É, —á–∞—Å—Ç–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—é—Ç—å—Å—è —Ü—ñ–Ω–Ω—ñ –¥–µ—Ç–∞–ª—ñ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ.

–ù–∞–¥–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ–Ω–∞–¥–∞–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫:

* –ì–µ–Ω–µ—Ä—É—é—á–∏–π —Å–µ—Ä–≤–µ—Ä –±—É–≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π —è–∫ `server.example.com`.
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –¥–ª—è `user@example.com` –∑ –∫–æ–¥–æ–º –ø–æ–º–∏–ª–∫–∏ `#550 5.1.1 RESOLVER.ADR.RecipNotFound; –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ` –±—É–ª–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–æ.
* –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏ —Ç–∞ —ñ–º–µ–Ω–∞ —Ö–æ—Å—Ç—ñ–≤ –±—É–ª–∏ —Ä–æ–∑–∫—Ä–∏—Ç—ñ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
```markdown
The original message headers were modified for anonymity and now present randomized data:

Generating server: server.example.com

user@example.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from MAILSERVER01.domain.example.com (192.168.1.1) by
mailserver02.domain.example.com (192.168.2.2) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:52:22 -0700
Received: from filter.example.com (203.0.113.1) by
MAILSERVER01.domain.example.com (192.168.1.1) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:51:22 -0700
X-ASG-Debug-ID: 1432576343-0614671716190e0d0001-zOQ9WJ
Received: from gateway.domainhost.com (gateway.domainhost.com [198.51.100.37]) by
filter.example.com with ESMTP id xVNPkwaqGgdyH5Ag for user@example.com; Mon,
25 May 2015 14:52:13 -0700 (PDT)
X-Envelope-From: sender@anotherdomain.org
X-Apparent-Source-IP: 198.51.100.37
```
## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
–ù–µ–±–µ–∑–ø–µ—á–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞ Bind:

| **–û–ø—Ü—ñ—è**         | **–û–ø–∏—Å**                                                                       |
| ----------------- | ------------------------------------------------------------------------------ |
| `allow-query`     | –í–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ —Ö–æ—Å—Ç–∏ –º–æ–∂—É—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞.                   |
| `allow-recursion` | –í–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ —Ö–æ—Å—Ç–∏ –º–æ–∂—É—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞.       |
| `allow-transfer`  | –í–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ —Ö–æ—Å—Ç–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—á—ñ –∑–æ–Ω –≤—ñ–¥ DNS —Å–µ—Ä–≤–µ—Ä–∞.           |
| `zone-statistics` | –ó–±–∏—Ä–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –∑–æ–Ω.                                                  |

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://www.myrasecurity.com/en/knowledge-hub/dns/](https://www.myrasecurity.com/en/knowledge-hub/dns/)
* –ö–Ω–∏–≥–∞: **–û—Ü—ñ–Ω–∫–∞ –±–µ–∑–ø–µ–∫–∏ –º–µ—Ä–µ–∂—ñ 3-—Ç—î –≤–∏–¥–∞–Ω–Ω—è**

## HackTricks –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**–ú–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –ø–µ–Ω–µ—Ç–µ—Å—Ç–∞—Ü—ñ—ó**. –í–∏–∫–æ–Ω—É–π—Ç–µ –ø–æ–≤–Ω–∏–π –ø–µ–Ω–µ—Ç–µ—Å—Ç –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è –∑ 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –≤—ñ–¥ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è. –ú–∏ –Ω–µ –∑–∞–º—ñ–Ω—é—î–º–æ –ø–µ–Ω–µ—Ç–µ—Å—Ç–µ—Ä—ñ–≤ - –º–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î–º–æ –∫–∞—Å—Ç–æ–º–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –º–æ–¥—É–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ó–º —Ç—Ä–æ—Ö–∏ —á–∞—Å—É –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —Ç–∞ —Ä–æ–∑–≤–∞–≥.

{% embed url="https://pentest-tools.com/" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
