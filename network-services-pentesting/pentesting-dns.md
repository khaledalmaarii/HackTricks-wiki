# 53 - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ DNS

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдФрд░ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рддрддреНрдХрд╛рд▓ рдЙрдкрд▓рдмреНрдз рд╕реЗрдЯрдЕрдк**ред рдХрд╣реАрдВ рд╕реЗ рднреА 20+ рдЯреВрд▓ рдФрд░ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкреВрд░реНрдг рдкреЗрдВрдЯреЗрд╕реНрдЯ рдЪрд▓рд╛рдПрдВ рдЬреЛ рдкреБрдирд░реАрдХреНрд╖рдг рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рддрдХ рдЬрд╛рддреЗ рд╣реИрдВред рд╣рдо рдкреЗрдВрдЯреЗрд╕реНрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдирд╣реАрдВ рд╣реИрдВ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХреБрдЫ рд╕рдордп рд╡рд╛рдкрд╕ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЯреВрд▓, рдкрд╣рдЪрд╛рди рдФрд░ рд╢реЛрд╖рдг рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЦреЛрдЬ рдХрд░ рд╕рдХреЗрдВ, рд╢реИрд▓реНрд╕ рдкреЙрдк рдХрд░ рд╕рдХреЗрдВ, рдФрд░ рдордЬрд╝рд╛ рдХрд░ рд╕рдХреЗрдВред

{% embed url="https://pentest-tools.com/" %}

## **рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА**

**рдбреЛрдореЗрди рдирд╛рдо рдкреНрд░рдгрд╛рд▓реА (DNS)** рдЗрдВрдЯрд░рдиреЗрдЯ рдХрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ **рд╕рд░рд▓ рдпрд╛рдж рд░рдЦрдиреЗ рдпреЛрдЧреНрдп рдбреЛрдореЗрди рдирд╛рдореЛрдВ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ рдЬреИрд╕реЗ google.com рдпрд╛ facebook.com, рдирдВрдмрд░рд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (IP) рдкрддреЛрдВ рдХреА рдмрдЬрд╛рдпред рдбреЛрдореЗрди рдирд╛рдореЛрдВ рдХреЛ рдЖрдИрдкреА рдкрддреЛрдВ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рдХреЗ DNS рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рддреНрд╡рд░рд┐рдд рд░реВрдк рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХреЗрдВ, рдСрдирд▓рд╛рдЗрди рджреБрдирд┐рдпрд╛ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рддреЗ рд╣реБрдПред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### рд╡рд┐рднрд┐рдиреНрди DNS рд╕рд░реНрд╡рд░

* **DNS рд░реВрдЯ рд╕рд░реНрд╡рд░**: рдпреЗ DNS рд╡рд░реНрдЪрд╕реНрд╡ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╣реЛрддреЗ рд╣реИрдВ, рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдбреЛрдореЗрди рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХреЗрд╡рд▓ рдирд┐рдЪрд▓реЗ рд╕реНрддрд░реАрдп рд╕рд░реНрд╡рд░реЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдорд┐рд▓рдиреЗ рдкрд░ рдХрджрдо рдЙрдард╛рддреЗ рд╣реИрдВред рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЙрд░реНрдкреЛрд░реЗрд╢рди рдлреЙрд░ рдЕрд╕рд╛рдЗрдВрдб рдиреЗрдореНрд╕ рдПрдВрдб рдирдВрдмрд░реНрд╕ (**ICANN**) рдЗрдирдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рдкрд░реНрдпрд╛рд╡рд░рдг рджреЗрдЦрддрд╛ рд╣реИ, рдЬрд┐рдирдХреА рд╡реИрд╢реНрд╡рд┐рдХ рдЧрд┐рдирддреА 13 рд╣реИред
* **рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдиреЗрдорд╕рд░реНрд╡рд░**: рдЗрди рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдЙрдирдХреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдкреВрдЫрддрд╛рдЫ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдирд┐рд░реНрдгрдп рд╣реЛрддрд╛ рд╣реИ, рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЙрддреНрддрд░ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдЕрдЧрд░ рд╡реЗ рдХрд┐рд╕реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рддреЛ рдкреНрд░рд╢реНрди рд░реВрдЯ рд╕рд░реНрд╡рд░реЛрдВ рдХреА рдУрд░ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рдЧреИрд░-рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдиреЗрдорд╕рд░реНрд╡рд░**: DNS рдХреНрд╖реЗрддреНрд░реЛрдВ рдкрд░ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рди рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг, рдпреЗ рд╕рд░реНрд╡рд░ рдЕрдиреНрдп рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдкреВрдЫрддрд╛рдЫ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЛрдореЗрди рд╕реВрдЪрдирд╛ рдПрдХрддреНрд░ рдХрд░рддреЗ рд╣реИрдВред
* **рдХреИрд╢рд┐рдВрдЧ DNS рд╕рд░реНрд╡рд░**: рдпрд╣ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╕рд░реНрд╡рд░ рдкрд┐рдЫрд▓реЗ рдкреНрд░рд╢реНрди рдХреЗ рдЙрддреНрддрд░реЛрдВ рдХреЛ рдПрдХ рд╕реЗрдЯ рд╕рдордп рдХреЗ рд▓рд┐рдП рдпрд╛рдж рд░рдЦрддрд╛ рд╣реИ рддрд╛рдХрд┐ рднрд╡рд┐рд╖реНрдп рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЧрддрд┐ рдмрдврд╝рд╛рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓реЗ, рдЬрд┐рд╕рдХреА рдХреИрд╢ рдЕрд╡рдзрд┐ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред
* **рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рд╕рд░реНрд╡рд░**: рд╕реАрдзреА рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреЗ рд╣реБрдП, рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рд╕рд░реНрд╡рд░ рд╕рд┐рд░реНрдл рдЕрдиреНрдп рд╕рд░реНрд╡рд░ рдХреЛ рдкреНрд░рд╢реНрди рдкрд╣реБрдВрдЪрд╛рддреЗ рд╣реИрдВред
* **рд░рд┐рдЬрд╝реЙрд▓реНрд╡рд░**: рдХрдВрдкреНрдпреВрдЯрд░ рдпрд╛ рд░рд╛рдЙрдЯрд░ рдХреЗ рднреАрддрд░ рдПрдХреАрдХреГрдд, рд░рд┐рдЬрд╝реЙрд▓реНрд╡рд░реНрд╕ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдирд╛рдо рд╕реБрд▓рдЭрд╛рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдирд╣реАрдВ рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВред

## рдЧрдгрдирд╛

### **рдмреИрдирд░ рдЧреНрд░рдмрд┐рдВрдЧ**

DNS рдореЗрдВ рдмреИрдирд░ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдк `version.bind. CHAOS TXT` рдХреЗ рд▓рд┐рдП рдореИрдЬрд┐рдХ рдкреНрд░рд╢реНрди рдХреЛ рдЧреНрд░рдм рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢ BIND рдиреЗрдорд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред\
рдЖрдк `dig` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдкреНрд░рд╢реНрди рдХреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
dig version.bind CHAOS TXT @DNS
```
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЙрдкрдХрд░рдг [`fpdns`](https://github.com/kirei/fpdns) рд╕рд░реНрд╡рд░ рдХрд╛ fingerprint рднреА рд▓реЗ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ **nmap** рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдмреИрдирд░ рднреА рд▓реЗрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```
--script dns-nsid
```
### **рдХреЛрдИ рднреА рд░рд┐рдХреЙрд░реНрдб**

рд░рд┐рдХреЙрд░реНрдб **ANY** DNS рд╕рд░реНрд╡рд░ рд╕реЗ рд╕рднреА рдЙрдкрд▓рдмреНрдз **рдПрдВрдЯреНрд░реА** рдкреВрдЫреЗрдЧрд╛ рдЬреЛ **рд╡рд╣ рдкреНрд░рдХрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдЪреНрдЫреБрдХ рд╣реИ**ред
```bash
dig any victim.com @<DNS_IP>
```
### **рдХреНрд╖реЗрддреНрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг**

рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ `рдЕрд╕рдордВрдЪрд┐рдд рдкреВрд░реНрдг рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреНрд╖реЗрддреНрд░` (`AXFR`) рд╕реЗ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдХреА рдЧрдИ рд╣реИред
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### рд╕реНрд╡рдЪрд╛рд▓рди
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### рдПрдирдПрд╕рд▓реБрдХрдЕрдк рдХрд╛ рдЙрдкрдпреЛрдЧ
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### рдЙрдкрдпреЛрдЧреА рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЙрдЗрдЯ рдореЙрдбреНрдпреВрд▓
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### рдЙрдкрдпреЛрдЧреА nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯ
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - рд░рд┐рд╡рд░реНрд╕ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
рдпрджрд┐ рдЖрдк рдРрд╕реЗ рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдЦреЛрдЬрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ рдЬреЛ рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА-рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрд╕ рдЖрдИрдкреА-рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдХреЗ рдПрдирдПрд╕реНрд╕ рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдбреАрдПрдирдПрд╕ рдмреАрдПрдл рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред
{% endhint %}

рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдЙрдкрдХрд░рдг: [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

рдЖрдк [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns) рдкрд░ рд░рд┐рд╡рд░реНрд╕ рдЖрдИрдкреА-рд░реЗрдВрдЬ рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдЙрдкрдХрд░рдг рдмреАрдЬреАрдкреА рдХреЗ рд╕рд╛рде рднреА рдорджрджрдЧрд╛рд░ рд╣реИ)ред

### DNS - рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдмреАрдПрдл
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕рд░реНрд╡рд░
```bash
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com

nslookup -type=srv _kerberos._tcp.<CLIENT_DOMAIN>
nslookup -type=srv _kerberos._tcp.domain.com

nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

"AAAA" рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрдкрдбреЛрдореЗрдиреНрд╕ рдХреЗ IPv6 рдЬреБрдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ред
```bash
dnsdict6 -s -t <domain>
```
## Bruteforce reverse DNS in using IPv6 addresses

### Introduction

In this section, we will discuss how to bruteforce reverse DNS records using IPv6 addresses. This technique can be useful during penetration testing to uncover hidden information about a target network.

### Steps to bruteforce reverse DNS in using IPv6 addresses

1. **Enumerate IPv6 addresses**: The first step is to enumerate IPv6 addresses that belong to the target network. This can be done using tools like `nmap` or `ipv6-toolkit`.

2. **Generate possible PTR records**: Once you have a list of IPv6 addresses, generate possible PTR records based on the IPv6 address range. For example, if an IPv6 address is `2001:0db8:85a3:0000:0000:8a2e:0370:7334`, the corresponding PTR record would be `4.3.3.7.0.7.e.2.a.8.0.0.0.0.0.0.0.3.5.a.8.8.b.d.0.1.0.0.2`.

3. **Perform reverse DNS lookup**: Use a tool like `nslookup` or `dig` to perform reverse DNS lookup for each generated PTR record. This will reveal if any valid DNS records exist for the IPv6 addresses.

4. **Analyze results**: Analyze the results to identify any potential misconfigurations or security vulnerabilities in the DNS setup of the target network.

By following these steps, you can effectively bruteforce reverse DNS records using IPv6 addresses to gather valuable information during a penetration test.
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNS Recursion DDoS

рдпрджрд┐ **DNS рдЕрдирд╡рд░реНрддрди** рд╕рдХреНрд╖рдо рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд╛рджреА **UDP рдкреИрдХреЗрдЯ рдореЗрдВ рдореВрд▓** рдХреЛ **рдзреЛрдЦрд╛ рджреЗ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ **DNS рдЙрддреНрддрд░ рд╡рд┐рдХреНрдЯрд┐рдо рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬреЗ**ред рд╣рдорд▓рд╛рд╡рд╛рджреА **ANY** рдпрд╛ **DNSSEC** рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрдирдореЗрдВ рдЕрдзрд┐рдХ рдмрдбрд╝реЗ рдЬрд╡рд╛рдм рд╣реЛрддреЗ рд╣реИрдВред\
DNS рдХрд╛ **рдЬрд╛рдВрдЪ рдХрд░рдиреЗ** рдХрд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рдбреЛрдореЗрди рдирд╛рдо рдХрд╛ рдХреНрд╡реЗрд░реА рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ **рдЙрддреНрддрд░ рдореЗрдВ "ra" рдЭрдВрдбрд╛** (_рдЕрдирд╡рд░реНрддрди рдЙрдкрд▓рдмреНрдз_) рд╣реИ:
```bash
dig google.com A @<IP>
```
**рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ**:

![](<../.gitbook/assets/image (275).png>)

**рдЙрдкрд▓рдмреНрдз**:

![](<../.gitbook/assets/image (276).png>)

<figure><img src="../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**рддреНрд╡рд░рд┐рдд рдЙрдкрд▓рдмреНрдз рд╕реЗрдЯрдЕрдк рд╡рд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреА рдореВрд▓реНрдпрд╛рдВрдХрди рдФрд░ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП**ред рдХрд╣реАрдВ рд╕реЗ рднреА 20+ рдЯреВрд▓ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдХреЗ рд╕рд╛рде рдкреВрд░реНрдг рдкреЗрдирдЯреЗрд╕реНрдЯ рдЪрд▓рд╛рдПрдВ рдЬреЛ рд░рд┐рдХреЙрди рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рддрдХ рдЬрд╛рддреЗ рд╣реИрдВред рд╣рдо рдкреЗрдирдЯреЗрд╕реНрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдирд╣реАрдВ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╡рд╛рдкрд╕ рдХреБрдЫ рд╕рдордп рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЯреВрд▓реНрд╕, рдкрд╣рдЪрд╛рди рдФрд░ рд╢реЛрдзрди рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЦреЛрдЬ рдХрд░ рд╕рдХреЗрдВ, рд╢реИрд▓реНрд╕ рдкреЙрдк рдХрд░ рд╕рдХреЗрдВ, рдФрд░ рдордЬрд╝рд╛ рдХрд░ рд╕рдХреЗрдВред

{% embed url="https://pentest-tools.com/" %}

### рдЕрд╕реНрдерд╛рдпреА рдЦрд╛рддреЗ рдкрд░ рдореЗрд▓

рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдкрддреЗ рдкрд░ рднреЗрдЬреЗ рдЧрдП рдИрдореЗрд▓ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдПрдирдбреАрдПрди (Nondelivery Notification) рдХреА рдЬрд╛рдВрдЪ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдХреНрд╕рд░ рд▓рдХреНрд╖реНрдп рдбреЛрдореЗрди рдХреЗ рдЕрдорд╛рдиреНрдп рдкрддреЗ рдкрд░ рдореЗрд▓ рднреЗрдЬрдиреЗ рдкрд░ рдореВрд▓реНрдпрд╡рд╛рди рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд╡рд░рдг рдЙрдЬрд╛рдЧрд░ рд╣реЛрддреЗ рд╣реИрдВред

рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЕрд╕реНрдерд╛рдпреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИ:

* рдЙрддреНрдкрдиреНрди рд╕рд░реНрд╡рд░ рдХреЛ `server.example.com` рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ рдерд╛ред
* `user@example.com` рдХреЗ рд▓рд┐рдП рддреНрд░реБрдЯрд┐ рдХреЛрдб `#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found` рдХреЗ рд╕рд╛рде рд╡рд╛рдкрд╕ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛ред
* рдореВрд▓ рд╕рдВрджреЗрд╢ рд╣реЗрдбрд░ рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддреЗ рдФрд░ рд╣реЛрд╕реНрдЯрдиреЗрдо рдЙрдЬрд╛рдЧрд░ рдХрд┐рдП рдЧрдП рдереЗред
```markdown
The original message headers were modified for anonymity and now present randomized data:

Generating server: server.example.com

user@example.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from MAILSERVER01.domain.example.com (192.168.1.1) by
mailserver02.domain.example.com (192.168.2.2) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:52:22 -0700
Received: from filter.example.com (203.0.113.1) by
MAILSERVER01.domain.example.com (192.168.1.1) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:51:22 -0700
X-ASG-Debug-ID: 1432576343-0614671716190e0d0001-zOQ9WJ
Received: from gateway.domainhost.com (gateway.domainhost.com [198.51.100.37]) by
filter.example.com with ESMTP id xVNPkwaqGgdyH5Ag for user@example.com; Mon,
25 May 2015 14:52:13 -0700 (PDT)
X-Envelope-From: sender@anotherdomain.org
X-Apparent-Source-IP: 198.51.100.37
```
## рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
рдЬрдм Bind рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╕рдордп рдЦрддрд░рдирд╛рдХ рд╕реЗрдЯрд┐рдВрдЧреНрд╕:

| **рд╡рд┐рдХрд▓реНрдк**        | **рд╡рд┐рд╡рд░рдг**                                                                |
| ----------------- | ------------------------------------------------------------------------------ |
| `allow-query`     | рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╣реЛрд╕реНрдЯ DNS рд╕рд░реНрд╡рд░ рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред            |
| `allow-recursion` | рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╣реЛрд╕реНрдЯ DNS рд╕рд░реНрд╡рд░ рдХреЛ рд░реЗрдХрд░реНрд╕рд┐рд╡ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред  |
| `allow-transfer`  | рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╣реЛрд╕реНрдЯ DNS рд╕рд░реНрд╡рд░ рд╕реЗ рдЬрд╝реЛрди рдЯреНрд░рд╛рдВрд╕рдлрд╝рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред |
| `zone-statistics` | рдЬрд╝реЛрдиреЛрдВ рдХреЗ рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред                                            |

## рд╕рдВрджрд░реНрдн

* [https://www.myrasecurity.com/en/knowledge-hub/dns/](https://www.myrasecurity.com/en/knowledge-hub/dns/)
* рдкреБрд╕реНрддрдХ: **рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди 3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг**
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**рд╡рд┐рдХрд▓реНрдкреАрдХрд░рдг рдФрд░ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рдЙрдкрд▓рдмреНрдз рд╕реЗрдЯрдЕрдк**ред 20+ рдЯреВрд▓реНрд╕ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рд╕реЗ рдкреВрд░реНрдг рдкреЗрдирдЯреЗрд╕реНрдЯ рдЪрд▓рд╛рдПрдВ рдЬреЛ рдкреБрдирд░реАрдХреНрд╖рдг рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рддрдХ рдЬрд╛рддреЗ рд╣реИрдВред рд╣рдо рдкреЗрдирдЯреЗрд╕реНрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдирд╣реАрдВ рдЬрд╛рддреЗ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╡рд╛рдкрд╕ рдХреБрдЫ рд╕рдордп рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЯреВрд▓реНрд╕, рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд╢реЛрд╖рдг рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЦреЛрдЬ рдХрд░ рд╕рдХреЗрдВ, рд╢реИрд▓реНрд╕ рдкреЙрдк рдХрд░ рд╕рдХреЗрдВ, рдФрд░ рдордЬрд╝рд╛ рдХрд░ рд╕рдХреЗрдВред

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
