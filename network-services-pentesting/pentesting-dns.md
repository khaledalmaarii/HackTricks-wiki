# 53 - Pentesting DNS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de cybers√©curit√© ? Voulez-vous voir votre entreprise annonc√©e dans HackTricks ? ou voulez-vous avoir acc√®s √† la derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference est un √©v√©nement international de cybers√©curit√©**](https://www.dragonjarcon.org/) avec plus d'une d√©cennie d'existence qui se tiendra les 7 et 8 septembre 2023 √† Bogot√°, en Colombie. C'est un √©v√©nement de contenu technique de haut niveau o√π les derni√®res recherches en espagnol sont pr√©sent√©es, attirant des hackers et des chercheurs du monde entier.\
Inscrivez-vous d√®s maintenant sur le lien suivant et ne manquez pas cette grande conf√©rence !:

{% embed url="https://www.dragonjarcon.org/" %}

## **Informations de base**

Le syst√®me de noms de domaine (DNS) est l'annuaire t√©l√©phonique d'Internet. Les humains acc√®dent aux informations en ligne via des noms de domaine, comme nytimes.com ou espn.com. Les navigateurs Web interagissent via des adresses de protocole Internet (IP). DNS traduit les noms de domaine en [adresses IP](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/) afin que les navigateurs puissent charger les ressources Internet.\
√Ä partir de [ici](https://www.cloudflare.com/learning/dns/what-is-dns/).

**Port par d√©faut :** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### Diff√©rents serveurs DNS

Information de [https://academy.hackthebox.com/module/112/section/1069](https://academy.hackthebox.com/module/112/section/1069)

| **Type de serveur**             | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Serveur racine DNS`           | Les serveurs racine du DNS sont responsables des domaines de premier niveau (`TLD`). En tant que derni√®re instance, ils ne sont demand√©s que si le serveur de noms ne r√©pond pas. Ainsi, un serveur racine est une interface centrale entre les utilisateurs et le contenu sur Internet, car il relie le domaine et l'adresse IP. La [Corporation pour l'attribution des noms et des num√©ros sur Internet](https://www.icann.org/) (`ICANN`) coordonne le travail des serveurs de noms racine. Il existe `13` de ces serveurs racine dans le monde. |
| `Serveur de noms autoritatif`  | Les serveurs de noms autoritatifs ont l'autorit√© sur une zone particuli√®re. Ils ne r√©pondent qu'aux requ√™tes de leur zone de responsabilit√©, et leurs informations sont contraignantes. Si un serveur de noms autoritatif ne peut pas r√©pondre √† la requ√™te d'un client, le serveur de noms racine prend le relais √† ce moment-l√†.                                                                                                                                                                                                            |
| `Serveur de noms non autoritatif` | Les serveurs de noms non autoritatifs ne sont pas responsables d'une zone DNS particuli√®re. Au lieu de cela, ils collectent eux-m√™mes des informations sur des zones DNS sp√©cifiques, ce qui est fait √† l'aide d'une requ√™te DNS r√©cursive ou it√©rative.                                                                                                                                                                                                                                                                               |
| `Serveur DNS de mise en cache` | Les serveurs DNS de mise en cache mettent en cache des informations provenant d'autres serveurs de noms pour une p√©riode sp√©cifi√©e. Le serveur de noms autoritatif d√©termine la dur√©e de ce stockage.                                                                                                                                                                                                                                                                                                                             |
| `Serveur de redirection`            | Les serveurs de redirection ne remplissent qu'une seule fonction : ils redirigent les requ√™tes DNS vers un autre serveur DNS.                                                                                                                                                                                                                                                                                                                                                                                            |
| `R√©solveur`                     | Les r√©solveurs ne sont pas des serveurs DNS autoritaires mais effectuent une r√©solution de noms localement dans l'ordinateur ou le routeur.                                                                                                                                                                                                                                                                                                                                                                               |

## √ânum√©ration

### **Banner Grabbing**

DNS n'a pas de "banni√®re" √† saisir. L'√©quivalent le plus proche est une requ√™te magique pour `version.bind. CHAOS TXT` qui fonctionnera sur la plupart des serveurs de noms BIND.\
Vous pouvez effectuer cette requ√™te en utilisant `dig`:
```bash
dig version.bind CHAOS TXT @DNS
```
Si cela ne fonctionne pas, vous pouvez utiliser des techniques de reconnaissance d'empreintes pour d√©terminer la version du serveur distant -- l'outil [`fpdns`](https://github.com/kirei/fpdns) est une option pour cela, mais il en existe d'autres.

Vous pouvez √©galement r√©cup√©rer la banni√®re avec un script **nmap** :
```
--script dns-nsid
```
### **Tout enregistrement**

L'enregistrement **ANY** demandera au serveur DNS de **retourner** toutes les **entr√©es** disponibles qu'il est pr√™t √† **divulguer**.
```bash
dig any victim.com @<DNS_IP>
```
### **Transfert de zone**

Cette proc√©dure est abr√©g√©e `Asynchronous Full Transfer Zone` (`AXFR`).
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
Sure, what additional information do you need?
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### Utilisation de nslookup
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### Modules utiles de Metasploit

#### DNS

##### dns_brute

Ce module effectue une attaque de force brute sur un serveur DNS pour trouver des sous-domaines. Il utilise une liste de noms de sous-domaines pour effectuer l'attaque.

##### dns_cache_snoop

Ce module permet de r√©cup√©rer les enregistrements DNS mis en cache sur un serveur DNS. Cela peut √™tre utile pour trouver des informations sur les noms de domaine qui ont √©t√© r√©cemment r√©solus.

##### dns_client

Ce module permet de simuler un client DNS et d'envoyer des requ√™tes DNS √† un serveur DNS. Cela peut √™tre utile pour tester la s√©curit√© d'un serveur DNS.

##### dns_fuzz

Ce module effectue une attaque de fuzzing sur un serveur DNS pour trouver des vuln√©rabilit√©s. Il envoie des requ√™tes DNS avec des donn√©es al√©atoires pour tester la r√©ponse du serveur.

##### dns_recon

Ce module effectue une reconnaissance DNS sur un domaine pour trouver des informations sur les enregistrements DNS. Il peut √™tre utilis√© pour trouver des sous-domaines, des adresses IP et d'autres informations utiles.

##### dns_server_cache

Ce module permet de r√©cup√©rer les enregistrements DNS mis en cache sur un serveur DNS. Cela peut √™tre utile pour trouver des informations sur les noms de domaine qui ont √©t√© r√©cemment r√©solus.

##### dns_srv_enum

Ce module effectue une √©num√©ration des enregistrements SRV sur un serveur DNS. Les enregistrements SRV sont utilis√©s pour fournir des informations sur les services disponibles sur un r√©seau.

##### dns_tld_enum

Ce module effectue une √©num√©ration des domaines de premier niveau (TLD) sur un serveur DNS. Les domaines de premier niveau sont les domaines de plus haut niveau dans la hi√©rarchie DNS.

##### dns_transfer

Ce module permet de transf√©rer une zone DNS √† partir d'un serveur DNS. Cela peut √™tre utile pour r√©cup√©rer des informations sur les enregistrements DNS d'un domaine.

##### dns_update

Ce module permet de mettre √† jour les enregistrements DNS sur un serveur DNS. Cela peut √™tre utilis√© pour modifier les enregistrements DNS d'un domaine.

##### dns_version

Ce module permet de r√©cup√©rer la version du logiciel de serveur DNS utilis√© par un serveur DNS. Cela peut √™tre utile pour trouver des vuln√©rabilit√©s connues dans le logiciel.

#### Autres

##### http_put

Ce module permet de t√©l√©charger des fichiers sur un serveur web en utilisant la m√©thode HTTP PUT. Cela peut √™tre utilis√© pour t√©l√©charger des fichiers sur un serveur web qui n'a pas de formulaire de t√©l√©chargement.

##### snmp_enum

Ce module effectue une √©num√©ration SNMP sur un h√¥te pour trouver des informations sur le syst√®me. SNMP est un protocole de gestion de r√©seau utilis√© pour surveiller et g√©rer les p√©riph√©riques r√©seau.

##### snmp_login

Ce module permet de se connecter √† un h√¥te en utilisant des informations d'identification SNMP. Cela peut √™tre utilis√© pour acc√©der √† des p√©riph√©riques r√©seau qui utilisent SNMP pour l'authentification.

##### snmp_enumshares

Ce module effectue une √©num√©ration des partages SMB sur un h√¥te en utilisant SNMP. Cela peut √™tre utilis√© pour trouver des partages SMB sur un h√¥te qui utilise SNMP pour la gestion de r√©seau.

##### snmp_enumusers

Ce module effectue une √©num√©ration des utilisateurs sur un h√¥te en utilisant SNMP. Cela peut √™tre utilis√© pour trouver des informations sur les utilisateurs d'un syst√®me.

##### snmp_enumprocs

Ce module effectue une √©num√©ration des processus en cours d'ex√©cution sur un h√¥te en utilisant SNMP. Cela peut √™tre utilis√© pour trouver des informations sur les processus en cours d'ex√©cution sur un syst√®me.
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### Scripts nmap utiles

- **dns-brute** - Performs brute force enumeration of DNS names.  
  - **dns-brute** - Effectue une √©num√©ration par force brute des noms de DNS.
- **dns-cache-snoop** - Attempts to retrieve the DNS server cache information using DNS queries and tries to find any misconfigurations or vulnerabilities.  
  - **dns-cache-snoop** - Tente de r√©cup√©rer les informations de cache du serveur DNS en utilisant des requ√™tes DNS et essaie de trouver des erreurs de configuration ou des vuln√©rabilit√©s.
- **dns-zone-transfer** - Attempts to perform a DNS zone transfer and retrieve all DNS records for a domain.  
  - **dns-zone-transfer** - Tente d'effectuer un transfert de zone DNS et de r√©cup√©rer tous les enregistrements DNS pour un domaine.
- **http-vhosts** - Enumerates virtual hosts on a web server.  
  - **http-vhosts** - √ânum√®re les h√¥tes virtuels sur un serveur web.
- **http-enum** - Enumerates directories and files on a web server.  
  - **http-enum** - √ânum√®re les r√©pertoires et les fichiers sur un serveur web.
- **http-methods** - Enumerates HTTP methods supported by a web server.  
  - **http-methods** - √ânum√®re les m√©thodes HTTP prises en charge par un serveur web.
- **http-robots.txt** - Retrieves the robots.txt file from a web server.  
  - **http-robots.txt** - R√©cup√®re le fichier robots.txt √† partir d'un serveur web.
- **http-shellshock** - Tests for the Shellshock vulnerability in web servers.  
  - **http-shellshock** - Teste la vuln√©rabilit√© Shellshock dans les serveurs web.
- **http-sitemap-generator** - Generates a sitemap of a web server.  
  - **http-sitemap-generator** - G√©n√®re un plan de site d'un serveur web.
- **ssl-enum-ciphers** - Enumerates SSL/TLS ciphers supported by a server.  
  - **ssl-enum-ciphers** - √ânum√®re les chiffrements SSL/TLS pris en charge par un serveur.
- **ssl-heartbleed** - Tests for the Heartbleed vulnerability in SSL/TLS servers.  
  - **ssl-heartbleed** - Teste la vuln√©rabilit√© Heartbleed dans les serveurs SSL/TLS.
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - Force brute invers√©
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
Si vous √™tes capable de trouver des sous-domaines r√©solvant vers des adresses IP internes, vous devriez essayer d'effectuer une recherche invers√©e DNS sur les serveurs de noms du domaine en demandant cette plage d'adresses IP.
{% endhint %}

Un autre outil pour le faire : [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

Vous pouvez interroger les plages d'adresses IP inverses sur [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns) (cet outil est √©galement utile avec BGP).

### DNS - Recherche de sous-domaines BF
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### Serveurs Active Directory
```
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com
nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec

DNSSec (Domain Name System Security Extensions) est une extension de s√©curit√© pour le syst√®me de noms de domaine (DNS). Il permet de garantir l'authenticit√© et l'int√©grit√© des donn√©es DNS en utilisant des signatures num√©riques. Cela emp√™che les attaques telles que le DNS spoofing et le cache poisoning. Les serveurs DNS peuvent √™tre configur√©s pour prendre en charge DNSSec en ajoutant des enregistrements de ressource sp√©ciaux (RR) √† la zone DNS. Les clients DNS peuvent √©galement √™tre configur√©s pour utiliser DNSSec pour valider les r√©ponses DNS qu'ils re√ßoivent.
```bash
 #Query paypal subdomains to ns3.isc-sns.info
 nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

Force brute en utilisant des requ√™tes "AAAA" pour collecter les adresses IPv6 des sous-domaines.
```bash
dnsdict6 -s -t <domain>
```
# Bruteforce reverse DNS en utilisant des adresses IPv6

Lorsque vous travaillez avec des adresses IPv6, il est important de comprendre que les adresses IPv6 inverses sont stock√©es dans la zone `ip6.arpa`. Cette zone est organis√©e de mani√®re similaire √† la zone `in-addr.arpa` pour les adresses IPv4.

Pour effectuer une attaque de bruteforce sur les adresses IPv6 inverses, vous pouvez utiliser l'outil `dnsrevenum6` de `dnsrevenum`. Cet outil g√©n√®re une liste d'adresses IPv6 inverses possibles pour un pr√©fixe donn√©.

Voici un exemple d'utilisation de `dnsrevenum6` pour g√©n√©rer une liste d'adresses IPv6 inverses possibles pour le pr√©fixe `2001:db8:1:0:0:0:0:0/64` :

```
$ dnsrevenum6 2001:db8:1:0:0:0:0:0/64 > ipv6_reverse.txt
```

Une fois que vous avez g√©n√©r√© la liste d'adresses IPv6 inverses possibles, vous pouvez utiliser un outil comme `dnsrevenum` pour effectuer une recherche DNS inverse sur chaque adresse de la liste. Cela vous permettra de d√©terminer si une adresse IPv6 inverse correspond √† un nom de domaine.

Voici un exemple d'utilisation de `dnsrevenum` pour effectuer une recherche DNS inverse sur chaque adresse IPv6 inverse de la liste g√©n√©r√©e pr√©c√©demment :

```
$ cat ipv6_reverse.txt | dnsrevenum -r 8.8.8.8
```

Cet exemple utilise le serveur DNS `8.8.8.8` pour effectuer la recherche DNS inverse. Vous pouvez remplacer ce serveur DNS par un autre serveur DNS de votre choix.

En utilisant cette technique, vous pouvez identifier les noms de domaine associ√©s √† des adresses IPv6 inverses et potentiellement d√©couvrir des informations sensibles sur le r√©seau cible.
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### Attaque DDoS de r√©cursion DNS

Si la **r√©cursion DNS est activ√©e**, un attaquant pourrait **usurper** l'**origine** du paquet UDP afin de faire **envoyer la r√©ponse DNS au serveur victime**. Un attaquant pourrait abuser des types d'enregistrement **ANY** ou **DNSSEC** car ils ont tendance √† avoir les plus grandes r√©ponses.\
La fa√ßon de **v√©rifier** si un DNS prend en charge la **r√©cursion** est de consulter un nom de domaine et de **v√©rifier** si le drapeau "ra" (_r√©cursion disponible_) est pr√©sent dans la r√©ponse :
```bash
dig google.com A @<IP>
```
**Non disponible**:

![](<../.gitbook/assets/image (275).png>)

**Disponible**:

![](<../.gitbook/assets/image (276).png>)

<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference est un √©v√©nement international de cybers√©curit√©**](https://www.dragonjarcon.org/) qui a plus d'une d√©cennie et qui se tiendra les 7 et 8 septembre 2023 √† Bogot√°, en Colombie. C'est un √©v√©nement de contenu technique √©lev√© o√π les derni√®res recherches en espagnol sont pr√©sent√©es, attirant des hackers et des chercheurs du monde entier.\
Inscrivez-vous d√®s maintenant sur le lien suivant et ne manquez pas cette grande conf√©rence!:

{% embed url="https://www.dragonjarcon.org/" %}

### Envoi de courrier √† une adresse inexistante

Extrait du livre: Network Security Assessment (3√®me √©dition)

L'envoi d'un simple message √©lectronique √† une adresse inexistante sur un domaine cible r√©v√®le souvent des informations utiles sur le r√©seau interne gr√¢ce √† une notification de non-livraison (NDN).
```
Generating server: noa.nintendo.com

blah@nintendo.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from ONERDEDGE02.one.nintendo.com (10.13.20.35) by
 onerdexch08.one.nintendo.com (10.13.30.39) with Microsoft SMTP Server (TLS)
 id 14.3.174.1; Sat, 26 Apr 2014 16:52:22 -0700
Received: from barracuda.noa.nintendo.com (205.166.76.35) by
 ONERDEDGE02.one.nintendo.com (10.13.20.35) with Microsoft SMTP Server (TLS)
 id 14.3.174.1; Sat, 26 Apr 2014 16:51:22 -0700
X-ASG-Debug-ID: 1398556333-0614671716199b0d0001-zOQ9WJ
Received: from gateway05.websitewelcome.com (gateway05.websitewelcome.com  [69.93.154.37]) by 
barracuda.noa.nintendo.com with ESMTP id xVNPkwaqGgdyH5Ag for <blah@nintendo.com>; Sat, 
26 Apr 2014 16:52:13 -0700 (PDT)
X-Barracuda-Envelope-From: chris@example.org
X-Barracuda-Apparent-Source-IP: 69.93.154.37
```
Les donn√©es suivantes dans cette transcription sont utiles :

* Les noms d'h√¥tes internes, les adresses IP et la disposition des sous-domaines
* Le serveur de messagerie utilise Microsoft Exchange Server 2010 SP3
* Un dispositif Barracuda Networks est utilis√© pour effectuer la filtrage de contenu

## Fichiers de configuration
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
Param√®tres dangereux lors de la configuration d'un serveur Bind:

| **Option**        | **Description**                                                                |
| ----------------- | ------------------------------------------------------------------------------ |
| `allow-query`     | D√©finit les h√¥tes autoris√©s √† envoyer des requ√™tes au serveur DNS.            |
| `allow-recursion` | D√©finit les h√¥tes autoris√©s √† envoyer des requ√™tes r√©cursives au serveur DNS.  |
| `allow-transfer`  | D√©finit les h√¥tes autoris√©s √† recevoir des transferts de zone depuis le serveur DNS. |
| `zone-statistics` | Collecte des donn√©es statistiques sur les zones.                                            |

## Commandes automatiques HackTricks
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
  Name: Notes
  Description: Notes for DNS
  Note: |
    #These are the commands I run every time I see an open DNS port

    dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
    dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
    dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
    dig axfr @{IP}
    dig axfr {Domain_Name} @{IP}
    nslookup
        SERVER {IP}
        127.0.0.1
        {IP}
        Domain_Name
        exit

    https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
  Name: Banner Grab
  Description: Grab DNS Banner
  Command: dig version.bind CHAOS TXT @DNS

Entry_3:
  Name: Nmap Vuln Scan
  Description: Scan for Vulnerabilities with Nmap
  Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
  Name: Zone Transfer
  Description: Three attempts at forcing a zone transfer
  Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
  Name: Active Directory
  Description: Eunuerate a DC via DNS
  Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"
  
Entry_6:
  Name: consolesless mfs enumeration
  Description: DNS enumeration without the need to run msfconsole
  Note: sourced from https://github.com/carlospolop/legion
  Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit' 
```
<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference est un √©v√©nement international de cybers√©curit√©**](https://www.dragonjarcon.org/) qui a plus d'une d√©cennie et qui se tiendra les 7 et 8 septembre 2023 √† Bogot√°, en Colombie. C'est un √©v√©nement de contenu technique √©lev√© o√π les derni√®res recherches en espagnol sont pr√©sent√©es, attirant des hackers et des chercheurs du monde entier.\
Inscrivez-vous d√®s maintenant sur le lien suivant et ne manquez pas cette grande conf√©rence !:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
