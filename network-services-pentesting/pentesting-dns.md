# 53 - DNS Pentesting

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Hemen kullanÄ±labilir zafiyet deÄŸerlendirme ve penetrasyon testi kurulumu**. 20+'den fazla araÃ§ ve Ã¶zellikle her yerden tam bir pentest Ã§alÄ±ÅŸtÄ±rÄ±n. Bu araÃ§lar ve Ã¶zellikler, keÅŸiften raporlamaya kadar uzanan Ã¶zel araÃ§lar, tespit ve istismar modÃ¼lleri geliÅŸtirerek pentesterlara daha fazla zaman kazandÄ±rÄ±r, daha derine inmelerini, kabuklarÄ± patlatmalarÄ±nÄ± ve eÄŸlenmelerini saÄŸlar.

{% embed url="https://pentest-tools.com/" %}

## **Temel Bilgiler**

**Alan AdÄ± Sistemi (DNS)**, kullanÄ±cÄ±larÄ±n sayÄ±sal Ä°nternet ProtokolÃ¼ (IP) adresleri yerine google.com veya facebook.com gibi **kolay hatÄ±rlanan alan adlarÄ±** aracÄ±lÄ±ÄŸÄ±yla web sitelerine eriÅŸmelerini saÄŸlayan internetin dizin hizmeti olarak gÃ¶rev yapar. Alan adlarÄ±nÄ± IP adreslerine Ã§evirerek, DNS web tarayÄ±cÄ±larÄ±nÄ±n internet kaynaklarÄ±nÄ± hÄ±zlÄ± bir ÅŸekilde yÃ¼klemesini saÄŸlar ve Ã§evrimiÃ§i dÃ¼nyada gezinmeyi basitleÅŸtirir.

**VarsayÄ±lan port:** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### FarklÄ± DNS SunucularÄ±

- **DNS KÃ¶k SunucularÄ±**: Bunlar DNS hiyerarÅŸisinin en Ã¼stÃ¼nde bulunur ve alt dÃ¼zey sunucular yanÄ±t vermezse devreye girerek Ã¼st dÃ¼zey alanlarÄ± yÃ¶netir. Ä°ÅŸlevlerini Internet Corporation for Assigned Names and Numbers (**ICANN**) denetler ve kÃ¼resel olarak 13 adet bulunur.

- **Yetkili Ad SunucularÄ±**: Bu sunucular, belirli bÃ¶lgelerindeki sorgular iÃ§in kesin yanÄ±tlar sunar ve kesin karar verme yetkisine sahiptir. YanÄ±t saÄŸlayamazlarsa sorgu kÃ¶k sunuculara yÃ¶nlendirilir.

- **Yetkisiz Ad SunucularÄ±**: DNS bÃ¶lgelerine sahip olmayan bu sunucular, diÄŸer sunuculara yapÄ±lan sorgular aracÄ±lÄ±ÄŸÄ±yla alan bilgilerini toplar.

- **Ã–nbelleÄŸe Alma DNS Sunucusu**: Bu tÃ¼r bir sunucu, gelecekteki isteklerin yanÄ±t sÃ¼relerini hÄ±zlandÄ±rmak iÃ§in Ã¶nceki sorgu yanÄ±tlarÄ±nÄ± belirli bir sÃ¼re boyunca belleÄŸinde saklar ve bu sÃ¼re yetkili sunucu tarafÄ±ndan belirlenir.

- **YÃ¶nlendirme Sunucusu**: Basit bir rolÃ¼ olan yÃ¶nlendirme sunucularÄ±, sorgularÄ± baÅŸka bir sunucuya iletmektedir.

- **Ã‡Ã¶zÃ¼mleyici**: Bilgisayarlara veya yÃ¶nlendiricilere entegre edilen Ã§Ã¶zÃ¼mleyiciler, yerel olarak ad Ã§Ã¶zÃ¼mlemesini gerÃ§ekleÅŸtirir ve yetkili olarak kabul edilmez.

## NumaralandÄ±rma

### **Banner Yakalama**

DNS'te banner bulunmamaktadÄ±r, ancak Ã§oÄŸu BIND ad sunucusunda Ã§alÄ±ÅŸacak olan `version.bind. CHAOS TXT` iÃ§in sihirli sorguyu yakalayabilirsiniz.\
Bu sorguyu `dig` kullanarak gerÃ§ekleÅŸtirebilirsiniz:
```bash
dig version.bind CHAOS TXT @DNS
```
AyrÄ±ca, [`fpdns`](https://github.com/kirei/fpdns) aracÄ±yla sunucunun parmak izi de alÄ±nabilir.

AyrÄ±ca, bir **nmap** betiÄŸi ile banner da alÄ±nabilir:
```
--script dns-nsid
```
### **Herhangi bir kayÄ±t**

**ANY** kaydÄ±, DNS sunucusuna **tÃ¼m mevcut giriÅŸleri** sormak iÃ§in kullanÄ±lÄ±r ve sunucunun **aÃ§Ä±klamaya istekli olduÄŸu** tÃ¼m bilgileri **geri dÃ¶ndÃ¼rmesini** isteyebilir.
```bash
dig any victim.com @<DNS_IP>
```
### **BÃ¶lge Transferi**

Bu iÅŸlem `Asenkron Tam Transfer BÃ¶lgesi` (`AXFR`) olarak kÄ±saltÄ±lÄ±r.
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### Daha Fazla Bilgi
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### Otomasyon

Automation, in the context of network services pentesting, refers to the use of tools and scripts to streamline and expedite the process of testing and exploiting DNS vulnerabilities. By automating certain tasks, such as reconnaissance, enumeration, and exploitation, pentesters can save time and effort while ensuring thorough testing of DNS configurations.

Otomasyon, aÄŸ hizmetleri pentesting baÄŸlamÄ±nda, DNS zafiyetlerinin test edilmesi ve sÃ¶mÃ¼rÃ¼lmesi sÃ¼recini hÄ±zlandÄ±rmak ve kolaylaÅŸtÄ±rmak iÃ§in araÃ§ ve komut dosyalarÄ±nÄ±n kullanÄ±lmasÄ± anlamÄ±na gelir. KeÅŸif, numaralandÄ±rma ve sÃ¶mÃ¼rme gibi belirli gÃ¶revleri otomatikleÅŸtirerek, pentester'lar DNS yapÄ±landÄ±rmalarÄ±nÄ±n kapsamlÄ± bir ÅŸekilde test edilmesini saÄŸlarken zaman ve Ã§aba tasarrufu yapabilirler.
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### nslookup KullanÄ±mÄ±

`nslookup` komutu, DNS (Alan AdÄ± Sistemi) sorgularÄ±nÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lan bir araÃ§tÄ±r. Bu araÃ§, belirli bir IP adresine veya alan adÄ±na ait DNS kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in kullanÄ±labilir.

**KullanÄ±mÄ±:**

```bash
nslookup [alan_adÄ± veya_IP_adresi]
```

**Ã–rnekler:**

- Belirli bir alan adÄ±nÄ±n IP adresini sorgulamak iÃ§in:

```bash
nslookup example.com
```

- Belirli bir IP adresine ait alan adÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup 192.168.0.1
```

- Belirli bir alan adÄ±nÄ±n MX (Posta DeÄŸiÅŸtiricisi) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=mx example.com
```

- Belirli bir alan adÄ±nÄ±n NS (Alan Sunucusu) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=ns example.com
```

- Belirli bir alan adÄ±nÄ±n TXT (Metin) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=txt example.com
```

- Belirli bir alan adÄ±nÄ±n SOA (Yetki KaydÄ±) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=soa example.com
```

- Belirli bir alan adÄ±nÄ±n CNAME (Kanonik Ad) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=cname example.com
```

- Belirli bir alan adÄ±nÄ±n AAAA (IPv6) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=aaaa example.com
```

- Belirli bir alan adÄ±nÄ±n PTR (Ters DNS) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=ptr 192.168.0.1
```

- Belirli bir alan adÄ±nÄ±n SRV (Hizmet) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=srv _sip._tcp.example.com
```

- Belirli bir alan adÄ±nÄ±n NSEC (Alan AdÄ± GÃ¼venliÄŸi) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=nsec example.com
```

- Belirli bir alan adÄ±nÄ±n DNSKEY (DNS Anahtar) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=dnskey example.com
```

- Belirli bir alan adÄ±nÄ±n DS (Alan AdÄ± GÃ¼venliÄŸi) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=ds example.com
```

- Belirli bir alan adÄ±nÄ±n NSEC3 (Alan AdÄ± GÃ¼venliÄŸi) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=nsec3 example.com
```

- Belirli bir alan adÄ±nÄ±n TLSA (Transport Layer Security Authentication) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=tlsa example.com
```

- Belirli bir alan adÄ±nÄ±n SSHFP (SSH Fingerprints) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=sshfp example.com
```

- Belirli bir alan adÄ±nÄ±n SPF (Sender Policy Framework) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=spf example.com
```

- Belirli bir alan adÄ±nÄ±n HINFO (Host Information) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=hinfo example.com
```

- Belirli bir alan adÄ±nÄ±n RP (Responsible Person) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=rp example.com
```

- Belirli bir alan adÄ±nÄ±n PTR (Ters DNS) kaydÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=ptr 192.168.0.1
```

- Belirli bir alan adÄ±nÄ±n A (IPv4) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=a example.com
```

- Belirli bir alan adÄ±nÄ±n ANY (TÃ¼m KayÄ±tlar) kayÄ±tlarÄ±nÄ± sorgulamak iÃ§in:

```bash
nslookup -type=any example.com
```

**Not:** YukarÄ±daki Ã¶rneklerde `example.com` ve `192.168.0.1` yerine ilgili alan adÄ± veya IP adresini kullanmalÄ±sÄ±nÄ±z.
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### KullanÄ±ÅŸlÄ± metasploit modÃ¼lleri

Metasploit, birÃ§ok farklÄ± aÄŸ hizmetini hedefleyen bir dizi kullanÄ±ÅŸlÄ± modÃ¼l sunar. Bu modÃ¼ller, hedef sistemlerde zafiyetler bulmak ve istismar etmek iÃ§in kullanÄ±labilir. Ä°ÅŸte bazÄ± kullanÄ±ÅŸlÄ± metasploit modÃ¼lleri:

- `auxiliary/scanner/dns/dns_enum`: DNS sunucusunu keÅŸfetmek ve DNS kayÄ±tlarÄ±nÄ± toplamak iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_recon`: DNS sunucusunu keÅŸfetmek ve DNS kayÄ±tlarÄ±nÄ± toplamak iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_brute`: DNS sunucusunda brute force saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_cache_snoop`: DNS Ã¶nbelleÄŸini sorgulamak ve gizli bilgileri ortaya Ã§Ä±karmak iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_cache_poison`: DNS Ã¶nbelleÄŸini zehirlemek ve hedef sistemdeki DNS yanÄ±tlarÄ±nÄ± manipÃ¼le etmek iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_transfer`: DNS bÃ¶lgesi transferini gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lÄ±r.
- `auxiliary/scanner/dns/dns_wildcard`: Hedef DNS sunucusunda joker karakterlerin kullanÄ±lÄ±p kullanÄ±lmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in kullanÄ±lÄ±r.

Bu modÃ¼ller, DNS hizmetlerini hedefleyen birÃ§ok farklÄ± saldÄ±rÄ± senaryosunu gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±labilir. Metasploit, bu modÃ¼llerin yanÄ± sÄ±ra diÄŸer birÃ§ok farklÄ± hizmet iÃ§in de kullanÄ±ÅŸlÄ± modÃ¼ller sunar.
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### KullanÄ±ÅŸlÄ± nmap betikleri

Nmap, aÄŸ tarama ve keÅŸif aracÄ± olarak kullanÄ±lan popÃ¼ler bir araÃ§tÄ±r. Nmap, kullanÄ±cÄ±larÄ±n aÄŸ hedeflerini taramak ve keÅŸfetmek iÃ§in Ã§eÅŸitli betikler kullanmasÄ±na olanak tanÄ±r. Ä°ÅŸte bazÄ± kullanÄ±ÅŸlÄ± Nmap betikleri:

- **dns-brute.nse**: Bu betik, DNS sunucusuna karÅŸÄ± brute force saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lÄ±r. DNS sunucusunda mevcut olan alan adlarÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±labilir.

- **dns-cache-snoop.nse**: Bu betik, hedef DNS sunucusunun Ã¶nbelleÄŸindeki kayÄ±tlarÄ± sorgulamak iÃ§in kullanÄ±lÄ±r. Bu sayede, hedef DNS sunucusunun Ã¶nbelleÄŸindeki gizli bilgilere eriÅŸebilirsiniz.

- **dns-zone-transfer.nse**: Bu betik, hedef DNS sunucusundan alan adÄ± bÃ¶lgesi transferini gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lÄ±r. Bu sayede, hedef DNS sunucusunun tÃ¼m alan adÄ± kayÄ±tlarÄ±nÄ± elde edebilirsiniz.

- **dns-update.nse**: Bu betik, hedef DNS sunucusuna DNS gÃ¼ncelleme istekleri gÃ¶ndermek iÃ§in kullanÄ±lÄ±r. Bu sayede, hedef DNS sunucusunda yetkisiz gÃ¼ncellemeler yapabilirsiniz.

- **dns-recursion.nse**: Bu betik, hedef DNS sunucusunun rekÃ¼rsif sorgu Ã¶zelliÄŸini test etmek iÃ§in kullanÄ±lÄ±r. Bu sayede, hedef DNS sunucusunun yetkisiz sorgulara izin verip vermediÄŸini belirleyebilirsiniz.

Bu betikler, Nmap'Ä±n gÃ¼Ã§lÃ¼ tarama ve keÅŸif yeteneklerini kullanarak DNS hedeflerini analiz etmenize yardÄ±mcÄ± olur.
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - Tersine BF

Tersine brute force (Reverse BF), bir hedefin IP adreslerini belirlemek iÃ§in DNS sunucusunu hedefleyen bir saldÄ±rÄ± tÃ¼rÃ¼dÃ¼r. Bu saldÄ±rÄ±da, saldÄ±rgan, hedefin alan adÄ±yla iliÅŸkili IP adreslerini keÅŸfetmek iÃ§in DNS sunucusuna talepler gÃ¶nderir.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Hedef alan adÄ±nÄ± belirleyin.
2. DNS sunucusunu belirleyin.
3. DNS sunucusuna talepler gÃ¶ndermek iÃ§in bir araÃ§ kullanÄ±n.
4. DNS sunucusundan gelen yanÄ±tlarÄ± analiz edin ve hedefin IP adreslerini belirleyin.

Tersine brute force saldÄ±rÄ±sÄ±, hedefin IP adreslerini belirlemek iÃ§in etkili bir yÃ¶ntem olabilir, ancak hedefin DNS sunucusunun gÃ¼venlik Ã¶nlemlerini aÅŸmak zor olabilir. Bu nedenle, bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmeden Ã¶nce yasal izinleri almak ve hedefin izni olmadan test yapmamak Ã¶nemlidir.
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
EÄŸer iÃ§ IP adreslerine Ã§Ã¶zÃ¼len alt alan adlarÄ±nÄ± bulabilirseniz, bu IP aralÄ±ÄŸÄ± iÃ§in NS'lere ters dns BF yapmayÄ± denemelisiniz.
{% endhint %}

Bunu yapmak iÃ§in baÅŸka bir araÃ§: [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

Ters IP aralÄ±klarÄ±nÄ± sorgulayabilirsiniz: [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns) (bu araÃ§ BGP ile de yardÄ±mcÄ± olur).

### DNS - Alt Alan AdlarÄ± BF
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### Active Directory sunucularÄ±

Active Directory (AD), Microsoft tarafÄ±ndan geliÅŸtirilen ve aÄŸ kaynaklarÄ±nÄ± yÃ¶netmek iÃ§in kullanÄ±lan bir dizin hizmetidir. AD sunucularÄ±, aÄŸdaki kullanÄ±cÄ± hesaplarÄ±nÄ±, gruplarÄ±, bilgisayarlarÄ± ve diÄŸer kaynaklarÄ± yÃ¶netmek iÃ§in kullanÄ±lÄ±r. AD sunucularÄ±, aÄŸdaki kullanÄ±cÄ±larÄ±n kimlik doÄŸrulamasÄ±nÄ± saÄŸlar ve aÄŸ kaynaklarÄ±na eriÅŸim kontrolÃ¼nÃ¼ yÃ¶netir.

AD sunucularÄ±nÄ± hedef alarak yapÄ±lan saldÄ±rÄ±lar, aÄŸa eriÅŸimi elde etmek, kimlik avÄ± yapmak veya yetkilendirme hatalarÄ±nÄ± kullanarak ayrÄ±calÄ±klÄ± eriÅŸim elde etmek gibi amaÃ§larla gerÃ§ekleÅŸtirilebilir. Bu nedenle, AD sunucularÄ±nÄ±n gÃ¼venliÄŸini saÄŸlamak ve saldÄ±rÄ±lara karÅŸÄ± korumak Ã¶nemlidir.

AD sunucularÄ±nÄ± hedef alan saldÄ±rÄ±lar arasÄ±nda brute force saldÄ±rÄ±larÄ±, kimlik avÄ± saldÄ±rÄ±larÄ±, zayÄ±f ÅŸifrelerin keÅŸfedilmesi ve yetkilendirme hatalarÄ±nÄ±n kullanÄ±lmasÄ± gibi yÃ¶ntemler bulunur. Bu saldÄ±rÄ±larÄ± Ã¶nlemek iÃ§in gÃ¼Ã§lÃ¼ ÅŸifre politikalarÄ± uygulanmalÄ±, gÃ¼ncel gÃ¼venlik yamalarÄ± uygulanmalÄ± ve aÄŸ trafiÄŸi izlenerek anormal aktiviteler tespit edilmelidir.
```bash
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com

nslookup -type=srv _kerberos._tcp.<CLIENT_DOMAIN>
nslookup -type=srv _kerberos._tcp.domain.com

nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
DNSSec (Domain Name System Security Extensions), alan adÄ± sistemine gÃ¼venlik eklemeleri saÄŸlayan bir mekanizmadÄ±r. DNSSec, DNS trafiÄŸinin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve doÄŸruluÄŸunu saÄŸlamak iÃ§in kullanÄ±lÄ±r. Bu, DNS sorgularÄ±nÄ±n ve yanÄ±tlarÄ±nÄ±n deÄŸiÅŸtirilmediÄŸini ve sahte olmadÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in dijital imzalar kullanÄ±r.

DNSSec, DNS Ã¼zerindeki Ã§eÅŸitli saldÄ±rÄ±larÄ± Ã¶nlemek iÃ§in tasarlanmÄ±ÅŸtÄ±r. Ã–rneÄŸin, DNS cache zehirlenmesi saldÄ±rÄ±larÄ±na karÅŸÄ± koruma saÄŸlar. Bu saldÄ±rÄ±da, saldÄ±rgan, DNS sunucusuna yanÄ±ltÄ±cÄ± bilgiler gÃ¶ndererek, kullanÄ±cÄ±larÄ± yanlÄ±ÅŸ IP adreslerine yÃ¶nlendirebilir. DNSSec, bu tÃ¼r saldÄ±rÄ±larÄ± tespit eder ve Ã¶nler.

DNSSec, DNS hiyerarÅŸisindeki her dÃ¼ÄŸÃ¼mÃ¼n (kÃ¶k, alan adÄ± sunucusu, alt alan adÄ± sunucusu) dijital bir imza kullanarak DNS kayÄ±tlarÄ±nÄ± doÄŸrulamasÄ±nÄ± saÄŸlar. Bu imzalar, DNS kayÄ±tlarÄ±nÄ±n bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve doÄŸruluÄŸunu saÄŸlamak iÃ§in kullanÄ±lÄ±r. Bir DNS istemcisi, DNS sunucusundan aldÄ±ÄŸÄ± yanÄ±tÄ±n doÄŸruluÄŸunu kontrol etmek iÃ§in bu imzalarÄ± kullanÄ±r.

DNSSec, DNS gÃ¼venliÄŸini artÄ±rmak iÃ§in Ã¶nemli bir adÄ±mdÄ±r. Ancak, DNSSec'in tam olarak etkili olabilmesi iÃ§in tÃ¼m DNS sunucularÄ±nÄ±n DNSSec'i desteklemesi gerekmektedir. Aksi takdirde, saldÄ±rganlar hala DNSSec'i desteklemeyen sunucularÄ± hedef alabilir ve saldÄ±rÄ±larÄ±nÄ± gerÃ§ekleÅŸtirebilir.
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

IPv6 alt alan adlarÄ±nÄ±n IPv6 adreslerini toplamak iÃ§in "AAAA" isteklerini kullanarak brute force yapÄ±n.
```bash
dnsdict6 -s -t <domain>
```
# IPv6 Adresleri Kullanarak Ters DNS Bruteforce YÃ¶ntemi

IPv6 adreslerini kullanarak ters DNS bruteforce yÃ¶ntemi, hedef sistemdeki IPv6 adreslerine karÅŸÄ±lÄ±k gelen DNS kayÄ±tlarÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±lÄ±r. Bu yÃ¶ntem, hedef sistemdeki aÄŸ servislerini ve altyapÄ±yÄ± analiz etmek iÃ§in kullanÄ±ÅŸlÄ±dÄ±r.

## AdÄ±m 1: IPv6 Adres AralÄ±ÄŸÄ±nÄ± Belirleme

Ä°lk adÄ±m olarak, hedef sistemdeki IPv6 adres aralÄ±ÄŸÄ±nÄ± belirlememiz gerekmektedir. Bu aralÄ±ÄŸÄ± belirlemek iÃ§in Ã§eÅŸitli yÃ¶ntemler kullanabiliriz, Ã¶rneÄŸin hedef sistemdeki aÄŸ yapÄ±landÄ±rma dosyalarÄ±nÄ± veya aÄŸ tarayÄ±cÄ±larÄ±nÄ± kullanabiliriz.

## AdÄ±m 2: Ters DNS SorgularÄ±nÄ± Yapma

BelirlediÄŸimiz IPv6 adres aralÄ±ÄŸÄ± Ã¼zerinde ters DNS sorgularÄ± yaparak, hedef sistemdeki DNS kayÄ±tlarÄ±nÄ± keÅŸfedebiliriz. Bu sorgularÄ± yapmak iÃ§in Ã§eÅŸitli araÃ§lar kullanabiliriz, Ã¶rneÄŸin `nslookup` veya `dig` gibi.

```markdown
Ã–rnek KullanÄ±m:

```
nslookup -type=PTR 2001:0db8:85a3:0000:0000:8a2e:0370:7334
```

```

## AdÄ±m 3: SonuÃ§larÄ± Analiz Etme

YaptÄ±ÄŸÄ±mÄ±z ters DNS sorgularÄ±nÄ±n sonuÃ§larÄ±nÄ± analiz ederek, hedef sistemdeki DNS kayÄ±tlarÄ±nÄ± elde edebiliriz. Bu kayÄ±tlar, hedef sistemdeki aÄŸ servislerini ve altyapÄ±yÄ± daha iyi anlamamÄ±za yardÄ±mcÄ± olacaktÄ±r.

Ters DNS bruteforce yÃ¶ntemi, hedef sistemdeki IPv6 adreslerine karÅŸÄ±lÄ±k gelen DNS kayÄ±tlarÄ±nÄ± keÅŸfetmek iÃ§in etkili bir yÃ¶ntemdir. Bu yÃ¶ntem, aÄŸ servislerini ve altyapÄ±yÄ± analiz etmek iÃ§in kullanÄ±lan diÄŸer tekniklerle birlikte kullanÄ±labilir.
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNS RekÃ¼rsif DDoS

EÄŸer **DNS rekÃ¼rsif** etkinleÅŸtirilmiÅŸse, bir saldÄ±rgan UDP paketinde **kÃ¶keni sahteleyebilir** ve **DNS'in yanÄ±tÄ± kurban sunucuya gÃ¶ndermesini saÄŸlayabilir**. Bir saldÄ±rgan, daha bÃ¼yÃ¼k yanÄ±tlara sahip olduklarÄ± iÃ§in **ANY** veya **DNSSEC** kayÄ±t tÃ¼rlerini istismar edebilir.\
Bir DNS'in **rekÃ¼rsif** desteÄŸini kontrol etmenin yolu, bir alan adÄ±nÄ± sorgulamak ve yanÄ±tta **"ra"** (_rekÃ¼rsif kullanÄ±labilir_) bayraÄŸÄ±nÄ±n olup olmadÄ±ÄŸÄ±nÄ± **kontrol etmektir**:
```bash
dig google.com A @<IP>
```
**Mevcut DeÄŸil**:

![](<../.gitbook/assets/image (275).png>)

**Mevcut**:

![](<../.gitbook/assets/image (276).png>)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**AnÄ±nda kullanÄ±labilir zafiyet deÄŸerlendirme ve penetrasyon testi kurulumu**. 20'den fazla araÃ§ ve Ã¶zellikle birlikte her yerden tam bir pentest Ã§alÄ±ÅŸtÄ±rÄ±n. Bu araÃ§lar ve Ã¶zellikler, keÅŸiften raporlamaya kadar uzanÄ±r. Pentester'larÄ± deÄŸiÅŸtirmiyoruz - Ã¶zel araÃ§lar, tespit ve istismar modÃ¼lleri geliÅŸtiriyoruz, bÃ¶ylece daha derine kazma, kabuklarÄ± patlatma ve eÄŸlenme zamanÄ± kazanÄ±yorlar.

{% embed url="https://pentest-tools.com/" %}

### Mevcut olmayan bir hesaba e-posta gÃ¶nderme

Hedef bir alan iÃ§inde geÃ§ersiz bir adrese gÃ¶nderilen bir e-posta tarafÄ±ndan tetiklenen bir teslim edilememe bildirimi (NDN) incelenerek, deÄŸerli iÃ§ aÄŸ ayrÄ±ntÄ±larÄ± genellikle ifÅŸa edilir.

SaÄŸlanan teslim edilememe raporu ÅŸu bilgileri iÃ§erir:

- OluÅŸturan sunucu `server.example.com` olarak tanÄ±mlandÄ±.
- `user@example.com` iÃ§in `#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found` hata kodu ile bir baÅŸarÄ±sÄ±zlÄ±k bildirimi dÃ¶ndÃ¼rÃ¼ldÃ¼.
- Ä°Ã§ IP adresleri ve ana bilgisayar adlarÄ±, orijinal ileti baÅŸlÄ±klarÄ±nda ifÅŸa edildi.
```markdown
The original message headers were modified for anonymity and now present randomized data:

Generating server: server.example.com

user@example.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from MAILSERVER01.domain.example.com (192.168.1.1) by
mailserver02.domain.example.com (192.168.2.2) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:52:22 -0700
Received: from filter.example.com (203.0.113.1) by
MAILSERVER01.domain.example.com (192.168.1.1) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Mon, 25 May 2015 14:51:22 -0700
X-ASG-Debug-ID: 1432576343-0614671716190e0d0001-zOQ9WJ
Received: from gateway.domainhost.com (gateway.domainhost.com [198.51.100.37]) by
filter.example.com with ESMTP id xVNPkwaqGgdyH5Ag for user@example.com; Mon,
25 May 2015 14:52:13 -0700 (PDT)
X-Envelope-From: sender@anotherdomain.org
X-Apparent-Source-IP: 198.51.100.37
```
## YapÄ±landÄ±rma dosyalarÄ±

Config files are files that contain settings and configurations for various applications and services. In the context of DNS pentesting, config files are important because they often contain sensitive information that can be exploited by attackers.

YapÄ±landÄ±rma dosyalarÄ±, Ã§eÅŸitli uygulamalar ve hizmetler iÃ§in ayarlarÄ± ve yapÄ±landÄ±rmalarÄ± iÃ§eren dosyalardÄ±r. DNS pentesting baÄŸlamÄ±nda, yapÄ±landÄ±rma dosyalarÄ± Ã¶nemlidir Ã§Ã¼nkÃ¼ genellikle saldÄ±rganlar tarafÄ±ndan istismar edilebilecek hassas bilgiler iÃ§erir.

### Common DNS Config Files

### YaygÄ±n DNS YapÄ±landÄ±rma DosyalarÄ±

Here are some common DNS config files that you may encounter during DNS pentesting:

DNS pentesting sÄ±rasÄ±nda karÅŸÄ±laÅŸabileceÄŸiniz bazÄ± yaygÄ±n DNS yapÄ±landÄ±rma dosyalarÄ± aÅŸaÄŸÄ±da listelenmiÅŸtir:

- **named.conf**: This is the main configuration file for the BIND DNS server. It contains global options and settings for the server.

- **named.conf**: Bu, BIND DNS sunucusu iÃ§in ana yapÄ±landÄ±rma dosyasÄ±dÄ±r. Sunucu iÃ§in genel seÃ§enekler ve ayarlarÄ± iÃ§erir.

- **named.conf.local**: This file is used to define local zones and their configurations. It is included in the main named.conf file.

- **named.conf.local**: Bu dosya, yerel bÃ¶lgeleri ve yapÄ±landÄ±rmalarÄ±nÄ± tanÄ±mlamak iÃ§in kullanÄ±lÄ±r. Ana named.conf dosyasÄ±na dahil edilir.

- **named.conf.options**: This file contains global options and settings for the BIND DNS server. It is also included in the main named.conf file.

- **named.conf.options**: Bu dosya, BIND DNS sunucusu iÃ§in genel seÃ§enekleri ve ayarlarÄ± iÃ§erir. AyrÄ±ca ana named.conf dosyasÄ±na dahil edilir.

- **resolv.conf**: This file is used by the DNS resolver library to configure DNS resolution on the system. It specifies the DNS servers to use and other resolver options.

- **resolv.conf**: Bu dosya, DNS Ã§Ã¶zÃ¼mleyici kitaplÄ±ÄŸÄ±nÄ±n sistemde DNS Ã§Ã¶zÃ¼mlemesini yapÄ±landÄ±rmak iÃ§in kullandÄ±ÄŸÄ± dosyadÄ±r. KullanÄ±lacak DNS sunucularÄ±nÄ± ve diÄŸer Ã§Ã¶zÃ¼mleyici seÃ§eneklerini belirtir.

### Finding Config Files

### YapÄ±landÄ±rma DosyalarÄ±nÄ± Bulma

During DNS pentesting, it is important to identify the location of config files on the target system. Here are some techniques to find config files:

DNS pentesting sÄ±rasÄ±nda, hedef sistemdeki yapÄ±landÄ±rma dosyalarÄ±nÄ±n konumunu belirlemek Ã¶nemlidir. Ä°ÅŸte yapÄ±landÄ±rma dosyalarÄ±nÄ± bulmak iÃ§in bazÄ± teknikler:

- **Manual Search**: Manually search common locations for config files such as /etc/bind/ or /etc/named/.

- **Elle Arama**: /etc/bind/ veya /etc/named/ gibi yaygÄ±n yapÄ±landÄ±rma dosyalarÄ±nÄ±n konumlarÄ±nÄ± el ile arayÄ±n.

- **DNS Zone Transfers**: Perform DNS zone transfers to obtain the DNS server's configuration files.

- **DNS BÃ¶lge AktarÄ±mlarÄ±**: DNS bÃ¶lge aktarÄ±mlarÄ± gerÃ§ekleÅŸtirerek DNS sunucusunun yapÄ±landÄ±rma dosyalarÄ±nÄ± elde edin.

- **Brute Forcing**: Use brute force techniques to guess the location and names of config files.

- **Brute Force**: YapÄ±landÄ±rma dosyalarÄ±nÄ±n konumunu ve adlarÄ±nÄ± tahmin etmek iÃ§in brute force tekniklerini kullanÄ±n.

Once you have identified the config files, you can analyze them for potential vulnerabilities and sensitive information that can be used for further exploitation.

YapÄ±landÄ±rma dosyalarÄ±nÄ± belirledikten sonra, bunlarÄ± potansiyel zafiyetler ve daha fazla istismar iÃ§in kullanÄ±labilecek hassas bilgiler aÃ§Ä±sÄ±ndan analiz edebilirsiniz.
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
Bind sunucusu yapÄ±landÄ±rÄ±lÄ±rken tehlikeli ayarlar:

| **SeÃ§enek**        | **AÃ§Ä±klama**                                                                |
| ----------------- | ------------------------------------------------------------------------------ |
| `allow-query`     | DNS sunucusuna istek gÃ¶ndermeye izin verilen ana bilgisayarlarÄ± tanÄ±mlar.            |
| `allow-recursion` | DNS sunucusuna Ã¶zyinelemeli istek gÃ¶ndermeye izin verilen ana bilgisayarlarÄ± tanÄ±mlar.  |
| `allow-transfer`  | DNS sunucusundan bÃ¶lge transferlerini almasÄ±na izin verilen ana bilgisayarlarÄ± tanÄ±mlar. |
| `zone-statistics` | BÃ¶lgelerin istatistiksel verilerini toplar.                                            |

## Referanslar
* [https://www.myrasecurity.com/en/knowledge-hub/dns/](https://www.myrasecurity.com/en/knowledge-hub/dns/)
* Kitap: **Network Security Assessment 3. baskÄ±**

## HackTricks Otomatik KomutlarÄ±
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Hemen kullanÄ±labilir zafiyet deÄŸerlendirme ve penetrasyon testi kurulumu**. KeÅŸiften raporlamaya kadar 20'den fazla araÃ§ ve Ã¶zellikle her yerden tam bir pentest Ã§alÄ±ÅŸtÄ±rÄ±n. PentesterlarÄ± deÄŸiÅŸtirmiyoruz - Ã¶zel araÃ§lar, tespit ve sÃ¶mÃ¼rÃ¼ modÃ¼lleri geliÅŸtiriyoruz, bÃ¶ylece daha derine inmek, kabuklarÄ± patlatmak ve eÄŸlenmek iÃ§in zaman kazanÄ±yorlar.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
