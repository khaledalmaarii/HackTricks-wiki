# 53 - DNSæ¸—é€æµ‹è¯•

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ–è€… [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ–è€… **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conferenceæ˜¯ä¸€åœºå›½é™…ç½‘ç»œå®‰å…¨æ´»åŠ¨**](https://www.dragonjarcon.org/)ï¼Œå·²ç»ä¸¾åŠäº†åå¤šå¹´ï¼Œå°†äº2023å¹´9æœˆ7æ—¥è‡³8æ—¥åœ¨å“¥ä¼¦æ¯”äºšæ³¢å“¥å¤§ä¸¾è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„æŠ€æœ¯æ´»åŠ¨ï¼Œå±•ç¤ºäº†å¸å¼•å…¨çƒé»‘å®¢å’Œç ”ç©¶äººå‘˜çš„æœ€æ–°ç ”ç©¶æˆæœã€‚\
ç«‹å³åœ¨ä»¥ä¸‹é“¾æ¥æ³¨å†Œï¼Œä¸è¦é”™è¿‡è¿™ä¸ªé‡è¦çš„ä¼šè®®ï¼:

{% embed url="https://www.dragonjarcon.org/" %}

## **åŸºæœ¬ä¿¡æ¯**

åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰æ˜¯äº’è”ç½‘çš„ç”µè¯ç°¿ã€‚äººä»¬é€šè¿‡åŸŸåè®¿é—®åœ¨çº¿ä¿¡æ¯ï¼Œä¾‹å¦‚nytimes.comæˆ–espn.comã€‚Webæµè§ˆå™¨é€šè¿‡Internetåè®®ï¼ˆIPï¼‰åœ°å€è¿›è¡Œäº¤äº’ã€‚DNSå°†åŸŸåè½¬æ¢ä¸º[IPåœ°å€](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/)ï¼Œä»¥ä¾¿æµè§ˆå™¨å¯ä»¥åŠ è½½äº’è”ç½‘èµ„æºã€‚\
æ¥æºï¼š[è¿™é‡Œ](https://www.cloudflare.com/learning/dns/what-is-dns/)ã€‚

**é»˜è®¤ç«¯å£ï¼š** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### ä¸åŒçš„DNSæœåŠ¡å™¨

æ¥è‡ª[https://academy.hackthebox.com/module/112/section/1069](https://academy.hackthebox.com/module/112/section/1069)çš„ä¿¡æ¯

| **æœåŠ¡å™¨ç±»å‹**                | **æè¿°**                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `DNSæ ¹æœåŠ¡å™¨`              | DNSçš„æ ¹æœåŠ¡å™¨è´Ÿè´£é¡¶çº§åŸŸåï¼ˆTLDï¼‰ã€‚ä½œä¸ºæœ€åçš„å®ä¾‹ï¼Œåªæœ‰åœ¨åç§°æœåŠ¡å™¨ä¸å“åº”æ—¶æ‰ä¼šè¯·æ±‚å®ƒä»¬ã€‚å› æ­¤ï¼Œæ ¹æœåŠ¡å™¨æ˜¯ç”¨æˆ·å’Œäº’è”ç½‘ä¸Šå†…å®¹ä¹‹é—´çš„ä¸­å¤®æ¥å£ï¼Œå› ä¸ºå®ƒé“¾æ¥åŸŸåå’ŒIPåœ°å€ã€‚[äº’è”ç½‘åç§°ä¸æ•°å­—åœ°å€åˆ†é…æœºæ„](https://www.icann.org/)ï¼ˆ`ICANN`ï¼‰åè°ƒæ ¹åç§°æœåŠ¡å™¨çš„å·¥ä½œã€‚å…¨çƒå…±æœ‰`13`ä¸ªè¿™æ ·çš„æ ¹æœåŠ¡å™¨ã€‚ |
| `æƒå¨åç§°æœåŠ¡å™¨`     | æƒå¨åç§°æœåŠ¡å™¨å¯¹ç‰¹å®šåŒºåŸŸæ‹¥æœ‰æˆæƒã€‚å®ƒä»¬åªå›ç­”æ¥è‡ªå…¶è´£ä»»åŒºåŸŸçš„æŸ¥è¯¢ï¼Œå¹¶ä¸”å®ƒä»¬çš„ä¿¡æ¯æ˜¯å…·æœ‰çº¦æŸåŠ›çš„ã€‚å¦‚æœæƒå¨åç§°æœåŠ¡å™¨æ— æ³•å›ç­”å®¢æˆ·ç«¯çš„æŸ¥è¯¢ï¼Œåˆ™æ ¹åç§°æœåŠ¡å™¨æ¥ç®¡è¯¥æŸ¥è¯¢ã€‚                                                                                                                                                                                                            |
| `éæƒå¨åç§°æœåŠ¡å™¨` | éæƒå¨åç§°æœåŠ¡å™¨ä¸è´Ÿè´£ç‰¹å®šçš„DNSåŒºåŸŸã€‚ç›¸åï¼Œå®ƒä»¬é€šè¿‡é€’å½’æˆ–è¿­ä»£çš„DNSæŸ¥è¯¢æ¥æ”¶é›†ç‰¹å®šDNSåŒºåŸŸçš„ä¿¡æ¯ã€‚                                                                                                                                                                                                                                                                               |
| `ç¼“å­˜DNSæœåŠ¡å™¨`           | ç¼“å­˜DNSæœåŠ¡å™¨åœ¨æŒ‡å®šçš„æ—¶é—´æ®µå†…ç¼“å­˜æ¥è‡ªå…¶ä»–åç§°æœåŠ¡å™¨çš„ä¿¡æ¯ã€‚è¿™ä¸ªå­˜å‚¨çš„æŒç»­æ—¶é—´ç”±æƒå¨åç§°æœåŠ¡å™¨ç¡®å®šã€‚                                                                                                                                                                                                                                                                                                                             |
| `è½¬å‘æœåŠ¡å™¨`            | è½¬å‘æœåŠ¡å™¨åªæ‰§è¡Œä¸€ä¸ªåŠŸèƒ½ï¼šå°†DNSæŸ¥è¯¢è½¬å‘åˆ°å¦ä¸€ä¸ªDNSæœåŠ¡å™¨ã€‚                                                                                                                                                                                                                                                                                                                                                                                            |
| `è§£æå™¨`                     | è§£æå™¨ä¸æ˜¯æƒå¨DNSæœåŠ¡å™¨ï¼Œè€Œæ˜¯åœ¨è®¡ç®—æœºæˆ–è·¯ç”±å™¨ä¸­æœ¬åœ°æ‰§è¡Œåç§°è§£æã€‚                                                                                                                                                                                                                                                                                                                                                                               |

## æšä¸¾

### **æ¨ªå¹…æŠ“å–**

DNSæ²¡æœ‰å¯æŠ“å–çš„â€œæ¨ªå¹…â€ã€‚æœ€æ¥è¿‘çš„ç­‰æ•ˆç‰©æ˜¯å¯¹å¤§å¤šæ•°BINDåç§°æœåŠ¡å™¨æœ‰æ•ˆçš„`version.bind. CHAOS TXT`çš„é­”æœ¯æŸ¥è¯¢ã€‚\
æ‚¨å¯ä»¥ä½¿ç”¨`dig`æ‰§è¡Œæ­¤æŸ¥è¯¢ï¼š
```bash
dig version.bind CHAOS TXT @DNS
```
å¦‚æœé‚£ä¸èµ·ä½œç”¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æŒ‡çº¹è¯†åˆ«æŠ€æœ¯æ¥ç¡®å®šè¿œç¨‹æœåŠ¡å™¨çš„ç‰ˆæœ¬--[`fpdns`](https://github.com/kirei/fpdns)å·¥å…·æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä½†è¿˜æœ‰å…¶ä»–é€‰é¡¹ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**nmap**è„šæœ¬æ¥è·å–æ¨ªå¹…ï¼š
```
--script dns-nsid
```
### **ä»»æ„è®°å½•**

è®°å½•**ANY**å°†è¦æ±‚DNSæœåŠ¡å™¨**è¿”å›**æ‰€æœ‰å¯ç”¨çš„**æ¡ç›®**ï¼Œå®ƒæ„¿æ„**æŠ«éœ²**çš„ã€‚
```bash
dig any victim.com @<DNS_IP>
```
### **åŒºåŸŸä¼ è¾“**

è¯¥è¿‡ç¨‹ç®€ç§°ä¸º`å¼‚æ­¥å®Œå…¨ä¼ è¾“åŒºåŸŸ`ï¼ˆ`AXFR`ï¼‰ã€‚
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### æ›´å¤šä¿¡æ¯

DNSï¼ˆDomain Name Systemï¼‰æ˜¯äº’è”ç½‘ä¸­ç”¨äºå°†åŸŸåè§£æä¸ºIPåœ°å€çš„ç³»ç»Ÿã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼ŒDNSæ¸—é€æµ‹è¯•æ˜¯ä¸€ç§å¸¸è§çš„æŠ€æœ¯ï¼Œç”¨äºå‘ç°å’Œåˆ©ç”¨ä¸DNSç›¸å…³çš„æ¼æ´å’Œå¼±ç‚¹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„DNSæ¸—é€æµ‹è¯•æŠ€æœ¯ï¼š

#### DNSåŒºåŸŸä¼ è¾“

DNSåŒºåŸŸä¼ è¾“æ˜¯ä¸€ç§ç”¨äºè·å–ç›®æ ‡åŸŸåæœåŠ¡å™¨ä¸Šå®Œæ•´DNSè®°å½•çš„æŠ€æœ¯ã€‚é€šè¿‡æ‰§è¡ŒDNSåŒºåŸŸä¼ è¾“ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥è·å¾—æœ‰å…³ç›®æ ‡ç½‘ç»œæ¶æ„å’ŒåŸŸåçš„é‡è¦ä¿¡æ¯ã€‚

#### DNSç¼“å­˜æŠ•æ¯’

DNSç¼“å­˜æŠ•æ¯’æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œé€šè¿‡å‘ç›®æ ‡DNSæœåŠ¡å™¨å‘é€æ¶æ„çš„DNSå“åº”ï¼Œå°†è™šå‡çš„DNSè®°å½•æ³¨å…¥åˆ°DNSç¼“å­˜ä¸­ã€‚è¿™å¯èƒ½å¯¼è‡´ç”¨æˆ·è¢«é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–å—åˆ°å…¶ä»–ç±»å‹çš„æ”»å‡»ã€‚

#### DNSåŠ«æŒ

DNSåŠ«æŒæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œé€šè¿‡ç¯¡æ”¹ç›®æ ‡DNSæœåŠ¡å™¨çš„å“åº”ï¼Œå°†ç”¨æˆ·çš„åŸŸåè§£æè¯·æ±‚é‡å®šå‘åˆ°æ”»å‡»è€…æ§åˆ¶çš„æ¶æ„æœåŠ¡å™¨ã€‚è¿™ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿæ‹¦æˆªå’Œçªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€‚

#### DNSéš§é“

DNSéš§é“æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œé€šè¿‡åœ¨DNSåè®®ä¸­éšè—æ•°æ®ï¼Œå°†éæ³•çš„ç½‘ç»œæµé‡ä¼ªè£…æˆæ­£å¸¸çš„DNSæµé‡ã€‚è¿™ç§æŠ€æœ¯å¯ç”¨äºç»•è¿‡ç½‘ç»œé˜²ç«å¢™å’Œæ£€æµ‹ç³»ç»Ÿï¼Œä»¥è¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚

#### DNSæ”¾å¤§æ”»å‡»

DNSæ”¾å¤§æ”»å‡»æ˜¯ä¸€ç§åˆ©ç”¨DNSåè®®ä¸­çš„æ¼æ´ï¼Œé€šè¿‡å‘ç›®æ ‡DNSæœåŠ¡å™¨å‘é€å°å‹è¯·æ±‚ï¼Œä½†è·å–å¤§é‡å“åº”æ•°æ®çš„æ”»å‡»æŠ€æœ¯ã€‚è¿™ç§æ”»å‡»å¯ä»¥å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨è¿‡è½½ï¼Œé€ æˆæœåŠ¡ä¸å¯ç”¨ã€‚

#### DNSéšè”½ä¿¡é“

DNSéšè”½ä¿¡é“æ˜¯ä¸€ç§åˆ©ç”¨DNSåè®®çš„ç‰¹æ€§ï¼Œåœ¨æ­£å¸¸çš„DNSæµé‡ä¸­éšè—å’Œä¼ è¾“æ•°æ®çš„æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯å¯ç”¨äºç»•è¿‡ç½‘ç»œç›‘æ§å’Œæ£€æµ‹ç³»ç»Ÿï¼Œè¿›è¡Œéšè”½çš„é€šä¿¡ã€‚

åœ¨è¿›è¡ŒDNSæ¸—é€æµ‹è¯•æ—¶ï¼Œæ¸—é€æµ‹è¯•äººå‘˜éœ€è¦ä½¿ç”¨å„ç§å·¥å…·å’ŒæŠ€æœ¯æ¥å‘ç°å’Œåˆ©ç”¨ä¸DNSç›¸å…³çš„æ¼æ´å’Œå¼±ç‚¹ã€‚è¿™äº›æŠ€æœ¯å¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜è¯„ä¼°ç›®æ ‡ç½‘ç»œçš„å®‰å…¨æ€§ï¼Œå¹¶æä¾›æ”¹è¿›å®‰å…¨æªæ–½çš„å»ºè®®ã€‚
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### è‡ªåŠ¨åŒ–

Automation plays a crucial role in the field of DNS pentesting. It helps in streamlining the process and saves time and effort. There are various tools available that can automate different tasks involved in DNS pentesting.

è‡ªåŠ¨åŒ–åœ¨DNSæ¸—é€æµ‹è¯•é¢†åŸŸèµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å®ƒæœ‰åŠ©äºç®€åŒ–æµç¨‹ï¼ŒèŠ‚çœæ—¶é—´å’Œç²¾åŠ›ã€‚æœ‰å„ç§å·¥å…·å¯ç”¨äºè‡ªåŠ¨åŒ–DNSæ¸—é€æµ‹è¯•ä¸­æ¶‰åŠçš„ä¸åŒä»»åŠ¡ã€‚

#### Enumeration

#### æšä¸¾

Enumeration is the process of gathering information about a target DNS server. It involves finding all the DNS records associated with the target domain. Automated enumeration tools can perform this task efficiently and quickly.

æšä¸¾æ˜¯æ”¶é›†æœ‰å…³ç›®æ ‡DNSæœåŠ¡å™¨çš„ä¿¡æ¯çš„è¿‡ç¨‹ã€‚å®ƒæ¶‰åŠæŸ¥æ‰¾ä¸ç›®æ ‡åŸŸå…³è”çš„æ‰€æœ‰DNSè®°å½•ã€‚è‡ªåŠ¨åŒ–æšä¸¾å·¥å…·å¯ä»¥é«˜æ•ˆå¿«é€Ÿåœ°æ‰§è¡Œæ­¤ä»»åŠ¡ã€‚

#### Zone Transfer

#### åŒºåŸŸä¼ è¾“

Zone transfer is a mechanism that allows DNS servers to share DNS records with each other. It can be exploited to gather valuable information about the target domain. Automated tools can be used to check if zone transfer is enabled and perform the transfer if possible.

åŒºåŸŸä¼ è¾“æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå…è®¸DNSæœåŠ¡å™¨å½¼æ­¤å…±äº«DNSè®°å½•ã€‚å¯ä»¥åˆ©ç”¨å®ƒæ¥æ”¶é›†æœ‰å…³ç›®æ ‡åŸŸçš„æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ¥æ£€æŸ¥åŒºåŸŸä¼ è¾“æ˜¯å¦å·²å¯ç”¨ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹æ‰§è¡Œä¼ è¾“ã€‚

#### DNS Cache Poisoning

#### DNSç¼“å­˜æŠ•æ¯’

DNS cache poisoning is a technique used to manipulate the DNS cache of a target DNS server. It involves injecting malicious DNS records into the cache, which can lead to redirecting users to malicious websites. Automated tools can be used to perform DNS cache poisoning attacks.

DNSç¼“å­˜æŠ•æ¯’æ˜¯ä¸€ç§ç”¨äºæ“çºµç›®æ ‡DNSæœåŠ¡å™¨çš„DNSç¼“å­˜çš„æŠ€æœ¯ã€‚å®ƒæ¶‰åŠå°†æ¶æ„DNSè®°å½•æ³¨å…¥ç¼“å­˜ï¼Œè¿™å¯èƒ½ä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™ã€‚å¯ä»¥ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ‰§è¡ŒDNSç¼“å­˜æŠ•æ¯’æ”»å‡»ã€‚

#### DNS Brute Forcing

#### DNSæš´åŠ›ç ´è§£

DNS brute forcing is a technique used to guess or enumerate DNS records by trying all possible combinations. It can be used to discover subdomains or other hidden DNS records. Automated tools can be used to perform DNS brute forcing attacks.

DNSæš´åŠ›ç ´è§£æ˜¯ä¸€ç§é€šè¿‡å°è¯•æ‰€æœ‰å¯èƒ½çš„ç»„åˆæ¥çŒœæµ‹æˆ–æšä¸¾DNSè®°å½•çš„æŠ€æœ¯ã€‚å®ƒå¯ä»¥ç”¨äºå‘ç°å­åŸŸæˆ–å…¶ä»–éšè—çš„DNSè®°å½•ã€‚å¯ä»¥ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ‰§è¡ŒDNSæš´åŠ›ç ´è§£æ”»å‡»ã€‚

#### Conclusion

#### ç»“è®º

Automation is a valuable asset in DNS pentesting as it helps in efficiently performing various tasks. By using automated tools, pentesters can save time and effort while ensuring a thorough and comprehensive assessment of the target DNS server.

è‡ªåŠ¨åŒ–æ˜¯DNSæ¸—é€æµ‹è¯•ä¸­çš„å®è´µèµ„äº§ï¼Œå®ƒæœ‰åŠ©äºé«˜æ•ˆæ‰§è¡Œå„ç§ä»»åŠ¡ã€‚é€šè¿‡ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥èŠ‚çœæ—¶é—´å’Œç²¾åŠ›ï¼ŒåŒæ—¶ç¡®ä¿å¯¹ç›®æ ‡DNSæœåŠ¡å™¨è¿›è¡Œå…¨é¢å’Œç»¼åˆçš„è¯„ä¼°ã€‚
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### ä½¿ç”¨ nslookup

The `nslookup` command is a powerful tool for querying DNS (Domain Name System) servers to obtain information about domain names and IP addresses. It is commonly used in network reconnaissance and troubleshooting.

To use `nslookup`, open a command prompt or terminal and type `nslookup` followed by the domain name or IP address you want to query. Press Enter to execute the command.

For example, to obtain the IP address of a domain name, type:

```
nslookup example.com
```

This will display the IP address associated with the domain name `example.com`, along with the DNS server that provided the response.

You can also perform reverse DNS lookups by specifying an IP address instead of a domain name. For example:

```
nslookup 192.168.0.1
```

This will display the domain name associated with the IP address `192.168.0.1`, along with the DNS server that provided the response.

`nslookup` also supports various options and commands that can be used to customize the query and obtain specific information. To view the available options and commands, type `nslookup` and press Enter.
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### æœ‰ç”¨çš„Metasploitæ¨¡å—

Metasploitæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ¸—é€æµ‹è¯•å·¥å…·ï¼Œæä¾›äº†è®¸å¤šæœ‰ç”¨çš„æ¨¡å—ï¼Œç”¨äºæ‰§è¡Œå„ç§ç½‘ç»œæœåŠ¡çš„æ¸—é€æµ‹è¯•ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„Metasploitæ¨¡å—ï¼š

- `auxiliary/scanner/dns/dns_enum`ï¼šç”¨äºæ‰§è¡ŒDNSæšä¸¾ï¼Œè·å–ç›®æ ‡åŸŸåçš„ç›¸å…³ä¿¡æ¯ã€‚
- `auxiliary/scanner/dns/dns_recon`ï¼šç”¨äºæ‰§è¡ŒDNSä¾¦å¯Ÿï¼Œæ”¶é›†ç›®æ ‡åŸŸåçš„å­åŸŸåå’Œä¸»æœºè®°å½•ã€‚
- `auxiliary/scanner/dns/dns_brute`ï¼šç”¨äºæ‰§è¡ŒDNSæš´åŠ›ç ´è§£ï¼Œå°è¯•çŒœæµ‹ç›®æ ‡åŸŸåçš„å­åŸŸåå’Œä¸»æœºè®°å½•ã€‚
- `auxiliary/scanner/dns/dns_cache_snoop`ï¼šç”¨äºæ‰§è¡ŒDNSç¼“å­˜çª¥è§†ï¼Œè·å–ç›®æ ‡åŸŸåçš„ç¼“å­˜è®°å½•ã€‚
- `auxiliary/scanner/dns/dns_reverse_lookup`ï¼šç”¨äºæ‰§è¡ŒDNSåå‘æŸ¥æ‰¾ï¼Œè·å–ç›®æ ‡IPåœ°å€çš„åŸŸåã€‚

è¿™äº›æ¨¡å—å¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜å‘ç°ç›®æ ‡ç½‘ç»œä¸­å­˜åœ¨çš„DNSç›¸å…³æ¼æ´å’Œå¼±ç‚¹ï¼Œä»è€Œè¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»å’Œæ¸—é€ã€‚åœ¨ä½¿ç”¨è¿™äº›æ¨¡å—æ—¶ï¼ŒåŠ¡å¿…éµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œä»…ç”¨äºåˆæ³•çš„æ¸—é€æµ‹è¯•æ´»åŠ¨ã€‚
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### æœ‰ç”¨çš„nmapè„šæœ¬

Nmapæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œæ‰«æå·¥å…·ï¼Œå®ƒæä¾›äº†è®¸å¤šæœ‰ç”¨çš„è„šæœ¬ï¼Œç”¨äºè¿›è¡Œç½‘ç»œæœåŠ¡æ¸—é€æµ‹è¯•ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„nmapè„šæœ¬ï¼š

- **dns-brute.nse**ï¼šç”¨äºè¿›è¡ŒDNSæš´åŠ›ç ´è§£ï¼Œå°è¯•æšä¸¾ç›®æ ‡åŸŸåçš„å­åŸŸåã€‚
- **dns-cache-snoop.nse**ï¼šç”¨äºæ£€æŸ¥ç›®æ ‡DNSæœåŠ¡å™¨çš„ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨æ•æ„Ÿä¿¡æ¯ã€‚
- **dns-zone-transfer.nse**ï¼šç”¨äºå°è¯•è·å–ç›®æ ‡åŸŸåçš„DNSåŒºåŸŸä¼ è¾“è®°å½•ã€‚
- **dns-blacklist.nse**ï¼šç”¨äºæ£€æŸ¥ç›®æ ‡åŸŸåæ˜¯å¦è¢«åˆ—å…¥DNSé»‘åå•ã€‚
- **dns-recursion.nse**ï¼šç”¨äºæ£€æŸ¥ç›®æ ‡DNSæœåŠ¡å™¨æ˜¯å¦å¼€å¯äº†é€’å½’æŸ¥è¯¢åŠŸèƒ½ã€‚
- **dns-random-srcport.nse**ï¼šç”¨äºå‘é€DNSè¯·æ±‚æ—¶ä½¿ç”¨éšæœºæºç«¯å£ï¼Œä»¥ç»•è¿‡ä¸€äº›é˜²ç«å¢™è§„åˆ™ã€‚

è¿™äº›è„šæœ¬å¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜å‘ç°ç›®æ ‡ç½‘ç»œä¸­çš„æ½œåœ¨æ¼æ´å’Œå®‰å…¨é£é™©ã€‚åœ¨ä½¿ç”¨è¿™äº›è„šæœ¬æ—¶ï¼Œè¯·ç¡®ä¿éµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œå¹¶è·å¾—åˆæ³•çš„æˆæƒã€‚
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - åå‘æš´åŠ›ç ´è§£

åœ¨DNSæ¸—é€æµ‹è¯•ä¸­ï¼Œåå‘æš´åŠ›ç ´è§£æ˜¯ä¸€ç§å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨äºè·å–ç›®æ ‡ç½‘ç»œä¸­çš„ä¸»æœºåå’ŒIPåœ°å€çš„å…³è”ä¿¡æ¯ã€‚è¿™ç§æŠ€æœ¯åˆ©ç”¨äº†DNSæœåŠ¡å™¨çš„ç‰¹æ€§ï¼Œé€šè¿‡å°è¯•ä¸åŒçš„ä¸»æœºåæ¥æŸ¥è¯¢å…¶å¯¹åº”çš„IPåœ°å€ï¼Œä»è€Œè·å–ç›®æ ‡ç½‘ç»œä¸­çš„æ½œåœ¨ç›®æ ‡ã€‚

åå‘æš´åŠ›ç ´è§£çš„è¿‡ç¨‹é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

1. æ”¶é›†ç›®æ ‡ç½‘ç»œçš„åŸŸåä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸»æœºåã€å­åŸŸåç­‰ã€‚
2. æ„å»ºä¸€ä¸ªä¸»æœºåå­—å…¸ï¼ŒåŒ…å«å¯èƒ½å­˜åœ¨çš„ä¸»æœºåã€‚
3. ä½¿ç”¨å­—å…¸ä¸­çš„ä¸»æœºåé€ä¸ªè¿›è¡ŒDNSæŸ¥è¯¢ï¼Œè·å–å…¶å¯¹åº”çš„IPåœ°å€ã€‚
4. åˆ†ææŸ¥è¯¢ç»“æœï¼Œè¯†åˆ«å‡ºç›®æ ‡ç½‘ç»œä¸­çš„æ½œåœ¨ç›®æ ‡ã€‚

åå‘æš´åŠ›ç ´è§£çš„å…³é”®åœ¨äºæ„å»ºä¸€ä¸ªæœ‰æ•ˆçš„ä¸»æœºåå­—å…¸ã€‚è¿™å¯ä»¥é€šè¿‡æ”¶é›†ç›®æ ‡ç½‘ç»œçš„å…¬å¼€ä¿¡æ¯ã€ä½¿ç”¨å¸¸è§çš„ä¸»æœºåç”Ÿæˆè§„åˆ™ã€ä»¥åŠä½¿ç”¨å­—å…¸ç”Ÿæˆå·¥å…·ç­‰æ–¹å¼æ¥å®ç°ã€‚åŒæ—¶ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œå¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹æˆ–å¹¶è¡ŒæŸ¥è¯¢çš„æ–¹å¼è¿›è¡ŒDNSæŸ¥è¯¢ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿›è¡Œåå‘æš´åŠ›ç ´è§£æ—¶ï¼Œåº”éµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œå¹¶è·å¾—åˆæ³•çš„æˆæƒã€‚å¦åˆ™ï¼Œè¿™ç§è¡Œä¸ºå°†è¢«è§†ä¸ºéæ³•å…¥ä¾µï¼Œå¹¶å¯èƒ½å¯¼è‡´ä¸¥é‡çš„æ³•å¾‹åæœã€‚
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
å¦‚æœæ‚¨èƒ½æ‰¾åˆ°è§£æä¸ºå†…éƒ¨IPåœ°å€çš„å­åŸŸåï¼Œåº”å°è¯•å¯¹è¯¥IPèŒƒå›´çš„NSæ‰§è¡Œåå‘DNSæš´åŠ›ç ´è§£ã€‚
{% endhint %}

å¦ä¸€ä¸ªå·¥å…·å¯ä»¥å®ç°è¿™ä¸€ç‚¹ï¼š[https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

æ‚¨å¯ä»¥æŸ¥è¯¢åå‘IPèŒƒå›´åˆ°[https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns)ï¼ˆè¯¥å·¥å…·åœ¨BGPæ–¹é¢ä¹Ÿå¾ˆæœ‰å¸®åŠ©ï¼‰ã€‚

### DNS - å­åŸŸåæš´åŠ›ç ´è§£
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### Active Directory æœåŠ¡å™¨

Active Directoryï¼ˆADï¼‰æ˜¯ä¸€ç§ç”±å¾®è½¯å¼€å‘çš„ç›®å½•æœåŠ¡ï¼Œç”¨äºåœ¨ç½‘ç»œç¯å¢ƒä¸­ç®¡ç†å’Œç»„ç»‡ç”¨æˆ·ã€è®¡ç®—æœºå’Œå…¶ä»–ç½‘ç»œèµ„æºã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯¹Active DirectoryæœåŠ¡å™¨è¿›è¡Œæµ‹è¯•æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬å­˜å‚¨äº†å…³é”®çš„èº«ä»½éªŒè¯å’Œæˆæƒä¿¡æ¯ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›æ¸—é€æµ‹è¯•ä¸­å¸¸è§çš„Active DirectoryæœåŠ¡å™¨æµ‹è¯•æŠ€æœ¯ï¼š

#### 1. DNSæ¬ºéª—

DNSæ¬ºéª—æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œé€šè¿‡ç¯¡æ”¹DNSå“åº”æ¥æ¬ºéª—ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™æˆ–æœåŠ¡å™¨ã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨DNSæ¬ºéª—æ¥åŠ«æŒActive DirectoryæœåŠ¡å™¨çš„DNSæŸ¥è¯¢ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚

#### 2. ç”¨æˆ·æšä¸¾

ç”¨æˆ·æšä¸¾æ˜¯ä¸€ç§é€šè¿‡æŸ¥è¯¢Active DirectoryæœåŠ¡å™¨æ¥è·å–ç”¨æˆ·ä¿¡æ¯çš„æŠ€æœ¯ã€‚æ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥ä½¿ç”¨ç”¨æˆ·æšä¸¾æŠ€æœ¯æ¥å‘ç°æœ‰æ•ˆçš„ç”¨æˆ·åï¼Œä»¥ä¾¿è¿›è¡Œåç»­çš„æ”»å‡»ï¼Œå¦‚å¯†ç ç ´è§£æˆ–é’“é±¼æ”»å‡»ã€‚

#### 3. å¯†ç ç ´è§£

å¯†ç ç ´è§£æ˜¯ä¸€ç§é€šè¿‡å°è¯•ä¸åŒçš„å¯†ç ç»„åˆæ¥è·å–ç”¨æˆ·å‡­æ®çš„æŠ€æœ¯ã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¯†ç ç ´è§£æŠ€æœ¯æ¥æµ‹è¯•Active DirectoryæœåŠ¡å™¨ä¸Šçš„å¼±å¯†ç ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æå‡æ”»å‡»æƒé™ã€‚

#### 4. Kerberosæ”»å‡»

Kerberosæ˜¯ä¸€ç§ç½‘ç»œèº«ä»½éªŒè¯åè®®ï¼Œå¸¸ç”¨äºWindowsåŸŸç¯å¢ƒä¸­çš„èº«ä»½éªŒè¯ã€‚æ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥ä½¿ç”¨Kerberosæ”»å‡»æŠ€æœ¯æ¥è·å–æœ‰æ•ˆçš„Kerberosç¥¨æ®ï¼Œä»è€Œè·å–å¯¹Active DirectoryæœåŠ¡å™¨çš„è®¿é—®æƒé™ã€‚

#### 5. åŸŸææƒ

åŸŸææƒæ˜¯ä¸€ç§é€šè¿‡åˆ©ç”¨Active DirectoryæœåŠ¡å™¨ä¸­çš„æ¼æ´æˆ–é…ç½®é”™è¯¯æ¥æå‡æ”»å‡»è€…åœ¨åŸŸä¸­çš„æƒé™çš„æŠ€æœ¯ã€‚æ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥ä½¿ç”¨åŸŸææƒæŠ€æœ¯æ¥è·å–æ›´é«˜çš„æƒé™ï¼Œå¹¶è¿›ä¸€æ­¥æ¢ç´¢å’Œæ”»å‡»Active DirectoryæœåŠ¡å™¨ã€‚

åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯¹Active DirectoryæœåŠ¡å™¨è¿›è¡Œå…¨é¢çš„æµ‹è¯•æ˜¯è‡³å…³é‡è¦çš„ï¼Œä»¥å‘ç°æ½œåœ¨çš„å®‰å…¨æ¼æ´å¹¶æä¾›ç›¸åº”çš„ä¿®å¤å»ºè®®ã€‚
```bash
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com

nslookup -type=srv _kerberos._tcp.<CLIENT_DOMAIN>
nslookup -type=srv _kerberos._tcp.domain.com

nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec

DNSSecï¼ˆDomain Name System Security Extensionsï¼‰æ˜¯ä¸€ç§ç”¨äºå¢å¼ºDNSå®‰å…¨æ€§çš„æ‰©å±•åè®®ã€‚å®ƒé€šè¿‡æ•°å­—ç­¾åå’ŒéªŒè¯DNSæ•°æ®çš„å®Œæ•´æ€§ï¼Œé˜²æ­¢DNSåŠ«æŒå’Œæ¬ºéª—æ”»å‡»ã€‚

DNSSecçš„å·¥ä½œåŸç†æ˜¯åœ¨DNSå±‚çº§ä¸­å¼•å…¥å…¬é’¥åŠ å¯†å’Œæ•°å­—ç­¾åæœºåˆ¶ã€‚å½“å®¢æˆ·ç«¯å‘DNSæœåŠ¡å™¨å‘é€æŸ¥è¯¢è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ç»è¿‡æ•°å­—ç­¾åçš„å“åº”ã€‚å®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥éªŒè¯å“åº”çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚

DNSSecçš„éƒ¨ç½²å¯ä»¥æä¾›ä»¥ä¸‹å®‰å…¨ä¿æŠ¤ï¼š

- æ•°æ®å®Œæ•´æ€§éªŒè¯ï¼šDNSSecå¯ä»¥ç¡®ä¿DNSæ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹æˆ–ä¿®æ”¹ã€‚
- é˜²æ­¢DNSåŠ«æŒï¼šDNSSecå¯ä»¥é˜²æ­¢æ”»å‡»è€…ç¯¡æ”¹DNSå“åº”ï¼Œå°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™ã€‚
- é˜²æ­¢æ¬ºéª—æ”»å‡»ï¼šDNSSecå¯ä»¥é˜²æ­¢æ”»å‡»è€…ä¼ªé€ DNSå“åº”ï¼Œæ¬ºéª—ç”¨æˆ·è®¿é—®æ¶æ„æœåŠ¡å™¨ã€‚

ç„¶è€Œï¼Œå°½ç®¡DNSSecæä¾›äº†æ›´é«˜çš„å®‰å…¨æ€§ï¼Œä½†å®ƒå¹¶ä¸æ˜¯æ™®ééƒ¨ç½²çš„ã€‚è®¸å¤šåŸŸåæ³¨å†Œå•†å’ŒDNSæœåŠ¡å™¨ä»ç„¶æ²¡æœ‰å¯ç”¨DNSSecã€‚å› æ­¤ï¼Œåœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œä»ç„¶éœ€è¦è€ƒè™‘å¯èƒ½å­˜åœ¨çš„DNSå®‰å…¨æ¼æ´ã€‚
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

ä½¿ç”¨"AAAA"è¯·æ±‚è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œä»¥æ”¶é›†å­åŸŸåçš„IPv6åœ°å€ã€‚
```bash
dnsdict6 -s -t <domain>
```
# IPv6åœ°å€çš„åå‘DNSæš´åŠ›ç ´è§£

åœ¨è¿›è¡Œç½‘ç»œæœåŠ¡æ¸—é€æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è·å–ç›®æ ‡ä¸»æœºçš„è¯¦ç»†ä¿¡æ¯ã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯æ˜¯ç›®æ ‡ä¸»æœºçš„DNSè®°å½•ï¼Œå®ƒå¯ä»¥æä¾›æœ‰å…³ä¸»æœºçš„å…³é”®ä¿¡æ¯ï¼Œå¦‚ä¸»æœºåå’ŒIPåœ°å€ã€‚

åœ¨IPv6ç½‘ç»œä¸­ï¼Œæ¯ä¸ªä¸»æœºéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPv6åœ°å€ã€‚ä¸ºäº†è·å–ç›®æ ‡ä¸»æœºçš„DNSè®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå‘DNSæŸ¥è¯¢ã€‚åå‘DNSæŸ¥è¯¢å…è®¸æˆ‘ä»¬é€šè¿‡IPåœ°å€æŸ¥æ‰¾ä¸ä¹‹å…³è”çš„ä¸»æœºåã€‚

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›®æ ‡ä¸»æœºçš„DNSè®°å½•å¯èƒ½æ²¡æœ‰å…¬å¼€çš„ä¸»æœºåã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£æŠ€æœ¯æ¥å°è¯•çŒœæµ‹ä¸»æœºåã€‚æš´åŠ›ç ´è§£æ˜¯ä¸€ç§é€šè¿‡å°è¯•æ‰€æœ‰å¯èƒ½çš„ç»„åˆæ¥çŒœæµ‹ç›®æ ‡å€¼çš„æ–¹æ³•ã€‚

å¯¹äºIPv6åœ°å€çš„åå‘DNSæš´åŠ›ç ´è§£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·ï¼Œå¦‚`dnsrecon`æˆ–`dnsenum`ã€‚è¿™äº›å·¥å…·å¯ä»¥è‡ªåŠ¨åŒ–åœ°è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œå¹¶å°è¯•çŒœæµ‹ä¸ç›®æ ‡IPv6åœ°å€å…³è”çš„ä¸»æœºåã€‚

ä½¿ç”¨è¿™äº›å·¥å…·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå­—å…¸æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å¯èƒ½çš„ä¸»æœºååˆ—è¡¨ã€‚å·¥å…·å°†ä½¿ç”¨å­—å…¸ä¸­çš„æ¯ä¸ªä¸»æœºåå°è¯•è¿›è¡Œåå‘DNSæŸ¥è¯¢ï¼Œä»¥æŸ¥æ‰¾ä¸ç›®æ ‡IPv6åœ°å€å…³è”çš„ä¸»æœºåã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåå‘DNSæš´åŠ›ç ´è§£å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¹ç›®æ ‡ç½‘ç»œé€ æˆä¸å¿…è¦çš„è´Ÿè½½ã€‚å› æ­¤ï¼Œåœ¨è¿›è¡Œæ­¤ç±»æ´»åŠ¨æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å§‹ç»ˆéµå®ˆæ³•å¾‹å’Œé“å¾·å‡†åˆ™ï¼Œå¹¶è·å¾—é€‚å½“çš„æˆæƒã€‚

æ€»ç»“ï¼šIPv6åœ°å€çš„åå‘DNSæš´åŠ›ç ´è§£æ˜¯ä¸€ç§è·å–ç›®æ ‡ä¸»æœºè¯¦ç»†ä¿¡æ¯çš„æ–¹æ³•ã€‚é€šè¿‡ä½¿ç”¨å·¥å…·å’Œå­—å…¸æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•çŒœæµ‹ä¸ç›®æ ‡IPv6åœ°å€å…³è”çš„ä¸»æœºåã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åº”è¯¥è°¨æ…ä½¿ç”¨æ­¤æŠ€æœ¯ï¼Œå¹¶éµå®ˆæ³•å¾‹å’Œé“å¾·å‡†åˆ™ã€‚
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNSé€’å½’DDoS

å¦‚æœ**å¯ç”¨äº†DNSé€’å½’**ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¼ªé€ UDPæ•°æ®åŒ…çš„**æºåœ°å€**ï¼Œä½¿DNSå°†å“åº”å‘é€åˆ°å—å®³æœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯ä»¥æ»¥ç”¨**ANY**æˆ–**DNSSEC**è®°å½•ç±»å‹ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸å…·æœ‰æ›´å¤§çš„å“åº”ã€‚\
æ£€æŸ¥DNSæ˜¯å¦æ”¯æŒé€’å½’çš„æ–¹æ³•æ˜¯æŸ¥è¯¢ä¸€ä¸ªåŸŸåï¼Œå¹¶**æ£€æŸ¥**å“åº”ä¸­æ˜¯å¦åŒ…å«**"ra"æ ‡å¿—**ï¼ˆ_é€’å½’å¯ç”¨_ï¼‰ï¼š
```bash
dig google.com A @<IP>
```
**ä¸å¯ç”¨**ï¼š

![](<../.gitbook/assets/image (275).png>)

**å¯ç”¨**ï¼š

![](<../.gitbook/assets/image (276).png>)

<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conferenceæ˜¯ä¸€åœºå›½é™…ç½‘ç»œå®‰å…¨æ´»åŠ¨**](https://www.dragonjarcon.org/)ï¼Œå·²ç»ä¸¾åŠäº†åå¤šå¹´ï¼Œå°†äº2023å¹´9æœˆ7æ—¥è‡³8æ—¥åœ¨å“¥ä¼¦æ¯”äºšæ³¢å“¥å¤§ä¸¾è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„æŠ€æœ¯æ´»åŠ¨ï¼Œå±•ç¤ºäº†æœ€æ–°çš„è¥¿ç­ç‰™è¯­ç ”ç©¶æˆæœï¼Œå¸å¼•äº†æ¥è‡ªä¸–ç•Œå„åœ°çš„é»‘å®¢å’Œç ”ç©¶äººå‘˜ã€‚\
ç«‹å³åœ¨ä»¥ä¸‹é“¾æ¥æ³¨å†Œï¼Œä¸è¦é”™è¿‡è¿™ä¸ªé‡è¦çš„ä¼šè®®ï¼:

{% embed url="https://www.dragonjarcon.org/" %}

### å‘é€é‚®ä»¶åˆ°ä¸å­˜åœ¨çš„è´¦æˆ·

æ¥è‡ªä¹¦ç±ï¼šã€Šç½‘ç»œå®‰å…¨è¯„ä¼°ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ã€‹

åªéœ€å‘ç›®æ ‡åŸŸå‘é€ä¸€å°é‚®ä»¶åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„åœ°å€ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡_ä¸å¯æŠ•é€’é€šçŸ¥_ï¼ˆNDNï¼‰æ­ç¤ºæœ‰ç”¨çš„å†…éƒ¨ç½‘ç»œä¿¡æ¯ã€‚
```
Generating server: noa.nintendo.com

blah@nintendo.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from ONERDEDGE02.one.nintendo.com (10.13.20.35) by
onerdexch08.one.nintendo.com (10.13.30.39) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Sat, 26 Apr 2014 16:52:22 -0700
Received: from barracuda.noa.nintendo.com (205.166.76.35) by
ONERDEDGE02.one.nintendo.com (10.13.20.35) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Sat, 26 Apr 2014 16:51:22 -0700
X-ASG-Debug-ID: 1398556333-0614671716199b0d0001-zOQ9WJ
Received: from gateway05.websitewelcome.com (gateway05.websitewelcome.com  [69.93.154.37]) by
barracuda.noa.nintendo.com with ESMTP id xVNPkwaqGgdyH5Ag for <blah@nintendo.com>; Sat,
26 Apr 2014 16:52:13 -0700 (PDT)
X-Barracuda-Envelope-From: chris@example.org
X-Barracuda-Apparent-Source-IP: 69.93.154.37
```
ä»¥ä¸‹æ˜¯æ­¤è®°å½•ä¸­æœ‰ç”¨çš„æ•°æ®ï¼š

* å†…éƒ¨ä¸»æœºåã€IPåœ°å€å’Œå­åŸŸå¸ƒå±€
* é‚®ä»¶æœåŠ¡å™¨æ­£åœ¨è¿è¡ŒMicrosoft Exchange Server 2010 SP3
* ä½¿ç”¨Barracuda Networksè®¾å¤‡è¿›è¡Œå†…å®¹è¿‡æ»¤

## é…ç½®æ–‡ä»¶
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
é…ç½®BindæœåŠ¡å™¨æ—¶çš„å±é™©è®¾ç½®ï¼š

| **é€‰é¡¹**           | **æè¿°**                                                                 |
| ----------------- | ----------------------------------------------------------------------- |
| `allow-query`     | å®šä¹‰å…è®¸å‘DNSæœåŠ¡å™¨å‘é€è¯·æ±‚çš„ä¸»æœºã€‚                                      |
| `allow-recursion` | å®šä¹‰å…è®¸å‘DNSæœåŠ¡å™¨å‘é€é€’å½’è¯·æ±‚çš„ä¸»æœºã€‚                                  |
| `allow-transfer`  | å®šä¹‰å…è®¸ä»DNSæœåŠ¡å™¨æ¥æ”¶åŒºåŸŸä¼ è¾“çš„ä¸»æœºã€‚                                  |
| `zone-statistics` | æ”¶é›†åŒºåŸŸçš„ç»Ÿè®¡æ•°æ®ã€‚                                                     |

## HackTricksè‡ªåŠ¨å‘½ä»¤
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conferenceæ˜¯ä¸€åœºå›½é™…ç½‘ç»œå®‰å…¨æ´»åŠ¨**](https://www.dragonjarcon.org/)ï¼Œå°†äº2023å¹´9æœˆ7æ—¥è‡³8æ—¥åœ¨å“¥ä¼¦æ¯”äºšæ³¢å“¥å¤§ä¸¾è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„æŠ€æœ¯æ´»åŠ¨ï¼Œå±•ç¤ºäº†æœ€æ–°çš„è¥¿ç­ç‰™è¯­ç ”ç©¶æˆæœï¼Œå¸å¼•äº†æ¥è‡ªä¸–ç•Œå„åœ°çš„é»‘å®¢å’Œç ”ç©¶äººå‘˜ã€‚\
ç«‹å³åœ¨ä»¥ä¸‹é“¾æ¥æ³¨å†Œï¼Œä¸è¦é”™è¿‡è¿™ä¸ªé‡è¦çš„ä¼šè®®ï¼:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
