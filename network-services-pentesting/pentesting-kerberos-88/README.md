# 88tcp/udp - Testowanie penetracyjne Kerberosa

<details>

<summary><strong>Zacznij od zera i staÅ„ siÄ™ ekspertem od hakowania AWS dziÄ™ki</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## Podstawowe informacje

**Kerberos** dziaÅ‚a na zasadzie uwierzytelniania uÅ¼ytkownikÃ³w bez bezpoÅ›redniego zarzÄ…dzania ich dostÄ™pem do zasobÃ³w. Jest to istotna rÃ³Å¼nica, poniewaÅ¼ podkreÅ›la rolÄ™ protokoÅ‚u w ramach struktur zabezpieczeÅ„.

W Å›rodowiskach takich jak **Active Directory**, **Kerberos** odgrywa kluczowÄ… rolÄ™ w potwierdzaniu toÅ¼samoÅ›ci uÅ¼ytkownikÃ³w poprzez walidacjÄ™ ich tajnych haseÅ‚. Ten proces zapewnia, Å¼e toÅ¼samoÅ›Ä‡ kaÅ¼dego uÅ¼ytkownika jest potwierdzona przed interakcjÄ… z zasobami sieciowymi. Jednak **Kerberos** nie rozszerza swojej funkcjonalnoÅ›ci do oceny ani egzekwowania uprawnieÅ„ uÅ¼ytkownika do konkretnych zasobÃ³w lub usÅ‚ug. Zamiast tego zapewnia bezpieczny sposÃ³b uwierzytelniania uÅ¼ytkownikÃ³w, co stanowi kluczowy pierwszy krok w procesie zabezpieczania.

Po uwierzytelnieniu przez **Kerberosa**, proces podejmowania decyzji dotyczÄ…cych dostÄ™pu do zasobÃ³w jest delegowany do poszczegÃ³lnych usÅ‚ug w sieci. To wÅ‚aÅ›nie te usÅ‚ugi sÄ… odpowiedzialne za ocenÄ™ praw i uprawnieÅ„ uwierzytelnionego uÅ¼ytkownika na podstawie informacji dostarczonych przez **Kerberosa** dotyczÄ…cych uprawnieÅ„ uÅ¼ytkownika. Ten projekt pozwala na rozdzielenie kwestii uwierzytelniania toÅ¼samoÅ›ci uÅ¼ytkownikÃ³w i zarzÄ…dzania ich prawami dostÄ™pu, umoÅ¼liwiajÄ…c bardziej elastyczne i bezpieczne podejÅ›cie do zarzÄ…dzania zasobami w sieciach rozproszonych.

**DomyÅ›lny port:** 88/tcp/udp
```
PORT   STATE SERVICE
88/tcp open  kerberos-sec
```
### **Aby nauczyÄ‡ siÄ™ naduÅ¼ywaÄ‡ Kerberos, powinieneÅ› przeczytaÄ‡ post na temat** [**Active Directory**](../../windows-hardening/active-directory-methodology/)**.**

## WiÄ™cej

### Shodan

* `port:88 kerberos`

### MS14-068

Wada MS14-068 pozwala atakujÄ…cemu manipulowaÄ‡ prawidÅ‚owym tokenem logowania Kerberos uÅ¼ytkownika, aby faÅ‚szywie twierdziÄ‡ o podwyÅ¼szonych uprawnieniach, takich jak bycie Adminem domeny. To faÅ‚szywe twierdzenie jest bÅ‚Ä™dnie zweryfikowane przez kontroler domeny, umoÅ¼liwiajÄ…c nieautoryzowany dostÄ™p do zasobÃ³w sieciowych w caÅ‚ym lesie Active Directory.

{% embed url="https://adsecurity.org/?p=541" %}

Inne wykorzystania: [https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek](https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek)

## HackTricks Automatyczne Komendy
```
Protocol_Name: Kerberos    #Protocol Abbreviation if there is one.
Port_Number:  88   #Comma separated if there is more than one.
Protocol_Description: AD Domain Authentication         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Kerberos
Note: |
Kerberos operates on a principle where it authenticates users without directly managing their access to resources. This is an important distinction because it underlines the protocol's role in security frameworks.
In environments like **Active Directory**, Kerberos is instrumental in establishing the identity of users by validating their secret passwords. This process ensures that each user's identity is confirmed before they interact with network resources. However, Kerberos does not extend its functionality to evaluate or enforce the permissions a user has over specific resources or services. Instead, it provides a secure way of authenticating users, which is a critical first step in the security process.

https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88

Entry_2:
Name: Pre-Creds
Description: Brute Force to get Usernames
Command: nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm="{Domain_Name}",userdb={Big_Userlist} {IP}

Entry_3:
Name: With Usernames
Description: Brute Force with Usernames and Passwords
Note: consider git clone https://github.com/ropnop/kerbrute.git ./kerbrute -h

Entry_4:
Name: With Creds
Description: Attempt to get a list of user service principal names
Command: GetUserSPNs.py -request -dc-ip {IP} active.htb/svc_tgs
```
<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF** sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na githubie.

</details>
