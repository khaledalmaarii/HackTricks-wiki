<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [dÃ©pÃ´t hacktricks](https://github.com/carlospolop/hacktricks) et au [dÃ©pÃ´t hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


Sur Linux, **les tickets sont stockÃ©s dans des caches d'informations d'identification ou ccaches**. Il existe 3 types principaux, qui indiquent oÃ¹ **les tickets peuvent Ãªtre trouvÃ©s :**

* **Fichiers**, par dÃ©faut sous le rÃ©pertoire **/tmp**, sous la forme de **krb5cc\_%{uid}.**
* **Keyrings du noyau**, un espace spÃ©cial dans le noyau Linux fourni pour stocker les clÃ©s.
* **MÃ©moire de processus**, utilisÃ©e lorsqu'un seul processus a besoin d'utiliser les tickets.

Pour vÃ©rifier le type de stockage utilisÃ© dans une machine spÃ©cifique, la variable _**default\_ccache\_name**_** ** doit Ãªtre vÃ©rifiÃ©e dans le fichier **/etc/krb5.conf**, qui a par dÃ©faut une permission de lecture pour n'importe quel utilisateur. Dans le cas oÃ¹ ce paramÃ¨tre est manquant, sa valeur par dÃ©faut est _FILE:/tmp/krb5cc\_%{uid}_.

Afin d'extraire **les tickets des 2 autres sources** (keyrings et processus), un excellent document, [**Kerberos Credential Thievery (GNU/Linux)**](https://www.delaat.net/rp/2016-2017/p97/report.pdf), publiÃ© en 2017, explique les moyens de rÃ©cupÃ©rer les tickets Ã  partir de ceux-ci.

### Keyring - Ã€ partir du document

> Le **noyau Linux** dispose d'une fonctionnalitÃ© appelÃ©e **keyrings**. Il s'agit d'une **zone de mÃ©moire rÃ©sidant** dans le noyau qui est utilisÃ©e pour **gÃ©rer et conserver les clÃ©s**.
>
> L'appel systÃ¨me **keyctl** a Ã©tÃ© introduit dans la version du noyau 2.6.10 5. Cela fournit aux **applications de l'espace utilisateur une API** qui peut Ãªtre utilisÃ©e pour interagir avec les keyrings du noyau.

> Le **nom du keyring** en cours d'utilisation peut Ãªtre analysÃ© Ã  partir du **fichier de configuration Kerberos /etc/krb5.conf** qui a une permission de lecture activÃ©e pour tout le monde (octal 644) par dÃ©faut. Un attaquant peut alors utiliser cette information pour **rechercher un ticket** 11 contenant des keyrings et extraire les tickets. Un script de preuve de concept qui implÃ©mente cette fonctionnalitÃ© peut Ãªtre vu dans la section A.2 **(hercules.sh)**. Dans un keyring, le ccache est stockÃ© sous forme de composants. Comme on peut le voir sur la figure 2, un ccache de fichier est composÃ© de 3 composants distincts : en-tÃªte, principal par dÃ©faut et une sÃ©quence de justificatifs. Un **keyring contient le principal par dÃ©faut et les justificatifs**. Ce script va dÃ©verser ces composants dans des fichiers sÃ©parÃ©s. Ensuite, en utilisant un **en-tÃªte synthÃ©tisÃ© par l'attaquant**, ces piÃ¨ces sont combinÃ©es dans le bon ordre pour **reconstruire un ccache de fichier**. Ce fichier reconstruit peut ensuite Ãªtre exfiltrÃ© vers une machine d'attaquant et utilisÃ© pour se faire passer pour un utilisateur Kerberos. Un programme simple pour gÃ©nÃ©rer un en-tÃªte de ccache valide peut Ãªtre vu dans la section A.3.

BasÃ© sur le script **heracles.sh** (du document), un outil C que vous pouvez utiliser (crÃ©Ã© par l'auteur de l'article complet) est [**tickey**](https://github.com/TarlogicSecurity/tickey)**, et il extrait les tickets des keyrings :**
```
/tmp/tickey -i
```
**Cette information a Ã©tÃ© extraite de:** [**https://www.tarlogic.com/en/blog/how-to-attack-kerberos/**](https://www.tarlogic.com/en/blog/how-to-attack-kerberos/)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©**? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks**? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
