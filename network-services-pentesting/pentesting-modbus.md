<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>


# Podstawowe informacje

W 1979 roku opracowano **Protok贸 Modbus** przez Modicon, su偶cy jako struktura komunikacyjna. Jego g贸wne zastosowanie polega na uatwianiu komunikacji midzy inteligentnymi urzdzeniami, dziaajcymi w modelu master-slave/client-server. Ten protok贸 odgrywa kluczow rol w umo偶liwianiu urzdzeniom efektywnej wymiany danych.

**Domylny port:** 502
```
PORT    STATE SERVICE
502/tcp open  modbus
```
# Wyliczanie

## Modbus

Modbus jest protokoem komunikacyjnym wykorzystywanym g贸wnie w przemysowych systemach automatyzacji. Protok贸 ten jest oparty na architekturze klient-serwer i umo偶liwia komunikacj midzy urzdzeniami sieciowymi poprzez port szeregowy lub TCP/IP.

### Skanowanie port贸w

Aby rozpocz proces wyliczania usug Modbus, nale偶y najpierw zeskanowa porty hosta docelowego. Mo偶na to zrobi za pomoc narzdzi takich jak Nmap lub Masscan. Poni偶ej przedstawiono przykadow komend Nmap do skanowania port贸w Modbus:

```plaintext
nmap -p 502 --script modbus-discover <adres_IP>
```

### Wykrywanie urzdze Modbus

Po zeskanowaniu port贸w mo偶na u偶y narzdzi takich jak `modscan` lub `modbus-cli` do wykrywania urzdze Modbus i ich funkcji. Poni偶ej przedstawiono przykadow komend `modscan`:

```plaintext
modscan.py -a <adres_IP> -p 502
```

### Analiza ruchu Modbus

Aby zrozumie, jakie komendy s wysyane midzy klientem a serwerem Modbus, mo偶na u偶y narzdzi do analizy ruchu sieciowego, takich jak Wireshark. Nale偶y skonfigurowa Wireshark do nasuchiwania ruchu na odpowiednim interfejsie sieciowym i filtrowania pakiet贸w Modbus.

## DNP3

DNP3 (Distributed Network Protocol 3) jest protokoem komunikacyjnym stosowanym w systemach monitorowania i kontroli w sektorze energetycznym. Protok贸 ten jest oparty na architekturze klient-serwer i wykorzystuje protok贸 transportowy TCP/IP.

### Skanowanie port贸w

Podobnie jak w przypadku Modbus, nale偶y rozpocz proces wyliczania usug DNP3 od zeskanowania port贸w hosta docelowego. Mo偶na to zrobi za pomoc narzdzi takich jak Nmap lub Masscan. Poni偶ej przedstawiono przykadow komend Nmap do skanowania port贸w DNP3:

```plaintext
nmap -p 20000 --script dnp3-enumeration <adres_IP>
```

### Wykrywanie urzdze DNP3

Po zeskanowaniu port贸w mo偶na u偶y narzdzi takich jak `dnp3-toolkit` do wykrywania urzdze DNP3 i ich funkcji. Poni偶ej przedstawiono przykadow komend `dnp3-toolkit`:

```plaintext
dnp3-toolkit -a <adres_IP> -p 20000
```

### Analiza ruchu DNP3

Podobnie jak w przypadku Modbus, mo偶na u偶y narzdzi do analizy ruchu sieciowego, takich jak Wireshark, do zrozumienia komunikacji midzy klientem a serwerem DNP3. Nale偶y skonfigurowa Wireshark do nasuchiwania ruchu na odpowiednim interfejsie sieciowym i filtrowania pakiet贸w DNP3.
```bash
nmap --script modbus-discover -p 502 <IP>
msf> use auxiliary/scanner/scada/modbusdetect
msf> use auxiliary/scanner/scada/modbus_findunitid
```
<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
