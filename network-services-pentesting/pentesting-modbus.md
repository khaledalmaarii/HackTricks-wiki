<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# åŸºæœ¬ä¿¡æ¯

Modbusåè®®æ˜¯ç”±Modiconäº1979å¹´å¼€å‘çš„ä¸€ç§æ¶ˆæ¯ç»“æ„ã€‚å®ƒç”¨äºåœ¨æ™ºèƒ½è®¾å¤‡ä¹‹é—´å»ºç«‹ä¸»ä»/å®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡ã€‚

**é»˜è®¤ç«¯å£ï¼š**502
```
PORT    STATE SERVICE
502/tcp open  modbus
```
# æšä¸¾

## Modbus Enumeration

## Modbus æšä¸¾

Modbus is a widely used protocol in industrial control systems (ICS) and is often used to communicate with programmable logic controllers (PLCs). In order to effectively pentest a Modbus network, it is important to first enumerate the devices and services running on the network.

Modbus æ˜¯å·¥ä¸šæ§åˆ¶ç³»ç»Ÿ (ICS) ä¸­å¹¿æ³›ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸ç”¨äºä¸å¯ç¼–ç¨‹é€»è¾‘æ§åˆ¶å™¨ (PLC) è¿›è¡Œé€šä¿¡ã€‚ä¸ºäº†æœ‰æ•ˆåœ°å¯¹ Modbus ç½‘ç»œè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œé¦–å…ˆéœ€è¦æšä¸¾ç½‘ç»œä¸Šè¿è¡Œçš„è®¾å¤‡å’ŒæœåŠ¡ã€‚

### Modbus TCP Enumeration

### Modbus TCP æšä¸¾

To enumerate Modbus devices over TCP, you can use tools like `nmap` or `modscan`. These tools can help you identify the IP addresses and open ports of Modbus devices on the network.

è¦é€šè¿‡ TCP æšä¸¾ Modbus è®¾å¤‡ï¼Œå¯ä»¥ä½¿ç”¨ `nmap` æˆ– `modscan` ç­‰å·¥å…·ã€‚è¿™äº›å·¥å…·å¯ä»¥å¸®åŠ©æ‚¨è¯†åˆ«ç½‘ç»œä¸Š Modbus è®¾å¤‡çš„ IP åœ°å€å’Œå¼€æ”¾ç«¯å£ã€‚

Here is an example command to enumerate Modbus devices using `nmap`:

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `nmap` æšä¸¾ Modbus è®¾å¤‡çš„ç¤ºä¾‹å‘½ä»¤ï¼š

```plaintext
nmap -p 502 --script modbus-discover <target>
```

Replace `<target>` with the IP address or range of IP addresses you want to scan.

å°† `<target>` æ›¿æ¢ä¸ºæ‚¨è¦æ‰«æçš„ IP åœ°å€æˆ– IP åœ°å€èŒƒå›´ã€‚

### Modbus RTU Enumeration

### Modbus RTU æšä¸¾

To enumerate Modbus devices over serial communication (RS-232 or RS-485), you can use tools like `modscan` or `qModMaster`. These tools allow you to scan for Modbus devices connected to the serial ports of your machine.

è¦é€šè¿‡ä¸²è¡Œé€šä¿¡ (RS-232 æˆ– RS-485) æšä¸¾ Modbus è®¾å¤‡ï¼Œå¯ä»¥ä½¿ç”¨ `modscan` æˆ– `qModMaster` ç­‰å·¥å…·ã€‚è¿™äº›å·¥å…·å…è®¸æ‚¨æ‰«æè¿æ¥åˆ°è®¡ç®—æœºä¸²è¡Œç«¯å£çš„ Modbus è®¾å¤‡ã€‚

### Modbus Enumeration Techniques

### Modbus æšä¸¾æŠ€æœ¯

In addition to using specialized tools, there are other techniques you can use to enumerate Modbus devices:

é™¤äº†ä½¿ç”¨ä¸“é—¨çš„å·¥å…·å¤–ï¼Œè¿˜æœ‰å…¶ä»–æŠ€æœ¯å¯ä»¥ç”¨æ¥æšä¸¾ Modbus è®¾å¤‡ï¼š

- **Banner Grabbing**: Modbus devices often have specific banners or responses that can be used to identify them. You can use tools like `telnet` or `nc` to connect to the Modbus device and capture its banner.

- **æ¨ªå¹…æŠ“å–**ï¼šModbus è®¾å¤‡é€šå¸¸å…·æœ‰ç‰¹å®šçš„æ¨ªå¹…æˆ–å“åº”ï¼Œå¯ä»¥ç”¨äºè¯†åˆ«å®ƒä»¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `telnet` æˆ– `nc` ç­‰å·¥å…·è¿æ¥åˆ° Modbus è®¾å¤‡å¹¶æ•è·å…¶æ¨ªå¹…ã€‚

- **Network Scanning**: You can use network scanning tools like `nmap` to scan for Modbus devices on the network. By scanning for open Modbus ports (e.g., port 502 for Modbus TCP), you can identify potential Modbus devices.

- **ç½‘ç»œæ‰«æ**ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ `nmap` ç­‰ç½‘ç»œæ‰«æå·¥å…·æ¥æ‰«æç½‘ç»œä¸Šçš„ Modbus è®¾å¤‡ã€‚é€šè¿‡æ‰«æå¼€æ”¾çš„ Modbus ç«¯å£ (ä¾‹å¦‚ï¼ŒModbus TCP çš„ç«¯å£ 502)ï¼Œå¯ä»¥è¯†åˆ«æ½œåœ¨çš„ Modbus è®¾å¤‡ã€‚

- **Protocol Fuzzing**: Fuzzing is a technique used to send malformed or unexpected data to a target system in order to trigger unexpected behavior. By fuzzing the Modbus protocol, you may discover vulnerabilities or misconfigurations in Modbus devices.

- **åè®®æ¨¡ç³Šæµ‹è¯•**ï¼šæ¨¡ç³Šæµ‹è¯•æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œç”¨äºå‘ç›®æ ‡ç³»ç»Ÿå‘é€æ ¼å¼é”™è¯¯æˆ–æ„å¤–æ•°æ®ï¼Œä»¥è§¦å‘æ„å¤–è¡Œä¸ºã€‚é€šè¿‡å¯¹ Modbus åè®®è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç° Modbus è®¾å¤‡ä¸­çš„æ¼æ´æˆ–é…ç½®é”™è¯¯ã€‚

- **Default Credentials**: Some Modbus devices may have default credentials that can be used to gain unauthorized access. You can search for default credentials for specific Modbus devices online or use tools like `hydra` to perform brute-force attacks.

- **é»˜è®¤å‡­æ®**ï¼šæŸäº› Modbus è®¾å¤‡å¯èƒ½å…·æœ‰é»˜è®¤å‡­æ®ï¼Œå¯ç”¨äºè·å–æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚æ‚¨å¯ä»¥åœ¨çº¿æœç´¢ç‰¹å®š Modbus è®¾å¤‡çš„é»˜è®¤å‡­æ®ï¼Œæˆ–ä½¿ç”¨ `hydra` ç­‰å·¥å…·è¿›è¡Œæš´åŠ›ç ´è§£æ”»å‡»ã€‚

By using a combination of these techniques, you can effectively enumerate Modbus devices and services on a network, which is crucial for a successful Modbus pentest.

é€šè¿‡ç»“åˆä½¿ç”¨è¿™äº›æŠ€æœ¯ï¼Œæ‚¨å¯ä»¥æœ‰æ•ˆåœ°æšä¸¾ç½‘ç»œä¸Šçš„ Modbus è®¾å¤‡å’ŒæœåŠ¡ï¼Œè¿™å¯¹äºæˆåŠŸçš„ Modbus æ¸—é€æµ‹è¯•è‡³å…³é‡è¦ã€‚
```bash
nmap --script modbus-discover -p 502 <IP>
msf> use auxiliary/scanner/scada/modbusdetect
msf> use auxiliary/scanner/scada/modbus_findunitid
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
