# 123/udp - Testowanie penetracyjne NTP

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami nagrÃ³d za bÅ‚Ä™dy!

**SpostrzeÅ¼enia dotyczÄ…ce hakerstwa**\
Zajmuj siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa

**AktualnoÅ›ci na Å¼ywo o hakerstwie**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnym wiadomoÅ›ciom i spostrzeÅ¼eniom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i waÅ¼nymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

## Podstawowe informacje

**ProtokÃ³Å‚ czasu sieciowego (NTP)** zapewnia dokÅ‚adnÄ… synchronizacjÄ™ zegarÃ³w komputerÃ³w i urzÄ…dzeÅ„ sieciowych w zmiennych sieciach opÃ³Åºnienia. Jest to niezbÄ™dne do utrzymania precyzyjnego odmierzania czasu w operacjach IT, bezpieczeÅ„stwie i logowaniu. DokÅ‚adnoÅ›Ä‡ NTP jest istotna, ale moÅ¼e rÃ³wnieÅ¼ stanowiÄ‡ ryzyko dla bezpieczeÅ„stwa, jeÅ›li nie jest odpowiednio zarzÄ…dzana.

### Podsumowanie i wskazÃ³wki dotyczÄ…ce bezpieczeÅ„stwa:
- **Cel**: Synchronizuje zegary urzÄ…dzeÅ„ w sieciach.
- **WaÅ¼noÅ›Ä‡**: Krytyczne dla bezpieczeÅ„stwa, logowania i operacji.
- **Åšrodki bezpieczeÅ„stwa**:
- UÅ¼ywaj zaufanych ÅºrÃ³deÅ‚ NTP z uwierzytelnianiem.
- Ogranicz dostÄ™p do sieci serwera NTP.
- Monitoruj synchronizacjÄ™ w celu wykrycia prÃ³b manipulacji.

**DomyÅ›lny port:** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## Wyliczanie

### NTP (Network Time Protocol)

NTP (Network Time Protocol) jest protokoÅ‚em uÅ¼ywanym do synchronizacji czasu miÄ™dzy systemami komputerowymi w sieci. MoÅ¼e byÄ‡ rÃ³wnieÅ¼ wykorzystywany do przeprowadzania atakÃ³w na infrastrukturÄ™ sieciowÄ…. PoniÅ¼ej przedstawiono kilka technik wyliczania zwiÄ…zanych z NTP.

#### Wyliczanie serwerÃ³w NTP

Aby znaleÅºÄ‡ serwery NTP w sieci, moÅ¼na wykorzystaÄ‡ narzÄ™dzia takie jak `nmap` lub `ntpdate`. Przeskanuj port 123, ktÃ³ry jest domyÅ›lnym portem NTP, aby znaleÅºÄ‡ otwarte serwery NTP.

```plaintext
nmap -p 123 --script ntp-info <adres_IP>
```

#### Wyliczanie informacji o serwerze NTP

Aby uzyskaÄ‡ informacje o serwerze NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdc`. MoÅ¼na to zrobiÄ‡, wykonujÄ…c nastÄ™pujÄ…ce polecenie:

```plaintext
ntpdc -c monlist <adres_IP>
```

#### Wyliczanie synchronizacji czasu

Aby sprawdziÄ‡, czy serwer NTP jest zsynchronizowany z innymi serwerami, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie podatnoÅ›ci

Aby sprawdziÄ‡, czy serwer NTP jest podatny na ataki, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdc`. Wykonaj polecenie:

```plaintext
ntpdc -c reslist <adres_IP>
```

#### Wyliczanie informacji o klientach NTP

Aby uzyskaÄ‡ informacje o klientach NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdc`. Wykonaj polecenie:

```plaintext
ntpdc -c sysinfo <adres_IP>
```

#### Wyliczanie informacji o czasie

Aby uzyskaÄ‡ informacje o czasie na serwerze NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o wersji

Aby uzyskaÄ‡ informacje o wersji serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -V <adres_IP>
```

#### Wyliczanie informacji o trybie

Aby uzyskaÄ‡ informacje o trybie serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o identyfikatorze

Aby uzyskaÄ‡ informacje o identyfikatorze serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych funkcjach

Aby uzyskaÄ‡ informacje o dostÄ™pnych funkcjach serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych trybach

Aby uzyskaÄ‡ informacje o dostÄ™pnych trybach serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych opcjach

Aby uzyskaÄ‡ informacje o dostÄ™pnych opcjach serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych zmiennych

Aby uzyskaÄ‡ informacje o dostÄ™pnych zmiennych serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych trybach zegara

Aby uzyskaÄ‡ informacje o dostÄ™pnych trybach zegara serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych trybach filtra

Aby uzyskaÄ‡ informacje o dostÄ™pnych trybach filtra serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```

#### Wyliczanie informacji o dostÄ™pnych trybach trybu

Aby uzyskaÄ‡ informacje o dostÄ™pnych trybach trybu serwera NTP, moÅ¼na uÅ¼yÄ‡ narzÄ™dzia `ntpdate`. Wykonaj polecenie:

```plaintext
ntpdate -q <adres_IP>
```
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## PrzeglÄ…daj pliki konfiguracyjne

* ntp.conf

## Atak z wykorzystaniem amplifikacji NTP

[**Jak dziaÅ‚a atak DDoS na protokÃ³Å‚ NTP**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

ProtokÃ³Å‚ **NTP**, korzystajÄ…c z UDP, umoÅ¼liwia dziaÅ‚anie bez koniecznoÅ›ci procedur handshake, w przeciwieÅ„stwie do TCP. Ta cecha jest wykorzystywana w **atakach DDoS z wykorzystaniem amplifikacji NTP**. AtakujÄ…cy tworzÄ… pakiety z faÅ‚szywym adresem IP ÅºrÃ³dÅ‚a, sprawiajÄ…c, Å¼e wydaje siÄ™, Å¼e Å¼Ä…dania ataku pochodzÄ… od ofiary. Te poczÄ…tkowo maÅ‚e pakiety skÅ‚aniajÄ… serwer NTP do odpowiedzi o znacznie wiÄ™kszej objÄ™toÅ›ci danych, wzmacniajÄ…c atak.

Polecenie **_MONLIST_**, pomimo rzadkiego uÅ¼ycia, moÅ¼e raportowaÄ‡ ostatnie 600 klientÃ³w podÅ‚Ä…czonych do usÅ‚ugi NTP. ChociaÅ¼ samo polecenie jest proste, jego niewÅ‚aÅ›ciwe uÅ¼ycie w takich atakach ujawnia istotne podatnoÅ›ci zwiÄ…zane z bezpieczeÅ„stwem.
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## Automatyczne polecenia HackTricks
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami bÅ‚Ä™dÃ³w!

**SpostrzeÅ¼enia dotyczÄ…ce hakerstwa**\
Zajmuj siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa.

**AktualnoÅ›ci na Å¼ywo o hakerstwie**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnym wiadomoÅ›ciom i spostrzeÅ¼eniom.

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i waÅ¼nymi aktualizacjami platformy.

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

<details>

<summary><strong>Naucz siÄ™ hakerstwa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
