# 110,995 - Pentesting POP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Trouvez les vuln√©rabilit√©s les plus importantes afin de pouvoir les corriger plus rapidement. Intruder suit votre surface d'attaque, effectue des analyses de menaces proactives, trouve des probl√®mes dans l'ensemble de votre pile technologique, des API aux applications web et aux syst√®mes cloud. [**Essayez-le gratuitement**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) d√®s aujourd'hui.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Informations de base

Le **Protocole de la Poste** (**POP**) est un type de r√©seau informatique et un **protocole** standard d'Internet qui extrait et r√©cup√®re les e-mails √† partir d'un serveur de messagerie distant pour un acc√®s par la machine h√¥te. **POP** est un **protocole** de couche application dans le mod√®le OSI qui permet aux utilisateurs finaux de r√©cup√©rer et recevoir des e-mails (√† partir de [ici](https://www.techopedia.com/definition/5383/post-office-protocol-pop)).

Les clients POP se connectent g√©n√©ralement, r√©cup√®rent tous les messages, les stockent sur le syst√®me client et les suppriment du serveur. Il existe 3 versions de POP, mais POP3 est la plus utilis√©e.

**Ports par d√©faut :** 110, 995(ssl)
```
PORT    STATE SERVICE
110/tcp open  pop3
```
### Capture de banni√®re

La capture de banni√®re est une technique couramment utilis√©e lors de l'√©num√©ration des services POP (Post Office Protocol). Elle consiste √† r√©cup√©rer les informations de la banni√®re du serveur POP afin de d√©terminer la version du logiciel utilis√© et d'identifier d'√©ventuelles vuln√©rabilit√©s connues.

Pour effectuer une capture de banni√®re, vous pouvez utiliser des outils tels que `telnet` ou `nc` (netcat) pour vous connecter au serveur POP sur le port 110. Une fois connect√©, le serveur POP enverra une r√©ponse contenant des informations sur sa version et d'autres d√©tails pertinents.

La capture de banni√®re peut √™tre utile pour identifier les versions obsol√®tes du logiciel POP, qui pourraient √™tre vuln√©rables √† des attaques connues. Cela peut √©galement aider √† d√©terminer si le serveur POP est configur√© de mani√®re s√©curis√©e ou s'il pr√©sente des faiblesses potentielles.

Il est important de noter que la capture de banni√®re doit √™tre effectu√©e de mani√®re l√©gale et dans le cadre d'un test d'intrusion autoris√©. L'utilisation de cette technique sans autorisation appropri√©e peut √™tre consid√©r√©e comme une violation de la loi.
```bash
nc -nv <IP> 110
openssl s_client -connect <IP>:995 -crlf -quiet
```
## Manuel

Vous pouvez utiliser la commande `CAPA` pour obtenir les capacit√©s du serveur POP3.

## Automatis√©
```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
Le plugin `pop3-ntlm-info` renverra des donn√©es "**sensibles**" (versions Windows).

### [Bruteforce POP3](../generic-methodologies-and-resources/brute-force.md#pop)

## Syntaxe POP
```bash
POP commands:
USER uid           Log in as "uid"
PASS password      Substitue "password" for your actual password
STAT               List number of messages, total mailbox size
LIST               List messages and sizes
RETR n             Show message n
DELE n             Mark message n for deletion
RSET               Undo any changes
QUIT               Logout (expunges messages if no RSET)
TOP msg n          Show first n lines of message number msg
CAPA               Get capabilities
```
√Ä partir de [ici](http://sunnyoasis.com/services/emailviatelnet.html)

Exemple :
```
root@kali:~# telnet $ip 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean
+OK
PASS password
+OK Welcome billydean

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: jamesbrown@motown.com
Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
```
## Param√®tres dangereux

Depuis [https://academy.hackthebox.com/module/112/section/1073](https://academy.hackthebox.com/module/112/section/1073)

| **Param√®tre**              | **Description**                                                                           |
| -------------------------  | ----------------------------------------------------------------------------------------- |
| `auth_debug`               | Active tous les journaux de d√©bogage d'authentification.                                   |
| `auth_debug_passwords`     | Ce param√®tre ajuste la verbosit√© des journaux, les mots de passe soumis et le sch√©ma sont enregistr√©s. |
| `auth_verbose`             | Enregistre les tentatives d'authentification infructueuses et leurs raisons.               |
| `auth_verbose_passwords`   | Les mots de passe utilis√©s pour l'authentification sont enregistr√©s et peuvent √©galement √™tre tronqu√©s. |
| `auth_anonymous_username`  | Sp√©cifie le nom d'utilisateur √† utiliser lors de la connexion avec le m√©canisme SASL ANONYMOUS. |

## Commandes automatiques HackTricks
```
Protocol_Name:  POP   #Protocol Abbreviation if there is one.
Port_Number:  110     #Comma separated if there is more than one.
Protocol_Description: Post Office Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for POP
Note: |
Post Office Protocol (POP) is a type of computer networking and Internet standard protocol that extracts and retrieves email from a remote mail server for access by the host machine. POP is an application layer protocol in the OSI model that provides end users the ability to fetch and receive email (from here).
The POP clients generally connect, retrieve all messages, store them on the client system, and delete them from the server. There are 3 versions of POP, but POP3 is the most used one.

https://book.hacktricks.xyz/pentesting/pentesting-whois

Entry_2:
Name: Banner Grab
Description: Banner Grab 110
Command: nc -nv {IP} 110

Entry_3:
Name: Banner Grab 995
Description: Grab Banner Secure
Command: openssl s_client -connect {IP}:995 -crlf -quiet

Entry_4:
Name: Nmap
Description: Scan for POP info
Command: nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 {IP}

Entry_5:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V

Entry_6:
Name: consolesless mfs enumeration
Description: POP3 enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'

```
<details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Trouvez les vuln√©rabilit√©s les plus importantes afin de pouvoir les corriger plus rapidement. Intruder suit votre surface d'attaque, effectue des analyses de menaces proactives, trouve des probl√®mes dans l'ensemble de votre pile technologique, des API aux applications web et aux syst√®mes cloud. [**Essayez-le gratuitement**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) d√®s aujourd'hui.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
