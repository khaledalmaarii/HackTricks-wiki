# Pentesting Imprimantes

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Veuillez noter que **la plupart du contenu de toutes les informations relatives au Pentesting Printers** ont Ã©tÃ© prises **Ã  partir de la recherche Ã©norme et incroyable** que vous pouvez trouver sur [**http://hacking-printers.net/**](http://hacking-printers.net). J'ai essayÃ© de **rÃ©sumer** ces informations ici, mais vous pouvez toujours **aller Ã  la source pour en savoir plus sur le sujet**.

## Fondamentaux

Une relation schÃ©matique concernant l'encapsulation des langages d'imprimante est donnÃ©e ci-dessous :\\

![Encapsulation des langages d'imprimante](http://hacking-printers.net/wiki/images/thumb/1/1d/Protocols.png/500px-Protocols.png)

## Protocoles d'impression rÃ©seau

L'envoi de donnÃ©es Ã  un pÃ©riphÃ©rique d'imprimante peut Ãªtre effectuÃ© par un cÃ¢ble **USB/parallÃ¨le** ou sur un **rÃ©seau**. Ce wiki se concentre sur l'impression en rÃ©seau, mais la plupart des attaques prÃ©sentÃ©es peuvent Ã©galement Ãªtre effectuÃ©es contre des imprimantes locales. Il existe divers protocoles exotiques pour l'impression en rÃ©seau, tels que le [_NCP_](https://en.wikipedia.org/wiki/NetWare_Core_Protocol) de Novell ou [_AppleTalk_](https://en.wikipedia.org/wiki/AppleTalk). Dans le monde Windows, les partages d'imprimantes _SMB/CIFS_ sont devenus assez populaires. De plus, certains pÃ©riphÃ©riques prennent en charge l'impression sur des protocoles gÃ©nÃ©riques tels que les tÃ©lÃ©chargements de fichiers _FTP_ ou _HTTP_. Cependant, les protocoles d'impression rÃ©seau les plus courants pris en charge directement par les imprimantes rÃ©seau sont l'_**LPD**_**, \_IPP**_\*\*, et \*\*_**le port brut 9100** \_ impression. Les protocoles d'impression rÃ©seau peuvent Ãªtre attaquÃ©s directement, par exemple en exploitant un dÃ©bordement de tampon dans le dÃ©mon LPD de l'imprimante. Dans de nombreux scÃ©narios d'attaque, cependant, ils ne servent que de **support/canal** pour **dÃ©ployer un code de langage d'imprimante malveillant**. Notez qu'une **imprimante rÃ©seau prend gÃ©nÃ©ralement en charge plusieurs protocoles pour "imprimer"** un document, ce qui Ã©largit la surface d'attaque.

### **En savoir plus sur** [**le port brut 9100 ici**](../9100-pjl.md)**.**

### **En savoir plus sur** [**LPD dans Pentesting 515 ici**](../515-pentesting-line-printer-daemon-lpd.md)**.**

### **En savoir plus sur** [**IPP dans Pentesting 631 ici**](../pentesting-631-internet-printing-protocol-ipp.md)**.**

## Langages de contrÃ´le d'imprimante

Un langage de contrÃ´le de tÃ¢che gÃ¨re des paramÃ¨tres tels que les bacs de sortie pour la tÃ¢che d'impression en cours. Bien qu'il se situe gÃ©nÃ©ralement en tant que couche facultative entre le protocole d'impression et le langage de description de page, les fonctions peuvent se chevaucher. Des exemples de langages de contrÃ´le de tÃ¢ches spÃ©cifiques au fournisseur sont [CPCA](http://www.undocprint.org/formats/printer\_control\_languages/cpca), [XJCL](http://www.undocprint.org/formats/printer\_control\_languages/xjcl), [EJL](http://www.undocprint.org/formats/printer\_control\_languages/ejl) et **PJL** - qui est pris en charge par une variÃ©tÃ© d'imprimantes et sera discutÃ© ci-dessous. De plus, les **langages de contrÃ´le et de gestion d'imprimante** sont conÃ§us pour **affecter** non seulement une seule tÃ¢che d'impression, mais l'ensemble du **dispositif**. Une approche pour dÃ©finir une norme commune pour cette tÃ¢che Ã©tait [NPAP](http://www.undocprint.org/formats/printer\_control\_languages/npap). Cependant, il ne s'est pas Ã©tabli et n'est pris en charge que par Lexmark. D'autres fabricants d'imprimantes utilisent plutÃ´t SNMP ou son mÃ©talangage **PML** basÃ© sur PJL.

### PJL

Le langage de tÃ¢che d'impression (PJL) a Ã©tÃ© introduit Ã  l'origine par HP, mais est rapidement devenu une norme de facto pour le contrÃ´le des tÃ¢ches d'impression. Â« PJL rÃ©side au-dessus des autres langages d'imprimante Â» et peut Ãªtre utilisÃ© pour changer des paramÃ¨tres tels que le bac Ã  papier ou la taille. Il convient toutefois de souligner que **PJL n'est pas limitÃ© Ã  la tÃ¢che d'impression en cours car certains paramÃ¨tres peuvent Ãªtre rendus permanents**. PJL peut Ã©galement Ãªtre utilisÃ© pour **changer l'affichage de l'imprimante ou lire/Ã©crire des fichiers sur le pÃ©riphÃ©rique**. Il existe de nombreux dialectes car les fournisseurs ont tendance Ã  ne prendre en charge qu'un sous-ensemble des commandes rÃ©pertoriÃ©es dans la rÃ©fÃ©rence PJL et prÃ©fÃ¨rent ajouter des commandes propriÃ©taires. **PJL est Ã©galement utilisÃ© pour dÃ©finir le format de fichier des donnÃ©es d'impression rÃ©elles Ã  suivre**. Sans un tel changement de langage explicite, l'imprimante doit identifier le langage de description de page en fonction des nombres magiques. Les commandes PJL typiques pour dÃ©finir la taille du papier et le nombre de copies avant de passer l'interprÃ©teur en mode PostScript sont prÃ©sentÃ©es ci-dessous :
```
@PJL SET PAPER=A4
@PJL SET COPIES=10
@PJL ENTER LANGUAGE=POSTSCRIPT
```
Ã€ l'intÃ©rieur de la [**page sur le port 9100 'raw port'**](../9100-pjl.md), vous pouvez trouver plus d'informations sur **comment Ã©numÃ©rer PJL**.

### PML

Le **Printer Management Language** (PML) est un langage propriÃ©taire pour contrÃ´ler les **imprimantes HP**. Il **combine** essentiellement les fonctionnalitÃ©s de **SNMP** **avec PJL**. La documentation publiquement disponible n'a pas Ã©tÃ© publiÃ©e, mais des parties de la norme ont Ã©tÃ© divulguÃ©es par le projet [LPRng](https://en.wikipedia.org/wiki/LPRng) : le **Guide de l'utilisateur PJL Passthrough to PML and SNMP** dÃ©finit PML comme un "protocole de gestion d'imprimante Ã  requÃªte-rÃ©ponse orientÃ© objet" et donne une introduction aux bases de la syntaxe. PML est intÃ©grÃ© dans PJL et **peut Ãªtre utilisÃ© pour lire et dÃ©finir des valeurs SNMP sur un pÃ©riphÃ©rique d'impression**. Cela est particuliÃ¨rement **intÃ©ressant** si un **pare-feu bloque** l'accÃ¨s aux services **SNMP** (161/udp). L'utilisation de PML dans une tÃ¢che d'impression rÃ©cupÃ©rant la valeur `hrDeviceDescr` (OID 1.3.6.1.2.1.25.3.2.1.3, description textuelle d'un pÃ©riphÃ©rique) est dÃ©montrÃ©e ci-dessous :
```
> @PJL DMINFO ASCIIHEX="000006030302010301"
< "8000000603030201030114106870204c617365724a65742034323530
```
La partie arriÃ¨re de la chaÃ®ne de caractÃ¨res renvoyÃ©e par l'imprimante, `6870204c617365724a65742034323530`, est l'hexadÃ©cimal pour `hp LaserJet 4250`. Comme on peut le voir, il est possible d'**invoquer** (un sous-ensemble de) **commandes SNMP via PJL via PML**. Une utilisation sensible Ã  la sÃ©curitÃ© de PML est de [rÃ©initialiser les imprimantes HP aux paramÃ¨tres d'usine](./#factory-defaults) via des travaux d'impression ordinaires, supprimant ainsi les mÃ©canismes de protection tels que les mots de passe dÃ©finis par l'utilisateur.

### UEL

Le langage de sortie universel (UEL) n'est en fait **pas un vÃ©ritable "langage" de contrÃ´le de tÃ¢ches, mais une seule commande utilisÃ©e pour terminer le flux de donnÃ©es actuel** : le caractÃ¨re d'Ã©chappement (`\x1b`), suivi de `%-12345X`. Il a Ã©tÃ© initialement introduit avec le PCL de HP et est **pris en charge par la plupart des imprimantes laser modernes**. Une bonne pratique des "pilotes d'imprimante" est d'invoquer l'UEL au dÃ©but et Ã  la fin de chaque travail d'impression, de sorte que l'interprÃ©tation du langage de l'imprimante soit arrÃªtÃ©e/redÃ©marrÃ©e et que chaque travail ait son propre environnement distinct, comme indiquÃ© ci-dessous :
```
\x1b%-12345X
@PJL SET PAPER=A4
@PJL ENTER LANGUAGE=PCL
...
[PCL datastream]
...
\x1b%-12345X
```
Sinon, par exemple, les paramÃ¨tres PJL tels que la taille des supports papier ou les dÃ©finitions PostScript dÃ©finies dans un travail d'impression influenceraient le travail suivant. **UEL peut Ãªtre pratique pour enchaÃ®ner plusieurs travaux en un seul fichier/datastream envoyÃ© Ã  l'imprimante**. Cela peut Ãªtre utilisÃ© pour tromper les **compteurs de pages matÃ©riels** ou pour passer Ã  un autre langage d'impression dans le cadre d'**attaques d'impression entre sites**.

## Langages de description de page

Un **langage de description de page** (PDL) spÃ©cifie l'**apparence du document rÃ©el**. Il convient toutefois de souligner que certains PDL offrent un contrÃ´le de travail limitÃ©, de sorte qu'**une dÃ©marcation claire entre la description de page et le langage de contrÃ´le d'imprimante/travail n'est pas toujours possible**. La fonction d'un "pilote d'imprimante" est de **traduire** le **fichier** Ã  **imprimer** en un **PDL** compris par le modÃ¨le d'imprimante. Notez que certaines imprimantes jet d'encre bon marchÃ© ne prennent en charge aucun langage de description de page de haut niveau. Les imprimantes dites basÃ©es sur l'hÃ´te ou [GDI](https://en.wikipedia.org/wiki/Graphics\_Device\_Interface#GDI\_printers) n'acceptent que des flux de donnÃ©es bitmap simples tels que [ZJS](http://www.undocprint.org/formats/page\_description\_languages/zjstream) tandis que le rendu rÃ©el est effectuÃ© par le pilote d'imprimante. Il existe diffÃ©rents langages de description de page propriÃ©taires tels que [PRESCRIBE](http://www.undocprint.org/formats/page\_description\_languages/prescribe) de Kyocera, [SPL](http://www.undocprint.org/formats/page\_description\_languages/spl), [XES](http://www.undocprint.org/formats/page\_description\_languages/xes), [CaPSL](http://www.undocprint.org/formats/page\_description\_languages/capsl), [RPCS](http://www.undocprint.org/formats/page\_description\_languages/rpcs), [ESC/P](https://en.wikipedia.org/wiki/ESC/P) qui est principalement utilisÃ© dans les imprimantes Ã  matrice de points ou [HP-GL](https://en.wikipedia.org/wiki/HPGL) et [HP-GL/2](https://en.wikipedia.org/wiki/HPGL#HP-GL.2F2) qui ont Ã©tÃ© conÃ§us pour les traceurs. La prise en charge de l'impression directe de [PDF](https://en.wikipedia.org/wiki/Portable\_Document\_Format) et de [XPS](https://en.wikipedia.org/wiki/Open\_XML\_Paper\_Specification) est Ã©galement courante sur les imprimantes plus rÃ©centes. **Les langages de description de page les plus courants sont cependant PostScript et PCL.**

### PostScript (PS)

Le terme "description de page" peut Ãªtre trompeur, car **PostScript est capable de bien plus que de simplement crÃ©er des graphiques vectoriels**. PostScript est un langage de programmation complet de type Turing basÃ© sur une pile, composÃ© de prÃ¨s de 400 opÃ©rateurs pour la manipulation arithmÃ©tique, de la pile et des graphiques, et de divers types de donnÃ©es tels que des tableaux ou des dictionnaires, et a Ã©tÃ© crÃ©Ã© par Adobe.\
Techniquement parlant, l'accÃ¨s Ã  un interprÃ©teur PostScript peut dÃ©jÃ  Ãªtre classÃ© comme une **exÃ©cution de code** car toute fonction algorithmique peut thÃ©oriquement Ãªtre implÃ©mentÃ©e en PostScript. Certes, sans accÃ¨s Ã  la pile rÃ©seau ou Ã  des bibliothÃ¨ques de systÃ¨me d'exploitation supplÃ©mentaires, les possibilitÃ©s sont limitÃ©es aux calculs mathÃ©matiques arbitraires tels que l'extraction de bitcoins. Cependant, PostScript est capable d'une entrÃ©e/sortie de systÃ¨me de fichiers de base pour stocker des fichiers de code, de graphiques ou de polices frÃ©quemment utilisÃ©s.\
Ã€ l'origine conÃ§ue comme une fonctionnalitÃ©, les dangers d'une telle fonctionnalitÃ© **Ã©taient limitÃ©s** avant que les imprimantes ne soient interconnectÃ©es et que les risques ne soient principalement discutÃ©s dans le contexte des interprÃ©teurs PostScript basÃ©s sur l'hÃ´te. Ã€ cet Ã©gard, Encapsulated PostScript (EPS) est Ã©galement remarquable car il peut Ãªtre inclus dans d'autres formats de fichier Ã  interprÃ©ter sur l'hÃ´te tels que les documents [LaTeX](https://en.wikipedia.org/wiki/LaTeX). Comme **PJL** et **PCL**, **PostScript** prend en charge une **communication bidirectionnelle** entre l'hÃ´te et l'imprimante.\
Un exemple de code PostScript pour afficher "Hello world" sur stdout est donnÃ© ci-dessous:
```
%!
(Hello world) print
```
Brother et Kyocera utilisent leurs propres clones de PostScript : **Br-Script** et **KPDL**. Ces versions du langage PostScript ne sont pas compatibles Ã  100 %, en particulier en ce qui concerne les fonctionnalitÃ©s de sÃ©curitÃ© telles que la sortie de la boucle du serveur. PostScript peut Ãªtre utilisÃ© pour une variÃ©tÃ© d'attaques telles que le [dÃ©ni de service](http://hacking-printers.net/wiki/index.php/Denial\_of\_service) (par exemple, Ã  travers des boucles infinies), la [manipulation](http://hacking-printers.net/wiki/index.php/Print\_job\_manipulation) et la [rÃ©tention](http://hacking-printers.net/wiki/index.php/Print\_job\_retention) des travaux d'impression ainsi que l'accÃ¨s au [systÃ¨me de fichiers](http://hacking-printers.net/wiki/index.php/File\_system\_access) de l'imprimante.

#### Sortie de la boucle du serveur

Normalement, chaque travail d'impression est encapsulÃ© dans son propre environnement sÃ©parÃ©. Une fonctionnalitÃ© intÃ©ressante de **PostScript** est qu'un programme **peut contourner l'encapsulation du travail d'impression** et modifier la VM initiale pour les travaux ultÃ©rieurs. Pour ce faire, il peut utiliser soit startjob, une fonctionnalitÃ© de niveau 2 :
```
true 0 startjob
```
ou exitserver (disponible dans toutes les implÃ©mentations qui incluent un serveur de tÃ¢ches):
```
serverdict begin 0 exitserver
```
Cette capacitÃ© est contrÃ´lÃ©e par StartJobPassword qui est par dÃ©faut Ã  `0` (comparer la divulgation d'informations d'identification). Ã‰tant donnÃ© que la boucle du serveur de tÃ¢ches est gÃ©nÃ©ralement responsable du nettoyage de l'Ã©tat de l'interprÃ©teur entre les tÃ¢ches, **toutes les modifications apportÃ©es en dehors de la boucle du serveur resteront comme faisant partie de l'Ã©tat permanent de l'interprÃ©teur pour toutes les tÃ¢ches ultÃ©rieures**. En d'autres termes, une tÃ¢che d'impression peut accÃ©der et modifier d'autres tÃ¢ches. Bingo !

#### RedÃ©finition de l'opÃ©rateur

Lorsqu'un document **PostScript** **appelle** un **opÃ©rateur**, la **premiÃ¨re version trouvÃ©e** sur la pile de dictionnaires est utilisÃ©e. Les opÃ©rateurs rÃ©sident gÃ©nÃ©ralement dans le dictionnaire systemdict, cependant, en plaÃ§ant une nouvelle version dans le dictionnaire userdict, les opÃ©rateurs peuvent Ãªtre pratiquement Ã©crasÃ©s car **la version dÃ©finie par l'utilisateur est la premiÃ¨re trouvÃ©e sur la pile de dictionnaires**. En utilisant les opÃ©rateurs startjob/exitserver, de tels changements peuvent Ãªtre rendus permanents - du moins jusqu'Ã  ce que l'imprimante soit redÃ©marrÃ©e. Un schÃ©ma de la pile de dictionnaires PostScript est donnÃ© ci-dessous :

\
[![La pile de dictionnaires PostScript](http://hacking-printers.net/wiki/images/thumb/f/ff/Dictstack.png/300px-Dictstack.png)](http://hacking-printers.net/wiki/index.php/File:Dictstack.png)

\
L'**impact potentiel de la redÃ©finition des opÃ©rateurs** est limitÃ© uniquement par la crÃ©ativitÃ©. Lorsque d'autres documents lÃ©gitimes sont imprimÃ©s et appellent un opÃ©rateur redÃ©fini, la version de l'attaquant sera exÃ©cutÃ©e. Cela peut conduire Ã  diverses attaques telles que le [dÃ©ni de service](http://hacking-printers.net/wiki/index.php/Document\_processing#Showpage\_redefinition), la [rÃ©tention](http://hacking-printers.net/wiki/index.php/Print\_job\_retention) et la [manipulation](http://hacking-printers.net/wiki/index.php/Print\_job\_manipulation) de tÃ¢ches d'impression. Notez cependant que ce n'est pas nÃ©cessairement un bogue de sÃ©curitÃ©, mais une fonctionnalitÃ© de langage vieille de 32 ans, disponible dans presque toutes les imprimantes PostScript et [RIP](https://en.wikipedia.org/wiki/Raster\_image\_processor).

### PCL

PCL 3 et PCL 4 ont ajoutÃ© la prise en charge de polices et de macros qui peuvent toutes deux Ãªtre tÃ©lÃ©chargÃ©es de maniÃ¨re permanente sur le pÃ©riphÃ©rique - cependant, uniquement rÃ©fÃ©rencÃ©es par un identifiant numÃ©rique, pas par un nom de fichier, car **l'accÃ¨s direct au systÃ¨me de fichiers n'est pas prÃ©vu**. PCL 1 Ã  5 se composent de sÃ©quences d'Ã©chappement suivies d'un ou plusieurs caractÃ¨res ASCII reprÃ©sentant une commande Ã  interprÃ©ter. PCL 6 Enhanced ou Â« PCL XL Â» utilise un protocole orientÃ© objet codÃ© en binaire. Un **exemple de document PCL pour imprimer Â« Bonjour tout le monde Â» est donnÃ© ci-dessous** :
```
<Esc>Hello world
```
En raison de ses capacitÃ©s limitÃ©es, PCL est difficile Ã  exploiter d'un point de vue de sÃ©curitÃ© Ã  moins de dÃ©couvrir des commandes propriÃ©taires intÃ©ressantes dans la version PCL de certains fabricants d'imprimantes. L'outil PRET implÃ©mente un systÃ¨me de fichiers virtuel basÃ© sur PCL qui utilise des macros pour enregistrer le contenu des fichiers et les mÃ©tadonnÃ©es dans la mÃ©moire de l'imprimante. Cette astuce montre qu'un pÃ©riphÃ©rique qui ne prend en charge que des langages de description de page minimalistes comme PCL peut Ãªtre utilisÃ© pour stocker des fichiers arbitraires tels que du matÃ©riel enfreignant les droits d'auteur. Bien que transformer une imprimante en service de partage de fichiers ne soit pas une vulnÃ©rabilitÃ© de sÃ©curitÃ© en soi, cela peut Ãªtre considÃ©rÃ© comme une Â« mauvaise utilisation du service Â» en fonction de la politique de l'entreprise.

## Attaques diverses

### ClÃ© USB ou cÃ¢ble

Les donnÃ©es peuvent Ãªtre envoyÃ©es Ã  une imprimante locale et reÃ§ues d'elle par des cÃ¢bles [USB](https://en.wikipedia.org/wiki/USB) ou [parallÃ¨les](https://en.wikipedia.org/wiki/IEEE\_1284). Les deux canaux sont pris en charge par PRET pour communiquer avec le pÃ©riphÃ©rique. De plus, les imprimantes et les MFP sont souvent livrÃ©s avec des ports USB de type A qui permettent aux utilisateurs d'imprimer directement Ã  partir d'un pÃ©riphÃ©rique USB.\
Bien que les clÃ©s USB branchÃ©es ne proposent pas de canal bidirectionnel, leur utilisation dans une salle de copie bondÃ©e peut sembler moins suspecte. Ã‰videmment, l'exploitation d'imprimantes USB nÃ©cessite que l'attaquant ait un accÃ¨s physique au pÃ©riphÃ©rique. Cependant, cela n'est pas complÃ¨tement irrÃ©aliste pour la plupart des institutions et des entreprises. L'accÃ¨s physique Ã  l'imprimante peut gÃ©nÃ©ralement Ãªtre considÃ©rÃ© comme moins difficile que pour d'autres composants rÃ©seau tels que les serveurs ou les postes de travail.

### Impression en travers de site

En abusant de la demande web client, un attaquant peut abuser des imprimantes arbitraires Ã  l'intÃ©rieur du rÃ©seau interne du client connectÃ© Ã  sa page web malveillante.\
[**Apprenez comment cela est possible ici.**](cross-site-printing.md)

### Abus du service Spooler dans AD

Si vous trouvez un service Spool en Ã©coute Ã  l'intÃ©rieur du domaine, vous pourriez Ãªtre en mesure de l'abuser pour obtenir de nouvelles informations d'identification et escalader les privilÃ¨ges.\
[**Plus d'informations sur la faÃ§on de trouver et d'abuser des services Spooler ici.**](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)

## Ã‰lÃ©vation de privilÃ¨ges

### ParamÃ¨tres d'usine

Il existe plusieurs faÃ§ons possibles de rÃ©initialiser un pÃ©riphÃ©rique aux paramÃ¨tres d'usine, et il s'agit d'une fonctionnalitÃ© critique pour la sÃ©curitÃ© car elle Ã©crase les mÃ©canismes de protection tels que les mots de passe dÃ©finis par l'utilisateur.\
[**En savoir plus ici.**](factory-defaults.md)

### Contournement de la comptabilitÃ©

Vous pourriez Ãªtre en mesure d'usurper l'identitÃ© d'utilisateurs existants ou inexistants pour imprimer des pages en utilisant leurs comptes ou manipuler le compteur matÃ©riel ou logiciel pour pouvoir imprimer plus de pages.\
[**Apprenez comment le faire ici.**](accounting-bypass.md)

### Scanner et fax

En accÃ©dant aux fonctionnalitÃ©s de scanner ou de fax, vous pourriez Ãªtre en mesure d'accÃ©der Ã  d'autres fonctionnalitÃ©s, mais tout cela dÃ©pend du fournisseur.\
[**En savoir plus ici.**](scanner-and-fax.md)

## AccÃ¨s aux travaux d'impression

### Conservation des travaux d'impression

Les travaux peuvent Ãªtre conservÃ©s en mÃ©moire et Ãªtre imprimÃ©s Ã  nouveau Ã  un moment ultÃ©rieur Ã  partir du panneau de commande, ou en utilisant PostScript, vous pouvez mÃªme accÃ©der Ã  distance Ã  tous les travaux qui vont Ãªtre imprimÃ©s, les tÃ©lÃ©charger et les imprimer.\
[**En savoir plus ici.**](print-job-retention.md)

### Manipulation des travaux d'impression

Vous pouvez ajouter de nouveaux contenus aux pages qui sont imprimÃ©es, changer tout le contenu qui va Ãªtre imprimÃ© ou mÃªme remplacer certaines lettres ou certains mots.\
[**Apprenez comment le faire ici.**](print-job-manipulation.md)

## Divulgation d'informations

### AccÃ¨s Ã  la mÃ©moire

Vous pourriez Ãªtre en mesure de vider la mÃ©moire NVRAM et d'extraire des informations sensibles (comme les mots de passe) Ã  partir de lÃ .\
[**Lisez comment faire ici.**](memory-access.md)

### AccÃ¨s au systÃ¨me de fichiers

Vous pourriez Ãªtre en mesure d'accÃ©der au systÃ¨me de fichiers en abusant de PJL ou de PostScript.\
[**Lisez comment faire ici.**](file-system-access.md)

### Divulgation/Brute-Force des informations d'identification

Vous pourriez Ãªtre en mesure de divulguer le mot de passe en abusant des paramÃ¨tres SNMP ou LDAP ou vous pourriez essayer de forcer PJL ou PostScript.\
[**Lisez comment faire ici.**](credentials-disclosure-brute-force.md)

## ExÃ©cution de code

### DÃ©bordements de tampon

Plusieurs dÃ©bordements de tampon ont dÃ©jÃ  Ã©tÃ© trouvÃ©s dans l'entrÃ©e PJL et dans le dÃ©mon LPD, et il pourrait y en avoir d'autres.\
[**Lisez ceci pour plus d'informations.**](buffer-overflows.md)

### Mises Ã  jour du micrologiciel

Vous pourriez Ãªtre en mesure de faire mettre Ã  jour le pilote de l'imprimante par un pilote malveillant spÃ©cialement conÃ§u par vous.\
[**Lisez ceci pour plus d'informations.**](firmware-updates.md)

### Packages logiciels

Les fournisseurs d'imprimantes ont commencÃ© Ã  introduire la possibilitÃ© d'installer des logiciels personnalisÃ©s sur leurs appareils, mais les informations ne sont pas disponibles publiquement. La fonctionnalitÃ© d'Ã©criture de logiciels personnalisÃ©s qui s'exÃ©cutent sur les imprimantes Ã©tait destinÃ©e et est rÃ©servÃ©e aux revendeurs et aux entrepreneurs.\
[**En savoir plus Ã  ce sujet ici.**](software-packages.md)

## DÃ©ni de service

### Canal de transmission

Occuper toutes les connexions et augmenter le dÃ©lai d'attente du serveur pourrait entraÃ®ner un dÃ©ni de service.\
[**En savoir plus Ã  ce sujet ici.**](transmission-channel.md)

### Traitement de documents

Vous pouvez utiliser PostScript et PJL pour effectuer des boucles infinies, redÃ©finir des commandes pour Ã©viter toute impression, dÃ©sactiver toute fonctionnalitÃ© d'impression ou mÃªme mettre l'imprimante en mode hors ligne.\
[**En savoir plus Ã  ce sujet ici.**](document-processing.md)

### Dommages physiques

On pourrait abuser de PJL ou de PostScript pour Ã©crire dans la NVRAM des centaines de milliers de fois dans le but de casser la puce ou du moins de faire geler les paramÃ¨tres dans les paramÃ¨tres par dÃ©faut d'usine.\
[**En savoir plus Ã  ce sujet ici.**](physical-damage.md)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de cybersÃ©curitÃ© ? Voulez-vous voir votre entreprise annoncÃ©e dans HackTricks ? ou voulez-vous avoir accÃ¨s Ã  la derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3
