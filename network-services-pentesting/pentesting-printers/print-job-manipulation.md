<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Contenu Overlay

Une faÃ§on simple de manipuler l'apparence des impressions est d'utiliser des superpositions. \
[**PCL**](./#pcl) a une fonction documentÃ©e pour mettre des **macros de superposition** sur un document. Malheureusement, cette fonctionnalitÃ© est **limitÃ©e au travail d'impression en cours** et ne peut pas Ãªtre rendue permanente. \
[**PostScript**](./#postscript-ps) n'offre pas une telle fonctionnalitÃ© par dÃ©faut, mais elle peut Ãªtre programmÃ©e en **redÃ©finissant l'opÃ©rateur showpage** qui est contenu dans chaque document PostScript pour imprimer la page en cours. L'attaquant peut **s'insÃ©rer lÃ **, exÃ©cuter son propre code et ensuite appeler la version originale de l'opÃ©rateur.\
Ainsi, elle peut superposer toutes les pages Ã  imprimer avec un fichier EPS personnalisÃ©. Cette astuce peut Ãªtre utilisÃ©e pour **ajouter des graphiques ou des polices arbitraires aux copies papier d'un document** (Il est possible de modifier complÃ¨tement l'apparence d'un document en superposant une page blanche et en ajoutant ensuite un contenu personnalisÃ©).\
Ã‰videmment, une telle approche ne peut rÃ©ussir que si PostScript est utilisÃ© comme pilote d'imprimante et qu'aucun `StartJobPassword` n'est dÃ©fini.

![](http://hacking-printers.net/wiki/images/thumb/9/93/Overlay.jpg/300px-Overlay.jpg)

**Comment tester cette attaque ?**

Utilisez les commandes `cross` ou `overlay` de [**PRET**](https://github.com/RUB-NDS/PRET) en mode ps, puis dÃ©connectez-vous et imprimez un document arbitraire :
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> overlay overlays/smiley.eps
printer:/> cross whoa "HACKED"
printer:/> exit
```
# Remplacement de contenu

MÃªme si un attaquant peut superposer un document existant, elle ne pourra pas **modifier des valeurs spÃ©cifiques** dans le document original Ã  moins de connaÃ®tre sa structure exacte. Parfois, on ne veut pas seulement ajouter un contenu personnalisÃ©, mais **analyser et remplacer des parties** du document existant. \
Le problÃ¨me de remplacement de texte dans les fichiers PostScript peut Ãªtre rÃ©duit au **problÃ¨me d'extraction de chaÃ®nes** du document rendu. Ce n'est pas trivial, car les chaÃ®nes peuvent Ãªtre construites dynamiquement par le programme PostScript lui-mÃªme. Ainsi, l'analyse et le remplacement simples dans le code source du document ne sont pas une option.\
Vous pouvez utiliser un **opÃ©rateur `show` redÃ©fini**. L'opÃ©rateur show accepte une chaÃ®ne en entrÃ©e, qui est peinte Ã  un certain emplacement de la page actuelle. En redÃ©finissant l'opÃ©rateur, le **texte** peut Ãªtre **extrait** de maniÃ¨re Ã©lÃ©gante. Cette approche peut Ã©galement Ãªtre utilisÃ©e pour une **recherche et un remplacement ciblÃ©s** dans les chaÃ®nes immÃ©diatement **avant** qu'elles ne soient **peintes**. \
L'approche est **rÃ©ussie** pour les documents PostScript basÃ©s sur **LaTeX** qui sont directement envoyÃ©s Ã  l'imprimante, tandis qu'elle **Ã©choue** pour les fichiers PostScript gÃ©nÃ©rÃ©s par **GIMP** qui, au lieu de chaÃ®nes, **crÃ©ent des graphiques raster** de leur reprÃ©sentation. Le mÃªme problÃ¨me se produit pour tout format de document - mÃªme PostScript lui-mÃªme - lorsqu'il est traitÃ© par CUPS. ThÃ©oriquement, de tels langages de construction pourraient Ã©galement Ãªtre analysÃ©s et devraient faire l'objet de recherches ultÃ©rieures.

**Comment tester cette attaque ?**

Utilisez la commande `replace` de [**PRET**](https://github.com/RUB-NDS/PRET) en mode ps, puis dÃ©connectez et imprimez un document PostScript contenant "DEF" :
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> replace "ABC" "DEF"
printer:/> exit
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
