# 111/TCP/UDP - Pentesting Portmapper

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

**Portmapper**, aÄŸ hizmeti baÄŸlantÄ± noktalarÄ±nÄ± **RPC** (Uzak Yordam Ã‡aÄŸrÄ±sÄ±) program numaralarÄ±na eÅŸleme amacÄ±yla kullanÄ±lan bir hizmettir. Unix tabanlÄ± sistemlerde, bu sistemler arasÄ±nda bilgi alÄ±ÅŸveriÅŸini kolaylaÅŸtÄ±ran kritik bir bileÅŸen olarak gÃ¶rev yapar. **Portmapper** ile iliÅŸkilendirilen **port**, saldÄ±rganlar tarafÄ±ndan sÄ±kÃ§a taranÄ±r Ã§Ã¼nkÃ¼ deÄŸerli bilgileri ortaya Ã§Ä±karabilir. Bu bilgiler, Ã§alÄ±ÅŸan **Unix Ä°ÅŸletim Sistemi (OS)** tÃ¼rÃ¼nÃ¼ ve sistemde mevcut olan hizmetler hakkÄ±nda ayrÄ±ntÄ±larÄ± iÃ§erir. AyrÄ±ca, **Portmapper** genellikle **NFS (AÄŸ Dosya Sistemi)**, **NIS (AÄŸ Bilgi Servisi)** ve diÄŸer **RPC tabanlÄ± hizmetlerle** birlikte kullanÄ±larak aÄŸ hizmetlerini etkili bir ÅŸekilde yÃ¶netmek iÃ§in kullanÄ±lÄ±r.

**VarsayÄ±lan port:** 111/TCP/UDP, Oracle Solaris'te 32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## NumaralandÄ±rma

RPCbind, bir aÄŸ hizmeti olarak Ã§alÄ±ÅŸÄ±r ve RPC (Remote Procedure Call) Ã§aÄŸrÄ±larÄ±nÄ± yÃ¶netir. RPCbind, sunucularÄ±n hangi portlarda Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ve hangi RPC hizmetlerini desteklediÄŸini belirlemek iÃ§in kullanÄ±labilir.

### RPCbind Port TaramasÄ±

RPCbind, varsayÄ±lan olarak TCP ve UDP Ã¼zerinde 111 numaralÄ± portu kullanÄ±r. Bu nedenle, hedef sistemde RPCbind'in Ã§alÄ±ÅŸtÄ±ÄŸÄ± portu belirlemek iÃ§in bir port taramasÄ± yapÄ±labilir.

```bash
nmap -p 111 <hedef_ip>
```

### RPCbind Sunucu Bilgilerini Almak

RPCbind sunucu bilgilerini almak iÃ§in `rpcinfo` komutu kullanÄ±labilir. Bu komut, hedef sistemde Ã§alÄ±ÅŸan RPC hizmetlerinin listesini ve bu hizmetlerin hangi portlarda Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶sterir.

```bash
rpcinfo -p <hedef_ip>
```

### RPC Sunucu Bilgilerini Almak

RPC hizmetlerinin sunucu bilgilerini almak iÃ§in `rpcinfo` komutu kullanÄ±labilir. Bu komut, belirli bir RPC hizmetinin hangi sunucularda Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶sterir.

```bash
rpcinfo -p <hedef_ip> | grep <rpc_hizmeti_adÄ±>
```

### RPC Sunucu Bilgilerini KeÅŸfetmek

RPC sunucu bilgilerini keÅŸfetmek iÃ§in `showmount` komutu kullanÄ±labilir. Bu komut, hedef sistemdeki NFS (Network File System) sunucularÄ±nÄ±n listesini gÃ¶sterir.

```bash
showmount -e <hedef_ip>
```

### RPC Sunucu BaÄŸlantÄ± NoktalarÄ±nÄ± KeÅŸfetmek

RPC sunucu baÄŸlantÄ± noktalarÄ±nÄ± keÅŸfetmek iÃ§in `rpcinfo` komutu kullanÄ±labilir. Bu komut, belirli bir sunucunun hangi RPC hizmetlerini desteklediÄŸini gÃ¶sterir.

```bash
rpcinfo -n <hedef_ip>
```
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Bazen hiÃ§bir bilgi vermez, diÄŸer durumlarda ise ÅŸÃ¶yle bir ÅŸey alÄ±rsÄ±nÄ±z:

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

EÄŸer NFS servisini bulursanÄ±z, muhtemelen dosyalarÄ± listelemek ve indirmek (ve belki yÃ¼klemek) iÃ§in yetenekli olacaksÄ±nÄ±z:

![](<../.gitbook/assets/image (232).png>)

Bu protokolÃ¼ nasÄ±l test edeceÄŸiniz hakkÄ±nda daha fazla bilgi edinmek iÃ§in [2049 - NFS servisi pentesting](nfs-service-pentesting.md) sayfasÄ±nÄ± okuyun.

## NIS

**NIS** zafiyetlerini keÅŸfetmek iÃ§in iki adÄ±mlÄ± bir sÃ¼reÃ§ gereklidir. Ä°lk adÄ±m, `ypbind` servisinin tespit edilmesidir. Bu keÅŸfin temel taÅŸÄ±, ilerlemenin durduÄŸu **NIS alan adÄ±nÄ±n** ortaya Ã§Ä±karÄ±lmasÄ±dÄ±r.

![](<../.gitbook/assets/image (233).png>)

KeÅŸif yolculuÄŸu, gerekli paketlerin kurulumuyla (apt-get install nis) baÅŸlar. Sonraki adÄ±m, gÃ¼venlik iÃ§in bu unsurlarÄ±n anonimleÅŸtirilerek, alan adÄ± ve sunucu IP'si ile NIS sunucusunun varlÄ±ÄŸÄ±nÄ± pinglemek iÃ§in `ypwhich` kullanmaktÄ±r.

Son ve Ã¶nemli adÄ±m, Ã¶zellikle ÅŸifrelenmiÅŸ kullanÄ±cÄ± parolalarÄ±nÄ± iÃ§eren hassas verileri Ã§Ä±karmak iÃ§in `ypcat` komutunu kullanmaktÄ±r. Bu karmaÅŸalar, **John the Ripper** gibi araÃ§lar kullanÄ±larak kÄ±rÄ±ldÄ±ÄŸÄ±nda, sistem eriÅŸimi ve ayrÄ±calÄ±klarÄ± hakkÄ±nda bilgi saÄŸlar.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat â€“d <domain-name> â€“h <server-ip> passwd.byname
```
### NIF DosyalarÄ±

| **Ana dosya**    | **Harita(lar)**             | **Notlar**                            |
| ---------------- | --------------------------- | ------------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Ana bilgisayar adlarÄ± ve IP bilgileri  |
| /etc/passwd      | passwd.byname, passwd.byuid | NIS kullanÄ±cÄ± parola dosyasÄ±          |
| /etc/group       | group.byname, group.bygid   | NIS grup dosyasÄ±                      |
| /usr/lib/aliases | mail.aliases                | Posta takma adlarÄ± ayrÄ±ntÄ±larÄ±         |

## RPC KullanÄ±cÄ±larÄ±

EÄŸer **rusersd** servisi aÅŸaÄŸÄ±daki gibi listeleniyorsa:

![](<../.gitbook/assets/image (231).png>)

Kutunun kullanÄ±cÄ±larÄ±nÄ± sÄ±ralayabilirsiniz. NasÄ±l yapÄ±lacaÄŸÄ±nÄ± Ã¶ÄŸrenmek iÃ§in [1026 - Rsusersd Pentesting](1026-pentesting-rusersd.md) makalesine bakÄ±n.

## FiltrelenmiÅŸ Portmapper portunu atlatma

Bir **nmap taramasÄ±** yaparken ve port 111'in filtrelenmiÅŸ olduÄŸunu keÅŸfettiÄŸinizde, bu portlarÄ±n doÄŸrudan istismar edilmesi mÃ¼mkÃ¼n deÄŸildir. Ancak, **yerel olarak bir portmapper servisi simÃ¼le ederek ve makinenizden hedefe bir tÃ¼nel oluÅŸturarak**, standart araÃ§lar kullanarak istismar mÃ¼mkÃ¼n hale gelir. Bu teknik, port 111'in filtrelenmiÅŸ durumunu atlamayÄ± saÄŸlar, bÃ¶ylece NFS hizmetlerine eriÅŸim saÄŸlanabilir. Bu yÃ¶ntemle ilgili ayrÄ±ntÄ±lÄ± rehberlik iÃ§in [bu baÄŸlantÄ±daki](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc) makaleye baÅŸvurun.

## Shodan

* `Portmap`

## Uygulama iÃ§in Lablar

* Bu teknikleri [**Irked HTB makinesinde**](https://app.hackthebox.com/machines/Irked) uygulayÄ±n.

## HackTricks Otomatik KomutlarÄ±
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin.**
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
