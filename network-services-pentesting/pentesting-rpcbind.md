# 111/TCP/UDP - Pentesting Portmapper

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Basic Information

**Portmapper** je servis koji se koristi za mapiranje portova mreÅ¾nih servisa na **RPC** (Remote Procedure Call) brojeve programa. Deluje kao kritiÄna komponenta u **Unix-baziranim sistemima**, olakÅ¡avajuÄ‡i razmenu informacija izmeÄ‘u ovih sistema. **Port** povezan sa **Portmapper**-om Äesto skeniraju napadaÄi jer moÅ¾e otkriti dragocene informacije. Ove informacije ukljuÄuju tip **Unix operativnog sistema (OS)** koji se koristi i detalje o servisima koji su dostupni na sistemu. Pored toga, **Portmapper** se obiÄno koristi u kombinaciji sa **NFS (Network File System)**, **NIS (Network Information Service)** i drugim **RPC-baziranim servisima** za efikasno upravljanje mreÅ¾nim servisima.

**Podrazumevani port:** 111/TCP/UDP, 32771 u Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Enumeracija
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Ponekad ne daje nikakve informacije, a u drugim prilikama dobiÄ‡ete neÅ¡to poput ovoga:

![](<../.gitbook/assets/image (553).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Ako pronaÄ‘ete uslugu NFS, verovatno Ä‡ete moÄ‡i da listate i preuzimate (i moÅ¾da otpremate) fajlove:

![](<../.gitbook/assets/image (872).png>)

ProÄitajte[ 2049 - Pentesting NFS service](nfs-service-pentesting.md) da biste saznali viÅ¡e o tome kako testirati ovaj protokol.

## NIS

IstraÅ¾ivanje **NIS** ranjivosti ukljuÄuje dvostepeni proces, poÄinjuÄ‡i sa identifikacijom usluge `ypbind`. Temelj ove eksploracije je otkrivanje **NIS domena**, bez kojeg je napredak zaustavljen.

![](<../.gitbook/assets/image (859).png>)

Putovanje istraÅ¾ivanjem poÄinje instalacijom potrebnih paketa (`apt-get install nis`). SledeÄ‡i korak zahteva koriÅ¡Ä‡enje `ypwhich` za potvrdu prisutnosti NIS servera pingovanjem sa imenom domena i IP adresom servera, osiguravajuÄ‡i da su ovi elementi anonimni radi bezbednosti.

Zadnji i kljuÄni korak ukljuÄuje komandu `ypcat` za ekstrakciju osetljivih podataka, posebno enkriptovanih korisniÄkih lozinki. Ove heÅ¡irane vrednosti, kada se razbiju koristeÄ‡i alate poput **John the Ripper**, otkrivaju uvide u pristup sistemu i privilegije.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat â€“d <domain-name> â€“h <server-ip> passwd.byname
```
### NIF datoteke

| **Glavna datoteka** | **Mapa(e)**                | **Napomene**                     |
| ------------------- | -------------------------- | --------------------------------- |
| /etc/hosts          | hosts.byname, hosts.byaddr | SadrÅ¾i imena hostova i IP detalje |
| /etc/passwd         | passwd.byname, passwd.byuid| NIS datoteka sa korisniÄkim lozinkama |
| /etc/group          | group.byname, group.bygid  | NIS datoteka grupa               |
| /usr/lib/aliases    | mail.aliases               | Detalji o mail aliasima          |

## RPC Korisnici

Ako pronaÄ‘ete **rusersd** servis naveden ovako:

![](<../.gitbook/assets/image (1041).png>)

MoÅ¾ete enumerisati korisnike na maÅ¡ini. Da biste saznali kako, proÄitajte [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## ZaobilaÅ¾enje filtriranog Portmapper porta

Kada sprovodite **nmap skeniranje** i otkrijete otvorene NFS portove sa filtriranim portom 111, direktna eksploatacija ovih portova nije moguÄ‡a. MeÄ‘utim, simulacijom portmapper servisa lokalno i kreiranjem tunela sa vaÅ¡e maÅ¡ine ka cilju, eksploatacija postaje moguÄ‡a koriÅ¡Ä‡enjem standardnih alata. Ova tehnika omoguÄ‡ava zaobilaÅ¾enje filtriranog stanja porta 111, Äime se omoguÄ‡ava pristup NFS servisima. Za detaljna uputstva o ovoj metodi, pogledajte Älanak dostupan na [ovoj vezi](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).

## Shodan

* `Portmap`

## Laboratorije za veÅ¾banje

* VeÅ¾bajte ove tehnike na [**Irked HTB maÅ¡ini**](https://app.hackthebox.com/machines/Irked).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HackTricks Automatske Komande
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
