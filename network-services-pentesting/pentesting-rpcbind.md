# 111/TCP/UDP - Pentesting Portmapper

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Temel Bilgiler

**Portmapper**, aÄŸ hizmeti portlarÄ±nÄ± **RPC** (Uzak ProsedÃ¼r Ã‡aÄŸrÄ±sÄ±) program numaralarÄ±na eÅŸlemek iÃ§in kullanÄ±lan bir hizmettir. **Unix tabanlÄ± sistemler** iÃ§inde bilgi alÄ±ÅŸveriÅŸini kolaylaÅŸtÄ±rarak kritik bir bileÅŸen olarak iÅŸlev gÃ¶rÃ¼r. **Portmapper** ile iliÅŸkili **port**, deÄŸerli bilgiler aÃ§Ä±ÄŸa Ã§Ä±karabileceÄŸi iÃ§in saldÄ±rganlar tarafÄ±ndan sÄ±kÃ§a taranÄ±r. Bu bilgiler, Ã§alÄ±ÅŸan **Unix Ä°ÅŸletim Sistemi (OS)** tÃ¼rÃ¼ ve sistemde mevcut olan hizmetler hakkÄ±nda ayrÄ±ntÄ±larÄ± iÃ§erir. AyrÄ±ca, **Portmapper**, aÄŸ hizmetlerini etkili bir ÅŸekilde yÃ¶netmek iÃ§in genellikle **NFS (AÄŸ Dosya Sistemi)**, **NIS (AÄŸ Bilgi Servisi)** ve diÄŸer **RPC tabanlÄ± hizmetler** ile birlikte kullanÄ±lÄ±r.

**VarsayÄ±lan port:** 111/TCP/UDP, 32771 Oracle Solaris'te
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## SayÄ±m
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Bazen size hiÃ§bir bilgi vermez, diÄŸer durumlarda ise ÅŸÃ¶yle bir ÅŸey alÄ±rsÄ±nÄ±z:

![](<../.gitbook/assets/image (553).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

EÄŸer NFS hizmetini bulursanÄ±z, muhtemelen dosyalarÄ± listeleyip indirebilir (ve belki de yÃ¼kleyebilirsiniz):

![](<../.gitbook/assets/image (872).png>)

Bu protokolÃ¼ test etmenin yollarÄ±nÄ± Ã¶ÄŸrenmek iÃ§in [2049 - Pentesting NFS service](nfs-service-pentesting.md) okuyun.

## NIS

**NIS** zafiyetlerini keÅŸfetmek, `ypbind` hizmetinin tanÄ±mlanmasÄ±yla baÅŸlayan iki aÅŸamalÄ± bir sÃ¼reÃ§tir. Bu keÅŸfin temel taÅŸÄ±, **NIS alan adÄ±nÄ±** ortaya Ã§Ä±karmaktÄ±r; bu olmadan ilerleme durur.

![](<../.gitbook/assets/image (859).png>)

KeÅŸif yolculuÄŸu, gerekli paketlerin kurulumu ile baÅŸlar (`apt-get install nis`). Sonraki adÄ±m, NIS sunucusunun varlÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in `ypwhich` kullanarak alan adÄ± ve sunucu IP'si ile ping atmayÄ± gerektirir; bu unsurlarÄ±n gÃ¼venlik iÃ§in anonimleÅŸtirildiÄŸinden emin olunmalÄ±dÄ±r.

Son ve kritik adÄ±m, hassas verileri, Ã¶zellikle ÅŸifrelenmiÅŸ kullanÄ±cÄ± ÅŸifrelerini Ã§Ä±karmak iÃ§in `ypcat` komutunu kullanmaktÄ±r. **John the Ripper** gibi araÃ§lar kullanÄ±larak kÄ±rÄ±lan bu hash'ler, sistem eriÅŸimi ve ayrÄ±calÄ±klarÄ± hakkÄ±nda bilgiler sunar.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat â€“d <domain-name> â€“h <server-ip> passwd.byname
```
### NIF dosyalarÄ±

| **Ana dosya**    | **Harita(lar)**             | **Notlar**                        |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Ana bilgisayar adlarÄ± ve IP detaylarÄ± |
| /etc/passwd      | passwd.byname, passwd.byuid | NIS kullanÄ±cÄ± ÅŸifre dosyasÄ±       |
| /etc/group       | group.byname, group.bygid   | NIS grup dosyasÄ±                 |
| /usr/lib/aliases | mail.aliases                | Mail takma adlarÄ± detaylarÄ±       |

## RPC KullanÄ±cÄ±larÄ±

EÄŸer **rusersd** servisini ÅŸu ÅŸekilde bulursanÄ±z:

![](<../.gitbook/assets/image (1041).png>)

Kutu kullanÄ±cÄ±larÄ±nÄ± listeleyebilirsiniz. NasÄ±l yapÄ±lacaÄŸÄ±nÄ± Ã¶ÄŸrenmek iÃ§in [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md) makalesine bakÄ±n.

## FiltrelenmiÅŸ Portmapper portunu atlatma

Bir **nmap taramasÄ±** gerÃ§ekleÅŸtirirken ve port 111'in filtrelendiÄŸi aÃ§Ä±k NFS portlarÄ± keÅŸfettiÄŸinizde, bu portlarÄ±n doÄŸrudan istismar edilmesi mÃ¼mkÃ¼n deÄŸildir. Ancak, **yerel olarak bir portmapper servisi simÃ¼le ederek ve makinenizden hedefe bir tÃ¼nel oluÅŸturarak** istismar mÃ¼mkÃ¼n hale gelir. Bu teknik, port 111'in filtrelenmiÅŸ durumunu atlatmayÄ± saÄŸlar ve bÃ¶ylece NFS hizmetlerine eriÅŸim saÄŸlar. Bu yÃ¶ntemle ilgili ayrÄ±ntÄ±lÄ± rehberlik iÃ§in [bu baÄŸlantÄ±ya](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc) bakÄ±n.

## Shodan

* `Portmap`

## Pratik yapma laboratuvarlarÄ±

* Bu teknikleri [**Irked HTB makinesi**](https://app.hackthebox.com/machines/Irked) Ã¼zerinde pratik yapÄ±n.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HackTricks Otomatik Komutlar
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
