# 111/TCP/UDP - æ¸—é€æµ‹è¯•ç«¯å£æ˜ å°„å™¨

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## åŸºæœ¬ä¿¡æ¯

åœ¨Unixç³»ç»Ÿä¹‹é—´æä¾›ä¿¡æ¯ã€‚è¯¥ç«¯å£ç»å¸¸è¢«æ¢æµ‹ï¼Œå¯ç”¨äºæŒ‡çº¹è¯†åˆ«Nixæ“ä½œç³»ç»Ÿï¼Œå¹¶è·å–æœ‰å…³å¯ç”¨æœåŠ¡çš„ä¿¡æ¯ã€‚è¯¥ç«¯å£ä¸NFSã€NISæˆ–ä»»ä½•åŸºäºrpcçš„æœåŠ¡ä¸€èµ·ä½¿ç”¨ã€‚

**é»˜è®¤ç«¯å£ï¼š** 111/TCP/UDPï¼Œåœ¨Oracle Solarisä¸­ä¸º32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## æšä¸¾

### RPCBind

RPCBindæ˜¯ä¸€ç§è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æœåŠ¡ï¼Œç”¨äºåœ¨ç½‘ç»œä¸Šæ³¨å†Œå’Œè§£æRPCç¨‹åºã€‚å®ƒè¿è¡Œåœ¨TCPå’ŒUDPç«¯å£111ä¸Šã€‚

#### ç«¯å£æ‰«æ

ä½¿ç”¨nmapæ‰«æç›®æ ‡ä¸»æœºçš„111ç«¯å£ï¼Œä»¥ç¡®å®šæ˜¯å¦è¿è¡Œäº†RPCBindæœåŠ¡ã€‚

```plaintext
nmap -p 111 <target_ip>
```

#### åˆ—ä¸¾RPCç¨‹åº

ä½¿ç”¨rpcinfoå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šæ³¨å†Œçš„RPCç¨‹åºã€‚

```plaintext
rpcinfo -p <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„ç«¯å£

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„ç«¯å£ã€‚

```plaintext
rpcbind -p <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„ç¨‹åº

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„ç¨‹åºã€‚

```plaintext
rpcbind -s <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„åœ°å€

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„åœ°å€ã€‚

```plaintext
rpcbind -a <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„ç‰ˆæœ¬

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„ç‰ˆæœ¬ã€‚

```plaintext
rpcbind -v <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„åè®®

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„åè®®ã€‚

```plaintext
rpcbind -u <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„è¶…æ—¶

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„è¶…æ—¶ã€‚

```plaintext
rpcbind -t <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„å®‰å…¨çº§åˆ«

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„å®‰å…¨çº§åˆ«ã€‚

```plaintext
rpcbind -S <target_ip>
```

#### åˆ—ä¸¾ç»‘å®šçš„æ‰€æœ‰ä¿¡æ¯

ä½¿ç”¨rpcbindå‘½ä»¤åˆ—ä¸¾ç›®æ ‡ä¸»æœºä¸Šç»‘å®šçš„æ‰€æœ‰ä¿¡æ¯ã€‚

```plaintext
rpcbind -l <target_ip>
```
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
æœ‰æ—¶å®ƒä¸ä¼šç»™ä½ ä»»ä½•ä¿¡æ¯ï¼Œè€Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ ä¼šå¾—åˆ°åƒè¿™æ ·çš„ä¸œè¥¿ï¼š

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

å¦‚æœä½ æ‰¾åˆ°äº†NFSæœåŠ¡ï¼Œé‚£ä¹ˆä½ å¯èƒ½èƒ½å¤Ÿåˆ—å‡ºå’Œä¸‹è½½ï¼ˆä¹Ÿè®¸è¿˜èƒ½ä¸Šä¼ ï¼‰æ–‡ä»¶ï¼š

![](<../.gitbook/assets/image (232).png>)

é˜…è¯»[2049 - Pentesting NFS service](nfs-service-pentesting.md)ä»¥äº†è§£æ›´å¤šå…³äºå¦‚ä½•æµ‹è¯•è¿™ä¸ªåè®®çš„ä¿¡æ¯ã€‚

## NIS

å¦‚æœä½ å‘ç°`ypbind`æœåŠ¡æ­£åœ¨è¿è¡Œï¼š

![](<../.gitbook/assets/image (233).png>)

ä½ å¯ä»¥å°è¯•åˆ©ç”¨å®ƒã€‚æ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä½ éœ€è¦**çŒœæµ‹æœºå™¨çš„NIS "åŸŸå"**ï¼ˆå½“å®‰è£…äº†NISæ—¶ï¼Œä¼šé…ç½®ä¸€ä¸ª"åŸŸå"ï¼‰ï¼Œ**å¦‚æœä¸çŸ¥é“è¿™ä¸ªåŸŸåï¼Œä½ ä»€ä¹ˆä¹Ÿåšä¸äº†**ã€‚

åœ¨è·å–ç¯å¢ƒçš„NISåŸŸåï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºexample.orgï¼‰ä¹‹åï¼Œä½¿ç”¨ypwhichå‘½ä»¤æ¥ping NISæœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ypcatè·å–æ•æ„Ÿææ–™ã€‚ä½ åº”è¯¥å°†åŠ å¯†çš„å¯†ç å“ˆå¸Œå€¼è¾“å…¥åˆ°John the Ripperä¸­ï¼Œä¸€æ—¦ç ´è§£æˆåŠŸï¼Œå°±å¯ä»¥ç”¨å®ƒæ¥è¯„ä¼°ç³»ç»Ÿè®¿é—®å’Œæƒé™ã€‚
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat â€“d example.org â€“h 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **ä¸»æ–‡ä»¶**      | **æ˜ å°„(s)**                  | **å¤‡æ³¨**                         |
| --------------- | --------------------------- | --------------------------------- |
| /etc/hosts      | hosts.byname, hosts.byaddr  | åŒ…å«ä¸»æœºåå’ŒIPè¯¦ç»†ä¿¡æ¯             |
| /etc/passwd     | passwd.byname, passwd.byuid | NISç”¨æˆ·å¯†ç æ–‡ä»¶                   |
| /etc/group      | group.byname, group.bygid   | NISç»„æ–‡ä»¶                         |
| /usr/lib/aliases| mail.aliases                | è¯¦ç»†çš„é‚®ä»¶åˆ«å                    |

## RPCç”¨æˆ·

å¦‚æœä½ å‘ç°**rusersd**æœåŠ¡åƒè¿™æ ·è¢«åˆ—å‡ºï¼š

![](<../.gitbook/assets/image (231).png>)

ä½ å¯ä»¥æšä¸¾è¯¥ä¸»æœºçš„ç”¨æˆ·ã€‚è¦äº†è§£å¦‚ä½•æ“ä½œï¼Œè¯·é˜…è¯»[1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md)ã€‚

## ç»•è¿‡è¿‡æ»¤çš„Portmapperç«¯å£

å¦‚æœåœ¨nmapæ‰«æä¸­ï¼Œä½ çœ‹åˆ°åƒNFSè¿™æ ·çš„å¼€æ”¾ç«¯å£ï¼Œä½†ç«¯å£111è¢«è¿‡æ»¤ï¼Œä½ å°†æ— æ³•åˆ©ç”¨è¿™äº›ç«¯å£ã€‚\
ä½†æ˜¯ï¼Œå¦‚æœä½ å¯ä»¥åœ¨æœ¬åœ°æ¨¡æ‹Ÿä¸€ä¸ªportmapperæœåŠ¡ï¼Œå¹¶å°†NFSç«¯å£ä»ä½ çš„æœºå™¨éš§é“åˆ°å—å®³è€…çš„æœºå™¨ä¸Šï¼Œä½ å°†èƒ½å¤Ÿä½¿ç”¨å¸¸è§„å·¥å…·æ¥åˆ©ç”¨è¿™äº›æœåŠ¡ã€‚\
æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ[https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## å®è·µå®éªŒå®¤

* åœ¨[**Irked HTBæœºå™¨**](https://app.hackthebox.com/machines/Irked)ä¸Šç»ƒä¹ è¿™äº›æŠ€æœ¯ã€‚

## HackTricksè‡ªåŠ¨å‘½ä»¤
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
