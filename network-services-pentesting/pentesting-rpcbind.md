# 111/TCP/UDP - Pentesting Portmapper

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## åŸºæœ¬æƒ…å ±

**Portmapper**ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒ¼ãƒˆã‚’**RPC**ï¼ˆãƒªãƒ¢ãƒ¼ãƒˆãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚³ãƒ¼ãƒ«ï¼‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ç•ªå·ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ã“ã‚Œã¯ã€**Unixãƒ™ãƒ¼ã‚¹ã®ã‚·ã‚¹ãƒ†ãƒ **ã«ãŠã„ã¦é‡è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦æ©Ÿèƒ½ã—ã€ã“ã‚Œã‚‰ã®ã‚·ã‚¹ãƒ†ãƒ é–“ã®æƒ…å ±äº¤æ›ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚**Portmapper**ã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸ**ãƒãƒ¼ãƒˆ**ã¯ã€æ”»æ’ƒè€…ã«ã‚ˆã£ã¦é »ç¹ã«ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã€è²´é‡ãªæƒ…å ±ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æƒ…å ±ã«ã¯ã€å®Ÿè¡Œä¸­ã®**Unixã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ï¼ˆOSï¼‰**ã®ç¨®é¡ã‚„ã€ã‚·ã‚¹ãƒ†ãƒ ä¸Šã§åˆ©ç”¨å¯èƒ½ãªã‚µãƒ¼ãƒ“ã‚¹ã®è©³ç´°ãŒå«ã¾ã‚Œã¾ã™ã€‚ã•ã‚‰ã«ã€**Portmapper**ã¯ã€**NFSï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼‰**ã€**NISï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æƒ…å ±ã‚µãƒ¼ãƒ“ã‚¹ï¼‰**ã€ãŠã‚ˆã³ä»–ã®**RPCãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹**ã¨å…±ã«ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚’åŠ¹æœçš„ã«ç®¡ç†ã™ã‚‹ãŸã‚ã«ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 111/TCP/UDPã€Oracle Solarisã§ã¯32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## åˆ—æŒ™
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
æ™‚ã«ã¯ä½•ã®æƒ…å ±ã‚‚å¾—ã‚‰ã‚Œãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€ä»–ã®å ´é¢ã§ã¯æ¬¡ã®ã‚ˆã†ãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼š

![](<../.gitbook/assets/image (553).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

ã‚µãƒ¼ãƒ“ã‚¹NFSã‚’è¦‹ã¤ã‘ãŸå ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¹ãƒˆã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆãã—ã¦å ´åˆã«ã‚ˆã£ã¦ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

![](<../.gitbook/assets/image (872).png>)

ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[2049 - Pentesting NFS service](nfs-service-pentesting.md)ã‚’ãŠèª­ã¿ãã ã•ã„ã€‚

## NIS

**NIS**ã®è„†å¼±æ€§ã‚’æ¢ã‚‹ã«ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹`ypbind`ã®ç‰¹å®šã‹ã‚‰å§‹ã¾ã‚‹äºŒæ®µéšã®ãƒ—ãƒ­ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚ã“ã®æ¢æ±‚ã®åŸºç›¤ã¯ã€**NISãƒ‰ãƒ¡ã‚¤ãƒ³å**ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹ã“ã¨ã§ã‚ã‚Šã€ã“ã‚ŒãŒãªã‘ã‚Œã°é€²å±•ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

![](<../.gitbook/assets/image (859).png>)

æ¢æ±‚ã®æ—…ã¯ã€å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ`apt-get install nis`ï¼‰ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€`ypwhich`ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨ã‚µãƒ¼ãƒãƒ¼IPã§pingã‚’é€ã‚Šã€NISã‚µãƒ¼ãƒãƒ¼ã®å­˜åœ¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¦ç´ ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã«åŒ¿ååŒ–ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

æœ€å¾Œã®é‡è¦ãªã‚¹ãƒ†ãƒƒãƒ—ã¯ã€`ypcat`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹ã«æš—å·åŒ–ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚‰ã®ãƒãƒƒã‚·ãƒ¥ã¯ã€**John the Ripper**ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦è§£èª­ã•ã‚Œã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚»ã‚¹ã‚„æ¨©é™ã«é–¢ã™ã‚‹æ´å¯Ÿã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã™ã€‚
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat â€“d <domain-name> â€“h <server-ip> passwd.byname
```
### NIFãƒ•ã‚¡ã‚¤ãƒ«

| **ãƒã‚¹ã‚¿ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«**  | **ãƒãƒƒãƒ—**                  | **ãƒãƒ¼ãƒˆ**                         |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | ãƒ›ã‚¹ãƒˆåã¨IPã®è©³ç´°ã‚’å«ã‚€          |
| /etc/passwd      | passwd.byname, passwd.byuid | NISãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«      |
| /etc/group       | group.byname, group.bygid   | NISã‚°ãƒ«ãƒ¼ãƒ—ãƒ•ã‚¡ã‚¤ãƒ«                |
| /usr/lib/aliases | mail.aliases                | ãƒ¡ãƒ¼ãƒ«ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®è©³ç´°            |

## RPCãƒ¦ãƒ¼ã‚¶ãƒ¼

**rusersd**ã‚µãƒ¼ãƒ“ã‚¹ãŒæ¬¡ã®ã‚ˆã†ã«ãƒªã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹å ´åˆï¼š

![](<../.gitbook/assets/image (1041).png>)

ãƒœãƒƒã‚¯ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ–¹æ³•ã‚’å­¦ã¶ã«ã¯ã€[1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒãƒ¼ãƒˆãƒãƒƒãƒ‘ãƒ¼ãƒãƒ¼ãƒˆã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹

**nmapã‚¹ã‚­ãƒ£ãƒ³**ã‚’å®Ÿæ–½ã—ã€ãƒãƒ¼ãƒˆ111ãŒãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³NFSãƒãƒ¼ãƒˆã‚’ç™ºè¦‹ã—ãŸå ´åˆã€ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã‚’ç›´æ¥æ‚ªç”¨ã™ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã™ã€‚ã—ã‹ã—ã€**ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒãƒ¼ãƒˆãƒãƒƒãƒ‘ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã€ã‚ãªãŸã®ãƒã‚·ãƒ³ã‹ã‚‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¸ã®ãƒˆãƒ³ãƒãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Š**ã€æ¨™æº–ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦æ‚ªç”¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã®æŠ€è¡“ã«ã‚ˆã‚Šã€ãƒãƒ¼ãƒˆ111ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã€NFSã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã®æ–¹æ³•ã®è©³ç´°ãªã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã«ã¤ã„ã¦ã¯ã€[ã“ã®ãƒªãƒ³ã‚¯](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)ã«ã‚ã‚‹è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## Shodan

* `Portmap`

## å®Ÿè·µç”¨ãƒ©ãƒœ

* [**Irked HTBãƒã‚·ãƒ³**](https://app.hackthebox.com/machines/Irked)ã§ã“ã‚Œã‚‰ã®æŠ€è¡“ã‚’ç·´ç¿’ã—ã¦ãã ã•ã„ã€‚

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HackTricksè‡ªå‹•ã‚³ãƒãƒ³ãƒ‰
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
