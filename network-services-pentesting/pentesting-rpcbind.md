# 111/TCP/UDP - æ¸—é€æµ‹è¯•Portmapper

<details>

<summary><strong>é€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

åœ¨åŸºäºUnixçš„ç³»ç»Ÿä¹‹é—´æä¾›ä¿¡æ¯ã€‚è¯¥ç«¯å£ç»å¸¸è¢«æ¢æµ‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¯†åˆ«Nixæ“ä½œç³»ç»Ÿï¼Œå¹¶è·å–æœ‰å…³å¯ç”¨æœåŠ¡çš„ä¿¡æ¯ã€‚ä¸NFSã€NISæˆ–ä»»ä½•åŸºäºrpcçš„æœåŠ¡ä¸€èµ·ä½¿ç”¨çš„ç«¯å£ã€‚

**é»˜è®¤ç«¯å£ï¼š** 111/TCP/UDPï¼ŒOracle Solarisä¸­ä¸º32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## æšä¸¾
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
æœ‰æ—¶å®ƒä¸ä¼šç»™ä½ ä»»ä½•ä¿¡æ¯ï¼Œå…¶ä»–æ—¶å€™ä½ å¯èƒ½ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœï¼š

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

å¦‚æœä½ å‘ç°äº†NFSæœåŠ¡ï¼Œé‚£ä¹ˆä½ å¯èƒ½èƒ½å¤Ÿåˆ—å‡ºå’Œä¸‹è½½ï¼ˆä¹Ÿè®¸è¿˜èƒ½ä¸Šä¼ ï¼‰æ–‡ä»¶ï¼š

![](<../.gitbook/assets/image (232).png>)

é˜…è¯»[2049 - æµ‹è¯•NFSæœåŠ¡](nfs-service-pentesting.md)ä»¥äº†è§£å¦‚ä½•æµ‹è¯•è¿™ä¸ªåè®®ã€‚

## NIS

å¦‚æœä½ å‘ç°`ypbind`æœåŠ¡æ­£åœ¨è¿è¡Œï¼š

![](<../.gitbook/assets/image (233).png>)

ä½ å¯ä»¥å°è¯•åˆ©ç”¨å®ƒã€‚æ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä½ **éœ€è¦çŒœæµ‹æœºå™¨çš„NISâ€œåŸŸåâ€**ï¼ˆå®‰è£…NISæ—¶ä¼šé…ç½®ä¸€ä¸ªâ€œåŸŸåâ€ï¼‰ï¼Œ**å¦‚æœä¸çŸ¥é“è¿™ä¸ªåŸŸåï¼Œä½ å°†æ— æ³•åšä»»ä½•äº‹æƒ…**ã€‚

è·å–åˆ°ç¯å¢ƒçš„NISåŸŸåï¼ˆä¾‹å¦‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æ˜¯example.orgï¼‰ï¼Œä½¿ç”¨ypwhichå‘½ä»¤æ¥ping NISæœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ypcatæ¥è·å–æ•æ„Ÿææ–™ã€‚ä½ åº”è¯¥å°†åŠ å¯†çš„å¯†ç å“ˆå¸Œè¾“å…¥åˆ°John the Ripperä¸­ï¼Œä¸€æ—¦ç ´è§£ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯„ä¼°ç³»ç»Ÿè®¿é—®å’Œæƒé™ã€‚
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat â€“d example.org â€“h 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **ä¸»æ–‡ä»¶**        | **æ˜ å°„**                     | **å¤‡æ³¨**                             |
| ---------------- | --------------------------- | ------------------------------------ |
| /etc/hosts       | hosts.byname, hosts.byaddr  | åŒ…å«ä¸»æœºåå’ŒIPè¯¦æƒ…                   |
| /etc/passwd      | passwd.byname, passwd.byuid | NISç”¨æˆ·å¯†ç æ–‡ä»¶                      |
| /etc/group       | group.byname, group.bygid   | NISç»„æ–‡ä»¶                            |
| /usr/lib/aliases | mail.aliases                | é‚®ä»¶åˆ«åè¯¦æƒ…                         |

## RPC ç”¨æˆ·

å¦‚æœä½ å‘ç°åˆ—è¡¨ä¸­æœ‰ **rusersd** æœåŠ¡åƒè¿™æ ·ï¼š

![](<../.gitbook/assets/image (231).png>)

ä½ å¯ä»¥æšä¸¾è¯¥è®¾å¤‡çš„ç”¨æˆ·ã€‚è¦äº†è§£å¦‚ä½•æ“ä½œï¼Œè¯·é˜…è¯» [1026 - RPCç”¨æˆ·æšä¸¾](1026-pentesting-rusersd.md)ã€‚

## ç»•è¿‡è¿‡æ»¤çš„Portmapperç«¯å£

å¦‚æœåœ¨nmapæ‰«æä¸­ä½ çœ‹åˆ°åƒNFSè¿™æ ·çš„å¼€æ”¾ç«¯å£ï¼Œä½†æ˜¯ç«¯å£111è¢«è¿‡æ»¤äº†ï¼Œä½ å°†æ— æ³•åˆ©ç”¨è¿™äº›ç«¯å£ã€‚\
ä½†æ˜¯ï¼Œå¦‚æœä½ èƒ½åœ¨æœ¬åœ°æ¨¡æ‹Ÿä¸€ä¸ªportmapperæœåŠ¡ï¼Œå¹¶å°†NFSç«¯å£ä»ä½ çš„æœºå™¨éš§é“åˆ°å—å®³è€…æœºå™¨ï¼Œä½ å°†èƒ½å¤Ÿä½¿ç”¨å¸¸è§„å·¥å…·æ¥åˆ©ç”¨è¿™äº›æœåŠ¡ã€‚\
æ›´å¤šä¿¡æ¯è¯·å‚é˜… [https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## å®éªŒå®¤ç»ƒä¹ 

* åœ¨ [**Irked HTBæœºå™¨**](https://app.hackthebox.com/machines/Irked) ä¸Šç»ƒä¹ è¿™äº›æŠ€æœ¯ã€‚

## HackTricksè‡ªåŠ¨å‘½ä»¤
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´è‡³æˆä¸ºä¸“å®¶ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“**æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
