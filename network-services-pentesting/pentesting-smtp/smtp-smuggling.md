# SMTP Smuggling

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Î‘Ï…Ï„ÏŒÏ‚ Î¿ Ï„ÏÏ€Î¿Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ Î±Î½Î±ÎºÎ±Î»ÏÏ†Î¸Î·ÎºÎµ [**Î±ÏÏ‡Î¹ÎºÎ¬ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ·**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) ÏŒÏ€Î¿Ï… ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ ÎºÎ±Î½ÎµÎ¯Ï‚ Ï„Î¹Ï‚ Î´Î¹Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÏ„Î¿Î½ Ï„ÏÏŒÏ€Î¿ Ï€Î¿Ï… ÎµÏÎ¼Î·Î½ÎµÏÎµÏ„Î±Î¹ Ï„Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ SMTP** ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ email, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± emails ÏƒÏ„Î¿ ÏƒÏÎ¼Î± Ï„Î¿Ï… Î½ÏŒÎ¼Î¹Î¼Î¿Ï…, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Ï„Î±Ï…Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¬Î»Î»Ï‰Î½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Ï„Î¿Ï… ÎµÏ€Î·ÏÎµÎ±Î¶ÏŒÎ¼ÎµÎ½Î¿Ï… Ï„Î¿Î¼Î­Î± (ÏŒÏ€Ï‰Ï‚ admin@outlook.com) Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Î¬Î¼Ï…Î½ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ SPF.

### Why

Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® ÏƒÏ„Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ SMTP, Ï„Î± **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚** Ï€Î¿Ï… Î¸Î± ÏƒÏ„Î±Î»ÎµÎ¯ ÏƒÏ„Î¿ email ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· (ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿) Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÎµÎ¹Î´Î¹ÎºÎ¬ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÎ¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Ï‚ Ï„Î¹Ï‚ Î´Î¹Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÏ„Î¿Ï…Ï‚ Î±Î½Î±Î»Ï…Ï„Î­Ï‚ Ï€Î¿Ï… Î¸Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Ï…Î½ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ emails ÏƒÏ„Î¿Î½ Ï€Î±ÏÎ±Î»Î®Ï€Ï„Î·. Î¡Î¯Î¾Ï„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎµÎ¹ÎºÎ¿Î½Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Î±Î½Î¬ÏÏ„Î·ÏƒÎ·:

<figure><img src="../../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### How

Î“Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¿ **Outbound SMTP server Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î¼ÏŒÎ½Î¿ 1 email Î±Î»Î»Î¬ Î¿ Inbound SMTP server Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬ emails**.

ÎŸÎ¹ ÎµÏÎµÏ…Î½Î·Ï„Î­Ï‚ Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ±Î½ ÏŒÏ„Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿Î¯ **Inbound servers Î¸ÎµÏ‰ÏÎ¿ÏÎ½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ Ï‰Ï‚ Ï„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½** Ï„Î¿Ï… Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ email Ï€Î¿Ï… Î¿Î¹ Outbound servers Î´ÎµÎ½ Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î½.\
Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î­Î½Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÏŒ Ï„Î­Î»Î¿Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎµÎ¯Î½Î±Î¹ `\r\n.\r`. Î‘Î»Î»Î¬ Î±Î½ Î¿ Inbound SMTP server Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ `\n.`, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î±Ï€Î»Î¬ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ **Î±Ï…Ï„Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ email Ï„Î¿Ï… ÎºÎ±Î¹ Î½Î± Î±ÏÏ‡Î¯ÏƒÎµÎ¹ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï„Î¹Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ SMTP** ÎµÎ½ÏŒÏ‚ Î½Î­Î¿Ï… Î³Î¹Î± Î½Î± Ï„Î¿ Î¼ÎµÏ„Î±Ï†Î­ÏÎµÎ¹ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ¹ÎºÏŒÎ½Î±.

Î¦Ï…ÏƒÎ¹ÎºÎ¬, Î±Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼ÏŒÎ½Î¿ Î±Î½ Î¿ **Outbound SMTP server Î´ÎµÎ½ Î¸ÎµÏ‰ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î±Ï…Ï„Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** Ï‰Ï‚ Ï„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï… Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚, Î³Î¹Î±Ï„Î¯ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¸Î± Î´ÎµÎ¹ 2 emails Î±Î½Ï„Î¯ Î³Î¹Î± 1, Î¿Ï€ÏŒÏ„Îµ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Î±Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î· Î±Ï€Î¿ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï€Î¿Ï… ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.

Î Î¹Î¸Î±Î½Î¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€Î¿ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï:

* `\n.`
* `\n.\r`

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÏŒÏ„Î¹ Ï„Î¿ SPF Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÏ„Î±Î¹ Î³Î¹Î±Ï„Î¯ Î±Î½ Î¼ÎµÏ„Î±Ï†Î­ÏÎµÏ„Îµ Î­Î½Î± email Î±Ï€ÏŒ `admin@outlook.com` Î±Ï€ÏŒ Î­Î½Î± email Î±Ï€ÏŒ `user@outlook.com`, **Î¿ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î­Î±Ï‚ ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± `outlook.com`.**

## **References**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
