# SMTP Smuggling

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

è¿™ç§ç±»å‹çš„æ¼æ´æœ€åˆæ˜¯åœ¨ [**è¿™ç¯‡æ–‡ç« ä¸­å‘ç°çš„**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)ï¼Œæ–‡ä¸­è§£é‡Šäº†åœ¨å®Œæˆç”µå­é‚®ä»¶æ—¶ï¼Œ**åˆ©ç”¨ SMTP åè®®è§£é‡Šçš„å·®å¼‚è¿›è¡Œæ”»å‡»**æ˜¯å¯èƒ½çš„ï¼Œè¿™å…è®¸æ”»å‡»è€…åœ¨åˆæ³•é‚®ä»¶çš„æ­£æ–‡ä¸­èµ°ç§æ›´å¤šé‚®ä»¶ï¼Œä»è€Œå†’å……å—å½±å“åŸŸçš„å…¶ä»–ç”¨æˆ·ï¼ˆä¾‹å¦‚ admin@outlook.comï¼‰ï¼Œç»•è¿‡ SPF ç­‰é˜²å¾¡æªæ–½ã€‚

### ä¸ºä»€ä¹ˆ

è¿™æ˜¯å› ä¸ºåœ¨ SMTP åè®®ä¸­ï¼Œ**è¦å‘é€çš„é‚®ä»¶æ•°æ®**ç”±ç”¨æˆ·ï¼ˆæ”»å‡»è€…ï¼‰æ§åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ç‰¹åˆ«æ„é€ çš„æ•°æ®ï¼Œåˆ©ç”¨è§£æå™¨ä¹‹é—´çš„å·®å¼‚ï¼Œåœ¨æ¥æ”¶æ–¹èµ°ç§é¢å¤–çš„é‚®ä»¶ã€‚è¯·æŸ¥çœ‹åŸå§‹æ–‡ç« ä¸­çš„è¿™ä¸ªç¤ºä¾‹ï¼š

<figure><img src="../../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### å¦‚ä½•

ä¸ºäº†åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦å‘é€ä¸€äº›æ•°æ®ï¼Œä½¿å¾—**å‡ºç«™ SMTP æœåŠ¡å™¨è®¤ä¸ºè¿™åªæ˜¯ 1 å°é‚®ä»¶ï¼Œä½†å…¥ç«™ SMTP æœåŠ¡å™¨è®¤ä¸ºæœ‰å¤šå°é‚®ä»¶**ã€‚

ç ”ç©¶äººå‘˜å‘ç°ï¼Œä¸åŒçš„**å…¥ç«™æœåŠ¡å™¨å°†ä¸åŒçš„å­—ç¬¦è§†ä¸ºé‚®ä»¶æ¶ˆæ¯æ•°æ®çš„ç»“æŸ**ï¼Œè€Œå‡ºç«™æœåŠ¡å™¨åˆ™ä¸è¿™æ ·è®¤ä¸ºã€‚\
ä¾‹å¦‚ï¼Œå¸¸è§„çš„æ•°æ®ç»“æŸæ˜¯ `\r\n.\r`ã€‚ä½†æ˜¯ï¼Œå¦‚æœå…¥ç«™ SMTP æœåŠ¡å™¨ä¹Ÿæ”¯æŒ `\n.`ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨å…¶é‚®ä»¶ä¸­æ·»åŠ **è¯¥æ•°æ®ï¼Œå¹¶å¼€å§‹æŒ‡ç¤ºæ–°çš„ SMTP å‘½ä»¤**ä»¥èµ°ç§å®ƒï¼Œå°±åƒåœ¨å‰é¢çš„å›¾åƒä¸­ä¸€æ ·ã€‚

å½“ç„¶ï¼Œè¿™åªæœ‰åœ¨**å‡ºç«™ SMTP æœåŠ¡å™¨ä¹Ÿä¸å°†è¿™äº›æ•°æ®è§†ä¸ºæ¶ˆæ¯æ•°æ®çš„ç»“æŸ**æ—¶æ‰æœ‰æ•ˆï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†çœ‹åˆ° 2 å°é‚®ä»¶è€Œä¸æ˜¯ 1 å°ï¼Œå› æ­¤æœ€ç»ˆè¿™æ˜¯åœ¨æ­¤æ¼æ´ä¸­è¢«åˆ©ç”¨çš„ä¸åŒæ­¥ã€‚

æ½œåœ¨çš„ä¸åŒæ­¥æ•°æ®ï¼š

* `\n.`
* `\n.\r`

è¿˜è¦æ³¨æ„ï¼ŒSPF è¢«ç»•è¿‡ï¼Œå› ä¸ºå¦‚æœä½ ä» `user@outlook.com` èµ°ç§ä¸€å°æ¥è‡ª `admin@outlook.com` çš„é‚®ä»¶ï¼Œ**å‘ä»¶äººä»ç„¶æ˜¯ `outlook.com`ã€‚**

## **å‚è€ƒæ–‡çŒ®**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
