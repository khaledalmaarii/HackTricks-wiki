# SMTP Smuggling

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

Bu tÃ¼r bir zafiyet [**bu yazÄ±da ilk olarak keÅŸfedilmiÅŸtir**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) ve burada, bir e-postayÄ± tamamlarken SMTP protokolÃ¼nÃ¼n nasÄ±l yorumlandÄ±ÄŸÄ±ndaki farklÄ±lÄ±klarÄ±n **istismar edilebileceÄŸi** aÃ§Ä±klanmaktadÄ±r. Bu, bir saldÄ±rganÄ±n, etkilenen alanÄ±n diÄŸer kullanÄ±cÄ±larÄ±nÄ± (Ã¶rneÄŸin admin@outlook.com) taklit ederek, meÅŸru bir e-postanÄ±n gÃ¶vdesinde daha fazla e-posta gizlemesine olanak tanÄ±r ve SPF gibi savunmalarÄ± aÅŸar.

### Neden

Bu, SMTP protokolÃ¼nde, e-postada gÃ¶nderilecek **mesaj verisinin** bir kullanÄ±cÄ± (saldÄ±rgan) tarafÄ±ndan kontrol edilmesindendir; bu kullanÄ±cÄ±, alÄ±cÄ±da ekstra e-postalar gizlemek iÃ§in ayrÄ±ÅŸtÄ±rÄ±cÄ±lardaki farklÄ±lÄ±klarÄ± istismar eden Ã¶zel olarak hazÄ±rlanmÄ±ÅŸ veriler gÃ¶nderebilir. Ä°ÅŸte orijinal yazÄ±dan bir Ã¶rnek:

<figure><img src="../../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### NasÄ±l

Bu zafiyeti istismar etmek iÃ§in bir saldÄ±rgan, **Ã‡Ä±kÄ±ÅŸ SMPT sunucusunun sadece 1 e-posta olduÄŸunu dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼ ancak GiriÅŸ SMTP sunucusunun birden fazla e-posta olduÄŸunu dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼** bazÄ± veriler gÃ¶ndermelidir.

AraÅŸtÄ±rmacÄ±lar, farklÄ± **GiriÅŸ sunucularÄ±nÄ±n e-posta mesajÄ±nÄ±n verisinin sonunu farklÄ± karakterler olarak deÄŸerlendirdiÄŸini** keÅŸfettiler; Ã‡Ä±kÄ±ÅŸ sunucularÄ±nÄ±n ise bunu yapmadÄ±ÄŸÄ±nÄ±.\
Ã–rneÄŸin, verinin normal sonu `\r\n.\r`'dir. Ancak, GiriÅŸ SMTP sunucusu `\n.`'yi de destekliyorsa, bir saldÄ±rgan **bu veriyi e-postasÄ±na ekleyebilir ve yeni e-postalarÄ± gizlemek iÃ§in SMTP komutlarÄ±nÄ± gÃ¶stermeye baÅŸlayabilir**; tÄ±pkÄ± Ã¶nceki resimde olduÄŸu gibi.

Tabii ki, bu yalnÄ±zca **Ã‡Ä±kÄ±ÅŸ SMTP sunucusu bu veriyi** mesaj verisinin sonu olarak deÄŸerlendirmediÄŸi takdirde Ã§alÄ±ÅŸabilir; Ã§Ã¼nkÃ¼ bu durumda 1 yerine 2 e-posta gÃ¶recektir, bu nedenle sonunda bu, bu zafiyette istismar edilen senkronizasyon bozukluÄŸudur.

Potansiyel senkronizasyon bozukluÄŸu verileri:

* `\n.`
* `\n.\r`

AyrÄ±ca, SPF'nin aÅŸÄ±ldÄ±ÄŸÄ±nÄ± unutmayÄ±n; Ã§Ã¼nkÃ¼ `user@outlook.com`'dan `admin@outlook.com`'a bir e-posta gizlerseniz, **gÃ¶nderen hala `outlook.com`'dur.**

## **Referanslar**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
