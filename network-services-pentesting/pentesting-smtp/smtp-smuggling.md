# SMTP Smuggling

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

ã“ã®ã‚¿ã‚¤ãƒ—ã®è„†å¼±æ€§ã¯ã€[**ã“ã®æŠ•ç¨¿ã§æœ€åˆã«ç™ºè¦‹ã•ã‚Œã¾ã—ãŸ**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)ã€‚ã“ã“ã§ã¯ã€ãƒ¡ãƒ¼ãƒ«ã‚’æœ€çµ‚çš„ã«é€ä¿¡ã™ã‚‹éš›ã®SMTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®è§£é‡ˆã®é•ã„ã‚’**æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹**ã¨èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯æ­£å½“ãªãƒ¡ãƒ¼ãƒ«ã®æœ¬æ–‡ã«ä»–ã®ãƒ¡ãƒ¼ãƒ«ã‚’å¯†è¼¸ã—ã€å½±éŸ¿ã‚’å—ã‘ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆä¾‹ãˆã°ã€admin@outlook.comï¼‰ã‚’å½è£…ã™ã‚‹ã“ã¨ãŒã§ãã€SPFãªã©ã®é˜²å¾¡ã‚’å›é¿ã—ã¾ã™ã€‚

### ãªãœ

ã“ã‚Œã¯ã€SMTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã¯ã€ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã•ã‚Œã‚‹**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿**ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆæ”»æ’ƒè€…ï¼‰ã«ã‚ˆã£ã¦åˆ¶å¾¡ã•ã‚Œã¦ãŠã‚Šã€ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€å—ä¿¡è€…ã«è¿½åŠ ã®ãƒ¡ãƒ¼ãƒ«ã‚’å¯†è¼¸ã™ã‚‹ãŸã‚ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã®é•ã„ã‚’æ‚ªç”¨ã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚å…ƒã®æŠ•ç¨¿ã‹ã‚‰ã®ã“ã®å›³è§£ä¾‹ã‚’è¦‹ã¦ãã ã•ã„ï¼š

<figure><img src="../../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### ã©ã®ã‚ˆã†ã«

ã“ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ã€æ”»æ’ƒè€…ã¯**Outbound SMTPã‚µãƒ¼ãƒãƒ¼ãŒ1é€šã®ãƒ¡ãƒ¼ãƒ«ã ã¨è€ƒãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã€Inbound SMTPã‚µãƒ¼ãƒãƒ¼ãŒè¤‡æ•°ã®ãƒ¡ãƒ¼ãƒ«ãŒã‚ã‚‹ã¨è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚

ç ”ç©¶è€…ãŸã¡ã¯ã€ç•°ãªã‚‹**Inboundã‚µãƒ¼ãƒãƒ¼ãŒãƒ¡ãƒ¼ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã®çµ‚ã‚ã‚Šã¨ã—ã¦ç•°ãªã‚‹æ–‡å­—ã‚’è€ƒæ…®ã™ã‚‹**ã“ã¨ã‚’ç™ºè¦‹ã—ã¾ã—ãŸãŒã€Outboundã‚µãƒ¼ãƒãƒ¼ã¯ãã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\
ä¾‹ãˆã°ã€ãƒ‡ãƒ¼ã‚¿ã®é€šå¸¸ã®çµ‚ã‚ã‚Šã¯`\r\n.\r`ã§ã™ã€‚ã—ã‹ã—ã€Inbound SMTPã‚µãƒ¼ãƒãƒ¼ãŒ`\n.`ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯**ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¼ãƒ«ã«è¿½åŠ ã—ã€æ–°ã—ã„ãƒ¡ãƒ¼ãƒ«ã®SMTPã‚³ãƒãƒ³ãƒ‰ã‚’ç¤ºã—å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚å‰ã®ç”»åƒã®ã‚ˆã†ã«å¯†è¼¸ã™ã‚‹ãŸã‚ã«ã€‚

ã‚‚ã¡ã‚ã‚“ã€ã“ã‚Œã¯**Outbound SMTPã‚µãƒ¼ãƒãƒ¼ãŒã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®çµ‚ã‚ã‚Šã¨ã—ã¦æ‰±ã‚ãªã„å ´åˆã«ã®ã¿æ©Ÿèƒ½ã—ã¾ã™**ã€‚ãã†ã§ãªã„å ´åˆã€1é€šã§ã¯ãªã2é€šã®ãƒ¡ãƒ¼ãƒ«ã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ãŸã‚ã€æœ€çµ‚çš„ã«ã¯ã“ã®è„†å¼±æ€§ã§æ‚ªç”¨ã•ã‚Œã‚‹éåŒæœŸåŒ–ãŒç™ºç”Ÿã—ã¾ã™ã€‚

æ½œåœ¨çš„ãªéåŒæœŸåŒ–ãƒ‡ãƒ¼ã‚¿ï¼š

* `\n.`
* `\n.\r`

ã¾ãŸã€SPFãŒå›é¿ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãªãœãªã‚‰ã€`user@outlook.com`ã‹ã‚‰`admin@outlook.com`ã®ãƒ¡ãƒ¼ãƒ«ã‚’å¯†è¼¸ã™ã‚‹ã¨ã€**é€ä¿¡è€…ã¯ä¾ç„¶ã¨ã—ã¦`outlook.com`ã ã‹ã‚‰ã§ã™ã€‚**

## **å‚è€ƒæ–‡çŒ®**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
