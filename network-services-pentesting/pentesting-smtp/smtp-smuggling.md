# SMTP Smuggling

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ [**‡§á‡§∏ ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§Æ‡•Ç‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ñ‡•ã‡§ú‡•Ä ‡§ó‡§à ‡§•‡•Ä**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) ‡§ú‡§π‡§æ‡§Ç ‡§Ø‡§π ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§ï‡§ø ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∞‡•Ç‡§™ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§∏‡§Æ‡§Ø SMTP ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤ ‡§ï‡•Ä ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§Æ‡§æ‡§®‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ **‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à**, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•ã ‡§µ‡•à‡§ß ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•á ‡§∂‡§∞‡•Ä‡§∞ ‡§Æ‡•á‡§Ç ‡§Ö‡§ß‡§ø‡§ï ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§∏‡•ç‡§Æ‡§ó‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§ ‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç (‡§ú‡•à‡§∏‡•á admin@outlook.com) ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§ï‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, SPF ‡§ú‡•à‡§∏‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è‡•§

### Why

‡§Ø‡§π ‡§á‡§∏ ‡§ï‡§æ‡§∞‡§£ ‡§∏‡•á ‡§π‡•à ‡§ï‡§ø SMTP ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤ ‡§Æ‡•á‡§Ç, ‡§à‡§Æ‡•á‡§≤ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á **‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ** ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ (‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§™‡§æ‡§∞‡•ç‡§∏‡§∞‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§≠‡§ø‡§®‡•ç‡§®‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§∞‡§ø‡§∏‡•á‡§™‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§∏‡•ç‡§Æ‡§ó‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§á‡§∏ ‡§Æ‡•Ç‡§≤ ‡§™‡•ã‡§∏‡•ç‡§ü ‡§∏‡•á ‡§á‡§∏ ‡§ö‡§ø‡§§‡•ç‡§∞‡§ø‡§§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§™‡§∞ ‡§è‡§ï ‡§®‡§ú‡§º‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç:

<figure><img src="../../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### How

‡§á‡§∏ ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•ã ‡§ï‡•Å‡§õ ‡§°‡•á‡§ü‡§æ ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡§ø‡§∏‡•á **‡§Ü‡§â‡§ü‡§¨‡§æ‡§â‡§Ç‡§° SMTP ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•á‡§µ‡§≤ 1 ‡§à‡§Æ‡•á‡§≤ ‡§∏‡§Æ‡§ù‡§§‡§æ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§á‡§®‡§¨‡§æ‡§â‡§Ç‡§° SMTP ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡•ã‡§ö‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§ï‡§à ‡§à‡§Æ‡•á‡§≤ ‡§π‡•à‡§Ç**‡•§

‡§∂‡•ã‡§ß‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§®‡•á ‡§ñ‡•ã‡§ú‡§æ ‡§ï‡§ø ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® **‡§á‡§®‡§¨‡§æ‡§â‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§µ‡§∞‡•ç‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§à‡§Æ‡•á‡§≤ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç** ‡§ú‡•ã ‡§Ü‡§â‡§ü‡§¨‡§æ‡§â‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á‡•§\
‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§°‡•á‡§ü‡§æ ‡§ï‡§æ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§Ö‡§Ç‡§§ `\r\n.\r` ‡§π‡•à‡•§ ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§¶‡§ø ‡§á‡§®‡§¨‡§æ‡§â‡§Ç‡§° SMTP ‡§∏‡§∞‡•ç‡§µ‡§∞ `\n.` ‡§ï‡§æ ‡§≠‡•Ä ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§¨‡§∏ **‡§â‡§∏ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§à‡§Æ‡•á‡§≤ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§®‡§è ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§∏‡•ç‡§Æ‡§ó‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è SMTP ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à** ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç‡•§

‡§¨‡•á‡§∂‡§ï, ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§§‡§≠‡•Ä ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§Ø‡§¶‡§ø **‡§Ü‡§â‡§ü‡§¨‡§æ‡§â‡§Ç‡§° SMTP ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§á‡§∏ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã** ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§°‡•á‡§ü‡§æ ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§æ‡§®‡§§‡§æ ‡§π‡•à, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§â‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ 1 ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø 2 ‡§à‡§Æ‡•á‡§≤ ‡§¶‡•á‡§ñ‡•á‡§ó‡§æ, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§Ö‡§∏‡§Ç‡§ó‡§§‡§ø ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§á‡§∏ ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§Æ‡•á‡§Ç ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§

‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§Ö‡§∏‡§Ç‡§ó‡§§‡§ø ‡§°‡•á‡§ü‡§æ:

* `\n.`
* `\n.\r`

‡§Ø‡§π ‡§≠‡•Ä ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø SPF ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§¶‡§ø ‡§Ü‡§™ `admin@outlook.com` ‡§∏‡•á `user@outlook.com` ‡§ï‡•á ‡§à‡§Æ‡•á‡§≤ ‡§∏‡•á ‡§è‡§ï ‡§à‡§Æ‡•á‡§≤ ‡§∏‡•ç‡§Æ‡§ó‡§≤ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã **‡§™‡•ç‡§∞‡•á‡§∑‡§ï ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä `outlook.com` ‡§π‡•à‡•§**

## **References**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
