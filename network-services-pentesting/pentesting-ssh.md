# 22 - SSH/SFTP Pentesting

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

EÄŸer **hacking kariyeri** ile ilgileniyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± polonyaca yazÄ±lÄ± ve konuÅŸma becerisi gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

## Temel Bilgiler

**SSH (Secure Shell veya Secure Socket Shell)**, gÃ¼vensiz bir aÄŸ Ã¼zerinden bir bilgisayara gÃ¼venli bir baÄŸlantÄ± saÄŸlayan bir aÄŸ protokolÃ¼dÃ¼r. Uzak sistemlere eriÅŸirken verilerin gizliliÄŸini ve bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ korumak iÃ§in Ã¶nemlidir.

**VarsayÄ±lan port:** 22
```
22/tcp open  ssh     syn-ack
```
**SSH sunucularÄ±:**

* [openSSH](http://www.openssh.org) - BSD, Linux daÄŸÄ±tÄ±mlarÄ±nda ve Windows 10'dan beri Windows'ta bulunan OpenBSD SSH
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) - DÃ¼ÅŸÃ¼k bellek ve iÅŸlemci kaynaklarÄ±na sahip ortamlar iÃ§in SSH uygulamasÄ±, OpenWrt ile birlikte geliyor
* [PuTTY](https://www.chiark.greenend.org.uk/\~sgtatham/putty/) - Windows iÃ§in SSH uygulamasÄ±, istemci genellikle kullanÄ±lÄ±rken sunucunun kullanÄ±mÄ± daha nadirdir
* [CopSSH](https://www.itefix.net/copssh) - Windows iÃ§in OpenSSH uygulamasÄ±

**SSH kÃ¼tÃ¼phaneleri (sunucu tarafÄ±nÄ± uygulayan):**

* [libssh](https://www.libssh.org) - SSHv2 protokolÃ¼nÃ¼ uygulayan Ã§ok platformlu C kÃ¼tÃ¼phanesi, [Python](https://github.com/ParallelSSH/ssh-python), [Perl](https://github.com/garnier-quentin/perl-libssh/) ve [R](https://github.com/ropensci/ssh) baÄŸlantÄ±larÄ±na sahiptir; KDE tarafÄ±ndan sftp iÃ§in ve GitHub tarafÄ±ndan git SSH altyapÄ±sÄ± iÃ§in kullanÄ±lÄ±r
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) - ANSI C ile yazÄ±lmÄ±ÅŸ SSHv2 sunucu kÃ¼tÃ¼phanesi, gÃ¶mÃ¼lÃ¼, RTOS ve kaynak kÄ±sÄ±tlÄ± ortamlar iÃ§in hedeflenmiÅŸtir
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) - Apache SSHD java kÃ¼tÃ¼phanesi, Apache MINA'ya dayanmaktadÄ±r
* [paramiko](https://github.com/paramiko/paramiko) - Python SSHv2 protokolÃ¼ kÃ¼tÃ¼phanesi

## NumaralandÄ±rma

### Banner Yakalama
```bash
nc -vn <IP> 22
```
### Otomatik ssh-audit

ssh-audit, ssh sunucusu ve istemci yapÄ±landÄ±rmasÄ±nÄ± denetlemek iÃ§in bir araÃ§tÄ±r.

[https://github.com/jtesta/ssh-audit](https://github.com/jtesta/ssh-audit), [https://github.com/arthepsy/ssh-audit/](https://github.com/arthepsy/ssh-audit/) adresinden gÃ¼ncellenmiÅŸ bir kopyadÄ±r.

**Ã–zellikler:**

* SSH1 ve SSH2 protokolÃ¼ sunucu desteÄŸi;
* SSH istemci yapÄ±landÄ±rmasÄ±nÄ± analiz eder;
* banner alÄ±r, cihazÄ± veya yazÄ±lÄ±mÄ± tanÄ±r ve iÅŸletim sistemini tespit eder, sÄ±kÄ±ÅŸtÄ±rmayÄ± algÄ±lar;
* anahtar deÄŸiÅŸimi, ana bilgisayar anahtarÄ±, ÅŸifreleme ve mesaj doÄŸrulama kodu algoritmalarÄ±nÄ± toplar;
* algoritma bilgilerini Ã§Ä±ktÄ±lar (mevcut olduÄŸu tarih, kaldÄ±rÄ±ldÄ±ÄŸÄ±/devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±ÄŸÄ±, gÃ¼vensiz/zayÄ±f/eski, vb.);
* algoritma Ã¶nerilerini Ã§Ä±ktÄ±lar (tanÄ±nan yazÄ±lÄ±m sÃ¼rÃ¼mÃ¼ne dayanarak ekleme veya kaldÄ±rma);
* gÃ¼venlik bilgilerini Ã§Ä±ktÄ±lar (ilgili sorunlar, atanan CVE listesi, vb.);
* algoritma bilgilerine dayanarak SSH sÃ¼rÃ¼m uyumluluÄŸunu analiz eder;
* OpenSSH, Dropbear SSH ve libssh'den tarihsel bilgiler;
* Linux ve Windows Ã¼zerinde Ã§alÄ±ÅŸÄ±r;
* baÄŸÄ±mlÄ±lÄ±klarÄ± yoktur.
```bash
usage: ssh-audit.py [-1246pbcnjvlt] <host>

-1,  --ssh1             force ssh version 1 only
-2,  --ssh2             force ssh version 2 only
-4,  --ipv4             enable IPv4 (order of precedence)
-6,  --ipv6             enable IPv6 (order of precedence)
-p,  --port=<port>      port to connect
-b,  --batch            batch output
-c,  --client-audit     starts a server on port 2222 to audit client
software config (use -p to change port;
use -t to change timeout)
-n,  --no-colors        disable colors
-j,  --json             JSON output
-v,  --verbose          verbose output
-l,  --level=<level>    minimum output level (info|warn|fail)
-t,  --timeout=<secs>   timeout (in seconds) for connection and reading
(default: 5)
$ python3 ssh-audit <IP>
```
### Sunucunun Genel SSH AnahtarÄ±

```plaintext
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDZz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6
```bash
ssh-keyscan -t rsa <IP> -p <PORT>
```
### ZayÄ±f Åifre AlgoritmalarÄ±

Bu varsayÄ±lan olarak **nmap** tarafÄ±ndan keÅŸfedilir. Ancak **sslcan** veya **sslyze** kullanabilirsiniz.

### Nmap betikleri
```bash
nmap -p22 <ip> -sC # Send default nmap scripts for SSH
nmap -p22 <ip> -sV # Retrieve version
nmap -p22 <ip> --script ssh2-enum-algos # Retrieve supported algorythms
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # Retrieve weak keys
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root" # Check authentication methods
```
### Shodan

* `ssh`

## KullanÄ±cÄ± adlarÄ±, ÅŸifreler ve Ã¶zel anahtarlarÄ± kaba kuvvet saldÄ±rÄ±sÄ±yla bulma

### KullanÄ±cÄ± AdÄ± Saptama

OpenSSH'nin bazÄ± sÃ¼rÃ¼mlerinde zamanlama saldÄ±rÄ±sÄ± yaparak kullanÄ±cÄ±larÄ± saptayabilirsiniz. Bunun iÃ§in bir metasploit modÃ¼lÃ¼ kullanabilirsiniz:
```
msf> use scanner/ssh/ssh_enumusers
```
### [Brute force](../generic-methodologies-and-resources/brute-force.md#ssh)

BazÄ± yaygÄ±n ssh kimlik bilgileri [burada](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt) ve [burada](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt) ve aÅŸaÄŸÄ±da bulunmaktadÄ±r.

### Ã–zel Anahtar Brute Force

EÄŸer kullanÄ±labilecek bazÄ± ssh Ã¶zel anahtarlarÄ± biliyorsanÄ±z... deneyelim. Nmap betiÄŸini kullanabilirsiniz:
```
https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html
```
Veya MSF yardÄ±mcÄ± modÃ¼lÃ¼:
```
msf> use scanner/ssh/ssh_identify_pubkeys
```
Veya `ssh-keybrute.py` kullanÄ±n (native python3, hafif ve eski algoritmalar etkin): [snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute).

#### Bilinen kÃ¶tÃ¼ anahtarlar burada bulunabilir:

{% embed url="https://github.com/rapid7/ssh-badkeys/tree/master/authorized" %}

#### ZayÄ±f SSH anahtarlarÄ± / Debian tahmin edilebilir PRNG

BazÄ± sistemlerde, kriptografik malzeme Ã¼retmek iÃ§in kullanÄ±lan rastgele tohumda bilinen hatalar bulunmaktadÄ±r. Bu, bruteforce saldÄ±rÄ±sÄ±yla kÄ±rÄ±labilecek dramatik bir anahtar alanÄ± azalmasÄ±na neden olabilir. ZayÄ±f PRNG'ye sahip Debian sistemlerinde oluÅŸturulan Ã¶nceden oluÅŸturulmuÅŸ anahtar setleri burada bulunabilir: [g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh).

Kurban makine iÃ§in geÃ§erli anahtarlarÄ± aramak iÃ§in buraya bakmalÄ±sÄ±nÄ±z.

### Kerberos

**crackmapexec**, `ssh` protokolÃ¼nÃ¼ kullanarak **kerberos Ã¼zerinden kimlik doÄŸrulamasÄ± yapmak** iÃ§in `--kerberos` seÃ§eneÄŸini kullanabilir.\
Daha fazla bilgi iÃ§in `crackmapexec ssh --help` komutunu Ã§alÄ±ÅŸtÄ±rÄ±n.

## VarsayÄ±lan Kimlik Bilgileri

| **SatÄ±cÄ±** | **KullanÄ±cÄ± AdlarÄ±**                                                                                         | **Parolalar**                                                                                                                                                                                              |
| ---------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| APC        | apc, device                                                                                                 | apc                                                                                                                                                                                                        |
| Brocade    | admin                                                                                                       | admin123, password, brocade, fibranne                                                                                                                                                                      |
| Cisco      | admin, cisco, enable, hsa, pix, pnadmin, ripeop, root, shelladmin                                           | admin, Admin123, default, password, secur4u, cisco, Cisco, \_Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change\_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme |
| Citrix     | root, nsroot, nsmaint, vdiadmin, kvm, cli, admin                                                            | C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler                                                                                                                       |
| D-Link     | admin, user                                                                                                 | private, admin, user                                                                                                                                                                                       |
| Dell       | root, user1, admin, vkernel, cli                                                                            | calvin, 123456, password, vkernel, Stor@ge!, admin                                                                                                                                                         |
| EMC        | admin, root, sysadmin                                                                                       | EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc                                                                                                                                              |
| HP/3Com    | admin, root, vcx, app, spvar, manage, hpsupport, opc\_op                                                    | admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC\_op, !manage, !admin                                                   |
| Huawei     | admin, root                                                                                                 | 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123                                                                                             |
| IBM        | USERID, admin, manager, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, system, device, ufmcli, customer | PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer                                                                                                                               |
| Juniper    | netscreen                                                                                                   | netscreen                                                                                                                                                                                                  |
| NetApp     | admin                                                                                                       | netapp123                                                                                                                                                                                                  |
| Oracle     | root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user                                           | changeme, ilom-admin, ilom-operator, welcome1, oracle                                                                                                                                                      |
| VMware     | vi-admin, root, hqadmin, vmware, admin                                                                      | vmware, vmw@re, hqadmin, default                                                                                                                                                                           |

## SSH-MitM

EÄŸer kurbanÄ±n SSH sunucusuna kullanÄ±cÄ± adÄ± ve parola kullanarak baÄŸlanacaÄŸÄ± yerel aÄŸda bulunuyorsanÄ±z, bu kimlik bilgilerini Ã§almak iÃ§in bir **MitM saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmeyi** deneyebilirsiniz:

**SaldÄ±rÄ± yolu:**

* **Trafik YÃ¶nlendirme:** SaldÄ±rgan, kurbanÄ±n trafiÄŸini kendi makinesine yÃ¶nlendirir ve SSH sunucusuna baÄŸlantÄ± giriÅŸimini etkili bir ÅŸekilde **intercept** eder.
* **Ä°nterception ve KayÄ±t:** SaldÄ±rganÄ±n makinesi, meÅŸru SSH sunucusu gibi davranarak kullanÄ±cÄ±nÄ±n giriÅŸ bilgilerini **yakalayan** bir **proxy** olarak hareket eder.
* **Komut YÃ¼rÃ¼tme ve Ä°letme:** Son olarak, saldÄ±rganÄ±n sunucusu, kullanÄ±cÄ±nÄ±n kimlik bilgilerini **kaydeder**, komutlarÄ± gerÃ§ek SSH sunucusuna **iletir**, bunlarÄ± **yÃ¼rÃ¼tÃ¼r** ve sonuÃ§larÄ± kullanÄ±cÄ±ya **geri gÃ¶nderir**, bÃ¶ylece iÅŸlem sorunsuz ve meÅŸru gÃ¶rÃ¼nÃ¼r.

[**SSH MITM**](https://github.com/jtesta/ssh-mitm) yukarÄ±da aÃ§Ä±klananÄ± tam olarak yapar.

GerÃ§ek MitM'yi gerÃ§ekleÅŸtirmek iÃ§in ARP spoofing, DNS spoofing veya [**Network Spoofing attacks**](../generic-methodologies-and-resources/pentesting-network/#spoofing) bÃ¶lÃ¼mÃ¼nde aÃ§Ä±klanan diÄŸer teknikleri kullanabilirsiniz.

## SSH-Snake

Bir aÄŸda keÅŸfedilen SSH Ã¶zel anahtarlarÄ±nÄ± kullanarak sistemlerde gezinmek ve her sistemdeki her Ã¶zel anahtarÄ± yeni ana bilgisayarlarda kullanmak istiyorsanÄ±z, [**SSH-Snake**](https://github.com/MegaManSec/SSH-Snake) tam ihtiyacÄ±nÄ±z olan ÅŸeydir.

SSH-Snake otomatik ve tekrarlayan olarak aÅŸaÄŸÄ±daki gÃ¶revleri gerÃ§ekleÅŸtirir:

1. Mevcut sistemdeki tÃ¼m SSH Ã¶zel anahtarlarÄ±nÄ± bulur,
2. Mevcut sistemde, Ã¶zel anahtarlarÄ±n kabul edilebileceÄŸi tÃ¼m ana bilgisayarlarÄ± veya hedefleri (kullanÄ±cÄ±@ana-bilgisayar) bulur,
3. Bulunan tÃ¼m Ã¶zel anahtarlarÄ± kullanarak tÃ¼m hedeflere SSH ile baÄŸlanmaya Ã§alÄ±ÅŸÄ±r,
4. Bir hedefe baÅŸarÄ±yla baÄŸlanÄ±lÄ±rsa, baÄŸlanÄ±lan sisteme yÃ¶nelik adÄ±mlarÄ± #1 - #4 tekrarlar.

Tamamen kendini Ã§oÄŸaltan ve yayÄ±lan - ve tamamen dosyasÄ±zdÄ±r.

## YapÄ±landÄ±rma YanlÄ±ÅŸlÄ±klarÄ±

### Root giriÅŸi

SSH sunucularÄ±nÄ±n varsayÄ±lan olarak kÃ¶k kullanÄ±cÄ± giriÅŸine izin vermesi yaygÄ±ndÄ±r ve Ã¶nemli bir gÃ¼venlik riski oluÅŸturur. **KÃ¶k giriÅŸini devre dÄ±ÅŸÄ± bÄ±rakmak**, sunucuyu gÃ¼vence altÄ±na almanÄ±n Ã¶nemli bir adÄ±mÄ±dÄ±r. Bu deÄŸiÅŸiklikle yetkisiz yÃ¶netici eriÅŸimi ve brute force saldÄ±rÄ±larÄ± engellenebilir.

**OpenSSH'de KÃ¶k GiriÅŸini Devre DÄ±ÅŸÄ± BÄ±rakma:**

1. SSH yapÄ±landÄ±rma dosyasÄ±nÄ± dÃ¼zenlemek iÃ§in: `sudoedit /etc/ssh/sshd_config`
2. AyarÄ± `#PermitRootLogin yes` olarak deÄŸiÅŸtirin ve **`PermitRootLogin no`** yapÄ±n.
3. YapÄ±landÄ±rmayÄ± yeniden yÃ¼klemek iÃ§in: `sudo systemctl daemon-reload` komutunu kullanÄ±n.
4. DeÄŸiÅŸiklikleri uygulamak iÃ§in SSH sunucusunu yeniden baÅŸlatÄ±n: `sudo systemctl restart sshd` komutunu kullanÄ±n.

### SFTP Brute Force

* [**SFTP Brute Force**](../generic-methodologies-and-resources/brute-force.md#sftp)

### SFTP komut yÃ¼rÃ¼tme

SFTP yapÄ±landÄ±rmalarÄ±nda yaygÄ±n bir gÃ¶zden kaÃ§Ä±rma, kullanÄ±cÄ±larÄ±n uzaktan kabuk eriÅŸimini etkinleÅŸtirmeden dosya alÄ±ÅŸveriÅŸi yapmasÄ±nÄ± saÄŸlamaktÄ±r. KullanÄ±cÄ±larÄ± etkileÅŸimli olmayan kabuklarla (Ã¶rneÄŸin `/usr/bin/nologin`) ayarlamak ve onlarÄ± belirli bir dizine sÄ±nÄ±rlamak, bir gÃ¼venlik aÃ§Ä±ÄŸÄ± bÄ±rakÄ±r. KullanÄ±cÄ±lar, belirlenen etkileÅŸimli olmayan kabuk devralmadan hemen sonra bir komutun (Ã¶rneÄŸin `/bin/bash`) yÃ¼rÃ¼tÃ¼lmesini isteyerek bu kÄ±sÄ±tlamalarÄ± atlayabilir. Bu, yetkisiz komut yÃ¼rÃ¼tme iÃ§in izin verir ve amaÃ§lanan gÃ¼venlik Ã¶nlemlerini zayÄ±flatÄ±r.

[Ã–rnek buradan alÄ±nmÄ±ÅŸtÄ±r](https://community.turgensec.com/ssh-hacking-guide/):
```bash
ssh -v noraj@192.168.1.94 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 192.168.1.94 ([192.168.1.94]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(noraj) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

$ ssh noraj@192.168.1.94 /bin/bash
```
AÅŸaÄŸÄ±da, kullanÄ±cÄ± `noraj` iÃ§in gÃ¼venli SFTP yapÄ±landÄ±rmasÄ±nÄ±n (`/etc/ssh/sshd_config` - openSSH) bir Ã¶rneÄŸi bulunmaktadÄ±r:
```
Match User noraj
ChrootDirectory %h
ForceCommand internal-sftp
AllowTcpForwarding no
PermitTunnel no
X11Forwarding no
PermitTTY no
```
Bu yapÄ±landÄ±rma yalnÄ±zca SFTP'ye izin verecektir: baÅŸlatma komutunu zorlayarak kabuk eriÅŸimini devre dÄ±ÅŸÄ± bÄ±rakacak ve TTY eriÅŸimini devre dÄ±ÅŸÄ± bÄ±rakacak, ayrÄ±ca tÃ¼m port yÃ¶nlendirmelerini veya tÃ¼nelleme tÃ¼rlerini devre dÄ±ÅŸÄ± bÄ±rakacaktÄ±r.

### SFTP TÃ¼nelleme

EÄŸer bir SFTP sunucusuna eriÅŸiminiz varsa, Ã¶rneÄŸin yaygÄ±n port yÃ¶nlendirmesini kullanarak trafiÄŸinizi bu sunucu Ã¼zerinden tÃ¼nelleyebilirsiniz:
```bash
sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>
```
### SFTP Sembolik BaÄŸlantÄ±

**sftp** komutunda "**symlink**" komutu bulunur. Bu nedenle, bazÄ± bir klasÃ¶re **yazma izniniz** varsa, **diÄŸer klasÃ¶rler/dosyalarÄ±n sembolik baÄŸlantÄ±larÄ±nÄ±** oluÅŸturabilirsiniz. Muhtemelen bir chroot iÃ§inde **sÄ±kÄ±ÅŸmÄ±ÅŸ** durumdasÄ±nÄ±z, bu nedenle bu sizin iÃ§in Ã¶zellikle faydalÄ± olmayacaktÄ±r. Ancak, oluÅŸturulan sembolik baÄŸlantÄ±ya bir **chroot dÄ±ÅŸÄ±ndaki hizmetten** (Ã¶rneÄŸin, sembolik baÄŸlantÄ±ya web Ã¼zerinden eriÅŸebiliyorsanÄ±z) **web Ã¼zerinden sembolik baÄŸlantÄ±lÄ± dosyalarÄ± aÃ§abilirsiniz**.

Ã–rneÄŸin, yeni bir dosya olan "**_**froot**_**" ile "**_**/**_**" arasÄ±nda bir **sembolik baÄŸlantÄ±** oluÅŸturmak iÃ§in:
```bash
sftp> symlink / froot
```
EÄŸer web Ã¼zerinden "_froot_" dosyasÄ±na eriÅŸebilirseniz, sistemdeki kÃ¶k ("/") klasÃ¶rÃ¼nÃ¼ listeleyebilirsiniz.

### Kimlik doÄŸrulama yÃ¶ntemleri

YÃ¼ksek gÃ¼venlikli ortamlarda, basit faktÃ¶r parola tabanlÄ± kimlik doÄŸrulama yerine yalnÄ±zca anahtar tabanlÄ± veya iki faktÃ¶rlÃ¼ kimlik doÄŸrulamanÄ±n etkinleÅŸtirilmesi yaygÄ±n bir uygulamadÄ±r. Ancak genellikle daha gÃ¼Ã§lÃ¼ kimlik doÄŸrulama yÃ¶ntemleri, daha zayÄ±f olanlarÄ± devre dÄ±ÅŸÄ± bÄ±rakmadan etkinleÅŸtirilir. SÄ±kÃ§a karÅŸÄ±laÅŸÄ±lan bir durum, openSSH yapÄ±landÄ±rmasÄ±nda `publickey`'in etkinleÅŸtirilmesi ve varsayÄ±lan yÃ¶ntem olarak ayarlanmasÄ±, ancak `password`'un devre dÄ±ÅŸÄ± bÄ±rakÄ±lmamasÄ±dÄ±r. Bu nedenle, bir saldÄ±rgan SSH istemcisinin ayrÄ±ntÄ±lÄ± modunu kullanarak daha zayÄ±f bir yÃ¶ntemin etkinleÅŸtirildiÄŸini gÃ¶rebilir:
```bash
ssh -v 192.168.1.94
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive
```
Ã–rneÄŸin, bir kimlik doÄŸrulama baÅŸarÄ±sÄ±zlÄ±k sÄ±nÄ±rÄ± belirlenmiÅŸse ve ÅŸifre yÃ¶ntemine ulaÅŸma ÅŸansÄ±nÄ±z hiÃ§ olmazsa, `PreferredAuthentications` seÃ§eneÄŸini kullanarak bu yÃ¶ntemi zorlamak iÃ§in kullanabilirsiniz.
```bash
ssh -v 192.168.1.94 -o PreferredAuthentications=password
...
debug1: Next authentication method: password
```
SSH sunucusu yapÄ±landÄ±rmasÄ±nÄ± gÃ¶zden geÃ§irmek, yalnÄ±zca beklenen yÃ¶ntemlerin yetkilendirildiÄŸini kontrol etmek iÃ§in gereklidir. Ä°stemci Ã¼zerinde ayrÄ±ntÄ±lÄ± mod kullanmak, yapÄ±landÄ±rmanÄ±n etkinliÄŸini gÃ¶rmeye yardÄ±mcÄ± olabilir.

### YapÄ±landÄ±rma dosyalarÄ±
```bash
ssh_config
sshd_config
authorized_keys
ssh_known_hosts
known_hosts
id_rsa
```
## Fuzzing

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## Referanslar

* SSH'yi nasÄ±l gÃ¼Ã§lendireceÄŸinize dair ilginÃ§ kÄ±lavuzlarÄ± [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html) adresinde bulabilirsiniz.
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

EÄŸer **hacking kariyeri** ile ilgileniyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± ÅŸekilde LehÃ§e yazÄ±lÄ± ve konuÅŸma becerisi gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

## HackTricks Otomatik KomutlarÄ±
```
Protocol_Name: SSH
Port_Number: 22
Protocol_Description: Secure Shell Hardening

Entry_1:
Name: Hydra Brute Force
Description: Need Username
Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh

Entry_2:
Name: consolesless mfs enumeration
Description: SSH enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'

```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
