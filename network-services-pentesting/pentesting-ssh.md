# 22 - Pentesting SSH/SFTP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## Basic Information

**SSH (рд╕рд┐рдХреНрдпреЛрд░ рд╢реЗрд▓ рдпрд╛ рд╕рд┐рдХреНрдпреЛрд░ рд╕реЙрдХреЗрдЯ рд╢реЗрд▓)** рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрдиреЗрдХреНрд╢рди рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ рджреВрд░рд╕реНрде рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдБрдЪрддреЗ рд╕рдордп рдбреЗрдЯрд╛ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 22
```
22/tcp open  ssh     syn-ack
```
**SSH servers:**

* [openSSH](http://www.openssh.org) тАУ OpenBSD SSH, BSD, Linux рд╡рд┐рддрд░рдгреЛрдВ рдФрд░ Windows 10 рд╕реЗ Windows рдореЗрдВ рд╢рд╛рдорд┐рд▓
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) тАУ рдХрдо рдореЗрдореЛрд░реА рдФрд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╡рд╛рд▓реЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП SSH рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, OpenWrt рдореЗрдВ рд╢рд╛рдорд┐рд▓
* [PuTTY](https://www.chiark.greenend.org.uk/\~sgtatham/putty/) тАУ Windows рдХреЗ рд▓рд┐рдП SSH рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдо рд╣реЛрддрд╛ рд╣реИ
* [CopSSH](https://www.itefix.net/copssh) тАУ Windows рдХреЗ рд▓рд┐рдП OpenSSH рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди

**SSH libraries (implementing server-side):**

* [libssh](https://www.libssh.org) тАУ рдмрд╣реБ-рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо C рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЬреЛ SSHv2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, [Python](https://github.com/ParallelSSH/ssh-python), [Perl](https://github.com/garnier-quentin/perl-libssh/) рдФрд░ [R](https://github.com/ropensci/ssh) рдореЗрдВ рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде; рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ KDE рджреНрд╡рд╛рд░рд╛ sftp рдХреЗ рд▓рд┐рдП рдФрд░ GitHub рджреНрд╡рд╛рд░рд╛ git SSH рдЕрд╡рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) тАУ ANSI C рдореЗрдВ рд▓рд┐рдЦреА рдЧрдИ SSHv2 рд╕рд░реНрд╡рд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЬреЛ рдПрдореНрдмреЗрдбреЗрдб, RTOS, рдФрд░ рд╕рдВрд╕рд╛рдзрди-рд╕реАрдорд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖рд┐рдд рд╣реИ
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) тАУ Apache SSHD рдЬрд╛рд╡рд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА Apache MINA рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ
* [paramiko](https://github.com/paramiko/paramiko) тАУ Python SSHv2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА

## Enumeration

### Banner Grabbing
```bash
nc -vn <IP> 22
```
### Automated ssh-audit

ssh-audit рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ ssh рд╕рд░реНрд╡рд░ рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдСрдбрд┐рдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╣реИред

[https://github.com/jtesta/ssh-audit](https://github.com/jtesta/ssh-audit) рдПрдХ рдЕрдкрдбреЗрдЯреЗрдб рдлреЛрд░реНрдХ рд╣реИ [https://github.com/arthepsy/ssh-audit/](https://github.com/arthepsy/ssh-audit/)

**рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ:**

* SSH1 рдФрд░ SSH2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рд░реНрд╡рд░ рд╕рдорд░реНрдерди;
* SSH рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ;
* рдмреИрдирд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдбрд┐рд╡рд╛рдЗрд╕ рдпрд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдФрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдкрд╣рдЪрд╛рдиреЗрдВ, рд╕рдВрдХреБрдЪрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ;
* рдХреБрдВрдЬреА-рдкрд░рд┐рд╡рд░реНрддрди, рд╣реЛрд╕реНрдЯ-рдХреБрдВрдЬреА, рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдФрд░ рд╕рдВрджреЗрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛрдб рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдПрдХрддреНрд░ рдХрд░реЗрдВ;
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЬрд╛рдирдХрд╛рд░реА рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдВ (рдЙрдкрд▓рдмреНрдзрддрд╛ рд╕реЗ, рд╣рдЯрд╛/рдЕрдХреНрд╖рдо, рдЕрд╕реБрд░рдХреНрд╖рд┐рдд/рдХрдордЬреЛрд░/рдкреБрд░рд╛рдирд╛, рдЖрджрд┐);
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдВ (рдкрд╣рдЪрд╛рдиреЗ рдЧрдП рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреЛрдбрд╝реЗрдВ рдпрд╛ рд╣рдЯрд╛рдПрдВ);
* рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдирдХрд╛рд░реА рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдВ (рд╕рдВрдмрдВрдзрд┐рдд рдореБрджреНрджреЗ, рдЕрд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП CVE рд╕реВрдЪреА, рдЖрджрд┐);
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ SSH рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЧрддрддрд╛ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ;
* OpenSSH, Dropbear SSH рдФрд░ libssh рд╕реЗ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА;
* Linux рдФрд░ Windows рдкрд░ рдЪрд▓рддрд╛ рд╣реИ;
* рдХреЛрдИ рдирд┐рд░реНрднрд░рддрд╛ рдирд╣реАрдВ
```bash
usage: ssh-audit.py [-1246pbcnjvlt] <host>

-1,  --ssh1             force ssh version 1 only
-2,  --ssh2             force ssh version 2 only
-4,  --ipv4             enable IPv4 (order of precedence)
-6,  --ipv6             enable IPv6 (order of precedence)
-p,  --port=<port>      port to connect
-b,  --batch            batch output
-c,  --client-audit     starts a server on port 2222 to audit client
software config (use -p to change port;
use -t to change timeout)
-n,  --no-colors        disable colors
-j,  --json             JSON output
-v,  --verbose          verbose output
-l,  --level=<level>    minimum output level (info|warn|fail)
-t,  --timeout=<secs>   timeout (in seconds) for connection and reading
(default: 5)
$ python3 ssh-audit <IP>
```
[See it in action (Asciinema)](https://asciinema.org/a/96ejZKxpbuupTK9j7h8BdClzp)

### рд╕рд░реНрд╡рд░ рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ SSH рдХреБрдВрдЬреА
```bash
ssh-keyscan -t rsa <IP> -p <PORT>
```
### рдХрдордЬреЛрд░ рд╕рд┐рдлрд░ рдПрд▓реНрдЧреЛрд░рд┐рджрдо

рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **nmap** рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдЖрдк **sslcan** рдпрд╛ **sslyze** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕
```bash
nmap -p22 <ip> -sC # Send default nmap scripts for SSH
nmap -p22 <ip> -sV # Retrieve version
nmap -p22 <ip> --script ssh2-enum-algos # Retrieve supported algorythms
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # Retrieve weak keys
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root" # Check authentication methods
```
### Shodan

* `ssh`

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдЧрдгрдирд╛

OpenSSH рдХреЗ рдХреБрдЫ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордп рд╣рдорд▓реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЙрдЯ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
msf> use scanner/ssh/ssh_enumusers
```
### [Brute force](../generic-methodologies-and-resources/brute-force.md#ssh)

рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп ssh рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ [рдпрд╣рд╛рдБ](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt) рдФрд░ [рдпрд╣рд╛рдБ](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt) рдФрд░ рдиреАрдЪреЗред

### Private Key Brute Force

рдпрджрд┐ рдЖрдк рдХреБрдЫ ssh рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдЬрд╛рдирддреЗ рд╣реИрдВ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ... рдЪрд▓реЛ рдЗрд╕реЗ рдЖрдЬрдорд╛рддреЗ рд╣реИрдВред рдЖрдк nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html
```
рдпрд╛ MSF рд╕рд╣рд╛рдпрдХ рдореЙрдбреНрдпреВрд▓:
```
msf> use scanner/ssh/ssh_identify_pubkeys
```
Or use `ssh-keybrute.py` (native python3, lightweight and has legacy algorithms enabled): [snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute).

#### Known badkeys can be found here:

{% embed url="https://github.com/rapid7/ssh-badkeys/tree/master/authorized" %}

#### Weak SSH keys / Debian predictable PRNG

рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рд╕рд╛рдордЧреНрд░реА рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд░реИрдВрдбрдо рд╕реАрдб рдореЗрдВ рдЬреНрдЮрд╛рдд рджреЛрд╖ рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдХреБрдВрдЬреА рд╕реНрдерд╛рди рдореЗрдВ рдирд╛рдЯрдХреАрдп рд░реВрдк рд╕реЗ рдХрдореА рдЖ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕реЗ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдХрдордЬреЛрд░ PRNG рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдбреЗрдмрд┐рдпрди рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рдкреВрд░реНрд╡-рдирд┐рд░реНрдорд┐рдд рдХреБрдВрдЬреА рд╕реЗрдЯ рдпрд╣рд╛рдБ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ: [g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh).

рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдХреЗ рд▓рд┐рдП рд╡реИрдз рдХреБрдВрдЬреА рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред

### Kerberos

**crackmapexec** `ssh` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП **kerberos рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `--kerberos` рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП `crackmapexec ssh --help` рдЪрд▓рд╛рдПрдБред

## Default Credentials

| **Vendor** | **Usernames**                                                                                               | **Passwords**                                                                                                                                                                                              |
| ---------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| APC        | apc, device                                                                                                 | apc                                                                                                                                                                                                        |
| Brocade    | admin                                                                                                       | admin123, password, brocade, fibranne                                                                                                                                                                      |
| Cisco      | admin, cisco, enable, hsa, pix, pnadmin, ripeop, root, shelladmin                                           | admin, Admin123, default, password, secur4u, cisco, Cisco, \_Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change\_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme |
| Citrix     | root, nsroot, nsmaint, vdiadmin, kvm, cli, admin                                                            | C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler                                                                                                                       |
| D-Link     | admin, user                                                                                                 | private, admin, user                                                                                                                                                                                       |
| Dell       | root, user1, admin, vkernel, cli                                                                            | calvin, 123456, password, vkernel, Stor@ge!, admin                                                                                                                                                         |
| EMC        | admin, root, sysadmin                                                                                       | EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc                                                                                                                                              |
| HP/3Com    | admin, root, vcx, app, spvar, manage, hpsupport, opc\_op                                                    | admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC\_op, !manage, !admin                                                   |
| Huawei     | admin, root                                                                                                 | 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123                                                                                             |
| IBM        | USERID, admin, manager, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, system, device, ufmcli, customer | PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer                                                                                                                               |
| Juniper    | netscreen                                                                                                   | netscreen                                                                                                                                                                                                  |
| NetApp     | admin                                                                                                       | netapp123                                                                                                                                                                                                  |
| Oracle     | root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user                                           | changeme, ilom-admin, ilom-operator, welcome1, oracle                                                                                                                                                      |
| VMware     | vi-admin, root, hqadmin, vmware, admin                                                                      | vmware, vmw@re, hqadmin, default                                                                                                                                                                           |

## SSH-MitM

рдпрджрд┐ рдЖрдк рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SSH рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **рдЙрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ MitM рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

**рд╣рдорд▓реЗ рдХрд╛ рдорд╛рд░реНрдЧ:**

* **рдЯреНрд░реИрдлрд╝рд┐рдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди:** рд╣рдорд▓рд╛рд╡рд░ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ** рдЕрдкрдиреА рдорд╢реАрди рдкрд░ **рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд** рдХрд░рддрд╛ рд╣реИ, рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ SSH рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдкреНрд░рдпрд╛рд╕ рдХреЛ **рдЕрд╡рд░реЛрдзрд┐рдд** рдХрд░рддрд╛ рд╣реИред
* **рд╣рд╕реНрддрдХреНрд╖реЗрдк рдФрд░ рд▓реЙрдЧрд┐рдВрдЧ:** рд╣рдорд▓рд╛рд╡рд░ рдХреА рдорд╢реАрди рдПрдХ **рдкреНрд░реЙрдХреНрд╕реА** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреА рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓реЙрдЧрд┐рди рд╡рд┐рд╡рд░рдг рдХреЛ рд╡реИрдз SSH рд╕рд░реНрд╡рд░ рд╣реЛрдиреЗ рдХрд╛ рдирд╛рдЯрдХ рдХрд░рдХреЗ **рдХреИрдкреНрдЪрд░** рдХрд░рддреА рд╣реИред
* **рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд░рд┐рд▓реЗ:** рдЕрдВрддрддрдГ, рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╕рд░реНрд╡рд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИ**, **рдХрдорд╛рдВрдб рдХреЛ** рдЕрд╕рд▓реА SSH рд╕рд░реНрд╡рд░ рдкрд░ **рдЖрдЧреЗ рдмрдврд╝рд╛рддрд╛ рд╣реИ**, **рдЙрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рддрд╛ рд╣реИ, рдФрд░ **рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рд╡рд╛рдкрд╕** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рд╣рдЬ рдФрд░ рд╡реИрдз рдкреНрд░рддреАрдд рд╣реЛрддреА рд╣реИред

[**SSH MITM**](https://github.com/jtesta/ssh-mitm) рдареАрдХ рд╡рд╣реА рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╣реИред

MitM рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдк рд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк ARP рд╕реНрдкреВрдлрд┐рдВрдЧ, DNS рд╕реНрдкреВрдлрд┐рдВрдЧ рдпрд╛ [**рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдкреВрдлрд┐рдВрдЧ рд╣рдорд▓реЛрдВ**](../generic-methodologies-and-resources/pentesting-network/#spoofing) рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдЕрдиреНрдп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## SSH-Snake

рдпрджрд┐ рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЦреЛрдЬреЗ рдЧрдП SSH рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдкреНрд░рддреНрдпреЗрдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдП рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП, рддреЛ [**SSH-Snake**](https://github.com/MegaManSec/SSH-Snake) рд╡рд╣реА рд╣реИ рдЬрд┐рд╕рдХреА рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

SSH-Snake рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд░реВрдк рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ:

1. рд╡рд░реНрддрдорд╛рди рд╕рд┐рд╕реНрдЯрдо рдкрд░, рдХрд┐рд╕реА рднреА SSH рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЛ рдЦреЛрдЬреЗрдВ,
2. рд╡рд░реНрддрдорд╛рди рд╕рд┐рд╕реНрдЯрдо рдкрд░, рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рдпрд╛ рдЧрдВрддрд╡реНрдпреЛрдВ (user@host) рдХреЛ рдЦреЛрдЬреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдирд┐рдЬреА рдХреБрдВрдЬреА рд╕реНрд╡реАрдХрд╛рд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ,
3. рдЦреЛрдЬреА рдЧрдИ рд╕рднреА рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рдЧрдВрддрд╡реНрдпреЛрдВ рдореЗрдВ SSH рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ,
4. рдпрджрд┐ рдХрд┐рд╕реА рдЧрдВрддрд╡реНрдп рд╕реЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдХрдиреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЪрд░рдг #1 - #4 рдХреЛ рджреЛрд╣рд░рд╛рдПрдВред

рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЖрддреНрдо-рдкреНрд░рддрд┐рдХреГрддрд┐ рдФрд░ рдЖрддреНрдо-рдкреНрд░рд╕рд╛рд░ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ -- рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдлрд╝рд╛рдЗрд▓ рд░рд╣рд┐рдд рд╣реИред

## Config Misconfigurations

### Root login

рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ SSH рд╕рд░реНрд╡рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИред **рд░реВрдЯ рд▓реЙрдЧрд┐рди рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛** рд╕рд░реНрд╡рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрджрдо рд╣реИред рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдФрд░ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреЛ рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**OpenSSH рдореЗрдВ рд░реВрдЯ рд▓реЙрдЧрд┐рди рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:**

1. **SSH рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ**: `sudoedit /etc/ssh/sshd_config`
2. **рд╕реЗрдЯрд┐рдВрдЧ рдХреЛ рдмрджрд▓реЗрдВ**: `#PermitRootLogin yes` рд╕реЗ **`PermitRootLogin no`** рдореЗрдВред
3. **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓реЛрдб рдХрд░реЗрдВ**: `sudo systemctl daemon-reload`
4. **рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SSH рд╕рд░реНрд╡рд░ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ**: `sudo systemctl restart sshd`

### SFTP Brute Force

* [**SFTP Brute Force**](../generic-methodologies-and-resources/brute-force.md#sftp)

### SFTP command execution

SFTP рд╕реЗрдЯрдЕрдк рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЪреВрдХ рд╣реЛрддреА рд╣реИ, рдЬрд╣рд╛рдВ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмрд┐рдирд╛ рджреВрд░рд╕реНрде рд╢реЗрд▓ рдкрд╣реБрдВрдЪ рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХрд╛ рдЗрд░рд╛рджрд╛ рд░рдЦрддреЗ рд╣реИрдВред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЧреИрд░-рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ (рдЬреИрд╕реЗ, `/usr/bin/nologin`) рдХреЗ рд╕рд╛рде рд╕реЗрдЯ рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЫрд┐рджреНрд░ рдмрдирд╛ рд░рд╣рддрд╛ рд╣реИред **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЙрдЧрд┐рди рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдПрдХ рдХрдорд╛рдВрдб (рдЬреИрд╕реЗ `/bin/bash`) рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдХреЗ, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЙрдирдХрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЧреИрд░-рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ рдирд┐рдпрдВрддреНрд░рдг рд▓реЗ рд▓реЗред рдпрд╣ рдЕрдирдзрд┐рдХреГрдд рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдЗрдЪреНрдЫрд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдХрдордЬреЛрд░ рдХрд░рддрд╛ рд╣реИред

[рдпрд╣рд╛рдБ рд╕реЗ рдЙрджрд╛рд╣рд░рдг](https://community.turgensec.com/ssh-hacking-guide/):
```bash
ssh -v noraj@192.168.1.94 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 192.168.1.94 ([192.168.1.94]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(noraj) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

$ ssh noraj@192.168.1.94 /bin/bash
```
рдпрд╣рд╛рдБ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `noraj` рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд SFTP рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ (`/etc/ssh/sshd_config` тАУ openSSH):
```
Match User noraj
ChrootDirectory %h
ForceCommand internal-sftp
AllowTcpForwarding no
PermitTunnel no
X11Forwarding no
PermitTTY no
```
рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗрд╡рд▓ SFTP рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛: рд╕реНрдЯрд╛рд░реНрдЯ рдХрдорд╛рдВрдб рдХреЛ рдордЬрдмреВрд░ рдХрд░рдХреЗ рд╢реЗрд▓ рдПрдХреНрд╕реЗрд╕ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдФрд░ TTY рдПрдХреНрд╕реЗрд╕ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛, рд▓реЗрдХрд┐рди рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреЛрд░реНрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдпрд╛ рдЯрдирд▓рд┐рдВрдЧ рдХреЛ рднреА рдЕрдХреНрд╖рдо рдХрд░рдирд╛ред

### SFTP рдЯрдирд▓рд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ SFTP рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ, рддреЛ рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд░реНрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯрдирд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>
```
### SFTP Symlink

The **sftp** have the command "**symlink**". Therefore, if you have **writable rights** in some folder, you can create **symlinks** of **other folders/files**. As you are probably **trapped** inside a chroot this **won't be specially useful** for you, but, if you can **access** the created **symlink** from a **no-chroot** **service** (for example, if you can access the symlink from the web), you could **open the symlinked files through the web**.

For example, to create a **symlink** from a new file **"**_**froot**_**" to "**_**/**_**"**:
```bash
sftp> symlink / froot
```
If you can access the file "_froot_" via web, you will be able to list the root ("/") folder of the system.

### Authentication methods

рдЙрдЪреНрдЪ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреЗрд╡рд▓ рдХреБрдВрдЬреА-рдЖрдзрд╛рд░рд┐рдд рдпрд╛ рджреЛ-рдХрд╛рд░рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдерд╛ рд╣реИ, рдмрдЬрд╛рдп рд╕рд╛рдзрд╛рд░рдг рдХрд╛рд░рдХ рдкрд╛рд╕рд╡рд░реНрдб рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗред рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рдордЬрдмреВрдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХрдордЬреЛрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд┐рдПред рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдорд▓рд╛ `publickey` рдХреЛ openSSH рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИ рд▓реЗрдХрд┐рди `password` рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдирд╣реАрдВ рдХрд░рдирд╛ред рдЗрд╕рд▓рд┐рдП SSH рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╡рд┐рд╕реНрддреГрдд рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдХрдордЬреЛрд░ рд╡рд┐рдзрд┐ рд╕рдХреНрд╖рдо рд╣реИ:
```bash
ssh -v 192.168.1.94
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдлрд▓рддрд╛ рд╕реАрдорд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЧрдИ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдкрд╛рд╕рд╡рд░реНрдб рд╡рд┐рдзрд┐ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `PreferredAuthentications` рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
ssh -v 192.168.1.94 -o PreferredAuthentications=password
...
debug1: Next authentication method: password
```
SSH рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡рд┐рдзрд┐рдпрд╛рдБ рдЕрдзрд┐рдХреГрдд рд╣реИрдВред рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рд╡рд┐рд╕реНрддреГрдд рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдкреНрд░рднрд╛рд╡рд╢реАрд▓рддрд╛ рджреЗрдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Config files
```bash
ssh_config
sshd_config
authorized_keys
ssh_known_hosts
known_hosts
id_rsa
```
## Fuzzing

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## References

* рдЖрдк SSH рдХреЛ рдордЬрдмреВрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рдЧрд╛рдЗрдб [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html) рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## HackTricks Automatic Commands
```
Protocol_Name: SSH
Port_Number: 22
Protocol_Description: Secure Shell Hardening

Entry_1:
Name: Hydra Brute Force
Description: Need Username
Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh

Entry_2:
Name: consolesless mfs enumeration
Description: SSH enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'

```
{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
