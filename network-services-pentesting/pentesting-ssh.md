# 22 - SSH/SFTP íœí…ŒìŠ¤íŒ…

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì—ì„œ **ì œë¡œë¶€í„° ì˜ì›…ì´ ë  ë•Œê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°**!</summary>

ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PDFë¡œ HackTricks ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì— ê°€ì…í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜**íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **í•´ì»¤ë“¤ì— ì˜í•´ ë§Œë“¤ì–´ì§„ í”„ë¦¬ë¯¸ì—„ ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**ì¸ **Intigritiì— ê°€ì…**í•˜ì„¸ìš”! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì°¸ì—¬í•˜ì—¬ **ìµœëŒ€ $100,000**ì˜ ë°”ìš´í‹°ë¥¼ ë°›ìœ¼ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ê¸°ë³¸ ì •ë³´

**SSH (Secure Shell ë˜ëŠ” Secure Socket Shell)**ëŠ” ì•ˆì „í•˜ì§€ ì•Šì€ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì»´í“¨í„°ì— ì•ˆì „í•œ ì—°ê²°ì„ ê°€ëŠ¥ì¼€ í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ì›ê²© ì‹œìŠ¤í…œì— ì ‘ê·¼í•  ë•Œ ë°ì´í„°ì˜ ê¸°ë°€ì„±ê³¼ ë¬´ê²°ì„±ì„ ìœ ì§€í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.

**ê¸°ë³¸ í¬íŠ¸:** 22
```
22/tcp open  ssh     syn-ack
```
**SSH ì„œë²„:**

* [openSSH](http://www.openssh.org) â€“ OpenBSD SSH, BSD, Linux ë°°í¬ ë° Windowsì—ì„œ Windows 10ë¶€í„° ì œê³µë¨
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) â€“ ë‚®ì€ ë©”ëª¨ë¦¬ ë° í”„ë¡œì„¸ì„œ ìì› í™˜ê²½ì„ ìœ„í•œ SSH êµ¬í˜„, OpenWrtì— í¬í•¨
* [PuTTY](https://www.chiark.greenend.org.uk/\~sgtatham/putty/) â€“ Windowsìš© SSH êµ¬í˜„, í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ì§€ë§Œ ì„œë²„ ì‚¬ìš©ì€ ë“œë¬¼ë‹¤
* [CopSSH](https://www.itefix.net/copssh) â€“ Windowsìš© OpenSSH êµ¬í˜„

**SSH ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì„œë²„ ì¸¡ êµ¬í˜„):**

* [libssh](https://www.libssh.org) â€“ SSHv2 í”„ë¡œí† ì½œì„ êµ¬í˜„í•˜ëŠ” ë©€í‹°í”Œë«í¼ C ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, [Python](https://github.com/ParallelSSH/ssh-python), [Perl](https://github.com/garnier-quentin/perl-libssh/), [R](https://github.com/ropensci/ssh)ì—ì„œ ë°”ì¸ë”©ì„ ì œê³µ; KDEì—ì„œ sftpì— ì‚¬ìš©ë˜ë©° GitHubì—ì„œ git SSH ì¸í”„ë¼ì— ì‚¬ìš©ë¨
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) â€“ ANSI Cë¡œ ì‘ì„±ëœ SSHv2 ì„œë²„ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ì„ë² ë””ë“œ, RTOS ë° ìì› ì œí•œ í™˜ê²½ì„ ëŒ€ìƒìœ¼ë¡œ í•¨
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) â€“ Apache SSHD java ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” Apache MINAì— ê¸°ë°˜í•¨
* [paramiko](https://github.com/paramiko/paramiko) â€“ Python SSHv2 í”„ë¡œí† ì½œ ë¼ì´ë¸ŒëŸ¬ë¦¬

## ì—´ê±°

### ë°°ë„ˆ ê·¸ë©í•‘
```bash
nc -vn <IP> 22
```
### ìë™í™”ëœ ssh-audit

ssh-auditëŠ” ssh ì„œë²„ ë° í´ë¼ì´ì–¸íŠ¸ êµ¬ì„± ê°ì‚¬ë¥¼ ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤.

[https://github.com/jtesta/ssh-audit](https://github.com/jtesta/ssh-audit)ëŠ” [https://github.com/arthepsy/ssh-audit/](https://github.com/arthepsy/ssh-audit/)ì—ì„œ ì—…ë°ì´íŠ¸ëœ í¬í¬ì…ë‹ˆë‹¤.

**ê¸°ëŠ¥:**

* SSH1 ë° SSH2 í”„ë¡œí† ì½œ ì„œë²„ ì§€ì›;
* SSH í´ë¼ì´ì–¸íŠ¸ êµ¬ì„± ë¶„ì„;
* ë°°ë„ˆ ê°€ì ¸ì˜¤ê¸°, ì¥ì¹˜ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë° ìš´ì˜ ì²´ì œ ì¸ì‹, ì••ì¶• ê°ì§€;
* í‚¤ êµí™˜, í˜¸ìŠ¤íŠ¸ í‚¤, ì•”í˜¸í™” ë° ë©”ì‹œì§€ ì¸ì¦ ì½”ë“œ ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì§‘;
* ì•Œê³ ë¦¬ì¦˜ ì •ë³´ ì¶œë ¥ (ì‚¬ìš© ê°€ëŠ¥í•œ ì‹œê¸°, ì œê±°/ë¹„í™œì„±í™”, ë¶ˆì•ˆì „í•œ/ì•½í•œ/ë ˆê±°ì‹œ ë“±);
* ì•Œê³ ë¦¬ì¦˜ ê¶Œì¥ ì‚¬í•­ ì¶œë ¥ (ì¸ì‹ëœ ì†Œí”„íŠ¸ì›¨ì–´ ë²„ì „ì— ë”°ë¼ ì¶”ê°€ ë˜ëŠ” ì œê±°);
* ë³´ì•ˆ ì •ë³´ ì¶œë ¥ (ê´€ë ¨ ë¬¸ì œ, í• ë‹¹ëœ CVE ëª©ë¡ ë“±);
* ì•Œê³ ë¦¬ì¦˜ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ SSH ë²„ì „ í˜¸í™˜ì„± ë¶„ì„;
* OpenSSH, Dropbear SSH ë° libsshì˜ ì—­ì‚¬ì  ì •ë³´;
* Linux ë° Windowsì—ì„œ ì‹¤í–‰;
* ì˜ì¡´ì„± ì—†ìŒ
```bash
usage: ssh-audit.py [-1246pbcnjvlt] <host>

-1,  --ssh1             force ssh version 1 only
-2,  --ssh2             force ssh version 2 only
-4,  --ipv4             enable IPv4 (order of precedence)
-6,  --ipv6             enable IPv6 (order of precedence)
-p,  --port=<port>      port to connect
-b,  --batch            batch output
-c,  --client-audit     starts a server on port 2222 to audit client
software config (use -p to change port;
use -t to change timeout)
-n,  --no-colors        disable colors
-j,  --json             JSON output
-v,  --verbose          verbose output
-l,  --level=<level>    minimum output level (info|warn|fail)
-t,  --timeout=<secs>   timeout (in seconds) for connection and reading
(default: 5)
$ python3 ssh-audit <IP>
```
### ì„œë²„ì˜ ê³µê°œ SSH í‚¤
```bash
ssh-keyscan -t rsa <IP> -p <PORT>
```
### ì·¨ì•½í•œ ì•”í˜¸ ì•Œê³ ë¦¬ì¦˜

ì´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **nmap**ì— ì˜í•´ ë°œê²¬ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ **sslcan** ë˜ëŠ” **sslyze**ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### Nmap ìŠ¤í¬ë¦½íŠ¸
```bash
nmap -p22 <ip> -sC # Send default nmap scripts for SSH
nmap -p22 <ip> -sV # Retrieve version
nmap -p22 <ip> --script ssh2-enum-algos # Retrieve supported algorythms
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # Retrieve weak keys
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root" # Check authentication methods
```
### Shodan

* `ssh`

## Brute force usernames, passwords and private keys

### ì‚¬ìš©ì ì´ë¦„ ì—´ê±°

ì¼ë¶€ OpenSSH ë²„ì „ì—ì„œëŠ” ì‚¬ìš©ìë¥¼ ì—´ê±°í•˜ê¸° ìœ„í•´ íƒ€ì´ë° ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì•…ìš©í•˜ê¸° ìœ„í•´ metasploit ëª¨ë“ˆì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
msf> use scanner/ssh/ssh_enumusers
```
### [ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©](../generic-methodologies-and-resources/brute-force.md#ssh)

[ì—¬ê¸°](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt)ì™€ [ì—¬ê¸°](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt)ì—ì„œ ì¼ë°˜ì ì¸ ssh ìê²© ì¦ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê°œì¸ í‚¤ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©

ì‚¬ìš© ê°€ëŠ¥í•œ ssh ê°œì¸ í‚¤ë¥¼ ì•Œê³  ìˆë‹¤ë©´... ì‹œë„í•´ ë´…ì‹œë‹¤. nmap ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html
```
ë˜ëŠ” MSF ë³´ì¡° ëª¨ë“ˆ:
```
msf> use scanner/ssh/ssh_identify_pubkeys
```
ë˜ëŠ” `ssh-keybrute.py` (ë„¤ì´í‹°ë¸Œ python3, ê°€ë²¼ìš°ë©° ë ˆê±°ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ í™œì„±í™”í•¨): [snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute).

#### ì•Œë ¤ì§„ ë‚˜ìœ í‚¤ëŠ” ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://github.com/rapid7/ssh-badkeys/tree/master/authorized" %}

#### ì•½í•œ SSH í‚¤ / Debian ì˜ˆì¸¡ ê°€ëŠ¥í•œ PRNG

ì¼ë¶€ ì‹œìŠ¤í…œì—ëŠ” ì•”í˜¸í™” ìë£Œë¥¼ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©ëœ ë‚œìˆ˜ ì‹œë“œì— ì•Œë ¤ì§„ ê²°í•¨ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¸Œë£¨íŠ¸í¬ìŠ¤ë¡œ í•´ë…ë  ìˆ˜ ìˆëŠ” í‚¤ ê³µê°„ì´ í¬ê²Œ ì¤„ì–´ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•½í•œ PRNGì— ì˜í–¥ì„ ë°›ëŠ” Debian ì‹œìŠ¤í…œì—ì„œ ìƒì„±ëœ ë¯¸ë¦¬ ìƒì„±ëœ í‚¤ ì„¸íŠ¸ëŠ” ì—¬ê¸°ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh).

í”¼í•´ì ë¨¸ì‹ ì— ëŒ€í•œ ìœ íš¨í•œ í‚¤ë¥¼ ê²€ìƒ‰í•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ ì°¸ì¡°í•´ì•¼ í•©ë‹ˆë‹¤.

### ì¼€ë¥´ë²„ë¡œìŠ¤

**crackmapexec**ì€ `ssh` í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ **ì¼€ë¥´ë²„ë¡œìŠ¤ë¥¼ í†µí•´ ì¸ì¦**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ìì„¸í•œ ì •ë³´ëŠ” `crackmapexec ssh --help`ë¥¼ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤.

## ê¸°ë³¸ ìê²© ì¦ëª…

| **ê³µê¸‰ì—…ì²´** | **ì‚¬ìš©ì ì´ë¦„**                                                                                             | **ë¹„ë°€ë²ˆí˜¸**                                                                                                                                                                                              |
| ---------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| APC        | apc, device                                                                                                 | apc                                                                                                                                                                                                        |
| Brocade    | admin                                                                                                       | admin123, password, brocade, fibranne                                                                                                                                                                      |
| Cisco      | admin, cisco, enable, hsa, pix, pnadmin, ripeop, root, shelladmin                                           | admin, Admin123, default, password, secur4u, cisco, Cisco, \_Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change\_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme |
| Citrix     | root, nsroot, nsmaint, vdiadmin, kvm, cli, admin                                                            | C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler                                                                                                                       |
| D-Link     | admin, user                                                                                                 | private, admin, user                                                                                                                                                                                       |
| Dell       | root, user1, admin, vkernel, cli                                                                            | calvin, 123456, password, vkernel, Stor@ge!, admin                                                                                                                                                         |
| EMC        | admin, root, sysadmin                                                                                       | EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc                                                                                                                                              |
| HP/3Com    | admin, root, vcx, app, spvar, manage, hpsupport, opc\_op                                                    | admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC\_op, !manage, !admin                                                   |
| Huawei     | admin, root                                                                                                 | 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123                                                                                             |
| IBM        | USERID, admin, manager, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, system, device, ufmcli, customer | PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer                                                                                                                               |
| Juniper    | netscreen                                                                                                   | netscreen                                                                                                                                                                                                  |
| NetApp     | admin                                                                                                       | netapp123                                                                                                                                                                                                  |
| Oracle     | root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user                                           | changeme, ilom-admin, ilom-operator, welcome1, oracle                                                                                                                                                      |
| VMware     | vi-admin, root, hqadmin, vmware, admin                                                                      | vmware, vmw@re, hqadmin, default                                                                                                                                                                           |

## SSH-MitM

í”¼í•´ìê°€ SSH ì„œë²„ì— ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ê²°í•˜ë ¤ëŠ” ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì— ìˆë‹¤ë©´ **MitM ê³µê²©ì„ ìˆ˜í–‰í•˜ì—¬ í•´ë‹¹ ìê²© ì¦ëª…ì„ ë„ë‚œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**

**ê³µê²© ê²½ë¡œ:**

* **íŠ¸ë˜í”½ ë¦¬ë‹¤ì´ë ‰ì…˜:** ê³µê²©ìëŠ” í”¼í•´ìì˜ íŠ¸ë˜í”½ì„ ìì‹ ì˜ ê¸°ê¸°ë¡œ **ì „í™˜**í•˜ì—¬ SSH ì„œë²„ë¡œì˜ ì—°ê²° ì‹œë„ë¥¼ **ê°€ë¡œì±•ë‹ˆë‹¤**.
* **ê°€ë¡œì±„ê¸° ë° ê¸°ë¡:** ê³µê²©ìì˜ ê¸°ê¸°ëŠ” **í”„ë¡ì‹œ**ë¡œ ì‘ë™í•˜ì—¬ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ì„¸ë¶€ ì •ë³´ë¥¼ **ê°€ë¡œì±„ì–´** ì •ë‹¹í•œ SSH ì„œë²„ì¸ ê²ƒì²˜ëŸ¼ ê°€ì¥í•©ë‹ˆë‹¤.
* **ëª…ë ¹ ì‹¤í–‰ ë° ë¦´ë ˆì´:** ë§ˆì§€ë§‰ìœ¼ë¡œ, ê³µê²©ìì˜ ì„œë²„ëŠ” ì‚¬ìš©ìì˜ ìê²© ì¦ëª…ì„ **ê¸°ë¡í•˜ê³ **, ëª…ë ¹ì„ **ì‹¤ì œ SSH ì„œë²„ë¡œ ì „ë‹¬í•˜ê³ **, ê·¸ ëª…ë ¹ì„ **ì‹¤í–‰**í•˜ê³ , ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ **ë‹¤ì‹œ ë³´ë‚´ì–´** í”„ë¡œì„¸ìŠ¤ê°€ ì›í™œí•˜ê³  ì •ë‹¹í•œ ê²ƒì²˜ëŸ¼ ë³´ì´ë„ë¡ í•©ë‹ˆë‹¤.

[**SSH MITM**](https://github.com/jtesta/ssh-mitm)ì€ ìœ„ì—ì„œ ì„¤ëª…í•œ ëŒ€ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

ì‹¤ì œ MitMì„ ìˆ˜í–‰í•˜ë ¤ë©´ ARP ìŠ¤í‘¸í•‘, DNS ìŠ¤í‘¸í•‘ ë˜ëŠ” [**ë„¤íŠ¸ì›Œí¬ ìŠ¤í‘¸í•‘ ê³µê²©**](../generic-methodologies-and-resources/pentesting-network/#spoofing)ì—ì„œ ì„¤ëª…ëœ ê¸°íƒ€ ê¸°ìˆ ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## SSH-Snake

ì‹œìŠ¤í…œì—ì„œ ë°œê²¬ëœ SSH ê°œì¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ì‹œìŠ¤í…œì—ì„œ ìƒˆ í˜¸ìŠ¤íŠ¸ì— ëŒ€í•´ ê° ê°œì¸ í‚¤ë¥¼ í™œìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ë¥¼ íƒìƒ‰í•˜ë ¤ë©´ [**SSH-Snake**](https://github.com/MegaManSec/SSH-Snake)ê°€ í•„ìš”í•©ë‹ˆë‹¤.

SSH-SnakeëŠ” ë‹¤ìŒ ì‘ì—…ì„ ìë™ìœ¼ë¡œ ë°˜ë³µí•©ë‹ˆë‹¤:

1. í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ SSH ê°œì¸ í‚¤ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
2. í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ ë°œê²¬ëœ ê°œì¸ í‚¤ê°€ ìˆ˜ë½ë  ìˆ˜ ìˆëŠ” ëª¨ë“  í˜¸ìŠ¤íŠ¸ ë˜ëŠ” ëŒ€ìƒ (ì‚¬ìš©ì@í˜¸ìŠ¤íŠ¸)ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
3. ë°œê²¬ëœ ëª¨ë“  ê°œì¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ëŒ€ìƒì— SSHë¥¼ ì‹œë„í•©ë‹ˆë‹¤.
4. ëŒ€ìƒì— ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ëœ ê²½ìš°, ì—°ê²°ëœ ì‹œìŠ¤í…œì—ì„œ ë‹¨ê³„ #1 - #4ë¥¼ ë°˜ë³µí•©ë‹ˆë‹¤.

ì´ëŠ” ì™„ì „íˆ ìì²´ ë³µì œ ë° ìì²´ ì „íŒŒë˜ë©° ì™„ì „íˆ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.

## êµ¬ì„± ì˜¤ë¥˜

### ë£¨íŠ¸ ë¡œê·¸ì¸

SSH ì„œë²„ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë£¨íŠ¸ ì‚¬ìš©ì ë¡œê·¸ì¸ì„ í—ˆìš©í•˜ëŠ” ê²ƒì€ ì¼ë°˜ì ì´ë©° ì¤‘ìš”í•œ ë³´ì•ˆ ìœ„í—˜ì„ ì•¼ê¸°í•©ë‹ˆë‹¤. **ë£¨íŠ¸ ë¡œê·¸ì¸ ë¹„í™œì„±í™”**ëŠ” ì„œë²„ë¥¼ ë³´í˜¸í•˜ëŠ” ì¤‘ìš”í•œ ë‹¨ê³„ì…ë‹ˆë‹¤. ì´ ë³€ê²½ ì‚¬í•­ì„ í†µí•´ ê´€ë¦¬ ê¶Œí•œì´ ì—†ëŠ” ì•¡ì„¸ìŠ¤ ë° ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©ì„ ì™„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**OpenSSHì—ì„œ ë£¨íŠ¸ ë¡œê·¸ì¸ ë¹„í™œì„±í™” ë°©ë²•:**

1. `sudoedit /etc/ssh/sshd_config`ë¡œ **SSH êµ¬ì„± íŒŒì¼ì„ í¸ì§‘**í•©ë‹ˆë‹¤.
2. `#PermitRootLogin yes`ì—ì„œ **`PermitRootLogin no`**ë¡œ ì„¤ì •ì„ **ë³€ê²½**í•©ë‹ˆë‹¤.
3. `sudo systemctl daemon-reload`ë¥¼ ì‚¬ìš©í•˜ì—¬ **êµ¬ì„±ì„ ë‹¤ì‹œë¡œë“œ**í•©ë‹ˆë‹¤.
4. ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•˜ë ¤ë©´ SSH ì„œë²„ë¥¼ **ë‹¤ì‹œ ì‹œì‘**í•©ë‹ˆë‹¤: `sudo systemctl restart sshd`

### SFTP ë¸Œë£¨íŠ¸ í¬ìŠ¤

* [**SFTP ë¸Œë£¨íŠ¸ í¬ìŠ¤**](../generic-methodologies-and-resources/brute-force.md#sftp)

### SFTP ëª…ë ¹ ì‹¤í–‰

SFTP ì„¤ì •ì—ì„œ í”íˆ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜ëŠ” ì‚¬ìš©ìì—ê²Œ ì›ê²© ì…¸ ì•¡ì„¸ìŠ¤ë¥¼ í™œì„±í™”í•˜ì§€ ì•Šê³  íŒŒì¼ì„ êµí™˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì„ ì˜ë„í•˜ëŠ” ê´€ë¦¬ìë“¤ì´ ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³ , ë¹„ëŒ€í™”ì‹ ì…¸ (ì˜ˆ: `/usr/bin/nologin`)ë¡œ ì‚¬ìš©ìë¥¼ ì„¤ì •í•˜ê³  íŠ¹ì • ë””ë ‰í† ë¦¬ë¡œ ì œí•œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë³´ì•ˆ êµ¬ë©ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤. **ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ ì§í›„ì— ì§€ì •ëœ ë¹„ëŒ€í™”ì‹ ì…¸ì´ ì‘ë™í•˜ê¸° ì „ì— (/bin/bashì™€ ê°™ì€) ëª…ë ¹ì„ ì‹¤í–‰í•˜ë„ë¡ ìš”ì²­í•¨ìœ¼ë¡œì¨** ì´ëŸ¬í•œ ì œí•œì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¬´ë‹¨ ëª…ë ¹ ì‹¤í–‰ì„ í—ˆìš©í•˜ì—¬ ì˜ë„í•œ ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ì•½í™”ì‹œí‚µë‹ˆë‹¤.

[ì—¬ê¸°ì—ì„œ ì˜ˆì œ](https://community.turgensec.com/ssh-hacking-guide/)
```bash
ssh -v noraj@192.168.1.94 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 192.168.1.94 ([192.168.1.94]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(noraj) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

$ ssh noraj@192.168.1.94 /bin/bash
```
ë‹¤ìŒì€ ì‚¬ìš©ì `noraj`ë¥¼ ìœ„í•œ ì•ˆì „í•œ SFTP êµ¬ì„± ì˜ˆì‹œ (`/etc/ssh/sshd_config` - openSSH)ì…ë‹ˆë‹¤:
```
Match User noraj
ChrootDirectory %h
ForceCommand internal-sftp
AllowTcpForwarding no
PermitTunnel no
X11Forwarding no
PermitTTY no
```
ì´ êµ¬ì„±ì€ ì˜¤ì§ SFTPë§Œ í—ˆìš©í•˜ë„ë¡ í•  ê²ƒì…ë‹ˆë‹¤: ì‹œì‘ ëª…ë ¹ì„ ê°•ì œë¡œ ì‹¤í–‰í•˜ì—¬ ì…¸ ì•¡ì„¸ìŠ¤ë¥¼ ë¹„í™œì„±í™”í•˜ê³  TTY ì•¡ì„¸ìŠ¤ë¥¼ ë¹„í™œì„±í™”í•˜ë©´ì„œ í¬íŠ¸ í¬ì›Œë”©ì´ë‚˜ í„°ë„ë§ì„ ëª¨ë‘ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.

### SFTP í„°ë„ë§

SFTP ì„œë²„ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´ ì¼ë°˜ì ì¸ í¬íŠ¸ í¬ì›Œë”©ì„ ì‚¬ìš©í•˜ì—¬ íŠ¸ë˜í”½ì„ í„°ë„ë§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
```bash
sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>
```
### SFTP ì‹¬ë³¼ë¦­ ë§í¬

**sftp**ì—ëŠ” "**symlink**" ëª…ë ¹ì´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ íŠ¹ì • í´ë”ì—ì„œ **ì“°ê¸° ê¶Œí•œ**ì´ ìˆë‹¤ë©´ **ë‹¤ë¥¸ í´ë”/íŒŒì¼ì˜ ì‹¬ë³¼ë¦­ ë§í¬**ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë§ˆë„ chroot ì•ˆì— **ê°‡í˜€** ìˆê¸° ë•Œë¬¸ì— ì´ê²ƒì€ íŠ¹ë³„íˆ **ìœ ìš©í•˜ì§€ ì•Šì„ ê²ƒ**ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìƒì„±ëœ **ì‹¬ë³¼ë¦­ ë§í¬**ì— **no-chroot ì„œë¹„ìŠ¤**(ì˜ˆ: ì›¹ì—ì„œ ì‹¬ë³¼ë¦­ ë§í¬ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ê²½ìš°)ì—ì„œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´ **ì›¹ì„ í†µí•´ ì‹¬ë³¼ë¦­ ë§í¬ëœ íŒŒì¼ì„ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

ì˜ˆë¥¼ ë“¤ì–´, ìƒˆ íŒŒì¼ **"**_**froot**_**"**ì—ì„œ **"**_**/**_**"**ë¡œ **ì‹¬ë³¼ë¦­ ë§í¬**ë¥¼ ìƒì„±í•˜ë ¤ë©´:
```bash
sftp> symlink / froot
```
### ì¸ì¦ ë°©ë²•

ê³ ì•ˆì „ í™˜ê²½ì—ì„œëŠ” ê°„ë‹¨í•œ íŒ¨ìŠ¤ì›Œë“œ ê¸°ë°˜ ì¸ì¦ë³´ë‹¤ëŠ” í‚¤ ê¸°ë°˜ ë˜ëŠ” ì´ì¤‘ ì¸ì¦ì„ í™œì„±í™”í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¢…ì¢… ê°•ë ¥í•œ ì¸ì¦ ë°©ë²•ì„ í™œì„±í™”í•œ ì±„ë¡œ ì•½í•œ ì¸ì¦ ë°©ë²•ì„ ë¹„í™œì„±í™”í•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ìì£¼ ë°œìƒí•˜ëŠ” ê²½ìš°ëŠ” openSSH êµ¬ì„±ì—ì„œ `publickey`ë¥¼ í™œì„±í™”í•˜ê³  ê¸°ë³¸ ë°©ë²•ìœ¼ë¡œ ì„¤ì •í•˜ì§€ë§Œ `password`ë¥¼ ë¹„í™œì„±í™”í•˜ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ SSH í´ë¼ì´ì–¸íŠ¸ì˜ ìƒì„¸ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê³µê²©ìëŠ” ì•½í•œ ë°©ë²•ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
ssh -v 192.168.1.94
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive
```
ì˜ˆë¥¼ ë“¤ì–´ ì¸ì¦ ì‹¤íŒ¨ í•œê³„ê°€ ì„¤ì •ë˜ì–´ ìˆê³  ë¹„ë°€ë²ˆí˜¸ ë°©ë²•ì— ë„ë‹¬í•  ê¸°íšŒê°€ ì—†ëŠ” ê²½ìš° `PreferredAuthentications` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì´ ë°©ë²•ì„ ê°•ì œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
ssh -v 192.168.1.94 -o PreferredAuthentications=password
...
debug1: Next authentication method: password
```
### êµ¬ì„± íŒŒì¼

SSH ì„œë²„ êµ¬ì„±ì„ ê²€í† í•˜ì—¬ ì˜ˆìƒëœ ë©”ì†Œë“œë§Œ í—ˆìš©ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ì—ì„œ verbose ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ì„±ì˜ íš¨ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
```bash
ssh_config
sshd_config
authorized_keys
ssh_known_hosts
known_hosts
id_rsa
```
## Fuzzing

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## ì°¸ê³  ìë£Œ

* [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html)
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **Intigriti**ì— ê°€ì…í•˜ì—¬ **í•´ì»¤ë“¤ì— ì˜í•´ ë§Œë“¤ì–´ì§„ í”„ë¦¬ë¯¸ì—„ ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**ì— ê°€ì…í•˜ì„¸ìš”! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) ì—ì„œ í•¨ê»˜ í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë°”ìš´í‹°ë¥¼ ë°›ì•„ë³´ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

## HackTricks ìë™ ëª…ë ¹ì–´
```
Protocol_Name: SSH
Port_Number: 22
Protocol_Description: Secure Shell Hardening

Entry_1:
Name: Hydra Brute Force
Description: Need Username
Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh

Entry_2:
Name: consolesless mfs enumeration
Description: SSH enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'

```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong></summary>

ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì—ì„œ ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•œë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
