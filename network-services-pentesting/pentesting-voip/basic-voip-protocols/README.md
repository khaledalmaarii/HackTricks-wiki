# Podstawowe protokoy VoIP

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Protokoy sygnalizacyjne

### SIP (Session Initiation Protocol)

Jest to standard przemysowy, aby uzyska wicej informacji, sprawd藕:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) to **protok贸 sygnalizacyjny** i **kontroli pocze** opisany w RFC 3435. Dziaa w architekturze scentralizowanej, skadajcej si z trzech g贸wnych komponent贸w:

1. **Agent pocze lub kontroler bramy multimedialnej (MGC)**: G贸wna brama w architekturze MGCP jest odpowiedzialna za **zarzdzanie i kontrol bram multimedialnych**. Obsuguje procesy konfiguracji, modyfikacji i zakoczenia pocze. MGC komunikuje si z bramami multimedialnymi za pomoc protokou MGCP.
2. **Bramy multimedialne (MG) lub bramy podrzdne**: Urzdzenia te **konwertuj strumienie medi贸w cyfrowych midzy r贸偶nymi sieciami**, takimi jak tradycyjna telefonia czona obwodowo i sieci pakietowe IP. S zarzdzane przez MGC i wykonuj otrzymane od niego polecenia. Bramy multimedialne mog obejmowa funkcje takie jak transkodowanie, pakietowanie i usuwanie echa.
3. **Bramy sygnalizacyjne (SG)**: Bramy te s odpowiedzialne za **konwertowanie wiadomoci sygnalizacyjnych midzy r贸偶nymi sieciami**, umo偶liwiajc pynn komunikacj midzy tradycyjnymi systemami telefonicznymi (np. SS7) a sieciami opartymi na protokole IP (np. SIP lub H.323). Bramy sygnalizacyjne s kluczowe dla interoperacyjnoci i zapewnienia prawidowego przekazywania informacji o kontroli pocze midzy r贸偶nymi sieciami.

Podsumowujc, MGCP scentralizowuje logik kontroli pocze w agencie pocze, co upraszcza zarzdzanie bramami multimedialnymi i sygnalizacyjnymi, zapewniajc lepsz skalowalno, niezawodno i wydajno w sieciach telekomunikacyjnych.

### SCCP (Skinny Client Control Protocol)

Skinny Client Control Protocol (SCCP) to **wasny protok贸 sygnalizacyjny i kontroli pocze** nale偶cy do Cisco Systems. Jest on g贸wnie **u偶ywany** do komunikacji midzy **Cisco Unified Communications Manager** (dawniej znany jako CallManager) a telefonami IP Cisco lub innymi urzdzeniami gosowymi i wideo Cisco.

SCCP to lekki protok贸, kt贸ry upraszcza komunikacj midzy serwerem kontroli pocze a urzdzeniami kocowymi. Jest nazywany "Skinny" ze wzgldu na swoje minimalistyczne projekty i mniejsze wymagania dotyczce przepustowoci w por贸wnaniu do innych protoko贸w VoIP, takich jak H.323 lub SIP.

G贸wne komponenty systemu opartego na SCCP to:

1. **Serwer kontroli pocze**: Ten serwer, zwykle Cisco Unified Communications Manager, zarzdza procesami konfiguracji, modyfikacji i zakoczenia pocze, a tak偶e innymi funkcjami telefonicznymi, takimi jak przekazywanie pocze, transfer pocze i wstrzymywanie pocze.
2. **Urzdzenia SCCP**: S to urzdzenia takie jak telefony IP, jednostki wideokonferencyjne lub inne urzdzenia gosowe i wideo Cisco, kt贸re u偶ywaj protokou SCCP do komunikacji z serwerem kontroli pocze. Rejestruj si w serwerze, wysyaj i odbieraj wiadomoci sygnalizacyjne oraz wykonuj instrukcje podane przez serwer kontroli pocze w celu obsugi pocze.
3. **Bramy**: Urzdzenia te, takie jak bramy gosowe lub bramy multimedialne, s odpowiedzialne za konwersj strumieni medi贸w midzy r贸偶nymi sieciami, takimi jak tradycyjna telefonia czona obwodowo i sieci pakietowe IP. Mog r贸wnie偶 zawiera dodatkowe funkcje, takie jak transkodowanie lub usuwanie echa.

SCCP oferuje prosty i wydajny spos贸b komunikacji midzy serwerami kontroli pocze Cisco a urzdzeniami kocowymi. Warto jednak zauwa偶y, 偶e **SCCP to protok贸 wasnociowy**, co mo偶e ogranicza interoperacyjno z systemami innych producent贸w. W takich przypadkach inne standardowe protokoy VoIP, takie jak SIP, mog by bardziej odpowiednie.

### H.323

H.323 to **zestaw protoko贸w** do komunikacji multimedialnej, w tym gosowej, wideo i konferencji danych w sieciach pakietowych, takich jak sieci oparte na protokole IP. Zosta opracowany przez **Midzynarodowy Zwizek Telekomunikacyjny** (ITU-T) i zapewnia kompleksow struktur zarzdzania sesjami komunikacji multimedialnej.

Niekt贸re kluczowe komponenty zestawu H.323 to:

1. **Terminaly**: S to urzdzenia kocowe, takie jak telefony IP, systemy wideokonferencyjne lub aplikacje oprogramowania, kt贸re obsuguj H.323 i mog uczestniczy w sesjach komunikacji multimedialnej.
2. **Bramy**: Urzdzenia te konwertuj strumienie medi贸w midzy r贸偶nymi sieciami, takimi jak tradycyjna telefonia czona obwodowo i sieci pakietowe IP, umo偶liwiajc interoperacyjno midzy H.323 a innymi systemami komunikacyjnymi. Mog r贸wnie偶 zawiera dodatkowe funkcje, takie jak transkodowanie lub usuwanie echa.
3. **Bramy kontrolne**: S to opcjonalne komponenty, kt贸re zapewniaj usugi kontroli i zarzdzania w sieci H.323. Wykonuj funkcje takie jak tumaczenie adres贸w, zarzdzanie przepustowoci i kontrola dostpu, pomagajc zarzdza i optymalizowa zasoby sieci.
4. **Jednost
## Protokoy transmisji i transportu

### SDP (Session Description Protocol)

SDP (Session Description Protocol) to **format oparty na tekcie**, u偶ywany do opisu cech sesji multimedialnych, takich jak gos, wideo lub konferencje danych, w sieciach IP. Zosta opracowany przez **Internet Engineering Task Force (IETF)** i jest zdefiniowany w **RFC 4566**. SDP nie zajmuje si faktyczn transmisj medi贸w ani ustanawianiem sesji, ale jest u偶ywany w poczeniu z innymi protokoami sygnalizacyjnymi, takimi jak **SIP (Session Initiation Protocol)**, do negocjacji i wymiany informacji na temat strumieni multimedialnych i ich cech.

Niekt贸re kluczowe elementy SDP to:

1. **Informacje o sesji**: SDP opisuje szczeg贸y sesji multimedialnej, w tym nazw sesji, opis sesji, czas rozpoczcia i zakoczenia.
2. **Strumienie multimedialne**: SDP definiuje cechy strumieni multimedialnych, takie jak typ medi贸w (d藕wik, wideo lub tekst), protok贸 transportowy (np. RTP lub SRTP) i format medi贸w (np. informacje o kodeku).
3. **Informacje o poczeniu**: SDP zawiera informacje o adresie sieciowym (adres IP) i numerze portu, na kt贸ry nale偶y wysya lub odbiera media.
4. **Atrybuty**: SDP obsuguje u偶ycie atrybut贸w do dostarczania dodatkowych, opcjonalnych informacji o sesji lub strumieniu multimedialnym. Atrybuty mog by u偶ywane do okrelania r贸偶nych funkcji, takich jak klucze szyfrowania, wymagania dotyczce przepustowoci lub mechanizmy kontroli medi贸w.

SDP jest zwykle u偶ywany w nastpujcym procesie:

1. Inicjujca strona tworzy opis SDP proponowanej sesji multimedialnej, w tym szczeg贸y strumieni multimedialnych i ich cechy.
2. Opis SDP jest wysyany do strony odbierajcej, zazwyczaj osadzony w wiadomoci protokou sygnalizacyjnego, takiego jak SIP lub RTSP.
3. Strona odbierajca przetwarza opis SDP i na podstawie swoich mo偶liwoci mo偶e zaakceptowa, odrzuci lub zmodyfikowa proponowan sesj.
4. Ostateczny opis SDP jest wysyany z powrotem do inicjujcej strony jako cz wiadomoci protokou sygnalizacyjnego, koczc proces negocjacji.

Prostota i elastyczno SDP sprawiaj, 偶e jest on powszechnie stosowanym standardem do opisu sesji multimedialnych w r贸偶nych systemach komunikacyjnych, odgrywajc kluczow rol w ustanawianiu i zarzdzaniu sesjami multimedialnymi w czasie rzeczywistym w sieciach IP.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP to protok贸 sieciowy zaprojektowany do dostarczania danych audio i wideo lub innych medi贸w w czasie rzeczywistym w sieciach IP. Opracowany przez **IETF** i zdefiniowany w **RFC 3550**, RTP jest czsto u偶ywany z protokoami sygnalizacyjnymi, takimi jak SIP i H.323, aby umo偶liwi komunikacj multimedialn. RTP zapewnia mechanizmy **synchronizacji**, **sekwencjonowania** i **znakowania czasowego** strumieni multimedialnych, pomagajc w zapewnieniu pynnego i terminowego odtwarzania medi贸w.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP to protok贸 towarzyszcy RTP, u偶ywany do monitorowania jakoci usugi (QoS) i dostarczania informacji zwrotnej na temat transmisji strumieni multimedialnych. Zdefiniowany w tym samym **RFC 3550** co RTP, RTCP **okresowo wymienia pakiety kontrolne midzy uczestnikami sesji RTP**. Udostpnia informacje takie jak utrata pakiet贸w, jitter i czas RTT, co pomaga w diagnozowaniu i dostosowywaniu si do warunk贸w sieciowych, poprawiajc og贸ln jako medi贸w.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP to rozszerzenie protokou RTP, kt贸re zapewnia **szyfrowanie**, **uwierzytelnianie wiadomoci** i **ochron przed odtwarzaniem** dla strumieni multimedialnych, zapewniajc bezpieczn transmisj wra偶liwych danych audio i wideo. Zdefiniowany w **RFC 3711**, SRTP u偶ywa algorytm贸w kryptograficznych, takich jak AES do szyfrowania i HMAC-SHA1 do uwierzytelniania wiadomoci. SRTP jest czsto u偶ywany w poczeniu z bezpiecznymi protokoami sygnalizacyjnymi, takimi jak SIP przez TLS, aby zapewni bezpieczestwo end-to-end w komunikacji multimedialnej.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP to protok贸 konsensusu kryptograficznego, kt贸ry zapewnia **szyfrowanie end-to-end** dla strumieni multimedialnych RTP. Opracowany przez Phila Zimmermanna, tw贸rc PGP, ZRTP jest opisany w **RFC 6189**. W przeciwiestwie do SRTP, kt贸ry polega na protokoach sygnalizacyjnych do wymiany kluczy, ZRTP jest zaprojektowany do pracy niezale偶nie od protokou sygnalizacyjnego. Wykorzystuje **wymian kluczy Diffie-Hellmana** do ustanowienia wsp贸lnego sekretu midzy komunikujcymi si stronami, bez koniecznoci wczeniejszego zaufania lub infrastruktury klucza publicznego (PKI). ZRTP zawiera r贸wnie偶 funkcje takie jak **kr贸tkie cigi uwierzytelniajce (SAS)**, kt贸re chroni przed atakami typu man-in-the-middle.

Te protokoy odgrywaj kluczowe role w **dostarczaniu i zabezpieczaniu komunikacji multimedialnej w czasie rzeczywistym w sieciach IP**. Podczas gdy RTP i RTCP zajmuj si faktyczn transmisj medi贸w i monitorowaniem jakoci, SRTP i ZRTP zapewniaj, 偶e przesyane media s chronione przed podsuchiwaniem, manipulacj i atakami typu odtwarzanie.
