# Podstawowe protokoy VoIP

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) to wyszukiwarka zasilana **dark webem**, kt贸ra oferuje **darmowe** funkcje sprawdzania, czy firma lub jej klienci zostali **skompromitowani** przez **zoliwe oprogramowanie kradnce informacje**.

Ich g贸wnym celem WhiteIntel jest zwalczanie przej kont i atak贸w ransomware wynikajcych z zoliwego oprogramowania kradncego informacje.

Mo偶esz sprawdzi ich stron internetow i wypr贸bowa ich silnik **za darmo** pod adresem:

{% embed url="https://whiteintel.io" %}

---

## Protokoy sygnalizacyjne

### SIP (Protok贸 inicjacji sesji)

Jest to standard przemysowy, aby uzyska wicej informacji, sprawd藕:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Protok贸 kontroli bramy multimedialnej)

MGCP (Media Gateway Control Protocol) to **protok贸 sygnalizacyjny** i **kontroli pocze** opisany w RFC 3435. Dziaa w architekturze scentralizowanej, kt贸ra skada si z trzech g贸wnych komponent贸w:

1. **Agent pocze lub kontroler bramy multimedialnej (MGC)**: G贸wna brama w architekturze MGCP jest odpowiedzialna za **zarzdzanie i kontrol bram multimedialnych**. Obsuguje procesy konfiguracji, modyfikacji i zakoczenia pocze. MGC komunikuje si z bramami multimedialnymi za pomoc protokou MGCP.
2. **Bramy multimedialne (MG) lub bramy niewolnicze**: Te urzdzenia **konwertuj strumienie medi贸w cyfrowych midzy r贸偶nymi sieciami**, takimi jak tradycyjna telefonia przeczana obwodowo i sieci pakietowe IP. S zarzdzane przez MGC i wykonuj polecenia otrzymane od niego. Bramy multimedialne mog zawiera funkcje takie jak transkodowanie, pakietowanie i usuwanie echa.
3. **Bramy sygnalizacyjne (SG)**: Te bramy s odpowiedzialne za **konwertowanie komunikat贸w sygnalizacyjnych midzy r贸偶nymi sieciami**, umo偶liwiajc pynn komunikacj midzy tradycyjnymi systemami telefonicznymi (np. SS7) a sieciami opartymi na IP (np. SIP lub H.323). Bramy sygnalizacyjne s kluczowe dla interoperacyjnoci i zapewnienia prawidowej komunikacji informacji o kontroli pocze midzy r贸偶nymi sieciami.

Podsumowujc, MGCP scentralizowuje logik kontroli pocze w agencie pocze, co upraszcza zarzdzanie bramami multimedialnymi i sygnalizacyjnymi, zapewniajc lepsz skalowalno, niezawodno i efektywno w sieciach telekomunikacyjnych.

### SCCP (Protok贸 kontroli klienta Skinny)

Skinny Client Control Protocol (SCCP) to **wasny protok贸 sygnalizacyjny i kontroli pocze** nale偶cy do Cisco Systems. Jest on g贸wnie **u偶ywany** do komunikacji midzy **Cisco Unified Communications Manager** (dawniej znany jako CallManager) a telefonami IP Cisco lub innymi punktami kocowymi gosu i wideo Cisco.

SCCP to lekki protok贸, kt贸ry upraszcza komunikacj midzy serwerem kontroli pocze a urzdzeniami kocowymi. Jest nazywany "Skinny" ze wzgldu na swoje minimalistyczne projekty i mniejsze wymagania dotyczce przepustowoci w por贸wnaniu z innymi protokoami VoIP, takimi jak H.323 lub SIP.

G贸wne skadniki systemu opartego na SCCP to:

1. **Serwer kontroli pocze**: Ten serwer, zwykle Cisco Unified Communications Manager, zarzdza procesami konfiguracji, modyfikacji i zakoczenia pocze, a tak偶e innymi funkcjami telefonicznymi, takimi jak przekazywanie pocze, transfer pocze i utrzymanie poczenia.
2. **Punkty kocowe SCCP**: S to urzdzenia, takie jak telefony IP, jednostki wideokonferencyjne lub inne punkty kocowe gosu i wideo Cisco, kt贸re u偶ywaj SCCP do komunikacji z serwerem kontroli pocze. Rejestruj si one w serwerze, wysyaj i odbieraj komunikaty sygnalizacyjne oraz wykonuj instrukcje podane przez serwer kontroli pocze w zakresie obsugi pocze.
3. **Bramy**: Te urzdzenia, takie jak bramy gosowe lub multimedialne, s odpowiedzialne za konwertowanie strumieni medi贸w midzy r贸偶nymi sieciami, takimi jak tradycyjna telefonia przeczana obwodowo i sieci pakietowe IP. Mog one r贸wnie偶 zawiera dodatkowe funkcje, takie jak transkodowanie lub usuwanie echa.

SCCP oferuje prosty i efektywny spos贸b komunikacji midzy serwerami kontroli pocze Cisco a urzdzeniami kocowymi. Warto jednak zauwa偶y, 偶e **SCCP to protok贸 wasnociowy**, co mo偶e ogranicza interoperacyjno z systemami nie-Cisco. W takich przypadkach inne standardowe protokoy VoIP, takie jak SIP, mog by bardziej odpowiednie.

### H.323

H.323 to **zestaw protoko贸w** do komunikacji multimedialnej, w tym gosowej, wideo i konferencji danych w sieciach przeczanych pakietowo, takich jak sieci oparte na IP. Zosta opracowany przez **Midzynarodowy Zwizek Telekomunikacyjny** (ITU-T) i zapewnia kompleksow struktur do zarzdzania sesjami komunikacji multimedialnej.

Niekt贸re kluczowe skadniki zestawu H.323 to:

1. **Terminaly**: S to urzdzenia kocowe, takie jak telefony IP, systemy wideokonferencyjne lub aplikacje oprogramowania, kt贸re obsuguj H.323 i mog uczestniczy w sesjach komunikacji multimedialnej.
2. **Bramy**: Te urzdzenia konwertuj strumienie medi贸w midzy r贸偶nymi sieciami, takimi jak tradycyjna telefonia przeczana obwodowo i sieci pakietowe IP, umo偶liwiajc interoperacyjno midzy H.323 a innymi systemami komunikacyjnymi. Mog one r贸wnie偶 zawiera dodatkowe funkcje, takie jak transkodowanie lub usuwanie echa.
3. **Bramy gosowe**: S to opcjonalne komponenty, kt贸re zapewniaj usugi kontroli pocze i zarzdzania w sieci H.323. Wykonuj funkcje takie jak tumaczenie adres贸w, zarzdzanie przepustowoci i kontrola dostpu, pomagajc w zarzdzaniu i optymalizacji zasob贸w sieciowych.
4. **Jednostki kontroli wielopunktowej (MCU)**: Te urzdzenia uatwiaj konferencje wielopunktowe, zarzdzajc i mieszajc strumienie medi贸w z wielu punkt贸w kocowych. MCU umo偶liwiaj funkcje takie jak kontrola ukadu wideo, przeczanie aktywowane gosem i ciga obecno, umo偶liwiajc organizowanie konferencji o du偶ym zasigu z udziaem wielu uczestnik贸w.

H.323 obsuguje szereg kodek贸w audio i wideo, a tak偶e inne usugi dodatkowe, takie jak przekazywanie pocze, transfer pocze, utrzymanie poczenia i oczekiwanie na poczenie. Pomimo swojego szerokiego zastosowania we wczesnych dniach VoIP, H.323 stopniowo zosta zastpiony przez bardziej nowoczesne i elastyczne protokoy, takie jak **Protok贸 inicjacji sesji (SIP)**, kt贸ry oferuje lepsz interoperacyjno i atwiejsz implementacj. Niemniej jednak H.323 nadal jest u偶ywany w wielu systemach dziedzicznych i nadal jest obsugiwany przez r贸偶nych dostawc贸w sprztu.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) to **protok贸 sygnalizacyjny i kontroli pocze** g贸wnie u偶ywany do komunikacji midzy serwerami Asterisk PBX (Private Branch Exchange) a innymi urzdzeniami VoIP. Zosta opracowany przez Marka Spencera, tw贸rc oprogramowania Asterisk PBX typu open-source, jako alternatywa dla innych protoko贸w VoIP, takich jak SIP i H.323.

IAX jest znany ze swojej **prostoty, efektywnoci i atwoci implementacji**. Niekt贸re kluczowe cechy IAX to:

1. **Jeden port UDP**: IAX u偶ywa jednego portu UDP (4569) zar贸wno do sygnalizacji, jak i ruchu multimedialnego, co upraszcza przekraczanie zap贸r ogniowych i NAT, uatwiajc wdro偶enie w r贸偶nych rodowiskach sieciowych.
2. **Protok贸 binarny**: W przeciwiestwie do protoko贸w opartych na tekcie, takich jak SIP, IAX jest protokoem binarnym, co zmniejsza jego zu偶ycie przepustowoci i sprawia, 偶e jest bardziej efektywny w przesyaniu danych sygnalizacyjnych i multimedialnych.
3. **Trunking**: IAX obsuguje trunking, co pozwala na czenie wielu pocze w pojedyncze poczenie sieciowe, zmniejszajc nadmiar i poprawiajc wykorzystanie przepustowoci.
4. **Natywne szyfrowanie**: IAX ma wbudowane wsparcie dla szyfrowania, u偶ywajc metod takich jak RSA do wymiany kluczy i AES do szyfrowania medi贸w, zapewniajc bezpieczn komunikacj midzy punktami kocowymi.
5. **Komunikacja punkt-punkt**: IAX mo偶e by u偶ywany do bezporedniej komunikacji midzy punktami kocowymi bez koniecznoci centralnego serwera, umo偶liwiajc prostsze i bardziej efektywne kierowanie poczeniami.

Mimo swoich zalet IAX ma pewne ograniczenia, takie jak g贸wny nacisk na ekosystem Asterisk i mniejsze rozpowszechnienie w por贸wnaniu z bardziej ugruntowanymi protokoami, takimi jak SIP. W rezultacie IAX mo偶e nie by najlepszym wyborem dla interoperacyjnoci z systemami lub urzdzeniami spoza rodowiska Asterisk. Niemniej jednak dla os贸b pracujcych w rodowisku Asterisk, IAX oferuje solidne i efektywne rozwizanie dla komunikacji VoIP.
## Protokoy transmisji i transportu

### SDP (Session Description Protocol)

SDP (Session Description Protocol) to **format oparty na tekcie**, u偶ywany do opisywania cech sesji multimedialnych, takich jak gos, wideo lub konferencje danych, w sieciach IP. Zosta opracowany przez **Internet Engineering Task Force (IETF)** i jest zdefiniowany w **RFC 4566**. SDP nie zajmuje si faktyczn transmisj medi贸w ani ustanawianiem sesji, ale jest u偶ywany w poczeniu z innymi protokoami sygnalizacyjnymi, takimi jak **SIP (Session Initiation Protocol)**, do negocjacji i wymiany informacji na temat strumieni medi贸w i ich cech.

Niekt贸re kluczowe elementy SDP to:

1. **Informacje o sesji**: SDP opisuje szczeg贸y sesji multimedialnej, w tym nazw sesji, opis sesji, czas rozpoczcia i zakoczenia.
2. **Strumienie medi贸w**: SDP definiuje cechy strumieni medi贸w, takie jak typ medi贸w (audio, wideo lub tekst), protok贸 transportowy (np. RTP lub SRTP) i format medi贸w (np. informacje o kodeku).
3. **Informacje o poczeniu**: SDP dostarcza informacje o adresie sieciowym (adres IP) i numerze portu, na kt贸ry nale偶y wysa lub odebra media.
4. **Atrybuty**: SDP obsuguje u偶ycie atrybut贸w do dostarczania dodatkowych, opcjonalnych informacji o sesji lub strumieniu medi贸w. Atrybuty mog by u偶ywane do okrelania r贸偶nych funkcji, takich jak klucze szyfrowania, wymagania dotyczce przepustowoci lub mechanizmy kontroli medi贸w.

SDP jest zazwyczaj u偶ywany w nastpujcym procesie:

1. Inicjujca strona tworzy opis SDP proponowanej sesji multimedialnej, w tym szczeg贸y strumieni medi贸w i ich cechy.
2. Opis SDP jest wysyany do strony odbierajcej, zazwyczaj osadzony w wiadomoci protokou sygnalizacyjnego, takiego jak SIP lub RTSP.
3. Strona odbierajca przetwarza opis SDP, a na podstawie swoich mo偶liwoci mo偶e zaakceptowa, odrzuci lub zmodyfikowa proponowan sesj.
4. Ostateczny opis SDP jest wysyany z powrotem do inicjujcej strony jako cz wiadomoci protokou sygnalizacyjnego, finalizujc proces negocjacji.

Prostota i elastyczno SDP sprawiaj, 偶e jest powszechnie przyjtym standardem do opisywania sesji multimedialnych w r贸偶nych systemach komunikacyjnych, odgrywajc kluczow rol w ustanawianiu i zarzdzaniu sesjami multimedialnymi w czasie rzeczywistym w sieciach IP.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP to protok贸 sieciowy zaprojektowany do dostarczania danych audio i wideo lub innych medi贸w w czasie rzeczywistym w sieciach IP. Opracowany przez **IETF** i zdefiniowany w **RFC 3550**, RTP jest czsto u偶ywany z protokoami sygnalizacyjnymi, takimi jak SIP i H.323, aby umo偶liwi komunikacj multimedialn. RTP zapewnia mechanizmy **synchronizacji**, **sekwencjonowania** i **znakowania czasowego** strumieni medi贸w, pomagajc zapewni pynne i terminowe odtwarzanie medi贸w.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP to protok贸 towarzyszcy RTP, u偶ywany do monitorowania jakoci usug (QoS) i dostarczania informacji zwrotnej na temat transmisji strumieni medi贸w. Zdefiniowany w tym samym **RFC 3550** co RTP, RTCP **okresowo wymienia pakiety kontrolne midzy uczestnikami sesji RTP**. Udostpnia informacje takie jak utrata pakiet贸w, d偶iter, czas podr贸偶y w obie strony, co pomaga w diagnozowaniu i dostosowywaniu si do warunk贸w sieciowych, poprawiajc og贸ln jako medi贸w.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP to rozszerzenie RTP, kt贸re zapewnia **szyfrowanie**, **uwierzytelnianie wiadomoci** i **ochron przed odtworzeniem** dla strumieni medi贸w, zapewniajc bezpieczn transmisj wra偶liwych danych audio i wideo. Zdefiniowany w **RFC 3711**, SRTP u偶ywa algorytm贸w kryptograficznych, takich jak AES do szyfrowania i HMAC-SHA1 do uwierzytelniania wiadomoci. SRTP jest czsto u偶ywany w poczeniu z bezpiecznymi protokoami sygnalizacyjnymi, takimi jak SIP przez TLS, aby zapewni bezpieczestwo end-to-end w komunikacji multimedialnej.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP to protok贸 uzgadniania klucza kryptograficznego, kt贸ry zapewnia **szyfrowanie end-to-end** dla strumieni medi贸w RTP. Opracowany przez Phila Zimmermanna, tw贸rc PGP, ZRTP jest opisany w **RFC 6189**. W przeciwiestwie do SRTP, kt贸ry polega na protokoach sygnalizacyjnych do wymiany kluczy, ZRTP jest zaprojektowany do pracy niezale偶nie od protokou sygnalizacyjnego. Wykorzystuje **wymian kluczy Diffie-Hellmana** do ustanowienia wsp贸lnego sekretu midzy komunikujcymi si stronami, nie wymagajc wczeniejszego zaufania ani infrastruktury kluczy publicznych (PKI). ZRTP zawiera r贸wnie偶 funkcje takie jak **kr贸tkie cigi uwierzytelniajce (SAS)**, aby chroni przed atakami typu man-in-the-middle.

Te protokoy odgrywaj istotne role w **dostarczaniu i zabezpieczaniu komunikacji multimedialnej w czasie rzeczywistym w sieciach IP**. Podczas gdy RTP i RTCP zajmuj si faktyczn transmisj medi贸w i monitorowaniem jakoci, SRTP i ZRTP zapewniaj, 偶e przesyane media s chronione przed podsuchiwaniem, manipulacj i atakami typu odtworzenie.
