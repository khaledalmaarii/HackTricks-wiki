# Grundlegende VoIP-Protokolle

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
{% endhint %}

## Signalisierungsprotokolle

### SIP (Session Initiation Protocol)

Dies ist der Industriestandard, f√ºr weitere Informationen siehe:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) ist ein **Signalisierungs-** und **Anrufkontrollprotokoll**, das in RFC 3435 beschrieben ist. Es arbeitet in einer zentralisierten Architektur, die aus drei Hauptkomponenten besteht:

1. **Call Agent oder Media Gateway Controller (MGC)**: Das Hauptgateway in der MGCP-Architektur ist verantwortlich f√ºr die **Verwaltung und Kontrolle der Medien-Gateways**. Es verwaltet die Prozesse zur Anrufeinrichtung, -√§nderung und -beendigung. Der MGC kommuniziert mit den Medien-Gateways √ºber das MGCP-Protokoll.
2. **Media Gateways (MGs) oder Slave Gateways**: Diese Ger√§te **konvertieren digitale Medienstr√∂me zwischen verschiedenen Netzwerken**, wie traditioneller leitungsvermittelter Telefonie und paketvermittelten IP-Netzwerken. Sie werden vom MGC verwaltet und f√ºhren die von ihm empfangenen Befehle aus. Medien-Gateways k√∂nnen Funktionen wie Transkodierung, Paketierung und Echo-Unterdr√ºckung umfassen.
3. **Signalisierungs-Gateways (SGs)**: Diese Gateways sind verantwortlich f√ºr die **Umwandlung von Signalisierungsnachrichten zwischen verschiedenen Netzwerken**, die eine nahtlose Kommunikation zwischen traditionellen Telefonsystemen (z. B. SS7) und IP-basierten Netzwerken (z. B. SIP oder H.323) erm√∂glichen. Signalisierungs-Gateways sind entscheidend f√ºr die Interoperabilit√§t und stellen sicher, dass Anrufkontrollinformationen ordnungsgem√§√ü zwischen den verschiedenen Netzwerken kommuniziert werden.

Zusammenfassend zentralisiert MGCP die Anrufkontrolllogik im Anrufagenten, was die Verwaltung von Medien- und Signalisierungs-Gateways vereinfacht und eine bessere Skalierbarkeit, Zuverl√§ssigkeit und Effizienz in Telekommunikationsnetzen bietet.

### SCCP (Skinny Client Control Protocol)

Skinny Client Control Protocol (SCCP) ist ein **propriet√§res Signalisierungs- und Anrufkontrollprotokoll**, das im Besitz von Cisco Systems ist. Es wird haupts√§chlich **verwendet** f√ºr die Kommunikation zwischen **Cisco Unified Communications Manager** (ehemals bekannt als CallManager) und Cisco IP-Telefonen oder anderen Cisco Sprach- und Videoendpunkten.

SCCP ist ein leichtgewichtiges Protokoll, das die Kommunikation zwischen dem Anrufkontrollserver und den Endger√§ten vereinfacht. Es wird als "Skinny" bezeichnet, weil es ein minimalistisches Design und reduzierte Bandbreitenanforderungen im Vergleich zu anderen VoIP-Protokollen wie H.323 oder SIP hat.

Die Hauptkomponenten eines SCCP-basierten Systems sind:

1. **Anrufkontrollserver**: Dieser Server, typischerweise ein Cisco Unified Communications Manager, verwaltet die Prozesse zur Anrufeinrichtung, -√§nderung und -beendigung sowie andere Telefoniefunktionen wie Anrufweiterleitung, Anruf√ºbertragung und Anrufhalten.
2. **SCCP-Endpunkte**: Dies sind Ger√§te wie IP-Telefone, Videokonferenzsysteme oder andere Cisco Sprach- und Videoendpunkte, die SCCP verwenden, um mit dem Anrufkontrollserver zu kommunizieren. Sie registrieren sich beim Server, senden und empfangen Signalisierungsnachrichten und befolgen die Anweisungen des Anrufkontrollservers zur Anrufbearbeitung.
3. **Gateways**: Diese Ger√§te, wie Sprachgateways oder Medien-Gateways, sind verantwortlich f√ºr die Umwandlung von Medienstr√∂men zwischen verschiedenen Netzwerken, wie traditioneller leitungsvermittelter Telefonie und paketvermittelten IP-Netzwerken. Sie k√∂nnen auch zus√§tzliche Funktionen wie Transkodierung oder Echo-Unterdr√ºckung umfassen.

SCCP bietet eine einfache und effiziente Kommunikationsmethode zwischen Cisco-Anrufkontrollservern und Endger√§ten. Es ist jedoch zu beachten, dass **SCCP ein propriet√§res Protokoll ist**, was die Interoperabilit√§t mit Nicht-Cisco-Systemen einschr√§nken kann. In solchen F√§llen k√∂nnen andere standardisierte VoIP-Protokolle wie SIP geeigneter sein.

### H.323

H.323 ist eine **Protokoll-Suite** f√ºr die Multimedia-Kommunikation, einschlie√ülich Sprache, Video und Datenkonferenzen √ºber paketvermittelte Netzwerke, wie IP-basierte Netzwerke. Es wurde von der **International Telecommunication Union** (ITU-T) entwickelt und bietet einen umfassenden Rahmen f√ºr die Verwaltung von Multimedia-Kommunikationssitzungen.

Einige wichtige Komponenten der H.323-Suite sind:

1. **Terminals**: Dies sind Endger√§te, wie IP-Telefone, Videokonferenzsysteme oder Softwareanwendungen, die H.323 unterst√ºtzen und an Multimedia-Kommunikationssitzungen teilnehmen k√∂nnen.
2. **Gateways**: Diese Ger√§te konvertieren Medienstr√∂me zwischen verschiedenen Netzwerken, wie traditioneller leitungsvermittelter Telefonie und paketvermittelten IP-Netzwerken, und erm√∂glichen die Interoperabilit√§t zwischen H.323 und anderen Kommunikationssystemen. Sie k√∂nnen auch zus√§tzliche Funktionen wie Transkodierung oder Echo-Unterdr√ºckung umfassen.
3. **Gatekeeper**: Dies sind optionale Komponenten, die Anrufkontroll- und Verwaltungsdienste in einem H.323-Netzwerk bereitstellen. Sie f√ºhren Funktionen wie Adress√ºbersetzung, Bandbreitenmanagement und Zugangssteuerung aus, um Netzwerkressourcen zu verwalten und zu optimieren.
4. **Multipoint Control Units (MCUs)**: Diese Ger√§te erleichtern Mehrpunktkonferenzen, indem sie Medienstr√∂me von mehreren Endpunkten verwalten und mischen. MCUs erm√∂glichen Funktionen wie Video-Layout-Kontrolle, sprachaktiviertes Umschalten und kontinuierliche Pr√§senz, wodurch es m√∂glich wird, gro√ü angelegte Konferenzen mit mehreren Teilnehmern zu veranstalten.

H.323 unterst√ºtzt eine Reihe von Audio- und Video-Codecs sowie andere erg√§nzende Dienste wie Anrufweiterleitung, Anruf√ºbertragung, Anrufhalten und Anrufwarteschleife. Trotz seiner weit verbreiteten Akzeptanz in den fr√ºhen Tagen von VoIP wurde H.323 allm√§hlich durch modernere und flexiblere Protokolle wie das **Session Initiation Protocol (SIP)** ersetzt, das eine bessere Interoperabilit√§t und einfachere Implementierung bietet. H.323 bleibt jedoch in vielen Altsystemen im Einsatz und wird weiterhin von verschiedenen Ger√§teanbietern unterst√ºtzt.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) ist ein **Signalisierungs- und Anrufkontrollprotokoll**, das haupts√§chlich f√ºr die Kommunikation zwischen Asterisk PBX (Private Branch Exchange) Servern und anderen VoIP-Ger√§ten verwendet wird. Es wurde von Mark Spencer, dem Sch√∂pfer der Asterisk Open-Source-PBX-Software, als Alternative zu anderen VoIP-Protokollen wie SIP und H.323 entwickelt.

IAX ist bekannt f√ºr seine **Einfachheit, Effizienz und einfache Implementierung**. Einige wichtige Merkmale von IAX sind:

1. **Einzelner UDP-Port**: IAX verwendet einen einzigen UDP-Port (4569) f√ºr sowohl Signalisierungs- als auch Mediendatenverkehr, was die Firewall- und NAT-√úberwindung vereinfacht und die Bereitstellung in verschiedenen Netzwerkumgebungen erleichtert.
2. **Bin√§res Protokoll**: Im Gegensatz zu textbasierten Protokollen wie SIP ist IAX ein bin√§res Protokoll, das den Bandbreitenverbrauch reduziert und es effizienter macht, Signalisierungs- und Mediendaten zu √ºbertragen.
3. **Trunking**: IAX unterst√ºtzt Trunking, das es erm√∂glicht, mehrere Anrufe in einer einzigen Netzwerkverbindung zu kombinieren, wodurch der Overhead reduziert und die Bandbreitennutzung verbessert wird.
4. **Native Verschl√ºsselung**: IAX hat integrierte Unterst√ºtzung f√ºr Verschl√ºsselung, verwendet Methoden wie RSA f√ºr den Schl√ºsselaustausch und AES f√ºr die Medienverschl√ºsselung, um eine sichere Kommunikation zwischen Endpunkten zu gew√§hrleisten.
5. **Peer-to-Peer-Kommunikation**: IAX kann f√ºr die direkte Kommunikation zwischen Endpunkten ohne die Notwendigkeit eines zentralen Servers verwendet werden, was eine einfachere und effizientere Anrufweiterleitung erm√∂glicht.

Trotz seiner Vorteile hat IAX einige Einschr√§nkungen, wie den prim√§ren Fokus auf das Asterisk-√ñkosystem und eine geringere Verbreitung im Vergleich zu etablierten Protokollen wie SIP. Daher ist IAX m√∂glicherweise nicht die beste Wahl f√ºr die Interoperabilit√§t mit Nicht-Asterisk-Systemen oder -Ger√§ten. F√ºr diejenigen, die im Asterisk-Umfeld arbeiten, bietet IAX jedoch eine robuste und effiziente L√∂sung f√ºr die VoIP-Kommunikation.

## √úbertragungs- & Transportprotokolle

### SDP (Session Description Protocol)

SDP (Session Description Protocol) ist ein **textbasiertes Format**, das verwendet wird, um die Eigenschaften von Multimedia-Sitzungen, wie Sprache, Video oder Datenkonferenzen, √ºber IP-Netzwerke zu beschreiben. Es wurde von der **Internet Engineering Task Force (IETF)** entwickelt und ist in **RFC 4566** definiert. SDP behandelt nicht die tats√§chliche Medien√ºbertragung oder die Sitzungsherstellung, sondern wird in Verbindung mit anderen Signalisierungsprotokollen, wie **SIP (Session Initiation Protocol)**, verwendet, um Informationen √ºber die Medienstr√∂me und deren Attribute auszuhandeln und auszutauschen.

Einige wichtige Elemente von SDP sind:

1. **Sitzungsinformationen**: SDP beschreibt die Einzelheiten einer Multimedia-Sitzung, einschlie√ülich Sitzungsname, Sitzungsbeschreibung, Startzeit und Endzeit.
2. **Medienstr√∂me**: SDP definiert die Eigenschaften von Medienstr√∂men, wie den Medientyp (Audio, Video oder Text), das Transportprotokoll (z. B. RTP oder SRTP) und das Medienformat (z. B. Codec-Informationen).
3. **Verbindungsinformationen**: SDP liefert Informationen √ºber die Netzwerkadresse (IP-Adresse) und die Portnummer, an die die Medien gesendet oder empfangen werden sollen.
4. **Attribute**: SDP unterst√ºtzt die Verwendung von Attributen, um zus√§tzliche, optionale Informationen √ºber eine Sitzung oder einen Medienstrom bereitzustellen. Attribute k√∂nnen verwendet werden, um verschiedene Funktionen wie Verschl√ºsselungsschl√ºssel, Bandbreitenanforderungen oder Mediensteuerungsmechanismen anzugeben.

SDP wird typischerweise im folgenden Prozess verwendet:

1. Eine initiierende Partei erstellt eine SDP-Beschreibung der vorgeschlagenen Multimedia-Sitzung, einschlie√ülich der Einzelheiten der Medienstr√∂me und deren Attribute.
2. Die SDP-Beschreibung wird an die empfangende Partei gesendet, normalerweise eingebettet in eine Signalisierungsprotokollnachricht wie SIP oder RTSP.
3. Die empfangende Partei verarbeitet die SDP-Beschreibung und kann basierend auf ihren F√§higkeiten die vorgeschlagene Sitzung akzeptieren, ablehnen oder √§ndern.
4. Die endg√ºltige SDP-Beschreibung wird als Teil der Signalisierungsprotokollnachricht an die initiierende Partei zur√ºckgesendet, um den Verhandlungsprozess abzuschlie√üen.

Die Einfachheit und Flexibilit√§t von SDP machen es zu einem weit verbreiteten Standard zur Beschreibung von Multimedia-Sitzungen in verschiedenen Kommunikationssystemen und spielen eine entscheidende Rolle bei der Einrichtung und Verwaltung von Echtzeit-Multimedia-Sitzungen √ºber IP-Netzwerke.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP ist ein Netzwerkprotokoll, das f√ºr die Bereitstellung von Audio- und Videodaten oder anderen Echtzeitmedien √ºber IP-Netzwerke entwickelt wurde. Entwickelt von der **IETF** und definiert in **RFC 3550**, wird RTP h√§ufig mit Signalisierungsprotokollen wie SIP und H.323 verwendet, um Multimedia-Kommunikation zu erm√∂glichen. RTP bietet Mechanismen f√ºr **Synchronisation**, **Sequenzierung** und **Zeitstempelung** von Medienstr√∂men, um eine reibungslose und zeitgerechte Medienwiedergabe zu gew√§hrleisten.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP ist ein Begleitprotokoll zu RTP, das zur √úberwachung der Dienstg√ºte (QoS) verwendet wird und Feedback zur √úbertragung von Medienstr√∂men bereitstellt. Definiert im selben **RFC 3550** wie RTP, **tauscht RTCP regelm√§√üig Steuerpakete zwischen den Teilnehmern einer RTP-Sitzung aus**. Es teilt Informationen wie Paketverlust, Jitter und Round-Trip-Zeit mit, was bei der Diagnose und Anpassung an Netzwerkbedingungen hilft und die Gesamtqualit√§t der Medien verbessert.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP ist eine Erweiterung von RTP, die **Verschl√ºsselung**, **Nachrichtenauthentifizierung** und **Wiedergabeschutz** f√ºr Medienstr√∂me bereitstellt und eine sichere √úbertragung sensibler Audio- und Videodaten gew√§hrleistet. Definiert in **RFC 3711**, verwendet SRTP kryptografische Algorithmen wie AES zur Verschl√ºsselung und HMAC-SHA1 zur Nachrichtenauthentifizierung. SRTP wird h√§ufig in Kombination mit sicheren Signalisierungsprotokollen wie SIP √ºber TLS verwendet, um End-to-End-Sicherheit in der Multimedia-Kommunikation zu gew√§hrleisten.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP ist ein kryptografisches Schl√ºsselvereinbarungsprotokoll, das **End-to-End-Verschl√ºsselung** f√ºr RTP-Medienstr√∂me bereitstellt. Entwickelt von Phil Zimmermann, dem Sch√∂pfer von PGP, wird ZRTP in **RFC 6189** beschrieben. Im Gegensatz zu SRTP, das auf Signalisierungsprotokollen f√ºr den Schl√ºsselaustausch angewiesen ist, wurde ZRTP entwickelt, um unabh√§ngig vom Signalisierungsprotokoll zu arbeiten. Es verwendet **Diffie-Hellman-Schl√ºsselaustausch**, um ein gemeinsames Geheimnis zwischen den kommunizierenden Parteien zu etablieren, ohne vorheriges Vertrauen oder eine Public-Key-Infrastruktur (PKI) zu erfordern. ZRTP umfasst auch Funktionen wie **Short Authentication Strings (SAS)**, um sich gegen Man-in-the-Middle-Angriffe zu sch√ºtzen.

Diese Protokolle spielen eine wesentliche Rolle bei der **Bereitstellung und Sicherung der Echtzeit-Multimedia-Kommunikation √ºber IP-Netzwerke**. W√§hrend RTP und RTCP die tats√§chliche Medien√ºbertragung und Qualit√§ts√ºberwachung behandeln, stellen SRTP und ZRTP sicher, dass die √ºbertragenen Medien vor Abh√∂ren, Manipulation und Wiederholungsangriffen gesch√ºtzt sind.

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
</details>
{% endhint %}
