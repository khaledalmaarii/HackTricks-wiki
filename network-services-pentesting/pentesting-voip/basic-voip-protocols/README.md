# Osnovni VoIP protokoli

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
{% endhint %}

## Protokoli signalizacije

### SIP (Session Initiation Protocol)

Ovo je industrijski standard, za viÅ¡e informacija pogledajte:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) je **protokol za signalizaciju** i **kontrolu poziva** opisan u RFC 3435. Deluje u centralizovanoj arhitekturi, koja se sastoji od tri glavne komponente:

1. **Agent za pozive ili Kontroler medijskog prolaza (MGC)**: Glavni prolaz u MGCP arhitekturi je odgovoran za **upravljanje i kontrolu medijskih prolaza**. Rukuje procesima uspostavljanja, modifikacije i prekida poziva. MGC komunicira sa medijskim prolazima koristeÄ‡i MGCP protokol.
2. **Medijski prolazi (MG) ili Robusni prolazi**: Ovi ureÄ‘aji **konvertuju digitalne medijske tokove izmeÄ‘u razliÄitih mreÅ¾a**, kao Å¡to su tradicionalna telefonija sa preklapanjem i IP mreÅ¾e sa paketima. Njima upravlja MGC i izvrÅ¡avaju komande koje od njega dobijaju. Medijski prolazi mogu ukljuÄivati funkcije kao Å¡to su transkodiranje, paketizacija i poniÅ¡tavanje eha.
3. **Prolazi za signalizaciju (SG)**: Ovi prolazi su odgovorni za **konvertovanje signalizacijskih poruka izmeÄ‘u razliÄitih mreÅ¾a**, omoguÄ‡avajuÄ‡i nesmetanu komunikaciju izmeÄ‘u tradicionalnih telefonskih sistema (npr. SS7) i IP-baziranih mreÅ¾a (npr. SIP ili H.323). Prolazi za signalizaciju su kljuÄni za interoperabilnost i osiguranje da se informacije o kontroli poziva pravilno komuniciraju izmeÄ‘u razliÄitih mreÅ¾a.

Ukratko, MGCP centralizuje logiku kontrole poziva u agentu za pozive, Å¡to pojednostavljuje upravljanje medijskim i signalizacijskim prolazima, pruÅ¾ajuÄ‡i bolju skalabilnost, pouzdanost i efikasnost u telekomunikacionim mreÅ¾ama.

### SCCP (Skinny Client Control Protocol)

Skinny Client Control Protocol (SCCP) je **proprietarni protokol za signalizaciju i kontrolu poziva** u vlasniÅ¡tvu Cisco Systems. Primarno se **koristi** za komunikaciju izmeÄ‘u **Cisco Unified Communications Manager** (ranije poznatog kao CallManager) i Cisco IP telefona ili drugih Cisco glasovnih i video ureÄ‘aja.

SCCP je lagan protokol koji pojednostavljuje komunikaciju izmeÄ‘u servera za kontrolu poziva i ureÄ‘aja na kraju. Naziva se "Skinny" zbog svog minimalistiÄkog dizajna i smanjenih zahteva za propusnost u poreÄ‘enju sa drugim VoIP protokolima kao Å¡to su H.323 ili SIP.

Glavne komponente sistema zasnovanog na SCCP-u su:

1. **Server za kontrolu poziva**: Ovaj server, obiÄno Cisco Unified Communications Manager, upravlja procesima uspostavljanja, modifikacije i prekida poziva, kao i drugim telefonskim funkcijama kao Å¡to su preusmeravanje poziva, prebacivanje poziva i zadrÅ¾avanje poziva.
2. **SCCP krajnje taÄke**: Ovi ureÄ‘aji, kao Å¡to su IP telefoni, jedinice za video konferencije ili drugi Cisco glasovni i video ureÄ‘aji, koriste SCCP za komunikaciju sa serverom za kontrolu poziva. Registruju se kod servera, Å¡alju i primaju signalizacijske poruke i prate uputstva koja im daje server za kontrolu poziva za upravljanje pozivima.
3. **Prolazi**: Ovi ureÄ‘aji, kao Å¡to su glasovni prolazi ili medijski prolazi, odgovorni su za konvertovanje medijskih tokova izmeÄ‘u razliÄitih mreÅ¾a, kao Å¡to su tradicionalna telefonija sa preklapanjem i IP mreÅ¾e sa paketima. Mogu takoÄ‘e ukljuÄivati dodatne funkcionalnosti, kao Å¡to su transkodiranje ili poniÅ¡tavanje eha.

SCCP nudi jednostavnu i efikasnu metodu komunikacije izmeÄ‘u Cisco servera za kontrolu poziva i ureÄ‘aja na kraju. MeÄ‘utim, vredi napomenuti da je **SCCP proprietarni protokol**, Å¡to moÅ¾e ograniÄiti interoperabilnost sa ne-Cisco sistemima. U takvim sluÄajevima, drugi standardni VoIP protokoli kao Å¡to je SIP mogu biti pogodniji.

### H.323

H.323 je **skup protokola** za multimedijalnu komunikaciju, ukljuÄujuÄ‡i glas, video i konferencije podataka preko mreÅ¾a sa paketima, kao Å¡to su IP-bazirane mreÅ¾e. Razvila ga je **MeÄ‘unarodna telekomunikaciona unija** (ITU-T) i pruÅ¾a sveobuhvatan okvir za upravljanje multimedijalnim komunikacionim sesijama.

Neki kljuÄni sastavni delovi H.323 skupa ukljuÄuju:

1. **Terminali**: Ovi su ureÄ‘aji na kraju, kao Å¡to su IP telefoni, sistemi za video konferencije ili softverske aplikacije, koji podrÅ¾avaju H.323 i mogu uÄestvovati u multimedijalnim komunikacionim sesijama.
2. **Prolazi**: Ovi ureÄ‘aji konvertuju medijske tokove izmeÄ‘u razliÄitih mreÅ¾a, kao Å¡to su tradicionalna telefonija sa preklapanjem i IP mreÅ¾e sa paketima, omoguÄ‡avajuÄ‡i interoperabilnost izmeÄ‘u H.323 i drugih komunikacionih sistema. Mogu takoÄ‘e ukljuÄivati dodatne funkcionalnosti, kao Å¡to su transkodiranje ili poniÅ¡tavanje eha.
3. **Gatekeepers**: Ovi su opcioni sastavni delovi koji pruÅ¾aju usluge kontrole i upravljanja pozivima u H.323 mreÅ¾i. IzvrÅ¡avaju funkcije kao Å¡to su prevoÄ‘enje adresa, upravljanje propusnoÅ¡Ä‡u i kontrola pristupa, pomaÅ¾uÄ‡i u upravljanju i optimizaciji mreÅ¾nih resursa.
4. **Multipoint Control Units (MCU)**: Ovi ureÄ‘aji olakÅ¡avaju multipoint konferencije upravljanjem i meÅ¡anjem medijskih tokova iz viÅ¡e krajnjih taÄaka. MCU omoguÄ‡avaju funkcije kao Å¡to su kontrola rasporeda videa, prebacivanje aktivnog glasa i kontinuirana prisutnost, omoguÄ‡avajuÄ‡i organizovanje velikih konferencija sa viÅ¡e uÄesnika.

H.323 podrÅ¾ava niz audio i video kodeka, kao i druge dodatne usluge kao Å¡to su preusmeravanje poziva, prebacivanje poziva, zadrÅ¾avanje poziva i Äekanje poziva. I pored Å¡iroke upotrebe u ranim danima VoIP-a, H.323 je postepeno zamenjen modernijim i fleksibilnijim protokolima kao Å¡to je **Session Initiation Protocol (SIP)**, koji nudi bolju interoperabilnost i lakÅ¡u implementaciju. Ipak, H.323 ostaje u upotrebi u mnogim nasleÄ‘enim sistemima i nastavlja da ga podrÅ¾avaju razliÄiti dobavljaÄi opreme.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) je **protokol za signalizaciju i kontrolu poziva** koji se primarno koristi za komunikaciju izmeÄ‘u Asterisk PBX (Privatna centralna stanica) servera i drugih VoIP ureÄ‘aja. Razvio ga je Mark Spencer, tvorac Asterisk open-source PBX softvera, kao alternativu drugim VoIP protokolima kao Å¡to su SIP i H.323.

IAX je poznat po svojoj **jednostavnosti, efikasnosti i lakoÄ‡i implementacije**. Neke kljuÄne karakteristike IAX-a ukljuÄuju:

1. **Jedan UDP port**: IAX koristi jedan UDP port (4569) za signalizaciju i medijski saobraÄ‡aj, Å¡to pojednostavljuje prolaz kroz vatrozid i NAT, olakÅ¡avajuÄ‡i implementaciju u razliÄitim mreÅ¾nim okruÅ¾enjima.
2. **Binarni protokol**: Za razliku od protokola zasnovanih na tekstu kao Å¡to je SIP, IAX je binarni protokol, Å¡to smanjuje njegovu potroÅ¡nju propusnosti i Äini ga efikasnijim za prenos signalizacijskih i medijskih podataka.
3. **Trunking**: IAX podrÅ¾ava trunking, Å¡to omoguÄ‡ava kombinovanje viÅ¡e poziva u jednu mreÅ¾nu vezu, smanjujuÄ‡i preoptereÄ‡enje i poboljÅ¡avajuÄ‡i koriÅ¡Ä‡enje propusnosti.
4. **Prirodna enkripcija**: IAX ima ugraÄ‘enu podrÅ¡ku za enkripciju, koristeÄ‡i metode kao Å¡to su RSA za razmenu kljuÄeva i AES za enkripciju medija, pruÅ¾ajuÄ‡i sigurnu komunikaciju izmeÄ‘u krajnjih taÄaka.
5. **Peer-to-Peer komunikacija**: IAX se moÅ¾e koristiti za direktnu komunikaciju izmeÄ‘u krajnjih taÄaka bez potrebe za centralnim serverom, omoguÄ‡avajuÄ‡i jednostavnije i efikasnije usmeravanje poziva.

I pored svojih prednosti, IAX ima neka ograniÄenja, kao Å¡to je primarni fokus na Asterisk ekosistem i manja rasprostranjenost u poreÄ‘enju sa etabliranim protokolima kao Å¡to je SIP. Kao rezultat, IAX moÅ¾da neÄ‡e biti najbolji izbor za interoperabilnost sa ne-Asterisk sistemima ili ureÄ‘ajima. MeÄ‘utim, za one koji rade unutar Asterisk okruÅ¾enja, IAX nudi robusno i efikasno reÅ¡enje za VoIP komunikaciju.

## Protokoli za prenos i transport

### SDP (Session Description Protocol)

SDP (Session Description Protocol) je **format zasnovan na tekstu** koji se koristi za opisivanje karakteristika multimedijalnih sesija, kao Å¡to su glas, video ili konferencije podataka, preko IP mreÅ¾a. Razvila ga je **Internet Engineering Task Force (IETF)** i definisan je u **RFC 4566**. SDP ne upravlja stvarnim prenosom medija ili uspostavljanjem sesije, veÄ‡ se koristi u kombinaciji sa drugim protokolima signalizacije, kao Å¡to je **SIP (Session Initiation Protocol)**, za pregovaranje i razmenu informacija o medijskim tokovima i njihovim atributima.

Neki kljuÄni elementi SDP-a ukljuÄuju:

1. **Informacije o sesiji**: SDP opisuje detalje multimedijalne sesije, ukljuÄujuÄ‡i naziv sesije, opis sesije, vreme poÄetka i vreme zavrÅ¡etka.
2. **Medijski tokovi**: SDP definiÅ¡e karakteristike medijskih tokova, kao Å¡to su tip medija (audio, video ili tekst), transportni protokol (npr. RTP ili SRTP) i format medija (npr. informacije o kodeku).
3. **Informacije o vezi**: SDP pruÅ¾a informacije o mreÅ¾noj adresi (IP adresa) i broju porta na koji bi mediji trebali biti poslati ili primljeni.
4. **Atributi**: SDP podrÅ¾ava koriÅ¡Ä‡enje atributa za pruÅ¾anje dodatnih, opcionih informacija o sesiji ili medijskom toku. Atributi se mogu koristiti za specificiranje razliÄitih funkcija kao Å¡to su kljuÄevi za enkripciju, zahtevi za propusnost ili mehanizmi kontrole medija.

SDP se obiÄno koristi u sledeÄ‡em procesu:

1. InicirajuÄ‡a strana kreira SDP opis predloÅ¾ene multimedijalne sesije, ukljuÄujuÄ‡i detalje o medijskim tokovima i njihovim atributima.
2. SDP opis se Å¡alje primajuÄ‡oj strani, obiÄno ugraÄ‘en u poruku protokola signalizacije kao Å¡to su SIP ili RTSP.
3. PrimajuÄ‡a strana obraÄ‘uje SDP opis, i na osnovu svojih moguÄ‡nosti, moÅ¾e prihvatiti, odbiti ili izmeniti predloÅ¾enu sesiju.
4. KonaÄni SDP opis se Å¡alje nazad inicirajuÄ‡oj strani kao deo poruke protokola signalizacije, zavrÅ¡avajuÄ‡i proces pregovaranja.

Jednostavnost i fleksibilnost SDP-a Äine ga Å¡iroko usvojenim standardom za opisivanje multimedijalnih sesija u raznim komunikacionim sistemima, igrajuÄ‡i kljuÄnu ulogu u uspostavljanju i upravljanju real-time multimedijalnim sesijama preko IP mreÅ¾a.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP je mreÅ¾ni protokol dizajniran za isporuku audio i video podataka, ili drugih medija u realnom vremenu, preko IP mreÅ¾a. Razvijen od strane **IETF** i definisan u **RFC 3550**, RTP se obiÄno koristi sa protokolima signalizacije kao Å¡to su SIP i H.323 za omoguÄ‡avanje multimedijalne komunikacije. RTP pruÅ¾a mehanizme za **synchronizaciju**, **sekvenciranje** i **vremensko oznaÄavanje** medijskih tokova, pomaÅ¾uÄ‡i da se osigura glatko i pravovremeno reprodukovanje medija.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP je prateÄ‡i protokol za RTP, koji se koristi za praÄ‡enje kvaliteta usluge (QoS) i pruÅ¾anje povratnih informacija o prenosu medijskih tokova. Definisan u istom **RFC 3550** kao RTP, RTCP **periodiÄno razmenjuje kontrolne pakete izmeÄ‘u uÄesnika u RTP sesiji**. Deljenje informacija kao Å¡to su gubitak paketa, jitter i vreme povratka pomaÅ¾e u dijagnostikovanju i prilagoÄ‘avanju mreÅ¾nim uslovima, poboljÅ¡avajuÄ‡i ukupni kvalitet medija.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP je proÅ¡irenje RTP-a koje pruÅ¾a **enkripciju**, **autentifikaciju poruka** i **zaÅ¡titu od ponovnog koriÅ¡Ä‡enja** za medijske tokove, osiguravajuÄ‡i sigurnu transmisiju osetljivih audio i video podataka. Definisan u **RFC 3711**, SRTP koristi kriptografske algoritme kao Å¡to su AES za enkripciju i HMAC-SHA1 za autentifikaciju poruka. SRTP se Äesto koristi u kombinaciji sa sigurnim protokolima signalizacije kao Å¡to je SIP preko TLS za pruÅ¾anje end-to-end sigurnosti u multimedijalnoj komunikaciji.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP je protokol za dogovor o kriptografskim kljuÄevima koji pruÅ¾a **end-to-end enkripciju** za RTP medijske tokove. Razvio ga je Phil Zimmermann, tvorac PGP-a, ZRTP je opisan u **RFC 6189**. Za razliku od SRTP-a, koji se oslanja na protokole signalizacije za razmenu kljuÄeva, ZRTP je dizajniran da funkcioniÅ¡e nezavisno od protokola signalizacije. Koristi **Diffie-Hellman razmenu kljuÄeva** za uspostavljanje zajedniÄke tajne izmeÄ‘u komunikacionih strana, bez potrebe za prethodnim poverenjem ili infrastrukturom javnog kljuÄa (PKI). ZRTP takoÄ‘e ukljuÄuje funkcije kao Å¡to su **Kratke autentifikacione niske (SAS)** za zaÅ¡titu od napada "Äoveka u sredini".

Ovi protokoli igraju kljuÄne uloge u **isporuci i obezbeÄ‘ivanju real-time multimedijalne komunikacije preko IP mreÅ¾a**. Dok RTP i RTCP upravljaju stvarnim prenosom medija i praÄ‡enjem kvaliteta, SRTP i ZRTP osiguravaju da je preneseni medij zaÅ¡tiÄ‡en od prisluÅ¡kivanja, manipulacije i napada ponovnog koriÅ¡Ä‡enja.

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
</details>
{% endhint %}
