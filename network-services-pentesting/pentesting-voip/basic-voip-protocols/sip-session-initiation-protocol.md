# SIP (Session Initiation Protocol)

<details>

<summary><strong>AWS hackleme konusunu sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini edinin**](https://peass.creator-spring.com)
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek destek olun.

</details>

## Temel Bilgiler

SIP (Session Initiation Protocol), ses, video ve anlÄ±k iletiÅŸim de dahil olmak Ã¼zere Ã§oklu ortam oturumlarÄ±nÄ± kurmak, deÄŸiÅŸtirmek ve sonlandÄ±rmak iÃ§in yaygÄ±n olarak kullanÄ±lan bir **iÅŸaret ve Ã§aÄŸrÄ± kontrol protokolÃ¼dÃ¼r**. **Internet MÃ¼hendisliÄŸi GÃ¶rev GÃ¼cÃ¼ (IETF)** tarafÄ±ndan geliÅŸtirilen SIP, **VoIP ve birleÅŸik iletiÅŸim** iÃ§in de facto standart haline gelmiÅŸtir ve **RFC 3261**'de tanÄ±mlanmÄ±ÅŸtÄ±r.

SIP'nin bazÄ± temel Ã¶zellikleri ÅŸunlardÄ±r:

1. **Metin TabanlÄ± Protokol**: SIP, insan tarafÄ±ndan okunabilir ve hata ayÄ±klamayÄ± kolaylaÅŸtÄ±ran bir metin tabanlÄ± protokoldÃ¼r. HTTP'ye benzer ÅŸekilde istek-cevap modeline dayanÄ±r ve Ã§aÄŸrÄ± oturumlarÄ±nÄ± kontrol etmek iÃ§in INVITE, ACK, BYE ve CANCEL gibi yÃ¶ntemler kullanÄ±r.
2. **Ã–lÃ§eklenebilirlik ve Esneklik**: SIP oldukÃ§a Ã¶lÃ§eklenebilir olup kÃ¼Ã§Ã¼k Ã¶lÃ§ekli daÄŸÄ±tÄ±mlardan bÃ¼yÃ¼k kurumsal ve taÅŸÄ±yÄ±cÄ± sÄ±nÄ±fÄ± ortamlara kadar kullanÄ±labilir. Yeni Ã¶zelliklerle kolayca geniÅŸletilebilir, bu da Ã§eÅŸitli kullanÄ±m durumlarÄ±na ve gereksinimlere uyum saÄŸlar.
3. **Uyum**: SIP'nin geniÅŸ Ã§apta benimsenmesi ve standartlaÅŸtÄ±rÄ±lmasÄ±, farklÄ± cihazlar, uygulamalar ve hizmet saÄŸlayÄ±cÄ±lar arasÄ±nda daha iyi uyumluluÄŸu saÄŸlar, farklÄ± platformlar arasÄ±nda sorunsuz iletiÅŸimi teÅŸvik eder.
4. **ModÃ¼ler TasarÄ±m**: SIP, medya iletimi iÃ§in **RTP (GerÃ§ek ZamanlÄ± TaÅŸÄ±ma ProtokolÃ¼)** ve Ã§oklu ortam oturumlarÄ±nÄ± tanÄ±mlamak iÃ§in **SDP (Oturum TanÄ±m ProtokolÃ¼)** gibi diÄŸer protokollerle Ã§alÄ±ÅŸÄ±r. Bu modÃ¼ler tasarÄ±m, farklÄ± medya tÃ¼rleri ve kodeklerle daha fazla esneklik ve uyumluluk saÄŸlar.
5. **Proxy ve YÃ¶nlendirme SunucularÄ±**: SIP, Ã§aÄŸrÄ± yÃ¶nlendirmeyi kolaylaÅŸtÄ±rmak ve Ã§aÄŸrÄ± yÃ¶nlendirme, Ã§aÄŸrÄ± aktarÄ±mÄ± ve sesli posta gibi geliÅŸmiÅŸ Ã¶zellikler saÄŸlamak iÃ§in proxy ve yÃ¶nlendirme sunucularÄ±nÄ± kullanabilir.
6. **VarlÄ±k ve AnlÄ±k Ä°letiÅŸim**: SIP sadece ses ve video iletiÅŸimle sÄ±nÄ±rlÄ± deÄŸildir. VarlÄ±k ve anlÄ±k iletiÅŸimi de destekler, geniÅŸ bir birleÅŸik iletiÅŸim uygulama yelpazesini mÃ¼mkÃ¼n kÄ±lar.

BirÃ§ok avantajÄ±na raÄŸmen, SIP'nin NAT geÃ§idi ve gÃ¼venlik duvarÄ± sorunlarÄ±yla uÄŸraÅŸÄ±rken yapÄ±landÄ±rÄ±lmasÄ± ve yÃ¶netilmesi karmaÅŸÄ±k olabilir. Bununla birlikte, esnekliÄŸi, Ã¶lÃ§eklenebilirliÄŸi ve endÃ¼stri genelinde geniÅŸ destek gÃ¶rmesi, VoIP ve Ã§oklu ortam iletiÅŸimi iÃ§in popÃ¼ler bir tercih haline getirir.

### SIP YÃ¶ntemleri

**RFC 3261**'de tanÄ±mlanan temel SIP yÃ¶ntemleri ÅŸunlardÄ±r:

1. **INVITE**: Yeni bir oturumu (Ã§aÄŸrÄ±yÄ±) baÅŸlatmak veya mevcut bir oturumu deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. INVITE yÃ¶ntemi, alÄ±cÄ±yÄ± Ã¶nerilen oturumun ayrÄ±ntÄ±larÄ± hakkÄ±nda bilgilendirmek iÃ§in oturum aÃ§Ä±klamasÄ±nÄ± (genellikle SDP kullanarak) taÅŸÄ±r.
2. **ACK**: INVITE isteÄŸine verilen nihai yanÄ±tÄ±n alÄ±ndÄ±ÄŸÄ±nÄ± **onaylamak** iÃ§in gÃ¶nderilir. ACK yÃ¶ntemi, INVITE iÅŸlemlerinin uÃ§tan uca doÄŸruluÄŸunu saÄŸlayarak gÃ¼venilirliÄŸi saÄŸlar.
3. **BYE**: KurulmuÅŸ bir oturumu (Ã§aÄŸrÄ±yÄ±) sonlandÄ±rmak iÃ§in kullanÄ±lÄ±r. BYE yÃ¶ntemi, iletiÅŸimi sonlandÄ±rmak isteyen taraflardan biri tarafÄ±ndan gÃ¶nderilir.
4. **CANCEL**: Oturum kurulmadan Ã¶nce **bekleyen bir INVITE** isteÄŸini iptal etmek iÃ§in gÃ¶nderilir. CANCEL yÃ¶ntemi, gÃ¶nderenin fikrini deÄŸiÅŸtirmesi veya alÄ±cÄ±dan yanÄ±t alamamasÄ± durumunda bir INVITE iÅŸlemini iptal etmesine olanak tanÄ±r.
5. **OPTIONS**: Bir SIP sunucusunun veya kullanÄ±cÄ± ajanÄ±nÄ±n **yeteneklerini sorgulamak** iÃ§in kullanÄ±lÄ±r. OPTIONS yÃ¶ntemi, oturum kurmadan gerÃ§ekleÅŸtirmeden desteklenen yÃ¶ntemler, medya tÃ¼rleri veya diÄŸer uzantÄ±lar hakkÄ±nda bilgi talep etmek iÃ§in gÃ¶nderilebilir.
6. **REGISTER**: Bir kullanÄ±cÄ± ajanÄ±nÄ±n **mevcut konumunu bir SIP kayÄ±t sunucusuna kaydetmek** iÃ§in kullanÄ±lÄ±r. REGISTER yÃ¶ntemi, bir kullanÄ±cÄ±nÄ±n SIP URI'si ile mevcut IP adresi arasÄ±nda gÃ¼ncel bir eÅŸleme saÄŸlamaya yardÄ±mcÄ± olur, Ã§aÄŸrÄ± yÃ¶nlendirme ve teslimatÄ±nÄ± mÃ¼mkÃ¼n kÄ±lar.

{% hint style="warning" %}
Birine Ã§aÄŸrÄ± yapmak iÃ§in **REGISTER**'Ä± **kullanmak zorunlu deÄŸildir**.\
Ancak, **INVITE** iÅŸlemini gerÃ§ekleÅŸtirmek iÃ§in arayanÄ±n Ã¶nce **kimlik doÄŸrulamasÄ±** yapmasÄ± gerekebilir veya **`401 Unauthorized`** yanÄ±tÄ± alabilir.
{% endhint %}

Bu temel yÃ¶ntemlerin yanÄ± sÄ±ra, diÄŸer RFC'lerde tanÄ±mlanan **birkaÃ§ SIP uzantÄ± yÃ¶ntemi** bulunmaktadÄ±r, bunlar arasÄ±nda:

1. **SUBSCRIBE**: RFC 6665'te tanÄ±mlanan SUBSCRIBE yÃ¶ntemi, belirli bir kaynaÄŸÄ±n durumu hakkÄ±nda **bildirimler istemek** iÃ§in kullanÄ±lÄ±r, Ã¶rneÄŸin bir kullanÄ±cÄ±nÄ±n varlÄ±ÄŸÄ± veya Ã§aÄŸrÄ± durumu.
2. **NOTIFY**: AynÄ± ÅŸekilde RFC 6665'te tanÄ±mlanan NOTIFY yÃ¶ntemi, bir sunucunun, izlenen bir kaynaÄŸÄ±n durumundaki deÄŸiÅŸiklikler hakkÄ±nda **abone olan bir kullanÄ±cÄ± ajanÄ±nÄ± bilgilendirmek** iÃ§in gÃ¶nderdiÄŸi bir yÃ¶ntemdir.
3. **REFER**: RFC 3515'te tanÄ±mlanan REFER yÃ¶ntemi, alÄ±cÄ±nÄ±n bir **transfer yapmasÄ±nÄ± veya Ã¼Ã§Ã¼ncÃ¼ bir tarafa yÃ¶nlendirmesini istemek** iÃ§in kullanÄ±lÄ±r. Bu genellikle **Ã§aÄŸrÄ± transferi** senaryolarÄ± iÃ§in kullanÄ±lÄ±r.
4. **MESSAGE**: RFC 3428'de tanÄ±mlanan MESSAGE yÃ¶ntemi, SIP kullanÄ±cÄ± ajanlarÄ± arasÄ±nda **anlÄ±k mesajlar gÃ¶ndermek** iÃ§in kullanÄ±lÄ±r, SIP Ã§erÃ§evesi iÃ§inde metin tabanlÄ± iletiÅŸimi mÃ¼mkÃ¼n kÄ±lar.
5. **UPDATE**: RFC 3311'de tanÄ±mlanan UPDATE yÃ¶ntemi, **mevcut diyalogun durumunu etkilemeden bir oturumu deÄŸiÅŸtirmeyi** saÄŸlar. Bu, devam eden bir Ã§aÄŸrÄ± sÄ±rasÄ±nda kodekler veya medya tÃ¼rleri gibi oturum parametrelerini gÃ¼ncellemek iÃ§in kullanÄ±ÅŸlÄ±dÄ±r.
6. **PUBLISH**: RFC 3903'te tanÄ±mlanan PUBLISH yÃ¶ntemi, bir kullanÄ±cÄ± ajanÄ±nÄ±n **bir sunucuya olay durumu bilgisi yayÄ±nlamasÄ±** iÃ§in kullanÄ±lÄ±r, bu bilgiyi ilgilenen diÄŸer taraflara sunar.

### SIP YanÄ±t KodlarÄ±

* **1xx (GeÃ§ici YanÄ±tlar)**: Bu yanÄ±tlar, isteÄŸin alÄ±ndÄ±ÄŸÄ±nÄ± ve sunucunun iÅŸlemeye devam ettiÄŸini gÃ¶sterir.
* 100 Trying: Ä°stek alÄ±ndÄ± ve sunucu Ã¼zerinde Ã§alÄ±ÅŸÄ±lÄ±yor.
* 180 Ringing: Aranan kiÅŸi uyarÄ±lÄ±yor ve Ã§aÄŸrÄ±yÄ± alacak.
* 183 Session Progress: Ã‡aÄŸrÄ±nÄ±n ilerlemesi hakkÄ±nda bilgi saÄŸlar.
* **2xx (BaÅŸarÄ±lÄ± YanÄ±tlar)**: Bu yanÄ±tlar, isteÄŸin baÅŸarÄ±lÄ± bir ÅŸekilde alÄ±ndÄ±ÄŸÄ±nÄ±, anlaÅŸÄ±ldÄ±ÄŸÄ±nÄ± ve kabul edildiÄŸini gÃ¶sterir.
* 200 OK: Ä°stek baÅŸarÄ±lÄ± oldu ve sunucu bunu yerine getirdi.
* 202 Accepted: Ä°stek iÅŸlenmek Ã¼zere kabul edildi, ancak henÃ¼z tamamlanmadÄ±.
* **3xx (YÃ¶nlendirme YanÄ±tlarÄ±)**: Bu yanÄ±tlar, isteÄŸi yerine getirmek iÃ§in genellikle baÅŸka bir kaynaÄŸa baÅŸvurarak ek iÅŸlem gerektiÄŸini gÃ¶sterir.
* 300 Multiple Choices: Birden fazla seÃ§enek mevcut ve kullanÄ±cÄ± veya istemci birini seÃ§melidir.
* 301 Moved Permanently: Ä°stenen kaynaÄŸa yeni kalÄ±cÄ± bir URI atandÄ±.
* 302 Moved Temporarily: Ä°stenen kaynak geÃ§ici olarak farklÄ± bir URI'de mevcut.
* 305 Use Proxy: Ä°stek belirtilen bir proxy'e gÃ¶nderilmelidir.
* **4xx (Ä°stemci HatasÄ± YanÄ±tlarÄ±)**: Bu yanÄ±tlar, isteÄŸin kÃ¶tÃ¼ sÃ¶zdizim iÃ§erdiÄŸini veya sunucu tarafÄ±ndan karÅŸÄ±lanamayacaÄŸÄ±nÄ± gÃ¶sterir.
* 400 Bad Request: Ä°stek hatalÄ± veya geÃ§ersizdi.
* 401 Unauthorized: Ä°stek kullanÄ±cÄ± kimlik doÄŸrulamasÄ±nÄ± gerektirir.
* 403 Forbidden: Sunucu isteÄŸi anladÄ± ancak yerine getirmeyi reddediyor.
* 404 Not Found: Ä°stenen kaynak sunucuda bulunamadÄ±.
* 408 Request Timeout: Sunucu, beklemeye hazÄ±r olduÄŸu sÃ¼re iÃ§inde tam bir istek almadÄ±.
* 486 Busy Here: Aranan kiÅŸi ÅŸu anda meÅŸgul ve Ã§aÄŸrÄ±yÄ± alamÄ±yor.
* **5xx (Sunucu HatasÄ± YanÄ±tlarÄ±)**: Bu yanÄ±tlar, sunucunun geÃ§erli bir isteÄŸi yerine getiremediÄŸini gÃ¶sterir.
* 500 Internal Server Error: Sunucu, isteÄŸi iÅŸlerken bir hata ile karÅŸÄ±laÅŸtÄ±.
* 501 Not Implemented: Sunucu, isteÄŸi yerine getirmek iÃ§in gereken iÅŸlevselliÄŸi desteklemiyor.
* 503 Service Unavailable: Sunucu, bakÄ±m veya aÅŸÄ±rÄ± yÃ¼k nedeniyle isteÄŸi iÅŸleyemiyor.
* **6xx (Genel BaÅŸarÄ±sÄ±zlÄ±k YanÄ±tlarÄ±)**: Bu yanÄ±tlar, isteÄŸin hiÃ§bir sunucu tarafÄ±ndan yerine getirilemeyeceÄŸini gÃ¶sterir.
* 600 Busy Everywhere: Ã‡aÄŸrÄ± iÃ§in tÃ¼m olasÄ± hedefler meÅŸgul.
* 603 Decline: Aranan kiÅŸi Ã§aÄŸrÄ±ya katÄ±lmak istemiyor.
* 604 Does Not Exist Anywhere: Ä°stenen kaynak aÄŸda hiÃ§bir yerde mevcut deÄŸil.
## Ã–rnekler

### SIP INVITE Ã–rneÄŸi
```
INVITE sip:jdoe@example.com SIP/2.0
Via: SIP/2.0/UDP pc33.example.com;branch=z9hG4bK776asdhds
Max-Forwards: 70
To: John Doe <sip:jdoe@example.com>
From: Jane Smith <sip:jsmith@example.org>;tag=1928301774
Call-ID: a84b4c76e66710
CSeq: 314159 INVITE
Contact: <sip:jsmith@pc33.example.com>
User-Agent: ExampleSIPClient/1.0
Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, NOTIFY, MESSAGE, SUBSCRIBE, INFO
Content-Type: application/sdp
Content-Length: 142

v=0
o=jsmith 2890844526 2890842807 IN IP4 pc33.example.com
s=-
c=IN IP4 pc33.example.com
t=0 0
m=audio 49170 RTP/AVP 0
a=rtpmap:0 PCMU/8000te
```
<details>

<summary>Her Bir Parametre AÃ§Ä±klamasÄ±</summary>

1. **Request-Line**: `INVITE sip:jdoe@example.com SIP/2.0` - Bu satÄ±r, yÃ¶ntemi (INVITE), istek URI'sini (sip:[jdoe@example.com](mailto:jdoe@example.com)) ve SIP sÃ¼rÃ¼mÃ¼nÃ¼ (SIP/2.0) belirtir.
2. **Via**: `Via: SIP/2.0/UDP pc33.example.com;branch=z9hG4bK776asdhds` - Via baÅŸlÄ±ÄŸÄ±, iletiÅŸim protokolÃ¼nÃ¼ (UDP) ve istemcinin adresini (pc33.example.com) belirtir. "branch" parametresi dÃ¶ngÃ¼ tespiti ve iÅŸlem eÅŸleÅŸtirmesi iÃ§in kullanÄ±lÄ±r.
3. **Max-Forwards**: `Max-Forwards: 70` - Bu baÅŸlÄ±k alanÄ±, isteÄŸin yÃ¶nlendiriciler tarafÄ±ndan sonsuz dÃ¶ngÃ¼leri Ã¶nlemek iÃ§in kaÃ§ kez iletilmesine izin verileceÄŸini sÄ±nÄ±rlar.
4. **To**: `To: John Doe <sip:jdoe@example.com>` - To baÅŸlÄ±ÄŸÄ±, aramanÄ±n alÄ±cÄ±sÄ±nÄ±, gÃ¶rÃ¼ntÃ¼ adlarÄ±nÄ± (John Doe) ve SIP URI'sini (sip:[jdoe@example.com](mailto:jdoe@example.com)) belirtir.
5. **From**: `From: Jane Smith <sip:jsmith@example.org>;tag=1928301774` - From baÅŸlÄ±ÄŸÄ±, aramanÄ±n gÃ¶ndericisini, gÃ¶rÃ¼ntÃ¼ adlarÄ±nÄ± (Jane Smith) ve SIP URI'sini (sip:[jsmith@example.org](mailto:jsmith@example.org)) belirtir. "tag" parametresi, gÃ¶ndericinin rolÃ¼nÃ¼ benzersiz ÅŸekilde tanÄ±mlamak iÃ§in kullanÄ±lÄ±r.
6. **Call-ID**: `Call-ID: a84b4c76e66710` - Call-ID baÅŸlÄ±ÄŸÄ±, iki kullanÄ±cÄ± arasÄ±ndaki bir Ã§aÄŸrÄ± oturumunu benzersiz ÅŸekilde tanÄ±mlar.
7. **CSeq**: `CSeq: 314159 INVITE` - CSeq baÅŸlÄ±ÄŸÄ± bir dizi numarasÄ± ve istekte kullanÄ±lan yÃ¶ntemi iÃ§erir. YanÄ±tlarÄ± isteklere eÅŸleÅŸtirmek ve sÄ±rasÄ±z mesajlarÄ± algÄ±lamak iÃ§in kullanÄ±lÄ±r.
8. **Contact**: `Contact: <sip:jsmith@pc33.example.com>` - Contact baÅŸlÄ±ÄŸÄ±, gÃ¶ndericiye doÄŸrudan bir yol saÄŸlar ve bu yol sonraki istekler ve yanÄ±tlar iÃ§in kullanÄ±labilir.
9. **User-Agent**: `User-Agent: ExampleSIPClient/1.0` - User-Agent baÅŸlÄ±ÄŸÄ±, gÃ¶ndericinin yazÄ±lÄ±mÄ± veya donanÄ±mÄ± hakkÄ±nda bilgi saÄŸlar, adÄ±nÄ± ve sÃ¼rÃ¼mÃ¼nÃ¼ iÃ§erir.
10. **Allow**: `Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, NOTIFY, MESSAGE, SUBSCRIBE, INFO` - Allow baÅŸlÄ±ÄŸÄ±, gÃ¶nderici tarafÄ±ndan desteklenen SIP yÃ¶ntemlerini listeler. Bu, alÄ±cÄ±nÄ±n iletiÅŸim sÄ±rasÄ±nda hangi yÃ¶ntemlerin kullanÄ±labileceÄŸini anlamasÄ±na yardÄ±mcÄ± olur.
11. **Content-Type**: `Content-Type: application/sdp` - Content-Type baÅŸlÄ±ÄŸÄ±, ileti gÃ¶vdesinin ortam tÃ¼rÃ¼nÃ¼ belirtir, bu durumda SDP (Session Description Protocol).
12. **Content-Length**: `Content-Length: 142` - Content-Length baÅŸlÄ±ÄŸÄ±, ileti gÃ¶vdesinin boyutunu byte cinsinden belirtir.
13. **Ä°leti GÃ¶vdesi**: Ä°leti gÃ¶vdesi, Ã¶nerilen oturum iÃ§in ortam tÃ¼rleri, kodekler ve taÅŸÄ±ma protokolleri hakkÄ±nda bilgiler iÃ§eren SDP oturum aÃ§Ä±klamasÄ±nÄ± iÃ§erir.

* `v=0` - Protokol sÃ¼rÃ¼mÃ¼ (SDP iÃ§in 0)
* `o=jsmith 2890844526 2890842807 IN IP4 pc33.example.com` - OluÅŸturan ve oturum kimliÄŸi
* `s=-` - Oturum adÄ± (tek bir tire oturum adÄ± olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir)
* `c=IN IP4 pc33.example.com` - BaÄŸlantÄ± bilgisi (aÄŸ tÃ¼rÃ¼, adres tÃ¼rÃ¼ ve adres)
* `t=0 0` - Zamanlama bilgisi (baÅŸlangÄ±Ã§ ve bitiÅŸ zamanlarÄ±, 0 0 oturumun sÄ±nÄ±rlÄ± olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir)
* `m=audio 49170 RTP/AVP 0` - Medya aÃ§Ä±klamasÄ± (medya tÃ¼rÃ¼, port numarasÄ±, taÅŸÄ±ma protokolÃ¼ ve format listesi). Bu durumda, RTP/AVP (GerÃ§ek ZamanlÄ± TaÅŸÄ±ma ProtokolÃ¼ / Ses Video Profili) kullanarak bir ses akÄ±ÅŸÄ±nÄ± ve format 0'Ä± (PCMU/8000) belirtir.
* `a=rtpmap:0 PCMU/8000` - FormatÄ± (0) kodeke (PCMU) ve saat hÄ±zÄ±na (8000 Hz) eÅŸleyen Ã¶zellik.

</details>

### SIP KAYIT Ã–rneÄŸi

REGISTER yÃ¶ntemi, bir KullanÄ±cÄ± AracÄ±sÄ±'nÄ±n (UA) konumunu bir SIP kayÄ±t sunucusuna kaydetmesine izin vermek iÃ§in Session Initiation Protocol (SIP) iÃ§inde kullanÄ±lÄ±r. Bu sÃ¼reÃ§, sunucunun, kayÄ±tlÄ± kullanÄ±cÄ± iÃ§in gelen SIP isteklerini nereye yÃ¶nlendireceÄŸini bilmesini saÄŸlar. KayÄ±t sunucusu genellikle bir SIP proxy sunucusunun bir parÃ§asÄ± veya ayrÄ±lmÄ±ÅŸ bir kayÄ±t sunucusudur.

Ä°ÅŸte bir KAYIT kimlik doÄŸrulama sÃ¼recinde yer alan SIP iletilerinin detaylÄ± bir Ã¶rneÄŸi:

1. UA'dan kayÄ±t sunucusuna ilk **KAYIT** isteÄŸi:
```yaml
REGISTER sip:example.com SIP/2.0
Via: SIP/2.0/UDP 192.168.1.100:5060;branch=z9hG4bK776asdhds
Max-Forwards: 70
From: Alice <sip:alice@example.com>;tag=565656
To: Alice <sip:alice@example.com>
Call-ID: 1234567890@192.168.1.100
CSeq: 1 REGISTER
Contact: <sip:alice@192.168.1.100:5060>;expires=3600
Expires: 3600
Content-Length: 0
```
Bu ilk KAYIT mesajÄ±, UA (Alice) tarafÄ±ndan kayÄ±t sunucusuna gÃ¶nderilir. Ä°stenen kayÄ±t sÃ¼resi (SÃ¼resi Dolan), kullanÄ±cÄ±nÄ±n SIP URI'sÄ± (sip:[alice@example.com](mailto:alice@example.com)) ve kullanÄ±cÄ±nÄ±n iletiÅŸim adresi (sip:alice@192.168.1.100:5060) gibi Ã¶nemli bilgileri iÃ§erir.

2. KayÄ±t sunucusundan gelen **401 Yetkisiz** yanÄ±tÄ±:
```css
cssCopy codeSIP/2.0 401 Unauthorized
Via: SIP/2.0/UDP 192.168.1.100:5060;branch=z9hG4bK776asdhds
From: Alice <sip:alice@example.com>;tag=565656
To: Alice <sip:alice@example.com>;tag=7878744
Call-ID: 1234567890@192.168.1.100
CSeq: 1 REGISTER
WWW-Authenticate: Digest realm="example.com", nonce="abcdefghijk", algorithm=MD5, qop="auth"
Content-Length: 0
```
Registrar sunucusu, "401 Yetkisiz" mesajÄ± ile yanÄ±t verir, bu mesaj bir "WWW-Authenticate" baÅŸlÄ±ÄŸÄ± iÃ§erir. Bu baÅŸlÄ±k, UA'nÄ±n kendini doÄŸrulamasÄ± iÃ§in gereken bilgileri iÃ§erir, Ã¶rneÄŸin **kimlik doÄŸrulama alanÄ±, nonce ve algoritma**.

3. Kimlik doÄŸrulama bilgileri ile KAYIT isteÄŸi:
```vbnet
REGISTER sip:example.com SIP/2.0
Via: SIP/2.0/UDP 192.168.1.100:5060;branch=z9hG4bK776asdhds
Max-Forwards: 70
From: Alice <sip:alice@example.com>;tag=565656
To: Alice <sip:alice@example.com>
Call-ID: 1234567890@192.168.1.100
CSeq: 2 REGISTER
Contact: <sip:alice@192.168.1.100:5060>;expires=3600
Expires: 3600
Authorization: Digest username="alice", realm="example.com", nonce="abcdefghijk", uri="sip:example.com", response="65a8e2285879283831b664bd8b7f14d4", algorithm=MD5, cnonce="lmnopqrst", qop=auth, nc=00000001
Content-Length: 0
```
UA, bu sefer gerekli kimlik bilgileriyle birlikte "Authorization" baÅŸlÄ±ÄŸÄ±nÄ± iÃ§eren bir BAÅVURU isteÄŸi gÃ¶nderir, Ã¶rneÄŸin kullanÄ±cÄ± adÄ±, alan, nonce ve saÄŸlanan bilgiler ve kullanÄ±cÄ±nÄ±n ÅŸifresi kullanÄ±larak hesaplanan bir yanÄ±t deÄŸeri.

**Yetkilendirme yanÄ±tÄ±** ÅŸu ÅŸekilde hesaplanÄ±r:
```python
import hashlib

def calculate_sip_md5_response(username, password, realm, method, uri, nonce, nc, cnonce, qop):
# 1. Calculate HA1 (concatenation of username, realm, and password)
ha1_input = f"{username}:{realm}:{password}"
ha1 = hashlib.md5(ha1_input.encode()).hexdigest()

# 2. Calculate HA2 (concatenation of method and uri)
ha2_input = f"{method}:{uri}"
ha2 = hashlib.md5(ha2_input.encode()).hexdigest()

# 3. Calculate the final response value (concatenation of h1, stuff and h2)
response_input = f"{ha1}:{nonce}:{nc}:{cnonce}:{qop}:{ha2}"
response = hashlib.md5(response_input.encode()).hexdigest()

return response

# Example usage
username = "alice"
password = "mysecretpassword"
realm = "example.com"
method = "REGISTER"
uri = "sip:example.com"
nonce = "abcdefghijk"
nc = "00000001"
cnonce = "lmnopqrst"
qop = "auth"

response = calculate_sip_md5_response(username, password, realm, method, uri, nonce, nc, cnonce, qop)
print(f"MD5 response value: {response}")
```
4. **KayÄ±t baÅŸarÄ±lÄ±** yanÄ±tÄ± kayÄ±t sunucusundan:
```yaml
SIP/2.0 200 OK
Via: SIP/2.0/UDP 192.168.1.100:5060;branch=z9hG4bK776asdhds
From: Alice <sip:alice@example.com>;tag=565656
To: Alice <sip:alice@example.com>;tag=7878744
Call-ID: 1234567890@192.168.1.100
CSeq: 2 REGISTER
Contact: <sip:alice@192.168.1.100:5060>;expires=3600
Expires: 3600
Content-Length: 0
```
Registrar sunucusu saÄŸlanan kimlik bilgilerini doÄŸruladÄ±ktan sonra, **kaydÄ±n baÅŸarÄ±lÄ± olduÄŸunu belirtmek iÃ§in "200 OK" yanÄ±tÄ± gÃ¶nderir**. YanÄ±t, kayÄ±tlÄ± iletiÅŸim bilgilerini ve kaydÄ±n sona erme zamanÄ±nÄ± iÃ§erir. Bu noktada, kullanÄ±cÄ± ajanÄ± (Alice) SIP registrar sunucusuna baÅŸarÄ±lÄ± bir ÅŸekilde kaydedilmiÅŸtir ve Alice iÃ§in gelen SIP istekleri uygun iletiÅŸim adresine yÃ¶nlendirilebilir.

### Ã‡aÄŸrÄ± Ã–rneÄŸi

<figure><img src="../../../.gitbook/assets/image (1101).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
BelirtilmemiÅŸ olsa da, KullanÄ±cÄ± B'nin aramalarÄ± alabilmesi iÃ§in **PROXY 2'ye bir KAYIT mesajÄ± gÃ¶ndermesi gerekmektedir**.
{% endhint %}
