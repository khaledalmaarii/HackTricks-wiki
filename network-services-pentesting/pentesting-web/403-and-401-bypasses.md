# 403 & 401 Bypasses

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Sofort verf√ºgbarer Setup f√ºr Schwachstellenbewertung & Penetrationstests**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall mit √ºber 20 Tools und Funktionen durch, die von Recon bis Reporting reichen. Wir ersetzen keine Pentester - wir entwickeln ma√ügeschneiderte Tools, Erkennungs- und Ausnutzungs-Module, um ihnen etwas Zeit zur√ºckzugeben, um tiefer zu graben, Shells zu √∂ffnen und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/" %}

## HTTP Verbs/Methods Fuzzing

Versuchen Sie, **verschiedene Verben** zu verwenden, um auf die Datei zuzugreifen: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* √úberpr√ºfen Sie die Antwort-Header, vielleicht k√∂nnen einige Informationen gegeben werden. Zum Beispiel bedeutet eine **200-Antwort** auf **HEAD** mit `Content-Length: 55`, dass das **HEAD-Verb auf die Info zugreifen kann**. Aber Sie m√ºssen immer noch einen Weg finden, diese Info zu exfiltrieren.
* Verwenden Sie einen HTTP-Header wie `X-HTTP-Method-Override: PUT`, um das verwendete Verb zu √ºberschreiben.
* Verwenden Sie das **`TRACE`**-Verb und wenn Sie sehr viel Gl√ºck haben, k√∂nnen Sie vielleicht in der Antwort auch die **von Zwischenproxies hinzugef√ºgten Header** sehen, die n√ºtzlich sein k√∂nnten.

## HTTP Headers Fuzzing

* **√Ñndern Sie den Host-Header** auf einen beliebigen Wert ([das hat hier funktioniert](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* Versuchen Sie, [**andere User Agents zu verwenden**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt), um auf die Ressource zuzugreifen.
* **Fuzz HTTP-Header**: Versuchen Sie, HTTP-Proxy **Header**, HTTP-Authentifizierung Basic und NTLM-Brute-Force (nur mit wenigen Kombinationen) und andere Techniken zu verwenden. Um all dies zu tun, habe ich das Tool [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass) erstellt.

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

Wenn der **Pfad gesch√ºtzt ist**, k√∂nnen Sie versuchen, den Pfadschutz mit diesen anderen Headern zu umgehen:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* Wenn die Seite **hinter einem Proxy** ist, k√∂nnte es der Proxy sein, der Sie daran hindert, auf die privaten Informationen zuzugreifen. Versuchen Sie, [**HTTP Request Smuggling**](../../pentesting-web/http-request-smuggling/) **oder** [**Hop-by-Hop-Header**](../../pentesting-web/abusing-hop-by-hop-headers.md)** auszunutzen.**
* Fuzz [**spezielle HTTP-Header**](special-http-headers.md) auf der Suche nach unterschiedlichen Antworten.
* **Fuzz spezielle HTTP-Header**, w√§hrend Sie **HTTP-Methoden** fuzzing.
* **Entfernen Sie den Host-Header**, und vielleicht k√∂nnen Sie den Schutz umgehen.

## Path **Fuzzing**

Wenn _/path_ blockiert ist:

* Versuchen Sie, _**/**_**%2e/path \_ (wenn der Zugriff durch einen Proxy blockiert wird, k√∂nnte dies den Schutz umgehen). Versuchen Sie auch**\_\*\* /%252e\*\*/path (doppelte URL-Codierung)
* Versuchen Sie **Unicode-Bypass**: _/**%ef%bc%8f**path_ (Die URL-codierten Zeichen sind wie "/"), sodass es beim Zur√ºckcodieren _//path_ sein wird und Sie m√∂glicherweise bereits die _/path_-Namens√ºberpr√ºfung umgangen haben.
* **Andere Pfad-Byp√§sse**:
* site.com/secret ‚Äì> HTTP 403 Forbidden
* site.com/SECRET ‚Äì> HTTP 200 OK
* site.com/secret/ ‚Äì> HTTP 200 OK
* site.com/secret/. ‚Äì> HTTP 200 OK
* site.com//secret// ‚Äì> HTTP 200 OK
* site.com/./secret/.. ‚Äì> HTTP 200 OK
* site.com/;/secret ‚Äì> HTTP 200 OK
* site.com/.;/secret ‚Äì> HTTP 200 OK
* site.com//;//secret ‚Äì> HTTP 200 OK
* site.com/secret.json ‚Äì> HTTP 200 OK (ruby)
* Verwenden Sie [**diese Liste**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) in den folgenden Situationen:
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **Andere API-Byp√§sse:**
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Unauthorisiert
* {‚Äúid‚Äù:\[111]} --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Unauthorisiert
* {‚Äúid‚Äù:{‚Äúid‚Äù:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSON Parameter Pollution)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (Parameter Pollution)

## **Parameter Manipulation**

* √Ñndern Sie **param value**: Von **`id=123` --> `id=124`**
* F√ºgen Sie zus√§tzliche Parameter zur URL hinzu: `?`**`id=124` ‚Äî-> `id=124&isAdmin=true`**
* Entfernen Sie die Parameter
* √Ñndern Sie die Reihenfolge der Parameter
* Verwenden Sie Sonderzeichen.
* F√ºhren Sie Grenzwerttests in den Parametern durch ‚Äî geben Sie Werte wie _-234_ oder _0_ oder _99999999_ (nur einige Beispielwerte) an.

## **Protokollversion**

Wenn Sie HTTP/1.1 verwenden, **versuchen Sie, 1.0 zu verwenden** oder testen Sie, ob es **2.0 unterst√ºtzt**.

## **Andere Byp√§sse**

* Holen Sie sich die **IP** oder **CNAME** der Domain und versuchen Sie, **sie direkt zu kontaktieren**.
* Versuchen Sie, den **Server zu belasten**, indem Sie g√§ngige GET-Anfragen senden ([Es hat f√ºr diesen Typen mit Facebook funktioniert](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **√Ñndern Sie das Protokoll**: von http zu https oder von https zu http
* Gehen Sie zu [**https://archive.org/web/**](https://archive.org/web/) und √ºberpr√ºfen Sie, ob die Datei in der Vergangenheit **weltweit zug√§nglich** war.

## **Brute Force**

* **Raten Sie das Passwort**: Testen Sie die folgenden g√§ngigen Anmeldeinformationen. Wissen Sie etwas √ºber das Opfer? Oder den Namen der CTF-Herausforderung?
* [**Brute Force**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** Versuchen Sie grundlegende, Digest- und NTLM-Authentifizierung.

{% code title="Common creds" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## Automatische Werkzeuge

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp-Erweiterung - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
* [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Sofort verf√ºgbares Setup f√ºr Schwachstellenbewertung & Penetrationstests**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall mit √ºber 20 Werkzeugen und Funktionen durch, die von Recon bis Reporting reichen. Wir ersetzen keine Pentester - wir entwickeln ma√ügeschneiderte Werkzeuge, Erkennungs- und Ausnutzungs-Module, um ihnen etwas Zeit zur√ºckzugeben, um tiefer zu graben, Shells zu knacken und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/" %}

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
