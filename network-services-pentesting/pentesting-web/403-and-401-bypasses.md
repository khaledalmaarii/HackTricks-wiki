# 403 & 401 Bypasses

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì„¸ìš”.**

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**ì·¨ì•½ì  í‰ê°€ ë° ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì •**. 20ê°œ ì´ìƒì˜ ë„êµ¬ ë° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë””ì„œë‚˜ ì „ì²´ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. ìš°ë¦¬ëŠ” ì¹¨íˆ¬ í…ŒìŠ¤í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ - ê·¸ë“¤ì´ ë” ê¹Šì´ íŒŒê³ ë“¤ê³ , ì…¸ì„ í„°ëœ¨ë¦¬ê³ , ì¬ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ë§ì¶¤í˜• ë„êµ¬, íƒì§€ ë° ì•…ìš© ëª¨ë“ˆì„ ê°œë°œí•©ë‹ˆë‹¤.

{% embed url="https://pentest-tools.com/" %}

## HTTP ë™ì‚¬/ë©”ì„œë“œ í¼ì§•

íŒŒì¼ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ **ë‹¤ì–‘í•œ ë™ì‚¬**ë¥¼ ì‚¬ìš©í•´ ë³´ì„¸ìš”: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* ì‘ë‹µ í—¤ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”. ì•„ë§ˆë„ ì¼ë¶€ ì •ë³´ê°€ ì œê³µë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, **HEADì— ëŒ€í•œ 200 ì‘ë‹µ**ê³¼ `Content-Length: 55`ëŠ” **HEAD ë™ì‚¬ê°€ ì •ë³´ë¥¼ ì ‘ê·¼í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸**í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ì „íˆ ê·¸ ì •ë³´ë¥¼ ìœ ì¶œí•  ë°©ë²•ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.
* `X-HTTP-Method-Override: PUT`ê³¼ ê°™ì€ HTTP í—¤ë”ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ëœ ë™ì‚¬ë¥¼ ë®ì–´ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`TRACE`** ë™ì‚¬ë¥¼ ì‚¬ìš©í•˜ê³ , ìš´ì´ ì¢‹ë‹¤ë©´ ì‘ë‹µì—ì„œ ìœ ìš©í•  ìˆ˜ ìˆëŠ” **ì¤‘ê°„ í”„ë¡ì‹œê°€ ì¶”ê°€í•œ í—¤ë”**ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## HTTP í—¤ë” í¼ì§•

* **Host í—¤ë”**ë¥¼ ì„ì˜ì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš” ([ì—¬ê¸°ì„œ ì‘ë™í•œ ê²ƒ](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ [**ë‹¤ë¥¸ ì‚¬ìš©ì ì—ì´ì „íŠ¸**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt)ë¥¼ ì‚¬ìš©í•´ ë³´ì„¸ìš”.
* **HTTP í—¤ë” í¼ì§•**: HTTP í”„ë¡ì‹œ **í—¤ë”**, HTTP ì¸ì¦ ê¸°ë³¸ ë° NTLM ë¬´ì°¨ë³„ ëŒ€ì…(ëª‡ ê°€ì§€ ì¡°í•©ë§Œ ì‚¬ìš©) ë° ê¸°íƒ€ ê¸°ìˆ ì„ ì‚¬ìš©í•´ ë³´ì„¸ìš”. ì´ë¥¼ ìœ„í•´ [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass) ë„êµ¬ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

**ê²½ë¡œê°€ ë³´í˜¸ë˜ì–´ ìˆëŠ” ê²½ìš°** ì´ëŸ¬í•œ ë‹¤ë¥¸ í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²½ë¡œ ë³´í˜¸ë¥¼ ìš°íšŒí•´ ë³´ì„¸ìš”:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* í˜ì´ì§€ê°€ **í”„ë¡ì‹œ ë’¤ì— ìˆëŠ” ê²½ìš°**, ì•„ë§ˆë„ í”„ë¡ì‹œê°€ ê°œì¸ ì •ë³´ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. [**HTTP ìš”ì²­ ìŠ¤ë¨¸ê¸€ë§**](../../pentesting-web/http-request-smuggling/) **ë˜ëŠ”** [**hop-by-hop í—¤ë”**](../../pentesting-web/abusing-hop-by-hop-headers.md)**ë¥¼ ì•…ìš©í•´ ë³´ì„¸ìš”.**
* [**íŠ¹ìˆ˜ HTTP í—¤ë”**](special-http-headers.md)ë¥¼ í¼ì§•í•˜ì—¬ ë‹¤ì–‘í•œ ì‘ë‹µì„ ì°¾ì•„ë³´ì„¸ìš”.
* **HTTP ë©”ì„œë“œë¥¼ í¼ì§•í•˜ëŠ” ë™ì•ˆ íŠ¹ìˆ˜ HTTP í—¤ë”ë¥¼ í¼ì§•í•˜ì„¸ìš”.**
* **Host í—¤ë”ë¥¼ ì œê±°í•˜ë©´ ë³´í˜¸ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.**

## ê²½ë¡œ **í¼ì§•**

_if_ /pathê°€ ì°¨ë‹¨ëœ ê²½ìš°:

* _**/**_**%2e/pathë¥¼ ì‚¬ìš©í•´ ë³´ì„¸ìš” _(ì ‘ê·¼ì´ í”„ë¡ì‹œë¡œ ì°¨ë‹¨ëœ ê²½ìš°, ì´ ë°©ë²•ìœ¼ë¡œ ë³´í˜¸ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤). ë˜í•œ**\_\*\* /%252e\*\*/path (ì´ì¤‘ URL ì¸ì½”ë”©)ë¥¼ ì‹œë„í•´ ë³´ì„¸ìš”.
* **ìœ ë‹ˆì½”ë“œ ìš°íšŒ**ë¥¼ ì‹œë„í•˜ì„¸ìš”: _/**%ef%bc%8f**path_ (URL ì¸ì½”ë”©ëœ ë¬¸ìëŠ” "/"ì™€ ê°™ìœ¼ë¯€ë¡œ ë‹¤ì‹œ ì¸ì½”ë”©í•˜ë©´ _//path_ê°€ ë˜ì–´ _/path_ ì´ë¦„ ê²€ì‚¬ë¥¼ ì´ë¯¸ ìš°íšŒí–ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)
* **ê¸°íƒ€ ê²½ë¡œ ìš°íšŒ**:
* site.com/secret â€“> HTTP 403 Forbidden
* site.com/SECRET â€“> HTTP 200 OK
* site.com/secret/ â€“> HTTP 200 OK
* site.com/secret/. â€“> HTTP 200 OK
* site.com//secret// â€“> HTTP 200 OK
* site.com/./secret/.. â€“> HTTP 200 OK
* site.com/;/secret â€“> HTTP 200 OK
* site.com/.;/secret â€“> HTTP 200 OK
* site.com//;//secret â€“> HTTP 200 OK
* site.com/secret.json â€“> HTTP 200 OK (ë£¨ë¹„)
* ë‹¤ìŒ ìƒí™©ì—ì„œ [**ì´ ëª©ë¡**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt)ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **ê¸°íƒ€ API ìš°íšŒ:**
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {â€œidâ€:111} --> 401 Unauthorized
* {â€œidâ€:\[111]} --> 200 OK
* {â€œidâ€:111} --> 401 Unauthorized
* {â€œidâ€:{â€œidâ€:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSON ë§¤ê°œë³€ìˆ˜ ì˜¤ì—¼)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (ë§¤ê°œë³€ìˆ˜ ì˜¤ì—¼)

## **ë§¤ê°œë³€ìˆ˜ ì¡°ì‘**

* **ë§¤ê°œë³€ìˆ˜ ê°’ ë³€ê²½**: **`id=123` --> `id=124`**
* URLì— ì¶”ê°€ ë§¤ê°œë³€ìˆ˜ ì¶”ê°€: `?`**`id=124` â€”-> `id=124&isAdmin=true`**
* ë§¤ê°œë³€ìˆ˜ ì œê±°
* ë§¤ê°œë³€ìˆ˜ ìˆœì„œ ë³€ê²½
* íŠ¹ìˆ˜ ë¬¸ì ì‚¬ìš©.
* ë§¤ê°œë³€ìˆ˜ì—ì„œ ê²½ê³„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ â€” _-234_ ë˜ëŠ” _0_ ë˜ëŠ” _99999999_ì™€ ê°™ì€ ê°’ì„ ì œê³µí•˜ì„¸ìš” (ëª‡ ê°€ì§€ ì˜ˆì‹œ ê°’).

## **í”„ë¡œí† ì½œ ë²„ì „**

HTTP/1.1ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° **1.0ì„ ì‚¬ìš©í•´ ë³´ì„¸ìš”** ë˜ëŠ” **2.0ì„ ì§€ì›í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ ë³´ì„¸ìš”**.

## **ê¸°íƒ€ ìš°íšŒ**

* ë„ë©”ì¸ì˜ **IP** ë˜ëŠ” **CNAME**ë¥¼ ê°€ì ¸ì™€ì„œ **ì§ì ‘ ì—°ë½í•´ ë³´ì„¸ìš”**.
* ì¼ë°˜ GET ìš”ì²­ì„ ë³´ë‚´ ì„œë²„ë¥¼ **ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸**í•´ ë³´ì„¸ìš” ([ì´ ì‚¬ëŒì€ Facebookì—ì„œ ì‘ë™í–ˆìŠµë‹ˆë‹¤](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **í”„ë¡œí† ì½œ ë³€ê²½**: httpì—ì„œ httpsë¡œ, ë˜ëŠ” httpsì—ì„œ httpë¡œ ë³€ê²½í•˜ì„¸ìš”.
* [**https://archive.org/web/**](https://archive.org/web/)ì— ê°€ì„œ ê³¼ê±°ì— í•´ë‹¹ íŒŒì¼ì´ **ì „ ì„¸ê³„ì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í–ˆëŠ”ì§€** í™•ì¸í•˜ì„¸ìš”.

## **ë¬´ì°¨ë³„ ëŒ€ì…**

* **ë¹„ë°€ë²ˆí˜¸ ì¶”ì¸¡**: ë‹¤ìŒ ì¼ë°˜ ìê²© ì¦ëª…ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”. í”¼í•´ìì— ëŒ€í•´ ì•„ëŠ” ê²ƒì´ ìˆë‚˜ìš”? ë˜ëŠ” CTF ì±Œë¦°ì§€ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”?
* [**ë¬´ì°¨ë³„ ëŒ€ì…**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** ê¸°ë³¸, ë‹¤ì´ì œìŠ¤íŠ¸ ë° NTLM ì¸ì¦ì„ ì‹œë„í•´ ë³´ì„¸ìš”.

{% code title="ì¼ë°˜ ìê²© ì¦ëª…" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## ìë™ ë„êµ¬

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp Extension - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
* [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**ì·¨ì•½ì  í‰ê°€ ë° ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ì •**. 20ê°œ ì´ìƒì˜ ë„êµ¬ ë° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì–´ë””ì„œë‚˜ ì „ì²´ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. ìš°ë¦¬ëŠ” ì¹¨íˆ¬ í…ŒìŠ¤í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ - ê·¸ë“¤ì´ ë” ê¹Šì´ íŒŒê³ ë“¤ê³ , ì‰˜ì„ í„°ëœ¨ë¦¬ê³ , ì¬ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆë„ë¡ ë§ì¶¤í˜• ë„êµ¬, íƒì§€ ë° ì•…ìš© ëª¨ë“ˆì„ ê°œë°œí•©ë‹ˆë‹¤.

{% embed url="https://pentest-tools.com/" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
