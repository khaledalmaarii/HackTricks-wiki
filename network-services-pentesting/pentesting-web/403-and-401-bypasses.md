# 403 & 401 Bypassy

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Natychmiastowo dostÄ™pna konfiguracja do oceny podatnoÅ›ci i testÃ³w penetracyjnych**. PrzeprowadÅº peÅ‚ny pentest z dowolnego miejsca z 20+ narzÄ™dziami i funkcjami, ktÃ³re obejmujÄ… od rekonesansu po raportowanie. Nie zastÄ™pujemy pentesterÃ³w - rozwijamy niestandardowe narzÄ™dzia, moduÅ‚y wykrywania i eksploatacji, aby daÄ‡ im z powrotem trochÄ™ czasu na gÅ‚Ä™bsze badania, uzyskiwanie dostÄ™pu i zabawÄ™.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## Fuzzing metod HTTP

SprÃ³buj uÅ¼yÄ‡ **rÃ³Å¼nych metod** do uzyskania dostÄ™pu do pliku: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* SprawdÅº nagÅ‚Ã³wki odpowiedzi, moÅ¼e jakieÅ› informacje mogÄ… byÄ‡ podane. Na przykÅ‚ad, **odpowiedÅº 200** na **HEAD** z `Content-Length: 55` oznacza, Å¼e **metoda HEAD moÅ¼e uzyskaÄ‡ dostÄ™p do informacji**. Ale nadal musisz znaleÅºÄ‡ sposÃ³b na wyeksportowanie tych informacji.
* UÅ¼ycie nagÅ‚Ã³wka HTTP, takiego jak `X-HTTP-Method-Override: PUT`, moÅ¼e nadpisaÄ‡ uÅ¼ywanÄ… metodÄ™.
* UÅ¼yj **`TRACE`** i jeÅ›li masz duÅ¼o szczÄ™Å›cia, moÅ¼e w odpowiedzi zobaczysz rÃ³wnieÅ¼ **nagÅ‚Ã³wki dodane przez poÅ›rednie serwery proxy**, ktÃ³re mogÄ… byÄ‡ przydatne.

## Fuzzing nagÅ‚Ã³wkÃ³w HTTP

* **ZmieÅ„ nagÅ‚Ã³wek Host** na dowolnÄ… wartoÅ›Ä‡ ([to zadziaÅ‚aÅ‚o tutaj](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* SprÃ³buj [**uÅ¼yÄ‡ innych User Agents**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) do uzyskania dostÄ™pu do zasobu.
* **Fuzz nagÅ‚Ã³wkÃ³w HTTP**: SprÃ³buj uÅ¼yÄ‡ nagÅ‚Ã³wkÃ³w proxy HTTP, podstawowego uwierzytelniania HTTP i NTLM brute-force (tylko z kilkoma kombinacjami) oraz innych technik. W tym celu stworzyÅ‚em narzÄ™dzie [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

JeÅ›li **Å›cieÅ¼ka jest chroniona**, moÅ¼esz sprÃ³bowaÄ‡ obejÅ›Ä‡ ochronÄ™ Å›cieÅ¼ki, uÅ¼ywajÄ…c tych innych nagÅ‚Ã³wkÃ³w:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* JeÅ›li strona jest **za proxy**, moÅ¼e to proxy uniemoÅ¼liwiaÄ‡ ci dostÄ™p do prywatnych informacji. SprÃ³buj naduÅ¼yÄ‡ [**HTTP Request Smuggling**](../../pentesting-web/http-request-smuggling/) **lub** [**nagÅ‚Ã³wkÃ³w hop-by-hop**](../../pentesting-web/abusing-hop-by-hop-headers.md)**.**
* Fuzz [**specjalnymi nagÅ‚Ã³wkami HTTP**](special-http-headers.md), szukajÄ…c rÃ³Å¼nych odpowiedzi.
* **Fuzz specjalnymi nagÅ‚Ã³wkami HTTP** podczas fuzzingu **metod HTTP**.
* **UsuÅ„ nagÅ‚Ã³wek Host** i moÅ¼e uda ci siÄ™ obejÅ›Ä‡ ochronÄ™.

## **Fuzzing Å›cieÅ¼ki**

JeÅ›li _/path_ jest zablokowane:

* SprÃ³buj uÅ¼yÄ‡ _**/**_**%2e/path \_(jeÅ›li dostÄ™p jest zablokowany przez proxy, to moÅ¼e obejÅ›Ä‡ ochronÄ™). SprÃ³buj takÅ¼e**\_\*\* /%252e\*\*/path (podwÃ³jne kodowanie URL)
* SprÃ³buj **obejÅ›cia Unicode**: _/**%ef%bc%8f**path_ (zakodowane znaki URL sÄ… jak "/"), wiÄ™c po ponownym zakodowaniu bÄ™dzie to _//path_ i moÅ¼e juÅ¼ udaÅ‚o ci siÄ™ obejÅ›Ä‡ sprawdzanie nazwy _/path_
* **Inne obejÅ›cia Å›cieÅ¼ki**:
* site.com/secret â€“> HTTP 403 Forbidden
* site.com/SECRET â€“> HTTP 200 OK
* site.com/secret/ â€“> HTTP 200 OK
* site.com/secret/. â€“> HTTP 200 OK
* site.com//secret// â€“> HTTP 200 OK
* site.com/./secret/.. â€“> HTTP 200 OK
* site.com/;/secret â€“> HTTP 200 OK
* site.com/.;/secret â€“> HTTP 200 OK
* site.com//;//secret â€“> HTTP 200 OK
* site.com/secret.json â€“> HTTP 200 OK (ruby)
* UÅ¼yj [**tej listy**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) w nastÄ™pujÄ…cych sytuacjach:
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **Inne obejÅ›cia API:**
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {â€œidâ€:111} --> 401 Unauthorized
* {â€œidâ€:\[111]} --> 200 OK
* {â€œidâ€:111} --> 401 Unauthorized
* {â€œidâ€:{â€œidâ€:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSON Parameter Pollution)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (Parameter Pollution)

## **Manipulacja parametrami**

* ZmieÅ„ **wartoÅ›Ä‡ parametru**: Z **`id=123` --> `id=124`**
* Dodaj dodatkowe parametry do URL: `?`**`id=124` â€”-> `id=124&isAdmin=true`**
* UsuÅ„ parametry
* ZmieÅ„ kolejnoÅ›Ä‡ parametrÃ³w
* UÅ¼yj znakÃ³w specjalnych.
* Wykonaj testy graniczne w parametrach â€” podaj wartoÅ›ci takie jak _-234_ lub _0_ lub _99999999_ (tylko kilka przykÅ‚adowych wartoÅ›ci).

## **Wersja protokoÅ‚u**

JeÅ›li uÅ¼ywasz HTTP/1.1 **sprÃ³buj uÅ¼yÄ‡ 1.0** lub nawet przetestuj, czy **obsÅ‚uguje 2.0**.

## **Inne obejÅ›cia**

* Uzyskaj **IP** lub **CNAME** domeny i sprÃ³buj **skontaktowaÄ‡ siÄ™ z niÄ… bezpoÅ›rednio**.
* SprÃ³buj **obciÄ…Å¼yÄ‡ serwer**, wysyÅ‚ajÄ…c powszechne Å¼Ä…dania GET ([to zadziaÅ‚aÅ‚o dla tego goÅ›cia z Facebookiem](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **ZmieÅ„ protokÃ³Å‚**: z http na https, lub z https na http
* PrzejdÅº do [**https://archive.org/web/**](https://archive.org/web/) i sprawdÅº, czy w przeszÅ‚oÅ›ci ten plik byÅ‚ **ogÃ³lnodostÄ™pny**.

## **Brute Force**

* **Zgadnij hasÅ‚o**: Przetestuj nastÄ™pujÄ…ce powszechne dane uwierzytelniajÄ…ce. Czy wiesz coÅ› o ofierze? Lub nazwÄ™ wyzwania CTF?
* [**Brute force**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** SprÃ³buj podstawowego, digest i NTLM auth.

{% code title="Powszechne dane uwierzytelniajÄ…ce" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## NarzÄ™dzia automatyczne

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Rozszerzenie Burp - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
* [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Natychmiastowo dostÄ™pna konfiguracja do oceny podatnoÅ›ci i testÃ³w penetracyjnych**. PrzeprowadÅº peÅ‚ny pentest z dowolnego miejsca z 20+ narzÄ™dziami i funkcjami, ktÃ³re obejmujÄ… od rekonesansu po raportowanie. Nie zastÄ™pujemy pentesterÃ³w - rozwijamy niestandardowe narzÄ™dzia, moduÅ‚y wykrywania i eksploatacji, aby daÄ‡ im z powrotem trochÄ™ czasu na gÅ‚Ä™bsze badania, przeÅ‚amywanie zabezpieczeÅ„ i zabawÄ™.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w na GitHubie.

</details>
{% endhint %}
