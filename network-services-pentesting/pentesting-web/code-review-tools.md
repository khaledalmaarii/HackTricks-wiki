# Outils d'analyse de code

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## GÃ©nÃ©ral

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\
  
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### DÃ©couverte
1. Burp:
   - Spider et dÃ©couvrir le contenu
   - Sitemap > filtre
   - Sitemap > clic droit sur le domaine > Outils d'engagement > Trouver des scripts
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
   - `waybackurls <domain> |grep -i "\.js" |sort -u`
### Analyse statique
#### DÃ©minifier/embellir
https://prettier.io/playground/
https://beautifier.io/
#### DÃ©obfusquer/DÃ©compresser
__Note__: Il peut ne pas Ãªtre possible de dÃ©obfusquer complÃ¨tement.
1. Trouver et utiliser les fichiers .map:
   - Si les fichiers .map sont exposÃ©s, ils peuvent Ãªtre utilisÃ©s pour dÃ©obfusquer facilement.
   - Couramment, foo.js.map est mappÃ© Ã  foo.js. Recherchez-les manuellement.
   - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner) pour les rechercher.
    - Assurez-vous qu'une analyse active est effectuÃ©e.
    - Lire '[Conseils/Notes](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
   - Si vous les trouvez, utilisez [Maximize](https://www.npmjs.com/package/maximize) pour dÃ©obfusquer.
2. Sans fichiers .map, essayez JSnice:
   - RÃ©fÃ©rences: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
   - Conseils:
     - Si vous utilisez jsnice.org, cliquez sur le bouton d'options Ã  cÃ´tÃ© du bouton "Nicify JavaScript" et dÃ©sÃ©lectionnez "Infer types" pour rÃ©duire l'encombrement du code avec des commentaires.
     - Assurez-vous de ne laisser aucune ligne vide avant le script, car cela peut affecter le processus de dÃ©obfuscation et donner des rÃ©sultats inexacts.
3. Utilisez console.log(<packerReturnVariable>);
   - Trouvez la valeur de retour Ã  la fin et changez-la en `console.log(<packerReturnVariable>);` pour que le js dÃ©obfusquÃ© soit imprimÃ© au lieu d'Ãªtre exÃ©cutÃ©.
   - Ensuite, collez le js modifiÃ© (et toujours obfusquÃ©) dans https://jsconsole.com/ pour voir le js dÃ©obfusquÃ© enregistrÃ© dans la console.
   - Enfin, collez la sortie dÃ©obfusquÃ©e dans https://prettier.io/playground/ pour l'embellir pour l'analyse.
   - __Note__: Si vous voyez toujours du js empaquetÃ© (mais diffÃ©rent), il peut Ãªtre empaquetÃ© de maniÃ¨re rÃ©cursive. RÃ©pÃ©tez le processus.
#### Analyser
RÃ©fÃ©rences:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

 Recherchez:
- Chargement anti-dÃ©bogage
  - Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- Secrets
  - Utilisez:
    - [JS Miner](https://github.com/PortSwigger/js-miner)
    - [RegHex](https://github.com/l4yton/RegHex) patterns
    - [gf](https://github.com/tomnomnom/gf/tree/master/examples) patterns
    - Recherchez des motifs de dictionnaire pertinents:
      - pass, user, admin
      - auth, login, sign, challenge, 2fa
      - key, apikey, api_key, api-key, jwt, token
      - secret, security, secure
      - ...
    - Examen manuel
  - Si une clÃ© API est trouvÃ©e, vÃ©rifiez ici la syntaxe d'utilisation potentielle: https://github.com/streaak/keyhacks.
- Fonctions vulnÃ©rables
  - InnerHTML() - Si vous avez trouvÃ© cela, cela signifie qu'il y a une chance potentielle de XSS si aucune dÃ©sinfection appropriÃ©e n'a lieu. MÃªme si votre charge utile est dÃ©sinfectÃ©e, ne vous inquiÃ©tez pas. Tracez le code pour savoir oÃ¹ se trouve la dÃ©sinfection. Ã‰tudiez-le et essayez de contourner la dÃ©sinfection.
  - Postmessage() - Si vous avez lu mon prÃ©cÃ©dent article (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc), vous remarquerez que Postmessage() pourrait entraÃ®ner un problÃ¨me potentiel de CORS. Si le deuxiÃ¨me paramÃ¨tre de la fonction est dÃ©fini sur *, vous Ãªtes chanceux. Consultez mon article prÃ©cÃ©dent pour comprendre davantage le mÃ©canisme derriÃ¨re.
  - String.prototype.search() - Cette fonction semble normale. Pourquoi serait-ce une fonction dangereuse? Eh bien, c'est parce que certains dÃ©veloppeurs l'ont utilisÃ©e pour trouver l'occurrence d'une chaÃ®ne Ã  l'intÃ©rieur d'une autre chaÃ®ne. Cependant, "." est traitÃ© comme un caractÃ¨re gÃ©nÃ©rique dans cette fonction. Donc, si cette fonction est utilisÃ©e comme vÃ©rification de dÃ©sinfection, vous pouvez simplement la contourner en entrant ".". Consultez le rapport hackerone de Filedescryptor: https://hackerone.com/reports/129873
- Endpoints et paramÃ¨tres
  - Utilisez [LinkFinder](https://github.com/GerbenJavado/LinkFinder) & [JS Miner](https://github.com/PortSwigger/js-miner).
- BibliothÃ¨ques et dÃ©pendances vulnÃ©rables
  - Utilisez [Retire.js](https://retirejs.github.io/retire.js/) et [NPM](https://snyk.io/advisor/) (faites dÃ©filer jusqu'Ã  la section sÃ©curitÃ© > lien toutes les versions).
- URLs Cloud
  - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner).
- Sous-domaines
  - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner).
- Erreurs de logique
  - AcquÃ©rir une connaissance de la situation:
    - `use strict;`?
  - Recherchez des contrÃ´les cÃ´tÃ© client:
    - disable, enable, hidden, hide, show
    - catch, finally, throw, try
    - input, validate, verify, valid, correct, check, confirm, require, ..
  - Recherchez des non-primitifs:
    - function , =>
    - class
### Analyse dynamique

RÃ©fÃ©rences
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

Outils
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### RÃ©fÃ©rences moins utilisÃ©es
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron est un framework open source qui permet de crÃ©er des applications de bureau multiplateformes en utilisant des technologies web telles que HTML, CSS et JavaScript. Il est utilisÃ© par de nombreuses applications populaires telles que Slack, Discord et Visual Studio Code.

Cependant, l'utilisation d'Electron peut prÃ©senter des risques de sÃ©curitÃ©, car il permet aux dÃ©veloppeurs d'exÃ©cuter du code JavaScript cÃ´tÃ© client avec des privilÃ¨ges Ã©levÃ©s. Cela signifie que si une application Electron est compromise, un attaquant peut potentiellement accÃ©der Ã  des informations sensibles telles que des jetons d'authentification ou des clÃ©s API.

Il est donc important de prendre des mesures de sÃ©curitÃ© appropriÃ©es lors de la crÃ©ation d'applications Electron, telles que la validation des entrÃ©es utilisateur, la dÃ©sactivation de l'exÃ©cution de code Ã  distance et la mise en Å“uvre de politiques de sÃ©curitÃ© strictes pour les modules tiers utilisÃ©s dans l'application.
```
https://github.com/doyensec/electronegativity
```
## Python

Python est un langage de programmation interprÃ©tÃ© de haut niveau, orientÃ© objet et multiplateforme. Il est souvent utilisÃ© pour le dÃ©veloppement web, l'analyse de donnÃ©es, l'automatisation de tÃ¢ches et la crÃ©ation de scripts. Python est Ã©galement largement utilisÃ© dans le domaine de la sÃ©curitÃ© informatique pour l'automatisation de tÃ¢ches de pentesting et l'Ã©criture d'outils de hacking.

Les outils de code review pour Python incluent PyCharm, PyLint, Flake8 et Bandit. PyCharm est un environnement de dÃ©veloppement intÃ©grÃ© (IDE) pour Python qui offre des fonctionnalitÃ©s de dÃ©bogage, de refactoring et de test. PyLint est un outil de vÃ©rification de code qui dÃ©tecte les erreurs de syntaxe, les erreurs de style et les erreurs logiques dans le code Python. Flake8 est un outil de vÃ©rification de code qui combine PyLint, PyFlakes et McCabe pour dÃ©tecter les erreurs de syntaxe, les erreurs de style et les erreurs de complexitÃ© dans le code Python. Bandit est un outil de sÃ©curitÃ© de code source qui dÃ©tecte les vulnÃ©rabilitÃ©s de sÃ©curitÃ© dans le code Python, telles que les injections SQL, les fuites d'informations et les vulnÃ©rabilitÃ©s de contrÃ´le d'accÃ¨s.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

## Description
.NET is a free, open-source, cross-platform framework for building modern cloud-based applications. It is widely used for developing web applications, desktop applications, and mobile applications.

## Code Review Tools
- [Roslyn Security Guard](https://security-code-scan.github.io/RoslynSecurityGuard/)
- [.NET Security Guard](https://github.com/SecurityGuardNET/SecurityGuard)
- [SonarQube](https://www.sonarqube.org/)
- [Resharper](https://www.jetbrains.com/resharper/)
- [Visual Studio Code](https://code.visualstudio.com/)
- [Visual Studio](https://visualstudio.microsoft.com/)

## Useful .NET Libraries
- [Microsoft.AspNetCore.DataProtection](https://www.nuget.org/packages/Microsoft.AspNetCore.DataProtection/)
- [Microsoft.AspNetCore.Cryptography.KeyDerivation](https://www.nuget.org/packages/Microsoft.AspNetCore.Cryptography.KeyDerivation/)
- [Microsoft.AspNetCore.Identity](https://www.nuget.org/packages/Microsoft.AspNetCore.Identity/)
- [Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation/)
- [Microsoft.AspNetCore.WebUtilities](https://www.nuget.org/packages/Microsoft.AspNetCore.WebUtilities/)
- [Microsoft.Extensions.Caching.Memory](https://www.nuget.org/packages/Microsoft.Extensions.Caching.Memory/)
- [Microsoft.Extensions.Configuration](https://www.nuget.org/packages/Microsoft.Extensions.Configuration/)
- [Microsoft.Extensions.DependencyInjection](https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection/)
- [Microsoft.Extensions.Logging](https://www.nuget.org/packages/Microsoft.Extensions.Logging/)
- [Microsoft.Extensions.Options.ConfigurationExtensions](https://www.nuget.org/packages/Microsoft.Extensions.Options.ConfigurationExtensions/)
- [Microsoft.Extensions.Options.DataAnnotations](https://www.nuget.org/packages/Microsoft.Extensions.Options.DataAnnotations/)
- [Microsoft.Extensions.WebEncoders](https://www.nuget.org/packages/Microsoft.Extensions.WebEncoders/)
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java est un langage de programmation orientÃ© objet populaire utilisÃ© pour dÃ©velopper des applications pour une variÃ©tÃ© de plates-formes. Il est souvent utilisÃ© pour dÃ©velopper des applications Web et mobiles. Java est Ã©galement utilisÃ© pour dÃ©velopper des applications pour les plates-formes cloud et SaaS.

Les outils de rÃ©vision de code Java sont des outils qui aident les dÃ©veloppeurs Ã  trouver des erreurs de code et des vulnÃ©rabilitÃ©s de sÃ©curitÃ© dans leur code Java. Ces outils peuvent Ãªtre utilisÃ©s pour dÃ©tecter des erreurs de syntaxe, des erreurs de logique, des vulnÃ©rabilitÃ©s de sÃ©curitÃ© et d'autres problÃ¨mes de code.

Certains des outils de rÃ©vision de code Java les plus populaires sont FindBugs, PMD et Checkstyle. Ces outils peuvent Ãªtre utilisÃ©s pour dÃ©tecter des erreurs de code courantes telles que les fuites de mÃ©moire, les erreurs de syntaxe et les vulnÃ©rabilitÃ©s de sÃ©curitÃ©. Ils peuvent Ã©galement Ãªtre utilisÃ©s pour dÃ©tecter des erreurs de logique et d'autres problÃ¨mes de code plus complexes.

Les outils de rÃ©vision de code Java peuvent Ãªtre utilisÃ©s pour amÃ©liorer la qualitÃ© du code et rÃ©duire les risques de sÃ©curitÃ©. Ils peuvent Ã©galement Ãªtre utilisÃ©s pour amÃ©liorer la productivitÃ© des dÃ©veloppeurs en leur permettant de trouver et de corriger rapidement les erreurs de code.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| TÃ¢che           | Commande                                                  |
| --------------- | --------------------------------------------------------- |
| ExÃ©cuter un Jar | java -jar \[jar]                                          |
| DÃ©compresser Jar| unzip -d \[rÃ©pertoire de sortie] \[jar]                   |
| CrÃ©er un Jar    | jar -cmf META-INF/MANIFEST.MF \[jar de sortie] \*         |
| Base64 SHA256   | sha256sum \[fichier] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| Supprimer la signature | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA       |
| Supprimer du Jar| zip -d \[jar] \[fichier Ã  supprimer]                      |
| DÃ©compiler une classe | procyon -o . \[chemin de la classe]                  |
| DÃ©compiler un Jar | procyon -jar \[jar] -o \[rÃ©pertoire de sortie]            |
| Compiler une classe | javac \[chemin du fichier .java]                         |

## Go
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) et [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Plugins Wordpress

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
