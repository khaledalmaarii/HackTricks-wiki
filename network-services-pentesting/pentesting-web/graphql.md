# GraphQL

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## ä»‹ç»

GraphQLæ˜¯REST APIçš„æ›¿ä»£æ–¹æ¡ˆã€‚REST APIè¦æ±‚å®¢æˆ·ç«¯å‘APIçš„ä¸åŒç«¯ç‚¹å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»¥ä»åç«¯æ•°æ®åº“æŸ¥è¯¢æ•°æ®ã€‚è€Œä½¿ç”¨GraphQLï¼Œæ‚¨åªéœ€è¦å‘é€ä¸€ä¸ªè¯·æ±‚æ¥æŸ¥è¯¢åç«¯ã€‚è¿™æ ·åšæ›´ç®€å•ï¼Œå› ä¸ºæ‚¨ä¸éœ€è¦å‘APIå‘é€å¤šä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚å°±å¯ä»¥è·å–æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯ã€‚

## GraphQL

éšç€æ–°æŠ€æœ¯çš„å‡ºç°ï¼Œæ–°çš„æ¼æ´ä¹Ÿä¼šå‡ºç°ã€‚**é»˜è®¤æƒ…å†µä¸‹**ï¼ŒGraphQL**ä¸å®ç°èº«ä»½éªŒè¯**ï¼Œè¿™ç”±å¼€å‘äººå‘˜æ¥å®ç°ã€‚è¿™æ„å‘³ç€é»˜è®¤æƒ…å†µä¸‹ï¼ŒGraphQLå…è®¸ä»»ä½•äººæŸ¥è¯¢å®ƒï¼Œä»»ä½•æ•æ„Ÿä¿¡æ¯éƒ½å°†å¯¹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ç”¨ã€‚

åœ¨æ‰§è¡Œç›®å½•æš´åŠ›æ”»å‡»æ—¶ï¼Œè¯·ç¡®ä¿æ·»åŠ ä»¥ä¸‹è·¯å¾„ä»¥æ£€æŸ¥GraphQLå®ä¾‹ã€‚

* `/graphql`
* `/graphiql`
* `/graphql.php`
* `/graphql/console`
* `/api`
* `/api/graphql`
* `/graphql/api`
* `/graphql/graphql`

<figure><img src="../../.gitbook/assets/image (6) (1) (3).png" alt=""><figcaption></figcaption></figure>

ä¸€æ—¦æ‰¾åˆ°ä¸€ä¸ªå¼€æ”¾çš„GraphQLå®ä¾‹ï¼Œæ‚¨éœ€è¦çŸ¥é“**å®ƒæ”¯æŒå“ªäº›æŸ¥è¯¢**ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å†…çœç³»ç»Ÿæ¥å®Œæˆï¼Œæ›´å¤šè¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š[**GraphQLï¼šç”¨äºAPIçš„æŸ¥è¯¢è¯­è¨€ã€‚**\
è¯¢é—®GraphQLæ¨¡å¼æœ‰å…³å…¶æ”¯æŒçš„æŸ¥è¯¢çš„ä¿¡æ¯é€šå¸¸å¾ˆæœ‰ç”¨ã€‚GraphQLå…è®¸æˆ‘ä»¬è¿™æ ·åš...](https://graphql.org/learn/introspection/)

### æŒ‡çº¹è¯†åˆ«

å·¥å…·[**graphw00f**](https://github.com/dolevf/graphw00f)èƒ½å¤Ÿæ£€æµ‹æœåŠ¡å™¨ä¸­ä½¿ç”¨çš„GraphQLå¼•æ“ï¼Œç„¶åä¸ºå®‰å…¨å®¡è®¡äººå‘˜æä¾›ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ã€‚

#### é€šç”¨æŸ¥è¯¢ <a href="#universal-queries" id="universal-queries"></a>

å¦‚æœæ‚¨å‘ä»»ä½•GraphQLç«¯ç‚¹å‘é€`query{__typename}`ï¼Œå®ƒå°†åœ¨å…¶å“åº”ä¸­åŒ…å«å­—ç¬¦ä¸²`{"data": {"__typename": "query"}}`ã€‚è¿™è¢«ç§°ä¸ºé€šç”¨æŸ¥è¯¢ï¼Œæ˜¯æ¢æµ‹URLæ˜¯å¦å¯¹åº”äºGraphQLæœåŠ¡çš„æœ‰ç”¨å·¥å…·ã€‚

è¯¥æŸ¥è¯¢æœ‰æ•ˆæ˜¯å› ä¸ºæ¯ä¸ªGraphQLç«¯ç‚¹éƒ½æœ‰ä¸€ä¸ªåä¸º`__typename`çš„ä¿ç•™å­—æ®µï¼Œå®ƒä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›æŸ¥è¯¢å¯¹è±¡çš„ç±»å‹ã€‚

### åŸºæœ¬æšä¸¾

GraphQLé€šå¸¸æ”¯æŒ**GET**ï¼Œ**POST**ï¼ˆx-www-form-urlencodedï¼‰å’Œ**POST**ï¼ˆjsonï¼‰ã€‚ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå»ºè®®åªå…è®¸ä½¿ç”¨jsonä»¥é˜²æ­¢CSRFæ”»å‡»ã€‚

#### å†…çœ

è¦ä½¿ç”¨å†…çœæ¥å‘ç°æ¨¡å¼ä¿¡æ¯ï¼Œè¯·æŸ¥è¯¢`__schema`å­—æ®µã€‚è¯¥å­—æ®µåœ¨æ‰€æœ‰æŸ¥è¯¢çš„æ ¹ç±»å‹ä¸Šå¯ç”¨ã€‚
```bash
query={__schema{types{name,fields{name}}}}
```
ä½¿ç”¨æ­¤æŸ¥è¯¢ï¼Œæ‚¨å°†æ‰¾åˆ°æ­£åœ¨ä½¿ç”¨çš„æ‰€æœ‰ç±»å‹çš„åç§°ï¼š

![](<../../.gitbook/assets/image (202).png>)

{% code overflow="wrap" %}
```bash
query={__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}
```
{% endcode %}

ä½¿ç”¨æ­¤æŸ¥è¯¢ï¼Œæ‚¨å¯ä»¥æå–æ‰€æœ‰ç±»å‹ã€å­—æ®µå’Œå‚æ•°ï¼ˆä»¥åŠå‚æ•°çš„ç±»å‹ï¼‰ã€‚è¿™å¯¹äºäº†è§£å¦‚ä½•æŸ¥è¯¢æ•°æ®åº“éå¸¸æœ‰ç”¨ã€‚

![](<../../.gitbook/assets/image (207) (3).png>)

**é”™è¯¯**

äº†è§£**é”™è¯¯**æ˜¯å¦ä¼šè¢«**æ˜¾ç¤º**æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œå› ä¸ºå®ƒä»¬ä¼šæä¾›æœ‰ç”¨çš„**ä¿¡æ¯**ã€‚
```
?query={__schema}
?query={}
?query={thisdefinitelydoesnotexist}
```
**é€šè¿‡å†…çœæšä¸¾æ•°æ®åº“æ¨¡å¼**

{% hint style="info" %}
å¦‚æœå¯ç”¨äº†å†…çœä½†ä¸Šè¿°æŸ¥è¯¢æ— æ³•è¿è¡Œï¼Œè¯·å°è¯•ä»æŸ¥è¯¢ç»“æ„ä¸­åˆ é™¤ `onOperation`ã€`onFragment` å’Œ `onField` æŒ‡ä»¤ã€‚
{% endhint %}
```bash
#Full introspection query

query IntrospectionQuery {
__schema {
queryType {
name
}
mutationType {
name
}
subscriptionType {
name
}
types {
...FullType
}
directives {
name
description
args {
...InputValue
}
onOperation  #Often needs to be deleted to run query
onFragment   #Often needs to be deleted to run query
onField      #Often needs to be deleted to run query
}
}
}

fragment FullType on __Type {
kind
name
description
fields(includeDeprecated: true) {
name
description
args {
...InputValue
}
type {
...TypeRef
}
isDeprecated
deprecationReason
}
inputFields {
...InputValue
}
interfaces {
...TypeRef
}
enumValues(includeDeprecated: true) {
name
description
isDeprecated
deprecationReason
}
possibleTypes {
...TypeRef
}
}

fragment InputValue on __InputValue {
name
description
type {
...TypeRef
}
defaultValue
}

fragment TypeRef on __Type {
kind
name
ofType {
kind
name
ofType {
kind
name
ofType {
kind
name
}
}
}
}
```
å†…è”å†…çœæŸ¥è¯¢ï¼š

```graphql
{
  __schema {
    queryType {
      name
    }
    mutationType {
      name
    }
    subscriptionType {
      name
    }
    types {
      ...FullType
    }
    directives {
      name
      description
      args {
        ...InputValue
      }
      onOperation
      onFragment
      onField
    }
  }
}

fragment FullType on __Type {
  kind
  name
  description
  fields(includeDeprecated: true) {
    name
    description
    args {
      ...InputValue
    }
    type {
      ...TypeRef
    }
    isDeprecated
    deprecationReason
  }
  inputFields {
    ...InputValue
  }
  interfaces {
    ...TypeRef
  }
  enumValues(includeDeprecated: true) {
    name
    description
    isDeprecated
    deprecationReason
  }
  possibleTypes {
    ...TypeRef
  }
}

fragment InputValue on __InputValue {
  name
  description
  type {
    ...TypeRef
  }
  defaultValue
}

fragment TypeRef on __Type {
  kind
  name
  ofType {
    kind
    name
    ofType {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                        ofType {
                          kind
                          name
                          ofType {
                            kind
                            name
                            ofType {
                              kind
                              name
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

è¿™æ˜¯ä¸€ä¸ªå†…è”å†…çœæŸ¥è¯¢ï¼š

```graphql
{
  __schema {
    queryType {
      name
    }
    mutationType {
      name
    }
    subscriptionType {
      name
    }
    types {
      ...FullType
    }
    directives {
      name
      description
      args {
        ...InputValue
      }
      onOperation
      onFragment
      onField
    }
  }
}

fragment FullType on __Type {
  kind
  name
  description
  fields(includeDeprecated: true) {
    name
    description
    args {
      ...InputValue
    }
    type {
      ...TypeRef
    }
    isDeprecated
    deprecationReason
  }
  inputFields {
    ...InputValue
  }
  interfaces {
    ...TypeRef
  }
  enumValues(includeDeprecated: true) {
    name
    description
    isDeprecated
    deprecationReason
  }
  possibleTypes {
    ...TypeRef
  }
}

fragment InputValue on __InputValue {
  name
  description
  type {
    ...TypeRef
  }
  defaultValue
}

fragment TypeRef on __Type {
  kind
  name
  ofType {
    kind
    name
    ofType {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                        ofType {
                          kind
                          name
                          ofType {
                            kind
                            name
                            ofType {
                              kind
                              name
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```
```
/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}
```
æœ€åä¸€è¡Œä»£ç æ˜¯ä¸€ä¸ªGraphQLæŸ¥è¯¢ï¼Œå®ƒå°†ä»GraphQLä¸­è½¬å‚¨æ‰€æœ‰çš„å…ƒä¿¡æ¯ï¼ˆå¯¹è±¡åç§°ã€å‚æ•°ã€ç±»å‹...ï¼‰ã€‚

![](<../../.gitbook/assets/image (206).png>)

å¦‚æœå¯ç”¨äº†å†…çœåŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[**GraphQL Voyager**](https://github.com/APIs-guru/graphql-voyager)åœ¨GUIä¸­æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹ã€‚

### æŸ¥è¯¢

ç°åœ¨æˆ‘ä»¬çŸ¥é“æ•°æ®åº“ä¸­ä¿å­˜äº†å“ªäº›ç±»å‹çš„ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬å°è¯•**æå–ä¸€äº›å€¼**ã€‚

åœ¨å†…çœä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¯ä»¥ç›´æ¥æŸ¥è¯¢çš„**å¯¹è±¡ç±»å‹**ï¼ˆå› ä¸ºæ‚¨ä¸èƒ½ä»…ä»…å› ä¸ºå®ƒå­˜åœ¨å°±æŸ¥è¯¢ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚åœ¨ä¸‹é¢çš„å›¾åƒä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°"_queryType_"è¢«ç§°ä¸º"_Query_"ï¼Œè€Œ"_Query_"å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µæ˜¯"_flags_"ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢flagå¯¹è±¡ã€‚

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-17-48.png)

è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢"_flags_"çš„ç±»å‹æ˜¯"_Flags_"ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡å®šä¹‰å¦‚ä¸‹ï¼š

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-22-57.png)

æ‚¨å¯ä»¥çœ‹åˆ°"_Flags_"å¯¹è±¡ç”±**åç§°**å’Œ**å€¼**ç»„æˆã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢è·å–æ‰€æœ‰æ ‡å¿—çš„åç§°å’Œå€¼ï¼š
```javascript
query={flags{name, value}}
```
è¯·æ³¨æ„ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„å¯¹è±¡æ˜¯åƒä»¥ä¸‹ç¤ºä¾‹ä¸­çš„å­—ç¬¦ä¸²è¿™æ ·çš„åŸå§‹ç±»å‹

![](<../../.gitbook/assets/image (441).png>)

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢ï¼š
```javascript
query={hiddenFlags}
```
åœ¨å¦ä¸€ä¸ªä¾‹å­ä¸­ï¼Œ"_Query_" ç±»å‹å¯¹è±¡ä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼š"_user_" å’Œ "_users_"ã€‚å¦‚æœè¿™äº›å¯¹è±¡ä¸éœ€è¦ä»»ä½•å‚æ•°æ¥æœç´¢ï¼Œå¯ä»¥é€šè¿‡è¯·æ±‚æ‰€éœ€çš„æ•°æ®æ¥æ£€ç´¢å®ƒä»¬çš„æ‰€æœ‰ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥æå–ä¿å­˜çš„ç”¨æˆ·åå’Œå¯†ç ï¼š

![](<../../.gitbook/assets/image (208).png>)

ç„¶è€Œï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä½ å°è¯•è¿™æ ·åšï¼Œä½ ä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯ï¼š

![](<../../.gitbook/assets/image (210).png>)

çœ‹èµ·æ¥å®ƒä¼šä½¿ç”¨ç±»å‹ä¸º _Int_ çš„ "_**uid**_" å‚æ•°è¿›è¡Œæœç´¢ã€‚æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨[åŸºæœ¬æšä¸¾](graphql.md#basic-enumeration)éƒ¨åˆ†æå‡ºäº†ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ˜¾ç¤ºäº†æˆ‘ä»¬æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼š`query={__schema{types{name,fields{name, args{name,description,type{name, kind, ofType{name, kind}}}}}}}`

å¦‚æœä½ é˜…è¯»æˆ‘è¿è¡Œè¯¥æŸ¥è¯¢æ—¶æä¾›çš„å›¾åƒï¼Œä½ ä¼šå‘ç° "_**user**_" æœ‰ä¸€ä¸ªç±»å‹ä¸º _Int_ çš„ "_**uid**_" å‚æ•°ã€‚

å› æ­¤ï¼Œé€šè¿‡è¿›è¡Œä¸€äº›è½»é‡çº§çš„ _**uid**_ å¼ºåˆ¶ç ´è§£ï¼Œæˆ‘å‘ç°åœ¨ _**uid**=**1**_ ä¸­æ£€ç´¢åˆ°äº†ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå¯†ç ï¼š\
`query={user(uid:1){user,password}}`

![](<../../.gitbook/assets/image (211).png>)

è¯·æ³¨æ„ï¼Œæˆ‘**å‘ç°**æˆ‘å¯ä»¥è¯·æ±‚ "_**user**_" å’Œ "_**password**_" è¿™äº›å‚æ•°ï¼Œå› ä¸ºå¦‚æœæˆ‘å°è¯•æŸ¥æ‰¾ä¸å­˜åœ¨çš„å†…å®¹ (`query={user(uid:1){noExists}}`)ï¼Œæˆ‘ä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯ï¼š

![](<../../.gitbook/assets/image (213).png>)

åœ¨**æšä¸¾é˜¶æ®µ**æœŸé—´ï¼Œæˆ‘å‘ç° "_**dbuser**_" å¯¹è±¡çš„å­—æ®µæ˜¯ "_**user**_" å’Œ "_**password**_"ã€‚

**æŸ¥è¯¢å­—ç¬¦ä¸²è½¬å‚¨æŠ€å·§ï¼ˆæ„Ÿè°¢ @BinaryShadow\_ï¼‰**

å¦‚æœä½ å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²ç±»å‹è¿›è¡Œæœç´¢ï¼Œæ¯”å¦‚ï¼š`query={theusers(description: ""){username,password}}`ï¼Œå¹¶ä¸”ä½ æœç´¢ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œå®ƒå°†**è½¬å‚¨æ‰€æœ‰æ•°æ®**ã€‚ï¼ˆ_è¯·æ³¨æ„ï¼Œæ­¤ç¤ºä¾‹ä¸æ•™ç¨‹ç¤ºä¾‹æ— å…³ï¼Œå¯¹äºæ­¤ç¤ºä¾‹ï¼Œå‡è®¾ä½ å¯ä»¥ä½¿ç”¨åä¸º "**theusers**" çš„å­—ç¬¦ä¸²å­—æ®µ "**description**" è¿›è¡Œæœç´¢_ï¼‰ã€‚

GraphQL æ˜¯ä¸€é¡¹ç›¸å¯¹è¾ƒæ–°çš„æŠ€æœ¯ï¼Œæ­£åœ¨å¼€å§‹åœ¨åˆåˆ›å…¬å¸å’Œå¤§å‹ä¼ä¸šä¸­è·å¾—ä¸€äº›å…³æ³¨ã€‚é™¤äº†é»˜è®¤ç¼ºå°‘èº«ä»½éªŒè¯å¤–ï¼ŒGraphQL ç«¯ç‚¹å¯èƒ½è¿˜å®¹æ˜“å—åˆ°å…¶ä»–é”™è¯¯çš„å½±å“ï¼Œä¾‹å¦‚ IDORã€‚

### æœç´¢

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæƒ³è±¡ä¸€ä¸ªç”±ç”µå­é‚®ä»¶å’Œå§“åæ ‡è¯†çš„**äºº**çš„æ•°æ®åº“ï¼Œä»¥åŠç”±åç§°å’Œè¯„åˆ†æ ‡è¯†çš„**ç”µå½±**ã€‚ä¸€ä¸ª**äºº**å¯ä»¥ä¸å…¶ä»–**äºº**æˆä¸º**æœ‹å‹**ï¼Œä¸€ä¸ªäººå¯ä»¥**æ‹¥æœ‰ç”µå½±**ã€‚

ä½ å¯ä»¥é€šè¿‡**å§“å**æœç´¢äººï¼Œå¹¶è·å–ä»–ä»¬çš„ç”µå­é‚®ä»¶ï¼š
```javascript
{
searchPerson(name: "John Doe") {
email
}
}
```
æ‚¨å¯ä»¥é€šè¿‡å§“åæœç´¢äººå‘˜å¹¶è·å–ä»–ä»¬è®¢é˜…çš„ç”µå½±ï¼š
```javascript
{
searchPerson(name: "John Doe") {
email
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
è¯·æ³¨æ„ï¼Œè¿™é‡ŒæŒ‡ç¤ºè¦è·å–ä¸ªäººçš„`subscribedMovies`çš„`name`ã€‚

æ‚¨è¿˜å¯ä»¥**åŒæ—¶æœç´¢å¤šä¸ªå¯¹è±¡**ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿›è¡Œäº†æœç´¢2éƒ¨ç”µå½±ï¼š
```javascript
{
searchPerson(subscribedMovies: [{name: "Inception"}, {name: "Rocky"}]) {
name
}
}r
```
ç”šè‡³å¯ä»¥ä½¿ç”¨åˆ«åæ¥å»ºç«‹å¤šä¸ªä¸åŒå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼š
```javascript
{
johnsMovieList: searchPerson(name: "John Doe") {
subscribedMovies {
edges {
node {
name
}
}
}
}
davidsMovieList: searchPerson(name: "David Smith") {
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
### Mutationsï¼ˆå˜å¼‚ï¼‰

**å˜å¼‚ç”¨äºåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ›´æ”¹ã€‚**

åœ¨**å†…çœ**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**å£°æ˜çš„** **å˜å¼‚**ã€‚åœ¨ä¸‹é¢çš„å›¾åƒä¸­ï¼Œ"_MutationType_" è¢«ç§°ä¸º "_Mutation_"ï¼Œ"_Mutation_" å¯¹è±¡åŒ…å«å˜å¼‚çš„åç§°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º "_addPerson_"ï¼‰ï¼š

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-26-27.png)

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¸€ä¸ªç”±ç”µå­é‚®ä»¶å’Œå§“åæ ‡è¯†çš„**äººå‘˜**æ•°æ®åº“å’Œç”±åç§°å’Œè¯„åˆ†æ ‡è¯†çš„**ç”µå½±**ã€‚ä¸€ä¸ª**äººå‘˜**å¯ä»¥ä¸å…¶ä»–**äººå‘˜**æˆä¸º**æœ‹å‹**ï¼Œä¸€ä¸ªäººå¯ä»¥**æ‹¥æœ‰ç”µå½±**ã€‚

åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°ç”µå½±çš„å˜å¼‚å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼Œå˜å¼‚è¢«ç§°ä¸º `addMovie`ï¼‰ï¼š
```javascript
mutation {
addMovie(name: "Jumanji: The Next Level", rating: "6.8/10", releaseYear: 2019) {
movies {
name
rating
}
}
}
```
**æ³¨æ„æŸ¥è¯¢ä¸­åŒæ—¶æŒ‡ç¤ºäº†æ•°æ®çš„å€¼å’Œç±»å‹ã€‚**

è¿˜å¯èƒ½æœ‰ä¸€ä¸ª**mutation**æ¥**åˆ›å»º**äººå‘˜ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ç§°ä¸º`addPerson`ï¼‰ï¼Œå¹¶ä¸”æœ‰æœ‹å‹å’Œæ–‡ä»¶ï¼ˆè¯·æ³¨æ„ï¼Œåœ¨åˆ›å»ºä¸å®ƒä»¬ç›¸å…³çš„äººå‘˜ä¹‹å‰ï¼Œæœ‹å‹å’Œç”µå½±å¿…é¡»å­˜åœ¨ï¼‰ï¼š
```javascript
mutation {
addPerson(name: "James Yoe", email: "jy@example.com", friends: [{name: "John Doe"}, {email: "jd@example.com"}], subscribedMovies: [{name: "Rocky"}, {name: "Interstellar"}, {name: "Harry Potter and the Sorcerer's Stone"}]) {
person {
name
email
friends {
edges {
node {
name
email
}
}
}
subscribedMovies {
edges {
node {
name
rating
releaseYear
}
}
}
}
}
}
```
### åœ¨ä¸€ä¸ªAPIè¯·æ±‚ä¸­æ‰¹é‡è¿›è¡Œæš´åŠ›ç ´è§£

è¿™äº›ä¿¡æ¯æ¥è‡ªäº[https://lab.wallarm.com/graphql-batching-attack/](https://lab.wallarm.com/graphql-batching-attack/)ã€‚é€šè¿‡**åŒæ—¶å‘é€å¤šä¸ªå¸¦æœ‰ä¸åŒå‡­è¯çš„æŸ¥è¯¢**æ¥è¿›è¡ŒGraphQL APIçš„èº«ä»½éªŒè¯ã€‚è¿™æ˜¯ä¸€ç§ç»å…¸çš„æš´åŠ›ç ´è§£æ”»å‡»ï¼Œä½†ç°åœ¨ç”±äºGraphQLçš„æ‰¹å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªHTTPè¯·æ±‚ä¸­å‘é€å¤šä¸ªç™»å½•/å¯†ç å¯¹ã€‚è¿™ç§æ–¹æ³•ä¼šæ¬ºéª—å¤–éƒ¨é€Ÿç‡ç›‘æ§åº”ç”¨ç¨‹åºï¼Œè®©å®ƒä»¬è®¤ä¸ºä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰æš´åŠ›ç ´è§£æœºå™¨äººè¯•å›¾çŒœæµ‹å¯†ç ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºèº«ä»½éªŒè¯è¯·æ±‚çš„æœ€ç®€å•æ¼”ç¤ºï¼Œæ¯æ¬¡åŒæ—¶å‘é€**3ä¸ªä¸åŒçš„ç”µå­é‚®ä»¶/å¯†ç å¯¹**ã€‚æ˜¾ç„¶ï¼Œå¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼åœ¨å•ä¸ªè¯·æ±‚ä¸­å‘é€æ•°åƒä¸ªï¼š

![](<../../.gitbook/assets/image (182) (1).png>)

ä»å“åº”æˆªå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªè¯·æ±‚è¿”å›äº†_null_å¹¶åœ¨_error_éƒ¨åˆ†åæ˜ äº†ç›¸åº”çš„ä¿¡æ¯ã€‚**ç¬¬äºŒä¸ªmutationå…·æœ‰æ­£ç¡®çš„èº«ä»½éªŒè¯**æ•°æ®ï¼Œå“åº”ä¸­åŒ…å«äº†æ­£ç¡®çš„èº«ä»½éªŒè¯ä¼šè¯ä»¤ç‰Œã€‚

![](<../../.gitbook/assets/image (119) (1).png>)

## GraphQLæ— å†…çœ

è¶Šæ¥è¶Šå¤šçš„**GraphQLç«¯ç‚¹ç¦ç”¨äº†å†…çœ**ã€‚ç„¶è€Œï¼Œå½“æ”¶åˆ°æ„å¤–è¯·æ±‚æ—¶ï¼ŒGraphQLæŠ›å‡ºçš„é”™è¯¯è¶³ä»¥è®©åƒ[**clairvoyance**](https://github.com/nikitastupin/clairvoyance)è¿™æ ·çš„å·¥å…·é‡æ–°åˆ›å»ºå¤§éƒ¨åˆ†æ¨¡å¼ã€‚

æ­¤å¤–ï¼ŒBurp Suiteæ‰©å±•ç¨‹åº[**GraphQuail**](https://github.com/forcesunseen/graphquail)æ‰©å±•ç¨‹åº**è§‚å¯Ÿé€šè¿‡Burpä¼ é€’çš„GraphQL APIè¯·æ±‚**å¹¶**æ„å»º**ä¸€ä¸ªå†…éƒ¨çš„GraphQL**æ¨¡å¼**ï¼Œæ¯æ¬¡çœ‹åˆ°ä¸€ä¸ªæ–°çš„æŸ¥è¯¢æ—¶ã€‚å®ƒè¿˜å¯ä»¥ä¸ºGraphiQLå’ŒVoyagerå…¬å¼€æ¨¡å¼ã€‚å½“æ”¶åˆ°å†…çœæŸ¥è¯¢æ—¶ï¼Œè¯¥æ‰©å±•ç¨‹åºè¿”å›ä¸€ä¸ªè™šå‡çš„å“åº”ã€‚å› æ­¤ï¼ŒGraphQuailæ˜¾ç¤ºäº†APIä¸­å¯ç”¨äºä½¿ç”¨çš„æ‰€æœ‰æŸ¥è¯¢ã€å‚æ•°å’Œå­—æ®µã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·[**æŸ¥çœ‹æ­¤å¤„**](https://blog.forcesunseen.com/graphql-security-testing-without-a-schema)ã€‚

### ç»•è¿‡GraphQLå†…çœé˜²å¾¡ <a href="#bypassing-graphql-introspection-defences" id="bypassing-graphql-introspection-defences"></a>

å¦‚æœæ— æ³•è¿è¡Œé’ˆå¯¹æ­£åœ¨æµ‹è¯•çš„APIçš„å†…çœæŸ¥è¯¢ï¼Œè¯·å°è¯•åœ¨`__schema`å…³é”®å­—ä¹‹åæ’å…¥**ç‰¹æ®Šå­—ç¬¦**ã€‚

å½“å¼€å‘äººå‘˜ç¦ç”¨å†…çœæ—¶ï¼Œä»–ä»¬å¯èƒ½ä¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æ’é™¤æŸ¥è¯¢ä¸­çš„`__schema`å…³é”®å­—ã€‚æ‚¨åº”è¯¥å°è¯•åƒ**ç©ºæ ¼**ã€**æ¢è¡Œç¬¦**å’Œ**é€—å·**è¿™æ ·çš„å­—ç¬¦ï¼Œå› ä¸ºå®ƒä»¬è¢«GraphQLå¿½ç•¥ï¼Œä½†ä¸è¢«æœ‰ç¼ºé™·çš„æ­£åˆ™è¡¨è¾¾å¼å¿½ç•¥ã€‚

å› æ­¤ï¼Œå¦‚æœå¼€å‘äººå‘˜åªæ’é™¤äº†`__schema{`ï¼Œé‚£ä¹ˆä¸‹é¢çš„å†…çœæŸ¥è¯¢å°†ä¸ä¼šè¢«æ’é™¤ã€‚
```bash
#Introspection query with newline
{
"query": "query{__schema
{queryType{name}}}"
}
```
å¦‚æœè¿™ä¸ªæ–¹æ³•ä¸èµ·ä½œç”¨ï¼Œå°è¯•ä½¿ç”¨å…¶ä»–è¯·æ±‚æ–¹æ³•è¿è¡Œæ¢é’ˆï¼Œå› ä¸ºintrospectionå¯èƒ½åªåœ¨POSTè¯·æ±‚ä¸­è¢«ç¦ç”¨ã€‚å°è¯•ä½¿ç”¨GETè¯·æ±‚ï¼Œæˆ–è€…ä½¿ç”¨`x-www-form-urlencoded`ä½œä¸ºcontent-typeçš„POSTè¯·æ±‚ã€‚

### æ³„éœ²çš„GraphQLç»“æ„

å¦‚æœintrospectionè¢«ç¦ç”¨ï¼Œå°è¯•æŸ¥çœ‹ç½‘ç«™æºä»£ç ã€‚è¿™äº›æŸ¥è¯¢é€šå¸¸ä½œä¸ºJavaScriptåº“é¢„åŠ è½½åˆ°æµè§ˆå™¨ä¸­ã€‚è¿™äº›é¢„å…ˆç¼–å†™çš„æŸ¥è¯¢å¯ä»¥æ­ç¤ºå…³äºæ¯ä¸ªå¯¹è±¡å’Œå‡½æ•°çš„æ¨¡å¼å’Œä½¿ç”¨çš„å¼ºå¤§ä¿¡æ¯ã€‚å¼€å‘è€…å·¥å…·çš„`Sources`é€‰é¡¹å¡å¯ä»¥æœç´¢æ‰€æœ‰æ–‡ä»¶ä»¥æšä¸¾æŸ¥è¯¢ä¿å­˜çš„ä½ç½®ã€‚æœ‰æ—¶ç”šè‡³å·²ç»æš´éœ²äº†å—ç®¡ç†å‘˜ä¿æŠ¤çš„æŸ¥è¯¢ã€‚
```javascript
Inspect/Sources/"Search all files"
file:* mutation
file:* query
```
## GraphQLä¸­çš„CSRF

å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯CSRFï¼Œè¯·é˜…è¯»ä»¥ä¸‹é¡µé¢ï¼š

{% content-ref url="../../pentesting-web/csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](../../pentesting-web/csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

åœ¨é‚£é‡Œï¼Œä½ å°†èƒ½å¤Ÿæ‰¾åˆ°å‡ ä¸ª**æ²¡æœ‰é…ç½®CSRFä»¤ç‰Œ**çš„GraphQLç«¯ç‚¹ã€‚

è¯·æ³¨æ„ï¼ŒGraphQLè¯·æ±‚é€šå¸¸é€šè¿‡ä½¿ç”¨Content-Typeä¸º**`application/json`**çš„POSTè¯·æ±‚å‘é€ã€‚
```javascript
{"operationName":null,"variables":{},"query":"{\n  user {\n    firstName\n    __typename\n  }\n}\n"}
```
ç„¶è€Œï¼Œå¤§å¤šæ•°GraphQLç«¯ç‚¹ä¹Ÿæ”¯æŒ**`form-urlencoded` POSTè¯·æ±‚ï¼š**
```javascript
query=%7B%0A++user+%7B%0A++++firstName%0A++++__typename%0A++%7D%0A%7D%0A
```
å› æ­¤ï¼Œç”±äºç±»ä¼¼ä¹‹å‰çš„CSRFè¯·æ±‚æ˜¯**ä¸éœ€è¦é¢„æ£€è¯·æ±‚**çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡CSRFæ»¥ç”¨å¯¹GraphQLè¿›è¡Œ**æ›´æ”¹**ã€‚

ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼ŒChromeçš„`samesite`æ ‡å¿—çš„æ–°é»˜è®¤cookieå€¼æ˜¯`Lax`ã€‚è¿™æ„å‘³ç€è¯¥cookieä»…åœ¨GETè¯·æ±‚ä¸­ä»ç¬¬ä¸‰æ–¹ç½‘ç«™å‘é€ã€‚

è¯·æ³¨æ„ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥å°†**æŸ¥è¯¢è¯·æ±‚**ä½œä¸º**GETè¯·æ±‚**å‘é€ï¼Œå¹¶ä¸”åœ¨GETè¯·æ±‚ä¸­å¯èƒ½ä¸ä¼šéªŒè¯CSRFä»¤ç‰Œã€‚

æ­¤å¤–ï¼Œæ»¥ç”¨[**XS-Search**](../../pentesting-web/xs-search.md)**æ”»å‡»**å¯èƒ½ä¼šåˆ©ç”¨ç”¨æˆ·çš„å‡­æ®ä»GraphQLç«¯ç‚¹çªƒå–å†…å®¹ã€‚

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[**æ­¤å¤„çš„åŸå§‹å¸–å­**](https://blog.doyensec.com/2021/05/20/graphql-csrf.html)ã€‚

## GraphQLä¸­çš„æˆæƒ

ç«¯ç‚¹ä¸Šå®šä¹‰çš„è®¸å¤šGraphQLå‡½æ•°å¯èƒ½ä»…æ£€æŸ¥è¯·æ±‚è€…çš„èº«ä»½éªŒè¯ï¼Œè€Œä¸æ£€æŸ¥æˆæƒã€‚

ä¿®æ”¹æŸ¥è¯¢è¾“å…¥å˜é‡å¯èƒ½å¯¼è‡´æ•æ„Ÿè´¦æˆ·è¯¦ç»†ä¿¡æ¯çš„[æ³„éœ²](https://hackerone.com/reports/792927)ã€‚

ç”šè‡³å¯ä»¥é€šè¿‡ä¿®æ”¹å…¶ä»–è´¦æˆ·æ•°æ®æ¥å®ç°è´¦æˆ·æ¥ç®¡ã€‚
```javascript
{
"operationName":"updateProfile",
"variables":{"username":INJECT,"data":INJECT},
"query":"mutation updateProfile($username: String!,...){updateProfile(username: $username,...){...}}"
}
```
### ç»•è¿‡GraphQLçš„æˆæƒ

é€šè¿‡é“¾æ¥æŸ¥è¯¢å¯ä»¥ç»•è¿‡å¼±èº«ä»½éªŒè¯ç³»ç»Ÿã€‚

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ“ä½œæ˜¯"forgotPassword"ï¼Œå®ƒåº”è¯¥åªæ‰§è¡Œä¸ä¹‹å…³è”çš„forgotPasswordæŸ¥è¯¢ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢æ¥ç»•è¿‡æ­¤é™åˆ¶ï¼Œä¾‹å¦‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ·»åŠ äº†"register"å’Œä¸€ä¸ªç”¨æˆ·å˜é‡ï¼Œç³»ç»Ÿå°†å…¶æ³¨å†Œä¸ºæ–°ç”¨æˆ·ã€‚

<figure><img src="../../.gitbook/assets/GraphQLAuthBypassMethod.PNG" alt=""><figcaption></figcaption></figure>

## ä½¿ç”¨åˆ«åç»•è¿‡é€Ÿç‡é™åˆ¶

é€šå¸¸æƒ…å†µä¸‹ï¼ŒGraphQLå¯¹è±¡ä¸èƒ½åŒ…å«å…·æœ‰ç›¸åŒåç§°çš„å¤šä¸ªå±æ€§ã€‚åˆ«åå…è®¸æ‚¨é€šè¿‡**æ˜¾å¼å‘½åè¦è¿”å›çš„å±æ€§**æ¥ç»•è¿‡æ­¤é™åˆ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åˆ«ååœ¨ä¸€ä¸ªè¯·æ±‚ä¸­è¿”å›**åŒä¸€ç±»å‹çš„å¤šä¸ª**å¯¹è±¡å®ä¾‹ã€‚

æœ‰å…³GraphQLåˆ«åçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[åˆ«å](https://portswigger.net/web-security/graphql/what-is-graphql#aliases)ã€‚

è™½ç„¶åˆ«åæ—¨åœ¨å‡å°‘æ‚¨éœ€è¦è¿›è¡Œçš„APIè°ƒç”¨æ¬¡æ•°ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥ç”¨äºæš´åŠ›ç ´è§£GraphQLç«¯ç‚¹ã€‚

è®¸å¤šç«¯ç‚¹éƒ½ä¼šæœ‰æŸç§**é€Ÿç‡é™åˆ¶å™¨æ¥é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»**ã€‚æŸäº›é€Ÿç‡é™åˆ¶å™¨åŸºäºæ¥æ”¶åˆ°çš„**HTTPè¯·æ±‚çš„æ•°é‡**è€Œä¸æ˜¯åœ¨ç«¯ç‚¹ä¸Šæ‰§è¡Œçš„æ“ä½œæ•°é‡ã€‚å› ä¸ºåˆ«åæœ‰æ•ˆåœ°ä½¿æ‚¨èƒ½å¤Ÿåœ¨å•ä¸ªHTTPæ¶ˆæ¯ä¸­å‘é€å¤šä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥ç»•è¿‡æ­¤é™åˆ¶ã€‚

ä¸‹é¢çš„ç®€åŒ–ç¤ºä¾‹æ˜¾ç¤ºäº†ä¸€ç³»åˆ—**åˆ«åæŸ¥è¯¢ï¼Œæ£€æŸ¥å•†åº—æŠ˜æ‰£ä»£ç æ˜¯å¦æœ‰æ•ˆ**ã€‚è¿™ä¸ªæ“ä½œå¯èƒ½ä¼šç»•è¿‡é€Ÿç‡é™åˆ¶ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå³ä½¿å®ƒå¯èƒ½ç”¨äºä¸€æ¬¡æ€§æ£€æŸ¥å¤§é‡çš„æŠ˜æ‰£ä»£ç ã€‚
```bash
#Request with aliased queries
query isValidDiscount($code: Int) {
isvalidDiscount(code:$code){
valid
}
isValidDiscount2:isValidDiscount(code:$code){
valid
}
isValidDiscount3:isValidDiscount(code:$code){
valid
}
}
```
## å·¥å…·

### æ¼æ´æ‰«æå™¨

* [https://github.com/gsmith257-cyber/GraphCrawler](https://github.com/gsmith257-cyber/GraphCrawler)ï¼šå¯ä»¥ç”¨æ¥è·å–æ¨¡å¼å¹¶æœç´¢æ•æ„Ÿæ•°æ®ï¼Œæµ‹è¯•æˆæƒï¼Œæš´åŠ›ç ´è§£æ¨¡å¼ï¼Œå¹¶æ‰¾åˆ°åˆ°è¾¾ç»™å®šç±»å‹çš„è·¯å¾„çš„å·¥å…·åŒ…ã€‚
* [https://blog.doyensec.com/2020/03/26/graphql-scanner.html](https://blog.doyensec.com/2020/03/26/graphql-scanner.html)ï¼šå¯ä»¥ä½œä¸ºç‹¬ç«‹å·¥å…·æˆ–[Burpæ‰©å±•](https://github.com/doyensec/inql)ä½¿ç”¨ã€‚
* [https://github.com/swisskyrepo/GraphQLmap](https://github.com/swisskyrepo/GraphQLmap)ï¼šä¹Ÿå¯ä»¥ä½œä¸ºCLIå®¢æˆ·ç«¯ç”¨äºè‡ªåŠ¨åŒ–æ”»å‡»ã€‚
* [https://gitlab.com/dee-see/graphql-path-enum](https://gitlab.com/dee-see/graphql-path-enum)ï¼šåˆ—å‡ºåœ¨GraphQLæ¨¡å¼ä¸­åˆ°è¾¾ç»™å®šç±»å‹çš„ä¸åŒæ–¹å¼çš„å·¥å…·ã€‚

### å®¢æˆ·ç«¯

* [https://github.com/graphql/graphiql](https://github.com/graphql/graphiql)ï¼šGUIå®¢æˆ·ç«¯
* [https://altair.sirmuel.design/](https://altair.sirmuel.design/)ï¼šGUIå®¢æˆ·ç«¯

### è‡ªåŠ¨åŒ–æµ‹è¯•

{% embed url="https://graphql-dashboard.herokuapp.com/" %}

* è§£é‡ŠAutoGraphQLçš„è§†é¢‘ï¼š[https://www.youtube.com/watch?v=JJmufWfVvyU](https://www.youtube.com/watch?v=JJmufWfVvyU)

## å‚è€ƒèµ„æ–™

* [**https://jondow.eu/practical-graphql-attack-vectors/**](https://jondow.eu/practical-graphql-attack-vectors/)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4**](https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4)
* [**http://ghostlulz.com/api-hacking-graphql/**](http://ghostlulz.com/api-hacking-graphql/)
* [**https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://portswigger.net/web-security/graphql**](https://portswigger.net/web-security/graphql)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
