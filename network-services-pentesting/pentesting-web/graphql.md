# GraphQL

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## ä»‹ç»

GraphQL è¢«**å¼ºè°ƒ**ä¸º REST API çš„**é«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ**ï¼Œæä¾›äº†ä¸€ç§ç®€åŒ–çš„æ–¹å¼æ¥ä»åç«¯æŸ¥è¯¢æ•°æ®ã€‚ä¸ REST ç›¸æ¯”ï¼ŒREST é€šå¸¸éœ€è¦åœ¨ä¸åŒçš„ç«¯ç‚¹ä¹‹é—´è¿›è¡Œå¤šæ¬¡è¯·æ±‚ä»¥æ”¶é›†æ•°æ®ï¼Œè€Œ GraphQL å…è®¸é€šè¿‡**å•ä¸ªè¯·æ±‚**è·å–æ‰€æœ‰æ‰€éœ€çš„ä¿¡æ¯ã€‚è¿™ç§ç®€åŒ–æ˜¾è‘—**æœ‰åˆ©äºå¼€å‘è€…**ï¼Œå‡å°‘äº†ä»–ä»¬çš„æ•°æ®è·å–è¿‡ç¨‹çš„å¤æ‚æ€§ã€‚

## GraphQL å’Œå®‰å…¨æ€§

éšç€æ–°æŠ€æœ¯çš„å‡ºç°ï¼ŒåŒ…æ‹¬ GraphQLï¼Œæ–°çš„å®‰å…¨æ¼æ´ä¹Ÿéšä¹‹è€Œæ¥ã€‚ä¸€ä¸ªå…³é”®ç‚¹æ˜¯**GraphQL é»˜è®¤ä¸åŒ…å«è®¤è¯æœºåˆ¶**ã€‚å¼€å‘è€…æœ‰è´£ä»»å®æ–½è¿™äº›å®‰å…¨æªæ–½ã€‚æ²¡æœ‰é€‚å½“çš„è®¤è¯ï¼ŒGraphQL ç«¯ç‚¹å¯èƒ½ä¼šå‘æœªè®¤è¯ç”¨æˆ·æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼Œæ„æˆé‡å¤§å®‰å…¨é£é™©ã€‚

### ç›®å½•æš´åŠ›æ”»å‡»ä¸ GraphQL

ä¸ºäº†è¯†åˆ«æš´éœ²çš„ GraphQL å®ä¾‹ï¼Œå»ºè®®åœ¨ç›®å½•æš´åŠ›æ”»å‡»ä¸­åŒ…å«ç‰¹å®šè·¯å¾„ã€‚è¿™äº›è·¯å¾„åŒ…æ‹¬ï¼š

* `/graphql`
* `/graphiql`
* `/graphql.php`
* `/graphql/console`
* `/api`
* `/api/graphql`
* `/graphql/api`
* `/graphql/graphql`

è¯†åˆ«å¼€æ”¾çš„ GraphQL å®ä¾‹å¯ä»¥æ£€æŸ¥æ”¯æŒçš„æŸ¥è¯¢ã€‚è¿™å¯¹äºç†è§£é€šè¿‡ç«¯ç‚¹è®¿é—®çš„æ•°æ®è‡³å…³é‡è¦ã€‚GraphQL çš„è‡ªçœç³»ç»Ÿé€šè¿‡è¯¦ç»†è¯´æ˜æ¨¡å¼æ”¯æŒçš„æŸ¥è¯¢æ¥ä¿ƒè¿›è¿™ä¸€ç‚¹ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… GraphQL å…³äºè‡ªçœçš„æ–‡æ¡£ï¼š[**GraphQLï¼šAPI çš„æŸ¥è¯¢è¯­è¨€ã€‚**](https://graphql.org/learn/introspection/)

### æŒ‡çº¹è¯†åˆ«

å·¥å…· [**graphw00f**](https://github.com/dolevf/graphw00f) èƒ½å¤Ÿæ£€æµ‹æœåŠ¡å™¨ä½¿ç”¨çš„ GraphQL å¼•æ“ï¼Œå¹¶æ‰“å°ä¸€äº›å¯¹å®‰å…¨å®¡è®¡å‘˜æœ‰ç”¨çš„ä¿¡æ¯ã€‚

#### é€šç”¨æŸ¥è¯¢ <a href="#universal-queries" id="universal-queries"></a>

è¦æ£€æŸ¥ URL æ˜¯å¦ä¸º GraphQL æœåŠ¡ï¼Œå¯ä»¥å‘é€ä¸€ä¸ª**é€šç”¨æŸ¥è¯¢**ï¼Œ`query{__typename}`ã€‚å¦‚æœå“åº”åŒ…å« `{"data": {"__typename": "Query"}}`ï¼Œåˆ™ç¡®è®¤è¯¥ URL æ‰˜ç®¡äº†ä¸€ä¸ª GraphQL ç«¯ç‚¹ã€‚æ­¤æ–¹æ³•ä¾èµ–äº GraphQL çš„ `__typename` å­—æ®µï¼Œè¯¥å­—æ®µæ­ç¤ºäº†è¢«æŸ¥è¯¢å¯¹è±¡çš„ç±»å‹ã€‚
```javascript
query{__typename}
```
### åŸºæœ¬æšä¸¾

Graphql é€šå¸¸æ”¯æŒ **GET**ã€**POST** (x-www-form-urlencoded) å’Œ **POST**(json)ã€‚è™½ç„¶å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå»ºè®®ä»…å…è®¸ json ä»¥é˜²æ­¢ CSRF æ”»å‡»ã€‚

#### åå‘æŸ¥è¯¢

è¦ä½¿ç”¨åå‘æŸ¥è¯¢å‘ç°æ¶æ„ä¿¡æ¯ï¼Œè¯·æŸ¥è¯¢ `__schema` å­—æ®µã€‚è¯¥å­—æ®µåœ¨æ‰€æœ‰æŸ¥è¯¢çš„æ ¹ç±»å‹ä¸Šå¯ç”¨ã€‚
```bash
query={__schema{types{name,fields{name}}}}
```
é€šè¿‡æ­¤æŸ¥è¯¢ï¼Œæ‚¨å°†æ‰¾åˆ°æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„ç±»å‹çš„åç§°ï¼š

![](<../../.gitbook/assets/image (1036).png>)

{% code overflow="wrap" %}
```bash
query={__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}
```
{% endcode %}

é€šè¿‡è¿™ä¸ªæŸ¥è¯¢ï¼Œæ‚¨å¯ä»¥æå–æ‰€æœ‰ç±»å‹ã€å®ƒçš„å­—æ®µå’Œå®ƒçš„å‚æ•°ï¼ˆä»¥åŠå‚æ•°çš„ç±»å‹ï¼‰ã€‚è¿™å°†éå¸¸æœ‰åŠ©äºäº†è§£å¦‚ä½•æŸ¥è¯¢æ•°æ®åº“ã€‚

![](<../../.gitbook/assets/image (950).png>)

**é”™è¯¯**

äº†è§£**é”™è¯¯**æ˜¯å¦ä¼šè¢«**æ˜¾ç¤º**æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œå› ä¸ºå®ƒä»¬å°†æä¾›æœ‰ç”¨çš„**ä¿¡æ¯ã€‚**
```
?query={__schema}
?query={}
?query={thisdefinitelydoesnotexist}
```
![](<../../.gitbook/assets/image (416).png>)

**é€šè¿‡è‡ªçœæšä¸¾æ•°æ®åº“æ¨¡å¼**

{% hint style="info" %}
å¦‚æœè‡ªçœå·²å¯ç”¨ä½†ä¸Šè¿°æŸ¥è¯¢æ— æ³•è¿è¡Œï¼Œè¯·å°è¯•ä»æŸ¥è¯¢ç»“æ„ä¸­åˆ é™¤ `onOperation`ã€`onFragment` å’Œ `onField` æŒ‡ä»¤ã€‚
{% endhint %}
```bash
#Full introspection query

query IntrospectionQuery {
__schema {
queryType {
name
}
mutationType {
name
}
subscriptionType {
name
}
types {
...FullType
}
directives {
name
description
args {
...InputValue
}
onOperation  #Often needs to be deleted to run query
onFragment   #Often needs to be deleted to run query
onField      #Often needs to be deleted to run query
}
}
}

fragment FullType on __Type {
kind
name
description
fields(includeDeprecated: true) {
name
description
args {
...InputValue
}
type {
...TypeRef
}
isDeprecated
deprecationReason
}
inputFields {
...InputValue
}
interfaces {
...TypeRef
}
enumValues(includeDeprecated: true) {
name
description
isDeprecated
deprecationReason
}
possibleTypes {
...TypeRef
}
}

fragment InputValue on __InputValue {
name
description
type {
...TypeRef
}
defaultValue
}

fragment TypeRef on __Type {
kind
name
ofType {
kind
name
ofType {
kind
name
ofType {
kind
name
}
}
}
}
```
å†…è”è‡ªçœæŸ¥è¯¢ï¼š
```
/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}
```
æœ€åä¸€è¡Œä»£ç æ˜¯ä¸€ä¸ªgraphqlæŸ¥è¯¢ï¼Œå®ƒå°†è½¬å‚¨æ‰€æœ‰æ¥è‡ªgraphqlçš„å…ƒä¿¡æ¯ï¼ˆå¯¹è±¡åç§°ã€å‚æ•°ã€ç±»å‹...ï¼‰

![](<../../.gitbook/assets/image (363).png>)

å¦‚æœå¯ç”¨äº†è‡ªçœï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [**GraphQL Voyager**](https://github.com/APIs-guru/graphql-voyager) åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹ã€‚

### æŸ¥è¯¢

ç°åœ¨æˆ‘ä»¬çŸ¥é“æ•°æ®åº“ä¸­ä¿å­˜äº†å“ªç§ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬å°è¯•**æå–ä¸€äº›å€¼**ã€‚

åœ¨è‡ªçœä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**å¯ä»¥ç›´æ¥æŸ¥è¯¢çš„å¯¹è±¡**ï¼ˆå› ä¸ºæ‚¨ä¸èƒ½ä»…ä»…å› ä¸ºå¯¹è±¡å­˜åœ¨å°±æŸ¥è¯¢å®ƒï¼‰ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°â€œ_queryType_â€è¢«ç§°ä¸ºâ€œ_Query_â€ï¼Œè€Œâ€œ_Query_â€å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µæ˜¯â€œ_flags_â€ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ç±»å‹ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢æ ‡å¿—å¯¹è±¡ã€‚

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-17-48.png>)

è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢â€œ_flags_â€çš„ç±»å‹æ˜¯â€œ_Flags_â€ï¼Œè¯¥å¯¹è±¡å®šä¹‰å¦‚ä¸‹ï¼š

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-22-57 (1).png>)

æ‚¨å¯ä»¥çœ‹åˆ°â€œ_Flags_â€å¯¹è±¡ç”±**name**å’Œ**value**ç»„æˆã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æŸ¥è¯¢è·å–æ‰€æœ‰æ ‡å¿—çš„åç§°å’Œå€¼ï¼š
```javascript
query={flags{name, value}}
```
æ³¨æ„ï¼Œå¦‚æœ**æŸ¥è¯¢çš„å¯¹è±¡**æ˜¯åƒ**å­—ç¬¦ä¸²**è¿™æ ·çš„**åŸå§‹****ç±»å‹**ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤º

![](<../../.gitbook/assets/image (958).png>)

æ‚¨å¯ä»¥ç›´æ¥æŸ¥è¯¢ï¼š
```javascript
query={hiddenFlags}
```
åœ¨å¦ä¸€ä¸ªä¾‹å­ä¸­ï¼Œ"_Query_" ç±»å‹å¯¹è±¡ä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼š"_user_" å’Œ "_users_"ã€‚\
å¦‚æœè¿™äº›å¯¹è±¡ä¸éœ€è¦ä»»ä½•å‚æ•°è¿›è¡Œæœç´¢ï¼Œå¯ä»¥é€šè¿‡**è¯·æ±‚**æ‰€éœ€çš„æ•°æ®æ¥**æ£€ç´¢æ‰€æœ‰ä¿¡æ¯**ã€‚åœ¨è¿™ä¸ªäº’è”ç½‘ç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥æå–ä¿å­˜çš„ç”¨æˆ·åå’Œå¯†ç ï¼š

![](<../../.gitbook/assets/image (880).png>)

ç„¶è€Œï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä½ å°è¯•è¿™æ ·åšï¼Œä½ ä¼šå¾—åˆ°è¿™ä¸ª**é”™è¯¯**ï¼š

![](<../../.gitbook/assets/image (1042).png>)

çœ‹èµ·æ¥å®ƒä¼šä½¿ç”¨ç±»å‹ä¸º _**Int**_ çš„ "_**uid**_" å‚æ•°è¿›è¡Œæœç´¢ã€‚\
æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨ [Basic Enumeration](graphql.md#basic-enumeration) éƒ¨åˆ†æå‡ºäº†ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰æ‰€éœ€çš„ä¿¡æ¯ï¼š`query={__schema{types{name,fields{name, args{name,description,type{name, kind, ofType{name, kind}}}}}}}`

å¦‚æœä½ é˜…è¯»æˆ‘è¿è¡Œè¯¥æŸ¥è¯¢æ—¶æä¾›çš„å›¾åƒï¼Œä½ ä¼šçœ‹åˆ° "_**user**_" æœ‰ä¸€ä¸ªç±»å‹ä¸º _Int_ çš„ **arg** "_**uid**_"ã€‚

å› æ­¤ï¼Œé€šè¿‡ä¸€äº›è½»é‡çº§çš„ _**uid**_ æš´åŠ›ç ´è§£ï¼Œæˆ‘å‘ç° _**uid**=**1**_ æ—¶æ£€ç´¢åˆ°äº†ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå¯†ç ï¼š\
`query={user(uid:1){user,password}}`

![](<../../.gitbook/assets/image (90).png>)

æ³¨æ„æˆ‘**å‘ç°**æˆ‘å¯ä»¥è¯·æ±‚ **å‚æ•°** "_**user**_" å’Œ "_**password**_"ï¼Œå› ä¸ºå¦‚æœæˆ‘å°è¯•æŸ¥æ‰¾ä¸å­˜åœ¨çš„å†…å®¹ (`query={user(uid:1){noExists}}`)ï¼Œæˆ‘ä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯ï¼š

![](<../../.gitbook/assets/image (707).png>)

åœ¨**æšä¸¾é˜¶æ®µ**ï¼Œæˆ‘å‘ç° "_**dbuser**_" å¯¹è±¡çš„å­—æ®µæœ‰ "_**user**_" å’Œ "_**password**_"ã€‚

**æŸ¥è¯¢å­—ç¬¦ä¸²è½¬å‚¨æŠ€å·§ï¼ˆæ„Ÿè°¢ @BinaryShadow\_ï¼‰**

å¦‚æœä½ å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²ç±»å‹è¿›è¡Œæœç´¢ï¼Œä¾‹å¦‚ï¼š`query={theusers(description: ""){username,password}}`ï¼Œå¹¶ä¸”ä½ **æœç´¢ä¸€ä¸ªç©ºå­—ç¬¦ä¸²**ï¼Œå®ƒå°†**è½¬å‚¨æ‰€æœ‰æ•°æ®**ã€‚ (_æ³¨æ„è¿™ä¸ªä¾‹å­ä¸æ•™ç¨‹çš„ä¾‹å­æ— å…³ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­å‡è®¾ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªåä¸º "**description**" çš„å­—ç¬¦ä¸²å­—æ®µä½¿ç”¨ "**theusers**" è¿›è¡Œæœç´¢_).

### æœç´¢

åœ¨è¿™ä¸ªè®¾ç½®ä¸­ï¼Œä¸€ä¸ª**æ•°æ®åº“**åŒ…å«**äººå‘˜**å’Œ**ç”µå½±**ã€‚**äººå‘˜**é€šè¿‡ä»–ä»¬çš„**ç”µå­é‚®ä»¶**å’Œ**å§“å**è¿›è¡Œè¯†åˆ«ï¼›**ç”µå½±**é€šè¿‡å®ƒä»¬çš„**åç§°**å’Œ**è¯„åˆ†**è¿›è¡Œè¯†åˆ«ã€‚**äººå‘˜**å¯ä»¥äº’ä¸ºæœ‹å‹ï¼Œä¹Ÿå¯ä»¥æ‹¥æœ‰ç”µå½±ï¼Œè¡¨ç¤ºæ•°æ®åº“ä¸­çš„å…³ç³»ã€‚

ä½ å¯ä»¥é€šè¿‡**å§“å**æœç´¢äººå‘˜å¹¶è·å–ä»–ä»¬çš„ç”µå­é‚®ä»¶ï¼š
```javascript
{
searchPerson(name: "John Doe") {
email
}
}
```
æ‚¨å¯ä»¥é€šè¿‡**åç§°**æœç´¢äººå‘˜å¹¶è·å–ä»–ä»¬çš„**è®¢é˜…****ç”µå½±**ï¼š
```javascript
{
searchPerson(name: "John Doe") {
email
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
æ³¨æ„å¦‚ä½•æŒ‡ç¤ºæ£€ç´¢è¯¥äººçš„ `subscribedMovies` çš„ `name`ã€‚

æ‚¨è¿˜å¯ä»¥**åŒæ—¶æœç´¢å¤šä¸ªå¯¹è±¡**ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœç´¢äº† 2 éƒ¨ç”µå½±ï¼š
```javascript
{
searchPerson(subscribedMovies: [{name: "Inception"}, {name: "Rocky"}]) {
name
}
}r
```
æˆ–è€…ç”šè‡³**ä½¿ç”¨åˆ«åçš„å¤šä¸ªä¸åŒå¯¹è±¡çš„å…³ç³»**ï¼š
```javascript
{
johnsMovieList: searchPerson(name: "John Doe") {
subscribedMovies {
edges {
node {
name
}
}
}
}
davidsMovieList: searchPerson(name: "David Smith") {
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
### Mutations

**å˜æ›´ç”¨äºåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ›´æ”¹ã€‚**

åœ¨**è‡ªçœ**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**å£°æ˜çš„** **å˜æ›´**ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œ"_MutationType_" è¢«ç§°ä¸º "_Mutation_"ï¼Œè€Œ "_Mutation_" å¯¹è±¡åŒ…å«å˜æ›´çš„åç§°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º "_addPerson_"ï¼‰ï¼š

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-26-27 (1).png>)

åœ¨æ­¤è®¾ç½®ä¸­ï¼Œ**æ•°æ®åº“**åŒ…å«**äººå‘˜**å’Œ**ç”µå½±**ã€‚**äººå‘˜**é€šè¿‡å…¶**ç”µå­é‚®ä»¶**å’Œ**å§“å**è¿›è¡Œè¯†åˆ«ï¼›**ç”µå½±**é€šè¿‡å…¶**åç§°**å’Œ**è¯„åˆ†**è¿›è¡Œè¯†åˆ«ã€‚**äººå‘˜**å¯ä»¥å½¼æ­¤æˆä¸ºæœ‹å‹ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥æ‹¥æœ‰ç”µå½±ï¼Œè¡¨ç¤ºæ•°æ®åº“ä¸­çš„å…³ç³»ã€‚

ä¸€ä¸ª**åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°**ç”µå½±çš„å˜æ›´å¯ä»¥åƒä»¥ä¸‹ç¤ºä¾‹ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå˜æ›´è¢«ç§°ä¸º `addMovie`ï¼‰ï¼š
```javascript
mutation {
addMovie(name: "Jumanji: The Next Level", rating: "6.8/10", releaseYear: 2019) {
movies {
name
rating
}
}
}
```
**æ³¨æ„æŸ¥è¯¢ä¸­å¦‚ä½•æŒ‡ç¤ºå€¼å’Œæ•°æ®ç±»å‹ã€‚**

æ­¤å¤–ï¼Œæ•°æ®åº“æ”¯æŒä¸€ä¸ª**mutation**æ“ä½œï¼Œåä¸º`addPerson`ï¼Œå…è®¸åˆ›å»º**persons**åŠå…¶ä¸ç°æœ‰**friends**å’Œ**movies**çš„å…³è”ã€‚é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæœ‹å‹å’Œç”µå½±å¿…é¡»åœ¨æ•°æ®åº“ä¸­é¢„å…ˆå­˜åœ¨ï¼Œç„¶åæ‰èƒ½å°†å®ƒä»¬é“¾æ¥åˆ°æ–°åˆ›å»ºçš„äººã€‚
```javascript
mutation {
addPerson(name: "James Yoe", email: "jy@example.com", friends: [{name: "John Doe"}, {email: "jd@example.com"}], subscribedMovies: [{name: "Rocky"}, {name: "Interstellar"}, {name: "Harry Potter and the Sorcerer's Stone"}]) {
person {
name
email
friends {
edges {
node {
name
email
}
}
}
subscribedMovies {
edges {
node {
name
rating
releaseYear
}
}
}
}
}
}
```
### æŒ‡ä»¤é‡è½½

å¦‚[**æœ¬æŠ¥å‘Šä¸­æè¿°çš„æ¼æ´ä¹‹ä¸€**](https://www.landh.tech/blog/20240304-google-hack-50000/)æ‰€è¿°ï¼ŒæŒ‡ä»¤é‡è½½æ„å‘³ç€è°ƒç”¨æŒ‡ä»¤ç”šè‡³æ•°ç™¾ä¸‡æ¬¡ï¼Œä»¥ä½¿æœåŠ¡å™¨æµªè´¹æ“ä½œï¼Œç›´åˆ°å¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰ã€‚

### åœ¨1ä¸ªAPIè¯·æ±‚ä¸­æ‰¹é‡æš´åŠ›ç ´è§£

æ­¤ä¿¡æ¯æ¥è‡ª[https://lab.wallarm.com/graphql-batching-attack/](https://lab.wallarm.com/graphql-batching-attack/)ã€‚\
é€šè¿‡GraphQL APIè¿›è¡Œèº«ä»½éªŒè¯ï¼Œ**åŒæ—¶å‘é€å¤šä¸ªä¸åŒå‡­æ®çš„æŸ¥è¯¢**è¿›è¡Œæ£€æŸ¥ã€‚è¿™æ˜¯ä¸€ç§ç»å…¸çš„æš´åŠ›ç ´è§£æ”»å‡»ï¼Œä½†ç°åœ¨ç”±äºGraphQLæ‰¹é‡å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ¯ä¸ªHTTPè¯·æ±‚ä¸­å‘é€å¤šä¸ªç™»å½•/å¯†ç å¯¹ã€‚è¿™ç§æ–¹æ³•ä¼šæ¬ºéª—å¤–éƒ¨é€Ÿç‡ç›‘æ§åº”ç”¨ç¨‹åºï¼Œä½¿å…¶è®¤ä¸ºä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰æš´åŠ›ç ´è§£æœºå™¨äººè¯•å›¾çŒœæµ‹å¯†ç ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºèº«ä»½éªŒè¯è¯·æ±‚çš„æœ€ç®€å•æ¼”ç¤ºï¼Œ**ä¸€æ¬¡æœ‰3ä¸ªä¸åŒçš„ç”µå­é‚®ä»¶/å¯†ç å¯¹**ã€‚æ˜¾ç„¶ï¼Œå¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼åœ¨å•ä¸ªè¯·æ±‚ä¸­å‘é€æ•°åƒä¸ªï¼š

![](<../../.gitbook/assets/image (1081).png>)

ä»å“åº”æˆªå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªè¯·æ±‚è¿”å›äº†_null_ï¼Œå¹¶åœ¨_error_éƒ¨åˆ†åæ˜ äº†ç›¸åº”çš„ä¿¡æ¯ã€‚**ç¬¬äºŒä¸ªå˜æ›´å…·æœ‰æ­£ç¡®çš„èº«ä»½éªŒè¯**æ•°æ®ï¼Œå“åº”ä¸­åŒ…å«æ­£ç¡®çš„èº«ä»½éªŒè¯ä¼šè¯ä»¤ç‰Œã€‚

![](<../../.gitbook/assets/image (119) (1).png>)

## æ— éœ€è‡ªçœçš„GraphQL

è¶Šæ¥è¶Šå¤šçš„**graphqlç«¯ç‚¹æ­£åœ¨ç¦ç”¨è‡ªçœ**ã€‚ç„¶è€Œï¼Œå½“æ”¶åˆ°æ„å¤–è¯·æ±‚æ—¶ï¼ŒgraphqlæŠ›å‡ºçš„é”™è¯¯è¶³ä»¥è®©åƒ[**clairvoyance**](https://github.com/nikitastupin/clairvoyance)è¿™æ ·çš„å·¥å…·é‡å»ºå¤§éƒ¨åˆ†æ¶æ„ã€‚

æ­¤å¤–ï¼ŒBurp Suiteæ‰©å±•[**GraphQuail**](https://github.com/forcesunseen/graphquail) **è§‚å¯Ÿé€šè¿‡Burpçš„GraphQL APIè¯·æ±‚**å¹¶**æ„å»º**ä¸€ä¸ªå†…éƒ¨GraphQL **æ¶æ„**ï¼Œæ¯å½“å®ƒçœ‹åˆ°æ–°çš„æŸ¥è¯¢æ—¶ã€‚å®ƒè¿˜å¯ä»¥ä¸ºGraphiQLå’ŒVoyagerå…¬å¼€æ¶æ„ã€‚å½“æ”¶åˆ°è‡ªçœæŸ¥è¯¢æ—¶ï¼Œè¯¥æ‰©å±•è¿”å›ä¸€ä¸ªå‡å“åº”ã€‚å› æ­¤ï¼ŒGraphQuailæ˜¾ç¤ºäº†APIä¸­å¯ç”¨çš„æ‰€æœ‰æŸ¥è¯¢ã€å‚æ•°å’Œå­—æ®µã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·[**æŸ¥çœ‹æ­¤å¤„**](https://blog.forcesunseen.com/graphql-security-testing-without-a-schema)ã€‚

ä¸€ä¸ªå¾ˆå¥½çš„**è¯è¡¨**å¯ä»¥åœ¨è¿™é‡Œå‘ç°[**GraphQLå®ä½“**](https://github.com/Escape-Technologies/graphql-wordlist?)ã€‚

### ç»•è¿‡GraphQLè‡ªçœé˜²å¾¡ <a href="#bypassing-graphql-introspection-defences" id="bypassing-graphql-introspection-defences"></a>

ä¸ºäº†ç»•è¿‡APIä¸­å¯¹è‡ªçœæŸ¥è¯¢çš„é™åˆ¶ï¼Œåœ¨`__schema`å…³é”®å­—åæ’å…¥**ç‰¹æ®Šå­—ç¬¦**è¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº†å¼€å‘äººå‘˜åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­å¸¸è§çš„ç–å¿½ï¼Œè¿™äº›æ¨¡å¼æ—¨åœ¨é€šè¿‡å…³æ³¨`__schema`å…³é”®å­—æ¥é˜»æ­¢è‡ªçœã€‚é€šè¿‡æ·»åŠ åƒ**ç©ºæ ¼ã€æ¢è¡Œç¬¦å’Œé€—å·**è¿™æ ·çš„å­—ç¬¦ï¼ŒGraphQLä¼šå¿½ç•¥è¿™äº›å­—ç¬¦ï¼Œä½†æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œä»è€Œå¯ä»¥ç»•è¿‡é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œåœ¨`__schema`åé¢å¸¦æœ‰æ¢è¡Œç¬¦çš„è‡ªçœæŸ¥è¯¢å¯èƒ½ä¼šç»•è¿‡è¿™æ ·çš„é˜²å¾¡ï¼š
```bash
# Example with newline to bypass
{
"query": "query{__schema
{queryType{name}}}"
}
```
å¦‚æœä¸æˆåŠŸï¼Œè¯·è€ƒè™‘å…¶ä»–è¯·æ±‚æ–¹æ³•ï¼Œä¾‹å¦‚ **GET è¯·æ±‚** æˆ– **ä½¿ç”¨ `x-www-form-urlencoded` çš„ POST è¯·æ±‚**ï¼Œå› ä¸ºé™åˆ¶å¯èƒ½ä»…é€‚ç”¨äº POST è¯·æ±‚ã€‚

### å°è¯• WebSockets

å¦‚ [**æ­¤æ¼”è®²**](https://www.youtube.com/watch?v=tIo\_t5uUK50) ä¸­æåˆ°çš„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥é€šè¿‡ WebSockets è¿æ¥åˆ° graphQLï¼Œå› ä¸ºè¿™å¯èƒ½å…è®¸æ‚¨ç»•è¿‡æ½œåœ¨çš„ WAFï¼Œå¹¶ä½¿ websocket é€šä¿¡æ³„éœ² graphQL çš„æ¶æ„ï¼š
```javascript
ws = new WebSocket('wss://target/graphql', 'graphql-ws');
ws.onopen = function start(event) {
var GQL_CALL = {
extensions: {},
query: `
{
__schema {
_types {
name
}
}
}`
}

var graphqlMsg = {
type: 'GQL.START',
id: '1',
payload: GQL_CALL,
};
ws.send(JSON.stringify(graphqlMsg));
}
```
### **å‘ç°æš´éœ²çš„ GraphQL ç»“æ„**

å½“ introspection è¢«ç¦ç”¨æ—¶ï¼Œæ£€æŸ¥ç½‘ç«™æºä»£ç ä¸­ JavaScript åº“ä¸­é¢„åŠ è½½çš„æŸ¥è¯¢æ˜¯ä¸€ç§æœ‰æ•ˆçš„ç­–ç•¥ã€‚è¿™äº›æŸ¥è¯¢å¯ä»¥é€šè¿‡å¼€å‘è€…å·¥å…·ä¸­çš„ `Sources` é€‰é¡¹å¡æ‰¾åˆ°ï¼Œæä¾›æœ‰å…³ API æ¶æ„çš„è§è§£ï¼Œå¹¶æ­ç¤ºæ½œåœ¨çš„ **æš´éœ²æ•æ„ŸæŸ¥è¯¢**ã€‚åœ¨å¼€å‘è€…å·¥å…·ä¸­æœç´¢çš„å‘½ä»¤æ˜¯ï¼š
```javascript
Inspect/Sources/"Search all files"
file:* mutation
file:* query
```
## CSRF in GraphQL

å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ CSRFï¼Œè¯·é˜…è¯»ä»¥ä¸‹é¡µé¢ï¼š

{% content-ref url="../../pentesting-web/csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](../../pentesting-web/csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

åœ¨å¤–é¢ï¼Œä½ å°†èƒ½å¤Ÿæ‰¾åˆ°å‡ ä¸ª **æœªé…ç½® CSRF ä»¤ç‰Œçš„** GraphQL ç«¯ç‚¹ã€‚

è¯·æ³¨æ„ï¼ŒGraphQL è¯·æ±‚é€šå¸¸é€šè¿‡ä½¿ç”¨ Content-Type **`application/json`** çš„ POST è¯·æ±‚å‘é€ã€‚
```javascript
{"operationName":null,"variables":{},"query":"{\n  user {\n    firstName\n    __typename\n  }\n}\n"}
```
ç„¶è€Œï¼Œå¤§å¤šæ•° GraphQL ç«¯ç‚¹ä¹Ÿæ”¯æŒ **`form-urlencoded` POST è¯·æ±‚ï¼š**
```javascript
query=%7B%0A++user+%7B%0A++++firstName%0A++++__typename%0A++%7D%0A%7D%0A
```
å› æ­¤ï¼Œåƒä¹‹å‰é‚£æ ·çš„ CSRF è¯·æ±‚æ˜¯ **åœ¨æ²¡æœ‰é¢„æ£€è¯·æ±‚çš„æƒ…å†µä¸‹** å‘é€çš„ï¼Œå› æ­¤å¯ä»¥ **åˆ©ç”¨** **CSRF** åœ¨ GraphQL ä¸­ **è¿›è¡Œ** **æ›´æ”¹**ã€‚

ç„¶è€Œï¼Œè¯·æ³¨æ„ Chrome çš„ `samesite` æ ‡å¿—çš„æ–°é»˜è®¤ cookie å€¼ä¸º `Lax`ã€‚è¿™æ„å‘³ç€ cookie ä»…ä¼šåœ¨ GET è¯·æ±‚ä¸­ä»ç¬¬ä¸‰æ–¹ç½‘ç«™å‘é€ã€‚

è¯·æ³¨æ„ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥å°† **æŸ¥è¯¢** **è¯·æ±‚** ä½œä¸º **GET** **è¯·æ±‚** å‘é€ï¼Œå¹¶ä¸” CSRF ä»¤ç‰Œå¯èƒ½ä¸ä¼šåœ¨ GET è¯·æ±‚ä¸­è¿›è¡ŒéªŒè¯ã€‚

æ­¤å¤–ï¼Œåˆ©ç”¨ [**XS-Search**](../../pentesting-web/xs-search/) **æ”»å‡»** å¯èƒ½èƒ½å¤Ÿåˆ©ç”¨ç”¨æˆ·çš„å‡­æ®ä» GraphQL ç«¯ç‚¹æå–å†…å®¹ã€‚

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯· **æŸ¥çœ‹** [**åŸå§‹å¸–å­**](https://blog.doyensec.com/2021/05/20/graphql-csrf.html)ã€‚

## GraphQL ä¸­çš„è·¨ç«™ WebSocket åŠ«æŒ

ç±»ä¼¼äºåˆ©ç”¨ GraphQL çš„ CRSF æ¼æ´ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œ **è·¨ç«™ WebSocket åŠ«æŒï¼Œä»¥åˆ©ç”¨æœªä¿æŠ¤çš„ cookie è¿›è¡Œ GraphQL èº«ä»½éªŒè¯**ï¼Œå¹¶ä½¿ç”¨æˆ·åœ¨ GraphQL ä¸­æ‰§è¡Œæ„å¤–æ“ä½œã€‚

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../../pentesting-web/websocket-attacks.md" %}
[websocket-attacks.md](../../pentesting-web/websocket-attacks.md)
{% endcontent-ref %}

## GraphQL ä¸­çš„æˆæƒ

åœ¨ç«¯ç‚¹ä¸Šå®šä¹‰çš„è®¸å¤š GraphQL å‡½æ•°å¯èƒ½ä»…æ£€æŸ¥è¯·æ±‚è€…çš„èº«ä»½éªŒè¯ï¼Œè€Œä¸æ£€æŸ¥æˆæƒã€‚

ä¿®æ”¹æŸ¥è¯¢è¾“å…¥å˜é‡å¯èƒ½å¯¼è‡´æ•æ„Ÿè´¦æˆ·è¯¦ç»†ä¿¡æ¯ [æ³„éœ²](https://hackerone.com/reports/792927)ã€‚

çªå˜ç”šè‡³å¯èƒ½å¯¼è‡´è´¦æˆ·æ¥ç®¡ï¼Œè¯•å›¾ä¿®æ”¹å…¶ä»–è´¦æˆ·æ•°æ®ã€‚
```javascript
{
"operationName":"updateProfile",
"variables":{"username":INJECT,"data":INJECT},
"query":"mutation updateProfile($username: String!,...){updateProfile(username: $username,...){...}}"
}
```
### ç»•è¿‡ GraphQL ä¸­çš„æˆæƒ

[å°†æŸ¥è¯¢é“¾æ¥](https://s1n1st3r.gitbook.io/theb10g/graphql-query-authentication-bypass-vuln)åœ¨ä¸€èµ·å¯ä»¥ç»•è¿‡ä¸€ä¸ªå¼±è®¤è¯ç³»ç»Ÿã€‚

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ“ä½œæ˜¯â€œforgotPasswordâ€ï¼Œå¹¶ä¸”å®ƒåº”è¯¥åªæ‰§è¡Œä¸ä¹‹ç›¸å…³çš„ forgotPassword æŸ¥è¯¢ã€‚é€šè¿‡åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢å¯ä»¥ç»•è¿‡è¿™ä¸€ç‚¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ·»åŠ â€œregisterâ€å’Œä¸€ä¸ªç”¨æˆ·å˜é‡ï¼Œä»¥ä¾¿ç³»ç»Ÿæ³¨å†Œä¸ºæ–°ç”¨æˆ·ã€‚

<figure><img src="../../.gitbook/assets/GraphQLAuthBypassMethod.PNG" alt=""><figcaption></figcaption></figure>

## ä½¿ç”¨ GraphQL ä¸­çš„åˆ«åç»•è¿‡é€Ÿç‡é™åˆ¶

åœ¨ GraphQL ä¸­ï¼Œåˆ«åæ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå…è®¸åœ¨è¿›è¡Œ API è¯·æ±‚æ—¶**æ˜ç¡®å‘½åå±æ€§**ã€‚è¿™ä¸ªåŠŸèƒ½å¯¹äºåœ¨å•ä¸ªè¯·æ±‚ä¸­æ£€ç´¢**åŒä¸€ç±»å‹çš„å¤šä¸ªå®ä¾‹**ç‰¹åˆ«æœ‰ç”¨ã€‚åˆ«åå¯ä»¥ç”¨æ¥å…‹æœ GraphQL å¯¹è±¡ä¸èƒ½å…·æœ‰å¤šä¸ªåŒåå±æ€§çš„é™åˆ¶ã€‚

è¦è¯¦ç»†äº†è§£ GraphQL åˆ«åï¼Œæ¨èä»¥ä¸‹èµ„æºï¼š[Aliases](https://portswigger.net/web-security/graphql/what-is-graphql#aliases)ã€‚

è™½ç„¶åˆ«åçš„ä¸»è¦ç›®çš„æ˜¯å‡å°‘å¤§é‡ API è°ƒç”¨çš„å¿…è¦æ€§ï¼Œä½†å·²è¯†åˆ«å‡ºä¸€ä¸ªæ„å¤–çš„ç”¨ä¾‹ï¼Œå…¶ä¸­åˆ«åå¯ä»¥è¢«åˆ©ç”¨æ¥å¯¹ GraphQL ç«¯ç‚¹æ‰§è¡Œæš´åŠ›æ”»å‡»ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæŸäº›ç«¯ç‚¹å—åˆ°é€Ÿç‡é™åˆ¶å™¨çš„ä¿æŠ¤ï¼Œæ—¨åœ¨é€šè¿‡é™åˆ¶**HTTP è¯·æ±‚çš„æ•°é‡**æ¥é˜»æ­¢æš´åŠ›æ”»å‡»ã€‚ç„¶è€Œï¼Œè¿™äº›é€Ÿç‡é™åˆ¶å™¨å¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°æ¯ä¸ªè¯·æ±‚ä¸­çš„æ“ä½œæ•°é‡ã€‚é‰´äºåˆ«åå…è®¸åœ¨å•ä¸ª HTTP è¯·æ±‚ä¸­åŒ…å«å¤šä¸ªæŸ¥è¯¢ï¼Œå®ƒä»¬å¯ä»¥ç»•è¿‡æ­¤ç±»é€Ÿç‡é™åˆ¶æªæ–½ã€‚

è€ƒè™‘ä¸‹é¢æä¾›çš„ç¤ºä¾‹ï¼Œå®ƒè¯´æ˜äº†å¦‚ä½•ä½¿ç”¨åˆ«åæŸ¥è¯¢æ¥éªŒè¯å•†åº—æŠ˜æ‰£ä»£ç çš„æœ‰æ•ˆæ€§ã€‚è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡é€Ÿç‡é™åˆ¶ï¼Œå› ä¸ºå®ƒå°†å¤šä¸ªæŸ¥è¯¢ç¼–è¯‘æˆä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¯èƒ½å…è®¸åŒæ—¶éªŒè¯å¤šä¸ªæŠ˜æ‰£ä»£ç ã€‚
```bash
# Example of a request utilizing aliased queries to check for valid discount codes
query isValidDiscount($code: Int) {
isvalidDiscount(code:$code){
valid
}
isValidDiscount2:isValidDiscount(code:$code){
valid
}
isValidDiscount3:isValidDiscount(code:$code){
valid
}
}
```
## å·¥å…·

### æ¼æ´æ‰«æå™¨

* [https://github.com/dolevf/graphql-cop](https://github.com/dolevf/graphql-cop): æµ‹è¯•graphqlç«¯ç‚¹çš„å¸¸è§é”™è¯¯é…ç½®
* [https://github.com/assetnote/batchql](https://github.com/assetnote/batchql): ä¸“æ³¨äºæ‰§è¡Œæ‰¹é‡GraphQLæŸ¥è¯¢å’Œå˜æ›´çš„GraphQLå®‰å…¨å®¡è®¡è„šæœ¬ã€‚
* [https://github.com/dolevf/graphw00f](https://github.com/dolevf/graphw00f): æŒ‡çº¹è¯†åˆ«æ­£åœ¨ä½¿ç”¨çš„graphql
* [https://github.com/gsmith257-cyber/GraphCrawler](https://github.com/gsmith257-cyber/GraphCrawler): å¯ç”¨äºæŠ“å–æ¨¡å¼å’Œæœç´¢æ•æ„Ÿæ•°æ®ã€æµ‹è¯•æˆæƒã€æš´åŠ›ç ´è§£æ¨¡å¼ä»¥åŠæŸ¥æ‰¾åˆ°ç»™å®šç±»å‹çš„è·¯å¾„çš„å·¥å…·åŒ…ã€‚
* [https://blog.doyensec.com/2020/03/26/graphql-scanner.html](https://blog.doyensec.com/2020/03/26/graphql-scanner.html): å¯ä½œä¸ºç‹¬ç«‹å·¥å…·æˆ–[Burpæ‰©å±•](https://github.com/doyensec/inql)ä½¿ç”¨ã€‚
* [https://github.com/swisskyrepo/GraphQLmap](https://github.com/swisskyrepo/GraphQLmap): ä¹Ÿå¯ä»¥ä½œä¸ºCLIå®¢æˆ·ç«¯ä½¿ç”¨ä»¥è‡ªåŠ¨åŒ–æ”»å‡»
* [https://gitlab.com/dee-see/graphql-path-enum](https://gitlab.com/dee-see/graphql-path-enum): åˆ—å‡ºåœ¨GraphQLæ¨¡å¼ä¸­**åˆ°è¾¾ç»™å®šç±»å‹çš„ä¸åŒæ–¹å¼**çš„å·¥å…·ã€‚
* [https://github.com/doyensec/GQLSpection](https://github.com/doyensec/GQLSpection): InQLçš„ç‹¬ç«‹å’ŒCLIæ¨¡å¼çš„ç»§ä»»è€…
* [https://github.com/doyensec/inql](https://github.com/doyensec/inql): ç”¨äºé«˜çº§GraphQLæµ‹è¯•çš„Burpæ‰©å±•ã€‚_**æ‰«æå™¨**_æ˜¯InQL v5.0çš„æ ¸å¿ƒï¼Œæ‚¨å¯ä»¥åˆ†æGraphQLç«¯ç‚¹æˆ–æœ¬åœ°è‡ªçœæ¨¡å¼æ–‡ä»¶ã€‚å®ƒè‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æŸ¥è¯¢å’Œå˜æ›´ï¼Œå¹¶å°†å…¶ç»„ç»‡æˆç»“æ„åŒ–è§†å›¾ä»¥ä¾›åˆ†æã€‚_**æ”»å‡»è€…**_ç»„ä»¶å…è®¸æ‚¨è¿è¡Œæ‰¹é‡GraphQLæ”»å‡»ï¼Œè¿™å¯¹äºè§„é¿å®ç°ä¸ä½³çš„é€Ÿç‡é™åˆ¶éå¸¸æœ‰ç”¨ã€‚
* [https://github.com/nikitastupin/clairvoyance](https://github.com/nikitastupin/clairvoyance): å°è¯•é€šè¿‡ä½¿ç”¨ä¸€äº›Graphqlæ•°æ®åº“çš„å¸®åŠ©ï¼Œå³ä½¿åœ¨ç¦ç”¨è‡ªçœçš„æƒ…å†µä¸‹ä¹Ÿè·å–æ¨¡å¼ï¼Œè¿™äº›æ•°æ®åº“å°†å»ºè®®å˜æ›´å’Œå‚æ•°çš„åç§°ã€‚

### å®¢æˆ·ç«¯

* [https://github.com/graphql/graphiql](https://github.com/graphql/graphiql): GUIå®¢æˆ·ç«¯
* [https://altair.sirmuel.design/](https://altair.sirmuel.design/): GUIå®¢æˆ·ç«¯

### è‡ªåŠ¨æµ‹è¯•

{% embed url="https://graphql-dashboard.herokuapp.com/" %}

* è§£é‡ŠAutoGraphQLçš„è§†é¢‘: [https://www.youtube.com/watch?v=JJmufWfVvyU](https://www.youtube.com/watch?v=JJmufWfVvyU)

## å‚è€ƒ

* [**https://jondow.eu/practical-graphql-attack-vectors/**](https://jondow.eu/practical-graphql-attack-vectors/)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4**](https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4)
* [**http://ghostlulz.com/api-hacking-graphql/**](http://ghostlulz.com/api-hacking-graphql/)
* [**https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://portswigger.net/web-security/graphql**](https://portswigger.net/web-security/graphql)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶(ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶(GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
