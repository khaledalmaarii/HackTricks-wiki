# Bezpieczestwo ImageMagick

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

Sprawd藕 dalsze szczeg贸y na stronie [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, wszechstronna biblioteka do przetwarzania obraz贸w, stanowi wyzwanie w konfiguracji swojej polityki bezpieczestwa ze wzgldu na swoje rozlege opcje i brak szczeg贸owej dokumentacji online. U偶ytkownicy czsto tworz polityki oparte na fragmentarycznych 藕r贸dach internetowych, co prowadzi do potencjalnych bd贸w konfiguracyjnych. Biblioteka obsuguje szeroki zakres ponad 100 format贸w obraz贸w, co przyczynia si do jej zo偶onoci i profilu podatnoci, jak pokazuj historyczne incydenty zwizane z bezpieczestwem.

## W kierunku bezpieczniejszych polityk
Aby poradzi sobie z tymi wyzwaniami, [zostao opracowane narzdzie](https://imagemagick-secevaluator.doyensec.com/), kt贸re pomaga w projektowaniu i audycie polityk bezpieczestwa ImageMagick. Narzdzie to opiera si na obszernej analizie i ma na celu zapewnienie, 偶e polityki s nie tylko solidne, ale tak偶e wolne od luk, kt贸re mogyby zosta wykorzystane.

## Podejcie na podstawie listy dozwolonych vs listy zabronionych
Historycznie polityki ImageMagick polegay na podejciu opartym na licie zabronionych, gdzie okrelonym kodom byo odmawiane dostpu. Jednak zmiany w ImageMagick 6.9.7-7 zmieniy ten paradygmat, umo偶liwiajc podejcie oparte na licie dozwolonych. To podejcie najpierw odmawia dostpu wszystkim kodom, a nastpnie selektywnie udziela dostpu zaufanym, poprawiajc postaw bezpieczestwa.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Wra偶liwo na wielko liter w politykach
Nale偶y zauwa偶y, 偶e wzorce polityk w ImageMagick s wra偶liwe na wielko liter. Dlatego wa偶ne jest, aby upewni si, 偶e kodery i moduy s poprawnie zapisane wielkimi literami w politykach, aby zapobiec niezamierzonym uprawnieniom.

## Limity zasob贸w
ImageMagick jest podatny na ataki typu odmowa usugi, jeli nie jest odpowiednio skonfigurowany. Ustalenie jasnych limit贸w zasob贸w w politykach jest niezbdne, aby zapobiec takim podatnociom.

## Fragmentacja polityk
Polityki mog by rozproszone w r贸偶nych instalacjach ImageMagick, co mo偶e prowadzi do potencjalnych konflikt贸w lub nadpisywania. Zaleca si zlokalizowanie i zweryfikowanie aktywnych plik贸w polityk za pomoc polece, takich jak:
```shell
$ find / -iname policy.xml
```
## Szablon polityki o ograniczonym dostpie
Zaproponowano szablon polityki o ograniczonym dostpie, skupiajcy si na rygorystycznych ograniczeniach zasob贸w i kontroli dostpu. Ten szablon su偶y jako podstawa do opracowania spersonalizowanych polityk, kt贸re s zgodne z konkretnymi wymaganiami aplikacji.

Skuteczno polityki bezpieczestwa mo偶na potwierdzi za pomoc polecenia `identify -list policy` w ImageMagick. Dodatkowo, wczeniej wspomniane narzdzie [evaluator](https://imagemagick-secevaluator.doyensec.com/) mo偶na u偶y do dopracowania polityki na podstawie indywidualnych potrzeb.

## Odnoniki
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy **reklam swojej firmy w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi trikami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
