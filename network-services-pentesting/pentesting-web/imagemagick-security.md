# ImageMagick Bezbednost

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

Proverite dodatne detalje na [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, svestrana biblioteka za obradu slika, predstavlja izazov u konfigurisanju svoje bezbednosne politike zbog svojih opseÅ¾nih opcija i nedostatka detaljne online dokumentacije. Korisnici Äesto kreiraju politike na osnovu fragmentisanih internet izvora, Å¡to moÅ¾e dovesti do potencijalnih pogreÅ¡nih konfiguracija. Biblioteka podrÅ¾ava Å¡irok spektar od preko 100 formata slika, od kojih svaki doprinosi njenoj kompleksnosti i profilu ranjivosti, Å¡to su pokazali istorijski bezbednosni incidenti.

## Ka Bezbednijim Politikama
Kako bi se reÅ¡ili ovi izazovi, [razvijen je alat](https://imagemagick-secevaluator.doyensec.com/) koji pomaÅ¾e u dizajniranju i reviziji bezbednosnih politika ImageMagick-a. Ovaj alat je zasnovan na opseÅ¾nom istraÅ¾ivanju i ima za cilj da osigura da politike budu ne samo robusne, veÄ‡ i bez rupa koje bi mogle biti iskoriÅ¡Ä‡ene.

## Pristup sa Dozvolama naspram Pristupa sa Zabrana
Istorijski gledano, politike ImageMagick-a oslanjale su se na pristup sa zabranama, gde su odreÄ‘enim kodovima bio uskraÄ‡en pristup. MeÄ‘utim, promene u ImageMagick 6.9.7-7 su pomerile ovu paradigmu, omoguÄ‡avajuÄ‡i pristup sa dozvolama. Ovaj pristup prvo uskraÄ‡uje pristup svim kodovima, a zatim selektivno dodeljuje pristup pouzdanim, Äime se poboljÅ¡ava bezbednosna pozicija.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Osjetljivost na velika i mala slova u politikama
VaÅ¾no je napomenuti da su obrasci politika u ImageMagick-u osjetljivi na velika i mala slova. Stoga je od suÅ¡tinskog znaÄaja osigurati da su kodovi i moduli pravilno napisani velikim slovima u politikama kako bi se spreÄile nepredviÄ‘ene dozvole.

## OgraniÄenja resursa
ImageMagick je podloÅ¾an napadima uskraÄ‡ivanja usluga ako nije pravilno konfigurisan. Postavljanje eksplicitnih ograniÄenja resursa u politici je od suÅ¡tinskog znaÄaja za spreÄavanje takvih ranjivosti.

## Fragmentacija politika
Politike mogu biti fragmentirane kroz razliÄite instalacije ImageMagick-a, Å¡to moÅ¾e dovesti do potencijalnih sukoba ili preklapanja. PreporuÄuje se lociranje i verifikacija aktivnih datoteka politika koriÅ¡Ä‡enjem komandi kao Å¡to su:
```shell
$ find / -iname policy.xml
```
## PoÄetna, Restriktivna Politika
PredloÅ¾en je Å¡ablon restriktivne politike, fokusirajuÄ‡i se na stroga ograniÄenja resursa i kontrole pristupa. Ovaj Å¡ablon sluÅ¾i kao osnovna taÄka za razvijanje prilagoÄ‘enih politika koje se usklaÄ‘uju sa specifiÄnim zahtevima aplikacija.

Efikasnost bezbednosne politike moÅ¾e se potvrditi koriÅ¡Ä‡enjem komande `identify -list policy` u ImageMagick-u. Pored toga, [alat za evaluaciju](https://imagemagick-secevaluator.doyensec.com/) pomenut ranije moÅ¾e se koristiti za usavrÅ¡avanje politike na osnovu individualnih potreba.

## Reference
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
