# ImageMagick å®‰å…¨æ€§

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

æŸ¥çœ‹æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·è®¿é—® [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„å›¾åƒå¤„ç†åº“ï¼Œç”±äºå…¶å¹¿æ³›çš„é€‰é¡¹å’Œç¼ºä¹è¯¦ç»†çš„åœ¨çº¿æ–‡æ¡£ï¼Œé…ç½®å…¶å®‰å…¨ç­–ç•¥é¢ä¸´æŒ‘æˆ˜ã€‚ç”¨æˆ·é€šå¸¸åŸºäºé›¶æ•£çš„äº’è”ç½‘æ¥æºåˆ›å»ºç­–ç•¥ï¼Œè¿™å¯èƒ½å¯¼è‡´æ½œåœ¨çš„é”™è¯¯é…ç½®ã€‚è¯¥åº“æ”¯æŒè¶…è¿‡ 100 ç§å›¾åƒæ ¼å¼ï¼Œæ¯ç§æ ¼å¼éƒ½å¢åŠ äº†å…¶å¤æ‚æ€§å’Œè„†å¼±æ€§ï¼Œå†å²å®‰å…¨äº‹ä»¶è¯æ˜äº†è¿™ä¸€ç‚¹ã€‚

## æœç€æ›´å®‰å…¨çš„æ”¿ç­–
ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œå·²ç»å¼€å‘äº†ä¸€ä¸ª [å·¥å…·](https://imagemagick-secevaluator.doyensec.com/) æ¥å¸®åŠ©è®¾è®¡å’Œå®¡è®¡ ImageMagick çš„å®‰å…¨æ”¿ç­–ã€‚è¯¥å·¥å…·åŸºäºå¹¿æ³›çš„ç ”ç©¶ï¼Œæ—¨åœ¨ç¡®ä¿æ”¿ç­–ä¸ä»…ç¨³å¥ï¼Œè€Œä¸”æ²¡æœ‰å¯èƒ½è¢«åˆ©ç”¨çš„æ¼æ´ã€‚

## å…è®¸åˆ—è¡¨ä¸æ‹’ç»åˆ—è¡¨æ–¹æ³•
å†å²ä¸Šï¼ŒImageMagick æ”¿ç­–ä¾èµ–äºæ‹’ç»åˆ—è¡¨æ–¹æ³•ï¼Œå…¶ä¸­ç‰¹å®šçš„ç¼–ç å™¨è¢«æ‹’ç»è®¿é—®ã€‚ç„¶è€Œï¼ŒImageMagick 6.9.7-7 çš„å˜åŒ–æ”¹å˜äº†è¿™ä¸€èŒƒå¼ï¼Œä½¿å…è®¸åˆ—è¡¨æ–¹æ³•æˆä¸ºå¯èƒ½ã€‚è¯¥æ–¹æ³•é¦–å…ˆæ‹’ç»æ‰€æœ‰ç¼–ç å™¨ï¼Œç„¶åé€‰æ‹©æ€§åœ°æˆäºˆå¯ä¿¡ç¼–ç å™¨è®¿é—®æƒé™ï¼Œä»è€Œå¢å¼ºäº†å®‰å…¨æ€åŠ¿ã€‚
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## ç­–ç•¥ä¸­çš„å¤§å°å†™æ•æ„Ÿæ€§
éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒImageMagickä¸­çš„ç­–ç•¥æ¨¡å¼æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚å› æ­¤ï¼Œç¡®ä¿åœ¨ç­–ç•¥ä¸­æ­£ç¡®ä½¿ç”¨å¤§å†™å­—æ¯çš„ç¼–ç å’Œæ¨¡å—å¯¹äºé˜²æ­¢æ„å¤–æƒé™è‡³å…³é‡è¦ã€‚

## èµ„æºé™åˆ¶
å¦‚æœæœªæ­£ç¡®é…ç½®ï¼ŒImageMagickå®¹æ˜“å—åˆ°æ‹’ç»æœåŠ¡æ”»å‡»ã€‚åœ¨ç­–ç•¥ä¸­è®¾ç½®æ˜ç¡®çš„èµ„æºé™åˆ¶å¯¹äºé˜²æ­¢æ­¤ç±»æ¼æ´è‡³å…³é‡è¦ã€‚

## ç­–ç•¥ç¢ç‰‡åŒ–
ç­–ç•¥å¯èƒ½åœ¨ä¸åŒçš„ImageMagickå®‰è£…ä¸­ç¢ç‰‡åŒ–ï¼Œå¯¼è‡´æ½œåœ¨çš„å†²çªæˆ–è¦†ç›–ã€‚å»ºè®®ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®šä½å¹¶éªŒè¯æ´»åŠ¨çš„ç­–ç•¥æ–‡ä»¶ï¼š
```shell
$ find / -iname policy.xml
```
## ä¸€ä¸ªå…¥é—¨çš„é™åˆ¶æ€§æ”¿ç­–
ä¸€ä¸ªé™åˆ¶æ€§æ”¿ç­–æ¨¡æ¿å·²è¢«æå‡ºï¼Œä¸“æ³¨äºä¸¥æ ¼çš„èµ„æºé™åˆ¶å’Œè®¿é—®æ§åˆ¶ã€‚è¯¥æ¨¡æ¿ä½œä¸ºå¼€å‘ä¸ç‰¹å®šåº”ç”¨éœ€æ±‚ç›¸ä¸€è‡´çš„å®šåˆ¶æ”¿ç­–çš„åŸºç¡€ã€‚

å¯ä»¥ä½¿ç”¨ `identify -list policy` å‘½ä»¤åœ¨ ImageMagick ä¸­ç¡®è®¤å®‰å…¨æ”¿ç­–çš„æœ‰æ•ˆæ€§ã€‚æ­¤å¤–ï¼Œå‰é¢æåˆ°çš„ [evaluator tool](https://imagemagick-secevaluator.doyensec.com/) å¯ç”¨äºæ ¹æ®ä¸ªäººéœ€æ±‚ä¼˜åŒ–æ”¿ç­–ã€‚

## å‚è€ƒæ–‡çŒ®
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
