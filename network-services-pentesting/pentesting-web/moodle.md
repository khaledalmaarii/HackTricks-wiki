# Moodle

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ako vas zanima **hakerska karijera** i hakovanje nehakabilnog - **mi zapo코ljavamo!** (_potrebno je te캜no poznavanje poljskog jezika, kako pisanog tako i govornog_).

{% embed url="https://www.stmcyber.com/careers" %}

## Automatsko skeniranje

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

moodlescan je alat koji se koristi za skeniranje Moodle sistema kako bi se identifikovali ranjivosti i slabosti. Ovaj alat mo쬰 da izvr코i razli캜ite vrste skeniranja, uklju캜uju캖i skeniranje otvorenih portova, skeniranje ranjivosti i skeniranje direktorijuma. Tako캠e mo쬰 da pru쬴 informacije o verziji Moodle sistema i instaliranim dodacima.

Da biste koristili moodlescan, prvo morate da instalirate alat na svoj sistem. Zatim mo쬰te pokrenuti skeniranje tako 코to 캖ete uneti ciljnu IP adresu ili domen. Alat 캖e automatski izvr코iti skeniranje i prikazati rezultate.

Moodlescan mo쬰 da bude veoma koristan alat za pentestiranje Moodle sistema, jer vam omogu캖ava da identifikujete potencijalne ranjivosti i slabosti pre nego 코to ih iskoristi napada캜. Tako캠e mo쬰 da vam pomogne da pobolj코ate bezbednost va코eg Moodle sistema tako 코to 캖ete otkloniti identifikovane ranjivosti i primeniti preporu캜ene sigurnosne mere.
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

CMSMap je alat koji se koristi za skeniranje i identifikaciju CMS (Content Management System) platformi na ciljnom veb serveru. Ovaj alat mo쬰 da otkrije razli캜ite CMS platforme kao 코to su WordPress, Joomla, Drupal i mnoge druge. Tako캠e, pru쬬 informacije o verziji CMS-a, instaliranim dodacima i temama.

Da biste koristili CMSMap, jednostavno pokrenite slede캖u komandu:

```bash
cmsmap -u <URL>
```

Gde `<URL>` predstavlja URL ciljnog veb servera koji 쬰lite da skenirate.

CMSMap tako캠e podr쬬va opcije kao 코to su skeniranje odre캠enih direktorijuma, skeniranje samo odre캠enih CMS platformi i skeniranje sa odre캠enim korisni캜kim agentom. Za vi코e informacija o ovim opcijama, mo쬰te pogledati dokumentaciju alata.

Ovaj alat mo쬰 biti koristan za pentestere i hakere koji 쬰le da identifikuju ranjive CMS platforme i iskoriste poznate ranjivosti kako bi dobili neovla코캖en pristup ciljnom sistemu. Me캠utim, va쬹o je napomenuti da je kori코캖enje ovog alata u neovla코캖ene svrhe ilegalno i mo쬰 imati ozbiljne pravne posledice.
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVE-ovi

Uvideo sam da su automatski alati prili캜no **beskorisni u pronala쬰nju ranjivosti koje uti캜u na verziju moodle-a**. Mo쬰te **proveriti** za njih na [**https://snyk.io/vuln/composer:moodle%2Fmoodle**](https://snyk.io/vuln/composer:moodle%2Fmoodle)

## **RCE**

Potrebno je da imate ulogu **menad쬰ra** i da **mo쬰te instalirati dodatke** unutar kartice **"Upravljanje sajtom"**\*\*:\*\*

![](<../../.gitbook/assets/image (447).png>)

Ako ste menad쬰r, mo쬯a 캖ete ipak morati **aktivirati ovu opciju**. Mo쬰te videti kako to uraditi u PoC-u za eskalaciju privilegija u moodle-u: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

Zatim, mo쬰te **instalirati slede캖i dodatak** koji sadr쬴 klasi캜nu pentest-monkey php **rev shell** (_pre nego 코to ga otpremite, morate ga dekompresovati, promeniti IP i port revshella i ponovo ga kompresovati_)

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

Ili mo쬰te koristiti dodatak sa [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE) da biste dobili obi캜nu PHP ljusku sa parametrom "cmd".

Da biste pristupili zlonamernom dodatku, morate pristupiti:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### Prona캠ite podatke za pristup bazi podataka

Da biste prona코li podatke za pristup bazi podataka, mo쬰te iskoristiti POST zahtev kako biste poku코ali da izvu캜ete osetljive informacije. Ovaj metod se 캜esto koristi za pronala쬰nje korisni캜kih imena, lozinki ili drugih podataka za pristup bazi podataka.

Evo nekoliko tehnika koje mo쬰te primeniti:

1. **SQL Injection**: Ako je aplikacija podlo쬹a SQL Injection napadima, mo쬰te poku코ati da ubacite SQL kod u POST zahtev kako biste izvr코ili upit nad bazom podataka. Na taj na캜in mo쬰te dobiti pristup osetljivim informacijama, uklju캜uju캖i i podatke za pristup bazi podataka.

2. **Brute-forcing**: Mo쬰te poku코ati da izvr코ite brute-force napad na POST endpoint kako biste otkrili ispravne kombinacije korisni캜kih imena i lozinki. Ovo mo쬰 biti efikasno ako aplikacija nema za코titu od brute-force napada.

3. **Directory traversal**: Ako je aplikacija podlo쬹a directory traversal napadima, mo쬰te poku코ati da pristupite datotekama koje sadr쬰 podatke za pristup bazi podataka. Ovo mo쬰 biti mogu캖e ako aplikacija ne pravilno proverava putanju do datoteka koje se koriste za 캜uvanje podataka o bazi podataka.

4. **Session hijacking**: Ako mo쬰te izvr코iti session hijacking napad na aplikaciju, mo쬰te preuzeti sesiju nekog korisnika koji ima pristup bazi podataka. Na taj na캜in mo쬰te dobiti pristup podacima za pristup bazi podataka.

Va쬹o je napomenuti da je ova aktivnost ilegalna, osim ako je izri캜ito dozvoljena od strane vlasnika sistema. Uvek se pridr쬬vajte zakona i eti캜kih smernica prilikom izvo캠enja bilo kakvih hakera코kih aktivnosti.
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### Izvla캜enje akreditacija iz baze podataka

Da biste izvukli akreditacije iz baze podataka, mo쬰te koristiti razli캜ite tehnike, kao 코to su:

- **SQL Injection**: Ova tehnika omogu캖ava vam da izvr코ite zlonamerni SQL kod koji 캖e vam omogu캖iti pristup podacima u bazi podataka, uklju캜uju캖i i akreditacije. Mo쬰te iskoristiti ranjivosti u unosu podataka kako biste ubacili zlonamerni SQL kod i izvukli akreditacije.

- **Brute-Force napadi**: Ova tehnika uklju캜uje poku코aj razli캜itih kombinacija korisni캜kih imena i lozinki kako biste prona코li ispravne akreditacije. Mo쬰te koristiti alate za Brute-Force napade koji 캖e automatski poku코avati razli캜ite kombinacije sve dok ne prona캠u ispravne akreditacije.

- **Phishing**: Ova tehnika uklju캜uje stvaranje la쬹e stranice koja izgleda identi캜no kao prava stranica za prijavu. Kada korisnik unese svoje akreditacije na la쬹oj stranici, one se 코alju vama umesto pravoj stranici. Mo쬰te koristiti razli캜ite metode za preusmeravanje korisnika na la쬹u stranicu, kao 코to su slanje la쬹ih e-mailova ili kori코캖enje zlonamernih veza.

Va쬹o je napomenuti da je izvla캜enje akreditacija iz baze podataka nezakonito i mo쬰 imati ozbiljne pravne posledice. Ove tehnike se mogu koristiti samo u okviru zakonitog testiranja penetracije ili uz pristanak vlasnika sistema.
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ako ste zainteresovani za **hakersku karijeru** i hakovanje nehakabilnog - **mi zapo코ljavamo!** (_potrebno je te캜no poznavanje poljskog jezika, kako pisanog tako i govornog_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
