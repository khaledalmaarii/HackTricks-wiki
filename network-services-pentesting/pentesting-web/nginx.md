# Nginx

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ **Discord grubuna** katÄ±lÄ±n](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u takip edin.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

<figure><img src="../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Hemen kullanÄ±ma hazÄ±r zafiyet deÄŸerlendirme ve penetrasyon testi kurulumu**. 20'den fazla araÃ§ ve Ã¶zellikle her yerden tam bir pentest Ã§alÄ±ÅŸtÄ±rÄ±n, keÅŸiften raporlamaya kadar uzanan. Pentester'larÄ± deÄŸiÅŸtirmiyoruz - Ã¶zel araÃ§lar, tespit ve istismar modÃ¼lleri geliÅŸtiriyoruz, bÃ¶ylece daha derine inmek, kabuklarÄ± patlatmak ve eÄŸlenmek iÃ§in zaman kazanÄ±yorlar.

{% embed url="https://pentest-tools.com/" %}

## Eksik kÃ¶k konumu <a href="#missing-root-location" id="missing-root-location"></a>

## **Nginx KÃ¶k Dizini YapÄ±landÄ±rmanÄ±n Temelleri**

Nginx sunucusunu yapÄ±landÄ±rÄ±rken, **root direktifi** dosyalarÄ±n sunulduÄŸu temel dizini tanÄ±mlayarak kritik bir rol oynar. AÅŸaÄŸÄ±daki Ã¶rneÄŸi gÃ¶z Ã¶nÃ¼nde bulundurun:
```bash
server {
root /etc/nginx;

location /hello.txt {
try_files $uri $uri/ =404;
proxy_pass http://127.0.0.1:8080/;
}
}
```
Bu yapÄ±landÄ±rmada, `/etc/nginx` kÃ¶k dizini olarak belirlenmiÅŸtir. Bu kurulum, `/hello.txt` gibi belirtilen kÃ¶k dizinindeki dosyalara eriÅŸime izin verir. Ancak, yalnÄ±zca belirli bir konum (`/hello.txt`) tanÄ±mlanmÄ±ÅŸtÄ±r. KÃ¶k konum iÃ§in (`location / {...}`) herhangi bir yapÄ±landÄ±rma bulunmamaktadÄ±r. Bu ihmal, kÃ¶k yÃ¶nergesinin genel olarak uygulanmasÄ±nÄ± saÄŸlar ve `/etc/nginx` altÄ±ndaki dosyalara eriÅŸim saÄŸlar.

Bu yapÄ±landÄ±rmadan kaynaklanan kritik bir gÃ¼venlik dÃ¼ÅŸÃ¼ncesi ortaya Ã§Ä±kar. Basit bir `GET` isteÄŸi, Ã¶rneÄŸin `GET /nginx.conf`, `/etc/nginx/nginx.conf` konumundaki Nginx yapÄ±landÄ±rma dosyasÄ±nÄ± sunarak hassas bilgilerin ifÅŸa edilmesine neden olabilir. KÃ¶kÃ¼ daha az hassas bir dizine, Ã¶rneÄŸin `/etc` olarak ayarlamak, bu riski azaltabilir, ancak yine de diÄŸer hassas dosyalara, diÄŸer yapÄ±landÄ±rma dosyalarÄ±na, eriÅŸim gÃ¼nlÃ¼klerine ve hatta HTTP temel kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±lan ÅŸifrelenmiÅŸ kimlik bilgilerine istenmeyen eriÅŸime izin verebilir.

## Alias LFI Yan YapÄ±landÄ±rmasÄ± <a href="#alias-lfi-misconfiguration" id="alias-lfi-misconfiguration"></a>

Nginx'in yapÄ±landÄ±rma dosyalarÄ±nda, "location" yÃ¶nergeleri iÃ§in dikkatli bir inceleme gereklidir. Bir Local File Inclusion (LFI) olarak bilinen bir zafiyet, aÅŸaÄŸÄ±dakine benzer bir yapÄ±landÄ±rma ile yanlÄ±ÅŸlÄ±kla tanÄ±tÄ±labilir:
```
location /imgs {
alias /path/images/;
}
```
Bu yapÄ±landÄ±rma, sunucunun `/imgs../flag.txt` gibi istekleri yorumlayarak, dosyalarÄ±n amaÃ§lanan dizinin dÄ±ÅŸÄ±ndaki dosyalara eriÅŸme giriÅŸimi olarak algÄ±lanmasÄ±na neden olabilecek LFI saldÄ±rÄ±larÄ±na duyarlÄ±dÄ±r ve etkili bir ÅŸekilde `/path/images/../flag.txt`'ye Ã§Ã¶zÃ¼lÃ¼r. Bu zayÄ±flÄ±k, saldÄ±rganlarÄ±n sunucunun dosya sisteminden web aracÄ±lÄ±ÄŸÄ±yla eriÅŸilememesi gereken dosyalarÄ± almasÄ±na olanak tanÄ±r.

Bu zafiyeti hafifletmek iÃ§in yapÄ±landÄ±rma ÅŸu ÅŸekilde ayarlanmalÄ±dÄ±r:
```
location /imgs/ {
alias /path/images/;
}
```
Daha fazla bilgi: [https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/](https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/)

Accunetix testleri:
```
alias../ => HTTP status code 403
alias.../ => HTTP status code 404
alias../../ => HTTP status code 403
alias../../../../../../../../../../../ => HTTP status code 400
alias../ => HTTP status code 403
```
## GÃ¼vensiz yol kÄ±sÄ±tlamasÄ± <a href="#unsafe-variable-use" id="unsafe-variable-use"></a>

AÅŸaÄŸÄ±daki sayfayÄ± kontrol edin:
```plaintext
location = /admin {
deny all;
}

location = /admin/ {
deny all;
}
```
## GÃ¼vensiz deÄŸiÅŸken kullanÄ±mÄ± / HTTP Ä°steÄŸi BÃ¶lme <a href="#unsafe-variable-use" id="unsafe-variable-use"></a>

{% hint style="danger" %}
`$uri` ve `$document_uri` gibi gÃ¼venlik aÃ§Ä±klÄ± deÄŸiÅŸkenler bulunmaktadÄ±r ve bunlar `$request_uri` ile deÄŸiÅŸtirilerek dÃ¼zeltilebilir.

AyrÄ±ca regex de ÅŸu ÅŸekilde gÃ¼venlik aÃ§Ä±klÄ± olabilir:

`location ~ /docs/([^/])? { â€¦ $1 â€¦ }` - GÃ¼venlik aÃ§Ä±klÄ±&#x20;

`location ~ /docs/([^/\s])? { â€¦ $1 â€¦ }` - GÃ¼venlik aÃ§Ä±klÄ± deÄŸil (boÅŸluklarÄ± kontrol eder)

`location ~ /docs/(.*)? { â€¦ $1 â€¦ }`  - GÃ¼venlik aÃ§Ä±klÄ± deÄŸil
{% endhint %}

Nginx yapÄ±landÄ±rmasÄ±ndaki bir gÃ¼venlik aÃ§Ä±ÄŸÄ± aÅŸaÄŸÄ±daki Ã¶rnekle gÃ¶sterilmektedir:
```
location / {
return 302 https://example.com$uri;
}
```
HTTP isteklerinde \r (TaÅŸÄ±ma Ä°ÅŸareti) ve \n (SatÄ±r Beslemesi) karakterleri yeni satÄ±r karakterlerini belirtir ve URL kodlanmÄ±ÅŸ formlarÄ± `%0d%0a` olarak temsil edilir. Bu karakterleri bir istekte (Ã¶rneÄŸin, `http://localhost/%0d%0aDetectify:%20clrf`) iÃ§erdiÄŸinde yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ bir sunucunun yeni bir baÅŸlÄ±k olan `Detectify` Ã§Ä±karmasÄ± sonucu oluÅŸur. Bu durum, $uri deÄŸiÅŸkeninin URL kodlanmÄ±ÅŸ yeni satÄ±r karakterlerini Ã§Ã¶zmesi nedeniyle yanÄ±tta beklenmeyen bir baÅŸlÄ±k oluÅŸturur:
```
HTTP/1.1 302 Moved Temporarily
Server: nginx/1.19.3
Content-Type: text/html
Content-Length: 145
Connection: keep-alive
Location: https://example.com/
Detectify: clrf
```
Risks of CRLF injection and response splitting iÃ§in [buraya](https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/) bakabilirsiniz.

Bu teknik [**bu sunumda**](https://www.youtube.com/watch?v=gWQyWdZbdoY\&list=PL0xCSYnG\_iTtJe2V6PQqamBF73n7-f1Nr\&index=77) bazÄ± zayÄ±f Ã¶rnekler ve tespit mekanizmalarÄ± ile aÃ§Ä±klanmÄ±ÅŸtÄ±r. Ã–rneÄŸin, Bu yanlÄ±ÅŸ yapÄ±landÄ±rmayÄ± siyah kutu bakÄ±ÅŸ aÃ§Ä±sÄ±ndan tespit etmek iÃ§in ÅŸu istekleri yapabilirsiniz:

* `https://example.com/%20X` - Herhangi bir HTTP kodu
* `https://example.com/%20H` - 400 Bad Request

EÄŸer zayÄ±fsa, ilk istek "X" herhangi bir HTTP yÃ¶ntemi olarak dÃ¶necek ve ikinci istek H geÃ§erli bir yÃ¶ntem olmadÄ±ÄŸÄ± iÃ§in bir hata dÃ¶necektir. Bu nedenle sunucu ÅŸuna benzer bir ÅŸey alacak: `GET / H HTTP/1.1` ve bu hata oluÅŸturacaktÄ±r.

DiÄŸer tespit Ã¶rnekleri ÅŸunlar olabilir:

* `http://company.tld/%20HTTP/1.1%0D%0AXXXX:%20x` - Herhangi bir HTTP kodu
* `http://company.tld/%20HTTP/1.1%0D%0AHost:%20x` - 400 Bad Request

Bu sunumda bulunan bazÄ± zayÄ±f yapÄ±landÄ±rmalar ÅŸunlardÄ±r:

* **`$uri`**'nin URL'de olduÄŸu gibi ayarlandÄ±ÄŸÄ±na dikkat edin.
```
location ^~ /lite/api/ {
proxy_pass http://lite-backend$uri$is_args$args;
}
```
* Yine **`$uri`** URL'de (bu sefer bir parametrenin iÃ§inde) bulunmaktadÄ±r.
```
location ~ ^/dna/payment {
rewrite ^/dna/([^/]+) /registered/main.pl?cmd=unifiedPayment&context=$1&native_uri=$uri break;
proxy_pass http://$back;
```
* Åimdi AWS S3'te
```
location /s3/ {
proxy_pass https://company-bucket.s3.amazonaws.com$uri;
}
```
### Herhangi bir deÄŸiÅŸken

Belirli durumlarda, **kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan verilerin** belirli koÅŸullar altÄ±nda bir **Nginx deÄŸiÅŸkeni** olarak iÅŸleme tabi tutulabileceÄŸi keÅŸfedildi. Bu davranÄ±ÅŸÄ±n nedeni oldukÃ§a belirsiz olsa da, nadir deÄŸil ve doÄŸrulamasÄ± da kolay deÄŸil. Bu anormallik, HackerOne'da bir gÃ¼venlik raporunda vurgulandÄ± ve [buradan](https://hackerone.com/reports/370094) gÃ¶rÃ¼lebilir. Hata mesajÄ±na yÃ¶nelik daha fazla inceleme, bunun Nginx'in kod tabanÄ±ndaki [SSI filtre modÃ¼lÃ¼nde](https://github.com/nginx/nginx/blob/2187586207e1465d289ae64cedc829719a048a39/src/http/modules/ngx\_http\_ssi\_filter\_module.c#L365) meydana geldiÄŸinin belirlenmesine yol aÃ§tÄ±, Server Side Includes (SSI)nin temel nedeni olarak belirlendi.

Bu yanlÄ±ÅŸ yapÄ±landÄ±rmayÄ± **tespit etmek** iÃ§in aÅŸaÄŸÄ±daki komut Ã§alÄ±ÅŸtÄ±rÄ±labilir, bu komut, bir referer baÅŸlÄ±ÄŸÄ±nÄ± ayarlayarak deÄŸiÅŸken yazdÄ±rma testi yapmayÄ± iÃ§erir:
```bash
$ curl -H â€˜Referer: barâ€™ http://localhost/foo$http_referer | grep â€˜foobarâ€™
```
Sistemler Ã¼zerinde yapÄ±lan taramalar, bir kullanÄ±cÄ± tarafÄ±ndan Nginx deÄŸiÅŸkenlerinin yazdÄ±rÄ±labileceÄŸi birden fazla Ã¶rneÄŸi ortaya Ã§Ä±kardÄ±. Ancak, savunmasÄ±z Ã¶rneklerin sayÄ±sÄ±ndaki azalma, bu sorunu dÃ¼zeltme Ã§abalarÄ±nÄ±n bir dereceye kadar baÅŸarÄ±lÄ± olduÄŸunu gÃ¶stermektedir.

## Ham arka uÃ§ yanÄ±tÄ± okuma

Nginx, `proxy_pass` aracÄ±lÄ±ÄŸÄ±yla sunucu hatalarÄ±nÄ± ve HTTP baÅŸlÄ±klarÄ±nÄ± yakalamayÄ± saÄŸlayan bir Ã¶zellik sunar, bu da iÃ§ hata mesajlarÄ±nÄ± ve baÅŸlÄ±klarÄ±nÄ± gizlemeyi amaÃ§lar. Bu, Nginx'in, arka uÃ§ hatalarÄ±na yanÄ±t olarak Ã¶zel hata sayfalarÄ± sunarak baÅŸarÄ±lÄ± bir ÅŸekilde gerÃ§ekleÅŸtirilir. Ancak, Nginx'in geÃ§ersiz bir HTTP isteÄŸiyle karÅŸÄ±laÅŸtÄ±ÄŸÄ±nda zorluklar ortaya Ã§Ä±kar. BÃ¶yle bir istek, alÄ±ndÄ±ÄŸÄ± gibi arka uca iletilir ve ardÄ±ndan arka uÃ§un ham yanÄ±tÄ± doÄŸrudan Nginx'in mÃ¼dahalesi olmadan istemciye gÃ¶nderilir. 

Bir uWSGI uygulamasÄ±nÄ± iÃ§eren bir Ã¶rnek senaryoyu dÃ¼ÅŸÃ¼nÃ¼n:
```python
def application(environ, start_response):
start_response('500 Error', [('Content-Type', 'text/html'), ('Secret-Header', 'secret-info')])
return [b"Secret info, should not be visible!"]
```
Bu yÃ¶netmek iÃ§in, Nginx yapÄ±landÄ±rmasÄ±nda belirli direktifler kullanÄ±lÄ±r:
```
http {
error_page 500 /html/error.html;
proxy_intercept_errors on;
proxy_hide_header Secret-Header;
}
```
* [**proxy\_intercept\_errors**](http://nginx.org/en/docs/http/ngx\_http\_proxy\_module.html#proxy\_intercept\_errors): Bu yÃ¶nerge, Nginx'in durum kodu 300'den bÃ¼yÃ¼k olan arka uÃ§ yanÄ±tlarÄ± iÃ§in Ã¶zel bir yanÄ±t sunmasÄ±nÄ± saÄŸlar. Ã–rneÄŸimizde uWSGI uygulamasÄ± iÃ§in, bir `500 Hata` yanÄ±tÄ±nÄ±n Nginx tarafÄ±ndan engellenip iÅŸlenmesini saÄŸlar.
* [**proxy\_hide\_header**](http://nginx.org/en/docs/http/ngx\_http\_proxy\_module.html#proxy\_hide\_header): AdÄ±ndan da anlaÅŸÄ±lacaÄŸÄ± gibi, bu yÃ¶nerge belirli HTTP baÅŸlÄ±klarÄ±nÄ± istemciden gizler, gizliliÄŸi ve gÃ¼venliÄŸi artÄ±rÄ±r.

GeÃ§erli bir `GET` isteÄŸi yapÄ±ldÄ±ÄŸÄ±nda, Nginx bunu normal ÅŸekilde iÅŸler, herhangi gizli baÅŸlÄ±klarÄ± aÃ§Ä±ÄŸa Ã§Ä±karmadan standart bir hata yanÄ±tÄ± dÃ¶ndÃ¼rÃ¼r. Ancak geÃ§ersiz bir HTTP isteÄŸi, bu mekanizmayÄ± atlar ve ham arka uÃ§ yanÄ±tlarÄ±nÄ±, gizli baÅŸlÄ±klarÄ± ve hata mesajlarÄ±nÄ± da iÃ§erecek ÅŸekilde ortaya Ã§Ä±karÄ±r.

## merge\_slashes off olarak ayarlandÄ±

VarsayÄ±lan olarak, Nginx'in **`merge_slashes` yÃ¶nergesi** **`on`** olarak ayarlanmÄ±ÅŸtÄ±r, bu da bir URL'deki birden fazla ileri eÄŸik Ã§izgiyi tek bir Ã§izgiye sÄ±kÄ±ÅŸtÄ±rÄ±r. Bu Ã¶zellik, URL iÅŸleme sÃ¼recini basitleÅŸtirirken, Nginx'in arkasÄ±ndaki uygulamalardaki zafiyetleri yanlÄ±ÅŸlÄ±kla gizleyebilir, Ã¶zellikle de yerel dosya dahil etme (LFI) saldÄ±rÄ±larÄ±na duyarlÄ± olanlar. GÃ¼venlik uzmanlarÄ± **Danny Robinson ve Rotem Bar**, Ã¶zellikle Nginx'in ters proxy olarak hareket ettiÄŸinde, bu varsayÄ±lan davranÄ±ÅŸla iliÅŸkili potansiyel riskleri vurgulamÄ±ÅŸlardÄ±r.

Bu tÃ¼r riskleri azaltmak iÃ§in, bu zafiyetlere duyarlÄ± uygulamalar iÃ§in **`merge_slashes` yÃ¶nergesini kapatmanÄ±z** Ã¶nerilir. Bu, Nginx'in URL yapÄ±sÄ±nÄ± deÄŸiÅŸtirmeden istekleri uygulamaya ilettiÄŸinden, altta yatan gÃ¼venlik sorunlarÄ±nÄ± gizlemez.

Daha fazla bilgi iÃ§in [Danny Robinson ve Rotem Bar](https://medium.com/appsflyer/nginx-may-be-protecting-your-applications-from-traversal-attacks-without-you-even-knowing-b08f882fd43d).

### **Map YÃ¶nergesindeki VarsayÄ±lan DeÄŸer**

**Nginx yapÄ±landÄ±rmasÄ±nda**, `map` yÃ¶nergesi genellikle **yetkilendirme kontrolÃ¼nde** rol oynar. YaygÄ±n bir hata, **varsayÄ±lan** bir deÄŸer belirtmemektir, bu da yetkisiz eriÅŸime yol aÃ§abilir. Ã–rneÄŸin:
```yaml
http {
map $uri $mappocallow {
/map-poc/private 0;
/map-poc/secret 0;
/map-poc/public 1;
}
}
```

```yaml
server {
location /map-poc {
if ($mappocallow = 0) {return 403;}
return 200 "Hello. It is private area: $mappocallow";
}
}
```
`default` olmadan, bir **kÃ¶tÃ¼ niyetli kullanÄ±cÄ±**, `/map-poc` iÃ§inde tanÄ±msÄ±z bir URI'ye eriÅŸerek gÃ¼venlik Ã¶nlemlerini atlayabilir. [Nginx kÄ±lavuzu](https://nginx.org/en/docs/http/ngx_http_map_module.html), bu tÃ¼r sorunlarÄ± Ã¶nlemek iÃ§in bir **varsayÄ±lan deÄŸer** belirlemenizi Ã¶nerir.

### **DNS Sahtecilik AÃ§Ä±ÄŸÄ±**

Belirli koÅŸullar altÄ±nda Nginx'e karÅŸÄ± DNS sahteciliÄŸi mÃ¼mkÃ¼ndÃ¼r. Bir saldÄ±rgan, Nginx'in kullandÄ±ÄŸÄ± **DNS sunucusunu** bildiÄŸinde ve DNS sorgularÄ±nÄ± onaylayabildiÄŸinde DNS kayÄ±tlarÄ±nÄ± sahtecilik yapabilir. Ancak bu yÃ¶ntem, Nginx'in DNS Ã§Ã¶zÃ¼mlemesi iÃ§in **localhost (127.0.0.1)**'i kullanacak ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸsa etkisizdir. Nginx, bir DNS sunucusunu aÅŸaÄŸÄ±daki gibi belirtmeye izin verir:
```yaml
resolver 8.8.8.8;
```
### **`proxy_pass` ve `internal` KomutlarÄ±**

**`proxy_pass`** komutu, istekleri baÅŸka sunuculara yÃ¶nlendirmek iÃ§in kullanÄ±lÄ±r, ya iÃ§sel ya da harici olarak. **`internal`** komutu ise belirli konumlara sadece Nginx iÃ§inden eriÅŸilebilir olduÄŸunu saÄŸlar. Bu komutlar baÅŸlÄ± baÅŸÄ±na gÃ¼venlik aÃ§Ä±klarÄ± deÄŸildir, ancak yapÄ±landÄ±rmalarÄ± gÃ¼venlik aÃ§Ä±klarÄ±nÄ± Ã¶nlemek iÃ§in dikkatli bir ÅŸekilde incelenmelidir.

## proxy\_set\_header Upgrade & Connection

EÄŸer nginx sunucusu Upgrade ve Connection baÅŸlÄ±klarÄ±nÄ± geÃ§mek iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸsa, bir [**h2c Smuggling saldÄ±rÄ±sÄ±**](../../pentesting-web/h2c-smuggling.md) gerÃ§ekleÅŸtirilebilir ve korumalÄ±/iÃ§sel uÃ§ noktalara eriÅŸilebilir.

{% hint style="danger" %}
Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, bir saldÄ±rganÄ±n **`proxy_pass` uÃ§ noktasÄ±yla doÄŸrudan bir baÄŸlantÄ± kurmasÄ±na** izin verecektir (`http://backend:9999` bu durumda) ve bu iÃ§erik Nginx tarafÄ±ndan kontrol edilmeyecektir.
{% endhint %}

Ã–rnek olarak, [buradan](https://bishopfox.com/blog/h2c-smuggling-request) `/flag`'i Ã§almak iÃ§in savunmasÄ±z yapÄ±landÄ±rma:
```
server {
listen       443 ssl;
server_name  localhost;

ssl_certificate       /usr/local/nginx/conf/cert.pem;
ssl_certificate_key   /usr/local/nginx/conf/privkey.pem;

location / {
proxy_pass http://backend:9999;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection $http_connection;
}

location /flag {
deny all;
}
```
{% hint style="warning" %}
`proxy_pass`'in belirli bir **yol** a gÃ¶sterdiÄŸi durumda bile, baÄŸlantÄ± `http://backend:9999` ile kurulacaktÄ±r, bu nedenle **iÃ§sel uÃ§ noktadaki herhangi baÅŸka bir yola ulaÅŸabilirsiniz. Bu nedenle, proxy_pass URL'sinde bir yol belirtilmiÅŸ olup olmadÄ±ÄŸÄ± Ã¶nemli deÄŸildir.**
{% endhint %}

## Kendiniz Deneyin

Detectify, bu makalede tartÄ±ÅŸÄ±lan bazÄ± yanlÄ±ÅŸ yapÄ±landÄ±rmalarla kendi zayÄ±f Nginx test sunucusunu kurmanÄ±zÄ± ve bunlarÄ± kendiniz bulmanÄ±zÄ± deneyebileceÄŸiniz bir GitHub deposu oluÅŸturdu!

[https://github.com/detectify/vulnerable-nginx](https://github.com/detectify/vulnerable-nginx)

## Statik Analiz AraÃ§larÄ±

### [GIXY](https://github.com/yandex/gixy)

Gixy, Nginx yapÄ±landÄ±rmasÄ±nÄ± analiz etmek iÃ§in bir araÃ§tÄ±r. Gixy'nin ana amacÄ± gÃ¼venlik yanlÄ± yapÄ±landÄ±rmalarÄ±nÄ± Ã¶nlemek ve hata tespitini otomatikleÅŸtirmektir.

### [Nginxpwner](https://github.com/stark0de/nginxpwner)

Nginxpwner, yaygÄ±n Nginx yanlÄ± yapÄ±landÄ±rmalarÄ±nÄ± ve gÃ¼venlik aÃ§Ä±klarÄ±nÄ± aramak iÃ§in basit bir araÃ§tÄ±r.

## Referanslar

* [**https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/**](https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/)
* [**http://blog.zorinaq.com/nginx-resolver-vulns/**](http://blog.zorinaq.com/nginx-resolver-vulns/)
* [**https://github.com/yandex/gixy/issues/115**](https://github.com/yandex/gixy/issues/115)

<figure><img src="../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Hemen kullanÄ±labilir zayÄ±flÄ±k deÄŸerlendirme ve penetrasyon testi kurulumu**. KeÅŸiften raporlamaya kadar 20'den fazla araÃ§ ve Ã¶zellikle tam bir pentest Ã§alÄ±ÅŸtÄ±rÄ±n. Pentester'larÄ± deÄŸiÅŸtirmiyoruz - onlara daha derinlemesine kazma, kabuklarÄ± patlatma ve eÄŸlenme zamanÄ± vermek iÃ§in Ã¶zel araÃ§lar, tespit ve istismar modÃ¼lleri geliÅŸtiriyoruz.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR'lar gÃ¶ndererek paylaÅŸÄ±n.

</details>
