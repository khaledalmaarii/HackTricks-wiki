{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**–í–∞–∂–ª–∏–≤–∞ –ø—Ä–∏–º—ñ—Ç–∫–∞:**

![image](https://user-images.githubusercontent.com/84577967/174675487-a4c4ca06-194f-4725-85af-231a2f35d56c.png)

**`dl`** ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è PHP, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω—å PHP. –Ø–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ –≤–∏–º–∫–Ω–µ–Ω–∞, —ó—ó –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–ª—è **–æ–±—Ö–æ–¥—É `disable_functions` —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∫–æ–º–∞–Ω–¥**.\
–û–¥–Ω–∞–∫, –≤–æ–Ω–∞ –º–∞—î –¥–µ—è–∫—ñ —Å—É–≤–æ—Ä—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è:

* –§—É–Ω–∫—Ü—ñ—è `dl` –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ **–ø—Ä–∏—Å—É—Ç–Ω—è** –≤ **—Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ** —ñ **–Ω–µ –≤–∏–º–∫–Ω–µ–Ω–∞**
* –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP **–ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–µ –∑ —Ç—ñ—î—é –∂ –æ—Å–Ω–æ–≤–Ω–æ—é –≤–µ—Ä—Å—ñ—î—é** (–≤–µ—Ä—Å—ñ—è API PHP), —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ—Ä–≤–µ—Ä (—Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö phpinfo)
* –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ **—Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–µ –≤ –∫–∞—Ç–∞–ª–æ–∑—ñ**, —è–∫–∏–π **–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π** –¥–∏—Ä–µ–∫—Ç–∏–≤–æ—é **`extension_dir`** (—Ü–µ –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö phpinfo). –î—É–∂–µ –º–∞–ª–æ–π–º–æ–≤—ñ—Ä–Ω–æ, —â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫, —è–∫–∏–π –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä–æ–º, –º–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å –¥–æ —Ü—å–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É, —Ç–æ–º—É —Ü—è –≤–∏–º–æ–≥–∞, –π–º–æ–≤—ñ—Ä–Ω–æ, –∑–∞–≤–∞–¥–∏—Ç—å –≤–∞–º –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é —Ç–µ—Ö–Ω—ñ–∫–æ—é).

**–Ø–∫—â–æ –≤–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î—Ç–µ —Ü–∏–º –≤–∏–º–æ–≥–∞–º, –ø—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —á–∏—Ç–∞—Ç–∏ –ø–æ—Å—Ç** [**https://antichat.com/threads/70763/**](https://antichat.com/threads/70763/) **—â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –æ–±—ñ–π—Ç–∏ disable\_functions**. –û—Å—å –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∏–∫–ª–∞–¥:

–§—É–Ω–∫—Ü—ñ—è [dl](http://www.php.net/manual/en/function.dl.php) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω—å PHP –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞. –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP, –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–ø–∏—Å–∞–Ω—ñ –Ω–∞ C/C++, —Ä–æ–∑—à–∏—Ä—é—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å PHP. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫, –ø–æ–º—ñ—Ç–∏–≤—à–∏, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è `dl` –Ω–µ –≤–∏–º–∫–Ω–µ–Ω–∞, –≤–∏—Ä—ñ—à—É—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤–ª–∞—Å–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥.

### –ö—Ä–æ–∫–∏, —è–∫—ñ –≤–∂–∏–≤–∞—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫:

1. **–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó PHP:**
- –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∑–Ω–∞—á–∞—î –≤–µ—Ä—Å—ñ—é PHP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞ (`<?php echo 'PHP Version is '.PHP_VERSION; ?>`).

2. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏—Ö–æ–¥—É PHP:**
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤–∏—Ö—ñ–¥ PHP –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ [–≤–µ–±—Å–∞–π—Ç—É PHP](http://www.php.net/downloads.php) –∞–±–æ –∑ [–∞—Ä—Ö—ñ–≤—É](http://museum.php.net), —è–∫—â–æ –≤–µ—Ä—Å—ñ—è —Å—Ç–∞—Ä—ñ—à–∞.

3. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ PHP:**
- –†–æ–∑–ø–∞–∫–æ–≤—É—î —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –≤–µ—Ä—Å—ñ—é PHP –Ω–∞ —Å–≤–æ—î–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ.

4. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:**
- –í–∏–≤—á–∞—î [—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω—å PHP](http://www.php.net/manual/en/zend.creating.php) —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ PHP.
- –ó–æ—Å–µ—Ä–µ–¥–∂—É—î—Ç—å—Å—è –Ω–∞ –¥—É–±–ª—é–≤–∞–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ —Ñ—É–Ω–∫—Ü—ñ—ó [exec](http://www.php.net/manual/en/function.exec.php), —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–æ—ó –≤ `ext/standard/exec.c`.

### –ü—Ä–∏–º—ñ—Ç–∫–∏ –¥–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:

1. **ZEND_MODULE_API_NO:**
- `ZEND_MODULE_API_NO` —É `bypass.c` –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—ñ–π –∑–±—ñ—Ä—Ü—ñ Zend Extension, —è–∫—É –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
php -i | grep "Zend Extension Build" |awk -F"API4" '{print $2}' | awk -F"," '{print $1}'
```

2. **–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è PHP_FUNCTION:**
- –î–ª—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –≤–µ—Ä—Å—ñ–π PHP (5, 7, 8) –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –∫–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è `PHP_FUNCTION(bypass_exec)`. –ù–∞–≤–µ–¥–µ–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—î —Ü—é –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—é.

### –§–∞–π–ª–∏ –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:

- **bypass.c**:
- –†–µ–∞–ª—ñ–∑—É—î –æ—Å–Ω–æ–≤–Ω—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
- **php_bypass.h**:
- –ó–∞–≥–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª, —â–æ –≤–∏–∑–Ω–∞—á–∞—î –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
- **config.m4**:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `phpize` –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –∑–±—ñ—Ä–∫–∏ –¥–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### –ó–±—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:

1. **–ö–æ–º–∞–Ω–¥–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `phpize`, `./configure` —Ç–∞ `make` –¥–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
- –†–µ–∑—É–ª—å—Ç—É—é—á–∏–π `bypass.so` –ø–æ—Ç—ñ–º —Ä–æ–∑—Ç–∞—à–æ–≤—É—î—Ç—å—Å—è –≤ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–∑—ñ –º–æ–¥—É–ª—ñ–≤.

2. **–û—á–∏—â–µ–Ω–Ω—è:**
- –í–∏–∫–æ–Ω—É—î `make clean` —Ç–∞ `phpize --clean` –ø—ñ—Å–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó.

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ —Ö–æ—Å—Ç—ñ –∂–µ—Ä—Ç–≤–∏:

1. **–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –≤–µ—Ä—Å—ñ–π:**
- –ü–µ—Ä–µ–∫–æ–Ω—É—î—Ç—å—Å—è, —â–æ –≤–µ—Ä—Å—ñ—ó API PHP –∑–±—ñ–≥–∞—é—Ç—å—Å—è –º—ñ–∂ —Å–∏—Å—Ç–µ–º–∞–º–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ —Ç–∞ –∂–µ—Ä—Ç–≤–∏.

2. **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—é `dl`, –æ–±—Ö–æ–¥—è—á–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—ñ–¥–Ω–æ—Å–Ω—ñ —à–ª—è—Ö–∏ –∞–±–æ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—É.

3. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞:**
- –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î `bypass.so` —Ç–∞ PHP-—Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∂–µ—Ä—Ç–≤–∏.
- –°–∫—Ä–∏–ø—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—é `dl_local` –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è `bypass.so`, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î `bypass_exec` –∑ –∫–æ–º–∞–Ω–¥–æ—é, –ø–µ—Ä–µ–¥–∞–Ω–æ—é —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–ø–∏—Ç—É `cmd`.

### –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥:

- –¢–µ–ø–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏, –∑–≤–µ—Ä—Ç–∞—é—á–∏—Å—å –¥–æ: `http://www.example.com/script.php?cmd=<command>`


–¶–µ–π –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –≤–∏–∫–ª–∞–¥–∞—î –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è PHP –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥, –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ—é `dl`, —è–∫–∞, –≤ —ñ–¥–µ–∞–ª—ñ, –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–∞, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ç–∞–∫–∏–º –ø–æ—Ä—É—à–µ–Ω–Ω—è–º –±–µ–∑–ø–µ–∫–∏.


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
