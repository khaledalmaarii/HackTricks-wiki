<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

**Ã–nemli not:**

![image](https://user-images.githubusercontent.com/84577967/174675487-a4c4ca06-194f-4725-85af-231a2f35d56c.png)

**`dl`** PHP uzantÄ±larÄ±nÄ± yÃ¼klemek iÃ§in kullanÄ±lan bir PHP iÅŸlevdir. Ä°ÅŸlev devre dÄ±ÅŸÄ± bÄ±rakÄ±lmamÄ±ÅŸsa, **`disable_functions`'Ä± atlamak ve keyfi komutlar Ã§alÄ±ÅŸtÄ±rmak** iÃ§in kÃ¶tÃ¼ye kullanÄ±labilir.\
Ancak, bazÄ± katÄ± sÄ±nÄ±rlamalarÄ± vardÄ±r:

* `dl` iÅŸlevi **Ã§evrede mevcut** ve **devre dÄ±ÅŸÄ± bÄ±rakÄ±lmamÄ±ÅŸ** olmalÄ±dÄ±r.
* PHP uzantÄ±sÄ±, sunucunun kullandÄ±ÄŸÄ± **aynÄ± ana sÃ¼rÃ¼mle** (PHP API sÃ¼rÃ¼mÃ¼) derlenmiÅŸ olmalÄ±dÄ±r (bu bilgiyi phpinfo Ã§Ä±ktÄ±sÄ±nda gÃ¶rebilirsiniz).
* PHP uzantÄ±sÄ±, **`extension_dir`** yÃ¶nergesi tarafÄ±ndan **tanÄ±mlanan dizinde** bulunmalÄ±dÄ±r (bu bilgiyi phpinfo Ã§Ä±ktÄ±sÄ±nda gÃ¶rebilirsiniz). Sunucuyu kÃ¶tÃ¼ye kullanmaya Ã§alÄ±ÅŸan bir saldÄ±rganÄ±n bu dizine yazma eriÅŸimi olmasÄ± Ã§ok olasÄ± olmadÄ±ÄŸÄ±ndan, bu gereklilik muhtemelen bu teknikten yararlanmanÄ±zÄ± engelleyecektir.

**Bu gereksinimleri karÅŸÄ±lÄ±yorsanÄ±z, disable\_functions'Ä± atlamayÄ± Ã¶ÄŸrenmek iÃ§in** [**https://antichat.com/threads/70763/**](https://antichat.com/threads/70763/) **baÄŸlantÄ±sÄ±ndaki gÃ¶nderiyi okumaya devam edin**. Ä°ÅŸte bir Ã¶zet:

[dl iÅŸlevi](http://www.php.net/manual/en/function.dl.php), betik yÃ¼rÃ¼tme sÄ±rasÄ±nda PHP uzantÄ±larÄ±nÄ± dinamik olarak yÃ¼klemek iÃ§in kullanÄ±lÄ±r. C/C++ ile genellikle yazÄ±lan PHP uzantÄ±larÄ±, PHP'nin iÅŸlevselliÄŸini geliÅŸtirir. SaldÄ±rgan, `dl` iÅŸlevinin devre dÄ±ÅŸÄ± bÄ±rakÄ±lmadÄ±ÄŸÄ±nÄ± fark ettikten sonra, sistem komutlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶zel bir PHP uzantÄ±sÄ± oluÅŸturmaya karar verir.

### SaldÄ±rgan TarafÄ±ndan Ä°zlenen AdÄ±mlar:

1. **PHP SÃ¼rÃ¼mÃ¼nÃ¼n Belirlenmesi:**
- SaldÄ±rgan, bir betik (`<?php echo 'PHP SÃ¼rÃ¼mÃ¼: '.PHP_VERSION; ?>`) kullanarak PHP sÃ¼rÃ¼mÃ¼nÃ¼ belirler.

2. **PHP Kaynak Kodunun Edinilmesi:**
- PHP kaynak kodunu resmi [PHP web sitesinden](http://www.php.net/downloads.php) veya [arÅŸivden](http://museum.php.net) (eÄŸer sÃ¼rÃ¼m eskiyse) indirir.

3. **Yerel PHP Kurulumu:**
- Belirli PHP sÃ¼rÃ¼mÃ¼nÃ¼ kendi sistemine Ã§Ä±karÄ±r ve kurar.

4. **UzantÄ± OluÅŸturma:**
- [PHP uzantÄ±larÄ± oluÅŸturma](http://www.php.net/manual/en/zend.creating.php) konusunu inceler ve PHP kaynak kodunu inceler.
- `ext/standard/exec.c` konumunda bulunan [exec iÅŸlevinin](http://www.php.net/manual/en/function.exec.php) iÅŸlevselliÄŸini Ã§oÄŸaltmaya odaklanÄ±r.

### Ã–zel UzantÄ±yÄ± Derleme NotlarÄ±:

1. **ZEND_MODULE_API_NO:**
- `bypass.c` iÃ§indeki `ZEND_MODULE_API_NO`, mevcut Zend Extension Build ile eÅŸleÅŸmelidir. Bu bilgiyi aÅŸaÄŸÄ±daki komutla alabilirsiniz:
```bash
php -i | grep "Zend Extension Build" |awk -F"API4" '{print $2}' | awk -F"," '{print $1}'
```

2. **PHP_FUNCTION DÃ¼zenlemesi:**
- Son PHP sÃ¼rÃ¼mleri (5, 7, 8) iÃ§in `PHP_FUNCTION(bypass_exec)` dÃ¼zenlemesi gerekebilir. SaÄŸlanan kod parÃ§acÄ±ÄŸÄ± bu dÃ¼zenlemeyi detaylandÄ±rÄ±r.

### Ã–zel UzantÄ± DosyalarÄ±:

- **bypass.c**:
- Ã–zel uzantÄ±nÄ±n temel iÅŸlevselliÄŸini uygular.
- **php_bypass.h**:
- UzantÄ± Ã¶zelliklerini tanÄ±mlayan baÅŸlÄ±k dosyasÄ±.
- **config.m4**:
- Ã–zel uzantÄ± iÃ§in yapÄ±landÄ±rmayÄ± `phpize` kullanarak yapÄ±landÄ±rmak iÃ§in kullanÄ±lÄ±r.

### UzantÄ±nÄ±n Derlenmesi:

1. **Derleme KomutlarÄ±:**
- UzantÄ±nÄ±n derlenmesi iÃ§in `phpize`, `./configure` ve `make` kullanÄ±lÄ±r.
- SonuÃ§ olarak oluÅŸan `bypass.so` dosyasÄ±, modÃ¼ller alt dizininde bulunur.

2. **Temizlik:**
- Derleme iÅŸleminden sonra `make clean` ve `phpize --clean` Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.

### Kurban Sunucuda YÃ¼klenmesi ve YÃ¼rÃ¼tÃ¼lmesi:

1. **SÃ¼rÃ¼m UyumluluÄŸu:**
- SaldÄ±rganÄ±n ve kurbanÄ±n sistemlerinde PHP API sÃ¼rÃ¼mlerinin eÅŸleÅŸtiÄŸinden emin olunur.

2. **UzantÄ± YÃ¼klenmesi:**
- Ä°lgili kÄ±sÄ±tlamalarÄ± atlamak iÃ§in `dl` iÅŸlevi kullanÄ±lÄ±r ve gÃ¶receli yollar veya sÃ¼reci otomatikleÅŸtiren bir betik kullanÄ±lÄ±r.

3. **Betik YÃ¼rÃ¼tme:**
- SaldÄ±rgan, `bypass.so` ve bir PHP betiÄŸini kurban sunucusuna yÃ¼kler.
- Betik, `dl_local` iÅŸlevini kullanarak `bypass.so`'yi dinamik olarak yÃ¼kler ve ardÄ±ndan `cmd` sorgu parametresi aracÄ±lÄ±ÄŸÄ±yla iletilen bir komutla `bypass_exec` iÅŸlevini Ã§aÄŸÄ±rÄ±r.

### Komut YÃ¼rÃ¼tme:

- SaldÄ±rgan artÄ±k komutlarÄ± ÅŸu ÅŸekilde Ã§alÄ±ÅŸtÄ±rabilir: `http://www.example.com/script.php?cmd=<komut>`


Bu ayrÄ±ntÄ±lÄ± adÄ±m adÄ±m rehber, `dl` iÅŸlevini kÃ¶tÃ¼ye kullanarak sistem komutlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶zel bir PHP uzantÄ±sÄ± oluÅŸturma ve daÄŸÄ±tma sÃ¼recini aÃ§Ä±klar. Bu, bÃ¶yle bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± Ã¶nlemek iÃ§in ideal olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lmasÄ± gereken `dl` iÅŸlevini istismar etmektedir.


<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RU
