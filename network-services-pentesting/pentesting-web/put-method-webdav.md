# WebDav

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

ä¸€ä¸ªå¯ç”¨äº†WebDavçš„HTTPæœåŠ¡å™¨å¯èƒ½å…è®¸ä½ **æ›´æ–°ã€åˆ é™¤ã€ç§»åŠ¨ã€å¤åˆ¶**æ–‡ä»¶ã€‚æœ‰æ—¶å€™ä½ éœ€è¦æœ‰**æœ‰æ•ˆçš„å‡­è¯**ï¼ˆé€šå¸¸ä½¿ç”¨HTTPåŸºæœ¬èº«ä»½éªŒè¯è¿›è¡Œæ£€æŸ¥ï¼‰ã€‚

ä½ åº”è¯¥å°è¯•**ä¸Šä¼ **ä¸€äº›**webshell**å¹¶ä»WebæœåŠ¡å™¨ä¸Š**æ‰§è¡Œ**å®ƒï¼Œä»¥æ§åˆ¶æœåŠ¡å™¨ã€‚\
é€šå¸¸ï¼Œè¦**è¿æ¥**åˆ°WebDavæœåŠ¡å™¨ï¼Œä½ éœ€è¦æœ‰æ•ˆçš„**å‡­è¯**ï¼š[**WebDavæš´åŠ›ç ´è§£**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(åŸºæœ¬èº«ä»½éªŒè¯)_ã€‚

å¦ä¸€ç§å¸¸è§çš„é…ç½®æ˜¯**ç¦æ­¢ä¸Šä¼ **ç”±WebæœåŠ¡å™¨**æ‰§è¡Œ**çš„æ–‡ä»¶æ‰©å±•åï¼Œä½ åº”è¯¥æ£€æŸ¥å¦‚ä½•**ç»•è¿‡æ­¤é™åˆ¶**ï¼š

* **ä¸Šä¼ **å…·æœ‰**å¯æ‰§è¡Œæ‰©å±•å**çš„æ–‡ä»¶ï¼ˆä¹Ÿè®¸ä¸è¢«ç¦æ­¢ï¼‰ã€‚
* **ä¸Šä¼ **æ²¡æœ‰**å¯æ‰§è¡Œæ‰©å±•å**çš„æ–‡ä»¶ï¼ˆå¦‚.txtï¼‰ï¼Œå¹¶å°è¯•ä½¿ç”¨**å¯æ‰§è¡Œæ‰©å±•å**é‡å‘½åï¼ˆç§»åŠ¨ï¼‰æ–‡ä»¶ã€‚
* **ä¸Šä¼ **æ²¡æœ‰**å¯æ‰§è¡Œæ‰©å±•å**çš„æ–‡ä»¶ï¼ˆå¦‚.txtï¼‰ï¼Œå¹¶å°è¯•ä½¿ç”¨**å¯æ‰§è¡Œæ‰©å±•å**å¤åˆ¶æ–‡ä»¶ã€‚

## DavTest

**Davtest**å°è¯•ä½¿ç”¨ä¸åŒçš„æ‰©å±•å**ä¸Šä¼ å¤šä¸ªæ–‡ä»¶**å¹¶**æ£€æŸ¥**æ‰©å±•åæ˜¯å¦è¢«**æ‰§è¡Œ**ï¼š
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
è¾“å‡ºç¤ºä¾‹ï¼š

![](<../../.gitbook/assets/image (19) (1).png>)

è¿™å¹¶ä¸æ„å‘³ç€ **.txt** å’Œ **.html æ‰©å±•åè¢«æ‰§è¡Œ**ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡ç½‘ç»œ **è®¿é—®è¿™äº›æ–‡ä»¶**ã€‚

## Cadaver

ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥ **è¿æ¥åˆ° WebDav** æœåŠ¡å™¨å¹¶ **æ‰‹åŠ¨** æ‰§è¡Œæ“ä½œï¼ˆå¦‚ **ä¸Šä¼ **ã€**ç§»åŠ¨** æˆ– **åˆ é™¤**ï¼‰ã€‚
```
cadaver <IP>
```
## PUTè¯·æ±‚

The PUT method is used to update or create a resource on a server. It is commonly used in web development to upload files or modify existing resources. When sending a PUT request, the client specifies the URI of the resource to be updated or created, and includes the new data in the request body.

PUTè¯·æ±‚ç”¨äºåœ¨æœåŠ¡å™¨ä¸Šæ›´æ–°æˆ–åˆ›å»ºèµ„æºã€‚å®ƒé€šå¸¸ç”¨äºWebå¼€å‘ä¸­ä¸Šä¼ æ–‡ä»¶æˆ–ä¿®æ”¹ç°æœ‰èµ„æºã€‚åœ¨å‘é€PUTè¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯æŒ‡å®šè¦æ›´æ–°æˆ–åˆ›å»ºçš„èµ„æºçš„URIï¼Œå¹¶åœ¨è¯·æ±‚ä½“ä¸­åŒ…å«æ–°æ•°æ®ã€‚

### WebDAV and PUT

WebDAV (Web Distributed Authoring and Versioning) is an extension of the HTTP protocol that allows for more advanced file management on web servers. It includes support for the PUT method, among other features.

WebDAVï¼ˆWebåˆ†å¸ƒå¼ä½œè€…å’Œç‰ˆæœ¬æ§åˆ¶ï¼‰æ˜¯HTTPåè®®çš„æ‰©å±•ï¼Œå…è®¸åœ¨WebæœåŠ¡å™¨ä¸Šè¿›è¡Œæ›´é«˜çº§çš„æ–‡ä»¶ç®¡ç†ã€‚å®ƒåŒ…æ‹¬å¯¹PUTæ–¹æ³•çš„æ”¯æŒï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ã€‚

### PUT Method and Web Application Security

From a security perspective, the PUT method can introduce vulnerabilities if not properly implemented. For example, if the server does not validate the user's permissions before updating or creating a resource, an attacker could potentially modify sensitive data or upload malicious files.

ä»å®‰å…¨è§’åº¦æ¥çœ‹ï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®å®ç°PUTæ–¹æ³•ï¼Œå®ƒå¯èƒ½ä¼šå¼•å…¥æ¼æ´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœåŠ¡å™¨åœ¨æ›´æ–°æˆ–åˆ›å»ºèµ„æºä¹‹å‰ä¸éªŒè¯ç”¨æˆ·çš„æƒé™ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹æ•æ„Ÿæ•°æ®æˆ–ä¸Šä¼ æ¶æ„æ–‡ä»¶ã€‚

### Exploiting PUT Method Vulnerabilities

To exploit vulnerabilities related to the PUT method, an attacker can send a crafted PUT request with malicious data or files. This can lead to various types of attacks, such as remote code execution, file inclusion, or information disclosure.

ä¸ºäº†åˆ©ç”¨ä¸PUTæ–¹æ³•ç›¸å…³çš„æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„PUTè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ¶æ„æ•°æ®æˆ–æ–‡ä»¶ã€‚è¿™å¯èƒ½å¯¼è‡´å„ç§ç±»å‹çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œã€æ–‡ä»¶åŒ…å«æˆ–ä¿¡æ¯æ³„éœ²ã€‚

### Protecting Against PUT Method Vulnerabilities

To protect against vulnerabilities related to the PUT method, it is important to implement proper security measures. This includes validating user permissions, sanitizing user input, and implementing access controls to prevent unauthorized access or modification of resources.

ä¸ºäº†é˜²æ­¢ä¸PUTæ–¹æ³•ç›¸å…³çš„æ¼æ´ï¼Œé‡è¦çš„æ˜¯è¦å®æ–½é€‚å½“çš„å®‰å…¨æªæ–½ã€‚è¿™åŒ…æ‹¬éªŒè¯ç”¨æˆ·æƒé™ã€å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œæ¸…ç†ï¼Œå¹¶å®æ–½è®¿é—®æ§åˆ¶ä»¥é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®æˆ–ä¿®æ”¹èµ„æºã€‚
```
curl -T 'shell.txt' 'http://$ip'
```
## MOVE è¯·æ±‚

The MOVE request is used in WebDAV to move a resource from one location to another. It is similar to the HTTP `PUT` method, but instead of creating a new resource, it moves an existing resource to a new location.

MOVE è¯·æ±‚åœ¨ WebDAV ä¸­ç”¨äºå°†èµ„æºä»ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚å®ƒç±»ä¼¼äº HTTP çš„ `PUT` æ–¹æ³•ï¼Œä½†ä¸æ˜¯åˆ›å»ºæ–°çš„èµ„æºï¼Œè€Œæ˜¯å°†ç°æœ‰èµ„æºç§»åŠ¨åˆ°æ–°çš„ä½ç½®ã€‚

### Syntax

```
MOVE /path/to/source HTTP/1.1
Host: example.com
Destination: /path/to/destination
```

### Example

```
MOVE /file.txt HTTP/1.1
Host: example.com
Destination: /new/location/file.txt
```

In this example, the file `file.txt` located at `/path/to/source` on the server `example.com` is moved to `/path/to/destination` on the same server.

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½äºæœåŠ¡å™¨ `example.com` ä¸Šçš„ `/path/to/source` çš„æ–‡ä»¶ `file.txt` è¢«ç§»åŠ¨åˆ°åŒä¸€æœåŠ¡å™¨ä¸Šçš„ `/path/to/destination`ã€‚

### Response

The server should respond with a `200 OK` status code if the move operation is successful. If the destination already exists, the server may choose to overwrite it or return a `412 Precondition Failed` status code.

å¦‚æœç§»åŠ¨æ“ä½œæˆåŠŸï¼ŒæœåŠ¡å™¨åº”è¯¥ä»¥ `200 OK` çŠ¶æ€ç è¿›è¡Œå“åº”ã€‚å¦‚æœç›®æ ‡ä½ç½®å·²ç»å­˜åœ¨ï¼ŒæœåŠ¡å™¨å¯ä»¥é€‰æ‹©è¦†ç›–å®ƒæˆ–è¿”å› `412 Precondition Failed` çŠ¶æ€ç ã€‚

### Security Implications

The MOVE request can be used by an attacker to move sensitive files to a location accessible to them, potentially exposing sensitive information or compromising the system's integrity.

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ MOVE è¯·æ±‚å°†æ•æ„Ÿæ–‡ä»¶ç§»åŠ¨åˆ°ä»–ä»¬å¯ä»¥è®¿é—®çš„ä½ç½®ï¼Œä»è€Œå¯èƒ½æš´éœ²æ•æ„Ÿä¿¡æ¯æˆ–ç ´åç³»ç»Ÿçš„å®Œæ•´æ€§ã€‚

It is important to properly configure access controls and permissions to prevent unauthorized access and abuse of the MOVE request.

é‡è¦çš„æ˜¯è¦æ­£ç¡®é…ç½®è®¿é—®æ§åˆ¶å’Œæƒé™ï¼Œä»¥é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®å’Œæ»¥ç”¨ MOVE è¯·æ±‚ã€‚
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## IIS5/6 WebDavæ¼æ´

è¿™ä¸ªæ¼æ´éå¸¸æœ‰è¶£ã€‚**WebDav**ä¸å…è®¸ä¸Šä¼ æˆ–é‡å‘½åæ‰©å±•åä¸º**.asp**çš„æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨åç§°æœ«å°¾æ·»åŠ **";.txt"**æ¥ç»•è¿‡æ­¤é™åˆ¶ï¼Œæ–‡ä»¶å°†è¢«æ‰§è¡Œï¼Œå°±åƒå®ƒæ˜¯ä¸€ä¸ª.aspæ–‡ä»¶ä¸€æ ·ï¼ˆæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨".html"ä»£æ›¿".txt"ï¼Œä½†**ä¸è¦å¿˜è®°";"**ï¼‰ã€‚

ç„¶åï¼Œæ‚¨å¯ä»¥å°†æ‚¨çš„shellä¸Šä¼ ä¸º".**txt"æ–‡ä»¶**ï¼Œå¹¶å°†å…¶å¤åˆ¶/ç§»åŠ¨åˆ°".asp;.txt"æ–‡ä»¶ä¸­ã€‚é€šè¿‡WebæœåŠ¡å™¨è®¿é—®è¯¥æ–‡ä»¶ï¼Œå®ƒå°†è¢«æ‰§è¡Œï¼ˆcadaverä¼šè¯´ç§»åŠ¨æ“ä½œå¤±è´¥ï¼Œä½†å®é™…ä¸Šæ˜¯æˆåŠŸçš„ï¼‰ã€‚

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## æäº¤å‡­æ®

å¦‚æœWebdavä½¿ç”¨çš„æ˜¯ApacheæœåŠ¡å™¨ï¼Œåˆ™åº”æŸ¥çœ‹Apacheä¸­é…ç½®çš„ç«™ç‚¹ã€‚é€šå¸¸åœ¨ï¼š\
_**/etc/apache2/sites-enabled/000-default**_

åœ¨å…¶ä¸­ï¼Œæ‚¨å¯èƒ½ä¼šæ‰¾åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„ä¸œè¥¿ï¼š
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªåŒ…å«**webdav**æœåŠ¡å™¨çš„æœ‰æ•ˆ**å‡­æ®**çš„æ–‡ä»¶ï¼š
```
/etc/apache2/users.password
```
åœ¨è¿™ç±»æ–‡ä»¶ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°**ç”¨æˆ·å**å’Œ**å¯†ç çš„å“ˆå¸Œå€¼**ã€‚è¿™äº›æ˜¯WebDAVæœåŠ¡å™¨ç”¨äºéªŒè¯ç”¨æˆ·çš„å‡­æ®ã€‚

æ‚¨å¯ä»¥å°è¯•**ç ´è§£**å®ƒä»¬ï¼Œæˆ–è€…å¦‚æœå‡ºäºæŸç§åŸå› æ‚¨æƒ³è¦**è®¿é—®**WebDAVæœåŠ¡å™¨ï¼Œå¯ä»¥**æ·»åŠ æ›´å¤š**å‡­æ®ï¼š
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
è¦æ£€æŸ¥æ–°å‡­æ®æ˜¯å¦æœ‰æ•ˆï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
