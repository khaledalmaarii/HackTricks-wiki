# ç‰¹æ®Šçš„HTTPå¤´éƒ¨

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTricksçš„è¡£ç‰©**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## å­—å…¸å’Œå·¥å…·

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## æ›´æ”¹ä½ç½®çš„å¤´éƒ¨

é‡å†™**IPæº**ï¼š

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (æ£€æŸ¥é€è·³å¤´éƒ¨)

é‡å†™**ä½ç½®**ï¼š

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## é€è·³å¤´éƒ¨

é€è·³å¤´éƒ¨æ˜¯è®¾è®¡ä¸ºç”±å½“å‰å¤„ç†è¯·æ±‚çš„ä»£ç†æœåŠ¡å™¨å¤„ç†å’Œæ¶ˆè€—çš„å¤´éƒ¨ï¼Œè€Œä¸æ˜¯ç«¯åˆ°ç«¯å¤´éƒ¨ã€‚

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTPè¯·æ±‚èµ°ç§

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## ç¼“å­˜å¤´éƒ¨

**æœåŠ¡å™¨ç¼“å­˜å¤´éƒ¨**ï¼š

* å“åº”ä¸­çš„**`X-Cache`**å¯èƒ½å…·æœ‰å€¼**`miss`**ï¼Œè¡¨ç¤ºè¯·æ±‚æœªè¢«ç¼“å­˜ï¼Œå€¼**`hit`**è¡¨ç¤ºå·²è¢«ç¼“å­˜
* **`Cache-Control`**æŒ‡ç¤ºèµ„æºæ˜¯å¦è¢«ç¼“å­˜ä»¥åŠä¸‹æ¬¡èµ„æºå°†è¢«å†æ¬¡ç¼“å­˜çš„æ—¶é—´ï¼š`Cache-Control: public, max-age=1800`
* **`Vary`**é€šå¸¸åœ¨å“åº”ä¸­ä½¿ç”¨ï¼Œ**æŒ‡ç¤ºå…¶ä»–å¤´éƒ¨**è¢«è§†ä¸º**ç¼“å­˜é”®çš„ä¸€éƒ¨åˆ†**ï¼Œå³ä½¿å®ƒä»¬é€šå¸¸ä¸æ˜¯é”®æ§çš„ã€‚
* **`Age`**å®šä¹‰äº†å¯¹è±¡åœ¨ä»£ç†ç¼“å­˜ä¸­çš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚
* **`Server-Timing: cdn-cache; desc=HIT`**è¿˜è¡¨ç¤ºèµ„æºå·²è¢«ç¼“å­˜

{% content-ref url="../../pentesting-web/cache-deception.md" %}
[cache-deception.md](../../pentesting-web/cache-deception.md)
{% endcontent-ref %}

**æœ¬åœ°ç¼“å­˜å¤´éƒ¨**ï¼š

* `Clear-Site-Data`ï¼šæŒ‡ç¤ºåº”è¯¥åˆ é™¤çš„ç¼“å­˜ï¼š`Clear-Site-Data: "cache", "cookies"`
* `Expires`ï¼šåŒ…å«å“åº”åº”è¯¥è¿‡æœŸçš„æ—¥æœŸ/æ—¶é—´ï¼š`Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache`ä¸`Cache-Control: no-cache`ç›¸åŒ
* `Warning`ï¼š**`Warning`**é€šç”¨HTTPå¤´éƒ¨åŒ…å«æœ‰å…³æ¶ˆæ¯çŠ¶æ€å¯èƒ½å­˜åœ¨çš„é—®é¢˜çš„ä¿¡æ¯ã€‚ä¸€ä¸ªå“åº”ä¸­å¯èƒ½ä¼šå‡ºç°å¤šä¸ª`Warning`å¤´éƒ¨ã€‚`Warning: 110 anderson/1.3.37 "Response is stale"`
## æ¡ä»¶è¯­å¥

* ä½¿ç”¨è¿™äº›å¤´éƒ¨çš„è¯·æ±‚ï¼š**`If-Modified-Since`** å’Œ **`If-Unmodified-Since`**ï¼Œåªæœ‰å½“å“åº”å¤´éƒ¨çš„ **`Last-Modified`** åŒ…å«ä¸åŒçš„æ—¶é—´æ—¶ï¼Œæ‰ä¼šè¿”å›æ•°æ®ã€‚
* ä½¿ç”¨ **`If-Match`** å’Œ **`If-None-Match`** çš„æ¡ä»¶è¯·æ±‚ä½¿ç”¨ Etag å€¼ï¼Œå› æ­¤åªæœ‰å½“æ•°æ®ï¼ˆEtagï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒWeb æœåŠ¡å™¨æ‰ä¼šå‘é€å“åº”çš„å†…å®¹ã€‚`Etag` æ˜¯ä» HTTP å“åº”ä¸­è·å–çš„ã€‚
* **Etag** å€¼é€šå¸¸æ˜¯åŸºäºå“åº”å†…å®¹è¿›è¡Œè®¡ç®—çš„ã€‚ä¾‹å¦‚ï¼Œ`ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` è¡¨ç¤º `Etag` æ˜¯å“åº”å†…å®¹çš„ **37 å­—èŠ‚** çš„ **Sha1** å€¼ã€‚

## èŒƒå›´è¯·æ±‚

* **`Accept-Ranges`**ï¼šæŒ‡ç¤ºæœåŠ¡å™¨æ˜¯å¦æ”¯æŒèŒƒå›´è¯·æ±‚ï¼Œä»¥åŠèŒƒå›´å¯ä»¥ç”¨å“ªç§å•ä½è¡¨ç¤ºã€‚`Accept-Ranges: <range-unit>`
* **`Range`**ï¼šæŒ‡ç¤ºæœåŠ¡å™¨åº”è¯¥è¿”å›æ–‡æ¡£çš„å“ªä¸ªéƒ¨åˆ†ã€‚
* **`If-Range`**ï¼šåˆ›å»ºä¸€ä¸ªæ¡ä»¶èŒƒå›´è¯·æ±‚ï¼Œåªæœ‰å½“ç»™å®šçš„ Etag æˆ–æ—¥æœŸä¸è¿œç¨‹èµ„æºåŒ¹é…æ—¶æ‰ä¼šæ»¡è¶³ã€‚ç”¨äºé˜²æ­¢ä»ä¸å…¼å®¹ç‰ˆæœ¬çš„èµ„æºä¸‹è½½ä¸¤ä¸ªèŒƒå›´ã€‚
* **`Content-Range`**ï¼šæŒ‡ç¤ºéƒ¨åˆ†æ¶ˆæ¯åœ¨å®Œæ•´æ¶ˆæ¯ä½“ä¸­çš„ä½ç½®ã€‚

## æ¶ˆæ¯ä½“ä¿¡æ¯

* **`Content-Length`**ï¼šèµ„æºçš„å¤§å°ï¼Œä»¥åè¿›åˆ¶å­—èŠ‚æ•°è¡¨ç¤ºã€‚
* **`Content-Type`**ï¼šæŒ‡ç¤ºèµ„æºçš„åª’ä½“ç±»å‹ã€‚
* **`Content-Encoding`**ï¼šç”¨äºæŒ‡å®šå‹ç¼©ç®—æ³•ã€‚
* **`Content-Language`**ï¼šæè¿°é¢å‘å—ä¼—çš„äººç±»è¯­è¨€ï¼Œä»¥ä¾¿å…è®¸ç”¨æˆ·æ ¹æ®è‡ªå·±çš„é¦–é€‰è¯­è¨€è¿›è¡ŒåŒºåˆ†ã€‚
* **`Content-Location`**ï¼šæŒ‡ç¤ºè¿”å›æ•°æ®çš„å¤‡ç”¨ä½ç½®ã€‚

ä»æ¸—é€æµ‹è¯•çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸æ˜¯â€œæ— ç”¨çš„â€ï¼Œä½†å¦‚æœèµ„æºå—åˆ° 401 æˆ– 403 çš„ä¿æŠ¤ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥æ‰¾åˆ°æŸç§æ–¹æ³•æ¥è·å–è¿™äº›ä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯æœ‰è¶£çš„ã€‚\
ä¾‹å¦‚ï¼Œä½¿ç”¨ HEAD è¯·æ±‚ä¸­çš„ **`Range`** å’Œ **`Etag`** çš„ç»„åˆå¯ä»¥é€šè¿‡ HEAD è¯·æ±‚æ³„æ¼é¡µé¢çš„å†…å®¹ï¼š

* ä½¿ç”¨å¤´éƒ¨ `Range: bytes=20-20` çš„è¯·æ±‚ï¼Œå¹¶ä¸”å“åº”åŒ…å« `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"`ï¼Œåˆ™æ³„æ¼äº†å­—èŠ‚ 20 çš„ SHA1 å€¼ä¸º `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y`

## æœåŠ¡å™¨ä¿¡æ¯

* `Server: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## æ§åˆ¶

* **`Allow`**ï¼šåˆ—å‡ºèµ„æºæ”¯æŒçš„æ–¹æ³•é›†ã€‚`Allow: GET, POST, HEAD`
* **`Expect`**ï¼š**`Expect`** HTTP è¯·æ±‚å¤´éƒ¨æŒ‡ç¤ºæœåŠ¡å™¨éœ€è¦æ»¡è¶³çš„æœŸæœ›ï¼Œä»¥æ­£ç¡®å¤„ç†è¯·æ±‚ã€‚
* ç›®å‰é™¤äº† `Expect: 100-continue` ä¹‹å¤–ï¼Œæ²¡æœ‰æŒ‡å®šå…¶ä»–æœŸæœ›ã€‚é€šçŸ¥æ¥æ”¶è€…å®¢æˆ·ç«¯å³å°†å‘é€ä¸€ä¸ªï¼ˆå¯èƒ½å¾ˆå¤§çš„ï¼‰æ¶ˆæ¯ä½“ï¼Œå¹¶å¸Œæœ›æ¥æ”¶åˆ° [`100`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/100)ï¼ˆContinueï¼‰çš„ä¸­é—´å“åº”ã€‚

## ä¸‹è½½

* **`Content-Disposition`**ï¼šåœ¨å¸¸è§„çš„ HTTP å“åº”ä¸­ï¼Œ**`Content-Disposition`** å“åº”å¤´éƒ¨æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå†…å®¹æ˜¯å¦é¢„æœŸåœ¨æµè§ˆå™¨ä¸­ä»¥ _inline_ çš„æ–¹å¼æ˜¾ç¤ºï¼Œå³ä½œä¸ºç½‘é¡µçš„ä¸€éƒ¨åˆ†æˆ–æ•´ä¸ªç½‘é¡µï¼Œæˆ–è€…ä½œä¸º _attachment_ ä¸‹è½½å¹¶æœ¬åœ°ä¿å­˜çš„å¤´éƒ¨ã€‚
* `Content-Disposition: attachment; filename="filename.jpg"`

## å®‰å…¨å¤´éƒ¨

### å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰<a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### å—ä¿¡ä»»ç±»å‹ï¼ˆTrusted Typesï¼‰<a href="#tt" id="tt"></a>

å—ä¿¡ä»»ç±»å‹æä¾›äº†ç¼–å†™ã€å®‰å…¨å®¡æŸ¥å’Œç»´æŠ¤æ—  DOM XSS çš„åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡ [CSP](https://web.dev/security-headers/#csp) å¯ç”¨ï¼Œå¹¶é€šè¿‡é™åˆ¶å±é™©çš„ Web API ä»…æ¥å—ç‰¹æ®Šå¯¹è±¡ï¼ˆå—ä¿¡ä»»ç±»å‹ï¼‰æ¥ä½¿ JavaScript ä»£ç é»˜è®¤å®‰å…¨ã€‚

è¦åˆ›å»ºè¿™äº›å¯¹è±¡ï¼Œæ‚¨å¯ä»¥å®šä¹‰å®‰å…¨ç­–ç•¥ï¼Œåœ¨å…¶ä¸­å¯ä»¥ç¡®ä¿åœ¨å°†æ•°æ®å†™å…¥ DOM ä¹‹å‰å§‹ç»ˆåº”ç”¨å®‰å…¨è§„åˆ™ï¼ˆå¦‚è½¬ä¹‰æˆ–æ¸…ç†ï¼‰ã€‚è¿™äº›ç­–ç•¥æ˜¯ä»£ç ä¸­å”¯ä¸€å¯èƒ½å¼•å…¥ DOM XSS çš„åœ°æ–¹ã€‚
```http
Content-Security-Policy: require-trusted-types-for 'script'
```

```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => {
return str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
}
});
}
```

```javascript
// Assignment of raw strings is blocked by Trusted Types.
el.innerHTML = 'some string'; // This throws an exception.

// Assignment of Trusted Types is accepted safely.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // '&lt;img src=x onerror=alert(1)&gt;'
```
### X-Content-Type-Options <a href="#xcto" id="xcto"></a>

å½“æ¶æ„çš„HTMLæ–‡æ¡£ä»æ‚¨çš„åŸŸåä¸­æä¾›æœåŠ¡æ—¶ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä¸Šä¼ åˆ°ç…§ç‰‡æœåŠ¡çš„å›¾åƒåŒ…å«æœ‰æ•ˆçš„HTMLæ ‡è®°ï¼‰ï¼ŒæŸäº›æµè§ˆå™¨å°†å°†å…¶è§†ä¸ºæ´»åŠ¨æ–‡æ¡£ï¼Œå¹¶å…è®¸å…¶åœ¨åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œè„šæœ¬ï¼Œä»è€Œå¯¼è‡´[è·¨ç«™è„šæœ¬æ¼æ´](https://www.google.com/about/appsecurity/learning/xss/)ã€‚

`X-Content-Type-Options: nosniff` é€šè¿‡æŒ‡ç¤ºæµè§ˆå™¨å¯¹ç»™å®šå“åº”çš„`Content-Type`å¤´ä¸­è®¾ç½®çš„[MIMEç±»å‹](https://mimesniff.spec.whatwg.org/#introduction)æ˜¯æ­£ç¡®çš„ï¼Œä»è€Œé˜²æ­¢æ­¤é—®é¢˜ã€‚å»ºè®®åœ¨**æ‰€æœ‰èµ„æº**ä¸­ä½¿ç”¨æ­¤å¤´ã€‚
```http
X-Content-Type-Options: nosniff
```
### X-Frame-Options <a href="#xfo" id="xfo"></a>

å¦‚æœæ¶æ„ç½‘ç«™å¯ä»¥å°†æ‚¨çš„ç½‘ç«™åµŒå…¥åˆ°iframeä¸­ï¼Œè¿™å¯èƒ½å…è®¸æ”»å‡»è€…é€šè¿‡[ç‚¹å‡»åŠ«æŒ](https://portswigger.net/web-security/clickjacking)æ¥å¼•å‘ç”¨æˆ·çš„æ„å¤–æ“ä½œã€‚æ­¤å¤–ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ[Spectreç±»å‹çš„æ”»å‡»](https://en.wikipedia.org/wiki/Spectre\_\(security\_vulnerability\))ç»™æ¶æ„ç½‘ç«™æä¾›äº†äº†è§£åµŒå…¥æ–‡æ¡£å†…å®¹çš„æœºä¼šã€‚

`X-Frame-Options`æŒ‡ç¤ºæµè§ˆå™¨æ˜¯å¦å…è®¸åœ¨`<frame>`ã€`<iframe>`ã€`<embed>`æˆ–`<object>`ä¸­å‘ˆç°é¡µé¢ã€‚**å»ºè®®æ‰€æœ‰æ–‡æ¡£**å‘é€æ­¤å¤´éƒ¨ï¼Œä»¥æŒ‡ç¤ºå®ƒä»¬æ˜¯å¦å…è®¸è¢«å…¶ä»–æ–‡æ¡£åµŒå…¥ã€‚

å¦‚æœæ‚¨éœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œä¾‹å¦‚åªå…è®¸ç‰¹å®šæ¥æºåµŒå…¥æ–‡æ¡£ï¼Œè¯·ä½¿ç”¨[CSP](https://web.dev/security-headers/#csp) [`frame-ancestors`](https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors)æŒ‡ä»¤ã€‚
```http
X-Frame-Options: DENY
```
### è·¨æºèµ„æºç­–ç•¥ (CORP) <a href="#corp" id="corp"></a>

æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ©ç”¨åŸºäºWebçš„[è·¨ç«™æ³„æ¼](https://xsleaks.dev)æ¥åµŒå…¥æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºï¼Œä¾‹å¦‚æ¥è‡ªæ‚¨çš„ç½‘ç«™çš„èµ„æºï¼Œä»¥äº†è§£æœ‰å…³å®ƒä»¬çš„ä¿¡æ¯ã€‚

`Cross-Origin-Resource-Policy` é€šè¿‡æŒ‡ç¤ºå¯ä»¥åŠ è½½å®ƒçš„ç½‘ç«™é›†åˆæ¥å‡è½»æ­¤é£é™©ã€‚è¯¥æ ‡å¤´å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸‰ä¸ªå€¼ä¹‹ä¸€ï¼š`same-origin`ã€`same-site` å’Œ `cross-origin`ã€‚å»ºè®®**æ‰€æœ‰èµ„æº**å‘é€æ­¤æ ‡å¤´ï¼Œä»¥æŒ‡ç¤ºå®ƒä»¬æ˜¯å¦å…è®¸å…¶ä»–ç½‘ç«™åŠ è½½ã€‚
```
Cross-Origin-Resource-Policy: same-origin
```
### è·¨æºèµ„æºç­–ç•¥ï¼ˆCORBï¼‰<a href="#corp" id="corp"></a>

å®ƒæœ‰åŠ©äºå‡è½»ä¾§ä¿¡é“æ”»å‡»ï¼ˆåŒ…æ‹¬Spectreï¼‰çš„å¨èƒã€‚å®ƒæ—¨åœ¨é˜²æ­¢æµè§ˆå™¨å°†**å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ä¸”å¯¹ç°æœ‰ç½‘ç»œåŠŸèƒ½ä¸å¿…è¦çš„è·¨æºç½‘ç»œå“åº”**ä¼ é€’ç»™ç½‘é¡µã€‚\
åŒæ ·ï¼Œå®ƒè¿˜æœ‰åŠ©äºå‡è½»è·¨ç«™è„šæœ¬åŒ…å«ï¼ˆXSSIï¼‰æ¼æ´ã€‚\
ä¾‹å¦‚ï¼Œå®ƒå°†é˜»æ­¢ä»\<script>æˆ–\<img>æ ‡ç­¾è¯·æ±‚çš„è·¨æºtext/htmlå“åº”ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºç©ºå“åº”ã€‚è¿™æ˜¯[ç«™ç‚¹éš”ç¦»](https://www.chromium.org/Home/chromium-security/site-isolation)ä¸­åŒ…å«çš„ä¿æŠ¤æªæ–½çš„é‡è¦éƒ¨åˆ†ã€‚

### è·¨æºæ‰“å¼€ç­–ç•¥ï¼ˆCOOPï¼‰<a href="#coop" id="coop"></a>

æ”»å‡»è€…çš„ç½‘ç«™å¯ä»¥é€šè¿‡åˆ©ç”¨åŸºäºWebçš„[è·¨ç«™æ³„æ¼](https://xsleaks.dev)æ¥åœ¨å¼¹å‡ºçª—å£ä¸­æ‰“å¼€å¦ä¸€ä¸ªç«™ç‚¹ä»¥è·å–æœ‰å…³å…¶çš„ä¿¡æ¯ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´åŸºäº[Spectre](https://en.wikipedia.org/wiki/Spectre\_\(security\_vulnerability\))çš„ä¾§ä¿¡é“æ”»å‡»ã€‚

`Cross-Origin-Opener-Policy`å¤´éƒ¨æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œä½¿æ–‡æ¡£èƒ½å¤Ÿä¸é€šè¿‡`window.open()`æˆ–æ²¡æœ‰`rel="noopener"`çš„å¸¦æœ‰`target="_blank"`çš„é“¾æ¥æ‰“å¼€çš„è·¨æºçª—å£éš”ç¦»ã€‚å› æ­¤ï¼Œæ–‡æ¡£çš„ä»»ä½•è·¨æºæ‰“å¼€è€…éƒ½æ— æ³•å¼•ç”¨å®ƒå¹¶ä¸”æ— æ³•ä¸å…¶äº¤äº’ã€‚
```http
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰<a href="#cors" id="cors"></a>

ä¸æœ¬æ–‡ä¸­çš„å…¶ä»–å†…å®¹ä¸åŒï¼Œè·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰ä¸æ˜¯ä¸€ä¸ªå¤´éƒ¨ï¼Œè€Œæ˜¯ä¸€ç§æµè§ˆå™¨æœºåˆ¶ï¼Œç”¨äºè¯·æ±‚å’Œå…è®¸è®¿é—®è·¨æºèµ„æºã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨é€šè¿‡[åŒæºç­–ç•¥](https://web.dev/same-origin-policy/)æ¥é˜²æ­¢ç½‘é¡µè®¿é—®è·¨æºèµ„æºã€‚ä¾‹å¦‚ï¼Œå½“åŠ è½½è·¨æºå›¾åƒæ—¶ï¼Œå³ä½¿åœ¨ç½‘é¡µä¸Šå¯è§†åŒ–æ˜¾ç¤ºï¼Œé¡µé¢ä¸Šçš„JavaScriptä¹Ÿæ— æ³•è®¿é—®å›¾åƒçš„æ•°æ®ã€‚èµ„æºæä¾›è€…å¯ä»¥é€šè¿‡CORSé€‰æ‹©æ€§åœ°æ”¾å®½é™åˆ¶ï¼Œå…è®¸å…¶ä»–ç½‘ç«™è¯»å–èµ„æºã€‚
```http
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### è·¨åŸŸåµŒå…¥ç­–ç•¥ï¼ˆCOEPï¼‰<a href="#coep" id="coep"></a>

ä¸ºäº†å‡å°‘[Spectreæ”»å‡»](https://en.wikipedia.org/wiki/Spectre\_\(security\_vulnerability\))çªƒå–è·¨åŸŸèµ„æºçš„èƒ½åŠ›ï¼Œé»˜è®¤æƒ…å†µä¸‹ç¦ç”¨äº†`SharedArrayBuffer`æˆ–`performance.measureUserAgentSpecificMemory()`ç­‰åŠŸèƒ½ã€‚

`Cross-Origin-Embedder-Policy: require-corp`é˜»æ­¢æ–‡æ¡£å’Œå·¥ä½œçº¿ç¨‹åŠ è½½è·¨åŸŸèµ„æºï¼Œå¦‚å›¾åƒã€è„šæœ¬ã€æ ·å¼è¡¨ã€iframeç­‰ï¼Œé™¤éè¿™äº›èµ„æºé€šè¿‡[CORS](https://web.dev/security-headers/#cors)æˆ–[CORP](https://web.dev/security-headers/#corp)å¤´éƒ¨æ˜ç¡®é€‰æ‹©åŠ è½½ã€‚COEPå¯ä»¥ä¸`Cross-Origin-Opener-Policy`ç»“åˆä½¿ç”¨ï¼Œå°†æ–‡æ¡£é€‰æ‹©ä¸º[è·¨åŸŸéš”ç¦»](https://web.dev/cross-origin-isolation-guide/)ã€‚

å½“æ‚¨å¸Œæœ›ä¸ºæ–‡æ¡£å¯ç”¨[è·¨åŸŸéš”ç¦»](https://web.dev/coop-coep/)æ—¶ï¼Œè¯·ä½¿ç”¨`Cross-Origin-Embedder-Policy: require-corp`ã€‚
```http
Cross-Origin-Embedder-Policy: require-corp
```
### HTTPä¸¥æ ¼ä¼ è¾“å®‰å…¨ï¼ˆHSTSï¼‰<a href="#hsts" id="hsts"></a>

é€šè¿‡æ™®é€šçš„HTTPè¿æ¥è¿›è¡Œé€šä¿¡æ˜¯æœªåŠ å¯†çš„ï¼Œä½¿å¾—ä¼ è¾“çš„æ•°æ®å¯ä»¥è¢«ç½‘ç»œçº§åˆ«çš„çªƒå¬è€…è®¿é—®ã€‚

`Strict-Transport-Security`å¤´éƒ¨å‘ŠçŸ¥æµè§ˆå™¨ä¸åº”è¯¥ä½¿ç”¨HTTPåŠ è½½ç½‘ç«™ï¼Œè€Œåº”è¯¥ä½¿ç”¨HTTPSã€‚ä¸€æ—¦è®¾ç½®äº†è¯¥å¤´éƒ¨ï¼Œæµè§ˆå™¨å°†åœ¨å¤´éƒ¨å®šä¹‰çš„æ—¶é—´æ®µå†…ï¼Œæ— éœ€é‡å®šå‘ï¼Œç›´æ¥ä½¿ç”¨HTTPSè®¿é—®è¯¥åŸŸåã€‚
```http
Strict-Transport-Security: max-age=3153600
```
## èµ„æº

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
