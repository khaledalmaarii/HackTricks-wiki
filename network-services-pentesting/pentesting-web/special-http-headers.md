# Ã–zel HTTP baÅŸlÄ±klarÄ±

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nleri**](https://peass.creator-spring.com)'ni edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Kelime Listeleri ve AraÃ§lar

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## Konum DeÄŸiÅŸtirmek Ä°Ã§in BaÅŸlÄ±klar

**IP kaynaÄŸÄ±nÄ±** yeniden yazÄ±n:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Hop-by-hop baÅŸlÄ±klarÄ± kontrol edin)

**Konumu** yeniden yazÄ±n:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## Hop-by-Hop BaÅŸlÄ±klar

Hop-by-hop baÅŸlÄ±k, isteÄŸi iÅŸleyen proxy tarafÄ±ndan iÅŸlenip tÃ¼ketilmesi iÃ§in tasarlanmÄ±ÅŸ bir baÅŸlÄ±ktÄ±r, uÃ§tan uca baÅŸlÄ±k yerine.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP Ä°steÄŸi KaÃ§Ä±rma

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## Ã–nbellek BaÅŸlÄ±klarÄ±

**Sunucu Ã–nbellek BaÅŸlÄ±klarÄ±**:

* YanÄ±tta **`X-Cache`** deÄŸeri **`miss`** olabilir, istek Ã¶nbelleÄŸe alÄ±nmamÄ±ÅŸsa ve **`hit`** deÄŸeri Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nda
* Benzer davranÄ±ÅŸ **`Cf-Cache-Status`** baÅŸlÄ±ÄŸÄ±nda da gÃ¶rÃ¼lebilir
* **`Cache-Control`**, bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± ve kaynaÄŸÄ±n bir sonraki kez ne zaman Ã¶nbelleÄŸe alÄ±nacaÄŸÄ±nÄ± belirtir: `Cache-Control: public, max-age=1800`
* **`Vary`**, genellikle yanÄ±tta **Ã¶nbellek anahtarÄ± olarak** iÅŸlenen **ek baÅŸlÄ±klarÄ±** belirtmek iÃ§in kullanÄ±lÄ±r.
* **`Age`**, nesnenin proxy Ã¶nbelleÄŸinde kaÃ§ saniye boyunca olduÄŸunu tanÄ±mlar.
* **`Server-Timing: cdn-cache; desc=HIT`**, bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nÄ± da belirtir

{% content-ref url="../../pentesting-web/cache-deception/" %}
[cache-deception](../../pentesting-web/cache-deception/)
{% endcontent-ref %}

**Yerel Ã–nbellek baÅŸlÄ±klarÄ±**:

* `Clear-Site-Data`: KaldÄ±rÄ±lmasÄ± gereken Ã¶nbelleÄŸi belirten baÅŸlÄ±k: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: YanÄ±tÄ±n ne zaman sÃ¼resinin dolacaÄŸÄ±nÄ± iÃ§erir: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` `Cache-Control: no-cache` ile aynÄ±dÄ±r
* `Warning`: **`Warning`** genel HTTP baÅŸlÄ±ÄŸÄ±, mesajÄ±n durumuyla ilgili olasÄ± sorunlar hakkÄ±nda bilgi iÃ§erir. Bir yanÄ±tta birden fazla `Warning` baÅŸlÄ±ÄŸÄ± gÃ¶rÃ¼nebilir. `Warning: 110 anderson/1.3.37 "Response is stale"`

## KoÅŸullu Ä°fadeler

* Bu baÅŸlÄ±klarÄ± kullanan istekler: **`If-Modified-Since`** ve **`If-Unmodified-Since`**, yanÄ±t baÅŸlÄ±ÄŸÄ±\*\*`Last-Modified`\*\* farklÄ± bir zaman iÃ§eriyorsa yalnÄ±zca veri ile yanÄ±t verilecektir.
* **`If-Match`** ve **`If-None-Match`** kullanarak koÅŸullu istekler, bir Etag deÄŸeri kullanÄ±r, bÃ¶ylece web sunucusu yanÄ±tÄ±n iÃ§eriÄŸini gÃ¶nderecektir eÄŸer veri (Etag) deÄŸiÅŸmiÅŸse. `Etag`, HTTP yanÄ±tÄ±ndan alÄ±nÄ±r.
* **Etag** deÄŸeri genellikle yanÄ±tÄ±n iÃ§eriÄŸine dayalÄ± olarak **hesaplanÄ±r**. Ã–rneÄŸin, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` 37 baytÄ±n **Sha1**'ini gÃ¶sterir.

## AralÄ±k istekleri

* **`Accept-Ranges`**: Sunucunun aralÄ±k isteklerini destekleyip desteklemediÄŸini ve destekliyorsa aralÄ±ÄŸÄ±n hangi birimde ifade edilebileceÄŸini belirtir. `Accept-Ranges: <range-unit>`
* **`Range`**: Sunucunun dÃ¶ndÃ¼rmesi gereken belgenin bir parÃ§asÄ±nÄ± belirtir.
* **`If-Range`**: Verilen etiket veya tarih eÅŸleÅŸirse yalnÄ±zca karÅŸÄ±lanan koÅŸullu aralÄ±k isteÄŸi oluÅŸturur. Ä°ki uyumsuz sÃ¼rÃ¼mÃ¼n iki aralÄ±ÄŸÄ±nÄ± indirmeyi Ã¶nlemek iÃ§in kullanÄ±lÄ±r.
* **`Content-Range`**: Tam bir gÃ¶vde mesajÄ±nda kÄ±smi bir mesajÄ±n nerede olduÄŸunu belirtir.

## Mesaj gÃ¶vdesi bilgileri

* **`Content-Length`:** KaynaÄŸÄ±n boyutu, ondalÄ±k bayt sayÄ±sÄ± olarak.
* **`Content-Type`**: KaynaÄŸÄ±n ortam tÃ¼rÃ¼nÃ¼ belirtir
* **`Content-Encoding`**: SÄ±kÄ±ÅŸtÄ±rma algoritmasÄ±nÄ± belirtmek iÃ§in kullanÄ±lÄ±r.
* **`Content-Language`**: Ä°zleyici iÃ§in amaÃ§lanan insan dil(ler)ini tanÄ±mlar, bÃ¶ylece kullanÄ±cÄ±larÄ±n kendi tercih ettikleri dile gÃ¶re farklÄ±laÅŸmasÄ±na izin verir.
* **`Content-Location`**: DÃ¶ndÃ¼rÃ¼len veriler iÃ§in alternatif bir konumu belirtir.

Pentest aÃ§Ä±sÄ±ndan bu bilgi genellikle "anlamsÄ±z" olabilir, ancak kaynak 401 veya 403 ile korunuyorsa ve bu bilgiyi elde etmek iÃ§in bir yol bulabilirseniz, bu **ilginÃ§** olabilir.\
Ã–rneÄŸin, bir HEAD isteÄŸi iÃ§indeki **`Range`** ve **`Etag`** kombinasyonu sayesinde sayfanÄ±n iÃ§eriÄŸi HEAD istekleri aracÄ±lÄ±ÄŸÄ±yla sÄ±zdÄ±rÄ±labilir:

* YanÄ±tÄ± iÃ§eren `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"` ifadesi olan bir yanÄ±tla birlikte `Range: bytes=20-20` baÅŸlÄ±ÄŸÄ± iÃ§eren bir istek, byte 20'nin SHA1'inin `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y` olduÄŸunu sÄ±zdÄ±rÄ±r.
## Sunucu Bilgisi

* `Sunucu: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## Kontroller

* **`Allow`**: Bu baÅŸlÄ±k, bir kaynaÄŸÄ±n iÅŸleyebileceÄŸi HTTP yÃ¶ntemlerini iletmek iÃ§in kullanÄ±lÄ±r. Ã–rneÄŸin, `Allow: GET, POST, HEAD` olarak belirtilebilir, bu da kaynaÄŸÄ±n bu yÃ¶ntemleri desteklediÄŸini gÃ¶sterir.
* **`Expect`**: Ä°stemcinin, isteÄŸin baÅŸarÄ±lÄ± bir ÅŸekilde iÅŸlenmesi iÃ§in sunucunun karÅŸÄ±lamasÄ± gereken beklentileri iletmek iÃ§in kullanÄ±lÄ±r. YaygÄ±n bir kullanÄ±m durumu, bÃ¼yÃ¼k bir veri yÃ¼kÃ¼ gÃ¶ndermeyi amaÃ§layan istemcinin `Expect: 100-continue` baÅŸlÄ±ÄŸÄ±nÄ± iÃ§ermesidir. Ä°stemci, iletimi sÃ¼rdÃ¼rmeden Ã¶nce bir `100 (Devam Et)` yanÄ±tÄ± arar. Bu mekanizma, sunucu onayÄ±nÄ± bekleyerek aÄŸ kullanÄ±mÄ±nÄ± optimize etmeye yardÄ±mcÄ± olur.

## Ä°ndirmeler

* HTTP yanÄ±tlarÄ±ndaki **`Content-Disposition`** baÅŸlÄ±ÄŸÄ±, bir dosyanÄ±n web sayfasÄ± iÃ§inde **inline** olarak mÄ± yoksa bir **ek** (indirilecek) olarak mÄ± iÅŸlenmesi gerektiÄŸini yÃ¶nlendirir. Ã–rneÄŸin:
```
Content-Disposition: attachment; filename="filename.jpg"
```
Bu, "filename.jpg" adlÄ± dosyanÄ±n indirilmesi ve kaydedilmesi amaÃ§lanmÄ±ÅŸtÄ±r.

## GÃ¼venlik BaÅŸlÄ±klarÄ±

### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **GÃ¼venilir TÃ¼rler**

CSP aracÄ±lÄ±ÄŸÄ±yla GÃ¼venilir TÃ¼rlerin zorunlu kÄ±lÄ±nmasÄ±yla, uygulamalar DOM XSS saldÄ±rÄ±larÄ±na karÅŸÄ± korunabilir. GÃ¼venilir TÃ¼rler, yalnÄ±zca belirlenmiÅŸ gÃ¼venlik politikalarÄ±na uygun olarak oluÅŸturulmuÅŸ nesnelerin, tehlikeli web API Ã§aÄŸrÄ±larÄ±nda kullanÄ±labileceÄŸini saÄŸlar, bÃ¶ylece JavaScript kodunu varsayÄ±lan olarak gÃ¼vence altÄ±na alÄ±r.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

Bu baÅŸlÄ±k, XSS gÃ¼venlik aÃ§Ä±klarÄ±na yol aÃ§abilecek MIME tÃ¼rÃ¼ karÄ±ÅŸtÄ±rma uygulamasÄ±nÄ± engeller. TarayÄ±cÄ±larÄ±n sunucu tarafÄ±ndan belirtilen MIME tÃ¼rlerine saygÄ± gÃ¶stermesini saÄŸlar.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

Clickjacking'i engellemek iÃ§in bu baÅŸlÄ±k, belgelerin `<frame>`, `<iframe>`, `<embed>` veya `<object>` etiketlerinde nasÄ±l gÃ¶mÃ¼lebileceÄŸini kÄ±sÄ±tlar ve tÃ¼m belgelerin gÃ¶mÃ¼lme izinlerini aÃ§Ä±kÃ§a belirtmelerini Ã¶nerir.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) ve Cross-Origin Resource Sharing (CORS)**

CORP, web siteleri tarafÄ±ndan yÃ¼klenen hangi kaynaklarÄ±n belirlendiÄŸi iÃ§in Ã¶nemlidir ve Ã§apraz site sÄ±zÄ±ntÄ±larÄ±nÄ± azaltÄ±r. Ã–te yandan CORS, belirli koÅŸullar altÄ±nda aynÄ± kÃ¶ken politikasÄ±nÄ± gevÅŸeten daha esnek bir Ã§apraz kÃ¶ken kaynak paylaÅŸÄ±m mekanizmasÄ± saÄŸlar.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **Cross-Origin Embedder Policy (COEP) ve Cross-Origin Opener Policy (COOP)**

COEP ve COOP, Ã§apraz kÃ¶ken izolasyonunu etkinleÅŸtirmek iÃ§in Ã¶nemlidir ve Spectre benzeri saldÄ±rÄ± riskini Ã¶nemli Ã¶lÃ§Ã¼de azaltÄ±r. Bunlar sÄ±rasÄ±yla Ã§apraz kÃ¶ken kaynaklarÄ±n yÃ¼klenmesini ve Ã§apraz kÃ¶ken pencerelerle etkileÅŸimi kontrol eder.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

Son olarak, HSTS, tarayÄ±cÄ±larÄ± yalnÄ±zca gÃ¼venli HTTPS baÄŸlantÄ±larÄ± Ã¼zerinden sunucularla iletiÅŸim kurmaya zorlayan bir gÃ¼venlik Ã¶zelliÄŸidir, bÃ¶ylece gizlilik ve gÃ¼venliÄŸi artÄ±rÄ±r.
```
Strict-Transport-Security: max-age=3153600
```
## Referanslar

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na (https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
