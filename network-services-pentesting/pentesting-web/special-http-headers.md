# Ã–zel HTTP baÅŸlÄ±klarÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nleri**](https://peass.creator-spring.com)'ni edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Kelime listeleri ve AraÃ§lar

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## Konum DeÄŸiÅŸtirmek iÃ§in BaÅŸlÄ±klar

**IP kaynaÄŸÄ±nÄ±** yeniden yazÄ±n:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Hop-by-hop baÅŸlÄ±klarÄ± kontrol edin)

**Konumu** yeniden yazÄ±n:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## Hop-by-Hop BaÅŸlÄ±klar

Hop-by-hop baÅŸlÄ±ÄŸÄ±, isteÄŸi iÅŸleyen proxy tarafÄ±ndan iÅŸlenip tÃ¼ketilmesi iÃ§in tasarlanmÄ±ÅŸ bir baÅŸlÄ±ktÄ±r ve uÃ§tan uca bir baÅŸlÄ±k yerine geÃ§er.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP Ä°stek Smugglingi

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## Ã–nbellek BaÅŸlÄ±klarÄ±

**Sunucu Ã–nbellek BaÅŸlÄ±klarÄ±**:

* YanÄ±ttaki **`X-Cache`** deÄŸeri, isteÄŸin Ã¶nbelleÄŸe alÄ±nmadÄ±ÄŸÄ±nÄ± gÃ¶stermek iÃ§in **`miss`** deÄŸerine sahip olabilir ve Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nda **`hit`** deÄŸerine sahip olabilir.
* **`Cache-Control`**, bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± ve kaynaÄŸÄ±n bir sonraki sefer ne zaman Ã¶nbelleÄŸe alÄ±nacaÄŸÄ±nÄ± belirtir: `Cache-Control: public, max-age=1800`
* **`Vary`**, genellikle yanÄ±tta kullanÄ±lÄ±r ve normalde anahtarlanmamÄ±ÅŸ olsalar bile Ã¶nbellek anahtarÄ± olarak iÅŸlenen ek baÅŸlÄ±klarÄ± belirtir.
* **`Age`**, nesnenin proxy Ã¶nbelleÄŸinde kaÃ§ saniye olduÄŸunu tanÄ±mlar.
* **`Server-Timing: cdn-cache; desc=HIT`**, bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nÄ± da belirtir

{% content-ref url="../../pentesting-web/cache-deception.md" %}
[cache-deception.md](../../pentesting-web/cache-deception.md)
{% endcontent-ref %}

**Yerel Ã–nbellek baÅŸlÄ±klarÄ±**:

* `Clear-Site-Data`: KaldÄ±rÄ±lmasÄ± gereken Ã¶nbelleÄŸi belirten baÅŸlÄ±k: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: YanÄ±tÄ±n ne zaman sÃ¼resinin dolacaÄŸÄ±nÄ± iÃ§erir: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache`, `Cache-Control: no-cache` ile aynÄ± anlama gelir
* `Warning`: **`Warning`** genel HTTP baÅŸlÄ±ÄŸÄ±, mesajÄ±n durumuyla ilgili olasÄ± sorunlar hakkÄ±nda bilgi iÃ§erir. Bir yanÄ±tta birden fazla `Warning` baÅŸlÄ±ÄŸÄ± gÃ¶rÃ¼nebilir. `Warning: 110 anderson/1.3.37 "Response is stale"`

## KoÅŸullu Ä°fadeler

* **`If-Modified-Since`** ve **`If-Unmodified-Since`** baÅŸlÄ±klarÄ±nÄ± kullanan istekler, yanÄ±t baÅŸlÄ±ÄŸÄ±\*\*`Last-Modified`\*\* farklÄ± bir zaman iÃ§eriyorsa yalnÄ±zca veri ile yanÄ±tlanÄ±r.
* **`If-Match`** ve **`If-None-Match`** kullanarak koÅŸullu istekler, web sunucusu yanÄ±tÄ±n iÃ§eriÄŸini deÄŸiÅŸtirdiyse iÃ§eriÄŸi (Etag) gÃ¶nderir. `Etag`, HTTP yanÄ±tÄ±ndan alÄ±nÄ±r.
* **Etag** deÄŸeri genellikle yanÄ±tÄ±n iÃ§eriÄŸine dayalÄ± olarak hesaplanÄ±r. Ã–rneÄŸin, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` ifadesi, `Etag`'Ä±n **37 baytÄ±n** Sha1'i olduÄŸunu gÃ¶sterir.

## AralÄ±k istekleri

* **`Accept-Ranges`**: Sunucunun aralÄ±k isteklerini destekleyip desteklemediÄŸini ve destekliyorsa aralÄ±ÄŸÄ±n hangi birimde ifade edilebileceÄŸini belirtir. `Accept-Ranges: <range-unit>`
* **`Range`**: Sunucunun dÃ¶ndÃ¼rmesi gereken belgenin bir parÃ§asÄ±nÄ± belirtir.
* **`If-Range`**: Verilen etag veya tarihle eÅŸleÅŸen bir koÅŸullu aralÄ±k isteÄŸi oluÅŸturur. Ä°ndirilecek iki aralÄ±ÄŸÄ± uyumsuz kaynak sÃ¼rÃ¼mÃ¼nden Ã¶nlemek iÃ§in kullanÄ±lÄ±r.
* **`Content-Range`**: KÄ±smi bir mesajÄ±n tam bir mesajdaki yeri belirtir.

## Mesaj gÃ¶vde bilgisi

* **`Content-Length`:** KaynaÄŸÄ±n boyutu, ondalÄ±k sayÄ±da bayt cinsinden.
* **`Content-Type`**: KaynaÄŸÄ±n medya tÃ¼rÃ¼nÃ¼ belirtir
* **`Content-Encoding`**: SÄ±kÄ±ÅŸtÄ±rma algoritmasÄ±nÄ± belirtmek iÃ§in kullanÄ±lÄ±r.
* **`Content-Language`**: Ä°zleyici iÃ§in amaÃ§lanan insan dilini tanÄ±mlar, bÃ¶ylece kullanÄ±cÄ±lar kendi tercih ettikleri dile gÃ¶re farklÄ±laÅŸabilir.
* **`Content-Location`**: DÃ¶ndÃ¼rÃ¼len veriler iÃ§in alternatif bir konumu belirtir.

Bir pentest aÃ§Ä±sÄ±ndan bu bilgi genellik
## Sunucu Bilgisi

* `Sunucu: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## Kontroller

* **`Allow`**: Bu baÅŸlÄ±k, bir kaynaÄŸÄ±n iÅŸleyebileceÄŸi HTTP yÃ¶ntemlerini iletmek iÃ§in kullanÄ±lÄ±r. Ã–rneÄŸin, `Allow: GET, POST, HEAD` olarak belirtilebilir ve kaynaÄŸÄ±n bu yÃ¶ntemleri desteklediÄŸini gÃ¶sterir.
* **`Expect`**: Ä°stemcinin, isteÄŸin baÅŸarÄ±lÄ± bir ÅŸekilde iÅŸlenmesi iÃ§in sunucunun karÅŸÄ±lamasÄ± gereken beklentileri iletmek iÃ§in kullanÄ±lÄ±r. YaygÄ±n bir kullanÄ±m durumu, bÃ¼yÃ¼k bir veri yÃ¼kÃ¼ gÃ¶ndermeyi amaÃ§layan istemcinin `Expect: 100-continue` baÅŸlÄ±ÄŸÄ±nÄ± kullanmasÄ±dÄ±r. Ä°stemci, iletimi sÃ¼rdÃ¼rmeden Ã¶nce `100 (Continue)` yanÄ±tÄ±nÄ± bekler. Bu mekanizma, sunucu onayÄ±nÄ± bekleyerek aÄŸ kullanÄ±mÄ±nÄ± optimize etmeye yardÄ±mcÄ± olur.

## Ä°ndirmeler

* HTTP yanÄ±tlarÄ±ndaki **`Content-Disposition`** baÅŸlÄ±ÄŸÄ±, bir dosyanÄ±n web sayfasÄ± iÃ§inde **inline** (iÃ§eride) mi yoksa **attachment** (indirilen) olarak mÄ± gÃ¶rÃ¼ntÃ¼lenmesi gerektiÄŸini yÃ¶nlendirir. Ã–rneÄŸin:
```
Content-Disposition: attachment; filename="filename.jpg"
```
Bu, "dosyaadÄ±.jpg" adlÄ± dosyanÄ±n indirilmesi ve kaydedilmesi amaÃ§lanmÄ±ÅŸtÄ±r.

## GÃ¼venlik BaÅŸlÄ±klarÄ±

### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **GÃ¼venilir TÃ¼rler**

CSP aracÄ±lÄ±ÄŸÄ±yla GÃ¼venilir TÃ¼rlerin zorunlu hale getirilmesiyle, uygulamalar DOM XSS saldÄ±rÄ±larÄ±na karÅŸÄ± korunabilir. GÃ¼venilir TÃ¼rler, yalnÄ±zca belirlenmiÅŸ gÃ¼venlik politikalarÄ±na uygun olarak oluÅŸturulmuÅŸ nesnelerin tehlikeli web API Ã§aÄŸrÄ±larÄ±nda kullanÄ±lmasÄ±nÄ± saÄŸlar, bÃ¶ylece JavaScript kodunu varsayÄ±lan olarak gÃ¼vence altÄ±na alÄ±r.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

Bu baÅŸlÄ±k, XSS zafiyetlerine yol aÃ§abilecek bir uygulama olan MIME tÃ¼rÃ¼ tespitini Ã¶nler. Sunucu tarafÄ±ndan belirtilen MIME tÃ¼rlerine tarayÄ±cÄ±larÄ±n saygÄ± gÃ¶stermesini saÄŸlar.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

Clickjacking'i engellemek iÃ§in bu baÅŸlÄ±k, belgelerin `<frame>`, `<iframe>`, `<embed>` veya `<object>` etiketlerinde nasÄ±l gÃ¶mÃ¼lebileceÄŸini sÄ±nÄ±rlar ve tÃ¼m belgelerin gÃ¶mÃ¼lme izinlerini aÃ§Ä±kÃ§a belirtmelerini Ã¶nerir.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) ve Cross-Origin Resource Sharing (CORS)**

CORP, web siteleri tarafÄ±ndan yÃ¼klenen kaynaklarÄ±n hangilerinin yÃ¼klenebileceÄŸini belirlemek iÃ§in Ã¶nemlidir ve cross-site sÄ±zÄ±ntÄ±larÄ± Ã¶nler. Ã–te yandan, CORS, belirli koÅŸullar altÄ±nda aynÄ± kÃ¶k politikasÄ±nÄ± gevÅŸeten daha esnek bir cross-origin kaynak paylaÅŸÄ±m mekanizmasÄ± saÄŸlar.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **Cross-Origin Embedder Policy (COEP) ve Cross-Origin Opener Policy (COOP)**

COEP ve COOP, Ã§apraz kaynak izolasyonunu etkinleÅŸtirmek iÃ§in Ã¶nemlidir ve Spectre benzeri saldÄ±rÄ± riskini Ã¶nemli Ã¶lÃ§Ã¼de azaltÄ±r. Bunlar, Ã§apraz kaynak kaynaklarÄ±nÄ±n yÃ¼klenmesini ve Ã§apraz kaynak pencereleriyle etkileÅŸimi kontrol eder.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

Son olarak, HSTS, tarayÄ±cÄ±larÄ± yalnÄ±zca gÃ¼venli HTTPS baÄŸlantÄ±larÄ± Ã¼zerinden sunucularla iletiÅŸim kurmaya zorlayan bir gÃ¼venlik Ã¶zelliÄŸidir, bÃ¶ylece gizlilik ve gÃ¼venlik artÄ±rÄ±lÄ±r.
```
Strict-Transport-Security: max-age=3153600
```
## Referanslar

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
