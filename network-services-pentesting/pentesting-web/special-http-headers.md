# Ã–zel HTTP baÅŸlÄ±klarÄ±

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi takip edin** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n,** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Kelime Listeleri & AraÃ§lar

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/Web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/Web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## Konumu DeÄŸiÅŸtirmek iÃ§in BaÅŸlÄ±klar

**IP kaynaÄŸÄ±nÄ±** yeniden yazÄ±n:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Hop-by-hop baÅŸlÄ±klarÄ±nÄ± kontrol edin)

**konumu** yeniden yazÄ±n:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## Hop-by-Hop baÅŸlÄ±klarÄ±

Bir hop-by-hop baÅŸlÄ±ÄŸÄ±, isteÄŸi ÅŸu anda iÅŸleyen proxy tarafÄ±ndan iÅŸlenmek ve tÃ¼ketilmek Ã¼zere tasarlanmÄ±ÅŸ bir baÅŸlÄ±ktÄ±r, uÃ§tan uca baÅŸlÄ±k yerine.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP Ä°stek KaÃ§Ä±rma

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## Ã–nbellek BaÅŸlÄ±klarÄ±

**Sunucu Ã–nbellek BaÅŸlÄ±klarÄ±**:

* **`X-Cache`** yanÄ±tÄ±nda, istek Ã¶nbelleÄŸe alÄ±nmadÄ±ÄŸÄ±nda **`miss`** deÄŸeri ve Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nda **`hit`** deÄŸeri olabilir
* **`Cf-Cache-Status`** baÅŸlÄ±ÄŸÄ±nda benzer bir davranÄ±ÅŸ
* **`Cache-Control`** bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± ve bir sonraki Ã¶nbelleÄŸe alma zamanÄ±nÄ± belirtir: `Cache-Control: public, max-age=1800`
* **`Vary`** genellikle yanÄ±t iÃ§inde, normalde anahtarlanmamÄ±ÅŸ olsalar bile **Ã¶nbellek anahtarÄ±nÄ±n** bir parÃ§asÄ± olarak kabul edilen **ek baÅŸlÄ±kleri** belirtmek iÃ§in kullanÄ±lÄ±r.
* **`Age`** nesnenin proxy Ã¶nbelleÄŸinde kaÃ§ saniye kaldÄ±ÄŸÄ±nÄ± tanÄ±mlar.
* **`Server-Timing: cdn-cache; desc=HIT`** ayrÄ±ca bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±nÄ± gÃ¶sterir

{% content-ref url="../../pentesting-web/cache-deception/" %}
[cache-deception](../../pentesting-web/cache-deception/)
{% endcontent-ref %}

**Yerel Ã–nbellek baÅŸlÄ±klarÄ±**:

* `Clear-Site-Data`: Silinmesi gereken Ã¶nbelleÄŸi belirtmek iÃ§in baÅŸlÄ±k: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: YanÄ±tÄ±n ne zaman sona ereceÄŸini iÃ§eren tarih/saat: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` `Cache-Control: no-cache` ile aynÄ±
* `Warning`: **`Warning`** genel HTTP baÅŸlÄ±ÄŸÄ±, mesajÄ±n durumu ile ilgili olasÄ± sorunlar hakkÄ±nda bilgi iÃ§erir. YanÄ±t iÃ§inde birden fazla `Warning` baÅŸlÄ±ÄŸÄ± gÃ¶rÃ¼nebilir. `Warning: 110 anderson/1.3.37 "Response is stale"`

## KoÅŸullu Ä°stekler

* Bu baÅŸlÄ±klarÄ± kullanan istekler: **`If-Modified-Since`** ve **`If-Unmodified-Since`** yalnÄ±zca yanÄ±t baÅŸlÄ±ÄŸÄ±\*\*`Last-Modified`\*\* farklÄ± bir zaman iÃ§eriyorsa veri ile yanÄ±tlanÄ±r.
* **`If-Match`** ve **`If-None-Match`** kullanan koÅŸullu istekler, web sunucusunun yanÄ±t iÃ§eriÄŸini gÃ¶ndermesi iÃ§in bir Etag deÄŸeri kullanÄ±r, eÄŸer veri (Etag) deÄŸiÅŸtiyse. `Etag`, HTTP yanÄ±tÄ±ndan alÄ±nÄ±r.
* **Etag** deÄŸeri genellikle yanÄ±tÄ±n **iÃ§eriÄŸine** dayalÄ± olarak **hesaplanÄ±r**. Ã–rneÄŸin, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` ifadesi, `Etag`'Ä±n **37 bayt**'Ä±n **Sha1**'Ä± olduÄŸunu gÃ¶sterir.

## AralÄ±k Ä°stekleri

* **`Accept-Ranges`**: Sunucunun aralÄ±k isteklerini destekleyip desteklemediÄŸini ve destekliyorsa aralÄ±ÄŸÄ±n hangi birimde ifade edilebileceÄŸini belirtir. `Accept-Ranges: <range-unit>`
* **`Range`**: Sunucunun dÃ¶ndÃ¼rmesi gereken belgenin kÄ±smÄ±nÄ± belirtir.
* **`If-Range`**: Verilen etag veya tarih uzaktan kaynakla eÅŸleÅŸirse yalnÄ±zca yerine getirilen koÅŸullu bir aralÄ±k isteÄŸi oluÅŸturur. KaynaÄŸÄ±n uyumsuz sÃ¼rÃ¼mlerinden iki aralÄ±k indirmeyi Ã¶nlemek iÃ§in kullanÄ±lÄ±r.
* **`Content-Range`**: Tam bir gÃ¶vde mesajÄ±nda bir kÄ±smi mesajÄ±n nerede yer aldÄ±ÄŸÄ±nÄ± belirtir.

## Mesaj gÃ¶vdesi bilgileri

* **`Content-Length`:** KaynaÄŸÄ±n boyutu, ondalÄ±k sayÄ± olarak bayt cinsinden.
* **`Content-Type`**: KaynaÄŸÄ±n medya tÃ¼rÃ¼nÃ¼ belirtir
* **`Content-Encoding`**: SÄ±kÄ±ÅŸtÄ±rma algoritmasÄ±nÄ± belirtmek iÃ§in kullanÄ±lÄ±r.
* **`Content-Language`**: Hedef kitle iÃ§in tasarlanmÄ±ÅŸ insan dili(leri)ni tanÄ±mlar, bÃ¶ylece kullanÄ±cÄ±larÄ±n kendi tercih ettikleri dile gÃ¶re ayÄ±rt etmelerine olanak tanÄ±r.
* **`Content-Location`**: DÃ¶ndÃ¼rÃ¼len veriler iÃ§in alternatif bir konumu belirtir.

Bir pentest aÃ§Ä±sÄ±ndan bu bilgi genellikle "iÅŸe yaramaz", ancak kaynak **401** veya **403** ile **korunuyorsa** ve bu **bilgiyi** **almanÄ±n** bir **yolunu** bulursanÄ±z, bu **ilginÃ§** olabilir.\
Ã–rneÄŸin, bir HEAD isteÄŸindeki **`Range`** ve **`Etag`** kombinasyonu, HEAD istekleri aracÄ±lÄ±ÄŸÄ±yla sayfanÄ±n iÃ§eriÄŸini sÄ±zdÄ±rabilir:

* `Range: bytes=20-20` baÅŸlÄ±ÄŸÄ±na sahip bir istek ve `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"` iÃ§eren bir yanÄ±t, 20. baytÄ±n SHA1'inin `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y` olduÄŸunu sÄ±zdÄ±rmaktadÄ±r.

## Sunucu Bilgisi

* `Server: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## Kontroller

* **`Allow`**: Bu baÅŸlÄ±k, bir kaynaÄŸÄ±n iÅŸleyebileceÄŸi HTTP yÃ¶ntemlerini iletmek iÃ§in kullanÄ±lÄ±r. Ã–rneÄŸin, `Allow: GET, POST, HEAD` olarak belirtilmiÅŸse, kaynak bu yÃ¶ntemleri destekliyor demektir.
* **`Expect`**: Ä°steÄŸin baÅŸarÄ±lÄ± bir ÅŸekilde iÅŸlenmesi iÃ§in sunucunun karÅŸÄ±lamasÄ± gereken beklentileri iletmek iÃ§in istemci tarafÄ±ndan kullanÄ±lÄ±r. YaygÄ±n bir kullanÄ±m durumu, istemcinin bÃ¼yÃ¼k bir veri yÃ¼kÃ¼ gÃ¶ndermeyi planladÄ±ÄŸÄ±nÄ± belirten `Expect: 100-continue` baÅŸlÄ±ÄŸÄ±dÄ±r. Ä°stemci, iletimi sÃ¼rdÃ¼rmeden Ã¶nce `100 (Continue)` yanÄ±tÄ±nÄ± bekler. Bu mekanizma, sunucu onayÄ±nÄ± bekleyerek aÄŸ kullanÄ±mÄ±nÄ± optimize etmeye yardÄ±mcÄ± olur.

## Ä°ndirmeler

* HTTP yanÄ±tlarÄ±ndaki **`Content-Disposition`** baÅŸlÄ±ÄŸÄ±, bir dosyanÄ±n **inline** (web sayfasÄ± iÃ§inde) mi yoksa **ek** (indirilmiÅŸ) olarak mÄ± gÃ¶rÃ¼ntÃ¼lenmesi gerektiÄŸini yÃ¶nlendirir. Ã–rneÄŸin:
```
Content-Disposition: attachment; filename="filename.jpg"
```
Bu, "filename.jpg" adlÄ± dosyanÄ±n indirilip kaydedilmek Ã¼zere tasarlandÄ±ÄŸÄ± anlamÄ±na gelir.

## GÃ¼venlik BaÅŸlÄ±klarÄ±

### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **GÃ¼venilir TÃ¼rler**

CSP aracÄ±lÄ±ÄŸÄ±yla GÃ¼venilir TÃ¼rlerin uygulanmasÄ±yla, uygulamalar DOM XSS saldÄ±rÄ±larÄ±na karÅŸÄ± korunabilir. GÃ¼venilir TÃ¼rler, yalnÄ±zca belirli gÃ¼venlik politikalarÄ±na uygun olarak hazÄ±rlanmÄ±ÅŸ nesnelerin tehlikeli web API Ã§aÄŸrÄ±larÄ±nda kullanÄ±lmasÄ±nÄ± saÄŸlar ve bÃ¶ylece JavaScript kodunu varsayÄ±lan olarak gÃ¼vence altÄ±na alÄ±r.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

Bu baÅŸlÄ±k, XSS zafiyetlerine yol aÃ§abilecek bir uygulama olan MIME tÃ¼rÃ¼ koklamayÄ± Ã¶nler. TarayÄ±cÄ±larÄ±n sunucu tarafÄ±ndan belirtilen MIME tÃ¼rlerine saygÄ± gÃ¶stermesini saÄŸlar.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

Clickjacking ile mÃ¼cadele etmek iÃ§in, bu baÅŸlÄ±k belgelerin `<frame>`, `<iframe>`, `<embed>` veya `<object>` etiketlerinde nasÄ±l gÃ¶mÃ¼lebileceÄŸini kÄ±sÄ±tlar ve tÃ¼m belgelerin gÃ¶mme izinlerini aÃ§Ä±kÃ§a belirtmesini Ã¶nerir.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) ve Cross-Origin Resource Sharing (CORS)**

CORP, hangi kaynaklarÄ±n web siteleri tarafÄ±ndan yÃ¼klenebileceÄŸini belirlemek iÃ§in kritik Ã¶neme sahiptir ve cross-site leak'lerini azaltÄ±r. CORS ise, belirli koÅŸullar altÄ±nda aynÄ± kÃ¶ken politikasÄ±nÄ± gevÅŸeterek daha esnek bir cross-origin resource sharing mekanizmasÄ± saÄŸlar.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **Cross-Origin Embedder Policy (COEP) ve Cross-Origin Opener Policy (COOP)**

COEP ve COOP, cross-origin izolasyonunu saÄŸlamak iÃ§in gereklidir ve Spectre benzeri saldÄ±rÄ±larÄ±n riskini Ã¶nemli Ã¶lÃ§Ã¼de azaltÄ±r. SÄ±rasÄ±yla, cross-origin kaynaklarÄ±n yÃ¼klenmesini ve cross-origin pencerelerle etkileÅŸimi kontrol eder.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

Son olarak, HSTS, tarayÄ±cÄ±larÄ±n yalnÄ±zca gÃ¼venli HTTPS baÄŸlantÄ±larÄ± Ã¼zerinden sunucularla iletiÅŸim kurmasÄ±nÄ± zorlayan bir gÃ¼venlik Ã¶zelliÄŸidir ve bÃ¶ylece gizliliÄŸi ve gÃ¼venliÄŸi artÄ±rÄ±r.
```
Strict-Transport-Security: max-age=3153600
```
## Referanslar

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
