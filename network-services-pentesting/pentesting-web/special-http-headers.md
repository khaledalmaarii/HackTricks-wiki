# Posebni HTTP zaglavlja

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Liste reÄi i alati

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## Zaglavlja za promenu lokacije

Preusmeravanje **IP adrese izvora**:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Proverite zaglavlja hop-by-hop)

Preusmeravanje **lokacije**:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## Hop-by-Hop zaglavlja

Hop-by-Hop zaglavlje je zaglavlje koje je dizajnirano da bude obraÄ‘eno i koriÅ¡Ä‡eno od strane proksi servera koji trenutno obraÄ‘uje zahtev, za razliku od end-to-end zaglavlja.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## Hakovanje HTTP zahteva

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## Zaglavlja keÅ¡iranja

**Zaglavlja keÅ¡a servera**:

* **`X-Cache`** u odgovoru moÅ¾e imati vrednost **`miss`** kada zahtev nije keÅ¡iran i vrednost **`hit`** kada jeste
* SliÄno ponaÅ¡anje u zaglavlju **`Cf-Cache-Status`**
* **`Cache-Control`** ukazuje da li se resurs keÅ¡ira i kada Ä‡e sledeÄ‡i put biti keÅ¡iran ponovo: `Cache-Control: public, max-age=1800`
* **`Vary`** se Äesto koristi u odgovoru da **ukazuje na dodatna zaglavlja** koja se tretiraju kao **deo kljuÄa keÅ¡a** Äak i ako obiÄno nisu kljuÄna.
* **`Age`** definiÅ¡e vreme u sekundama koliko je objekat bio u keÅ¡u proksija.
* **`Server-Timing: cdn-cache; desc=HIT`** takoÄ‘e ukazuje da je resurs bio keÅ¡iran

{% content-ref url="../../pentesting-web/cache-deception.md" %}
[cache-deception.md](../../pentesting-web/cache-deception.md)
{% endcontent-ref %}

**Lokalna zaglavlja keÅ¡a**:

* `Clear-Site-Data`: Zaglavlje koje ukazuje na keÅ¡ koji treba ukloniti: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: SadrÅ¾i datum/vreme kada bi odgovor trebalo da istekne: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` isto kao `Cache-Control: no-cache`
* `Warning`: **`Warning`** opÅ¡te HTTP zaglavlje sadrÅ¾i informacije o moguÄ‡im problemima sa statusom poruke. ViÅ¡e od jednog `Warning` zaglavlja moÅ¾e se pojaviti u odgovoru. `Warning: 110 anderson/1.3.37 "Response is stale"`

## Uslovi

* Zahtevi koji koriste ova zaglavlja: **`If-Modified-Since`** i **`If-Unmodified-Since`** Ä‡e dobiti odgovor samo ako zaglavlje odgovora\*\*`Last-Modified`\*\* sadrÅ¾i drugaÄije vreme.
* Uslovni zahtevi koji koriste **`If-Match`** i **`If-None-Match`** koriste vrednost Etag tako da Ä‡e veb server poslati sadrÅ¾aj odgovora ako su podaci (Etag) promenjeni. `Etag` se uzima iz HTTP odgovora.
* Vrednost **Etag** se obiÄno **raÄuna na osnovu** sadrÅ¾aja odgovora. Na primer, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` ukazuje da je `Etag` **Sha1** od **37 bajtova**.

## Zahtevi opsega

* **`Accept-Ranges`**: Ukazuje da li server podrÅ¾ava zahteve opsega, i ako podrÅ¾ava, u kojoj jedinici se opseg moÅ¾e izraziti. `Accept-Ranges: <range-unit>`
* **`Range`**: Ukazuje deo dokumenta koji server treba da vrati.
* **`If-Range`**: Kreira uslovni zahtev opsega koji se ispunjava samo ako dati etag ili datum odgovara udaljenom resursu. Koristi se da spreÄi preuzimanje dva opsega sa nekompatibilne verzije resursa.
* **`Content-Range`**: Ukazuje gde u celom telu poruke delimiÄna poruka pripada.

## Informacije o telu poruke

* **`Content-Length`:** VeliÄina resursa, u decimalnom broju bajtova.
* **`Content-Type`**: Ukazuje na tip medija resursa
* **`Content-Encoding`**: Koristi se za specificiranje algoritma kompresije.
* **`Content-Language`**: Opisuje ljudski jezik(e) namenjen publiku, tako da korisnik moÅ¾e da razlikuje prema sopstvenom preferiranom jeziku.
* **`Content-Location`**: Ukazuje na alternativnu lokaciju za vraÄ‡ene podatke.

Sa stanoviÅ¡ta pentesta, ove informacije su obiÄno "beskorisne", ali ako je resurs **zaÅ¡tiÄ‡en** sa 401 ili 403 i moÅ¾ete pronaÄ‡i neki **naÄin** da **dobijete** ove **informacije**, to bi moglo biti **interesantno.**\
Na primer, kombinacija **`Range`** i **`Etag`** u HEAD zahtevu moÅ¾e otkriti sadrÅ¾aj stranice putem HEAD zahteva:

* Zahtev sa zaglavljem `Range: bytes=20-20` i sa odgovorom koji sadrÅ¾i `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"` otkriva da je SHA1 bajta 20 `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y`
## Informacije o serveru

* `Server: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## Kontrole

* **`Allow`**: Ovaj zaglavlje se koristi za komunikaciju HTTP metoda koje resurs moÅ¾e obraditi. Na primer, moÅ¾e biti navedeno kao `Allow: GET, POST, HEAD`, Å¡to ukazuje da resurs podrÅ¾ava ove metode.
* **`Expect`**: Koristi se od strane klijenta da prenese oÄekivanja koja server treba da ispuni da bi zahtev bio uspeÅ¡no obraÄ‘en. ÄŒest sluÄaj upotrebe ukljuÄuje zaglavlje `Expect: 100-continue`, koje signalizira da klijent namerava poslati veliki podatkovni paket. Klijent traÅ¾i odgovor `100 (Continue)` pre nastavka sa prenosom. Ovaj mehanizam pomaÅ¾e u optimizaciji koriÅ¡Ä‡enja mreÅ¾e ÄekajuÄ‡i potvrdu servera.

## Preuzimanja

* Zaglavlje **`Content-Disposition`** u HTTP odgovorima usmerava da li bi fajl trebalo da bude prikazan **inline** (unutar veb stranice) ili tretiran kao **attachment** (preuzet). Na primer:
```
Content-Disposition: attachment; filename="filename.jpg"
```
Ovo znaÄi da je datoteka nazvana "filename.jpg" namenjena za preuzimanje i Äuvanje.

## Bezbednosni zaglavlja

### Politika bezbednosti sadrÅ¾aja (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **Povereni tipovi**

Primjenom Poverenih tipova putem CSP-a, aplikacije mogu biti zaÅ¡tiÄ‡ene od DOM XSS napada. Povereni tipovi osiguravaju da samo specifiÄno oblikovani objekti, u skladu sa uspostavljenim bezbednosnim politikama, mogu biti koriÅ¡Ä‡eni u opasnim pozivima web API-ja, Äime se podrazumevano obezbeÄ‘uje JavaScript kod.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

Ovaj zaglavlje spreÄava MIME tip sniffing, praksu koja moÅ¾e dovesti do XSS ranjivosti. Osigurava da pretraÅ¾ivaÄi poÅ¡tuju MIME tipove navedene od strane servera.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

Da bi se borili protiv clickjacking-a, ovaj zaglavlje ograniÄava naÄin na koji dokumenti mogu biti ugraÄ‘eni u `<frame>`, `<iframe>`, `<embed>`, ili `<object>` oznake, preporuÄujuÄ‡i svim dokumentima da eksplicitno specificiraju svoja dozvola za ugraÄ‘ivanje.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) i Cross-Origin Resource Sharing (CORS)**

CORP je kljuÄan za odreÄ‘ivanje koje resurse mogu biti uÄitani od strane veb sajtova, Äime se umanjuju prekograniÄni propusti. CORS, s druge strane, omoguÄ‡ava fleksibilniji mehanizam deljenja resursa preko razliÄitih porekla, opuÅ¡tajuÄ‡i politiku istog porekla pod odreÄ‘enim uslovima.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **Cross-Origin Embedder Policy (COEP) i Cross-Origin Opener Policy (COOP)**

COEP i COOP su kljuÄni za omoguÄ‡avanje izolacije preko razliÄitih izvora, znaÄajno smanjujuÄ‡i rizik od napada sliÄnih Spectre-u. Oni kontroliÅ¡u uÄitavanje resursa sa razliÄitih izvora i interakciju sa prozorima sa razliÄitih izvora, redom.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

Na kraju, HSTS je sigurnosna funkcija koja prisiljava pretraÅ¾ivaÄe da komuniciraju sa serverima samo preko sigurnih HTTPS veza, Äime se poboljÅ¡ava privatnost i sigurnost.
```
Strict-Transport-Security: max-age=3153600
```
## Reference

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
