# åŸºæœ¬Tomcatä¿¡æ¯

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

### é¿å…ä»¥rootèº«ä»½è¿è¡Œ

ä¸ºäº†ä¸ä»¥rootèº«ä»½è¿è¡ŒTomcatï¼Œä¸€ä¸ªéå¸¸å¸¸è§çš„é…ç½®æ˜¯åœ¨ç«¯å£80/443ä¸Šè®¾ç½®ä¸€ä¸ªApacheæœåŠ¡å™¨ï¼Œå¦‚æœè¯·æ±‚çš„è·¯å¾„ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œåˆ™å°†è¯·æ±‚å‘é€åˆ°åœ¨ä¸åŒç«¯å£ä¸Šè¿è¡Œçš„Tomcatã€‚

### é»˜è®¤ç»“æ„
```
â”œâ”€â”€ bin
â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ catalina.policy
â”‚   â”œâ”€â”€ catalina.properties
â”‚   â”œâ”€â”€ context.xml
â”‚   â”œâ”€â”€ tomcat-users.xml
â”‚   â”œâ”€â”€ tomcat-users.xsd
â”‚   â””â”€â”€ web.xml
â”œâ”€â”€ lib
â”œâ”€â”€ logs
â”œâ”€â”€ temp
â”œâ”€â”€ webapps
â”‚   â”œâ”€â”€ manager
â”‚   â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”œâ”€â”€ META-INF
â”‚   â”‚   â””â”€â”€ WEB-INF
|   |       â””â”€â”€ web.xml
â”‚   â””â”€â”€ ROOT
â”‚       â””â”€â”€ WEB-INF
â””â”€â”€ work
â””â”€â”€ Catalina
â””â”€â”€ localhost
```
* `WEB-INF` folder: This folder contains the configuration files and classes specific to the web application.
* `META-INF` folder: This folder contains the metadata files for the web application.
* `index.html` or `index.jsp` file: This file is the default landing page for the web application.
* Other files and folders specific to the web application.

---

* `bin` æ–‡ä»¶å¤¹å­˜å‚¨å¯åŠ¨å’Œè¿è¡Œ Tomcat æœåŠ¡å™¨æ‰€éœ€çš„è„šæœ¬å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚
* `conf` æ–‡ä»¶å¤¹å­˜å‚¨ Tomcat ä½¿ç”¨çš„å„ç§é…ç½®æ–‡ä»¶ã€‚
* `tomcat-users.xml` æ–‡ä»¶å­˜å‚¨ç”¨æˆ·å‡­æ®åŠå…¶åˆ†é…çš„è§’è‰²ã€‚
* `lib` æ–‡ä»¶å¤¹ä¿å­˜äº†æ­£ç¡®è¿è¡Œ Tomcat æ‰€éœ€çš„å„ç§ JAR æ–‡ä»¶ã€‚
* `logs` å’Œ `temp` æ–‡ä»¶å¤¹å­˜å‚¨ä¸´æ—¶æ—¥å¿—æ–‡ä»¶ã€‚
* `webapps` æ–‡ä»¶å¤¹æ˜¯ Tomcat çš„é»˜è®¤ Web æ ¹ç›®å½•ï¼Œæ‰˜ç®¡æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚`work` æ–‡ä»¶å¤¹å……å½“ç¼“å­˜ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶å­˜å‚¨æ•°æ®ã€‚

`webapps` å†…çš„æ¯ä¸ªæ–‡ä»¶å¤¹éƒ½åº”å…·æœ‰ä»¥ä¸‹ç»“æ„ã€‚

---

* `WEB-INF` æ–‡ä»¶å¤¹ï¼šè¯¥æ–‡ä»¶å¤¹åŒ…å«ç‰¹å®šäº Web åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶å’Œç±»ã€‚
* `META-INF` æ–‡ä»¶å¤¹ï¼šè¯¥æ–‡ä»¶å¤¹åŒ…å« Web åº”ç”¨ç¨‹åºçš„å…ƒæ•°æ®æ–‡ä»¶ã€‚
* `index.html` æˆ– `index.jsp` æ–‡ä»¶ï¼šè¯¥æ–‡ä»¶æ˜¯ Web åº”ç”¨ç¨‹åºçš„é»˜è®¤èµ·å§‹é¡µé¢ã€‚
* å…¶ä»–ç‰¹å®šäº Web åº”ç”¨ç¨‹åºçš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
```
webapps/customapp
â”œâ”€â”€ images
â”œâ”€â”€ index.jsp
â”œâ”€â”€ META-INF
â”‚   â””â”€â”€ context.xml
â”œâ”€â”€ status.xsd
â””â”€â”€ WEB-INF
â”œâ”€â”€ jsp
|   â””â”€â”€ admin.jsp
â””â”€â”€ web.xml
â””â”€â”€ lib
|    â””â”€â”€ jdbc_drivers.jar
â””â”€â”€ classes
â””â”€â”€ AdminServlet.class
```
æœ€é‡è¦çš„æ–‡ä»¶ä¹‹ä¸€æ˜¯`WEB-INF/web.xml`ï¼Œå®ƒè¢«ç§°ä¸ºéƒ¨ç½²æè¿°ç¬¦ã€‚è¯¥æ–‡ä»¶å­˜å‚¨äº†åº”ç”¨ç¨‹åºä½¿ç”¨çš„è·¯ç”±ä¿¡æ¯ä»¥åŠå¤„ç†è¿™äº›è·¯ç”±çš„ç±»ã€‚\
åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰ç¼–è¯‘ç±»éƒ½åº”å­˜å‚¨åœ¨`WEB-INF/classes`æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›ç±»å¯èƒ½åŒ…å«é‡è¦çš„ä¸šåŠ¡é€»è¾‘å’Œæ•æ„Ÿä¿¡æ¯ã€‚è¿™äº›æ–‡ä»¶ä¸­çš„ä»»ä½•æ¼æ´éƒ½å¯èƒ½å¯¼è‡´ç½‘ç«™å®Œå…¨è¢«æ”»å‡»ã€‚`lib`æ–‡ä»¶å¤¹å­˜å‚¨äº†è¯¥ç‰¹å®šåº”ç”¨ç¨‹åºæ‰€éœ€çš„åº“ã€‚`jsp`æ–‡ä»¶å¤¹å­˜å‚¨äº†[Jakarta Server Pages (JSP)](https://en.wikipedia.org/wiki/Jakarta\_Server\_Pages)ï¼Œä»¥å‰ç§°ä¸º`JavaServer Pages`ï¼Œå¯ä»¥ä¸ApacheæœåŠ¡å™¨ä¸Šçš„PHPæ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹**web.xml**æ–‡ä»¶ã€‚
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>
<servlet>
<servlet-name>AdminServlet</servlet-name>
<servlet-class>com.inlanefreight.api.AdminServlet</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>AdminServlet</servlet-name>
<url-pattern>/admin</url-pattern>
</servlet-mapping>
</web-app>
```
ä¸Šé¢çš„`web.xml`é…ç½®å®šä¹‰äº†ä¸€ä¸ªåä¸º`AdminServlet`çš„æ–°servletï¼Œå®ƒæ˜ å°„åˆ°`com.inlanefreight.api.AdminServlet`ç±»ã€‚Javaä½¿ç”¨ç‚¹ç¬¦å·æ¥åˆ›å»ºåŒ…åï¼Œè¿™æ„å‘³ç€ä¸Šé¢å®šä¹‰çš„ç±»åœ¨ç£ç›˜ä¸Šçš„è·¯å¾„å°†æ˜¯ï¼š

* `classes/com/inlanefreight/api/AdminServlet.class`

æ¥ä¸‹æ¥ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„servletæ˜ å°„ï¼Œå°†è¯·æ±‚æ˜ å°„åˆ°`/admin`å¹¶ä½¿ç”¨`AdminServlet`å¤„ç†ã€‚è¿™ä¸ªé…ç½®å°†æŠŠä»»ä½•æ¥æ”¶åˆ°çš„`/admin`è¯·æ±‚å‘é€åˆ°`AdminServlet.class`ç±»è¿›è¡Œå¤„ç†ã€‚`web.xml`æè¿°ç¬¦åŒ…å«äº†å¾ˆå¤šæ•æ„Ÿä¿¡æ¯ï¼Œæ˜¯åœ¨åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´æ—¶éœ€è¦æ£€æŸ¥çš„é‡è¦æ–‡ä»¶ã€‚

### tomcat-users

`tomcat-users.xml`æ–‡ä»¶ç”¨äºå…è®¸æˆ–ç¦æ­¢è®¿é—®`/manager`å’Œ`host-manager`ç®¡ç†é¡µé¢ã€‚
```xml
<?xml version="1.0" encoding="UTF-8"?>

<SNIP>

<tomcat-users xmlns="http://tomcat.apache.org/xml"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
version="1.0">
<!--
By default, no user is included in the "manager-gui" role required
to operate the "/manager/html" web application.  If you wish to use this app,
you must define such a user - the username and password are arbitrary.

Built-in Tomcat manager roles:
- manager-gui    - allows access to the HTML GUI and the status pages
- manager-script - allows access to the HTTP API and the status pages
- manager-jmx    - allows access to the JMX proxy and the status pages
- manager-status - allows access to the status pages only

The users below are wrapped in a comment and are therefore ignored. If you
wish to configure one or more of these users for use with the manager web
application, do not forget to remove the <!.. ..> that surrounds them. You
will also need to set the passwords to something appropriate.
-->


<SNIP>

!-- user manager can access only manager section -->
<role rolename="manager-gui" />
<user username="tomcat" password="tomcat" roles="manager-gui" />

<!-- user admin can access manager and admin section both -->
<role rolename="admin-gui" />
<user username="admin" password="admin" roles="manager-gui,admin-gui" />


</tomcat-users>
```
è¯¥æ–‡ä»¶æ˜¾ç¤ºäº†æ¯ä¸ªè§’è‰²`manager-gui`ï¼Œ`manager-script`ï¼Œ`manager-jmx`å’Œ`manager-status`æä¾›çš„è®¿é—®æƒé™ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸º`tomcat`çš„ç”¨æˆ·å…·æœ‰å¯†ç `tomcat`å’Œ`manager-gui`è§’è‰²ï¼Œè€Œç”¨æˆ·è´¦æˆ·`admin`è®¾ç½®äº†ç¬¬äºŒä¸ªå¼±å¯†ç `admin`ã€‚

## å‚è€ƒèµ„æ–™

* [https://academy.hackthebox.com/module/113/section/1090](https://academy.hackthebox.com/module/113/section/1090)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
