# Basic Tomcat Info

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

### é¿å…ä»¥ root èº«ä»½è¿è¡Œ

ä¸ºäº†ä¸ä»¥ root èº«ä»½è¿è¡Œ Tomcatï¼Œä¸€ä¸ªéå¸¸å¸¸è§çš„é…ç½®æ˜¯åœ¨ 80/443 ç«¯å£ä¸Šè®¾ç½® Apache æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¦‚æœè¯·æ±‚è·¯å¾„ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œè¯·æ±‚å°†è¢«å‘é€åˆ°è¿è¡Œåœ¨ä¸åŒç«¯å£ä¸Šçš„ Tomcatã€‚

### é»˜è®¤ç»“æ„
```
â”œâ”€â”€ bin
â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ catalina.policy
â”‚   â”œâ”€â”€ catalina.properties
â”‚   â”œâ”€â”€ context.xml
â”‚   â”œâ”€â”€ tomcat-users.xml
â”‚   â”œâ”€â”€ tomcat-users.xsd
â”‚   â””â”€â”€ web.xml
â”œâ”€â”€ lib
â”œâ”€â”€ logs
â”œâ”€â”€ temp
â”œâ”€â”€ webapps
â”‚   â”œâ”€â”€ manager
â”‚   â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”œâ”€â”€ META-INF
â”‚   â”‚   â””â”€â”€ WEB-INF
|   |       â””â”€â”€ web.xml
â”‚   â””â”€â”€ ROOT
â”‚       â””â”€â”€ WEB-INF
â””â”€â”€ work
â””â”€â”€ Catalina
â””â”€â”€ localhost
```
* `bin` æ–‡ä»¶å¤¹å­˜å‚¨å¯åŠ¨å’Œè¿è¡Œ Tomcat æœåŠ¡å™¨æ‰€éœ€çš„è„šæœ¬å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚
* `conf` æ–‡ä»¶å¤¹å­˜å‚¨ Tomcat ä½¿ç”¨çš„å„ç§é…ç½®æ–‡ä»¶ã€‚
* `tomcat-users.xml` æ–‡ä»¶å­˜å‚¨ç”¨æˆ·å‡­æ®åŠå…¶åˆ†é…çš„è§’è‰²ã€‚
* `lib` æ–‡ä»¶å¤¹åŒ…å« Tomcat æ­£å¸¸è¿è¡Œæ‰€éœ€çš„å„ç§ JAR æ–‡ä»¶ã€‚
* `logs` å’Œ `temp` æ–‡ä»¶å¤¹å­˜å‚¨ä¸´æ—¶æ—¥å¿—æ–‡ä»¶ã€‚
* `webapps` æ–‡ä»¶å¤¹æ˜¯ Tomcat çš„é»˜è®¤ç½‘é¡µæ ¹ç›®å½•ï¼Œæ‰˜ç®¡æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚`work` æ–‡ä»¶å¤¹å……å½“ç¼“å­˜ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶å­˜å‚¨æ•°æ®ã€‚

`webapps` å†…éƒ¨çš„æ¯ä¸ªæ–‡ä»¶å¤¹é¢„è®¡å…·æœ‰ä»¥ä¸‹ç»“æ„ã€‚
```
webapps/customapp
â”œâ”€â”€ images
â”œâ”€â”€ index.jsp
â”œâ”€â”€ META-INF
â”‚   â””â”€â”€ context.xml
â”œâ”€â”€ status.xsd
â””â”€â”€ WEB-INF
â”œâ”€â”€ jsp
|   â””â”€â”€ admin.jsp
â””â”€â”€ web.xml
â””â”€â”€ lib
|    â””â”€â”€ jdbc_drivers.jar
â””â”€â”€ classes
â””â”€â”€ AdminServlet.class
```
æœ€é‡è¦çš„æ–‡ä»¶æ˜¯ `WEB-INF/web.xml`ï¼Œå®ƒè¢«ç§°ä¸ºéƒ¨ç½²æè¿°ç¬¦ã€‚æ­¤æ–‡ä»¶å­˜å‚¨ **åº”ç”¨ç¨‹åºä½¿ç”¨çš„è·¯ç”±ä¿¡æ¯** ä»¥åŠå¤„ç†è¿™äº›è·¯ç”±çš„ç±»ã€‚\
åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ‰€æœ‰ç¼–è¯‘ç±»åº”å­˜å‚¨åœ¨ `WEB-INF/classes` æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›ç±»å¯èƒ½åŒ…å«é‡è¦çš„ä¸šåŠ¡é€»è¾‘ä»¥åŠæ•æ„Ÿä¿¡æ¯ã€‚è¿™äº›æ–‡ä»¶ä¸­çš„ä»»ä½•æ¼æ´éƒ½å¯èƒ½å¯¼è‡´ç½‘ç«™çš„å®Œå…¨å¦¥åã€‚`lib` æ–‡ä»¶å¤¹å­˜å‚¨è¯¥ç‰¹å®šåº”ç”¨ç¨‹åºæ‰€éœ€çš„åº“ã€‚`jsp` æ–‡ä»¶å¤¹å­˜å‚¨ [Jakarta Server Pages (JSP)](https://en.wikipedia.org/wiki/Jakarta\_Server\_Pages)ï¼Œä»¥å‰ç§°ä¸º `JavaServer Pages`ï¼Œå¯ä»¥ä¸ Apache æœåŠ¡å™¨ä¸Šçš„ PHP æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚

è¿™æ˜¯ä¸€ä¸ª **web.xml** æ–‡ä»¶çš„ç¤ºä¾‹ã€‚
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>
<servlet>
<servlet-name>AdminServlet</servlet-name>
<servlet-class>com.inlanefreight.api.AdminServlet</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>AdminServlet</servlet-name>
<url-pattern>/admin</url-pattern>
</servlet-mapping>
</web-app>
```
The `web.xml` é…ç½®å®šä¹‰äº†ä¸€ä¸ª **åä¸º `AdminServlet` çš„æ–° servlet**ï¼Œå®ƒæ˜ å°„åˆ° **ç±» `com.inlanefreight.api.AdminServlet`**ã€‚Java ä½¿ç”¨ç‚¹è¡¨ç¤ºæ³•æ¥åˆ›å»ºåŒ…åï¼Œè¿™æ„å‘³ç€ä¸Šè¿°å®šä¹‰çš„ç±»åœ¨ç£ç›˜ä¸Šçš„è·¯å¾„ä¸ºï¼š

* **`classes/com/inlanefreight/api/AdminServlet.class`**

æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ servlet æ˜ å°„ï¼Œä»¥ **å°†è¯·æ±‚æ˜ å°„åˆ° `/admin` ä¸ `AdminServlet`**ã€‚æ­¤é…ç½®å°†æŠŠæ”¶åˆ°çš„ä»»ä½• **`/admin`** è¯·æ±‚å‘é€åˆ° `AdminServlet.class` ç±»è¿›è¡Œå¤„ç†ã€‚ **`web.xml`** æè¿°ç¬¦åŒ…å«å¤§é‡ **æ•æ„Ÿä¿¡æ¯**ï¼Œåœ¨åˆ©ç”¨ **Local File Inclusion (LFI) æ¼æ´** æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ–‡ä»¶éœ€è¦æ£€æŸ¥ã€‚

### tomcat-users

**`tomcat-users.xml`** æ–‡ä»¶ç”¨äº **å…è®¸** æˆ–æ‹’ç»è®¿é—® **`/manager` å’Œ `host-manager` ç®¡ç†é¡µé¢**ã€‚
```xml
<?xml version="1.0" encoding="UTF-8"?>

<SNIP>

<tomcat-users xmlns="http://tomcat.apache.org/xml"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
version="1.0">
<!--
By default, no user is included in the "manager-gui" role required
to operate the "/manager/html" web application.  If you wish to use this app,
you must define such a user - the username and password are arbitrary.

Built-in Tomcat manager roles:
- manager-gui    - allows access to the HTML GUI and the status pages
- manager-script - allows access to the HTTP API and the status pages
- manager-jmx    - allows access to the JMX proxy and the status pages
- manager-status - allows access to the status pages only

The users below are wrapped in a comment and are therefore ignored. If you
wish to configure one or more of these users for use with the manager web
application, do not forget to remove the <!.. ..> that surrounds them. You
will also need to set the passwords to something appropriate.
-->


<SNIP>

!-- user manager can access only manager section -->
<role rolename="manager-gui" />
<user username="tomcat" password="tomcat" roles="manager-gui" />

<!-- user admin can access manager and admin section both -->
<role rolename="admin-gui" />
<user username="admin" password="admin" roles="manager-gui,admin-gui" />


</tomcat-users>
```
è¯¥æ–‡ä»¶å‘æˆ‘ä»¬å±•ç¤ºäº†æ¯ä¸ªè§’è‰² `manager-gui`ã€`manager-script`ã€`manager-jmx` å’Œ `manager-status` æä¾›çš„è®¿é—®æƒé™ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”¨æˆ· `tomcat` çš„å¯†ç æ˜¯ `tomcat`ï¼Œå¹¶ä¸”è¯¥ç”¨æˆ·å…·æœ‰ `manager-gui` è§’è‰²ï¼Œè€Œç”¨æˆ·è´¦æˆ· `admin` è®¾ç½®äº†ç¬¬äºŒä¸ªå¼±å¯†ç  `admin`ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://academy.hackthebox.com/module/113/section/1090](https://academy.hackthebox.com/module/113/section/1090)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
