# Uncovering CloudFlare

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Common Techniques to Uncover Cloudflare

* AlanÄ±n **tarihi DNS kayÄ±tlarÄ±nÄ±** veren bir hizmet kullanabilirsiniz. Belki web sayfasÄ± daha Ã¶nce kullanÄ±lan bir IP adresinde Ã§alÄ±ÅŸÄ±yordur.
* **Tarihi SSL sertifikalarÄ±nÄ±** kontrol ederek de aynÄ± sonuca ulaÅŸabilirsiniz; bu sertifikalar orijinal IP adresine iÅŸaret ediyor olabilir.
* AyrÄ±ca **IP'lere doÄŸrudan iÅŸaret eden diÄŸer alt alan adlarÄ±nÄ±n DNS kayÄ±tlarÄ±nÄ±** kontrol edin; diÄŸer alt alan adlarÄ±nÄ±n aynÄ± sunucuya iÅŸaret etmesi mÃ¼mkÃ¼ndÃ¼r (belki FTP, mail veya baÅŸka bir hizmet sunmak iÃ§in).
* EÄŸer web uygulamasÄ± iÃ§inde bir **SSRF bulursanÄ±z**, bunu sunucunun IP adresini elde etmek iÃ§in kÃ¶tÃ¼ye kullanabilirsiniz.
* Shodan gibi tarayÄ±cÄ±larda web sayfasÄ±nÄ±n benzersiz bir dizesini arayÄ±n (belki google ve benzerlerinde?). Belki bu iÃ§erikle bir IP adresi bulabilirsiniz.
* Benzer bir ÅŸekilde, benzersiz bir dize aramak yerine, [https://github.com/karma9874/CloudFlare-IP](https://github.com/karma9874/CloudFlare-IP) aracÄ±yla veya [https://github.com/pielco11/fav-up](https://github.com/pielco11/fav-up) ile favicon simgesini arayabilirsiniz.
* Bu Ã§ok sÄ±k Ã§alÄ±ÅŸmayacak Ã§Ã¼nkÃ¼ sunucu IP adresiyle eriÅŸildiÄŸinde aynÄ± yanÄ±tÄ± gÃ¶ndermelidir, ama asla bilemezsiniz.

## Tools to uncover Cloudflare

* Alan adÄ±nÄ± [http://www.crimeflare.org:82/cfs.html](http://www.crimeflare.org:82/cfs.html) veya [https://crimeflare.herokuapp.com](https://crimeflare.herokuapp.com) iÃ§inde arayÄ±n. Ya da [CloudPeler](https://github.com/zidansec/CloudPeler) aracÄ±nÄ± kullanÄ±n (bu API'yi kullanÄ±r).
* Alan adÄ±nÄ± [https://leaked.site/index.php?resolver/cloudflare.0/](https://leaked.site/index.php?resolver/cloudflare.0/) iÃ§inde arayÄ±n.
* [**CloudFlair**](https://github.com/christophetd/CloudFlair), alan adÄ±nÄ± iÃ§eren Censys sertifikalarÄ±nÄ± kullanarak arama yapacak bir araÃ§tÄ±r, ardÄ±ndan bu sertifikalar iÃ§indeki IPv4'leri arayacak ve nihayetinde bu IP'lerdeki web sayfasÄ±na eriÅŸmeye Ã§alÄ±ÅŸacaktÄ±r.
* [**CloakQuest3r**](https://github.com/spyboy-productions/CloakQuest3r): CloakQuest3r, Cloudflare ve diÄŸer alternatifler tarafÄ±ndan korunan web sitelerinin gerÃ§ek IP adresini ortaya Ã§Ä±karmak iÃ§in titizlikle hazÄ±rlanmÄ±ÅŸ gÃ¼Ã§lÃ¼ bir Python aracÄ±dÄ±r. Temel misyonu, Cloudflare'Ä±n koruyucu kalkanÄ±nÄ±n arkasÄ±nda gizlenmiÅŸ web sunucularÄ±nÄ±n gerÃ§ek IP adresini doÄŸru bir ÅŸekilde belirlemektir.
* [Censys](https://search.censys.io/)
* [Shodan](https://shodan.io/)
* [Bypass-firewalls-by-DNS-history](https://github.com/vincentcox/bypass-firewalls-by-DNS-history)
* Web sayfasÄ±nÄ±n bulunduÄŸu potansiyel IP'ler setine sahipseniz, [https://github.com/hakluke/hakoriginfinder](https://github.com/hakluke/hakoriginfinder) kullanabilirsiniz.
```bash
# You can check if the tool is working with
prips 1.0.0.0/30 | hakoriginfinder -h one.one.one.one

# If you know the company is using AWS you could use the previous tool to search the
## web page inside the EC2 IPs
DOMAIN=something.com
WIDE_REGION=us
for ir in `curl https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | select(.region|test("^us")) | .ip_prefix'`; do
echo "Checking $ir"
prips $ir | hakoriginfinder -h "$DOMAIN"
done
```
## Uncovering Cloudflare from Cloud infrastructure

Not edin ki bu AWS makineleri iÃ§in yapÄ±lmÄ±ÅŸ olsa da, bu herhangi bir baÅŸka bulut saÄŸlayÄ±cÄ±sÄ± iÃ§in de yapÄ±labilir.

Bu sÃ¼recin daha iyi bir tanÄ±mÄ± iÃ§in kontrol edin:

{% embed url="https://trickest.com/blog/cloudflare-bypass-discover-ip-addresses-aws/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
```bash
# Find open ports
sudo masscan --max-rate 10000 -p80,443 $(curl -s https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | .ip_prefix' | tr '\n' ' ') | grep "open"  > all_open.txt
# Format results
cat all_open.txt | sed 's,.*port \(.*\)/tcp on \(.*\),\2:\1,' | tr -d " " > all_open_formated.txt
# Search actual web pages
httpx -silent -threads 200 -l all_open_formated.txt -random-agent -follow-redirects -json -no-color -o webs.json
# Format web results and remove eternal redirects
cat webs.json | jq -r "select((.failed==false) and (.chain_status_codes | length) < 9) | .url" | sort -u > aws_webs.json

# Search via Host header
httpx -json -no-color -list aws_webs.json -header Host: cloudflare.malwareworld.com -threads 250 -random-agent -follow-redirects -o web_checks.json
```
## Cloudflare'Ä± Cloudflare ile AÅŸmak

### Kimlik DoÄŸrulamalÄ± Kaynak Ã‡ekimleri

Bu mekanizma, **Cloudflareâ€™Ä±n ters proxy** sunucularÄ± ile **kaynak** sunucusu arasÄ±ndaki baÄŸlantÄ±larÄ± **kimlik doÄŸrulamak iÃ§in** **istemci** [**SSL sertifikalarÄ±**](https://socradar.io/how-to-monitor-your-ssl-certificates-expiration-easily-and-why/) kullanÄ±r ve buna **mTLS** denir.

Kendi sertifikasÄ±nÄ± yapÄ±landÄ±rmak yerine, mÃ¼ÅŸteriler Cloudflareâ€™Ä±n sertifikasÄ±nÄ± kullanarak Cloudflare'dan gelen herhangi bir baÄŸlantÄ±ya izin verebilirler, **kiracÄ±dan baÄŸÄ±msÄ±z olarak**.

{% hint style="danger" %}
Bu nedenle, bir saldÄ±rgan sadece **Cloudflare'da bir alan adÄ± ayarlayÄ±p Cloudflare'Ä±n sertifikasÄ±nÄ± kullanarak** bunu **kurban** alan adÄ± **IP** adresine yÃ¶nlendirebilir. Bu ÅŸekilde, alan adÄ±nÄ± tamamen korumasÄ±z bÄ±rakarak, Cloudflare gÃ¶nderilen istekleri korumayacaktÄ±r.
{% endhint %}

Daha fazla bilgi [**burada**](https://socradar.io/cloudflare-protection-bypass-vulnerability-on-threat-actors-radar/).

### Cloudflare IP Adreslerini Beyaz Listeye Alma

Bu, **Cloudflareâ€™Ä±n** IP adresi aralÄ±klarÄ±ndan gelmeyen baÄŸlantÄ±larÄ± **reddedecektir**. Bu, bir saldÄ±rganÄ±n sadece **Cloudflare'da kendi alan adÄ±nÄ±** kurbanÄ±n **IP** adresine yÃ¶nlendirmesi durumunda Ã¶nceki kurulum iÃ§in de savunmasÄ±zdÄ±r.

Daha fazla bilgi [**burada**](https://socradar.io/cloudflare-protection-bypass-vulnerability-on-threat-actors-radar/).

## Scraping iÃ§in Cloudflare'Ä± AÅŸmak

### Ã–nbellek

Bazen sadece web sayfasÄ±nÄ± kazÄ±mak iÃ§in Cloudflare'Ä± aÅŸmak istersiniz. Bunun iÃ§in bazÄ± seÃ§enekler vardÄ±r:

* Google Ã¶nbelleÄŸini kullanÄ±n: `https://webcache.googleusercontent.com/search?q=cache:https://www.petsathome.com/shop/en/pets/dog`
* [https://archive.org/web/](https://archive.org/web/) gibi diÄŸer Ã¶nbellek hizmetlerini kullanÄ±n.

### AraÃ§lar

AÅŸaÄŸÄ±daki gibi bazÄ± araÃ§lar, Cloudflare'Ä±n scraping'e karÅŸÄ± korumasÄ±nÄ± aÅŸabilir (veya aÅŸabilmiÅŸtir):

* [https://github.com/sarperavci/CloudflareBypassForScraping](https://github.com/sarperavci/CloudflareBypassForScraping)

### Cloudflare Ã‡Ã¶zÃ¼cÃ¼leri

Bir dizi Cloudflare Ã§Ã¶zÃ¼cÃ¼sÃ¼ geliÅŸtirilmiÅŸtir:

* [FlareSolverr](https://github.com/FlareSolverr/FlareSolverr)
* [cloudscraper](https://github.com/VeNoMouS/cloudscraper) [Rehber burada](https://scrapeops.io/python-web-scraping-playbook/python-cloudscraper/)
* [cloudflare-scrape](https://github.com/Anorov/cloudflare-scrape)
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)
* [Cloudflare-IUAM-Solver](https://github.com/ninja-beans/cloudflare-iuam-solver)
* [cloudflare-bypass](https://github.com/devgianlu/cloudflare-bypass) \[ArÅŸivlendi]
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)

### GÃ¼Ã§lendirilmiÅŸ BaÅŸsÄ±z TarayÄ±cÄ±lar <a href="#option-4-scrape-with-fortified-headless-browsers" id="option-4-scrape-with-fortified-headless-browsers"></a>

Otomatik bir tarayÄ±cÄ± olarak algÄ±lanmayan bir baÅŸsÄ±z tarayÄ±cÄ± kullanÄ±n (bunun iÃ§in Ã¶zelleÅŸtirmeniz gerekebilir). BazÄ± seÃ§enekler:

* **Puppeteer:** [puppeteer](https://github.com/puppeteer/puppeteer) iÃ§in [gizlilik eklentisi](https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth).
* **Playwright:** [gizlilik eklentisi](https://www.npmjs.com/package/playwright-stealth) yakÄ±nda Playwright'a geliyor. GeliÅŸmeleri [burada](https://github.com/berstend/puppeteer-extra/issues/454) ve [burada](https://github.com/berstend/puppeteer-extra/tree/master/packages/playwright-extra) takip edin.
* **Selenium:** [undetected-chromedriver](https://github.com/ultrafunkamsterdam/undetected-chromedriver) optimize edilmiÅŸ bir Selenium Chromedriver yamasÄ±.

### Cloudflare YerleÅŸik Bypass ile AkÄ±llÄ± Proxy <a href="#option-5-smart-proxy-with-cloudflare-built-in-bypass" id="option-5-smart-proxy-with-cloudflare-built-in-bypass"></a>

**AkÄ±llÄ± proxyler**, Cloudflare'Ä±n gÃ¼venlik Ã¶nlemlerini aÅŸmayÄ± hedefleyen Ã¶zel ÅŸirketler tarafÄ±ndan sÃ¼rekli gÃ¼ncellenmektedir (Ã§Ã¼nkÃ¼ bu onlarÄ±n iÅŸidir).

Bunlardan bazÄ±larÄ±:

* [ScraperAPI](https://www.scraperapi.com/?fp\_ref=scrapeops)
* [Scrapingbee](https://www.scrapingbee.com/?fpr=scrapeops)
* [Oxylabs](https://oxylabs.go2cloud.org/aff\_c?offer\_id=7\&aff\_id=379\&url\_id=32)
* [Smartproxy](https://prf.hn/click/camref:1100loxdG/\[p\_id:1100l442001]/destination:https%3A%2F%2Fsmartproxy.com%2Fscraping%2Fweb) kendi Cloudflare bypass mekanizmalarÄ± ile tanÄ±nmaktadÄ±r.

Optimize edilmiÅŸ bir Ã§Ã¶zÃ¼m arayanlar iÃ§in, [ScrapeOps Proxy Aggregator](https://scrapeops.io/proxy-aggregator/) Ã¶ne Ã§Ä±kmaktadÄ±r. Bu hizmet, 20'den fazla proxy saÄŸlayÄ±cÄ±sÄ±nÄ± tek bir API'de entegre ederek, hedef alan adlarÄ±nÄ±z iÃ§in en iyi ve en maliyet etkin proxy'yi otomatik olarak seÃ§er ve bÃ¶ylece Cloudflare'Ä±n savunmalarÄ±nÄ± aÅŸmak iÃ§in Ã¼stÃ¼n bir seÃ§enek sunar.

### Cloudflare Anti-Bot KorumasÄ±nÄ± Tersine MÃ¼hendislik <a href="#option-6-reverse-engineer-cloudflare-anti-bot-protection" id="option-6-reverse-engineer-cloudflare-anti-bot-protection"></a>

Cloudflare'Ä±n anti-bot Ã¶nlemlerini tersine mÃ¼hendislik yapmak, akÄ±llÄ± proxy saÄŸlayÄ±cÄ±larÄ± tarafÄ±ndan kullanÄ±lan bir taktiktir ve Ã§ok sayÄ±da baÅŸsÄ±z tarayÄ±cÄ± Ã§alÄ±ÅŸtÄ±rmanÄ±n yÃ¼ksek maliyetinden kaÃ§Ä±narak geniÅŸ Ã§aplÄ± web scraping iÃ§in uygundur.

**Avantajlar:** Bu yÃ¶ntem, Cloudflare'Ä±n kontrollerini hedef alan son derece verimli bir bypass oluÅŸturulmasÄ±na olanak tanÄ±r, bÃ¼yÃ¼k Ã¶lÃ§ekli operasyonlar iÃ§in idealdir.

**Dezavantajlar:** DezavantajÄ±, Cloudflare'Ä±n kasÄ±tlÄ± olarak belirsiz anti-bot sistemini anlamak ve kandÄ±rmakla ilgili karmaÅŸÄ±klÄ±ktÄ±r; bu, farklÄ± stratejileri test etmek ve Cloudflare korumalarÄ±nÄ± gÃ¼Ã§lendirdikÃ§e bypass'Ä± gÃ¼ncellemek iÃ§in sÃ¼rekli Ã§aba gerektirir.

Bunu nasÄ±l yapacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in [orijinal makaleye](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/) bakÄ±n.

## Referanslar

* [https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
