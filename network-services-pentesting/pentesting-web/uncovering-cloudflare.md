# æ­ç¤ºCloudFlare

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

å°è¯•æ­ç¤ºCloudFlareåé¢çš„WebæœåŠ¡å™¨çš„æŠ€æœ¯ï¼š

### æŠ€æœ¯

* æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä¸€äº›æä¾›åŸŸåçš„**å†å²DNSè®°å½•**çš„æœåŠ¡ã€‚ä¹Ÿè®¸ç½‘é¡µæ˜¯åœ¨ä¹‹å‰ä½¿ç”¨çš„IPåœ°å€ä¸Šè¿è¡Œçš„ã€‚
* åŒæ ·å¯ä»¥é€šè¿‡**æ£€æŸ¥å†å²SSLè¯ä¹¦**æ¥å®ç°ï¼Œè¿™äº›è¯ä¹¦å¯èƒ½æŒ‡å‘åŸå§‹IPåœ°å€ã€‚
* è¿˜è¦æ£€æŸ¥**æŒ‡å‘IPåœ°å€çš„å…¶ä»–å­åŸŸåçš„DNSè®°å½•**ï¼Œå› ä¸ºå¯èƒ½æœ‰å…¶ä»–å­åŸŸåæŒ‡å‘åŒä¸€å°æœåŠ¡å™¨ï¼ˆä¹Ÿè®¸æ˜¯ä¸ºäº†æä¾›FTPã€é‚®ä»¶æˆ–å…¶ä»–æœåŠ¡ï¼‰ã€‚
* å¦‚æœåœ¨Webåº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°**SSRFæ¼æ´**ï¼Œå¯ä»¥æ»¥ç”¨å®ƒæ¥è·å–æœåŠ¡å™¨çš„IPåœ°å€ã€‚
*

åœ¨Shodanç­‰æµè§ˆå™¨ä¸­æœç´¢ç½‘é¡µçš„å”¯ä¸€å­—ç¬¦ä¸²ã€‚ä¹Ÿè®¸ä½ å¯ä»¥æ‰¾åˆ°åŒ…å«è¯¥å†…å®¹çš„IPåœ°å€ã€‚

* ç±»ä¼¼åœ°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[https://github.com/karma9874/CloudFlare-IP](https://github.com/karma9874/CloudFlare-IP)æˆ–[https://github.com/pielco11/fav-up](https://github.com/pielco11/fav-up)æœç´¢faviconå›¾æ ‡ã€‚
* è¿™ç§æ–¹æ³•ä¸ä¼šç»å¸¸èµ·ä½œç”¨ï¼Œå› ä¸ºæœåŠ¡å™¨åœ¨é€šè¿‡IPåœ°å€è®¿é—®æ—¶å¿…é¡»å‘é€ç›¸åŒçš„å“åº”ï¼Œä½†ä½ æ°¸è¿œä¸çŸ¥é“ã€‚

### å·¥å…·

* åœ¨[http://www.crimeflare.org:82/cfs.html](http://www.crimeflare.org:82/cfs.html)æˆ–[https://crimeflare.herokuapp.com](https://crimeflare.herokuapp.com)ä¸­æœç´¢åŸŸåã€‚æˆ–ä½¿ç”¨å·¥å…·[CloudPeler](https://github.com/zidansec/CloudPeler)ï¼ˆä½¿ç”¨è¯¥APIï¼‰
* åœ¨[https://leaked.site/index.php?resolver/cloudflare.0/](https://leaked.site/index.php?resolver/cloudflare.0/)ä¸­æœç´¢åŸŸå
* [**CloudFlair**](https://github.com/christophetd/CloudFlair)æ˜¯ä¸€ä¸ªä½¿ç”¨åŒ…å«åŸŸåçš„Censysè¯ä¹¦è¿›è¡Œæœç´¢ï¼Œç„¶ååœ¨è¿™äº›è¯ä¹¦ä¸­æœç´¢IPv4ï¼Œå¹¶å°è¯•åœ¨è¿™äº›IPä¸Šè®¿é—®ç½‘é¡µçš„å·¥å…·ã€‚
* [Censys](https://search.censys.io/)
* [Shodan](https://shodan.io/)
* [Bypass-firewalls-by-DNS-history](https://github.com/vincentcox/bypass-firewalls-by-DNS-history)
* å¦‚æœæ‚¨æœ‰ä¸€ç»„å¯èƒ½åŒ…å«ç½‘é¡µçš„IPåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨[https://github.com/hakluke/hakoriginfinder](https://github.com/hakluke/hakoriginfinder)
```bash
# You can check if the tool is working with
prips 1.0.0.0/30 | hakoriginfinder -h one.one.one.one

# If you know the company is using AWS you could use the previous tool to search the
## web page inside the EC2 IPs
DOMAIN=something.com
WIDE_REGION=us
for ir in `curl https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | select(.region|test("^us")) | .ip_prefix'`; do
echo "Checking $ir"
prips $ir | hakoriginfinder -h "$DOMAIN"
done
```
### ä»AWSæœºå™¨ä¸Šæ­ç¤ºCloudflare

æœ‰å…³æ­¤è¿‡ç¨‹çš„æ›´è¯¦ç»†æè¿°ï¼Œè¯·æŸ¥çœ‹ï¼š

{% embed url="https://trickest.com/blog/cloudflare-bypass-discover-ip-addresses-aws/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
```bash
# Find open ports
sudo masscan --max-rate 10000 -p80,443 $(curl -s https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | .ip_prefix' | tr '\n' ' ') | grep "open"  > all_open.txt
# Format results
cat all_open.txt | sed 's,.*port \(.*\)/tcp on \(.*\),\2:\1,' | tr -d " " > all_open_formated.txt
# Search actual web pages
httpx -silent -threads 200 -l all_open_formated.txt -random-agent -follow-redirects -json -no-color -o webs.json
# Format web results and remove eternal redirects
cat webs.json | jq -r "select((.failed==false) and (.chain_status_codes | length) < 9) | .url" | sort -u > aws_webs.json

# Search via Host header
httpx -json -no-color -list aws_webs.json -header Host: cloudflare.malwareworld.com -threads 250 -random-agent -follow-redirects -o web_checks.json
```
## ç»•è¿‡ Cloudflare è¿›è¡Œç½‘é¡µæŠ“å–

### ç¼“å­˜

æœ‰æ—¶å€™ä½ åªæƒ³ç»•è¿‡ Cloudflare è¿›è¡Œç½‘é¡µæŠ“å–ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›é€‰é¡¹ï¼š

* ä½¿ç”¨ Google ç¼“å­˜ï¼š`https://webcache.googleusercontent.com/search?q=cache:https://www.petsathome.com/shop/en/pets/dog`
* ä½¿ç”¨å…¶ä»–ç¼“å­˜æœåŠ¡ï¼Œæ¯”å¦‚ [https://archive.org/web/](https://archive.org/web/)

### Cloudflare è§£å†³æ–¹æ¡ˆ

å·²ç»å¼€å‘äº†ä¸€äº› Cloudflare è§£å†³æ–¹æ¡ˆï¼š

* [FlareSolverr](https://github.com/FlareSolverr/FlareSolverr)
* [cloudscraper](https://github.com/VeNoMouS/cloudscraper) [æŒ‡å—åœ¨è¿™é‡Œ](https://scrapeops.io/python-web-scraping-playbook/python-cloudscraper/)
* [cloudflare-scrape](https://github.com/Anorov/cloudflare-scrape)
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)
* [Cloudflare-IUAM-Solver](https://github.com/ninja-beans/cloudflare-iuam-solver)
* [cloudflare-bypass](https://github.com/devgianlu/cloudflare-bypass) \[å·²å­˜æ¡£]
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)

### å¼ºåŒ–çš„æ— å¤´æµè§ˆå™¨ <a href="#option-4-scrape-with-fortified-headless-browsers" id="option-4-scrape-with-fortified-headless-browsers"></a>

å¦ä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨ç»è¿‡å¼ºåŒ–çš„æ— å¤´æµè§ˆå™¨å®Œæˆæ•´ä¸ªæŠ“å–å·¥ä½œï¼Œä½¿å…¶çœ‹èµ·æ¥åƒæ˜¯çœŸå®ç”¨æˆ·çš„æµè§ˆå™¨ï¼š

* **Puppeteerï¼š** [puppeteer](https://github.com/puppeteer/puppeteer) çš„ [stealth æ’ä»¶](https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth)ã€‚
* **Playwrightï¼š** [stealth æ’ä»¶](https://www.npmjs.com/package/playwright-stealth) å³å°†æ·»åŠ åˆ° Playwright ä¸­ã€‚è¯·åœ¨[è¿™é‡Œ](https://github.com/berstend/puppeteer-extra/issues/454)å’Œ[è¿™é‡Œ](https://github.com/berstend/puppeteer-extra/tree/master/packages/playwright-extra)å…³æ³¨æœ€æ–°åŠ¨æ€ã€‚
* **Seleniumï¼š** [undetected-chromedriver](https://github.com/ultrafunkamsterdam/undetected-chromedriver) æ˜¯ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„ Selenium Chromedriver è¡¥ä¸ã€‚

### å¸¦æœ‰å†…ç½® Cloudflare ç»•è¿‡åŠŸèƒ½çš„æ™ºèƒ½ä»£ç† <a href="#option-5-smart-proxy-with-cloudflare-built-in-bypass" id="option-5-smart-proxy-with-cloudflare-built-in-bypass"></a>

é™¤äº†ä½¿ç”¨å¼€æºçš„ Cloudflare ç»•è¿‡å·¥å…·ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¼€å‘å’Œç»´æŠ¤è‡ªå·±ç§æœ‰çš„ Cloudflare ç»•è¿‡åŠŸèƒ½çš„æ™ºèƒ½ä»£ç†ã€‚

è¿™äº›æ™ºèƒ½ä»£ç†é€šå¸¸æ›´å¯é ï¼Œå› ä¸º Cloudflare å¾ˆéš¾å¯¹å…¶è¿›è¡Œä¿®è¡¥ï¼Œè€Œä¸”å®ƒä»¬ç”±ä»£ç†å…¬å¸å¼€å‘ï¼Œè¿™äº›å…¬å¸æœ‰ç»æµåŠ¨åŠ›å§‹ç»ˆé¢†å…ˆäº Cloudflareï¼Œå¹¶åœ¨å…¶ç»•è¿‡åŠŸèƒ½å¤±æ•ˆçš„é‚£ä¸€åˆ»ä¿®å¤å®ƒä»¬ã€‚

å¤§å¤šæ•°æ™ºèƒ½ä»£ç†æä¾›å•†ï¼ˆ[ScraperAPI](https://www.scraperapi.com/?fp\_ref=scrapeops)ã€[Scrapingbee](https://www.scrapingbee.com/?fpr=scrapeops)ã€[Oxylabs](https://oxylabs.go2cloud.org/aff\_c?offer\_id=7\&aff\_id=379\&url\_id=32)ã€[Smartproxy](https://prf.hn/click/camref:1100loxdG/\[p\_id:1100l442001]/destination:https%3A%2F%2Fsmartproxy.com%2Fscraping%2Fweb)ï¼‰éƒ½æœ‰æŸç§å½¢å¼çš„ Cloudflare ç»•è¿‡åŠŸèƒ½ï¼Œå…¶æ•ˆæœå’Œæˆæœ¬å„ä¸ç›¸åŒã€‚

ç„¶è€Œï¼Œæœ€å¥½çš„é€‰æ‹©ä¹‹ä¸€æ˜¯ä½¿ç”¨ [ScrapeOps ä»£ç†èšåˆå™¨](https://scrapeops.io/proxy-aggregator/)ï¼Œå› ä¸ºå®ƒå°†è¶…è¿‡ 20 ä¸ªä»£ç†æä¾›å•†é›†æˆåˆ°åŒä¸€ä¸ªä»£ç† API ä¸­ï¼Œå¹¶ä¸ºæ‚¨çš„ç›®æ ‡åŸŸæ‰¾åˆ°æœ€ä½³/æœ€ä¾¿å®œçš„ä»£ç†æä¾›å•†ã€‚

### åå‘å·¥ç¨‹ Cloudflare åæœºå™¨äººä¿æŠ¤ <a href="#option-6-reverse-engineer-cloudflare-anti-bot-protection" id="option-6-reverse-engineer-cloudflare-anti-bot-protection"></a>

è¿™ç§æ–¹æ³•æ˜¯å¯è¡Œçš„ï¼ˆä¹Ÿæ˜¯è®¸å¤šæ™ºèƒ½ä»£ç†è§£å†³æ–¹æ¡ˆæ‰€é‡‡ç”¨çš„æ–¹æ³•ï¼‰ï¼Œä½†ä¸é€‚åˆå¿ƒè„è„†å¼±çš„äººã€‚

**ä¼˜ç‚¹ï¼š** è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œå¦‚æœä½ éœ€è¦å¤§è§„æ¨¡è¿›è¡ŒæŠ“å–ï¼Œè€Œä¸”ä¸æƒ³è¿è¡Œæˆæœ¬é«˜æ˜‚çš„æ•°ç™¾ï¼ˆç”šè‡³æ•°åƒï¼‰ä¸ªå®Œæ•´çš„æ— å¤´æµè§ˆå™¨å®ä¾‹ï¼Œä½ å¯ä»¥å¼€å‘å‡ºèµ„æºåˆ©ç”¨æ•ˆç‡æœ€é«˜çš„ Cloudflare ç»•è¿‡æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•ä¸“é—¨è®¾è®¡ç”¨äºé€šè¿‡ Cloudflare çš„ JSã€TLS å’Œ IP æŒ‡çº¹æµ‹è¯•ã€‚

**ç¼ºç‚¹ï¼š** è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œä½ å°†ä¸å¾—ä¸æ·±å…¥ç ”ç©¶ä¸€ä¸ªä»å¤–éƒ¨çœ‹èµ·æ¥éå¸¸éš¾ä»¥ç†è§£çš„åæœºå™¨äººç³»ç»Ÿï¼Œå¹¶è¿›è¡Œä¸åŒæŠ€æœ¯çš„åˆ†å‰²æµ‹è¯•ï¼Œä»¥æ¬ºéª—å…¶éªŒè¯ç³»ç»Ÿã€‚ç„¶åï¼Œéšç€ Cloudflare ç»§ç»­å¼€å‘å…¶åæœºå™¨äººä¿æŠ¤ï¼Œä½ è¿˜éœ€è¦ç»´æŠ¤è¿™ä¸ªç³»ç»Ÿã€‚

## å‚è€ƒèµ„æ–™

* [https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­ **ä¸ºä½ çš„å…¬å¸åšå¹¿å‘Š**å—ï¼Ÿæˆ–è€…æƒ³è¦è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ PDF æ ¼å¼çš„ HackTricks** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆï¼š[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾— [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
