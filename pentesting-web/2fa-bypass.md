# Bypass 2FA/OTP

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## **Techniki obejcia dwuskadnikowej autoryzacji (2FA/OTP)**

### **Bezporedni dostp do punktu kocowego**

Aby obej 2FA, nale偶y bezporednio uzyska dostp do kolejnego punktu kocowego, znajc cie偶k. Jeli nie powiedzie si, zmie **nag贸wek Referrer** tak, aby naladowa nawigacj z strony weryfikacji 2FA.

### **Ponowne wykorzystanie token贸w**

Ponowne wykorzystanie wczeniej u偶ywanych token贸w do uwierzytelniania w ramach konta mo偶e by skuteczne.

### **Wykorzystanie nieu偶ywanych token贸w**

Mo偶na spr贸bowa wydoby token z wasnego konta w celu obejcia 2FA w innym koncie.

### **Ujawnienie tokenu**

Sprawd藕, czy token jest ujawniony w odpowiedzi z aplikacji internetowej.

### **Wykorzystanie linku weryfikacyjnego**

U偶ycie **linku weryfikacyjnego wysanego podczas tworzenia konta** mo偶e umo偶liwi dostp do profilu bez 2FA, jak opisano w szczeg贸ach w [tym](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) pocie.

### **Manipulacja sesj**

Inicjowanie sesji zar贸wno dla konta u偶ytkownika, jak i ofiary, i ukoczenie 2FA dla konta u偶ytkownika bez kontynuowania, umo偶liwia pr贸b dostpu do kolejnego kroku w przepywie konta ofiary, wykorzystujc ograniczenia zarzdzania sesj po stronie serwera.

### **Mechanizm resetowania hasa**

Badanie funkcji resetowania hasa, kt贸ra loguje u偶ytkownika do aplikacji po zresetowaniu, w celu sprawdzenia mo偶liwoci wielokrotnego resetowania za pomoc tego samego linku, jest kluczowe. Zalogowanie si za pomoc nowo ustawionych danych uwierzytelniajcych mo偶e obej 2FA.

### **Kompromitacja platformy OAuth**

Skompromitowanie konta u偶ytkownika na zaufanej platformie **OAuth** (np. Google, Facebook) mo偶e umo偶liwi obejcie 2FA.

### **Ataki brute force**

#### **Brak limitu szybkoci**

Brak limitu liczby pr贸b kodu umo偶liwia ataki brute force, cho nale偶y wzi pod uwag potencjalne ciche ograniczenie szybkoci.

#### **Wolny atak brute force**

Wolny atak brute force jest mo偶liwy, gdy istniej limity szybkoci przepywu bez og贸lnego limitu szybkoci.

#### **Reset limitu wysyania kodu**

Ponowne wysanie kodu resetuje limit szybkoci, uatwiajc kontynuowanie pr贸b ataku brute force.

#### **Ominicie limitu szybkoci po stronie klienta**

Dokument opisuje techniki obejcia limitu szybkoci po stronie klienta.

#### **Brak limitu szybkoci dla dziaa wewntrznych**

Limity szybkoci mog chroni przed pr贸bami logowania, ale nie przed wewntrznymi dziaaniami na koncie.

#### **Koszty ponownego wysyania kodu SMS**

Wysyanie nadmiernych iloci kod贸w SMS wi偶e si z kosztami dla firmy, ale nie obejmuje to 2FA.

#### **Nieskoczona regeneracja OTP**

Nieskoczona generacja OTP za pomoc prostych kod贸w umo偶liwia atak brute force poprzez ponowne pr贸bowanie maego zestawu kod贸w.

### **Wykorzystanie wycig贸w (race condition)**

Wykorzystanie wycig贸w (race conditions) do obejcia 2FA mo偶na znale藕 w konkretnym dokumencie.

### **Podatnoci CSRF/Clickjacking**

Badanie podatnoci CSRF lub Clickjacking w celu wyczenia 2FA jest skuteczn strategi.

### **Wykorzystanie funkcji "Zapamitaj mnie"**

#### **Przewidywalne wartoci plik贸w cookie**

Zgadywanie wartoci pliku cookie "zapamitaj mnie" mo偶e obej ograniczenia.

#### **Podszywanie si pod adres IP**

Podszywanie si pod adres IP ofiary za pomoc nag贸wka **X-Forwarded-For** mo偶e obej ograniczenia.

### **Wykorzystanie starszych wersji**

#### **Poddomeny**

Testowanie poddomen mo偶e obejmowa starsze wersje, kt贸re nie obsuguj 2FA lub zawieraj podatne implementacje 2FA.

#### **Punkty kocowe interfejsu API**

Starsze wersje interfejsu API, wskazane przez cie偶ki katalogowe /v\*/, mog by podatne na metody obejcia 2FA.

### **Obsuga poprzednich sesji**

Zakoczenie istniejcych sesji po aktywacji 2FA zabezpiecza konta przed nieautoryzowanym dostpem z kompromitowanych sesji.

### **Wady kontroli dostpu z kodami zapasowymi**

Natychmiastowe generowanie i potencjalne nieautoryzowane pobieranie kod贸w zapasowych po aktywacji 2FA, zwaszcza przy bdnej konfiguracji CORS/XSS, stanowi ryzyko.

### **Ujawnienie informacji na stronie 2FA**

Ujawnienie poufnych informacji (np. numeru telefonu) na stronie weryfikacji 2FA stanowi zagro偶enie.

### **Wyczenie 2FA przez resetowanie hasa**

Proces demonstrujcy potencjaln metod obejcia obejmuje utworzenie konta, aktywacj 2FA, resetowanie hasa i nastpne logowanie bez wymagania 2FA.

### **Podstawowe 偶dania (decoy requests)**

Wykorzystanie podstawowych 偶da w celu zaciemnienia pr贸b ataku brute force lub wprowadzenia w bd mechanizm贸w ograniczania szybkoci dodaje kolejn warstw strategii obejcia. Tworzenie takich 偶da wymaga subtelnej znajomoci rodk贸w bezpieczestwa aplikacji i zachowa ograniczania szybkoci.

## Odwoania
* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35]("https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35")
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w form
