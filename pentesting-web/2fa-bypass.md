# Bypass de 2FA/OTP

<details>

<summary><strong>Aprenda hacking AWS do zero ao hero패i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fami패lia PEASS**](https://opensea.io/collection/the-peass-family), nossa colec퍊a팪o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** 游눫 [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposito패rios do github.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) e패 um motor de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares roubadores**.

O objetivo principal do WhiteIntel e패 combater tomadas de conta e ataques de ransomware resultantes de malwares que roubam informac퍊o팪es.

Voce팩 pode verificar o site deles e experimentar o motor de busca de forma **gratuita** em:

{% embed url="https://whiteintel.io" %}

---

## **Te패cnicas Avanc퍊adas de Bypass de Autenticac퍊a팪o de Dois Fatores**

### **Acesso Direto ao Endpoint**

Para contornar o 2FA, acesse diretamente o endpoint subsequente, sendo crucial conhecer o caminho. Se na팪o tiver sucesso, altere o **cabec퍊alho Referrer** para imitar a navegac퍊a팪o a partir da pa패gina de verificac퍊a팪o do 2FA.

### **Reutilizac퍊a팪o de Token**

Reutilizar tokens previamente usados para autenticac퍊a팪o em uma conta pode ser eficaz.

### **Utilizac퍊a팪o de Tokens Na팪o Utilizados**

Extrair um token da pro패pria conta para contornar o 2FA em outra conta pode ser tentado.

### **Exposic퍊a팪o do Token**

Investigar se o token e패 revelado em uma resposta da aplicac퍊a팪o web.

### **Explorac퍊a팪o do Link de Verificac퍊a팪o**

Usar o **link de verificac퍊a팪o por e-mail enviado durante a criac퍊a팪o da conta** pode permitir acesso ao perfil sem 2FA, como destacado em um post detalhado [aqui](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulac퍊a팪o de Sessa팪o**

Iniciar sesso팪es para a conta do usua패rio e da vi패tima, e completar o 2FA para a conta do usua패rio sem prosseguir, permite uma tentativa de acessar a pro패xima etapa no fluxo da conta da vi패tima, explorando limitac퍊o팪es de gerenciamento de sessa팪o do backend.

### **Mecanismo de Redefinic퍊a팪o de Senha**

Investigar a func퍊a팪o de redefinic퍊a팪o de senha, que faz login do usua패rio na aplicac퍊a팪o po패s-redefinic퍊a팪o, para verificar seu potencial de permitir mu패ltiplas redefinic퍊o팪es usando o mesmo link e패 crucial. Fazer login com as novas credenciais redefinidas pode contornar o 2FA.

### **Comprometimento da Plataforma OAuth**

Comprometer a conta de um usua패rio em uma plataforma **OAuth** confia패vel (por exemplo, Google, Facebook) pode oferecer uma rota para contornar o 2FA.

### **Ataques de Forc퍊a Bruta**

#### **Aus칡ncia de Limite de Taxa**

A falta de um limite no nu패mero de tentativas de co패digo permite ataques de forc퍊a bruta, embora um potencial limite de taxa silencioso deva ser considerado.

#### **Forc퍊a Bruta Lenta**

Um ataque de forc퍊a bruta lento e패 vi치vel onde existem limites de taxa de fluxo sem um limite de taxa geral.

#### **Redefinic퍊a팪o do Limite de Reenvio de Co패digo**

O reenvio do co패digo redefine o limite de taxa, facilitando tentativas conti패nuas de forc퍊a bruta.

#### **Contorno de Limite de Taxa do Lado do Cliente**

Um documento detalha te패cnicas para contornar limites de taxa do lado do cliente.

#### **Ac퍊o팪es Internas Sem Limite de Taxa**

Limites de taxa podem proteger tentativas de login, mas na팪o ac퍊o팪es internas da conta.

#### **Custos de Reenvio de Co패digo SMS**

O reenvio excessivo de co패digos via SMS incorre em custos para a empresa, embora na팪o contorne o 2FA.

#### **Regenerac퍊a팪o Infinita de OTP**

A gerac퍊a팪o infinita de OTP com co패digos simples permite a forc퍊a bruta ao tentar novamente um pequeno conjunto de co패digos.

### **Explorac퍊a팪o de Condic퍊a팪o de Corrida**

Explorar condic퍊o팪es de corrida para contornar o 2FA pode ser encontrado em um documento especi패fico.

### **Vulnerabilidades CSRF/Clickjacking**

Explorar vulnerabilidades CSRF ou Clickjacking para desativar o 2FA e패 uma estrate패gia vi치vel.

### **Explorac퍊o팪es da Funcionalidade "Lembrar-me"**

#### **Valores de Cookie Previsi패veis**

Adivinhar o valor do cookie "lembrar-me" pode contornar restric퍊o팪es.

#### **Impersonac퍊a팪o de Enderec퍊o IP**

Impersonar o enderec퍊o IP da vi패tima atrave패s do cabec퍊alho **X-Forwarded-For** pode contornar restric퍊o팪es.

### **Utilizando Verso팪es Antigas**

#### **Subdomi패nios**

Testar subdomi패nios pode usar verso팪es desatualizadas sem suporte de 2FA ou conter implementac퍊o팪es de 2FA vulnera패veis.

#### **Endpoints de API**

Verso팪es antigas de API, indicadas por caminhos de direto패rio /v\*, podem ser vulnera패veis a me패todos de contorno de 2FA.

### **Tratamento de Sess칫es Anteriores**

Encerrar sesso팪es existentes ao ativar o 2FA protege contas contra acesso na팪o autorizado de sesso팪es comprometidas.

### **Falhas de Controle de Acesso com Co패digos de Backup**

A gerac퍊a팪o imediata e a recuperac퍊a팪o na팪o autorizada potencial de co패digos de backup ao ativar o 2FA, especialmente com misconfigurac퍊o팪es de CORS/vulnerabilidades XSS, representam um risco.

### **Divulgac퍊a팪o de Informac퍊o팪es na Pa패gina de 2FA**

A divulgac퍊a팪o de informac퍊o팪es sensi패veis (por exemplo, nu패mero de telefone) na pa패gina de verificac퍊a팪o de 2FA e패 uma preocupac퍊a팪o.

### **Redefinic퍊a팪o de Senha Desativando o 2FA**

Um processo demonstrando um me패todo potencial de contorno envolve criac퍊a팪o de conta, ativac퍊a팪o de 2FA, redefinic퍊a팪o de senha e login subsequente sem a exige팩ncia de 2FA.

### **Requisic퍊o팪es Falsas**

Utilizar requisic퍊o팪es falsas para obscurecer tentativas de forc퍊a bruta ou enganar mecanismos de limitac퍊a팪o de taxa adiciona outra camada as estrate패gias de contorno. Criar tais requisic퍊o팪es requer uma compreensa팪o sutil das medidas de seguranc퍊a e comportamentos de limitac퍊a팪o de taxa da aplicac퍊a팪o.

## Refere팩ncias

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)


### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) e패 um motor de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares roubadores**.

O objetivo principal do WhiteIntel e패 combater tomadas de conta e ataques de ransomware resultantes de malwares que roubam informac퍊o팪es.

Voce팩 pode verificar o site deles e experimentar o motor de busca de forma **gratuita** em:

{% embed url="https://whiteintel.io" %}
