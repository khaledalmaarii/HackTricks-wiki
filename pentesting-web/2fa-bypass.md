# 2FA/MFA/OTP Bypass

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr코ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}


## **Tehnike za zaobila쬰nje pobolj코ane dvofaktorske autentifikacije**

### **Direktan pristup krajnjoj ta캜ki**

Da biste zaobi코li 2FA, direktno pristupite slede캖oj krajnjoj ta캜ki, poznavanje puta je klju캜no. Ako ne uspete, promenite **Referrer header** da biste opona코ali navigaciju sa stranice za verifikaciju 2FA.

### **Ponovna upotreba tokena**

Ponovna upotreba prethodno kori코캖enih tokena za autentifikaciju unutar naloga mo쬰 biti efikasna.

### **Kori코캖enje neiskori코캖enih tokena**

Mo쬰 se poku코ati izdvojiti token iz svog naloga kako bi se zaobi코la 2FA u drugom nalogu.

### **Izlaganje tokena**

Istra쬴te da li je token otkriven u odgovoru iz web aplikacije.

### **Eksploatacija verifikacione veze**

Kori코캖enje **verifikacione veze za e-po코tu poslate prilikom kreiranja naloga** mo쬰 omogu캖iti pristup profilu bez 2FA, kao 코to je istaknuto u detaljnom [postu](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulacija sesijama**

Pokretanje sesija za naloge korisnika i rtve, i zavr코avanje 2FA za korisnikov nalog bez nastavka, omogu캖ava poku코aj pristupa slede캖em koraku u toku naloga rtve, iskori코캖avaju캖i ograni캜enja upravljanja sesijama na backendu.

### **Mehanizam za resetovanje lozinke**

Istra쬴vanje funkcije resetovanja lozinke, koja prijavljuje korisnika u aplikaciju nakon resetovanja, zbog njenog potencijala da omogu캖i vi코e resetovanja koriste캖i istu vezu je klju캜no. Prijavljivanje sa novim resetovanim podacima mo쬰 zaobi캖i 2FA.

### **Kompromitovanje OAuth platforme**

Kompromitovanje korisni캜kog naloga na pouzdanoj **OAuth** platformi (npr. Google, Facebook) mo쬰 ponuditi put za zaobila쬰nje 2FA.

### **Brute Force napadi**

#### **Odsustvo ograni캜enja brzine**

Nedostatak ograni캜enja na broj poku코aja koda omogu캖ava brute force napade, iako treba razmotriti potencijalno tiho ograni캜avanje brzine.

#### **Spori brute force**

Spori brute force napad je izvodljiv gde postoje ograni캜enja brzine protoka bez sveobuhvatnog ograni캜enja brzine.

#### **Resetovanje ograni캜enja ponovnog slanja koda**

Ponovno slanje koda resetuje ograni캜enje brzine, olak코avaju캖i nastavak poku코aja brute force.

#### **Zaobila쬰nje ograni캜enja brzine na klijentskoj strani**

Dokument detaljno opisuje tehnike za zaobila쬰nje ograni캜enja brzine na klijentskoj strani.

#### **Unutra코nje radnje bez ograni캜enja brzine**

Ograni캜enja brzine mogu za코tititi poku코aje prijavljivanja, ali ne i unutra코nje radnje naloga.

#### **Tro코kovi ponovnog slanja SMS koda**

Prekomerno slanje kodova putem SMS-a nosi tro코kove za kompaniju, iako ne zaobilazi 2FA.

#### **Beskona캜na regeneracija OTP-a**

Beskona캜na generacija OTP-a sa jednostavnim kodovima omogu캖ava brute force poku코aje ponovnog slanja malog skupa kodova.

### **Eksploatacija uslova trke**

Eksploatacija uslova trke za zaobila쬰nje 2FA mo쬰 se na캖i u specifi캜nom dokumentu.

### **CSRF/Clickjacking ranjivosti**

Istra쬴vanje CSRF ili Clickjacking ranjivosti za onemogu캖avanje 2FA je izvodljiva strategija.

### **Eksploatacija funkcije "Zapamti me"**

#### **Predvidljive vrednosti kola캜i캖a**

Poga캠anje vrednosti kola캜i캖a "zapamti me" mo쬰 zaobi캖i ograni캜enja.

#### **Imitacija IP adrese**

Imitacija IP adrese rtve putem **X-Forwarded-For** header-a mo쬰 zaobi캖i ograni캜enja.

### **Kori코캖enje starijih verzija**

#### **Poddomeni**

Testiranje poddomena mo쬰 koristiti zastarele verzije koje nemaju podr코ku za 2FA ili sadr쬰 ranjive implementacije 2FA.

#### **API krajnje ta캜ke**

Starije verzije API-ja, ozna캜ene sa /v\*/ putanjama, mogu biti ranjive na metode za zaobila쬰nje 2FA.

### **Rukovanje prethodnim sesijama**

Prekidanje postoje캖ih sesija prilikom aktivacije 2FA osigurava naloge od neovla코캖enog pristupa iz kompromitovanih sesija.

### **Gre코ke u kontroli pristupa sa rezervnim kodovima**

Odmah generisanje i potencijalno neovla코캖eno preuzimanje rezervnih kodova prilikom aktivacije 2FA, posebno sa CORS pogre코nim konfiguracijama/XSS ranjivostima, predstavlja rizik.

### **Otkrivanje informacija na 2FA stranici**

Otkrivanje osetljivih informacija (npr. broj telefona) na stranici za verifikaciju 2FA je zabrinjavaju캖e.

### **Resetovanje lozinke onemogu캖ava 2FA**

Proces koji demonstrira potencijalnu metodu zaobila쬰nja uklju캜uje kreiranje naloga, aktivaciju 2FA, resetovanje lozinke i naknadno prijavljivanje bez zahteva za 2FA.

### **Mamci za zahteve**

Kori코캖enje mamaca za zahteve kako bi se zamaglili poku코aji brute force ili zavarali mehanizmi ograni캜enja brzine dodaje jo코 jedan sloj strategijama za zaobila쬰nje. Kreiranje takvih zahteva zahteva suptilno razumevanje bezbednosnih mera aplikacije i pona코anja ograni캜enja brzine.

### Gre코ke u konstrukciji OTP-a

U slu캜aju da se OTP kreira na osnovu podataka koje korisnik ve캖 ima ili koji se 코alju prethodno za kreiranje OTP-a, mogu캖e je da korisnik tako캠e generi코e OTP i zaobi캠e ga.

## Reference

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce)


P

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr코ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
