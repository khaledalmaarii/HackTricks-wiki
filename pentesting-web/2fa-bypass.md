# Bypass de 2FA/MFA/OTP

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) es un motor de b煤squeda alimentado por la **dark-web** que ofrece funcionalidades **gratuitas** para verificar si una empresa o sus clientes han sido **comprometidos** por **malwares robadores**.

Su objetivo principal de WhiteIntel es combatir la toma de cuentas y los ataques de ransomware resultantes de malware que roba informaci贸n.

Puedes revisar su sitio web y probar su motor de forma **gratuita** en:

{% embed url="https://whiteintel.io" %}

***

## **T茅cnicas Mejoradas de Bypass de Autenticaci贸n de Dos Factores**

### **Acceso Directo a Endpoints**

Para eludir 2FA, accede directamente al siguiente endpoint, conociendo la ruta es crucial. Si no tienes 茅xito, altera el **header Referrer** para imitar la navegaci贸n desde la p谩gina de verificaci贸n de 2FA.

### **Reutilizaci贸n de Tokens**

Reutilizar tokens previamente utilizados para la autenticaci贸n dentro de una cuenta puede ser efectivo.

### **Utilizaci贸n de Tokens No Usados**

Extraer un token de la propia cuenta para eludir 2FA en otra cuenta puede ser intentado.

### **Exposici贸n de Token**

Investiga si el token se divulga en una respuesta de la aplicaci贸n web.

### **Explotaci贸n de Enlace de Verificaci贸n**

Usar el **enlace de verificaci贸n de correo electr贸nico enviado al crear la cuenta** puede permitir el acceso al perfil sin 2FA, como se destaca en un [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulaci贸n de Sesiones**

Iniciar sesiones tanto para la cuenta del usuario como para la cuenta de una v铆ctima, y completar 2FA para la cuenta del usuario sin proceder, permite intentar acceder al siguiente paso en el flujo de la cuenta de la v铆ctima, explotando las limitaciones de gesti贸n de sesiones en el backend.

### **Mecanismo de Restablecimiento de Contrase帽a**

Investigar la funci贸n de restablecimiento de contrase帽a, que inicia sesi贸n a un usuario en la aplicaci贸n despu茅s del restablecimiento, por su potencial para permitir m煤ltiples restablecimientos usando el mismo enlace es crucial. Iniciar sesi贸n con las credenciales reci茅n restablecidas podr铆a eludir 2FA.

### **Compromiso de Plataforma OAuth**

Comprometer la cuenta de un usuario en una plataforma **OAuth** de confianza (por ejemplo, Google, Facebook) puede ofrecer una ruta para eludir 2FA.

### **Ataques de Fuerza Bruta**

#### **Ausencia de L铆mite de Tasa**

La falta de un l铆mite en el n煤mero de intentos de c贸digo permite ataques de fuerza bruta, aunque se debe considerar un posible limitador de tasa silencioso.

#### **Fuerza Bruta Lenta**

Un ataque de fuerza bruta lento es viable donde existen l铆mites de flujo sin un l铆mite general de tasa.

#### **Restablecimiento del L铆mite de Reenv铆o de C贸digo**

Reenviar el c贸digo restablece el l铆mite de tasa, facilitando intentos continuos de fuerza bruta.

#### **Evasi贸n de L铆mite de Tasa del Lado del Cliente**

Un documento detalla t茅cnicas para eludir el l铆mite de tasa del lado del cliente.

#### **Falta de L铆mite de Tasa en Acciones Internas**

Los l铆mites de tasa pueden proteger los intentos de inicio de sesi贸n, pero no las acciones internas de la cuenta.

#### **Costos de Reenv铆o de C贸digo SMS**

El reenv铆o excesivo de c贸digos por SMS incurre en costos para la empresa, aunque no elude 2FA.

#### **Regeneraci贸n Infinita de OTP**

La generaci贸n infinita de OTP con c贸digos simples permite la fuerza bruta al volver a intentar un peque帽o conjunto de c贸digos.

### **Explotaci贸n de Condiciones de Carrera**

Explotar condiciones de carrera para eludir 2FA se puede encontrar en un documento espec铆fico.

### **Vulnerabilidades CSRF/Clickjacking**

Explorar vulnerabilidades CSRF o Clickjacking para deshabilitar 2FA es una estrategia viable.

### **Explotaciones de la Funci贸n "Recordarme"**

#### **Valores de Cookie Predecibles**

Adivinar el valor de la cookie "recordarme" puede eludir restricciones.

#### **Suplantaci贸n de Direcci贸n IP**

Suplantar la direcci贸n IP de la v铆ctima a trav茅s del header **X-Forwarded-For** puede eludir restricciones.

### **Utilizaci贸n de Versiones Anteriores**

#### **Subdominios**

Probar subdominios puede usar versiones desactualizadas que carecen de soporte para 2FA o contener implementaciones vulnerables de 2FA.

#### **Endpoints de API**

Las versiones antiguas de API, indicadas por rutas de directorio /v\*/, pueden ser vulnerables a m茅todos de bypass de 2FA.

### **Manejo de Sesiones Anteriores**

Terminar sesiones existentes al activar 2FA asegura cuentas contra accesos no autorizados desde sesiones comprometidas.

### **Fallos de Control de Acceso con C贸digos de Respaldo**

La generaci贸n inmediata y la posible recuperaci贸n no autorizada de c贸digos de respaldo al activar 2FA, especialmente con configuraciones incorrectas de CORS/vulnerabilidades XSS, representa un riesgo.

### **Divulgaci贸n de Informaci贸n en la P谩gina de 2FA**

La divulgaci贸n de informaci贸n sensible (por ejemplo, n煤mero de tel茅fono) en la p谩gina de verificaci贸n de 2FA es una preocupaci贸n.

### **Restablecimiento de Contrase帽a Deshabilitando 2FA**

Un proceso que demuestra un posible m茅todo de bypass implica la creaci贸n de una cuenta, activaci贸n de 2FA, restablecimiento de contrase帽a y posterior inicio de sesi贸n sin el requisito de 2FA.

### **Solicitudes de Se帽uelo**

Utilizar solicitudes de se帽uelo para ofuscar intentos de fuerza bruta o desviar mecanismos de limitaci贸n de tasa a帽ade otra capa a las estrategias de bypass. Elaborar tales solicitudes requiere un entendimiento matizado de las medidas de seguridad de la aplicaci贸n y los comportamientos de limitaci贸n de tasa.

### Errores en la Construcci贸n de OTP

En caso de que el OTP se cree basado en datos que el usuario ya tiene o que se env铆an previamente para crear el OTP, es posible que el usuario tambi茅n pueda generarlo y eludirlo.

## Referencias

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) es un motor de b煤squeda alimentado por la **dark-web** que ofrece funcionalidades **gratuitas** para verificar si una empresa o sus clientes han sido **comprometidos** por **malwares robadores**.

Su objetivo principal de WhiteIntel es combatir la toma de cuentas y los ataques de ransomware resultantes de malware que roba informaci贸n.

Puedes revisar su sitio web y probar su motor de forma **gratuita** en:

{% embed url="https://whiteintel.io" %}

P

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci贸n**](https://github.com/sponsors/carlospolop)!
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}
