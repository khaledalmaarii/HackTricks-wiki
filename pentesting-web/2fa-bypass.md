# Bypass de 2FA/OTP

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um motor de busca alimentado pela **dark-web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares de roubo**.

O principal objetivo do WhiteIntel √© combater a tomada de contas e ataques de ransomware resultantes de malware que rouba informa√ß√µes.

Voc√™ pode conferir o site deles e experimentar o motor gratuitamente em:

{% embed url="https://whiteintel.io" %}

***

## **T√©cnicas Aprimoradas de Bypass de Autentica√ß√£o de Dois Fatores**

### **Acesso Direto ao Endpoint**

Para contornar a 2FA, acesse o endpoint subsequente diretamente, sabendo que o caminho √© crucial. Se n√£o for bem-sucedido, altere o **cabe√ßalho Referrer** para imitar a navega√ß√£o a partir da p√°gina de verifica√ß√£o da 2FA.

### **Reutiliza√ß√£o de Token**

Reutilizar tokens usados anteriormente para autentica√ß√£o dentro de uma conta pode ser eficaz.

### **Utiliza√ß√£o de Tokens N√£o Utilizados**

Extrair um token de sua pr√≥pria conta para contornar a 2FA em outra conta pode ser tentado.

### **Exposi√ß√£o de Token**

Investigue se o token √© divulgado em uma resposta da aplica√ß√£o web.

### **Explora√ß√£o de Link de Verifica√ß√£o**

Usar o **link de verifica√ß√£o de e-mail enviado na cria√ß√£o da conta** pode permitir o acesso ao perfil sem 2FA, como destacado em um [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipula√ß√£o de Sess√£o**

Iniciar sess√µes tanto para a conta do usu√°rio quanto para a conta de uma v√≠tima, e completar a 2FA para a conta do usu√°rio sem prosseguir, permite uma tentativa de acessar o pr√≥ximo passo no fluxo da conta da v√≠tima, explorando limita√ß√µes de gerenciamento de sess√£o no backend.

### **Mecanismo de Redefini√ß√£o de Senha**

Investigar a fun√ß√£o de redefini√ß√£o de senha, que faz o login de um usu√°rio na aplica√ß√£o ap√≥s a redefini√ß√£o, para seu potencial de permitir m√∫ltiplas redefini√ß√µes usando o mesmo link √© crucial. Fazer login com as credenciais rec√©m-redefinidas pode contornar a 2FA.

### **Comprometimento de Plataforma OAuth**

Comprometer a conta de um usu√°rio em uma plataforma **OAuth** confi√°vel (por exemplo, Google, Facebook) pode oferecer um caminho para contornar a 2FA.

### **Ataques de For√ßa Bruta**

#### **Aus√™ncia de Limite de Taxa**

A falta de um limite no n√∫mero de tentativas de c√≥digo permite ataques de for√ßa bruta, embora um poss√≠vel limite de taxa silencioso deva ser considerado.

#### **For√ßa Bruta Lenta**

Um ataque de for√ßa bruta lento √© vi√°vel onde existem limites de taxa de fluxo sem um limite de taxa geral.

#### **Redefini√ß√£o do Limite de Reenvio de C√≥digo**

Reenviar o c√≥digo redefine o limite de taxa, facilitando tentativas cont√≠nuas de for√ßa bruta.

#### **Circunven√ß√£o de Limite de Taxa do Lado do Cliente**

Um documento detalha t√©cnicas para contornar a limita√ß√£o de taxa do lado do cliente.

#### **A√ß√µes Internas Sem Limite de Taxa**

Limites de taxa podem proteger tentativas de login, mas n√£o a√ß√µes internas da conta.

#### **Custos de Reenvio de C√≥digo SMS**

O reenvio excessivo de c√≥digos via SMS gera custos para a empresa, embora n√£o contorne a 2FA.

#### **Gera√ß√£o Infinita de OTP**

A gera√ß√£o infinita de OTP com c√≥digos simples permite for√ßa bruta ao tentar um pequeno conjunto de c√≥digos.

### **Explora√ß√£o de Condi√ß√£o de Corrida**

Explorar condi√ß√µes de corrida para contornar a 2FA pode ser encontrado em um documento espec√≠fico.

### **Vulnerabilidades CSRF/Clickjacking**

Explorar vulnerabilidades CSRF ou Clickjacking para desativar a 2FA √© uma estrat√©gia vi√°vel.

### **Explora√ß√µes da Fun√ß√£o "Lembrar de Mim"**

#### **Valores de Cookie Previs√≠veis**

Adivinhar o valor do cookie "lembrar de mim" pode contornar restri√ß√µes.

#### **Imita√ß√£o de Endere√ßo IP**

Imitar o endere√ßo IP da v√≠tima atrav√©s do cabe√ßalho **X-Forwarded-For** pode contornar restri√ß√µes.

### **Utiliza√ß√£o de Vers√µes Antigas**

#### **Subdom√≠nios**

Testar subdom√≠nios pode usar vers√µes desatualizadas que n√£o suportam 2FA ou conter implementa√ß√µes vulner√°veis de 2FA.

#### **Endpoints de API**

Vers√µes mais antigas da API, indicadas por caminhos de diret√≥rio /v\*/, podem ser vulner√°veis a m√©todos de bypass de 2FA.

### **Tratamento de Sess√µes Anteriores**

Encerrar sess√µes existentes ao ativar a 2FA protege contas contra acesso n√£o autorizado de sess√µes comprometidas.

### **Falhas de Controle de Acesso com C√≥digos de Backup**

A gera√ß√£o imediata e o potencial de recupera√ß√£o n√£o autorizada de c√≥digos de backup ao ativar a 2FA, especialmente com configura√ß√µes incorretas de CORS/vulnerabilidades XSS, representam um risco.

### **Divulga√ß√£o de Informa√ß√µes na P√°gina de 2FA**

A divulga√ß√£o de informa√ß√µes sens√≠veis (por exemplo, n√∫mero de telefone) na p√°gina de verifica√ß√£o da 2FA √© uma preocupa√ß√£o.

### **Redefini√ß√£o de Senha Desativando 2FA**

Um processo que demonstra um m√©todo de bypass potencial envolve a cria√ß√£o de conta, ativa√ß√£o da 2FA, redefini√ß√£o de senha e login subsequente sem a exig√™ncia de 2FA.

### **Requisi√ß√µes Falsas**

Utilizar requisi√ß√µes falsas para ofuscar tentativas de for√ßa bruta ou enganar mecanismos de limita√ß√£o de taxa adiciona outra camada √†s estrat√©gias de bypass. Criar tais requisi√ß√µes requer uma compreens√£o sutil das medidas de seguran√ßa da aplica√ß√£o e dos comportamentos de limita√ß√£o de taxa.

## Refer√™ncias

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um motor de busca alimentado pela **dark-web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares de roubo**.

O principal objetivo do WhiteIntel √© combater a tomada de contas e ataques de ransomware resultantes de malware que rouba informa√ß√µes.

Voc√™ pode conferir o site deles e experimentar o motor gratuitamente em:

{% embed url="https://whiteintel.io" %}

P

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
