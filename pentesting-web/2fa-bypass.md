# Bajpasovanje 2FA/OTP

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) je pretra쬴va캜 pokretan **dark-web-om** koji nudi **besplatne** funkcionalnosti za proveru da li je kompanija ili njeni korisnici **kompromitovani** od strane **malvera za kra캠u podataka**.

Primarni cilj WhiteIntel-a je borba protiv preuzimanja naloga i napada ransomvera koji proizilaze iz malvera za kra캠u informacija.

Mo쬰te posetiti njihovu veb lokaciju i isprobati njihovu ma코inu za pretragu **besplatno** na:

{% embed url="https://whiteintel.io" %}

---

## **Tehnike pobolj코anog zaobila쬰nja Dvostruke Autentifikacije**

### **Direktan Pristup Krajnjoj Ta캜ki**

Da biste zaobi코li 2FA, pristupite narednoj krajnjoj ta캜ki direktno, znaju캖i da je putanja klju캜na. Ako ne uspete, promenite **Referrer header** da imitirate navigaciju sa stranice za proveru 2FA.

### **Ponovna Upotreba Tokena**

Ponovna upotreba prethodno kori코캖enih tokena za autentifikaciju unutar naloga mo쬰 biti efikasna.

### **Kori코캖enje Neiskori코캖enih Tokena**

Poku코ajte izvu캖i token iz svog sopstvenog naloga kako biste zaobi코li 2FA u drugom nalogu.

### **Otkrivanje Tokena**

Istra쬴te da li je token otkriven u odgovoru veb aplikacije.

### **Eksploatacija Verifikacionog Linka**

Kori코캖enje **verifikacionog linka poslatog putem e-po코te prilikom kreiranja naloga** mo쬰 omogu캖iti pristup profilu bez 2FA, kako je istaknuto u detaljnom [postu](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulacija Sesijom**

Pokretanje sesija za nalog korisnika i rtve, i zavr코avanje 2FA za korisni캜ki nalog bez nastavka, omogu캖ava poku코aj pristupa slede캖em koraku u toku rtvinog naloga, eksploati코u캖i ograni캜enja upravljanja sesijama na serverskoj strani.

### **Mehanizam Resetovanja Lozinke**

Istra쬴vanje funkcije resetovanja lozinke, koja korisnika prijavljuje u aplikaciju nakon resetovanja, zbog potencijala da omogu캖i vi코estruka resetovanja kori코캖enjem istog linka je klju캜no. Prijavljivanje sa novim resetovanim pristupnim podacima mo쬰 zaobi캖i 2FA.

### **Kompromitacija OAuth Platforme**

Kompromitacija korisni캜kog naloga na pouzdanoj **OAuth** platformi (npr. Google, Facebook) mo쬰 ponuditi put za zaobila쬰nje 2FA.

### **Napadi Brute Force**

#### **Odsustvo Ograni캜enja Brzine**

Odsustvo ograni캜enja broja poku코aja koda omogu캖ava napade brute force, mada treba razmotriti potencijalno tiho ograni캜enje brzine.

#### **Spori Brute Force**

Spori napad brute force je mogu캖 gde postoje ograni캜enja brzine toka bez op코teg ograni캜enja brzine.

#### **Resetovanje Ograni캜enja Ponovnog Slanja Koda**

Ponovno slanje koda resetuje ograni캜enje brzine, olak코avaju캖i nastavak napada brute force.

#### **Obila쬰nje Ograni캜enja Brzine na Klijentskoj Strani**

Dokument detaljno opisuje tehnike za zaobila쬰nje ograni캜enja brzine na klijentskoj strani.

#### **Unutra코nje Akcije Bez Ograni캜enja Brzine**

Ograni캜enja brzine mogu 코tititi poku코aje prijavljivanja ali ne i interne akcije naloga.

#### **Tro코kovi Ponovnog Slanja SMS Koda**

Prekomerno slanje kodova putem SMS-a donosi tro코kove kompaniji, mada ne zaobilazi 2FA.

#### **Beskona캜na Regeneracija OTP-a**

Beskona캜na generacija OTP-a sa jednostavnim kodovima omogu캖ava brute force poku코ajem ponovnog poku코aja male grupe kodova.

### **Eksploatacija Trke Uslova**

Eksploatacija trke uslova za zaobila쬰nje 2FA mo쬰 se na캖i u specifi캜nom dokumentu.

### **CSRF/Clickjacking Ranjivosti**

Istra쬴vanje CSRF ili Clickjacking ranjivosti za onemogu캖avanje 2FA je izvodljiva strategija.

### **Eksploatacija Funkcije "Zapamti Me"**

#### **Predvidljive Vrednosti Kola캜i캖a**

Poga캠anje vrednosti kola캜i캖a "zapamti me" mo쬰 zaobi캖i ograni캜enja.

#### **Imitacija IP Adrese**

Imitiranje IP adrese rtve putem **X-Forwarded-For** zaglavlja mo쬰 zaobi캖i ograni캜enja.

### **Kori코캖enje Starijih Verzija**

#### **Poddomeni**

Testiranje poddomena mo쬰 koristiti zastarele verzije koje nemaju podr코ku za 2FA ili sadr쬰 ranjive implementacije 2FA.

#### **API Krajnje Ta캜ke**

Starije verzije API-ja, nazna캜ene putanjama direktorijuma /v\*/, mogu biti ranjive na metode zaobila쬰nja 2FA.

### **Rukovanje Prethodnim Sesijama**

Zavr코avanje postoje캖ih sesija prilikom aktivacije 2FA 코titi naloge od neovla코캖enog pristupa iz kompromitovanih sesija.

### **Propusti u Kontroli Pristupa sa Rezervnim Kodovima**

Odmah generisanje i potencijalno neovla코캖eno preuzimanje rezervnih kodova prilikom aktivacije 2FA, posebno sa CORS gre코kama/XSS ranjivostima, predstavlja rizik.

### **Otkrivanje Informacija na Stranici za 2FA**

Otkrivanje osetljivih informacija (npr. broj telefona) na stranici za verifikaciju 2FA je zabrinjavaju캖e.

### **Onemogu캖avanje Resetovanja Lozinke 2FA**

Proces koji demonstrira potencijalnu metodu zaobila쬰nja uklju캜uje kreiranje naloga, aktivaciju 2FA, resetovanje lozinke i naknadnu prijavu bez zahteva za 2FA.

### **La쬹i Zahtevi**

Kori코캖enje la쬹ih zahteva za prikrivanje poku코aja brute force ili zavaravanje mehanizama ograni캜enja brzine dodaje jo코 jedan sloj strategijama zaobila쬰nja. Izrada takvih zahteva zahteva nijansirano razumevanje sigurnosnih mera aplikacije i pona코anja ograni캜enja brzine.

## Reference

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)


### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) je pretra쬴va캜 pokretan **dark-web-om** koji nudi **besplatne** funkcionalnosti za proveru da li je kompanija ili njeni korisnici **kompromitovani** od strane **malvera za kra캠u podataka**.

Primarni cilj WhiteIntel-a je borba protiv preuzimanja naloga i napada ransomvera koji proizilaze iz malvera za kra캠u informacija.

Mo쬰te posetiti njihovu veb lokaciju i isprobati njihovu ma코inu za pretragu **besplatno** na:

{% embed url="https://whiteintel.io" %}
