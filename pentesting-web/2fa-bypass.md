# Bypass 2FA/OTP

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na GitHubie.

</details>

## **Techniki Bypassowania Wzmocnionej Dwuetapowej Autoryzacji**

### **Bezporedni Dostp do Kocowego Punktu**

Aby omin 2FA, dostp do nastpnego punktu kocowego jest kluczowy. W przypadku niepowodzenia, zmie **nag贸wek Referrer** tak, aby naladowa nawigacj z strony weryfikacji 2FA.

### **Ponowne Wykorzystanie Tokena**

Ponowne wykorzystanie wczeniej u偶ytych token贸w do uwierzytelniania w ramach konta mo偶e by skuteczne.

### **Wykorzystanie Niewykorzystanych Token贸w**

Pr贸ba wydobycia tokenu z wasnego konta w celu ominiecia 2FA w innym koncie.

### **Ujawnienie Tokenu**

Sprawd藕, czy token jest ujawniony w odpowiedzi z aplikacji internetowej.

### **Wykorzystanie Linku Weryfikacyjnego**

Wykorzystanie **linku weryfikacyjnego wysanego drog mailow podczas tworzenia konta** mo偶e umo偶liwi dostp do profilu bez 2FA, jak opisano w szczeg贸owym [pocie](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulacja Sesj**

Rozpoczcie sesji zar贸wno dla konta u偶ytkownika, jak i ofiary, oraz ukoczenie 2FA dla konta u偶ytkownika bez kontynuowania, umo偶liwia pr贸b dostpu do kolejnego kroku w przepywie konta ofiary, wykorzystujc ograniczenia zarzdzania sesj po stronie serwera.

### **Mechanizm Resetowania Hasa**

Badanie funkcji resetowania hasa, kt贸ra loguje u偶ytkownika do aplikacji po zresetowaniu, pod ktem potencjau do wielokrotnego resetowania za pomoc tego samego linku, jest kluczowe. Logowanie si za pomoc nowo zresetowanych danych uwierzytelniajcych mo偶e omin 2FA.

### **Kompromitacja Platformy OAuth**

Skompromitowanie konta u偶ytkownika na zaufanej platformie **OAuth** (np. Google, Facebook) mo偶e otworzy drog do ominiecia 2FA.

### **Ataki Brute Force**

#### **Brak Limitu Szybkoci**

Brak limitu na liczb pr贸b kodu umo偶liwia ataki brute force, cho nale偶y wzi pod uwag potencjalne ciche ograniczenia szybkoci.

#### **Wolny Atak Brute Force**

Wolny atak brute force jest mo偶liwy, gdy istniej limity szybkoci przepywu bez og贸lnego limitu szybkoci.

#### **Resetowanie Limitu Ponownego Wysyania Kodu**

Ponowne wysanie kodu resetuje limit szybkoci, uatwiajc kontynuacj pr贸b ataku brute force.

#### **Ominicie Limitu Szybkoci Po Stronie Klienta**

Dokumentuje techniki omijania limit贸w szybkoci po stronie klienta.

#### **Brak Limitu Szybkoci Dla Dziaa Wewntrznych**

Limity szybkoci mog chroni przed pr贸bami logowania, ale nie przed dziaaniami wewntrznymi na koncie.

#### **Koszty Ponownego Wysyania Kodu SMS**

Nadmierna ponowna wysyka kod贸w za pomoc SMS generuje koszty dla firmy, cho nie omija 2FA.

#### **Nieskoczone Generowanie OTP**

Nieskoczone generowanie OTP za pomoc prostych kod贸w umo偶liwia atak brute force poprzez ponowne pr贸bowanie maego zestawu kod贸w.

### **Wykorzystanie Wycigu Warunk贸w**

Wykorzystanie wycig贸w warunk贸w do ominiecia 2FA mo偶na znale藕 w konkretnym dokumencie.

### **Ukierunkowane Nara偶enie CSRF/Clickjacking**

Eksploracja nara偶e CSRF lub Clickjacking w celu wyczenia 2FA jest skuteczn strategi.

### **Wykorzystanie Funkcji "Zapamitaj Mnie"**

#### **Przewidywalne Wartoci Ciasteczka**

Zgadywanie wartoci ciasteczka "zapamitaj mnie" mo偶e omin ograniczenia.

#### **Podszywanie si pod Adres IP**

Podszywanie si pod adres IP ofiary za pomoc nag贸wka **X-Forwarded-For** mo偶e omin ograniczenia.

### **Wykorzystanie Starszych Wersji**

#### **Poddomeny**

Testowanie poddomen mo偶e wykorzysta przestarzae wersje bez wsparcia dla 2FA lub zawiera podatne implementacje 2FA.

#### **Koc贸wki API**

Starsze wersje API, wskazane przez cie偶ki katalogowe /v\*, mog by podatne na metody omijania 2FA.

### **Obsuga Poprzednich Sesji**

Zakoczenie istniejcych sesji po aktywacji 2FA zabezpiecza konta przed nieautoryzowanym dostpem z kompromitowanych sesji.

### **Wady Kontroli Dostpu z Kodami Zapasowymi**

Natychmiastowe generowanie i potencjalne nieautoryzowane pozyskiwanie kod贸w zapasowych po aktywacji 2FA, zwaszcza przy bdnej konfiguracji CORS/XSS, stanowi ryzyko.

### **Ujawnienie Informacji na Stronie 2FA**

Ujawnienie wra偶liwych informacji (np. numer telefonu) na stronie weryfikacji 2FA stanowi zagro偶enie.

### **Wyczenie Resetowania Hasa 2FA**

Proces demonstrujcy potencjaln metod omijania obejmuje tworzenie konta, aktywacj 2FA, resetowanie hasa i kolejne logowanie bez wymagania 2FA.

### **Zapytania Przechodnie**

Wykorzystanie zapyta przekierowujcych do zaciemnienia pr贸b brute force lub wprowadzenia w bd mechanizm贸w ograniczania szybkoci dodaje kolejn warstw do strategii omijania. Tworzenie takich zapyta wymaga subtelnej znajomoci rodk贸w bezpieczestwa aplikacji i zachowa ograniczania szybkoci.

## Odnoniki

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na GitHubie.

</details>
