# Hop-by-hop zaglavlja

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **cybersecurity kompaniji**? Å½elite li da vidite svoju **kompaniju reklamiranu na HackTricks-u**? Ili Å¾elite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **PridruÅ¾ite se** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na [hacktricks repo](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Ovo je saÅ¾etak posta [https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers](https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers)**

Hop-by-hop zaglavlja su specifiÄna za jednu transportnu vezu, uglavnom se koriste u HTTP/1.1 za upravljanje podacima izmeÄ‘u dve Ävorove (kao Å¡to su klijent-proxy ili proxy-proxy) i nisu namenjena za prosleÄ‘ivanje. Standardna hop-by-hop zaglavlja ukljuÄuju `Keep-Alive`, `Transfer-Encoding`, `TE`, `Connection`, `Trailer`, `Upgrade`, `Proxy-Authorization` i `Proxy-Authenticate`, kako je definisano u [RFC 2616](https://tools.ietf.org/html/rfc2616#section-13.5.1). Dodatna zaglavlja mogu biti oznaÄena kao hop-by-hop putem zaglavlja `Connection`.

### Zloupotreba Hop-by-Hop zaglavlja
Nepropisno upravljanje hop-by-hop zaglavlja od strane proxy-ja moÅ¾e dovesti do sigurnosnih problema. Iako se oÄekuje da proxy-ji uklone ova zaglavlja, neki to ne Äine, Å¡to stvara potencijalne ranjivosti.

### Testiranje obrade Hop-by-Hop zaglavlja
Obrada hop-by-hop zaglavlja moÅ¾e se testirati posmatranjem promena u odgovorima servera kada se odreÄ‘ena zaglavlja oznaÄe kao hop-by-hop. Alati i skripte mogu automatizovati ovaj proces, identifikujuÄ‡i kako proxy-ji upravljaju ovim zaglavljima i potencijalno otkrivajuÄ‡i loÅ¡e konfiguracije ili ponaÅ¡anja proxy-ja.

Zloupotreba hop-by-hop zaglavlja moÅ¾e dovesti do razliÄitih sigurnosnih implikacija. U nastavku su prikazani neki primeri koji pokazuju kako se ova zaglavlja mogu manipulisati u potencijalne napade:

### ZaobilaÅ¾enje sigurnosnih kontrola pomoÄ‡u `X-Forwarded-For`
NapadaÄ moÅ¾e manipulisati zaglavljem `X-Forwarded-For` kako bi zaobiÅ¡ao kontrolu pristupa zasnovanu na IP adresi. Ovo zaglavlje se Äesto koristi od strane proxy-ja kako bi pratili IP adresu porekla klijenta. MeÄ‘utim, ako proxy tretira ovo zaglavlje kao hop-by-hop i prosleÄ‘uje ga bez odgovarajuÄ‡e validacije, napadaÄ moÅ¾e laÅ¾irati svoju IP adresu.

**Scenario napada:**
1. NapadaÄ Å¡alje HTTP zahtev veb aplikaciji iza proxy-ja, ukljuÄujuÄ‡i laÅ¾nu IP adresu u zaglavlju `X-Forwarded-For`.
2. NapadaÄ takoÄ‘e ukljuÄuje zaglavlje `Connection: close, X-Forwarded-For`, Å¡to natera proxy da tretira `X-Forwarded-For` kao hop-by-hop.
3. LoÅ¡e konfigurisani proxy prosleÄ‘uje zahtev veb aplikaciji bez laÅ¾nog zaglavlja `X-Forwarded-For`.
4. Veb aplikacija, ne videÄ‡i originalno zaglavlje `X-Forwarded-For`, moÅ¾e smatrati zahtev dolazi direktno od pouzdanog proxy-ja, Å¡to potencijalno omoguÄ‡ava neovlaÅ¡Ä‡en pristup.

### Trovanje keÅ¡a putem ubacivanja zaglavlja Hop-by-Hop
Ako keÅ¡ server netaÄno keÅ¡ira sadrÅ¾aj na osnovu hop-by-hop zaglavlja, napadaÄ moÅ¾e ubaciti zlonamerna zaglavlja kako bi otrovao keÅ¡. Ovo bi posluÅ¾ilo netaÄan ili zlonameran sadrÅ¾aj korisnicima koji zahtevaju isti resurs.

**Scenario napada:**
1. NapadaÄ Å¡alje zahtev veb aplikaciji sa zaglavljem hop-by-hop koje ne bi trebalo da se keÅ¡ira (npr. `Connection: close, Cookie`).
2. LoÅ¡e konfigurisani keÅ¡ server ne uklanja hop-by-hop zaglavlje i keÅ¡ira odgovor specifiÄan za sesiju napadaÄa.
3. BuduÄ‡i korisnici koji zahtevaju isti resurs dobijaju keÅ¡iran odgovor, koji je prilagoÄ‘en napadaÄu, Å¡to potencijalno dovodi do preuzimanja sesije ili otkrivanja osetljivih informacija.

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **cybersecurity kompaniji**? Å½elite li da vidite svoju **kompaniju reklamiranu na HackTricks-u**? Ili Å¾elite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **PridruÅ¾ite se** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na [hacktricks repo](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
