# hop-by-hop headers

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**ì´ê²ƒì€ [https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers](https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers) ê²Œì‹œë¬¼ì˜ ìš”ì•½ì…ë‹ˆë‹¤.**

Hop-by-hop í—¤ë”ëŠ” ë‹¨ì¼ ì „ì†¡ ìˆ˜ì¤€ ì—°ê²°ì— íŠ¹ì •í•˜ë©°, ì£¼ë¡œ HTTP/1.1ì—ì„œ ë‘ ë…¸ë“œ(í´ë¼ì´ì–¸íŠ¸-í”„ë¡ì‹œ ë˜ëŠ” í”„ë¡ì‹œ-í”„ë¡ì‹œ) ê°„ì˜ ë°ì´í„° ê´€ë¦¬ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ë©°, ì „ë‹¬ë  ì˜ë„ê°€ ì•„ë‹™ë‹ˆë‹¤. í‘œì¤€ hop-by-hop í—¤ë”ì—ëŠ” `Keep-Alive`, `Transfer-Encoding`, `TE`, `Connection`, `Trailer`, `Upgrade`, `Proxy-Authorization`, ë° `Proxy-Authenticate`ê°€ í¬í•¨ë˜ë©°, ì´ëŠ” [RFC 2616](https://tools.ietf.org/html/rfc2616#section-13.5.1)ì—ì„œ ì •ì˜ë©ë‹ˆë‹¤. ì¶”ê°€ í—¤ë”ëŠ” `Connection` í—¤ë”ë¥¼ í†µí•´ hop-by-hopìœ¼ë¡œ ì§€ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Hop-by-Hop í—¤ë” ë‚¨ìš©
í”„ë¡ì‹œê°€ hop-by-hop í—¤ë”ë¥¼ ë¶€ì ì ˆí•˜ê²Œ ê´€ë¦¬í•˜ë©´ ë³´ì•ˆ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë¡ì‹œëŠ” ì´ëŸ¬í•œ í—¤ë”ë¥¼ ì œê±°í•´ì•¼ í•˜ì§€ë§Œ, ëª¨ë“  í”„ë¡ì‹œê°€ ê·¸ë ‡ê²Œ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì ì¬ì ì¸ ì·¨ì•½ì ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Hop-by-Hop í—¤ë” ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
íŠ¹ì • í—¤ë”ê°€ hop-by-hopìœ¼ë¡œ í‘œì‹œë  ë•Œ ì„œë²„ ì‘ë‹µì˜ ë³€í™”ë¥¼ ê´€ì°°í•˜ì—¬ hop-by-hop í—¤ë”ì˜ ì²˜ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„êµ¬ì™€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ê³¼ì •ì„ ìë™í™”í•˜ê³ , í”„ë¡ì‹œê°€ ì´ëŸ¬í•œ í—¤ë”ë¥¼ ì–´ë–»ê²Œ ê´€ë¦¬í•˜ëŠ”ì§€ ì‹ë³„í•˜ë©°, ì˜ëª»ëœ êµ¬ì„±ì´ë‚˜ í”„ë¡ì‹œ ë™ì‘ì„ ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Hop-by-hop í—¤ë”ë¥¼ ë‚¨ìš©í•˜ë©´ ë‹¤ì–‘í•œ ë³´ì•ˆ ë¬¸ì œë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì´ëŸ¬í•œ í—¤ë”ê°€ ì ì¬ì ì¸ ê³µê²©ì„ ìœ„í•´ ì–´ë–»ê²Œ ì¡°ì‘ë  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ëª‡ ê°€ì§€ ì˜ˆì…ë‹ˆë‹¤:

### `X-Forwarded-For`ë¡œ ë³´ì•ˆ ì œì–´ ìš°íšŒ
ê³µê²©ìëŠ” `X-Forwarded-For` í—¤ë”ë¥¼ ì¡°ì‘í•˜ì—¬ IP ê¸°ë°˜ ì ‘ê·¼ ì œì–´ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í—¤ë”ëŠ” ì¢…ì¢… í”„ë¡ì‹œê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ì›ë˜ IP ì£¼ì†Œë¥¼ ì¶”ì í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í”„ë¡ì‹œê°€ ì´ í—¤ë”ë¥¼ hop-by-hopìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ì ì ˆí•œ ê²€ì¦ ì—†ì´ ì „ë‹¬í•˜ë©´, ê³µê²©ìëŠ” ìì‹ ì˜ IP ì£¼ì†Œë¥¼ ìŠ¤í‘¸í•‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
1. ê³µê²©ìëŠ” í”„ë¡ì‹œ ë’¤ì— ìˆëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— HTTP ìš”ì²­ì„ ë³´ë‚´ë©°, `X-Forwarded-For` í—¤ë”ì— ê°€ì§œ IP ì£¼ì†Œë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
2. ê³µê²©ìëŠ” ë˜í•œ `Connection: close, X-Forwarded-For` í—¤ë”ë¥¼ í¬í•¨í•˜ì—¬ í”„ë¡ì‹œê°€ `X-Forwarded-For`ë¥¼ hop-by-hopìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.
3. ì˜ëª» êµ¬ì„±ëœ í”„ë¡ì‹œëŠ” ìŠ¤í‘¸í•‘ëœ `X-Forwarded-For` í—¤ë” ì—†ì´ ìš”ì²­ì„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬í•©ë‹ˆë‹¤.
4. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì›ë˜ì˜ `X-Forwarded-For` í—¤ë”ë¥¼ ë³´ì§€ ëª»í•˜ë¯€ë¡œ ìš”ì²­ì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í”„ë¡ì‹œì—ì„œ ì§ì ‘ ì˜¨ ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ì—¬, ë¬´ë‹¨ ì ‘ê·¼ì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Hop-by-Hop í—¤ë” ì£¼ì…ì„ í†µí•œ ìºì‹œ ì˜¤ì—¼
ìºì‹œ ì„œë²„ê°€ hop-by-hop í—¤ë”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì½˜í…ì¸ ë¥¼ ì˜ëª» ìºì‹œí•˜ë©´, ê³µê²©ìëŠ” ì•…ì„± í—¤ë”ë¥¼ ì£¼ì…í•˜ì—¬ ìºì‹œë¥¼ ì˜¤ì—¼ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•˜ëŠ” ì‚¬ìš©ìì—ê²Œ ì˜ëª»ë˜ê±°ë‚˜ ì•…ì„± ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ê²Œ ë©ë‹ˆë‹¤.

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
1. ê³µê²©ìëŠ” ìºì‹œë˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” hop-by-hop í—¤ë”(ì˜ˆ: `Connection: close, Cookie`)ê°€ í¬í•¨ëœ ìš”ì²­ì„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë³´ëƒ…ë‹ˆë‹¤.
2. ì˜ëª» êµ¬ì„±ëœ ìºì‹œ ì„œë²„ëŠ” hop-by-hop í—¤ë”ë¥¼ ì œê±°í•˜ì§€ ì•Šê³  ê³µê²©ìì˜ ì„¸ì…˜ì— íŠ¹ì •í•œ ì‘ë‹µì„ ìºì‹œí•©ë‹ˆë‹¤.
3. ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•˜ëŠ” ë¯¸ë˜ì˜ ì‚¬ìš©ìë“¤ì€ ê³µê²©ìë¥¼ ìœ„í•´ ì¡°ì •ëœ ìºì‹œëœ ì‘ë‹µì„ ë°›ê²Œ ë˜ì–´, ì„¸ì…˜ í•˜ì´ì¬í‚¹ì´ë‚˜ ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
