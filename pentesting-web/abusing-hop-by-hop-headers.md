# hop-by-hop headers

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Bu, [https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers](https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers) gÃ¶nderisinin bir Ã¶zetidir.**

Hop-by-hop baÅŸlÄ±klarÄ±, iki dÃ¼ÄŸÃ¼m (Ã¶rneÄŸin, istemci-proxy veya proxy-proxy) arasÄ±ndaki verileri yÃ¶netmek iÃ§in HTTP/1.1'de kullanÄ±lan, tek bir taÅŸÄ±ma dÃ¼zeyi baÄŸlantÄ±sÄ±na Ã¶zgÃ¼ baÅŸlÄ±klardÄ±r ve iletilmek Ã¼zere tasarlanmamÄ±ÅŸtÄ±r. Standart hop-by-hop baÅŸlÄ±klarÄ± arasÄ±nda `Keep-Alive`, `Transfer-Encoding`, `TE`, `Connection`, `Trailer`, `Upgrade`, `Proxy-Authorization` ve `Proxy-Authenticate` yer alÄ±r; bunlar [RFC 2616](https://tools.ietf.org/html/rfc2616#section-13.5.1) ile tanÄ±mlanmÄ±ÅŸtÄ±r. Ek baÅŸlÄ±klar, `Connection` baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla hop-by-hop olarak belirlenebilir.

### Hop-by-Hop BaÅŸlÄ±klarÄ±nÄ±n Suistimali
Proxy'ler tarafÄ±ndan hop-by-hop baÅŸlÄ±klarÄ±nÄ±n yanlÄ±ÅŸ yÃ¶netimi gÃ¼venlik sorunlarÄ±na yol aÃ§abilir. Proxy'lerin bu baÅŸlÄ±klarÄ± kaldÄ±rmasÄ± beklenirken, hepsi bunu yapmadÄ±ÄŸÄ± iÃ§in potansiyel zafiyetler oluÅŸabilir.

### Hop-by-Hop BaÅŸlÄ±k YÃ¶netimini Test Etme
Hop-by-hop baÅŸlÄ±klarÄ±nÄ±n yÃ¶netimi, belirli baÅŸlÄ±klar hop-by-hop olarak iÅŸaretlendiÄŸinde sunucu yanÄ±tlarÄ±ndaki deÄŸiÅŸiklikleri gÃ¶zlemleyerek test edilebilir. AraÃ§lar ve betikler bu sÃ¼reci otomatikleÅŸtirerek, proxy'lerin bu baÅŸlÄ±klarÄ± nasÄ±l yÃ¶nettiÄŸini belirleyebilir ve potansiyel yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ± veya proxy davranÄ±ÅŸlarÄ±nÄ± ortaya Ã§Ä±karabilir.

Hop-by-hop baÅŸlÄ±klarÄ±nÄ±n suistimali Ã§eÅŸitli gÃ¼venlik sonuÃ§larÄ±na yol aÃ§abilir. AÅŸaÄŸÄ±da, bu baÅŸlÄ±klarÄ±n potansiyel saldÄ±rÄ±lar iÃ§in nasÄ±l manipÃ¼le edilebileceÄŸini gÃ¶steren birkaÃ§ Ã¶rnek bulunmaktadÄ±r:

### `X-Forwarded-For` ile GÃ¼venlik Kontrollerini AÅŸma
Bir saldÄ±rgan, IP tabanlÄ± eriÅŸim kontrollerini aÅŸmak iÃ§in `X-Forwarded-For` baÅŸlÄ±ÄŸÄ±nÄ± manipÃ¼le edebilir. Bu baÅŸlÄ±k, genellikle proxy'ler tarafÄ±ndan bir istemcinin kaynak IP adresini izlemek iÃ§in kullanÄ±lÄ±r. Ancak, bir proxy bu baÅŸlÄ±ÄŸÄ± hop-by-hop olarak ele alÄ±r ve uygun doÄŸrulama olmadan iletirse, bir saldÄ±rgan IP adresini taklit edebilir.

**SaldÄ±rÄ± Senaryosu:**
1. SaldÄ±rgan, `X-Forwarded-For` baÅŸlÄ±ÄŸÄ±nda sahte bir IP adresi iÃ§eren bir HTTP isteÄŸi gÃ¶nderir.
2. SaldÄ±rgan ayrÄ±ca `Connection: close, X-Forwarded-For` baÅŸlÄ±ÄŸÄ±nÄ± ekler, bu da proxy'nin `X-Forwarded-For`'u hop-by-hop olarak ele almasÄ±nÄ± saÄŸlar.
3. YanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ proxy, sahte `X-Forwarded-For` baÅŸlÄ±ÄŸÄ± olmadan isteÄŸi web uygulamasÄ±na iletir.
4. Web uygulamasÄ±, orijinal `X-Forwarded-For` baÅŸlÄ±ÄŸÄ±nÄ± gÃ¶rmediÄŸi iÃ§in isteÄŸi gÃ¼venilir bir proxy'den geliyormuÅŸ gibi deÄŸerlendirebilir ve yetkisiz eriÅŸime izin verebilir.

### Hop-by-Hop BaÅŸlÄ±k Enjeksiyonu ile Ã–nbellek Zehirleme
EÄŸer bir Ã¶nbellek sunucusu hop-by-hop baÅŸlÄ±klarÄ±na dayanarak iÃ§eriÄŸi yanlÄ±ÅŸ bir ÅŸekilde Ã¶nbelleÄŸe alÄ±rsa, bir saldÄ±rgan kÃ¶tÃ¼ niyetli baÅŸlÄ±klar enjekte ederek Ã¶nbelleÄŸi zehirleyebilir. Bu, aynÄ± kaynaÄŸÄ± talep eden kullanÄ±cÄ±lara yanlÄ±ÅŸ veya kÃ¶tÃ¼ niyetli iÃ§erik sunar.

**SaldÄ±rÄ± Senaryosu:**
1. Bir saldÄ±rgan, Ã¶nbelleÄŸe alÄ±nmamasÄ± gereken bir hop-by-hop baÅŸlÄ±ÄŸÄ± (Ã¶rneÄŸin, `Connection: close, Cookie`) ile bir web uygulamasÄ±na istek gÃ¶nderir.
2. KÃ¶tÃ¼ yapÄ±landÄ±rÄ±lmÄ±ÅŸ Ã¶nbellek sunucusu hop-by-hop baÅŸlÄ±ÄŸÄ±nÄ± kaldÄ±rmaz ve yanÄ±tÄ± saldÄ±rganÄ±n oturumuna Ã¶zgÃ¼ olarak Ã¶nbelleÄŸe alÄ±r.
3. AynÄ± kaynaÄŸÄ± talep eden gelecekteki kullanÄ±cÄ±lar, saldÄ±rgana Ã¶zel olarak hazÄ±rlanmÄ±ÅŸ Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ yanÄ±tÄ± alÄ±r; bu da oturum kaÃ§Ä±rma veya hassas bilgilerin ifÅŸasÄ±na yol aÃ§abilir.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
