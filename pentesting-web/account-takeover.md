# PrzejÄ™cie Konta

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## **Problem z AutoryzacjÄ…**

NaleÅ¼y sprÃ³bowaÄ‡ zmieniÄ‡ adres e-mail konta, a proces potwierdzenia **musi byÄ‡ zbadany**. JeÅ›li okaÅ¼e siÄ™ **sÅ‚aby**, adres e-mail powinien zostaÄ‡ zmieniony na adres zamierzonej ofiary, a nastÄ™pnie potwierdzony.

## **Problem z NormalizacjÄ… Unicode**

1. Konto zamierzonej ofiary `victim@gmail.com`
2. NaleÅ¼y utworzyÄ‡ konto uÅ¼ywajÄ…c Unicode\
na przykÅ‚ad: `viÄ‡tim@gmail.com`

Jak wyjaÅ›niono w [**tej prezentacji**](https://www.youtube.com/watch?v=CiIyaZ3x49c), poprzedni atak moÅ¼na rÃ³wnieÅ¼ przeprowadziÄ‡, naduÅ¼ywajÄ…c zewnÄ™trznych dostawcÃ³w toÅ¼samoÅ›ci:

* UtwÃ³rz konto u zewnÄ™trznego dostawcy toÅ¼samoÅ›ci z podobnym adresem e-mail do ofiary, uÅ¼ywajÄ…c jakiegoÅ› znaku unicode (`viÄ‡tim@company.com`).
* ZewnÄ™trzny dostawca nie powinien weryfikowaÄ‡ adresu e-mail.
* JeÅ›li dostawca toÅ¼samoÅ›ci weryfikuje adres e-mail, byÄ‡ moÅ¼e moÅ¼esz zaatakowaÄ‡ czÄ™Å›Ä‡ domeny, na przykÅ‚ad: `victim@Ä‡ompany.com` i zarejestrowaÄ‡ tÄ™ domenÄ™, majÄ…c nadziejÄ™, Å¼e dostawca toÅ¼samoÅ›ci wygeneruje wersjÄ™ ascii domeny, podczas gdy platforma ofiary znormalizuje nazwÄ™ domeny.
* Zaloguj siÄ™ za poÅ›rednictwem tego dostawcy toÅ¼samoÅ›ci na platformie ofiary, ktÃ³ra powinna znormalizowaÄ‡ znak unicode i pozwoliÄ‡ ci uzyskaÄ‡ dostÄ™p do konta ofiary.

Aby uzyskaÄ‡ wiÄ™cej szczegÃ³Å‚Ã³w, zapoznaj siÄ™ z dokumentem na temat Normalizacji Unicode:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Ponowne UÅ¼ycie Tokena Resetowania**

JeÅ›li system docelowy pozwala na **ponowne uÅ¼ycie linku resetujÄ…cego**, naleÅ¼y podjÄ…Ä‡ wysiÅ‚ki, aby **znaleÅºÄ‡ wiÄ™cej linkÃ³w resetujÄ…cych** przy uÅ¼yciu narzÄ™dzi takich jak `gau`, `wayback` lub `scan.io`.

## **Przed PrzejÄ™ciem Konta**

1. E-mail ofiary powinien byÄ‡ uÅ¼yty do rejestracji na platformie, a hasÅ‚o powinno byÄ‡ ustawione (naleÅ¼y sprÃ³bowaÄ‡ je potwierdziÄ‡, chociaÅ¼ brak dostÄ™pu do e-maili ofiary moÅ¼e to uniemoÅ¼liwiÄ‡).
2. NaleÅ¼y czekaÄ‡, aÅ¼ ofiara zarejestruje siÄ™ za pomocÄ… OAuth i potwierdzi konto.
3. Mamy nadziejÄ™, Å¼e standardowa rejestracja zostanie potwierdzona, co pozwoli na dostÄ™p do konta ofiary.

## **BÅ‚Ä…d Konfiguracji CORS do PrzejÄ™cia Konta**

JeÅ›li strona zawiera **bÅ‚Ä™dy konfiguracji CORS**, moÅ¼esz byÄ‡ w stanie **ukraÅ›Ä‡ wraÅ¼liwe informacje** od uÅ¼ytkownika, aby **przejÄ…Ä‡ jego konto** lub zmusiÄ‡ go do zmiany informacji uwierzytelniajÄ…cych w tym samym celu:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF do PrzejÄ™cia Konta**

JeÅ›li strona jest podatna na CSRF, moÅ¼esz byÄ‡ w stanie sprawiÄ‡, Å¼e **uÅ¼ytkownik zmodyfikuje swoje hasÅ‚o**, e-mail lub uwierzytelnienie, abyÅ› mÃ³gÅ‚ uzyskaÄ‡ do niego dostÄ™p:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS do PrzejÄ™cia Konta**

JeÅ›li znajdziesz XSS w aplikacji, moÅ¼esz byÄ‡ w stanie ukraÅ›Ä‡ ciasteczka, lokalne przechowywanie lub informacje ze strony internetowej, ktÃ³re mogÄ… pozwoliÄ‡ ci przejÄ…Ä‡ konto:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Ta Sama Pochodna + Ciasteczka**

JeÅ›li znajdziesz ograniczone XSS lub przejÄ™cie subdomeny, moÅ¼esz manipulowaÄ‡ ciasteczkami (na przykÅ‚ad je ustalajÄ…c), aby sprÃ³bowaÄ‡ skompromitowaÄ‡ konto ofiary:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Atakowanie Mechanizmu Resetowania HasÅ‚a**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulacja OdpowiedziÄ…**

JeÅ›li odpowiedÅº uwierzytelniajÄ…ca moÅ¼e byÄ‡ **zredukowana do prostego boolean, sprÃ³buj zmieniÄ‡ false na true** i zobacz, czy uzyskasz dostÄ™p.

## OAuth do PrzejÄ™cia Konta

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## WstrzykniÄ™cie NagÅ‚Ã³wka Host

1. NagÅ‚Ã³wek Host jest modyfikowany po zainicjowaniu Å¼Ä…dania resetowania hasÅ‚a.
2. NagÅ‚Ã³wek proxy `X-Forwarded-For` jest zmieniany na `attacker.com`.
3. NagÅ‚Ã³wki Host, Referrer i Origin sÄ… jednoczeÅ›nie zmieniane na `attacker.com`.
4. Po zainicjowaniu resetowania hasÅ‚a i wybraniu opcji ponownego wysÅ‚ania maila, stosowane sÄ… wszystkie trzy powyÅ¼sze metody.

## Manipulacja OdpowiedziÄ…

1. **Manipulacja Kodem**: Kod statusu jest zmieniany na `200 OK`.
2. **Manipulacja Kodem i TreÅ›ciÄ…**:
* Kod statusu jest zmieniany na `200 OK`.
* TreÅ›Ä‡ odpowiedzi jest modyfikowana na `{"success":true}` lub pusty obiekt `{}`.

Te techniki manipulacji sÄ… skuteczne w scenariuszach, w ktÃ³rych JSON jest wykorzystywany do przesyÅ‚ania i odbierania danych.

## Zmiana e-maila bieÅ¼Ä…cej sesji

Z [tego raportu](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Napastnik prosi o zmianÄ™ swojego e-maila na nowy.
* Napastnik otrzymuje link do potwierdzenia zmiany e-maila.
* Napastnik wysyÅ‚a ofierze link, aby kliknÄ™Å‚a w niego.
* E-mail ofiary zostaje zmieniony na ten wskazany przez napastnika.
* Napastnik moÅ¼e odzyskaÄ‡ hasÅ‚o i przejÄ…Ä‡ konto.

To rÃ³wnieÅ¼ miaÅ‚o miejsce w [**tym raporcie**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Stare Ciasteczka

Jak wyjaÅ›niono [**w tym poÅ›cie**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), moÅ¼liwe byÅ‚o zalogowanie siÄ™ na konto, zapisanie ciasteczek jako uwierzytelniony uÅ¼ytkownik, wylogowanie siÄ™, a nastÄ™pnie ponowne zalogowanie.\
Przy nowym logowaniu, chociaÅ¼ mogÄ… byÄ‡ generowane rÃ³Å¼ne ciasteczka, stare zaczÄ™Å‚y dziaÅ‚aÄ‡ ponownie.

## Referencje

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
