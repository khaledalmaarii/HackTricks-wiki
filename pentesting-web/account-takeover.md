# Hesap Ele GeÃ§irme

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **Yetkilendirme Sorunu**

Bir hesabÄ±n e-posta adresinin deÄŸiÅŸtirilmesi denenmeli ve onay sÃ¼reci **incelenmelidir**. EÄŸer **zayÄ±f** bulunursa, e-posta hedef kurbanÄ±n e-posta adresi ile deÄŸiÅŸtirilip onaylanmalÄ±dÄ±r.

## **Unicode Normalizasyon Sorunu**

1. Hedef kurbanÄ±n hesabÄ± `victim@gmail.com`
2. Unicode kullanarak bir hesap oluÅŸturulmalÄ±dÄ±r\
Ã¶rneÄŸin: `viÄ‡tim@gmail.com`

[**bu konuÅŸmada**](https://www.youtube.com/watch?v=CiIyaZ3x49c) aÃ§Ä±klandÄ±ÄŸÄ± gibi, Ã¶nceki saldÄ±rÄ± Ã¼Ã§Ã¼ncÃ¼ taraf kimlik saÄŸlayÄ±cÄ±larÄ±nÄ± kÃ¶tÃ¼ye kullanarak da yapÄ±labilir:

* KurbanÄ±n e-posta adresine benzer bir e-posta ile Ã¼Ã§Ã¼ncÃ¼ taraf kimlik saÄŸlayÄ±cÄ±sÄ±nda bir hesap oluÅŸturun (`viÄ‡tim@company.com`).
* ÃœÃ§Ã¼ncÃ¼ taraf saÄŸlayÄ±cÄ± e-posta adresini doÄŸrulamamalÄ±dÄ±r.
* EÄŸer kimlik saÄŸlayÄ±cÄ± e-posta adresini doÄŸruluyorsa, belki de alan adÄ± kÄ±smÄ±nÄ± `victim@Ä‡ompany.com` gibi saldÄ±rÄ±ya uÄŸratabilir ve o alan adÄ±nÄ± kaydedip kimlik saÄŸlayÄ±cÄ±nÄ±n alan adÄ±nÄ±n ascii versiyonunu oluÅŸturmasÄ±nÄ± umabilirsiniz, bu sÄ±rada kurban platformu alan adÄ± adÄ±nÄ± normalize eder.
* Bu kimlik saÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla kurban platformuna giriÅŸ yapÄ±n, bu platform unicode karakterini normalize etmeli ve kurban hesabÄ±na eriÅŸmenize izin vermelidir.

Daha fazla ayrÄ±ntÄ± iÃ§in, Unicode Normalizasyonu belgesine bakÄ±n:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **SÄ±fÄ±rlama Token'Ä±nÄ± Yeniden Kullanma**

Hedef sistem **sÄ±fÄ±rlama baÄŸlantÄ±sÄ±nÄ±n yeniden kullanÄ±lmasÄ±na** izin veriyorsa, `gau`, `wayback` veya `scan.io` gibi araÃ§lar kullanarak **daha fazla sÄ±fÄ±rlama baÄŸlantÄ±sÄ± bulmak iÃ§in Ã§aba sarf edilmelidir**.

## **Hesap Ele GeÃ§irmeden Ã–nce**

1. KurbanÄ±n e-posta adresi platformda kaydolmak iÃ§in kullanÄ±lmalÄ± ve bir ÅŸifre belirlenmelidir (kurbanÄ±n e-postalarÄ±na eriÅŸim yoksa onaylama giriÅŸimi yapÄ±lamayabilir).
2. KurbanÄ±n OAuth kullanarak kaydolmasÄ±nÄ± ve hesabÄ± onaylamasÄ±nÄ± beklemelidir.
3. Normal kaydÄ±n onaylanmasÄ± umulmakta, bu da kurbanÄ±n hesabÄ±na eriÅŸim saÄŸlanmasÄ±nÄ± mÃ¼mkÃ¼n kÄ±lmaktadÄ±r.

## **CORS YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ± ile Hesap Ele GeÃ§irme**

Sayfa **CORS yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ±** iÃ§eriyorsa, kullanÄ±cÄ±nÄ±n **hassas bilgilerini Ã§almak** veya aynÄ± amaÃ§la kimlik bilgilerini deÄŸiÅŸtirmesini saÄŸlamak iÃ§in **hesabÄ±nÄ± ele geÃ§irebilirsiniz**:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF ile Hesap Ele GeÃ§irme**

Sayfa CSRF'ye karÅŸÄ± savunmasÄ±zsa, **kullanÄ±cÄ±nÄ±n ÅŸifresini**, e-posta adresini veya kimlik doÄŸrulamasÄ±nÄ± deÄŸiÅŸtirmesini saÄŸlayarak ona eriÅŸim saÄŸlayabilirsiniz:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS ile Hesap Ele GeÃ§irme**

Uygulamada bir XSS bulursanÄ±z, Ã§erezleri, yerel depolamayÄ± veya hesabÄ± ele geÃ§irmenizi saÄŸlayacak web sayfasÄ±ndan bilgileri Ã§alabilirsiniz:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **AynÄ± Kaynak + Ã‡erezler**

SÄ±nÄ±rlÄ± bir XSS veya bir alt alan ele geÃ§irme bulursanÄ±z, Ã§erezlerle (Ã¶rneÄŸin, onlarÄ± sabitleyerek) o kurban hesabÄ±nÄ± tehlikeye atmayÄ± deneyebilirsiniz:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Åifre SÄ±fÄ±rlama MekanizmasÄ±na SaldÄ±rÄ±**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **YanÄ±t ManipÃ¼lasyonu**

EÄŸer kimlik doÄŸrulama yanÄ±tÄ± **basit bir boolean'a indirgenebiliyorsa, false'u true olarak deÄŸiÅŸtirmeyi deneyin** ve herhangi bir eriÅŸim elde edip edemediÄŸinizi gÃ¶rÃ¼n.

## OAuth ile Hesap Ele GeÃ§irme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host BaÅŸlÄ±k Enjeksiyonu

1. Åifre sÄ±fÄ±rlama isteÄŸi baÅŸlatÄ±ldÄ±ktan sonra Host baÅŸlÄ±ÄŸÄ± deÄŸiÅŸtirilir.
2. `X-Forwarded-For` proxy baÅŸlÄ±ÄŸÄ± `attacker.com` olarak deÄŸiÅŸtirilir.
3. Host, Referrer ve Origin baÅŸlÄ±klarÄ± aynÄ± anda `attacker.com` olarak deÄŸiÅŸtirilir.
4. Åifre sÄ±fÄ±rlama baÅŸlatÄ±ldÄ±ktan sonra e-postayÄ± yeniden gÃ¶ndermeyi seÃ§erken, yukarÄ±da belirtilen Ã¼Ã§ yÃ¶ntem de kullanÄ±lÄ±r.

## YanÄ±t ManipÃ¼lasyonu

1. **Kod ManipÃ¼lasyonu**: Durum kodu `200 OK` olarak deÄŸiÅŸtirilir.
2. **Kod ve GÃ¶vde ManipÃ¼lasyonu**:
* Durum kodu `200 OK` olarak deÄŸiÅŸtirilir.
* YanÄ±t gÃ¶vdesi `{"success":true}` veya boÅŸ bir nesne `{}` olarak deÄŸiÅŸtirilir.

Bu manipÃ¼lasyon teknikleri, veri iletimi ve alÄ±mÄ± iÃ§in JSON kullanÄ±ldÄ±ÄŸÄ±nda etkilidir.

## Mevcut oturumun e-posta adresini deÄŸiÅŸtirme

[bu rapordan](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* SaldÄ±rgan yeni bir e-posta ile e-posta adresini deÄŸiÅŸtirmeyi talep eder.
* SaldÄ±rgan, e-posta deÄŸiÅŸikliÄŸini onaylamak iÃ§in bir baÄŸlantÄ± alÄ±r.
* SaldÄ±rgan, kurbana baÄŸlantÄ±yÄ± gÃ¶nderir, bÃ¶ylece tÄ±klayabilir.
* KurbanÄ±n e-posta adresi saldÄ±rganÄ±n belirttiÄŸi e-posta adresi ile deÄŸiÅŸtirilir.
* SaldÄ±rgan ÅŸifreyi kurtarabilir ve hesabÄ± ele geÃ§irebilir.

Bu, [**bu raporda**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) da olmuÅŸtur.

### Eski Ã‡erezler

[**bu yazÄ±da**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9) aÃ§Ä±klandÄ±ÄŸÄ± gibi, bir hesaba giriÅŸ yapmak, Ã§erezleri kimlik doÄŸrulamasÄ± yapÄ±lmÄ±ÅŸ bir kullanÄ±cÄ± olarak kaydetmek, Ã§Ä±kÄ±ÅŸ yapmak ve sonra tekrar giriÅŸ yapmak mÃ¼mkÃ¼ndÃ¼.\
Yeni giriÅŸle, farklÄ± Ã§erezler oluÅŸturulmuÅŸ olsa da eski Ã§erezler tekrar Ã§alÄ±ÅŸmaya baÅŸladÄ±.

## Referanslar

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
