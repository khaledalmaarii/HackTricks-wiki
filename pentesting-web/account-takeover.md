# Prise de contr√¥le de compte

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

## **Probl√®me d'autorisation**

L'email d'un compte doit √™tre tent√© d'√™tre chang√©, et le processus de confirmation **doit √™tre examin√©**. S'il est jug√© **faible**, l'email doit √™tre chang√© pour celui de la victime pr√©vue et ensuite confirm√©.

## **Probl√®me de normalisation Unicode**

1. Le compte de la victime pr√©vue `victim@gmail.com`
2. Un compte doit √™tre cr√©√© en utilisant Unicode\
par exemple : `viƒátim@gmail.com`

Comme expliqu√© dans [**cette pr√©sentation**](https://www.youtube.com/watch?v=CiIyaZ3x49c), l'attaque pr√©c√©dente pourrait √©galement √™tre r√©alis√©e en abusant des fournisseurs d'identit√© tiers :

* Cr√©er un compte chez le fournisseur d'identit√© tiers avec un email similaire √† celui de la victime en utilisant un caract√®re unicode (`viƒátim@company.com`).
* Le fournisseur tiers ne doit pas v√©rifier l'email.
* Si le fournisseur d'identit√© v√©rifie l'email, peut-√™tre pouvez-vous attaquer la partie domaine comme : `victim@ƒáompany.com` et enregistrer ce domaine en esp√©rant que le fournisseur d'identit√© g√©n√®re la version ascii du domaine pendant que la plateforme de la victime normalise le nom de domaine.
* Connectez-vous via ce fournisseur d'identit√© sur la plateforme de la victime qui devrait normaliser le caract√®re unicode et vous permettre d'acc√©der au compte de la victime.

Pour plus de d√©tails, r√©f√©rez-vous au document sur la normalisation Unicode :

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **R√©utilisation du jeton de r√©initialisation**

Si le syst√®me cible permet que le **lien de r√©initialisation soit r√©utilis√©**, des efforts doivent √™tre faits pour **trouver plus de liens de r√©initialisation** en utilisant des outils tels que `gau`, `wayback`, ou `scan.io`.

## **Pr√© prise de contr√¥le de compte**

1. L'email de la victime doit √™tre utilis√© pour s'inscrire sur la plateforme, et un mot de passe doit √™tre d√©fini (une tentative de confirmation doit √™tre faite, bien que l'absence d'acc√®s aux emails de la victime puisse rendre cela impossible).
2. Il faut attendre que la victime s'inscrive en utilisant OAuth et confirme le compte.
3. On esp√®re que l'inscription r√©guli√®re sera confirm√©e, permettant l'acc√®s au compte de la victime.

## **Mauvaise configuration CORS pour la prise de contr√¥le de compte**

Si la page contient des **mauvaises configurations CORS**, vous pourriez √™tre en mesure de **voler des informations sensibles** de l'utilisateur pour **prendre le contr√¥le de son compte** ou le faire changer ses informations d'authentification dans le m√™me but :

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF pour la prise de contr√¥le de compte**

Si la page est vuln√©rable au CSRF, vous pourriez √™tre en mesure de faire **modifier le mot de passe**, l'email ou l'authentification de l'utilisateur afin que vous puissiez ensuite y acc√©der :

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS pour la prise de contr√¥le de compte**

Si vous trouvez une XSS dans l'application, vous pourriez √™tre en mesure de voler des cookies, du stockage local, ou des informations de la page web qui pourraient vous permettre de prendre le contr√¥le du compte :

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **M√™me origine + Cookies**

Si vous trouvez une XSS limit√©e ou une prise de contr√¥le de sous-domaine, vous pourriez jouer avec les cookies (en les fixant par exemple) pour essayer de compromettre le compte de la victime :

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Attaque sur le m√©canisme de r√©initialisation de mot de passe**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulation de r√©ponse**

Si la r√©ponse d'authentification peut √™tre **r√©duite √† un simple bool√©en, essayez simplement de changer false en true** et voyez si vous obtenez un acc√®s.

## OAuth pour la prise de contr√¥le de compte

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Injection d'en-t√™te Host

1. L'en-t√™te Host est modifi√© suite √† l'initiation d'une demande de r√©initialisation de mot de passe.
2. L'en-t√™te proxy `X-Forwarded-For` est modifi√© en `attacker.com`.
3. Les en-t√™tes Host, Referrer et Origin sont simultan√©ment chang√©s en `attacker.com`.
4. Apr√®s avoir initi√© une r√©initialisation de mot de passe et choisi de renvoyer le mail, toutes les trois m√©thodes mentionn√©es ci-dessus sont employ√©es.

## Manipulation de r√©ponse

1. **Manipulation de code** : Le code d'√©tat est modifi√© en `200 OK`.
2. **Manipulation de code et de corps** :
* Le code d'√©tat est chang√© en `200 OK`.
* Le corps de la r√©ponse est modifi√© en `{"success":true}` ou un objet vide `{}`.

Ces techniques de manipulation sont efficaces dans les sc√©narios o√π JSON est utilis√© pour la transmission et la r√©ception de donn√©es.

## Changer l'email de la session actuelle

D'apr√®s [ce rapport](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) :

* L'attaquant demande √† changer son email avec un nouveau.
* L'attaquant re√ßoit un lien pour confirmer le changement de l'email.
* L'attaquant envoie le lien √† la victime pour qu'elle clique dessus.
* L'email de la victime est chang√© pour celui indiqu√© par l'attaquant.
* L'attaquant peut r√©cup√©rer le mot de passe et prendre le contr√¥le du compte.

Cela s'est √©galement produit dans [**ce rapport**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Anciens Cookies

Comme expliqu√© [**dans ce post**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), il √©tait possible de se connecter √† un compte, de sauvegarder les cookies en tant qu'utilisateur authentifi√©, de se d√©connecter, puis de se reconnecter.\
Avec la nouvelle connexion, bien que des cookies diff√©rents puissent √™tre g√©n√©r√©s, les anciens ont recommenc√© √† fonctionner.

## R√©f√©rences

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
