# Preuzimanje naloga

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks suvenir**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## **Problemi sa ovla코캖enjem**

Email naloga treba poku코ati promeniti, a proces potvrde **mora biti ispitano**. Ako se utvrdi da je **slab**, email treba promeniti na email rtve i zatim potvrditi.

## **Problemi sa normalizacijom Unicode-a**

1. Nalog namenjene rtve `victim@gmail.com`
2. Nalog treba kreirati koriste캖i Unicode\
na primer: `vi캖tim@gmail.com`

Kao 코to je obja코njeno u [**ovom predavanju**](https://www.youtube.com/watch?v=CiIyaZ3x49c), prethodni napad tako캠e mo쬰 biti izvr코en zloupotrebom identiteta tre캖ih lica:

* Kreirajte nalog u identitetu tre캖ih lica sa sli캜nim emailom rtve koriste캖i neki Unicode karakter (`vi캖tim@company.com`).
* Identitet tre캖ih lica ne bi trebalo da verifikuje email
* Ako identitet provajdera verifikuje email, mo쬯a mo쬰te napasti deo domena kao: `victim@캖ompany.com` i registrovati taj domen i nadati se da 캖e identitet provajdera generisati ascii verziju domena dok platforma rtve normalizuje naziv domena.
* Prijavite se putem ovog identiteta provajdera na platformu rtve koja bi trebala da normalizuje Unicode karakter i omogu캖i vam pristup nalogu rtve.

Za vi코e detalja, pogledajte dokument o normalizaciji Unicode-a:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Ponovna upotreba tokena za resetovanje**

Ako ciljni sistem dozvoljava **ponovnu upotrebu linka za resetovanje**, treba ulo쬴ti napore da se **prona캠e vi코e linkova za resetovanje** koriste캖i alate poput `gau`, `wayback`, ili `scan.io`.

## **Pre preuzimanja naloga**

1. Email rtve treba koristiti za registraciju na platformi, i postaviti lozinku (treba poku코ati potvrditi je, iako nedostatak pristupa emailovima rtve mo쬰 u캜initi ovo nemogu캖im).
2. Treba sa캜ekati da rtva se prijavi koriste캖i OAuth i potvrdi nalog.
3. Nadamo se da 캖e se redovna prijava potvrditi, omogu캖avaju캖i pristup nalogu rtve.

## **CORS konfiguracija za preuzimanje naloga**

Ako stranica sadr쬴 **CORS konfiguracije** mo쬯a 캖ete mo캖i **ukrasti osetljive informacije** od korisnika kako biste **preuzeli njegov nalog** ili ga naterali da promeni autentifikacione informacije u iste svrhe:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF za preuzimanje naloga**

Ako je stranica ranjiva na CSRF mo쬯a 캖ete mo캖i naterati **korisnika da promeni svoju lozinku**, email ili autentifikaciju kako biste zatim pristupili tome:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS za preuzimanje naloga**

Ako prona캠ete XSS u aplikaciji mo쬯a 캖ete mo캖i ukrasti kola캜i캖e, lokalno skladi코te, ili informacije sa web stranice koje bi vam omogu캖ile preuzimanje naloga:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Isti izvor + Kola캜i캖i**

Ako prona캠ete ograni캜eni XSS ili preuzimanje poddomena, mo쬰te manipulisati kola캜i캖ima (fiksirati ih na primer) kako biste poku코ali da ugrozite nalog rtve:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Napad na mehanizam resetovanja lozinke**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulacija odgovorom**

Ako se autentifikacioni odgovor mo쬰 **svedeti na jednostavnu boolean vrednost, poku코ajte da promenite false u true** i vidite da li dobijate pristup.

## OAuth za preuzimanje naloga

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Umetanje zaglavlja doma캖ina

1. Zaglavlje doma캖ina se menja prilikom iniciranja zahteva za resetovanje lozinke.
2. `X-Forwarded-For` proxy zaglavlje se menja u `attacker.com`.
3. Zaglavlja Doma캖ina, Referrera, i Origin se istovremeno menjaju u `attacker.com`.
4. Nakon iniciranja resetovanja lozinke, i zatim izbora za ponovno slanje emaila, koriste se sva tri navedena metoda.

## Manipulacija odgovorom

1. **Manipulacija koda**: Statusni kod se menja u `200 OK`.
2. **Manipulacija koda i tela**:
* Statusni kod se menja u `200 OK`.
* Telo odgovora se menja u `{"success":true}` ili prazan objekat `{}`.

Ove tehnike manipulacije su efikasne u scenarijima gde se JSON koristi za prenos i prijem podataka.

## Promena emaila trenutne sesije

Iz [ovog izve코taja](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Napada캜 zahteva promenu svog emaila sa novim
* Napada캜 dobija link za potvrdu promene emaila
* Napada캜 코alje rtvi link da ga klikne
* Email rtve se menja na onaj koji je nazna캜io napada캜
* Napad mo쬰 povratiti lozinku i preuzeti nalog

Ovo se tako캠e desilo u [**ovom izve코taju**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Stari kola캜i캖i

Kao 코to je obja코njeno [**u ovom postu**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), bilo je mogu캖e prijaviti se na nalog, sa캜uvati kola캜i캖e kao autentifikovan korisnik, odjaviti se, a zatim se ponovo prijaviti.\
Sa novom prijavom, iako bi se mo쬯a generisali druga캜iji kola캜i캖i, stari bi ponovo po캜eli da funkcioni코u.

## Reference

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks suvenir**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.
</details>
