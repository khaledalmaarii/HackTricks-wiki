# Rekening Oorneming

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Magtigingsprobleem**

Die e-pos van 'n rekening moet probeer word om verander te word, en die bevestigingsproses **moet ondersoek word**. As dit **swak** bevind word, moet die e-pos verander word na di√© van die beoogde slagoffer en dan bevestig word.

## **Unicode Normalisering Probleem**

1. Die rekening van die beoogde slagoffer `victim@gmail.com`
2. 'n Rekening moet geskep word met behulp van Unicode\
byvoorbeeld: `viƒátim@gmail.com`

Soos verduidelik in [**hierdie praatjie**](https://www.youtube.com/watch?v=CiIyaZ3x49c), kan die vorige aanval ook gedoen word deur derdeparty identiteitsverskaffers te misbruik:

* Skep 'n rekening in die derdeparty identiteitsverskaffer met 'n soortgelyke e-pos aan die slagoffer met behulp van 'n unicode karakter (`viƒátim@company.com`).
* Die derdeparty verskaffer moet nie die e-pos verifieer nie.
* As die identiteitsverskaffer die e-pos verifieer, kan jy dalk die domein deel aanval soos: `victim@ƒáompany.com` en daardie domein registreer en hoop dat die identiteitsverskaffer die ascii weergawe van die domein genereer terwyl die slagoffer platform die domeinnaam normaliseer.
* Teken in via hierdie identiteitsverskaffer in die slagoffer platform wat die unicode karakter moet normaliseer en jou toegang tot die slagoffer rekening moet toelaat.

Vir verdere besonderhede, verwys na die dokument oor Unicode Normalisering:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Herbruik van Reset Token**

As die teikenstelsel die **reset skakel toelaat om hergebruik te word**, moet daar pogings aangewend word om **meer reset skakels te vind** met behulp van gereedskap soos `gau`, `wayback`, of `scan.io`.

## **Voor Rekening Oorneming**

1. Die slagoffer se e-pos moet gebruik word om aan te meld op die platform, en 'n wagwoord moet gestel word (daar moet 'n poging aangewend word om dit te bevestig, alhoewel die gebrek aan toegang tot die slagoffer se e-posse dit onmoontlik kan maak).
2. 'n Mens moet wag totdat die slagoffer aanmeld met behulp van OAuth en die rekening bevestig.
3. Daar word gehoop dat die gewone aanmelding bevestig sal word, wat toegang tot die slagoffer se rekening sal toelaat.

## **CORS Misconfigurasie tot Rekening Oorneming**

As die bladsy **CORS misconfigurasies** bevat, mag jy in staat wees om **sensitiewe inligting** van die gebruiker te **steel om sy rekening oor te neem** of hom te laat verander auth inligting vir dieselfde doel:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf tot Rekening Oorneming**

As die bladsy kwesbaar is vir CSRF mag jy in staat wees om die **gebruiker sy wagwoord**, e-pos of verifikasie te laat verander sodat jy dit dan kan toegang:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS tot Rekening Oorneming**

As jy 'n XSS in die toepassing vind, mag jy in staat wees om koekies, plaaslike stoor, of inligting van die webblad te steel wat jou kan toelaat om die rekening oor te neem:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Selfde Oorsprong + Koekies**

As jy 'n beperkte XSS of 'n subdomein oorneming vind, kan jy met die koekies speel (byvoorbeeld hulle fixeer) om te probeer om die slagoffer rekening te kompromitteer:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Aanval op Wagwoord Reset Meganisme**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Antwoord Manipulasie**

As die verifikasie antwoord **verlaag kan word tot 'n eenvoudige boolean, probeer net om false na true te verander** en kyk of jy enige toegang kry.

## OAuth tot Rekening oorneming

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Gasheer Kop Inspuiting

1. Die Gasheer kop word gewysig na 'n wagwoord reset versoek inisi√´ring.
2. Die `X-Forwarded-For` proxy kop word verander na `attacker.com`.
3. Die Gasheer, Verwysing, en Oorsprong koppe word gelyktydig verander na `attacker.com`.
4. Na die inisi√´ring van 'n wagwoord reset en dan die keuse om die pos weer te stuur, word al drie van die bogenoemde metodes gebruik.

## Antwoord Manipulasie

1. **Kode Manipulasie**: Die statuskode word verander na `200 OK`.
2. **Kode en Liggaam Manipulasie**:
* Die statuskode word verander na `200 OK`.
* Die antwoord liggaam word gewysig na `{"success":true}` of 'n le√´ objek `{}`.

Hierdie manipulasie tegnieke is effektief in scenario's waar JSON gebruik word vir data oordrag en ontvangs.

## Verander e-pos van huidige sessie

Van [hierdie verslag](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Aanvaller versoek om sy e-pos met 'n nuwe een te verander
* Aanvaller ontvang 'n skakel om die verandering van die e-pos te bevestig
* Aanvaller stuur die slagoffer die skakel sodat hy dit klik
* Die slagoffer se e-pos word verander na die een aangedui deur die aanvaller
* Die aanvaller kan die wagwoord herstel en die rekening oorneem

Dit het ook gebeur in [**hierdie verslag**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Ou Koekies

Soos verduidelik [**in hierdie pos**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), was dit moontlik om in 'n rekening in te teken, die koekies as 'n geverifieerde gebruiker te stoor, uit te teken, en dan weer in te teken.\
Met die nuwe aanmelding, alhoewel verskillende koekies gegenereer mag word, het die oues weer begin werk.

## Verwysings

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
