# PrzejÄ™cie Konta

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## **Problem Autoryzacji**

Adres e-mail konta powinien zostaÄ‡ zmieniony, a proces potwierdzenia **musi zostaÄ‡ zbadany**. JeÅ›li zostanie uznany za **sÅ‚aby**, adres e-mail powinien zostaÄ‡ zmieniony na adres zamierzonej ofiary, a nastÄ™pnie potwierdzony.

## **Problem Normalizacji Unicode**

1. Konto zamierzonej ofiary `victim@gmail.com`
2. Konto powinno zostaÄ‡ utworzone z uÅ¼yciem Unicode\
na przykÅ‚ad: `viÄ‡tim@gmail.com`

Jak wyjaÅ›niono w [**tym wystÄ…pieniu**](https://www.youtube.com/watch?v=CiIyaZ3x49c), poprzedni atak mÃ³gÅ‚ byÄ‡ rÃ³wnieÅ¼ przeprowadzony poprzez naduÅ¼ycie dostawcÃ³w toÅ¼samoÅ›ci stron trzecich:

* UtwÃ³rz konto w dostawcy toÅ¼samoÅ›ci stron trzecich z podobnym adresem e-mail do ofiary, uÅ¼ywajÄ…c pewnego znaku Unicode (`viÄ‡tim@company.com`).
* Dostawca toÅ¼samoÅ›ci nie powinien weryfikowaÄ‡ adresu e-mail
* JeÅ›li dostawca toÅ¼samoÅ›ci weryfikuje adres e-mail, moÅ¼esz sprÃ³bowaÄ‡ zaatakowaÄ‡ czÄ™Å›Ä‡ domenowÄ…, na przykÅ‚ad: `victim@Ä‡ompany.com` i zarejestrowaÄ‡ tÄ™ domenÄ™, majÄ…c nadziejÄ™, Å¼e dostawca toÅ¼samoÅ›ci wygeneruje wersjÄ™ ASCII domeny, podczas gdy platforma ofiary znormalizuje nazwÄ™ domeny.
* Zaloguj siÄ™ za pomocÄ… tego dostawcy toÅ¼samoÅ›ci na platformie ofiary, ktÃ³ra powinna znormalizowaÄ‡ znak Unicode i umoÅ¼liwiÄ‡ dostÄ™p do konta ofiary.

Aby uzyskaÄ‡ wiÄ™cej szczegÃ³Å‚Ã³w, odwoÅ‚aj siÄ™ do dokumentu na temat Normalizacji Unicode:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Ponowne Wykorzystanie Tokena Resetowania**

JeÅ›li system docelowy pozwala na **ponowne wykorzystanie linku resetowania**, naleÅ¼y podjÄ…Ä‡ wysiÅ‚ki w celu **znalezienia wiÄ™cej linkÃ³w resetowania** za pomocÄ… narzÄ™dzi takich jak `gau`, `wayback` lub `scan.io`.

## **Przed PrzejÄ™ciem Konta**

1. E-mail ofiary powinien zostaÄ‡ uÅ¼yty do zarejestrowania siÄ™ na platformie, a hasÅ‚o powinno zostaÄ‡ ustawione (naleÅ¼y sprÃ³bowaÄ‡ je potwierdziÄ‡, chociaÅ¼ brak dostÄ™pu do e-maili ofiary moÅ¼e uniemoÅ¼liwiÄ‡ to).
2. NaleÅ¼y poczekaÄ‡, aÅ¼ ofiara zarejestruje siÄ™ za pomocÄ… OAuth i potwierdzi konto.
3. Mamy nadziejÄ™, Å¼e regularna rejestracja zostanie potwierdzona, umoÅ¼liwiajÄ…c dostÄ™p do konta ofiary.

## **BÅ‚Ä…d Konfiguracji CORS w PrzejÄ™ciu Konta**

JeÅ›li strona zawiera **bÅ‚Ä™dy konfiguracji CORS**, moÅ¼esz byÄ‡ w stanie **ukraÅ›Ä‡ wraÅ¼liwe informacje** od uÅ¼ytkownika w celu **przejÄ™cia jego konta** lub zmuszenia go do zmiany informacji uwierzytelniajÄ…cych w tym celu:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF w PrzejÄ™ciu Konta**

JeÅ›li strona jest podatna na CSRF, moÅ¼esz byÄ‡ w stanie sprawiÄ‡, Å¼e **uÅ¼ytkownik zmieni swoje hasÅ‚o**, e-mail lub uwierzytelnienie, aby nastÄ™pnie uzyskaÄ‡ do niego dostÄ™p:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS w PrzejÄ™ciu Konta**

JeÅ›li znajdziesz XSS w aplikacji, moÅ¼esz byÄ‡ w stanie ukraÅ›Ä‡ ciasteczka, lokalne przechowywanie danych lub informacje ze strony internetowej, ktÃ³re mogÄ… umoÅ¼liwiÄ‡ przejÄ™cie konta:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Ten Sam Pochodzenie + Ciasteczka**

JeÅ›li znajdziesz ograniczony XSS lub przejÄ™cie subdomeny, moÅ¼esz manipulowaÄ‡ ciasteczkami (np. ustalajÄ…c je) w celu prÃ³by skompromitowania konta ofiary:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Atakowanie Mechanizmu Resetowania HasÅ‚a**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulacja OdpowiedziÄ…**

JeÅ›li odpowiedÅº uwierzytelniajÄ…ca moÅ¼e zostaÄ‡ **zredukowana do prostego booleana, sprÃ³buj zmieniÄ‡ false na true** i sprawdÅº, czy uzyskasz dostÄ™p.

## OAuth w PrzejÄ™ciu Konta

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## WstrzykniÄ™cie NagÅ‚Ã³wka Host

1. NagÅ‚Ã³wek Host jest modyfikowany podczas inicjowania Å¼Ä…dania resetowania hasÅ‚a.
2. NagÅ‚Ã³wek proxy `X-Forwarded-For` jest zmieniany na `attacker.com`.
3. NagÅ‚Ã³wki Host, Referrer i Origin sÄ… jednoczeÅ›nie zmieniane na `attacker.com`.
4. Po zainicjowaniu resetowania hasÅ‚a, a nastÄ™pnie wybraniu opcji ponownego wysÅ‚ania wiadomoÅ›ci e-mail, stosowane sÄ… wszystkie trzy wymienione metody.

## Manipulacja OdpowiedziÄ…

1. **Manipulacja Kodem**: Kod stanu jest zmieniany na `200 OK`.
2. **Manipulacja Kodem i TreÅ›ciÄ…**:
* Kod stanu jest zmieniany na `200 OK`.
* TreÅ›Ä‡ odpowiedzi jest modyfikowana na `{"success":true}` lub pusty obiekt `{}`.

Techniki manipulacji sÄ… skuteczne w przypadkach, gdy JSON jest wykorzystywany do przesyÅ‚ania i odbierania danych.

## Zmiana e-mail bieÅ¼Ä…cej sesji

Z [tego raportu](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* AtakujÄ…cy prosi o zmianÄ™ swojego e-maila na nowy
* AtakujÄ…cy otrzymuje link do potwierdzenia zmiany e-maila
* AtakujÄ…cy wysyÅ‚a ofierze link, aby kliknÄ™Å‚a
* E-mail ofiary zostaje zmieniony na wskazany przez atakujÄ…cego
* AtakujÄ…cy moÅ¼e odzyskaÄ‡ hasÅ‚o i przejÄ…Ä‡ konto

To rÃ³wnieÅ¼ miaÅ‚o miejsce w [**tym raporcie**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Stare Ciasteczka

Jak wyjaÅ›niono [**w tym poÅ›cie**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), byÅ‚o moÅ¼liwe zalogowanie siÄ™ do konta, zapisanie ciasteczek jako uwierzytelniony uÅ¼ytkownik, wylogowanie, a nastÄ™pnie ponowne zalogowanie.\
Po nowym zalogowaniu, chociaÅ¼ mogÄ… byÄ‡ generowane inne ciasteczka, stare zaczÄ™Å‚y ponownie dziaÅ‚aÄ‡.

## OdnoÅ›niki

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.
</szczegÃ³Å‚y>
