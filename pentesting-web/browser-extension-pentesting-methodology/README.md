# TarayÄ±cÄ± Eklentisi Pentest Metodolojisi

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **ğŸ’¬ [Discord grubumuza](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

TarayÄ±cÄ± eklentileri JavaScript ile yazÄ±lÄ±r ve tarayÄ±cÄ± tarafÄ±ndan arka planda yÃ¼klenir. Kendi [DOM](https://www.w3schools.com/js/js\_htmldom.asp)'una sahiptir ancak diÄŸer sitelerin DOM'larÄ±yla etkileÅŸimde bulunabilir. Bu, diÄŸer sitelerin gizliliÄŸini, bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve eriÅŸilebilirliÄŸini tehlikeye atabilir (CIA).

## Ana BileÅŸenler

Eklenti dÃ¼zenleri en iyi gÃ¶rselleÅŸtirildiÄŸinde Ã¼Ã§ bileÅŸenden oluÅŸur. Her bileÅŸeni detaylÄ± olarak inceleyelim.

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption><p><a href="http://webblaze.cs.berkeley.edu/papers/Extensions.pdf">http://webblaze.cs.berkeley.edu/papers/Extensions.pdf</a></p></figcaption></figure>

### **Ä°Ã§erik Betikleri (Content Scripts)**

Her iÃ§erik betiÄŸinin **tek bir web sayfasÄ±nÄ±n DOM'una doÄŸrudan eriÅŸimi** vardÄ±r ve bu nedenle **potansiyel olarak kÃ¶tÃ¼ niyetli girdilere** maruz kalÄ±r. Ancak, iÃ§erik betiÄŸi, uzantÄ± Ã§ekirdeÄŸine mesaj gÃ¶nderme yeteneÄŸi dÄ±ÅŸÄ±nda hiÃ§bir izne sahip deÄŸildir.

### **UzantÄ± Ã‡ekirdeÄŸi (Extension Core)**

UzantÄ± Ã§ekirdeÄŸi, uzantÄ±nÄ±n Ã§oÄŸu ayrÄ±calÄ±ÄŸÄ±/eriÅŸimi iÃ§erir, ancak uzantÄ± Ã§ekirdeÄŸi yalnÄ±zca [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest) ve iÃ§erik betikleri aracÄ±lÄ±ÄŸÄ±yla web iÃ§eriÄŸi ile etkileÅŸimde bulunabilir. AyrÄ±ca, uzantÄ± Ã§ekirdeÄŸinin ana makineye doÄŸrudan eriÅŸimi yoktur.

### **Yerel Ä°kili (Native Binary)**

UzantÄ±, kullanÄ±cÄ±nÄ±n tam ayrÄ±calÄ±klarÄ±yla ana makineye **eriÅŸebilen bir yerel ikiliye** izin verir. Yerel ikili, Flash ve diÄŸer tarayÄ±cÄ± eklentileri tarafÄ±ndan kullanÄ±lan standart Netscape Eklenti Uygulama Programlama ArayÃ¼zÃ¼ ([NPAPI](https://en.wikipedia.org/wiki/NPAPI)) aracÄ±lÄ±ÄŸÄ±yla uzantÄ± Ã§ekirdeÄŸi ile etkileÅŸime girer.

### SÄ±nÄ±rlar

{% hint style="danger" %}
Bir saldÄ±rganÄ±n kullanÄ±cÄ±nÄ±n tam ayrÄ±calÄ±klarÄ±nÄ± elde etmesi iÃ§in, iÃ§erik betiÄŸinden uzantÄ± Ã§ekirdeÄŸine ve uzantÄ± Ã§ekirdeÄŸinden yerel ikiliye kÃ¶tÃ¼ niyetli girdi geÃ§irmesi gerekir.
{% endhint %}

UzantÄ±nÄ±n her bileÅŸeni **gÃ¼Ã§lÃ¼ koruyucu sÄ±nÄ±rlarla** birbirinden ayrÄ±lmÄ±ÅŸtÄ±r. Her bileÅŸen **ayrÄ± bir iÅŸletim sistemi iÅŸlemi**nde Ã§alÄ±ÅŸÄ±r. Ä°Ã§erik betikleri ve uzantÄ± Ã§ekirdekleri, Ã§oÄŸu iÅŸletim sistemi hizmetine eriÅŸilemeyen **kum havuzu iÅŸlemlerinde** Ã§alÄ±ÅŸÄ±r.

AyrÄ±ca, iÃ§erik betikleri, **ayrÄ± bir JavaScript yÄ±ÄŸÄ±nÄ±nda Ã§alÄ±ÅŸarak** iliÅŸkili web sayfalarÄ±ndan ayrÄ± tutulur. Ä°Ã§erik betiÄŸi ve web sayfasÄ±, **aynÄ± temel DOM'a eriÅŸebilir**, ancak ikisi **asla JavaScript iÅŸaretÃ§ilerini deÄŸiÅŸ tokuÅŸ etmez**, JavaScript iÅŸlevselliÄŸinin sÄ±zmasÄ±nÄ± Ã¶nler. 

## **`manifest.json`**

Bir Chrome eklentisi, [.crx dosya uzantÄ±sÄ±na sahip bir ZIP klasÃ¶rÃ¼dÃ¼r](https://www.lifewire.com/crx-file-2620391). UzantÄ±nÄ±n Ã§ekirdeÄŸi, dÃ¼zeni, izinleri ve diÄŸer yapÄ±landÄ±rma seÃ§eneklerini belirten klasÃ¶rÃ¼n kÃ¶kÃ¼nde bulunan **`manifest.json`** dosyasÄ±dÄ±r.

Ã–rnek:
```json
{
"manifest_version": 2,
"name": "My extension",
"version": "1.0",
"permissions": [
"storage"
],
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
"background": {
"scripts": [
"background.js"
]
},
"options_ui": {
"page": "options.html"
}
}
```
### `content_scripts`

Ä°Ã§erik betikleri, kullanÄ±cÄ± **eÅŸleÅŸen bir sayfaya gezindiÄŸinde** yÃ¼klenir, bizim durumumuzda **`https://example.com/*`** ifadesine uyan herhangi bir sayfa ve **`*://*/*/business*`** regexine uymayan sayfalar. SayfanÄ±n kendi betikleri gibi **Ã§alÄ±ÅŸÄ±rlar** ve sayfanÄ±n [Belge Nesne Modeli (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model)ne keyfi eriÅŸime sahiptirler.
```json
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
```
**`include_globs`** ve **`exclude_globs`** kullanarak daha fazla URL eklemek veya hariÃ§ tutmak da mÃ¼mkÃ¼ndÃ¼r.

Bu, depolama API'sini kullanarak uzantÄ±nÄ±n depolamasÄ±ndan `message` deÄŸerini almak iÃ§in bir aÃ§Ä±klama dÃ¼ÄŸmesi ekleyecek bir Ã¶rnek iÃ§erik betiÄŸidir.
```js
chrome.storage.local.get("message", result =>
{
let div = document.createElement("div");
div.innerHTML = result.message + " <button>Explain</button>";
div.querySelector("button").addEventListener("click", () =>
{
chrome.runtime.sendMessage("explain");
});
document.body.appendChild(div);
});
```
<figure><img src="../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

Bu dÃ¼ÄŸmeye tÄ±klandÄ±ÄŸÄ±nda iÃ§erik betiÄŸi tarafÄ±ndan uzantÄ± sayfalarÄ±na bir mesaj gÃ¶nderilir, [**runtime.sendMessage() API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage) kullanÄ±larak. Bu, iÃ§erik betiÄŸinin API'lere doÄŸrudan eriÅŸimindeki kÄ±sÄ±tlamadan kaynaklanmaktadÄ±r, `storage` bunun istisnalarÄ±ndan biridir. Bu istisnalarÄ±n Ã¶tesindeki iÅŸlevsellikler iÃ§in, iÃ§erik betikleri ile iletiÅŸim kurabilen uzantÄ± sayfalarÄ±na mesajlar gÃ¶nderilir.

{% hint style="warning" %}
TarayÄ±cÄ±ya baÄŸlÄ± olarak, iÃ§erik betiÄŸinin yetenekleri biraz deÄŸiÅŸebilir. Chromium tabanlÄ± tarayÄ±cÄ±lar iÃ§in yetenekler listesi [Chrome GeliÅŸtiriciler belgelerinde](https://developer.chrome.com/docs/extensions/mv3/content\_scripts/#capabilities) mevcuttur ve Firefox iÃ§in [MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content\_scripts#webextension\_apis) birincil kaynak olarak hizmet vermektedir.\
AyrÄ±ca iÃ§erik betiklerinin arka plan betikleri ile iletiÅŸim kurma yeteneÄŸine sahip olduklarÄ± ve bÃ¶ylece eylemleri gerÃ§ekleÅŸtirebilecekleri ve yanÄ±tlarÄ± geri iletebilecekleri unutulmamalÄ±dÄ±r.
{% endhint %}

Chrome'da iÃ§erik betiklerini gÃ¶rÃ¼ntÃ¼lemek ve hata ayÄ±klamak iÃ§in, Chrome geliÅŸtirici araÃ§larÄ± menÃ¼sÃ¼ne Options > More tools > Developer tools veya Ctrl + Shift + I tuÅŸlarÄ±na basÄ±larak eriÅŸilebilir.

GeliÅŸtirici araÃ§larÄ± gÃ¶rÃ¼ntÃ¼lendikten sonra, **Source** sekmesine tÄ±klanmalÄ± ve ardÄ±ndan **Content Scripts** sekmesine tÄ±klanmalÄ±dÄ±r. Bu, Ã§eÅŸitli uzantÄ±lardan Ã§alÄ±ÅŸan iÃ§erik betiklerinin gÃ¶zlemlenmesine ve yÃ¼rÃ¼tme akÄ±ÅŸÄ±nÄ± izlemek iÃ§in kesme noktalarÄ± belirlemeye olanak tanÄ±r.

### Enjekte edilmiÅŸ iÃ§erik betikleri

{% hint style="success" %}
**Ä°Ã§erik Betiklerinin zorunlu olmadÄ±ÄŸÄ±nÄ±** ve ayrÄ±ca **dinamik olarak** betiklerin **enjekte edilebileceÄŸini** ve bunlarÄ±n web sayfalarÄ±na **`tabs.executeScript`** aracÄ±lÄ±ÄŸÄ±yla **programatik olarak enjekte edilebileceÄŸini** unutmayÄ±n. Bu aslÄ±nda daha **ince kontroller** saÄŸlar.
{% endhint %}

Bir iÃ§erik betiÄŸinin programatik olarak enjekte edilmesi iÃ§in, uzantÄ±nÄ±n betiklerin enjekte edileceÄŸi sayfaya [ana bilgisayar izinlerine](https://developer.chrome.com/docs/extensions/reference/permissions) sahip olmasÄ± gerekir. Bu izinler, uzantÄ±nÄ±n manifest dosyasÄ± iÃ§inde talep edilerek veya geÃ§ici olarak [**activeTab**](https://developer.chrome.com/docs/extensions/reference/manifest/activeTab) aracÄ±lÄ±ÄŸÄ±yla saÄŸlanabilir.

#### Ã–rnek activeTab tabanlÄ± uzantÄ±

{% code title="manifest.json" %}
```json
{
"name": "My extension",
...
"permissions": [
"activeTab",
"scripting"
],
"background": {
"service_worker": "background.js"
},
"action": {
"default_title": "Action Button"
}
}
```
{% endcode %}

* **TÄ±klama ile bir JS dosyasÄ± enjekte etmek:**
```javascript
// content-script.js
document.body.style.backgroundColor = "orange";

//service-worker.js - Inject the JS file
chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target: { tabId: tab.id },
files: ["content-script.js"]
});
});
```
* **TÄ±klama olayÄ±na bir fonksiyon enjekte edin**:
```javascript
//service-worker.js - Inject a function
function injectedFunction() {
document.body.style.backgroundColor = "orange";
}

chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target : {tabId : tab.id},
func : injectedFunction,
});
});
```
#### Betik Ä°zinleri ile Ã–rnek
```javascript
// service-workser.js
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
excludeMatches : [ "*://*/*business*" ],
js : [ "contentScript.js" ],
}]);

// Another example
chrome.tabs.executeScript(tabId, { file: "content_script.js" });
```
### Ä°Ã§erik Betikleri `run_at`

`run_at` alanÄ±, **JavaScript dosyalarÄ±nÄ±n web sayfasÄ±na ne zaman enjekte edileceÄŸini kontrol eder**. Tercih edilen ve varsayÄ±lan deÄŸer `"document_idle"` deÄŸeridir.

MÃ¼mkÃ¼n olan deÄŸerler ÅŸunlardÄ±r:

* **`document_idle`**: MÃ¼mkÃ¼n olduÄŸunda
* **`document_start`**: `css` dosyalarÄ±ndan sonra, ancak herhangi bir diÄŸer DOM oluÅŸturulmadan veya herhangi bir diÄŸer betik Ã§alÄ±ÅŸtÄ±rÄ±lmadan Ã¶nce.
* **`document_end`**: DOM tamamlandÄ±ktan hemen sonra, ancak resimler ve Ã§erÃ§eveler gibi alt kaynaklar yÃ¼klenmeden Ã¶nce.

#### `manifest.json` Ã¼zerinden
```json
{
"name": "My extension",
...
"content_scripts": [
{
"matches": ["https://*.example.com/*"],
"run_at": "document_idle",
"js": ["contentScript.js"]
}
],
...
}

```
**`service-worker.js`** aracÄ±lÄ±ÄŸÄ±yla
```javascript
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
runAt : "document_idle",
js : [ "contentScript.js" ],
}]);
```
### `arkaplan`

Ä°Ã§erik komutlarÄ± tarafÄ±ndan gÃ¶nderilen mesajlar, uzantÄ±nÄ±n bileÅŸenlerini koordine etmede merkezi bir rol oynayan **arkaplan sayfasÄ±** tarafÄ±ndan alÄ±nÄ±r. Ã–nemli bir ÅŸekilde, arkaplan sayfasÄ± uzantÄ±nÄ±n Ã¶mrÃ¼ boyunca varlÄ±ÄŸÄ±nÄ± sÃ¼rdÃ¼rÃ¼r, doÄŸrudan kullanÄ±cÄ± etkileÅŸimi olmadan gizlice Ã§alÄ±ÅŸÄ±r. Kendi Document Object Model (DOM) 'a sahiptir, karmaÅŸÄ±k etkileÅŸimlere ve durum yÃ¶netimine olanak tanÄ±r.

**Ana Noktalar**:

* **Arkaplan Sayfa RolÃ¼:** UzantÄ± iÃ§in sinir merkezi olarak hareket eder, uzantÄ±nÄ±n Ã§eÅŸitli parÃ§alarÄ± arasÄ±nda iletiÅŸimi ve koordinasyonu saÄŸlar.
* **KalÄ±cÄ±lÄ±k:** KullanÄ±cÄ± iÃ§in gÃ¶rÃ¼nmez ancak uzantÄ±nÄ±n iÅŸlevselliÄŸi iÃ§in ayrÄ±lmaz olan sÃ¼rekli bir varlÄ±ktÄ±r.
* **Otomatik OluÅŸturma:** AÃ§Ä±kÃ§a tanÄ±mlanmazsa, tarayÄ±cÄ± otomatik olarak bir arkaplan sayfasÄ± oluÅŸturacaktÄ±r. Bu otomatik oluÅŸturulan sayfa, uzantÄ±nÄ±n manifestosunda belirtilen tÃ¼m arkaplan betiklerini iÃ§erecek ve uzantÄ±nÄ±n arkaplan gÃ¶revlerinin sorunsuz Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlayacaktÄ±r.

{% hint style="success" %}
TarayÄ±cÄ± tarafÄ±ndan otomatik olarak bir arkaplan sayfasÄ± oluÅŸturulmasÄ± (aÃ§Ä±kÃ§a belirtilmediÄŸinde) saÄŸlanan kolaylÄ±k, gerekli tÃ¼m arkaplan betiklerinin entegre edilmiÅŸ ve operasyonel olduÄŸundan emin olur, uzantÄ±nÄ±n kurulum sÃ¼recini kolaylaÅŸtÄ±rÄ±r.
{% endhint %}

Ã–rnek arkaplan betiÄŸi:
```js
chrome.runtime.onMessage.addListener((request, sender, sendResponse) =>
{
if (request == "explain")
{
chrome.tabs.create({ url: "https://example.net/explanation" });
}
})
```
Extension, mesajlarÄ± dinlemek iÃ§in [runtime.onMessage API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage) kullanÄ±r. Bir `"explain"` mesajÄ± alÄ±ndÄ±ÄŸÄ±nda, yeni bir sekmede bir sayfa aÃ§mak iÃ§in [tabs API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) kullanÄ±r.

Arka plandaki betiÄŸi hata ayÄ±klamak iÃ§in **uzantÄ± ayrÄ±ntÄ±larÄ±na gidip hizmet iÅŸÃ§isini inceleyebilirsiniz**, bu arka plandaki betiÄŸi geliÅŸtirici araÃ§larla aÃ§acaktÄ±r:

<figure><img src="https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/browser-extension-pentesting-methodology/broken-reference" alt=""><figcaption></figcaption></figure>

### SeÃ§enek sayfalarÄ± ve diÄŸerleri

TarayÄ±cÄ± uzantÄ±larÄ± Ã§eÅŸitli tÃ¼rde sayfalar iÃ§erebilir:

* **Eylem sayfalarÄ±**, uzantÄ± simgesine tÄ±klandÄ±ÄŸÄ±nda bir **aÃ§Ä±lÄ±r menÃ¼de** gÃ¶sterilir.
* UzantÄ±nÄ±n **yeni bir sekmede yÃ¼kleyeceÄŸi sayfalar**.
* **SeÃ§enek SayfalarÄ±**: Bu sayfa, tÄ±klandÄ±ÄŸÄ±nda uzantÄ±nÄ±n Ã¼stÃ¼nde gÃ¶rÃ¼ntÃ¼lenir. Ã–nceki manifesterde bu sayfaya `chrome://extensions/?options=fadlhnelkbeojnebcbkacjilhnbjfjca` adresinden veya tÄ±klayarak eriÅŸebildim:

<figure><img src="../../.gitbook/assets/image (21).png" alt="" width="375"><figcaption></figcaption></figure>

Bu sayfalar arka plan sayfalarÄ± gibi kalÄ±cÄ± deÄŸildir, gerektiÄŸinde iÃ§eriÄŸi dinamik olarak yÃ¼klerler. Bununla birlikte, bu sayfalar arka plan sayfasÄ±yla bazÄ± yetenekleri paylaÅŸÄ±rlar:

* **Ä°Ã§erik Betikleriyle Ä°letiÅŸim:** Arka plan sayfasÄ±na benzer ÅŸekilde, bu sayfalar iÃ§erik betiklerinden mesaj alabilir, uzantÄ± iÃ§inde etkileÅŸimi kolaylaÅŸtÄ±rÄ±r.
* **UzantÄ±ya Ã–zgÃ¼ API'lere EriÅŸim:** Bu sayfalar, uzantÄ±ya Ã¶zgÃ¼ API'lere kapsamlÄ± eriÅŸime sahiptir, uzantÄ± iÃ§in tanÄ±mlanan izinlere tabidir.

### `permissions` ve `host_permissions`

**`permissions`** ve **`host_permissions`**, tarayÄ±cÄ± uzantÄ±sÄ±nÄ±n sahip olduÄŸu **izinleri** (depolama, konum...) ve **hangi web sayfalarÄ±nda** olduÄŸunu belirten `manifest.json` dosyasÄ±ndaki giriÅŸlerdir.

TarayÄ±cÄ± uzantÄ±larÄ± Ã§ok **ayrÄ±calÄ±klÄ±** olabileceÄŸinden, kÃ¶tÃ¼ niyetli veya tehlikeye maruz kalan bir uzantÄ± saldÄ±rganÄ±n **duyarlÄ± bilgileri Ã§almasÄ± ve kullanÄ±cÄ±yÄ± izlemesi iÃ§in farklÄ± yÃ¶ntemler saÄŸlayabilir**.

Bu ayarlarÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ve nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸini kontrol edin:

{% content-ref url="browext-permissions-and-host_permissions.md" %}
[browext-permissions-and-host\_permissions.md](browext-permissions-and-host\_permissions.md)
{% endcontent-ref %}

### `content_security_policy`

Bir **iÃ§erik gÃ¼venlik politikasÄ±**, ayrÄ±ca `manifest.json` iÃ§inde de belirtilebilir. TanÄ±mlanmÄ±ÅŸsa, **savunmasÄ±z** olabilir.

TarayÄ±cÄ± uzantÄ±sÄ± sayfalarÄ± iÃ§in varsayÄ±lan ayar oldukÃ§a kÄ±sÄ±tlayÄ±cÄ±dÄ±r:
```bash
script-src 'self'; object-src 'self';
```
CSP hakkÄ±nda daha fazla bilgi ve potansiyel bypass'lar iÃ§in kontrol edin:

{% content-ref url="../content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../content-security-policy-csp-bypass/)
{% endcontent-ref %}

### `web_accessible_resources`

Bir web sayfasÄ±nÄ±n, Ã¶rneÄŸin bir `.html` sayfasÄ±nÄ±n, bir TarayÄ±cÄ± UzantÄ±sÄ±nÄ±n bir sayfasÄ±na eriÅŸmesi iÃ§in, bu sayfanÄ±n `manifest.json` dosyasÄ±ndaki **`web_accessible_resources`** alanÄ±nda belirtilmesi gerekmektedir.\
Ã–rneÄŸin:
```javascript
{
...
"web_accessible_resources": [
{
"resources": [ "images/*.png" ],
"matches": [ "https://example.com/*" ]
},
{
"resources": [ "fonts/*.woff" ],
"matches": [ "https://example.com/*" ]
}
],
...
}
```
Bu sayfalara ÅŸu URL'lerden eriÅŸilebilir:
```
chrome-extension://<extension-id>/message.html
```
Genel uzantÄ±larda **uzantÄ± kimliÄŸi eriÅŸilebilir**:

<figure><img src="../../.gitbook/assets/image (1191).png" alt="" width="375"><figcaption></figcaption></figure>

Ancak, `manifest.json` parametresi **`use_dynamic_url`** kullanÄ±lÄ±yorsa, bu **kimlik dinamik olabilir**.

Bu sayfalara eriÅŸime izin verilmesi, bu sayfalarÄ± **potansiyel olarak savunmasÄ±z ClickJacking** yapar:

{% content-ref url="browext-clickjacking.md" %}
[browext-clickjacking.md](browext-clickjacking.md)
{% endcontent-ref %}

{% hint style="success" %}
Bu sayfalarÄ±n yalnÄ±zca uzantÄ± tarafÄ±ndan yÃ¼klenmesine ve rastgele URL'ler tarafÄ±ndan yÃ¼klenmemesine izin vermek, ClickJacking saldÄ±rÄ±larÄ±nÄ± Ã¶nleyebilir.
{% endhint %}

### `externally_connectable`

[**Belgelerde**](https://developer.chrome.com/docs/extensions/reference/manifest/externally-connectable) belirtildiÄŸi gibi, `"externally_connectable"` manifest Ã¶zelliÄŸi, [runtime.connect](https://developer.chrome.com/docs/extensions/reference/runtime#method-connect) ve [runtime.sendMessage](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) aracÄ±lÄ±ÄŸÄ±yla uzantÄ±nÄ±za kimlerin baÄŸlanabileceÄŸini belirler.

* EÄŸer **`externally_connectable`** anahtarÄ± uzantÄ±nÄ±zÄ±n manifestinde belirtilmemiÅŸse veya **`"ids": ["*"]`** olarak belirtilmiÅŸse, **tÃ¼m uzantÄ±lar baÄŸlanabilir, ancak hiÃ§bir web sayfasÄ± baÄŸlanamaz**.
* EÄŸer **belirli kimlikler** belirtilmiÅŸse, Ã¶rneÄŸin `"ids": ["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"]`, **yalnÄ±zca bu uygulamalar** baÄŸlanabilir.
* EÄŸer **eÅŸleÅŸmeler** belirtilmiÅŸse, bu web uygulamalarÄ± baÄŸlanabilir:
```json
"matches": [
"https://*.google.com/*",
"*://*.chromium.org/*",
```
* EÄŸer boÅŸ olarak belirtilmiÅŸse: **`"externally_connectable": {}`**, hiÃ§bir uygulama veya web sitesi baÄŸlantÄ± kuramaz.

Burada belirtilen **daha az uzantÄ± ve URL** olduÄŸunda, **saldÄ±rÄ± yÃ¼zeyi daha kÃ¼Ã§Ã¼k** olacaktÄ±r.

{% hint style="danger" %}
EÄŸer **XSS'ye duyarlÄ± veya ele geÃ§irilebilir** bir web sayfasÄ± **`externally_connectable`** iÃ§inde belirtilmiÅŸse, bir saldÄ±rgan **mesajlarÄ± doÄŸrudan arka plan betiÄŸine gÃ¶nderebilir**, Ä°Ã§erik BetiÄŸi ve CSP'sini tamamen atlayabilir.

Bu nedenle, bu **Ã§ok gÃ¼Ã§lÃ¼ bir atlatma**dÄ±r.

AyrÄ±ca, istemci yanlÄ±ÅŸ bir uzantÄ± yÃ¼klerse, hatta savunmasÄ±z uzantÄ±yla iletiÅŸim kurmasÄ±na izin verilmiyorsa, **izin verilen bir web sayfasÄ±na XSS verisi enjekte edebilir** veya **`WebRequest`** veya **`DeclarativeNetRequest`** API'larÄ±nÄ± kullanarak hedeflenen bir alan adÄ±ndaki istekleri manipÃ¼le edebilir ve bir sayfanÄ±n isteÄŸini bir **JavaScript dosyasÄ±** iÃ§in deÄŸiÅŸtirebilir. (Hedeflenen sayfadaki CSP bu saldÄ±rÄ±larÄ± Ã¶nleyebilir). Bu fikir [**bu yazÄ±dan gelmektedir**](https://www.darkrelay.com/post/opera-zero-day-rce-vulnerability).
{% endhint %}

##

## Web **â†”ï¸** Ä°Ã§erik BetiÄŸi Ä°letiÅŸimi

**Ä°Ã§erik betiklerinin** Ã§alÄ±ÅŸtÄ±ÄŸÄ± ortamlar ve ana sayfalarÄ±n bulunduÄŸu ortamlar birbirinden **ayrÄ±lmÄ±ÅŸ** olup, **izolasyonu** saÄŸlar. Bu izolasyona raÄŸmen, her ikisi de sayfanÄ±n **Belge Nesne Modeli (DOM)** ile etkileÅŸimde bulunma yeteneÄŸine sahiptir, ortak bir kaynak. Ana sayfanÄ±n **iÃ§erik betiÄŸi** ile iletiÅŸim kurabilmesi veya dolaylÄ± olarak iÃ§erik betiÄŸi aracÄ±lÄ±ÄŸÄ±yla uzantÄ± ile iletiÅŸim kurabilmesi iÃ§in, her iki tarafÄ±n da eriÅŸebildiÄŸi **DOM**'u iletiÅŸim kanalÄ± olarak kullanmasÄ± gerekmektedir.

### Mesaj GÃ¶nderme

{% code title="iÃ§erik-betiÄŸi.js" %}
```javascript
var port = chrome.runtime.connect();

window.addEventListener("message", (event) => {
// We only accept messages from ourselves
if (event.source !== window) {
return;
}

if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
port.postMessage(event.data.text);
}
}, false);
```
{% endcode %}

{% code title="example.js" %}
```javascript
document.getElementById("theButton").addEventListener("click", () => {
window.postMessage(
{type : "FROM_PAGE", text : "Hello from the webpage!"}, "*");
}, false);
```
{% endcode %}

GÃ¼venli bir Post Message iletiÅŸimi alÄ±nan iletiyi doÄŸrulamalÄ±dÄ±r, bunu ÅŸu ÅŸekilde kontrol edebiliriz:

- **`event.isTrusted`**: Bu, yalnÄ±zca olayÄ±n bir kullanÄ±cÄ± eylemi tarafÄ±ndan tetiklendiÄŸinde DoÄŸru olur
- Ä°Ã§erik betiÄŸi, kullanÄ±cÄ±nÄ±n belirli bir eylem gerÃ§ekleÅŸtirmesini bekleyebilir
- **kÃ¶ken alanÄ±**: yalnÄ±zca belirli bir alan adÄ± beyaz listesinden bir ileti bekleyebilir.
- Bir regex kullanÄ±lÄ±yorsa, Ã§ok dikkatli olunmalÄ±dÄ±r
- **Kaynak**: `received_message.source !== window` iletiyi dinleyen Ä°Ã§erik BetiÄŸinin olduÄŸu **aynÄ± pencereden** mi geldiÄŸini kontrol etmek iÃ§in kullanÄ±labilir.

Ã–nceki kontroller, gerÃ§ekleÅŸtirilmiÅŸ olsa bile, savunmasÄ±z olabilir, bu nedenle aÅŸaÄŸÄ±daki sayfada **potansiyel Post Message atlamalarÄ±nÄ±** kontrol edin:

{% content-ref url="../postmessage-vulnerabilities/" %}
[postmessage-vulnerabilities](../postmessage-vulnerabilities/)
{% endcontent-ref %}

### Iframe

BaÅŸka bir iletiÅŸim yolu olasÄ± bir ÅŸekilde **Iframe URL'leri** aracÄ±lÄ±ÄŸÄ±yla olabilir, bir Ã¶rnek bulabilirsiniz:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

### DOM

Bu "tam olarak" bir iletiÅŸim yolu deÄŸil, ancak **web ve iÃ§erik betiÄŸi web DOM'a eriÅŸebilir**. DolayÄ±sÄ±yla, **iÃ§erik betiÄŸi** ondan bazÄ± bilgileri okuyorsa, **web DOM'a gÃ¼veniyorsa**, web bu veriyi **deÄŸiÅŸtirebilir** (Ã§Ã¼nkÃ¼ web gÃ¼venilir olmamalÄ±dÄ±r veya web XSS'ye karÅŸÄ± savunmasÄ±z olabilir) ve **Ä°Ã§erik BetiÄŸi'ni tehlikeye atabilir**.

AyrÄ±ca, bir **DOM tabanlÄ± XSS Ã¶rneÄŸiyle bir tarayÄ±cÄ± uzantÄ±sÄ±nÄ± tehlikeye atmak** iÃ§in bir Ã¶rnek bulabilirsiniz:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## Bellek/Kod Ä°Ã§inde Hassas Bilgiler

Bir TarayÄ±cÄ± UzantÄ±sÄ±, **hassas bilgileri belleÄŸinde saklarsa**, bu bilgiler **dÃ¶kÃ¼lebilir** (Ã¶zellikle Windows makinelerinde) ve bu bilgiler iÃ§in **arama yapÄ±labilir**.

Bu nedenle, TarayÄ±cÄ± UzantÄ±sÄ±nÄ±n belleÄŸi **gÃ¼venli kabul edilmemeli** ve kimlik bilgileri veya mnemonik ifadeler gibi **hassas bilgilerin saklanmamasÄ±** gerekmektedir.

Tabii ki, kod iÃ§ine **hassas bilgi koymayÄ±n**, Ã§Ã¼nkÃ¼ bu **genel** olacaktÄ±r.

TarayÄ±cÄ±dan belleÄŸi dÃ¶kmek iÃ§in **iÅŸlem belleÄŸini dÃ¶kebilirsiniz** veya tarayÄ±cÄ± uzantÄ±sÄ±nÄ±n ayarlarÄ±na gitmek iÃ§in **`Ä°nceleme aÃ§`** -> **`Bellek`** bÃ¶lÃ¼mÃ¼nde **`Bir anlÄ±k gÃ¶rÃ¼ntÃ¼ al`** ve hassas bilgileri aramak iÃ§in **`CTRL+F`** tÄ±klayÄ±n.

## Ä°Ã§erik BetiÄŸi **â†”ï¸** Arka Plan BetiÄŸi Ä°letiÅŸimi

Bir Ä°Ã§erik BetiÄŸi, [**runtime.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) **veya** [**tabs.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/tabs#method-sendMessage) fonksiyonlarÄ±nÄ± kullanarak **bir kereye mahsus JSON-serileÅŸtirilebilir** bir ileti gÃ¶nderebilir.

YanÄ±tÄ± **iÅŸlemek** iÃ§in dÃ¶nen **Promise**'Ä± kullanÄ±n. Geriye dÃ¶nÃ¼k uyumluluk iÃ§in, hala son argÃ¼man olarak bir **geri Ã§aÄŸrÄ±** geÃ§irebilirsiniz.

Bir **iÃ§erik betiÄŸinden** istek gÃ¶ndermek ÅŸÃ¶yle gÃ¶rÃ¼nÃ¼r:
```javascript
(async () => {
const response = await chrome.runtime.sendMessage({greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
**UzantÄ±dan** bir istek gÃ¶ndermek (genellikle bir **arka plan betiÄŸi**) Bir Ä°Ã§erik BetiÄŸi, fonksiyonlarÄ± kullanabilir, ancak hangi sekmeye gÃ¶nderileceÄŸini belirtmeniz gerekir. SeÃ§ilen sekmedeki iÃ§erik betiÄŸine mesaj gÃ¶ndermenin bir Ã¶rneÄŸi:
```javascript
// From https://stackoverflow.com/questions/36153999/how-to-send-a-message-between-chrome-extension-popup-and-content-script
(async () => {
const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
**AlÄ±cÄ± tarafÄ±nda**, mesajÄ± iÅŸlemek iÃ§in bir [**runtime.onMessage**](https://developer.chrome.com/docs/extensions/reference/runtime#event-onMessage) **olay dinleyicisi** kurmanÄ±z gerekmektedir. Bu, iÃ§erik betiÄŸi veya uzantÄ± sayfasÄ±ndan aynÄ± ÅŸekilde gÃ¶rÃ¼nmektedir.
```javascript
// From https://stackoverflow.com/questions/70406787/javascript-send-message-from-content-js-to-background-js
chrome.runtime.onMessage.addListener(
function(request, sender, sendResponse) {
console.log(sender.tab ?
"from a content script:" + sender.tab.url :
"from the extension");
if (request.greeting === "hello")
sendResponse({farewell: "goodbye"});
}
);
```
Ã–ne Ã§Ä±karÄ±lan Ã¶rnekte, **`sendResponse()`** senkron bir ÅŸekilde yÃ¼rÃ¼tÃ¼ldÃ¼. `sendResponse()`'un asenkron yÃ¼rÃ¼tÃ¼lmesi iÃ§in `onMessage` olay iÅŸleyicisini deÄŸiÅŸtirmek iÃ§in `return true;` eklemek hayati Ã¶nem taÅŸÄ±r.

Ã‡oklu sayfalarÄ±n `onMessage` olaylarÄ±nÄ± alacaÄŸÄ± senaryolarda, **belirli bir olay iÃ§in `sendResponse()`'u yÃ¼rÃ¼ten ilk sayfa** yanÄ±tÄ± etkili bir ÅŸekilde iletebilecek tek sayfa olacaktÄ±r. AynÄ± olaya yÃ¶nelik herhangi bir sonraki yanÄ±t dikkate alÄ±nmayacaktÄ±r.

Yeni uzantÄ±lar oluÅŸturulurken, tercih edilen yaklaÅŸÄ±m geri aramalar yerine sÃ¶z verilere yÃ¶nelik olmalÄ±dÄ±r. Geri aramalarÄ±n kullanÄ±mÄ±yla ilgili olarak, `sendResponse()` fonksiyonu yalnÄ±zca senkron baÄŸlam iÃ§inde doÄŸrudan yÃ¼rÃ¼tÃ¼lÃ¼yorsa veya olay iÅŸleyicisi asenkron bir iÅŸlemi belirtiyorsa `true` dÃ¶ndÃ¼rÃ¼yorsa geÃ§erli kabul edilir. HiÃ§bir iÅŸleyicinin `true` dÃ¶ndÃ¼rmemesi durumunda veya `sendResponse()` fonksiyonu bellekten silinirse (Ã§Ã¶p toplama), `sendMessage()` fonksiyonuyla iliÅŸkilendirilen geri arama varsayÄ±lan olarak tetiklenir.

## TarayÄ±cÄ±da Bir UzantÄ± YÃ¼kleme

1. TarayÄ±cÄ± UzantÄ±sÄ±nÄ± **indirin** ve aÃ§Ä±n
2. **`chrome://extensions/`** adresine gidin ve `GeliÅŸtirici Modu`'nu **etkinleÅŸtirin**
3. **`PaketlenmemiÅŸ yÃ¼kleyin`** dÃ¼ÄŸmesine tÄ±klayÄ±n

**Firefox**'da **`about:debugging#/runtime/this-firefox`** adresine gidin ve **`GeÃ§ici Eklenti YÃ¼kle`** dÃ¼ÄŸmesine tÄ±klayÄ±n.

## MaÄŸazadan kaynak kodunu alma

Bir Chrome uzantÄ±sÄ±nÄ±n kaynak kodu Ã§eÅŸitli yÃ¶ntemlerle elde edilebilir. AÅŸaÄŸÄ±da her seÃ§enek iÃ§in detaylÄ± aÃ§Ä±klamalar ve talimatlar bulunmaktadÄ±r.

### Komut SatÄ±rÄ± AracÄ±lÄ±ÄŸÄ±yla ZIP Olarak UzantÄ±yÄ± Ä°ndirme

Bir Chrome uzantÄ±sÄ±nÄ±n kaynak kodu, komut satÄ±rÄ±nÄ± kullanarak ZIP dosyasÄ± olarak indirilebilir. Bu, belirli bir URL'den ZIP dosyasÄ±nÄ± almak iÃ§in `curl`'Ã¼n kullanÄ±lmasÄ±nÄ± ve ardÄ±ndan ZIP dosyasÄ±nÄ±n iÃ§eriÄŸini bir dizine Ã§Ä±karmayÄ± iÃ§erir. Ä°ÅŸte adÄ±mlar:

1. `"extension_id"` yerine gerÃ§ek uzantÄ± kimliÄŸini yazÄ±n.
2. AÅŸaÄŸÄ±daki komutlarÄ± Ã§alÄ±ÅŸtÄ±rÄ±n:
```bash
extension_id=your_extension_id   # Replace with the actual extension ID
curl -L -o "$extension_id.zip" "https://clients2.google.com/service/update2/crx?response=redirect&os=mac&arch=x86-64&nacl_arch=x86-64&prod=chromecrx&prodchannel=stable&prodversion=44.0.2403.130&x=id%3D$extension_id%26uc"
unzip -d "$extension_id-source" "$extension_id.zip"
```
### CRX Viewer websitesini kullanÄ±n

[https://robwu.nl/crxviewer/](https://robwu.nl/crxviewer/)

### CRX Viewer uzantÄ±sÄ±nÄ± kullanÄ±n

BaÅŸka bir pratik yÃ¶ntem, aÃ§Ä±k kaynaklÄ± bir proje olan Chrome Extension Source Viewer'Ä± kullanmaktÄ±r. Bu, [Chrome Web MaÄŸazasÄ±'ndan](https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin?hl=en) yÃ¼klenebilir. GÃ¶rÃ¼ntÃ¼leyicinin kaynak kodu [GitHub deposunda](https://github.com/Rob--W/crxviewer) bulunabilir.

### Yerel olarak yÃ¼klenen uzantÄ±nÄ±n kaynaÄŸÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin

Yerel olarak yÃ¼klenen Chrome uzantÄ±larÄ± da incelenebilir. Ä°ÅŸte nasÄ±l yapÄ±lÄ±r:

1. "Profile Path" alanÄ±nÄ± bulmak iÃ§in `chrome://version/` adresine giderek Chrome yerel profil dizinine eriÅŸin.
2. Profil dizini iÃ§indeki `Extensions/` alt klasÃ¶rÃ¼ne gidin.
3. Bu klasÃ¶r genellikle okunabilir bir formatta olan tÃ¼m yÃ¼klenmiÅŸ uzantÄ±larÄ± iÃ§erir.

UzantÄ±larÄ± tanÄ±mlamak iÃ§in ID'lerini isimlere eÅŸleyebilirsiniz:

* Her uzantÄ±nÄ±n ID'lerini gÃ¶rmek iÃ§in `about:extensions` sayfasÄ±nda GeliÅŸtirici Modunu etkinleÅŸtirin.
* Her uzantÄ±nÄ±n klasÃ¶rÃ¼ iÃ§inde, `manifest.json` dosyasÄ±, uzantÄ±yÄ± tanÄ±manÄ±za yardÄ±mcÄ± olan okunabilir bir `name` alanÄ± iÃ§erir.

### Bir Dosya ArÅŸivleyici veya AÃ§Ä±cÄ± KullanÄ±n

Chrome Web MaÄŸazasÄ±na gidin ve uzantÄ±yÄ± indirin. DosyanÄ±n uzantÄ±sÄ± `.crx` olacaktÄ±r. Dosya uzantÄ±sÄ±nÄ± `.crx`'den `.zip`'e deÄŸiÅŸtirin. ZIP dosyasÄ±nÄ±n iÃ§eriÄŸini Ã§Ä±karmak iÃ§in WinRAR, 7-Zip vb. gibi herhangi bir dosya arÅŸivleyicisini kullanÄ±n.

### Chrome'da GeliÅŸtirici Modunu KullanÄ±n

Chrome'u aÃ§Ä±n ve `chrome://extensions/` adresine gidin. SaÄŸ Ã¼stte "GeliÅŸtirici modunu" etkinleÅŸtirin. "PaketlenmemiÅŸ uzantÄ±yÄ± yÃ¼kle..." Ã¼zerine tÄ±klayÄ±n. UzantÄ±nÄ±n dizinine gidin. Bu, kaynak kodunu indirmez, ancak zaten indirilmiÅŸ veya geliÅŸtirilmiÅŸ bir uzantÄ±nÄ±n kodunu gÃ¶rÃ¼ntÃ¼lemek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±ÅŸlÄ±dÄ±r.

## GÃ¼venlik Denetim Listesi

TarayÄ±cÄ± UzantÄ±larÄ±nÄ±n **sÄ±nÄ±rlÄ± saldÄ±rÄ± yÃ¼zeyine** sahip olmasÄ±na raÄŸmen, bazÄ±larÄ± **zafiyetler** veya **potansiyel sÄ±kÄ±laÅŸtÄ±rma iyileÅŸtirmeleri** iÃ§erebilir. En yaygÄ±n olanlar ÅŸunlardÄ±r:

* [ ] MÃ¼mkÃ¼n olduÄŸunca az **`izinler`** isteyin
* [ ] MÃ¼mkÃ¼n olduÄŸunca az **`host_permissions`** isteyin
* GÃ¼Ã§lÃ¼ bir **`content_security_policy`** kullanÄ±n
* **`externally_connectable`**'Ä± mÃ¼mkÃ¼n olduÄŸunca sÄ±nÄ±rlayÄ±n, gerekli deÄŸilse ve mÃ¼mkÃ¼nse varsayÄ±lan olarak bÄ±rakmayÄ±n, **`{}`** belirtin
* Burada XSS'ye veya ele geÃ§irmeye aÃ§Ä±k olan bir URL belirtilmiÅŸse, bir saldÄ±rganÄ±n **mesajlarÄ± doÄŸrudan arka plan betiklerine gÃ¶ndermesine** izin verilecektir. Ã‡ok gÃ¼Ã§lÃ¼ bir atlatma.
* MÃ¼mkÃ¼n olduÄŸunca **`web_accessible_resources`**'Ä± sÄ±nÄ±rlayÄ±n, mÃ¼mkÃ¼nse boÅŸ bÄ±rakÄ±n.
* EÄŸer **`web_accessible_resources`** yoksa, [**ClickJacking**](browext-clickjacking.md) iÃ§in kontrol edin
* EÄŸer herhangi bir **iletiÅŸim** uzantÄ±dan **web sayfasÄ±na** doÄŸru gerÃ§ekleÅŸiyorsa, iletiÅŸimde oluÅŸan **XSS zafiyetlerini** kontrol edin.
* Post MesajlarÄ± kullanÄ±lÄ±yorsa, [**Post Mesaj zafiyetlerini**](../postmessage-vulnerabilities/) kontrol edin.
* **Ä°Ã§erik BetiÄŸi DOM detaylarÄ±na eriÅŸiyorsa**, bunlarÄ±n web tarafÄ±ndan **deÄŸiÅŸtirilmesi durumunda XSS** tanÄ±mlamayÄ±n
* Bu iletiÅŸimin aynÄ± zamanda **Ä°Ã§erik BetiÄŸi -> Arka plan betiÄŸi ile iletiÅŸimde** olmasÄ± durumunda Ã¶zel bir vurgu yapÄ±n
* TarayÄ±cÄ± UzantÄ±sÄ± **kodunun iÃ§inde hassas bilgiler saklanmamalÄ±dÄ±r**
* TarayÄ±cÄ± UzantÄ±sÄ± **belleÄŸinde hassas bilgiler saklanmamalÄ±dÄ±r**

## AraÃ§lar

### [**Tarnish**](https://thehackerblog.com/tarnish/)

* SaÄŸlanan bir Chrome web maÄŸazasÄ± baÄŸlantÄ±sÄ±ndan herhangi bir Chrome uzantÄ±sÄ±nÄ± Ã§eker.
* [**manifest.json**](https://developer.chrome.com/extensions/manifest) **gÃ¶rÃ¼ntÃ¼leyici**: uzantÄ±nÄ±n manifest dosyasÄ±nÄ±n JSON ÅŸeklinde gÃ¼zel gÃ¶rÃ¼ntÃ¼lenmiÅŸ bir sÃ¼rÃ¼mÃ¼nÃ¼ basitÃ§e gÃ¶sterir.
* **Parmak Ä°zi Analizi**: [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) tespiti ve Chrome uzantÄ±sÄ± parmak izi oluÅŸturma JavaScript'inin otomatik oluÅŸturulmasÄ±.
* **Potansiyel Clickjacking Analizi**: [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) yÃ¶nergesi ayarlanmÄ±ÅŸ uzantÄ± HTML sayfalarÄ±nÄ±n tespiti. Bu sayfalar, sayfalarÄ±n amacÄ±na baÄŸlÄ± olarak clickjacking'e karÅŸÄ± potansiyel olarak savunmasÄ±z olabilir.
* **Ä°zin UyarÄ±larÄ± GÃ¶rÃ¼ntÃ¼leyici**: bir kullanÄ±cÄ±nÄ±n uzantÄ±yÄ± yÃ¼klemeye Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda gÃ¶sterilecek tÃ¼m Chrome izin uyarÄ±larÄ±nÄ±n bir listesini gÃ¶sterir.
* **Tehlikeli Fonksiyonlar**: bir saldÄ±rgan tarafÄ±ndan sÃ¶mÃ¼rÃ¼lebilecek tehlikeli fonksiyonlarÄ±n konumunu gÃ¶sterir (Ã¶rneÄŸin, innerHTML, chrome.tabs.executeScript gibi fonksiyonlar).
* **GiriÅŸ NoktalarÄ±**: uzantÄ±nÄ±n kullanÄ±cÄ±/dÄ±ÅŸ giriÅŸ aldÄ±ÄŸÄ± yerleri gÃ¶sterir. Bu, bir uzantÄ±nÄ±n yÃ¼zey alanÄ±nÄ± anlamak ve uzantÄ±ya kÃ¶tÃ¼ niyetli ÅŸekilde oluÅŸturulmuÅŸ verileri gÃ¶ndermek iÃ§in potansiyel noktalarÄ± aramak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r.
* Hem Tehlikeli Fonksiyonlar hem de GiriÅŸ NoktalarÄ± tarayÄ±cÄ±larÄ± iÃ§in oluÅŸturulan uyarÄ±lar ÅŸunlarÄ± iÃ§erir:
* UyarÄ±ya sebep olan ilgili kod parÃ§asÄ± ve satÄ±r.
* Sorunun aÃ§Ä±klamasÄ±.
* Kodu iÃ§eren tam kaynak dosyasÄ±nÄ± gÃ¶rÃ¼ntÃ¼lemek iÃ§in "DosyayÄ± GÃ¶rÃ¼ntÃ¼le" dÃ¼ÄŸmesi.
* UyarÄ± verilen dosyanÄ±n yolu.
* UyarÄ± verilen dosyanÄ±n tam Chrome uzantÄ±sÄ± URI'si.
* DosyanÄ±n tÃ¼rÃ¼, arka plan sayfasÄ± betiÄŸi, Ä°Ã§erik BetiÄŸi, TarayÄ±cÄ± Eylemi vb.
* EÄŸer zafiyetli satÄ±r bir JavaScript dosyasÄ±nda ise, bu satÄ±rÄ±n dahil olduÄŸu tÃ¼m sayfalarÄ±n yollarÄ± ve bu sayfalarÄ±n tÃ¼rleri, ve [web\_accessible\_resource](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) durumu.
* **Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) analizcisi ve atlatma kontrolcÃ¼sÃ¼**: Bu, uzantÄ±nÄ±zÄ±n CSP'sindeki zayÄ±flÄ±klarÄ± belirtecek ve whitelistlenmiÅŸ CDN'ler nedeniyle CSP'nizi atlamak iÃ§in potansiyel yollarÄ± aydÄ±nlatacaktÄ±r.
* **Bilinen Zafiyetli KÃ¼tÃ¼phaneler**: Bu, bilinen-zafiyetli JavaScript kÃ¼tÃ¼phanelerinin kullanÄ±mÄ±nÄ± kontrol etmek iÃ§in [Retire.js](https://retirejs.github.io/retire.js/) kullanÄ±r.
* UzantÄ±yÄ± indirin ve biÃ§imlendirilmiÅŸ sÃ¼rÃ¼mleri indirin.
* Orijinal uzantÄ±yÄ± indirin.
* UzantÄ±nÄ±n gÃ¼zelleÅŸtirilmiÅŸ sÃ¼rÃ¼mÃ¼nÃ¼ indirin (otomatik olarak gÃ¼zelleÅŸtirilmiÅŸ HTML ve JavaScript).
* Tarama sonuÃ§larÄ±nÄ±n otomatik Ã¶nbelleÄŸe alÄ±nmasÄ±, bir uzantÄ± taramasÄ± yapmak ilk kez uzun bir sÃ¼re alabilir. Ancak, uzantÄ± gÃ¼ncellenmediyse ikinci kez Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda sonuÃ§lar Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ±ndan neredeyse anlÄ±k olacaktÄ±r.
* BaÄŸlantÄ±labilir Rapor URL'leri, Tarnish tarafÄ±ndan oluÅŸturulan bir uzantÄ± raporuna baÅŸka birine kolayca baÄŸlantÄ± saÄŸlar.

### [Neto](https://github.com/elevenpaths/neto)

Proje Neto, Firefox ve Chrome gibi popÃ¼ler tarayÄ±cÄ±lar iÃ§in tarayÄ±cÄ± eklentilerinin ve uzantÄ±larÄ±nÄ±n gizli Ã¶zelliklerini analiz etmek ve aÃ§Ä±ÄŸa Ã§Ä±karmak iÃ§in tasarlanmÄ±ÅŸ Python 3 paketidir. Bu, paketlenmiÅŸ dosyalarÄ± aÃ§mak iÃ§in otomasyon saÄŸlar ve bu Ã¶zellikleri uzantÄ±dan ilgili kaynaklardaki Ã¶zelliklerden (Ã¶rneÄŸin `manifest.json`, yerelleÅŸtirme klasÃ¶rleri veya JavaScript ve HTML kaynak dosyalarÄ±) Ã§Ä±karmayÄ± otomatikleÅŸtirir.

## Referanslar

* Bu metodolojiye yardÄ±mÄ± iÃ§in [**@naivenom**](https://twitter.com/naivenom)'a **teÅŸekkÃ¼rler**
* [https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing](https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing)
* [https://palant.info/2022/08/10/anatomy-of-a-basic-extension/](https://palant.info/2022/08/10/anatomy-of-a-basic-extension/)
* [https://palant.info/2022/08/24/attack-surface-of-extension-pages/](https://palant.info/2022/08/24/attack-surface-of-extension-pages/)
* [https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/](https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/)
* [https://help.passbolt.com/assets/files/PBL-02-report.pdf](https://help.passbolt.com/assets/files/PBL-02-report.pdf)
* [https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts](https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts)
* [https://developer.chrome.com/docs/extensions/mv2/background-pages](https://developer.chrome.com/docs/extensions/mv2/background-pages)
* [https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/](https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/)
* [https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0](https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmaya kadar AWS hacklemeyi Ã¶ÄŸrenin</summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:
* EÄŸer **ÅŸirketinizin HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubumuza**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸÄ±n, PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.
