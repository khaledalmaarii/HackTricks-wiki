# –ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è –ø–µ–Ω—Ç–µ—Å—Ç–∏–Ω–≥—É –±—Ä–∞—É–∑–µ—Ä–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞–ø–∏—Å–∞–Ω—ñ –Ω–∞ JavaScript —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ. –í–æ–Ω–æ –º–∞—î —Å–≤—ñ–π [DOM](https://www.w3schools.com/js/js\_htmldom.asp), –∞–ª–µ –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ DOM —ñ–Ω—à–∏—Ö —Å–∞–π—Ç—ñ–≤. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–æ–Ω–æ –º–æ–∂–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å, —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å —ñ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å (CIA) —ñ–Ω—à–∏—Ö —Å–∞–π—Ç—ñ–≤.

## –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

–ú–∞–∫–µ—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω—å –≤–∏–≥–ª—è–¥–∞—é—Ç—å –Ω–∞–π–∫—Ä–∞—â–µ, –∫–æ–ª–∏ —ó—Ö –≤—ñ–∑—É–∞–ª—ñ–∑—É—é—Ç—å, —ñ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ —Ç—Ä—å–æ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤. –î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ.

<figure><img src="../../.gitbook/assets/image (16) (1).png" alt=""><figcaption><p><a href="http://webblaze.cs.berkeley.edu/papers/Extensions.pdf">http://webblaze.cs.berkeley.edu/papers/Extensions.pdf</a></p></figcaption></figure>

### **–°–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É**

–ö–æ–∂–µ–Ω —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–∞—î –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ DOM **–æ–¥–Ω—ñ—î—ó –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏** —ñ, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, –ø—ñ–¥–¥–∞—î—Ç—å—Å—è **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —à–∫—ñ–¥–ª–∏–≤–æ–º—É –≤–≤–æ–¥—É**. –û–¥–Ω–∞–∫ —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–µ –º–∞—î –∂–æ–¥–Ω–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤, –æ–∫—Ä—ñ–º –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### **–Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**

–Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç—å –±—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–∏–≤—ñ–ª–µ—ó–≤/–¥–æ—Å—Ç—É–ø—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞–ª–µ —è–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –≤–µ–±-–∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –ª–∏—à–µ —á–µ—Ä–µ–∑ [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest) —Ç–∞ —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É. –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–µ –º–∞—î –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–∏.

### **–†—ñ–¥–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª**

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —Ä—ñ–¥–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –º–æ–∂–µ **–¥–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –¥–æ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–∏ –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.** –†—ñ–¥–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –≤–∑–∞—î–º–æ–¥—ñ—î –∑ —è–¥—Ä–æ–º —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤ –ø–ª–∞–≥—ñ–Ω—ñ–≤ Netscape ([NPAPI](https://en.wikipedia.org/wiki/NPAPI)), —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Flash —Ç–∞ —ñ–Ω—à–∏–º–∏ –ø–ª–∞–≥—ñ–Ω–∞–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞.

### –ú–µ–∂—ñ

{% hint style="danger" %}
–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≤–Ω—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø–æ–≤–∏–Ω–µ–Ω –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–µ—Ä–µ–¥–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –≤–≤—ñ–¥ –≤—ñ–¥ —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –¥–æ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —ñ –≤—ñ–¥ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ —Ä—ñ–¥–Ω–æ–≥–æ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É.
{% endhint %}

–ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–∏–π –æ–¥–∏–Ω –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ **—Å–∏–ª—å–Ω–∏–º–∏ –∑–∞—Ö–∏—Å–Ω–∏–º–∏ –º–µ–∂–∞–º–∏**. –ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∞—Ü—é—î –≤ **–æ–∫—Ä–µ–º–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏**. –°–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç–∞ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å —É **–ø—ñ—Å–æ—á–Ω–∏—Ü—è—Ö**, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏—Ö –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ —Å–ª—É–∂–± –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω—ñ –≤—ñ–¥ —Å–≤–æ—ó—Ö –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω–∏—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, **–ø—Ä–∞—Ü—é—é—á–∏ –≤ –æ–∫—Ä–µ–º—ñ–π –∫—É–ø—ñ JavaScript**. –°–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–∞—é—Ç—å **–¥–æ—Å—Ç—É–ø –¥–æ –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ –±–∞–∑–æ–≤–æ–≥–æ DOM**, –∞–ª–µ –¥–≤–æ—î **–Ω—ñ–∫–æ–ª–∏ –Ω–µ –æ–±–º—ñ–Ω—é—é—Ç—å—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ JavaScript**, —â–æ –∑–∞–ø–æ–±—ñ–≥–∞—î –≤–∏—Ç–æ–∫—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ JavaScript.

## **`manifest.json`**

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome - —Ü–µ –ø—Ä–æ—Å—Ç–æ ZIP-–ø–∞–ø–∫–∞ –∑ [.crx —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º —Ñ–∞–π–ª—É](https://www.lifewire.com/crx-file-2620391). –Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è - —Ü–µ **`manifest.json`** —Ñ–∞–π–ª —É –∫–æ—Ä–µ–Ω—ñ –ø–∞–ø–∫–∏, —è–∫–∏–π –≤–∫–∞–∑—É—î –º–∞–∫–µ—Ç, –¥–æ–∑–≤–æ–ª–∏ —Ç–∞ —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

–ü—Ä–∏–∫–ª–∞–¥:
```json
{
"manifest_version": 2,
"name": "My extension",
"version": "1.0",
"permissions": [
"storage"
],
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
"background": {
"scripts": [
"background.js"
]
},
"options_ui": {
"page": "options.html"
}
}
```
### `content_scripts`

–°–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É **–∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è** —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á **–ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É**, —É –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –±—É–¥—å-—è–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏—Ä–∞–∑—É **`https://example.com/*`** —ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤–∏—Ä–∞–∑—É **`*://*/*/business*`**. –í–æ–Ω–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è **—è–∫ –≤–ª–∞—Å–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏** —ñ –º–∞—é—Ç—å –¥–æ–≤—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ [Document Object Model (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document\_Object\_Model) —Å—Ç–æ—Ä—ñ–Ω–∫–∏.
```json
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
```
–©–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –∞–±–æ –≤–∏–∫–ª—é—á–∏—Ç–∏ –±—ñ–ª—å—à–µ URL-–∞–¥—Ä–µ—Å, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`include_globs`** —Ç–∞ **`exclude_globs`**.

–¶–µ –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞, —è–∫–∏–π –¥–æ–¥–∞—Å—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É, –∫–æ–ª–∏ [API –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è `message` –∑ –ø–∞–º'—è—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
```js
chrome.storage.local.get("message", result =>
{
let div = document.createElement("div");
div.innerHTML = result.message + " <button>Explain</button>";
div.querySelector("button").addEventListener("click", () =>
{
chrome.runtime.sendMessage("explain");
});
document.body.appendChild(div);
});
```
<figure><img src="../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç—É, –∫–æ–ª–∏ —Ü—è –∫–Ω–æ–ø–∫–∞ –Ω–∞—Ç–∏—Å–∫–∞—î—Ç—å—Å—è, —á–µ—Ä–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è [**runtime.sendMessage() API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage). –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º–∏ —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤ –ø—Ä—è–º–æ–º—É –¥–æ—Å—Ç—É–ø—ñ –¥–æ API, –∑ `storage`, —â–æ —î –æ–¥–Ω–∏–º –∑ –Ω–µ–±–∞–≥–∞—Ç—å–æ—Ö –≤–∏–Ω—è—Ç–∫—ñ–≤. –î–ª—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–µ–π, —â–æ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ —Ü–∏—Ö –≤–∏–Ω—è—Ç–∫—ñ–≤, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑ —è–∫–∏–º–∏ –º–æ–∂—É—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É.

{% hint style="warning" %}
–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –±—Ä–∞—É–∑–µ—Ä–∞, –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂—É—Ç—å —Ç—Ä–æ—Ö–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è. –î–ª—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ –Ω–∞ –±–∞–∑—ñ Chromium —Å–ø–∏—Å–æ–∫ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –¥–æ—Å—Ç—É–ø–Ω–∏–π —É [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó Chrome Developers](https://developer.chrome.com/docs/extensions/mv3/content\_scripts/#capabilities), –∞ –¥–ª—è Firefox –æ—Å–Ω–æ–≤–Ω–∏–º –¥–∂–µ—Ä–µ–ª–æ–º —î [MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content\_scripts#webextension\_apis).\
–¢–∞–∫–æ–∂ –≤–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑—ñ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ —Ñ–æ–Ω—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ó–º –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó —Ç–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞–∑–∞–¥.
{% endhint %}

–î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤ Chrome –º–µ–Ω—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –∑ Options > More tools > Developer tools –ê–ë–û –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ Ctrl + Shift + I.

–ü—ñ—Å–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ **–≤–∫–ª–∞–¥–∫—É Source**, –∞ –ø–æ—Ç—ñ–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Content Scripts**. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –∑–∞–ø—É—â–µ–Ω–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É –∑ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–æ—á–∫–∏ –∑—É–ø–∏–Ω–∫–∏ –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É

{% hint style="success" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **—Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–µ —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–¥–∏–Ω–∞–º—ñ—á–Ω–æ** **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏** —Å–∫—Ä–∏–ø—Ç–∏ —Ç–∞ **–ø—Ä–æ–≥—Ä–∞–º–Ω–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ —ó—Ö** –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö —á–µ—Ä–µ–∑ **`tabs.executeScript`**. –¶–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –Ω–∞–¥–∞—î –±—ñ–ª—å—à–µ **–¥–æ–∫–ª–∞–¥–Ω–∏—Ö –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤**.
{% endhint %}

–î–ª—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–æ–≤–∏–Ω–Ω–æ –º–∞—Ç–∏ [–¥–æ–∑–≤–æ–ª–∏ —Ö–æ—Å—Ç–∞](https://developer.chrome.com/docs/extensions/reference/permissions) –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –Ω–∞ —è–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∏. –¶—ñ –¥–æ–∑–≤–æ–ª–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω—ñ –∞–±–æ **–∑–∞–ø–∏—Ç—É—é—á–∏ —ó—Ö** —É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞–±–æ –Ω–∞ —Ç–∏–º—á–∞—Å–æ–≤—ñ–π –æ—Å–Ω–æ–≤—ñ —á–µ—Ä–µ–∑ [**activeTab**](https://developer.chrome.com/docs/extensions/reference/manifest/activeTab).

#### –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ activeTab

{% code title="manifest.json" %}
```json
{
"name": "My extension",
...
"permissions": [
"activeTab",
"scripting"
],
"background": {
"service_worker": "background.js"
},
"action": {
"default_title": "Action Button"
}
}
```
{% endcode %}

* **–í—Å—Ç–∞–≤–∏—Ç–∏ JS —Ñ–∞–π–ª –ø–æ –∫–ª—ñ–∫—É:**
```javascript
// content-script.js
document.body.style.backgroundColor = "orange";

//service-worker.js - Inject the JS file
chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target: { tabId: tab.id },
files: ["content-script.js"]
});
});
```
* **–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é** –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ:
```javascript
//service-worker.js - Inject a function
function injectedFunction() {
document.body.style.backgroundColor = "orange";
}

chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target : {tabId : tab.id},
func : injectedFunction,
});
});
```
#### –ü—Ä–∏–∫–ª–∞–¥ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∏
```javascript
// service-workser.js
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
excludeMatches : [ "*://*/*business*" ],
js : [ "contentScript.js" ],
}]);

// Another example
chrome.tabs.executeScript(tabId, { file: "content_script.js" });
```
–©–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –∞–±–æ –≤–∏–∫–ª—é—á–∏—Ç–∏ –±—ñ–ª—å—à–µ URL-–∞–¥—Ä–µ—Å, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`include_globs`** —Ç–∞ **`exclude_globs`**.

### Content Scripts `run_at`

–ü–æ–ª–µ `run_at` –∫–æ–Ω—Ç—Ä–æ–ª—é—î **–∫–æ–ª–∏ JavaScript —Ñ–∞–π–ª–∏ –≤–ø—Ä–æ–≤–∞–¥–∂—É—é—Ç—å—Å—è –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É**. –ë–∞–∂–∞–Ω–µ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º - `"document_idle"`.

–ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:

* **`document_idle`**: –ö–æ–ª–∏ —Ü–µ –º–æ–∂–ª–∏–≤–æ
* **`document_start`**: –ü—ñ—Å–ª—è –±—É–¥—å-—è–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤ –∑ `css`, –∞–ª–µ –¥–æ —Ç–æ–≥–æ, —è–∫ –±—É–¥–µ –ø–æ–±—É–¥–æ–≤–∞–Ω–æ –±—É–¥—å-—è–∫–µ —ñ–Ω—à–µ DOM –∞–±–æ –∑–∞–ø—É—â–µ–Ω–æ –±—É–¥—å-—è–∫–∏–π —ñ–Ω—à–∏–π —Å–∫—Ä–∏–ø—Ç.
* **`document_end`**: –ù–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è DOM, –∞–ª–µ –¥–æ —Ç–æ–≥–æ, —è–∫ –ø—ñ–¥—Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —Ñ—Ä–µ–π–º–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏—Å—è.

#### Via `manifest.json`
```json
{
"name": "My extension",
...
"content_scripts": [
{
"matches": ["https://*.example.com/*"],
"run_at": "document_idle",
"js": ["contentScript.js"]
}
],
...
}

```
–ß–µ—Ä–µ–∑ **`service-worker.js`**
```javascript
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
runAt : "document_idle",
js : [ "contentScript.js" ],
}]);
```
### `background`

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É, –æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è **—Ñ–æ–Ω–æ–≤–æ—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é**, —è–∫–∞ –≤—ñ–¥—ñ–≥—Ä–∞—î —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É —Ä–æ–ª—å —É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞, —Ñ–æ–Ω–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ø—Ä–æ—Ç—è–≥–æ–º —É—Å—å–æ–≥–æ –∂–∏—Ç—Ç—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –ø—Ä–∞—Ü—é—é—á–∏ –Ω–µ–ø–æ–º—ñ—Ç–Ω–æ –±–µ–∑ –ø—Ä—è–º–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º. –í–æ–Ω–∞ –º–∞—î –≤–ª–∞—Å–Ω—É –º–æ–¥–µ–ª—å –æ–±'—î–∫—Ç—ñ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DOM), —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º.

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏**:

* **–†–æ–ª—å —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏:** –í–∏–∫–æ–Ω—É—î —Ñ—É–Ω–∫—Ü—ñ—é –Ω–µ—Ä–≤–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä—É –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –∑–≤'—è–∑–æ–∫ —ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—é –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ü–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å:** –¶–µ –∑–∞–≤–∂–¥–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –æ–±'—î–∫—Ç, –Ω–µ–≤–∏–¥–∏–º–∏–π –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∞–ª–µ –≤–∞–∂–ª–∏–≤–∏–π –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** –Ø–∫—â–æ –Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ —è–≤–Ω–æ, –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å —Ñ–æ–Ω–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É. –¶—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º—ñ—Å—Ç–∏—Ç–∏–º–µ –≤—Å—ñ —Ñ–æ–Ω–æ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∏, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –±–µ–∑–ø–µ—Ä–µ–±—ñ–π–Ω—É —Ä–æ–±–æ—Ç—É —Ñ–æ–Ω–æ–≤–∏—Ö –∑–∞–≤–¥–∞–Ω—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

{% hint style="success" %}
–ó—Ä—É—á–Ω—ñ—Å—Ç—å, —è–∫—É –Ω–∞–¥–∞—î –±—Ä–∞—É–∑–µ—Ä, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—é—á–∏ —Ñ–æ–Ω–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É (–∫–æ–ª–∏ –≤–æ–Ω–∞ –Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–∞ —è–≤–Ω–æ), –∑–∞–±–µ–∑–ø–µ—á—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —Ñ–æ–Ω–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤, —Å–ø—Ä–æ—â—É—é—á–∏ –ø—Ä–æ—Ü–µ—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
{% endhint %}

–ü—Ä–∏–∫–ª–∞–¥ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É:
```js
chrome.runtime.onMessage.addListener((request, sender, sendResponse) =>
{
if (request == "explain")
{
chrome.tabs.create({ url: "https://example.net/explanation" });
}
})
```
–í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [runtime.onMessage API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage) –¥–ª—è –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å. –ö–æ–ª–∏ –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `"explain"`, –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [tabs API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ.

–©–æ–± –Ω–∞–ª–∞–≥–æ–¥–∏—Ç–∏ —Ñ–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **–¥–µ—Ç–∞–ª–µ–π —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–æ–±—ñ—Ç–Ω–∏–∫,** —Ü–µ –≤—ñ–¥–∫—Ä–∏—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∑ —Ñ–æ–Ω–æ–≤–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º:

<figure><img src="https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/browser-extension-pentesting-methodology/broken-reference" alt=""><figcaption></figcaption></figure>

### –°—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ —ñ–Ω—à–µ

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ —Ä—ñ–∑–Ω—ñ –≤–∏–¥–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫:

* **–°—Ç–æ—Ä—ñ–Ω–∫–∏ –¥—ñ–π** –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è —É **–≤–∏–ø–∞–¥–Ω–æ–º—É –º–µ–Ω—é, –∫–æ–ª–∏ –Ω–∞—Ç–∏—Å–∫–∞—î—Ç—å—Å—è —ñ–∫–æ–Ω–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**.
* –°—Ç–æ—Ä—ñ–Ω–∫–∏, —è–∫—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—É–¥–µ **–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ**.
* **–°—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤**: –¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –ø–æ–≤–µ—Ä—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ. –£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ –≤ –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É —è –∑–º—ñ–≥ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é `chrome://extensions/?options=fadlhnelkbeojnebcbkacjilhnbjfjca` –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏:

<figure><img src="../../.gitbook/assets/image (24).png" alt="" width="375"><figcaption></figcaption></figure>

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–µ —î –ø–æ—Å—Ç—ñ–π–Ω–∏–º–∏, —è–∫ —Ñ–æ–Ω–æ–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å –≤–º—ñ—Å—Ç –∑–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ü–µ, –≤–æ–Ω–∏ –º–∞—é—Ç—å –ø–µ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑ —Ñ–æ–Ω–æ–≤–æ—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é:

* **–ó–≤'—è–∑–æ–∫ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏:** –ü–æ–¥—ñ–±–Ω–æ –¥–æ —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤, —â–æ –ø–æ–ª–µ–≥—à—É—î –≤–∑–∞—î–º–æ–¥—ñ—é –≤ –º–µ–∂–∞—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–î–æ—Å—Ç—É–ø –¥–æ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è API:** –¶—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–∞—é—Ç—å –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è API, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –¥–æ–∑–≤–æ–ª—ñ–≤, –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### `permissions` & `host_permissions`

**`permissions`** —Ç–∞ **`host_permissions`** —î –∑–∞–ø–∏—Å–∞–º–∏ –∑ `manifest.json`, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å **—è–∫—ñ –¥–æ–∑–≤–æ–ª–∏** –º–∞—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ (—Å—Ö–æ–≤–∏—â–µ, –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è...) —ñ –≤ **—è–∫–∏—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö**.

–û—Å–∫—ñ–ª—å–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ **–ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–º–∏**, –∑–ª–æ–≤–º–∏—Å–Ω–µ –∞–±–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É **—Ä—ñ–∑–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ —à–ø–∏–≥—É–Ω—Å—Ç–≤–∞ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫ —Ü—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å —ñ —è–∫ —ó—Ö –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –≤:

{% content-ref url="browext-permissions-and-host_permissions.md" %}
[browext-permissions-and-host\_permissions.md](browext-permissions-and-host\_permissions.md)
{% endcontent-ref %}

### `content_security_policy`

**–ü–æ–ª—ñ—Ç–∏–∫—É –±–µ–∑–ø–µ–∫–∏ –≤–º—ñ—Å—Ç—É** —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `manifest.json`. –Ø–∫—â–æ –≤–æ–Ω–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–∞, –≤–æ–Ω–∞ –º–æ–∂–µ –±—É—Ç–∏ **–≤—Ä–∞–∑–ª–∏–≤–æ—é**.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ —î –¥–æ—Å–∏—Ç—å –æ–±–º–µ–∂—É–≤–∞–ª—å–Ω–∏–º–∏:
```bash
script-src 'self'; object-src 'self';
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ CSP —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –æ–±—Ö–æ–¥–∏, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="../content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../content-security-policy-csp-bypass/)
{% endcontent-ref %}

### `web_accessible_resources`

—â–æ–± –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–æ–≥–ª–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `.html` —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Ü—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –∑–∞–∑–Ω–∞—á–µ–Ω–∞ –≤ –ø–æ–ª—ñ **`web_accessible_resources`** —Ñ–∞–π–ª—É `manifest.json`.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```javascript
{
...
"web_accessible_resources": [
{
"resources": [ "images/*.png" ],
"matches": [ "https://example.com/*" ]
},
{
"resources": [ "fonts/*.woff" ],
"matches": [ "https://example.com/*" ]
}
],
...
}
```
–¶—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑–∞ URL, —è–∫:
```
chrome-extension://<extension-id>/message.html
```
–£ –ø—É–±–ª—ñ—á–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è—Ö **extension-id –¥–æ—Å—Ç—É–ø–Ω–∏–π**:

<figure><img src="../../.gitbook/assets/image (1194).png" alt="" width="375"><figcaption></figcaption></figure>

–•–æ—á–∞, —è–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `manifest.json` **`use_dynamic_url`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, —Ü–µ–π **id –º–æ–∂–µ –±—É—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º**.

{% hint style="success" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–≥–∞–¥—É—î—Ç—å—Å—è —Ç—É—Ç, –≤–æ–Ω–∞ –º–æ–∂–µ –±—É—Ç–∏ **–∑–∞—Ö–∏—â–µ–Ω–∞ –≤—ñ–¥ ClickJacking** –∑–∞–≤–¥—è–∫–∏ **Content Security Policy**. –¢–æ–º—É –≤–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ü–µ (—Ä–æ–∑–¥—ñ–ª frame-ancestors) –ø–µ—Ä–µ–¥ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∞—Ç–∞–∫–∏ ClickJacking.
{% endhint %}

–î–æ—Å—Ç—É–ø –¥–æ —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–±–∏—Ç—å —ó—Ö **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ ClickJacking**:

{% content-ref url="browext-clickjacking.md" %}
[browext-clickjacking.md](browext-clickjacking.md)
{% endcontent-ref %}

{% hint style="success" %}
–î–æ–∑–≤–æ–ª—è—é—á–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ª–∏—à–µ —á–µ—Ä–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞ –Ω–µ —á–µ—Ä–µ–∑ –≤–∏–ø–∞–¥–∫–æ–≤—ñ URL, –º–æ–∂–Ω–∞ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∞—Ç–∞–∫–∞–º ClickJacking.
{% endhint %}

{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ **`web_accessible_resources`** —Ç–∞ —ñ–Ω—à—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å **–∫–æ–Ω—Ç–∞–∫—Ç—É–≤–∞—Ç–∏ –∑ —Ñ–æ–Ω–æ–≤–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏**. –¢–æ–º—É, —è–∫—â–æ –æ–¥–Ω–∞ –∑ —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ **XSS**, —Ü–µ –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –±—ñ–ª—å—à—É –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –ª–∏—à–µ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –≤–∫–∞–∑–∞–Ω—ñ –≤ **`web_accessible_resources`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ iframe, –∞–ª–µ –∑ –Ω–æ–≤–æ—ó –≤–∫–ª–∞–¥–∫–∏ –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±—É–¥—å-—è–∫–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ, –∑–Ω–∞—é—á–∏ ID —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –¢–æ–º—É, —è–∫—â–æ XSS –≤–∏—è–≤–ª–µ–Ω–æ, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ —Ç–∏–º–∏ –∂ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –≤ **`web_accessible_resources`**.
{% endhint %}

### `externally_connectable`

–ó–≥—ñ–¥–Ω–æ –∑ [**–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é**](https://developer.chrome.com/docs/extensions/reference/manifest/externally-connectable), –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É `"externally_connectable"` –æ–≥–æ–ª–æ—à—É—î **—è–∫—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è** –¥–æ –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–µ—Ä–µ–∑ [runtime.connect](https://developer.chrome.com/docs/extensions/reference/runtime#method-connect) —Ç–∞ [runtime.sendMessage](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage).

* –Ø–∫—â–æ –∫–ª—é—á **`externally_connectable`** **–Ω–µ** –æ–≥–æ–ª–æ—à–µ–Ω–∏–π —É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∞–±–æ –≤—ñ–Ω –æ–≥–æ–ª–æ—à–µ–Ω–∏–π —è–∫ **`"ids": ["*"]`**, **–≤—Å—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è, –∞–ª–µ –∂–æ–¥–Ω—ñ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–µ –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è**.
* –Ø–∫—â–æ **–≤–∫–∞–∑–∞–Ω—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ ID**, —è–∫ —É `"ids": ["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"]`, **—Ç—ñ–ª—å–∫–∏ —Ü—ñ –ø—Ä–æ–≥—Ä–∞–º–∏** –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è.
* –Ø–∫—â–æ **–≤–∫–∞–∑–∞–Ω—ñ –∑–±—ñ–≥–∏**, —Ü—ñ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏ –∑–º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è:
```json
"matches": [
"https://*.google.com/*",
"*://*.chromium.org/*",
```
* –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ —è–∫ –ø–æ—Ä–æ–∂–Ω—î: **`"externally_connectable": {}`**, –∂–æ–¥–µ–Ω –¥–æ–¥–∞—Ç–æ–∫ –∞–±–æ –≤–µ–± –Ω–µ –∑–º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è.

–ß–∏–º **–º–µ–Ω—à–µ —Ä–æ–∑—à–∏—Ä–µ–Ω—å —ñ URL-–∞–¥—Ä–µ—Å** –≤–∫–∞–∑–∞–Ω–æ —Ç—É—Ç, —Ç–∏–º **–º–µ–Ω—à–∞ –ø–ª–æ—â–∞ –∞—Ç–∞–∫–∏** –±—É–¥–µ.

{% hint style="danger" %}
–Ø–∫—â–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ **–≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ XSS –∞–±–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è** –≤–∫–∞–∑–∞–Ω–∞ –≤ **`externally_connectable`**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞**, –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–±—Ö–æ–¥—è—á–∏ –ö–æ–Ω—Ç–µ–Ω—Ç–Ω–∏–π —Å–∫—Ä–∏–ø—Ç —ñ –π–æ–≥–æ CSP.

–û—Ç–∂–µ, —Ü–µ **–¥—É–∂–µ –ø–æ—Ç—É–∂–Ω–∏–π –æ–±—Ö—ñ–¥**.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ –∫–ª—ñ—î–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à–∫—ñ–¥–ª–∏–≤–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –π–æ–º—É –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω–æ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –≤—Ä–∞–∑–ª–∏–≤–∏–º —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º, –≤–æ–Ω–æ –º–æ–∂–µ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ **XSS –¥–∞–Ω—ñ –Ω–∞ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ–π –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** –∞–±–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ **`WebRequest`** –∞–±–æ **`DeclarativeNetRequest`** API –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó –∑–∞–ø–∏—Ç–∞–º–∏ –Ω–∞ —Ü—ñ–ª—å–æ–≤–æ–º—É –¥–æ–º–µ–Ω—ñ, –∑–º—ñ–Ω—é—é—á–∏ –∑–∞–ø–∏—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–∞ **—Ñ–∞–π–ª JavaScript**. (–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ CSP –Ω–∞ —Ü—ñ–ª—å–æ–≤—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –º–æ–∂–µ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ü–∏–º –∞—Ç–∞–∫–∞–º). –¶—è —ñ–¥–µ—è –ø–æ—Ö–æ–¥–∏—Ç—å [**–∑ —Ü—å–æ–≥–æ –æ–ø–∏—Å—É**](https://www.darkrelay.com/post/opera-zero-day-rce-vulnerability).
{% endhint %}

## –ü—ñ–¥—Å—É–º–æ–∫ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó

### –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è <--> –í–µ–±-–¥–æ–¥–∞—Ç–æ–∫

–î–ª—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –º—ñ–∂ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º —ñ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–æ—é –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –¢–æ–º—É –≤ –≤–µ–±-–¥–æ–¥–∞—Ç–∫—É –≤–∏ –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞–π–¥–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∏ —Ñ—É–Ω–∫—Ü—ñ—ó **`window.postMessage`** —ñ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–º—É —Å–∫—Ä–∏–ø—Ç—ñ —Å–ª—É—Ö–∞—á—ñ, —Ç–∞–∫—ñ —è–∫ **`window.addEventListener`**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞–∫–æ–∂ –º–æ–∂–µ **—Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–æ–º, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ Post Message** (—ñ —Ç–æ–º—É –≤–µ–± –ø–æ–≤–∏–Ω–µ–Ω —Ü–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏) –∞–±–æ –ø—Ä–æ—Å—Ç–æ –∑–º—É—Å–∏—Ç–∏ –≤–µ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç.

### –í—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

–ó–∞–∑–≤–∏—á–∞–π —Ñ—É–Ω–∫—Ü—ñ—è **`chrome.runtime.sendMessage`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (–∑–∞–∑–≤–∏—á–∞–π –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è `background` —Å–∫—Ä–∏–ø—Ç–æ–º), –∞ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –π–æ–≥–æ –æ–≥–æ–ª–æ—à—É—î—Ç—å—Å—è —Å–ª—É—Ö–∞—á, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î **`chrome.runtime.onMessage.addListener`**.

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`chrome.runtime.connect()`** –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è** —Ç–∞ **–æ—Ç—Ä–∏–º–∞–Ω–Ω—è** **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å**, —è–∫ —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ:

<details>

<summary><code>chrome.runtime.connect()</code> –ø—Ä–∏–∫–ª–∞–¥</summary>
```javascript
var port = chrome.runtime.connect();

// Listen for messages from the web page
window.addEventListener("message", (event) => {
// Only accept messages from the same window
if (event.source !== window) {
return;
}

// Check if the message type is "FROM_PAGE"
if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
// Forward the message to the background script
port.postMessage({ type: 'FROM_PAGE', text: event.data.text });
}
}, false);

// Listen for messages from the background script
port.onMessage.addListener(function(msg) {
console.log("Content script received message from background script:", msg);
// Handle the response message from the background script
});
```
</details>

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–æ–≥–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ–π –≤–∫–ª–∞–¥—Ü—ñ, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ **`chrome.tabs.sendMessage`**, –¥–µ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –≤–∫–∞–∑–∞—Ç–∏ **ID –≤–∫–ª–∞–¥–∫–∏**, –¥–æ —è–∫–æ—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

### –í—ñ–¥ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö `externally_connectable` –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

**–í–µ–±-–¥–æ–¥–∞—Ç–∫–∏ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞, –¥–æ–∑–≤–æ–ª–µ–Ω—ñ** –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó `externally_connectable`, –º–æ–∂—É—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:
```javascript
chrome.runtime.sendMessage(extensionId, ...
```
–î–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–≥–∞–¥–∞—Ç–∏ **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**.

### Native Messaging

–ú–æ–∂–ª–∏–≤–æ, —â–æ —Ñ–æ–Ω–æ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∏ —Å–ø—ñ–ª–∫—É—é—Ç—å—Å—è –∑ –¥–≤—ñ–π–∫–æ–≤–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∏—Å—Ç–µ–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **—Å—Ö–∏–ª—å–Ω—ñ –¥–æ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, —Ç–∞–∫–∏—Ö —è–∫ RCE** —è–∫—â–æ —Ü–µ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –Ω–µ –±—É–¥–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º –∑–∞—Ö–∏—â–µ–Ω–µ. [–ë—ñ–ª—å—à–µ –ø—Ä–æ —Ü–µ –ø—ñ–∑–Ω—ñ—à–µ](./#native-messaging).
```javascript
chrome.runtime.sendNativeMessage(
'com.my_company.my_application',
{text: 'Hello'},
function (response) {
console.log('Received ' + response);
}
);
```
## Web **‚ÜîÔ∏é** –ó–≤'—è–∑–æ–∫ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç—É

–°–µ—Ä–µ–¥–æ–≤–∏—â–∞, –≤ —è–∫–∏—Ö –ø—Ä–∞—Ü—é—é—Ç—å **—Å–∫—Ä–∏–ø—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É**, —ñ –¥–µ —ñ—Å–Ω—É—é—Ç—å —Ö–æ—Å—Ç-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, **–≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω—ñ** –æ–¥–Ω–µ –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î **—ñ–∑–æ–ª—è—Ü—ñ—é**. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ü—é —ñ–∑–æ–ª—è—Ü—ñ—é, –æ–±–∏–¥–≤–∞ –º–æ–∂—É—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ **Document Object Model (DOM)** —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Å–ø—ñ–ª—å–Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–º. –©–æ–± —Ö–æ—Å—Ç-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–æ–≥–ª–∞ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑—ñ **—Å–∫—Ä–∏–ø—Ç–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç—É** –∞–±–æ –Ω–µ–ø—Ä—è–º–æ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **DOM**, –¥–æ—Å—Ç—É–ø–Ω–∏–π –æ–±–æ–º —Å—Ç–æ—Ä–æ–Ω–∞–º, —è–∫ –∫–∞–Ω–∞–ª –∑–≤'—è–∑–∫—É.

### –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ—Å—Ç—ñ–≤

{% code title="content-script.js" %}
```javascript
// This is like "chrome.runtime.sendMessage" but to maintain the connection
var port = chrome.runtime.connect();

window.addEventListener("message", (event) => {
// We only accept messages from ourselves
if (event.source !== window) {
return;
}

if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
// Forward the message to the background script
port.postMessage(event.data.text);
}
}, false);
```
{% endcode %}

{% code title="example.js" %}
```javascript
document.getElementById("theButton").addEventListener("click", () => {
window.postMessage(
{type : "FROM_PAGE", text : "Hello from the webpage!"}, "*");
}, false);
```
{% endcode %}

–ë–µ–∑–ø–µ—á–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è Post Message –ø–æ–≤–∏–Ω–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏:

* **`event.isTrusted`**: –¶–µ True —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –ø–æ–¥—ñ—è –±—É–ª–∞ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ –¥—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* –ö–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–∫–æ–Ω—É—î —è–∫—É—Å—å –¥—ñ—é
* **–¥–æ–º–µ–Ω –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è**: –º–æ–∂–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –∑ –¥–æ–∑–≤–æ–ª–µ–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –¥–æ–º–µ–Ω—ñ–≤.
* –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è regex, –±—É–¥—å—Ç–µ –¥—É–∂–µ –æ–±–µ—Ä–µ–∂–Ω—ñ
* **–î–∂–µ—Ä–µ–ª–æ**: `received_message.source !== window` –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –±—É–ª–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è **–∑ —Ç–æ–≥–æ –∂ –≤—ñ–∫–Ω–∞**, –¥–µ —Å–ª—É—Ö–∞—î –ö–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç.

–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏, —Ç–æ–º—É –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –æ–±—Ö–æ–¥–∏ Post Message**:

{% content-ref url="../postmessage-vulnerabilities/" %}
[postmessage-vulnerabilities](../postmessage-vulnerabilities/)
{% endcontent-ref %}

### Iframe

–©–µ –æ–¥–∏–Ω –º–æ–∂–ª–∏–≤–∏–π —Å–ø–æ—Å—ñ–± –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –º–æ–∂–µ –±—É—Ç–∏ —á–µ—Ä–µ–∑ **Iframe URLs**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —É:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

### DOM

–¶–µ –Ω–µ "—Ç–æ—á–Ω–æ" —Å–ø–æ—Å—ñ–± –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó, –∞–ª–µ **–≤–µ–± —ñ –∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç –º–∞—Ç–∏–º—É—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–± DOM**. –¢–æ–º—É, —è–∫—â–æ **–∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç** —á–∏—Ç–∞—î —è–∫—É—Å—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –Ω—å–æ–≥–æ, **–¥–æ–≤—ñ—Ä—è—é—á–∏ –≤–µ–± DOM**, –≤–µ–± –º–æ–∂–µ **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ü—ñ –¥–∞–Ω—ñ** (—Ç–æ–º—É —â–æ –≤–µ–± –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –¥–æ–≤—ñ—Ä–µ–Ω–∏–º, –∞–±–æ —Ç–æ–º—É —â–æ –≤–µ–± –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ XSS) —ñ **—Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –ö–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç**.

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ **DOM-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ XSS –¥–ª—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞** —É:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## –ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è –ö–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç–∞ **‚ÜîÔ∏é** –§–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç

–ö–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó [**runtime.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) **–∞–±–æ** [**tabs.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/tabs#method-sendMessage) –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ **–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ JSON-—Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

–î–ª—è –æ–±—Ä–æ–±–∫–∏ **–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π **Promise**. –•–æ—á–∞, –¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ, –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç–∏ **callback** —è–∫ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∞—Ä–≥—É–º–µ–Ω—Ç.

–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∑–∞–ø–∏—Ç—É –∑ **–∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç–∞** –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```javascript
(async () => {
const response = await chrome.runtime.sendMessage({greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∑–∞–ø–∏—Ç—É –∑ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** (–∑–∞–∑–≤–∏—á–∞–π **—Ñ–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç**). –ü—Ä–∏–∫–ª–∞–¥ —Ç–æ–≥–æ, —è–∫ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç—É —É –≤–∏–±—Ä–∞–Ω—ñ–π –≤–∫–ª–∞–¥—Ü—ñ:
```javascript
// From https://stackoverflow.com/questions/36153999/how-to-send-a-message-between-chrome-extension-popup-and-content-script
(async () => {
const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
–ù–∞ **–ø—Ä–∏–π–º–∞–ª—å–Ω–æ–º—É –±–æ—Ü—ñ** –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ [**runtime.onMessage**](https://developer.chrome.com/docs/extensions/reference/runtime#event-onMessage) **—Å–ª—É—Ö–∞—á–∞ –ø–æ–¥—ñ–π**, —â–æ–± –æ–±—Ä–æ–±–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –¶–µ –≤–∏–≥–ª—è–¥–∞—î –æ–¥–Ω–∞–∫–æ–≤–æ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –∞–±–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
```javascript
// From https://stackoverflow.com/questions/70406787/javascript-send-message-from-content-js-to-background-js
chrome.runtime.onMessage.addListener(
function(request, sender, sendResponse) {
console.log(sender.tab ?
"from a content script:" + sender.tab.url :
"from the extension");
if (request.greeting === "hello")
sendResponse({farewell: "goodbye"});
}
);
```
–í –Ω–∞–≤–µ–¥–µ–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ **`sendResponse()`** –±—É–ª–æ –≤–∏–∫–æ–Ω–∞–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ. –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó `onMessage` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `sendResponse()`, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–æ–¥–∞—Ç–∏ `return true;`.

–í–∞–∂–ª–∏–≤–∏–º –º–æ–º–µ–Ω—Ç–æ–º —î —Ç–µ, —â–æ –≤ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –∫–æ–ª–∏ –∫—ñ–ª—å–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–¥—ñ–π `onMessage`, **–ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞, —è–∫–∞ –≤–∏–∫–æ–Ω–∞—î `sendResponse()`** –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –ø–æ–¥—ñ—ó, –±—É–¥–µ —î–¥–∏–Ω–æ—é, —è–∫–∞ –∑–º–æ–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–æ—Å—Ç–∞–≤–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ë—É–¥—å-—è–∫—ñ –ø–æ–¥–∞–ª—å—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ç—É –∂ –ø–æ–¥—ñ—é –Ω–µ –±—É–¥—É—Ç—å –≤—Ä–∞—Ö–æ–≤–∞–Ω—ñ.

–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å —Å–ª—ñ–¥ –≤—ñ–¥–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤–∞–≥—É –ø—Ä–æ–º—ñ—Å–∞–º, –∞ –Ω–µ –∑–≤–æ—Ä–æ—Ç–Ω–∏–º –≤–∏–∫–ª–∏–∫–∞–º. –©–æ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–≤–æ—Ä–æ—Ç–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤, —Ñ—É–Ω–∫—Ü—ñ—è `sendResponse()` –≤–≤–∞–∂–∞—î—Ç—å—Å—è –¥—ñ–π—Å–Ω–æ—é –ª–∏—à–µ –≤ —Ç–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –∞–±–æ —è–∫—â–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó –≤–∫–∞–∑—É—î –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É –æ–ø–µ—Ä–∞—Ü—ñ—é, –ø–æ–≤–µ—Ä—Ç–∞—é—á–∏ `true`. –Ø–∫—â–æ –∂–æ–¥–µ–Ω –∑ –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î `true` –∞–±–æ —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è `sendResponse()` –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è –∑ –ø–∞–º'—è—Ç—ñ (–∑–±–∏—Ä–∞—î—Ç—å—Å—è —Å–º—ñ—Ç—Ç—è), –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é `sendMessage()`, –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∏–π –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.

## Native Messaging

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ **–±—ñ–Ω–∞—Ä–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –≤ —Å–∏—Å—Ç–µ–º—ñ —á–µ—Ä–µ–∑ stdin**. –î–æ–¥–∞—Ç–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ json, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ü–µ, —É —Ñ–æ—Ä–º–∞—Ç—ñ json, —è–∫:
```json
{
"name": "com.my_company.my_application",
"description": "My Application",
"path": "C:\\Program Files\\My Application\\chrome_native_messaging_host.exe",
"type": "stdio",
"allowed_origins": ["chrome-extension://knldjmfmopnpolahpmmgbagdohdnhkik/"]
}
```
–î–µ `name` - —Ü–µ —Ä—è–¥–æ–∫, –ø–µ—Ä–µ–¥–∞–Ω–∏–π –¥–æ [`runtime.connectNative()`](https://developer.chrome.com/docs/extensions/reference/api/runtime#method-connectNative) –∞–±–æ [`runtime.sendNativeMessage()`](https://developer.chrome.com/docs/extensions/reference/api/runtime#method-sendNativeMessage) –¥–ª—è –∑–≤'—è–∑–∫—É –∑ –¥–æ–¥–∞—Ç–∫–æ–º –∑ —Ñ–æ–Ω–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞. `path` - —Ü–µ —à–ª—è—Ö –¥–æ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É, —î –ª–∏—à–µ 1 –¥—ñ–π—Å–Ω–∏–π `type`, —è–∫–∏–π —î stdio (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ stdin —ñ stdout), –∞ `allowed_origins` –≤–∫–∞–∑—É—î –Ω–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ (—ñ –Ω–µ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ —Å–∏–º–≤–æ–ª–∏ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏).

Chrome/Chromium –±—É–¥–µ —à—É–∫–∞—Ç–∏ —Ü–µ–π json —É –¥–µ—è–∫–∏—Ö —Ä–µ—î—Å—Ç—Ä–∞—Ö Windows —Ç–∞ –¥–µ—è–∫–∏—Ö —à–ª—è—Ö–∞—Ö —É macOS —ñ Linux (–±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ [**–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó**](https://developer.chrome.com/docs/extensions/develop/concepts/native-messaging)).

{% hint style="success" %}
–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä–µ–±—É—î –¥–æ–∑–≤–æ–ª—É `nativeMessaing`, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è.
{% endhint %}

–û—Å—å —è–∫ –≤–∏–≥–ª—è–¥–∞—î –∫–æ–¥ –¥–µ—è–∫–æ–≥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞, —â–æ –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ —Ä—ñ–¥–Ω–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É:
```javascript
chrome.runtime.sendNativeMessage(
'com.my_company.my_application',
{text: 'Hello'},
function (response) {
console.log('Received ' + response);
}
);
```
–£ [**—Ü—å–æ–º—É –±–ª–æ–∑—ñ**](https://spaceraccoon.dev/universal-code-execution-browser-extensions/) –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è –≤—Ä–∞–∑–ª–∏–≤–∏–π —à–∞–±–ª–æ–Ω, —â–æ –∑–ª–æ–≤–∂–∏–≤–∞—î —Ä—ñ–¥–Ω–∏–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏:

1. –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–∞—î —à–∞–±–ª–æ–Ω –∑ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ—é –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.
2. –ö–æ–Ω—Ç–µ–Ω—Ç–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–¥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `postMessage` –¥–æ —Ñ–æ–Ω–æ–≤–æ—ó —Å–∫—Ä–∏–ø—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `sendMessage`.
3. –§–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–¥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ —Ä—ñ–¥–Ω–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `sendNativeMessage`.
4. –†—ñ–¥–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ–±—Ä–æ–±–ª—è—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É.

–Ü –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω—å–æ–≥–æ –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è –ø—Ä–∏–∫–ª–∞–¥ **–ø–µ—Ä–µ—Ö–æ–¥—É –∑ –±—É–¥—å-—è–∫–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–æ RCE, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º –±—Ä–∞—É–∑–µ—Ä–∞**.

## –ß—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤ –ø–∞–º'—è—Ç—ñ/–∫–æ–¥—ñ/–±—É—Ñ–µ—Ä—ñ –æ–±–º—ñ–Ω—É

–Ø–∫—â–æ –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ë—Ä–∞—É–∑–µ—Ä–∞ –∑–±–µ—Ä—ñ–≥–∞—î **—á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤ —Å–≤–æ—ó–π –ø–∞–º'—è—Ç—ñ**, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **–≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ** (–æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ –º–∞—à–∏–Ω–∞—Ö Windows) —ñ **–ø–æ—à—É–∫–∞–Ω–æ** –¥–ª—è —Ü—ñ—î—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–û—Ç–∂–µ, –ø–∞–º'—è—Ç—å –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ë—Ä–∞—É–∑–µ—Ä–∞ **–Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –≤–≤–∞–∂–∞—Ç–∏—Å—è –±–µ–∑–ø–µ—á–Ω–æ—é**, —ñ **—á—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**, —Ç–∞–∫–∞ —è–∫ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞–±–æ –º–Ω–µ–º–æ–Ω—ñ—á–Ω—ñ —Ñ—Ä–∞–∑–∏, **–Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è**.

–ó–≤–∏—á–∞–π–Ω–æ, –Ω–µ **–≤—Å—Ç–∞–≤–ª—è–π—Ç–µ —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤ –∫–æ–¥**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –±—É–¥–µ **–ø—É–±–ª—ñ—á–Ω–æ—é**.

–©–æ–± –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–∞–º'—è—Ç—å –∑ –±—Ä–∞—É–∑–µ—Ä–∞, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–∞–º'—è—Ç—å –ø—Ä–æ—Ü–µ—Å—É** –∞–±–æ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å** —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ **`–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–ø–ª–∏–≤–∞—é—á–µ –≤—ñ–∫–Ω–æ`** -> –£ —Ä–æ–∑–¥—ñ–ª—ñ **`–ü–∞–º'—è—Ç—å`** -> **`–ó—Ä–æ–±–∏—Ç–∏ –∑–Ω—ñ–º–æ–∫`** —ñ **`CTRL+F`** –¥–ª—è –ø–æ—à—É–∫—É —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ –∑–Ω—ñ–º–∫—É.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ —á—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, —Ç–∞–∫–∞ —è–∫ –º–Ω–µ–º–æ–Ω—ñ—á–Ω—ñ –∫–ª—é—á—ñ –∞–±–æ –ø–∞—Ä–æ–ª—ñ, **–Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –¥–æ–∑–≤–æ–ª—è—Ç–∏—Å—è –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É** (–∞–±–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –≤–∏–¥–∞–ª—è—Ç–∏ —ó—ó –∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º—ñ–Ω—É —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥), –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–æ–¥—ñ –ø—Ä–æ—Ü–µ—Å–∏, —â–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É, –∑–º–æ–∂—É—Ç—å —ó—Ö –æ—Ç—Ä–∏–º–∞—Ç–∏.

## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤ –±—Ä–∞—É–∑–µ—Ä—ñ

1. **–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ** –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ë—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ —Ä–æ–∑–ø–∞–∫—É–π—Ç–µ –π–æ–≥–æ.
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`chrome://extensions/`** —ñ **—É–≤—ñ–º–∫–Ω—ñ—Ç—å** `–†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞`.
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **`–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–µ`**.

–£ **Firefox** –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`about:debugging#/runtime/this-firefox`** —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **`–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–µ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è`**.

## –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É –∑ –º–∞–≥–∞–∑–∏–Ω—É

–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä—ñ–∑–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ –¥–µ—Ç–∞–ª—å–Ω—ñ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∞—Ä—ñ–∞–Ω—Ç—É.

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —è–∫ ZIP —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫

–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫ ZIP-—Ñ–∞–π–ª, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫. –¶–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `curl` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è ZIP-—Ñ–∞–π–ª—É –∑ –ø–µ–≤–Ω–æ–≥–æ URL-–∞–¥—Ä–µ—Å–∏, –∞ –ø–æ—Ç—ñ–º –≤–∏—Ç—è–≥–Ω–µ–Ω–Ω—è –≤–º—ñ—Å—Ç—É ZIP-—Ñ–∞–π–ª—É –≤ –∫–∞—Ç–∞–ª–æ–≥. –û—Å—å –∫—Ä–æ–∫–∏:

1. –ó–∞–º—ñ–Ω—ñ—Ç—å `"extension_id"` –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π ID —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
2. –í–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:
```bash
extension_id=your_extension_id   # Replace with the actual extension ID
curl -L -o "$extension_id.zip" "https://clients2.google.com/service/update2/crx?response=redirect&os=mac&arch=x86-64&nacl_arch=x86-64&prod=chromecrx&prodchannel=stable&prodversion=44.0.2403.130&x=id%3D$extension_id%26uc"
unzip -d "$extension_id-source" "$extension_id.zip"
```
### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å–∞–π—Ç CRX Viewer

[https://robwu.nl/crxviewer/](https://robwu.nl/crxviewer/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è CRX Viewer

–©–µ –æ–¥–∏–Ω –∑—Ä—É—á–Ω–∏–π –º–µ—Ç–æ–¥ - —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Chrome Extension Source Viewer, —è–∫–∏–π —î –ø—Ä–æ–µ–∫—Ç–æ–º –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º. –ô–æ–≥–æ –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑ [Chrome Web Store](https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin?hl=en). –ö–æ–¥ –¥–∂–µ—Ä–µ–ª–∞ –ø–µ—Ä–µ–≥–ª—è–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–Ω–∏–π —É –π–æ–≥–æ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó GitHub](https://github.com/Rob--W/crxviewer).

### –ü–µ—Ä–µ–≥–ª—è–¥ –∫–æ–¥—É –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏. –û—Å—å —è–∫:

1. –î–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é Chrome, –≤—ñ–¥–≤—ñ–¥–∞–≤—à–∏ `chrome://version/` —ñ –∑–Ω–∞–π–¥—ñ—Ç—å –ø–æ–ª–µ "Profile Path".
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –ø—ñ–¥–ø–∞–ø–∫–∏ `Extensions/` —É –∫–∞—Ç–∞–ª–æ–∑—ñ –ø—Ä–æ—Ñ—ñ–ª—é.
3. –¶—è –ø–∞–ø–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–∑–≤–∏—á–∞–π –∑ —ó—Ö–Ω—ñ–º –∫–æ–¥–æ–º —É —á–∏—Ç–∞–±–µ–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.

–©–æ–± —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—ñ—Å—Ç–∞–≤–∏—Ç–∏ —ó—Ö–Ω—ñ ID –∑ —ñ–º–µ–Ω–∞–º–∏:

* –£–≤—ñ–º–∫–Ω—ñ—Ç—å —Ä–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ `about:extensions`, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ ID –∫–æ–∂–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –£ –∫–æ–∂–Ω—ñ–π –ø–∞–ø—Ü—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª `manifest.json` –º—ñ—Å—Ç–∏—Ç—å —á–∏—Ç–∞–±–µ–ª—å–Ω–µ –ø–æ–ª–µ `name`, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞—Ä—Ö—ñ–≤–∞—Ç–æ—Ä –∞–±–æ —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—á —Ñ–∞–π–ª—ñ–≤

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Chrome Web Store —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –§–∞–π–ª –º–∞—Ç–∏–º–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è `.crx`. –ó–º—ñ–Ω—ñ—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑ `.crx` –Ω–∞ `.zip`. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –±—É–¥—å-—è–∫–∏–π –∞—Ä—Ö—ñ–≤–∞—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, WinRAR, 7-Zip —Ç–æ—â–æ), —â–æ–± –≤–∏—Ç—è–≥—Ç–∏ –≤–º—ñ—Å—Ç ZIP-—Ñ–∞–π–ª—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –≤ Chrome

–í—ñ–¥–∫—Ä–∏–π—Ç–µ Chrome —ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ `chrome://extensions/`. –£–≤—ñ–º–∫–Ω—ñ—Ç—å "–†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞" —É –≤–µ—Ä—Ö–Ω—å–æ–º—É –ø—Ä–∞–≤–æ–º—É –∫—É—Ç—ñ. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è...". –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –¶–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∫–æ–¥ –¥–∂–µ—Ä–µ–ª–∞, –∞–ª–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–¥—É –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –∞–±–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

## –ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω—å Chrome

–©–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏—è–≤–∏—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ –±—Ä–∞—É–∑–µ—Ä–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [https://github.com/palant/chrome-extension-manifests-dataset](https://github.com/palant/chrome-extension-manifests-dataset) —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—Ö–Ω—ñ —Ñ–∞–π–ª–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤ –Ω–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ –æ–∑–Ω–∞–∫–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑ –±—ñ–ª—å—à –Ω—ñ–∂ 25000 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, `content_scripts` —Ç–∞ –¥–æ–∑–≤–æ–ª–æ–º `nativeMessaing`:

{% code overflow="wrap" %}
```bash
# Query example from https://spaceraccoon.dev/universal-code-execution-browser-extensions/
node query.js -f "metadata.user_count > 250000" "manifest.content_scripts?.length > 0 && manifest.permissions?.includes('nativeMessaging')"
```
{% endcode %}

## –ü–µ—Ä–µ–≤—ñ—Ä–æ—á–Ω–∏–π —Å–ø–∏—Å–æ–∫ –±–µ–∑–ø–µ–∫–∏

–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –±—Ä–∞—É–∑–µ—Ä–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–∞—é—Ç—å **–æ–±–º–µ–∂–µ–Ω—É –ø–ª–æ—â—É –∞—Ç–∞–∫–∏**, –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ** –∞–±–æ **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏**. –ù–∞–π–±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω—ñ –∑ –Ω–∏—Ö:

* [ ] **–û–±–º–µ–∂–∏—Ç–∏** –∑–∞–ø–∏—Ç—É–≤–∞–Ω—ñ **`permissions`** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ
* [ ] **–û–±–º–µ–∂–∏—Ç–∏** **`host_permissions`** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ
* [ ] –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **—Å–∏–ª—å–Ω—É** **`content_security_policy`**
* [ ] **–û–±–º–µ–∂–∏—Ç–∏** **`externally_connectable`** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ, —è–∫—â–æ —Ü–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ –º–æ–∂–ª–∏–≤–æ, –Ω–µ –∑–∞–ª–∏—à–∞–π—Ç–µ –π–æ–≥–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –≤–∫–∞–∂—ñ—Ç—å **`{}`**
* [ ] –Ø–∫—â–æ —Ç—É—Ç –∑–≥–∞–¥—É—î—Ç—å—Å—è **URL, –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ XSS –∞–±–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ —Ñ–æ–Ω–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤**. –î—É–∂–µ –ø–æ—Ç—É–∂–Ω–∏–π –æ–±—Ö—ñ–¥.
* [ ] **–û–±–º–µ–∂–∏—Ç–∏** **`web_accessible_resources`** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ, –Ω–∞–≤—ñ—Ç—å –ø–æ—Ä–æ–∂–Ω—ñ, —è–∫—â–æ –º–æ–∂–ª–∏–≤–æ.
* [ ] –Ø–∫—â–æ **`web_accessible_resources`** –Ω–µ –ø–æ—Ä–æ–∂–Ω—î, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ [**ClickJacking**](browext-clickjacking.md)
* [ ] –Ø–∫—â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –±—É–¥—å-—è–∫–∞ **–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è** –∑ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** –¥–æ **–≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏**, [**–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ XSS**](browext-xss-example.md) **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ**, –≤–∏–∫–ª–∏–∫–∞–Ω—ñ –≤ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó.
* [ ] –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è Post, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ [**–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ Post Message**](../postmessage-vulnerabilities/)**.**
* [ ] –Ø–∫—â–æ **Content Script –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—Ç–∞–ª–µ–π DOM**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –≤–æ–Ω–∏ **–Ω–µ –≤–≤–æ–¥—è—Ç—å XSS**, —è–∫—â–æ —ó—Ö **–º–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å** –≤–µ–±
* [ ] –ó—Ä–æ–±—ñ—Ç—å –æ—Å–æ–±–ª–∏–≤–∏–π –∞–∫—Ü–µ–Ω—Ç, —è–∫—â–æ —Ü—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è —Ç–∞–∫–æ–∂ –∑–∞–ª—É—á–µ–Ω–∞ –≤ **–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é Content Script -> Background script**
* [ ] –Ø–∫—â–æ —Ñ–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ **native messaging**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è —î –±–µ–∑–ø–µ—á–Ω–æ—é —Ç–∞ –æ—á–∏—â–µ–Ω–æ—é
* [ ] **–ß—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–µ —Å–ª—ñ–¥ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–¥—É –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
* [ ] **–ß—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–µ —Å–ª—ñ–¥ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–∞–º'—è—Ç—ñ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
* [ ] **–ß—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–µ —Å–ª—ñ–¥ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **—Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑ –∑–∞—Ö–∏—Å—Ç—É**

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

### [**Tarnish**](https://thehackerblog.com/tarnish/)

* –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –±—É–¥—å-—è–∫–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –∑ –Ω–∞–¥–∞–Ω–æ–≥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤–µ–±-–º–∞–≥–∞–∑–∏–Ω Chrome.
* [**manifest.json**](https://developer.chrome.com/extensions/manifest) **–ø–µ—Ä–µ–≥–ª—è–¥–∞—á**: –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–µ—Ä—Å—ñ—é JSON –∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è–º –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ê–Ω–∞–ª—ñ–∑ –≤—ñ–¥–±–∏—Ç–∫—ñ–≤**: –í–∏—è–≤–ª–µ–Ω–Ω—è [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è JavaScript –¥–ª—è –≤—ñ–¥–±–∏—Ç–∫—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome.
* **–ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ Clickjacking**: –í–∏—è–≤–ª–µ–Ω–Ω—è HTML-—Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ—é –¥–∏—Ä–µ–∫—Ç–∏–≤–æ—é [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources). –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ clickjacking –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –º–µ—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫.
* **–ü–µ—Ä–µ–≥–ª—è–¥–∞—á –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –ø—Ä–æ –¥–æ–∑–≤–æ–ª–∏**: —è–∫–∏–π –ø–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –ø—Ä–æ –∑–∞–ø–∏—Ç–∏ –¥–æ–∑–≤–æ–ª—ñ–≤ Chrome, —è–∫—ñ –±—É–¥—É—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ù–µ–±–µ–∑–ø–µ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**: –ø–æ–∫–∞–∑—É—î –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ innerHTML, chrome.tabs.executeScript).
* **–¢–æ—á–∫–∏ –≤—Ö–æ–¥—É**: –ø–æ–∫–∞–∑—É—î, –¥–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/–∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∂–µ—Ä–µ–ª. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø–ª–æ—â—ñ –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –ø–æ—à—É–∫—É –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö —Ç–æ—á–æ–∫ –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –Ø–∫ —Å–∫–∞–Ω–µ—Ä–∏ –ù–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —Ç–∞–∫ —ñ –¢–æ—á–æ–∫ –≤—Ö–æ–¥—É –º–∞—é—Ç—å –Ω–∞—Å—Ç—É–ø–Ω–µ –¥–ª—è —Å–≤–æ—ó—Ö –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö —Å–ø–æ–≤—ñ—â–µ–Ω—å:
* –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É —Ç–∞ —Ä—è–¥–æ–∫, —â–æ –≤–∏–∫–ª–∏–∫–∞–≤ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.
* –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏.
* –ö–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ñ–∞–π–ª" –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–æ–≤–Ω–æ–≥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–¥.
* –®–ª—è—Ö –¥–æ —Å–ø–æ–≤—ñ—â–µ–Ω–æ–≥–æ —Ñ–∞–π–ª—É.
* –ü–æ–≤–Ω–∏–π URI —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome —Å–ø–æ–≤—ñ—â–µ–Ω–æ–≥–æ —Ñ–∞–π–ª—É.
* –¢–∏–ø —Ñ–∞–π–ª—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∫—Ä–∏–ø—Ç —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É, –±—Ä–∞—É–∑–µ—Ä–Ω–∞ –¥—ñ—è —Ç–æ—â–æ.
* –Ø–∫—â–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π —Ä—è–¥–æ–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ JavaScript-—Ñ–∞–π–ª—ñ, —à–ª—è—Ö–∏ –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫, –¥–µ –≤—ñ–Ω –≤–∫–ª—é—á–µ–Ω–∏–π, –∞ —Ç–∞–∫–æ–∂ —Ç–∏–ø —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —ñ —Å—Ç–∞—Ç—É—Å [web\_accessible\_resource](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources).
* **–ê–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É (CSP) —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±—Ö–æ–¥—É**: –¶–µ –≤–∫–∞–∑—É—î –Ω–∞ —Å–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è –≤ CSP –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ —Ç–∞–∫–æ–∂ –≤–∏—è–≤–ª—è—î –±—É–¥—å-—è–∫—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –æ–±—ñ–π—Ç–∏ –≤–∞—à CSP —á–µ—Ä–µ–∑ –±—ñ–ª–∏–π —Å–ø–∏—Å–æ–∫ CDN —Ç–æ—â–æ.
* **–í—ñ–¥–æ–º—ñ –≤—Ä–∞–∑–ª–∏–≤—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏**: –¶–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [Retire.js](https://retirejs.github.io/retire.js/) –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–∏—Ö JavaScript-–±—ñ–±–ª—ñ–æ—Ç–µ–∫.
* –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –≤–µ—Ä—Å—ñ—ó.
* –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–∫—Ä–∞—â–µ–Ω—É –≤–µ—Ä—Å—ñ—é —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (–∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π HTML —Ç–∞ JavaScript).
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, –∑–∞–ø—É—Å–∫ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑–∞–π–º–µ –ø–µ–≤–Ω–∏–π —á–∞—Å –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É. –û–¥–Ω–∞–∫, –ø—Ä–∏ –¥—Ä—É–≥–æ–º—É –∑–∞–ø—É—Å–∫—É, —è–∫—â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–µ –±—É–ª–æ –æ–Ω–æ–≤–ª–µ–Ω–æ, —Ü–µ –±—É–¥–µ –º–∞–π–∂–µ –º–∏—Ç—Ç—î–≤–æ —á–µ—Ä–µ–∑ –∫–µ—à–æ–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.
* –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ URL –∑–≤—ñ—Ç—ñ–≤, –ª–µ–≥–∫–æ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –∫–∏–º–æ—Å—å —ñ–Ω—à–∏–º –∑–≤—ñ—Ç–æ–º –ø—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–º tarnish.

### [Neto](https://github.com/elevenpaths/neto)

–ü—Ä–æ–µ–∫—Ç Neto - —Ü–µ –ø–∞–∫–µ—Ç Python 3, –∑–∞–¥—É–º–∞–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –ø–ª–∞–≥—ñ–Ω—ñ–≤ —ñ —Ä–æ–∑—à–∏—Ä–µ–Ω—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –≤—ñ–¥–æ–º–∏—Ö –±—Ä–∞—É–∑–µ—Ä—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Firefox —ñ Chrome. –í—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î –ø—Ä–æ—Ü–µ—Å —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è —É–ø–∞–∫–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –¥–ª—è –≤–∏–ª—É—á–µ–Ω–Ω—è —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ, —Ç–∞–∫–∏—Ö —è–∫ `manifest.json`, –ø–∞–ø–∫–∏ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó –∞–±–æ –≤–∏—Ö—ñ–¥–Ω—ñ —Ñ–∞–π–ª–∏ Javascript —ñ HTML.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* **–î—è–∫—É—î–º–æ** [**@naivenom**](https://twitter.com/naivenom) **–∑–∞ –¥–æ–ø–æ–º–æ–≥—É –∑ —Ü—ñ—î—é –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—î—é**
* [https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing](https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing)
* [https://palant.info/2022/08/10/anatomy-of-a-basic-extension/](https://palant.info/2022/08/10/anatomy-of-a-basic-extension/)
* [https://palant.info/2022/08/24/attack-surface-of-extension-pages/](https://palant.info/2022/08/24/attack-surface-of-extension-pages/)
* [https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/](https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/)
* [https://help.passbolt.com/assets/files/PBL-02-report.pdf](https://help.passbolt.com/assets/files/PBL-02-report.pdf)
* [https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts](https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts)
* [https://developer.chrome.com/docs/extensions/mv2/background-pages](https://developer.chrome.com/docs/extensions/mv2/background-pages)
* [https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/](https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/)
* [https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0](https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
