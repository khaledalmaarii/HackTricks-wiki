# BrowExt - ClickJacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmaya Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **ğŸ’¬ [Discord grubumuza](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [telegram grubumuza](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

Bu sayfa, bir TarayÄ±cÄ± eklentisindeki ClickJacking zafiyetini kÃ¶tÃ¼ye kullanacaktÄ±r.\
ClickJacking nedir bilmiyorsanÄ±z ÅŸuraya bakÄ±n:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

UzantÄ±lar **`manifest.json`** dosyasÄ±nÄ± iÃ§erir ve bu JSON dosyasÄ±nda bir `web_accessible_resources` alanÄ± bulunmaktadÄ±r. [Chrome belgelerinde](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) ÅŸÃ¶yle denir:

> Bu kaynaklar daha sonra **`chrome-extension://[PAKET ID]/[YOL]`** URL'si aracÄ±lÄ±ÄŸÄ±yla bir web sayfasÄ±nda kullanÄ±labilir, bu URL **`extension.getURL yÃ¶ntemi`** ile oluÅŸturulabilir. Ä°zin verilen kaynaklar uygun CORS baÅŸlÄ±klarÄ± ile sunulur, bu nedenle XHR gibi mekanizmalar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir.[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

TarayÄ±cÄ± uzantÄ±sÄ±ndaki **`web_accessible_resources`**, sadece web aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir deÄŸildir; aynÄ± zamanda uzantÄ±nÄ±n doÄŸal ayrÄ±calÄ±klarÄ±yla Ã§alÄ±ÅŸÄ±r. Bu, ÅŸunlarÄ± yapabilme yeteneÄŸine sahiptir:

* UzantÄ±nÄ±n durumunu deÄŸiÅŸtirebilme
* Ek kaynaklar yÃ¼kleme
* TarayÄ±cÄ±yla belirli bir dÃ¼zeyde etkileÅŸimde bulunma

Ancak, bu Ã¶zellik bir gÃ¼venlik riski oluÅŸturur. EÄŸer **`web_accessible_resources`** iÃ§indeki bir kaynak Ã¶nemli bir iÅŸlevselliÄŸe sahipse, bir saldÄ±rgan bu kaynaÄŸÄ± potansiyel olarak harici bir web sayfasÄ±na gÃ¶mebilir. Bu sayfayÄ± ziyaret eden ÅŸÃ¼phesiz kullanÄ±cÄ±lar, bu gÃ¶mÃ¼lÃ¼ kaynaÄŸÄ± yanlÄ±ÅŸlÄ±kla etkinleÅŸtirebilirler. Bu etkinleÅŸtirme, uzantÄ±nÄ±n kaynaklarÄ±nÄ±n izinlerine ve yeteneklerine baÄŸlÄ± olarak istenmeyen sonuÃ§lara yol aÃ§abilir.

## PrivacyBadger Ã–rneÄŸi

PrivacyBadger uzantÄ±sÄ±nda, `skin/` dizini, aÅŸaÄŸÄ±daki ÅŸekilde `web_accessible_resources` olarak ilan edilen bir zafiyet tespit edildi (Orijinal [blog yazÄ±sÄ±na](https://blog.lizzie.io/clickjacking-privacy-badger.html) bakÄ±n):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
Bu yapÄ±landÄ±rma potansiyel bir gÃ¼venlik sorununa yol aÃ§tÄ±. Ã–zellikle tarayÄ±cÄ±da GizlilikKartalÄ± simgesine tÄ±klama sonucu oluÅŸturulan `skin/popup.html` dosyasÄ±, bir `iframe` iÃ§ine yerleÅŸtirilebilirdi. Bu yerleÅŸtirme, kullanÄ±cÄ±larÄ± yanÄ±ltmak ve yanlÄ±ÅŸlÄ±kla "Bu Web Sitesi Ä°Ã§in GizlilikKartalÄ±'yÄ± Devre DÄ±ÅŸÄ± BÄ±rak" seÃ§eneÄŸine tÄ±klamalarÄ±nÄ± saÄŸlamak iÃ§in sÃ¶mÃ¼rÃ¼lebilirdi. Bu eylem, GizlilikKartalÄ± korumasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakarak kullanÄ±cÄ±nÄ±n gizliliÄŸini tehlikeye atabilir ve kullanÄ±cÄ±yÄ± artan takibe maruz bÄ±rakabilir. Bu saldÄ±rÄ±nÄ±n gÃ¶rsel bir gÃ¶sterimi, [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) adresinde saÄŸlanan ClickJacking video Ã¶rneÄŸinde gÃ¶rÃ¼lebilir.

Bu zafiyeti ele almak iÃ§in basit bir Ã§Ã¶zÃ¼m uygulandÄ±: `web_accessible_resources` listesinden `/skin/*`'nin kaldÄ±rÄ±lmasÄ±. Bu deÄŸiÅŸiklik, `skin/` dizininin web eriÅŸilebilir kaynaklar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilemeyeceÄŸini veya manipÃ¼le edilemeyeceÄŸini saÄŸlayarak riski etkili bir ÅŸekilde azalttÄ±.

DÃ¼zeltme kolaydÄ±: **`web_accessible_resources` listesinden `/skin/*`'yi kaldÄ±rÄ±n**.

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask Ã–rneÄŸi

[**Metamask'ta bir ClickJacking hakkÄ±nda bir blog yazÄ±sÄ± burada bulunabilir**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). Bu durumda, Metamask, eriÅŸim iÃ§in kullanÄ±lan protokolÃ¼n **`https:`** veya **`http:`** olduÄŸunu kontrol ederek (Ã¶rneÄŸin **`chrome:`** deÄŸil):

<figure><img src="../../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

Metamask uzantÄ±sÄ±nda **baÅŸka bir ClickJacking dÃ¼zeltildi**. KullanÄ±cÄ±lar, sayfanÄ±n **â€œweb_accessible_resourcesâ€: [â€œinpage.jsâ€, â€œphishing.htmlâ€]** nedeniyle dolandÄ±rÄ±cÄ±lÄ±k olabileceÄŸini ÅŸÃ¼pheli bulduÄŸunda **TÄ±klamayla beyaz listeye eklenebiliyordu**. Bu sayfa Clickjacking'e karÅŸÄ± savunmasÄ±z olduÄŸundan, bir saldÄ±rgan, kurbanÄ±n fark etmeden beyaz listeye eklemesini saÄŸlamak iÃ§in normal bir ÅŸey gÃ¶stererek bunu istismar edebilir ve ardÄ±ndan beyaz listeye alÄ±nacak olan dolandÄ±rÄ±cÄ±lÄ±k sayfasÄ±na geri dÃ¶nebilirdi.

## Steam Envanter YardÄ±mcÄ±sÄ± Ã–rneÄŸi

Bir tarayÄ±cÄ± uzantÄ±sÄ±ndaki bir **XSS**'nin bir **ClickJacking** zafiyeti ile nasÄ±l birleÅŸtirildiÄŸini kontrol etmek iÃ§in aÅŸaÄŸÄ±daki sayfaya bakÄ±n:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)
