# BrowExt - izinler ve host\_permissions

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Temel Bilgiler

### **`izinler`**

Ä°zinler, genellikle bir tarayÄ±cÄ±nÄ±n eriÅŸebileceÄŸi hemen hemen her ÅŸeye eriÅŸim saÄŸlayan **`manifest.json`** dosyasÄ±nda tanÄ±mlanÄ±r ve (Ã‡erezler veya Fiziksel Depolama):

Ã–nceki manifest dosyasÄ±, uzantÄ±nÄ±n `storage` iznini gerektirdiÄŸini belirtir. Bu, [depolama API'sini](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) kullanarak verilerini kalÄ±cÄ± olarak depolayabilir. KullanÄ±cÄ±lara belirli bir kontrol seviyesi saÄŸlayan Ã§erezler veya `localStorage` API'lerinin aksine, **uzantÄ± depolamasÄ± genellikle yalnÄ±zca uzantÄ±nÄ±n kaldÄ±rÄ±lmasÄ±yla temizlenebilir**.

Bir uzantÄ±, **`manifest.json`** dosyasÄ±nda belirtilen izinleri isteyecek ve UzantÄ±yÄ± yÃ¼kledikten sonra, tarayÄ±cÄ±nÄ±zda **her zaman izinlerini kontrol edebilirsiniz**, bu resimde gÃ¶sterildiÄŸi gibi:

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

[**Bir Chromium TarayÄ±cÄ± UzantÄ±sÄ±nÄ±n isteyebileceÄŸi izinlerin tam listesini burada bulabilirsiniz**](https://developer.chrome.com/docs/extensions/develop/concepts/declare-permissions#permissions) ve [**Firefox uzantÄ±larÄ± iÃ§in tam liste burada**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#api\_permissions)**.**

### `host_permissions`

Ä°steÄŸe baÄŸlÄ± ancak gÃ¼Ã§lÃ¼ olan **`host_permissions`** ayarÄ±, uzantÄ±nÄ±n [`cookies`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies), [`webRequest`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) ve [`tabs`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) gibi API'ler aracÄ±lÄ±ÄŸÄ±yla etkileÅŸimde bulunabileceÄŸi ana bilgisayarlarÄ± belirtir.

AÅŸaÄŸÄ±daki `host_permissions` temel olarak her web sitesine izin verir:
```json
"host_permissions": [
"*://*/*"
]

// Or:
"host_permissions": [
"http://*/*",
"https://*/*"
]

// Or:
"host_permissions": [
"<all_urls>"
]
```
## `permissions` ve `host_permissions` KÃ¶tÃ¼ye KullanÄ±mÄ±

### Sekmeler

AyrÄ±ca, **`host_permissions`** ayrÄ±ca "geliÅŸmiÅŸ" [**sekme API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) **iÅŸlevselliÄŸini** aÃ§ar. Bu, uzantÄ±nÄ±n [tabs.query()](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/query) Ã§aÄŸrÄ±sÄ±na izin verir ve sadece kullanÄ±cÄ±nÄ±n tarayÄ±cÄ± sekmelerinin bir **listesini almakla kalmaz, aynÄ± zamanda yÃ¼klenen web sayfasÄ±nÄ±n (adres ve baÅŸlÄ±k anlamÄ±na gelen) hangisi olduÄŸunu da Ã¶ÄŸrenir**.

{% hint style="danger" %}
Bununla da kalmaz, [**tabs.onUpdated**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/onUpdated) gibi dinleyiciler de **Ã§ok daha kullanÄ±ÅŸlÄ± hale gelir**. Bunlar, bir sekmede yeni bir sayfa yÃ¼klendiÄŸinde bildirilecektir.
{% endhint %}

### Ä°Ã§erik betiklerinin Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± <a href="#running-content-scripts" id="running-content-scripts"></a>

Ä°Ã§erik betikleri genellikle uzantÄ± manifestosuna statik olarak yazÄ±lmaz. Yeterli **`host_permissions`** verildiÄŸinde, **uzantÄ±lar ayrÄ±ca** [**tabs.executeScript()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript) **veya** [**scripting.executeScript()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/scripting/executeScript) **Ã§aÄŸrÄ±sÄ±nÄ± yaparak bunlarÄ± dinamik olarak yÃ¼kleyebilir**.

Her iki API de, iÃ§erik betikleri olarak uzantÄ±da bulunan dosyalarÄ± deÄŸil, aynÄ± zamanda **keyfi kod**u da yÃ¼rÃ¼tmeye izin verir. Ä°lk API, JavaScript kodunu bir dize olarak iletmeyi saÄŸlarken, ikincisi enjeksiyon gÃ¼venlik aÃ§Ä±klarÄ±na daha az duyarlÄ± olan bir JavaScript iÅŸlevini bekler. Yine de, her iki API de yanlÄ±ÅŸ kullanÄ±ldÄ±ÄŸÄ±nda bÃ¼yÃ¼k zararlara neden olabilir.

{% hint style="danger" %}
YukarÄ±daki yeteneklerin yanÄ± sÄ±ra, iÃ§erik betikleri Ã¶rneÄŸin **kimlik bilgilerini ele geÃ§irebilir** Ã§Ã¼nkÃ¼ bunlar web sayfalarÄ±na girilir. OnlarÄ± kÃ¶tÃ¼ye kullanmanÄ±n klasik yollarÄ±ndan biri de her web sitesine **reklam enjekte etmektir**. Haber sitelerinin gÃ¼venilirliÄŸini kÃ¶tÃ¼ye kullanmak iÃ§in **dolandÄ±rÄ±cÄ±lÄ±k mesajlarÄ± eklemek** de mÃ¼mkÃ¼ndÃ¼r. Son olarak, bankacÄ±lÄ±k web sitelerini **para transferlerini yeniden yÃ¶nlendirmek** iÃ§in manipÃ¼le edebilirler.
{% endhint %}

### DolaylÄ± ayrÄ±calÄ±klar <a href="#implicit-privileges" id="implicit-privileges"></a>

BazÄ± uzantÄ± ayrÄ±calÄ±klarÄ± **aÃ§Ä±kÃ§a bildirilmesi gerekmez**. Bir Ã¶rnek, [sekme API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) dir: temel iÅŸlevselliÄŸine hiÃ§bir ayrÄ±calÄ±k olmadan eriÅŸilebilir. Herhangi bir uzantÄ±, aÃ§tÄ±ÄŸÄ±nÄ±z ve kapattÄ±ÄŸÄ±nÄ±z sekmeler hakkÄ±nda bilgilendirilebilir, ancak bu sekmelerin hangi web sitesine karÅŸÄ±lÄ±k geldiÄŸini bilemez.

Ã‡ok masum gÃ¶rÃ¼nÃ¼yor mu? [tabs.create() API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/create) biraz daha az masumdur. **Yeni bir sekme oluÅŸturmak** iÃ§in kullanÄ±labilir, temelde herhangi bir web sitesi tarafÄ±ndan Ã§aÄŸrÄ±labilen [window.open()](https://developer.mozilla.org/en-US/docs/Web/API/Window/open) ile aynÄ±dÄ±r. Ancak `window.open()` pop-up engeline tabidir, `tabs.create()` deÄŸildir.

{% hint style="danger" %}
Bir uzantÄ± istediÄŸinde her zaman istediÄŸi sayÄ±da sekme oluÅŸturabilir.
{% endhint %}

`tabs.create()` parametrelerini incelediÄŸinizde, yeteneklerinin `window.open()`'in kontrol etmesine izin verilenin Ã§ok Ã¶tesine gittiÄŸini fark edeceksiniz. Ve Firefox, bu API ile `data:` URI'larÄ±n kullanÄ±lmasÄ±na izin vermezken, Chrome'un bÃ¶yle bir korumasÄ± yoktur. **Bu tÃ¼r URI'larÄ±n Ã¼st dÃ¼zeyde kullanÄ±mÄ±** [**dolandÄ±rÄ±cÄ±lÄ±k iÃ§in kÃ¶tÃ¼ye kullanÄ±ldÄ±ÄŸÄ±ndan yasaklanmÄ±ÅŸtÄ±r**](https://bugzilla.mozilla.org/show\_bug.cgi?id=1331351)**.**

[**tabs.update()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/update) `tabs.create()`'e Ã§ok benzer ancak **mevcut bir sekmeyi deÄŸiÅŸtirir**. Bu nedenle, kÃ¶tÃ¼ niyetli bir uzantÄ± Ã¶rneÄŸin rastgele bir reklam sayfasÄ±nÄ± sekmelerinizden birine yÃ¼kleyebilir ve ilgili sekmeyi de etkinleÅŸtirebilir.

### Kamera, coÄŸrafi konum ve arkadaÅŸlar <a href="#webcam-geolocation-and-friends" id="webcam-geolocation-and-friends"></a>

Muhtemelen web sitelerinin Ã¶zel izinler isteyebileceÄŸini biliyorsunuzdur, Ã¶rneÄŸin kameranÄ±za (video konferans araÃ§larÄ±) veya coÄŸrafi konumunuza (haritalar) eriÅŸmek iÃ§in. Bu, kÃ¶tÃ¼ye kullanÄ±m potansiyeli yÃ¼ksek Ã¶zelliklerdir, bu nedenle kullanÄ±cÄ±lar her seferinde bunu hala istediklerine dair onay vermek zorundadÄ±r.

{% hint style="danger" %}
Ancak tarayÄ±cÄ± uzantÄ±larÄ± iÃ§in durum farklÄ±dÄ±r. **TarayÄ±cÄ± uzantÄ±sÄ±** [**kameranÄ±za veya mikrofonunuza eriÅŸmek istiyorsa**](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia)**, sadece bir kez izin istemesi yeterlidir**
{% endhint %}

Genellikle, bir uzantÄ± bunu yÃ¼klendikten hemen sonra yapar. Bu izin verildiÄŸinde, **kamera eriÅŸimi her zaman mÃ¼mkÃ¼ndÃ¼r**, hatta kullanÄ±cÄ± bu noktada uzantÄ±yla etkileÅŸimde deÄŸilse bile. Evet, bir kullanÄ±cÄ± yalnÄ±zca uzantÄ±nÄ±n gerÃ§ekten kamera eriÅŸimine ihtiyaÃ§ duyduÄŸunda bu izni kabul eder. Ancak bundan sonra uzantÄ±nÄ±n gizlice bir ÅŸey kaydetmemesi iÃ§in uzantÄ±ya gÃ¼venmek zorundadÄ±r.

[Tam olarak coÄŸrafi konumunuz](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation) veya [panonuzun iÃ§eriÄŸi](https://developer.mozilla.org/en-US/docs/Web/API/Clipboard\_API) eriÅŸimine, aÃ§Ä±kÃ§a izin verme zorunluluÄŸu yoktur. **Bir uzantÄ± sadece manifestosunun** [**izinler giriÅŸine**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions) **`geolocation` veya `clipboard` ekler**. Bu eriÅŸim ayrÄ±calÄ±klarÄ±, uzantÄ± yÃ¼klendiÄŸinde zÄ±mni olarak verilir. Bu nedenle, bu ayrÄ±calÄ±klara sahip kÃ¶tÃ¼ niyetli veya tehlikeye atÄ±lmÄ±ÅŸ bir uzantÄ±, fark etmeden hareket profilinizi oluÅŸturabilir veya panonuzdaki kopyalanan ÅŸifreleri izleyebilir.

[**history`** anahtarÄ±nÄ± uzantÄ± manifestosunun](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions) **izinler giriÅŸine eklemek**, [**geÃ§miÅŸ API'sine**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history) **eriÅŸim saÄŸlar**. Bu, kullanÄ±cÄ±nÄ±n tÃ¼m gezinme geÃ§miÅŸini beklemeksizin bir seferde almasÄ±na olanak tanÄ±r.

**`bookmarks`** **izin** benzer kÃ¶tÃ¼ye kullanÄ±m potansiyeline sahiptir, bu izin **tÃ¼m yer iÅŸaretlerini** [**yer iÅŸaretleri API'si**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks) **aracÄ±lÄ±ÄŸÄ±yla okumaya izin verir**.

### Depolama izni <a href="#the-storage-permission" id="the-storage-permission"></a>

UzantÄ± depolama alanÄ± yalnÄ±zca bir anahtar-deÄŸer koleksiyonudur, herhangi bir web sitesinin kullanabileceÄŸi [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage) ile Ã§ok benzerdir. Bu nedenle burada hassas bilgiler saklanmamalÄ±dÄ±r.

Ancak, reklam ÅŸirketleri de bu depolamayÄ± kÃ¶tÃ¼ye kullanabilir.

### Daha fazla izin

[**Bir Chromium TarayÄ±cÄ± UzantÄ±sÄ±nÄ±n isteyebileceÄŸi izinlerin tam listesini burada bulabilirsiniz**](https://developer.chrome.com/docs/extensions/develop/concepts/declare-permissions#permissions) ve [**Firefox uzantÄ±larÄ± iÃ§in tam listeyi burada bulabilirsiniz**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#api\_permissions)**.**
## **Referanslar**

* [https://palant.info/2022/08/17/impact-of-extension-privileges/](https://palant.info/2022/08/17/impact-of-extension-privileges/)
* [https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing](https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
