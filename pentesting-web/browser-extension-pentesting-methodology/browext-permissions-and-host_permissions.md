# BrowExt - izinler ve host_permissions

<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'a katÄ±lÄ±n!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

### **`permissions`**

Ä°zinler, uzantÄ±nÄ±n **`manifest.json`** dosyasÄ±nda **`permissions`** Ã¶zelliÄŸi kullanÄ±larak tanÄ±mlanÄ±r ve tarayÄ±cÄ±nÄ±n eriÅŸebileceÄŸi hemen hemen her ÅŸeye (Ã‡erezler veya Fiziksel Depolama) eriÅŸim saÄŸlar:

Ã–nceki manifest, uzantÄ±nÄ±n `storage` iznini gerektirdiÄŸini belirtir. Bu, uzantÄ±nÄ±n verilerini kalÄ±cÄ± olarak depolamak iÃ§in [depola API'sini](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) kullanabileceÄŸi anlamÄ±na gelir. KullanÄ±cÄ±lara bazÄ± dÃ¼zeyde kontrol saÄŸlayan Ã§erezler veya `localStorage` API'lerinin aksine, **uzantÄ± depolamasÄ± genellikle yalnÄ±zca uzantÄ±yÄ± kaldÄ±rarak temizlenebilir**.

Bir uzantÄ±, **`manifest.json`** dosyasÄ±nda belirtilen izinleri isteyecek ve uzantÄ±yÄ± yÃ¼kledikten sonra tarayÄ±cÄ±nÄ±zda izinlerini her zaman kontrol edebilirsiniz, aÅŸaÄŸÄ±daki resimde gÃ¶sterildiÄŸi gibi:

<figure><img src="../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

[**Bir Chromium TarayÄ±cÄ± UzantÄ±sÄ±'nÄ±n isteyebileceÄŸi tam izin listesini burada bulabilirsiniz**](https://developer.chrome.com/docs/extensions/develop/concepts/declare-permissions#permissions) ve [**Firefox uzantÄ±larÄ± iÃ§in tam bir liste burada bulunabilir**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#api_permissions)**.**

### `host_permissions`

Ä°steÄŸe baÄŸlÄ± ancak gÃ¼Ã§lÃ¼ olan **`host_permissions`** ayarÄ±, uzantÄ±nÄ±n [`cookies`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies), [`webRequest`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest) ve [`tabs`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) gibi API'ler aracÄ±lÄ±ÄŸÄ±yla etkileÅŸimde bulunabileceÄŸi ana bilgisayarlarÄ± belirtir.

AÅŸaÄŸÄ±daki `host_permissions` temel olarak her web sitesine izin verir:
```json
"host_permissions": [
"*://*/*"
]

// Or:
"host_permissions": [
"http://*/*",
"https://*/*"
]

// Or:
"host_permissions": [
"<all_urls>"
]
```
Bu, tarayÄ±cÄ± uzantÄ±sÄ±nÄ±n serbestÃ§e eriÅŸebileceÄŸi ana bilgisayarlarÄ± iÃ§erir. Bunun nedeni, bir tarayÄ±cÄ± uzantÄ±sÄ± **`fetch("https://gmail.com/")`** Ã§aÄŸrÄ±sÄ± yaptÄ±ÄŸÄ±nda CORS tarafÄ±ndan kÄ±sÄ±tlanmamasÄ±dÄ±r.

## `permissions` ve `host_permissions` KÃ¶tÃ¼ye Kullanma

### Sekmeler

AyrÄ±ca, **`host_permissions`** "geliÅŸmiÅŸ" [**sekme API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) iÅŸlevselliÄŸini de aÃ§ar. UzantÄ±, [tabs.query()](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/query) Ã§aÄŸrÄ±sÄ± yapabilir ve sadece kullanÄ±cÄ±nÄ±n tarayÄ±cÄ± sekmelerinin bir listesini almakla kalmaz, aynÄ± zamanda yÃ¼klenen web sayfasÄ±nÄ±n (adres ve baÅŸlÄ±k anlamÄ±nda) hangisi olduÄŸunu da Ã¶ÄŸrenebilir.

{% hint style="danger" %}
Bununla birlikte, [**tabs.onUpdated**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/onUpdated) gibi dinleyiciler de daha kullanÄ±ÅŸlÄ± hale gelir. Bunlar, yeni bir sayfa bir sekmeye yÃ¼klendiÄŸinde bildirim alÄ±r.
{% endhint %}

### Ä°Ã§erik betiklerini Ã§alÄ±ÅŸtÄ±rma <a href="#running-content-scripts" id="running-content-scripts"></a>

Ä°Ã§erik betikleri, uzantÄ± manifestosuna statik olarak yazÄ±lmÄ±ÅŸ olmak zorunda deÄŸildir. Yeterli **`host_permissions`** saÄŸlandÄ±ÄŸÄ±nda, uzantÄ±lar [**tabs.executeScript()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript) veya [**scripting.executeScript()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/scripting/executeScript) Ã§aÄŸrÄ±sÄ± yaparak bunlarÄ± dinamik olarak yÃ¼kleyebilir.

Her iki API de, iÃ§erik betikleri olarak uzantÄ±da bulunan dosyalarÄ± deÄŸil, aynÄ± zamanda **keyfi kodu** da yÃ¼rÃ¼tmeye izin verir. Ä°lki, bir JavaScript kodunu bir dize olarak iletmeyi saÄŸlarken, ikincisi enjeksiyon gÃ¼venlik aÃ§Ä±klarÄ±na daha az duyarlÄ± olan bir JavaScript iÅŸlevi bekler. Bununla birlikte, her iki API de yanlÄ±ÅŸ kullanÄ±ldÄ±ÄŸÄ±nda sorunlara neden olabilir.

{% hint style="danger" %}
YukarÄ±daki yeteneklere ek olarak, iÃ§erik betikleri Ã¶rneÄŸin, web sayfalarÄ±na girilen kimlik bilgilerini **ele geÃ§irebilir**. Her bir web sitesine **reklam enjekte edebilir**. Haber sitelerinin gÃ¼venilirliÄŸini kÃ¶tÃ¼ye kullanmak iÃ§in **dolandÄ±rÄ±cÄ±lÄ±k mesajlarÄ± ekleyebilir**. Son olarak, bankacÄ±lÄ±k web sitelerini **para transferlerini yeniden yÃ¶nlendirmek** iÃ§in manipÃ¼le edebilir.
{% endhint %}

### Ä°zinlerin Ä°ma Edilen Yetkileri <a href="#implicit-privileges" id="implicit-privileges"></a>

BazÄ± uzantÄ± yetkileri **aÃ§Ä±kÃ§a bildirilmek zorunda deÄŸildir**. Bir Ã¶rnek, [sekme API'si](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs)dir: temel iÅŸlevselliÄŸi herhangi bir yetkiye ihtiyaÃ§ duymadan eriÅŸilebilir. Herhangi bir uzantÄ±, aÃ§Ä±lan ve kapatÄ±lan sekmeleri bildirebilir, yalnÄ±zca bu sekmelerin hangi web sitesine karÅŸÄ±lÄ±k geldiÄŸini bilemez.

Ã‡ok zararsÄ±z gibi gÃ¶rÃ¼nÃ¼yor mu? [tabs.create() API'si](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/create) biraz daha az zararlÄ±dÄ±r. Herhangi bir web sitesi tarafÄ±ndan Ã§aÄŸrÄ±labilen [window.open()](https://developer.mozilla.org/en-US/docs/Web/API/Window/open) ile aynÄ±dÄ±r. Ancak `window.open()` pop-up engelleyiciye tabi iken, `tabs.create()` deÄŸildir.

{% hint style="danger" %}
Bir uzantÄ± istediÄŸi zaman herhangi bir sayÄ±da sekme oluÅŸturabilir.
{% endhint %}

`tabs.create()` parametrelerini inceleyecek olursanÄ±z, yeteneklerinin `window.open()`'in kontrol etmesine izin verilenin Ã¶tesine gittiÄŸini fark edeceksiniz. Firefox, bu API ile `data:` URI'lerinin kullanÄ±lmasÄ±na izin vermezken, Chrome bÃ¶yle bir korumaya sahip deÄŸildir. **Bu tÃ¼r URI'lerin Ã¼st dÃ¼zeyde kullanÄ±mÄ±**, [**dolandÄ±rÄ±cÄ±lÄ±k iÃ§in kÃ¶tÃ¼ye kullanÄ±ldÄ±ÄŸÄ± iÃ§in yasaklanmÄ±ÅŸtÄ±r**](https://bugzilla.mozilla.org/show_bug.cgi?id=1331351)**.**

[**tabs.update()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/update), `tabs.create()`'e Ã§ok benzer, ancak **mevcut bir sekmeyi deÄŸiÅŸtirir**. Bu nedenle, kÃ¶tÃ¼ niyetli bir uzantÄ± Ã¶rneÄŸin reklam sayfasÄ±nÄ± keyfi olarak bir sekmenize yÃ¼kleyebilir ve ilgili sekmeyi etkinleÅŸtirebilir.

### Web kamerasÄ±, coÄŸrafi konum ve diÄŸerleri <a href="#webcam-geolocation-and-friends" id="webcam-geolocation-and-friends"></a>

Muhtemelen web sitelerinin Ã¶zel izinler isteyebileceÄŸini biliyorsunuzdur, Ã¶rneÄŸin web kamerasÄ±na (video konferans araÃ§larÄ±) veya coÄŸrafi konuma (haritalar) eriÅŸmek iÃ§in. Bu, kÃ¶tÃ¼ye kullanÄ±m potansiyeli yÃ¼ksek Ã¶zelliklerdir, bu nedenle kullanÄ±cÄ±lar her seferinde bunu onaylamak zorundadÄ±r.

{% hint style="danger" %}
Ancak tarayÄ±cÄ± uzantÄ±larÄ± iÃ§in durum bÃ¶yle deÄŸildir. Bir tarayÄ±cÄ± uzantÄ±sÄ± [**web kamerasÄ±na veya mikrofona eriÅŸmek istediÄŸinde**](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia)**, sadece bir kez izin istemesi yeterlidir**
{% endhint %}

Genellikle, bir uzantÄ± bunu yÃ¼klenir yÃ¼klenmez yapar. Bu onay kabul edildikten sonra, **web kamerasÄ±na her zaman eriÅŸim mÃ¼mkÃ¼ndÃ¼r**, hatta kullanÄ±cÄ± bu noktada uzantÄ±yla etkileÅŸimde bulunmuyorsa bile. Evet, bir kullanÄ±cÄ± uzantÄ±nÄ±n gerÃ§ekten web kamerasÄ±na ihtiyaÃ§ duyduÄŸunu dÃ¼ÅŸÃ¼nerek bu onayÄ± kabul eder. Ancak bundan sonra uzantÄ±nÄ±n gizlice bir ÅŸey kaydetmemesine gÃ¼venmek zorundadÄ±r.

[**Tam coÄŸrafi konumunuz**](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation) veya [panonuzun iÃ§eriÄŸi](https://developer.mozilla.org/en-US/docs/Web/API/Clipboard\_API) gibi Ã¶zelliklere eriÅŸim iÃ§in aÃ§Ä±kÃ§a izin vermek gerekmez. Bir uzantÄ±, manifestosunun [**izinler giriÅŸine**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions) **`geolocation`** veya **`clipboard`** ekler. Bu eriÅŸim izinleri, uzantÄ± yÃ¼klendiÄŸinde otomatik olarak verilir. Bu nedenle, bu yetkilere sahip kÃ¶tÃ¼ niyetli veya tehlikeli bir uzantÄ±, hareket profilinizi oluÅŸturabilir veya kopyalanan parolalarÄ±nÄ±zÄ± fark etmeden panonuzu izleyebilir.

[**history**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history) anahtarÄ±nÄ± uzantÄ± manifestosunun [izinler giriÅŸine](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions) eklemek, **tÃ¼m tarayÄ±cÄ± geÃ§miÅŸini beklemek zorunda kalmadan kullanÄ±cÄ±nÄ±n tÃ¼m gezinme geÃ§miÅŸini almayÄ±** saÄŸlar.

**`bookmarks`** **izin**i benzer kÃ¶tÃ¼ye kullanÄ±m potansiyeline sahiptir, bu izin [**bookmarks API'si**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks) aracÄ±lÄ±ÄŸÄ±yla tÃ¼m yer imlerini okumaya izin verir.

### Dep
## **Referanslar**

* [https://palant.info/2022/08/17/extension-izinlerinin-etkisi/](https://palant.info/2022/08/17/extension-izinlerinin-etkisi/)
* [https://www.cobalt.io/blog/chrome-tarayici-uzantisi-guvenlik-testine-giris](https://www.cobalt.io/blog/chrome-tarayici-uzantisi-guvenlik-testine-giris)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
