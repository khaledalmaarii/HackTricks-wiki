# Dependency Confusion

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **kompaniji za kiberneti캜ku bezbednost**? 콯elite li da vidite svoju **kompaniju reklamiranu na HackTricks**? ili 쬰lite pristupiti **najnovijoj verziji PEASS ili preuzeti HackTricks u PDF formatu**? Proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru쬴te se** [**游눫**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitteru** 游냕[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na [hacktricks repozitorijum](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud repozitorijum](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Osnovne informacije

U su코tini, ranjivost dependency confusion se javlja kada projekat koristi biblioteku sa **pogre코no napisanim** imenom, **ne postoji** ili sa **nedefinisanim brojem verzije**, a kori코캖eni repozitorijum dozvoljava da se **prikupljaju a쬿rirane verzije iz javnih** repozitorijuma.

* **Pogre코no napisano**: Uvoziti **`reqests`** umesto `requests`
* **Ne postoji**: Uvoziti `company-logging`, internu biblioteku koja **vi코e ne postoji**
* **Nedefinisana verzija**: Uvoziti **internu** **postoje캖u** biblioteku `company-requests`, ali repozitorijum proverava **javne repozitorijume** da vidi da li postoje **ve캖e verzije**.

## Eksploatacija

{% hint style="warning" %}
U svim slu캜ajevima, napada캜 samo treba da objavi **zlonamerni paket sa imenom** biblioteka koje koristi kompanija rtva.
{% endhint %}

### Pogre코no napisano & Ne postoji

Ako va코a kompanija poku코ava da **uvozi biblioteku koja nije interna**, veoma je verovatno da 캖e repozitorijum biblioteka tra쬴ti tu biblioteku u **javim repozitorijumima**. Ako je napada캜 kreirao tu biblioteku, va코 kod i ma코ine koje je pokre캖u su veoma verovatno kompromitovane.

### Nedefinisana verzija

Veoma je 캜esto da developeri **ne specificiraju nijednu verziju** kori코tene biblioteke, ili specificiraju samo **glavnu verziju**. Tada, interpretator 캖e poku코ati da preuzme **najnoviju verziju** koja odgovara tim zahtevima.\
Ako je biblioteka **poznata spoljna biblioteka** (kao 코to je python `requests`), **napada캜 ne mo쬰 mnogo da uradi**, jer ne캖e mo캖i da kreira biblioteku nazvanu `requests` (osim ako je originalni autor).\
Me캠utim, ako je biblioteka **interna**, kao 코to je `requests-company` u ovom primeru, ako **repozitorijum biblioteke** dozvoljava da **proveri nove verzije i spolja**, tra쬴캖e noviju verziju dostupnu javno.\
Dakle, ako **napada캜 zna** da kompanija koristi biblioteku `requests-company` **verziju 1.0.1** (dozvoljava manje a쬿riranja). Mo쬰 **objaviti** biblioteku `requests-company` **verziju 1.0.2** i kompanija 캖e **koristiti tu biblioteku umesto** interne.

## AWS Popravka

Ova ranjivost je prona캠ena u AWS **CodeArtifact** (pro캜itajte [**detalje u ovom blog postu**](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)).\
AWS je ovo popravio omogu캖avaju캖i da se specificira da li je biblioteka interna ili eksterna, kako bi se izbeglo preuzimanje internih zavisnosti iz eksternih repozitorijuma.

## Pronala쬰nje Ranjivih Biblioteka

U [**originalnom postu o dependency confusion**](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610) autor je pretra쬴vao hiljade izlo쬰nih package.json fajlova koji sadr쬰 zavisnosti projekata u JavaScript-u.

## Reference

* [https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)
* [https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **kompaniji za kiberneti캜ku bezbednost**? 콯elite li da vidite svoju **kompaniju reklamiranu na HackTricks**? ili 쬰lite pristupiti **najnovijoj verziji PEASS ili preuzeti HackTricks u PDF formatu**? Proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru쬴te se** [**游눫**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitteru** 游냕[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na [hacktricks repozitorijum](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud repozitorijum](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
