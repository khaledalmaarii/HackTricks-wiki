# ConfusÃ£o de DependÃªncia

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou gostaria de ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## InformaÃ§Ãµes BÃ¡sicas

Em resumo, uma vulnerabilidade de confusÃ£o de dependÃªncia ocorre quando um projeto estÃ¡ usando uma biblioteca com um nome **com erro de digitaÃ§Ã£o**, **inexistente** ou com uma **versÃ£o nÃ£o especificada** e o repositÃ³rio de dependÃªncias usadas permite **reunir versÃµes atualizadas de repositÃ³rios pÃºblicos**.

* **Com erro de digitaÃ§Ã£o**: Importe **`reqests`** em vez de `requests`
* **Inexistente**: Importe `company-logging`, uma biblioteca interna que **nÃ£o existe mais**
* **VersÃ£o nÃ£o especificada**: Importe uma biblioteca **interna** **existente** `company-requests`, mas o repositÃ³rio verifica **repositÃ³rios pÃºblicos** para ver se existem **versÃµes superiores**.

## ExploraÃ§Ã£o

{% hint style="warning" %}
Em todos os casos, o atacante sÃ³ precisa publicar um **pacote malicioso com o nome** das bibliotecas usadas pela empresa vÃ­tima.
{% endhint %}

### Com Erro de DigitaÃ§Ã£o & Inexistente

Se sua empresa estÃ¡ tentando **importar uma biblioteca que nÃ£o Ã© interna**, Ã© altamente provÃ¡vel que o repositÃ³rio de bibliotecas esteja procurando por ela em **repositÃ³rios pÃºblicos**. Se um atacante a criou, seu cÃ³digo e mÃ¡quinas em execuÃ§Ã£o provavelmente serÃ£o comprometidos.

### VersÃ£o NÃ£o Especificada

Ã‰ muito comum os desenvolvedores **nÃ£o especificarem nenhuma versÃ£o** da biblioteca usada, ou especificarem apenas uma **versÃ£o principal**. EntÃ£o, o interpretador tentarÃ¡ baixar a **Ãºltima versÃ£o** que atenda a esses requisitos.\
Se a biblioteca for uma **biblioteca externa conhecida** (como `requests` em Python), um **atacante nÃ£o pode fazer muito**, pois nÃ£o poderÃ¡ criar uma biblioteca chamada `requests` (a menos que seja o autor original).\
No entanto, se a biblioteca for **interna**, como `requests-company` neste exemplo, se o **repositÃ³rio da biblioteca** permitir **verificar novas versÃµes tambÃ©m externamente**, ele procurarÃ¡ por uma versÃ£o mais recente disponÃ­vel publicamente.\
Portanto, se um **atacante souber** que a empresa estÃ¡ usando a biblioteca `requests-company` **versÃ£o 1.0.1** (permite atualizaÃ§Ãµes menores), ele pode **publicar** a biblioteca `requests-company` **versÃ£o 1.0.2** e a empresa **usarÃ¡ essa biblioteca em vez da interna**.

## CorreÃ§Ã£o da AWS

Essa vulnerabilidade foi encontrada no **CodeArtifact** da AWS (leia os [**detalhes neste post de blog**](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)).\
A AWS corrigiu isso permitindo especificar se uma biblioteca Ã© interna ou externa, para evitar o download de dependÃªncias internas de repositÃ³rios externos.

## Encontrando Bibliotecas VulnerÃ¡veis

No [**post original sobre confusÃ£o de dependÃªncia**](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610), o autor procurou milhares de arquivos package.json expostos contendo as dependÃªncias de projetos JavaScript.

## ReferÃªncias

* [https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)
* [https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou gostaria de ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
