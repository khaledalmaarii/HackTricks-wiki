{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}


åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå°†è§£é‡Šä¸€ä¸ªä½¿ç”¨ `java.io.Serializable` çš„ç¤ºä¾‹ã€‚

# Serializable

Java `Serializable` æ¥å£ï¼ˆ`java.io.Serializable` æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œæ‚¨çš„ç±»å¿…é¡»å®ç°å®ƒæ‰èƒ½è¢« **åºåˆ—åŒ–** å’Œ **ååºåˆ—åŒ–**ã€‚Java å¯¹è±¡åºåˆ—åŒ–ï¼ˆå†™å…¥ï¼‰æ˜¯é€šè¿‡ [ObjectOutputStream](http://tutorials.jenkov.com/java-io/objectoutputstream.html) å®Œæˆçš„ï¼Œååºåˆ—åŒ–ï¼ˆè¯»å–ï¼‰æ˜¯é€šè¿‡ [ObjectInputStream](http://tutorials.jenkov.com/java-io/objectinputstream.html) å®Œæˆçš„ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ª **å¯åºåˆ—åŒ–çš„ç±» Person** çš„ç¤ºä¾‹ã€‚è¿™ä¸ªç±» **é‡å†™äº† readObject** å‡½æ•°ï¼Œå› æ­¤å½“ **è¿™ä¸ªç±»çš„ä»»ä½•å¯¹è±¡** è¢« **ååºåˆ—åŒ–** æ—¶ï¼Œè¿™ä¸ª **å‡½æ•°** å°†ä¼šè¢« **æ‰§è¡Œ**ã€‚\
åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç±» Person çš„ **readObject å‡½æ•°** è°ƒç”¨äº†å®ƒçš„å® ç‰©çš„ `eat()` å‡½æ•°ï¼Œè€Œç‹—çš„ `eat()` å‡½æ•°ï¼ˆå‡ºäºæŸç§åŸå› ï¼‰è°ƒç”¨äº† **calc.exe**ã€‚**æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸€ä¸ª Person å¯¹è±¡ä»¥æ‰§è¡Œè¿™ä¸ªè®¡ç®—å™¨ï¼š**

**ä»¥ä¸‹ç¤ºä¾‹æ¥è‡ª [https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649](https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649)**
```java
import java.io.Serializable;
import java.io.*;

public class TestDeserialization {
interface Animal {
public void eat();
}
//Class must implements Serializable to be serializable
public static class Cat implements Animal,Serializable {
@Override
public void eat() {
System.out.println("cat eat fish");
}
}
//Class must implements Serializable to be serializable
public static class Dog implements Animal,Serializable {
@Override
public void eat() {
try {
Runtime.getRuntime().exec("calc");
} catch (IOException e) {
e.printStackTrace();
}
System.out.println("dog eat bone");
}
}
//Class must implements Serializable to be serializable
public static class Person implements Serializable {
private Animal pet;
public Person(Animal pet){
this.pet = pet;
}
//readObject implementation, will call the readObject from ObjectInputStream  and then call pet.eat()
private void readObject(java.io.ObjectInputStream stream)
throws IOException, ClassNotFoundException {
pet = (Animal) stream.readObject();
pet.eat();
}
}
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}
public static void main(String[] args) throws Exception {
// Example to call Person with a Dog
Animal animal = new Dog();
Person person = new Person(animal);
GeneratePayload(person,"test.ser");
payloadTest("test.ser");
// Example to call Person with a Cat
//Animal animal = new Cat();
//Person person = new Person(animal);
//GeneratePayload(person,"test.ser");
//payloadTest("test.ser");
}
}
```
## ç»“è®º

æ­£å¦‚æ‚¨åœ¨è¿™ä¸ªéå¸¸åŸºæœ¬çš„ä¾‹å­ä¸­æ‰€çœ‹åˆ°çš„ï¼Œè¿™é‡Œçš„â€œæ¼æ´â€å‡ºç°æ˜¯å› ä¸º**readObject**å‡½æ•°åœ¨**è°ƒç”¨å…¶ä»–æ˜“å—æ”»å‡»çš„å‡½æ•°**ã€‚

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
