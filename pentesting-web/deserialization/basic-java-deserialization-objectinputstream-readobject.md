{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


ì´ POSTì—ì„œëŠ” `java.io.Serializable`ì„ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œë¥¼ ì„¤ëª…í•  ê²ƒì…ë‹ˆë‹¤.

# Serializable

Java `Serializable` ì¸í„°í˜ì´ìŠ¤(`java.io.Serializable`ëŠ” í´ë˜ìŠ¤ê°€ **ì§ë ¬í™”** ë° **ì—­ì§ë ¬í™”**ë˜ê¸° ìœ„í•´ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ë§ˆì»¤ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. Java ê°ì²´ ì§ë ¬í™”(ì“°ê¸°)ëŠ” [ObjectOutputStream](http://tutorials.jenkov.com/java-io/objectoutputstream.html)ìœ¼ë¡œ ìˆ˜í–‰ë˜ë©°, ì—­ì§ë ¬í™”(ì½ê¸°)ëŠ” [ObjectInputStream](http://tutorials.jenkov.com/java-io/objectinputstream.html)ìœ¼ë¡œ ìˆ˜í–‰ë©ë‹ˆë‹¤.

**ì§ë ¬í™” ê°€ëŠ¥í•œ** **Person í´ë˜ìŠ¤**ì˜ ì˜ˆë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì´ í´ë˜ìŠ¤ëŠ” **readObject** í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ë¯€ë¡œ, ì´ **í´ë˜ìŠ¤**ì˜ **ì–´ë–¤ ê°ì²´**ê°€ **ì—­ì§ë ¬í™”**ë  ë•Œ ì´ **í•¨ìˆ˜**ê°€ **ì‹¤í–‰**ë©ë‹ˆë‹¤.\
ì˜ˆì œì—ì„œ Person í´ë˜ìŠ¤ì˜ **readObject í•¨ìˆ˜**ëŠ” ê·¸ì˜ ì• ì™„ë™ë¬¼ì˜ `eat()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³ , Dogì˜ `eat()` í•¨ìˆ˜ëŠ” (ì–´ë–¤ ì´ìœ ë¡œ) **calc.exe**ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. **ì´ ê³„ì‚°ê¸°ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ Person ê°ì²´ë¥¼ ì§ë ¬í™”í•˜ê³  ì—­ì§ë ¬í™”í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤:**

**ë‹¤ìŒ ì˜ˆì œëŠ” [https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649](https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649)ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒì…ë‹ˆë‹¤.**
```java
import java.io.Serializable;
import java.io.*;

public class TestDeserialization {
interface Animal {
public void eat();
}
//Class must implements Serializable to be serializable
public static class Cat implements Animal,Serializable {
@Override
public void eat() {
System.out.println("cat eat fish");
}
}
//Class must implements Serializable to be serializable
public static class Dog implements Animal,Serializable {
@Override
public void eat() {
try {
Runtime.getRuntime().exec("calc");
} catch (IOException e) {
e.printStackTrace();
}
System.out.println("dog eat bone");
}
}
//Class must implements Serializable to be serializable
public static class Person implements Serializable {
private Animal pet;
public Person(Animal pet){
this.pet = pet;
}
//readObject implementation, will call the readObject from ObjectInputStream  and then call pet.eat()
private void readObject(java.io.ObjectInputStream stream)
throws IOException, ClassNotFoundException {
pet = (Animal) stream.readObject();
pet.eat();
}
}
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}
public static void main(String[] args) throws Exception {
// Example to call Person with a Dog
Animal animal = new Dog();
Person person = new Person(animal);
GeneratePayload(person,"test.ser");
payloadTest("test.ser");
// Example to call Person with a Cat
//Animal animal = new Cat();
//Person person = new Person(animal);
//GeneratePayload(person,"test.ser");
//payloadTest("test.ser");
}
}
```
## ê²°ë¡ 

ì´ ë§¤ìš° ê¸°ë³¸ì ì¸ ì˜ˆì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ì—¬ê¸°ì„œ "ì·¨ì•½ì "ì€ **readObject** í•¨ìˆ˜ê°€ **ë‹¤ë¥¸ ì·¨ì•½í•œ í•¨ìˆ˜ë“¤ì„ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì—** ë°œìƒí•©ë‹ˆë‹¤.


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
