{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


ã“ã®POSTã§ã¯ã€`java.io.Serializable`ã‚’ä½¿ç”¨ã—ãŸä¾‹ãŒèª¬æ˜ã•ã‚Œã¾ã™ã€‚

# Serializable

Javaã®`Serializable`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆ`java.io.Serializable`ã¯ã€**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ãŠã‚ˆã³**ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ãŒå®Ÿè£…ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ãƒãƒ¼ã‚«ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚Javaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆæ›¸ãè¾¼ã¿ï¼‰ã¯[ObjectOutputStream](http://tutorials.jenkov.com/java-io/objectoutputstream.html)ã‚’ä½¿ç”¨ã—ã¦è¡Œã‚ã‚Œã€ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆèª­ã¿è¾¼ã¿ï¼‰ã¯[ObjectInputStream](http://tutorials.jenkov.com/java-io/objectinputstream.html)ã‚’ä½¿ç”¨ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚

**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ãª**ã‚¯ãƒ©ã‚¹Personã®ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã¯**readObject**é–¢æ•°ã‚’**ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰**ã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã®**ã‚¯ãƒ©ã‚¹**ã®**ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ãŒ**ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ã•ã‚Œã‚‹ã¨ã€ã“ã®**é–¢æ•°**ãŒ**å®Ÿè¡Œ**ã•ã‚Œã¾ã™ã€‚\
ã“ã®ä¾‹ã§ã¯ã€ã‚¯ãƒ©ã‚¹Personã®**readObjecté–¢æ•°**ãŒãã®ãƒšãƒƒãƒˆã®`eat()`é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€çŠ¬ã®`eat()`é–¢æ•°ãŒï¼ˆä½•ã‚‰ã‹ã®ç†ç”±ã§ï¼‰**calc.exe**ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚**ã“ã®è¨ˆç®—æ©Ÿã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€Personã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãŠã‚ˆã³ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã™ï¼š**

**ä»¥ä¸‹ã®ä¾‹ã¯[https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649](https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649)ã‹ã‚‰ã®ã‚‚ã®ã§ã™ã€‚**
```java
import java.io.Serializable;
import java.io.*;

public class TestDeserialization {
interface Animal {
public void eat();
}
//Class must implements Serializable to be serializable
public static class Cat implements Animal,Serializable {
@Override
public void eat() {
System.out.println("cat eat fish");
}
}
//Class must implements Serializable to be serializable
public static class Dog implements Animal,Serializable {
@Override
public void eat() {
try {
Runtime.getRuntime().exec("calc");
} catch (IOException e) {
e.printStackTrace();
}
System.out.println("dog eat bone");
}
}
//Class must implements Serializable to be serializable
public static class Person implements Serializable {
private Animal pet;
public Person(Animal pet){
this.pet = pet;
}
//readObject implementation, will call the readObject from ObjectInputStream  and then call pet.eat()
private void readObject(java.io.ObjectInputStream stream)
throws IOException, ClassNotFoundException {
pet = (Animal) stream.readObject();
pet.eat();
}
}
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}
public static void main(String[] args) throws Exception {
// Example to call Person with a Dog
Animal animal = new Dog();
Person person = new Person(animal);
GeneratePayload(person,"test.ser");
payloadTest("test.ser");
// Example to call Person with a Cat
//Animal animal = new Cat();
//Person person = new Person(animal);
//GeneratePayload(person,"test.ser");
//payloadTest("test.ser");
}
}
```
## çµè«–

ã“ã®éå¸¸ã«åŸºæœ¬çš„ãªä¾‹ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã“ã“ã§ã®ã€Œè„†å¼±æ€§ã€ã¯**readObject**é–¢æ•°ãŒ**ä»–ã®è„†å¼±ãªé–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹**ãŸã‚ã«ç™ºç”Ÿã—ã¾ã™ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
