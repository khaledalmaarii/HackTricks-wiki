# Domain/Subdomain takeover

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=domain-subdomain-takeover) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

## Domain takeover

EÄŸer bazÄ± hizmetler tarafÄ±ndan **kullanÄ±lan** bir domain (domain.tld) keÅŸfettiyseniz ancak **ÅŸirket** bunun **sahipliÄŸini** **kaybetmiÅŸse**, bunu **kaydetmeyi** (eÄŸer yeterince ucuzsa) deneyebilir ve ÅŸirkete bildirebilirsiniz. EÄŸer bu domain bazÄ± **hassas bilgileri** alÄ±yorsa, Ã¶rneÄŸin bir oturum Ã§erezi **GET** parametresi veya **Referer** baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla, bu kesinlikle bir **aÃ§Ä±k**tÄ±r.

### Subdomain takeover

Åirketin bir alt domaini, **kayÄ±tlÄ± olmayan bir isimle Ã¼Ã§Ã¼ncÃ¼ taraf bir hizmete** iÅŸaret ediyor. EÄŸer bu **Ã¼Ã§Ã¼ncÃ¼ taraf hizmette** bir **hesap oluÅŸturabilir** ve kullanÄ±lan **isimi** **kaydedebilirseniz**, alt domaini ele geÃ§irebilirsiniz.

OlasÄ± ele geÃ§irmeleri kontrol etmek iÃ§in Ã§eÅŸitli araÃ§lar ve sÃ¶zlÃ¼kler mevcuttur:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

#### [BBOT](https://github.com/blacklanternsecurity/bbot) ile Ele GeÃ§irilebilir Alt Domainleri Tarama:

Alt domain ele geÃ§irme kontrolleri BBOT'un varsayÄ±lan alt domain belirleme iÅŸlemlerine dahildir. Ä°mzalar doÄŸrudan [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) adresinden alÄ±nmaktadÄ±r.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### DNS Wildcard ile Alt Alan AdÄ± Ele GeÃ§irme Ãœretimi

DNS wildcard bir alanda kullanÄ±ldÄ±ÄŸÄ±nda, o alanÄ±n farklÄ± bir adresi olmayan herhangi bir istenen alt alan adÄ± **aynÄ± bilgilere Ã§Ã¶zÃ¼mlenecektir**. Bu bir A IP adresi, bir CNAME olabilir...

Ã–rneÄŸin, `*.testing.com` `1.1.1.1` adresine wildcard olarak ayarlandÄ±ÄŸÄ±nda, `not-existent.testing.com` `1.1.1.1` adresine iÅŸaret edecektir.

Ancak, bir IP adresine iÅŸaret etmek yerine, sistem yÃ¶neticisi bunu bir **CNAME aracÄ±lÄ±ÄŸÄ±yla Ã¼Ã§Ã¼ncÃ¼ taraf bir hizmete** yÃ¶nlendirirse, Ã¶rneÄŸin bir **github alt alan adÄ±** (`sohomdatta1.github.io`) gibi. Bir saldÄ±rgan **kendi Ã¼Ã§Ã¼ncÃ¼ taraf sayfasÄ±nÄ±** (bu durumda GitHub'da) oluÅŸturabilir ve `something.testing.com` adresinin oraya iÅŸaret ettiÄŸini sÃ¶yleyebilir. Ã‡Ã¼nkÃ¼, **CNAME wildcard** saldÄ±rgana **kurbanÄ±n alanÄ± iÃ§in keyfi alt alan adlarÄ± oluÅŸturma** yetkisi verecektir.

Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± bir Ã¶rneÄŸini CTF yazÄ±sÄ±nda bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Alt Alan AdÄ± Ele GeÃ§irme SÃ¶mÃ¼rÃ¼sÃ¼

Alt alan adÄ± ele geÃ§irme, temelde belirli bir alan iÃ§in internet genelinde DNS sahtekarlÄ±ÄŸÄ±dÄ±r ve saldÄ±rganlarÄ±n bir alan iÃ§in A kayÄ±tlarÄ± ayarlamasÄ±na olanak tanÄ±r, bu da tarayÄ±cÄ±larÄ±n saldÄ±rganÄ±n sunucusundan iÃ§erik gÃ¶stermesine neden olur. Bu tarayÄ±cÄ±lardaki **ÅŸeffaflÄ±k**, alanlarÄ± phishing'e karÅŸÄ± savunmasÄ±z hale getirir. SaldÄ±rganlar bu amaÃ§la [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger alanlarÄ±_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Ã–zellikle, bir phishing e-postasÄ±nda URL'nin meÅŸru gÃ¶rÃ¼ndÃ¼ÄŸÃ¼ alanlar savunmasÄ±zdÄ±r, bu da kullanÄ±cÄ±larÄ± kandÄ±rarak alanÄ±n doÄŸuÅŸtan gÃ¼veni nedeniyle spam filtrelerinden kaÃ§Ä±nmalarÄ±na neden olur.

Daha fazla ayrÄ±ntÄ± iÃ§in bu [gÃ¶nderiyi kontrol edin](https://0xpatrik.com/subdomain-takeover/)

### **SSL SertifikalarÄ±**

SaldÄ±rganlar tarafÄ±ndan [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracÄ±lÄ±ÄŸÄ±yla Ã¼retilen SSL sertifikalarÄ±, bu sahte alanlarÄ±n meÅŸruiyetini artÄ±rarak phishing saldÄ±rÄ±larÄ±nÄ± daha inandÄ±rÄ±cÄ± hale getirir.

### **Ã‡erez GÃ¼venliÄŸi ve TarayÄ±cÄ± ÅeffaflÄ±ÄŸÄ±**

TarayÄ±cÄ± ÅŸeffaflÄ±ÄŸÄ±, [AynÄ± kÃ¶ken politikasÄ±](https://en.wikipedia.org/wiki/Same-origin_policy) gibi politikalarla yÃ¶netilen Ã§erez gÃ¼venliÄŸine de uzanÄ±r. OturumlarÄ± yÃ¶netmek ve giriÅŸ belirteÃ§lerini depolamak iÃ§in sÄ±klÄ±kla kullanÄ±lan Ã§erezler, alt alan adÄ± ele geÃ§irme yoluyla istismar edilebilir. SaldÄ±rganlar, kullanÄ±cÄ±larÄ± tehlikeye atÄ±lmÄ±ÅŸ bir alt alan adÄ±na yÃ¶nlendirerek **oturum Ã§erezlerini toplayabilir**, bu da kullanÄ±cÄ± verilerini ve gizliliÄŸini tehlikeye atar.

### **E-postalar ve Alt Alan AdÄ± Ele GeÃ§irme**

Alt alan adÄ± ele geÃ§irmenin bir diÄŸer yÃ¶nÃ¼ e-posta hizmetleridir. SaldÄ±rganlar, meÅŸru bir alt alan adÄ±ndan e-posta almak veya gÃ¶ndermek iÃ§in **MX kayÄ±tlarÄ±nÄ±** manipÃ¼le edebilir, bu da phishing saldÄ±rÄ±larÄ±nÄ±n etkinliÄŸini artÄ±rÄ±r.

### **YÃ¼ksek DÃ¼zey Riskler**

DiÄŸer riskler arasÄ±nda **NS kaydÄ± ele geÃ§irme** bulunmaktadÄ±r. Bir saldÄ±rgan bir alanÄ±n bir NS kaydÄ±nÄ± kontrol altÄ±na alÄ±rsa, trafiÄŸin bir kÄ±smÄ±nÄ± kendi kontrolÃ¼ndeki bir sunucuya yÃ¶nlendirebilir. Bu risk, saldÄ±rganÄ±n DNS kayÄ±tlarÄ± iÃ§in yÃ¼ksek bir **TTL (YaÅŸam SÃ¼resi)** ayarlamasÄ± durumunda artar ve saldÄ±rÄ±nÄ±n sÃ¼resini uzatÄ±r.

### CNAME KayÄ±t AÃ§Ä±ÄŸÄ±

SaldÄ±rganlar, artÄ±k kullanÄ±lmayan veya devre dÄ±ÅŸÄ± bÄ±rakÄ±lan dÄ±ÅŸ hizmetlere iÅŸaret eden talep edilmemiÅŸ CNAME kayÄ±tlarÄ±nÄ± istismar edebilir. Bu, onlara gÃ¼venilir bir alan altÄ±nda bir sayfa oluÅŸturma imkanÄ± tanÄ±r ve phishing veya kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m daÄŸÄ±tÄ±mÄ±nÄ± daha da kolaylaÅŸtÄ±rÄ±r.

### **Azaltma Stratejileri**

Azaltma stratejileri ÅŸunlarÄ± iÃ§erir:

1. **SavunmasÄ±z DNS kayÄ±tlarÄ±nÄ± kaldÄ±rmak** - Bu, alt alan adÄ± artÄ±k gerekli deÄŸilse etkilidir.
2. **Alan adÄ±nÄ± talep etmek** - Ä°lgili bulut saÄŸlayÄ±cÄ±sÄ±yla kaynaÄŸÄ± kaydetmek veya sÃ¼resi dolmuÅŸ bir alan adÄ±nÄ± yeniden satÄ±n almak.
3. **SavunmasÄ±zlÄ±klar iÃ§in dÃ¼zenli izleme** - [aquatone](https://github.com/michenriksen/aquatone) gibi araÃ§lar, savunmasÄ±z alanlarÄ± tanÄ±mlamaya yardÄ±mcÄ± olabilir. KuruluÅŸlar ayrÄ±ca, DNS kaydÄ± oluÅŸturmanÄ±n kaynak oluÅŸturmadaki son adÄ±m ve kaynak yok etmedeki ilk adÄ±m olduÄŸundan emin olarak altyapÄ± yÃ¶netim sÃ¼reÃ§lerini gÃ¶zden geÃ§irmelidir.

Bulut saÄŸlayÄ±cÄ±larÄ± iÃ§in, alan sahipliÄŸini doÄŸrulamak, alt alan adÄ± ele geÃ§irmelerini Ã¶nlemek iÃ§in kritik Ã¶neme sahiptir. [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi bazÄ±larÄ± bu sorunu tanÄ±mÄ±ÅŸ ve alan doÄŸrulama mekanizmalarÄ± uygulamÄ±ÅŸtÄ±r.

## Referanslar

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek iÃ§in** [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=domain-subdomain-takeover) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
