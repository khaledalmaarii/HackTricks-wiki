# Domain/Subdomain takeover

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± **Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î±** ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

## Domain takeover

Î‘Î½ Î±Î½Î±ÎºÎ±Î»ÏÏˆÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ domain (domain.tld) Ï€Î¿Ï… **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ ÎºÎ¬Ï€Î¿Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… Ï€ÎµÎ´Î¯Î¿Ï…** Î±Î»Î»Î¬ Î· **ÎµÏ„Î±Î¹ÏÎµÎ¯Î±** Î­Ï‡ÎµÎ¹ **Ï‡Î¬ÏƒÎµÎ¹** Ï„Î·Î½ **Î¹Î´Î¹Î¿ÎºÏ„Î·ÏƒÎ¯Î±** Ï„Î¿Ï…, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± Ï„Î¿ **ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÎµÏ„Îµ** (Î±Î½ ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ Ï†Î¸Î·Î½ÏŒ) ÎºÎ±Î¹ Î½Î± ÎµÎ½Î·Î¼ÎµÏÏÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ„Î±Î¹ÏÎµÎ¯Î±. Î‘Î½ Î±Ï…Ï„ÏŒ Ï„Î¿ domain Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± **ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î±** ÏŒÏ€Ï‰Ï‚ Î­Î½Î± session cookie Î¼Î­ÏƒÏ‰ **GET** Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï… Î® ÏƒÏ„Î·Î½ **Referer** ÎºÎµÏ†Î±Î»Î¯Î´Î±, Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÎ¯Î³Î¿Ï…ÏÎ± Î¼Î¹Î± **ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±**.

### Subdomain takeover

ÎˆÎ½Î± subdomain Ï„Î·Ï‚ ÎµÏ„Î±Î¹ÏÎµÎ¯Î±Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï„ÏÎ¯Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚ Î¼Îµ ÏŒÎ½Î¿Î¼Î± Ï€Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î¿**. Î‘Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ** Î­Î½Î±Î½ **Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ** ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï„ÏÎ¯Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚** ÎºÎ±Î¹ Î½Î± **ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®ÏƒÎµÏ„Îµ** Ï„Î¿ **ÏŒÎ½Î¿Î¼Î±** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï…Ï€Î¿Î´Î¿Ï‡Î® subdomain.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î¬Ï†Î¿ÏÎ± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î¼Îµ Î»ÎµÎ¾Î¹ÎºÎ¬ Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï€Î¹Î¸Î±Î½Î­Ï‚ Ï…Ï€Î¿Î´Î¿Ï‡Î­Ï‚:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)
* [https://github.com/Stratus-Security/Subdominator](https://github.com/Stratus-Security/Subdominator)

### Subdomain Takeover Generation via DNS Wildcard

ÎŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ DNS wildcard ÏƒÎµ Î­Î½Î± domain, Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î¶Î·Ï„Î¿ÏÎ¼ÎµÎ½Î¿ subdomain Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… domain Ï€Î¿Ï… Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏÎ·Ï„Î¬ Î¸Î± **ÎµÏ€Î¹Î»ÏÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î±**. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP A, Î­Î½Î± CNAME...

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ Ï„Î¿ `*.testing.com` ÎµÎ¯Î½Î±Î¹ wildcarded ÏƒÏ„Î¿ `1.1.1.1`. Î¤ÏŒÏ„Îµ, Ï„Î¿ `not-existent.testing.com` Î¸Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î¿ `1.1.1.1`.

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Î½ Î±Î½Ï„Î¯ Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP, Î¿ sysadmin Ï„Î¿ Î´ÎµÎ¯Î¾ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï„ÏÎ¯Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚ Î¼Î­ÏƒÏ‰ CNAME**, ÏŒÏ€Ï‰Ï‚ Î­Î½Î± G**ithub subdomain** Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± (`sohomdatta1.github.io`). ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î· Î´Î¹ÎºÎ® Ï„Î¿Ï… ÏƒÎµÎ»Î¯Î´Î± Ï„ÏÎ¯Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚** (ÏƒÎµ Gihub ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·) ÎºÎ±Î¹ Î½Î± Ï€ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ `something.testing.com` Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÎµÎºÎµÎ¯. Î•Ï€ÎµÎ¹Î´Î®, Ï„Î¿ **CNAME wildcard** Î¸Î± ÏƒÏ…Î¼Ï†Ï‰Î½Î®ÏƒÎµÎ¹ ÏŒÏ„Î¹ Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î± subdomains Î³Î¹Î± Ï„Î¿ domain Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚ Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ ÏƒÏ„Î¹Ï‚ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Ï„Î¿Ï…**.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ ÏƒÏ„Î·Î½ Î±Î½Î±Ï†Î¿ÏÎ¬ CTF: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Exploiting a subdomain takeover

Î— Ï…Ï€Î¿Î´Î¿Ï‡Î® subdomain ÎµÎ¯Î½Î±Î¹ Î¿Ï…ÏƒÎ¹Î±ÏƒÏ„Î¹ÎºÎ¬ DNS spoofing Î³Î¹Î± Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ domain ÏƒÎµ ÏŒÎ»Î¿ Ï„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± Î¿ÏÎ¯ÏƒÎ¿Ï…Î½ A records Î³Î¹Î± Î­Î½Î± domain, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î­Ï‚ Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Ï…Î½ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î±Ï€ÏŒ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Ï„Î¿Ï… ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…. Î‘Ï…Ï„Î® Î· **Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î±** ÏƒÏ„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î­Ï‚ ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ Ï„Î± domains ÎµÏ€Î¹ÏÏÎµÏ€Î® ÏƒÎµ phishing. ÎŸÎ¹ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) Î® [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎºÎ¿Ï€ÏŒ. Î™Î´Î¹Î±Î¯Ï„ÎµÏÎ± ÎµÏ…Î¬Î»Ï‰Ï„Î± ÎµÎ¯Î½Î±Î¹ Ï„Î± domains ÏŒÏ€Î¿Ï… Ï„Î¿ URL ÏƒÎµ Î­Î½Î± phishing email Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Î½ÏŒÎ¼Î¹Î¼Î¿, ÎµÎ¾Î±Ï€Î±Ï„ÏÎ½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎºÎ±Î¹ Î±Ï€Î¿Ï†ÎµÏÎ³Î¿Î½Ï„Î±Ï‚ Ï„Î± Ï†Î¯Î»Ï„ÏÎ± spam Î»ÏŒÎ³Ï‰ Ï„Î·Ï‚ ÎµÎ³Î³ÎµÎ½Î®Ï‚ ÎµÎ¼Ï€Î¹ÏƒÏ„Î¿ÏƒÏÎ½Î·Ï‚ Ï„Î¿Ï… domain.

Î•Î»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„Î® Ï„Î·Î½ [Î±Î½Î¬ÏÏ„Î·ÏƒÎ· Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚](https://0xpatrik.com/subdomain-takeover/)

### **SSL Certificates**

Î¤Î± SSL certificates, Î±Î½ Ï€Î±ÏÎ±Ï‡Î¸Î¿ÏÎ½ Î±Ï€ÏŒ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î¼Î­ÏƒÏ‰ Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½ ÏŒÏ€Ï‰Ï‚ [_Let's Encrypt_](https://letsencrypt.org/), Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î½ ÏƒÏ„Î·Î½ Î½Î¿Î¼Î¹Î¼ÏŒÏ„Î·Ï„Î± Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ ÏˆÎµÏÏ„Î¹ÎºÏ‰Î½ domains, ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ phishing Ï€Î¹Î¿ Ï€ÎµÎ¹ÏƒÏ„Î¹ÎºÎ­Ï‚.

### **Cookie Security and Browser Transparency**

Î— Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î± Ï„Î¿Ï… Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î® ÎµÏ€ÎµÎºÏ„ÎµÎ¯Î½ÎµÏ„Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± Ï„Ï‰Î½ cookies, Ï€Î¿Ï… Î´Î¹Î­Ï€ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ ÏŒÏ€Ï‰Ï‚ Î· [Same-origin policy](https://en.wikipedia.org/wiki/Same-origin\_policy). Î¤Î± cookies, Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ…Ï‡Î½Î¬ Î³Î¹Î± Ï„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÏƒÏ…Î½ÎµÎ´ÏÎ¹ÏÎ½ ÎºÎ±Î¹ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· tokens ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½ Î¼Î­ÏƒÏ‰ Ï…Ï€Î¿Î´Î¿Ï‡Î®Ï‚ subdomain. ÎŸÎ¹ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **ÏƒÏ…Î³ÎºÎµÎ½Ï„ÏÏÏƒÎ¿Ï…Î½ session cookies** Î±Ï€Î»Î¬ ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÏƒÎµ Î­Î½Î± Ï…Ï€Î¿ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î¿ subdomain, Î¸Î­Ï„Î¿Î½Ï„Î±Ï‚ ÏƒÎµ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ Ï„Î·Î½ Î¹Î´Î¹Ï‰Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½.

### **Emails and Subdomain Takeover**

ÎœÎ¹Î± Î¬Î»Î»Î· Ï€Ï„Ï…Ï‡Î® Ï„Î·Ï‚ Ï…Ï€Î¿Î´Î¿Ï‡Î®Ï‚ subdomain Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ email. ÎŸÎ¹ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î¿ÏÎ½ **MX records** Î³Î¹Î± Î½Î± Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Î® Î½Î± ÏƒÏ„Î­Î»Î½Î¿Ï…Î½ emails Î±Ï€ÏŒ Î­Î½Î± Î½ÏŒÎ¼Î¹Î¼Î¿ subdomain, ÎµÎ½Î¹ÏƒÏ‡ÏÎ¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ ÎµÏ€Î¹Î¸Î­ÏƒÎµÏ‰Î½ phishing.

### **Higher Order Risks**

Î ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ ÎºÎ¯Î½Î´Ï…Î½Î¿Î¹ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Ï„Î·Î½ **Ï…Ï€Î¿Î´Î¿Ï‡Î® NS record**. Î‘Î½ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÎµ Î­Î½Î± NS record ÎµÎ½ÏŒÏ‚ domain, Î¼Ï€Î¿ÏÎµÎ¯ Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ Î½Î± ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÎ¹ Î­Î½Î± Î¼Î­ÏÎ¿Ï‚ Ï„Î·Ï‚ ÎºÎ¯Î½Î·ÏƒÎ·Ï‚ ÏƒÎµ Î­Î½Î±Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Ï…Ï€ÏŒ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡ÏŒ Ï„Î¿Ï…. Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÎºÎ¯Î½Î´Ï…Î½Î¿Ï‚ ÎµÎ½Î¹ÏƒÏ‡ÏÎµÏ„Î±Î¹ Î±Î½ Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¿ÏÎ¯ÏƒÎµÎ¹ Î¼Î¹Î± Ï…ÏˆÎ·Î»Î® **TTL (Time to Live)** Î³Î¹Î± Ï„Î± DNS records, Ï€Î±ÏÎ±Ï„ÎµÎ¯Î½Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚.

### CNAME Record Vulnerability

ÎŸÎ¹ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½ Î¼Î· ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î± CNAME records Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ ÏƒÎµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Î´ÎµÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Ï€Î»Î­Î¿Î½ Î® Î­Ï‡Î¿Ï…Î½ Î±Ï€Î¿ÏƒÏ…ÏÎ¸ÎµÎ¯. Î‘Ï…Ï„ÏŒ Ï„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ Î¼Î¹Î± ÏƒÎµÎ»Î¯Î´Î± Ï…Ï€ÏŒ Ï„Î¿ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿ domain, Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Ï„Î¿ phishing Î® Ï„Î· Î´Î¹Î±Î½Î¿Î¼Î® ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿Ï… Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï.

### **Mitigation Strategies**

ÎŸÎ¹ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ­Ï‚ Î¼ÎµÏ„ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½:

1. **Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÏ…Î¬Î»Ï‰Ï„Ï‰Î½ DNS records** - Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒ Î±Î½ Ï„Î¿ subdomain Î´ÎµÎ½ Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Ï€Î»Î­Î¿Î½.
2. **ÎšÎ±Ï„Î¿Ï‡ÏÏÏ‰ÏƒÎ· Ï„Î¿Ï… Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ domain** - ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Ï„Î¿Ï… Ï€ÏŒÏÎ¿Ï… Î¼Îµ Ï„Î¿Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ Ï€Î¬ÏÎ¿Ï‡Î¿ cloud Î® ÎµÏ€Î±Î½Î±Î³Î¿ÏÎ¬ ÎµÎ½ÏŒÏ‚ Î»Î·Î³Î¼Î­Î½Î¿Ï… domain.
3. **Î¤Î±ÎºÏ„Î¹ÎºÎ® Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Î³Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚** - Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [aquatone](https://github.com/michenriksen/aquatone) Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î½ ÏƒÏ„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· ÎµÏ…Î¬Î»Ï‰Ï„Ï‰Î½ domains. ÎŸÎ¹ Î¿ÏÎ³Î±Î½Î¹ÏƒÎ¼Î¿Î¯ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î±Î½Î±Î¸ÎµÏ‰ÏÎ®ÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Ï…Ï€Î¿Î´Î¿Î¼ÏÎ½ Ï„Î¿Ï…Ï‚, Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± DNS records ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ Î²Î®Î¼Î± ÏƒÏ„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÏŒÏÏ‰Î½ ÎºÎ±Î¹ Ï„Î¿ Ï€ÏÏÏ„Î¿ Î²Î®Î¼Î± ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î±ÏƒÏ„ÏÎ¿Ï†Î® Ï€ÏŒÏÏ‰Î½.

Î“Î¹Î± Ï„Î¿Ï…Ï‚ Ï€Î±ÏÏŒÏ‡Î¿Ï…Ï‚ cloud, Î· ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î·ÏƒÎ¯Î±Ï‚ Ï„Î¿Ï… domain ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î· Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿Ï„ÏÎ¿Ï€Î® Ï…Ï€Î¿Î´Î¿Ï‡Î®Ï‚ subdomain. ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î¿Î¹, ÏŒÏ€Ï‰Ï‚ [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), Î­Ï‡Î¿Ï…Î½ Î±Î½Î±Î³Î½Ï‰ÏÎ¯ÏƒÎµÎ¹ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¶Î®Ï„Î·Î¼Î± ÎºÎ±Î¹ Î­Ï‡Î¿Ï…Î½ ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÎ¹ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿ÏÏ‚ ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·Ï‚ domain.

## References

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)
* [https://www.stratussecurity.com/post/subdomain-takeover-guide](https://www.stratussecurity.com/post/subdomain-takeover-guide)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± **Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î±** ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
