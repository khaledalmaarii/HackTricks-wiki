# Preuzimanje domena/subdomena

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) za lako kreiranje i **automatizaciju radnih tokova** pokretanih najnaprednijim **alatima** zajednice.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

## Preuzimanje domena

Ako otkrijete neku domenu (domain.tld) koja se **koristi za neku uslugu unutar opsega** ali je **kompanija** **izgubila** **vlasni코tvo** nad njom, mo쬰te poku코ati da je **registrujete** (ako je dovoljno jeftina) i obavestite kompaniju. Ako ova domena prima neku **osetljivu informaciju** poput sesijskog kola캜i캖a putem **GET** parametra ili u **Referer** headeru, to je sigurno **ranjivost**.

### Preuzimanje subdomena

Subdomena kompanije pokazuje na **uslugu tre캖e strane sa imenom koje nije registrovano**. Ako mo쬰te **napraviti** **nalog** u ovoj **usluzi tre캖e strane** i **registrujete** **ime** koje se koristi, mo쬰te izvr코iti preuzimanje subdomena.

Postoji nekoliko alata sa re캜nicima za proveru mogu캖ih preuzimanja:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)
* [https://github.com/Stratus-Security/Subdominator](https://github.com/Stratus-Security/Subdominator)
* [https://github.com/NImaism/takeit](https://github.com/NImaism/takeit)

### Generisanje preuzimanja subdomena putem DNS Wildcard

Kada se koristi DNS wildcard u domeni, svaka tra쬰na subdomena te domene koja nema druga캜iju adresu eksplicitno 캖e biti **re코ena na iste informacije**. Ovo mo쬰 biti A IP adresa, CNAME...

Na primer, ako je `*.testing.com` wildcardovan na `1.1.1.1`. Tada 캖e `not-existent.testing.com` pokazivati na `1.1.1.1`.

Me캠utim, ako umesto da pokazuje na IP adresu, sistem administrator usmeri na **uslugu tre캖e strane putem CNAME**, kao 코to je G**ithub subdomena** na primer (`sohomdatta1.github.io`). Napada캜 mo쬰 **napraviti svoju stranicu tre캖e strane** (u Gihubu u ovom slu캜aju) i re캖i da `something.testing.com` pokazuje tamo. Zato, **CNAME wildcard** 캖e omogu캖iti napada캜u da **generi코e proizvoljne subdomene za domenu rtve koje pokazuju na njegove stranice**.

Mo쬰te prona캖i primer ove ranjivosti u CTF izve코taju: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Iskori코캖avanje preuzimanja subdomena

Preuzimanje subdomena je su코tinski DNS spoofing za specifi캜nu domenu 코irom interneta, omogu캖avaju캖i napada캜ima da postave A zapise za domenu, 코to dovodi do toga da pregleda캜i prikazuju sadr쬬j sa napada캜evog servera. Ova **transparentnost** u pregleda캜ima 캜ini domene podlo쬹im phishingu. Napada캜i mogu koristiti [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) ili [_Doppelganger domene_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) u tu svrhu. Posebno su ranjive domene gde URL u phishing e-mailu izgleda legitimno, obmanjuju캖i korisnike i izbegavaju캖i spam filtere zbog inherentnog poverenja domene.

Proverite ovaj [post za dodatne detalje](https://0xpatrik.com/subdomain-takeover/)

### **SSL Sertifikati**

SSL sertifikati, ako ih generi코u napada캜i putem usluga poput [_Let's Encrypt_](https://letsencrypt.org/), dodaju legitimitet ovim la쬹im domenama, 캜ine캖i phishing napade uverljivijim.

### **Bezbednost kola캜i캖a i transparentnost pregleda캜a**

Transparentnost pregleda캜a se tako캠e odnosi na bezbednost kola캜i캖a, kojom upravljaju politike poput [Same-origin policy](https://en.wikipedia.org/wiki/Same-origin\_policy). Kola캜i캖i, koji se 캜esto koriste za upravljanje sesijama i 캜uvanje tokena za prijavu, mogu se iskoristiti putem preuzimanja subdomena. Napada캜i mogu **prikupiti sesijske kola캜i캖e** jednostavno usmeravaju캖i korisnike na kompromitovanu subdomenu, ugro쬬vaju캖i podatke i privatnost korisnika.

### **E-mailovi i preuzimanje subdomena**

Jo코 jedan aspekt preuzimanja subdomena uklju캜uje e-mail usluge. Napada캜i mogu manipulisati **MX zapisima** kako bi primali ili slali e-mailove sa legitimne subdomene, pove캖avaju캖i efikasnost phishing napada.

### **Rizici vi코eg reda**

Dalji rizici uklju캜uju **preuzimanje NS zapisa**. Ako napada캜 stekne kontrolu nad jednim NS zapisom domene, mo쬰 potencijalno usmeriti deo saobra캖aja na server pod svojom kontrolom. Ovaj rizik se pove캖ava ako napada캜 postavi visoki **TTL (Time to Live)** za DNS zapise, produ쬬vaju캖i trajanje napada.

### Ranjivost CNAME zapisa

Napada캜i bi mogli iskoristiti neizdane CNAME zapise koji pokazuju na spoljne usluge koje se vi코e ne koriste ili su ukinute. Ovo im omogu캖ava da kreiraju stranicu pod poverenom domenom, dodatno olak코avaju캖i phishing ili distribuciju malvera.

### **Strategije ubla쬬vanja**

Strategije ubla쬬vanja uklju캜uju:

1. **Uklanjanje ranjivih DNS zapisa** - Ovo je efikasno ako subdomena vi코e nije potrebna.
2. **Pribavljanje imena domene** - Registracija resursa kod odgovaraju캖eg provajdera u oblaku ili ponovna kupovina istekao domen.
3. **Redovno pra캖enje ranjivosti** - Alati poput [aquatone](https://github.com/michenriksen/aquatone) mogu pomo캖i u identifikaciji podlo쬹ih domena. Organizacije bi tako캠e trebale revidirati svoje procese upravljanja infrastrukturom, osiguravaju캖i da kreiranje DNS zapisa bude poslednji korak u kreiranju resursa i prvi korak u uni코tavanju resursa.

Za provajdere u oblaku, verifikacija vlasni코tva nad domenom je klju캜na za spre캜avanje preuzimanja subdomena. Neki, poput [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), su prepoznali ovaj problem i implementirali mehanizme verifikacije domena.

## Reference

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)
* [https://www.stratussecurity.com/post/subdomain-takeover-guide](https://www.stratussecurity.com/post/subdomain-takeover-guide)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) za lako kreiranje i **automatizaciju radnih tokova** pokretanih najnaprednijim **alatima** zajednice.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
