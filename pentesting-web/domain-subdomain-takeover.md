# Preuzimanje domena/poddomena

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** uz pomo캖 najnaprednijih alata zajednice.\
Dobijte pristup danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Preuzimanje domena

Ako otkrijete neki domen (domen.tld) koji **koristi neka usluga unutar opsega**, ali **kompanija** je **izgubila vlasni코tvo** nad njim, mo쬰te poku코ati da ga **registrujete** (ako je dovoljno jeftin) i obavestite kompaniju. Ako ovaj domen prima neke **osetljive informacije** kao 코to je kola캜i캖 sesije putem **GET** parametra ili u zaglavlju **Referer**, to je sigurno **ranjivost**.

### Preuzimanje poddomena

Poddomen kompanije pokazuje na **uslugu tre캖e strane sa neimenovanim imenom**. Ako mo쬰te **kreirati** nalog na ovoj **usluzi tre캖e strane** i **registrujete** ime koje se koristi, mo쬰te izvr코iti preuzimanje poddomena.

Postoji nekoliko alata sa re캜nicima za proveru mogu캖ih preuzimanja:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### Skeniranje za preuzimanje poddomena sa [BBOT](https://github.com/blacklanternsecurity/bbot):

Provere preuzimanja poddomena su uklju캜ene u podrazumevanoj enumeraciji poddomena BBOT-a. Potpisi se direktno preuzimaju sa [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Generisanje preuzimanja poddomena putem DNS wildcard-a

Kada se DNS wildcard koristi u domenu, svaki zahtevani poddomen tog domena koji nema eksplicitno drugu adresu 캖e biti **re코en na iste informacije**. To mo쬰 biti IP adresa A, CNAME...

Na primer, ako je `*.testing.com` wildcardovan na `1.1.1.1`. Onda 캖e `not-existent.testing.com` pokazivati na `1.1.1.1`.

Me캠utim, ako umesto da pokazuje na IP adresu, sistem administrator usmeri na **uslugu tre캖e strane putem CNAME-a**, kao 코to je na primer **github poddomen** (`sohomdatta1.github.io`). Napada캜 bi mogao **kreirati svoju sopstvenu stranicu tre캖e strane** (u ovom slu캜aju na Github-u) i re캖i da `something.testing.com` pokazuje tamo. Zbog toga 코to **CNAME wildcard** to dozvoljava, napada캜 캖e biti u mogu캖nosti da **generi코e proizvoljne poddomene za domen rtve koji pokazuju na njegove stranice**.

Primer ove ranjivosti mo쬰te prona캖i u CTF write-up-u: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Iskori코캖avanje preuzimanja poddomena

Preuzimanje poddomena je su코tinski DNS spoofing za odre캠eni domen 코irom interneta, 코to omogu캖ava napada캜ima da postave A zapise za domen, 코to dovodi do prikazivanja sadr쬬ja sa servera napada캜a u pregleda캜ima. Ova **transparentnost** u pregleda캜ima 캜ini domene podlo쬹im fi코ing napadima. Napada캜i mogu koristiti [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) ili [_Doppelganger domene_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) u tu svrhu. Posebno su ranjivi domeni u kojima URL u fi코ing emailu izgleda legitimno, obmanjuju캖i korisnike i izbegavaju캖i spam filtere zbog inherentnog poverenja u domen.

Pogledajte ovaj [post za dodatne detalje](https://0xpatrik.com/subdomain-takeover/)

### **SSL sertifikati**
SSL sertifikati, ako ih napada캜i generi코u putem usluga kao 코to je [_Let's Encrypt_](https://letsencrypt.org/), doprinose legitimnosti ovih la쬹ih domena, 캜ine캖i fi코ing napade ubedljivijim.

### **Sigurnost kola캜i캖a i transparentnost pregleda캜a**
Transparentnost pregleda캜a se odnosi i na sigurnost kola캜i캖a, koju reguli코u politike poput [Politike istog porekla](https://en.wikipedia.org/wiki/Same-origin_policy). Kola캜i캖i, 캜esto kori코캖eni za upravljanje sesijama i 캜uvanje tokena za prijavu, mogu biti iskori코캖eni putem preuzimanja poddomena. Napada캜i mogu **prikupiti sesijske kola캜i캖e** jednostavno usmeravaju캖i korisnike na kompromitovani poddomen, ugro쬬vaju캖i podatke i privatnost korisnika.

### **Emailovi i preuzimanje poddomena**
Jo코 jedan aspekt preuzimanja poddomena uklju캜uje email usluge. Napada캜i mogu manipulisati **MX zapisima** kako bi primili ili poslali emailove sa legitimnog poddomena, pove캖avaju캖i efikasnost fi코ing napada.

### **Rizici vi코eg reda**
Dodatni rizici uklju캜uju **preuzimanje NS zapisa**. Ako napada캜 preuzme kontrolu nad jednim NS zapisom domena, mogu potencijalno usmeriti deo saobra캖aja na server pod njihovom kontrolom. Ovaj rizik se pove캖ava ako napada캜 postavi visok **TTL (Vreme 쬴vota)** za DNS zapise, produ쬬vaju캖i trajanje napada.

### Ranjivost CNAME zapisa
Napada캜i mogu iskoristiti neiskori코캖ene CNAME zapise koji pokazuju na eksterne usluge koje vi코e nisu u upotrebi ili su isklju캜ene. To im omogu캖ava da kreiraju stranicu pod pouzdanim domenom, 코to dodatno olak코ava fi코ing ili distribuciju malvera.

### **Strategije ubla쬬vanja**
Strategije ubla쬬vanja uklju캜uju:
1. **Uklanjanje ranjivih DNS zapisa** - Ovo je efikasno ako poddomen vi코e nije potreban.
2. **Preuzimanje imena domena** - Registracija resursa kod odgovaraju캖eg pru쬬oca usluga u oblaku ili ponovna kupovina isteklog domena.
3. **Redovno pra캖enje ranjivosti** - Alati poput [aquatone](https://github.com/michenriksen/aquatone) mogu pomo캖i u identifikaciji podlo쬹ih domena. Organizacije tako캠e treba da pregledaju svoje procese upravljanja infrastrukturom, obezbe캠uju캖i da kreiranje DNS zapisa bude poslednji korak u kreiranju resursa i prvi korak u uni코tavanju resursa.

Za pru쬬oce usluga u oblaku, va쬹o je verifikovati vlasni코tvo domena kako bi se spre캜ilo preuzimanje poddomena. Neki, poput [GitLab-a](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), su prepoznali ovaj problem i implementirali mehanizme za verifikaciju domena.

## Reference
* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** uz pomo캖 najnaprednijih alata zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
