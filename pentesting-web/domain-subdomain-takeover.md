# Preuzimanje domena/poddomena

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako kreirate i **automatizujete radne tokove** pokretane najnaprednijim alatima zajednice.\
Dobijte pristup danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Preuzimanje domena

Ako otkrijete neki domen (domen.tld) koji **koristi neka usluga unutar opsega** ali je **kompanija** izgubila **vlasni코tvo** nad njim, mo쬰te poku코ati da ga **registrujete** (ako je dovoljno jeftin) i obavestite kompaniju. Ako ovaj domen prima neke **osetljive informacije** poput sesijskog kola캜i캖a putem **GET** parametra ili u **Referer** zaglavlju, to je sigurno **ranjivost**.

### Preuzimanje poddomena

Poddomen kompanije pokazuje na **uslugu tre캖e strane sa imenom koje nije registrovano**. Ako mo쬰te **kreirati** nalog na ovoj **usluzi tre캖e strane** i **registrovati** ime koje se koristi, mo쬰te izvr코iti preuzimanje poddomena.

Postoje razni alati sa re캜nicima za proveru mogu캖ih preuzimanja:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

#### Skeniranje za poddomene podlo쬹e preuzimanju sa [BBOT](https://github.com/blacklanternsecurity/bbot):

Provere preuzimanja poddomena su uklju캜ene u podrazumevano prebrojavanje poddomena BBOT-a. Potpisi se direktno povla캜e sa [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Generisanje preuzimanja poddomena putem DNS zamke

Kada se koristi DNS zamka u domenu, bilo koji zahtevani poddomen tog domena koji nema eksplicitno drugu adresu **캖e biti re코en na iste informacije**. To mo쬰 biti A IP adresa, CNAME...

Na primer, ako je `*.testing.com` postavljen kao zamka na `1.1.1.1`. Tada 캖e `not-existent.testing.com` pokazivati ka `1.1.1.1`.

Me캠utim, ako umesto ka IP adresi, sistem administrator usmeri ka **tre캖oj stranoj usluzi putem CNAME**, kao 코to je **github poddomen** na primer (`sohomdatta1.github.io`). Napada캜 bi mogao **napraviti svoju tre캖u stranu stranicu** (u ovom slu캜aju na Gihubu) i re캖i da `something.testing.com` pokazuje tamo. Zato 코to 캖e **CNAME zamka** saglasiti, napada캜 캖e mo캖i **generisati proizvoljne poddomene za domen rtve koji pokazuju ka njegovim stranicama**.

Primer ove ranjivosti mo쬰te prona캖i u CTF izve코taju: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Iskori코캖avanje preuzimanja poddomena

Preuzimanje poddomena je su코tinski DNS spoofing za odre캠eni domen 코irom interneta, omogu캖avaju캖i napada캜ima da postave A zapise za domen, 코to dovodi do toga da pretra쬴va캜i prikazuju sadr쬬j sa servera napada캜a. Ova **transparentnost** u pretra쬴va캜ima 캜ini domene podlo쬹im phishingu. Napada캜i mogu koristiti [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) ili [_Doppelganger domene_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) u tu svrhu. Posebno ranjivi su domeni gde URL u phishing emailu izgleda legitimno, obmanjuju캖i korisnike i izbegavaju캖i spam filtere zbog inherentnog poverenja u domen.

Proverite ovaj [post za dodatne detalje](https://0xpatrik.com/subdomain-takeover/)

### **SSL Sertifikati**

SSL sertifikati, ako su generisani od strane napada캜a putem usluga poput [_Let's Encrypt_](https://letsencrypt.org/), doprinose legitimnosti ovih la쬹ih domena, 캜ine캖i phishing napade ubedljivijim.

### **Sigurnost kola캜i캖a i transparentnost pretra쬴va캜a**

Transparentnost pretra쬴va캜a se tako캠e odnosi na sigurnost kola캜i캖a, koju ure캠uju politike poput [Politike istog porekla](https://en.wikipedia.org/wiki/Same-origin\_policy). Kola캜i캖i, 캜esto kori코캖eni za upravljanje sesijama i 캜uvanje login tokena, mogu biti iskori코캖eni putem preuzimanja poddomena. Napada캜i mogu **prikupiti sesijske kola캜i캖e** jednostavno usmeravaju캖i korisnike ka kompromitovanom poddomenu, ugro쬬vaju캖i podatke i privatnost korisnika.

### **Emailovi i preuzimanje poddomena**

Jo코 jedan aspekt preuzimanja poddomena uklju캜uje email usluge. Napada캜i mogu manipulisati **MX zapisima** kako bi primili ili poslali emailove sa legitimnog poddomena, pobolj코avaju캖i efikasnost phishing napada.

### **Rizici vi코eg reda**

Dodatni rizici uklju캜uju **preuzimanje NS zapisa**. Ako napada캜 preuzme kontrolu nad jednim NS zapisom domena, potencijalno mo쬰 usmeriti deo saobra캖aja ka serveru pod njihovom kontrolom. Ovaj rizik se poja캜ava ako napada캜 postavi visok **TTL (Vreme 쬴vota)** za DNS zapise, produ쬬vaju캖i trajanje napada.

### Ranjivost CNAME zapisa

Napada캜i mogu iskoristiti neiskori코캖ene CNAME zapise koji pokazuju ka eksternim uslugama koje vi코e nisu u upotrebi ili su dekomisionisane. To im omogu캖ava da naprave stranicu pod pouzdanim domenom, dodatno olak코avaju캖i phishing ili distribuciju malvera.

### **Strategije ubla쬬vanja**

Strategije ubla쬬vanja uklju캜uju:

1. **Uklanjanje ranjivih DNS zapisa** - Ovo je efikasno ako poddomen vi코e nije potreban.
2. **Preuzimanje imena domena** - Registracija resursa kod odgovaraju캖eg provajdera u oblaku ili ponovna kupovina isteklog domena.
3. **Redovno pra캖enje ranjivosti** - Alati poput [aquatone](https://github.com/michenriksen/aquatone) mogu pomo캖i u identifikaciji podlo쬹ih domena. Organizacije tako캠e treba da revidiraju svoje procese upravljanja infrastrukturom, osiguravaju캖i da je kreiranje DNS zapisa poslednji korak u kreiranju resursa i prvi korak u uni코tavanju resursa.

Za provajdere u oblaku, provera vlasni코tva nad domenom je klju캜na kako bi se spre캜ilo preuzimanje poddomena. Neki, poput [GitLab-a](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), prepoznali su ovaj problem i implementirali mehanizme provere domena.

## Reference

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** pokretane najnaprednijim alatima zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
