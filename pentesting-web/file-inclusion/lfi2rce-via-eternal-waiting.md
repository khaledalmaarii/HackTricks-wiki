# LFI2RCE via Eternal waiting

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЬрдм рдПрдХ рдлрд╝рд╛рдЗрд▓ PHP рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рднрд▓реЗ рд╣реА рдЗрд╕рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рди рдХреА рдЬрд╛ рд░рд╣реА рд╣реЛ), рдпрд╣ `/tmp` рдореЗрдВ **`php[a-zA-Z0-9]{6}`** рдЬреИрд╕реЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдЧреА, рд╣рд╛рд▓рд╛рдБрдХрд┐ рдореИрдВрдиреЗ рдХреБрдЫ рдбреЙрдХрд░ рдЗрдореЗрдЬ рджреЗрдЦреА рд╣реИрдВ рдЬрд╣рд╛рдБ рдЙрддреНрдкрдиреНрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЕрдВрдХ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред

рдПрдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рдореЗрдВ, **рдпрджрд┐ рдЖрдк рдЙрд╕ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ RCE рдорд┐рд▓реЗрдЧрд╛**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **PHP рдХреЗрд╡рд▓ рдПрдХрд▓ рдЕрдиреБрд░реЛрдз рдореЗрдВ 20 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** (рдЬреЛ `/etc/php/<version>/apache2/php.ini` рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ):
```
; Maximum number of files that can be uploaded via a single request
max_file_uploads = 20
```
Also, the **рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 62\*62\*62\*62\*62\*62 = 56800235584** рд╣реИред

### рдЕрдиреНрдп рддрдХрдиреАрдХреЗрдВ

рдЕрдиреНрдп рддрдХрдиреАрдХреЗрдВ PHP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВ (рдЖрдк рдХреЗрд╡рд▓ рдкрде рдХреЗ рдЕрдВрддрд┐рдо рднрд╛рдЧ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдкрд░ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ), рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдирд╛, рдЕрдкреЗрдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛, рдпрд╛ **PHP рдХреЛ рд╡рд┐рднрд╛рдЬрди рджреЛрд╖ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛ рддрд╛рдХрд┐ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рди рдЬрд╛рдПрдВ**ред\
рдпрд╣ рддрдХрдиреАрдХ **рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдХреЗ рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рд╢реВрдиреНрдп рджрд┐рди рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред

### рд╢рд╛рд╢реНрд╡рдд рдкреНрд░рддреАрдХреНрд╖рд╛ рддрдХрдиреАрдХ

рдЗрд╕ рддрдХрдиреАрдХ рдореЗрдВ **рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╕рд╛рдкреЗрдХреНрд╖ рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рд╣рдо рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдФрд░ **LFI рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рди рд╣реЛрдиреЗ** рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдФрд░ **рдЦреЛрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП "рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп" рд╣реЛрдЧрд╛ред

**рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рд▓рд╛рдн**:

* рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ рд╢рд╛рдорд┐рд▓ рдореЗрдВ рдПрдХ рд╕рд╛рдкреЗрдХреНрд╖ рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП nginx рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрддрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ
* рд╡рд┐рднрд╛рдЬрди рджреЛрд╖ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 0 рджрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ
* рдкрде рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ

рдЗрд╕ рддрдХрдиреАрдХ рдХреА **рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛рдПрдБ** рд╣реИрдВ:

* рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓(рдлрд╛рдЗрд▓реЛрдВ) рдХрд╛ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ (рдФрд░ рднреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ)
* **рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХреА** **рдЕрд╕рд╛рдзрд╛рд░рдг** рдорд╛рддреНрд░рд╛: **56800235584**
* рдпрджрд┐ рд╕рд░реНрд╡рд░ **рдЕрдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ** рддреЛ рдХреБрд▓ рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рддреНрд░рд╛: **19770609664**
* рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рдХреЗрд╡рд▓ 20 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдПрдХ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рд░реНрд╡рд░ рдХреЗ **рд╕рдорд╛рдирд╛рдВрддрд░ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛рдУрдВ рдХреА рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛**ред
* рдкрд┐рдЫрд▓реЗ рд╕реАрдорд╛рдУрдВ рдХреЗ рд╕рд╛рде рдпрд╣ рд╕реАрдорд╛ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдмрд╣реБрдд рд▓рдВрдмрд╛ рдмрдирд╛ рд╕рдХрддреА рд╣реИ
* **PHP рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд╕рдордп рд╕рдорд╛рдкреНрддрд┐**ред рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рдпрд╣ рд╢рд╛рд╢реНрд╡рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рдЕрд╕реНрдерд╛рдпреА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛рдП рдмрд┐рдирд╛ PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдпрд╣ рднреА рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реЛрдЧреА

рддреЛ, рдЖрдк **PHP рд╢рд╛рдорд┐рд▓ рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ **рдмрдирд╛рддреЗ рд╣реИрдВ**? рдмрд╕ рдлрд╝рд╛рдЗрд▓ **`/sys/kernel/security/apparmor/revision`** рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ (**рджреБрд░реНрднрд╛рдЧреНрдпрд╡рд╢, рдпрд╣ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ...**)ред

рдмрд╕ рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рдХреЗ рдЖрдЬрдорд╛рдПрдВ:
```bash
php -a # open php cli
include("/sys/kernel/security/apparmor/revision");
```
## Apache2

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Apache **150 рд╕рдорд╡рд░реНрддреА рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, [https://ubiq.co/tech-blog/increase-max-connections-apache/](https://ubiq.co/tech-blog/increase-max-connections-apache/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЗрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЛ 8000 рддрдХ рдмрдврд╝рд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЙрд╕ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде PHP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ: [https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04)ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, (рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВ рдЕрдкрдиреЗ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реВрдБ), рдПрдХ **PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдирдВрддрдХрд╛рд▓ рддрдХ рдЪрд▓ рд╕рдХрддреА рд╣реИ**ред

рдЪрд▓реЛ рдХреБрдЫ рдЧрдгрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:

* рд╣рдо **149 рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **149 \* 20 = 2980 рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдлрд┐рд░, **рдЕрдВрддрд┐рдо рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕** рдХрд░реЗрдВред
* **10 рдЕрдиреБрд░реЛрдз/рд╕реЗрдХрдВрдб** рдХреА рдЧрддрд┐ рдкрд░ рд╕рдордп рд╣реИрдВ:
* 56800235584 / 2980 / 10 / 3600 \~= **530 рдШрдВрдЯреЗ** (265 рдШрдВрдЯреЗ рдореЗрдВ 50% рд╕рдВрднрд╛рд╡рдирд╛)
* (рдЕрдВрдХ рдХреЗ рдмрд┐рдирд╛) 19770609664 / 2980 / 10 / 3600 \~= 185 рдШрдВрдЯреЗ (93 рдШрдВрдЯреЗ рдореЗрдВ 50% рд╕рдВрднрд╛рд╡рдирд╛)

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо **рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ DoSing рдХрд░ рд░рд╣реЗ рд╣реИрдВ**!
{% endhint %}

рдпрджрд┐ Apache рд╕рд░реНрд╡рд░ рдХреЛ рд╕реБрдзрд╛рд░рд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╣рдо **4000 рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЖрдзреЗ рд░рд╛рд╕реНрддреЗ)ред рд╣рдо `3999*20 = 79980` **рдлрд╝рд╛рдЗрд▓реЗрдВ** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╕рдВрдЦреНрдпрд╛** рд▓рдЧрднрдЧ **19.7 рдШрдВрдЯреЗ** рдпрд╛ **6.9 рдШрдВрдЯреЗ** (10 рдШрдВрдЯреЗ, 3.5 рдШрдВрдЯреЗ 50% рд╕рдВрднрд╛рд╡рдирд╛) рддрдХ **рдХрдо** рд╣реЛ рдЬрд╛рдПрдЧреАред

## PHP-FMP

рдпрджрд┐ Apache рдХреЗ рд▓рд┐рдП рдирд┐рдпрдорд┐рдд PHP рдореЙрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп **рд╡реЗрдм рдкреГрд╖реНрда** **PHP-FMP** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ (рдпрд╣ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рджрдХреНрд╖рддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдкрд╛рдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ), рддреЛ рддрдХрдиреАрдХ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдФрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

PHP-FMP **`request_terminate_timeout`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`/etc/php/<php-version>/fpm/pool.d/www.conf`** рдореЗрдВ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдзрд┐рдХрддрдо рд╕реЗрдХрдВрдб рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ **рдЬрдм** **PHP рдХреЛ рдЕрдиреБрд░реЛрдз рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдирдВрдд, рд▓реЗрдХрд┐рди **рдпрджрд┐ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рддреЛ 30 рд╕реЗрдХрдВрдб**)ред рдЬрдм PHP рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕реЗрдХрдВрдб рдореЗрдВ, рдЗрд╕реЗ **рдорд╛рд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдХрд┐ рдпрджрд┐ рдЕрдиреБрд░реЛрдз рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд░рд╣рд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ **PHP рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд░реЛрдХ рджреА рдЧрдИ рдереА**, рддреЛ рдЙрди **рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдЙрд╕ рд╕рдордп рддрдХ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдмрдирд╛рдП рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рд╣рдЬрд╛рд░реЛрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдирд╣реАрдВ рд╣рдЯреЗрдВрдЧреА, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рддреЗрдЬрд╝** рдХрд░рддреА рд╣реИ рдФрд░ рд╕рднреА рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рдХреЗ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдкрд░ DoS рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдХрдо рдХрд░рддреА рд╣реИред

рддреЛ, **DoS рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП** рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдХреЗрд╡рд▓ 100 рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ PHP рдЕрдзрд┐рдХрддрдо рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╕рдордп **php-fmp** (`request_terminate_timeout`**) **30 рд╕реЗрдХрдВрдб** рд╣реИред рдЗрд╕рд▓рд┐рдП, рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдЙрддреНрдкрдиреНрди рд╣реЛрдиреЗ рд╡рд╛рд▓реА **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ `100*20/30 = 66.67`ред

рдлрд┐рд░, **10000 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЪрд╛рд╣рд┐рдП: **`10000/66.67 = 150 рд╕реЗрдХрдВрдб`** ( **100000 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп **25 рдорд┐рдирдЯ** рд╣реЛрдЧрд╛)ред

рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдЙрди **100 рдХрдиреЗрдХреНрд╢рдиреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдЦреЛрдЬ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред \*\*\*\* 300 req/s рдХреА рдЧрддрд┐ рдорд╛рдирддреЗ рд╣реБрдП, рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

* 56800235584 / 10000 / 300 / 3600 \~= **5.25 рдШрдВрдЯреЗ** (2.63 рдШрдВрдЯреЗ рдореЗрдВ 50% рд╕рдВрднрд╛рд╡рдирд╛)
* (100000 рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде) 56800235584 / 100000 / 300 / 3600 \~= **0.525 рдШрдВрдЯреЗ** (0.263 рдШрдВрдЯреЗ рдореЗрдВ 50% рд╕рдВрднрд╛рд╡рдирд╛)

рд╣рд╛рдБ, рдПрдХ EC2 рдордзреНрдпрдо рдЖрдХрд╛рд░ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ 100000 рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:

<figure><img src="../../.gitbook/assets/image (240).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХрдордЬреЛрд░ LFI рдкреГрд╖реНрда рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛**, рддрд╛рдХрд┐ рдпрд╣ рдЕрдирдВрдд рд╢рд╛рдорд┐рд▓ рд▓реВрдк рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХреЗред
{% endhint %}

## Nginx

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ Nginx **512 рд╕рдорд╛рдирд╛рдВрддрд░ рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ (рдФрд░ рдЗрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)ред

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
{% endhint %}
