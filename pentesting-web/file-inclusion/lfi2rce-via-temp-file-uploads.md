{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}



**Proverite sve detalje ove tehnike na [https://gynvael.coldwind.pl/download.php?f=PHP\_LFI\_rfc1867\_temporary\_files.pdf](https://gynvael.coldwind.pl/download.php?f=PHP\_LFI\_rfc1867\_temporary\_files.pdf)**

## **PHP U캜itavanje fajlova**

Kada **PHP** engine primi **POST zahtev** koji sadr쬴 fajlove formatirane prema RFC 1867, generi코e privremene fajlove za skladi코tenje u캜itanih podataka. Ovi fajlovi su klju캜ni za rukovanje u캜itavanjem fajlova u PHP skriptama. Funkcija `move_uploaded_file` mora se koristiti za premestiti ove privremene fajlove na 쬰ljenu lokaciju ako je potrebno trajno skladi코tenje nakon izvr코enja skripte. Nakon izvr코enja, PHP automatski bri코e sve preostale privremene fajlove.

{% hint style="info" %}
**Bezbednosna upozorenje: Napada캜i, svesni lokacije privremenih fajlova, mogu iskoristiti ranjivost Local File Inclusion da izvr코e kod pristupaju캖i fajlu tokom u캜itavanja.**
{% endhint %}

Izazov za neovla코캖en pristup le쬴 u predvi캠anju imena privremenog fajla, koje je namerno nasumi캜no.

#### Eksploatacija na Windows sistemima

Na Windows-u, PHP generi코e imena privremenih fajlova koriste캖i funkciju `GetTempFileName`, 코to rezultira obrascem poput `<path>\<pre><uuuu>.TMP`. Zna캜ajno:

- Podrazumevana putanja je obi캜no `C:\Windows\Temp`.
- Prefiks je obi캜no "php".
- `<uuuu>` predstavlja jedinstvenu heksadecimalnu vrednost. Klju캜no, zbog ograni캜enja funkcije, koristi se samo donjih 16 bita, 코to omogu캖ava maksimalno 65,535 jedinstvenih imena sa konstantnom putanjom i prefiksom, 코to 캜ini brute force izvodljivim.

맚avi코e, proces eksploatacije je pojednostavljen na Windows sistemima. Osobina u funkciji `FindFirstFile` omogu캖ava kori코캖enje d쬺kera u Local File Inclusion (LFI) putanjama. Ovo omogu캖ava kreiranje putanje za uklju캜ivanje poput slede캖e kako bi se locirao privremeni fajl:
```
http://site/vuln.php?inc=c:\windows\temp\php<<
```
U odre캠enim situacijama, mo쬰 biti potrebna specifi캜nija maska (kao 코to su `php1<<` ili `phpA<<`). Mo쬰 se sistematski poku코ati sa ovim maskama kako bi se otkrio otpremljeni privremeni fajl.

#### Eksploatacija na GNU/Linux sistemima

Za GNU/Linux sisteme, nasumi캜nost u imenovanju privremenih fajlova je robusna, 코to imena 캜ini ni predvidivim ni podlo쬹im napadima silom. Dodatne informacije mogu se na캖i u referenciranoj dokumentaciji.
