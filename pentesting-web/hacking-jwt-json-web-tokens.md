# JWT AÃ§Ä±klarÄ± (Json Web Tokens)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Hacking kariyerine** ilgi duyuyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± LehÃ§e yazÄ±lÄ± ve sÃ¶zlÃ¼ gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

**Bu yazÄ±nÄ±n bir kÄ±smÄ± harika bir yazÄ±ya dayanmaktadÄ±r:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWT'leri pentest etmek iÃ§in harika aracÄ±n yazarÄ±** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **HÄ±zlÄ± KazanÃ§lar**

`All Tests!` modunda [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) Ã§alÄ±ÅŸtÄ±rÄ±n ve yeÅŸil satÄ±rlarÄ± bekleyin.
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
EÄŸer ÅŸanslÄ±ysanÄ±z, araÃ§ web uygulamasÄ±nÄ±n JWT'yi yanlÄ±ÅŸ kontrol ettiÄŸi bir durumu bulacaktÄ±r:

![](<../.gitbook/assets/image (935).png>)

Sonra, isteÄŸi proxy'nizde arayabilir veya o istek iÃ§in kullanÄ±lan JWT'yi jwt\_ tool ile dÃ¶kebilirsiniz:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
You can also use the [**Burp Extension SignSaboteur**](https://github.com/d0ge/sign-saboteur) to launch JWT attacks from Burp.

### HiÃ§bir ÅŸeyi deÄŸiÅŸtirmeden veriyi manipÃ¼le et

Sadece veriyi manipÃ¼le edebilir, imzayÄ± olduÄŸu gibi bÄ±rakabilir ve sunucunun imzayÄ± kontrol edip etmediÄŸini kontrol edebilirsiniz. Ã–rneÄŸin, kullanÄ±cÄ± adÄ±nÄ±zÄ± "admin" olarak deÄŸiÅŸtirmeyi deneyin.

#### **Token kontrol ediliyor mu?**

Bir JWT'nin imzasÄ±nÄ±n doÄŸrulanÄ±p doÄŸrulanmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in:

* Devam eden doÄŸrulamayÄ± Ã¶neren bir hata mesajÄ±; ayrÄ±ntÄ±lÄ± hatalardaki hassas bilgiler gÃ¶zden geÃ§irilmelidir.
* DÃ¶nen sayfadaki bir deÄŸiÅŸiklik de doÄŸrulamayÄ± gÃ¶sterir.
* DeÄŸiÅŸiklik yoksa, doÄŸrulama yok demektir; bu, payload iddialarÄ±nÄ± manipÃ¼le etmek iÃ§in deneme yapma zamanÄ±dÄ±r.

### KÃ¶ken

Token'Ä±n sunucu tarafÄ±nda mÄ± yoksa istemci tarafÄ±nda mÄ± oluÅŸturulduÄŸunu belirlemek iÃ§in proxy'nin istek geÃ§miÅŸini incelemek Ã¶nemlidir.

* Ä°stemci tarafÄ±nda ilk kez gÃ¶rÃ¼len token'lar, anahtarÄ±n istemci tarafÄ± koduna maruz kalabileceÄŸini gÃ¶sterir ve daha fazla araÅŸtÄ±rma gerektirir.
* Sunucu tarafÄ±nda kaynaklanan token'lar, gÃ¼venli bir sÃ¼reci gÃ¶sterir.

### SÃ¼re

Token'Ä±n 24 saatten fazla sÃ¼rÃ¼p sÃ¼rmediÄŸini kontrol edin... belki de hiÃ§ sÃ¼resi dolmuyor. "exp" alanÄ± varsa, sunucunun bunu doÄŸru bir ÅŸekilde iÅŸleyip iÅŸlemediÄŸini kontrol edin.

### Brute-force HMAC gizli anahtarÄ±

[**Bu sayfaya bakÄ±n.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### AlgoritmayÄ± None olarak deÄŸiÅŸtir

KullanÄ±lan algoritmayÄ± "None" olarak ayarlayÄ±n ve imza kÄ±smÄ±nÄ± kaldÄ±rÄ±n.

Bu aÃ§Ä±ÄŸÄ± denemek ve JWT iÃ§indeki farklÄ± deÄŸerleri deÄŸiÅŸtirmek iÃ§in "JSON Web Token" adlÄ± Burp eklentisini kullanÄ±n (isteÄŸi Repeater'a gÃ¶nderin ve "JSON Web Token" sekmesinde token'Ä±n deÄŸerlerini deÄŸiÅŸtirebilirsiniz. "Alg" alanÄ±nÄ±n deÄŸerini "None" olarak ayarlamak iÃ§in de seÃ§ebilirsiniz).

### AlgoritmayÄ± RS256 (asimetrik) yerine HS256 (simetrik) olarak deÄŸiÅŸtirin (CVE-2016-5431/CVE-2016-10555)

HS256 algoritmasÄ±, her mesajÄ± imzalamak ve doÄŸrulamak iÃ§in gizli anahtarÄ± kullanÄ±r.\
RS256 algoritmasÄ±, mesajÄ± imzalamak iÃ§in Ã¶zel anahtarÄ± kullanÄ±r ve kimlik doÄŸrulama iÃ§in genel anahtarÄ± kullanÄ±r.

AlgoritmayÄ± RS256'dan HS256'ya deÄŸiÅŸtirirseniz, arka uÃ§ kodu genel anahtarÄ± gizli anahtar olarak kullanÄ±r ve ardÄ±ndan imzayÄ± doÄŸrulamak iÃ§in HS256 algoritmasÄ±nÄ± kullanÄ±r.

Sonra, genel anahtarÄ± kullanarak ve RS256'yÄ± HS256'ya deÄŸiÅŸtirerek geÃ§erli bir imza oluÅŸturabiliriz. Bunu gerÃ§ekleÅŸtiren web sunucusunun sertifikasÄ±nÄ± alabilirsiniz:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### Yeni kamu anahtarÄ± baÅŸlÄ±kta

Bir saldÄ±rgan, token'Ä±n baÅŸlÄ±ÄŸÄ±na yeni bir anahtar yerleÅŸtirir ve sunucu bu yeni anahtarÄ± imzayÄ± doÄŸrulamak iÃ§in kullanÄ±r (CVE-2018-0114).

Bu, "JSON Web Tokens" Burp eklentisi ile yapÄ±labilir.\
(IsteÄŸi Repeater'a gÃ¶nderin, JSON Web Token sekmesinde "CVE-2018-0114" seÃ§in ve isteÄŸi gÃ¶nderin).

### JWKS Spoofing

Talimatlar, Ã¶zellikle "jku" baÅŸlÄ±k iddiasÄ±nÄ± kullanan JWT token'larÄ±nÄ±n gÃ¼venliÄŸini deÄŸerlendirmek iÃ§in bir yÃ¶ntem detaylandÄ±rmaktadÄ±r. Bu iddia, token'Ä±n doÄŸrulamasÄ± iÃ§in gerekli olan kamu anahtarÄ±nÄ± iÃ§eren bir JWKS (JSON Web Key Set) dosyasÄ±na baÄŸlantÄ± saÄŸlamalÄ±dÄ±r.

* **"jku" BaÅŸlÄ±ÄŸÄ± ile Token'larÄ± DeÄŸerlendirme**:
* "jku" iddiasÄ±nÄ±n URL'sini doÄŸrulayarak uygun JWKS dosyasÄ±na yÃ¶nlendirdiÄŸinden emin olun.
* Token'Ä±n "jku" deÄŸerini, trafiÄŸi gÃ¶zlemlemek iÃ§in kontrol edilen bir web hizmetine yÃ¶nlendirecek ÅŸekilde deÄŸiÅŸtirin.
* **HTTP EtkileÅŸimini Ä°zleme**:
* Belirtilen URL'nize yapÄ±lan HTTP isteklerini gÃ¶zlemlemek, sunucunun saÄŸladÄ±ÄŸÄ±nÄ±z baÄŸlantÄ±dan anahtarlarÄ± almaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶sterir.
* Bu sÃ¼reÃ§te `jwt_tool` kullanÄ±rken, testin kolaylaÅŸtÄ±rÄ±lmasÄ± iÃ§in kiÅŸisel JWKS konumunuzu `jwtconf.ini` dosyasÄ±nÄ± gÃ¼ncelleyerek belirtmek Ã¶nemlidir.
* **`jwt_tool` iÃ§in Komut**:
* `jwt_tool` ile senaryoyu simÃ¼le etmek iÃ§in aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rÄ±n:

```bash
python3 jwt_tool.py JWT_HERE -X s
```

### Kid SorunlarÄ± Genel GÃ¶rÃ¼nÃ¼mÃ¼

`kid` olarak bilinen isteÄŸe baÄŸlÄ± bir baÅŸlÄ±k iddiasÄ±, belirli bir anahtarÄ± tanÄ±mlamak iÃ§in kullanÄ±lÄ±r ve bu, token imza doÄŸrulamasÄ± iÃ§in birden fazla anahtarÄ±n bulunduÄŸu ortamlarda Ã¶zellikle Ã¶nemlidir. Bu iddia, bir token'Ä±n imzasÄ±nÄ± doÄŸrulamak iÃ§in uygun anahtarÄ±n seÃ§ilmesine yardÄ±mcÄ± olur.

#### "kid" ile AnahtarÄ±n Ortaya Ã‡Ä±kmasÄ±

`kid` iddiasÄ± baÅŸlÄ±kta mevcut olduÄŸunda, karÅŸÄ±lÄ±k gelen dosya veya varyasyonlarÄ± iÃ§in web dizininde arama yapmasÄ± Ã¶nerilir. Ã–rneÄŸin, `"kid":"key/12345"` belirtilmiÅŸse, web kÃ¶kÃ¼nde _/key/12345_ ve _/key/12345.pem_ dosyalarÄ± aranmalÄ±dÄ±r.

#### "kid" ile Yol GeÃ§iÅŸi

`kid` iddiasÄ±, dosya sisteminde gezinmek iÃ§in de istismar edilebilir ve bu da rastgele bir dosyanÄ±n seÃ§ilmesine olanak tanÄ±yabilir. Belirli dosyalar veya hizmetler hedeflenerek `kid` deÄŸerini deÄŸiÅŸtirerek baÄŸlantÄ±yÄ± test etmek veya Sunucu TarafÄ± Ä°stek SahteciliÄŸi (SSRF) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r. JWT'yi, orijinal imzayÄ± koruyarak `kid` deÄŸerini deÄŸiÅŸtirmek iÃ§in `-T` bayraÄŸÄ±nÄ± kullanarak deÄŸiÅŸtirmek mÃ¼mkÃ¼ndÃ¼r, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
By targeting files with predictable content, it's possible to forge a valid JWT. For instance, the `/proc/sys/kernel/randomize_va_space` file in Linux systems, known to contain the value **2**, can be used in the `kid` parameter with **2** as the symmetric password for JWT generation.

#### SQL Injection via "kid"

If the `kid` claim's content is employed to fetch a password from a database, an SQL injection could be facilitated by modifying the `kid` payload. An example payload that uses SQL injection to alter the JWT signing process includes:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

This alteration forces the use of a known secret key, `ATTACKER`, for JWT signing.

#### OS Injection through "kid"

A scenario where the `kid` parameter specifies a file path used within a command execution context could lead to Remote Code Execution (RCE) vulnerabilities. By injecting commands into the `kid` parameter, it's possible to expose private keys. An example payload for achieving RCE and key exposure is:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u and jku

#### jku

jku, **JWK Set URL** anlamÄ±na gelir.\
EÄŸer token â€œ**jku**â€ **Header** claim'ini kullanÄ±yorsa, o zaman **saÄŸlanan URL'yi kontrol edin**. Bu, token'Ä± doÄŸrulamak iÃ§in Public Key'i iÃ§eren JWKS dosyasÄ±nÄ± barÄ±ndÄ±ran bir URL'ye iÅŸaret etmelidir. Token'Ä±, jku deÄŸerini trafiÄŸi izleyebileceÄŸiniz bir web servisine yÃ¶nlendirecek ÅŸekilde deÄŸiÅŸtirin.

Ã–ncelikle yeni Ã¶zel ve genel anahtarlarla yeni bir sertifika oluÅŸturmanÄ±z gerekiyor.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Sonra, Ã¶rneÄŸin [**jwt.io**](https://jwt.io) kullanarak **oluÅŸturulan genel ve Ã¶zel anahtarlarla yeni bir JWT oluÅŸturabilir ve jku parametresini oluÅŸturulan sertifikaya yÃ¶nlendirebilirsiniz.** GeÃ§erli bir jku sertifikasÄ± oluÅŸturmak iÃ§in orijinalini indirebilir ve gerekli parametreleri deÄŸiÅŸtirebilirsiniz.

"e" ve "n" parametrelerini bir genel sertifikadan ÅŸu ÅŸekilde alabilirsiniz:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. PEM formatÄ±nda kodlanmÄ±ÅŸ bir dizi X.509 (bir sertifika format standardÄ±) genel sertifikasÄ±na iÅŸaret eden bir URI. Set iÃ§indeki ilk sertifika, bu JWT'yi imzalamak iÃ§in kullanÄ±lan sertifika olmalÄ±dÄ±r. ArdÄ±ÅŸÄ±k sertifikalar, her biri bir Ã¶ncekini imzalayarak sertifika zincirini tamamlar. X.509, RFC 52807'de tanÄ±mlanmÄ±ÅŸtÄ±r. SertifikalarÄ±n aktarÄ±mÄ± iÃ§in taÅŸÄ±ma gÃ¼venliÄŸi gereklidir.

**Bu baÅŸlÄ±ÄŸÄ± kontrolÃ¼nÃ¼z altÄ±ndaki bir URL ile deÄŸiÅŸtirin** ve herhangi bir isteÄŸin alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol edin. Bu durumda **JWT'yi deÄŸiÅŸtirebilirsiniz**.

KontrolÃ¼nÃ¼z altÄ±ndaki bir sertifika kullanarak yeni bir token oluÅŸturmak iÃ§in, sertifikayÄ± oluÅŸturmanÄ±z ve genel ile Ã¶zel anahtarlarÄ± Ã§Ä±karmanÄ±z gerekir:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
Sonra, Ã¶rneÄŸin [**jwt.io**](https://jwt.io) kullanarak **oluÅŸturulan genel ve Ã¶zel anahtarlarla yeni bir JWT oluÅŸturabilir ve x5u parametresini oluÅŸturulan .crt sertifikasÄ±na yÃ¶nlendirebilirsiniz.**

![](<../.gitbook/assets/image (956).png>)

Bu iki gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± da **SSRF'ler iÃ§in** kÃ¶tÃ¼ye kullanabilirsiniz.

#### x5c

Bu parametre **base64 formatÄ±nda sertifika** iÃ§erebilir:

![](<../.gitbook/assets/image (1119).png>)

EÄŸer saldÄ±rgan **kendinden imzalÄ± bir sertifika oluÅŸturursa** ve ilgili Ã¶zel anahtarÄ± kullanarak sahte bir token oluÅŸturursa ve "x5c" parametresinin deÄŸerini yeni oluÅŸturulan sertifika ile deÄŸiÅŸtirip diÄŸer parametreleri, yani n, e ve x5t'yi deÄŸiÅŸtirirse, esasen sahte token sunucu tarafÄ±ndan kabul edilecektir.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### GÃ¶mÃ¼lÃ¼ Genel Anahtar (CVE-2018-0114)

EÄŸer JWT, aÅŸaÄŸÄ±daki senaryodaki gibi gÃ¶mÃ¼lÃ¼ bir genel anahtara sahipse:

![](<../.gitbook/assets/image (624).png>)

AÅŸaÄŸÄ±daki nodejs betiÄŸini kullanarak bu verilerden bir genel anahtar oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
Yeni bir Ã¶zel/genel anahtar oluÅŸturmak, yeni genel anahtarÄ± token iÃ§ine gÃ¶mmek ve bunu yeni bir imza oluÅŸturmak iÃ§in kullanmak mÃ¼mkÃ¼ndÃ¼r:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Bu nodejs betiÄŸini kullanarak "n" ve "e" deÄŸerlerini elde edebilirsiniz:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
Son olarak, kamu ve Ã¶zel anahtarÄ± ve yeni "n" ve "e" deÄŸerlerini kullanarak [jwt.io](https://jwt.io) ile herhangi bir bilgiyle yeni geÃ§erli bir JWT oluÅŸturabilirsiniz.

### ES256: AynÄ± nonce ile Ã¶zel anahtarÄ±n ifÅŸa edilmesi

BazÄ± uygulamalar ES256 kullanÄ±yorsa ve iki jwt oluÅŸturmak iÃ§in aynÄ± nonce kullanÄ±yorsa, Ã¶zel anahtar geri yÃ¼klenebilir.

Ä°ÅŸte bir Ã¶rnek: [ECDSA: AynÄ± nonce kullanÄ±ldÄ±ÄŸÄ±nda Ã¶zel anahtarÄ±n ifÅŸa edilmesi (SECP256k1 ile)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT ID)

JTI (JWT ID) talebi, bir JWT Token iÃ§in benzersiz bir tanÄ±mlayÄ±cÄ± saÄŸlar. Token'Ä±n yeniden oynatÄ±lmasÄ±nÄ± Ã¶nlemek iÃ§in kullanÄ±labilir.\
Ancak, ID'nin maksimum uzunluÄŸunun 4 (0001-9999) olduÄŸu bir durumu hayal edin. 0001 ve 10001 istekleri aynÄ± ID'yi kullanacak. Bu nedenle, arka uÃ§ her istekte ID'yi artÄ±rÄ±yorsa, bunu **bir isteÄŸi yeniden oynatmak** iÃ§in kÃ¶tÃ¼ye kullanabilirsiniz (her baÅŸarÄ±lÄ± yeniden oynatma arasÄ±nda 10000 istek gÃ¶ndermeniz gerekecek).

### JWT KayÄ±tlÄ± talepleri

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### DiÄŸer saldÄ±rÄ±lar

**Hizmetler ArasÄ± Ä°letim SaldÄ±rÄ±larÄ±**

BazÄ± web uygulamalarÄ±nÄ±n token'larÄ±nÄ±n oluÅŸturulmasÄ± ve yÃ¶netimi iÃ§in gÃ¼venilir bir JWT hizmetine gÃ¼vendiÄŸi gÃ¶zlemlenmiÅŸtir. JWT hizmeti tarafÄ±ndan bir istemci iÃ§in oluÅŸturulan bir token'Ä±n, aynÄ± JWT hizmetinin baÅŸka bir istemcisi tarafÄ±ndan kabul edildiÄŸi durumlar kaydedilmiÅŸtir. ÃœÃ§Ã¼ncÃ¼ taraf bir hizmet aracÄ±lÄ±ÄŸÄ±yla bir JWT'nin verilmesi veya yenilenmesi gÃ¶zlemlenirse, aynÄ± kullanÄ±cÄ± adÄ±/e-posta ile o hizmetin baÅŸka bir istemcisinde bir hesap aÃ§ma olasÄ±lÄ±ÄŸÄ± araÅŸtÄ±rÄ±lmalÄ±dÄ±r. ArdÄ±ndan, elde edilen token'Ä± hedefe bir istekte yeniden oynatma giriÅŸiminde bulunulmalÄ±dÄ±r.

* Token'Ä±nÄ±zÄ±n kabul edilmesi, herhangi bir kullanÄ±cÄ±nÄ±n hesabÄ±nÄ±n taklit edilmesine olanak tanÄ±yabileceÄŸinden kritik bir sorun olabilir. Ancak, Ã¼Ã§Ã¼ncÃ¼ taraf bir uygulamada kayÄ±t olmanÄ±n daha geniÅŸ testler iÃ§in izin gerektirebileceÄŸi unutulmamalÄ±dÄ±r, Ã§Ã¼nkÃ¼ bu yasal bir gri alana girebilir.

**Token'larÄ±n SÃ¼re KontrolÃ¼**

Token'Ä±n sÃ¼resi "exp" Payload talebi kullanÄ±larak kontrol edilir. JWT'lerin genellikle oturum bilgisi olmadan kullanÄ±ldÄ±ÄŸÄ± gÃ¶z Ã¶nÃ¼ne alÄ±ndÄ±ÄŸÄ±nda, dikkatli bir ÅŸekilde ele alÄ±nmasÄ± gerekmektedir. BirÃ§ok durumda, baÅŸka bir kullanÄ±cÄ±nÄ±n JWT'sini yakalamak ve yeniden oynatmak, o kullanÄ±cÄ±nÄ±n taklit edilmesine olanak tanÄ±yabilir. JWT RFC, token iÃ§in bir son tarih ayarlamak amacÄ±yla "exp" talebinin kullanÄ±lmasÄ±nÄ± Ã¶nerir. AyrÄ±ca, uygulamanÄ±n bu deÄŸerin iÅŸlenmesini saÄŸlamak ve sÃ¼resi dolmuÅŸ token'larÄ± reddetmek iÃ§in ilgili kontrolleri uygulamasÄ± Ã¶nemlidir. Token "exp" talebini iÃ§eriyorsa ve test sÃ¼releri izin veriyorsa, token'Ä± saklamak ve sÃ¼resi dolduktan sonra yeniden oynatmak Ã¶nerilir. Token'Ä±n iÃ§eriÄŸi, zaman damgasÄ± ayrÄ±ÅŸtÄ±rma ve sÃ¼re kontrolÃ¼ (UTC'deki zaman damgasÄ±) jwt_tool'Ã¼n -R bayraÄŸÄ± kullanÄ±larak okunabilir.

* Uygulama hala token'Ä± doÄŸruluyorsa, bu durum bir gÃ¼venlik riski oluÅŸturabilir, Ã§Ã¼nkÃ¼ bu, token'Ä±n asla sÃ¼resinin dolmayabileceÄŸini ima edebilir.

### AraÃ§lar

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**hackleme kariyeri** ile ilgileniyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± LehÃ§e yazÄ±lÄ± ve sÃ¶zlÃ¼ gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** bizi takip edin ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hackleme ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
