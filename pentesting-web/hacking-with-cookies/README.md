# Ã‡erez Hacking

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek.

</details>

## Ã‡erez Ã–zellikleri

Ã‡erezler, kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±ndaki davranÄ±ÅŸlarÄ±nÄ± kontrol eden birkaÃ§ Ã¶zellikle birlikte gelir. Ä°ÅŸte bu Ã¶zelliklerin bir Ã¶zetini daha pasif bir sesle aÃ§Ä±klayanlar:

### Expires ve Max-Age

Bir Ã§erezin son kullanma tarihi, `Expires` Ã¶zelliÄŸi tarafÄ±ndan belirlenir. Buna karÅŸÄ±lÄ±k, `Max-age` Ã¶zelliÄŸi bir Ã§erezin silineceÄŸi sÃ¼reyi saniye cinsinden tanÄ±mlar. **Daha modern uygulamalarÄ± yansÄ±ttÄ±ÄŸÄ± iÃ§in `Max-age`'i tercih edin.**

### Domain

Bir Ã§erezi alacak ana bilgisayarlar, `Domain` Ã¶zelliÄŸi tarafÄ±ndan belirtilir. VarsayÄ±lan olarak, bu, Ã§erezi veren ana bilgisayara ayarlanÄ±r, alt alanlarÄ±nÄ± iÃ§ermez. Ancak, `Domain` Ã¶zelliÄŸi aÃ§Ä±kÃ§a belirlendiÄŸinde, alt alanlarÄ± da kapsar. Bu, `Domain` Ã¶zelliÄŸinin belirtilmesini, alt alanlar arasÄ±nda Ã§erez paylaÅŸÄ±mÄ±nÄ±n gerektiÄŸi senaryolar iÃ§in daha az kÄ±sÄ±tlayÄ±cÄ± bir seÃ§enek haline getirir. Ã–rneÄŸin, `Domain=mozilla.org` ayarlanarak, Ã§erezlerin `developer.mozilla.org` gibi alt alanlarda eriÅŸilebilir olmasÄ±nÄ± saÄŸlar.

### Path

`Path` Ã¶zelliÄŸi, gÃ¶nderilen URL'de bulunmasÄ± gereken belirli bir URL yolunu gÃ¶sterir. Bu Ã¶zellik, `/` karakterini bir dizin ayÄ±rÄ±cÄ± olarak kabul eder, alt dizinlerde eÅŸleÅŸmelere izin verir.

### SÄ±ralama KurallarÄ±

AynÄ± isme sahip iki Ã§erez olduÄŸunda, gÃ¶nderim iÃ§in seÃ§ilen Ã§erez ÅŸu kriterlere dayanÄ±r:

* Ä°stenen URL'deki en uzun yola uyan Ã§erez.
* Yollar aynÄ±ysa, en son ayarlanan Ã§erez.

### SameSite

* `SameSite` Ã¶zelliÄŸi, Ã§erezlerin Ã¼Ã§Ã¼ncÃ¼ taraf alanlarÄ±ndan kaynaklanan isteklerde gÃ¶nderilip gÃ¶nderilmeyeceÄŸini belirler. ÃœÃ§ ayar sunar:
* **Strict**: Ã‡erezi Ã¼Ã§Ã¼ncÃ¼ taraf isteklerinde gÃ¶nderilmesini kÄ±sÄ±tlar.
* **Lax**: ÃœÃ§Ã¼ncÃ¼ taraf web siteleri tarafÄ±ndan baÅŸlatÄ±lan GET istekleriyle Ã§erezin gÃ¶nderilmesine izin verir.
* **None**: Ã‡erezi herhangi bir Ã¼Ã§Ã¼ncÃ¼ taraf alanÄ±ndan gÃ¶ndermeye izin verir.

Ã‡erezleri yapÄ±landÄ±rÄ±rken, bu Ã¶zellikleri anlamak, farklÄ± senaryolarda beklenen ÅŸekilde davranmalarÄ±nÄ± saÄŸlamaya yardÄ±mcÄ± olabilir.

| **Ä°stek TÃ¼rÃ¼** | **Ã–rnek Kod**                   | **Ã‡erezler GÃ¶nderildiÄŸinde** |
| ---------------- | ---------------------------------- | --------------------- |
| BaÄŸlantÄ±             | \<a href="...">\</a>               | NotSet\*, Lax, None   |
| Ã–nizleme        | \<link rel="prerender" href=".."/> | NotSet\*, Lax, None   |
| Form GET         | \<form method="GET" action="...">  | NotSet\*, Lax, None   |
| Form POST        | \<form method="POST" action="..."> | NotSet\*, None        |
| iframe           | \<iframe src="...">\</iframe>      | NotSet\*, None        |
| AJAX             | $.get("...")                       | NotSet\*, None        |
| Resim            | \<img src="...">                   | NetSet\*, None        |

Tablo [Invicti](https://www.netsparker.com/blog/web-security/same-site-cookie-attribute-prevent-cross-site-request-forgery/) tarafÄ±ndan ve hafifÃ§e deÄŸiÅŸtirilmiÅŸtir.\
_Bir **SameSite** Ã¶zelliÄŸine sahip Ã§erez, oturum gerektiren CSRF saldÄ±rÄ±larÄ±nÄ± **Ã¶nleyecektir**._

**\*UnutmayÄ±n ki Chrome80'den (ÅŸubat/2019) itibaren, bir Ã§erezin samesite Ã¶zelliÄŸi olmayan bir Ã§erezin varsayÄ±lan davranÄ±ÅŸÄ± lax olacaktÄ±r** ([https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/](https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/)).\
Bu deÄŸiÅŸiklik uygulandÄ±ktan sonra, **Chrome'da SameSite politikasÄ± olmayan Ã§erezlerin** **ilk 2 dakika boyunca None** olarak **iÅŸlem gÃ¶receÄŸini ve ardÄ±ndan Ã¼st dÃ¼zey Ã§apraz site POST isteÄŸi iÃ§in Lax** olarak iÅŸlem gÃ¶receÄŸini **unutmayÄ±n.**

## Ã‡erez BayraklarÄ±

### HttpOnly

Bu, **istemcinin** Ã§ereze eriÅŸmesini engeller (Ã–rneÄŸin **Javascript** aracÄ±lÄ±ÄŸÄ±yla: `document.cookie`)

#### **Atlatmalar**

* EÄŸer sayfa, isteklerin yanÄ±tÄ± olarak Ã§erezleri gÃ¶nderiyorsa (Ã¶rneÄŸin bir **PHPinfo** sayfasÄ±nda), XSS'yi kÃ¶tÃ¼ye kullanarak bu sayfaya bir istek gÃ¶nderip yanÄ±ttan Ã§erezleri **Ã§almak mÃ¼mkÃ¼n olabilir** (Ã¶rneÄŸi [https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/](https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/) adresinde bulabilirsiniz).
* Bu, sunucudan gelen yanÄ±t olarak **TRACE** **HTTP** istekleriyle atlatÄ±labilir (bu HTTP yÃ¶ntemi mevcutsa). Bu teknik **Cross-Site Tracking** olarak adlandÄ±rÄ±lÄ±r.
* Bu teknik, **modern tarayÄ±cÄ±lar tarafÄ±ndan JS'den TRACE** isteÄŸi gÃ¶ndermeye izin verilmeyerek Ã¶nlendi. Ancak, IE6.0 SP2 gibi belirli yazÄ±lÄ±mlarda `\r\nTRACE` yerine `TRACE` gÃ¶ndererek bu kÄ±sÄ±tlamalarÄ± atlatan bazÄ± yÃ¶ntemler bulunmuÅŸtur.
* BaÅŸka bir yol, tarayÄ±cÄ±larÄ±n sÄ±fÄ±r/gÃ¼n aÃ§Ä±klarÄ±nÄ±n sÃ¶mÃ¼rÃ¼lmesidir.
* Bir Ã‡erez Kavanozu taÅŸmasÄ± saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirerek **HttpOnly Ã§erezlerin Ã¼zerine yazÄ±labilir**:

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

* Bu Ã§erezleri dÄ±ÅŸarÄ±ya Ã§Ä±karmak iÃ§in [**Ã‡erez KaÃ§Ä±rma**](./#cookie-smuggling) saldÄ±rÄ±sÄ±nÄ± kullanmak mÃ¼mkÃ¼ndÃ¼r

### Secure

Ä°stek, yalnÄ±zca gÃ¼venli bir kanal Ã¼zerinden iletiliyorsa (genellikle **HTTPS**), Ã§erezi yalnÄ±zca bir HTTP isteÄŸinde gÃ¶nderecektir.

## Ã‡erez Ã–nekleri

`__Secure-` ile baÅŸlayan Ã§erezlerin, HTTPS ile korunan sayfalardan gelen sayfalarda `secure` bayraÄŸÄ± ile birlikte ayarlanmasÄ± gerekmektedir.

`__Host-` ile baÅŸlayan Ã§erezler iÃ§in birkaÃ§ koÅŸulun karÅŸÄ±lanmasÄ± gerekmektedir:

* `secure` bayraÄŸÄ± ile ayarlanmalÄ±dÄ±r.
* HTTPS ile korunan bir sayfadan kaynaklanmalÄ±dÄ±r.
* Alt alanlara iletilmesini engelleyen bir alan belirtmemelidir.
* Bu Ã§erezlerin yolu `/` olarak ayarlanmalÄ±dÄ±r.

`__Host-` ile baÅŸlayan Ã§erezlerin sÃ¼per alanlara veya alt alanlara gÃ¶nderilmesine izin verilmediÄŸini belirtmek Ã¶nemlidir. Bu kÄ±sÄ±tlama, uygulama Ã§erezlerini izole etmeye yardÄ±mcÄ± olur. Bu nedenle, tÃ¼m uygulama Ã§erezleri iÃ§in `__Host-` Ã¶nekini kullanmak, gÃ¼venliÄŸi ve izolasyonu artÄ±rmak iÃ§in iyi bir uygulama olarak dÃ¼ÅŸÃ¼nÃ¼lebilir.
## Ã‡erez SaldÄ±rÄ±larÄ±

EÄŸer Ã¶zel bir Ã§erez hassas veriler iÃ§eriyorsa kontrol edin (Ã¶zellikle bir CTF oynuyorsanÄ±z), zira zayÄ±f olabilir.

### Ã‡erezlerin Kodunu Ã‡Ã¶zme ve ManipÃ¼le Etme

Ã‡erezlere gÃ¶mÃ¼lmÃ¼ÅŸ hassas veriler her zaman incelenmelidir. Base64 veya benzer formatlarda kodlanmÄ±ÅŸ Ã§erezler genellikle Ã§Ã¶zÃ¼lebilir. Bu zayÄ±flÄ±k, saldÄ±rganlarÄ±n Ã§erez iÃ§eriÄŸini deÄŸiÅŸtirip modifiye ettikleri verileri tekrar Ã§ereze kodlayarak diÄŸer kullanÄ±cÄ±larÄ± taklit etmelerine olanak tanÄ±r.

### Oturum KaÃ§Ä±rma (Session Hijacking)

Bu saldÄ±rÄ±, bir kullanÄ±cÄ±nÄ±n Ã§erezini Ã§alarak bir uygulamadaki hesabÄ±na izinsiz eriÅŸim saÄŸlamayÄ± iÃ§erir. Ã‡alÄ±nan Ã§erez kullanÄ±larak, bir saldÄ±rgan meÅŸru kullanÄ±cÄ±yÄ± taklit edebilir.

### Oturum Sabitleme (Session Fixation)

Bu senaryoda, bir saldÄ±rgan bir kurbanÄ± belirli bir Ã§erez kullanmaya ikna eder. Uygulama giriÅŸ yaptÄ±ktan sonra yeni bir Ã§erez atamazsa, saldÄ±rgan, orijinal Ã§ereze sahip olarak kurbanÄ± taklit edebilir. Bu teknik, kurbanÄ±n saldÄ±rgan tarafÄ±ndan saÄŸlanan bir Ã§erezle giriÅŸ yapmasÄ±na dayanÄ±r.

EÄŸer bir **alt alan adÄ±nda XSS** bulduysanÄ±z veya bir **alt alan adÄ±nÄ± kontrol ediyorsanÄ±z**, okuyun:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### Oturum BaÄŸÄ±ÅŸÄ± (Session Donation)

Burada, saldÄ±rgan kurbanÄ± saldÄ±rganÄ±n oturum Ã§erezini kullanmaya ikna eder. Kendi hesabÄ±na giriÅŸ yaptÄ±ÄŸÄ±na inanan kurban, aslÄ±nda saldÄ±rganÄ±n hesabÄ± baÄŸlamÄ±nda yanlÄ±ÅŸlÄ±kla iÅŸlemler gerÃ§ekleÅŸtirir.

EÄŸer bir **alt alan adÄ±nda XSS** bulduysanÄ±z veya bir **alt alan adÄ±nÄ± kontrol ediyorsanÄ±z**, okuyun:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### [JWT Ã‡erezleri](../hacking-jwt-json-web-tokens.md)

Potansiyel JWT hatalarÄ±nÄ± aÃ§Ä±klayan bir sayfaya eriÅŸmek iÃ§in Ã¶nceki baÄŸlantÄ±ya tÄ±klayÄ±n.

Ã‡erezlerde kullanÄ±lan JSON Web Token'lar (JWT) de zayÄ±flÄ±klar iÃ§erebilir. Potansiyel hatalar ve bunlarÄ± nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸi hakkÄ±nda detaylÄ± bilgi iÃ§in, JWT'yi hacklemekle ilgili belgeye eriÅŸmek Ã¶nerilir.

### Cross-Site Request Forgery (CSRF)

Bu saldÄ±rÄ±, oturum aÃ§mÄ±ÅŸ bir kullanÄ±cÄ±yÄ±, mevcut kimlik doÄŸrulama yapÄ±lmÄ±ÅŸ bir web uygulamasÄ±nda istenmeyen eylemleri gerÃ§ekleÅŸtirmeye zorlar. SaldÄ±rganlar, her istekle otomatik olarak gÃ¶nderilen Ã§erezleri sÃ¶mÃ¼rebilirler.

### BoÅŸ Ã‡erezler

(Daha fazla detay iÃ§in [orijinal araÅŸtÄ±rmaya](https://blog.ankursundara.com/cookie-bugs/) bakÄ±n) TarayÄ±cÄ±lar, ismi olmayan Ã§erezlerin oluÅŸturulmasÄ±na izin verir, bu JavaScript ile aÅŸaÄŸÄ±daki gibi gÃ¶sterilebilir:
```js
document.cookie = "a=v1"
document.cookie = "=test value;" // Setting an empty named cookie
document.cookie = "b=v2"
```
The result in the sent cookie header is `a=v1; test value; b=v2;`. Intriguingly, this allows for the manipulation of cookies if an empty name cookie is set, potentially controlling other cookies by setting the empty cookie to a specific value:
```js
function setCookie(name, value) {
document.cookie = `${name}=${value}`;
}

setCookie("", "a=b"); // Setting the empty cookie modifies another cookie's value
```
#### Chrome HatasÄ±: Unicode Yedek Kod Nokta Sorunu

Chrome'da, bir Unicode yedek kod noktasÄ± bir set Ã§erezi parÃ§asÄ±ysa, `document.cookie` bozulur ve ardÄ±ndan boÅŸ bir dize dÃ¶ndÃ¼rÃ¼r:
```js
document.cookie = "\ud800=meep";
```
Bu, `document.cookie`'nin boÅŸ bir dize Ã§Ä±ktÄ±sÄ± vermesine neden olarak kalÄ±cÄ± bozulmaya iÅŸaret eder.

#### AyrÄ±ÅŸtÄ±rma SorunlarÄ± Nedeniyle Ã‡erez KaÃ§Ä±rma

(Daha fazla ayrÄ±ntÄ± iÃ§in [orijinal araÅŸtÄ±rmaya](https://blog.ankursundara.com/cookie-bugs/) bakÄ±n) Java (Jetty, TomCat, Undertow) ve Python (Zope, cherrypy, web.py, aiohttp, bottle, webob) dahil birÃ§ok web sunucusu, eski RFC2965 desteÄŸinden kaynaklanan Ã§erez dizelerini yanlÄ±ÅŸ iÅŸler. Ã‡ift tÄ±rnakla Ã§evrili bir Ã§erez deÄŸeri, normalde anahtar-deÄŸer Ã§iftlerini ayÄ±ran noktalÄ± virgÃ¼ller iÃ§erse bile tek bir deÄŸer olarak okunur:
```
RENDER_TEXT="hello world; JSESSIONID=13371337; ASDF=end";
```
#### Ã‡erez Enjeksiyonu GÃ¼venlik AÃ§Ä±klÄ±klarÄ±

(SonuÃ§larÄ±[orijinal araÅŸtÄ±rmada](https://blog.ankursundara.com/cookie-bugs/) kontrol edin) SunucularÄ±n, Ã¶zellikle Undertow, Zope ve Python'Ä±n `http.cookie.SimpleCookie` ve `http.cookie.BaseCookie` kullanarak Ã§erezleri yanlÄ±ÅŸ ayrÄ±ÅŸtÄ±rmasÄ±, Ã§erez enjeksiyon saldÄ±rÄ±larÄ± iÃ§in fÄ±rsatlar yaratÄ±r. Bu sunucular yeni Ã§erezlerin baÅŸlangÄ±cÄ±nÄ± dÃ¼zgÃ¼n bir ÅŸekilde sÄ±nÄ±rlamazlar, saldÄ±rganlara Ã§erezleri sahtelemelerine olanak tanÄ±r:

* Undertow, bir tÄ±rnak iÃ§indeki bir deÄŸerden sonra noktalÄ± virgÃ¼l olmadan hemen yeni bir Ã§erez bekler.
* Zope, bir sonraki Ã§erezi ayrÄ±ÅŸtÄ±rmaya baÅŸlamak iÃ§in bir virgÃ¼l arar.
* Python'Ä±n Ã§erez sÄ±nÄ±flarÄ±, boÅŸluk karakterinde ayrÄ±ÅŸmaya baÅŸlar.

Bu zayÄ±flÄ±k, Ã§erez tabanlÄ± CSRF korumasÄ±na gÃ¼venen web uygulamalarÄ±nda Ã¶zellikle tehlikelidir, Ã§Ã¼nkÃ¼ saldÄ±rganlara sahte CSRF belirteci Ã§erezleri enjekte etmelerine ve gÃ¼venlik Ã¶nlemlerini atlamalarÄ±na olanak tanÄ±r. Sorun, Python'Ä±n yinelenen Ã§erez adlarÄ±nÄ± iÅŸleme ÅŸekli tarafÄ±ndan kÃ¶tÃ¼leÅŸtirilir, burada son oluÅŸum Ã¶ncekileri geÃ§ersiz kÄ±lar. AyrÄ±ca, gÃ¼vensiz baÄŸlamlarda `__Secure-` ve `__Host-` Ã§erezleri iÃ§in endiÅŸeleri artÄ±rÄ±r ve Ã§erezlerin sahteciliÄŸe duyarlÄ± arka uÃ§ sunucularÄ±na iletilmesi durumunda yetkilendirme atlamalarÄ±na yol aÃ§abilir.

### Ekstra SavunmasÄ±z Ã‡erez Kontrolleri

#### **Temel kontroller**

* **Ã‡erez**, her **giriÅŸ** yaptÄ±ÄŸÄ±nÄ±zda **aynÄ±** olmalÄ±dÄ±r.
* Ã‡Ä±kÄ±ÅŸ yapÄ±n ve aynÄ± Ã§erezi kullanmaya Ã§alÄ±ÅŸÄ±n.
* AynÄ± Ã§erezi kullanarak aynÄ± hesaba 2 cihazda (veya tarayÄ±cÄ±da) giriÅŸ yapmaya Ã§alÄ±ÅŸÄ±n.
* Ã‡erezde herhangi bir bilgi olup olmadÄ±ÄŸÄ±nÄ± kontrol edin ve deÄŸiÅŸtirmeye Ã§alÄ±ÅŸÄ±n.
* Neredeyse aynÄ± kullanÄ±cÄ± adÄ±yla birkaÃ§ hesap oluÅŸturun ve benzerlikleri gÃ¶rebilir misiniz kontrol edin.
* Varsa "**beni hatÄ±rla**" seÃ§eneÄŸini kontrol edin ve nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼n. Varsa ve savunmasÄ±z olabilirse, her zaman sadece **beni hatÄ±rla** Ã§erezini kullanÄ±n, baÅŸka bir Ã§erez olmadan.
* Åifrenizi deÄŸiÅŸtirdikten sonra Ã¶nceki Ã§erezin hala Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± kontrol edin.

#### **GeliÅŸmiÅŸ Ã§erez saldÄ±rÄ±larÄ±**

EÄŸer giriÅŸ yaptÄ±ÄŸÄ±nÄ±zda Ã§erez aynÄ± kalÄ±yorsa (veya neredeyse aynÄ±), bu muhtemelen Ã§erezin hesabÄ±nÄ±zÄ±n bir alanÄ±yla iliÅŸkili olduÄŸu anlamÄ±na gelir (muhtemelen kullanÄ±cÄ± adÄ±). O zaman ÅŸunlarÄ± yapabilirsiniz:

* Ã‡ok sayÄ±da **hesap** oluÅŸturun ve kullanÄ±cÄ± adlarÄ± Ã§ok **benzer** olsun ve algoritmanÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± **tahmin** etmeye Ã§alÄ±ÅŸÄ±n.
* **KullanÄ±cÄ± adÄ±nÄ± brute force** deneyin. EÄŸer Ã§erez sadece kullanÄ±cÄ± adÄ±nÄ±z iÃ§in bir kimlik doÄŸrulama yÃ¶ntemi olarak kaydediyorsa, o zaman "**Bmin**" kullanÄ±cÄ± adÄ±yla bir hesap oluÅŸturabilir ve Ã§erezinizin her bir **bitini** brute force edebilirsiniz Ã§Ã¼nkÃ¼ deneyeceÄŸiniz Ã§erezlerden biri "**admin**"e ait olacaktÄ±r.
* **Padding Oracle** deneyin (Ã§erezin iÃ§eriÄŸini ÅŸifreleyebilirsiniz). **Padbuster** kullanÄ±n.

**Padding Oracle - Padbuster Ã¶rnekleri**
```bash
padbuster <URL/path/when/successfully/login/with/cookie> <COOKIE> <PAD[8-16]>
# When cookies and regular Base64
padbuster http://web.com/index.php u7bvLewln6PJPSAbMb5pFfnCHSEd6olf 8 -cookies auth=u7bvLewln6PJPSAbMb5pFfnCHSEd6olf

# If Base64 urlsafe or hex-lowercase or hex-uppercase --encoding parameter is needed, for example:
padBuster http://web.com/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6
7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2
```
Padbuster birkaÃ§ deneme yapacak ve hangi koÅŸulun hata koÅŸulu olduÄŸunu soracak (geÃ§erli olmayan).

Daha sonra Ã§erezin ÅŸifresini Ã§Ã¶zmeye baÅŸlayacak (birkaÃ§ dakika sÃ¼rebilir).

SaldÄ±rÄ± baÅŸarÄ±yla gerÃ§ekleÅŸtirildiyse, istediÄŸiniz bir dizeyi ÅŸifrelemeyi deneyebilirsiniz. Ã–rneÄŸin, eÄŸer **user=admin** ÅŸifrelemek isterseniz
```
padbuster http://web.com/index.php 1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== 8 -cookies thecookie=1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== -plaintext user=administrator
```
Bu iÅŸlem, iÃ§inde **user=administrator** dizesi bulunan Ã§erezin doÄŸru bir ÅŸekilde ÅŸifrelenmiÅŸ ve kodlanmÄ±ÅŸ halini verecektir.

**CBC-MAC**

Belki bir Ã§erez bir deÄŸere sahip olabilir ve CBC kullanÄ±larak imzalanabilir. Sonra, deÄŸerin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼, aynÄ± deÄŸeri kullanarak CBC kullanarak oluÅŸturulan imza olacaktÄ±r. IV olarak bir nul vektÃ¶rÃ¼ kullanÄ±lmasÄ± Ã¶nerildiÄŸi iÃ§in, bu tÃ¼r bÃ¼tÃ¼nlÃ¼k kontrolÃ¼ savunmasÄ±z olabilir.

**SaldÄ±rÄ±**

1. KullanÄ±cÄ± adÄ± **administ**'in imzasÄ±nÄ± al = **t**
2. KullanÄ±cÄ± adÄ± **rator\x00\x00\x00 XOR t**'nin imzasÄ±nÄ± al = **t'**
3. Ã‡erezde deÄŸeri **administrator+t'** olarak ayarla (**t'**, **(rator\x00\x00\x00 XOR t) XOR t**'nin geÃ§erli bir imzasÄ± olacaktÄ±r = **rator\x00\x00\x00**

**ECB**

Ã‡erez ECB kullanÄ±larak ÅŸifrelendiyse savunmasÄ±z olabilir.\
GiriÅŸ yaptÄ±ÄŸÄ±nÄ±zda aldÄ±ÄŸÄ±nÄ±z Ã§erez her zaman aynÄ± olmalÄ±dÄ±r.

**NasÄ±l tespit edilir ve saldÄ±rÄ±lÄ±r:**

Neredeyse aynÄ± verilere sahip 2 kullanÄ±cÄ± oluÅŸturun (kullanÄ±cÄ± adÄ±, ÅŸifre, e-posta vb.) ve verilen Ã§erezde bir desen keÅŸfetmeye Ã§alÄ±ÅŸÄ±n

Ã–rneÄŸin "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" adÄ±nda bir kullanÄ±cÄ± oluÅŸturun ve Ã§erezde herhangi bir desen olup olmadÄ±ÄŸÄ±nÄ± kontrol edin (ECB, her bloÄŸu aynÄ± anahtarla ÅŸifrelediÄŸi iÃ§in, kullanÄ±cÄ± adÄ± ÅŸifrelendiÄŸinde aynÄ± ÅŸifrelenmiÅŸ baytlar gÃ¶rÃ¼nebilir).

Bir desen olmalÄ±dÄ±r (kullanÄ±lan blok boyutunda). Bu nedenle, bir grup "a"nÄ±n nasÄ±l ÅŸifrelendiÄŸini bildiÄŸinizde, "a"\*(blok boyutu)+"admin" ÅŸeklinde bir kullanÄ±cÄ± adÄ± oluÅŸturabilirsiniz. Sonra, "a" bloÄŸunun ÅŸifrelenmiÅŸ desenini Ã§erezden silebilirsiniz. Ve kullanÄ±cÄ± adÄ± "admin"in Ã§erezine sahip olabilirsiniz.

## Referanslar

* [https://blog.ankursundara.com/cookie-bugs/](https://blog.ankursundara.com/cookie-bugs/)
* [https://www.linkedin.com/posts/rickey-martin-24533653\_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd](https://www.linkedin.com/posts/rickey-martin-24533653\_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek.

</details>
