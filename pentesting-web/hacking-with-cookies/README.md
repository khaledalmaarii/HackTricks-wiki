# Ã‡erez Hacking

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki Ã¶zel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

En Ã¶nemli gÃ¼venlik aÃ§Ä±klarÄ±nÄ± bulun ve daha hÄ±zlÄ± dÃ¼zeltebilin. Intruder saldÄ±rÄ± yÃ¼zeyinizi takip eder, proaktif tehdit taramalarÄ± yapar, API'lerden web uygulamalarÄ±na ve bulut sistemlerine kadar tÃ¼m teknoloji yÄ±ÄŸÄ±nÄ±nÄ±zda sorunlarÄ± bulur. [**Ãœcretsiz deneyin**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) bugÃ¼n.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Ã‡erez Ã–zellikleri

Ã‡erezler, kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±ndaki davranÄ±ÅŸlarÄ±nÄ± kontrol eden birkaÃ§ Ã¶zellikle birlikte gelir. Ä°ÅŸte bu Ã¶zelliklerin daha pasif bir dilde aÃ§Ä±klamasÄ±:

### Expires ve Max-Age

Bir Ã§erezin son kullanma tarihi, `Expires` Ã¶zelliÄŸi tarafÄ±ndan belirlenir. Bununla birlikte, `Max-age` Ã¶zelliÄŸi Ã§erezin silineceÄŸi sÃ¼reyi saniye cinsinden belirler. **Daha modern uygulamalarÄ± yansÄ±ttÄ±ÄŸÄ± iÃ§in `Max-age` Ã¶zelliÄŸini tercih edin.**

### Domain

Bir Ã§erezi alacak olan sunucular, `Domain` Ã¶zelliÄŸi tarafÄ±ndan belirtilir. VarsayÄ±lan olarak, bu, Ã§erezi veren sunucuya ayarlanÄ±r ve alt alan adlarÄ±nÄ± iÃ§ermez. Bununla birlikte, `Domain` Ã¶zelliÄŸi aÃ§Ä±kÃ§a belirlendiÄŸinde, alt alan adlarÄ±nÄ± da kapsar. Bu, `Domain=mozilla.org` olarak ayarlandÄ±ÄŸÄ±nda, Ã§erezlerin `developer.mozilla.org` gibi alt alan adlarÄ±nda eriÅŸilebilir olmasÄ±nÄ± saÄŸlar.

### Path

`Path` Ã¶zelliÄŸi, `Cookie` baÅŸlÄ±ÄŸÄ±nÄ±n gÃ¶nderilmesi iÃ§in istenen URL'de bulunmasÄ± gereken belirli bir URL yolu belirtir. Bu Ã¶zellik, `/` karakterini bir dizin ayÄ±rÄ±cÄ± olarak kabul eder ve alt dizinlerde eÅŸleÅŸmelere izin verir.

### SÄ±ralama KurallarÄ±

AynÄ± isme sahip iki Ã§erez olduÄŸunda, gÃ¶nderilecek olan Ã§erez ÅŸu kriterlere gÃ¶re belirlenir:
- Ä°stenen URL'deki en uzun yolu eÅŸleÅŸtiren Ã§erez.
- Yollar aynÄ±ysa, en son ayarlanan Ã§erez seÃ§ilir.

### SameSite

- `SameSite` Ã¶zelliÄŸi, Ã¼Ã§Ã¼ncÃ¼ taraf alanlarÄ±ndan kaynaklanan isteklerde Ã§erezlerin gÃ¶nderilip gÃ¶nderilmeyeceÄŸini belirler. ÃœÃ§ ayarÄ± vardÄ±r:
- **Strict**: Ã‡erezi Ã¼Ã§Ã¼ncÃ¼ taraf isteklerinde gÃ¶ndermeyi kÄ±sÄ±tlar.
- **Lax**: ÃœÃ§Ã¼ncÃ¼ taraf web siteleri tarafÄ±ndan baÅŸlatÄ±lan GET istekleriyle Ã§erezin gÃ¶nderilmesine izin verir.
- **None**: Ã‡erezi herhangi bir Ã¼Ã§Ã¼ncÃ¼ taraf alanÄ±ndan gÃ¶ndermeye izin verir.

UnutmayÄ±n, Ã§erezleri yapÄ±landÄ±rÄ±rken, bu Ã¶zellikleri anlamak, farklÄ± senaryolarda beklenildiÄŸi gibi davranmalarÄ±nÄ± saÄŸlamaya yardÄ±mcÄ± olabilir.


| **Ä°stek TÃ¼rÃ¼** | **Ã–rnek Kod**                      | **Ã‡erezler GÃ¶nderildiÄŸinde** |
| -------------- | ---------------------------------- | --------------------------- |
| Link           | \<a href="...">\</a>               | NotSet\*, Lax, None         |
| Prerender      | \<link rel="prerender" href=".."/> | NotSet\*, Lax, None         |
| Form GET       | \<form method="GET" action="...">  | NotSet\*, Lax, None         |
| Form POST      | \<form method="POST" action="..."> | NotSet\*, None              |
| iframe         | \<iframe src="...">\</iframe>      | NotSet\*, None              |
| AJAX           | $.get("...")                       | NotSet\*, None              |
| Image          | \<img src="...">                   | NetSet\*, None              |

Tablo [Invicti](https://www.netsparker.com/blog/web-security/same-site-cookie-attribute-prevent-cross-site-request-forgery/) tarafÄ±ndan saÄŸlanmÄ±ÅŸ ve hafifÃ§e deÄŸiÅŸtirilmiÅŸtir.\
_**SameSite**_ Ã¶zelliÄŸine sahip bir Ã§erez, oturum gerektiren CSRF saldÄ±rÄ±larÄ±nÄ± **Ã¶nler**.

**\*Dikkat Chrome80'den (ÅŸubat/2019) itibaren, aynÄ± site politikasÄ± olmayan bir Ã§erezin varsayÄ±lan davranÄ±ÅŸÄ± lax olacak** ([https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/](https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/)).\
Dikkat geÃ§ici olarak, bu deÄŸiÅŸiklik uygulandÄ±ktan sonra, Chrome'da **aynÄ± site politikasÄ± olmayan Ã§erezler** **ilk 2 dakika boyunca None** olarak **iÅŸlem gÃ¶recek ve ardÄ±ndan Ã¼st dÃ¼zey Ã§apraz site POST isteÄŸi iÃ§in Lax** olarak **iÅŸlem gÃ¶recek**.

## Ã‡erez BayraklarÄ±

### HttpOnly

Bu, **istemcinin** Ã§ereze eriÅŸmesini engeller (Ã–rneÄŸin **Javascript** aracÄ±lÄ±ÄŸÄ±yla: `document.cookie`)

#### **Atlatmalar**

* EÄŸer sayfa, Ã§erezleri bir isteÄŸin yanÄ±tÄ± olarak gÃ¶nderiyorsa (Ã¶rneÄŸin bir **PHPinfo** sayfasÄ±nda), XSS'i istismar ederek bu sayfaya bir istek gÃ¶nderip yanÄ±ttaki Ã§erezleri **Ã§almak** mÃ¼mkÃ¼n olabilir (bir Ã¶rneÄŸi [https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/](https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/) adresinde bulabilirsiniz).
* Bu, sunucudan gelen yanÄ±t olarak **TRACE** **HTTP** istekleri gÃ¶nderen sayfalarÄ±n (Ã¶rneÄŸin bu HTTP yÃ¶ntemi kullanÄ±labilirse) Ã§erezleri yansÄ±tmasÄ±yla atlatÄ±labilir. Bu teknik **Cross-Site Tracking** olarak adlandÄ±rÄ±lÄ±r.
* Bu teknik, modern tarayÄ±cÄ±lar tarafÄ±ndan JS'den TRACE isteÄŸi gÃ¶ndermeye izin verilmeyerek engellenir. Bununla birlikte, IE6.0 SP2 gibi belirli yazÄ±lÄ±mlarda `\r\nTRACE` yerine `TRACE` gÃ¶ndererek bu durumu atlatan bazÄ± yÃ¶ntemler bulunmuÅŸtur.
* BaÅŸka bir yol, tarayÄ±cÄ±larÄ±n zero/day gÃ¼venlik aÃ§Ä±klarÄ±nÄ±n istismar edilmesidir.
* Bir Ã‡erez Kavanozu taÅŸmasÄ±na saldÄ±rÄ± yaparak **HttpOnly Ã§erezlerin Ã¼zerine yazÄ±labilir**:

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

* Bu Ã§erezleri dÄ±ÅŸarÄ± Ã§Ä±karmak iÃ§in [**Ã‡erez KaÃ§akÃ§Ä±lÄ±ÄŸÄ±**](./#cookie-smuggling) saldÄ±rÄ±sÄ± kullanÄ±labilir

### Secure

Bu istek, Ã§erezi yalnÄ±zca gÃ¼venli bir kanal Ã¼zerinden iletilen bir HTTP isteÄŸinde gÃ¶nderir (genellikle **HTTPS** ile).
## Ã‡erez Ã–nekleri

`__Secure-` ile baÅŸlayan Ã§erezler, HTTPS ile korunan sayfalardan ayarlanmasÄ± gerekmektedir.

`__Host-` ile baÅŸlayan Ã§erezler iÃ§in birkaÃ§ koÅŸul saÄŸlanmalÄ±dÄ±r:
- `secure` bayraÄŸÄ± ile ayarlanmalÄ±dÄ±r.
- HTTPS ile korunan bir sayfadan kaynaklanmalÄ±dÄ±r.
- Alan adÄ± belirtmelerine izin verilmez, bu da alt alanlara iletilmelerini engeller.
- Bu Ã§erezlerin yolu `/` olarak ayarlanmalÄ±dÄ±r.

Ã–nemli bir nokta, `__Host-` ile baÅŸlayan Ã§erezlerin sÃ¼per alan adlarÄ±na veya alt alan adlarÄ±na gÃ¶nderilmesine izin verilmemesidir. Bu kÄ±sÄ±tlama, uygulama Ã§erezlerini izole etmeye yardÄ±mcÄ± olur. Bu nedenle, gÃ¼venliÄŸi ve izolasyonu artÄ±rmak iÃ§in tÃ¼m uygulama Ã§erezleri iÃ§in `__Host-` Ã¶nekinin kullanÄ±lmasÄ± iyi bir uygulama olarak kabul edilebilir.

## Ã‡erez SaldÄ±rÄ±larÄ±

Ã–zel bir Ã§erez hassas veriler iÃ§eriyorsa (Ã¶zellikle bir CTF oynuyorsanÄ±z) kontrol edin, Ã§Ã¼nkÃ¼ zayÄ±f olabilir.

### Ã‡erezlerin Kodunu Ã‡Ã¶zme ve ManipÃ¼lasyonu

Ã‡erezlere gÃ¶mÃ¼lÃ¼ hassas veriler her zaman dikkatlice incelenmelidir. Base64 veya benzeri formatlarda kodlanmÄ±ÅŸ Ã§erezler genellikle Ã§Ã¶zÃ¼lebilir. Bu zayÄ±flÄ±k, saldÄ±rganlarÄ±n Ã§erezin iÃ§eriÄŸini deÄŸiÅŸtirmesine ve deÄŸiÅŸtirilmiÅŸ verilerini tekrar Ã§erezlere kodlamalarÄ±na izin verir.

### Oturum KaÃ§Ä±rma

Bu saldÄ±rÄ±, bir kullanÄ±cÄ±nÄ±n Ã§erezini Ã§alarak bir uygulamadaki hesabÄ±na izinsiz eriÅŸim saÄŸlamayÄ± iÃ§erir. Ã‡alÄ±nan Ã§erez kullanÄ±larak saldÄ±rgan, meÅŸru kullanÄ±cÄ±yÄ± taklit edebilir.

### Oturum Sabitleme

Bu senaryoda, saldÄ±rgan bir kurbanÄ± belirli bir Ã§erez kullanmaya kandÄ±rÄ±r. Uygulama giriÅŸ yaparken yeni bir Ã§erez atamazsa, saldÄ±rgan, orijinal Ã§ereze sahip olduÄŸu iÃ§in kurbanÄ± taklit edebilir. Bu teknik, kurbanÄ±n saldÄ±rgan tarafÄ±ndan saÄŸlanan bir Ã§erezle giriÅŸ yapmasÄ±na dayanÄ±r.

EÄŸer bir **alt alan adÄ±nda XSS bulduysanÄ±z** veya bir **alt alan adÄ±nÄ± kontrol ediyorsanÄ±z**, okuyun:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### Oturum BaÄŸÄ±ÅŸÄ±

Burada saldÄ±rgan, kurbanÄ± saldÄ±rganÄ±n oturum Ã§erezini kullanmaya ikna eder. Kendi hesabÄ±na giriÅŸ yaptÄ±ÄŸÄ±na inanan kurban, aslÄ±nda saldÄ±rganÄ±n hesabÄ±yla eylemler gerÃ§ekleÅŸtirir.

EÄŸer bir **alt alan adÄ±nda XSS bulduysanÄ±z** veya bir **alt alan adÄ±nÄ± kontrol ediyorsanÄ±z**, okuyun:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### [JWT Ã‡erezleri](../hacking-jwt-json-web-tokens.md)

JWT Ã§erezlerinde kullanÄ±lan JSON Web Token'lar da zayÄ±flÄ±klar iÃ§erebilir. Potansiyel zayÄ±flÄ±klar ve bunlarÄ± nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸi hakkÄ±nda daha detaylÄ± bilgi iÃ§in, JWT hackleme konusundaki baÄŸlantÄ±lÄ± belgeye eriÅŸmek Ã¶nerilir.

### Cross-Site Request Forgery (CSRF)

Bu saldÄ±rÄ±, oturum aÃ§mÄ±ÅŸ bir kullanÄ±cÄ±yÄ±, mevcut kimlik doÄŸrulamasÄ± yapÄ±lan bir web uygulamasÄ±nda istenmeyen eylemler gerÃ§ekleÅŸtirmeye zorlar. SaldÄ±rganlar, her istekle otomatik olarak gÃ¶nderilen Ã§erezleri sÃ¶mÃ¼rebilir.

### BoÅŸ Ã‡erezler

(Daha fazla ayrÄ±ntÄ± iÃ§in [orijinal araÅŸtÄ±rmaya](https://blog.ankursundara.com/cookie-bugs/) bakÄ±n)
TarayÄ±cÄ±lar, isimsiz Ã§erezlerin oluÅŸturulmasÄ±na izin verir. Bu, JavaScript kullanÄ±larak aÅŸaÄŸÄ±daki gibi gÃ¶sterilebilir:
```js
document.cookie = "a=v1"
document.cookie = "=test value;" // Setting an empty named cookie
document.cookie = "b=v2"
```
GÃ¶nderilen Ã§erez baÅŸlÄ±ÄŸÄ±ndaki sonuÃ§ `a=v1; test deÄŸeri; b=v2;` ÅŸeklindedir. Ä°lginÃ§ bir ÅŸekilde, boÅŸ bir isim Ã§erezi ayarlanÄ±rsa Ã§erezlerin manipÃ¼le edilmesine izin verir ve boÅŸ Ã§erez belirli bir deÄŸere ayarlanarak diÄŸer Ã§erezlerin kontrol edilmesini saÄŸlar:
```js
function setCookie(name, value) {
document.cookie = `${name}=${value}`;
}

setCookie("", "a=b"); // Setting the empty cookie modifies another cookie's value
```
Bu, tarayÄ±cÄ±nÄ±n `a` adÄ±nda ve `b` deÄŸerinde bir Ã§erez olarak yorumladÄ±ÄŸÄ± bir Ã§erez baÅŸlÄ±ÄŸÄ±nÄ± gÃ¶ndermesine yol aÃ§ar.

#### Chrome HatasÄ±: Unicode Surrogate Kod NoktasÄ± Sorunu

Chrome'da, bir Unicode surrogate kod noktasÄ± bir Ã§erezin bir parÃ§asÄ± ise, `document.cookie` bozulur ve sonrasÄ±nda boÅŸ bir dize dÃ¶ndÃ¼rÃ¼r:
```js
document.cookie = "\ud800=meep";
```
Bu, `document.cookie`'nin boÅŸ bir dize Ã§Ä±ktÄ±sÄ± vermesine neden olan kalÄ±cÄ± bir bozulmayÄ± gÃ¶sterir.

#### AyrÄ±ÅŸtÄ±rma SorunlarÄ± Nedeniyle Ã‡erez KaÃ§Ä±rma

(Daha fazla ayrÄ±ntÄ± iÃ§in [orijinal araÅŸtÄ±rmaya](https://blog.ankursundara.com/cookie-bugs/) bakÄ±n)
Java (Jetty, TomCat, Undertow) ve Python (Zope, cherrypy, web.py, aiohttp, bottle, webob) dahil birkaÃ§ web sunucusu, eski RFC2965 desteÄŸi nedeniyle Ã§erez dizelerini yanlÄ±ÅŸ iÅŸler. Ã‡ift tÄ±rnakla Ã§evrili bir Ã§erez deÄŸeri, normalde anahtar-deÄŸer Ã§iftlerini ayÄ±ran noktalÄ± virgÃ¼ller iÃ§erse bile tek bir deÄŸer olarak okunur:
```
RENDER_TEXT="hello world; JSESSIONID=13371337; ASDF=end";
```
#### Ã‡erez Enjeksiyonu Zafiyetleri

(Daha fazla ayrÄ±ntÄ± iÃ§in [orijinal araÅŸtÄ±rmaya](https://blog.ankursundara.com/cookie-bugs/) bakÄ±n)
SunucularÄ±n, Ã¶zellikle Undertow, Zope ve Python'Ä±n `http.cookie.SimpleCookie` ve `http.cookie.BaseCookie` kullanarak Ã§erezleri yanlÄ±ÅŸ ayrÄ±ÅŸtÄ±rmasÄ±, Ã§erez enjeksiyon saldÄ±rÄ±larÄ± iÃ§in fÄ±rsatlar yaratÄ±r. Bu sunucular, yeni Ã§erezlerin baÅŸlangÄ±cÄ±nÄ± doÄŸru bir ÅŸekilde sÄ±nÄ±rlamazlar ve saldÄ±rganlara Ã§erez taklit etme imkanÄ± verir:

- Undertow, tÄ±rnak iÃ§indeki bir deÄŸerden sonra noktalÄ± virgÃ¼l olmadan hemen yeni bir Ã§erez bekler.
- Zope, bir sonraki Ã§erezi ayrÄ±ÅŸtÄ±rmaya baÅŸlamak iÃ§in bir virgÃ¼l arar.
- Python'Ä±n Ã§erez sÄ±nÄ±flarÄ±, bir boÅŸluk karakterinde ayrÄ±ÅŸtÄ±rmaya baÅŸlar.

Bu zafiyet, Ã§erez tabanlÄ± CSRF korumasÄ±na gÃ¼venen web uygulamalarÄ±nda Ã¶zellikle tehlikelidir, Ã§Ã¼nkÃ¼ saldÄ±rganlara sahte CSRF belirteci Ã§erezleri enjekte etme imkanÄ± verir ve gÃ¼venlik Ã¶nlemlerini atlamalarÄ±na neden olabilir. Sorun, Python'Ä±n Ã§ift Ã§erez adlarÄ±nÄ± iÅŸleme ÅŸekli tarafÄ±ndan daha da kÃ¶tÃ¼leÅŸtirilir, burada son Ã§erez adÄ± Ã¶ncekileri geÃ§ersiz kÄ±lar. AyrÄ±ca, gÃ¼vensiz baÄŸlamlarda `__Secure-` ve `__Host-` Ã§erezleri iÃ§in endiÅŸeleri artÄ±rÄ±r ve Ã§erezler yetkilendirme taklitine yol aÃ§abilir, bu da sahte yapÄ±labilen arka uÃ§ sunucularÄ±na Ã§erezlerin iletilmesi durumunda yetkilendirme atlamalarÄ±na neden olabilir.


### Ek Zafiyetli Ã‡erez Kontrolleri

#### **Temel kontroller**

* **Ã‡erez**, her oturum aÃ§tÄ±ÄŸÄ±nÄ±zda **aynÄ±** olmalÄ±dÄ±r.
* Oturumu kapatÄ±n ve aynÄ± Ã§erezi kullanmaya Ã§alÄ±ÅŸÄ±n.
* AynÄ± Ã§erezi kullanarak aynÄ± hesaba 2 cihazda (veya tarayÄ±cÄ±da) oturum aÃ§mayÄ± deneyin.
* Ã‡erezde herhangi bir bilgi olup olmadÄ±ÄŸÄ±nÄ± kontrol edin ve deÄŸiÅŸtirmeyi deneyin.
* Neredeyse aynÄ± kullanÄ±cÄ± adÄ±yla birkaÃ§ hesap oluÅŸturmayÄ± deneyin ve benzerlikleri gÃ¶rebilir misiniz.
* Varsa "**beni hatÄ±rla**" seÃ§eneÄŸini kontrol edin ve nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼n. EÄŸer varsa ve zafiyete aÃ§Ä±ksa, her zaman sadece **beni hatÄ±rla** Ã§erezini kullanÄ±n, baÅŸka bir Ã§erez olmadan.
* Åifrenizi deÄŸiÅŸtirdikten sonra Ã¶nceki Ã§erez hala Ã§alÄ±ÅŸÄ±yor mu kontrol edin.

#### **GeliÅŸmiÅŸ Ã§erez saldÄ±rÄ±larÄ±**

EÄŸer Ã§erez oturum aÃ§tÄ±ÄŸÄ±nÄ±zda aynÄ± kalÄ±yorsa (veya neredeyse aynÄ±), bu muhtemelen Ã§erezin hesabÄ±nÄ±zÄ±n bazÄ± alanÄ±yla iliÅŸkili olduÄŸu anlamÄ±na gelir (muhtemelen kullanÄ±cÄ± adÄ±). O zaman yapabileceÄŸiniz ÅŸeyler:

* Ã‡ok sayÄ±da **hesap** oluÅŸturun ve kullanÄ±cÄ± adlarÄ± Ã§ok **benzer** olsun, algoritmanÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± **tahmin etmeye** Ã§alÄ±ÅŸÄ±n.
* **KullanÄ±cÄ± adÄ±nÄ±** **brute force** ile deneyin. EÄŸer Ã§erez sadece kullanÄ±cÄ± adÄ±nÄ±z iÃ§in bir kimlik doÄŸrulama yÃ¶ntemi olarak kaydediyorsa, o zaman "**Bmin**" kullanÄ±cÄ± adÄ±yla bir hesap oluÅŸturabilir ve Ã§erezinizin her bir **bit**'ini **brute force** ile deneyebilirsiniz, Ã§Ã¼nkÃ¼ deneyeceÄŸiniz Ã§erezlerden biri "**admin**"e ait olacaktÄ±r.
* **Padding Oracle**'Ä± deneyin (Ã§erezin iÃ§eriÄŸini ÅŸifre Ã§Ã¶zebilirsiniz). **Padbuster** kullanÄ±n.

**Padding Oracle - Padbuster Ã¶rnekleri**
```bash
padbuster <URL/path/when/successfully/login/with/cookie> <COOKIE> <PAD[8-16]>
# When cookies and regular Base64
padbuster http://web.com/index.php u7bvLewln6PJPSAbMb5pFfnCHSEd6olf 8 -cookies auth=u7bvLewln6PJPSAbMb5pFfnCHSEd6olf

# If Base64 urlsafe or hex-lowercase or hex-uppercase --encoding parameter is needed, for example:
padBuster http://web.com/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6
7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2
```
Padbuster, birkaÃ§ deneme yapacak ve hangi koÅŸulun hatalÄ± koÅŸul olduÄŸunu (geÃ§erli olmayan koÅŸul) size soracak.

Daha sonra Ã§erezin ÅŸifresini Ã§Ã¶zmeye baÅŸlayacak (birkaÃ§ dakika sÃ¼rebilir).

EÄŸer saldÄ±rÄ± baÅŸarÄ±yla gerÃ§ekleÅŸtirildiyse, istediÄŸiniz bir dizeyi ÅŸifrelemeyi deneyebilirsiniz. Ã–rneÄŸin, **user=administrator**'Ã¼ **ÅŸifrelemek** isterseniz.
```
padbuster http://web.com/index.php 1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== 8 -cookies thecookie=1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== -plaintext user=administrator
```
Bu iÅŸlem, iÃ§inde **user=administrator** dizesiyle doÄŸru bir ÅŸekilde ÅŸifrelenmiÅŸ ve kodlanmÄ±ÅŸ Ã§erezi verecektir.

**CBC-MAC**

Bir Ã§erezin deÄŸeri olabilir ve CBC kullanÄ±larak imzalanabilir. DeÄŸerin bÃ¼tÃ¼nlÃ¼ÄŸÃ¼, aynÄ± deÄŸeri kullanarak CBC kullanarak oluÅŸturulan imzadÄ±r. IV olarak boÅŸ bir vektÃ¶r kullanÄ±lmasÄ± Ã¶nerildiÄŸi iÃ§in bu tÃ¼r bÃ¼tÃ¼nlÃ¼k kontrolÃ¼ savunmasÄ±z olabilir.

**SaldÄ±rÄ±**

1. **administ** kullanÄ±cÄ± adÄ±nÄ±n imzasÄ±nÄ± alÄ±n = **t**
2. **rator\x00\x00\x00 XOR t** kullanÄ±cÄ± adÄ±nÄ±n imzasÄ±nÄ± alÄ±n = **t'**
3. Ã‡ereze **administrator+t'** deÄŸerini ayarlayÄ±n (**t'**, **(rator\x00\x00\x00 XOR t) XOR t** = **rator\x00\x00\x00** iÃ§in geÃ§erli bir imza olacaktÄ±r)

**ECB**

Ã‡erez ECB kullanÄ±larak ÅŸifrelendiyse savunmasÄ±z olabilir.\
GiriÅŸ yaptÄ±ÄŸÄ±nÄ±zda aldÄ±ÄŸÄ±nÄ±z Ã§erez her zaman aynÄ± olmalÄ±dÄ±r.

**NasÄ±l tespit edilir ve saldÄ±rÄ±lÄ±r:**

Neredeyse aynÄ± verilere sahip 2 kullanÄ±cÄ± oluÅŸturun (kullanÄ±cÄ± adÄ±, ÅŸifre, e-posta vb.) ve verilen Ã§erezde bir desen keÅŸfetmeye Ã§alÄ±ÅŸÄ±n.

Ã–rneÄŸin "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" adÄ±nda bir kullanÄ±cÄ± oluÅŸturun ve Ã§erezde herhangi bir desen olup olmadÄ±ÄŸÄ±nÄ± kontrol edin (ECB, her bloÄŸu aynÄ± anahtarla ÅŸifrelediÄŸi iÃ§in kullanÄ±cÄ± adÄ± ÅŸifrelendiÄŸinde aynÄ± ÅŸifrelenmiÅŸ baytlar gÃ¶rÃ¼nebilir).

Bir desen olmalÄ±dÄ±r (kullanÄ±lan bloÄŸun boyutunda). Bu nedenle, bir bloÄŸun ÅŸifrelenmiÅŸ desenini bilerek bir kullanÄ±cÄ± adÄ± oluÅŸturabilirsiniz: "a"\*(blok boyutu)+"admin". ArdÄ±ndan, Ã§erezden bir blok "a"nÄ±n ÅŸifrelenmiÅŸ desenini silebilirsiniz. Ve "admin" kullanÄ±cÄ± adÄ±nÄ±n Ã§erezine sahip olacaksÄ±nÄ±z.

## Referanslar

* [https://blog.ankursundara.com/cookie-bugs/](https://blog.ankursundara.com/cookie-bugs/)
* [https://www.linkedin.com/posts/rickey-martin-24533653_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd](https://www.linkedin.com/posts/rickey-martin-24533653_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

En Ã¶nemli gÃ¼venlik aÃ§Ä±klarÄ±nÄ± bulun, bÃ¶ylece daha hÄ±zlÄ± dÃ¼zeltebilirsiniz. Intruder saldÄ±rÄ± yÃ¼zeyinizi takip eder, proaktif tehdit taramalarÄ± yapar, API'lerden web uygulamalarÄ±na ve bulut sistemlerine kadar tÃ¼m teknoloji yÄ±ÄŸÄ±nÄ±nÄ±zda sorunlarÄ± bulur. [**Ãœcretsiz deneyin**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) bugÃ¼n.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi paylaÅŸarak HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.

</details>
