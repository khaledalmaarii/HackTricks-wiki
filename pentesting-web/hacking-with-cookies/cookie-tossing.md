# Cookie Tossing

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢æˆ‘ä»¬çš„ç‹¬å®¶[**NFTsæ”¶è—å“The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

### æè¿°

å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿ**æ§åˆ¶å…¬å¸çš„å­åŸŸæˆ–åŸŸ**ï¼Œæˆ–åœ¨å­åŸŸä¸­å‘ç°XSSæ¼æ´ï¼Œä»–å°†èƒ½å¤Ÿæ‰§è¡Œæ­¤æ”»å‡»ã€‚

æ­£å¦‚åœ¨Cookies Hackingéƒ¨åˆ†ä¸­æ‰€æŒ‡å‡ºçš„ï¼Œå½“**å°†cookieè®¾ç½®ä¸ºä¸€ä¸ªåŸŸï¼ˆæŒ‡å®šå®ƒï¼‰æ—¶ï¼Œå®ƒå°†åœ¨è¯¥åŸŸå’Œå­åŸŸä¸­ä½¿ç”¨**ã€‚

{% hint style="danger" %}
å› æ­¤ï¼Œ**æ”»å‡»è€…å°†èƒ½å¤Ÿè®¾ç½®ä¸€ä¸ªç‰¹å®šçš„cookieåˆ°åŸŸå’Œå­åŸŸä¸­ï¼Œç±»ä¼¼äº** `document.cookie="session=1234; Path=/app/login; domain=.example.com"`
{% endhint %}

è¿™å¯èƒ½å¾ˆå±é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯èƒ½ä¼šï¼š

* **å°†å—å®³è€…çš„cookieå›ºå®šåˆ°æ”»å‡»è€…çš„å¸æˆ·**ï¼Œå› æ­¤å¦‚æœç”¨æˆ·æ²¡æœ‰æ³¨æ„åˆ°ï¼Œ**ä»–å°†åœ¨æ”»å‡»è€…çš„å¸æˆ·ä¸­æ‰§è¡Œæ“ä½œ**ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šè·å–ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼ˆæ£€æŸ¥ç”¨æˆ·åœ¨å¹³å°ä¸Šçš„æœç´¢å†å²è®°å½•ï¼Œå—å®³è€…å¯èƒ½åœ¨å¸æˆ·ä¸­è®¾ç½®ä»–çš„ä¿¡ç”¨å¡...ï¼‰
* å¦‚æœ**ç™»å½•åcookieä¸ä¼šæ›´æ”¹**ï¼Œæ”»å‡»è€…å¯èƒ½åªéœ€**å›ºå®šä¸€ä¸ªcookieï¼ˆä¼šè¯å›ºå®šï¼‰**ï¼Œç­‰å¾…å—å®³è€…ç™»å½•ï¼Œç„¶å**ä½¿ç”¨è¯¥cookieä»¥å—å®³è€…èº«ä»½ç™»å½•**ã€‚
* æœ‰æ—¶ï¼Œå³ä½¿ä¼šè¯cookieæ›´æ”¹ï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥ä½¿ç”¨å…ˆå‰çš„cookieï¼Œç„¶åè¿˜ä¼šæ”¶åˆ°æ–°çš„cookieã€‚
* å¦‚æœ**cookieè®¾ç½®äº†ä¸€äº›åˆå§‹å€¼**ï¼ˆä¾‹å¦‚åœ¨flaskä¸­ï¼Œ**cookie**å¯èƒ½ä¼šåœ¨ä¼šè¯ä¸­**è®¾ç½®CSRFä»¤ç‰Œ**ï¼Œå¹¶ä¸”æ­¤å€¼å°†åœ¨å—å®³è€…ç™»å½•åä¿æŒä¸å˜ï¼‰ï¼Œ**æ”»å‡»è€…å¯ä»¥è®¾ç½®è¿™ä¸ªå·²çŸ¥å€¼ï¼Œç„¶åæ»¥ç”¨å®ƒ**ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥è®©ç”¨æˆ·æ‰§è¡ŒCSRFè¯·æ±‚ï¼Œå› ä¸ºä»–çŸ¥é“CSRFä»¤ç‰Œï¼‰ã€‚
* å°±åƒè®¾ç½®å€¼ä¸€æ ·ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥è·å–æœåŠ¡å™¨ç”Ÿæˆçš„æœªç»èº«ä»½éªŒè¯çš„cookieï¼Œä»ä¸­è·å–CSRFä»¤ç‰Œå¹¶ä½¿ç”¨å®ƒã€‚

### Cookieé¡ºåº

å½“æµè§ˆå™¨æ¥æ”¶åˆ°ä¸¤ä¸ªå…·æœ‰ç›¸åŒåç§°çš„cookieï¼Œ**éƒ¨åˆ†å½±å“ç›¸åŒèŒƒå›´**ï¼ˆåŸŸã€å­åŸŸå’Œè·¯å¾„ï¼‰æ—¶ï¼Œ**æµè§ˆå™¨å°†åœ¨è¯·æ±‚æ—¶å‘é€ä¸¤ä¸ªcookieçš„å€¼**ï¼Œåªè¦ä¸¤è€…å¯¹è¯¥è¯·æ±‚éƒ½æœ‰æ•ˆã€‚

å–å†³äºè°å…·æœ‰**æœ€å…·ä½“è·¯å¾„**æˆ–å“ªä¸ªæ˜¯**æœ€æ—§çš„**ï¼Œæµè§ˆå™¨å°†**é¦–å…ˆè®¾ç½®ä¸€ä¸ªcookieçš„å€¼ï¼Œç„¶åè®¾ç½®å¦ä¸€ä¸ªcookieçš„å€¼**ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š`Cookie: iduser=MoreSpecificAndOldestCookie; iduser=LessSpecific;`

å¤§å¤šæ•°**ç½‘ç«™å°†ä»…ä½¿ç”¨ç¬¬ä¸€ä¸ªå€¼**ã€‚å› æ­¤ï¼Œå¦‚æœæ”»å‡»è€…æƒ³è¦è®¾ç½®ä¸€ä¸ªcookieï¼Œæœ€å¥½åœ¨å¦ä¸€ä¸ªcookieè®¾ç½®ä¹‹å‰è®¾ç½®å®ƒï¼Œæˆ–è€…ä½¿ç”¨æ›´å…·ä½“çš„è·¯å¾„è®¾ç½®å®ƒã€‚

{% hint style="warning" %}
æ­¤å¤–ï¼Œ**åœ¨æ›´å…·ä½“çš„è·¯å¾„ä¸­è®¾ç½®cookieçš„èƒ½åŠ›**éå¸¸æœ‰è¶£ï¼Œå› ä¸ºæ‚¨å°†èƒ½å¤Ÿä½¿**å—å®³è€…ä½¿ç”¨ä»–çš„cookieï¼Œé™¤äº†åœ¨æ¶æ„cookieè®¾ç½®å°†åœ¨ä¹‹å‰å‘é€çš„ç‰¹å®šè·¯å¾„ä¹‹å¤–**ã€‚
{% endhint %}

### ç»•è¿‡ä¿æŠ¤

å¯¹æŠ—è¿™ç§æ”»å‡»çš„å¯èƒ½ä¿æŠ¤æªæ–½æ˜¯ï¼Œ**WebæœåŠ¡å™¨ä¸ä¼šæ¥å—å…·æœ‰ç›¸åŒåç§°ä½†ä¸¤ä¸ªä¸åŒå€¼çš„ä¸¤ä¸ªcookieçš„è¯·æ±‚**ã€‚

ä¸ºäº†ç»•è¿‡æ”»å‡»è€…åœ¨å—å®³è€…å·²ç»è·å¾—cookieä¹‹åè®¾ç½®cookieçš„æƒ…å†µï¼Œæ”»å‡»è€…å¯ä»¥å¼•èµ·**cookieæº¢å‡º**ï¼Œç„¶åï¼Œä¸€æ—¦**åˆæ³•cookieè¢«åˆ é™¤ï¼Œè®¾ç½®æ¶æ„cookie**ã€‚

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

å¦ä¸€ä¸ªæœ‰ç”¨çš„**ç»•è¿‡**æ–¹æ³•å¯èƒ½æ˜¯**å¯¹cookieåç§°è¿›è¡ŒURLç¼–ç **ï¼Œå› ä¸ºä¸€äº›ä¿æŠ¤æªæ–½ä¼šæ£€æŸ¥è¯·æ±‚ä¸­å…·æœ‰ç›¸åŒåç§°çš„2ä¸ªcookieï¼Œç„¶åæœåŠ¡å™¨å°†è§£ç cookieçš„åç§°ã€‚

### Cookieç‚¸å¼¹

Cookie Tossingæ”»å‡»ä¹Ÿå¯ä»¥ç”¨äºæ‰§è¡Œ**Cookieç‚¸å¼¹**æ”»å‡»ï¼š

{% content-ref url="cookie-bomb.md" %}
[cookie-bomb.md](cookie-bomb.md)
{% endcontent-ref %}

### é˜²å¾¡

#### **åœ¨cookieåç§°ä¸­ä½¿ç”¨å‰ç¼€`__Host`**

* å¦‚æœcookieåç§°å…·æœ‰æ­¤å‰ç¼€ï¼Œ**åªæœ‰åœ¨æ ‡è®°ä¸ºå®‰å…¨ï¼Œä»å®‰å…¨æ¥æºå‘é€ï¼Œä¸åŒ…æ‹¬Domainå±æ€§ï¼Œå¹¶ä¸”Pathå±æ€§è®¾ç½®ä¸º/**çš„æƒ…å†µä¸‹ï¼Œå®ƒæ‰ä¼šåœ¨Set-CookieæŒ‡ä»¤ä¸­è¢«æ¥å—**
* **è¿™å¯ä»¥é˜²æ­¢å­åŸŸå¼ºåˆ¶å°†cookieå‘é€åˆ°é¡¶çº§åŸŸï¼Œå› ä¸ºè¿™äº›cookieå¯ä»¥è¢«è§†ä¸ºâ€œåŸŸé”å®šâ€**

### å‚è€ƒèµ„æ–™

* [**@blueminimal**](https://twitter.com/blueminimal)
* [**https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers**](https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers)
* [**https://github.blog/2013-04-09-yummy-cookies-across-domains/**](https://github.blog/2013-04-09-yummy-cookies-across-domains/)
* [**Cookie Crumbles: Unveiling Web Session Integrity Vulnerabilities**](https://www.youtube.com/watch?v=F\_wAzF4a7Xg)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢æˆ‘ä»¬çš„ç‹¬å®¶[**NFTsæ”¶è—å“The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
