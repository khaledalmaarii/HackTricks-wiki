# Ã‡erez Atma

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.**

</details>

### AÃ§Ä±klama

Bir saldÄ±rgan, **bir ÅŸirketin alt alan adÄ±nÄ± veya alan adÄ±nÄ± kontrol edebilirse veya bir alt alanda XSS bulursa**, bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirebilir.

Ã‡erezler HakkÄ±nda bÃ¶lÃ¼mÃ¼nde belirtildiÄŸi gibi, bir **Ã§erez bir alan adÄ±na ayarlandÄ±ÄŸÄ±nda (belirtilerek) bu alan adÄ±nda ve alt alanlarda kullanÄ±lacaktÄ±r.**

{% hint style="danger" %}
Bu nedenle, **bir saldÄ±rgan alan adÄ±na ve alt alanlara belirli bir Ã§erez ayarlayabilecek** ve ÅŸÃ¶yle bir ÅŸey yapabilecektir: `document.cookie="session=1234; Path=/app/login; domain=.example.com"`
{% endhint %}

Bu tehlikeli olabilir Ã§Ã¼nkÃ¼ saldÄ±rgan ÅŸunlarÄ± yapabilir:

* **KurbanÄ±n Ã§erezini saldÄ±rganÄ±n hesabÄ±na sabitleyebilir**, bÃ¶ylece kullanÄ±cÄ± fark etmezse, **saldÄ±rganÄ±n hesabÄ±nda iÅŸlemleri gerÃ§ekleÅŸtirecek** ve saldÄ±rgan bazÄ± ilginÃ§ bilgiler elde edebilir (kullanÄ±cÄ±nÄ±n platformdaki arama geÃ§miÅŸini kontrol edin, kurban kredi kartÄ±nÄ± hesaba ekleyebilir...)
* EÄŸer **Ã§erez giriÅŸten sonra deÄŸiÅŸmezse**, saldÄ±rgan sadece **bir Ã§erezi sabitleyebilir (oturum sabitleme)**, kurbanÄ±n giriÅŸ yapmasÄ±nÄ± bekler ve ardÄ±ndan **o Ã§erezi kullanarak kurban olarak giriÅŸ yapabilir**.
* Bazen, oturum Ã§erezleri deÄŸiÅŸse bile, saldÄ±rgan Ã¶nceki Ã§erezi kullanabilir ve yeni olanÄ± da alabilir.
* EÄŸer **Ã§erez baÅŸlangÄ±Ã§ deÄŸeri ayarlÄ±yorsa** (Ã¶rneÄŸin, flask'ta **Ã§erez** oturumun **CSRF belirteci**ni **ayarlayabilir** ve bu deÄŸer, kurban giriÅŸ yaptÄ±ktan sonra korunabilir), **saldÄ±rgan bu bilinen deÄŸeri ayarlayabilir ve ardÄ±ndan kÃ¶tÃ¼ye kullanabilir** (bu senaryoda, saldÄ±rgan daha sonra kullanÄ±cÄ±yÄ± CSRF isteÄŸi yapmaya zorlayabilir Ã§Ã¼nkÃ¼ CSRF belirtecini biliyor).
* DeÄŸeri ayarlamak gibi, saldÄ±rgan ayrÄ±ca sunucu tarafÄ±ndan oluÅŸturulan kimlik doÄŸrulama yapÄ±lmamÄ±ÅŸ bir Ã§erez alabilir, CSRF belirtecini alabilir ve bunu kullanabilir.

### Ã‡erez SÄ±rasÄ±

Bir tarayÄ±cÄ±, aynÄ± adÄ± taÅŸÄ±yan iki Ã§erez aldÄ±ÄŸÄ±nda **aynÄ± kapsamÄ± kÄ±smen etkileyen** (alan adÄ±, alt alanlar ve yol) **tarayÄ±cÄ± her iki Ã§erezin deÄŸerini de gÃ¶nderecektir**.

TarayÄ±cÄ±, **en spesifik yolun kimde olduÄŸuna veya hangisinin daha eski olduÄŸuna baÄŸlÄ± olarak**, **Ã¶nce Ã§erezin deÄŸerini ayarlayacak ve ardÄ±ndan diÄŸerinin deÄŸerini ayarlayacaktÄ±r** gibi: `Cookie: iduser=DahaSpesifikVeEskiÃ‡erez; iduser=DahaAzSpesifik;`

Ã‡oÄŸu **web sitesi yalnÄ±zca ilk deÄŸeri kullanacaktÄ±r**. DolayÄ±sÄ±yla, bir saldÄ±rganÄ±n bir Ã§erez ayarlamak istemesi durumunda, bunu baÅŸka birinin ayarlanmasÄ±ndan Ã¶nce ayarlamak veya daha spesifik bir yol ile ayarlamak daha iyidir.

{% hint style="warning" %}
DahasÄ±, **daha spesifik bir yol ile Ã§erez ayarlayabilme yeteneÄŸi** Ã§ok ilginÃ§tir Ã§Ã¼nkÃ¼ **kurbanÄ±n Ã§erezini belirli bir yolda kÃ¶tÃ¼ niyetli Ã§erez ayarlanan yoldan Ã¶nce gÃ¶ndermesini saÄŸlayabilirsiniz**.
{% endhint %}

### Koruma Atlatma

Bu saldÄ±rÄ±ya karÅŸÄ± olasÄ± koruma, **web sunucusunun aynÄ± ada sahip ancak farklÄ± deÄŸerlere sahip iki Ã§erezle gelen istekleri kabul etmemesi** olabilir.

SaldÄ±rganÄ±n, kurban zaten Ã§erezi aldÄ±ktan sonra Ã§erez ayarladÄ±ÄŸÄ± senaryoyu atlatmak iÃ§in, saldÄ±rgan bir **Ã§erez taÅŸmasÄ±na** neden olabilir ve ardÄ±ndan, **meÅŸru Ã§erez silindiÄŸinde kÃ¶tÃ¼ niyetli olanÄ± ayarlayabilir**.

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

BaÅŸka bir yararlÄ± **atlatma** yÃ¶ntemi, **Ã§erezin adÄ±nÄ± URL kodlamasÄ± yapmaktÄ±r** Ã§Ã¼nkÃ¼ bazÄ± korumalar istekte aynÄ± ada sahip 2 Ã§erez kontrol eder ve sunucu Ã§erezlerin adlarÄ±nÄ± Ã§Ã¶zer.

### Ã‡erez BombasÄ±

Bir Ã‡erez Atma saldÄ±rÄ±sÄ± aynÄ± zamanda bir **Ã‡erez BombasÄ±** saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmek iÃ§in de kullanÄ±labilir:

{% content-ref url="cookie-bomb.md" %}
[cookie-bomb.md](cookie-bomb.md)
{% endcontent-ref %}

### Savunmalar

#### Ã‡erez adÄ±nda `__Host` Ã¶neki kullanÄ±n

* Bir Ã§erez adÄ±nda bu Ã¶nek varsa, bu Ã§erez adÄ± yalnÄ±zca GÃ¼venli olarak iÅŸaretlenmiÅŸse, gÃ¼venli bir kÃ¶kenden gÃ¶nderilmiÅŸse, bir Alan Ã¶zelliÄŸi iÃ§ermiyorsa ve Yol Ã¶zelliÄŸi / olarak ayarlanmÄ±ÅŸsa, **Set-Cookie yÃ¶nergesinde kabul edilecektir**
* **Bu, alt alanlarÄ±n bir Ã§erezi kÃ¶k alanÄ±na zorlamasÄ±nÄ± Ã¶nler Ã§Ã¼nkÃ¼ bu Ã§erezler "alan kilidinde" olarak gÃ¶rÃ¼lebilir**

### Referanslar

* [**@blueminimal**](https://twitter.com/blueminimal)
* [**https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers**](https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers)
* [**https://github.blog/2013-04-09-yummy-cookies-across-domains/**](https://github.blog/2013-04-09-yummy-cookies-across-domains/)
* [**Ã‡erez ParÃ§alarÄ±: Web Oturum BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ GÃ¼venlik AÃ§Ä±klarÄ±nÄ± Ortaya Ã‡Ä±karma**](https://www.youtube.com/watch?v=F\_wAzF4a7Xg)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.**

</details>
