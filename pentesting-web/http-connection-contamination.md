# HTTPè¿æ¥æ±¡æŸ“

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

**æœ¬æ–‡å†…å®¹æ‘˜è‡ª** [**https://portswigger.net/research/http-3-connection-contamination**](https://portswigger.net/research/http-3-connection-contamination)\*\*\*\*

Webæµè§ˆå™¨ä½¿ç”¨[**HTTPè¿æ¥åˆå¹¶**](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing)ï¼Œå…è®¸å®ƒä»¬ä¸ºå‘é€åˆ°**ä¸åŒç½‘ç«™**çš„è¯·æ±‚**é‡ç”¨**ä¸€ä¸ª**HTTP/2+è¿æ¥**ï¼Œå‰ææ˜¯è¿™äº›ç½‘ç«™**è§£æåˆ°ç›¸åŒçš„IPåœ°å€**å¹¶ä½¿ç”¨é€‚ç”¨äºä¸¤ä¸ªä¸»æœºåçš„TLSè¯ä¹¦ã€‚

**é¦–æ¬¡è¯·æ±‚è·¯ç”±**æ˜¯ä¸€ç§å±é™©çš„åå‘ä»£ç†è¡Œä¸ºï¼Œä»£ç†åˆ†æè¿æ¥ä¸Šçš„**ç¬¬ä¸€ä¸ªè¯·æ±‚**ä»¥ç¡®å®šå°†å…¶è·¯ç”±åˆ°**å“ªä¸ªåç«¯**ï¼Œç„¶åå°†è¯¥è¿æ¥ä¸Šçš„æ‰€æœ‰**åç»­è¯·æ±‚**å‘é€åˆ°**åŒä¸€ä¸ªåç«¯**ã€‚

**è¿æ¥åˆå¹¶å’Œé¦–æ¬¡è¯·æ±‚è·¯ç”±ä¸å…¼å®¹**ã€‚ä¾‹å¦‚ï¼Œå‡è®¾secure.example.comå’Œwordpress.example.coméƒ½ä½äºä¸€ä¸ªåå‘ä»£ç†åé¢ï¼Œä½¿ç”¨ä¸€ä¸ªå¯¹\*.example.comæœ‰æ•ˆçš„è¯ä¹¦ï¼š
```shell-session
$ nslookup wordpress.example.com
52.16.179.7 // reverse proxy that supports HTTP/2 and does first-request routing

$ nslookup secure.example.com
52.16.179.7 // same reverse proxy

$ openssl s_client -connect x.portswigger-labs.net:443
subject=/CN=*.example.com // wildcard TLS certificate
```
å¦‚æœæµè§ˆå™¨å°è¯•å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°`wordpress.example.com`ï¼Œç„¶åæ˜¯`secure.example.com`ï¼Œæµè§ˆå™¨è¿æ¥åˆå¹¶å°†å¼ºåˆ¶å°†è¿™ä¸¤ä¸ªè¯·æ±‚é€šè¿‡å•ä¸ªè¿æ¥å‘é€åˆ°å‰ç«¯ã€‚é¦–æ¬¡è¯·æ±‚è·¯ç”±å°†å¯¼è‡´å°†è¯·æ±‚å‘é€åˆ°`secure.example.com`çš„é”™è¯¯è·¯ç”±åˆ°WordPressåç«¯ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ åœ¨`wordpress.example.com`ä¸Šå‘ç°äº†[XSS](https://portswigger.net/web-security/cross-site-scripting)ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒæ¥å±å®³`secure.example.com`ï¼
```javascript
// create HTTP/2+ connection
fetch('https://wordpress.example.com/', {credentials: 'include'})

// connection coalescing will force this down the same connection...
// ...leading to the front-end misrouting it to WordPress
// the browser thinks our injected JS is coming from secure.example.com
// exposing saved passwords, cookies, etc.
location='https://secure.example.com/plugin/x?q=<script>stealPasswords()'
```
ä½ å¯ä»¥ä½¿ç”¨Chromeå¼€å‘è€…å·¥å…·ä¸­çš„ç½‘ç»œé€‰é¡¹å¡ä¸‹çš„**æ—¶é—´å›¾**ï¼ˆæˆ–è€…å¦‚æœä½ æ˜¯ä¸ªå—è™ç‹‚ï¼Œå¯ä»¥ä½¿ç”¨Wiresharkï¼‰æ¥**æ¢ç´¢è¿æ¥åˆå¹¶**ã€‚ä½¿ç”¨fetch()å‘å‡ºè¯·æ±‚å¯¹ï¼Œå¹¶è§‚å¯Ÿå›¾è¡¨æ˜¯å¦æ˜¾ç¤ºç¬¬äºŒä¸ªè¯·æ±‚çš„â€œåˆå§‹è¿æ¥â€æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¹¶ä¸”è¿æ¥IDåˆ—æ˜¯å¦åŒ¹é…ï¼š

{% code overflow="wrap" %}
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
{% endcode %}

<figure><img src="../.gitbook/assets/image (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

æˆ‘è¿˜æ²¡æœ‰æŠ•å…¥è¶³å¤Ÿçš„æ—¶é—´æ¥æ·±å…¥æ¢ç´¢è¿™ä¸ªå¨èƒæˆ–åœ¨é‡å¤–è¿›è¡Œæ‰«æï¼Œå› ä¸ºæˆ‘è®¤ä¸ºå®ƒç›®å‰æ˜¯ç½•è§çš„ï¼Œæœ‰ä¸¤ä¸ªåŸå› ã€‚é¦–å…ˆï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚è·¯ç”±ç›¸å¯¹è¾ƒå°‘è§ï¼Œè€ŒHTTP/2çš„å®ç°å¤æ‚æ€§æ„å‘³ç€ç›¸å¯¹äºHTTP/1.1ï¼Œå”¯ä¸€çš„HTTP/2æœåŠ¡å™¨æ•°é‡å¾ˆå°‘ã€‚å…¶æ¬¡ï¼Œè¿æ¥åˆå¹¶æ„å‘³ç€æ‰§è¡Œç¬¬ä¸€æ¬¡è¯·æ±‚è·¯ç”±çš„HTTP/2æœåŠ¡å™¨å¯èƒ½ä¼šé—´æ–­æ€§åœ°å¯¹çœŸå®è®¿é—®è€…äº§ç”Ÿå½±å“ï¼Œå› æ­¤æ‰€æœ‰è€…å¯èƒ½ä¼šåœ¨æ²¡æœ‰æ”»å‡»è€…é¼“åŠ±çš„æƒ…å†µä¸‹ä¿®å¤æ¼æ´ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œå¯¹äºæ”»å‡»è€…æ¥è¯´å¹¶éå…¨æ˜¯åæ¶ˆæ¯ã€‚**HTTP/3æè®®**[**åˆ é™¤IPåœ°å€åŒ¹é…çš„è¦æ±‚**](https://www.rfc-editor.org/rfc/rfc9114.html#name-connection-reuse)**ï¼Œè¿™å°†æš´éœ²æ‰€æœ‰ä½¿ç”¨ç¬¬ä¸€æ¬¡è¯·æ±‚è·¯ç”±å¹¶å…·æœ‰é€‚ç”¨äºå¤šä¸ªä¸»æœºçš„è¯ä¹¦çš„å‰ç«¯çš„äºº**ã€‚

è¿™ä¹Ÿå¸¦æ¥äº†ç¬¬äºŒä¸ªé£é™©ï¼Œä¸ç¬¬ä¸€æ¬¡è¯·æ±‚è·¯ç”±æ— å…³ - è¿™æ„å‘³ç€ä¸€ä¸ª**è¢«å…¥ä¾µçš„å…·æœ‰é€šé…ç¬¦è¯ä¹¦çš„æœåŠ¡å™¨ä¸å†éœ€è¦ä¸­é—´äººæ”»å‡»æ¥åˆ©ç”¨**ã€‚å®é™…ä¸Šï¼Œè¿™æå¤§åœ°å¢åŠ äº†å¯èƒ½ä»ä¸­è·åˆ©çš„æ¶æ„è¡Œä¸ºè€…çš„æ•°é‡ã€‚

ä¸ºäº†åœ¨è¿™äº›é£é™©æˆä¸ºç°å®ä¹‹å‰é¿å…å®ƒä»¬ï¼Œç¡®ä¿æ‚¨çš„åå‘ä»£ç†ä¸æ‰§è¡Œç¬¬ä¸€æ¬¡è¯·æ±‚è·¯ç”±ã€‚æ‚¨å¯ä»¥åœ¨Repeaterä¸­æ‰‹åŠ¨æµ‹è¯•æ­¤åŠŸèƒ½ï¼Œæ–¹æ³•æ˜¯å¯ç”¨HTTP/1å’ŒHTTP/2è¿æ¥é‡ç”¨ï¼Œå¹¶ä½¿ç”¨[HTTP Request Smuggler](https://github.com/PortSwigger/http-request-smuggler)ä¸­çš„'Connection-State'æ”»å‡»è¿›è¡Œæ‰«æã€‚æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œå°½ç®¡é€šé…ç¬¦TLSè¯ä¹¦ä»æ¥éƒ½ä¸æ˜¯ç†æƒ³çš„é€‰æ‹©ï¼Œä½†HTTP/3æ„å‘³ç€ä¸€ä¸ªè¢«å…¥ä¾µçš„å…·æœ‰é€šé…ç¬¦è¯ä¹¦çš„æœåŠ¡å™¨ç°åœ¨å¯ä»¥ç”¨äºæ”»å‡»æ²¡æœ‰ä¸»åŠ¨ä¸­é—´äººæ”»å‡»çš„åŒçº§åŸŸã€‚

è¿™äº›æ–°çš„å¨èƒå»¶ç»­äº†ç½‘ç»œåŸºç¡€è®¾æ–½æ—¥ç›Šæ··ä¹±çš„è¶‹åŠ¿ï¼Œå…¶ä¸­ä»»ä½•ä¸€ä¸ªç½‘ç«™çš„å¼±ç‚¹éƒ½ä¼šå¯¹æ•´ä¸ªç³»ç»Ÿçš„å®‰å…¨æ€§äº§ç”Ÿè®¸å¤šéæ˜æ˜¾çš„è¿é”æ•ˆåº”ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™äº›é£é™©åœ¨å®è·µä¸­å¦‚ä½•å‘æŒ¥ä½œç”¨ã€‚

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
