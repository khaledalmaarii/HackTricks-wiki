# HTTP Response Smuggling / Desync

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░реЗрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposред

</details>

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рддрдХрдиреАрдХ рд╡реАрдбрд┐рдпреЛ рд╕реЗ рд▓реА рдЧрдИ рдереА: [https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s](https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s)**


## HTTP Request Queue Desynchronisation

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рддрдХрдиреАрдХ **рдПрдХ HTTP Request Smuggling рд╡рдВрд╢рдЬрддрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ:

рдЗрд╕ рддрдХрдиреАрдХ рдФрд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп HTTP Request smuggling рдХреЗ **рдореБрдЦреНрдп рдЕрдВрддрд░** рдХрд╛ **рдореБрдЦреНрдп рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рд▓реАрдХ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп**, рд╣рдо **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдорд┐рд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд▓реАрдХ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВрдЧреЗ**ред рдЗрд╕реЗ, HTTP Request smuggling рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1 рдЕрдиреБрд░реЛрдз рдФрд░ рдЖрдзрд╛ рднреЗрдЬрдиреЗ рдХреА рдмрдЬрд╛рдп, **2 рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдордпрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдордпрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ** рддрд╛рдХрд┐ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд╡реИрдз рдЕрдиреБрд░реЛрдз рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдЯреИрдХрд░ рдХреЛ рднреЗрдЬреА рдЬрд╛рдП**, рдпрд╛ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдЕрдЯреИрдХрд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рдбрд╛рд▓рдХрд░**ред

### HTTP Pipeline Desync

HTTP/1.1 рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ **рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд┐рдП рдмрд┐рдирд╛ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреВрдЫрд╛ рдЬрд╛ рд╕рдХреЗ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдХрд┐рд╕реА **рдкреНрд░реЙрдХреНрд╕реА** рдореЗрдВ **рдмреАрдЪ рдореЗрдВ** рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдХрд╛рд░реНрдп рд╣реИ рдХрд┐ **рдмреИрдХ-рдПрдВрдб рд╕реЗ рднреЗрдЬреЗ рдЧрдП рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдЙрд╕рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рд╕рдорд╡рд░реНрддреА рдореИрдЪ рдмрдирд╛рдП рд░рдЦрдирд╛**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдордпрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ HTTP Response smuggling рд╣рдорд▓рд╛ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ **рдЖрд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз рдФрд░ рдЕрд╡реИрдз рдЕрдиреБрд░реЛрдз рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рддреБрд░рдВрдд рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрддреА рд╣реИрдВ**, рддреЛ рдЕрд╡реИрдз рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд┐рдХреНрдЯрд┐рдо рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдХрддрд╛рд░ рдореЗрдВ рд╕рдорд╛рд╣рд┐рдд рдирд╣реАрдВ рдХреА рдЬрд╛рдПрдЧреА рдмрд▓реНрдХрд┐ **рдмрд╕ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдбрд╝ рджреА рдЬрд╛рдПрдЧреА**ред

![](<../.gitbook/assets/image (635) (1) (1) (1).png>)

рдЗрд╕рд▓рд┐рдП, рдЪрд╛рд╣рд┐рдП рдХрд┐ **рдЕрд╡реИрдз рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧреЗ**ред рдЗрд╕рд▓рд┐рдП, рдЬрдм рдЕрд╡реИрдз рдЕрдиреБрд░реЛрдз рдкреНрд░реЛрд╕реЗрд╕ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

рдпрджрд┐ рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рд╕реНрдерд┐рддрд┐ рдореЗрдВ **рдПрдХ рд╡рд┐рдХреНрдЯрд┐рдо рдиреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрд╛ рд╣реИ** рдФрд░ **рдЕрд╡реИрдз рдЕрдиреБрд░реЛрдз рдкрд╣рд▓реЗ рдкреНрд░рддрд┐рд╕рд╛рдж рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ **рдЕрд╡реИрдз рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рдХреНрдЯрд┐рдо рджреНрд╡рд╛рд░рд╛ "рдХрд┐рдпрд╛ рдЧрдпрд╛" рдЕрдиреБрд░реЛрдз рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реЛрдЧрд╛ред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ **рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ** рдФрд░ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд▓рд┐рдП рд╡реИрдз рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** **рдЙрддреНрддрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** **рдкрд╣рд▓реЗ** **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рдкрд╣рд▓реЗ** рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЕрдиреБрд░реЛрдз рдХрд╛ **рдЙрддреНрддрд░** **рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЗрд╕рд╕реЗ, рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдЙрддреНрддрд░ рдХреЗ рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

![](<../.gitbook/assets/image (658) (1).png>)

![](<../.gitbook/assets/image (655) (1) (1) (1).png>)

### рдПрдХрд╛рдзрд┐рдХ рдиреЗрд╕реНрдЯреЗрдб рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕рд╛рдорд╛рдиреНрдп **HTTP Request Smuggling** рдХреЗ рд╕рд╛рде рдПрдХ **рд░реЛрдЪрдХ рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐, рдПрдХ рд╕рд╛рдорд╛рдиреНрдп smuggling рд╣рдорд▓реЗ рдореЗрдВ, **рд▓рдХреНрд╖реНрдп** рд╣реИ рдХрд┐ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдЕрдиреБрд░реЛрдз рдХреА рд╢реБрд░реБрдЖрдд рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ** рддрд╛рдХрд┐ рдпрд╣ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХреНрд░рд┐рдпрд╛ рдХрд░реЗред рдПрдХ **HTTP Response smuggling рд╣рдорд▓реЗ** рдореЗрдВ, рдЬреИрд╕реЗ рд╣реА рдЖрдк **рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреЗ рд╣реИрдВ**, рдЖрдк **рдПрдХ рдкреЗрд▓реЛрдб рдореЗрдВ рджрд╕реЛрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдбреЗрд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рджрд╕реЛрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдбреЗрд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝ рдХрд░реЗрдВрдЧреА** рдЬреЛ **рдбреЗрд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝ рдХрд┐рдП рдЧрдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗ**ред

рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдЕрдзрд┐рдХ рд╕реЗ рдЕрдзрд┐рдХ рджрд╕реЛрдВ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рдХреЛ **рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд┐рддрд░рд┐рдд** рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рд╕рд░реНрд╡рд░ рдореЗрдВ **рдбреЛрдПрд╕** рдХрд╛ рдХрд╛рд░рдг рднреА рдмрди рд╕рдХрддрд╛ рд╣реИред

### рд╣рдорд▓реЗ рд╕рдВрдЧрдарди

рдЬреИрд╕рд╛ рдкрд╣рд▓реЗ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рд╕рд░реНрд╡рдкреНрд░рдердо рдЕрд╡реИрдз рд╕рдВрджреЗрд╢** рдХреЛ рд╕рд░реНрд╡рд░ рдореЗрдВ **рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ**ред

рдпрджрд┐ рд╣рдо **рд╡рд┐рдХреНрдЯрд┐рдо рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЪреБрд░рд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ рдпрд╣ **рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз** рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣рдорд▓рд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрд░рдЪрдирд╛ рд╣реЛрдЧреАред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ **рдЖрд░рдВрднрд┐рдХ** рдЕрдиреБрд░реЛрдз рдЬреЛ **HTTP Request smuggling** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ **рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз** рдФрд░ рдлрд┐рд░ **1 рдпрд╛ рдЕрдзрд┐рдХ рдкреЗрд▓реЛрдб рдЕрдиреБрд░реЛрдз** рдЬрд┐рдирдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдВрдЧреАред

## HTTP Response Queue Desynchronisation рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

### рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд░реЛрдз рдкрдХрдбрд╝рдирд╛ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

HTTP Request Smuggling рдЬрд╛рдиреЗ рдЧрдП payloads рдХреА рддрд░рд╣, рдЖрдк рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рд╕реЗ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдЕрдиреБрд░реЛрдз рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рд╕реЗ: рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдкрдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЕрдВрддрд┐рдо POST рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ** рдФрд░ рдПрдХ рдмрдбрд╝реА Content-Lengthред

![](<../.gitbook/assets/image (625).png>)

рдлрд┐рд░, рдЬрдм **рдЖрд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз** (рдиреАрд▓рд╛) **рдкреНрд░реЛрд╕реЗрд╕** рд╣реЛ рдЧрдпрд╛ рдерд╛ рдФрд░ **рдЬрдм** **рдиреАрдВрдж рд╡рд╛рд▓рд╛** рдЕрдиреБрд░реЛрдз (рдкреАрд▓рд╛) рдкреНрд░реЛрд╕реЗрд╕ рд╣реЛ рд░рд╣рд╛ рдерд╛, **рд╡рд┐рдХреНрдЯрд┐рдо рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз** **рдкреНрд░рдд
