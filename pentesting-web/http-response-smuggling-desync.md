# HTTP Response Smuggling / Desync

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## DÃ©synchronisation de la file d'attente de requÃªtes HTTP

Tout d'abord, cette technique **exploite une vulnÃ©rabilitÃ© de Smuggling de requÃªtes HTTP**, vous devez donc savoir ce que c'est :

La **principale** **diffÃ©rence** entre cette technique et un Smuggling de requÃªtes HTTP commun est que **au lieu d'attaquer la requÃªte de la victime en y ajoutant un prÃ©fixe**, nous allons **fuir ou modifier la rÃ©ponse que la victime reÃ§oit**. Cela se fait en envoyant non pas 1 requÃªte et demi pour exploiter le Smuggling de requÃªtes HTTP, mais **en envoyant 2 requÃªtes complÃ¨tes pour dÃ©synchroniser la file d'attente des rÃ©ponses des proxies**.

Cela est dÃ» au fait que nous allons Ãªtre en mesure de **dÃ©synchroniser la file d'attente de rÃ©ponse** afin que la **rÃ©ponse** de la **requÃªte lÃ©gitime** de la **victime soit envoyÃ©e Ã  l'attaquant**, ou en **injectant un contenu contrÃ´lÃ© par l'attaquant dans la rÃ©ponse Ã  la victime**.

### DÃ©synchronisation de la file d'attente de pipeline HTTP

HTTP/1.1 permet de demander **diffÃ©rentes ressources sans avoir besoin d'attendre les prÃ©cÃ©dentes**. Par consÃ©quent, s'il y a un **proxy** au **milieu**, c'est le rÃ´le des proxies de **maintenir une correspondance synchronisÃ©e des requÃªtes envoyÃ©es au backend et des rÃ©ponses qui en proviennent**.

Cependant, il y a un problÃ¨me de dÃ©synchronisation de la file d'attente des rÃ©ponses. Si un attaquant envoie une attaque de Smuggling de rÃ©ponse HTTP et que les rÃ©ponses Ã  la **requÃªte initiale et Ã  celle contrebandÃ©e sont rÃ©pondues immÃ©diatement**, la rÃ©ponse contrebandÃ©e ne sera pas insÃ©rÃ©e dans la file d'attente de la rÃ©ponse de la victime, mais sera simplement **rejetÃ©e comme une erreur**.

![](<../.gitbook/assets/image (635) (1) (1) (1).png>)

Par consÃ©quent, il est nÃ©cessaire que la **requÃªte contrebandÃ©e prenne plus de temps Ã  Ãªtre traitÃ©e** Ã  l'intÃ©rieur du serveur back-end. Par consÃ©quent, au moment oÃ¹ la requÃªte contrebandÃ©e est traitÃ©e, la communication avec l'attaquant sera terminÃ©e.

Si dans cette situation spÃ©cifique une **victime a envoyÃ© une requÃªte** et que la **requÃªte contrebandÃ©e est rÃ©pondue avant** la requÃªte lÃ©gitime, la **rÃ©ponse contrebandÃ©e sera envoyÃ©e Ã  la victime**. Par consÃ©quent, l'attaquant **contrÃ´lera la requÃªte "effectuÃ©e" par la victime**.

De plus, si l'attaquant effectue ensuite une requÃªte et que la rÃ©ponse lÃ©gitime Ã  la requÃªte de la victime est rÃ©pondue avant la requÃªte de l'attaquant. La **rÃ©ponse Ã  la victime sera envoyÃ©e Ã  l'attaquant**, **volant** la rÃ©ponse Ã  la victime (qui peut contenir par exemple l'en-tÃªte **Set-Cookie**).

![](<../.gitbook/assets/image (658) (1).png>)

![](<../.gitbook/assets/image (655) (1) (1) (1).png>)

### Multiples injections imbriquÃ©es

Une autre **diffÃ©rence intÃ©ressante** avec le Smuggling de requÃªtes HTTP commun est que, dans une attaque de contrebande de rÃ©ponse HTTP commune, l'**objectif** est de **modifier le dÃ©but de la requÃªte de la victime**
## RÃ©fÃ©rences

* N'oubliez pas de regarder cette vidÃ©o qui explique trÃ¨s bien toutes ces techniques: [https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s](https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©**? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks**? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
