# Trampas de Iframe

<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipos Rojos de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>

## Informaci칩n B치sica

Esta forma de abusar de XSS a trav칠s de iframes para robar informaci칩n del usuario que se desplaza por la p치gina web fue publicada originalmente en estos 2 posts de trustedsec.com: [**aqu칤**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **y** [**aqu칤**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams).

El ataque comienza en una p치gina vulnerable a XSS donde es posible hacer que las **v칤ctimas no abandonen el XSS** haci칠ndolas **navegar dentro de un iframe** que ocupa toda la aplicaci칩n web.

El ataque XSS b치sicamente cargar치 la p치gina web en un iframe en el 100% de la pantalla. Por lo tanto, la v칤ctima **no notar치 que est치 dentro de un iframe**. Entonces, si la v칤ctima navega en la p치gina haciendo clic en enlaces dentro del iframe (dentro de la web), estar치 **navegando dentro del iframe** con el JS arbitrario cargado robando informaci칩n de esta navegaci칩n.

Adem치s, para hacerlo m치s realista, es posible usar algunos **escuchadores** para verificar cu치ndo un iframe cambia la ubicaci칩n de la p치gina, y actualizar la URL del navegador con esas ubicaciones para que el usuario piense que est치 movi칠ndose entre p치ginas usando el navegador.

<figure><img src="../.gitbook/assets/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

Adem치s, es posible usar escuchadores para robar informaci칩n sensible, no solo de las otras p치ginas que la v칤ctima est치 visitando, sino tambi칠n de los datos utilizados para **rellenar formularios** y enviarlos (쯖redenciales?) o para **robar el almacenamiento local**...

Por supuesto, las principales limitaciones son que una **v칤ctima que cierre la pesta침a o introduzca otra URL en el navegador escapar치 del iframe**. Otra forma de hacer esto ser칤a **actualizar la p치gina**, sin embargo, esto podr칤a ser parcialmente **prevenido** al deshabilitar el men칰 contextual del clic derecho cada vez que se carga una nueva p치gina dentro del iframe o al notar cuando el mouse del usuario abandona el iframe, potencialmente para hacer clic en el bot칩n de recarga del navegador y en este caso la URL del navegador se actualiza con la URL original vulnerable a XSS, por lo que si el usuario la recarga, volver치 a ser envenenado (nota que esto no es muy sigiloso).
