# Iframe Traps

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Basic Information

Cette forme d'abus de XSS via des iframes pour voler des informations √† l'utilisateur naviguant sur la page web a √©t√© publi√©e √† l'origine dans ces 2 articles de trustedsec.com : [**ici**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **et** [**ici**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams).

L'attaque commence sur une page vuln√©rable √† un XSS o√π il est possible de faire en sorte que les **victimes ne quittent pas le XSS** en les faisant **naviguer dans une iframe** qui occupe toute l'application web.

L'attaque XSS chargera essentiellement la page web dans une iframe occupant 100 % de l'√©cran. Par cons√©quent, la victime **ne remarquera pas qu'elle est dans une iframe**. Ensuite, si la victime navigue sur la page en cliquant sur des liens √† l'int√©rieur de l'iframe (dans le web), elle sera **en train de naviguer √† l'int√©rieur de l'iframe** avec le JS arbitraire charg√© volant des informations de cette navigation.

De plus, pour rendre cela plus r√©aliste, il est possible d'utiliser des **√©couteurs** pour v√©rifier quand une iframe change la localisation de la page, et mettre √† jour l'URL du navigateur avec ces emplacements que l'utilisateur pense qu'il se d√©place entre les pages en utilisant le navigateur.

<figure><img src="../.gitbook/assets/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

De plus, il est possible d'utiliser des √©couteurs pour voler des informations sensibles, non seulement les autres pages que la victime visite, mais aussi les donn√©es utilis√©es pour **remplir des formulaires** et les envoyer (identifiants ?) ou pour **voler le stockage local**...

Bien s√ªr, les principales limitations sont qu'une **victime fermant l'onglet ou mettant une autre URL dans le navigateur √©chappera √† l'iframe**. Une autre fa√ßon de faire cela serait de **rafra√Æchir la page**, cependant, cela pourrait √™tre partiellement **pr√©venu** en d√©sactivant le menu contextuel du clic droit chaque fois qu'une nouvelle page est charg√©e √† l'int√©rieur de l'iframe ou en remarquant quand la souris de l'utilisateur quitte l'iframe, potentiellement pour cliquer sur le bouton de rechargement du navigateur et dans ce cas, l'URL du navigateur est mise √† jour avec l'URL originale vuln√©rable au XSS donc si l'utilisateur la recharge, elle sera √† nouveau empoisonn√©e (notez que ce n'est pas tr√®s furtif).

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
