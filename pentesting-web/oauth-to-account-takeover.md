# OAuth –¥–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è <a href="#d4a8" id="d4a8"></a>

OAuth –ø—Ä–æ–ø–æ–Ω—É—î —Ä—ñ–∑–Ω—ñ –≤–µ—Ä—Å—ñ—ó, –∑ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –≤—ñ–¥–æ–º–æ—Å—Ç—è–º–∏, –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó OAuth 2.0](https://oauth.net/2/). –¶–µ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–µ –Ω–∞ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ–º—É [—Ç–∏–ø—ñ –Ω–∞–¥–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ –∫–æ–¥—É OAuth 2.0](https://oauth.net/2/grant-types/authorization-code/), —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î **—Ä–∞–º–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –¥–æ–¥–∞—Ç–∫—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∞–±–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —ñ–Ω—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É** (—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó).

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–∏–π –≤–µ–±-—Å–∞–π—Ç _**https://example.com**_, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**, –≤–∫–ª—é—á–∞—é—á–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è OAuth 2.0. _https://example.com_ –∑–∞–ø–∏—Ç–∞—î –≤–∞—à—É –∑–≥–æ–¥—É –Ω–∞ **–¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, –Ω–∞ _https://socialmedia.com_ –∑'—è–≤–∏—Ç—å—Å—è –µ–∫—Ä–∞–Ω –∑–≥–æ–¥–∏, —â–æ –æ–ø–∏—Å—É—î **–¥–æ–∑–≤–æ–ª–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å—Å—è, —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞, —è–∫–∏–π —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç**. –ü—ñ—Å–ª—è –≤–∞—à–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó _https://example.com_ –æ—Ç—Ä–∏–º—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–¥–æ—Å—Ç—É–ø—É –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ**.

–í–∞–∂–ª–∏–≤–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤ —Ä–∞–º–∫–∞—Ö OAuth 2.0:

* **–≤–ª–∞—Å–Ω–∏–∫ —Ä–µ—Å—É—Ä—Å—É**: –í–∏, —è–∫ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á/—Å—É–±'—î–∫—Ç**, –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂.
* **—Å–µ—Ä–≤–µ—Ä —Ä–µ—Å—É—Ä—Å—É**: **—Å–µ—Ä–≤–µ—Ä, —â–æ –∫–µ—Ä—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏** –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –¥–æ–¥–∞—Ç–æ–∫ –æ—Ç—Ä–∏–º–∞–≤ `access token` –≤—ñ–¥ —ñ–º–µ–Ω—ñ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
* **–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫**: **–¥–æ–¥–∞—Ç–æ–∫, —â–æ –∑–∞–ø–∏—Ç—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é** —É `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://example.com**.
* **—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**: **—Å–µ—Ä–≤–µ—Ä, —â–æ –≤–∏–¥–∞—î `access tokens`** –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–º—É –¥–æ–¥–∞—Ç–∫—É –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É` —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
* **client\_id**: –ü—É–±–ª—ñ—á–Ω–∏–π, —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è –¥–æ–¥–∞—Ç–∫—É.
* **client\_secret:** –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–∏–π –∫–ª—é—á, –≤—ñ–¥–æ–º–∏–π –ª–∏—à–µ –¥–æ–¥–∞—Ç–∫—É —Ç–∞ —Å–µ—Ä–≤–µ—Ä—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `access_tokens`.
* **response\_type**: –ó–Ω–∞—á–µ–Ω–Ω—è, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –∑–∞–ø–∏—Ç—É–≤–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `code`.
* **scope**: **—Ä—ñ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø—É**, —è–∫–∏–π `–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫` –∑–∞–ø–∏—Ç—É—î —É `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`.
* **redirect\_uri**: **URL, –Ω–∞ —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –¶–µ –∑–∞–∑–≤–∏—á–∞–π –º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–º—É URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.
* **state**: –ü–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è **–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ —Ç–∞ –∑ —Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ô–æ–≥–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è —Å–ª—É–∂–±–∏ —è–∫ **–º–µ—Ö–∞–Ω—ñ–∑–º –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF**.
* **grant\_type**: –ü–∞—Ä–∞–º–µ—Ç—Ä, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –Ω–∞–¥–∞–Ω–Ω—è —Ç–∞ —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è**.
* **code**: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–∏–π –∫–æ–¥ –∑ `—Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó`, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–∞–∑–æ–º –∑ `client_id` —Ç–∞ `client_secret` –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–º –¥–æ–¥–∞—Ç–∫–æ–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `access_token`.
* **access\_token**: **—Ç–æ–∫–µ–Ω, —è–∫–∏–π –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–ª—è API –∑–∞–ø–∏—Ç—ñ–≤** –≤—ñ–¥ —ñ–º–µ–Ω—ñ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`.
* **refresh\_token**: –î–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫—É **–æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–∏–π `access_token` –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**.

### –ü–æ—Ç—ñ–∫

**–§–∞–∫—Ç–∏—á–Ω–∏–π –ø–æ—Ç—ñ–∫ OAuth** –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. –í–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ [https://example.com](https://example.com) —ñ –≤–∏–±–∏—Ä–∞—î—Ç–µ –∫–Ω–æ–ø–∫—É ‚Äú–Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –∑ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–º–∏ –º–µ—Ä–µ–∂–∞–º–∏‚Äù.
2. –°–∞–π—Ç –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –Ω–∞ [https://socialmedia.com](https://socialmedia.com), –ø—Ä–æ—Å—è—á–∏ –≤–∞—à—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ–¥–∞—Ç–∫—É https://example.com –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π. –ó–∞–ø–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π —è–∫:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. –í–∞–º –±—É–¥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–≥–æ–¥–∏.  
4. –ü—ñ—Å–ª—è –≤–∞—à–æ–≥–æ —Å—Ö–≤–∞–ª–µ–Ω–Ω—è, –°–æ—Ü—ñ–∞–ª—å–Ω–∞ –ú–µ–¥—ñ–∞ –Ω–∞–¥—Å–∏–ª–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ `redirect_uri` –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `code` —Ç–∞ `state`:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π `code`, —Ä–∞–∑–æ–º —ñ–∑ —Å–≤–æ—ó–º `client_id` —Ç–∞ `client_secret`, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `access_token` –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∑–≤–æ–ª—ñ–≤, –Ω–∞ —è–∫—ñ –≤–∏ –ø–æ–≥–æ–¥–∏–ª–∏—Å—è:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. –ù–∞—Ä–µ—à—Ç—ñ, –ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è, –∫–æ–ª–∏ https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–∞—à `access_token` –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è API –≤–∏–∫–ª–∏–∫—É –¥–æ Social Media –¥–ª—è –¥–æ—Å—Ç—É–ø—É

## –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ <a href="#id-323a" id="id-323a"></a>

### –í—ñ–¥–∫—Ä–∏—Ç–∏–π redirect\_uri <a href="#cc36" id="cc36"></a>

`redirect_uri` —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –±–µ–∑–ø–µ–∫–∏ –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è—Ö OAuth —Ç–∞ OpenID, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∫–∞–∑—É—î, –∫—É–¥–∏ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ, —Ç–∞–∫—ñ —è–∫ –∫–æ–¥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –≤—ñ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π, —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Ü—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ —à–∫—ñ–¥–ª–∏–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.

–ú–µ—Ç–æ–¥–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–∞—Ä—ñ—é—é—Ç—å—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ª–æ–≥—ñ–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –∫–æ–ª–∏–≤–∞—Ç–∏—Å—è –≤—ñ–¥ —Å—É–≤–æ—Ä–æ–≥–æ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è —à–ª—è—Ö—ñ–≤ –¥–æ –ø—Ä–∏–π–Ω—è—Ç—Ç—è –±—É–¥—å-—è–∫–æ–≥–æ URL –≤ –º–µ–∂–∞—Ö –≤–∫–∞–∑–∞–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É –∞–±–æ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—É. –ó–∞–≥–∞–ª—å–Ω—ñ –º–µ—Ç–æ–¥–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—ñ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏, –æ–±—Ö–æ–¥–∏ —à–ª—è—Ö—ñ–≤, –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é —Å–ª–∞–±–∫–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ —Ç–∞ HTML-—ñ–Ω'—î–∫—Ü—ñ—ó –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤.

–û–∫—Ä—ñ–º `redirect_uri`, —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ OAuth —Ç–∞ OpenID, —Ç–∞–∫—ñ —è–∫ `client_uri`, `policy_uri`, `tos_uri` —Ç–∞ `initiate_login_uri`, —Ç–∞–∫–æ–∂ –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –∞—Ç–∞–∫–∞–º —Ä–µ–¥–∏—Ä–µ–∫—Ç—É. –¶—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —î –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏, —ñ —ó—Ö –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–∞—Ä—ñ—é—î—Ç—å—Å—è –º—ñ–∂ —Å–µ—Ä–≤–µ—Ä–∞–º–∏.

–î–ª—è —Ç–∏—Ö, —Ö—Ç–æ –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä OpenID, –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è (`**.well-known/openid-configuration**`) —á–∞—Å—Ç–æ –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–Ω–Ω—ñ –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `registration_endpoint`, `request_uri_parameter_supported` —Ç–∞ "`require_request_uri_registration`. –¶—ñ –¥–µ—Ç–∞–ª—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ —ñ–Ω—à–∏—Ö —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞.

### XSS –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–µ–¥–∏—Ä–µ–∫—Ç—É <a href="#bda5" id="bda5"></a>

–Ø–∫ –∑–≥–∞–¥–∞–Ω–æ –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ –±–∞–≥–∏ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html), –º–æ–∂–ª–∏–≤–æ, —â–æ **URL —Ä–µ–¥–∏—Ä–µ–∫—Ç—É –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** —Å–µ—Ä–≤–µ—Ä–∞ –ø—ñ—Å–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –±—É–¥—É—á–∏ **–≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ XSS**. –ú–æ–∂–ª–∏–≤–∏–π –∫–æ—Ä–∏—Å–Ω–∏–π –≤–∞–Ω—Ç–∞–∂ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ state <a href="#bda5" id="bda5"></a>

–£ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è—Ö OAuth –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–ø—É—Å–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **`state`** –º–æ–∂–µ –∑–Ω–∞—á–Ω–æ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ä–∏–∑–∏–∫ –∞—Ç–∞–∫ **Cross-Site Request Forgery (CSRF)**. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `state` –∞–±–æ **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ —Å—Ç–∞—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–±–æ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º**, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –æ–±—Ö–æ–¥–∏—Ç–∏ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ CSRF.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, –ø–µ—Ä–µ—Ö–æ–ø–ª—é—é—á–∏ –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —â–æ–± –∑–≤'—è–∑–∞—Ç–∏ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∂–µ—Ä—Ç–≤–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö **–≤–∑–ª–æ–º—ñ–≤ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤**. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, –¥–µ OAuth –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω–∏—Ö —Ü—ñ–ª–µ–π**.

–ü—Ä–∏–∫–ª–∞–¥–∏ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ –±—É–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –≤ —Ä—ñ–∑–Ω–∏—Ö **CTF –≤–∏–∫–ª–∏–∫–∞—Ö** —Ç–∞ **—Ö–∞–∫–µ—Ä—Å—å–∫–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö**, –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—á–∏ —ó—ó –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏. –ü—Ä–æ–±–ª–µ–º–∞ —Ç–∞–∫–æ–∂ –ø–æ—à–∏—Ä—é—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **Slack**, **Stripe** —Ç–∞ **PayPal**, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–±–æ –ø–ª–∞—Ç–µ–∂—ñ –Ω–∞ —Å–≤–æ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.

–ù–∞–ª–µ–∂–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **`state`** —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –ø–æ—Ç–æ–∫—É OAuth.

### –ü–µ—Ä–µ–¥ –≤–∑–ª–æ–º–æ–º –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É <a href="#ebe4" id="ebe4"></a>

1. **–ë–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∂–µ—Ä—Ç–≤–∏. –Ø–∫—â–æ –∂–µ—Ä—Ç–≤–∞ –ø—ñ–∑–Ω—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è –≤—Ö–æ–¥—É, –¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –∑–≤'—è–∑–∞—Ç–∏ —Ü–µ–π —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–º –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.
2. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ª–∞–±–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –≤ OAuth**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Å–µ—Ä–≤—ñ—Å–∞–º–∏ OAuth, —è–∫—ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏, –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤—à–∏—Å—å —É —ó—Ö–Ω—å–æ–º—É —Å–µ—Ä–≤—ñ—Å—ñ, –∞ –ø–æ—Ç—ñ–º –∑–º—ñ–Ω–∏–≤—à–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∂–µ—Ä—Ç–≤–∏. –¶–µ–π –º–µ—Ç–æ–¥ —Ç–∞–∫–æ–∂ –Ω–µ—Å–µ —Ä–∏–∑–∏–∫ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, –ø–æ–¥—ñ–±–Ω–æ –¥–æ –ø–µ—Ä—à–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é, –∞–ª–µ —á–µ—Ä–µ–∑ —ñ–Ω—à–∏–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏.

### –†–æ–∑–∫—Ä–∏—Ç—Ç—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ <a href="#e177" id="e177"></a>

–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –∑–∞—Ö–∏—Å—Ç —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ OAuth —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º–∏. –•–æ—á–∞ **`client_id`** –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—Ç–∏, —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è **`client_secret`** –Ω–µ—Å–µ –∑–Ω–∞—á–Ω—ñ —Ä–∏–∑–∏–∫–∏. –Ø–∫—â–æ `client_secret` –±—É–¥–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—é —Ç–∞ –¥–æ–≤—ñ—Ä–æ—é –¥–æ–¥–∞—Ç–∫–∞, —â–æ–± **–≤–∫—Ä–∞—Å—Ç–∏ `access_tokens`** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

–ó–∞–≥–∞–ª—å–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –¥–æ–¥–∞—Ç–∫–∏ –ø–æ–º–∏–ª–∫–æ–≤–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å –æ–±–º—ñ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ `code` –Ω–∞ `access_token` –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, –∞ –Ω–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞. –¶—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è `client_secret`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ `access_tokens` –ø—ñ–¥ –≤–∏–≥–ª—è–¥–æ–º –¥–æ–¥–∞—Ç–∫–∞. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —á–µ—Ä–µ–∑ —Å–æ—Ü—ñ–∞–ª—å–Ω—É —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—é –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, –¥–æ–¥–∞—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±–ª–∞—Å—Ç—ñ –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó OAuth, —â–µ –±—ñ–ª—å—à–µ –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ –¥–æ–≤—ñ—Ä–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å –¥–æ–¥–∞—Ç–∫–∞.

### –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å–µ–∫—Ä–µ—Ç—É –∫–ª—ñ—î–Ω—Ç–∞

–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ client_secret** –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –ø–æ—Å–ª—É–≥ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∫—Ä–∞—Å—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.\
–ó–∞–ø–∏—Ç –Ω–∞ BF –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header leaking Code + State

–Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç –º–∞—î **–∫–æ–¥ —ñ —Å—Ç–∞–Ω**, —ñ –≤–æ–Ω–∏ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Referer** –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —Ç–æ —Ü–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.

### Access Token Stored in Browser History

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **—ñ—Å—Ç–æ—Ä—ñ—ó –±—Ä–∞—É–∑–µ—Ä–∞ —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —Ç–∞–º —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É**.

### Everlasting Authorization Code

**–ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –ø–æ–≤–∏–Ω–µ–Ω —ñ—Å–Ω—É–≤–∞—Ç–∏ –ª–∏—à–µ –¥–µ—è–∫–∏–π —á–∞—Å, —â–æ–± –æ–±–º–µ–∂–∏—Ç–∏ —á–∞—Å–æ–≤–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –π–æ–≥–æ –≤–∫—Ä–∞—Å—Ç–∏ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏**.

### Authorization/Refresh Token not bound to client

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –∑ —ñ–Ω—à–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ —ñ–Ω—à—ñ –∞–∫–∞—É–Ω—Ç–∏**.

### Happy Paths, XSS, Iframes & Post Messages to leak code & state values

[**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ–π –ø–æ—Å—Ç**](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)

### AWS Cognito <a href="#bda5" id="bda5"></a>

–£ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ –±–∞–≥-–±–∞—É–Ω—Ç—ñ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ **—Ç–æ–∫–µ–Ω**, —è–∫–∏–π **AWS Cognito** –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É, –º–æ–∂–µ –º–∞—Ç–∏ **–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —ñ–Ω—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É**, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞—Ö–æ–ø–∏—Ç–∏** –∞–∫–∞—É–Ω—Ç–∏ —ñ–Ω—à–∏—Ö.
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
For more detailed info about how to abuse AWS cognito check:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### Abusing other Apps tokens <a href="#bda5" id="bda5"></a>

–Ø–∫ [**–∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), OAuth –ø–æ—Ç–æ–∫–∏, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Ç–æ–∫–µ–Ω** (–∞ –Ω–µ –∫–æ–¥), –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏, —è–∫—â–æ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —â–æ —Ç–æ–∫–µ–Ω –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ–¥–∞—Ç–∫—É.

–¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–¥–æ–¥–∞—Ç–æ–∫, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î OAuth —ñ –≤—Ö–æ–¥–∏—Ç–∏ —á–µ—Ä–µ–∑ Facebook** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥) —É —Å–≤–æ—î–º—É –¥–æ–¥–∞—Ç–∫—É. –ü–æ—Ç—ñ–º, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ –≤—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ Facebook —É **–¥–æ–¥–∞—Ç–∫—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **OAuth —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–¥–∞–Ω–∏–π –π–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤—Ö–æ–¥—É –≤ OAuth –¥–æ–¥–∞—Ç–æ–∫ –∂–µ—Ä—Ç–≤–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∂–µ—Ä—Ç–≤–∏**.

{% hint style="danger" %}
–û—Ç–∂–µ, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ —Å–≤–æ–≥–æ OAuth –¥–æ–¥–∞—Ç–∫—É, –≤—ñ–Ω –∑–º–æ–∂–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∂–µ—Ä—Ç–≤–∏ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å —Ç–æ–∫–µ–Ω —ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —á–∏ –±—É–≤ —Ç–æ–∫–µ–Ω –Ω–∞–¥–∞–Ω–∏–π —ó—Ö–Ω—å–æ–º—É ID –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

### Two links & cookie <a href="#bda5" id="bda5"></a>

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –∑–≤—ñ—Ç–æ–º**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f), –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ **returnUrl**, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞. –¶—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ **–∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ cookie (RU)**, –∞ –Ω–∞ **–ø—ñ–∑–Ω—ñ—à–æ–º—É –µ—Ç–∞–ø—ñ** **–ø—ñ–¥–∫–∞–∑–∫–∞** –∑–∞–ø–∏—Ç–∞—î **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —á–∏ —Ö–æ—á–µ –≤—ñ–Ω –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ —Ö–æ—Å—Ç—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.

–©–æ–± –æ–±—ñ–π—Ç–∏ —Ü—é –ø—ñ–¥–∫–∞–∑–∫—É, –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–ª—è —ñ–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è **Oauth –ø–æ—Ç–æ–∫—É**, —è–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–π RU cookie, –∑–∞–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–æ —Ç–æ–≥–æ, —è–∫ –∑'—è–≤–∏—Ç—å—Å—è –ø—ñ–¥–∫–∞–∑–∫–∞, —ñ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–æ–≤—É –≤–∫–ª–∞–¥–∫—É –±–µ–∑ —Ü—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è. –¢–æ–¥—ñ **–ø—ñ–¥–∫–∞–∑–∫–∞ –Ω–µ –ø–æ–≤—ñ–¥–æ–º–∏—Ç—å –ø—Ä–æ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∞–ª–µ cookie –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ –Ω—å–æ–≥–æ, —Ç–æ–º—É **—Ç–æ–∫–µ–Ω –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞** –ø—ñ–¥ —á–∞—Å —Ä–µ–¥–∏—Ä–µ–∫—Ç—É.

### Prompt Interaction Bypass <a href="#bda5" id="bda5"></a>

–Ø–∫ –ø–æ—è—Å–Ω–µ–Ω–æ –≤ [**—Ü—å–æ–º—É –≤—ñ–¥–µ–æ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q), –¥–µ—è–∫—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó OAuth –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∫–∞–∑–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä **`prompt`** GET —è–∫ None (**`&prompt=none`**), —â–æ–± **–∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∑–∞–ø–∏—Ç–∞–º –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è** –Ω–∞–¥–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –≤ –ø—ñ–¥–∫–∞–∑—Ü—ñ –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —è–∫—â–æ –≤–æ–Ω–∏ –≤–∂–µ —É–≤—ñ–π—à–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.

### response\_mode

–Ø–∫ [**–ø–æ—è—Å–Ω–µ–Ω–æ –≤ —Ü—å–æ–º—É –≤—ñ–¥–µ–æ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q), –º–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä **`response_mode`**, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, –¥–µ –≤–∏ —Ö–æ—á–µ—Ç–µ, —â–æ–± –∫–æ–¥ –±—É–≤ –Ω–∞–¥–∞–Ω–∏–π —É —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É URL:

* `response_mode=query` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ GET –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: `?code=2397rf3gu93f`
* `response_mode=fragment` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `#code=2397rf3gu93f`
* `response_mode=form_post` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ POST —Ñ–æ—Ä–º–∏ –∑ –ø–æ–ª–µ–º –≤–≤–µ–¥–µ–Ω–Ω—è, –Ω–∞–∑–≤–∞–Ω–∏–º `code`, —ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º
* `response_mode=web_message` -> –ö–æ–¥ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –≤ –ø–æ—Å—Ç-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ: `window.opener.postMessage({"code": "asdasdasd...`

### SSRFs parameters <a href="#bda5" id="bda5"></a>

[**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è**](https://portswigger.net/research/hidden-oauth-attack-vectors) **–î–ª—è –ø–æ–¥–∞–ª—å—à–∏—Ö –¥–µ—Ç–∞–ª–µ–π —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏.**

–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ —É OAuth —î –º–µ–Ω—à –æ—á–µ–≤–∏–¥–Ω–∏–º, –∞–ª–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º –¥–ª—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –±–µ–∑–ø–µ–∫–∏, –∑–æ–∫—Ä–µ–º–∞ –¥–ª—è –∞—Ç–∞–∫ **Server-Side Request Forgery (SSRF)**. –¶–µ–π –∫—ñ–Ω—Ü–µ–≤–∏–π –ø—É–Ω–∫—Ç –¥–æ–∑–≤–æ–ª—è—î OAuth —Å–µ—Ä–≤–µ—Ä–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –¥–æ–¥–∞—Ç–∫–∏, –≤–∫–ª—é—á–∞—é—á–∏ —á—É—Ç–ª–∏–≤—ñ URL, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤ –∞—Ç–∞–∫–∞—Ö.

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏:**

* **–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç—ñ–≤** –∑–∞–∑–≤–∏—á–∞–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ `/register` —ñ –ø—Ä–∏–π–º–∞—î –¥–µ—Ç–∞–ª—ñ, —Ç–∞–∫—ñ —è–∫ `client_name`, `client_secret`, `redirect_uris` —Ç–∞ URL –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø—ñ–≤ –∞–±–æ JSON Web Key Sets (JWKs) —á–µ—Ä–µ–∑ POST –∑–∞–ø–∏—Ç–∏.
* –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è–º, –≤–∏–∫–ª–∞–¥–µ–Ω–∏–º —É **RFC7591** —Ç–∞ **OpenID Connect Registration 1.0**, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ SSRF.
* –ü—Ä–æ—Ü–µ—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –º–æ–∂–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –ø—ñ–¥–¥–∞–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∏ SSRF –∫—ñ–ª—å–∫–æ–º–∞ —Å–ø–æ—Å–æ–±–∞–º–∏:
* **`logo_uri`**: URL –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø—É –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–æ–º, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ SSRF –∞–±–æ –ø—Ä–∏–∑–≤—ñ–≤—à–∏ –¥–æ XSS, —è–∫—â–æ URL –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.
* **`jwks_uri`**: URL –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ JWK –∫–ª—ñ—î–Ω—Ç–∞, —è–∫–∏–π, —è–∫—â–æ –π–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏, –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –≤–∏—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º.
* **`sector_identifier_uri`**: –ü–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ JSON –º–∞—Å–∏–≤ `redirect_uris`, —è–∫–∏–π —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏, —Å—Ç–≤–æ—Ä—é—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å SSRF.
* **`request_uris`**: –ü–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –∑–∞–ø–∏—Ç—É–≤–∞–Ω—ñ URI –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∏–º—É—î —Ü—ñ URI –Ω–∞ –ø–æ—á–∞—Ç–∫—É –ø—Ä–æ—Ü–µ—Å—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

**–°—Ç—Ä–∞—Ç–µ–≥—ñ—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:**

* SSRF –º–æ–∂–µ –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ —à–ª—è—Ö–æ–º —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –∑ –∑–ª–æ–≤–º–∏—Å–Ω–∏–º–∏ URL –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ `logo_uri`, `jwks_uri` –∞–±–æ `sector_identifier_uri`.
* –•–æ—á–∞ –ø—Ä—è–º–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ `request_uris` –º–æ–∂–µ –±—É—Ç–∏ –∑–º–µ–Ω—à–µ–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω—Ç—Ä–æ–ª—é –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É, –Ω–∞–¥–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–≥–æ, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º `request_uri` –º–æ–∂–µ –ø–æ–ª–µ–≥—à–∏—Ç–∏ SSRF –ø—ñ–¥ —á–∞—Å —Ñ–∞–∑–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

## OAuth providers Race Conditions

–Ø–∫—â–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —è–∫—É –≤–∏ —Ç–µ—Å—Ç—É—î—Ç–µ, —î –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–æ–º OAuth [**–ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ü–µ, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ Race Conditions**](race-condition.md).

## References

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
