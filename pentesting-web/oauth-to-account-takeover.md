# OAuth do przejÄ™cia konta

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Podstawowe informacje <a href="#d4a8" id="d4a8"></a>

OAuth oferuje rÃ³Å¼ne wersje, z podstawowymi informacjami dostÄ™pnymi na stronie [dokumentacji OAuth 2.0](https://oauth.net/2/). Ta dyskusja skupia siÄ™ gÅ‚Ã³wnie na powszechnie uÅ¼ywanym [typie autoryzacji OAuth 2.0](https://oauth.net/2/grant-types/authorization-code/), zapewniajÄ…cym **framework autoryzacji, ktÃ³ry umoÅ¼liwia aplikacji dostÄ™p lub wykonywanie dziaÅ‚aÅ„ na koncie uÅ¼ytkownika w innej aplikacji** (serwer autoryzacji).

RozwaÅ¼my hipotetycznÄ… stronÄ™ internetowÄ… _**https://example.com**_, zaprojektowanÄ… do **prezentowania wszystkich Twoich postÃ³w na mediach spoÅ‚ecznoÅ›ciowych**, w tym tych prywatnych. Aby to osiÄ…gnÄ…Ä‡, wykorzystywane jest OAuth 2.0. _https://example.com_ poprosi o zgodÄ™ na **dostÄ™p do Twoich postÃ³w na mediach spoÅ‚ecznoÅ›ciowych**. W rezultacie na _https://socialmedia.com_ pojawi siÄ™ ekran zgody, przedstawiajÄ…cy **uprawnienia, ktÃ³re sÄ… Å¼Ä…dane, oraz dewelopera dokonujÄ…cego Å¼Ä…dania**. Po udzieleniu zgody, _https://example.com_ uzyskuje moÅ¼liwoÅ›Ä‡ **dostÄ™pu do Twoich postÃ³w w Twoim imieniu**.

NaleÅ¼y zrozumieÄ‡ nastÄ™pujÄ…ce komponenty w ramach frameworka OAuth 2.0:

- **wÅ‚aÅ›ciciel zasobu**: Ty, jako **uÅ¼ytkownik/encja**, autoryzujesz dostÄ™p do swojego zasobu, takiego jak Twoje posty na mediach spoÅ‚ecznoÅ›ciowych.
- **serwer zasobÃ³w**: Serwer zarzÄ…dzajÄ…cy uwierzytelnionymi Å¼Ä…daniami po tym, jak aplikacja uzyskaÅ‚a `token dostÄ™pu` w imieniu `wÅ‚aÅ›ciciela zasobu`, np. **https://socialmedia.com**.
- **aplikacja klienta**: Aplikacja, ktÃ³ra **poszukuje autoryzacji** od `wÅ‚aÅ›ciciela zasobu`, taka jak **https://example.com**.
- **serwer autoryzacji**: Serwer, ktÃ³ry wydaje `tokeny dostÄ™pu` dla `aplikacji klienta` po pomyÅ›lnym uwierzytelnieniu `wÅ‚aÅ›ciciela zasobu` i uzyskaniu autoryzacji, np. **https://socialmedia.com**.
- **client\_id**: Publiczny, unikalny identyfikator aplikacji.
- **client\_secret:** Poufny klucz, znany tylko aplikacji i serwerowi autoryzacji, uÅ¼ywany do generowania `tokenÃ³w dostÄ™pu`.
- **response\_type**: WartoÅ›Ä‡ okreÅ›lajÄ…ca **typ Å¼Ä…danego tokenu**, np. `code`.
- **scope**: **Poziom dostÄ™pu**, ktÃ³ry `aplikacja klienta` Å¼Ä…da od `wÅ‚aÅ›ciciela zasobu`.
- **redirect\_uri**: **URL, do ktÃ³rego uÅ¼ytkownik jest przekierowywany po autoryzacji**. Zazwyczaj musi to byÄ‡ zgodne z wczeÅ›niej zarejestrowanym adresem przekierowania.
- **state**: Parametr sÅ‚uÅ¼Ä…cy do **przechowywania danych podczas przekierowania uÅ¼ytkownika do i z serwera autoryzacji**. Jego unikalnoÅ›Ä‡ jest kluczowa dla peÅ‚nienia roli **mechanizmu ochrony CSRF**.
- **grant\_type**: Parametr wskazujÄ…cy **typ autoryzacji i typ zwracanego tokenu**.
- **code**: Kod autoryzacji z `serwera autoryzacji`, uÅ¼ywany wspÃ³lnie z `client_id` i `client_secret` przez aplikacjÄ™ klienta do uzyskania `tokena dostÄ™pu`.
- **access\_token**: **Token, ktÃ³rego aplikacja klienta uÅ¼ywa do Å¼Ä…daÅ„ API** w imieniu `wÅ‚aÅ›ciciela zasobu`.
- **refresh\_token**: UmoÅ¼liwia aplikacji **uzyskanie nowego `tokena dostÄ™pu` bez ponownego pytania uÅ¼ytkownika**.

### PrzepÅ‚yw

**Rzeczywisty przepÅ‚yw OAuth** przebiega nastÄ™pujÄ…co:

1. Przechodzisz do [https://example.com](https://example.com) i wybierasz przycisk â€Integruj z mediami spoÅ‚ecznoÅ›ciowymiâ€.
2. Strona wysyÅ‚a Å¼Ä…danie do [https://socialmedia.com](https://socialmedia.com), proszÄ…c o TwojÄ… autoryzacjÄ™, aby pozwoliÄ‡ aplikacji https://example.com na dostÄ™p do Twoich postÃ³w. Å»Ä…danie jest zbudowane w nastÄ™pujÄ…cy sposÃ³b:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. NastÄ™pnie zostajesz poproszony o wyraÅ¼enie zgody.

4. Po udzieleniu zgody, Media SpoÅ‚ecznoÅ›ciowe wysyÅ‚a odpowiedÅº do `redirect_uri` z parametrami `code` i `state`:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com wykorzystuje ten `code`, wraz z jego `client_id` i `client_secret`, aby dokonaÄ‡ Å¼Ä…dania po stronie serwera w celu uzyskania `access_token` w Twoim imieniu, umoÅ¼liwiajÄ…c dostÄ™p do uprawnieÅ„, na ktÃ³re wyraziÅ‚eÅ› zgodÄ™:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. Ostatecznie proces koÅ„czy siÄ™, gdy https://example.com wykorzystuje TwÃ³j `access_token` do wykonania wywoÅ‚ania interfejsu API do mediÃ³w spoÅ‚ecznoÅ›ciowych w celu uzyskania dostÄ™pu

## Luki <a href="#323a" id="323a"></a>

### Otwarte przekierowanie `redirect_uri` <a href="#cc36" id="cc36"></a>

`redirect_uri` jest kluczowy dla bezpieczeÅ„stwa w implementacjach OAuth i OpenID, poniewaÅ¼ okreÅ›la, dokÄ…d sÄ… wysyÅ‚ane wraÅ¼liwe dane, takie jak kody autoryzacyjne, po autoryzacji. W przypadku bÅ‚Ä™dnej konfiguracji, moÅ¼e umoÅ¼liwiÄ‡ atakujÄ…cym przekierowanie tych Å¼Ä…daÅ„ do zÅ‚oÅ›liwych serwerÃ³w, umoÅ¼liwiajÄ…c przejÄ™cie konta.

Techniki eksploatacji rÃ³Å¼niÄ… siÄ™ w zaleÅ¼noÅ›ci od logiki walidacji serwera autoryzacyjnego. MogÄ… one obejmowaÄ‡ od dokÅ‚adnego dopasowania Å›cieÅ¼ki do akceptowania dowolnego adresu URL w okreÅ›lonej domenie lub podkatalogu. Powszechne metody eksploatacji obejmujÄ… otwarte przekierowania, nawigacjÄ™ Å›cieÅ¼kÄ…, wykorzystywanie sÅ‚abych wyraÅ¼eÅ„ regularnych oraz wstrzykiwanie HTML w celu kradzieÅ¼y tokena.

OprÃ³cz `redirect_uri`, inne parametry OAuth i OpenID, takie jak `client_uri`, `policy_uri`, `tos_uri` i `initiate_login_uri`, sÄ… rÃ³wnieÅ¼ podatne na ataki przekierowania. Te parametry sÄ… opcjonalne, a ich obsÅ‚uga rÃ³Å¼ni siÄ™ w zaleÅ¼noÅ›ci od serwerÃ³w.

Dla osÃ³b celujÄ…cych w serwer OpenID, punkt koÅ„cowy odkrywania (`**.well-known/openid-configuration**`) czÄ™sto zawiera cenne szczegÃ³Å‚y konfiguracji, takie jak `registration_endpoint`, `request_uri_parameter_supported` i "`require_request_uri_registration`. Te szczegÃ³Å‚y mogÄ… pomÃ³c w identyfikacji punktu koÅ„cowego rejestracji i innych szczegÃ³Å‚Ã³w konfiguracji serwera.

### XSS w implementacji przekierowania <a href="#bda5" id="bda5"></a>

Jak wspomniano w tym raporcie z programu bug bounty [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html), istnieje moÅ¼liwoÅ›Ä‡, Å¼e **adres URL przekierowania jest odzwierciedlany w odpowiedzi** serwera po uwierzytelnieniu uÅ¼ytkownika, co czyni go **podatnym na XSS**. MoÅ¼liwy Å‚adunek do testowania:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - NiewÅ‚aÅ›ciwe przetwarzanie parametru stanu <a href="#bda5" id="bda5"></a>

W implementacjach OAuth, naduÅ¼ycie lub pominiÄ™cie parametru **`state`** moÅ¼e znaczÄ…co zwiÄ™kszyÄ‡ ryzyko atakÃ³w typu **Cross-Site Request Forgery (CSRF)**. Ta podnoÅ›noÅ›Ä‡ pojawia siÄ™, gdy parametr `state` jest albo **nie uÅ¼ywany, uÅ¼ywany jako wartoÅ›Ä‡ statyczna, albo nieprawidÅ‚owo zweryfikowany**, co pozwala atakujÄ…cym ominÄ…Ä‡ zabezpieczenia CSRF.

AtakujÄ…cy mogÄ… wykorzystaÄ‡ to, przechwytujÄ…c proces autoryzacji, aby poÅ‚Ä…czyÄ‡ swoje konto z kontem ofiary, co prowadzi do potencjalnego **przejÄ™cia konta**. Jest to szczegÃ³lnie krytyczne w aplikacjach, gdzie OAuth jest uÅ¼ywany do **celÃ³w uwierzytelniania**.

PrzykÅ‚ady tej podatnoÅ›ci w rzeczywistym Å›wiecie zostaÅ‚y udokumentowane w rÃ³Å¼nych **wyzwaniach CTF** i **platformach do hakowania**, podkreÅ›lajÄ…c jej praktyczne implikacje. Problem ten dotyczy rÃ³wnieÅ¼ integracji z usÅ‚ugami osÃ³b trzecich, takimi jak **Slack**, **Stripe** i **PayPal**, gdzie atakujÄ…cy mogÄ… przekierowaÄ‡ powiadomienia lub pÅ‚atnoÅ›ci na swoje konta.

PrawidÅ‚owe przetwarzanie i weryfikacja parametru **`state`** sÄ… kluczowe dla ochrony przed CSRF i zabezpieczenia przepÅ‚ywu OAuth.

### Przed PrzejÄ™ciem Konta <a href="#ebe4" id="ebe4"></a>

1. **Bez Weryfikacji Email podczas Tworzenia Konta**: AtakujÄ…cy mogÄ… uprzednio utworzyÄ‡ konto, uÅ¼ywajÄ…c adresu e-mail ofiary. JeÅ›li ofiara pÃ³Åºniej uÅ¼yje usÅ‚ugi osÃ³b trzecich do logowania, aplikacja moÅ¼e nieumyÅ›lnie poÅ‚Ä…czyÄ‡ to konto osÃ³b trzecich z wczeÅ›niej utworzonym kontem atakujÄ…cego, co prowadzi do nieautoryzowanego dostÄ™pu.

2. **Wykorzystanie LuÅºnej Weryfikacji Email w OAuth**: AtakujÄ…cy mogÄ… wykorzystaÄ‡ usÅ‚ugi OAuth, ktÃ³re nie weryfikujÄ… adresÃ³w e-mail, rejestrujÄ…c siÄ™ w ich usÅ‚udze, a nastÄ™pnie zmieniajÄ…c adres e-mail konta na adres ofiary. Ta metoda podobnie niesie ryzyko nieautoryzowanego dostÄ™pu do konta, podobnie jak w pierwszym scenariuszu, ale poprzez inny wektor ataku.

### Ujawnienie SekretÃ³w <a href="#e177" id="e177"></a>

Identyfikacja i ochrona tajnych parametrÃ³w OAuth sÄ… kluczowe. Podczas gdy **`client_id`** moÅ¼na bezpiecznie ujawniÄ‡, ujawnienie **`client_secret`** niesie ze sobÄ… znaczne ryzyko. JeÅ›li `client_secret` zostanie skompromitowany, atakujÄ…cy mogÄ… wykorzystaÄ‡ toÅ¼samoÅ›Ä‡ i zaufanie aplikacji do **kradzieÅ¼y `access_tokens`** oraz prywatnych informacji.

PowszechnÄ… podatnoÅ›ciÄ… jest sytuacja, gdy aplikacje bÅ‚Ä™dnie obsÅ‚ugujÄ… wymianÄ™ kodu autoryzacji na `access_token` po stronie klienta, a nie po stronie serwera. Ten bÅ‚Ä…d prowadzi do ujawnienia `client_secret`, umoÅ¼liwiajÄ…c atakujÄ…cym generowanie `access_tokens` pod przykrywkÄ… aplikacji. Ponadto, poprzez inÅ¼ynieriÄ™ spoÅ‚ecznÄ…, atakujÄ…cy mogÄ… eskalowaÄ‡ uprawnienia, dodajÄ…c dodatkowe zakresy autoryzacji OAuth, dalsze wykorzystujÄ…c zaufane status aplikacji.

### Bruteforce Sekretu Klienta

MoÅ¼esz sprÃ³bowaÄ‡ **przeprowadziÄ‡ atak bruteforce na client\_secret** dostawcy usÅ‚ug z dostawcÄ… toÅ¼samoÅ›ci, aby prÃ³bowaÄ‡ kraÅ›Ä‡ konta.\
Å»Ä…danie do BF moÅ¼e wyglÄ…daÄ‡ podobnie do:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Wyciek nagÅ‚Ã³wka Referer z kodem + stanem

Kiedy klient ma **kod i stan**, jeÅ›li jest **odzwierciedlony w nagÅ‚Ã³wku Referer** podczas przeglÄ…dania innej strony, to jest podatny.

### Token dostÄ™pu przechowywany w historii przeglÄ…darki

PrzejdÅº do **historii przeglÄ…darki i sprawdÅº, czy token dostÄ™pu jest zapisany tam**.

### Wieczny kod autoryzacyjny

**Kod autoryzacyjny powinien istnieÄ‡ tylko przez pewien czas, aby ograniczyÄ‡ okno czasowe, w ktÃ³rym atakujÄ…cy moÅ¼e go ukraÅ›Ä‡ i uÅ¼yÄ‡**.

### Token autoryzacji/odÅ›wieÅ¼ania niezwiÄ…zany z klientem

JeÅ›li moÅ¼esz uzyskaÄ‡ **kod autoryzacyjny i uÅ¼yÄ‡ go z innym klientem, to moÅ¼esz przejÄ…Ä‡ inne konta**.

### SzczÄ™Å›liwe Å›cieÅ¼ki, XSS, Iframes & Post Messages do wycieku kodu & wartoÅ›ci stanu

**[SprawdÅº ten post](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)**

### AWS Cognito <a href="#bda5" id="bda5"></a>

W tym raporcie z programu bug bounty: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) moÅ¼esz zobaczyÄ‡, Å¼e **token**, ktÃ³ry **AWS Cognito** zwraca uÅ¼ytkownikowi, moÅ¼e mieÄ‡ **wystarczajÄ…ce uprawnienia do nadpisania danych uÅ¼ytkownika**. Dlatego jeÅ›li moÅ¼esz **zmieniÄ‡ adres e-mail uÅ¼ytkownika na inny adres e-mail**, moÅ¼esz **przejÄ…Ä‡** inne konta.
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
### NaduÅ¼ywanie tokenÃ³w innych aplikacji <a href="#bda5" id="bda5"></a>

Jak [**wspomniano w tym opracowaniu**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), przepÅ‚ywy OAuth, ktÃ³re oczekujÄ… otrzymania **tokena** (a nie kodu), mogÄ… byÄ‡ podatne, jeÅ›li nie sprawdzajÄ…, czy token naleÅ¼y do aplikacji.

To dlatego, Å¼e **atakujÄ…cy** mÃ³gÅ‚by stworzyÄ‡ **aplikacjÄ™ obsÅ‚ugujÄ…cÄ… OAuth i zalogowaÄ‡ siÄ™ przez Facebooka** (na przykÅ‚ad) w swojej wÅ‚asnej aplikacji. NastÄ™pnie, gdy ofiara zaloguje siÄ™ przez Facebooka w **aplikacji atakujÄ…cego**, atakujÄ…cy mÃ³gÅ‚by uzyskaÄ‡ **token OAuth uÅ¼ytkownika udzielony jego aplikacji i uÅ¼yÄ‡ go do zalogowania siÄ™ w aplikacji OAuth ofiary, korzystajÄ…c z tokenu uÅ¼ytkownika ofiary**.

{% hint style="danger" %}
Dlatego jeÅ›li atakujÄ…cy zdoÅ‚a zdobyÄ‡ dostÄ™p uÅ¼ytkownika do swojej wÅ‚asnej aplikacji OAuth, bÄ™dzie mÃ³gÅ‚ przejÄ…Ä‡ konto ofiary w aplikacjach, ktÃ³re oczekujÄ… tokenu i nie sprawdzajÄ…, czy token zostaÅ‚ udzielony dla ich identyfikatora aplikacji.
{% endhint %}

### Dwa linki i ciasteczko <a href="#bda5" id="bda5"></a>

Zgodnie z [**tym opracowaniem**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f), byÅ‚o moÅ¼liwe, aby sprawiÄ‡, Å¼e ofiara otworzy stronÄ™ z **returnUrl** wskazujÄ…cÄ… na host atakujÄ…cego. Te informacje byÅ‚yby **przechowywane w ciasteczku (RU)**, a w **pÃ³Åºniejszym kroku** **prompt** zapyta **uÅ¼ytkownika**, czy chce daÄ‡ dostÄ™p do tego hosta atakujÄ…cego.

Aby ominÄ…Ä‡ ten prompt, moÅ¼na byÅ‚o otworzyÄ‡ kartÄ™, aby zainicjowaÄ‡ **przepÅ‚yw OAuth**, ktÃ³ry ustawiaÅ‚by to ciasteczko RU, uÅ¼ywajÄ…c **returnUrl**, zamknÄ…Ä‡ kartÄ™ przed pokazaniem siÄ™ promptu i otworzyÄ‡ nowÄ… kartÄ™ bez tej wartoÅ›ci. Wtedy **prompt nie poinformuje o hoÅ›cie atakujÄ…cego**, ale ciasteczko zostanie ustawione na niego, wiÄ™c **token zostanie wysÅ‚any do hosta atakujÄ…cego** w przekierowaniu.

### Parametry SSRF <a href="#bda5" id="bda5"></a>

**[SprawdÅº tÄ™ analizÄ™](https://portswigger.net/research/hidden-oauth-attack-vectors) dla dalszych szczegÃ³Å‚Ã³w tej techniki.**

Dynamiczna Rejestracja Klienta w OAuth sÅ‚uÅ¼y jako mniej oczywisty, ale krytyczny wektor podatnoÅ›ci na bezpieczeÅ„stwo, w szczegÃ³lnoÅ›ci dla atakÃ³w **Server-Side Request Forgery (SSRF)**. Ten punkt koÅ„cowy pozwala serwerom OAuth otrzymywaÄ‡ szczegÃ³Å‚y dotyczÄ…ce aplikacji klienta, w tym wraÅ¼liwe adresy URL, ktÃ³re mogÄ… byÄ‡ wykorzystane.

**Kluczowe punkty:**

- **Dynamiczna Rejestracja Klienta** jest czÄ™sto mapowana na `/register` i akceptuje szczegÃ³Å‚y takie jak `client_name`, `client_secret`, `redirect_uris` oraz adresy URL do logotypÃ³w lub zestawÃ³w kluczy JSON Web Key (JWKs) za pomocÄ… Å¼Ä…daÅ„ POST.
- Ta funkcja przestrzega specyfikacji okreÅ›lonych w **RFC7591** i **OpenID Connect Registration 1.0**, ktÃ³re obejmujÄ… parametry potencjalnie podatne na SSRF.
- Proces rejestracji moÅ¼e nieumyÅ›lnie naraziÄ‡ serwery na SSRF na kilka sposobÃ³w:
- **`logo_uri`**: Adres URL logotypu aplikacji klienta, ktÃ³ry moÅ¼e byÄ‡ pobrany przez serwer, wywoÅ‚ujÄ…c SSRF lub prowadzÄ…c do XSS, jeÅ›li adres URL jest Åºle obsÅ‚ugiwany.
- **`jwks_uri`**: Adres URL do dokumentu JWK klienta, ktÃ³ry w przypadku zÅ‚oÅ›liwego opracowania moÅ¼e spowodowaÄ‡, Å¼e serwer wyÅ›le Å¼Ä…dania do serwera kontrolowanego przez atakujÄ…cego.
- **`sector_identifier_uri`**: OdwoÅ‚uje siÄ™ do tablicy JSON `redirect_uris`, ktÃ³rÄ… serwer moÅ¼e pobraÄ‡, tworzÄ…c okazjÄ™ do SSRF.
- **`request_uris`**: Wylicza dozwolone adresy URI Å¼Ä…daÅ„ dla klienta, ktÃ³re mogÄ… byÄ‡ wykorzystane, jeÅ›li serwer pobiera te adresy URI na poczÄ…tku procesu autoryzacji.

**Strategia Wykorzystania:**

- SSRF moÅ¼e zostaÄ‡ wywoÅ‚ane poprzez zarejestrowanie nowego klienta z zÅ‚oÅ›liwymi adresami URL w parametrach takich jak `logo_uri`, `jwks_uri` lub `sector_identifier_uri`.
- Podczas gdy bezpoÅ›rednie wykorzystanie poprzez `request_uris` moÅ¼e byÄ‡ ograniczone przez kontrole biaÅ‚ej listy, dostarczenie wczeÅ›niej zarejestrowanego, kontrolowanego przez atakujÄ…cego `request_uri` moÅ¼e uÅ‚atwiÄ‡ SSRF podczas fazy autoryzacji.

## WyÅ›cig dostawcÃ³w OAuth

JeÅ›li platforma, ktÃ³rÄ… testujesz, jest dostawcÄ… OAuth, [**przeczytaj to, aby przetestowaÄ‡ moÅ¼liwe wyÅ›cigi**](race-condition.md).

## Referencje

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)


<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zfszero do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
