# Zanieczyszczenie Parametr贸w

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si sztuczkami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# Przegld HTTP Parameter Pollution (HPP)

HTTP Parameter Pollution (HPP) to technika, w kt贸rej atakujcy manipuluj parametrami HTTP, aby zmieni zachowanie aplikacji webowej w niezamierzony spos贸b. Manipulacja ta polega na dodawaniu, modyfikowaniu lub duplikowaniu parametr贸w HTTP. Efekt tych manipulacji nie jest bezporednio widoczny dla u偶ytkownika, ale mo偶e znaczco zmieni funkcjonalno aplikacji po stronie serwera, z zauwa偶alnymi skutkami po stronie klienta.

## Przykad Zanieczyszczenia Parametr贸w HTTP (HPP)

URL transakcji aplikacji bankowej:

- **Oryginalny URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Wstawiajc dodatkowy parametr `from`:

- **Manipulowany URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcja mo偶e by bdnie obci偶ona na `accountC` zamiast `accountA`, co pokazuje potencja HPP do manipulacji transakcjami lub innymi funkcjonalnociami, takimi jak resetowanie hase, ustawienia 2FA czy 偶dania kluczy API.

### **Specyficzne dla technologii parsowanie parametr贸w**

- Spos贸b, w jaki parametry s analizowane i priorytetyzowane, zale偶y od u偶ywanej technologii webowej, co wpywa na to, jak HPP mo偶e by wykorzystywane.
- Narzdzia takie jak [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) pomagaj zidentyfikowa te technologie i ich zachowania w zakresie parsowania.

## Wykorzystanie HPP w PHP

**Przypadek manipulacji OTP:**

- **Kontekst:** Mechanizm logowania wymagajcy jednorazowego hasa (OTP) zosta wykorzystany.
- **Metoda:** Poprzez przechwycenie 偶dania OTP za pomoc narzdzi takich jak Burp Suite, atakujcy zduplikowa parametr `email` w 偶daniu HTTP.
- **Wynik:** OTP, przeznaczone dla pocztkowego adresu e-mail, zostao zamiast tego wysane na drugi adres e-mail podany w manipulowanym 偶daniu. Ta luka umo偶liwia nieautoryzowany dostp, omijajc zamierzony rodek bezpieczestwa.

Ten scenariusz podkrela krytyczne niedopatrzenie w backendzie aplikacji, kt贸ry przetwarza pierwszy parametr `email` do generacji OTP, ale u偶ywa ostatniego do dostarczenia.

**Przypadek manipulacji kluczem API:**

- **Scenariusz:** Aplikacja pozwala u偶ytkownikom na aktualizacj swojego klucza API poprzez stron ustawie profilu.
- **Wektor ataku:** Atakujcy odkrywa, 偶e dodajc dodatkowy parametr `api_key` do 偶dania POST, mo偶e manipulowa wynikiem funkcji aktualizacji klucza API.
- **Technika:** Wykorzystujc narzdzie takie jak Burp Suite, atakujcy tworzy 偶danie, kt贸re zawiera dwa parametry `api_key`: jeden prawidowy i jeden zoliwy. Serwer, przetwarzajc tylko ostatnie wystpienie, aktualizuje klucz API na warto podan przez atakujcego.
- **Wynik:** Atakujcy zyskuje kontrol nad funkcjonalnoci API ofiary, potencjalnie uzyskujc dostp do prywatnych danych lub je modyfikujc bez upowa偶nienia.

Ten przykad dodatkowo podkrela konieczno bezpiecznego zarzdzania parametrami, szczeg贸lnie w funkcjach tak krytycznych jak zarzdzanie kluczem API.

## Parsowanie parametr贸w: Flask vs. PHP

Spos贸b, w jaki technologie webowe obsuguj duplikaty parametr贸w HTTP, r贸偶ni si, co wpywa na ich podatno na ataki HPP:

- **Flask:** Przyjmuje pierwsz warto parametru, na przykad `a=1` w cigu zapytania `a=1&a=2`, priorytetujc pocztkowe wystpienie nad kolejnymi duplikatami.
- **PHP (na serwerze Apache HTTP):** Przeciwnie, priorytetowo traktuje ostatni warto parametru, wybierajc `a=2` w podanym przykadzie. To zachowanie mo偶e niezamierzenie uatwi wykorzystanie HPP, honorujc zoliwy parametr atakujcego zamiast oryginalnego.

## Odniesienia
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si sztuczkami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}
