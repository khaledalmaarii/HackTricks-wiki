# Parameter Pollution

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

# Pregled HTTP Parameter Pollution (HPP)

HTTP Parameter Pollution (HPP) je tehnika u kojoj napada캜i manipuli코u HTTP parametrima kako bi promenili pona코anje veb aplikacije na ne쬰ljen na캜in. Ova manipulacija se vr코i dodavanjem, izmenom ili dupliciranjem HTTP parametara. Efekat ovih manipulacija nije direktno vidljiv korisniku, ali mo쬰 zna캜ajno izmeniti funkcionalnost aplikacije na serverskoj strani, sa vidljivim posledicama na klijentskoj strani.

## Primer HTTP Parameter Pollution (HPP)

URL transakcije bankovne aplikacije:

- **Originalni URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Ubacivanjem dodatnog `from` parametra:

- **Manipulisani URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcija mo쬰 biti neta캜no napla캖ena sa ra캜una `accountC` umesto sa ra캜una `accountA`, 코to pokazuje potencijal HPP-a za manipulaciju transakcijama ili drugim funkcionalnostima kao 코to su resetovanje lozinke, pode코avanje dvofaktorne autentifikacije ili zahtevi za API klju캜em.

### **Razlaganje parametara specifi캜no za tehnologiju**

- Na캜in na koji se parametri razla쬿 i prioritizuju zavisi od osnovne veb tehnologije, 코to uti캜e na to kako se HPP mo쬰 iskoristiti.
- Alati poput [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) poma쬿 u identifikaciji ovih tehnologija i njihovog razlaganja parametara.

## PHP i iskori코캖avanje HPP-a

**Slu캜aj manipulacije OTP-om:**

- **Kontekst:** Mehanizam prijave koji zahteva jednokratnu lozinku (OTP) je iskori코캖en.
- **Metod:** Napada캜i su duplirali `email` parametar u HTTP zahtevu tako 코to su presreli zahtev za OTP kori코캖enjem alata poput Burp Suite-a.
- **Ishod:** OTP, namenjen prvobitnom email-u, umesto toga je poslat na drugu email adresu navedenu u manipulisanom zahtevu. Ova gre코ka je omogu캖ila neovla코캖en pristup zaobilaze캖i namensku sigurnosnu meru.

Ovaj scenario isti캜e kriti캜an propust u serverskoj strani aplikacije, koja je obradila prvi `email` parametar za generisanje OTP-a, ali je koristila poslednji za dostavu.

**Slu캜aj manipulacije API klju캜em:**

- **Scenario:** Aplikacija omogu캖ava korisnicima da a쬿riraju svoj API klju캜 putem stranice za pode코avanje profila.
- **Vektor napada:** Napada캜 otkriva da dodavanjem dodatnog `api_key` parametra POST zahtevu mo쬰 manipulisati ishodom funkcije a쬿riranja API klju캜a.
- **Tehnika:** Kori코캖enjem alata poput Burp Suite-a, napada캜 kreira zahtev koji uklju캜uje dva `api_key` parametra: jedan legitimni i jedan zlonamerni. Server, obra캠uju캖i samo poslednje pojavljivanje, a쬿rira API klju캜 na vrednost koju je napada캜 pru쬴o.
- **Rezultat:** Napada캜 dobija kontrolu nad funkcionalno코캖u API-ja rtve, potencijalno pristupaju캖i ili menjaju캖i privatne podatke neovla코캖eno.

Ovaj primer dodatno nagla코ava potrebu za sigurnom obradom parametara, posebno u funkcionalnostima koje su kriti캜ne poput upravljanja API klju캜em.

## Razlaganje parametara: Flask vs. PHP

Na캜in na koji veb tehnologije obra캠uju duplicirane HTTP parametre varira, 코to uti캜e na njihovu podlo쬹ost HPP napadima:

- **Flask:** Prihvata vrednost prvog parametra koji se sretne, kao 코to je `a=1` u upitu `a=1&a=2`, daju캖i prioritet prvobitnom primerku u odnosu na kasnije duplicirane vrednosti.
- **PHP (na Apache HTTP Server-u):** Suprotno tome, daje prioritet poslednjoj vrednosti parametra, biraju캖i `a=2` u datom primeru. Ovo pona코anje nenamerno mo쬰 olak코ati HPP iskori코캖avanje tako 코to 캖e po코tovati napada캜ev manipulisani parametar umesto originalnog.

## Reference
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
