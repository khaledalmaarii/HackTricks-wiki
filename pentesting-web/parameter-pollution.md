# Parameter Pollution

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks suvenir**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# Pregled HTTP Parameter Pollution (HPP)

HTTP Parameter Pollution (HPP) je tehnika gde napada캜i manipuli코u HTTP parametrima kako bi promenili pona코anje veb aplikacije na ne쬰ljen na캜in. Ova manipulacija se vr코i dodavanjem, modifikovanjem ili dupliranjem HTTP parametara. Efekat ovih manipulacija nije direktno vidljiv korisniku, ali mo쬰 zna캜ajno promeniti funkcionalnost aplikacije na serverskoj strani, sa vidljivim uticajima na klijentskoj strani.

## Primer HTTP Parameter Pollution (HPP)

URL transakcije bankarske aplikacije:

- **Originalni URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Ubacivanjem dodatnog `from` parametra:

- **Manipulisani URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcija mo쬰 biti pogre코no napla캖ena na `accountC` umesto na `accountA`, prikazuju캖i potencijal HPP-a za manipulaciju transakcijama ili drugim funkcionalnostima poput resetovanja lozinke, pode코avanja 2FA ili zahteva za API klju캜em.

### **Parsiranje Parametara Specifi캜no za Tehnologiju**

- Na캜in na koji se parametri parsiraju i prioritetizuju zavisi od osnovne veb tehnologije, uti캜u캖i na to kako HPP mo쬰 biti iskori코캖en.
- Alati poput [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) poma쬿 u identifikaciji ovih tehnologija i njihovih na캜ina parsiranja.

## PHP i Iskori코캖avanje HPP-a

**Slu캜aj Manipulacije OTP-om:**

- **Kontekst:** Mehanizam prijave koji zahteva Jednokratnu Lozinku (OTP) je iskori코캖en.
- **Metod:** Interceptiranjem zahteva za OTP kori코캖enjem alata poput Burp Suite, napada캜i su duplirali `email` parametar u HTTP zahtevu.
- **Ishod:** OTP, namenjen prvobitnom emailu, umesto toga je poslat na drugu email adresu navedenu u manipulisanom zahtevu. Ova gre코ka je omogu캖ila neovla코캖en pristup zaobilaze캖i namensku sigurnosnu meru.

Ovaj scenario isti캜e kriti캜an propust u serverskoj strani aplikacije, koja je obradila prvi `email` parametar za generisanje OTP-a, ali je koristila poslednji za dostavu.

**Slu캜aj Manipulacije API klju캜em:**

- **Scenario:** Aplikacija omogu캖ava korisnicima da a쬿riraju svoj API klju캜 putem stranice za pode코avanje profila.
- **Vektor Napada:** Napada캜 otkriva da dodavanjem dodatnog `api_key` parametra POST zahtevu, mo쬰 manipulisati ishodom funkcije a쬿riranja API klju캜a.
- **Tehnika:** Koriste캖i alat poput Burp Suite, napada캜 kreira zahtev koji uklju캜uje dva `api_key` parametra: jedan legitimni i jedan zlonamerni. Server, obra캠uju캖i samo poslednje pojavljivanje, a쬿rira API klju캜 na vrednost koju je napada캜 pru쬴o.
- **Rezultat:** Napada캜 dobija kontrolu nad funkcionalno코캖u API-ja rtve, potencijalno pristupaju캖i ili modifikuju캖i privatne podatke neovla코캖eno.

Ovaj primer dodatno isti캜e neophodnost sigurnog rukovanja parametrima, posebno u funkcionalnostima kao 코to je upravljanje API klju캜em.

## Parsiranje Parametara: Flask vs. PHP

Na캜in na koji veb tehnologije rukuju duplim HTTP parametrima varira, uti캜u캖i na njihovu podlo쬹ost HPP napadima:

- **Flask:** Prihvata vrednost prvog parametra koji se susre캖e, kao 코to je `a=1` u upitu `a=1&a=2`, daju캖i prioritet po캜etnom primerku nad kasnijim duplikatima.
- **PHP (na Apache HTTP Serveru):** Suprotno tome, daje prioritet poslednjoj vrednosti parametra, biraju캖i `a=2` u datom primeru. Ovo pona코anje mo쬰 nenamerno olak코ati HPP eksploataciju po코tuju캖i napada캜ev manipulisani parametar iznad originalnog.

## Reference
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks suvenir**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
