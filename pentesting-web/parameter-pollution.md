# Zanieczyszczenie parametru

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w GitHub.

</details>

# Przegld zanieczyszczenia parametru HTTP (HPP)

Zanieczyszczenie parametru HTTP (HPP) to technika, w kt贸rej atakujcy manipuluj parametrami HTTP, zmieniajc zachowanie aplikacji internetowej w niezamierzony spos贸b. Manipulacja ta polega na dodawaniu, modyfikowaniu lub duplikowaniu parametr贸w HTTP. Efekt tych manipulacji nie jest bezporednio widoczny dla u偶ytkownika, ale mo偶e znaczco zmieni funkcjonalno aplikacji po stronie serwera, majc obserwowalne skutki po stronie klienta.

## Przykad zanieczyszczenia parametru HTTP (HPP)

URL transakcji aplikacji bankowej:

- **Oryginalny URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Poprzez dodanie dodatkowego parametru `from`:

- **Zmodyfikowany URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcja mo偶e zosta bdnie obci偶ona na rzecz konta `accountC` zamiast `accountA`, co pokazuje potencja HPP do manipulowania transakcjami lub innymi funkcjonalnociami, takimi jak resetowanie hasa, ustawienia 2FA lub 偶dania klucza API.

### **Analiza parametr贸w specyficznych dla technologii**

- Spos贸b analizy i priorytetu parametr贸w zale偶y od u偶ywanej technologii internetowej, co wpywa na spos贸b wykorzystania HPP.
- Narzdzia takie jak [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) pomagaj zidentyfikowa te technologie i ich zachowanie w analizie parametr贸w.

## Wykorzystanie PHP i HPP

**Przykad manipulacji OTP:**

- **Kontekst:** Mechanizm logowania wymagajcy jednorazowego hasa (OTP) zosta wykorzystany.
- **Metoda:** Atakujcy podwaja parametr `email` w 偶daniu HTTP, przechwytujc 偶danie OTP za pomoc narzdzi takich jak Burp Suite.
- **Wynik:** OTP, przeznaczone dla pocztkowego adresu e-mail, zostao wysane na drugi adres e-mail okrelony w zmodyfikowanym 偶daniu. Ta luka umo偶liwiaa nieautoryzowany dostp poprzez obejcie zamierzonego zabezpieczenia.

Ten scenariusz podkrela powa偶ne przeoczenie w aplikacji backendowej, kt贸ra przetwarzaa pierwszy parametr `email` w celu wygenerowania OTP, ale u偶ywaa ostatniego parametru do dostarczenia go.

**Przykad manipulacji kluczem API:**

- **Scenariusz:** Aplikacja umo偶liwia u偶ytkownikom aktualizacj ich klucza API za pomoc strony ustawie profilu.
- **Wektor ataku:** Atakujcy odkrywa, 偶e dodajc dodatkowy parametr `api_key` do 偶dania POST, mo偶e manipulowa wynikiem funkcji aktualizacji klucza API.
- **Technika:** Wykorzystujc narzdzie takie jak Burp Suite, atakujcy tworzy 偶danie, kt贸re zawiera dwa parametry `api_key`: jeden legalny i jeden zoliwy. Serwer, przetwarzajc tylko ostatnie wystpienie, aktualizuje klucz API na warto podan przez atakujcego.
- **Wynik:** Atakujcy uzyskuje kontrol nad funkcjonalnoci API ofiary, potencjalnie uzyskujc nieautoryzowany dostp do prywatnych danych lub ich modyfikacj.

Ten przykad dodatkowo podkrela konieczno bezpiecznego obsugiwania parametr贸w, zwaszcza w funkcjach tak krytycznych jak zarzdzanie kluczem API.

## Analiza parametr贸w: Flask vs PHP

Spos贸b obsugi duplikowanych parametr贸w HTTP r贸偶ni si w zale偶noci od technologii internetowych, co wpywa na podatno na ataki HPP:

- **Flask:** Przyjmuje warto pierwszego napotkanego parametru, na przykad `a=1` w cigu zapytania `a=1&a=2`, przy czym pierwsze wystpienie ma pierwszestwo przed kolejnymi duplikatami.
- **PHP (na serwerze HTTP Apache):** W przeciwnym razie, priorytet ma ostatnia warto parametru, wybierajc `a=2` w podanym przykadzie. To zachowanie mo偶e nieumylnie uatwia ataki HPP, honorujc manipulowany parametr atakujcego nad oryginalnym.

## Odwoania
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w GitHub.

</details>
