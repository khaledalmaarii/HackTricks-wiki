# Parameter Pollution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# HTTP Parameter Pollution (HPP) Overview

HTTP Parameter Pollution (HPP) je tehnika gde napada캜i manipuli코u HTTP parametrima kako bi promenili pona코anje web aplikacije na nepredvi캠ene na캜ine. Ova manipulacija se vr코i dodavanjem, modifikovanjem ili dupliciranjem HTTP parametara. Efekat ovih manipulacija nije direktno vidljiv korisniku, ali mo쬰 zna캜ajno promeniti funkcionalnost aplikacije na serverskoj strani, sa uo캜ljivim uticajima na klijentskoj strani.

## Example of HTTP Parameter Pollution (HPP)

URL transakcije bankarske aplikacije:

- **Original URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Umetanjem dodatnog `from` parametra:

- **Manipulated URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcija mo쬰 biti pogre코no napla캖ena na `accountC` umesto na `accountA`, pokazuju캖i potencijal HPP-a da manipuli코e transakcijama ili drugim funkcionalnostima kao 코to su resetovanje lozinke, pode코avanja 2FA ili zahtevi za API klju캜em.

### **Technology-Specific Parameter Parsing**

- Na캜in na koji se parametri analiziraju i prioritetizuju zavisi od osnovne web tehnologije, 코to uti캜e na to kako se HPP mo쬰 iskoristiti.
- Alati poput [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) poma쬿 u identifikaciji ovih tehnologija i njihovih pona코anja prilikom analize.

## PHP and HPP Exploitation

**OTP Manipulation Case:**

- **Context:** Mehanizam prijavljivanja koji zahteva jednokratnu lozinku (OTP) je iskori코캖en.
- **Method:** Presretanjem OTP zahteva koriste캖i alate poput Burp Suite, napada캜i su duplicirali `email` parametar u HTTP zahtevu.
- **Outcome:** OTP, namenjen za inicijalnu email adresu, umesto toga je poslat na drugu email adresu navedenu u manipulisanom zahtevu. Ova gre코ka je omogu캖ila neovla코캖en pristup zaobila쬰njem predvi캠ene sigurnosne mere.

Ovaj scenario isti캜e kriti캜an propust u backend-u aplikacije, koji je obradio prvi `email` parametar za generisanje OTP-a, ali je koristio poslednji za isporuku.

**API Key Manipulation Case:**

- **Scenario:** Aplikacija omogu캖ava korisnicima da a쬿riraju svoj API klju캜 putem stranice za pode코avanje profila.
- **Attack Vector:** Napada캜 otkriva da dodavanjem dodatnog `api_key` parametra u POST zahtev mo쬰 manipulisati ishodom funkcije a쬿riranja API klju캜a.
- **Technique:** Koriste캖i alat poput Burp Suite, napada캜 kreira zahtev koji uklju캜uje dva `api_key` parametra: jedan legitimni i jedan zlonameran. Server, obra캠uju캖i samo poslednju pojavu, a쬿rira API klju캜 na vrednost koju je naveo napada캜.
- **Result:** Napada캜 dobija kontrolu nad funkcionalno코캖u API-ja rtve, potencijalno pristupaju캖i ili modifikuju캖i privatne podatke neovla코캖eno.

Ovaj primer dodatno nagla코ava potrebu za sigurnim rukovanjem parametrima, posebno u funkcijama koje su kriti캜ne kao 코to je upravljanje API klju캜em.

## Parameter Parsing: Flask vs. PHP

Na캜in na koji web tehnologije obra캠uju duple HTTP parametre varira, uti캜u캖i na njihovu podlo쬹ost HPP napadima:

- **Flask:** Usvaja prvu vrednost parametra koja se susre캖e, kao 코to je `a=1` u upitu `a=1&a=2`, prioritetizuju캖i inicijalnu instancu nad kasnijim duplikatima.
- **PHP (na Apache HTTP Server-u):** Nasuprot tome, prioritetizuje poslednju vrednost parametra, biraju캖i `a=2` u datom primeru. Ovo pona코anje mo쬰 nenamerno olak코ati HPP eksploate tako 코to po코tuje manipulisan parametar napada캜a umesto originalnog.

## References
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
