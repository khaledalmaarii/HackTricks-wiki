# Parametre KirliliÄŸi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# HTTP Parametre KirliliÄŸi (HPP) Genel BakÄ±ÅŸ

HTTP Parametre KirliliÄŸi (HPP), saldÄ±rganlarÄ±n HTTP parametrelerini manipÃ¼le ederek bir web uygulamasÄ±nÄ±n davranÄ±ÅŸÄ±nÄ± beklenmedik ÅŸekillerde deÄŸiÅŸtirdiÄŸi bir tekniktir. Bu manipÃ¼lasyon, HTTP parametrelerini ekleyerek, deÄŸiÅŸtirerek veya Ã§oÄŸaltarak gerÃ§ekleÅŸtirilir. Bu manipÃ¼lasyonlarÄ±n etkisi kullanÄ±cÄ±ya doÄŸrudan gÃ¶rÃ¼nmez, ancak uygulamanÄ±n sunucu tarafÄ±ndaki iÅŸlevselliÄŸini Ã¶nemli Ã¶lÃ§Ã¼de deÄŸiÅŸtirebilir ve istemci tarafÄ±nda gÃ¶zlemlenebilir etkiler yaratabilir.

## HTTP Parametre KirliliÄŸi (HPP) Ã–rneÄŸi

Bir bankacÄ±lÄ±k uygulamasÄ± iÅŸlem URL'si:

- **Orijinal URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Ek bir `from` parametresi ekleyerek:

- **ManipÃ¼le EdilmiÅŸ URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Ä°ÅŸlem, `accountA` yerine yanlÄ±ÅŸlÄ±kla `accountC`'ye yansÄ±tÄ±labilir ve bu durum HPP'nin iÅŸlemleri veya ÅŸifre sÄ±fÄ±rlama, 2FA ayarlarÄ± veya API anahtarÄ± talepleri gibi diÄŸer iÅŸlevleri manipÃ¼le etme potansiyelini gÃ¶stermektedir.

### **Teknolojiye Ã–zgÃ¼ Parametre AyrÄ±ÅŸtÄ±rma**

- Parametrelerin nasÄ±l ayrÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ± ve Ã¶nceliklendirildiÄŸi, temel web teknolojisine baÄŸlÄ±dÄ±r ve HPP'nin nasÄ±l istismar edilebileceÄŸini etkiler.
- [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) gibi araÃ§lar, bu teknolojileri ve ayrÄ±ÅŸtÄ±rma davranÄ±ÅŸlarÄ±nÄ± tanÄ±mlamaya yardÄ±mcÄ± olur.

## PHP ve HPP Ä°stismarÄ±

**OTP ManipÃ¼lasyonu Durumu:**

- **BaÄŸlam:** Tek Seferlik Åifre (OTP) gerektiren bir giriÅŸ mekanizmasÄ± istismar edildi.
- **YÃ¶ntem:** Burp Suite gibi araÃ§lar kullanarak OTP talebini kesen saldÄ±rganlar, HTTP isteÄŸindeki `email` parametresini Ã§oÄŸalttÄ±.
- **SonuÃ§:** Ä°lk e-posta iÃ§in tasarlanan OTP, manipÃ¼le edilmiÅŸ istekte belirtilen ikinci e-posta adresine gÃ¶nderildi. Bu hata, amaÃ§lanan gÃ¼venlik Ã¶nlemini aÅŸarak yetkisiz eriÅŸime izin verdi.

Bu senaryo, uygulamanÄ±n arka ucundaki kritik bir gÃ¶zden geÃ§irmeyi vurgular; OTP Ã¼retimi iÃ§in ilk `email` parametresini iÅŸleyen ancak teslimat iÃ§in sonuncusunu kullanan bir durumdur.

**API AnahtarÄ± ManipÃ¼lasyonu Durumu:**

- **Senaryo:** Bir uygulama, kullanÄ±cÄ±larÄ±n profil ayarlarÄ± sayfasÄ± aracÄ±lÄ±ÄŸÄ±yla API anahtarlarÄ±nÄ± gÃ¼ncellemelerine izin verir.
- **SaldÄ±rÄ± VektÃ¶rÃ¼:** Bir saldÄ±rgan, POST isteÄŸine ek bir `api_key` parametresi ekleyerek API anahtarÄ± gÃ¼ncelleme iÅŸlevinin sonucunu manipÃ¼le edebileceÄŸini keÅŸfeder.
- **Teknik:** Burp Suite gibi bir araÃ§ kullanarak, saldÄ±rgan bir geÃ§erli ve bir kÃ¶tÃ¼ niyetli `api_key` parametresi iÃ§eren bir istek hazÄ±rlar. Sunucu, yalnÄ±zca sonuncusunu iÅŸleyerek, API anahtarÄ±nÄ± saldÄ±rganÄ±n saÄŸladÄ±ÄŸÄ± deÄŸere gÃ¼nceller.
- **SonuÃ§:** SaldÄ±rgan, maÄŸdurun API iÅŸlevselliÄŸi Ã¼zerinde kontrol kazanÄ±r ve muhtemelen Ã¶zel verilere yetkisiz eriÅŸim veya deÄŸiÅŸiklik yapabilir.

Bu Ã¶rnek, Ã¶zellikle API anahtarÄ± yÃ¶netimi gibi kritik Ã¶zelliklerde gÃ¼venli parametre yÃ¶netiminin gerekliliÄŸini daha da vurgular.

## Parametre AyrÄ±ÅŸtÄ±rma: Flask vs. PHP

Web teknolojilerinin Ã§oÄŸaltÄ±lmÄ±ÅŸ HTTP parametrelerini ele alma ÅŸekli, HPP saldÄ±rÄ±larÄ±na karÅŸÄ± duyarlÄ±lÄ±klarÄ±nÄ± etkiler:

- **Flask:** Bir sorgu dizesinde `a=1&a=2` gibi ilk karÅŸÄ±laÅŸÄ±lan parametre deÄŸerini benimser, ilk Ã¶rneÄŸi sonraki Ã§oÄŸaltmalara tercih eder.
- **PHP (Apache HTTP Sunucusu Ã¼zerinde):** Aksine, son parametre deÄŸerini Ã¶nceliklendirir ve verilen Ã¶rnekte `a=2` seÃ§ilir. Bu davranÄ±ÅŸ, saldÄ±rganÄ±n manipÃ¼le ettiÄŸi parametreyi orijinaline tercih ederek HPP istismarlarÄ±nÄ± kolaylaÅŸtÄ±rabilir.

## Referanslar
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
