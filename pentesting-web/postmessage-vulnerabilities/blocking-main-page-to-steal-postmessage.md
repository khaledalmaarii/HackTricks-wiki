# ë©”ì¸ í˜ì´ì§€ ì°¨ë‹¨í•˜ì—¬ postmessage ë„ìš©í•˜ê¸°

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤**í•˜ê±°ë‚˜ **HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”. ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter**ì—ì„œ **íŒ”ë¡œìš°**í•˜ì„¸ìš” ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)ì™€ [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

## Iframesë¡œ RC íšë“í•˜ê¸°

[**Terjanqì˜ writeup**](https://gist.github.com/terjanq/7c1a71b83db5e02253c218765f96a710)ì— ë”°ë¥´ë©´, null ì›ë³¸ì—ì„œ ìƒì„±ëœ blob ë¬¸ì„œëŠ” ë³´ì•ˆìƒì˜ ì´ì ì„ ìœ„í•´ ê²©ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì¦‰, ë©”ì¸ í˜ì´ì§€ë¥¼ ê³„ì† ìœ ì§€í•˜ë©´ iframe í˜ì´ì§€ê°€ ì‹¤í–‰ë  ê²ƒì´ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ ë„ì „ì—ì„œëŠ” **ê²©ë¦¬ëœ iframeì´ ì‹¤í–‰**ë˜ê³ , ê·¸ **ë¡œë”©ì´ ì™„ë£Œëœ ì§í›„**ì— **ë¶€ëª¨** í˜ì´ì§€ê°€ **í”Œë˜ê·¸ë¥¼ í¬í•¨í•œ post ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤**.\
ê·¸ëŸ¬ë‚˜, ì´ postmessage í†µì‹ ì€ XSSì— ì·¨ì•½í•©ë‹ˆë‹¤ (iframeì—ì„œ JS ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ).

ë”°ë¼ì„œ, ê³µê²©ìì˜ ëª©í‘œëŠ” **ë¶€ëª¨ê°€ iframeì„ ìƒì„±í•˜ë„ë¡ í•˜ë˜**, **ë¶€ëª¨ í˜ì´ì§€ê°€ ë¯¼ê°í•œ ë°ì´í„°(í”Œë˜ê·¸)ë¥¼ ë³´ë‚´ê¸° ì „ì— ë°”ì˜ê²Œ ìœ ì§€**í•˜ê³  **í˜ì´ë¡œë“œë¥¼ iframeìœ¼ë¡œ ë³´ë‚´ëŠ” ê²ƒ**ì…ë‹ˆë‹¤. ë¶€ëª¨ê°€ ë°”ìœ ë™ì•ˆ **iframeì€ í˜ì´ë¡œë“œë¥¼ ì‹¤í–‰**í•˜ë©°, ì´ëŠ” **ë¶€ëª¨ postmessage ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ê³  í”Œë˜ê·¸ë¥¼ ìœ ì¶œ**í•  JS ì½”ë“œì…ë‹ˆë‹¤.\
ë§ˆì§€ë§‰ìœ¼ë¡œ, iframeì´ í˜ì´ë¡œë“œë¥¼ ì‹¤í–‰í•˜ê³  ë¶€ëª¨ í˜ì´ì§€ê°€ ë°”ì¨ì„ ë©ˆì¶”ë©´ í”Œë˜ê·¸ê°€ ì „ì†¡ë˜ê³  í˜ì´ë¡œë“œê°€ ì´ë¥¼ ìœ ì¶œí•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜, **ë¶€ëª¨ê°€ iframeì„ ìƒì„±í•œ ì§í›„ì— ë°”ì˜ê²Œ ìœ ì§€í•˜ê³  iframeì´ ì¤€ë¹„ë˜ì–´ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œê¹Œì§€** ì–´ë–»ê²Œ í•  ìˆ˜ ìˆì„ê¹Œìš”? ê¸°ë³¸ì ìœ¼ë¡œ, ë¶€ëª¨ê°€ **ì‹¤í–‰**í•  ìˆ˜ ìˆëŠ” **ë¹„ë™ê¸° ì‘ì—…**ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ ë„ì „ì—ì„œëŠ” ë¶€ëª¨ê°€ ë‹¤ìŒê³¼ ê°™ì€ **postmessage**ë¥¼ **ì²­ì·¨**í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤:
```javascript
window.addEventListener('message', (e) => {
if (e.data == 'blob loaded') {
$("#previewModal").modal();
}
});
```
ê·¸ë˜ì„œ **postmessageì— í° ì •ìˆ˜ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆì—ˆê³ **, í•´ë‹¹ ë¹„êµì—ì„œ **ë¬¸ìì—´ë¡œ ë³€í™˜**ë˜ì–´ ì‹œê°„ì´ ì†Œìš”ë˜ì—ˆìŠµë‹ˆë‹¤.
```bash
const buffer = new Uint8Array(1e7);
win?.postMessage(buffer, '*', [buffer.buffer]);
```
ê·¸ë¦¬ê³  ì •í™•í•˜ê²Œ **postmessage**ì„ ë³´ë‚´ê¸° ìœ„í•´ì„œëŠ” **iframe**ì´ ìƒì„±ëœ í›„ì— **ë¶€ëª¨ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•  ì¤€ë¹„ê°€ ë˜ê¸° ì „ì—** ë³´ë‚´ì•¼ í•˜ë¯€ë¡œ, **`setTimeout`ì˜ ë°€ë¦¬ì´ˆë¥¼ ì¡°ì ˆ**í•´ì•¼ í•©ë‹ˆë‹¤.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”**? ë˜ëŠ” **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter**ì—ì„œ ì €ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš” ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)ì™€ [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•´ì£¼ì„¸ìš”.

</details>
