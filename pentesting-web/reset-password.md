# Åifre SÄ±fÄ±rlama/Unutulan Åifre Atlatma

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hackleme Ä°Ã§gÃ¶rÃ¼leri**\
Hackleme heyecanÄ±nÄ± ve zorluklarÄ±nÄ± ele alan iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zla deÄŸiÅŸen hackleme dÃ¼nyasÄ±nda gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle gÃ¼ncel kalÄ±n

**En Son Duyurular**\
BaÅŸlatÄ±lan en yeni Ã¶dÃ¼l avÄ± programlarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

## **Referans Ãœzerinden Åifre SÄ±fÄ±rlama Jetonu SÄ±zÄ±ntÄ±sÄ±**

* EÄŸer URL'de bulunuyorsa, HTTP referer baÅŸlÄ±ÄŸÄ± ÅŸifre sÄ±fÄ±rlama jetonunu sÄ±zdÄ±rabilir. Bu durum, bir kullanÄ±cÄ±nÄ±n ÅŸifre sÄ±fÄ±rlama isteÄŸinden sonra Ã¼Ã§Ã¼ncÃ¼ taraf bir web sitesi baÄŸlantÄ±sÄ±na tÄ±kladÄ±ÄŸÄ±nda meydana gelebilir.
* **Etki**: Cross-Site Request Forgery (CSRF) saldÄ±rÄ±larÄ± aracÄ±lÄ±ÄŸÄ±yla potansiyel hesap ele geÃ§irme.
* **SÃ¶mÃ¼rÃ¼**: Bir ÅŸifre sÄ±fÄ±rlama jetonunun referer baÅŸlÄ±ÄŸÄ±nda sÄ±zÄ±p sÄ±zmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in, **e-posta adresinize bir ÅŸifre sÄ±fÄ±rlama isteÄŸi gÃ¶nderin** ve saÄŸlanan sÄ±fÄ±rlama baÄŸlantÄ±sÄ±na **tÄ±klayÄ±n**. Åifrenizi hemen deÄŸiÅŸtirmeyin. Bunun yerine, **Burp Suite** kullanarak **Ã¼Ã§Ã¼ncÃ¼ taraf bir web sitesine** (Facebook veya Twitter gibi) **gezin**. Ä°stekleri inceleyerek, referer baÅŸlÄ±ÄŸÄ±nÄ±n ÅŸifre sÄ±fÄ±rlama jetonunu iÃ§erip iÃ§ermediÄŸini kontrol edin, Ã§Ã¼nkÃ¼ bu hassas bilgilerin Ã¼Ã§Ã¼ncÃ¼ taraflara aÃ§Ä±ÄŸa Ã§Ä±kmasÄ±na neden olabilir.
* **Referanslar**:
* [HackerOne Raporu 342693](https://hackerone.com/reports/342693)
* [HackerOne Raporu 272379](https://hackerone.com/reports/272379)
* [Åifre SÄ±fÄ±rlama Jetonu SÄ±zÄ±ntÄ±sÄ± Makalesi](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Åifre SÄ±fÄ±rlama Zehirlenmesi**

* SaldÄ±rganlar, ÅŸifre sÄ±fÄ±rlama istekleri sÄ±rasÄ±nda Host baÅŸlÄ±ÄŸÄ±nÄ± manipÃ¼le ederek sÄ±fÄ±rlama baÄŸlantÄ±sÄ±nÄ± kÃ¶tÃ¼ niyetli bir siteye yÃ¶nlendirebilir.
* **Etki**: SÄ±fÄ±rlama jetonlarÄ±nÄ± saldÄ±rganlara sÄ±zdÄ±rarak potansiyel hesap ele geÃ§irmeye yol aÃ§ar.
* **Ã–nlem AdÄ±mlarÄ±**:
* Host baÅŸlÄ±ÄŸÄ±nÄ± izin verilen alan adlarÄ± beyaz listesine karÅŸÄ± doÄŸrulayÄ±n.
* Mutlak URL'ler oluÅŸturmak iÃ§in gÃ¼venli, sunucu taraflÄ± yÃ¶ntemler kullanÄ±n.
* **Yama**: Åifre sÄ±fÄ±rlama URL'lerini oluÅŸturmak iÃ§in `$_SERVER['HTTP_HOST']` yerine `$_SERVER['SERVER_NAME']` kullanÄ±n.
* **Referanslar**:
* [Acunetix'ten Åifre SÄ±fÄ±rlama Zehirlenmesi Makalesi](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **E-posta Parametresini ManipÃ¼le Ederek Åifre SÄ±fÄ±rlama**

SaldÄ±rganlar, ÅŸifre sÄ±fÄ±rlama isteÄŸini yÃ¶nlendirmek iÃ§in ek e-posta parametreleri ekleyerek manipÃ¼le edebilir.

* Ä°kinci parametre olarak saldÄ±rgan e-postasÄ±nÄ± ekleyin &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Attacker e-postasÄ±nÄ± ikinci parametre olarak %20 kullanarak ekleyin
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* SaldÄ±rgan e-postasÄ±nÄ± ikinci parametre olarak ekleyin |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Ä°kinci parametre olarak saldÄ±rgan e-postasÄ±nÄ± cc olarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Ä°kinci parametre olarak saldÄ±rgan e-postasÄ±nÄ± bcc olarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* SaldÄ±rgan e-postasÄ±nÄ± ikinci parametre olarak , kullanarak ekleyin.
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Attacker e-postasÄ±nÄ± ikinci parametre olarak json dizisine ekleyin
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Ã–nleme AdÄ±mlarÄ±**:
* Sunucu tarafÄ±nda e-posta parametrelerini doÄŸru bir ÅŸekilde ayrÄ±ÅŸtÄ±rÄ±n ve doÄŸrulayÄ±n.
* Enjeksiyon saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in hazÄ±rlanmÄ±ÅŸ ifadeler veya parametreli sorgular kullanÄ±n.
* **Referanslar**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **API Parametreleri AracÄ±lÄ±ÄŸÄ±yla Herhangi Bir KullanÄ±cÄ±nÄ±n E-posta ve Åifresini DeÄŸiÅŸtirme**

* SaldÄ±rganlar, hesap kimlik bilgilerini deÄŸiÅŸtirmek iÃ§in API isteklerinde e-posta ve ÅŸifre parametrelerini deÄŸiÅŸtirebilirler.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Ã–nleme AdÄ±mlarÄ±**:
* SÄ±kÄ± parametre doÄŸrulamasÄ± ve kimlik doÄŸrulama kontrolleri saÄŸlayÄ±n.
* ÅÃ¼pheli faaliyetleri tespit etmek ve yanÄ±tlamak iÃ§in gÃ¼Ã§lÃ¼ gÃ¼nlÃ¼kleme ve izleme uygulayÄ±n.
* **Referans**:
* [API Parametre ManipÃ¼lasyonu AracÄ±lÄ±ÄŸÄ±yla Tam Hesap Ele GeÃ§irme](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **HÄ±z SÄ±nÄ±rlamasÄ± Yok: E-posta BombardÄ±manÄ±**

* Åifre sÄ±fÄ±rlama isteklerinde hÄ±z sÄ±nÄ±rlamasÄ±nÄ±n olmamasÄ±, kullanÄ±cÄ±yÄ± sÄ±fÄ±rlama e-postalarÄ±yla ezme riskini taÅŸÄ±r.
* **Ã–nleme AdÄ±mlarÄ±**:
* IP adresine veya kullanÄ±cÄ± hesabÄ±na dayalÄ± hÄ±z sÄ±nÄ±rlamasÄ± uygulayÄ±n.
* Otomatik kÃ¶tÃ¼ye kullanÄ±mÄ± Ã¶nlemek iÃ§in CAPTCHA zorluklarÄ± kullanÄ±n.
* **Referanslar**:
* [HackerOne Rapor 280534](https://hackerone.com/reports/280534)

## **Åifre SÄ±fÄ±rlama Jetonunun NasÄ±l OluÅŸturulduÄŸunu Bulma**

* Jeton oluÅŸturma desenini veya yÃ¶ntemini anlamak, jetonlarÄ± tahmin etmeye veya kaba kuvvet uygulamaya yol aÃ§abilir. BazÄ± seÃ§enekler:
* Zaman DamgasÄ±na DayalÄ±
* KullanÄ±cÄ± KimliÄŸine DayalÄ±
* KullanÄ±cÄ±nÄ±n E-postasÄ±na DayalÄ±
* Ad ve Soyada DayalÄ±
* DoÄŸum Tarihine DayalÄ±
* Kriptografiye DayalÄ±
* **Ã–nleme AdÄ±mlarÄ±**:
* Jeton oluÅŸturmak iÃ§in gÃ¼Ã§lÃ¼, kriptografik yÃ¶ntemler kullanÄ±n.
* Tahmin edilebilirliÄŸi Ã¶nlemek iÃ§in yeterli rastgelelik ve uzunluk saÄŸlayÄ±n.
* **AraÃ§lar**: JetonlarÄ±n rastgeleliÄŸini analiz etmek iÃ§in Burp Sequencer'Ä± kullanÄ±n.

## **Tahmin Edilebilir UUID**

* UUID'lerin (sÃ¼rÃ¼m 1) tahmin edilebilir veya Ã¶ngÃ¶rÃ¼lebilir olmasÄ± durumunda, saldÄ±rganlar bunlarÄ± geÃ§erli sÄ±fÄ±rlama jetonlarÄ± oluÅŸturmak iÃ§in kaba kuvvet uygulayabilir. Kontrol edin:
{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Ã–nleme AdÄ±mlarÄ±**:
* Rastgelelik iÃ§in GUID sÃ¼rÃ¼m 4 kullanÄ±n veya diÄŸer sÃ¼rÃ¼mler iÃ§in ek gÃ¼venlik Ã¶nlemleri uygulayÄ±n.
* **AraÃ§lar**: [guidtool](https://github.com/intruder-io/guidtool) kullanarak GUID'leri analiz etme ve oluÅŸturma.

## **YanÄ±t ManipÃ¼lasyonu: KÃ¶tÃ¼ YanÄ±tÄ± Ä°yi Olanla DeÄŸiÅŸtirme**

* HTTP yanÄ±tlarÄ±nÄ± manipÃ¼le ederek hata mesajlarÄ±nÄ± veya kÄ±sÄ±tlamalarÄ± atlamak.
* **Ã–nleme AdÄ±mlarÄ±**:
* YanÄ±t bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ saÄŸlamak iÃ§in sunucu taraflÄ± kontrolleri uygulayÄ±n.
* Orta Adam SaldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in HTTPS gibi gÃ¼venli iletiÅŸim kanallarÄ±nÄ± kullanÄ±n.
* **Referans**:
* [CanlÄ± Bug Bounty EtkinliÄŸindeki Kritik Hata](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **SÃ¼resi GeÃ§miÅŸ Jetonun KullanÄ±lmasÄ±**

* SÃ¼resi geÃ§miÅŸ jetonlarÄ±n hala ÅŸifre sÄ±fÄ±rlamak iÃ§in kullanÄ±lÄ±p kullanÄ±lamadÄ±ÄŸÄ±nÄ± test etme.
* **Ã–nleme AdÄ±mlarÄ±**:
* KatÄ± jeton sÃ¼resi dolma politikalarÄ± uygulayÄ±n ve jetonun sÃ¼resinin sunucu taraflÄ± olarak geÃ§erliliÄŸini doÄŸrulayÄ±n.

## **Kaba Kuvvet Åifre SÄ±fÄ±rlama Jetonu**

* SÄ±fÄ±rlama jetonunu Burpsuite ve IP-Rotator gibi araÃ§lar kullanarak kaba kuvvet uygulama, IP tabanlÄ± hÄ±z sÄ±nÄ±rlarÄ±nÄ± atlamak iÃ§in.
* **Ã–nleme AdÄ±mlarÄ±**:
* GÃ¼Ã§lÃ¼ hÄ±z sÄ±nÄ±rlama ve hesap kilit mekanizmalarÄ± uygulayÄ±n.
* Kaba kuvvet saldÄ±rÄ±larÄ±nÄ± gÃ¶steren ÅŸÃ¼pheli faaliyetleri izleyin.

## **Jetonunuzu KullanmayÄ± Deneyin**

* SaldÄ±rganÄ±n sÄ±fÄ±rlama jetonunun kurbanÄ±n e-postasÄ±yla birlikte kullanÄ±lÄ±p kullanÄ±lamadÄ±ÄŸÄ±nÄ± test etme.
* **Ã–nleme AdÄ±mlarÄ±**:
* JetonlarÄ±n kullanÄ±cÄ± oturumuna veya diÄŸer kullanÄ±cÄ±ya Ã¶zgÃ¼ Ã¶zelliklere baÄŸlÄ± olduÄŸundan emin olun.

## **Oturum Ä°ptali Ã‡Ä±kÄ±ÅŸ/Åifre SÄ±fÄ±rlama Ä°ÅŸleminde**

* KullanÄ±cÄ±nÄ±n Ã§Ä±kÄ±ÅŸ yapmasÄ± veya ÅŸifresini sÄ±fÄ±rlamasÄ± durumunda oturumlarÄ±n iptal edildiÄŸinden emin olma.
* **Ã–nleme AdÄ±mlarÄ±**:
* TÃ¼m oturumlarÄ±n Ã§Ä±kÄ±ÅŸ veya ÅŸifre sÄ±fÄ±rlama iÅŸleminden sonra iptal edildiÄŸinden emin olacak ÅŸekilde uygun oturum yÃ¶netimi uygulayÄ±n.

## **Oturum Ä°ptali Ã‡Ä±kÄ±ÅŸ/Åifre SÄ±fÄ±rlama Ä°ÅŸleminde**

* SÄ±fÄ±rlama jetonlarÄ±nÄ±n geÃ§erlilik sÃ¼resi olmalÄ± ve bu sÃ¼re dolduktan sonra geÃ§ersiz hale gelmelidir.
* **Ã–nleme AdÄ±mlarÄ±**:
* SÄ±fÄ±rlama jetonlarÄ± iÃ§in makul bir geÃ§erlilik sÃ¼resi belirleyin ve bunu sunucu taraflÄ± olarak kesinlikle uygulayÄ±n.

## Referanslar

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±larak deneyimli hackerlar ve hata avcÄ±larÄ±yla iletiÅŸim kurun!

**Hacking Insights**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± inceleyen iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni hata avcÄ±lÄ±klarÄ±nÄ± ve Ã¶nemli platform gÃ¼ncellemelerini takip edin

**Bize KatÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸine baÅŸlayÄ±n!

<details>

<summary><strong>SÄ±fÄ±rdan Kahraman'a AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking hilelerinizi paylaÅŸarak HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek katkÄ±da bulunun.**

</details>
