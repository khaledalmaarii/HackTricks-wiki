# Resetowanie/Zapomniane haso - ominicie

<details>

<summary><strong>Dowiedz si, jak hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Docz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowa si z dowiadczonymi hakerami i owcami bd贸w!

**Wgld w hakerstwo**\
Zajmuj si treciami, kt贸re zagbiaj si w emocje i wyzwania hakerstwa

**Aktualnoci na 偶ywo z hakerstwa**\
Bd藕 na bie偶co z szybkim tempem wiata hakerstwa dziki aktualnym wiadomociom i wgldom

**Najnowsze ogoszenia**\
Bd藕 na bie偶co z najnowszymi programami bug bounty i wa偶nymi aktualizacjami platformy

**Docz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wsp贸pracowa z najlepszymi hakerami ju偶 dzi!

## **Wyciek tokena resetowania hasa za pomoc nag贸wka Referrer**
* Nag贸wek HTTP referer mo偶e wycieka token resetowania hasa, jeli jest zawarty w adresie URL. Mo偶e to si zdarzy, gdy u偶ytkownik kliknie na link strony trzeciej po 偶daniu resetowania hasa.
* **Wpyw**: Potencjalne przejcie konta za pomoc atak贸w Cross-Site Request Forgery (CSRF).
* **Odwoania**:
- [Raport HackerOne 342693](https://hackerone.com/reports/342693)
- [Raport HackerOne 272379](https://hackerone.com/reports/272379)
- [Artyku o wycieku tokena resetowania hasa](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Zatrucie resetowania hasa**
* Atakujcy mog manipulowa nag贸wkiem Host podczas 偶da resetowania hasa, aby skierowa link resetu do zoliwej witryny.
* **Poprawka**: U偶yj `$_SERVER['SERVER_NAME']` do tworzenia adres贸w URL resetowania hasa zamiast `$_SERVER['HTTP_HOST']`.
* **Wpyw**: Prowadzi do potencjalnego przejcia konta poprzez wyciek token贸w resetu do atakujcych.
* **Kroki agodzenia**:
- Sprawd藕 nag贸wek Host na podstawie biaej listy dozwolonych domen.
- U偶yj bezpiecznych, serwerowych metod do generowania absolutnych adres贸w URL.
* **Odwoania**:
- [Artyku Acunetix na temat zatrucia resetowania hasa](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetowanie hasa poprzez manipulacj parametrem email**
* Atakujcy mog manipulowa 偶daniem resetowania hasa poprzez dodawanie dodatkowych parametr贸w email w celu zmiany kierunku linku resetu.
* **Kroki agodzenia**:
- Poprawnie analizuj i sprawdzaj parametry email po stronie serwera.
- U偶ywaj przygotowanych instrukcji lub zapyta z parametrami, aby zapobiec atakom wstrzykiwania.
* **Odwoania**:
- [Przejcie konta Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Zmiana adresu e-mail i hasa dowolnego u偶ytkownika za pomoc parametr贸w API**
* Atakujcy mog modyfikowa parametry adresu e-mail i hasa w 偶daniach API, aby zmienia dane logowania do konta.
* **Kroki agodzenia**:
- Zapewnij cis walidacj parametr贸w i sprawdzanie uwierzytelniania.
- Wdro偶enie solidnego rejestrowania i monitorowania w celu wykrywania i reagowania na podejrzane dziaania.
* **Odwoanie**:
- [Pene przejcie konta poprzez manipulacj parametrami API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Brak limitu ilociowego: bombardowanie e-mailem**
* Brak limitu ilociowego dla 偶da resetowania hasa mo偶e prowadzi do bombardowania e-mailem, przytaczajc u偶ytkownika resetowymi wiadomociami e-mail.
* **Kroki agodzenia**:
- Wdro偶enie limitowania ilociowego na podstawie adresu IP lub konta u偶ytkownika.
- U偶ywanie wyzwa CAPTCHA w celu zapobiegania automatycznemu nadu偶yciu.
* **Odwoania**:
- [Raport HackerOne 280534](https://hackerone.com/reports/280534)

## **Dowiedz si, jak jest generowany token resetowania hasa**
* Zrozumienie wzorca lub metody generowania token贸w mo偶e prowadzi do przewidywania lub pr贸b siowych token贸w.
* **Kroki agodzenia**:
- U偶ywaj silnych, kryptograficznych metod generowania token贸w.
- Zapewnij wystarczajc losowo i dugo, aby zapobiec przewidywalnoci.
* **Narzdzia**: U偶yj Burp Sequencer do analizy losowoci token贸w.

## **Przewidywalne GUID**
* Jeli GUID-y (np. wersja 1) s przewidywalne lub przewidywalne, atakujcy mog pr贸bowa siowo je generowa, aby uzyska wa偶ne tokeny resetu.
* **Kroki agodzenia**:
- U偶ywaj wersji 4 GUID do generowania losowoci lub wdro偶 dodatkowe rodki bezpieczestwa dla innych wersji.
* **Narzdzia**: U偶yj [guidtool](https://github.com/intruder-io/guidtool) do analizy i generowania GUID-贸w.

## **Manipulacja odpowiedzi: zamiana zej odpowiedzi na dobr**
* Manipulowanie odpowiedziami HTTP w celu ominicia komunikat贸w o bdach lub ogranicze.
* **Kroki agodzenia**:
- Wdro偶enie sprawdze po stronie serwera w celu zapewnienia integralnoci odpowiedzi.
- U偶ywanie bezpiecznych kana贸w komunikacji, takich jak HTTPS, w celu zapobiegania atakom typu man-in-the-middle.
* **Odwoanie**:
- [Krytyczny bd w 偶ywym wydarzeniu bug bounty](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **U偶ycie wygasego tokenu**
* Testowanie, czy wygase tokeny nadal mo偶na u偶ywa do resetowania hasa.
* **Kroki agodzenia**:
- Wdro偶enie cisych zasad wygasania token贸w i sprawdzanie wyganicia token贸w po stronie serwera.

## **Siowe amanie tokenu resetowania hasa**
* Pr贸ba siowego amania tokenu resetu za pomoc narzdzi takich jak Burpsuite i IP-Rotator w celu ominicia limit贸w ilociowych opartych na adresie IP.
* **Kroki ag
## Odwoania
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Docz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowa si z dowiadczonymi hakerami i owcami bd贸w!

**Wgld w hakerstwo**\
Zajmuj si treciami, kt贸re zagbiaj si w emocje i wyzwania hakerstwa

**Aktualnoci na 偶ywo z hakerstwa**\
Bd藕 na bie偶co z szybkim tempem wiata hakerstwa dziki aktualnym wiadomociom i wgldom

**Najnowsze ogoszenia**\
Bd藕 na bie偶co z najnowszymi programami bug bounty i wa偶nymi aktualizacjami platformy

**Docz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wsp贸pracowa z najlepszymi hakerami ju偶 dzi!

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
