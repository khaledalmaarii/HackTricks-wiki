# Bypassiranje resetovanja/zaboravljenih lozinki

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Pridru쬴te se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hakerski uvidi**\
Uklju캜ite se u sadr쬬j koji istra쬿je uzbu캠enje i izazove hakovanja

**Hakerske vesti u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja putem vesti i uvida u realnom vremenu

**Najnovije najave**\
Ostanite informisani o najnovijim pokretanjima nagrada za pronala쬰nje bagova i va쬹im a쬿riranjima platforme

**Pridru쬴te nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i po캜nite da sara캠ujete sa vrhunskim hakerima danas!

## **Curenje tokena za resetovanje lozinke putem referera**
* HTTP referer zaglavlje mo쬰 otkriti token za resetovanje lozinke ako je uklju캜en u URL. Ovo se mo쬰 desiti kada korisnik klikne na link sajta tre캖e strane nakon 코to je zatra쬴o resetovanje lozinke.
* **Utjecaj**: Potencijalno preuzimanje naloga putem napada Cross-Site Request Forgery (CSRF).
* **Reference**:
- [HackerOne Izve코taj 342693](https://hackerone.com/reports/342693)
- [HackerOne Izve코taj 272379](https://hackerone.com/reports/272379)
- [캛lanak o curenju tokena za resetovanje lozinke](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Trovanje resetovanja lozinke**
* Napada캜i mogu manipulisati Host zaglavljem tokom zahteva za resetovanje lozinke kako bi usmerili reset link ka zlonamernom sajtu.
* **Popravka**: Koristite `$_SERVER['SERVER_NAME']` za konstrukciju URL-ova za resetovanje lozinke umesto `$_SERVER['HTTP_HOST']`.
* **Utjecaj**: Dovodi do potencijalnog preuzimanja naloga otkrivanjem tokena za resetovanje napada캜ima.
* **Koraci za ubla쬬vanje**:
- Validirajte Host zaglavlje prema beloj listi dozvoljenih domena.
- Koristite sigurne, serverske metode za generisanje apsolutnih URL-ova.
* **Reference**:
- [Acunetix 캛lanak o trovanju resetovanja lozinke](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetovanje lozinke manipulacijom parametra e-po코te**
* Napada캜i mogu manipulisati zahtevom za resetovanje lozinke dodavanjem dodatnih parametara e-po코te kako bi preusmerili reset link.
* **Koraci za ubla쬬vanje**:
- Ispravno parsirajte i validirajte parametre e-po코te na serverskoj strani.
- Koristite pripremljene izjave ili parametrizovane upite kako biste spre캜ili napade ubacivanjem.
* **Reference**:
- [Preuzimanje naloga na Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Promena e-po코te i lozinke bilo kog korisnika putem API parametara**
* Napada캜i mogu izmeniti parametre e-po코te i lozinke u API zahtevima kako bi promenili korisni캜ke podatke naloga.
* **Koraci za ubla쬬vanje**:
- Osigurajte strogu validaciju parametara i provere autenti캜nosti.
- Implementirajte robustno bele쬰nje i nadgledanje kako biste otkrili i odgovorili na sumnjive aktivnosti.
* **Reference**:
- [Potpuno preuzimanje naloga putem manipulacije API parametrima](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Nedostatak ograni캜enja brzine: Email bombardovanje**
* Nedostatak ograni캜enja brzine zahteva za resetovanje lozinke mo쬰 dovesti do bombardovanja e-po코tom, preplavljuju캖i korisnika reset e-porukama.
* **Koraci za ubla쬬vanje**:
- Implementirajte ograni캜enje brzine na osnovu IP adrese ili korisni캜kog naloga.
- Koristite CAPTCHA izazove kako biste spre캜ili automatizovano zloupotrebu.
* **Reference**:
- [HackerOne Izve코taj 280534](https://hackerone.com/reports/280534)

## **Saznajte kako se generi코e token za resetovanje lozinke**
* Razumevanje obrasca ili metode generisanja tokena mo쬰 dovesti do predvi캠anja ili poku코aja prisiljavanja tokena.
* **Koraci za ubla쬬vanje**:
- Koristite jake, kriptografske metode za generisanje tokena.
- Osigurajte dovoljno slu캜ajnosti i du쬴nu kako biste spre캜ili predvidljivost.
* **Alati**: Koristite Burp Sequencer za analizu slu캜ajnosti tokena.

## **Pogodan GUID**
* Ako su GUID-ovi (npr. verzija 1) pogodni ili predvidljivi, napada캜i ih mogu prisiljavati kako bi generisali validne reset tokene.
* **Koraci za ubla쬬vanje**:
- Koristite GUID verzije 4 za slu캜ajnost ili implementirajte dodatne sigurnosne mere za druge verzije.
* **Alati**: Koristite [guidtool](https://github.com/intruder-io/guidtool) za analizu i generisanje GUID-ova.

## **Manipulacija odgovorom: Zamena lo코eg odgovora dobrim**
* Manipulacija HTTP odgovorima kako bi se zaobi코le poruke o gre코kama ili ograni캜enjima.
* **Koraci za ubla쬬vanje**:
- Implementirajte provere na serverskoj strani kako biste osigurali integritet odgovora.
- Koristite sigurne komunikacijske kanale poput HTTPS-a kako biste spre캜ili napade 캜oveka u sredini.
* **Reference**:
- [Kriti캜na gre코ka na doga캠aju Live Bug Bounty](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Kori코캖enje isteklog tokena**
* Testiranje da li istekli tokeni i dalje mogu biti kori코캖eni za resetovanje lozinke.
* **Koraci za ubla쬬vanje**:
- Implementirajte stroge politike isteka tokena i validirajte istek tokena na serverskoj strani.

## **Brute Force napad na token za resetovanje lozinke**
* Poku코aj prisiljavanja tokena za resetovanje lozinke kori코캖enjem alata poput Burpsuite-a i IP-Rotator
## Reference
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Pridru쬴te se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hakerski uvidi**\
Uklju캜ite se u sadr쬬j koji istra쬿je uzbu캠enje i izazove hakovanja

**Hakerske vesti u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja putem vesti i uvida u realnom vremenu

**Najnovije objave**\
Budite informisani o najnovijim pokretanjima nagrada za pronala쬰nje bagova i va쬹im a쬿riranjima platforme

**Pridru쬴te nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i po캜nite da sara캠ujete sa vrhunskim hakerima danas!

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
