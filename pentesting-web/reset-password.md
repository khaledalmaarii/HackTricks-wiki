# Bajpasiranje Resetovanja/Zaboravljene Lozinke

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Pridru쬴te se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hakerski Uvidi**\
Uklju캜ite se u sadr쬬j koji istra쬿je uzbu캠enje i izazove hakovanja

**Vesti o Hakovanju u Realnom Vremenu**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Najnovije Najave**\
Ostanite informisani o najnovijim nagradama za pronala쬰nje bagova i bitnim a쬿riranjima platformi

**Pridru쬴te nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i po캜nite da sara캠ujete sa vrhunskim hakerima danas!

## **Curenje Tokena za Resetovanje Lozinke Putem Referrera**

* HTTP referer zaglavlje mo쬰 procuriti token za resetovanje lozinke ako je uklju캜en u URL. Ovo mo쬰 da se desi kada korisnik klikne na link tre캖e strane nakon 코to je zatra쬴o resetovanje lozinke.
* **Utjecaj**: Potencijalno preuzimanje naloga putem napada Cross-Site Request Forgery (CSRF).
* **Eksploatacija**: Da biste proverili da li token za resetovanje lozinke procuri u referer zaglavlju, **zatra쬴te resetovanje lozinke** na svoju email adresu i **kliknite na link za resetovanje** koji je pru쬰n. **Nemojte odmah promeniti lozinku**. Umesto toga, **posetite web lokaciju tre캖e strane** (kao 코to su Facebook ili Twitter) dok **interceptujete zahteve pomo캖u Burp Suite-a**. Inspekcijom zahteva vidite da li **referer zaglavlje sadr쬴 token za resetovanje lozinke**, jer to mo쬰 izlo쬴ti osetljive informacije tre캖im stranama.
* **Reference**:
* [HackerOne Izve코taj 342693](https://hackerone.com/reports/342693)
* [HackerOne Izve코taj 272379](https://hackerone.com/reports/272379)
* [캛lanak o Curenju Tokena za Resetovanje Lozinke](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Trovanje Resetovanja Lozinke**

* Napada캜i mogu manipulisati Host zaglavlje tokom zahteva za resetovanje lozinke kako bi usmerili link za resetovanje ka zlonamernom sajtu.
* **Utjecaj**: Dovodi do potencijalnog preuzimanja naloga curenjem tokena za resetovanje napada캜ima.
* **Koraci za Smanjenje Rizika**:
* Validirajte Host zaglavlje protiv bele liste dozvoljenih domena.
* Koristite sigurne, serverske metode za generisanje apsolutnih URL-ova.
* **Popravka**: Koristite `$_SERVER['SERVER_NAME']` za konstruisanje URL-ova za resetovanje lozinke umesto `$_SERVER['HTTP_HOST']`.
* **Reference**:
* [Acunetix 캛lanak o Trovanju Resetovanja Lozinke](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetovanje Lozinke Manipulacijom Parametra Email**

Napada캜i mogu manipulisati zahtevom za resetovanje lozinke dodavanjem dodatnih email parametara kako bi preusmerili link za resetovanje.

* Dodajte email napada캜a kao drugi parametar koriste캖i &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar koriste캖i bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar koriste캖i ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar u json nizu
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Koraci za ubla쬬vanje**:
* Pravilno parsirati i validirati parametre e-po코te na serverskoj strani.
* Koristiti pripremljene izjave ili parametrizovane upite kako bi se spre캜ili napadi ubacivanjem.
* **Reference**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Menjanje e-po코te i lozinke bilo kog korisnika putem API parametara**

* Napada캜i mogu izmeniti parametre e-po코te i lozinke u API zahtevima kako bi promenili pristupne podatke naloga.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Koraci za ubla쬬vanje**:
* Osigurajte strogu validaciju parametara i provere autentikacije.
* Implementirajte sna쬹o bele쬰nje i pra캖enje kako biste otkrili i odgovorili na sumnjive aktivnosti.
* **Reference**:
* [Potpuno preuzimanje naloga putem manipulacije API parametrima](https://medium.com/@adeshkolte/potpuno-preuzimanje-naloga-promena-e-po코te-i-lozinke-bilo-kog-korisnika-putem-api-parametara-3d527ab27240)

## **Bez ograni캜enja brzine: Email bombardovanje**

* Nedostatak ograni캜enja brzine zahteva za resetovanje lozinke mo쬰 dovesti do email bombardovanja, preplavljuju캖i korisnika resetuju캖im emailovima.
* **Koraci za ubla쬬vanje**:
* Implementirajte ograni캜enje brzine na osnovu IP adrese ili korisni캜kog naloga.
* Koristite CAPTCHA izazove kako biste spre캜ili automatizovanu zloupotrebu.
* **Reference**:
* [HackerOne Izve코taj 280534](https://hackerone.com/reports/280534)

## **Saznajte kako se generi코e token za resetovanje lozinke**

* Razumevanje obrasca ili metode generisanja tokena mo쬰 dovesti do predvi캠anja ili grubog sile tokena. Neke opcije:
* Na osnovu vremenske oznake
* Na osnovu korisni캜kog ID-a
* Na osnovu e-po코te korisnika
* Na osnovu imena i prezimena
* Na osnovu datuma ro캠enja
* Na osnovu kriptografije
* **Koraci za ubla쬬vanje**:
* Koristite sna쬹e, kriptografske metode za generisanje tokena.
* Osigurajte dovoljno slu캜ajnosti i du쬴nu kako biste spre캜ili predvidljivost.
* **Alati**: Koristite Burp Sequencer za analizu slu캜ajnosti tokena.

## **Pogodan UUID**

* Ako su UUID-ovi (verzija 1) pogodni ili predvidljivi, napada캜i ih mogu grubo siliti kako bi generisali validne reset tokene. Proverite:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Koraci za ubla쬬vanje**:
* Koristite GUID verziju 4 za slu캜ajnost ili implementirajte dodatne sigurnosne mere za druge verzije.
* **Alati**: Koristite [guidtool](https://github.com/intruder-io/guidtool) za analizu i generisanje GUID-ova.

## **Manipulacija odgovorom: Zamena lo코eg odgovora dobrom**

* Manipulisanje HTTP odgovora kako bi se zaobi코le gre코ke ili ograni캜enja.
* **Koraci za ubla쬬vanje**:
* Implementirajte provere na serverskoj strani kako biste osigurali integritet odgovora.
* Koristite sigurne komunikacione kanale poput HTTPS-a kako biste spre캜ili napade 캜oveka usred komunikacije.
* **Reference**:
* [Kriti캜na gre코ka na doga캠aju u쬴vo sa Bug Bounty](https://medium.com/@innocenthacker/kako-sam-prona코ao-najkriti캜niju-gre코ku-na-doga캠aju-u쬴vo-sa-bug-bounty-7a88b3aa97b3)

## **Kori코캖enje isteklog tokena**

* Testiranje da li istekli tokeni i dalje mogu biti kori코캖eni za resetovanje lozinke.
* **Koraci za ubla쬬vanje**:
* Implementirajte stroge politike isteka tokena i validirajte istek tokena na serverskoj strani.

## **Gruba sila za resetovanje lozinke**

* Poku코aj grubog sile reset tokena kori코캖enjem alata poput Burpsuite-a i IP-Rotatora kako biste zaobi코li IP-bazirana ograni캜enja brzine.
* **Koraci za ubla쬬vanje**:
* Implementirajte sna쬹e mehanizme ograni캜enja brzine i zaklju캜avanja naloga.
* Pratite sumnjive aktivnosti koje ukazuju na napade grubom silom.

## **Poku코ajte koristiti svoj token**

* Testiranje da li napada캜ev reset token mo쬰 biti kori코캖en zajedno sa emailom rtve.
* **Koraci za ubla쬬vanje**:
* Osigurajte da su tokeni vezani za korisni캜ku sesiju ili druge korisni캜ki-specifi캜ne atribute.

## **Poni코tavanje sesije pri odjavljivanju/resetovanju lozinke**

* Osiguravanje da se sesije poni코tavaju kada korisnik se odjavi ili resetuje lozinku.
* **Koraci za ubla쬬vanje**:
* Implementirajte pravilno upravljanje sesijama, osiguravaju캖i da se sve sesije poni코tavaju prilikom odjavljivanja ili resetovanja lozinke.

## **Poni코tavanje sesije pri odjavljivanju/resetovanju lozinke**

* Reset tokeni treba da imaju vreme isteka nakon kojeg postaju neva쬰캖i.
* **Koraci za ubla쬬vanje**:
* Postavite razumno vreme isteka za reset tokene i strogo ga sprovedite na serverskoj strani.

## Reference

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Pridru쬴te se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!
