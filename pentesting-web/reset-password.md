# é‡ç½®/å¿˜è®°å¯†ç ç»•è¿‡

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

åŠ å…¥ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼

**é»‘å®¢è§è§£**\
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€ä¸æŒ‘æˆ˜çš„å†…å®¹

**å®æ—¶é»‘å®¢æ–°é—»**\
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ

**æœ€æ–°å…¬å‘Š**\
äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘è®¡åˆ’å’Œé‡è¦å¹³å°æ›´æ–°

**ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ï¼Œ** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ï¼Œä¸é¡¶å°–é»‘å®¢å¼€å§‹åˆä½œå§ï¼

## **é€šè¿‡å¼•èäººæ³„éœ²å¯†ç é‡ç½®ä»¤ç‰Œ**

* å¦‚æœå¯†ç é‡ç½®ä»¤ç‰ŒåŒ…å«åœ¨ URL ä¸­ï¼ŒHTTP referer å¤´å¯èƒ½ä¼šæ³„éœ²è¯¥ä»¤ç‰Œã€‚è¿™å¯èƒ½å‘ç”Ÿåœ¨ç”¨æˆ·è¯·æ±‚å¯†ç é‡ç½®åç‚¹å‡»ç¬¬ä¸‰æ–¹ç½‘ç«™é“¾æ¥æ—¶ã€‚
* **å½±å“**ï¼šé€šè¿‡è·¨ç«™è¯·æ±‚ä¼ªé€  (CSRF) æ”»å‡»å¯èƒ½å¯¼è‡´è´¦æˆ·æ¥ç®¡ã€‚
* **åˆ©ç”¨**ï¼šè¦æ£€æŸ¥å¯†ç é‡ç½®ä»¤ç‰Œæ˜¯å¦åœ¨ referer å¤´ä¸­æ³„éœ²ï¼Œ**è¯·æ±‚å¯†ç é‡ç½®**åˆ°æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œå¹¶**ç‚¹å‡»æä¾›çš„é‡ç½®é“¾æ¥**ã€‚**ä¸è¦ç«‹å³æ›´æ”¹å¯†ç **ã€‚ç›¸åï¼Œ**åœ¨ä½¿ç”¨ Burp Suite æ‹¦æˆªè¯·æ±‚æ—¶**ï¼Œ**å¯¼èˆªåˆ°ç¬¬ä¸‰æ–¹ç½‘ç«™**ï¼ˆå¦‚ Facebook æˆ– Twitterï¼‰ã€‚æ£€æŸ¥è¯·æ±‚ä»¥æŸ¥çœ‹ **referer å¤´æ˜¯å¦åŒ…å«å¯†ç é‡ç½®ä»¤ç‰Œ**ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå°†æ•æ„Ÿä¿¡æ¯æš´éœ²ç»™ç¬¬ä¸‰æ–¹ã€‚
* **å‚è€ƒ**ï¼š
* [HackerOne æŠ¥å‘Š 342693](https://hackerone.com/reports/342693)
* [HackerOne æŠ¥å‘Š 272379](https://hackerone.com/reports/272379)
* [å¯†ç é‡ç½®ä»¤ç‰Œæ³„éœ²æ–‡ç« ](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **å¯†ç é‡ç½®ä¸­æ¯’**

* æ”»å‡»è€…å¯èƒ½åœ¨å¯†ç é‡ç½®è¯·æ±‚ä¸­æ“çºµ Host å¤´ï¼Œå°†é‡ç½®é“¾æ¥æŒ‡å‘æ¶æ„ç½‘ç«™ã€‚
* **å½±å“**ï¼šé€šè¿‡å°†é‡ç½®ä»¤ç‰Œæ³„éœ²ç»™æ”»å‡»è€…ï¼Œå¯èƒ½å¯¼è‡´è´¦æˆ·æ¥ç®¡ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* éªŒè¯ Host å¤´æ˜¯å¦åœ¨å…è®¸çš„åŸŸåç™½åå•ä¸­ã€‚
* ä½¿ç”¨å®‰å…¨çš„æœåŠ¡å™¨ç«¯æ–¹æ³•ç”Ÿæˆç»å¯¹ URLã€‚
* **ä¿®è¡¥**ï¼šä½¿ç”¨ `$_SERVER['SERVER_NAME']` æ„é€ å¯†ç é‡ç½® URLï¼Œè€Œä¸æ˜¯ `$_SERVER['HTTP_HOST']`ã€‚
* **å‚è€ƒ**ï¼š
* [Acunetix å…³äºå¯†ç é‡ç½®ä¸­æ¯’çš„æ–‡ç« ](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **é€šè¿‡æ“çºµç”µå­é‚®ä»¶å‚æ•°é‡ç½®å¯†ç **

æ”»å‡»è€…å¯ä»¥é€šè¿‡æ·»åŠ é¢å¤–çš„ç”µå­é‚®ä»¶å‚æ•°æ¥æ“çºµå¯†ç é‡ç½®è¯·æ±‚ï¼Œä»¥è½¬ç§»é‡ç½®é“¾æ¥ã€‚

* ä½¿ç”¨ & æ·»åŠ æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* ä½¿ç”¨ %20 å°†æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ 
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* ä½¿ç”¨ | å°†æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ 
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* ä½¿ç”¨æŠ„é€å°†æ”»å‡»è€…ç”µå­é‚®ä»¶æ·»åŠ ä¸ºç¬¬äºŒä¸ªå‚æ•°
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* ä½¿ç”¨ bcc å°†æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ 
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* ä½¿ç”¨ , å°†æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ 
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* åœ¨ JSON æ•°ç»„ä¸­å°†æ”»å‡»è€…ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ 
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **ç¼“è§£æ­¥éª¤**ï¼š
* æœåŠ¡å™¨ç«¯æ­£ç¡®è§£æå’ŒéªŒè¯ç”µå­é‚®ä»¶å‚æ•°ã€‚
* ä½¿ç”¨é¢„å¤„ç†è¯­å¥æˆ–å‚æ•°åŒ–æŸ¥è¯¢ä»¥é˜²æ­¢æ³¨å…¥æ”»å‡»ã€‚
* **å‚è€ƒæ–‡çŒ®**ï¼š
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **é€šè¿‡APIå‚æ•°æ›´æ”¹ä»»ä½•ç”¨æˆ·çš„ç”µå­é‚®ä»¶å’Œå¯†ç **

* æ”»å‡»è€…å¯ä»¥åœ¨APIè¯·æ±‚ä¸­ä¿®æ”¹ç”µå­é‚®ä»¶å’Œå¯†ç å‚æ•°ä»¥æ›´æ”¹è´¦æˆ·å‡­æ®ã€‚
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **ç¼“è§£æ­¥éª¤**ï¼š
* ç¡®ä¿ä¸¥æ ¼çš„å‚æ•°éªŒè¯å’Œèº«ä»½éªŒè¯æ£€æŸ¥ã€‚
* å®æ–½å¼ºå¤§çš„æ—¥å¿—è®°å½•å’Œç›‘æ§ï¼Œä»¥æ£€æµ‹å’Œå“åº”å¯ç–‘æ´»åŠ¨ã€‚
* **å‚è€ƒ**ï¼š
* [é€šè¿‡APIå‚æ•°æ“çºµè¿›è¡Œå®Œæ•´è´¦æˆ·æ¥ç®¡](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **æ— é€Ÿç‡é™åˆ¶ï¼šç”µå­é‚®ä»¶è½°ç‚¸**

* å¯†ç é‡ç½®è¯·æ±‚ç¼ºä¹é€Ÿç‡é™åˆ¶å¯èƒ½å¯¼è‡´ç”µå­é‚®ä»¶è½°ç‚¸ï¼Œä½¿ç”¨æˆ·è¢«é‡ç½®ç”µå­é‚®ä»¶æ·¹æ²¡ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* åŸºäºIPåœ°å€æˆ–ç”¨æˆ·è´¦æˆ·å®æ–½é€Ÿç‡é™åˆ¶ã€‚
* ä½¿ç”¨CAPTCHAæŒ‘æˆ˜ä»¥é˜²æ­¢è‡ªåŠ¨æ»¥ç”¨ã€‚
* **å‚è€ƒ**ï¼š
* [HackerOneæŠ¥å‘Š280534](https://hackerone.com/reports/280534)

## **æ‰¾å‡ºå¯†ç é‡ç½®ä»¤ç‰Œçš„ç”Ÿæˆæ–¹å¼**

* ç†è§£ä»¤ç‰Œç”ŸæˆèƒŒåçš„æ¨¡å¼æˆ–æ–¹æ³•å¯ä»¥å¯¼è‡´é¢„æµ‹æˆ–æš´åŠ›ç ´è§£ä»¤ç‰Œã€‚ä¸€äº›é€‰é¡¹ï¼š
* åŸºäºæ—¶é—´æˆ³
* åŸºäºç”¨æˆ·ID
* åŸºäºç”¨æˆ·çš„ç”µå­é‚®ä»¶
* åŸºäºåå­—å’Œå§“æ°
* åŸºäºå‡ºç”Ÿæ—¥æœŸ
* åŸºäºåŠ å¯†
* **ç¼“è§£æ­¥éª¤**ï¼š
* ä½¿ç”¨å¼ºå¤§çš„åŠ å¯†æ–¹æ³•ç”Ÿæˆä»¤ç‰Œã€‚
* ç¡®ä¿è¶³å¤Ÿçš„éšæœºæ€§å’Œé•¿åº¦ä»¥é˜²æ­¢å¯é¢„æµ‹æ€§ã€‚
* **å·¥å…·**ï¼šä½¿ç”¨Burp Sequenceråˆ†æä»¤ç‰Œçš„éšæœºæ€§ã€‚

## **å¯çŒœæµ‹çš„UUID**

* å¦‚æœUUIDï¼ˆç‰ˆæœ¬1ï¼‰æ˜¯å¯çŒœæµ‹æˆ–å¯é¢„æµ‹çš„ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæš´åŠ›ç ´è§£å®ƒä»¬ä»¥ç”Ÿæˆæœ‰æ•ˆçš„é‡ç½®ä»¤ç‰Œã€‚æ£€æŸ¥ï¼š

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **ç¼“è§£æ­¥éª¤**ï¼š
* ä½¿ç”¨GUIDç‰ˆæœ¬4ä»¥è·å¾—éšæœºæ€§ï¼Œæˆ–å¯¹å…¶ä»–ç‰ˆæœ¬å®æ–½é¢å¤–çš„å®‰å…¨æªæ–½ã€‚
* **å·¥å…·**ï¼šä½¿ç”¨[guidtool](https://github.com/intruder-io/guidtool)åˆ†æå’Œç”ŸæˆGUIDã€‚

## **å“åº”æ“çºµï¼šç”¨å¥½å“åº”æ›¿æ¢åå“åº”**

* æ“çºµHTTPå“åº”ä»¥ç»•è¿‡é”™è¯¯æ¶ˆæ¯æˆ–é™åˆ¶ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* å®æ–½æœåŠ¡å™¨ç«¯æ£€æŸ¥ä»¥ç¡®ä¿å“åº”å®Œæ•´æ€§ã€‚
* ä½¿ç”¨å®‰å…¨é€šä¿¡é€šé“å¦‚HTTPSä»¥é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚
* **å‚è€ƒ**ï¼š
* [å®æ—¶æ¼æ´èµé‡‘æ´»åŠ¨ä¸­çš„å…³é”®æ¼æ´](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **ä½¿ç”¨è¿‡æœŸä»¤ç‰Œ**

* æµ‹è¯•è¿‡æœŸä»¤ç‰Œæ˜¯å¦ä»å¯ç”¨äºå¯†ç é‡ç½®ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* å®æ–½ä¸¥æ ¼çš„ä»¤ç‰Œè¿‡æœŸæ”¿ç­–ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯éªŒè¯ä»¤ç‰Œè¿‡æœŸã€‚

## **æš´åŠ›ç ´è§£å¯†ç é‡ç½®ä»¤ç‰Œ**

* å°è¯•ä½¿ç”¨Burpsuiteå’ŒIP-Rotatorç­‰å·¥å…·æš´åŠ›ç ´è§£é‡ç½®ä»¤ç‰Œï¼Œä»¥ç»•è¿‡åŸºäºIPçš„é€Ÿç‡é™åˆ¶ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* å®æ–½å¼ºå¤§çš„é€Ÿç‡é™åˆ¶å’Œè´¦æˆ·é”å®šæœºåˆ¶ã€‚
* ç›‘æ§å¯ç–‘æ´»åŠ¨ï¼Œä»¥æŒ‡ç¤ºæš´åŠ›ç ´è§£æ”»å‡»ã€‚

## **å°è¯•ä½¿ç”¨æ‚¨çš„ä»¤ç‰Œ**

* æµ‹è¯•æ”»å‡»è€…çš„é‡ç½®ä»¤ç‰Œæ˜¯å¦å¯ä»¥ä¸å—å®³è€…çš„ç”µå­é‚®ä»¶ä¸€èµ·ä½¿ç”¨ã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* ç¡®ä¿ä»¤ç‰Œç»‘å®šåˆ°ç”¨æˆ·ä¼šè¯æˆ–å…¶ä»–ç”¨æˆ·ç‰¹å®šå±æ€§ã€‚

## **æ³¨é”€/å¯†ç é‡ç½®ä¸­çš„ä¼šè¯å¤±æ•ˆ**

* ç¡®ä¿ç”¨æˆ·æ³¨é”€æˆ–é‡ç½®å¯†ç æ—¶ä¼šè¯å¤±æ•ˆã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* å®æ–½é€‚å½“çš„ä¼šè¯ç®¡ç†ï¼Œç¡®ä¿æ‰€æœ‰ä¼šè¯åœ¨æ³¨é”€æˆ–å¯†ç é‡ç½®æ—¶å¤±æ•ˆã€‚

## **æ³¨é”€/å¯†ç é‡ç½®ä¸­çš„ä¼šè¯å¤±æ•ˆ**

* é‡ç½®ä»¤ç‰Œåº”å…·æœ‰è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåå°†å¤±æ•ˆã€‚
* **ç¼“è§£æ­¥éª¤**ï¼š
* ä¸ºé‡ç½®ä»¤ç‰Œè®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯ä¸¥æ ¼æ‰§è¡Œã€‚

## å‚è€ƒ

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

åŠ å…¥ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼

**é»‘å®¢è§è§£**\
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€å’ŒæŒ‘æˆ˜çš„å†…å®¹

**å®æ—¶é»‘å®¢æ–°é—»**\
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ

**æœ€æ–°å…¬å‘Š**\
åŠæ—¶äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘å‘å¸ƒå’Œé‡è¦å¹³å°æ›´æ–°

**åŠ å…¥æˆ‘ä»¬** [**Discord**](https://discord.com/invite/N3FrSbmwdy)ï¼Œä»Šå¤©å°±å¼€å§‹ä¸é¡¶çº§é»‘å®¢åˆä½œï¼

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordå°ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥å°ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
