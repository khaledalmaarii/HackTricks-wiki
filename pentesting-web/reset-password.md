# Bypass resetowania/zapomnianego hasÅ‚a

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami bÅ‚Ä™dÃ³w!

**Spojrzenie na hakerstwo**\
Zajmij siÄ™ treÅ›ciami, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania hakerstwa

**AktualnoÅ›ci na Å¼ywo z hakerstwa**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakerstwa dziÄ™ki aktualnoÅ›ciom na Å¼ywo i wglÄ…dom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº informowany o najnowszych programach bug bounty i istotnych aktualizacjach platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

## **Wyciek tokena resetowania hasÅ‚a poprzez Referrer**

* NagÅ‚Ã³wek HTTP referer moÅ¼e ujawniÄ‡ token resetowania hasÅ‚a, jeÅ›li jest zawarty w adresie URL. MoÅ¼e to wystÄ…piÄ‡, gdy uÅ¼ytkownik kliknie na link strony trzeciej po Å¼Ä…daniu resetowania hasÅ‚a.
* **WpÅ‚yw**: Potencjalne przejÄ™cie konta poprzez ataki typu Cross-Site Request Forgery (CSRF).
* **Referencje**:
* [Raport HackerOne 342693](https://hackerone.com/reports/342693)
* [Raport HackerOne 272379](https://hackerone.com/reports/272379)
* [ArtykuÅ‚ o wycieku tokena resetowania hasÅ‚a](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Zatrucie resetowania hasÅ‚a**

* AtakujÄ…cy mogÄ… manipulowaÄ‡ nagÅ‚Ã³wek Host podczas Å¼Ä…daÅ„ resetowania hasÅ‚a, aby skierowaÄ‡ link resetowania do zÅ‚oÅ›liwej witryny.
* **Poprawka**: UÅ¼yj `$_SERVER['SERVER_NAME']` do konstruowania adresÃ³w URL resetowania hasÅ‚a zamiast `$_SERVER['HTTP_HOST']`.
* **WpÅ‚yw**: Prowadzi do potencjalnego przejÄ™cia konta poprzez wyciek tokenÃ³w resetowania do atakujÄ…cych.
* **Kroki Å‚agodzenia**:
* SprawdÅº nagÅ‚Ã³wek Host wzglÄ™dem biaÅ‚ej listy dozwolonych domen.
* UÅ¼yj bezpiecznych, serwerowych metod generowania absolutnych adresÃ³w URL.
* **Referencje**:
* [ArtykuÅ‚ Acunetix o zatruciu resetowania hasÅ‚a](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetowanie hasÅ‚a poprzez manipulacjÄ™ parametrem email**

* AtakujÄ…cy mogÄ… manipulowaÄ‡ Å¼Ä…daniem resetowania hasÅ‚a poprzez dodanie dodatkowych parametrÃ³w email w celu zmiany linku resetowania.
* **Kroki Å‚agodzenia**:
* PrawidÅ‚owo analizuj i sprawdzaj parametry email po stronie serwera.
* UÅ¼ywaj przygotowanych instrukcji lub zapytaÅ„ z parametrami, aby zapobiec atakom wstrzykiwania.
* **Referencje**:
* [PrzejÄ™cie konta Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Zmiana emaila i hasÅ‚a dowolnego uÅ¼ytkownika poprzez parametry API**

* AtakujÄ…cy mogÄ… modyfikowaÄ‡ parametry emaila i hasÅ‚a w Å¼Ä…daniach API, aby zmieniÄ‡ dane konta.
* **Kroki Å‚agodzenia**:
* Upewnij siÄ™, Å¼e walidacja parametrÃ³w i sprawdzanie uwierzytelnienia sÄ… rygorystyczne.
* WdroÅ¼enie solidnego rejestrowania i monitorowania w celu wykrywania i reagowania na podejrzane dziaÅ‚ania.
* **Referencja**:
* [PeÅ‚ne przejÄ™cie konta poprzez manipulacjÄ™ parametrami API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Brak limitowania szybkoÅ›ci: Bombardowanie emailami**

* Brak limitowania szybkoÅ›ci Å¼Ä…daÅ„ resetowania hasÅ‚a moÅ¼e prowadziÄ‡ do bombardowania emailami, przytÅ‚aczajÄ…c uÅ¼ytkownika resetowymi emailami.
* **Kroki Å‚agodzenia**:
* WdroÅ¼enie limitowania szybkoÅ›ci na podstawie adresu IP lub konta uÅ¼ytkownika.
* UÅ¼yj wyzwaÅ„ CAPTCHA, aby zapobiec automatycznemu naduÅ¼yciu.
* **Referencje**:
* [Raport HackerOne 280534](https://hackerone.com/reports/280534)

## **Dowiedz siÄ™, jak jest generowany token resetowania hasÅ‚a**

* Zrozumienie wzorca lub metody generowania tokenÃ³w moÅ¼e prowadziÄ‡ do przewidywania lub brutalnego ich odgadywania.
* **Kroki Å‚agodzenia**:
* UÅ¼yj silnych, kryptograficznych metod generowania tokenÃ³w.
* Zapewnij wystarczajÄ…cÄ… losowoÅ›Ä‡ i dÅ‚ugoÅ›Ä‡, aby zapobiec przewidywalnoÅ›ci.
* **NarzÄ™dzia**: UÅ¼yj Burp Sequencer do analizy losowoÅ›ci tokenÃ³w.

## **MoÅ¼liwe do odgadniÄ™cia GUID**

* JeÅ›li GUID-y (np. wersja 1) sÄ… moÅ¼liwe do odgadniÄ™cia lub przewidywalne, atakujÄ…cy mogÄ… brutalnie je odgadywaÄ‡, aby wygenerowaÄ‡ poprawne tokeny resetowania.
* **Kroki Å‚agodzenia**:
* UÅ¼yj GUID wersji 4 dla losowoÅ›ci lub wdroÅ¼ dodatkowe Å›rodki bezpieczeÅ„stwa dla innych wersji.
* **NarzÄ™dzia**: UÅ¼yj [guidtool](https://github.com/intruder-io/guidtool) do analizy i generowania GUID-Ã³w.

## **Manipulacja odpowiedziÄ…: ZamieÅ„ zÅ‚Ä… odpowiedÅº na dobrÄ…**

* Manipulowanie odpowiedziami HTTP w celu ominiÄ™cia komunikatÃ³w bÅ‚Ä™dÃ³w lub ograniczeÅ„.
* **Kroki Å‚agodzenia**:
* WdroÅ¼enie sprawdzeÅ„ po stronie serwera, aby zapewniÄ‡ integralnoÅ›Ä‡ odpowiedzi.
* UÅ¼yj bezpiecznych kanaÅ‚Ã³w komunikacji, takich jak HTTPS, aby zapobiec atakom typu man-in-the-middle.
* **Referencje**:
* [Krytyczny bÅ‚Ä…d w wydarzeniu Live Bug Bounty](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **UÅ¼ycie wygasÅ‚ego tokenu**

* Testowanie, czy wygasÅ‚e tokeny nadal moÅ¼na uÅ¼ywaÄ‡ do resetowania hasÅ‚a.
* **Kroki Å‚agodzenia**:
* WdroÅ¼enie rygorystycznych zasad wygaÅ›niÄ™cia tokenÃ³w i walidacja wygaÅ›niÄ™cia tokenu po stronie serwera.

## **Brutalne odgadywanie tokenu resetowania hasÅ‚a**

* PrÃ³ba brutalnego odgadywania tokenu resetowania za pomocÄ… narzÄ™dzi takich jak Burpsuite i IP-Rotator w celu ominiÄ™cia limitÃ³w szybkoÅ›ci opartych na adresie IP.
* **Kroki Å‚agodzenia**:
* WdroÅ¼enie solidnych mechanizmÃ³w limitowania szybkoÅ›ci i blokady konta.
* Monitorowanie podejrzanych dziaÅ‚aÅ„ wskazujÄ…cych na ataki brutalnego odgadywania.

## **SprÃ³buj uÅ¼yÄ‡ swojego tokenu**

* Testowanie, czy token resetowania atakujÄ…cego moÅ¼e byÄ‡ uÅ¼yty w poÅ‚Ä…czeniu z emailem ofiary.
* **Kroki Å‚agodzenia**:
* Upewnij siÄ™, Å¼e tokeny sÄ… powiÄ…zane z sesjÄ… uÅ¼ytkownika lub innymi atrybutami specyficznymi dla uÅ¼ytkownika.

## **UniewaÅ¼nienie sesji przy wylogowywaniu/resetowaniu hasÅ‚a**

* Zapewnienie, Å¼e sesje sÄ… uniewaÅ¼niane, gdy uÅ¼ytkownik siÄ™ wylogowuje lub resetuje hasÅ‚o.
* **Kroki Å‚agodzenia**:
* WdroÅ¼enie wÅ‚aÅ›ciwego zarzÄ…dzania sesjami, zapewniajÄ…c, Å¼e wszystkie sesje sÄ… uniewaÅ¼niane po wylogowaniu lub zresetowaniu hasÅ‚a.

## **UniewaÅ¼nienie sesji przy wylogowywaniu/resetowaniu hasÅ‚a**

* Tokeny resetowania powinny mieÄ‡ czas wygaÅ›niÄ™cia, po ktÃ³rym stajÄ… siÄ™ niewaÅ¼ne.
* **Kroki Å‚agodzenia**:
* Ustaw rozsÄ…dny czas wygaÅ›niÄ™cia tokenÃ³w resetowania i Å›ciÅ›le egzekwuj go po stronie serwera.
## OdnoÅ›niki

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami luk w zabezpieczeniach!

**Spojrzenie na Hacking**\
Zanurz siÄ™ w treÅ›ciach, ktÃ³re zgÅ‚Ä™biajÄ… emocje i wyzwania zwiÄ…zane z hakowaniem

**AktualnoÅ›ci na Å»ywo z Hackingu**\
BÄ…dÅº na bieÅ¼Ä…co z szybkim tempem Å›wiata hakowania dziÄ™ki aktualnoÅ›ciom i spojrzeniom na Å¼ywo

**Najnowsze OgÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi programami bug bounty i istotnymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
