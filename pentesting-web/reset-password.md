# Åifre SÄ±fÄ±rlama/Unutulan Åifre Bypass

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
GerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle hÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gÃ¼ncel kalÄ±n

**Son Duyurular**\
Yeni baÅŸlayan bug bounty'ler ve kritik platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

BugÃ¼n [**Discord**](https://discord.com/invite/N3FrSbmwdy) Ã¼zerinden bize katÄ±lÄ±n ve en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!

## **Referans Ãœzerinden Åifre SÄ±fÄ±rlama Tokeni SÄ±zÄ±ntÄ±sÄ±**

* HTTP referer baÅŸlÄ±ÄŸÄ±, URL'de yer alÄ±yorsa ÅŸifre sÄ±fÄ±rlama tokenini sÄ±zdÄ±rabilir. Bu, bir kullanÄ±cÄ±nÄ±n ÅŸifre sÄ±fÄ±rlama talep ettikten sonra Ã¼Ã§Ã¼ncÃ¼ taraf bir web sitesi baÄŸlantÄ±sÄ±na tÄ±klamasÄ± durumunda gerÃ§ekleÅŸebilir.
* **Etkisi**: Cross-Site Request Forgery (CSRF) saldÄ±rÄ±larÄ± aracÄ±lÄ±ÄŸÄ±yla potansiyel hesap ele geÃ§irme.
* **SÃ¶mÃ¼rÃ¼**: Referer baÅŸlÄ±ÄŸÄ±nda bir ÅŸifre sÄ±fÄ±rlama tokeninin sÄ±zÄ±p sÄ±zmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in, **ÅŸifre sÄ±fÄ±rlama talebi** yapÄ±n ve saÄŸlanan **sÄ±fÄ±rlama baÄŸlantÄ±sÄ±na** tÄ±klayÄ±n. **Åifrenizi hemen deÄŸiÅŸtirmeyin.** Bunun yerine, **Burp Suite kullanarak istekleri yakalarken** **Ã¼Ã§Ã¼ncÃ¼ taraf bir web sitesine** (Facebook veya Twitter gibi) gidin. **Referer baÅŸlÄ±ÄŸÄ±nÄ±n ÅŸifre sÄ±fÄ±rlama tokenini iÃ§erip iÃ§ermediÄŸini** kontrol edin, Ã§Ã¼nkÃ¼ bu, hassas bilgilerin Ã¼Ã§Ã¼ncÃ¼ taraflara ifÅŸa olmasÄ±na neden olabilir.
* **Referanslar**:
* [HackerOne Raporu 342693](https://hackerone.com/reports/342693)
* [HackerOne Raporu 272379](https://hackerone.com/reports/272379)
* [Åifre SÄ±fÄ±rlama Tokeni SÄ±zÄ±ntÄ±sÄ± Makalesi](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Åifre SÄ±fÄ±rlama Zehirleme**

* SaldÄ±rganlar, ÅŸifre sÄ±fÄ±rlama talepleri sÄ±rasÄ±nda Host baÅŸlÄ±ÄŸÄ±nÄ± manipÃ¼le ederek sÄ±fÄ±rlama baÄŸlantÄ±sÄ±nÄ± kÃ¶tÃ¼ niyetli bir siteye yÃ¶nlendirebilir.
* **Etkisi**: SÄ±fÄ±rlama tokenlerini saldÄ±rganlara sÄ±zdÄ±rarak potansiyel hesap ele geÃ§irme.
* **Hafifletme AdÄ±mlarÄ±**:
* Host baÅŸlÄ±ÄŸÄ±nÄ± izin verilen alanlarÄ±n beyaz listesi ile doÄŸrulayÄ±n.
* Kesin URL'ler oluÅŸturmak iÃ§in gÃ¼venli, sunucu tarafÄ± yÃ¶ntemleri kullanÄ±n.
* **Yaman**: `$_SERVER['SERVER_NAME']` kullanarak ÅŸifre sÄ±fÄ±rlama URL'lerini oluÅŸturun, `$_SERVER['HTTP_HOST']` yerine.
* **Referanslar**:
* [Åifre SÄ±fÄ±rlama Zehirleme Ãœzerine Acunetix Makalesi](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **E-posta Parametresini ManipÃ¼le Ederek Åifre SÄ±fÄ±rlama**

SaldÄ±rganlar, sÄ±fÄ±rlama baÄŸlantÄ±sÄ±nÄ± saptÄ±rmak iÃ§in ek e-posta parametreleri ekleyerek ÅŸifre sÄ±fÄ±rlama talebini manipÃ¼le edebilir.

* SaldÄ±rgan e-posta adresini ikinci parametre olarak & ile ekleyin.
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* SaldÄ±rgan e-posta adresini ikinci parametre olarak %20 kullanarak ekleyin
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* SaldÄ±rgan e-posta adresini ikinci parametre olarak | kullanarak ekleyin
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* SaldÄ±rgan e-posta adresini ikinci parametre olarak cc kullanarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* SaldÄ±rgan e-posta adresini ikinci parametre olarak bcc kullanarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* SaldÄ±rgan e-posta adresini ikinci parametre olarak ekleyin,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* SaldÄ±rgan e-posta adresini json dizisinde ikinci parametre olarak ekleyin
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Mitigation Steps**:
* E-posta parametrelerini sunucu tarafÄ±nda doÄŸru bir ÅŸekilde ayrÄ±ÅŸtÄ±rÄ±n ve doÄŸrulayÄ±n.
* Enjeksiyon saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in hazÄ±rlÄ±klÄ± ifadeler veya parametreli sorgular kullanÄ±n.
* **References**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **API Parametreleri ile Herhangi Bir KullanÄ±cÄ±nÄ±n E-posta ve Åifresini DeÄŸiÅŸtirme**

* SaldÄ±rganlar, hesap kimlik bilgilerini deÄŸiÅŸtirmek iÃ§in API isteklerindeki e-posta ve ÅŸifre parametrelerini deÄŸiÅŸtirebilir.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Azaltma AdÄ±mlarÄ±**:
* KatÄ± parametre doÄŸrulama ve kimlik doÄŸrulama kontrolleri saÄŸlamak.
* ÅÃ¼pheli etkinlikleri tespit etmek ve yanÄ±t vermek iÃ§in saÄŸlam gÃ¼nlÃ¼kleme ve izleme uygulamak.
* **Referans**:
* [API Parametre ManipÃ¼lasyonu ile Tam Hesap Ele GeÃ§irme](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **HÄ±z SÄ±nÄ±rlandÄ±rmasÄ± Yok: E-posta BombardÄ±manÄ±**

* Åifre sÄ±fÄ±rlama taleplerinde hÄ±z sÄ±nÄ±rlamasÄ± olmamasÄ±, kullanÄ±cÄ±yÄ± sÄ±fÄ±rlama e-postalarÄ±yla bunaltabilir.
* **Azaltma AdÄ±mlarÄ±**:
* IP adresine veya kullanÄ±cÄ± hesabÄ±na dayalÄ± hÄ±z sÄ±nÄ±rlamasÄ± uygulamak.
* Otomatik kÃ¶tÃ¼ye kullanÄ±mÄ± Ã¶nlemek iÃ§in CAPTCHA zorluklarÄ± kullanmak.
* **Referanslar**:
* [HackerOne Raporu 280534](https://hackerone.com/reports/280534)

## **Åifre SÄ±fÄ±rlama Token'Ä±nÄ±n NasÄ±l ÃœretildiÄŸini Bulma**

* Token Ã¼retimi arkasÄ±ndaki desen veya yÃ¶ntemi anlamak, token'larÄ± tahmin etmeye veya brute-force yapmaya yol aÃ§abilir. BazÄ± seÃ§enekler:
* Zaman DamgasÄ±na DayalÄ±
* KullanÄ±cÄ± KimliÄŸine DayalÄ±
* KullanÄ±cÄ±nÄ±n E-posta Adresine DayalÄ±
* Ad ve SoyadÄ±na DayalÄ±
* DoÄŸum Tarihine DayalÄ±
* Kriptografi Temelli
* **Azaltma AdÄ±mlarÄ±**:
* Token Ã¼retimi iÃ§in gÃ¼Ã§lÃ¼, kriptografik yÃ¶ntemler kullanmak.
* Tahmin edilebilirliÄŸi Ã¶nlemek iÃ§in yeterli rastgelelik ve uzunluk saÄŸlamak.
* **AraÃ§lar**: Token'larÄ±n rastgeleliÄŸini analiz etmek iÃ§in Burp Sequencer kullanÄ±n.

## **Tahmin Edilebilir UUID**

* UUID'ler (versiyon 1) tahmin edilebilir veya Ã¶ngÃ¶rÃ¼lebilir ise, saldÄ±rganlar geÃ§erli sÄ±fÄ±rlama token'larÄ± oluÅŸturmak iÃ§in brute-force yapabilir. Kontrol edin:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Azaltma AdÄ±mlarÄ±**:
* Rastgelelik iÃ§in GUID versiyon 4 kullanÄ±n veya diÄŸer versiyonlar iÃ§in ek gÃ¼venlik Ã¶nlemleri uygulayÄ±n.
* **AraÃ§lar**: GUID'leri analiz etmek ve oluÅŸturmak iÃ§in [guidtool](https://github.com/intruder-io/guidtool) kullanÄ±n.

## **YanÄ±t ManipÃ¼lasyonu: KÃ¶tÃ¼ YanÄ±tÄ± Ä°yi Olanla DeÄŸiÅŸtirme**

* Hata mesajlarÄ±nÄ± veya kÄ±sÄ±tlamalarÄ± aÅŸmak iÃ§in HTTP yanÄ±tlarÄ±nÄ± manipÃ¼le etme.
* **Azaltma AdÄ±mlarÄ±**:
* YanÄ±t bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ saÄŸlamak iÃ§in sunucu tarafÄ± kontrolleri uygulamak.
* Adam ortasÄ± saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in HTTPS gibi gÃ¼venli iletiÅŸim kanallarÄ± kullanmak.
* **Referans**:
* [CanlÄ± Hata AvÄ± EtkinliÄŸinde Kritik Hata](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **SÃ¼resi DolmuÅŸ Token Kullanma**

* SÃ¼resi dolmuÅŸ token'larÄ±n hala ÅŸifre sÄ±fÄ±rlama iÃ§in kullanÄ±lÄ±p kullanÄ±lamayacaÄŸÄ±nÄ± test etme.
* **Azaltma AdÄ±mlarÄ±**:
* KatÄ± token sÃ¼resi dolma politikalarÄ± uygulamak ve token sÃ¼resini sunucu tarafÄ±nda doÄŸrulamak.

## **Brute Force Åifre SÄ±fÄ±rlama Token'Ä±**

* IP tabanlÄ± hÄ±z sÄ±nÄ±rlamalarÄ±nÄ± aÅŸmak iÃ§in Burpsuite ve IP-Rotator gibi araÃ§lar kullanarak sÄ±fÄ±rlama token'Ä±nÄ± brute-force yapma giriÅŸimi.
* **Azaltma AdÄ±mlarÄ±**:
* SaÄŸlam hÄ±z sÄ±nÄ±rlama ve hesap kilitleme mekanizmalarÄ± uygulamak.
* Brute-force saldÄ±rÄ±larÄ±nÄ± gÃ¶steren ÅŸÃ¼pheli etkinlikleri izlemek.

## **Token'Ä±nÄ±zÄ± KullanmayÄ± Deneyin**

* Bir saldÄ±rganÄ±n sÄ±fÄ±rlama token'Ä±nÄ±n maÄŸdurun e-posta adresi ile birlikte kullanÄ±lÄ±p kullanÄ±lamayacaÄŸÄ±nÄ± test etme.
* **Azaltma AdÄ±mlarÄ±**:
* Token'larÄ±n kullanÄ±cÄ± oturumu veya diÄŸer kullanÄ±cÄ±ya Ã¶zgÃ¼ Ã¶zelliklere baÄŸlÄ± olduÄŸundan emin olun.

## **Oturum GeÃ§ersiz KÄ±lma: Ã‡Ä±kÄ±ÅŸ/Yeni Åifre SÄ±fÄ±rlama**

* KullanÄ±cÄ± Ã§Ä±kÄ±ÅŸ yaptÄ±ÄŸÄ±nda veya ÅŸifresini sÄ±fÄ±rladÄ±ÄŸÄ±nda oturumlarÄ±n geÃ§ersiz kÄ±lÄ±ndÄ±ÄŸÄ±ndan emin olma.
* **Azaltma AdÄ±mlarÄ±**:
* TÃ¼m oturumlarÄ±n Ã§Ä±kÄ±ÅŸ veya ÅŸifre sÄ±fÄ±rlama sÄ±rasÄ±nda geÃ§ersiz kÄ±lÄ±ndÄ±ÄŸÄ±ndan emin olmak iÃ§in uygun oturum yÃ¶netimi uygulamak.

## **Oturum GeÃ§ersiz KÄ±lma: Ã‡Ä±kÄ±ÅŸ/Yeni Åifre SÄ±fÄ±rlama**

* SÄ±fÄ±rlama token'larÄ±nÄ±n geÃ§ersiz hale gelmeden Ã¶nce bir son kullanma sÃ¼resi olmalÄ±dÄ±r.
* **Azaltma AdÄ±mlarÄ±**:
* SÄ±fÄ±rlama token'larÄ± iÃ§in makul bir son kullanma sÃ¼resi belirleyin ve bunu sunucu tarafÄ±nda katÄ± bir ÅŸekilde uygulayÄ±n.

## Referanslar

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve hata avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ± ve zorluklarÄ±na dalan iÃ§eriklerle etkileÅŸimde bulunun

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
GerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle hÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nda gÃ¼ncel kalÄ±n

**Son Duyurular**\
Yeni baÅŸlayan hata Ã¶dÃ¼lleri ve kritik platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± Ekip UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± Ekip UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
