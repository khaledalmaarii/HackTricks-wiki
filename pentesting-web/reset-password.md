# Reset/Forgotten Password Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## **Wycieki tokenÃ³w resetowania hasÅ‚a przez referer**

* NagÅ‚Ã³wek HTTP referer moÅ¼e ujawniaÄ‡ token resetowania hasÅ‚a, jeÅ›li jest zawarty w URL. MoÅ¼e to nastÄ…piÄ‡, gdy uÅ¼ytkownik kliknie link do strony trzeciej po zaÅ¼Ä…daniu resetowania hasÅ‚a.
* **WpÅ‚yw**: Potencjalne przejÄ™cie konta za pomocÄ… atakÃ³w Cross-Site Request Forgery (CSRF).
* **Eksploatacja**: Aby sprawdziÄ‡, czy token resetowania hasÅ‚a wycieka w nagÅ‚Ã³wku referer, **zaÅ¼Ä…daj resetowania hasÅ‚a** na swÃ³j adres e-mail i **kliknij link resetujÄ…cy**. **Nie zmieniaj hasÅ‚a** od razu. Zamiast tego, **przejdÅº do strony trzeciej** (takiej jak Facebook lub Twitter), jednoczeÅ›nie **przechwytujÄ…c Å¼Ä…dania za pomocÄ… Burp Suite**. SprawdÅº Å¼Ä…dania, aby zobaczyÄ‡, czy **nagÅ‚Ã³wek referer zawiera token resetowania hasÅ‚a**, poniewaÅ¼ moÅ¼e to ujawniÄ‡ wraÅ¼liwe informacje osobom trzecim.
* **Referencje**:
* [HackerOne Report 342693](https://hackerone.com/reports/342693)
* [HackerOne Report 272379](https://hackerone.com/reports/272379)
* [ArtykuÅ‚ o wycieku tokenÃ³w resetowania hasÅ‚a](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Zatrucie resetowania hasÅ‚a**

* AtakujÄ…cy mogÄ… manipulowaÄ‡ nagÅ‚Ã³wkiem Host podczas Å¼Ä…daÅ„ resetowania hasÅ‚a, aby skierowaÄ‡ link resetujÄ…cy do zÅ‚oÅ›liwej witryny.
* **WpÅ‚yw**: Prowadzi do potencjalnego przejÄ™cia konta przez ujawnienie tokenÃ³w resetowania atakujÄ…cym.
* **Kroki Å‚agodzÄ…ce**:
* Waliduj nagÅ‚Ã³wek Host w porÃ³wnaniu do biaÅ‚ej listy dozwolonych domen.
* UÅ¼ywaj bezpiecznych, serwerowych metod do generowania absolutnych URL.
* **Poprawka**: UÅ¼yj `$_SERVER['SERVER_NAME']` do konstruowania URL resetowania hasÅ‚a zamiast `$_SERVER['HTTP_HOST']`.
* **Referencje**:
* [ArtykuÅ‚ Acunetix o zatruciu resetowania hasÅ‚a](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetowanie hasÅ‚a przez manipulacjÄ™ parametrem e-mail**

AtakujÄ…cy mogÄ… manipulowaÄ‡ Å¼Ä…daniem resetowania hasÅ‚a, dodajÄ…c dodatkowe parametry e-mail, aby przekierowaÄ‡ link resetujÄ…cy.

* Dodaj e-mail atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Dodaj email atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Dodaj email atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Dodaj email atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Dodaj email atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Dodaj email atakujÄ…cego jako drugi parametr uÅ¼ywajÄ…c ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Dodaj email atakujÄ…cego jako drugi parametr w tablicy json
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Kroki Å‚agodzenia**:
* PrawidÅ‚owo analizuj i waliduj parametry e-mailowe po stronie serwera.
* UÅ¼ywaj przygotowanych instrukcji lub zapytaÅ„ z parametrami, aby zapobiec atakom typu injection.
* **Referencje**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Zmiana e-maila i hasÅ‚a dowolnego uÅ¼ytkownika za pomocÄ… parametrÃ³w API**

* AtakujÄ…cy mogÄ… modyfikowaÄ‡ parametry e-maila i hasÅ‚a w Å¼Ä…daniach API, aby zmieniÄ‡ dane logowania do konta.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Kroki Å‚agodzenia**:
* Zapewnij Å›cisÅ‚Ä… walidacjÄ™ parametrÃ³w i kontrole uwierzytelniania.
* WprowadÅº solidne logowanie i monitorowanie, aby wykrywaÄ‡ i reagowaÄ‡ na podejrzane dziaÅ‚ania.
* **Referencje**:
* [PeÅ‚ne przejÄ™cie konta za pomocÄ… manipulacji parametrami API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Brak ograniczeÅ„ szybkoÅ›ci: Bombardowanie e-mailem**

* Brak ograniczeÅ„ szybkoÅ›ci w Å¼Ä…daniach resetowania hasÅ‚a moÅ¼e prowadziÄ‡ do bombardowania e-mailem, przytÅ‚aczajÄ…c uÅ¼ytkownika wiadomoÅ›ciami o resetowaniu.
* **Kroki Å‚agodzenia**:
* WprowadÅº ograniczenia szybkoÅ›ci na podstawie adresu IP lub konta uÅ¼ytkownika.
* UÅ¼yj wyzwaÅ„ CAPTCHA, aby zapobiec automatycznemu naduÅ¼ywaniu.
* **Referencje**:
* [Raport HackerOne 280534](https://hackerone.com/reports/280534)

## **Dowiedz siÄ™, jak generowany jest token resetowania hasÅ‚a**

* Zrozumienie wzoru lub metody generowania tokenÃ³w moÅ¼e prowadziÄ‡ do przewidywania lub Å‚amania tokenÃ³w. NiektÃ³re opcje:
* Na podstawie znacznika czasu
* Na podstawie UserID
* Na podstawie e-maila uÅ¼ytkownika
* Na podstawie imienia i nazwiska
* Na podstawie daty urodzenia
* Na podstawie kryptografii
* **Kroki Å‚agodzenia**:
* UÅ¼yj silnych, kryptograficznych metod generowania tokenÃ³w.
* Zapewnij wystarczajÄ…cÄ… losowoÅ›Ä‡ i dÅ‚ugoÅ›Ä‡, aby zapobiec przewidywalnoÅ›ci.
* **NarzÄ™dzia**: UÅ¼yj Burp Sequencer, aby analizowaÄ‡ losowoÅ›Ä‡ tokenÃ³w.

## **Przewidywalny UUID**

* JeÅ›li UUID (wersja 1) sÄ… przewidywalne, atakujÄ…cy mogÄ… je Å‚amaÄ‡, aby generowaÄ‡ waÅ¼ne tokeny resetowania. SprawdÅº:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Kroki Å‚agodzenia**:
* UÅ¼yj GUID wersji 4 dla losowoÅ›ci lub wprowadÅº dodatkowe Å›rodki bezpieczeÅ„stwa dla innych wersji.
* **NarzÄ™dzia**: UÅ¼yj [guidtool](https://github.com/intruder-io/guidtool) do analizy i generowania GUID-Ã³w.

## **Manipulacja odpowiedziÄ…: ZastÄ…p zÅ‚Ä… odpowiedÅº dobrÄ…**

* Manipulowanie odpowiedziami HTTP, aby obejÅ›Ä‡ komunikaty o bÅ‚Ä™dach lub ograniczenia.
* **Kroki Å‚agodzenia**:
* WprowadÅº kontrole po stronie serwera, aby zapewniÄ‡ integralnoÅ›Ä‡ odpowiedzi.
* UÅ¼yj bezpiecznych kanaÅ‚Ã³w komunikacyjnych, takich jak HTTPS, aby zapobiec atakom typu man-in-the-middle.
* **Referencje**:
* [Krytyczny bÅ‚Ä…d w wydarzeniu Live Bug Bounty](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **UÅ¼ywanie wygasÅ‚ego tokena**

* Testowanie, czy wygasÅ‚e tokeny mogÄ… byÄ‡ nadal uÅ¼ywane do resetowania hasÅ‚a.
* **Kroki Å‚agodzenia**:
* WprowadÅº Å›cisÅ‚e zasady wygasania tokenÃ³w i waliduj wygasanie tokenÃ³w po stronie serwera.

## **Brute Force Token Resetowania HasÅ‚a**

* PrÃ³ba zÅ‚amania tokena resetowania za pomocÄ… narzÄ™dzi takich jak Burpsuite i IP-Rotator, aby obejÅ›Ä‡ ograniczenia szybkoÅ›ci oparte na IP.
* **Kroki Å‚agodzenia**:
* WprowadÅº solidne mechanizmy ograniczania szybkoÅ›ci i blokady konta.
* Monitoruj podejrzane dziaÅ‚ania wskazujÄ…ce na ataki brute-force.

## **SprÃ³buj uÅ¼yÄ‡ swojego tokena**

* Testowanie, czy token resetowania atakujÄ…cego moÅ¼e byÄ‡ uÅ¼yty w poÅ‚Ä…czeniu z e-mailem ofiary.
* **Kroki Å‚agodzenia**:
* Upewnij siÄ™, Å¼e tokeny sÄ… powiÄ…zane z sesjÄ… uÅ¼ytkownika lub innymi atrybutami specyficznymi dla uÅ¼ytkownika.

## **UniewaÅ¼nienie sesji przy wylogowaniu/resetowaniu hasÅ‚a**

* Zapewnienie, Å¼e sesje sÄ… uniewaÅ¼niane, gdy uÅ¼ytkownik siÄ™ wylogowuje lub resetuje hasÅ‚o.
* **Kroki Å‚agodzenia**:
* WprowadÅº odpowiednie zarzÄ…dzanie sesjami, zapewniajÄ…c, Å¼e wszystkie sesje sÄ… uniewaÅ¼niane po wylogowaniu lub resetowaniu hasÅ‚a.

## **UniewaÅ¼nienie sesji przy wylogowaniu/resetowaniu hasÅ‚a**

* Tokeny resetowania powinny mieÄ‡ czas wygaÅ›niÄ™cia, po ktÃ³rym stajÄ… siÄ™ niewaÅ¼ne.
* **Kroki Å‚agodzenia**:
* Ustaw rozsÄ…dny czas wygaÅ›niÄ™cia dla tokenÃ³w resetowania i Å›ciÅ›le egzekwuj go po stronie serwera.

## Referencje

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

DoÅ‚Ä…cz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikowaÄ‡ siÄ™ z doÅ›wiadczonymi hakerami i Å‚owcami bÅ‚Ä™dÃ³w!

**WglÄ…d w Hacking**\
ZaangaÅ¼uj siÄ™ w treÅ›ci, ktÃ³re zagÅ‚Ä™biajÄ… siÄ™ w emocje i wyzwania zwiÄ…zane z hackingiem

**AktualnoÅ›ci Hacking w czasie rzeczywistym**\
BÄ…dÅº na bieÅ¼Ä…co z dynamicznym Å›wiatem hackingu dziÄ™ki aktualnym wiadomoÅ›ciom i wglÄ…dom

**Najnowsze ogÅ‚oszenia**\
BÄ…dÅº na bieÅ¼Ä…co z najnowszymi nagrodami za bÅ‚Ä™dy i istotnymi aktualizacjami platformy

**DoÅ‚Ä…cz do nas na** [**Discord**](https://discord.com/invite/N3FrSbmwdy) i zacznij wspÃ³Å‚pracowaÄ‡ z najlepszymi hakerami juÅ¼ dziÅ›!

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do repozytoriÃ³w** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
