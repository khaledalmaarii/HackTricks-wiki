# R√©initialisation/Contournement de mot de passe oubli√©

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Rejoignez le [**serveur Discord HackenProof**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des hackers exp√©riment√©s et des chasseurs de bugs !

**Aper√ßus de Hacking**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du hacking

**Actualit√©s de Hacking en Temps R√©el**\
Restez √† jour avec le monde du hacking en rapide √©volution gr√¢ce √† des nouvelles et des aper√ßus en temps r√©el

**Derni√®res Annonces**\
Restez inform√© des nouvelles primes de bugs lanc√©es et des mises √† jour cruciales des plateformes

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs hackers aujourd'hui !

## **Fuite de jeton de r√©initialisation de mot de passe via le r√©f√©rent**

* L'en-t√™te HTTP referer peut fuir le jeton de r√©initialisation de mot de passe s'il est inclus dans l'URL. Cela peut se produire lorsqu'un utilisateur clique sur un lien de site tiers apr√®s avoir demand√© une r√©initialisation de mot de passe.
* **Impact** : Prise de contr√¥le potentielle du compte via des attaques de Cross-Site Request Forgery (CSRF).
* **Exploitation** : Pour v√©rifier si un jeton de r√©initialisation de mot de passe fuit dans l'en-t√™te r√©f√©rent, **demandez une r√©initialisation de mot de passe** √† votre adresse e-mail et **cliquez sur le lien de r√©initialisation** fourni. **Ne changez pas votre mot de passe** imm√©diatement. Au lieu de cela, **naviguez vers un site tiers** (comme Facebook ou Twitter) tout en **interceptant les requ√™tes avec Burp Suite**. Inspectez les requ√™tes pour voir si l'**en-t√™te r√©f√©rent contient le jeton de r√©initialisation de mot de passe**, car cela pourrait exposer des informations sensibles √† des tiers.
* **R√©f√©rences** :
* [HackerOne Rapport 342693](https://hackerone.com/reports/342693)
* [HackerOne Rapport 272379](https://hackerone.com/reports/272379)
* [Article sur la fuite de jeton de r√©initialisation de mot de passe](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Empoisonnement de r√©initialisation de mot de passe**

* Les attaquants peuvent manipuler l'en-t√™te Host lors des demandes de r√©initialisation de mot de passe pour pointer le lien de r√©initialisation vers un site malveillant.
* **Impact** : Conduit √† une prise de contr√¥le potentielle du compte en fuyant les jetons de r√©initialisation aux attaquants.
* **√âtapes d'att√©nuation** :
* Validez l'en-t√™te Host par rapport √† une liste blanche de domaines autoris√©s.
* Utilisez des m√©thodes s√©curis√©es c√¥t√© serveur pour g√©n√©rer des URL absolues.
* **Patch** : Utilisez `$_SERVER['SERVER_NAME']` pour construire des URL de r√©initialisation de mot de passe au lieu de `$_SERVER['HTTP_HOST']`.
* **R√©f√©rences** :
* [Article Acunetix sur l'empoisonnement de r√©initialisation de mot de passe](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **R√©initialisation de mot de passe en manipulant le param√®tre email**

Les attaquants peuvent manipuler la demande de r√©initialisation de mot de passe en ajoutant des param√®tres d'email suppl√©mentaires pour d√©tourner le lien de r√©initialisation.

* Ajoutez l'email de l'attaquant comme deuxi√®me param√®tre en utilisant &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre en utilisant %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre en utilisant |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre en utilisant cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre en utilisant bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre en utilisant ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Ajouter l'email de l'attaquant comme deuxi√®me param√®tre dans le tableau json
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **√âtapes d'att√©nuation** :
* Analyser et valider correctement les param√®tres d'email c√¥t√© serveur.
* Utiliser des instructions pr√©par√©es ou des requ√™tes param√©tr√©es pour pr√©venir les attaques par injection.
* **R√©f√©rences** :
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Changer l'email et le mot de passe de n'importe quel utilisateur via les param√®tres API**

* Les attaquants peuvent modifier les param√®tres d'email et de mot de passe dans les requ√™tes API pour changer les identifiants du compte.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **√âtapes d'att√©nuation** :
* Assurez-vous d'une validation stricte des param√®tres et des v√©rifications d'authentification.
* Mettez en ≈ìuvre une journalisation et une surveillance robustes pour d√©tecter et r√©pondre aux activit√©s suspectes.
* **R√©f√©rence** :
* [Prise de contr√¥le compl√®te du compte via manipulation des param√®tres API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Pas de limitation de taux : Bombardement d'emails**

* L'absence de limitation de taux sur les demandes de r√©initialisation de mot de passe peut entra√Æner un bombardement d'emails, submergeant l'utilisateur avec des emails de r√©initialisation.
* **√âtapes d'att√©nuation** :
* Mettez en ≈ìuvre une limitation de taux bas√©e sur l'adresse IP ou le compte utilisateur.
* Utilisez des d√©fis CAPTCHA pour pr√©venir les abus automatis√©s.
* **R√©f√©rences** :
* [HackerOne Rapport 280534](https://hackerone.com/reports/280534)

## **D√©couvrez comment le jeton de r√©initialisation de mot de passe est g√©n√©r√©**

* Comprendre le mod√®le ou la m√©thode derri√®re la g√©n√©ration de jetons peut conduire √† pr√©dire ou √† forcer des jetons. Quelques options :
* Bas√© sur l'horodatage
* Bas√© sur l'ID utilisateur
* Bas√© sur l'email de l'utilisateur
* Bas√© sur le pr√©nom et le nom
* Bas√© sur la date de naissance
* Bas√© sur la cryptographie
* **√âtapes d'att√©nuation** :
* Utilisez des m√©thodes cryptographiques solides pour la g√©n√©ration de jetons.
* Assurez-vous d'une randomisation et d'une longueur suffisantes pour pr√©venir la pr√©visibilit√©.
* **Outils** : Utilisez Burp Sequencer pour analyser la randomisation des jetons.

## **UUID devinable**

* Si les UUID (version 1) sont devinables ou pr√©visibles, les attaquants peuvent les forcer pour g√©n√©rer des jetons de r√©initialisation valides. V√©rifiez :

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **√âtapes d'att√©nuation** :
* Utilisez la version 4 de GUID pour la randomisation ou mettez en ≈ìuvre des mesures de s√©curit√© suppl√©mentaires pour les autres versions.
* **Outils** : Utilisez [guidtool](https://github.com/intruder-io/guidtool) pour analyser et g√©n√©rer des GUID.

## **Manipulation de r√©ponse : Remplacer une mauvaise r√©ponse par une bonne**

* Manipuler les r√©ponses HTTP pour contourner les messages d'erreur ou les restrictions.
* **√âtapes d'att√©nuation** :
* Mettez en ≈ìuvre des v√©rifications c√¥t√© serveur pour garantir l'int√©grit√© des r√©ponses.
* Utilisez des canaux de communication s√©curis√©s comme HTTPS pour pr√©venir les attaques de type homme du milieu.
* **R√©f√©rence** :
* [Bug critique dans un √©v√©nement de bug bounty en direct](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Utilisation de jeton expir√©**

* Tester si des jetons expir√©s peuvent encore √™tre utilis√©s pour la r√©initialisation de mot de passe.
* **√âtapes d'att√©nuation** :
* Mettez en ≈ìuvre des politiques strictes d'expiration des jetons et validez l'expiration des jetons c√¥t√© serveur.

## **Brute Force du jeton de r√©initialisation de mot de passe**

* Tenter de forcer le jeton de r√©initialisation en utilisant des outils comme Burpsuite et IP-Rotator pour contourner les limites de taux bas√©es sur l'IP.
* **√âtapes d'att√©nuation** :
* Mettez en ≈ìuvre des m√©canismes de limitation de taux robustes et de verrouillage de compte.
* Surveillez les activit√©s suspectes indiquant des attaques par force brute.

## **Essayez d'utiliser votre jeton**

* Tester si le jeton de r√©initialisation d'un attaquant peut √™tre utilis√© en conjonction avec l'email de la victime.
* **√âtapes d'att√©nuation** :
* Assurez-vous que les jetons sont li√©s √† la session utilisateur ou √† d'autres attributs sp√©cifiques √† l'utilisateur.

## **Invalidation de session lors de la d√©connexion/r√©initialisation de mot de passe**

* Assurez-vous que les sessions sont invalid√©es lorsqu'un utilisateur se d√©connecte ou r√©initialise son mot de passe.
* **√âtapes d'att√©nuation** :
* Mettez en ≈ìuvre une gestion appropri√©e des sessions, en veillant √† ce que toutes les sessions soient invalid√©es lors de la d√©connexion ou de la r√©initialisation du mot de passe.

## **Invalidation de session lors de la d√©connexion/r√©initialisation de mot de passe**

* Les jetons de r√©initialisation doivent avoir un temps d'expiration apr√®s lequel ils deviennent invalides.
* **√âtapes d'att√©nuation** :
* D√©finissez un temps d'expiration raisonnable pour les jetons de r√©initialisation et appliquez-le strictement c√¥t√© serveur.

## R√©f√©rences

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des hackers exp√©riment√©s et des chasseurs de bugs !

**Aper√ßus de hacking**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du hacking

**Actualit√©s de hacking en temps r√©el**\
Restez √† jour avec le monde du hacking en rapide √©volution gr√¢ce √† des nouvelles et des aper√ßus en temps r√©el

**Derni√®res annonces**\
Restez inform√© des nouveaux bug bounties lanc√©s et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs hackers aujourd'hui !

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux d√©p√¥ts GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
