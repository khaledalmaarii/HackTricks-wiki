<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de cybersÃ©curitÃ©? Voulez-vous voir votre entreprise annoncÃ©e dans HackTricks? ou voulez-vous avoir accÃ¨s Ã  la derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF? Consultez les PLANS D'ABONNEMENT!

- DÃ©couvrez The PEASS Family, notre collection exclusive de NFTs

- Obtenez le swag officiel PEASS & HackTricks

- Rejoignez le groupe Discord ou le groupe Telegram ou suivez-moi sur Twitter @carlospolopm.

- Partagez vos astuces de piratage en soumettant des PR au repo hacktricks et hacktricks-cloud.

</details>


# Description

Dans une situation oÃ¹ un attaquant peut contrÃ´ler l'argument `href` d'une balise `<a>` avec l'attribut `target="_blank" rel="opener"` qui va Ãªtre cliquÃ©e par une victime, l'attaquant pointe ce lien vers un site web sous son contrÃ´le (un site web malveillant). Ensuite, une fois que la victime clique sur le lien et accÃ¨de au site web de l'attaquant, ce site web malveillant sera capable de contrÃ´ler la page originale via l'objet javascript `window.opener`. Si la page ne contient pas `rel="opener"` mais contient `target="_blank"` et n'a pas non plus `rel="noopener"`, elle peut Ã©galement Ãªtre vulnÃ©rable.

Une faÃ§on courante d'exploiter ce comportement serait de changer l'emplacement du site web original via `window.opener.location = https://attacker.com/victim.html` vers un site web contrÃ´lÃ© par l'attaquant qui ressemble Ã  l'original, de sorte qu'il peut imiter le formulaire de connexion du site web original et demander des informations d'identification Ã  l'utilisateur.

Cependant, notez que comme l'attaquant peut maintenant contrÃ´ler l'objet de fenÃªtre du site web original, il peut l'exploiter de diffÃ©rentes maniÃ¨res pour effectuer des attaques plus discrÃ¨tes (peut-Ãªtre en modifiant les Ã©vÃ©nements javascript pour exfiltrer des informations vers un serveur contrÃ´lÃ© par lui ?)

# AperÃ§u

## Avec lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de prÃ©vention n'est pas utilisÃ© :

![](https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png)

## Sans lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de prÃ©vention est utilisÃ© :

![](https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png)

## Exemples <a href="#examples" id="examples"></a>

CrÃ©ez les pages suivantes dans un dossier et exÃ©cutez un serveur web avec `python3 -m http.server`\
Ensuite, accÃ©dez Ã  `http://127.0.0.1:8000/`vulnerable.html, cliquez sur le lien et notez comment l'URL du site web original change.
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}

```html
<a href="https://example.com" target="_blank" rel="noopener noreferrer" onclick="window.opener.location='https://attacker.com'">Click me!</a>
```

{% endcode %}

Le reverse tab nabbing est une technique d'attaque qui consiste Ã  modifier le comportement par dÃ©faut des liens hypertextes pour rediriger l'utilisateur vers un site malveillant. Cette technique est souvent utilisÃ©e pour voler des informations d'identification ou pour exÃ©cuter du code malveillant sur le navigateur de la victime.

Le reverse tab nabbing fonctionne en exploitant le comportement par dÃ©faut des liens hypertextes qui s'ouvrent dans un nouvel onglet ou une nouvelle fenÃªtre. En modifiant le code HTML d'un lien hypertexte pour inclure un script malveillant, un attaquant peut rediriger l'utilisateur vers un site malveillant tout en gardant le site d'origine ouvert dans un onglet ou une fenÃªtre diffÃ©rente.

Pour se protÃ©ger contre le reverse tab nabbing, les utilisateurs doivent Ãªtre conscients des liens hypertextes qu'ils cliquent et Ã©viter de cliquer sur des liens suspects ou non fiables. Les dÃ©veloppeurs peuvent Ã©galement protÃ©ger leurs sites en ajoutant l'attribut `rel="noopener noreferrer"` aux liens hypertextes qui s'ouvrent dans un nouvel onglet ou une nouvelle fenÃªtre. Cela empÃªchera le script malveillant d'accÃ©der Ã  la fenÃªtre parente et de rediriger l'utilisateur vers un site malveillant.
```markup
<!DOCTYPE html>
<html>
 <body>
  <script>
  window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
  </script>
 </body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
## PropriÃ©tÃ©s accessibles <a href="#accessible-properties" id="accessible-properties"></a>

Le site malveillant ne peut accÃ©der qu'aux propriÃ©tÃ©s suivantes de l'objet de rÃ©fÃ©rence javascript **opener** (qui est en fait une rÃ©fÃ©rence Ã  une instance de la classe javascript **window**) en cas d'accÃ¨s **cross origin** (entre diffÃ©rents domaines) :

* `opener.closed` : Renvoie une valeur boolÃ©enne indiquant si une fenÃªtre a Ã©tÃ© fermÃ©e ou non.
* `opener.frames` : Renvoie tous les Ã©lÃ©ments iframe dans la fenÃªtre actuelle.
* `opener.length` : Renvoie le nombre d'Ã©lÃ©ments iframe dans la fenÃªtre actuelle.
* `opener.opener` : Renvoie une rÃ©fÃ©rence Ã  la fenÃªtre qui a crÃ©Ã© la fenÃªtre.
* `opener.parent` : Renvoie la fenÃªtre parent de la fenÃªtre actuelle.
* `opener.self` : Renvoie la fenÃªtre actuelle.
* `opener.top` : Renvoie la fenÃªtre de navigateur la plus haute.

Si les domaines sont identiques, le site malveillant peut accÃ©der Ã  toutes les propriÃ©tÃ©s exposÃ©es par l'objet de rÃ©fÃ©rence javascript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# PrÃ©vention

Les informations de prÃ©vention sont documentÃ©es dans la [feuille de triche HTML5](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

# RÃ©fÃ©rences

{% embed url="https://owasp.org/www-community/attacks/Reverse_Tabnabbing" %}




<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
