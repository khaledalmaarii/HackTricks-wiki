# MySQL Dosya izni SSRF/RCE

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸÃ¼n</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

**Bu, [https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/](https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/) adresindeki MySQL/MariaDB/Percona tekniklerinin bir Ã¶zetidir**.

### SQL FonksiyonlarÄ± AracÄ±lÄ±ÄŸÄ±yla Sunucu TarafÄ±ndan Ä°stek SahteciliÄŸi (SSRF)

SQL DÄ±ÅŸÄ±nda Veri SÄ±zdÄ±rma araÅŸtÄ±rmalarÄ±nda, aÄŸ isteklerini baÅŸlatmak iÃ§in genellikle `LOAD_FILE()` fonksiyonu kullanÄ±lÄ±r. Ancak bu fonksiyon, iÅŸletim sistemi ve veritabanÄ±nÄ±n baÅŸlangÄ±Ã§ yapÄ±landÄ±rmalarÄ± tarafÄ±ndan sÄ±nÄ±rlanÄ±r.

`secure_file_priv` global deÄŸiÅŸkeni, ayarlanmamÄ±ÅŸsa, `/var/lib/mysql-files/` olarak varsayÄ±lan deÄŸere sahiptir ve dosya eriÅŸimini bu dizine sÄ±nÄ±rlar, boÅŸ bir dize (`""`) olarak ayarlanmadÄ±kÃ§a. Bu ayarlamalar, veritabanÄ±nÄ±n yapÄ±landÄ±rma dosyasÄ±nda veya baÅŸlangÄ±Ã§ parametrelerinde deÄŸiÅŸiklik yapmayÄ± gerektirir.

`secure_file_priv` devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±ÄŸÄ±nda (`""`) ve gerekli dosya ve `file_priv` izinleri verildiÄŸinde, belirlenen dizinin dÄ±ÅŸÄ±ndaki dosyalar okunabilir. Ancak, bu fonksiyonlarÄ±n aÄŸ Ã§aÄŸrÄ±larÄ± yapabilme yeteneÄŸi, iÅŸletim sistemine baÄŸlÄ±dÄ±r. Windows sistemlerinde, UNC yollarÄ±na aÄŸ Ã§aÄŸrÄ±larÄ±, iÅŸletim sisteminin UNC adlandÄ±rma kurallarÄ±nÄ± anlamasÄ± nedeniyle mÃ¼mkÃ¼ndÃ¼r ve bu da NTLMv2 karma deÄŸerlerinin sÄ±zdÄ±rÄ±lmasÄ±na yol aÃ§abilir.

Bu SSRF yÃ¶ntemi, TCP baÄŸlantÄ± noktasÄ± 445 ile sÄ±nÄ±rlÄ±dÄ±r ve baÄŸlantÄ± noktasÄ± numarasÄ± deÄŸiÅŸtirilmesine izin vermez, ancak tam okuma izinleri olan paylaÅŸÄ±mlara eriÅŸmek ve Ã¶nceki araÅŸtÄ±rmalarda gÃ¶sterildiÄŸi gibi daha fazla istismar iÃ§in karma deÄŸerlerini Ã§almak iÃ§in kullanÄ±labilir.

### KullanÄ±cÄ± TanÄ±mlÄ± Fonksiyonlar (UDF) AracÄ±lÄ±ÄŸÄ±yla Uzaktan Kod YÃ¼rÃ¼tme (RCE)

MySQL veritabanlarÄ±, harici kitaplÄ±k dosyalarÄ±ndan KullanÄ±cÄ± TanÄ±mlÄ± Fonksiyonlar (UDF) kullanÄ±mÄ±nÄ± sunar. Bu kitaplÄ±klar, belirli dizinlerde veya sistem `$PATH`'inde eriÅŸilebilir durumdaysa, MySQL iÃ§inden Ã§aÄŸrÄ±labilir.

Bu teknik, `@@plugin_dir`'e yazma eriÅŸimi, `file_priv`'in `Y` olarak ayarlanmasÄ± ve `secure_file_priv`'in devre dÄ±ÅŸÄ± bÄ±rakÄ±lmasÄ± gibi birkaÃ§ koÅŸulun karÅŸÄ±lanmasÄ± durumunda, bir UDF aracÄ±lÄ±ÄŸÄ±yla aÄŸ/HTTP isteklerinin yÃ¼rÃ¼tÃ¼lmesine olanak tanÄ±r.

Ã–rneÄŸin, `lib_mysqludf_sys` kitaplÄ±ÄŸÄ± veya HTTP isteklerini etkinleÅŸtiren diÄŸer UDF kitaplÄ±klarÄ±, SSRF gerÃ§ekleÅŸtirmek iÃ§in yÃ¼klenebilir. KitaplÄ±klarÄ±n sunucuya aktarÄ±lmasÄ± gerekmektedir, bunu kitaplÄ±ÄŸÄ±n iÃ§eriÄŸinin hex veya base64 kodlamasÄ±yla yaparak ve ardÄ±ndan uygun dizine yazarak baÅŸarabilirsiniz.

`@@plugin_dir` yazÄ±labilir deÄŸilse, Ã¶zellikle `v5.0.67` Ã¼zeri MySQL sÃ¼rÃ¼mleri iÃ§in iÅŸlem farklÄ±lÄ±k gÃ¶sterir. Bu durumlarda, yazÄ±labilir alternatif yollar kullanÄ±lmalÄ±dÄ±r.

Bu sÃ¼reÃ§lerin otomasyonu, UDF enjeksiyonunu destekleyen SQLMap gibi araÃ§larla kolaylaÅŸtÄ±rÄ±labilir ve kÃ¶r SQL enjeksiyonlarÄ± iÃ§in Ã§Ä±ktÄ± yÃ¶nlendirmesi veya DNS isteÄŸi kaÃ§Ä±rma teknikleri kullanÄ±labilir.

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸÃ¼n</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter'da** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
