{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### PostgreSQL ëŒ€ìš©ëŸ‰ ê°ì²´

PostgreSQLì€ **ëŒ€ìš©ëŸ‰ ê°ì²´**ë¡œ ì•Œë ¤ì§„ êµ¬ì¡°ë¥¼ ì œê³µí•˜ë©°, ì´ëŠ” `pg_largeobject` í…Œì´ë¸”ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¯¸ì§€ë‚˜ PDF ë¬¸ì„œì™€ ê°™ì€ ëŒ€í˜• ë°ì´í„° ìœ í˜•ì„ ì €ì¥í•˜ê¸° ìœ„í•´ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ **ë°ì´í„°ë¥¼ íŒŒì¼ ì‹œìŠ¤í…œìœ¼ë¡œ ë‹¤ì‹œ ë‚´ë³´ë‚´ëŠ”** ê¸°ëŠ¥ì„ ì œê³µí•˜ë¯€ë¡œ `COPY TO` í•¨ìˆ˜ë³´ë‹¤ ìœ ë¦¬í•˜ë©°, ì›ë³¸ íŒŒì¼ì˜ ì •í™•í•œ ë³µì œë³¸ì´ ìœ ì§€ë©ë‹ˆë‹¤.

ì´ í…Œì´ë¸” ë‚´ì—ì„œ **ì „ì²´ íŒŒì¼ì„ ì €ì¥í•˜ê¸° ìœ„í•´** `pg_largeobject` í…Œì´ë¸”ì— ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í•˜ë©°(LOIDë¡œ ì‹ë³„ë¨), ê·¸ ë‹¤ìŒì— ê° 2KB í¬ê¸°ì˜ ë°ì´í„° ì²­í¬ë¥¼ ì´ ê°ì²´ì— ì‚½ì…í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì²­í¬ëŠ” ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ë„ë¡ í•˜ê¸° ìœ„í•´ ì •í™•íˆ 2KB í¬ê¸°ì—¬ì•¼ í•˜ë©°(ë§ˆì§€ë§‰ ì²­í¬ëŠ” ì˜ˆì™¸ì¼ ìˆ˜ ìˆìŒ) ì¤‘ìš”í•©ë‹ˆë‹¤.

**ì´ì§„ ë°ì´í„°ë¥¼** 2KB ì²­í¬ë¡œ **ë‚˜ëˆ„ê¸° ìœ„í•´** ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
split -b 2048 your_file # Creates 2KB sized files
```
ê° íŒŒì¼ì„ Base64 ë˜ëŠ” Hexë¡œ ì¸ì½”ë”©í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**ì¤‘ìš”**: ì´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•  ë•Œ, 2KBì˜ ì¼ë°˜ í…ìŠ¤íŠ¸ ë°”ì´íŠ¸ ì²­í¬ë¥¼ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤. í—¥ìŠ¤ ì¸ì½”ë”©ëœ íŒŒì¼ì€ í¬ê¸°ê°€ ë‘ ë°°ë¡œ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— ì²­í¬ë‹¹ 4KBì˜ ë°ì´í„°ê°€ í•„ìš”í•˜ë©°, Base64 ì¸ì½”ë”©ëœ íŒŒì¼ì€ `ceil(n / 3) * 4` ê³µì‹ì„ ë”°ë¦…ë‹ˆë‹¤.

ëŒ€ìš©ëŸ‰ ê°ì²´ì˜ ë‚´ìš©ì€ ë””ë²„ê¹… ëª©ì ìœ¼ë¡œ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì—¬ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### Using `lo_creat` & Base64

ì´ì§„ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´, ë¨¼ì € LOIDê°€ ìƒì„±ë©ë‹ˆë‹¤:
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
ì •í™•í•œ ì œì–´ê°€ í•„ìš”í•œ ìƒí™©, ì˜ˆë¥¼ ë“¤ì–´ Blind SQL Injectionì„ ì•…ìš©í•  ë•Œ, `lo_create`ëŠ” ê³ ì • LOIDë¥¼ ì§€ì •í•˜ëŠ” ë° ì„ í˜¸ë©ë‹ˆë‹¤.

ë°ì´í„° ì²­í¬ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
ëŒ€ìƒ ì‚¬ìš© í›„ ëŒ€ìš©ëŸ‰ ê°ì²´ë¥¼ ë‚´ë³´ë‚´ê³  ì ì¬ì ìœ¼ë¡œ ì‚­ì œí•˜ë ¤ë©´:
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### Using `lo_import` & Hex

`lo_import` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ìš©ëŸ‰ ê°ì²´ì— ëŒ€í•œ LOIDë¥¼ ìƒì„±í•˜ê³  ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
ê°ì²´ ìƒì„± í›„, ê° í˜ì´ì§€ì— ë°ì´í„°ê°€ ì‚½ì…ë˜ë©°, ê° ì²­í¬ê°€ 2KBë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤:
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
í”„ë¡œì„¸ìŠ¤ë¥¼ ì™„ë£Œí•˜ê¸° ìœ„í•´ ë°ì´í„°ê°€ ë‚´ë³´ë‚´ì§€ê³  ëŒ€ìš©ëŸ‰ ê°ì²´ê°€ ì‚­ì œë©ë‹ˆë‹¤:
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### Limitations

**ëŒ€ìš©ëŸ‰ ê°ì²´ëŠ” ACL(Access Control Lists)ì„ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°**, ì´ëŠ” ì‚¬ìš©ìê°€ ìƒì„±í•œ ê°ì²´ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í—ˆìš©ëœ ACLì„ ê°€ì§„ ì˜¤ë˜ëœ ê°ì²´ëŠ” ì—¬ì „íˆ ì½˜í…ì¸  ìœ ì¶œì„ ìœ„í•´ ì ‘ê·¼í•  ìˆ˜ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
