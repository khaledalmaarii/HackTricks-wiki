{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### PostgreSQL å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

PostgreSQLã¯ã€**å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã‚‹æ§‹é€ ã‚’æä¾›ã—ã¦ãŠã‚Šã€`pg_largeobject`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä»‹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã€ç”»åƒã‚„PDFæ–‡æ›¸ãªã©ã®å¤§ããªãƒ‡ãƒ¼ã‚¿å‹ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€**ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«æˆ»ã™ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã€`COPY TO`é–¢æ•°ã‚ˆã‚Šã‚‚æœ‰åˆ©ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã®æ­£ç¢ºãªè¤‡è£½ãŒç¶­æŒã•ã‚Œã¾ã™ã€‚

ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã«**å®Œå…¨ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹**ãŸã‚ã«ã¯ã€`pg_largeobject`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ï¼ˆLOIDã§è­˜åˆ¥ã•ã‚Œã‚‹ï¼‰ã€æ¬¡ã«ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«2KBã®ã‚µã‚¤ã‚ºã®ãƒ‡ãƒ¼ã‚¿ãƒãƒ£ãƒ³ã‚¯ã‚’æŒ¿å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒãƒ£ãƒ³ã‚¯ã¯ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ãŸã‚ã«ã€æ­£ç¢ºã«2KBã®ã‚µã‚¤ã‚ºã§ã‚ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ï¼ˆæœ€å¾Œã®ãƒãƒ£ãƒ³ã‚¯ã¯ä¾‹å¤–ã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚

**ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’2KBã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²ã™ã‚‹**ãŸã‚ã«ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼š
```bash
split -b 2048 your_file # Creates 2KB sized files
```
å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Base64ã¾ãŸã¯Hexã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**é‡è¦**: ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã™ã‚‹éš›ã¯ã€2KBã®ã‚¯ãƒªã‚¢ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒˆã®ãƒãƒ£ãƒ³ã‚¯ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚16é€²æ•°ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚µã‚¤ã‚ºãŒå€ã«ãªã‚‹ãŸã‚ã€ãƒãƒ£ãƒ³ã‚¯ã”ã¨ã«4KBã®ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™ã€‚ä¸€æ–¹ã€Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€`ceil(n / 3) * 4`ã®å¼ã«å¾“ã„ã¾ã™ã€‚

å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å†…å®¹ã¯ã€ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦è¡¨ç¤ºã§ãã¾ã™:
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### Using `lo_creat` & Base64

ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«ã€æœ€åˆã«LOIDãŒä½œæˆã•ã‚Œã¾ã™:
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
ç²¾å¯†ãªåˆ¶å¾¡ãŒå¿…è¦ãªçŠ¶æ³ã€ä¾‹ãˆã°Blind SQL Injectionã‚’æ‚ªç”¨ã™ã‚‹å ´åˆã€`lo_create`ã¯å›ºå®šLOIDã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã«å¥½ã¾ã‚Œã¾ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒãƒ£ãƒ³ã‚¯ã¯æ¬¡ã®ã‚ˆã†ã«æŒ¿å…¥ã§ãã¾ã™:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨å¾Œã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã€æ½œåœ¨çš„ã«å‰Šé™¤ã™ã‚‹ã«ã¯ï¼š
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### Using `lo_import` & Hex

`lo_import` é–¢æ•°ã¯ã€å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãŸã‚ã« LOID ã‚’ä½œæˆã—ã€æŒ‡å®šã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã§ãã¾ã™ï¼š
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆå¾Œã€ãƒ‡ãƒ¼ã‚¿ã¯ãƒšãƒ¼ã‚¸ã”ã¨ã«æŒ¿å…¥ã•ã‚Œã€å„ãƒãƒ£ãƒ³ã‚¯ãŒ2KBã‚’è¶…ãˆãªã„ã‚ˆã†ã«ã—ã¾ã™ï¼š
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Œäº†ã™ã‚‹ãŸã‚ã«ã€ãƒ‡ãƒ¼ã‚¿ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã€å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå‰Šé™¤ã•ã‚Œã¾ã™ï¼š
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### åˆ¶é™äº‹é …

**å¤§ããªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ACLï¼ˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼‰ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Š**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒåˆ¶é™ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€è¨±å¯ã•ã‚ŒãŸACLã‚’æŒã¤å¤ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æŠ½å‡ºã«å¯¾ã—ã¦å¼•ãç¶šãã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
