# Injection Unicode

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Introduction

Selon la mani√®re dont le back-end/front-end se comporte lorsqu'il **re√ßoit des caract√®res unicode √©tranges**, un attaquant pourrait √™tre capable de **contourner les protections et injecter des caract√®res arbitraires** qui pourraient √™tre utilis√©s pour **exploiter des vuln√©rabilit√©s d'injection** telles que XSS ou SQLi.

## Normalisation Unicode

La normalisation Unicode se produit lorsque **les caract√®res unicode sont normalis√©s en caract√®res ascii**.

Un sc√©nario courant de ce type de vuln√©rabilit√© se produit lorsque le syst√®me **modifie** d'une mani√®re ou d'une autre l'**entr√©e** de l'utilisateur **apr√®s l'avoir v√©rifi√©e**. Par exemple, dans certaines langues, un simple appel pour rendre l'**entr√©e en majuscules ou en minuscules** pourrait normaliser l'entr√©e donn√©e et l'**unicode sera transform√© en ASCII**, g√©n√©rant de nouveaux caract√®res.\
Pour plus d'informations, consultez :

{% content-ref url="unicode-normalization.md" %}
[unicode-normalization.md](unicode-normalization.md)
{% endcontent-ref %}

## `\u` en `%`

Les caract√®res Unicode sont g√©n√©ralement repr√©sent√©s avec le pr√©fixe **`\u`**. Par exemple, le caract√®re `„±ã` est `\u3c4b`([v√©rifiez-le ici](https://unicode-explorer.com/c/3c4B)). Si un backend **transforme** le pr√©fixe **`\u` en `%`**, la cha√Æne r√©sultante sera `%3c4b`, qui, une fois d√©cod√©e en URL, est : **`<4b`**. Et, comme vous pouvez le voir, un caract√®re **`<` est inject√©**.\
Vous pourriez utiliser cette technique pour **injecter n'importe quel type de caract√®re** si le backend y est vuln√©rable.\
Consultez [https://unicode-explorer.com/](https://unicode-explorer.com/) pour trouver les caract√®res dont vous avez besoin.

Cette vuln provient en fait d'une vuln√©rabilit√© qu'un chercheur a trouv√©e, pour une explication plus approfondie consultez [https://www.youtube.com/watch?v=aUsAHb0E7Cg](https://www.youtube.com/watch?v=aUsAHb0E7Cg)

## Injection d'Emoji

Les back-ends se comportent parfois de mani√®re √©trange lorsqu'ils **re√ßoivent des emojis**. C'est ce qui s'est pass√© dans [**ce compte-rendu**](https://medium.com/@fpatrik/how-i-found-an-xss-vulnerability-via-using-emojis-7ad72de49209) o√π le chercheur a r√©ussi √† obtenir un XSS avec une charge utile telle que : `üíãimg src=x onerror=alert(document.domain)//üíõ`

Dans ce cas, l'erreur √©tait que le serveur, apr√®s avoir supprim√© les caract√®res malveillants, **a converti la cha√Æne UTF-8 de Windows-1252 en UTF-8** (en gros, l'encodage d'entr√©e et la conversion de l'encodage ne correspondaient pas). Cela ne donne pas un vrai `<` mais un unicode √©trange : `‚Äπ`\
``Ils ont donc pris cette sortie et **l'ont convertie √† nouveau maintenant de UTF-8 en ASCII**. Cela a **normalis√©** le `‚Äπ` en `<` c'est ainsi que l'exploit a pu fonctionner sur ce syst√®me.\
Voici ce qui s'est pass√© :
```php
<?php

$str = isset($_GET["str"]) ? htmlspecialchars($_GET["str"]) : "";

$str = iconv("Windows-1252", "UTF-8", $str);
$str = iconv("UTF-8", "ASCII//TRANSLIT", $str);

echo "String: " . $str;
```
Listes d'√©mojis :

* [https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv](https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv)
* [https://unicode.org/emoji/charts-14.0/full-emoji-list.html](https://unicode.org/emoji/charts-14.0/full-emoji-list.html)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
