# Unicode Normalization

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**This is a summary of:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/). Check a look for further details (images taken form there).

## Understanding Unicode and Normalization

ìœ ë‹ˆì½”ë“œ ì •ê·œí™”ëŠ” ë¬¸ìì˜ ì„œë¡œ ë‹¤ë¥¸ ì´ì§„ í‘œí˜„ì´ ë™ì¼í•œ ì´ì§„ ê°’ìœ¼ë¡œ í‘œì¤€í™”ë˜ë„ë¡ í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì´ ê³¼ì •ì€ í”„ë¡œê·¸ë˜ë° ë° ë°ì´í„° ì²˜ë¦¬ì—ì„œ ë¬¸ìì—´ì„ ë‹¤ë£° ë•Œ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ìœ ë‹ˆì½”ë“œ í‘œì¤€ì€ ë‘ ê°€ì§€ ìœ í˜•ì˜ ë¬¸ì ë™ë“±ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤:

1. **ì •ê·œ ë™ë“±ì„±**: ë¬¸ìê°€ ì¸ì‡„ë˜ê±°ë‚˜ í‘œì‹œë  ë•Œ ë™ì¼í•œ ëª¨ì–‘ê³¼ ì˜ë¯¸ë¥¼ ê°€ì§€ë©´ ì •ê·œ ë™ë“±í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.
2. **í˜¸í™˜ ë™ë“±ì„±**: ë¬¸ìê°€ ë™ì¼í•œ ì¶”ìƒ ë¬¸ìë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì§€ë§Œ ë‹¤ë¥´ê²Œ í‘œì‹œë  ìˆ˜ ìˆëŠ” ì•½í•œ í˜•íƒœì˜ ë™ë“±ì„±ì…ë‹ˆë‹¤.

**ë„¤ ê°€ì§€ ìœ ë‹ˆì½”ë“œ ì •ê·œí™” ì•Œê³ ë¦¬ì¦˜**ì´ ìˆìŠµë‹ˆë‹¤: NFC, NFD, NFKC, NFKD. ê° ì•Œê³ ë¦¬ì¦˜ì€ ì •ê·œ ë° í˜¸í™˜ ì •ê·œí™” ê¸°ìˆ ì„ ë‹¤ë¥´ê²Œ ì ìš©í•©ë‹ˆë‹¤. ë” ê¹Šì´ ìˆëŠ” ì´í•´ë¥¼ ì›í•˜ì‹œë©´ [Unicode.org](https://unicode.org/)ì—ì„œ ì´ëŸ¬í•œ ê¸°ìˆ ì„ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Key Points on Unicode Encoding

ìœ ë‹ˆì½”ë“œ ì¸ì½”ë”©ì„ ì´í•´í•˜ëŠ” ê²ƒì€ íŠ¹íˆ ì„œë¡œ ë‹¤ë¥¸ ì‹œìŠ¤í…œì´ë‚˜ ì–¸ì–´ ê°„ì˜ ìƒí˜¸ ìš´ìš©ì„± ë¬¸ì œë¥¼ ë‹¤ë£° ë•Œ ì¤‘ìš”í•©ë‹ˆë‹¤. ì£¼ìš” ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* **ì½”ë“œ í¬ì¸íŠ¸ì™€ ë¬¸ì**: ìœ ë‹ˆì½”ë“œì—ì„œ ê° ë¬¸ì ë˜ëŠ” ê¸°í˜¸ëŠ” "ì½”ë“œ í¬ì¸íŠ¸"ë¼ê³  í•˜ëŠ” ìˆ«ì ê°’ì´ í• ë‹¹ë©ë‹ˆë‹¤.
* **ë°”ì´íŠ¸ í‘œí˜„**: ì½”ë“œ í¬ì¸íŠ¸(ë˜ëŠ” ë¬¸ì)ëŠ” ë©”ëª¨ë¦¬ì—ì„œ í•˜ë‚˜ ì´ìƒì˜ ë°”ì´íŠ¸ë¡œ í‘œí˜„ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, LATIN-1 ë¬¸ìëŠ”(ì˜ì–´ ì‚¬ìš© êµ­ê°€ì—ì„œ ì¼ë°˜ì ) í•˜ë‚˜ì˜ ë°”ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í‘œí˜„ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë” ë§ì€ ë¬¸ì ì§‘í•©ì„ ê°€ì§„ ì–¸ì–´ëŠ” í‘œí˜„ì„ ìœ„í•´ ë” ë§ì€ ë°”ì´íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.
* **ì¸ì½”ë”©**: ì´ ìš©ì–´ëŠ” ë¬¸ìê°€ ë°”ì´íŠ¸ ì‹œë¦¬ì¦ˆë¡œ ë³€í™˜ë˜ëŠ” ë°©ì‹ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. UTF-8ì€ ASCII ë¬¸ìê°€ í•˜ë‚˜ì˜ ë°”ì´íŠ¸ë¡œ í‘œí˜„ë˜ê³ , ë‹¤ë¥¸ ë¬¸ìëŠ” ìµœëŒ€ ë„¤ ê°œì˜ ë°”ì´íŠ¸ë¡œ í‘œí˜„ë˜ëŠ” ì¼ë°˜ì ì¸ ì¸ì½”ë”© í‘œì¤€ì…ë‹ˆë‹¤.
* **ë°ì´í„° ì²˜ë¦¬**: ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì€ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ì„ ë¬¸ìë¡œ ì˜¬ë°”ë¥´ê²Œ ë³€í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœ ì¸ì½”ë”©ì„ ì¸ì‹í•´ì•¼ í•©ë‹ˆë‹¤.
* **UTFì˜ ë³€í˜•**: UTF-8 ì™¸ì—ë„ ìµœì†Œ 2ë°”ì´íŠ¸(ìµœëŒ€ 4ë°”ì´íŠ¸)ë¥¼ ì‚¬ìš©í•˜ëŠ” UTF-16 ë° ëª¨ë“  ë¬¸ìì— ëŒ€í•´ 4ë°”ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” UTF-32ì™€ ê°™ì€ ë‹¤ë¥¸ ì¸ì½”ë”© í‘œì¤€ì´ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ê°œë…ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ìœ ë‹ˆì½”ë“œì˜ ë³µì¡ì„±ê³¼ ë‹¤ì–‘í•œ ì¸ì½”ë”© ë°©ë²•ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì ì¬ì ì¸ ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ì™„í™”í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

ìœ ë‹ˆì½”ë“œê°€ ë™ì¼í•œ ë¬¸ìë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë‘ ê°œì˜ ë‹¤ë¥¸ ë°”ì´íŠ¸ë¥¼ ì–´ë–»ê²Œ ì •ê·œí™”í•˜ëŠ”ì§€ì— ëŒ€í•œ ì˜ˆ:
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**ìœ ë‹ˆì½”ë“œ ë™ë“± ë¬¸ì ëª©ë¡ì€ ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) ë° [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### ë°œê²¬í•˜ê¸°

ì›¹ì•±ì—ì„œ ë°˜í™˜ë˜ëŠ” ê°’ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, **â€˜KELVIN SIGNâ€™ (U+0212A)**ì„ ë³´ë‚´ë³´ì„¸ìš”. ì´ëŠ” **"K"ë¡œ ì •ê·œí™”**ë©ë‹ˆë‹¤ (ì´ë¥¼ `%e2%84%aa`ë¡œ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤). **"K"ê°€ ë°˜í™˜ëœë‹¤ë©´**, ì–´ë–¤ ì¢…ë¥˜ì˜ **ìœ ë‹ˆì½”ë“œ ì •ê·œí™”**ê°€ ìˆ˜í–‰ë˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.

ë‹¤ë¥¸ **ì˜ˆì‹œ**: `%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83`ëŠ” **ìœ ë‹ˆì½”ë“œ** í›„ì— `Leonishan`ì…ë‹ˆë‹¤.

## **ì·¨ì•½í•œ ì˜ˆì‹œ**

### **SQL Injection í•„í„° ìš°íšŒ**

ì‚¬ìš©ì ì…ë ¥ìœ¼ë¡œ SQL ì¿¼ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ë° ë¬¸ì `'`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì›¹ í˜ì´ì§€ë¥¼ ìƒìƒí•´ ë³´ì„¸ìš”. ì´ ì›¹ì€ ë³´ì•ˆ ì¡°ì¹˜ë¡œ ì‚¬ìš©ì ì…ë ¥ì—ì„œ ë¬¸ì **`'`**ì˜ ëª¨ë“  ë°œìƒì„ **ì‚­ì œ**í•˜ì§€ë§Œ, **ê·¸ ì‚­ì œ í›„**ì™€ **ì¿¼ë¦¬ ìƒì„± ì „**ì— ì‚¬ìš©ì ì…ë ¥ì„ **ìœ ë‹ˆì½”ë“œ**ë¡œ **ì •ê·œí™”**í•©ë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´, ì•…ì˜ì ì¸ ì‚¬ìš©ìëŠ” `' (0x27)`ì— í•´ë‹¹í•˜ëŠ” ë‹¤ë¥¸ ìœ ë‹ˆì½”ë“œ ë¬¸ì `%ef%bc%87`ì„ ì‚½ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì…ë ¥ì´ ì •ê·œí™”ë˜ë©´ ë‹¨ì¼ ì¸ìš©ë¶€í˜¸ê°€ ìƒì„±ë˜ê³  **SQLInjection ì·¨ì•½ì **ì´ ë°œìƒí•©ë‹ˆë‹¤:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (702).png>)

**í¥ë¯¸ë¡œìš´ ìœ ë‹ˆì½”ë“œ ë¬¸ìë“¤**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### sqlmap í…œí”Œë¦¿

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSS (êµì°¨ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…)

ë‹¤ìŒ ë¬¸ì ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ì•±ì„ ì†ì´ê³  XSSë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

ì˜ˆë¥¼ ë“¤ì–´, ì œì•ˆëœ ì²« ë²ˆì§¸ ìœ ë‹ˆì½”ë“œ ë¬¸ìëŠ” `%e2%89%ae` ë˜ëŠ” `%u226e`ë¡œ ì „ì†¡ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### í¼ì§• ì •ê·œ í‘œí˜„ì‹

ë°±ì—”ë“œê°€ **ì •ê·œ í‘œí˜„ì‹ìœ¼ë¡œ ì‚¬ìš©ì ì…ë ¥ì„ í™•ì¸í•  ë•Œ**, **ì…ë ¥**ì´ **ì •ê·œ í‘œí˜„ì‹**ì— ëŒ€í•´ **ì •ê·œí™”**ë˜ì§€ë§Œ **ì‚¬ìš©ë˜ëŠ” ê³³**ì— ëŒ€í•´ì„œëŠ” **ì •ê·œí™”ë˜ì§€ ì•Šì„** ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Open Redirect ë˜ëŠ” SSRFì—ì„œ ì •ê·œ í‘œí˜„ì‹ì´ **ì „ì†¡ëœ URLì„ ì •ê·œí™”**í•  ìˆ˜ ìˆì§€ë§Œ, ê·¸ í›„ **ìˆëŠ” ê·¸ëŒ€ë¡œ ì ‘ê·¼**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë„êµ¬ [**recollapse**](https://github.com/0xacb/recollapse) \*\*\*\*ëŠ” ë°±ì—”ë“œë¥¼ í¼ì§•í•˜ê¸° ìœ„í•´ **ì…ë ¥ì˜ ë³€í˜•ì„ ìƒì„±**í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ë” ë§ì€ ì •ë³´ëŠ” **github**ì™€ ì´ [**ê²Œì‹œë¬¼**](https://0xacb.com/2022/11/21/recollapse/)ì„ í™•ì¸í•˜ì„¸ìš”.

## ì°¸ê³  ë¬¸í—Œ

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
