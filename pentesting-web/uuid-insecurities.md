# UUID Insecurities

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

рдпреВрдирд┐рд╡рд░реНрд╕рд▓реА рдпреВрдирд┐рдХ рдЖрдЗрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░ (UUIDs) **128-рдмрд┐рдЯ рдирдВрдмрд░ рд╣реИрдВ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред** UUIDs рдЙрди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВ рдЬрд╣рд╛рдВ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдмрд┐рдирд╛ рдХреЗрдВрджреНрд░реАрдп рд╕рдордиреНрд╡рдп рдХреЗ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпреЗ рд╡рд┐рднрд┐рдиреНрди рддрддреНрд╡реЛрдВ рдЬреИрд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдФрд░ рд╕рддреНрд░реЛрдВ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

UUIDs рдХреЛ рдЕрджреНрд╡рд┐рддреАрдп рдФрд░ **рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдХрдард┐рди** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрдиреНрд╣реЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рдВрд░рдЪрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ 32 рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рдЕрдВрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рдВрдЪ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред UUIDs рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рд╣реЛрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХрд╛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* **UUID v1** рд╕рдордп-рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк, рдШрдбрд╝реА рдЕрдиреБрдХреНрд░рдо, рдФрд░ рдиреЛрдб рдЖрдИрдбреА (MAC рдкрддрд╛) рд╢рд╛рдорд┐рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **UUID v2** v1 рдХреЗ рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрди рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ (рдЕрдзрд┐рдХрддрд░ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛)ред
* **UUID v3 рдФрд░ v5** рдирд╛рдорд╕реНрдерд╛рди рдФрд░ рдирд╛рдо рд╕реЗ рд╣реИрд╢ рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ UUID рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ v3 MD5 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ v5 SHA-1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **UUID v4** рд▓рдЧрднрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдХреА рдЧреБрдордирд╛рдореА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд╛ рдереЛрдбрд╝рд╛ рдЬреЛрдЦрд┐рдо рд╣реЛрддрд╛ рд╣реИред

{% hint style="success" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UUID рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдЙрдкрд╕рдВрд╕реНрдХрд░рдг рдЖрдорддреМрд░ рдкрд░ UUID рдХреЗ рднреАрддрд░ рдПрдХ рд╣реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **M рдХреА рд╕реНрдерд┐рддрд┐** UUID **рд╕рдВрд╕реНрдХрд░рдг** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИред рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ UUID v**1** рд╣реИред
* **N рдХреА рд╕реНрдерд┐рддрд┐** UUID рднрд┐рдиреНрдирддрд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИред
{% endhint %}

## Sandwich attack

"рд╕реИрдВрдбрд╡рд┐рдЪ рдЕрдЯреИрдХ" рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣рдорд▓рд╛ рд╣реИ рдЬреЛ **рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ UUID v1 рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИ**, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЬреИрд╕реА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВред UUID v1 рд╕рдордп, рдШрдбрд╝реА рдЕрдиреБрдХреНрд░рдо, рдФрд░ рдиреЛрдб рдХреЗ MAC рдкрддреЗ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдХреБрдЫ рд╣рдж рддрдХ рдЕрдиреБрдорд╛рдирд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрди UUIDs рдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕рдордп рдХреЗ рдХрд░реАрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВред

### Example

рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдПрдХ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ UUID v1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХреЛ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рднреБрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

1. **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрдЯрдЕрдк**:

* рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рджреЛ рдИрдореЗрд▓ рдЦрд╛рддреЛрдВ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд╣реИ: \`attacker1@acme.com\` рдФрд░ \`attacker2@acme.com\`ред
* рд▓рдХреНрд╖реНрдп рдХрд╛ рдИрдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ \`victim@acme.com\`ред

2. **рдХрд╛рд░реНрдпрд╡рд╛рд╣реА**:

* рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдкрд╣рд▓реЗ рдЦрд╛рддреЗ (\`attacker1@acme.com\`) рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ UUID рдХреЗ рд╕рд╛рде рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдорд╛рди рд▓реАрдЬрд┐рдП \`99874128-7592-11e9-8201-bb2f15014a14\`ред
* рддреБрд░рдВрдд рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рд▓рдХреНрд╖реНрдп рдХреЗ рдЦрд╛рддреЗ (\`victim@acme.com\`) рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЬрд▓реНрджреА рд╕реЗ рджреВрд╕рд░реЗ рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рд┐рдд рдЦрд╛рддреЗ (\`attacker2@acme.com\`) рдХреЗ рд▓рд┐рдПред
* рд╣рдорд▓рд╛рд╡рд░ рджреВрд╕рд░реЗ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ UUID рдХреЗ рд╕рд╛рде рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдорд╛рди рд▓реАрдЬрд┐рдП \`998796b4-7592-11e9-8201-bb2f15014a14\`ред

3. **рд╡рд┐рд╢реНрд▓реЗрд╖рдг**:

* рдЕрдм рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рд╕рдордп рдХреЗ рдХрд░реАрдм рдЙрддреНрдкрдиреНрди рджреЛ UUIDs рд╣реИрдВ (\`99874128\` рдФрд░ \`998796b4\`)ред рд╕рдордп-рдЖрдзрд╛рд░рд┐рдд UUIDs рдХреА рдЕрдиреБрдХреНрд░рдорд┐рдХ рдкреНрд░рдХреГрддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рд▓рдХреНрд╖реНрдп рдХреЗ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП UUID рд╕рдВрднрд╡рддрдГ рдЗрди рджреЛ рдорд╛рдиреЛрдВ рдХреЗ рдмреАрдЪ рд╣реЛрдЧрд╛ред

4. **рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдЕрдЯреИрдХ:**

* рд╣рдорд▓рд╛рд╡рд░ рдЗрди рджреЛ рдорд╛рдиреЛрдВ рдХреЗ рдмреАрдЪ UUID рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЙрддреНрдкрдиреНрди UUID рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддрд╛ рд╣реИ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдХреЗ (рдЬреИрд╕реЗ, \`https://www.acme.com/reset/\<generated-UUID>\`)ред
* рдпрджрд┐ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдЪрд┐рдд рджрд░ рд╕реАрдорд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдРрд╕реЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЬрд▓реНрджреА рд╕реЗ рд╕реАрдорд╛ рдореЗрдВ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд UUIDs рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред

5. **рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХреА:**

* рдПрдХ рдмрд╛рд░ рдЬрдм рд▓рдХреНрд╖реНрдп рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рдХреЗ рд▓рд┐рдП рд╕рд╣реА UUID рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рд▓рдХреНрд╖реНрдп рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдирдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Tools

* рдЖрдк рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реИрдВрдбрд╡рд┐рдЪ рдЕрдЯреИрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* рдЖрдк Burp Suite рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248) рдХреЗ рд╕рд╛рде рдЗрди рдкреНрд░рдХрд╛рд░ рдХреЗ UUIDs рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
