# Inseguridades de UUID

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}

## Informaci칩n B치sica

Los Identificadores 칔nicos Universales (UUID) son **n칰meros de 128 bits utilizados para identificar de manera 칰nica informaci칩n** en sistemas inform치ticos. Los UUID son esenciales en aplicaciones donde se necesitan identificadores 칰nicos sin coordinaci칩n central. Se utilizan com칰nmente como claves de base de datos y pueden referirse a varios elementos como documentos y sesiones.

Los UUID est치n dise침ados para ser 칰nicos y **dif칤ciles de adivinar**. Est치n estructurados en un formato espec칤fico, divididos en cinco grupos representados como 32 d칤gitos hexadecimales. Hay diferentes versiones de UUID, cada una con diferentes prop칩sitos:

* **UUID v1** es basado en el tiempo, incorporando la marca de tiempo, la secuencia de reloj y el ID del nodo (direcci칩n MAC), pero puede potencialmente exponer informaci칩n del sistema.
* **UUID v2** es similar a v1 pero incluye modificaciones para dominios locales (no se usa com칰nmente).
* **UUID v3 y v5** generan UUID utilizando valores hash de espacio de nombres y nombre, con v3 usando MD5 y v5 usando SHA-1.
* **UUID v4** se genera casi completamente de manera aleatoria, proporcionando un alto nivel de anonimato pero con un ligero riesgo de duplicados.

{% hint style="success" %}
Ten en cuenta que la versi칩n y subversi칩n del UUID generalmente aparece en la misma posici칩n dentro del UUID. Por ejemplo en:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* La **posici칩n de la M** indica la **versi칩n** del UUID. En el ejemplo anterior, es UUID v**1**.
* La **posici칩n de la N** indica la variante del UUID.
{% endhint %}

## Ataque Sandwich

El "Ataque Sandwich" es un tipo espec칤fico de ataque que **exploita la predictibilidad de la generaci칩n de UUID v1 en aplicaciones web**, particularmente en caracter칤sticas como restablecimientos de contrase침a. El UUID v1 se genera en funci칩n del tiempo, la secuencia de reloj y la direcci칩n MAC del nodo, lo que puede hacerlo algo predecible si un atacante puede obtener algunos de estos UUID generados cerca en el tiempo.

### Ejemplo

Imagina una aplicaci칩n web que utiliza UUID v1 para generar enlaces de restablecimiento de contrase침a. As칤 es como un atacante podr칤a explotar esto para obtener acceso no autorizado:

1. **Configuraci칩n Inicial**:

* El atacante tiene control sobre dos cuentas de correo electr칩nico: \`attacker1@acme.com\` y \`attacker2@acme.com\`.
* La cuenta de correo electr칩nico del objetivo es \`victim@acme.com\`.

2. **Ejecuci칩n**:

* El atacante inicia un restablecimiento de contrase침a para su primera cuenta (\`attacker1@acme.com\`) y recibe un enlace de restablecimiento de contrase침a con un UUID, digamos \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Inmediatamente despu칠s, el atacante inicia un restablecimiento de contrase침a para la cuenta de la v칤ctima (\`victim@acme.com\`) y luego r치pidamente para la segunda cuenta controlada por el atacante (\`attacker2@acme.com\`).
* El atacante recibe un enlace de restablecimiento para la segunda cuenta con un UUID, digamos \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **An치lisis**:

* El atacante ahora tiene dos UUID generados cerca en el tiempo (\`99874128\` y \`998796b4\`). Dada la naturaleza secuencial de los UUID basados en el tiempo, es probable que el UUID para la cuenta de la v칤ctima caiga entre estos dos valores.

4. **Ataque de Fuerza Bruta:**

* El atacante utiliza una herramienta para generar UUID entre estos dos valores y prueba cada UUID generado intentando acceder al enlace de restablecimiento de contrase침a (por ejemplo, \`https://www.acme.com/reset/\<generated-UUID>\`).
* Si la aplicaci칩n web no limita adecuadamente la tasa o bloquea tales intentos, el atacante puede probar r치pidamente todos los UUID posibles en el rango.

5. **Acceso Obtenido:**

* Una vez que se descubre el UUID correcto para el enlace de restablecimiento de contrase침a de la v칤ctima, el atacante puede restablecer la contrase침a de la v칤ctima y obtener acceso no autorizado a su cuenta.

### Herramientas

* Puedes realizar el ataque sandwich autom치ticamente con la herramienta: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Puedes detectar este tipo de UUID en Burp Suite con la extensi칩n [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Referencias

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}
