# UUID Insecurities

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Univerzalno jedinstveni identifikatori (UUID) su **128-bitni brojevi koji se koriste za jedinstveno identifikovanje informacija** u ra캜unarstvu. UUID-ovi su neophodni u aplikacijama gde su jedinstveni identifikatori potrebni bez centralne koordinacije. 캛esto se koriste kao klju캜evi u bazama podataka i mogu se odnositi na razli캜ite elemente poput dokumenata i sesija.

UUID-ovi su dizajnirani da budu jedinstveni i **te코ki za poga캠anje**. Struktuirani su u specifi캜nom formatu, podeljeni u pet grupa koje su predstavljene kao 32 heksadecimalne cifre. Postoje razli캜ite verzije UUID-ova, od kojih svaka ima razli캜ite svrhe:

* **UUID v1** je vremenski zasnovan, uklju캜uje vremensku oznaku, sekvencu sata i ID 캜vora (MAC adresa), ali mo쬰 potencijalno otkriti informacije o sistemu.
* **UUID v2** je sli캜an v1, ali uklju캜uje modifikacije za lokalne domene (nije 코iroko kori코캖en).
* **UUID v3 i v5** generi코u UUID-ove koriste캖i he코 vrednosti iz imenskog prostora i imena, pri 캜emu v3 koristi MD5, a v5 koristi SHA-1.
* **UUID v4** se generi코e gotovo potpuno nasumi캜no, pru쬬ju캖i visok nivo anonimnosti, ali sa malim rizikom od duplikata.

{% hint style="success" %}
Napomena da verzija i podverzija UUID obi캜no se pojavljuju na istom mestu unutar UUID-a. Na primer u:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **Pozicija M** ozna캜ava UUID **verziju**. U gornjem primeru, to je UUID v**1**.
* **Pozicija N** ozna캜ava UUID varijantu.
{% endhint %}

## Sandwich attack

"Sandwich Attack" je specifi캜na vrsta napada koja **iskori코캖ava predvidljivost generisanja UUID v1 u web aplikacijama**, posebno u funkcijama poput resetovanja lozinki. UUID v1 se generi코e na osnovu vremena, sekvence sata i MAC adrese 캜vora, 코to mo쬰 u캜initi da bude donekle predvidljiv ako napada캜 mo쬰 dobiti neke od ovih UUID-ova generisanih blizu u vremenu.

### Example

Zamislite web aplikaciju koja koristi UUID v1 za generisanje linkova za resetovanje lozinki. Evo kako bi napada캜 mogao iskoristiti ovo da dobije neovla코캖en pristup:

1. **Po캜etna postavka**:

* Napada캜 ima kontrolu nad dva email naloga: \`attacker1@acme.com\` i \`attacker2@acme.com\`.
* Ciljani email nalog je \`victim@acme.com\`.

2. **Izvr코enje**:

* Napada캜 pokre캖e resetovanje lozinke za svoj prvi nalog (\`attacker1@acme.com\`) i prima link za resetovanje lozinke sa UUID-om, recimo \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Odmah nakon toga, napada캜 pokre캖e resetovanje lozinke za nalog rtve (\`victim@acme.com\`) i zatim brzo za drugi nalog pod kontrolom napada캜a (\`attacker2@acme.com\`).
* Napada캜 prima link za resetovanje za drugi nalog sa UUID-om, recimo \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analiza**:

* Napada캜 sada ima dva UUID-a generisana blizu u vremenu (\`99874128\` i \`998796b4\`). S obzirom na sekvencijalnu prirodu UUID-ova zasnovanih na vremenu, UUID za nalog rtve 캖e verovatno pasti izme캠u ove dve vrednosti.

4. **Brute Force Attack:**

* Napada캜 koristi alat za generisanje UUID-ova izme캠u ove dve vrednosti i testira svaki generisani UUID poku코avaju캖i da pristupi linku za resetovanje lozinke (npr. \`https://www.acme.com/reset/\<generated-UUID>\`).
* Ako web aplikacija ne ograni캜ava adekvatno brzinu ili ne blokira takve poku코aje, napada캜 mo쬰 brzo testirati sve mogu캖e UUID-ove u opsegu.

5. **Pristup dobijen:**

* Kada se otkrije ta캜an UUID za link za resetovanje lozinke rtve, napada캜 mo쬰 resetovati lozinku rtve i dobiti neovla코캖en pristup njihovom nalogu.

### Tools

* Mo쬰te automatski izvr코iti sandwich attack pomo캖u alata: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Mo쬰te otkriti ove vrste UUID-ova u Burp Suite-u sa ekstenzijom [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
