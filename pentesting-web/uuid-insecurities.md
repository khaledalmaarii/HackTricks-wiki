# Bezbednosne ranjivosti UUID-a

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks suvenir**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

Univerzalno jedinstveni identifikatori (UUID) su **128-bitni brojevi koji se koriste za jedinstveno identifikovanje informacija** u ra캜unarskim sistemima. UUID-ovi su esencijalni u aplikacijama gde su potrebni jedinstveni identifikatori bez centralne koordinacije. 캛esto se koriste kao klju캜evi baza podataka i mogu se odnositi na razli캜ite elemente poput dokumenata i sesija.

UUID-ovi su dizajnirani da budu jedinstveni i **te코ki za pogoditi**. Strukturirani su u odre캠enom formatu, podeljeni u pet grupa predstavljenih kao 32 heksadecimalne cifre. Postoje razli캜ite verzije UUID-ova, pri 캜emu svaka slu쬴 razli캜itim svrhama:

* **UUID v1** je zasnovan na vremenu, uklju캜uju캖i vremenski pe캜at, sekvenca sata i ID 캜vora (MAC adresa), ali mo쬰 potencijalno otkriti informacije o sistemu.
* **UUID v2** je sli캜an v1 ali uklju캜uje modifikacije za lokalne domene (retko kori코캖en).
* **UUID v3 i v5** generi코u UUID-ove koriste캖i vrednosti he코a iz prostora imena i imena, pri 캜emu v3 koristi MD5 a v5 koristi SHA-1.
* **UUID v4** se generi코e gotovo potpuno nasumi캜no, pru쬬ju캖i visok nivo anonimnosti ali sa blagim rizikom duplikata.

{% hint style="success" %}
Imajte na umu da verzija i podverzija UUID-a obi캜no se pojavljuju na istom mestu unutar UUID-a. Na primer u:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **Pozicija M** ozna캜ava UUID **verziju**. U gore navedenom primeru, to je UUID v**1**.
* **Pozicija N** ozna캜ava UUID varijantu.
{% endhint %}

## Napad sendvi캜

"Napad sendvi캜" je specifi캜an tip napada koji **iskori코캖ava predvidljivost generisanja UUID v1 u veb aplikacijama**, posebno u funkcijama poput resetovanja lozinke. UUID v1 se generi코e na osnovu vremena, sekvenca sata i MAC adrese 캜vora, 코to mo쬰 u캜initi da bude donekle predvidljiv ako napada캜 mo쬰 da dobije neke od ovih UUID-ova generisanih u blizini vremena.

### Primer

Zamislite veb aplikaciju koja koristi UUID v1 za generisanje linkova za resetovanje lozinke. Evo kako napada캜 mo쬰 iskoristiti ovo da dobije neovla코캖en pristup:

1. **Po캜etno pode코avanje**:

* Napada캜 ima kontrolu nad dva email naloga: \`napadac1@acme.com\` i \`napadac2@acme.com\`.
* Email nalog mete je \`zrtva@acme.com\`.

2. **Izvr코enje**:

* Napada캜 pokre캖e resetovanje lozinke za svoj prvi nalog (\`napadac1@acme.com\`) i dobija link za resetovanje lozinke sa UUID-om, recimo \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Neposredno nakon toga, napada캜 pokre캖e resetovanje lozinke za nalog rtve (\`zrtva@acme.com\`) a zatim brzo za drugi nalog pod kontrolom napada캜a (\`napadac2@acme.com\`).
* Napada캜 dobija link za resetovanje za drugi nalog sa UUID-om, recimo \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analiza**:

* Napada캜 sada ima dva UUID-a generisana u blizini vremena (\`99874128\` i \`998796b4\`). S obzirom na sekvencijalnu prirodu vremenskih UUID-ova, UUID za nalog rtve 캖e verovatno pasti izme캠u ova dva broja.

4. **Napad Brute Force:**

* Napada캜 koristi alat za generisanje UUID-ova izme캠u ova dva broja i testira svaki generisani UUID poku코avaju캖i da pristupi linku za resetovanje lozinke (npr. \`https://www.acme.com/reset/\<generisani-UUID>\`).
* Ako veb aplikacija ne adekvatno ograni캜ava brzinu ili blokira takve poku코aje, napada캜 mo쬰 brzo testirati sve mogu캖e UUID-ove u opsegu.

5. **Pristup Dobijen:**

* Kada se otkrije ta캜an UUID za link za resetovanje lozinke rtve, napada캜 mo쬰 resetovati lozinku rtve i dobiti neovla코캖en pristup njenom nalogu.

### Alati

* Mo쬰te automatski izvr코iti napad sendvi캜 pomo캖u alata: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Mo쬰te otkriti ovaj tip UUID-ova u Burp Suite-u sa ekstenzijom [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Reference

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
