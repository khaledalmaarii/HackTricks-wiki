# UUID Insecurities

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Basic Information

Identificadores Universais √önicos (UUIDs) s√£o **n√∫meros de 128 bits usados para identificar informa√ß√µes de forma √∫nica** em sistemas computacionais. UUIDs s√£o essenciais em aplica√ß√µes onde identificadores √∫nicos s√£o necess√°rios sem coordena√ß√£o central. Eles s√£o comumente usados como chaves de banco de dados e podem se referir a v√°rios elementos, como documentos e sess√µes.

UUIDs s√£o projetados para serem √∫nicos e **dif√≠ceis de adivinhar**. Eles s√£o estruturados em um formato espec√≠fico, divididos em cinco grupos representados como 32 d√≠gitos hexadecimais. Existem diferentes vers√µes de UUIDs, cada uma servindo a diferentes prop√≥sitos:

* **UUID v1** √© baseado em tempo, incorporando o timestamp, sequ√™ncia de rel√≥gio e ID do n√≥ (endere√ßo MAC), mas pode potencialmente expor informa√ß√µes do sistema.
* **UUID v2** √© semelhante ao v1, mas inclui modifica√ß√µes para dom√≠nios locais (n√£o amplamente utilizado).
* **UUID v3 e v5** geram UUIDs usando valores de hash de namespace e nome, com v3 usando MD5 e v5 usando SHA-1.
* **UUID v4** √© gerado quase que totalmente de forma aleat√≥ria, proporcionando um alto n√≠vel de anonimato, mas com um leve risco de duplicatas.

{% hint style="success" %}
Observe que a vers√£o e subvers√£o do UUID geralmente aparecem na mesma posi√ß√£o dentro do UUID. Por exemplo em:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* A **posi√ß√£o do M** indica a **vers√£o** do UUID. No exemplo acima, √© UUID v**1**.
* A **posi√ß√£o do N** indica a variante do UUID.
{% endhint %}

## Sandwich attack

O "Sandwich Attack" √© um tipo espec√≠fico de ataque que **explora a previsibilidade da gera√ß√£o de UUID v1 em aplica√ß√µes web**, particularmente em recursos como redefini√ß√µes de senha. UUID v1 √© gerado com base no tempo, sequ√™ncia de rel√≥gio e no endere√ßo MAC do n√≥, o que pode torn√°-lo um tanto previs√≠vel se um atacante conseguir obter alguns desses UUIDs gerados pr√≥ximos no tempo.

### Example

Imagine uma aplica√ß√£o web que usa UUID v1 para gerar links de redefini√ß√£o de senha. Aqui est√° como um atacante pode explorar isso para obter acesso n√£o autorizado:

1. **Configura√ß√£o Inicial**:

* O atacante controla duas contas de email: \`attacker1@acme.com\` e \`attacker2@acme.com\`.
* A conta de email do alvo √© \`victim@acme.com\`.

2. **Execu√ß√£o**:

* O atacante aciona uma redefini√ß√£o de senha para sua primeira conta (\`attacker1@acme.com\`) e recebe um link de redefini√ß√£o de senha com um UUID, digamos \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Imediatamente depois, o atacante aciona uma redefini√ß√£o de senha para a conta da v√≠tima (\`victim@acme.com\`) e ent√£o rapidamente para a segunda conta controlada pelo atacante (\`attacker2@acme.com\`).
* O atacante recebe um link de redefini√ß√£o para a segunda conta com um UUID, digamos \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **An√°lise**:

* O atacante agora tem dois UUIDs gerados pr√≥ximos no tempo (\`99874128\` e \`998796b4\`). Dada a natureza sequencial dos UUIDs baseados em tempo, o UUID para a conta da v√≠tima provavelmente estar√° entre esses dois valores.

4. **Ataque de For√ßa Bruta:**

* O atacante usa uma ferramenta para gerar UUIDs entre esses dois valores e testa cada UUID gerado tentando acessar o link de redefini√ß√£o de senha (por exemplo, \`https://www.acme.com/reset/\<generated-UUID>\`).
* Se a aplica√ß√£o web n√£o limitar adequadamente a taxa ou bloquear tais tentativas, o atacante pode rapidamente testar todos os UUIDs poss√≠veis na faixa.

5. **Acesso Obtido:**

* Uma vez que o UUID correto para o link de redefini√ß√£o de senha da v√≠tima √© descoberto, o atacante pode redefinir a senha da v√≠tima e obter acesso n√£o autorizado √† sua conta.

### Tools

* Voc√™ pode realizar o ataque de sandu√≠che automaticamente com a ferramenta: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Voc√™ pode detectar esses tipos de UUIDs no Burp Suite com a extens√£o [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
