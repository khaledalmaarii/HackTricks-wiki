# UUID-Sicherheitsanf√§lligkeiten

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## Grundinformationen

Universell eindeutige Identifikatoren (UUIDs) sind **128-Bit-Zahlen, die verwendet werden, um Informationen in Computersystemen eindeutig zu identifizieren**. UUIDs sind in Anwendungen, in denen eindeutige Identifikatoren ohne zentrale Koordination erforderlich sind, unerl√§sslich. Sie werden h√§ufig als Datenbankschl√ºssel verwendet und k√∂nnen sich auf verschiedene Elemente wie Dokumente und Sitzungen beziehen.

UUIDs sind so konzipiert, dass sie einzigartig und **schwer zu erraten** sind. Sie sind in einem bestimmten Format strukturiert, das in f√ºnf Gruppen unterteilt ist, die als 32 hexadezimale Ziffern dargestellt werden. Es gibt verschiedene Versionen von UUIDs, die jeweils unterschiedliche Zwecke erf√ºllen:

* **UUID v1** ist zeitbasiert und umfasst den Zeitstempel, die Uhrsequenz und die Knoten-ID (MAC-Adresse), kann jedoch potenziell Systeminformationen offenbaren.
* **UUID v2** ist √§hnlich wie v1, enth√§lt jedoch Modifikationen f√ºr lokale Dom√§nen (nicht weit verbreitet).
* **UUID v3 und v5** generieren UUIDs unter Verwendung von Hashwerten aus Namespace und Name, wobei v3 MD5 und v5 SHA-1 verwendet.
* **UUID v4** wird fast vollst√§ndig zuf√§llig generiert und bietet ein hohes Ma√ü an Anonymit√§t, birgt jedoch ein geringes Risiko von Duplikaten.

{% hint style="success" %}
Beachte, dass die Version und Unterversion der UUID normalerweise an derselben Stelle innerhalb der UUID erscheint. Zum Beispiel in:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* Die **Position des M** zeigt die UUID **Version** an. Im obigen Beispiel ist es UUID v**1**.
* Die **Position des N** zeigt die UUID-Variante an.
{% endhint %}

## Sandwich-Angriff

Der "Sandwich-Angriff" ist eine spezifische Art von Angriff, die **die Vorhersehbarkeit der UUID v1-Generierung in Webanwendungen ausnutzt**, insbesondere bei Funktionen wie Passwortzur√ºcksetzungen. UUID v1 wird basierend auf Zeit, Uhrsequenz und der MAC-Adresse des Knotens generiert, was es etwas vorhersehbar macht, wenn ein Angreifer einige dieser in kurzer Zeit generierten UUIDs erhalten kann.

### Beispiel

Stell dir eine Webanwendung vor, die UUID v1 zur Generierung von Links f√ºr Passwortzur√ºcksetzungen verwendet. So k√∂nnte ein Angreifer dies ausnutzen, um unbefugten Zugriff zu erlangen:

1. **Erste Einrichtung**:

* Der Angreifer hat Kontrolle √ºber zwei E-Mail-Konten: \`attacker1@acme.com\` und \`attacker2@acme.com\`.
* Das E-Mail-Konto des Ziels ist \`victim@acme.com\`.

2. **Ausf√ºhrung**:

* Der Angreifer l√∂st eine Passwortzur√ºcksetzung f√ºr sein erstes Konto (\`attacker1@acme.com\`) aus und erh√§lt einen Link zur Passwortzur√ºcksetzung mit einer UUID, sagen wir \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Unmittelbar danach l√∂st der Angreifer eine Passwortzur√ºcksetzung f√ºr das Konto des Opfers (\`victim@acme.com\`) und dann schnell f√ºr das zweite, vom Angreifer kontrollierte Konto (\`attacker2@acme.com\`) aus.
* Der Angreifer erh√§lt einen Zur√ºcksetzlink f√ºr das zweite Konto mit einer UUID, sagen wir \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analyse**:

* Der Angreifer hat nun zwei UUIDs, die in kurzer Zeit generiert wurden (\`99874128\` und \`998796b4\`). Angesichts der sequenziellen Natur zeitbasierter UUIDs wird die UUID f√ºr das Konto des Opfers wahrscheinlich zwischen diesen beiden Werten liegen.

4. **Brute-Force-Angriff:**

* Der Angreifer verwendet ein Tool, um UUIDs zwischen diesen beiden Werten zu generieren und testet jede generierte UUID, indem er versucht, auf den Link zur Passwortzur√ºcksetzung zuzugreifen (z. B. \`https://www.acme.com/reset/\<generated-UUID>\`).
* Wenn die Webanwendung solche Versuche nicht angemessen drosselt oder blockiert, kann der Angreifer schnell alle m√∂glichen UUIDs im Bereich testen.

5. **Zugriff erlangt:**

* Sobald die korrekte UUID f√ºr den Zur√ºcksetzlink des Opfers entdeckt wird, kann der Angreifer das Passwort des Opfers zur√ºcksetzen und unbefugten Zugriff auf dessen Konto erlangen.

### Werkzeuge

* Du kannst den Sandwich-Angriff automatisch mit dem Tool: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich) durchf√ºhren.
* Du kannst diese Art von UUIDs in Burp Suite mit der Erweiterung [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248) erkennen.

## Referenzen

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
