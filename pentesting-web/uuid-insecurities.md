# UUID Insecurities

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Uniwersalne Identyfikatory Unikalne (UUID) to **128-bitowe liczby u偶ywane do unikalnej identyfikacji informacji** w systemach komputerowych. UUID s niezbdne w aplikacjach, gdzie unikalne identyfikatory s konieczne bez centralnej koordynacji. S powszechnie u偶ywane jako klucze w bazach danych i mog odnosi si do r贸偶nych element贸w, takich jak dokumenty i sesje.

UUID s zaprojektowane tak, aby byy unikalne i **trudne do odgadnicia**. S strukturalnie zorganizowane w okrelonym formacie, podzielone na pi grup reprezentowanych jako 32 cyfry szesnastkowe. Istniej r贸偶ne wersje UUID, z kt贸rych ka偶da su偶y innym celom:

* **UUID v1** jest oparty na czasie, zawiera znacznik czasu, sekwencj zegara i identyfikator wza (adres MAC), ale mo偶e potencjalnie ujawnia informacje o systemie.
* **UUID v2** jest podobny do v1, ale zawiera modyfikacje dla lokalnych domen (nie jest powszechnie u偶ywany).
* **UUID v3 i v5** generuj UUID przy u偶yciu wartoci skr贸tu z przestrzeni nazw i nazwy, przy czym v3 u偶ywa MD5, a v5 u偶ywa SHA-1.
* **UUID v4** jest generowany prawie cakowicie losowo, zapewniajc wysoki poziom anonimowoci, ale z niewielkim ryzykiem duplikat贸w.

{% hint style="success" %}
Zauwa偶, 偶e wersja i subwersja UUID zazwyczaj pojawiaj si w tym samym miejscu w UUID. Na przykad w:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **Pozycja M** wskazuje na **wersj** UUID. W powy偶szym przykadzie to UUID v**1**.
* **Pozycja N** wskazuje na wariant UUID.
{% endhint %}

## Sandwich attack

Atak "Sandwich" to specyficzny rodzaj ataku, kt贸ry **wykorzystuje przewidywalno generowania UUID v1 w aplikacjach internetowych**, szczeg贸lnie w funkcjach takich jak resetowanie hasa. UUID v1 jest generowany na podstawie czasu, sekwencji zegara i adresu MAC wza, co mo偶e sprawi, 偶e bdzie on w pewnym stopniu przewidywalny, jeli atakujcy uzyska niekt贸re z tych UUID wygenerowanych blisko w czasie.

### Example

Wyobra藕 sobie aplikacj internetow, kt贸ra u偶ywa UUID v1 do generowania link贸w do resetowania hasa. Oto jak atakujcy mo偶e to wykorzysta, aby uzyska nieautoryzowany dostp:

1. **Pocztkowa konfiguracja**:

* Atakujcy ma kontrol nad dwoma kontami e-mail: \`attacker1@acme.com\` i \`attacker2@acme.com\`.
* Konto e-mail ofiary to \`victim@acme.com\`.

2. **Wykonanie**:

* Atakujcy inicjuje reset hasa dla swojego pierwszego konta (\`attacker1@acme.com\`) i otrzymuje link do resetowania hasa z UUID, powiedzmy \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Natychmiast po tym atakujcy inicjuje reset hasa dla konta ofiary (\`victim@acme.com\`) a nastpnie szybko dla drugiego konta kontrolowanego przez atakujcego (\`attacker2@acme.com\`).
* Atakujcy otrzymuje link do resetowania dla drugiego konta z UUID, powiedzmy \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analiza**:

* Atakujcy ma teraz dwa UUID wygenerowane blisko w czasie (\`99874128\` i \`998796b4\`). Biorc pod uwag sekwencyjny charakter UUID opartych na czasie, UUID dla konta ofiary prawdopodobnie bdzie mieci si pomidzy tymi dwoma wartociami.

4. **Atak Brute Force**:

* Atakujcy u偶ywa narzdzia do generowania UUID pomidzy tymi dwoma wartociami i testuje ka偶dy wygenerowany UUID, pr贸bujc uzyska dostp do linku do resetowania hasa (np. \`https://www.acme.com/reset/\<generated-UUID>\`).
* Jeli aplikacja internetowa nie ogranicza odpowiednio liczby pr贸b lub nie blokuje takich pr贸b, atakujcy mo偶e szybko przetestowa wszystkie mo偶liwe UUID w tym zakresie.

5. **Uzyskany dostp**:

* Gdy poprawny UUID dla linku do resetowania hasa ofiary zostanie odkryty, atakujcy mo偶e zresetowa haso ofiary i uzyska nieautoryzowany dostp do jej konta.

### Tools

* Mo偶esz przeprowadzi atak sandwich automatycznie za pomoc narzdzia: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Mo偶esz wykrywa te typy UUID w Burp Suite za pomoc rozszerzenia [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
