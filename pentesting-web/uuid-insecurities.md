# UUID Insecurities

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ (UUID) ‚Äî —Ü–µ **128-–±—ñ—Ç–Ω—ñ —á–∏—Å–ª–∞, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è —É–Ω—ñ–∫–∞–ª—å–Ω–æ—ó —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó** –≤ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. UUID —î –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–º–∏ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, –¥–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –±–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó. –í–æ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —è–∫ –∫–ª—é—á—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —ñ –º–æ–∂—É—Ç—å –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ —Ä—ñ–∑–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–∞ —Å–µ—Å—ñ—ó.

UUID —Ä–æ–∑—Ä–æ–±–ª–µ–Ω—ñ —Ç–∞–∫, —â–æ–± –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ —Ç–∞ **–≤–∞–∂–∫–∏–º–∏ –¥–ª—è –≤–≥–∞–¥—É–≤–∞–Ω–Ω—è**. –í–æ–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ —É —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ, –ø–æ–¥—ñ–ª–µ–Ω–æ–º—É –Ω–∞ –ø'—è—Ç—å –≥—Ä—É–ø, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö —è–∫ 32 —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤—ñ —Ü–∏—Ñ—Ä–∏. –Ü—Å–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –≤–µ—Ä—Å—ñ—ó UUID, –∫–æ–∂–Ω–∞ –∑ —è–∫–∏—Ö –º–∞—î —Ä—ñ–∑–Ω—ñ —Ü—ñ–ª—ñ:

* **UUID v1** –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —á–∞—Å—ñ, –≤–∫–ª—é—á–∞—é—á–∏ –º—ñ—Ç–∫—É —á–∞—Å—É, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≥–æ–¥–∏–Ω–Ω–∏–∫–∞ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –≤—É–∑–ª–∞ (MAC-–∞–¥—Ä–µ—Å—É), –∞–ª–µ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —Ä–æ–∑–∫—Ä–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–∏—Å—Ç–µ–º—É.
* **UUID v2** –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ v1, –∞–ª–µ –≤–∫–ª—é—á–∞—î –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö –¥–æ–º–µ–Ω—ñ–≤ (–Ω–µ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è).
* **UUID v3 —Ç–∞ v5** –≥–µ–Ω–µ—Ä—É—é—Ç—å UUID, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–Ω—è –∑ –ø—Ä–æ—Å—Ç–æ—Ä—É —ñ–º–µ–Ω—ñ —Ç–∞ —ñ–º–µ–Ω—ñ, –ø—Ä–∏ —Ü—å–æ–º—É v3 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î MD5, –∞ v5 ‚Äî SHA-1.
* **UUID v4** –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –º–∞–π–∂–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ø–∞–¥–∫–æ–≤–∏–º —á–∏–Ω–æ–º, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å –∞–Ω–æ–Ω—ñ–º–Ω–æ—Å—Ç—ñ, –∞–ª–µ –∑ –Ω–µ–≤–µ–ª–∏–∫–∏–º —Ä–∏–∑–∏–∫–æ–º –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤.

{% hint style="success" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–µ—Ä—Å—ñ—è —Ç–∞ –ø—ñ–¥–≤–µ—Ä—Å—ñ—è UUID –∑–∞–∑–≤–∏—á–∞–π –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –π —Ç–æ–º—É –∂ –º—ñ—Å—Ü—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ UUID. –ù–∞–ø—Ä–∏–∫–ª–∞–¥ —É:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **–ü–æ–∑–∏—Ü—ñ—è M** –≤–∫–∞–∑—É—î –Ω–∞ **–≤–µ—Ä—Å—ñ—é** UUID. –£ –Ω–∞–≤–µ–¥–µ–Ω–æ–º—É –≤–∏—â–µ –ø—Ä–∏–∫–ª–∞–¥—ñ —Ü–µ UUID v**1**.
* **–ü–æ–∑–∏—Ü—ñ—è N** –≤–∫–∞–∑—É—î –Ω–∞ –≤–∞—Ä—ñ–∞–Ω—Ç UUID.
{% endhint %}

## Sandwich attack

"–°–µ–Ω–¥–≤—ñ—á-–∞—Ç–∞–∫–∞" ‚Äî —Ü–µ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π —Ç–∏–ø –∞—Ç–∞–∫–∏, —è–∫–∏–π **–µ–∫—Å–ø–ª—É–∞—Ç—É—î –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó UUID v1 —É –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö**, –æ—Å–æ–±–ª–∏–≤–æ –≤ —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü—ñ—è—Ö, —è–∫ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤. UUID v1 –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—É, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –≥–æ–¥–∏–Ω–Ω–∏–∫–∞ —Ç–∞ MAC-–∞–¥—Ä–µ—Å–∏ –≤—É–∑–ª–∞, —â–æ –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –¥–µ—â–æ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–º, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—è–∫—ñ –∑ —Ü–∏—Ö UUID, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö –±–ª–∏–∑—å–∫–æ –∑–∞ —á–∞—Å–æ–º.

### Example

–£—è–≤—ñ—Ç—å –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î UUID v1 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–æ—Å–∏–ª–∞–Ω—å –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤. –û—Å—å —è–∫ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü–µ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É:

1. **–ü–æ—á–∞—Ç–∫–æ–≤–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**:

* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –¥–≤–∞ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏: \`attacker1@acme.com\` —Ç–∞ \`attacker2@acme.com\`.
* –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –∂–µ—Ä—Ç–≤–∏ ‚Äî \`victim@acme.com\`.

2. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è**:

* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ —ñ–Ω—ñ—Ü—ñ—é—î —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è —Å–≤–æ–≥–æ –ø–µ—Ä—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É (\`attacker1@acme.com\`) —ñ –æ—Ç—Ä–∏–º—É—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ UUID, —Å–∫–∞–∂—ñ–º–æ, \`99874128-7592-11e9-8201-bb2f15014a14\`.
* –ù–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ —ñ–Ω—ñ—Ü—ñ—é—î —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∂–µ—Ä—Ç–≤–∏ (\`victim@acme.com\`), –∞ –ø–æ—Ç—ñ–º —à–≤–∏–¥–∫–æ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º (\`attacker2@acme.com\`).
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –æ—Ç—Ä–∏–º—É—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑ UUID, —Å–∫–∞–∂—ñ–º–æ, \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **–ê–Ω–∞–ª—ñ–∑**:

* –¢–µ–ø–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–∞—î –¥–≤–∞ UUID, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ –±–ª–∏–∑—å–∫–æ –∑–∞ —á–∞—Å–æ–º (\`99874128\` —Ç–∞ \`998796b4\`). –í—Ä–∞—Ö–æ–≤—É—é—á–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä UUID –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—É, UUID –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∂–µ—Ä—Ç–≤–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ –º—ñ–∂ —Ü–∏–º–∏ –¥–≤–æ–º–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏.

4. **–ë—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫–∞:**

* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó UUID –º—ñ–∂ —Ü–∏–º–∏ –¥–≤–æ–º–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ —Ç–∞ —Ç–µ—Å—Ç—É—î –∫–æ–∂–µ–Ω –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π UUID, –Ω–∞–º–∞–≥–∞—é—á–∏—Å—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, \`https://www.acme.com/reset/\<generated-UUID>\`).
* –Ø–∫—â–æ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –æ–±–º–µ–∂—É—î –∞–¥–µ–∫–≤–∞—Ç–Ω–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å –∞–±–æ –Ω–µ –±–ª–æ–∫—É—î —Ç–∞–∫—ñ —Å–ø—Ä–æ–±–∏, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —à–≤–∏–¥–∫–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ UUID —É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ.

5. **–û—Ç—Ä–∏–º–∞–Ω–æ –¥–æ—Å—Ç—É–ø:**

* –Ø–∫ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π UUID –¥–ª—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∂–µ—Ä—Ç–≤–∏ –±—É–¥–µ –≤–∏—è–≤–ª–µ–Ω–æ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å–∫–∏–Ω—É—Ç–∏ –ø–∞—Ä–æ–ª—å –∂–µ—Ä—Ç–≤–∏ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —ó—Ö–Ω—å–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.

### Tools

* –í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Å–µ–Ω–¥–≤—ñ—á-–∞—Ç–∞–∫—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏—è–≤–∏—Ç–∏ —Ç–∞–∫—ñ UUID —É Burp Suite –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
