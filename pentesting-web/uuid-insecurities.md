# UUID Insecurities

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Basic Information

Les Identifiants Universellement Uniques (UUID) sont des **nombres de 128 bits utilis√©s pour identifier de mani√®re unique des informations** dans les syst√®mes informatiques. Les UUID sont essentiels dans les applications o√π des identifiants uniques sont n√©cessaires sans coordination centrale. Ils sont couramment utilis√©s comme cl√©s de base de donn√©es et peuvent faire r√©f√©rence √† divers √©l√©ments comme des documents et des sessions.

Les UUID sont con√ßus pour √™tre uniques et **difficiles √† deviner**. Ils sont structur√©s dans un format sp√©cifique, divis√©s en cinq groupes repr√©sent√©s par 32 chiffres hexad√©cimaux. Il existe diff√©rentes versions de UUID, chacune servant √† des fins diff√©rentes :

* **UUID v1** est bas√© sur le temps, incorporant l'horodatage, la s√©quence d'horloge et l'ID de n≈ìud (adresse MAC), mais il peut potentiellement exposer des informations syst√®me.
* **UUID v2** est similaire √† v1 mais inclut des modifications pour les domaines locaux (peu utilis√©).
* **UUID v3 et v5** g√©n√®rent des UUID en utilisant des valeurs de hachage √† partir de l'espace de noms et du nom, v3 utilisant MD5 et v5 utilisant SHA-1.
* **UUID v4** est g√©n√©r√© presque enti√®rement de mani√®re al√©atoire, offrant un haut niveau d'anonymat mais avec un l√©ger risque de doublons.

{% hint style="success" %}
Notez que la version et la sous-version de l'UUID apparaissent g√©n√©ralement dans la m√™me position √† l'int√©rieur de l'UUID. Par exemple dans :\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* La **position du M** indique la **version** de l'UUID. Dans l'exemple ci-dessus, c'est UUID v**1**.
* La **position du N** indique le variant de l'UUID.
{% endhint %}

## Sandwich attack

L'¬´ attaque Sandwich ¬ª est un type sp√©cifique d'attaque qui **exploite la pr√©visibilit√© de la g√©n√©ration de UUID v1 dans les applications web**, en particulier dans des fonctionnalit√©s comme les r√©initialisations de mot de passe. Le UUID v1 est g√©n√©r√© en fonction du temps, de la s√©quence d'horloge et de l'adresse MAC du n≈ìud, ce qui peut le rendre quelque peu pr√©visible si un attaquant peut obtenir certains de ces UUID g√©n√©r√©s √† proximit√© dans le temps.

### Example

Imaginez une application web qui utilise UUID v1 pour g√©n√©rer des liens de r√©initialisation de mot de passe. Voici comment un attaquant pourrait exploiter cela pour obtenir un acc√®s non autoris√© :

1. **Configuration initiale** :

* L'attaquant contr√¥le deux comptes email : \`attacker1@acme.com\` et \`attacker2@acme.com\`.
* Le compte email de la cible est \`victim@acme.com\`.

2. **Ex√©cution** :

* L'attaquant d√©clenche une r√©initialisation de mot de passe pour son premier compte (\`attacker1@acme.com\`) et re√ßoit un lien de r√©initialisation de mot de passe avec un UUID, disons \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Imm√©diatement apr√®s, l'attaquant d√©clenche une r√©initialisation de mot de passe pour le compte de la victime (\`victim@acme.com\`) puis rapidement pour le deuxi√®me compte contr√¥l√© par l'attaquant (\`attacker2@acme.com\`).
* L'attaquant re√ßoit un lien de r√©initialisation pour le deuxi√®me compte avec un UUID, disons \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analyse** :

* L'attaquant a maintenant deux UUID g√©n√©r√©s √† proximit√© dans le temps (\`99874128\` et \`998796b4\`). √âtant donn√© la nature s√©quentielle des UUID bas√©s sur le temps, le UUID pour le compte de la victime tombera probablement entre ces deux valeurs.

4. **Attaque par force brute :**

* L'attaquant utilise un outil pour g√©n√©rer des UUID entre ces deux valeurs et teste chaque UUID g√©n√©r√© en essayant d'acc√©der au lien de r√©initialisation de mot de passe (par exemple, \`https://www.acme.com/reset/\<generated-UUID>\`).
* Si l'application web ne limite pas ad√©quatement le taux ou ne bloque pas de telles tentatives, l'attaquant peut rapidement tester tous les UUID possibles dans la plage.

5. **Acc√®s obtenu :**

* Une fois le bon UUID pour le lien de r√©initialisation de mot de passe de la victime d√©couvert, l'attaquant peut r√©initialiser le mot de passe de la victime et obtenir un acc√®s non autoris√© √† son compte.

### Tools

* Vous pouvez effectuer l'attaque sandwich automatiquement avec l'outil : [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Vous pouvez d√©tecter ces types de UUID dans Burp Suite avec l'extension [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## References

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
