# Bezpieczestwo UUID

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na GitHubie.

</details>

## Podstawowe informacje

Uniwersalne unikalne identyfikatory (UUID) to **128-bitowe liczby u偶ywane do unikalnej identyfikacji informacji** w systemach komputerowych. UUID s niezbdne w aplikacjach, gdzie wymagane s unikalne identyfikatory bez centralnej koordynacji. S one czsto u偶ywane jako klucze baz danych i mog odnosi si do r贸偶nych element贸w, takich jak dokumenty i sesje.

UUID s zaprojektowane tak, aby byy unikalne i **trudne do odgadnicia**. Maj okrelony format, podzielony na pi grup reprezentowanych jako 32 cyfry szesnastkowe. Istniej r贸偶ne wersje UUID, z kt贸rych ka偶da su偶y innym celom:

* **UUID v1** jest oparty na czasie, zawiera znacznik czasu, sekwencj zegara i identyfikator wza (adres MAC), ale mo偶e potencjalnie ujawni informacje systemowe.
* **UUID v2** jest podobny do v1, ale zawiera modyfikacje dla domen lokalnych (rzadko u偶ywany).
* **UUID v3 i v5** generuj UUID za pomoc wartoci skr贸tu z przestrzeni nazw i nazwy, przy czym v3 u偶ywa MD5, a v5 u偶ywa SHA-1.
* **UUID v4** jest generowany prawie cakowicie losowo, zapewniajc wysoki poziom anonimowoci, ale z niewielkim ryzykiem duplikat贸w.

{% hint style="success" %}
Zauwa偶, 偶e wersja i podwersja UUID zazwyczaj pojawia si na tej samej pozycji wewntrz UUID. Na przykad w:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* **Pozycja M** wskazuje wersj UUID. W powy偶szym przykadzie jest to UUID v**1**.
* **Pozycja N** wskazuje wariant UUID.
{% endhint %}

## Atak kanapkowy

"Atak kanapkowy" to konkretny rodzaj ataku, kt贸ry **wykorzystuje przewidywalno generowania UUID v1 w aplikacjach internetowych**, zwaszcza w funkcjach takich jak resetowanie hasa. UUID v1 jest generowany na podstawie czasu, sekwencji zegara i adresu MAC wza, co mo偶e sprawi, 偶e jest on w pewnym stopniu przewidywalny, jeli atakujcy mo偶e uzyska niekt贸re z tych UUID wygenerowanych blisko w czasie.

### Przykad

Wyobra藕 sobie aplikacj internetow, kt贸ra u偶ywa UUID v1 do generowania link贸w resetowania hasa. Oto jak atakujcy mo偶e wykorzysta to do uzyskania nieautoryzowanego dostpu:

1. **Pocztkowe przygotowanie**:

* Atakujcy kontroluje dwa konta e-mail: \`atakujcy1@acme.com\` i \`atakujcy2@acme.com\`.
* Konto e-mail celu to \`ofiara@acme.com\`.

2. **Wykonanie**:

* Atakujcy inicjuje resetowanie hasa dla swojego pierwszego konta (\`atakujcy1@acme.com\`) i otrzymuje link resetowania hasa z UUID, na przykad \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Bezporednio po tym atakujcy inicjuje resetowanie hasa dla konta ofiary (\`ofiara@acme.com\`) i nastpnie szybko dla drugiego kontrolowanego konta atakujcego (\`atakujcy2@acme.com\`).
* Atakujcy otrzymuje link resetowania dla drugiego konta z UUID, na przykad \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analiza**:

* Atakujcy ma teraz dwa UUID wygenerowane blisko w czasie (\`99874128\` i \`998796b4\`). Biorc pod uwag sekwencyjny charakter UUID opartych na czasie, UUID dla konta ofiary prawdopodobnie znajdzie si midzy tymi dwoma wartociami.

4. **Atak siowy:**

* Atakujcy u偶ywa narzdzia do generowania UUID midzy tymi dwoma wartociami i testuje ka偶dy wygenerowany UUID, pr贸bujc uzyska dostp do linku resetowania hasa (np. \`https://www.acme.com/reset/\<wygenerowany-UUID>\`).
* Jeli aplikacja internetowa nie ogranicza odpowiednio liczby pr贸b lub blokuje takie pr贸by, atakujcy mo偶e szybko przetestowa wszystkie mo偶liwe UUID w zakresie.

5. **Uzyskanie dostpu:**

* Po odkryciu poprawnego UUID dla linku resetowania hasa ofiary, atakujcy mo偶e zresetowa haso ofiary i uzyska nieautoryzowany dostp do jej konta.

### Narzdzia

* Mo偶esz automatycznie przeprowadzi atak kanapkowy za pomoc narzdzia: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Mo偶esz wykry ten rodzaj UUID w Burp Suite za pomoc rozszerzenia [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Odnoniki

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
