# Narzdzie sieciowe - WFuzz

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

Narzdzie do FUZZowania aplikacji internetowych w dowolnym miejscu.

> [Wfuzz](https://github.com/xmendez/wfuzz) zosta stworzony w celu uatwienia zadania w ocenie aplikacji internetowych i opiera si na prostym konceptcie: zastpuje ka偶de wystpienie sowa kluczowego FUZZ wartoci okrelonego adunku.

## Instalacja

Zainstalowane w Kali

Github: [https://github.com/xmendez/wfuzz](https://github.com/xmendez/wfuzz)
```
pip install wfuzz
```
## Opcje filtrowania

### **Code** (`-c`)

This option allows you to filter the response based on the HTTP status code. You can specify a single code or a range of codes using the syntax `start-end`. For example, `-c 200` will only show responses with a status code of 200, while `-c 200-299` will show responses with status codes ranging from 200 to 299.

### **Size** (`-s`)

With this option, you can filter the response based on its size. You can specify a single size or a range of sizes using the syntax `start-end`. For example, `-s 100` will only show responses with a size of 100 bytes, while `-s 100-200` will show responses with sizes ranging from 100 to 200 bytes.

### **Words** (`-w`)

This option allows you to filter the response based on the presence or absence of specific words. You can specify one or multiple words separated by commas. For example, `-w admin,login` will only show responses that contain either the word "admin" or the word "login".

### **Regex** (`-r`)

With this option, you can filter the response based on a regular expression pattern. You can specify a single pattern or multiple patterns separated by commas. For example, `-r ^[0-9]{3}$` will only show responses that match the pattern of three digits.

### **Follow Redirects** (`-F`)

By default, `wfuzz` does not follow redirects. However, you can use this option to enable redirect following. This can be useful when testing for open redirects or when you want to see the response of the final redirected URL.

### **Hide Output** (`-H`)

This option allows you to hide the output of the response. It can be useful when you only want to see the summary of the requests without cluttering the output with the actual response content.

### **Filter by Length** (`-L`)

With this option, you can filter the response based on the length of a specific part of the response. You need to specify the part of the response to filter (e.g., `H` for headers, `B` for body) and the length or range of lengths to filter. For example, `-L H,100` will only show responses with header lengths of 100 characters.

### **Filter by Time** (`-T`)

This option allows you to filter the response based on the time it took to receive the response. You can specify a single time or a range of times using the syntax `start-end`. For example, `-T 0.5` will only show responses that took 0.5 seconds to receive, while `-T 0.5-1` will show responses that took between 0.5 and 1 second to receive.
```bash
--hs/ss "regex" #Hide/Show
#Simple example, match a string: "Invalid username"
#Regex example: "Invalid *"

--hc/sc CODE #Hide/Show by code in response
--hl/sl NUM #Hide/Show by number of lines in response
--hw/sw NUM #Hide/Show by number of words in response
--hh/sh NUM #Hide/Show by number of chars in response
--hc/sc NUM #Hide/Show by response code
```
## Opcje wyjcia

Wfuzz provides several options for displaying the output of its scans. These options can be used to customize the format and level of detail in the output. The available output options are:

- **Quiet mode (-q):** This option suppresses all output except for the final results. It is useful when you only want to see the final summary of the scan.

- **Verbose mode (-v):** This option increases the level of detail in the output. It displays additional information about each request and response, including headers and status codes.

- **Colorized output (-c):** This option adds color to the output, making it easier to read and interpret. Different colors are used to highlight different types of information, such as successful requests, errors, and redirects.

- **Output to a file (-o):** This option allows you to save the output to a file instead of displaying it on the screen. You can specify the filename and path for the output file.

- **Output format (-f):** This option allows you to specify the format of the output. Wfuzz supports various output formats, including HTML, XML, JSON, and CSV. You can choose the format that best suits your needs.

- **Output filtering (-x):** This option allows you to filter the output based on specific criteria. You can use regular expressions to define the filtering rules and only display the relevant information.

By using these output options effectively, you can customize the way Wfuzz presents the results of your scans and make it easier to analyze and interpret the findings.
```bash
wfuzz -e printers #Prints the available output formats
-f /tmp/output,csv #Saves the output in that location in csv format
```
### Opcje enkoder贸w

There are several encoding techniques that can be used during a penetration test to bypass security measures or obfuscate payloads. These techniques can help in evading detection and executing successful attacks. Here are some commonly used encoder options:

#### Base64 Encoding
Base64 encoding is a simple encoding technique that converts binary data into ASCII characters. It is commonly used to encode sensitive information such as credentials or command payloads. To use Base64 encoding with wfuzz, you can use the `--encoding base64` option.

#### URL Encoding
URL encoding, also known as percent encoding, is used to encode special characters in a URL. This encoding replaces special characters with a '%' sign followed by two hexadecimal digits. To use URL encoding with wfuzz, you can use the `--encoding url` option.

#### HTML Encoding
HTML encoding is used to encode special characters in HTML documents. This encoding replaces special characters with their corresponding HTML entities. To use HTML encoding with wfuzz, you can use the `--encoding html` option.

#### Hex Encoding
Hex encoding, also known as hexadecimal encoding, converts binary data into a hexadecimal representation. Each byte is represented by two hexadecimal digits. To use hex encoding with wfuzz, you can use the `--encoding hex` option.

#### Unicode Encoding
Unicode encoding is used to represent characters that are not present in the ASCII character set. It allows the representation of characters from various languages and scripts. To use Unicode encoding with wfuzz, you can use the `--encoding unicode` option.

#### Double URL Encoding
Double URL encoding is a technique used to bypass security filters that decode URL-encoded data before processing it. It involves encoding the URL-encoded data again. To use double URL encoding with wfuzz, you can use the `--encoding double-url` option.

These encoding options can be used with wfuzz to test the effectiveness of security measures and identify vulnerabilities in web applications.
```bash
wfuzz -e encoders #Prints the available encoders
#Examples: urlencode, md5, base64, hexlify, uri_hex, doble urlencode
```
Aby u偶y enkodera, musisz go wskaza w opcji **"-w"** lub **"-z"**.

Przykady:
```bash
-z file,/path/to/file,md5 #Will use a list inside the file, and will transform each value into its md5 hash before sending it
-w /path/to/file,base64 #Will use a list, and transform to base64
-z list,each-element-here,hexlify #Inline list and to hex before sending values
```
## CheetSheet

### Bruteforce formularza logowania

#### **POST, Jedna lista, filtrowanie cigu znak贸w (ukryte)**
```bash
wfuzz -c -w users.txt --hs "Login name" -d "name=FUZZ&password=FUZZ&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php
#Here we have filtered by line
```
#### **POST, 2 listy, kod filtrujcy (poka偶)**
```bash
wfuzz.py -c -z file,users.txt -z file,pass.txt --sc 200 -d "name=FUZZ&password=FUZ2Z&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php
#Here we have filtered by code
```
#### **GET, 2 listy, filtrowanie cigu znak贸w (poka偶), proxy, ciasteczka**

---

Wfuzz is a web application brute forcer that allows you to perform complex brute force attacks by combining different HTTP parameters. It can be used to discover hidden files and directories, identify vulnerabilities, and test the security of web applications.

Wfuzz supports various features that can enhance your brute force attacks. In this section, we will explore some of these features:

1. **GET Requests**: Wfuzz allows you to send GET requests to the target web application. This is useful for testing the functionality of different endpoints and parameters.

2. **2 Lists**: Wfuzz allows you to use two lists simultaneously. This can be helpful when you want to test multiple parameters or values at the same time.

3. **Filter String (Show)**: Wfuzz provides the ability to filter the response based on a specific string. This can be useful for identifying successful brute force attempts or finding specific content in the response.

4. **Proxy**: Wfuzz supports proxy functionality, allowing you to route your requests through a proxy server. This can help you hide your identity or bypass certain restrictions.

5. **Cookies**: Wfuzz allows you to include cookies in your requests. This can be useful for testing web applications that rely on session cookies or authentication mechanisms.

By leveraging these features, you can customize your brute force attacks and increase your chances of finding vulnerabilities in web applications.
```bash
wfuzz -c -w users.txt -w pass.txt --ss "Welcome " -p 127.0.0.1:8080:HTTP -b "PHPSESSIONID=1234567890abcdef;customcookie=hey" "http://example.com/index.php?username=FUZZ&password=FUZ2Z&action=sign+in"
```
### Bruteforce katalogu/Bruteforce RESTful

[Arjun lista s贸w kluczowych](https://raw.githubusercontent.com/s0md3v/Arjun/master/arjun/db/params.txt)
```
wfuzz -c -w /tmp/tmp/params.txt --hc 404 https://domain.com/api/FUZZ
```
### Przegld

Atak Brute Force na parametry cie偶ki (Path Parameters Brute Force) polega na pr贸bie odgadnicia wartoci parametr贸w cie偶ki w celu odkrycia ukrytych zasob贸w lub wykonania nieautoryzowanych operacji. W tym ataku, narzdzie WFuzz jest u偶ywane do automatycznego testowania r贸偶nych wartoci parametr贸w cie偶ki w celu znalezienia tych, kt贸re prowadz do po偶danych rezultat贸w.

### Spos贸b u偶ycia narzdzia WFuzz

Narzdzie WFuzz jest wykorzystywane do przeprowadzania atak贸w Brute Force na parametry cie偶ki. Poni偶ej przedstawiono przykadow komend u偶ywan do tego celu:

```plaintext
wfuzz -c -z file,/path/to/wordlist.txt http://example.com/FUZZ
```

W powy偶szym poleceniu:

- `-c` oznacza, 偶e narzdzie WFuzz ma kontynuowa, nawet jeli otrzyma bd HTTP 404 (Not Found).
- `-z file,/path/to/wordlist.txt` wskazuje, 偶e narzdzie WFuzz ma u偶ywa pliku wordlist.txt jako 藕r贸da wartoci do testowania.
- `http://example.com/FUZZ` okrela adres URL, w kt贸rym parametr cie偶ki jest oznaczony jako `FUZZ`. Narzdzie WFuzz automatycznie zastpi `FUZZ` r贸偶nymi wartociami z pliku wordlist.txt.

### Przykad u偶ycia

Przykad u偶ycia narzdzia WFuzz do ataku Brute Force na parametry cie偶ki mo偶e wyglda nastpujco:

```plaintext
wfuzz -c -z file,/path/to/wordlist.txt http://example.com/api/users/FUZZ
```

W powy偶szym przykadzie, narzdzie WFuzz automatycznie zastpi `FUZZ` r贸偶nymi wartociami z pliku wordlist.txt i przetestuje ka偶d warto w celu znalezienia ukrytych zasob贸w lub wykonania nieautoryzowanych operacji na cie偶ce `/api/users/`.
```bash
wfuzz -c -w ~/git/Arjun/db/params.txt --hw 11 'http://example.com/path%3BFUZZ=FUZZ'
```
#### **Podstawowa autoryzacja, 2 listy, filtrowanie cigu znak贸w (poka偶), proxy**

W przypadku atak贸w na autoryzacj nag贸wka, mo偶emy u偶y narzdzia wfuzz do przetestowania r贸偶nych kombinacji nazw u偶ytkownik贸w i hase. Mo偶emy r贸wnie偶 u偶y dw贸ch list: jednej z nazwami u偶ytkownik贸w i drugiej z hasami. 

Aby filtrowa wyniki, mo偶emy u偶y opcji `--filter` wraz z cigiem znak贸w, kt贸re chcemy wywietli. Na przykad, jeli chcemy wywietli tylko te wyniki, kt贸re zawieraj sowo "sukces", mo偶emy u偶y `--filter "success"`. 

Jeli chcemy przeprowadzi atak przez proxy, mo偶emy u偶y opcji `--proxy` wraz z adresem proxy. Na przykad, `--proxy http://proxy.example.com:8080`.
```bash
wfuzz -c -w users.txt -w pass.txt -p 127.0.0.1:8080:HTTP --ss "Welcome" --basic FUZZ:FUZ2Z "http://example.com/index.php"
```
#### **NTLM, 2 listy, filtruj cig (poka偶), proxy**
```bash
wfuzz -c -w users.txt -w pass.txt -p 127.0.0.1:8080:HTTP --ss "Welcome" --ntlm 'domain\FUZZ:FUZ2Z' "http://example.com/index.php"
```
#### Bruteforce plik贸w Cookie/Header (brute force vhost)

#### **Plik Cookie, kod filtrujcy (poka偶), proxy**
```bash
wfuzz -c -w users.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "Cookie:id=1312321&user=FUZZ"  "http://example.com/index.php"
```
#### **User-Agent, filtruj kod (ukryj), proxy**

W przypadku testowania aplikacji internetowych, czsto konieczne jest zmienienie wartoci nag贸wka User-Agent, aby symulowa r贸偶ne przegldarki lub urzdzenia. Wfuzz umo偶liwia to za pomoc opcji `--ua` lub `--user-agent`. Mo偶na poda dowoln warto User-Agent, kt贸ra zostanie wysana w 偶daniach.

Przykad u偶ycia:

```
wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/user-agents.txt --ua FUZZ http://example.com
```

W powy偶szym przykadzie, `--ua FUZZ` oznacza, 偶e Wfuzz bdzie u偶ywa wartoci z pliku `user-agents.txt` jako User-Agent w 偶daniach.

Mo偶na r贸wnie偶 filtrowa odpowiedzi serwera, aby ukry niechciane treci. Wfuzz umo偶liwia to za pomoc opcji `--filter`. Mo偶na poda dowolne wyra偶enie regularne, kt贸re zostanie zastosowane do odpowiedzi serwera. Wszystkie odpowiedzi, kt贸re nie pasuj do wyra偶enia regularnego, zostan ukryte.

Przykad u偶ycia:

```
wfuzz -c --filter "200 OK" http://example.com/FUZZ
```

W powy偶szym przykadzie, `--filter "200 OK"` oznacza, 偶e Wfuzz bdzie ukrywa wszystkie odpowiedzi, kt贸re nie zawieraj frazy "200 OK".

Wfuzz obsuguje r贸wnie偶 u偶ycie proxy. Mo偶na to zrobi za pomoc opcji `--proxy`. Mo偶na poda adres IP i port proxy, kt贸ry zostanie u偶yty do wysyania 偶da.

Przykad u偶ycia:

```
wfuzz -c --proxy 127.0.0.1:8080 http://example.com/FUZZ
```

W powy偶szym przykadzie, `--proxy 127.0.0.1:8080` oznacza, 偶e Wfuzz bdzie u偶ywa proxy o adresie IP 127.0.0.1 i porcie 8080 do wysyania 偶da.
```bash
wfuzz -c -w user-agents.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "User-Agent: FUZZ"  "http://example.com/index.php"
```
#### **Host**
```bash
wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-
top1million-20000.txt --hc 400,404,403 -H "Host: FUZZ.example.com" -u
http://example.com -t 100
```
#### **U偶ywanie pliku**

W przypadku ataku bruteforce na metody HTTP mo偶na u偶y pliku, kt贸ry zawiera list mo偶liwych metod. W tym celu mo偶na skorzysta z narzdzia `wfuzz`. Poni偶ej przedstawiono przykad u偶ycia tego narzdzia:

```plaintext
wfuzz -c -z file,methods.txt http://example.com/FUZZ
```

W powy偶szym przykadzie `methods.txt` to plik zawierajcy list metod HTTP, kt贸re zostan przetestowane w ataku bruteforce. `FUZZ` jest zmienn, kt贸ra zostanie zastpiona przez ka偶d metod z listy podczas wykonywania ataku.
```bash
wfuzz -c -w methods.txt -p 127.0.0.1:8080:HTTP --sc 200 -X FUZZ "http://example.com/index.php"
```
#### **U偶ywanie listy w linii**

Sometimes, when fuzzing a web application, you may want to use a list of values as payloads for a specific parameter. Instead of specifying each value individually, you can use the `@` symbol followed by the path to a file containing the list of values.

Czasami, podczas fuzzowania aplikacji internetowej, mo偶esz chcie u偶y listy wartoci jako payload贸w dla okrelonego parametru. Zamiast podawa ka偶d warto indywidualnie, mo偶esz u偶y symbolu `@`, a nastpnie cie偶ki do pliku zawierajcego list wartoci.

For example, let's say you have a parameter called `username` and you want to fuzz it with a list of common usernames. You can create a file called `usernames.txt` with the following content:

Na przykad, za贸偶my, 偶e masz parametr o nazwie `username` i chcesz go fuzzowa za pomoc listy powszechnych nazw u偶ytkownik贸w. Mo偶esz utworzy plik o nazwie `usernames.txt` o nastpujcej zawartoci:

```
admin
root
user
test
```

Then, you can use the `@` symbol followed by the path to the file as the payload for the `username` parameter:

Nastpnie mo偶esz u偶y symbolu `@`, a nastpnie cie偶ki do pliku jako payload dla parametru `username`:

```
wfuzz -u http://example.com/login.php?username=FUZZ -w usernames.txt
```

This will fuzz the `username` parameter with each value from the `usernames.txt` file.

To spowoduje fuzzowanie parametru `username` za pomoc ka偶dej wartoci z pliku `usernames.txt`.
```bash
$ wfuzz -z list,GET-HEAD-POST-TRACE-OPTIONS -X FUZZ http://testphp.vulnweb.com/
```
### Bruteforce katalog贸w i plik贸w

Wfuzz jest narzdziem do bruteforce'owania katalog贸w i plik贸w na stronach internetowych. Pozwala na przetestowanie wielu kombinacji nazw plik贸w i katalog贸w w celu znalezienia ukrytych zasob贸w.

#### Skadnia

```
wfuzz -c -z file,<wordlist> --hc <response_code> <target_url>/<FUZZ>
```

#### Wyjanienie skadni

- `-c` - opcja sprawia, 偶e wfuzz zatrzymuje si na pierwszym trafieniu
- `-z file,<wordlist>` - opcja okrelajca, 偶e u偶ywamy pliku z list s贸w do bruteforce'owania
- `--hc <response_code>` - opcja okrelajca kod odpowiedzi, kt贸ry oznacza, 偶e trafilimy na istniejcy zas贸b
- `<target_url>` - adres URL docelowej strony internetowej
- `<FUZZ>` - zmienna, kt贸ra bdzie zastpiona przez sowa z listy s贸w

#### Przykad u偶ycia

```
wfuzz -c -z file,wordlist.txt --hc 200 https://example.com/FUZZ
```

W powy偶szym przykadzie, wfuzz bdzie pr贸bowa znale藕 istniejce pliki lub katalogi na stronie https://example.com, zastpujc `<FUZZ>` sowami z pliku wordlist.txt. Jeli trafimy na zas贸b z kodem odpowiedzi 200, wfuzz zatrzyma si.
```bash
#Filter by whitelisting codes
wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200,202,204,301,302,307,403 http://example.com/uploads/FUZZ
```
## Narzdzie do omijania stron internetowych

[https://github.com/carlospolop/fuzzhttpbypass](https://github.com/carlospolop/fuzzhttpbypass)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy **reklam swojej firmy w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
