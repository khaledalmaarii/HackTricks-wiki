# XS-Search/XS-Leaks

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) za lako kreiranje i **automatizaciju radnih tokova** pokretanih najnaprednijim **alatima zajednice** na svetu.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

{% hint style="success" %}
Uƒçite i ve≈æbajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Uƒçite i ve≈æbajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr≈°ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru≈æite se** üí¨ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Osnovne informacije

XS-Search je metoda koja se koristi za **izvlaƒçenje informacija sa razliƒçitih izvora** koristeƒái **boƒçne kanale ranjivosti**.

Kljuƒçne komponente ukljuƒçene u ovaj napad ukljuƒçuju:

* **Ranjivi Web**: Ciljna veb stranica sa koje se informacije nameravaju izvuƒái.
* **Napadaƒçev Web**: Zlonamerna veb stranica koju je kreirao napadaƒç, koju ≈ærtva poseƒáuje, a koja sadr≈æi eksploataciju.
* **Metod ukljuƒçivanja**: Tehnika koja se koristi za ukljuƒçivanje Ranjivog Web-a u Napadaƒçev Web (npr. window.open, iframe, fetch, HTML tag sa href, itd.).
* **Tehnika curenja**: Tehnike koje se koriste za uoƒçavanje razlika u stanju Ranjivog Web-a na osnovu informacija prikupljenih putem metode ukljuƒçivanja.
* **Stanja**: Dva moguƒáa stanja Ranjivog Web-a koja napadaƒç ≈æeli da razlikuje.
* **Uoƒçljive razlike**: Opservabilne varijacije na koje se napadaƒç oslanja da bi zakljuƒçio stanje Ranjivog Web-a.

### Uoƒçljive razlike

Nekoliko aspekata mo≈æe se analizirati kako bi se razlikovala stanja Ranjivog Web-a:

* **Status kod**: Razlikovanje izmeƒëu **razliƒçitih HTTP status kodova** sa razliƒçitih izvora, kao ≈°to su gre≈°ke servera, gre≈°ke klijenta ili gre≈°ke autentifikacije.
* **Kori≈°ƒáenje API-ja**: Identifikacija **kori≈°ƒáenja Web API-ja** na stranicama, otkrivajuƒái da li stranica sa razliƒçitih izvora koristi odreƒëeni JavaScript Web API.
* **Preusmeravanja**: Otkrivanje navigacija ka razliƒçitim stranicama, ne samo HTTP preusmeravanjima, veƒá i onima koje pokreƒáe JavaScript ili HTML.
* **Sadr≈æaj stranice**: Posmatranje **varijacija u HTTP odgovoru** ili u podresursima stranice, kao ≈°to su **broj ugnje≈ædenih okvira** ili razlike u veliƒçini slika.
* **HTTP zaglavlje**: Zapa≈æanje prisustva ili moguƒáe vrednosti **odreƒëenog HTTP odgovora**, ukljuƒçujuƒái zaglavlja kao ≈°to su X-Frame-Options, Content-Disposition i Cross-Origin-Resource-Policy.
* **Vreme**: Uoƒçavanje doslednih vremenskih razlika izmeƒëu dva stanja.

### Metode ukljuƒçivanja

* **HTML elementi**: HTML nudi razliƒçite elemente za **ukljuƒçivanje resursa sa razliƒçitih izvora**, kao ≈°to su stilovi, slike ili skripte, primoravajuƒái pregledaƒç da zatra≈æi ne-HTML resurs. Kompilacija potencijalnih HTML elemenata za ovu svrhu mo≈æe se naƒái na [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks).
* **Okviri**: Elementi kao ≈°to su **iframe**, **object** i **embed** mogu direktno ugraditi HTML resurse u napadaƒçevu stranicu. Ako stranica **nema za≈°titu od uokvirivanja**, JavaScript mo≈æe pristupiti prozoru ugnje≈ædenog resursa putem contentWindow svojstva.
* **Iskoƒçne prozore**: Metoda **`window.open`** otvara resurs u novoj kartici ili prozoru, pru≈æajuƒái **prozor za interakciju** za JavaScript sa metodama i svojstvima prema SOP-u. Iskoƒçni prozori, ƒçesto kori≈°ƒáeni u jedinstvenom prijavljivanju, zaobilaze ograniƒçenja uokvirivanja i kolaƒçiƒáa ciljanog resursa. Meƒëutim, moderni pregledaƒçi ograniƒçavaju kreiranje iskoƒçnih prozora na odreƒëene korisniƒçke akcije.
* **JavaScript zahtevi**: JavaScript omoguƒáava direktne zahteve ka ciljnim resursima koristeƒái **XMLHttpRequests** ili **Fetch API**. Ove metode nude preciznu kontrolu nad zahtevom, kao ≈°to je opcija da se prati HTTP preusmeravanje.

### Tehnike curenja

* **Handler dogaƒëaja**: Klasiƒçna tehnika curenja u XS-Leaks, gde handleri dogaƒëaja kao ≈°to su **onload** i **onerror** pru≈æaju uvide o uspehu ili neuspehu uƒçitavanja resursa.
* **Poruke o gre≈°ci**: JavaScript izuzeci ili posebne stranice sa gre≈°kama mogu pru≈æiti informacije o curenju ili direktno iz poruke o gre≈°ci ili razlikovanjem izmeƒëu njenog prisustva i odsustva.
* **Globalna ograniƒçenja**: Fiziƒçka ograniƒçenja pregledaƒça, kao ≈°to su kapacitet memorije ili druga nametnuta ograniƒçenja pregledaƒça, mogu signalizirati kada je dostignut prag, slu≈æeƒái kao tehnika curenja.
* **Globalno stanje**: Uoƒçljive interakcije sa **globalnim stanjima** pregledaƒça (npr. interfejs istorije) mogu se iskoristiti. Na primer, **broj unosa** u istoriji pregledaƒça mo≈æe pru≈æiti tragove o stranicama sa razliƒçitih izvora.
* **Performanse API**: Ovaj API pru≈æa **detalje o performansama trenutne stranice**, ukljuƒçujuƒái mre≈æno vreme za dokument i uƒçitane resurse, omoguƒáavajuƒái zakljuƒçke o tra≈æenim resursima.
* **ƒåitljiva svojstva**: Neka HTML svojstva su **ƒçitljiva sa razliƒçitih izvora** i mogu se koristiti kao tehnika curenja. Na primer, `window.frame.length` svojstvo omoguƒáava JavaScript-u da prebroji okvire ukljuƒçene u veb stranicu sa razliƒçitih izvora.

## XSinator alat i rad

XSinator je automatski alat za **proveru pregledaƒça protiv nekoliko poznatih XS-Leaks** obja≈°njenih u njegovom radu: [**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

Mo≈æete **pristupiti alatu na** [**https://xsinator.com/**](https://xsinator.com/)

{% hint style="warning" %}
**Iskljuƒçeni XS-Leaks**: Morali smo iskljuƒçiti XS-Leaks koji se oslanjaju na **servisne radnike** jer bi ometali druga curenja u XSinator-u. Pored toga, odluƒçili smo da **iskljuƒçimo XS-Leaks koji se oslanjaju na pogre≈°ne konfiguracije i gre≈°ke u odreƒëenoj veb aplikaciji**. Na primer, pogre≈°ne konfiguracije CrossOrigin Resource Sharing (CORS), curenje postMessage ili Cross-Site Scripting. Takoƒëe, iskljuƒçili smo vremenski zasnovane XS-Leaks jer ƒçesto pate od sporosti, buke i netaƒçnosti.
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) za lako kreiranje i **automatizaciju radnih tokova** pokretanih najnaprednijim **alatima zajednice** na svetu.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## **Tehnike zasnovane na vremenu**

Neke od sledeƒáih tehnika ƒáe koristiti vreme kao deo procesa za otkrivanje razlika u moguƒáim stanjima veb stranica. Postoje razliƒçiti naƒçini merenja vremena u veb pregledaƒçu.

**Sati**: [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) API omoguƒáava programerima da dobiju merenja vremena visoke rezolucije.\
Postoji znaƒçajan broj API-ja koje napadaƒçi mogu zloupotrebiti za kreiranje implicitnih satova: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast\_Channel\_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSS animacije i drugi.\
Za vi≈°e informacija: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## Tehnike handlera dogaƒëaja

### Onload/Onerror

* **Metode ukljuƒçivanja**: Okviri, HTML elementi
* **Uoƒçljiva razlika**: Status kod
* **Vi≈°e informacija**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **Sa≈æetak**: Ako poku≈°avate da uƒçitate resurs, onerror/onload dogaƒëaji se aktiviraju kada je resurs uspe≈°no/neuspe≈°no uƒçitan, moguƒáe je utvrditi status kod.
* **Primer koda**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="xs-search/cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](xs-search/cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

Primer koda poku≈°ava da **uƒçita skripte iz JS**, ali **drugi tagovi** kao ≈°to su objekti, stilovi, slike, audio takoƒëe mogu biti kori≈°ƒáeni. ≈†tavi≈°e, takoƒëe je moguƒáe injektovati **tag direktno** i deklarisati `onload` i `onerror` dogaƒëaje unutar taga (umesto da ih injektujete iz JS).

Takoƒëe postoji verzija ovog napada bez skripti:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
U ovom sluƒçaju, ako `example.com/404` nije pronaƒëen, uƒçitaƒáe se `attacker.com/?error`.

### Onload Timing

* **Metode ukljuƒçivanja**: HTML elementi
* **Uoƒçljiva razlika**: Vreme (generalno zbog sadr≈æaja stranice, status koda)
* **Vi≈°e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Sa≈æetak:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** mo≈æe se koristiti za merenje koliko vremena je potrebno za izvr≈°enje zahteva. Meƒëutim, mogu se koristiti i drugi satovi, kao ≈°to je [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) koji mo≈æe identifikovati zadatke koji traju du≈æe od 50ms.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) jo≈° jedan primer u:

{% content-ref url="xs-search/performance.now-example.md" %}
[performance.now-example.md](xs-search/performance.now-example.md)
{% endcontent-ref %}

#### Onload Timing + Forced Heavy Task

Ova tehnika je sliƒçna prethodnoj, ali **napadaƒç** ƒáe takoƒëe **prisiliti** neku akciju da traje **odgovarajuƒáe vreme** kada je **odgovor pozitivan ili negativan** i izmeriti to vreme.

{% content-ref url="xs-search/performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](xs-search/performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload Timing

* **Metode ukljuƒçivanja**: Okviri
* **Uoƒçljiva razlika**: Vreme (generalno zbog sadr≈æaja stranice, status koda)
* **Vi≈°e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Sa≈æetak:** [SharedArrayBuffer sat](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) mo≈æe se koristiti za merenje koliko vremena je potrebno za izvr≈°enje zahteva. Mogu se koristiti i drugi satovi.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

Vreme potrebno za preuzimanje resursa mo≈æe se meriti kori≈°ƒáenjem [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) i [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event) dogaƒëaja. **`beforeunload`** dogaƒëaj se aktivira kada se pregledaƒç sprema da preƒëe na novu stranicu, dok se **`unload`** dogaƒëaj de≈°ava kada se navigacija zapravo odvija. Razlika u vremenu izmeƒëu ova dva dogaƒëaja mo≈æe se izraƒçunati kako bi se odredila **trajanje koje je pregledaƒç potro≈°io na preuzimanje resursa**.

### Sandboxed Frame Timing + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Metode ukljuƒçivanja**: Okviri
* **Uoƒçljiva razlika**: Vreme (generalno zbog sadr≈æaja stranice, status koda)
* **Vi≈°e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Sa≈æetak:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) API mo≈æe se koristiti za merenje koliko vremena je potrebno za izvr≈°enje zahteva. Mogu se koristiti i drugi satovi.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

Primeƒáeno je da u odsustvu [Framing Protections](https://xsleaks.dev/docs/defenses/opt-in/xfo/), vreme potrebno za uƒçitavanje stranice i njenih podresursa preko mre≈æe mo≈æe meriti napadaƒç. Ova merenja su obiƒçno moguƒáa jer se `onload` handler iframe-a aktivira tek nakon zavr≈°etka uƒçitavanja resursa i izvr≈°avanja JavaScript-a. Da bi se zaobi≈°la varijabilnost koju uvodi izvr≈°avanje skripti, napadaƒç mo≈æe koristiti [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) atribut unutar `<iframe>`. Ukljuƒçivanje ovog atributa ograniƒçava brojne funkcionalnosti, posebno izvr≈°avanje JavaScript-a, ƒçime se olak≈°ava merenje koje je prete≈æno pod uticajem mre≈æne performanse.
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + error + onload

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**:
* **Summary**: Ako mo≈æete izazvati gre≈°ku na stranici kada se pristupi ispravnom sadr≈æaju i uƒçiniti da se uƒçita ispravno kada se pristupi bilo kojem sadr≈æaju, onda mo≈æete napraviti petlju za ekstrakciju svih informacija bez merenja vremena.
* **Code Example**:

Pretpostavimo da mo≈æete **ubaciti** **stranicu** koja ima **tajni** sadr≈æaj **unutar Iframe**.

Mo≈æete **naterati ≈ærtvu da pretra≈æuje** datoteku koja sadr≈æi "_**flag**_" koristeƒái **Iframe** (na primer, eksploatacijom CSRF). Unutar Iframe-a znate da ƒáe se _**onload dogaƒëaj**_ **izvr≈°iti uvek barem jednom**. Tada mo≈æete **promeniti** **URL** **iframe-a** menjajuƒái samo **sadr≈æaj** **hash-a** unutar URL-a.

Na primer:

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

Ako je prvi URL **uspe≈°no uƒçitan**, tada, kada **promenite** deo **hash-a** URL-a, **onload** dogaƒëaj **neƒáe biti ponovo aktiviran**. Ali **ako** je stranica imala neku vrstu **gre≈°ke** prilikom **uƒçitavanja**, tada ƒáe se **onload** dogaƒëaj **ponovo aktivirati**.

Tada mo≈æete **razlikovati izmeƒëu** ispravno uƒçitane stranice ili stranice koja ima **gre≈°ku** kada se pristupi.

### Javascript Execution

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**:
* **Summary:** Ako **stranica** **vraƒáa** **osetljive** sadr≈æaje, **ili** sadr≈æaj koji mo≈æe biti **kontrolisan** od strane korisnika. Korisnik mo≈æe postaviti **validan JS kod u negativnom sluƒçaju**, **uƒçitavajuƒái** svaki poku≈°aj unutar **`<script>`** tagova, tako da u **negativnim** sluƒçajevima **napadaƒçev kod** se **izvr≈°ava**, a u **afirmativnim** sluƒçajevima **ni≈°ta** neƒáe biti izvr≈°eno.
* **Code Example:**

{% content-ref url="xs-search/javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](xs-search/javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code & Headers
* **More info**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **Summary**: **Cross-Origin Read Blocking (CORB)** je bezbednosna mera koja spreƒçava web stranice da uƒçitavaju odreƒëene osetljive resurse sa drugih domena kako bi se za≈°titili od napada poput **Spectre**. Meƒëutim, napadaƒçi mogu iskoristiti njeno za≈°titno pona≈°anje. Kada odgovor podlo≈æan **CORB** vrati _**CORB za≈°tiƒáen**_ `Content-Type` sa `nosniff` i `2xx` status kodom, **CORB** uklanja telo i zaglavlja odgovora. Napadaƒçi koji to posmatraju mogu da zakljuƒçe kombinaciju **status koda** (koji ukazuje na uspeh ili gre≈°ku) i `Content-Type` (koji oznaƒçava da li je za≈°tiƒáen od **CORB**), ≈°to mo≈æe dovesti do potencijalnog curenja informacija.
* **Code Example**:

Proverite link za vi≈°e informacija o napadu.

### onblur

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **Summary**: Curenje osetljivih podataka iz id ili name atributa.
* **Code Example**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

Moguƒáe je **uƒçitati stranicu** unutar **iframe-a** i koristiti **`#id_value`** da se stranica **fokusira na element** iframe-a sa naznaƒçenim id, zatim, ako se aktivira **`onblur`** signal, ID element postoji.\
Mo≈æete izvr≈°iti isti napad sa **`portal`** tagovima.

### postMessage Broadcasts <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **Summary**: Prikupiti osetljive informacije iz postMessage ili koristiti prisustvo postMessages kao orakl za poznavanje statusa korisnika na stranici
* **Code Example**: `Any code listening for all postMessages.`

Aplikacije ƒçesto koriste [`postMessage` broadcasts](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) za komunikaciju izmeƒëu razliƒçitih domena. Meƒëutim, ova metoda mo≈æe nenamerno izlo≈æiti **osetljive informacije** ako parametar `targetOrigin` nije pravilno specificiran, omoguƒáavajuƒái bilo kojem prozoru da primi poruke. ≈†tavi≈°e, sam ƒçin primanja poruke mo≈æe delovati kao **orakl**; na primer, odreƒëene poruke mogu biti poslate samo korisnicima koji su prijavljeni. Stoga, prisustvo ili odsustvo ovih poruka mo≈æe otkriti informacije o stanju ili identitetu korisnika, kao ≈°to je da li su autentifikovani ili ne.

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** pokretane najnaprednijim **alatima** zajednice.\
Pribavite pristup danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Global Limits Techniques

### WebSocket API

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: Iscrpljivanje limita WebSocket konekcije otkriva broj WebSocket konekcija stranice sa drugog domena.
* **Code Example**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

Moguƒáe je identifikovati da li, i koliko, **WebSocket konekcija koristi ciljana stranica**. To omoguƒáava napadaƒçu da detektuje stanja aplikacije i otkrije informacije vezane za broj WebSocket konekcija.

Ako jedan **domen** koristi **maksimalan broj WebSocket** objekata konekcije, bez obzira na stanje njihovih konekcija, kreiranje **novih objekata ƒáe rezultirati JavaScript izuzecima**. Da bi izvr≈°io ovaj napad, napadaƒçev sajt otvara ciljani sajt u iskaƒçuƒáem prozoru ili iframe-u, a zatim, nakon ≈°to se ciljana web stranica uƒçita, poku≈°ava da kreira maksimalan broj WebSocket konekcija. **Broj izbaƒçenih izuzetaka** je **broj WebSocket konekcija koje koristi ciljana web stranica**.

### Payment API

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: Detektovanje Payment Request jer samo jedan mo≈æe biti aktivan u isto vreme.
* **Code Example**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

Ova XS-Curenje omoguƒáava napadaƒçu da **detektuje kada stranica sa drugog domena inicira zahtev za plaƒáanje**.

Po≈°to **samo jedan zahtev za plaƒáanje mo≈æe biti aktivan** u isto vreme, ako ciljana web stranica koristi Payment Request API, svaki dalji poku≈°aj kori≈°ƒáenja ovog API-ja ƒáe propasti i izazvati **JavaScript izuzetak**. Napadaƒç mo≈æe iskoristiti ovo tako ≈°to ƒáe **periodiƒçno poku≈°avati da prika≈æe UI Payment API**. Ako jedan poku≈°aj izazove izuzetak, ciljana web stranica ga trenutno koristi. Napadaƒç mo≈æe sakriti ove periodiƒçne poku≈°aje tako ≈°to ƒáe odmah zatvoriti UI nakon kreiranja.

### Timing the Event Loop <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **Summary:** Merenje vremena izvr≈°enja web-a zloupotrebljavajuƒái jednonitni JS event loop.
* **Code Example**:

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript funkcioni≈°e na [jednonitnom event loop](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop) modelu konkurencije, ≈°to znaƒçi da **mo≈æe izvr≈°iti samo jedan zadatak u isto vreme**. Ova karakteristika se mo≈æe iskoristiti za merenje **koliko dugo kod sa drugog domena traje da se izvr≈°i**. Napadaƒç mo≈æe meriti vreme izvr≈°enja svog koda u event loop-u kontinuiranim slanjem dogaƒëaja sa fiksnim svojstvima. Ovi dogaƒëaji ƒáe biti obraƒëeni kada je event pool prazan. Ako drugi domeni takoƒëe ≈°alju dogaƒëaje u isti pool, **napadaƒç mo≈æe da zakljuƒçi vreme koje je potrebno za izvr≈°avanje ovih spolja≈°njih dogaƒëaja posmatrajuƒái ka≈°njenja u izvr≈°enju svojih zadataka**. Ova metoda praƒáenja event loop-a za ka≈°njenja mo≈æe otkriti vreme izvr≈°enja koda sa razliƒçitih domena, potencijalno izla≈æuƒái osetljive informacije.

{% hint style="warning" %}
U merenju vremena izvr≈°enja moguƒáe je **eliminisati** **mre≈æne faktore** kako bi se dobile **preciznije merenja**. Na primer, uƒçitavanjem resursa koji se koriste na stranici pre njenog uƒçitavanja.
{% endhint %}

### Busy Event Loop <a href="#busy-event-loop" id="busy-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **Summary:** Jedna metoda za merenje vremena izvr≈°enja web operacije ukljuƒçuje namerno blokiranje event loop-a niti i zatim merenje **koliko dugo je potrebno da event loop ponovo postane dostupan**. Umetanjem blokirajuƒáe operacije (kao ≈°to je dugaƒçka raƒçunica ili sinhroni API poziv) u event loop, i praƒáenjem vremena koje je potrebno da zapoƒçnu izvr≈°enje naredni kod, mo≈æe se zakljuƒçiti trajanje zadataka koji su se izvr≈°avali u event loop-u tokom blokirajuƒáeg perioda. Ova tehnika koristi jednonitnu prirodu JavaScript-ovog event loop-a, gde se zadaci izvr≈°avaju sekvencijalno, i mo≈æe pru≈æiti uvide u performanse ili pona≈°anje drugih operacija koje dele istu nit.
* **Code Example**:

Znaƒçajna prednost tehnike merenja vremena izvr≈°enja blokiranjem event loop-a je njena potencijalna sposobnost da zaobiƒëe **Site Isolation**. **Site Isolation** je bezbednosna funkcija koja razdvaja razliƒçite web stranice u odvojene procese, s ciljem da spreƒçi zlonamerne sajtove da direktno pristupaju osetljivim podacima sa drugih sajtova. Meƒëutim, utiƒçuƒái na vreme izvr≈°enja drugog domena kroz zajedniƒçki event loop, napadaƒç mo≈æe indirektno izvuƒái informacije o aktivnostima tog domena. Ova metoda ne zavisi od direktnog pristupa podacima drugog domena, veƒá posmatra uticaj aktivnosti tog domena na zajedniƒçki event loop, ƒçime se izbegavaju za≈°titne barijere koje postavlja **Site Isolation**.

{% hint style="warning" %}
U merenju vremena izvr≈°enja moguƒáe je **eliminisati** **mre≈æne faktore** kako bi se dobila **preciznija merenja**. Na primer, uƒçitavanjem resursa koji se koriste na stranici pre njenog uƒçitavanja.
{% endhint %}

### Connection Pool

* **Inclusion Methods**: JavaScript Requests
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **Summary:** Napadaƒç mo≈æe zakljuƒçati sve sokete osim 1, uƒçitati ciljani web i u isto vreme uƒçitati drugu stranicu, vreme do kada se poslednja stranica poƒçinje uƒçitavati je vreme koje je ciljana stranica uzela da se uƒçita.
* **Code Example**:

{% content-ref url="xs-search/connection-pool-example.md" %}
[connection-pool-example.md](xs-search/connection-pool-example.md)
{% endcontent-ref %}

Pregledaƒçi koriste sokete za komunikaciju sa serverom, ali zbog ograniƒçenih resursa operativnog sistema i hardvera, **pregledaƒçi su primorani da postave limit** na broj istovremenih soketa. Napadaƒçi mogu iskoristiti ovo ograniƒçenje kroz sledeƒáe korake:

1. Utvrditi limit soketa pregledaƒça, na primer, 256 globalnih soketa.
2. Zauzeti 255 soketa na du≈æi period pokretanjem 255 zahteva ka razliƒçitim hostovima, dizajniranim da dr≈æe konekcije otvorenim bez zavr≈°avanja.
3. Iskoristiti 256. soket za slanje zahteva ka ciljanom sajtu.
4. Poku≈°ati 257. zahtev ka drugom hostu. S obzirom na to da su svi soketi u upotrebi (prema koracima 2 i 3), ovaj zahtev ƒáe biti u redu dok ne postane dostupan soket. Ka≈°njenje pre nego ≈°to ovaj zahtev proƒëe daje napadaƒçu informaciju o vremenu mre≈æne aktivnosti vezane za 256. soket (soket ciljanog sajta). Ova inferencija je moguƒáa jer je 255 soketa iz koraka 2 jo≈° uvek anga≈æovano, ≈°to implicira da bilo koji novodostupni soket mora biti onaj osloboƒëen iz koraka 3. Vreme koje je potrebno da 256. soket postane dostupan je tako direktno povezano sa vremenom potrebnim da zahtev ka ciljanom sajtu zavr≈°i.

Za vi≈°e informacija: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)

### Connection Pool by Destination

* **Inclusion Methods**: JavaScript Requests
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**:
* **Summary:** Sliƒçno prethodnoj tehnici, ali umesto kori≈°ƒáenja svih soketa, Google **Chrome** postavlja limit od **6 istovremenih zahteva ka istom domenu**. Ako **blokiramo 5** i zatim **pokrenemo 6.** zahtev, mo≈æemo **izmeriti** vreme, a ako uspemo da nateramo **stranicu ≈ærtve da po≈°alje** vi≈°e **zahteva** ka istom kraju da detektujemo **status** **stranice**, **6. zahtev** ƒáe trajati **du≈æe** i mo≈æemo to detektovati.

## Performance API Techniques

[`Performance API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) nudi uvide u performanse web aplikacija, dodatno obogaƒáene [`Resource Timing API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API). Resource Timing API omoguƒáava praƒáenje detaljnih vremena mre≈ænih zahteva, kao ≈°to je trajanje zahteva. Znaƒçajno je da kada serveri ukljuƒçuju `Timing-Allow-Origin: *` zaglavlje u svojim odgovorima, dodatni podaci poput veliƒçine prenosa i vremena pretrage domena postaju dostupni.

Ova bogatstvo podataka mo≈æe se dobiti putem metoda kao ≈°to su [`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries) ili [`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName), pru≈æajuƒái sveobuhvatan pregled informacija vezanih za performanse. Pored toga, API olak≈°ava merenje vremena izvr≈°enja izraƒçunavanjem razlike izmeƒëu vremenskih oznaka dobijenih iz [`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now). Meƒëutim, vredi napomenuti da za odreƒëene operacije u pregledaƒçima poput Chrome-a, preciznost `performance.now()` mo≈æe biti ograniƒçena na milisekunde, ≈°to mo≈æe uticati na granularnost merenja vremena.

Pored merenja vremena, Performance API se mo≈æe iskoristiti za uvide vezane za bezbednost. Na primer, prisustvo ili odsustvo stranica u `performance` objektu u Chrome-u mo≈æe ukazivati na primenu `X-Frame-Options`. Konkretno, ako je stranica blokirana od renderovanja u okviru zbog `X-Frame-Options`, ona neƒáe biti zabele≈æena u `performance` objektu, pru≈æajuƒái suptilan trag o politikama uokvirivanja stranice.

### Error Leak

* **Inclusion Methods**: Frames, HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Zahtev koji rezultira gre≈°kama neƒáe kreirati unos vremena resursa.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

Moguƒáe je **razlikovati izmeƒëu HTTP status kodova** jer zahtevi koji dovode do **gre≈°ke** ne **kreiraju unos performansi**.

### Style Reload Error

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Zbog gre≈°ke u pregledaƒçu, zahtevi koji rezultiraju gre≈°kama se uƒçitavaju dvaput.
* **Code Example**: [https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

U prethodnoj tehnici takoƒëe su identifikovana dva sluƒçaja gde gre≈°ke u GC dovode do **uƒçitavanja resursa dvaput kada ne uspeju da se uƒçitaju**. To ƒáe rezultirati vi≈°estrukim unosima u Performance API i tako se mo≈æe detektovati.

### Request Merging Error

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Zahtevi koji rezultiraju gre≈°kom ne mogu se spojiti.
* **Code Example**: [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

Tehnika je pronaƒëena u tabeli u pomenutom radu, ali nije pronaƒëen opis tehnike. Meƒëutim, mo≈æete pronaƒái izvorni kod koji to proverava na [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

### Empty Page Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Prazni odgovori ne kreiraju unose vremena resursa.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

Napadaƒç mo≈æe detektovati da li je zahtev rezultirao praznim HTTP odgovorom jer **prazne stranice ne kreiraju unos performansi u nekim pregledaƒçima**.

### **XSS-Auditor Leak**

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Kori≈°ƒáenjem XSS Auditor-a u Bezbednosnim Asocijacijama, napadaƒçi mogu detektovati specifiƒçne elemente web stranice posmatrajuƒái promene u odgovorima kada kreirani payload-ovi aktiviraju mehanizam filtriranja auditor-a.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

U Bezbednosnim Asocijacijama (SA), XSS Auditor, prvobitno namenjen spreƒçavanju napada Cross-Site Scripting (XSS), mo≈æe paradoksalno biti iskori≈°ƒáen za curenje osetljivih informacija. Iako je ova ugraƒëena funkcija uklonjena iz Google Chrome-a (GC), jo≈° uvek je prisutna u SA. Godine 2013, Braun i Heiderich su pokazali da XSS Auditor mo≈æe nenamerno blokirati legitimne skripte, dovodeƒái do la≈ænih pozitivnih rezultata. Oslanjajuƒái se na ovo, istra≈æivaƒçi su razvili tehnike za ekstrakciju informacija i detekciju specifiƒçnog sadr≈æaja na stranicama sa drugog domena, koncept poznat kao XS-Curenja, prvobitno izve≈°tavan od strane Terade i razraƒëen od strane Heyesa u blog postu. Iako su ove tehnike bile specifiƒçne za XSS Auditor u GC, otkriveno je da u SA, stranice blokirane od strane XSS Auditor-a ne generi≈°u unose u Performance API, otkrivajuƒái metodu putem koje bi osetljive informacije mogle i dalje biti otkrivene.

### X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **Summary:** Resurs sa X-Frame-Options zaglavljem ne kreira unos vremena resursa.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

Ako stranica **nije dozvoljena** da bude **renderovana** u **iframe-u**, ona ne **kreira unos performansi**. Kao rezultat, napadaƒç mo≈æe detektovati zaglavlje odgovora **`X-Frame-Options`**.\
Isto se de≈°ava ako koristite **embed** **tag.**

### Download Detection

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Preuzimanja ne kreiraju unose vremena resursa u Performance API.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

Sliƒçno, kao ≈°to je opisano u XS-Curenju, **resurs koji se preuzima** zbog zaglavlja ContentDisposition, takoƒëe ne **kreira unos performansi**. Ova tehnika funkcioni≈°e u svim glavnim pregledaƒçima.

### Redirect Start Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Redirect
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Unos vremena resursa curi vreme poƒçetka preusmeravanja.
* **Code Example**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

Prona≈°li smo jedan primer XS-Curenja koji zloupotrebljava pona≈°anje nekih pregledaƒça koji bele≈æe previ≈°e informacija za zahteve sa drugih domena. Standard defini≈°e podskup atributa koji bi trebali biti postavljeni na nulu za resurse sa drugih domena. Meƒëutim, u **SA** je moguƒáe detektovati da li je korisnik **preusmeren** od strane ciljne stranice, upitivanjem **Performance API** i proverom za **redirectStart vremenske podatke**.

### Duration Redirect Leak

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Redirect
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Trajanje unosa vremena je negativno kada doƒëe do preusmeravanja.
* **Code Example**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

U GC, **trajanje** za zahteve koji rezultiraju **preusmeravanjem** je **negativno** i tako se mo≈æe **razlikovati** od zahteva koji ne rezultiraju preusmeravanjem.

### CORP Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** Resurs za≈°tiƒáen CORP-om ne kreira unose vremena resursa.
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

U nekim sluƒçajevima, **nextHopProtocol unos** mo≈æe se koristiti kao tehnika curenja. U GC, kada je **CORP zaglavlje** postavljeno, nextHopProtocol ƒáe biti **prazan**. Imajte na umu da SA neƒáe uop≈°te kreirati unos performansi za resurse omoguƒáene CORP-om.

### Service Worker

* **Inclusion Methods**: Frames
* **Detectable Difference**: API Usage
* **More info**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **Summary:** Detektovati da li je servisni radnik registrovan za odreƒëeni domen.
* **Code Example**:

Servisni radnici su skriptni konteksti voƒëeni dogaƒëajima koji se izvr≈°avaju na jednom domenu. Oni rade u pozadini web stranice i mogu presresti, modifikovati i **ke≈°irati resurse** kako bi stvorili offline web aplikaciju.\
Ako je **resurs ke≈°iran** od strane **servisnog radnika** pristupljen putem **iframe-a**, resurs ƒáe biti **uƒçitan iz ke≈°a servisnog radnika**.\
Da bi se detektovalo da li je resurs **uƒçitan iz ke≈°a servisnog radnika**, mo≈æe se koristiti **Performance API**.\
To se takoƒëe mo≈æe uraditi sa napadom na vreme (proverite rad za vi≈°e informacija).

### Cache

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **Summary:** Moguƒáe je proveriti da li je resurs saƒçuvan u ke≈°u.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

Kori≈°ƒáenjem [Performance API](xs-search.md#performance-api) moguƒáe je proveriti da li je resurs ke≈°iran.

### Network Duration

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **Summary:** Moguƒáe je dobiti mre≈æno trajanje zahteva iz `performance` API.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## Error Messages Technique

### Media Error

* **Inclusion Methods**: HTML Elements (Video, Audio)
* **Detectable Difference**: Status Code
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **Summary:** U Firefox-u je moguƒáe precizno curenje status koda zahteva sa drugog domena.
* **Code Example**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
The `MediaError` –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å –∏–º–∞ —Å–≤–æ—ò—Å—Ç–≤–æ –ø–æ—Ä—É–∫–µ –∫–æ—ò–µ —ò–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫—É—ò–µ —Ä–µ—Å—É—Ä—Å–µ –∫–æ—ò–∏ —Å–µ —É—Å–ø–µ—à–Ω–æ —É—á–∏—Ç–∞–≤–∞—ò—É —Å–∞ —Ä–∞–∑–ª–∏—á–∏—Ç–∏–º –Ω–∏–∑–æ–º. –ù–∞–ø–∞–¥–∞—á –º–æ–∂–µ –∏—Å–∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –æ–≤—É —Ñ—É–Ω–∫—Ü–∏—ò—É –ø–æ—Å–º–∞—Ç—Ä–∞—ò—É—õ–∏ —Å–∞–¥—Ä–∂–∞—ò –ø–æ—Ä—É–∫–µ, —á–∏–º–µ –º–æ–∂–µ –∑–∞–∫—ô—É—á–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –æ–¥–≥–æ–≤–æ—Ä–∞ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–æ–≥ —Ä–µ—Å—É—Ä—Å–∞.

### CORS Gre≈°ka

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **–†–µ–∑–∏–º–µ:** –£ –ë–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏–º –¢–≤—Ä—í–µ—ö–∏–º–∞ (SA), CORS –ø–æ—Ä—É–∫–µ –æ –≥—Ä–µ—à–∫–∞–º–∞ –Ω–µ–Ω–∞–º–µ—Ä–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞—ò—É –ø—É–Ω–∏ URL –ø—Ä–µ—É—Å–º–µ—Ä–µ–Ω–∏—Ö –∑–∞—Ö—Ç–µ–≤–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

–û–≤–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –æ–º–æ–≥—É—õ–∞–≤–∞ –Ω–∞–ø–∞–¥–∞—á—É –¥–∞ **–∏–∑–≤—É—á–µ –æ–¥—Ä–µ–¥–∏—à—Ç–µ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–µ –ª–æ–∫–∞—Ü–∏—ò–µ** –∏—Å–∫–æ—Ä–∏—à—õ–∞–≤–∞—ò—É—õ–∏ –Ω–∞—á–∏–Ω –Ω–∞ –∫–æ—ò–∏ Webkit-–±–∞–∑–∏—Ä–∞–Ω–∏ –ø—Ä–µ–≥–ª–µ–¥–∞—á–∏ –æ–±—Ä–∞—í—É—ò—É CORS –∑–∞—Ö—Ç–µ–≤–µ. –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ, –∫–∞–¥–∞ —Å–µ **CORS-–æ–º –æ–º–æ–≥—É—õ–µ–Ω –∑–∞—Ö—Ç–µ–≤** –ø–æ—à–∞—ô–µ –Ω–∞ —Ü–∏—ô–Ω—É –ª–æ–∫–∞—Ü–∏—ò—É –∫–æ—ò–∞ –∏–∑–¥–∞—ò–µ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ –Ω–∞ –æ—Å–Ω–æ–≤—É —Å—Ç–∞—ö–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞, –∞ –ø—Ä–µ–≥–ª–µ–¥–∞—á –∫–∞—Å–Ω–∏—ò–µ –æ–¥–±–∏—ò–µ –∑–∞—Ö—Ç–µ–≤, **–ø—É–Ω–∏ URL —Ü–∏—ô–∞ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞** —Å–µ –æ—Ç–∫—Ä–∏–≤–∞ —É –ø–æ—Ä—É—Ü–∏ –æ –≥—Ä–µ—à—Ü–∏. –û–≤–∞ —Ä–∞—ö–∏–≤–æ—Å—Ç –Ω–µ —Å–∞–º–æ –¥–∞ –æ—Ç–∫—Ä–∏–≤–∞ —á–∏—ö–µ–Ω–∏—Ü—É –æ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö—É, –≤–µ—õ –∏ –æ—Ç–∫—Ä–∏–≤–∞ –∫—Ä–∞—ò—ö—É —Ç–∞—á–∫—É –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –∏ —Å–≤–µ **–æ—Å–µ—Ç—ô–∏–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —É–ø–∏—Ç–∞** –∫–æ—ò–µ –º–æ–∂–µ —Å–∞–¥—Ä–∂–∞—Ç–∏.

### SRI Gre≈°ka

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **–†–µ–∑–∏–º–µ:** –£ –ë–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏–º –¢–≤—Ä—í–µ—ö–∏–º–∞ (SA), CORS –ø–æ—Ä—É–∫–µ –æ –≥—Ä–µ—à–∫–∞–º–∞ –Ω–µ–Ω–∞–º–µ—Ä–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞—ò—É –ø—É–Ω–∏ URL –ø—Ä–µ—É—Å–º–µ—Ä–µ–Ω–∏—Ö –∑–∞—Ö—Ç–µ–≤–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

–ù–∞–ø–∞–¥–∞—á –º–æ–∂–µ –∏—Å–∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ **–æ–ø—à–∏—Ä–Ω–µ –ø–æ—Ä—É–∫–µ –æ –≥—Ä–µ—à–∫–∞–º–∞** –¥–∞ –∑–∞–∫—ô—É—á–∏ –≤–µ–ª–∏—á–∏–Ω—É –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–∏—Ö –æ–¥–≥–æ–≤–æ—Ä–∞. –û–≤–æ —ò–µ –º–æ–≥—É—õ–µ –∑–±–æ–≥ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ò–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞ –ü–æ–¥—Ä–µ—Å—É—Ä—Å–∞ (SRI), –∫–æ—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞ –¥–∞ –ø–æ—Ç–≤—Ä–¥–∏ –¥–∞ —Ä–µ—Å—É—Ä—Å–∏ –ø—Ä–µ—É–∑–µ—Ç–∏, —á–µ—Å—Ç–æ –∏–∑ CDN-–æ–≤–∞, –Ω–∏—Å—É –º–æ–¥–∏—Ñ–∏–∫–æ–≤–∞–Ω–∏. –î–∞ –±–∏ SRI —Ä–∞–¥–∏–æ –Ω–∞ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∏–º–∞, –æ–Ω–∏ –º–æ—Ä–∞—ò—É –±–∏—Ç–∏ **CORS-–æ–º –æ–º–æ–≥—É—õ–µ–Ω–∏**; —É –ø—Ä–æ—Ç–∏–≤–Ω–æ–º, –Ω–∏—Å—É –ø–æ–¥–ª–æ–∂–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∞–º–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞. –£ –ë–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏–º –¢–≤—Ä—í–µ—ö–∏–º–∞ (SA), —Å–ª–∏—á–Ω–æ –∫–∞–æ CORS –≥—Ä–µ—à–∫–∞ XS-Leak, –ø–æ—Ä—É–∫–∞ –æ –≥—Ä–µ—à—Ü–∏ –º–æ–∂–µ –±–∏—Ç–∏ —É—Ö–≤–∞—õ–µ–Ω–∞ –Ω–∞–∫–æ–Ω —à—Ç–æ –∑–∞—Ö—Ç–µ–≤ –∑–∞ –ø—Ä–µ—É–∑–∏–º–∞—ö–µ —Å–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–º –∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞ –Ω–µ —É—Å–ø–µ. –ù–∞–ø–∞–¥–∞—á–∏ –º–æ–≥—É –Ω–∞–º–µ—Ä–Ω–æ **–∏–∑–∞–∑–≤–∞—Ç–∏ –æ–≤—É –≥—Ä–µ—à–∫—É** –¥–æ–¥–µ—ô—É—ò—É—õ–∏ **–ª–∞–∂–Ω—É —Ö–µ—à –≤—Ä–µ–¥–Ω–æ—Å—Ç** –∞—Ç—Ä–∏–±—É—Ç—É –∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞ –±–∏–ª–æ –∫–æ–≥ –∑–∞—Ö—Ç–µ–≤–∞. –£ SA, —Ä–µ–∑—É–ª—Ç—É—ò—É—õ–∞ –ø–æ—Ä—É–∫–∞ –æ –≥—Ä–µ—à—Ü–∏ –Ω–µ–Ω–∞–º–µ—Ä–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞ –¥—É–∂–∏–Ω—É —Å–∞–¥—Ä–∂–∞—ò–∞ –∑–∞—Ö—Ç–µ–≤–∞–Ω–æ–≥ —Ä–µ—Å—É—Ä—Å–∞. –û–≤–æ curenje –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ–º–æ–≥—É—õ–∞–≤–∞ –Ω–∞–ø–∞–¥–∞—á—É –¥–∞ —Ä–∞–∑–ª–∏–∫—É—ò–µ –≤–∞—Ä–∏—ò–∞—Ü–∏—ò–µ —É –≤–µ–ª–∏—á–∏–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∞, –æ—Ç–≤–∞—Ä–∞—ò—É—õ–∏ –ø—É—Ç –∑–∞ —Å–ª–æ–∂–µ–Ω–µ XS-Leak –Ω–∞–ø–∞–¥–µ.

### CSP –ü–æ–≤—Ä–µ–¥–∞/–î–µ—Ç–µ–∫—Ü–∏—ò–∞

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **–†–µ–∑–∏–º–µ:** –î–æ–∑–≤–æ—ô–∞–≤–∞—ò—É—õ–∏ —Å–∞–º–æ –≤–µ–± –ª–æ–∫–∞—Ü–∏—ò—É –∂—Ä—Ç–≤–µ —É CSP-—É, –∞–∫–æ –ø–æ–∫—É—à–∞ –¥–∞ –ø—Ä–µ—É—Å–º–µ—Ä–∏ –Ω–∞ –¥—Ä—É–≥—É –¥–æ–º–µ–Ω—É, CSP —õ–µ –∞–∫—Ç–∏–≤–∏—Ä–∞—Ç–∏ —É–æ—á—ô–∏–≤—É –≥—Ä–µ—à–∫—É.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

XS-Leak –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ CSP –¥–∞ –¥–µ—Ç–µ–∫—Ç—É—ò–µ –¥–∞ –ª–∏ —ò–µ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–∞ –ª–æ–∫–∞—Ü–∏—ò–∞ –ø—Ä–µ—É—Å–º–µ—Ä–µ–Ω–∞ –Ω–∞ –¥—Ä—É–≥—É –ª–æ–∫–∞—Ü–∏—ò—É. –û–≤–∞—ò leak –º–æ–∂–µ –¥–µ—Ç–µ–∫—Ç–æ–≤–∞—Ç–∏ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ, –∞–ª–∏ –ø–æ—Ä–µ–¥ —Ç–æ–≥–∞, –¥–æ–º–µ–Ω —Ü–∏—ô–∞ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ —Å–µ –æ—Ç–∫—Ä–∏–≤–∞. –û—Å–Ω–æ–≤–Ω–∞ –∏–¥–µ—ò–∞ –æ–≤–æ–≥ –Ω–∞–ø–∞–¥–∞ —ò–µ –¥–∞ **–¥–æ–∑–≤–æ–ª–∏ —Ü–∏—ô–Ω–∏ –¥–æ–º–µ–Ω –Ω–∞ –ª–æ–∫–∞—Ü–∏—ò–∏ –Ω–∞–ø–∞–¥–∞—á–∞**. –ö–∞–¥–∞ —Å–µ –∏–∑–¥–∞ –∑–∞—Ö—Ç–µ–≤ –∑–∞ —Ü–∏—ô–Ω–∏ –¥–æ–º–µ–Ω, –æ–Ω **–ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞** –Ω–∞ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–∏ –¥–æ–º–µ–Ω. **CSP –±–ª–æ–∫–∏—Ä–∞** –ø—Ä–∏—Å—Ç—É–ø —Ç–æ–º–µ –∏ –≥–µ–Ω–µ—Ä–∏—à–µ **–∏–∑–≤–µ—à—Ç–∞—ò –æ –ø–æ–≤—Ä–µ–¥–∏ –∫–æ—ò–∏ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∫–∞–æ —Ç–µ—Ö–Ω–∏–∫–∞ curenja**. –£ –∑–∞–≤–∏—Å–Ω–æ—Å—Ç–∏ –æ–¥ –ø—Ä–µ–≥–ª–µ–¥–∞—á–∞, **–æ–≤aj –∏–∑–≤–µ—à—Ç–∞—ò –º–æ–∂–µ –æ—Ç–∫—Ä–∏—Ç–∏ —Ü–∏—ô–Ω—É –ª–æ–∫–∞—Ü–∏—ò—É –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞**.\
–°–∞–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–µ–≥–ª–µ–¥–∞—á–∏ –Ω–µ—õ–µ —É–∫–∞–∑–∞—Ç–∏ –Ω–∞ URL –Ω–∞ –∫–æ—ò–∏ —ò–µ –ø—Ä–µ—É—Å–º–µ—Ä–µ–Ω–æ, –∞–ª–∏ –∏ –¥–∞—ô–µ –º–æ–∂–µ—Ç–µ –¥–µ—Ç–µ–∫—Ç–æ–≤–∞—Ç–∏ –¥–∞ —ò–µ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–æ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–æ.

### Ke≈°

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –§—Ä–µ–π–º–æ–≤–∏, –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –°–∞–¥—Ä–∂–∞—ò —Å—Ç—Ä–∞–Ω–∏—Ü–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **–†–µ–∑–∏–º–µ:** –û—á–∏—Å—Ç–∏—Ç–µ –¥–∞—Ç–æ—Ç–µ–∫—É –∏–∑ –∫–µ—à–∞. –û—Ç–≤–∞—Ä–∞ —Ü–∏—ô–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ–≤–µ—Ä–∞–≤–∞ –¥–∞ –ª–∏ —ò–µ –¥–∞—Ç–æ—Ç–µ–∫–∞ –ø—Ä–∏—Å—É—Ç–Ω–∞ —É –∫–µ—à—É.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

–ü—Ä–µ–≥–ª–µ–¥–∞—á–∏ –º–æ–≥—É –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —ò–µ–¥–∞–Ω zajedniƒçki –∫–µ—à –∑–∞ —Å–≤–µ –≤–µ–± –ª–æ–∫–∞—Ü–∏—ò–µ. –ë–µ–∑ –æ–±–∑–∏—Ä–∞ –Ω–∞ —ö–∏—Ö–æ–≤ –∏–∑–≤–æ—Ä, –º–æ–≥—É—õ–µ —ò–µ –∑–∞–∫—ô—É—á–∏—Ç–∏ –¥–∞ –ª–∏ —ò–µ —Ü–∏—ô–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **–∑–∞—Ö—Ç–µ–≤–∞–ª–∞ –æ–¥—Ä–µ—í–µ–Ω—É –¥–∞—Ç–æ—Ç–µ–∫—É**.

–ê–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É—á–∏—Ç–∞ —Å–ª–∏–∫—É —Å–∞–º–æ –∞–∫–æ —ò–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –ø—Ä–∏—ò–∞–≤—ô–µ–Ω, –º–æ–∂–µ—Ç–µ **–Ω–µ–≤–∞–∂–µ—õ–∏** **—Ä–µ—Å—É—Ä—Å** (—Ç–∞–∫–æ –¥–∞ –≤–∏—à–µ –Ω–∏—ò–µ –∫–µ—à–∏—Ä–∞–Ω –∞–∫–æ —ò–µ –±–∏–æ, –ø–æ–≥–ª–µ–¥–∞—ò—Ç–µ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞), **–∏–∑–≤—Ä—à–∏—Ç–∏ –∑–∞—Ö—Ç–µ–≤** –∫–æ—ò–∏ –±–∏ –º–æ–≥–∞–æ —É—á–∏—Ç–∞—Ç–∏ —Ç–∞—ò —Ä–µ—Å—É—Ä—Å –∏ –ø–æ–∫—É—à–∞—Ç–∏ –¥–∞ —É—á–∏—Ç–∞ —Ä–µ—Å—É—Ä—Å **—Å–∞ –ª–æ—à–∏–º –∑–∞—Ö—Ç–µ–≤–æ–º** (–Ω–ø—Ä. –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –ø—Ä–µ–∫–æ–º–µ—Ä–Ω–æ –¥—É–≥ –∑–∞–≥–ª–∞–≤—ô–µ —Ä–µ—Ñ–µ—Ä–µ—Ä–∞). –ê–∫–æ —É—á–∏—Ç–∞–≤–∞—ö–µ —Ä–µ—Å—É—Ä—Å–∞ **–Ω–∏—ò–µ –∞–∫—Ç–∏–≤–∏—Ä–∞–ª–æ –Ω–∏—ò–µ–¥–Ω—É –≥—Ä–µ—à–∫—É**, —Ç–æ —ò–µ –∑–∞—Ç–æ —à—Ç–æ —ò–µ **–∫–µ—à–∏—Ä–∞–Ω**.

### CSP –î–∏—Ä–µ–∫—Ç–∏–≤–∞

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –§—Ä–µ–π–º–æ–≤–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **–†–µ–∑–∏–º–µ:** CSP –∑–∞–≥–ª–∞–≤—ô–µ –¥–∏—Ä–µ–∫—Ç–∏–≤–µ –º–æ–≥—É —Å–µ –∏—Å–ø–∏—Ç–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ CSP iframe –∞—Ç—Ä–∏–±—É—Ç, –æ—Ç–∫—Ä–∏–≤–∞—ò—É—õ–∏ –¥–µ—Ç–∞—ô–µ –ø–æ–ª–∏—Ç–∏–∫–µ.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

–ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ —É Google Chrome (GC) –æ–º–æ–≥—É—õ–∞–≤–∞ –≤–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∞ –¥–∞ **–ø—Ä–µ–¥–ª–æ–∂–µ –ü–æ–ª–∏—Ç–∏–∫—É –ë–µ–∑–±–µ–¥–Ω–æ—Å—Ç–∏ –°–∞–¥—Ä–∂–∞—ò–∞ (CSP)** –ø–æ—Å—Ç–∞–≤—ô–∞—ö–µ–º –∞—Ç—Ä–∏–±—É—Ç–∞ –Ω–∞ iframe –µ–ª–µ–º–µ–Ω—Ç, —Å–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞–º–∞ –ø–æ–ª–∏—Ç–∏–∫–µ –∫–æ—ò–µ —Å–µ –ø—Ä–µ–Ω–æ—Å–µ –∑–∞—ò–µ–¥–Ω–æ —Å–∞ HTTP –∑–∞—Ö—Ç–µ–≤–æ–º. –û–±–∏—á–Ω–æ, —É–≥—Ä–∞—í–µ–Ω–∏ —Å–∞–¥—Ä–∂–∞—ò –º–æ—Ä–∞ **–¥–∞ –æ–≤–ª–∞—Å—Ç–∏ –æ–≤–æ –ø—Ä–µ–∫–æ HTTP –∑–∞–≥–ª–∞–≤—ô–∞**, –∏–ª–∏ —Å–µ **–ø—Ä–∏–∫–∞–∑—É—ò–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ –≥—Ä–µ—à—Ü–∏**. –ú–µ—í—É—Ç–∏–º, –∞–∫–æ —ò–µ iframe –≤–µ—õ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–æ–º CSP-–∞ –∏ –Ω–æ–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ –Ω–∏—ò–µ —Å—Ç—Ä–æ–∂–∞, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —õ–µ —Å–µ —É—á–∏—Ç–∞—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ. –û–≤–∞—ò –º–µ—Ö–∞–Ω–∏–∑–∞–º –æ—Ç–≤–∞—Ä–∞ –ø—É—Ç –∑–∞ –Ω–∞–ø–∞–¥–∞—á–∞ –¥–∞ **–æ—Ç–∫—Ä–∏—ò–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–µ CSP –¥–∏—Ä–µ–∫—Ç–∏–≤–µ** –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–æ–≤–∞—ö–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ –≥—Ä–µ—à—Ü–∏. –ò–∞–∫–æ —ò–µ –æ–≤–∞ —Ä–∞—ö–∏–≤–æ—Å—Ç –æ–±–µ–ª–µ–∂–µ–Ω–∞ –∫–∞–æ –∏—Å–ø—Ä–∞–≤—ô–µ–Ω–∞, –Ω–∞—à–∞ –æ—Ç–∫—Ä–∏—õ–∞ –æ—Ç–∫—Ä–∏–≤–∞—ò—É **–Ω–æ–≤—É —Ç–µ—Ö–Ω–∏–∫—É curenja** —Å–ø–æ—Å–æ–±–Ω—É –¥–∞ –¥–µ—Ç–µ–∫—Ç—É—ò–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ –≥—Ä–µ—à—Ü–∏, —à—Ç–æ —Å—É–≥–µ—Ä–∏—à–µ –¥–∞ –ø—Ä–æ–±–ª–µ–º –Ω–∏—ò–µ –Ω–∏–∫–∞–¥–∞ —É –ø–æ—Ç–ø—É–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω.

### **CORP**

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **–†–µ–∑–∏–º–µ:** –†–µ—Å—É—Ä—Å–∏ –∑–∞—à—Ç–∏—õ–µ–Ω–∏ –ü–æ–ª–∏—Ç–∏–∫–æ–º –†–µ—Å—É—Ä—Å–∞ –ö—Ä–æ—Å-–ò–∑–≤–æ—Ä–∞ (CORP) —õ–µ –∏–∑–∞–∑–≤–∞—Ç–∏ –≥—Ä–µ—à–∫—É –∫–∞–¥–∞ —Å–µ –ø—Ä–µ—É–∑–º—É –∏–∑ –Ω–µ–¥–æ–∑–≤–æ—ô–µ–Ω–æ–≥ –∏–∑–≤–æ—Ä–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORP –∑–∞–≥–ª–∞–≤—ô–µ —ò–µ —Ä–µ–ª–∞—Ç–∏–≤–Ω–æ –Ω–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç–∏ –≤–µ–± –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –∫–æ—ò–∞, –∫–∞–¥–∞ —ò–µ –ø–æ—Å—Ç–∞–≤—ô–µ–Ω–∞, **–±–ª–æ–∫–∏—Ä–∞ no-cors –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–µ –∑–∞—Ö—Ç–µ–≤–µ –∑–∞ –¥–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å**. –ü—Ä–∏—Å—É—Å—Ç–≤–æ –∑–∞–≥–ª–∞–≤—ô–∞ –º–æ–∂–µ —Å–µ –¥–µ—Ç–µ–∫—Ç–æ–≤–∞—Ç–∏, —ò–µ—Ä —Ä–µ—Å—É—Ä—Å –∑–∞—à—Ç–∏—õ–µ–Ω CORP **–∏–∑–∞–∑–∏–≤–∞ –≥—Ä–µ—à–∫—É –∫–∞–¥–∞ —Å–µ –ø—Ä–µ—É–∑–º–µ**.

### CORB

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: HTML –ï–ª–µ–º–µ–Ω—Ç–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **–†–µ–∑–∏–º–µ**: CORB –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –Ω–∞–ø–∞–¥–∞—á–∏–º–∞ –¥–∞ –¥–µ—Ç–µ–∫—Ç—É—ò—É –∫–∞–¥–∞ —ò–µ **`nosniff` –∑–∞–≥–ª–∞–≤—ô–µ –ø—Ä–∏—Å—É—Ç–Ω–æ** —É –∑–∞—Ö—Ç–µ–≤—É.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

–ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –ª–∏–Ω–∫ –∑–∞ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ –Ω–∞–ø–∞–¥—É.

### CORS –≥—Ä–µ—à–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∏ –æ–¥—Ä–∞–∑–∞ –ø–æ—Ä–µ–∫–ª–∞ <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **–†–µ–∑–∏–º–µ**: –ê–∫–æ —Å–µ –∑–∞–≥–ª–∞–≤—ô–µ Origin –æ–¥—Ä–∞–∂–∞–≤–∞ —É –∑–∞–≥–ª–∞–≤—ô—É `Access-Control-Allow-Origin`, –º–æ–≥—É—õ–µ —ò–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç–∏ –¥–∞ –ª–∏ —ò–µ —Ä–µ—Å—É—Ä—Å –≤–µ—õ —É –∫–µ—à—É.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

–£ —Å–ª—É—á–∞—ò—É –¥–∞ —Å–µ **Origin –∑–∞–≥–ª–∞–≤—ô–µ** –æ–¥—Ä–∞–∂–∞–≤–∞ —É –∑–∞–≥–ª–∞–≤—ô—É `Access-Control-Allow-Origin`, –Ω–∞–ø–∞–¥–∞—á –º–æ–∂–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–∏—Ç–∏ –æ–≤–æ –ø–æ–Ω–∞—à–∞—ö–µ –¥–∞ –ø–æ–∫—É—à–∞ –¥–∞ **–ø—Ä–µ—É–∑–º–µ** **—Ä–µ—Å—É—Ä—Å** —É **CORS** —Ä–µ–∂–∏–º—É. –ê–∫–æ **–≥—Ä–µ—à–∫–∞** **–Ω–∏—ò–µ** –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–∞, —Ç–æ –∑–Ω–∞—á–∏ –¥–∞ —ò–µ **–∏—Å–ø—Ä–∞–≤–Ω–æ –ø—Ä–µ—É–∑–µ—Ç–∞ —Å–∞ –≤–µ–±–∞**, –∞–∫–æ —ò–µ –≥—Ä–µ—à–∫–∞ **–∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–∞**, —Ç–æ —ò–µ –∑–∞—Ç–æ —à—Ç–æ —ò–µ **–ø—Ä–∏—Å—Ç—É–ø—ô–µ–Ω–∞ –∏–∑ –∫–µ—à–∞** (–≥—Ä–µ—à–∫–∞ —Å–µ –ø–æ—ò–∞–≤—ô—É—ò–µ —ò–µ—Ä –∫–µ—à —á—É–≤–∞ –æ–¥–≥–æ–≤–æ—Ä —Å–∞ CORS –∑–∞–≥–ª–∞–≤—ô–µ–º –∫–æ—ò–µ –¥–æ–∑–≤–æ—ô–∞–≤–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω—É –¥–æ–º–µ–Ω—É, –∞ –Ω–µ –¥–æ–º–µ–Ω—É –Ω–∞–ø–∞–¥–∞—á–∞)**.**\
–ò–º–∞—ò—Ç–µ –Ω–∞ —É–º—É –¥–∞ –∞–∫–æ –ø–æ—Ä–µ–∫–ª–æ –Ω–∏—ò–µ –æ–¥—Ä–∞–∂–µ–Ω–æ, –∞–ª–∏ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –¥–∏–∫–∏ (`Access-Control-Allow-Origin: *`), –æ–≤–æ –Ω–µ—õ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Å–∞—Ç–∏.

## –¢–µ—Ö–Ω–∏–∫–∞ —á–∏—Ç—ô–∏–≤–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–∞

### Fetch –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **–†–µ–∑–∏–º–µ:** GC –∏ SA –æ–º–æ–≥—É—õ–∞–≤–∞—ò—É –ø—Ä–æ–≤–µ—Ä—É —Ç–∏–ø–∞ –æ–¥–≥–æ–≤–æ—Ä–∞ (opaque-redirect) –Ω–∞–∫–æ–Ω —à—Ç–æ —ò–µ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ –∑–∞–≤—Ä—à–µ–Ω–æ.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

–ü–æ–¥–Ω–æ—à–µ—ö–µ–º –∑–∞—Ö—Ç–µ–≤–∞ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ Fetch API —Å–∞ `redirect: "manual"` –∏ –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–º–∞, –º–æ–≥—É—õ–µ —ò–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç `response.type` –∏ –∞–∫–æ —ò–µ —ò–µ–¥–Ω–∞–∫ `opaqueredirect`, –æ–Ω–¥–∞ —ò–µ –æ–¥–≥–æ–≤–æ—Ä –±–∏–æ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ.

### COOP

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ó–∞–≥–ª–∞–≤—ô–µ
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **–†–µ–∑–∏–º–µ:** –°—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞—à—Ç–∏—õ–µ–Ω–µ –ü–æ–ª–∏—Ç–∏–∫–æ–º –û—Ç–≤–∞—Ä–∞—á–∞ –ö—Ä–æ—Å-–ò–∑–≤–æ—Ä–∞ (COOP) —Å–ø—Ä–µ—á–∞–≤–∞—ò—É –ø—Ä–∏—Å—Ç—É–ø –∏–∑ –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–∏—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏—ò–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

–ù–∞–ø–∞–¥–∞—á –º–æ–∂–µ –∑–∞–∫—ô—É—á–∏—Ç–∏ –ø—Ä–∏—Å—É—Å—Ç–≤–æ –∑–∞–≥–ª–∞–≤—ô–∞ –ü–æ–ª–∏—Ç–∏–∫–µ –û—Ç–≤–∞—Ä–∞—á–∞ –ö—Ä–æ—Å-–ò–∑–≤–æ—Ä–∞ (COOP) —É –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä–Ω–æ–º HTTP –æ–¥–≥–æ–≤–æ—Ä—É. COOP —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –æ–¥ —Å—Ç—Ä–∞–Ω–µ –≤–µ–± –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –¥–∞ —Å–ø—Ä–µ—á–∏ —Å–ø–æ—ô–Ω–µ –ª–æ–∫–∞—Ü–∏—ò–µ –¥–∞ –¥–æ–±–∏—ò—É –ø—Ä–æ–∏–∑–≤–æ—ô–Ω–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–µ –Ω–∞ –ø—Ä–æ–∑–æ—Ä–µ. –í–∏–¥—ô–∏–≤–æ—Å—Ç –æ–≤–æ–≥ –∑–∞–≥–ª–∞–≤—ô–∞ –º–æ–∂–µ —Å–µ —É—Ç–≤—Ä–¥–∏—Ç–∏ –ø–æ–∫—É—à–∞–≤–∞—ö–µ–º –¥–∞ —Å–µ –ø—Ä–∏—Å—Ç—É–ø–∏ **`contentWindow` —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏**. –£ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏–º–∞ –≥–¥–µ —Å–µ COOP –ø—Ä–∏–º–µ—ö—É—ò–µ —É—Å–ª–æ–≤–Ω–æ, **`opener` —Å–≤–æ—ò—Å—Ç–≤–æ** –ø–æ—Å—Ç–∞—ò–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: –æ–Ω–æ —ò–µ **–Ω–µ–æ–¥—Ä–µ—í–µ–Ω–æ** –∫–∞–¥–∞ —ò–µ COOP –∞–∫—Ç–∏–≤–∞–Ω, –∞ **–æ–¥—Ä–µ—í–µ–Ω–æ** —É —ö–µ–≥–æ–≤–æ–º –æ–¥—Å—É—Å—Ç–≤—É.

### –ú–∞–∫—Å–∏–º–∞–ª–Ω–∞ –¥—É–∂–∏–Ω–∞ URL - —Å–µ—Ä–≤–µ—Ä—Å–∫–∞ —Å—Ç—Ä–∞–Ω–∞

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API, HTML –ï–ª–µ–º–µ–Ω—Ç–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ / –°–∞–¥—Ä–∂–∞—ò
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **–†–µ–∑–∏–º–µ:** –î–µ—Ç–µ–∫—Ç—É—ò—Ç–µ —Ä–∞–∑–ª–∏–∫–µ —É –æ–¥–≥–æ–≤–æ—Ä–∏–º–∞ —ò–µ—Ä –¥—É–∂–∏–Ω–∞ –æ–¥–≥–æ–≤–æ—Ä–∞ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –º–æ–∂–µ –±–∏—Ç–∏ –ø—Ä–µ–≤–µ–ª–∏–∫–∞ –¥–∞ —Å–µ—Ä–≤–µ—Ä –æ–¥–≥–æ–≤–æ—Ä–∏ –≥—Ä–µ—à–∫–æ–º –∏ –≥–µ–Ω–µ—Ä–∏—à–µ —É–ø–æ–∑–æ—Ä–µ—ö–µ.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

–ê–∫–æ —Å–µ—Ä–≤–µ—Ä—Å–∫–æ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ –∫–æ—Ä–∏—Å—Ç–∏ **–∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ —É–Ω–æ—Å —É –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö—É** –∏ **–¥–æ–¥–∞—Ç–Ω–µ –ø–æ–¥–∞—Ç–∫–µ**. –ú–æ–≥—É—õ–µ —ò–µ –¥–µ—Ç–µ–∫—Ç–æ–≤–∞—Ç–∏ –æ–≤–æ –ø–æ–Ω–∞—à–∞—ö–µ —ò–µ—Ä –æ–±–∏—á–Ω–æ **—Å–µ—Ä–≤–µ—Ä–∏** –∏–º–∞—ò—É **–æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ –¥—É–∂–∏–Ω–µ –∑–∞—Ö—Ç–µ–≤–∞**. –ê–∫–æ —Å—É **–∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –ø–æ–¥–∞—Ü–∏** —Ç–µ **–¥—É–∂–∏–Ω–µ - 1**, —ò–µ—Ä **–ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ** –∫–æ—Ä–∏—Å—Ç–∏ **—Ç–µ –ø–æ–¥–∞—Ç–∫–µ** –∏ **–¥–æ–¥–∞—ò–µ** –Ω–µ—à—Ç–æ **–¥–æ–¥–∞—Ç–Ω–æ**, –∏–∑–∞–∑–≤–∞—õ–µ **–≥—Ä–µ—à–∫—É –∫–æ—ò–∞ —Å–µ –º–æ–∂–µ –¥–µ—Ç–µ–∫—Ç–æ–≤–∞—Ç–∏ –ø—Ä–µ–∫–æ –¥–æ–≥–∞—í–∞—ò–∞ –æ –≥—Ä–µ—à–∫–∞–º–∞**.

–ê–∫–æ –º–æ–∂–µ—Ç–µ –Ω–∞ –Ω–µ–∫–∏ –Ω–∞—á–∏–Ω –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –∫–æ–ª–∞—á–∏—õ–µ –∫–æ—Ä–∏—Å–Ω–∏–∫—É, –º–æ–∂–µ—Ç–µ —Ç–∞–∫–æ—í–µ –∏–∑–≤—Ä—à–∏—Ç–∏ –æ–≤–∞—ò –Ω–∞–ø–∞–¥ –ø–æ—Å—Ç–∞–≤—ô–∞—ò—É—õ–∏ **–¥–æ–≤–æ—ô–Ω–æ –∫–æ–ª–∞—á–∏—õ–∞** ([**cookie bomb**](hacking-with-cookies/cookie-bomb.md)) —Ç–∞–∫–æ –¥–∞ —Å–∞ **—É–≤–µ—õ–∞–Ω–æ–º –≤–µ–ª–∏—á–∏–Ω–æ–º –æ–¥–≥–æ–≤–æ—Ä–∞** **–∏—Å–ø—Ä–∞–≤–Ω–æ–≥ –æ–¥–≥–æ–≤–æ—Ä–∞** –±—É–¥–µ **–∏–∑–∞–∑–≤–∞–Ω–∞ –≥—Ä–µ—à–∫–∞**. –£ –æ–≤–æ–º —Å–ª—É—á–∞—ò—É, –∑–∞–ø–∞–º—Ç–∏—Ç–µ –¥–∞ –∞–∫–æ –∞–∫—Ç–∏–≤–∏—Ä–∞—Ç–µ –æ–≤–∞—ò –∑–∞—Ö—Ç–µ–≤ —Å–∞ –∏—Å—Ç–µ –ª–æ–∫–∞—Ü–∏—ò–µ, `<script>` —õ–µ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø–æ—Å–ª–∞—Ç–∏ –∫–æ–ª–∞—á–∏—õ–µ (—Ç–∞–∫–æ –¥–∞ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç–∏ –≥—Ä–µ—à–∫–µ).\
–ü—Ä–∏–º–µ—Ä **cookie bomb + XS-Search** –º–æ–∂–µ —Å–µ –Ω–∞—õ–∏ —É –ù–∞–º–µ—Ä–∞–Ω–æ—ò —Ä–µ—à–µ—ö—É –æ–≤–æ–≥ –∏–∑–≤–µ—à—Ç–∞—ò–∞: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` –∏–ª–∏ –¥–∞ –±—É–¥–µ —É –∏—Å—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –æ–±–∏—á–Ω–æ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ –∑–∞ –æ–≤—É –≤—Ä—Å—Ç—É –Ω–∞–ø–∞–¥–∞.

### –ú–∞–∫—Å–∏–º–∞–ª–Ω–∞ –¥—É–∂–∏–Ω–∞ URL - –∫–ª–∏—ò–µ–Ω—Ç—Å–∫–∞ —Å—Ç—Ä–∞–Ω–∞

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ / –°–∞–¥—Ä–∂–∞—ò
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **–†–µ–∑–∏–º–µ:** –î–µ—Ç–µ–∫—Ç—É—ò—Ç–µ —Ä–∞–∑–ª–∏–∫–µ —É –æ–¥–≥–æ–≤–æ—Ä–∏–º–∞ —ò–µ—Ä –¥—É–∂–∏–Ω–∞ –æ–¥–≥–æ–≤–æ—Ä–∞ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –º–æ–∂–µ –±–∏—Ç–∏ –ø—Ä–µ–≤–µ–ª–∏–∫–∞ –∑–∞ –∑–∞—Ö—Ç–µ–≤ –¥–∞ —Å–µ –ø—Ä–∏–º–µ—Ç–∏ —Ä–∞–∑–ª–∏–∫–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

–ü—Ä–µ–º–∞ [Chromium –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò–∏](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url\_display\_guidelines/url\_display\_guidelines.md#URL-Length), –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –¥—É–∂–∏–Ω–∞ URL-–∞ —É Chrome-—É —ò–µ 2MB.

> –£–æ–ø—à—Ç–µ–Ω–æ, _–≤–µ–± –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞_ –Ω–µ–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–∞ –Ω–∞ –¥—É–∂–∏–Ω—É URL-–æ–≤–∞ (–∏–∞–∫–æ —ò–µ 2^31 —É–æ–±–∏—á–∞—ò–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ). _Chrome_ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞ URL-–æ–≤–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω—É –¥—É–∂–∏–Ω—É –æ–¥ **2MB** –∏–∑ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö —Ä–∞–∑–ª–æ–≥–∞ –∏ –¥–∞ –∏–∑–±–µ–≥–Ω–µ –ø—Ä–æ–±–ª–µ–º–µ —Å–∞ –æ–¥–±–∏—ò–∞—ö–µ–º —É—Å–ª—É–≥–µ —É –º–µ—í—É–ø—Ä–æ—Ü–µ—Å–Ω–æ—ò –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò–∏.

–°—Ç–æ–≥–∞, –∞–∫–æ —ò–µ **URL –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –≤–µ—õ–∏ —É —ò–µ–¥–Ω–æ–º –æ–¥ —Å–ª—É—á–∞—ò–µ–≤–∞**, –º–æ–≥—É—õ–µ —ò–µ —É—á–∏–Ω–∏—Ç–∏ –¥–∞ —Å–µ –ø—Ä–µ—É—Å–º–µ—Ä–∏ —Å–∞ **URL-–æ–º –≤–µ—õ–∏–º –æ–¥ 2MB** –¥–∞ –±–∏ —Å–µ –¥–æ—Å—Ç–∏–≥–ª–æ **–æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ –¥—É–∂–∏–Ω–µ**. –ö–∞–¥–∞ —Å–µ —Ç–æ –¥–æ–≥–æ–¥–∏, Chrome –ø—Ä–∏–∫–∞–∑—É—ò–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É **`about:blank#blocked`**.

**–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞** —ò–µ –¥–∞ –∞–∫–æ —ò–µ **–ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–µ** –±–∏–ª–æ **–∑–∞–≤—Ä—à–µ–Ω–æ**, `window.origin` –∏–∑–±–∞—Ü—É—ò–µ **–≥—Ä–µ—à–∫—É** —ò–µ—Ä –∫—Ä–æ—Å-–∏–∑–≤–æ—Ä –Ω–µ –º–æ–∂–µ –¥–∞ –ø—Ä–∏—Å—Ç—É–ø–∏ —Ç–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞–º–∞. –ú–µ—í—É—Ç–∏–º, –∞–∫–æ —ò–µ **–æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ** –±–∏–ª–æ \*\*\*\* –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –∏ —É—á–∏—Ç–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —ò–µ **`about:blank#blocked`**, **`origin`** –ø—Ä–æ–∑–æ—Ä–∞ –æ—Å—Ç–∞—ò–µ –æ–Ω–∞—ò –æ–¥ **—Ä–æ–¥–∏—Ç–µ—ô–∞**, —à—Ç–æ —ò–µ **–ø—Ä–∏—Å—Ç—É–ø–∞—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞.**

–°–≤–µ –¥–æ–¥–∞—Ç–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø–æ—Ç—Ä–µ–±–Ω–µ –∑–∞ –¥–æ—Å—Ç–∏—õ–∏ **2MB** –º–æ–≥—É —Å–µ –¥–æ–¥–∞—Ç–∏ –ø—Ä–µ–∫–æ **—Ö–∞—à–∞** —É –∏–Ω–∏—Ü–∏—ò–∞–ª–Ω–æ–º URL-—É —Ç–∞–∫–æ –¥–∞ —õ–µ –±–∏—Ç–∏ **–∫–æ—Ä–∏—à—õ–µ–Ω–µ —É –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö—É**.

{% content-ref url="xs-search/url-max-length-client-side.md" %}
[url-max-length-client-side.md](xs-search/url-max-length-client-side.md)
{% endcontent-ref %}

### –ú–∞–∫—Å–∏–º–∞–ª–Ω–∏ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: Fetch API, –§—Ä–µ–π–º–æ–≤–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76)
* **–†–µ–∑–∏–º–µ:** –ò—Å–∫–æ—Ä–∏—Å—Ç–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ –ø—Ä–µ–≥–ª–µ–¥–∞—á–∞ –¥–∞ —É—Ç–≤—Ä–¥–∏—Ç–µ –¥–∞ –ª–∏ —ò–µ –¥–æ—à–ª–æ –¥–æ –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞ URL-–∞.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

–ê–∫–æ —ò–µ **–º–∞–∫—Å–∏–º–∞–ª–Ω–∏** –±—Ä–æ—ò **–ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞** –∫–æ—ò–µ –ø—Ä–µ–≥–ª–µ–¥–∞—á –º–æ–∂–µ –¥–∞ –ø—Ä–∞—Ç–∏ **20**, –Ω–∞–ø–∞–¥–∞—á –±–∏ –º–æ–≥–∞–æ –ø–æ–∫—É—à–∞—Ç–∏ –¥–∞ —É—á–∏—Ç–∞ —Å–≤–æ—ò—É —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∞ **19 –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞** –∏ –Ω–∞ –∫—Ä–∞—ò—É **–ø–æ—à–∞—ô–µ –∂—Ä—Ç–≤—É** –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–∞–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É. –ê–∫–æ —Å–µ **–≥—Ä–µ—à–∫–∞** –∞–∫—Ç–∏–≤–∏—Ä–∞, –æ–Ω–¥–∞ —ò–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫—É—à–∞–≤–∞–ª–∞ –¥–∞ **–ø—Ä–µ—É—Å–º–µ—Ä–∏ –∂—Ä—Ç–≤—É**.

### –î—É–∂–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–µ

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –§—Ä–µ–π–º–æ–≤–∏, –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ü—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞—ö–∞
* **–í–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **–†–µ–∑–∏–º–µ:** JavaScript –∫–æ–¥ –º–∞–Ω–∏–ø—É–ª–∏—à–µ –∏—Å—Ç–æ—Ä–∏—ò–æ–º –ø—Ä–µ–≥–ª–µ–¥–∞—á–∞ –∏ –º–æ–∂–µ —Å–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ —Å–≤–æ—ò—Å—Ç–≤—É –¥—É–∂–∏–Ω–µ.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

**History API** –æ–º–æ–≥—É—õ–∞–≤–∞ JavaScript –∫–æ–¥—É –¥–∞ –º–∞–Ω–∏–ø—É–ª–∏—à–µ –∏—Å—Ç–æ—Ä–∏—ò–æ–º –ø—Ä–µ–≥–ª–µ–¥–∞—á–∞, –∫–æ—ò–∞ **—á—É–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ—ò–µ —ò–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –ø–æ—Å–µ—Ç–∏–æ**. –ù–∞–ø–∞–¥–∞—á –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —Å–≤–æ—ò—Å—Ç–≤–æ –¥—É–∂–∏–Ω–µ –∫–∞–æ –º–µ—Ç–æ–¥ —É–∫—ô—É—á–∏–≤–∞—ö–∞: –¥–∞ –¥–µ—Ç–µ–∫—Ç—É—ò–µ JavaScript –∏ HTML –Ω–∞–≤–∏–≥–∞—Ü–∏—ò—É.\
**–ü—Ä–æ–≤–µ—Ä–∞–≤–∞—ò—É—õ–∏ `history.length`**, —Ç–µ—Ä–∞—ò—É—õ–∏ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –¥–∞ **–Ω–∞–≤–µ–¥–µ** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, **–≤—Ä–∞—õ–∞—ò—É—õ–∏** —Å–µ **–Ω–∞–∑–∞–¥** –Ω–∞ –∏—Å—Ç–æ –ø–æ—Ä–µ–∫–ª–æ –∏ **–ø—Ä–æ–≤–µ—Ä–∞–≤–∞—ò—É—õ–∏** –Ω–æ–≤—É –≤—Ä–µ–¥–Ω–æ—Å—Ç **`history.length`**.

### –î—É–∂–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–µ —Å–∞ –∏—Å—Ç–∏–º URL-–æ–º

* **–ú–µ—Ç–æ–¥–µ —É–∫—ô—É—á–∏–≤–∞—ö–∞**: –§—Ä–µ–π–º–æ–≤–∏, –ü–æ–ø-—É–ø –ø—Ä–æ–∑–æ—Ä–∏
* **–£–æ—á—ô–∏–≤–∞ —Ä–∞–∑–ª–∏–∫–∞**: –ê–∫–æ —ò–µ URL –∏—Å—Ç–∏ –∫–∞–æ –æ–Ωaj –∫–æ—ò–∏ —ò–µ –ø–æ–≥–æ–¥–∞–Ω
* **–†–µ–∑–∏–º–µ:** –ú–æ–≥—É—õ–µ —ò–µ –ø–æ–≥–æ–¥–∏—Ç–∏ –¥–∞ –ª–∏ —Å–µ –ª–æ–∫–∞—Ü–∏—ò–∞ —Ñ—Ä–µ—ò–º–∞/–ø–æ–ø-—É–ø–∞ –Ω–∞–ª–∞–∑–∏ –Ω–∞ –æ–¥—Ä–µ—í–µ–Ω–æ–º URL-—É –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–æ–º –¥—É–∂–∏–Ω–µ –∏—Å—Ç–æ—Ä–∏—ò–µ.
* **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**: –ò—Å–ø–æ–¥

–ù–∞–ø–∞–¥–∞—á –±–∏ –º–æ–≥–∞–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ JavaScript –∫–æ–¥ –¥–∞ **–º–∞–Ω–∏–ø—É–ª–∏—à–µ –ª–æ–∫–∞—Ü–∏—ò–æ–º —Ñ—Ä–µ—ò–º–∞/–ø–æ–ø-—É–ø–∞ –Ω–∞ –ø–æ–≥–æ–¥–∞–Ω URL** –∏ **–æ–¥–º–∞—Ö** **–ø—Ä–æ–º–µ–Ω–∏ –Ω–∞ `about:blank`**. –ê–∫–æ —Å–µ –¥—É–∂–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–µ –ø–æ–≤–µ—õ–∞–ª–∞, —Ç–æ –∑–Ω–∞—á–∏ –¥–∞ —ò–µ URL –±–∏–æ —Ç–∞—á–∞–Ω –∏ –¥–∞ —ò–µ –∏–º–∞–æ –≤—Ä–µ–º–µ–Ω–∞ –¥–∞ **–ø–æ—Ä–∞—Å—Ç–µ —ò–µ—Ä —Å–µ URL –Ω–µ —É—á–∏—Ç–∞–≤–∞ –ø–æ–Ω–æ–≤–æ –∞–∫–æ —ò–µ –∏—Å—Ç–∏**. –ê–∫–æ —Å–µ –Ω–∏—ò–µ –ø–æ–≤–µ—õ–∞–ª–∞, —Ç–æ –∑–Ω–∞—á–∏ –¥–∞ —ò–µ **–ø–æ–∫—É—à–∞–æ –¥–∞ —É—á–∏—Ç–∞ –ø–æ–≥–æ–¥–∞–Ω URL**, –∞–ª–∏ –∑–∞—Ç–æ —à—Ç–æ —Å–º–æ **–æ–¥–º–∞—Ö –ø–æ—Å–ª–µ** —É—á–∏—Ç–∞–ª–∏ **`about:blank`**, **–¥—É–∂–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–µ –Ω–∏–∫–∞–¥–∞ –Ω–∏—ò–µ –ø–æ–≤–µ—õ–∞–Ω–∞** –ø—Ä–∏ —É—á–∏—Ç–∞–≤–∞—ö—É –ø–æ–≥–æ–¥–Ω–æ–≥ URL-–∞.
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Frame Counting

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **Summary:** Procena koliƒçine iframe elemenata inspekcijom `window.length` svojstva.
* **Code Example**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

Brojanje **broja okvira na webu** otvorenog putem `iframe` ili `window.open` mo≈æe pomoƒái u identifikaciji **statusa korisnika na toj stranici**.\
≈†tavi≈°e, ako stranica uvek ima isti broj okvira, kontinuirano proveravanje broja okvira mo≈æe pomoƒái u identifikaciji **obraza** koji mo≈æe otkriti informacije.

Primer ove tehnike je da se u chrome-u, **PDF** mo≈æe **otkriti** pomoƒáu **brojanja okvira** jer se `embed` koristi interno. Postoje [Open URL Parameters](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) koji omoguƒáavaju odreƒëenu kontrolu nad sadr≈æajem kao ≈°to su `zoom`, `view`, `page`, `toolbar` gde bi ova tehnika mogla biti zanimljiva.

### HTMLElements

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **Summary:** Proƒçitajte otkrivenu vrednost da biste razlikovali izmeƒëu 2 moguƒáa stanja
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

Curjenje informacija kroz HTML elemente je zabrinjavajuƒáe u web bezbednosti, posebno kada se dinamiƒçki medijski fajlovi generi≈°u na osnovu korisniƒçkih informacija, ili kada se dodaju vodeni ≈æigovi, menjajuƒái veliƒçinu medija. Ovo mogu iskoristiti napadaƒçi da razlikuju izmeƒëu moguƒáih stanja analizirajuƒái informacije koje izla≈æu odreƒëeni HTML elementi.

### Information Exposed by HTML Elements

* **HTMLMediaElement**: Ovaj element otkriva `duration` i `buffered` vreme medija, koja se mogu pristupiti putem njegovog API-ja. [Proƒçitajte vi≈°e o HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: Otkriva `videoHeight` i `videoWidth`. U nekim pregledaƒçima, dodatna svojstva kao ≈°to su `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount`, i `webkitDecodedFrameCount` su dostupna, nudeƒái dublje informacije o sadr≈æaju medija. [Proƒçitajte vi≈°e o HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: Ova funkcija pru≈æa detalje o kvalitetu reprodukcije videa, ukljuƒçujuƒái `totalVideoFrames`, ≈°to mo≈æe ukazivati na koliƒçinu obraƒëenih video podataka. [Proƒçitajte vi≈°e o getVideoPlaybackQuality()](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: Ovaj element otkriva `height` i `width` slike. Meƒëutim, ako je slika neva≈æeƒáa, ova svojstva ƒáe vratiti 0, a funkcija `image.decode()` ƒáe biti odbijena, ≈°to ukazuje na neuspeh uƒçitavanja slike ispravno. [Proƒçitajte vi≈°e o HTMLImageElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS Property

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **Summary:** Identifikujte varijacije u stilizovanju web stranice koje se koreliraju sa stanjem ili statusom korisnika.
* **Code Example**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

Web aplikacije mogu menjati **stilizovanje web stranice u zavisnosti od statusa korisnika**. CSS fajlovi sa razliƒçitih domena mogu biti ugraƒëeni na stranici napadaƒça pomoƒáu **HTML link elementa**, a **pravila** ƒáe biti **primenjena** na stranicu napadaƒça. Ako stranica dinamiƒçki menja ova pravila, napadaƒç mo≈æe **otkriti** ove **razlike** u zavisnosti od stanja korisnika.\
Kao tehnika curenja, napadaƒç mo≈æe koristiti `window.getComputedStyle` metodu da **proƒçita CSS** svojstva odreƒëenog HTML elementa. Kao rezultat, napadaƒç mo≈æe ƒçitati proizvoljna CSS svojstva ako su poznati pogoƒëeni element i naziv svojstva.

### CSS History

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **Summary:** Otkrivanje da li je stil `:visited` primenjen na URL koji ukazuje da je veƒá posetjen
* **Code Example**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
Prema [**ovome**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/), ovo ne funkcioni≈°e u headless Chrome-u.
{% endhint %}

CSS `:visited` selektor se koristi za stilizovanje URL-ova drugaƒçije ako su prethodno posetili korisnik. U pro≈°losti, `getComputedStyle()` metoda se mogla koristiti za identifikaciju ovih razlika u stilu. Meƒëutim, moderni pregledaƒçi su implementirali bezbednosne mere kako bi spreƒçili ovu metodu da otkrije stanje linka. Ove mere ukljuƒçuju uvek vraƒáanje izraƒçunatog stila kao da je link posetjen i ograniƒçavanje stilova koji se mogu primeniti sa `:visited` selektorom.

Uprkos ovim ograniƒçenjima, moguƒáe je indirektno razaznati posetjeno stanje linka. Jedna tehnika ukljuƒçuje prevaru korisnika da interaguje sa podruƒçjem koje je pogoƒëeno CSS-om, posebno koristeƒái `mix-blend-mode` svojstvo. Ovo svojstvo omoguƒáava me≈°anje elemenata sa njihovom pozadinom, potencijalno otkrivajuƒái posetjeno stanje na osnovu interakcije korisnika.

≈†tavi≈°e, otkrivanje se mo≈æe postiƒái bez korisniƒçke interakcije iskori≈°ƒáavanjem vremena renderovanja linkova. Po≈°to pregledaƒçi mogu renderovati posetjene i neposetjene linkove drugaƒçije, to mo≈æe uvesti merljivu vremensku razliku u renderovanju. Dokaz koncepta (PoC) je pomenut u izve≈°taju o gre≈°ci u Chromium-u, demonstrirajuƒái ovu tehniku koristeƒái vi≈°e linkova kako bi pojaƒçali vremensku razliku, ƒçime se posetjeno stanje mo≈æe otkriti analizom vremena.

Za vi≈°e detalja o ovim svojstvima i metodama, posetite njihove stranice dokumentacije:

* `:visited`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)

### ContentDocument X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Headers
* **More info**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **Summary:** U Google Chrome-u, prikazuje se posveƒáena stranica gre≈°ke kada je stranica blokirana za umetanje na stranici sa razliƒçitim poreklom zbog X-Frame-Options ograniƒçenja.
* **Code Example**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

U Chrome-u, ako je stranica sa `X-Frame-Options` zaglavljem postavljenim na "deny" ili "same-origin" umetnuta kao objekat, pojavljuje se stranica gre≈°ke. Chrome jedinstveno vraƒáa prazan dokument objekat (umesto `null`) za `contentDocument` svojstvo ovog objekta, za razliku od iframe-ova ili drugih pregledaƒça. Napadaƒçi bi mogli iskoristiti ovo otkrivanjem praznog dokumenta, potencijalno otkrivajuƒái informacije o stanju korisnika, posebno ako programeri dosledno ne postavljaju X-Frame-Options zaglavlje, ƒçesto zanemarujuƒái stranice gre≈°ke. Svest i dosledna primena bezbednosnih zaglavlja su kljuƒçni za spreƒçavanje ovakvih curenja.

### Download Detection

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **Summary:** Napadaƒç mo≈æe da razazna preuzimanje fajlova koristeƒái iframe; nastavak pristupa iframe-u implicira uspe≈°no preuzimanje fajla.
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

`Content-Disposition` zaglavlje, posebno `Content-Disposition: attachment`, nareƒëuje pregledaƒçu da preuzme sadr≈æaj umesto da ga prika≈æe inline. Ovo pona≈°anje se mo≈æe iskoristiti za otkrivanje da li korisnik ima pristup stranici koja pokreƒáe preuzimanje fajla. U Chromium-baziranim pregledaƒçima, postoji nekoliko tehnika za otkrivanje ovog pona≈°anja preuzimanja:

1. **Praƒáenje trake za preuzimanje**:
* Kada se fajl preuzme u Chromium-baziranim pregledaƒçima, traka za preuzimanje se pojavljuje na dnu prozora pregledaƒça.
* Praƒáenjem promena u visini prozora, napadaƒçi mogu da zakljuƒçe da se traka za preuzimanje pojavila, ≈°to sugeri≈°e da je preuzimanje pokrenuto.
2. **Navigacija preuzimanja sa iframe-ima**:
* Kada stranica pokrene preuzimanje fajla koristeƒái `Content-Disposition: attachment` zaglavlje, to ne izaziva dogaƒëaj navigacije.
* Uƒçitavanjem sadr≈æaja u iframe i praƒáenjem dogaƒëaja navigacije, moguƒáe je proveriti da li sadr≈æaj uzrokuje preuzimanje fajla (nema navigacije) ili ne.
3. **Navigacija preuzimanja bez iframe-a**:
* Sliƒçno tehnici iframe-a, ova metoda ukljuƒçuje kori≈°ƒáenje `window.open` umesto iframe-a.
* Praƒáenje dogaƒëaja navigacije u novootvorenom prozoru mo≈æe otkriti da li je preuzimanje fajla pokrenuto (nema navigacije) ili se sadr≈æaj prikazuje inline (navigacija se de≈°ava).

U scenarijima gde samo prijavljeni korisnici mogu pokrenuti takva preuzimanja, ove tehnike se mogu koristiti za indirektno zakljuƒçivanje o stanju autentifikacije korisnika na osnovu odgovora pregledaƒça na zahtev za preuzimanje.

### Partitioned HTTP Cache Bypass <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **Summary:** Napadaƒç mo≈æe da razazna preuzimanje fajlova koristeƒái iframe; nastavak pristupa iframe-u implicira uspe≈°no preuzimanje fajla.
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) (iz [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))

{% hint style="warning" %}
Zato je ova tehnika zanimljiva: Chrome sada ima **particionisanje ke≈°a**, a kljuƒç ke≈°a novootvorene stranice je: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m =xxx)`, ali ako otvorim ngrok stranicu i koristim fetch u njoj, kljuƒç ke≈°a ƒáe biti: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`, **kljuƒç ke≈°a je razliƒçit**, tako da se ke≈° ne mo≈æe deliti. Vi≈°e detalja mo≈æete pronaƒái ovde: [Sticanje bezbednosti i privatnosti deljenjem ke≈°a](https://developer.chrome.com/blog/http-cache-partitioning/)\
(Komentar iz [**ovde**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))
{% endhint %}

Ako sajt `example.com` ukljuƒçuje resurs sa `*.example.com/resource`, tada ƒáe taj resurs imati **isti kljuƒç ke≈°a** kao da je resurs direktno **zatra≈æen kroz navigaciju na vrhunskom nivou**. To je zato ≈°to se kljuƒç ke≈°a sastoji od vrhunskog _eTLD+1_ i okvira _eTLD+1_.

Po≈°to je pristup ke≈°u br≈æi od uƒçitavanja resursa, moguƒáe je poku≈°ati da promenite lokaciju stranice i otka≈æete je 20ms (na primer) nakon toga. Ako je poreklo promenjeno nakon zaustavljanja, to znaƒçi da je resurs bio ke≈°iran.\
Ili mo≈æete jednostavno **poslati neki fetch na potencijalno ke≈°iranu stranicu i izmeriti vreme koje je potrebno**.

### Manual Redirect <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Redirects
* **More info**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **Summary:** Moguƒáe je saznati da li je odgovor na fetch zahtev preusmeravanje
* **Code Example**:

![](<../.gitbook/assets/image (652).png>)

### Fetch with AbortController <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **Summary:** Moguƒáe je poku≈°ati uƒçitati resurs i prekinuti ga pre nego ≈°to se uƒçita. U zavisnosti od toga da li je gre≈°ka izazvana, resurs je bio ili nije bio ke≈°iran.
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

Koristite _**fetch**_ i _**setTimeout**_ sa **AbortController** da otkrijete da li je **resurs ke≈°iran** i da izbacite odreƒëeni resurs iz ke≈°a pregledaƒça. ≈†tavi≈°e, proces se odvija bez ke≈°iranja novog sadr≈æaja.

### Script Pollution

* **Inclusion Methods**: HTML Elements (script)
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **Summary:** Moguƒáe je **prepisati ugraƒëene funkcije** i proƒçitati njihove argumente ƒçak i iz **cross-origin skripte** (koja se ne mo≈æe direktno proƒçitati), ≈°to mo≈æe **otkriti dragocene informacije**.
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### Service Workers <a href="#service-workers" id="service-workers"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **Summary:** Merenje vremena izvr≈°enja web-a koristeƒái servisne radnike.
* **Code Example**:

U datom scenariju, napadaƒç preuzima inicijativu da registruje **servisnog radnika** unutar jednog od svojih domena, konkretno "attacker.com". Zatim, napadaƒç otvara novi prozor na ciljanom veb sajtu iz glavnog dokumenta i nareƒëuje **servisnom radniku** da zapoƒçne tajmer. Dok se novi prozor uƒçitava, napadaƒç navigira referencom dobijenom u prethodnom koraku na stranicu kojom upravlja **servisni radnik**.

Po dolasku zahteva pokrenutog u prethodnom koraku, **servisni radnik** odgovara sa **204 (No Content)** status kodom, efikasno prekidajuƒái proces navigacije. U tom trenutku, **servisni radnik** bele≈æi merenje sa tajmera pokrenutog ranije u drugom koraku. Ovo merenje je pod uticajem trajanja JavaScript-a koje uzrokuje ka≈°njenja u procesu navigacije.

{% hint style="warning" %}
U merenju vremena izvr≈°enja moguƒáe je **eliminisati** **mre≈æne faktore** kako bi se dobila **preciznija merenja**. Na primer, uƒçitavanjem resursa koji se koriste na stranici pre njenog uƒçitavanja.
{% endhint %}

### Fetch Timing

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **Summary:** Koristite [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) da izmerite vreme potrebno za izvr≈°avanje zahteva. Mogu se koristiti i drugi satovi.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### Cross-Window Timing

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Timing (generalno zbog sadr≈æaja stranice, status koda)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **Summary:** Koristite [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) da izmerite vreme potrebno za izvr≈°avanje zahteva koristeƒái `window.open`. Mogu se koristiti i drugi satovi.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** pokretane od strane **najnaprednijih** alata zajednice.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## With HTML or Re Injection

Ovde mo≈æete pronaƒái tehnike za eksfiltraciju informacija iz cross-origin HTML **ubacivanjem HTML sadr≈æaja**. Ove tehnike su zanimljive u sluƒçajevima kada iz bilo kog razloga mo≈æete **ubaciti HTML, ali ne mo≈æete ubaciti JS kod**.

### Dangling Markup

{% content-ref url="dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### Image Lazy Loading

Ako trebate **eksfiltrirati sadr≈æaj** i mo≈æete **dodati HTML pre tajne**, trebali biste proveriti **uobiƒçajene tehnike viseƒáeg markup-a**.\
Meƒëutim, ako iz bilo kog razloga **MORATE** to uƒçiniti **karakter po karakter** (mo≈æda je komunikacija putem pogodka u ke≈°u), mo≈æete koristiti ovu trik.

**Slike** u HTML-u imaju atribut "**loading**" ƒçija vrednost mo≈æe biti "**lazy**". U tom sluƒçaju, slika ƒáe se uƒçitati kada se pogleda, a ne dok se stranica uƒçitava:
```html
<img src=/something loading=lazy >
```
Zato, ono ≈°to mo≈æete da uradite je da **dodate puno bespotrebnih karaktera** (Na primer **hiljade "W"**) da **popunite veb stranicu pre tajne ili dodate ne≈°to poput** `<br><canvas height="1850px"></canvas><br>.`\
Tada, ako na primer na≈°a **injekcija pojavi pre zastavice**, **slika** ƒáe biti **uƒçitana**, ali ako se pojavi **posle** **zastavice**, zastavica + bespotrebni karakteri ƒáe **spreƒçiti da se uƒçita** (biƒáe potrebno da eksperimenti≈°ete sa tim koliko bespotrebnih karaktera da stavite). Ovo se desilo u [**ovoj analizi**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/).

Druga opcija bi bila da koristite **scroll-to-text-fragment** ako je dozvoljeno:

#### Scroll-to-text-fragment

Meƒëutim, mo≈æete da **naterate bota da pristupi stranici** sa neƒçim poput
```
#:~:text=SECR
```
Dakle, veb stranica ƒáe biti ne≈°to poput: **`https://victim.com/post.html#:~:text=SECR`**

Gde post.html sadr≈æi napadniƒçke junk karaktere i sliku koja se uƒçitava lenjo, a zatim se dodaje tajna bota.

Ovaj tekst ƒáe omoguƒáiti botu da pristupi bilo kom tekstu na stranici koji sadr≈æi tekst `SECR`. Po≈°to je taj tekst tajna i nalazi se **ispod slike**, **slika ƒáe se uƒçitati samo ako je pogodjena tajna**. Tako imate svoj orakl za **ekstrakciju tajne karakter po karakter**.

Neki primer koda za iskori≈°ƒáavanje ovoga: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### Uƒçitavanje slika na osnovu vremena

Ako **nije moguƒáe uƒçitati eksternu sliku** koja bi napadaƒçu ukazala da je slika uƒçitana, druga opcija bi bila da se poku≈°a **pogoditi karakter nekoliko puta i meriti to**. Ako se slika uƒçita, svi zahtevi bi trajali du≈æe nego ako se slika ne uƒçita. Ovo je kori≈°ƒáeno u [**re≈°enju ovog izve≈°taja**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **sa≈æeto ovde:**

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

Ako se koristi `jQuery(location.hash)`, moguƒáe je saznati putem vremena **da li neki HTML sadr≈æaj postoji**, to je zato ≈°to ako selektor `main[id='site-main']` ne odgovara, ne mora da proverava ostatak **selektora**:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS Injection

{% content-ref url="xs-search/css-injection/" %}
[css-injection](xs-search/css-injection/)
{% endcontent-ref %}

## Defenses

Postoje preporuƒçene mere za≈°tite na [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) kao i u svakoj sekciji wiki [https://xsleaks.dev/](https://xsleaks.dev/). Pogledajte tamo za vi≈°e informacija o tome kako se za≈°tititi od ovih tehnika.

## References

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
