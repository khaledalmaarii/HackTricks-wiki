# Chrome Cache to XSS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Vi코e detalja [**u ovom izve코taju**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

Tehnika koja se ovde razmatra uklju캜uje razumevanje pona코anja i interakcije dva osnovna tipa ke코a: **back/forward cache (bfcache)** i **disk cache**. Bfcache, koji 캜uva potpunu sliku stranice uklju캜uju캖i JavaScript heap, ima prioritet nad disk ke코om za navigacije napred/nazad zbog svoje sposobnosti da 캜uva sveobuhvatniju sliku. Disk ke코, s druge strane, 캜uva resurse preuzete sa interneta bez uklju캜ivanja JavaScript heap-a, i koristi se za navigacije napred/nazad kako bi se smanjili tro코kovi komunikacije. Zanimljiv aspekt disk ke코a je njegovo uklju캜ivanje resursa preuzetih kori코캖enjem `fetch`, 코to zna캜i da 캖e resursi sa URL-a biti prikazani od strane pregleda캜a iz ke코a.

### Klju캜ne ta캜ke:

- **Bfcache** ima prioritet nad disk ke코om u navigacijama napred/nazad.
- Da bi se iskoristila stranica sme코tena u disk ke코u umesto bfcache, potonji mora biti onemogu캖en.

### Onemogu캖avanje bfcache:

Podrazumevano, Puppeteer onemogu캖ava bfcache, u skladu sa uslovima navedenim u dokumentaciji Chromium-a. Jedna efikasna metoda za onemogu캖avanje bfcache je kori코캖enje `RelatedActiveContentsExist`, postignuto otvaranjem stranice sa `window.open()` koja zadr쬬va referencu na `window.opener`.

### Reprodukcija pona코anja:

1. Posetite veb stranicu, npr., `https://example.com`.
2. Izvr코ite `open("http://spanote.seccon.games:3000/api/token")`, 코to rezultira odgovorom servera sa status kodom 500.
3. U novootvorenoj kartici, idite na `http://spanote.seccon.games:3000/`. Ova akcija ke코ira odgovor `http://spanote.seccon.games:3000/api/token` kao disk ke코.
4. Koristite `history.back()` da se vratite nazad. Ova akcija rezultira prikazivanjem ke코iranog JSON odgovora na stranici.

Provera da li je disk ke코 kori코캖en mo쬰 se potvrditi kori코캖enjem DevTools u Google Chrome-u.

Za dalja obja코njenja o bfcache i disk ke코u, reference se mogu na캖i na [web.dev o bfcache](https://web.dev/i18n/en/bfcache/) i [Chromium-ovim dizajnerskim dokumentima o disk ke코u](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/), redom.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
