# Chrome Cache do XSS

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmujcej si cyberbezpieczestwem**? Chcesz zobaczy swoj **firm reklamowan w HackTricks**? A mo偶e chcesz mie dostp do **najnowszej wersji PEASS lub pobra HackTricks w formacie PDF**? Sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **Docz do** [****](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** mnie na **Twitterze** [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**repozytorium hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**repozytorium hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Wicej szczeg贸贸w [**w tym opracowaniu**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

Omawiana tutaj technika polega na zrozumieniu zachowania i interakcji dw贸ch podstawowych typ贸w pamici podrcznej: **pamici podrcznej wstecz/prz贸d (bfcache)** i **pamici podrcznej dysku**. Pami podrczna bfcache, kt贸ra przechowuje kompletny zrzut strony, wcznie z stosem JavaScript, ma pierwszestwo przed pamici podrczn dysku podczas nawigacji wstecz/prz贸d ze wzgldu na mo偶liwo przechowywania bardziej kompleksowego zrzutu. Pami podrczna dysku natomiast przechowuje zasoby pobrane z sieci bez uwzgldniania stosu JavaScript i jest wykorzystywana podczas nawigacji wstecz/prz贸d w celu zmniejszenia koszt贸w komunikacji. Ciekawym aspektem pamici podrcznej dysku jest uwzgldnienie zasob贸w pobranych za pomoc `fetch`, co oznacza, 偶e przegldarka renderuje zasoby URL dostpne w pamici podrcznej.

### Kluczowe punkty:

- Pami podrczna bfcache ma pierwszestwo przed pamici podrczn dysku podczas nawigacji wstecz/prz贸d.
- Aby skorzysta z strony przechowywanej w pamici podrcznej dysku zamiast bfcache, nale偶y wyczy ten ostatni.

Wyczanie pamici podrcznej bfcache:

Domylnie Puppeteer wycza pami podrczn bfcache, zgodnie z warunkami wymienionymi w dokumentacji Chromium. Skuteczn metod wyczenia pamici podrcznej bfcache jest u偶ycie `RelatedActiveContentsExist`, osignite poprzez otwarcie strony za pomoc `window.open()`, kt贸ra zachowuje odwoanie do `window.opener`.

Reprodukcja zachowania:

1. Odwied藕 stron internetow, np. `https://example.com`.
2. Wykonaj polecenie `open("http://spanote.seccon.games:3000/api/token")`, co skutkuje odpowiedzi serwera z kodem stanu 500.
3. W nowo otwartej karcie przejd藕 do `http://spanote.seccon.games:3000/`. Ta czynno spowoduje zapisanie odpowiedzi z `http://spanote.seccon.games:3000/api/token` w pamici podrcznej dysku.
4. U偶yj `history.back()`, aby przej do poprzedniej strony. Spowoduje to wyrenderowanie zapisanej odpowiedzi JSON na stronie.

Potwierdzenie wykorzystania pamici podrcznej dysku mo偶na sprawdzi za pomoc narzdzi DevTools w Google Chrome.

Aby uzyska dalsze szczeg贸y na temat pamici podrcznej bfcache i dysku, mo偶na odnale藕 odnoniki na stronach [web.dev na temat bfcache](https://web.dev/i18n/en/bfcache/) i [dokumentacji Chromium na temat pamici podrcznej dysku](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/).
