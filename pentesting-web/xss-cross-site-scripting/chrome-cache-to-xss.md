# Chrome Cache to XSS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me no** **Twitter** **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Mais detalhes [**neste artigo**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

A tÃ©cnica discutida aqui envolve entender o comportamento e a interaÃ§Ã£o de dois tipos principais de cache: o **cache de avanÃ§o/volta (bfcache)** e o **cache de disco**. O bfcache, que armazena uma captura completa de uma pÃ¡gina, incluindo o heap JavaScript, Ã© priorizado sobre o cache de disco para navegaÃ§Ãµes de avanÃ§o/volta devido Ã  sua capacidade de armazenar uma captura mais abrangente. O cache de disco, por outro lado, armazena recursos buscados na web sem incluir o heap JavaScript e Ã© utilizado para navegaÃ§Ãµes de avanÃ§o/volta para reduzir os custos de comunicaÃ§Ã£o. Um aspecto interessante do cache de disco Ã© a inclusÃ£o de recursos buscados usando `fetch`, o que significa que os recursos de URL acessados serÃ£o renderizados pelo navegador a partir do cache.

### Pontos Chave:

- O **bfcache** tem precedÃªncia sobre o cache de disco em navegaÃ§Ãµes de avanÃ§o/volta.
- Para utilizar uma pÃ¡gina armazenada no cache de disco em vez do bfcache, este Ãºltimo deve ser desativado.

### Desativando o bfcache:

Por padrÃ£o, o Puppeteer desativa o bfcache, alinhando-se com as condiÃ§Ãµes listadas na documentaÃ§Ã£o do Chromium. Um mÃ©todo eficaz para desativar o bfcache Ã© atravÃ©s do uso de `RelatedActiveContentsExist`, alcanÃ§ado abrindo uma pÃ¡gina com `window.open()` que mantÃ©m uma referÃªncia a `window.opener`.

### Reproduzindo o comportamento:

1. Visite uma pÃ¡gina da web, por exemplo, `https://example.com`.
2. Execute `open("http://spanote.seccon.games:3000/api/token")`, o que resulta em uma resposta do servidor com um cÃ³digo de status 500.
3. Na nova aba aberta, navegue para `http://spanote.seccon.games:3000/`. Essa aÃ§Ã£o armazena a resposta de `http://spanote.seccon.games:3000/api/token` como cache de disco.
4. Use `history.back()` para navegar de volta. A aÃ§Ã£o resulta na renderizaÃ§Ã£o da resposta JSON em cache na pÃ¡gina.

A verificaÃ§Ã£o de que o cache de disco foi utilizado pode ser confirmada atravÃ©s do uso do DevTools no Google Chrome.

Para mais detalhes sobre bfcache e cache de disco, as referÃªncias podem ser encontradas em [web.dev sobre bfcache](https://web.dev/i18n/en/bfcache/) e nos [documentos de design do Chromium sobre cache de disco](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/), respectivamente.


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Trabalha em uma **empresa de ciberseguranÃ§a**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me no** **Twitter** **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
