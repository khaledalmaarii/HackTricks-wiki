# Chrome Cache to XSS

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Mais detalhes aprofundados [**neste artigo**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

A t√©cnica discutida aqui envolve entender o comportamento e a intera√ß√£o de dois tipos principais de cache: o **cache de avan√ßo/volta (bfcache)** e o **cache de disco**. O bfcache, que armazena uma captura completa de uma p√°gina, incluindo o heap JavaScript, √© priorizado sobre o cache de disco para navega√ß√µes de avan√ßo/volta devido √† sua capacidade de armazenar uma captura mais abrangente. O cache de disco, por outro lado, armazena recursos obtidos da web sem incluir o heap JavaScript e √© utilizado para navega√ß√µes de avan√ßo/volta para reduzir os custos de comunica√ß√£o. Um aspecto interessante do cache de disco √© a inclus√£o de recursos obtidos usando `fetch`, o que significa que os recursos de URL acessados ser√£o renderizados pelo navegador a partir do cache.

### Pontos Chave:

- O **bfcache** tem preced√™ncia sobre o cache de disco em navega√ß√µes de avan√ßo/volta.
- Para utilizar uma p√°gina armazenada no cache de disco em vez do bfcache, este √∫ltimo deve ser desativado.

### Desativando o bfcache:

Por padr√£o, o Puppeteer desativa o bfcache, alinhando-se com as condi√ß√µes listadas na documenta√ß√£o do Chromium. Um m√©todo eficaz para desativar o bfcache √© atrav√©s do uso de `RelatedActiveContentsExist`, alcan√ßado abrindo uma p√°gina com `window.open()` que mant√©m uma refer√™ncia a `window.opener`.

### Reproduzindo o comportamento:

1. Visite uma p√°gina da web, por exemplo, `https://example.com`.
2. Execute `open("http://spanote.seccon.games:3000/api/token")`, o que resulta em uma resposta do servidor com um c√≥digo de status 500.
3. Na nova aba aberta, navegue para `http://spanote.seccon.games:3000/`. Essa a√ß√£o armazena a resposta de `http://spanote.seccon.games:3000/api/token` como cache de disco.
4. Use `history.back()` para navegar de volta. A a√ß√£o resulta na renderiza√ß√£o da resposta JSON em cache na p√°gina.

A verifica√ß√£o de que o cache de disco foi utilizado pode ser confirmada atrav√©s do uso do DevTools no Google Chrome.

Para mais detalhes sobre bfcache e cache de disco, as refer√™ncias podem ser encontradas em [web.dev sobre bfcache](https://web.dev/i18n/en/bfcache/) e nos [documentos de design do Chromium sobre cache de disco](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/), respectivamente.


<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
