# DOM Ä°stilacÄ±sÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na (https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

## DOM Ä°stilacÄ±sÄ±

DOM Ä°stilacÄ±sÄ±, Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±na yÃ¼klenen bir tarayÄ±cÄ± aracÄ±dÄ±r. Web mesajlarÄ± ve prototip kirliliÄŸi de dahil olmak Ã¼zere Ã§eÅŸitli kaynaklar ve sÄ±zÄ±ntÄ±lar kullanarak **DOM XSS zafiyetlerini tespit etmede yardÄ±mcÄ± olur**. AracÄ±n uzantÄ± olarak Ã¶nceden yÃ¼klenmiÅŸtir.

DOM Ä°stilacÄ±sÄ±, aÅŸaÄŸÄ±dakileri saÄŸlayan tarayÄ±cÄ±nÄ±n DevTools panelinde bir sekme entegre eder:

1. DOM XSS testi iÃ§in bir web sayfasÄ±ndaki **kontrol edilebilir sÄ±zÄ±ntÄ±larÄ±n tanÄ±mlanmasÄ±**, baÄŸlam ve temizleme ayrÄ±ntÄ±larÄ± saÄŸlar.
2. DOM XSS testi iÃ§in `postMessage()` yÃ¶ntemi aracÄ±lÄ±ÄŸÄ±yla gÃ¶nderilen **web mesajlarÄ±nÄ±n kaydedilmesi, dÃ¼zenlenmesi ve yeniden gÃ¶nderilmesi**. DOM Ä°stilacÄ±sÄ± ayrÄ±ca Ã¶zel olarak oluÅŸturulmuÅŸ web mesajlarÄ±nÄ± kullanarak zafiyetleri otomatik olarak tespit edebilir.
3. **Ä°stemci tarafÄ± prototip kirliliÄŸi** kaynaklarÄ±nÄ±n tespiti ve riskli sÄ±zÄ±ntÄ±lara gÃ¶nderilen kontrol edilebilir cihazlarÄ±n taranmasÄ±.
4. **DOM clobbering zafiyetlerinin tanÄ±mlanmasÄ±**.

### EtkinleÅŸtirme

Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±nda **Burp uzantÄ±sÄ±**na gidin ve etkinleÅŸtirin:

<figure><img src="../../.gitbook/assets/image (1129).png" alt=""><figcaption></figcaption></figure>

Åimdi sayfayÄ± yenileyin ve **Dev AraÃ§lar**'da **DOM Ä°stilacÄ±sÄ± sekmesini** bulacaksÄ±nÄ±z:

<figure><img src="../../.gitbook/assets/image (695).png" alt=""><figcaption></figcaption></figure>

### Bir Kanarya Enjekte Edin

Ã–nceki gÃ¶rÃ¼ntÃ¼de **rastgele bir karakter grubu olan Kanarya'yÄ±** gÃ¶rebilirsiniz. Åimdi bunu web'in farklÄ± bÃ¶lÃ¼mlerine (parametreler, formlar, url...) enjekte etmeye baÅŸlamalÄ±sÄ±nÄ±z ve her seferinde aramaya tÄ±klamalÄ±sÄ±nÄ±z. DOM Ä°stilacÄ±sÄ±, **kanaryanÄ±n ilginÃ§ bir sÄ±zÄ±ntÄ±da sona erip ermediÄŸini** kontrol edecektir.

AyrÄ±ca, **URL parametrelerini enjekte et** ve FormlarÄ± enjekte et** seÃ§enekleri, her bulduÄŸu **URL** parametresine ve **form**a **kanaryayÄ± enjekte ederek** otomatik olarak yeni bir sekme aÃ§acaktÄ±r.

### BoÅŸ Bir Kanarya Enjekte Edin

EÄŸer sayfanÄ±n sahip olabileceÄŸi potansiyel sÄ±zÄ±ntÄ±larÄ± bulmak istiyorsanÄ±z, bunlar sÃ¶mÃ¼rÃ¼lebilir olmasa bile **boÅŸ bir kanarya arayabilirsiniz**.

### Mesajlar GÃ¶nderme

DOM Ä°stilacÄ±sÄ±, web mesajlarÄ±nÄ± kullanarak DOM XSS testi yapmaya olanak tanÄ±r ve ÅŸu Ã¶zelliklere sahiptir:

1. `postMessage()` ile gÃ¶nderilen **web mesajlarÄ±nÄ±n kaydedilmesi**, Burp Proxy'nin HTTP istek/yanÄ±t geÃ§miÅŸi kaydÄ± gibi.
2. DOM XSS iÃ§in manuel olarak test etmek iÃ§in web mesajlarÄ±nÄ± **dÃ¼zenleme** ve **yeniden gÃ¶nderme**, Burp Repeater'Ä±n iÅŸlevine benzer.
3. DOM XSS'yi sorgulamak iÃ§in **otomatik deÄŸiÅŸiklik** ve web mesajlarÄ±nÄ±n gÃ¶nderilmesi.

#### Mesaj ayrÄ±ntÄ±larÄ±

Her mesaj hakkÄ±nda ayrÄ±ntÄ±lÄ± bilgi, mesajÄ±n Ã¼zerine tÄ±klanarak gÃ¶rÃ¼ntÃ¼lenebilir ve bu bilgiler, istemci tarafÄ±ndaki JavaScript'in mesajÄ±n `origin`, `data` veya `source` Ã¶zelliklerine eriÅŸip eriÅŸmediÄŸini iÃ§erir.

* **`origin`** : MesajÄ±n **kÃ¶ken bilgisi kontrol edilmediyse**, olay iÅŸleyicisine **herhangi bir harici alandan Ã§apraz kÃ¶kenli mesajlar gÃ¶nderebilirsiniz**. Ancak kontrol edilirse yine de gÃ¼vensiz olabilir.
* **`data`**: Bu, yÃ¼kÃ¼n gÃ¶nderildiÄŸi yerdir. Bu veri kullanÄ±lmÄ±yorsa, sÄ±zÄ±ntÄ± iÅŸe yaramaz.
* **`source`**: Genellikle bir iframe'e referans olan kaynak Ã¶zelliÄŸinin, kÃ¶ken yerine doÄŸrulandÄ±ÄŸÄ±nÄ± deÄŸerlendirir. Bu kontrol edilse bile, doÄŸrulamanÄ±n atlatÄ±lamayacaÄŸÄ±nÄ± garanti etmez.

#### Bir mesajÄ± yanÄ±tla

1. **Mesajlar** gÃ¶rÃ¼nÃ¼mÃ¼nden herhangi bir mesaja tÄ±klayarak mesaj ayrÄ±ntÄ±larÄ± iletiÅŸim kutusunu aÃ§Ä±n.
2. Gerekirse **Veri** alanÄ±nÄ± dÃ¼zenleyin.
3. **GÃ¶nder**e tÄ±klayÄ±n.

### Prototip KirliliÄŸi

DOM Ä°stilacÄ±sÄ± ayrÄ±ca **Prototip KirliliÄŸi zafiyetlerini arayabilir**. Ä°lk olarak, bunu etkinleÅŸtirmeniz gerekir:

<figure><img src="../../.gitbook/assets/image (1026).png" alt=""><figcaption></figcaption></figure>

Daha sonra, **`Object.prototype`'ye keyfi Ã¶zellikler eklemenizi saÄŸlayan kaynaklarÄ± arayacaktÄ±r**.

Herhangi bir ÅŸey bulunursa, **Test** dÃ¼ÄŸmesi gÃ¶rÃ¼necek ve **bulunan kaynaÄŸÄ± test etmek iÃ§in** Ã¼zerine tÄ±klamanÄ±z gerekecektir. Yeni bir sekme aÃ§Ä±lacak, konsolda bir nesne oluÅŸturacak ve `testproperty`'nin var olup olmadÄ±ÄŸÄ±nÄ± kontrol edecektir:
```javascript
let b = {}
b.testproperty
```
Bir kaynak bulduÄŸunuzda **gadget taramasÄ± yapabilirsiniz**:

1. **Tarama iÃ§in gadgetlarÄ± tarayÄ±n** dÃ¼ÄŸmesine tÄ±klandÄ±ÄŸÄ±nda, DOM gÃ¶rÃ¼nÃ¼mÃ¼nde herhangi bir belirlenmiÅŸ prototip kirliliÄŸi kaynaÄŸÄ±nÄ±n yanÄ±nda bulunan **Scan for gadgets** dÃ¼ÄŸmesine tÄ±klandÄ±ÄŸÄ±nda, DOM Invader tarafÄ±ndan yeni bir sekme aÃ§Ä±lÄ±r. ArdÄ±ndan uygun gadget'lar iÃ§in tarama baÅŸlar.
2. AynÄ± sekmede, tarama tamamlandÄ±ktan sonra, tanÄ±mlanan gadget'lar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilen herhangi bir sÄ±zÄ±ntÄ±, **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde gÃ¶sterilir. Ã–rneÄŸin, `innerHTML` sÄ±zÄ±ntÄ±sÄ±na iletilen `html` adlÄ± bir gadget Ã¶zelliÄŸi aÅŸaÄŸÄ±daki Ã¶rnekte gÃ¶sterilir.

## DOM clobbering

Ã–nceki gÃ¶rÃ¼ntÃ¼de DOM clobbering taramasÄ±nÄ±n aÃ§Ä±labileceÄŸi gÃ¶rÃ¼lebilir. BittiÄŸinde, **DOM Invader DOM clobbering zafiyetlerini aramaya baÅŸlayacaktÄ±r**.

## Referanslar

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
