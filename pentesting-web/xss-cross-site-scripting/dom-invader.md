# DOM Invader

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DOM Invader

DOM InvaderëŠ” Burpì˜ ë‚´ì¥ ë¸Œë¼ìš°ì €ì— ì„¤ì¹˜ëœ ë¸Œë¼ìš°ì € ë„êµ¬ì…ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” ì›¹ ë©”ì‹œì§€ ë° í”„ë¡œí† íƒ€ì… ì˜¤ì—¼ì„ í¬í•¨í•œ ë‹¤ì–‘í•œ ì†ŒìŠ¤ì™€ ì‹±í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ **DOM XSS ì·¨ì•½ì **ì„ **íƒì§€í•˜ëŠ” ë°** ë„ì›€ì„ ì¤ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” í™•ì¥ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì‚¬ì „ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

DOM InvaderëŠ” ë¸Œë¼ìš°ì €ì˜ DevTools íŒ¨ë„ ë‚´ì— íƒ­ì„ í†µí•©í•˜ì—¬ ë‹¤ìŒì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤:

1. **DOM XSS í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì›¹í˜ì´ì§€ì—ì„œ ì œì–´ ê°€ëŠ¥í•œ ì‹±í¬ ì‹ë³„**, ì»¨í…ìŠ¤íŠ¸ ë° ì •í™” ì„¸ë¶€ì •ë³´ ì œê³µ.
2. **`postMessage()` ë©”ì„œë“œë¥¼ í†µí•´ ì „ì†¡ëœ ì›¹ ë©”ì‹œì§€ì˜ ë¡œê¹…, í¸ì§‘ ë° ì¬ì „ì†¡**ì„ ìœ„í•œ DOM XSS í…ŒìŠ¤íŠ¸. DOM InvaderëŠ” íŠ¹ë³„íˆ ì œì‘ëœ ì›¹ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì·¨ì•½ì ì„ ìë™ìœ¼ë¡œ íƒì§€í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
3. **í´ë¼ì´ì–¸íŠ¸ ì¸¡ í”„ë¡œí† íƒ€ì… ì˜¤ì—¼** ì†ŒìŠ¤ íƒì§€ ë° ìœ„í—˜í•œ ì‹±í¬ë¡œ ì „ì†¡ëœ ì œì–´ ê°€ëŠ¥í•œ ê°€ì ¯ ìŠ¤ìº”.
4. **DOM í´ë¡œë²„ë§ ì·¨ì•½ì ** ì‹ë³„.

### Enable It

Burpì˜ ë‚´ì¥ ë¸Œë¼ìš°ì €ì—ì„œ **Burp í™•ì¥**ìœ¼ë¡œ ì´ë™í•˜ì—¬ í™œì„±í™”í•©ë‹ˆë‹¤:

<figure><img src="../../.gitbook/assets/image (1129).png" alt=""><figcaption></figcaption></figure>

ì´ì œ í˜ì´ì§€ë¥¼ ìƒˆë¡œ ê³ ì¹˜ê³  **Dev Tools**ì—ì„œ **DOM Invader íƒ­**ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../.gitbook/assets/image (695).png" alt=""><figcaption></figcaption></figure>

### Inject a Canary

ì´ì „ ì´ë¯¸ì§€ì—ì„œ **ë¬´ì‘ìœ„ ë¬¸ì ê·¸ë£¹, ì¦‰ Canary**ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì œ ì›¹ì˜ ë‹¤ì–‘í•œ ë¶€ë¶„(ë§¤ê°œë³€ìˆ˜, ì–‘ì‹, URL ë“±)ì— **ì£¼ì…**í•˜ê¸° ì‹œì‘í•˜ê³  ë§¤ë²ˆ ê²€ìƒ‰ì„ í´ë¦­í•˜ì„¸ìš”. DOM InvaderëŠ” **canaryê°€ ì–´ë–¤ í¥ë¯¸ë¡œìš´ ì‹±í¬ì— ë„ë‹¬í–ˆëŠ”ì§€** í™•ì¸í•©ë‹ˆë‹¤.

ë˜í•œ, **Inject URL params** ë° Inject forms ì˜µì…˜ì€ **ìƒˆ íƒ­**ì„ ìë™ìœ¼ë¡œ ì—´ì–´ **canary**ë¥¼ ì°¾ì€ ëª¨ë“  **URL** ë§¤ê°œë³€ìˆ˜ì™€ **ì–‘ì‹**ì— **ì£¼ì…**í•©ë‹ˆë‹¤.

### Inject an empty Canary

í˜ì´ì§€ì— ì ì¬ì ì¸ ì‹±í¬ê°€ ìˆëŠ”ì§€ ì°¾ê³  ì‹¶ì§€ë§Œ, ê·¸ê²ƒì´ ì•…ìš© ê°€ëŠ¥í•˜ì§€ ì•Šë”ë¼ë„, **ë¹ˆ canaryë¥¼ ê²€ìƒ‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Post Messages

DOM InvaderëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ê°–ì¶˜ ì›¹ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ DOM XSSë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **`postMessage()`ë¥¼ í†µí•´ ì „ì†¡ëœ ì›¹ ë©”ì‹œì§€ ë¡œê¹…**, Burp Proxyì˜ HTTP ìš”ì²­/ì‘ë‹µ ê¸°ë¡ ë¡œê¹…ê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.
2. **ì›¹ ë©”ì‹œì§€ì˜ ìˆ˜ì • ë° ì¬ë°œí–‰**ì„ í†µí•´ DOM XSSë¥¼ ìˆ˜ë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìœ¼ë©°, Burp Repeaterì˜ ê¸°ëŠ¥ê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.
3. **ì›¹ ë©”ì‹œì§€ì˜ ìë™ ë³€ê²½ ë° ì „ì†¡**ì„ í†µí•´ DOM XSSë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤.

#### Message details

ê° ë©”ì‹œì§€ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” í´ë¦­í•˜ì—¬ ë³¼ ìˆ˜ ìˆìœ¼ë©°, ì—¬ê¸°ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScriptê°€ ë©”ì‹œì§€ì˜ `origin`, `data` ë˜ëŠ” `source` ì†ì„±ì— ì ‘ê·¼í•˜ëŠ”ì§€ ì—¬ë¶€ê°€ í¬í•¨ë©ë‹ˆë‹¤.

* **`origin`** : ë©”ì‹œì§€ì˜ **origin ì •ë³´ê°€ í™•ì¸ë˜ì§€ ì•Šìœ¼ë©´**, ì„ì˜ì˜ ì™¸ë¶€ ë„ë©”ì¸ì—ì„œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ êµì°¨ ì¶œì²˜ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í™•ì¸ë˜ë©´ ì—¬ì „íˆ ì•ˆì „í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`data`**: í˜ì´ë¡œë“œê°€ ì „ì†¡ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì´ ë°ì´í„°ê°€ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©´, ì‹±í¬ëŠ” ì“¸ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.
* **`source`**: ì¼ë°˜ì ìœ¼ë¡œ iframeì„ ì°¸ì¡°í•˜ëŠ” source ì†ì„±ì´ origin ëŒ€ì‹  ê²€ì¦ë˜ëŠ”ì§€ í‰ê°€í•©ë‹ˆë‹¤. ì´ê²ƒì´ í™•ì¸ë˜ë”ë¼ë„ ê²€ì¦ì´ ìš°íšŒë  ìˆ˜ ì—†ë‹¤ëŠ” ë³´ì¥ì€ ì—†ìŠµë‹ˆë‹¤.

#### Reply a message

1. **Messages** ë³´ê¸°ì—ì„œ ì•„ë¬´ ë©”ì‹œì§€ë¥¼ í´ë¦­í•˜ì—¬ ë©”ì‹œì§€ ì„¸ë¶€ì •ë³´ ëŒ€í™” ìƒìë¥¼ ì—½ë‹ˆë‹¤.
2. í•„ìš”í•œ ëŒ€ë¡œ **Data** í•„ë“œë¥¼ í¸ì§‘í•©ë‹ˆë‹¤.
3. **Send**ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.

### Prototype Pollution

DOM InvaderëŠ” **Prototype Pollution ì·¨ì•½ì **ì„ ê²€ìƒ‰í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë¨¼ì €, ì´ë¥¼ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤:

<figure><img src="../../.gitbook/assets/image (1026).png" alt=""><figcaption></figcaption></figure>

ê·¸ëŸ° ë‹¤ìŒ, **`Object.prototype`**ì— ì„ì˜ì˜ ì†ì„±ì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” **ì†ŒìŠ¤**ë¥¼ **ê²€ìƒ‰**í•©ë‹ˆë‹¤.

ë¬´ì–¸ê°€ê°€ ë°œê²¬ë˜ë©´ **ì°¾ì€ ì†ŒìŠ¤ë¥¼ í…ŒìŠ¤íŠ¸**í•˜ê¸° ìœ„í•œ **Test** ë²„íŠ¼ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. í´ë¦­í•˜ë©´ ìƒˆ íƒ­ì´ ì—´ë¦¬ê³ , ì½˜ì†”ì—ì„œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  `testproperty`ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤:
```javascript
let b = {}
b.testproperty
```
í•œ ë²ˆ ì†ŒìŠ¤ë¥¼ ì°¾ìœ¼ë©´ **ê°€ì ¯ ìŠ¤ìº”**ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **DOM** ë·°ì—ì„œ í™•ì¸ëœ í”„ë¡œí† íƒ€ì… ì˜¤ì—¼ ì†ŒìŠ¤ ì˜†ì— ìˆëŠ” **ê°€ì ¯ ìŠ¤ìº”** ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ DOM Invaderì— ì˜í•´ ìƒˆ íƒ­ì´ ì—´ë¦½ë‹ˆë‹¤. ì í•©í•œ ê°€ì ¯ì— ëŒ€í•œ ìŠ¤ìº”ì´ ì‹œì‘ë©ë‹ˆë‹¤.
2. í•œí¸, ê°™ì€ íƒ­ì—ì„œ DevTools íŒ¨ë„ì— **DOM Invader** íƒ­ì´ ì—´ë ¤ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ìŠ¤ìº”ì´ ì™„ë£Œë˜ë©´ í™•ì¸ëœ ê°€ì ¯ì„ í†µí•´ ì ‘ê·¼ ê°€ëŠ¥í•œ ëª¨ë“  ì‹±í¬ê°€ **DOM** ë·°ì— í‘œì‹œë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `innerHTML` ì‹±í¬ì— ì „ë‹¬ë˜ëŠ” `html`ì´ë¼ëŠ” ê°€ì ¯ ì†ì„±ì´ ì•„ë˜ ì˜ˆì œì— í‘œì‹œë©ë‹ˆë‹¤.

## DOM í´ë¡œë²„ë§

ì´ì „ ì´ë¯¸ì§€ì—ì„œ DOM í´ë¡œë²„ë§ ìŠ¤ìº”ì„ ì¼¤ ìˆ˜ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ **DOM InvaderëŠ” DOM í´ë¡œë²„ë§ ì·¨ì•½ì ì„ ê²€ìƒ‰í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤**.

## References

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
