# DOM Invader

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## DOM Invader

DOM Invader je alat za pregledaÄ instaliran u ugraÄ‘enom pregledaÄu u Burp-u. PomaÅ¾e u **otkrivanju DOM XSS ranjivosti** koristeÄ‡i razliÄite izvore i slivove, ukljuÄujuÄ‡i web poruke i zagaÄ‘enje prototipa. Alat je unapred instaliran kao ekstenzija.

DOM Invader integriÅ¡e karticu unutar DevTools panela pregledaÄa omoguÄ‡avajuÄ‡i sledeÄ‡e:

1. **Identifikacija kontrolabilnih slivova** na veb stranici za DOM XSS testiranje, pruÅ¾ajuÄ‡i kontekst i detalje o sanitizaciji.
2. **Logovanje, ureÄ‘ivanje i ponovno slanje web poruka** poslatih putem metode `postMessage()` za DOM XSS testiranje. DOM Invader takoÄ‘e moÅ¾e automatski otkriti ranjivosti koriÅ¡Ä‡enjem posebno kreiranih web poruka.
3. Otkrivanje **izvora zagaÄ‘enja prototipa na klijentskoj strani** i skeniranje kontrolabilnih gedÅ¾eta poslatih ka riziÄnim slivovima.
4. Identifikacija **DOM clobbering ranjivosti**.

### OmoguÄ‡ite ga

U ugraÄ‘enom pregledaÄu u Burp-u idite na **Burp ekstenzije** i omoguÄ‡ite ga:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Sada osveÅ¾ite stranicu i u **Dev Tools**-ima Ä‡ete pronaÄ‡i **DOM Invader karticu:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Ubacite kanarince

Na prethodnoj slici moÅ¾ete videti **nasumiÄnu grupu karaktera, to je kanarinka**. Sada treba da poÄnete da je **ubacujete** na razliÄite delove veba (parametre, forme, url...) i svaki put kliknite na pretragu. DOM Invader Ä‡e proveriti da li je **kanarinka zavrÅ¡ila u nekom interesantnom slivu** koji bi mogao biti iskoriÅ¡Ä‡en.

Osim toga, opcije **Ubaci URL parametre** i Ubaci forme Ä‡e automatski otvoriti **novu karticu** **ubacujuÄ‡i** **kanarinku** u svaki **URL** parametar i **formu** koju pronaÄ‘e.

### Ubacite praznu kanarinku

Ako Å¾elite samo da pronaÄ‘ete potencijalne slivove koje stranica moÅ¾e imati, Äak i ako nisu iskoriÅ¡Ä‡ivi, moÅ¾ete **traÅ¾iti praznu kanarinku**.

### PoÅ¡aljite poruke

DOM Invader omoguÄ‡ava testiranje za DOM XSS koriÅ¡Ä‡enjem web poruka sa funkcijama kao Å¡to su:

1. **Logovanje web poruka** poslatih putem `postMessage()`, sliÄno logovanju istorije HTTP zahteva/odgovora u Burp Proxy-u.
2. **Modifikacija** i **ponovno slanje** web poruka radi ruÄnog testiranja za DOM XSS, sliÄno funkciji Burp Repeater-a.
3. **Automatska izmena** i slanje web poruka za ispitivanje DOM XSS-a.

#### Detalji poruke

Detaljne informacije mogu se videti o svakoj poruci klikom na nju, Å¡to ukljuÄuje da li klijentski JavaScript pristupa svojstvima `origin`, `data` ili `source` poruke.

* **`origin`** : Ako **informacije o poreklu poruke nisu proverene**, moÅ¾da Ä‡ete moÄ‡i da Å¡aljete poruke preko granica dogaÄ‘aja **sa proizvoljnog spoljnog domena**. Ali ako je provereno, i dalje moÅ¾e biti nesigurno.
* **`data`**: Ovde se Å¡alje payload. Ako se ovi podaci ne koriste, sliv je beskoristan.
* **`source`**: Procenjuje da li je svojstvo izvora, obiÄno referencirajuÄ‡i iframe, validirano umesto porekla. ÄŒak i ako je ovo provereno, ne garantuje da validacija ne moÅ¾e biti zaobiÄ‘ena.

#### Odgovorite na poruku

1. Iz **Prikaza poruka**, kliknite na bilo koju poruku da otvorite dijalog sa detaljima poruke.
2. Uredite polje **Podaci** po potrebi.
3. Kliknite na **PoÅ¡alji**.

### ZagaÄ‘enje prototipa

DOM Invader takoÄ‘e moÅ¾e traÅ¾iti **ranjivosti zagaÄ‘enja prototipa**. Prvo, treba da ga omoguÄ‡ite:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Zatim, Ä‡e **traÅ¾iti izvore** koji vam omoguÄ‡avaju da dodate proizvoljna svojstva **`Object.prototype`**.

Ako se pronaÄ‘e neÅ¡to, pojaviÄ‡e se dugme **Test** za **testiranje pronaÄ‘enog izvora**. Kliknite na njega, pojaviÄ‡e se nova kartica, kreirajte objekat u konzoli i proverite da li postoji `testproperty`:
```javascript
let b = {}
b.testproperty
```
Kada pronaÄ‘ete izvor, moÅ¾ete **skenirati za ureÄ‘aj**:

1. Novi tab se otvara kada se klikne dugme **Skeniraj za ureÄ‘aje**, koje se moÅ¾e pronaÄ‡i pored identifikovanog izvora zagaÄ‘enja prototipa u prikazu **DOM**. Tada poÄinje skeniranje odgovarajuÄ‡ih ureÄ‘aja.
2. U meÄ‘uvremenu, u istom tabu, treba otvoriti karticu **DOM Invader** u panelu DevTools. Nakon zavrÅ¡etka skeniranja, bilo koji otvori pristupaÄni putem identifikovanih ureÄ‘aja prikazuju se u prikazu **DOM**. Na primer, svojstvo ureÄ‘aja nazvano `html` koje se prosleÄ‘uje otvoru `innerHTML` prikazano je u primeru ispod.

## DOM preplavljenje

Na prethodnoj slici moguÄ‡e je videti da se skeniranje DOM preplavljenja moÅ¾e ukljuÄiti. Kada se zavrÅ¡i, **DOM Invader Ä‡e poÄeti traÅ¾iti ranjivosti DOM preplavljenja**.

## Reference

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
