# NajeÅºdÅºca DOM

<details>

<summary><strong>Dowiedz siÄ™, jak hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## NajeÅºdÅºca DOM

NajeÅºdÅºca DOM to narzÄ™dzie przeglÄ…darki zainstalowane w wbudowanej przeglÄ…darce Burp. Pomaga w **wykrywaniu podatnoÅ›ci na XSS DOM** za pomocÄ… rÃ³Å¼nych ÅºrÃ³deÅ‚ i ujÅ›Ä‡, w tym wiadomoÅ›ci internetowych i zanieczyszczenia prototypu. NarzÄ™dzie jest zainstalowane domyÅ›lnie jako rozszerzenie.

NajeÅºdÅºca DOM integruje zakÅ‚adkÄ™ w panelu NarzÄ™dzi Deweloperskich przeglÄ…darki, umoÅ¼liwiajÄ…c:

1. **IdentyfikacjÄ™ kontrolowalnych ujÅ›Ä‡** na stronie internetowej do testowania XSS DOM, dostarczajÄ…c kontekstu i szczegÃ³Å‚Ã³w dotyczÄ…cych sanitacji.
2. **Rejestrowanie, edytowanie i ponowne wysyÅ‚anie wiadomoÅ›ci internetowych** wysÅ‚anych za pomocÄ… metody `postMessage()` do testowania XSS DOM. NajeÅºdÅºca DOM moÅ¼e rÃ³wnieÅ¼ automatycznie wykrywaÄ‡ podatnoÅ›ci za pomocÄ… specjalnie przygotowanych wiadomoÅ›ci internetowych.
3. Wykrywanie ÅºrÃ³deÅ‚ **zanieczyszczenia prototypu po stronie klienta** i skanowanie kontrolowalnych gadÅ¼etÃ³w wysyÅ‚anych do ryzykownych ujÅ›Ä‡.
4. IdentyfikacjÄ™ **podatnoÅ›ci na zastÄ™powanie DOM**.

### WÅ‚Ä…cz to

W wbudowanej przeglÄ…darce Burp przejdÅº do **rozszerzenia Burp** i wÅ‚Ä…cz je:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Teraz odÅ›wieÅ¼ stronÄ™ i w **NarzÄ™dziach Deweloperskich** znajdziesz zakÅ‚adkÄ™ **NajeÅºdÅºca DOM:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Wstrzyknij kanarka

Na poprzednim obrazie moÅ¼esz zobaczyÄ‡ **losowÄ… grupÄ™ znakÃ³w, ktÃ³ra jest kanarkiem**. Teraz powinieneÅ› zaczÄ…Ä‡ **wstrzykiwaÄ‡** go w rÃ³Å¼ne czÄ™Å›ci strony internetowej (parametry, formularze, adres URL...) i za kaÅ¼dym razem kliknÄ…Ä‡ szukaj. NajeÅºdÅºca DOM sprawdzi, czy **kanarek trafiÅ‚ do jakiegokolwiek interesujÄ…cego ujÅ›cia**, ktÃ³re moÅ¼na by wykorzystaÄ‡.

Co wiÄ™cej, opcje **Wstrzyknij parametry URL** i Wstrzyknij formularze automatycznie otworzÄ… **nowÄ… kartÄ™** **wstrzykujÄ…c** **kanarka** w kaÅ¼dym parametrze **URL** i **formularzu**, ktÃ³re znajdzie.

### Wstrzyknij pusty kanarek

JeÅ›li chcesz tylko znaleÅºÄ‡ potencjalne ujÅ›cia, jakie strona moÅ¼e mieÄ‡, nawet jeÅ›li nie sÄ… one wykorzystywalne, moÅ¼esz **szukaÄ‡ pustego kanarka**.

### WiadomoÅ›ci internetowe

NajeÅºdÅºca DOM umoÅ¼liwia testowanie XSS DOM za pomocÄ… wiadomoÅ›ci internetowych z funkcjami takimi jak:

1. **Rejestrowanie wiadomoÅ›ci internetowych** wysÅ‚anych za pomocÄ… `postMessage()`, podobnie jak rejestrowanie historii Å¼Ä…daÅ„/odpowiedzi HTTP w Burp Proxy.
2. **Modyfikacja** i **ponowne wysyÅ‚anie** wiadomoÅ›ci internetowych w celu rÄ™cznego testowania XSS DOM, podobnie jak funkcja Burp Repeater.
3. **Automatyczna zmiana** i wysyÅ‚anie wiadomoÅ›ci internetowych do sondowania XSS DOM.

#### SzczegÃ³Å‚y wiadomoÅ›ci

SzczegÃ³Å‚owe informacje o kaÅ¼dej wiadomoÅ›ci moÅ¼na zobaczyÄ‡, klikajÄ…c na niÄ…, co obejmuje dostÄ™p do wÅ‚aÅ›ciwoÅ›ci `origin`, `data` lub `source` wiadomoÅ›ci przez JavaScript po stronie klienta.

* **`origin`** : JeÅ›li **informacje o pochodzeniu wiadomoÅ›ci nie sÄ… sprawdzane**, moÅ¼esz wysÅ‚aÄ‡ wiadomoÅ›ci miÄ™dzydomenowe do obsÅ‚ugi zdarzeÅ„ **z dowolnej zewnÄ™trznej domeny**. Ale jeÅ›li jest sprawdzane, nadal moÅ¼e to byÄ‡ niebezpieczne.
* **`data`**: Tutaj jest wysyÅ‚ana Å‚adunek. JeÅ›li te dane nie sÄ… uÅ¼ywane, ujÅ›cie jest bezuÅ¼yteczne.
* **`source`**: Ocenia, czy wÅ‚aÅ›ciwoÅ›Ä‡ ÅºrÃ³dÅ‚owa, zazwyczaj odnoszÄ…ca siÄ™ do ramki, jest walidowana zamiast pochodzenia. Nawet jeÅ›li to jest sprawdzane, nie zapewnia to, Å¼e walidacja nie moÅ¼e zostaÄ‡ obejÅ›cia.

#### Odpowiedz na wiadomoÅ›Ä‡

1. Z widoku **WiadomoÅ›ci**, kliknij dowolnÄ… wiadomoÅ›Ä‡, aby otworzyÄ‡ okno szczegÃ³Å‚Ã³w wiadomoÅ›ci.
2. Edytuj pole **Dane** wedÅ‚ug potrzeb.
3. Kliknij **WyÅ›lij**.

### Zanieczyszczenie prototypu

NajeÅºdÅºca DOM moÅ¼e rÃ³wnieÅ¼ szukaÄ‡ **podatnoÅ›ci na zanieczyszczenie prototypu**. Najpierw musisz to wÅ‚Ä…czyÄ‡:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

NastÄ™pnie bÄ™dzie **szukaÄ‡ ÅºrÃ³deÅ‚**, ktÃ³re umoÅ¼liwiajÄ… dodanie dowolnych wÅ‚aÅ›ciwoÅ›ci do **`Object.prototype`**.

JeÅ›li coÅ› zostanie znalezione, pojawi siÄ™ przycisk **Test**, aby **przetestowaÄ‡ znalezione ÅºrÃ³dÅ‚o**. Kliknij na niego, pojawi siÄ™ nowa karta, utwÃ³rz obiekt w konsoli i sprawdÅº, czy `testproperty` istnieje:
```javascript
let b = {}
b.testproperty
```
Gdy juÅ¼ znajdziesz ÅºrÃ³dÅ‚o, moÅ¼esz **przeskanowaÄ‡ urzÄ…dzenie**:

1. Nowa karta zostanie otwarta przez DOM Invader, gdy przycisk **Skanuj urzÄ…dzenie** znajdujÄ…cy siÄ™ obok zidentyfikowanego ÅºrÃ³dÅ‚a zanieczyszczenia prototypu w widoku **DOM** zostanie klikniÄ™ty. NastÄ™pnie rozpocznie siÄ™ skanowanie odpowiednich urzÄ…dzeÅ„.
2. W miÄ™dzyczasie, w tej samej karcie, karta **DOM Invader** powinna byÄ‡ otwarta w panelu NarzÄ™dzi deweloperskich. Po zakoÅ„czeniu skanowania, wszystkie ujÅ›cia dostÄ™pne za pomocÄ… zidentyfikowanych urzÄ…dzeÅ„ sÄ… wyÅ›wietlane w widoku **DOM**. Na przykÅ‚ad, wÅ‚aÅ›ciwoÅ›Ä‡ urzÄ…dzenia o nazwie `html` przekazywana do ujÅ›cia `innerHTML` jest pokazana na poniÅ¼szym przykÅ‚adzie.

## Nadpisywanie DOM

Na poprzednim obrazie moÅ¼na zobaczyÄ‡, Å¼e skanowanie nadpisywania DOM moÅ¼na wÅ‚Ä…czyÄ‡. Gdy to zrobisz, **DOM Invader zacznie szukaÄ‡ podatnoÅ›ci na nadpisywanie DOM**.

## OdnoÅ›niki

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
