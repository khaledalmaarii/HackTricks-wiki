# DOM Invader

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## DOM Invader

DOM Invader je alat za pregledaÄ koji je instaliran u ugraÄ‘enom pregledaÄu Burp-a. PomaÅ¾e u **otkrivanju DOM XSS ranjivosti** koristeÄ‡i razliÄite izvore i ciljeve, ukljuÄujuÄ‡i web poruke i oneÄiÅ¡Ä‡enje prototipa. Alat je unapred instaliran kao ekstenzija.

DOM Invader integriÅ¡e karticu unutar DevTools panela pregledaÄa koja omoguÄ‡ava sledeÄ‡e:

1. **Identifikacija kontrolabilnih ciljeva** na veb stranici za testiranje DOM XSS-a, pruÅ¾ajuÄ‡i kontekst i detalje o sanitizaciji.
2. **Logovanje, ureÄ‘ivanje i ponovno slanje web poruka** poslatih putem metode `postMessage()` za testiranje DOM XSS-a. DOM Invader takoÄ‘e moÅ¾e automatski otkriti ranjivosti koristeÄ‡i posebno kreirane web poruke.
3. Otkrivanje izvora **oneÄiÅ¡Ä‡enja prototipa na klijentskoj strani** i skeniranje kontrolabilnih ureÄ‘aja poslatih na riziÄne ciljeve.
4. Identifikacija ranjivosti **DOM clobbering-a**.

### OmoguÄ‡i ga

U ugraÄ‘enom pregledaÄu Burp-a idite na **Burp ekstenziju** i omoguÄ‡ite je:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Sada osveÅ¾ite stranicu i u **Dev Tools**-u Ä‡ete pronaÄ‡i **karticu DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Ubaci kanarinca

Na prethodnoj slici moÅ¾ete videti **nasumiÄnu grupu znakova, to je kanarinac**. Sada treba da ga poÄnete **ubacivati** na razliÄite delove veba (parametre, forme, URL...) i svaki put kliknite na pretragu. DOM Invader Ä‡e proveriti da li se **kanarinac zavrÅ¡io na nekom interesantnom cilju** koji bi mogao biti iskoriÅ¡Ä‡en.

Osim toga, opcije **Ubaci URL parametre** i **Ubaci forme** Ä‡e automatski otvoriti **novu karticu** i **ubaciti kanarinca** u svaki **URL** parametar i **formu** koju pronaÄ‘e.

### Ubaci praznog kanarinca

Ako Å¾elite samo da pronaÄ‘ete potencijalne ciljeve koje stranica moÅ¾e imati, Äak i ako nisu iskoriÅ¡Ä‡ivi, moÅ¾ete **traÅ¾iti praznog kanarinca**.

### Web poruke

DOM Invader omoguÄ‡ava testiranje DOM XSS-a koriÅ¡Ä‡enjem web poruka sa funkcijama kao Å¡to su:

1. **Logovanje web poruka** poslatih putem `postMessage()`, sliÄno logovanju istorije HTTP zahteva/odgovora u Burp Proxy-u.
2. **Izmena** i **ponovno slanje** web poruka radi ruÄnog testiranja DOM XSS-a, sliÄno funkciji Burp Repeater-a.
3. **Automatska izmena** i slanje web poruka radi ispitivanja DOM XSS-a.

#### Detalji poruke

Detaljne informacije o svakoj poruci mogu se videti klikom na nju, Å¡to ukljuÄuje da li klijentski JavaScript pristupa svojstvima `origin`, `data` ili `source` poruke.

* **`origin`**: Ako **informacije o poreklu poruke nisu proverene**, moÅ¾da Ä‡ete moÄ‡i da Å¡aljete poruke preko granica porekla ka rukovaocu dogaÄ‘aja **sa proizvoljnog spoljnog domena**. Ali ako je provereno, i dalje moÅ¾e biti nesigurno.
* **`data`**: Ovde se Å¡alje payload. Ako se ovi podaci ne koriste, cilj je beskoristan.
* **`source`**: Proverava da li je provereno svojstvo izvora, obiÄno referencirajuÄ‡i iframe, umesto porekla. ÄŒak i ako je ovo provereno, to ne garantuje da validacija ne moÅ¾e biti zaobiÄ‘ena.

#### Odgovor na poruku

1. Iz **Prikaza poruka**, kliknite na bilo koju poruku da biste otvorili dijalog sa detaljima poruke.
2. Uredite polje **Podaci** po potrebi.
3. Kliknite na **PoÅ¡alji**.

### OneÄiÅ¡Ä‡enje prototipa

DOM Invader takoÄ‘e moÅ¾e traÅ¾iti **ranjivosti oneÄiÅ¡Ä‡enja prototipa**. Prvo, trebate ga omoguÄ‡iti:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Zatim, on Ä‡e **traÅ¾iti izvore** koji vam omoguÄ‡avaju da dodate proizvoljna svojstva na **`Object.prototype`**.

Ako se pronaÄ‘e neÅ¡to, pojaviÄ‡e se dugme **Test** za **testiranje pronaÄ‘enog izvora**. Kliknite na njega, pojaviÄ‡e se nova kartica, kreirajte objekat u konzoli i proverite da li postoji `testproperty`:
```javascript
let b = {}
b.testproperty
```
Jednom kada pronaÄ‘ete izvor, moÅ¾ete **skenirati za ureÄ‘aj**:

1. Kada se klikne dugme **Skeniraj za ureÄ‘aje**, koje se moÅ¾e pronaÄ‡i pored bilo kojeg identifikovanog izvora zagaÄ‘enja prototipa u **DOM** prikazu, DOM Invader otvara novu karticu. Zatim poÄinje skeniranje za odgovarajuÄ‡e ureÄ‘aje.
2. U meÄ‘uvremenu, u istoj kartici, treba otvoriti karticu **DOM Invader** u panelu DevTools-a. Nakon zavrÅ¡etka skeniranja, svi izvori zagaÄ‘enja koji su dostupni putem identifikovanih ureÄ‘aja prikazuju se u **DOM** prikazu. Na primer, u donjem primeru se prikazuje svojstvo ureÄ‘aja nazvano `html` koje se prosleÄ‘uje izvoru `innerHTML`.

## DOM zagaÄ‘enje

Na prethodnoj slici je moguÄ‡e videti da se skeniranje za DOM zagaÄ‘enje moÅ¾e ukljuÄiti. Kada se to uradi, **DOM Invader Ä‡e poÄeti traÅ¾iti ranjivosti DOM zagaÄ‘enja**.

## Reference

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
