# DOM Invader

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DOM Invader

DOM Invader je alat za pretraÅ¾ivaÄ instaliran u Burp-ovom ugraÄ‘enom pretraÅ¾ivaÄu. PomaÅ¾e u **otkrivanju DOM XSS ranjivosti** koristeÄ‡i razliÄite izvore i odrediÅ¡ta, ukljuÄujuÄ‡i web poruke i zagaÄ‘enje prototipa. Alat je unapred instaliran kao ekstenzija.

DOM Invader integriÅ¡e karticu unutar DevTools panela pretraÅ¾ivaÄa koja omoguÄ‡ava sledeÄ‡e:

1. **Identifikaciju kontrolisanih odrediÅ¡ta** na veb stranici za DOM XSS testiranje, pruÅ¾ajuÄ‡i kontekst i detalje o sanitizaciji.
2. **Zapisivanje, ureÄ‘ivanje i ponovno slanje web poruka** poslatih putem `postMessage()` metode za DOM XSS testiranje. DOM Invader takoÄ‘e moÅ¾e automatski otkriti ranjivosti koristeÄ‡i posebno oblikovane web poruke.
3. Otkrivanje **izvora zagaÄ‘enja prototipa na klijentskoj strani** i skeniranje kontrolisanih gadgeta poslatih u riziÄna odrediÅ¡ta.
4. Identifikaciju **DOM clobbering ranjivosti**.

### Enable It

U Burp-ovom ugraÄ‘enom pretraÅ¾ivaÄu idite na **Burp ekstenziju** i omoguÄ‡ite je:

<figure><img src="../../.gitbook/assets/image (1129).png" alt=""><figcaption></figcaption></figure>

Sada osveÅ¾ite stranicu i u **Dev Tools** pronaÄ‡i Ä‡ete **DOM Invader karticu:**

<figure><img src="../../.gitbook/assets/image (695).png" alt=""><figcaption></figcaption></figure>

### Inject a Canary

Na prethodnoj slici moÅ¾ete videti **nasumiÄnu grupu karaktera, to je Canary**. Sada biste trebali poÄeti **ubacivati** ga na razliÄitim delovima veba (parametri, forme, url...) i svaki put kliknite na pretragu. DOM Invader Ä‡e proveriti da li je **canary zavrÅ¡io u nekom interesantnom odrediÅ¡tu** koje bi moglo biti iskoriÅ¡Ä‡eno.

Å taviÅ¡e, opcije **Inject URL params** i Inject forms automatski Ä‡e otvoriti **novu karticu** **ubacujuÄ‡i** **canary** u svaki **URL** parametar i **formu** koju pronaÄ‘e.

### Inject an empty Canary

Ako samo Å¾elite da pronaÄ‘ete potencijalna odrediÅ¡ta koja stranica moÅ¾e imati, Äak i ako nisu iskoriÅ¡Ä‡iva, moÅ¾ete **pretraÅ¾ivati za praznim canary**.

### Post Messages

DOM Invader omoguÄ‡ava testiranje za DOM XSS koristeÄ‡i web poruke sa funkcijama kao Å¡to su:

1. **Zapisivanje web poruka** poslatih putem `postMessage()`, sliÄno kao zapisivanje HTTP zahteva/odgovora u Burp Proxy.
2. **Izmena** i **ponovno slanje** web poruka za ruÄno testiranje DOM XSS, sliÄno funkciji Burp Repeater-a.
3. **Automatska izmena** i slanje web poruka za ispitivanje DOM XSS.

#### Message details

Detaljne informacije mogu se videti o svakoj poruci klikom na nju, Å¡to ukljuÄuje da li klijentski JavaScript pristupa `origin`, `data` ili `source` svojstvima poruke.

* **`origin`** : Ako **informacije o poreklu poruke nisu proverene**, moÅ¾da Ä‡ete moÄ‡i da Å¡aljete poruke izmeÄ‘u razliÄitih domena ka upravljaÄu dogaÄ‘ajima **iz proizvoljnog spoljnog domena**. Ali ako se proverava, to i dalje moÅ¾e biti nesigurno.
* **`data`**: Ovo je mesto gde se payload Å¡alje. Ako se ovi podaci ne koriste, odrediÅ¡te je beskorisno.
* **`source`**: Procenjuje da li je svojstvo izvora, obiÄno referencirajuÄ‡i iframe, validirano umesto porekla. ÄŒak i ako se ovo proverava, to ne osigurava da se validacija ne moÅ¾e zaobiÄ‡i.

#### Reply a message

1. Iz **Messages** pregleda, kliknite na bilo koju poruku da otvorite dijalog sa detaljima poruke.
2. Uredite **Data** polje po potrebi.
3. Kliknite **Send**.

### Prototype Pollution

DOM Invader takoÄ‘e moÅ¾e pretraÅ¾ivati za **Prototype Pollution ranjivostima**. Prvo, morate je omoguÄ‡iti:

<figure><img src="../../.gitbook/assets/image (1026).png" alt=""><figcaption></figcaption></figure>

Zatim Ä‡e **pretraÅ¾ivati izvore** koji vam omoguÄ‡avaju da dodate proizvoljna svojstva u **`Object.prototype`**.

Ako se neÅ¡to pronaÄ‘e, pojaviÄ‡e se dugme **Test** da **testirate pronaÄ‘eni izvor**. Kliknite na njega, nova kartica Ä‡e se pojaviti, kreirajte objekat u konzoli i proverite da li `testproperty` postoji:
```javascript
let b = {}
b.testproperty
```
Once you found a source you can **scan for a gadget**:

1. Novi tab se otvara kada se klikne na dugme **Scan for gadgets**, koje se moÅ¾e naÄ‡i pored bilo kojeg identifikovanog izvora prototipne zagaÄ‘enosti u **DOM** prikazu. Skener za odgovarajuÄ‡e gadgete tada poÄinje.
2. U meÄ‘uvremenu, u istom tabu, **DOM Invader** tab treba da bude otvoren u DevTools panelu. Nakon Å¡to skeniranje zavrÅ¡i, svi izlazi dostupni putem identifikovanih gadgeta se prikazuju u **DOM** prikazu. Na primer, svojstvo gadgeta nazvano `html` koje se prosleÄ‘uje `innerHTML` izlazu prikazano je u sledeÄ‡em primeru.

## DOM zagaÄ‘enje

Na prethodnoj slici je moguÄ‡e videti da se skeniranje za DOM zagaÄ‘enje moÅ¾e ukljuÄiti. Kada se to uradi, **DOM Invader Ä‡e poÄeti da traÅ¾i DOM zagaÄ‘ivaÄke ranjivosti**.

## References

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
