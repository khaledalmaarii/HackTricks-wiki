# DOM Invader

<details>

<summary><strong>AWS hackleme becerilerinizi sÄ±fÄ±rdan kahraman seviyesine getirin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile</strong>!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'Ä±** takip edin.
* Hacking hilelerinizi gÃ¶ndererek **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek **hacking hilelerinizi paylaÅŸÄ±n**.

</details>

## DOM Invader

DOM Invader, Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±na yÃ¼klenen bir tarayÄ±cÄ± aracÄ±dÄ±r. Web mesajlarÄ± ve prototip kirliliÄŸi de dahil olmak Ã¼zere Ã§eÅŸitli kaynaklar ve sÄ±zÄ±ntÄ±lar kullanarak **DOM XSS aÃ§Ä±klarÄ±nÄ± tespit etmeye yardÄ±mcÄ± olur**. AraÃ§, bir uzantÄ± olarak Ã¶nceden yÃ¼klenmiÅŸtir.

DOM Invader, tarayÄ±cÄ±nÄ±n DevTools panelinde bir sekme entegre ederek aÅŸaÄŸÄ±dakileri saÄŸlar:

1. DOM XSS testi iÃ§in bir web sayfasÄ±ndaki **kontrol edilebilir sÄ±zÄ±ntÄ±larÄ±n belirlenmesi**, baÄŸlam ve temizleme ayrÄ±ntÄ±larÄ± saÄŸlar.
2. DOM XSS testi iÃ§in `postMessage()` yÃ¶ntemi aracÄ±lÄ±ÄŸÄ±yla gÃ¶nderilen web mesajlarÄ±nÄ±n **gÃ¼nlÃ¼ÄŸÃ¼nÃ¼, dÃ¼zenlemesini ve yeniden gÃ¶ndermesini** saÄŸlar. DOM Invader, Ã¶zel olarak oluÅŸturulmuÅŸ web mesajlarÄ±nÄ± kullanarak zafiyetleri otomatik olarak tespit edebilir.
3. **Ä°stemci tarafÄ± prototip kirliliÄŸi** kaynaklarÄ±nÄ±n tespiti ve riskli sÄ±zÄ±ntÄ±lara gÃ¶nderilen kontrol edilebilir cihazlarÄ±n taramasÄ±.
4. **DOM clobbering aÃ§Ä±klarÄ±nÄ±n** belirlenmesi.

### EtkinleÅŸtirme

Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±nda **Burp uzantÄ±sÄ±**na gidin ve etkinleÅŸtirin:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Åimdi sayfayÄ± yenileyin ve **Dev AraÃ§larÄ±**'nda **DOM Invader sekmesini** bulacaksÄ±nÄ±z:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Bir Canary Enjekte Edin

Ã–nceki gÃ¶rÃ¼ntÃ¼de **rastgele bir karakter grubu olan Canary'yi** gÃ¶rebilirsiniz. Åimdi, web'in farklÄ± bÃ¶lÃ¼mlerine (parametreler, formlar, url...) enjekte etmeye baÅŸlamalÄ±sÄ±nÄ±z ve her seferinde arama dÃ¼ÄŸmesine tÄ±klamalÄ±sÄ±nÄ±z. DOM Invader, sÃ¶mÃ¼rÃ¼lebilecek herhangi bir ilginÃ§ sÄ±zÄ±ntÄ±ya **canary'nin ulaÅŸÄ±p ulaÅŸmadÄ±ÄŸÄ±nÄ± kontrol edecektir**.

AyrÄ±ca, **URL parametrelerini enjekte et** ve **formlarÄ± enjekte et** seÃ§enekleri, bulduÄŸu her **URL** parametresine ve **form**a **canary'yi otomatik olarak enjekte eden** yeni bir sekme aÃ§acaktÄ±r.

### BoÅŸ Bir Canary Enjekte Edin

EÄŸer sayfanÄ±n potansiyel sÄ±zÄ±ntÄ±larÄ± olabilecek yerlerini bulmak istiyorsanÄ±z, bunlar sÃ¶mÃ¼rÃ¼lebilir olmasa bile, **boÅŸ bir canary iÃ§in arama yapabilirsiniz**.

### Web MesajlarÄ±

DOM Invader, web mesajlarÄ±nÄ± kullanarak DOM XSS testi yapmanÄ±za olanak saÄŸlar ve ÅŸu Ã¶zelliklere sahiptir:

1. `postMessage()` ile gÃ¶nderilen web mesajlarÄ±nÄ±n, Burp Proxy'nin HTTP istek/yanÄ±t geÃ§miÅŸi gÃ¼nlÃ¼ÄŸÃ¼ne benzer ÅŸekilde **gÃ¼nlÃ¼ÄŸÃ¼nÃ¼ tutar**.
2. DOM XSS iÃ§in manuel olarak test etmek iÃ§in web mesajlarÄ±nÄ± **dÃ¼zenleme** ve **yeniden gÃ¶nderme** Ã¶zelliÄŸi, Burp Repeater'Ä±n iÅŸlevine benzer ÅŸekilde kullanÄ±labilir.
3. DOM XSS'yi sonda araÅŸtÄ±rmak iÃ§in **otomatik deÄŸiÅŸiklik** ve web mesajlarÄ±nÄ±n gÃ¶nderilmesi.

#### Mesaj ayrÄ±ntÄ±larÄ±

Her bir mesaj hakkÄ±nda ayrÄ±ntÄ±lÄ± bilgiler, Ã¼zerine tÄ±klanarak gÃ¶rÃ¼ntÃ¼lenebilir ve bunlar, istemci tarafÄ±ndaki JavaScript'in mesajÄ±n `origin`, `data` veya `source` Ã¶zelliklerine eriÅŸip eriÅŸmediÄŸini iÃ§erir.

* **`origin`**: MesajÄ±n **kÃ¶ken bilgisi kontrol edilmediyse**, herhangi bir **keyfi harici etki alanÄ±ndan** olay iÅŸleyiciye Ã§apraz kÃ¶kenli mesajlar gÃ¶nderebilirsiniz. Ancak kontrol edilse bile gÃ¼vensiz olabilir.
* **`data`**: Buraya yÃ¼klenen veriler gÃ¶nderilir. Bu veri kullanÄ±lmÄ±yorsa, sÄ±zÄ±ntÄ± iÅŸe yaramaz.
* **`source`**: Genellikle bir iframe'e referans olan kaynaÄŸÄ± doÄŸrulandÄ±ÄŸÄ±ndan, kaynak Ã¶zelliÄŸinin deÄŸerlendirilip deÄŸerlendirilmediÄŸini deÄŸerlendirir. Bu kontrol edilse bile, doÄŸrulamanÄ±n atlatÄ±lamayacaÄŸÄ± garanti edilmez.

#### Bir mesajÄ± yanÄ±tla

1. **Mesajlar** gÃ¶rÃ¼nÃ¼mÃ¼nden herhangi bir mesaja tÄ±klayarak mesaj ayrÄ±ntÄ±larÄ± iletiÅŸim kutusunu aÃ§Ä±n.
2. **Veri** alanÄ±nÄ± gerektiÄŸi gibi dÃ¼zenleyin.
3. **GÃ¶nder** dÃ¼ÄŸmesine tÄ±klayÄ±n.

### Prototip KirliliÄŸi

DOM Invader ayrÄ±ca **Prototip KirliliÄŸi aÃ§Ä±klarÄ±nÄ±** arayabilir. Ä°lk olarak, bunu etkinleÅŸtirmeniz gerekmektedir:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

ArdÄ±ndan, **`Object.prototype`**'ye keyfi Ã¶zellikler eklemenizi saÄŸlayan kaynaklarÄ± **aramaya baÅŸlayacaktÄ±r**.

Herhangi bir ÅŸey bulunursa, **Test** dÃ¼ÄŸmesi gÃ¶rÃ¼necek ve **bulunan kaynaÄŸÄ± test etmek** iÃ§in Ã¼zerine tÄ±klayÄ±n, yeni bir sekme aÃ§Ä±lacak ve konsolda bir nesne oluÅŸturup `testproperty`'nin var olup olmadÄ±ÄŸÄ±nÄ± kontrol edin:
```javascript
let b = {}
b.testproperty
```
Bir kaynak bulduktan sonra **gadget taramasÄ± yapabilirsiniz**:

1. DOM Invader tarafÄ±ndan **Gadget taramasÄ±** dÃ¼ÄŸmesi tÄ±klanarak yeni bir sekme aÃ§Ä±lÄ±r. Bu dÃ¼ÄŸme, **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde tanÄ±mlanan herhangi bir prototip kirliliÄŸi kaynaÄŸÄ±nÄ±n yanÄ±nda bulunabilir. Uygun gadget'lar iÃ§in tarama baÅŸlar.
2. AynÄ± sekmede, **DOM Invader** sekmesi DevTools panelinde aÃ§Ä±lmalÄ±dÄ±r. Tarama tamamlandÄ±ktan sonra, tanÄ±mlanan gadget'lar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilen herhangi bir sÄ±zÄ±ntÄ± **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde gÃ¶sterilir. Ã–rneÄŸin, `innerHTML` sÄ±zÄ±ntÄ±sÄ±na geÃ§irilen `html` adlÄ± bir gadget Ã¶zelliÄŸi aÅŸaÄŸÄ±daki Ã¶rnekte gÃ¶sterilir.

## DOM clobbering

Ã–nceki gÃ¶rÃ¼ntÃ¼de DOM clobbering taramasÄ±nÄ±n etkinleÅŸtirilebileceÄŸi gÃ¶rÃ¼lebilir. BittiÄŸinde, **DOM Invader DOM clobbering zafiyetlerini aramaya baÅŸlayacaktÄ±r**.

## Referanslar

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± yapmak veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
