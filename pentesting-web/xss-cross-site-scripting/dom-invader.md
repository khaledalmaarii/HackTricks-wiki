# DOM Invader

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## DOM Invader

DOM Invaderæ˜¯å®‰è£…åœ¨Burpå†…ç½®æµè§ˆå™¨ä¸­çš„æµè§ˆå™¨å·¥å…·ã€‚å®ƒé€šè¿‡å„ç§æ¥æºå’Œæ±‡èšç‚¹ï¼ˆåŒ…æ‹¬Webæ¶ˆæ¯å’ŒåŸå‹æ±¡æŸ“ï¼‰å¸®åŠ©**æ£€æµ‹DOM XSSæ¼æ´**ã€‚è¯¥å·¥å…·ä½œä¸ºæ‰©å±•é¢„å…ˆå®‰è£…ã€‚

DOM Invaderé›†æˆäº†æµè§ˆå™¨çš„DevToolsé¢æ¿ä¸­çš„ä¸€ä¸ªé€‰é¡¹å¡ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š

1. ç”¨äºDOM XSSæµ‹è¯•çš„ç½‘é¡µä¸Š**å¯æ§æ±‡èšç‚¹çš„è¯†åˆ«**ï¼Œæä¾›ä¸Šä¸‹æ–‡å’Œæ¸…ç†ç»†èŠ‚ã€‚
2. é€šè¿‡`postMessage()`æ–¹æ³•**è®°å½•ã€ç¼–è¾‘å’Œé‡æ–°å‘é€Webæ¶ˆæ¯**ï¼Œç”¨äºDOM XSSæµ‹è¯•ã€‚DOM Invaderè¿˜å¯ä»¥ä½¿ç”¨ç‰¹åˆ¶çš„Webæ¶ˆæ¯è‡ªåŠ¨æ£€æµ‹æ¼æ´ã€‚
3. æ£€æµ‹**å®¢æˆ·ç«¯åŸå‹æ±¡æŸ“**æºå¹¶æ‰«æå‘é€åˆ°é£é™©æ±‡èšç‚¹çš„å¯æ§å°å·¥å…·ã€‚
4. è¯†åˆ«**DOMè¦†ç›–æ¼æ´**ã€‚

### å¯ç”¨

åœ¨Burpçš„å†…ç½®æµè§ˆå™¨ä¸­ï¼Œè½¬åˆ°**Burpæ‰©å±•**å¹¶å¯ç”¨å®ƒï¼š

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

ç°åœ¨åˆ·æ–°é¡µé¢ï¼Œåœ¨**Dev Tools**ä¸­æ‚¨å°†æ‰¾åˆ°**DOM Invaderé€‰é¡¹å¡ï¼š**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### æ³¨å…¥ä¸€ä¸ªCanary

åœ¨ä¸Šä¸€å¼ å›¾ç‰‡ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ª**éšæœºç»„åˆçš„å­—ç¬¦ï¼Œé‚£å°±æ˜¯Canary**ã€‚ç°åœ¨æ‚¨åº”è¯¥å¼€å§‹åœ¨ç½‘é¡µçš„ä¸åŒéƒ¨åˆ†ï¼ˆå‚æ•°ã€è¡¨å•ã€URLç­‰ï¼‰æ³¨å…¥å®ƒï¼Œæ¯æ¬¡ç‚¹å‡»æœç´¢ã€‚DOM Invaderå°†æ£€æŸ¥**Canaryæ˜¯å¦å‡ºç°åœ¨ä»»ä½•æœ‰è¶£çš„æ±‡èšç‚¹**ä¸­ï¼Œè¿™äº›æ±‡èšç‚¹å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚

æ­¤å¤–ï¼Œé€‰é¡¹**æ³¨å…¥URLå‚æ•°**å’Œ**æ³¨å…¥è¡¨å•**å°†è‡ªåŠ¨æ‰“å¼€ä¸€ä¸ª**æ–°æ ‡ç­¾é¡µ**ï¼Œåœ¨å…¶ä¸­**æ³¨å…¥Canary**åˆ°å®ƒæ‰¾åˆ°çš„æ¯ä¸ª**URL**å‚æ•°å’Œ**è¡¨å•**ä¸­ã€‚

### æ³¨å…¥ä¸€ä¸ªç©ºCanary

å¦‚æœæ‚¨åªæƒ³æ‰¾åˆ°é¡µé¢å¯èƒ½å…·æœ‰çš„æ±‡èšç‚¹ï¼Œå³ä½¿å®ƒä»¬ä¸å¯åˆ©ç”¨ï¼Œæ‚¨å¯ä»¥**æœç´¢ä¸€ä¸ªç©ºçš„Canary**ã€‚

### å‘é€æ¶ˆæ¯

DOM Invaderå…è®¸ä½¿ç”¨Webæ¶ˆæ¯è¿›è¡ŒDOM XSSæµ‹è¯•ï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **è®°å½•**é€šè¿‡`postMessage()`å‘é€çš„Webæ¶ˆæ¯ï¼Œç±»ä¼¼äºBurp Proxyçš„HTTPè¯·æ±‚/å“åº”å†å²è®°å½•ã€‚
2. **ä¿®æ”¹**å’Œ**é‡æ–°å‘å‡º**Webæ¶ˆæ¯ä»¥æ‰‹åŠ¨æµ‹è¯•DOM XSSï¼Œç±»ä¼¼äºBurp Repeaterçš„åŠŸèƒ½ã€‚
3. ç”¨äºæ¢æµ‹DOM XSSçš„**è‡ªåŠ¨æ›´æ”¹**å’Œå‘é€Webæ¶ˆæ¯ã€‚

#### æ¶ˆæ¯è¯¦æƒ…

é€šè¿‡å•å‡»æ¶ˆæ¯ï¼Œå¯ä»¥æŸ¥çœ‹æœ‰å…³æ¯æ¡æ¶ˆæ¯çš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬å®¢æˆ·ç«¯JavaScriptæ˜¯å¦è®¿é—®æ¶ˆæ¯çš„`origin`ã€`data`æˆ–`source`å±æ€§ã€‚

* **`origin`**ï¼šå¦‚æœæ¶ˆæ¯çš„**æ¥æºä¿¡æ¯æœªç»æ£€æŸ¥**ï¼Œæ‚¨å¯èƒ½èƒ½å¤Ÿä»**ä»»æ„å¤–éƒ¨åŸŸ**å‘äº‹ä»¶å¤„ç†ç¨‹åºå‘é€è·¨æºæ¶ˆæ¯ã€‚ä½†å¦‚æœå·²æ£€æŸ¥ï¼Œåˆ™ä»å¯èƒ½å­˜åœ¨ä¸å®‰å…¨æ€§ã€‚
* **`data`**ï¼šè¿™æ˜¯å‘é€æœ‰æ•ˆè½½è·çš„åœ°æ–¹ã€‚å¦‚æœæœªä½¿ç”¨æ­¤æ•°æ®ï¼Œåˆ™æ±‡èšç‚¹æ— æ•ˆã€‚
* **`source`**ï¼šè¯„ä¼°æºå±æ€§æ˜¯å¦ç»è¿‡éªŒè¯ï¼Œé€šå¸¸å¼•ç”¨ä¸€ä¸ªiframeï¼Œè€Œä¸æ˜¯æ¥æºã€‚å³ä½¿å·²æ£€æŸ¥ï¼Œä¹Ÿä¸èƒ½ä¿è¯éªŒè¯ä¸ä¼šè¢«ç»•è¿‡ã€‚

#### å›å¤æ¶ˆæ¯

1. ä»**æ¶ˆæ¯**è§†å›¾ä¸­ï¼Œå•å‡»ä»»ä½•æ¶ˆæ¯ä»¥æ‰“å¼€æ¶ˆæ¯è¯¦ç»†ä¿¡æ¯å¯¹è¯æ¡†ã€‚
2. æ ¹æ®éœ€è¦ç¼–è¾‘**æ•°æ®**å­—æ®µã€‚
3. å•å‡»**å‘é€**ã€‚

### åŸå‹æ±¡æŸ“

DOM Invaderè¿˜å¯ä»¥æœç´¢**åŸå‹æ±¡æŸ“æ¼æ´**ã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦å¯ç”¨å®ƒï¼š

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

ç„¶åï¼Œå®ƒå°†**æœç´¢æº**ï¼Œä½¿æ‚¨èƒ½å¤Ÿå‘**`Object.prototype`**æ·»åŠ ä»»æ„å±æ€§ã€‚

å¦‚æœæ‰¾åˆ°ä»»ä½•å†…å®¹ï¼Œå°†å‡ºç°ä¸€ä¸ª**æµ‹è¯•**æŒ‰é’®ä»¥**æµ‹è¯•æ‰¾åˆ°çš„æº**ã€‚å•å‡»å®ƒï¼Œå°†å‡ºç°ä¸€ä¸ªæ–°æ ‡ç­¾é¡µï¼Œåœ¨æ§åˆ¶å°ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶æ£€æŸ¥`testproperty`æ˜¯å¦å­˜åœ¨ï¼š
```javascript
let b = {}
b.testproperty
```
ä¸€æ—¦æ‰¾åˆ°æºï¼Œæ‚¨å¯ä»¥**æ‰«æå°å·¥å…·**ï¼š

1. å•å‡»**DOM**è§†å›¾ä¸­ä»»ä½•å·²è¯†åˆ«çš„åŸå‹æ±¡æŸ“æºæ—è¾¹çš„**æ‰«æå°å·¥å…·**æŒ‰é’®æ—¶ï¼ŒDOM Invaderä¼šåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ï¼Œç„¶åå¼€å§‹æ‰«æé€‚åˆçš„å°å·¥å…·ã€‚
2. ä¸æ­¤åŒæ—¶ï¼Œåœ¨åŒä¸€æ ‡ç­¾é¡µä¸­ï¼Œ**DOM Invader**æ ‡ç­¾åº”è¯¥åœ¨DevToolsé¢æ¿ä¸­æ‰“å¼€ã€‚æ‰«æå®Œæˆåï¼Œé€šè¿‡å·²è¯†åˆ«çš„å°å·¥å…·å¯è®¿é—®çš„ä»»ä½•æ¼æ´éƒ½ä¼šæ˜¾ç¤ºåœ¨**DOM**è§†å›¾ä¸­ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†å°†åä¸º`html`çš„å°å·¥å…·å±æ€§ä¼ é€’ç»™`innerHTML`æ¼æ´ã€‚

## DOMç¯¡æ”¹

åœ¨ä¸Šä¸€å¼ å›¾ç‰‡ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¯ä»¥æ‰“å¼€DOMç¯¡æ”¹æ‰«æã€‚å®Œæˆåï¼Œ**DOM Invaderå°†å¼€å§‹æœç´¢DOMç¯¡æ”¹æ¼æ´**ã€‚

## å‚è€ƒèµ„æ–™

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)** ä¸Š**å…³æ³¨æˆ‘ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
