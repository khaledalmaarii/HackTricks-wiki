# DOM Invader

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## DOM Invader

DOM Invader, Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±na kurulan bir tarayÄ±cÄ± aracÄ±dÄ±r. Web mesajlarÄ± ve prototip kirliliÄŸi de dahil olmak Ã¼zere Ã§eÅŸitli kaynaklar ve sÄ±zÄ±ntÄ±lar kullanarak **DOM XSS zafiyetlerini tespit etmeye yardÄ±mcÄ± olur**. AracÄ±n uzantÄ± olarak Ã¶nceden yÃ¼klenmiÅŸtir.

DOM Invader, aÅŸaÄŸÄ±dakileri saÄŸlayan tarayÄ±cÄ±nÄ±n DevTools panelinde bir sekme entegre eder:

1. DOM XSS testi iÃ§in bir web sayfasÄ±ndaki **kontrol edilebilir sÄ±zÄ±ntÄ±larÄ±n tanÄ±mlanmasÄ±**, baÄŸlam ve temizleme ayrÄ±ntÄ±larÄ± saÄŸlar.
2. DOM XSS testi iÃ§in `postMessage()` yÃ¶ntemi aracÄ±lÄ±ÄŸÄ±yla gÃ¶nderilen **web mesajlarÄ±nÄ±n kaydedilmesi, dÃ¼zenlenmesi ve yeniden gÃ¶nderilmesi**. DOM Invader ayrÄ±ca Ã¶zel olarak oluÅŸturulmuÅŸ web mesajlarÄ±nÄ± kullanarak zafiyetleri otomatik olarak tespit edebilir.
3. **Ä°stemci tarafÄ± prototip kirliliÄŸi** kaynaklarÄ±nÄ±n tespiti ve riskli sÄ±zÄ±ntÄ±lara gÃ¶nderilen kontrol edilebilir cihazlarÄ±n taranmasÄ±.
4. **DOM clobbering zafiyetlerinin tanÄ±mlanmasÄ±**.

### EtkinleÅŸtirme

Burp'un yerleÅŸik tarayÄ±cÄ±sÄ±nda **Burp uzantÄ±sÄ±**na gidin ve etkinleÅŸtirin:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Åimdi sayfayÄ± yenileyin ve **Dev AraÃ§larÄ±**'nda **DOM Invader sekmesini** bulacaksÄ±nÄ±z:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Bir Kanarya Enjekte Edin

Ã–nceki gÃ¶rÃ¼ntÃ¼de **rastgele karakter grubunu gÃ¶rebilirsiniz, bu Kanarya'dÄ±r**. Åimdi bunu web'in farklÄ± bÃ¶lÃ¼mlerine (parametreler, formlar, url...) enjekte etmeye baÅŸlamalÄ±sÄ±nÄ±z ve her seferinde aramayÄ± tÄ±klayÄ±n. DOM Invader, **kanaryanÄ±n ilginÃ§ bir sÄ±zÄ±ntÄ±da sona erip ermediÄŸini** kontrol edecektir ve sÃ¶mÃ¼rÃ¼lebilecek bir sÄ±zÄ±ntÄ± olabilir.

AyrÄ±ca, **URL parametrelerini enjekte et** ve FormlarÄ± enjekte et** seÃ§enekleri otomatik olarak her bulduÄŸu **URL** parametre ve **form**'da **kanaryayÄ± enjekte eden yeni bir sekme aÃ§acaktÄ±r.

### BoÅŸ Bir Kanarya Enjekte Edin

EÄŸer sayfanÄ±n potansiyel sÄ±zÄ±ntÄ±lara sahip olabileceÄŸi yerleri bulmak istiyorsanÄ±z, sÃ¶mÃ¼rÃ¼lebilir olmasalar bile **boÅŸ bir kanarya arayabilirsiniz**.

### Mesajlar GÃ¶nderme

DOM Invader, web mesajlarÄ±nÄ± kullanarak DOM XSS test etmeye olanak tanÄ±r ve ÅŸunlar gibi Ã¶zelliklere sahiptir:

1. `postMessage()` ile gÃ¶nderilen **web mesajlarÄ±nÄ±n kaydedilmesi**, Burp Proxy'nin HTTP istek/yanÄ±t geÃ§miÅŸi kaydÄ± gibi.
2. DOM XSS iÃ§in manuel olarak test etmek iÃ§in web mesajlarÄ±nÄ± **dÃ¼zenleme** ve **yeniden gÃ¶nderme**, Burp Repeater'Ä±n iÅŸlevine benzer.
3. DOM XSS'yi sorgulamak iÃ§in **otomatik deÄŸiÅŸiklikler** ve web mesajlarÄ±nÄ±n gÃ¶nderilmesi.

#### Mesaj ayrÄ±ntÄ±larÄ±

Her mesaj hakkÄ±nda ayrÄ±ntÄ±lÄ± bilgi, mesajÄ±n Ã¼zerine tÄ±klanarak gÃ¶rÃ¼ntÃ¼lenebilir ve bu, istemci tarafÄ±ndaki JavaScript'in mesajÄ±n `origin`, `data` veya `source` Ã¶zelliklerine eriÅŸip eriÅŸmediÄŸini iÃ§erir.

* **`origin`** : MesajÄ±n **kÃ¶ken bilgileri kontrol edilmediyse**, olay iÅŸleyicisine **herhangi bir harici alandaki** Ã§apraz kÃ¶kenli mesajlar gÃ¶nderebilirsiniz. Ancak kontrol edilirse yine de gÃ¼vensiz olabilir.
* **`data`**: Bu, yÃ¼kÃ¼n gÃ¶nderildiÄŸi yerdir. Bu veri kullanÄ±lmÄ±yorsa, sÄ±zÄ±ntÄ± iÅŸe yaramaz.
* **`source`**: Genellikle bir iframe'e referans olan kaynak Ã¶zelliÄŸinin, kÃ¶ken yerine doÄŸrulandÄ±ÄŸÄ±nÄ± deÄŸerlendirir. Bu kontrol edilse bile, doÄŸrulamanÄ±n atlatÄ±lamayacaÄŸÄ±nÄ± garanti etmez.

#### Bir mesajÄ± yanÄ±tla

1. **Mesajlar** gÃ¶rÃ¼nÃ¼mÃ¼nden, herhangi bir mesajÄ± tÄ±klayarak mesaj ayrÄ±ntÄ±larÄ± iletiÅŸim kutusunu aÃ§Ä±n.
2. Gerekirse **Veri** alanÄ±nÄ± dÃ¼zenleyin.
3. **GÃ¶nder**'e tÄ±klayÄ±n.

### Prototip KirliliÄŸi

DOM Invader ayrÄ±ca **Prototip KirliliÄŸi zafiyetlerini arayabilir**. Ä°lk olarak, bunu etkinleÅŸtirmeniz gerekir:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Daha sonra, **`Object.prototype`'ye** keyfi Ã¶zellikler eklemenizi saÄŸlayan kaynaklarÄ± **aramaya baÅŸlayacaktÄ±r**.

EÄŸer bir ÅŸey bulunursa, **Test** dÃ¼ÄŸmesi gÃ¶rÃ¼necek ve **bulunan kaynaÄŸÄ± test etmek iÃ§in** Ã¼zerine tÄ±klamanÄ±z gerekecek, yeni bir sekme aÃ§Ä±lacak, konsolda bir nesne oluÅŸturacak ve `testproperty`'nin var olup olmadÄ±ÄŸÄ±nÄ± kontrol edecektir:
```javascript
let b = {}
b.testproperty
```
Bir kaynak bulduÄŸunuzda **gadget taramasÄ± yapabilirsiniz**:

1. **Tarama iÃ§in gadgetlarÄ± tarayÄ±n** dÃ¼ÄŸmesine tÄ±klandÄ±ÄŸÄ±nda, DOM gÃ¶rÃ¼nÃ¼mÃ¼nde tanÄ±mlanan herhangi bir prototip kirliliÄŸi kaynaÄŸÄ±nÄ±n yanÄ±nda bulunan **Scan for gadgets** dÃ¼ÄŸmesine tÄ±klandÄ±ÄŸÄ±nda, DOM Invader tarafÄ±ndan yeni bir sekme aÃ§Ä±lÄ±r. ArdÄ±ndan uygun gadget'lar iÃ§in tarama baÅŸlar.
2. AynÄ± sekmede, tarama tamamlandÄ±ktan sonra, tanÄ±mlanan gadget'lar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilen herhangi bir sÄ±zÄ±ntÄ±, **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde gÃ¶sterilir. Ã–rneÄŸin, `innerHTML` sÄ±zÄ±ntÄ±sÄ±na iletilen `html` adlÄ± bir gadget Ã¶zelliÄŸi aÅŸaÄŸÄ±daki Ã¶rnekte gÃ¶sterilir.

## DOM clobbering

Ã–nceki gÃ¶rÃ¼ntÃ¼de DOM clobbering taramasÄ±nÄ±n aÃ§Ä±labileceÄŸi gÃ¶rÃ¼lebilir. BittiÄŸinde, **DOM Invader DOM clobbering zafiyetlerini aramaya baÅŸlayacaktÄ±r**.

## Referanslar

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **ğŸ’¬ [Discord grubuna](https://discord.gg/hRep4RUj7f) veya [telegram grubuna](https://t.me/peass) katÄ±lÄ±n veya** bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
