# DOM Invader

<details>

<summary><strong>Dowiedz si, jak hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w GitHub.

</details>

## DOM Invader

DOM Invader to narzdzie przegldarkowe zainstalowane w wbudowanej przegldarce Burp. Pomaga w **wykrywaniu podatnoci na DOM XSS** za pomoc r贸偶nych 藕r贸de i uj, w tym wiadomoci internetowych i zanieczyszczenia prototypu. Narzdzie jest preinstalowane jako rozszerzenie.

DOM Invader integruje zakadk w panelu Narzdzi deweloperskich przegldarki, umo偶liwiajc:

1. **Identyfikacj kontrolowalnych uj** na stronie internetowej do testowania DOM XSS, dostarczajc kontekstu i szczeg贸贸w dotyczcych oczyszczania.
2. **Rejestrowanie, edytowanie i ponowne wysyanie wiadomoci internetowych** wysyanych za pomoc metody `postMessage()` do testowania DOM XSS. DOM Invader mo偶e r贸wnie偶 automatycznie wykrywa podatnoci za pomoc specjalnie przygotowanych wiadomoci internetowych.
3. Wykrywanie 藕r贸de **zanieczyszczenia prototypu po stronie klienta** i skanowanie kontrolowalnych gad偶et贸w wysyanych do ryzykownych uj.
4. Identyfikacj podatnoci na **zastpowanie DOM**.

### Wczanie

W wbudowanej przegldarce Burp przejd藕 do **rozszerzenia Burp** i wcz je:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Teraz odwie偶 stron, a w **Narzdziach deweloperskich** znajdziesz zakadk **DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Wstrzykiwanie kanarka

Na poprzednim obrazku mo偶esz zobaczy **losow grup znak贸w, kt贸ra jest kanarkiem**. Teraz powiniene zacz **wstrzykiwa** go w r贸偶ne czci strony internetowej (parametry, formularze, adres URL...) i za ka偶dym razem klikn przycisk wyszukiwania. DOM Invader sprawdzi, czy **kanarek trafi do jakiegokolwiek interesujcego ujcia**, kt贸re mo偶na by wykorzysta.

Ponadto, opcje **Wstrzykiwanie parametr贸w URL** i **Wstrzykiwanie formularzy** automatycznie otworz **now kart** i **wstrzykn** kanarka do ka偶dego **parametru URL** i **formularza**, kt贸re zostan znalezione.

### Wstrzykiwanie pustego kanarka

Jeli chcesz tylko znale藕 potencjalne ujcia, kt贸re strona mo偶e mie, nawet jeli nie s one wykorzystywalne, mo偶esz **wyszuka pusty kanarek**.

### Wiadomoci internetowe

DOM Invader umo偶liwia testowanie DOM XSS za pomoc wiadomoci internetowych z funkcjami takimi jak:

1. **Rejestrowanie wiadomoci internetowych** wysyanych za pomoc `postMessage()`, podobnie jak rejestrowanie historii 偶da/odpowiedzi HTTP w Burp Proxy.
2. **Modyfikowanie** i **ponowne wysyanie** wiadomoci internetowych w celu rcznego testowania DOM XSS, podobnie jak funkcja Burp Repeater.
3. **Automatyczna zmiana** i wysyanie wiadomoci internetowych w celu sondowania DOM XSS.

#### Szczeg贸y wiadomoci

Szczeg贸owe informacje o ka偶dej wiadomoci mo偶na zobaczy, klikajc na ni, co obejmuje informacje, czy skrypt po stronie klienta JavaScript ma dostp do waciwoci `origin`, `data` lub `source` wiadomoci.

* **`origin`**: Jeli **informacje o pochodzeniu wiadomoci nie s sprawdzane**, mo偶esz wysya wiadomoci midzydomenowe do obsugi zdarze **z dowolnej zewntrznej domeny**. Ale jeli jest sprawdzane, to nadal mo偶e by niewaciwe.
* **`data`**: Tutaj jest wysyany adunek. Jeli te dane nie s u偶ywane, ujcie jest bezu偶yteczne.
* **`source`**: Ocena, czy waciwo 藕r贸dowa, zazwyczaj odnoszca si do elementu iframe, jest sprawdzana zamiast pochodzenia. Nawet jeli jest to sprawdzane, nie gwarantuje to, 偶e walidacja nie mo偶e zosta ominita.

#### Odpowied藕 na wiadomo

1. Z widoku **Wiadomoci** kliknij dowoln wiadomo, aby otworzy okno szczeg贸贸w wiadomoci.
2. Edytuj pole **Data** wedug potrzeb.
3. Kliknij **Wylij**.

### Zanieczyszczenie prototypu

DOM Invader mo偶e r贸wnie偶 wyszukiwa **podatnoci na zanieczyszczenie prototypu**. Najpierw musisz je wczy:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Nastpnie bdzie **wyszukiwa 藕r贸da**, kt贸re umo偶liwiaj dodawanie dowolnych waciwoci do **`Object.prototype`**.

Jeli co zostanie znalezione, pojawi si przycisk **Test**, aby **przetestowa znalezione 藕r贸do**. Kliknij na niego, pojawi si nowa karta, utw贸rz obiekt w konsoli i sprawd藕, czy istnieje `testproperty`:
```javascript
let b = {}
b.testproperty
```
Gdy ju偶 znajdziesz 藕r贸do, mo偶esz **przeszuka gad偶ety**:

1. Nowa karta zostaje otwarta przez DOM Invader, gdy klikniesz przycisk **Przeszukaj gad偶ety**, kt贸ry znajduje si obok zidentyfikowanego 藕r贸da zanieczyszczenia prototypu w widoku **DOM**. Nastpnie rozpoczyna si skanowanie odpowiednich gad偶et贸w.
2. W midzyczasie, w tej samej karcie, powinna by otwarta karta **DOM Invader** w panelu narzdzi DevTools. Po zakoczeniu skanowania, wszystkie ujcia dostpne za pomoc zidentyfikowanych gad偶et贸w s wywietlane w widoku **DOM**. Na przykad, w poni偶szym przykadzie pokazano waciwo gad偶etu o nazwie `html`, kt贸ra jest przekazywana do ujcia `innerHTML`.

## Nadpisywanie DOM

Na poprzednim obrazku mo偶na zobaczy, 偶e mo偶na wczy skanowanie nadpisywania DOM. Po wczeniu, **DOM Invader rozpocznie wyszukiwanie podatnoci na nadpisywanie DOM**.

## Odnoniki

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
