# DOM XSS

<details>

<summary><strong>AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **HackTricksì— ê·€ì‚¬ë¥¼ ê´‘ê³ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”**? í˜¹ì€ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ì €í¬ì˜ ë…ì  [**NFT ì»¬ë ‰ì…˜**](https://opensea.io/collection/the-peass-family)
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”
* **ğŸ’¬** [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì— **ê°€ì…**í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ë°** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ë¡œ PRì„ ì œì¶œ**í•´ì£¼ì„¸ìš”.

</details>

## DOM ì·¨ì•½ì 

DOM ì·¨ì•½ì ì€ ê³µê²©ìê°€ ì œì–´í•˜ëŠ” **ì†ŒìŠ¤** (ì˜ˆ: `location.search`, `document.referrer`, ë˜ëŠ” `document.cookie`)ì—ì„œ ë°ì´í„°ê°€ ì•ˆì „í•˜ê²Œ ì „ë‹¬ë˜ì§€ ì•Šê³  **ì‹±í¬**ë¡œ ì´ë™í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì‹±í¬ëŠ” ì•…ì„± ë°ì´í„°ê°€ ì£¼ì–´ì§€ë©´ í•´ë¡œìš´ ì½˜í…ì¸ ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ ë Œë”ë§í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ ë˜ëŠ” ê°ì²´ (ì˜ˆ: `eval()`, `document.body.innerHTML`)ì…ë‹ˆë‹¤.

* **ì†ŒìŠ¤**ëŠ” ê³µê²©ìê°€ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ì…ë ¥ìœ¼ë¡œ, URL, ì¿ í‚¤ ë° ì›¹ ë©”ì‹œì§€ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **ì‹±í¬**ëŠ” ì•…ì„± ë°ì´í„°ê°€ ë¶€ì‘ìš©ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆëŠ” ì ì¬ì ìœ¼ë¡œ ìœ„í—˜í•œ ì¢…ë‹¨ì ìœ¼ë¡œ, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ê³¼ ê°™ì€ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

ë°ì´í„°ê°€ ì ì ˆí•œ ìœ íš¨ì„± ê²€ì‚¬ë‚˜ ì‚´ê·  ì—†ì´ ì†ŒìŠ¤ì—ì„œ ì‹±í¬ë¡œ íë¥¼ ë•Œ XSSì™€ ê°™ì€ ê³µê²©ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

{% hint style="info" %}
**ë” ìµœì‹  ì†ŒìŠ¤ ë° ì‹±í¬ ëª©ë¡ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤** [**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki)
{% endhint %}

**ì¼ë°˜ì ì¸ ì†ŒìŠ¤:**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**ì¼ë°˜ì ì¸ ì·¨ì•½ì :**

| [**ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸**](dom-xss.md#open-redirect)                                    | [**ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…**](dom-xss.md#javascript-injection)                         | [**DOM ë°ì´í„° ì¡°ì‘**](dom-xss.md#dom-data-manipulation) | **jQuery**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() constructor`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**Ajax ìš”ì²­ ì¡°ì‘**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**ë§í¬ ì¡°ì‘**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**í´ë¼ì´ì–¸íŠ¸ ì¸¡ JSON ì‚½ì…**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**HTML5-storage ì¡°ì‘**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**XPath ì‚½ì…**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**`ì„œë¹„ìŠ¤ ê±°ë¶€`**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**ì¿ í‚¤ ì¡°ì‘**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**ë¬¸ì„œ ë„ë©”ì¸ ì¡°ì‘**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**ì›¹ì†Œì¼“-URL ì¡°ì‘**](dom-xss.md#websocket-url-poisoning)      |
| [**í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì‚½ì…**](dom-xss.md#client-side-sql-injection)            | [**ì›¹ ë©”ì‹œì§€ ì¡°ì‘**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

**`innerHTML`** ì‹±í¬ëŠ” í˜„ëŒ€ ë¸Œë¼ìš°ì €ì—ì„œ `script` ìš”ì†Œë¥¼ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë©°, `svg onload` ì´ë²¤íŠ¸ë„ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” `img` ë˜ëŠ” `iframe`ê³¼ ê°™ì€ ëŒ€ì²´ ìš”ì†Œë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ ìœ í˜•ì˜ XSSëŠ” ì•„ë§ˆë„ **ê°€ì¥ ì–´ë µê²Œ** ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. JS ì½”ë“œ ë‚´ë¶€ë¥¼ ì‚´í´ë³´ê³ , ì œì–´í•  ìˆ˜ ìˆëŠ” **ê°’ì„ ì‚¬ìš©**í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , ê·¸ ê²½ìš°ì— ì„ì˜ì˜ JSë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.

## ë°œê²¬ ë„êµ¬

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)
* ì ì¬ì ì¸ ì‹±í¬ì— ë„ë‹¬í•˜ëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í™•ì¸í•˜ëŠ” ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨: [https://github.com/kevin-mizu/domloggerpp](https://github.com/kevin-mizu/domloggerpp)

## ì˜ˆì‹œ

### ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸

ì¶œì²˜: [https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

**DOMì—ì„œì˜ ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ë„ë©”ì¸ ê°„ íƒìƒ‰ì„ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ì‹±í¬ì— ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì‘ì„±í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

ë¦¬ë‹¤ì´ë ‰ì…˜ì´ ë°œìƒí•˜ëŠ” URLì˜ ì‹œì‘ ë¶€ë¶„ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤ë©´, **`javascript:alert(1)`**ê³¼ ê°™ì€ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ì‹±í¬:
```javascript
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### ì¿ í‚¤ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

DOM ê¸°ë°˜ ì¿ í‚¤ ì¡°ì‘ ì·¨ì•½ì ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì¿ í‚¤ì˜ ê°’ìœ¼ë¡œ í†µí•©í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ì¿ í‚¤ê°€ ì‚¬ì´íŠ¸ ë‚´ì—ì„œ ì‚¬ìš©ë  ê²½ìš° ì›¹í˜ì´ì§€ì˜ ì˜ˆê¸°ì¹˜ ì•Šì€ ë™ì‘ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì¿ í‚¤ê°€ ì‚¬ìš©ì ì„¸ì…˜ì„ ì¶”ì í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê²½ìš° ì„¸ì…˜ ê³ ì • ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì·¨ì•½ì ê³¼ ê´€ë ¨ëœ ì£¼ìš” ì‹±í¬ëŠ”:

ì‹±í¬:
```javascript
document.cookie
```
### JavaScript Injection

From: [https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

DOM ê¸°ë°˜ JavaScript ì‚½ì… ì·¨ì•½ì ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ JavaScript ì½”ë“œë¡œ ì‹¤í–‰í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### ë¬¸ì„œ ë„ë©”ì¸ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

**ë¬¸ì„œ ë„ë©”ì¸ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ `document.domain` ì†ì„±ì„ ì„¤ì •í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

`document.domain` ì†ì„±ì€ ë¸Œë¼ìš°ì €ì— ì˜í•œ **ë™ì¼ ì¶œì²˜ ì •ì±…**ì˜ **ì‹œí–‰**ì— **ì¤‘ìš”í•œ ì—­í• **ì„ í•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ì—ì„œ ê°€ì ¸ì˜¨ ë‘ í˜ì´ì§€ê°€ `document.domain`ì„ **ë™ì¼í•œ ê°’**ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì œí•œ ì—†ì´ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ëŠ” `document.domain`ì— í• ë‹¹í•  ìˆ˜ ìˆëŠ” ê°’ì— ì¼ì •í•œ **ì œí•œ**ì„ ë¶€ê³¼í•˜ì§€ë§Œ, ì‹¤ì œ í˜ì´ì§€ ì¶œì²˜ì— ì™„ì „íˆ ê´€ë ¨ ì—†ëŠ” ê°’ì˜ í• ë‹¹ì„ ë°©ì§€í•˜ëŠ” ì˜ˆì™¸ê°€ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ëŠ” **í•˜ìœ„ ë„ë©”ì¸** ë˜ëŠ” **ìƒìœ„ ë„ë©”ì¸**ì˜ ì‚¬ìš©ì„ í—ˆìš©í•©ë‹ˆë‹¤.

Sinks:
```javascript
document.domain
```
### WebSocket-URL ë…ë ¤

From: [https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

**WebSocket-URL ë…ë ¤**ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ WebSocket ì—°ê²°ì˜ ëŒ€ìƒ URLë¡œ **ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©**í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

Sinks:

`WebSocket` ìƒì„±ìëŠ” WebSocket-URL ë…ë ¤ ì·¨ì•½ì ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë§í¬ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

**DOM ê¸°ë°˜ ë§í¬ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ í˜„ì¬ í˜ì´ì§€ ë‚´ì—ì„œ ë„¤ë¹„ê²Œì´ì…˜ ëŒ€ìƒìœ¼ë¡œ **ê³µê²©ìê°€ ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ ì‘ì„±**í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŠ” í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë‚˜ ì–‘ì‹ì˜ ì œì¶œ URLê³¼ ê°™ì€ ê²ƒì…ë‹ˆë‹¤.

Sinks:
```javascript
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### Ajax ìš”ì²­ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

**Ajax ìš”ì²­ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ `XmlHttpRequest` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°œí–‰ëœ Ajax ìš”ì²­ì— **ê³µê²©ìê°€ ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ ì‘ì„±**í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

**ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ `filename` ë§¤ê°œë³€ìˆ˜ë¡œ **ê³µê²©ìê°€ ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ íŒŒì¼ ì²˜ë¦¬ APIì— ì „ë‹¬**í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ê³µê²©ìê°€ ë°©ë¬¸ìê°€ ë‹¤ë¥¸ ì‚¬ìš©ìì— ì˜í•´ ë°©ë¬¸ë  ê²½ìš° **ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ê°€ ì„ì˜ì˜ ë¡œì»¬ íŒŒì¼ì„ ì—´ê±°ë‚˜ ì“¸ ìˆ˜ ìˆëŠ” URLì„ êµ¬ì„±**í•˜ì—¬ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì‚½ì…

From: [https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

**í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì‚½ì… ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šì€ ë°©ì‹ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì¿¼ë¦¬ì— í†µí•©í•˜ëŠ” ê²½ìš°** ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
executeSql()
```
### HTML5-storage ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

**HTML5-storage ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ì›¹ ë¸Œë¼ìš°ì €ì˜ HTML5 ì €ì¥ì†Œ(`localStorage` ë˜ëŠ” `sessionStorage`)ì— **ê³µê²©ìê°€ ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ ì €ì¥**í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì‘ì—… ìì²´ê°€ ë³´ì•ˆ ì·¨ì•½ì ì€ ì•„ë‹ˆì§€ë§Œ, ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì´í›„ì— **ì €ì¥ëœ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šê²Œ ì²˜ë¦¬í•˜ê³  ì½ëŠ” ê²½ìš° ë¬¸ì œê°€ ë°œìƒ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê³µê²©ìê°€ ì €ì¥ ë©”ì»¤ë‹ˆì¦˜ì„ í™œìš©í•˜ì—¬ ë‹¤ë¥¸ DOM ê¸°ë°˜ ê³µê²©(ì˜ˆ: í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ë° JavaScript ì‚½ì…)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹±í¬(Sinks):
```javascript
sessionStorage.setItem()
localStorage.setItem()
```
### XPath injection

From: [https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

**DOM-based XPath-injection vulnerabilities** ë°œìƒ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ XPath ì¿¼ë¦¬ì— í†µí•©**í•˜ëŠ” ê²½ìš° ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
document.evaluate()
someDOMElement.evaluate()
```
### í´ë¼ì´ì–¸íŠ¸ ì¸¡ JSON ì‚½ì…

From: [https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

**DOM ê¸°ë°˜ JSON ì‚½ì… ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ë°ì´í„°ë¥¼ JSON ë°ì´í„° êµ¬ì¡°ë¡œ êµ¬ë¬¸ ë¶„ì„í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ë¬¸ìì—´ì— í†µí•©ë˜ì—ˆì„ ë•Œ ë°œìƒ**í•©ë‹ˆë‹¤.

Sinks:
```javascript
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### ì›¹ ë©”ì‹œì§€ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

**ì›¹ ë©”ì‹œì§€ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ë¸Œë¼ìš°ì € ë‚´ ë‹¤ë¥¸ ë¬¸ì„œë¡œ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì›¹ ë©”ì‹œì§€ë¡œ ë³´ë‚´ëŠ” ê²½ìš°** ë°œìƒí•©ë‹ˆë‹¤. ì·¨ì•½í•œ ì›¹ ë©”ì‹œì§€ ì¡°ì‘ì˜ **ì˜ˆì‹œ**ëŠ” [PortSwiggerì˜ ì›¹ ë³´ì•ˆ ì•„ì¹´ë°ë¯¸](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹±í¬:

`postMessage()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ê²½ìš°, ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ìˆ˜ì‹ ëœ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šì€ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²½ìš° ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### DOM ë°ì´í„° ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

**DOM ë°ì´í„° ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **DOM ë‚´ì˜ í•„ë“œì— ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì‘ì„±**í•˜ëŠ” ê²½ìš° ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ê³µê²©ìê°€ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë°©ë¬¸í•  ê²½ìš° í´ë¼ì´ì–¸íŠ¸ ì¸¡ UIì˜ ëª¨ì–‘ì´ë‚˜ ë™ì‘ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” URLì„ êµ¬ì„±í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹±í¬:
```javascript
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### ì„œë¹„ìŠ¤ ê±°ë¶€

From: [https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

**DOM ê¸°ë°˜ ì„œë¹„ìŠ¤ ê±°ë¶€ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šê²Œ ë¬¸ì œê°€ ìˆëŠ” í”Œë«í¼ APIë¡œ ì „ë‹¬í•  ë•Œ ë°œìƒ**í•©ë‹ˆë‹¤. ì´ëŠ” í˜¸ì¶œë  ë•Œ ì‚¬ìš©ìì˜ ì»´í“¨í„°ê°€ **ê³¼ë„í•œ ì–‘ì˜ CPU ë˜ëŠ” ë””ìŠ¤í¬ ê³µê°„ì„ ì†Œë¹„í•˜ë„ë¡ í•  ìˆ˜ ìˆëŠ” API**ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ì€ ë¸Œë¼ìš°ì €ê°€ `localStorage`ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ì‹œë„ë¥¼ ê±°ë¶€í•˜ê±°ë‚˜ ë°”ìœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¢…ë£Œí•¨ìœ¼ë¡œì¨ ì›¹ ì‚¬ì´íŠ¸ì˜ ê¸°ëŠ¥ì„ ì œí•œí•˜ëŠ” ë“±ì˜ ì¤‘ëŒ€í•œ ë¶€ì‘ìš©ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹±í¬:
```javascript
requestFileSystem()
RegExp()
```
## Dom Clobbering

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

<details>

<summary><strong>ì œë¡œë¶€í„° ì˜ì›…ì´ ë  ë•Œê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ì‹œë‚˜ìš”**? í˜¹ì€ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”, ì €í¬ì˜ ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™¹**](https://peass.creator-spring.com)ì„ ì–»ìœ¼ì„¸ìš”
* **ğŸ’¬** [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f)ì— **ê°€ì…**í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ì‹œê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ PRì„** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ë°** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ì— ì œì¶œ**í•˜ì—¬ ì£¼ì„¸ìš”.

</details>
