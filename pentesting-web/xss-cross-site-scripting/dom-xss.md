# DOM XSS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿ æ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­è¢«å¹¿å‘Š**å—ï¼Ÿ æˆ–è€…æ‚¨æƒ³è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿ è¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– **ç”µæŠ¥ç¾¤ç»„** æˆ–åœ¨**Twitter**ä¸Š**ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## DOMæ¼æ´

å½“æ¥è‡ªæ”»å‡»è€…æ§åˆ¶çš„**æº**ï¼ˆå¦‚`location.search`ã€`document.referrer`æˆ–`document.cookie`ï¼‰çš„æ•°æ®ä¸å®‰å…¨åœ°ä¼ è¾“åˆ°**æ¥æ”¶ç‚¹**æ—¶ï¼Œå°±ä¼šå‘ç”ŸDOMæ¼æ´ã€‚æ¥æ”¶ç‚¹æ˜¯å¯ä»¥æ‰§è¡Œæˆ–å‘ˆç°æœ‰å®³å†…å®¹çš„å‡½æ•°æˆ–å¯¹è±¡ï¼ˆä¾‹å¦‚`eval()`ã€`document.body.innerHTML`ï¼‰ã€‚

- **æº**æ˜¯æ”»å‡»è€…å¯ä»¥æ“çºµçš„è¾“å…¥ï¼ŒåŒ…æ‹¬URLã€cookieå’ŒWebæ¶ˆæ¯ã€‚
- **æ¥æ”¶ç‚¹**æ˜¯æ½œåœ¨å±é™©çš„ç»ˆç‚¹ï¼Œæ¶æ„æ•°æ®å¯èƒ½å¯¼è‡´ä¸è‰¯å½±å“ï¼Œå¦‚è„šæœ¬æ‰§è¡Œã€‚

å½“æ•°æ®ä»æºæµå‘æ¥æ”¶ç‚¹è€Œæ²¡æœ‰é€‚å½“çš„éªŒè¯æˆ–æ¸…ç†æ—¶ï¼Œå°±ä¼šäº§ç”Ÿé£é™©ï¼Œä»è€Œå¯èƒ½å¯¼è‡´XSSç­‰æ”»å‡»ã€‚

{% hint style="info" %}
**æ‚¨å¯ä»¥åœ¨** [**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki) **ä¸­æ‰¾åˆ°æ›´å¤šæ›´æ–°çš„æºå’Œæ¥æ”¶ç‚¹åˆ—è¡¨ã€‚**
{% endhint %}

**å¸¸è§æºï¼š**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**å¸¸è§æ¼æ´ï¼š**

| [**å¼€æ”¾é‡å®šå‘**](dom-xss.md#open-redirect)                                    | [**Javascriptæ³¨å…¥**](dom-xss.md#javascript-injection)                         | [**DOMæ•°æ®æ“çºµ**](dom-xss.md#dom-data-manipulation) | **jQuery**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() æ„é€ å‡½æ•°`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“çºµ**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**Ajaxè¯·æ±‚æ“çºµ**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**é“¾æ¥æ“çºµ**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**å®¢æˆ·ç«¯JSONæ³¨å…¥**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**HTML5å­˜å‚¨æ“çºµ**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**XPathæ³¨å…¥**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**`æ‹’ç»æœåŠ¡`**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**Cookieæ“çºµ**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**æ–‡æ¡£åŸŸæ“çºµ**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**WebSocket-URLä¸­æ¯’**](dom-xss.md#websocket-url-poisoning)      |
| [**å®¢æˆ·ç«¯SQLæ³¨å…¥**](dom-xss.md#client-side-sql-injection)            | [**Webæ¶ˆæ¯æ“çºµ**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

**`innerHTML`** æ¼æ´åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸Šä¸æ¥å— `script` å…ƒç´ ï¼Œä¹Ÿä¸ä¼šè§¦å‘ `svg onload` äº‹ä»¶ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨æ›¿ä»£å…ƒç´ å¦‚ `img` æˆ– `iframe`ã€‚

è¿™ç§ç±»å‹çš„XSSå¯èƒ½æ˜¯**æœ€éš¾å‘ç°**çš„ï¼Œå› ä¸ºæ‚¨éœ€è¦æŸ¥çœ‹JSä»£ç å†…éƒ¨ï¼ŒæŸ¥çœ‹æ˜¯å¦**ä½¿ç”¨**äº†æ‚¨å¯ä»¥æ§åˆ¶çš„ä»»ä½•å¯¹è±¡çš„**å€¼**ï¼Œå¹¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰**ä»»ä½•æ»¥ç”¨**å®ƒä»¥æ‰§è¡Œä»»æ„JSçš„æ–¹æ³•ã€‚

## æŸ¥æ‰¾å·¥å…·

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)

## ç¤ºä¾‹

### å¼€æ”¾é‡å®šå‘

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

**DOMä¸­çš„å¼€æ”¾é‡å®šå‘æ¼æ´** å‘ç”Ÿåœ¨è„šæœ¬å°†æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„æ•°æ®å†™å…¥èƒ½å¤Ÿè·¨åŸŸè¿›è¡Œå¯¼èˆªçš„æ¼æ´ç‚¹æ—¶ã€‚

é‡è¦çš„æ˜¯è¦ç†è§£ï¼Œå¦‚æœæ‚¨æ§åˆ¶é‡å®šå‘å‘ç”Ÿçš„URLçš„èµ·å§‹éƒ¨åˆ†ï¼Œé‚£ä¹ˆæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ **`javascript:alert(1)`**ï¼Œæ˜¯å¯èƒ½çš„ã€‚

æ¼æ´ç‚¹ï¼š
```javascript
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### Cookie manipulation

From: [https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

DOM-based cookie-manipulationæ¼æ´å‘ç”Ÿåœ¨è„šæœ¬å°†å¯ä»¥è¢«æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®åˆå¹¶åˆ°cookieçš„å€¼ä¸­æ—¶ã€‚å¦‚æœcookieåœ¨ç½‘ç«™å†…éƒ¨ä½¿ç”¨ï¼Œè¿™ç§æ¼æ´å¯èƒ½å¯¼è‡´ç½‘é¡µçš„æ„å¤–è¡Œä¸ºã€‚æ­¤å¤–ï¼Œå¦‚æœcookieç”¨äºè·Ÿè¸ªç”¨æˆ·ä¼šè¯ï¼Œè¿˜å¯ä»¥åˆ©ç”¨å®ƒæ¥æ‰§è¡Œä¼šè¯å›ºå®šæ”»å‡»ã€‚ä¸æ­¤æ¼æ´ç›¸å…³çš„ä¸»è¦æ¼æ´ç‚¹æ˜¯ï¼š

æ¼æ´ç‚¹:
```javascript
document.cookie
```
### JavaScriptæ³¨å…¥

From: [https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

DOM-based JavaScriptæ³¨å…¥æ¼æ´æ˜¯åœ¨è„šæœ¬è¿è¡Œæ•°æ®æ—¶åˆ›å»ºçš„ï¼Œè¿™äº›æ•°æ®å¯ä»¥è¢«æ”»å‡»è€…æ§åˆ¶ä¸ºJavaScriptä»£ç ã€‚

Sinks:
```javascript
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### æ–‡æ¡£åŸŸæ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

**æ–‡æ¡£åŸŸæ“çºµæ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬ä½¿ç”¨æ”»å‡»è€…å¯æ§åˆ¶çš„æ•°æ®è®¾ç½®`document.domain`å±æ€§æ—¶ã€‚

`document.domain`å±æ€§åœ¨æµè§ˆå™¨ä¸­é€šè¿‡**åŒæºç­–ç•¥**çš„**æ‰§è¡Œ**ä¸­å‘æŒ¥**å…³é”®ä½œç”¨**ã€‚å½“æ¥è‡ªä¸åŒæºçš„ä¸¤ä¸ªé¡µé¢å°†å®ƒä»¬çš„`document.domain`è®¾ç½®ä¸º**ç›¸åŒå€¼**æ—¶ï¼Œå®ƒä»¬å¯ä»¥æ— é™åˆ¶åœ°è¿›è¡Œäº¤äº’ã€‚å°½ç®¡æµè§ˆå™¨å¯¹å¯åˆ†é…ç»™`document.domain`çš„å€¼æ–½åŠ ä¸€å®šçš„**é™åˆ¶**ï¼Œé˜²æ­¢å°†å®Œå…¨ä¸ç›¸å…³çš„å€¼åˆ†é…ç»™å®é™…é¡µé¢æºï¼Œä½†ä¹Ÿå­˜åœ¨ä¾‹å¤–ã€‚é€šå¸¸ï¼Œæµè§ˆå™¨å…è®¸ä½¿ç”¨**å­åŸŸ**æˆ–**çˆ¶åŸŸ**ã€‚

æ¼æ´ç‚¹ï¼š
```javascript
document.domain
```
### WebSocket-URLæ¯’åŒ–

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

**WebSocket-URLæ¯’åŒ–**å‘ç”Ÿåœ¨è„šæœ¬ä½¿ç”¨**å¯æ§æ•°æ®ä½œä¸ºWebSocketè¿æ¥çš„ç›®æ ‡URL**æ—¶ã€‚

æ¼æ´ç‚¹ï¼š

`WebSocket`æ„é€ å‡½æ•°å¯èƒ½å¯¼è‡´WebSocket-URLæ¯’åŒ–æ¼æ´ã€‚

### é“¾æ¥æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

**åŸºäºDOMçš„é“¾æ¥æ“çºµæ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬å°†**å¯æ§æ•°æ®å†™å…¥å½“å‰é¡µé¢å†…çš„å¯¼èˆªç›®æ ‡**ï¼Œä¾‹å¦‚å¯ç‚¹å‡»é“¾æ¥æˆ–è¡¨å•çš„æäº¤URLæ—¶ã€‚
```javascript
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### Ajaxè¯·æ±‚æ“çºµ

From: [https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

**Ajaxè¯·æ±‚æ“çºµæ¼æ´**ä¼šåœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®å†™å…¥ä½¿ç”¨`XmlHttpRequest`å¯¹è±¡å‘å‡ºçš„Ajaxè¯·æ±‚**æ—¶å‡ºç°ã€‚

Sinks:
```javascript
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

**æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“çºµæ¼æ´**ä¼šåœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ä¼ é€’ç»™æ–‡ä»¶å¤„ç† API** ä½œä¸º `filename` å‚æ•°æ—¶å‡ºç°ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´æ„é€ ä¸€ä¸ª URLï¼Œå¦‚æœè¢«å¦ä¸€ä¸ªç”¨æˆ·è®¿é—®ï¼Œå¯èƒ½å¯¼è‡´**ç”¨æˆ·çš„æµè§ˆå™¨æ‰“å¼€æˆ–å†™å…¥ä»»æ„æœ¬åœ°æ–‡ä»¶**ã€‚

æ¼æ´ç‚¹ï¼š
```javascript
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### å®¢æˆ·ç«¯SQLæ³¨å…¥

From: [https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

**å®¢æˆ·ç«¯SQLæ³¨å…¥æ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬ä»¥ä¸å®‰å…¨çš„æ–¹å¼å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®åˆå¹¶åˆ°å®¢æˆ·ç«¯SQLæŸ¥è¯¢**ä¸­æ—¶ã€‚

Sinks:
```javascript
executeSql()
```
### HTML5-storage manipulation

From: [https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

**HTML5-storage manipulation vulnerabilities** arise when a script **stores attacker-controllable data in the web browser's HTML5 storage** (`localStorage` or `sessionStorage`). While this action is not inherently a security vulnerability, it becomes problematic if the application subsequently **reads the stored data and processes it unsafely**. This could allow an attacker to leverage the storage mechanism to conduct other DOM-based attacks, such as cross-site scripting and JavaScript injection.

Sinks:
```javascript
sessionStorage.setItem()
localStorage.setItem()
```
### XPathæ³¨å…¥

From: [https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

**DOM-based XPathæ³¨å…¥æ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®åˆå¹¶åˆ°XPathæŸ¥è¯¢**ä¸­æ—¶ã€‚

Sinks:
```javascript
document.evaluate()
someDOMElement.evaluate()
```
### å®¢æˆ·ç«¯JSONæ³¨å…¥

From: [https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

**DOM-based JSONæ³¨å…¥æ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®åˆå¹¶åˆ°ä¸€ä¸ªè¢«è§£æä¸ºJSONæ•°æ®ç»“æ„çš„å­—ç¬¦ä¸²ä¸­ï¼Œç„¶åç”±åº”ç”¨ç¨‹åºå¤„ç†**æ—¶ã€‚ 

Sinks:
```javascript
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### Webæ¶ˆæ¯æ“çºµ

From: [https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

**Webæ¶ˆæ¯æ¼æ´**æ˜¯æŒ‡å½“è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ä½œä¸ºWebæ¶ˆæ¯å‘é€åˆ°æµè§ˆå™¨ä¸­çš„å¦ä¸€ä¸ªæ–‡æ¡£**æ—¶äº§ç”Ÿçš„æ¼æ´ã€‚ä¸€ä¸ª**æ˜“å—æ”»å‡»çš„Webæ¶ˆæ¯æ“çºµç¤ºä¾‹**å¯åœ¨[PortSwiggerçš„Webå®‰å…¨å­¦é™¢](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)æ‰¾åˆ°ã€‚

æ¼æ´ç‚¹ï¼š

ä½¿ç”¨`postMessage()`æ–¹æ³•å‘é€Webæ¶ˆæ¯ï¼Œå¦‚æœç”¨äºæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶ä¾¦å¬å™¨ä»¥ä¸å®‰å…¨çš„æ–¹å¼å¤„ç†ä¼ å…¥æ•°æ®ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¼æ´ã€‚

### DOMæ•°æ®æ“çºµ

From: [https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

**DOMæ•°æ®æ“çºµæ¼æ´**æ˜¯æŒ‡å½“è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®å†™å…¥DOMä¸­çš„å­—æ®µ**ï¼Œå¹¶åœ¨å¯è§UIæˆ–å®¢æˆ·ç«¯é€»è¾‘ä¸­ä½¿ç”¨æ—¶äº§ç”Ÿçš„æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æ¼æ´æ„é€ ä¸€ä¸ªURLï¼Œå¦‚æœå¦ä¸€ä¸ªç”¨æˆ·è®¿é—®è¯¥URLï¼Œå¯èƒ½ä¼šæ”¹å˜å®¢æˆ·ç«¯UIçš„å¤–è§‚æˆ–è¡Œä¸ºã€‚

æ¼æ´ç‚¹ï¼š
```javascript
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### æ‹’ç»æœåŠ¡

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

**åŸºäºDOMçš„æ‹’ç»æœåŠ¡æ¼æ´**å‘ç”Ÿåœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ä¸å®‰å…¨åœ°ä¼ é€’ç»™æœ‰é—®é¢˜çš„å¹³å°API**æ—¶ã€‚è¿™åŒ…æ‹¬é‚£äº›åœ¨è°ƒç”¨æ—¶å¯èƒ½å¯¼è‡´ç”¨æˆ·è®¡ç®—æœºæ¶ˆè€—**è¿‡å¤šçš„CPUæˆ–ç£ç›˜ç©ºé—´**çš„APIã€‚è¿™ç±»æ¼æ´å¯èƒ½äº§ç”Ÿé‡å¤§å‰¯ä½œç”¨ï¼Œä¾‹å¦‚æµè§ˆå™¨é€šè¿‡æ‹’ç»å°è¯•å°†æ•°æ®å­˜å‚¨åœ¨`localStorage`ä¸­æˆ–ç»ˆæ­¢ç¹å¿™è„šæœ¬æ¥é™åˆ¶ç½‘ç«™åŠŸèƒ½ã€‚ 

æ¼æ´ç‚¹ï¼š
```javascript
requestFileSystem()
RegExp()
```
## DOMæ¬ºéª—

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**ï¼Ÿæˆ–è€…æƒ³è¦è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– **ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **åœ¨Twitterä¸Šå…³æ³¨** æˆ‘ **ğŸ¦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
