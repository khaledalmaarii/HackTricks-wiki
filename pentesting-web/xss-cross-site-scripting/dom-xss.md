# DOM XSS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## **DOM XSSæ¼æ´**

> **æº**
>
> æºæ˜¯ä¸€ä¸ªæ¥å—æ½œåœ¨å—æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®çš„JavaScriptå±æ€§ã€‚ä¸€ä¸ªæºçš„ä¾‹å­æ˜¯`location.search`å±æ€§ï¼Œå› ä¸ºå®ƒä»æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­è¯»å–è¾“å…¥ï¼Œè¿™å¯¹æ”»å‡»è€…æ¥è¯´ç›¸å¯¹ç®€å•ã€‚æœ€ç»ˆï¼Œä»»ä½•å¯ä»¥è¢«æ”»å‡»è€…æ§åˆ¶çš„å±æ€§éƒ½æ˜¯æ½œåœ¨çš„æºã€‚è¿™åŒ…æ‹¬å¼•ç”¨URLï¼ˆç”±`document.referrer`å­—ç¬¦ä¸²å…¬å¼€ï¼‰ã€ç”¨æˆ·çš„cookiesï¼ˆç”±`document.cookie`å­—ç¬¦ä¸²å…¬å¼€ï¼‰å’ŒWebæ¶ˆæ¯ã€‚

> **æ±‡**
>
> æ±‡æ˜¯ä¸€ä¸ªæ½œåœ¨å±é™©çš„JavaScriptå‡½æ•°æˆ–DOMå¯¹è±¡ï¼Œå¦‚æœä¼ é€’ç»™å®ƒçš„æ•°æ®å—åˆ°æ”»å‡»è€…æ§åˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸è‰¯å½±å“ã€‚ä¾‹å¦‚ï¼Œ`eval()`å‡½æ•°æ˜¯ä¸€ä¸ªæ±‡ï¼Œå› ä¸ºå®ƒå°†ä¼ é€’ç»™å®ƒçš„å‚æ•°ä½œä¸ºJavaScriptè¿›è¡Œå¤„ç†ã€‚HTMLæ±‡çš„ä¸€ä¸ªä¾‹å­æ˜¯`document.body.innerHTML`ï¼Œå› ä¸ºå®ƒå¯èƒ½å…è®¸æ”»å‡»è€…æ³¨å…¥æ¶æ„HTMLå¹¶æ‰§è¡Œä»»æ„JavaScriptã€‚

ä»æ ¹æœ¬ä¸Šè®²ï¼Œå½“ä¸€ä¸ªç½‘ç«™**å°†æ•°æ®ä»æºä¼ é€’åˆ°æ±‡**ï¼Œç„¶ååœ¨å®¢æˆ·ç«¯ä¼šè¯çš„ä¸Šä¸‹æ–‡ä¸­ä»¥ä¸å®‰å…¨çš„æ–¹å¼å¤„ç†æ•°æ®æ—¶ï¼Œå°±ä¼šå‡ºç°DOM-basedæ¼æ´ã€‚

{% hint style="info" %}
**ä½ å¯ä»¥åœ¨**[**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki)**ä¸Šæ‰¾åˆ°æ›´å¤šæ›´æ–°çš„æºå’Œæ±‡çš„åˆ—è¡¨ã€‚**
{% endhint %}

**å¸¸è§çš„æºï¼š**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**å¸¸è§çš„æ¼æ´ç‚¹ï¼š**

| [**å¼€æ”¾é‡å®šå‘**](dom-xss.md#open-redirect)                                    | [**JavaScriptæ³¨å…¥**](dom-xss.md#javascript-injection)                         | [**DOMæ•°æ®æ“ä½œ**](dom-xss.md#dom-data-manipulation) | **jQuery**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() constructor`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“ä½œ**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**Ajaxè¯·æ±‚æ“ä½œ**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**é“¾æ¥æ“ä½œ**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**å®¢æˆ·ç«¯JSONæ³¨å…¥**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**HTML5å­˜å‚¨æ“ä½œ**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**XPathæ³¨å…¥**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**`æ‹’ç»æœåŠ¡`**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**Cookieæ“ä½œ**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**æ–‡æ¡£åŸŸæ“ä½œ**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**WebSocket-URLæ±¡æŸ“**](dom-xss.md#websocket-url-poisoning)      |
| [**å®¢æˆ·ç«¯SQLæ³¨å…¥**](dom-xss.md#client-side-sql-injection)            | [**Webæ¶ˆæ¯æ“ä½œ**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

**`innerHTML`** æ¼æ´ç‚¹åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸Šéƒ½ä¸æ¥å— `script` å…ƒç´ ï¼Œä¹Ÿä¸ä¼šè§¦å‘ `svg onload` äº‹ä»¶ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨æ›¿ä»£å…ƒç´ ï¼Œå¦‚ `img` æˆ– `iframe`ã€‚

è¿™ç§ç±»å‹çš„ XSS å¯èƒ½æ˜¯**æœ€éš¾å‘ç°**çš„ï¼Œå› ä¸ºæ‚¨éœ€è¦æŸ¥çœ‹ JS ä»£ç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦**ä½¿ç”¨**äº†æ‚¨å¯ä»¥æ§åˆ¶çš„ä»»ä½•å¯¹è±¡çš„**å€¼**ï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œå†çœ‹çœ‹æ˜¯å¦æœ‰**ä»»ä½•æ»¥ç”¨**å®ƒæ‰§è¡Œä»»æ„ JS çš„æ–¹æ³•ã€‚

## ç”¨äºæŸ¥æ‰¾çš„å·¥å…·

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)

## ç¤ºä¾‹

### å¼€æ”¾é‡å®šå‘

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

#### å¦‚ä½•

DOM-based å¼€æ”¾é‡å®šå‘æ¼æ´æ˜¯åœ¨è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®**å†™å…¥å¯ä»¥è§¦å‘**è·¨åŸŸå¯¼èˆª**çš„**æ¼æ´ç‚¹**æ—¶äº§ç”Ÿçš„ã€‚

è¯·è®°ä½ï¼Œ**å¦‚æœæ‚¨å¯ä»¥å¼€å§‹ URL**ï¼Œå°†ä¼š**é‡å®šå‘**å—å®³è€…ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œ**ä»»æ„ä»£ç **ï¼Œå¦‚ï¼š**`javascript:alert(1)`**

#### æ¼æ´ç‚¹
```
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### Cookieæ“çºµ

æ¥è‡ªï¼š[https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

#### å¦‚ä½•è¿›è¡Œ

DOM-based cookieæ“çºµæ¼æ´æ˜¯æŒ‡è„šæœ¬å°†**æ”»å‡»è€…å¯æ§æ•°æ®å†™å…¥cookieçš„å€¼**ä¸­ã€‚\
è¿™å¯èƒ½è¢«æ»¥ç”¨ä»¥ä½¿é¡µé¢ä»¥æ„å¤–çš„æ–¹å¼è¡Œä¸ºï¼ˆå¦‚æœcookieåœ¨ç½‘é¡µä¸­ä½¿ç”¨ï¼‰ï¼Œæˆ–è€…ç”¨äºæ‰§è¡Œ[ä¼šè¯å›ºå®š](../hacking-with-cookies/#session-fixation)æ”»å‡»ï¼ˆå¦‚æœcookieç”¨äºè·Ÿè¸ªç”¨æˆ·çš„ä¼šè¯ï¼‰ã€‚

#### æ¼æ´ç‚¹
```
document.cookie
```
### JavaScriptæ³¨å…¥

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

#### å¦‚ä½•è¿›è¡Œ

DOM-based JavaScriptæ³¨å…¥æ¼æ´æ˜¯æŒ‡å½“è„šæœ¬å°†**æ”»å‡»è€…å¯æ§æ•°æ®ä½œä¸ºJavaScriptä»£ç æ‰§è¡Œ**æ—¶äº§ç”Ÿçš„æ¼æ´ã€‚

#### æ¼æ´ç‚¹
```
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### æ–‡æ¡£åŸŸæ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

#### å¦‚ä½•è¿›è¡Œ

æ–‡æ¡£åŸŸæ“çºµæ¼æ´æ˜¯æŒ‡è„šæœ¬ä½¿ç”¨**æ”»å‡»è€…å¯æ§æ•°æ®æ¥è®¾ç½®**`document.domain`å±æ€§ã€‚

`document.domain`å±æ€§ç”±æµè§ˆå™¨ç”¨äº**å¼ºåˆ¶æ‰§è¡Œ**åŒæºç­–ç•¥ã€‚å¦‚æœæ¥è‡ª**ä¸åŒæº**çš„**ä¸¤ä¸ªé¡µé¢**æ˜¾å¼è®¾ç½®äº†**ç›¸åŒçš„`document.domain`**å€¼ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªé¡µé¢å¯ä»¥ä»¥**æ— é™åˆ¶çš„æ–¹å¼è¿›è¡Œäº¤äº’**ã€‚\
æµè§ˆå™¨é€šå¸¸å¯¹å¯ä»¥åˆ†é…ç»™`document.domain`çš„å€¼æ–½åŠ ä¸€äº›é™åˆ¶ï¼Œå¹¶ä¸”å¯èƒ½é˜»æ­¢ä½¿ç”¨ä¸é¡µé¢çš„å®é™…æ¥æºå®Œå…¨ä¸åŒçš„å€¼ã€‚**ä½†å¹¶éæ€»æ˜¯å¦‚æ­¤**ï¼Œå®ƒä»¬é€šå¸¸**å…è®¸ä½¿ç”¨å­åŸŸ**æˆ–**çˆ¶åŸŸ**ã€‚

#### æ¼æ´ç‚¹
```
document.domain
```
### WebSocket-URLæ±¡æŸ“

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

#### å¦‚ä½•è¿›è¡Œ

å½“è„šæœ¬ä½¿ç”¨**å¯æ§æ•°æ®ä½œä¸ºWebSocketè¿æ¥çš„ç›®æ ‡URL**æ—¶ï¼Œå°±ä¼šå‘ç”ŸWebSocket-URLæ±¡æŸ“ã€‚

#### æ¼æ´ç‚¹

`WebSocket`æ„é€ å‡½æ•°å¯èƒ½å¯¼è‡´WebSocket-URLæ±¡æŸ“æ¼æ´ã€‚

### é“¾æ¥æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

#### å¦‚ä½•è¿›è¡Œ

DOMé“¾æ¥æ“çºµæ¼æ´æ˜¯æŒ‡è„šæœ¬å°†**æ”»å‡»è€…å¯æ§æ•°æ®å†™å…¥å½“å‰é¡µé¢çš„å¯¼èˆªç›®æ ‡**ï¼Œä¾‹å¦‚å¯ç‚¹å‡»çš„é“¾æ¥æˆ–è¡¨å•çš„æäº¤URLã€‚

#### æ¼æ´ç‚¹
```
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### Ajaxè¯·æ±‚æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

#### å¦‚ä½•è¿›è¡Œ

å½“è„šæœ¬ä½¿ç”¨`XmlHttpRequest`å¯¹è±¡å‘å‡ºAjaxè¯·æ±‚ï¼Œå¹¶å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®å†™å…¥è¯¥è¯·æ±‚**æ—¶ï¼Œå°±ä¼šå‡ºç°Ajaxè¯·æ±‚æ“çºµæ¼æ´ã€‚

#### æ¼æ´ç‚¹
```
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

#### å¦‚ä½•è¿›è¡Œ

å½“è„šæœ¬å°†**å—æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®**ä½œä¸º`filename`å‚æ•°ä¼ é€’ç»™æ–‡ä»¶å¤„ç†APIæ—¶ï¼Œå°±ä¼šå‡ºç°æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“çºµæ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´æ„é€ ä¸€ä¸ªURLï¼Œå¦‚æœè¢«å…¶ä»–ç”¨æˆ·è®¿é—®ï¼Œå°†å¯¼è‡´**ç”¨æˆ·çš„æµè§ˆå™¨æ‰“å¼€/å†™å…¥ä»»æ„æœ¬åœ°æ–‡ä»¶**ã€‚

#### æ¼æ´ç‚¹
```
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### å®¢æˆ·ç«¯SQLæ³¨å…¥

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

#### å¦‚ä½•è¿›è¡Œ

å½“è„šæœ¬ä»¥ä¸å®‰å…¨çš„æ–¹å¼å°†**æ”»å‡»è€…å¯æ§æ•°æ®**åˆå¹¶åˆ°å®¢æˆ·ç«¯SQLæŸ¥è¯¢ä¸­æ—¶ï¼Œå°±ä¼šå‡ºç°å®¢æˆ·ç«¯SQLæ³¨å…¥æ¼æ´ã€‚

#### æ¼æ´ç‚¹
```
executeSql()
```
### HTML5å­˜å‚¨æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

#### å¦‚ä½•è¿›è¡Œ

å½“è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®å­˜å‚¨åœ¨Webæµè§ˆå™¨çš„HTML5å­˜å‚¨ä¸­**ï¼ˆæ— è®ºæ˜¯`localStorage`è¿˜æ˜¯`sessionStorage`ï¼‰ï¼Œå°±ä¼šå‡ºç°HTML5å­˜å‚¨æ“çºµæ¼æ´ã€‚\
è¿™ç§è¡Œä¸ºæœ¬èº«å¹¶ä¸æ„æˆå®‰å…¨æ¼æ´ã€‚ç„¶è€Œï¼Œå¦‚æœåº”ç”¨ç¨‹åºç¨å**ä»å­˜å‚¨ä¸­è¯»å–æ•°æ®å¹¶ä»¥ä¸å®‰å…¨çš„æ–¹å¼å¤„ç†**ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨å­˜å‚¨æœºåˆ¶æ¥è¿›è¡Œå…¶ä»–åŸºäºDOMçš„æ”»å‡»ï¼Œå¦‚è·¨ç«™è„šæœ¬å’ŒJavaScriptæ³¨å…¥ã€‚

#### æ¼æ´ç‚¹
```
sessionStorage.setItem()
localStorage.setItem()
```
### XPathæ³¨å…¥

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

#### å¦‚ä½•è¿›è¡Œ

DOM-based XPathæ³¨å…¥æ¼æ´æ˜¯æŒ‡å½“è„šæœ¬å°†**æ”»å‡»è€…å¯æ§æ•°æ®**åˆå¹¶åˆ°XPathæŸ¥è¯¢ä¸­æ—¶äº§ç”Ÿçš„æ¼æ´ã€‚

#### æ¼æ´ç‚¹
```
document.evaluate()
someDOMElement.evaluate()
```
### å®¢æˆ·ç«¯JSONæ³¨å…¥

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

#### å¦‚ä½•è¿›è¡Œ

DOM-based JSONæ³¨å…¥æ¼æ´æ˜¯æŒ‡å½“è„šæœ¬å°†**æ”»å‡»è€…å¯æ§æ•°æ®åˆå¹¶åˆ°ä¸€ä¸ªè¢«è§£æä¸ºJSONæ•°æ®ç»“æ„çš„å­—ç¬¦ä¸²ä¸­ï¼Œå¹¶ç”±åº”ç”¨ç¨‹åºè¿›è¡Œå¤„ç†**æ—¶äº§ç”Ÿçš„æ¼æ´ã€‚

#### æ¼æ´ç‚¹
```
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### Webæ¶ˆæ¯æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

#### å¦‚ä½•è¿›è¡Œæ”»å‡»

å½“è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ä½œä¸ºWebæ¶ˆæ¯å‘é€åˆ°æµè§ˆå™¨ä¸­çš„å¦ä¸€ä¸ªæ–‡æ¡£**æ—¶ï¼Œå°±ä¼šå‡ºç°Webæ¶ˆæ¯æ¼æ´ã€‚\
åœ¨[https://portswigger.net/web-security/dom-based/controlling-the-web-message-source](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)ä¸­æœ‰ä¸€ä¸ªæ˜“å—æ”»å‡»çš„Webæ¶ˆæ¯æ“çºµç¤ºä¾‹ã€‚

#### æ¼æ´ç‚¹

å¦‚æœç”¨äºæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶ç›‘å¬å™¨ä»¥ä¸å®‰å…¨çš„æ–¹å¼å¤„ç†ä¼ å…¥æ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨`postMessage()`æ–¹æ³•å‘é€Webæ¶ˆæ¯å¯èƒ½ä¼šå¯¼è‡´æ¼æ´ã€‚

### DOMæ•°æ®æ“çºµ

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

#### å¦‚ä½•è¿›è¡Œæ”»å‡»

å½“è„šæœ¬å°†**å¯ç”±æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®å†™å…¥DOMä¸­çš„å­—æ®µ**ï¼Œå¹¶åœ¨å¯è§çš„ç”¨æˆ·ç•Œé¢æˆ–å®¢æˆ·ç«¯é€»è¾‘ä¸­ä½¿ç”¨æ—¶ï¼Œå°±ä¼šå‡ºç°DOMæ•°æ®æ“çºµæ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ„é€ ä¸€ä¸ªURLï¼Œå¦‚æœè¢«å…¶ä»–ç”¨æˆ·è®¿é—®ï¼Œå°†ä¿®æ”¹å®¢æˆ·ç«¯ç”¨æˆ·ç•Œé¢çš„å¤–è§‚æˆ–è¡Œä¸ºã€‚

#### æ¼æ´ç‚¹
```
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### æ‹’ç»æœåŠ¡

æ¥æºï¼š[https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

#### å¦‚ä½•å®ç°

DOM-basedæ‹’ç»æœåŠ¡æ¼æ´æ˜¯æŒ‡å½“è„šæœ¬ä»¥ä¸å®‰å…¨çš„æ–¹å¼å°†**æ”»å‡»è€…å¯æ§æ•°æ®ä¼ é€’ç»™æœ‰é—®é¢˜çš„å¹³å°API**æ—¶äº§ç”Ÿçš„ã€‚è¿™äº›APIçš„è°ƒç”¨å¯èƒ½å¯¼è‡´ç”¨æˆ·è®¡ç®—æœºæ¶ˆè€—**è¿‡å¤šçš„CPUæˆ–ç£ç›˜ç©ºé—´**ã€‚å¦‚æœæµè§ˆå™¨é™åˆ¶äº†ç½‘ç«™çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ‹’ç»å°è¯•å°†æ•°æ®å­˜å‚¨åœ¨`localStorage`ä¸­æˆ–ç»ˆæ­¢ç¹å¿™çš„è„šæœ¬ï¼Œè¿™å¯èƒ½ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚

#### æ¼æ´ç‚¹
```
requestFileSystem()
RegExp()
```
## Dom Clobbering

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ**[**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
