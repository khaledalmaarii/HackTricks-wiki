# DOM XSS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DOM Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚

DOM ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ **Ï€Î·Î³Î­Ï‚** Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ (ÏŒÏ€Ï‰Ï‚ `location.search`, `document.referrer`, Î® `document.cookie`) Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ Î¼Îµ Î±Î½Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿ ÏƒÎµ **ÏƒÏ„ÏŒÏ‡Î¿Ï…Ï‚**. ÎŸÎ¹ ÏƒÏ„ÏŒÏ‡Î¿Î¹ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î® Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± (Ï€.Ï‡., `eval()`, `document.body.innerHTML`) Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î½ Î® Î½Î± Î±Ï€Î¿Î´ÏÏƒÎ¿Ï…Î½ ÎµÏ€Î¹Î²Î»Î±Î²Î­Ï‚ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î±Î½ Î»Î¬Î²Î¿Ï…Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.

* **Î Î·Î³Î­Ï‚** ÎµÎ¯Î½Î±Î¹ ÎµÎ¯ÏƒÎ¿Î´Î¿Î¹ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÎµÎ¹ÏÎ±Î³Ï‰Î³Î·Î¸Î¿ÏÎ½ Î±Ï€ÏŒ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ Ï„Ï‰Î½ URLs, cookies ÎºÎ±Î¹ Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÏÎ½ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½.
* **Î£Ï„ÏŒÏ‡Î¿Î¹** ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ ÎµÏ€Î¹ÎºÎ¯Î½Î´Ï…Î½ÎµÏ‚ ÎºÎ±Ï„Î±Î»Î®Î¾ÎµÎ¹Ï‚ ÏŒÏ€Î¿Ï… Ï„Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎ¿Ï…Î½ ÏƒÎµ Î±ÏÎ½Î·Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î­Ï€ÎµÎ¹ÎµÏ‚, ÏŒÏ€Ï‰Ï‚ Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½.

ÎŸ ÎºÎ¯Î½Î´Ï…Î½Î¿Ï‚ Ï€ÏÎ¿ÎºÏÏ€Ï„ÎµÎ¹ ÏŒÏ„Î±Î½ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏÎ­Î¿Ï…Î½ Î±Ï€ÏŒ Î¼Î¹Î± Ï€Î·Î³Î® ÏƒÎµ Î­Î½Î±Î½ ÏƒÏ„ÏŒÏ‡Î¿ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· Î® Î±Ï€Î¿Î»ÏÎ¼Î±Î½ÏƒÎ·, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ XSS.

{% hint style="info" %}
**You can find a more updated list of sources and sinks in** [**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki)
{% endhint %}

**ÎšÎ¿Î¹Î½Î­Ï‚ Ï€Î·Î³Î­Ï‚:**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**ÎšÎ¿Î¹Î½Î­Ï‚ Î£Î·Î¼ÎµÎ¯ÎµÏ‚ Î•Î¹ÏƒÏŒÎ´Î¿Ï…:**

| [**Î‘Î½Î¿Î¹Ï‡Ï„Î® Î‘Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·**](dom-xss.md#open-redirect)                                    | [**Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Javascript**](dom-xss.md#javascript-injection)                         | [**Manipulation DOM-data**](dom-xss.md#dom-data-manipulation) | **jQuery**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() constructor`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**Manipulation Ï„Î¿Ï€Î¹ÎºÎ®Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**Manipulation Î±Î¹Ï„Î®ÏƒÎµÏ‰Î½ Ajax**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**Manipulation ÏƒÏ…Î½Î´Î­ÏƒÎ¼Ï‰Î½**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® JSON Î±Ï€ÏŒ Ï„Î¿Î½ Ï€ÎµÎ»Î¬Ï„Î·**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**Manipulation Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ HTML5**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® XPath**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**`Î†ÏÎ½Î·ÏƒÎ· Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚`**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**Manipulation cookie**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**Manipulation Ï„Î¿Î¼Î­Î± ÎµÎ³Î³ÏÎ¬Ï†Î¿Ï…**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**Î”Î·Î»Î·Ï„Î·ÏÎ¯Î±ÏƒÎ· URL WebSocket**](dom-xss.md#websocket-url-poisoning)      |
| [**Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® SQl Î±Ï€ÏŒ Ï„Î¿Î½ Ï€ÎµÎ»Î¬Ï„Î·**](dom-xss.md#client-side-sql-injection)            | [**Manipulation Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Web**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

Î— **`innerHTML`** ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Î´ÎµÎ½ Î´Î­Ï‡ÎµÏ„Î±Î¹ `script` ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÎµ ÎºÎ±Î½Î­Î½Î±Î½ ÏƒÏÎ³Ï‡ÏÎ¿Î½Î¿ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®, Î¿ÏÏ„Îµ Î¸Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Ï„Î± Î³ÎµÎ³Î¿Î½ÏŒÏ„Î± `svg onload`. Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ `img` Î® `iframe`.

Î‘Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¯Î´Î¿Ï…Ï‚ Ï„Î¿ XSS ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏÏ‚ Ï„Î¿ **Ï€Î¹Î¿ Î´ÏÏƒÎºÎ¿Î»Î¿ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯**, ÎºÎ±Î¸ÏÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¿Î¹Ï„Î¬Î¾ÎµÏ„Îµ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± JS, Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯** Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï„Î¿Ï… Î¿Ï€Î¿Î¯Î¿Ï… Ï„Î·Î½ **Ï„Î¹Î¼Î® ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ**, ÎºÎ±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ **Î¿Ï€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ Ï„ÏÏŒÏ€Î¿Ï‚ Î½Î± Ï„Î¿ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ** Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ JS.

## Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î³Î¹Î± Î½Î± Ï„Î± Î²ÏÎµÎ¯Ï„Îµ

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)
* Î•Ï€Î­ÎºÏ„Î±ÏƒÎ· Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î® Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ¬Î¸Îµ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿ Ï€Î¿Ï… Ï†Ï„Î¬Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Ï€Î¹Î¸Î±Î½Î® ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï…: [https://github.com/kevin-mizu/domloggerpp](https://github.com/kevin-mizu/domloggerpp)

## Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±

### Î‘Î½Î¿Î¹Ï‡Ï„Î® Î‘Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·

Î‘Ï€ÏŒ: [https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Î½Î¿Î¹Ï‡Ï„Î®Ï‚ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ ÏƒÏ„Î¿ DOM** ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³ÏÎ¬Ï†ÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚, ÏƒÎµ Î¼Î¹Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Î¹ÎºÎ±Î½Î® Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹ Ï€Î»Î¿Î®Î³Î·ÏƒÎ· ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎ¿Ï…Ï‚ Ï„Î¿Î¼ÎµÎ¯Ï‚.

Î•Î¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±, ÏŒÏ€Ï‰Ï‚ **`javascript:alert(1)`**, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î±Î½ Î­Ï‡ÎµÏ„Îµ Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î® Ï„Î·Ï‚ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ URL ÏŒÏ€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î· Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·.

Î£Î·Î¼ÎµÎ¯Î± Î•Î¹ÏƒÏŒÎ´Î¿Ï…:
```javascript
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### Cookie manipulation

From: [https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï‡ÎµÎ¹ÏÎ¹ÏƒÎ¼Î¿Ï cookie Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ DOM ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ»ÎµÎ³Ï‡Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿, ÏƒÏ„Î·Î½ Ï„Î¹Î¼Î® ÎµÎ½ÏŒÏ‚ cookie. Î‘Ï…Ï„Î® Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Î·Ï‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±Ï‚ Î±Î½ Ï„Î¿ cookie Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… Î¹ÏƒÏ„ÏŒÏ„Î¿Ï€Î¿Ï…. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î³Î¹Î± Î½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼Î¹Î± ÎµÏ€Î¯Î¸ÎµÏƒÎ· ÏƒÏ„Î±Î¸ÎµÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±Ï‚ Î±Î½ Ï„Î¿ cookie ÎµÎ¼Ï€Î»Î­ÎºÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï„Ï‰Î½ ÏƒÏ…Î½ÎµÎ´ÏÎ¹ÏÎ½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½. ÎŸ ÎºÏÏÎ¹Î¿Ï‚ Î±Ï€Î¿Î´Î­ÎºÏ„Î·Ï‚ Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÎ¯Î½Î±Î¹:

Sinks:
```javascript
document.cookie
```
### JavaScript Injection

From: [https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ JavaScript Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ DOM Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ»ÎµÎ³Ï‡Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿, Ï‰Ï‚ ÎºÏÎ´Î¹ÎºÎ± JavaScript.

Sinks:
```javascript
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### Document-domain manipulation

From: [https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

**Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï‡ÎµÎ¹ÏÎ¹ÏƒÎ¼Î¿Ï document-domain** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± `document.domain` Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚.

Î— Î¹Î´Î¹ÏŒÏ„Î·Ï„Î± `document.domain` Ï€Î±Î¯Î¶ÎµÎ¹ Î­Î½Î±Î½ **ÎºÎµÎ½Ï„ÏÎ¹ÎºÏŒ ÏÏŒÎ»Î¿** ÏƒÏ„Î·Î½ **ÎµÏ€Î¹Î²Î¿Î»Î®** Ï„Î·Ï‚ **Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚ Î¯Î´Î¹Î±Ï‚ Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ·Ï‚** Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î­Ï‚. ÎŒÏ„Î±Î½ Î´ÏÎ¿ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î±Ï€ÏŒ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¿ÎµÎ»ÎµÏÏƒÎµÎ¹Ï‚ Î¿ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î¿ `document.domain` Ï„Î¿Ï…Ï‚ ÏƒÏ„Î·Î½ **Î¯Î´Î¹Î± Ï„Î¹Î¼Î®**, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¿ÏÎ½ Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚. Î‘Î½ ÎºÎ±Î¹ Î¿Î¹ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î­Ï‚ ÎµÏ€Î¹Î²Î¬Î»Î»Î¿Ï…Î½ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿Ï…Ï‚ **Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚** ÏƒÏ„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Î±Ï„ÎµÎ¸Î¿ÏÎ½ ÏƒÏ„Î¿ `document.domain`, Î±Ï€Î¿Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Î½Î¬Î¸ÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ Î¬ÏƒÏ‡ÎµÏ„Ï‰Î½ Ï„Î¹Î¼ÏÎ½ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚. Î£Ï…Î½Î®Î¸Ï‰Ï‚, Î¿Î¹ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î­Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î· Ï‡ÏÎ®ÏƒÎ· **Ï…Ï€Î¿Ï„Î¿Î¼Î­Ï‰Î½** Î® **Î³Î¿Î½Î¹ÎºÏÎ½ Ï„Î¿Î¼Î­Ï‰Î½**.

Sinks:
```javascript
document.domain
```
### WebSocket-URL poisoning

From: [https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

**WebSocket-URL poisoning** ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ **ÎµÎ»Î­Î³Î¾Î¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï‰Ï‚ Ï„Î¿Î½ ÏƒÏ„ÏŒÏ‡Î¿ URL** Î³Î¹Î± Î¼Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· WebSocket.

Sinks:

ÎŸ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÏ„Î®Ï‚ `WebSocket` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ WebSocket-URL poisoning.

### Link manipulation

From: [https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

**DOM-based link-manipulation vulnerabilities** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³ÏÎ¬Ï†ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ»Î­Î³Ï‡Î¿Ï… ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï… ÏƒÎµ Î­Î½Î±Î½ ÏƒÏ„ÏŒÏ‡Î¿ Ï€Î»Î¿Î®Î³Î·ÏƒÎ·Ï‚** Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÏƒÎµÎ»Î¯Î´Î±, ÏŒÏ€Ï‰Ï‚ Î­Î½Î±Ï‚ ÎºÎ»Î¹ÎºÎ±ÏÎ¯ÏƒÎ¹Î¼Î¿Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿Ï‚ Î® Î· URL Ï…Ï€Î¿Î²Î¿Î»Î®Ï‚ Î¼Î¹Î±Ï‚ Ï†ÏŒÏÎ¼Î±Ï‚.

Sinks:
```javascript
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### Ajax request manipulation

From: [https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï‡ÎµÎ¹ÏÎ¹ÏƒÎ¼Î¿Ï Î±Î¹Ï„Î·Î¼Î¬Ï„Ï‰Î½ Ajax** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³ÏÎ¬Ï†ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î­Î½Î± Î±Î¯Ï„Î·Î¼Î± Ajax** Ï€Î¿Ï… ÎµÎºÎ´Î¯Î´ÎµÏ„Î±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ `XmlHttpRequest`.

Sinks:
```javascript
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### Î¤Î¿Ï€Î¹ÎºÎ® Ï€Î±ÏÎ±Ï€Î¿Î¯Î·ÏƒÎ· Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…

From: [https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï„Î¿Ï€Î¹ÎºÎ®Ï‚ Ï€Î±ÏÎ±Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï€ÎµÏÎ½Î¬ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î¼Î¹Î± API Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½** Ï‰Ï‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `filename`. Î‘Ï…Ï„Î® Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎµÎ¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Ï€Î¿Ï…, Î±Î½ ÎµÏ€Î¹ÏƒÎºÎµÏ†Î¸ÎµÎ¯ Î±Ï€ÏŒ Î­Î½Î±Î½ Î¬Î»Î»Î¿ Ï‡ÏÎ®ÏƒÏ„Î·, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÏ„Î¿ **Î½Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ Î® Î½Î± Î³ÏÎ¬ÏˆÎµÎ¹ Î¿ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®Ï‚ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Î­Î½Î± Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿ Ï„Î¿Ï€Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿**.

Sinks:
```javascript
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### Client-Side SQl injection

From: [https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ SQL injection ÏƒÏ„Î¿Î½ Ï€ÎµÎ»Î¬Ï„Î·** ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î­Î½Î± ÎµÏÏÏ„Î·Î¼Î± SQL ÏƒÏ„Î¿Î½ Ï€ÎµÎ»Î¬Ï„Î· Î¼Îµ Î±Î½Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿**.

Sinks:
```javascript
executeSql()
```
### HTML5-storage manipulation

From: [https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï‡ÎµÎ¹ÏÎ¹ÏƒÎ¼Î¿Ï HTML5-storage** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ **Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÏ„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· HTML5 Ï„Î¿Ï… Ï†Ï…Î»Î»Î¿Î¼ÎµÏ„ÏÎ·Ï„Î®** (`localStorage` Î® `sessionStorage`). Î•Î½Ï Î±Ï…Ï„Î® Î· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÎ³Î³ÎµÎ½ÏÏ‚ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚, Î³Î¯Î½ÎµÏ„Î±Î¹ Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ® Î±Î½ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± **Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ Ï„Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ Ï„Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„ÎµÎ¯ Î¼Îµ Î±Î½Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿**. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï„Î¿Î½ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ Î³Î¹Î± Î½Î± Î´Î¹ÎµÎ¾Î¬Î³ÎµÎ¹ Î¬Î»Î»ÎµÏ‚ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ„Î¿ DOM, ÏŒÏ€Ï‰Ï‚ Î· Î´Î¹Î±ÏƒÏ„Î±Ï…ÏÎ¿ÏÎ¼ÎµÎ½Î· Ïƒcripting ÎºÎ±Î¹ Î· Î­Î½ÎµÏƒÎ· JavaScript.

Sinks:
```javascript
sessionStorage.setItem()
localStorage.setItem()
```
### XPath injection

From: [https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

**Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ DOM-based XPath-injection** ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î­Î½Î± ÎµÏÏÏ„Î·Î¼Î± XPath**.

Sinks:
```javascript
document.evaluate()
someDOMElement.evaluate()
```
### Client-side JSON injection

From: [https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

**ÎŸÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ JSON-injection Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ DOM** ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÎ½ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î¼Î¹Î± ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ Ï€Î¿Ï… Î±Î½Î±Î»ÏÎµÏ„Î±Î¹ Ï‰Ï‚ Î´Î¿Î¼Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ JSON ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®**.

Sinks:
```javascript
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### Web-message manipulation

From: [https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

**Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ web-message** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ ÏƒÏ„Î­Î»Î½ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Ï‰Ï‚ web message ÏƒÎµ Î¬Î»Î»Î¿ Î­Î³Î³ÏÎ±Ï†Î¿** Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®. ÎˆÎ½Î± **Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±** ÎµÏ…Î¬Î»Ï‰Ï„Î·Ï‚ web-message Ï‡ÎµÎ¹ÏÎ±Î³ÏÎ³Î·ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ ÏƒÏ„Î·Î½ [Î‘ÎºÎ±Î´Î·Î¼Î¯Î± Î‘ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î™ÏƒÏ„Î¿Ï Ï„Î¿Ï… PortSwigger](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source).

Sinks:

Î— Î¼Î­Î¸Î¿Î´Î¿Ï‚ `postMessage()` Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® web messages Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Î½ Î¿ Î±ÎºÏÎ¿Î±Ï„Î®Ï‚ Î³ÎµÎ³Î¿Î½ÏŒÏ„Ï‰Î½ Î³Î¹Î± Ï„Î·Î½ Ï€Î±ÏÎ±Î»Î±Î²Î® Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï„Î± ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Îµ Î¼Î· Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿.

### DOM-data manipulation

From: [https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

**Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ DOM-data manipulation** Ï€ÏÎ¿ÎºÏÏ€Ï„Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Î³ÏÎ¬Ï†ÎµÎ¹ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ»ÎµÎ³Ï‡ÏŒÎ¼ÎµÎ½Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ ÏƒÎµ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ DOM** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î·Î½ Î¿ÏÎ±Ï„Î® Î´Î¹ÎµÏ€Î±Ï†Î® Ï‡ÏÎ®ÏƒÏ„Î· Î® ÏƒÏ„Î· Î»Î¿Î³Î¹ÎºÎ® Ï€Î»ÎµÏ…ÏÎ¬ Ï„Î¿Ï… Ï€ÎµÎ»Î¬Ï„Î·. Î‘Ï…Ï„Î® Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï€ÏŒ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎµÎ¹ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL Ï€Î¿Ï…, Î±Î½ ÎµÏ€Î¹ÏƒÎºÎµÏ†Î¸ÎµÎ¯ Î±Ï€ÏŒ Î¬Î»Î»Î¿ Ï‡ÏÎ®ÏƒÏ„Î·, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î·Î½ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î® Ï„Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ Ï„Î·Ï‚ Î´Î¹ÎµÏ€Î±Ï†Î®Ï‚ Ï‡ÏÎ®ÏƒÏ„Î· Ï€Î»ÎµÏ…ÏÎ¬Ï‚ Ï„Î¿Ï… Ï€ÎµÎ»Î¬Ï„Î·.

Sinks:
```javascript
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### Denial of Service

From: [https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

**Î•Ï…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î¬ÏÎ½Î·ÏƒÎ·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÎµ DOM** ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½ ÏŒÏ„Î±Î½ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Ï€ÎµÏÎ½Î¬ **Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î¼Îµ Î±Î½Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿ ÏƒÎµ Î¼Î¹Î± Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ® API Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±**. Î‘Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ APIs Ï€Î¿Ï…, ÏŒÏ„Î±Î½ ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î¿Î´Î·Î³Î®ÏƒÎ¿Ï…Î½ Ï„Î¿Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Î½Î± ÎºÎ±Ï„Î±Î½Î±Î»ÏÎ½ÎµÎ¹ **Ï…Ï€ÎµÏÎ²Î¿Î»Î¹ÎºÎ­Ï‚ Ï€Î¿ÏƒÏŒÏ„Î·Ï„ÎµÏ‚ CPU Î® Ï‡ÏÏÎ¿Ï… Î´Î¯ÏƒÎºÎ¿Ï…**. Î¤Î­Ï„Î¿Î¹ÎµÏ‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡Î¿Ï…Î½ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ­Ï‚ Ï€Î±ÏÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚, ÏŒÏ€Ï‰Ï‚ Î· Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î±Ï‚ Î±Ï€ÏŒ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®, Î±Ï€Î¿ÏÏÎ¯Ï€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î¿ `localStorage` Î® Ï„ÎµÏÎ¼Î±Ï„Î¯Î¶Î¿Î½Ï„Î±Ï‚ Î±Ï€Î±ÏƒÏ‡Î¿Î»Î·Î¼Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î±.

Sinks:
```javascript
requestFileSystem()
RegExp()
```
## Dom Clobbering

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
