# DOM XSS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## DOM ì·¨ì•½ì 

DOM ì·¨ì•½ì ì€ ê³µê²©ìê°€ ì œì–´í•˜ëŠ” **ì†ŒìŠ¤**(ì˜ˆ: `location.search`, `document.referrer`, ë˜ëŠ” `document.cookie`)ì—ì„œ ë°ì´í„°ê°€ ì•ˆì „í•˜ì§€ ì•Šê²Œ **ì‹±í¬**ë¡œ ì „ì†¡ë  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì‹±í¬ëŠ” ì•…ì˜ì ì¸ ë°ì´í„°ê°€ ì£¼ì–´ì§ˆ ê²½ìš° í•´ë¡œìš´ ì½˜í…ì¸ ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ ë Œë”ë§í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë‚˜ ê°ì²´(ì˜ˆ: `eval()`, `document.body.innerHTML`)ì…ë‹ˆë‹¤.

* **ì†ŒìŠ¤**ëŠ” ê³µê²©ìê°€ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ì…ë ¥ìœ¼ë¡œ, URL, ì¿ í‚¤ ë° ì›¹ ë©”ì‹œì§€ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **ì‹±í¬**ëŠ” ì•…ì˜ì ì¸ ë°ì´í„°ê°€ ë¶€ì‘ìš©ì„ ì´ˆë˜í•  ìˆ˜ ìˆëŠ” ì ì¬ì ìœ¼ë¡œ ìœ„í—˜í•œ ì—”ë“œí¬ì¸íŠ¸ë¡œ, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„í—˜ì€ ë°ì´í„°ê°€ ì ì ˆí•œ ê²€ì¦ì´ë‚˜ ì •í™” ì—†ì´ ì†ŒìŠ¤ì—ì„œ ì‹±í¬ë¡œ íë¥¼ ë•Œ ë°œìƒí•˜ë©°, ì´ëŠ” XSSì™€ ê°™ì€ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

{% hint style="info" %}
**You can find a more updated list of sources and sinks in** [**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki)
{% endhint %}

**ì¼ë°˜ì ì¸ ì†ŒìŠ¤:**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**ì¼ë°˜ì ì¸ ì‹±í¬:**

| [**ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸**](dom-xss.md#open-redirect)                                    | [**ìë°”ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…**](dom-xss.md#javascript-injection)                         | [**DOM ë°ì´í„° ì¡°ì‘**](dom-xss.md#dom-data-manipulation) | **jQuery**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() constructor`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**Ajax ìš”ì²­ ì¡°ì‘**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**ë§í¬ ì¡°ì‘**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**í´ë¼ì´ì–¸íŠ¸ ì¸¡ JSON ì£¼ì…**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**HTML5 ì €ì¥ì†Œ ì¡°ì‘**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**XPath ì£¼ì…**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**ì„œë¹„ìŠ¤ ê±°ë¶€**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**ì¿ í‚¤ ì¡°ì‘**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**ë¬¸ì„œ ë„ë©”ì¸ ì¡°ì‘**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**ì›¹ì†Œì¼“ URL ì¤‘ë…**](dom-xss.md#websocket-url-poisoning)      |
| [**í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì£¼ì…**](dom-xss.md#client-side-sql-injection)            | [**ì›¹ ë©”ì‹œì§€ ì¡°ì‘**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

**`innerHTML`** ì‹±í¬ëŠ” ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œ `script` ìš”ì†Œë¥¼ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë©°, `svg onload` ì´ë²¤íŠ¸ë„ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” `img` ë˜ëŠ” `iframe`ê³¼ ê°™ì€ ëŒ€ì²´ ìš”ì†Œë¥¼ ì‚¬ìš©í•´ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ XSSëŠ” **ì°¾ê¸° ê°€ì¥ ì–´ë ¤ìš´** ìœ í˜•ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. JS ì½”ë“œ ë‚´ë¶€ë¥¼ ì‚´í´ë³´ê³ , **ì œì–´í•  ìˆ˜ ìˆëŠ”** ê°’ì˜ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸í•œ í›„, ì´ë¥¼ ì•…ìš©í•˜ì—¬ ì„ì˜ì˜ JSë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” **ë°©ë²•ì´ ìˆëŠ”ì§€** í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.

## ì´ë¥¼ ì°¾ê¸° ìœ„í•œ ë„êµ¬

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)
* ì ì¬ì  ì‹±í¬ì— ë„ë‹¬í•˜ëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í™•ì¸í•˜ëŠ” ë¸Œë¼ìš°ì € í™•ì¥: [https://github.com/kevin-mizu/domloggerpp](https://github.com/kevin-mizu/domloggerpp)

## ì˜ˆì‹œ

### ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸

ì¶œì²˜: [https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

**DOMì—ì„œì˜ ì˜¤í”ˆ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ë„ë©”ì¸ ê°„ íƒìƒ‰ì„ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ì‹±í¬ì— ê¸°ë¡í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

ë¦¬ë‹¤ì´ë ‰ì…˜ì´ ë°œìƒí•˜ëŠ” URLì˜ ì‹œì‘ ë¶€ë¶„ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤ë©´ **`javascript:alert(1)`**ê³¼ ê°™ì€ ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ì‹±í¬:
```javascript
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### Cookie manipulation

From: [https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

DOM ê¸°ë°˜ ì¿ í‚¤ ì¡°ì‘ ì·¨ì•½ì ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì¿ í‚¤ì˜ ê°’ì— í¬í•¨í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ì¿ í‚¤ê°€ ì‚¬ì´íŠ¸ ë‚´ì—ì„œ ì‚¬ìš©ë  ê²½ìš° ì›¹í˜ì´ì§€ì˜ ì˜ˆê¸°ì¹˜ ì•Šì€ ë™ì‘ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì¿ í‚¤ê°€ ì‚¬ìš©ì ì„¸ì…˜ ì¶”ì ì— ê´€ì—¬í•˜ëŠ” ê²½ìš° ì„¸ì…˜ ê³ ì • ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì·¨ì•½ì ê³¼ ê´€ë ¨ëœ ì£¼ìš” ì‹±í¬ëŠ”:

Sinks:
```javascript
document.cookie
```
### JavaScript Injection

From: [https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

DOM ê¸°ë°˜ JavaScript ì£¼ì… ì·¨ì•½ì ì€ ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ JavaScript ì½”ë“œë¡œ ì‹¤í–‰í•  ë•Œ ìƒì„±ë©ë‹ˆë‹¤.

Sinks:
```javascript
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### Document-domain manipulation

From: [https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

**Document-domain manipulation vulnerabilities**ëŠ” ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ê°€ `document.domain` ì†ì„±ì„ ì„¤ì •í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

`document.domain` ì†ì„±ì€ ë¸Œë¼ìš°ì €ì˜ **same-origin policy** **ê°•ì œ**ì— **ì¤‘ìš”í•œ ì—­í• **ì„ í•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ì˜ ë‘ í˜ì´ì§€ê°€ `document.domain`ì„ **ê°™ì€ ê°’**ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì œí•œ ì—†ì´ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ëŠ” `document.domain`ì— í• ë‹¹í•  ìˆ˜ ìˆëŠ” ê°’ì— ëŒ€í•´ íŠ¹ì • **ì œí•œ**ì„ ë‘ì§€ë§Œ, ì‹¤ì œ í˜ì´ì§€ ì¶œì²˜ì™€ ì™„ì „íˆ ê´€ë ¨ ì—†ëŠ” ê°’ì„ í• ë‹¹í•˜ëŠ” ê²ƒì€ ë°©ì§€í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ëŠ” **ìì‹** ë˜ëŠ” **ë¶€ëª¨ ë„ë©”ì¸**ì˜ ì‚¬ìš©ì„ í—ˆìš©í•©ë‹ˆë‹¤.

Sinks:
```javascript
document.domain
```
### WebSocket-URL poisoning

From: [https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

**WebSocket-URL poisoning**ëŠ” ìŠ¤í¬ë¦½íŠ¸ê°€ **ì œì–´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ WebSocket ì—°ê²°ì˜ ëŒ€ìƒ URLë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°** ë°œìƒí•©ë‹ˆë‹¤.

Sinks:

`WebSocket` ìƒì„±ìëŠ” WebSocket-URL poisoning ì·¨ì•½ì ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Link manipulation

From: [https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

**DOM ê¸°ë°˜ ë§í¬ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ í˜„ì¬ í˜ì´ì§€ ë‚´ì˜ íƒìƒ‰ ëŒ€ìƒ**ì— ê¸°ë¡í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë‚˜ ì–‘ì‹ì˜ ì œì¶œ URLì´ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### Ajax ìš”ì²­ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

**Ajax ìš”ì²­ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ `XmlHttpRequest` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°œí–‰ë˜ëŠ” Ajax ìš”ì²­ì— **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ê¸°ë¡í•  ë•Œ** ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

**ë¡œì»¬ íŒŒì¼ ê²½ë¡œ ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ íŒŒì¼ ì²˜ë¦¬ API**ì— `filename` ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ ê³µê²©ìê°€ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë°©ë¬¸í•  ê²½ìš° **ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ê°€ ì„ì˜ì˜ ë¡œì»¬ íŒŒì¼ì„ ì—´ê±°ë‚˜ ì‘ì„±í•˜ë„ë¡ ìœ ë„í•˜ëŠ” URLì„ êµ¬ì„±**í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì¸ì ì…˜

From: [https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

**í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì¸ì ì…˜ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šì€ ë°©ì‹ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ SQL ì¿¼ë¦¬ì— í¬í•¨í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤**.

Sinks:
```javascript
executeSql()
```
### HTML5-storage manipulation

From: [https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

**HTML5-storage manipulation ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì›¹ ë¸Œë¼ìš°ì €ì˜ HTML5 ì €ì¥ì†Œ**(`localStorage` ë˜ëŠ” `sessionStorage`)ì— ì €ì¥í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ì‘ì—… ìì²´ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ ë³´ì•ˆ ì·¨ì•½ì ì´ ì•„ë‹ˆì§€ë§Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´í›„ì— **ì €ì¥ëœ ë°ì´í„°ë¥¼ ì½ê³  ì•ˆì „í•˜ì§€ ì•Šê²Œ ì²˜ë¦¬í•  ê²½ìš°** ë¬¸ì œê°€ ë©ë‹ˆë‹¤. ì´ëŠ” ê³µê²©ìê°€ ì €ì¥ ë©”ì»¤ë‹ˆì¦˜ì„ í™œìš©í•˜ì—¬ êµì°¨ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ë° JavaScript ì£¼ì…ê³¼ ê°™ì€ ë‹¤ë¥¸ DOM ê¸°ë°˜ ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
sessionStorage.setItem()
localStorage.setItem()
```
### XPath ì£¼ì…

From: [https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

**DOM ê¸°ë°˜ XPath ì£¼ì… ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ XPath ì¿¼ë¦¬ì— í¬í•¨í•  ë•Œ** ë°œìƒí•©ë‹ˆë‹¤.

Sinks:
```javascript
document.evaluate()
someDOMElement.evaluate()
```
### í´ë¼ì´ì–¸íŠ¸ ì¸¡ JSON ì£¼ì…

From: [https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

**DOM ê¸°ë°˜ JSON ì£¼ì… ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ JSON ë°ì´í„° êµ¬ì¡°ë¡œ êµ¬ë¬¸ ë¶„ì„ë˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ ì²˜ë¦¬ë˜ëŠ” ë¬¸ìì—´ì— í¬í•¨í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤**.

Sinks:
```javascript
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### ì›¹ ë©”ì‹œì§€ ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

**ì›¹ ë©”ì‹œì§€ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ì›¹ ë©”ì‹œì§€ë¡œ ë‹¤ë¥¸ ë¬¸ì„œì— ì „ì†¡í•  ë•Œ** ë°œìƒí•©ë‹ˆë‹¤. ì·¨ì•½í•œ ì›¹ ë©”ì‹œì§€ ì¡°ì‘ì˜ **ì˜ˆ**ëŠ” [PortSwiggerì˜ ì›¹ ë³´ì•ˆ ì•„ì¹´ë°ë¯¸](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:

ì›¹ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•œ `postMessage()` ë©”ì„œë“œëŠ” ìˆ˜ì‹  ë©”ì‹œì§€ì— ëŒ€í•œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ìˆ˜ì‹  ë°ì´í„°ë¥¼ ì•ˆì „í•˜ì§€ ì•Šê²Œ ì²˜ë¦¬í•  ê²½ìš° ì·¨ì•½ì ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### DOM ë°ì´í„° ì¡°ì‘

From: [https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

**DOM ë°ì´í„° ì¡°ì‘ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **DOM ë‚´ì˜ í•„ë“œì— ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ê¸°ë¡í•  ë•Œ** ë°œìƒí•©ë‹ˆë‹¤. ì´ ë°ì´í„°ëŠ” ê°€ì‹œ UI ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë¡œì§ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì´ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë°©ë¬¸í•  ê²½ìš° í´ë¼ì´ì–¸íŠ¸ ì¸¡ UIì˜ ëª¨ì–‘ì´ë‚˜ ë™ì‘ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” URLì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### ì„œë¹„ìŠ¤ ê±°ë¶€

From: [https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

**DOM ê¸°ë°˜ ì„œë¹„ìŠ¤ ê±°ë¶€ ì·¨ì•½ì **ì€ ìŠ¤í¬ë¦½íŠ¸ê°€ **ê³µê²©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ë¬¸ì œì˜ í”Œë«í¼ APIì— ì•ˆì „í•˜ì§€ ì•Šê²Œ ì „ë‹¬í•  ë•Œ** ë°œìƒí•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” í˜¸ì¶œë  ë•Œ ì‚¬ìš©ìì˜ ì»´í“¨í„°ê°€ **ê³¼ë„í•œ CPU ë˜ëŠ” ë””ìŠ¤í¬ ê³µê°„**ì„ ì†Œë¹„í•˜ê²Œ í•  ìˆ˜ ìˆëŠ” APIê°€ í¬í•¨ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ì€ ë¸Œë¼ìš°ì €ê°€ `localStorage`ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ì‹œë„ë¥¼ ê±°ë¶€í•˜ê±°ë‚˜ ë°”ìœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¢…ë£Œí•¨ìœ¼ë¡œì¨ ì›¹ì‚¬ì´íŠ¸ì˜ ê¸°ëŠ¥ì„ ì œí•œí•˜ëŠ” ë“±ì˜ ì¤‘ëŒ€í•œ ë¶€ì‘ìš©ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Sinks:
```javascript
requestFileSystem()
RegExp()
```
## Dom Clobbering

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
