# SOME - Same Origin Method Execution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ëŠ” **ë‹¤í¬ ì›¹** ê¸°ë°˜ì˜ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, ê¸°ì—…ì´ë‚˜ ê³ ê°ì´ **stealer malwares**ì— ì˜í•´ **ì¹¨í•´**ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆëŠ” **ë¬´ë£Œ** ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ íƒˆì·¨ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì— ë§ì„œ ì‹¸ìš°ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•˜ê³  **ë¬´ë£Œ**ë¡œ ì—”ì§„ì„ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

***

## Same Origin Method Execution

í˜ì´ì§€ì—ì„œ ì œí•œëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, [**ì‹¤í–‰ë  ì½œë°± ê°’ì„ ì œì–´í•  ìˆ˜ ìˆëŠ” ê²½ìš°**](./#javascript-function)ì…ë‹ˆë‹¤.

ì´ëŸ° ê²½ìš°, í•  ìˆ˜ ìˆëŠ” ê°€ì¥ ì¢‹ì€ ì¼ ì¤‘ í•˜ë‚˜ëŠ” **DOMì— ì ‘ê·¼í•˜ì—¬** ê·¸ê³³ì—ì„œ ì°¾ì„ ìˆ˜ ìˆëŠ” ì–´ë–¤ **ë¯¼ê°í•œ ì‘ì—…ì„ í˜¸ì¶œí•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤ (ì˜ˆ: ë²„íŠ¼ í´ë¦­). ê·¸ëŸ¬ë‚˜ ì¼ë°˜ì ìœ¼ë¡œ ì´ ì·¨ì•½ì ì€ **DOMì— í¥ë¯¸ë¡œìš´ ê²ƒì´ ì—†ëŠ” ì‘ì€ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ë°œê²¬ë©ë‹ˆë‹¤**.

ì´ëŸ° ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì´ ê³µê²©ì€ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” **ê°™ì€ ë„ë©”ì¸ì˜ ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ DOM ë‚´ì˜ ì œí•œëœ JS ì‹¤í–‰ì„ ì•…ìš©í•  ìˆ˜ ìˆëŠ”** ê²ƒì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ ê³µê²© íë¦„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* **ì•…ìš©í•  ìˆ˜ ìˆëŠ” ì½œë°±ì„ ì°¾ìŠµë‹ˆë‹¤** (ì ì¬ì ìœ¼ë¡œ \[\w\\.\_]ë¡œ ì œí•œë¨).
* ì œí•œì´ ì—†ê³  ì–´ë–¤ JSë„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ë©´, ì¼ë°˜ XSSì²˜ëŸ¼ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **í”¼í•´ìê°€ ê³µê²©ìê°€ ì œì–´í•˜ëŠ” í˜ì´ì§€ë¥¼ ì—´ë„ë¡ ë§Œë“­ë‹ˆë‹¤.**
* **í˜ì´ì§€ê°€ ë‹¤ë¥¸ ì°½ì—ì„œ ì—´ë¦½ë‹ˆë‹¤** (ìƒˆ ì°½ì€ ì´ˆê¸° ì°½ì„ ì°¸ì¡°í•˜ëŠ” **`opener`** ê°ì²´ë¥¼ ê°€ì§‘ë‹ˆë‹¤).
* **ì´ˆê¸° í˜ì´ì§€**ëŠ” **í¥ë¯¸ë¡œìš´ DOM**ì´ ìœ„ì¹˜í•œ **í˜ì´ì§€**ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.
* **ë‘ ë²ˆì§¸ í˜ì´ì§€**ëŠ” **ì½œë°±ì„ ì•…ìš©í•˜ì—¬ ì·¨ì•½í•œ í˜ì´ì§€ë¥¼ ë¡œë“œí•˜ê³ ** **`opener`** ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì´ˆê¸° í˜ì´ì§€ì—ì„œ ì–´ë–¤ ì‘ì—…ì„ ì ‘ê·¼í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤** (ì´ì œ í¥ë¯¸ë¡œìš´ DOMì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤).

{% hint style="danger" %}
ì´ˆê¸° í˜ì´ì§€ê°€ ë‘ ë²ˆì§¸ í˜ì´ì§€ë¥¼ ìƒì„±í•œ í›„ ìƒˆ URLì— ì ‘ê·¼í•˜ë”ë¼ë„, **ë‘ ë²ˆì§¸ í˜ì´ì§€ì˜ `opener` ê°ì²´ëŠ” ì—¬ì „íˆ ìƒˆ DOMì—ì„œ ì²« ë²ˆì§¸ í˜ì´ì§€ì— ëŒ€í•œ ìœ íš¨í•œ ì°¸ì¡°ì…ë‹ˆë‹¤**.

ë˜í•œ, ë‘ ë²ˆì§¸ í˜ì´ì§€ê°€ opener ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë ¤ë©´ **ë‘ í˜ì´ì§€ ëª¨ë‘ ê°™ì€ ì¶œì²˜ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤**. ì´ê²ƒì´ ì´ ì·¨ì•½ì ì„ ì•…ìš©í•˜ê¸° ìœ„í•´ **ê°™ì€ ì¶œì²˜ì—ì„œ XSSë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤**.
{% endhint %}

### Exploitation

* ì´ ì–‘ì‹ì„ ì‚¬ìš©í•˜ì—¬ **ì´ ìœ í˜•ì˜ ì·¨ì•½ì ì„ ì•…ìš©í•˜ê¸° ìœ„í•œ PoCë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* í´ë¦­í•  HTML ìš”ì†Œì— ëŒ€í•œ DOM ê²½ë¡œë¥¼ ì°¾ê¸° ìœ„í•´ ì´ ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Example

* ì·¨ì•½í•œ ì˜ˆì œë¥¼ [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì´ ì˜ˆì œì—ì„œ ì„œë²„ëŠ” **ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ ìƒì„±í•˜ê³ ** ì´ë¥¼ **ì½œë°± ë§¤ê°œë³€ìˆ˜ì˜ ë‚´ìš©ì— ë”°ë¼** HTMLì— ì¶”ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤: `<script>opener.{callbacl_content}</script>` . ê·¸ë˜ì„œ ì´ ì˜ˆì œì—ì„œëŠ” `opener`ì˜ ì‚¬ìš©ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì‹œí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
* ì´ CTF ì‘ì„±ë¬¼ë„ í™•ì¸í•˜ì„¸ìš”: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## References

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
