# SOME - Same Origin Method Execution

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Same Origin Method Execution

Bir sayfada sÄ±nÄ±rlÄ± javascript Ã§alÄ±ÅŸtÄ±rabileceÄŸiniz durumlar olacaktÄ±r. Ã–rneÄŸin, [**Ã§alÄ±ÅŸtÄ±rÄ±lacak bir geri Ã§aÄŸÄ±rma deÄŸerini kontrol edebildiÄŸiniz**](./#javascript-function) durumlarda.

Bu durumlarda yapabileceÄŸiniz en iyi ÅŸeylerden biri, **orada bulabileceÄŸiniz herhangi bir** hassas eylemi Ã§aÄŸÄ±rmak iÃ§in **DOM'a eriÅŸmek** olacaktÄ±r (Ã¶rneÄŸin bir dÃ¼ÄŸmeye tÄ±klamak). Ancak, genellikle bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± **DOM'da ilginÃ§ bir ÅŸey olmayan kÃ¼Ã§Ã¼k uÃ§ noktalar** iÃ§inde bulacaksÄ±nÄ±z.

Bu senaryolarda, bu saldÄ±rÄ± Ã§ok faydalÄ± olacaktÄ±r, Ã§Ã¼nkÃ¼ amacÄ±, **aynÄ± alan adÄ±ndan farklÄ± bir sayfa iÃ§indeki sÄ±nÄ±rlÄ± JS yÃ¼rÃ¼tmesini kÃ¶tÃ¼ye kullanabilmek** ve daha ilginÃ§ eylemler gerÃ§ekleÅŸtirmektir.

Temelde, saldÄ±rÄ± akÄ±ÅŸÄ± ÅŸu ÅŸekildedir:

* **KÃ¶tÃ¼ye kullanabileceÄŸiniz bir geri Ã§aÄŸÄ±rma bulun** (potansiyel olarak \[\w\\.\_] ile sÄ±nÄ±rlÄ±).
* EÄŸer sÄ±nÄ±rlÄ± deÄŸilse ve herhangi bir JS Ã§alÄ±ÅŸtÄ±rabiliyorsanÄ±z, bunu normal bir XSS olarak kÃ¶tÃ¼ye kullanabilirsiniz.
* **KurbanÄ±,** **saldÄ±rgan** tarafÄ±ndan kontrol edilen bir **sayfayÄ± aÃ§maya** zorlayÄ±n.
* **Sayfa kendini** **farklÄ± bir pencerede** aÃ§acaktÄ±r (yeni pencere, baÅŸlangÄ±Ã§taki nesne **`opener`** ile referans alacaktÄ±r).
* **BaÅŸlangÄ±Ã§ sayfasÄ±**, **ilginÃ§ DOM'un** bulunduÄŸu **sayfayÄ±** yÃ¼kleyecektir.
* **Ä°kinci sayfa**, **geri Ã§aÄŸÄ±rmayÄ± kÃ¶tÃ¼ye kullanarak** **savunmasÄ±z sayfayÄ±** yÃ¼kleyecek ve **`opener`** nesnesini kullanarak **baÅŸlangÄ±Ã§ sayfasÄ±nda bazÄ± eylemleri eriÅŸip Ã§alÄ±ÅŸtÄ±racaktÄ±r** (artÄ±k ilginÃ§ DOM'u iÃ§ermektedir).

{% hint style="danger" %}
BaÅŸlangÄ±Ã§ sayfasÄ±, ikinci sayfayÄ± oluÅŸturduktan sonra yeni bir URL'ye eriÅŸse bile, **ikinci sayfanÄ±n `opener` nesnesi, yeni DOM'daki ilk sayfaya geÃ§erli bir referans olmaya devam eder**.

AyrÄ±ca, ikinci sayfanÄ±n opener nesnesini kullanabilmesi iÃ§in **her iki sayfanÄ±n da aynÄ± kÃ¶kene sahip olmasÄ± gerekir**. Bu, bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± kÃ¶tÃ¼ye kullanmak iÃ§in bazÄ± tÃ¼rde **aynÄ± kÃ¶ken iÃ§inde XSS bulmanÄ±z gerektiÄŸi** anlamÄ±na gelir.
{% endhint %}

### Exploitation

* Bu formu kullanarak bu tÃ¼r bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± istismar etmek iÃ§in **bir PoC oluÅŸturabilirsiniz**: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML Ã¶ÄŸesine tÄ±klayarak bir DOM yolu bulmak iÃ§in bu tarayÄ±cÄ± uzantÄ±sÄ±nÄ± kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Ã–rnek

* SavunmasÄ±z bir Ã¶rneÄŸi [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde bulabilirsiniz.
* Bu Ã¶rnekte sunucunun **javascript kodu Ã¼rettiÄŸini** ve **geri Ã§aÄŸÄ±rma parametresinin iÃ§eriÄŸine gÃ¶re** HTML'ye eklediÄŸini unutmayÄ±n: `<script>opener.{callbacl_content}</script>` . Bu nedenle bu Ã¶rnekte `opener` kullanÄ±mÄ±nÄ± aÃ§Ä±kÃ§a belirtmenize gerek yoktur.
* AyrÄ±ca bu CTF yazÄ±sÄ±nÄ± kontrol edin: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
