# SOME - Same Origin Method Execution

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) **karanlÄ±k aÄŸ** destekli bir arama motorudur ve bir ÅŸirketin veya mÃ¼ÅŸterilerinin **zarar gÃ¶rÃ¼p gÃ¶rmediÄŸini** kontrol etmek iÃ§in **Ã¼cretsiz** iÅŸlevler sunar.

WhiteIntel'in ana hedefi, bilgi Ã§alan kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlardan kaynaklanan hesap ele geÃ§irmeleri ve fidye yazÄ±lÄ±mÄ± saldÄ±rÄ±larÄ±yla mÃ¼cadele etmektir.

Web sitelerini kontrol edebilir ve motorlarÄ±nÄ± **Ã¼cretsiz** deneyebilirsiniz:

{% embed url="https://whiteintel.io" %}

***

## Same Origin Method Execution

Bir sayfada sÄ±nÄ±rlÄ± javascript Ã§alÄ±ÅŸtÄ±rabileceÄŸiniz durumlar olacaktÄ±r. Ã–rneÄŸin, [**Ã§alÄ±ÅŸtÄ±rÄ±lacak bir geri Ã§aÄŸÄ±rma deÄŸerini kontrol edebildiÄŸiniz**](./#javascript-function) durumlarda.

Bu durumlarda yapabileceÄŸiniz en iyi ÅŸey, **orada bulabileceÄŸiniz** hassas bir eylemi Ã§aÄŸÄ±rmak iÃ§in **DOM'a eriÅŸmek** olacaktÄ±r (Ã¶rneÄŸin bir dÃ¼ÄŸmeye tÄ±klamak). Ancak genellikle bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± **ilginÃ§ bir ÅŸey olmayan kÃ¼Ã§Ã¼k uÃ§ noktalar** iÃ§inde bulacaksÄ±nÄ±z.

Bu senaryolarda, bu saldÄ±rÄ± Ã§ok faydalÄ± olacaktÄ±r, Ã§Ã¼nkÃ¼ amacÄ±, **aynÄ± alan adÄ±ndan farklÄ± bir sayfa iÃ§indeki sÄ±nÄ±rlÄ± JS yÃ¼rÃ¼tmesini kÃ¶tÃ¼ye kullanabilmektir** ve daha ilginÃ§ eylemler gerÃ§ekleÅŸtirmektir.

Temelde, saldÄ±rÄ± akÄ±ÅŸÄ± ÅŸu ÅŸekildedir:

* **kÃ¶tÃ¼ye kullanabileceÄŸiniz bir geri Ã§aÄŸÄ±rma bulun** (potansiyel olarak \[\w\\.\_] ile sÄ±nÄ±rlÄ±).
* EÄŸer sÄ±nÄ±rlÄ± deÄŸilse ve herhangi bir JS Ã§alÄ±ÅŸtÄ±rabiliyorsanÄ±z, bunu normal bir XSS olarak kÃ¶tÃ¼ye kullanabilirsiniz.
* **kurbanÄ± bir sayfa aÃ§maya zorlayÄ±n** **saldÄ±rgan** tarafÄ±ndan kontrol edilen.
* **sayfa kendisini** **farklÄ± bir pencerede** aÃ§acaktÄ±r (yeni pencere, baÅŸlangÄ±Ã§taki nesne **`opener`** ile referans alacaktÄ±r).
* **ilk sayfa**, **ilginÃ§ DOM**'un bulunduÄŸu **sayfayÄ±** yÃ¼kleyecektir.
* **ikinci sayfa**, **geri Ã§aÄŸÄ±rmayÄ± kÃ¶tÃ¼ye kullanarak** **kÄ±rÄ±lgan sayfayÄ±** yÃ¼kleyecek ve **ilk sayfadaki** bazÄ± eylemleri **eriÅŸmek ve yÃ¼rÃ¼tmek iÃ§in `opener` nesnesini** kullanacaktÄ±r (artÄ±k ilginÃ§ DOM'u iÃ§ermektedir).

{% hint style="danger" %}
Ä°lk sayfa, ikinci sayfayÄ± oluÅŸturduktan sonra yeni bir URL'ye eriÅŸse bile, **ikinci sayfanÄ±n `opener` nesnesi, yeni DOM'daki ilk sayfaya hala geÃ§erli bir referanstÄ±r**.

AyrÄ±ca, ikinci sayfanÄ±n opener nesnesini kullanabilmesi iÃ§in **her iki sayfanÄ±n da aynÄ± kÃ¶kene sahip olmasÄ± gerekir**. Bu, bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± kÃ¶tÃ¼ye kullanmak iÃ§in bazÄ± tÃ¼rde bir **aynÄ± kÃ¶ken XSS** bulmanÄ±z gerektiÄŸi anlamÄ±na gelir.
{% endhint %}

### Exploitation

* Bu tÃ¼r bir gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± istismar etmek iÃ§in **bir PoC oluÅŸturmak** iÃ§in bu formu kullanabilirsiniz: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML Ã¶ÄŸesine tÄ±klamak iÃ§in bir DOM yolu bulmak Ã¼zere bu tarayÄ±cÄ± uzantÄ±sÄ±nÄ± kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Ã–rnek

* KÄ±rÄ±lgan bir Ã¶rneÄŸi [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde bulabilirsiniz.
* Bu Ã¶rnekte sunucunun **javascript kodu Ã¼rettiÄŸini** ve **geri Ã§aÄŸÄ±rma parametresinin iÃ§eriÄŸine** dayanarak HTML'ye **eklediÄŸini** unutmayÄ±n: `<script>opener.{callbacl_content}</script>` . Bu nedenle bu Ã¶rnekte `opener` kullanÄ±mÄ±nÄ± aÃ§Ä±kÃ§a belirtmenize gerek yoktur.
* AyrÄ±ca bu CTF yazÄ±mÄ±nÄ± kontrol edin: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
