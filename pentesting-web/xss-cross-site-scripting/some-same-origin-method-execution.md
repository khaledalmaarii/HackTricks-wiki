# SOME - Wykonanie metody o tej samej domenie

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Czy pracujesz w **firmie z branÅ¼y cyberbezpieczeÅ„stwa**? Chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… na HackTricks**? lub chcesz uzyskaÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**repozytorium hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**repozytorium hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) to wyszukiwarka zasilana przez **dark web**, ktÃ³ra oferuje **darmowe** funkcje do sprawdzania, czy firma lub jej klienci zostali **skompromitowani** przez **zÅ‚oÅ›liwe oprogramowanie kradnÄ…ce dane**.

Ich gÅ‚Ã³wnym celem jest zwalczanie przejÄ™Ä‡ kont i atakÃ³w ransomware wynikajÄ…cych z zÅ‚oÅ›liwego oprogramowania kradnÄ…cego informacje.

MoÅ¼esz sprawdziÄ‡ ich stronÄ™ internetowÄ… i wyprÃ³bowaÄ‡ ich silnik za **darmo** pod adresem:

{% embed url="https://whiteintel.io" %}

---

## Wykonanie metody o tej samej domenie

ZdarzÄ… siÄ™ sytuacje, w ktÃ³rych moÅ¼esz wykonaÄ‡ pewien ograniczony kod JavaScript na stronie. Na przykÅ‚ad, gdy moÅ¼esz [**kontrolowaÄ‡ wartoÅ›Ä‡ wywoÅ‚ania zwrotnego, ktÃ³ra zostanie wykonana**](./#javascript-function).

W takich przypadkach jednÄ… z najlepszych rzeczy, ktÃ³re moÅ¼esz zrobiÄ‡, jest **uzyskanie dostÄ™pu do DOM, aby wywoÅ‚aÄ‡ dowolnÄ…** wraÅ¼liwÄ… akcjÄ™, ktÃ³rÄ… znajdziesz tam (np. klikniÄ™cie przycisku). Jednak zazwyczaj tÄ™ podatnoÅ›Ä‡ znajdziesz w **maÅ‚ych punktach koÅ„cowych bez Å¼adnych interesujÄ…cych rzeczy w DOM**.

W takich scenariuszach ten atak bÄ™dzie bardzo przydatny, poniewaÅ¼ jego celem jest **wykorzystanie ograniczonego wykonania JS wewnÄ…trz DOM z innej strony tej samej domeny** z duÅ¼Ä… liczbÄ… interesujÄ…cych dziaÅ‚aÅ„.

W zasadzie, przepÅ‚yw ataku wyglÄ…da nastÄ™pujÄ…co:

* ZnajdÅº **zwrotkÄ™, ktÃ³rÄ… moÅ¼esz wykorzystaÄ‡** (potencjalnie ograniczonÄ… do \[\w\\.\_]).
* JeÅ›li nie jest ograniczona i moÅ¼esz wykonaÄ‡ dowolny JS, moÅ¼esz po prostu wykorzystaÄ‡ to jak zwykÅ‚e XSS
* Spowoduj, Å¼e **ofiara otworzy stronÄ™** kontrolowanÄ… przez **atakujÄ…cego**
* **Strona otworzy siÄ™** w **innym oknie** (nowe okno bÄ™dzie miaÅ‚o obiekt **`opener`** odnoszÄ…cy siÄ™ do poczÄ…tkowego)
* **PoczÄ…tkowa strona** zaÅ‚aduje **stronÄ™**, na ktÃ³rej znajduje siÄ™ **interesujÄ…cy DOM**.
* **Druga strona** zaÅ‚aduje **podatnÄ… stronÄ™, wykorzystujÄ…c zwrotkÄ™** i korzystajÄ…c z obiektu **`opener`** do **uzyskania dostÄ™pu i wykonania pewnej akcji w poczÄ…tkowej stronie** (ktÃ³ra teraz zawiera interesujÄ…cy DOM).

{% hint style="danger" %}
ZauwaÅ¼, Å¼e nawet jeÅ›li poczÄ…tkowa strona uzyska dostÄ™p do nowego adresu URL po utworzeniu drugiej strony, **obiekt `opener` drugiej strony nadal jest waÅ¼nym odwoÅ‚aniem do pierwszej strony w nowym DOM**.

Co wiÄ™cej, aby druga strona mogÅ‚a uÅ¼yÄ‡ obiektu opener, **obie strony muszÄ… byÄ‡ w tej samej domenie**. To dlatego, aby wykorzystaÄ‡ tÄ™ podatnoÅ›Ä‡, musisz znaleÅºÄ‡ pewnego rodzaju **XSS w tej samej domenie**.
{% endhint %}

### Wykorzystanie

* MoÅ¼esz skorzystaÄ‡ z tego formularza, aby **wygenerowaÄ‡ PoC** do wykorzystania tego rodzaju podatnoÅ›ci: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Aby znaleÅºÄ‡ Å›cieÅ¼kÄ™ DOM do elementu HTML z klikniÄ™ciem, moÅ¼esz skorzystaÄ‡ z tego rozszerzenia przeglÄ…darki: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### PrzykÅ‚ad

* MoÅ¼esz znaleÅºÄ‡ podatny przykÅ‚ad pod adresem [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* ZauwaÅ¼, Å¼e w tym przykÅ‚adzie serwer **generuje kod JavaScript** i **dodaje** go do HTML na podstawie **zawartoÅ›ci parametru zwrotki:** `<script>opener.{callbacl_content}</script>` . Dlatego w tym przykÅ‚adzie nie trzeba wskazywaÄ‡ uÅ¼ycia `opener` explicite.
* SprawdÅº rÃ³wnieÅ¼ ten opis CTF: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## OdnoÅ›niki

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)
