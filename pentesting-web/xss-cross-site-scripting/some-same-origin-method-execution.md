# SOME - Izvr코avanje metoda sa istog izvora

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Radite li u **kompaniji za kiberneti캜ku bezbednost**? 콯elite li da vidite svoju **kompaniju reklamiranu na HackTricks-u**? Ili 쬰lite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru쬴te se** [**游눫**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** 游냕[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Izvr코avanje metoda sa istog izvora

Postoja캖e situacije u kojima mo쬰te izvr코iti neki ograni캜eni JavaScript na stranici. Na primer, u slu캜aju kada mo쬰te **kontrolisati povratnu vrednost koja 캖e biti izvr코ena**.

U tim slu캜ajevima, jedna od najboljih stvari koje mo쬰te uraditi je **pristup DOM-u da biste pozvali bilo koju** osetljivu akciju koju mo쬰te prona캖i tamo (kao 코to je klik na dugme). Me캠utim, obi캜no 캖ete ovu ranjivost prona캖i na **malim krajnjim ta캜kama bez ikakvih interesantnih stvari u DOM-u**.

U tim scenarijima, ovaj napad 캖e biti veoma koristan, jer je njegov cilj da **zloupotrebite ograni캜eno izvr코avanje JS-a unutar DOM-a sa druge stranice sa istog domena** sa mnogo interesantnih akcija.

Osnovni tok napada je slede캖i:

* Prona캠ite **povratnu vrednost koju mo쬰te zloupotrebiti** (potencijalno ograni캜enu na \[\w\\.\_]).
* Ako nije ograni캜eno i mo쬰te izvr코iti bilo koji JS, jednostavno mo쬰te zloupotrebiti ovo kao redovni XSS.
* Naterajte **rtvu da otvori stranicu** kojom **upravlja napada캜**.
* **Stranica 캖e se otvoriti sama** u **novom prozoru** (novi prozor 캖e imati objekat **`opener`** koji se odnosi na po캜etni prozor).
* **Po캜etna stranica** 캖e u캜itati **stranicu** gde se nalazi **interesantan DOM**.
* **Druga stranica** 캖e u캜itati **ranjivu stranicu zloupotrebljavaju캖i povratnu vrednost** i koriste캖i objekat **`opener`** da **pristupi i izvr코i neku akciju na po캜etnoj stranici** (koja sada sadr쬴 interesantan DOM).

{% hint style="danger" %}
Imajte na umu da 캜ak i ako po캜etna stranica pristupi novom URL-u nakon 코to je kreirala drugu stranicu, **`opener` objekat druge stranice i dalje je validna referenca na prvu stranicu u novom DOM-u**.

Osim toga, da bi druga stranica mogla koristiti opener objekat, **obe stranice moraju biti na istom izvoru**. To je razlog za코to, da biste zloupotrebili ovu ranjivost, morate prona캖i neku vrstu **XSS-a sa istog izvora**.
{% endhint %}

### Eksploatacija

* Mo쬰te koristiti ovaj obrazac da **generi코ete PoC** za iskori코캖avanje ovog tipa ranjivosti: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Da biste prona코li put do HTML elementa sa klikom, mo쬰te koristiti ovaj dodatak za pregleda캜: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Primer

* Mo쬰te prona캖i ranjiv primer na [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Imajte na umu da u ovom primeru server **generi코e JavaScript kod** i **dodaje** ga u HTML na osnovu **sadr쬬ja parametra povratnog poziva:** `<script>opener.{callbacl_content}</script>`. Zato u ovom primeru ne morate eksplicitno navesti upotrebu `opener`-a.
* Tako캠e proverite ovaj CTF writeup: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Reference

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Radite li u **kompaniji za kiberneti캜ku bezbednost**? 콯elite li da vidite svoju **kompaniju reklamiranu na HackTricks-u**? Ili 쬰lite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru쬴te se** [**游눫**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** 游냕[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
