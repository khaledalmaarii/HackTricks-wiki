# SOME - Same Origin Method Execution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ã¯ã€**ãƒ€ãƒ¼ã‚¯ã‚¦ã‚§ãƒ–**ã‚’åˆ©ç”¨ã—ãŸæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã§ã€ä¼æ¥­ã‚„ãã®é¡§å®¢ãŒ**ãƒãƒ«ã‚¦ã‚§ã‚¢ã«ã‚ˆã£ã¦ä¾µå®³ã•ã‚ŒãŸ**ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®**ç„¡æ–™**æ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

WhiteIntelã®ä¸»ãªç›®æ¨™ã¯ã€æƒ…å ±ã‚’ç›—ã‚€ãƒãƒ«ã‚¦ã‚§ã‚¢ã«ã‚ˆã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¹—ã£å–ã‚Šã‚„ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢æ”»æ’ƒã«å¯¾æŠ—ã™ã‚‹ã“ã¨ã§ã™ã€‚

å½¼ã‚‰ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚’ç¢ºèªã—ã€**ç„¡æ–™**ã§ã‚¨ãƒ³ã‚¸ãƒ³ã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™:

{% embed url="https://whiteintel.io" %}

***

## Same Origin Method Execution

ãƒšãƒ¼ã‚¸å†…ã§åˆ¶é™ã•ã‚ŒãŸJavaScriptã‚’å®Ÿè¡Œã§ãã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€[ **å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ã‚’åˆ¶å¾¡ã§ãã‚‹**](./#javascript-function)å ´åˆã§ã™ã€‚

ãã®å ´åˆã€æœ€ã‚‚è‰¯ã„ã“ã¨ã®ä¸€ã¤ã¯ã€**DOMã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€ãã“ã«è¦‹ã¤ã‘ãŸä»»æ„ã®**æ©Ÿå¯†ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã™ï¼ˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ãªã©ï¼‰ã€‚ã—ã‹ã—ã€é€šå¸¸ã€ã“ã®è„†å¼±æ€§ã¯**DOMã«èˆˆå‘³æ·±ã„ã‚‚ã®ãŒãªã„å°ã•ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**ã§è¦‹ã¤ã‹ã‚Šã¾ã™ã€‚

ãã®ã‚ˆã†ãªã‚·ãƒŠãƒªã‚ªã§ã¯ã€ã“ã®æ”»æ’ƒã¯éå¸¸ã«æœ‰ç”¨ã§ã™ã€‚ãªãœãªã‚‰ã€ãã®ç›®çš„ã¯ã€**åŒã˜ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç•°ãªã‚‹ãƒšãƒ¼ã‚¸å†…ã®DOMå†…ã§ã®åˆ¶é™ã•ã‚ŒãŸJSå®Ÿè¡Œã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨**ã ã‹ã‚‰ã§ã™ã€‚

åŸºæœ¬çš„ãªæ”»æ’ƒã®æµã‚Œã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

* **æ‚ªç”¨ã§ãã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã‚‹**ï¼ˆ\[\w\\.\_]ã«åˆ¶é™ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
* åˆ¶é™ãŒãªãã€ä»»æ„ã®JSã‚’å®Ÿè¡Œã§ãã‚‹å ´åˆã¯ã€é€šå¸¸ã®XSSã¨ã—ã¦ã“ã‚Œã‚’æ‚ªç”¨ã§ãã¾ã™ã€‚
* **è¢«å®³è€…ã«æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ãƒšãƒ¼ã‚¸ã‚’é–‹ã‹ã›ã‚‹**ã€‚
* **ãƒšãƒ¼ã‚¸ã¯åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è‡ªåˆ†è‡ªèº«ã‚’é–‹ãã¾ã™**ï¼ˆæ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¯ã€æœ€åˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’å‚ç…§ã™ã‚‹**`opener`**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒã¡ã¾ã™ï¼‰ã€‚
* **æœ€åˆã®ãƒšãƒ¼ã‚¸**ã¯ã€**èˆˆå‘³æ·±ã„DOM**ãŒã‚ã‚‹**ãƒšãƒ¼ã‚¸**ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
* **äºŒç•ªç›®ã®ãƒšãƒ¼ã‚¸**ã¯ã€**ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’æ‚ªç”¨ã—ã¦è„†å¼±ãªãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿**ã€**`opener`**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã—ã¦**æœ€åˆã®ãƒšãƒ¼ã‚¸ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™**ï¼ˆä»Šã‚„èˆˆå‘³æ·±ã„DOMã‚’å«ã‚“ã§ã„ã¾ã™ï¼‰ã€‚

{% hint style="danger" %}
æœ€åˆã®ãƒšãƒ¼ã‚¸ãŒäºŒç•ªç›®ã®ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ãŸå¾Œã«æ–°ã—ã„URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚ã€**äºŒç•ªç›®ã®ãƒšãƒ¼ã‚¸ã®`opener`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æ–°ã—ã„DOMå†…ã®æœ€åˆã®ãƒšãƒ¼ã‚¸ã¸ã®æœ‰åŠ¹ãªå‚ç…§ã®ã¾ã¾ã§ã™**ã€‚

ã•ã‚‰ã«ã€äºŒç•ªç›®ã®ãƒšãƒ¼ã‚¸ãŒopenerã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã§ãã‚‹ãŸã‚ã«ã¯ã€**ä¸¡æ–¹ã®ãƒšãƒ¼ã‚¸ãŒåŒã˜ã‚ªãƒªã‚¸ãƒ³ã«å­˜åœ¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚ã“ã‚ŒãŒã€ã“ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ã€åŒã˜ã‚ªãƒªã‚¸ãƒ³å†…ã§ä½•ã‚‰ã‹ã®**XSSã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ç†ç”±ã§ã™ã€‚
{% endhint %}

### Exploitation

* ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ã€ã“ã®ã‚¿ã‚¤ãƒ—ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã®**PoCã‚’ç”Ÿæˆ**ã§ãã¾ã™: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹HTMLè¦ç´ ã¸ã®DOMãƒ‘ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã€ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ãã¾ã™: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Example

* è„†å¼±ãªä¾‹ã¯[https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* ã“ã®ä¾‹ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ãŒ**JavaScriptã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—**ã€**ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å†…å®¹ã«åŸºã¥ã„ã¦**ãã‚Œã‚’HTMLã«**è¿½åŠ **ã—ã¦ã„ã¾ã™: `<script>opener.{callbacl_content}</script>`ã€‚ãã®ãŸã‚ã€ã“ã®ä¾‹ã§ã¯`opener`ã®ä½¿ç”¨ã‚’æ˜ç¤ºçš„ã«ç¤ºã™å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
* ã¾ãŸã€ã“ã®CTFã®è§£èª¬ã‚‚ç¢ºèªã—ã¦ãã ã•ã„: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## References

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
