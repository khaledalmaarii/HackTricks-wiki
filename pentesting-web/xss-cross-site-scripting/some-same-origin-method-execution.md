# SOME - IzvrÅ¡enje metoda iste domene

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **nas pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) je **pretraÅ¾ivaÄ** pokretan **dark-webom** koji nudi **besplatne** funkcionalnosti za proveru da li je neka kompanija ili njeni klijenti **kompromitovani** od strane **malvera za kraÄ‘u podataka**.

Njihov primarni cilj je da se bore protiv preuzimanja naloga i ransomware napada koji proizlaze iz malvera za kraÄ‘u informacija.

MoÅ¾ete proveriti njihovu veb stranicu i isprobati njihov pretraÅ¾ivaÄ **besplatno** na:

{% embed url="https://whiteintel.io" %}

***

## IzvrÅ¡enje metoda iste domene

BiÄ‡e prilika kada moÅ¾ete izvrÅ¡iti neki ograniÄeni javascript na stranici. Na primer, u sluÄaju kada moÅ¾ete[ **kontrolisati vrednost povratnog poziva koja Ä‡e biti izvrÅ¡ena**](./#javascript-function).

U tim sluÄajevima, jedna od najboljih stvari koje moÅ¾ete uÄiniti je da **pristupite DOM-u kako biste pozvali bilo koju** osetljivu akciju koju moÅ¾ete pronaÄ‡i (poput klika na dugme). MeÄ‘utim, obiÄno Ä‡ete ovu ranjivost pronaÄ‡i u **malim krajnjim taÄkama bez ikakvih zanimljivih stvari u DOM-u**.

U tim scenarijima, ovaj napad Ä‡e biti veoma koristan, jer je njegov cilj da bude u moguÄ‡nosti da **zloupotrebi ograniÄeno izvrÅ¡avanje JS unutar DOM-a sa razliÄite stranice iz iste domene** sa mnogo zanimljivim akcijama.

U osnovi, tok napada je sledeÄ‡i:

* PronaÄ‘ite **povratni poziv koji moÅ¾ete zloupotrebiti** (potencijalno ograniÄen na \[\w\\.\_]).
* Ako nije ograniÄen i moÅ¾ete izvrÅ¡iti bilo koji JS, mogli biste to zloupotrebiti kao redovni XSS
* Naterajte **Å¾rtvu da otvori stranicu** koju kontroliÅ¡e **napadaÄ**
* **Stranica Ä‡e se otvoriti** u **drugom prozoru** (novi prozor Ä‡e imati objekat **`opener`** koji referencira inicijalni)
* **Inicijalna stranica** Ä‡e uÄitati **stranicu** gde se nalazi **zanimljivi DOM**.
* **Druga stranica** Ä‡e uÄitati **ranjivu stranicu zloupotrebljavajuÄ‡i povratni poziv** i koristeÄ‡i objekat **`opener`** da **pristupi i izvrÅ¡i neku akciju na inicijalnoj stranici** (koja sada sadrÅ¾i zanimljivi DOM).

{% hint style="danger" %}
Imajte na umu da Äak i ako inicijalna stranica pristupi novoj URL adresi nakon Å¡to je kreirala drugu stranicu, **`opener` objekat druge stranice je i dalje vaÅ¾eÄ‡a referenca na prvu stranicu u novom DOM-u**.

Å taviÅ¡e, da bi druga stranica mogla da koristi objekat opener, **obe stranice moraju biti iz iste domene**. To je razlog zaÅ¡to, da biste zloupotrebili ovu ranjivost, morate pronaÄ‡i neku vrstu **XSS u istoj domeni**.
{% endhint %}

### Eksploatacija

* MoÅ¾ete koristiti ovaj oblik da **generiÅ¡ete PoC** za eksploataciju ove vrste ranjivosti: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Da biste pronaÅ¡li DOM putanju do HTML elementa sa klikom, moÅ¾ete koristiti ovu ekstenziju za pretraÅ¾ivaÄ: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Primer

* MoÅ¾ete pronaÄ‡i ranjivi primer na [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Imajte na umu da server u ovom primeru **generiÅ¡e javascript kod** i **dodaje** ga u HTML na osnovu **sadrÅ¾aja parametra povratnog poziva:** `<script>opener.{callbacl_content}</script>` . Zato u ovom primeru ne morate eksplicitno navesti koriÅ¡Ä‡enje `opener`.
* TakoÄ‘e proverite ovaj CTF izveÅ¡taj: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Reference

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **nas pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
