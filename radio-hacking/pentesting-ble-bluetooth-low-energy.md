{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Uvod

Dostupan od Bluetooth 4.0 specifikacije, BLE koristi samo 40 kanala, pokrivajuÄ‡i opseg od 2400 do 2483.5 MHz. Nasuprot tome, tradicionalni Bluetooth koristi 79 kanala u istom opsegu.

BLE ureÄ‘aji komuniciraju slanjem **oglasnih paketa** (**beacon-a**), ovi paketi emitiraju postojanje BLE ureÄ‘aja drugim obliÅ¾njim ureÄ‘ajima. Ovi beacon-i ponekad takoÄ‘e **Å¡alju podatke**.

UreÄ‘aj koji sluÅ¡a, takoÄ‘e nazvan centralni ureÄ‘aj, moÅ¾e odgovoriti na oglasni paket sa **SCAN zahtevom** poslatim posebno oglasnom ureÄ‘aju. **Odgovor** na taj sken koristi istu strukturu kao i **oglasni** paket sa dodatnim informacijama koje nisu mogle stati u inicijalni oglasni zahtev, kao Å¡to je puno ime ureÄ‘aja.

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

Bajt preambule sinhronizuje frekvenciju, dok je Äetvorobajtna adresa pristupa **identifikator veze**, koji se koristi u scenarijima gde viÅ¡e ureÄ‘aja pokuÅ¡ava da uspostavi veze na istim kanalima. SledeÄ‡e, Protokol Jedinica Podataka (**PDU**) sadrÅ¾i **oglasne podatke**. Postoji nekoliko tipova PDU; najÄeÅ¡Ä‡e koriÅ¡Ä‡eni su ADV\_NONCONN\_IND i ADV\_IND. UreÄ‘aji koriste tip PDU **ADV\_NONCONN\_IND** ako **ne prihvataju veze**, prenoseÄ‡i podatke samo u oglasnom paketu. UreÄ‘aji koriste **ADV\_IND** ako **dozvoljavaju veze** i **prestaju da Å¡alju oglasne** pakete kada je **veza** **uspostavljena**.

## GATT

**GeneriÄki atributni profil** (GATT) definiÅ¡e kako **ureÄ‘aj treba da formatira i prenosi podatke**. Kada analizirate povrÅ¡inu napada BLE ureÄ‘aja, Äesto Ä‡ete usmeriti svoju paÅ¾nju na GATT (ili GATT-ove), jer je to naÄin na koji se **funkcionalnost ureÄ‘aja aktivira** i kako se podaci Äuvaju, grupiÅ¡u i modifikuju. GATT navodi karakteristike, deskriptore i usluge ureÄ‘aja u tabeli kao 16- ili 32-bitne vrednosti. **Karakteristika** je **vrednost podataka** **poslata** izmeÄ‘u centralnog ureÄ‘aja i perifernog. Ove karakteristike mogu imati **deskriptore** koji **pruÅ¾aju dodatne informacije o njima**. **Karakteristike** se Äesto **grupiÅ¡u** u **usluge** ako su povezane sa izvrÅ¡avanjem odreÄ‘ene radnje.

# Enumeracija
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** omoguÄ‡ava **uspostavljanje** **veze** sa drugim ureÄ‘ajem, prikazujuÄ‡i **karakteristike** tog ureÄ‘aja, kao i Äitanje i pisanje njegovih atributa.\
GATTTool moÅ¾e pokrenuti interaktivnu ljusku sa `-I` opcijom:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
