<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘[hacktricks repo](https://github.com/carlospolop/hacktricks)å’Œ[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


# ä»‹ç»

è‡ªè“ç‰™4.0è§„èŒƒä»¥æ¥ï¼ŒBLEä»…ä½¿ç”¨40ä¸ªä¿¡é“ï¼Œè¦†ç›–2400è‡³2483.5 MHzçš„èŒƒå›´ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿè“ç‰™åœ¨ç›¸åŒèŒƒå›´å†…ä½¿ç”¨79ä¸ªä¿¡é“ã€‚

BLEè®¾å¤‡é€šè¿‡å‘é€**å¹¿å‘Šæ•°æ®åŒ…**ï¼ˆ**ä¿¡æ ‡**ï¼‰è¿›è¡Œé€šä¿¡ï¼Œè¿™äº›æ•°æ®åŒ…å‘å…¶ä»–é™„è¿‘è®¾å¤‡å¹¿æ’­BLEè®¾å¤‡çš„å­˜åœ¨ã€‚è¿™äº›ä¿¡æ ‡æœ‰æ—¶ä¹Ÿä¼š**å‘é€æ•°æ®**ã€‚

ç›‘å¬è®¾å¤‡ï¼Œä¹Ÿç§°ä¸ºä¸­å¿ƒè®¾å¤‡ï¼Œå¯ä»¥é€šè¿‡ä¸“é—¨å‘é€ç»™å¹¿å‘Šè®¾å¤‡çš„**æ‰«æè¯·æ±‚**æ¥å“åº”å¹¿å‘Šæ•°æ®åŒ…ã€‚å¯¹è¯¥æ‰«æçš„**å“åº”**ä½¿ç”¨ä¸**å¹¿å‘Š**æ•°æ®åŒ…ç›¸åŒçš„ç»“æ„ï¼Œé™„åŠ äº†æ— æ³•æ”¾åœ¨åˆå§‹å¹¿å‘Šè¯·æ±‚ä¸­çš„å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚å®Œæ•´çš„è®¾å¤‡åç§°ã€‚

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

å‰å¯¼å­—èŠ‚ç”¨äºåŒæ­¥é¢‘ç‡ï¼Œè€Œå››å­—èŠ‚çš„è®¿é—®åœ°å€æ˜¯ä¸€ä¸ª**è¿æ¥æ ‡è¯†ç¬¦**ï¼Œç”¨äºåœ¨å¤šä¸ªè®¾å¤‡å°è¯•åœ¨ç›¸åŒä¿¡é“ä¸Šå»ºç«‹è¿æ¥çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œåè®®æ•°æ®å•å…ƒï¼ˆ**PDU**ï¼‰åŒ…å«**å¹¿å‘Šæ•°æ®**ã€‚æœ‰å‡ ç§ç±»å‹çš„PDUï¼Œæœ€å¸¸ç”¨çš„æ˜¯ADV\_NONCONN\_INDå’ŒADV\_INDã€‚å¦‚æœè®¾å¤‡**ä¸æ¥å—è¿æ¥**ï¼Œåˆ™ä½¿ç”¨**ADV\_NONCONN\_IND** PDUç±»å‹ï¼Œä»…åœ¨å¹¿å‘Šæ•°æ®åŒ…ä¸­ä¼ è¾“æ•°æ®ã€‚å¦‚æœè®¾å¤‡**å…è®¸è¿æ¥**å¹¶ä¸”ä¸€æ—¦**å»ºç«‹è¿æ¥**å°±**åœæ­¢å‘é€å¹¿å‘Š**æ•°æ®åŒ…ï¼Œåˆ™ä½¿ç”¨**ADV\_IND**ã€‚

## GATT

**é€šç”¨å±æ€§é…ç½®æ–‡ä»¶**ï¼ˆGATTï¼‰å®šä¹‰äº†**è®¾å¤‡åº”å¦‚ä½•æ ¼å¼åŒ–å’Œä¼ è¾“æ•°æ®**ã€‚å½“ä½ åˆ†æBLEè®¾å¤‡çš„æ”»å‡»é¢æ—¶ï¼Œé€šå¸¸ä¼šé›†ä¸­æ³¨æ„åŠ›åœ¨GATTï¼ˆæˆ–GATTsï¼‰ä¸Šï¼Œå› ä¸ºå®ƒæ˜¯è§¦å‘**è®¾å¤‡åŠŸèƒ½**å’Œå­˜å‚¨ã€åˆ†ç»„å’Œä¿®æ”¹æ•°æ®çš„æ–¹å¼ã€‚GATTä»¥16ä½æˆ–32ä½å€¼çš„å½¢å¼åœ¨è¡¨ä¸­åˆ—å‡ºè®¾å¤‡çš„ç‰¹å¾ã€æè¿°ç¬¦å’ŒæœåŠ¡ã€‚**ç‰¹å¾**æ˜¯åœ¨ä¸­å¿ƒè®¾å¤‡å’Œå¤–å›´è®¾å¤‡ä¹‹é—´**å‘é€çš„æ•°æ®å€¼**ã€‚è¿™äº›ç‰¹å¾å¯ä»¥æœ‰**æè¿°ç¬¦**ï¼Œ**æä¾›æœ‰å…³å®ƒä»¬çš„é™„åŠ ä¿¡æ¯**ã€‚å¦‚æœç‰¹å¾ä¸æ‰§è¡Œç‰¹å®šæ“ä½œç›¸å…³ï¼Œåˆ™é€šå¸¸å°†å…¶**åˆ†ç»„**åœ¨**æœåŠ¡**ä¸­ã€‚

# æšä¸¾
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** å…è®¸ä¸å¦ä¸€ä¸ªè®¾å¤‡å»ºç«‹è¿æ¥ï¼Œåˆ—å‡ºè¯¥è®¾å¤‡çš„ç‰¹å¾ï¼Œå¹¶è¯»å–å’Œå†™å…¥å…¶å±æ€§ã€‚\
GATTToolå¯ä»¥ä½¿ç”¨`-I`é€‰é¡¹å¯åŠ¨äº¤äº’å¼shellï¼š
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap

Bettercapæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œå®‰å…¨å·¥å…·ï¼Œç”¨äºæ‰§è¡Œä¸­é—´äººæ”»å‡»å’Œç½‘ç»œå—…æ¢ã€‚å®ƒæ”¯æŒè“ç‰™ä½åŠŸè€—ï¼ˆBLEï¼‰çš„æ¸—é€æµ‹è¯•ï¼Œå¯ä»¥ç”¨äºæ¢æµ‹å’Œåˆ©ç”¨BLEè®¾å¤‡çš„æ¼æ´ã€‚

### å®‰è£…

è¦å®‰è£…Bettercapï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1. é¦–å…ˆï¼Œç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£…Goè¯­è¨€ç¯å¢ƒã€‚

2. ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»GitHubä¸Šå…‹éš†Bettercapçš„å­˜å‚¨åº“ï¼š

   ```
   git clone https://github.com/bettercap/bettercap
   ```

3. è¿›å…¥å…‹éš†çš„å­˜å‚¨åº“ç›®å½•ï¼š

   ```
   cd bettercap
   ```

4. ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»ºå’Œå®‰è£…Bettercapï¼š

   ```
   make build
   sudo make install
   ```

### ä½¿ç”¨Bettercapè¿›è¡ŒBLEæ¸—é€æµ‹è¯•

è¦ä½¿ç”¨Bettercapè¿›è¡ŒBLEæ¸—é€æµ‹è¯•ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1. é¦–å…ˆï¼Œç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å¯ç”¨è“ç‰™é€‚é…å™¨ã€‚

2. ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨Bettercapå¹¶é€‰æ‹©è“ç‰™ä½åŠŸè€—æ¨¡å—ï¼š

   ```
   sudo bettercap -caplet ble.cap
   ```

3. åœ¨Bettercapå‘½ä»¤è¡Œç•Œé¢ä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰«æé™„è¿‘çš„BLEè®¾å¤‡ï¼š

   ```
   ble.recon on
   ```

4. æ‰«æå®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€‰æ‹©ç›®æ ‡è®¾å¤‡ï¼š

   ```
   ble.recon.targets
   ble.recon.target <target_mac_address>
   ```

5. é€‰æ‹©ç›®æ ‡è®¾å¤‡åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡ŒBLEæ¸—é€æµ‹è¯•ï¼š

   ```
   ble.recon <target_mac_address>
   ```

6. Bettercapå°†æ˜¾ç¤ºç›®æ ‡è®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æä¾›æ‰§è¡Œå„ç§æ”»å‡»çš„é€‰é¡¹ã€‚

è¯·æ³¨æ„ï¼Œä½¿ç”¨Bettercapè¿›è¡ŒBLEæ¸—é€æµ‹è¯•å¯èƒ½æ¶‰åŠè¿åæ³•å¾‹å’Œé“å¾·è§„èŒƒã€‚è¯·ä»…åœ¨åˆæ³•æˆæƒçš„èŒƒå›´å†…ä½¿ç”¨æ­¤å·¥å…·ï¼Œå¹¶éµå®ˆé€‚ç”¨çš„æ³•å¾‹å’Œè§„å®šã€‚
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…ä½ æƒ³è¦**è·å–æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ NFT æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
