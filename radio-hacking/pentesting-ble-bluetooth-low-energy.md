# Introduction

Disponible depuis la spÃ©cification Bluetooth 4.0, BLE utilise seulement 40 canaux, couvrant la plage de 2400 Ã  2483,5 MHz. En revanche, le Bluetooth traditionnel utilise 79 canaux dans cette mÃªme plage.

Les appareils BLE communiquent en envoyant des **paquets publicitaires** (**balises**), ces paquets diffusent l'existence de l'appareil BLE Ã  d'autres appareils Ã  proximitÃ©. Ces balises envoient parfois des donnÃ©es.

L'appareil d'Ã©coute, Ã©galement appelÃ© appareil central, peut rÃ©pondre Ã  un paquet publicitaire avec une **demande de SCAN** envoyÃ©e spÃ©cifiquement Ã  l'appareil publicitaire. La **rÃ©ponse** Ã  ce scan utilise la mÃªme structure que le **paquet publicitaire** avec des informations supplÃ©mentaires qui n'ont pas pu Ãªtre incluses dans la demande publicitaire initiale, telles que le nom complet de l'appareil.

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

L'octet de prÃ©ambule synchronise la frÃ©quence, tandis que l'adresse d'accÃ¨s de quatre octets est un **identifiant de connexion**, qui est utilisÃ© dans des scÃ©narios oÃ¹ plusieurs appareils tentent d'Ã©tablir des connexions sur les mÃªmes canaux. Ensuite, l'unitÃ© de donnÃ©es de protocole (**PDU**) contient les **donnÃ©es publicitaires**. Il existe plusieurs types de PDU ; les plus couramment utilisÃ©s sont ADV\_NONCONN\_IND et ADV\_IND. Les appareils utilisent le type PDU **ADV\_NONCONN\_IND** s'ils **n'acceptent pas les connexions**, transmettant des donnÃ©es uniquement dans le paquet publicitaire. Les appareils utilisent **ADV\_IND** s'ils **autorise les connexions** et **arrÃªtent d'envoyer des paquets publicitaires** une fois qu'une **connexion** a Ã©tÃ© **Ã©tablie**.

## GATT

Le **Generic Attribute Profile** (GATT) dÃ©finit comment l'appareil doit formater et transfÃ©rer les donnÃ©es. Lorsque vous analysez la surface d'attaque d'un appareil BLE, vous concentrerez souvent votre attention sur le GATT (ou les GATT), car c'est ainsi que la **fonctionnalitÃ© de l'appareil est dÃ©clenchÃ©e** et comment les donnÃ©es sont stockÃ©es, regroupÃ©es et modifiÃ©es. Le GATT rÃ©pertorie les caractÃ©ristiques, les descripteurs et les services d'un appareil dans un tableau sous forme de valeurs de 16 ou 32 bits. Une **caractÃ©ristique** est une **valeur de donnÃ©es envoyÃ©e** entre l'appareil central et pÃ©riphÃ©rique. Ces caractÃ©ristiques peuvent avoir des **descripteurs** qui **fournissent des informations supplÃ©mentaires Ã  leur sujet**. Les **caractÃ©ristiques** sont souvent **regroupÃ©es** dans des **services** s'ils sont liÃ©s Ã  l'exÃ©cution d'une action particuliÃ¨re.

# Ã‰numÃ©ration
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** permet d'**Ã©tablir** une **connexion** avec un autre appareil, de lister les **caractÃ©ristiques** de cet appareil, et de lire et Ã©crire ses attributs.\
GATTTool peut lancer une console interactive avec l'option `-I`:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
  handle: 0x0002, char properties: 0x20, char value handle:
  0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
  handle: 0x0015, char properties: 0x02, char value handle:
  0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap

Bettercap est un outil de piratage rÃ©seau open source qui permet de rÃ©aliser des attaques MITM (Man In The Middle) sur des rÃ©seaux cÃ¢blÃ©s et sans fil. Il est capable de capturer des paquets, de les analyser et de les modifier en temps rÃ©el. Bettercap prend en charge plusieurs protocoles, notamment HTTP, HTTPS, DNS, FTP, SMTP, IMAP, POP3, TCP, UDP et ICMP. Il peut Ã©galement Ãªtre utilisÃ© pour effectuer des attaques de phishing et d'injection de code JavaScript. Bettercap est un outil trÃ¨s puissant et polyvalent qui peut Ãªtre utilisÃ© pour tester la sÃ©curitÃ© des rÃ©seaux et des applications.
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Travaillez-vous dans une entreprise de **cybersÃ©curitÃ©** ? Voulez-vous voir votre **entreprise annoncÃ©e dans HackTricks** ? ou voulez-vous avoir accÃ¨s Ã  la **derniÃ¨re version de PEASS ou tÃ©lÃ©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- DÃ©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [dÃ©pÃ´t hacktricks](https://github.com/carlospolop/hacktricks) et au [dÃ©pÃ´t hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
