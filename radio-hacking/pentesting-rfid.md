# Pentesting RFID

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** bizi **takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## GiriÅŸ

**Radyo FrekansÄ± TanÄ±mlama (RFID)**, en popÃ¼ler kÄ±sa menzilli radyo Ã§Ã¶zÃ¼mÃ¼dÃ¼r. Genellikle bir varlÄ±ÄŸÄ± tanÄ±mlayan bilgileri depolamak ve iletmek iÃ§in kullanÄ±lÄ±r.

Bir RFID etiketi, **kendi gÃ¼Ã§ kaynaÄŸÄ±na (aktif)** sahip olabilir, Ã¶rneÄŸin gÃ¶mÃ¼lÃ¼ bir pil, ya da okuma anteninden alÄ±nan **radyo dalgalarÄ±ndan indÃ¼klenen akÄ±mÄ±** kullanarak gÃ¼Ã§ alabilir (**pasif**).

### SÄ±nÄ±flar

EPCglobal, RFID etiketlerini altÄ± kategoriye ayÄ±rÄ±r. Her kategorideki bir etiket, bir Ã¶nceki kategoride listelenen tÃ¼m yeteneklere sahiptir, bu da geriye dÃ¶nÃ¼k uyumluluk saÄŸlar.

* **SÄ±nÄ±f 0** etiketleri, **UHF** bantlarÄ±nda Ã§alÄ±ÅŸan **pasif** etiketlerdir. Ãœretim fabrikasÄ±nda **Ã¶nceden programlanmÄ±ÅŸlardÄ±r**. SonuÃ§ olarak, belleÄŸinde depolanan bilgileri **deÄŸiÅŸtiremezsiniz**.
* **SÄ±nÄ±f 1** etiketleri de **HF** bantlarÄ±nda Ã§alÄ±ÅŸabilir. AyrÄ±ca, Ã¼retimden sonra **sadece bir kez yazÄ±labilirler**. BirÃ§ok SÄ±nÄ±f 1 etiketi, aldÄ±klarÄ± komutlarÄ±n **dÃ¶ngÃ¼sel redundans kontrollerini** (CRC) iÅŸleyebilir. CRC'ler, hata tespiti iÃ§in komutlarÄ±n sonunda birkaÃ§ ek bayttÄ±r.
* **SÄ±nÄ±f 2** etiketleri **birden fazla kez yazÄ±labilir**.
* **SÄ±nÄ±f 3** etiketleri, mevcut sÄ±caklÄ±k veya etiketin hareketi gibi Ã§evresel parametreleri kaydedebilen **gÃ¶mÃ¼lÃ¼ sensÃ¶rler** iÃ§erebilir. Bu etiketler **yarÄ±-pasif**'dir, Ã§Ã¼nkÃ¼ gÃ¶mÃ¼lÃ¼ bir gÃ¼Ã§ kaynaÄŸÄ±na sahip olmalarÄ±na raÄŸmen, diÄŸer etiketler veya okuyucularla kablosuz **iletiÅŸim baÅŸlatamazlar**.
* **SÄ±nÄ±f 4** etiketleri, aynÄ± sÄ±nÄ±ftaki diÄŸer etiketlerle iletiÅŸim baÅŸlatabilir, bu da onlarÄ± **aktif etiketler** yapar.
* **SÄ±nÄ±f 5** etiketleri, **diÄŸer etiketlere gÃ¼Ã§ saÄŸlayabilir ve Ã¶nceki tÃ¼m etiket** sÄ±nÄ±flarÄ±yla iletiÅŸim kurabilir. SÄ±nÄ±f 5 etiketleri **RFID okuyucularÄ±** olarak iÅŸlev gÃ¶rebilir.

### RFID Etiketlerinde Depolanan Bilgiler

Bir RFID etiketinin belleÄŸi genellikle dÃ¶rt tÃ¼r veri depolar: **kimlik verileri**, etiketin baÄŸlÄ± olduÄŸu **varlÄ±ÄŸÄ±** **tanÄ±mlayan** veriler (bu veriler, kullanÄ±cÄ± tanÄ±mlÄ± alanlar, Ã¶rneÄŸin banka hesaplarÄ± iÃ§erir); **tamamlayÄ±cÄ± veriler**, varlÄ±kla ilgili **daha fazla** **detay** saÄŸlayan veriler; etiketin iÃ§ **konfigÃ¼rasyonu** iÃ§in kullanÄ±lan **kontrol verileri**; ve etiketin **Ã¼retici verileri**, bir etiketin Benzersiz TanÄ±mlayÄ±cÄ±sÄ±nÄ± (**UID**) ve etiketin **Ã¼retimi**, **tipi** ve **satÄ±cÄ±sÄ±** ile ilgili detaylarÄ± iÃ§erir. Ä°lk iki tÃ¼r veri tÃ¼m ticari etiketlerde bulunur; son iki tÃ¼r, etiketin satÄ±cÄ±sÄ±na baÄŸlÄ± olarak farklÄ±lÄ±k gÃ¶sterebilir.

ISO standardÄ±, etiketin ait olduÄŸu **nesne tÃ¼rÃ¼nÃ¼** belirten bir kod olan Uygulama Aile TanÄ±mlayÄ±cÄ±sÄ± (**AFI**) deÄŸerini belirtir. ISO tarafÄ±ndan belirtilen bir diÄŸer Ã¶nemli kayÄ±t ise, kullanÄ±cÄ± verilerinin **mantÄ±ksal organizasyonunu** tanÄ±mlayan Veri Depolama FormatÄ± TanÄ±mlayÄ±cÄ±sÄ± (**DSFID**)dÄ±r.

Ã‡oÄŸu RFID **gÃ¼venlik kontrolÃ¼**, her kullanÄ±cÄ± bellek bloÄŸundaki ve AFI ve DSFID deÄŸerlerini iÃ§eren Ã¶zel kayÄ±tlardaki **okuma** veya **yazma** iÅŸlemlerini **kÄ±sÄ±tlayan** mekanizmalara sahiptir. Bu **kilit** **mekanizmalarÄ±**, kontrol belleÄŸinde depolanan verileri kullanÄ±r ve satÄ±cÄ± tarafÄ±ndan Ã¶nceden yapÄ±landÄ±rÄ±lmÄ±ÅŸ **varsayÄ±lan ÅŸifreler** iÃ§erir, ancak etiket sahiplerinin **Ã¶zel ÅŸifreler yapÄ±landÄ±rmasÄ±na** izin verir.

### DÃ¼ÅŸÃ¼k ve YÃ¼ksek FrekanslÄ± Etiketlerin KarÅŸÄ±laÅŸtÄ±rmasÄ±

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## DÃ¼ÅŸÃ¼k FrekanslÄ± RFID Etiketleri (125kHz)

**DÃ¼ÅŸÃ¼k frekanslÄ± etiketler**, genellikle **yÃ¼ksek gÃ¼venlik** gerektirmeyen sistemlerde kullanÄ±lÄ±r: bina eriÅŸimi, interkom anahtarlarÄ±, spor salonu Ã¼yelik kartlarÄ± vb. Daha yÃ¼ksek menzil nedeniyle, Ã¼cretli otoparklar iÃ§in kullanÄ±mÄ± uygundur: sÃ¼rÃ¼cÃ¼nÃ¼n kartÄ± okuyucuya yakÄ±n getirmesi gerekmez, Ã§Ã¼nkÃ¼ daha uzaktan tetiklenir. AynÄ± zamanda, dÃ¼ÅŸÃ¼k frekanslÄ± etiketler Ã§ok ilkel olup, dÃ¼ÅŸÃ¼k veri transfer hÄ±zÄ±na sahiptir. Bu nedenle, bakiye tutma ve kriptografi gibi karmaÅŸÄ±k iki yÃ¶nlÃ¼ veri transferi uygulamak imkansÄ±zdÄ±r. DÃ¼ÅŸÃ¼k frekanslÄ± etiketler yalnÄ±zca kÄ±sa kimliklerini iletir, herhangi bir kimlik doÄŸrulama aracÄ± olmadan.

Bu cihazlar, **pasif** **RFID** teknolojisine dayanÄ±r ve **30 kHz ile 300 kHz** aralÄ±ÄŸÄ±nda Ã§alÄ±ÅŸÄ±r, ancak genellikle 125 kHz ile 134 kHz kullanÄ±lÄ±r:

* **Uzun Menzil** â€” daha dÃ¼ÅŸÃ¼k frekans, daha yÃ¼ksek menzil anlamÄ±na gelir. Bir metreye kadar mesafeden Ã§alÄ±ÅŸan bazÄ± EM-Marin ve HID okuyucular vardÄ±r. Bunlar genellikle otoparklarda kullanÄ±lÄ±r.
* **Ä°lkel protokol** â€” dÃ¼ÅŸÃ¼k veri transfer hÄ±zÄ± nedeniyle bu etiketler yalnÄ±zca kÄ±sa kimliklerini iletebilir. Ã‡oÄŸu durumda, veriler kimlik doÄŸrulamasÄ±na tabi deÄŸildir ve herhangi bir ÅŸekilde korunmaz. Kart okuyucunun menzilindeyken, sadece kimliÄŸini iletmeye baÅŸlar.
* **DÃ¼ÅŸÃ¼k gÃ¼venlik** â€” Bu kartlar kolayca kopyalanabilir veya protokolÃ¼n ilkel olmasÄ± nedeniyle baÅŸkalarÄ±nÄ±n cebinden bile okunabilir.

**PopÃ¼ler 125 kHz protokolleri:**

* **EM-Marin** â€” EM4100, EM4102. CIS'teki en popÃ¼ler protokol. BasitliÄŸi ve kararlÄ±lÄ±ÄŸÄ± nedeniyle yaklaÅŸÄ±k bir metreden okunabilir.
* **HID Prox II** â€” HID Global tarafÄ±ndan tanÄ±tÄ±lan dÃ¼ÅŸÃ¼k frekanslÄ± protokol. Bu protokol, batÄ± Ã¼lkelerinde daha popÃ¼lerdir. Daha karmaÅŸÄ±k olup, bu protokol iÃ§in kartlar ve okuyucular nispeten pahalÄ±dÄ±r.
* **Indala** â€” Motorola tarafÄ±ndan tanÄ±tÄ±lan Ã§ok eski bir dÃ¼ÅŸÃ¼k frekanslÄ± protokol ve daha sonra HID tarafÄ±ndan satÄ±n alÄ±ndÄ±. Ã–nceki iki protokole kÄ±yasla, kullanÄ±m dÄ±ÅŸÄ± kalmasÄ± nedeniyle doÄŸada daha az karÅŸÄ±laÅŸma olasÄ±lÄ±ÄŸÄ±nÄ±z vardÄ±r.

GerÃ§ekte, Ã§ok daha fazla dÃ¼ÅŸÃ¼k frekanslÄ± protokol vardÄ±r. Ancak hepsi fiziksel katmanda aynÄ± modÃ¼lasyonu kullanÄ±r ve bir ÅŸekilde yukarÄ±da listelenenlerin bir varyasyonu olarak kabul edilebilir.

### SaldÄ±rÄ±

Bu Etiketlere **Flipper Zero ile saldÄ±rabilirsiniz**:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}

## YÃ¼ksek FrekanslÄ± RFID Etiketleri (13.56 MHz)

**YÃ¼ksek frekanslÄ± etiketler**, kriptografi, bÃ¼yÃ¼k iki yÃ¶nlÃ¼ veri transferi, kimlik doÄŸrulama vb. gerektiÄŸinde daha karmaÅŸÄ±k bir okuyucu-etiket etkileÅŸimi iÃ§in kullanÄ±lÄ±r.\
Genellikle banka kartlarÄ±nda, toplu taÅŸÄ±ma araÃ§larÄ±nda ve diÄŸer gÃ¼venli geÃ§iÅŸlerde bulunur.

**YÃ¼ksek frekanslÄ± 13.56 MHz etiketleri, bir dizi standart ve protokoldÃ¼r**. Genellikle [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) olarak adlandÄ±rÄ±lÄ±r, ancak bu her zaman doÄŸru deÄŸildir. Fiziksel ve mantÄ±ksal seviyelerde kullanÄ±lan temel protokol seti ISO 14443'tÃ¼r. YÃ¼ksek seviyeli protokoller ve alternatif standartlar (ISO 19092 gibi) buna dayanmaktadÄ±r. BirÃ§ok kiÅŸi bu teknolojiyi **YakÄ±n Alan Ä°letiÅŸimi (NFC)** olarak adlandÄ±rÄ±r, bu terim 13.56 MHz frekansÄ±nda Ã§alÄ±ÅŸan cihazlar iÃ§in kullanÄ±lÄ±r.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

BasitÃ§e ifade etmek gerekirse, NFC'nin mimarisi ÅŸÃ¶yle Ã§alÄ±ÅŸÄ±r: iletim protokolÃ¼, kartlarÄ± Ã¼reten ÅŸirket tarafÄ±ndan seÃ§ilir ve dÃ¼ÅŸÃ¼k seviyeli ISO 14443'e dayalÄ± olarak uygulanÄ±r. Ã–rneÄŸin, NXP kendi yÃ¼ksek seviyeli iletim protokolÃ¼ olan Mifare'yi icat etmiÅŸtir. Ancak daha dÃ¼ÅŸÃ¼k seviyede, Mifare kartlarÄ± ISO 14443-A standardÄ±na dayanmaktadÄ±r.

Flipper, hem dÃ¼ÅŸÃ¼k seviyeli ISO 14443 protokolÃ¼ ile hem de Mifare Ultralight veri transfer protokolÃ¼ ve banka kartlarÄ±nda kullanÄ±lan EMV ile etkileÅŸimde bulunabilir. Mifare Classic ve NFC NDEF desteÄŸi eklemek iÃ§in Ã§alÄ±ÅŸÄ±yoruz. NFC'yi oluÅŸturan protokoller ve standartlar Ã¼zerine kapsamlÄ± bir inceleme, daha sonra yayÄ±nlamayÄ± planladÄ±ÄŸÄ±mÄ±z ayrÄ± bir makaleyi gerektirir.

ISO 14443-A standardÄ±na dayanan tÃ¼m yÃ¼ksek frekanslÄ± kartlar, benzersiz bir Ã§ip kimliÄŸine sahiptir. Bu, kartÄ±n seri numarasÄ± gibi iÅŸlev gÃ¶rÃ¼r, bir aÄŸ kartÄ±nÄ±n MAC adresi gibidir. **Genellikle, UID 4 veya 7 bayt uzunluÄŸundadÄ±r**, ancak nadiren **10 bayta kadar** Ã§Ä±kabilir. UID'ler gizli deÄŸildir ve kolayca okunabilir, **bazen hatta kartÄ±n kendisinde basÄ±lÄ±dÄ±r**.

UID'ye dayanan birÃ§ok eriÅŸim kontrol sistemi, **kimlik doÄŸrulama ve eriÅŸim verme** iÅŸlemlerine dayanÄ±r. Bazen bu, RFID etiketleri **kriptografi desteklese bile** gerÃ§ekleÅŸir. BÃ¶yle bir **kÃ¶tÃ¼ye kullanÄ±m**, gÃ¼venlik aÃ§Ä±sÄ±ndan onlarÄ± aptal **125 kHz kartlarÄ±** seviyesine dÃ¼ÅŸÃ¼rÃ¼r. Sanal kartlar (Apple Pay gibi), telefon sahiplerinin Ã¶deme uygulamalarÄ±yla kapÄ±larÄ± aÃ§mamalarÄ± iÃ§in dinamik bir UID kullanÄ±r.

* **DÃ¼ÅŸÃ¼k menzil** â€” yÃ¼ksek frekanslÄ± kartlar, okuyucuya yakÄ±n yerleÅŸtirilmesi iÃ§in Ã¶zel olarak tasarlanmÄ±ÅŸtÄ±r. Bu, kartÄ± yetkisiz etkileÅŸimlerden korumaya da yardÄ±mcÄ± olur. Elde ettiÄŸimiz maksimum okuma menzili yaklaÅŸÄ±k 15 cm'dir ve bu, Ã¶zel yapÄ±m yÃ¼ksek menzil okuyucularla olmuÅŸtur.
* **GeliÅŸmiÅŸ protokoller** â€” veri transfer hÄ±zlarÄ± 424 kbps'ye kadar Ã§Ä±kabilir, bu da tam teÅŸekkÃ¼llÃ¼ iki yÃ¶nlÃ¼ veri transferine olanak tanÄ±r. Bu da **kriptografi**, veri transferi vb. saÄŸlar.
* **YÃ¼ksek gÃ¼venlik** â€” yÃ¼ksek frekanslÄ± temassÄ±z kartlar, akÄ±llÄ± kartlarla kÄ±yaslandÄ±ÄŸÄ±nda hiÃ§bir ÅŸekilde geri kalmaz. AES gibi kriptografik olarak gÃ¼Ã§lÃ¼ algoritmalarÄ± destekleyen ve asimetrik kriptografi uygulayan kartlar vardÄ±r.

### SaldÄ±rÄ±

Bu Etiketlere **Flipper Zero ile saldÄ±rabilirsiniz**:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-nfc.md" %}
[fz-nfc.md](../todo/radio-hacking/flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ya da **proxmark** kullanarak:

{% content-ref url="../todo/radio-hacking/proxmark-3.md" %}
[proxmark-3.md](../todo/radio-hacking/proxmark-3.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** bizi **takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
