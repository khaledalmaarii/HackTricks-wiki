# RFID Pentest

<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

* Bir **cybersecurity ÅŸirketinde** Ã§alÄ±ÅŸÄ±yor musunuz? **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family), Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu keÅŸfedin.
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter**'da takip edin ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## GiriÅŸ

**Radyo FrekansÄ± TanÄ±mlama (RFID)** en popÃ¼ler kÄ±sa menzilli radyo Ã§Ã¶zÃ¼mÃ¼dÃ¼r. Genellikle bir varlÄ±ÄŸÄ± tanÄ±mlayan bilgileri depolamak ve iletmek iÃ§in kullanÄ±lÄ±r.

Bir RFID etiketi, **kendi gÃ¼Ã§ kaynaÄŸÄ±na (aktif)**, Ã¶rneÄŸin gÃ¶mÃ¼lÃ¼ bir pil, veya **alÄ±nan radyo dalgalarÄ±ndan indÃ¼klenen akÄ±mÄ±** kullanarak okuma anteninden gÃ¼Ã§ alabilir (**pasif**).

### SÄ±nÄ±flar

EPCglobal, RFID etiketlerini altÄ± kategoriye ayÄ±rÄ±r. Her kategorideki bir etiket, Ã¶nceki kategoride listelenen tÃ¼m yeteneklere sahiptir, bu da geriye dÃ¶nÃ¼k uyumluluÄŸu saÄŸlar.

* **SÄ±nÄ±f 0** etiketler, **UHF** bantlarÄ±nda Ã§alÄ±ÅŸan **pasif** etiketlerdir. Ãœretim fabrikasÄ±nda satÄ±cÄ± tarafÄ±ndan **Ã¶nceden programlanÄ±r**. SonuÃ§ olarak, bellekte depolanan bilgileri **deÄŸiÅŸtiremezsiniz**.
* **SÄ±nÄ±f 1** etiketler ayrÄ±ca **HF** bantlarÄ±nda da Ã§alÄ±ÅŸabilir. Ãœretimden sonra sadece bir kez **yazÄ±labilir**. BirÃ§ok SÄ±nÄ±f 1 etiket, aldÄ±klarÄ± komutlarÄ±n **dÃ¶ngÃ¼sel tekrarlÄ± kontrol toplamÄ±** (CRC) iÅŸleyebilir. CRC'ler, hata tespiti iÃ§in komutlarÄ±n sonunda birkaÃ§ ekstra bayttÄ±r.
* **SÄ±nÄ±f 2** etiketler birden Ã§ok kez **yazÄ±labilir**.
* **SÄ±nÄ±f 3** etiketler, etiketin hareketi gibi Ã§evresel parametreleri kaydedebilen **gÃ¶mÃ¼lÃ¼ sensÃ¶rler** iÃ§erebilir. Bu etiketler, entegre bir **pil** gibi bir gÃ¶mÃ¼lÃ¼ gÃ¼Ã§ kaynaÄŸÄ±na sahip olmalarÄ±na raÄŸmen, diÄŸer etiketler veya okuyucularla kablosuz **iletiÅŸim baÅŸlatamazlar**, bu yÃ¼zden **yarÄ± pasif** olarak kabul edilirler.
* **SÄ±nÄ±f 4** etiketler, aynÄ± sÄ±nÄ±ftaki diÄŸer etiketlerle iletiÅŸim baÅŸlatabilir, bu da onlarÄ± **aktif etiketler** yapar.
* **SÄ±nÄ±f 5** etiketler, diÄŸer tÃ¼m Ã¶nceki etiket sÄ±nÄ±flarÄ±yla **iletiÅŸim kurabilir ve diÄŸer etiketlere gÃ¼Ã§ saÄŸlayabilir**. SÄ±nÄ±f 5 etiketler, **RFID okuyucularÄ±** olarak hareket edebilir.

### RFID Etiketlerinde Depolanan Bilgiler

Bir RFID etiketinin belleÄŸi genellikle dÃ¶rt tÃ¼r veri depolar: etikete baÄŸlÄ± olan **tanÄ±mlama verileri** (bu veriler banka hesaplarÄ± gibi kullanÄ±cÄ± tanÄ±mlÄ± alanlarÄ± iÃ§erir); varlÄ±ÄŸa iliÅŸkin **daha fazla ayrÄ±ntÄ±** saÄŸlayan **ek veriler**; etiketin iÃ§ **yapÄ±landÄ±rmasÄ±** iÃ§in kullanÄ±lan **kontrol verileri**; ve etiketin **Ã¼retimi**, **tÃ¼rÃ¼** ve **satÄ±cÄ±sÄ±** hakkÄ±nda bilgiler iÃ§eren etiketin **Ã¼retici verileri**. Ä°lk iki veri tÃ¼rÃ¼nÃ¼ tÃ¼m ticari etiketlerde bulabilirsiniz; son iki veri, etiketin satÄ±cÄ±sÄ±na baÄŸlÄ± olarak farklÄ±lÄ±k gÃ¶sterebilir.

ISO standardÄ±, etiketin hangi **nesne tÃ¼rÃ¼ne** ait olduÄŸunu belirten bir kod olan **Uygulama Ailesi TanÄ±mlayÄ±cÄ±sÄ± (AFI)** deÄŸerini belirtir. ISO tarafÄ±ndan belirtilen baÅŸka bir Ã¶nemli kayÄ±t ise **Veri Depolama FormatÄ± TanÄ±mlayÄ±cÄ±sÄ± (DSFID)**'dir ve bu, kullanÄ±cÄ± verilerinin **mantÄ±ksal dÃ¼zenini** tanÄ±mlar.

Ã‡oÄŸu RFID **gÃ¼venlik kontrolleri**, her kullanÄ±cÄ± bellek bloÄŸunda ve AFI ve DSFID deÄŸerlerini iÃ§eren Ã¶zel kayÄ±tlarda **okuma** veya **yazma** iÅŸlemlerini **kÄ±sÄ±tlayan** mekanizmalara sahiptir. Bu **kilit** **mekanizmalarÄ±**, kontrol bellekte depolanan verileri kullanÄ±r ve satÄ±cÄ± tarafÄ±ndan Ã¶nceden yapÄ±landÄ±rÄ±lmÄ±ÅŸ **varsayÄ±lan parolalarÄ±** kullanÄ±r, ancak etiket sahiplerinin **Ã¶zel parolalarÄ± yapÄ±landÄ±rmasÄ±na** izin verir.

### DÃ¼ÅŸÃ¼k ve YÃ¼ksek FrekanslÄ± Etiket KarÅŸÄ±laÅŸtÄ±rmasÄ±

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## DÃ¼ÅŸÃ¼k FrekanslÄ± RFID Etiketler (125kHz)

**DÃ¼ÅŸÃ¼k frekanslÄ± etiketler**, yÃ¼ksek gÃ¼venlik gerektirmeyen sistemlerde sÄ±klÄ±kla kullanÄ±lÄ±r: bina eriÅŸimi, interkom anahtarlarÄ±, spor salonu Ã¼yelik kartlarÄ± vb. Daha yÃ¼ksek menzilleri nedeniyle, Ã¼cretli otopark iÃ§in kullanmak pratiktir: sÃ¼rÃ¼cÃ¼ kartÄ± okuyucuya yakÄ±n getirmek zorunda kalmaz, Ã§Ã¼nkÃ¼ daha uzaktan tetiklenir. AynÄ± zamanda, dÃ¼ÅŸÃ¼k frekanslÄ± etiketler Ã§ok basittir, veri transfer hÄ±zlarÄ± dÃ¼ÅŸÃ¼ktÃ¼r. Bu nedenle, bakiye tutma ve ÅŸifreleme gibi karmaÅŸÄ±k iki yÃ¶nlÃ¼ veri transferini uygulamak imkansÄ±zdÄ±r. DÃ¼ÅŸÃ¼k frekanslÄ± etiketler yalnÄ±zca kimlik doÄŸrulama yÃ¶ntemleri olmadan kÄ±sa kimliklerini iletebilir.

Bu cihazlar, **pasif** **RFID** teknolojisine dayanÄ±r ve genellikle **30 kHz ila 300 kHz** aralÄ±ÄŸÄ±nda Ã§alÄ±ÅŸÄ±r, ancak genellikle 125 kHz ila 134 kHz kullanÄ±lÄ±r:

* **Uzun Menzil** â€” dÃ¼ÅŸÃ¼k frekans, daha uzun menzile dÃ¶nÃ¼ÅŸÃ¼r. Bir metreye kadar mesafeden Ã§alÄ±ÅŸan bazÄ± EM-Marin ve HID okuyucularÄ± vardÄ±r. Bunlar genellikle otoparklarda kullanÄ±lÄ±r.
* **Basit protokol** â€” dÃ¼ÅŸÃ¼k veri transfer hÄ±zÄ± nedeniyle bu etiketler yalnÄ±zca kÄ±sa kimliklerini iletebilir. Ã‡oÄŸu durumda, veri kimlik doÄŸrulanmaz ve herhangi bir ÅŸekilde korunmaz. Kart okuyucunun menziline girdiÄŸi anda kimlik bilgilerini iletmeye baÅŸlar.
* **DÃ¼ÅŸÃ¼k gÃ¼venlik** â€” Bu kartlar kolayca kopyalanabilir veya protokolÃ¼n basitliÄŸi nedeniyle baÅŸkasÄ±nÄ±n cebinden okunabilir.

**PopÃ¼ler 125 kHz protokolleri:**

* **EM-Marin** â€” EM4100, EM4102. CIS'teki en popÃ¼ler protokol. BasitliÄŸi ve kararlÄ±lÄ±ÄŸÄ± nedeniyle bir metreye kadar okunabilir.
* **HID Prox II** â€” HID Global tarafÄ±ndan tanÄ±tÄ±lan dÃ¼ÅŸÃ¼k frekanslÄ± protokol. Bu protokol batÄ± Ã¼lkelerinde daha popÃ¼lerdir. Daha karmaÅŸÄ±ktÄ±r ve bu prot
## YÃ¼ksek FrekanslÄ± RFID Etiketleri (13.56 MHz)

**YÃ¼ksek frekanslÄ± etiketler**, ÅŸifreleme, bÃ¼yÃ¼k iki yÃ¶nlÃ¼ veri transferi, kimlik doÄŸrulama vb. gerektiÄŸinde daha karmaÅŸÄ±k bir okuyucu-etiket etkileÅŸimi iÃ§in kullanÄ±lÄ±r.\
Genellikle banka kartlarÄ±nda, toplu taÅŸÄ±ma araÃ§larÄ±nda ve diÄŸer gÃ¼venli geÃ§iÅŸlerde bulunur.

**YÃ¼ksek frekanslÄ± 13.56 MHz etiketler**, bir dizi standart ve protokol olarak kullanÄ±lÄ±r. Genellikle [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) olarak adlandÄ±rÄ±lÄ±r, ancak her zaman doÄŸru deÄŸildir. Fiziksel ve mantÄ±ksal seviyelerde kullanÄ±lan temel protokol seti ISO 14443 olarak adlandÄ±rÄ±lÄ±r. YÃ¼ksek seviye protokoller ve ISO 19092 gibi alternatif standartlar da buna dayanÄ±r. BirÃ§ok insan bu teknolojiyi, 13.56 MHz frekansÄ±nda Ã§alÄ±ÅŸan cihazlar iÃ§in bir terim olan **YakÄ±n Alan Ä°letiÅŸimi (NFC)** olarak adlandÄ±rÄ±r.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

BasitÃ§e sÃ¶ylemek gerekirse, NFC'nin mimarisi ÅŸu ÅŸekilde Ã§alÄ±ÅŸÄ±r: kartlarÄ± Ã¼reten ÅŸirket, iletiÅŸim protokolÃ¼nÃ¼ seÃ§er ve dÃ¼ÅŸÃ¼k seviyeli ISO 14443'e dayanarak uygular. Ã–rneÄŸin, NXP kendi yÃ¼ksek seviye iletiÅŸim protokolÃ¼nÃ¼ Mifare olarak adlandÄ±rÄ±r. Ancak alt seviyede Mifare kartlarÄ± ISO 14443-A standardÄ±na dayanÄ±r.

Flipper hem dÃ¼ÅŸÃ¼k seviye ISO 14443 protokolÃ¼yle, hem de banka kartlarÄ±nda kullanÄ±lan Mifare Ultralight veri transfer protokolÃ¼ ve EMV ile etkileÅŸimde bulunabilir. Mifare Classic ve NFC NDEF desteÄŸi eklemek Ã¼zerinde Ã§alÄ±ÅŸÄ±yoruz. NFC'yi oluÅŸturan protokol ve standartlara ayrÄ± bir makalede daha detaylÄ± bakmak, ileride yayÄ±nlamayÄ± planladÄ±ÄŸÄ±mÄ±z bir konudur.

ISO 14443-A standardÄ±na dayanan tÃ¼m yÃ¼ksek frekanslÄ± kartlar benzersiz bir Ã§ip kimliÄŸine sahiptir. Bu, bir aÄŸ kartÄ±nÄ±n MAC adresi gibi kartÄ±n seri numarasÄ± olarak iÅŸlev gÃ¶rÃ¼r. **UID genellikle 4 veya 7 bayt uzunluÄŸundadÄ±r**, ancak nadiren **10 bayta kadar** Ã§Ä±kabilir. UID'ler gizli deÄŸildir ve kolayca okunabilir, **bazen kartÄ±n Ã¼zerine bile basÄ±lÄ±r**.

UID'ye dayanan birÃ§ok eriÅŸim kontrol sistemi, kimlik doÄŸrulama ve eriÅŸim saÄŸlamak iÃ§in kullanÄ±lÄ±r. Bazen bu, RFID etiketlerinin **ÅŸifreleme**yi desteklemesine raÄŸmen **gerÃ§ekleÅŸir**. Bu tÃ¼r **yanlÄ±ÅŸ kullanÄ±m**, gÃ¼venlik aÃ§Ä±sÄ±ndan aptal **125 kHz kartlarÄ±nÄ±n** seviyesine indirir. Sanal kartlar (Ã¶rneÄŸin Apple Pay), telefon sahiplerinin Ã¶deme uygulamasÄ±yla kapÄ±larÄ± aÃ§mamasÄ± iÃ§in dinamik bir UID kullanÄ±r.

* **DÃ¼ÅŸÃ¼k menzil** - yÃ¼ksek frekanslÄ± kartlar, okuyucuya yakÄ±n yerleÅŸtirilmeleri gereken ÅŸekilde Ã¶zel olarak tasarlanmÄ±ÅŸtÄ±r. Bu aynÄ± zamanda kartÄ± yetkisiz etkileÅŸimlerden korumaya yardÄ±mcÄ± olur. BaÅŸardÄ±ÄŸÄ±mÄ±z maksimum okuma mesafesi yaklaÅŸÄ±k 15 cm idi ve bu Ã¶zel olarak yapÄ±lmÄ±ÅŸ yÃ¼ksek menzilli okuyucularla gerÃ§ekleÅŸtirildi.
* **GeliÅŸmiÅŸ protokoller** - 424 kbps'ye kadar veri transfer hÄ±zlarÄ±, tam teÅŸekkÃ¼llÃ¼ iki yÃ¶nlÃ¼ veri transferi ile karmaÅŸÄ±k protokollere olanak saÄŸlar. Bu da **ÅŸifreleme**, veri transferi vb. gibi iÅŸlemlere olanak tanÄ±r.
* **YÃ¼ksek gÃ¼venlik** - yÃ¼ksek frekanslÄ± temasÄ±z kartlar, akÄ±llÄ± kartlardan hiÃ§bir ÅŸekilde geri kalmaz. AES gibi ÅŸifreleme gÃ¼cÃ¼ yÃ¼ksek algoritmalara destek veren ve asimetrik ÅŸifrelemeyi uygulayan kartlar bulunmaktadÄ±r.

### SaldÄ±rÄ±

Bu Etiketlere **Flipper Zero ile saldÄ±rabilirsiniz**:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-nfc.md" %}
[fz-nfc.md](../todo/radio-hacking/flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Veya **proxmark** kullanarak:

{% content-ref url="../todo/radio-hacking/proxmark-3.md" %}
[proxmark-3.md](../todo/radio-hacking/proxmark-3.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

* Bir **cybersecurity ÅŸirketinde mi Ã§alÄ±ÅŸÄ±yorsunuz**? **Åirketinizi HackTricks'te reklamÄ±nÄ± yapmak** ister misiniz? veya **PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne eriÅŸmek veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* Ã–zel [**NFT'lerimizden oluÅŸan PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u** takip edin.
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile gÃ¶ndererek paylaÅŸÄ±n.**

</details>
