# ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¼ë°˜ API

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ ì œë¡œì—ì„œ ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ì˜ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks êµ¿ì¦ˆ**](https://peass.creator-spring.com) êµ¬ë§¤
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

---

## ì¼ë°˜

### ë„¤íŠ¸ì›Œí‚¹

| Raw Sockets   | WinAPI Sockets |
| ------------- | -------------- |
| socket()      | WSAStratup()   |
| bind()        | bind()         |
| listen()      | listen()       |
| accept()      | accept()       |
| connect()     | connect()      |
| read()/recv() | recv()         |
| write()       | send()         |
| shutdown()    | WSACleanup()   |

### ì§€ì†ì„±

| ë ˆì§€ìŠ¤íŠ¸ë¦¬         | íŒŒì¼          | ì„œë¹„ìŠ¤                      |
| ---------------- | ------------- | ---------------------------- |
| RegCreateKeyEx() | GetTempPath() | OpenSCManager                |
| RegOpenKeyEx()   | CopyFile()    | CreateService()              |
| RegSetValueEx()  | CreateFile()  | StartServiceCtrlDispatcher() |
| RegDeleteKeyEx() | WriteFile()   |                              |
| RegGetValue()    | ReadFile()    |                              |

### ì•”í˜¸í™”

| ì´ë¦„                  |
| --------------------- |
| WinCrypt              |
| CryptAcquireContext() |
| CryptGenKey()         |
| CryptDeriveKey()      |
| CryptDecrypt()        |
| CryptReleaseContext() |

### ì•ˆí‹°-ë¶„ì„/ê°€ìƒ ë¨¸ì‹ 

| í•¨ìˆ˜ ì´ë¦„                                             | ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ |
| --------------------------------------------------------- | --------------------- |
| IsDebuggerPresent()                                       | CPUID()               |
| GetSystemInfo()                                           | IN()                  |
| GlobalMemoryStatusEx()                                    |                       |
| GetVersion()                                              |                       |
| CreateToolhelp32Snapshot \[í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì—¬ë¶€ í™•ì¸] |                       |
| CreateFileW/A \[íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸]                    |                       |

### ì€ì‹ 

| ì´ë¦„                     |                                                                            |
| ------------------------ | -------------------------------------------------------------------------- |
| VirtualAlloc             | ë©”ëª¨ë¦¬ í• ë‹¹ (íŒ¨ì»¤)                                                     |
| VirtualProtect           | ë©”ëª¨ë¦¬ ê¶Œí•œ ë³€ê²½ (íŒ¨ì»¤ê°€ ì„¹ì…˜ì— ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬) |
| ReadProcessMemory        | ì™¸ë¶€ í”„ë¡œì„¸ìŠ¤ì— ì£¼ì…                                          |
| WriteProcessMemoryA/W    | ì™¸ë¶€ í”„ë¡œì„¸ìŠ¤ì— ì£¼ì…                                          |
| NtWriteVirtualMemory     |                                                                            |
| CreateRemoteThread       | DLL/í”„ë¡œì„¸ìŠ¤ ì£¼ì…...                                                   |
| NtUnmapViewOfSection     |                                                                            |
| QueueUserAPC             |                                                                            |
| CreateProcessInternalA/W |                                                                            |

### ì‹¤í–‰

| í•¨ìˆ˜ ì´ë¦„    |
| ---------------- |
| CreateProcessA/W |
| ShellExecute     |
| WinExec          |
| ResumeThread     |
| NtResumeThread   |

### ê¸°íƒ€

* GetAsyncKeyState() -- í‚¤ ë¡œê¹…
* SetWindowsHookEx -- í‚¤ ë¡œê¹…
* GetForeGroundWindow -- ì‹¤í–‰ ì¤‘ì¸ ì°½ ì´ë¦„(ë˜ëŠ” ë¸Œë¼ìš°ì €ì˜ ì›¹ì‚¬ì´íŠ¸) ê°€ì ¸ì˜¤ê¸°
* LoadLibrary() -- ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°
* GetProcAddress() -- ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°
* CreateToolhelp32Snapshot() -- ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ëª©ë¡
* GetDC() -- ìŠ¤í¬ë¦°ìƒ·
* BitBlt() -- ìŠ¤í¬ë¦°ìƒ·
* InternetOpen(), InternetOpenUrl(), InternetReadFile(), InternetWriteFile() -- ì¸í„°ë„· ì•¡ì„¸ìŠ¤
* FindResource(), LoadResource(), LockResource() -- ì‹¤í–‰ íŒŒì¼ì˜ ë¦¬ì†ŒìŠ¤ ì•¡ì„¸ìŠ¤

## ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ ê¸°ë²•

### DLL ì£¼ì…

ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ì„ì˜ì˜ DLLì„ ì‹¤í–‰

1. ì•…ì„± DLLì„ ì£¼ì…í•  í”„ë¡œì„¸ìŠ¤ ì°¾ê¸°: CreateToolhelp32Snapshot, Process32First, Process32Next
2. í”„ë¡œì„¸ìŠ¤ ì—´ê¸°: GetModuleHandle, GetProcAddress, OpenProcess
3. DLL ê²½ë¡œë¥¼ í”„ë¡œì„¸ìŠ¤ ë‚´ë¶€ì— ì“°ê¸°: VirtualAllocEx, WriteProcessMemory
4. ì•…ì„± DLLì„ ë¡œë“œí•  í”„ë¡œì„¸ìŠ¤ ë‚´ ìŠ¤ë ˆë“œ ìƒì„±: CreateRemoteThread, LoadLibrary

ì‚¬ìš©í•  ë‹¤ë¥¸ í•¨ìˆ˜: NTCreateThreadEx, RtlCreateUserThread

### ë°˜ì‚¬ì  DLL ì£¼ì…

ì¼ë°˜ Windows API í˜¸ì¶œì„ í•˜ì§€ ì•Šê³  ì•…ì„± DLLì„ ë¡œë“œí•©ë‹ˆë‹¤.\
DLLì€ í”„ë¡œì„¸ìŠ¤ ë‚´ì— ë§¤í•‘ë˜ë©°, ê°€ì ¸ì˜¤ê¸° ì£¼ì†Œë¥¼ í•´ê²°í•˜ê³  ì¬ë°°ì¹˜ë¥¼ ìˆ˜ì •í•˜ê³  DllMain í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

### ìŠ¤ë ˆë“œ í•˜ì´ì¬í‚¹

í”„ë¡œì„¸ìŠ¤ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì°¾ì•„ ì•…ì„± DLLì„ ë¡œë“œí•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤.

1. ëŒ€ìƒ ìŠ¤ë ˆë“œ ì°¾ê¸°: CreateToolhelp32Snapshot, Thread32First, Thread32Next
2. ìŠ¤ë ˆë“œ ì—´ê¸°: OpenThread
3. ìŠ¤ë ˆë“œ ì¼ì‹œ ì¤‘ì§€: SuspendThread
4. í”¼í•´ í”„ë¡œì„¸ìŠ¤ ë‚´ ì•…ì„± DLL ê²½ë¡œ ì“°ê¸°: VirtualAllocEx, WriteProcessMemory
5. ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ëŠ” ìŠ¤ë ˆë“œ ì¬ê°œ: ResumeThread

### PE ì£¼ì…

í¬í„°ë¸” ì‹¤í–‰ ì£¼ì…: ì‹¤í–‰ íŒŒì¼ì´ í”¼í•´ í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ì— ì‘ì„±ë˜ê³  ê·¸ê³³ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

### í”„ë¡œì„¸ìŠ¤ í• ë¡œì‰

ì•…ì„± ì½”ë“œë¥¼ ë©”ëª¨ë¦¬ì—ì„œ í•©ë²•ì ì¸ ì½”ë“œë¥¼ ì–¸ë§¤í•‘í•˜ê³  ë¡œë“œí•©ë‹ˆë‹¤.

1. ìƒˆ í”„ë¡œì„¸ìŠ¤ ìƒì„±: CreateProcess
2. ë©”ëª¨ë¦¬ ì–¸ë§¤í•‘: ZwUnmapViewOfSection, NtUnmapViewOfSection
3. ì•…ì„± ì´ì§„ íŒŒì¼ì„ í”„ë¡œì„¸ìŠ¤ ë©”ëª¨ë¦¬ì— ì“°ê¸°: VirtualAllocEc, WriteProcessMemory
4. ì§„ì…ì  ì„¤ì • ë° ì‹¤í–‰: SetThreadContext, ResumeThread

## í›„í‚¹

* **SSDT** (**System Service Descriptor Table**)ëŠ” ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ê°€ ì»¤ë„ í•¨ìˆ˜ (ntoskrnl.exe) ë˜ëŠ” GUI ë“œë¼ì´ë²„ (win32k.sys)ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í…Œì´ë¸”ì„ ê°€ë¦¬í‚µë‹ˆë‹¤.
* ë£¨íŠ¸í‚·ì€ ì´ëŸ¬í•œ í¬ì¸í„°ë¥¼ ìì‹ ì´ ì œì–´í•˜ëŠ” ì£¼ì†Œë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **IRP** (**I/O Request Packets**)ëŠ” ë°ì´í„° ì¡°ê°ì„ í•œ êµ¬ì„± ìš”ì†Œì—ì„œ ë‹¤ë¥¸ êµ¬ì„± ìš”ì†Œë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ì»¤ë„ì˜ ê±°ì˜ ëª¨ë“  ê²ƒì´ IRPë¥¼ ì‚¬ìš©í•˜ë©° ê° ì¥ì¹˜ ê°ì²´ì—ëŠ” í›„í‚¹í•  ìˆ˜ ìˆëŠ” ìì²´ í•¨ìˆ˜ í…Œì´ë¸”ì´ ìˆìŠµë‹ˆë‹¤: DKOM (Direct Kernel Object Manipulation)
* **IAT** (**Import Address Table**)ì€ ì¢…ì†ì„±ì„ í•´ê²°í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. í˜¸ì¶œë  ì½”ë“œë¥¼ íƒˆì·¨í•˜ê¸° ìœ„í•´ ì´ í…Œì´ë¸”ì„ í›„í‚¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **EAT** (**Export Address Table**) í›„í‚¹. ì´ëŸ¬í•œ í›„í‚¹ì€ **ì‚¬ìš©ì ê³µê°„**ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª©í‘œëŠ” DLLì— ì˜í•´ ë‚´ë³´ë‚¸ í•¨ìˆ˜ë¥¼ í›„í‚¹í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
* **ì¸ë¼ì¸ í›„í‚¹**: ì´ ìœ í˜•ì€ ì–´ë µìŠµë‹ˆë‹¤. ì´ëŠ” í•¨ìˆ˜ ì½”ë“œ ìì²´ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì•„ë§ˆë„ ì´ë¥¼ ìœ„í•´ ì‹œì‘ ë¶€ë¶„ì— ì í”„ë¥¼ ë„£ëŠ” ê²ƒì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ ì œë¡œì—ì„œ ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **PDF í˜•ì‹ì˜ HackTricksë¥¼ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks êµ¿ì¦ˆ**](https://peass.creator-spring.com) êµ¬ë§¤
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
  
</details>
* **HackTricks** ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
