# AW2Exec - \_\_malloc\_hook

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

## **Malloc Hook**

ê³µì‹ GNU ì‚¬ì´íŠ¸ì— ë”°ë¥´ë©´, ë³€ìˆ˜ **`__malloc_hook`**ëŠ” `malloc()`ì´ í˜¸ì¶œë  ë•Œë§ˆë‹¤ í˜¸ì¶œë  **í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°**ë¡œ, **libc ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë°ì´í„° ì„¹ì…˜ì— ì €ì¥ë©ë‹ˆë‹¤**. ë”°ë¼ì„œ ì´ ì£¼ì†Œê°€ ì˜ˆë¥¼ ë“¤ì–´ **One Gadget**ìœ¼ë¡œ ë®ì–´ì“°ì—¬ì§€ë©´ `malloc`ì´ í˜¸ì¶œë  ë•Œ **One Gadgetì´ í˜¸ì¶œë©ë‹ˆë‹¤**.

mallocì„ í˜¸ì¶œí•˜ê¸° ìœ„í•´ í”„ë¡œê·¸ë¨ì´ í˜¸ì¶œí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê±°ë‚˜ **`printf("%10000$c")`**ë¥¼ í˜¸ì¶œí•˜ì—¬ ë„ˆë¬´ ë§ì€ ë°”ì´íŠ¸ë¥¼ í• ë‹¹í•˜ì—¬ `libc`ê°€ í™ì— í• ë‹¹í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

One Gadgetì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ” ë‹¤ìŒì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

{% hint style="danger" %}
GLIBC >= 2.34ì—ì„œëŠ” í›…ì´ **ë¹„í™œì„±í™”**ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ìµœì‹  GLIBC ë²„ì „ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ê¸°ìˆ ì´ ìˆìŠµë‹ˆë‹¤. [https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
{% endhint %}

## References

* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)
* [https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
