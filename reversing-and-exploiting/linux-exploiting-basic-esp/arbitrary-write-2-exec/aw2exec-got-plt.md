# AW2Exec - GOT/PLT

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## **Osnovne informacije**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)** je mehanizam koji se koristi u dinamiÄki povezanim binarnim datotekama za upravljanje **adresama spoljaÅ¡njih funkcija**. PoÅ¡to su te **adrese nepoznate do vremena izvrÅ¡avanja** (zbog dinamiÄkog povezivanja), GOT pruÅ¾a naÄin da se **dinamiÄki aÅ¾uriraju adrese ovih spoljaÅ¡njih simbola** kada se jednom reÅ¡e.

Svaki unos u GOT odgovara simbolu u spoljnim bibliotekama koje binarna datoteka moÅ¾e pozvati. Kada se **funkcija prvi put pozove, njena stvarna adresa se reÅ¡ava putem dinamiÄkog linker-a i Äuva u GOT-u**. Naknadni pozivi iste funkcije koriste adresu koja je saÄuvana u GOT-u, Äime se izbegava preoptereÄ‡enje ponovnog reÅ¡avanja adrese.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)** blisko saraÄ‘uje sa GOT-om i sluÅ¾i kao trampolin za upravljanje pozivima spoljaÅ¡njim funkcijama. Kada binarna datoteka **pozove spoljaÅ¡nju funkciju prvi put, kontrola se prenosi na unos u PLT-u povezan sa tom funkcijom**. Ovaj PLT unos je odgovoran za pozivanje dinamiÄkog linker-a da reÅ¡i adresu funkcije ako veÄ‡ nije reÅ¡ena. Nakon Å¡to se adresa reÅ¡i, ona se Äuva u GOT-u.

**Dakle,** GOT unosi se koriste direktno kada se adresa spoljaÅ¡nje funkcije ili promenljive reÅ¡i. **PLT unosi se koriste za olakÅ¡avanje inicijalnog reÅ¡avanja** ovih adresa putem dinamiÄkog linker-a.

## Dobijanje izvrÅ¡enja

### Proverite GOT

Dobijte adresu do GOT tabele sa: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

Posmatrajte kako nakon **uÄitavanja** **izvrÅ¡ne datoteke** u GEF moÅ¾ete **videti** **funkcije** koje se nalaze u **GOT-u**: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

KoristeÄ‡i GEF moÅ¾ete **poÄeti** sesiju **debugovanja** i izvrÅ¡iti **`got`** da vidite got tabelu:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

U binarnoj datoteci GOT ima **adrese do funkcija ili** do **PLT** sekcije koja Ä‡e uÄitati adresu funkcije. Cilj ovog proizvoljnog pisanja je da **prepiÅ¡e GOT unos** funkcije koja Ä‡e biti izvrÅ¡ena kasnije **sa** **adresom** PLT-a **`system`** **funkcije** na primer.

Idealan scenario je da **prepiÅ¡ete** **GOT** funkcije koja Ä‡e **biti pozvana sa parametrima koje kontroliÅ¡ete** (tako da Ä‡ete moÄ‡i da kontroliÅ¡ete parametre poslati sistemskoj funkciji).

Ako **`system`** **nije koriÅ¡Ä‡en** od strane skripte, sistemska funkcija **neÄ‡e** imati unos u PLT-u. U ovom scenariju, prvo Ä‡ete **morati da iscurite adresu** funkcije `system` i zatim prepisati GOT da pokazuje na ovu adresu.

MoÅ¾ete videti PLT adrese sa **`objdump -j .plt -d ./vuln_binary`**

## **Jedan Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **ZaÅ¡tite**

ZaÅ¡tita **Full RELRO** je namenjena zaÅ¡titi od ove vrste tehnike reÅ¡avanjem svih adresa funkcija kada se binarna datoteka pokrene i ÄineÄ‡i **GOT tabelu samo za Äitanje** nakon toga:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Reference

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
