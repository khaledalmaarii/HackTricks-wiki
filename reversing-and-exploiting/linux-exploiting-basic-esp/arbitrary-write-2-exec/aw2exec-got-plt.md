# AW2Exec - GOT/PLT

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlantÄ±lÄ± ikili dosyalarda **harici fonksiyonlarÄ±n adreslerini** yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r. Bu **adresler Ã§alÄ±ÅŸma zamanÄ±nda** (dinamik baÄŸlantÄ± nedeniyle) bilinmediÄŸinden, GOT, bu harici sembollerin adreslerini **dinamik olarak gÃ¼ncellemenin** bir yolunu saÄŸlar.

GOT'taki her giriÅŸ, ikili dosyanÄ±n Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. Bir **fonksiyon ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, gerÃ§ek adresi dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan Ã§Ã¶zÃ¼lÃ¼r ve GOT'a kaydedilir**. AynÄ± fonksiyona yapÄ±lan sonraki Ã§aÄŸrÄ±lar, GOT'ta saklanan adresi kullanÄ±r ve bÃ¶ylece adresin tekrar Ã§Ã¶zÃ¼lmesi iÃ§in gereken yÃ¼kten kaÃ§Ä±nÄ±lÄ±r.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici fonksiyonlara yapÄ±lan Ã§aÄŸrÄ±larÄ± yÃ¶netmek iÃ§in bir trampolin gÃ¶revi gÃ¶rÃ¼r. Bir ikili dosya **ilk kez bir harici fonksiyonu Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol o fonksiyonla iliÅŸkili PLT'deki bir giriÅŸe geÃ§er**. Bu PLT giriÅŸi, fonksiyonun adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur, eÄŸer bu adres daha Ã¶nce Ã§Ã¶zÃ¼lmemiÅŸse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra, GOT'a kaydedilir.

**Bu nedenle,** GOT giriÅŸleri, bir harici fonksiyon veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla ilk Ã§Ã¶zÃ¼mlemesini kolaylaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.**

## Ä°cra Alma

### GOT'u Kontrol Et

GOT tablosunun adresini almak iÃ§in: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

GEF'de **yÃ¼rÃ¼tÃ¼lebilir dosyayÄ± yÃ¼kledikten sonra** **GOT'taki** **fonksiyonlarÄ±** **gÃ¶rebileceÄŸinizi** gÃ¶zlemleyin: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

GEF kullanarak bir **hata ayÄ±klama** oturumu **baÅŸlatabilir** ve GOT tablosunu gÃ¶rmek iÃ§in **`got`** komutunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

Bir ikili dosyada GOT, **fonksiyonlarÄ±n adreslerini** veya **PLT** bÃ¶lÃ¼mÃ¼ne yÃ¼kleyecek olan fonksiyon adreslerini iÃ§erir. Bu keyfi yazmanÄ±n amacÄ±, daha sonra **Ã§alÄ±ÅŸtÄ±rÄ±lacak** bir fonksiyonun **GOT giriÅŸini** **`system`** **fonksiyonunun PLT adresiyle** Ã¶rneÄŸin **geÃ§ersiz kÄ±lmaktÄ±r.**

Ä°deal olarak, **kontrol ettiÄŸiniz parametrelerle** **Ã§aÄŸrÄ±lacak** bir **fonksiyonun** **GOT'unu** **geÃ§ersiz kÄ±lacaksÄ±nÄ±z** (bÃ¶ylece sistem fonksiyonuna gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer **`system`** **script tarafÄ±ndan kullanÄ±lmÄ±yorsa**, sistem fonksiyonu **PLT'de** bir giriÅŸe sahip **olmayacaktÄ±r**. Bu senaryoda, Ã¶nce **`system`** fonksiyonunun adresini **sÄ±zdÄ±rmanÄ±z** ve ardÄ±ndan GOT'u bu adrese iÅŸaret edecek ÅŸekilde geÃ§ersiz kÄ±lmanÄ±z gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** ile gÃ¶rebilirsiniz.

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Koruma**

**Full RELRO** korumasÄ±, ikili dosya baÅŸlatÄ±ldÄ±ÄŸÄ±nda fonksiyonlarÄ±n tÃ¼m adreslerini Ã§Ã¶zerek ve sonrasÄ±nda **GOT tablosunu yalnÄ±zca okunur** hale getirerek bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlamayÄ± amaÃ§lar:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referanslar

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
