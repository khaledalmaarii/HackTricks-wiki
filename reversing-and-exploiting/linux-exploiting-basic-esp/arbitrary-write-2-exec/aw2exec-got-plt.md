# AW2Exec - GOT/PLT

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Basic Information**

### **GOT: Global Offset Table**

**рдЧреНрд▓реЛрдмрд▓ рдСрдлрд╕реЗрдЯ рдЯреЗрдмрд▓ (GOT)** рдПрдХ рддрдВрддреНрд░ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рд▓рд┐рдВрдХ рдХрд┐рдП рдЧрдП рдмрд╛рдЗрдирд░реА рдореЗрдВ **рдмрд╛рд╣рд░реА рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкрддреЗ** рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рдпреЗ **рдкрддреЗ рд░рдирдЯрд╛рдЗрдо рддрдХ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рд╣реЛрддреЗ** (рдЧрддрд┐рд╢реАрд▓ рд▓рд┐рдВрдХрд┐рдВрдЧ рдХреЗ рдХрд╛рд░рдг), GOT рдПрдХ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ **рдЗрди рдмрд╛рд╣рд░реА рдкреНрд░рддреАрдХреЛрдВ рдХреЗ рдкрддреЗ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ** рдЬрдм рд╡реЗ рд╣рд▓ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред

GOT рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЙрд╕ рдкреНрд░рддреАрдХ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИ рдЬреЛ рдмрд╛рд╣рд░реА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕реЗ рдмрд╛рдЗрдирд░реА рдХреЙрд▓ рдХрд░ рд╕рдХрддреА рд╣реИред рдЬрдм рдПрдХ **рдХрд╛рд░реНрдп рдкрд╣рд▓реА рдмрд╛рд░ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрддрд╛ рдЧрддрд┐рд╢реАрд▓ рд▓рд┐рдВрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЙрд╕реА рдХрд╛рд░реНрдп рдХреЛ рдмрд╛рдж рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдкрд░ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдлрд┐рд░ рд╕реЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХрд╛ рдУрд╡рд░рд╣реЗрдб рдмрдЪрддрд╛ рд╣реИред

### **PLT: Procedure Linkage Table**

**рдкреНрд░реЛрд╕реАрдЬрд░ рд▓рд┐рдВрдХрд┐рдВрдЧ рдЯреЗрдмрд▓ (PLT)** GOT рдХреЗ рд╕рд╛рде рдирд┐рдХрдЯрддрд╛ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмрд╛рд╣рд░реА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рдореНрдкреЛрд▓рд┐рди рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред рдЬрдм рдПрдХ рдмрд╛рдЗрдирд░реА **рдкрд╣рд▓реА рдмрд╛рд░ рдПрдХ рдмрд╛рд╣рд░реА рдХрд╛рд░реНрдп рдХреЛ рдХреЙрд▓ рдХрд░рддреА рд╣реИ, рддреЛ рдирд┐рдпрдВрддреНрд░рдг рдЙрд╕ рдХрд╛рд░реНрдп рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд PLT рдореЗрдВ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ PLT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЙрд╕ рдХрд╛рд░реНрдп рдХреЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧрддрд┐рд╢реАрд▓ рд▓рд┐рдВрдХрд░реНрд╕ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддреА рд╣реИ рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣рд▓ рдирд╣реАрдВ рд╣реБрдЖ рд╣реИред рдкрддреЗ рдХреЗ рд╣рд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЗрд╕реЗ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**рдЗрд╕рд▓рд┐рдП,** GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдзреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдмрд╛рд╣рд░реА рдХрд╛рд░реНрдп рдпрд╛ рдЪрд░ рдХрд╛ рдкрддрд╛ рд╣рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред **PLT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрди рдкрддреЗ рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕рдорд╛рдзрд╛рди рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдЧрддрд┐рд╢реАрд▓ рд▓рд┐рдВрдХрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

## Get Execution

### Check the GOT

GOT рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

рджреЗрдЦреЗрдВ рдХрд┐ **GEF** рдореЗрдВ **рдХрд╛рд░реНрдпрдХрд╛рд░реА** рдХреЛ **рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж** рдЖрдк **GOT** рдореЗрдВ **рдХрд╛рд░реНрдп** рдХреИрд╕реЗ **рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**: `gefтЮд x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдбрд┐рдмрдЧрд┐рдВрдЧ** рд╕рддреНрд░ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ GOT рддрд╛рд▓рд┐рдХрд╛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП **`got`** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

рдПрдХ рдмрд╛рдЗрдирд░реА рдореЗрдВ GOT рдХреЗ рдкрд╛рд╕ **рдХрд╛рд░реНрдп рдХреЗ рдкрддреЗ рдпрд╛** PLT рдЕрдиреБрднрд╛рдЧ рдХреЗ рдкрддреЗ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдХрд╛рд░реНрдп рдХреЗ рдкрддреЗ рдХреЛ рд▓реЛрдб рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдордирдорд╛рдиреЗ рд▓реЗрдЦрди рдХрд╛ рд▓рдХреНрд╖реНрдп рдПрдХ рдХрд╛рд░реНрдп рдХреЗ GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛** рд╣реИ рдЬрд┐рд╕реЗ рдмрд╛рдж рдореЗрдВ **`system`** **рдХрд╛рд░реНрдп** рдХреЗ PLT рдХреЗ **рдкрддреЗ** рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдПред

рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рдЖрдк рдЙрд╕ **рдХрд╛рд░реНрдп** рдХреЗ **GOT** рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдб** рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ **рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рддрд╛рдХрд┐ рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдХрд╛рд░реНрдп рдХреЛ рднреЗрдЬреЗ рдЧрдП рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХреЗрдВ)ред

рдпрджрд┐ **`system`** **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдХрд╛рд░реНрдп рдХрд╛ **PLT рдореЗрдВ** рдХреЛрдИ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рд╣реЛрдЧреАред рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ `system` рдХрд╛рд░реНрдп рдХрд╛ рдкрддрд╛ **рд▓реАрдХ** рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдлрд┐рд░ GOT рдХреЛ рдЗрд╕ рдкрддреЗ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдЖрдк PLT рдкрддреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: **`objdump -j .plt -d ./vuln_binary`**

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Protections**

**рдкреВрд░реНрдг RELRO** рд╕реБрд░рдХреНрд╖рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рддрдХрдиреАрдХ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдИ рдЧрдИ рд╣реИ, рдЬреЛ рдмрд╛рдЗрдирд░реА рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░ рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рддреА рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж **GOT рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдмрдирд╛ рджреЗрддреА рд╣реИ:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## References

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
