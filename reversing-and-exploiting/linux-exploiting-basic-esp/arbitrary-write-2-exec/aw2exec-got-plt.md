# AW2Exec - GOT/PLT

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## **Podstawowe informacje**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)** to mechanizm uÅ¼ywany w dynamicznie linkowanych binariach do zarzÄ…dzania **adresami funkcji zewnÄ™trznych**. PoniewaÅ¼ te **adresy nie sÄ… znane do czasu uruchomienia** (z powodu dynamicznego linkowania), GOT zapewnia sposÃ³b na **dynamiczne aktualizowanie adresÃ³w tych zewnÄ™trznych symboli** po ich rozwiÄ…zaniu.

KaÅ¼dy wpis w GOT odpowiada symbolowi w zewnÄ™trznych bibliotekach, ktÃ³re moÅ¼e wywoÅ‚aÄ‡ binarne. Gdy **funkcja jest wywoÅ‚ywana po raz pierwszy, jej rzeczywisty adres jest rozwiÄ…zywany przez dynamiczny linker i przechowywany w GOT**. Kolejne wywoÅ‚ania tej samej funkcji korzystajÄ… z adresu przechowywanego w GOT, unikajÄ…c w ten sposÃ³b narzutu zwiÄ…zanego z ponownym rozwiÄ…zywaniem adresu.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)** dziaÅ‚a blisko z GOT i sÅ‚uÅ¼y jako trampolina do obsÅ‚ugi wywoÅ‚aÅ„ funkcji zewnÄ™trznych. Gdy binarne **wywoÅ‚uje funkcjÄ™ zewnÄ™trznÄ… po raz pierwszy, kontrola jest przekazywana do wpisu w PLT powiÄ…zanego z tÄ… funkcjÄ…**. Ten wpis PLT jest odpowiedzialny za wywoÅ‚anie dynamicznego linkera w celu rozwiÄ…zania adresu funkcji, jeÅ›li nie zostaÅ‚ on jeszcze rozwiÄ…zany. Po rozwiÄ…zaniu adresu jest on przechowywany w GOT.

**Dlatego** wpisy GOT sÄ… uÅ¼ywane bezpoÅ›rednio, gdy adres funkcji lub zmiennej zewnÄ™trznej jest rozwiÄ…zany. **Wpisy PLT sÄ… uÅ¼ywane do uÅ‚atwienia poczÄ…tkowego rozwiÄ…zania** tych adresÃ³w za poÅ›rednictwem dynamicznego linkera.

## Uzyskaj wykonanie

### SprawdÅº GOT

Uzyskaj adres do tabeli GOT za pomocÄ…: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

ZauwaÅ¼, jak po **zaÅ‚adowaniu** **wykonywalnego** w GEF moÅ¼esz **zobaczyÄ‡** **funkcje**, ktÃ³re sÄ… w **GOT**: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

KorzystajÄ…c z GEF, moÅ¼esz **rozpoczÄ…Ä‡** sesjÄ™ **debugowania** i wykonaÄ‡ **`got`**, aby zobaczyÄ‡ tabelÄ™ got:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

W binarnym GOT ma **adresy do funkcji lub** do sekcji **PLT**, ktÃ³ra zaÅ‚aduje adres funkcji. Celem tego dowolnego zapisu jest **nadpisanie wpisu GOT** funkcji, ktÃ³ra ma byÄ‡ wykonana pÃ³Åºniej **z** **adresem** PLT funkcji **`system`** na przykÅ‚ad.

Idealnie, powinieneÅ› **nadpisaÄ‡** **GOT** funkcji, ktÃ³ra **ma byÄ‡ wywoÅ‚ana z parametrami kontrolowanymi przez Ciebie** (abyÅ› mÃ³gÅ‚ kontrolowaÄ‡ parametry wysyÅ‚ane do funkcji systemowej).

JeÅ›li **`system`** **nie jest uÅ¼ywany** przez skrypt, funkcja systemowa **nie bÄ™dzie miaÅ‚a** wpisu w PLT. W tym scenariuszu bÄ™dziesz **musiaÅ‚ najpierw wycieknÄ…Ä‡ adres** funkcji `system`, a nastÄ™pnie nadpisaÄ‡ GOT, aby wskazywaÅ‚ na ten adres.

MoÅ¼esz zobaczyÄ‡ adresy PLT za pomocÄ… **`objdump -j .plt -d ./vuln_binary`**

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Ochrony**

Ochrona **Full RELRO** ma na celu ochronÄ™ przed tego rodzaju technikÄ… poprzez rozwiÄ…zanie wszystkich adresÃ³w funkcji, gdy binarne jest uruchamiane i uczynienie **tabeli GOT tylko do odczytu** po tym:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referencje

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
