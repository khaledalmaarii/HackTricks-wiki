# AW2Exec - GOT/PLT

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks** (https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlanmÄ±ÅŸ ikili dosyalarda **harici iÅŸlevlerin adreslerini yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r**. Bu adresler, **Ã§alÄ±ÅŸma zamanÄ±nda bilinmediÄŸinden** (dinamik baÄŸlantÄ± nedeniyle) GOT, bu harici sembollerin adreslerini **Ã§Ã¶zÃ¼ldÃ¼kten sonra dinamik olarak gÃ¼ncellemek iÃ§in bir yol saÄŸlar**.

GOT'taki her giriÅŸ, ikili dosyanÄ±n Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. **Bir iÅŸlev ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, gerÃ§ek adresi dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan Ã§Ã¶zÃ¼lÃ¼r ve GOT'ta depolanÄ±r**. AynÄ± iÅŸlevin sonraki Ã§aÄŸrÄ±larÄ±, GOT'ta depolanan adresi kullanÄ±r, bÃ¶ylece adresi tekrar Ã§Ã¶zme gereksiniminden kaÃ§Ä±nÄ±lÄ±r.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici iÅŸlevlere yapÄ±lan Ã§aÄŸrÄ±larÄ± iÅŸlemek iÃ§in bir trambolin olarak hizmet eder. Bir ikili **harici bir iÅŸlevi ilk kez Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol o iÅŸlevle iliÅŸkilendirilmiÅŸ PLT giriÅŸine geÃ§er**. Bu PLT giriÅŸi, iÅŸlevin adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur eÄŸer daha Ã¶nce Ã§Ã¶zÃ¼lmediyse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra GOT'ta depolanÄ±r.

**Bu nedenle,** harici bir iÅŸlevin veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde GOT giriÅŸleri doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin baÅŸlangÄ±Ã§ta Ã§Ã¶zÃ¼lmesini** dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla kolaylaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.

## YÃ¼rÃ¼tme Al

### GOT'u Kontrol Et

**`objdump -s -j .got ./exec`** ile GOT tablosunun adresini alÄ±n

![](<../../../.gitbook/assets/image (619).png>)

GEF'de **yÃ¼rÃ¼tÃ¼lebilir** dosyayÄ± **yÃ¼kledikten** sonra GOT'ta **bulunan** **iÅŸlevleri gÃ¶rebilirsiniz**: `gefâ¤ x/20x 0xDIR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

GEF kullanarak **hata ayÄ±klama** oturumu baÅŸlatabilir ve **`got`** komutunu Ã§alÄ±ÅŸtÄ±rarak got tablosunu gÃ¶rebilirsiniz:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

Bir ikili dosyada GOT, **iÅŸlevlerin adreslerine veya** iÅŸlev adresini yÃ¼kleyecek olan **PLT** bÃ¶lÃ¼mÃ¼ne sahiptir. Bu keyfi yazmanÄ±n amacÄ±, daha sonra **Ã§alÄ±ÅŸtÄ±rÄ±lacak bir iÅŸlevin GOT giriÅŸini** deÄŸiÅŸtirmektir **Ã¶rneÄŸin** `system` **iÅŸlevinin PLT adresiyle**.

Ä°deal olarak, **kontrolÃ¼nÃ¼zdeki parametrelerle Ã§aÄŸrÄ±lacak bir iÅŸlevin GOT'unu** **Ã¼zerine yazacaksÄ±nÄ±z** (bÃ¶ylece sistem iÅŸlevine gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer **`system`** **kullanÄ±lmÄ±yorsa** betik tarafÄ±ndan, sistem iÅŸlevinin **PLT'de bir giriÅŸi olmayacak**. Bu senaryoda, `system` iÅŸlevinin adresini sÄ±zdÄ±rmanÄ±z ve ardÄ±ndan GOT'u bu adrese iÅŸaret etmek iÃ§in Ã¼zerine yazmanÄ±z gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** ile gÃ¶rebilirsiniz

## **Koruma**

**FullRELRO** korumasÄ±, ikili baÅŸlatÄ±ldÄ±ÄŸÄ±nda tÃ¼m iÅŸlevlerin adreslerini Ã§Ã¶zerek ve ardÄ±ndan **GOT tablosunu salt okunur hale getirerek** bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlar:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**]'na gÃ¶z atÄ±n (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks** (https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
