# AWS2Exec - .dtors & .fini\_array

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## .dtors

{% hint style="danger" %}
å¦‚ä»Šæ‰¾åˆ°ä¸€ä¸ªå¸¦æœ‰ .dtors æ®µçš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯éå¸¸ **å¥‡æ€ªçš„**ã€‚
{% endhint %}

ææ„å‡½æ•°æ˜¯åœ¨ç¨‹åºç»“æŸä¹‹å‰ï¼ˆåœ¨ `main` å‡½æ•°è¿”å›åï¼‰**æ‰§è¡Œçš„å‡½æ•°**ã€‚\
è¿™äº›å‡½æ•°çš„åœ°å€å­˜å‚¨åœ¨äºŒè¿›åˆ¶æ–‡ä»¶çš„ **`.dtors`** æ®µä¸­ï¼Œå› æ­¤ï¼Œå¦‚æœä½ è®¾æ³•å°† **åœ°å€** å†™å…¥ **`__DTOR_END__`** çš„ **shellcode** ä¸­ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨ç¨‹åºç»“æŸä¹‹å‰è¢« **æ‰§è¡Œ**ã€‚

è·å–æ­¤æ®µçš„åœ°å€ï¼š
```bash
objdump -s -j .dtors /exec
rabin -s /exec | grep â€œ__DTORâ€
```
é€šå¸¸ä½ ä¼šå‘ç° **DTOR** æ ‡è®° **åœ¨** å€¼ `ffffffff` å’Œ `00000000` ä¹‹é—´ã€‚æ‰€ä»¥å¦‚æœä½ åªçœ‹åˆ°è¿™äº›å€¼ï¼Œè¿™æ„å‘³ç€ **æ²¡æœ‰æ³¨å†Œä»»ä½•å‡½æ•°**ã€‚æ‰€ä»¥ **ç”¨** **shellcode** çš„ **åœ°å€** **è¦†ç›–** **`00000000`** ä»¥æ‰§è¡Œå®ƒã€‚

{% hint style="warning" %}
å½“ç„¶ï¼Œä½ é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ª **å­˜å‚¨ shellcode çš„åœ°æ–¹** ä»¥ä¾¿ç¨åè°ƒç”¨å®ƒã€‚
{% endhint %}

## **.fini\_array**

æœ¬è´¨ä¸Šè¿™æ˜¯ä¸€ä¸ªåŒ…å« **åœ¨ç¨‹åºç»“æŸå‰å°†è¢«è°ƒç”¨çš„å‡½æ•°** çš„ç»“æ„ï¼Œåƒ **`.dtors`** ä¸€æ ·ã€‚å¦‚æœä½ å¯ä»¥é€šè¿‡ **è·³è½¬åˆ°ä¸€ä¸ªåœ°å€** æ¥è°ƒç”¨ä½ çš„ **shellcode**ï¼Œæˆ–è€…åœ¨éœ€è¦ **å†æ¬¡è¿”å› `main`** ä»¥ **ç¬¬äºŒæ¬¡åˆ©ç”¨æ¼æ´** çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸€ç‚¹å¾ˆæœ‰è¶£ã€‚
```bash
objdump -s -j .fini_array ./greeting

./greeting:     file format elf32-i386

Contents of section .fini_array:
8049934 a0850408

#Put your address in 0x8049934
```
æ³¨æ„ï¼Œè¿™**ä¸ä¼š****åˆ›å»º**ä¸€ä¸ª**æ°¸æ’å¾ªç¯**ï¼Œå› ä¸ºå½“ä½ è¿”å›åˆ°ä¸»å‡½æ•°æ—¶ï¼Œé‡‘ä¸é›€ä¼šæ³¨æ„åˆ°ï¼Œæ ˆçš„æœ«å°¾å¯èƒ½ä¼šè¢«ç ´åï¼Œå‡½æ•°å°†ä¸ä¼šå†æ¬¡è¢«è°ƒç”¨ã€‚å› æ­¤ï¼Œé€šè¿‡è¿™ä¸ªä½ å°†èƒ½å¤Ÿ**å†æ‰§è¡Œä¸€æ¬¡**æ¼æ´ã€‚

{% hint style="danger" %}
æ³¨æ„ï¼Œåœ¨[Full RELRO](../common-binary-protections-and-bypasses/relro.md)ä¸‹ï¼Œ`.fini_array`éƒ¨åˆ†è¢«è®¾ç½®ä¸º**åªè¯»**ã€‚
{% endhint %}

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–**å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
