# AWS2Exec - .dtors & .fini\_array

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

## .dtors

{% hint style="danger" %}
ìš”ì¦˜ì€ **.dtors ì„¹ì…˜ì´ ìˆëŠ” ë°”ì´ë„ˆë¦¬ë¥¼ ì°¾ëŠ” ê²ƒì´ ë§¤ìš° ì´ìƒí•©ë‹ˆë‹¤**.
{% endhint %}

ì†Œë©¸ìëŠ” í”„ë¡œê·¸ë¨ì´ **ëë‚˜ê¸° ì „ì— ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜**ì…ë‹ˆë‹¤ ( `main` í•¨ìˆ˜ê°€ ë°˜í™˜ëœ í›„).\
ì´ í•¨ìˆ˜ë“¤ì˜ ì£¼ì†ŒëŠ” ë°”ì´ë„ˆë¦¬ì˜ **`.dtors`** ì„¹ì…˜ì— ì €ì¥ë˜ë©°, ë”°ë¼ì„œ **`__DTOR_END__`**ì— **ì£¼ì†Œ**ë¥¼ **shellcode**ë¡œ **ì“°ê¸°**ì— ì„±ê³µí•˜ë©´, í”„ë¡œê·¸ë¨ì´ ëë‚˜ê¸° ì „ì— **ì‹¤í–‰ë©ë‹ˆë‹¤**.

ì´ ì„¹ì…˜ì˜ ì£¼ì†Œë¥¼ ì–»ìœ¼ë ¤ë©´:
```bash
objdump -s -j .dtors /exec
rabin -s /exec | grep â€œ__DTORâ€
```
ë³´í†µ **DTOR** ë§ˆì»¤ëŠ” `ffffffff`ê³¼ `00000000` ê°’ **ì‚¬ì´**ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ëŸ¬í•œ ê°’ì„ ë³´ë©´ **ë“±ë¡ëœ í•¨ìˆ˜ê°€ ì—†ë‹¤ëŠ”** ì˜ë¯¸ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ **`00000000`**ì„ **ì‹¤í–‰í•  shellcodeì˜ ì£¼ì†Œ**ë¡œ **ë®ì–´ì”Œìš°ì‹­ì‹œì˜¤**.

{% hint style="warning" %}
ë¬¼ë¡ , ë¨¼ì € **shellcodeë¥¼ ì €ì¥í•  ì¥ì†Œ**ë¥¼ ì°¾ì•„ì•¼ ë‚˜ì¤‘ì— í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

## **.fini\_array**

ë³¸ì§ˆì ìœ¼ë¡œ ì´ê²ƒì€ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ê¸° ì „ì— **í˜¸ì¶œë  í•¨ìˆ˜ë“¤**ë¡œ êµ¬ì„±ëœ êµ¬ì¡°ì²´ì…ë‹ˆë‹¤. ì´ëŠ” **`.dtors`**ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤. ì£¼ì†Œë¡œ ì í”„í•˜ì—¬ **shellcodeë¥¼ í˜¸ì¶œ**í•  ìˆ˜ ìˆê±°ë‚˜, **ì·¨ì•½ì ì„ ë‘ ë²ˆì§¸ë¡œ ì•…ìš©í•˜ê¸° ìœ„í•´ ë‹¤ì‹œ `main`ìœ¼ë¡œ ëŒì•„ê°€ì•¼ í•˜ëŠ”** ê²½ìš°ì— í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤.
```bash
objdump -s -j .fini_array ./greeting

./greeting:     file format elf32-i386

Contents of section .fini_array:
8049934 a0850408

#Put your address in 0x8049934
```
Note that this **won't** **create** an **eternal loop** because when you get back to main the canary will notice, the end of the stack might be corrupted and the function won't be recalled again. So with this you will be able to **have 1 more execution** of the vuln.

{% hint style="danger" %}
Note that with [Full RELRO](../common-binary-protections-and-bypasses/relro.md), the section `.fini_array` is made **read-only**.
{% endhint %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
