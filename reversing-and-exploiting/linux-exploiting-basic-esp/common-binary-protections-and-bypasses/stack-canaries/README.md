# Stack Canaries

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **StackGuard and StackShield**

**StackGuard** рдПрдХ рд╡рд┐рд╢реЗрд╖ рдорд╛рди рдЬрд┐рд╕реЗ **canary** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреЛ **EIP (Extended Instruction Pointer)** рд╕реЗ рдкрд╣рд▓реЗ рдбрд╛рд▓рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `0x000aff0d` (рдЬреЛ null, newline, EOF, carriage return рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ) рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдПред рд╣рд╛рд▓рд╛рдБрдХрд┐, `recv()`, `memcpy()`, `read()`, рдФрд░ `bcopy()` рдЬреИрд╕реА рдлрд╝рдВрдХреНрд╢рди рдХрдордЬреЛрд░ рд░рд╣рддреА рд╣реИрдВ, рдФрд░ рдпрд╣ **EBP (Base Pointer)** рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

**StackShield** StackGuard рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХ рдкрд░рд┐рд╖реНрдХреГрдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ **Global Return Stack** рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рд╕рднреА рд░рд┐рдЯрд░реНрди рдкрддреЗ (**EIPs**) рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реЗрдЯрдЕрдк рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рднреА рдУрд╡рд░рдлреНрд▓реЛ рдиреБрдХрд╕рд╛рди рдирд╣реАрдВ рдкрд╣реБрдБрдЪрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрдЧреНрд░рд╣реАрдд рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░рд┐рдЯрд░реНрди рдкрддреЗ рдХреЗ рдмреАрдЪ рддреБрд▓рдирд╛ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдУрд╡рд░рдлреНрд▓реЛ рдХреА рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, StackShield рд░рд┐рдЯрд░реНрди рдкрддреЗ рдХреА рдЬрд╛рдВрдЪ рдПрдХ рд╕реАрдорд╛ рдорд╛рди рдХреЗ рдЦрд┐рд▓рд╛рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдХреНрдпрд╛ **EIP** рдЕрдкреЗрдХреНрд╖рд┐рдд рдбреЗрдЯрд╛ рд╕реНрдерд╛рди рдХреЗ рдмрд╛рд╣рд░ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ Return-to-libc, ROP (Return-Oriented Programming), рдпрд╛ ret2ret рдЬреИрд╕реА рддрдХрдиреАрдХреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ StackShield рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдХреА рднреА рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

## **Stack Smash Protector (ProPolice) `-fstack-protector`:**

рдпрд╣ рддрдВрддреНрд░ **EBP** рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ **canary** рд░рдЦрддрд╛ рд╣реИ, рдФрд░ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдХреЛ рдкреБрдирд░реНрдЧрдард┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрдлрд░ рдХреЛ рдЙрдЪреНрдЪ рдореЗрдореЛрд░реА рдкрддреЗ рдкрд░ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рд╕реЗ рд╡реЗ рдЕрдиреНрдп рдЪрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХреЗрдВред рдпрд╣ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдХреЗ рдКрдкрд░ рд╕реНрдЯреИрдХ рдкрд░ рдкрд╛рд╕ рдХрд┐рдП рдЧрдП рддрд░реНрдХреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдХреЙрдкреА рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрди рдХреЙрдкрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рддрд░реНрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ 8 рддрддреНрд╡реЛрдВ рд╕реЗ рдХрдо рд╡рд╛рд▓реЗ рдРрд░реЗ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рднреАрддрд░ рдмрдлрд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

**canary** рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ рдЬреЛ `/dev/urandom` рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдпрд╛ рдЗрд╕рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди `0xff0a0000` рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ **TLS (Thread Local Storage)** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдереНрд░реЗрдбреНрд╕ рдХреЗ рдмреАрдЪ рд╕рд╛рдЭрд╛ рдореЗрдореЛрд░реА рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдереНрд░реЗрдб-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡реИрд╢реНрд╡рд┐рдХ рдпрд╛ рд╕реНрдерд┐рд░ рдЪрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рдЪрд░ рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдХреЙрдкреА рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдмрд╛рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдмрд┐рдирд╛ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдпрд╛ рднрд╛рдИ-рдмрд╣рдиреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдП рдмрджрд▓ рд╕рдХрддреА рд╣реИрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ **`fork()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд┐рдирд╛ рдирдП canary рдмрдирд╛рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ (рдорд╛рддрд╛-рдкрд┐рддрд╛ рдФрд░ рдмрдЪреНрдЪреЗ) рдПрдХ рд╣реА canary рд╕рд╛рдЭрд╛ рдХрд░рддреА рд╣реИрдВ**, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдХрдордЬреЛрд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред **i386** рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдкрд░, canary `gs:0x14` рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ, рдФрд░ **x86\_64** рдкрд░, `fs:0x28` рдкрд░ред

рдпрд╣ рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдЙрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреА рд╣реИ рдЬрд┐рдирдореЗрдВ рдмрдлрд░ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреА рд╣реИ рддрд╛рдХрд┐ canary рдХреЛ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдЕрдВрдд рдореЗрдВ рдЗрд╕рдХреА рдЕрдЦрдВрдбрддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдЬрдм рдПрдХ рд╡реЗрдм рд╕рд░реНрд╡рд░ `fork()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ canary рдмрд╛рдЗрдЯ рдХреЛ рдмрд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, `fork()` рдХреЗ рдмрд╛рдж `execve()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдореЗрдореЛрд░реА рд╕реНрдерд╛рди рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓реЗ рдХреЛ рдирдХрд╛рд░рд╛ рдЬрд╛рддрд╛ рд╣реИред `vfork()` рдмрд╛рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмрд┐рдирд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдирд╣реАрдВ рдХрд░рддрд╛, рдЬрд┐рд╕ рдмрд┐рдВрджреБ рдкрд░ рдПрдХ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдореЗрдореЛрд░реА рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

### Lengths

`x64` рдмрд╛рдЗрдирд░реА рдореЗрдВ, canary рдХреБрдХреА рдПрдХ **`0x8`** рдмрд╛рдЗрдЯ qword рд╣реИред **рдкрд╣рд▓реЗ рд╕рд╛рдд рдмрд╛рдЗрдЯ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╣реИрдВ** рдФрд░ рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдПрдХ **null byte** рд╣реИред

`x86` рдмрд╛рдЗрдирд░реА рдореЗрдВ, canary рдХреБрдХреА рдПрдХ **`0x4`** рдмрд╛рдЗрдЯ dword рд╣реИред **рдкрд╣рд▓реЗ рддреАрди рдмрд╛рдЗрдЯ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╣реИрдВ** рдФрд░ рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдПрдХ **null byte** рд╣реИред

{% hint style="danger" %}
рджреЛрдиреЛрдВ canaries рдХрд╛ рд╕рдмрд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдЗрдЯ рдПрдХ null byte рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╣реЛрдЧрд╛ рдЬреЛ рдирд┐рдореНрди рдкрддреЗ рд╕реЗ рдЖрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП **рдЬреЛ рдлрд╝рдВрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрдврд╝рддреЗ рд╣реИрдВ рд╡реЗ рдЗрд╕реЗ рдкрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд░реБрдХ рдЬрд╛рдПрдВрдЧреЗ**ред
{% endhint %}

## Bypasses

**Canary рдХреЛ рд▓реАрдХ рдХрд░рдирд╛** рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдЕрдкрдиреЗ рдорд╛рди (рдЬреИрд╕реЗ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ) рдХреЗ рд╕рд╛рде рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ред

* рдпрджрд┐ **canary рдХреЛ рдмрд╛рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ fork рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ рдЗрд╕реЗ рдПрдХ рдмрд╛рдЗрдЯ рдореЗрдВ **brute-force** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="bf-forked-stack-canaries.md" %}
[bf-forked-stack-canaries.md](bf-forked-stack-canaries.md)
{% endcontent-ref %}

* рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк **рд▓реАрдХ рдпрд╛ рдордирдорд╛рдирд╛ рдкрдврд╝рдиреЗ рдХреА рдХрдордЬреЛрд░реА** рд╣реИ рддреЛ рдЗрд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="print-stack-canary.md" %}
[print-stack-canary.md](print-stack-canary.md)
{% endcontent-ref %}

* **рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛**

рд╕реНрдЯреИрдХ рдЬреЛ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ, **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдпрд╛ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЗ рдкрддреЗ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рдХрдордЬреЛрд░реА рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдмрд┐рдирд╛ рд╕реНрдЯреИрдХ canary рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗред рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="../../stack-overflow/pointer-redirecting.md" %}
[pointer-redirecting.md](../../stack-overflow/pointer-redirecting.md)
{% endcontent-ref %}

* **рдорд╛рд╕реНрдЯрд░ рдФрд░ рдереНрд░реЗрдб canary рджреЛрдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛**

рдПрдХ рдереНрд░реЗрдбреЗрдб рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдЬреЛ canary рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рдХрд╛ рдЙрдкрдпреЛрдЧ рдереНрд░реЗрдб рдХреЗ рдорд╛рд╕реНрдЯрд░ canary рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдпрд╣ рд╢рдорди рдмреЗрдХрд╛рд░ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрд╛рдВрдЪ рджреЛ рд╕рдорд╛рди (рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рдВрд╢реЛрдзрд┐рдд) canaries рдХреЗ рд╕рд╛рде рдХреА рдЬрд╛рддреА рд╣реИред

* **`__stack_chk_fail` рдХреЗ GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛**

рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдореЗрдВ Partial RELRO рд╣реИ, рддреЛ рдЖрдк `__stack_chk_fail` рдХреЗ GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдПрдХ рдбрдореА рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдордирдорд╛рдирд╛ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдЕрд╡рд░реБрджреНрдз рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдпрджрд┐ canary рд╕рдВрд╢реЛрдзрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

## References

* [https://guyinatuxedo.github.io/7.1-mitigation\_canary/index.html](https://guyinatuxedo.github.io/7.1-mitigation\_canary/index.html)
* [http://7rocky.github.io/en/ctf/htb-challenges/pwn/robot-factory/#canaries-and-threads](http://7rocky.github.io/en/ctf/htb-challenges/pwn/robot-factory/#canaries-and-threads)
* 64 bits, no PIE, nx, modify thread and master canary.
* [https://7rocky.github.io/en/ctf/other/securinets-ctf/scrambler/](https://7rocky.github.io/en/ctf/other/securinets-ctf/scrambler/)
* 64 bits, no PIE, nx, write-what-where primitive. Modify GOT entry of `__stack_chk_fail`.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
