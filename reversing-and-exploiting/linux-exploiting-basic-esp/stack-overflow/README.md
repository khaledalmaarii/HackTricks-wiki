# Stack Overflow

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## What is a Stack Overflow

A **stack overflow**ëŠ” í”„ë¡œê·¸ë¨ì´ í• ë‹¹ëœ ê²ƒë³´ë‹¤ ë” ë§ì€ ë°ì´í„°ë¥¼ ìŠ¤íƒì— ê¸°ë¡í•  ë•Œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì´ˆê³¼ ë°ì´í„°ëŠ” **ì¸ì ‘í•œ ë©”ëª¨ë¦¬ ê³µê°„ì„ ë®ì–´ì“°ê²Œ** ë˜ì–´ ìœ íš¨í•œ ë°ì´í„°ê°€ ì†ìƒë˜ê³ , ì œì–´ íë¦„ì´ ë°©í•´ë°›ìœ¼ë©°, ì ì¬ì ìœ¼ë¡œ ì•…ì„± ì½”ë“œê°€ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œëŠ” ì¢…ì¢… ì…ë ¥ì— ëŒ€í•œ ê²½ê³„ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ” ì•ˆì „í•˜ì§€ ì•Šì€ í•¨ìˆ˜ì˜ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ë°œìƒí•©ë‹ˆë‹¤.

ì´ ë®ì–´ì“°ê¸°ì˜ ì£¼ìš” ë¬¸ì œëŠ” **ì €ì¥ëœ ëª…ë ¹ í¬ì¸í„° (EIP/RIP)**ì™€ **ì €ì¥ëœ ê¸°ë³¸ í¬ì¸í„° (EBP/RBP)**ê°€ ì´ì „ í•¨ìˆ˜ë¡œ ëŒì•„ê°€ê¸° ìœ„í•´ **ìŠ¤íƒì— ì €ì¥**ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ê³µê²©ìëŠ” ì´ë¥¼ ë®ì–´ì“°ê³  **í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íë¦„ì„ ì œì–´**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì·¨ì•½ì ì€ ì¼ë°˜ì ìœ¼ë¡œ í•¨ìˆ˜ê°€ **ìŠ¤íƒì— í• ë‹¹ëœ ì–‘ë³´ë‹¤ ë” ë§ì€ ë°”ì´íŠ¸ë¥¼ ë³µì‚¬í•  ë•Œ** ë°œìƒí•˜ì—¬ ìŠ¤íƒì˜ ë‹¤ë¥¸ ë¶€ë¶„ì„ ë®ì–´ì“¸ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.\
ì´ì™€ ê°™ì€ ì·¨ì•½í•œ ì¼ë°˜ì ì¸ í•¨ìˆ˜ëŠ”: `strcpy`, `strcat`, `sprintf`, `gets`... ë˜í•œ, ê¸¸ì´ ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” `fgets`ë‚˜ `read`ì™€ ê°™ì€ í•¨ìˆ˜ëŠ” ì§€ì •ëœ ê¸¸ì´ê°€ í• ë‹¹ëœ ê²ƒë³´ë‹¤ í´ ê²½ìš° ì·¨ì•½í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒ í•¨ìˆ˜ë“¤ì´ ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```c
void vulnerable() {
char buffer[128];
printf("Enter some text: ");
gets(buffer); // This is where the vulnerability lies
printf("You entered: %s\n", buffer);
}
```
### ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš° ì°¾ê¸°

ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì°¾ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ë²•ì€ ë§¤ìš° í° ì…ë ¥ì˜ `A`së¥¼ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤ (ì˜ˆ: `python3 -c 'print("A"*1000)'`) ê·¸ë¦¬ê³  **ì£¼ì†Œ `0x41414141`ì— ì ‘ê·¼í•˜ë ¤ê³  ì‹œë„í–ˆë‹¤ëŠ”** `Segmentation Fault`ë¥¼ ê¸°ëŒ€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê²Œë‹¤ê°€, ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš° ì·¨ì•½ì ì´ ë°œê²¬ë˜ë©´ **ë¦¬í„´ ì£¼ì†Œë¥¼ ë®ì–´ì“¸ ìˆ˜ ìˆëŠ” ì˜¤í”„ì…‹**ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ **De Bruijn ì‹œí€€ìŠ¤**ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ì£¼ì–´ì§„ í¬ê¸° _k_ì˜ ì•ŒíŒŒë²³ê³¼ ê¸¸ì´ _n_ì˜ ë¶€ë¶„ ìˆ˜ì—´ì— ëŒ€í•´, **ê¸¸ì´ _n_ì˜ ëª¨ë“  ê°€ëŠ¥í•œ ë¶€ë¶„ ìˆ˜ì—´ì´ ì •í™•íˆ í•œ ë²ˆì”© ë‚˜íƒ€ë‚˜ëŠ” ìˆœí™˜ ì‹œí€€ìŠ¤**ì…ë‹ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ EIPë¥¼ ì œì–´í•˜ëŠ” ë° í•„ìš”í•œ ì˜¤í”„ì…‹ì„ ìˆ˜ë™ìœ¼ë¡œ íŒŒì•…í•  í•„ìš” ì—†ì´ ì´ëŸ¬í•œ ì‹œí€€ìŠ¤ ì¤‘ í•˜ë‚˜ë¥¼ íŒ¨ë”©ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , ê·¸ê²ƒì„ ë®ì–´ì“´ ë°”ì´íŠ¸ì˜ ì˜¤í”„ì…‹ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ **pwntools**ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```python
from pwn import *

# Generate a De Bruijn sequence of length 1000 with an alphabet size of 256 (byte values)
pattern = cyclic(1000)

# This is an example value that you'd have found in the EIP/IP register upon crash
eip_value = p32(0x6161616c)
offset = cyclic_find(eip_value)  # Finds the offset of the sequence in the De Bruijn pattern
print(f"The offset is: {offset}")
```
ë˜ëŠ” **GEF**:
```bash
#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp
```
## ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš° ì•…ìš©

ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ëŠ” ë™ì•ˆ(ì˜¤ë²„í”Œë¡œìš° í¬ê¸°ê°€ ì¶©ë¶„íˆ í° ê²½ìš°) ìŠ¤íƒ ë‚´ì˜ ì§€ì—­ ë³€ìˆ˜ ê°’ì„ ë®ì–´ì“¸ ìˆ˜ ìˆìœ¼ë©°, ì €ì¥ëœ EBP/RBP ë° EIP/RIPì— ë„ë‹¬í•  ë•Œê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤(ë” ë©€ë¦¬ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤).\
ì´ëŸ¬í•œ ìœ í˜•ì˜ ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ë²•ì€ **ë°˜í™˜ ì£¼ì†Œë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒ**ìœ¼ë¡œ, í•¨ìˆ˜ê°€ ëë‚  ë•Œ **ì œì–´ íë¦„ì´ ì‚¬ìš©ìê°€ ì§€ì •í•œ ìœ„ì¹˜ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤**.

ê·¸ëŸ¬ë‚˜ ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” **ìŠ¤íƒ ë‚´ì˜ ì¼ë¶€ ë³€ìˆ˜ ê°’ì„ ë®ì–´ì“°ëŠ” ê²ƒ**ë§Œìœ¼ë¡œë„ ì•…ìš©ì´ ì¶©ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì˜ˆ: ì‰¬ìš´ CTF ì±Œë¦°ì§€ì—ì„œ).

### Ret2win

ì´ëŸ¬í•œ ìœ í˜•ì˜ CTF ì±Œë¦°ì§€ì—ì„œëŠ” **ê²°ì½” í˜¸ì¶œë˜ì§€ ì•ŠëŠ”** **í•¨ìˆ˜**ê°€ ë°”ì´ë„ˆë¦¬ ë‚´ì— ìˆìœ¼ë©°, **ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ ìŠ¹ë¦¬í•©ë‹ˆë‹¤**. ì´ëŸ¬í•œ ì±Œë¦°ì§€ì—ì„œëŠ” **ë°˜í™˜ ì£¼ì†Œë¥¼ ë®ì–´ì“¸ ì˜¤í”„ì…‹ì„ ì°¾ê³ ** **í˜¸ì¶œí•  í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ ì°¾ëŠ” ê²ƒ**ë§Œ í•„ìš”í•©ë‹ˆë‹¤(ë³´í†µ [**ASLR**](../common-binary-protections-and-bypasses/aslr/)ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŒ) ê·¸ë˜ì„œ ì·¨ì•½í•œ í•¨ìˆ˜ê°€ ë°˜í™˜ë  ë•Œ ìˆ¨ê²¨ì§„ í•¨ìˆ˜ê°€ í˜¸ì¶œë©ë‹ˆë‹¤:

{% content-ref url="ret2win.md" %}
[ret2win.md](ret2win.md)
{% endcontent-ref %}

### ìŠ¤íƒ ì…¸ì½”ë“œ

ì´ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ê³µê²©ìëŠ” ìŠ¤íƒì— ì…¸ì½”ë“œë¥¼ ë°°ì¹˜í•˜ê³  ì œì–´ëœ EIP/RIPë¥¼ ì•…ìš©í•˜ì—¬ ì…¸ì½”ë“œë¡œ ì í”„í•˜ê³  ì„ì˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="stack-shellcode.md" %}
[stack-shellcode.md](stack-shellcode.md)
{% endcontent-ref %}

## ROP

ì´ ê¸°ìˆ ì€ ì´ì „ ê¸°ìˆ ì˜ ì£¼ìš” ë³´í˜¸ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•œ ê¸°ë³¸ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤: **ì‹¤í–‰ ë¶ˆê°€ëŠ¥í•œ ìŠ¤íƒ** (NX). ê·¸ë¦¬ê³  ì´ëŠ” ê¸°ì¡´ì˜ ë°”ì´ë„ˆë¦¬ ëª…ë ¹ì–´ë¥¼ ì•…ìš©í•˜ì—¬ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ì—¬ëŸ¬ ë‹¤ë¥¸ ê¸°ìˆ (ret2lib, ret2syscall...)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤:

{% content-ref url="rop-return-oriented-programing.md" %}
[rop-return-oriented-programing.md](rop-return-oriented-programing.md)
{% endcontent-ref %}



## ë³´í˜¸ ìœ í˜•

ì·¨ì•½ì  ì•…ìš©ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ê°€ì§€ ë³´í˜¸ê°€ ìˆìœ¼ë©°, ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../common-binary-protections-and-bypasses/" %}
[common-binary-protections-and-bypasses](../common-binary-protections-and-bypasses/)
{% endcontent-ref %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
