# Ret2ret & Reo2pop

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Ret2ret

Bu tekniÄŸin ana amacÄ±, **stack'teki mevcut bir iÅŸaretÃ§iyi kÃ¶tÃ¼ye kullanarak ASLR'yi atlatmaya Ã§alÄ±ÅŸmaktÄ±r**.

Temelde, stack taÅŸmalarÄ± genellikle dizelerden kaynaklanÄ±r ve **dizeler bellekte bir null byte ile biter**. Bu, stack'te zaten mevcut olan bir iÅŸaretÃ§i tarafÄ±ndan gÃ¶sterilen yeri azaltmayÄ± denemeye olanak tanÄ±r. Yani eÄŸer stack `0xbfffffdd` iÃ§eriyorsa, bu taÅŸma onu `0xbfffff00`'a dÃ¶nÃ¼ÅŸtÃ¼rebilir (son sÄ±fÄ±rlÄ± byte'a dikkat edin).

EÄŸer bu adres stack'teki shellcode'umuza iÅŸaret ediyorsa, akÄ±ÅŸÄ± o adrese ulaÅŸtÄ±rmak mÃ¼mkÃ¼ndÃ¼r; **`ret` talimatÄ±na adresler ekleyerek** bu adrese ulaÅŸana kadar.

Bu nedenle saldÄ±rÄ± ÅŸÃ¶yle olacaktÄ±r:

* NOP sled
* Shellcode
* EIP'den stack'i **`ret` adresleri ile Ã¼zerine yazmak** (RET sled)
* String'in bir adresi deÄŸiÅŸtirmesiyle stack'teki NOP sled'e iÅŸaret eden 0x00

[**bu baÄŸlantÄ±yÄ±**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) takip ederek savunmasÄ±z bir ikili Ã¶rneÄŸini gÃ¶rebilirsiniz ve [**bu baÄŸlantÄ±da**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) ise istismarÄ± gÃ¶rebilirsiniz.

## Ret2pop

EÄŸer **deÄŸiÅŸtirmek istemediÄŸiniz stack'te mÃ¼kemmel bir iÅŸaretÃ§i bulursanÄ±z** (ret2ret'te son en dÃ¼ÅŸÃ¼k byte'Ä± `0x00` olarak deÄŸiÅŸtiriyoruz), aynÄ± `ret2ret` saldÄ±rÄ±sÄ±nÄ± gerÃ§ekleÅŸtirebilirsiniz, ancak **RET sled'in uzunluÄŸu 1 kÄ±saltÄ±lmalÄ±dÄ±r** (bÃ¶ylece son `0x00` mÃ¼kemmel iÅŸaretÃ§inin hemen Ã¶ncesindeki veriyi Ã¼zerine yazar) ve **RET sled'in son** adresi **`pop <reg>; ret`**'e iÅŸaret etmelidir.\
Bu ÅŸekilde, **mÃ¼kemmel iÅŸaretÃ§iden Ã¶nceki veri** stack'ten silinecek (bu `0x00` tarafÄ±ndan etkilenen veridir) ve **son `ret` mÃ¼kemmel adrese** stack'te herhangi bir deÄŸiÅŸiklik olmadan iÅŸaret edecektir.

[**bu baÄŸlantÄ±yÄ±**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) takip ederek savunmasÄ±z bir ikili Ã¶rneÄŸini gÃ¶rebilirsiniz ve [**bu baÄŸlantÄ±da**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c) ise istismarÄ± gÃ¶rebilirsiniz.

## Referanslar

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
