# Ret2ret & Reo2pop

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}

## Ret2ret

ã“ã®æŠ€è¡“ã®ä¸»ãªç›®çš„ã¯ã€**ã‚¹ã‚¿ãƒƒã‚¯å†…ã®æ—¢å­˜ã®ãƒã‚¤ãƒ³ã‚¿ã‚’æ‚ªç”¨ã—ã¦ASLRã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã‚ˆã†ã¨ã™ã‚‹ã“ã¨**ã§ã™ã€‚

åŸºæœ¬çš„ã«ã€ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã¯é€šå¸¸æ–‡å­—åˆ—ã«ã‚ˆã£ã¦å¼•ãèµ·ã“ã•ã‚Œã€**æ–‡å­—åˆ—ã¯ãƒ¡ãƒ¢ãƒªå†…ã®æœ€å¾Œã«ãƒŒãƒ«ãƒã‚¤ãƒˆã§çµ‚ã‚ã‚Šã¾ã™**ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¹ã‚¿ãƒƒã‚¯å†…ã«æ—¢ã«å­˜åœ¨ã™ã‚‹ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã™å ´æ‰€ã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¹ã‚¿ãƒƒã‚¯ã«`0xbfffffdd`ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã¯ãã‚Œã‚’`0xbfffff00`ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆæœ€å¾Œã®ã‚¼ãƒ­ãƒã‚¤ãƒˆã«æ³¨æ„ï¼‰ã€‚

ãã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã‚¹ã‚¿ãƒƒã‚¯å†…ã®ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡ã—ã¦ã„ã‚‹å ´åˆã€**`ret`å‘½ä»¤ã«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ãã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒ•ãƒ­ãƒ¼ã‚’åˆ°é”ã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™**ã€‚

ã—ãŸãŒã£ã¦ã€æ”»æ’ƒã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

* NOPã‚¹ãƒ¬ãƒƒãƒ‰
* ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰
* **`ret`ã¸ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§EIPã‹ã‚‰ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä¸Šæ›¸ãã™ã‚‹**ï¼ˆRETã‚¹ãƒ¬ãƒƒãƒ‰ï¼‰
* ã‚¹ã‚¿ãƒƒã‚¯ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡ã™ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«æ–‡å­—åˆ—ã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚ŒãŸ0x00ãŒNOPã‚¹ãƒ¬ãƒƒãƒ‰ã‚’æŒ‡ã™ã‚ˆã†ã«ã™ã‚‹

[**ã“ã®ãƒªãƒ³ã‚¯**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c)ã‚’å‚ç…§ã™ã‚‹ã¨ã€è„†å¼±ãªãƒã‚¤ãƒŠãƒªã®ä¾‹ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã€[**ã“ã¡ã‚‰**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c)ã§ã¯ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Ret2pop

**å¤‰æ›´ã—ãŸããªã„ã‚¹ã‚¿ãƒƒã‚¯å†…ã®å®Œç’§ãªãƒã‚¤ãƒ³ã‚¿ã‚’è¦‹ã¤ã‘ãŸå ´åˆ**ï¼ˆ`ret2ret`ã§ã¯æœ€çµ‚çš„ãªæœ€ä¸‹ä½ãƒã‚¤ãƒˆã‚’`0x00`ã«å¤‰æ›´ã—ã¾ã™ï¼‰ã€åŒã˜`ret2ret`æ”»æ’ƒã‚’å®Ÿè¡Œã§ãã¾ã™ãŒã€**RETã‚¹ãƒ¬ãƒƒãƒ‰ã®é•·ã•ã¯1çŸ­ãã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ï¼ˆæœ€çµ‚çš„ãª`0x00`ãŒå®Œç’§ãªãƒã‚¤ãƒ³ã‚¿ã®ç›´å‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã™ã‚‹ãŸã‚ï¼‰ã€ãã—ã¦**RETã‚¹ãƒ¬ãƒƒãƒ‰ã®æœ€å¾Œã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯**`pop <reg>; ret`**ã‚’æŒ‡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚\
ã“ã®æ–¹æ³•ã§ã€**å®Œç’§ãªãƒã‚¤ãƒ³ã‚¿ã®å‰ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰å‰Šé™¤ã•ã‚Œ**ï¼ˆã“ã‚Œã¯`0x00`ã«ã‚ˆã£ã¦å½±éŸ¿ã‚’å—ã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã§ã™ï¼‰ã€**æœ€çµ‚çš„ãª`ret`ã¯ã‚¹ã‚¿ãƒƒã‚¯å†…ã®å®Œç’§ãªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡ã™ã“ã¨ã«ãªã‚Šã¾ã™**ã€‚

[**ã“ã®ãƒªãƒ³ã‚¯**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c)ã‚’å‚ç…§ã™ã‚‹ã¨ã€è„†å¼±ãªãƒã‚¤ãƒŠãƒªã®ä¾‹ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã€[**ã“ã¡ã‚‰**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c)ã§ã¯ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## References

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
