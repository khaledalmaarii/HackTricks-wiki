<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Prona캠ite najva쬹ije ranjivosti kako biste ih br쬰 popravili. Intruder prati va코u povr코inu napada, pokre캖e proaktivno skeniranje pretnji, pronalazi probleme u celokupnom tehnolo코kom sklopu, od API-ja do veb aplikacija i cloud sistema. [**Isprobajte ga besplatno**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) danas.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***


# Op코te

## Mre쬹o povezivanje

| Sirovi Sockets | WinAPI Sockets |
| -------------- | -------------- |
| socket()       | WSAStratup()   |
| bind()         | bind()         |
| listen()       | listen()       |
| accept()       | accept()       |
| connect()      | connect()      |
| read()/recv()  | recv()         |
| write()        | send()         |
| shutdown()     | WSACleanup()   |

## Upornost

| Registar          | Fajl          | Servis                       |
| ----------------- | ------------- | ---------------------------- |
| RegCreateKeyEx()  | GetTempPath() | OpenSCManager                |
| RegOpenKeyEx()    | CopyFile()    | CreateService()              |
| RegSetValueEx()   | CreateFile()  | StartServiceCtrlDispatcher() |
| RegDeleteKeyEx()  | WriteFile()   |                              |
| RegGetValue()     | ReadFile()    |                              |

## Enkripcija

| Ime                   |
| --------------------- |
| WinCrypt              |
| CryptAcquireContext() |
| CryptGenKey()         |
| CryptDeriveKey()      |
| CryptDecrypt()        |
| CryptReleaseContext() |

## Anti-Analiza/VM

| Ime Funkcije                                              | Skup Instrukcija |
| --------------------------------------------------------- | ---------------- |
| IsDebuggerPresent()                                       | CPUID()          |
| GetSystemInfo()                                           | IN()             |
| GlobalMemoryStatusEx()                                    |                  |
| GetVersion()                                              |                  |
| CreateToolhelp32Snapshot \[Provera da li je proces pokrenut] |                  |
| CreateFileW/A \[Provera da li fajl postoji]                |                  |

## Skrivanje

| Ime                      |                                                                            |
| ------------------------ | -------------------------------------------------------------------------- |
| VirtualAlloc             | Alokacija memorije (pakovanje)                                             |
| VirtualProtect           | Promena dozvola memorije (pakovanje davanjem dozvole za izvr코avanje sekciji) |
| ReadProcessMemory        | Ubacivanje u spoljne procese                                              |
| WriteProcessMemoryA/W    | Ubacivanje u spoljne procese                                              |
| NtWriteVirtualMemory     |                                                                            |
| CreateRemoteThread       | Ubacivanje DLL-a/Procesa...                                                |
| NtUnmapViewOfSection     |                                                                            |
| QueueUserAPC             |                                                                            |
| CreateProcessInternalA/W |                                                                            |

## Izvr코avanje

| Ime Funkcije    |
| --------------- |
| CreateProcessA/W |
| ShellExecute     |
| WinExec          |
| ResumeThread     |
| NtResumeThread   |

## Razno

* GetAsyncKeyState() -- Snimanje tastature
* SetWindowsHookEx -- Snimanje tastature
* GetForeGroundWindow -- Dobijanje naziva pokrenutog prozora (ili veb sajta iz pretra쬴va캜a)
* LoadLibrary() -- Uvoz biblioteke
* GetProcAddress() -- Uvoz biblioteke
* CreateToolhelp32Snapshot() -- Lista pokrenutih procesa
* GetDC() -- Snimak ekrana
* BitBlt() -- Snimak ekrana
* InternetOpen(), InternetOpenUrl(), InternetReadFile(), InternetWriteFile() -- Pristup internetu
* FindResource(), LoadResource(), LockResource() -- Pristup resursima izvr코nog fajla

# Tehnike Malvera

## DLL Ubacivanje

Izvr코avanje proizvoljne DLL datoteke unutar drugog procesa

1. Prona캠ite proces u koji 캖ete ubaciti zlonamernu DLL: CreateToolhelp32Snapshot, Process32First, Process32Next
2. Otvorite proces: GetModuleHandle, GetProcAddress, OpenProcess
3. Upisujte putanju do DLL datoteke unutar procesa: VirtualAllocEx, WriteProcessMemory
4. Kreirajte nit u procesu koja 캖e u캜itati zlonamernu DLL: CreateRemoteThread, LoadLibrary

Ostale funkcije za kori코캖enje: NTCreateThreadEx, RtlCreateUserThread

## Reflektivno DLL Ubacivanje

U캜itavanje zlonamerne DLL datoteke bez pozivanja normalnih Windows API poziva.\
DLL je mapiran unutar procesa, re코ava adrese uvoza, popravlja relokacije i poziva funkciju DllMain.

## Preuzimanje Niti

Pronala쬰nje niti iz procesa i njenje u캜itavanje zlonamerne DLL datoteke

1. Prona캠ite ciljnu nit: CreateToolhelp32Snapshot, Thread32First, Thread32Next
2. Otvorite nit: OpenThread
3. Suspendujte nit: SuspendThread
4. Upisujte putanju do zlonamerne DLL datoteke unutar procesa rtve: VirtualAllocEx, WriteProcessMemory
5. Nastavite nit koja u캜itava biblioteku: ResumeThread

## PE Ubacivanje

Ubacivanje izvr코ne datoteke u memoriju procesa rtve i izvr코avanje iz te lokacije.

## Isprazni Proces

Malver 캖e izbrisati legitimni kod iz memorije procesa i u캜itati zlonamerni binarni fajl

1. Kreirajte novi proces: CreateProcess
2. Ispraznite memoriju: ZwUnmapViewOfSection, NtUnmapViewOfSection
3. Upisujte zlonamerni binarni fajl u memoriju procesa: VirtualAllocEc, WriteProcessMemory
4. Postavite ta캜ku ulaska i izvr코ite: SetThreadContext, ResumeThread

# Hookovanje

* **SSDT** (**System Service Descriptor Table**) pokazuje na kernel funkcije (ntoskrnl.exe) ili GUI draj
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
