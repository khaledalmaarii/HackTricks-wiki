# μ•”νΈν™”/μ••μ¶• μ•κ³ λ¦¬μ¦

## μ•”νΈν™”/μ••μ¶• μ•κ³ λ¦¬μ¦

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFTs**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**λ¥Ό** **ν”λ΅μ°**ν•μ„Έμ”.
* **Hacking νΈλ¦­μ„ κ³µμ ν•λ ¤λ©΄** [**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ„Έμ”.

</details>

## μ•κ³ λ¦¬μ¦ μ‹λ³„

λ§μ•½ μ½”λ“μ—μ„ **μ‹ν”„νΈ μ—°μ‚°, XOR λ° μ—¬λ¬ μ‚°μ  μ—°μ‚°μ„ μ‚¬μ©ν•λ” κ²½μ°**, κ·Έκ²ƒμ€ **μ•”νΈν™” μ•κ³ λ¦¬μ¦μ κµ¬ν„**μΌ κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤. μ—¬κΈ°μ—μ„λ” **κ° λ‹¨κ³„λ¥Ό λ°μ „μ‹ν‚¤μ§€ μ•κ³  μ‚¬μ©λ μ•κ³ λ¦¬μ¦μ„ μ‹λ³„ν•λ” λ°©λ²•**μ„ μ†κ°ν•©λ‹λ‹¤.

### API ν•¨μ

**CryptDeriveKey**

μ΄ ν•¨μκ°€ μ‚¬μ©λ κ²½μ°, λ‘ λ²μ§Έ λ§¤κ°λ³€μμ κ°’μ„ ν™•μΈν•μ—¬ **μ‚¬μ©λ μ•κ³ λ¦¬μ¦μ„ μ°Ύμ„ μ** μμµλ‹λ‹¤:

![](<../../.gitbook/assets/image (375) (1) (1) (1) (1).png>)

κ°€λ¥ν• μ•κ³ λ¦¬μ¦κ³Ό ν•΄λ‹Ή κ°’μ— λ€ν• ν…μ΄λΈ”μ€ μ—¬κΈ°μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

**RtlCompressBuffer/RtlDecompressBuffer**

μ£Όμ–΄μ§„ λ°μ΄ν„° λ²„νΌλ¥Ό μ••μ¶•ν•κ±°λ‚ μ••μ¶• ν•΄μ ν•©λ‹λ‹¤.

**CryptAcquireContext**

[λ¬Έμ„](https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptacquirecontexta)μ—μ„: **CryptAcquireContext** ν•¨μλ” νΉμ • μ•”νΈν™” μ„λΉ„μ¤ μ κ³µμ(CSP) λ‚΄μ νΉμ • ν‚¤ μ»¨ν…μ΄λ„μ— λ€ν• ν•Έλ“¤μ„ νλ“ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤. **μ΄ λ°ν™λ ν•Έλ“¤μ€ μ„ νƒν• CSPλ¥Ό μ‚¬μ©ν•λ” CryptoAPI ν•¨μ νΈμ¶μ— μ‚¬μ©λ©λ‹λ‹¤.**

**CryptCreateHash**

λ°μ΄ν„° μ¤νΈλ¦Όμ ν•΄μ‹±μ„ μ‹μ‘ν•©λ‹λ‹¤. μ΄ ν•¨μκ°€ μ‚¬μ©λ κ²½μ°, λ‘ λ²μ§Έ λ§¤κ°λ³€μμ κ°’μ„ ν™•μΈν•μ—¬ **μ‚¬μ©λ μ•κ³ λ¦¬μ¦μ„ μ°Ύμ„ μ** μμµλ‹λ‹¤:

![](<../../.gitbook/assets/image (376).png>)

κ°€λ¥ν• μ•κ³ λ¦¬μ¦κ³Ό ν•΄λ‹Ή κ°’μ— λ€ν• ν…μ΄λΈ”μ€ μ—¬κΈ°μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

### μ½”λ“ μƒμ

λ•λ΅λ” νΉμ •ν•κ³  κ³ μ ν• κ°’μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” μ•κ³ λ¦¬μ¦μ„ μ‹λ³„ν•λ” κ²ƒμ΄ λ§¤μ° μ‰½μµλ‹λ‹¤.

![](<../../.gitbook/assets/image (370).png>)

μ²« λ²μ§Έ μƒμλ¥Ό Googleμ—μ„ κ²€μƒ‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ κ²°κ³Όκ°€ λ‚μµλ‹λ‹¤:

![](<../../.gitbook/assets/image (371).png>)

λ”°λΌμ„, λ””μ»΄νμΌλ ν•¨μκ°€ **sha256 κ³„μ‚°κΈ°**μ„μ„ κ°€μ •ν•  μ μμµλ‹λ‹¤. λ‹¤λ¥Έ μƒμ μ¤‘ ν•λ‚λ¥Ό κ²€μƒ‰ν•λ©΄ (μ•„λ§λ„) λ™μΌν• κ²°κ³Όλ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.

### λ°μ΄ν„° μ •λ³΄

μ½”λ“μ— μ μλ―Έν• μƒμκ°€ μ—†λ” κ²½μ°, μ½”λ“κ°€ **.data μ„Ήμ…μ—μ„ μ •λ³΄λ¥Ό λ΅λ“**ν•  μ μμµλ‹λ‹¤.\
ν•΄λ‹Ή λ°μ΄ν„°μ— μ•΅μ„Έμ¤ν•μ—¬ **μ²« λ²μ§Έ dwordλ¥Ό κ·Έλ£Ήν™”**ν•κ³  μ•μ—μ„ ν• κ²ƒκ³Ό κ°™μ΄ Googleμ—μ„ κ²€μƒ‰ν•  μ μμµλ‹λ‹¤:

![](<../../.gitbook/assets/image (372).png>)

μ΄ κ²½μ°, **0xA56363C6**μ„ κ²€μƒ‰ν•λ©΄ **AES μ•κ³ λ¦¬μ¦μ ν…μ΄λΈ”**κ³Ό κ΄€λ ¨λ κ²ƒμ„μ„ μ• μ μμµλ‹λ‹¤.

## RC4 **(λ€μΉ­ μ•”νΈ)**

### νΉμ§•

RC4λ” 3κ°€μ§€ μ£Όμ” λ¶€λ¶„μΌλ΅ κµ¬μ„±λ©λ‹λ‹¤:

* **μ΄κΈ°ν™” λ‹¨κ³„/**: 0x00μ—μ„ 0xFF(μ΄ 256λ°”μ΄νΈ, 0x100)κΉμ§€μ κ°’μΌλ΅ κµ¬μ„±λ **κ°’ ν…μ΄λΈ”** λλ” **μΉν™ μƒμ**(SBox)λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
* **νΌλ€ λ‹¨κ³„**: μ΄μ „μ— μƒμ„±λ ν…μ΄λΈ”μ„ λ°λ³µν•μ—¬ (λ‹¤μ‹ 0x100λ² λ°λ³µ) κ° κ°’μ„ **λ° λλ¤** λ°”μ΄νΈλ΅ μμ •ν•©λ‹λ‹¤. μ΄ λ° λλ¤ λ°”μ΄νΈλ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ RC4 **ν‚¤**κ°€ μ‚¬μ©λ©λ‹λ‹¤. RC4 **ν‚¤**λ” **1λ°”μ΄νΈμ—μ„ 256λ°”μ΄νΈ**κΉμ§€ κ°€λ¥ν•μ§€λ§, μΌλ°μ μΌλ΅ 5λ°”μ΄νΈ μ΄μƒμ„ κ¶μ¥ν•©λ‹λ‹¤. μΌλ°μ μΌλ΅ RC4 ν‚¤λ” 16λ°”μ΄νΈμ…λ‹λ‹¤.
* **XOR λ‹¨κ³„**: λ§μ§€λ§‰μΌλ΅, ν‰λ¬Έ λλ” μ•”νΈλ¬Έμ€ μ΄μ „μ— μƒμ„±λ κ°’λ“¤κ³Ό **XOR μ—°μ‚°**λ©λ‹λ‹¤. μ•”νΈν™” λ° λ³µνΈν™”λ¥Ό μ„ν•΄ λ™μΌν• ν•¨μκ°€ μ‚¬μ©λ©λ‹λ‹¤. μ΄λ¥Ό μ„ν•΄ μƒμ„±λ 256λ°”μ΄νΈλ¥Ό ν•„μ”ν• λ§νΌ λ°λ³µν•μ—¬ μν–‰ν•©λ‹λ‹¤. μ΄λ” μΌλ°μ μΌλ΅ λ””μ»΄νμΌλ μ½”λ“μ—μ„ **%256 (mod 256)**λ΅ μΈμ‹λ©λ‹λ‹¤.

{% hint style="info" %}
**λ””μ–΄μ…λΈ”λ¦¬/λ””μ»΄νμΌλ μ½”λ“μ—μ„ RC4λ¥Ό μ‹λ³„ν•λ ¤λ©΄ ν‚¤λ¥Ό μ‚¬μ©ν• ν¬κΈ°κ°€ 0x100μΈ 2κ°μ λ£¨ν”„μ™€ 256κ°μ κ°’μΌλ΅ μƒμ„±λ μ…λ ¥ λ°μ΄ν„°μ XORλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. μ΄ λ•, 256λ°”μ΄νΈλ΅ μƒμ„±λ 2κ°μ λ£¨ν”„μ—μ„ %256 (mod 256)λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.**
{% endhint %}

### **μ΄κΈ°ν™” λ‹¨κ³„/μΉν™ μƒμ:** (256μ΄λΌλ” μ«μκ°€ μΉ΄μ΄ν„°λ΅ μ‚¬μ©λκ³  256κ° λ¬Έμμ κ° μ„μΉμ— 0μ΄ μ“°μ—¬μ Έ μλ” κ²ƒμ— μ μν•μ„Έμ”)

![](<../../.gitbook/assets/image (377).png>)

### **νΌλ€ λ‹¨κ³„:**

![](<../../.gitbook/assets/image (378).png>)

### **XOR λ‹¨κ³„:**

![](<../../.gitbook/assets/image (379).png>)

## **AES (λ€μΉ­ μ•”νΈ)**

### **νΉμ§•**

* **μΉν™ μƒμ λ° λ£©μ—… ν…μ΄λΈ”**μ μ‚¬μ©
* νΉμ • λ£©μ—… ν…μ΄λΈ” κ°’(μƒμ)μ μ‚¬μ©μΌλ΅ **AESλ¥Ό κµ¬λ³„**ν•  μ μμµλ‹λ‹¤. _μƒμλ” μ΄μ§„ νμΌμ— **μ €μ¥**λκ±°λ‚ **λ™μ μΌλ΅ μƒμ„±**λ  μ μμµλ‹λ‹¤._
* **μ•”νΈν™” ν‚¤**λ” 16μΌλ΅ **λ‚λ μ μμ–΄μ•Ό** ν•λ©°(μΌλ°μ μΌλ΅ 32B), μΌλ°μ μΌλ΅ 16Bμ **IV**κ°€ μ‚¬μ©λ©λ‹λ‹¤.

### SBox μƒμ

![](<../../.gitbook/assets/image (380).png>)

## Serpent **(λ€μΉ­ μ•”νΈ)**

### νΉμ§•

* μ•…μ„± μ½”λ“μ—μ„ μ‚¬μ©λλ” κ²ƒμ€ λ“λ¬Όμ§€λ§ μμ‹(Ursnif)κ°€ μμµλ‹λ‹¤.
* μ•κ³ λ¦¬μ¦μ΄ SerpentμΈμ§€ μ•„λ‹μ§€λ¥Ό νλ‹¨ν•λ” κ²ƒμ€ **κΈΈμ΄**(
## RSA **(λΉ„λ€μΉ­ μ•”νΈν™”)**

### νΉμ§•

* λ€μΉ­ μ•κ³ λ¦¬μ¦λ³΄λ‹¤ λ³µμ΅ν•¨
* μƒμκ°€ μ—†μ! (μ‚¬μ©μ μ •μ κµ¬ν„μ΄ μ–΄λ ¤μ›€)
* RSAλ” μƒμμ— μμ΅΄ν•λ―€λ΅ KANAL (μ•”νΈ λ¶„μ„κΈ°)μ€ RSAμ— λ€ν• ννΈλ¥Ό μ κ³µν•μ§€ μ•μ.

### λΉ„κµλ¥Ό ν†µν• μ‹λ³„

![](<../../.gitbook/assets/image (383).png>)

* 11λ² μ¤„ (μ™Όμ½)μ—λ” `+7) >> 3`μ΄ μμΌλ©°, 35λ² μ¤„ (μ¤λ¥Έμ½)μ—λ” `+7) / 8`κ³Ό λ™μΌν•¨.
* 12λ² μ¤„ (μ™Όμ½)μ—μ„λ” `modulus_len < 0x040`μ„ ν™•μΈν•κ³ , 36λ² μ¤„ (μ¤λ¥Έμ½)μ—μ„λ” `inputLen+11 > modulusLen`μ„ ν™•μΈν•¨.

## MD5 & SHA (ν•΄μ‹)

### νΉμ§•

* Init, Update, Final 3κ°μ ν•¨μ
* μ μ‚¬ν• μ΄κΈ°ν™” ν•¨μ

### μ‹λ³„

**Init**

μƒμλ¥Ό ν™•μΈν•μ—¬ λ‘ μ•κ³ λ¦¬μ¦μ„ μ‹λ³„ν•  μ μμµλ‹λ‹¤. MD5μ—λ” sha\_initμ— μ—†λ” 1κ°μ μƒμκ°€ μλ‹¤λ” μ μ— μ μν•μ„Έμ”:

![](<../../.gitbook/assets/image (385).png>)

**MD5 Transform**

λ” λ§μ€ μƒμμ μ‚¬μ©μ— μ£Όλ©ν•μ„Έμ”.

![](<../../.gitbook/assets/image (253) (1) (1) (1).png>)

## CRC (ν•΄μ‹)

* λ°μ΄ν„°μ μ°μ—°ν• λ³€κ²½μ„ μ°ΎκΈ° μ„ν• ν•¨μλ΅μ„ λ” μ‘κ³  ν¨μ¨μ μ„
* μƒμλ¥Ό μ‚¬μ©ν•λ” μ΅°ν ν…μ΄λΈ”μ„ μ‚¬μ©ν•¨

### μ‹λ³„

**μ΅°ν ν…μ΄λΈ” μƒμ**λ¥Ό ν™•μΈν•μ„Έμ”:

![](<../../.gitbook/assets/image (387).png>)

CRC ν•΄μ‹ μ•κ³ λ¦¬μ¦μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

![](<../../.gitbook/assets/image (386).png>)

## APLib (μ••μ¶•)

### νΉμ§•

* μ‹λ³„ κ°€λ¥ν• μƒμκ°€ μ—†μ
* νμ΄μ¬μΌλ΅ μ•κ³ λ¦¬μ¦μ„ μ‘μ„±ν•κ³  μ¨λΌμΈμ—μ„ μ μ‚¬ν• κ²ƒμ„ κ²€μƒ‰ν•΄λ³Ό μ μμ

### μ‹λ³„

κ·Έλν”„κ°€ μƒλ‹Ήν ν½λ‹λ‹¤:

![](<../../.gitbook/assets/image (207) (2) (1).png>)

**μ‹λ³„ν•κΈ° μ„ν•΄ 3κ°μ λΉ„κµ**λ¥Ό ν™•μΈν•μ„Έμ”:

![](<../../.gitbook/assets/image (384).png>)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ μ λ΅μ—μ„ μμ›…κΉμ§€ AWS ν•΄ν‚Ήμ„ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μƒν’**](https://peass.creator-spring.com)μ„ κµ¬λ§¤ν•μ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFT**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)μ„ **ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks**μ™€ **HackTricks Cloud** github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **λ‹Ήμ‹ μ ν•΄ν‚Ή κΈ°κµλ¥Ό κ³µμ **ν•μ„Έμ”.

</details>
