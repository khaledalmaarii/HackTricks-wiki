# é€†å‘å·¥å…·å’ŒåŸºæœ¬æ–¹æ³•

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTæ”¶è—å“](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºäºImGuiçš„é€†å‘å·¥å…·

è½¯ä»¶ï¼š

* ReverseKit: [https://github.com/zer0condition/ReverseKit](https://github.com/zer0condition/ReverseKit)

## Wasmåç¼–è¯‘å™¨ / Watç¼–è¯‘å™¨

åœ¨çº¿å·¥å…·ï¼š

* ä½¿ç”¨[https://webassembly.github.io/wabt/demo/wasm2wat/index.html](https://webassembly.github.io/wabt/demo/wasm2wat/index.html)å°†wasmï¼ˆäºŒè¿›åˆ¶ï¼‰åç¼–è¯‘ä¸ºwatï¼ˆæ˜æ–‡ï¼‰
* ä½¿ç”¨[https://webassembly.github.io/wabt/demo/wat2wasm/](https://webassembly.github.io/wabt/demo/wat2wasm/)å°†watç¼–è¯‘ä¸ºwasm
* æ‚¨ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨[https://wwwg.github.io/web-wasmdec/](https://wwwg.github.io/web-wasmdec/)è¿›è¡Œåç¼–è¯‘

è½¯ä»¶ï¼š

* [https://www.pnfsoftware.com/jeb/demo](https://www.pnfsoftware.com/jeb/demo)
* [https://github.com/wwwg/wasmdec](https://github.com/wwwg/wasmdec)

## .Netåç¼–è¯‘å™¨

### [dotPeek](https://www.jetbrains.com/decompiler/)

dotPeekæ˜¯ä¸€ä¸ªåç¼–è¯‘å™¨ï¼Œå¯ä»¥**åç¼–è¯‘å’Œæ£€æŸ¥å¤šç§æ ¼å¼**ï¼ŒåŒ…æ‹¬**åº“**ï¼ˆ.dllï¼‰ã€**Windowså…ƒæ•°æ®æ–‡ä»¶**ï¼ˆ.winmdï¼‰å’Œ**å¯æ‰§è¡Œæ–‡ä»¶**ï¼ˆ.exeï¼‰ã€‚åç¼–è¯‘åï¼Œä¸€ä¸ªç¨‹åºé›†å¯ä»¥ä¿å­˜ä¸ºVisual Studioé¡¹ç›®ï¼ˆ.csprojï¼‰ã€‚

è¿™é‡Œçš„ä¼˜ç‚¹æ˜¯ï¼Œå¦‚æœéœ€è¦ä»æ—§ç¨‹åºé›†ä¸­æ¢å¤ä¸¢å¤±çš„æºä»£ç ï¼Œæ­¤æ“ä½œå¯ä»¥èŠ‚çœæ—¶é—´ã€‚æ­¤å¤–ï¼ŒdotPeekæä¾›äº†æ–¹ä¾¿çš„å¯¼èˆªåŠŸèƒ½ï¼Œä½¿å…¶æˆä¸º**Xamarinç®—æ³•åˆ†æ**çš„å®Œç¾å·¥å…·ä¹‹ä¸€ã€‚

### [.Net Reflector](https://www.red-gate.com/products/reflector/)

å…·æœ‰å…¨é¢çš„æ’ä»¶æ¨¡å‹å’ŒAPIï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„å®é™…éœ€æ±‚æ‰©å±•å·¥å…·ï¼Œ.NET ReflectorèŠ‚çœæ—¶é—´å¹¶ç®€åŒ–å¼€å‘ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå·¥å…·æä¾›çš„ä¼—å¤šé€†å‘å·¥ç¨‹æœåŠ¡ï¼š

* æä¾›äº†æ•°æ®å¦‚ä½•åœ¨åº“æˆ–ç»„ä»¶ä¸­æµåŠ¨çš„è§è§£
* æä¾›äº†.NETè¯­è¨€å’Œæ¡†æ¶çš„å®ç°å’Œä½¿ç”¨è§è§£
* æŸ¥æ‰¾æœªè®°å½•å’Œæœªå…¬å¼€çš„åŠŸèƒ½ï¼Œä»¥æ›´å……åˆ†åˆ©ç”¨æ‰€ä½¿ç”¨çš„APIå’ŒæŠ€æœ¯
* æŸ¥æ‰¾ä¾èµ–é¡¹å’Œä¸åŒçš„ç¨‹åºé›†
* è¿½è¸ªä»£ç ä¸­æ‰€æœ‰.NETä»£ç çš„æºä»£ç çš„ç¡®åˆ‡ä½ç½®
* è°ƒè¯•æ‚¨ä½¿ç”¨çš„æ‰€æœ‰.NETä»£ç çš„æºä»£ç ã€‚

### [ILSpy](https://github.com/icsharpcode/ILSpy) & [dnSpy](https://github.com/dnSpy/dnSpy/releases)

[Visual Studio Codeçš„ILSpyæ’ä»¶](https://github.com/icsharpcode/ilspy-vscode)ï¼šæ‚¨å¯ä»¥åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨å®ƒï¼ˆæ‚¨å¯ä»¥ç›´æ¥ä»VSCodeå®‰è£…ï¼Œæ— éœ€ä¸‹è½½gitã€‚å•å‡»**æ‰©å±•**ï¼Œç„¶å**æœç´¢ILSpy**ï¼‰ã€‚\
å¦‚æœæ‚¨éœ€è¦**åç¼–è¯‘**ï¼Œ**ä¿®æ”¹**å’Œ**é‡æ–°ç¼–è¯‘**ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š[**https://github.com/0xd4d/dnSpy/releases**](https://github.com/0xd4d/dnSpy/releases)ï¼ˆ**å³é”®å•å‡» -> ä¿®æ”¹æ–¹æ³•**ä»¥æ›´æ”¹å‡½æ•°å†…éƒ¨çš„å†…å®¹ï¼‰ã€‚\
æ‚¨è¿˜å¯ä»¥å°è¯•[https://www.jetbrains.com/es-es/decompiler/](https://www.jetbrains.com/es-es/decompiler/)

### DNSpyæ—¥å¿—è®°å½•

ä¸ºäº†ä½¿**DNSpyåœ¨æ–‡ä»¶ä¸­è®°å½•ä¸€äº›ä¿¡æ¯**ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹.NETä»£ç è¡Œï¼š
```bash
using System.IO;
path = "C:\\inetpub\\temp\\MyTest2.txt";
File.AppendAllText(path, "Password: " + password + "\n");
```
### DNSpyè°ƒè¯•

è¦ä½¿ç”¨DNSpyè°ƒè¯•ä»£ç ï¼Œæ‚¨éœ€è¦ï¼š

é¦–å…ˆï¼Œæ›´æ”¹ä¸**è°ƒè¯•**ç›¸å…³çš„**ç¨‹åºé›†å±æ€§**ï¼š

![](<../../.gitbook/assets/image (278).png>)
```aspnet
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]
```
è‡³ï¼š
```
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.Default |
DebuggableAttribute.DebuggingModes.DisableOptimizations |
DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints |
DebuggableAttribute.DebuggingModes.EnableEditAndContinue)]
```
ç„¶åç‚¹å‡»**ç¼–è¯‘**ï¼š

![](<../../.gitbook/assets/image (314) (1) (1).png>)

ç„¶åå°†æ–°æ–‡ä»¶ä¿å­˜åœ¨_**æ–‡ä»¶ >> ä¿å­˜æ¨¡å—...**_ï¼š

![](<../../.gitbook/assets/image (279).png>)

è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºå¦‚æœæ‚¨ä¸è¿™æ ·åšï¼Œåœ¨**è¿è¡Œæ—¶**ä¼šå¯¹ä»£ç åº”ç”¨å‡ ç§**ä¼˜åŒ–**ï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨è°ƒè¯•æ—¶**æ–­ç‚¹æ°¸è¿œä¸ä¼šè¢«è§¦å‘**æˆ–ä¸€äº›**å˜é‡ä¸å­˜åœ¨**ã€‚

ç„¶åï¼Œå¦‚æœæ‚¨çš„ .Net åº”ç”¨ç¨‹åºæ­£åœ¨ç”±**IIS**è¿è¡Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•**é‡æ–°å¯åŠ¨**å®ƒï¼š
```
iisreset /noforce
```
ç„¶åï¼Œä¸ºäº†å¼€å§‹è°ƒè¯•ï¼Œæ‚¨åº”è¯¥å…³é—­æ‰€æœ‰å·²æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¹¶åœ¨**è°ƒè¯•é€‰é¡¹å¡**ä¸­é€‰æ‹©**é™„åŠ åˆ°è¿›ç¨‹...**ï¼š

![](<../../.gitbook/assets/image (280).png>)

ç„¶åé€‰æ‹©**w3wp.exe**ä»¥é™„åŠ åˆ°**IISæœåŠ¡å™¨**ï¼Œç„¶åå•å‡»**é™„åŠ **ï¼š

![](<../../.gitbook/assets/image (281).png>)

ç°åœ¨æˆ‘ä»¬æ­£åœ¨è°ƒè¯•è¯¥è¿›ç¨‹ï¼Œæ˜¯æ—¶å€™åœæ­¢å®ƒå¹¶åŠ è½½æ‰€æœ‰æ¨¡å—äº†ã€‚é¦–å…ˆå•å‡» _è°ƒè¯• >> ä¸­æ–­æ‰€æœ‰_ï¼Œç„¶åå•å‡» _**è°ƒè¯• >> çª—å£ >> æ¨¡å—**_ï¼š

![](<../../.gitbook/assets/image (286).png>)

![](<../../.gitbook/assets/image (283).png>)

å•å‡»**æ¨¡å—**ä¸­çš„ä»»ä½•æ¨¡å—ï¼Œç„¶åé€‰æ‹©**æ‰“å¼€æ‰€æœ‰æ¨¡å—**ï¼š

![](<../../.gitbook/assets/image (284).png>)

å³é”®å•å‡»**ç¨‹åºé›†èµ„æºç®¡ç†å™¨**ä¸­çš„ä»»ä½•æ¨¡å—ï¼Œç„¶åå•å‡»**æ’åºç¨‹åºé›†**ï¼š

![](<../../.gitbook/assets/image (285).png>)

## Javaåç¼–è¯‘å™¨

[https://github.com/skylot/jadx](https://github.com/skylot/jadx)\
[https://github.com/java-decompiler/jd-gui/releases](https://github.com/java-decompiler/jd-gui/releases)

## è°ƒè¯•DLLs

### ä½¿ç”¨IDA

* **åŠ è½½rundll32**ï¼ˆ64ä½ä½äºC:\Windows\System32\rundll32.exeï¼Œ32ä½ä½äºC:\Windows\SysWOW64\rundll32.exeï¼‰
* é€‰æ‹©**Windbg**è°ƒè¯•å™¨
* é€‰æ‹©â€œ**åœ¨åº“åŠ è½½/å¸è½½æ—¶æš‚åœ**â€

![](<../../.gitbook/assets/image (135).png>)

* é…ç½®æ‰§è¡Œçš„**å‚æ•°**ï¼Œæ”¾å…¥**DLLè·¯å¾„**å’Œè¦è°ƒç”¨çš„å‡½æ•°ï¼š

![](<../../.gitbook/assets/image (136).png>)

ç„¶åï¼Œå½“æ‚¨å¼€å§‹è°ƒè¯•æ—¶ï¼Œ**æ¯æ¬¡åŠ è½½DLLæ—¶æ‰§è¡Œéƒ½ä¼šåœæ­¢**ï¼Œç„¶åå½“rundll32åŠ è½½æ‚¨çš„DLLæ—¶ï¼Œæ‰§è¡Œå°†ä¼šåœæ­¢ã€‚

ä½†æ˜¯ï¼Œæ‚¨å¦‚ä½•æŸ¥çœ‹å·²åŠ è½½çš„DLLçš„ä»£ç å‘¢ï¼Ÿä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä¸çŸ¥é“å¦‚ä½•ã€‚

### ä½¿ç”¨x64dbg/x32dbg

* **åŠ è½½rundll32**ï¼ˆ64ä½ä½äºC:\Windows\System32\rundll32.exeï¼Œ32ä½ä½äºC:\Windows\SysWOW64\rundll32.exeï¼‰
* **æ›´æ”¹å‘½ä»¤è¡Œ**ï¼ˆ _æ–‡ä»¶ --> æ›´æ”¹å‘½ä»¤è¡Œ_ ï¼‰å¹¶è®¾ç½®dllçš„è·¯å¾„å’Œè¦è°ƒç”¨çš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼šâ€œC:\Windows\SysWOW64\rundll32.exeâ€ â€œZ:\shared\Cybercamp\rev2\\\14.ridii\_2.dllâ€,DLLMain
* æ›´æ”¹ _é€‰é¡¹ --> è®¾ç½®_ å¹¶é€‰æ‹©â€œ**DLLå…¥å£**â€ã€‚
* ç„¶å**å¼€å§‹æ‰§è¡Œ**ï¼Œè°ƒè¯•å™¨å°†åœ¨æ¯ä¸ªdllä¸»å‡½æ•°å¤„åœæ­¢ï¼Œæœ€ç»ˆæ‚¨å°†**åœåœ¨æ‚¨çš„dllçš„dllå…¥å£**ã€‚ä»é‚£é‡Œï¼Œåªéœ€æœç´¢è¦è®¾ç½®æ–­ç‚¹çš„ä½ç½®ã€‚

è¯·æ³¨æ„ï¼Œå½“win64dbgç”±äºä»»ä½•åŸå› åœæ­¢æ‰§è¡Œæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨**win64dbgçª—å£é¡¶éƒ¨**çœ‹åˆ°æ‚¨æ‰€åœ¨çš„**ä»£ç **ï¼š

![](<../../.gitbook/assets/image (137).png>)

ç„¶åï¼ŒæŸ¥çœ‹æ­¤å¤„ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ‰§è¡Œå·²åœ¨æ‚¨è¦è°ƒè¯•çš„dllä¸­åœæ­¢ã€‚

## GUIåº”ç”¨ç¨‹åº / è§†é¢‘æ¸¸æˆ

[**Cheat Engine**](https://www.cheatengine.org/downloads.php) æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç¨‹åºï¼Œå¯ç”¨äºæŸ¥æ‰¾è¿è¡Œæ¸¸æˆå†…å­˜ä¸­ä¿å­˜çš„é‡è¦å€¼å¹¶æ›´æ”¹å®ƒä»¬ã€‚æ›´å¤šä¿¡æ¯è¯·å‚é˜…ï¼š

{% content-ref url="cheat-engine.md" %}
[cheat-engine.md](cheat-engine.md)
{% endcontent-ref %}

## ARMå’ŒMIPS

{% embed url="https://github.com/nongiach/arm_now" %}

## Shellcode

### ä½¿ç”¨blobrunnerè°ƒè¯•shellcode

[**Blobrunner**](https://github.com/OALabs/BlobRunner) å°†åœ¨å†…å­˜ç©ºé—´ä¸­**åˆ†é…shellcode**ï¼Œå¹¶**æŒ‡ç¤º**æ‚¨shellcodeåˆ†é…çš„**å†…å­˜åœ°å€**ï¼Œç„¶å**åœæ­¢**æ‰§è¡Œã€‚\
ç„¶åï¼Œæ‚¨éœ€è¦å°†è°ƒè¯•å™¨ï¼ˆIdaæˆ–x64dbgï¼‰**é™„åŠ åˆ°è¿›ç¨‹**ï¼Œåœ¨æŒ‡ç¤ºçš„å†…å­˜åœ°å€å¤„è®¾ç½®**æ–­ç‚¹**ï¼Œç„¶å**æ¢å¤**æ‰§è¡Œã€‚è¿™æ ·æ‚¨å°±å¯ä»¥è°ƒè¯•shellcodeäº†ã€‚

å‘å¸ƒçš„githubé¡µé¢åŒ…å«äº†ç¼–è¯‘ç‰ˆæœ¬çš„zipæ–‡ä»¶ï¼š[https://github.com/OALabs/BlobRunner/releases/tag/v0.0.5](https://github.com/OALabs/BlobRunner/releases/tag/v0.0.5)\
æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹é“¾æ¥ä¸­æ‰¾åˆ°Blobrunnerçš„ç¨ä½œä¿®æ”¹çš„ç‰ˆæœ¬ã€‚è¦ç¼–è¯‘å®ƒï¼Œåªéœ€**åœ¨Visual Studio Codeä¸­åˆ›å»ºä¸€ä¸ªC/C++é¡¹ç›®ï¼Œå¤åˆ¶å¹¶ç²˜è´´ä»£ç ï¼Œç„¶åæ„å»º**ã€‚

{% content-ref url="blobrunner.md" %}
[blobrunner.md](blobrunner.md)
{% endcontent-ref %}

### ä½¿ç”¨jmp2itè°ƒè¯•shellcode

[**jmp2it** ](https://github.com/adamkramer/jmp2it/releases/tag/v1.4)ä¸blobrunneréå¸¸ç›¸ä¼¼ã€‚å®ƒå°†åœ¨å†…å­˜ç©ºé—´ä¸­**åˆ†é…shellcode**ï¼Œç„¶åå¯åŠ¨ä¸€ä¸ª**æ°¸ä¹…å¾ªç¯**ã€‚ç„¶åï¼Œæ‚¨éœ€è¦å°†è°ƒè¯•å™¨**é™„åŠ åˆ°è¿›ç¨‹**ï¼Œ**å¼€å§‹æ’­æ”¾ç­‰å¾…2-5ç§’ç„¶ååœæ­¢**ï¼Œæ‚¨å°†å‘ç°è‡ªå·±å¤„äº**æ°¸ä¹…å¾ªç¯**ä¸­ã€‚è·³è½¬åˆ°æ°¸ä¹…å¾ªç¯çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå› ä¸ºå®ƒå°†æ˜¯å¯¹shellcodeçš„è°ƒç”¨ï¼Œæœ€ç»ˆæ‚¨å°†å‘ç°è‡ªå·±æ­£åœ¨æ‰§è¡Œshellcodeã€‚

![](<../../.gitbook/assets/image (397).png>)

æ‚¨å¯ä»¥åœ¨[å‘å¸ƒé¡µé¢ä¸­ä¸‹è½½jmp2itçš„ç¼–è¯‘ç‰ˆæœ¬](https://github.com/adamkramer/jmp2it/releases/)ã€‚

### ä½¿ç”¨Cutterè°ƒè¯•shellcode

[**Cutter**](https://github.com/rizinorg/cutter/releases/tag/v1.12.0) æ˜¯radareçš„GUIã€‚ä½¿ç”¨Cutterï¼Œæ‚¨å¯ä»¥åŠ¨æ€åœ°æ¨¡æ‹Ÿå’Œæ£€æŸ¥shellcodeã€‚

è¯·æ³¨æ„ï¼ŒCutterå…è®¸æ‚¨â€œæ‰“å¼€æ–‡ä»¶â€å’Œâ€œæ‰“å¼€shellcodeâ€ã€‚åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œå½“æˆ‘å°†shellcodeä½œä¸ºæ–‡ä»¶æ‰“å¼€æ—¶ï¼Œå®ƒæ­£ç¡®åç¼–è¯‘äº†ï¼Œä½†å½“æˆ‘å°†å…¶ä½œä¸ºshellcodeæ‰“å¼€æ—¶ï¼Œå®ƒæ²¡æœ‰ï¼š

![](<../../.gitbook/assets/image (400).png>)

ä¸ºäº†ä»æ‚¨æƒ³è¦çš„ä½ç½®å¼€å§‹æ¨¡æ‹Ÿï¼Œè®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œæ˜¾ç„¶Cutterå°†è‡ªåŠ¨ä»é‚£é‡Œå¼€å§‹æ¨¡æ‹Ÿï¼š

![](<../../.gitbook/assets/image (399).png>)

![](<../../.gitbook/assets/image (401).png>)

æ‚¨å¯ä»¥åœ¨åå…­è¿›åˆ¶è½¬å‚¨ä¸­æŸ¥çœ‹å †æ ˆï¼Œä¾‹å¦‚ï¼š

![](<../../.gitbook/assets/image (402).png>)

### è§£æ··æ·†shellcodeå¹¶è·å–æ‰§è¡Œå‡½æ•°

æ‚¨åº”è¯¥å°è¯•[**scdbg**](http://sandsprite.com/blogs/index.php?uid=7\&pid=152)ã€‚\
å®ƒå°†å‘Šè¯‰æ‚¨shellcodeæ­£åœ¨ä½¿ç”¨çš„**å“ªäº›å‡½æ•°**ï¼Œä»¥åŠshellcodeæ˜¯å¦åœ¨å†…å­˜ä¸­**è§£ç **è‡ªèº«ã€‚
```bash
scdbg.exe -f shellcode # Get info
scdbg.exe -f shellcode -r #show analysis report at end of run
scdbg.exe -f shellcode -i -r #enable interactive hooks (file and network) and show analysis report at end of run
scdbg.exe -f shellcode -d #Dump decoded shellcode
scdbg.exe -f shellcode /findsc #Find offset where starts
scdbg.exe -f shellcode /foff 0x0000004D #Start the executing in that offset
```
scDbgè¿˜é…å¤‡äº†ä¸€ä¸ªå›¾å½¢å¯åŠ¨å™¨ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­é€‰æ‹©æ‰€éœ€çš„é€‰é¡¹å¹¶æ‰§è¡Œshellcode

![](<../../.gitbook/assets/image (398).png>)

**åˆ›å»ºDump**é€‰é¡¹å°†åœ¨å†…å­˜ä¸­åŠ¨æ€æ›´æ”¹shellcodeæ—¶è½¬å‚¨æœ€ç»ˆshellcodeï¼ˆæœ‰åŠ©äºä¸‹è½½è§£ç åçš„shellcodeï¼‰ã€‚**èµ·å§‹åç§»**å¯¹äºåœ¨ç‰¹å®šåç§»å¤„å¯åŠ¨shellcodeå¾ˆæœ‰ç”¨ã€‚**è°ƒè¯•Shell**é€‰é¡¹å¯ç”¨äºä½¿ç”¨scDbgç»ˆç«¯è°ƒè¯•shellcodeï¼ˆä½†æˆ‘å‘ç°å‰é¢è§£é‡Šçš„ä»»ä½•é€‰é¡¹åœ¨è¿™æ–¹é¢æ›´å¥½ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿ç”¨Idaæˆ–x64dbgï¼‰ã€‚

### ä½¿ç”¨CyberChefè¿›è¡Œåæ±‡ç¼–

å°†shellcodeæ–‡ä»¶ä¸Šä¼ ä¸ºè¾“å…¥ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹é…æ–¹å¯¹å…¶è¿›è¡Œåç¼–è¯‘ï¼š[https://gchq.github.io/CyberChef/#recipe=To\_Hex('Space',0)Disassemble\_x86('32','Full%20x86%20architecture',16,0,true,true)](https://gchq.github.io/CyberChef/#recipe=To\_Hex\('Space',0\)Disassemble\_x86\('32','Full%20x86%20architecture',16,0,true,true\))

## [Movfuscator](https://github.com/xoreaxeaxeax/movfuscator)

è¿™ä¸ªæ··æ·†å™¨**ä¿®æ”¹æ‰€æœ‰`mov`æŒ‡ä»¤**ï¼ˆæ˜¯çš„ï¼Œéå¸¸é…·ï¼‰ã€‚å®ƒè¿˜ä½¿ç”¨ä¸­æ–­æ¥æ”¹å˜æ‰§è¡Œæµã€‚æœ‰å…³å…¶å·¥ä½œåŸç†çš„æ›´å¤šä¿¡æ¯ï¼š

* [https://www.youtube.com/watch?v=2VF\_wPkiBJY](https://www.youtube.com/watch?v=2VF\_wPkiBJY)
* [https://github.com/xoreaxeaxeax/movfuscator/blob/master/slides/domas\_2015\_the\_movfuscator.pdf](https://github.com/xoreaxeaxeax/movfuscator/blob/master/slides/domas\_2015\_the\_movfuscator.pdf)

å¦‚æœæ‚¨å¾ˆå¹¸è¿ï¼Œ[demovfuscator ](https://github.com/kirschju/demovfuscator)å°†å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåæ··æ·†ã€‚å®ƒæœ‰å‡ ä¸ªä¾èµ–é¡¹
```
apt-get install libcapstone-dev
apt-get install libz3-dev
```
å¹¶[å®‰è£…keystone](https://github.com/keystone-engine/keystone/blob/master/docs/COMPILE-NIX.md) (`apt-get install cmake; mkdir build; cd build; ../make-share.sh; make install`)

å¦‚æœä½ åœ¨ç©**CTFï¼Œè¿™ä¸ªç»•è¿‡æ–¹æ³•æ‰¾åˆ°flag**å¯èƒ½éå¸¸æœ‰ç”¨ï¼š[https://dustri.org/b/defeating-the-recons-movfuscator-crackme.html](https://dustri.org/b/defeating-the-recons-movfuscator-crackme.html)

## Rust

è¦æ‰¾åˆ°**å…¥å£ç‚¹**ï¼Œæœç´¢å‡½æ•°ä¸­çš„`::main`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](<../../.gitbook/assets/image (612).png>)

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶è¢«ç§°ä¸ºauthenticatorï¼Œå› æ­¤å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„ä¸»å‡½æ•°ã€‚\
æœ‰äº†è¢«è°ƒç”¨çš„**å‡½æ•°çš„åç§°**ï¼Œåœ¨**äº’è”ç½‘**ä¸Šæœç´¢å®ƒä»¬ï¼Œäº†è§£å®ƒä»¬çš„**è¾“å…¥**å’Œ**è¾“å‡º**ã€‚

## **Delphi**

å¯¹äºDelphiç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨[https://github.com/crypto2011/IDR](https://github.com/crypto2011/IDR)

å¦‚æœä½ éœ€è¦åå‘ä¸€ä¸ªDelphiäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨IDAæ’ä»¶[https://github.com/Coldzer0/IDA-For-Delphi](https://github.com/Coldzer0/IDA-For-Delphi)

åªéœ€æŒ‰ä¸‹**ATL+f7**ï¼ˆåœ¨IDAä¸­å¯¼å…¥Pythonæ’ä»¶ï¼‰ï¼Œç„¶åé€‰æ‹©Pythonæ’ä»¶ã€‚

æ­¤æ’ä»¶å°†åœ¨è°ƒè¯•å¼€å§‹æ—¶æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶å¹¶åŠ¨æ€è§£æå‡½æ•°åç§°ã€‚å¼€å§‹è°ƒè¯•åå†æ¬¡æŒ‰ä¸‹å¼€å§‹æŒ‰é’®ï¼ˆç»¿è‰²æŒ‰é’®æˆ–f9ï¼‰ï¼Œå°†åœ¨çœŸå®ä»£ç çš„å¼€å¤´è§¦å‘æ–­ç‚¹ã€‚

è¿™ä¹Ÿéå¸¸æœ‰è¶£ï¼Œå› ä¸ºå¦‚æœåœ¨å›¾å½¢åº”ç”¨ç¨‹åºä¸­æŒ‰ä¸‹æŒ‰é’®ï¼Œè°ƒè¯•å™¨å°†åœåœ¨ç”±è¯¥æŒ‰é’®æ‰§è¡Œçš„å‡½æ•°ä¸­ã€‚

## Golang

å¦‚æœä½ éœ€è¦åå‘ä¸€ä¸ªGolangäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨IDAæ’ä»¶[https://github.com/sibears/IDAGolangHelper](https://github.com/sibears/IDAGolangHelper)

åªéœ€æŒ‰ä¸‹**ATL+f7**ï¼ˆåœ¨IDAä¸­å¯¼å…¥Pythonæ’ä»¶ï¼‰ï¼Œç„¶åé€‰æ‹©Pythonæ’ä»¶ã€‚

è¿™å°†è§£æå‡½æ•°çš„åç§°ã€‚

## ç¼–è¯‘çš„Python

åœ¨è¿™ä¸ªé¡µé¢ä¸Šï¼Œä½ å¯ä»¥æ‰¾åˆ°å¦‚ä½•ä»ä¸€ä¸ªELF/EXE Pythonç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è·å–Pythonä»£ç ï¼š

{% content-ref url="../../forensics/basic-forensic-methodology/specific-software-file-type-tricks/.pyc.md" %}
[.pyc.md](../../forensics/basic-forensic-methodology/specific-software-file-type-tricks/.pyc.md)
{% endcontent-ref %}

## GBA - Game Body Advance

å¦‚æœä½ å¾—åˆ°ä¸€ä¸ªGBAæ¸¸æˆçš„**äºŒè¿›åˆ¶æ–‡ä»¶**ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„å·¥å…·æ¥**æ¨¡æ‹Ÿ**å’Œ**è°ƒè¯•**å®ƒï¼š

* [**no$gba**](https://problemkaputt.de/gba.htm)ï¼ˆ_ä¸‹è½½è°ƒè¯•ç‰ˆæœ¬_ï¼‰- åŒ…å«ä¸€ä¸ªå¸¦ç•Œé¢çš„è°ƒè¯•å™¨
* [**mgba** ](https://mgba.io)- åŒ…å«ä¸€ä¸ªCLIè°ƒè¯•å™¨
* [**gba-ghidra-loader**](https://github.com/pudii/gba-ghidra-loader) - Ghidraæ’ä»¶
* [**GhidraGBA**](https://github.com/SiD3W4y/GhidraGBA) - Ghidraæ’ä»¶

åœ¨[**no$gba**](https://problemkaputt.de/gba.htm)ä¸­ï¼Œåœ¨_**Options --> Emulation Setup --> Controls**_\*\* \*\*ä½ å¯ä»¥çœ‹åˆ°å¦‚ä½•æŒ‰ä¸‹Game Boy Advanceçš„**æŒ‰é’®**

![](<../../.gitbook/assets/image (578).png>)

æŒ‰ä¸‹æ—¶ï¼Œæ¯ä¸ª**é”®éƒ½æœ‰ä¸€ä¸ªå€¼**æ¥è¯†åˆ«å®ƒï¼š
```
A = 1
B = 2
SELECT = 4
START = 8
RIGHT = 16
LEFT = 32
UP = 64
DOWN = 128
R = 256
L = 256
```
å› æ­¤ï¼Œåœ¨è¿™ç§ç¨‹åºä¸­ï¼Œä¸€ä¸ªæœ‰è¶£çš„éƒ¨åˆ†å°†æ˜¯**ç¨‹åºå¦‚ä½•å¤„ç†ç”¨æˆ·è¾“å…¥**ã€‚åœ¨åœ°å€**0x4000130**ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°å¸¸è§çš„å‡½æ•°ï¼š**KEYINPUT**ã€‚

![](<../../.gitbook/assets/image (579).png>)

åœ¨ä¸Šå›¾ä¸­ï¼Œæ‚¨å¯ä»¥å‘ç°è¯¥å‡½æ•°æ˜¯ä»**FUN\_080015a8**ï¼ˆåœ°å€ï¼š_0x080015fa_ å’Œ _0x080017ac_ï¼‰è°ƒç”¨çš„ã€‚

åœ¨è¯¥å‡½æ•°ä¸­ï¼Œåœ¨è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œä¹‹åï¼ˆæ²¡æœ‰ä»»ä½•é‡è¦æ€§ï¼‰ï¼š
```c
void FUN_080015a8(void)

{
ushort uVar1;
undefined4 uVar2;
undefined4 uVar3;
ushort uVar4;
int iVar5;
ushort *puVar6;
undefined *local_2c;

DISPCNT = 0x1140;
FUN_08000a74();
FUN_08000ce4(1);
DISPCNT = 0x404;
FUN_08000dd0(&DAT_02009584,0x6000000,&DAT_030000dc);
FUN_08000354(&DAT_030000dc,0x3c);
uVar4 = DAT_030004d8;
```
å‘ç°äº†è¿™æ®µä»£ç ï¼š
```c
do {
DAT_030004da = uVar4; //This is the last key pressed
DAT_030004d8 = KEYINPUT | 0xfc00;
puVar6 = &DAT_0200b03c;
uVar4 = DAT_030004d8;
do {
uVar2 = DAT_030004dc;
uVar1 = *puVar6;
if ((uVar1 & DAT_030004da & ~uVar4) != 0) {
```
æœ€åçš„ifè¯­å¥æ£€æŸ¥**`uVar4`**æ˜¯å¦åœ¨**æœ€åçš„Keys**ä¸­ï¼Œè€Œä¸æ˜¯å½“å‰çš„å¯†é’¥ï¼Œä¹Ÿç§°ä¸ºé‡Šæ”¾æŒ‰é’®ï¼ˆå½“å‰å¯†é’¥å­˜å‚¨åœ¨**`uVar1`**ä¸­ï¼‰ã€‚
```c
if (uVar1 == 4) {
DAT_030000d4 = 0;
uVar3 = FUN_08001c24(DAT_030004dc);
FUN_08001868(uVar2,0,uVar3);
DAT_05000000 = 0x1483;
FUN_08001844(&DAT_0200ba18);
FUN_08001844(&DAT_0200ba20,&DAT_0200ba40);
DAT_030000d8 = 0;
uVar4 = DAT_030004d8;
}
else {
if (uVar1 == 8) {
if (DAT_030000d8 == 0xf3) {
DISPCNT = 0x404;
FUN_08000dd0(&DAT_02008aac,0x6000000,&DAT_030000dc);
FUN_08000354(&DAT_030000dc,0x3c);
uVar4 = DAT_030004d8;
}
}
else {
if (DAT_030000d4 < 8) {
DAT_030000d4 = DAT_030000d4 + 1;
FUN_08000864();
if (uVar1 == 0x10) {
DAT_030000d8 = DAT_030000d8 + 0x3a;
```
åœ¨å‰é¢çš„ä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ­£åœ¨å°†**uVar1**ï¼ˆæŒ‰ä¸‹æŒ‰é’®çš„**å€¼æ‰€åœ¨çš„ä½ç½®**ï¼‰ä¸ä¸€äº›å€¼è¿›è¡Œæ¯”è¾ƒï¼š

* é¦–å…ˆï¼Œå®ƒä¸**å€¼4**ï¼ˆ**SELECT**æŒ‰é’®ï¼‰è¿›è¡Œæ¯”è¾ƒï¼šåœ¨æŒ‘æˆ˜ä¸­ï¼Œæ­¤æŒ‰é’®æ¸…é™¤å±å¹•
* ç„¶åï¼Œå°†å…¶ä¸**å€¼8**ï¼ˆ**START**æŒ‰é’®ï¼‰è¿›è¡Œæ¯”è¾ƒï¼šåœ¨æŒ‘æˆ˜ä¸­ï¼Œè¿™ä¼šæ£€æŸ¥ä»£ç æ˜¯å¦æœ‰æ•ˆä»¥è·å–æ ‡å¿—ã€‚
* åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†å˜é‡**`DAT_030000d8`**ä¸0xf3è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå€¼ç›¸åŒï¼Œåˆ™æ‰§è¡Œä¸€äº›ä»£ç ã€‚
* åœ¨ä»»ä½•å…¶ä»–æƒ…å†µä¸‹ï¼Œå°†æ£€æŸ¥ä¸€äº›contï¼ˆ`DAT_030000d4`ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªcontï¼Œå› ä¸ºåœ¨è¾“å…¥ä»£ç åç«‹å³åŠ 1ã€‚
* å¦‚æœå°äº8ï¼Œåˆ™æ‰§è¡Œæ¶‰åŠå‘**`DAT_030000d8`**æ·»åŠ å€¼çš„æ“ä½œï¼ˆåŸºæœ¬ä¸Šæ˜¯å°†æŒ‰ä¸‹çš„é”®çš„å€¼æ·»åŠ åˆ°æ­¤å˜é‡ä¸­ï¼Œåªè¦contå°äº8ï¼‰ã€‚

å› æ­¤ï¼Œåœ¨è¿™ä¸ªæŒ‘æˆ˜ä¸­ï¼Œäº†è§£æŒ‰é’®çš„å€¼ï¼Œæ‚¨éœ€è¦**æŒ‰ä¸‹é•¿åº¦å°äº8çš„ç»„åˆï¼Œä½¿å¾—ç»“æœç›¸åŠ ä¸º0xf3**ã€‚

**æœ¬æ•™ç¨‹çš„å‚è€ƒèµ„æ–™ï¼š** [**https://exp.codes/Nostalgia/**](https://exp.codes/Nostalgia/)

## Game Boy

{% embed url="https://www.youtube.com/watch?v=VVbRe7wr3G4" %}

## è¯¾ç¨‹

* [https://github.com/0xZ0F/Z0FCourse\_ReverseEngineering](https://github.com/0xZ0F/Z0FCourse\_ReverseEngineering)
* [https://github.com/malrev/ABD](https://github.com/malrev/ABD)ï¼ˆäºŒè¿›åˆ¶åæ··æ·†ï¼‰

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
