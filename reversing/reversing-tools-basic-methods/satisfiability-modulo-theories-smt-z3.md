<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€ä¸ª **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼ŸæŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å¾— [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>


éå¸¸åŸºæœ¬åœ°è¯´ï¼Œè¿™ä¸ªå·¥å…·å°†å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°éœ€è¦æ»¡è¶³ä¸€äº›æ¡ä»¶çš„å˜é‡çš„å€¼ï¼Œæ‰‹åŠ¨è®¡ç®—è¿™äº›å€¼å°†ä¼šéå¸¸éº»çƒ¦ã€‚å› æ­¤ï¼Œä½ å¯ä»¥å‘Šè¯‰ Z3 å˜é‡éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œå®ƒå°†æ‰¾åˆ°ä¸€äº›å€¼ï¼ˆå¦‚æœå¯èƒ½çš„è¯ï¼‰ã€‚

# åŸºæœ¬æ“ä½œ

## å¸ƒå°”å€¼/ä¸/æˆ–/é
```python
#pip3 install z3-solver
from z3 import *
s = Solver() #The solver will be given the conditions

x = Bool("x") #Declare the symbos x, y and z
y = Bool("y")
z = Bool("z")

# (x or y or !z) and y
s.add(And(Or(x,y,Not(z)),y))
s.check() #If response is "sat" then the model is satifable, if "unsat" something is wrong
print(s.model()) #Print valid values to satisfy the model
```
## æ•´æ•°/ç®€åŒ–/å®æ•°

SMTï¼ˆSatisfiability Modulo Theoriesï¼‰æ±‚è§£å™¨Z3æ”¯æŒæ•´æ•°ã€ç®€åŒ–å’Œå®æ•°ã€‚è¿™äº›åŠŸèƒ½ä½¿å¾—Z3æˆä¸ºä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºè§£å†³ä¸æ•´æ•°å’Œå®æ•°ç›¸å…³çš„é—®é¢˜ã€‚

### æ•´æ•°

Z3å¯ä»¥å¤„ç†æ•´æ•°å˜é‡å’Œæ•´æ•°è¡¨è¾¾å¼ã€‚å®ƒæ”¯æŒæ•´æ•°çš„åŸºæœ¬è¿ç®—ï¼Œå¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•å’Œé™¤æ³•ã€‚æ­¤å¤–ï¼ŒZ3è¿˜æ”¯æŒæ¯”è¾ƒè¿ç®—ç¬¦ï¼Œå¦‚ç­‰äºã€ä¸ç­‰äºã€å¤§äºã€å°äºã€å¤§äºç­‰äºå’Œå°äºç­‰äºã€‚

### ç®€åŒ–

Z3çš„ç®€åŒ–åŠŸèƒ½å¯ä»¥å¯¹è¡¨è¾¾å¼è¿›è¡Œç®€åŒ–ï¼Œä»¥å¾—åˆ°ç­‰ä»·ä½†æ›´ç®€æ´çš„è¡¨è¾¾å¼ã€‚è¿™å¯¹äºä¼˜åŒ–å’Œç®€åŒ–å¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼éå¸¸æœ‰ç”¨ã€‚

### å®æ•°

é™¤äº†æ•´æ•°ï¼ŒZ3è¿˜æ”¯æŒå®æ•°ã€‚å®ƒå¯ä»¥å¤„ç†å®æ•°å˜é‡å’Œå®æ•°è¡¨è¾¾å¼ï¼Œå¹¶æ”¯æŒå®æ•°çš„åŸºæœ¬è¿ç®—å’Œæ¯”è¾ƒè¿ç®—ç¬¦ã€‚

æ€»ä¹‹ï¼ŒZ3çš„æ•´æ•°ã€ç®€åŒ–å’Œå®æ•°åŠŸèƒ½ä½¿å…¶æˆä¸ºä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºè§£å†³ä¸æ•´æ•°å’Œå®æ•°ç›¸å…³çš„é—®é¢˜ã€‚
```python
from z3 import *

x = Int('x')
y = Int('y')
#Simplify a "complex" ecuation
print(simplify(And(x + 1 >= 3, x**2 + x**2 + y**2 + 2 >= 5)))
#And(x >= 2, 2*x**2 + y**2 >= 3)

#Note that Z3 is capable to treat irrational numbers (An irrational algebraic number is a root of a polynomial with integer coefficients. Internally, Z3 represents all these numbers precisely.)
#so you can get the decimals you need from the solution
r1 = Real('r1')
r2 = Real('r2')
#Solve the ecuation
print(solve(r1**2 + r2**2 == 3, r1**3 == 2))
#Solve the ecuation with 30 decimals
set_option(precision=30)
print(solve(r1**2 + r2**2 == 3, r1**3 == 2))
```
## æ‰“å°æ¨¡å‹

To print the model generated by Z3, you can use the `model` method. This method returns a string representation of the model. 

è¦æ‰“å°Z3ç”Ÿæˆçš„æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨`model`æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¿”å›æ¨¡å‹çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚

```python
print(s.model())
```

The output will display the values assigned to each variable in the model. 

è¾“å‡ºå°†æ˜¾ç¤ºæ¨¡å‹ä¸­æ¯ä¸ªå˜é‡è¢«èµ‹äºˆçš„å€¼ã€‚

```plaintext
[x = 1, y = 2, z = 3]
```

You can also access the individual values of the variables using the `eval` method. 

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨`eval`æ–¹æ³•è®¿é—®å˜é‡çš„å„ä¸ªå€¼ã€‚

```python
x_value = s.model().eval(x)
y_value = s.model().eval(y)
z_value = s.model().eval(z)
```

This allows you to retrieve and use the values of the variables in your program. 

è¿™æ ·å¯ä»¥åœ¨ç¨‹åºä¸­æ£€ç´¢å’Œä½¿ç”¨å˜é‡çš„å€¼ã€‚
```python
from z3 import *

x, y, z = Reals('x y z')
s = Solver()
s.add(x > 1, y > 1, x + y > 3, z - x < 10)
s.check()

m = s.model()
print ("x = %s" % m[x])
for d in m.decls():
print("%s = %s" % (d.name(), m[d]))
```
# æœºå™¨ç®—æœ¯

ç°ä»£CPUå’Œä¸»æµç¼–ç¨‹è¯­è¨€ä½¿ç”¨**å›ºå®šå¤§å°çš„ä½å‘é‡**è¿›è¡Œç®—æœ¯è¿ç®—ã€‚åœ¨Z3Pyä¸­ï¼Œæœºå™¨ç®—æœ¯å¯ç”¨ä½œ**ä½å‘é‡**ã€‚
```python
from z3 import *

x = BitVec('x', 16) #Bit vector variable "x" of length 16 bit
y = BitVec('y', 16)

e = BitVecVal(10, 16) #Bit vector with value 10 of length 16bits
a = BitVecVal(-1, 16)
b = BitVecVal(65535, 16)
print(simplify(a == b)) #This is True!
a = BitVecVal(-1, 32)
b = BitVecVal(65535, 32)
print(simplify(a == b)) #This is False
```
## æœ‰ç¬¦å·/æ— ç¬¦å·æ•°

Z3æä¾›äº†ç‰¹æ®Šçš„æœ‰ç¬¦å·ç‰ˆæœ¬çš„ç®—æœ¯æ“ä½œï¼Œå…¶ä¸­**ä½å‘é‡è¢«è§†ä¸ºæœ‰ç¬¦å·æˆ–æ— ç¬¦å·**æ˜¯æœ‰åŒºåˆ«çš„ã€‚åœ¨Z3Pyä¸­ï¼Œè¿ç®—ç¬¦**<, <=, >, >=, /, % å’Œ >>**å¯¹åº”äº**æœ‰ç¬¦å·**ç‰ˆæœ¬ã€‚ç›¸åº”çš„**æ— ç¬¦å·**è¿ç®—ç¬¦æ˜¯**ULT, ULE, UGT, UGE, UDiv, URem å’Œ LShR**ã€‚
```python
from z3 import *

# Create to bit-vectors of size 32
x, y = BitVecs('x y', 32)
solve(x + y == 2, x > 0, y > 0)

# Bit-wise operators
# & bit-wise and
# | bit-wise or
# ~ bit-wise not
solve(x & y == ~y)
solve(x < 0)

# using unsigned version of <
solve(ULT(x, 0))
```
## å‡½æ•°

**è§£é‡Šå‡½æ•°**ï¼Œä¾‹å¦‚ç®—æœ¯å‡½æ•°ï¼Œå…¶ä¸­**å‡½æ•° +**å…·æœ‰**å›ºå®šçš„æ ‡å‡†è§£é‡Š**ï¼ˆå®ƒå°†ä¸¤ä¸ªæ•°å­—ç›¸åŠ ï¼‰ã€‚**æœªè§£é‡Šå‡½æ•°**å’Œå¸¸é‡æ˜¯**æœ€å¤§çµæ´»æ€§**çš„ï¼›å®ƒä»¬å…è®¸**ä¸å‡½æ•°æˆ–å¸¸é‡çš„çº¦æŸä¸€è‡´çš„ä»»ä½•è§£é‡Š**ã€‚

ä¾‹å¦‚ï¼šå°† f åº”ç”¨ä¸¤æ¬¡äº x çš„ç»“æœå†æ¬¡ä¸º xï¼Œä½†å°† f åº”ç”¨ä¸€æ¬¡äº x çš„ç»“æœä¸ x ä¸åŒã€‚
```python
from z3 import *

x = Int('x')
y = Int('y')
f = Function('f', IntSort(), IntSort())
s = Solver()
s.add(f(f(x)) == x, f(x) == y, x != y)
s.check()
m = s.model()
print("f(f(x)) =", m.evaluate(f(f(x))))
print("f(x)    =", m.evaluate(f(x)))

print(m.evaluate(f(2)))
s.add(f(x) == 4) #Find the value that generates 4 as response
s.check()
print(m.model())
```
# ç¤ºä¾‹

## æ•°ç‹¬æ±‚è§£å™¨

```python
from z3 import *

def solve_sudoku(grid):
    # åˆ›å»ºä¸€ä¸ª9x9çš„æ•´æ•°å˜é‡çŸ©é˜µ
    X = [ [ Int("x_%s_%s" % (i+1, j+1)) for j in range(9) ]
          for i in range(9) ]

    # æ¯ä¸ªå•å…ƒæ ¼çš„å€¼åœ¨1åˆ°9ä¹‹é—´
    cells_c  = [ And(1 <= X[i][j], X[i][j] <= 9)
                 for i in range(9) for j in range(9) ]

    # æ¯è¡Œçš„å€¼å”¯ä¸€
    rows_c   = [ Distinct(X[i]) for i in range(9) ]

    # æ¯åˆ—çš„å€¼å”¯ä¸€
    cols_c   = [ Distinct([ X[i][j] for i in range(9) ])
                 for j in range(9) ]

    # æ¯ä¸ª3x3çš„å­ç½‘æ ¼ä¸­çš„å€¼å”¯ä¸€
    cells_c += [ Distinct([ X[3*i0 + i][3*j0 + j]
                           for i in range(3) for j in range(3) ])
                 for i0 in range(3) for j0 in range(3) ]

    # å·²çŸ¥çš„å•å…ƒæ ¼çš„çº¦æŸ
    sudoku_c = [ If(grid[i][j] == 0, True, X[i][j] == grid[i][j])
                 for i in range(9) for j in range(9) ]

    # åˆ›å»ºæ±‚è§£å™¨å¯¹è±¡
    s = Solver()

    # æ·»åŠ æ‰€æœ‰çº¦æŸ
    s.add(cells_c + rows_c + cols_c + cells_c)

    # æ±‚è§£æ•°ç‹¬
    if s.check() == sat:
        m = s.model()
        r = [ [ m.evaluate(X[i][j]) for j in range(9) ]
              for i in range(9) ]
        return r
    else:
        return None

# æ•°ç‹¬é—®é¢˜
grid = [ [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
         [ 0, 0, 0, 0, 0, 0, 0, 0, 0 ] ]

# è§£å†³æ•°ç‹¬é—®é¢˜
solution = solve_sudoku(grid)

# æ‰“å°è§£å†³æ–¹æ¡ˆ
if solution is not None:
    for row in solution:
        print(row)
else:
    print("No solution found")
```

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨Z3æ±‚è§£æ•°ç‹¬é—®é¢˜çš„ç¤ºä¾‹ã€‚å®ƒé€šè¿‡åˆ›å»ºä¸€ä¸ª9x9çš„æ•´æ•°å˜é‡çŸ©é˜µæ¥è¡¨ç¤ºæ•°ç‹¬çš„å•å…ƒæ ¼ï¼Œå¹¶æ·»åŠ çº¦æŸæ¡ä»¶æ¥ç¡®ä¿æ¯ä¸ªå•å…ƒæ ¼çš„å€¼åœ¨1åˆ°9ä¹‹é—´ï¼Œå¹¶ä¸”æ¯è¡Œã€æ¯åˆ—ä»¥åŠæ¯ä¸ª3x3çš„å­ç½‘æ ¼ä¸­çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚ç„¶åï¼Œå®ƒæ ¹æ®å·²çŸ¥çš„å•å…ƒæ ¼çš„çº¦æŸæ¡ä»¶ï¼Œä½¿ç”¨Z3æ±‚è§£å™¨æ¥æ±‚è§£æ•°ç‹¬é—®é¢˜ã€‚å¦‚æœå­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œåˆ™æ‰“å°è§£å†³æ–¹æ¡ˆï¼›å¦åˆ™ï¼Œæ‰“å°"æ— è§£"ã€‚
```python
# 9x9 matrix of integer variables
X = [ [ Int("x_%s_%s" % (i+1, j+1)) for j in range(9) ]
for i in range(9) ]

# each cell contains a value in {1, ..., 9}
cells_c  = [ And(1 <= X[i][j], X[i][j] <= 9)
for i in range(9) for j in range(9) ]

# each row contains a digit at most once
rows_c   = [ Distinct(X[i]) for i in range(9) ]

# each column contains a digit at most once
cols_c   = [ Distinct([ X[i][j] for i in range(9) ])
for j in range(9) ]

# each 3x3 square contains a digit at most once
sq_c     = [ Distinct([ X[3*i0 + i][3*j0 + j]
for i in range(3) for j in range(3) ])
for i0 in range(3) for j0 in range(3) ]

sudoku_c = cells_c + rows_c + cols_c + sq_c

# sudoku instance, we use '0' for empty cells
instance = ((0,0,0,0,9,4,0,3,0),
(0,0,0,5,1,0,0,0,7),
(0,8,9,0,0,0,0,4,0),
(0,0,0,0,0,0,2,0,8),
(0,6,0,2,0,1,0,5,0),
(1,0,2,0,0,0,0,0,0),
(0,7,0,0,0,0,5,2,0),
(9,0,0,0,6,5,0,0,0),
(0,4,0,9,7,0,0,0,0))

instance_c = [ If(instance[i][j] == 0,
True,
X[i][j] == instance[i][j])
for i in range(9) for j in range(9) ]

s = Solver()
s.add(sudoku_c + instance_c)
if s.check() == sat:
m = s.model()
r = [ [ m.evaluate(X[i][j]) for j in range(9) ]
for i in range(9) ]
print_matrix(r)
else:
print "failed to solve"
```
# å‚è€ƒèµ„æ–™

* [https://ericpony.github.io/z3py-tutorial/guide-examples.htm](https://ericpony.github.io/z3py-tutorial/guide-examples.htm)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæƒ³è¦åœ¨ HackTricks ä¸­**å®£ä¼ ä½ çš„å…¬å¸**å—ï¼Ÿæˆ–è€…æƒ³è¦**è·å– PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

- å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆâ€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)

- **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **é€šè¿‡å‘ [hacktricks ä»“åº“](https://github.com/carlospolop/hacktricks) å’Œ [hacktricks-cloud ä»“åº“](https://github.com/carlospolop/hacktricks-cloud) æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
