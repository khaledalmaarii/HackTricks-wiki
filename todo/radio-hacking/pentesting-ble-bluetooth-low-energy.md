# Pentesting BLE - Bluetooth Low Energy

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Uvod

Dostupan od Bluetooth 4.0 specifikacije, BLE koristi samo 40 kanala, koji pokrivaju opseg od 2400 do 2483.5 MHz. Za razliku od toga, tradicionalni Bluetooth koristi 79 kanala u istom opsegu.

BLE ureÄ‘aji komuniciraju slanjem **reklamnih paketa** (**beacons**), ovi paketi emituju postojanje BLE ureÄ‘aja drugim ureÄ‘ajima u blizini. Ovi beacons ponekad takoÄ‘e **Å¡alju podatke**.

SluÅ¡ajuÄ‡i ureÄ‘aj, takoÄ‘e nazvan centralni ureÄ‘aj, moÅ¾e odgovoriti na reklamni paket sa **SCAN zahtevom** poslatim specifiÄno reklamnom ureÄ‘aju. **Odgovor** na taj skeniranje koristi istu strukturu kao i **reklamni** paket sa dodatnim informacijama koje nisu mogle stati u poÄetni reklamni zahtev, kao Å¡to je puno ime ureÄ‘aja.

![](<../../.gitbook/assets/image (201) (2) (1) (1).png>)

Preambula bajt sinhronizuje frekvenciju, dok je Äetvorobajtna pristupna adresa **identifikator veze**, koji se koristi u scenarijima kada se viÅ¡e ureÄ‘aja pokuÅ¡ava uspostaviti veze na istim kanalima. Zatim, Protokolna podatkovna jedinica (**PDU**) sadrÅ¾i **reklamne podatke**. Postoji nekoliko vrsta PDU-a; najÄeÅ¡Ä‡e koriÅ¡Ä‡eni su ADV\_NONCONN\_IND i ADV\_IND. UreÄ‘aji koriste tip PDU-a **ADV\_NONCONN\_IND** ako **ne prihvataju veze**, prenoseÄ‡i podatke samo u reklamnom paketu. UreÄ‘aji koriste **ADV\_IND** ako **dozvoljavaju veze** i **prestanu slati reklamne** pakete jednom kada je **veza uspostavljena**.

### GATT

**Generic Attribute Profile** (GATT) definiÅ¡e kako **ureÄ‘aj treba formatirati i prenositi podatke**. Kada analizirate napadnu povrÅ¡inu BLE ureÄ‘aja, Äesto Ä‡ete se koncentrisati na GATT (ili GATT-ove), jer je to naÄin na koji se **pokreÄ‡e funkcionalnost ureÄ‘aja** i kako se podaci skladiÅ¡te, grupiÅ¡u i menjaju. GATT navodi karakteristike, deskriptore i servise ureÄ‘aja u tabeli kao vrednosti od 16 ili 32 bita. **Karakteristika** je **vrednost podataka** **poslata** izmeÄ‘u centralnog ureÄ‘aja i periferije. Ove karakteristike mogu imati **deskriptore** koji **pruÅ¾aju dodatne informacije o njima**. **Karakteristike** se Äesto **grupiÅ¡u** u **servise** ako su povezane sa izvoÄ‘enjem odreÄ‘ene radnje.

## Enumeracija

```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```

### GATTool

**GATTool** omoguÄ‡ava **uspostavljanje** **veze** sa drugim ureÄ‘ajem, prikazivanje karakteristika tog ureÄ‘aja, i Äitanje i pisanje njegovih atributa.\
GATTTool moÅ¾e pokrenuti interaktivnu ljusku sa opcijom `-I`:

```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```

### Bettercap

Bettercap je moÄ‡an alat za pentestiranje Bluetooth Low Energy (BLE) mreÅ¾a. OmoguÄ‡ava vam da izvrÅ¡ite razliÄite napade na BLE ureÄ‘aje i analizirate njihovu sigurnost.

#### Instalacija

Da biste instalirali Bettercap, moÅ¾ete koristiti sledeÄ‡u komandu:

```
sudo apt install bettercap
```

#### Pokretanje Bettercap-a

Da biste pokrenuli Bettercap, koristite sledeÄ‡u komandu:

```
sudo bettercap
```

#### Skeniranje BLE ureÄ‘aja

Da biste skenirali BLE ureÄ‘aje u vaÅ¡em okruÅ¾enju, koristite sledeÄ‡u komandu:

```
ble.recon on
```

Ova komanda Ä‡e omoguÄ‡iti skeniranje BLE ureÄ‘aja u realnom vremenu.

#### Napadi na BLE ureÄ‘aje

Bettercap pruÅ¾a razliÄite napade na BLE ureÄ‘aje, kao Å¡to su:

* **Spoofing ureÄ‘aja**: OmoguÄ‡ava vam da se predstavite kao drugi BLE ureÄ‘aj i komunicirate sa ciljnim ureÄ‘ajem.
* **Deautentifikacija**: OmoguÄ‡ava vam da deautentifikujete ciljni BLE ureÄ‘aj i preuzmete kontrolu nad njim.
* **Sniffing prometa**: OmoguÄ‡ava vam da presretnete i analizirate promet izmeÄ‘u BLE ureÄ‘aja.
* **Injekcija paketa**: OmoguÄ‡ava vam da ubacite laÅ¾ne pakete u promet izmeÄ‘u BLE ureÄ‘aja.

#### Analiza sigurnosti BLE mreÅ¾e

Bettercap takoÄ‘e pruÅ¾a moguÄ‡nost analize sigurnosti BLE mreÅ¾e. MoÅ¾ete izvrÅ¡iti sledeÄ‡e zadatke:

* **Snimanje prometa**: OmoguÄ‡ava vam da snimite promet izmeÄ‘u BLE ureÄ‘aja i analizirate ga kasnije.
* **Analiza ranjivosti**: OmoguÄ‡ava vam da identifikujete ranjivosti u BLE ureÄ‘ajima i mreÅ¾i.
* **Testiranje autentifikacije**: OmoguÄ‡ava vam da testirate autentifikaciju BLE ureÄ‘aja i identifikujete slabosti.

Bettercap je moÄ‡an alat koji vam omoguÄ‡ava da izvrÅ¡ite razliÄite napade na BLE ureÄ‘aje i analizirate njihovu sigurnost.

```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
