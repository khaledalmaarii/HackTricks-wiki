# Pentesting BLE - Bluetooth Low Energy

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Introduction

Bluetooth 4.0ä»•æ§˜ä»¥é™ã€BLEã¯40ã®ãƒãƒ£ãƒãƒ«ã®ã¿ã‚’ä½¿ç”¨ã—ã€2400ã‹ã‚‰2483.5 MHzã®ç¯„å›²ã‚’ã‚«ãƒãƒ¼ã—ã¦ã„ã¾ã™ã€‚ãã‚Œã«å¯¾ã—ã¦ã€å¾“æ¥ã®Bluetoothã¯åŒã˜ç¯„å›²ã§79ã®ãƒãƒ£ãƒãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

BLEãƒ‡ãƒã‚¤ã‚¹ã¯ã€**åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆ**ï¼ˆ**ãƒ“ãƒ¼ã‚³ãƒ³ã‚º**ï¼‰ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§é€šä¿¡ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ã‚±ãƒƒãƒˆã¯ã€BLEãƒ‡ãƒã‚¤ã‚¹ã®å­˜åœ¨ã‚’ä»–ã®è¿‘ãã®ãƒ‡ãƒã‚¤ã‚¹ã«ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ“ãƒ¼ã‚³ãƒ³ã‚ºã¯ã€æ™‚ã«ã¯**ãƒ‡ãƒ¼ã‚¿**ã‚‚**é€ä¿¡**ã—ã¾ã™ã€‚

ãƒªã‚¹ãƒ‹ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ã€ã¤ã¾ã‚Šä¸­å¤®ãƒ‡ãƒã‚¤ã‚¹ã¯ã€åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã«å¯¾ã—ã¦**SCANãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§å¿œç­”ã§ãã¾ã™ã€‚ã“ã®ã‚¹ã‚­ãƒ£ãƒ³ã¸ã®**å¿œç­”**ã¯ã€åˆæœŸã®åºƒå‘Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã«åã¾ã‚‰ãªã‹ã£ãŸè¿½åŠ æƒ…å ±ï¼ˆãƒ‡ãƒã‚¤ã‚¹ã®å®Œå…¨ãªåå‰ãªã©ï¼‰ã‚’å«ã‚€ã€**åºƒå‘Š**ãƒ‘ã‚±ãƒƒãƒˆã¨åŒã˜æ§‹é€ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

![](<../../.gitbook/assets/image (152).png>)

ãƒ—ãƒ¬ã‚¢ãƒ³ãƒ–ãƒ«ãƒã‚¤ãƒˆã¯å‘¨æ³¢æ•°ã‚’åŒæœŸã•ã›ã€4ãƒã‚¤ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯**æ¥ç¶šè­˜åˆ¥å­**ã§ã‚ã‚Šã€è¤‡æ•°ã®ãƒ‡ãƒã‚¤ã‚¹ãŒåŒã˜ãƒãƒ£ãƒãƒ«ã§æ¥ç¶šã‚’ç¢ºç«‹ã—ã‚ˆã†ã¨ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã§ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚æ¬¡ã«ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ¦ãƒ‹ãƒƒãƒˆï¼ˆ**PDU**ï¼‰ã«ã¯**åºƒå‘Šãƒ‡ãƒ¼ã‚¿**ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚PDUã«ã¯ã„ãã¤ã‹ã®ã‚¿ã‚¤ãƒ—ãŒã‚ã‚Šã€æœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹ã®ã¯ADV\_NONCONN\_INDã¨ADV\_INDã§ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯**æ¥ç¶šã‚’å—ã‘ä»˜ã‘ãªã„**å ´åˆã€**ADV\_NONCONN\_IND** PDUã‚¿ã‚¤ãƒ—ã‚’ä½¿ç”¨ã—ã€åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆå†…ã§ã®ã¿ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯**æ¥ç¶šã‚’è¨±å¯ã™ã‚‹**å ´åˆã€**ADV\_IND**ã‚’ä½¿ç”¨ã—ã€**æ¥ç¶š**ãŒ**ç¢ºç«‹**ã•ã‚Œã‚‹ã¨åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã®é€ä¿¡ã‚’åœæ­¢ã—ã¾ã™ã€‚

### GATT

**æ±ç”¨å±æ€§ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«**ï¼ˆGATTï¼‰ã¯ã€**ãƒ‡ãƒã‚¤ã‚¹ãŒãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—è»¢é€ã™ã‚‹æ–¹æ³•**ã‚’å®šç¾©ã—ã¾ã™ã€‚BLEãƒ‡ãƒã‚¤ã‚¹ã®æ”»æ’ƒé¢ã‚’åˆ†æã™ã‚‹éš›ã€GATTï¼ˆã¾ãŸã¯GATTsï¼‰ã«æ³¨æ„ã‚’é›†ä¸­ã•ã›ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ã“ã‚ŒãŒ**ãƒ‡ãƒã‚¤ã‚¹æ©Ÿèƒ½ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹æ–¹æ³•**ã§ã‚ã‚Šã€ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã€ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€å¤‰æ›´ã•ã‚Œã‚‹æ–¹æ³•ã ã‹ã‚‰ã§ã™ã€‚GATTã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®ç‰¹æ€§ã€è¨˜è¿°å­ã€ãŠã‚ˆã³ã‚µãƒ¼ãƒ“ã‚¹ã‚’16ãƒ“ãƒƒãƒˆã¾ãŸã¯32ãƒ“ãƒƒãƒˆã®å€¤ã¨ã—ã¦è¡¨å½¢å¼ã§ãƒªã‚¹ãƒˆã—ã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ä¸­å¤®ãƒ‡ãƒã‚¤ã‚¹ã¨å‘¨è¾ºãƒ‡ãƒã‚¤ã‚¹ã®é–“ã§**é€ä¿¡ã•ã‚Œã‚‹**ãƒ‡ãƒ¼ã‚¿å€¤ã§ã™ã€‚ã“ã‚Œã‚‰ã®ç‰¹æ€§ã«ã¯ã€**è¿½åŠ æƒ…å ±ã‚’æä¾›ã™ã‚‹**è¨˜è¿°å­ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã«é–¢é€£ã—ã¦ã„ã‚‹å ´åˆã€**ã‚µãƒ¼ãƒ“ã‚¹**ã«**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–**ã•ã‚Œã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

## Enumeration
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
### GATTool

**GATTool** ã¯ã€åˆ¥ã®ãƒ‡ãƒã‚¤ã‚¹ã¨ã® **æ¥ç¶š** ã‚’ **ç¢ºç«‹** ã—ã€ãã®ãƒ‡ãƒã‚¤ã‚¹ã® **ç‰¹æ€§** ã‚’ãƒªã‚¹ãƒˆã—ã€å±æ€§ã‚’èª­ã¿æ›¸ãã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚\
GATTTool ã¯ `-I` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚·ã‚§ãƒ«ã‚’èµ·å‹•ã§ãã¾ã™ï¼š
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
### ãƒ™ã‚¿ãƒ¼ã‚­ãƒ£ãƒƒãƒ—
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
