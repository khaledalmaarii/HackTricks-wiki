# Pentesting BLE - Bluetooth Low Energy

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Introduction

Bluetooth 4.0 рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдмрд╛рдж рд╕реЗ рдЙрдкрд▓рдмреНрдз, BLE рдХреЗрд╡рд▓ 40 рдЪреИрдирд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ 2400 рд╕реЗ 2483.5 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдХреА рд╕реАрдорд╛ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдкрд╛рд░рдВрдкрд░рд┐рдХ Bluetooth рдЙрд╕реА рд╕реАрдорд╛ рдореЗрдВ 79 рдЪреИрдирд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

BLE рдЙрдкрдХрд░рдг **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ** (**beacons**) рднреЗрдЬрдХрд░ рд╕рдВрд╡рд╛рдж рдХрд░рддреЗ рд╣реИрдВ, рдпреЗ рдкреИрдХреЗрдЯ BLE рдЙрдкрдХрд░рдг рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдЕрдиреНрдп рдирд┐рдХрдЯрд╡рд░реНрддреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпреЗ beacons рдХрднреА-рдХрднреА **рдбреЗрдЯрд╛** рднреА **рднреЗрдЬрддреЗ** рд╣реИрдВред

рд╕реБрдирдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдХрд░рдг, рдЬрд┐рд╕реЗ рдХреЗрдВрджреНрд░реАрдп рдЙрдкрдХрд░рдг рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдХрд╛ рдЙрддреНрддрд░ **SCAN рдЕрдиреБрд░реЛрдз** рдХреЗ рд╕рд╛рде рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЙрдкрдХрд░рдг рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрд╕ рд╕реНрдХреИрди рдХрд╛ **рдЙрддреНрддрд░** рдЙрд╕реА рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ **рд╡рд┐рдЬреНрдЮрд╛рдкрди** рдкреИрдХреЗрдЯ, рдЬрд┐рд╕рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдЬреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз рдореЗрдВ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реЛ рд╕рдХреА, рдЬреИрд╕реЗ рдкреВрд░реНрдг рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдоред

![](<../../.gitbook/assets/image (152).png>)

рдкреНрд░реАрдПрдореНрдмрд▓ рдмрд╛рдЗрдЯ рдЖрд╡реГрддреНрддрд┐ рдХреЛ рд╕рдордиреНрд╡рдпрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЪрд╛рд░-рдмрд╛рдЗрдЯ рдПрдХреНрд╕реЗрд╕ рдкрддрд╛ рдПрдХ **рдХрдиреЗрдХреНрд╢рди рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛** рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдХрдИ рдЙрдкрдХрд░рдг рдПрдХ рд╣реА рдЪреИрдирд▓реЛрдВ рдкрд░ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЕрдЧрд▓рд╛, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдбреЗрдЯрд╛ рдпреВрдирд┐рдЯ (**PDU**) **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдбреЗрдЯрд╛** рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред PDU рдХреЗ рдХрдИ рдкреНрд░рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ; рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ ADV\_NONCONN\_IND рдФрд░ ADV\_IND рд╣реИрдВред рдпрджрд┐ рдЙрдкрдХрд░рдг **рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддреЗ**, рддреЛ рд╡реЗ **ADV\_NONCONN\_IND** PDU рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдХреЗрд╡рд▓ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдЙрдкрдХрд░рдг **рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ** рдФрд░ рдПрдХ рдмрд╛рд░ **рдХрдиреЗрдХреНрд╢рди** рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж **рд╡рд┐рдЬреНрдЮрд╛рдкрди** рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **ADV\_IND** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

### GATT

**Generic Attribute Profile** (GATT) рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдЙрдкрдХрд░рдг рдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╕реЗ рдкреНрд░рд╛рд░реВрдкрд┐рдд рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред рдЬрдм рдЖрдк рдПрдХ BLE рдЙрдкрдХрд░рдг рдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЕрдХреНрд╕рд░ GATT (рдпрд╛ GATTs) рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рдЙрдкрдХрд░рдг рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ** рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд, рд╕рдореВрд╣рд┐рдд рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИред GATT рдПрдХ рдЙрдкрдХрд░рдг рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ, рд╡рд░реНрдгрдирдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ 16- рдпрд╛ 32-рдмрд┐рдЯ рдорд╛рдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИред рдПрдХ **рд╡рд┐рд╢реЗрд╖рддрд╛** рдПрдХ **рдбреЗрдЯрд╛** рдорд╛рди рд╣реИ рдЬреЛ рдХреЗрдВрджреНрд░реАрдп рдЙрдкрдХрд░рдг рдФрд░ рдкрд░рд┐рдзреАрдп рдХреЗ рдмреАрдЪ **рднреЗрдЬрд╛** рдЬрд╛рддрд╛ рд╣реИред рдЗрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ **рд╡рд░реНрдгрдирдХрд░реНрддрд╛** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ**ред **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ** рдЕрдХреНрд╕рд░ **рд╕реЗрд╡рд╛рдУрдВ** рдореЗрдВ **рд╕рдореВрд╣рд┐рдд** рд╣реЛрддреА рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд░рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИрдВред

## Enumeration
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
### GATTool

**GATTool** рдХрд┐рд╕реА рдЕрдиреНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде **рд╕рдВрдпреЛрдЧ** рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ, рдЙрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдХреА **рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ** рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ, рдФрд░ рдЗрд╕рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
GATTTool `-I` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ рд▓реЙрдиреНрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
### Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
