# Pentesting BLE - Bluetooth Low Energy

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## ä»‹ç»

è‡ªBluetooth 4.0è§„èŒƒä»¥æ¥ï¼ŒBLEä»…ä½¿ç”¨40ä¸ªé¢‘é“ï¼Œè¦†ç›–2400åˆ°2483.5 MHzçš„èŒƒå›´ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿè“ç‰™åœ¨åŒä¸€èŒƒå›´å†…ä½¿ç”¨79ä¸ªé¢‘é“ã€‚

BLEè®¾å¤‡é€šè¿‡å‘é€**å¹¿å‘Šæ•°æ®åŒ…**ï¼ˆ**ä¿¡æ ‡**ï¼‰è¿›è¡Œé€šä¿¡ï¼Œè¿™äº›æ•°æ®åŒ…å‘å…¶ä»–é™„è¿‘è®¾å¤‡å¹¿æ’­BLEè®¾å¤‡çš„å­˜åœ¨ã€‚è¿™äº›ä¿¡æ ‡æœ‰æ—¶ä¹Ÿä¼š**å‘é€æ•°æ®**ã€‚

ç›‘å¬è®¾å¤‡ï¼Œä¹Ÿç§°ä¸ºä¸­å¤®è®¾å¤‡ï¼Œå¯ä»¥é€šè¿‡å‘å¹¿å‘Šè®¾å¤‡å‘é€ç‰¹å®šçš„**æ‰«æè¯·æ±‚**æ¥å“åº”å¹¿å‘Šæ•°æ®åŒ…ã€‚è¯¥æ‰«æçš„**å“åº”**ä½¿ç”¨ä¸**å¹¿å‘Š**æ•°æ®åŒ…ç›¸åŒçš„ç»“æ„ï¼Œå¹¶åŒ…å«æ— æ³•åœ¨åˆå§‹å¹¿å‘Šè¯·æ±‚ä¸­å®¹çº³çš„é™„åŠ ä¿¡æ¯ï¼Œä¾‹å¦‚å®Œæ•´çš„è®¾å¤‡åç§°ã€‚

![](<../../.gitbook/assets/image (152).png>)

å‰å¯¼å­—èŠ‚ç”¨äºåŒæ­¥é¢‘ç‡ï¼Œè€Œå››å­—èŠ‚è®¿é—®åœ°å€æ˜¯**è¿æ¥æ ‡è¯†ç¬¦**ï¼Œåœ¨å¤šä¸ªè®¾å¤‡å°è¯•åœ¨åŒä¸€é¢‘é“ä¸Šå»ºç«‹è¿æ¥çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œåè®®æ•°æ®å•å…ƒï¼ˆ**PDU**ï¼‰åŒ…å«**å¹¿å‘Šæ•°æ®**ã€‚PDUæœ‰å‡ ç§ç±»å‹ï¼›æœ€å¸¸ç”¨çš„æ˜¯ADV\_NONCONN\_INDå’ŒADV\_INDã€‚å¦‚æœè®¾å¤‡**ä¸æ¥å—è¿æ¥**ï¼Œåˆ™ä½¿ç”¨**ADV\_NONCONN\_IND** PDUç±»å‹ï¼Œä»…åœ¨å¹¿å‘Šæ•°æ®åŒ…ä¸­ä¼ è¾“æ•°æ®ã€‚å¦‚æœè®¾å¤‡**å…è®¸è¿æ¥**ï¼Œå¹¶ä¸”åœ¨**å»ºç«‹è¿æ¥**å**åœæ­¢å‘é€å¹¿å‘Š**æ•°æ®åŒ…ï¼Œåˆ™ä½¿ç”¨**ADV\_IND**ã€‚

### GATT

**é€šç”¨å±æ€§é…ç½®æ–‡ä»¶**ï¼ˆGATTï¼‰å®šä¹‰äº†**è®¾å¤‡åº”å¦‚ä½•æ ¼å¼åŒ–å’Œä¼ è¾“æ•°æ®**ã€‚å½“æ‚¨åˆ†æBLEè®¾å¤‡çš„æ”»å‡»é¢æ—¶ï¼Œæ‚¨é€šå¸¸ä¼šå°†æ³¨æ„åŠ›é›†ä¸­åœ¨GATTï¼ˆæˆ–GATTsï¼‰ä¸Šï¼Œå› ä¸ºè¿™æ˜¯**è®¾å¤‡åŠŸèƒ½è¢«è§¦å‘**ä»¥åŠæ•°æ®è¢«å­˜å‚¨ã€åˆ†ç»„å’Œä¿®æ”¹çš„æ–¹å¼ã€‚GATTä»¥è¡¨æ ¼å½¢å¼åˆ—å‡ºè®¾å¤‡çš„ç‰¹æ€§ã€æè¿°ç¬¦å’ŒæœåŠ¡ï¼Œå€¼ä¸º16ä½æˆ–32ä½ã€‚**ç‰¹æ€§**æ˜¯**åœ¨ä¸­å¤®è®¾å¤‡å’Œå¤–è®¾ä¹‹é—´å‘é€çš„**æ•°æ®å€¼ã€‚è¿™äº›ç‰¹æ€§å¯ä»¥å…·æœ‰**æè¿°ç¬¦**ï¼Œä»¥**æä¾›æœ‰å…³å®ƒä»¬çš„é™„åŠ ä¿¡æ¯**ã€‚å¦‚æœç‰¹æ€§ä¸æ‰§è¡Œç‰¹å®šæ“ä½œç›¸å…³ï¼Œåˆ™**ç‰¹æ€§**é€šå¸¸ä¼šåœ¨**æœåŠ¡**ä¸­**åˆ†ç»„**ã€‚

## æšä¸¾
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
### GATTool

**GATTool** å…è®¸ä¸å¦ä¸€ä¸ªè®¾å¤‡ **å»ºç«‹** **è¿æ¥**ï¼Œåˆ—å‡ºè¯¥è®¾å¤‡çš„ **ç‰¹å¾**ï¼Œå¹¶è¯»å–å’Œå†™å…¥å…¶å±æ€§ã€‚\
GATTTool å¯ä»¥ä½¿ç”¨ `-I` é€‰é¡¹å¯åŠ¨äº¤äº’å¼ shellï¼š
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
### Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
