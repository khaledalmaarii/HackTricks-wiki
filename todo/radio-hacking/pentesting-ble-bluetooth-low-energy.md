# Pentesting BLE - Bluetooth Low Energy

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## GiriÅŸ

Bluetooth 4.0 spesifikasyonundan bu yana mevcut olan BLE, 2400 ila 2483.5 MHz aralÄ±ÄŸÄ±nÄ± kapsayan yalnÄ±zca 40 kanal kullanÄ±rken, geleneksel Bluetooth aynÄ± aralÄ±kta 79 kanal kullanÄ±r.

BLE cihazlarÄ±, BLE cihazÄ±nÄ±n varlÄ±ÄŸÄ±nÄ± diÄŸer yakÄ±ndaki cihazlara duyuran **reklam paketleri** (**beacon'lar**) gÃ¶ndererek iletiÅŸim kurar. Bu beacon'lar bazen **veri gÃ¶nderir**.

Dinleyici cihaz, aynÄ± yapÄ±da olan **SCAN isteÄŸi** ile reklamcÄ±lÄ±k cihazÄ±na Ã¶zel olarak gÃ¶nderilen bir reklam paketine yanÄ±t verebilir. Bu taramaya verilen yanÄ±t, baÅŸlangÄ±Ã§ta reklam isteÄŸine sÄ±ÄŸmayan tam cihaz adÄ± gibi ek bilgilerle birlikte reklam paketiyle aynÄ± yapÄ±yÄ± kullanÄ±r.

![](<../../.gitbook/assets/image (201) (2) (1) (1).png>)

Ã–nambul baytÄ± frekansÄ± senkronize ederken, dÃ¶rt baytlÄ±k eriÅŸim adresi, aynÄ± kanallarda baÄŸlantÄ± kurmaya Ã§alÄ±ÅŸan birden fazla cihazÄ±n bulunduÄŸu senaryolarda kullanÄ±lan bir **baÄŸlantÄ± tanÄ±mlayÄ±cÄ±sÄ±dÄ±r**. Sonraki adÄ±mda, Protokol Veri Birimi (**PDU**), **reklam verilerini** iÃ§erir. BirkaÃ§ tÃ¼r PDU vardÄ±r; en yaygÄ±n olarak kullanÄ±lanlar ADV\_NONCONN\_IND ve ADV\_IND'dir. Cihazlar, yalnÄ±zca reklam paketinde veri iletimi yaparak baÄŸlantÄ± kabul etmiyorsa **ADV\_NONCONN\_IND** PDU tÃ¼rÃ¼nÃ¼ kullanÄ±r. Cihazlar, baÄŸlantÄ±ya izin veriyorsa ve bir baÄŸlantÄ± kurulduktan sonra reklam paketi gÃ¶ndermeyi durdurursa **ADV\_IND**'yi kullanÄ±r.

### GATT

**Generic Attribute Profile** (GATT), cihazÄ±n verileri nasÄ±l biÃ§imlendireceÄŸini ve aktaracaÄŸÄ±nÄ± tanÄ±mlar. BLE cihazÄ±nÄ±n saldÄ±rÄ± yÃ¼zeyini analiz ederken, genellikle dikkatinizi GATT (veya GATT'lar) Ã¼zerinde yoÄŸunlaÅŸtÄ±rÄ±rsÄ±nÄ±z, Ã§Ã¼nkÃ¼ bu, **cihaz iÅŸlevselliÄŸinin tetiklendiÄŸi** ve verilerin nasÄ±l depolandÄ±ÄŸÄ±, gruplandÄ±ÄŸÄ± ve deÄŸiÅŸtirildiÄŸi ÅŸeklidir. GATT, cihazÄ±n Ã¶zelliklerini, aÃ§Ä±klamalarÄ±nÄ± ve hizmetlerini 16 veya 32 bitlik deÄŸerler olarak bir tabloda listeler. Bir **Ã¶zellik**, merkezi cihaz ve perifer arasÄ±nda **gÃ¶nderilen** bir **veri** deÄŸeridir. Bu Ã¶zelliklerin **aÃ§Ä±klamalarÄ±** olabilir ve bunlar hakkÄ±nda **ek bilgi saÄŸlar**. **Ã–zellikler**, genellikle belirli bir eylemi gerÃ§ekleÅŸtirmekle ilgiliyse **hizmetlerde** **gruplandÄ±rÄ±lÄ±r**.

## NumaralandÄ±rma

```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```

### GATTool

**GATTool**, baÅŸka bir cihazla **baÄŸlantÄ± kurmayÄ±**, o cihazÄ±n **Ã¶zelliklerini** listelemeyi ve Ã¶zniteliklerini okuyup yazmayÄ± saÄŸlar.\
GATTTool, `-I` seÃ§eneÄŸiyle etkileÅŸimli bir kabuk baÅŸlatabilir:

```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```

### Bettercap

Bettercap, bir aÄŸ saldÄ±rÄ± aracÄ±dÄ±r ve BLE (Bluetooth Low Energy) cihazlarÄ±nÄ± hedef almak iÃ§in kullanÄ±labilir. Bu araÃ§, BLE protokolÃ¼nÃ¼ kullanarak aÄŸ trafiÄŸini izlemek, saldÄ±rÄ±lar gerÃ§ekleÅŸtirmek ve gÃ¼venlik aÃ§Ä±klarÄ±nÄ± keÅŸfetmek iÃ§in kullanÄ±labilir.

Bettercap, BLE cihazlarÄ±na yÃ¶nelik Ã§eÅŸitli saldÄ±rÄ± tekniklerini destekler. Ã–rneÄŸin, BLE cihazlarÄ±nÄ± taklit ederek kimlik avÄ± saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirebilir veya BLE cihazlarÄ±na saldÄ±rarak veri sÄ±zÄ±ntÄ±sÄ± yapabilirsiniz. AyrÄ±ca, BLE cihazlarÄ±nÄ±n gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek iÃ§in aktif tarama yapabilir ve bu cihazlara karÅŸÄ± saldÄ±rÄ±lar gerÃ§ekleÅŸtirebilirsiniz.

Bettercap, kullanÄ±cÄ± dostu bir arayÃ¼ze sahiptir ve komut satÄ±rÄ± aracÄ±lÄ±ÄŸÄ±yla da kullanÄ±labilir. Bu araÃ§, BLE cihazlarÄ±nÄ± hedef almak iÃ§in Ã§eÅŸitli modÃ¼ller ve komutlar sunar. Bu modÃ¼ller ve komutlar, BLE cihazlarÄ±nÄ± keÅŸfetmek, aÄŸ trafiÄŸini izlemek, saldÄ±rÄ±lar gerÃ§ekleÅŸtirmek ve gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit etmek iÃ§in kullanÄ±labilir.

Bettercap, BLE cihazlarÄ±nÄ± hedef almak iÃ§in etkili bir araÃ§tÄ±r ve birÃ§ok farklÄ± senaryoda kullanÄ±labilir. Ancak, bu aracÄ± kullanÄ±rken yasal ve etik sÄ±nÄ±rlar iÃ§inde kalmanÄ±z Ã¶nemlidir. AyrÄ±ca, hedeflediÄŸiniz BLE cihazlarÄ±nÄ±n sahiplerinin izni olmadan saldÄ±rÄ± gerÃ§ekleÅŸtirmemeniz gerektiÄŸini unutmayÄ±n.

```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```

<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'Ä± takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
