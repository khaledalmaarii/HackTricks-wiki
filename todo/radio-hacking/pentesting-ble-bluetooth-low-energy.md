# BLE - Bluetooth Low Energy Pentesting

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahramana Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## GiriÅŸ

Bluetooth 4.0 spesifikasyonundan bu yana mevcut olan BLE, yalnÄ±zca 40 kanal kullanÄ±r ve 2400 ila 2483.5 MHz aralÄ±ÄŸÄ±nÄ± kapsar. Buna karÅŸÄ±lÄ±k, geleneksel Bluetooth aynÄ± aralÄ±kta 79 kanal kullanÄ±r.

BLE cihazlarÄ±, varlÄ±klarÄ±nÄ± diÄŸer yakÄ±ndaki cihazlara duyuran **reklam paketleri** (**beaconlar**) gÃ¶ndererek iletiÅŸim kurar. Bu beaconlar bazen **veri gÃ¶nderir**.

Dinleyici cihaz, aynÄ± zamanda merkezi cihaz olarak da adlandÄ±rÄ±lÄ±r, bir reklam paketine **SCAN isteÄŸi** gÃ¶ndererek Ã¶zel olarak reklam yapan cihaza yanÄ±t verebilir. Bu taramanÄ±n **yanÄ±tÄ±**, baÅŸlangÄ±Ã§taki reklam isteÄŸine sÄ±ÄŸmayan ek bilgileri iÃ§eren aynÄ± yapÄ±yÄ± kullanÄ±r, Ã¶rneÄŸin tam cihaz adÄ± gibi.

![](<../../.gitbook/assets/image (149).png>)

Preamble byte frekansÄ± senkronize ederken, dÃ¶rt baytlÄ±k eriÅŸim adresi, aynÄ± kanallarda baÄŸlantÄ± kurmaya Ã§alÄ±ÅŸan birden fazla cihaz senaryolarÄ±nda kullanÄ±lan bir **baÄŸlantÄ± kimliÄŸidir**. Sonraki, Protokol Veri Birimi (**PDU**) **reklam verilerÄ±nÄ±** iÃ§erir. BirkaÃ§ tÃ¼r PDU vardÄ±r; en yaygÄ±n olarak kullanÄ±lanlar ADV\_NONCONN\_IND ve ADV\_IND'dir. Cihazlar, sadece reklam paketinde veri ileten cihazlar **baÄŸlantÄ± kabul etmiyorsa** ADV\_NONCONN\_IND PDU tÃ¼rÃ¼nÃ¼ kullanÄ±r. Cihazlar, **baÄŸlantÄ±yÄ± kabul ederse** ve **baÄŸlantÄ± kurulduktan sonra** reklam paketlerini **duraklatÄ±rlarsa** ADV\_IND'yi kullanÄ±r.

### GATT

**Generic Attribute Profile** (GATT), cihazÄ±n verileri nasÄ±l biÃ§imlendireceÄŸini ve aktaracaÄŸÄ±nÄ± tanÄ±mlar. Bir BLE cihazÄ±nÄ±n saldÄ±rÄ± yÃ¼zeyini analiz ederken genellikle dikkatinizi GATT (veya GATT'ler) Ã¼zerinde yoÄŸunlaÅŸtÄ±rÄ±rsÄ±nÄ±z, Ã§Ã¼nkÃ¼ bu, **cihaz iÅŸlevselliÄŸinin tetiklendiÄŸi** ve verilerin nasÄ±l depolandÄ±ÄŸÄ±, gruplandÄ±ÄŸÄ± ve deÄŸiÅŸtirildiÄŸi yoldur. GATT, cihazÄ±n Ã¶zelliklerini, aÃ§Ä±klamalarÄ±nÄ± ve hizmetlerini 16 veya 32 bitlik deÄŸerler olarak bir tabloda listeler. Bir **Ã¶zellik**, merkezi cihaz ve perifer arasÄ±nda **gÃ¶nderilen bir veri** deÄŸeridir. Bu Ã¶zelliklerin **hakkÄ±nda ek bilgi saÄŸlayan aÃ§Ä±klamalarÄ±** olan **aÃ§Ä±klamalarÄ±** olabilir. **Ã–zellikler**, genellikle belirli bir eylemi gerÃ§ekleÅŸtirmekle ilgiliyse **hizmetlerde gruplandÄ±rÄ±lÄ±r**. 

## NumaralandÄ±rma
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
### GATTool

**GATTool**, baÅŸka bir cihazla baÄŸlantÄ± kurmayÄ±, cihazÄ±n Ã¶zelliklerini listelemeyi ve Ã¶zelliklerini okuyup yazmayÄ± saÄŸlar.\
GATTTool, etkileÅŸimli bir kabuk baÅŸlatabilir `-I` seÃ§eneÄŸi ile:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
### Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmaya kadar AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
