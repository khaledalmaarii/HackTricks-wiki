# Pentesting RFID

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Introduction

**Radio Frequency Identification (RFID)** je najpopularnije reÅ¡enje za kratke radio udaljenosti. ObiÄno se koristi za skladiÅ¡tenje i prenos informacija koje identifikuju entitet.

RFID oznaka moÅ¾e se oslanjati na **svoj izvor napajanja (aktivna)**, kao Å¡to je ugraÄ‘ena baterija, ili primati napajanje od antene za Äitanje koristeÄ‡i trenutnu **indukovanu iz primljenih radio talasa** (**pasivna**).

### Classes

EPCglobal deli RFID oznake u Å¡est kategorija. Oznaka u svakoj kategoriji ima sve moguÄ‡nosti navedene u prethodnoj kategoriji, ÄineÄ‡i je unazad kompatibilnom.

* **Klasa 0** oznake su **pasivne** oznake koje rade u **UHF** opsegu. DobavljaÄ ih **preprogramira** u fabrici. Kao rezultat, **ne moÅ¾ete promeniti** informacije pohranjene u njihovoj memoriji.
* **Klasa 1** oznake takoÄ‘e mogu raditi u **HF** opsegu. Pored toga, mogu se **pisati samo jednom** nakon proizvodnje. Mnoge Klasa 1 oznake takoÄ‘e mogu obraditi **cikliÄne redundancije** (CRC) komandi koje primaju. CRC su nekoliko dodatnih bajtova na kraju komandi za otkrivanje greÅ¡aka.
* **Klasa 2** oznake mogu se **pisati viÅ¡e puta**.
* **Klasa 3** oznake mogu sadrÅ¾ati **ugraÄ‘ene senzore** koji mogu snimati parametre okruÅ¾enja, kao Å¡to su trenutna temperatura ili kretanje oznake. Ove oznake su **polu-pasivne**, jer iako **imaju** ugraÄ‘eni izvor napajanja, kao Å¡to je integrisana **baterija**, **ne mogu inicirati** beÅ¾iÄnu **komunikaciju** sa drugim oznakama ili ÄitaÄima.
* **Klasa 4** oznake mogu inicirati komunikaciju sa drugim oznakama iste klase, ÄineÄ‡i ih **aktivnim oznakama**.
* **Klasa 5** oznake mogu pruÅ¾iti **napajanje drugim oznakama i komunicirati sa svim prethodnim klasama oznaka**. Klasa 5 oznake mogu delovati kao **RFID ÄitaÄi**.

### Information Stored in RFID Tags

Memorija RFID oznake obiÄno skladiÅ¡ti Äetiri vrste podataka: **identifikacione podatke**, koji **identifikuju** **entitet** na koji je oznaka priÄvrÅ¡Ä‡ena (ovi podaci ukljuÄuju korisniÄki definisane oblasti, kao Å¡to su bankovni raÄuni); **dodatne podatke**, koji pruÅ¾aju **dodatne** **detalje** o entitetu; **kontrolne podatke**, koriÅ¡Ä‡ene za internu **konfiguraciju** oznake; i **proizvoÄ‘aÄke podatke** oznake, koji sadrÅ¾e jedinstveni identifikator oznake (**UID**) i detalje o **proizvodnji**, **vrsti** i **dobavljaÄu** oznake. Prve dve vrste podataka Ä‡ete pronaÄ‡i u svim komercijalnim oznakama; poslednje dve mogu se razlikovati u zavisnosti od dobavljaÄa oznake.

ISO standard definiÅ¡e vrednost Identifikatora aplikacione porodice (**AFI**), kod koji oznaÄava **vrstu objekta** kojem oznaka pripada. JoÅ¡ jedan vaÅ¾an registar, takoÄ‘e definisan od strane ISO, je Identifikator formata skladiÅ¡tenja podataka (**DSFID**), koji definiÅ¡e **logiÄku organizaciju korisniÄkih podataka**.

VeÄ‡ina **bezbednosnih kontrola** RFID-a ima mehanizme koji **ograniÄavaju** **Äitanje** ili **pisanje** operacija na svakoj korisniÄkoj memorijskoj jedinici i na posebnim registrima koji sadrÅ¾e AFI i DSFID vrednosti. Ovi **mehanizmi zakljuÄavanja** koriste podatke pohranjene u kontrolnoj memoriji i imaju **podrazumevane lozinke** koje je prekonfigurisao dobavljaÄ, ali omoguÄ‡avaju vlasnicima oznaka da **konfiguriÅ¡u prilagoÄ‘ene lozinke**.

### Low & High frequency tags comparison

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Low-Frequency RFID Tags (125kHz)

**Oznake niske frekvencije** se Äesto koriste u sistemima koji **ne zahtevaju visoku bezbednost**: pristup zgradama, interkom kljuÄevi, Älanstva u teretanama, itd. Zbog svog veÄ‡eg dometa, pogodne su za koriÅ¡Ä‡enje za plaÄ‡eno parkiranje: vozaÄ ne mora da dovede karticu blizu ÄitaÄa, jer se aktivira iz daljine. U isto vreme, oznake niske frekvencije su vrlo primitivne, imaju nisku brzinu prenosa podataka. Iz tog razloga, nemoguÄ‡e je implementirati sloÅ¾en dvostrani prenos podataka za stvari kao Å¡to su odrÅ¾avanje stanja i kriptografija. Oznake niske frekvencije samo prenose svoj kratki ID bez ikakvih sredstava za autentifikaciju.

Ovi ureÄ‘aji se oslanjaju na **pasivnu** **RFID** tehnologiju i rade u **opsegu od 30 kHz do 300 kHz**, iako je uobiÄajenije koristiti 125 kHz do 134 kHz:

* **Dugi domet** â€” niÅ¾a frekvencija se prevodi u veÄ‡i domet. Postoje neki EM-Marin i HID ÄitaÄi, koji rade na udaljenosti do jednog metra. Ovi se Äesto koriste u parkiranju automobila.
* **Primitivni protokol** â€” zbog niske brzine prenosa podataka, ove oznake mogu samo prenositi svoj kratki ID. U veÄ‡ini sluÄajeva, podaci nisu autentifikovani i nisu zaÅ¡tiÄ‡eni na bilo koji naÄin. ÄŒim je kartica u dometu ÄitaÄa, jednostavno poÄinje da prenosi svoj ID.
* **Niska bezbednost** â€” Ove kartice se lako mogu kopirati, ili Äak proÄitati iz tuÄ‘eg dÅ¾epa zbog primitivnosti protokola.

**Popularni 125 kHz protokoli:**

* **EM-Marin** â€” EM4100, EM4102. Najpopularniji protokol u CIS-u. MoÅ¾e se Äitati sa udaljenosti od oko jednog metra zbog svoje jednostavnosti i stabilnosti.
* **HID Prox II** â€” niskofrekventni protokol koji je uveo HID Global. Ovaj protokol je popularniji u zapadnim zemljama. SloÅ¾eniji je i kartice i ÄitaÄi za ovaj protokol su relativno skupi.
* **Indala** â€” vrlo stari niskofrekventni protokol koji je uveo Motorola, a kasnije ga je kupio HID. Manje je verovatno da Ä‡ete ga sresti u prirodi u poreÄ‘enju sa prethodna dva jer izlazi iz upotrebe.

U stvarnosti, postoji mnogo viÅ¡e niskofrekventnih protokola. Ali svi koriste istu modulaciju na fiziÄkom sloju i mogu se smatrati, na jedan ili drugi naÄin, varijacijom onih navedenih iznad.

### Attack

You can **attack these Tags with the Flipper Zero**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}

## High-Frequency RFID Tags (13.56 MHz)

**Oznake visoke frekvencije** se koriste za sloÅ¾eniju interakciju izmeÄ‘u ÄitaÄa i oznake kada su potrebni kriptografija, veliki dvostrani prenos podataka, autentifikacija, itd.\
ObiÄno se nalaze u bankovnim karticama, javnom prevozu i drugim sigurnim propusnicama.

**Oznake visoke frekvencije 13.56 MHz su skup standarda i protokola**. ObiÄno se nazivaju [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ali to nije uvek taÄno. Osnovni skup protokola koji se koristi na fiziÄkom i logiÄkom nivou je ISO 14443. Visok nivo protokola, kao i alternativni standardi (kao Å¡to je ISO 19092), zasnivaju se na njemu. Mnogi ljudi ovu tehnologiju nazivaju **Near Field Communication (NFC)**, termin za ureÄ‘aje koji rade na frekvenciji od 13.56 MHz.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

Da pojednostavimo, arhitektura NFC-a funkcioniÅ¡e ovako: protokol prenosa bira kompanija koja pravi kartice i implementira se na osnovu niskonivnog ISO 14443. Na primer, NXP je izmislio svoj vlastiti visokonivni protokol prenosa pod nazivom Mifare. Ali na niÅ¾em nivou, Mifare kartice se zasnivaju na ISO 14443-A standardu.

Flipper moÅ¾e interagovati i sa niskonivnim ISO 14443 protokolom, kao i sa Mifare Ultralight protokolom prenosa podataka i EMV-om koji se koristi u bankovnim karticama. Radimo na dodavanju podrÅ¡ke za Mifare Classic i NFC NDEF. Temeljno razmatranje protokola i standarda koji Äine NFC zasluÅ¾uje poseban Älanak koji planiramo da objavimo kasnije.

Sve visokonivene kartice zasnovane na ISO 14443-A standardu imaju jedinstveni ID Äipa. On deluje kao serijski broj kartice, poput MAC adrese mreÅ¾ne kartice. **ObiÄno, UID je dugaÄak 4 ili 7 bajtova**, ali retko moÅ¾e iÄ‡i **do 10**. UIDs nisu tajna i lako se Äitaju, **ponekad Äak i odÅ¡tampani na samoj kartici**.

Postoji mnogo sistema kontrole pristupa koji se oslanjaju na UID za **autentifikaciju i dodeljivanje pristupa**. Ponekad se to deÅ¡ava **Äak i** kada RFID oznake **podrÅ¾avaju kriptografiju**. Takva **zloupotreba** ih sniÅ¾ava na nivo glupih **125 kHz kartica** u smislu **bezbednosti**. Virtuelne kartice (kao Å¡to je Apple Pay) koriste dinamiÄki UID kako vlasnici telefona ne bi mogli otvarati vrata sa svojom aplikacijom za plaÄ‡anje.

* **Mali domet** â€” visokonivne kartice su posebno dizajnirane tako da moraju biti postavljene blizu ÄitaÄa. To takoÄ‘e pomaÅ¾e u zaÅ¡titi kartice od neovlaÅ¡Ä‡enih interakcija. Maksimalni domet Äitanja koji smo uspeli da postignemo bio je oko 15 cm, a to je bilo sa ÄitaÄima visokog dometa po narudÅ¾bini.
* **Napredni protokoli** â€” brzine prenosa podataka do 424 kbps omoguÄ‡avaju sloÅ¾ene protokole sa punim dvostranim prenosom podataka. Å to zauzvrat **omoguÄ‡ava kriptografiju**, prenos podataka, itd.
* **Visoka bezbednost** â€” visokonivne beskontaktne kartice ni na koji naÄin nisu inferiorne u odnosu na pametne kartice. Postoje kartice koje podrÅ¾avaju kriptografski jake algoritme poput AES i implementiraju asimetriÄnu kriptografiju.

### Attack

You can **attack these Tags with the Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Or using the **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## References

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
