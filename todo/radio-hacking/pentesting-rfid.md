# Pentesting RFID

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## Wprowadzenie

**Radio Frequency Identification (RFID)** to najpopularniejsze rozwiÄ…zanie radiowe o krÃ³tkim zasiÄ™gu. Zwykle jest uÅ¼ywane do przechowywania i przesyÅ‚ania informacji identyfikujÄ…cych podmiot.

Tag RFID moÅ¼e polegaÄ‡ na **wÅ‚asnym ÅºrÃ³dle zasilania (aktywnym)**, takim jak wbudowana bateria, lub otrzymywaÄ‡ zasilanie z anteny odczytujÄ…cej, wykorzystujÄ…c prÄ…d **indukowany z odebranych fal radiowych** (**pasywny**).

### Klasy

EPCglobal dzieli tagi RFID na szeÅ›Ä‡ kategorii. Tag w kaÅ¼dej kategorii ma wszystkie moÅ¼liwoÅ›ci wymienione w poprzedniej kategorii, co czyni go kompatybilnym wstecz.

* Tagi **Klasy 0** to **pasywne** tagi dziaÅ‚ajÄ…ce w pasmach **UHF**. Producent **wstÄ™pnie programuje** je w fabryce. W rezultacie **nie moÅ¼na zmieniÄ‡** informacji przechowywanych w ich pamiÄ™ci.
* Tagi **Klasy 1** mogÄ… rÃ³wnieÅ¼ dziaÅ‚aÄ‡ w pasmach **HF**. Ponadto mogÄ… byÄ‡ **zapisywane tylko raz** po produkcji. Wiele tagÃ³w Klasy 1 moÅ¼e rÃ³wnieÅ¼ przetwarzaÄ‡ **cykliczne sumy kontrolne** (CRC) poleceÅ„, ktÃ³re otrzymujÄ…. CRC to kilka dodatkowych bajtÃ³w na koÅ„cu poleceÅ„ do wykrywania bÅ‚Ä™dÃ³w.
* Tagi **Klasy 2** mogÄ… byÄ‡ **zapisywane wielokrotnie**.
* Tagi **Klasy 3** mogÄ… zawieraÄ‡ **wbudowane czujniki**, ktÃ³re mogÄ… rejestrowaÄ‡ parametry Å›rodowiskowe, takie jak aktualna temperatura lub ruch tagu. Tagi te sÄ… **pÃ³Å‚pasywne**, poniewaÅ¼ chociaÅ¼ **majÄ…** wbudowane ÅºrÃ³dÅ‚o zasilania, takie jak zintegrowana **bateria**, **nie mogÄ… inicjowaÄ‡** bezprzewodowej **komunikacji** z innymi tagami lub czytnikami.
* Tagi **Klasy 4** mogÄ… inicjowaÄ‡ komunikacjÄ™ z innymi tagami tej samej klasy, co czyni je **tagami aktywnymi**.
* Tagi **Klasy 5** mogÄ… dostarczaÄ‡ **zasilanie innym tagom i komunikowaÄ‡ siÄ™ ze wszystkimi poprzednimi klasami tagÃ³w**. Tagi Klasy 5 mogÄ… dziaÅ‚aÄ‡ jako **czytniki RFID**.

### Informacje przechowywane w tagach RFID

PamiÄ™Ä‡ tagu RFID zazwyczaj przechowuje cztery rodzaje danych: **dane identyfikacyjne**, ktÃ³re **identyfikujÄ…** **podmiot**, do ktÃ³rego tag jest przypisany (dane te obejmujÄ… pola zdefiniowane przez uÅ¼ytkownika, takie jak konta bankowe); **dane uzupeÅ‚niajÄ…ce**, ktÃ³re dostarczajÄ… **dalszych** **szczegÃ³Å‚Ã³w** dotyczÄ…cych podmiotu; **dane kontrolne**, uÅ¼ywane do wewnÄ™trznej **konfiguracji** tagu; oraz **dane producenta** tagu, ktÃ³re zawierajÄ… unikalny identyfikator tagu (**UID**) oraz szczegÃ³Å‚y dotyczÄ…ce **produkcji**, **typu** i **producenta** tagu. Pierwsze dwa rodzaje danych znajdziesz we wszystkich komercyjnych tagach; ostatnie dwa mogÄ… siÄ™ rÃ³Å¼niÄ‡ w zaleÅ¼noÅ›ci od producenta tagu.

Standard ISO okreÅ›la wartoÅ›Ä‡ identyfikatora rodziny aplikacji (**AFI**), kod, ktÃ³ry wskazuje **rodzaj obiektu**, do ktÃ³rego tag naleÅ¼y. Innym waÅ¼nym rejestrem, rÃ³wnieÅ¼ okreÅ›lonym przez ISO, jest identyfikator formatu przechowywania danych (**DSFID**), ktÃ³ry definiuje **logiczne zorganizowanie danych uÅ¼ytkownika**.

WiÄ™kszoÅ›Ä‡ **kontroli bezpieczeÅ„stwa RFID** ma mechanizmy, ktÃ³re **ograniczajÄ…** operacje **odczytu** lub **zapisu** na kaÅ¼dym bloku pamiÄ™ci uÅ¼ytkownika oraz na specjalnych rejestrach zawierajÄ…cych wartoÅ›ci AFI i DSFID. Te **mechanizmy blokujÄ…ce** wykorzystujÄ… dane przechowywane w pamiÄ™ci kontrolnej i majÄ… **domyÅ›lne hasÅ‚a** wstÄ™pnie skonfigurowane przez producenta, ale pozwalajÄ… wÅ‚aÅ›cicielom tagÃ³w na **konfigurowanie niestandardowych haseÅ‚**.

### PorÃ³wnanie tagÃ³w niskiej i wysokiej czÄ™stotliwoÅ›ci

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Tagi RFID o niskiej czÄ™stotliwoÅ›ci (125 kHz)

**Tagi niskiej czÄ™stotliwoÅ›ci** sÄ… czÄ™sto uÅ¼ywane w systemach, ktÃ³re **nie wymagajÄ… wysokiego bezpieczeÅ„stwa**: dostÄ™p do budynkÃ³w, klucze do domofonÃ³w, karty czÅ‚onkowskie na siÅ‚owni itp. DziÄ™ki wiÄ™kszemu zasiÄ™gowi sÄ… wygodne w uÅ¼yciu do pÅ‚atnych parkingÃ³w: kierowca nie musi zbliÅ¼aÄ‡ karty do czytnika, poniewaÅ¼ jest aktywowana z wiÄ™kszej odlegÅ‚oÅ›ci. JednoczeÅ›nie tagi niskiej czÄ™stotliwoÅ›ci sÄ… bardzo prymitywne, majÄ… niski wskaÅºnik transferu danych. Z tego powodu niemoÅ¼liwe jest wdroÅ¼enie zÅ‚oÅ¼onego dwukierunkowego transferu danych, na przykÅ‚ad do utrzymywania salda i kryptografii. Tagi niskiej czÄ™stotliwoÅ›ci przesyÅ‚ajÄ… tylko swoje krÃ³tkie ID bez Å¼adnych Å›rodkÃ³w uwierzytelniajÄ…cych.

UrzÄ…dzenia te polegajÄ… na technologii **pasywnego** **RFID** i dziaÅ‚ajÄ… w **zakresie od 30 kHz do 300 kHz**, chociaÅ¼ czÄ™Å›ciej uÅ¼ywa siÄ™ 125 kHz do 134 kHz:

* **DÅ‚ugi zasiÄ™g** â€” niÅ¼sza czÄ™stotliwoÅ›Ä‡ przekÅ‚ada siÄ™ na wiÄ™kszy zasiÄ™g. IstniejÄ… czytniki EM-Marin i HID, ktÃ³re dziaÅ‚ajÄ… z odlegÅ‚oÅ›ci do metra. CzÄ™sto sÄ… uÅ¼ywane na parkingach.
* **Prymitywny protokÃ³Å‚** â€” z powodu niskiego wskaÅºnika transferu danych te tagi mogÄ… przesyÅ‚aÄ‡ tylko swoje krÃ³tkie ID. W wiÄ™kszoÅ›ci przypadkÃ³w dane nie sÄ… uwierzytelniane i nie sÄ… w Å¼aden sposÃ³b chronione. Gdy tylko karta znajdzie siÄ™ w zasiÄ™gu czytnika, zaczyna przesyÅ‚aÄ‡ swoje ID.
* **Niskie bezpieczeÅ„stwo** â€” te karty mogÄ… byÄ‡ Å‚atwo kopiowane, a nawet odczytywane z kieszeni kogoÅ› innego z powodu prymitywnoÅ›ci protokoÅ‚u.

**Popularne protokoÅ‚y 125 kHz:**

* **EM-Marin** â€” EM4100, EM4102. Najpopularniejszy protokÃ³Å‚ w CIS. MoÅ¼e byÄ‡ odczytywany z odlegÅ‚oÅ›ci okoÅ‚o metra z powodu swojej prostoty i stabilnoÅ›ci.
* **HID Prox II** â€” protokÃ³Å‚ niskiej czÄ™stotliwoÅ›ci wprowadzony przez HID Global. ProtokÃ³Å‚ ten jest bardziej popularny w krajach zachodnich. Jest bardziej zÅ‚oÅ¼ony, a karty i czytniki dla tego protokoÅ‚u sÄ… stosunkowo drogie.
* **Indala** â€” bardzo stary protokÃ³Å‚ niskiej czÄ™stotliwoÅ›ci, ktÃ³ry zostaÅ‚ wprowadzony przez MotorolÄ™, a pÃ³Åºniej przejÄ™ty przez HID. Rzadziej moÅ¼na go spotkaÄ‡ w terenie w porÃ³wnaniu do poprzednich dwÃ³ch, poniewaÅ¼ wychodzi z uÅ¼ycia.

W rzeczywistoÅ›ci istnieje znacznie wiÄ™cej protokoÅ‚Ã³w niskiej czÄ™stotliwoÅ›ci. Ale wszystkie one uÅ¼ywajÄ… tej samej modulacji na warstwie fizycznej i mogÄ… byÄ‡ uwaÅ¼ane, w ten czy inny sposÃ³b, za wariacjÄ™ tych wymienionych powyÅ¼ej.

### Atak

MoÅ¼esz **zaatakowaÄ‡ te tagi za pomocÄ… Flipper Zero**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}

## Tagi RFID o wysokiej czÄ™stotliwoÅ›ci (13.56 MHz)

**Tagi wysokiej czÄ™stotliwoÅ›ci** sÄ… uÅ¼ywane do bardziej zÅ‚oÅ¼onej interakcji miÄ™dzy czytnikiem a tagiem, gdy potrzebna jest kryptografia, duÅ¼y dwukierunkowy transfer danych, uwierzytelnianie itp.\
Zwykle wystÄ™pujÄ… w kartach bankowych, transporcie publicznym i innych zabezpieczonych przepustkach.

**Tagi wysokiej czÄ™stotliwoÅ›ci 13.56 MHz to zestaw standardÃ³w i protokoÅ‚Ã³w**. Zwykle okreÅ›la siÄ™ je jako [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ale to nie zawsze jest poprawne. Podstawowy zestaw protokoÅ‚Ã³w uÅ¼ywanych na poziomie fizycznym i logicznym to ISO 14443. ProtokÃ³Å‚y na wyÅ¼szym poziomie, a takÅ¼e alternatywne standardy (takie jak ISO 19092), opierajÄ… siÄ™ na nim. Wiele osÃ³b odnosi siÄ™ do tej technologii jako **Near Field Communication (NFC)**, terminu dla urzÄ…dzeÅ„ dziaÅ‚ajÄ…cych na czÄ™stotliwoÅ›ci 13.56 MHz.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

MÃ³wiÄ…c prosto, architektura NFC dziaÅ‚a w ten sposÃ³b: protokÃ³Å‚ transmisji jest wybierany przez firmÄ™ produkujÄ…cÄ… karty i wdraÅ¼any na podstawie niskopoziomowego ISO 14443. Na przykÅ‚ad, NXP wynalazÅ‚ wÅ‚asny protokÃ³Å‚ transmisji na wyÅ¼szym poziomie o nazwie Mifare. Ale na niÅ¼szym poziomie karty Mifare opierajÄ… siÄ™ na standardzie ISO 14443-A.

Flipper moÅ¼e wspÃ³Å‚dziaÅ‚aÄ‡ zarÃ³wno z niskopoziomowym protokoÅ‚em ISO 14443, jak i protokoÅ‚em transferu danych Mifare Ultralight oraz EMV uÅ¼ywanym w kartach bankowych. Pracujemy nad dodaniem wsparcia dla Mifare Classic i NFC NDEF. DokÅ‚adne spojrzenie na protokoÅ‚y i standardy, ktÃ³re tworzÄ… NFC, zasÅ‚uguje na osobny artykuÅ‚, ktÃ³ry planujemy opublikowaÄ‡ pÃ³Åºniej.

Wszystkie karty wysokiej czÄ™stotliwoÅ›ci oparte na standardzie ISO 14443-A majÄ… unikalny identyfikator chipu. DziaÅ‚a on jako numer seryjny karty, jak adres MAC karty sieciowej. **Zwykle UID ma dÅ‚ugoÅ›Ä‡ 4 lub 7 bajtÃ³w**, ale rzadko moÅ¼e siÄ™gaÄ‡ **do 10**. UID nie jest tajemnicÄ… i jest Å‚atwo odczytywalny, **czasami nawet wydrukowany na samej karcie**.

Istnieje wiele systemÃ³w kontroli dostÄ™pu, ktÃ³re polegajÄ… na UID do **uwierzytelniania i przyznawania dostÄ™pu**. Czasami dzieje siÄ™ to **nawet** wtedy, gdy tagi RFID **obsÅ‚ugujÄ… kryptografiÄ™**. Takie **niewÅ‚aÅ›ciwe uÅ¼ycie** obniÅ¼a je do poziomu gÅ‚upich **kart 125 kHz** pod wzglÄ™dem **bezpieczeÅ„stwa**. Wirtualne karty (takie jak Apple Pay) uÅ¼ywajÄ… dynamicznego UID, aby wÅ‚aÅ›ciciele telefonÃ³w nie mogli otwieraÄ‡ drzwi za pomocÄ… aplikacji pÅ‚atniczej.

* **Niski zasiÄ™g** â€” karty wysokiej czÄ™stotliwoÅ›ci sÄ… specjalnie zaprojektowane tak, aby musiaÅ‚y byÄ‡ umieszczane blisko czytnika. Pomaga to rÃ³wnieÅ¼ chroniÄ‡ kartÄ™ przed nieautoryzowanymi interakcjami. Maksymalny zasiÄ™g odczytu, ktÃ³ry udaÅ‚o nam siÄ™ osiÄ…gnÄ…Ä‡, wynosiÅ‚ okoÅ‚o 15 cm, a to byÅ‚o z niestandardowymi czytnikami o duÅ¼ym zasiÄ™gu.
* **Zaawansowane protokoÅ‚y** â€” prÄ™dkoÅ›ci transferu danych do 424 kbps pozwalajÄ… na zÅ‚oÅ¼one protokoÅ‚y z peÅ‚noprawnym dwukierunkowym transferem danych. Co z kolei **umoÅ¼liwia kryptografiÄ™**, transfer danych itp.
* **Wysokie bezpieczeÅ„stwo** â€” karty bezstykowe o wysokiej czÄ™stotliwoÅ›ci w Å¼aden sposÃ³b nie ustÄ™pujÄ… kartom inteligentnym. IstniejÄ… karty, ktÃ³re obsÅ‚ugujÄ… kryptograficznie silne algorytmy, takie jak AES, i wdraÅ¼ajÄ… kryptografiÄ™ asymetrycznÄ….

### Atak

MoÅ¼esz **zaatakowaÄ‡ te tagi za pomocÄ… Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Lub uÅ¼ywajÄ…c **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Å¹rÃ³dÅ‚a

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
