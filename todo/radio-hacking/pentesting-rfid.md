# Pentesting RFID

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmujÄ…cej siÄ™ cyberbezpieczeÅ„stwem**? Chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks**? A moÅ¼e chcesz mieÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**repozytorium hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**repozytorium hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Wprowadzenie

**Radio Frequency Identification (RFID)** to najpopularniejsze rozwiÄ…zanie radiowe krÃ³tkiego zasiÄ™gu. Zazwyczaj sÅ‚uÅ¼y do przechowywania i przesyÅ‚ania informacji identyfikujÄ…cych jednostkÄ™.

Etykieta RFID moÅ¼e polegaÄ‡ na **wÅ‚asnym ÅºrÃ³dle zasilania (aktywna)**, takim jak wbudowana bateria, lub otrzymywaÄ‡ zasilanie z anteny odczytujÄ…cej za pomocÄ… prÄ…du **indukowanego przez otrzymane fale radiowe** (**pasywna**).

### Klasy

EPCglobal dzieli etykiety RFID na szeÅ›Ä‡ kategorii. Etykieta w kaÅ¼dej kategorii ma wszystkie moÅ¼liwoÅ›ci wymienione w poprzedniej kategorii, co czyni jÄ… wstecznie kompatybilnÄ….

* Etykiety **klasy 0** to etykiety **pasywne**, ktÃ³re dziaÅ‚ajÄ… w pasmach **UHF**. Producent **preprogramowuje** je w fabryce produkcyjnej. W rezultacie **nie moÅ¼na zmieniÄ‡** informacji przechowywanych w ich pamiÄ™ci.
* Etykiety **klasy 1** mogÄ… rÃ³wnieÅ¼ dziaÅ‚aÄ‡ w pasmach **HF**. Ponadto, moÅ¼na je **zapisaÄ‡ tylko raz** po produkcji. Wiele etykiet klasy 1 moÅ¼e rÃ³wnieÅ¼ przetwarzaÄ‡ **cykliczne sumy kontrolne** (CRC) otrzymywanych poleceÅ„. CRC to kilka dodatkowych bajtÃ³w na koÅ„cu poleceÅ„ sÅ‚uÅ¼Ä…cych do wykrywania bÅ‚Ä™dÃ³w.
* Etykiety **klasy 2** moÅ¼na **zapisywaÄ‡ wielokrotnie**.
* Etykiety **klasy 3** mogÄ… zawieraÄ‡ **wbudowane sensory**, ktÃ³re mogÄ… rejestrowaÄ‡ parametry Å›rodowiskowe, takie jak aktualna temperatura lub ruch etykiety. Te etykiety sÄ… **pÃ³Å‚pasywne**, poniewaÅ¼ chociaÅ¼ **posiadajÄ…** wbudowane ÅºrÃ³dÅ‚o zasilania, takie jak zintegrowana **bateria**, **nie mogÄ… inicjowaÄ‡** bezprzewodowej **komunikacji** z innymi etykietami lub czytnikami.
* Etykiety **klasy 4** mogÄ… inicjowaÄ‡ komunikacjÄ™ z innymi etykietami tej samej klasy, co czyni je **aktywnymi etykietami**.
* Etykiety **klasy 5** mogÄ… dostarczaÄ‡ **zasilanie innym etykietom i komunikowaÄ‡ siÄ™ ze wszystkimi poprzednimi klasami etykiet**. Etykiety klasy 5 mogÄ… dziaÅ‚aÄ‡ jako **czytniki RFID**.

### Informacje przechowywane w etykietach RFID

PamiÄ™Ä‡ etykiety RFID zazwyczaj przechowuje cztery rodzaje danych: **dane identyfikacyjne**, ktÃ³re **identyfikujÄ…** jednostkÄ™, do ktÃ³rej przyczepiona jest etykieta (dane te obejmujÄ… pola zdefiniowane przez uÅ¼ytkownika, takie jak konta bankowe); **dane uzupeÅ‚niajÄ…ce**, ktÃ³re dostarczajÄ… **dodatkowych** **informacji** dotyczÄ…cych jednostki; **dane kontrolne**, uÅ¼ywane do **konfiguracji** wewnÄ™trznej etykiety; oraz **dane producenta** etykiety, ktÃ³re zawierajÄ… unikalny identyfikator etykiety (**UID**) oraz szczegÃ³Å‚y dotyczÄ…ce **produkcji**, **typu** i **producenta** etykiety. Pierwsze dwa rodzaje danych znajdujÄ… siÄ™ we wszystkich komercyjnych etykietach; ostatnie dwa mogÄ… siÄ™ rÃ³Å¼niÄ‡ w zaleÅ¼noÅ›ci od producenta etykiety.

Standard ISO okreÅ›la wartoÅ›Ä‡ identyfikatora rodziny aplikacji (**AFI**), kodu wskazujÄ…cego **rodzaj obiektu**, do ktÃ³rego naleÅ¼y etykieta. Innym waÅ¼nym rejestratorem, rÃ³wnieÅ¼ okreÅ›lonym przez ISO, jest identyfikator formatu przechowywania danych (**DSFID**), ktÃ³ry definiuje **logicznÄ… organizacjÄ™ danych uÅ¼ytkownika**.

WiÄ™kszoÅ›Ä‡ **kontroli bezpieczeÅ„stwa** RFID ma mechanizmy, ktÃ³re **ograniczajÄ…** operacje **odczytu** lub **zapisu** na kaÅ¼dym bloku pamiÄ™ci uÅ¼ytkownika oraz na specjalnych rejestrach zawierajÄ…cych wartoÅ›ci AFI i DSFID. Te **mechanizmy blokady** uÅ¼ywajÄ… danych przechowywanych w pamiÄ™ci kontrolnej i majÄ… **prekonfigurowane domyÅ›lne hasÅ‚a** dostawcy, ale pozwalajÄ… wÅ‚aÅ›cicielom etykiety na **konfiguracjÄ™ niestandardowych haseÅ‚**.

### PorÃ³wnanie tagÃ³w o niskiej i wysokiej czÄ™stotliwoÅ›ci

<figure><img src="../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## Tagi RFID o niskiej czÄ™stotliwoÅ›ci (125kHz)

**Tagi o niskiej czÄ™stotliwoÅ›ci** sÄ… czÄ™sto uÅ¼ywane w systemach, ktÃ³re **nie wymagajÄ… wysokiego poziomu bezpieczeÅ„stwa**: dostÄ™p do budynkÃ³w, klucze do domofonÃ³w, karty czÅ‚onkowskie siÅ‚owni, itp. Ze wzglÄ™du na wiÄ™kszy zasiÄ™g sÄ… wygodne w przypadku pÅ‚atnego parkowania samochodÃ³w: kierowca nie musi przybliÅ¼aÄ‡ karty do czytnika, poniewaÅ¼ jest ona aktywowana z wiÄ™kszej odlegÅ‚oÅ›ci. JednoczeÅ›nie tagi o niskiej czÄ™stotliwoÅ›ci sÄ… bardzo prymitywne, majÄ… niskÄ… szybkoÅ›Ä‡ transferu danych. Z tego powodu niemoÅ¼liwe jest zaimplementowanie zÅ‚oÅ¼onego dwukierunkowego transferu danych, takiego jak utrzymanie salda i kryptografia. Tagi o niskiej czÄ™stotliwoÅ›ci przesyÅ‚ajÄ… tylko swoje krÃ³tkie ID bez Å¼adnych Å›rodkÃ³w uwierzytelniania.

Te urzÄ…dzenia polegajÄ… na technologii **pasywnej** **RFID** i dziaÅ‚ajÄ… w **zakresie od 30 kHz do 300 kHz**, chociaÅ¼ zazwyczaj uÅ¼ywa siÄ™ 125 kHz do 134 kHz:

* **DÅ‚ugi zasiÄ™g** â€” niÅ¼sza czÄ™stotliwoÅ›Ä‡ przekÅ‚ada siÄ™ na wiÄ™kszy zasiÄ™g. IstniejÄ… niektÃ³re czytniki EM-Marin i HID, ktÃ³re dziaÅ‚ajÄ… z odlegÅ‚oÅ›ci do jednego metra. SÄ… one czÄ™sto stosowane w parkingu samochodowym.
* **ProtokÃ³Å‚ prymitywny** â€” ze wzglÄ™du na niskÄ… szybkoÅ›Ä‡ transferu danych te tagi mogÄ… przesyÅ‚aÄ‡ tylko swoje krÃ³tkie ID. W wiÄ™kszoÅ›ci przypadkÃ³w dane nie sÄ… uwierzytelniane i nie sÄ… w Å¼aden sposÃ³b chronione. Jak tylko karta znajduje siÄ™ w zasiÄ™gu czytnika, zaczyna przesyÅ‚aÄ‡ swoje ID.
* **Niskie bezpieczeÅ„stwo** â€” te karty moÅ¼na Å‚atwo skopiowaÄ‡ lub nawet odczytaÄ‡ z kieszeni innej osoby ze wzglÄ™du na prymitywnoÅ›Ä‡ protokoÅ‚u.

**Popularne protokoÅ‚y 125 kHz:**

* **EM-Marin** â€” EM4100

## Tagi RFID o wysokiej czÄ™stotliwoÅ›ci (13,56 MHz)

**Tagi o wysokiej czÄ™stotliwoÅ›ci** sÄ… uÅ¼ywane do bardziej zÅ‚oÅ¼onej interakcji miÄ™dzy czytnikiem a tagiem, gdy potrzebna jest kryptografia, duÅ¼a dwukierunkowa transmisja danych, uwierzytelnianie itp.\
Zazwyczaj sÄ… one stosowane w kartach bankowych, transporcie publicznym i innych bezpiecznych przepustkach.

**Tagi o wysokiej czÄ™stotliwoÅ›ci 13,56 MHz to zestaw standardÃ³w i protokoÅ‚Ã³w**. Zazwyczaj sÄ… one okreÅ›lane jako [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ale nie zawsze jest to poprawne. Podstawowy zestaw protokoÅ‚Ã³w uÅ¼ywanych na poziomie fizycznym i logicznym to ISO 14443. ProtokoÅ‚y na wyÅ¼szym poziomie, a takÅ¼e alternatywne standardy (takie jak ISO 19092), sÄ… oparte na nim. Wielu ludzi odnosi siÄ™ do tej technologii jako **komunikacji w polu zbliÅ¼eniowym (NFC)**, terminu uÅ¼ywanego dla urzÄ…dzeÅ„ dziaÅ‚ajÄ…cych w czÄ™stotliwoÅ›ci 13,56 MHz.

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

W skrÃ³cie, architektura NFC dziaÅ‚a w ten sposÃ³b: protokÃ³Å‚ transmisji jest wybierany przez firmÄ™ produkujÄ…cÄ… karty i implementowany na podstawie niskopoziomowego ISO 14443. Na przykÅ‚ad, NXP wynalazÅ‚ wÅ‚asny protokÃ³Å‚ transmisji na wyÅ¼szym poziomie, zwany Mifare. Ale na niÅ¼szym poziomie karty Mifare sÄ… oparte na standardzie ISO 14443-A.

Flipper moÅ¼e wspÃ³Å‚pracowaÄ‡ zarÃ³wno z protokoÅ‚em ISO 14443 na niskim poziomie, jak i z protokoÅ‚em transmisji danych Mifare Ultralight i EMV uÅ¼ywanym w kartach bankowych. Pracujemy nad dodaniem obsÅ‚ugi dla Mifare Classic i NFC NDEF. DokÅ‚adne omÃ³wienie protokoÅ‚Ã³w i standardÃ³w, ktÃ³re tworzÄ… NFC, warto przeczytaÄ‡ w osobnym artykule, ktÃ³ry planujemy opublikowaÄ‡ wkrÃ³tce.

Wszystkie karty o wysokiej czÄ™stotliwoÅ›ci oparte na standardzie ISO 14443-A majÄ… unikalny identyfikator chipa. DziaÅ‚a on jako numer seryjny karty, podobnie jak adres MAC karty sieciowej. **Zazwyczaj UID ma dÅ‚ugoÅ›Ä‡ 4 lub 7 bajtÃ³w**, ale czasami moÅ¼e siÄ™gaÄ‡ **aÅ¼ do 10**. UID nie jest tajemnicÄ… i jest Å‚atwo odczytywalny, **czasami nawet wydrukowany na samej karcie**.

Istnieje wiele systemÃ³w kontroli dostÄ™pu, ktÃ³re polegajÄ… na UID do **uwierzytelniania i przyznawania dostÄ™pu**. Czasami dzieje siÄ™ tak **nawet** w przypadku, gdy tagi RFID **obsÅ‚ugujÄ… kryptografiÄ™**. Takie **niewÅ‚aÅ›ciwe** wykorzystanie obniÅ¼a je do poziomu **kart 125 kHz** pod wzglÄ™dem **bezpieczeÅ„stwa**. Wirtualne karty (takie jak Apple Pay) uÅ¼ywajÄ… dynamicznego UID, aby wÅ‚aÅ›ciciele telefonÃ³w nie otwierali drzwi za pomocÄ… aplikacji pÅ‚atniczej.

* **KrÃ³tki zasiÄ™g** - karty o wysokiej czÄ™stotliwoÅ›ci sÄ… specjalnie zaprojektowane tak, aby musiaÅ‚y byÄ‡ umieszczone blisko czytnika. Pomaga to rÃ³wnieÅ¼ chroniÄ‡ kartÄ™ przed nieautoryzowanymi interakcjami. Maksymalny zasiÄ™g odczytu, ktÃ³ry udaÅ‚o nam siÄ™ osiÄ…gnÄ…Ä‡, wynosiÅ‚ okoÅ‚o 15 cm, a to dziÄ™ki specjalnie wykonanym czytnikom o duÅ¼ym zasiÄ™gu.
* **Zaawansowane protokoÅ‚y** - prÄ™dkoÅ›ci transferu danych do 424 kbps umoÅ¼liwiajÄ… zÅ‚oÅ¼one protokoÅ‚y z peÅ‚nÄ… dwukierunkowÄ… transmisjÄ… danych. Co z kolei **umoÅ¼liwia kryptografiÄ™**, transfer danych itp.
* **Wysokie bezpieczeÅ„stwo** - bezstykowe karty o wysokiej czÄ™stotliwoÅ›ci nie ustÄ™pujÄ… w Å¼aden sposÃ³b kartom inteligentnym. IstniejÄ… karty, ktÃ³re obsÅ‚ugujÄ… silne algorytmy kryptograficzne, takie jak AES, i implementujÄ… kryptografiÄ™ asymetrycznÄ….

### Atak

MoÅ¼esz **zaatakowaÄ‡ te tagi za pomocÄ… Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Lub uÅ¼ywajÄ…c **proxmarka**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## OdwoÅ‚ania

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmujÄ…cej siÄ™ cyberbezpieczeÅ„stwem**? Chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks**? A moÅ¼e chcesz mieÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR do repozytorium** [**hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
