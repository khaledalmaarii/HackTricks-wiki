# Pentesting RFID

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **cybersecurity kompaniji**? Å½elite li da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u**? Ili Å¾elite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **PridruÅ¾ite se** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova** [**hacktricks repo-u**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo-u**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Uvod

**Radio Frequency Identification (RFID)** je najpopularnije reÅ¡enje za kratkodometno beÅ¾iÄno prepoznavanje. ObiÄno se koristi za skladiÅ¡tenje i prenos informacija koje identifikuju entitet.

RFID oznaka moÅ¾e se oslanjati na **sopstveni izvor napajanja (aktivna)**, poput ugraÄ‘ene baterije, ili moÅ¾e dobijati napajanje od antene za Äitanje putem struje **indukovane iz primljenih radio talasa** (**pasivna**).

### Klase

EPCglobal deli RFID oznake u Å¡est kategorija. Oznaka u svakoj kategoriji ima sve moguÄ‡nosti navedene u prethodnoj kategoriji, Å¡to je Äini kompatibilnom unazad.

* **Klasa 0** oznake su **pasivne** oznake koje rade u **UHF** opsezima. ProizvoÄ‘aÄ ih **unapred programira** u fabriÄkoj proizvodnji. Kao rezultat toga, **ne moÅ¾ete promeniti** informacije koje su saÄuvane u njihovoj memoriji.
* **Klasa 1** oznake takoÄ‘e mogu raditi u **HF** opsezima. Osim toga, mogu se **jednom napisati** nakon proizvodnje. Mnoge klase 1 oznaka takoÄ‘e mogu obraditi **cikliÄne redundante provere** (CRC) komandi koje primaju. CRC su nekoliko dodatnih bajtova na kraju komandi za otkrivanje greÅ¡aka.
* **Klasa 2** oznake mogu se **viÅ¡e puta pisati**.
* **Klasa 3** oznake mogu sadrÅ¾ati **ugraÄ‘ene senzore** koji mogu beleÅ¾iti okruÅ¾ne parametre, poput trenutne temperature ili kretanja oznake. Ove oznake su **polu-pasivne**, jer iako **imaju** ugraÄ‘eni izvor napajanja, poput integrisane **baterije**, ne mogu pokrenuti beÅ¾iÄnu **komunikaciju** sa drugim oznakama ili ÄitaÄima.
* **Klasa 4** oznake mogu pokrenuti komunikaciju sa drugim oznakama iste klase, ÄineÄ‡i ih **aktivnim oznakama**.
* **Klasa 5** oznake mogu pruÅ¾iti **napajanje drugim oznakama i komunicirati sa svim prethodnim klasama** oznaka. Klasa 5 oznaka moÅ¾e delovati kao **RFID ÄitaÄ**.

### Informacije saÄuvane u RFID oznakama

Memorija RFID oznake obiÄno Äuva Äetiri vrste podataka: **identifikacione podatke**, koji **identifikuju** **entitet** kojem je oznaka pridruÅ¾ena (ovi podaci ukljuÄuju korisniÄki definisana polja, poput bankovnih raÄuna); **dodatne podatke**, koji pruÅ¾aju **dodatne detalje** o entitetu; **kontrolne podatke**, koji se koriste za **internu konfiguraciju** oznake; i **proizvoÄ‘aÄke podatke** oznake, koji sadrÅ¾e jedinstveni identifikator oznake (**UID**) i detalje o **proizvodnji**, **tipu** i **prodavcu** oznake. Prve dve vrste podataka moÅ¾ete pronaÄ‡i u svim komercijalnim oznakama; poslednje dve se mogu razlikovati na osnovu prodavca oznake.

ISO standard specificira vrednost Application Family Identifier (**AFI**), kod koji ukazuje na **vrstu objekta** kojoj oznaka pripada. JoÅ¡ jedan vaÅ¾an registar, takoÄ‘e specificiran od strane ISO, je Data Storage Format Identifier (**DSFID**), koji definiÅ¡e **logiÄku organizaciju korisniÄkih podataka**.

VeÄ‡ina RFID **sigurnosnih kontrola** ima mehanizme koji **ograniÄavaju** operacije **Äitanja** ili **pisanja** na svakom bloku korisniÄke memorije i na posebnim registrima koji sadrÅ¾e vrednosti AFI i DSFID. Ovi **mehanizmi zakljuÄavanja** koriste podatke saÄuvane u kontrolnoj memoriji i imaju **unapred podeÅ¡ene lozinke** od strane prodavca, ali omoguÄ‡avaju vlasnicima oznaka da **konfiguriÅ¡u prilagoÄ‘ene lozinke**.

### PoreÄ‘enje oznaka niske i visoke frekvencije

<figure><img src="../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## RFID oznake niske frekvencije (125kHz)

**Oznake niske frekvencije** se Äesto koriste u sistemima koji **ne zahtevaju visoku sigurnost**: pristup zgradama, kljuÄevi za interfonske sisteme, Älanske karte za teretane, itd. Zbog veÄ‡eg dometa, pogodne su za koriÅ¡Ä‡enje u plaÄ‡enim parking prostorima: vozaÄ ne mora da pribliÅ¾ava karticu ÄitaÄu, jer se aktivira sa veÄ‡e udaljenosti. Istovremeno, oznake niske frekvencije su veoma primitivne, imaju nisku brzinu prenosa podataka. Iz tog razloga, nemoguÄ‡e je implementirati kompleksan dvosmerni prenos podataka za stvari poput odrÅ¾avanja salda i kriptografije. Oznake niske frekvencije samo prenose svoj kratki ID bez ikakvih sredstava za autentifikaciju.

Ovi ureÄ‘aji se oslanjaju na **pasivnu** **RFID** tehnologiju i rade u **opsegu od 30 kHz do 300 kHz**, iako je uobiÄajenije koristiti 125 kHz do 134 kHz:

* **DugaÄak domaÄ‡i** â€” niÅ¾a frekvencija se prevodi u veÄ‡i domaÄ‡i. Postoje neki EM-Marin i HID ÄitaÄi, koji rade sa udaljenosti do jednog metra. Oni se Äesto koriste u parking prostorima.
* **Primitivan protokol** â€” zbog niske brzine prenosa podataka, ove oznake mogu samo prenositi svoj kratki ID. U veÄ‡ini sluÄajeva, podaci nisu autentifikovani i nisu zaÅ¡tiÄ‡eni na bilo koji naÄin. ÄŒim je kartica u opsegu ÄitaÄa, poÄinje da prenosi svoj ID.
* **Niska sigurnost** â€” Ove kartice se lako mogu kopirati, ili Äak oÄitati iz tuÄ‘eg dÅ¾epa zbog primitivnosti protokola.

**Popularni 125 kHz protokoli:**

* **EM-Marin** â€” EM4100, EM4102. Najpopularniji protokol u CIS-u. MoÅ¾e se oÄitati sa udaljenosti od oko jednog metra zbog svoje jednostavnosti i stabilnosti.
* **HID Prox II** â€” niskofrekventni protokol koji je uveo HID Global. Ovaj protokol je popularniji u zapadnim zemljama. On je slo

## RFID oznake visoke frekvencije (13,56 MHz)

**RFID oznake visoke frekvencije** se koriste za sloÅ¾enu interakciju ÄitaÄa i oznake kada je potrebna kriptografija, dvosmerna razmena podataka, autentifikacija, itd. ObiÄno se nalaze na bankovnim karticama, javnom prevozu i drugim sigurnosnim prolazima.

**RFID oznake visoke frekvencije od 13,56 MHz su skup standarda i protokola**. ObiÄno se nazivaju [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ali to nije uvek taÄno. Osnovni set protokola koji se koristi na fiziÄkom i logiÄkom nivou je ISO 14443. Visokonaponski protokoli, kao i alternativni standardi (poput ISO 19092), se zasnivaju na njemu. Mnogi ljudi ovu tehnologiju nazivaju **Near Field Communication (NFC)**, Å¡to je termin za ureÄ‘aje koji rade na frekvenciji od 13,56 MHz.

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Da jednostavno objasnimo, arhitektura NFC-a funkcioniÅ¡e na sledeÄ‡i naÄin: protokol prenosa bira kompanija koja pravi kartice i implementira ga na osnovu niskog nivoa ISO 14443. Na primer, NXP je izumela sopstveni protokol prenosa visokog nivoa koji se zove Mifare. Ali na niÅ¾em nivou, Mifare kartice se zasnivaju na ISO 14443-A standardu.

Flipper moÅ¾e da komunicira kako sa protokolom prenosa ISO 14443 na niskom nivou, tako i sa protokolom prenosa podataka Mifare Ultralight i EMV koji se koristi na bankovnim karticama. Radimo na dodavanju podrÅ¡ke za Mifare Classic i NFC NDEF. Detaljan pregled protokola i standarda koji Äine NFC vredi poseban Älanak koji planiramo da objavimo kasnije.

Sve visokofrekventne kartice zasnovane na ISO 14443-A standardu imaju jedinstveni ID Äipa. On deluje kao serijski broj kartice, poput MAC adrese mreÅ¾ne kartice. **ObiÄno je UID duÅ¾ine 4 ili 7 bajtova**, ali retko moÅ¾e da bude **do 10 bajtova**. UID-ovi nisu tajni i lako se mogu proÄitati, **ponekad Äak i odÅ¡tampani na samoj kartici**.

Postoji mnogo sistema za kontrolu pristupa koji se oslanjaju na UID za **autentifikaciju i dodelu pristupa**. Ponekad se to deÅ¡ava **Äak i** kada RFID oznake **podrÅ¾avaju kriptografiju**. Takva **zloupotreba** ih svodi na nivo glupih **125 kHz kartica** u smislu **bezbednosti**. Virtuelne kartice (poput Apple Pay) koriste dinamiÄki UID kako vlasnici telefona ne bi otvarali vrata svojom aplikacijom za plaÄ‡anje.

* **Mali domet** - visokofrekventne kartice su posebno dizajnirane tako da moraju biti postavljene blizu ÄitaÄa. To takoÄ‘e pomaÅ¾e u zaÅ¡titi kartice od neovlaÅ¡Ä‡ene interakcije. Maksimalni domet Äitanja koji smo uspeli da postignemo bio je oko 15 cm, i to sa ÄitaÄima visokog dometa koje smo sami napravili.
* **Napredni protokoli** - brzine prenosa podataka do 424 kbps omoguÄ‡avaju sloÅ¾ene protokole sa potpunom dvosmernom razmenom podataka. Å to opet **omoguÄ‡ava kriptografiju**, prenos podataka, itd.
* **Visoka bezbednost** - beÅ¾iÄne kartice visoke frekvencije ni na koji naÄin ne zaostaju za pametnim karticama. Postoje kartice koje podrÅ¾avaju kriptografski jake algoritme poput AES i implementiraju asimetriÄnu kriptografiju.

### Napad

MoÅ¾ete **napasti ove oznake pomoÄ‡u Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ili koristeÄ‡i **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Reference

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **kompaniji za kibernetiÄku bezbednost**? Å½elite li da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u**? Ili Å¾elite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **PridruÅ¾ite se** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova** [**hacktricks repo-u**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo-u**](https://github.com/carlospolop/hacktricks-cloud).

</details>
