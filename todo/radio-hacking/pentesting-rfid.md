# Pentesting RFID

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **kompaniji za kibernetiÄku bezbednost**? Å½elite li da vidite svoju **kompaniju reklamiranu na HackTricks**? ili Å¾elite da imate pristup **najnovijoj verziji PEASS ili preuzmete HackTricks u PDF formatu**? Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **PridruÅ¾ite se** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **Discord grupi** ili **telegram grupi** ili me **pratite** na **Twitteru** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova** [**hacktricks repozitorijumu**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repozitorijumu**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Uvod

**Radio Frekvencijska Identifikacija (RFID)** je najpopularnije reÅ¡enje za kratkodometnu radio komunikaciju. ObiÄno se koristi za skladiÅ¡tenje i prenos informacija koje identifikuju entitet.

RFID oznaka moÅ¾e da se oslanja na **sopstveni izvor napajanja (aktivna)**, poput ugraÄ‘ene baterije, ili da prima napajanje od ÄitaÄa antene koristeÄ‡i trenutnu **indukciju od primljenih radio talasa** (**pasivna**).

### Klase

EPCglobal deli RFID oznake u Å¡est kategorija. Oznaka u svakoj kategoriji ima sve moguÄ‡nosti navedene u prethodnoj kategoriji, Äime je kompatibilna unazad.

* **Klasa 0** oznake su **pasivne** oznake koje rade u **UHF** opsezima. ProizvoÄ‘aÄ ih **unapred programira** u fabriÄkoj proizvodnji. Kao rezultat toga, **ne moÅ¾ete promeniti** informacije koje su skladiÅ¡tene u njihovoj memoriji.
* **Klasa 1** oznake takoÄ‘e mogu raditi u **HF** opsezima. Pored toga, mogu se **pisati samo jednom** nakon proizvodnje. Mnoge Klasa 1 oznake takoÄ‘e mogu obraditi **cikliÄne redundante provere** (CRC) komandi koje primaju. CRC-ovi su nekoliko dodatnih bajtova na kraju komandi za detekciju greÅ¡aka.
* **Klasa 2** oznake mogu se **pisati viÅ¡e puta**.
* **Klasa 3** oznake mogu sadrÅ¾ati **ugraÄ‘ene senzore** koji mogu beleÅ¾iti okolne parametre, poput trenutne temperature ili kretanja oznake. Ove oznake su **polu-pasivne**, jer iako **imaju** ugraÄ‘eni izvor napajanja, poput integrisane **baterije**, ne mogu inicirati beÅ¾iÄnu **komunikaciju** sa drugim oznakama ili ÄitaÄima.
* **Klasa 4** oznake mogu inicirati komunikaciju sa drugim oznakama iste klase, Äime postaju **aktivne oznake**.
* **Klasa 5** oznake mogu obezbediti **napajanje drugim oznakama i komunicirati sa svim prethodnim klasama** oznaka. Klasa 5 oznake mogu delovati kao **RFID ÄitaÄi**.

### Informacije SkladiÅ¡tene u RFID Oznakama

Memorija RFID oznake obiÄno skladiÅ¡ti Äetiri vrste podataka: **identifikacione podatke**, koji **identifikuju** **entitet** na koji je oznaka prikaÄena (ovi podaci ukljuÄuju korisniÄki definisana polja, poput bankovnih raÄuna); **dodatne podatke**, koji pruÅ¾aju **dodatne** **detalje** o entitetu; **kontrolne podatke**, koriÅ¡Ä‡ene za internu **konfiguraciju** oznake; i proizvoÄ‘aÄke podatke oznake, koji sadrÅ¾e Jedinstveni Identifikator Oznake (**UID**) i detalje o proizvodnji, tipu i prodavcu oznake. Prve dve vrste podataka se mogu naÄ‡i u svim komercijalnim oznakama; poslednje dve se mogu razlikovati u zavisnosti od prodavca oznake.

ISO standard specificira vrednost Identifikatora Aplikacione Porodice (**AFI**), kod koji oznaÄava **vrstu objekta** kojoj oznaka pripada. JoÅ¡ jedan vaÅ¾an registar, takoÄ‘e specificiran od strane ISO-a, je Identifikator Formata SkladiÅ¡tenja Podataka (**DSFID**), koji definiÅ¡e **logiÄku organizaciju korisniÄkih podataka**.

VeÄ‡ina RFID **sigurnosnih kontrola** ima mehanizme koji **ograniÄavaju** operacije **Äitanja** ili **pisanja** na svakom korisniÄkom bloku memorije i na specijalnim registrima koji sadrÅ¾e vrednosti AFI i DSFID. Ovi **mehanizmi zakljuÄavanja** koriste podatke skladiÅ¡tene u kontrolnoj memoriji i imaju **unapred podeÅ¡ene Å¡ifre** od strane prodavca, ali dozvoljavaju vlasnicima oznaka da **konfiguriÅ¡u prilagoÄ‘ene Å¡ifre**.

### PoreÄ‘enje Niskofrekventnih i Visokofrekventnih Oznaka

<figure><img src="../../.gitbook/assets/image (980).png" alt=""><figcaption></figcaption></figure>

## Niskofrekventne RFID Oznake (125kHz)

**Niskofrekventne oznake** se Äesto koriste u sistemima koji **ne zahtevaju visoku sigurnost**: pristup zgradama, kljuÄevi za interfonske ureÄ‘aje, Älanstvo u teretanama, itd. Zbog njihovog veÄ‡eg opsega, pogodne su za koriÅ¡Ä‡enje u plaÄ‡enim parking prostorima: vozaÄ ne mora da pribliÅ¾i karticu ÄitaÄu, jer se aktivira sa daljine. Istovremeno, niskofrekventne oznake su veoma primitivne, imaju nisku stopu prenosa podataka. Iz tog razloga, nemoguÄ‡e je implementirati kompleksnu dvosmernu razmenu podataka za stvari poput Äuvanja salda i kriptografije. Niskofrekventne oznake samo prenose svoj kratki ID bez ikakvih sredstava za autentikaciju.

Ovi ureÄ‘aji se oslanjaju na **pasivnu** **RFID** tehnologiju i rade u **opsegu od 30 kHz do 300 kHz**, iako je ÄeÅ¡Ä‡e koristiti 125 kHz do 134 kHz:

* **Dug opseg** â€” niÅ¾a frekvencija se prevodi u veÄ‡i opseg. Postoje neki EM-Marin i HID ÄitaÄi, koji rade sa udaljenosti do metar. ÄŒesto se koriste u parking prostorima.
* **Primitivan protokol** â€” zbog niske stope prenosa podataka, ove oznake mogu samo prenositi svoj kratki ID. U veÄ‡ini sluÄajeva, podaci nisu autentifikovani i nisu zaÅ¡tiÄ‡eni na bilo koji naÄin. ÄŒim je kartica u opsegu ÄitaÄa, poÄinje da prenosi svoj ID.
* **Niska sigurnost** â€” Ove kartice se lako mogu kopirati, ili Äak proÄitati iz tuÄ‘eg dÅ¾epa zbog primitivnosti protokola.

**Popularni 125 kHz protokoli:**

* **EM-Marin** â€” EM4100, EM4102. Najpopularniji protokol u CIS-u. MoÅ¾e se proÄitati sa oko metar zbog svoje jednostavnosti i stabilnosti.
* **HID Prox II** â€” niskofrekventni protokol koji je predstavio HID Global. Ovaj protokol je popularniji u zapadnim zemljama. SloÅ¾eniji je i kartice i ÄitaÄi za ovaj protokol su relativno skupi.
* **Indala** â€” veoma stari niskofrekventni protokol koji je predstavio Motorola, a kasnije je kupljen od strane HID-a. Manje je verovatno da Ä‡ete ga sresti u divljini u poreÄ‘enju sa prethodna dva jer izlazi iz upotrebe.

U stvarnosti, postoji mnogo viÅ¡e niskofrekventnih protokola. Ali svi oni koriste istu modulaciju na fiziÄkom sloju i mogu se smatrati, na ovaj ili onaj naÄin, varijacijom navedenih protokola.

### Napad

MoÅ¾ete **napasti ove Oznake sa Flipper Zero ureÄ‘ajem**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## RFID oznake visoke frekvencije (13,56 MHz)

**Oznake visoke frekvencije** se koriste za sloÅ¾eniju interakciju ÄitaÄa i oznake kada je potrebna kriptografija, veliki dvosmerni prenos podataka, autentikacija, itd. ObiÄno se nalaze na bankovnim karticama, javnom prevozu i drugim sigurnosnim prolazima.

**Oznake visoke frekvencije od 13,56 MHz su skup standarda i protokola**. ObiÄno se nazivaju [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ali to nije uvek taÄno. Osnovni set protokola koji se koristi na fiziÄkom i logiÄkom nivou je ISO 14443. Visokonivovski protokoli, kao i alternativni standardi (poput ISO 19092), zasnovani su na njemu. Mnogi ljude nazivaju ovu tehnologiju **Near Field Communication (NFC)**, termin za ureÄ‘aje koji rade na frekvenciji od 13,56 MHz.

<figure><img src="../../.gitbook/assets/image (927).png" alt=""><figcaption></figcaption></figure>

Da bismo to pojednostavili, arhitektura NFC-a funkcioniÅ¡e na sledeÄ‡i naÄin: protokol prenosa bira kompanija koja pravi kartice i implementira ga na osnovu niskonivoaÅ¡kog ISO 14443. Na primer, NXP je izmislio svoj visokonivoaÅ¡ki protokol prenosa nazvan Mifare. Ali na niÅ¾em nivou, Mifare kartice se zasnivaju na ISO 14443-A standardu.

Flipper moÅ¾e da interaguje kako sa niskonivoaÅ¡kim ISO 14443 protokolom, tako i sa Mifare Ultralight protokolom prenosa podataka i EMV-om koji se koristi na bankovnim karticama. Radimo na dodavanju podrÅ¡ke za Mifare Classic i NFC NDEF. Detaljan pregled protokola i standarda koji Äine NFC vredi posebnog Älanka koji planiramo da objavimo kasnije.

Sve visokofrekventne kartice zasnovane na ISO 14443-A standardu imaju jedinstveni ID Äipa. Deluje kao serijski broj kartice, poput MAC adrese mreÅ¾ne kartice. **ObiÄno je UID duÅ¾ine 4 ili 7 bajtova**, ali retko moÅ¾e da bude **do 10**. UID-ovi nisu tajni i lako su Äitljivi, **ponekad Äak i odÅ¡tampani na samoj kartici**.

Postoji mnogo sistema za kontrolu pristupa koji se oslanjaju na UID za **autentikaciju i dodelu pristupa**. Ponekad se to deÅ¡ava **Äak i** kada RFID oznake **podrÅ¾avaju kriptografiju**. Takva **zloupotreba** ih svodi na nivo glupih **125 kHz kartica** u smislu **bezbednosti**. Virtuelne kartice (poput Apple Pay) koriste dinamiÄki UID kako vlasnici telefona ne bi otvarali vrata svojom aplikacijom za plaÄ‡anje.

* **Mali domet** â€” visokofrekventne kartice su specijalno dizajnirane tako da moraju biti blizu ÄitaÄa. To takoÄ‘e pomaÅ¾e u zaÅ¡titi kartice od neovlaÅ¡Ä‡enih interakcija. Maksimalni domet Äitanja koji smo uspeli da postignemo bio je oko 15 cm, i to sa ÄitaÄima visokog dometa koje smo sami napravili.
* **Napredni protokoli** â€” brzine prenosa podataka do 424 kbps omoguÄ‡avaju kompleksne protokole sa potpunim dvosmernim prenosom podataka. Å to zauzvrat **omoguÄ‡ava kriptografiju**, prenos podataka, itd.
* **Visoka bezbednost** â€” beskontaktne kartice visoke frekvencije ni na koji naÄin ne zaostaju za pametnim karticama. Postoje kartice koje podrÅ¾avaju kriptografski jake algoritme poput AES i implementiraju asimetriÄnu kriptografiju.

### Napad

MoÅ¾ete **napasti ove oznake pomoÄ‡u Flipper Zero ureÄ‘aja**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ili koristeÄ‡i **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Reference

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)
