# RFID Pentesting

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* **Bir siber gÃ¼venlik ÅŸirketinde mi Ã§alÄ±ÅŸÄ±yorsunuz? Åirketinizin HackTricks'te reklamÄ±nÄ± gÃ¶rmek ister misiniz? ya da PEASS'Ä±n en son sÃ¼rÃ¼mÃ¼ne eriÅŸmek veya HackTricks'i PDF olarak indirmek ister misiniz? [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* **ğŸ’¬** [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek PR'lar gÃ¶ndererek** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile paylaÅŸÄ±n.**

</details>

## GiriÅŸ

**Radyo FrekansÄ± TanÄ±mlama (RFID)** en popÃ¼ler kÄ±sa menzilli radyo Ã§Ã¶zÃ¼mÃ¼dÃ¼r. Genellikle bir varlÄ±ÄŸÄ± tanÄ±mlayan bilgileri depolamak ve iletmek iÃ§in kullanÄ±lÄ±r.

Bir RFID etiketi, **kendi gÃ¼Ã§ kaynaÄŸÄ±na (aktif)**, Ã¶rneÄŸin gÃ¶mÃ¼lÃ¼ bir pil, dayanabilir veya okuma anteninden gelen radyo dalgalarÄ±ndan alÄ±nan akÄ±mÄ± kullanarak gÃ¼cÃ¼nÃ¼ alabilir (**pasif**).

### SÄ±nÄ±flar

EPCglobal, RFID etiketlerini altÄ± kategoriye ayÄ±rÄ±r. Her kategorideki bir etiket, Ã¶nceki kategoride listelenen tÃ¼m yeteneklere sahiptir, bu da onu geriye dÃ¶nÃ¼k uyumlu yapar.

* **SÄ±nÄ±f 0** etiketler, **UHF** bantlarÄ±nda Ã§alÄ±ÅŸan **pasif** etiketlerdir. Ãœretim fabrikasÄ±nda satÄ±cÄ± tarafÄ±ndan **Ã¶nceden programlanÄ±r**. SonuÃ§ olarak, belleÄŸinde depolanan bilgileri **deÄŸiÅŸtiremezsiniz**.
* **SÄ±nÄ±f 1** etiketler ayrÄ±ca **HF** bantlarÄ±nda da Ã§alÄ±ÅŸabilir. AyrÄ±ca, Ã¼retimden sonra **yalnÄ±zca bir kez yazÄ±labilirler**. BirÃ§ok SÄ±nÄ±f 1 etiketi, aldÄ±klarÄ± komutlarÄ±n **dÃ¶ngÃ¼sel uyumluluk denetimlerini** (CRC'ler) iÅŸleyebilir. CRC'ler, hata tespiti iÃ§in komutlarÄ±n sonunda birkaÃ§ ek bayttÄ±r.
* **SÄ±nÄ±f 2** etiketler **birden fazla kez yazÄ±labilir**.
* **SÄ±nÄ±f 3** etiketler, **gÃ¶mÃ¼lÃ¼ sensÃ¶rler** iÃ§erebilir ve Ã§evresel parametreleri, Ã¶rneÄŸin mevcut sÄ±caklÄ±k veya etiketin hareketini kaydedebilir. Bu etiketler, **yarÄ±-pasif** olduÄŸundan, gÃ¶mÃ¼lÃ¼ bir **pil** gibi bir gÃ¼Ã§ kaynaÄŸÄ±na sahip olmalarÄ±na raÄŸmen, diÄŸer etiketler veya okuyucularla kablosuz **iletiÅŸim baÅŸlatamazlar**.
* **SÄ±nÄ±f 4** etiketler, aynÄ± sÄ±nÄ±ftaki diÄŸer etiketlerle iletiÅŸim baÅŸlatabilir, bu da onlarÄ± **aktif etiketler** yapar.
* **SÄ±nÄ±f 5** etiketler, diÄŸer tÃ¼m Ã¶nceki etiket sÄ±nÄ±flarÄ±yla **iletiÅŸim kurabilir ve bu etiketler RFID okuyucu olarak hareket edebilir**.

### RFID Etiketlerinde Depolanan Bilgiler

Bir RFID etiketinin belleÄŸi genellikle dÃ¶rt tÃ¼r veriyi depolar: etiketin baÄŸlÄ± olduÄŸu varlÄ±ÄŸÄ± tanÄ±mlayan **kimlik verileri** (bu veriler, banka hesaplarÄ± gibi kullanÄ±cÄ± tanÄ±mlÄ± alanlarÄ± iÃ§erir); varlÄ±ÄŸa iliÅŸkin **daha fazla ayrÄ±ntÄ±** saÄŸlayan **ek veriler**; etiketin iÃ§ **yapÄ±landÄ±rmasÄ±** iÃ§in kullanÄ±lan **kontrol verileri**; ve etiketin **Ã¼reticisi verileri**, bir etiketin Benzersiz Kimlik Bilgisi (**UID**) ve etiketin **Ã¼retimi**, **tÃ¼rÃ¼** ve **satÄ±cÄ±sÄ±** hakkÄ±ndaki ayrÄ±ntÄ±larÄ± iÃ§erir. Ä°lk iki veri tÃ¼rÃ¼nÃ¼ tÃ¼m ticari etiketlerde bulabilirsiniz; son ikisi etiketin satÄ±cÄ±sÄ±na baÄŸlÄ± olarak farklÄ±lÄ±k gÃ¶sterebilir.

ISO standardÄ±, etiketin ait olduÄŸu **nesne tÃ¼rÃ¼nÃ¼** gÃ¶steren bir kod olan Uygulama Ailesi KimliÄŸi (**AFI**) deÄŸerini belirtir. ISO tarafÄ±ndan belirlenen baÅŸka bir Ã¶nemli kayÄ±t, Veri Depolama FormatÄ± KimliÄŸi (**DSFID**) de, **kullanÄ±cÄ± verilerinin mantÄ±ksal dÃ¼zenini** tanÄ±mlar.

Ã‡oÄŸu RFID **gÃ¼venlik kontrolleri**, her kullanÄ±cÄ± bellek bloÄŸunda ve AFI ve DSFID deÄŸerlerini iÃ§eren Ã¶zel kayÄ±tlarda **okuma** veya **yazma** iÅŸlemlerini **kÄ±sÄ±tlayan** mekanizmalara sahiptir. Bu **kilit** **mekanizmalarÄ±**, kontrol bellekte depolanan verileri kullanÄ±r ve satÄ±cÄ± tarafÄ±ndan Ã¶nceden yapÄ±landÄ±rÄ±lmÄ±ÅŸ **varsayÄ±lan ÅŸifreleri** kullanÄ±r, ancak etiket sahiplerine **Ã¶zel ÅŸifreler yapÄ±landÄ±rma** izni verir.

### DÃ¼ÅŸÃ¼k ve YÃ¼ksek FrekanslÄ± Etiketler KarÅŸÄ±laÅŸtÄ±rmasÄ±

<figure><img src="../../.gitbook/assets/image (980).png" alt=""><figcaption></figcaption></figure>

## DÃ¼ÅŸÃ¼k-FrekanslÄ± RFID Etiketleri (125kHz)

**DÃ¼ÅŸÃ¼k frekanslÄ± etiketler** genellikle yÃ¼ksek gÃ¼venlik gerektirmeyen sistemlerde kullanÄ±lÄ±r: bina giriÅŸi, interkom anahtarlarÄ±, spor salonu Ã¼yelik kartlarÄ± vb. Daha yÃ¼ksek menzilleri nedeniyle, Ã¶deme yapÄ±lÄ±rken arabayÄ± park etmek iÃ§in kullanÄ±mÄ± uygundur: sÃ¼rÃ¼cÃ¼nÃ¼n kartÄ± okuyucuya yaklaÅŸtÄ±rmasÄ±na gerek yoktur, Ã§Ã¼nkÃ¼ daha uzaktan tetiklenir. AynÄ± zamanda, dÃ¼ÅŸÃ¼k frekanslÄ± etiketler Ã§ok basittir, dÃ¼ÅŸÃ¼k veri transfer hÄ±zÄ±na sahiptir. Bu nedenle, bakiye tutma ve ÅŸifreleme gibi karmaÅŸÄ±k iki yÃ¶nlÃ¼ veri transferini uygulamak imkansÄ±zdÄ±r. DÃ¼ÅŸÃ¼k frekanslÄ± etiketler yalnÄ±zca kimliklerini doÄŸrulama olmadan kÄ±sa kimliklerini ileterek iletiÅŸim kurarlar.

Bu cihazlar **pasif RFID** teknolojisine dayanÄ±r ve **30 kHz ila 300 kHz aralÄ±ÄŸÄ±nda** Ã§alÄ±ÅŸÄ±r, ancak genellikle 125 kHz ila 134 kHz kullanÄ±lÄ±r:

* **Uzun Menzil** â€” dÃ¼ÅŸÃ¼k frekans, daha yÃ¼ksek menzile Ã§evrilir. Bir metreye kadar mesafeden Ã§alÄ±ÅŸan bazÄ± EM-Marin ve HID okuyucularÄ± vardÄ±r. Bunlar genellikle araba park yerlerinde kullanÄ±lÄ±r.
* **Basit protokol** â€” dÃ¼ÅŸÃ¼k veri transfer hÄ±zÄ± nedeniyle bu etiketler yalnÄ±zca kÄ±sa kimliklerini iletebilir. Ã‡oÄŸu durumda, veri doÄŸrulanmaz ve herhangi bir ÅŸekilde korunmaz. Kart okuyucunun menzilinde olduÄŸu anda kimliÄŸini iletmeye baÅŸlar.
* **DÃ¼ÅŸÃ¼k gÃ¼venlik** â€” Bu kartlar kolayca kopyalanabilir veya protokolÃ¼n basitliÄŸi nedeniyle baÅŸkasÄ±nÄ±n cebinden bile okunabilir.

**PopÃ¼ler 125 kHz protokolleri:**

* **EM-Marin** â€” EM4100, EM4102. CIS'te en popÃ¼ler protokol. BasitliÄŸi ve kararlÄ±lÄ±ÄŸÄ± nedeniyle yaklaÅŸÄ±k bir metre mesafeden okunabilir.
* **HID Prox II** â€” HID Global tarafÄ±ndan tanÄ±tÄ±lan dÃ¼ÅŸÃ¼k frekanslÄ± protokol. Bu protokol batÄ± Ã¼lkelerinde daha popÃ¼lerdir. Daha karmaÅŸÄ±ktÄ±r ve bu protokol iÃ§in kartlar ve okuyucular nispeten pahalÄ±dÄ±r.
* **Indala** â€” Motorola tarafÄ±ndan tanÄ±tÄ±lan Ã§ok eski dÃ¼ÅŸÃ¼k frekanslÄ± protokol ve daha sonra HID tarafÄ±ndan satÄ±n alÄ±ndÄ±. Bu protokolÃ¼ Ã¶ncekilerden daha az rastlayabilirsiniz Ã§Ã¼nkÃ¼ kullanÄ±mÄ± azalmaktadÄ±r.

GerÃ§ekte, Ã§ok daha fazla dÃ¼ÅŸÃ¼k frekanslÄ± protokol vardÄ±r. Ancak hepsi aynÄ± modÃ¼lasyonu kullanÄ±r ve bir ÅŸekilde yukarÄ±da listelenenlerin bir varyasyonu olarak kabul edilebilir.

### SaldÄ±rÄ±

Bu Etiketlere **Flipper Zero ile saldÄ±rabilirsiniz**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## YÃ¼ksek FrekanslÄ± RFID Etiketleri (13.56 MHz)

**YÃ¼ksek frekanslÄ± etiketler**, ÅŸifreleme, bÃ¼yÃ¼k iki yÃ¶nlÃ¼ veri transferi, kimlik doÄŸrulama vb. gerektiÄŸinde daha karmaÅŸÄ±k bir okuyucu-etiket etkileÅŸimi iÃ§in kullanÄ±lÄ±r.\
Genellikle banka kartlarÄ±nda, toplu taÅŸÄ±ma araÃ§larÄ±nda ve diÄŸer gÃ¼venli geÃ§iÅŸlerde bulunur.

**YÃ¼ksek frekanslÄ± 13.56 MHz etiketler bir dizi standart ve protokoldÃ¼r**. Genellikle [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) olarak adlandÄ±rÄ±lÄ±r, ancak bu her zaman doÄŸru deÄŸildir. Fiziksel ve mantÄ±ksal seviyelerde kullanÄ±lan temel protokol seti ISO 14443 olarak adlandÄ±rÄ±lÄ±r. YÃ¼ksek seviye protokoller ve alternatif standartlar (Ã¶rneÄŸin ISO 19092) buna dayanmaktadÄ±r. BirÃ§ok kiÅŸi bu teknolojiyi **YakÄ±n Alan Ä°letiÅŸimi (NFC)** olarak adlandÄ±rÄ±r, 13.56 MHz frekansÄ± Ã¼zerinde Ã§alÄ±ÅŸan cihazlar iÃ§in bir terimdir.

<figure><img src="../../.gitbook/assets/image (927).png" alt=""><figcaption></figcaption></figure>

BasitÃ§e ifade etmek gerekirse, NFC'nin mimarisi ÅŸu ÅŸekilde Ã§alÄ±ÅŸÄ±r: kartlarÄ± Ã¼reten ÅŸirket, iletiÅŸim protokolÃ¼nÃ¼ seÃ§er ve ISO 14443'e dayalÄ± olarak uygular. Ã–rneÄŸin, NXP kendi yÃ¼ksek seviye iletiÅŸim protokolÃ¼nÃ¼ Mifare olarak adlandÄ±rmÄ±ÅŸtÄ±r. Ancak alt seviyede, Mifare kartlarÄ± ISO 14443-A standardÄ±na dayanÄ±r.

Flipper, hem dÃ¼ÅŸÃ¼k seviye ISO 14443 protokolÃ¼yle hem de banka kartlarÄ±nda kullanÄ±lan Mifare Ultralight veri transfer protokolÃ¼ ve EMV ile etkileÅŸimde bulunabilir. Mifare Classic ve NFC NDEF desteÄŸi eklemek Ã¼zerinde Ã§alÄ±ÅŸÄ±yoruz. NFC'yi oluÅŸturan protokoller ve standartlara detaylÄ± bir bakÄ±ÅŸ ayrÄ± bir makalede deÄŸerlendirilebilir ve ilerleyen zamanlarda yayÄ±nlamayÄ± planlÄ±yoruz.

ISO 14443-A standardÄ±na dayanan tÃ¼m yÃ¼ksek frekanslÄ± kartlar benzersiz bir Ã§ip kimliÄŸine sahiptir. Bu, kartÄ±n seri numarasÄ± gibi davranÄ±r, bir aÄŸ kartÄ±nÄ±n MAC adresi gibi. **Genellikle UID 4 veya 7 bayt uzunluÄŸundadÄ±r**, ancak nadiren **10'a kadar** gidebilir. UID'ler gizli deÄŸildir ve kolayca okunabilir, **bazen kartÄ±n Ã¼zerine bile yazdÄ±rÄ±lÄ±r**.

UID'ye dayanan birÃ§ok eriÅŸim kontrol sistemi, **kimlik doÄŸrulamak ve eriÅŸim saÄŸlamak** iÃ§in kullanÄ±lÄ±r. Bazen bu, RFID etiketleri **ÅŸifreleme**yi desteklese bile gerÃ§ekleÅŸir. Bu tÃ¼r **yanlÄ±ÅŸ kullanÄ±m**, gÃ¼venlik aÃ§Ä±sÄ±ndan **dÃ¼ÅŸÃ¼k seviyeli 125 kHz kartlarÄ±** seviyesine indirir. Sanal kartlar (Ã¶rneÄŸin Apple Pay), telefon sahiplerinin Ã¶deme uygulamalarÄ±yla kapÄ±larÄ± aÃ§masÄ±nÄ± engellemek iÃ§in dinamik bir UID kullanÄ±r.

* **DÃ¼ÅŸÃ¼k menzil** â€” yÃ¼ksek frekanslÄ± kartlar, okuyucuya yakÄ±n yerleÅŸtirilmeleri gereken ÅŸekilde Ã¶zel olarak tasarlanmÄ±ÅŸtÄ±r. Bu aynÄ± zamanda kartÄ± yetkisiz etkileÅŸimlerden korumaya yardÄ±mcÄ± olur. BaÅŸardÄ±ÄŸÄ±mÄ±z maksimum okuma mesafesi yaklaÅŸÄ±k 15 cm idi ve bu Ã¶zel olarak yapÄ±lmÄ±ÅŸ yÃ¼ksek menzilli okuyucularla gerÃ§ekleÅŸtirildi.
* **GeliÅŸmiÅŸ protokoller** â€” 424 kbps'ye kadar veri transfer hÄ±zlarÄ±, tam teÅŸekkÃ¼llÃ¼ iki yÃ¶nlÃ¼ veri transferi ile karmaÅŸÄ±k protokollerin kullanÄ±lmasÄ±na olanak tanÄ±r. Bu da **ÅŸifreleme**, veri transferi vb. saÄŸlar.
* **YÃ¼ksek gÃ¼venlik** â€” yÃ¼ksek frekanslÄ± temasÄ±z kartlar akÄ±llÄ± kartlara hiÃ§bir ÅŸekilde aÅŸaÄŸÄ± deÄŸildir. AES gibi kriptografik gÃ¼Ã§lÃ¼ algoritmalarÄ± destekleyen ve asimetrik ÅŸifreleme uygulayan kartlar bulunmaktadÄ±r.

### SaldÄ±rÄ±

Bu Etiketlere **Flipper Zero ile saldÄ±rabilirsiniz**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ya da **proxmark** kullanarak:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)
