# Testowanie penetracyjne RFID

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Czy pracujesz w **firmie z branÅ¼y cyberbezpieczeÅ„stwa**? Chcesz zobaczyÄ‡, jak Twoja **firma jest reklamowana na HackTricks**? lub chcesz mieÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**repozytorium hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**repozytorium hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Wprowadzenie

**Radio Frequency Identification (RFID)** to najpopularniejsze rozwiÄ…zanie radiowe krÃ³tkiego zasiÄ™gu. Zazwyczaj sÅ‚uÅ¼y do przechowywania i przesyÅ‚ania informacji identyfikujÄ…cych podmiot.

EPCglobal dzieli tagi RFID na szeÅ›Ä‡ kategorii. Tag w kaÅ¼dej kategorii ma wszystkie moÅ¼liwoÅ›ci wymienione w poprzedniej kategorii, co sprawia, Å¼e sÄ… one wstecznie kompatybilne.

* Tagi **klasy 0** to tagi **pasywne**, ktÃ³re dziaÅ‚ajÄ… w pasmach **UHF**. Producent **preprogramowuje** je w fabryce produkcyjnej. W rezultacie **nie moÅ¼na zmieniÄ‡** informacji przechowywanych w ich pamiÄ™ci.
* Tagi **klasy 1** mogÄ… rÃ³wnieÅ¼ dziaÅ‚aÄ‡ w pasmach **HF**. Ponadto mogÄ… byÄ‡ **zapisane tylko raz** po produkcji. Wiele tagÃ³w klasy 1 moÅ¼e rÃ³wnieÅ¼ przetwarzaÄ‡ **sprawdzenia cykliczne redundancji** (CRC) otrzymywanych poleceÅ„. CRC to kilka dodatkowych bajtÃ³w na koÅ„cu poleceÅ„ sÅ‚uÅ¼Ä…cych do wykrywania bÅ‚Ä™dÃ³w.
* Tagi **klasy 2** moÅ¼na **zapisywaÄ‡ wielokrotnie**.
* Tagi **klasy 3** mogÄ… zawieraÄ‡ **wbudowane sensory**, ktÃ³re mogÄ… rejestrowaÄ‡ parametry Å›rodowiskowe, takie jak aktualna temperatura lub ruch tagu. Tagi te sÄ… **pÃ³Å‚pasywne**, poniewaÅ¼ chociaÅ¼ **posiadajÄ…** wbudowane ÅºrÃ³dÅ‚o zasilania, takie jak zintegrowana **bateria**, **nie mogÄ…** inicjowaÄ‡ **komunikacji** bezprzewodowej z innymi tagami lub czytnikami.
* Tagi **klasy 4** mogÄ… inicjowaÄ‡ komunikacjÄ™ z innymi tagami tej samej klasy, co czyni je **aktywnymi tagami**.
* Tagi **klasy 5** mogÄ… dostarczaÄ‡ **zasilanie innym tagom i komunikowaÄ‡ siÄ™ ze wszystkimi poprzednimi klasami** tagÃ³w. Tagi klasy 5 mogÄ… dziaÅ‚aÄ‡ jako **czytniki RFID**.

### Informacje Przechowywane w Tagach RFID

PamiÄ™Ä‡ tagu RFID zazwyczaj przechowuje cztery rodzaje danych: **dane identyfikacyjne**, ktÃ³re **identyfikujÄ…** **podmiot**, do ktÃ³rego przyczepiony jest tag (te dane obejmujÄ… pola zdefiniowane przez uÅ¼ytkownika, takie jak konta bankowe); **dane uzupeÅ‚niajÄ…ce**, ktÃ³re dostarczajÄ… **dodatkowych** **informacji** dotyczÄ…cych podmiotu; **dane kontrolne**, uÅ¼ywane do wewnÄ™trznej **konfiguracji** tagu; oraz **dane producenta tagu**, ktÃ³re zawierajÄ… unikalny identyfikator tagu (**UID**) oraz szczegÃ³Å‚y dotyczÄ…ce **produkcji**, **typu** i **producenta** tagu. Pierwsze dwa rodzaje danych znajdziesz we wszystkich komercyjnych tagach; ostatnie dwa mogÄ… siÄ™ rÃ³Å¼niÄ‡ w zaleÅ¼noÅ›ci od producenta tagu.

Standard ISO okreÅ›la wartoÅ›Ä‡ Identyfikatora Rodziny Aplikacji (**AFI**), kod wskazujÄ…cy **rodzaj obiektu**, do ktÃ³rego naleÅ¼y tag. Innym waÅ¼nym rejestr, rÃ³wnieÅ¼ okreÅ›lony przez ISO, jest Identyfikator Formatu Przechowywania Danych (**DSFID**), ktÃ³ry definiuje **logicznÄ… organizacjÄ™ danych uÅ¼ytkownika**.

WiÄ™kszoÅ›Ä‡ **kontroli bezpieczeÅ„stwa** RFID ma mechanizmy, ktÃ³re **ograniczajÄ…** operacje **odczytu** lub **zapisu** na kaÅ¼dym bloku pamiÄ™ci uÅ¼ytkownika oraz na specjalnych rejestrach zawierajÄ…cych wartoÅ›ci AFI i DSFID. Te **mechanizmy blokady** korzystajÄ… z danych przechowywanych w pamiÄ™ci kontrolnej i majÄ… **prekonfigurowane domyÅ›lne hasÅ‚a** dostawcy, ale pozwalajÄ… wÅ‚aÅ›cicielom tagÃ³w na **konfigurowanie niestandardowych haseÅ‚**.

### PorÃ³wnanie tagÃ³w RFID o Niskiej i Wysokiej CzÄ™stotliwoÅ›ci

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Tagi RFID o Niskiej CzÄ™stotliwoÅ›ci (125kHz)

**Tagi o niskiej czÄ™stotliwoÅ›ci** sÄ… czÄ™sto uÅ¼ywane w systemach, ktÃ³re **nie wymagajÄ… wysokiego poziomu bezpieczeÅ„stwa**: dostÄ™p do budynku, klucze do domofonu, karty czÅ‚onkowskie siÅ‚owni, itp. Ze wzglÄ™du na ich wiÄ™kszy zasiÄ™g, sÄ… wygodne w uÅ¼yciu do pÅ‚atnego parkowania samochodÃ³w: kierowca nie musi zbliÅ¼aÄ‡ karty do czytnika, poniewaÅ¼ jest ona aktywowana z wiÄ™kszej odlegÅ‚oÅ›ci. JednoczeÅ›nie tagi o niskiej czÄ™stotliwoÅ›ci sÄ… bardzo prymitywne, majÄ… niskÄ… szybkoÅ›Ä‡ transferu danych. Z tego powodu niemoÅ¼liwe jest zaimplementowanie zÅ‚oÅ¼onego dwukierunkowego transferu danych do takich rzeczy jak prowadzenie salda i kryptografia. Tagi o niskiej czÄ™stotliwoÅ›ci przesyÅ‚ajÄ… jedynie swoje krÃ³tkie ID bez Å¼adnych Å›rodkÃ³w uwierzytelniania.

Te urzÄ…dzenia polegajÄ… na technologii **pasywnego** **RFID** i dziaÅ‚ajÄ… w **zakresie od 30 kHz do 300 kHz**, chociaÅ¼ bardziej typowe jest uÅ¼ycie 125 kHz do 134 kHz:

* **DÅ‚ugi zasiÄ™g** â€” niÅ¼sza czÄ™stotliwoÅ›Ä‡ przekÅ‚ada siÄ™ na wiÄ™kszy zasiÄ™g. IstniejÄ… niektÃ³re czytniki EM-Marin i HID, ktÃ³re dziaÅ‚ajÄ… z odlegÅ‚oÅ›ci do metra. SÄ… one czÄ™sto stosowane w parkowaniu samochodÃ³w.
* **Prymitywny protokÃ³Å‚** â€” ze wzglÄ™du na niskÄ… szybkoÅ›Ä‡ transferu danych te tagi mogÄ… przesyÅ‚aÄ‡ jedynie swoje krÃ³tkie ID. W wiÄ™kszoÅ›ci przypadkÃ³w dane nie sÄ… uwierzytelniane i nie sÄ… w Å¼aden sposÃ³b chronione. Jak tylko karta znajdzie siÄ™ w zasiÄ™gu czytnika, zaczyna przesyÅ‚aÄ‡ swoje ID.
* **Niskie bezpieczeÅ„stwo** â€” Te karty mogÄ… byÄ‡ Å‚atwo skopiowane, lub nawet odczytane z kieszeni innej osoby ze wzglÄ™du na prymitywnoÅ›Ä‡ protokoÅ‚u.

**Popularne protokoÅ‚y 125 kHz:**

* **EM-Marin** â€” EM4100, EM4102. Najpopularniejszy protokÃ³Å‚ w WNP. MoÅ¼e byÄ‡ odczytywany z odlegÅ‚oÅ›ci okoÅ‚o metra ze wzglÄ™du na swojÄ… prostotÄ™ i stabilnoÅ›Ä‡.
* **HID Prox II** â€” protokÃ³Å‚ o niskiej czÄ™stotliwoÅ›ci wprowadzony przez HID Global. Ten protokÃ³Å‚ jest bardziej popularny w krajach zachodnich. Jest bardziej zÅ‚oÅ¼ony, a karty i czytniki tego protokoÅ‚u sÄ… stosunkowo drogie.
* **Indala** â€” bardzo stary protokÃ³Å‚ o niskiej czÄ™stotliwoÅ›ci, ktÃ³ry zostaÅ‚ wprowadzony przez MotorolÄ™, a pÃ³Åºniej przejÄ™ty przez HID. Mniej prawdopodobne jest, Å¼e go spotkasz w dziczy w porÃ³wnaniu z poprzednimi dwoma, poniewaÅ¼ wychodzi z uÅ¼ycia.

W rzeczywistoÅ›ci istnieje wiele innych protokoÅ‚Ã³w o niskiej czÄ™stotliwoÅ›ci. Ale wszystkie one uÅ¼ywajÄ… tej samej modulacji na warstwie fizycznej i mogÄ… byÄ‡ rozwaÅ¼ane, w jednym lub drugim stopniu, jako wariacje wymienionych powyÅ¼ej.

### Atak

MoÅ¼esz **atakowaÄ‡ te Tagi za pomocÄ… Flipper Zero**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## Tagi RFID o Wysokiej CzÄ™stotliwoÅ›ci (13,56 MHz)

**Tagi o wysokiej czÄ™stotliwoÅ›ci** sÄ… uÅ¼ywane do bardziej zÅ‚oÅ¼onej interakcji czytnik-tag, gdy potrzebna jest kryptografia, duÅ¼a dwukierunkowa transmisja danych, uwierzytelnianie, itp.\
Zazwyczaj sÄ… one stosowane w kartach bankowych, transporcie publicznym i innych zabezpieczonych przepustkach.

**Tagi o wysokiej czÄ™stotliwoÅ›ci 13,56 MHz to zestaw standardÃ³w i protokoÅ‚Ã³w**. Zazwyczaj sÄ… one okreÅ›lane jako [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), ale to nie zawsze jest poprawne. Podstawowy zestaw protokoÅ‚Ã³w uÅ¼ywanych na poziomie fizycznym i logicznym to ISO 14443. ProtokoÅ‚y na wyÅ¼szym poziomie, jak rÃ³wnieÅ¼ alternatywne standardy (np. ISO 19092), sÄ… oparte na nim. Wiele osÃ³b odnosi siÄ™ do tej technologii jako **Komunikacja w Polu Bliskim (NFC)**, termin dla urzÄ…dzeÅ„ dziaÅ‚ajÄ…cych w czÄ™stotliwoÅ›ci 13,56 MHz.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

W skrÃ³cie, architektura NFC dziaÅ‚a w ten sposÃ³b: protokÃ³Å‚ transmisji jest wybierany przez firmÄ™ produkujÄ…cÄ… karty i implementowany na podstawie niskopoziomowego ISO 14443. Na przykÅ‚ad NXP wynalazÅ‚ swÃ³j wÅ‚asny protokÃ³Å‚ transmisji na wysokim poziomie o nazwie Mifare. Ale na niÅ¼szym poziomie karty Mifare sÄ… oparte na standardzie ISO 14443-A.

Flipper moÅ¼e wspÃ³Å‚pracowaÄ‡ zarÃ³wno z niskopoziomowym protokoÅ‚em ISO 14443, jak i protokoÅ‚em transmisji danych Mifare Ultralight oraz EMV uÅ¼ywanym w kartach bankowych. Pracujemy nad dodaniem obsÅ‚ugi dla Mifare Classic i NFC NDEF. DokÅ‚adne przyjrzenie siÄ™ protokoÅ‚om i standardom tworzÄ…cym NFC jest warte oddzielnego artykuÅ‚u, ktÃ³ry planujemy opublikowaÄ‡ pÃ³Åºniej.

Wszystkie karty o wysokiej czÄ™stotliwoÅ›ci oparte na standardzie ISO 14443-A majÄ… unikalne ID chipa. DziaÅ‚a ono jako numer seryjny karty, podobnie jak adres MAC karty sieciowej. **Zazwyczaj UID ma dÅ‚ugoÅ›Ä‡ 4 lub 7 bajtÃ³w**, ale czasami moÅ¼e siÄ™gaÄ‡ **aÅ¼ do 10**. UID nie jest tajny i jest Å‚atwo odczytywalny, **czasami nawet wydrukowany na samej karcie**.

Istnieje wiele systemÃ³w kontroli dostÄ™pu, ktÃ³re polegajÄ… na UID do **uwierzytelniania i przyznawania dostÄ™pu**. Czasami dzieje siÄ™ to **nawet** wtedy, gdy tagi RFID **obsÅ‚ugujÄ… kryptografiÄ™**. Takie **naduÅ¼ycie** obniÅ¼a je do poziomu gÅ‚upich **kart 125 kHz** pod wzglÄ™dem **bezpieczeÅ„stwa**. Wirtualne karty (jak Apple Pay) uÅ¼ywajÄ… dynamicznego UID, aby wÅ‚aÅ›ciciele telefonÃ³w nie otwierali drzwi za pomocÄ… swojej aplikacji pÅ‚atniczej.

* **KrÃ³tki zasiÄ™g** â€” karty o wysokiej czÄ™stotliwoÅ›ci sÄ… specjalnie zaprojektowane tak, aby musiaÅ‚y byÄ‡ umieszczone blisko czytnika. Pomaga to rÃ³wnieÅ¼ chroniÄ‡ kartÄ™ przed nieautoryzowanymi interakcjami. Maksymalny zasiÄ™g odczytu, jaki udaÅ‚o nam siÄ™ osiÄ…gnÄ…Ä‡, wynosiÅ‚ okoÅ‚o 15 cm, a byÅ‚o to dziÄ™ki specjalnie wykonanym czytnikom o duÅ¼ym zasiÄ™gu.
* **Zaawansowane protokoÅ‚y** â€” prÄ™dkoÅ›ci transmisji danych do 424 kbps pozwalajÄ… na zÅ‚oÅ¼one protokoÅ‚y z peÅ‚nÄ… dwukierunkowÄ… transmisjÄ… danych. Co z kolei **umoÅ¼liwia kryptografiÄ™**, transmisjÄ™ danych, itp.
* **Wysokie bezpieczeÅ„stwo** â€” bezstykowe karty o wysokiej czÄ™stotliwoÅ›ci nie ustÄ™pujÄ… w Å¼aden sposÃ³b kartom inteligentnym. IstniejÄ… karty, ktÃ³re obsÅ‚ugujÄ… kryptograficznie silne algorytmy, takie jak AES, i implementujÄ… kryptografiÄ™ asymetrycznÄ….

### Atak

MoÅ¼esz **atakowaÄ‡ te Tagi za pomocÄ… Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Lub uÅ¼ywajÄ…c **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Referencje

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)
