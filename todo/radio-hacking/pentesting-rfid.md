# Pentesting RFID

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## Einf√ºhrung

**Radio Frequency Identification (RFID)** ist die beliebteste Kurzstrecken-Radio-L√∂sung. Es wird normalerweise verwendet, um Informationen zu speichern und zu √ºbertragen, die eine Entit√§t identifizieren.

Ein RFID-Tag kann auf **seine eigene Stromquelle (aktiv)**, wie eine eingebaute Batterie, angewiesen sein oder seine Energie von der Lesantenne durch den **induzierten Strom aus den empfangenen Funkwellen** beziehen (**passiv**).

### Klassen

EPCglobal unterteilt RFID-Tags in sechs Kategorien. Ein Tag in jeder Kategorie hat alle in der vorherigen Kategorie aufgef√ºhrten F√§higkeiten, was es r√ºckw√§rtskompatibel macht.

* **Klasse 0**-Tags sind **passive** Tags, die in **UHF**-B√§ndern arbeiten. Der Anbieter **programmiert** sie im Produktionswerk vor. Daher **kann** man die in ihrem Speicher gespeicherten Informationen **nicht √§ndern**.
* **Klasse 1**-Tags k√∂nnen ebenfalls in **HF**-B√§ndern arbeiten. Dar√ºber hinaus k√∂nnen sie **nur einmal** nach der Produktion **beschrieben** werden. Viele Klasse 1-Tags k√∂nnen auch **zyklische Redundanzpr√ºfungen** (CRCs) der empfangenen Befehle verarbeiten. CRCs sind einige zus√§tzliche Bytes am Ende der Befehle zur Fehlererkennung.
* **Klasse 2**-Tags k√∂nnen **mehrmals beschrieben** werden.
* **Klasse 3**-Tags k√∂nnen **eingebettete Sensoren** enthalten, die Umweltparameter wie die aktuelle Temperatur oder die Bewegung des Tags aufzeichnen k√∂nnen. Diese Tags sind **semi-passiv**, da sie zwar eine eingebaute Stromquelle, wie eine integrierte **Batterie**, **haben**, aber **keine** drahtlose **Kommunikation** mit anderen Tags oder Leseger√§ten **initiieren k√∂nnen**.
* **Klasse 4**-Tags k√∂nnen die Kommunikation mit anderen Tags derselben Klasse initiieren, was sie zu **aktiven Tags** macht.
* **Klasse 5**-Tags k√∂nnen **Strom an andere Tags liefern und mit allen vorherigen Tag**-Klassen kommunizieren. Klasse 5-Tags k√∂nnen als **RFID-Leser** fungieren.

### Informationen, die in RFID-Tags gespeichert sind

Der Speicher eines RFID-Tags speichert normalerweise vier Arten von Daten: die **Identifikationsdaten**, die die **Entit√§t** identifizieren, an die das Tag angeh√§ngt ist (diese Daten umfassen benutzerdefinierte Felder wie Bankkonten); die **zus√§tzlichen Daten**, die **weitere** **Details** zur Entit√§t bereitstellen; die **Steuerdaten**, die f√ºr die interne **Konfiguration** des Tags verwendet werden; und die **Herstellerdaten** des Tags, die die eindeutige Kennung des Tags (**UID**) und Details zur **Produktion**, **Typ** und **Anbieter** des Tags enthalten. Die ersten beiden Datenarten finden Sie in allen kommerziellen Tags; die letzten beiden k√∂nnen je nach Anbieter des Tags variieren.

Der ISO-Standard legt den Wert des Application Family Identifier (**AFI**) fest, einen Code, der die **Art des Objekts** angibt, zu dem das Tag geh√∂rt. Ein weiteres wichtiges Register, das ebenfalls von ISO festgelegt wird, ist der Data Storage Format Identifier (**DSFID**), der die **logische Organisation der Benutzerdaten** definiert.

Die meisten RFID-**Sicherheitskontrollen** verf√ºgen √ºber Mechanismen, die die **Lese**- oder **Schreib**-Operationen auf jedem Benutzerspeicherblock und auf den speziellen Registern, die die AFI- und DSFID-Werte enthalten, **einschr√§nken**. Diese **Sperr**-**Mechanismen** verwenden Daten, die im Steuerungsspeicher gespeichert sind, und haben **vorkonfigurierte Standardpassw√∂rter** des Anbieters, erlauben es jedoch den Tag-Besitzern, **benutzerdefinierte Passw√∂rter** zu **konfigurieren**.

### Vergleich von Low- und High-Frequency-Tags

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Low-Frequency RFID Tags (125kHz)

**Niedrigfrequente Tags** werden h√§ufig in Systemen verwendet, die **keine hohe Sicherheit** erfordern: Geb√§udezugang, Gegensprechanlagenschl√ºssel, Fitnessstudio-Mitgliedskarten usw. Aufgrund ihrer h√∂heren Reichweite sind sie praktisch f√ºr kostenpflichtige Parkpl√§tze: Der Fahrer muss die Karte nicht nah am Leser bringen, da sie aus gr√∂√üerer Entfernung ausgel√∂st wird. Gleichzeitig sind niedrigfrequente Tags sehr primitiv und haben eine niedrige Daten√ºbertragungsrate. Aus diesem Grund ist es unm√∂glich, komplexe bidirektionale Daten√ºbertragungen f√ºr Dinge wie Kontost√§nde und Kryptografie zu implementieren. Niedrigfrequente Tags √ºbertragen nur ihre kurze ID ohne Authentifizierung.

Diese Ger√§te basieren auf **passiver** **RFID**-Technologie und arbeiten in einem **Bereich von 30 kHz bis 300 kHz**, obwohl es √ºblicher ist, 125 kHz bis 134 kHz zu verwenden:

* **Lange Reichweite** ‚Äî niedrigere Frequenz bedeutet h√∂here Reichweite. Es gibt einige EM-Marin- und HID-Leser, die aus einer Entfernung von bis zu einem Meter arbeiten. Diese werden h√§ufig in Parkh√§usern verwendet.
* **Primitives Protokoll** ‚Äî aufgrund der niedrigen Daten√ºbertragungsrate k√∂nnen diese Tags nur ihre kurze ID √ºbertragen. In den meisten F√§llen sind die Daten nicht authentifiziert und nicht gesch√ºtzt. Sobald die Karte im Bereich des Lesers ist, beginnt sie einfach, ihre ID zu √ºbertragen.
* **Niedrige Sicherheit** ‚Äî Diese Karten k√∂nnen leicht kopiert oder sogar aus der Tasche eines anderen gelesen werden, aufgrund der Primitivit√§t des Protokolls.

**Beliebte 125 kHz-Protokolle:**

* **EM-Marin** ‚Äî EM4100, EM4102. Das beliebteste Protokoll in der GUS. Kann aufgrund seiner Einfachheit und Stabilit√§t aus etwa einem Meter gelesen werden.
* **HID Prox II** ‚Äî Niedrigfrequentes Protokoll, das von HID Global eingef√ºhrt wurde. Dieses Protokoll ist in den westlichen L√§ndern beliebter. Es ist komplexer und die Karten und Leser f√ºr dieses Protokoll sind relativ teuer.
* **Indala** ‚Äî sehr altes Niedrigfrequenzprotokoll, das von Motorola eingef√ºhrt und sp√§ter von HID √ºbernommen wurde. Man trifft es seltener in freier Wildbahn im Vergleich zu den vorherigen beiden, da es aus der Nutzung f√§llt.

In Wirklichkeit gibt es viele weitere Niedrigfrequenzprotokolle. Aber sie alle verwenden dieselbe Modulation auf der physikalischen Ebene und k√∂nnen in einer oder anderen Weise als Variation der oben aufgef√ºhrten betrachtet werden.

### Angriff

Sie k√∂nnen **diese Tags mit dem Flipper Zero angreifen**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}

## High-Frequency RFID Tags (13.56 MHz)

**Hochfrequente Tags** werden f√ºr eine komplexere Interaktion zwischen Leser und Tag verwendet, wenn Sie Kryptografie, einen gro√üen bidirektionalen Datentransfer, Authentifizierung usw. ben√∂tigen.\
Sie sind normalerweise in Bankkarten, im √∂ffentlichen Verkehr und anderen sicheren P√§ssen zu finden.

**Hochfrequente 13.56 MHz-Tags sind eine Reihe von Standards und Protokollen**. Sie werden normalerweise als [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) bezeichnet, aber das ist nicht immer korrekt. Das grundlegende Protokollset, das auf physikalischer und logischer Ebene verwendet wird, ist ISO 14443. Hochlevelprotokolle sowie alternative Standards (wie ISO 19092) basieren darauf. Viele Menschen beziehen sich auf diese Technologie als **Near Field Communication (NFC)**, einen Begriff f√ºr Ger√§te, die √ºber die Frequenz von 13.56 MHz arbeiten.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

Einfach gesagt funktioniert die Architektur von NFC so: Das √úbertragungsprotokoll wird von dem Unternehmen gew√§hlt, das die Karten herstellt, und basierend auf dem Low-Level-ISO 14443 implementiert. Zum Beispiel erfand NXP sein eigenes Hochlevel-√úbertragungsprotokoll namens Mifare. Aber auf der unteren Ebene basieren Mifare-Karten auf dem ISO 14443-A-Standard.

Flipper kann sowohl mit dem Low-Level-ISO 14443-Protokoll als auch mit dem Mifare Ultralight-Daten√ºbertragungsprotokoll und EMV, das in Bankkarten verwendet wird, interagieren. Wir arbeiten daran, die Unterst√ºtzung f√ºr Mifare Classic und NFC NDEF hinzuzuf√ºgen. Ein gr√ºndlicher Blick auf die Protokolle und Standards, die NFC ausmachen, ist einen separaten Artikel wert, den wir sp√§ter ver√∂ffentlichen m√∂chten.

Alle hochfrequenten Karten, die auf dem ISO 14443-A-Standard basieren, haben eine eindeutige Chip-ID. Sie fungiert als die Seriennummer der Karte, √§hnlich wie die MAC-Adresse einer Netzwerkkarte. **In der Regel ist die UID 4 oder 7 Bytes lang**, kann aber selten **bis zu 10** gehen. UIDs sind kein Geheimnis und leicht lesbar, **manchmal sogar auf der Karte selbst gedruckt**.

Es gibt viele Zugangskontrollsysteme, die sich auf die UID verlassen, um **zu authentifizieren und Zugang zu gew√§hren**. Manchmal geschieht dies **sogar**, wenn RFID-Tags **Kryptografie unterst√ºtzen**. Solche **Missbr√§uche** bringen sie in Bezug auf **Sicherheit** auf das Niveau der dummen **125 kHz-Karten**. Virtuelle Karten (wie Apple Pay) verwenden eine dynamische UID, damit die Telefonbesitzer nicht mit ihrer Zahlungs-App T√ºren √∂ffnen.

* **Niedrige Reichweite** ‚Äî hochfrequente Karten sind speziell so konzipiert, dass sie nah am Leser platziert werden m√ºssen. Dies hilft auch, die Karte vor unbefugten Interaktionen zu sch√ºtzen. Die maximale Reichweite, die wir erreichen konnten, betrug etwa 15 cm, und das war mit speziell angefertigten Hochreichweitenlesern.
* **Fortgeschrittene Protokolle** ‚Äî Daten√ºbertragungsgeschwindigkeiten von bis zu 424 kbps erm√∂glichen komplexe Protokolle mit vollwertigem bidirektionalem Datentransfer. Was wiederum **Kryptografie**, Daten√ºbertragung usw. **erm√∂glicht**.
* **Hohe Sicherheit** ‚Äî hochfrequente kontaktlose Karten sind in keiner Weise den Smartcards unterlegen. Es gibt Karten, die kryptografisch starke Algorithmen wie AES unterst√ºtzen und asymmetrische Kryptografie implementieren.

### Angriff

Sie k√∂nnen **diese Tags mit dem Flipper Zero angreifen**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Oder mit dem **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Referenzen

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
